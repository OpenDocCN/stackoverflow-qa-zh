# StackOverflow 问答 11214000-11214999

# python - python/excel单元格-> png

> ID：11214000
> 
> 赞同：1
> 
> 时间：2012-06-26T18:45:20.883
> 
> 标签：python, excel, png

伙计们，有一个需要每周更新的 excel 文档......只有几个单元格需要更新，这完全可以通过： http: [//www.python-excel.org/](http://www.python-excel.org/)

更新这些单元格后，会在 excel 中生成一个图表。是否可以通过python将此图导出为.png（即复制单元格A3-B7并导出为图像）？

想法，想法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:40:52.517

[您可以使用COM 扩展](http://sourceforge.net/projects/pywin32/)将现有图表导出到 PNG 。在导出之前，您必须确保图表已使用新数据进行了更新。

我发现这个`Charts`对象的讨论很有帮助： http: [//msdn.microsoft.com/en-us/library/aa213725 (v=office.11​​).aspx](http://msdn.microsoft.com/en-us/library/aa213725(v=office.11).aspx)

你会得到这样的东西（未经测试的代码）：

```
from win32com.client import Dispatch
xlsApp = Dispatch("Excel.Application") 
xlsWB = xlsApp.Workbooks.Open(r'C:\TEST\WorkbookWithAChart.xlsx') 
xlsSheet = xlsWB.Sheets("Sheet 1") 
mychart = XlsSheet.Charts(1)  #'1' is the index of the chart object in the wb
mychart.Export(Filename=r'C:\TEST\MyExportedChart.png') 
```

有用的参考资料：

*   [客户端 COM 快速入门](http://docs.activestate.com/activepython/2.4/pywin32/html/com/win32com/HTML/QuickStartClientCom.html)
*   [Win32COM 文档](http://docs.activestate.com/activepython/2.4/pywin32/html/com/win32com/HTML/docindex.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T18:55:11.300

如果不实际使用 Excel，这将是不可能的。您需要 Excel 来绘制带有更新信息的图形。

如果您可以使用 Excel，您可以编写一个将图表导出为 PDF 文件的宏。像这样的东西：

```
Sheets("Sheet1").ChartObjects("Chart Name").Chart.ExportAsFixedFormat _
    Type:=xlTypePDF, _
    Filename:="C:\folder\filename.pdf", _
    Quality:=xlQualityStandard, _
    OpenAfterPublish:=False 
```

# android - 节目 在安卓文本视图中

> ID：11214001
> 
> 赞同：29
> 
> 时间：2012-06-26T18:45:22.733
> 
> 标签：android, html, formatting, textview

我有带有 ul 和 li 的字符串。我正在尝试在 textview 中以 HTML 格式显示它们。
`textView.setText(Html.fromHtml(myHtmlText));`
但是 textview 显示纯文本。如何在 textview 中格式化 ul 和 li 标签？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2016-04-29T16:05:07.397

您可以使用 Html.TagHandler。

在您的情况下，它将是这样的：

```
public class UlTagHandler implements Html.TagHandler{
    @Override
    public void handleTag(boolean opening, String tag, Editable output,
                          XMLReader xmlReader) {
            if(tag.equals("ul") && !opening) output.append("\n");
            if(tag.equals("li") && opening) output.append("\n\t•");
    }
} 
```

和

```
textView.setText(Html.fromHtml(myHtmlText, null, new UlTagHandler())); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-26T18:57:32.530

**字符串资源中支持的标签**

静态字符串资源中的标签由 android.content.res.StringBlock 解析，这是一个隐藏类。我查看了该类并确定了支持哪些标签：

```
<a> (supports attributes "href")
<annotation>
<b>
<big>
<font> (supports attributes "height", "size", "fgcolor" and "bicolor", as integers)
<i>
<li>
<marquee>
<small>
<strike>
<sub>
<sup>
<tt>
<u> 
```

**Html.fromHtml() 支持的标签**

出于某种原因， Html.fromHtml() 处理一组不同于静态文本支持的标记。这是标签列表（从 Html.java 的源代码中收集）：

```
<a> (supports attribute "href")
<b>
<big>
<blockquote>
<br>
<cite>
<dfn>
<div>
<em>
<font> (supports attributes "color" and "face")
<i>
<img> (supports attribute "src". Note: you have to include an ImageGetter to handle retrieving a Drawable for this tag)
<p>
<small>
<strong>
<sub>
<sup>
<tt>
<u> 
```

有关更多详细信息，请参阅此[链接](http://daniel-codes.blogspot.com/2011/04/html-in-textviews.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-26T18:48:05.103

请参阅[TextView 支持的 HTML 标记](http://commonsware.com/blog/Android/2010/05/26/html-tags-supported-by-textview.html) ul**和**li**标记**均不受[android.text.Html](http://developer.android.com/reference/android/text/Html.html)类的支持。

**解决方案：您可以使用**[WebView](http://developer.android.com/reference/android/webkit/WebView.html)或[TagHandler](http://developer.android.com/reference/android/text/Html.TagHandler.html)显示这些标签

如需更多帮助，请参阅此帖子：

[Html 列表标签在 android textview 中不起作用。我能做些什么？](https://stackoverflow.com/questions/3150400/html-list-tag-not-working-in-android-textview-what-can-i-do)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-12-27T12:07:54.700

根据下面的答案，您不能在这里使用每个 HTML 标签；

[https://stackoverflow.com/a/3150456/2275962](https://stackoverflow.com/a/3150456/2275962)

但是，可以肯定的是，有一种方法可以在 Android TextView 中显示项目符号。您可以将`<li>`标签替换为`&#149;`（项目符号的 HTML 代码）。

如果您想尝试其他列表图标，请使用表中首选的一个是此链接；

[http://www.ascii-code.com/](http://www.ascii-code.com/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-02-14T21:47:56.710

使 API 级别 M (23) 及更低级别的工作的一种非常简单的方法从您的 HTML 字符串中，您可以使用以下内容：

```
private fun String.formattedHtml(): String {
    // Work around for API Versions lower than N, Html.fromHtml does not render list items correctly
    return if (Build.VERSION.SDK_INT < Build.VERSION_CODES.N) {
        this.replace("<ul>", "")
            .replace("</ul>", "")
            .replace("<li>", "<p>• ")
            .replace("</li>", "</p>")
    } else {
        this
    }
} 
```

然后，您可以使用：

```
Html.fromHtml("<ul><li> test </li></ul>".formattedHtml()) 
```

不需要`TagHandler`API N 及更高版本，如[https://stackoverflow.com/a/40524835](https://stackoverflow.com/a/40524835)中所述，`android.text.Html`支持`li`和`ul`标记。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-11T13:28:09.273

我的情况是我的数据来自 API 调用。我仍然需要输出来匹配我的应用程序的格式，所以我将 HTML 字符串包装在格式化标签中以显示在我的 WebView 中：

```
public static String formatHtmlString(String stringIn) {

    String format = "<html>"
            + "  <head>"
            + "    <style type='text/css'>"
            + "      body { "
            + "           font-family: \"HelveticaNeue-Light\", \"Helvetica Neue Light\"; "
            + "           font-size:14px;" + "           color:#000;"
            + "      }" + "      b { " + "           font-size:14px;"
            + "       }" + "      i { " + "           font-size:10px;"
            + "           color:#333333;" + "           opacity:0.75;"
            + "       }" + "    </style>" + "  </head>" + "  <body>"
            + stringIn + "</body>" + "</html>";

    return format;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-19T13:17:21.853

在我的情况下，我得到一个字符串列表（从后端作为 JSON 响应），然后使用这种方法手动渲染 HTML `TextView`：

**在科特林**

```
// ViewUtils.kt
@file:JvmName("ViewUtils")

package com.company

private fun List<String>.joinToBulletList(): String =
        joinToString(prefix = "<ul>", postfix = "</ul>", separator = "\n") {
            "<li> $it</li>"
        }

fun TextView.renderToHtmlWithBulletList(contents: List<String>) {
    val content = contents.joinToBulletList()

    val html: Spannable = if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.N) {
        Html.fromHtml(content, Html.FROM_HTML_MODE_COMPACT, null, null) as Spannable
    } else {
        Html.fromHtml(content, null, null) as Spannable
    }

    text = html
}

// AnyActivity.kt
val contents = listOf("desc 1", "desc 2", "desc 3")
textViewFromXml.renderToHtmlWithBulletList(contents) 
```

**在 Java 中**

```
// AnyActivity.java
List<String> contents = new String["desc 1", "desc 2", "desc 3"];
ViewUtils.renderToHtmlWithBulletList(textViewFromXml, contents) 
```

请注意`@file:JvmName("ViewUtils")`，更改文件名很有用，以便 Java 代码可以调用它`ViewUtils.java`而不是`ViewUtilsKt.java`. 请参阅[此处了解更多详细信息](https://dogwood008.github.io/kotlin-web-site-ja/docs/reference/java-to-kotlin-interop.html#package-level-functions)

PS：请随意编辑

# php - 在php中将数组显示为树结构

> ID：11214011
> 
> 赞同：2
> 
> 时间：2012-06-26T18:45:59.193
> 
> 标签：php, arrays, tree

我有一个数组：

```
Array
(
    [0] => dir0|file0.txt
    [1] => dir0|file1.txt
    [2] => dir1|file2.txt
    [3] => dir1|filea.txt
    [4] => dir2|fileb.txt
) 
```

我希望它显示为一棵树，例如：

```
dir0
  file0.txt
  file1.txt
dir1 
  file2.txt
  filea.txt
dir2
  fileb.txt 
```

谁能解释我该怎么做？

**编辑：**更新了多维数组：

```
$paths[0][0] = 'dir0|file0.txt';
$paths[0][1] = 400;
$paths[1][0] = 'dir0|filea.txt';
$paths[1][1] = 500;
$paths[2][0] = 'dir1|file1.txt';
$paths[2][1] = 600;
$paths[3][0] = 'dir1|fileb.txt';
$paths[3][1] = 700;
$paths[4][0] = 'dir2|filec.txt';
$paths[4][1] = 700; 
```

我希望输出为：

```
dir0 (900)
  file0.txt (400)
  filea.txt (500)
dir1 (1300)
  file1.txt(600)
  fileb.txt (700)
dir2 (700)
  filec.txt (700) 
```

这些值需要添加并显示在根目录中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T18:48:59.460

最好的方法是重新格式化数组，使键是目录，数组值是包含文件名的数组，如下所示：

```
$array = array( ..);
$reformatted = array();
foreach( $array as $k => $v) {
    list( $key, $value) = explode( '|', $v);
    if( !isset( $reformatted[$key])) 
        $reformatted[$key] = array();
    $reformatted[$key][] = $value;
} 
```

然后你只需要遍历新数组，如下所示：

```
foreach( $reformatted as $dir => $files) {
    echo $dir . "\n";
    foreach( $files as $file)
        echo "\t" . $file . "\n";
} 
```

这[输出](http://viper-7.com/2kXKoE)：

```
dir0
    file0.txt
    file1.txt
dir1
    file2.txt
    filea.txt
dir2
    fileb.txt 
```

请注意，这仅适用于纯文本环境（例如`<pre></pre>`，就像在演示中一样）。否则，您需要使用`<br />`而不是`\n`换行符，或者使用有序或无序列表。

**对于 HTML 输出，使用 this，**其输出可以在[这里看到](http://viper-7.com/jBVGjX)

```
echo '<ul>';
foreach( $reformatted as $dir => $files) {
    echo "<li>$dir</li>";
    echo '<ul>';
    foreach( $files as $file)
        echo "<li>$file</li>";
    echo '</ul>';
}
echo '</ul>'; 
```

生成：

*   目录0

*   文件0.txt
*   文件1.txt

*   目录1

*   文件2.txt
*   文件a.txt

*   目录2

*   文件b.txt

对于您更新的阵列，这是解决方案：

```
$reformatted = array(); $weights = array();
foreach( $paths as $k => $v) {
    list( $key, $value) = explode( '|', $v[0]);

    if( !isset( $reformatted[$key])) 
        $reformatted[$key] = array();

    if( !isset( $weights[$key]))
        $weights[$key] = 0;

    $reformatted[$key][] = array( $value, $v[1]);
    $weights[$key] += $v[1];    
}

foreach( $reformatted as $dir => $files) {
    echo $dir . ' (' . $weights[$dir] . ")\n";
    foreach( $files as $file)
        echo "\t" . $file[0] . ' (' . $file[1] . ")\n";
} 
```

这[输出](http://viper-7.com/HFAFjX)：

```
dir0 (900)
    file0.txt (400)
    filea.txt (500)
dir1 (1300)
    file1.txt (600)
    fileb.txt (700)
dir2 (700)
    filec.txt (700) 
```

如有必要，我将由您将其翻译成 HTML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T18:50:18.943

您想使用循环并执行此操作。

```
 <?php
  $directories = array();
  foreach($arr as $val)
  {
     $pair = explode('|', $val);
     if(!isset($directories[$pair[0]])) { $directories[$pair[0]] = array(); }
     $directories[$pair[0]][] = $pair[1];
  }
  print_r($directories); 
```

这将重新组织你的数组，然后 print_r 它，向你展示新的结构。然后你可以这样做：

```
 <?php
    foreach($directories as $directory => $files)
    {
      echo "$directory<br><ul>";
      foreach($files as $file)
      {
          echo "<li>$file</li>";
      }
      echo "</ul>";
  } 
```

# r - 仅设置 ggplot 限制的下限

> ID：11214012
> 
> 赞同：89
> 
> 时间：2012-06-26T18:46:04.253
> 
> 标签：r, ggplot2

是否可以只设置连续比例限制的下限？我想让我的所有地块都以 0 为基础，而无需指定上限。

例如

```
+ scale_y_continuous(minlim=0) 
```

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2012-06-26T19:14:16.697

您可以使用`expand_limits`

```
ggplot(mtcars, aes(wt, mpg)) + geom_point() + expand_limits(y=0) 
```

这是两者的比较：

*   没有`expand_limits`

![](../Images/d2d1e856e2d0aa09e0d60dd845f25e19.png "ggplot(mtcars, aes(wt, mpg)) + geom_point()")

*   和`expand_limits`

![](../Images/15ec3bd8e3f928c5c103cd67d80c5f4b.png "ggplot(mtcars, aes(wt, mpg)) + geom_point() + expand_limits(y=0)")

从 1.0.0 版开始`ggplot2`，您只能指定一个限制，而另一个限制则与通常通过将第二个限制设置为 来确定的一样`NA`。这种方法将允许扩展和截断轴范围。

```
ggplot(mtcars, aes(wt, mpg)) + geom_point() +
  scale_y_continuous(limits = c(0, NA)) 
```

![](../Images/b486fb678a2c41da5d0e9b1e2524b6a7.png "ggplot(mtcars, aes(wt, mpg)) + geom_point() + scale_y_continuous(limits = c(0, NA))")

指定它通过`ylim(c(0, NA))`给出一个相同的数字。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-26T19:02:31.150

如何使用`aes(ymin=0)`，如：

```
ggplot(mtcars, aes(wt, mpg)) + geom_point() + aes(ymin=0) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-03-02T14:25:42.330

您还可以尝试以下代码，它将为您提供零的最小 y 轴，并且 x 轴和最小 y 值之间没有额外的间隙。

```
scale_y_continuous(limits = c(0, NA), expand = c(0,0)) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-26T18:55:05.917

我不认为你可以直接做到这一点。但作为一种解决方法，您可以模仿 ggplot2 确定上限的方式：

```
scale_y_continuous(limits=c(0, max(mydata$y) * 1.1)) 
```

# javascript - 使用字符串值访问 javascript 对象

> ID：11214013
> 
> 赞同：3
> 
> 时间：2012-06-26T18:46:12.973
> 
> 标签：javascript, javascript-objects

我不明白为什么我不能访问这样的值：

```
object = {
    test:{
        value: "Hello world"
    }
}

variable = "value";

//this gives me "Hello world"
console.log(object.test.value);

//this gives me undefined error
console.log(object.test.variable); 
```

到目前为止，我可以理解它不能以这种方式完成，但我仍然需要为变量赋予一些值，然后使用该变量来访问对象值。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-26T18:48:10.647

这样做：

```
console.log(object.test[variable]); 
```

用点来做就是使用文字属性名称。即，`object.test.value`等于`object.test['value']`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T18:48:19.323

你需要做

```
object.test[variable] 
```

可以使用`.`和访问对象`[]`。

`object.test.variable`正在寻找不存在的文字属性“变量”。

# fortran - Fortran：动态数组与自动数组避免内存分配

> ID：11214014
> 
> 赞同：9
> 
> 时间：2012-06-26T18:46:15.817
> 
> 标签：fortran

分析我们的 fortran 代码之一，有两个子程序占用了大部分计算时间（22.1% 和 17.2%）。在每个例程中，大约 5% 的时间用于分配和释放内存。这些例程看起来像

```
MODULE foo

CONTAINS

SUBROUTINE bar( ... )
...
IMPLICIT NONE
...
REAL, ALLOCATABLE, DIMENSION(:,:) :: work
...
ALLOCATE (work(size1,size2))
...
DEALLOCATE (work)
END SUBROUTINE bar
...
END MODULE foo 
```

这些子程序在我的基准测试中被调用了大约 4000-5000 次，所以我想摆脱 ALLOCATE 和 DEALLOCATE。将这些更改为自动数组将更改为探查器输出。

```
MODULE foo

CONTAINS

SUBROUTINE bar( ... )
...
IMPLICIT NONE
...
REAL, DIMENSION(size1,size2) :: work
...
END SUBROUTINE bar
...
END MODULE foo 
```

将生成的配置文件更改为

```
Running Time        Symbol Name
20955.0ms  17.0%    __totzsp_mod_MOD_totzsps
    7.0ms   0.0%        malloc
    5.0ms   0.0%        free
    2.0ms   0.0%        user_trap

16192.0ms  13.2%    __tomnsp_mod_MOD_tomnsps
   20.0ms   0.0%        free
    3.0ms   0.0%        malloc
    1.0ms   0.0%        szone_size_try_large 
```

我看起来像 gfortran 将这些分配在堆栈上而不是那个堆上，但我担心当这些数组变得太大时会发生什么。

我采用的第二种方法是一次分配和解除分配这些数组。

work_array.f

```
MODULE work_array
IMPLICIT NONE

REAL(rprec), ALLOCATABLE, DIMENSION(:,:) :: work

END MODULE work_array 
```

我在代码的不同部分分配一次。现在我的子程序看起来像

```
MODULE foo

CONTAINS

SUBROUTINE bar( ... )
...
USE work_array
IMPLICIT NONE
...
END SUBROUTINE bar
...
END MODULE foo 
```

但是，当我现在运行代码时，配置文件变得更糟。

```
Running Time        Symbol Name
30584.0ms  21.6%    __totzsp_mod_MOD_totzsps
 3494.0ms   2.4%        free
 3143.0ms   2.2%        malloc
   27.0ms   0.0%        DYLD-STUB$$malloc_zone_malloc
   19.0ms   0.0%        szone_free_definite_size
    6.0ms   0.0%        malloc_zone_malloc

24325.0ms  17.1%    __tomnsp_mod_MOD_tomnsps
 2937.0ms   2.0%        free
 2456.0ms   1.7%        malloc
   23.0ms   0.0%        DYLD-STUB$$malloc_zone_malloc
    3.0ms   0.0%        szone_free_definite_size 
```

这些额外的 malloc 和 free 来自哪里？如何设置它以便我分配这些数组一次？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T06:19:30.360

由于`work`数组只在`bar`子程序内部使用，您可以将`save`属性添加到它并在第一次调用子程序时分配它。如果`work1`或`work2`与以前的调用不同，您可以在这种情况下重新分配数组。

一旦不再需要子例程，这确实会留下释放问题。如果您需要在程序的整个生命周期内调用它，那没问题，因为操作系统应该在程序退出时释放内存。另一方面，如果您只在初始化期间需要它，那么即使不需要，内存也将保持分配状态。`work`如果内存使用有问题，也许您可​​以向子例程添加一个参数，告诉它释放数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T00:11:52.520

如果您可以在程序初始化时进行一次分配，那么就没有理由将数组定义为可分配的。把它放在一个共同的地方。

如果您只需要一个固定大小，但直到运行时才知道该大小，您将需要使用最终选项，即在初始化时进行一次分配。但是，这增加了对分配性能的影响是没有意义的。我需要查看定义和分配代码才能说更多。

由于分配的是虚拟内存，因此“内存使用”并不是真正的问题，除非数组太大以至于影响可用地址空间。

# git - 如何在 git commit 上设置所有文件的创建日期？

> ID：11214018
> 
> 赞同：0
> 
> 时间：2012-06-26T18:46:35.150
> 
> 标签：git, version-control, filesystems

有没有办法将所有已提交文件的文件创建日期设置为最新提交的时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T18:58:24.610

您想要的是可以在`git filter-branch`环境过滤器的帮助下完成。有关详细信息，请查看相关问题：[如何在 Git 中更改旧提交的时间戳？](https://stackoverflow.com/questions/454734/how-can-one-change-the-timestamp-of-an-old-commit-in-git)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T18:50:46.320

你有理由这样做吗？您应该能够使用 git 命令查看文件上次更改的时间。依赖文件系统可能会导致麻烦。

最简洁的答案是不。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T18:58:14.167

一个[git pre-commit 钩子](http://git-scm.com/book/en/Customizing-Git-Git-Hooks)，结合[touch](http://www.manpagez.com/man/1/touch/)之类的东西可能会起作用。

这只是本地的 - git 不会跟踪创建日期。

但是，我正在努力为这种钩子提出一个有效的用例。

# mysql - 在 phpmyadmin 中上传数据库时出错

> ID：11214019
> 
> 赞同：0
> 
> 时间：2012-06-26T18:46:44.393
> 
> 标签：mysql, database, phpmyadmin, php

我在尝试上传大小为 1.9 mb 的数据库时遇到此错误，并且我已将上传大小增加到 750 MiB，在我的 php.ini 文件中将 upload_time 增加到 5000，但我现在收到此错误，我该怎么办删除此错误并成功从 phpmyadmin 上传数据库。

“ 服务器错误！

服务器遇到内部错误，无法完成您的请求。服务器过载或 CGI 脚本中存在错误。

如果您认为这是服务器错误，请联系网站管理员。错误 500 localhost Tue Jun 26 14:38:04 2012 Apache/2.2.21 (Linux/SUSE) "

任何帮助将不胜感激，谢谢提前

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T18:51:39.070

`max_post_size`在 php.ini 中？

如果没有，并且您有 ssh 访问权限，只需使用 cli 工具：

[http://www.techiecorner.com/44/how-to-backup-mysql-database-in-command-line-with-compression/](http://www.techiecorner.com/44/how-to-backup-mysql-database-in-command-line-with-compression/)

# vb.net - 为什么我的字符串返回一个字符？

> ID：11214020
> 
> 赞同：0
> 
> 时间：2012-06-26T18:46:45.370
> 
> 标签：vb.net

我已经从我的数据库中构建了一个 DataTable。然后我遍历行并尝试访问一个字符串，但是该值作为字符串中的每个字符返回。

```
 For Each theseRows In DisplayForm.MainTab.Rows
        If theseRows.Item("Last_Name") = userLast And theseRows.Item("First_Name") = userFirst Then
            For Each RGCode As String In theseRows.Item("Trap_Code")
                MessageBox.Show(RGCode)
                                Next
        End If
    Next 
```

Trap_Code 值是两个或三个字母的字符串，返回值是每个字母一次。该循环似乎将字符串的各个字符作为数组循环，而不是显示整个值，这正是我所希望的。只是寻求一些帮助和建议。

谢谢你，RL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T18:49:16.703

您已明确要求遍历 的值`Trap_Code`：

```
For Each RGCode As String In theseRows.Item("Trap_Code") 
```

那是获取*单个*值（`theseRows`只是一行，请记住 - 您可能想要更改变量名称），它是一个字符串。然后，您以唯一的方式迭代字符串 - 作为字符序列。

鉴于您已经在遍历行，为什么还要在`If`语句中循环呢？我怀疑你只是想要：

```
For Each theseRows In DisplayForm.MainTab.Rows
    If theseRows.Item("Last_Name") = userLast And theseRows.Item("First_Name") = userFirst Then
        MessageBox.Show(theseRows.Item("Trap_Code"))
    End If
Next 
```

或者为单行使用更好的名称（并且减少缩进以避免滚动）：

```
For Each row In DisplayForm.MainTab.Rows
  If row.Item("Last_Name") = userLast And row.Item("First_Name") = userFirst Then
    MessageBox.Show(row.Item("Trap_Code"))
  End If
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T18:50:27.257

我相信您只需要删除每个循环的内部：

```
For Each theseRows In DisplayForm.MainTab.Rows
    If theseRows.Item("Last_Name") = userLast And theseRows.Item("First_Name") = userFirst Then
            MessageBox.Show(theseRows.Item("Trap_Code"))
    End If
Next 
```

# android - 为 android 编译 mupdf

> ID：11214021
> 
> 赞同：0
> 
> 时间：2012-06-26T18:46:46.253
> 
> 标签：android, java-native-interface, cygwin, mupdf

一直在寻找一种在网络上构建 mupdf 的方法。在取得了很大进展并构建了 MuPDF 生成的目录之后，我在为 android 构建库时遇到了这个错误。

jni/../../thirdparty/zlib-1.2.5/trees.c：在函数“compress_block”中：jni/../../thirdparty/zlib-1.2.5/trees.c:1103：内部编译器错误：在重新加载中，在 reload1.c:1173 请提交完整的错误报告，如果合适，请提供预处理的源代码。有关说明，请参见[http://gcc.gnu.org/bugs.html](http://gcc.gnu.org/bugs.html)。/cygdrive/f/DevJehandad/Android/android-ndk-r8/build/core/build-binary.mk:240：目标`obj/local/armeabi/objs-debug/mupdfthirdparty// **thirdparty** / zlib-1.2的配方.5/trees.o' 失败

真的不知道如何进一步解决这个问题......欢迎任何指导或提示。

# javascript - Highcharts 在再次爬升之前强制为 0

> ID：11214023
> 
> 赞同：4
> 
> 时间：2012-06-26T18:46:55.453
> 
> 标签：javascript, highcharts

我有一个高图表，我正在根据用户输入的日期范围动态生成数据。表中数据为功率读数。读数每小时完成一次。如果没有电源，则不会报告任何内容并保存在数据库中。所以，我有一个图表 ( [jsfiddle sample/dPqg7/](http://jsfiddle.net/dPqg7/) ) 用于显示数据。但是，该图表将一天的最后一次读数与第二天的第一次读数联系起来。有没有办法在第二天开始回升之前将系列强制为零？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T18:48:55.623

是的你可以。如果您希望它为零，那么[**第一天的最后一个读数必须为零，第二天的第一个读数必须为零**](http://jsfiddle.net/dPqg7/4/)。或者，由于您正在动态创建数据，因此您可以跟踪小时数，如果数据丢失，则自动将其设置为[**null**](http://jsfiddle.net/dPqg7/5/)或[**zero**](http://jsfiddle.net/dPqg7/6/)。

就我个人而言，我想显示用户日期范围内每个数据点的数据。所以我会在数据不存在的每一小时显示零。

我注意到您的工具提示显示 m/s。我猜你用了另一个图表，错过了把它改成千瓦时。

# php - 如何在特定标签之前写入

> ID：11214031
> 
> 赞同：2
> 
> 时间：2012-06-26T18:47:31.377
> 
> 标签：php, apache, .htaccess, fopen, fwrite

我正在制作一个脚本，其中 php 将 fwrite 并将其广告在 </file> 标记之后，它不会被包含在内。主要目的是在此 .htaccess 文件中记录每个 IP，以便无法访问此特定文件。这是我的代码：（在 google 和 php.net 上搜索大约 3 个小时以上）。我曾想过是否有办法从文件 .htaccess 中读取“单词”</file> 所在的位置，然后再添加 $ip。或通过其他方式在 <file forum.php * 中获取 $badpersonip *（我不能使用数据库，因此需要仅通过 PHP 和 .htaccess 完成）

```
<?php

$badpersonip = $_SERVER['REMOTE_ADDR'];

echo "You have been banned $badpersonip , dont spam!! <br> ";
$ip = "deny from $badpersonip \n";
$banip = '.htaccess';
$fp = fopen($banip, "a");
$write = fputs($fp, $ip);

?> 
```

这也是我的 .htaccess 代码：

```
<files forum.php>
Order Allow,Deny
Allow from all

deny from 127.0.2.1
deny from 127.1.2.1

</files>
deny from 127.0.0.3 
```

如您所见，它会在文件标签关闭后在底部广告新 IP。:(

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T18:50:35.260

如果不是使用`fwrite()`您将整个内容读入字符串中[`file_get_contents()`](http://us3.php.net/manual/en/function.file-get-contents.php)，您可以轻松地`str_replace()`将现有的替换`</files>`为新行并`</files>`

```
// Read the while file into a string $htaccess
$htaccess = file_get_contents('.htaccess');
// Stick the new IP just before the closing </files>
$new_htaccess = str_replace('</files>', "deny from $badpersonip\n</files>", $htaccess);
// And write the new string back to the file
file_put_contents('.htaccess', $new_htaccess); 
```

如果您希望文件变得非常大，则不建议这样做，但对于几十或几百个 IP，它应该可以正常工作。`</files>`如果您在该 .htaccess 文件中有多个文件，这将无法正常工作。这将需要更仔细的解析才能找到正确的结束标记。

如果保留空格（如果您之前有缩进`</files>`）对您很重要，您可以考虑使用`preg_replace()`代替更简单的`str_replace()`.

另一种方法是使用`file()`将 .htaccess 读取到其行的数组中，找到包含行的行`</files>`并在它之前插入一个新的数组元素，然后将这些行重新连接在一起并将其写入文件。

# django - django-social-auth 错误 500：脚本头过早结束：django.wsgi

> ID：11214032
> 
> 赞同：0
> 
> 时间：2012-06-26T18:47:32.147
> 
> 标签：django, hosting, mod-wsgi, internal-server-error, django-socialauth

我正在尝试在我的项目中使用 django-social-auth。它在我的本地计算机上运行良好（使用 manage.py runserver），但在我的主机（locum.ru）服务器上失败（使用 mod_wsgi）。

我在服务器上的 django 日志中看到了这一点：

```
[2012-06-26 22:19:24,796] DEBUG  [django.db.backends:44] (0.000) SET FOREIGN_KEY_CHECKS=0;; args=()
[2012-06-26 22:19:24,817] DEBUG  [django.db.backends:44] (0.000) SELECT `django_session`.`session_key`, `django_session`.`session_dat
a`, `django_session`.`expire_date` FROM `django_session` WHERE (`django_session`.`session_key` = 392a94a6d2a667ff755a9d45a79582d0  AN
D `django_session`.`expire_date` > 2012-06-26 22:19:24 ); args=('392a94a6d2a667ff755a9d45a79582d0', u'2012-06-26 22:19:24')
[2012-06-26 22:19:24,857] DEBUG  [myapp.context_processors:11] Adding something to context. 
```

（myapp.context_processors 只是一个简单的上下文处理器，除了通知我它被调用之外什么都不做）

这在error.log中：

```
[Tue Jun 26 22:19:24 2012] [error] [client 34.34.34.34] Premature end of script headers: django.wsgi 
```

当我在 settings.py 中关闭 django-social-auth 时，一切正常。当我打开它时 - 它失败了！

我在本地有 python 2.7.3，在服务器上有 python 2.6.6（但它在没有社交身份验证的情况下工作，所以我认为这不是问题......）和 Django 1.3.1。

谁能给我提示在哪里挖？

**UPD：**我添加了一些日志记录，现在我看到它在从 social_auth 导入时失败：

```
logger.debug('Before import from social_auth')
from social_auth.views import complete, auth, disconnect
logger.debug('After import from social_auth') 
```

“导入之前...”出现在调试日志中，“之后...”没有。但它适用于我的本地桌面！魔法在哪里？！

**UPD2：**我在 social_auth 中添加了更多登录信息，现在我看到 social_auth 导入了 python-openid，openid.yadis.extrd 运行以下行：

```
from openid.oidutil import importElementTree
ElementTree = importElementTree() 
```

并且 importElementTree() 包含：

```
for mod_name in module_names:
    try:
        logger.debug('importElementTree - 2 - ' + mod_name)
        ElementTree = __import__(mod_name, None, None, ['unused'])
        logger.debug('importElementTree - 3 - ' + mod_name)
    except ImportError:
        logger.debug('importElementTree - except ImportError')
        pass 
```

在日志文件中出现：

```
[2012-06-30 09:18:51,186] DEBUG  [shoplist:39] In openid.yadis.extrd - 5
[2012-06-30 09:18:51,186] DEBUG  [shoplist:56] importElementTree
[2012-06-30 09:18:51,186] DEBUG  [shoplist:61] importElementTree - 1
[2012-06-30 09:18:51,186] DEBUG  [shoplist:64] importElementTree - 2 - lxml.etree 
```

因此，它无法导入 lxml.etree，但不会抛出 ImportError。为什么？我检查了本地计算机和服务器上是否有相同版本的 django-social-auth、python-openid 和 python-lxml。它仍然无法在服务器上运行！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:06:39.423

表示您可能正在使用进程正在崩溃的守护进程模式位。如果您看不到主要的 Apache 错误日志并且只有虚拟主机，您可能看不到崩溃消息。

看看您是否可以强制应用程序在进程内的主解释器中运行，而不是在子解释器中运行。

[http://code.google.com/p/modwsgi/wiki/ApplicationIssues#Python_Simplified_GIL_State_API](http://code.google.com/p/modwsgi/wiki/ApplicationIssues#Python_Simplified_GIL_State_API)

# c# - 绘制按钮后移动按钮的位置

> ID：11214033
> 
> 赞同：6
> 
> 时间：2012-06-26T18:47:44.403
> 
> 标签：c#, winforms

在我的 C# Winform (VS 2010 / C# / .Net 3.5) 上，我在设计器中创建了一个按钮。我想在启动该表单时根据用户的设置将该按钮移动并调整大小到不同的位置。

在我的表单加载事件中，我有以下代码来移动和调整按钮的大小：

```
btnShare.Location = new System.Drawing.Point(16, 496);
btnShare.Margin = new System.Windows.Forms.Padding(4);
btnShare.Size = new System.Drawing.Size(408, 126); 
```

创建按钮的所有代码都是此特定表单的 *.designer.cs 文件。

问题是这样的：当表单加载时，我可以根据上面的 3 行代码在它的新位置看到按钮。但是当表单完成加载并完成所有事件时，按钮会返回到它的原始位置，该位置位于 *.designer.cs InitalizeComponent() 方法中。

我不想从 *.designer.cs 文件中取出代码并将其仅放入表单的 .cs 文件中，因为我仍然希望在设计表单时能够在设计器中看到按钮.

如果用户在加载表单时切换了该选项，我只想移动按钮并调整其大小。

我怎么能这样做，因为.Net似乎在加载事件处理后在我的表单上绘制按钮，从而将按钮移回原来的位置？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-16T21:39:18.457

这是我刚刚添加的一些代码。它对我有用。

这是一个 SSCCE，一个简单、独立的正确示例。在提出关于 SO 的问题时非常有用。

*由于我不知道您的具体问题是什么，因此*Correct* , 在这种情况下部分可能不准确

尝试复制这个项目，看看你是否遇到同样的问题。如果您不这样做，如果不了解有关您的项目的更多信息，我们真的无法为您提供太多帮助。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();

            button1.Location = new Point(40, 40);
        }
    }
} 
```

# jquery - 查找单词旁边的输入框

> ID：11214043
> 
> 赞同：2
> 
> 时间：2012-06-26T18:48:46.383
> 
> 标签：jquery

我有一个表格...

```
<form id='form1'>
   First Name:
   <input type="text"> 
</form> 
```

我希望能够找到单词`First Name`，然后查找以下输入并添加值“Joe”。名称周围可能有标签标签，输入周围也可能有 div/span 标签。以上只是一个基本的例子。

我的代码看起来像这样，但当然不能正常运行。谢谢。

```
$('#form1').text($(this).find('First Name').next().val('Joe')); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:00:07.210

在 HTML 中关联标签和输入的传统方法是使用`<label>`标签：

```
<form id='form1'>
    <label for='firstName'>First Name</label>
    <input type='text' name='firstName' id='firstName'/>
</form> 
```

标签`for`通过 ID 与输入相关联，因此要从标签中选择输入，您可以执行以下操作：

```
document.getElementById($('label[innerHTML="First Name"]').get(0).htmlFor).value += Joe; 
```

或者只使用输入的 id：

```
document.getElementById('firstName').value += 'Joe'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:01:22.653

jQuery 不是用来选择文本的，它是用来选择元素的。例如，如果您命名您的输入`first_name`，您可以直接选择输入

```
$("input[name=first_name]", "#form1") 
```

当输入必须具有名称 id 或类以供 html 页面以任何有用的方式使用时，绝对没有理由根据其前面的文本选择输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:11:53.503

## *[jsBin 演示](http://jsbin.com/uhicic/2/edit)*

Simle：使用`.eq()`( 或`:eq()`)
我想在表单中您想要的输入将是（例如）第一个，对：

```
<form id='form1'>  
   First Name:
   <input type="text">  
   Last  Name:
   <input type="text">  
   Comment:
   <input type="text">     
</form> 
```

这就是你所需要的：

```
$('#form1 input').eq(0).val('Joe'); 
```

所以有一天你可以平静地在你的页面中使用更多的语言:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T18:59:47.010

这是一个坏主意，以这种方式搜索标签将迫使浏览器搜索比它应该搜索的更多元素。您应该为文本框使用 id，并通过 id 获取元素。

```
<label for="firstname">First Name: </label><input id="firstname"/>

$('#firstname').val('joe'); 
```

交替：

```
<label for="firstname">First Name: </label><input id="firstname" class="firstname"/>

$('input.firstname').val('joe'); 
```

或者

```
<label for="firstname">First Name: </label>
<input id="firstname" inputtype="firstname"/>

$('input[inputtype="firstname"]').val('joe'); 
```

# spring - 在控制器中获取 ServletContext 属性“javax.servlet.context.tmpdir”

> ID：11214047
> 
> 赞同：1
> 
> 时间：2012-06-26T18:48:57.370
> 
> 标签：spring, servlets, spring-mvc

我真的是 Spring 和 Spring MVC 的新手，我正在开发一种测试程序，它上传一个文件，将它写入 servlet 的临时工作目录，然后将该文件传递给程序的其余部分（这是一个Spring Batch Job 并且工作正常）。我目前的问题是弄清楚如何在我的控制器中获取用于配置 Spring 的 DispatcherServlet 的临时文件的位置。

我在网上看到的获取临时文件位置的代码是这样的：

```
File directory = (File)getServletContext().getAttribute("javax.servlet.context.tmpdir");
File file = File.createTempFile("prefix", ".tmp", directory);
FileWriter out = new FileWriter(file); 
```

但是从我目前看到的情况来看，在我用来配置 servlet 的 Controller 类中使用 getServletContext 是不可能的。

非常感谢任何关于如何获得我想要的东西或其他方法来处理这个问题的建议。如果您需要更多详细信息，请询问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T18:54:46.337

您是否尝试使用注释注入`ServletContext`控制器并在您的方法中访问它。`@Autowired`

```
class XController {
@Autowired
private ServletContext servletContext;

} 
```

# python - 单调递增函数的反函数，log10() 的 OverflowError

> ID：11214048
> 
> 赞同：7
> 
> 时间：2012-06-26T18:48:57.840
> 
> 标签：python, binary-search, newtons-method

对于赋值，我们被要求创建一个返回反函数的函数。基本问题是从平方函数创建平方根函数。我想出了一个使用二分搜索的解决方案和另一个使用牛顿方法的解决方案。我的解决方案似乎适用于立方根和平方根，但不适用于 log10。以下是我的解决方案：

```
#Binary Search
def inverse1(f, delta=1e-8):
    """Given a function y = f(x) that is a monotonically increasing function on
    non-negative numbers, return the function x = f_1(y) that is an approximate
    inverse, picking the closest value to the inverse, within delta."""
    def f_1(y):
        low, high = 0, float(y)
        last, mid = 0, high/2
        while abs(mid-last) > delta:
            if f(mid) < y:
                low = mid
            else:
                high = mid
            last, mid = mid, (low + high)/2
        return mid
    return f_1

#Newton's Method
def inverse(f, delta=1e-5):
    """Given a function y = f(x) that is a monotonically increasing function on
    non-negative numbers, return the function x = f_1(y) that is an approximate
    inverse, picking the closest value to the inverse, within delta."""
    def derivative(func): return lambda y: (func(y+delta) - func(y)) / delta
    def root(y): return lambda x: f(x) - y
    def newton(y, iters=15):
        guess = float(y)/2
        rootfunc = root(y)
        derifunc = derivative(rootfunc)
        for _ in range(iters):
            guess = guess - (rootfunc(guess)/derifunc(guess))
        return guess
    return newton 
```

无论使用哪种方法，当我在教授的测试函数中输入 n = 10000 for log10() 时，我都会收到此错误：（例外：当使用我的牛顿方法函数时，log10() 是遥不可及的，而这在达到输入阈值之前，二进制搜索方法相对准确，无论哪种方式，当 n = 10000 时，两种解决方案都会抛出此错误）

```
 2: sqrt =     1.4142136 (    1.4142136 actual); 0.0000 diff; ok
   2: log =     0.3010300 (    0.3010300 actual); 0.0000 diff; ok
   2: cbrt =     1.2599211 (    1.2599210 actual); 0.0000 diff; ok
   4: sqrt =     2.0000000 (    2.0000000 actual); 0.0000 diff; ok
   4: log =     0.6020600 (    0.6020600 actual); 0.0000 diff; ok
   4: cbrt =     1.5874011 (    1.5874011 actual); 0.0000 diff; ok
   6: sqrt =     2.4494897 (    2.4494897 actual); 0.0000 diff; ok
   6: log =     0.7781513 (    0.7781513 actual); 0.0000 diff; ok
   6: cbrt =     1.8171206 (    1.8171206 actual); 0.0000 diff; ok
   8: sqrt =     2.8284271 (    2.8284271 actual); 0.0000 diff; ok
   8: log =     0.9030900 (    0.9030900 actual); 0.0000 diff; ok
   8: cbrt =     2.0000000 (    2.0000000 actual); 0.0000 diff; ok
  10: sqrt =     3.1622777 (    3.1622777 actual); 0.0000 diff; ok
  10: log =     1.0000000 (    1.0000000 actual); 0.0000 diff; ok
  10: cbrt =     2.1544347 (    2.1544347 actual); 0.0000 diff; ok
  99: sqrt =     9.9498744 (    9.9498744 actual); 0.0000 diff; ok
  99: log =     1.9956352 (    1.9956352 actual); 0.0000 diff; ok
  99: cbrt =     4.6260650 (    4.6260650 actual); 0.0000 diff; ok
 100: sqrt =    10.0000000 (   10.0000000 actual); 0.0000 diff; ok
 100: log =     2.0000000 (    2.0000000 actual); 0.0000 diff; ok
 100: cbrt =     4.6415888 (    4.6415888 actual); 0.0000 diff; ok
 101: sqrt =    10.0498756 (   10.0498756 actual); 0.0000 diff; ok
 101: log =     2.0043214 (    2.0043214 actual); 0.0000 diff; ok
 101: cbrt =     4.6570095 (    4.6570095 actual); 0.0000 diff; ok
1000: sqrt =    31.6227766 (   31.6227766 actual); 0.0000 diff; ok
Traceback (most recent call last):
  File "/CS212/Unit3HW.py", line 296, in <module>
    print test()
  File "/CS212/Unit3HW.py", line 286, in test
    test1(n, 'log', log10(n), math.log10(n))
  File "/CS212/Unit3HW.py", line 237, in f_1
    if f(mid) < y:
  File "/CS212/Unit3HW.py", line 270, in power10
    def power10(x): return 10**x
OverflowError: (34, 'Result too large') 
```

这是测试功能：

```
def test():
    import math
    nums = [2,4,6,8,10,99,100,101,1000,10000, 20000, 40000, 100000000]
    for n in nums:
        test1(n, 'sqrt', sqrt(n), math.sqrt(n))
        test1(n, 'log', log10(n), math.log10(n))
        test1(n, 'cbrt', cbrt(n), n**(1./3.))

def test1(n, name, value, expected):
    diff = abs(value - expected)
    print '%6g: %s = %13.7f (%13.7f actual); %.4f diff; %s' %(
        n, name, value, expected, diff,
        ('ok' if diff < .002 else '**** BAD ****')) 
```

这些是测试的设置方式：

```
#Using inverse() or inverse1() depending on desired method
def power10(x): return 10**x
def square(x): return x*x
log10 = inverse(power10)
def cube(x): return x*x*x
sqrt = inverse(square)
cbrt = inverse(cube)
print test() 
```

发布的其他解决方案似乎在运行全套测试输入时没有问题（我试图不查看发布的解决方案）。对此错误有任何见解吗？

* * *

似乎共识是数字的大小，但是，我教授的代码似乎适用于所有情况：

```
#Prof's code:
def inverse2(f, delta=1/1024.):
    def f_1(y):
        lo, hi = find_bounds(f, y)
        return binary_search(f, y, lo, hi, delta)
    return f_1

def find_bounds(f, y):
    x = 1
    while f(x) < y:
        x = x * 2
    lo = 0 if (x ==1) else x/2
    return lo, x

def binary_search(f, y, lo, hi, delta):
    while lo <= hi:
        x = (lo + hi) / 2
        if f(x) < y:
            lo = x + delta
        elif f(x) > y:
            hi = x - delta
        else:
            return x;
    return hi if (f(hi) - y < y - f(lo)) else lo

log10 = inverse2(power10)
sqrt = inverse2(square)
cbrt = inverse2(cube)

print test() 
```

结果：

```
 2: sqrt =     1.4134903 (    1.4142136 actual); 0.0007 diff; ok
     2: log =     0.3000984 (    0.3010300 actual); 0.0009 diff; ok
     2: cbrt =     1.2590427 (    1.2599210 actual); 0.0009 diff; ok
     4: sqrt =     2.0009756 (    2.0000000 actual); 0.0010 diff; ok
     4: log =     0.6011734 (    0.6020600 actual); 0.0009 diff; ok
     4: cbrt =     1.5865107 (    1.5874011 actual); 0.0009 diff; ok
     6: sqrt =     2.4486818 (    2.4494897 actual); 0.0008 diff; ok
     6: log =     0.7790794 (    0.7781513 actual); 0.0009 diff; ok
     6: cbrt =     1.8162270 (    1.8171206 actual); 0.0009 diff; ok
     8: sqrt =     2.8289337 (    2.8284271 actual); 0.0005 diff; ok
     8: log =     0.9022484 (    0.9030900 actual); 0.0008 diff; ok
     8: cbrt =     2.0009756 (    2.0000000 actual); 0.0010 diff; ok
    10: sqrt =     3.1632442 (    3.1622777 actual); 0.0010 diff; ok
    10: log =     1.0009756 (    1.0000000 actual); 0.0010 diff; ok
    10: cbrt =     2.1534719 (    2.1544347 actual); 0.0010 diff; ok
    99: sqrt =     9.9506714 (    9.9498744 actual); 0.0008 diff; ok
    99: log =     1.9951124 (    1.9956352 actual); 0.0005 diff; ok
    99: cbrt =     4.6253061 (    4.6260650 actual); 0.0008 diff; ok
   100: sqrt =    10.0004883 (   10.0000000 actual); 0.0005 diff; ok
   100: log =     2.0009756 (    2.0000000 actual); 0.0010 diff; ok
   100: cbrt =     4.6409388 (    4.6415888 actual); 0.0007 diff; ok
   101: sqrt =    10.0493288 (   10.0498756 actual); 0.0005 diff; ok
   101: log =     2.0048876 (    2.0043214 actual); 0.0006 diff; ok
   101: cbrt =     4.6575475 (    4.6570095 actual); 0.0005 diff; ok
  1000: sqrt =    31.6220242 (   31.6227766 actual); 0.0008 diff; ok
  1000: log =     3.0000000 (    3.0000000 actual); 0.0000 diff; ok
  1000: cbrt =    10.0004883 (   10.0000000 actual); 0.0005 diff; ok
 10000: sqrt =    99.9991455 (  100.0000000 actual); 0.0009 diff; ok
 10000: log =     4.0009756 (    4.0000000 actual); 0.0010 diff; ok
 10000: cbrt =    21.5436456 (   21.5443469 actual); 0.0007 diff; ok
 20000: sqrt =   141.4220798 (  141.4213562 actual); 0.0007 diff; ok
 20000: log =     4.3019052 (    4.3010300 actual); 0.0009 diff; ok
 20000: cbrt =    27.1449150 (   27.1441762 actual); 0.0007 diff; ok
 40000: sqrt =   199.9991455 (  200.0000000 actual); 0.0009 diff; ok
 40000: log =     4.6028333 (    4.6020600 actual); 0.0008 diff; ok
 40000: cbrt =    34.2003296 (   34.1995189 actual); 0.0008 diff; ok
 1e+08: sqrt =  9999.9994545 (10000.0000000 actual); 0.0005 diff; ok
 1e+08: log =     8.0009761 (    8.0000000 actual); 0.0010 diff; ok
 1e+08: cbrt =   464.1597912 (  464.1588834 actual); 0.0009 diff; ok
None 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T19:42:31.547

这实际上是您对*数学*而不是程序的理解的问题。该算法很好，但提供的初始条件不是。

你`inverse(f, delta)`这样定义：

```
def inverse(f, delta=1e-5):
    ...
    def newton(y, iters=15):
        guess = float(y)/2
        ...
    return newton 
```

所以你猜 1000 = 10 ^(*x*)的结果是 500.0，但肯定 10 ^(500)太大了。最初的猜测应该选择对*f有效，而不是为**f*的倒数选择。

我建议您用 1 的猜测值进行初始化，即将该行替换为

```
guess = 1 
```

它应该可以正常工作。

* * *

顺便说一句，您的二进制搜索的初始条件也是错误的，因为您假设解决方案在 0 和*y*之间：

```
low, high = 0, float(y) 
```

这对您的测试用例来说是正确的，但是很容易构建反例，例如 log [10] 0.1 (= -1)、√0.36 (= 0.6) 等。（您教授的`find_bounds`方法确实解决了 √0.36 问题，但仍然不会处理 log [10] 0.1 问题。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T19:05:42.217

我追踪了你的错误，但它基本上归结为 10**10000000 导致 python 溢出。使用数学库快速检查

```
math.pow(10,10000000)

Traceback (most recent call last):
  File "<pyshell#3>", line 1, in <module>
    math.pow(10,10000000)
OverflowError: math range error 
```

我为你做了一些研究，发现了这个

[处理代码中的大数字](https://stackoverflow.com/questions/1386604/handling-big-numbers-in-code)

您需要重新评估为什么需要计算如此大的数字（并相应地更改您的代码 :: 建议）或开始寻找一些更大的数字处理解决方案。

您可以编辑逆函数以检查某些输入是否会导致它失败（try 语句），如果函数不是单调增加，这也可以解决零除法的一些问题，并避免这些区域或

您可以在关于 y=x 的“有趣”区域中镜像许多点，并通过这些点使用插值方案来创建“逆”函数（厄米特、泰勒级数等）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T19:03:33.467

如果您使用的是 Python 2.x，`int`并且`long`是不同的类型，`OverflowError`则只能导致`ints`(qv, [Built-in Exceptions](http://docs.python.org/library/exceptions.html#exceptions.OverflowError) )。尝试显式使用`longs`（通过`long()`在整数值上使用内置函数，或附加`L`到数字文字）。

编辑：显然，正如 Paul Seeb 和 KennyTM 在他们出色的答案中指出的那样，这不是算法缺陷的补救措施。

# objective-c - 使用 AVFoundation 捕获视频时崩溃

> ID：11214052
> 
> 赞同：1
> 
> 时间：2012-06-26T18:49:27.960
> 
> 标签：objective-c, ios, xcode, avfoundation

我正在尝试使用 AVFoundation 在我的应用程序中实现视频捕获。我在 viewDidLoad 下有以下代码：

```
session = [[AVCaptureSession alloc] init];
movieFileOutput = [[AVCaptureMovieFileOutput alloc] init];
videoInputDevice = [[AVCaptureDeviceInput alloc] init];
AVCaptureDevice *videoDevice = [self frontFacingCameraIfAvailable];

if (videoDevice)
{
    NSError *error;

    videoInputDevice = [AVCaptureDeviceInput deviceInputWithDevice:videoDevice error:&error];

    if (!error)
    {
        if ([session canAddInput:videoInputDevice])
            [session addInput:videoInputDevice];
        else 
            NSLog (@"Couldn't add input.");
    }

}

AVCaptureDevice *audioCaptureDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeAudio];
NSError *audioError = nil;
AVCaptureDeviceInput *audioInput = [AVCaptureDeviceInput deviceInputWithDevice:audioCaptureDevice error:&audioError];

if (audioInput)
{
    [session addInput:audioInput];
}

movieFileOutput = [[AVCaptureMovieFileOutput alloc] init];

Float64 TotalSeconds = 35;          //Total seconds
int32_t preferredTimeScale = 30;    //Frames per second
CMTime maxDuration = CMTimeMakeWithSeconds(TotalSeconds, preferredTimeScale);   
movieFileOutput.maxRecordedDuration = maxDuration;

movieFileOutput.minFreeDiskSpaceLimit = 1024 * 1024;                        

if ([session canAddOutput:movieFileOutput])
    [session addOutput:movieFileOutput];

[session setSessionPreset:AVCaptureSessionPresetMedium];
if ([session canSetSessionPreset:AVCaptureSessionPreset640x480])        //Check size based configs are supported before setting them
    [session setSessionPreset:AVCaptureSessionPreset640x480];

[self cameraSetOutputProperties];

[session startRunning]; 
```

此代码在用于启动捕获的按钮的实现中，除其他外：

```
NSString *outputPath = [[NSString alloc] initWithFormat:@"%@%@", NSTemporaryDirectory(), @"output.mov"];
NSURL *outputURL = [[NSURL alloc] initFileURLWithPath:outputPath];
NSFileManager *fileManager = [NSFileManager defaultManager];
if ([fileManager fileExistsAtPath:outputPath])
{
    NSError *error;
    if ([fileManager removeItemAtPath:outputPath error:&error] == NO)
    {
        //Error - handle if requried
    }
}
[outputPath release];
//Start recording
[movieFileOutput startRecordingToOutputFileURL:outputURL recordingDelegate:self];
[outputURL release]; 
```

当我尝试在设备上运行它时，当我尝试加载所有这些都应该发生的视图时它会崩溃。Xcode 给了我一个“线程 1：EXC_BAD_ACCESS (code=1, address=0x4) 在：

```
AVFoundation`-[AVCaptureDeviceInput _setDevice:]:
(stuff)
0x3793f608:  ldr    r0, [r1, r0] 
```

错误在最后一行给出。我认为这与某处的 AVCaptureDeviceInput 有关，但我对它可能是什么一无所知。有谁知道我在这里缺少什么？谢谢。

编辑：摆弄断点后，我发现崩溃发生在这一行：

```
AVCaptureDevice *videoDevice = [self frontFacingCameraIfAvailable]; 
```

那么与该方法有关吗？这是我的实现文件，也许那里有问题。

```
NSArray *videoDevices = [AVCaptureDevice devicesWithMediaType:AVMediaTypeVideo];
AVCaptureDevice *captureDevice = nil;
for (AVCaptureDevice *device in videoDevices)
{
    if (device.position == AVCaptureDevicePositionFront)
    {
        captureDevice = device;
        break;
    }
}

//  couldn't find one on the front, so just get the default video device.
if ( ! captureDevice)
{
    captureDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
}

return captureDevice; 
```

编辑2：可能是我正在使用

```
AVCaptureDevice *videoDevice = [self frontFacingCameraIfAvailable]; 
```

并且“自我”以某种方式向其中扔了扳手？我知道在创建 CALayer 时可以这样做

```
CALayer *aLayer = [CALayer layer]; 
```

但我不知道与此等效的 AVCaptureDevice（如果有的话）。我不确定它还能是什么，总而言之，我的代码看起来不错，我尝试过清理项目、重新启动 Xcode、重新启动计算机等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:00:51.070

我很确定问题在于您正在模拟器上运行程序。模拟器无法使用这些资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T18:05:09.683

设法解决了这个问题（也许）。

添加

```
@property (nonatomic, retain) AVCaptureDeviceInput *videoInputDevice; 
```

到接口，在实现中合成，并使用这些方法获得前置摄像头：

```
- (AVCaptureDevice *) cameraWithPosition:(AVCaptureDevicePosition) position
{
NSArray *devices = [AVCaptureDevice devicesWithMediaType:AVMediaTypeVideo];
for (AVCaptureDevice *device in devices) {
    if ([device position] == position) {
        return device;
    }
}
return nil;
}

-(AVCaptureDevice *)frontFacingCamera
{
return [self cameraWithPosition:AVCaptureDevicePositionFront]; 
```

然后分配给它

```
videoInputDevice = [AVCaptureDeviceInput deviceInputWithDevice:[self frontFacingCamera] error:&error]; 
```

不能 100% 确定它是否有效，因为现在它无法保存，但它不再崩溃了。当我确定它是否有效时，会回来更新它。

# javascript - 从另一个网站拖放图像到我的

> ID：11214053
> 
> 赞同：28
> 
> 时间：2012-06-26T18:49:40.190
> 
> 标签：javascript, jquery, drag-and-drop, cross-domain

我跑了一个快速的 google 和 SO 搜索，发现了类似的问题，但没有一个是正确的，而且大多数都是旧的，看起来被遗弃了（没有答案，有一段时间没有评论）。所以这里...

我希望能够收集从另一个网站拖放到我的网站上的图像的 url（只有 url）..（即我打开了两个 chrome 窗口。窗口 A 有我的应用程序。窗口 B 有 imgur 在它. 我打开一个图片点击并将其拖到我的窗口然后放手。现在我需要知道在我的页面上放置的图片的url）。

这是我用于本地文件的代码。

```
$(document).on('drop', function(e) {
    var data = e.dataTransfer || e.originalEvent.dataTransfer;
    console.log(data); // data.files is empty
    e.preventDefault();
    return false;
});​ 
```

同样，我不想上传任何东西.. 我不想做任何花哨的事情...我只需要知道从另一个网站拖放到页面上的图像的位置。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-26T19:02:04.930

试试这个：http: [//jsfiddle.net/2Jet2/70/](http://jsfiddle.net/2Jet2/70/)

```
$(document).on('dragover', function(e) {
     e.preventDefault();
});
$(document).on('drop', function(e) {
    e.preventDefault();
    e.originalEvent.dataTransfer.items[0].getAsString(function(url){
        alert(url);
    });
});​ 
```

`"http://static3.flattr.net/thing/image/9/4/5/5/0/huge.png?1326712342"`当我从另一个浏览器窗口拖动该图像时，我得到了。

`.getAsString`接受一个回调，一旦它被调用，它就会将 url 作为参数

在火狐上不起作用

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-29T07:56:15.430

你可以用这个

```
$(document).bind('drop', function (e) {        
    var url = $(e.originalEvent.dataTransfer.getData('text/html')).filter('img').attr('src');
    if (url) {
        jQuery('<img/>', {
            src: url,
            alt: "resim"
        }).appendTo('#yourId');            
    }
    return false;
}) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-09T09:43:20.990

根据尤努斯的回答，这似乎适用于 FF：

```
e.originalEvent.dataTransfer.getData('text/html').match(/src\s*=\s*"(.+?)"/)[1] 
```

# c++ - 'double& Point::operator[](unsigned int)' 在此上下文中不可访问

> ID：11214054
> 
> 赞同：5
> 
> 时间：2012-06-26T18:49:48.927
> 
> 标签：c++, inheritance, compiler-errors, operator-overloading

我有两个类设置如下：

```
class Point {
protected:
    double coords[3];

public:
    Point(double x, double y, double z) {
        setX(x);
        setY(y);
        setZ(z);
    };
    ~Point() {};
    double x() {return coords[0];};
    double y() {return coords[1];};
    double z() {return coords[2];};
    void setX(double x) {
        coords[0] = x;
    };
    void setY(double y) {
        coords[1] = y;
    };
    void setZ(double z) {
        coords[2] = z;
    };
    double &operator[](unsigned int x) {
        return coords[x];
    }
};

class Vector:Point {

public:
    Vector(double x, double y, double z);
    ~Vector() {};
    double norm();
    void normalize();
}; 
```

现在每当我尝试做类似的事情时：

```
Vector v;
printf("%d\n", v[0]); 
```

我得到：

```
error: ‘Point’ is not an accessible base of ‘Vector’
error: ‘double& Point::operator[](unsigned int)’ is inaccessible
error: within this context 
```

为什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-26T18:51:16.027

类继承默认是私有的。您必须明确告诉编译器您想要公共继承：

```
class Vector : public Point { // public

public:
    Vector(double x, double y, double z);
    ~Vector() {};
    double norm();
    void normalize();
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T18:51:13.793

类的默认继承说明符是私有的。

# amazon-ec2 - 如何在 ec2 上监控 rails app 的流量？

> ID：11214055
> 
> 赞同：0
> 
> 时间：2012-06-26T18:49:55.483
> 
> 标签：amazon-ec2, monitoring

我在我的 ec2 实例上创建了一个 rails 应用程序。今天我检查了所有日志，发现有人试图访问 phpadmin（实际上不在路径上）。我注意到使用不同的 phpadmin 路径进行了几次尝试。所以很明显有人试图通过 phpadmin 破解 DB。

在所有这些解释之后..这是我的问题..如何在我的 ec2 实例上获得此类恶意尝试的警报？是否有任何免费的云监控服务可供我实际查看哪个 IP 地址尝试了什么样的路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T02:15:31.913

虽然有一些工具可以让您将日志发送到服务（[Paper Trail](https://papertrailapp.com/)是一个很棒的在线日志应用程序，我已经开始使用它并且有一个很棒的免费计划），但在这种情况下，我实际上会使用一些有点不同 - 设置了一个 cron 任务，以便它扫描您的应用程序的日志文件，然后通过邮件将输出发送给您。

```
egrep '(myadmin|php|pgadmin)' /path/to/logfile | mail your@email.here 
```

过去，这对我来说效果很好——当我需要提醒一些对服务器来说不是实时关键的东西时。

# c# - 获取 DayOfWeek 值的本地化字符串

> ID：11214057
> 
> 赞同：13
> 
> 时间：2012-06-26T18:50:01.613
> 
> 标签：c#, .net, datetime, date, localization

此代码未本地化：

```
Enum.GetNames(typeof(DayOfWeek)) 
```

我想要一个返回本地化字符串列表的方法，从任意 DayOfWeek 开始，这是本地化的，我想使用内置资源来做到这一点。到目前为止，我已经想出了下面的代码，但我觉得应该以一种不像黑客的方式来支持它。

```
 public List<String> GetLocalizedDayOfWeekValues(DayOfWeek startDay = DayOfWeek.Sunday)
    {
        var days = new List<String>();
        DateTime date = DateTime.Today;

        while (date.DayOfWeek != startDay)
            date.AddDays(1);

        for (int i = 0; i < 7; i++)
            days.Add(date.ToString("dddd"));

         return days; 
    } 
```

知道更好的方法，请分享。谢谢！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-26T18:53:32.770

我想你正在寻找[`DateTimeFormatInfo.DayNames`](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.daynames.aspx). 示例代码：

```
using System;
using System.Globalization;

class Program
{
    public static void Main()
    {
        var french = new CultureInfo("FR-fr");
        var info = french.DateTimeFormat;
        foreach (var dayName in info.DayNames)
        {
            // dimanche, lundi etc
            Console.WriteLine(dayName);
        }
    }    
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T19:09:09.187

这些方法将为您提供日期名称列表，默认为指定区域性一周的第一天：

```
public List<String> GetLocalizedDayOfWeekValues(CultureInfo culture)
{
    return GetLocalizedDayOfWeekValues(culture, culture.DateTimeFormat.FirstDayOfWeek);
}

public List<String> GetLocalizedDayOfWeekValues(CultureInfo culture, DayOfWeek startDay)
{
    string[] dayNames = culture.DateTimeFormat.DayNames;
    IEnumerable<string> query = dayNames
        .Skip((int) startDay)
        .Concat(
            dayNames.Take((int) startDay)
        );

    return query.ToList();
} 
```

比较...

```
List<string> dayNames = GetLocalizedDayOfWeekValues(new CultureInfo("fr-fr")); 
```

...到...

```
List<string> dayNames = GetLocalizedDayOfWeekValues(new CultureInfo("fr-ca")); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-29T04:07:28.197

我会把它扔进去。原始帖子似乎想要当前语言的日期名称。这可能来自于文化设置：

System.Threading.Threads.CurrentThread.CurrentCulture

这种文化的**DateTimeFormatInfo**对象很容易检索，您可以使用 GetDayName：

```
DateTimeFormatInfo.CurrentInfo.GetDayName(dayOfWeek) 
```

但是，如果您使用 CurrentUICulture/CurrentCulture 范例，仅获取日期名称，CurrentUICulture 更合适。对于居住在美国的人，CurrentCulture 完全有可能设置为 en-US，但对于说/读西班牙语的人，CurrentUICulture 设置为 es-MX 或 es-US。日期格式应该使用文化设置：mm/dd/yyyy，但对于日期名称，它应该使用 UIculture 设置：Lunes、Martes 等。

出于这个原因，我建议使用这种技术：

```
public String getLocalDayName( DayOfWeek dayOfweek) {
    var culture = System.Threading.Thread.CurrentThread.CurrentUICulture;
    var format = culture.DateTimeFormat;
    return format.GetDayName(dayOfweek);
} 
```

# drupal - FTP到Drupal站点/默认/文件权限错误

> ID：11214060
> 
> 赞同：0
> 
> 时间：2012-06-26T18:50:15.123
> 
> 标签：drupal, permissions, ftp, drupal-7

我想通过 FTP 将文件上传到 Drupal 7 中的 sites/default/sites 目录，但我收到 550 access denied 错误。我也无法对其进行 CHMOD，因为我得到 550: Operation not allowed。我用谷歌搜索了这个，但似乎找不到答案。这是在共享主机上，所以我无法访问终端。有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T04:17:48.010

drupal 在 sites/default/files 目录中创建的所有文件都使用*apache*用户。因此，如果您不是 root 用户，则通过 ftp，您将无法更改任何内容，并且 apache 用户没有登录访问权限，因此即使在那里也无法更改。实现这一点的唯一方法似乎是使用任一根用户。还可以考虑使用一些文件浏览器模块或 IMCE 或类似的东西。

# linux - 为什么我通过 ptrace 注入的这个 sendmsg() 调用不起作用？

> ID：11214066
> 
> 赞同：3
> 
> 时间：2012-06-26T18:50:32.067
> 
> 标签：linux, assembly, arm, file-descriptor, ptrace

我正在尝试将命令注入到我拥有的进程中 - 具体来说，我目前正在尝试将 ptraced 进程的文件描述符传递给 ptracing 进程。我成功地创建了一个 unix 域套接字并连接它（据我所见），如下所示：

```
#define stack_pointer(regs) regs.uregs[13]
#define jumpback_pointer(regs) regs.uregs[14]
#define ip(regs) regs.uregs[15]
#define arg0(regs) regs.uregs[0]
#define arg1(regs) regs.uregs[1]
#define arg2(regs) regs.uregs[2]
#define arg3(regs) regs.uregs[3]

#define ROUND_SIZE_TO_WORD(n) ((((n) - 1) / 4 + 1) * 4)

  // create a socket on the other side
  jumpback_pointer(regs) = 0; // please crash after completion
  ip(regs) = libc_offset + 0x0000cfd4/*socket*/;
  arg0(regs) = PF_UNIX;
  arg1(regs) = SOCK_STREAM;
  arg2(regs) = 0;
  ptrace(PTRACE_SETREGS, pid, NULL, &regs);
  assert(ptrace(PTRACE_CONT, pid, NULL, 0) == 0);
  int waitpid_result;
  assert(waitpid(pid, &waitpid_result, 0) == pid);
  assert(WIFSTOPPED(waitpid_result));
  printf("child was killed with signal %i, we expected it to be killed with SIGSEGV (%i)\n", WSTOPSIG(waitpid_result), SIGSEGV);
  struct pt_regs after_socket_regs;
  assert(ptrace(PTRACE_GETREGS, pid, NULL, &after_socket_regs) == 0);
  int remote_socket_id = arg0(after_socket_regs);
  printf("remote socket created, id=%i\n", remote_socket_id);

  // create a socket on our side and bind it
  int attacker_unix_socket = socket(PF_UNIX, SOCK_STREAM, 0);
  printf("local socket created, id=%i\n", attacker_unix_socket);
  int sockaddr_un_size_r = ROUND_SIZE_TO_WORD(sizeof(struct sockaddr_un)); // round up to words
  if ((sockaddr_un_size_r / 4) * 4 != sockaddr_un_size_r) {
    puts("struct sockaddr_un not properly sized");
    exit(1);
  }
  struct sockaddr_un *sockaddr = malloc(sockaddr_un_size_r);
  sockaddr->sun_family = AF_UNIX;
  strcpy(sockaddr->sun_path, "/tmp/ownage");
  unlink(sockaddr->sun_path);
  assert(bind(attacker_unix_socket, (struct sockaddr *) sockaddr, sizeof(struct sockaddr_un)) == 0);
  assert(listen(attacker_unix_socket, 5) == 0);

  // connect the victim socket
  int child_pid;
  if ((child_pid = fork())) {
    // the parent process takes care of running commands on the victim
    // side - the child isn't allowed to do this
    regs = orig_regs;
    stack_pointer(regs) -= sockaddr_un_size_r; // prepare stack push
    masspoke(pid, sockaddr, stack_pointer(regs), sockaddr_un_size_r); // stack push
    jumpback_pointer(regs) = 0;
    ip(regs) = libc_offset + 0x0000d030/*connect*/;
    arg0(regs) /*sockfd*/ = remote_socket_id;
    arg1(regs) /*addr*/ = stack_pointer(regs);
    arg2(regs) /*addr_len*/ = sizeof(struct sockaddr_un);
    assert(ptrace(PTRACE_SETREGS, pid, NULL, &regs) == 0);
    assert(ptrace(PTRACE_CONT, pid, NULL, 0) == 0);
    assert(waitpid(pid, NULL, 0) == pid);
    struct pt_regs after_connect_regs;
    assert(ptrace(PTRACE_GETREGS, pid, NULL, &after_connect_regs) == 0);
    if (arg0(after_connect_regs)) {
      printf("remote socket connect() failed with return value %li\n", arg0(after_connect_regs));
      exit(1);
    }
    printf("remote socket connected\n"); 
```

但是，实际上发送带有以下代码的文件描述符（这是[this](http://fossies.org/unix/misc/lftp-4.3.7.tar.gz%3at/lftp-4.3.7/lib/passfd.c)的修改形式）失败了：

```
 regs = orig_regs;

  int fd = 10;
  char byte = 0;
  struct iovec iov;
  struct msghdr msg;
  struct cmsghdr *cmsg;
  char buf[CMSG_SPACE (sizeof fd)];

  /* send at least one char */
  memset (&msg, 0, sizeof msg);
  iov.iov_base = &byte;
  iov.iov_len = 1;
  msg.msg_iov = &iov;
  msg.msg_iovlen = 1;
  msg.msg_name = NULL;
  msg.msg_namelen = 0;

  msg.msg_control = buf;
  msg.msg_controllen = sizeof buf;
  cmsg = (struct cmsghdr *) buf;
  cmsg->cmsg_level = SOL_SOCKET;
  cmsg->cmsg_type = SCM_RIGHTS;
  cmsg->cmsg_len = CMSG_LEN (sizeof fd);
  /* Initialize the payload: */
  memcpy (CMSG_DATA (cmsg), &fd, sizeof fd);

  // copy structs over
  long r_buf = stack_pointer(regs) -= ROUND_SIZE_TO_WORD(sizeof(buf));
  masspoke(pid, buf, r_buf, sizeof(buf));
  msg.msg_control = (char **) r_buf;

  long r_byte = stack_pointer(regs) -= ROUND_SIZE_TO_WORD(sizeof(byte));
  masspoke(pid, &byte, r_byte, sizeof(byte));
  iov.iov_base = (char *) r_byte;

  long r_iov = stack_pointer(regs) -= ROUND_SIZE_TO_WORD(sizeof(iov));
  masspoke(pid, &iov, r_iov, sizeof(iov));
  msg.msg_iov = (struct iovec *) r_iov;

  long r_msg = stack_pointer(regs) -= ROUND_SIZE_TO_WORD(sizeof(msg));
  masspoke(pid, &msg, r_msg, sizeof(msg));

  // call it
  jumpback_pointer(regs) = 0;
  ip(regs) = libc_offset + 0x0000d188;
  arg0(regs) = remote_socket_id;
  arg1(regs) = r_msg;
  arg2(regs) = 0;
  ptrace(PTRACE_SETREGS, pid, NULL, &regs);
  assert(ptrace(PTRACE_CONT, pid, NULL, 0) == 0);
  assert(waitpid(pid, NULL, 0) == pid);
  struct pt_regs after_sendmsg_regs;
  assert(ptrace(PTRACE_GETREGS, pid, NULL, &after_sendmsg_regs) == 0);

  if (arg0(after_sendmsg_regs) != iov.iov_len) {
    printf("sendmsg() failed (returned %li)\n", arg0(after_sendmsg_regs));
    exit(1);
  }
  printf("successfully called sendmsg() on the other side!\n"); 
```

`sendmsg()`总是失败`-1`。所以，我的问题是，有谁知道为什么这不起作用，或者至少能够告诉我如何尝试找到 errno 以获取有关错误的一些线索？我试过这个来找到errno，但`PTRACE_PEEKDATA`总是失败：

```
void print_error(int pid, struct pt_regs regs, unsigned int libc_offset) {
  // call __errno to get a pointer to the errno
  jumpback_pointer(regs) = 0; // crash afterwards
  ip(regs) = libc_offset + LIBC_ERRNO;
  ptrace(PTRACE_SETREGS, pid, NULL, &regs);
  assert(ptrace(PTRACE_CONT, pid, NULL, 0) == 0);
  int waitpid_result;
  assert(waitpid(pid, &waitpid_result, 0) == pid);
  struct pt_regs after___errno_regs;
  assert(ptrace(PTRACE_GETREGS, pid, NULL, &after___errno_regs) == 0);
  long errno_fn_addr = arg0(after___errno_regs);
  long child_errno = ptrace(PTRACE_PEEKDATA, pid, errno_fn_addr, NULL);
  int peek_errno = errno;
  printf("ERROR IN PTRACED PROCESS: %s (errno@%lx=%li), peek errno: %s\n", strerror(child_errno), errno_fn_addr, child_errno, strerror(peek_errno));
} 
```

# haskell - Haskell中的织物等效物？

> ID：11214070
> 
> 赞同：8
> 
> 时间：2012-06-26T18:50:43.083
> 
> 标签：haskell, deployment

是否有与 Python 的[Fabric](http://docs.fabfile.org)等效的 Haskell 工具？自动部署到生产服务器的东西？

以下是我希望它做的一些事情（我不想用 bash 编写）：

1.  能够为其提供“版本”号以进行部署
2.  将程序的新编译二进制文件上传到服务器（可能使用类似 rsync 的工具）
3.  签出或导出 git 或 svn 存储库的给定“标签”到`webapps/site`目录中
4.  重启一个 ubuntu 的新贵作业/服务

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T07:07:27.593

查看由 Michael Snoyman 撰写的[Keter ，他还创建了 Haskell Web 框架](https://github.com/snoyberg/keter)[Yesod](http://www.yesodweb.com/)。它是*Yesod（和其他 Haskell）网络应用程序的部署系统*。

一个更通用的工具是[Nemesis](https://github.com/nfjinjing/nemesis)。*类似 rake 的任务管理工具*，参考 Ruby 的[Rake](http://rake.rubyforge.org/)工具。

# python - 在字符串中查找双空格 - Python

> ID：11214074
> 
> 赞同：4
> 
> 时间：2012-06-26T18:51:05.993
> 
> 标签：python, string, find, double

任何人都可以找到更 Python 的、更漂亮的解决方案吗？

我正在遍历文件中的一些文本行，以检查它们是否符合某些条件。由于某种原因，决定行内部的分隔符是' '，即双倍空格。

如何检查文本字符串以验证所有分隔符都是两个空格？行尾的空格不是问题，因为该行最初是 .strip()'ed。

我写了这个，它有效——但它很丑。代码会展示给一些 Python 新手，所以我正在寻找更短、更清晰、更美观的解决方案……</p>

```
ll = ["53.80  64-66-04.630N  52-16-15.355W 25-JUN-1993:16:48:34.00  S10293..  2",
      " 53.80  64-66-04.630N  52-16-15.355W  25-JUN-1993:16:48:34.00  S10293..  2",
      "53.80  64-66-04.630N  52-16-15.355W  25-JUN-1993:16:48:34.00  S10293..  2",
      "  53.80  64-66-04.630N  52-16-15.355W  25-JUN-1993:16:48:34.00  S10293..  2",
      "53.80  64-66-04.630N  52-16-15.355W  25-JUN-1993:16:48:34.00  S10293..  2 ",
      "53.80  64-66-04.630N  52-16-15.355W  25-JUN-1993:16:48:34.00  S10293..  2  ",
      "53.80  64-66-04.630N  52-16-15.355W   25-JUN-1993:16:48:34.00  S10293..  2"]

for ln in ll:
    l = ln.strip()
    bolDS = True
    for n in range(len(l)-1):
        if (n>0 and l[n]==' ' and not ((l[n]==l[n+1])^(l[n]==l[n-1]))):
            bolDS = False

    print "|"+l+"|",bolDS 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-26T18:53:36.140

```
def is_doublespace_separated(input_string):
    return '  '.join(input_string.split()) == input_string.strip() 
```

这有效，因为`string.split`会将您的字符串拆分为任何空格。并`string.join`用分隔符加入列表`string`。在这种情况下，我们使用分隔符`' '`（两个空格）重新加入您的字符串，然后将其与剥离后的版本进行比较（我感觉您已经知道 strip 的作用）。

**这将忽略字符串前面和结尾的空格。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T18:58:36.153

这是一个快速的解决方案：

```
import re

s = "53.80  64-66-04.630N  52-16-15.355W 25-JUN-1993:16:48:34.00  S10293..  2"
s2 = "53.80  64-66-04.630N  52-16-15.355W  25-JUN-1993:16:48:34.00  S10293..  2"

def spaceTest(line):
    matches = re.findall(r'\s+', line.strip())
    return not any(m for m in matches if m != '  ')

print spaceTest(s)
# False
print spaceTest(s2)
# True 
```

还有一种更简单的方法：

```
s.strip().count('  ')+1 == len(s.split()) 
```

这假设分隔符的数量应该比字段的数量少 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:53:16.050

要验证一行是否只有双空格，您可以使用正则表达式（尽管@mgilson 的拆分/连接解决方​​案可能既简单又高效）：

```
import re

ok = re.match(r'(?:\S|(?<!\s)  (?!\s))*$', line) 
```

注意：它不允许在换行符之前尾随双空格，[例如](http://ideone.com/ST1Lm).

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2021-01-31T17:20:46.493

```
ll = ["53.80  64-66-04.630N  52-16-15.355W 25-JUN-1993:16:48:34.00  S10293..  2",
      " 53.80  64-66-04.630N  52-16-15.355W  25-JUN-1993:16:48:34.00  S10293..  2",
      "53.80  64-66-04.630N  52-16-15.355W  25-JUN-1993:16:48:34.00  S10293..  2",
      "  53.80  64-66-04.630N  52-16-15.355W  25-JUN-1993:16:48:34.00  S10293..  2",
      "53.80  64-66-04.630N  52-16-15.355W  25-JUN-1993:16:48:34.00  S10293..  2 ",
      "53.80  64-66-04.630N  52-16-15.355W  25-JUN-1993:16:48:34.00  S10293..  2  ",
      "53.80  64-66-04.630N  52-16-15.355W   25-JUN-1993:16:48:34.00  S10293..  2"]

doubleSpace=ll.find("  ") #this code searches for double space.

print(doubleSpace) 
```

# c# - for循环的优化

> ID：11214075
> 
> 赞同：3
> 
> 时间：2012-06-26T18:51:09.070
> 
> 标签：c#, .net, c#-4.0, optimization

我正在编写一些当前应该尽可能快地运行的 c# 代码，通常以 100% 的速度占用一个内核大约 25 分钟。我需要代码保持单核，因为跨多个内核运行此代码的好处不如同时运行该项目多次

有问题的代码如下：

```
public Double UpdateStuff(){

    ClassA[] CAArray = ClassA[*a very large number indeed*];
    Double Value = 0;
    int length = CAArray.Length;

    for (int i= 0; i< length ; i++)
        {
         Value += CAArray[i].ClassB.Value * CAArray[i].Multiplier;
        }  
    return Value;
} 
```

根据分析器，该代码区域负责应用程序负载的 78%，因此似乎是一个很好的优化候选者。

请注意，该函数已从返回类型 void 更改为返回类型 Double，这是伪代码而非实际代码，以便于阅读。

澄清：.net，c#4.0，visual studio 2010，目标机器：windows server 2008 x64。

编辑：进一步澄清：此上下文中的所有变量都是公共的，而不是属性。CAArray[i].ClassB.Value 中的值将永远改变不能成对匹配的双精度数。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-26T20:34:52.740

你应该删除这个：

```
int length = CAArray.Length; 
```

并用这个替换循环：

```
for (int i= 0; i < CAArray.Length; i++)
{
    Value += CAArray[i].ClassB.Value * CAArray[i].Multiplier;
} 
```

像原始代码一样存储长度实际上*会减慢*C# 代码的速度（我知道这违反直觉）。这是因为如果您在 for 循环中直接有 Array.Length，则抖动将跳过对循环的每次迭代执行数组边界检查。

另外，我强烈建议将此过程并行化。最简单的方法是

```
CAArray.AsParallel().Sum(i => i.ClassB.Value * i.Multiplier); 
```

尽管如果没有 LINQ，您可能*会*获得更快的速度（尽管您随后需要担心管理多个线程的低级细节）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-26T19:02:29.143

一个区别是在 for 循环中使用临时变量来保存当前值。

第二个区别可能更重要，是将 CAArray.Length 而不是 count 放在 for 循环边界中。编译器优化这样的循环以消除边界检查。

```
for (int i = 0; i < CAArray.Length; i++)
{
    var curr = CAArray[i];
    Value += curr.ClassB.Value * curr.Multiplier;
} 
```

如果可以的话，您可以做的另一件事是将 ClassB、ClassB.Value 和 Multiplier 属性设为字段。

最后 - 记得检查解决方案属性中的“优化代码”，让编译器优化您的代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-26T18:54:52.207

尝试：

```
for (int i = 0; i < length; i++)
{
    var a = CAArray[i];
    Value += a.ClassB.Value * a.Multiplier;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-26T18:58:18.267

另一个*可能*影响非常大集合的性能的**微**优化是定义 a ，而不是.*`field``property`*

 *```
for (int i= 0; i< length ; i++)
{
    var a = CAArray[i];
    Value += a.ClassB.value_field * a.multiplier_field;
} 
```

即使使用属性是 MS 建议的指导方针，众所周知，属性会引入非常小的（但可能与非常大的数据相关）开销。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-26T18:56:46.460

如果你有很多重复 wrt multiplier 和`ClassB.Value`s 你可能想找到所有不同的对，将每对相乘一次，然后乘以这对的出现次数。

另外，我会去`AsParallel()`使用所有的核心。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-26T19:41:39.647

我不知道您有多少控制权，`ClassA`但在我看来，既然`Multiplier`和`ClassB`是您的属性，`ClassA`您应该修改`ClassA`为具有此计算值的属性。从理论上讲，您已经将所有这些类都实例化了，并且已经设置了它们各自的属性，因此您可以轻松地计算或`this.ClassB.Value * this.Multiplier`的设置所需的值。通过这种方式，您可以降低此循环的成本，而是将其移向数据的实例化。这是一个值得的权衡吗？您需要更多地了解应用程序中发生的情况才能做出决定，但这会减少此特定功能的工作量。之后，您需要做的就是：`ClassB.Value``Multiplier`

```
public void UpdateStuff(){

    ClassA[] CAArray = ClassA[*a very large number indeed*];
    Double Value = 0;
    int length = CAArray.Length;

    for (int i= 0; i< length ; i++)
    {
        Value += CAArray[i].MultipliedClassBValue;
    }
return Value;
} 
```

加上这里的优秀人员可以提出的任何进一步改进。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-28T08:06:47.183

由于数组具有大量元素，因此这样的方法将比其他迭代循环的方法更快。

```
try
{
    for (int i= 0; ; i++)
    {
        var a = CAArray[i];
        Value += a.ClassB.value_field * a.multiplier_field;
    }
}
catch (IndexOutOfRangeException)
{ } 
```

虽然不可否认，它看起来相当丑陋，并且绝对不是一种“纯粹”的编程方式。但同时使用公共字段而不是属性也不是纯粹的。

除了移除退出条件的好处之外，CLR 2.0 for X86 中的一个奇怪的错误，如果它被 try catch 包围，会使 for 循环运行得更快，因为 Jitter 在这种情况下更喜欢使用寄存器而不是 CPU 堆栈来存储本地变量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-26T19:16:02.893

还有一件事要小心 - 如果您经常分配非常大的数组（86K+ 数据）并且每次您可能会过度强调 GC，因为这些对象是在 LOH 上分配的，因此大小是不同的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-26T19:06:55.680

另一个轻微的改进是对索引使用 preincrement，因为 postincrement 必须返回迭代器在递增之前的值；因此，在使用适当的增量更改它之前，需要将先前的值复制到某个地方，因此它可以返回。

额外的工作可能很少或很多，但它肯定不能小于零，与 preincrement 相比，它可以简单地执行递增然后返回刚刚更改的值 -- 不复制 // 保存 //等必要的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-26T19:14:08.563

1.  并行化它。
2.  尝试展开循环。（编译器可能会自行执行此操作。）

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2012-06-26T19:00:58.313

首先，它是一个 void，所以它不应该返回任何东西（或者它应该返回一个 Double）。其次，C# 通常不使用埃及大括号——但这并不重要。

然后你可以尝试使用 Linq 和 lambdas，我*认为*它可能会更快 - 至少更清洁！

```
public void UpdateStuff()
{
    ClassA[] CAArray = new ClassA[large_number];
    Double Value = CAArray.Select(x => x.ClassB.Value * x.Multiplier).Sum();
} 
```*

# asp.net - 支持部署到 Windows Azure 的论坛软件

> ID：11214077
> 
> 赞同：4
> 
> 时间：2012-06-26T18:51:09.567
> 
> 标签：asp.net, azure, forum

我目前正在寻找在 azure 平台上部署一个网络论坛。

我做了一些研究，到目前为止，我总共找到了 6 个 ASP.Net 论坛：

*   [智能社区](http://telligent.com/social-community-software)
*   [吉比特论坛](http://www.jitbit.com/asp-net-forum/)
*   [即时论坛.Net 2012](http://www.instantasp.co.uk/Products/InstantForum/)
*   [另一个论坛](http://yetanotherforum.net/)
*   [附近论坛](http://www.nearforums.com/)
*   [Mvc论坛](http://mvcforum.org/)

我所知道的：

*   智能社区很难拥有最简单的信息，所以我有点放弃这个进行研究
*   InstantForum.Net 是一个网站项目，它与 azure 不兼容，但在他们的论坛上已于[2011 年](http://community.instantasp.co.uk/16474//Installation-Issues?Keywords=azure)5 月提及该主题，到目前为止还没有新的答案
*   YetAnotherForum 可以与 Azure 兼容，因为它是一个 Web 应用程序项目，他们发布了 SQL Azure 部署的过程，主题也已经[尝试过](https://stackoverflow.com/questions/10949783/integrating-yaf-1-9-5-5-with-azure)，但我还没有尝试部署解决方案来确认它
*   NearForums 是一个可以部署到 Azure 的新项目，但由于它真的很年轻，我不确定并且想要一个更成熟的项目
*   MvcForum 仍处于 alpha 阶段，与 NearForums 处于同一水平
*   Jibit论坛上还没有信息

我错过了什么吗？是否有其他我没有听说过的论坛解决方案或在此处列出的论坛上的任何其他经验？

我正在寻找的关于“支持”部分的标准是它可以通过 Web 角色部署并且不需要 VM。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T08:01:44.810

看看市场：[https ://datamarket.azure.com/browse/Applications?Query=forum](https://datamarket.azure.com/browse/Applications?Query=forum)

一些更广泛的 CMS 产品，例如 Kentico 和 DNN，提供了您可以使用的论坛组件。您可能能够将一些部署到新的网站产品以及已经提到的 VM。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T20:29:02.950

如果您决定选择[适用于 Windows 的 Windows Azure 虚拟机](http://msdn.microsoft.com/en-us/library/windowsazure/jj156003)，则可以毫无问题地运行上述任何 ASP.NET 论坛应用程序。使用适用于 Windows 的 Windows Azure VM，您可以像任何其他 IIS 服务器一样将您的 ASP.NET 应用程序直接部署到您的 VM，并按照您想要的使用方式对其进行配置。

是的，如果您决定选择云服务（或者可能有一些与 Windows Azure 网站一起使用），则使用某些应用程序可能会受到一些限制，但是要在 Windows Azure 虚拟机上运行任何应用程序，则不需要 Windows Azure 兼容性。

# multithreading - 线程虚拟内存状态

> ID：11214078
> 
> 赞同：0
> 
> 时间：2012-06-26T18:51:10.550
> 
> 标签：multithreading, operating-system, virtual-memory

众所周知，在多个线程的情况下，每个线程都维护其单独的堆栈和寄存器状态。

他们是否还维护单独的虚拟内存状态或者可以共享？

我认为在进程之间共享虚拟内存状态应该没有任何问题。

**编辑 ：**

如果线程不保持状态，那么为什么链接（[http://www.geeksforgeeks.org/archives/19913](http://www.geeksforgeeks.org/archives/19913)）上问题 1 的第三个选项不正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T19:25:50.720

每个进程都有自己的***地址空间***，也就是进程可以访问的虚拟地址范围。每个进程可以有多个线程。所以，是的，一个进程中的所有线程共享相同的地址空间。请注意，这是变量可以在同一进程的多个线程之间共享而无需任何特殊机制的主要原因。
另一方面，如果不使用***进程间通信***等特殊机制，则无法在两个独立进程之间共享变量，因为每个进程都有自己的地址空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:51:37.567

他们总是共享记忆。它可以而且确实会导致*很多*问题。

（对于初学者，请查看“多线程”标签。）但是多线程可以让您监听许多不同的输入，*并且*它们可以让您让所有这些 CPU 内核赢得他们的保留。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:03:54.723

没错，两个线程可以共享同一个虚拟内存空间。这本质上（非常肤浅）是线程与进程相关的定义。

# ruby-on-rails-3 - 在 tomcat 上运行的 JRuby 应用程序的序列号

> ID：11214082
> 
> 赞同：0
> 
> 时间：2012-06-26T18:51:22.517
> 
> 标签：ruby-on-rails-3, tomcat, jruby

我有一个 RoR3 应用程序，我将其转换为 jruby 并使用 warbler 来创建战争。它部署在 Windows XP 中（是的，相信我）。

客户需要某种序列号来确保如果有人窃取了他的源代码，它就无法部署到其他任何地方。我可以做一个 keygen 或类似的东西，并根据 MA​​C 生成一个密钥，但我不知道该怎么做。有人有想法吗？我迷失了。

也许我可以开发一个在 Tomcat 启动时执行的进程，如果找不到序列号，就不会部署应用程序。我不知道。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:58:16.247

曾几何时，当我使用 Rails 时，我将[Ruby Encoder](http://rubyencoder.com/) 用于具有类似要求的客户端。它可以将构建绑定到特定的网络接口、CPU 等。IIRC 它只适用于 MRI ruby​​。也许你可以调查一下`jrubyc`？

# algorithm - 了解荷兰国旗计划

> ID：11214089
> 
> 赞同：4
> 
> 时间：2012-06-26T18:51:47.073
> 
> 标签：algorithm, partitioning

我正在阅读[荷兰国旗问题](http://en.wikipedia.org/wiki/Dutch_national_flag_problem)，但无法理解C++ 实现中函数中的`low`和`high`参数是什么。`threeWayPartition`

如果我假设它们是要排序的数组的最小和最大元素，那么`if`and`else if`语句就没有任何意义，因为`(data[i] < low)`它`(data[i] > high)`总是返回零。

我哪里错了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T19:33:51.810

`low`并且`high`是您为执行三路分区而定义的值，即执行三路分区您只需要两个值：

```
[bottom] <= low  < [middle] < high <= [top] 
```

在 C++ 程序中，您要移动的是分区发生的位置。一步一步的例子：

```
data = [ 3, 1, 4, 9, 8, 2, 6, 9, 0 ]
low  = 4
high = 8 
```

```
 [ 3 , 1 , 4 , 9 , 8 , 2 , 6 , 9 , 0 ]
p^  i^                                  q^ 
```

```
 [ 3 , 1 , 4 , 9 , 8 , 2 , 6 , 9 , 0 ]
    p^  i^                              q^ 
```

```
 [ 3 , 1 , 4 , 9 , 8 , 2 , 6 , 9 , 0 ]
        p^  i^                          q^ 
```

```
 [ 3 , 1 , 4 , 9 , 8 , 2 , 6 , 9 , 0 ]
        p^      i^                      q^ 
```

```
 [ 3 , 1 , 4 , 0 , 8 , 2 , 6 , 9 , 9 ]
        p^      i^                  q^ 
```

```
 [ 3 , 1 , 0 , 4 , 8 , 2 , 6 , 9 , 9 ]
            p^      i^              q^ 
```

```
 [ 3 , 1 , 0 , 4 , 9 , 2 , 6 , 8 , 9 ]
            p^      i^          q^ 
```

```
 [ 3 , 1 , 0 , 4 , 6 , 2 , 9 , 8 , 9 ]
            p^      i^      q^ 
```

```
 [ 3 , 1 , 0 , 4 , 6 , 2 , 9 , 8 , 9 ]
            p^          i^  q^ 
```

```
 [ 3 , 1 , 0 , 2 , 6 , 4 , 9 , 8 , 9 ]
                p^         iq^ 
```

正如算法所说：

*   交换底部***上方***的元素（即`p + 1`），因为底部下方的所有内容都已被检查，或者
*   交换顶部***下方***的元素（即 `q - 1`），因为顶部上方的所有内容都已被检查，或者
*   ***将元素留***在原处，因为它属于中间。

你得到`[3, 1, 0, 2]`,`[6, 4]`和`[9, 8, 9]`分别作为底部、中间和顶部分区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T18:54:22.810

`} else if (data[i] >= high) {`表明您所看到的可能不是文章中所写的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:17:45.510

将`low`和`high`视为中间分区中值的半开范围`[low,high)`。所有小于的值`low`都在左分区中。中间分区将包含从`low`到 的值，但不包括`high`。最后，所有大于或等于的值都会`high`出现在正确的分区中。

# arrays - 在 Perl 中返回对数组的引用

> ID：11214091
> 
> 赞同：0
> 
> 时间：2012-06-26T18:51:53.687
> 
> 标签：arrays, perl, parsing, url, reference

首先，让我告诉你，我很少使用数组，从来没有使用过哈希。另外，Perl 不是我最强的脚本语言。我来自 shell 脚本的背景。

也就是说，我在 Perl 脚本中有这个：

```
$monitored_paths = { '/svn/test-repo'  => 'http://....list.txt' }; 
```

URL 指向一个包含如下路径列表的文件：

```
/src/cpp
/src/test
/src/test2 
```

目标是用以下内容替换 URL：

```
$monitored_paths = {'svn/test-repo' => '/src/cpp', '/src/test', '/src/test2'} 
```

实现这一目标的最佳方法是什么？谢谢！

山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:09:15.700

你的问题的前提有一个错误，因为这一行：

```
$monitored_paths = {'svn/test-repo' => '/src/cpp', '/src/test', '/src/test2'} 
```

相当于以下任何一个：

```
$monitored_paths = {'svn/test-repo' => '/src/cpp', '/src/test' => '/src/test2'}
$monitored_paths = {'svn/test-repo', '/src/cpp', '/src/test', '/src/test2'} 
```

你真正想要的是：

```
$monitored_paths = {'svn/test-repo' => ['/src/cpp', '/src/test', '/src/test2']} 
```

其中 [] 表示数组引用。您可以像这样创建一个数组引用：

```
my $arrayref = [1, 2, 3]; # called an "anonymous array reference" 
```

或像这样：

```
my @array = (1, 2, 3);
my $arrayref = \@array; 
```

你想要这样的东西：

```
$monitored_paths = { '/svn/test-repo'  => 'http://....list.txt' }
foreach my $key (keys %$monitored_paths) {
    next if ref $monitored_paths{$key} eq 'ARRAY'; # skip if done already
    my @paths = get_paths_from_url($key);
    $monitored_paths->{$key} = \@paths; # replace URL with arrayref of paths
} 
```

用你的 URL 获取和解析函数替换 get_paths_from_url （使用 LWP 或其他什么......因为这不是你问题的一部分，我假设你已经知道如何做到这一点）。如果您编写函数 get_paths_from_url 以首先返回数组引用而不是数组，则可以保存一个步骤并`$monitored_paths->{$key} = get_paths_from_url($key)`改为编写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:00:10.457

如果您想从文件中读取并将每个路径添加到数组中，您可以执行以下操作：

```
use strictures 1;

my $monitored_paths = {};
open( my $FILE, '<', '/path/to/file' ) or die 'Unable to open file '. $!;
while($FILE){
    push @{ $monitored_paths->{'svn/test-repo'} }, $_;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T18:56:02.840

```
use LWP::Simple;
my $content = get($url); ## do some error checking
$monitored_paths = {'svn/test-repo' => [split( "\n", $content)]} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T20:07:56.093

```
use LWP;
foreach (keys %monitored_paths)
{
   my  $content = get($monitored_paths{$_});# Perform error checking
   $monitored_paths_final {$_} = join(",",split("\n",$content));
} 
```

# python - 在后台运行可执行文件的 CGI 脚本

> ID：11214096
> 
> 赞同：0
> 
> 时间：2012-06-26T18:52:11.893
> 
> 标签：python, subprocess, process

我有一个向这个 cgi 脚本提交数据的页面，然后这个脚本调用另一个可执行文件。问题是这个可执行文件需要很长时间才能运行，因此，它会导致 cgi 脚本暂停直到完成。我正在尝试找到一种在后台运行它的方法。我在linux机器上用python编码。我遇到的问题是当脚本结束时（父进程被杀死），子进程也被 init 终止（根据 linux 规范）。我用谷歌搜索了一下，我遇到了这个线程： [Calling an external command in Python](https://stackoverflow.com/questions/89228/how-to-call-external-command-in-python#2251026)

然后我在我的代码中尝试了以下内容：

```
print <html code>
pid = subprocess.Popen([sys.executable, '/path/to/executable.py '+arg1],
                       stdout=subprocess.PIPE, stderr=subprocess.PIPE, 
                       stdin=subprocess.PIPE)
...
retval = pid.wait()
#For debugging purposes:
print str(retval) + "<br/>"
print </html code> 
```

这给了我一个 '2' 的 retval，我确定这意味着有问题（因为我没有看到正确的输出）我尝试了一些其他方法，但它要么运行脚本并需要一段时间才能加载（意味着它是在前台运行），或者它只是无法一起运行脚本。

想法？谢谢你。哦，顺便说一句，我使用的是 python 2.6

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T20:23:29.680

解决方案是在脚本完成之前生成一些输出。至于我，最好的方法是使用分块[传输编码](http://en.wikipedia.org/wiki/Chunked_transfer_encoding)输出脚本执行日志。

通常，需要在输出开始之前完全生成 CGI 脚本输出。这是计算“Content-Length”标头所必需的。分块传输编码可以解决这个问题 - 您不需要知道对输出块的整个响应。

# python - 从单独线程插入数据库的奇怪 Django 行为

> ID：11214099
> 
> 赞同：1
> 
> 时间：2012-06-26T18:52:23.223
> 
> 标签：python, django

我有一个在 Django 中失败的简单测试用例：

模型（app/models.py）：

```
from django.db import models
class M(models.Model):
    condition = models.CharField(max_length=80, db_index=True) 
```

测试（app/tests.py）：

```
from django.test import TestCase
import threading
import time
from app.models import M

def insert():
    time.sleep(0.3)
    ua = M(condition='x')
    ua.save()

class DjangoRaceTest(TestCase):
    def test_parallel(self):
        insert()  # <--- works
        #threading.Thread(target=insert).start()  # <-- fails

        for i in range(10):
            count = M.objects.all()
            if count:
                return True
            time.sleep(0.1)

        assert count 
```

上面的代码通过；但是如果我注释掉直接调用 insert 而取消注释线程调用，断言失败，我得到：

```
Creating test database for alias 'default'...
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python2.6/threading.py", line 532, in __bootstrap_inner
    self.run()
  File "/usr/lib/python2.6/threading.py", line 484, in run
    self.__target(*self.__args, **self.__kwargs)
  File "/home/jacobsen/testdjango/app/tests.py", line 10, in insert
    ua.save()
  File "/home/jacobsen/dj14/lib/python2.6/site-packages/Django-1.4-py2.6.egg/django/db/models/base.py", line 463, in save
    self.save_base(using=using, force_insert=force_insert, force_update=force_update)
  File "/home/jacobsen/dj14/lib/python2.6/site-packages/Django-1.4-py2.6.egg/django/db/models/base.py", line 551, in save_base
    result = manager._insert([self], fields=fields, return_id=update_pk, using=using, raw=raw)
  File "/home/jacobsen/dj14/lib/python2.6/site-packages/Django-1.4-py2.6.egg/django/db/models/manager.py", line 203, in _insert
    return insert_query(self.model, objs, fields, **kwargs)
  File "/home/jacobsen/dj14/lib/python2.6/site-packages/Django-1.4-py2.6.egg/django/db/models/query.py", line 1576, in insert_query
    return query.get_compiler(using=using).execute_sql(return_id)
  File "/home/jacobsen/dj14/lib/python2.6/site-packages/Django-1.4-py2.6.egg/django/db/models/sql/compiler.py", line 910, in execute_sql
    cursor.execute(sql, params)
  File "/home/jacobsen/dj14/lib/python2.6/site-packages/Django-1.4-py2.6.egg/django/db/backends/sqlite3/base.py", line 337, in execute
    return Database.Cursor.execute(self, query, params)
DatabaseError: no such table: app_m 
```

显然这里有一些 Django 魔法让我失望，或者......什么？我已经在 OS X、Ubuntu 10.04、Django 1.2 和 1.4 的各种组合上对此进行了测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:09:35.410

答案似乎是内存中的sqlite数据库不能跨线程共享。

[这是来自 1.1 的错误报告，](https://code.djangoproject.com/ticket/12118)其中核心开发人员基于[SQLAlchemy 缺乏](http://docs.sqlalchemy.org/en/rel_0_6/dialects/sqlite.html#threading-behavior)对它的支持得出结论，这不是一个错误（在没有来自 sqlite 引用的其他直接信息的情况下）：

> Pysqlite connections do not support being moved between threads, unless the check_same_thread Pysqlite flag is set to False. In addition, when using an in-memory SQLite database, the full database exists only within the scope of a single connection. It is reported that an in-memory database does not support being shared between threads regardless of the check_same_thread flag - which means that a multithreaded application cannot share data from a :memory: database across threads unless access to the connection is limited to a single worker thread which communicates through a queueing mechanism to concurrent threads.

# sql-server-2008 - 当客户端和服务器上都存在相同数据时，同步框架中的插入冲突过多

> ID：11214101
> 
> 赞同：0
> 
> 时间：2012-06-26T18:52:35.153
> 
> 标签：sql-server-2008, ado.net, sync, microsoft-sync-framework

我请求您了解我们在 Sync 方面面临的问题，我需要您的帮助和指导。

我们有： 1) 50 个要同步的表，分为 6 个通用范围和 8 个基于模板的范围（根据 CLIENT 表的 CLIENTID 列进行参数化）。2) 同步从不同的 PC 到 SQL Azure 3) 从 C# WPF 应用程序中，我们选择一个客户端（CLIENTID），运行同步设置（配置），然后使用方法开始同步过程。

我们经常遇到的问题：1）很少有客户端已经同步，在第n个客户端上，由于网络连接问题/超时问题，需要关闭应用程序。当我们再次在该特定客户端上运行配置时，有时会出现 Selectchanges 或 bulkInsert 缺失的异常。

2) 如果发生上述情况，我们取消StoreProvision，然后重新配置。这让我们的客户端和服务器拥有相同的数据集。如果我们继续进行同步，则需要 7 个小时才能完成错误并出现大量 INSERT CONFLICTS。

那么，当在同步过程中，网络连接失败时，COMMIT 会发生在成功运行的范围内吗？或者，很少有运行良好的示波器让我们进行部分同步？除了 e-provision 和 re-provision 之外，有没有办法摆脱插入冲突的数量？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T10:59:37.583

同步框架范围中的事务范围处于范围级别。如果同步范围并由于某种原因中止，则该范围应用的所有更改都会回滚。

如果您有 3 个作用域并且其中一个失败，则只有该作用域被回滚，另外两个被提交。

当您取消配置时，您是取消配置/重新配置整个商店还是仅取消配置/重新配置该特定范围？

# php - PHP递归地从多维数组中提取唯一元素

> ID：11214104
> 
> 赞同：0
> 
> 时间：2012-06-26T18:52:49.197
> 
> 标签：php, multidimensional-array

我有一个多维数组，每个数组都有一个特定的索引，更具体地说，我有一个唯一的 ip 作为索引和条目作为值。

我想从每个数组中递归地提取 1 个值，而不是来自同一个 IP 的 2 个值，并将该束显示为一批。无论如何，我必须展示整套。

更清楚一点，我必须根据 IP 唯一性从整个集合中提取值，每批必须包含 5 个值，并且我必须在列表中显示每个值。IP 的数量从来都不是一个已知值。

例如，如果我有这个数组：

```
Array
  (
    [ip] => Array
    (
        [0] => entry01

        [1] => entery02

        [2] => entery03

        [3] => entery04

    )

 [ip] => Array
     (
        [0] => entery05

     )

 [ip] => Array
     (
        [0] => entery06

     )
 ) 
```

我的最终决心应该是这样的：

```
 entery01, entery05, entery06 
```

现在请注意，我们在第一个数组中仍然有值 entery02-04，这意味着一旦提取完成，我也必须得到它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T18:54:40.113

这个关联数组是不可能的——你只能有一个`ip`键。

编辑：假设`ip`是一个占位符，这是一种方法：`in_array()`如果它不评估为，则使用并添加到结果数组`true`。

```
<?php

$begin = array(
    0 => array( 'entry01', 'entry02', 'entry03' ),
    1 => array( 'entry01', 'entry04' ),
    2 => array( 'entry02', 'entry07' )
);

$results = array();
foreach ( $begin as $k1 => $subarr ) {
    $count = 0;
    foreach ( $subarr as $k2 => $entry ) {
        if ( ! in_array( $entry, $results ) && $count < 1 ) {
            $results[] = $entry;
            $count++;
        }
    }
}
var_dump( $results );

?>

$ php unique_items.php 
array(3) {
  [0]=>
  string(7) "entry01"
  [1]=>
  string(7) "entry04"
  [2]=>
  string(7) "entry02"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T18:57:36.697

```
$events = array();
foreach($data_array as $ip=>$evnt_array){
  foreach($evnt_array as $event){
    if(!in_array($event,$events)){
       $events[] = $event
    }
  }
} 
```

**每条评论**

```
$events = array();
foreach($data_array as $ip=>$evnt_array){
  foreach($evnt_array as $event){
    if(!in_array($event,$events)){
      $events[] = $event
      break;
    }else{
      continue;
    }
  }
 } 
```

在这个例子中，我们只取第一个元素，如果它是唯一的，然后跳出内部循环。如果第一个元素已经被索引，继续下一个并重复检查。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-26T18:57:41.543

我认为这样的事情应该有效

```
$myInputArray = // your array up there
$myOutputArray = array();
foreach($myInputArray as $ip) {
  foreach($ip as $value) {
    if(!in_array($value,$myOutputArray)){
      $myOutputArray[] = $value;
    }
    break;
  }
} 
```

编辑：对不起，我错过了这一行：

> 我想从每个数组中递归地提取 1 个值，而不是来自同一个 IP 的 2 个值，并将该束显示为一批。无论如何，我必须展示整套。

答案已更新

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-26T18:57:51.703

我认为您正在寻找一个 foreach 循环。这只是抓住了第一个。

```
foreach ($arrayName as $ip){
  echo $ip[0];
} 
```

我错过了一些问题。以上部分在我看来不再是有效的回应。我认为一个关联数组的键是 ip，值是 ip 会起作用。如果 ip 的键不存在，请检查数组，如果存在则添加它，从数组中删除该键。如果数组的长度为 5 则可以停止。

# facebook-c#-sdk - 在 Facebook C# SDK v6 中访问查询结果

> ID：11214105
> 
> 赞同：1
> 
> 时间：2012-06-26T18:53:03.330
> 
> 标签：facebook-c#-sdk

在以前的版本中，我能够使用以下方法从查询中检索结果：

```
 var facebookClient = new Facebook.FacebookClient(accessToken);
            const string fqlQuery = "select pic_big from user where uid=me()";
            dynamic result = facebookClient.Query(fqlQuery);

            var profilePhotoUrl = result[0].pic_big.ToString(); 
```

在版本 6 中，我可以完成相同的操作，但使用：

```
 var facebookClient = new Facebook.FacebookClient(accessToken);
            const string fqlQuery = "select pic_big from user where uid=me()";
            dynamic result = facebookClient.Get("fql", new { q = fqlQuery });

            var profilePhotoUrl = result.data[0].pic_big.ToString(); //v6.0 requires us to add ".data[0]" field 
```

新方法有效，但我只想确保：`result.data[0].pic_big.ToString()`是正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:09:28.397

是的，您的新调用（包括数据属性）是正确的。我不确定更改背后的原因。包含 data 属性更准确地模拟了结果的 JSON 结构，但是因为我不知道数据元素是否已经存在。

无论如何：使用 data 属性是从现在开始的方式！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T01:22:54.920

这是关于为什么需要`.data`在 v6 中的说明。

在 v5 中，我们将 rest api 用于 fql，因为它在 graph api 中尚不可用。Rest api 没有环绕，`data`所以你永远不必使用`.data`. 在 v5 的一些更高版本中，当 fb 宣布使用 graph api 支持 fql 时，我们使用移动到 graph api，但是为了避免 v5 中的破坏性更改，sdk`.data`在将结果返回给用户之前在内部删除了（丑陋的 hack）。

以下是 fql 使用图形 api 时 v5 的工作方式。

```
public virtual object Query(string fql)
{
    if (string.IsNullOrEmpty(fql))
        throw new ArgumentNullException("fql");

    var parameters = new Dictionary<string, object>();
    parameters["q"] = fql;

        // when using graph api
    var result = (IDictionary<string, object>)Get("fql", parameters);
    return result["data"];

    /*
        // when using rest api
    var parameters = new Dictionary<string, object>();
    parameters["query"] = fql;
    parameters["method"] = "fql.query";

    return Get(parameters);
    */
} 
```

所以用户甚至不知道这种透明度。由于 v6 是一个主要版本，我们删除了`Query`由于这个丑陋的 hack 解决方法。使用 fql 的唯一方法是调用普通的 get。由于这会返回 fb 给出的确切结果，因此您需要包含`.data`.

# asp.net - 将现有的 .net 功能扩展到 iPad

> ID：11214114
> 
> 赞同：0
> 
> 时间：2012-06-26T18:53:45.563
> 
> 标签：asp.net, .net, ios, silverlight, ipad

我突然提出了将桌面应用程序功能的一部分扩展到 iOS/iPad 平台的需求。

起初，我确定了以下可能的方法。

1.  在 Win CF 中重新创建/重写桌面应用程序的相关部分。

这个选项从一开始就被淘汰了，因为选择的平板电脑原来是 iPad。当然没有办法（据我所知）在 iOS/iPhone 上运行 Win CF 应用程序

第二种选择是在 asp.net 中构建一个基于 Intranet 的小型 Web 应用程序。现在这带来了以下问题。

Q1。我是否需要专门为在 iPhone/iOS 中运行的浏览器设计的自定义第三方 .net 控件？

Q2 如果我使用普通的 asp.net 控件，应用程序会正确呈现吗？如果不是，可能的问题是什么？（只是一个快速的大致解释）

任何额外的见解和帮助都会很好......很大的帮助......因为我没有做过很多移动应用程序。`

我打算最终找出最好的方法......但在这个阶段任何指导都是无价的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T18:57:47.010

让 asp.net 控件在 iPad 中呈现，您不需要做任何额外的事情。在你的用户界面设计中你唯一需要担心的是任何依赖于悬停、鼠标悬停或鼠标移动事件的东西在触摸设备上都是不可用的，因为触摸设备只发送点击事件，或者只发送其他事件。点击一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:52:19.687

在 iOS 上使用[Mono.Touch 来满足您的 .Net 需求](http://xamarin.com/)怎么样？

请注意，您必须重新实现您的 UI 才能使用 Cocoa touch UI；但这一切都在 C#.Net 中！无需接触任何一行 Objective-C 即可部署您的应用程序

现在谈谈你的其他问题：

> Q1。我是否需要专门为在 iPhone/iOS 中运行的浏览器设计的自定义第三方 .net 控件？

这取决于您的应用程序实际上在做什么。iOS 可以像任何其他平台一样呈现 HTML 内容，但您可能必须专门设计页面以针对其小屏幕尺寸和基于触摸的导航。有一些针对 HTML 5 的第三方框架，它们肯定会帮助您快速入门，但我不会说您必须使用它。

> Q2 如果我使用普通的 asp.net 控件，应用程序会正确呈现吗？如果不是，可能的问题是什么？（只是一个快速的大致解释）

鉴于 ASP.Net 页面在提供给客户端之前被呈现为 HTML，iOS 将毫无问题地呈现它（当然，就 HTML 合规性而言）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T21:35:25.493

如果你决定编写一个 Web 应用程序，你应该看看 MVC4。他们为移动设备添加了很多工具，甚至还有一个移动项目模板，并且 jQuery Mobile 已经融入其中。

编辑：这是 MVC4 发行说明的链接：[http ://www.asp.net/whitepapers/mvc4-release-notes](http://www.asp.net/whitepapers/mvc4-release-notes)

If you really want to stand up a web application with a small subset of features and minimal effort, and you're sure that it's not going to turn into a full-fledged port, you could give Lightswitch a try. I know it seems silly, but they've now got the ability to publish views as an HTML5 application. I recently did that, and it's stupid simple to point it at the right tables and squirt out a simple HTML view. If the result is good enough for what you need, then it's an easy win and won't chew up a lot of time that might be needed elsewhere.

EDIT: Also the link for the Lightswitch HTML client: [http://msdn.microsoft.com/en-us/lightswitch/htmlclient](http://msdn.microsoft.com/en-us/lightswitch/htmlclient)

# gwt - 我可以将 playN 游戏嵌入 GWT 构建的网站吗？

> ID：11214116
> 
> 赞同：1
> 
> 时间：2012-06-26T18:53:51.140
> 
> 标签：gwt, playn

我想知道我是否可以利用 GWT 和 playN 的优势构建基于浏览器的游戏，因为两者都以相同的方式编译为 HTML/JS？

我意识到应该可以将简单的游戏窗口嵌入到 GWT 构建的网站中，但我希望它是一个实体，这意味着我想在 playN 和 GWT 之间**进行通信**，并且可能使用同一台服务器。

有可能还是我在做梦？

# python - python中的3D外推（基本上，scipy.griddata扩展为外推）

> ID：11214118
> 
> 赞同：7
> 
> 时间：2012-06-26T18:54:01.203
> 
> 标签：python, numpy, scipy, interpolation, qhull

我在 scipy 中使用 griddata 函数来插入 3 维和 4 维数据。它就像一个冠军，除了它返回一堆 NaN，因为我需要的一些点超出了输入数据的范围。鉴于 Nd 数据无论如何只适用于“线性”模式插值，让 griddata 进行外推而不是仅仅返回 NaN 应该很容易。有没有人这样做或找到解决方法？澄清一下：我有非结构化数据，所以我不能使用任何需要常规网格的功能。谢谢！亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-12-04T21:31:14.973

[使用scipy.interpolate.Rbf](https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.Rbf.html)插值和外插数据的一种可能性是 3、4 或实际上任何维度

为方便起见，`get_data()`函数和`plot_3d()`函数附在最后。

## 示例数据

示例数据如下所示（第四维 w，以颜色显示）。数据是不规则间隔的，没有网格化。

[![在此处输入图像描述](../Images/ff3feca939fdb8d6ca85474778c85098.png)](https://i.stack.imgur.com/XJ9lg.png)

```
x, y, z, w = get_data(N=200)
plot_3d(x, y, z, w) 
```

### 3d 插值和外推

首先，让我们设置新的 x 和 y 坐标。为了使这更有趣，让我们推断负 x 和负 y 方向。这形成了新的 x 和 y 感兴趣范围。

```
xs = np.linspace(-10, 20) # some extrapolation to negative numbers
ys = np.linspace(-10, 20) # some extrapolation to negative numbers
xnew, ynew = np.meshgrid(xs, ys)
xnew = xnew.flatten()
ynew = ynew.flatten() 
```

使用[scipy.interpolate.Rbf](https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.Rbf.html)进行插值。现在，

```
from scipy.interpolate import Rbf
rbf3 = Rbf(x, y, z, function="multiquadric", smooth=5)
znew = rbf3(xnew, ynew)

plot_3d(xnew, ynew, znew) 
```

*   可以有尽可能多的变量/维度。第一个参数 ( `x`, `y`) 被视为节点的坐标。参数之前的最后一个参数`function`是要被插值的“值”（现在：）`z`。
*   该`function`参数可用于控制*如何*插入值。*这将影响结果，因此请使用您的数据。*.
*   该`smooth`参数可用于平滑数据中的一些噪声。如果`smooth`为零，则结果为插值；它将遍历您的所有数据点。如果为正值，则数据更平滑。*这将影响结果，因此请使用您的数据。*.
*   下面是结果，外推当然很差。这只是为了证明外推是可能的。您可能想要微调`function`并`smooth`获得所需的结果。通常，不应“过多”推断数据（如本例所示）

[![在此处输入图像描述](../Images/231248297ec47f1df63013b4a32bc7d4.png)](https://i.stack.imgur.com/6uqZh.png)

## 添加第四维

也可以内插和外推到第四维。方法如下：

```
rbf4 = Rbf(x, y, z, w, function="thin_plate", smooth=5)
wnew = rbf4(xnew, ynew, znew)
plot_3d(xnew, ynew, znew, wnew) 
```

*   `Rbf`我为第四维创建了另一个实例，并使用（3d 插值）`znew`计算`rbf3`。
*   我将其更改为`function`，`"thin_plate"`因为它在视觉上似乎*使用此数据集*表现更好。
*   结果如下所示： [![在此处输入图像描述](../Images/3b00c2a5250e9d2175d57e1e945aad91.png)](https://i.stack.imgur.com/al3U3.gif)

### 附录：`get_data`和`plot_3d`

出于测试目的：

```
import numpy as np

def get_data():
    np.random.seed(100)
    N = 200
    maxval = 20
    x = np.random.random(N) * maxval
    y = np.random.random(N) * maxval
    z = x ** 2 + np.sqrt(y) * y - y ** 3 + np.random.random(N) + 18 * y ** 2 * 2
    w = x ** 2 - np.log(y + (x * y) ** 2)
    return x, y, z, w

def plot_3d(x, y, z, w=None, show=True):
    import matplotlib.pyplot as plt
    from mpl_toolkits.mplot3d import axes3d

    fig = plt.figure(figsize=(10, 6))
    ax = axes3d.Axes3D(fig)
    ax.scatter3D(x, y, z, c=w if not w is None else "b")
    plt.show() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T05:51:17.893

不太确定这是否适合您并且它尚不可用，但在 numpy 的开发版本中有一个“pad”数组功能......

[https://github.com/numpy/numpy/blob/master/numpy/lib/arraypad.py](https://github.com/numpy/numpy/blob/master/numpy/lib/arraypad.py)

其中一个选项是“linear_ramp”，它从边缘值开始向外推断（填充）并线性增加/减少到指定的结束值。

它是一个纯 python 函数，所以你可以将它复制到你的路径中并导入（虽然未经我测试）

# python - 使用字典键：值对填充 wx.StaticText 控件

> ID：11214120
> 
> 赞同：0
> 
> 时间：2012-06-26T18:54:03.033
> 
> 标签：python, dictionary, wxpython

我有一个 wxPython GUI 应用程序，其中包含 13 对 StaticText 控件，我希望能够为有问题的设置标签。

在回归分析方面，每对 StaticText 控件代表一个自变量及其系数。这些键：值对当前存储在 python 字典中，允许我在大部分工作中使用字典理解。

现在，我正在努力在我的 GUI 中显示我的 python 字典的内容。有什么想法吗？

我很高兴在 1 个 StaticText 控件标签内连接 key:value 对，因为我认为它不会那么混乱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:13:33.523

我敢肯定有很多不同的方法可以做到这一点。我可能会使用 ListCtrl 或更好的 ObjectListView。但我继续使用 StaticText 控件创建了一个示例：

```
import wx

########################################################################
class MyPanel(wx.Panel):
    """"""

    #----------------------------------------------------------------------
    def __init__(self, parent):
        """Constructor"""
        wx.Panel.__init__(self, parent)

        self.mainSizer = wx.BoxSizer(wx.VERTICAL)
        self.createControls()
        self.SetSizer(self.mainSizer)

    #----------------------------------------------------------------------
    def createControls(self):
        """"""
        myDict = {"var1":"co-eff1", "var2":"co-eff2",
                  "var3":"co-eff3", "var4":"co-eff4",
                  "var5":"co-eff5", "var6":"co-eff6",
                  "var7":"co-eff7", "var8":"co-eff8",
                  "var9":"co-eff9", "var10":"co-eff10",
                  "var11":"co-eff11", "var12":"co-eff12",
                  "var13":"co-eff13"}
        for key in myDict:
            lblOne = wx.StaticText(self, label=key)
            lblTwo = wx.StaticText(self, label=myDict[key])

            sizer = wx.BoxSizer(wx.HORIZONTAL)
            sizer.Add(lblOne, 0, wx.ALL, 5)
            sizer.Add(lblTwo, 0, wx.ALL, 5)
            self.mainSizer.Add(sizer)

########################################################################
class MyFrame(wx.Frame):
    """"""

    #----------------------------------------------------------------------
    def __init__(self):
        """Constructor"""
        wx.Frame.__init__(self, None, title="Frame Example",
                          size=(400,400))
        panel = MyPanel(self)
        self.Show()

if __name__ == "__main__":
    app = wx.App(False)
    frame = MyFrame()
    app.MainLoop() 
```

如果您想查看 ListCtrl 的外观，请下载 wxPython 演示包并查找 ListCtrl 演示。对于 ObjectListView，您可以阅读我的[教程](http://www.blog.pythonlibrary.org/2009/12/23/wxpython-using-objectlistview-instead-of-a-listctrl/)。

# php - php file_get_contents - javascript 执行后

> ID：11214122
> 
> 赞同：3
> 
> 时间：2012-06-26T18:54:05.620
> 
> 标签：php, javascript, file-get-contents

基本上，我正在尝试使用 php 抓取网页，但我想在页面上的初始 javascript 执行后这样做 - 我想在初始 ajax 请求后访问 DOM 等......有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T18:56:57.147

简短的回答：没有。

抓取站点会为您提供服务器对您发出的 HTTP 请求的响应（如果该内容是 HTML，则从中派生出 DOM 树的“初始”状态）。它不能考虑 DOM 在被 Javascript 修改后的“当前”状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T18:55:51.937

我正在修改这个答案，因为现在有几个项目在这方面做得非常好：

*   **2020 年更新**：[Puppeteer](https://github.com/puppeteer/puppeteer)是一个可以控制 Chromium 浏览器的 Node.js 库，还对 Firefox 提供实验性支持。

*   **2020 年更新**：[Playwright](https://github.com/microsoft/playwright)是一个可以控制多个浏览器的 Node.js 库。

您需要安装 Node.js 并编写 JavaScript 代码来与这两个项目进行交互。特别是它们工作得很好，你可以在你的代码中使用任何 Node.js/npm 模块`async`。`await`

还有其他项目，如 Selenium，但我不推荐它们。

~~- [PhantomJS](http://phantomjs.org/)是 WebKit 的无头版本，并且有一些有用的包装器，例如[CasperJS](http://casperjs.org/)。~~

~~- [Zombie.js](http://zombie.labnotes.org/)，它是用 Javascript (Node.js) 编写的[jsdom的包装器。](https://github.com/tmpvar/jsdom)~~

~~您需要编写 JavaScript 代码来与这两个项目进行交互。到目前为止，我更喜欢 Zombie.js，因为它更易于设置，并且您可以在代码中使用任何 Node.js/npm 模块。~~

* * *

老答案：

~~不，没有办法做到这一点。您必须在 PHP 中模拟完整的浏览器环境。除了谷歌，我不知道有谁在做这种抓取，而且还远远不够全面。~~

~~相反，您应该使用 Firebug 或其他 Web 调试工具来查找生成您真正感兴趣的数据的请求（或请求序列）。然后，使用 PHP 仅执行所需的请求。~~

# eclipse-plugin - 如何以编程方式更新所选资源的链接编辑器功能？

> ID：11214123
> 
> 赞同：1
> 
> 时间：2012-06-26T18:54:07.467
> 
> 标签：eclipse-plugin, eclipse-rcp

我的 Eclipse 插件提供了一个包含文件列表的编辑器（作为依赖项搜索的结果）。当用户在列表中选择一个文件时，这个文件/资源​​应该在包/资源浏览器中突出显示。

如果有这样的调用，可以使用资源管理器视图的链接编辑器功能轻松完成：`updateSelectedResource(IResource)`我可以从我的编辑器中调用以明确设置活动文件。实际的调用是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T04:42:05.767

您的编辑器必须成为[ISelectionProvider](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/viewers/ISelectionProvider.html)。在[Eclipse 常见问题解答](http://wiki.eclipse.org/FAQ_How_do_I_make_a_view_respond_to_selection_changes_in_another_view%3F)中，您将获得一个完整的示例，其中注册您的选择提供程序的重要行是`getSite().setSelectionProvider(viewer);`. 之后，列表中选定的文件会自动告知所有选择侦听器，包括包资源管理器。

如果您想全面了解选择服务（它负责使这些视图对其他视图中的选择做出反应），有一篇[Eclipse 文章](http://www.eclipse.org/articles/Article-WorkbenchSelections/article.html)对其进行了详细描述。

如果发现自己想要与更多现有视图进行交互，您可能还想查看 IAdaptable，如此处所述[，](http://www.ibm.com/developerworks/opensource/library/os-ecllink/)但这对于包资源管理器链接不是必需的。

# android - Android 启动 Activity 未实现或扩展 Thread 类

> ID：11214124
> 
> 赞同：0
> 
> 时间：2012-06-26T18:54:08.100
> 
> 标签：android

启动屏幕活动适用于线程类，但它不扩展或实现 Thread。那么 Thread 是如何在 Activity 中工作的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:05:45.227

为什么 Activity 不扩展。`Thread class`你可以`Runnable`在你的中实现`Activity`：

```
public class AndroidRunnable extends Activity implements Runnable{

Thread myThread;

  /** Called when the activity is first created. */
  @Override
  public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.main);
  }

  @Override
protected void onResume() {
// TODO Auto-generated method stub
super.onResume();
}

@Override
protected void onPause() {
// TODO Auto-generated method stub
super.onPause();
}

@Override
public void run() {
// TODO Auto-generated method stub

}

} 
```

请参阅使用线程创建启动屏幕活动的示例：

[Android 教程：如何制作一个基本的闪屏](http://p-xr.com/android-tutorial-how-to-make-a-basic-splash-screen/)

# c# - 在 C# 中将数据从文本框插入到 sql 数据库时出错

> ID：11214128
> 
> 赞同：-2
> 
> 时间：2012-06-26T18:54:19.897
> 
> 标签：c#, sql

当我尝试将文本框中的值插入数据库时​​，数据库中的值没有更新。但是新插入的行是暂时可用的，插入后当我使用选择查询获取行时，新行可用。当我关闭解决方案并再次打开它时，新插入的行就消失了。数据库资源管理器中的表始终不更新。

这是我的代码。

```
 string connectionString = @"Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\Database1.mdf;Integrated Security=True;User Instance=True";
            string na = textBox1.Text;
            int ag = int.Parse(textBox2.Text);
            string ci = textBox3.Text;
            using (SqlConnection connection = new SqlConnection(connectionString))
            {

                using (SqlCommand insertCommand = connection.CreateCommand())
                {
                    insertCommand.CommandText = "INSERT INTO address(name,age,city) VALUES (@na,@ag,@ci)";
                    insertCommand.Parameters.AddWithValue("@na", na);
                    insertCommand.Parameters.AddWithValue("@ag", ag);
                    insertCommand.Parameters.AddWithValue("@ci", ci);

                    insertCommand.Connection.Open();
                    insertCommand.ExecuteNonQuery();
                    insertCommand.Connection.Close();
                    MessageBox.Show("finish");

                }

                //connection.Close();
            } 
```

表名是“address”，有三个字段name(varchar(50)),age(int),city(nchar(10)) 请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T18:58:02.183

尝试右键单击您的 mdf 文件，选择属性，然后选择不复制以不在您的 bin 中复制。

![在此处输入图像描述](../Images/fed2dc4c3fb9f801ac2b3e66382287cd.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:31:13.813

您在错误中说“C:\Users\Thangamani\documents\visual studio 2010\Projects\AddressBook\AddressBook\bin\Debug\”。您在调试期间附加到本地副本。

现在您没有复制数据库，该 mdf 文件不存在，因此出现错误。

更改您的连接字符串以访问原始数据库，而不是本地副本（您不再制作）。

# java - Java 脚本库中的 NullPointerException

> ID：11214129
> 
> 赞同：0
> 
> 时间：2012-06-26T18:54:21.067
> 
> 标签：java, lotus-notes, lotus-domino, lotusscript, jsch

我正在迈出 Java 的第一步——尝试在 Domino Designer 8.5.2 中创建一个简单的 Java 脚本库，以使用 JSch 0.1.48 执行 SFTP 文件传输。将通过 LS2J 从 LotusScript 代理调用该库。这是我的脚本库中的 SFTP 类，基于[这个 SO 答案](https://stackoverflow.com/a/2690960/461954)：

```
import com.jcraft.jsch.*;

public class SFTP {
    public String GetFile(String host, String user, String pass, 
                          String localPath, String remotePath) {
        JSch jsch = new JSch();
        Session session = null;
        try {
            session = jsch.getSession(user, host, 22);
            session.setConfig("StrictHostKeyChecking", "no");
            session.setPassword(pass);
            session.connect();
            Channel channel = session.openChannel("sftp");
            channel.connect();
            ChannelSftp sftpChannel = (ChannelSftp) channel;
            sftpChannel.get(remotePath, localPath);
            sftpChannel.exit();
            session.disconnect();
        } catch (JSchException e) {
            e.printStackTrace();
        } catch (SftpException e) {
            e.printStackTrace();
        }
        String result = "OK";
        return result;
    }
} 
```

当我从 Java 代理调用此函数时，它似乎可以正常工作。当我通过 LS2J 从 LotusScript 代理调用它时，它会传输文件，但随后会抛出错误 318 - LS2J 错误：抛出 java.lang.NullPointerException。Java 堆栈跟踪是：

```
java.lang.NullPointerException
    at lotus.notes.AgentSecurityManager.checkRelatedThreadGroup(Unknown Source)
    at lotus.notes.AgentSecurityManager.checkAccess(Unknown Source)
    at java.lang.Thread.checkAccess(Thread.java:378)
    at java.lang.Thread.interrupt(Thread.java:506)
    at com.jcraft.jsch.Session.disconnect(Session.java:1630)
    at SFTP.GetFile(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:600)
    at lotus.domino.JavaConnectInvoker.invoke(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:600)
    at lotus.domino.JavaConnectLoader.invoke(Unknown Source) 
```

问题似乎与 session.disconnect() 调用有关。我发现其他[有](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CFQQFjAA&url=http://netbeans.org/bugzilla/show_bug.cgi?id=141609&ei=jf3pT9q5MKro2QW-4aThCA&usg=AFQjCNHDkqfP-uuTlmEZpJkQXJpTqtz-iQ&sig2=-vojJp1370z87iW5oFYlRg) [类似](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&ved=0CFUQFjAB&url=http://sourceforge.net/tracker/?func=detail&atid=509122&aid=1701750&group_id=64920&ei=jf3pT9q5MKro2QW-4aThCA&usg=AFQjCNHQy6pW8kk6IH35RIm1nl-JTTGRBw&sig2=y1YzcURAiDWNKjYBJK8omw) [问题](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&ved=0CFYQFjAC&url=https://bugs.eclipse.org/bugs/show_bug.cgi?format=multiple&id=175328&ei=jf3pT9q5MKro2QW-4aThCA&usg=AFQjCNGDEaTWt1B-x19yjI8oXqJMcs2whg&sig2=PmJAxCYAV4DyXdJxbK3HZg&cad=rja)的人从其他应用程序调用 JSch，但如果它是 JSch 错误，我认为 Java 代理会抛出相同的异常。堆栈跟踪使它看起来像是一个 Domino 安全问题，但我不知道要进行什么调整才能允许此操作。代理已经设置为允许受限操作，所以不是这样。此[论坛帖子](http://www-10.lotus.com/ldd/46dom.nsf/869c7412fe5d56b7852569fa007826e3/02d5579edc50a6d88525687b004b21e8?OpenDocument)有类似的堆栈跟踪，并表明该问题可能是由 Domino 拥有其线程组的清理权限引起的。

我需要在 Domino 方面进行安全更改吗？我可以删除 session.disconnect() 而不孤立服务器上的无数连接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T23:14:14.563

[该问题发生在 AgentSecurityManager 中，您可以在此博客条目](http://lekkimworld.com/2006/04/23/1145790357201.html)中了解该问题。它基本上是 Domino AMGR 插入 JVM 以强制执行 Domino 的安全策略的垫片。

检查以确保您已授予代理使用受限操作的权限。（在 Lotus 古怪术语的另一个示例中，签名者必须在服务器文档的“签名或运行不受限制的方法和操作”字段中拥有权限，但代理必须在代理属性框的安全选项卡上授予“允许受限操作”）

如果不是这样简单，那么我建议您尝试从 Domino 脚本库中取出 com.jcraft.jsch.* 的 jar，并将它们放在服务器文件系统上的 jvm/lib/ext 文件夹中。存储在文件系统上的 jar 的安全性处理方式不同，它可能会解决这个问题。

# memory - Barnes Hut 最坏的记忆场景

> ID：11214132
> 
> 赞同：1
> 
> 时间：2012-06-26T18:54:25.220
> 
> 标签：memory, octree

我想运行 Barnes Hut N 体模拟（[维基百科文章](http://en.wikipedia.org/wiki/Barnes%E2%80%93Hut_simulation)）。我知道八叉树的单个节点将占用多少内存，但我无法弄清楚对于给定数量的粒子，最坏的内存使用情况是什么。简而言之，我想知道对于给定数量的粒子，八叉树中可能存在多少个节点。我需要知道这一点才能知道为八叉树分配多少内存。

编辑：

哦，如果有人想给我代码而不是仅仅和解释，我正在用 C 语言编写。

我有这个，这比最坏的情况还要糟糕。但它保证至少分配足够的内存。我希望有人能给我一些内存效率更高的东西。

```
int KBH_worstcase(int particles)
{ // returns number of nodes required to store a number of particles in a worst case scenario
    int worst;
    unsigned int n;
    worst=1;
    n=1;
    while(n<particles)
    {
        n=n<<3;
        worst+=n;
    }
    return worst;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:53:11.233

我不确定是否存在这样一个合适的标准。八叉树考虑了在模拟过程中可能发生变化的粒子分布。所以树的有效深度不能只依赖于粒子的数量。

一种虚假的解决方案可能是定义树深度（或节点数）的界限。在这种情况下，您可以将更多粒子组合在一个单元格（八叉树的叶子）中，然后退回到身体-身体相互作用。但是，如果您想对树结构进行更多控制，那么在必要时能够分配新节点可能会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-29T20:06:03.047

实际上，四叉树（或三维的八叉树）所需的节点数上限不受粒子总数的对数限制。

通常，节点中的空间被划分为四个*相等*的象限。考虑与根节点的边界框相比，两个粒子彼此非常接近的情况。在这里很容易看出，在到达单个粒子的节点之前，需要创建很多内部节点。见下图。

![在此处输入图像描述](../Images/0e0aa5a0d995017d1b725a4214433de5.png)

*许多内部节点 - 只有两点*

二维的上限应该是（我的头顶）

log4 w/m

其中 w 是根节点边界框​​的大小，m 是任意两个粒子之间的最短距离。

但是，计算任意两点之间的最短距离具有 O(n^2) 复杂性，这是您希望避免的。

您可以改为修改算法以仅将树构建到最大深度 d。这会将内存消耗限制为 4^(d+1)-1 个节点。

您还需要小心处理与多个粒子的节点之间的交互，例如退回到朴素的 O(n^2) 算法。

# ruby-on-rails - rails中的复选框没有返回值？如何让复选框与 Rails 一起使用

> ID：11214133
> 
> 赞同：0
> 
> 时间：2012-06-26T18:54:29.307
> 
> 标签：ruby-on-rails, ruby, checkbox, null

我试图从我的复选框中获取值，但是每当我使用 params[:chosen] 时，它似乎总是返回 nil。我错过了什么？参数是正确的方法吗？

这是我的观点：

```
<td><%= check_box_tag "chosen[#{i}]",i,true,:name => "chosen[]" %></td> 
```

这确实会产生复选框，但我似乎永远无法从中获得价值。我需要在控制器中放一些东西吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T14:56:24.263

`<%= f.check_box :hobby, {:multiple => "true"}, "hockeys", nil %>Hockey`

`<%= f.check_box :hobby, {:multiple => "true"}, "cricket", nil %>cricket`

这将对您非常有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:34:36.553

我认为您不需要 :name => "chosen[]"。第一个参数已用作名称。此外，Rails 指南建议始终使用带有 check_box_tag 的 label_tag

```
<td>
<%= label_tag :my_attribute, "Attribute Label" %>
<%= check_box_tag :my_attribute, my_model.my_attribute %>
</td> 
```

然后控制器可以检查 params[:my_attribute]

# ruby-on-rails - “新”路径上的路由错误（未初始化的常量 ErrorsController (ActionController::RoutingError)）

> ID：11214135
> 
> 赞同：0
> 
> 时间：2012-06-26T18:54:40.987
> 
> 标签：ruby-on-rails, routes

我在[http://bob.dev/assessments/new](http://bob.dev/assessments/new)的“新”路径上收到一个动作控制器异常。我最近在项目中添加了设计和六分仪，而给我带来问题的路径以前是有效的。

例外：

`uninitialized constant ErrorsController (ActionController::RoutingError)`

路线：

```
Bob::Application.routes.draw do
  devise_for :users

  mount_sextant                                   # Sextant gem #####################
  match '*not_found' => 'errors#handle404'        # visit http://bob.dev/rails/routes
  match "*path" => 'errors#handle404'             ###################################

  # resources :users                              # Authentication from scratch #####
  # resources :sessions                           ###################################

  root :to => "assessments#index"
    resources :assessments
end 
```

最后，来自[http://bob.dev/rails/routes](http://bob.dev/rails/routes)通过六分仪的输出：

```
 new_user_session GET    /users/sign_in(.:format)          devise/sessions#new
            user_session POST   /users/sign_in(.:format)          devise/sessions#create
    destroy_user_session DELETE /users/sign_out(.:format)         devise/sessions#destroy
           user_password POST   /users/password(.:format)         devise/passwords#create
       new_user_password GET    /users/password/new(.:format)     devise/passwords#new
      edit_user_password GET    /users/password/edit(.:format)    devise/passwords#edit
                         PUT    /users/password(.:format)         devise/passwords#update
cancel_user_registration GET    /users/cancel(.:format)           devise/registrations#cancel
       user_registration POST   /users(.:format)                  devise/registrations#create
   new_user_registration GET    /users/sign_up(.:format)          devise/registrations#new
  edit_user_registration GET    /users/edit(.:format)             devise/registrations#edit
                         PUT    /users(.:format)                  devise/registrations#update
                         DELETE /users(.:format)                  devise/registrations#destroy
       user_confirmation POST   /users/confirmation(.:format)     devise/confirmations#create
   new_user_confirmation GET    /users/confirmation/new(.:format) devise/confirmations#new
                         GET    /users/confirmation(.:format)     devise/confirmations#show
            rails_routes GET    /rails/routes(.:format)           rails/routes#index
             rails_route GET    /rails/routes/:id(.:format)       rails/routes#show
                                /*not_found(.:format)             errors#handle404
                                /*path(.:format)                  errors#handle404
                    root        /                                 assessments#index
             assessments GET    /assessments(.:format)            assessments#index
                         POST   /assessments(.:format)            assessments#create
          new_assessment GET    /assessments/new(.:format)        assessments#new
         edit_assessment GET    /assessments/:id/edit(.:format)   assessments#edit
              assessment GET    /assessments/:id(.:format)        assessments#show
                         PUT    /assessments/:id(.:format)        assessments#update
                         DELETE /assessments/:id(.:format)        assessments#destroy
                         GET    /rails/routes(.:format)           rails/routes#index
                         GET    /rails/routes/:id(.:format)       rails/routes#show 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T04:05:01.507

您可以安全地删除线路

```
 match '*not_found' => 'errors#handle404'        
  match "*path" => 'errors#handle404' 
```

他们不需要。这将解决您的错误。虽然如果您想为您的应用程序创建自定义错误处理程序，请查看 Jose 的帖子中的第 3[条 http://blog.plataformatec.com.br/2012/01/my-five-favorite-hidden-features-in-rails- 3-2/](http://blog.plataformatec.com.br/2012/01/my-five-favorite-hidden-features-in-rails-3-2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:58:06.270

我猜想“错误”一词是保留的，并且在新的依赖项之一中存在冲突。您可以将这些路线/控制器称为不同的东西吗？

# java - 使用 mockito 对构造函数进行单元测试

> ID：11214136
> 
> 赞同：50
> 
> 时间：2012-06-26T18:54:42.360
> 
> 标签：java, unit-testing, mockito

我有一节课。

```
Class First {

    private Second second;

    public First(int num, String str) {
        second = new Second(str);
        this.num = num;
    }

    ... // some other methods
} 
```

我想为 First 类的公共方法编写单元测试。我想避免执行第二类的构造函数。

我这样做了：

```
Second second = Mockito.mock(Second.class);
Mockito.when(new Second(any(String.class))).thenReturn(null);
First first = new First(null, null); 
```

它仍在调用第二类的构造函数。我怎样才能避免它？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-06-26T19:55:12.060

您可以使用[PowerMockito](https://github.com/powermock/powermock)

[请参阅示例：](https://github.com/powermock/powermock/wiki/Mockito#how-to-mock-construction-of-new-objects)

```
Second second = Mockito.mock(Second.class);
whenNew(Second.class).withNoArguments().thenReturn(second); 
```

但重构是更好的决定。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-06-26T18:58:20.410

单元测试的问题再次来自于使用`new`操作符手动创建对象。考虑传递已经创建的`Second`：

```
class First {

  private Second second;

  public First(int num, Second second) {
    this.second = second;
    this.num = num;
  }

  // some other methods...
} 
```

我知道这可能意味着对您的 API 进行重大重写，但没有其他方法。这个类也没有任何意义：

```
Mockito.when(new Second(any(String.class).thenReturn(null))); 
```

首先，Mockito 只能模拟方法，不能模拟构造函数。其次，即使您可以模拟构造函数，您也是在模拟刚刚创建的对象的构造函数，而从未真正对该对象做任何事情。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-11-20T09:18:27.270

这是使用 PowerMockito API 模拟此功能的代码。

```
Second mockedSecond = PowerMockito.mock(Second.class);
PowerMockito.whenNew(Second.class).withNoArguments().thenReturn(mockedSecond); 
```

您需要使用 Powermockito 运行器，并且需要添加需要由 powermock API 模拟的所需测试类（*逗号分隔）。*

```
@RunWith(PowerMockRunner.class)
@PrepareForTest({First.class,Second.class})
class TestClassName{
    // your testing code
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-01-21T15:56:09.750

我使用了“模式 2 - “工厂助手模式”

> ### 模式 2 - 工厂助手模式
> 
> 这种模式不起作用的一种情况是 MyClass 是最终的。大多数 Mockito 框架在 final 类中表现不佳；这包括使用 spy()。另一种情况是 MyClass 在某处使用 getClass()，并要求结果值为 MyClass。这是行不通的，因为 spy 的类实际上是原始类的 Mockito 生成的子类。
> 
> 在这两种情况下，您都需要更健壮的工厂助手模式，如下所示。
> 
> ```
> public class MyClass{
>   static class FactoryHelper{
>       Foo makeFoo( A a, B b, C c ){
>           return new Foo( a, b, c );
>       }
>   }
> 
>   //...
> 
>   private FactoryHelper helper;
>   public MyClass( X x, Y y ){
>       this( x, y, new FactoryHelper());
>   } 
> 
>   MyClass( X x, Y, y, FactoryHelper helper ){
> 
>       //...
> 
>       this.helper = helper;
>   } 
> 
>   //...
> 
>   Foo foo = helper.makeFoo( a, b, c );
> } 
> ```
> 
> 因此，您有一个特殊的构造函数，仅用于测试，它有一个附加参数。这在您的测试类中使用，在创建您要测试的对象时。在您的测试类中，您模拟 FactoryHelper 类以及您要创建的对象。
> 
> ```
> @Mock private MyClass.FactoryHelper mockFactoryHelper;
> @Mock private Foo mockFoo;
> private MyClass toTest; 
> ```
> 
> 你可以像这样使用它
> 
> ```
> toTest = new MyClass( x, y, mockFactoryHelper ); 
> when( mockFactoryHelper.makeFoo( 
>   any( A.class ), any( B.class ), any( C.class )))
>   .thenReturn( mockFoo ); 
> ```

来源：[http ://web.archive.org/web/20160322155004/http://code.google.com/p/mockito/wiki/MockingObjectCreation](http://web.archive.org/web/20160322155004/http://code.google.com/p/mockito/wiki/MockingObjectCreation)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-09-30T14:51:08.590

Mockito 现在可以模拟构造函数（从 3.5.0 版开始）[https://javadoc.io/static/org.mockito/mockito-core/3.5.13/org/mockito/Mockito.html#mocked_construction](https://javadoc.io/static/org.mockito/mockito-core/3.5.13/org/mockito/Mockito.html#mocked_construction)

```
try (MockedConstruction mocked = mockConstruction(Foo.class)) {
   Foo foo = new Foo();
   when(foo.method()).thenReturn("bar");
   assertEquals("bar", foo.method());
   verify(foo).method();
 } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-06T16:21:48.453

我相信，不可能使用 mockito 来模拟构造函数。相反，我建议采用以下方法

```
Class First {

   private Second second;

   public First(int num, String str) {
     if(second== null)
     {
       //when junit runs, you get the mocked object(not null), hence don't 
       //initialize            
       second = new Second(str);
     }
     this.num = num;
   }

   ... // some other methods
} 
```

并且，对于测试：

```
class TestFirst{
    @InjectMock
    First first;//inject mock the real testable class
    @Mock
    Second second

    testMethod(){

        //now you can play around with any method of the Second class using its 
        //mocked object(second),like:
        when(second.getSomething(String.class)).thenReturn(null);
    }
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-03-23T23:52:16.133

将此行包含在测试类的顶部

```
@PrepareForTest({ First.class }) 
```

# c# - 获取没有反射或已知类型的程序集引用

> ID：11214138
> 
> 赞同：8
> 
> 时间：2012-06-26T18:54:49.507
> 
> 标签：c#, .net-4.0, xamarin.android, silverlight-5.0

在我当前的框架设计中，我仔细阅读所有类型的特定程序集并根据找到的类型进行工作。它搜索的程序集由应用程序引导程序/初始化程序确定。程序集已编译，因此可以通过以下方式强烈引用它们：`typeof(SomeTypeInTheAssembly).Assembly`。这很好，因为引导程序代码对程序集中的类型有很强的引用，并且如果程序集限定名称发生更改，则不需要将完全限定名称作为内联字符串进行摸索，这些名称需要手动保持最新。但是我不喜欢在程序集中引用一些完全不相关的类型并依赖于存在的那种类型。（如果它移动到另一个程序集怎么办？如果我们弃用/删除类型怎么办？更改它的命名空间？）在代码中，它看起来也有点奇怪：

```
FrameworkAssemblyReader.Read(typeof(SomeAssemblyNamespace.SubNamespace.GraphingCalculator).Assembly); 
```

现在在我的引导代码中，我有一个直接依赖关系（尽管是一个非常微不足道的依赖关系），`GraphingCalculator`它与引导阶段无关（作为一个 GraphingCalculator，它当然与获取程序集引用无关）。为了避免这种情况，在我打算以这种方式使用的每个程序集中，我在它们的根目录中添加了一个类：

```
namespace SomeAssemblyNamespace
{
    public static class AssemblyReference
    {
        public static System.Reflection.Assembly Get
        {
            get
            {
                return typeof(AssemblyReference).Assembly;
            }
        }
    }
} 
```

这还不错，因为我的引导代码如下所示：

```
FrameworkAssemblyReader.Read(SomeAssembly.AssemblyReference.Get); 
```

但是现在，我有大约十几个带​​有此类`AssemblyReference`复制/粘贴的程序集，我只希望它会随着应用程序构建在框架之上而继续增长。所以我的问题是，有没有一种很好的方法可以避免`AssemblyReference`类重复并仍然以编程方式将程序集引用传递给基础框架，同时避免指向目标程序集中的一些任意/不相关类型的模糊性？我的谷歌搜索似乎告诉我，没有 API 或语言功能可以让我强烈指向程序集（例如`typeof`类），但我希望这里有人提出比我更好的解决方案来避免类/代码复制。另外值得注意的是，代码有时是针对 Silverlight 编译的，所以我知道这可能会限制一些 API/技术。谢谢！

编辑：只是为了添加另一个活动扳手，基于“浣熊侠”的回答，我应该提到我并不总是加载相同的程序集。例如，我可能有一个适用于某些应用程序但不是全部的“CarBuilding”程序集。由引导程序告诉我他们希望使用哪些（以及开发人员正在使用的任何自定义）

EDITx2：回答 Jon Skeet 的问题：客户（或我们内部）将创建他们希望支持其应用程序的任何项目/DLL。反过来，这些项目将引用内部基础框架。他们的项目*可能*包含资源（3D 文件、图像、文本、本地化等）和插件式类（他们实现了我们在应用程序生命周期内根据需要发现和实例化/执行的脚本）。此外，我们的系统提供*可选*模块 (DLL)，其中包含客户（或我们）在制作特定应用程序时可以利用的可重用插件/内容。所以你可能会看到这样的项目结构：

```
Solution
    ->MyAppBootstrapper_Android
        ->MyAppGUI_Android
        ->MyAppFramework
        ->MyAppResources
        ->MyAppAdditionalResources_Android

    ->MyAppBootstrapper_Silverlight
        ->MyAppGUI_Silverlight
        ->MyAppFramework
        ->MyAppResources
        ->MyAppAdditionalResources_Silverlight
        ->BaseFrameworkGraphingModule 
```

引导程序项目连接依赖关系，并提供应将哪些项目/dll（程序集）提供给基础框架以进行发现。请注意，在这种情况下，“MyApp”在 Android 和 Silverlight 构建中共享自己的迷你框架和共享资源，但两者都有自己独立的引用。Silverlight 充分利用了平台，`BaseFrameworkGraphingModule`并且他们拥有自己的特定于平台的资源。

所以在项目的引导程序中看起来像（虽然简化了）：

```
namespace MyAppBootstrapper_Android
{
    public class Bootstrapper
    {
        public void Setup()
        {
            FrameworkAssemblyReader.Read(MyAppGUI_Android.AssemblyReference.Get);
            FrameworkAssemblyReader.Read(MyAppFramework.AssemblyReference.Get);
            FrameworkAssemblyReader.Read(MyAppResources.AssemblyReference.Get);
            FrameworkAssemblyReader.Read(MyAppAdditionalResources_Android.AssemblyReference.Get);
        }
    }
}

namespace MyAppBootstrapper_Silverlight
{
    public class Bootstrapper
    {
        public void Setup()
        {
            FrameworkAssemblyReader.Read(MyAppGUI_Silverlight.AssemblyReference.Get);
            FrameworkAssemblyReader.Read(MyAppFramework.AssemblyReference.Get);
            FrameworkAssemblyReader.Read(MyAppResources.AssemblyReference.Get);
            FrameworkAssemblyReader.Read(MyAppAdditionalResources_Android.AssemblyReference.Get);
            FrameworkAssemblyReader.Read(BaseFrameworkGraphingModule.AssemblyReference.Get);
        }
    }
} 
```

因此，对于构建在基本框架之上的每个应用程序，都会创建一个引导程序，指示要包含哪些程序集（以及其他一些不相关的接线工作）。为了具体回答这个问题，该项目具有对所需每个程序集的编译时引用（这具有双重职责，因为它确保所有 DLL 打包在一起以进行 Android/Silverlight 部署），因为它们不会动态下载到用户的智能手机或 Silverlight 应用程序但打包在初始下载中。您关于引导程序如何知道要使用哪些程序集的问题，开发人员知道并进行了必要的`FrameworkAssemblyReader.Read`调用。我希望这有帮助！感谢您花时间查看它。我有一种感觉，我无中生有（或者完全错过了更好的解决方案/设计）。

最后，我（愚蠢地）忽略了提到我们还针对 Android 的 Mono 进行编译，并且在不久的将来还会针对 WPF 进行编译。WinRT 可能是未来的补充，但当我们谈到它时，我会很高兴跨过那座桥。不过，一般来说，由于每个平台都以自己的方式编译并具有自己的平台功能，因此我不介意*不同*平台是否有不同的方式来提取程序集引用；虽然如果平台之间有统一的语法会很好。

EDITx3：是的，另一个。我提到过，但没有举例说明并非所有项目都需要或应该由基础框架阅读。例如，实用程序或业务逻辑项目的代码与基础框架无关，但与客户端应用程序相关。所以从上面的例子：

```
Solution
    ->MyAppBootstrapper_Android
        ->MyAppGUI_Android
        ->MyAppFramework
        ->MyAppResources
        ->MyAppAdditionalResources_Android
        ->MyCompanySharedUtilities

    ->MyAppBootstrapper_Silverlight
        ->MyAppGUI_Silverlight
        ->MyAppFramework
        ->MyAppResources
        ->MyAppAdditionalResources_Silverlight
        ->BaseFrameworkGraphingModule
        ->MyCompanySharedUtilities 
```

`MyCompanySharedUtilities`MyAppGUI_Silverlight 和 MyAppFramework 可以利用它，但开发人员可能不会运行它，`FrameworkAssemblyReader.Read`因为它只包含一些数学或业务规则的专有实现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T13:34:59.117

我不确定您希望您的客户如何使用此代码，因此此建议可能无关紧要，但取消 Setup 功能（至少，将其对客户隐藏）并使用会不会更有意义某种配置文件？

```
<ReferencedAssemblies>
    <ReferencedAssembly key="UnchangingKey" qualifiedName="SomeAssemblyName, version=1.0.0.0, Culture=neutral, PublicKeyToken=0123456789abcdef" />
</ReferencedAssemblies> 
```

从配置文件加载程序集。使用密钥，如果完全限定名称更改，您不必更新应用程序，只需更新配置文件（并保留密钥原样）。

这基本上是 Visual Studio 对其项目文件使用的方法。这是我的一个 VB 项目的示例：

```
<ItemGroup>
  <Reference Include="System.Core">
    <RequiredTargetFramework>3.5</RequiredTargetFramework>
  </Reference>
  <Reference Include="System.Drawing" />
  <Reference Include="System.Windows.Forms" />
  <Reference Include="System.Xml.Linq">
    <RequiredTargetFramework>3.5</RequiredTargetFramework>
  </Reference>
  <Reference Include="System.Data.DataSetExtensions">
    <RequiredTargetFramework>3.5</RequiredTargetFramework>
  </Reference>
  <Reference Include="UIAutomationProvider">
    <RequiredTargetFramework>3.0</RequiredTargetFramework>
  </Reference>
  <Reference Include="WindowsBase">
    <RequiredTargetFramework>3.0</RequiredTargetFramework>
  </Reference>
  <Reference Include="PresentationCore">
    <RequiredTargetFramework>3.0</RequiredTargetFramework>
  </Reference>
  <Reference Include="PresentationFramework">
    <RequiredTargetFramework>3.0</RequiredTargetFramework>
  </Reference>
  <Reference Include="System" />
  <Reference Include="System.Data" />
  <Reference Include="System.Xml" />
</ItemGroup> 
```

编辑：

这是一个想法……如果您使用 Reflection.Emit 从 XML 配置文件生成程序集会怎样？您可以向生成的程序集添加一个存根类，您的核心项目可以使用它来创建对生成的程序集的硬引用，并且您可以使用反射来探测每个引用程序集（在 XML 文件中）以创建对任何对象的硬引用在引用的程序集中。当引用的程序集之一发生更改时，您需要重新生成程序集，但它不需要更改代码。您甚至可以将程序集生成代码构建到您的核心项目中，以便用户能够根据需要更新他们的项目。

# perl - 使用 AnyEvent::Twitter::Stream api 重新启动脚本

> ID：11214140
> 
> 赞同：1
> 
> 时间：2012-06-26T18:54:55.900
> 
> 标签：perl, twitter, anyevent

我使用带有 OAuth 身份验证的 cpan 库 AnyEvent::Twitter::Stream 做了一个推文爬虫，但我遇到了一些问题。有时，Twitter 会停止通过流 API 发送推文。然后，我让我的程序休眠一段时间，然后它应该返回以收集更多推文，但这并没有发生。该脚本只是继续尝试重新连接，但无法建立任何连接。会是什么呢？我的代码如下所示：

```
my $done = AnyEvent->condvar;
my $count=0;
# track keywords através da OAuth
my $guard = AnyEvent::Twitter::Stream->new(
    consumer_key    => "...",    #My Oauth authentication enters here
    consumer_secret => "...",
    token           => "...",
    token_secret    => "...",
    method   => "filter",
    track    => $track,
    on_tweet => \&got_tweet,
    on_error => \&connection_close,
    timeout => 45,
);
sub connection_close{
    my($headers)=@_;
    print "HEADERS: $headers\n\n\n\n\n";
    open(FOUT,">>arquivoalerta.txt");
    my $Agora = time();
    my $HoraLocal = localtime($Agora);
    my @Tempo = split(/ +/,$HoraLocal);
    print FOUT "Parei de coletar às @Tempo  Streaming API";
    if ($count==0){
        print FOUT "Dormindo por 10 segundos\n";
        print "Dormindo por 10 segundos\n";
        sleep 10;
    }
    elsif($count==1){
        print FOUT "Dormindo por 20 segundos\n";
        print "Dormindo por 20 segundos\n";
        sleep 20;
    }
    else{
        print FOUT "Dormindo por 240 segundos\n";
        print "Dormindo por 240 segundos\n";
        sleep 240;
    }
    close(FOUT);
    $count++;
    warn "Connection to Twitter closed";
}

sub got_tweet {
    #Here I treat the data and store it in a database ...
}

$done->recv; 
```

感谢大家，

蒂亚戈

# mysql - 在 bash 和 mysql 中使用反斜杠

> ID：11214141
> 
> 赞同：3
> 
> 时间：2012-06-26T18:54:57.217
> 
> 标签：mysql, bash, escaping, backslash

这让我今天大吃一惊。我有一个 bash 脚本来在 MySQL 表中设置一个值：我必须设置的值是带有尾随反斜杠的 UNC 路径：\\$HOSTNAME\path\

在 mysql 内部，查询有效：

```
update mytable SET myvalue = '\\\\MYSERVER\\path\\' WHERE ID=10; 
```

但从 bash 开始，它失败了：

```
mysql -e "update mytable SET myvalue = '\\\\$HOSTNAME\\path\\' WHERE ID=10;" 
```

MySQL 给出语法错误：

```
ERROR 1064 (42000) at line 1: You have an error in your SQL syntax; 
check the manual that corresponds to your MySQL server version for the 
right syntax to use near ''\\MYSERVER\path\' WHERE ID=10' at line 1 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:05:18.723

因为它在双引号内，所以您需要将所有这些反斜杠加倍。

如果您不需要扩展任何 shell 变量，请交换单引号和双引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:08:26.617

```
mysql -e 'SELECT "\\\\server\\path\\"'
mysql -e 'update mytable SET myvalue = "\\\\server\\path\\" WHERE ID=10;' 
```

# spring - Null ModelAndView 返回 DispatcherServlet

> ID：11214143
> 
> 赞同：4
> 
> 时间：2012-06-26T18:55:07.180
> 
> 标签：spring, hibernate, tiles

我正在尝试使用 Spring、Hibernate 和 Apache Tiles 运行我的 Web 应用程序。似乎代码没有错误，但我只是得到一个 404 页面。

/var/log/tomcat7/catalina.out：

```
DEBUG: org.springframework.web.servlet.DispatcherServlet - Servlet 'dispatcher' configured successfully
DEBUG: org.springframework.web.servlet.DispatcherServlet - DispatcherServlet with name 'dispatcher' processing GET request for [/example/index.html]
DEBUG: org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping - Looking up handler method for path /index.html
DEBUG: org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping - Did not find handler method for [/index.html]
DEBUG: org.springframework.web.servlet.handler.SimpleUrlHandlerMapping - Matching patterns for request [/index.html] are [/**]
DEBUG: org.springframework.web.servlet.handler.SimpleUrlHandlerMapping - URI Template variables for request [/index.html] are {}
DEBUG: org.springframework.web.servlet.handler.SimpleUrlHandlerMapping - Mapping [/index.html] to HandlerExecutionChain with handler [org.springframework.web.servlet.resource.DefaultServletHttpRequestHandler@32645ccb] and 1 interceptor
DEBUG: org.springframework.web.servlet.DispatcherServlet - Last-Modified value for [/example/index.html] is: -1
DEBUG: org.springframework.web.servlet.DispatcherServlet - Null ModelAndView returned to DispatcherServlet with name 'dispatcher': assuming HandlerAdapter completed request handling
DEBUG: org.springframework.web.servlet.DispatcherServlet - Successfully completed request 
```

小服务程序：

```
<servlet>
    <servlet-name>dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath:/META-INF/spring/dispatcher-servlet.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>dispatcher</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

语境：

```
<mvc:annotation-driven />
<tx:annotation-driven />

<bean id="viewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">
    <property name="viewClass" value="org.springframework.web.servlet.view.tiles2.TilesView" />
</bean>

<bean id="tilesConfigurer" class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
    <property name="definitions">
        <value>
            /WEB-INF/**/tiles.xml
        </value>
    </property>
</bean>

<context:component-scan base-package="com.example.controller" />
<resources mapping="/resources/**" location="/resources/" />
<default-servlet-handler />
<context:property-placeholder location="classpath:jdbc.properties" />

<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName" value="${jdbc.driverClassName}" />
    <property name="url" value="${jdbc.url}" />
    <property name="username" value="${jdbc.username}" />
    <property name="password" value="${jdbc.password}" />
</bean>

<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="packagesToScan" value="com.example.model" />
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">${hibernate.dialect}</prop>
            <prop key="hibernate.show_sql">${hibernate.show_sql}</prop>
            <prop key="hibernate.generate_statistics">${hibernate.generate_statistics}</prop>
        </props>
    </property>
</bean>

<bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean> 
```

Maven依赖：

```
<properties>
    <java.version>1.6</java.version>
    <spring.version>3.1.1.RELEASE</spring.version>
    <slf4j.version>1.6.4</slf4j.version>
</properties>

<dependencies>

    <dependency>
        <groupId>cglib</groupId>
        <artifactId>cglib</artifactId>
        <version>2.2.2</version>
    </dependency>

    <!-- Spring -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>${spring.version}</version>
        <exclusions>
            <!-- Exclude Commons Logging in favor of SLF4j -->
            <exclusion>
                <groupId>commons-logging</groupId>
                <artifactId>commons-logging</artifactId>
             </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-orm</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-tx</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>${spring.version}</version>
    </dependency>

    <!-- Logging -->
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>${slf4j.version}</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>jcl-over-slf4j</artifactId>
        <version>${slf4j.version}</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>${slf4j.version}</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.17</version>
        <scope>runtime</scope>
    </dependency>

    <!-- Hibernate -->
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>4.1.1.Final</version>
    </dependency>
    <dependency>
        <groupId>postgresql</groupId>
        <artifactId>postgresql</artifactId>
        <version>9.1-901-1.jdbc4</version>
    </dependency>

    <!-- Servlet -->
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
    </dependency>

    <!-- Apache Tiles -->
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-jsp</artifactId>
        <version>2.2.2</version>
        <exclusions>
            <!-- Exclude Commons Logging in favor of SLF4j -->
            <exclusion>
                <groupId>commons-logging</groupId>
                <artifactId>commons-logging-api</artifactId>
             </exclusion>
        </exclusions>
    </dependency>

    <!-- JSR 303 with Hibernate Validator -->
    <dependency>
        <groupId>javax.validation</groupId>
        <artifactId>validation-api</artifactId>
        <version>1.0.0.GA</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-validator</artifactId>
        <version>4.1.0.Final</version>
    </dependency>

</dependencies> 
```

在添加所有休眠内容之前，我尝试了 Web 应用程序，它工作得很好。但是没有数据库的 webapp 是什么？

我已经花了几个小时在这上面，只是找不到问题......

**更新**

控制器：

```
package com.example.controller;

import java.util.Map;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@RequestMapping("/")
public class BlogController {
    @RequestMapping("/index.html")
    public String posts(Map<String, Object> map) {
        return "posts";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-06-22T06:35:16.797

尝试发送 ModelAndView 而不是 String 或

您可以将地图对象作为参数发送给 ModelandView 方法（已经重载）

```
@Controller 
@RequestMapping("/") 
public class BlogController {
    @RequestMapping("/index.html")
    public ModelAndView posts(Map<String, Object> map) {
      return new ModelAndView("/index.jsp", "status", status);
    } 
} 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-06-26T20:08:13.663

我解决了。

有两个上下文：根（应用程序范围）和我定义的 servlet 上下文，和`viewResolver`在`tilesConfigurer`根上下文中。`tx:annotation-driven``mvc:annotation-driven`

将它移动到 servlet 上下文解决了这个问题。

**已更新** 我已将`viewResolver`、`tilesConfigurer`和定义从`tx:annotation-driven`( )`mvc:annotation-driven``applicationContext.xml``contextConfigLocation``dispatcher-servlet.xml`

# spring - 在 acl_sid 表中结合处理 GrantedAuthority 和 Principle 的 Spring ACL

> ID：11214145
> 
> 赞同：3
> 
> 时间：2012-06-26T18:55:11.797
> 
> 标签：spring, spring-security, acl

我们可以在 acl_sid 中​​同时执行 Principle 和 GratedAuthority 并在 spring acl security 中授予对象权限吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T03:11:32.087

是的，我们可以做到。ACL_SID 表可以采用角色或用户的 SID。

这是角色时的示例插入：

```
insert into acl_sid (principal, sid) values (false, 'ROLE_ADMIN'); 
```

如果它是用户主体，则插入将是：

```
insert into acl_sid (principal, sid) values (true, 'bob'); 
```

您还可以使用可变 ACL 对 ACL 字段进行运行时操作。

这是一个示例：

```
// Prepare the information we'd like in our access control entry (ACE)
ObjectIdentity oi1 = new ObjectIdentityImpl(Foo.class, new Long(44));
ObjectIdentity oi2 = new ObjectIdentityImpl(Bar.class, new Long(44));
Sid user = new PrincipalSid("bob");
Sid adminRole = new GrantedAuthoritySid("ROLE_ADMIN");
Permission p1 = BasePermission.READ;
Permission p2 = BasePermission.ADMINISTRATION;

// Create or update the relevant ACL
MutableAcl acl1 = null;
MutableAcl acl2 = null;
try {
  acl1 = mutableAclService.readAclById(oi1);
} catch (NotFoundException nfe) {
  acl1 = mutableAclService.createAcl(oi1);
}

try {
  acl2 = mutableAclService.readAclById(oi2);
} catch (NotFoundException nfe) {
  acl2 = mutableAclService.createAcl(oi2);
}

// Now grant some permissions via an access control entry (ACE)
acl1.setOwner(user);
acl1.insertAce(0, p1, user, true);
aclService.updateAcl(acl1);
acl2.setOwner(adminRole);
acl2.insertAce(0, p2, adminRole, true);
aclService.updateAcl(acl2); 
```

# jsf - 在超级 bean 和扩展 bean 上调用 @PostConstruct

> ID：11214146
> 
> 赞同：9
> 
> 时间：2012-06-26T18:55:19.783
> 
> 标签：jsf, postconstruct

我有一个带有@PostConstruct 的BaseBean，还有一个扩展它的bean，我想在它上面调用另一个@PostConstruct。我已经阅读了几个地方说有可能，但是，似乎首先调用了扩展类上的@postConstruct（如果根本调用了第二个）。然后我在“上下文”上得到一个 NPE，因为我假设超级 bean 的 PostConstruct 已经被调用。

这是可行的吗？如果是这样，我做错了什么？

基豆：

```
@ManagedBean
@RequestScoped
public class BaseBean {
@ManagedProperty(value = "#{contextBean}")
  private ContextBean contextBean;
  Context context;
@PostConstruct
public void setupContext() {
    context = getContextBean().getContext();
} 
```

扩展豆：

```
@ManagedBean
@RequestScoped
public class SmartBoxSearchBean extends BaseBean {
@PostConstruct
public void setUp() {
    jsonHelper = context.get(SmartBoxJsonHelper.class);
} 
```

谢谢，尤塔姆。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-26T19:15:52.480

`@PostConstruct`构建托管 bean 时，根本不调用支持 bean 的超类。只有在您的情况下，例如通过在 EL 中使用来构造该超类的**完全独立**的托管 bean 实例时，才会调用它。`#{baseBean}`您实际上最终得到了两个完全独立的实例`#{baseBean}`，`#{smartBoxSearchBean}`其中类自己的`@PostConstruct`方法在托管 bean 类本身上独立调用。

这个设计有些奇怪。支持 bean 的超类通常根本不用作托管 bean。

我建议修改您的方法如下：

```
public abstract class BaseBean {

    @ManagedProperty("#{contextBean}")
    private ContextBean contextBean;

    public Context getContext() {
        return contextBean.getContext();
    }

} 
```

和

```
@ManagedBean
@RequestScoped
public class SmartBoxSearchBean extends BaseBean {

    @PostConstruct
    public void setUp() {
        jsonHelper = getContext().get(SmartBoxJsonHelper.class);
    }

} 
```

或者也许这个，如果你根本不需要`ContextBean`其他目的

```
public abstract class BaseBean {

    @ManagedProperty("#{contextBean.context}")
    private Context context;

    public Context getContext() {
        return context;
    }

} 
```

请注意，`@ManagedProperty`以这种方式在超类中声明时效果很好。

* * *

**更新**：根据功能要求，您还可以解耦 bean，只需`#{baseBean}`将`{smartBoxSearchBean}`.

```
@ManagedBean
@RequestScoped
public class BaseBean {

    @ManagedProperty("#{contextBean}")
    private ContextBean contextBean;
    private Context context;

    @PostConstruct
    public void init() {
        context = contextBean.getContext();
    }

} 
```

和

```
@ManagedBean
@RequestScoped
public class SmartBoxSearchBean {

    @ManagedProperty("#{baseBean}")
    private BaseBean baseBean; 

    @PostConstruct
    public void setUp() {
        jsonHelper = baseBean.getContext().get(SmartBoxJsonHelper.class);
    }

} 
```

# iphone - 第一次如何创建 iPhone 数据库？

> ID：11214147
> 
> 赞同：4
> 
> 时间：2012-06-26T18:55:19.830
> 
> 标签：iphone, ios

我是 iOS 编程新手。

我第一次想知道如何在真正的 iPhone 设备上创建数据库。

我已经从终端创建了一个数据库并将其复制到项目目录中，并将其用于插入/更新/删除/等，如许多教程中所示。但是当我在真实设备上运行应用程序时，它将如何创建呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T18:59:15.807

使用 Core Data 简化您在 iOS 中的数据库访问需求。默认情况下，它由 SQLite DB 支持，如果还没有，它将创建一个。

如果您需要预先填充数据库，然后像您在问题中提到的那样制作一个，并将其作为资源添加到您的 Xcode 项目中。然后当你的应用程序第一次启动时，在初始化核心数据之前，将你的 .sqlite 文件复制到 Documents 文件夹中，它将被使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:24:14.340

您可以使用核心数据以及 sqlite 。

当您在应用程序中添加 sqlite 文件并在设备中运行它时，sqlite 文件将自动保存到文档目录。

**您可以在以下位置找到该模拟器文件**：

/Users/URNAME/Library/Application Support/iPhone Simulator/4.3/Applications/1B787527-0608-4BC1-8022-DFDB3CC35F66/mysqlite.sqlite。

**有关更多详细信息，请参阅**

[应用程序在设备上运行时如何获取 Sqlite 数据库文件](https://stackoverflow.com/questions/6620691/how-to-get-sqlite-database-file-when-application-is-running-on-device)

**对于在您的应用中添加 sqlite，请参阅**

[http://www.icodeblog.com/2008/08/19/iphone-programming-tutorial-creating-a-todo-list-using-sqlite-part-1/](http://www.icodeblog.com/2008/08/19/iphone-programming-tutorial-creating-a-todo-list-using-sqlite-part-1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:11:51.027

您可以使用以下两个选项，

*   使用核心数据

*   使用直接 SQLite

参考链接：[何时使用 Core Data，何时使用 Sqlite？](https://stackoverflow.com/questions/11211209/when-to-use-core-data-and-when-to-use-sqlite/11211523#11211523)

# java - 实例如何与其实例化器通信？

> ID：11214152
> 
> 赞同：0
> 
> 时间：2012-06-26T18:55:35.807
> 
> 标签：java, object, communication, instance

给出一个非常简单的例子：

```
Class A {
    B b = new B();
}

Class B {
    //unicorns and what-not
    //Something happens and I want to let A know
    //Yet I don't want to return and exit
} 
```

有没有什么方法可以让 B 在没有套接字的情况下与 A 通信？通过通信，我的意思是 B 向 A 发送值，而 A 不调用 B 上的方法。

**编辑**：感谢您的回复。以下是我的后续问题：

如果我有以下情况，并且方法 signal() 被 B 的 2 个实例同时调用，这将导致每个 B 调用操作两次发生冲突。我能做些什么来解决它？

```
//Modified from Jon Skeet
public class A {
    private B b[];

    public A() {
        //for loop
        b[i] = new B(this);
    }

    public void signal() {
        //for loop
        b[i].action();
    }
}

public class B {
    A creator;

    public B(A creator) {
        this.creator = creator;
    }

    public void action() {
        //stuff
    }

    public void main(String[] args) {

        while(true)
            if(something==true) {
                creator.signal();
            }

   }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T18:58:49.633

您必须传递`this`给 B 的构造函数：

```
public class A {
    private B b;

    public A() {
        b = new B(this);
    }
}

public class B {
    A creator;

    public B(A creator) {
        this.creator = creator;
    }
} 
```

诚然，`this`在构造函数中让“escape”通常不是一个好主意，但它经常比替代方案更干净。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T18:59:17.577

> // unicorns and what-not

If `A` passes `B` an instance of itself in the constructor, you [ain't need no stinkin unicorns](http://en.wikipedia.org/wiki/Stinking_badges):

```
class B {
    A instantiator;
    public B(A inst) { instantiator = inst; }
}

class A {
    B b = new B(this);
} 
```

**EDIT** (to answer the follow-up question)

If you would like to make sure that multiple invocations of `signal` do not modify the the state of `A` concurrently, you should protect its *critical sections* by using `synchronized` keyword. If the entire method represents a single critical section, you can add `synchronized` to method's declaration, like this:

```
public synchronized void signal() {
    //for loop
    b[i].action();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-26T18:58:58.893

Give them both access to the same `Queue`. One puts elements onto it, the other pulls elements from it. If they're in separate threads, one of the [`BlockingQueue`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/BlockingQueue.html) implementations should do the trick.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T18:59:42.787

```
Class A {
    B b = new B(this);

    public void MyCallback(Object o) {

        //Whatever
    }
}

Class B {
    //unicorns and what-not

    private A a;

    // .... assign a in constructor ...

    // wherever 
    a.MyCallback(MyUnicorn);
} 
```

# oracle-adf - 使用 WLST 更新 adf-config.xml：mbean 在哪里？

> ID：11214161
> 
> 赞同：2
> 
> 时间：2012-06-26T18:56:32.263
> 
> 标签：oracle-adf, mbeans, wlst

我一直在尝试更改在 Oracle Webcenter 的 adf-config.xml 中找到的值。我正在尝试更改 portlet 生产者的默认、最小和最大超时。文档说要编辑 adf-config.xml，而 adf-config.xml 文档说要使用 WSLT 来这样做。我已经对 WSLT 进行了足够多的研究和修改，一旦我找到了正确的 MBean，我认为我了解如何去做。我终生无法在 MBean 浏览器中找到它。

1) 我正在专门寻找 adf-config.xml : adf-portlet-config>defaultTimeout (min&Max too) 2) MBean 与各种 XML 文档及其元素之间的映射文档。

任何帮助将非常感激。

# android - 如何在自定义 Spinner DropDownView 中指定选择事件？

> ID：11214162
> 
> 赞同：2
> 
> 时间：2012-06-26T18:56:34.513
> 
> 标签：android, spinner, android-spinner

我有一个自定义适配器来处理“信号”对象。当我自定义 TextView 并从 Spinner 的 getDropDownView 方法返回它时，它扩展了 BaseAdapter 并且工作正常。但是，除了 TextView 标签之外，我还想有一个播放/停止按钮，所以我扩展了 LinearLayout 以包含一个 TextView 和 ImageButton。当我从 getDropDownView 而不是纯 TextView 返回自定义 LinearLayout 时，它呈现正常，但 Spinner 不会识别任何“选择”事件。

当 getDropDownView 方法返回一个 TextView 时，单击 TextView 似乎会触发 Spinner 选择更改，而我没有任何编码帮助。我一直无法弄清楚 Android 正在做什么来实现这一点。我想将 Spinner 选择更改定义为单击我的 LinearLayout 中的 TextView。我该怎么做呢？所有这些都是在 Java 代码中定义和操作的，没有 xml。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:22:51.983

如果我理解您的问题，您想在用户单击 Spinner 中的项目时播放声音吗？我会使用 OnItemSelectedListener()：

```
spinner.setOnItemSelectedListener(new OnItemSelectedListener() {
    public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
        Log.v("Example", "Item Selected");
        // Play sound
    }

    public void onNothingSelected(AdapterView<?> arg0) {
        // Do nothing
    }
}); 
```

# haskell - 如何在生产中运行 Snap haskell webapp？

> ID：11214167
> 
> 赞同：29
> 
> 时间：2012-06-26T18:56:47.350
> 
> 标签：haskell, haskell-snap-framework

我已经在我的生产 Ubuntu 服务器（在 EC2 上）上安装了 Snap/Haskell，并签出了我的项目——但是我该如何运行它呢？

我的意思是，在本地，我从命令行运行它：

```
project-name -p 8000 
```

snap 是否带有它自己的网络服务器（[看起来像](http://hackage.haskell.org/package/snap-server-0.7.0.1)），如果是这样，我该如何配置它以作为某种守护进程运行？

有小费吗？

*编辑2：*

他们在[维基](http://snapframework.com/docs/tutorials/snap-api)上说：

> snap-server 是一个 HTTP 服务器库，支持 snap-core 中定义的接口。

在这里，关于“haskell web 代码的部署/后端选项”的 haskell wiki 说 Snap：

> 包括自己的服务器。[见网络/框架](http://www.haskell.org/haskellwiki/Web/Frameworks)

但是**如何**？我将如何运行它自己的服务器？如果我只是对编程感兴趣，为什么我必须知道该死的东西的部署......

*编辑：*相关问题：[部署使用 Snap 框架的 Haskell 代码](https://stackoverflow.com/questions/7539450/deploy-haskell-code-that-uses-the-snap-framework)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-03T05:15:29.907

好的，所以经过一些[挖掘](https://stackoverflow.com/a/7544384/74865)和[询问](https://serverfault.com/questions/404251/how-to-properly-configure-a-web-service-ubuntu-12-04)，这就是我想出的。

## 大创意

[将您的 Snap 应用程序编译成二进制文件，然后在upstart](http://upstart.ubuntu.com/cookbook/)的帮助下将其作为服务运行。

## 一步步

1.  编译你的 web 应用程序。为了这个例子，我们假设 webapp 位于`/home/john/webapps/mysite`：

    ```
    $ cd /home/john/webapps/mysite
    $ cabal install
    ...
    Preprocessing executable 'mysite` for 'mysite-0.1'...
    Installing executable(s) in /home/john/.cabal/bin 
    ```

    正如我们所看到的，二进制文件放在`/home/john/.cabal/bin`. 你可以把它移到你喜欢的任何地方，但我们会把它留在那里。

2.  在您的应用程序文件夹中创建一个日志，否则 snap 会报错：

    ```
    $ mkdir /home/john/webapps/mysite/log 
    ```

3.  现在我们将创建一个运行我们的 webapp 的服务。为此，我们将使用 Ubuntu 的服务工具[upstart](http://upstart.ubuntu.com/cookbook/)。

    a) 我们只需通过在目录中创建一个具有所需名称的 conf 文件来命名我们的服务`/etc/init/`。让我们称之为`mysite`：

    ```
    $ sudo vi /etc/init/mysite.conf 
    ```

    b) 现在让我们添加对我们的服务的描述：

    ```
    start on startup
    chdir /home/john/webapps/mysite
    exec /home/john/.cabal/bin/mysite -p 80 
    ```

    首先，我们说服务应该在系统启动（或启动）时运行。

    其次，由于 snap 需要它`snaplets`和其他静态资源（例如我们之前创建的日志目录） - 我们告诉服务在我们的项目目录中运行。

    最后，我们指定实际将作为服务运行的二进制文件：`/home/john/.cabal/bin/mysite`. 我们将`-p 80`参数传递给 snap webserver 以使其在端口 80 上运行。（注意：您必须禁用所有 apache 和 nginx 服务器，以便它们不再占用该端口）

4.  完毕。您可以检查它是否正在运行并在需要时手动启动它：

    ```
    initctl list | grep mysite
    initctl start mysite 
    ```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-06-28T06:28:34.307

是的，snap-server 是它自己的服务器，这意味着您的 Haskell/Snap 应用程序的编译会给您留下一个可执行文件，您可以从命令行运行它来托管您的站点。就是这样，没有像 apache 或 nginx 这样的外部服务器可以绑定。如果需要，您可以设置反向代理，但这取决于您。

以下是我对大部分严肃部署所做的事情：

*   在同一个 linux 机器或兼容机器上编译 - 我几乎总是使用 cabal-dev 进行沙盒
*   命令行参数： `cabal-dev/bin/myapp -p 8010 -e prod +RTS -A4M -qg1`
*   我在一个非特权、非默认端口（上面的 8010）上运行，以便我可以使用负载均衡器将请求转发给它。如果需要，这还允许我在每个 linux 机器上运行多个快照应用程序。
*   然后我使用一个简单的过程监控应用程序来确保它保持正常运行。您可以使用：
    *   上帝： http: [//godrb.com/](http://godrb.com/)
    *   天使：[https ://github.com/jamwt/Angel](https://github.com/jamwt/Angel)
    *   主管：[http ://supervisord.org/](http://supervisord.org/)
*   设置好监视器后，您只需`HUP`在要重新启动时向应用程序发送信号，监视应用程序就会将其重新启动。
*   [我是Fabric](http://fabric.readthedocs.org/en/latest/tutorial.html)部署自动化的忠实粉丝。您可以使用fabric 处理远程同步、重启等。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-27T16:57:59.783

由于它是 Ubuntu，因此您几乎总是最好使用 upstart 来管理它。

`man 5 init`

除此之外，它还允许您为服务设置依赖层次结构。“snapapp 依赖于 mongodb，所以在 mongodb 运行之前不要启动 snapapp”——诸如此类。

是的，snap 是一个 web 服务器，但我们几乎总是将 nginx 放在它们前面，而 ​​snap 应用程序只在 localhost 上侦听，并`proxy_path`指向服务器或一组服务器。

有趣的是，我们在 $work 几乎完全切换到 Common Lisp 进行新开发，而且设置完全相同。

# javascript - 自定义“步骤” js 以刷新到当前步骤和直接步骤 URL？

> ID：11214169
> 
> 赞同：0
> 
> 时间：2012-06-26T18:56:53.140
> 
> 标签：javascript, jquery

我有一些js（我猜显示/隐藏很标准）：

```
<script>
    function showTransactions(transactions){
        $('.steps').hide()
        $('#' + transactions).show();
    }
</script> 
```

和一些html：

```
<p><a href="#"onClick="showTransactions('hidden3');return false;">Edit</a></p>
<div id="hidden3" class="steps" style="display: none;"> 
```

现在，当我单击链接时效果很好，它显示了它。简单的。如何让 js 刷新到当前步骤？我有隐藏1、隐藏2、隐藏3和隐藏4的步骤。默认起始位置是 hidden1，因此刷新时它将显示 hidden1 而不是 hidden3 如果您在刷新位置。

此外，我需要通过 url 链接将用户引导到某些实例上的特定步骤。我试过 page_url#hidden4 但这不起作用。我需要能够告诉它在该链接中显示 hidden4 而不是默认的第一步。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:33:47.047

您的代码有两个主要问题：

*   您不会将 jQuery 代码挂接到“文档就绪”事件。不这样做会（可能）导致它在文档完全加载之前运行，这在大多数情况下是不可取的。
*   您正在使用`onclick`内联 JavaScript。不要那样做。这不再是编写 JavaScript/HTML 集成的方式了。jQuery 有事件处理程序来为你捕捉点击事件。始终保持 HTML 和 JavaScript 100% 分开。

CSS：

```
.hidden {
  display: none;
} 
```

HTML

```
<p><a class="reveal" href="#hidden3">Edit</a></p>
<div id="hidden3" class="hidden step"> 
```

JavaScript

```
// $() is short for $(document).ready()
$(function () {
    // hide all the steps on document load
    $("div.step").addClass("hidden");

    // show the one step that is identified by the current hash (if any)
    $(document.location.hash).removeClass("hidden");

    $("a.reveal").click(function (event) {
        var idToReveal = $(this).attr("href");

        // store the ID to show in the URL for bookmarking
        document.location.hash = idToReveal;

        // hide every step that is currently visible
        $("div.step").not(".hidden").addClass("hidden");

        // reveal the next div (as identified by the current link's href)
        $(idToReveal).removeClass("hidden");

        // prevent the default click behavior (i.e. prevent navigation)
        event.preventDefault();
    });
}); 
```

上面利用了一个事实`document.location.hash`，一个页面内部`<a href>`和[jQuery 的 ID 选择器](http://api.jquery.com/id-selector/)都使用相同的语法。

只要您只想在散列中传输一点信息，这就是您所需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:02:25.290

使用 cookie 或 localstorage 设置向导的“状态”

```
localStorage.Step=2; 
```

[Cookies (om nom nom)](http://www.w3schools.com/js/js_cookies.asp) [HTML LocalStorage](http://www.w3schools.com/html5/html5_webstorage.asp)

# django - 我可以在 django 中为同一模型制作外键吗？

> ID：11214175
> 
> 赞同：74
> 
> 时间：2012-06-26T18:57:27.570
> 
> 标签：django, django-models

假设我有这个模型：

```
class Task(models.Model):
    title = models.CharField() 
```

现在我想一个任务可能与另一个任务有关。所以我想这样做：

```
class Task(models.Model):
    title = models.CharField()
    relates_to = ForeignKey(Task) 
```

但是我有一个错误，指出任务是注释定义的。这是否“合法”，如果不是，我应该如何做类似的事情？

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2012-06-26T18:59:55.213

```
class Task(models.Model):
    title = models.CharField()
    relates_to = models.ForeignKey('self') 
```

[https://docs.djangoproject.com/en/dev/ref/models/fields/#foreignkey](https://docs.djangoproject.com/en/dev/ref/models/fields/#foreignkey)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-06-26T19:00:18.630

是的，您可以这样做，将 ForeignKey 属性设为字符串：

```
class Task(models.Model):
    title = models.CharField()
    relates_to = ForeignKey(to='Task') 
```

深入地讲，您还可以使用点符号交叉引用应用程序的模型，例如

```
class Task(models.Model):
    title = models.CharField()
    relates_to = ForeignKey(to='<app_name>.Task')  # e.g. 'auth.User' 
```

# menu - 有没有办法将 RoboHelp html 主题列表索引强制到单个文件中？

> ID：11214178
> 
> 赞同：0
> 
> 时间：2012-06-26T18:57:38.333
> 
> 标签：menu, tags, robohelp

我们目前在 Windows 7 64 位环境中使用 RoboHelp 8。当我们将文件输出到 WebHelp 时，RoboHelp 会自动创建一系列文件，`whlsti*.htm`其中 * 是一个连续的文件编号。这些文件位于以下路径中：`Output\Production\WebHelp\whgdata`并且是从主题列表中的条目生成的。

目前，凭借我们拥有的大量帮助文档，该索引存在于 13 个文件中……`whlsti0.htm`尽管如此`whlsti12.htm`。

我们正在尝试为一个单独的项目捕获该 HTML，但我们需要一个文件，该文件实质上是将所有 13 个文件串联到一个文档中。是否有一个菜单选项可以将输出强制输出到单个文件中？还是我正在寻找一份剪切粘贴的工作？

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:43:42.743

简短的回答是否定的。准备剪切和粘贴。

# css - CSS 适用于外部文件，但不适用于主文件本身

> ID：11214185
> 
> 赞同：0
> 
> 时间：2012-06-26T18:58:02.907
> 
> 标签：css, slashdot

我的 SlashDot 菜单中有这个问题。

我想用 PHP if 条件更改图片，我知道您不能将 PHP 放入 css 文件中。

所以我排除了片段并将其放在主文件中。

但是，图片没有显示（bgcolor 确实发生了变化）。知道为什么会发生这种情况吗？

这是 SlashDot 的 css：

```
div.sdmenu {
width: 150px;
font-family: Arial, sans-serif;
font-size: 12px;
padding-bottom: 10px;
background: url(bottom.gif) no-repeat  right bottom;
color: #fff;
}
div.sdmenu div {
background: url(title.gif) repeat-x;
overflow: hidden;
}
div.sdmenu div:first-child {
background: url(toptitle.gif) no-repeat;
}
div.sdmenu div.collapsed {
     height: 25px;
}
div.sdmenu div span {
    display: block;
    padding: 5px 25px;
    font-weight: bold;
    color: white;
    background: url(expanded.gif) no-repeat 10px center;
        background-position: 95%;
   cursor: default;
   border-bottom: 1px solid #ddd;
}
div.sdmenu div.collapsed span {
background-image: url(collapsed.gif);
background-position: 95%;
}
div.sdmenu div a {
padding: 5px 10px;
background: #eee;
display: block;
border-bottom: 1px solid #ddd;
color: #066;
}
div.sdmenu div a.current {
background : #ccc;
} 
```

这是主文件中的片段：

```
div.sdmenu div a:hover {
background : #066 url(linkarrow.gif) no-repeat right center;
color: #fff;
text-decoration: none;
} 
```

这是在“style type='text/css'”标签中，但我只是没有找到如何在此处插入 html 标签。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:04:19.143

需要根据写css的php文件设置背景图片路径

# php - 如何从 mysql 表中显示每小时统计信息

> ID：11214191
> 
> 赞同：2
> 
> 时间：2012-06-26T18:58:19.143
> 
> 标签：php, mysql, date, time

我正在尝试为 PHP 中的图表生成数据，该图表显示 mysql 表在特定时间范围内按每小时细分的记录量。每条记录都有一个 unix 时间戳。

例如，假设我想显示今天的统计数据。下面的代码“有效”，但在运行它并查看我所做的之后，它只是发生了可怕的胡言乱语。当我在具有数百万条索引记录的表上运行它时，它很慢www。

它现在所做的是每小时执行一次查询，直到达到 24 小时。问题是我试图同时从多达 10 个其他表中提取数据。这意味着我可以在每个页面加载时运行多达 240 个查询，这并不好。

```
$c = '0';
$h = '1';
while($h < 25){
    $hr_start = 3600 * $c;
    $hr_stop = 3600 * $h;
    $query = "SELECT `reason`,`timestamp`
    FROM `c_blacklist` 
    WHERE `timestamp` > '".strtotime('today')."'  + ".$hr_start." AND `timestamp` < '".strtotime('today')."' + ".$hr_stop." AND `reason` = 'hardbounce'";
    $result = mysql_query($query) or die(mysql_error());
    $hardbounce_count = mysql_num_rows($result);
    $dataset5[] = array($h,$hardbounce_count);
    $h++;
    $c++;
} 
```

我知道有更好的方法可以做到这一点，但我无法找到太多关于它的信息。有没有办法运行 1 个查询，然后让 PHP 按小时分解它并插入数据集中？我很困惑，我很感激任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:05:37.720

您可以创建一种“报告查询”，在调用时会为您提供最近 24 小时的数据。

第一步是创建一个包含 24 行的引用表，其中包含数字 1-24（或 0-23，具体取决于您的逻辑）。我会打电话给这张桌子`hours`。通过使用此参考表，如果在给定小时内未发生任何活动，您仍将获得 0 计数。这与仅对时间戳执行 GROUP BY 的方法不同。

然后，使用[`TIMEDIFF`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_timediff)和[`HOUR`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_hour)函数的组合来*左连接*到该表。像这样的东西（未经测试，但你明白了）：

```
SELECT
    COUNT(c_blacklist.reason) as num_reasons,
    hours.hour as hour
FROM hours
LEFT JOIN c_blacklist
   ON HOUR(TIMEDIFF(now(), c_blacklist.timestamp)) = hours.hour
GROUP BY hours.hour 
```

这将输出 24 行，其中包含过去 24 小时中每个小时的“原因”数。如果需要，您可以很容易地添加一些时间戳

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T00:29:46.673

让数据库返回一个计数会快得多，而不是拉回所有详细信息行并在客户端进行计数。

您可以在一个查询中提取整整 24 小时的计数，这（可能）比对数据库进行 24 次往返以获取单个计数要高效得多。

`c_blacklist(timestamp)`如果您有一个索引，甚至更好的覆盖索引，也可能会提高（查询的）性能`c_blacklist(timestamp,reason)`。

如果`timestamp`列是 datatype `TIMESTAMP`，那么我们可以做一些简单的算术来推导出“小时”，并按每个“小时”计算。

```
SELECT FROM_UNIXTIME((UNIX_TIMESTAMP(cb.`timestamp`) DIV 3600) * 3600) AS `cb_hour`
     , COUNT(1) AS cb_count
  FROM `c_blacklist` cb
 WHERE cb.`timestamp` >= DATE_ADD('2012-06-26 18:00',INTERVAL -1 DAY)
   AND cb.`timestamp` <  '2012-06-26 18:00'
   AND cb.`reason` = 'hardbounce'
 GROUP BY FROM_UNIXTIME((UNIX_TIMESTAMP(cb.`timestamp`) DIV 3600) * 3600)
 ORDER BY FROM_UNIXTIME((UNIX_TIMESTAMP(cb.`timestamp`) DIV 3600) * 3600) 
```

如果时间戳列是 datatype `DATETIME`，使用不同的表达式来获取小时可能会更快：

```
SELECT DATE_FORMAT(cb.`timestamp`,'%Y-%m-%d %H:00:00') AS `cb_hour`
     , COUNT(1) AS cb_count
  FROM `c_blacklist` cb
 WHERE cb.`timestamp` >= DATE_ADD('2012-06-26 18:00',INTERVAL -1 DAY)
   AND cb.`timestamp` <  '2012-06-26 18:00'
 GROUP BY DATE_FORMAT(cb.`timestamp`,'%Y-%m-%d %H:00:00')
 ORDER BY DATE_FORMAT(cb.`timestamp`,'%Y-%m-%d %H:00:00') 
```

* * *

此查询将有“间隙”，其中没有要计算的行，也就是说，它们不会返回零计数。

这可以通过提供一个返回“小时”的每个值的行源来解决，然后对结果集执行左连接。在以下语句中，别名为 h 的子查询返回 24 行，每小时一行。我们将其用作针对“结果”查询（从上方）进行左连接的驱动行源。任何我们没有匹配到的地方，我们都会得到一个 NULL 来计数。我们可以通过一个简单的函数调用将 NULL 替换为零。

```
SELECT h.hour AS cb_hour
     , IFNULL(c.cb_count,0) AS cb_count
  FROM (SELECT DATE_ADD('2012-06-26 18:00',INTERVAL -1*d.i HOUR) AS `hour`
          FROM (SELECT 00 AS i UNION ALL SELECT 01 UNION ALL SELECT 02 UNION ALL SELECT 03 
                UNION ALL SELECT 04 UNION ALL SELECT 05 UNION ALL SELECT 06 UNION ALL SELECT 07 
                UNION ALL SELECT 08 UNION ALL SELECT 09 UNION ALL SELECT 10 UNION ALL SELECT 11 
                UNION ALL SELECT 12 UNION ALL SELECT 13 UNION ALL SELECT 14 UNION ALL SELECT 15 
                UNION ALL SELECT 16 UNION ALL SELECT 17 UNION ALL SELECT 18 UNION ALL SELECT 19 
                UNION ALL SELECT 20 UNION ALL SELECT 21 UNION ALL SELECT 22 UNION ALL SELECT 23 
                ORDER BY 1 DESC
               ) d
       ) h
  LEFT
  JOIN (SELECT FROM_UNIXTIME((UNIX_TIMESTAMP(cb.`timestamp`) DIV 3600) * 3600) AS `cb_hour`
             , COUNT(1) AS cb_count
          FROM `c_blacklist` cb
         WHERE cb.`timestamp` >= DATE_ADD('2012-06-26 18:00',INTERVAL -1 DAY)
           AND cb.`timestamp` < '2012-06-26 18:00'
           AND cb.`reason` = 'hardbounce'
         GROUP BY FROM_UNIXTIME((UNIX_TIMESTAMP(cb.`timestamp`) DIV 3600) * 3600)
         ORDER BY FROM_UNIXTIME((UNIX_TIMESTAMP(cb.`timestamp`) DIV 3600) * 3600)
       ) c
    ON c.cb_hour = h.hour
 ORDER BY h.hour 
```

当然，这比您目前拥有的查询文本要多得多。

要将其放入我的代码中，我会将出现的三个日期文字替换为“%s”，并使用 sprintf 将出现的三个日期替换为格式化的日期字符串。（所有三个事件都传递了相同的值。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:10:51.323

按时间戳的小时值分组。

```
SELECT
    date_format(`timestamp`,'%H') day_hour,
    count(*) count
FROM
    `c_blacklist`
WHERE
    `timestamp` between $start and $end
    and `reason` = 'hardbounce'
GROUP BY
    date_format(`timestamp`,'%H')
ORDER BY
    1;

$result = mysql_query($query) or die(mysql_error());
foreach($row = mysql_fetch_array($result)) {
    $dataset5[] = array($row['day_hour'],$row['count'])
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T19:05:06.273

```
$query = "SELECT `reason`,`timestamp`,FROM_UNIXTIME(timestamp, '%H') as Hour
FROM `c_blacklist` 
WHERE `timestamp` > ('".strtotime('today')."'  + ".$hr_start.") AND (`timestamp` < '".strtotime('today')."' + ".$hr_stop.") AND `reason` = 'hardbounce'
GROUP BY FROM_UNIXTIME(timestamp, '%H')"; 
```

添加了一些 () 用于操作保护顺序，但添加了 FROM_UNIXTIME('%H', timestamp) 假设时间戳是纪元/unix 时间戳，它将为您提供小时。

# gwt - 带有 Selenium 的 GWT CKEditor

> ID：11214193
> 
> 赞同：0
> 
> 时间：2012-06-26T18:58:21.973
> 
> 标签：gwt, selenium, ckeditor

我正在为我的应用程序使用**GWT-CKEditor**。我想通过**selenium**测试它。但我无法在 selenium 中找到 Ckeditor 的目标参数。我无法在 Selenium 中找到它。我怎样才能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T06:36:29.200

在 Selenium IDE 中使用以下命令来记录这个..

```
focus | class=html-editor portlet portlet-message-boards cke_show_borders

typeKeys | class=html-editor portlet portlet-message-boards cke_show_borders | Description 
```

在上面的命令中，class=html-editor portlet portlet-message-boards cke_show_borders 是我的应用程序的 CKEditor 的类 id，所以请使用 firebug 检查 GWT-CKEditor 类 id。

# android - 用 Fragments、Activity 和自定义回栈替换 ActivityGroup

> ID：11214201
> 
> 赞同：1
> 
> 时间：2012-06-26T18:58:47.100
> 
> 标签：android, tabs, android-fragments, android-tabhost

我似乎找不到从 ActivityGroup 继续前进的正确方法。我已经[使用 Fragments 在 Android 中的每个选项卡上看到了单独的后退堆栈](https://stackoverflow.com/questions/6987334/tabs-in-android-using-fragments)

采取以下措施：

*   具有 4 个选项卡的应用程序
*   每个选项卡都需要有自己的后台堆栈（类似于 iOS 行为，是的）
*   应用程序可能针对平板电脑进行了调整，因此后台堆栈需要保存*活动*

一旦您需要为平板电脑开发，活动将包含多个片段。拥有一堆 Fragments 是行不通的，因为 Fragments 不能嵌套，所以堆栈必须包含活动。

除了继续使用 ActivityGroup 之外，我似乎找不到解决方法。

谢谢！

**编辑1：** 一个具体的例子。

手持式：

```
 TAB 1 -> Activity 1A (Fragment 1A) 
       -> Activity 1B (Fragment 1B)  
       -> Activity 1C (Fragment 1C) 
```

药片：

```
 TAB 1 -> Activity 1A (Fragment 1A and 1B)
       -> Activity 1C (Fragment 1C) 
```

@beyerss 我认为我不能始终依赖 FragmentTransactions。如您所述，我可以在 Transaction 中添加多个片段，但 Activity 布局可能不一致。因此，我仍然看到对 ActivityGroups 的需求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:13:22.087

您是否有理由不能使用可以添加到后台堆栈的 FragmentTransaction？如果您在屏幕上有三个片段并且它们都同时更改，则这将需要三个 FragmentTransactions 但片段不会嵌套，因此它应该可以工作。

为了让每个选项卡都有自己的后台堆栈，您可能需要聪明地为每个选项卡自己管理它。即使用放在后堆栈上的每个 FragmentTransaction 的数组，如果用户切换选项卡删除所有存储的 FragmentTransactions（但仍然跟踪它们），那么当用户返回选项卡时将它们重新添加到后面以相同的顺序堆叠。

# windows-phone-7 - 代码重组和基本页面

> ID：11214202
> 
> 赞同：0
> 
> 时间：2012-06-26T18:58:49.167
> 
> 标签：windows-phone-7, silverlight-4.0, windows-phone-7.1, xna-4.0

我有一个 Windows Phone 7.5/Silverlight 应用程序。

我有一些代码在我的大多数页面上都在某种意义上重复。例如代码重复：

1： OnNavigatedTo - 我停止动画，清除 BackStack，添加事件处理程序（每个页面上的相同）等。

2：OnNaviateFrom - 我停止动画并将它们设置为空，删除事件处理程序，停止所有声音，处理声音效果和实例等。

3: OnInitializeComponent - 我设置了我的 SoundEffects

4：在图像上单击我播放 SoundEffects

那么最好的方法是什么，所以我不必在所有页面中复制代码？

我在想某种基类或页面？

任何想法都非常感谢。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:20:53.343

如果您在每个页面中执行相同的操作，那么基 Page 类就非常有意义。

```
public class MyPhoneApplicationPage : PhoneApplicationPage
{
    public MyPhoneApplicationPage()
    {
        this.Loaded += OnLoaded;
    }

    protected override void OnNavigatedFrom(System.Windows.Navigation.NavigationEventArgs e)
    {
        base.OnNavigatedFrom(e);
        // Do Stuff
    }

    protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
    {
        base.OnNavigatedTo(e);
        // Do Stuff
    }

    private void OnLoaded(object sender, RoutedEventArgs routedEventArgs)
    {
        //set up my SoundEffects
    }
} 
```

# c++ - 似乎无法忽略 Visual Studio 2010 中的库

> ID：11214209
> 
> 赞同：1
> 
> 时间：2012-06-26T18:59:16.843
> 
> 标签：c++, windows, visual-studio-2010, visual-studio-2008, visual-c++

我正在将一个项目从 VS2008 更新到 VS2010，我收到了这个错误：

> uafxcwd.lib(afxwinappex.obj) : 错误 LNK2005: "public: virtual struct CRuntimeClass * __thiscall CWinAppEx::GetRuntimeClass(void)const " (?GetRuntimeClass@CWinAppEx@@UBEPAUCRuntimeClass@@XZ) 已在 WinAppEx.obj 中定义

我已经尝试了我能想到的一切。uafxcwd.lib 位于链接器的“附加依赖项”和“忽略特定默认库”设置中。出于某种原因，它似乎没有忽略 uafxcwd.lib 库。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T23:38:57.263

我很久以前就遇到过这个问题，我找到了一个设置正确并且编译没有错误的项目。我也做了一些笔记，但我不记得我是如何（在哪里）得到解决方案的。

这里是：

您在 MFC 项目中使用 C 运行时库，并且库的链接顺序错误。CRT 和 MFC 库包含 CRT 使用弱外部链接的 new、delete 和 DLLMain。MFC 库中的所有函数都必须在 CRT 之前链接。

为了实现这一点，请执行以下操作：

在项目设置中，链接，输入，进入忽略库，添加Libcmtd.lib。这将从链接过程中排除 Libcmtd.lib。

既然你需要它，它就必须包括在内。您可以通过在 Additional Dependencies 框中添加库来强制它。但按以下顺序添加库：uafxcw.lib LIBCMT.lib。

如你所见，uafxcw.lib**在**LIBCMT.lib 之前。这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T18:08:02.810

修复。问题是 VS2010 中的 uafxcwd.lib 引入了一个新的类 cwinappex。这与我创建的类同名，导致冲突。

谁会想到呢？

# workflow - 管理员在 sitecore 工作流程中创建新项目

> ID：11214213
> 
> 赞同：0
> 
> 时间：2012-06-26T18:59:26.383
> 
> 标签：workflow, sitecore, sitecore-workflow

如果工作流已应用于一个特定的模板。管理员使用该模板创建新项目。在这种情况下，项目处于草稿状态，因为工作流的初始状态是草稿。

所以即使管理员已经创建了项目，它也必须通过工作流程......

有什么办法可以避免这种情况..我们需要将初始状态设置为非管理员用户的工作流程草稿。

请指教..谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T14:34:44.757

我们使用“跳过批准”解决方案，允许管理员通过选择设置 obj 来使用或绕过工作流。我们这样做是为了让每个人都可以从我们的蓝图模板中受益，但不需要使用工作流。对于我们的工作流程人员，他们必须遵守草案>aa（批准/拒绝）>批准，而绕过人员只需编辑，单击提交，他们的项目就可以一键获得批准和发布。点击[这里](https://stackoverflow.com/questions/8826467/how-to-programmatically-approve-a-content-item-in-sitecore/9929824#9929824 "绕过工作流程")查看。谢谢

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T20:08:12.977

使用管理员用户来创建项目、编辑内容等是一种非常糟糕的做法，您应该尽可能避免使用它。改为使用具有编辑所有内容的权限的角色。

关于这个问题 - 我建议以下选项：

*   创建工作流*操作*，检查项目是否由特定用户创建，并将其移动到最终状态。
*   或者（我更喜欢这个）创建一个工作流*命令*“快速发布而无需审查”并使其仅对特定用户可用。但项目仍将在草稿状态下创建。

# c# - t-sql 命令参数通配符

> ID：11214217
> 
> 赞同：0
> 
> 时间：2012-06-26T18:59:44.917
> 
> 标签：c#, tsql

我已经阅读了许多类似的问题，但答案根本不起作用。在 sql 中运行此函数`select * from HelloRow('o')`不返回任何行。运行`HelloRow('one')`返回名称为“one”的行。fillrow 方法不做任何事情（只是读取字符串）。

```
[Microsoft.SqlServer.Server.SqlFunction(FillRowMethodName = "HelloFillRow", DataAccess = DataAccessKind.Read, TableDefinition="message nchar(20)")]
public static IEnumerable HelloQuery(SqlString like)
{
    ArrayList resultCollection = new ArrayList();

    using (SqlConnection connection = new SqlConnection("context connection=true"))
    {
        connection.Open();

        using (SqlCommand select = new SqlCommand(
            "select name from test where name like @par"
            , connection))
        {
            select.Parameters.Add("par", SqlDbType.NChar, 10).Value = like + "%";
            using (SqlDataReader selectReader = select.ExecuteReader())
            {
                while (selectReader.Read())
                {
                    SqlString nextName = selectReader.GetString(0);
                    resultCollection.Add(nextName.ToString());
                }
            }
        }
    }
    return resultCollection;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T19:03:16.457

将命令文本更改为：

```
select name from test where name like @par + '%' 
```

并添加参数：

```
select.Parameters.Add("par", SqlDbType.NVarChar, 10).Value = like; 
```

# jquery - 一个 DIV 部分完全隐藏

> ID：11214233
> 
> 赞同：1
> 
> 时间：2012-06-26T19:00:56.040
> 
> 标签：jquery, html, css

我使用 jquery 添加了图像悬停效果：http: [//jsfiddle.net/roXon/HmTrw/](http://jsfiddle.net/roXon/HmTrw/)

我的网站： http: [//windows7themer.com](http://windows7themer.com)

之后，我无法看到您在此图像中看到的详细信息。

![无法查看详细信息](../Images/2e4f5e9d8ad2641adbb3b4ddb0f36b13.png)

现在，在我添加脚本之后，div 部分是这样的：

![在此处输入图像描述](../Images/fc7492e6d598f55975d0d3c1fb140e3e.png)

图片隐藏了标题、类别、作者和浏览量。虽然我可以在页面的源代码中看到它们。

有人可以帮我在 div 类下显示这些细节吗：mosaic-overlay

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:08:52.790

您在`opacity: 0`class 的元素上设置了几个不同的位置`mosaic-overlay`。为什么？如果你把它拿走，它工作得很好。

# gwt - 使用 GWT 为 Google Chrome 生成浏览器敏感代码

> ID：11214238
> 
> 赞同：3
> 
> 时间：2012-06-26T19:01:27.273
> 
> 标签：gwt, google-chrome, google-chrome-extension

我正在为 Google Chrome 扩展程序编写链接器。在 gwt.xml 文件中，我需要添加一行来说明用户代理属性。对于Firefox，模式如下：

```
<set-property name="user.agent" value="gecko1_8"/> 
```

但是，我无法为 Google Chrome 特定代码找到相应的*值名称。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:26:37.923

这[是支持的用户代理列表](http://code.google.com/p/google-web-toolkit/source/browse/trunk/user/src/com/google/gwt/useragent/UserAgent.gwt.xml)。令人困惑的是，chrome 的一个是“Safari”。（这可能是因为这两个浏览器都是基于 webkit 的，但我可能是错的。）

```
<set-property name="user.agent" value="safari"/> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T19:35:54.837

GWT 将 Chrome 和 Safari 视为相同，因此只有一个涵盖两者的“safari”代理值。所以你不能仅仅使用用户代理配置来做到这一点。

然而，GWT 的延迟绑定机制确实有一种方法可以让您通过创建“属性提供程序”来将代码定制为仅在运行时被嗅探的属性。这基本上就是您在 .gwt.xml 中执行此操作的方式：

```
 <define-property name="is.really.chrome" values="false,true"/>

  <property-provider name="is.really.chrome"><![CDATA[
      var ua = navigator.userAgent.toLowerCase();
      if (ua.indexOf("applewebkit") != -1) {
        if (ua.indexOf("chrome") != -1) {
          return true;
        } 
      } 
      return false;
  ]]></property-provider>

  <replace-with
      class="some.implementation.of.interface">
    <when-type-is class="some.interface.used.with.GWT.create"/>

    <when-property-is name="user.agent" value="safari"/>
    <when-property-is name="is.really.chrome" value="true"/>
  </replace-with> 
```

上面的部分所做的是定义一个新属性“is.really.chrome”，其值将由`<property-provider>`加载应用程序时块中的 Javascript 代码确定（此代码内联到 GWT 启动序列中。）

第二部分，`<replace-with>`说明如何定义对这个新属性的值敏感的替换规则。这（以及任何其他类似的规则）将导致 GWT 编译器创建代码的额外排列，该排列与 safari 版本基本相同，但具有您的 chrome 自定义。

这篇文章是我在这个主题上找到的最好的文章之一：http: [//css.dzone.com/news/understanding-gwt-compiler](http://css.dzone.com/news/understanding-gwt-compiler)

# python - 在 Python 中使用元组作为字典键有什么缺点吗？

> ID：11214241
> 
> 赞同：1
> 
> 时间：2012-06-26T19:01:34.947
> 
> 标签：python, dictionary

好像应该有...

现在，您可以将多维散列到同一个表中，而不会产生任何负面影响，这似乎是一种魔法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T19:06:21.163

从字典的角度来看，没有一件事是多维的。字典不知道您将键解释为描述 n 空间。

例如，你可以巧妙地将你的向量打包成一个看起来不那么神奇、更复杂但功能相同的字符串。就解释器而言，Python 字符串是另一个不可变序列。

没有负面影响。

有些任务的效率可能低于替代实现。例如，如果您使用坐标作为键，则相对于真正的多维存储`(x, y, z)`，在某些位置查找所有点将非常耗时。`z`但有时清晰、易于实施和阅读胜过高效存储。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:06:11.907

唯一的缺点是性能。更大的键意味着更长的哈希时间。

简而言之，python dict 中键的唯一要求是它们是不可变的和可散列的。对于元组（不可变），这意味着您只需要组合子对象的散列（它们本身必须是不可变和可散列的）。您也可以使用 freezeset 作为键。您不能使用列表、字典或集合作为键。

# java - Java：查找第一个正则表达式的索引

> ID：11214245
> 
> 赞同：9
> 
> 时间：2012-06-26T19:02:23.053
> 
> 标签：java, regex

我需要更改一段代码，其中包括：

```
string.indexOf("bc") 
```

如果它前面有字母“a”，那么如何通过跳过“bc”出现的解决方案来改变它。

我不想找到这些：

美国广播公司

但只有：

xbc

其中 x 可以是除了 a 之外的任何东西（甚至是空的）。

我想我可以设置一个条件来检查索引是否 i-1 == a，如果为真，则再次调用 indexOf 方法。但我认为这不会产生非常漂亮的代码。

使用正则表达式的解决方案会是什么样子？

编辑：在看到一些回复后只是一个提示。不仅可以获得正则表达式，还可以获得查找索引所需的 API 调用。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-26T19:39:11.373

根据要求提供更完整的解决方案：

```
 /** @return index of pattern in s or -1, if not found */
public static int indexOf(Pattern pattern, String s) {
    Matcher matcher = pattern.matcher(s);
    return matcher.find() ? matcher.start() : -1;
} 
```

称呼：

```
int index = indexOf(Pattern.compile("(?<!a)bc"), "abc xbc"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-26T19:05:58.003

您可以使用带有否定后视的正则[表达式](http://www.regular-expressions.info/lookaround.html)：

```
(?<!a)bc 
```

不幸的是，用 Java 中的 Regex 重现`.indexOf`仍然是一团糟：

```
Pattern pattern = Pattern.compile("(?!a)bc");
Matcher matcher = pattern.matcher("abc xbc");
if (matcher.find()) {
    return matcher.start();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:10:09.947

使用正则表达式查找与您的条件匹配的字符串，然后查找该字符串的索引。

```
int index = -1;
Pattern p = Pattern.compile("[^Aa]?bc");
Matcher m = p.matcher(string);
if (m.find()) {
    index = m.start();
} 
```

像这样的东西。其中“字符串”是您正在搜索的文本，“索引”保存找到的字符串的位置。（如果未找到，索引将为 -1。）还要注意，除非您设置标志，否则该模式区分大小写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-01T11:39:42.217

要添加到 Arne 的答案 - 如果您还想添加索引：

```
public static int indexOf(String regex, String s, int index)
{
    Pattern pattern = Pattern.compile(regex);
    Matcher matcher = pattern.matcher(s);
    return matcher.find(index) ? matcher.start() : -1;
} 
```

称呼：

```
int index = indexOf("(?<!a)bc", "abc xbc", 2); 
```

# java - 不要让 AdMob 广告请求焦点？

> ID：11214247
> 
> 赞同：1
> 
> 时间：2012-06-26T19:02:27.100
> 
> 标签：java, android, android-edittext, admob, ads

我在布局中有一个 EditText，并且在布局底部也有 AdMob 广告，当有人在 EditText 中输入内容时，假设键盘右上角有一个“完成”按钮，但在我添加之后AdMob 它有一个“下一步”按钮，当你按下它时，它会专注于广告！有没有办法禁用它？

我的 XML：

```
<com.google.ads.AdView android:id="@+id/adView"
        android:focusable="false"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        ads:adUnitId="XXXXXXXXXXX"
        ads:adSize="BANNER"
        ads:testDevices="XXXXXXXXXXX"/> 
```

我的爪哇：

```
 if (showAds == true) {
    AdView adView = (AdView)this.findViewById(R.id.adView);
    adView.loadAd(new AdRequest());
                         } 
```

注意：我不知道这是否重要，但我使用的是 ViewPager，因此 AdView 在我的 Main.xml 布局文件中，而 EditText 在我的 ViewPager 膨胀的布局上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T19:09:09.403

如果您想在 中保留“完成”按钮，请`EditText`向其中添加此属性：[`android:imeOptions="actionDone"`](http://developer.android.com/reference/android/widget/TextView.html#attr_android:imeActionLabel). 这将强制“完成”按钮出现在软键盘上。

如果您想保留“下一步”按钮，并让它跳过`AdView`，您可以使用[此方法](http://androidadvice.blogspot.ca/2010/10/soft-keyboard-next-button-not-working.html)`AdView`在点击“下一步”时跳过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-09T21:56:00.277

只需将此标签添加到您的根布局中。

```
android:descendantFocusability="blocksDescendants" 
```

前任。

```
<ScrollView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content">
    <LinearLayout
        android:descendantFocusability="blocksDescendants"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        .
        .
        .
        .
        </LinearLayout>
</ScrollView> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-29T12:33:01.793

这对我不起作用，在 editText 失去焦点 ACTION_DONE 被触发后，AdMob webView 获得焦点并保持焦点，除非用户触摸屏幕。要纠正此问题，请从当前焦点中移除焦点或关闭软键盘

```
etAddNote.setOnEditorActionListener(new TextView.OnEditorActionListener() {
        @Override
        public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
            if (actionId == EditorInfo.IME_ACTION_DONE) {           
                activity.getCurrentFocus().clearFocus();

                return true;
            }
            return false;
        }
    }); 
```

或关闭软键盘

```
etAddNote.setOnEditorActionListener(new TextView.OnEditorActionListener() {
        @Override
        public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
            if (actionId == EditorInfo.IME_ACTION_DONE) {
                View view = activity.getCurrentFocus();
                if (view != null) {
                    InputMethodManager imm = (InputMethodManager) activity
                            .getSystemService(Context.INPUT_METHOD_SERVICE);
                    imm.hideSoftInputFromWindow(view.getWindowToken(), 0);
                }
                return true;
            }
            return false;
        }
    }); 
```

# python - python从mysql获取用户并在linux上创建

> ID：11214249
> 
> 赞同：-1
> 
> 时间：2012-06-26T19:02:30.297
> 
> 标签：python, mysql, linux

我正在尝试在 mysql 中添加用户，然后使用 python 脚本在我的 Linux 系统上创建它们。

```
with dbcon:
    cur = dbcon.cursor()

    cur.execute("SELECT * FROM user")
    result = cur.fetchall()       

    c = csv.writer(open("users.csv","wb"))
    c.writerow(result)

if dbcon:
    dbcon.close() 
```

有了这个，我得到了一个丑陋的 csv 文件....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:09:38.197

好吧，首先-您没有将用户添加到mysql，而是从中读取它们并将其转储到csv文件中。你想要的是做一个 INSERT INTO .... 查询，然后运行一个 shell 命令来添加一个用户（阅读 useradd 命令手册了解详细信息）

# jquery - 如果使用相同名称选中特定复选框，如何禁用 td 中的复选框

> ID：11214252
> 
> 赞同：0
> 
> 时间：2012-06-26T19:02:41.760
> 
> 标签：jquery

```
<td align="left" valign="top" bgcolor="#FFFFFF"  class="rows" style="text-align:center;"><input  name="activeloyalty" type="checkbox" value="24"></td>
<td align="left" valign="top" bgcolor="#FFFFFF"  class="rows" style="text-align:center;"><input  name="activeloyalty" type="checkbox" value="24"></td>
<td align="left" valign="top" bgcolor="#FFFFFF"  class="rows" style="text-align:center;"><input  name="activeloyalty" type="checkbox" value="24"></td>
<td align="left" valign="top" bgcolor="#FFFFFF"  class="rows" style="text-align:center;"><input  name="activeloyalty" type="checkbox" value="24"></td>
<td align="left" valign="top" bgcolor="#FFFFFF"  class="rows" style="text-align:center;"><input  name="activeloyalty" type="checkbox" value="24"></td>
<td align="left" valign="top" bgcolor="#FFFFFF"  class="rows" style="text-align:center;"><input  name="activeloyalty" type="checkbox" value="24"></td>
<td align="left" valign="top" bgcolor="#FFFFFF"  class="rows" style="text-align:center;"><input  name="activeloyalty" type="checkbox" value="24"></td>

$("[name=activeloyalty]")live('click', function () {
if($("[name=activeloyalty]").is(':checked') ){//how to uncheck the rest checkbox

}
}); 
```

我在表格中有许多复选框，我的问题是当我选中一个特定的复选框时，如何禁用其余复选框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:05:48.777

像这样：

```
$("input[name=activeloyalty]").live('click', function () {
   if ($(this).is(':checked')) {
        $('input[name="activeloyalty"]').not(':checked').attr('disabled', true);
   }
   else {
        $('input[name="activeloyalty"]').attr('disabled', false);
   }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:08:50.263

```
$("input[name=activeloyalty]").change(function(){
    $("input[name=activeloyalty]").not(":checked").attr('disabled',true);
}); 
```

# javascript - 动态添加维度到交叉过滤器

> ID：11214254
> 
> 赞同：2
> 
> 时间：2012-06-26T19:02:50.097
> 
> 标签：javascript, jquery, d3.js, crossfilter

我有一个非常高维的数据集，并希望用户选择要过滤的维度（将它们添加到交叉过滤器中）。我了解无法删除尺寸。关于如何添加维度/过滤器有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T19:21:25.917

您只需使用字段名称作为维度函数中的变量。

我在我的应用程序中做这样的事情。x 是包含维度列名称数组的数据集的属性。

```
var volume = crossfilter(data.get("rows"));

_.each(data.get("x"), function(x, i) {
  new Chart.View({
    field: x,
    el: $(".chart").eq(i),
    model: volume.dimension(function(d) { return d[x]; })
  });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-22T11:04:58.683

crossfilter 现在有一个[dimension.dispose()](https://github.com/square/crossfilter/wiki/API-Reference#dimension_dispose)函数。

# coldfusion - cfwheels - 删除具有多级嵌套属性的记录

> ID：11214255
> 
> 赞同：1
> 
> 时间：2012-06-26T19:02:57.320
> 
> 标签：coldfusion, cfwheels

我有一个具有嵌套属性的模型，该模型具有更多嵌套属性。

假设`house`hasMany`pets`有很多`legs`

当只有一个级别时，它很容易工作，但是有两个级别时，我在删除 时遇到错误`pets`，因为 the`petsID`是腿表中的外键，而 cfwheels 不会先删除它。我知道我可以自己使用额外的命令进行删除，但我想知道是否有我错过的设置允许这种删除

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T11:36:21.810

您是否尝试`dependent`在关联定义上使用参数？

```
// In `House.cfc`
hasMany(name="pets", dependent="delete");

// In `Pet.cfc`
hasMany(name="legs", dependent="delete"); 
```

当您调用 时`house.delete()`，它应该删除所有关联的宠物，然后也会删除所有关联的腿。

请参阅[hasMany() 文档](http://cfwheels.org/docs/function/hasMany)和[关联章节的“依赖项”部分](http://cfwheels.org/docs/chapter/associations)。

# c# - 数据模型和服务模型之间的继承模式是什么？

> ID：11214256
> 
> 赞同：3
> 
> 时间：2012-06-26T19:03:15.003
> 
> 标签：c#, wcf, mongodb, data-access-layer, n-tier-architecture

我们的产品之一包含多个 WCF 服务，其业务层都位于同一数据访问层之上，该数据访问层提供对 NoSql 数据库 (mongodb) 的访问：

```
 WCF   WCF   WCF
   |     |     |
   BL    BL    BL
   |     |     |
 Data Access Layer        <-- PageInfoResult currently defined here
         |
      mongodb 
```

`PageInfoResult`因为每个服务都包含一个或多个方法，这些方法`PageInfoResult`要么接受或返回特定类型（（对于 WCF）。

例子：

```
[DataContract]
public class PageInfoResult
{
    [BsonId]
    [DataMember]
    public string PageUrl { get; set; }

    [BsonElement("status")]
    [DataMember]
    public int HttpStatusCode { get; set; }

    [BsonElement("score")]
    [DataMember]
    public int OurProprietaryPageScore { get; set; }

    [BsonElement("data")]
    [DataMember]
    public SomeOtherClass OtherData { get; set; }

    // ... other properties ...
} 
```

**所以具体的问题是：**

1.  每个 WCF 服务是否应该重新定义然后绘制到 DAL 的数据模型，或者 DAL 是否可以合法地成为定义模型的唯一位置？
2.  如果每个服务都应该重新定义 DAL 中的每个模型，那么服务模型是否应该从数据模型继承（*反之亦然*）？

**在更一般的意义上：**

1.  定义非常相似（或相同）的服务和数据模型的正确的、面向对象的方法是什么？
2.  在处理模式与无模式数据库（MsSql 与 MongoDB）时，方法是否存在差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:16:17.083

1.  数据模型和 WCF 合约是两个完全不同的东西。他们不应该是一样的！如果它们相同，则您的服务层与数据访问层的耦合过于紧密。

2.  我的意见是“不”。继承仍然意味着两者之间的紧密耦合。

最好根据您向客户公开的内容来考虑服务层。您的 WCF 数据合同应仅包含客户调用您的服务所需的信息。

服务层的数据合同和您所称的数据模型之间的“转换”应该可能发生在您的业务层中。更好的是，将您的业务层视为数据合约和数据模型的“消费者”或“用户”。

同样，这只是我的观点，但我认为最好将它们视为完全独立的。

编辑：（来自评论）有时我们会努力解耦并添加只会使解决方案架构复杂化的复杂性层。与我的回答相反，也许“保持简单”呢？如果是这种情况，则无需涉及继承，只要对您有用，就做您正在做的事情。

# c++ - 内联函数中 __LINE__ 的行为

> ID：11214260
> 
> 赞同：16
> 
> 时间：2012-06-26T19:03:33.337
> 
> 标签：c++, c, line, inline, c-preprocessor

我有一个将行号和文件名传递给错误处理程序的宏：

```
#define SYSTEM_FAILURE (error_code, comment) \
   System_Failure((error_code), (comment), __LINE__, __FILE__); 
```

`__LINE__`在内联函数中使用时如何解决？

```
file.h:
inline int divide(int x, int y)
{
    if (y == 0)
    {
        SYSTEM_FAILURE(ENUM_DIVIDE_BY_ZERO, "divide by zero error");
    }
    return x/y;
} 
```

将`__LINE__`包含头文件中的行号，或调用内联函数的源文件的行号（假设编译器在源代码中“粘贴”）？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-26T19:07:13.193

在 C 和 C++ 中，宏不（在大多数情况下）使用实际代码的任何知识进行评估，而是在代码之前处理（因此称为“预处理器”）。因此，`__FILE__`将评估为“file.h”，并将评估为与file.h 中出现`__LINE__`的行相对应的行号。`SYSTEM_FAILURE`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-26T19:06:29.930

由于宏在编译之前被它们的定义替换，因此`__LINE__`将包含您使用宏的文件的实际行。内联完全不会影响这种行为。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-26T19:06:52.717

`__LINE__`将是头文件的行，因为预处理器会在编译器看到它之前评估它。

# concurrency - 一个非常简单的分布式客户端/服务器示例？

> ID：11214262
> 
> 赞同：0
> 
> 时间：2012-06-26T19:03:50.977
> 
> 标签：concurrency

如果我有一个在服务器上完成的非常简单的服务，我将如何使该服务具有可扩展性，例如在多台服务器上运行？它在使用`register(mod,func,[args])`吗？

我在生成进程、创建节点和创建新服务器之间有点困惑。

您如何将客户端活动卸载到新服务器上以分散负载？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:35:52.370

生成进程可让您实现更大的粒度，从而有效地利用多核。它还使您有机会实现异步行为。

创建节点可让您将系统分布在许多主机上。节点可以互相看到并透明地通信。

如果服务器足够无状态，您只需创建几个服务器节点并负载平衡它们之间的流量。

如果服务器有一些繁重的计算，您可以使用几个服务器节点映射/减少它。

我不确定这个带有寄存器的代码片段是什么意思。通常您不会注册服务器端点，而是某种具有服务器节点、位置、负载知识的路由器。

“节点”和“进程”来自 Erlang 世界，但“服务器”是系统中的一个层。任何节点都可以设计为服务器，也可以生成客户端请求。进程在本地或远程节点上产生。进程可以执行/实现服务器或客户端逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T05:43:59.480

跟随这本完整[的 Erlang 在线免费书籍](http://learnyousomeerlang.com/content)，你会发现一切。您可以直接跳转到多处理、分发和客户端/服务器系统

# git - gitolite 在“狂野”存储库创建上运行挂钩

> ID：11214264
> 
> 赞同：4
> 
> 时间：2012-06-26T19:03:57.270
> 
> 标签：git, gitolite, cgit

当我的团队成员创建新存储库时，我需要运行一个脚本，该脚本将生成 projects.list 文件。

我们开发从“主”分支出来的固件，但这些分支永远不会合并回主控。由于永远不会合并，我决定为每个不同版本的固件创建存储库。我开发了一个 bash 脚本，它将为我创建 projects.list 文件。

```
find repositories/ -iname "*.git" -type d | grep --invert-match "gitolite-admin" | sed 's/repositories\///g' > /srv/git/projects.list 
```

现在我无法创建调用该脚本的钩子。

我曾尝试让 gitolite 为我生成文件，但没有运气。任何帮助表示赞赏。谢谢！

**回答**

在 config/gitolite.conf 我使 repo def 看起来像这样：

```
repo    Firmware/[a-zA-Z0-9].*/[a-zA-Z0-9].*
        C       =   @all
        RW+     =   @all
        R = gitweb
        config gitweb.owner = Repo Manager 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T15:42:38.843

正如[Gitolite “与外部工具的接口”](http://sitaramc.github.com/gitolite/external.html)中提到的，

> gitweb 可读的 repos 列表被写入一个文件，该文件的名称由`rc`file 变量给出`GITWEB_PROJECTS_LIST`。
> 如果未指定或为空，此变量的默认值为`$HOME/projects.list`。

因此，除非您让特殊用户可读您的存储库`gitweb`，否则 Gitolite 不会`$HOME/projects.list`为您生成/完成。

# android - Android 在 EditText 上写阿拉伯字符

> ID：11214265
> 
> 赞同：1
> 
> 时间：2012-06-26T19:04:03.973
> 
> 标签：android, android-emulator, arabic, android-2.2-froyo

我构建了一个Android应用程序，它允许用户回答问题，用户可以用阿拉伯语编写答案，但是android EditText不允许这样做，我使用的是android（2.2），我怎样才能允许用户编写阿拉伯语在编辑文本上？

### 编辑

我想要模拟器上的阿拉伯字符

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-26T19:18:37.847

看看这个网站。它解释了所有关于在你的应用程序中实现不同语言的能力。它涉及为您要支持的每个语言环境提供不同的字符串资源。

[http://developer.android.com/guide/topics/resources/localization.html](http://developer.android.com/guide/topics/resources/localization.html)

# perl - Perl 使用什么散列函数/算法？

> ID：11214270
> 
> 赞同：8
> 
> 时间：2012-06-26T19:04:46.253
> 
> 标签：perl, function, hash

您能否对 Perl 用于将字符串映射到索引的散列函数/算法有所了解？任何相关阅读？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-26T19:23:19.887

[*这个答案早于 5.28 中所做的散列函数更改。[请参阅5.28 的 perldelta](http://perldoc.perl.org/perl5280delta.html)中的“默认哈希函数更改” 。*]

`PERL_HASH_INTERNAL_`，在 中定义[`hv.h`](http://perl5.git.perl.org/perl.git/blob/HEAD:/hv.h)，复制如下：

```
/* hash a key */
/* FYI: This is the "One-at-a-Time" algorithm by Bob Jenkins
 * from requirements by Colin Plumb.
 * (http://burtleburtle.net/bob/hash/doobs.html) */
/* The use of a temporary pointer and the casting games
 * is needed to serve the dual purposes of
 * (a) the hashed data being interpreted as "unsigned char" (new since 5.8,
 *     a "char" can be either signed or unsigned, depending on the compiler)
 * (b) catering for old code that uses a "char"
 *
 * The "hash seed" feature was added in Perl 5.8.1 to perturb the results
 * to avoid "algorithmic complexity attacks".
 *
 * If USE_HASH_SEED is defined, hash randomisation is done by default
 * If USE_HASH_SEED_EXPLICIT is defined, hash randomisation is done
 * only if the environment variable PERL_HASH_SEED is set.
 * For maximal control, one can define PERL_HASH_SEED.
 * (see also perl.c:perl_parse()).
 */

#define PERL_HASH_INTERNAL_(hash,str,len,internal) \
    STMT_START { \
       register const char * const s_PeRlHaSh_tmp = str; \
       register const unsigned char *s_PeRlHaSh = (const unsigned char *)s_PeRlHaSh_tmp; \
       register I32 i_PeRlHaSh = len; \
       register U32 hash_PeRlHaSh = (internal ? PL_rehash_seed : PERL_HASH_SEED); \
       while (i_PeRlHaSh--) { \
           hash_PeRlHaSh += *s_PeRlHaSh++; \
           hash_PeRlHaSh += (hash_PeRlHaSh << 10); \
           hash_PeRlHaSh ^= (hash_PeRlHaSh >> 6); \
       } \
       hash_PeRlHaSh += (hash_PeRlHaSh << 3); \
       hash_PeRlHaSh ^= (hash_PeRlHaSh >> 11); \
       (hash) = (hash_PeRlHaSh + (hash_PeRlHaSh << 15)); \
   } STMT_END 
```

# visual-studio - 视觉工作室选择不是蓝色的

> ID：11214273
> 
> 赞同：0
> 
> 时间：2012-06-26T19:04:53.740
> 
> 标签：visual-studio, visual-studio-2005

今年夏天我正在使用 Visual Studio 2005 for c++，但我仍然不是很熟悉。

最初，当我选择某些内容时，所选文本的背景会变为蓝色，但现在它没有改变。

有人可以告诉我如何在再次选择文本时更改它以显示蓝色背景吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:18:25.863

我面前没有VS2005，但我很确定它是一样的：转到工具菜单，选择选项，然后环境下的字体和颜色。在中间的显示项目下，单击选定文本。然后，将项目背景设置更改为您喜欢的蓝色。

![在此处输入图像描述](../Images/4926b6a962c25f62779b56db4c8f06c1.png)

# asp.net - 我仍然在犹豫是否使用 ViewModels 而不是 View 的 Model

> ID：11214276
> 
> 赞同：5
> 
> 时间：2012-06-26T19:05:00.623
> 
> 标签：asp.net, asp.net-mvc, mvvm, viewmodel

无论我使用 Automapper 还是手动映射，都不起作用。

ReleaseViewModel 的所有数据都必须在 Release 中排在第一位，因为它是在数据访问层中填充的。我的模型 90% 都是这样的。为什么复制所有内容的开销？

KISS 原则和过度设计又如何呢？

当然，每个工具都适用于其适当的任务，但我经常读到在 asp.net mvc 中不使用 ViewModel 是不行的。

在哪里画线？当 ViewModel 与我的模型区分为 50%、75% 或 99% 时，我应该使用它们吗？

我有一个模型发布：

```
 public class Release
    {      
        public int Id { get; set; }       
        public string Name { get; set; }
        public string Author { get; set; }
        public DateTime CreatedAt { get; set; }
        public int FailedTestsCount { get; set; }
        public int SucceededTestsCount { get; set; }
        public int SumTestsCount
        {
            get
            {
                return SucceededTestsCount + FailedTestsCount;
            }
        }
        public int SumTestingTime { get; set; }
    } 
```

视图模型 ReleaseViewModel：

```
public class ReleaseViewModel
{
    [HiddenInput(DisplayValue = false)]
    public int Id { get; set; }

    [Required(ErrorMessage = "Name must not be empty.")]
    [StringLength(30, ErrorMessage = "Enter max. 30 chars for a name.")]
    [Remote("ReleaseExists", "Release", ErrorMessage = "This name already exists.")]
    public string Name { get; set; }    
    public string Author { get; set; }    
    public DateTime CreatedAt { get; set; }    
    public int FailedTestsCount { get; set; }    
    public int SucceededTestsCount { get; set; }    
    public int SumTestsCount 
    {
        get
        {
            return SucceededTestsCount + FailedTestsCount;
        }
    }

    public int SumTestingTime { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T19:34:54.627

`ViewModel`是用于**VIEW**的东西。大多数时候它类似于您的实体模型。但不总是。

看看你的例子。在您的`ViewModel`中，您有`Remote`Attribute 和一些 Validation 属性。因此，此远程名称检查是您添加的内容，旨在为您的用户提供更好的用户体验。它特定于视图。

您需要 Viewmodel 的另一种情况是涉及多个模型的屏幕。例如：您有一个`User`实体和一个`Project`实体，并且您想提供一个可以将项目添加到用户的屏幕。所以在这种情况下，您可以创建一个视图模型来处理它

```
public class ProjectToUserVM
{
  public int UserId { set;get;}
  public string UserName { set;get;}  // i want to display only name of user!
  public int ProjectID { set;get;}
  public IEnumerable<SelectListItem> Projects { set;get}
} 
```

不要对所有模型实体使用 ViewModel。当您的 VIEW 真正需要它时创建它。我有时在某些视图中直接使用我的模型实体对象而不创建视图模型，因为它们完全相同。例如：国家/州/城市（查找表格数据。无添加/编辑）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:39:50.743

> 为什么复制所有内容的开销？

首先，你可能认为*我在复制代码*，但事实是**你不是**，如果你这样做，你有一个严重的设计问题

我发现有一个原则，当你不遵守它时，它确实是万恶之源：SRP（单一责任原则）

可能是因为您还没有发现问题，或者您已经找到并且您刚刚修补了代码。**您的域对象的职责与将数据呈现给用户的职责完全不同。**

MVC 中的模型应该是一个类，代表**视图需要呈现的所有数据，仅此而已**。您需要使用您的域中的数据填充此模型。（或在 CQRS 架构中，来自您的查询服务）

如果您遵循 CQRS 架构（至少是基础，您不需要实现事件溯源，也不需要使用服务总线来将命令与查询分开），这对您来说会更清楚，查询对象的职责是与命令对象完全不同（来自您的域的操作）

我认为您误解了 KISS 原则，虽然它谈到过度设计您的代码或 YAGNI，但这并不意味着您必须**重用**应用程序中的所有内容

相信我，我学到了这个不好的方法 =(，唯一应该重用的代码是基础设施代码，在谈论域代码时，最好始终遵循 SRP

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:08:41.077

我的 ViewModel 只是简单地包装了一个模型，并在 90% 的时间里委托给它。只有当我需要针对特定​​视图用例更改模型行为时，它们才有自己的行为。拥有虚拟机确实可以更轻松地添加仅用于显示目的的行为，特别是如果该行为会干扰您的持久性模型（例如添加您*不*希望持久化的属性）。

还值得注意的是，很有可能使用 Castle 或 SpringFramework.net 等 IoC 工具即时生成默认转发行为，从而减少您需要手动编写的代码量。这相当显着地降低了“重复成本”，因此并没有最初看起来那么糟糕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T19:52:00.733

我支持 Shyju 所说的一切，尤其是关于“当你需要它的时候”的部分。

如果您有一个非常简单的项目，其中您的 EntityModel 类与您的 ViewModel 类在同一个库中，您可能不需要单独的 ViewModel dto 并且可以放弃它们。我不认为任何*聪明*的人会告诉你“你做错了，因为你在视图模型中使用实体类，笨蛋。” 我们不知道您的应用程序的上下文是什么。它可能完全适合您的情况。

我们中的一些人在非 Web 程序集中定义实体模型——只是一个编译成 DLL 的普通类库——用于更大的项目。在这种情况下，我们通常只需要对视图应用特殊属性，例如您的示例问题中的 RemoteAttribute 和 HiddenInputAttribute。然而，在不使用单独的 viewmodel dto 层的情况下执行此操作意味着我们必须将 System.Web.Mvc.dll 的引用添加到 EntityModel 库中，而事实上*该库与 web 没有任何关系*。

请记住，当您在 Web 项目中重用 EntityModel 类时（即，将它们用作存储模型和表示模型），您正在创建项目的 Web 方面和项目的业务方面之间更紧密的耦合。如果你能因为成本/预算、时间、目标受众、范围或其他限制来证明这一点，那就去做吧，不要理会你的批评者，因为他们没有像你一样看到全局。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T11:37:09.833

如果您的 Release 类实现了 INotifyPropertyChanged 以及视图所需的所有其他内容（验证、命令等），那么您不必使用视图模型。但如果不是...

# ios - URL 未在设备上打开但它在 Xcode 中打开

> ID：11214279
> 
> 赞同：0
> 
> 时间：2012-06-26T19:05:15.487
> 
> 标签：ios, nsurl

我有一个简单的 TabBar 应用程序，其中包含一个按钮。在模拟器中运行应用程序时，按下按钮会打开一个 URL。

编辑：该应用程序在 iPhone 和 iPad 模拟器（5.1 版）中运行。下载到 iPhone (iOS 5.1.1) 时也可以使用

但是当我在 iPad 上运行应用程序时——无论它是连接到 Xcode 还是独立的——URL 都不会打开。事实上，事件处理程序中设置的断点永远不会到达。

Xcode 4.4 版

iOS 5.1.1

似乎包含 URL 的按钮未连接到情节提要中的事件处理程序。然而我已经仔细检查了它。

欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T21:36:50.413

我发现了问题。我创建了一个清晰的按钮，我将它放在 UILabel 上。单击该按钮可打开 URL。但是，我没有为两个对象配置相同的 struts。因此，当我旋转设备时，按钮不再与 UILabel 对齐。因此，我可以按下 UILabel 但什么也不会发生。这在 iPhone 上不是问题，因为该应用程序不支持该设备上的旋转。感谢您的输入。

# wpf - 是否可以在 UserControl OnMouseLeftButtonDown 之前强制触发 WPF Thumb 事件？

> ID：11214288
> 
> 赞同：0
> 
> 时间：2012-06-26T19:05:45.983
> 
> 标签：wpf, user-controls

我在 WPF 中创建了一个 UserControl。此用户控件由一个边框、2 个拇指和一个环绕面板组成。

我按此顺序放置它们，以便 2 个拇指看起来是控件角落边框的一部分。我认为 Thumbs 是一种在我想要的任何方向上调整用户控件大小的简单方法。在大多数情况下，我是对的。

在我决定希望能够将整个控件拖到画布中的其他位置之前，它们工作得很好。

当我单击其中一个拇指时，OnMouseLeftButtonDown 在 Thum DragStarted 之前触发。关于如何完成这项工作的任何想法？我对 WPF 相当陌生，所以我对 UserControl 的过度设计可能不是最好的主意。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T16:23:28.017

我实在想不通，所以我在两个拇指上都添加了 MouseEnter 和 MouseLeave 事件。这些事件将 isResizing bool 设置为 false 或 true。然后使用该变量来确定用户是尝试重新调整大小还是尝试拖放。

谢谢！

# git - svn vs git shallow (sparse) checkout - 分支，提交

> ID：11214295
> 
> 赞同：2
> 
> 时间：2012-06-26T19:06:00.080
> 
> 标签：git, svn

我有一个非常大的 Web 项目，其中包含大量 pdf、图像、php 文件。我将文件作为单个项目导入 svn。我使用 svn shallow checkout 来检出子树的一部分，然后使用工作副本中的分支和标签等来节省空间并加快检出时间。

我想知道这是否可以使用 git。我读到 git 不允许您在进行稀疏结帐后提交或分支。对于较新的 git 版本，这仍然适用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:21:15.770

`Documentation/`使用以下命令，我能够从位于以下位置的 git 存储库中检出目录`git://github.com/git/git.git`：

```
git init
git remote add -f github-git git://github.com/git/git.git
git config core.sparsecheckout true
echo Documentation/ >> .git/info/sparse-checkout
git pull github-git master 
```

[git 文档](http://schacon.github.com/git/git-read-tree.html#_sparse_checkout)没有说明不能提交新的更改，所以听起来它应该可以正常工作。事实上，我对此进行了测试，并且可以确认在进行稀疏结帐后我能够提交新的更改。

*（我使用的是 git 版本 1.7.0.4）*

# azure - 是否可以在 Azure 存储 Blob 或容器上设置持久权限？

> ID：11214301
> 
> 赞同：0
> 
> 时间：2012-06-26T19:06:24.697
> 
> 标签：azure, permissions, azure-storage, azure-blob-storage

我使用 .NET 已经有一段时间了，但现在才刚刚过渡到 Azure。

作为我的第一个云项目的一部分，我有一个多用户文档场景。文档将存储为 BLOB，每个用户都需要访问自己的文档，但没有其他人的。此外，还有更高级别的组（管理员）可以访问所有文档。所有用户都将通过身份验证。

我的问题是：有没有办法将允许的用户列表直接附加到 BLOB，或者我是否需要将其存储在其他地方（在表存储或数据库中）？我找到了大量关于如何通过共享访问签名授予临时客户端访问权限的文档，但没有找到更永久的“文件”权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:19:44.147

如果要对 blob 提供访问控制，最好的选择是使用 ACS 和 DB。您可以为特定用户提供文件访问权限并将这些访问权限保存到数据库中。这可以用作您请求的持久许可。

您可以看看 BlobShare Sample 是一个简单的文件共享应用程序，它演示了 Windows Azure 平台的存储服务，以及访问控制服务 (ACS) 的身份验证和授权功能。

[http://blobshare.codeplex.com/](http://blobshare.codeplex.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T22:39:41.637

Blob 没有内置的每用户访问控制。使用私有 blob 时，blob 存储 API 服务只有一种安全机制：帐户密钥（主密钥或辅助密钥的工作方式相同）。共享访问签名实际上只是通过 URL 提供临时访问的一种方式。如果您在 Web 或业务层中执行所有用户级授权，则该层可以直接访问 blob 并将其直接返回给用户（通过 IIS、tomcat、Web 服务或您选择的任何其他机制）。

由于 Windows Azure 存储没有 ACS 机制，因此您需要使用类似于您在应用程序中用于任何其他用户级访问的方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T09:53:52.473

您可以利用共享访问签名。有关共享访问签名的更多详细信息，请访问

[http://msdn.microsoft.com/en-us/library/windowsazure/ee395415.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/ee395415.aspx) 问候，维杰。

# .htaccess - mod_rewrite 配置为 /

> ID：11214303
> 
> 赞同：1
> 
> 时间：2012-06-26T19:06:27.007
> 
> 标签：.htaccess, mod-rewrite

我有以下`.htaccess`配置

```
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} ^example.com [NC]
RewriteRule ^(.*)$ http://www.example.com/$1 [L,R=301]
RewriteRule \.git - [F,L]

RewriteRule ^help help.php [L]
RewriteRule ^home home.php [L]
RewriteRule ^profile profile.php [L]
RewriteRule ^index index.php [L]

RewriteRule ^users/([0-9]+) profile.php?id=$1 [L]

RewriteRule ^([A-Za-z0-9-]+)?$ profile.php?u=$1 [L] 
```

现在，每当有人访问登录页面时，他们都会使用最后一条规则进行重定向`profile.php?u=$1`。

如何更改配置以便映射到 index.php`www.example.com`而`www.example.com/`不是 profile.php？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:09:45.527

匹配规则后的空字符串或单斜杠`^index`：

```
RewriteRule ^help help.php [L]
RewriteRule ^home home.php [L]
RewriteRule ^profile profile.php [L]
RewriteRule ^index index.php [L]
# Match root request with optional slash
RewriteRule ^/?$ index.php [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:26:34.937

我会建议不要这样做。

相反，只需使用这个

```
<IfModule mod_rewrite.c> 
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule> 
```

这会将您的所有请求发送到 index.php 页面，从那里创建一个 router.php 并使用 php 将请求传递到该页面。

但如果你这样做，只需添加

```
 RewriteRule ^/?$ index.php [L] 
```

就像迈克尔建议的那样。

如果您愿意，这是一个测试规则的简单工具

[Apache RewriteRule 测试器](http://martinmelin.se/rewrite-rule-tester/)

# sql - 如何在 SQL Server 中按 YEAR-MM 对 DATE 字段进行分组？

> ID：11214305
> 
> 赞同：2
> 
> 时间：2012-06-26T19:06:47.567
> 
> 标签：sql, sql-server, tsql, group-by, sql-date-functions

我在查询中有一个日期字段，我确实想得到这样的 GROUP BY 报告：

```
DATE    COUNT
2010-01  10
2010-02  2
...
2010-12  24
2012-13  34 
```

在 SQL Server 上获取此信息的正确语法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T19:30:43.307

所有这些到字符串的转换都有效，但我发现这种方法更有效，尽管可读性较差：

```
SELECT m = DATEADD(MONTH, DATEDIFF(MONTH, 0, [DATE]), 0), COUNT(*)
  FROM dbo.TheTable
  GROUP BY DATEADD(MONTH, DATEDIFF(MONTH, 0, [DATE]), 0); 
```

如果您不想重复表达式，则：

```
;WITH x AS (SELECT m = DATEADD(MONTH, DATEDIFF(MONTH, 0, [DATE]), 0)
  FROM dbo.TheTable)
SELECT m, COUNT(*)
  FROM x GROUP BY m; 
```

这样，输出仍然是日期/时间值，并且可以以这种方式用于其他事情。而且它不涉及任何混乱的字符串转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:25:19.293

你可以简单地做：

```
select convert(char(7), @myDate, 20) 
```

**例子**

```
declare @myDate as DateTime
set @myDate = '2012-06-23'
select convert(char(7), @myDate, 20) 
```

**输出**

```
-------
2012-06 
```

所以完整的声明看起来像：

```
select convert(char(7), myDate, 20), count(*) as Count
from MyTable
group by convert(char(7), myDate, 20) 
```

**更新**

样本数据包括 value `2012-13`。我假设这是一个错字，破折号后面的数字代表月份。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T19:27:23.803

```
 CONVERT(VARCHAR(7), CreationDate, 120) as Date 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-06-26T19:10:04.483

```
SELECT CAST(DATEPART(year, dateCol) as VARCHAR) + '-' + CAST(DATEPART(month, dateCol) as VARCHAR) as Date, count(*) As Count
FROM myTable
GROUP BY CAST(DATEPART(year, dateCol) as VARCHAR) + '-' + CAST(DATEPART(month, dateCol) as VARCHAR) 
```

# templates - 我可以在 Tridion GUI 中插入组件模板链接吗？

> ID：11214306
> 
> 赞同：2
> 
> 时间：2012-06-26T19:06:47.833
> 
> 标签：templates, schema, tridion

在 Tridion 中，类似于架构或元数据架构中的字段可以是文本、嵌入式架构或组件链接......有没有办法让字段像组件链接一样成为项目选择，但选择不同的类型Tridion 对象而不是组件？

我希望用户能够通过界面选择复合组件模板或页面对象，而不是在文本字段中输入 tcm 并读取该值。

这可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T19:27:05.067

不可以。到组件模板的链接不由 Tridion GUI 处理。在某些情况下，Tridion Content Manager 后端可以处理指向组件模板的链接，这就是为什么（例如）您可以在页面的 WhereUsed 对话框中看到组件模板的原因。

大多数人最终使用常规文本字段来保存这样的组件模板链接，然后使用[Bart 的项目选择器之](http://www.sdltridionworld.com/community/2011_extensions/itemselector.aspx)类的东西来提供输入帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T15:14:56.807

您必须小心创建指向组件以外的其他类型的链接，因为它们可能无法进行内容移植，并且在将这些字段从一个环境移植到另一个环境后会遇到问题。

基本上，内容搬运工不会解析 tcm uris。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-26T19:22:00.000

这必须通过构建自定义 CME (GUI) 扩展来实现。

# css - 将一个 div 居中在另一个 div 的底部

> ID：11214310
> 
> 赞同：1
> 
> 时间：2012-06-26T19:07:10.797
> 
> 标签：css, html

我想知道如何放置一个 div 框（我想在其中放置图像），以便它出现在中心底部的另一个 div 的顶部。

![在此处输入图像描述](../Images/701c4e07511da72551c83c26c804c51d.png)

我正在尝试以下代码：

```
<html>
<body>
<style type="text/css">
.outer {
    width: 350px;
    height: 350px;
}

.inner {
  width: 100px;
  height: 100px;
  background-color: red;
}
</style>
<div class="outer">
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum pellentesque, neque ut ultrices posuere, velit arcu aliquam dui, id rutrum justo leo nec purus. Donec aliquet justo a est iaculis id porta nulla pulvinar. Proin quis turpis vitae augue volutpat volutpat. Donec volutpat accumsan urna, id vulputate augue euismod eu. In vitae libero tortor. Integer lacinia, turpis vel egestas ornare, nisi libero tempus orci, non imperdiet erat nulla malesuada lectus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae;
   <div class="inner"></div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T19:16:09.047

内部 div 上的绝对定位和自动边距的组合将起作用。您还需要为外部 div 设置相对位置

```
.outer {
  width: 350px;
  height: 350px;
  position: relative;
  border: 1px solid black;
}

.inner {
  width: 100px;
  height: 100px;
  background-color: red;
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0; /* both left AND right must be set to 0 */
  margin: 0 auto;
}​ 
```

[**jsFiddle 演示**](http://jsfiddle.net/jackwanders/7KbYR/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:17:07.897

尝试这样的事情：[jsfiddle](http://jsfiddle.net/zyL2m/)

它将帮助您根据需要放置 div。

```
.outer {
    width: 350px;
    height: 350px;
    position: relative;
    background-color: yellow;
}

.inner {
  width: 100px;
  height: 100px;
  background-color: red;
  position: absolute;
  bottom: 0;
  left: 50%;
  margin-left: -50px;
} 
```

为清楚起见，我在外部 div 中添加了背景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:13:30.647

```
.outer {
    width: 350px;
    height: 350px;
    position:relative;
    border: 1px #bbb solid;
}

.inner {
  width: 100px;
  height: 100px;
  background-color: red;
    position:absolute;
    left: 130px;
    bottom:0;
} 
```

[演示](http://jsbin.com/oyimom/edit#html,live)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T19:32:45.353

```
#outer {
    width: 350px;
    height: 350px;
    position: relative;
    z-index: 1;
}

#inner {
    position: absolute;
    width: 100px;
    height: 100px;
    background-color: red;
    bottom: 0px;
    left: 110px;
    z-index: 2;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T19:09:19.470

如果你有两个 div 的确切坐标，这真的很容易。

在你的例子中，简单地说

```
position: relative;
top: 250px;
left: 125px; 
```

或类似的东西，它会做的伎俩。

# python - Python 问题 - 地图和类 - 初学者

> ID：11214315
> 
> 赞同：1
> 
> 时间：2012-06-26T19:07:25.173
> 
> 标签：python, class, map, python-2.7

我正在尝试使用 Map 来引用类函数，但在格式化/排序方面遇到了困难。我听说使用 map 有点过时了，所以我绝对愿意接受替代解决方案（for loops？）在此先感谢。

```
lognames =  [ "C:\Users\makker1\Desktop\logs\loga.txt",
              "C:\Users\makker1\Desktop\logs\logb.txt",
              "C:\Users\makker1\Desktop\logs\logc.txt" ]

class LogFile:
    def __init__(self,filepath):
        self.logfile = open(filepath, "r")
        self.head = None

    def __str__(self):
        return "x=" + str(self.x) + "y="+str(self.y)

    def readline (self):
        if self.head != None:
            self.head = self.logfile.readline()

    def previewline (self):
        if self.head == None:
            self.head = self.logfile.readline()

    def close (self):
        self.logfile.close()

logs = map(LogFile(self,filepath).__init__(), lognames)
heads = map(lambda log: None, logs)

>>> 
Traceback (most recent call last):
  File "C:\Users\makker1\Desktop\mergesort-final.py", line 30, in <module>
    logs = map(LogFile(self,filepath).__init__, lognames)
NameError: name 'self' is not defined
>>> 
```

如果需要更多信息，请告诉我。我意识到有很多关于这个问题的帖子，并且已经对其中的许多帖子进行了整理，但无济于事。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T19:20:58.817

这是一个列表理解答案。我喜欢这个比`map()`。

```
logs = [LogFile(fname) for fname in lognames] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:14:12.497

您不必`__init__`显式调用。尝试：

```
logs = map(LogFile, lognames) 
```

有时将类视为*可调用*的会有所帮助。您可以将类视为如下所示：

```
def LogFile(filepath):
    class _LogFile:
        def __init__(self, path):
            ...
    return _LogFile(filepath) 
```

基本上，一个类可以被认为是你调用来创建一个对象实例的东西。这不是真的，但在许多情况下似乎是这样。

# java - Java 矩阵库中的问题

> ID：11214317
> 
> 赞同：0
> 
> 时间：2012-06-26T19:07:55.087
> 
> 标签：java, matrix, svd, jama

我正在从事一个需要为 74000 X 640 维度的矩阵获取 SVD（单值分解）的项目。我尝试了这三个库：Jama、高效的 Java Matrix 库 (EJML) 和 OjAlgo。我根据 SVD 中的 Java Matrix 基准内存结果选择这三个库。起初我使用 Jama，但后来我发现行数必须 >= 列数，我需要在另一个步骤中获取任何矩阵维度的 SVD。所以，我搬到了 EJML 和 OjAlgo，但我对 EJML 有一些疑问/问题：

EJML--> 它为 SVD 提供了正确的结果，但是当我将矩阵大小扩大到 74000 X 640 维度时，它给了我堆内存异常，那么库的矩阵大小是否有限制？

这是我用于创建矩阵的代码：

```
 SimpleMatrix A = new SimpleMatrix(74000, 640); 
```

请帮助我理解并解决我的问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:12:03.680

JVM 堆的大小是多少？假设双精度数字，密集排列，您的 74000 X 640 矩阵将占用大约 361Mb 的 RAM。我想计算 SVD 的工作记忆至少又是这样。所以很可能库中没有内存限制，只是你使用了很多，而 JVM 没有足够的堆空间来运行你的计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T04:48:05.900

抱歉，我通过添加一行代码（函数计算）来解决 OjAlgo 的问题，现在代码如下所示：

```
MatrixFactory<?> tmpFactory = PrimitiveMatrix.FACTORY;
double[][] tmpData = new double[][] {{1,2,3,4,5},{11,12,18,19,25},{89,75,14,21,26},{33,24,47,15,49}};
BasicMatrix tmpH = tmpFactory.rows(tmpData);
Access2D<Double> j = (Access2D<Double>)tmpH;
SingularValue f = SingularValueDecomposition.make(j);
f.compute(j); 
```

谢谢..

# bash - diff -r：限制递归？

> ID：11214318
> 
> 赞同：3
> 
> 时间：2012-06-26T19:08:06.523
> 
> 标签：bash, shell, filesystems, diff, posix

有没有办法指定递归差异的最大递归级别`diff -r`（比较两个目录）？

我想要做的是比较 github 上的两个项目（一个是从另一个分支出来的）。我现在怀疑其中一个分支中可能有一个链接到另一个的远程分支，这将让我从 diff 进行比较`git`，但是这个问题通常仍然适用于文件系统。

编辑更新：这个答案解决了我可能如何`git`帮助我进行比较：[https ://stackoverflow.com/a/5162839/340947](https://stackoverflow.com/a/5162839/340947)

发生的事情是我已经克隆了两个 repos 并且我正在打电话`diff -r repoA repoB`，它报告了`.git/`目录中的差异，这是可以预料的，但我对这些目录中的差异不感兴趣。

在这种情况下，最好只显示目录中第一级文件之间的差异，因为这个特定项目没有子目录。如果有人有关于如何比较两个目录同时排除特定文件夹（`.git/`在我的情况下是目录）的提示，那也很棒！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T19:22:47.827

1.  我不知道有任何限制递归深度的方法`diff -r`。

2.  `-x PAT`您可以使用或排除与模式匹配的文件`--exclude=PAT`。所以

    ```
    diff -r -x .git repoA repoB 
    ```

    *如果您确实*想要递归，那将很有用。

3.  在您的情况下，只需省略，`-r`因为您不希望它递归。

    ```
    diff repoA repoB 
    ```

    已经做了你想要的。

# perl - 使用 Perl，在 MSWin32 上 Win32API::File::MoveFile 和 CORE::rename 之间有区别吗？

> ID：11214319
> 
> 赞同：5
> 
> 时间：2012-06-26T19:08:11.390
> 
> 标签：perl, winapi, file-rename, strawberry-perl

我看到[Win32API::File](https://metacpan.org/module/Win32API%3a%3aFile)支持`MoveFile()`. 但是，我不确定如何`CORE::rename()`以一种重要的方式实施。有人可以并列区别 - 特别是对于 Win32 环境 - 之间

*   `CORE::rename()`
*   `File::Copy::move()`
*   和，`Win32API::File::MoveFile()`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:37:33.947

`rename`[自永远以来](http://perldoc.perl.org/5.14.0/perltodo.html#Unicode-in-Filenames)以一种破碎的方式实施；`move`也是，因为[它使用`rename`](https://metacpan.org/source/RJBS/perl-5.16.0/lib/File/Copy.pm#L375).

[Win32::Unicode::File](http://p3rl.org/Win32::Unicode::File)`MoveFileW`从`windows.h`as公开`moveW`，并且显然以理智的方式处理编码，而 Win32API::File 将现有示例代码中的用户 AFAICS 留给用户。

相关：[如何在 Windows 上的 Perl 中将具有 UTF-8 文件名的文件复制到另一个 UTF-8 文件名？](https://stackoverflow.com/questions/2304319/how-do-i-copy-a-file-with-a-utf-8-filename-to-another-utf-8-filename-in-perl-on)

# javascript - 有没有办法在浏览器中停止 HTTP AJAX 调用，以便另一个可以继续？

> ID：11214322
> 
> 赞同：1
> 
> 时间：2012-06-26T19:08:34.730
> 
> 标签：javascript, ajax, http

我正在开发一个大量使用 AJAX 功能的应用程序。我目前正在处理一个页面，其中有大量的 ajax 调用来呈现初始页面。所有这些调用都通过同一个 AJAX 脚本进行路由，因此它们必须由浏览器一次调用。（是的，这有点低效）

我有一个加载另一个页面的事件，但不幸的是它需要进行 ajax 调用才能重新呈现页面。这样做的结果是，如果用户在页面第一次加载时点击了该链接，浏览器会等待所有其他 ajax 调用，然后再根据用户点击引发的事件重新渲染页面。这导致在页面加载时单击指向页面的链接时页面的加载时间明显变慢。

我的问题是：**有没有办法使用 Javascript 或其他方法让 Web 浏览器取消对 Web 脚本的 http 调用，以便另一个事件可以调用同一个脚本？**我知道每次调用不同的脚本会很好，这样它们就可以同时发生，但不幸的是，我正在处理的应用程序通过一个中央脚本汇集所有 ajax 请求，而且这不会很快改变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T20:17:31.150

使用 XMLHttpRequest 对象上的[`abort()`方法](http://www.w3.org/TR/XMLHttpRequest/#the-abort-method)来取消任何正在进行的请求并将对象返回到可重用状态。

您可以将它包装在一个辅助对象中，例如：

```
function HttpQueue(uri) {
    var queue= [];
    var xhr= new XMLHttpRequest();
    xhr.onreadystatechange= function() {
        if (xhr.readyState===4 && queue.length>=1) {
            queue.unshift()[1](xhr);
            if (queue.length>=1)
                next();
        }
    };
    this.send= function (data, callback, isurgent) {
        if (isurgent && queue.length>=1) {
            queue.length= 0;
            xhr.abort();
        }
        queue.push([data, callback]);
        if (queue.length==1)
            next();
    };
    function next() {
        xhr.open('POST', uri, true);
        xhr.send(queue[0][0]);
    }
}

var queue= new HttpQueue('/script');

queue.send('action=foo', function() {
    alert('task 1 done');
}, false);

queue.send('action=bar', function() {
    alert('task 2 done');
}, false);

queue.send('action=bof', function() {
    alert('task 3 is urgent! tasks 1 and 2 can get knotted');
}, true); 
```

（未经测试，可能有效）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:13:50.153

您可以使用 jQuery $.ajax 方法。

此时，您将为每个调用指定超时，然后将 aSync 设置设置为 false。这样你一次只能运行一个 ajax 请求。

文档可以在这里找到：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# twitter-bootstrap - 如何覆盖 twitter 引导工具提示？

> ID：11214324
> 
> 赞同：14
> 
> 时间：2012-06-26T19:08:39.950
> 
> 标签：twitter-bootstrap, tooltip

我正在使用 Twitter Bootstrap 包中的工具提示在页面上显示项目信息。有时信息会发生变化，需要在工具提示中更新。我试图简单地用新标题重新初始化工具提示：

```
$('#selector').tooltip({ title: 'new text'}); 
```

但是，工具提示的标题不会随新文本而改变。它与最初设置的一样。任何想法为什么，有什么解决方法吗？谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-26T19:32:52.900

一旦你在一个元素上初始化了工具提示对象，你就不能覆盖它。但是你可以删除它然后再做一次。

尝试删除，然后使用所有选项（如果有的话）重新初始化工具提示。

```
$('#selector').data('bs.tooltip',false)          // Delete the tooltip
              .tooltip({ title: 'new text'}); 
```

可能需要删除侦听器，但它是这样工作的。

* * *

在 TWBS v3 之前，您不需要`bs`命名空间：`data('tooltip')`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-06-12T12:50:28.413

这种技术对我不起作用，所以我找到了一个答案，隐藏在一个[类似问题的评论中](https://stackoverflow.com/a/9875490/1478467)。

更新工具提示显示文本的最简洁方法

`$(element).attr('title', 'NEW_TITLE').tooltip('fixTitle').tooltip('show');`

感谢[lukmdo](https://stackoverflow.com/users/212278/lukmdo)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-10-12T01:33:40.107

我使用 bootstrap 3，没有错误，这些都对我有用。通过销毁工具提示`.tooltip('destroy')`并在同一函数中重新创建它`.tooltip({...})`会导致工具提示不再工作。它仅在稍后完成重新调用时才有效，在销毁调用完成后异步工作（因此立即重新创建被破坏了）。

销毁内部数据的建议`.data('tooltip',false)`没有奏效。首先，使用 bootstrap 3，`data('bs.tooltip, false)`当它被调用时，如果当前显示工具提示，它会泄漏它并使其永久显示。新的工具提示将显示和隐藏在它上面。

我的最终解决方案是：

```
$x.tooltip('hide');
$x.data('bs.tooltip', false);
$x.tooltip({ ... }) // recreate it 
```

请注意，通过`.attr('title', '...')`类似的解决方案和调用也可以更改标题`.tooltip('fixupTitle')`- 但丢弃了该`placement`选项以及可能还有其他选项，并制作了一个工具提示，该工具提示放置在元素顶部而不是像原来那样放在右侧。它甚至可能有上面列出的一些其他错误，在这个解决方案的其他变体中可以看到，但我没有进一步研究。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-17T08:02:57.077

出于某种原因，这对我不起作用（引导程序 2.1.1）。我必须做的是：

```
 $('#element').tooltip('destroy');
    $("#element").tooltip({'placement':'right', 'title':'larger larger text title'});
    $("#element").tooltip('show'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-04T07:49:44.747

@Sherbrow您可以使用最简单的。不需要这个复杂的解决方案。这是示例代码。

```
$('#spanUsername').prop('title', newValue); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-03T20:23:16.943

这适用于引导程序 3，高于此线程中给出的所有其他解决方案：

```
$('#tooltip_selector').attr('data-original-title', 'New Title Here'); 
```

# onclick - 点击更改背景图片？

> ID：11214326
> 
> 赞同：0
> 
> 时间：2012-06-26T19:08:41.863
> 
> 标签：onclick

我非常困惑，我一直在尝试这样做一段时间。这只是一个简单的 tumblr 主题。我试图让观众可以点击一个链接，当它被点击时，页面的背景图像会切换。这是页面，eiramanaik.tumblr.com 显示背景图片，点击后，我希望它变成这样：http: [//i50.tinypic.com/23lz49h.jpg](http://i50.tinypic.com/23lz49h.jpg)

我浏览了所有内容，即使我理解编码，我也不明白如何应用它，因为我对 html 很陌生。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:26:08.737

如果你想使用 jquery 是：（首先你必须将 id 作为 id="link" 放入你的链接）

```
<script type="text/javascript"
 src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

<script type="text/javascript">
 $(document).ready(function(){
$('#link').click(function(){
$('#id_background').attr('src','23lz49h.jpg');
});
});

</script> 
```

# routes - 为什么这条简单的路线行不通？

> ID：11214327
> 
> 赞同：1
> 
> 时间：2012-06-26T19:08:44.220
> 
> 标签：routes, playframework-2.0

[播放教程](http://www.playframework.org/documentation/2.0.1/JavaRouting)展示了一种将动态参数绑定到 URL 的方法：

`GET /clients/:id controllers.Clients.show(id: Long)`

我想在我的应用程序中做同样的事情。但是当我写信`GET /Category/getAttributes/:id controllers.Category.getAttributes(id)`并去时，`http://localhost:9000/Category/getAttributes?id=4fce5fc51712ccf77afa7439`我收到`Action not found`下面列出的路线错误。有合适的路线。

问题是：我错过了什么？我的 PLAY 应用程序中的路由适用于其他请求，这是唯一一个具有动态参数的请求。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T19:14:36.443

使用`String`类型，我怀疑是否`4fce5fc51712ccf77afa7439`可以被视为`Long`：

```
GET /clients/:id    controllers.Clients.show(id: String) 
```

当然不要忘记修复`id`控制器和模型中的类型

**编辑**：Ech，我错过了第二个重要的变化，这条路线的 URL 应该没有`?id=`：

```
http://localhost:9000/Category/getAttributes/4fce5fc51712ccf77afa7439 
```

# erlang - 是什么让 Erlang 不适合计算量大的工作？

> ID：11214336
> 
> 赞同：13
> 
> 时间：2012-06-26T19:09:10.640
> 
> 标签：erlang

在 Programming Erlang 的开头，有以下内容：

> 是什么让 Erlang 成为您项目的最佳选择？这取决于您要构建的内容。如果您正在考虑编写数字运算应用程序、图形密集型系统或在手机上运行的客户端软件，那么抱歉，您买错书了。

隐含的信息是 Erlang 不适合计算昂贵的工作。是什么让 Erlang 如此不合适，或者我误解了？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-28T19:45:33.453

Erlang 适用于 I/O-bound 应用程序，即限制因素是 I/O 操作的延迟和吞吐量而不是指令可以通过 CPU 管道推送的速率的问题。Web 服务器和数据库是 I/O 密集型应用程序的好例子：限制因素可能是磁盘和网络，而不是 CPU。传统上“计算量大”的应用程序包括密码工具和科学模拟。

至于为什么 Erlang 在计算密集型问题上无法匹配 C 和 Fortran 等语言，我们必须考虑代码生成和缓存友好性等问题......我会尝试一下：

*   **代码生成**：通常当你启动一个 Erlang 程序时，它会在基于[线程代码的](http://en.wikipedia.org/wiki/Threaded_code)[虚拟机](http://en.wikipedia.org/wiki/Virtual_machine)BEAM 中运行。尽管 BEAM 对于大多数用途而言都表现得足够好，但与现代优化 C 编译器生成的那种代码相比，它的每个逻辑“指令”的开销要大得多。HiPE 项目为 Erlang 提供了本机代码编译器，该编译器在几年前已集成到主 OTP 源代码树中*。虽然它确实提高了 Erlang 的数字运算能力，但它仍然很难与编写良好的 C 或 Fortran 程序相匹敌。
*   **缓存友好性**：内存系统是现代计算机的主要瓶颈：从主内存读取可能需要数百个处理器周期！为了解决这个问题，CPU 设计人员引入了多级缓存来隐藏内存延迟。缓存利用计算机程序的两个关键属性：*时间*和*空间*局部性——也就是说，最近被引用的内存区域（和附近的区域）可能会再次被引用。像 C 和 Fortran 这样的语言对内存分配的位置和方式提供了很大的控制，使程序员能够调整算法以很好地使用缓存。对于像 Erlang 这样的动态语言，通常情况并非如此，其中内存分配对程序员隐藏，并由虚拟机自动处理。
*   **代码大小**：关于空间局部性的论点也适用于代码；Erlang 代码，无论是原生还是字节码形式，通常都会比相应的编译 C 代码大。这导致指令高速缓存中更频繁的未命中。

请记住，这只是冰山一角，我绝不是 Erlang 或语言实现方面的专家。不过，不要让 Erlang 可能永远不会运行科学模拟的事实吓到你；对于许多应用程序来说，它是一种绝对出色的语言。

*HiPE 可通过 Debian 中的 erlang-base-hipe 软件包或`./configure --enable-hipe`源代码 tarball 获得。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-26T19:11:49.277

只是 C 代码在大多数情况下可能会相当快。Erlang 擅长容错、分布式计算和并发。程序员往往同样精通编写 erlang 或其他语言，但如果您想要速度，请使用 C 或 C++，可能来自 erlang 端口，因此可以在您自己的 erlang 应用程序中使用此代码。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-26T19:13:28.903

Erlang 是一种并发函数式编程语言，专为大型工业实时系统编程而设计。没有什么特别能阻止您开发“数字运算应用程序或图形密集型系统”，但该语言在实时事件处理中大放异彩。

# ruby-on-rails - Ruby - 如何正确地将对象作为参数传递然后显示它

> ID：11214342
> 
> 赞同：0
> 
> 时间：2012-06-26T19:09:23.103
> 
> 标签：ruby-on-rails, ruby

我正在传递这样的对象：

```
-@users.each do |user|
          %tr
            %td=link_to(user.first_name, users_user_path(user), :title => user.first_name)
            %td=user.first_name 
```

但我不确定如何在控制器中检索用户对象。我尝试这样的事情：

```
user = User.new(params[:@user])
@user = params[:@user] 
```

但没有这样的工作。这应该如何工作？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:13:45.243

你很接近..为了让用户进入控制器，你会这样做：

```
@user = User.new(params[:user]) 
```

# algorithm - 文本编辑器中的前 3 个字数

> ID：11214354
> 
> 赞同：0
> 
> 时间：2012-06-26T19:10:30.920
> 
> 标签：algorithm, hash, word

我知道解决这个问题的一种方法是散列单词及其相应的字数。然后遍历Hash map，找出top 3。

有没有更好的方法来解决这个问题？如果我使用 BST 而不是 HashMap 会更好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:05:19.480

[Trie](https://en.wikipedia.org/wiki/Trie)是一个很好的数据结构。不需要哈希计算，插入和更新的时间复杂度`O(1)`与字典的大小一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T20:02:19.367

我敢打赌，哈希表在这种情况下会有更好的性能，因为可能有很多不同的词。查找将`O(1)`接管`O(log N)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:13:58.190

HashMap 或 BST 都是合理的选择。每个人的表现将根据您需要计算的字数而有所不同。在这些情况下，分析器是您的朋友（[VisualVM](http://visualvm.java.net/)是一个合理的开始选择）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T20:29:59.597

基本上，**[直方图](http://en.wikipedia.org/wiki/Histogram)**是这样做的标准方式，您可以选择要用于直方图接口的实现，它们之间的区别实际上是特定于实例的 - 每个都有其优点和缺点。

您可能还需要考虑使用**[map-reduce](http://en.wikipedia.org/wiki/MapReduce)**设计来计算字数：

```
map(doc):
   for each word:
     emitIntermediate(word,"1")

reduce(word,list<string>):
   emit(word,size(list)) 
```

如果您有很多文档，这种方法可以提供很好的可扩展性 - 使用 map-reduce 接口，或者如果您喜欢[函数式编程](http://en.wikipedia.org/wiki/Functional_programming)，则使用优雅的解决方案。

注意：这种方法与散列解决方案基本相同，因为映射器`(key,values)`使用散列传递元组。

# php - 使用 SimpleXMLElement 来自 XML 问题的数组

> ID：11214359
> 
> 赞同：0
> 
> 时间：2012-06-26T19:11:04.340
> 
> 标签：php, arrays, api, xml-parsing, simplexml

好的所以这是问题，使用 api (lyris hq) 我正在返回这个 xml 数据集

```
<DATASET>
    <TYPE>success</TYPE>
    <RECORD>
        <DATA type="name" id="205199">Dev1</DATA>
        <DATA type="messages">4</DATA>
        <DATA type="last-sent">Jun. 26, 2012</DATA>
        <DATA type="members">1</DATA>
        <DATA type="status">active</DATA>
        <DATA type="cache-time">2012-06-26T18:21:18+00:00</DATA>
    </RECORD>
    <RECORD>
        <DATA type="name" id="206378">Dev2</DATA>
        <DATA type="messages">1</DATA>
        <DATA type="last-sent"></DATA>
        <DATA type="members">2</DATA>
        <DATA type="status">active</DATA>
        <DATA type="cache-time">2012-05-31T14:47:12+00:00</DATA>
    </RECORD>
    <RECORD>
        <DATA type="name" id="206379">Dev3</DATA>
        <DATA type="messages">1</DATA>
        <DATA type="last-sent"></DATA>
        <DATA type="members">1</DATA>
        <DATA type="status">active</DATA>
        <DATA type="cache-time">2012-05-31T14:47:12+00:00</DATA>
    </RECORD>
    <RECORD>
        <DATA type="name" id="206380">Dev4</DATA>
        <DATA type="messages">1</DATA>
        <DATA type="last-sent"></DATA>
        <DATA type="members">1</DATA>
        <DATA type="status">active</DATA>
        <DATA type="cache-time">2012-05-31T14:47:12+00:00</DATA>
    </RECORD>
</DATASET> 
```

我正在尝试做的是使用 SimpleXMLElement 创建一个数组，以这种格式递归地使用它

```
$response = array(
    '{listid (id attribute from name element)}' => array(
        '{other attribute type}' => '{value}'
    ),
); 
```

使用 dev1（第一条记录）的示例

```
$response = array(
    '205199' => array(
        'name' => 'Dev1',
        'messages' => '4',
        'last-sent' => 'Jun. 26, 2012',
        'members' => '1',
        'status' => 'active',
        'cache-time' => '2012-06-26T18:21:18+00:00'
    ),
); 
```

我和这里的网络团队的几位成员已经对此进行了一段时间的抨击，但无处可去，所以我希望我能从荨麻疹的头脑中得到一些帮助，可以这么说，哈哈

这是我最后一次尝试用来获得结果的一个可怜的例子，显然失败了

```
 foreach ($responseobj->RECORD as $value) {

        $returnarray[(string)$value->DATA['id']] = array();

        foreach ($value->DATA as $k => $v) {
            echo '<pre>';
            print_r($v);
            echo '</pre>';

            $returnarray[(string)$v['id']] = array((string)$v['type'] => (string)$v,);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:42:34.727

```
<?php
$x = simplexml_load_file('example.xml');
$returnarray = array();
foreach($x->RECORD as $value){
    $returnarray[(string)$value->DATA['id']] = array();
    foreach ($value->DATA as $k => $v) {
        $returnarray[(string)$value->DATA['id']][(string)$v['type']] = (string)$v;
    }
}
var_dump($returnarray); 
```

# javascript - Javascript在做加法时增加了额外的精度

> ID：11214362
> 
> 赞同：0
> 
> 时间：2012-06-26T19:11:18.583
> 
> 标签：javascript, math, floating-point, numbers, rounding

> **可能的重复：**
> [JavaScript 的数学被破坏了吗？](https://stackoverflow.com/questions/588004/is-javascripts-math-broken)

关于原因的任何想法：

```
(872.23 + 2315.66 + 4361.16) == 7549.05 
```

在 Javascript 控制台（例如 Chrome 开发者控制台）中返回 false？

如果我用我的计算器试一试，左边确实是 7549.05... 但是，Javascript 将它显示为 7549.049999999999。我可以“修复”它或将其舍入，或者……但我为什么要为简单的添加而这样做？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:16:15.077

那不是 Javascript 增加了额外的精度，而是您的计算机的浮点表示无法准确地表示您的数字。通过使用有理数或定点（而不是浮点）算术来解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:18:29.030

通过使用小数，您使用的是浮点数。您必须了解一点关于浮点如何以二进制形式表示，以及二进制浮点加法如何工作才能理解*为什么*添加浮点数并不总能解决您想要的问题。

这是您可能想看一眼的快速谷歌搜索结果：[完整的 Javascript 编号参考](http://www.hunlock.com/blogs/The_Complete_Javascript_Number_Reference)

此外，如果您想了解浮点是如何用二进制表示的，请查看 Wikipedia 上的[IEEE 浮点](http://en.wikipedia.org/wiki/IEEE_floating_point)。

在这种情况下，你最好的选择是四舍五入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:19:03.450

这是因为浮点数在硬件中的表示方式（可能是 32 位，但在任何位数中都是相同的）。基本上问题是你不能准确地表示像“7549.05”这样的东西（更多关于这个问题的[维基百科](http://en.wikipedia.org/wiki/Floating_point)）。

因此，对于实际用途，如果数字是货币，一个好的选择是乘以 100，因此它们始终是整数，并使用整数进行运算（在加法、减法或乘法时会产生良好的结果）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T19:19:19.467

Marco Mariani 不久前回答[了一个类似的问题](https://stackoverflow.com/questions/5401844/number-precision-in-javascript)：

[每个计算机科学家都应该知道的关于浮点运算的知识](http://perso.ens-lyon.fr/jean-michel.muller/goldberg.pdf)

更短，更重要的是：

[http://floating-point-gui.de/](http://floating-point-gui.de/)

# jquery - 如何删除多个网址上的空白

> ID：11214366
> 
> 赞同：0
> 
> 时间：2012-06-26T19:11:44.107
> 
> 标签：jquery, replace, slug

在具有多个 url 的页面上，我希望能够删除 slug 中的空格并将其替换为连字符。我可以在我有一个 url 的情况下，但我在使用多个 url 的情况下遇到了麻烦。我假设脚本必须使用`each(function())` 基于我用于单个版本的版本，我尝试了以下操作：

```
$(document).ready.(function() {
        $('a.testlink').each(function() {
            var Text = $(this);
            Text = Text.toLowerCase();
            Text = Text.replace(/[\s]+/g,'-');
            $(this).attr("href", Text);      
    });
         }); 
```

但是该脚本完全失败，对 url 没有影响 - 它既不会小写也不会替换空格。

如何让脚本遍历每个 href 并替换在 slug 中找到的任何空格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:16:14.873

我相信这句话`var Text = $(this);`应该是`var Text = $(this).attr("href");`

# php - 数据 url 图片另存为 png

> ID：11214369
> 
> 赞同：3
> 
> 时间：2012-06-26T19:11:51.797
> 
> 标签：php, image, base64

假设我有来自 Apple 的数据 url：

```
data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6%2BR8AAAAlElEQVR42oWQQRHEIAxF10ElVAISVgo3bCABCUhYCZWAhEpAQpoD6bzJhNnDO0DyyA8fEXkppXyVCpLViDUfyqVIQN9JFMY637hrlCySFauL21E7KVWbAIGx56rnSLqc5KPXSLo3kySalPhTygFhRDtFC09EIsMeZJSGBj7Qveh3OJW89syImiH%2BIO2BOJX0XwA2%2BQEL4pAhSX4aBQAAAABJRU5ErkJggg%3D%3D 
```

我想保存为 png 文件。我该怎么做？右键单击和“将图像另存为”不起作用（为什么？）所以我想我应该使用带有“base64_decode”函数的 PHP 脚本：

```
 $img = "iVBORw0KGgoAAAANSUhEUgAAA9QAAAAkCAMAAABfcIIyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHVQTFRFAAAA%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F5YtmQAAAACd0Uk5TAAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHh8gISIjJCUmZiD6WAAAAdlJREFUeF7t3btuFEEQheFzunotGYkIERA4spn3fyeHiAgEEtsXB82s2eEJavR%2F0Wjyo75XWfHpw4MkSXNqCkA2lr2%2B%2Fvz63n15qpI0x5yTSAM52XaxJLVXf%2FkoaY6xQk2sgXy8Ql2KJf3wS5HG6HMMQg3kZNkuxVGKNLxJo48%2BxhxTpBrIx7JcXEqUKJI3zd77CjWLaiAle4U6Iixv6q33MfocTL%2BBlCy7OEqJqCFvs%2FV2m3%2BTaiAd6zb7rlHtrbc1VA%2Bm30BSa%2B%2B7RNSo4a21thbVTL%2BBnCy7rCV1rdXbtbXW%2B%2Bh%2Ft78BZLM2v6NE1Fov%2FrpC3Zl%2BA2l5H6lrrRe%2FXNu%2BqCbUQE57qGvsoW5t9D4H028gJculOKLUWuvFz%2B16O9NipAZSsm8nWpfq53ZlTQ3k9s%2BamlADZ0CogZMh1MDJEGrgZAg1cDL%2Fh5ojLSC1%2ByMtLp8A2R0un3BNFEjv%2FpooDzqA9O4fdPD0Esju8PSSIglAdsciCZQzArI7lDOat30yCg8CGe2FB1eovZcI7oMSwUBSq0TwWlQHxfyBEzgW86ftDpDase0ODfKA7A4N8mhlC2R318r2px%2BeQqLpPJDae9P5%2FmrVz491%2FWekBlKy7PXVfn9rb9xXsMD2wdOcAAAAAElFTkSuQmCC";

header("Content-type: image/png");
echo base64_decode($img); 
```

那是给我损坏的图像图标：

![在此处输入图像描述](../Images/71d8e578fcfebeee878ec1e967a71d93.png)

我应该如何解决这个问题并将数据 url 图像保存到文件中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:13:35.630

您的代码很好，但您的 base64 是 urlencoded。我为你解码了它：`iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAAlElEQVR42oWQQRHEIAxF10ElVAISVgo3bCABCUhYCZWAhEpAQpoD6bzJhNnDO0DyyA8fEXkppXyVCpLViDUfyqVIQN9JFMY637hrlCySFauL21E7KVWbAIGx56rnSLqc5KPXSLo3kySalPhTygFhRDtFC09EIsMeZJSGBj7Qveh3OJW89syImiH+IO2BOJX0XwA2+QEL4pAhSX4aBQAAAABJRU5ErkJggg==`

或者自己做： `base64_decode(urldecode($img));`

# java - Glassfish 中部署的 Webapp 无法写入文件

> ID：11214370
> 
> 赞同：1
> 
> 时间：2012-06-26T19:11:53.140
> 
> 标签：java, jakarta-ee, ubuntu, permissions, glassfish

我在 Glassfish 中运行的无状态 EJB 中有以下功能。它所做的只是将一些数据写入文件。该函数的第一部分只是创建文件需要去的路径。第二部分实际写入文件。

```
private boolean createFile(String companyName, String fileName, byte[] data)
{
    logger.log(Level.FINEST, "Creating file: {0} for company {1}", new Object[]{fileName, companyName});
    File companyFileDir = new File(LOCAL_FILE_DIR, companyName);
    if(companyFileDir.exists() == false)
    {
        boolean createFileDir = companyFileDir.mkdirs();
        if(createFileDir == false)
        {
            logger.log(Level.WARNING, "Could not create directory to place file in");
            return false;
        }
    }
    File newFile = new File(companyFileDir, fileName);
    try 
    {
        FileOutputStream fileWriter = new FileOutputStream(newFile);
        fileWriter.write(data);
    } 
    catch(IOException e)
    {
        logger.log(Level.SEVERE,"Could not write file to disk",e);
        return false;
    }
    logger.log(Level.FINEST,"File successfully written to file");
    return true;
} 
```

这段代码执行后我得到的输出是：

```
WARNING: Could not create directory to place file in 
```

所以很明显 Glassfish 不能创建这个目录。我假设这与权限有关。谁能给我一个方向，看看这里可能出了什么问题？

我在 Ubuntu 12 上的 Glassfish 3.12 上运行它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T10:21:38.643

不同之处： 1）比较规范：（21.1.2 编程限制）企业 bean 不得使用 java.io 包来尝试访问文件系统中的文件和目录。我确定 GF 没有强制执行此操作，但您应该意识到这一点。

2）代码本身很好。在 LOCAL_FILE_DIR 上尝试 chmod +777 以了解它是否与一般权利有关......

希望有帮助...

# ruby - gem install ruby -debug19 失败

> ID：11214373
> 
> 赞同：0
> 
> 时间：2012-06-26T19:12:03.840
> 
> 标签：ruby, rubygems, ruby-debug

> **可能重复：**
> [在 ruby​​ 1.9 中调试](https://stackoverflow.com/questions/1083451/debugging-in-ruby-1-9)

我无法安装 ruby​​-debug19。我尝试关注[http://isitruby19.com/linecache19](https://stackoverflow.com/questions/7700828/installing-gems-without-rvm-as-root-with-explicit-version-of-ruby/7781550#7781550)[但](http://isitruby19.com/linecache19)它对我 没有帮助

=======================================

```
> root@vm:/# ruby -v ruby 
> 1.9.2p290 (2011-07-09 revision 32553) [i686-linux] 
```

=======================================

```
> root@vm:/# gem -v
> 1.8.10 
```

=======================================

```
> root@vm:~/# uname -a 
> Linux vm 3.0.0-12-generic #20-Ubuntu SMP Fri Oct 7 14:50:42 UTC 2011 i686 i686 386 GNU/Linux 
```

=======================================

> `root@vm:~# sudo gem install ruby-debug19`

```
 Building native extensions.  This could take a while...

    ERROR:  Error installing ruby-debug19:
            ERROR: Failed to build gem native extension.

            /usr/local/bin/ruby extconf.rb
    checking for vm_core.h... no
    checking for vm_core.h... no
    *** extconf.rb failed ***
    Could not create Makefile due to some reason, probably lack of
    necessary libraries and/or headers.  Check the mkmf.log file for more
    details.  You may need configuration options.

    Provided configuration options:
            --with-opt-dir
            --without-opt-dir
            --with-opt-include
            --without-opt-include=${opt-dir}/include
            --with-opt-lib
            --without-opt-lib=${opt-dir}/lib
            --with-make-prog
            --without-make-prog
            --srcdir=.
            --curdir
            --ruby=/usr/local/bin/ruby
            --with-ruby-dir
            --without-ruby-dir
            --with-ruby-include
            --without-ruby-include=${ruby-dir}/include
            --with-ruby-lib
            --without-ruby-lib=${ruby-dir}/lib
    /usr/local/lib/ruby/1.9.1/net/http.rb:644:in `initialize': Connection timed out - connect(2) (Errno::ETIMEDOUT)
            from /usr/local/lib/ruby/1.9.1/net/http.rb:644:in `open'
            from /usr/local/lib/ruby/1.9.1/net/http.rb:644:in `block in connect'
            from /usr/local/lib/ruby/1.9.1/timeout.rb:44:in `timeout'
            from /usr/local/lib/ruby/1.9.1/timeout.rb:89:in `timeout'
            from /usr/local/lib/ruby/1.9.1/net/http.rb:644:in `connect'
            from /usr/local/lib/ruby/1.9.1/net/http.rb:637:in `do_start'
            from /usr/local/lib/ruby/1.9.1/net/http.rb:626:in `start'
            from /usr/local/lib/ruby/1.9.1/net/http.rb:1168:in `request'
            from /usr/local/lib/ruby/gems/1.9.1/gems/ruby_core_source-0.1.5/lib/contrib/uri_ext.rb:239:in `block in read'
            from /usr/local/lib/ruby/gems/1.9.1/gems/ruby_core_source-0.1.5/lib/contrib/uri_ext.rb:286:in `connect'
            from /usr/local/lib/ruby/gems/1.9.1/gems/ruby_core_source-0.1.5/lib/contrib/uri_ext.rb:234:in `read'
            from /usr/local/lib/ruby/gems/1.9.1/gems/ruby_core_source-0.1.5/lib/contrib/uri_ext.rb:128:in `download'
            from /usr/local/lib/ruby/gems/1.9.1/gems/ruby_core_source-0.1.5/lib/ruby_core_source.rb:55:in `block in create_makefile_with_core'
            from /usr/local/lib/ruby/1.9.1/tempfile.rb:320:in `open'
            from /usr/local/lib/ruby/gems/1.9.1/gems/ruby_core_source-0.1.5/lib/ruby_core_source.rb:51:in `create_makefile_with_core'
            from extconf.rb:19:in `<main>'
    Requesting http://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p290.tar.gz

Gem files will remain installed in /usr/local/lib/ruby/gems/1.9.1/gems/linecache19-0.5.12 for inspection.
Results logged to /usr/local/lib/ruby/gems/1.9.1/gems/linecache19-0.5.12/ext/trace_nums/gem_make.out 
```

[在本地安装 ruby​​-debug19](https://stackoverflow.com/questions/4169169/installing-ruby-debug19-locally) 我从上面的链接中得到了问题的答案，该链接基本上将所有 *.h *.c *.inc 文件放入以下文件夹

```
ruby -rmkmf -e 'puts Config::CONFIG["rubyhdrdir"] + "/" + "ruby-" + RUBY_VERSION.to_s + "-p" + RUBY_PATCHLEVEL.to_s' 
```

但我对这个灵魂不满意。如果我要求客户安装 ruby​​，我几乎不能指望出售这个特殊的解决方案来解决这个问题。

那么有没有办法避免这种复制？

有人可以帮帮我吗。谢谢苏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:29:49.687

您没有说您正在运行什么操作系统，但不久前我在安装 OSX Lion 时遇到了类似的问题。错误是针对不同的 gem，但错误是相同的。

原来是某种 XCode 版本冲突。[在这里查看我的解决方案。](https://stackoverflow.com/a/10458609/404993)

如果这没有帮助，请查看`mkmf.log`文件。它可能包含您正在寻找的答案的线索。

# jquery - jquery nextAll() 函数，检查是否有next

> ID：11214374
> 
> 赞同：0
> 
> 时间：2012-06-26T19:12:10.970
> 
> 标签：jquery, next, traversal

我如何测试是否有下一个，因为这不想工作

出于某种原因，它一直计算 3 个元素？

```
$("body "+content).on("keypress","form.fcheckoutform :input.aantal",function(e) {
        if (e.keyCode === 9) { 

            var nextItem = $(this).nextAll();

            if (!nextItem.length) { 
                $(content+ '.aantal:eq(0)').focus();
                return false;
            }
            $(this).nextAll().focus();
        }
    }); 
```

**编辑：** 解决了

```
$("body "+content).on("keypress","form.fcheckoutform :input.aantal",function(e) {
        e.preventDefault();
        if (e.keyCode === 9) { 
            var nextItem = $(this).parents('.item-checkout').next().children('form').children('div.fr').find('.aantal');
            if (!nextItem.length) { 
                $(content+ ' .aantal:first').focus();
            }else{
                nextItem.focus();
            }
        }
    }); 
```

谢谢，理查德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:21:59.497

尝试这个：

```
$("body "+content).on("keypress","form.fcheckoutform :input.aantal",function(e) {
    if (e.keyCode === 9) { 

        var nextItem = $(this).nextUntil(':input.aantal').next();

        if (!nextItem.length) { 
            $(content+ '.aantal:eq(0)').focus();
            return false;
        }
        $(this).nextUntil(':input.aantal').next().focus();
    }
}); 
```

# facebook - 如何生成只有 FB 页面 ID 的 Facebook 赞按钮

> ID：11214377
> 
> 赞同：1
> 
> 时间：2012-06-26T19:12:38.367
> 
> 标签：facebook, facebook-graph-api, sdk, facebook-like

所以我有一个数据库表，其中包含我的用户的 Facebook 页面 ID。我想动态生成一个类似按钮，只有我可以使用的 ID 来执行此操作。我看到的问题是，考虑到 Facebook 页面 url 看起来像这样，我不知道该`data-href`属性应该具有什么：`http://facebook.com/pages/hyphenated-name/<?=$FB_id?>`而且我没有将连字符名称存储在我的数据库中来生成该 url。

是否有另一个 URL 结构 Facebook 的后端会接受只有 ID 而不是连字符名称，但仍会在该人的 Facebook 粉丝页面上计算喜欢？这是不可能的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:19:57.680

您可以查找 id，并检索存储的页面的链接。

示例：[https ://developers.facebook.com/tools/explorer?method=GET&path=191825050853209](https://developers.facebook.com/tools/explorer?method=GET&path=191825050853209)

参考：链接连接下的[https://developers.facebook.com/docs/reference/api/page/ 。](https://developers.facebook.com/docs/reference/api/page/)

此方法需要使用图形 api 或其中一个 sdk。

参考：[https ://developers.facebook.com/docs/reference/api](https://developers.facebook.com/docs/reference/api)

# node.js - 使用 node.js 写入文件系统的非阻塞方式

> ID：11214379
> 
> 赞同：2
> 
> 时间：2012-06-26T19:12:44.100
> 
> 标签：node.js

我已经用`node.js`. 这`server`会监听一个端口并通过一个端口将请求重新路由到另一个服务器`http.request()`

要重新路由消息的积压日志，我想将每条消息（单行信息）附加到一个文件中，并将日期作为文件名。

服务器将被多个设备以小 txt 字符串（800 字节）的交替间隔攻击。写入文件系统会隐式调用阻塞事件。有没有办法防止这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:46:53.170

如果 appendFile 不能正常工作，我自己测试了一个使用文件流的解决方案，该文件流适用于多个集群并且不会破坏输出

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:22:08.987

只需使用`fs`模块的异步方法，例如`appendFile`.

[http://nodejs.org/api/fs.html#fs_fs_appendfile_filename_data_encoding_utf8_callback](http://nodejs.org/api/fs.html#fs_fs_appendfile_filename_data_encoding_utf8_callback)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T23:14:41.243

这样的事情可能会有所帮助。

```
 var fs = require('fs');
    var writer = {
      files: {},
      appendFile: function(path, data) {
        if(this.files[path] === undefined) {
          this.files[path] = {open: false, queue: []};
        }
        this.files[path].queue.push(data);
        if(!this.files[path].open) {
          this.files[path].open = true;
          this.nextWrite(path);
        }
      },
      nextWrite: function(path) {
        var data = this.files[path].queue.shift(),
            self = this;
        if(data === undefined)
          return this.files[path].open = false;
        fs.appendFile(path, data, function(err) {
          if (err) throw err;
          self.nextWrite(path);
        });
      }
    } 
```

fs.appendFile 需要 0.8.0 版本的节点，但它为每个文件保留一个队列，然后按照添加的顺序附加内容。它有效，但我没有花太多时间在它上面.. 所以只将它用于教育目的。

```
 writer.appendFile('test.txt','hello'); 
```

# c# - 客户端应用程序和服务器应用程序之间丢失 UDP“连接”

> ID：11214382
> 
> 赞同：0
> 
> 时间：2012-06-26T19:13:14.230
> 
> 标签：c#, sockets, connection, udp, client-server

我编写了两个小应用程序（一个客户端和一个服务器）来测试 UDP 通信，我发现它们之间的“连接”（是的，我知道，没有真正的连接）会无缘无故地丢失。

我知道 UDP 是一个不可靠的协议，但这里的问题似乎不是丢包，而是应用程序之间的通信通道丢失。

这是客户端应用程序代码：

```
 class ClientProgram
    {
        static void Main(string[] args)
        {
            var localEP = new IPEndPoint(GetIPAddress(), 0);

            Socket sck = new UdpClient(localEP).Client;
            sck.Connect(new IPEndPoint(IPAddress.Parse("[SERVER_IP_ADDRESS]"), 10005));

            Console.WriteLine("Press any key to request a connection to the server.");
            Console.ReadLine();

            // This signals the server this clients wishes to receive data
            SendData(sck);

            while (true)
            {
                ReceiveData(sck);
            }
        }

        private static void ReceiveData(Socket sck)
        {
            byte[] buff = new byte[8];
            int cnt = sck.Receive(buff);

            long ticks = BitConverter.ToInt64(buff, 0);

            Console.WriteLine(cnt + " bytes received: " + new DateTime(ticks).TimeOfDay.ToString());
        }

        private static void SendData(Socket sck)
        {
            // Just some random data
            sck.Send(new byte[] { 99, 99, 99, 99 });
        }

        private static IPAddress GetIPAddress()
        {
            IPHostEntry he = Dns.GetHostEntry(Dns.GetHostName());
            if (he.AddressList.Length == 0)
                return null;

            return he.AddressList
                .Where(ip => ip.AddressFamily == System.Net.Sockets.AddressFamily.InterNetwork && !IPAddress.IsLoopback(ip))
                .FirstOrDefault();
        }
    } 
```

这是服务器应用程序代码：

```
 class ServerProgram
    {
        private static int SLEEP = 5;
        static void Main(string[] args)
        {
            // This is a static IP address
            var localEP = new IPEndPoint(GetIPAddress(), 10005);

            Socket sck = new UdpClient(localEP).Client;

            // When this methods returs, a client is ready to receive data
            var remoteEP = ReceiveData(sck);

            sck.Connect(remoteEP);

            while (true)
            {
                SendData(sck);
                System.Threading.Thread.Sleep( ServerProgram.SLEEP * 1000);
            }
        }

        private static EndPoint ReceiveData(Socket sck)
        {
            byte[] buff = new byte[8];
            EndPoint clientEP = new IPEndPoint(IPAddress.Any, 0);

            int cnt = sck.ReceiveFrom(buff, ref clientEP);

            Console.WriteLine(cnt + " bytes received from " + clientEP.ToString());

            return (IPEndPoint)clientEP;
        }

        private static void SendData(Socket sck)
        {
            DateTime n = DateTime.Now;
            byte[] b = BitConverter.GetBytes(n.Ticks);
            Console.WriteLine("Sending " + b.Length + " bytes : " + n.TimeOfDay.ToString());
            sck.Send(b);
        }

        private static IPAddress GetIPAddress()
        {
            // Same as client app...
        }
    } 
```

（这只是测试代码，不要关注无限循环或缺乏数据验证）

问题是在发送了几条消息后，客户端停止接收它们。服务器继续发送，但客户端卡在`sck.Receive(buff)`. 如果我将 SLEEP 常量更改为高于 5 的值，则“连接”大部分时间在 3 或 4 条消息后丢失。

我可以确认客户端机器在连接丢失时没有收到任何数据包，因为我使用 Wireshark 监控通信。

服务器应用程序在直接连接到 Internet 的服务器上运行，但客户端是本地网络中的一台机器，位于路由器后面。他们都没有运行防火墙。

有谁知道这里会发生什么？

谢谢！

编辑 - 附加数据：

我在同一网络中的多台机器上测试了客户端应用程序，但连接总是丢失。我还在其他路由器后面的其他网络中测试了客户端应用程序，那里没有问题。我的路由器是 Linksys RV042，从来没有任何问题，事实上，这个应用程序是唯一一个有问题的应用程序。

### 问题已解决 - 简短回答：

这是一个硬件问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:36:29.890

我在源代码中没有看到任何明显的问题。如果这是真的：

1.  服务器不断发送数据包（由服务器上的WireShark确认）
2.  客户端永远不会收到数据包（由客户端上的 WireShark 确认）

..那么问题可能与两台机器之间的网络设备有关，它们并不总是按预期处理UDP流，尤其是在路由器/防火墙后面时。

我会推荐以下故障排除方法：

1.  在同一系统上运行客户端和服务器并使用环回接口（确认 UDP 代码在环回上工作）
2.  在插入同一以太网交换机的两个不同系统上运行客户端和服务器（确认 UDP 通信在交换机本地工作）

如果在本地交换机上一切正常，您可以相当确定您有网络配置问题。

# jquery - 如何左对齐 Jquery 数据表分页按钮

> ID：11214384
> 
> 赞同：4
> 
> 时间：2012-06-26T19:13:21.610
> 
> 标签：jquery, pagination, datatables

关于如何左对齐 Jquery 数据表分页按钮的任何想法？默认情况下，顶部按钮居中对齐，底部按钮右对齐。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-08-30T17:00:08.780

您需要使用 !important 来覆盖应用于分页器的现有样式。

```
.dataTables_paginate {
  float: left !important;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:16:55.477

`div.dataTables_paginate { float: left; margin: 0; }`应该做的伎俩。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-12T21:15:20.990

这是我使用默认值`datatable`（无`dom`/`sDom`设置）所做的，以便分页控件位于 `x of y`信息下方，两个项目都左对齐并位于表格底部：

```
Showing 1 to 25 of NN entries
First Previous 1 2 3 4 5 Next Last 
```

我添加了这种风格：

```
 <style type="text/css">
        div.dataTables_info {
            position: absolute
        }

        div.dataTables_wrapper div.dataTables_paginate {
            float: unset;
            text-align: left;
            padding-top: 28px;
            padding-bottom: 10px;
            white-space: nowrap;
        }
    </style> 
```

使用这些设置：

```
 "bJQueryUI": true,
                "iDisplayLength": 25,
                "sPaginationType": "full_numbers",
                "aLengthMenu": [[10, 25, 50, 100, 200, -1], [10, 25, 50, 100, 200, "All"]], 
```

# ruby - 带有 capybara-webkit 的录像机

> ID：11214386
> 
> 赞同：14
> 
> 时间：2012-06-26T19:13:25.633
> 
> 标签：ruby, capybara-webkit, vcr

我正在使用 capybara-webkit 来测试与第三方网站的集成（我需要 javascript）。

我想使用 vcr 记录集成测试期间发出的请求，但 capybara-webkit 不通过 net http，因此 vcr 无法记录它们。我将如何为 vcr 编写一个允许我记录请求的适配器？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-26T19:57:15.333

不幸的是，VCR 与 capybara-webkit 非常不兼容。事实上，capybara webkit 使用的是 c 语言的 webkit。作为 VCR 基础的 Webmock 和 Fakeweb 只能用于 Ruby Web 请求。让两者一起工作可能是一项艰巨的任务。

我已经通过两种方式解决了这个问题：

第一个（hacky，但有效）是向仅包含在测试环境中的应用程序添加一个新的 javascript 文件。该文件将发出外部 Web 请求的 JS 类存根。除了这种方法的纯hackatude之外，它还要求每次添加或更改新请求时，您也必须更改存根。

第二种方法是通过我自己的服务器路由所有外部请求，通过我的服务器有效地代理所有外部请求。这有一个巨大的缺点，即您必须对想要使用的所有内容采取行动（您可以通过一些工作对其进行泛化）。它还受到这样一个事实的困扰，即完成请求的时间可能会增加一倍。但是，由于请求现在是由 Ruby 发出的，因此您可以尽情使用 VCR。

在我的情况下，方法#2 对我来说更有利，因为我需要 ruby​​ 来操作数据，以便我可以保持我的 javascript 源不可知。然而，我成功地使用方法#1 有一段时间了。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-15T14:31:08.647

我已经为 rspec+capybara 编写了一个小型 ruby​​ 库 ( [puffing-billy](https://github.com/oesmith/puffing-billy) )，它正是这样做的——它在您的浏览器和外部世界之间注入了一个代理，并允许您伪造对特定请求的响应。

例子：

```
describe 'fetching badges from stackoverflow API' do
  it 'should show a nice message when you have no badges' do
    # stub some JSONP
    proxy.stub('http://api.stackoverflow.com/1.1/users/1/badges',
               :jsonp => { :badges => [] })

    visit '/my_badges'
    page.should have_content("You don't have any badges :(")
  end
end 
```

# javascript - 在选择框上使用 javascript 转到 url | 下拉框

> ID：11214393
> 
> 赞同：0
> 
> 时间：2012-06-26T19:13:37.053
> 
> 标签：javascript, html, drop-down-menu

我有以下 javascript 函数可以转到选定的框值 url。

```
function go(x) {
    alert(x);
    location = x.value;
} 
```

我不能使用 getElementById 由于用户不同，可能有超过 1 个选择框我写了一个 php 来打印表单和 div 中的所有选择框

```
<div class="styled-select">
    <form name="menu">
        <select id=Admission onchange=go(this)>
            <option value=/admission>Add Existing Students</option>
        </select> 
        <select id=Student onchange=go(this)>
            <option value=www.bing.com>Student Details</option>
        </select>
    </form>
</div> 
```

欢迎所有建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:17:50.217

您没有正确访问元素的值。改用这个：

```
function go(x) {
    location = x.options[x.selectedIndex].value;
} 
```

你也不会得到一个只有一个选项的`onchange`事件。`<select>`

# c++ - 随机数生成器和线程安全

> ID：11214394
> 
> 赞同：2
> 
> 时间：2012-06-26T19:13:37.850
> 
> 标签：c++, c, random

几乎每个 C/C++（Mersenne，...）中的伪随机生成器都使用某种内部状态，通常是一个短的字节向量。我的问题是，当在多线程环境中使用和共享这样的随机生成器时，让它线程安全“更好”还是让“竞争条件”发生只会增加随机性？

我知道这个问题很难严格回答，但会感谢任何意见。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-26T19:17:19.097

让“竞争条件”发生可能会搞砸一切。从技术上讲，*数据竞赛*是未定义的行为，因此它可以订购披萨。

但即使这没有发生，内部状态也可能会被破坏，随机序列的所有重要属性都将丢失。例如，您无法再保证一致性。您不能将随机数的生成留给机会。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-26T19:16:41.013

让竞争条件发生永远不会更好。您的代码可能会崩溃。即使没有，这几乎肯定会降低生成的数字的质量。人们花费大量精力来设计随机数生成器，并且注入这种噪音很可能会破坏他们的努力。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-26T19:26:06.840

# 并发写入

这在很大程度上取决于内部状态的种类。如果每个可能的位模式都是内部状态的有效表示，因此会在随机数序列的某个点发生，那么写入竞争应该没有问题。但是许多随机数生成器，包括您引用的 Mersenne，其周期不是 256 的幂，因此具有一些在单线程操作中永远无法达到的状态模式，并且可能会在多线程操作中导致问题。

# 并发阅读

但是还有一个更好的理由使 rng 线程安全：否则两个进程可能会在任何一个更新之前读取相同的状态。这可能导致两个进程共享*完全相同*的随机数，这可能会导致各种奇怪的问题，具体取决于您的应用程序。您可以使用互斥锁或线程本地状态使其成为线程安全。

# java - 如何制作动态 ExpandableListView

> ID：11214396
> 
> 赞同：0
> 
> 时间：2012-06-26T19:13:44.547
> 
> 标签：java, android, android-widget

我是 Android 新手，我正在努力使用`ExpandableListView`.

我想要 3 个组 - “在线”、“离线”和“离开”。这些组将包含将从 Internet 加载的子自定义对象（联系人）。对象一次只能在一个组中（尽管稍后可能会改变）。

我自己尝试过，没有寻求帮助，我将粘贴代码 - 它让我用正确的组显示列表视图，但孩子们在所有组中。

在代码中，Contact 项当前只是在另一个类的向量中。

我真的很感激一些帮助，因为我真的被困住了。

```
public class MyTreeAdaptor extends BaseExpandableListAdapter{
@Override
public boolean areAllItemsEnabled()
{
    return true;
}

private Context context;
private ArrayList<String> groups;
private ArrayList<ArrayList<Contact>> children;
public MyTreeAdaptor(Context context, ArrayList<String> groups,
        ArrayList<ArrayList<Contact>> children) {
    this.context = context;
    this.groups = groups;
    this.children = children;
}

/**
 * A general add method, that allows you to add a Contact to this list
 * 
 * Depending on if the category opf the Contact is present or not,
 * the corresponding item will either be added to an existing group if it 
 * exists, else the group will be created and then the item will be added
 * @param Contact
 */
public void addItem(Contact aContact) {
    try {
        Log.e("additem", ""+aContact.show);
        if (!groups.contains(aContact.show)) {
            groups.add(aContact.show);
        }
        int index = groups.indexOf(aContact.show);
        if (children.size() < index + 1) {
            children.add(new ArrayList<Contact>());
        }
        children.get(index).add(aContact);
    } catch (Exception e) {
        // TODO Auto-generated catch block
        Log.e("additem error", " "+e);
    }
}

@Override
public Object getChild(int groupPosition, int childPosition) {
    return children.get(groupPosition).get(childPosition);
}

@Override
public long getChildId(int groupPosition, int childPosition) {
    return childPosition;
}

// Return a child view. You can load your custom layout here.
@Override
public View getChildView(int groupPosition, int childPosition, boolean isLastChild,
        View convertView, ViewGroup parent) {
    try {
        Contact contact = (Contact) getChild(groupPosition, childPosition);
        if (convertView == null) {
            LayoutInflater infalInflater = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = infalInflater.inflate(R.layout.treeview, null);
        }
        TextView tv = (TextView) convertView.findViewById(R.id.text1);
        try {
            tv.setText("   " + contact.name);
            tv.setCompoundDrawablesWithIntrinsicBounds(0, 0, 0, 0);
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        // Depending upon the child type, set the imageTextView01

        /*if (Contact instanceof Car) {
            tv.setCompoundDrawablesWithIntrinsicBounds(R.drawable.car, 0, 0, 0);
        } else if (Contact instanceof Bus) {
            tv.setCompoundDrawablesWithIntrinsicBounds(R.drawable.bus, 0, 0, 0);
        } else if (Contact instanceof Bike) {
            tv.setCompoundDrawablesWithIntrinsicBounds(R.drawable.bike, 0, 0, 0);
        }*/
        return convertView;
    } catch (Exception e) {
        Log.e("error thr", " "+e);
        e.printStackTrace();
        return null;
    }
}

@Override
public int getChildrenCount(int groupPosition) {
    try
    {
    return children.get(groupPosition).size();
    }
    catch(Exception hh)
    {
        return 0;

    }
}

@Override
public Object getGroup(int groupPosition) {
    return groups.get(groupPosition);
}

@Override
public int getGroupCount() {
    return groups.size();
}

@Override
public long getGroupId(int groupPosition) {
    return groupPosition;
}

// Return a group view. You can load your custom layout here.
@Override
public View getGroupView(int groupPosition, boolean isExpanded, View convertView,
        ViewGroup parent) {
    try {
        Log.e(groupPosition+"groups size is", " "+groups.size());
        String group;
        if(groups.size() > 0) 
        {
            group = (String) getGroup(groupPosition);
        }
        else
        {
            group = "null";//(String) getGroup(groupPosition);
        }

        if (convertView == null) {
            LayoutInflater infalInflater = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = infalInflater.inflate(R.layout.treeview, null);
        }
        TextView tv = (TextView) convertView.findViewById(R.id.text1);
        try {
            tv.setText(group);
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        return convertView;
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        return null;
    }
}

@Override
public boolean hasStableIds() {
    return true;
}

@Override
public boolean isChildSelectable(int arg0, int arg1) {
    return true;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:44:22.043

如果您有两种不同类型的子视图，则必须在适配器中实现这些方法：

```
@Override
public int getChildTypeCount() {
    return 2;
}

@Override
public int getChildType(int groupPosition, int childPosition) {
    return groupPosition == 4 ? 1 : 0;
} 
```

然后对该方法进行以下更改`getChildView`：

```
LayoutInflater layoutInflater = (LayoutInflater) mContext
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
View v = convertView;
if(v == null) {
    if (groupPosition == 4) {
        v = layoutInflater.inflate(R.layout.treeitem, null);
    } else {
        v = layoutInflater.inflate(R.layout.treeview, null);
}

TextView tt = null;
if (groupPosition != 4) {
        tt = (TextView) v.findViewById(R.id.text1);
// rest of the method 
```

要了解这是如何工作的，请花一些时间观看[此](http://www.youtube.com/watch?v=wDBM6wVEO70)视频以及[有关](https://stackoverflow.com/a/5301093/473637)SO 的答案。为 ListView 解释的概念同样适用于 ExpandableListView。

# c# - 如何编写转换器类？如何高效编写映射规则？

> ID：11214401
> 
> 赞同：6
> 
> 时间：2012-06-26T19:14:08.247
> 
> 标签：c#, design-patterns, architecture, mapping, converter

我有一个很大的 A 类，有很多成员，我有一个很大的 B 类，可以在拥有 A 对象时构建。拥有 B 对象时可以构建 A 对象。我需要它们，因为 A 是一种 ViewModel，它具有验证功能，B 是图形描述，可以轻松绘制。

如何进行这种转换？

这是一个示例，以说明我想要做什么：

```
class A
{
    string s;
    string t;
    string u;
    string v;

    enum a;
    enum b;
    enum c;
    enum d;
    enum e;

    Dictionary<enum, string> dict;
}

class B
{
    string someString; // is essentially A.a + A.b + A.c + A.s with some rules.
    int someValue; // is essentially dict.TryGetValue(enum.Entry);
    string anotherString;
    // ... and lots of others
} 
```

当然做一些映射很简单，构建一个B对象，通过颠倒构建A => B的规则来写普通的B => A映射并不难

**所以问题是：**

*   是否有任何众所周知的模式来实现这一目标？
*   有没有默认的 C# 方式来做这些事情？

写下类似这样的简单内容似乎不合适，它最终会变成数百行代码。

我考虑了一些用于部件的转换器类，例如 SomeStringConverter、SomeValueConverter、...

*   我如何将 A 的所需成员与规则一起抽象出来以进行映射。
*   我如何编写这些规则以最简单的方式来执行 A => B 和 B => A。

**编辑：** 这里的模式是指“最佳实践”而不是“GoF 设计模式”

B 类中的 SomeString 是某种“选择器”，它选择绘图选项，它总是 25 个字符长，A 类中的枚举选择这些字符，但在大多数情况下不是一对一的。

例如：Aa = "Filled", Ab = "SingleCoordinate", Ac = "DrawHints" 会产生类似 SomeString =

```
 "Y**D***RR****---***---***" 
```

即组合对于获得这样的字符串很重要，但是从组合中您可以派生必须在 A 对象中设置的枚举。

**编辑2：**

我对两种方式都使用我的映射规则的方式特别感兴趣，即 Aa = "Filled" 结合 Ab = "SingleCoordinate" 结合 Ac = "DrawHints" 将导致 (partial string) `"Y**D***RR"`，并且部分字符串也意味着必须将 Aa 设置为“已填充”等等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T21:15:56.343

在我看来，A 更像是数据模型，而 B 更像是视图模型。对于这种情况，我不认为有一个普遍接受的“模式”——主要是因为这种配对背后的原因千差万别，而最佳模式很大程度上取决于预期用途。

就是说，由于它们紧密相连，我倾向于让一个班级从属于另一个班级。在这种情况下，由于 A 更简单，我可能会使用 A 作为 B 的数据容器。即将私有成员 A 作为 B 类中的字段，并且 B 类中的所有属性直接引用 A 类——更新A 而不是背后有自己的私有领域。然后，您可以在 B 类上拥有一个公共属性，如果需要，该属性会公开 A 类的私有成员。我可能会保持只读状态，但这可能并不重要（取决于您对 B 类的使用和任何可能的绑定关系）。反过来，我会在 B 类上创建一个构造函数，该构造函数接受 A 类作为参数。然后将传递的 A 值分配给类 B 上的私有类 A 成员。

所有这些的结果是保持 A 类对 B 类的无知——如果你有一个 ViewModel 情况的真实用例，这将变得很有用。如果您确定 A 类是您需要的更真实的 ViewModel，则将上述相反，使 B 类是 A 类的无知者。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T19:16:38.710

> 是否有任何众所周知的模式来实现这一目标？

这取决于你所说的模式是什么意思。[`Decorator`](http://en.wikipedia.org/wiki/Decorator_pattern)or模式浮现在[`Adapter`](http://en.wikipedia.org/wiki/Adapter_pattern)脑海中，但都不是为了将类型批发映射到不同类型。

> 有没有默认的 C# 方式来做这些事情？

不，没有。但是像[Automapper](http://automapper.codeplex.com/)这样的库确实让生活更轻松。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T06:42:41.027

工厂 + 可能的门面

您想协调从 A 构建 B 或从 B 构建 A。这表明您需要复杂的逻辑才能做到这一点。

要从 A 构建 B，要么实现为 B（工厂）上的静态方法，要么创建一个继承自 B 的新类 C，并将 A 作为其构造函数的参数（外观）。

工厂：[http](http://en.wikipedia.org/wiki/Factory_method_pattern) ://en.wikipedia.org/wiki/Factory_method_pattern （与您的情况不完全匹配）

外观：[http](http://en.wikipedia.org/wiki/Design_Pattern_-_Facade) ://en.wikipedia.org/wiki/Design_Pattern_-_Facade （也不是完全匹配）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T16:12:55.147

几个想法：

A) 将 B 更改为 A 实现的接口。这将允许您将 B 的属性直接“映射”到 A 的属性，而无需重新创建它们。如果 B 具有 A 不应该具有的属性（或结合了多个 A 的属性），您可以将访问修饰符设置为 private* - 这意味着该属性只能通过接口可见（以免A）的混淆或杂乱的实现。

B) 使用伪适配器/包装器模式。B，给定一个A类型的构造函数参数，可以回溯A的属性等。B不同的地方，可以实现自己的逻辑。

两个复杂对象之间的映射需要一些复杂的思考。总会有特殊情况、副作用和选择，需要思考和权衡利弊。（例如，在字符串和 int 之间进行转换会引入各种问题 - 如何处理千位分隔符、如何处理不同的文化等。）从阅读您的具体情况来看，我没有看到一种简单或快速的方法来处理映射 - 您将拥有基于所有相关因素的方法，可能太多，无法在此处发布。

编辑： * 我应该注意这是我在几个 VB 项目中所做的。我认为这在 C# 中是合法的，但我没有尝试过。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-03T21:02:47.300

我为解决这个问题所做的工作：

1.  写了一个 BiMap（在这个问题上的老 SO 的帮助下）。

2.  将映射插入其中（Key 中的所有值组合，“Value”中的结果键，以及指定由该映射定义的字符串索引的 BitArray。

3.  编写了一些代码来计算由此产生的整体字符串，因为映射只会给出部分字符串。

4.  一对一的映射是微不足道的。

这样我就可以以两种方式使用映射。给定一个字符串，我仍然有一个相当昂贵的搜索（因为我必须使用 BitArray 作为掩码来计算存储的字符串）

目前它似乎工作得很好，但我还没有完成。

感谢大家提出非常好的想法和方法！也许 AutoMapper 可以做到这一点，但我目前没有太多时间阅读和尝试一项新技术。

**如果有人可以提供一些有关如何在 Automapper 上执行此操作的相关示例，我将接受它作为答案（因为我已经喜欢 AutoMapper）。**

例如，可以说：3 个具有 5 个值的枚举到一个固定长度的字符串 一个固定长度的字符串到 3 个具有 5 个值的枚举（与上述相反）。

举个例子：

```
A.a && B.o && C.y ==> "**A**********************"
A.a && B.p && C.y ==> "**B**********************"
A.b && B.o && C.y ==> "*****X*******************"
A.b && B.o && C.z ==> "*****W*******************" 
```

Automapper 能做到这样的事情吗？

# javascript - 如何检测浏览器是否支持 HTML5 本地存储

> ID：11214404
> 
> 赞同：87
> 
> 时间：2012-06-26T19:14:13.193
> 
> 标签：javascript, html

`ls exist`IE7 中的以下代码警报：

```
if(window.localStorage) {
    alert('ls exists');
} else {
    alert('ls does not exist');
} 
```

IE7 并不真正支持本地存储，但这仍然提醒它支持。也许这是因为我在 IE7 浏览器和文档模式下使用 IE9 使用 IE9 开发人员工具。或者也许这只是测试是否支持 LS 的错误方法。什么是正确的方法？

此外，我不想使用 Modernizr，因为我只使用了一些 HTML5 功能，并且加载大型脚本只是为了检测对这些东西的支持是不值得的。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-06-26T19:18:28.197

您不必使用modernizr，但您可以使用他们的方法来检测是否`localStorage`支持

[github 上的modernizr](https://github.com/Modernizr/Modernizr/tree/master/src)
[测试`localStorage`](https://github.com/Modernizr/Modernizr/blob/master/feature-detects/storage/localstorage.js)

```
// In FF4, if disabled, window.localStorage should === null.

// Normally, we could not test that directly and need to do a
//   `('localStorage' in window) && ` test first because otherwise Firefox will
//   throw bugzil.la/365772 if cookies are disabled

// Also in iOS5 & Safari Private Browsing mode, attempting to use localStorage.setItem
// will throw the exception:
//   QUOTA_EXCEEDED_ERRROR DOM Exception 22.
// Peculiarly, getItem and removeItem calls do not throw.

// Because we are forced to try/catch this, we'll go aggressive.

// Just FWIW: IE8 Compat mode supports these features completely:
//   www.quirksmode.org/dom/html5.html
// But IE8 doesn't support either with local files

Modernizr.addTest('localstorage', function() {
    var mod = 'modernizr';
    try {
        localStorage.setItem(mod, mod);
        localStorage.removeItem(mod);
        return true;
    } catch(e) {
        return false;
    }
}); 
```

*使用当前源代码更新*

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-06-26T19:15:58.673

```
if(typeof Storage !== "undefined")
  {
  // Yes! localStorage and sessionStorage support!
  // Some code.....
  }
else
  {
  // Sorry! No web storage support..
  } 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-08-15T10:02:01.807

此功能工作正常：

```
function supports_html5_storage(){
    try {
        return 'localStorage' in window && window['localStorage'] !== null;
    } catch(e) {
        return false;
    }
} 
```

资料来源：[www.diveintohtml5.info](http://diveintohtml5.info/detect.html#storage)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-04-01T14:16:12.537

> *此外，我不想使用 Modernizr，因为我只使用了一些 HTML5 功能，并且加载大型脚本只是为了检测对这些东西的支持是不值得的。*

要减小 Modernizr 文件大小，请在[http://modernizr.com/download/](http://modernizr.com/download/)上自定义文件以满足您的需求。Modernizr 的本地存储版本只有 1.55KB。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-06-26T19:15:10.980

尝试`window.localStorage!==undefined`：

```
if(window.localStorage!==undefined){
    //Do something
}else{
    alert('Your browser is outdated!');
} 
```

您也可以使用`typeof window.localStorage!=="undefined"`，但上面的语句已经做到了

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-07-26T20:52:13.440

我没有在答案中看到它，但我认为很高兴知道您可以轻松地使用 vanilla JS 或 jQuery 进行如此简单的测试，虽然 Modernizr 有很大帮助，但没有它也有干净的解决方案。

如果你使用**jQuery**，你可以这样做：

```
var _supportsLocalStorage = !!window.localStorage
    && $.isFunction(localStorage.getItem)
    && $.isFunction(localStorage.setItem)
    && $.isFunction(localStorage.removeItem); 
```

或者，使用纯原生**JavaScript**：

```
var _supportsLocalStorage = !!window.localStorage
    && typeof localStorage.getItem === 'function'
    && typeof localStorage.setItem === 'function'
    && typeof localStorage.removeItem === 'function'; 
```

然后，您只需执行 IF 来测试支持：

```
if (_supportsLocalStorage) {
    console.log('ls is supported');
    alert('ls is supported');
} 
```

所以整个想法是，每当您需要 JavaScript 功能时，您将首先测试父对象，然后测试您的代码使用的方法。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-08-10T09:02:01.337

尝试 catch 将完成这项工作：

```
 try{
       localStorage.setItem("name",name.value);
       localStorage.setItem("post",post.value);
       }
    catch(e){
       alert(e.message);    
       } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-26T19:16:12.277

尝试：

```
if(typeof window.localStorage != 'undefined') {
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-08-13T08:44:30.550

```
if (window.localStorage){

   alert('localStorage is supported');
   window.localStorage.setItem("whatever", "string value");

} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-12-30T03:04:18.193

修改 Andrea 的答案以添加 getter 使其更易于使用。使用以下内容，您只需说：`if(ls)...`

```
 var ls =  {
    get: function () { 
      var test = 'test';
      try {
        localStorage.setItem(test, test);
        localStorage.removeItem(test);
        return true;
      } catch(e) {
        return false;
      }
    }
  }; 
```

```
var ls =  {
  get: function () { 
    var test = 'test';
    try {
      localStorage.setItem(test, test);
      localStorage.removeItem(test);
      return true;
    } catch(e) {
      return false;
    }
  }
};

function script(){
  if(ls){
    alert('Yes');
  } else {
    alert('No');
  }
}
```

```
<button onclick="script()">Local Storage Support?</button>
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-01-24T12:21:15.267

我知道我参加聚会有点晚了，但是我编写了一些有用的函数并将其放入名为“manage_storage.js”的文件中。我希望它们对你们有用，因为它们对我很有帮助。

> 请记住：您正在寻找的功能（回答这个问题）是`isLclStorageAllowed`.

所以事不宜迟，这是我的代码：

```
/* Conditional Function checks a web browser for 'session storage' support. [BEGIN] */

if (typeof isSessStorageAllowed !== 'function')
    {
        function isSessStorageAllowed()
            {
                if (!!window.sessionStorage && typeof sessionStorage.getItem === 'function' && typeof sessionStorage.setItem === 'function' && typeof sessionStorage.removeItem === 'function')
                    {
                        try
                            {
                                var cur_dt = new Date();
                                var cur_tm = cur_dt.getTime();
                                var ss_test_itm_key = 'ss_test_itm_' + String(cur_tm);
                                var ss_test_val = 'ss_test_val_' + String(cur_tm);

                                sessionStorage.setItem(ss_test_itm_key, String(ss_test_val));

                                if (sessionStorage.getItem(ss_test_itm_key) == String(ss_test_val))
                                    {
                                        return true;
                                    }
                                else
                                    {
                                        return false;
                                    };

                                sessionStorage.removeItem(ss_test_itm_key);
                            }
                        catch (exception)
                            {
                                return false;
                            };
                    }
                else
                    {
                        return false;
                    };
            };
    };

/* Conditional Function checks a web browser for 'session storage' support. [END] */

/* Conditional Function checks a web browser for 'local storage' support. [BEGIN] */

if (typeof isLclStorageAllowed !== 'function')
    {
        function isLclStorageAllowed()
            {
                if (!!window.localStorage && typeof localStorage.getItem === 'function' && typeof localStorage.setItem === 'function' && typeof localStorage.removeItem === 'function')
                    {
                        try
                            {
                                var cur_dt = new Date();
                                var cur_tm = cur_dt.getTime();
                                var ls_test_itm_key = 'ls_test_itm_' + String(cur_tm);
                                var ls_test_val = 'ls_test_val_' + String(cur_tm);

                                localStorage.setItem(ls_test_itm_key, String(ls_test_val));

                                if (localStorage.getItem(ls_test_itm_key) == String(ls_test_val))
                                    {
                                        return true;
                                    }
                                else
                                    {
                                        return false;
                                    };

                                localStorage.removeItem(ls_test_itm_key);
                            }
                        catch (exception)
                            {
                                return false;
                            };
                    }
                else
                    {
                        return false;
                    };
            };
    };

/* Conditional Function checks a web browser for 'local storage' support. [END] */

/* Conditional Function checks a web browser for 'web storage' support. [BEGIN] */

/* Prerequisites: 'isSessStorageAllowed()', 'isLclStorageAllowed()' */

if (typeof isWebStorageAllowed !== 'function')
    {
        function isWebStorageAllowed()
            {
                if (isSessStorageAllowed() === true && isLclStorageAllowed() === true)
                    {
                        return true;
                    }
                else
                    {
                        return false;
                    };
            };
    };

/* Conditional Function checks a web browser for 'web storage' support. [END] */ 
```

# excel - 如何在 Excel 图表中显示隐藏行，但不显示隐藏列？

> ID：11214405
> 
> 赞同：2
> 
> 时间：2012-06-26T19:14:16.270
> 
> 标签：excel, vba

有没有办法让 Excel 图表在隐藏行中绘制数据，但不在隐藏列中？我已经知道如何在右键单击图表时使用“选择数据”选项转到“隐藏和空单元格”选项，该选项提供“在隐藏的行和列中显示数据”的选项。但是，我找不到在隐藏行中显示数据而不在隐藏列中显示数据的方法，并且希望有人能够提出 VBA 解决方案。

非常感谢，

杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:26:31.977

我只是为你鼓掌。需要注意的是，使用图表可能非常棘手。此代码仅适用于某些类型的图表，您可能需要进行一些调整才能使用您的特定数据集。

```
Option Explicit

Sub RemoveHiddenColumns()

Dim myChart As ChartObject
Set myChart = ActiveSheet.ChartObjects("Chart 1") 'place in here whichever chart you need to reference, asssumes the chart is on the activesheet

myChart.Activate 'first activate the chart

Dim i As Integer

For i = 1 To ActiveChart.SeriesCollection.Count 'loop through each series

    Dim strText As String, strCol As String, strSht As String, intCol As Integer

    strText = Split(ActiveChart.SeriesCollection(i).Formula, ",")(2) 'extract sheet name and column of series
    strSht = Split(strText, "!")(0) 'get sheet name of series
    strCol = Split(strText, "!")(1) 'get column range of series

    Dim wks As Worksheet
    Set wks = Worksheets(strSht)

    If wks.Range(strCol).EntireColumn.Hidden = True Then 'if the column is hidden
        ActiveChart.SeriesCollection(i).Delete 'remove the series
    End If

Next

End Sub 
```

# c# - 确定窗口是否有关闭按钮（或者，为什么 GetTitleBarInfo 不起作用？）

> ID：11214409
> 
> 赞同：3
> 
> 时间：2012-06-26T19:14:19.970
> 
> 标签：c#, winapi, pinvoke

[我正在尝试使用GetTitleBarInfo](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633513%28v=vs.85%29.aspx)函数来确定给定窗口是否有关闭按钮，如[this SO answer](https://stackoverflow.com/a/311410/300212)中所建议的那样。但是当我调用该函数时，它的返回值`rgstate[5]`- 应该指示关闭按钮状态 - 始终为 0，我不明白为什么。有人知道我在这里做错了什么吗？或者，如果有人可以建议另一种方法来获取此信息，那也会有所帮助。谢谢！

```
[DllImport("user32.dll", ExactSpelling = true, SetLastError = true)]
internal static extern IntPtr GetForegroundWindow();

[DllImport("user32.dll", SetLastError = true, CharSet = CharSet.Auto)]
[return: MarshalAs(UnmanagedType.Bool)]
internal static extern bool GetTitleBarInfo(IntPtr hwnd, ref TITLEBARINFO pti);

[StructLayout(LayoutKind.Sequential)]
internal struct TITLEBARINFO
{
    public int cbSize;
    public RECT rcTitleBar;
    [MarshalAs(UnmanagedType.ByValArray, SizeConst = 6)]
    public int[] rgstate;
}

IntPtr handle = GetForegroundWindow();
TITLEBARINFO titleBarInfo = new TITLEBARINFO();
titleBarInfo.cbSize = Marshal.SizeOf(titleBarInfo);

if (!GetTitleBarInfo(handle, ref titleBarInfo))
    throw new Win32Exception(Marshal.GetLastWin32Error());

// titleBarInfo.rgstate[5] is always 0 here. Why? 
```

**编辑：**为了清楚起见，根据 MSDN，返回值应该是[此处列出的一个或多个值](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632608%28v=vs.85%29.aspx)的组合。

# security - SaaS - 如何证明用户/客户他们总是在服务器中使用相同的代码？

> ID：11214410
> 
> 赞同：-1
> 
> 时间：2012-06-26T19:14:21.003
> 
> 标签：security, encryption, hash

假设我们有一个在服务器中运行的开源项目。

有没有一种通用的方法可以向用户证明我们使用的代码与发布的代码相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:40:49.727

从来没有隐含的保证远程服务是其清单中描述的，尽管通常直接考虑的是服务的声誉。

更重要的是，SaaS 本身只是一种交付模式，并不一定要在客户端和服务之间定义一套协议或合同。它只是定义了一种构建和服务公共平台的方法。这个术语更适用于描述服务的构建过程和目标市场，而不是描述具体的操作细节。

如果需要将这样的事情作为客户端和服务器之间合同的一部分来实现，可以考虑使用 HMAC 实现本机散列解决方案。可以使用类似于 OAuth 的加盐访问令牌来实现身份机制，但使用代码库的文件来生成校验和。这将保证如果代码正确执行一次，只要生成的散列没有改变，它就会运行相同的代码（尽管再次不能保证公开暴露的散列是正确生成的）

然而，在大多数服务通常倾向于使用的 SSL 安全性之上，这样的事情听起来是多余的。

总而言之，如果您对通过公共 API 提供的服务感到担忧，那么它的声誉可能优于它可能有一个很好的理由。

# java - Swing：我如何创建一个不会移动到西方组件上的东拥抱组件

> ID：11214418
> 
> 赞同：0
> 
> 时间：2012-06-26T19:14:53.873
> 
> 标签：java, swing, docking

我已经尝试了几种方法来让它正确渲染。我希望我的徽标区域在调整窗口大小时拥抱东方，但不要与西方组件重叠。以下代码不拥抱东方，我认为这是有道理的，因为 logoArea 框不知道它应该占据其余的水平空间。

如果我将 logoArea 直接添加到“区域”，那么它会拥抱东方，但如果窗口缩小太多，它将与西方组件重叠。有任何想法吗？

```
 Box box = Box.createHorizontalBox();
 box.add( main );
 for( JComponent item : items ) //western stuff
 {
    box.add( Box.createHorizontalStrut( 8 ) );
    box.add( item );
 }

 //eastern stuff
 Box logoArea= Box.createHorizontalBox();
 logoArea.add( new JLabel( LAF.Icon.png( "CompanyLogo" ) ), BorderLayout.EAST );

 box.add( Box.createHorizontalStrut( 8 ) );
 box.add( logoArea, BorderLayout.EAST );

 JPanel area = new JPanel( new BorderLayout() );
 area.setBorder( BorderFactory.createEmptyBorder( 2, 2, 2, 2 ) );
 area.add( box, BorderLayout.WEST );
 return area;  //dashboard is built 
```

**编辑**

要回答@Nitin，我希望它向左移动直到它到达西部组件，然后停止移动并从右侧消失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T10:19:52.793

我真的不知道任何可以按照您的意愿行事的标准布局，但创建一个并不难。检查这个小例子（十字形绘画显示内容和徽标边界）：

```
public static void main ( String[] args )
{
    JFrame frame = new JFrame ();

    LogoLayout layout = new LogoLayout ();
    frame.setLayout ( layout );

    frame.add ( new JLabel ( "Label with same preferred size as text length" )
    {
        protected void paintComponent ( Graphics g )
        {
            super.paintComponent ( g );

            g.setColor ( Color.BLACK );
            g.drawLine ( 0, 0, getWidth (), getHeight () );
            g.drawLine ( getWidth (), 0, 0, getHeight () );
        }
    }, layout.CONTENT );

    frame.add ( new JComponent ()
    {
        protected void paintComponent ( Graphics g )
        {
            g.setColor ( Color.BLACK );
            g.drawLine ( 0, 0, getWidth (), getHeight () );
            g.drawLine ( getWidth (), 0, 0, getHeight () );
        }

        public Dimension getPreferredSize ()
        {
            return new Dimension ( 100, 100 );
        }
    }, layout.LOGO );

    frame.setSize ( 700, 500 );
    frame.setDefaultCloseOperation ( JFrame.EXIT_ON_CLOSE );
    frame.pack ();
    frame.setLocationRelativeTo ( null );
    frame.setVisible ( true );
}

public static class LogoLayout implements LayoutManager
{
    public String CONTENT = "Content";
    public String LOGO = "Logo";

    private Map<Component, String> constraints = new HashMap<Component, String> ();

    public void addLayoutComponent ( String name, Component comp )
    {
        constraints.put ( comp, name );
    }

    public void removeLayoutComponent ( Component comp )
    {
        constraints.remove ( comp );
    }

    public void layoutContainer ( Container parent )
    {
        Insets bi = parent.getInsets ();
        int contentSize = 0;
        int logoSize = 0;
        int maxHeight = 0;
        for ( Component component : parent.getComponents () )
        {
            Dimension ps = component.getPreferredSize ();
            if ( constraints.get ( component ).equals ( CONTENT ) )
            {
                contentSize = Math.max ( ps.width, contentSize );
            }
            else if ( constraints.get ( component ).equals ( LOGO ) )
            {
                logoSize = Math.max ( ps.width, logoSize );
            }
            maxHeight = Math.max ( ps.height, maxHeight );
        }

        int width = parent.getWidth () - bi.left - bi.right;
        int height = parent.getHeight () - bi.top - bi.bottom;
        for ( Component component : parent.getComponents () )
        {
            if ( constraints.get ( component ).equals ( CONTENT ) )
            {
                if ( contentSize + logoSize < width )
                {
                    component.setBounds ( bi.left, bi.top, width - logoSize, height );
                }
                else
                {
                    component.setBounds ( bi.left, bi.top, contentSize, height );
                }
            }
            else if ( constraints.get ( component ).equals ( LOGO ) )
            {
                if ( contentSize + logoSize < width )
                {
                    component
                            .setBounds ( bi.left + width - logoSize, bi.top, logoSize, height );
                }
                else
                {
                    int scaledLogoSize = width - contentSize;
                    if ( scaledLogoSize > 0 )
                    {
                        component.setBounds ( bi.left + width - scaledLogoSize, bi.top,
                                scaledLogoSize, height );
                    }
                }
            }
        }
    }

    public Dimension preferredLayoutSize ( Container parent )
    {
        Insets bi = parent.getInsets ();
        int contentSize = 0;
        int logoSize = 0;
        int maxHeight = 0;
        for ( Component component : parent.getComponents () )
        {
            Dimension ps = component.getPreferredSize ();
            if ( constraints.get ( component ).equals ( CONTENT ) )
            {
                contentSize = Math.max ( ps.width, contentSize );
            }
            else if ( constraints.get ( component ).equals ( LOGO ) )
            {
                logoSize = Math.max ( ps.width, logoSize );
            }
            maxHeight = Math.max ( ps.height, maxHeight );
        }
        return new Dimension ( bi.left + contentSize + logoSize + bi.right,
                bi.top + maxHeight + bi.bottom );
    }

    public Dimension minimumLayoutSize ( Container parent )
    {
        return preferredLayoutSize ( parent );
    }
} 
```

当窗口变大时，这就是你希望你的 LOGO 表现的方式吗？

PS 这样，您还可以在需要添加（例如）另一个特定组件位置、徽标和内容之间的一些间隙或其他任何内容时随时修改布局......

# ruby-on-rails - 如何部署没有域名的 Rails 应用程序。（试图创建一个测试服务器）

> ID：11214419
> 
> 赞同：0
> 
> 时间：2012-06-26T19:14:57.290
> 
> 标签：ruby-on-rails, ruby-on-rails-3, apache, refinerycms

好的，所以我要做的是部署我的第一个 rails 项目。我已经问过[这个](https://stackoverflow.com/questions/9595459/need-advice-on-deploying-my-first-rails-app-to-a-mediatemple-dv)问题，我想我发现你不能配置 apache 使用 ip 工作，你必须有一个域名。

我还不能使用域名的原因是因为我正在为某人重新创建一个站点，而他们不希望它在将域从当前站点切换到新 Rails 站点之间关闭。

我想让我的 Rails 应用程序在服务器上运行，这样我就可以对其进行测试，然后一旦准备好，就切换域名。

如何在不使用域名的情况下设置服务器来运行 rails 项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:54:10.593

如果您想在开发模式下在本地运行 rails 项目，则只需`rails s`从项目的根目录运行命令。

可以将两个应用程序部署到同一台服务器，或者同一应用程序的两个版本，我通常为此使用子域，website.com，然后是 testing.website.com。

您只需要拥有单独的数据库和单独的虚拟主机文件。

如果它在本地网络上，您也可以尝试通过它的 IP 地址访问 apache 机器。

# xml - 查询元素内的 XML 内容

> ID：11214423
> 
> 赞同：2
> 
> 时间：2012-06-26T19:15:01.377
> 
> 标签：xml, xpath

我有一个奇怪的 XML 文档需要查询。它来自 Weather.gov 输出。我想查询的信息位于：/Enelope/Body/NDFDgenResponse/dwmlOut。它是 XML 的转换形式。是否可以查询该值下的单个元素，或者我必须对其进行后处理才能在其中查询？我怀疑我将不得不发布流程。

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<SOAP-ENV:Envelope SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/">
    <SOAP-ENV:Body>
        <ns1:NDFDgenResponse xmlns:ns1="http://graphical.weather.gov/xml/DWMLgen/wsdl/ndfdXML.wsdl">
            <dwmlOut xsi:type="xsd:string">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;dwml version=&quot;1.0&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation=&quot;http://graphical.weather.gov/xml/DWMLgen/schema/DWML.xsd&quot;&gt;
  &lt;head&gt;
    &lt;product srsName=&quot;WGS 1984&quot; concise-name=&quot;glance&quot; operational-mode=&quot;official&quot;&gt;
      &lt;title&gt;NOAA&apos;s National Weather Service Forecast at a Glance&lt;/title&gt;
      &lt;field&gt;meteorological&lt;/field&gt;
      &lt;category&gt;forecast&lt;/category&gt;
      &lt;creation-date refresh-frequency=&quot;PT1H&quot;&gt;2012-06-26T19:09:06Z&lt;/creation-date&gt;
    &lt;/product&gt;
    &lt;source&gt;
      &lt;more-information&gt;http://graphical.weather.gov/xml/&lt;/more-information&gt;
      &lt;production-center&gt;Meteorological Development Laboratory&lt;sub-center&gt;Product Generation Branch&lt;/sub-center&gt;&lt;/production-center&gt;
      &lt;disclaimer&gt;http://www.nws.noaa.gov/disclaimer.html&lt;/disclaimer&gt;
      &lt;credit&gt;http://www.weather.gov/&lt;/credit&gt;
      &lt;credit-logo&gt;http://www.weather.gov/images/xml_logo.gif&lt;/credit-logo&gt;
      &lt;feedback&gt;http://www.weather.gov/feedback.php&lt;/feedback&gt;
    &lt;/source&gt;
  &lt;/head&gt;
  &lt;data&gt;
    &lt;location&gt; 
```

..... </conditions-icon> </parameters> </data> </dwml>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T08:45:18.743

这是纯 XPath 3.0 的一个工作示例：

```
//dwmlOut/parse-xml(text())/dwml/head/product/title/text() 
```

当然，您的 xpath 处理器必须支持 3.0 版，例如 zorba 就支持：

[在线玩](http://www.zorba-xquery.com/html/demo#9lovKTigJCaHj64BXKD45kE67mc=)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:55:53.430

使用纯 XPath 可能不会。但是，如果您从任何其他语言调用 XPath，则可以先将该节点选择为字符串类型变量，然后将该字符串解析为另一个 xml 文档，并使用第二个 XPath 表达式从内部选择节点。它

即使可以使用纯 XPath，这种两步方法也绝对更容易编码、测试和维护。

# java - 将字节 [] 转换为 ArrayList I have a byte[] that i obtained using Object ArrayList <obj>Can anyone tell me how to convert my byte[] to Object ArrayList? Coveting ArrayList like 问问题 问问题 2012-06-26T19:15:39.093 14670 次 This question shows research effort; it is useful and clear 11 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have a byte[] that i obtained using Object ArrayList <obj>Can anyone tell me how to convert my byte[] to Object ArrayList? Coveting ArrayList like this: ByteArrayOutputStream bos = new ByteArrayOutputStream(); ObjectOutputStream oos = null; oos = new ObjectOutputStream(bos); oos.writeObject(mArrayList);//mArrayList is the array to convert byte[] buff = bos.toByteArray(); I'm going to go with the obvious answer here... for(byte b : bytearray) { arraylist.add(new Byte(b)); } java 4 2 回答 2 This answer is useful 18 Now you've given us the information about how you did the conversion one way... you need: ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(bytes)); try { @SuppressWarnings("unchecked") ArrayList list = (ArrayList) ois.readObject(); ... } finally { ois.close(); } 于 2012-06-26T19:36:12.523 回答 This answer is useful -1 我将在这里给出明显的答案...... for(byte b : bytearray) { arraylist.add(new Byte(b)); } 于 2012-06-26T19:18:36.040 回答 Related 3 ruby-on-rails - 具有多个 has_many/belongs_to 关联的嵌套模型形式 2 android - 将 ID 分配给动态创建的 ListFragment 2 actionscript - Adobe flash(cs5)如何替换动画 2 ios - UISegmentControl 在视图控制器之间切换 3 android - 通过文本宽度而不是字符数限制 Android 中的 EditText 1 java - struts2中如何使用表单提交复合对象 1 php - PHP如何按参数对树孩子进行降序排序 1 sql - 我可以连接来自 2 个不同 DB2 数据库的数据吗？（如 SQL Server 链接数据库） 2 java - Sharepoint 2010 oData Atom 提要内容属性在 Java 中解析 1 android - 无法调用 onNewIntent Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：11214427
> 
> 赞同：11
> 
> 时间：
> 
> 标签：java

I have a `byte[]` that i obtained using `Object ArrayList<Obj>`

Can anyone tell me how to convert my byte[] to Object ArrayList?

Coveting `ArrayList` like this:

```
ByteArrayOutputStream bos = new ByteArrayOutputStream();
ObjectOutputStream oos = null;
oos = new ObjectOutputStream(bos);

oos.writeObject(mArrayList);//mArrayList is the array to convert
byte[] buff = bos.toByteArray(); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-26T19:36:12.523

Now you've given us the information about how you did the conversion one way... you need:

```
ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(bytes));
try {
    @SuppressWarnings("unchecked")
    ArrayList<Object> list = (ArrayList<Object>) ois.readObject();
    ...
} finally {
    ois.close();
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-26T19:18:36.040

我将在这里给出明显的答案......

```
for(byte b : bytearray) {
  arraylist.add(new Byte(b));
} 
```</obj></obj>

# javascript - asp.net json 显示奇怪的结果

> ID：11214429
> 
> 赞同：0
> 
> 时间：2012-06-26T19:15:55.167
> 
> 标签：javascript, jquery, asp.net

我无法显示从 asp.net WebMethod 收到的结果。我有一个 HTML 模板并填写 JSON 响应的结果。问题是第一个响应显示一次，第二个显示2次，第三个显示4次，第四个显示8次，依此类推。这是jQuery（我需要先引用“d”，因为响应来自asp.net，它们会自动将其放在那里）

```
 function fnGetContent(keyword) {
            var NewKeyword = keyword.tag;
            var type = keyword.type
            var oldresults = $("#fillresultsdiv").html()
            $('#hidQueryType').val('tagsearch');
            $.ajax({
                type: "POST",  //GetEvents(iType As Integer, sSearch As String)
                url: "Default.aspx/GetEvents",
                data: "{'iType':'" + type + "','sSearch' : '" + NewKeyword + "' }",
                contentType: "application/json; charset=utf-8",
                dataType: "json",

                success: function (msg) {
                    var events = [];
                    var obj = $.parseJSON(msg.d);

                    $.each(obj.res, function() {
                        var newRow = $('.Template').clone();

                        // Now loop through the object
                        for (var prop in this) {
                            if (this.hasOwnProperty(prop)) {

                                // Lucky for you, the keys match the classes :)
                                $('.' + prop, newRow).text(this[prop]);
                            }
                        }
                        $('#fillresultsdiv').append(newRow);
                    }); 
```

每个事件的 JSON 中只有一个条目，是 jQuery 代码实现了这一点，示例响应：

```
 {"d":"{\"res\":[{\"day\":\"26\",\"dayofweek\":\"Tue\",\"month\":\"Jun\",\"title\":\"Glen Hansard\"
       ,\"venue\":\"Vic Theatre\",\"time\":\"7:00 PM\",\"ticketurl\":
        \"http://seatgeek.com/glen-hansard-tickets/chicago-illinois.... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:29:25.187

每次打电话

```
var newRow = $('.Template').clone(); 
```

您正在创建具有“模板”类的所有元素的副本。然后，您将所有这些副本附加到 id 为“fillresultsdiv”的元素中。这些副本中的每一个也都应用了这个“模板”类，因此下次克隆时，您将拾取先前克隆的副本。

第一次调用它时只有一行，第二次调用 2，然后是 4，然后是 8，依此类推。

您可能只需将克隆线更改为

```
var newRow = $('.Template').clone().removeClass("Template"); 
```

# javascript - console.log 中的值错误

> ID：11214430
> 
> 赞同：17
> 
> 时间：2012-06-26T19:15:57.083
> 
> 标签：javascript, google-chrome

> **可能重复：**
> [Chrome 的 JavaScript 控制台是否懒于评估数组？](https://stackoverflow.com/questions/4057440/is-chromes-javascript-console-lazy-about-evaluating-arrays)

我在 javascript 中有以下代码段，其输出让我觉得出了点问题。

`1.`

```
a=2;
console.log(a);
a+=2;
console.log(a); 
```

**输出：`2 4`** ; 正如预期的那样

`2.`

```
t=[0,2];
console.log(t);
t[0]+=2;
console.log(t); 
```

***输出：[2,2] [2,2]***

**输出不应该是** ***吗？*****以上两种情况有什么区别导致两种情况下的答案不同？*****`[0,2] [2,2]`***

 **** * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-26T19:21:17.410

这是因为日志会延迟到 Chrome 有时间执行（即您的脚本释放 CPU）。

试试这个以了解会发生什么：

```
var t=[0,2];
console.log(t);
setTimeout(function() {
     t[0]+=2;
   console.log(t);
}, 1000); 
```

它输出你所期望的。

这是 Chrome 的错误吗？也许是优化的副作用。至少这是一个危险的设计...

为什么有区别？我想 Chrome 临时存储它必须记录的内容，在第一种情况下作为主要（不可变）值，在最后一种情况下作为指向数组的指针。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-26T19:27:45.127

chrome/ff 中的 console.log 是异步的，记录的对象在扩展时被解释。. 如果您想查看当时的值（对于数组），请制作对象的副本：

```
t=[0,2];
console.log(t.slice(0));
t[0]+=2;
console.log(t); 
```

对于数组，调用 .slice 将复制数组而不创建引用。我不建议使用超时：这确实*不能解决*问题，只是暂时绕过它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:24:34.100

您所做的一切都是正确的，但是 chrome 的日志记录很混乱/延迟。尝试复制变量并将其添加到其中，您会发现您的代码是正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T19:36:07.717

Chrome 的日志记录在较新的版本中有所延迟，从您的角度来看没有问题。复制变量或使用`setTimeout`.***

# arrays - Bash 读取文件到基于两个分隔符的数组

> ID：11214431
> 
> 赞同：0
> 
> 时间：2012-06-26T19:15:58.440
> 
> 标签：arrays, file, bash, parsing, ifs

我有一个需要解析为数组的文件，但我真的只想要每行的一小部分，并且只需要前 84 行。有时这条线可能是：

```
>MT gi... 
```

我只想将 MT 输入到数组中。其他时候可能是这样的：

```
>GL000207.1 dn... 
```

我需要 GL000207.1

我在想你也许可以设置两个分隔符（一个是'>'，另一个是''空格），但我不确定你会怎么做。我已经阅读了其他人关于内部字段分隔符的帖子，但我真的不确定它是如何工作的。我想也许这样的事情可能会起作用？

```
desiredArray=$(echo file.whatever | tr ">" " ")
for x in $desiredArray
do
   echo > $x
done 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:35:09.313

怎么样：

```
head -84 <file> | awk '{print $1}' | tr -d '>' 
```

`head`只取文件的第一行，去掉`awk`第一个空格和后面的所有内容，并`tr`去掉“>”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:52:18.173

你也可以用 sed 来做：

```
head -n 84 <file> | sed 's/>\([^ ]*\).*/\1/' 
```

# matlab - 矩阵中的 Matlab 霍夫曼编码

> ID：11214434
> 
> 赞同：0
> 
> 时间：2012-06-26T19:16:01.513
> 
> 标签：matlab, huffman-code

我正在尝试使用霍夫曼代码对我拥有的矩阵（在计算帧差异之后）进行编码，但我在完成它时遇到了困难

我希望用霍夫曼编码的矩阵称为“amp”

我发现的东西是这样的：

```
function y = mat2huff(x)
%MAT2HUFF Huffman encodes a matrix.
%   Y = MAT2HUFF(X) Huffman encodes matrix X using symbol
%   probabilities in unit-width histogram bins between X's minimum
%   and maximum values. The encoded data is returned as a structure
%   Y: 
%      Y.code   The Huffman-encoded values of X, stored in
%               a uint16 vector.  The other fields of Y contain
%               additional decoding information, including:
%      Y.min    The minimum value of X plus 32768
%      Y.size   The size of X
%      Y.hist   The histogram of X
%
%   If X is logical, uint8, uint16, uint32, int8, int16, or double,
%   with integer values, it can be input directly to MAT2HUFF. The
%   minimum value of X must be representable as an int16\.  
%
%   If X is double with non-integer values---for example, an image
%   with values between 0 and 1---first scale X to an appropriate
%   integer range before the call. For example, use Y =
%   MAT2HUFF(255*X) for 256 gray level encoding.   
%
%   NOTE: The number of Huffman code words is round(max(X(:))) -
%   round(min(X(:))) + 1\.  You may need to scale input X to generate
%   codes of reasonable length.  The maximum row or column dimension
%   of X is 65535\. 
%
%   See also HUFF2MAT.

%   Copyright 2002-2004 R. C. Gonzalez, R. E. Woods, & S. L. Eddins
%   Digital Image Processing Using MATLAB, Prentice-Hall, 2004
%   $Revision: 1.5 $  $Date: 2003/11/21 15:21:12 $

if ndims(x) ~= 2 | ~isreal(x) | (~isnumeric(x) & ~islogical(x))
   error('X must be a 2-D real numeric or logical matrix.');
end

% Store the size of input x.
y.size = uint32(size(x));

% Find the range of x values and store its minimum value biased
% by +32768 as a UINT16.
x = round(double(x));
xmin = min(x(:));
xmax = max(x(:));
pmin = double(int16(xmin));
pmin = uint16(pmin + 32768);    y.min = pmin;

% Compute the input histogram between xmin and xmax with unit
% width bins, scale to UINT16, and store.
x = x(:)';
h = histc(x, xmin:xmax);
if max(h) > 65535
    h = 65535 * h / max(h);
end
h = uint16(h);   y.hist = h;

% Code the input matrix and store the result.
map = huffman(double(h));          % Make Huffman code map
hx = map(x(:) - xmin + 1);         % Map image
hx = char(hx)';                    % Convert to char array
hx = hx(:)';
hx(hx == ' ') = [];                % Remove blanks
ysize = ceil(length(hx) / 16);     % Compute encoded size
hx16 = repmat('0', 1, ysize * 16); % Pre-allocate modulo-16 vector
hx16(1:length(hx)) = hx;           % Make hx modulo-16 in length
hx16 = reshape(hx16, 16, ysize);   % Reshape to 16-character words
hx16 = hx16' - '0';                % Convert binary string to decimal
twos = pow2(15:-1:0);
y.code = uint16(sum(hx16 .* twos(ones(ysize, 1), :), 2))';

 ... 
```

但是在上面的代码中，我如何声明使用名为“amp”的矩阵？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:24:54.867

只需将您的函数`huf_amp = mat2huf(amp);`huf_amp 称为代码示例中详述的结构即可。

# php - php mysqldump 和 zip 7z

> ID：11214437
> 
> 赞同：3
> 
> 时间：2012-06-26T19:16:03.480
> 
> 标签：php, windows-7, mysqldump

我有这行 php 备份我的数据库，工作就像一个魅力（Windows 7）：

```
$exec_str = "{$real_path}Bin\mysqldump -h {$mysql_db_host} -u {$mysql_db_user} -p{$mysql_db_pasw} {$db_name} > {$backupdir}\\{$db_name}.sql"; 
```

但我宁愿使用 7zip 压缩 .sql 文件（如 7z）

这个不起作用（7za.exe 的路径是正确的）而是生成空的 7z 文件：

```
$exec_str = "{$real_path}Bin\mysqldump -h {$mysql_db_host} -u {$mysql_db_user} -p{$mysql_db_pasw} {$db_name} | {$real_path}7za a > {$backupdir}\\{$db_name}.sql.7z"; 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-24T13:29:14.090

我成功地使用 7z 压缩了 mysqldump (Windows Server 2008 R2) 的输出，但我使用了命令行批处理文件和自动化任务。另外，我只使用了 7z.exe，而不是 7za。

*注意以下命令是从 Windows 命令终端执行的，即开始->运行-> **cmd***

我为自动化任务创建了一个批处理文件，以使用以下内容运行：

```
mysqldump -u<mysqlUserName> -p<mysqlPassword> <schemaName>|7z.exe a -si<nameInZip> <zippedPathAndName.7z> 
```

这将创建一个 .7z 的 mysqldump 文件。[-si] 开关指定从 StdIn 获取输入。“nameInZip”正是您希望出现在 zip 文件中的内容；我做了我的“schemaName”.sql。

*注意：这假定 mysqldump 和 7z 可执行目录位于 %PATH% 环境变量中。否则使用二进制文件的完整路径，例如 c:\program files\7-zip\7z.exe 而不是 7z.exe*

然后我创建了一个自动化任务：

```
schtasks /create /sc DAILY /tn <yourTaskName> /ru System /tr <pathToYourBatchFile> /st 20:45 
```

这将创建一个自动任务，每天 20:45 运行您的批处理文件。请注意“/ru System”开关，它确保命令由 SYSTEM 运行，并且无论您是否登录都将运行。

有关 schtasks 命令的良好参考，请参见[此处](http://technet.microsoft.com/en-us/library/cc772785%28v=ws.10%29.aspx#BKMK_diff_perms)。

希望这可以帮助！

# linux - 如何从填充部分停止 objcopy

> ID：11214439
> 
> 赞同：0
> 
> 时间：2012-06-26T19:16:07.480
> 
> 标签：linux, bash, objcopy

我在 bash (ubuntu linux) 上使用 objcopy，并尝试使用以下推荐从 ELF 文件中复制 2 个部分：

```
objcopy -j .section1 -j .section2 
```

问题是 objcopy 在部分之间添加了一些填充。有没有办法（标志？）可以阻止 objcopy 填充部分？

这些部分在文件中一个接一个地放置，因此不需要任何类型的填充....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:14:19.877

解决了！问题是这些部分是一个接一个的，但不在同一段。一个在 WE 段中，一个在 RW 段中。这就是为什么 objcopy 搞砸了。

# php - 昵称的正则表达式

> ID：11214446
> 
> 赞同：-6
> 
> 时间：2012-06-26T19:16:28.160
> 
> 标签：php, javascript, regex

我真的是 RegExp 的新手，我现在无法构建它，所以我参考了 Stack Overflow。

规则：

1.  可以包含 6 到 15 个符号
2.  符号可以是拉丁字母、数字、下划线字符。
3.  昵称**必须**以字母开头

我不知道如何制作这个正则表达式。我需要在 Javascript 和 PHP 中使用它，所以我需要每个平台的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T19:20:17.980

这是让您入门的东西，但您需要对其进行调整并使其适应您的需要：

```
[a-zA-Z]\w{5,14}
^       ^
|       match an alphanumeric or underscore character 5 to 14 times
|
match a single alphabetic character 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:20:21.500

您可以使用：

```
/^[A-Za-z][A-Za-z0-9_]{5,14}$/ 
```

它应该适用于 PHP 和 JS。

# jquery - 左侧的叠加选项

> ID：11214447
> 
> 赞同：1
> 
> 时间：2012-06-26T19:16:29.553
> 
> 标签：jquery, css

我试图用 jquery 1.7.1 进行覆盖，就像诺基亚在其网站上使用的那样： [http ://www.nokia.com/us-en/products/products/](http://www.nokia.com/us-en/products/products/)

我正在使用 jpmodal：[http ://dev.iceburg.net/jquery/jqModal/#examples](http://dev.iceburg.net/jquery/jqModal/#examples)

但我没有运气

任何人都知道如何获得像诺基亚网站那样的效果吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:23:37.333

您应该查看[jQuery UI](http://jqueryui.com)，特别是他们的[模态对话框](http://jqueryui.com/demos/dialog/#modal)。

# .net - 在实体框架中表示没有键的视图

> ID：11214448
> 
> 赞同：0
> 
> 时间：2012-06-26T19:16:32.247
> 
> 标签：.net, entity-framework, primary-key, devart, database-first

我正在使用使用 Devart Entity Developer 生成的模型（.edml 文件，我理解它与 .edmx 最相似）来生成实体类，其关系在 DbContext 类中初始化。数据库架构没有为 View1 指定任何 PK，并且所有列都可以为空。但是代码生成假定对于缺少主键的视图，所有列都是键。即， .ssdl 具有 Key 元素下的所有列，并且 DbContext 具有在 all 上指定的 .IsRequired() ，如下所示：

ssdl摘录：

```
...
<EntityType Name="View1">
  <Key>
    <PropertyRef Name="FirstCol" />
    <PropertyRef Name="Col2" />
    <PropertyRef Name="LastCol" />
  </Key>
  <Property Name="FirstCol" Type="VARCHAR2" Nullable="false" MaxLength="4000" />
  <Property Name="Col2" Type="VARCHAR2" Nullable="false" MaxLength="120" />
  <Property Name="LastCol" Type="VARCHAR2" Nullable="false" MaxLength="20" />
</EntityType>
.... 
```

来自 DbContext：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{     
  #region View1
  modelBuilder.Entity<View1>()
    .HasKey(p => new { p.FirstCol, p.Col2, p.LastCol})
      .ToTable("View1", "Owner");
        // Properties:
        modelBuilder.Entity<View1>()
          .Property(p => p.FirstCol)
            .HasColumnName("FirstCol")
            .IsRequired()
            .HasMaxLength(4000)
            .HasColumnType("VARCHAR2");
        modelBuilder.Entity<View1>()
          .Property(p => p.Col2)
            .HasColumnName("Col2")
            .IsRequired()
            .HasMaxLength(120)
            .HasColumnType("VARCHAR2");
        modelBuilder.Entity<View1>()
          .Property(p => p.LastCol)
            .IsRequired()
            .HasMaxLength(20)
            .HasColumnType("VARCHAR2"); 
```

这会导致 NullReferenceException，当查询将返回具有空值的 PK 列之一的行时。

有没有办法在 EF 中表示视图而不指定键或更改数据库架构？我发现了这个：[http ://elegantcode.com/2012/03/15/querying-entityframework-views-without-a-key/](http://elegantcode.com/2012/03/15/querying-entityframework-views-without-a-key/)

这是首选的解决方案吗？我想我也可以使用 DefiningQuery，但这似乎重复了用于生成视图的 sql？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T07:36:34.457

您应该执行以下步骤：

1.  对于实体的所有列，在模型的概念和存储部分中将 Entity Key 属性设置为 False。
2.  将字符串类型的 Id 属性添加到模型概念部分的实体中，并将​​其 Entity Key 值设置为 True。
3.  如果您打开了概念部分和存储部分的同步（模型设置对话框->同步->映射），则 Id 列将自动添加到存储部分中的现有实体中。您应该为此列设置 Type=ROWID 和 Name=ROWID。映射将自动自定义。如果不同步，则将ROWID列添加到存储部分的对应实体中，并为其设置Type=ROWID。之后，调用类的上下文菜单，选择 Mapping Details 项并在显示的对话框中指定有效的列映射。
4.  对于类的其他属性，将 Nullable 设置为 True。

**编辑项3：**存储部分实体的列名必须为ROWID

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:17:01.313

您可以通过在设计器中打开 edml 并手动设置实体上的主键，针对 devart EF 提供程序中的 oracle 视图建立主键（假设您可以保证视图返回您定义的键的唯一数据）。然后（这是使这项工作起作用的技巧）转到模型资源管理器窗口并对模型的存储部分进行相同的更改。通常，如果您只是将视图拖到 EF 模型的设计图面上，devart 将尝试推断未定义的视图的主键。同样，您的视图为您定义的键返回唯一数据至关重要。

# oracle10g - 从存储过程中检索输出值 - GetColumn

> ID：11214457
> 
> 赞同：0
> 
> 时间：2012-06-26T19:16:55.477
> 
> 标签：oracle10g, java-stored-procedures

我需要调用一个存储过程，它没有 OUT 参数，而是通过调用 putcolumn 写入缓冲区管理器。如何使用 JAVA 应用程序中的 put 列检索数据集。我的存储过程是一个预言机。有人可以提供您的输入来对我的问题进行排序吗？

# android - 为 Microsoft Exchange OWA 开发 Android 应用

> ID：11214464
> 
> 赞同：0
> 
> 时间：2012-06-26T19:17:55.997
> 
> 标签：android

我正在尝试为我的公司开发一个应用程序，该应用程序将允许登录我们的 Microsoft Exchange 服务器并访问邮件。我需要一些关于如何通过交换服务器进行身份验证和下载邮件的指示。我对Android有相当的了解。如果有人能告诉我正确的方向，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:30:31.540

我将首先找到一个支持 Exchange 支持的协议之一的 Java 库，例如 ActiveSync 或 IMAP。

对于初学者，请查看 JavaMail 库： [http ://www.oracle.com/technetwork/java/javamail/index.html](http://www.oracle.com/technetwork/java/javamail/index.html)

还有一个您可以使用的商业 ActiveSync 库：http: [//www.independentsoft.de](http://www.independentsoft.de)

最后，您也许可以使用 Microsoft 的 Exchange Web Services API： http: [//archive.msdn.microsoft.com/ewsjavaapi](http://archive.msdn.microsoft.com/ewsjavaapi)

# android - Google tv 未显示我的 android 应用程序的完整布局

> ID：11214469
> 
> 赞同：0
> 
> 时间：2012-06-26T19:18:29.117
> 
> 标签：android, google-tv

我正在尝试为谷歌电视扩展一个基本的 hello world 应用程序。我创建了一个带有 EditText 和 Button 的 LinearLayout，并将其放在一个非常大的“Hello world”TextView（78sp）下。当我在谷歌电视盒 (adb) 上启动应用程序时，我得到了我的“Hello World”，但只有 EditText 和 Button 的最顶部。

查看 Eclipse Android 布局管理器中的应用程序，它一切正常且可见。

有想法该怎么解决这个吗？

我相信我必须在所有这些中缺少一些配置元素。

任何帮助表示赞赏。谢谢

代码，我的 main.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="475dp"
        android:gravity="center"
        android:text="@string/hello"
        android:textSize="78sp" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <EditText
            android:id="@+id/edit_message"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:ems="10"
            android:hint="@string/edit_message" >

            <requestFocus />
        </EditText>

        <Button
            android:id="@+id/button_send"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"

            android:text="@string/button_send" />

    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:45:32.387

可能是因为您的第一个文本视图是 475dp 高。您可以[在这里](https://developers.google.com/tv/android/docs/gtv_android_patterns)看到电视只有 540dp 高（请记住，实际像素和显示独立像素 [dp] 是不一样的，除非屏幕是 mdpi，而没有 Google TV）

# maven - 我们可以使用 maven surefire 插件来执行源目录中存在的测试用例吗

> ID：11214477
> 
> 赞同：1
> 
> 时间：2012-06-26T19:18:47.220
> 
> 标签：maven

我正在处理的 Java 项目是用 Java 编写的用于测试 C++ 代码的测试用例列表。所以我想在 Maven 生命周期的测试阶段从 src 目录运行测试用例。如何配置 maven surefire 插件来实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:47:02.390

由于基于 Java 的测试可能不会成为生产代码的一部分，因此我建议您遵循[Maven 的标准目录布局](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)并像往常一样将测试移动到`src/test/java`目录（否则，如果有人执行，测试将成为二进制文件的一部分`mvn package`）。

# c# - 将字符串转换为指定的日期格式

> ID：11214478
> 
> 赞同：1
> 
> 时间：2012-06-26T19:18:50.670
> 
> 标签：c#, datetime, asp.net-4.0, datetime-format

我无法将字符串转换为日期，并抛出格式不正确的异常：

这里是模式：

```
 DD-MM-YYYY
    MM-DD-YYYY
    YYYY-DD-MM
    YYYY-MM-DD
    YYYYDDMM
    YYYYMMDD 
```

格式来自下拉列表，这是我尝试过的不同方法，但仍然抛出异常：

```
 strCurrentFormat = rcboDateFormat.SelectedValue.ToString();

                 DateTime db = DateTime.ParseExact(strOldDate, "DD-MM-YYYY", CultureInfo.InvariantCulture);

                 //DateTime loadedDate = DateTime.ParseExact(strOldDate, strCurrentFormat, null); 
```

我之前已经解决了这个问题，方法是使用字符串，拆分它们并将年月日移动到正确的格式，但这需要很长时间，如果有人知道更简单的方法，那将是一个巨大的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T19:21:57.567

两件事情：

首先 - 使用正确的格式字符串。`D`并且`Y`不是已知的格式说明符。`d`并且`y`是。

其次 - 您可以将格式放入字符串数组并使用采用该格式列表的[`ParseExact`重载](http://msdn.microsoft.com/en-us/library/system.datetime.parseexact.aspx)。

```
string[] formats = new string[] 
   {"dd-MM-yyyy",
    "MM-dd-yyyy",
    "yyyy-dd-MM",
    "yyyy-MM-dd",
    "yyyyddMM",
    "yyyyMMdd"};

DateTime db = DateTime.ParseExact(strOldDate, 
                                  formats, 
                                  CultureInfo.InvariantCulture,
                                  DateTimeStyles.None); 
```

格式将按顺序尝试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:21:08.823

取自[http://www.codeproject.com/Articles/14743/Easy-String-to-DateTime-DateTime-to-String-and-For](http://www.codeproject.com/Articles/14743/Easy-String-to-DateTime-DateTime-to-String-and-For)

d - 月份中没有前导零的数字天。dd - 月份中的数字日期，前导零。ddd - 星期几的缩写名称。dddd - 星期几的全名。

f,ff,fff,ffff,fffff,ffffff,fffffff - 秒的分数。Fs 越多，精度越高。

h - 12 小时制，没有前导零。hh - 带前导零的 12 小时制。H - 24 小时制，没有前导零。HH - 带前导零的 24 小时制。

m - 没有前导零的分钟。mm - 带前导零的分钟。

M - 没有前导零的数字月份。MM - 带前导零的数字月份。MMM - 月份的缩写名称。MMMM - 完整的月份名称。

s - 没有前导零的秒数。ss - 前导零的秒数。

t - AM/PM 但只有第一个字母。tt - 上午/下午（上午/下午）

y - 没有世纪且前导零的年份。yy - 没有世纪的年份，前导零。yyyy - 带有世纪的年份。

zz - 时区偏移设置为 +/-。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:22:15.893

您的格式字符串错误。

“d”和“y”需要小写，所以

```
dd-MM-yyyy 
```

阅读MSDN 上有关[格式字符串的所有信息。](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx)

# javascript - 如何使用 jquery 将具有属性的元素添加到 SVG

> ID：11214481
> 
> 赞同：1
> 
> 时间：2012-06-26T19:18:59.843
> 
> 标签：javascript, jquery, svg, raphael, highcharts

我正在使用[Highcharts](http://www.highcharts.com/)，图表结果是 SVG 元素的集合，我试图`SVG`使用 jquery向其中添加一些元素

这是我尝试过的

```
function(chart) { // on chart load complete 
  $("#highcharts-0 Svg").
   append(document.createElementNS("http://www.w3.org/2000/svg", "rect"));
   $("#highcharts-0 Svg").find("rect").
   attr({x : 100 , y:100 , width : 100 , height : 100 });
   console.log($("#highcharts-0 Svg "));
                  }); 
```

我真的不能说这是否有效，我所能看到的只是`<rect></rect>`我的一个元素`DOM`，没有`attr` 其他通知是当我使用 chrome 控制台将鼠标悬停在这个元素上时，它会显示记录`x-0 , y=0`，

![在此处输入图像描述](../Images/937c323524a8e757734762af207225b8.png)

我有一个想法，jquery 不附加 svg 元素 hop 我错了

**问题**如何使用 jquery 将具有属性的元素添加到 SVG

**编辑**

现在有了帮助，我有了`id`元素，`rect`然后我尝试`attr`使用添加`id`，但失败了

[截屏](http://screencast.com/t/7m1q9OR1sfZ5)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T05:03:39.520

Highcharts 还有一个绘图 API，可用于绘制矩形。这也适用于 VML。[在http://jsfiddle.net/gh/get/jquery/1.7.1/highslide-software/highcharts.com/tree](http://jsfiddle.net/gh/get/jquery/1.7.1/highslide-software/highcharts.com/tree/master/samples/highcharts/members/renderer-rect-on-chart/)查看[http://www.highcharts.com/ref/#renderer](http://www.highcharts.com/ref/#renderer) => rect 和实时示例[/master/samples/highcharts/members/renderer-rect-on-chart/](http://jsfiddle.net/gh/get/jquery/1.7.1/highslide-software/highcharts.com/tree/master/samples/highcharts/members/renderer-rect-on-chart/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:34:55.417

正如您[在此处](http://www.highcharts.com/stock/ref/#element)看到的，没有属性`rx`and `ry`，尝试将其更改为`x`and `y`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:38:34.983

矩形具有 x 和 y 属性。rx 和 ry 用于圆圈。

另外，你确定你的选择器是正确的吗？您可能想要小写“Svg”

** 编辑 ** 屏幕截图中的矩形没有分配任何属性。没有宽度或高度，或 x/y 位置。您应该尝试在附加矩形时给它一个 id，并使用相同的 id 查询它。

请参阅： [https ://developer.mozilla.org/en/DOM/document.createElementNS](https://developer.mozilla.org/en/DOM/document.createElementNS)

你可以这样做：

```
var rect = document.createElementNS("http://www.w3.org/2000/svg","rect");
rect.id = 'your_id_here'; 
```

然后通过正常路线附加矩形。

请注意，由于您拥有原始 dom 元素，因此您也可以在那里分配其他属性。例如：

```
rect.x = 100;
rect.y = 100;
rect.fill = 'blue'; 
```

# php - 跟踪代码 Prestashop

> ID：11214487
> 
> 赞同：0
> 
> 时间：2012-06-26T19:19:25.057
> 
> 标签：php, prestashop

这是我在这里的第一个问题。

我对 Prestashop 很陌生。我正在尝试为联属网络营销计划安装跟踪代码，该代码允许我从订单确认页面（即嵌入代码的位置）检索信息。这是附属跟踪代码，你知道我应该用什么参数替换“”内的参数。prestashop 中的变量是什么？非常感谢您的友好回答

```
<script type="text/javascript">
//<![CDATA[
/*** Do not change ***/
var AWIN = {};
AWIN.Tracking = {};
AWIN.Tracking.Sale = {};

/*** Set your transaction parameters ***/
AWIN.Tracking.Sale.amount = 'SALE_AMOUNT';
AWIN.Tracking.Sale.currency = 'GBP';
AWIN.Tracking.Sale.orderRef = 'ORDER_REF';
AWIN.Tracking.Sale.parts = 'COMMISSION_GROUP:SALE_AMOUNT';
AWIN.Tracking.Sale.voucher = 'VOUCHER_CODE';
AWIN.Tracking.Sale.test = '1';
//]]>
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:32:42.280

您是否看到这篇文章：[http](http://wiki.affiliatewindow.com/index.php/Merchant_Tracking_Guide) ://wiki.affiliatewindow.com/index.php/Merchant_Tracking_Guide ？

来自它的例子：

```
AWIN.Tracking.Sale.amount = '100.00';
AWIN.Tracking.Sale.currency = 'GBP';
AWIN.Tracking.Sale.orderRef = '123456';
AWIN.Tracking.Sale.parts = 'DVD:25.00|VIDEO:25.00|CD:25.00|BOOK:25.00';
AWIN.Tracking.Sale.voucher = 'BOOK_VOUCHER1';
AWIN.Tracking.Sale.test = '0'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T12:38:00.817

这是对过去的人的回答：您在这里要解决的是修改模板文件中的 javascript 代码：确保在括号之间输出这些值并将模板输出转换为 javascript 数据，所以上面的代码可以发送正确的信息。

# android - 应用程序无错误关闭 - 在后台

> ID：11214488
> 
> 赞同：0
> 
> 时间：2012-06-26T19:19:25.100
> 
> 标签：android

我创建了一个简单的网络广播流媒体应用程序，我的应用程序用户告诉我，有时当他打开另一个应用程序（例如 Facebook 应用程序）时，我的应用程序会毫无错误地关闭。

如何追踪此事件？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:27:36.653

听起来您的应用只是在体验标准的[Activity 生命周期](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)。

当用户离开您的应用程序（例如打开 Facebook 应用程序）时，会调用 onStop()。从那里，应用程序可以重新启动，它可以坐在那里，也可以被销毁。

由于 Facebook 应用程序是相当资源密集型的，我猜测系统正在破坏您的应用程序，以便为 Facebook 应用程序或正在启动的任何其他应用程序释放资源。

如果您告诉我们更多关于您要完成的工作，我们可以就如何做到这一点提供更多建议。

# c++ - doxygen 外部变量索引

> ID：11214497
> 
> 赞同：2
> 
> 时间：2012-06-26T19:20:21.760
> 
> 标签：c++, c, doxygen

我刚开始使用 doxygen，可能并不熟悉所有可用的设置。我查看了配置文件中的所有标签和选项，但无法找到该操作的任何相关标签。

有没有办法强制 doxygen 在 C/C++ 中索引外部？现在它们只是简单地添加到源文件中的其他变量列表中。

编辑：从我目前所见，doxygen 根本不了解外部因素。它在 html 文件中为这些变量或函数生成对随机（首次看到）位置的引用

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T18:13:11.387

仅文件范围的局部变量被标记为静态，对吗？因此，当将 EXTRACT_STATIC 设置为 NO 时，您根本看不到它们。

也就是说：现在索引中的静态变量和外部变量之间没有明显的区别。我计划重新设计索引以使它们更具交互性，然后我会按照您的意愿进行（即能够过滤静态与外部）。如果您想在发生这种情况时收到通知，请在 doxygen 的错误跟踪器中提交严重性设置为增强的错误报告。

# c - 将标准输出捕获为字符串并将其输出回 C 中的标准输出

> ID：11214498
> 
> 赞同：2
> 
> 时间：2012-06-26T19:20:35.080
> 
> 标签：c, redirect, stdout

使用C语言。我有一个写入标准输出的函数。

我想捕获该输出，对其进行一些修改（替换一些字符串）。然后再次将其输出到标准输出。所以我想开始：

```
char huge_string_buf[MASSIVE_SIZE];
freopen("NUL", "a", stdout); -OR- freopen("/dev/null", "a", stdout);
setbuf(stdout, huge_string_buffer);
/* modify huge_string_buffer */ 
```

现在的问题是，如何将 huge_string_buffer 输出回原始标准输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T00:31:42.840

一种想法是模仿标准 Unix 实用程序的功能`tee`，但完全在您的程序中这样做，而不依赖于外部重定向。

所以我写了一个简单的函数，`mytee()`，它似乎工作。它使用`shmget(), pipe(), fork(), and dup2()`：

```
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <sys/shm.h>

static char *mytee(int size) {
   int shmid = shmget(IPC_PRIVATE, size + 1, 0660 | IPC_CREAT);
   int pipe_fds[2];
   pipe(pipe_fds);

   switch (fork()) {
      case -1:                      // = error
         perror("fork");
         exit(EXIT_FAILURE);
      case 0: {                     // = child
         char *out = shmat(shmid, 0, 0), c;
         int i = 0;
         out[0] = 0;
         dup2(pipe_fds[0], 0);      // redirect pipe to child's stdin
         setvbuf(stdout, 0, _IONBF, 0);
         while (read(0, &c, 1) == 1 && i < size) {
            printf("<%c>", c);      // pass parent's stdout to real stdout,
            out[i++] = c;           // and then buffer in mycapture buffer
            out[i] = 0;             // (the extra <> are just for clarity)
         }
         _exit(EXIT_SUCCESS);
      }
      default:                      // = parent
         dup2(pipe_fds[1], 1);      // replace stdout with output to child
         setvbuf(stdout, 0, _IONBF, 0);
         return shmat(shmid, 0, 0); // return the child's capture buffer
   }
} 
```

我的测试程序是：

```
int main(void) {
   char *mycapture = mytee(100);    // capture first 100 bytes
   printf("Hello World");           // sample test string
   sleep(1);
   fprintf(stderr, "\nCaptured: <%s>\n", mycapture);
   return 0;
} 
```

输出是：

> ```
> <H><e><l><l><o>< ><W><o><r><l><d>
> Captured: <Hello World> 
> ```

要在您的应用程序中使用它，`mytee()`您需要将 test 语句替换`printf("<%c>", c)`为`write(1, &c, 1)`. 并且您可能需要在对 . 的调用中处理信号`read`。在这两个之后`dup2()`，您可能需要添加：

```
 close(pipe_fds[0]);
  close(pipe_fds[1]); 
```

有关此类内容的参考资料，请参阅Dave Curry撰写的 27 年历史的 220 页 O'Reilly 的《*在 Unix 系统上使用 C 语言》*[一书。](http://shop.oreilly.com/product/9780937175231.do)

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:34:00.973

Unix 做到这一点的方法实际上就是编写一个小程序来完成您需要的输入处理，然后在命令行上将其他程序的输出通过管道传递给它。

如果您坚持将其全部保存在您的 C 程序中，那么我要做的是重写该函数以使其将其输出发送到给定的 char 缓冲区（最好`return`是缓冲区`char *`），以便可以将其发送到 stdout 或进行处理如客户所愿。

例如，旧方式：

```
void usage () {
    printf ("usage: frob sourcefile [-options]\n");
} 
```

...和新的方式：

```
char * usage(char * buffer) {
    strcpy (buffer, "usage: frob sourcefile [-options]\n");
    return buffer;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:25:02.747

我真的不喜欢带有文件描述符的棘手游戏。您不能修改该函数，以便它以其他方式返回其数据，而不是写入标准输出？

如果您无权访问源代码，并且您不能这样做，那么我建议将写入 stdout 的代码分解为一个小的单独程序，并将其作为另一个进程运行。从进程重定向输出（可能通过命名管道）既简单又干净，然后从接收数据的进程输出到标准输出就没有问题了。

此外，根据您希望进行的编辑类型，您最好使用 Python 等高级语言来编辑数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T19:34:09.527

```
char huge_string_buf[MASSIVE_SIZE];
FILE stdout_ori=fdopen(stdout,"a");
freopen("NUL", "a", stdout); -OR- freopen("/dev/null", "a", stdout);
setbuf(stdout, huge_string_buffer);
/* modify huge_string_buffer */
//Write to stdout_fdopen 
```*

# ruby-on-rails - 可排序的列和在索引布局上显示关联

> ID：11214503
> 
> 赞同：0
> 
> 时间：2012-06-26T19:21:11.243
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个我敢肯定的问题......

我有一个视图，其中显示了交付给客户的产品列表。我使用了几个 Ryan Bates 的 railscasts 作为模型，用于具有搜索字段和可排序的列以及分页。

分页和搜索工作正常。但是，我有两个我似乎找不到的问题：

1) 如果我尝试为产品显示客户的姓名，而不是他们的 ID，我会收到一条错误消息，指出未定义“名称”方法。

2）当我单击列标题以更改排序顺序时，没有任何反应。

这是我的代码：

**产品控制器：**

```
class ProductsController < ApplicationController
  # GET /products
  # GET /products.json

  helper_method :sort_column, :sort_direction

  def index
    @products = Product.search(params[:search]).order(sort_column + " " +    sort_direction).paginate(:per_page => 25, :page => params[:page])

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @products }
    end
  end
  .
  .
  .
 private
   def sort_column
    Product.column_names.include?(params[:sort]) ? params[:sort] : "name"
   end

  def sort_direction
    %w[asc desc].include?(params[:direction]) ? params[:direction] : "asc"
  end
end 
```

**产品型号：**

```
# == Schema Information
#
# Table name: products
#
#  id             :integer(4)      not null, primary key
#  name           :string(255)
#  serial_number  :string(255)
#  date_ordered   :date
#  date_received  :date
#  date_invoiced  :date
#  vendor_invoice :string(255)
#  scc_invoice    :string(255)
#  quantity       :integer(10)
#  dollar_amount  :integer(10)
#  warranty_years :integer(4)
#  warranty_days  :integer(4)
#  item           :integer(4)
#  comments       :text
#  created_at     :datetime        not null
#  updated_at     :datetime        not null
#  vendor_id      :integer(4)
#  customer_id    :integer(4)
#  category_id    :integer(4)
#  department     :string(255)
#

class Product < ActiveRecord::Base
  attr_protected :id

  belongs_to :customer
  belongs_to :vendor
  belongs_to :category

  def self.search(search)
      if search
          where('name LIKE ?', "%#{search}%")
      else
          scoped
      end
  end
end 
```

**产品索引视图：**

```
<% title "Products" %>

<%= form_tag products_path, :method => 'get', :id => "products_search" do %>
    <p>
        <%= text_field_tag :search, params[:search] %>
        <%= submit_tag "Search", :name => nil%>
    </p>
    <div id="products"><%= render 'products' %></div>
<% end %>

<p><%= link_to 'Add Product', new_product_path %></p> 
```

**产品部分视图：_products.html.erb**

```
<%= hidden_field_tag :direction, params[:direction] %>
<%= hidden_field_tag :sort, params[:sort] %>

<table class="pretty">

  <tr>
    <th><%= sortable "name" %></th>
    <th><%= sortable "serial_number" %> </th>
    <th><%= sortable "date_invoiced" %></th>
    <th>Scc invoice</th>
    <th>Customer</th>
    <th></th>
    <th></th>
  </tr>

  <% for product in @products %>

  <tr>
    <td><%= product.name %></td>
    <td><%= product.serial_number %></td>
    <td><%= product.date_invoiced %></td>
    <td><%= product.scc_invoice %></td>
    <td><%= product.customer.name %></td>
    <td><%= link_to 'Show', product %></td>
    <td><%= link_to 'Edit', edit_product_path(product) %></td>
  </tr>

<% end %>

<%= will_paginate @products %> 
```

我不确定其他人可能需要什么来了解正在发生的事情，所以如果需要更多信息，请告诉我。

这是我在服务器运行时看到的内容：

在 2012-06-27 14:04:11 -0600 开始 GET "/products" for 127.0.0.1 连接到由 database.yml 指定的数据库 由 ProductsController#index 处理为 HTML ←[1m←[36mProduct Load (60.0ms)← [0m ←[1mSELECT `products`.* FROM `products`ORDER BY name asc LIMIT 25 OFFSET 0←[0m ←[1m←[35m (0.0ms)←[0m SELECT COUNT( *) FROM `products` ←[1m←[36mCustomer Load (0.0ms)←[ 0m ←[1mSELECT `customers`.* 从哪里来。`customers`_ = 0 LIMIT 1←[0m 渲染产品/_products.html.erb (535.0ms) 在布局/应用程序中渲染产品/index.html.erb (660.0ms) 895ms 内完成 500 内部服务器错误`customers``id`

ActionView::Template::Error ( `name' for nil:NilClass): 20: <td><%= product.serial_number %></td> 21: <td><%= product.date_invoiced %></td> 22: <td><%= product.scc_invoice %></td> 23: <td><%= product.customer.name unless product.customer.name.nil? %></td> 24: <td><%= link_to 'Show', product %></td> 25: <td><%= link_to 'Edit', edit_product_path(product) %></td> 26: </tr> app/views/products/_products.html.erb:23:in`_app_views_products__products_html_erb__429528032_35444568' app/views/products/_products.html.erb:16:in `_app_views_products__products_html_erb__429528032_35444568' app/views/products/index.html.erb:8:in`block in _app_views_products_index_html_erb_27575616' app/views/products/index.html.erb' `_app_views_products_index_html_erb___506300995_27575616' app/controllers/products_controller.rb:11:in`: in block in

渲染 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2.5/lib/action_dispatch/middleware/template s/rescues/_trace.erb (5.0ms) 渲染 C:/ RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2.5/lib/action_dispatch/middleware/template s/rescues/_request_and_response.erb (5.0ms) 渲染 C:/RailsInstaller/Ruby1。救援/布局中的 9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2.5/lib/action_dispatch/middleware/template s/rescues/template_error.erb (65.0ms)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:34:39.897

好的，从您的堆栈跟踪中我们可以看到：

```
name' for nil:NilClass) 
```

这意味着您的客户对象为空。因此 SQL 不会返回附加到您的产品对象的客户对象。

你的代码在这里：

```
<%= product.customer.name unless product.customer.name.nil? %> 
```

没有捕捉到它，因为您正在测试 name 属性上的 nil，而不是 customer 对象

```
<%= product.customer.name unless product.customer.nil? %> 
```

这应该可以修复错误，但您仍然看不到客户名称！

要真正解决您的问题，您必须在模型代码中验证产品和客户之间的关系，并调试从中获得的 SQL，以确保看到产品和客户之间的 JOIN。

检查您是否有一个 has_many ：在客户对象中声明的产品。

更新：我还在您的产品模型中看到您在产品表中声明了 customer_id？！这意味着您的产品只能有 1 个客户！！！不确定是不是你想要的！;-)

这是 Rails[关系指南](http://guides.rubyonrails.org/association_basics.html)上的链接，这是我使用 Rails 时的圣经

更新 2 在查看 Active Record Query 界面后，为了得到我认为你想要的，你应该做这样的事情：

```
Products.joins(:customer).where("name like ?", %#{search}%) 
```

# c# - c# WPF 列表框：n 个列表，n 个组

> ID：11214511
> 
> 赞同：1
> 
> 时间：2012-06-26T19:21:23.620
> 
> 标签：c#, wpf, list, listbox, grouping

我有三个不同的列表集合。

如何在三组中的一个 ListBox 中显示它们？

```
List<string> pending;
List<string> busy;
List<string> completed; 
```

最终结果应该是这样的：vbcity.com/cfs-file.ashx/__key/...。但我发现的唯一例子是使用一个列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:56:35.350

为您的 xaml 代码中的数据模板创建一个带有 Listview 的列表框：

```
<Grid>
    <ListBox Height="100" HorizontalAlignment="Left" Margin="10,10,0,0" Name="lbxTasks"    VerticalAlignment="Top" Width="120">
        <ListBox.GroupStyle>
            <GroupStyle />
        </ListBox.GroupStyle>
        <ListBox.ItemTemplate>
            <DataTemplate>
                <ListView ItemsSource="{Binding Queue}" BorderThickness="0"/>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox>
</Grid> 
```

然后为您的代码创建并绑定列表。这是一个测试示例：

```
namespace WpfApplication3
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        List<string> pending = new List<string> {"1","2"};
        List<string> busy = new List<string> { "4", "5" };
        List<string> completed = new List<string> { "7", "8" };

        private List<Tasks> MyTasks()
        {
            List<Tasks> tasks = new List<Tasks>();
            tasks.Add(new Tasks {Status = "Pending", Queue = pending});
            tasks.Add(new Tasks {Status = "Busy",Queue = busy});
            tasks.Add(new Tasks {Status = "Completed", Queue = completed});
            return tasks;
        }

        private void Window_Loaded(object sender, RoutedEventArgs e)
        {
            ICollectionView _tasksView = CollectionViewSource.GetDefaultView(MyTasks());
            _tasksView.GroupDescriptions.Add(new PropertyGroupDescription("Status"));
            lbxTasks.ItemsSource = _tasksView;
        }
    }

    public class Tasks
    {
        public List<string> Queue { get; set; }
        public string Status { get; set; }
    }
} 
```

这将为您提供的每个队列（或列表）创建一个列表框，并按列表的名称对其进行分组。

输出：

![Output of the application](../Images/be546ef80fdafd447122eeae419d906a.png)

SOURCE: Modified the example from the link below into this format. [LISTBOX grouping using collectionView Source](https://stackoverflow.com/questions/10748385/listbox-grouping-using-collectionview-source)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:23:46.697

您可以使用 ListView 轻松地将它们分组。

[如何：对 Windows 窗体 ListView 控件中的项目进行分组](http://msdn.microsoft.com/en-us/library/ezh1batz.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:24:00.900

您可以单独添加它们，当您完成第一组时，添加一个具有 null 或空字符串值和“------”作为显示值的项目，这将向用户指示分离。

# javascript - 转到另一个网页后 iframe 大小保持不变

> ID：11214514
> 
> 赞同：-1
> 
> 时间：2012-06-26T19:21:51.413
> 
> 标签：javascript, html, cordova

我正在使用 phonegap 制作 iPhone 应用程序，但遇到了 html/javascript 问题。我的 index.html 中有一个 iFrame 来显示第三方网站。我的问题是当用户单击该网站起始页中的链接并转到另一个网页时，iFrame 大小与具有起始页时的大小保持相同。因此，如果新页面比起始页面短，那么下面会有一个空白区域。有没有什么办法解决这一问题？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T20:10:57.787

您可以使用该iframe 的[onload 事件](http://www.w3schools.com/jsref/event_frame_onload.asp)。每次在 iframe 中完全加载页面时都会触发它。你可以试试[这个简单的例子](http://jsfiddle.net/45HKA/)。它会在每次重新加载时发出警报。只需单击 iframe 内的链接即可查看警报框。

```
<script type="text/javascript">
function load()
{
    alert("Iframe is loaded");
}
</script>
</head>

<iframe onload="load()" src="whatever">
<p>Your browser does not support iframes.</p>
</iframe> 
```

# mysql - 在 Rake 任务中关闭 MySQL 连接

> ID：11214518
> 
> 赞同：1
> 
> 时间：2012-06-26T19:21:59.987
> 
> 标签：mysql, ruby-on-rails-3

我有一个类似于[Resque 中描述的问题正在返回 Mysql2::Error: closed MySQL connection: SHOW FIELDS FROM `users`](https://stackoverflow.com/questions/9543007/resque-is-returning-mysql2error-closed-mysql-connection-show-fields-from-us)。

就我而言，我在长时间运行的 Rake 任务（3 个多小时）中看到了它。基本上，该任务从 csvs 导入数据运行，然后突然开始吐出“关闭的 MySQL 连接”错误。这只发生在我们使用远程 MySql 的暂存环境中，无法在本地复制。

所以我的问题是，为什么 Rails 应用程序（使用相同的连接属性）可以运行几天而没有问题，但我的数据导入任务在几个小时后就爆炸了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T15:40:16.127

您的连接超时。这在使用 mysql 驱动程序的长时间运行的 rake 任务上总是发生。尝试在你的 database.yml 中设置重新连接标志

[http://guides.rubyonrails.org/2_3_release_notes.html#reconnecting-mysql-connections](http://guides.rubyonrails.org/2_3_release_notes.html#reconnecting-mysql-connections)

基本上只需添加：

```
reconnect: true 
```

我很惊讶这没有更多的记录，因为我一直遇到它。如果这不起作用，请尝试显式调用

```
ActiveRecord::ConnectionAdapters::ConnectionHandler#verify_active_connections! 
```

# php - 在 lat,lng 范围内查询

> ID：11214519
> 
> 赞同：1
> 
> 时间：2012-06-26T19:22:05.207
> 
> 标签：php, postgresql, google-maps, google-maps-api-3

我从客户端的谷歌地图通过 xhr 获取 lat/lng 边界到我的 php 脚本。这是一个 sql 查询来搜索该范围内的位置。我的表存储`lat, lng`为不同的列。现在如何安排我的 where 查询，以便只`NE, SW`返回指定范围内的点。

在数据库中它存储为`number`，我不知道是否已经有任何 postgresql 特定的聚合函数来做同样的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:36:48.347

我错过了什么吗？这只是一个矩形边界检查。这不像你需要计算点之间的距离。

```
WHERE lat BETWEEN lat_of_corner_a AND lat_of_corner_b
  AND lon BETWEEN lon_of_corner_a AND lon_of_corner_b 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-24T03:48:17.497

我在这里发布了工作解决方案： [Get all records from MySQL database that are within Google Maps .getBounds?](https://stackoverflow.com/questions/4834772/get-all-records-from-mysql-database-that-are-within-google-maps-getbounds/20741219#20741219)

Alex 的解决方案仅在美国有效，特别是在北半球西部地区（递减值符合 Google 提供 bouds 值的顺序。

这个适用于世界上另外 3/4 的地区。

```
SELECT * FROM tilistings WHERE
(CASE WHEN a < c
        THEN lat BETWEEN a AND c
        ELSE lat BETWEEN c AND a
END) 
AND
(CASE WHEN b < d
        THEN lng BETWEEN b AND d
        ELSE lng BETWEEN d AND b
END) 
```

（有关详细信息，请参阅链接的帖子）

# facebook - 动态 OpenGraph 元标记不会解析

> ID：11214521
> 
> 赞同：0
> 
> 时间：2012-06-26T19:22:10.353
> 
> 标签：facebook, comments, meta-tags

我无法让 Facebook 识别我的社交评论插件的 OpenGraph 元标记。我在这里和谷歌上彻底研究了这个问题。

我已尝试按照此问题的其他几个实例中的建议设置 content-length 标头。我还尝试确保 fb:comments href 与 og:url 完全相同。这些都不允许 Facebook 识别我的元标签。

页面标签 URL：
[http ://www.facebook.com/pages/Telenova-IP-Services/287547201338150?sk=app_348971505174676](http://www.facebook.com/pages/Telenova-IP-Services/287547201338150?sk=app_348971505174676)

调试器的 URL：
[http ://apps3.ionflo.com/photocontest/index.php?type=restaurant&id=287547201338150-IPUTI8K7EGYMSTBU](http://apps3.ionflo.com/photocontest/index.php?type=restaurant&id=287547201338150-IPUTI8K7EGYMSTBU)

文件/index.php：

```
97 $cody = array(
98         'title' => $TitleShare,
99         'description' => $DescriptionShare,
100         'type' => 'restaurant');

117         <!-- Open Graph meta tags -->
118         <meta property="fb:app_id" content="348971505174676" />
119         <meta property="og:site_name" content="Test Site Name"/>
120         <meta property="og:url" content="<?php echo $AbsoluteURL; ?>index.php?type=    <?php echo $params['type']; ?>&id=<?php echo $PageID . '-' . $CommentRandomVal; ?>"/>
121         <meta property="og:title" content="<?php echo $cody['title']; ?>"/>
122         <meta property="og:description" content="<?php echo $cody['description']; ?>"/>
123         <meta property="og:type" content="<?php echo $cody['type']; ?>"/>
124         <meta property="og:locale" content="<?php echo $params['locale']; ?>"/>
125         <meta property="og:image" content="<?php echo $AbsoluteURL; ?>images/facebook.png"/> 
```

文件：包括/home.php

```
24          <fb:comments href="<?php echo $AbsoluteURL; ?>index.php?type=<?php echo     $params['type']; ?>&id=<?php echo $PageID . '-' . $CommentRandomVal; ?>" num_posts="3000"     width="800"> 
```

有关代码的完整副本，请参阅：

http //apps3.ionflo.com/photocontest/index.bak

http //apps3.ionflo.com/photocontest/include/home.bak

如果我遗漏了任何其他有用的信息，请告诉我，我很乐意更新帖子。

干杯，

科迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T15:41:31.047

URL 不包含正确的 PageID 以提取元标记。

通过确保我们将 PageID 作为 get 变量正确传递到页面中来解决

EG ?PageID= ***** ** *****

干杯。

# java - 有哪些方法可以公开 SOAP 接口上的文档？

> ID：11214528
> 
> 赞同：1
> 
> 时间：2012-06-26T19:22:48.877
> 
> 标签：java, soap, documentation, wsdl

我正在尝试公开 SOAP 服务的文档（如 Javadocs）。最好的情况是，它要么直接从 WSDL 公开，要么通过自动生成的报告公开。我使用 CXF 作为我的 SOAP 实现。

我曾尝试使用[此处](http://tomi.vanek.sk/index.php?page=wsdl-viewer)找到的 WSDL 查看器，但我没有找到一个很好的教程来说明如何注释我的方法以获取在他的示例中看到的结构和详细程度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:09:02.333

到目前为止，我发现的最佳解决方案是使用称为 Enunciate ( [http://enunciate.codehaus.org/](http://enunciate.codehaus.org/) ) 的引擎。一旦添加到项目中，它就会读取 JavaDocs 并编写一组 HTML 文件。我不完全理解所有的功能或问题（它生成并链接到它自己的 WSDL，这并不理想，并且在项目的一个额外文件夹中执行“临时工作”，然后读取为错误，除非被删除） ，但它确实以清晰和可用的方式成功地读取和公开了 JavaDocs。

# apache - 使用 apache mod-rewrite 重定向用户请求

> ID：11214529
> 
> 赞同：0
> 
> 时间：2012-06-26T19:22:50.447
> 
> 标签：apache, mod-rewrite

我有以下重写规则将所有内容重定向到 index.php

```
RewriteEngine On
RewriteCond %{REQUEST_URI} (/[^.]*|\.)$ [NC]
RewriteRule .* index.php [L] 
```

现在我需要修改它以支持以下当用户尝试访问 domain.tld 将他重定向到 www.domain.tld 当用户尝试访问 domain.tld/key/... 将他（永久重定向）重定向到 key.domain .tld/...

当然，我仍然需要将所有流量重定向到 index.php，除非用户尝试访问我需要直接为它们提供服务的 css、javascript 和图像

domain.tld/css/... subdomain.domain.tld/css/... apache 应该直接提供 url (css 文件) 同样我需要添加 js 和 images 文件夹

我对 Apache ReWrite 模块感到很糟糕，所以请在这里帮助我 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:33:03.230

```
<IfModule mod_rewrite.c>
  RewriteEngine on

  RewriteCond %{REQUEST_FILENAME} !-f #if a file, css, js, jpg whatever file
  RewriteCond %{REQUEST_FILENAME} !-d #if thats a directory

RewriteCond %{HTTP_HOST} !^www\.example\.com$ [NC]
RewriteCond %{HTTP_HOST} ^(www\.)?([^\.]+)\.example\.com$ [NC]
RewriteRule ^$ /someprofile.php?username=%2 [QSA,L]

</IfModule> 
```

# c# - GZipStream 只解压第一行

> ID：11214534
> 
> 赞同：1
> 
> 时间：2012-06-26T19:23:00.883
> 
> 标签：c#, compression, gzipstream

我的 GZipStream 只会解压缩文件的第一行。通过 7-zip 提取内容按预期工作，并为我提供了整个文件内容。它还使用 cygwin 和 linux 上的 gunzip 按预期提取，所以我希望这是特定于 O/S 的（Windows 7）。

我不确定如何解决这个问题，所以任何关于这方面的提示都会对我有很大帮助。[听起来与此](https://stackoverflow.com/questions/11204330/decompressing-using-gzipstream-returns-only-the-first-line)非常相似，但使用 SharpZLib 会产生相同的结果。

这就是我正在做的事情：

```
var inputFile = String.Format(@"{0}\{1}", inputDir, fileName);
var outputFile = String.Format(@"{0}\{1}.gz", inputDir, fileName);
var dcmpFile = String.Format(@"{0}\{1}", outputDir, fileName);

    using (var input = File.OpenRead(inputFile)) 
    using (var fileOutput = File.Open(outputFile, FileMode.Append))
    using (GZipStream gzOutput = new GZipStream(fileOutput, CompressionMode.Compress, true))
    {
        input.CopyTo(gzOutput);
    }

// Now, decompress
using (FileStream of = new FileStream(outputFile, FileMode.Open, FileAccess.Read))
using (GZipStream ogz = new GZipStream(of, CompressionMode.Decompress, false))
using (FileStream wf = new FileStream(dcmpFile, FileMode.Append, FileAccess.Write))
{
    ogz.CopyTo(wf); 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T19:30:59.053

您的输出文件仅*包含*一行（gzipped） - 但它包含除换行符之外的*所有文本数据。*

您反复调用`ReadLine()`which 返回一行*没有*换行符的文本并将该文本转换为字节。因此，如果您有一个输入文件，其中包含：

```
abc
def
ghi 
```

你最终会得到一个输出文件，它是

```
abcdefghi 
```

如果您不想要这种行为，为什么还要`StreamReader`首先经历 a 呢？一次只需从输入`FileStream`直接复制到`GZipStream`a 块，或者`Stream.CopyTo`如果您使用的是 .NET 4，则使用：

```
// Note how much simpler the code is using File.*
using (var input = File.OpenRead(inputFile))
using (var fileOutput = File.Open(outputFile, FileMode.Append))
using (GZipStream gzOutput = new GZipStream(os, CompressionMode.Compress, true)) 
{
    input.CopyTo(gzOutput);
} 
```

另请注意，*附加*到压缩文件很少是一个好主意，除非您对单个文件中的多个“块”进行了某种特殊处理。

# java - 有没有办法使用 jersey 和 guice 在 url 开头处理额外的斜杠？

> ID：11214542
> 
> 赞同：1
> 
> 时间：2012-06-26T19:23:45.860
> 
> 标签：java, jakarta-ee, jersey, guice, guice-servlet

我有一个 REST api，使用 jersey 和 guice 进行依赖注入。一切都很好，我打开了 FEATURE_CANONICALIZE_URI_PATH 和 FEATURE_NORMALIZE_URI 并且在几乎所有情况下都可以处理额外的斜杠。例如：

```
http://localhost:8080/my_service/param1//param2 
```

问题是我无法找出正确的方法来处理 url 开头的额外斜杠（在服务路径之前）。像这样：

```
http://localhost:8080//my_service/param1/param2 
```

这就是我目前设置东西的方式：

web.xml

```
<filter>
    <filter-name>guiceFilter</filter-name>
    <filter-class>com.google.inject.servlet.GuiceFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>guiceFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<listener>
    <listener-class>MyServletConfig</listener-class>
</listener> 
```

MyServletConfig.java

```
public class MyServletConfig extends GuiceServletContextListener {
    @Override
    protected Injector getInjector() {
        return Guice.createInjector(new JerseyServletModule() {
            @Override
            protected void configureServlets() {
                bind(MyService.class);

                guiceContainerConfig.put(ResourceConfig.FEATURE_NORMALIZE_URI, "true");
                guiceContainerConfig.put(ResourceConfig.FEATURE_CANONICALIZE_URI_PATH, "true");

                serve("/*").with(GuiceContainer.class, guiceContainerConfig);
            }
        });
    }
} 
```

我的服务.java

```
@Path("/")
public class MyService {
    @GET
    @Path("/{param1}/{param2}")
    @Produces("application/json")
    public String get(
            @PathParam("param1") final String param1,
            @PathParam("param2") final String param2) {

        return "{\"param1\":\"" + param1 + "\"}";
    }
} 
```

我可以看到问题实际上是在服务名称之前带有 // 的请求实际上并没有被 servlet 处理，因为它在过滤器映射的 url-mapping 中不匹配，但我只是不太确定正确的解决方案。在该 url 与 servlet 匹配之前，我是否需要进行 url 重写，或者是否有更好的方法来映射请求 url？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-26T12:21:15.593

快速引导：

[http://tukey.org/urlrewrite/](http://tuckey.org/urlrewrite/)是一个 java web 过滤器。它是一个非常强大的工具，就像 Apache 的 mod_rewrite 一样。[使用来自http://www.mydigitallife.info/redirect-or-rewrite-to-remove-double-or-multiple-slashes-in-url/](http://www.mydigitallife.info/redirect-or-rewrite-to-remove-double-or-multiple-slashes-in-url/)的经典 htaccess 重写设置过滤器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-08T15:42:58.707

如果您使用的是码头，只需添加模块[`rewrite-compactpath`](https://www.eclipse.org/jetty/documentation/9.4.x/startup-modules.html)。

> ```
>  Module: rewrite-compactpath
>        : Add a rule to the rewrite module to compact paths so that double slashes
>        : in the path are treated as a single slash.
>  Depend: rewrite
>     XML: etc/rewrite-compactpath.xml 
> ```

# asp.net-web-api - 使用 HttpRequestMessage 发送空内容

> ID：11214543
> 
> 赞同：0
> 
> 时间：2012-06-26T19:23:46.017
> 
> 标签：asp.net-web-api

处理 HttpRequestMessage 时，Content 字段是否始终必须为非空？如果是，那么如果我想发送一个空的身体怎么办？如何指定？

例如，使用 DELETE 或 GET 请求。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T09:14:13.083

它绝对应该允许一个空的内容。正如您非常正确地指出的那样，DELETE 和 GET 从来没有内容主体，并且对于 POST 也没有严格的要求。

我通常使用 HttpClient，并且只使用一个空的 StringContent，例如

```
var response = _connection.Client.PostAsync(path, new StringContent(string.Empty)).Result; 
```

# wpf - 在没有新窗口的情况下加载 XAML 内容

> ID：11214545
> 
> 赞同：0
> 
> 时间：2012-06-26T19:23:48.520
> 
> 标签：wpf, xaml, window

我正在尝试找到一种方法来更改 WPF 中窗口的内容，而无需加载新窗口。在大多数情况下，以下工作正常：

```
dim x as new window 
x.show()
me.close 
```

有没有办法做类似下面的事情？

```
dim x as new window 
me.content = x 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-17T20:05:55.400

这个答案有点延迟。我遇到了需要更改窗口的全部或部分内容的情况，因此正如 wpf-it 所建议的那样 - 我使用了 ContentControl。

我在其中使用的窗口正在与条形码扫描仪一起使用。我们有一些项目类型，可以使用一组不同的选项进行扫描，并为每种类型提供所需的显示。由于我们的应用程序是用 MVVM 模式编写的（或者至少...... MVVM-esque ;)）我创建了一些 XAML：

```
<ContentControl Grid.Row="2" Content="{Binding itemOptions}" /> 
```

然后绑定到这个属性：

```
 Public ReadOnly Property itemOptions As UserControl
        Get
            Select Case SearchResult.GetType()
                ' Part
                Case GetType(partHeaderModel)
                    Try
                        Return New partOptions
                    Catch ex As Exception
                        ' Fail
                        ' Return New noResults
                    End Try

                    ' Bin
                Case GetType(binModel)
                    Try
                        Return New binOptions
                    Catch ex As Exception
                        ' Fail
                        Return New noResults
                    End Try

                    ' Rack
                Case GetType(rackModel)
                    Try
                        Return New rackOptions
                    Catch ex As Exception
                        ' Fail
                        Return New noResults
                    End Try

                Case Else
            End Select

            Return New noResults

        End Get
    End Property 
```

我有一个搜索功能，它根据用户扫描的项目类型返回一个数据模型。根据类型，select 语句返回属性用户控件。我使用 INotifyPropertyChanged 和扫描事件来更新窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T00:20:06.393

检查此主题：[如何获取对资源中元素的引用，WPF？](https://stackoverflow.com/questions/11216826/how-to-get-reference-to-element-in-resources-wpf/11217598#11217598)

阅读，它可以帮助.. 有成千上万的工作方式，所以你必须找到他或更好的。使用的一个旧概念是 MDI： http: [//www.codeproject.com/Articles/22927/Multiple-Window-Interface-for-WPF](http://www.codeproject.com/Articles/22927/Multiple-Window-Interface-for-WPF)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T06:03:01.687

如何在一个窗口中设置所有可能的窗口配置，并在需要时切换想要显示和不显示的任何内容的可见性？

这将使自定义而不是手动修改可视树更容易。但是请记住将任何面板保持虚拟化，否则您的性能可能会受到影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T08:10:58.197

您是否在 WPF 中探索`ContentPresenter`/选项？`ContentControl`在您的窗口中保留一个内容演示者/内容控件，并`Content`动态设置它们的属性......这样您就不需要重新加载窗口。

# javascript - 了解 javascript 原型

> ID：11214547
> 
> 赞同：3
> 
> 时间：2012-06-26T19:23:55.223
> 
> 标签：javascript, prototype-programming

我正在学习 JS Prototype。

如果我从其他构造函数（B）的实例设置构造函数（A）的原型，那么（B）实例是否会在 A 中引入共享属性？

**示例 1**

```
function A(){ 
    var private = '';

    this.getPrivate = function(){ 
        return private
    }; 

    this.setPrivate = function(_private){ 
        private = _private; 
    }; 
}

function B(){};

B.prototype = new A();

b1 = new B();
b2 = new B();

b1.setPrivate(new Date());
b2.getPrivate(); // Here `private` is behaving as singleton property. Why? 
```

**示例 2**

```
function A(){ 
    var private = '';
}

A.prototype.getPrivate = function(){ 
    return this.private
}; 

A.prototype.setPrivate = function(_private){ 
    this.private = _private; 
}; 

function B(){};

B.prototype = new A();

b1 = new B();
b2 = new B();

b1.setPrivate(new Date());
b2.getPrivate(); // This time private is not singleton property. 
```

我在玩它时发现了原型的这个新方面。

*   在示例 1 中，为什么`private`在 的不同实例之间共享属性`B`？
*   在示例 2 中，为什么`private`财产在两种情况下都具有独立存在？但是原始属性没有改变，但是 getter/setter 是通过原型定义的。
*   可以将示例 1 视为单例属性的实现吗？
*   通过实例进行原型设计和通过原型进行原型设计，有什么区别？例如
    `B.prototype = new A();`
    `B.prototype = (new A()).constructor.prototype`
*   原型设计的全部秘密是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:29:06.907

原型设计的秘密（解释了这一切）是**每个**实例`B`共享相同的原型，即原型**不会**复制到`B`. 当您触发 的**任何**实例的原型函数时`B`，您实际上一直在运行相同的函数。这就是复制“私有”变量的原因（实际上它没有被复制，您只是一直在引用同一个变量）。“非私有”变量的行为相同，不同之处在于关键字`this`指的是函数的当前“持有者”。这就是为什么在原型中调用`this`给我们一种原型方法实际上是对象的方法的错觉。它不是。

通过实例进行原型设计被认为是不好的做法，因为实例可能具有或多或少的属性，具体取决于它们何时被调用以及何时进行原型设计。原型主要通过字面量对象创建**或**扩展其他对象的原型来定义。

最后：在某种意义上，原型设计可能被解释为单例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:32:29.320

1.  因为您正在继承锁定到特定闭包的特定实例。数据属于闭包而不是对象。对象的变量和属性之间存在巨大差异。

2.  这里`var private`根本不使用。当您`setPrivate()`在该点创建属性时。

3.  不，这只是由于闭包和对象模型之间的误解而造成的。你可以用一种更深思熟虑、更清晰的方式来做同样的事情：使用简单的对象字面量。

4.  不同之处在于，在第一个中你得到一个新对象，而在第二个中你有一个`A.prototype === B.prototype`所以修改一个会修改另一个，因为它们引用了同一个对象。

5.  对象继承自其他对象

这是一个很好的资源[https://developer.mozilla.org/en/JavaScript/Guide/Details_of_the_Object_Model](https://developer.mozilla.org/en/JavaScript/Guide/Details_of_the_Object_Model)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:38:01.397

> 在示例 1 中，为什么私有财产在 B 的不同实例之间共享？

是的，他们有

> 在示例 2 中，为什么私有财产在两种情况下都有独立存在？但是原始属性没有改变，但是 getter/setter 是通过原型定义的。

因为每个实例都独立于其他实例。如果这不是您想要的，请使用**对象文字**表示法来创建您的类。

> 可以将示例 1 视为单例属性的实现吗？

不，因为单例总是返回相同的对象实例。这与您的第二个问题有关，每个实例都是独立的。可以从您的第一个示例中创建该类的许多实例。要创建单例，存在**单例或模块模式**，它使用带有**分组运算符****的自调用**函数，例如.**`()`**

 **> 通过实例进行原型设计和通过原型进行原型设计，有什么区别？例如

使用`constructor`，您可以确保子类构造函数和父类之间没有混淆。扩展父类时也是同样的概念，在子类中你在子类的构造函数中构造父类。

> 原型设计的全部秘密是什么？

浏览各种 JS Ninja 博客上的好文章。我爱：

*   [完美技能网](http://perfectionkills.com)
*   [javascriptweblog.wordpress.com](http://javascriptweblog.wordpress.com)

这是一篇好文章：

*   [了解 JavaScript 原型。](http://javascriptweblog.wordpress.com/2010/06/07/understanding-javascript-prototypes/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T19:52:56.940

在示例 1 中，您使用闭包范围来引用私有。由于 A 仅实例化一次，因此定义了它的一个实例。

在示例 2 中，this.private 没有引用函数 A 中的 private 实例。事实上，由于您使用“this”这个词，它指的是对象的“this”。因此， this.private 要么意味着 b1.private 要么 b2.private 取决于功能。在示例 2 中，函数 A 中定义的私有在闭包范围内丢失，就好像它从未定义过一样。**

# c - C程序中设置的预处理器指令值

> ID：11214548
> 
> 赞同：-1
> 
> 时间：2012-06-26T19:23:56.843
> 
> 标签：c, c-preprocessor, preprocessor-directive

我想定义类似的东西

```
#define memoryAddress
main()
{
    bla bla bla;
    memory = endAddress- startAddress;
    #memoryAddress = memory;
} 
```

初始化预处理器指令是否可能/有效？基本上，如果需要，我想使用这个特定的指令来更新新的内存地址。例如：如果它是 C 代码中的变量，我会这样做

```
if(memoryAddress != memory)
memoryAddress=memory 
```

但是由于我想使用这个 memoryAddress 作为预处理器指令，所以我想知道执行上述代码的正确方法。因此，在编译过程开始之前，我将拥有该指令的默认地址，但稍后我想对其进行更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:33:23.150

使用全局变量并使用默认值对其进行初始化。然后您可以在运行时更改它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:28:34.557

预处理器指令由预处理器评估，它发生***在***编译之前。
因此，您尝试执行的操作（*使用在编译时而不是在编译之前已知的内容为指令赋值*）是不可能的。

# linq - 将 Oracle sysdate 与 Nhibernate Linq 一起使用

> ID：11214552
> 
> 赞同：0
> 
> 时间：2012-06-26T19:24:15.317
> 
> 标签：linq, nhibernate

在 Nhibernate 3.2 中创建 Linq 表达式时，有没有办法将 sysdate 作为生成的 sql 的一部分传递？

例如，像这样

```
from c in _session.Query<Question> 
where Question.EDate.Date = sysdate 
```

或者

```
from c in _session.Query<Question> 
where Question.Edate.Date == trunc(sysdate) 
```

生成一个选择语句，如：

```
select * from question where trunc(EDate) == trunc(sysdate) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T09:28:20.247

仅通过扩展 LINQ 提供程序（不是那么困难）：

[http://fabiomaulo.blogspot.pt/2010/07/nhibernate-linq-provider-extension.html](http://fabiomaulo.blogspot.pt/2010/07/nhibernate-linq-provider-extension.html) http://www.primordialcode.com/blog/post/nhibernate-3-extending-linq-provider-fix-notsupportedexception

# asp.net-mvc-3 - 如何连接文本和查看模型项

> ID：11214553
> 
> 赞同：1
> 
> 时间：2012-06-26T19:24:18.033
> 
> 标签：asp.net-mvc-3, view, string-concatenation

嗨，我正在尝试在 MVC 视图上加入两位信息，以在屏幕上创建一个长字符串。我在 <\a> 中有一些文本，在模型中有一个返回的变量（model.item.number）。

目前我认为有以下几点：

a>01643</a> @Html.DisplayFor(modelItem => item.phone)

这将返回正确的值，但在 01634 和 item.phone 值之间给出一个空格。我试过用 < a > 包裹整个东西，但无济于事。

我相信这在网络表单中非常简单和容易。有人可以让我摆脱痛苦，让我知道该怎么做。我是 MVC3 菜鸟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:25:36.143

删除空格：

```
a>01643</a>@Html.DisplayFor(modelItem => item.phone) 
```

或者，只写值：

```
a>01643< / a>@Html.DisplayText(Model.item.phone) 
```

# javascript - 有什么方法可以将'webkit-overflow-scrolling：touch'与javascript内联？

> ID：11214554
> 
> 赞同：4
> 
> 时间：2012-06-26T19:24:22.960
> 
> 标签：javascript, ios, safari, webkit

无法通过 jquery 或本机 javascript 在 DOM 中显示此属性。jquery 似乎不支持它，我找不到有效的本机名称/语法。有什么帮助吗？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T14:14:02.837

正确的语法是

```
el.style.WebkitOverflowScrolling = 'touch'; // capital W 
```

这（几乎）就像从 css 到 JS 的通常命名约定一样，比如border-top 正在变成borderTop，......只是webkit 的东西得到了一个大写的第一个字母。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:29:16.047

使用 JavaScript，您需要将破折号替换`-`为以下大写字母，例如：

```
var el = document.getElementById('element id');
el.style.webkitOverflowScrolling = 'touch'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-14T04:25:50.027

在 JavaScript 中使用 style 属性时，破折号后的字母大写，因此 -webkit-overflow-scrolling 变为 WebkitOverflowScrolling 并确保也将溢出设置为滚动。

在这里试试：http: [//jsbin.com/civaha](http://jsbin.com/civaha)

由于弹跳，您可以判断它是触摸滚动。

资源：

```
<!doctype html>
<meta name=viewport content="initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
<title>set touch scrolling in JavaScript - robocat</title>

<script>
function makeScrollable(event) {
    var style = event.target.style;
    style.overflow = 'scroll';
    style.WebkitOverflowScrolling = 'touch'; 
    style.backgroundColor = 'lightyellow';
}
</script>

<body style="margin:0;overflow:hidden;">

<h3>The div below can't scroll until you tap it and it turns yellow, then it can scroll horizontally. . . . </h3>

<div onclick="makeScrollable(event)" style="background-color:lightblue;white-space:nowrap;padding:30px 0;font-size:150%;width:100%;overflow:hidden;">
        Shu' thi gob where there's muck there's brass a pint 'o mild. Be reet will 'e 'eckerslike by 'eck chuffin' nora that's champion. What's that when it's at ooam god's own county. Tha knows nay lad. What's that when it's at ooam. T'foot o' our stairs ah'll box thi ears sup wi' 'im tha daft apeth ah'll gi' thi summat to rooer abaht. Th'art nesh thee ne'ermind. Eeh. How much ah'll gi' thi summat to rooer abaht where's tha bin ne'ermind. How much gerritetten nobbut a lad. Face like a slapped arse bobbar cack-handed. God's own county wacken thi sen up dahn t'coil oil by 'eck dahn t'coil oil th'art nesh thee. A pint 'o mild. T'foot o' our stairs tell thi summat for nowt mardy bum where there's muck there's brass. Chuffin' nora. Sup wi' 'im sup wi' 'im nah then. Dahn t'coil oil tha what will 'e 'eckerslike ah'll learn thi. A pint 'o mild chuffin' nora tha daft apeth shurrup michael palin. Ah'll gi' thi summat to rooer abaht tha what nah then tha knows. Dahn t'coil oil breadcake where's tha bin eeh. Breadcake how much. Bobbar be reet soft southern pansy. Is that thine. God's own county shu' thi gob mardy bum a pint 'o mild. Soft southern pansy breadcake a pint 'o mild.
</div> 
```

# batch-file - 在批处理循环中将文件名和回显设置为 cmd.exe？

> ID：11214556
> 
> 赞同：0
> 
> 时间：2012-06-26T19:24:29.037
> 
> 标签：batch-file, for-loop, echo

我想将许多属性的文件名中的每一个都放入变量 fileName 并将它们回显到命令提示符窗口。但是只有最后一个要循环的属性文件名被打印出与属性文件一样多的次数。这个问题有没有简单的解决方法。我知道 ...DO echo %%-nxG 可以做同样的事情，但我想将文件名保存在 %%~nxG 中以备将来使用。

```
FOR %%G IN (C:\ExecutionSDKTest_10.2.2\*.properties) DO (
set fileName=%%~nxG
echo %fileName%
 ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:26:37.973

您需要使用延迟扩展：

```
setlocal enabledelayedexpansion
FOR %%G IN (C:\ExecutionSDKTest_10.2.2\*.properties) DO (
set fileName=%%~nxG
echo !fileName! 
 ) 
```

*解析*`cmd`命令时会扩展环境变量- 在这种情况下，这包括括号中的整个块。所以被一个空字符串替换，因为它在循环运行之前没有值。延迟扩展使用而不是更改变量评估，以便在命令*运行*之前对其进行评估。*`%fileName%``!``%`*

 **`help set`有更多关于为什么以及何时需要的详细信息。通常，每当您在循环中修改*和*使用变量时，您都必须使用延迟扩展，但它也带来了一些其他好处。**

# c++ - RaspBerry Pi 的交叉编译

> ID：11214563
> 
> 赞同：13
> 
> 时间：2012-06-26T19:25:00.900
> 
> 标签：c++, cross-compiling, codesourcery, raspberry-pi

使用 RaspBerry Pi 和我的计算机，我正在尝试交叉编译一个用 C++ 编写的简单 helloWorld。我正在使用适用于 linux 的 Code Sourcery 工具链进行编译。

当通过 TFTP 将 helloWorld 二进制文件复制到 raspBerry 并使用 chmod 授予它执行权限时，会出现下一个错误：

“非法指令”

如果在二进制文件上创建一个“文件”，我会得到：“覆盆子：ELF 32 位 LSB 可执行文件，ARM，版本 1（SYSV），静态链接，剥离”

这是因为我在链接时使用了“-static -static-libstdc++”。

如果我不使用静态链接，错误是：“分段错误”

编码：

```
/*
 * main.cpp
 *
 *  Created on: 26/06/2012
 *      Author: ccortiz
 */

#include <iostream>
using namespace std;

int main(void){

    cout << "Hello Cross Compilling for ARM!" << endl << flush;
    return 0;
} 
```

我怎样才能以正确的方式编译和运行我的程序？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-26T08:15:06.483

您收到错误的原因`Segmentation fault`是不同的 ABI。Raspberry Pi 在运行 Raspbian 时使用`linux-arm-gnueabihf`ABI，它假定硬件支持 hardfp 和 VFP（这在 ARMv6 环境中很少见），因此需要一些额外的 GCC 和 EGLIBC 补丁（这些补丁可以在 Raspbian 存储库中找到）。

您的 Code Sourcery 跨工具链很可能没有这些补丁，因此它使用另一个 ABI ( `linux-arm-gnueabi`)，因此在运行时崩溃（静态链接有效，因为内核 ABI 不依赖于 hardfp/softfp）。

您可能会收到错误的另一个可能原因`Illegal Instruction`是为 ARMv7 配置的 Code Sourcery 跨工具链，而 Raspberry Pi 是 ARMv6。但在这种情况下，静态和动态链接都会产生相同的错误。

[这是如何在 Windows 中构建 Raspberry Pi 交叉编译器的分步指南](http://www.gurucoding.com/en/rpi_cross_compiler/index.php)，包括 hardfp/softfp ABI 版本。生成的交叉编译器支持 C++ 并且不依赖于 cygwin 运行时库 (cygwin1.dll)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-18T14:05:31.983

问题是在我的 FTP 传输中使用 ASCII 模式而不是二进制模式。今天我更喜欢使用 SFTP (SSH)。谢谢。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-20T13:59:06.783

我建议尝试[biicode](http://docs.biicode.com/raspberrypi.html)，它会自动为您设置交叉编译器环境，并在构建后将生成的二进制文件发送到树莓派

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-21T11:47:06.720

您可以在以下位置尝试工具链：[https ://github.com/kallaballa/Raspberry-GCC-4.7.3](https://github.com/kallaballa/Raspberry-GCC-4.7.3)

这是一个使用 gnueabi 的带有 hardfp 的 armv6 的预构建 gcc-4.7.3 工具链。我正在使用它为树莓派目标交叉编译 c++11。

请注意，它仅适用于 linux x86_64 主机。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-26T05:30:18.577

我的推荐在这里，[http://hertaville.com/2012/09/28/development-environment-raspberry-pi-cross-compiler/](http://hertaville.com/2012/09/28/development-environment-raspberry-pi-cross-compiler/) 他很好地解释了如何使用Eclipse编译HelloWorld.cpp，下载，并在树莓派板上执行。一探究竟。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-05T04:49:15.650

使用 Visual Studio 和 Visual GDB 插件，您可以下载树莓派的交叉编译器。之后，您可以创建 ssh 连接，也可以将程序远程部署到树莓派中。

# php - 如何将下载计数器附加到下载按钮？

> ID：11214570
> 
> 赞同：1
> 
> 时间：2012-06-26T19:25:36.487
> 
> 标签：php

我在一个页面中有 6 个下载按钮，用于 6 个不同的文件。我想要他们每个人的下载计数器。并且每个文件的“下载次数：”将显示在网页上每个文件的图片下方。 [http://www.aamaodisha.org/secdownload.html](http://www.aamaodisha.org/secdownload.html)

我只是无法继续前进。我对 PHP 的了解非常有限，但是在 Google 上搜索了很多之后，我偶然发现了一个计算编号的代码。下载量：

```
<?php

$num= intval(file_get_contents('counter.txt'));
$num+=1;
file_put_contents('counter.txt', $num);

echo "No of times downloaded " . $num ." ". ;
?> 
```

为了亲自了解它的功能，我将此 php 保存为 downloadcounter.php 并将其放置在我要下载的原始文件所在的虚拟主机的下载目录中。我还将下载链接更改为 `<a href="Magazine/downloadcounter.php?number=1&file=9thEdition.rar>Download</a>`我的 HTML 中的第一个下载按钮。我还在同一个下载目录中放置了一个counter.txt文件，初始值为0（即名为COUNTER.TXT的记事本文件只写了0）。

但是当我点击我的下载按钮时，虽然文件开始下载（这意味着我已经通过php文件（downloadcounter.php）成功链接我的下载但是当我每次下载后查看counter.txt时，我仍然看到0

您能否指导我如何在下载按钮下显示我的网页上的下载次数，我计划的方式如下[http://www.aamaodisha.org/secdownload.html](http://www.aamaodisha.org/secdownload.html) 在这个 HTML 页面上，我只是简单地写了下载次数，但它们不是实际的自动计数器生成的数据:(有人可以告诉我出路吗？两天以来我一直被这些下载计数器设计困在这里。（我真诚地为我的有限知识道歉PHP 或其他语言）

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:26:36.657

您不应该为此使用文件。如果两个人同时下载，锁定将成为一个问题。使用 MySQL、Redis.io 或其他任何东西......

如果你必须，试试这个：

```
<?php
$num= intval(file_get_contents('counter.txt'));
$num+=1;
file_put_contents('counter.txt', $num); 
```

# javascript - 多个if条件在javascript中不起作用的window.open（）

> ID：11214574
> 
> 赞同：0
> 
> 时间：2012-06-26T19:25:45.280
> 
> 标签：javascript, window.open

我的javascript代码是这样的：

```
function openWindows() {

    if(A is true) {
      window.open(URL_A);
    }

    if(B is true) {
      window.open(URL_B);
    }

    and so on...

} 
```

当我的函数被调用时，所有条件都为真，随机没有。的窗户打开。有时，它们都打开，但它是随机发生的。可能是什么问题？我是否丢失了父窗口引用？为什么这是随机发生的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:29:48.467

对我来说很好。

您确定您的弹出窗口阻止程序没有阻止它们吗？许多浏览器不允许您在没有点击事件的情况下触发新窗口，否则浏览器会停止它们。此外，浏览器通常允许每个点击事件打开一个窗口。

```
if(true) {
    window.open('http://www.google.com');
}

if(true) {
      window.open('http://www.google.com');
}

if(true) {
    window.open('http://www.google.com');
}

if(true) {
      window.open('http://www.google.com');
}
​ 
```

[http://jsfiddle.net/2LJtv/](http://jsfiddle.net/2LJtv/)（警告要准备好4个窗口打开）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:35:47.463

`is true`并且`and so on...`不是合法的 JavaScript 代码。

* * *

> 当我的函数被调用时，所有条件都为真，随机没有。的窗户打开。有时，它们都打开，但它是随机发生的。可能是什么问题？

无法回答没有更多信息。

> 我是否丢失了父窗口引用？为什么这是随机发生的？

无法回答没有更多信息。

* * *

您的问题很有趣，但伪代码应该可以工作，只要以下评估为有效值：

*   `A is true`
*   `B is true`

以下是包含有效值的有效变量：

*   `URL_A`
*   `URL_B`

# c# - ajax选择要发布和searlize的表单输入

> ID：11214575
> 
> 赞同：0
> 
> 时间：2012-06-26T19:25:46.677
> 
> 标签：c#, javascript, jquery, ajax, asp.net-mvc

我有一个使用 AJAX 的表单。我将如何选择表单的哪些输入发送到后面的代码（而不是整个表单）？AJAX

```
 function send()
    {
         $.ajax({
                    type: 'POST',
                    url: this.action,
                    data: {'data1': $('#data1').val(), 
                    'data2': $('#data2').val() },
                    success: function (done) {
            $('#box').html(done.output);
        });
    } 
```

形式

```
@using (Html.BeginForm())
{
<input id="data1" value="0" name="data1" onclick="send();" >
<input id="data2" value="0" name="data2" onclick="send();" >

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:28:00.310

您可以在`data`参数中指定它们：

```
$.ajax({
    type: 'POST',
    url: this.action,
    data: { 
        field1: $('#field1').val(), 
        field2: $('#field2').val() 
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:28:46.007

```
 var NewKeyword = $('#txtbox1').val();
            var type = $('#txtbox2').val()

            $.ajax({
                type: "POST",  
                url: "url...",
                data: "{'type':'" + type + "','keyword' : '" + NewKeyword + "' }", 
```

然后在c#中你必须能够接受“类型和”关键字作为你的webmethod中的参数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:29:18.620

你可以这样做：

```
$form = $('form');
$.ajax({
        type: 'POST',
        url: this.action,
        data: {
            'name': $('fieldNameForName', $form).val(),
            'age': $('fieldNameForAge', $form).val()
        }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T19:33:52.817

您可以编写一个接受表单选择器的函数，而不是使用序列化：

```
function getFormData(formSelector,toSend){
    var formData = {};
    for(var i in toSend){
        var field = formSelector.find('input[name="'+toSend[i]+'"]');
        if(field!==undefined) formData[toSend[i]] = field[0].val();
    }
    return formData;
} 
```

用法：

```
$.ajax({
   url: '/myurl'
   data: getFormData($('#myForm'),['FirstName','LastName','FavoriteColor']),
   type: 'POST'
  }); 
```

您传入的数组应该是您要发送的字段的名称属性（您也可以将其设为 id 或其他任何内容，我只是认为您设置了名称属性。

# javascript - 未检查 Javascript 单选按钮

> ID：11214582
> 
> 赞同：0
> 
> 时间：2012-06-26T19:26:24.553
> 
> 标签：javascript, radio-button, google-chrome-devtools

我的单选按钮有问题。

检查按钮后，它们仍然显示它们未检查。但是，有 12 组单选按钮，对于第 4-12 组，它只是前 3 组工作正常，考虑到它的代码相同，我认为这很奇怪。

```
document.write('<input 
                 type="radio" 
                 onclick="colorEng('+i+','+j+')" 
                 name="' + Name + (i+1) + '_' + (j) + '" id="Eng_' + (i+1) + '_' + (j) + '"
                 value="English" 
                 >'); 
```

上面的代码生成单选按钮。它最终成为一个包含多个单元格的 4 个选项的表格。下面的代码旨在检查每列中是否至少选中了一个单选按钮，目前没有显示，因为我试图弄清楚为什么前 3 个单选按钮不起作用

```
for( i = 0 ; i < words.length; i++)
{
    for(j = 0 ; j < words[i].length; j++)
    { 
        var eng = document.getElementById('Eng_' + (i+1) + '_' + j +'').checked;
        var spa = document.getElementById('Spa_' + (i+1) + '_' + j +'').checked;
        var oth = document.getElementById('Other_' + (i+1) + '_' + j +'').checked;
        var dif = document.getElementById('Lang_' + (i+1) + '_' + j +'').checked;
        alert(eng);
        alert(spa);
        alert(oth);
        alert(dif); 
    }
    break;
} 
```

此外，我试图使用 chrome web 开发人员来查找问题，但不能很好地理解它，任何好的文档来了解如何使用它以供将来参考。

谢谢你。

# c# - 在 Stack 面板 Silverligh 中对齐按钮和多行文本块

> ID：11214583
> 
> 赞同：0
> 
> 时间：2012-06-26T19:26:29.160
> 
> 标签：c#, .net, wpf, silverlight, silverlight-4.0

这是场景：

```
---------- ++++++++++++
--Button-- +Text block+
---------- ++++++++++++ 
```

在 WPF 中使用停靠面板非常容易。在 Silverlight 中实现这一目标的方法是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:35:49.107

尝试 StackPanel 并使其方向为水平。然后，您可以根据需要调整堆栈面板子项的垂直和水平对齐方式。

IE：

```
 <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
        <Button Content="High" VerticalAlignment="Center"></Button>
        <TextBlock Margin="10" Width="100" Text="Insert Text Here" TextWrapping="Wrap" VerticalAlignment="Center"/>
    </StackPanel> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T20:01:58.047

[借助 Silverlight 工具包，您也可以在Silverlight](http://silverlight.codeplex.com/)中使用 DockPanel 。

安装工具包后，您可以在 XAML 中添加以下命名空间：

```
xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit" 
```

然后在元素的属性中添加：

```
toolkit:DockPanel.Dock="Right" 
```

当然，根据需要将“右”更改为：右、左、上或下。

# r - 在 R 中找出 PDF 的编码

> ID：11214584
> 
> 赞同：3
> 
> 时间：2012-06-26T19:26:30.480
> 
> 标签：r, pdf, character-encoding

我目前正在使用 tm 包中的 readPDF() 函数从几个 PDF 中抓取一些文本数据。这一切都很好，在大多数情况下，编码似乎是“latin1” - 然而，在某些情况下，它不是。R中是否有检查字符编码的好方法？我在 tau 包中找到了函数 is.utf8() 和 is.local() ，但这显然只能让我到目前为止。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T21:29:47.507

我对 R 了解不多。但我现在对 CRAN 进行了一些研究，看看提到的*tm*和*tau*包是什么。

所以*tm*用于文本挖掘，而对于 PDF 阅读，它需要并依赖于`pdftotext`Poppler 的实用程序。起初我有[明显错误]的印象，您提到的*readPDF()*函数正在对 PDF 文件中的 PDF 对象进行一些基于库的低级访问……我错了！结果它“只”查看`pdftotext`命令行工具的文本输出。

现在这解释了为什么您可能无法成功阅读任何使用比“简单”Latin1 更复杂的字体编码的 PDF。

恐怕，您的问题的原因是目前 Poppler`pdftotext`根本无法处理这些问题。

也许您最好向*tm*维护人员询问功能请求：:-)

*   您希望他们尝试 + 为他们的*tm*包添加支持，以获得更强大的第三方 PDF 文本提取工具，例如 PDFlib.com 的[**TET**](http://www.pdflib.com/de/produkte/tet-plugin/)（[英文版](http://www.pdflib.com/en/produkte/tet-plugin/)），它肯定是地球上最好的文本提取实用程序（比Adobe自己的工具，顺便说一句）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T16:47:12.093

PDF 规范为拉丁文本定义了这些**简单字体**（每种字体最多可包含 256 个字符形状）的编码，这些编码应在任何符合标准的阅读器中预定义：

*   **`/StandardEncoding`**
    （适用于*Type 1*拉丁文本字体，但不适用于*TrueType*字体）
*   **`/MacRomanEncoding`**
    （Mac OS 标准编码，适用于*TrueType*和*Type1*字体）
*   **`/PDFDocEncoding`**
    （仅用于文档内容流*之外*的文本字符串；通常不用于显示字体中的文本）
*   **`/WinAnsiEncoding`**
    （Windows 代码页 1252 编码，适用于*TrueType*和*Type1*字体）
*   **`/MacExpertEncoding`**
    （名称具有误导性——编码不是特定于平台的；但是只有少数字体具有适当的字符集来使用这种编码）

然后有 2 种特定的符号字体编码：

*   符号编码
*   ZapfDingBats 编码

此外，字体可以具有内置编码，这可能会偏离其创建者想要的标准编码的任何方式（当嵌入*标准*字体被子集化时，fe 也用于*差异编码）。*

 *因此，为了正确解释 PDF 文件，您必须查找所使用字体的每种字体编码，并且还必须考虑到任何`/Encoding`使用`/Differences`数组的情况。

*但是，对于简单*的字体，总体任务仍然相当简单。PDF 查看器程序只需将*“我看到的用于表示文本字符串的字节序列中的每一个”按*1:1 映射到*“我可以在编码表中查找的确切一个字形”*。

* * *

对于**复合**，CID 键控字体（可能包含数千个字符形状），查看器程序的查找/映射*“这是我看到的字节序列，我应该将其绘制为文本”*到*“这是要绘制的字形形状的序列”*不再是 1:1。*在这里，需要对一个或多个字节*的序列进行解码，以从 CIDFont中选择每个*字形。*

为了帮助这个 CIDFont 解码，周围需要有*CMap*结构。CMap 定义了从 Unicode 编码到字符集合的映射。PDF 规范为中文、日文和韩文字体定义了至少 5 打 CMap 及其标准名称。这些预定义的 CMap 不需要嵌入到 PDF 中（但符合要求的 PDF 阅读器需要知道如何正确处理它们）。但是（当然）也有自定义 CMap，当创建 PDF 的应用程序写出 PDF 时，这些 CMap 可能已经“即时”生成。在这种情况下，需要将 CMap 嵌入 PDF 文件中。

[**官方 PDF-1.7 规范**](http://www.adobe.com/content/dam/Adobe/en/devnet/pdf/pdfs/PDF32000_2008.pdf#page651)中规定了有关这些复杂性的所有细节。*

# javascript - 计算两个日期之间发生的天数

> ID：11214593
> 
> 赞同：1
> 
> 时间：2012-06-26T19:26:53.427
> 
> 标签：javascript, date, timestamp, timespan

我正在寻找 JavaScript 中以下问题的最简洁的解决方案：

我想确定 JavaScript 中两个日期之间发生的天数。我不是在寻找以天为单位的日期差异，例如：

日期 1：2012 年 6 月 26 日晚上 11:05

日期 2：2012 年 6 月 27 日 12:15 AM

我正在使用以下代码行：

```
var days = Math.ceil((date2 - date1) / 86400000); 
```

我的结果是 1，我希望它是 2（计算 6 月 26 日和 6 月 27 日）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T20:23:18.820

删除日期的时间部分，然后进行日期减法。请参阅[此 jsfiddle](http://jsfiddle.net/WJ5Rd/)或下面的代码段。

```
var d1 = new Date('June 26th 2012 11:05 PM'.replace('th',''));
var d2 = new Date('June 27th 2012 12:15 AM'.replace('th',''));

// remove the time portion, set the dates to midnight
d1.setHours(0,0,0,0);
d2.setHours(0,0,0,0);

var diff = Math.ceil((d2 - d1) / 86400000) + 1;

console.log(diff); 
```

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:58:44.473

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)

将小时、分钟、秒和毫秒都设置为零。现在你有两个日期相同的日期。现在您可以按照以前的方式进行操作并获得正确的答案。

# ruby-on-rails - 如何在 Rails 3.2 中制作类似档案的 blogspot

> ID：11214594
> 
> 赞同：1
> 
> 时间：2012-06-26T19:26:53.653
> 
> 标签：ruby-on-rails, ruby-on-rails-3

假设我有一个带有 created_at、title 和 id 的 post 模型。我如何建立一个包含年 > 月 > 帖子的数组以用于显示档案。

到目前为止，我有：

```
@posts = Post.all(:order => 'created_at DESC')
@post_months = @posts.group_by { |t| t.created_at.beginning_of_month } 
```

这给了我类似 {"June 2012" => {"post1", "post2"}} 的东西，很接近。

[http://shouweick.blogspot.co.uk/2012/02/handling-background-jobs-in-rails-32.html](http://shouweick.blogspot.co.uk/2012/02/handling-background-jobs-in-rails-32.html)这个博客有我想要的输出格式 {year => {november => {post1, post2 }，十二月 => {post3}}}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:54:38.690

首先按年分组，然后按月分组：

```
Hash[
  x.group_by{|x| x.created_at.year}
   .map{|k,v| [k,v.group_by{|x| x.created_at.month}]}
] 
```

# ajax - 使用 webworker 和直接通过 DOM 发出 ajax 请求有什么区别？

> ID：11214596
> 
> 赞同：0
> 
> 时间：2012-06-26T19:27:02.357
> 
> 标签：ajax, html

我想知道使用 webworker 发出 ajax 请求是否比直接在 DOM 中发出 ajax 请求有任何优势。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T09:00:59.153

通过在 webworkers 中发出 ajax 请求可以节省 APP 的性能。来自 DOM 的 ajax 请求会消耗应用程序的性能，并且有时可能会阻塞应用程序 UI。处理高计算的安全方法是在 webworker 中进行。

# java - 如何从 URL 中读取参数中的 HashMark

> ID：11214598
> 
> 赞同：0
> 
> 时间：2012-06-26T19:27:05.347
> 
> 标签：java

我编写了一个 Java Servlet，它查询数据库并将结果返回给 JSP。我正在根据从 URL 传递的参数执行 SQL 语句

```
//Reading Parameter
String User = request.getParameter("userid");

//Executing the SQL
String sqluser = "SELECT 1  FROM <table name> WHERE username = ?

pstmt = con.prepareStatement(sqluser);
pstmt.setString(1, User);
rset = pstmt.executeQuery(); 
```

示例 URL：http:\testenv.com\test?userid=tana

上面的 URL 显示正确的结果，因为 user='tana'。

但是有些用户的用户名中带有“#”。

例如：http:\testenv.com\test?userid=la#na

SQL 语句不返回任何值，因为在上述情况下 User= 'la' 即使 URL 具有“la#na”。我可以使用 getParameter 获取值“la#na”吗？如果是这样，我需要做什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:35:00.890

哈希字符需要正确编码，因为它通常用作内部链接。

```
http://testenv.com/test?userid=la%23na 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:39:20.307

'#' 在 URL 中有一个角色，它不是一个常规字符。它被称为锚点，它在请求的页面中标记了某个位置。锚点之后的部分只供浏览器使用，因此它不是查询字符串的一部分，也不会发送到服务器。所以你的服务器得到`la`, 并且`na`停留在浏览器上。

如果您可以控制发送的 URL，请将其编码。否则，你无能为力。

# google-apps-script - 项目/库物理（编辑访问）和逻辑（执行访问）范围

> ID：11214604
> 
> 赞同：0
> 
> 时间：2012-06-26T19:27:39.457
> 
> 标签：google-apps-script

我已经阅读了一些基本的 Google Apps 脚本文档/教程。我还没有找到任何关于代码执行“范围”的解释。

到目前为止，这是我的理解：

```
 All code consists of one or more statements
 All statements must (?) be contained in a "function"
     (a slight different from non-google javascript? - is this a false assumption?) 
 All functions reside in a container called a "file"
 Each "file" is part of a "project" container (or library)
 Each project container is stored in a "spreadsheet" container. 
```

这些是“物理”（编辑访问）边界。

我的问题是
执行期间语句的“逻辑”边界是什么？

我首先假设所有变量/对象在范围内都是全局的，类似于 JavaScript 在网页中的操作方式。我不认为“编辑访问”容器限制了变量/对象定义的范围。我错了。

我认为“库”结构类似于 PHP 的“包含”操作。我认为这样我就不必将相同的代码集复制到每个应用程序（电子表格容器）中，我需要在其中使用已经“测试”的代码。我假设包含项目可用的资源与包含项目公共资源可用的资源相同）。简而言之，我错了。“属性”存储在定义电子表格中，并被视为由包含项目“拥有”。

通过使用它，我现在了解到“项目密钥”只是向电子表格容器添加了一个新的“命名空间”。每个命名空间中发生的事情都保留在该命名空间中。命名空间之间唯一（最简单的）通信是通过函数参数和返回值。

特别是，用户和项目属性的范围仅限于并保留在其包含的电子表格文档中。电子表格文档中的每个项目都有一组单独的用户和项目属性。

相同的项目/库名称可以出现在多个电子表格文件中，并且是完全独立的。

这是在某处记录的吗？还有其他关于范围界定的事情我需要了解（来自共享同一项目/库的不同应用程序的线程之间的通信？

另外，如果一个函数传回对库范围内定义的对象的引用，它会保留在调用的项目中吗？我可以传递/返回一个指向项目的 UserProperties“服务”对象的变量并可以访问另一个项目中的数据吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T23:18:34.643

这记录在库中用户指南的末尾： [https ://developers.google.com/apps-script/guide_libraries](https://developers.google.com/apps-script/guide_libraries)

在决定如何确定范围时，我们尝试认真考虑最常见的用例，并尝试尽可能减少意外，但我们并不完美。

关于您是否可以使用参数传递在库和项目之间共享 ScriptProperties 对象的问题，目前这是不可能的。您始终可以公开特定属性的 getter/setter。

如果您有一个有趣的用例，如果没有请求的行为就无法实现，请在我们的问题跟踪器中提交错误。谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T11:49:15.667

我也为此苦苦挣扎。虽然文档非常好，但有点令人困惑。

共享和不共享的概念让我经历了一些反复试验才得到。

我确实想提一下，UserProperties 存在于用户级别，并且不仅仅与项目或库相关联。使用库时无需像使用 ScriptProperties 那样传递 UserProperties。

到处都是整洁的东西:-)

吉姆

# php - 建立简单的聊天室时发送消息失败

> ID：11214607
> 
> 赞同：0
> 
> 时间：2012-06-26T19:27:58.950
> 
> 标签：php

我尝试在网上建立聊天室的教程。

首先，我在 MYSQL 中创建了一个名为 chatroom 的数据库，并建立了一个名为 chat 的数据表，其中包含三列：chtime、nick、words。

然后我写了四个PHP文件，login.php，main.php，display.php，speak.php，但是遇到了关于显示和说话的问题。我的演讲不起作用，我只是弹出一个新窗口，没有任何文字。

不知道问题出在哪里？

我试图修复它几天但徒劳无功。我的错误在哪里？

以下是我的代码：

Login.php [http://codepad.org/WIfr3quz](http://codepad.org/WIfr3quz)

Main.php [http://codepad.org/b9pXuNl0](http://codepad.org/b9pXuNl0)

Display.php [http://codepad.org/o7pf5G57](http://codepad.org/o7pf5G57)

Speak.php [http://codepad.org/wFDEMrNk](http://codepad.org/wFDEMrNk)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:38:49.870

将 speak.php 中的代码更改为：

```
<html> 
<head> 
<title>Speak</title> 
</head> 
<body> 
<?php 
    if ($words){
    $link = mysqli_connect('localhost', 'xxx', 'xxx', 'ChatRoom');
        $time = date('Y-m-d-a:i:s');
        $nick = $link->real_escape_string($_POST['nick']);
        $words = $link->real_escape_string($_POST['words']);
        $str = "INSERT INTO chat(chtime,nick,words) values('$time','$nick','$words')" ;
        mysqli_query($str,$link);
        mysqli_close($link);
}
?>
<form action = "Speak.php" method = "post" target = " _self"> 
<input type = "text" name = "nick"> 
<input type = "text" name = "words">
<input type = "submit" value = "Speak"> 
</form> 
</body> 
</html> 
```

使用[real_escape_string](http://php.net/mysqli_real_escape_string)可以防止 SQL 代码注入。
POST 表单发送的值存储在 $_POST 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:39:43.767

确保您已阅读 SQL 注入

在哪里`$words`定义？

```
 if ($words){
    $link = mysqli_connect('localhost', 'xxx', 'xxx', 'ChatRoom');
        $time = date('Y-m-d-a:i:s');
        $str = "INSERT INTO chat(chtime,nick,words) values('$time','$nick','$words')" ;
        mysqli_query($str,$link);
        mysqli_close($link);
} 
```

你应该这么定义这些。在没有看到出现什么样的错误的情况下不知道还能告诉你什么..这就是我要开始的地方..让块看起来像

```
if(isset($_POST['words']))
    $link = mysqli_connect('localhost', 'xxx', 'xxx', 'ChatRoom');
        $time = date('Y-m-d-a:i:s');
            $nick = 'NickName';//However you would get the nick for the user
            $words = $link->real_escape_string($_POST['words']);
        $str = "INSERT INTO chat(chtime,nick,words) values('$time','$nick','$words')" ;
        mysqli_query($str,$link);
        mysqli_close($link);
}
?> 
```

# javascript - 在 JavaScript 中为函数对象起别名

> ID：11214609
> 
> 赞同：3
> 
> 时间：2012-06-26T19:28:02.103
> 
> 标签：javascript, oop, design-patterns, extjs3

**免责声明：**我使用的是 ExtJS 3，但我不认为它与问题非常相关，除了它的命名空间功能的常见用途之外。

我有一个*单例*，它在一个非常长的命名空间中声明，如下所示：

```
Ext.ns("REALLY.REALLY.LONG.NAMESPACE");

var Singleton = (function() {   
    var foo = {
        bar: "baz"
    }; 

    var privateFunction = function(param){
        // ...
        return foo;
    };

    var single = Ext.extend(Object, {
        constructor: function(config) {
            Ext.apply(this, config);
        },
        otherFunction: privateFunction,     
        publicFunction: function (someObject){
            // do stuff with someObject
        }
    });

    return single;

})();
// Make it a singleton
REALLY.REALLY.LONG.NAMESPACE.Singleton = new Singleton(); 
```

`REALLY.REALLY.LONG.NAMESPACE.Singleton.otherFunction();`我通过像和之类的调用在其他模块中使用它`REALLY.REALLY.LONG.NAMESPACE.Singleton.publicFunction(myObject);`。我想知道是否可以通过设置具有单例别名的客户端模块来交换这些调用，即`var singleton = REALLY.REALLY.LONG.NAMESPACE.Singleton;`，以便我可以调用`singleton.otherFunction();`. 我想知道这是否是一种[反模式](http://en.wikipedia.org/wiki/Anti-pattern)，或者是否有任何陷阱（内存？）我可能会遇到这种用法。

感谢 StackOverflow！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T19:30:12.133

> 我想知道是否可以通过设置具有单例别名的客户端模块来交换这些调用

是的你可以。

> 我想知道这是否是一种反模式，或者是否有任何陷阱（内存？）我可能会遇到这种用法。

不，没有任何我能想到的，它比调用完全合格的版本更快。

[本地别名模式](http://weblogs.asp.net/bleroy/archive/2010/05/17/javascript-local-alias-pattern.aspx)

* * *

**例子：**

```
function somefunc(){
    var singleton = REALLY.REALLY.LONG.NAMESPACE.Singleton;

    singleton.publicFunction();
}; 
```

或者：

```
(function somfunc(singleton){

}(REALLY.REALLY.LONG.NAMESPACE.Singleton)); 
```

* * *

**试验结果：**

[http://jsfiddle.net/jMg9A/](http://jsfiddle.net/jMg9A/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:56:20.483

创建对原始“对象”的引用没有问题。在许多情况下，我们创建一个命名空间来组织我们的代码，但是当然，这可能会导致我们以后真的不希望引用的非常长的命名空间，因此创建对该命名空间的本地引用是一个好主意，这样您就可以在一个地方而不是在不同的地方改变它。

我在这里并没有真正看到蚂蚁模式，相反，我看到了一个让你自己更简单的机会，并且从开发人员的角度来看可能更易于管理。

# paypal - PayPal - 如何在沙盒上设置自动退货？

> ID：11214610
> 
> 赞同：3
> 
> 时间：2012-06-26T19:28:14.080
> 
> 标签：paypal, return

我已经阅读了启用自动退货的信息，我必须在 www.paypal.com 上启用此功能 - 但是如何在沙盒模式下启用自动退货？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T20:30:08.640

您只需要在发布到 PayPal 时提供`return`url 和url。`cancel_return`

变量的更多细节在[这里](https://www.x.com/developers/paypal/documentation-tools/paypal-payments-standard/integration-guide/Appx_websitestandard_htmlvariables)

# apache - nginx web 服务器上的 Apache 基准测试运行缓慢，请求更多

> ID：11214611
> 
> 赞同：2
> 
> 时间：2012-06-26T19:28:20.517
> 
> 标签：apache, nginx, benchmarking

在将 apache 基准与 nginx 一起使用时，我看到了一些奇怪的结果。请参阅下面的详细信息-

```
终端：~目录$ ab -c 100 -n 10000 http://localhost/banner.jpg
这是 ApacheBench，版本 2.3

对本地主机进行基准测试（请耐心等待）
已完成 1000 个请求
已完成 2000 个请求
已完成 3000 个请求
完成 4000 个请求
已完成 5000 个请求
已完成 6000 个请求
已完成 7000 个请求
已完成 8000 个请求
已完成 9000 个请求
已完成 10000 个请求
完成10000个请求

服务器软件：nginx/1.2.0
服务器主机名：本地主机
服务器端口：80

文档路径：/banner.jpg
文档长度：16697 字节

并发级别：100
测试时间：1.224 秒
完成请求：10000
失败的请求：0
写入错误：0
总传输量：169226562 字节
传输的 HTML：167094858 字节
每秒请求数：8170.40 [#/sec]（平均）
每个请求的时间：12.239 [ms]（平均）
每个请求的时间：0.122 [ms]（平均值，所有并发请求）
传输速率：收到 135024.21 [Kbytes/sec]

```

但是当我将请求数从 10K 增加到 15K 时，测试时间从 1.124 秒增加到 6.760 秒。

```
终端：~目录$ ab -c 100 -n 15000 http://localhost/banner.jpg
这是 ApacheBench，版本 2.3

对本地主机进行基准测试（请耐心等待）
已完成 1500 个请求
已完成 3000 个请求
完成 4500 个请求
已完成 6000 个请求
已完成 7500 个请求
已完成 9000 个请求
已完成 10500 个请求
已完成 12000 个请求
已完成 13500 个请求
已完成 15000 个请求
完成 15000 个请求

服务器软件：nginx/1.2.0
服务器主机名：本地主机
服务器端口：80

文档路径：/banner.jpg
文档长度：16697 字节

并发级别：100
测试时间：6.760 秒
完成请求：15000
失败的请求：0
写入错误：0
总传输量：254201718 字节
传输的 HTML：250999689 字节
每秒请求数：2218.92 [#/sec]（平均）
每个请求的时间：45.067 [ms]（平均）
每个请求的时间：0.451 [ms]（平均值，所有并发请求）
传输速率：收到 36722.28 [Kbytes/sec]

```

有没有人注意到这个问题？是否有任何工具可以分析 nginx 或 apache 基准测试工具并查看需要花费大量时间的内容？

# mysql - 具有大量单独选项的多个用户的 Mysql 设置

> ID：11214613
> 
> 赞同：0
> 
> 时间：2012-06-26T19:28:24.480
> 
> 标签：mysql, database-design

我正在构建一个学习工具，但我不确定构建数据库的最佳方法。

基本上，我有一张简单但大的桌子，里面有大约 50000 位信息。

信息（50'000 行）

id info_text

用户

身份证姓名电子邮件密码等

我想要的是让学生能够将每个项目标记为已学习或正在学习（基本上是打开和关闭），以便他们在修改每个项目时可以勾选。

我想构建工具来应对成千上万的用户，并且想知道设置数据库和相关查询的最有效/最简单的选择方式是什么。

目前，我倾向于只拥有一个带有两个主键的大表，一个带有用户 ID，然后是他们研究过的信息的 ID，然后执行某种 JOIN 语句，这样我就只能撤回他们留下的项目学习。

用户信息

user_id info_id

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T20:13:30.763

这是模拟这种情况的一种方法：

![在此处输入图像描述](../Images/d895d3da8d8a7620b232408487d03d68.png)

中间的表在 USER_ID 和 ITEM_ID 上有一个复合主键，因此两者的**组合**必须是唯一的，即使它们不必单独存在。

*   仅当 STUDIED 表中有相应的行（具有相同的 USER_ID 和 ITEM_ID 值）时，用户（具有给定的 USER_ID）才研究了特定的项目（具有给定的 ITEM_ID）。
*   相反，当且仅当 STUDIED 中的相应行缺失时，用户才没有研究过该项目。要提取给定用户尚未研究的所有项目，您可以执行以下操作：

    ```
    SELECT * FROM ITEM
    WHERE NOT EXISTS (
        SELECT * FROM STUDIED
        WHERE
            USER_ID = <given_user_id>
            AND ITEM.ITEM_ID = STUDIED.ITEM_ID
    ) 
    ```

    或者，或者：

    ```
    SELECT ITEM.*
    FROM ITEM LEFT JOIN STUDIED ON ITEM.ITEM_ID = STUDIED.ITEM_ID
    WHERE USER_ID = <given_user_id> AND STUDIED.ITEM_ID IS NULL 
    ```

这种设计的好处是你不需要提前关心 STUDIED 表。添加新用户或新项目时，只需将 STUDIED 放在一边 - 随着用户学习的进展，您将逐渐填充它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:35:12.947

我会做这样的事情：

1) 带有 uid 主键的 users 表

2) 一个主键为(uid, cid)的已注册表（该表显示所有已注册学生的课程）

3) 包含所有要研究的项目的项目（信息）表，主键为 itemid

然后在登记表中只有一个属性（二进制标志）1 表示已研究，0 表示他们仍需要研究。

# php - 如何通过 Ajax 请求或在每次页面加载时对用户进行身份验证？

> ID：11214616
> 
> 赞同：4
> 
> 时间：2012-06-26T19:28:30.530
> 
> 标签：php, jquery, ajax, codeigniter, authentication

这是一个非常简单的问题——尽管当我开始我的第一个真实世界且非常宏大（就规模而言）项目时，我现在就在想这个问题。

`Ajax request`发送via时，我将如何验证用户的身份（用户名和密码）`PHP`？似乎有一个简单的解决方案：将用户名和密码`POST variables`与请求中的其他用户一起发送，但在我看来，该解决方案效率很低（因为每次发出请求时它都必须检查数据库并且对于不同的 Ajax 请求是相当多余的）。

我调查了 Twitter 如何处理他们的 Ajax 请求（例如发布新推文），我没有看到他们在请求中发送任何身份验证信息 - 但他们怎么知道这实际上是我，我的个人资料的所有者，发送 Ajax 请求以发布新推文？

如果它可以帮助任何人提出一个很好的解决方案 - 我正在使用 JQuery AJAX 库和 CodeIgniter PHP 框架。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T19:35:22.527

Ajax 请求与任何其他 HTTP 请求完全相同。无论是通过 JavaScript 还是通过在浏览器的地址栏中输入 URI 来完成，它们都是 HTTP 请求。

你是对的，通过 HTTP 发送用户名和密码是错误的解决方案。但是，通常需要发送**一次**用户名/密码，但这只能在 HTTPS 上完成，因此它不会以纯文本形式发送。一旦通过身份验证，您可以将用户 ID 存储在**服务器端会话变量**中，以便在将来的请求中访问。

一些伪代码可以帮助您：

```
if(!empty($_SESSION["userId"])) {
    // User is authenticated. Do something.
}
else if(!empty($_POST["username"])) {
    // User is attempting to log in. Check against database.
    $userId = getUserIdByUsernamePassword($_POST["username"], $_POST["password"]);

    // Store user id in session variable.
    if($userId > 0) {
        $_SESSION["userId"] = $userId;
    }
}
else {
    // User is not authenticated.
} 
```

一个常见的陷阱是将身份验证存储在 cookie 中。Cookie 存储在客户端，因此如果您这样做，任何人都可以通过创建自己的 Cookie 来伪造身份验证。

*在 PHP中*使用会话变量，使用 cookie ，但它根本不识别用户，而是识别客户端和服务器之间的连接。

但要成功验证真实世界的项目，不应依赖会话 cookie。相反，会话变量、UUID cookie 和加盐哈希 cookie 的组合可以提高身份验证的完整性……但这完全是另一个话题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:32:50.897

我认为最好的方法（也许是唯一的方法）是让通过 ajax 请求的文件检查用户是否已登录（通过会话之类的东西）。我不建议将详细信息与请求一起发送，因为它们将位于源代码中通常不需要的地方。

# php - 带有 php 或 .htaccess 的 sef url

> ID：11214618
> 
> 赞同：0
> 
> 时间：2012-06-26T19:28:41.437
> 
> 标签：php, apache, .htaccess, url, sef

嗨，我想为网站制作安全的网址。我就是这样使用php的explode函数

```
 $explode = explode("/",$_SERVER['REQUEST_URI']); 
```

然后我使用 $explode[2] 等提取 url 中的名称，然后使用 sql 语句将它们与 db 结合起来，获取 id、名称和其他任何内容。输入的网址就像

```
 http://www.example.com/index.php?var1=value1&var2=value2&var3=value3 
```

并成功了

```
 http://www.example.com/value1/value2/value3 through .htaccess. 
```

代码有

```
 RewriteRule ^(.*)/(.*)/(.*)$ index.php?var1=$1&var2=$2&var3=$3 [L] 
```

但是该站点的 php 已经完全编写好了，所以我不想更改 url 上的所有 GET 查询，因为现在无法正常工作。有没有更简单的方法，或者您可以更正代码，以便我可以再次使用上面的 GET 函数？我忘了在 url value1,value2 等不是 ids（数字）而是相应的名称。例如，如果是家具，则 url 是

```
 www.example.com/furniture/chair/.. not www.example.com/3/24/... 
```

还有其他方法可以成功实现此功能吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:59:58.033

我会说你可能也在寻找类似的东西

[PHP 动态数据库页面重写 URL](https://stackoverflow.com/questions/11022509/php-dynamic-db-page-rewrite-url/11022705#11022705)

它将从 URL 收集所有变量，您可以从那里相应地使用它们。它将使用 htaccess 和与您想要做的类似的逻辑，而不是您现在拥有的重写规则。

# python - 如果我打算安装 Virtualenv，是否需要安装 Homebrew？

> ID：11214620
> 
> 赞同：1
> 
> 时间：2012-06-26T19:28:51.293
> 
> 标签：python, macos, osx-lion, virtualenv, homebrew

作为编程的新手，我无法准确理解 Homebrew 的功能......或者更确切地说 - 为什么需要它。我知道它包含用于包管理的 pip，但 Virtualenv 也是如此，我计划在适当的时候安装它。

Homebrew 是否安装了另一个不是系统版本的 python 版本，您将在该版本上安装 Virtualenv 并从那里管理不同的开发环境？

我有一个全新安装的 OSX Lion，我想将我的项目分开，但我不确定我为什么需要 Homebrew。

我知道这是基本的东西，但如果有人能解释一下，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:34:21.693

Homebrew 只是 Mac 的包管理器，就像Python 的*pip*一样。当然，您永远*不需要*包管理器，您可以自己获取所有程序或库（如果是 pip 和 Pypi）。然而，包管理器的重点是简化此过程并为您提供一个简单的界面来安装软件，并*删除*它，因为在自己编译时通常不是那么简单等。

话虽这么说，Homebrew 只会安装你告诉它安装的东西，所以通过 Homebrew 你不会随机获得新版本的东西。Homebrew 只是安装您通常需要/想要的一般 OSX 东西的好方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:50:19.270

pip 和 virtualenv 是 python 库，可以安装在任何工作的 python 安装中，包括 Apple 作为 OSX 和 python.org 版本的一部分提供的那个。

然后它取决于你对 python 的需求——如果你只需要安装 python 库或简单的 C linraries，那么你可以使用 easy_install，然后使用 pip、vittualenv 其他 python 工具。

如果您正在使用更复杂的 C 库，例如[mysql 的 python 接口，](https://stackoverflow.com/questions/1448429/how-to-install-mysqldb-python-data-access-library-to-mysql-on-mac-os-x/1448446#1448446)那么使用 macports、homebrew 或 fink 等包管理器会有所帮助，因为端口编写者将整理出棘手的依赖关系。还有来自 Enthought 和 Activestate 的其他 python 安装，它们处理一些非简单的情况，例如 scipy，但不是通用的包管理器。

Macports 和 fink 将在 /opt/local/bin 或 /sw/bin 中安装单独的 python 版本，而我认为 homebrew 将使用 Apple 的 python。*差异是由于包装经理设计的不同观点。Macports 和 fink 是由在使用不同版本的软件时遇到过很多问题的人开发的，因此我们说我们所有的安装都将在一个只有包管理器使用的地方，而 Homebrew 尝试尽可能多地使用 Apple 提供的工具，所以根据需要添加。

# jquery - 如何使用 jquery 选择第 n 个孩子的第 n 个孩子？

> ID：11214625
> 
> 赞同：1
> 
> 时间：2012-06-26T19:29:11.943
> 
> 标签：jquery, css

我怎么能在 jquery 中做这些？

1.  第 n 个孩子的第 n 个孩子
2.  第 n 个孩子的第一个孩子
3.  第 n 个孩子的后代（子女或孙子女）是图像

编辑：我正在使用一个变量来访问这样的“孩子”

```
var number = ( ... code ...) ;
.... eq(number) 
```

所以我不能做任何事情

```
$('li:nth-child(2) li:nth-child(2)') 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T19:31:26.003

将两者结合起来？

```
//1
$(":nth-child(2) :nth-child(3)")
//2
$(":nth-child(2) :first-child")
//3
$(":nth-child(2) img") 
```

以与在 CSS 样式表中相同的方式执行此操作。

```
var number = 2;
//1
$(":nth-child(" + number + ") :nth-child(" + number + ")")
//2
$(":nth-child(" + number + ") :first-child")
//3
$(":nth-child(" + number + ") img") 
```

# python - 在 tkinter 窗口中重新调整 pyplots 的大小

> ID：11214626
> 
> 赞同：0
> 
> 时间：2012-06-26T19:29:15.880
> 
> 标签：python, tkinter, matplotlib

我正在使用包含 pyplot 图的 tkinter 的 Toplevel 创建一个弹出窗口，并且我一直在尝试重新调整窗口的大小，以便可以水平拉伸图形以获得更多的 x 分辨率。我没有成功地做到这一点。我试图修改 Toplevel 的宽度组件，但它只是调整回图形大小。以下是我到目前为止的代码。任何关于如何使代码更好的建议总是受欢迎的。

```
import matplotlib
matplotlib.use('TkAgg')
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
from matplotlib.backends.backend_tkagg import NavigationToolbar2TkAgg
from matplotlib.figure import Figure
import Tkinter as tk

root = tk.Toplevel(width=2000)
f = Figure()
ax = f.add_subplot(111)
zeroy = [0,25]
zerox = [0, 35]
p3 = ax.plot(zerox, zeroy, 'k-')
canvas = FigureCanvasTkAgg(f, master=root)
canvas.show()
canvas.get_tk_widget().grid(row=0)

toolbar = NavigationToolbar2TkAgg(canvas, root)
toolbar.grid(row=1, sticky=tk.W) 
toolbar.update() 
button = tk.Button(root, text='Quit', command = root.destroy)
button.grid(row=2)
root.mainloop() 
```

我确信这是一件很简单的事情，但是我的 googlefu 让我失望了，我的实验也失败了。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T20:03:45.873

我的问题的答案包含在第二行中。

```
f = Figure(figsize=(15,9)) 
```

其中 15 是水平分量，9 是垂直分量。

编辑：我在发布我的问题几分钟后发现了这一点，并留下了这个问题以帮助未来的人。

# c# - 无法突出显示文本框中的文本

> ID：11214628
> 
> 赞同：1
> 
> 时间：2012-06-26T19:29:17.170
> 
> 标签：c#, winforms, textbox

我有一个 winforms 应用程序，它最初显示一个窗口，其中包含两个文件对话框、一个文件夹对话框和一个包含一些默认文本的文本框。我希望突出显示默认文本。我已经尝试了我发现的所有东西，但没有运气。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:32:17.487

确保文本框上的 HideSelection 为 false 并使用 select 方法选择文本：

```
textBox1.HideSelection = false;
textBox1.Select(0, textBox1.Text.Length); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:32:59.337

您可以使用[SelectionStart](http://msdn.microsoft.com/en-us/library/system.windows.controls.textbox.selectionstart)和[SelectionLenght](http://msdn.microsoft.com/en-us/library/system.windows.controls.textbox.selectionlength.aspx)

```
textbox.SelectionStart = 0;
textbox.SelectionLength = textbox.Text.Length; 
```

# java - Java和mysql的通信

> ID：11214630
> 
> 赞同：-1
> 
> 时间：2012-06-26T19:29:23.903
> 
> 标签：java, mysql, tomcat

我正在用 Java 开发一个与 MySQL 数据库交互的 Web 服务。我已经开发了java中的数据库和Mysql中的存储过程的请愿书......但是通信不起作用。我总是收到这个错误：

```
java.sql.SQLException: No suitable driver found for jdbc:mysql://localhost:3306/madrim 
```

我正在使用 Tomcat 服务器在 JAVA 中为 Web 服务在 Windows 上工作。我下载了 mysql 驱动程序（“mysql-connector-java-5.1.20-bin.jar”）并添加到了 tomcat 的文件夹中（~\Tomcat 7.0\lib），但它什么也没做。

会是什么呢？有什么提示吗？

这里有一些代码......：

```
 Connection con = null;
    Statement st = null;
    ResultSet rs = null;

    try 
    {           
        con = DriverManager.getConnection(DB_URL, DB_USER_NAME, DB_PASSWORD);
        st = con.createStatement();

        String query = BuildQuery();
        rs = st.executeQuery(query);

        returnObj.SetResult(rs);
    } 
    catch (SQLException ex) 
    {
        returnObj.SetException(DataException.SQL);
    } 
```

它坠毁并抓住了机会。

编辑：更多的东西。

Tomcat的context.xml：

```
<Context>    
<WatchedResource>WEB-INF/web.xml</WatchedResource>

<Resource name="jdbc/madrim" 

          auth="Container"

          type="javax.sql.DataSource" 

          username="root" 

          password="asdf"

          driverClassName="com.mysql.jdbc.Driver"

          url="jdbc:mysql://localhost:3306/madrim"

          maxActive="15" 

          maxIdle="3"/>  

</Context> 
```

以及项目的WEB-INF/web.xml：

```
<resource-ref>
<description>AccesoBaseDeDatos</description>
<res-ref-name>jdbc/madrim</res-ref-name>
<res-type>javax.sql.DataSource</res-type>
<res-auth>Container</res-auth> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:50:00.050

您应该将 MySQL 驱动程序添加到您的**构建路径**，而不仅仅是 libs 文件夹。

如果您使用的是 Eclipse，那么您可以通过转到项目的*属性*轻松添加驱动程序然后

> Java 构建路径 > 库 > 添加 JAR

如果它仍然无法正常工作，请尝试重建您的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:55:01.153

只需尝试使用以下方式注册驱动程序：

```
Class.forName("com.mysql.jdbc.Driver"); 
```

它应该工作。

# c++ - 静态字符数组的对齐保证

> ID：11214632
> 
> 赞同：5
> 
> 时间：2012-06-26T19:29:32.963
> 
> 标签：c++, memory-alignment

我想知道静态分配的数组的对齐保证`char`。查看其他 SO 问题，我发现了一些有关动态分配的`char`.

对于静态分配`char`的数组，它们是否对齐以便我可以将新的任何类型放入其中（只要它足够大）？还是这只适用于动态分配的？

```
char buff[sizeof(T)];
T * pT = (T*) buff;
new(pT) T(); // well defined?
...
pT->~T(); 
```

如果没有，我该如何克服这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-26T19:36:50.073

在 C++11 中，正确的做法是：

```
char alignas(T) buff[sizeof(T)]; //Notice 'alignas' as
T * pT = (T*) buff;
new(pT) T(); // well defined! 
```

注意使用[`alignas`](http://en.cppreference.com/w/cpp/language/alignas).

如果`T`是模板参数，那么最好将[`std::alignment_of`](http://en.cppreference.com/w/cpp/types/alignment_of)类模板用作：

```
char alignas(std::alignment_of<T>::value) buff[sizeof(T)]; 
```

另请注意，参数[`alignas`](http://en.cppreference.com/w/cpp/language/alignas)可以是*正整数值*或*类型*。所以这两个是等价的：

```
char alignas(T)          buff[sizeof(T)];
char alignas(alignof(T))  buff[sizeof(T)]; //same as above 
```

第二个使用[`alignof`](http://en.cppreference.com/w/cpp/language/alignof)它返回 type 的整数值`std::size_t`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-26T19:34:09.273

如果要保证静态字符数组的对齐，可以使用联合技巧。

```
union
{
    char buff[sizeof(T)];
    uint64_t dummy;
}; 
```

这里将保证联合中最大元素的对齐。当然，你应该把这些讨厌的东西包在一个漂亮的课堂上。

**编辑：更好的答案：**

当然，使用C++11`boost::aligned_storage`或`alignas`使用 C++11 会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:31:07.193

不，静态分配的数组与字节对齐`sizeof(element_type)`——对于 char 它是 1 个字节，这基本上保证了不对齐。

# php - Curl + proxy - 如果代理地址不可用，则重新加载脚本

> ID：11214633
> 
> 赞同：1
> 
> 时间：2012-06-26T19:29:39.033
> 
> 标签：php, list, curl, proxy

我有一个问题 - 我正在使用 CURL 和 PROXY。我正在从付费网络服务获取代理地址列表。该列表如下所示（示例）：

```
123.456.789.012:1234
123.456.789.012:1234
123.456.789.012:1234
123.456.789.012:1234
123.456.789.012:1234
123.456.789.012:1234
123.456.789.012:1234 
```

假设上面提到的列表可以在这里找到：[http ://example.com/list_with_the_proxy](http://example.com/list_with_the_proxy)

我的 PHP 代码如下所示：

```
<?php
$url = 'http://connect.to.another.example.net/'; //I want to open this url using one of the proxy address from the list

$proxy_url = 'http://address.of.proxy.example.org';

function RandomLine($filename) { 
    $lines = file($filename) ; 
    return $lines[array_rand($lines)] ; 
} 

$random_proxy = RandomLine($proxy_url); 

$ch = curl_init(); 
curl_setopt($ch, CURLOPT_URL, $url); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt($ch, CURLOPT_HTTPPROXYTUNNEL, 1); 
curl_setopt($ch, CURLOPT_PROXY, $random_proxy); 
$data = curl_exec($ch); 
curl_close($ch); 
echo $data;

?> 
```

我注意到一些问题 - 有时某些代理不可用，并且网站正在加载和加载和加载......如果网站加载时间过长，是否有可能重新加载脚本并获取新的随机代理？例如，如果代理在 5 秒内没有响应，脚本会再次加载吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:02:08.213

`CURLOPT_TIMEOUT`当您在合理的时间内没有获得任何数据时，请查看并重新加载。您还确定来自代理列表站点的数据是否正确通过并且不会因此而挂起？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T00:38:53.030

实际上，您只是面临一个常见问题，即无论 PHP 还是 curl 都不会自动解决。这有很多原因，但更普遍的是因为你不能自动解决这个问题。

您想通过某个代理列表建立连接。但另一方面，您无法控制该列表中的代理。所以你可能会得到一个不工作的代理。

根据代理的定义，您要么需要信任该地址，要么放弃它。但是，如果您相信它，但您的决定是错误的，那么您可能会被愚弄。因为您使用了自动化措施，但没有告诉您是否可以相信代理列表来源是可靠的，所以我认为该来源并不真正可靠。因此，您遇到了希望轻松解决的问题，但实际上并非如此。

我无法判断这是否真的是一个问题。但是我可以说的是，stackoverflow.com 可能不是问您问题的正确网站。

所以这不是一个真正的答案，而是一个冗长的评论。答案是主观的，甚至没有建设性，因为您没有分享您的代理提供商的地址。

小心。并非所有这些代理列表都可以安全使用。但更普遍的是，不要期望所有这些代理都能真正起作用。这些列表可能会发生变化。有人说，你得到你所支付的，或者，当你寻找一个可靠的代理时，你为什么不自己运行一个呢？

# php - php大于数字的十进制数，没有round，ceil，floor

> ID：11214635
> 
> 赞同：2
> 
> 时间：2012-06-26T19:29:46.773
> 
> 标签：php

我在这里遇到了一个有趣的问题，通常我只是根据数字的需要分别向上/向下取整，但今天我发现自己必须非常具体。我正在研究一个有很多点版本的项目。它是一个基于 Web 的应用程序，带有一个客户端应用程序，如果您的客户端版本为 2.3 或更高版本，则该新功能将在软件中出现，则该新功能在应用程序中可用，如果没有，则需要被隐藏起来。所以我正在尝试

```
if($version >= 2.3){/*code to show*/} 
```

这似乎不适用于基于十进制的数字，是否有任何人知道的解决方法不涉及在任一方向舍入它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T19:30:39.123

有一个 PHP 函数可以解决这个特定的问题，称为[`version_compare()`](http://php.net/version_compare).

```
if( version_compare( $version, 2.3, '>=') >= 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:34:02.700

版本比较听起来很酷，但您确实需要使用该格式。

如果您不使用“PHP 标准化”版本号，则可以使用 bcmath`bccomp`比较 2 个十进制数字。

[http://www.php.net/manual/en/function.bccomp.php](http://www.php.net/manual/en/function.bccomp.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T14:49:30.967

我知道回答这个问题可能为时已晚，但这是我使用的功能：

```
if(!function_exists('CompareVersion')){
    function CompareVersion($v1='', $v2='', $s='>'){
        #   We delete all characters except numbers 0-9
        $regex = '/[^0-9]/';
        $v1 = preg_replace($regex, '', $v1);
        $v2 = preg_replace($regex, '', $v2);

        #   Wewill get the length of both string
        $lgt1 = strlen($v1);
        $lgt2 = strlen($v2);

        #   We will make sure that the length is the same by adding zeros at the end
        #   Example: 1031 and 30215 - 1031 is smaller then 1031 become 10310
        if($lgt2 > $lgt1){
            $v1 = str_pad($v1, $lgt2, 0, STR_PAD_RIGHT);
        } elseif($lgt1 > $lgt2){
            $v2 = str_pad($v2, $lgt1, 0, STR_PAD_RIGHT);
        }

        #   We remove the leading zeros
        $v1 = ltrim($v1, 0);
        $v2 = ltrim($v2, 0);

        #   We return the result
        switch($s){
            case '>':   return $v1 > $v2;
            case '>=':  return $v1 >= $v2;
            case '<':   return $v1 < $v2;
            case '<=':  return $v1 <= $v2;
            case '=':
            case '==':  return $v1 == $v2;
            case '===': return $v1 === $v2;
            case '<>':
            case '!=':  return $v1 != $v2;
            case '!==': return $v1 !== $v2;
        }
    }
} 
```

# python - 如何使用 wxpython 创建提示？

> ID：11214640
> 
> 赞同：0
> 
> 时间：2012-06-26T19:30:07.690
> 
> 标签：python, user-interface, wxpython

我有以下代码：

```
 try:
     redirect_url = self.auth.get_authorization_url()
     webbrowser.open_new(redirect_url)
 except tweepy.TweepError:
     print 'Error! Failed to get request token.'

     verifier=raw_input("Enter verification code: ")

 try:
     self.auth.get_access_token(verifier)
     print "Access granted"
     self.__key,self.__secret = self.auth.access_token.key,self.auth.access_token.secret
     self.set_tokens(self.__key,self.__secret)
     print self.__key, self.__secret
 except tweepy.TweepError:
     print "Error! Failed to get access token!" 
```

如何在实现 wx.Frame 时停止执行第二个 try-except 块。例如，以便在按下按钮之前它不会继续？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:49:46.053

可以将第二个块放入按钮按下回调吗？就像是

```
proceed_button.Bind(wx.EVT_BUTTON, self.process_auth_tokens) 
```

`process_auth_tokens`你的第二个街区在哪里。

不过，如果它执行网络 I/O，您可能希望在单独的线程上运行事件处理程序。

# visual-studio-2010 - Silverlight 3D XNA 错误 - 类型或命名空间不存在

> ID：11214644
> 
> 赞同：0
> 
> 时间：2012-06-26T19:30:15.400
> 
> 标签：visual-studio-2010, silverlight, 3d, xna

我正在尝试按照一些教程来构建 Silverlight 3D XNA 项目。

我能够显示 3D 表面，但是一旦我开始使用`Vector3`或`VertexPositionNormalTexture`（或使用任何 XNA 辅助实体），我就会发现类型或命名空间不存在。

我有这些包括：

```
using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Graphics;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Graphics; 
```

我在 Silverlight 项目中包含了参考，即：

```
Microsoft.Xna.Framework
Microsoft.Xna.Framework.Graphics
Microsoft.Xna.Framework.Graphics.Extensions
System.Windows.Xna 
```

还有一堆我不确定是否相关。这些在 .NET 选项卡下，也许我需要在其他地方获取它们，而这些不适合 Silverlight？我不确定。

我正在使用 Visual Studio 2010 Professional、Silverlight 5 和 XNA 4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T15:11:39.720

我已经设法让 XNA 在 Silverlight 中的不同项目中工作，我非常有信心我错过了一些东西。只需仔细检查所有内容。

# jquery - Google Maps API V3 灰色区域

> ID：11214651
> 
> 赞同：7
> 
> 时间：2012-06-26T19:30:51.687
> 
> 标签：jquery, api

我安装了 Google Maps API V3，但无法让调整大小功能正常工作。我已将脚本放在一个分区中显示地图，该分区在单击链接时会下拉，但是，它会在两侧显示灰色区域。据我所知，我已经阅读了必须在显示除法的脚本中具有调整大小功能的实例，但我无法正确实现它。

![在此处输入图像描述](../Images/a504bb51d0867f8d319c391b3a5cc74b.png)

这是导致划分 (class="content") 显示的代码：

```
 $(function() {
$('.action').click(function() {          
    var name = $(this).attr("name");
    var content = $('.content[name=' + name + ']');
    $('.content').not(content).hide('fast');
    content.slideToggle('fast');
}); 
```

我在 id 为“map”的 div 中有地图。

```
 <div class="map">
      <div id="map_canvas""></div>
  </div> 
```

我整晚都在网站的其他部分工作，目前相当杂乱无章。抱歉，如果我忘记发布解决此问题所需的内容。

在此先感谢，BC。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T19:37:41.863

您需要在谷歌地图上手动调整大小。

```
google.maps.event.trigger(map, 'resize') 
```

[参考](https://developers.google.com/maps/documentation/javascript/reference#Map)。

**更新**

```
<script type="text/javascript"> 
// Global Variable
var map;

// This is a global Function
function initialize() 
{ 
  // This variable is scoped only for the initialize function,
  // it is not available to other functions scoped globally
  var myOptions = 
  { 
    center: new google.maps.LatLng(-34.397, 150.644), 
    zoom: 8, 
    mapTypeId: google.maps.MapTypeId.ROADMAP 
  };

  // Instead of a function scoped map variable this should be global
  map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

  google.maps.event.trigger(map, 'resize') 
} 
</script> 
```

然后可以改成如下代码：

```
$(function() 
{
  $('.action').click(function() 
  {          
    var name = $(this).attr("name");
    var content = $('.content[name=' + name + ']');
    $('.content').not(content).hide('fast');
    // this uses the callback functionality
    // to only throw the trigger after the
    // animation finishes.
    content.slideToggle('fast',
      function() 
      {
        google.maps.event.trigger(map, 'resize');
      });
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-25T01:10:27.513

嘿，我意识到一个快速简单的解决方法：

```
function initialize() {
    var mapOptions = {
        center: new google.maps.LatLng(42.365885, -71.258658),
        zoom: 16,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
    google.maps.event.trigger(map,'resize');
}

$(document).on("pageshow", "#map", function () {
    initialize();
}); 
```

页面 div 称为“map”，地图 div 称为“map-canvas”。

这似乎是在显示页面时初始化地图。通过在用户打开地图时加载地图，这会使您的应用程序变慢，但它避免了由 dom 和诸如此类的错误引起的错误。这完全解决了我的phonegap + jquery mobile + google map app上的角落地图/灰色区域问题！

# jquery - 使用 jQuery 将基本目标 HTML 附加到 Google Maps iframe

> ID：11214653
> 
> 赞同：0
> 
> 时间：2012-06-26T19:31:06.760
> 
> 标签：jquery, google-maps, iframe

我在客户网站的 iframe 中使用 Google 地图，地图上的位置在其描述中包含外部链接。单击链接时，外部网站会在 iframe 中加载。我想找出一种使用 jQuery 在新浏览器窗口中打开外部链接的方法。我查看了 jQuery append() 并将基本目标 HTML 属性附加到 iframe 标记的头部，但我无法使其工作。

任何人都可以为这个问题提供一些帮助吗？

谢谢你。

麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T20:21:24.980

您能否获取所有 a 标签 iframe 并使用 attr 为每个链接添加目标 $('a').attr('target','_blank');

# java - 安卓文本框

> ID：11214656
> 
> 赞同：0
> 
> 时间：2012-06-26T19:31:11.177
> 
> 标签：java, android, android-edittext

我想将纬度和经度的值返回到我`EditText`的 s 中，我已经能够使用 a 来做到这一点，`Toast`但没有通过`EditText`. 请帮助

```
 // EditText latEditText = (EditText)findViewById(R.id.lat);
//EditText lngEditText = (EditText)findViewById(R.id.lng);

protected void showCurrentLocation(){
    Location location = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
    if (location != null){
        String message = String.format(
                                   "Current Location \n Longitude: %1$s \n Latitude: %2$s",
                                   location.getLongitude(), location.getLatitude()
                           );
                           Toast.makeText(LayActivity.this, message,
                                   Toast.LENGTH_LONG).show();
        //latEditText.setText(nf.format(location.getLatitude()).toString());
        //lngEditText.setText(nf.format(location.getLongitude()).toString());
    }
}

private class MyLocationListener implements LocationListener{

    @Override
    public void onLocationChanged(Location location) {
        // TODO Auto-generated method stub
        String message = String.format(
                  "New Location \n Longitude: %1$s \n Latitude:  %2$s",
                  location.getLongitude(), location.getLatitude()
                  );
               Toast.makeText(LayActivity.this, message, Toast.LENGTH_LONG).show();

        //latEditText.setText((int) location.getLatitude());
        //lngEditText.setText((int) location.getLongitude());

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:35:11.913

只要`latEditText`和`lngEditText`变量具有类范围，您就可以简单地让您的 Activity 实现 LocationListener：

```
public class Example extends Activity implements LocationListener 
```

然后这个工作：

```
public void onCreate(Bundle savedInstanceState) {
    ...
    Location location = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
    if(location != null)
        displayLocation(location);
}

public void onLocationChanged(Location location) {
    if(location != null) 
        displayLocation(location);
}

public void displayLocation(Location location) {
        latEditText.setText(location.getLatitude() + "");
        lngEditText.setText(location.getLongitude() + "");
    }
} 
```

**按照要求**

Soxxeh 指出您注释掉的代码正在传递 setText() 一个整数，这样做引用了一个资源（例如您的 strings.xml 中字符串的唯一 ID）。您想像上面的方法或 with 一样传递 setText() 实际的 String `setText(String.valueOf(location.getLatitude()))`。

希望有帮助。

# javascript - 将随机数传递给 Google 搜索

> ID：11214664
> 
> 赞同：1
> 
> 时间：2012-06-26T19:32:00.990
> 
> 标签：javascript, html

我想要做的是在两者之间生成一个随机数并创建一个可以搜索它的按钮。我坚持创建按钮来这样做。

我正在使用以下代码生成一个随机数：

```
<div id="random" onclick="javascript:document.getElementById('random').innerHTML = Math.floor(Math.random() * 1001);" > 
```

如何将功能添加到将谷歌随机生成的数字的按钮？

现在，我正在思考我们如何生成表单，谷歌用户在其中输入了什么，例如：

```
<form align = "center" action = "http://www.google.com/search"  target="_blank">
    <input name = "q"> <input type = "submit" value="Google !"> 
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:43:48.560

你真的不需要一个表格，一个普通的超链接就可以了。

```
<a href="javascript: window.open('http://www.google.com/search?q=' + Math.floor(Math.random() * 1001))">Google!</a> 
```

当然，如果你想使用图形按钮，你可以使用图像而不是文本，如果你想使用常规表单按钮，下面的方法就可以了……

```
<input type="button" onclick="window.open('http://www.google.com/search?q=' + Math.floor(Math.random() * 1001))" value="Google!" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:37:27.870

您可能会让按钮构建查询字符串并执行位置重定向。

我认为谷歌搜索结果页面的最小字符串是这样的：

[`https://www.google.com/search?q=RANDOM_STRING_HERE`](https://www.google.com/search?q=RANDOM_STRING_HERE)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:46:12.050

用表格解决

**标记：**

```
<form align = "center" action = "http://www.google.com/search"  target="_blank">
    <input id='random' type='hidden' name = "q"> 
    <input type = "submit" value="Google !"> 
</form> 
```

**Javascript：**

```
document.getElementById('random').value = Math.floor(Math.random() * 1001); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T19:50:16.990

这应该有效。:) 我试过了，效果很好。:)

```
<input type="hidden" name="random" id="random" value="" />
<input type = "submit" onclick="javascript:document.getElementById('random').value =         Math.floor(Math.random() * 1001); window.location ='https://www.google.com/?#hl=en&output=search&q=' +document.getElementById('random').value"value="Google !"> </div>​ 
```

# ruby-on-rails - 添加 “每个块”每个 2 结果与 rails 3

> ID：11214665
> 
> 赞同：4
> 
> 时间：2012-06-26T19:32:03.157
> 
> 标签：ruby-on-rails

我有一个每个块，例如：

```
<% for f in @following %>
 <div class="span6">
  <%= f.name %>
 </div>
<% end %> 
```

html结果：

```
<div class="span6"> John</div>
<div class="span6"> kevin</div>
<div class="span6"> Peter</div>
<div class="span6"> Andrew</div>
.
.
. 
```

我想添加一个`<div class="row"></div>`每 2 个结果，例如：

```
<div class="row">
 <div class="span6"> John</div>
 <div class="span6"> kevin</div>
</div>
<div class="row">
 <div class="span6"> Peter</div>
 <div class="span6"> Andrew</div>
</div> 
```

**我想每行显示 2 个结果。我该怎么做？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T19:39:07.187

签[出 each_slice](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-each_slice)

```
<% @following.each_slice(2) do |followers| %>
  <div class="row">
    <% followers.each do |f| %>
      <div class="span6">
        <%= f.name %>
      </div>
    <% end %>
  </div>
<% end %> 
```

# javascript - 如何使用变量向对象添加参数？

> ID：11214672
> 
> 赞同：0
> 
> 时间：2012-06-26T19:32:36.800
> 
> 标签：javascript

我有这段代码：

```
var ShopLogicOptions = {};
ShopLogicOptions.params = {orderId: "'" + JS_OrderNo + "'", cartItems:[JS_arrCartItems], subTotal: "'" + JS_SubTotal + "'",... 
```

如何正确地将变量 JS_OrderNo 放在它所在的位置？

另一台服务器收到这个：“'9134832'”，

它应该是这样的：'9134832'，

编辑：当我 document.write JS_OrderNO 它看起来像这个 9134832，所以我必须添加单引号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:34:49.867

删除引号。

```
var ShopLogicOptions = {};
ShopLogicOptions.params = {
    orderId: JS_OrderNo,
    cartItems: [JS_arrCartItems],
    subTotal: JS_SubTotal,
    ...
}; 
```

如果你真的需要一个字符串而不是一个数字，使用这个：

```
orderId: String(JS_OrderNo), 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:35:17.363

删除单引号

```
{orderId: "" + JS_OrderNo 
```

# ruby-on-rails - 如何强制 ActiveRecord 识别迁移中的架构更改？

> ID：11214673
> 
> 赞同：0
> 
> 时间：2012-06-26T19:32:38.167
> 
> 标签：ruby-on-rails, migration

我正在开发一个 Rails 项目，出于性能原因，该项目有一些用纯 SQL 编写的迁移。在我们稍后尝试运行之前，它们工作正常`change_column`。如果我们尝试一次性迁移，`change_column`迁移将失败并显示以下错误消息：

```
Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT NULL' at line 1: ALTER TABLE `articles` CHANGE `state` `web_state`  DEFAULT NULL 
```

大概 Rails 不知道我们在之前的迁移中是通过 SQL 迁移的。但是，如果我们`rake db:migrate`在失败后再次运行，一切都会完美运行。

如何强制 Rails 识别通过原始 SQL 所做的更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T04:48:59.897

我认为您正在寻找 reset_column_information

[http://apidock.com/rails/v3.2.3/ActiveRecord/ModelSchema/ClassMethods/reset_column_information](http://apidock.com/rails/v3.2.3/ActiveRecord/ModelSchema/ClassMethods/reset_column_information)

但是根据错误消息，我认为这不是正确的解决方法

# assembly - @登录汇编程序？

> ID：11214675
> 
> 赞同：2
> 
> 时间：2012-06-26T19:32:43.183
> 
> 标签：assembly, addressing-mode

我正在为信息系统课程做作业，教授决定使用伪汇编程序。他用

```
@ 
```

在

```
SUB @106, -2(104), 110 
```

那个符号是什么意思？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T19:43:31.913

在 DEC 的汇编语言（PDP-11、VAX）`@`中表示[*间接寻址模式*](http://www.cs.auckland.ac.nz/references/macvax/address-mode.html)，即额外的间接级别。

在您的情况下，`@106`意味着操作数的地址取自 address `106`。

# java - 如何将 \n 放入属性文件的值中？

> ID：11214681
> 
> 赞同：13
> 
> 时间：2012-06-26T19:33:03.190
> 
> 标签：java, properties

我正在使用 Java 属性文件，并希望将换行符放入一个值（用作给用户的消息的内容），以便此输出包含一个新行。

我尝试将它作为 \\n 放入（因为我必须转义反斜杠字符），但我最终得到一条带有 \n 的消息。

IE。

```
message=Dear Foo,\\n\\nThank you for signing up for Bar. 
```

给出：

```
Dear Foo,\n\nThank you for signing up for Bar. 
```

我想：

```
Dear Foo,

Thank you for signing up for Bar. 
```

我怎样才能解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-26T19:35:52.903

只需`\n`用于此目的

您正在使用转义字符转义，`\\`因此您正在`\n`打印

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T19:37:04.040

这应该这样做：

```
message=Dear Foo,\nThank you for signing up for Bar. 
```

# java - Smack 存在不起作用

> ID：11214684
> 
> 赞同：2
> 
> 时间：2012-06-26T19:33:11.657
> 
> 标签：java, smack

实际上，我使用 smack API 编写了一个 IM 服务（继承了谷歌聊天）。但是当我想打印好友列表和他们的存在时，编译模式显示所有存在不可用，但在调试模式下它显示真正的可用性！

我的代码是...

1-创建连接

```
public boolean openConnection() {
    ConnectionConfiguration connectionConfiguration = new ConnectionConfiguration("talk.google.com", 5222, "mail.google.com");
    this.connection = new XMPPConnection(connectionConfiguration);
    try {
        this.connection.connect();
    } catch (XMPPException e) {
        // TODO: Send Error Information To Programmer's Email Address
    }
    if(this.connection.isConnected()) {
        this.roster = this.connection.getRoster();
        this.roster.addRosterListener(new RosterListener() {
            public void entriesAdded(Collection<String> addresses) {}
            public void entriesDeleted(Collection<String> addresses) {}
            public void entriesUpdated(Collection<String> addresses) {}
            public void presenceChanged(Presence presence) {}
        });
        return true;
    }
    return false;
} 
```

2-登录

```
public boolean login(String jid, String password) {
    try { 
        this.connection.login(jid, password, "smack");
    } catch (XMPPException e) {
        // TODO: Send Error Information To Programmer's Email Address
    }
    if(this.connection.isAuthenticated()) return true;
    return false;
} 
```

3-好友列表

```
public void buddiesList() {
    Collection<RosterEntry> rosterEntries = this.roster.getEntries();
    for(RosterEntry rosterEntry: rosterEntries) {
        System.out.println(rosterEntry.username() + " === " + this.roster.getPresence(rosterEntry.getUser()));
    }
} 
```

4-实施

```
public static void main(String args[]) {
    IMService imService = new IMService();
    imService.openConnection();
    imService.login("google account", "password");
    imService.buddiesList();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:20:46.733

您的 RosterListener 不执行任何操作。当收到状态消息等信息时，您必须在此处放置代码以更新您的花名册。

您正在检索的存在是状态创建时的状态的时间快照。要使状态保持最新，您必须对 RosterListener 进行实际编码。[这在 getPresence()](http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/Roster.html#getPresence%28java.lang.String%29)方法的 Javadoc 中有明确说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-20T14:59:16.657

将听众添加到您的花名册可能会更好：

[https://www.igniterealtime.org/builds/smack/docs/latest/documentation/extensions/rosterexchange.html](https://www.igniterealtime.org/builds/smack/docs/latest/documentation/extensions/rosterexchange.html)

# macos - 如何将命令的结果用引号括起来以将其传递给另一个命令？

> ID：11214688
> 
> 赞同：1
> 
> 时间：2012-06-26T19:33:31.530
> 
> 标签：macos, firefox, for-loop, sed, find

这是针对苹果平台的。我的最终目标是查找并替换 firefox 首选项文件“prefs.js”中的一行以关闭更新。我希望能够为 Mac 上的所有帐户执行此操作，包括用户模板（示例中未包含该模板）。到目前为止，我已经能够获得包含 prefs.js 文件的所有路径的列表：

```
find /Users -name prefs.js 
```

然后我将旧偏好和新偏好放入变量中：

```
oldPref='user_pref("app.update.enabled", false);'
newPref='user_pref("app.update.enabled", true);' 
```

然后我有一个带有 sed 命令的“for 循环”，用新的首选项替换旧的首选项：

```
for prefs in `find /Users -name prefs.js`
  do
  sed "s/$oldPref/$newPref/g" "$prefs"
done 
```

我遇到的问题是“查找”命令返回完整路径，路径名中带有愚蠢的“应用程序支持”，如下所示：

```
/Users/admin/Library/Application Support/Firefox/Profiles/437cwg3d.default/prefs.js 
```

当命令运行时，我收到以下错误：

```
sed: /Users/admin/Library/Application: No such file or directory
sed: Support/Firefox/Profiles/437cwg3d.default/prefs.js: No such file or directory 
```

我假设我需要以某种方式获取“find”命令以将输出路径用引号括起来，以便“sed”命令正确解析它？我在正确的道路上吗？我试图将 find 命令通过管道传递到 sed 以换行引号，但我无法让任何东西正常工作。请让我知道我是否应该以不同的方式处理这个问题。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:47:21.700

您不想`for prefs in ...`在从`find`. 有关为什么这不好的更完整解释，请参阅[Greg 的关于解析 ls 的 wiki 页面](http://mywiki.wooledge.org/ParsingLs)。如果您可以使用 glob 匹配文件，则只能在 bash 中使用 for 循环，如果您想递归地执行此操作，这很困难。

如果你可以摆动它，它会更好，`find ... -exec ...`而不是使用它。也许是这样的：

```
find /Users -name prefs.js -exec sed -i.bak -e "s/$oldPref/$newPref/" {} \; 
```

命令行对.`sed`找到的每个文件执行一次`find`。被`{}`文件名替换。Sed 的`-i`选项允许您就地运行它，而不需要标准输入/标准输出。检查手册页以获取使用详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:53:14.073

（一粒盐：我是基于我对 linux 的经验）

我认为这与 sed 的关系不大，而与 for 循环数组的形成方式有关。当 find 的结果转换为数组时，Application 和 Support 之间的空格被视为分隔符。

有几种方法可以解决这个问题，但最简单的可能是更改 IFS 变量。IFS 变量是您的命令行解释器用来分隔字段的内部变量（[更多信息](http://tldp.org/LDP/abs/html/internalvariables.html#IFSREF)）。您可以在运行 find 命令之前更改环境的 IFS 变量。

[从这里](http://www.cyberciti.biz/tips/handling-filenames-with-spaces-in-bash.html)修改的例子：

```
#!/bin/bash
SAVEIFS=$IFS
IFS=$(echo -en "\n\b")
for f in `find /Users -name prefs.js`
do
  echo "$f"
done
# restore $IFS
IFS=$SAVEIFS 
```

# android - jquery - 在Android浏览器中返回xml而不是json的http post请求

> ID：11214690
> 
> 赞同：0
> 
> 时间：2012-06-26T19:33:44.400
> 
> 标签：android, jquery, json

当我尝试使用 jQuery 发出 http POST 请求时，我只在较旧的 android 浏览器中看到一个问题。我得到的回应是——

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
  <application xmlns="http://wadl.dev.java.net/2009/02">
    <doc xmlns:jersey="http://jersey.java.net/" jersey:generatedBy="Jersey: 1.12 02/15/2012 05:30 PM"/>
    <grammars>
      <include href="http://myURL">
        <doc xml:lang="en" title="Generated"/> 
      </include>
    </grammars>
    <resources base="http://myURL2">
      <resource path="register"/> 
    </resources>
  </application> 
{"myID":"abcd"} 
```

这在最后的 json 内容前面有一个 xml 标头。

在其他浏览器（甚至是 android 4.0 操作系统）上，我得到了预期的内容——

```
{"myID":"abcd"} 
```

我提出如下要求——

```
$.ajax({
    type: type,
    contentType: contentType,
    dataType: 'json',
    url: url,
    data: postData,
    success: function(data){
        $.isFunction(successCb) && successCb(data); 
    },  
    error: function(data1){  
        $.isFunction(failureCb) && failureCb(data1);  
    }  
}); 
```

知道问题可能是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:44:46.653

[http://jsfiddle.net/RF23z/1/](http://jsfiddle.net/RF23z/1/)

[http://fiddle.jshell.net/RF23z/1/show/](http://fiddle.jshell.net/RF23z/1/show/)

在我的 android 2.2 和 4.0.4 上对此进行了测试，对我来说效果很好。

你能确保来自服务器的响应发送一个 json 标头吗？

# ruby-on-rails - 使用 Rails 和 Sendgrid 创建电子邮件应用程序

> ID：11214703
> 
> 赞同：1
> 
> 时间：2012-06-26T19:34:22.097
> 
> 标签：ruby-on-rails, sendgrid

我目前正在尝试使用 Rails 和 Sendgrid 创建一个电子邮件应用程序。此应用程序应具有发送电子邮件的基本功能。有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:24:56.860

除非您受限于使用自己的服务器，否则我建议您从[Heroku 的 SendGrid Package](https://addons.heroku.com/sendgrid)开始。它是免费的，而且很容易设置和开始。这是[入门指南](https://devcenter.heroku.com/articles/sendgrid)。

设置 sendgrid 后，您可以像往常一样使用[ActionMailer](http://guides.rubyonrails.org/action_mailer_basics.html)。

# machine-learning - 理解逻辑回归的概率解释

> ID：11214704
> 
> 赞同：2
> 
> 时间：2012-06-26T19:34:27.940
> 
> 标签：machine-learning, classification

我在发展对逻辑回归的概率解释的直觉时遇到问题。具体来说，为什么将逻辑回归函数的输出视为概率是有效的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T16:17:11.270

通过对类条件密度（即给定类，属于该类的概率是多少）和类先验（即类的概率是多少）进行建模，任何类型的分类都可以被视为*概率生成模型*，因此我们可以应用贝叶斯定理来获得后验概率（即给定x，它属于类的概率是多少）。它被称为*生成*，因为正如 Bishop 在他的书中所说，您可以使用该模型通过从边际分布中提取 的值来生成合成数据。`p(x|C_k)``C_k``x``p(C_k)``C_k``p(C_k|x)``C_k`*`x``p(x)`*

 *这一切只是意味着每次你想将某物分类到一个特定的类别（例如肿瘤的大小是恶性的还是良性的），就会有可能是对还是错。

逻辑回归使用[sigmoid 函数](http://en.wikipedia.org/wiki/Sigmoid_function)（或逻辑函数）来对数据进行分类。由于此类函数的范围从 0 到 1，因此您可以轻松地将其视为概率分布。最终，您正在寻找`p(C_k|x)`（在示例中，`x`可能是肿瘤的大小，C_0 代表良性和 C_1 恶性的类别），在逻辑回归的情况下，这由以下模型建模：

`p(C_k|x) = sigma( w^t x )`

其中`sigma`是 sigmoid 函数，`w^t`是转置的权重集`w`，`x`是您的特征向量。

我强烈建议您阅读[Bishop 的书的](http://research.microsoft.com/en-us/um/people/cmbishop/prml/)第 4 章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-23T12:56:41.950

• Logistic 回归的概率解释基于以下 3 个假设：

1.  特征是实值高斯分布。
2.  响应变量是伯努利随机变量。例如，在二元类问题中，yi = 0 或 1。
3.  对于所有 i 和 j!=i，xi 和 xj 在给定 y 的情况下是条件独立的。（朴素贝叶斯假设）

所以本质上，

**Logistic-Reg = 高斯朴素贝叶斯 + 伯努利类标签**

• 如下图所示的优化方程：

[![在此处输入图像描述](../Images/2ce728982dda864b2b6260960c0ad673.png)](https://i.stack.imgur.com/k0rxp.png)

• P(y=1 or 0/X) 的方程式如下图所示：

[![在此处输入图像描述](../Images/fdbb84e4c0be6c7d3979bbc7fdfc686b.png)](https://i.stack.imgur.com/8plSt.png)

• 如果我们做一些数学运算，我们可以看到逻辑回归的几何和概率解释都归结为同一件事。

• 此[链接](https://www.cs.cmu.edu/%7Etom/mlbook/NBayesLogReg.pdf)有助于了解有关逻辑回归和朴素贝叶斯的更多信息。*

# android - Android 线程错误消息

> ID：11214708
> 
> 赞同：0
> 
> 时间：2012-06-26T19:34:47.660
> 
> 标签：android, multithreading

```
package your.splash.namespace;

import android.app.Activity;
import android.os.Bundle;
import android.view.MotionEvent;
import android.widget.TextView;

public class SplashScreenActivity extends Activity{

protected boolean _active = true;
protected int _splashTime=1500;  //The timeout 
TextView tv;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    tv=(TextView) findViewById(R.id.stext);

   Thread splashThread = new Thread()
    {
        @Override
        public void run()
        {
            try
            {
                int waited=0;

                      //the thread will stop if _active==false and bigger than _splashTime
                while(_active && (waited < _splashTime))
                {
                    sleep(100);

                    if(_active)
                    {
                        waited +=100;
                    }
                }
            }catch(InterruptedException e)
            {

            }
            finally
            {
                tv.setText("how"); //when it is timeout, the text will change to this one
            }
        }

    };

    splashThread.start();
}

//When user press screen, it set _active to false to stop the thread
public boolean onTouchEvent(MotionEvent event)
{
   if(event.getAction()==MotionEvent.ACTION_DOWN)
   {
       _active = false;
   }

   return true;
}
} 
```

我只想在线程超时时将文本“如何”设置为 TextView。这个程序可以在 Eclipse 中运行。但是，当线程超时时，弹出错误消息“不幸的是，SplashScreen 已停止”出现，然后在我按下 OK 按钮后程序退出（停止）。怎么了？怎么修？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:36:51.777

```
 tv.setText("how"); is in onon UI thread... 
```

你不能在其他 UI 线程中做 UI 相关的工作......

```
finally
            {

runOnUiThread(new Runnable() {
    public void run() {
       tv.setText("how");
    }
});

} 
```

# sed - 使用 sed，如何匹配字符类中的方括号？

> ID：11214715
> 
> 赞同：9
> 
> 时间：2012-06-26T19:34:55.553
> 
> 标签：sed

这是原始数据的一部分：

```
00000000  54 6f 70 69 63 20 46 6f  72 75 6d 20 52 65 70 6c  |Topic Forum Repl|
00000010  69 65 73 20 4c 61 73 74  20 70 6f 73 74 20 31 20  |ies Last post 1 |
00000020  4c 69 6e 75 78 20 54 6f  64 61 79 20 31 34 3a 34  |Linux Today 14:4|
00000030  36 3a 35 37 20 62 79 20  4c 69 6e 75 78 20 4f 75  |6:57 by Linux Ou|
00000040  74 6c 61 77 73 20 32 36  39 20 e2 80 93 20 53 6f  |tlaws 269 ... So|
00000050  6d 65 6f 6e 65 20 4b 6c  6f 73 65 20 54 68 61 74  |meone Klose That|
00000060  20 4f 75 74 6c 61 77 73  20 32 38 20 73 79 73 79  | Outlaws 28 sysy|
00000070  70 68 75 73 2e 6a 6f 6e  65 73 20 48 6f 6c 65 20  |phus.jones Hole |
00000080  62 79 20 59 4f 42 41 20  5b 20 31 20 32 20 5d 20  |by YOBA [ 1 2 ] |
00000090  32 20 4c 69 6e 75 78 20  26 20 54 6f 64 61 79 20  |2 Linux & Today |
000000a0  31 31 3a 34 34 3a 35 31  20 62 79 20 4c 6f 6f 6b  |11:44:51 by Look|
000000b0  73 20 6c 69 6b 65 20 43  61 6e 6f 6e 69 63 61 6c  |s like Canonical|
000000c0  20 69 73 20 61 6e 6e 6f  75 63 69 6e 67 20 70 6c  | is annoucing pl|
000000d0  61 6e 73 20 46 72 65 65  64 6f 6d 20 31 20 6b 72  |ans Freedom 1 kr| 
```

这是一个十六进制转储，我有兴趣隔离文本部分。这是一个几乎可以工作的 sed 表达式：

```
$ sed 's/.* |\([a-zA-Z0-9:& \.]*\)|$/\1/g' hex.dat 
Topic Forum Repl
ies Last post 1 
Linux Today 14:4
6:57 by Linux Ou
tlaws 269 ... So
meone Klose That
 Outlaws 28 sysy
phus.jones Hole 
00000080  62 79 20 59 4f 42 41 20  5b 20 31 20 32 20 5d 20  |by YOBA [ 1 2 ] |
2 Linux & Today 
11:44:51 by Look
s like Canonical
 is annoucing pl
ans Freedom 1 kr 
```

几乎。但是如何过滤最后一行呢？

```
$ sed 's/.* |\([a-zA-Z0-9:&\[\] \.]*\)|$/\1/g' hex.dat 
```

和：

```
 $ sed 's/.* |\([a-zA-Z0-9:&\\[\\] \.]*\)|$/\1/g' hex.dat 
```

根本不工作（他们无法翻译任何东西）。

和：

```
$ sed 's/.* |\([a-zA-Z0-9:&[] \.]*\)|$/\1/g' hex.dat 
```

显然不能工作。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-26T19:42:30.797

你几乎拥有它。

[查看Unix 正则表达式教程](http://www.grymoire.com/Unix/Regular.html#uh-6)的这一部分。

你可以这样做的方法是在你开始你的角色课程后立即放置][。

所以，试试`sed 's/.* |\([][a-zA-Z0-9:& \.]*\)|$/\1/g' hex.dat`

为了澄清起见，在字符类中的哪个位置并不重要，`[`只要您打算在字符类中包含的右括号 ( `]`) 紧跟在字符类的开头之后。

此外，作为进一步的编辑，尝试输入`man cut`和使用 Tomasz 在评论中所说的内容。

`cut -d='|' -f2 hex.dat`将剪切您的文件，在管道上定界，并获取第二个字段。

# javascript - 是否可以使用 javascript 更改 http 请求的标头？

> ID：11214718
> 
> 赞同：9
> 
> 时间：2012-06-26T19:35:03.997
> 
> 标签：javascript, jquery, ajax, http

是否可以使用某种 JavaScript 来更改或设置 HTTP 请求的标头？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-26T19:44:35.337

在下载 javascript 之前很久就传递了标头，更不用说解释了。简而言之，答案是否定的。

但是，如果您在 ajax 调用的上下文中说话（我们以 jQuery 为例），则可以编写请求标头。

请参阅[使用 jQuery 从 AJAX 调用中读取标头](https://stackoverflow.com/questions/1557602/jquery-and-ajax-response-header)。[在使用 jQuery 进行 AJAX 调用之前，](https://stackoverflow.com/questions/3073287/set-headers-with-jquery-ajax-and-jsonp)请参阅设置标头

但是，如果您的 javascript 是服务器端的（例如 node.js），那将是肯定的（可能不是因为帖子提到了 HTML）：

```
var body = 'hello world';
response.writeHead(200, {'Content-Length': body.length,'Content-Type': 'text/plain' }); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-26T19:46:18.563

使用 XMLHttpRequest 对象，您可以使用该`setRequestHeader`函数。

一个小代码让你上路：

```
var xhr = new XMLHttpRequest()
xhr.open("GET", "/test.html", true);
xhr.setRequestHeader("Content-type", "text/html");

xhr.send(); 
```

该方法`setRequestHeader` **必须**在打开之后和发送之前调用。

更多信息： [https://developer.mozilla.org/en/DOM/XMLHttpRequest#setRequestHeader()](https://developer.mozilla.org/en/DOM/XMLHttpRequest#setRequestHeader())

# php - php图片文件上传-php×241958

> ID：11214719
> 
> 赞同：0
> 
> 时间：2012-06-26T19:35:04.330
> 
> 标签：php

我是 PHP 新手，并从书中复制了这段代码。在文件 upload.html 中：

```
 <form method="POST" action="do_upload.php" enctype="multipart/form-data">
 <input type="file" name="img1" size="30"></p> 
```

在 PHP 脚本 do_upload.php 中：

```
if($_FILES["img1"] != "") {
    echo "file selected"; else die("Couldnot copy the file");
} 
```

但我得到一个错误说：

> 未定义索引：第 2 行 C:\xampp\htdocs\test23\do_upload.php 中的 img1

为什么 img1 被称为`undefined index`即使`name="img1"`在 upload.html 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T20:24:15.800

如果你没有选择一个文件，那么`$_FILES['img1']`将不存在。

如果您没有在服务器上启用上传，则`$_FILES`不会存在。

确保以上两项。

# java - GSON：应为 BEGIN_OBJECT，但为 STRING

> ID：11214720
> 
> 赞同：15
> 
> 时间：2012-06-26T19:35:05.467
> 
> 标签：java, json

我在尝试将 JSON 解组为对象时遇到 GSON 错误。错误（**Expected BEGIN_OBJECT but was STRING at line 3 column 22**）指向下面输入的第 3 行。

我没有正确映射 JSON 到 Bean 吗？

```
import javax.xml.bind.JAXBElement;

public class BusinessPartnerCreate {
    protected JAXBElement<String> partnerType;
    protected Person person;
    protected Company company;
    protected String email;
    protected String phone;
    protected AddressData addressData;
    protected AddressClean addressClean;
    protected String city;
    protected String state;
    protected String zipCode;
    protected JAXBElement<String> externalId;
} 
```

我的输入 JSON 看起来是这样的：

```
{
    "business-partner-create": {
        "partner-type": "1",
        "person": {
            "firstName": "Dirk",
            "lastName": "Wintermill",
            "title": ""
        },
        "email": "kirk@yahoo.com",
        "phone": "219-385-2946",
        "addressClean": {
            "house-number": "10218",
            "street-name": "Park",
            "street-abbr": "Rd"
        },
        "city": "Somerset",
        "state": "NJ",
        "zip-code": "01955"
    }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-26T19:37:53.790

不，您没有正确映射它，因为您的 json 对象不是 a `BusinessPartnerCreate`，它包含 a `BusinessPartnerCreate`。

您可以创建一个类来封装您的`BusinessPartnerCreate`，但将容器反序列化为`jsonObject`使用会更干净

```
 JsonParser parser = new JsonParser();
 JsonObject obj = parser.parse(json).getAsJsonObject(); 
```

然后使用解析有趣的内容

```
BusinessPartnerCreate bpc = gson.fromJson(obj.get("business-partner-create"), BusinessPartnerCreate.class); 
```

我建议您添加注释以确保正确映射该`partnerType`字段：

```
 @SerializedName "partner-type"
   protected JAXBElement<String> partnerType; 
```

（和类似的邮政编码）

# php - 如何在 MySQL 数据库中存储评分

> ID：11214722
> 
> 赞同：0
> 
> 时间：2012-06-26T19:35:11.403
> 
> 标签：php, mysql

> **可能重复：**
> [PHP 和 MySQL 中的评级系统](https://stackoverflow.com/questions/1187365/rating-system-in-php-and-mysql)

我正在研究一个从 1 到 10 的评分系统。我希望能够跟踪所有用户的评分以及他们是否已经对该特定项目进行了评分。

注意：-我有一个登录，所以每个用户在数据库中都有一个唯一的 ID。- 每个特定项目也有一个唯一的 ID。

我的问题是：我应该如何以最好的方式将这些信息准确地存储在数据库中。

这就是我的想法：

```
Unique_Key | Item_ID | User_ID | User_rating
     1          1           1           (1-10)
     2          1           2           (1-10)
     3          2           2           (1-10)
     4          3           1           (1-10)
     5          4           1           (1-10) 
```

因此，如果用户正在评分的 Item_ID 已经在带有 User_ID 的数据库中，他们将无法评分，否则他们可以。

在开始任何编码之前，如果这是一种安全、干净的方法，我正在寻找建议。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:37:53.597

如果您向您的`itemID`-`userID`组合添加唯一键，那么这将是存储该信息的保存方法。

您可以像这样添加唯一键

```
ALTER TABLE your_table
ADD UNIQUE (itemID, userID); 
```

> UNIQUE 约束唯一标识数据库表中的每条记录。UNIQUE 和 PRIMARY KEY 约束都为一列或一组列提供唯一性保证。

# java - 在 Servlet 中使用 Batik 时出错

> ID：11214726
> 
> 赞同：2
> 
> 时间：2012-06-26T19:35:19.330
> 
> 标签：java, tomcat, batik

我不确定问题出在 apache 服务器还是蜡染上。我正在尝试使用 servlet 中的 Batik 将 svg 转换为 java 中的图像。当我在 servlet 中实例化 SVGConverter

`SVGConverter svgConverter = new SVGConverter()`

Apache 返回此错误：

```
Jun 26, 2012 3:28:10 PM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet [FCImg] in context with path [/jsp_batik] threw  exception [Servlet execution threw an exception] with root cause
java.lang.NoClassDefFoundError: org/apache/batik/apps/rasterizer/SVGConverter
at FCImg.doPost(FCImg.java:49)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:662) 
```

我在项目中包含了正确的 jar 文件，并且在编译实例化 SVGConverter 对象的 java 文件时似乎没有任何错误。

任何建议都有帮助，谢谢！

编辑：我只需要在 WEB-INF/lib 文件夹中包含必要的 jar 文件（所有蜡染 jar 文件）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:37:18.253

WEB-INF/lib 中可能缺少 batik-rasterizer.jar。

# javascript - 为什么平滑滚动只能第一次工作？

> ID：11214728
> 
> 赞同：1
> 
> 时间：2012-06-26T19:35:26.943
> 
> 标签：javascript, scroll

我在[网站](http://www.coffeebeansandotherlies.com/)上使用以下代码来模仿平滑滚动：

```
function scrollWindow() {
    // window.scrollBy(1040,0)
    var timerID = setInterval(function() {
        window.scrollBy(104, 0);
        if( window.pageXOffset >= 1040 ) clearInterval(timerID);
    }, 10);
} 
```

但是，在单击 Scroll（scrollWindow 函数）后，页面会像应有的那样滚动 1040。

任何后续时间，它都不起作用，除非我手动滚动回到开头。

我认为`if( window.pageXOffset >= 1040 )`取消它是否正确，因为虽然它没有*移动*1040，但它已经超过了页面上的那个点？

如果是这样，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:59:33.103

是的，您的评估是正确的；但可以通过改变方法来纠正它：

```
function scrollWindow() {
    var scrolledSoFar = 0;
    var scrollStep = 104;
    var scrollEnd  = 1040;
    var timerID = setInterval(function() {
        window.scrollBy(scrollStep, 0);
        scrolledSoFar += scrollStep;
        if( scrolledSoFar >= scrollEnd ) clearInterval(timerID);
    }, 10);
} 
```

**更新**
代码中的另一个缺陷是您`scrollBy`在检查条件之前执行。因此，在您的页面上，即使您滚动超过 1040，单击`scroll`也会将页面移动一个`scrollStep`量。为了防止这种情况，这个顺序更好：

```
function scrollWindow() {
    var scrolledSoFar = 0;
    var scrollStep = 104;
    var scrollEnd  = 1040;
    var timerID = setInterval(function() {
        if( scrolledSoFar < scrollEnd ) {
            window.scrollBy(scrollStep, 0);
            scrolledSoFar += scrollStep;
        } else {
            clearInterval(timerID);
        }
    }, 10);
} 
```

# postgresql - 当 n<2 时，postgres STDDEV 聚合行为

> ID：11214732
> 
> 赞同：4
> 
> 时间：2012-06-26T19:35:45.320
> 
> 标签：postgresql, null, statistics, aggregate, standard-deviation

我的`Postgres`查询根据`aggregate`一堆传感器读数计算统计数据：

```
SELECT to_char(ipstimestamp, 'YYYYMMDDHH24') As row_name, 
to_char(ipstimestamp, 'FMDD mon FMHH24h') As hour_row_name, 
varid As category, 

(AVG(ipsvalue)::NUMERIC(5,2)) ||', ' || 
(MAX(ipsvalue)::NUMERIC(5,2))::TEXT  ||', ' || 
(MIN(ipsvalue)::NUMERIC(5,2))::TEXT  ||', ' || 
(STDDEV(ipsvalue)::NUMERIC(5,2))::TEXT  ||', ' As StatisticsValue 

FROM loggingdb_ips_integer As log 
JOIN ipsobjects_with_parent ips ON log.varid = ips.objectid 
AND (ipstimestamp > (now()- '2 days'::interval)) 
GROUP BY row_name, hour_row_name, category; 
```

只要我有这工作正常`>1 ipsvalue/hour`。`COUNT(ipsvalue)<2`但是，如果 hourly`StatisticsValue`返回时`NULL`没有任何 Postgres 错误。

如果我注释掉`STTDEV`，如下所示：

```
(AVG(ipsvalue)::NUMERIC(5,2)) ||', ' || 
(MAX(ipsvalue)::NUMERIC(5,2))::TEXT  ||', ' || 
(MIN(ipsvalue)::NUMERIC(5,2))::TEXT  ||', ' As value 
```

然后正确计算所有三个统计数据。因此，我得出结论，一个不正当的人`STDDEV`会破坏整个查询。我宁愿让非法的 STDDEV 返回 0。我尝试了`COALESCE`这`STDDEV`条线，但无济于事。可以做什么？？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T19:43:41.927

`COALESCE`应该管用。

您也可以使用（适合您的）“[总体标准差](http://www.postgresql.org/docs/9.0/static/functions-aggregate.html#FUNCTIONS-AGGREGATE-STATISTICS-TABLE)” `stddev_pop`，而不是“样本标准差” `stddev_samp`；后者除以`n-1`并别名为`STDDEV`。 `stddev_pop`, 相反, 除以, 并且在给定一个样本时`n`返回零（而不是）。`NULL`

如果您不知道这些估计器之间的区别，则在每本统计教科书中都有解释，例如[http://en.wikipedia.org/wiki/Standard_deviation#Estimation](http://en.wikipedia.org/wiki/Standard_deviation#Estimation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T10:38:21.160

我找到了一种替代 COALESCE 的解决方法。在我的具体实例中，COALESCE 可能会表现得更好，但解决方法可能更灵活。

我利用了[Emanuel Calvo Franco 和 Hector de los Santos 描述的 IIF 模拟](http://wiki.postgresql.org/wiki/Simulating_iif_function)。IIF 的工作方式与 MS Access 中的同源物非常相似。在我的实例中，IIF 函数测试 STDDEV 的结果是否为 NULL，如果为真则返回“0”。IIF 的好处是它可以测试各种条件，而不仅仅是 NULL。

# javascript - Spring MVC 框架（从 UI 到完成事务的过程）

> ID：11214733
> 
> 赞同：0
> 
> 时间：2012-06-26T19:35:46.927
> 
> 标签：javascript, ajax, spring, spring-mvc, javabeans

我已经开始认真阅读这个框架，我正在了解 DI 是在哪里以及如何完成的。我查看的示例向我展示了硬编码和引用但并非真正从 UI 到数据库的值。我想知道，只是看这里的大图，我想知道在一个实际与 AJAX 框架集成的实际应用程序中，信息（用户输入）如何到达 bean。

告诉我这个过程是否正确，是 java 脚本调用容器以查找函数（通过映射），setter 用于从用户输入设置类的 bean（POJO）值，然后已经被注入的 bean 使用这些值来执行功能。我只是想清楚数据如何从 UI 到 bean 以完成事务的过程和各种技术的作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:01:23.627

Ajax 请求进行了一些 http 调用。spring XML（或注释）将路由映射到控制器。URL 参数由 spring 解码并映射（并且可以选择验证）到命令对象（这是控制器方法的参数）。然后发生一些数据库查找和/或业务逻辑。由于它是一个 Ajax 调用，您通常会返回由某个映射库（Jackson、gson 等）生成的 json。

# mysql - 使用主键和连接唯一索引对 MySQL 表进行分区

> ID：11214737
> 
> 赞同：3
> 
> 时间：2012-06-26T19:35:52.437
> 
> 标签：mysql, database, partitioning

我有一个表存储大约 40K 企业的每周查看统计信息，这些表通过了 220 万条记录并且开始减慢速度，我正在考虑对其进行分区以加快速度，但我不确定如何最好地做到这一点。

我的 ORM 需要一个 id 字段作为主键，但该字段与数据无关，我一直在字段上使用唯一索引来表示年份、周数和业务 ID。

由于我需要主键参与分区映射，因此我不确定如何最好地组织它（我以前从未使用过分区）。

目前我有...

```
 CREATE TABLE `weekly_views` (
    `id` int(11) NOT NULL AUTO_INCREMENT,
    `business_id` int(11) NOT NULL,
    `year` smallint(4) UNSIGNED NOT NULL,
    `week` tinyint(2) UNSIGNED NOT NULL,
    `hits` int(5) NOT NULL,
    `created` timestamp NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    `updated` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
    UNIQUE `search` USING BTREE (business_id, `year`, `week`),
    UNIQUE `id` USING BTREE (id, `week`)
) ENGINE=`InnoDB` AUTO_INCREMENT=2287009 DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ROW_FORMAT=COMPACT CHECKSUM=0 DELAY_KEY_WRITE=0 PARTITION BY LIST(week) PARTITIONS 52 (PARTITION p1 VALUES IN (1) ENGINE = InnoDB,
 PARTITION p2 VALUES IN (2) ENGINE = InnoDB,
 PARTITION p3 VALUES IN (3) ENGINE = InnoDB,
 PARTITION p4 VALUES IN (4) ENGINE = InnoDB,
(5 ... 51)
 PARTITION p52 VALUES IN (52) ENGINE = InnoDB); 
```

每周一个分区似乎是分解它们的唯一合乎逻辑的方法。我是否正确，当我使用“business_id = xx and week = xx and year = xx”搜索当前周/业务的记录时，它会知道使用哪个分区而不搜索所有分区？但是，当我得到结果并通过 ORM 保存它时，它会使用 id 字段并且不知道要使用哪个分区？

我想我可以使用自定义查询来插入或更新（我最初没有这样做，因为 ORM 不支持它）。

我是否采取了正确的方法，还是有更好的方法来对这样的表进行分区？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T11:53:20.193

只要查询`week`在子句中有列`WHERE`，MySQL 就会在正确的分区中查找。但是，每年都会重复数周，您最终会在同一分区中获得不同年份的数据。

此外，您需要 53 而不是 52 个分区，因为您需要处理闰年。

# vb.net - 如何使用 Graphics.CopyFromScreen 启用 alpha 透明控件？

> ID：11214744
> 
> 赞同：0
> 
> 时间：2012-06-26T19:36:23.103
> 
> 标签：vb.net, winforms, transparency, alpha-transparency

我正在尝试在我的控件的 OnPaint() 方法中使用（这可能已经是我的问题）e.Graphics.CopyFromScreen() 来准备可以在其上绘制控件内容的背景。目标是一个带有圆角和其他特定功能的工具提示，以替换默认的 Windows 工具提示。

理想情况下，工具提示可以抗锯齿并混合到背景中，但是在紧要关头我可以容忍锯齿边界。这也可能是必要的，因为控件通常会覆盖带有 OpenGL 覆盖的控件，并且整个混合过程可能最终成为一场噩梦。

我创建了一个自定义用户控件，它的持久实例属于我的应用程序的主窗体，覆盖了 OnPaint 和 OnPaintBackground 方法。然而，透明度的应用具有挑战性。据我了解，传递给paint方法的图形对象从当前VisibleClipBounds的副本开始，通常第一步是用纯色清除控件并开始绘制主要特征。我的第一个想法是绕过填充并开始在捕获的背景上绘图。对于第一次重绘，这可以正常工作，但随后的重绘会保留以前的内容，而不是重新捕获背景。我希望 CopyFromScreen 会专门从其捕获中消除当前的绘图控件，以便从一个干净的基础开始，但事实并非如此，

其他解决方案及其排列，例如

```
SetStyle(ControlStyles.SupportsTransparentBackColor, True)

Me.BackColor = Color.Transparent

e.Graphics.Clear(Color.FromArgb(0,0,0,0)) 
```

迄今为止没有产生适当的结果。

我从使用透明键颜色的透明表格开始。这适用于别名，但使用表单作为工具提示似乎过多并导致烦人的伪影（其中一些可以克服），例如任务栏按钮的临时存在，底层表单的焦点丢失以及随后在主机表单标题中的视觉反馈酒吧颜色。控件的重量要轻得多，但我正在努力使它与表单一样好用。

在这一点上，我只是问如何达到预期的结果，以及 CopyFromScreen 是否是该解决方案的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T20:03:27.730

这是要阅读的大量文本 - 但解决透明度以实现自定义形状的表单/控件...... Control.Region 可以做同样的事情：

```
[DllImport("Gdi32.dll", EntryPoint = "CreateRoundRectRgn")]
private static extern IntPtr CreateRoundRectRgn
(
    int nLeftRect, // x-coordinate of upper-left corner
    int nTopRect, // y-coordinate of upper-left corner
    int nRightRect, // x-coordinate of lower-right corner
    int nBottomRect, // y-coordinate of lower-right corner
    int nWidthEllipse, // height of ellipse
    int nHeightEllipse // width of ellipse
    );

private void CreateRegion()
{
    this.Region = System.Drawing.Region.FromHrgn(CreateRoundRectRgn(0, 0, Width, Height, 40, 40));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T03:36:30.907

如果您的控件设置为顶级窗口并且您在 Windows 7 或 8 上运行它，请检查 DwmEnableBlurBehindWindow。在参数结构中，我将 enable 设置为 true，并为模糊创建一个 1x1 像素的区域。将 BackColor 和 TransparencyKey 设置为黑色，这给了我一个完全透明的窗口（完成鼠标传递），我可以用完全 alpha 透明度（使用 Graphics.FromHwnd）绘制 32 位图像。这种方法的一个好处是，如果窗口移动或背景发生变化，Windows DWM 会完成所有工作——我不必更新任何东西。

# c++ - 最后附加了奇怪的符号

> ID：11214745
> 
> 赞同：0
> 
> 时间：2012-06-26T19:36:23.473
> 
> 标签：c++

我正在尝试从文件中读取字符并将它们写入另一个文件。问题是，尽管所有内容都在写入，但在写入文件的下一行中附加了一个奇怪的符号。我的代码是：

```
#include<iostream>
#include<stdlib.h>
#include<string.h>
#include<stdio.h>

using namespace std;

int main(){

    FILE *f, *g;
    int ch;
    f = fopen("readfile", "r");
    g = fopen("writefile", "w");
    while(ch != EOF){
            ch = getc(f);
            putc(ch, g);
    }
    fclose(f);
    fclose(g);
return 0;
} 
```

这可能是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:39:01.703

这是因为您`ch`在检查它是否是之前写入了另一个文件`EOF`，所以一个也被写入了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:41:49.423

考虑一下如果在已经使用该返回值之后检查 getc() 的返回值会发生什么。

```
// simple fix
ch = getc(f);
while (ch != EOF) {
    putc(ch, g);
    ch = getc(f);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:48:54.510

奇怪的符号是 EOF 常数。

```
ch = getc(f); // we've read a symbol, or EOF is returned to indicate end-of-file
putc(ch, g); // write to g whether the read operation was successful or not 
```

修复是

```
ch = getc(f);
while (ch != EOF)
{
    putc(ch, g);
    ch = getc(f);
} 
```

# c# - 使用 Json .Net 忽略自定义子级

> ID：11214750
> 
> 赞同：0
> 
> 时间：2012-06-26T19:36:39.903
> 
> 标签：c#, .net, json.net

我有一个这样的json响应：

```
{"response_values":[110,{"id":14753,"name":"piter"},{"id":14753,"name":"rabbit"}]} 
```

我有一个简单的课程

```
public class Class1
{
    [JsonProperty("id")]
    public int Id { get; set; }

    [JsonProperty("name")]
    public string Name { get; set; }
} 
```

当我尝试使用此方法将 json 转换为对象列表时：

```
public T Cast<T>(string json)
{
    var result = default(T);

    var jsonObject = JObject.Parse(json);
    if (jsonObject != null)
    {
        var responseToken = jsonObject["response"];
        result = responseToken.ToObject<T>();
    }

    return result;
} 
```

像这样

...

```
var jsonString = GetJson();
var items = Cast<List<Class1>>(); 
```

...

我有一个例外，因为值“110”是整数。我怎样才能跳过这个值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:03:16.727

如果您希望忽略的值始终位于开头，则始终可以使用此选项：

```
if (jsonObject != null)
{
    var responseToken = parsed["response_values"].SkipWhile(j => j.Type != JTokenType.Object);
    if (responseToken.Count() > 0) result = responseToken.ToObject<T>();
} 
```

如果它始终是第一个值，您可能更喜欢使用`Skip(1)`它。`SkipWhile`或者，您可以使用`Where`忽略或选择消息中任何位置的标记。

当然，您可以根据您期望在成功场景中返回的确切内容来使用这种方法（改变事物）。

# sql - 查询以获取时间的频率分布

> ID：11214757
> 
> 赞同：-1
> 
> 时间：2012-06-26T19:37:06.873
> 
> 标签：sql, sql-server, sql-server-2008, reporting-services

这是我的数据：

```
+----+------------------+--------------------+
| ID | DateTime Entered | DateTime Completed |
+----+------------------+--------------------+
|  1 | 6/17/2011 10:08  | 6/18/2011 14:39    |
|  2 | 5/10/2011 9:29   | 5/15/2011 17:29    |
|  3 | 3/2/2009 9:30    | 3/3/2009 13:40     |
|  4 | 3/3/2009 11:36   | 3/4/2009 16:39     |
|  5 | 3/3/2009 11:37   | 3/4/2009 16:39     |
|  6 | 3/3/2009 11:38   | 3/4/2009 16:39     |
|  7 | 3/3/2009 11:38   | 3/4/2009 16:38     |
|  8 | 3/3/2009 11:38   | 3/5/2009 9:08      |
|  9 | 1/10/2011 9:43   | 1/11/2011 13:13    |
| 10 | 2/11/2011 12:20  | 2/12/2011 15:01    |
| 11 | 8/14/2009 10:20  | 8/17/2009 15:56    |
| 12 | 11/19/2008 9:45  | 11/20/2008 14:56   |
| 13 | 2/10/2011 13:50  | 2/11/2011 19:36    |
| 14 | 8/14/2009 10:23  | 8/17/2009 15:56    |
| 15 | 8/17/2009 9:43   | 8/18/2009 13:56    |
| 16 | 8/17/2009 9:43   | 8/19/2009 6:47     |
| 17 | 8/14/2009 10:28  | 8/17/2009 15:56    |
| 18 | 12/17/2008 10:03 | 12/18/2008 11:07   |
| 19 | 1/13/2009 9:41   | 1/14/2009 18:11    |
| 20 | 1/20/2009 9:18   | 1/21/2009 15:08    |
| 21 | 2/12/2009 10:53  | 2/13/2009 15:21    |
| 22 | 1/20/2009 9:19   | 1/21/2009 15:08    |
| 23 | 1/13/2009 9:50   | 1/15/2009 8:45     |
| 24 | 1/13/2009 9:50   | 1/14/2009 14:40    |
| 25 | 1/13/2009 9:36   | 1/14/2009 18:11    |
| 26 | 12/17/2008 10:06 | 12/18/2008 11:06   |
| 27 | 12/17/2008 10:04 | 12/18/2008 11:06   |
| 28 | 3/30/2010 9:20   | 3/31/2010 13:44    |
| 29 | 1/25/2010 9:33   | 1/26/2010 14:20    |
| 30 | 1/30/2009 11:21  | 2/2/2009 14:44     |
| 31 | 6/17/2010 9:07   | 6/18/2010 14:17    |
| 32 | 6/16/2010 10:24  | 6/17/2010 16:20    |
| 33 | 6/14/2010 9:33   | 6/15/2010 8:52     |
| 34 | 5/27/2010 9:15   | 5/28/2010 14:15    |
| 35 | 5/27/2010 10:16  | 5/28/2010 15:51    |
| 36 | 5/21/2010 9:15   | 5/23/2010 13:05    |
| 37 | 5/19/2010 10:08  | 5/20/2010 13:33    |
| 38 | 6/30/2010 11:41  | 7/1/2010 18:16     |
+----+------------------+--------------------+ 
```

这是我想输入的格式。对于特定的年份，我们称之为`2008`：

```
Time Completed  Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
12AM    1                                           
1AM                             2               1
2AM     1           1                   1       
3AM                                             3
4AM                 342     1                   
.                                   32          34
.                   42                          
.                                               
NEXT DAY 12AM       2                   1                   
NEXT DAY 1AM                    1                           
.                                               
. 
```

…………

`DateTime Entered`给了我们开始的一天，`DateTime Completed`给了我们完成的时间。

例如第一个。它将有一个完整的时间，`14:39`而对于第二个它将是`5th day 15:29`。第三个是`2nd day 13:40`

非常感谢您的建议和指导。如果您能指出我正确的方向，我将不胜感激。

SQL 或 SSRS 解决方案将是理想的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:48:33.967

您可以按小时对持续时间进行分组：

```
select  datediff(hour, [DateTime Entered], [DateTime Completed])
,       sum(case when month([DateTime Entered] = 1 then 1 end) as Jan
,       sum(case when month([DateTime Entered] = 2 then 1 end) as Feb
,       sum(case when month([DateTime Entered] = 3 then 1 end) as Mar
,       ...
from    YourTable
group by
        datediff(hour, [DateTime Entered], [DateTime Completed]) 
```

重新阅读，似乎我可以用第二种方式阅读你的问题。如果您想按结束时间分组（即 7 月 2 日 23:00 到 7 月 3 日 01:00 将计为 25 小时），那么您可以将开始时间转换为日期：

```
select  datediff(hour, cast([DateTime Entered] as date), [DateTime Completed])
,       sum(case when month([DateTime Entered] = 1 then 1 end) as Jan
,       ...
from    YourTable
group by
        datediff(hour, cast([DateTime Entered] as date), [DateTime Completed]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T20:13:51.450

编辑包括排序：

```
create table tblTest (ID int , Entered datetime, Completed datetime)

set dateformat mdy

insert into tblTest values (1,'6/17/2011 10:08','6/18/2011 14:39')
insert into tblTest values (  2 ,'5/10/2011 9:29','5/15/2011 17:29')
insert into tblTest values (  3 ,'3/2/2009 9:30','3/3/2009 13:40')
insert into tblTest values (  4 ,'3/3/2009 11:36','3/4/2009 16:39')
insert into tblTest values (  5 ,'3/3/2009 11:37','3/4/2009 16:39')
insert into tblTest values (  6 ,'3/3/2009 11:38','3/4/2009 16:39')
insert into tblTest values (  7 ,'3/3/2009 11:38','3/4/2009 16:38')
insert into tblTest values (  8 ,'3/3/2009 11:38','3/5/2009 9:08')
insert into tblTest values (  9 ,'1/10/2011 9:43','1/11/2011 13:13')
insert into tblTest values ( 10 ,'2/11/2011 12:20','2/12/2011 15:01')
insert into tblTest values ( 11 ,'8/14/2009 10:20','8/17/2009 15:56')
insert into tblTest values ( 12 ,'11/19/2008 9:45','11/20/2008 14:56')
insert into tblTest values ( 13 ,'2/10/2011 13:50','2/11/2011 19:36')
insert into tblTest values ( 14 ,'8/14/2009 10:23','8/17/2009 15:56')
insert into tblTest values ( 15 ,'8/17/2009 9:43','8/18/2009 13:56')
insert into tblTest values ( 16 ,'8/17/2009 9:43','8/19/2009 6:47')
insert into tblTest values ( 17 ,'8/14/2009 10:28','8/17/2009 15:56')
insert into tblTest values ( 18 ,'12/17/2008 10:03','12/18/2008 11:07')
insert into tblTest values ( 19 ,'1/13/2009 9:41','1/14/2009 18:11')
insert into tblTest values ( 20 ,'1/20/2009 9:18','1/21/2009 15:08')
insert into tblTest values ( 21 ,'2/12/2009 10:53','2/13/2009 15:21')
insert into tblTest values ( 22 ,'1/20/2009 9:19','1/21/2009 15:08')
insert into tblTest values ( 23 ,'1/13/2009 9:50','1/15/2009 8:45')
insert into tblTest values ( 24 ,'1/13/2009 9:50','1/14/2009 14:40')
insert into tblTest values ( 25 ,'1/13/2009 9:36','1/14/2009 18:11')
insert into tblTest values ( 26 ,'12/17/2008 10:06','12/18/2008 11:06')
insert into tblTest values ( 27 ,'12/17/2008 10:04','12/18/2008 11:06')
insert into tblTest values ( 28 ,'3/30/2010 9:20','3/31/2010 13:44')
insert into tblTest values ( 29 ,'1/25/2010 9:33','1/26/2010 14:20')
insert into tblTest values ( 30 ,'1/30/2009 11:21','2/2/2009 14:44')
insert into tblTest values ( 31 ,'6/17/2010 9:07','6/18/2010 14:17')
insert into tblTest values ( 32 ,'6/16/2010 10:24','6/17/2010 16:20')
insert into tblTest values ( 33 ,'6/14/2010 9:33','6/15/2010 8:52')
insert into tblTest values ( 34 ,'5/27/2010 9:15','5/28/2010 14:15')
insert into tblTest values ( 35 ,'5/27/2010 10:16','5/28/2010 15:51')
insert into tblTest values ( 36 ,'5/21/2010 9:15','5/23/2010 13:05')
insert into tblTest values ( 37 ,'5/19/2010 10:08','5/20/2010 13:33')
insert into tblTest values ( 38 ,'6/30/2010 11:41','7/1/2010 18:16')
insert into tblTest values ( 39 ,'6/30/2010 11:41','6/30/2010 18:16')
insert into tblTest values ( 40 ,'1/10/2011 9:43','1/11/2011 13:13')

select 
datediff(d, CAST(entered as DATE), CAST(completed as DATE)) AS Sort_Days,
DATEPART(hour, completed) AS Sort_Hours,
CASE datediff(d, CAST(entered as DATE), CAST(completed as DATE))
    WHEN 0 THEN '' WHEN 1 THEN 'NEXT DAY ' WHEN 2 THEN '2ND DAY ' WHEN 3 THEN '3RD DAY ' ELSE CONVERT(varchar(10), datediff(d, CAST(entered as DATE), CAST(completed as DATE))) + 'TH DAY ' 
END
+ CONVERT(varchar(10), DATEPART(hour, completed) - CASE WHEN DATEPART(hour, completed) > 12 THEN 12 ELSE 0 END )
+ CASE WHEN DATEPART(hour, completed) < 12 THEN 'AM' ELSE 'PM' END AS TimeCompleted,
case when datepart(month,entered) = 1 then 1 end as Jan,
case when datepart(month,entered) = 2 then 1 end as Feb,
case when datepart(month,entered) = 3 then 1 end as Mar,
case when datepart(month,entered) = 4 then 1 end as Apr,
case when datepart(month,entered) = 5 then 1 end as May,
case when datepart(month,entered) = 6 then 1 end as Jun,
case when datepart(month,entered) = 7 then 1 end as Jul,
case when datepart(month,entered) = 8 then 1 end as Aug,
case when datepart(month,entered) = 9 then 1 end as Sep,
case when datepart(month,entered) = 10 then 1 end as Oct,
case when datepart(month,entered) = 11 then 1 end as Nov,
case when datepart(month,entered) = 12 then 1 end as Dec
into #tblTest
from tblTest

select TimeCompleted, sum(Jan), sum(Feb), sum(Mar), sum(Apr), sum(May), sum(Jun), sum(Jul), sum(Aug), sum(Sep), sum(Oct), sum(Nov), sum(Dec)
from #tblTest
group by TimeCompleted, Sort_Days, Sort_Hours
order by Sort_Days, Sort_Hours 
```

# android - 无法让 $.ajax() 在 PhoneGap 中针对本地托管的服务器工作

> ID：11214761
> 
> 赞同：0
> 
> 时间：2012-06-26T19:37:27.327
> 
> 标签：android, jquery, ajax, rest, cordova

目前正在尝试从我机器上的 android VM (Bluestacks) 向 IIS Express 托管的 MVC 4 Web API 端点发出 ajax 发布请求。以下是我正在尝试但无法开始工作的代码片段：

```
 $.ajax({
        type: "POST",
        url: "http://10.0.2.2:28434/api/devices",
        data: {'EncryptedPassword':'1234','UserName':'test','DeviceToken':'d234'}
    }).always(function( data, textStatus, jqXHR ) {
        alert( textStatus );
    }); 
```

每当我运行这个请求时，我总是会得到一个“错误”的文本状态。经过数小时尝试不同的事情后，我将 End Point 推送到了一个实际的服务器，并且如果我手动构建一个 XMLHttpRequest，则能够在 PhoneGap 中实际获得响应，如下所示：

```
var request = new XMLHttpRequest();
        request.open("POST", "http://172.16.100.42/MobileRewards/api/devices", true);
        request.onreadystatechange = function(){//Call a function when the state changes.
            console.log("state = " + request.readyState);
            console.log("status = " + request.status);
            if (request.readyState == 4) {
                if (request.status == 200 || request.status == 0) {
                    console.log("*" + request.responseText + "*");
                }
            }
        }
request.send("{EncryptedPassword:1234,UserName:test,DeviceToken:d234}"); 
```

不幸的是，如果我尝试将 $.ajax() 用于上面代码段中的同一端点，我仍然会得到一个状态文本，上面写着“错误”，下面是该代码段供参考：

```
 $.ajax({
        type: "POST",
        url: "http://172.16.100.42/MobileRewards/api/devices",
        data: {'EncryptedPassword':'1234','UserName':'test','DeviceToken':'d234'}
    }).always(function( data, textStatus, jqXHR ) {
        alert( textStatus );
    }); 
```

所以真的，这里有几个问题。

1) 为什么当它通过 IIS Express 托管在运行 Android VM 的同一台机器上时，我无法获得任何 ajax 调用（post 或 get）来成功到达我的端点？

2）当我的端点托管在实际服务器上，通过 IIS 并通过端口 80 提供服务时，为什么在我使用 jquery 的 ajax 调用时不能成功发布请求？（即使我可以通过手动创建 XMLHttpRequest 来让它工作）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:58:48.497

1.  您确定 BlueStacks 使用与模拟器相同的主机 IP（10.0.2.2）吗？我不熟悉它，所以我不确定答案是什么。

2.  jQuery希望数据是一个字符串，试试：

    ```
    data: JSON.stringify({'EncryptedPassword':'1234','UserName':'test','DeviceToken':'d234'}); 
    ```

    为了更好地衡量，添加

    ```
    contentType: 'application/json', 
    ```

    在您的 ajax 设置中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T15:35:45.493

对于曾经查找过此内容的任何人，问题最终是 IIS Express 在我的本地计算机上使用的端口。当我通过端口 80 进行路由时，一切正常。

# c# - 使用正则表达式从 ftpwebrequest 解析文件

> ID：11214765
> 
> 赞同：0
> 
> 时间：2012-06-26T19:37:39.577
> 
> 标签：c#, regex, ftp, ftpwebrequest

我正在通过 c# 中的 ftpwebrequest 从供应商处读取数据。因此，数据将逐行采用字符串格式，例如

```
0123030014030300123003120312030203013003104234923942348 
```

我需要将这些数据解析到适当的字段中，然后我可以将它们插入到 sql 表中。我知道每个字段的起始位置，所以我想使用正则表达式来解析每个字段。这是我用来获取数据的函数，现在我只需要解析数据。我很难找到一个明确的解决方案。任何建议将不胜感激 ：）

```
 static void GetData()
    {
        WebClient request = new WebClient();
        string url = "ftp://ftp.WebSite.com/file";
        request.Credentials = new NetworkCredential("userid", "password");
        try
        {
            byte[] newFileData = request.DownloadData(url);
            string fileString = System.Text.Encoding.UTF8.GetString(newFileData);
            Console.WriteLine(fileString);
        }
        catch (WebException e)
        {

        } 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:57:01.900

如果您只是以指定的长度进行拆分，则不需要使用正则表达式。在 C# 中，您可以只使用[String.Substring](http://msdn.microsoft.com/en-us/library/system.string.substring%28v=vs.71%29.aspx)，例如：

```
byte[] newFileData = request.DownloadData(url);
string fileString = System.Text.Encoding.UTF8.GetString(newFileData);
string fieldOne = fileString.Substring(0, n); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:50:58.287

这是正则表达式的示例。我们通过 \d{x} 的总数来指定要捕获的内容，例如 \d{4} 给我们 4 位数。然后我们将它放入一个命名的捕获组`(?<NameHere>\d{4})`中，然后我们通过它的名称（在前面的文本示例中的 NameHere ）访问它以进行处理。

请参阅删除三个字段 Id、组号和目标编号的示例：

```
string data = "0123030014030300123003120312030203013003104234923942348";

string pattern = @"^(?<ID>\d{4})(?<Group>\d{3})(?<Target>\d{8})";

Match mt = Regex.Match(data, pattern);

// Writes
// ID: 0123 of Group 030 on Target: 01403030
Console.WriteLine("ID: {0} of Group {1} on Target: {2}", mt.Groups["ID"].Value, mt.Groups["Group"].Value, mt.Groups["Target"].Value); 
```

# macos - 如何挂钩 OS X 字典

> ID：11214768
> 
> 赞同：9
> 
> 时间：2012-06-26T19:37:43.740
> 
> 标签：macos, cocoa, dictionary

在 osx lion 上，您可以 control-command-d 或三次点击鼠标在任何应用程序中指向的单词以启动弹出字典。我想制作一个应用程序来跟踪用户在字典中查找的单词。

我如何观察用户执行 control-command-d 或三次点击以启动弹出字典的事件？

我知道用于此的特定 API 是[HIDictionaryWindowShow](https://developer.apple.com/library/mac/#documentation/userexperience/Reference/DictionaryServicesRef/Reference/reference.html)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T23:28:58.507

您可以使用**popoverDidShow：**

```
- (void)awakeFromNib {
    NSNotificationCenter* notificationCenter = [NSNotificationCenter defaultCenter];
    [notificationCenter addObserver:self selector:@selector(popoverDidShow:)
                            name:NSPopoverDidShowNotification object:nil];
}

// dictionary is shown or another NSPopover
- (void)popoverDidShow:(NSNotification*)notify { 
    //your code
} 
```

# sharepoint - 是否可以每天两次比较相同的 Sharepoint 列表以查找更改/更改计数

> ID：11214772
> 
> 赞同：1
> 
> 时间：2012-06-26T19:37:57.753
> 
> 标签：sharepoint, sharepoint-2007

我是 SharePoint 新手，有一个关于列表比较的一般性问题。目前，有一个用户生成的列表在不断变化，我想收集有关变化的定量数据。每天，我在 8:00 进来，然后在 5:00 再次离开。我想知道在 8:00 与 5:00 时该列表中有什么/多少项目，然后能够查看结果。例如，该列表包含我需要完成的当前项目。如果我 8:00 进来时有 20 个，离开时有 3 个，我希望能够查看我完成了 85% 的项目和 17/20 的数据。这可能吗？

*注意，目前，我没有 SharePoint Designer 或对服务器的访问权限。假设需要访问并且我可以获得它，那么解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T22:21:23.277

确实没有内置的方法可以做到这一点。但是对于 SharePoint 的所有事情，有多种方法可以完成事情。由于您无权访问 SP Designer 或服务器本身，因此阻力最小的路径可能是使用 SP Web 服务来查询列表（例如，在上午 8 点）并获取项目计数、存储（持久) 某处的项目计数，然后再次查询列表（下午 5 点），并对照最初一天的计数检查它，然后给你一个总数。

您可以通过 SP Web 服务访问列表数据，网址为`http://server_name/_vti_bin/Lists.asmx`。使用类似下面的代码来获取列表计数。您可以在任何地方保存存储的值 - 文本文件、本地存储、内存..

请注意，您需要为您的项目添加一个 Web 服务引用。在下面的代码中，它被命名为 sp2010，但显然您可以随意命名。变量 listItemCount 将保存您的列表计数。其余大部分代码应该是不言自明的。

```
 sp2010.Lists spList = new sp2010.Lists() { Credentials = new NetworkCredential("username", "password") };
            string listName = "YourListName"; 
            string listItemCount = string.Empty;

            XmlNode listXML = spList.GetListItems(listName, null, null, null, null, null, null);

            XmlDataDocument innerXml = new XmlDataDocument();
            innerXml.LoadXml(listXML.InnerXml);
            XmlNodeList rows = innerXml.GetElementsByTagName("rs:data");

            foreach (XmlNode attribute in rows)
                {
                    // listItemCount holds the count of your list
                    listItemCount = attribute.Attributes["ItemCount"].Value;
                } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:58:32.707

Timerjob 可能是一个不错的选择。这是一些编码，只需点击列表查询所有项目并计数，然后将电子邮件发送给某人或将它返回的数字放在 SharePoint 中的某个位置。

此外，我会阅读[http://www.andrewconnell.com/blog/articles/CreatingCustomSharePointTimerJobs.aspx](http://www.andrewconnell.com/blog/articles/CreatingCustomSharePointTimerJobs.aspx) 博客，了解有关如何编写计时器作业的信息。

为了真正得到你需要的东西，我会告诉你你需要做什么，但不会给你代码，因为你应该在询问之前先尝试。

获取一个 spsite 对象。（这应该包含包含您的列表的网络）获取包含您的列表的网络对象。获取列表

```
SPList countLIst = <yourWeb>.lists["<listname or GUID>"] 
```

获取列表计数

```
int numberOfItems = countList.items.count 
```

以某种方式显示或保存`numberOfItems`

请记住 SPContext.current.site 由于其上下文而无法在计时器作业中工作。

希望此扩展程序满足您的要求

干杯特鲁兹

# c++ - 如何读入二进制数据并转换为无符号字符（C++）

> ID：11214782
> 
> 赞同：6
> 
> 时间：2012-06-26T19:38:57.060
> 
> 标签：c++, binary-data, unsigned-char

我有一个以二进制数据（无编码）保存的原始图像文件。我想读入文件并将值转换为无符号字符。但我不确定如何开始这样做。每个文件包含 640x480 字节。每个像素为 8 位。

我在这里使用了 C++ 帮助页面：[http](http://www.cplusplus.com/doc/tutorial/files/) ://www.cplusplus.com/doc/tutorial/files/，但是当我计算数据时，它似乎显示了相同的二进制/非人类可读字符。有人可以建议吗？到目前为止，这是我的代码：

```
 #include <iostream>
    #include <fstream>
    using namespace std;

ifstream::pos_type size;
char * memblock;

int main () {
  ifstream file ("imageData.raw", ios::in|ios::binary|ios::ate);
  if (file.is_open())
  {
    size = file.tellg();
    memblock = new char [size];
    file.seekg (0, ios::beg);
    file.read (memblock, size);

    cout << "the complete file content is in memory";

    for (int l=0; l<size; l++){
    cout << " memblock[] is = " << (unsigned char)memblock[l] << " index was l = " << l << endl;
    }

    file.close();

    delete[] memblock;
  }
  else cout << "Unable to open file";
  return 0;
} 
```

这是输出的示例捕获：

```
 memblock[] is = ▀ index was l = 2937
 memblock[] is = E index was l = 2938
 memblock[] is = τ index was l = 2939
 memblock[] is = C index was l = 2940
 memblock[] is = ┘ index was l = 2941
 memblock[] is = B index was l = 2942
 memblock[] is = ╬ index was l = 2943
 memblock[] is = D index was l = 2944
 memblock[] is = ┼ index was l = 2945
 memblock[] is = C index was l = 2946
 memblock[] is = ╝ index was l = 2947
 memblock[] is = B index was l = 2948
 memblock[] is = ┤ index was l = 2949
 memblock[] is = B index was l = 2950
 memblock[] is = ¿ index was l = 2951
 memblock[] is = > index was l = 2952
 memblock[] is = í index was l = 2953
 memblock[] is = ; index was l = 2954
 memblock[] is = £ index was l = 2955
 memblock[] is = 6 index was l = 2956
 memblock[] is = á index was l = 2957
 memblock[] is = 4 index was l = 2958
 memblock[] is = Ñ index was l = 2959
 memblock[] is = 7 index was l = 2960
 memblock[] is = ╡ index was l = 2961 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T19:39:47.157

```
unsigned char* memblock; // change declaration of memblock

...

memblock = new unsigned char[size]; // change to unsigned char
file.seekg (0, ios::beg);
file.read ((char*)memblock, size); // cast to a char* to give to file.read 
```

要打印数值而不是字符，请`int`在打印前转换为 an。

```
(int) memblock[l] 
```

# iphone - 应用程序因在第三代 iPad 上崩溃而被拒绝

> ID：11214787
> 
> 赞同：1
> 
> 时间：2012-06-26T19:39:17.843
> 
> 标签：iphone, objective-c, ios, ipad, crash

我的应用程序被 Apple 拒绝，因为它在 iPad 3rd Gen 上崩溃。被拒绝的原因：

> 我们发现您的应用在运行 iOS 5.1.1 的第三代 iPad 上崩溃，这不符合 App Store 审查指南。
> 
> 您的应用在启动时在 Wi-Fi 和蜂窝网络上都崩溃了。

我在 iPhone 4 模拟器和设备上测试了我的应用程序，并且工作正常，我还在 iPad 模拟器上测试了应用程序，包括 iPad 和 iPad 视网膜模拟器，并且工作正常。但我没有真正的 iPad 3rd Gen 设备。这是应用程序的代码：didFinishLaunchingWithOptions：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

//Piracy Check
iShmoopi *PiracyCheck = [[[iShmoopi alloc] init] autorelease];
if ([PiracyCheck isPirated] == KAPPLICATIONNOTPIRATED || [PiracyCheck isPirated] == KNOTPIRATED) {
    //Do Nothing, Not Pirated
} else {
    //Do Something, Pirated

    //Hostile Exit 
    iShmoopi *HostileExit = [[[iShmoopi alloc] init] autorelease];
    [HostileExit Hostile];
}

NSString *gameDataPath = pathInDocumentDirectory(@"gameDataPath.data");
if (gameDataPath != nil) {

    NSDictionary *gameDataDictionary = [NSKeyedUnarchiver unarchiveObjectWithFile:gameDataPath];

    if  (gameDataDictionary != nil) {

        smartEasyBestTime = [[gameDataDictionary objectForKey:@"smartEasyBestTimeKey"] intValue];
        smartEasyBestPoint = [[gameDataDictionary objectForKey:@"smartEasyBestPointKey"] intValue];
        smartNormalIsPlayable = [[gameDataDictionary objectForKey:@"smartNormalIsPalyableKey"] boolValue];
        smartNormalBestTime = [[gameDataDictionary objectForKey:@"smartNormalBestTimeKey"] intValue];
        smartNormalBestPoint = [[gameDataDictionary objectForKey:@"smartNormalBestpointKey"] intValue];
        smartHardIsPlayable = [[gameDataDictionary objectForKey:@"smartHardIsPalyableKey"] boolValue];
        smartHardBestTime = [[gameDataDictionary objectForKey:@"smartHardBestTimeKey"] intValue];
        smartHardBestPoint = [[gameDataDictionary objectForKey:@"smartHardBestPointKey"] intValue];

        focusEasyBestTime = [[gameDataDictionary objectForKey:@"focusEasyBestTimeKey"] intValue];
        focusEasyBestPoint = [[gameDataDictionary objectForKey:@"focusEasyBestPointKey"] intValue];
        focusNormalIsPlayable = [[gameDataDictionary objectForKey:@"focusNormalIsPalyableKey"] boolValue];
        focusNormalBestTime = [[gameDataDictionary objectForKey:@"focusNormalBestTimeKey"] intValue];
        focusNormalBestPoint = [[gameDataDictionary objectForKey:@"focusNormalBestpointKey"] intValue];
        focusHardIsPlayable = [[gameDataDictionary objectForKey:@"focusHardIsPalyableKey"] boolValue];
        focusHardBestTime = [[gameDataDictionary objectForKey:@"focusHardBestTimeKey"] intValue];
        focusHardBestPoint = [[gameDataDictionary objectForKey:@"focusHardBestPointKey"] intValue];

        logicEasyBestTime = [[gameDataDictionary objectForKey:@"logicEasyBestTimeKey"] intValue];
        logicEasyBestPoint = [[gameDataDictionary objectForKey:@"logicEasyBestPointKey"] intValue];
        logicNormalIsPlayable = [[gameDataDictionary objectForKey:@"logicNormalIsPalyableKey"] boolValue];
        logicNormalBestTime = [[gameDataDictionary objectForKey:@"logicNormalBestTimeKey"] intValue];
        logicNormalBestPoint = [[gameDataDictionary objectForKey:@"logicNormalBestpointKey"] intValue];
        logicHardIsPlayable = [[gameDataDictionary objectForKey:@"logicHardIsPalyableKey"] boolValue];
        logicHardBestTime = [[gameDataDictionary objectForKey:@"logicHardBestTimeKey"] intValue];
        logicHardBestPoint = [[gameDataDictionary objectForKey:@"logicHardBestPointKey"] intValue];

        speedEasyBestTime = [[gameDataDictionary objectForKey:@"speedEasyBestTimeKey"] intValue];
        speedEasyBestPoint = [[gameDataDictionary objectForKey:@"speedEasyBestPointKey"] intValue];
        speedNormalIsPlayable = [[gameDataDictionary objectForKey:@"speedNormalIsPalyableKey"] boolValue];
        speedNormalBestTime = [[gameDataDictionary objectForKey:@"speedNormalBestTimeKey"] intValue];
        speedNormalBestPoint = [[gameDataDictionary objectForKey:@"speedNormalBestpointKey"] intValue];
        speedHardIsPlayable = [[gameDataDictionary objectForKey:@"speedHardIsPalyableKey"] boolValue];
        speedHardBestTime = [[gameDataDictionary objectForKey:@"speedHardBestTimeKey"] intValue];
        speedHardBestPoint = [[gameDataDictionary objectForKey:@"speedHardBestPointKey"] intValue];
    }
}

self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
// Override point for customization after application launch.
self.viewController = [[[ViewController alloc] initWithNibName:@"ViewController" bundle:nil] autorelease];
self.window.rootViewController = self.viewController;
[self.window makeKeyAndVisible];

return YES;

} 
```

这是加载的第一个视图控制器的代码

```
- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.

//Piracy Check
iShmoopi *PiracyCheck = [[[iShmoopi alloc] init] autorelease];
if ([PiracyCheck isPirated] == KAPPLICATIONNOTPIRATED || [PiracyCheck isPirated] == KNOTPIRATED) {
    //Do Nothing, Not Pirated
    NSLog(@"not pirated");
} 
else 
{
    //Do Something, Pirated

    //Hostile Exit 
    iShmoopi *HostileExit = [[[iShmoopi alloc] init] autorelease];
    [HostileExit Hostile];
}

[titleImageView setImage:[UIImage imageNamed:@"gameTitleImage.png"]];

NSTimer *t;
t = [NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector(tEnd) userInfo:nil repeats:YES];

} 
```

顺便说一句，我使用上面代码中显示的[Shmoopi 反盗版库。](http://www.shmoopi.net/shmoopiantipiracy/)

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T11:30:10.413

找到一种在真实设备中进行测试的方法。借用、租用或购买一台。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T17:22:42.330

我的应用程序已获得批准。我删除了 Shmoopi 反盗版库代码并编写了自己的代码。所以问题是 Shmoopi Anti-Piracy Library 与 iPad 3rd Gen 不兼容。

# android - 当 AccountManager 删除帐户时，SyncAdapter 会收到通知吗？

> ID：11214789
> 
> 赞同：6
> 
> 时间：2012-06-26T19:39:32.867
> 
> 标签：android, accountmanager, android-syncadapter

因此，我重申的问题是，当您转到“设置”->“帐户和同步”并选择创建的`SyncAdapter`与云服务器同步的帐户，然后选择“删除帐户”时，就您`SyncAdapter`而言会发生什么？将显示一个对话框，要求您确认，并且与该帐户关联的手机上的数据将被删除。我不能轻易相信该框架可以自动删除我`SyncAdapter`存储在本地数据库中的数据，但这似乎意味着删除帐户将（我同意应该）删除该数据。是否有我的补充可以`SyncAdapter`作为帐户删除的回调来处理从本地数据库中删除所有适当的数据？也许它必须通过`AccountManager`反而; 当帐户被删除时我`AccountManager`会收到通知，并且我可以从那里触发数据删除而无需`SyncAdapter`.

`SyncAdapter`编辑：在相关说明中，同步管理器是否在添加新帐户时为它同步的每个帐户调用我？添加帐户时，我看到`onPerformSync(...)`先前添加的帐户以及刚刚添加的帐户正在执行，并希望停止该操作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T16:42:25.727

我发现解决方案是让应用程序`ContentProvider`实现`OnAccountsUpdateListener`。在其方法中附加`ContentProvider`作为侦听器，然后实现接口方法，如`onCreate``account_manager.addOnAccountsUpdatedListener(this, null, false)`

```
@Override
public void onAccountsUpdated(final Account[] accounts) {
    Ln.i("Accounts updated.");
    final Iterable<String> account_list = new Iterable<String>() {
        @Override
        public Iterator<String> iterator() {
            return new Iterator<String>() {
                private final Iterator<Account> account_list = Arrays.asList(accounts).iterator();

                @Override
                public boolean hasNext() {
                    return account_list.hasNext();
                }

                /** Extracts the next account name and wraps it in single quotes. */
                @Override
                public String next() {
                    return "'" + account_list.next().name + "'";
                }

                @Override
                public void remove() { throw new UnsupportedOperationException("Not implemented"); }
            };
        }
    };
    final String account_set = TextUtils.join(", ", account_list);
    Ln.i("Current accounts: %s", account_set);

    // Removes content that is associated with accounts that are not currently connected
    final SelectionBuilder builder = new SelectionBuilder();
    builder.table(Tables.CALENDARS)
           .where(Calendars.CALENDAR_USER + " NOT IN (?)", account_set);

    new SafeAsyncTask() {
        @Override
        public Void call() throws Exception {
            _model.openWritableDatabase();
            _model.delete(builder);
            return null;
        }
    }.execute();

    getContext().getContentResolver().notifyChange(Calendars.NO_SYNC_URI, null, false);
} 
```

我构建了一个`String`当前连接的帐户，然后用它构建一个 SQL 查询`String`。我在该查询的后台线程中对数据库执行删除操作，以删除与当前未连接的帐户关联的数据。我通知内容发生了变化，但不需要与服务器同步。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-20T14:18:35.117

不，但是您的身份验证器可以[1]。在删除帐户之前调用此方法：

```
AbstractAccountAuthenticator.getAccountRemovalAllowed(AccountAuthenticatorResponse, Account) 
```

***Account***参数是要删除的帐户 - 默认行为是允许删除该帐户：

```
return super.getAccountRemovalAllowed(response, account); // returns Bundle[{booleanResult=true}] 
```

..但我想这是一个钩子，您可以使用它来整理或阻止您希望删除的帐户。

[1] - 这是一个肮脏的黑客; 请参阅 Dandre 的评论。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-07T08:10:17.153

另一种选择是注册发送出去的`android.accounts.LOGIN_ACCOUNTS_CHANGED`广播。*不幸的是，只要任何*`AccountManager`帐户发生更改，就会发送此广播，并且广播也不会提供更改的更多信息。

 *因此，您必须查询客户经理并查看它还剩下多少“您的”帐户并删除丢失的数据。*

# html - 如何仅使用 CSS 和 HTML 在页面上显示其他信息

> ID：11214790
> 
> 赞同：1
> 
> 时间：2012-06-26T19:39:34.163
> 
> 标签：html, css

我只使用 html 和 css 构建我的网站。我已经阅读了几个教程并进行了研究，但现在我陷入了一个领域。我在我的页面顶部创建了一个菜单，使用链接和`ul`链接。链接本身包含更多信息，而不仅仅是链接。在他们之后，我将在用户单击链接后显示显示信息。我用于在页面上显示的信息。所以结构是： `li``li``span``span``a:focus`

```
<ul>
    <li><a href="#" tabindex="1">RESUME
        <span class="resume">
            blah blah blah
        </span></a>
    </li>
    <li><a href="#" tabindex="1">My artwork
        <span class="artwork_area">
            blah blah blah
        </span></a>
    </li>
</ul> 
```

虽然简历部分可以很好地与 一起使用`a:focus`，并且只有在用户单击它之后才能将其显示在页面上，但它不会与“我的作品”一起使用，因为我需要在该部分中有更多链接。我知道不允许将链接嵌套在其他链接中，那么我怎样才能让代码看起来像这样呢？

```
<ul>
    <li><a href="#" tabindex="1">RESUME
        <span class="resume">blah blah blah</span>
        </a>
    </li>
    <li><a href="#" tabindex="1">My artwork</a><!--notice how the link ends here-->
        <span class="artwork_area">
            <p>blah blah blah
            <a href="assets/images/image1.jpg"><img src="assets/images/large_image1.jpg"/>Pic1</a>
            <a href="assets/images/image2.jpg" ><img src="assets/images/large_image1.jpg"/>Pic2</a>
            </p>
        </span>
    </li>
</ul> 
```

这就是我卡住的地方。我无法弄清楚如何在`span`不将其嵌套在链接中的情况下使该部分出现，但是在其中嵌套另一个链接是不可接受的。我只是在阅读和练习 html 和 css 大约 3 周，所以我还没有那么精明。我真的很想只用 html 和 css 来做我的网站，因为我认为它更方便并且加载速度更快。我制作了一个简短的[youtube](http://www.youtube.com/watch?v=6tZlt6qTkLA&hd=1)视频来解释它目前的外观。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T20:10:19.957

您应该查看`:target`伪元素。这样，您可以`div`使用 an隐藏内容，然后使用 # 符号`id`链接到此内容。`id`看看这个[例子](http://jsfiddle.net/Z2HMR/)。它使 jsfiddle 有点混乱，但是当您在自己的页面上执行此操作时效果很好。

`:target`这是关于伪元素的好读物。[CSS 技巧](http://css-tricks.com/on-target/)

希望这可以帮到你。

**更新** 这是一个更好的[例子](http://jsfiddle.net/Z2HMR/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T05:44:30.953

**简答**

我快速浏览了[w3schools css 选择器参考](http://www.w3schools.com/cssref/css_selectors.asp)，并通过示例记录了`element+element`选择器：

```
div+p -> Selects all <p> elements that are placed immediately after <div> elements 
```

所以我尝试了以下样式，它适用于您的第二个示例

```
a:focus+span {
   display:block;
} 
```

**其余的**

我已经对您的 CSS 的外观做出了假设 - 也许您可以编辑您的问题以显示这一点，以便您的示例完整。

但是根据您为这两种情况提供的以下 html 示例。

```
<style>
li>span {
    display:none;
}

li>a:focus span {
    display:block;
}

li>a:focus+span {
    display:block;
}
</style> 
```

考虑一下，如果您要使事情保持一致，以便您永远不会嵌套`span`在操作链接内部，您可以删除`a:focus span`选择器。您的*简历*列表项将变为：

```
<li>
    <a href="#" tabindex="1">RESUME</a>
    <span class="resume">blah blah blah</span>
</li> 
```

此外，如果您还没有这样做，您可能希望为菜单系统的列表项元素提供一个通用类，例如`menu-item`，以便进一步限制 css。这里的目的是始终显示最后一个列表项*Outside*。

```
<style>
li.menu-item>span {
    display:none;
}

li.menu-item>a:focus+span {
    display:block;
}
</style>

...

<ul>
    <li class="menu-item">
        ... Resume 
    </li>
    <li class="menu-item">
        ... My artwork
    </li>
</ul>

<ul>
    <li>
        <a href="#" tabindex="1">Outside</a>
        <span class="resume">outside stuff which is always shown</span>
    </li>
</ul> 
```

最后一件事；我注意到单击其中一个图像操作链接会破坏整个过程，因为主要操作链接再次被隐藏。据我所知，没有`parent-from-child`选择器，所以在这个阶段我不确定这对你有什么作用。无论如何，我认为`element+element`选择器回答了您的具体问题。

# c++ - 通过 EM_FORMATRANGE 缩放富编辑控件的渲染输出时的舍入错误

> ID：11214796
> 
> 赞同：5
> 
> 时间：2012-06-26T19:40:06.390
> 
> 标签：c++, c, windows, winapi, richtextbox

我正在使用该[`EM_FORMATRANGE`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb788020%28v=vs.85%29.aspx)消息将富文本控件的输出呈现给任意设备上下文。但是，当渲染到位图时，位图设备上下文的每英寸点数与显示设备的 DPI 相同，即每英寸 96 点。这比我想要渲染的要低得多。我宁愿以更高的 DPI 进行渲染，以便用户可以放大，也许以后可以在高 DPI 打印机上打印。

我怀疑发生的事情是 RTF 控件调用[`GetDeviceCaps`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144877%28v=vs.85%29.aspx)并获取设备每英寸的像素数`LOGPIXELSX`。`LOGPIXELSY`然后，它使用此 DPI 值以 100% 的缩放级别呈现文档。Windows 显示设备总是返回 96 DPI 的值，除非系统上使用了大字体（如控制面板中设置的那样）并且应用程序可识别 DPI。

Internet 上的许多示例都建议扩展`EM_FORMATRANGE`. 这样就可以实现任意 DPI 分辨率。大多数示例通常涉及使用[`SetMapMode`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162980%28v=vs.85%29.aspx), [`SetWindowExtEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145100%28v=vs.85%29.aspx), 和[`SetViewportExtEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145098%28v=vs.85%29.aspx)（例如，参见[http://social.msdn.microsoft.com/Forums/en-us/netfxbcl/thread/37fd1bfb-f07b-421d-9b5e-5f4492ffbbc3](http://social.msdn.microsoft.com/Forums/en-us/netfxbcl/thread/37fd1bfb-f07b-421d-9b5e-5f4492ffbbc3)）。这些函数可用于缩放富文本控件的呈现输出：例如，如果我指定 400% 缩放，那么如果富文本控件呈现 5 像素宽的内容，它实际上将变为 20 像素宽。

不幸的是，旧的 GDI 函数使用整数而不是浮点数。例如，假设 RTF 控件决定应在 (12.7, 15.3) 像素处绘制元素。这将四舍五入到 (13, 15) 的位置。这些四舍五入的坐标被传递给 GDI，然后 GDI 使用指定的缩放比例放大图像`SetMapMode`：对于 400% 的示例，它将是 (13*4, 15*4) 或 (52, 60)。但这并不准确：元素最好放在 (12.7*4, 15.3*4) 或 (51, 61) 处。最糟糕的是，在某些情况下，误差会累积。

我相信这是缩放一些简单文本时这个非常明显的错误的根本原因：

![使用 EM_FORMATRANGE<code> 渲染并使用</code>SetMapMode 缩放](../Images/37d0e46b27a0e97f67ac6c3e1494f678.png)

`EM_FORMATRANGE`上面的示例是 8 点 Segoe UI ，使用`SetMapMode`96 DPI 显示设备上下文缩放到 400% 。文字现在变成了 32 点大小，但是每个字符之间的间距太高，看起来不自然。

![在写字板中放大到 400%](../Images/c556618f9db6be23cea56a1557e44b85.png)

上面的示例是在写字板中创建的，通过将文本输入为 8 点 Segoe UI，然后使用缩放控件将缩放级别设置为 400%。每个字符之间的空间看起来很正常。使用 32 磅字体和 100% 缩放级别可实现完全相同的结果。

为了解决这个问题，我尝试了以下方法。对于尝试的每一件事，当缩放到 400% 时，结果同样不令人满意。

*   使用缩放变换集 using而不是使用等[`SetWorldTransform`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145104%28v=vs.85%29.aspx)完成的缩放。`SetMapMode``SetWindowExtEx`
*   将元文件的设备上下文传递给`EM_FORMATRANGE`，然后稍后缩放元文件。
*   与渲染到图元文件一起使用`SetMapMode`缩放，然后在不缩放的情况下显示图元文件。

我相信结果总是不能令人满意，因为问题归结为富编辑控件四舍五入到最接近的整数并渲染到它认为是 96 DPI 设备的事实 - 忽略了适当的转换。我查看了元文件格式，我发现单个字符位置实际上以像素级分辨率存储在元文件中 - 这就是为什么缩放元文件显然不起作用，因为此时已经发生了舍入。

我可以想到两个可以解决此问题的真正解决方案：

*   使用具有更高用户指定的每英寸点数的设备上下文，以便`GetDeviceCaps`返回不同的值。（注意：一些示例建议使用打印机设备，因为它们通常具有更高的 DPI，但我希望我的代码可以在没有打印机的系统上工作并且能够渲染到屏幕外缓冲区）。
*   某种方式告诉富编辑控件假设设备上下文的每英寸点数与`GetDeviceCaps`.

其他任何东西似乎仍然会受到这些舍入误差的影响。

是否有人 (1) 知道如何实现我提出的任一解决方案，或者 (2) 对如何实现将准确的高 DPI 输出放入缓冲区的目标有另一种想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:30:34.853

您可以将控件中所有文本的点大小乘以 4 倍，然后将控件呈现为 4 倍大的位图。

如果您自己填充控件，这将非常简单。如果您支持用户输入的任意内容，这将需要更多的工作，并且需要额外的努力来处理任何不是文本的内容（例如嵌入式位图）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:21:13.060

尝试使用[`EM_SETZOOM`消息](http://msdn.microsoft.com/en-us/library/windows/desktop/bb774296%28v=vs.85%29.aspx)让丰富的编辑控件缩放输出本身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T12:59:07.857

我有完全相同的问题。

一个快速的解决方案是将文本绘制成 100% 比例的位图，然后只缩放位图。这不是最好的解决方案，但它可能对你有用。

你有没有找到更好的解决方案？如果是这样，请在这里分享。

另请注意，当您将文本绘制到 100% 元文件然后将元文件缩放到屏幕时也会出现此问题 - 我相信这与不能正常工作的 GDI 文本绘制函数有关缩放。

罗伊

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T19:42:46.757

我刚刚花了两周时间解决一个类似的问题。我需要一个可扩展以进行 WYSISWG 编辑的 Rich Edit。正如我们发现的那样，Windows Rich Edit 控件不支持使用 EM_FORMATRANGE 正确缩放，并且字符间距不会在缩放级别之间更改，并且字体大小只会以离散的字体大小步长进行缩放。

由于我不需要较大的比例差异，因此我选择的解决方案是使用 ITextServices 中的无窗口文本编辑界面以固定分辨率呈现到内部位图。然后我使用 GDI+ 通过三线性过滤将内部位图重新采样到所需的屏幕尺寸。只要比例差异不是太大，结果就可以很好地模拟可扩展的丰富编辑，这足以满足我的需求。

在尝试了许多不同的选项后，我确信您无法使用 windows 丰富的编辑控件获得精确的缩放。您可以编写自己的呈现文本的控件。但是，您需要为每个具有不同样式的文本单独绘制调用。此外，您还需要为您处理所有丰富的编辑句柄，例如突出显示文本、放置光标、处理鼠标和键盘输入、解析 rtf 文本等。在这种情况下，最好只购买第三方组件（我找不到任何合适的免费开源组件）。如果有人想尝试它，我会指出不同 API 的文本渲染的相关起点。

*   GDI - TextOut 未正确设置字符间距。您需要 GetCharacterPlacement 和 ExTextOut。您还需要自己计算缩放比例。你可能不想使用 GDI
*   GDI+ - DrawString 正确处理缩放。GDI+ 是一个合理的选择
*   DirectWrite - 如果您愿意将自己限制在 Vista 平台更新或更高版本，DirectWrite 是 Microsoft 最新的文本 API。

这里还有一个链接，描述了 GDI 和 GDI+ 之间的文本渲染有何不同：

[http://windowsclient.net/articles/gdiptext.aspx](http://windowsclient.net/articles/gdiptext.aspx)

# c++ - 在c ++中分两步将参数绑定到函数？

> ID：11214797
> 
> 赞同：0
> 
> 时间：2012-06-26T19:40:32.740
> 
> 标签：c++, boost

我有一个类管理器和一个类 Base（具有从 Base 派生的子类，比如 A：public Base）。在 Manager 内部，我创建了 Base 的正确子类，但 Base 忽略了 Manager 的存在。我想将一个函数对象传递给这个创建的 Base 子类，该函数对象绑定到 Manager 类的成员方法，以供 A 对象调用。换句话说，在创建过程中，它会是这样的：

```
void Manager::createThing()
{
FunctionObject func;
if (doExtraWork)
    func.bind(&Manager::someMethod, this);

Base *bla = new A(func);
} 
```

然后在 A 内部，我希望能够检测我们是否有额外的工作让经理继续我们并这样做，例如：

```
A::update()
{
 if (func) //ideally detect if func was bound to someMethod or func is empty
    func(this); //equivalent to the above instance of manager calling someMethod on this instance of A

//do regular stuff after;
} 
```

我该怎么做（可能使用增强功能或类似功能）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T20:01:15.100

如果您的`FunctionObject`类型是`boost::function<void()>`，那么您可以从 的结果中分配给它`boost::bind`，如下所示：

```
boost::function<void()> f = boost::bind(&Manager::someMethod, this);
Base *b = new A(f); 
```

其中 A 的构造函数有签名`A(boost::function<void()>)`。调用 a 的`boost::function`开销比虚函数调用稍多。

我对您的特定情况了解不多，无法确定，但是如果您实际上定义了一个代表 f 功能的抽象基类，并让您的构造函数获取`Base`并`A`获取抽象对象，那么您最终可能会得到一个更好的接口而是基类，如下所示：-

```
struct ThingDoer
{
    virtual void do() = 0;
};

class Manager : private ThingDoer
{
    virtual void do()
    { ... }

    void createThing()
    {
        Base *b = new A(this);
    }
}; 
```

其中 A 的构造函数有签名`A(ThingDoer*)`。

如果你以前读过“委托”设计模式，你就会明白我的意思。在这个简单、抽象的示例中，它只是看起来比使用 的解决方案更笨重且更长`boost::function`，但它确实对实际软件具有潜在优势：

*   它允许您为“委托”类型`ThingDoer`、该类型的实现以及其中的函数命名。此外，如果您使用 Doxygen 或其他一些结构化注释系统，则记录委托类比记录函数对象参数要容易得多。
*   它允许您在`Manager`类和任何派生类中选择是继承自`ThingDoer`，还是具有继承 ThingDoer 的嵌套（私有或受保护）类。
*   如果您以后想在接口中添加一个额外的功能（使其做两件不同的事情），这样做会更容易，而且您不会想简单地添加越来越多的功能对象。（但以后只会更容易，因为您已经支付了以这种方式编写代码的额外费用。）
*   If you have programmers from the Java or C# communities, they'll probably be more familiar with code like this.

It may be that none of those are advantages in your situation, in which case, definitely use the `boost::function` / `boost::bind` solution. I've done the same in similar situations. I probably ought to mention too that C++11 has most or all of the function-binding functionality in `std::` itself.

# playframework - 如何播放框架商店列表（用于 OneToMany 关系）

> ID：11214800
> 
> 赞同：0
> 
> 时间：2012-06-26T19:40:53.283
> 
> 标签：playframework, playframework-1.x

对于 OneToMany 关系，play 框架让 master 保留一个 slave 列表。列表没有固定大小并且可以变得非常大，而存储主数据库的数据库行具有预定大小。那么，怎么玩！框架将从属列表存储在包含主控的行中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:20:41.207

Play使用hibernate来持久化，所以这是一个hibernate的问题，而不是专门的Play。

假设我有一个 Author 类和一个 Book 类，其中 Author 有一个 Books 列表，那么数据库将有两个表，author 和 book。其中 book 将包含指向父级的链接（author_id）。

因此，hibernate 将列表存储在单独的列表中。如果列表不包含实体，所以无法进行行映射，我相信 hibernate 将数据序列化为 clob，因此它可以存储任何大小的数据。

# objective-c - 为什么NSOrderedMutableSet会添加数据相同的对象？

> ID：11214801
> 
> 赞同：1
> 
> 时间：2012-06-26T19:40:57.730
> 
> 标签：objective-c, cocoa, nsmutableset

我正在使用创建对象并将它们添加到集合中`-[NSOrderedMutableSet addObject:]`，但我发现只检查对象本身的重复项——大概是对象指针的地址，并且可以添加具有相同内容的多个对象。

例如：

```
SomeObject* object = [SomeObject alloc] initWithStuff:stuff];
SomeObject* object2 = [SomeObject alloc] initWithStuff:stuff];

[set addObject:object];
[set addObject:object];
[set addObject:object1];
[set addObject:object2]; 
```

计数将是 2。

这让我想知道这些课程的意义是什么？在什么情况下可能有一个对象，但不知道对象本身是否已经被添加到集合中，而不是对象中包含的数据？

使用什么最简单的方法（或者我应该使用什么类）来确保集合仅包含基于内容的每个对象之一？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T19:49:44.513

您正在寻找的方式是正确的方式，您忘记了一个小细节：`NSMutableOrderedSet`类如何知道哪些实例`SomeObject`包含相同的值？

答案很简单：您必须提供自己的实现

```
- (BOOL)isEqual:(id)anObject
- (NSUInteger)hash 
```

这样您的实例在与相同的内部值比较时将返回 true，并且具有相同数据的两个实例将具有相同的哈希码。

除此之外，集合相当有用，因为它们在检查实例是否包含在集合中时给您提供了更好的复杂性，并且您可以快速对它们执行许多逻辑操作，例如交集、联合、差异等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:50:23.450

如果它是您拥有的自定义对象，则必须实现自己的 isEqual: 和 hash 方法来检查是否相等并防止集合中的重复。

# java - 不能在netbeans中运行nutch？

> ID：11214802
> 
> 赞同：0
> 
> 时间：2012-06-26T19:41:01.293
> 
> 标签：java, jsp, tomcat, servlets, nutch

我不知道在“网页”和“WEB-INF”文件夹下给出哪个路径..

我试图在WEB-INF下给出路径“tomcat/webapps/roots/WEB-INF”

在源代码下，我给出了保存在 nutch1.4 源文件夹中的“src”文件夹的路径...

而对于lib，给出的路径是nutch1.4 bin文件夹下的“lib”文件夹......

构建成功但是当我运行它时......它显示以下异常！

```
javax.servlet.ServletException: java.lang.NoSuchMethodError: org.eclipse.jdt.internal.compiler.CompilationResult.getProblems()   [Lorg/eclipse/jdt/core/compiler/IProblem;

 org.apache.jasper.servlet.JspServlet.service(JspServlet.java:272)
javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:390) 
```

根本原因在哪里

```
java.lang.NoSuchMethodError: org.eclipse.jdt.internal.compiler.CompilationResult.getProblems()[Lorg/eclipse/jdt/core/compiler/IProblem;
org.apache.jasper.compiler.JDTCompiler$2.acceptResult(JDTCompiler.java:341)
org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:398)
org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:399)
org.apache.jasper.compiler.Compiler.compile(Compiler.java:288)
org.apache.jasper.compiler.Compiler.compile(Compiler.java:267)
org.apache.jasper.compiler.Compiler.compile(Compiler.java:255)
org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:563)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:293)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:314)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:264)
javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:390) 
```

# cordova - 使用 Phonegap 和完全 WebView 的 iOS 应用程序开发

> ID：11214805
> 
> 赞同：0
> 
> 时间：2012-06-26T19:41:26.173
> 
> 标签：cordova, hybrid

我打算创建一个 iOS 应用程序，它将由一个本机导航页面组成。这个本机导航页面将在 Web 视图中触发不同的（无头）URL。URL 将托管在我的服务器中，该服务器将具有自己的 CSS 和 Html。我计划采用这种方法为移动 Web 用户和不同平台的本地应用程序用户使用相同的转录应用程序，因为我计划为 Android 和 Windows 移动平台扩展本机 shell。我的问题是，假设我遵循其他准则，Apple App Store 审批流程是否会让该应用程序通过，因为它的原生组件非常少？

请帮忙.....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:10:39.193

如果您的 PhoneGap 应用程序只是远程托管网站的包装器，那么它很可能会在 App Store 审核期间被拒绝。不幸的是，苹果似乎没有关于这个话题的官方声明，也没有关于这个的“指南”。然而，有些人已经设法在 App Store 中获得了这样的应用程序，所以这是一个运气问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:50:07.257

简而言之，是的！去吧！

如 PhoneGap 的常见问题部分所述：

> 苹果已经做了技术审查，PhoneGap 应用应该没问题，每个应用都会根据自己的优点来判断。

更多信息在这里：
[http :](http://wiki.phonegap.com/w/page/16494770/FAQ)
[//wiki.phonegap.com/w/page/16494770/FAQ http://nachbaur.com/blog/phonegap-officially-permitted-on-the-app-store](http://nachbaur.com/blog/phonegap-officially-permitted-on-the-app-store)

# templates - 任何其他标记 Tridion Razor 页面之前的 RenderComponentPresentation

> ID：11214806
> 
> 赞同：5
> 
> 时间：2012-06-26T19:41:27.830
> 
> 标签：templates, razor, tridion

我在 Tridion 2011 中有一个带有 Razor 代码的页面模板，该代码基于 RenderComponentPresentation() 作为页面中的第一件事打印信息。在它之前没有其他标记，因为组件而不是页面包含初始标记。除非我在发布的输出中的第一个 RenderComponentPresentation 之前放置了至少一个字符，否则模板将拒绝呈现任何演示文稿。

因此，例如，如果这就是布局 TBB 中的全部内容，那么它可以工作（在我的真实代码中，tcms 当然是真实的）：

```
<
@RenderComponentPresentation("tcm:mytcm","tcm:myothertcm") 
```

但这并不

```
@RenderComponentPresentation("tcm:mytcm","tcm:myothertcm") 
```

第一个打印以“<”开头的组件的内容，而第二个根本不做任何事情。我不想在页面模板的开头直接有任何标记，我希望第一件事是组件。可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T14:42:45.933

我刚刚使用最新版本的 Razor Mediator (1.2) 在模板生成器中进行了快速测试，但无法复制您的问题。

也许你可以尝试：

```
<text></text>
@RenderComponentPresentation("tcm:mytcm","tcm"myothertcm") 
```

它不会呈现任何额外的标记，但*可能会*欺骗调解员做你想做的事（尽管就像我说的，我无法复制你的问题，所以无法验证它是否存在）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T14:06:31.483

通常使用 Razor，您可以遍历页面上的任何和所有组件演示文稿，现在我正在使用

```
@foreach(var cp in ComponentPresentations){
   @cp.RenderComponentPresentation()
} 
```

这将呈现页面上的每个组件，无论预定义的架构或模板如何。但是，您的问题表明其他地方存在问题。您的页面模板生成什么样的输出（请注意使用复合模板的页面模板，该复合模板又包括您在此处描述的 Razor TBB）。它是 .aspx、HTML 还是其他？组件模板的输出是什么？它是一个 HTML 片段，还是其他什么？

就您的语法而言，除了模板调用之外应该没问题：

```
@RenderComponentPresentation("tcm:x-xxx-xx", "tcm:xx-xxx-xx") 
```

不过，我感觉这段代码只在 HTML 标记中使用时才有效，但这只是一种预感。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T14:10:47.570

有点破解，但你有没有尝试过：

```
<text>@RenderComponentPresentation("tcm:x-xxx-xx", "tcm:xx-xxx-xx")</text> 
```

或者

```
@Html.Raw(RenderComponentPresentation("tcm:x-xxx-xx", "tcm:xx-xxx-xx")) 
```

免责声明：没有真正使用过 Razor 调解器。只是剃刀。

# javascript - Javascript：在循环中定义函数时将变量设为静态？

> ID：11214807
> 
> 赞同：2
> 
> 时间：2012-06-26T19:41:28.127
> 
> 标签：javascript, string, function, google-maps, variables

使用谷歌地图，我有以下代码：

```
var tileNames = ["base", "parking", "access"];
var mapType = {};

for (var i = 0; i < tileNames.length; i++) {
    var tileOptions = {
    getTileUrl: function(coord, zoom) {
        return "/maps/tiles/tiles" + tileNames[i] + "/" + zoom + "_" + coord.x + "_" + coord.y + ".png";
    },
    tileSize: new google.maps.Size(256, 256)
    };
mapType[tileNames[i]] = new google.maps.ImageMapType(tileOptions);
}; 
```

这是我的问题：执行该函数时，“getTileUrl”函数中的“tileNames[i]”未定义。但是，“tileNames”数组仅用于定义“mapType”对象，因此，与传递给函数的“coord”和“zoom”变量不同，我希望使用“tileNames [ i]" 来定义函数的那部分。因此，理想情况下，分配给 mapType.parking 的函数看起来像这样......

```
function(coord, zoom) {
    return "/maps/tiles/tilesparking/" + zoom + "_" + coord.x + "_" + coord.y + ".png";
}; 
```

...在第一段代码中定义函数之后。有没有办法获取变量/数组的值并使用它来静态定义函数，同时将其他两个变量保持为变量。

* * *

**编辑：**看看下面的各种答案，以下是我迄今为止所能达到的最好的答案。虽然在更一般的情况下绑定可能是理想的方法，但在这种特定情况下，“getTileUrl：”显然需要特定的语法，并且将绑定放置在为其定义的函数周围会导致地图错误。在尝试 KGZM 的建议时，它适用于所有最新版本，而不适用于 IE8 及更低版本。

```
var tileNames = ["beloit", "parking", "access_p"];
var mapType = {};

for (var i = 0; i <= (tileNames.length - 1); i++) {
    (function(i) {
        tileOptions = {
            getTileUrl: function(coord, zoom) {
                return "/maps/tiles/tiles" + tileNames[i] + "/" + zoom + "_" + coord.x + "_" + coord.y + ".png";
            },
            tileSize: new google.maps.Size(256, 256)
        };
        mapType[tileNames[i]] = new google.maps.ImageMapType(tileOptions);
    })(i);
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T19:56:37.827

有一个函数式编程概念可以很好地处理这个问题

基本上，您的函数实际上具有三个参数，即`zoom`变量、`coord`对象和`tileNames[i]`值，但您希望`tileNames[i]`在代码中一次将值固定为特定值，并将其他两个变量保留为实际变量。

```
function getTileUrlBuilder(tilename) {
    return function(coord, zoom) {
        return "/maps/tiles/tile" + tilename + "/" + zoom + "_" + coord.x + "_" + coord.y;
    };
} 
```

然后你可以在你的循环中使用这个函数。但是，由于这实际上是一个常见的操作，您可以使用该`bind`方法来处理它：

```
(function(tilename, coord, zoom) {
    return "/maps/tiles/tile" + tilename + "/" + zoom + "_" + coord.x + "_" + coord.y
}).bind(this, tileNames[i]); 
```

这会将隐式“绑定”`this`到 current `this`，然后将第一个参数绑定到 的当前值`tileNames[i]`。

编辑：我认为这应该是工作代码。

```
var tileNames = ["beloit", "parking", "access_p"];
var mapType = {};

function getTileUrlFull(tileName, coord, zoom) {
    return "/maps2/tiles/tiles" + tileName + "/" + zoom + "_" + coord.x + "_" + coord.y + ".png"
}

for(var i = 0; i < tileNames.length; i++) {
    mapType[tileNames[i]] = new google.maps.ImageMapType({
        getTileUrl: getTileUrlFull.bind(this, tileNames[i]),
        tileSize: new google.maps.Size(256, 256)
    });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:54:25.537

你需要另一个关闭。循环运行后，变量“i”的值为 3。 tileNames[3] => 未定义。但是您创建的每个函数都包含对同一个 i 变量的引用。

尝试这样的事情：

```
 for (var i = 0; i < tileNames.length; i++) {
      (function(i) {
        //loop body goes here.
      })(i);
    }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T19:51:33.757

你需要传入`i`你的`getTileUrl`函数：

```
getTileUrl: function(i, coord, zoom) {
        return "/maps/tiles/tiles" + tileNames[i] + "/" + zoom + "_" + coord.x + "_" + coord.y + ".png";
    }, 
```

# php - 合并两个 MySQL 表

> ID：11214809
> 
> 赞同：1
> 
> 时间：2012-06-26T19:41:38.973
> 
> 标签：php, mysql, merge

我需要从还原到同一台机器的备份数据库中合并生产 mysql 数据库中的任何缺失行。

如何在保留自动递增的原始主键 ID 的同时做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:45:31.997

你可以试试：

```
INSERT IGNORE INTO table_1 SELECT * FROM table_2; 
```

这允许 table_1 中的那些行取代 table_2 中具有匹配主键的行，同时仍插入具有新主键的行。

或者，

```
REPLACE INTO table_1 SELECT * FROM table_2; 
```

将使用 table_2 中的相应行更新 table_1 中已经存在的那些行，同时插入具有新主键的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:45:58.477

```
--create a backup just in case
CREATE TABLE table_prod_sav SELECT * FROM table_prod;

--insert the missing rows
INSERT INTO table_prod (id, field) 
    SELECT b.id, b.field 
    FROM table_backup b LEFT JOIN table_prod p ON b.id = p.id
    WHERE p.id IS NULL;

--Check consistency...

--DROP TABLE table_prod_sav; 
```

# assembly - 将 MOVF 与单个操作数一起使用是否有效？如果有，有什么好处？

> ID：11214814
> 
> 赞同：1
> 
> 时间：2012-06-26T19:41:54.623
> 
> 标签：assembly, pic, microchip

我遇到了几个在没有第二个操作数的情况下使用 MOVF 的示例，例如：

```
;incorrect context restore
MOVF  STATUS_Temp,w
MOVWF STATUS
MOVF  W_Temp ;this may change the Z bit    <------ !! MOVF with single operand !!
             ;in the Status register

;good context restore
MOVF  STATUS_Temp,w
MOVWF STATUS
SWAPF W_Temp,f ;swap in place
SWAPF W_Temp,w ;swap with Wreg destination 
```

（样本取自 PICKIT2 LPC 板用户指南）

MPLAB SIM 中的一个快速实验表明第二个“目标”操作数是可选的，默认为工作寄存器。IE

```
MOVF  W_Temp,w 
```

这是那些编码“功能”之一，虽然严格来说是可能的，但只是另一种降低代码可读性的方法吗？或者还有更多的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T08:49:20.917

这仅在我们离开**中断**程序时才重要，因此我们必须正确恢复所有 ALU 标志！

```
 ...   
    MOVF  STATUS_Temp,w ;Restore ALU flags
    MOVWF STATUS 
    MOVF  W_Temp,w      ;Restore the w register and also affect to the Zero flag
    RETFIE              ;Exit from interrupt 
```

指令`MOVF W_Temp`应该像我们期望的那样将 w 文件寄存器的内容复制回来，但另一方面也会影响到作为 STATUS 文件寄存器一部分的零标志。因此，如果我们想在离开中断时正确恢复 privius Zero 标志状态，我们就不能使用它。

```
 ...
    MOVF  STATUS_Temp,w ;Restore ALU flags
    MOVWF STATUS 
    SWAPF W_Temp,f
    SWAPF W_Temp,w      ;Restore the w register  
    RETFIE              ;Exit from interrupt 
```

在第二种情况下，SWAPF（我们执行双重交换，以便正确恢复 w 寄存器的内容）指令不会影响零标志，因此使用它是安全的。

**编辑：**

如果您阅读了 Microchip 数据表，那么您会发现该`MOVF`指令也有一个（位大小）操作数。

因此，您可以在 MPLAB IDE 中编写。

```
MOVF  W_Temp, W    ;Copy W_Temp to W and set Zero flag if value is 0, otherwise clear.
MOVF  W_Temp, F    ;Copy W_Temp back to W_Temp  and set Zero flag if value is 0, otherwise clear.
MOVF  W_Temp       ;Is equal MOVF  W_Temp, F beacuse the defailt operant is F (1) 
```

如果我们不想测试文件寄存器的零内容而不改变 w 寄存器的内容，使用`MOVF W_Temp, F`(or `MOVF W_Temp`) 很有 用。`W_Temp`

# python-3.x - 从python执行windows命令行操作

> ID：11214817
> 
> 赞同：0
> 
> 时间：2012-06-26T19:42:08.273
> 
> 标签：python-3.x

> **可能重复：**
> [如何在 Python 中调用外部命令](https://stackoverflow.com/questions/89228/how-to-call-external-command-in-python)

我想使用 python 执行 windows 命令行操作。要执行命令，我必须转到系统中的特定目录，然后执行命令。例如

1) 转到特定目录 c:\some\directory

2）然后使用命令 somecommand -x -y

我看到了一些关于这个主题的帖子，但我无法正确理解它们。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:55:42.820

我假设您想更改工作目录然后执行命令。所以：

```
os.chdir(DIRECTORY);
os.system(COMMAND); 
```

*   [os.chdir](http://docs.python.org/library/os.html#os.chdir) - 设置当前工作目录。
*   [os.system](http://docs.python.org/library/os.html#os.system) - 执行“系统”命令。

如果不需要设置工作目录，您可以指定*os.system*的完整路径。

此外，您可能需要检查[子流程](http://docs.python.org/library/subprocess.html)，因为它可能是您正在[寻找的](https://stackoverflow.com/questions/3762468/subprocesses-with-different-working-directories-problem-with-python)更多内容。

# sql - 在 Oracle 中使用包含波浪号分隔数据的列

> ID：11214818
> 
> 赞同：0
> 
> 时间：2012-06-26T19:42:10.277
> 
> 标签：sql, oracle, oracle11g

我在表中有一个包含波浪号分隔数据的列。

我想触发一个 SINGLE sql 查询（出于性能原因），它应该返回表中的所有记录，对于这些记录，此波浪号分隔数据中的至少一个标记不在有效值的预定义列表中。

我曾在各种论坛中寻找解决方案，其中大多数人说有一个用户定义的拆分函数来拆分记录或使用一些正则表达式，但这不适用于单个查询。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T19:50:15.807

您可以使用正则表达式在单个 SQL 语句中解析数据。然后，您可以应用您想要的任何过滤器来查找不在预定义列表中的值集

```
SQL> ed
Wrote file afiedt.buf

  1  with test as
  2    (select 'ABC~DEF~GHI~JKL~MNO' str from dual)
  3  select regexp_substr (str, '[^~]+', 1, rownum) split
  4    from test
  5* connect by level <= length (regexp_replace (str, '[^~]+'))  + 1
SQL> /

SPLIT
----------------------------------------------------------------------------
ABC
DEF
GHI
JKL
MNO 
```

你也可以做这样的事情

```
SQL> ed
Wrote file afiedt.buf

  1  with test as
  2    (select 1 id, 'ABC~DEF~GHI~JKL~MNO' str from dual union all
  3     select 2, 'XY~PDQ~435' from dual union all
  4     select 3, 'This~is~a~test' from dual)
  5  select id, regexp_substr (str, '[^~]+', 1, e.lvl) split
  6    from test,
  7         (select level lvl
  8            from dual
  9         connect by level <= (select max(regexp_count(str,'~')) + 1
 10                                from test)) e
 11*  where regexp_substr (str, '[^~]+', 1, e.lvl) is not null
SQL> /

        ID SPLIT
---------- --------------------
         1 ABC
         2 XY
         3 This
         1 DEF
         2 PDQ
         3 is
         1 GHI
         2 435
         3 a
         1 JKL
         3 test
         1 MNO

12 rows selected. 
```

当然，这不会特别有效——您将不得不对表进行全面扫描，因为您将无法有效地索引各种子字符串。还有其他生成行的方法——Rob van Wijk在他的博客中有一篇文章比较了各种[基于间隔的行生成技术的性能。](http://rwijk.blogspot.com/2007/11/interval-based-row-generation.html)

修复数据模型通常会好得多。在列中存储分隔数据违反了基本的规范化原则。如果您将数据存储在单独的列中（可能在与现有表具有一对多关系的单独表中），您可以索引数据，并且可以创建映射到预定义的有效列表的外键约束值，以便您可以首先防止插入无效数据（或至少防止将来添加新的无效行）。

# r - 如何对因子变量求和

> ID：11214819
> 
> 赞同：1
> 
> 时间：2012-06-26T19:42:12.923
> 
> 标签：r, datetime, dataframe

我正在尝试对“市值”列进行总和，但我无法做到，因为它是一个数据框，并且数字末尾有一个 B。

如果我的数据框被称为 Y 计算 533.5 + 15.449 之和所需的代码是什么？

![在此处输入图像描述](../Images/2fa09dcd5812ae974a3838e52c949a88.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T19:58:17.157

```
sum( as.numeric( sub("B$", "", as.character(Y$Capitalization) ) ) ) 
```

如果对可能的 'MM' 或 'M' 条目提出的担忧是有效的，您可能需要执行一组级联`sub`调用：

```
sum( as.numeric( sub("B$", "000000000", 
                      sub("MM", "000000",  as.character(Y$Capitalization) ) ) ) ) 
```

（这将取决于“B”、“MM”和“M”对构建数据的人的实际含义。）

这是我能想到的“正则表达式”模式的更简单用途之一。模式“B$”将匹配字符向量元素中的最后一个 B。因为整个向量将通过这些函数，所以不需要循环。我想可以简单地使用“B”，这将删除“3BB”中的*所有*B，“6BxB”中的“4BBB”。

# silverlight - 调整OOB全屏silverlight应用程序的大小

> ID：11214824
> 
> 赞同：0
> 
> 时间：2012-06-26T19:42:35.530
> 
> 标签：silverlight, silverlight-4.0, silverlight-toolkit, silverlight-5.0

我想根据用户偏好调整我的全屏 OOB silverlight 应用程序的大小。

用户应该能够调整大小并将全屏应用程序保留为小部件。

当我尝试应用调整大小属性时，它会应用到 localhost 而不是全屏窗口。

谢谢，

卡提克。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T10:58:10.567

```
if (App.Current.MainWindow.WindowState == WindowState.Normal)
{
    App.Current.MainWindow.WindowState = WindowState.Maximized;
}
else
{
    App.Current.MainWindow.WindowState = WindowState.Normal;
} 
```

# mysql - 使用 MySQL 函数格式化列名

> ID：11214826
> 
> 赞同：1
> 
> 时间：2012-06-26T19:43:04.133
> 
> 标签：mysql, sql

我有一个像这样的查询

```
select user,
if(purchase_date='2012-06-10' - interval 1 day, revenue, 0),
if(purchase_date='2012-06-10' - interval 2 day, revenue, 0),
if(purchase_date='2012-06-10' - interval 3 day, revenue, 0)
from purchases
group by user; 
```

我想通过执行类似的操作将列的日期格式更改为“Mon 6-10”

```
select user,
if(purchase_date='2012-06-10' - interval 1 day, revenue, 0) AS date_format('2012-06-10' - interval 1 day, '%M %D-%m')
if(purchase_date='2012-06-10' - interval 2 day, revenue, 0) AS date_format('2012-06-10' - interval 2 day, '%M %D-%m')    
if(purchase_date='2012-06-10' - interval 3 day, revenue, 0) AS date_format('2012-06-10' - interval 3 day, '%M %D-%m') 
```

但是我收到一条 SQL 错误，说 ERROR 1064 (42000): You have an error in your SQL syntax; 检查与您的 MySQL 服务器版本相对应的手册，以获取在附近使用的正确语法...'

是否有可能做到这一点？

我希望输出看起来像

```
user Mon 6-9 Sun 6-8 Sat 6-7
---- ------- ------- -------
   1      23     34       65
   4      26     21       65
  11      21     65        0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T21:51:35.387

你相信我有解决办法吗？

我真的不得不在这个上发挥我的想象力。我稍微更改了查询以每天执行 SUM。请跟随：

您基本上需要构建此查询

```
select user,
SUM(if(purchase_date=DATE(NOW()) - interval 1 day, revenue, 0)) sum1,
SUM(if(purchase_date=DATE(NOW()) - interval 2 day, revenue, 0)) sum2,  
SUM(if(purchase_date=DATE(NOW()) - interval 3 day, revenue, 0)) sum3
from purchases
GROUP BY user; 
```

从这个

```
select * from 
(select dt,DATE_FORMAT(dt,'%a %c-%e') dh FROM
(select distinct purchase_date dt from purchases) dthdrs) DateHeaders; 
```

首先，让我们制作一些示例数据：

```
drop database if exists idris;
create database idris;
use idris
create table purchases
(
    id int not null auto_increment,
    user int,
    purchase_date date,
    revenue int,
    primary key (id)
) ENGINE=MyISAM;
create table dummydata like purchases;
alter table dummydata drop column id;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set purchase_date = purchase_date - interval 1 day;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set purchase_date = purchase_date - interval 1 day;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set purchase_date = purchase_date - interval 1 day;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set user=4;
insert into purchases (user,purchase_date,revenue) select user,purchase_date,revenue from dummydata;
delete from dummydata;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set purchase_date = purchase_date - interval 1 day;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set purchase_date = purchase_date - interval 1 day;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set purchase_date = purchase_date - interval 1 day;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set user=11;
insert into purchases (user,purchase_date,revenue) select user,purchase_date,revenue from dummydata;
delete from dummydata;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set purchase_date = purchase_date - interval 1 day;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set purchase_date = purchase_date - interval 1 day;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set purchase_date = purchase_date - interval 1 day;
insert into dummydata (purchase_date,revenue) values (date(now()),floor(rand() * 100));
update dummydata set user=1;
insert into purchases (user,purchase_date,revenue) select user,purchase_date,revenue from dummydata;
delete from dummydata;
select * from purchases; 
```

运行此之后，我制作了以下数据：

```
mysql> select * from purchases;
+----+------+---------------+---------+
| id | user | purchase_date | revenue |
+----+------+---------------+---------+
|  1 |    4 | 2012-06-23    |      45 |
|  2 |    4 | 2012-06-24    |      18 |
|  3 |    4 | 2012-06-25    |      55 |
|  4 |    4 | 2012-06-26    |      20 |
|  5 |   11 | 2012-06-23    |      39 |
|  6 |   11 | 2012-06-24    |      32 |
|  7 |   11 | 2012-06-25    |      44 |
|  8 |   11 | 2012-06-26    |      26 |
|  9 |    1 | 2012-06-23    |      99 |
| 10 |    1 | 2012-06-24    |      17 |
| 11 |    1 | 2012-06-25    |      88 |
| 12 |    1 | 2012-06-26    |      91 |
+----+------+---------------+---------+
12 rows in set (0.00 sec)

mysql> 
```

让我们运行我发布的第一个查询

```
mysql>  select user,
    -> SUM(if(purchase_date=DATE(NOW()) - interval 1 day, revenue, 0)) sum1,
    -> SUM(if(purchase_date=DATE(NOW()) - interval 2 day, revenue, 0)) sum2,
    -> SUM(if(purchase_date=DATE(NOW()) - interval 3 day, revenue, 0)) sum3
    -> from purchases
    -> GROUP BY user;
+------+------+------+------+
| user | sum1 | sum2 | sum3 |
+------+------+------+------+
|    1 |   88 |   17 |   99 |
|    4 |   55 |   18 |   45 |
|   11 |   44 |   32 |   39 |
+------+------+------+------+
3 rows in set (0.00 sec)

mysql> 
```

这是我发布的第二个查询，它将构建标题

```
mysql> select * from
    -> (select dt,DATE_FORMAT(dt,'%a %c-%e') dh FROM
    -> (select distinct purchase_date dt from purchases) dthdrs) DateHeaders;
+------------+----------+
| dt         | dh       |
+------------+----------+
| 2012-06-23 | Sat 6-23 |
| 2012-06-24 | Sun 6-24 |
| 2012-06-25 | Mon 6-25 |
| 2012-06-26 | Tue 6-26 |
+------------+----------+
4 rows in set (0.00 sec)

mysql> 
```

[**现在让我们组成 VOLTRON**](http://youtu.be/V-RiJZ8W4jA)

这是您需要的标题组合的两个查询：

```
mysql> select CONCAT('select user,',rv,' from purchases GROUP BY user')
    -> INTO @voltron from
    -> (select GROUP_CONCAT(CONCAT('SUM(if(purchase_date=''',dt,''',revenue,0)) as "',dh,'"')) rv
    -> from (select dt,DATE_FORMAT(dt,'%a %c-%e') dh FROM
    -> (select distinct purchase_date dt from purchases) dthdrs) DateHeaders) A;
Query OK, 1 row affected (0.01 sec)
mysql> select @voltron\G
*************************** 1\. row ***************************
@voltron: select user,SUM(if(purchase_date='2012-06-23',revenue,0)) as "Sat 6-23",SUM(if(purchase_date='2012-06-24',revenue,0)) as "Sun 6-24",SUM(if(purchase_date='2012-06-25',revenue,0)) as "Mon 6-25",SUM(if(purchase_date='2012-06-26',revenue,0)) as "Tue 6-26" from purchases GROUP BY user
1 row in set (0.00 sec)

mysql> 
```

好的，我形成了查询。但是有用吗？？？

看哪

```
mysql> PREPARE s1 FROM @voltron;
Query OK, 0 rows affected (0.00 sec)
Statement prepared

mysql> EXECUTE s1;
+------+----------+----------+----------+----------+
| user | Sat 6-23 | Sun 6-24 | Mon 6-25 | Tue 6-26 |
+------+----------+----------+----------+----------+
|    1 |       99 |       17 |       88 |       91 |
|    4 |       45 |       18 |       55 |       20 |
|   11 |       39 |       32 |       44 |       26 |
+------+----------+----------+----------+----------+
3 rows in set (0.00 sec)

mysql> DEALLOCATE PREPARE s1;
Query OK, 0 rows affected (0.00 sec)

mysql> 
```

所以，这是可能的。您只需发挥您的想象力，让 MySQL 为您构建查询。

# java - 如何从 do while 循环中检索变量值

> ID：11214827
> 
> 赞同：0
> 
> 时间：2012-06-26T19:43:04.163
> 
> 标签：java

我是 Java 的初学者，正在为一门课程做一个 Mastermind 项目。

我有个问题。我想检索 的值`leftDigit`并将其放入 array `guess[4]`。但我不知道如何在循环之外检索它。

假设当我输入数字 1234 并且我希望它变成`int[] guess = { 1, 2, 3, 4};` `

```
public static void inputNumber(){   

        Scanner input = new Scanner(System.in);
        currentRow++;

        System.out.printf ("Enter 4 numbers for attempt #%d: ", currentRow);

        int count = 10000, leftDigit;
        double tempNum;

        int number = input.nextInt();

        //finding the left digit   
        do{    
            tempNum = (double) number / count ;  
            leftDigit =  (int) (tempNum * 10) ;         
            count /=10;                         
            number = number - ( count * leftDigit);             
        } while (count != 1 );
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:48:36.553

```
 int [] guess = new int[4];
    int i = 0;
    //finding the left digit   
    do{    
        tempNum = (double) number / count ;  
        leftDigit =  (int) (tempNum * 10) ;

        guess[i++] = leftDigit;

        count /=10;                         
        number = number - ( count * leftDigit);             
    } while (count != 1 );

    //Use guess as you want it contains the 4 digits you need 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T17:47:24.513

发布的解决方案有效，但有一些事情是不必要的。这是代码，我将在下面解释：

```
int count = 1000;                    // notice I start at 1000, not 10_000
int[] guess = new int[4];
int i = 0;

do {
    guess[i++] = number / count;     // (1)
    number %= count;                 // (2)
    count /= 10;
} while (count != 1) 
```

**(1):**因为 number 和 count 都是*int*类型，所以结果不会是浮点数，也不会四舍五入。它只会截断浮动部分。例如：8 / 3 == 2；543 / 1000 == 0。

**(2)：**这一行将得到除法的余数。例如：16 % 5 = 1；1043 % 1000 = 43。（写此行的另一种方式是`number = number % count`）。

# android - 如何发送带有意图的 android.location.Address 作为 putextra

> ID：11214829
> 
> 赞同：2
> 
> 时间：2012-06-26T19:43:12.860
> 
> 标签：android, android-intent, static, bundle, start-activity

`android.location.Address`是否可以将with的实例放到`Intent`另一个活动中？

```
Address current_location; 
```

我的意思是，我试图通过以下方式直接将 current_location 与意图放在一起：

1.  `IntentName.putExtra("current_location",current_location);`

2.  或间接通过捆绑：

    ```
    Bundle b = new Bundle();
    b.put....("current_location",current_location);
    IntentName.put(b); 
    ```

如果上述策略都不支持“地址”，那么将地址实例传递给另一个活动的最佳方法应该是什么？如果我声明， `public static Address current_location;`

并尝试从另一个活动中访问它，那么无法保证 Android 将保存 current_location 数据。还是我错了？

在这种情况下，应该采取什么方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T19:55:03.213

你会想通过它作为一个包裹。通过查看 API，我认为它们已经符合标准。

地址扩展对象实现 Parcelable

[https://developer.android.com/reference/android/location/Address.html](https://developer.android.com/reference/android/location/Address.html)

因此，要将其打包并发送，您将执行以下操作：

```
 String key = getResources().getString(key);

    startActivity( new Intent()
                        .setClass(this, YourActivity.class)
                        .putExtra(key, current_location )
    ); 
```

然后在您的活动中重新组装它，您将执行以下操作：

```
 String key = getResources().getString(key);
   Address current_location = getIntent().getExtras().getParcelable(key); 
```

**密钥**只是您用来存储包裹的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:51:33.413

我不知道你是否能够传递一个地址（见下文），但为什么不只传递经度和纬度（两者都`double`可以作为附加项放置），然后在下一个活动中重建它？

Address 似乎确实实现了`Parcelable`接口，这意味着您可以将其发送为`intent.putParcelable(key, address)`.

# asp.net-mvc - System.Net.DownloadFile()——文件在哪里下载，只有一个文件名作为 web 应用程序中的第二个参数

> ID：11214831
> 
> 赞同：0
> 
> 时间：2012-06-26T19:43:17.943
> 
> 标签：asp.net-mvc, web-applications, download

尝试设置个人图像上传/下载器网页。我已经查看了有关该功能的 msdn 文章，它运行良好，但我无法弄清楚它将文件保存到哪里。

```
var request = new WebClient();
request.DownloadFile("https://someabosolute/image/path/andfilename.png", "file.png"); 
```

有任何想法吗？

将 filename.png 更改为 C:\tmp\filename.png 后，@escape 或 \ 解决无效字符问题。但是，使用 jsut 文件名会导致错误一切运行，但我找不到该文件。甚至检查了 Windows 安全和应用程序日志，也没有与时间框架相关的内容。

**因此，当您仅将文件名指定为 system.net.webclient 的 DownloadFile() 方法中的第二个参数时，应将文件保存到 Web 应用程序的哪个位置。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:47:35.303

根据[Microsoft 文档](http://msdn.microsoft.com/en-us/library/ez801hhe)中的示例，该文件将下载到`Application.StartupPath`. 如果只提供了一个文件名，它将保存在与您的可执行文件相同的路径中。

请记住，对于某些应用程序（例如 ASP.NET Web 应用程序），将文件保存在与可执行文件相同的文件夹中可能存在权限问题。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net;

namespace ConsoleApplication2
{
  class Program
  {
    static void Main(string[] args)
    {
      string remoteUri = "put your url here";
      string fileName = "image.php_.jpeg", myStringWebResource = null;
      // Create a new WebClient instance.
      WebClient myWebClient = new WebClient();
      // Concatenate the domain with the Web resource filename.
      myStringWebResource = remoteUri + fileName;
      Console.WriteLine("Downloading File \"{0}\" from \"{1}\" .......\n\n", fileName, myStringWebResource);
      // Download the Web resource and save it into the current filesystem folder.
      myWebClient.DownloadFile(myStringWebResource, @"c:\tmp\" + fileName);
      Console.WriteLine("Successfully Downloaded File \"{0}\" from \"{1}\"", fileName, myStringWebResource);
    }
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T06:54:23.633

...愚蠢的我的第二个参数没有路径的默认位置在 C:\program files(x86)\iisexpress

# c# - 如何获得以 XP 为主题的 TreeView 展开/折叠图标？

> ID：11214833
> 
> 赞同：0
> 
> 时间：2012-06-26T19:43:31.407
> 
> 标签：c#, wpf, dll, treeview, themes

我有一个基本的 C# WPF TreeView，但我不喜欢展开/折叠图标是三角形，我想改用加号/减号图标。

从[这个问题](https://stackoverflow.com/questions/5131534/how-to-get-windows-native-look-for-the-net-treeview)，我注意到您可以为应用程序设置Windows主题，它使用*uxtheme.dll*更改为Vista / 7主题，更改为XP主题的主题DLL是什么以及如何添加引用xaml 文件中使用修改后的 TreeView 控件的行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T20:00:00.917

UxTheme.dll 为使用公共控件库的应用程序提供主题服务，此外还提供部分 Windows chrome（如窗口边框和标题栏）和自定义元素（如开始菜单和任务栏）。UxTheme.dll 于 2001 年随 Windows XP 引入，但它提供的服务因 Windows 版本而异。

WPF 不使用 UxTheme.dll 作为其主题 - 所有 WPF“视觉样式”实际上都是 XP“Luna”（XP 的 Fischer-Price 主题）、XP“Royale”（MCE2005）和 Vista/7 Aero 的矢量图形重新实现样式。此外，WPF 也不使用 Common Controls 库，它对所有主要的 Windows 控件进行 100% 托管的重新实现——这就是 WPF 应用程序在 Windows 上倾向于落入 Uncanny Valley 的原因——它们看起来像本机应用程序，但*有些东西*不是对他们。

我自己不是 WPF 专家，但我知道你可以覆盖特定元素的渲染，但是我不知道你是否可以在不继承它们的情况下做到这一点。

我很抱歉没有直接回答你的问题，我只是希望我能提供一些有用的见解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T20:26:46.690

不幸的是，我认为这需要覆盖 TreeView 的默认样式和控件模板。这是 MSDN 的链接：http: [//msdn.microsoft.com/en-us/library/ms752048.aspx](http://msdn.microsoft.com/en-us/library/ms752048.aspx)。如果您搜索**Path x:Name="Collapsed"**和**Path x:Name="Expanded"**这就是箭头的绘制方式。

您可以通过将 Path 元素与每个状态的 Image 交换来覆盖它。或者，您也可以使用 Path 元素来绘制类似于您想要的 + - 效果的东西。

# mysql - 我怎样才能抽象出或删除这种依赖关系

> ID：11214838
> 
> 赞同：0
> 
> 时间：2012-06-26T19:44:03.737
> 
> 标签：mysql, database, normalization

我有一个 3nf 分贝。在其中，有一系列两个表，它们是更大的依赖链的一部分。这两个表（A 和 B）在执行参照完整性方面给我带来了问题。

```
Table A
int AId //primary key
string Name
date Date
int BId //foreign key

Table B
int BId //primary key
string Name
string Description
int CId //foreign key

Table C
int CId
string HowTo 
```

*这些表是部分示例，请参见下面的说明：*

表 C 包含有关如何制作 FooBar 的信息。制作 FooBar 时，表 B 记录了为跟踪和 QA 目的制作 FooBar 的实际方式。一旦制作了 FooBar，并且在表 B 中填写了它的制作方式数据，表 A 将通过外键 BId 保存一个新的 FooBar 以及来自表 B 的信息。

我的问题是，有时作为一个孤立的案例， FooBar 需要能够在*没有*被制作的情况下进入系统（基本上作为导入）。但是，由于设计不佳，如果没有（在此示例中）表 B 中的相关条目以确保表 A 中的外键有效且不破坏参照完整性，这是不可能的。

我正在考虑采用的方法是在 A 和 B 之间放置另一张桌子。

```
Table AB
int ABId //primary key
int BId //foreign key
int AId //foreign key 
```

原因是可以从表 B 中的一个条目中生成多个 FooBar，这意味着此更改可能导致：

```
Table AB

ABId  BId  AId
1     2    6
2     2    7
3     2    8
4     3    9
5     3    10 
```

A）我应该使用**不同的方法**来消除这种依赖关系，以便可以将记录添加到表 A 而无需满足表 B 中的外部记录？

B）是否建议进行更改会减慢查询速度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T19:47:03.367

只需使`A.BId`能够包含`NULL`，并将其设置为`B-less`A 的。`NULL`' 不参与外键。

# api - 内部服务器错误大文件

> ID：11214839
> 
> 赞同：0
> 
> 时间：2012-06-26T19:44:09.867
> 
> 标签：api, soundcloud

我在我的一个站点中使用 Soundcloud API，文档说最大上传文件为 500MB，每次我尝试上传大于 1mb 的文件时，系统都会返回 500 错误（内部服务器错误）。小于 1MB 的文件可以正常工作。

我正在使用 PHP 5、curl 和 Soundcloud API。

感谢您的关注！

拥抱。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T20:05:41.990

500mb 的限制是*他们的*API，向他们发送文件。但是，如果您的服务器最初接收文件（然后发送到 soundcloud），则您的服务器也有限制。这通常在您的 php.ini 中定义：

```
upload_max_filesize = 50M
post_max_size = 50M 
```

或者，如果您无权访问您的 ini 文件，*有时这可能会在您的 htaccess 中被覆盖：*

```
php_value upload_max_filesize 50M
php_value post_max_size 50M 
```

您还需要使用[set_time_limit](http://php.net/manual/en/function.set-time-limit.php)或在 php.ini 中设置 max_execution_time （15 分钟？）和内存限制来增加脚本执行时间：

```
max_execution_time = 900
memory_limit = 64M 
```

您需要小心并考虑增加这些限制的影响。它们被设计为安全机制。例如，如果你增加 memory_limit 并且 PHP 消耗太多内存，当前进程将转移到交换和降低性能，并可能导致机器崩溃甚至更糟糕的损坏数据；最大执行时间将允许脚本停留更长时间，所以如果你的脚本写得不好，它可能会无限期挂起或至少挂起 15 分钟（就像我上面所说的那样）并最终达到其内存限制或机器的限制 -更不用说让多个脚本运行并累积消耗资源。

# hibernate - 我可以让 Hibernate 根据唯一列约束替换对象吗？

> ID：11214843
> 
> 赞同：4
> 
> 时间：2012-06-26T19:44:38.027
> 
> 标签：hibernate, replace, save, unique-constraint

我正在使用 Hibernate 4.0.1.Final。我有一个带有唯一约束列的表……</p>

```
@Entity
@Table(name = "cb_contract",
    uniqueConstraints = {@UniqueConstraint(columnNames={"ORDER_ID"})}
)
public class Contract {
    ... 
    @Column(name = "ORDER_ID")
    private String orderId; 
```

目前，如果我尝试使用以下方法保存两个具有相同订单 ID 列值的对象...

```
protected void saveOrUpdate(Object obj) {
    final Session session = sessionFactory.getCurrentSession();
    session.saveOrUpdate(obj);
} 
```

保存第二个实例时，我收到“org.hibernate.exception.ConstraintViolationException：完整性约束违规：唯一约束或索引违规”异常。有没有一种方法可以让 Hibernate 根据唯一列保存或替换对象，或者我是否需要先搜索对象，如果它存在则删除它，然后重新插入该对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T20:11:24.810

我认为您是正确的，但是与您尝试做的最接近的事情记录在此处[-Hibernate 可以使用 MySQL 的“ON DUPLICATE KEY UPDATE”语法吗？](https://stackoverflow.com/questions/913341/can-hibernate-work-with-mysqls-on-duplicate-key-update-syntax)

根据您要执行的操作，如果已经存在具有相同键/约束的记录，我会担心您很乐意覆盖现有记录。

我宁愿完全删除唯一约束，而是为该 orderId 获取具有最大 Id 的约束。这样，您至少可以保留具有该 orderId 的所有合同的备份副本。然而，这显然在内存空间上效率较低。

# sql - 获取 x 列的非重复项但 y 列的重复项

> ID：11214846
> 
> 赞同：2
> 
> 时间：2012-06-26T19:44:56.583
> 
> 标签：sql, join, unique, record

我有一张桌子（称它为 table myTable）。

它有这样的数据：

号码/姓名

```
1    jake
2    chris
3    sally
4    billy
1    tom
5    cathy 
```

（我意识到这是一个糟糕的设置，但我没有得到奢侈的设置）

* * *

* * *

我需要查询此表，以便返回结果：

```
1    jake
2    chris
3    sally
4    billy
5    cathy 
```

或者

```
2    chris
3    sally
4    billy
1    tom
5    cathy 
```

* * *

* * *

为重复的数字返回哪个名称并不重要……只有返回一个。

这是我不工作的尝试：

```
with
a as (
      SELECT number
      FROM myTable
),

b as (
      SELECT number, name
      FROM myTable
)

SELECT a."number", b."name"

FROM a
left join b on a."number" = b."number" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:47:40.437

用于`GROUP BY`确保每个`number`仅返回一次，并使用聚合函数为 选择以下值之一`name`：

```
SELECT number, MAX(name) AS name
FROM yourtable
GROUP BY number 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:49:25.243

试试这个。由于您不关心返回属于数字的多个名称中的哪一个，因此您可以使用 max 或 min 函数。

```
select number, max(name)
from myTable
group by number 
```

# eclipse - Eclipse 文本显示不正确

> ID：11214848
> 
> 赞同：1
> 
> 时间：2012-06-26T19:45:00.270
> 
> 标签：eclipse, character-encoding, text-editor

我最近在 Ubuntu 11.04 上安装了面向 Java 开发人员的 Eclipse IDE：Indigo Service Release 2。

我在其中创建了一个 Android 项目。但是我在使用文本编辑器时遇到了一些问题。

以下文字

R.layout.main

显示为

R.layout.☐☐☐☐

即，不显示分配给变量的所有值。

如果我在 Eclipse 中使用“Android Common XML Editor”或“Android Manifest Editor”或“Text Editor”以外的任何文本编辑器（Eclipse 中提供）打开文件，我将面临同样的问题。

当我将文本复制并粘贴到 Eclipse 之外的其他编辑器，或在 Eclipse 中使用“文本编辑器”打开它时，它工作正常，但“文本编辑器”中没有语法突出显示等。

我尝试从首选项更改编辑器的字符编码，但没有一个编码起作用。

我该如何解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T20:41:03.150

检查您的字体设置。我怀疑使用的任何字体都不能正确处理*斜体*。

# java - 错误的符号类型：EmbeddedSolrServer.query

> ID：11214850
> 
> 赞同：0
> 
> 时间：2012-06-26T19:45:06.230
> 
> 标签：java, exception, solr, apache-tomee

我在从 Solr 实现 EmbeddedSolrServer 时遇到问题，它似乎在正确的位置，以及它的编译和一切，但是当它尝试发出请求时>

```
QueryResponse rsp = solrServer.getSolrServer().query(query); 
```

我得到以下异常：

```
avax.ejb.EJBException: The bean encountered a non-application exception; nested    exception is: 
java.lang.RuntimeException: Uncompilable source code - Erroneous sym type: EmbeddedSolrServer.query
at org.apache.openejb.core.ivm.BaseEjbProxyHandler.convertException(BaseEjbProxyHandler.java:368)
at org.apache.openejb.core.ivm.BaseEjbProxyHandler.invoke(BaseEjbProxyHandler.java:288)
at com.polyglong.solr.SolrServerController$LocalBeanProxy.getResult(com/polyglong/solr/SolrServerController.java)
at com.polyglong.solr.SolrServerTest.getResults(SolrServerTest.java:29) 
```

我正在使用 TomEE 和 Solr 3.6.0

# c# - 在 WPF 和 Blend 中为形状添加纹理

> ID：11214851
> 
> 赞同：1
> 
> 时间：2012-06-26T19:45:10.473
> 
> 标签：c#, wpf, blend

如何将纹理添加到比如说矩形，这样当我在画布上拉伸对象时，它会在调整大小时被覆盖？

谢谢

并不是说我关心负分，但是那些留下这种评分的人至少可以通过指出解决方案来获得一点好处，因为他们认为这是一个低级别的问题，所以我假设他们知道答案。我搜索了 blend 4 和与 xaml 相关的主题，但没有找到方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T14:35:40.290

将图像添加为填充矩形的图像画笔：

```
<Rectangle Width="auto" Height="auto" Name="myRectangle">
    <Rectangle.Fill>
        <ImageBrush ImageSource="C:\Users\Public\Pictures\Sample Pictures\sample.gif"/>
    </Rectangle.Fill>
</Rectangle> 
```

**来源：** [http ://social.msdn.microsoft.com/Forums/en/wpf/thread/4c70e94b-23a1-4533-9332-eaa08bcf113d](http://social.msdn.microsoft.com/Forums/en/wpf/thread/4c70e94b-23a1-4533-9332-eaa08bcf113d)

**输出：**

图片来源：http: [//googleblog.blogspot.com/2012/03/bringing-self-driving-cars-to-nascar.html](http://googleblog.blogspot.com/2012/03/bringing-self-driving-cars-to-nascar.html)

![在此处输入图像描述](../Images/d6b9ab5932baf375ed8e371b7110a393.png)

# html - 响应式闪光灯？

> ID：11214853
> 
> 赞同：1
> 
> 时间：2012-06-26T19:45:19.577
> 
> 标签：html, css, flash, background

**编辑**：我相信可以肯定地说 Flash 终于停产了。

一个客户最近要求一个闪光灯**背景**，即闪光灯必须在背景上。如何在定义高度时为 Flash 对象提供 100% 的宽度？

而且由于动画会在屏幕上伸展，是否可以让动画在窗口内重复播放？

我希望下图能阐明我的意思-

![在此处输入图像描述](../Images/6af43c0622999322f1228567d9f836e6.png)

（对不起这个愚蠢的标题。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:57:47.393

您应该能够将 flashObject 设置为 100% 宽度和 html 中的静态高度。任何平铺都必须在闪存本身内完成。您可能不得不大量使用与舞台变化大小相关的事件。

[http://swffit.millermedeiros.com/](http://swffit.millermedeiros.com/)也是一个很好的资源。它确实允许您使用 100% 宽度并指定最大/最小高度。不幸的是，该脚本不再处于积极开发中，可能必须针对现代浏览器进行修改。

我同意大卫的建议走另一条路，但我知道客户有时会怎样......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:55:58.313

此页面将有所帮助：[http ://www.aleosoft.com/flashtutorial_flashbackground.html](http://www.aleosoft.com/flashtutorial_flashbackground.html)

要点是为 Flash 的`<object>`容器提供定义其形状的 CSS 属性，并为其提供 z-index 值，使其位于其他页面元素的后面（请注意，您需要为 html 的内容提供 z-index）。

但是，我必须首先建议您不要使用 Flash - 为什么不能使用 SVG、Canvas 或 HTML5 来制作这个动画`<video>`？

我建议您在使用脚本进行功能检测后将 Flash`<object>`引入页面，而不是将其直接粘贴在 HTML 中，这样平板电脑和智能手机的用户（或只是 Flash 拒绝者）将不会看到丑陋的“需要插件”框。

# ruby-on-rails - ActiveRecord 如何与 postgres 做数据定义事务？

> ID：11214859
> 
> 赞同：0
> 
> 时间：2012-06-26T19:45:39.360
> 
> 标签：ruby-on-rails, postgresql, activerecord, transactions

数据定义事务是否与常规事务相同？

我想写一个迁移

1.  更改表 A
2.  做一些自定义数据迁移
3.  更改表 B

理想情况下，这一切都在同一个事务中。我可以将其粘贴在 ActiveRecord 迁移中并收工吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:06:56.930

是的，每个迁移都在一个事务中执行。从[迁移指南](http://guides.rubyonrails.org/migrations.html#migrations-are-classes)：

> 在支持带有更改架构的语句的事务的数据库上（例如 PostgreSQL 或 SQLite3），迁移被包装在事务中。

所以坚持迁移并收工。

# iphone - 放大时普通的CALayer变得模糊

> ID：11214860
> 
> 赞同：0
> 
> 时间：2012-06-26T19:45:39.360
> 
> 标签：iphone, image-processing, zooming, calayer, blurry

我的 CALayers 的分辨率有问题，放大后看起来很模糊。我知道有很多关于它的帖子，但是在阅读了很多帖子之后，我还没有找到解决方案，我对此感到困惑.

情况：应用程序有一个带有 UIView 的 UIViewController。在这个 UIView 下有一个 CALayer，用 CGPath 定义它的形状，添加为 [[self layer] addSublayer:myCALayer]。如果用户点击一个按钮，就会有一定数量的其他 CALayer 作为子层添加到主 CALayer (myLayer -> [myLayer addSublayer:Layer])。我的案例和网上找到的帖子的区别在于我没有 UIImages、UIImageViews 等，只有具有特定背景颜色的普通和基本的 CALayers。没有 UIScrollViews，只有 UIGestureRecognizers（tap、doubleTap、Pinch 和 Pan）。所有这些东西都很好用。

问题：当我放大 CALayers 时变得模糊。

这是问题的图像：

![](../Images/b10a8997e52adc1b4fba202a9de151a5.png)

这是我的代码：

这是 UIView 上定义的主要 CALayer：

```
- (id)initWithFrame:(CGRect)frame
{
    [super initWithFrame:frame]; 

    (…)

    perfil = [[CALayer alloc] init];
    perfilDelegate = [[perfilLayerDelegate alloc] init];
    [perfil setDelegate:perfilDelegate];
    [perfil setBounds:CGRectMake(0, 0, wideP, heigthP/2)];
    [perfil setPosition:CGPointMake(wideP/2, heigthP*3/4)];

    [perfil setShouldRasterize:TRUE];
    [perfil setRasterizationScale:[[perfil valueForKeyPath:@"transform.scale"] floatValue]];

    [[self layer] addSublayer:perfil];

    (…)
} 
```

这些是用户点击按钮时在 UIView 上定义的其他子层：

```
for (int i=0; i<[numLayers count]; i++)
{
    CALayer *Layer = [[CALayer alloc] init];

    punt = [[numLayers objectAtIndex:i] CGPointValue];

    [Layer setBounds:CGRectMake(0.0, 0.0, wideL, heigthL)]; 

    [Layer setBorderWidth:2.0];
    UIColor *reddish = [UIColor colorWithRed:1.0 green:0.0 blue:0.0 alpha:0.3];
    [Layer setBorderColor:[reddish CGColor]];
    [Layer setPosition:[[numLayers objectAtIndex:i] CGPointValue]];
    [Layer setCornerRadius:[Layer bounds].size.width/2];

    reddish = [UIColor colorWithRed:1.0 green:0.0 blue:0.0 alpha:0.2];
    CGColorRef cgReddish = [reddish CGColor];
    [Layer setBackgroundColor:cgReddish];

    [Layer setShouldRasterize:YES];
    [Layer setRasterizationScale:[[perfil valueForKeyPath:@"transform.scale"] floatValue]];

    [perfil addSublayer:Layer];

    [Layer release];
} 
```

任何提示将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T10:29:00.477

优化我的代码后，我所做的一项改进是将“perfil”CALayer 更改为 CAShapelayer。我想我在使用 CALayer 时出了点问题，但现在效果很好。

# wpf - 为什么生成列不适用于绑定到 DataTable 的 DataView 的 DataGrid？

> ID：11214872
> 
> 赞同：0
> 
> 时间：2012-06-26T19:46:27.510
> 
> 标签：wpf, xaml, datagrid

我对类型化 DataTable 的 DataView 属性有一个 DataGrid 回合，但是当我单击生成列时，我得到“您必须先设置 ItemsSource，然后才能执行此操作”。不知道我在这里做错了什么。请参阅下面的 XAML：

```
 <DataGrid AutoGenerateColumns="True" HorizontalAlignment="Stretch" 
      Margin="0" Name="dataGrid1" VerticalAlignment="Stretch" 
      ItemsSource="{Binding Path=DataView/}" 
      DataContext="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=my:MainWindow, AncestorLevel=1},
      Path=TransferSchedulesView/}"> 
```

TransferSchedulesView 是我的 MainWindow 上的一个属性，它公开了类型化 DataTable 成员的 DataView 属性。关于我在这里出错的地方有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:53:45.227

我看到你的绑定可能不正确。从绑定中删除前导斜杠，因为您绑定的不是集合，所以它没有当前项目。

这是我在尝试您的示例时在输出中看到的内容：

> System.Windows.Data 错误：40：BindingExpression 路径错误：在“当前集合项”“TransferSchedulesView”（HashCode=19117974）上找不到“属性”。BindingExpression:Path=TransferSchedulesView/; 数据项='主窗口'（名称=''）；目标元素是'DataGrid'（名称='dataGrid1'）；目标属性是“DataContext”（类型“对象”）

这是我的工作示例。如果你运行它，你会看到自动生成的列：

```
<DataGrid AutoGenerateColumns="True"
    ItemsSource="{Binding Path=DataView}" 
    DataContext="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=WpfApplication1:MainWindow, AncestorLevel=1}, Path=TransferSchedulesView}" /> 
```

* * *

```
namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public TransferSchedulesView TransferSchedulesView { get; set; }

        public MainWindow()
        {
            InitializeComponent();
            TransferSchedulesView = new TransferSchedulesView(){DataView = CreateTable()};
        }

        private static DataTable CreateTable()
        {
            var dataTable = new DataTable();
            dataTable.Columns.Add("aaa");
            dataTable.Columns.Add("bbb");
            dataTable.Columns.Add("ccc");
            dataTable.Rows.Add("sdaasdasd", "dsdsadasdasdsd", "sdasdadsadsadsd");
            dataTable.Rows.Add("sdaasdasd", "dsdsadasdasdsd", "sdasdadsadsadsd");
            dataTable.Rows.Add("sdaasdasd", "dsdsadasdasdsd", "sdasdadsadsadsd");
            return dataTable;
        }
    }

    public class TransferSchedulesView
    {
        public DataTable DataView { get; set; } 
    }
} 
```

# javascript - 街景中未显示链接

> ID：11214874
> 
> 赞同：0
> 
> 时间：2012-06-26T19:46:45.700
> 
> 标签：javascript, ajax, google-maps-api-3, google-street-view

我正在使用谷歌街景中的自定义全景图构建一个虚拟旅游应用程序。链接行为在两个方面很奇怪：

1.  通过 localhost 访问和刷新会导致启动全景图上不显示任何链接。更改对 IP 地址的 Web 访问可解决此问题
2.  当通过 IP 地址访问时，第一个链接事件执行，我移动到第二个全景图。即使`links`全景对象内的数组显示了预期的数据，第二个全景图中也不会加载任何链接。

[谷歌在他们的网站上有](https://developers.google.com/maps/documentation/javascript/streetview#CustomPanoramaMethod)一些例子，我一直以此为起点。

一个问题是，我遇到的每个示例都需要手动写出每个全景图的所有值。由于这次旅行将有大约 100 个站点，因此这种方法是不可用的。所以我调整了示例`getCustomPanorama`和`createCustomLinks`函数来处理数组。

我没有依赖 Google 示例中的 switch 方法，而是将数据库返回作为 JSON 对象并对其进行迭代以获取所需的值。

```
function getCustomPanorama(pano, zoom, tileX, tileY){
  var obj;
  for (var i=0; i<tourData.length; i++){
    if (tourData[i].name == pano){      
      obj = {
        location: { //create StreetViewLocation object
          pano: tourData[i].name,
          description: tourData[i].name,
          latLng: google.maps.LatLng(tourData[i].lat, tourData[i].lon)
        },
         links: [], //create StreetViewLink object 
        tiles: { //create a StreetViewTileData object with properties
          tileSize: new google.maps.Size(tourData[i].width, tourData[i].height),
          worldSize: new google.maps.Size(tourData[i].width, tourData[i].height),
          centerHeading: tourData[i].heading,
          zoom: -1,
          getTileUrl: getCustomPanoramaTileUrl
        }
      } //end object creation

      break;
    }
  }
  return obj;
} 
```

与创建自定义链接相同。

```
function createCustomLinks(){
  var panoLinks = panotour.getLinks();
  var panoID = panotour.getPano();

  var links = $.ajax({
    type: "GET",
    url: "includes/phpscripts.php?action=getLinks&name="+panoID,
    dataType: "json",
    success: function(data){
      if (data){
        console.log("Links grabbed: "+data.length);

        //loop over response, add link to array
        for(var i=0; i<data.length; i++){
          panoLinks.push({'heading': data[i].heading, 'description': data[i].description, 'pano': data[i].description});
        }

        console.log("Panorama Lins: "+panoLinks)

      } else {
        console.log("Can't get link info");
      }
    }   
  });
} 
```

解决这些问题的任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T22:11:50.573

在调试任何东西之前，您可能应该切换到 Chrome（如果您还没有使用它）。我正在查看[Google 示例](https://google-developers.appspot.com/maps/documentation/javascript/examples/streetview-custom-tiles)，它在那里运行良好，但在 Firefox 13 中，当我重新加载页面时，有时会丢失“Google Sydney”链接。如果有人试图弄清楚为什么链接没有出现，那就不太可靠了。

至于您的问题：我要尝试的第一件事（由于上述不确定性行为）是通过设置使`.ajax()`内部调用`createCustomLinks`同步，`async: false`并查看这是否会改变任何内容。您可能会在评估链接以显示在地图上之后填充链接。

我想您需要提供一个可行的示例才能获得更多帮助。

# cakephp - CakePHP 2.0 在管理员中显示空白，前面工作正常

> ID：11214875
> 
> 赞同：1
> 
> 时间：2012-06-26T19:46:51.250
> 
> 标签：cakephp, routing, routes, admin

我使用 CakePHP 2.0 在 localhost 上创建了网站，并且工作正常。但是上传到服务器后，前端工作正常，但登录后后端重定向并显示空白。

*   调试集 2
*   缓存已清理

有什么问题？我的 Routes.php 看起来：

```
Router::connect("/" . URL_ADMIN , array('admin' => true, 'controller' => 'users', 'action' => 'login'));
Router::connect("/admin/:controller", array('action' => 'index', 'prefix' => 'admin', 'admin' => true));
Router::connect("/admin/:controller/:action/*", array('prefix' => 'admin', 'admin' => true)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T04:44:34.883

在声明所有常量的 bootstap.php 中包含该文件。如果您正在处理 Admin 部分，那么这是使用“ [Auth Component](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html) ”的最佳方法。As you used`'admin' => true`选项主要用于与 Admin 相关的页面，而 Auth 组件已集成。请询问它是否不适合您。

# design-patterns - 我可以从扩展包向 Salesforce 基础包页面添加元素吗？

> ID：11214880
> 
> 赞同：2
> 
> 时间：2012-06-26T19:47:23.180
> 
> 标签：design-patterns, package, salesforce

我们正在开发一个包含扩展的 Salesforce 包。这个想法是在基本包中提供基本功能，并提供单独的额外功能作为包扩展（具有自己的单独许可证和价格）。

但是，当我们安装扩展时，我们需要在基本包中注入一些额外的元素。这种需求的例子是：

*   在 apex:pageBlockButtons 元素上添加一个附加按钮。或者，一般来说，在基本包的 visualforce 页面中添加额外的 html 片段（我们可以称它们为小部件）。
*   在基础包的控制器上执行附加逻辑。

那么问题来了：Salesforce 上是否有一个标准功能可以让我们实现这些结果？如果没有，是否有我可以应用的设计模式来实现这样的目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:51:29.073

您可能会看看使用最近引入的 [apex 反射][1]（阅读：新功能，当心错误！）。

对于附加逻辑，在基本包中定义一个接口。扩展包添加了一个新的实现并在自定义设置（基础包的一部分）中“注册”了类名。然后让您的代码检查任何条目的自定义设置，如果有，则运行处理附加逻辑所需的任何方法。

对于 visualforce 页面，您可以执行类似的操作，但扩展包接口类将使用动态 visualforce 来添加按钮。

更简单的是，只需在扩展包中创建一些工件，可能是静态资源，但也可以是基础包可检查的任何东西。如果基础包查找工件并找到它，则打开增强功能。希望能让脑汁流淌。

# objective-c - 为什么我需要 __bridge，它有什么后果？

> ID：11214881
> 
> 赞同：0
> 
> 时间：2012-06-26T19:47:23.590
> 
> 标签：objective-c, automatic-ref-counting

> **可能重复：**
> [Objective-C中的正常铸造与桥接铸造](https://stackoverflow.com/questions/10834522/normal-casting-vs-bridge-casting-in-objective-c)

使用 ARC，Xcode 轻轻地引导我将我的字符串转换成`CFString`这样

```
MIDISourceCreate(theMidiClient, (__bridge CFStringRef)outName,
                 &midiOut); 
```

1.  这座桥是什么意思？
2.  做这个演员的内存管理有什么后果吗？当演员表超出范围时，它会被清理吗？

# ruby-on-rails-3 - Ruby on Rails - Carmen gem：未定义的方法 `country_select' 用于#

> ID：11214882
> 
> 赞同：2
> 
> 时间：2012-06-26T19:47:30.660
> 
> 标签：ruby-on-rails-3, carmen

我用这个把头发拉出来。我尝试安装 Carmen gem，然后将其卸载并尝试将其作为插件，然后卸载插件并重新安装 gem，重新启动服务器，但似乎没有任何帮助。

不管我做什么，代码似乎都找不到“country_select”方法。它总是在这条线上失败：

```
<%= f.country_select :country_code, {priority: %w(US CA)}, prompt: 'Please select a country' %> 
```

我正在使用 Ruby 1.9.3
carmen v1.0.0.beta2
carmen-rails v1.0.0.beta3

我*真的*需要让这个工作，但不知道如何进一步推进。请帮忙...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-02-04T10:47:51.340

我在 simple_form 中遇到了这个问题，事实证明它取决于 gem country_select，如果您在使用 simple_form 时遇到此错误，请安装 gem：

```
gem 'country_select' 
```

然后重启你的服务器：

```
rails s 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T03:28:51.367

我遇到了同样的情况。我通过将 :country_code 更改为我的模型中包含国家/地区值的字段的名称来解决它。例如，在我的模型中，我使用了国家，因此我将 :country_code 更改为 :country 并且效果很好。

# c# - C# TimeSpan 不显示天数

> ID：11214885
> 
> 赞同：1
> 
> 时间：2012-06-26T19:47:36.710
> 
> 标签：c#, formatting, timespan

我正在编写一个使用该`TimeSpan`对象的应用程序。具体来说，我正在使用构造函数`TimeSpan(int32, int32, int32, int32)`。但是，当我将结果输出到 Excel 文件时，TimeSpan 会以`hh:mm:ss`我期望的格式显示`dd:hh:mm:ss`。有了我现在拥有的数据，所有这些日子都是`0`- 但后来我期待`00:hh:mm:ss`而不是更短的格式。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:51:37.350

您需要将 Excel 中单元格的格式设置为您想要的格式。它可能会自动设置格式，因为所有天的值都是 0

# arrays - 使用 ListToArray 时更改数组起始索引

> ID：11214891
> 
> 赞同：0
> 
> 时间：2012-06-26T19:47:52.290
> 
> 标签：arrays, list, coldfusion

当我将列表转换为数组时，从索引 1 开始插入值。索引 0 为空。

为什么会发生这种情况，更重要的是，有没有办法改变它，使其从 0 索引开始？

例子：

```
<cfset myList = "A,B,C,D" />
<cfset myArray = ListToArray(myList) />
<cfdump var="#myArray#" /> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T19:55:50.857

原因 ColdFusion 阵列从一个开始。您实际上是在参考 0 位置并且没有收到错误吗？

[为什么 ColdFusion 的设计者决定从 1 而不是 0 索引数组？](https://stackoverflow.com/questions/420510/why-did-the-designers-of-coldfusion-decide-to-index-arrays-from-1-rather-than-0)

# iphone - 使用 drawRect 为 UIButton 的标签添加下划线

> ID：11214893
> 
> 赞同：1
> 
> 时间：2012-06-26T19:48:08.883
> 
> 标签：iphone, objective-c, ios, uibutton, drawrect

我正在尝试在 UIButton 中为标签的文本添加下划线。但这对我不起作用。我在`viewDidLoad`方法中的代码：

```
 CGFloat x = 13.0f;
CGFloat y = 15.0f;
if (self.numberOfFirstButton == 0) {
    self.numberOfFirstButton = 1;
}
for (NSUInteger i = 1; i <= 5; i++) {

    for (NSUInteger j = 0; j < 10; j++) {
        UIHouseButtons *button = [[UIHouseButtons alloc] init];
        [button setFrame:CGRectMake(x+(47*j), y, 30.0f, 30.0f)];
        [button setTitle:[NSString stringWithFormat:@"%i", self.numberOfFirstButton] forState:UIControlStateNormal];
        [button drawRect:CGRectMake(x+(47*j), y, 30.0f, 30.0f)];
        [self.view addSubview:button];
        self.numberOfFirstButton++;
    }
    y += 48.0f;
} 
```

我的`drawRect`方法

```
- (void)drawRect:(CGRect)rect
{
CGRect textRect = self.titleLabel.frame;

// need to put the line at top of descenders (negative value)
CGFloat descender = self.titleLabel.font.descender;

CGContextRef contextRef = UIGraphicsGetCurrentContext();

// set to same colour as text
CGContextSetStrokeColorWithColor(contextRef, self.titleLabel.textColor.CGColor);

CGContextMoveToPoint(contextRef, textRect.origin.x, textRect.origin.y + textRect.size.height + descender);

CGContextAddLineToPoint(contextRef, textRect.origin.x + textRect.size.width, textRect.origin.y + textRect.size.height + descender);

CGContextClosePath(contextRef);

CGContextDrawPath(contextRef, kCGPathStroke);
[super drawRect:rect];
} 
```

我的所有按钮都在视图中，但标签的文本没有下划线。我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:53:48.317

我建议使用 NSAttributedString 标签。有很多开源项目可以让这变得简单。两个主要项目是：

[Nimbus 的 NIAttributedLabel](http://latest.docs.nimbuskit.info/NimbusAttributedLabel.html)
[TTTAttributedLabel](https://github.com/mattt/TTTAttributedLabel)

雨云示例：

`myLabel.underlineStyle = kCTUnderlineStyleSingle;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T19:57:33.510

您可以从 UILabel 子类化并覆盖 drawRect 方法：

```
 - (void)drawRect:(CGRect)rect {

    CGContextRef ctx = UIGraphicsGetCurrentContext();
   CGContextSetRGBStrokeColor(ctx, 207.0f/255.0f, 91.0f/255.0f, 44.0f/255.0f, 1.0f); // RGBA
    CGContextSetLineWidth(ctx, 1.0f);

  CGContextMoveToPoint(ctx, 0, self.bounds.size.height - 1);
   CGContextAddLineToPoint(ctx, self.bounds.size.width, self.bounds.size.height - 1);

  CGContextStrokePath(ctx);

   [super drawRect:rect]; 
```

}

然后在该标签上放置一个自定义按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T14:33:50.733

我制作了一个简单的 UIButton 子类 BVUnderlineButton（基于网络上其他地方的其他代码），您可以直接将其放入您的项目中。

它在 Github 上，地址为[https://github.com/benvium/BVUnderlineButton（MIT](https://github.com/benvium/BVUnderlineButton)许可证）

# php - “抛出新异常”是否需要退出（）？

> ID：11214895
> 
> 赞同：18
> 
> 时间：2012-06-26T19:48:18.850
> 
> 标签：php, exception

我试图弄清楚位于`throw new Exception`PHP 之后的代码是否仍在执行 - 我已经尝试过了，它似乎没有输出任何东西，但想确定。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-06-26T19:51:50.313

不，抛出异常后的代码不会被执行。

在这个代码示例中，我用数字标记了将要执行的行（代码流）：

```
try {
    throw new Exception("caught for demonstration");                    // 1
    // code below an exception inside a try block is never executed
    echo "you won't read this." . PHP_EOL;
} catch (Exception $e) {
    // you may want to react on the Exception here
    echo "exception caught: " . $e->getMessage() . PHP_EOL;             // 2
}    
// execution flow continues here, because Exception above has been caught
echo "yay, lets continue!" . PHP_EOL;                                   // 3
throw new Exception("uncaught for demonstration");                      // 4, end

// execution flow never reaches this point because of the Exception thrown above
// results in "Fatal Error: uncaught Exception ..."
echo "you won't see me, too" . PHP_EOL; 
```

请参阅[PHP 手册中的异常](http://php.net/exceptions)：

> 当抛出异常时，语句后面的代码将不会被执行，PHP 将尝试找到第一个匹配的 catch 块。如果未捕获到异常，则会发出 PHP 致命错误并显示“未捕获异常 ...”消息，除非已使用`set_exception_handler()`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-26T19:51:37.520

不，`throw`语句后面的代码不会被执行。很像`return`。

# facebook - 获取每个 Facebook 选项卡的外部推荐

> ID：11214897
> 
> 赞同：1
> 
> 时间：2012-06-26T19:48:33.370
> 
> 标签：facebook, facebook-insights

使用 facebook 洞察力 - 是否可以通过选项卡而不是页面获得外部推荐？洞察力的 fql 参考 (http://developers.facebook.com/docs/reference/fql/insights/) 提到画布 (application_canvas_views_external_referrals) 是可能的，但 Tab 是不可能的，但我认为这是一个理想的功能。

任何意见，将不胜感激。令人惊讶的是，我找不到有关此问题的任何信息。

# c# - 如何使用 LINQ 将集合划分为有效和无效项？

> ID：11214900
> 
> 赞同：0
> 
> 时间：2012-06-26T19:48:38.580
> 
> 标签：c#, linq-to-objects

有没有办法编写一个 LINQ 表达式来获得以下代码的相同结果？

```
 var validations = new Func<conversion, bool>[] { 
             c => c.affiliate.affiliate_id > 0,
             c => c.campaign_id > 0
        }; 

        var invalidConversions = from c in extractedConversions
                                 where validations.Any(valid => !valid(c))
                                 select c;

        var validConversions = from c in extractedConversions
                               where validations.All(valid => valid(c))
                               select c; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T19:50:35.247

那么你可以使用类似的东西：

```
var partitioned = extracted.ToLookup(c => validations.All(valid => valid(c))); 
```

然后：

```
// Valid conversions
foreach (var valid in partitioned[true])
{
}

// Invalid conversions
foreach (var invalid in partitioned[false])
{
} 
```

您也可以使用`GroupBy`，但`ToLookup`会立即实现结果并为您提供访问它们的便捷方式，我怀疑这就是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:52:48.563

如果您的`conversion`课程被覆盖`Equals`并且`GetHashCode`您可以执行以下操作：

```
var validations = new Func<conversion, bool>[] {
   c => c.affiliate.affiliate_id > 0,
   c => c.campaign_id > 0
};

var invalidConversions =
    from c in extractedConversions
    where validations.All(valid => !valid(c))
    select c;

var validConversions =
    extractedConversions.Except(invalidConversions); 
```

# iphone - Iphone 变量未标记

> ID：11214906
> 
> 赞同：1
> 
> 时间：2012-06-26T19:49:12.230
> 
> 标签：iphone, variables

我正在尝试声明一些整数值（用于控制我制作的复选框）。我在 .h 中声明它们

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController<UITextFieldDelegate> {

    int check1Yes; //There are more but this one causes the same error so I show one for example

} 
```

然后在 .m 中，我在 viewDidLoad 中将它们全部设置为“1”

```
- (void)viewDidLoad {

check1Yes = 1;

[super viewDidLoad];
} 
```

最后，我在一个 C 方法中调用它，检查它是否等于 1。这是我得到错误的地方：

```
void fillBox(int *checkbox)
{

    if(check1Yes == 1) //ERROR on this line
        checkbox[0] = 1;
    else 
        checkbox[0] = 0;
} 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:54:50.967

C*函数*无权访问您的类的实例变量；只有Objective C*方法*可以。

C 函数可以访问在同一个编译单元中声明的全局变量和静态变量，但是如果你想让它们访问实例变量，你需要从你的 Objective C 方法中显式地传递它们：

```
-(void)doSomethig {
    fillBox(&myCheckbox, check1Yes);
}

void fillBox(int *checkbox, int check1Yes) {
    if(check1Yes == 1)
        checkbox[0] = 1;
    else 
        checkbox[0] = 0;
} 
```

# python - 在 openpyxl 中关闭文件

> ID：11214908
> 
> 赞同：10
> 
> 时间：2012-06-26T19:49:23.077
> 
> 标签：python, file, openpyxl

正如阅读文档所预期的那样，这些过程都不是：

```
worksheet.close()
workbook.close() 
```

有没有办法在 openpyxl 中完成后关闭文件？还是程序退出时自动处理？我不想让电子表格留在内存中。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-26T20:59:32.987

好吧，你可以看看源代码，我目前使用的是 1.5.5

```
def load_workbook(filename, use_iterators=False):        
    if isinstance(filename, file):
        # fileobject must have been opened with 'rb' flag
        # it is required by zipfile
        if 'b' not in filename.mode:
            raise OpenModeError("File-object must be opened in binary mode")

    try:
        archive = ZipFile(filename, 'r', ZIP_DEFLATED)
    except (BadZipfile, RuntimeError, IOError, ValueError), e:
        raise InvalidFileException(unicode(e))
    wb = Workbook()

    if use_iterators:
        wb._set_optimized_read()

    try:
        _load_workbook(wb, archive, filename, use_iterators)
    except KeyError, e:
        raise InvalidFileException(unicode(e))
    finally:
        archive.close()
    return wb 
```

看起来是的，它确实关闭了存档，当我们加载工作簿时，当我们保存它时怎么样？

```
 def save(self, filename):
    """Write data into the archive."""
    archive = ZipFile(filename, 'w', ZIP_DEFLATED)
    self.write_data(archive)
    archive.close() 
```

当我们保存它时，它看起来也会关闭存档。

从根本上说，我们从一个之后关闭的文件中将一个 excel 工作簿读入内存，进行更新，如果我们不保存它，更改可能会丢失，如果我们保存它，则文件在写入后关闭。

> 有没有办法在 openpyxl 中完成后关闭文件？还是程序退出时自动处理？我不想让电子表格留在内存中。

您可以在读取或写入文件时使用`wb.save(filename = dest_filename)`as for保存您的更改`handled automatically`，然后是的，它在操作后关闭，但是让 openpyxl 自动保存您的更改，然后**没有任何**东西，然后当该对象被删除或垃圾收集时不会调用任何内容，`class Workbook(object):`再次`__del__`这是在撰写本文时`1.5.5`的当前版本`1.5.8`，我怀疑已经发生了很大变化。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-05-26T02:03:13.690

你可以试试这个 `wb.Close(True)`

# jquery - 可对长列表进行排序

> ID：11214911
> 
> 赞同：0
> 
> 时间：2012-06-26T19:49:31.360
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable

我必须在我的项目中实现[jquery 的可排序。](http://jqueryui.com/demos/sortable/)

我正在动态创建它。

但问题是列表中的项目数超过 100。因此，如果用户想要将第 100 个项目带到顶部，他必须从页面底部拖动第 100 个项目（必须在按住单击时滚动） ，太麻烦了。那么，我应该用什么方法来实现这种“可拖动”行为（不使用任何额外的插件）？

提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:52:15.707

您可以有两个并排的列表实例，并带有单独的滚动条。这样，用户可以将左侧滚动到源位置，将右侧滚动到目标位置，然后将项目从一侧拖动到另一侧。

# android - 如何在 Android FileSystem 中创建子文件夹

> ID：11214916
> 
> 赞同：2
> 
> 时间：2012-06-26T19:49:55.447
> 
> 标签：android, filesystems

我在 Android 文件系统中创建了一个文件。为此我编写了以下代码

```
 openFileOutput("one.html",Context.MODE_PRIVATE); 
```

使用我看到的代码，名为“one.html”的文件是在Android FileSystem中创建的。绝对如下。

```
 /data/data/packagename/files/one.html 
```

但现在我需要在文件目录中创建一个名为“html”的文件夹。我该如何创建？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T19:52:30.623

用于`getFilesDir()`获取`File`指向应用程序内部存储的对象（在您的情况下，`/data/data/packagename/files`. 从那里，使用标准 Java I/O：

```
File subdir=new File(getFilesDir(), "whatever");

subdir.mkdirs(); 
```

# ruby - 无法从一个非常简单的 JRuby 脚本构建 jar

> ID：11214921
> 
> 赞同：2
> 
> 时间：2012-06-26T19:50:13.870
> 
> 标签：ruby, jar, jruby

我在构建 jar 文件时遇到了问题。我在 OS X Lion 上使用 JRuby 1.6.5.1。

安装：

```
jruby --1.9 -S rawr install 
```

在 src 目录中，我创建了一个简单的 hello_jruby.rb ，其中包含：

```
puts "Hello JRuby!" 
```

build_configuration.rb 文件具有以下设置：

```
c.project_name = "hello_jruby"
c.executable_type = "console"
c.main_ruby_file = "hello_jruby" 
```

生成jar文件：

```
$ jruby --1.9 -S rake rawr:jar
mkdir -p package/classes/java
javac -target 1.6 -cp lib/java/jruby-complete.jar:src -sourcepath src -d package/classes/java src/org/monkeybars/rawr/Main.java
mkdir -p package/classes/ruby
Copying source file src/hello_jruby.rb to package/classes/ruby/hello_jruby.rb
cp src/hello_jruby.rb package/classes/ruby/hello_jruby.rb
mkdir -p package/classes/META-INF
mkdir -p package/jar
=== Creating jar file: package/jar/hello_jruby.jar
cp lib/java/jruby-complete.jar package/jar/lib/java/jruby-complete.jar 
```

jar 文件的执行都不会打印输出：

```
$ java -jar ./hello_jruby.jar 

$ java -cp .:./lib/java/jruby-complete.jar -jar ./hello_jruby.jar 
```

我对为什么这不起作用感到完全困惑。我在 Windows 上尝试过，但是 rawr 使用的 CLASSPATH 分隔符是冒号（:) 而不是分号（;) 所以 rawr:jar 不起作用。

我一定是遗漏了一些东西，或者不完全理解如何使用 rawr。

欢迎任何想法。谢谢你的时间！

编辑：其他尝试和结果

安装了最新的 JRuby（不使用 RVM）：

```
$ jruby --1.9 -v
jruby 1.6.7.2 (ruby-1.9.2-p312) (2012-05-01 26e08ba) (Java HotSpot(TM) 64-Bit Server VM 1.6.0_33) [darwin-x86_64-java] 
```

爪哇版：

```
$ java -version
java version "1.6.0_33"
Java(TM) SE Runtime Environment (build 1.6.0_33-b03-424-11M3720)
Java HotSpot(TM) 64-Bit Server VM (build 20.8-b03-424, mixed mode) 
```

安装了最新的rawr：

```
$ jruby --1.9 -S gem install rawr --source http://gems.neurogami.com
Fetching: rawr-1.6.3.gem (100%)
Successfully installed rawr-1.6.3
1 gem installed 
```

我注意到的一件事是 rawr 可执行文件位于 Ruby 1.9.2 目录中。这是正常的和预期的吗？

```
$ which rawr
/Users/david/.rvm/gems/ruby-1.9.2-p290/bin/rawr 
```

以下命令现在失败。我以前使用 RVM 安装过 JRuby。在安装最新的 JRuby 之前，我卸载了 RVM JRuby。

```
$ jruby --1.9 -S rake -T
(in /Users/david/Dropbox/SourceCode/Ruby/RubySandbox/rawr_test)
rake aborted!
no such file to load -- ftools

(See full trace by running task with --trace) 
```

但是，通过 ruby​​ 1.9.2 运行 rake 可以：

```
$ rake -T 
```

使用以下代码生成 jar：

```
$ rake rawr:jar 
```

生成 jar 时仍然没有输出或错误。

```
$ java -jar ./hello_jruby.jar 
$ 
```

使用 JRuby 运行脚本成功：

```
$ jruby --1.9 ./hello_jruby.rb 
Hello JRuby! 
```

生成的jar有以下文件：

```
$ ls -R
META-INF        java            ruby
hello_jruby.rb      org         run_configuration

./META-INF:
MANIFEST.MF

./java:

./org:
monkeybars

./org/monkeybars:
rawr

./org/monkeybars/rawr:
Main.class

./ruby: 
```

TEST01：使用系统 JRuby 并避免使用 RVM Ruby 1.9.2。

```
$ rvm use ruby-1.9.2

$ gem uninstall rawr

$ rvm system

$ jruby --1.9 -S gem install rawr --source http://gems.neurogami.com

$ which rawr
/Library/Frameworks/JRuby.framework/Versions/Current/bin/rawr

$ jruby --1.9 -S rawr install

$ jruby --1.9 -S rake rawr:jar 
```

rawr 可执行文件现在位于不同的位置。但是，仍然没有从 jar 中得到任何输出。我什至尝试了所有没有 --1.9 的 jruby 命令，没有任何区别。我也将在 Windows 上再试一次。

下一个测试是提取最新的 rawr 源并运行上述说明。

再次感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T19:53:42.463

首先：不，gem 可能不应该出现在您的 1.9.2 安装下。RVM 一定认为您仍在使用 1.9.2。由于您的 JRuby 在 rvm 之外，请键入`rvm system`忽略所有 rvm 安装的 Ruby。您可能想先从 1.9.2 卸载 rawr。

（顺便说一句：我刚刚在我的 1.9.3 Ruby 下安装了 rawr，它仍然可以正常工作。很奇怪。）

跟进我的评论：我已经进行了一些挖掘，看起来在 neurogami.com 上托管的 gem 仍然落后于 git HEAD。我在使用 ftools 时遇到了同样的错误。我为使其正常工作（在 Ubuntu 和 Windows 上）所做的工作是：

1.  `gem install bones`
2.  `gem install rspec -v 1.3.0`
3.  `git clone https://github.com/rawr/rawr.git`
4.  `cd rawr`
5.  `rake gem:package`
6.  `gem install pkg/rawr-1.6.3.gem`
7.  `cd ..`
8.  `mkdir rawr-test-TEMP`
9.  `cd rawr-test-TEMP`
10.  `rawr install`
11.  创建 hello_jruby.rb 并向 build_configuration.rb 添加适当的配置选项（我还必须添加`c.target_jvm_version = 1.7`，因为 rawr 没有选择我的 Java 7 安装）
12.  edit line 667 of lib/zip/zip.rb inside your rawr gem's directory -- add a closing parenthesis to the end. This is a bug in upstream rawr.
13.  `rake rawr:jar`

# excel - 如果与 A 列中任何单元格中的文本字符串匹配，则删除 B 列所有单元格中的所有文本字符串

> ID：11214922
> 
> 赞同：0
> 
> 时间：2012-06-26T19:50:15.713
> 
> 标签：excel, vba

我在 Excel 中有两列，所有单元格都包含文本字符串。A 列包含 8000 个单元格，B 列包含 3000 个单元格。我需要检查 B 列中的每个单元格，看看它是否包含单元格 A1 中的字符串。如果是这样，我需要删除该文本，保留字符串的其余部分。然后我需要对单元格 A2、A3 等执行相同的操作，一直到单元格 A8000。这将永远需要手动完成，我知道这对于 VBA 程序员来说应该很容易，但我是一个完全的菜鸟，并且在从哪里开始挣扎。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:10:40.673

这是使用 BULK 替换的一种非常简单的方法

```
Sub Sample()
    Dim ws As Worksheet
    Dim lRow As Long

    Set ws = Sheets("Sheet1")

    With ws
        lRow = .Range("A" & .Rows.Count).End(xlUp).Row
        For i = 1 To lRow
            .Columns(2).Replace What:=.Range("A" & i).Value, _
                                Replacement:="", _
                                LookAt:=xlPart, _
                                SearchOrder:=xlByRows, _
                                MatchCase:=False, _
                                SearchFormat:=False, _
                                ReplaceFormat:=False
        Next
    End With
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T20:11:23.580

有一种比 Wolf5370 建议的更快的方法。您可以遍历 A 列中的所有单元格，并对它们在 B 列中找到的值进行替换。

这样的事情应该让你开始。

```
Option Explicit

Sub Replace()

Dim wks as Worksheet
Set wks = Worksheet("Shee1") 'change to suit your needs

With wks

   Dim rngLook as Range, cel as Range
   Set rngLook = Intersect(.UsedRange,.UsedRange.Offset(1),.COlumns(1))

   For each cel in RngLook
      .Columns(2).Replace cel.Value, "", xlPart
   Next

End With

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T19:57:18.983

最初我认为排序（每列）和遍历列（主/事务样式）。但是，然后我注意到您在谈论子字符串，因此排序顺序无济于事。做到这一点的唯一方法是将一个循环嵌套在另一个循环中，并检查所有 8000 个单元 3000 次。

```
dim c1 as integer, c2 as integer

for c2=1 to 3000

for c1=1 to 8000

cells(c1,1).value = Replace(cells(c1,1).value, cells(c2,2).value, "")

next c2

next c1 
```

请注意，这是在我的头顶上手工制作的（因此预计会出现拼写错误等）。基本上它会循环遍历我提到的所有这些时间，每次它替换字符串时-您可以通过将单元格（c1,1）复制到执行替换的变量并在写回之前查看它是否更改来做到这一点-在a上测试它几个周期，看看哪个更快。

编辑：修正了几个错别字（实际上错过了第二个学期的“价值”一词）

PS：如果单元格令人困惑，您可以改用 Range -替换`Cells(c1,1)`为`Range("A" &c1)`和`Cells(c2,2)``Range("B"&c2)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T20:10:49.570

不需要VBA。只需在 C 列中填写此公式：

`=VLOOKUP($B1,A:A,1,0)`

假设您的数据从 B1 开始，请将此公式填入 B3000。

现在，如果在 A 列中找到 B 列中的值，您将在 C 列中看到匹配值，否则您将看到`#N/A`.

最后，按 C 列中的值对 B 列和 C 列进行排序，然后删除您不想要的那些。

这应该需要 30 秒。

我敢肯定会有人来发布与上述等效的VBA。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T20:10:01.937

不确定您是否仅限于 VBA 或者是否可以接受添加列：如下所示：Excel 有一个内置的工作表功能，称为替代品，可以满足您的需要（取决于 Excel 版本）

![在此处输入图像描述](../Images/ce489ca67f54f35d9e72f4f0639e0604.png)

请注意，在 D3 中，当在 B3 中它的 THIS 和 IS 被丢弃时，TH 是如何显示的。

编辑啊，但现在我看到你需要“循环”这个。我将不得不重新考虑我的回应。

# sql - 使用 SQL 的日期和时间跨度

> ID：11214927
> 
> 赞同：1
> 
> 时间：2012-06-26T19:50:24.227
> 
> 标签：sql, tsql

给出下表和数据。

```
 create table prices
(productKey int
,PriceType char(10)
,BeginDate date
,EndDate date
,price decimal(18,2))

insert into prices(productKey, PriceType,BeginDate,EndDate, price)
values
(1,'LIST','1-1-2010','1-15-2010',10),
(1,'LIST','1-16-2010','10-15-2010',20),
(1,'DISCOUNT','1-10-2010','1-15-2010',-5),
(2,'LIST','2-1-2010','10-15-2010',30),
(2,'LIST','10-16-2010','1-1-9999',35),
(2,'DISCOUNT','2-10-2010','10-25-2010',-10),
(2,'LIST','1-1-2010','1-15-2010',10),
(3,'DISCOUNT','1-12-2010','1-1-9999',-5),
(3,'LIST','1-16-2010','1-1-9999',10) 
```

我需要将记录插入到计算每个时间段的实际价格（列表折扣）的同一个表中。

例如，对于产品 1，我应该有以下“实际”记录

```
Begin     End      Price
1-1-2010  1-9-2010 10
1-10-2010  1-15-2010 5
1-16-2010  10-15-2010 20 
```

我有点想出在标价范围内开始打折的任何事情，但我对其他任何事情都不知所措。

谢谢您的帮助

**编辑**

每个 ProductKey 可以有多个折扣，但折扣期不会重叠。所以你可以有一个 2010 年的，另一个 2012 年的，但不能有 2 个 2010 年的。

另外，如果有人能想出一个更好的标题，请这样做。在这一点上，我可怜的大脑完全受到挑战。

**编辑2**

它是 SQL 服务器 2008R2。我喜欢一个漂亮的基于集合的答案（或者让我朝那个方向开始的人），但也会对有效的光标解决方案感到满意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T20:16:57.843

聪明的谜题。

您需要重建所有时间跨度。为此，我从价格范围中取出所有日期并重建可能的日期范围。

```
with alldates as (select d.*, ROW_NUMBER() over (partition by productkey order by thedate) as seqnum
                  from ((select productkey, BeginDate as thedate from prices)
                        union all
                        (select productkey, enddate as thedate from prices)
                       ) d
                 ),
     datepair as (select d1.productkey, d1.thedate as BeginDate, d2.thedate as EndDate
                  from alldates d1 left outer join 
                       alldates d2
                       on d1.seqnum = d2.seqnum - 1 and d1.productKey = d2.productKey
                 )
select dp.productkey, dp.BeginDate, dp.EndDate, SUM(p.price)
from datepair dp join
     prices p
     on dp.productkey = p.productkey and
         dp.BeginDate >= p.BeginDate and
        dp.EndDate <= p.EndDate
group by dp.productkey, dp.BeginDate, dp.EndDate
order by 1, 2, 3 
```

我已经考虑了更多。上面的基本思路是正确的。基本思想是将时间维度分解为区间，其中列表和折扣在整个区间内是恒定的。问题是如何创建这些间隔，它们在 datepairs 别名中。

这些间隔只有几个规则：

*   日期对间隔可以在任何时间段开始时开始。
*   日期对间隔可以在任何时间段结束后的一天开始。
*   日期对间隔可以在任何时间段结束时结束
*   日期对间隔可以在任何时间段开始前一天结束

一旦我们有了间隔，就可以简单地加入该期间的适当标价和折扣。以下查询使用此逻辑：

```
with begindates as (select distinct productKey, thedate
                    from ((select productkey, BeginDate as thedate from prices)
                          union all
                          (select productkey, dateadd(d, 1, enddate) as thedate from prices)
                         ) d
                     ),
     enddates as (select distinct productKey, thedate
                  from ((select productkey, DATEADD(d, -1, begindate) as thedate from prices)
                        union all
                        (select productkey, enddate as thedate from prices)
                       ) d
                 ),
     datepair as (select *
                  from (select d1.productkey, d1.thedate as BeginDate,
                               MIN(d2.thedate) as EndDate
                        from begindates d1 left outer join 
                             enddates d2
                             on d1.productKey = d2.productKey and d1.thedate < d2.thedate
                        group by d1.productkey, d1.thedate
                       ) t
                  where BeginDate <> EndDate
                 )
select dp.productkey, dp.BeginDate, dp.EndDate, SUM(p.price)
from datepair dp join
     prices p
     on dp.productkey = p.productkey and
         dp.BeginDate >= p.BeginDate and
        dp.EndDate <= p.EndDate
group by dp.productkey, dp.BeginDate, dp.EndDate
order by 1, 2, 3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T21:02:01.803

我相信这应该给你你正在寻找的东西。关键是计算单个产品的所有唯一日期范围而不重叠。

```
-- Get all end dates
SELECT ROW_NUMBER() OVER (PARTITION BY ProductKey ORDER BY EndDate) RowNum, ProductKey, EndDate 
INTO #EndDates 
FROM (SELECT ProductKey, EndDate
    FROM prices
    UNION
    SELECT  ProductKey, DATEADD(d, -1, BeginDate) AS EndDate
    FROM prices) endDates
ORDER BY EndDate

-- Get all unique date ranges with no overlap
SELECT a.ProductKey, DATEADD(d, 1, a.EndDate) BeginDate, b.EndDate
INTO #DateRange
FROM #EndDates a
    INNER JOIN #EndDates b
        ON a.RowNum = b.RowNum - 1
        AND a.ProductKey = b.ProductKey
ORDER BY productkey, enddate

-- Get actual price
SELECT d.ProductKey, d.BeginDate, d.EndDate, SUM(Price) ActualPrice 
FROM prices p
    INNER JOIN #DateRange d
        ON p.ProductKey = d.ProductKey
        AND p.BeginDate <= d.EndDate
        AND p.EndDate >= d.BeginDate
GROUP BY d.ProductKey, d.BeginDate, d.EndDate
ORDER BY d.ProductKey, d.BeginDate, d.EndDate

-- Clean up
DROP TABLE #EndDates
DROP TABLE #DateRange 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T21:33:28.597

为了让这更有趣，我添加了另一个与之前的部分价格相同的部分，以确保我将它们分开：

```
INSERT INTO prices(productKey, PriceType,BeginDate,EndDate, price)
VALUES (1, 'DISCOUNT', '5-2-2010', '5-8-2010', -15) 
```

我还有一个名为的表`tblDates`，由以下内容填充：

```
INSERT dbo.tblDates (date1)
SELECT TOP(65536) ROW_NUMBER()OVER(ORDER BY v1.number)-1
FROM master.dbo.spt_values v1 CROSS APPLY master.dbo.spt_values v2 WHERE v1.type='p' and v2.type='p'
GO 
```

我在这里给出的脚本不需要那个。但是拥有它不会影响速度，也不会真正占用那么多空间。这是我的答案：

```
DECLARE @InitialBeginDate DATE
    , @FinalEndDate DATE;

SELECT
    @InitialBeginDate = MIN(BeginDate)
    , @FinalEndDate = MAX(EndDate)
FROM prices
WHERE productKey = @ProductKey

CREATE TABLE #Dates
(
    DateValue DATE NOT NULL
)

INSERT #Dates (DateValue)
SELECT
    DATEADD(DAY, V.number, @InitialBeginDate)
FROM master..spt_values V
WHERE V.[type] = 'P'
    AND V.number BETWEEN 0 AND DATEDIFF(DAY, @InitialBeginDate, @FinalEndDate)

;WITH MergedDays AS
(
    SELECT
        ListedDates.DateValue
        , SUM(P.price) PriceOnDate
        , DATEDIFF(DAY, @InitialBeginDate, ListedDates.DateValue) - DENSE_RANK() OVER(PARTITION BY SUM(P.price) ORDER BY ListedDates.DateValue, SUM(P.price)) DateGroup
    FROM #Dates ListedDates
    INNER JOIN prices P
        ON P.BeginDate <= ListedDates.DateValue
        AND P.EndDate >= ListedDates.DateValue
        AND P.productKey = @ProductKey
    GROUP BY
        ListedDates.DateValue
)
SELECT
    MIN(DateValue) AS SegmentBeginDate
    , MAX(DateValue) AS SegmentEndDate
    , MAX(PriceOnDate) AS SegmentPrice -- This is just to collapse it, it'll be the same for all records.
FROM MergedDays
GROUP BY DateGroup
ORDER BY SegmentBeginDate

DROP TABLE #Dates 
```

There are a couple other answers now, so this is just another way of doing things; there are many.

# c - malloc + fgets 动态分配

> ID：11214933
> 
> 赞同：0
> 
> 时间：2012-06-26T19:51:14.417
> 
> 标签：c, malloc, fgets

这是我的代码：

```
int main(int argc, char *argv[]){
    FILE *fp;
    char *tmp, *tmp2, *user, *pass, *line;
    printf("Inserire utente: "); scanf("%ms", &user); /* scanf %ms alloca dinamicamente la memoria */
    printf("Inserire password: "); scanf("%ms", &pass);
    line = malloc((strlen(user)+strlen(pass)) * sizeof(char)); /* DUBBIOOOOOOOOOO */
    fp = fopen("/home/pol/auth.txt", "r");
    if(fp == NULL){
        printf("Errore apertura file\n");
        return EXIT_FAILURE;
    }
    while(!feof(fp)){
        fgets(line, /* E QUI?? */ , fp);
        tmp = strtok(line, " ");
        tmp2 = strtok(NULL, "\n"); /* con fgets ultimo carattere è \n (se pwd=12 => 12\n) quindi devo tagliare prima di \n */
        if((strcmp(tmp,user) == 0) && (strcmp(tmp2,pass) == 0)){
            printf("USER: %s - PASS: %s\n", tmp, tmp2);
            free(user);
            free(pass);
            return EXIT_SUCCESS;
        }
        else{
            printf("Utente o password errati o non presenti nel DB\n");
            free(user);
            free(pass);
            return EXIT_FAILURE;
        }
    }
    return EXIT_SUCCESS;
} 
```

我想知道是否：

1.  写入`fgets`值是否正确`sizeof(line)`。我怀疑它`line`包含一个指针，所以它总是 4 或 8 个字节......

2.  `line`分配对了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T20:29:00.967

1.  不， sizeof(line) 将返回指针的大小。你真正想做的只是

    ```
    size_t size_required = strlen(user) + strlen(pass) + 1; /* Don't forget about \0! */ 
    ```

    然后只需使用该大小作为线的大小。（顺便说一句：您的代码没有自由行。）

    **编辑：**实际上，由于您最终想要读取 strtok 搜索的用户 + 密码 + 2 个标记分隔符，因此您想要添加额外的 3 个字符：1 用于终止 \0，1 用于第一个分隔符“”，1 用于下一个分隔符“ \n'。所以应该是：

    ```
    size_t size_required = strlen(user) + strlen(pass) + 3; /* Don't forget about \0! */ 
    ```

2.  您应该记住，动态分配的 m 说明符是非标准扩展。它不适用于某些系统。`user`并且`pass` **只有**当他们的 scanf 调用返回正值（如：如果他们成功）时，您才应该释放。

3.  的分配`line`不正确：您分配的一个字符太少，因此终止 \0 字符不适合（见上文）。请注意，`strlen`返回字符串大小*不包括*终止 \0 字符。

    此外，`sizeof(char)`毫无意义。标准保证`sizeof(char)`正好是 1（因为`sizeof`实际上并没有返回字节数，而是覆盖参数的位表示所需的字符数）。

4.  **奖金**您应该检查`tmp`和`tmp2`，`NULL`以防万一。调用参数`strcmp`会`NULL`导致分段错误。这很**重要**：如果读取的行包含的用户+密码比之前提供的长，则 fgets 将不会读取标记分隔符，并且 strtok 无法找到，例如最后的 '\n' 字符，*将*返回 NULL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:53:00.670

> Q：将值sizeof(line)写入fgets是否正确？

答：没有:)

因为，正如您所说，它只有 4 个（或 8 个）字节。

我完全不确定您要做什么。也许是这样的？

```
#define MAXLINE 80

char *user, *pass, line[MAXLINE];
scanf ("%s", line);
user = malloc(strlen(line)+1);
strcpy (user, line);
... 
```

# ios - iOS - 防止 UIAppearance 设置更改 UIWebView 输入附件视图

> ID：11214935
> 
> 赞同：7
> 
> 时间：2012-06-26T19:51:23.930
> 
> 标签：ios, input, uiwebview, uisegmentedcontrol, uiappearance

我的应用程序中有一个 UIWebView，问题是我有一个 UIAppearance 可以修改分段控件的外观，因此它会修改 UIWebView 文本字段的输入附件视图中的分段控件，我希望它看起来正确，或不尝试修改它。这是它目前的样子：

![在此处输入图像描述](../Images/d83ec34f1af02fc74febddc8dae6dd99.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T21:02:15.033

我刚刚通过使用 [UIAppearance appearanceWhenContainedIn:] 而不是 [UIAppearance appearance] 为自己解决了这个问题。

通过向选择器发送包含您要自定义的元素的所有自定义 ViewController 类的零终止列表来使用它。所以而不是

```
[[UISegmentedControl appearance] setBackgroundImage:buttonBackgroundImage forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

利用

```
[[UISegmentedControl appearanceWhenContainedIn:[MyViewController class], [MyOtherViewController class], nil] setBackgroundImage:buttonBackgroundImage forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

你不需要列出所有的 ViewControllers，只需要列出你的顶级 ViewControllers。这也使得以下技巧成为可能：创建 UIViewController 的“空”子类 CustomizedViewController，它除了作为子类之外什么都不做 - 然后在整个代码中从那里继承子类，而不是从 UIViewController（基本上用“CustomizedViewController”替换所有出现的“UIViewController” - 除非 CustomizedViewController 实际上将 UIViewController 声明为其超类。

然后使用

```
[[UISegmentedControl appearanceWhenContainedIn:[CustomizedViewController class], nil] setBackgroundImage:buttonBackgroundImage forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T16:54:00.490

好的，所以我终于能够找到解决方法。请参阅我对当前答案的评论，该评论解释了为什么该答案对我不起作用。

重申一下，据我所知，创建键盘附件的 iOS 代码是显式设置 UIToolbar 背景，因此您不会获得 UIAppearance 背景设置，但会获得 UIBarButtonItem 样式。结果是一个半样式的视图，看起来很糟糕。幸运的是，我的设计师对于这种特殊情况可以使用默认样式。

所以，真正的诀窍是弄清楚如何让该视图不通过 UIAppearance 设置样式。我这样做的方法是替换它：

```
id barButtonAppearanceProxy = [UIBarButtonItem appearance]; 
```

有了这个：

```
// wtf: Style any UIBarButtonItem associated with a UIViewController
id barButtonAppearanceProxy = [UIBarButtonItem appearanceWhenContainedIn:[UIViewController class], nil]; 
```

起初这对我来说似乎很奇怪，因为我正在考虑从视图层次结构的角度进行包容......但是，这只是说我们只会设置与 UIViewController 关联的 UIBarButtonItems 的样式。这不会影响键盘附件的原因是因为它直接添加了父视图的窗口，并且没有与 UIViewController 关联。

这仍然不是一个完美的解决方案，理想情况下我们只需使用 UIAppearance 设置键盘配件的样式。此外，它假定您的所有工具栏都与 UIViewController 相关联。对我（可能还有你们中的大多数人）来说幸运的是，通常情况就是这样。

# jquery - jQuery在单击时仅选择当前元素

> ID：11214943
> 
> 赞同：3
> 
> 时间：2012-06-26T19:51:41.263
> 
> 标签：jquery

使用时是否可以只选择当前单击的 div 而不是子项`.on("click",`？

基本上我有一个外部 div，当淡入为 100% 宽度和 100% 高度时，它在中间有一个容器，我的目标是当你点击外部 div 时它会同时淡出，但当你点击时不会内部 div。

我在这里创建了一个 jFiddle 来演示这个问题：http: [//jsfiddle.net/silver89/kaxsL/](http://jsfiddle.net/silver89/kaxsL/)

我试过使用`div > #box`但没有运气所以寻找更多建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T19:59:17.907

试试这个：

```
$(document).on("click", "a", function(){
     $("#box").fadeIn("fast");
     return false;
});

$('div#box').on('click',function(e){
    $(this).fadeOut();
});

$('div.inner').on('click',function(e){
   e.stopPropagation();
}); 
```

你只需要阻止事件冒泡。你可以做任何你想做的事情来选择任何一个 div。​</p>

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T19:55:17.127

您可以检查`target`. 如果`target`是你的`#box`，那么你可以打电话`fadeOut`

```
$(document).on("click", "div > #box", function(e) {
    if (e.target.id === "box") {
        $("#box").fadeOut("fast");
    }
});​ 
```

**[更新的小提琴](http://jsfiddle.net/markcoleman/kaxsL/12/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T20:03:13.677

**[JsFiddle 上的演示](http://jsfiddle.net/kaxsL/20/)**

```
$(document).on("click", "#box", function(){
      $("#box").fadeOut("fast");
});

$(document).on("click", "#box .inner", function(e){
   e.stopPropagation();
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T19:56:30.277

您是否考虑过使内部 div 独立于外部 div（例如，不是其子级）并使用 CSS 将“内部”框定位在您想要的位置？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T20:00:39.077

`event.target`是接收事件的元素。如果不是`this`，它是从后代冒泡的。

```
$(document).on("click", "div > #box", function(ev){
    if( this == ev.target )
        $("#box").fadeOut("fast");
}); 
```

[JSFiddle](http://jsfiddle.net/D2hgW/)

# javascript - Javascript html计算的表单选择不起作用

> ID：11214944
> 
> 赞同：0
> 
> 时间：2012-06-26T19:51:44.417
> 
> 标签：javascript

下面创建的表单允许我循环四个选项，每个选项将自动填充 html 表单中的元素。然后我可以计算一次好的表格。在那部分之后，我迷路了。我认为如果选择它需要一个开关来调用其他下拉数据。或者一个循环。当我在计算后选择另一个值时，表格填写无效。

任何帮助将不胜感激，我已经为此苦苦挣扎了几天。非常感谢。

```
 <form name="LED_savings">
        <script language="JAVASCRIPT">

    <!-- 

    //electricity_cost inc_watts led_watts led_cost bulbcount hoursday, compute savings_year and payback_in_years

    var led_watts = new Array();
    var led_life = new Array();
    var led_cost = new Array();

    led_watts[0] = "";
    led_life[0] = "";
    led_cost[0] = "";

    led_watts[1] = 60;
    led_life[1] = "50000";
    led_cost[1] = "19.99";

    led_watts[2] = 50;
    led_life[2] = "55000";
    led_cost[2] = "19.99";

    led_watts[3] = 40;
    led_life[3] = "55000";
    led_cost[3] = "19.99";

    led_watts[4] = 35;
    led_life[4] = "55000";
    led_cost[4] = "19.99";

           function Choice() {
               //x = document.getElementById("users");
               y = document.getElementById("wattage");

                 //x.value = y.options[y.selectedIndex].text;
                 document.getElementById("led_watts").value = led_watts[y.selectedIndex];
                 document.getElementById("led_life").value = led_life[y.selectedIndex];
                 document.getElementById("led_cost").value = led_cost[y.selectedIndex];
            }

    //resetform

    //calculations 

    function validateForm(form) {

        if ( form.electricity_cost.value == "" || parseFloat(form.electricity_cost.value)<=0.0) { alert("Please enter the cost of your electricity."); return false; }

        if ( form.inc_watts.value=="" || parseInt(form.inc_watts.value)<=0) {alert("Please enter the wattage of the existing lamp."); return false; }

        if ( form.led_watts.value=="" || parseInt(form.led_watts.value)<=0) {alert("Please enter the wattage of the LED lamp."); return false; }

        if ( form.inc_life.value=="" || parseInt(form.inc_life.value)<=0) {alert("Please enter the expected life in hours of the existing lamp."); return false; }

        if ( form.led_life.value=="" || parseInt(form.led_life.value)<=0) {alert("Please enter the expected life in hours of the LED lamp."); return false; }

        if ( form.inc_cost.value=="" || parseFloat(form.inc_cost.value)<0) {alert("Please enter the cost of the existing lamp."); return false; }

        if ( form.led_cost.value=="" || parseFloat(form.led_cost.value)<0) {alert("Please enter the cost of the LED lamp."); return false; }

        if ( form.bulbcount.value=="" || parseInt(form.bulbcount.value)<=0) {alert("Please enter the number of lamps being replaced."); return false; }

        if ( form.hoursday.value=="" || parseFloat(form.hoursday.value)<=0) {alert("Please enter the hours per day the lamp is typically on."); return false; }

        return true;

    }

    function roundPennies(s) {

        var str=s.toString()+"0000";

        var indexdot = str.indexOf(".");

        var len=str.length;

        if (indexdot>0 && indexdot<str.length+3) {

            s=str.substring(0,indexdot+3);

        }       

        return s;

    }

    function Calculate(form) {

        savings_year = "0.00";

        payback_in_years = "99.99";

        life_years = "99.99";

        savings_life = "0.00";

        result=validateForm(form);

        if ( result ) {

            electricity_cost=parseFloat(form.electricity_cost.value);

            inc_watts=parseInt(form.inc_watts.value);

            led_watts=parseInt(form.led_watts.value);

            led_cost=parseFloat(form.led_cost.value);

            inc_cost=parseFloat(form.inc_cost.value);

            led_life=parseInt(form.led_life.value);

            inc_life=parseInt(form.inc_life.value);

            bulb_count=parseInt(form.bulbcount.value);

            hours_day=parseFloat(form.hoursday.value);

            hours_year=hours_day*365;

            life_years = led_life / hours_year;

            // What's the LED energy cost per hour?

            led_cost_per_hour = led_watts * electricity_cost / 1000;

            inc_cost_per_hour = inc_watts * electricity_cost / 1000;

            // What's the replacement cost per hour of use?

            led_opcost_per_hour = led_cost / led_life;

            inc_opcost_per_hour = inc_cost / inc_life;

            // Total operating cost per hour

            led_cost_per_hour = led_cost_per_hour + led_opcost_per_hour;

            inc_cost_per_hour = inc_cost_per_hour + inc_opcost_per_hour;

            // Total cost per year

            led_cost_year = hours_year * led_cost_per_hour;

            inc_cost_year = hours_year * inc_cost_per_hour;

            // what is the life cost savings:

            saving_base = inc_cost_year - led_cost_year;

            savings_life = life_years * saving_base;
            savings_life *= bulb_count;

            // Savings per year and delta cost on purchase price

            savings_year = inc_cost_year - led_cost_year;

            delta_cost = led_cost - inc_cost;

            // Payback period

            payback_period = delta_cost / savings_year;

            // Savings / year should be multiplied by bulb count - but this

            // should not affect payback period.

            savings_year *= bulb_count;

        }

        savings_year=roundPennies(savings_year);

        payback_in_years=roundPennies(payback_period);

        life_years=roundPennies(life_years);

        savings_life=roundPennies(savings_life);

        form.savings_year.value = savings_year;

        form.payback_in_years.value = payback_in_years;

        form.life_years.value = life_years;

        form.savings_life.value = savings_life;

        return;

    }

    //end of code hiding -->

    </script><script language="JavaScript">focus()</script>
            <table class="calculator">
                <tbody>
                    <tr>
                        <td>
                            Wattage of current bulb</td>
                        <td style="margin-left: 20px">
                        <select id="wattage" name="inc_watts" onchange="Choice();setAndReset(this);">
                        <option>Select Wattage</option>
                        <option value="1">60 Watts</option>
                        <option value="2">50 Watts</option>
                        <option value="3">40 Watts</option>
                        <option value="4">35 Watts</option>
                        </select>
                    </td>
                    </tr>
                    <tr>
                        <td>
                            Number of lamps being replaced</td>
                        <td>
                            <input name="bulbcount" size="10" type="text" value="1" /></td>
                    </tr>
                    <tr>
                        <td>
                            My electricity cost, in pence per kwh *<br />
                            <sub>(average rate is 15p/kwh)</sub></td>
                        <td>
                            <input name="electricity_cost" size="10" type="text" value="0.15" /></td>
                    </tr>
                    <tr>
                        <td>
                            FLUX LED BULB Equivalent Wattage</td>
                        <td>
                            <input id="led_watts" name="led_watts" size="10" type="text" /></td>
                    </tr>
                    <tr>
                        <td>
                            LED lamp life 25 Years (hours)</td>
                        <td>
                            <input id="led_life" name="led_life" size="10" type="text" /></td>
                    </tr>
                    <tr>
                        <td>
                            Existing lamp life 25 Years (hours)</td>
                        <td>
                            <input name="inc_life" size="10" type="text" value="1000" /></td>
                    </tr>
                    <tr>
                        <td>
                            Cost per LED replacement lamp £<br />
                            <sub>(average price per bulb)</sub></td>
                        <td>
                            <input id="led_cost" name="led_cost" size="10" type="text" /></td>
                    </tr>
                    <tr>
                        <td>
                            Cost per existing bulb £<br />
                            <sub>(average price per bulb)</sub></td>
                        <td>
                            <input name="inc_cost" size="10" type="text" value="6" /></td>
                    </tr>
                    <tr>
                        <td>
                            Number of hours/day bulb is in use<br />
                            <sub>(average usage is 4 hours per day)</sub></td>
                        <td>
                            <input name="hoursday" size="10" type="text" value="6" /></td>
                    </tr>
                    <tr>
                        <td>
                            &nbsp;</td>
                        <td>
                            <input onclick="Calculate(this.form)" size="10" type="button" value="Calculate" /></td>
                    </tr>
                    <tr>
                        <td>
                            Savings per year</td>
                        <td>
                            <input name="savings_year" size="10" type="text" /></td>
                    </tr>
                    <tr>
                        <td>
                            Usable Life of LEDs in Years</td>
                        <td>
                            <input name="life_years" size="10" type="text" /></td>
                    </tr>
                    <tr>
                        <td>
                            Payback in years</td>
                        <td>
                            <input name="payback_in_years" size="10" type="text" /></td>
                    </tr>
                    <tr>
                        <td>
                            Savings OverLife of LED Bulbs</td>
                        <td>
                            <input name="savings_life" size="10" type="text" /></td>
                    </tr>
                </tbody>
            </table>
    </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:36:01.207

您正在覆盖一些不应更改的变量

这些变量：

```
var led_watts = new Array();
var led_life = new Array();
var led_cost = new Array(); 
```

在Calculate()中被覆盖

```
led_watts=parseInt(form.led_watts.value);
led_cost=parseFloat(form.led_cost.value);
led_life=parseInt(form.led_life.value); 
```

由于您将这些变量用作计算的辅助值，我建议您创建新的唯一变量：

```
var curr_led_watts=parseInt(form.led_watts.value);
var curr_led_cost=parseFloat(form.led_cost.value);
var curr_led_life=parseInt(form.led_life.value); 
```

更好的是您重命名数组，以便它们的名称清楚地表明它们是数组。这应该有助于避免将来遇到此问题：

```
var led_watts_values = new Array();
var led_life_values = new Array();
var led_cost_values = new Array(); 
```

我还建议您检查文字数组初始化（[http://www.w3schools.com/js/js_obj_array.asp](http://www.w3schools.com/js/js_obj_array.asp)），因为它会为您节省大量时间：

```
var led_watts_values = [0, 60, 50, 40, 35]; 
```

# javascript - ExtJS 使用来自数据库 (JSON) 的数据填充 Ext.FormPanel

> ID：11214950
> 
> 赞同：2
> 
> 时间：2012-06-26T19:52:14.680
> 
> 标签：javascript, extjs, extjs3, formpanel

我正在使用 ExtJS (v3)，并且我构建了一个要填充的表单，以便用户可以编辑数据然后将其提交回来。

表单已正确构建，并且数据正在从数据库中正确提取，但是我遇到困难的地方是使用数据库中的数据填充表单。

有人有建议吗？

这是我从数据库中提取的数据：

```
var workflow_projects = new Ext.data.JsonStore({
        autoLoad: true,
        autoDestroy: true,
        url: '<% $jsonURL %>',
        storeId: 'workflow_projects',
        idProperty: 'ProjectID',
        fields: [ 'ProjectID', 'ProjectName' ]
}); 
```

然后是我的表格：

```
var simpleForm = new Ext.FormPanel ({
labelWidth: 175,
id: 'simpleForm',
    url:'./edit',
method: 'POST',
    frame:true,
    title: 'Edit',
    bodyStyle:'padding:5px 5px 0',
    width: 850,
    defaultType: 'textfield',

    items: [
        {
            fieldLabel: 'Project Name',
            name: 'ProjectName',
            allowBlank:true,
            anchor:'100%'
        }

    ]
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T22:27:17.913

我会在商店的加载事件处理程序中使用加载记录。您的字段名称必须与商店中的记录相匹配，这看起来就像您为 ProjectName 所做的一样。

[http://docs.sencha.com/ext-js/3-4/#!/api/Ext.form.BasicForm-method-loadRecord](http://docs.sencha.com/ext-js/3-4/#!/api/Ext.form.BasicForm-method-loadRecord)

（代码未在实际浏览器中测试。）

```
var workflow_projects = new Ext.data.JsonStore({
            autoLoad: true,
            autoDestroy: true,
            url: '<% $jsonURL %>',
            storeId: 'workflow_projects',
            idProperty: 'ProjectID',
            fields: [ 'ProjectID', 'ProjectName' ],

        events : {
           load: function(store, records, options){
           if(records[0]){
           simpleForm.getForm().loadRecord(records[0]);
           } else{
             console.log("no data!");
            }
        }
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T08:26:13.993

我在继承的 BasicForm 类上使用 load 方法。

```
simpleForm.getForm().load({
   url: '/path/to/form/data',
   params: { id: id},
   method: 'POST',      
   waitMsg: 'Loading data...'
}); 
```

您的 JSON 应如下所示：

{ "success": true, "data": { "ProjectId": "foo", "ProjectName": "bar" } }

# c++ - 'this' 用于结构？

> ID：11214957
> 
> 赞同：0
> 
> 时间：2012-06-26T19:52:48.410
> 
> 标签：c++, constructor, struct, this

一个简短的，也许是愚蠢的问题。对于类和结构，有时我喜欢使用与构造函数参数同名的成员变量。例如：

```
class Vector3
{
    float x, y, z;

    public Vector3(float x, float y, float z)
    {
        this.x = x;
        this.y = y;
        this.z = z;
    }
} 
```

基本上，我也想对结构执行此操作，但您不能在结构构造函数中使用“this”（我认为它们的用途是为类保留的）。有没有办法做到这一点，或者我应该给我的论点另一个名字？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T19:54:21.497

你可以使用它，但它是一个*指针*，就像在类中一样：

```
this->x = x; 
```

顺便说一句，除了默认*访问说明符*`struct`之外， a和 a`class`对所有内容都是完全相同的。

 ** * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-26T20:01:42.043

你真正应该做的是使用构造函数的初始化列表：

```
class Vector3
{
    float x, y, z;

  public:
     Vector3(float x, float y, float z) : x(x), y(y), z(z) {}

}; 
```

但是关于您对在结构中使用的疑虑`this`，与类没有区别。

我想补充一点，确实值得为数据成员制定某种命名约定，以避免混淆。收藏夹往往是尾随的下划线或前导`m_`。*

# c# - 系统重新启动时无法读取 XML 文件

> ID：11214961
> 
> 赞同：0
> 
> 时间：2012-06-26T19:52:52.450
> 
> 标签：c#, xml, restart, logoff

我正在用 Windows 窗体 c# 编写这个应用程序。当用户退出此应用程序时，它会要求系统重新启动。退出时它会写入一些 XML 文件并将文件保存在当前目录中（bin/debug）....在系统重新启动时，我的应用程序会自行重新启动（通过从注册表中读取值）并检查这些文件是否存在（如果（File.Exists） ）或不是..我的问题是在系统重启时它根本不检查文件是否存在......并显示错误的输出......但是当我关闭它并再次重新启动它时它显示正确的输出......我真的不能了解它的问题...有人可以帮帮我吗...？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:56:31.540

程序需要从绝对目录位置而不是相对或当前位置读取文件。它在启动时的上下文可能与上次运行时不同。

# php - 显示所有用户中答案选择的百分比

> ID：11214963
> 
> 赞同：0
> 
> 时间：2012-06-26T19:52:56.067
> 
> 标签：php, mysql, sql, sql-server

我有一个这样的表，包含三个字段：

```
User | Question# | Answer 
```

答案选择只有 1、2、3、4 或 5

我需要编写一个 SELECT 语句，以便将答案 1 和 2 的百分比以及答案 3、4 和 5 的百分比一起打印。

结果应该是这样的：

```
Question# | %One+Two | %Three+Four+Five
1               %30          %70
2               %23          %77
.                .            .
.                .            .
.                .            . 
```

我这样做是为了显示答案 1 和 2 的计数，但它没有提供我需要的内容：

```
select QNum, Response, Count(Response)
 from SurveyResults
 group by QNum, Response
 having Response<3; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:57:01.090

```
select  QuestionNr
,       100.0 * count(case when Answer in (1,2) then 1 end) / count(*) as OneTwo
,       100.0 * count(case when Answer in (3,4,5) then 1 end) / count(*) as ThreeFourFive
from    YourTable
group by
        QuestionNr 
```

# ssh - Amazon Linux 上的 Nano 处理配置文件中的文本

> ID：11214965
> 
> 赞同：1
> 
> 时间：2012-06-26T19:52:57.287
> 
> 标签：ssh, amazon-ec2, apache, nano

我正在尝试在运行 OSX 10.7.4 的 Macbook Air 上使用 nano 在 amazon linux 的 ec2 实例上编辑我的 httpd.conf 文件。

我试图将documentroot更改为“/home/ec2-user/www”，只是发现保存到文件中的是docume“/home/ec2-user/www”或其他一些损坏的片段。

原谅我，我不确定这是否更适合 stackoverflow、poweruser 或服务器故障。

# css - 列表项背景上的 CSS 过渡

> ID：11214966
> 
> 赞同：1
> 
> 时间：2012-06-26T19:52:58.877
> 
> 标签：css, css-transitions

我经常使用 CSS 过渡，但由于某种原因，我无法让它们在简单的无序列表上工作。我在这里创建了一个演示：http: [//jsfiddle.net/79NhC/](http://jsfiddle.net/79NhC/)

在列表项上，我有以下 CSS：

```
#servicesBox li {
    border-bottom:1px solid #eeeeee; 
    padding:10px 0 10px 10px;  
    webkit-transition: background 0.2s; 
    moz-transition: background 0.2s; 
    ms-transition: background 0.2s; 
    o-transition: background 0.2s; 
    transition: background 0.2s; 
}​ 
```

出于某种原因，当用户将鼠标悬停在列表项上时，背景不会优雅地淡入。有什么原因吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T19:55:38.923

您需要`-`在所有特定于浏览器的转换声明之前放置一个。

所以，像这样：

```
#servicesBox li
{
    border-bottom:1px solid #eeeeee;
    padding:10px 0 10px 10px;
    -webkit-transition: background 0.2s;
    -moz-transition: background 0.2s;
    -ms-transition: background 0.2s;
    -o-transition: background 0.2s;
    transition: background 0.2s;
} 
```

# jquery - jQuery outerWidth 作为设置器工作——这可靠吗

> ID：11214968
> 
> 赞同：1
> 
> 时间：2012-06-26T19:53:09.250
> 
> 标签：jquery

当前的 jQuery 文档没有提到 .outerWidth() 的行为是 setter。虽然我确信我可以解决这个问题，但根据行中其他元素的计算宽度来设置行中元素的宽度是很麻烦的，并且与其他主要浏览器相比在 IE9 中的工作不一样。凭直觉，我尝试使用 .outerWidth() 作为设置器。它在所有浏览器中都能完美地工作。

这是代码行（使用 JavaScript 变量设置“值”，其值由警报确认）：

```
$("#WelcomeMessage").outerWidth(WidthAvailableForWelcomeMessage); 
```

以下是我网站中的 jQuery 参考资料：

```
<script src="jquery-1.7.2.js" type="text/javascript"></script>
<script src="jquery-ui.js" type="text/javascript"></script>
<link href="jquery-ui.css" rel="stylesheet" type="text/css" /> 
```

.outWidth() 文档中的一条评论，在评论部分的末尾，说此功能在 jQuery ui 中。注释掉 ui 的 ref 使它不起作用。但是我在任何地方都找不到有关此功能的明确文档。

这种行为可靠吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T20:02:08.657

~~jQuery ui 的文档充其量总是参差不齐，我也找不到任何文档。我建议不要`outerWidth`用作二传手并寻找替代方案。~~

`outerWidth`将成为 jquery 1.8 中的 setter 和 getter，只要您继续在代码中包含 jQuery ui 直到升级到 jquery 1.8，就可以安全地使用它

[http://blog.jquery.com/2012/06/22/jquery-1-8-beta-1-see-whats-coming-and-going/](http://blog.jquery.com/2012/06/22/jquery-1-8-beta-1-see-whats-coming-and-going/)

至少，目前计划在 1.8 中。由于它仍然是测试版，这当然可以改变。

# c++ - 获取指向虚方法的指针？

> ID：11214973
> 
> 赞同：2
> 
> 时间：2012-06-26T19:53:43.620
> 
> 标签：c++

我有一个函数需要在循环中多次调用虚方法，并希望有一种方法可以避免每次都进行 vtable 查找的开销。我想也许获得一个指向该方法的指针是解决这个问题的好方法。下面的代码显示了我正在尝试做的事情，问题是方法的地址`Derived`不能分配给`Base`成员函数指针。

```
class Base
{
    public:

    typedef float ( Base::*MFP )( float const & x ) const;

    virtual MFP getMFP( void ) const = 0;

    virtual float function( float const & x ) const = 0;
};

class Derived : public Base
{
    public:

    virtual MFP getMFP( void ) const
    {
        return &Derived::function;
    }

    virtual float function( float const & x ) const
    {
        return x * x;
    }
};

class Other
{
    public:

    float calculate( float const & x, Base * pBase ) const
    {
        Base::MFP function = pBase->getMFP();
        return ( ( *pBase ).*( function ) )( x );
    }
}; 
```

有没有办法做我在这里想做的事情？

* * *

编辑：

对于仍然感兴趣的任何人，我对我的代码进行了定时测试。结果发现动态调度只使我的计算方法减慢了 0.004%，所以几乎没有。使用 MSVC 2010 编译并进行了全面优化。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T20:26:29.033

您的想法是基于一个错误的假设，即创建此类指针将使 VMT 访问脱离循环（即执行一次而不是在循环中重复执行）。

在 C++ 语言中，通过“指向成员函数”类型的指针（恰好绑定到*虚拟*成员函数）的调用总是*在调用*时解决，而不是在初始化时解决。这意味着即使你创建了这样一个指针，它也不会优化任何东西。*循环中的每个调用*仍将执行对 VMT 的全面访问，就像没有任何指针一样。

在 C++ 中，没有办法在初始化时强制这样一个指针指向*特定*版本的虚函数。C++ 语言根本没有这样的特性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T20:16:25.323

不要这样做。处理器有很深的管道，编译器几乎肯定已经缓存了函数指针。你可以通过一些努力做到这一点。但我保证在任何不到 10 年的编译器上，这不会有任何区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T20:25:23.020

如果您确定 for 循环中的对象是 a ，最简单的方法是强制转换`Derived`。

```
void foo(float);
Base* pObject;
//...
//If you know with certainty that the object is a Derived
Derived& der = *static_cast<Derived*>(object)
for(float x : floatContainer)
{
     foo(der.function(x));
} 
```

这意味着您只会调用`Derived`的 vtable，这可能会更快，具体取决于从`Derived`. 如果您只能保证该类是 a `Base`，那么您在上面的问题中编写的内容本质上是一个 vtable，除了比编译器生成的任何东西都要慢得多。您可能听说过 vtables 很慢，与原始 C 指针和函数相比也许确实如此，但我几乎可以完全保证它足够快以满足您的需要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T20:14:37.167

我会避免过早的优化，直到它成为一个问题；然后，只有在你分析了你的代码之后，你才会进行更改。首先争取可维护性和可扩展性，如果您仍然遇到性能问题，请考虑重构。在此示例中，查找的开销很小。

我宁愿查看可读的代码，也不愿查看性能提升 5% 但需要我一整天才能弄清楚它在做什么的代码。

# iphone - 连续显示多个CALayers 60秒？

> ID：11214977
> 
> 赞同：1
> 
> 时间：2012-06-26T19:53:49.513
> 
> 标签：iphone, objective-c, ios, calayer

我这边有情况。

我正在使用 AVFoundation 来捕获相机帧。现在我想要做的是，对于某些帧，我需要显示一个逐步旋转的图片。

我想要做的是我正在拍摄 4 个 CALayers，包括一个对象的前后左右图像，并使用 CALayer 时间属性和组动画属性，我想在一定的毫秒间隔后一张一张地显示所有图像时间使连续的图像看起来像动画。

怎么办？请帮助我在这里进行一些编码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T06:29:15.190

根据 Mohit Gupta 的粘贴链接回答：

**设置你想要图像序列动画的CALayer**

```
CALayer *animationLayer = [CALayer layer];
[animationLayer setFrame:CGRectMake(125, 0, 240, 300)];
[self.baseLayer addSublayer:animationLayer]; 
```

**定义需要在序列动画中显示的图像数组**

```
NSArray *animationFrames = [NSArray arrayWithObjects:(id)[UIImageimageNamed:@"1.png"].CGImage, (id)[UIImage imageNamed:@"2.png"].CGImage, (id)[UIImage imageNamed:@"3.png"].CGImage, nil]; 
```

**使用 CAKeyframeAnimation 以顺序方式显示图像数组**

```
CAKeyframeAnimation *frameAnimation = [[CAKeyframeAnimation alloc] init];
[frameAnimation setKeyPath:@"contents"];
frameAnimation.calculationMode = kCAAnimationDiscrete; //mode of transformation of images
[animationLayer setContents:[animationFrames lastObject]]; //set the array objects as encounterd
frameAnimation.autoreverses = NO; //If set Yes, transition would be in fade in fade out manner
frameAnimation.duration = ((float)[animationFrames count])/4.5; //set image duration , it can be predefined float value
frameAnimation.repeatCount = HUGE_VAL; //this is for inifinite, can be set to any integer value as well
[frameAnimation setValues:animationFrames];
[frameAnimation setRemovedOnCompletion:YES];
[frameAnimation setDelegate:self];
[animationLayer addAnimation:frameAnimation forKey:@"contents"]; //add animation to your CALayer
[frameAnimation release]; 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T05:34:49.817

```
-(void)startMainAnimation
{
  //Animationframes is array of images that should be CGImage Type not UIImage..
  //animation Layer that is added above view……

  CAKeyframeAnimation *frameAnimation = [[CAKeyframeAnimation alloc] init];
  [frameAnimation setKeyPath:@"contents"];
  frameAnimation.calculationMode = kCAAnimationDiscrete;
  [animationLayer setContents:[animationFrames lastObject]];
  frameAnimation.autoreverses = NO;
  frameAnimation.duration = ((float)[animationFrames count])/4.5;;
  frameAnimation.repeatCount = 1;
  [frameAnimation setValues:animationFrames];
  [frameAnimation setRemovedOnCompletion:YES];
  [frameAnimation setDelegate:self];
  [animationLayer addAnimation:frameAnimation forKey:@"contents"];
  [frameAnimation release];

} 
```

# linux - 如何用 sed 替换未知字符？

> ID：11214978
> 
> 赞同：2
> 
> 时间：2012-06-26T19:53:55.210
> 
> 标签：linux, tags, sed, mp3, fat32

今天我尝试将一些 MP3 文件从外部驱动器导入到我的音乐文件夹，当我注意到我的许多标签被错误解释时。例如，带有 á,ó,í,ö,ä 等字母的文件在矩形内显示为问号，如下所示：。</p>

我所做的只是将外部 fat32 驱动器中的所有 mp3 文件 mv 到我自己的，即 linux。有没有办法删除这个“特殊字符”，即用一个字母？我没有成功尝试的是**sed -e 's/\?/ae/g'**像这样：

```
id3v2 -l song.mp3 | grep Artist | cut -d ':' -f 2 | sed -e 's/\?/ae/g' 
```

我在阅读[此](http://www.home.no/mlinux/fonts.htm)链接时意识到，其中一些字母为 ä,ö,á 被解释为诸如 \341 之类的数字。我认为这与 FAT32 转 linux 转码有关，但我完全不确定。有人知道如何用 sed 正确替换它们 - 欢迎使用其他解决方案 ;-)。感谢您的建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T20:21:28.270

我不确定这个反向逻辑 sed 表达式是否可以回答您的 sed 问题，但请尝试一下：

`sed -re 's/[^a-zA-Z0-9]+//g'`

**这需要每个不是**az的字符的一个或多个实例。AZ, 0-9 并将其删除。（有时，当您允许的字符集有限但未知数量的非允许字符时，这是最简单的方法。您可能必须在要允许的表达式中添加更多字符。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T18:49:14.837

标签在您的 mp3 文件中吗？如果是这样，我会避免在二进制文件上运行 sed ...

# objective-c - 每次打开 iPhone 应用程序时，我会使用什么程序来更新它？

> ID：11214986
> 
> 赞同：-1
> 
> 时间：2012-06-26T19:54:34.710
> 
> 标签：objective-c, ios, cocoa-touch

我的应用程序相当简单，但是，它要求在打开应用程序时更新一些文本字段、标签、图像等？因为内容是根据我传递给它的数据更新的。我会使用我的 SQLite 来完成此任务，还是考虑到它不是很多信息，是否有更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:02:06.003

您可以在启动时从 SQLite 数据库中读取数据；但是，我建议您改用 NSUserDefaults，因为它在处理少量数据时效率更高。以下是如何使用它的示例：

```
NSString *username = @"John Smith"

//Store data
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
[defaults setObject: username forKey:@"Username"];
[defaults synchronize];

//Retrieving data on startup from the first view controller
- (void)viewDidLoad{

    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSString *username = [defaults objectForKey:@"username"];
    myLabel.text = [NSString stringWithFormat:@"Welcome %@!", username];
} 
```

如果您对代码有任何疑问，请在评论中提问。希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T20:01:13.363

如果信息不多，就用 NSUserDefaults 来存储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T20:20:51.930

我没有很好地回答您的问题，但是根据我的想法，您想保存数据并在再次打开应用程序时需要这些数据。

因此，如果数据较少，您可以使用 NSUserDefaults。

```
 NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults]; 
```

如果数据很大，您可以使用**sqlite**文件来保存数据，也可以使用**核心数据**。

如果您的数据非常大，那么您必须创建 Web 服务并且必须从 Web 服务下载数据，因此每当您调用 Web 服务时，更新的数据都来自 Web 服务（您应该保存在您的服务器上）。

# ruby-on-rails - 设计建议：Gemify ActiveResource 子类

> ID：11214991
> 
> 赞同：0
> 
> 时间：2012-06-26T19:54:53.540
> 
> 标签：ruby-on-rails, activeresource

我被要求从我们的 Rails 应用程序中的许多 ActiveResource 子类中构建一个 gem。

困难在于`self.site`调用使用 Rails 环境文件中的常量集（以便开发、测试和生产指向不同的网站）。将我的新 gem 添加到 Gemfile 后，我发现应用程序在环境文件*之前*加载 gem ，因此我的 ActiveResource 模型破坏了应用程序。

我应该怎么办？

*规格：Rails 3.2.3，Ruby 1.9.3*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T21:07:06.993

我最终做的是覆盖`self.site`and `self.format`，`self.connection`让他们只在第一次调用方法时寻找环境常量：

```
module MyActiveResource

    # A flag to indicate whether the environment variable has already been sought
    attr_accessor :active_record_fields_set

    # Set site & format if not set
    def connection(refresh=false)
        set_my_active_record_fields unless active_record_fields_set
        super(refresh)
    end

    # Set site & format if not set
    def site
        set_my_active_record_fields unless active_record_fields_set
        super
    end

    # Set site & format if not set
    def format
        set_my_active_record_fields unless active_record_fields_set
        super
    end

    # Set site & format
    def set_my_active_record_fields
        self.active_record_fields_set = true
        self.site = MY_CONSTANT
        self.format = ActiveResource::Formats::XmlFormat
    end

end 
```

然后`MyActiveResource`在我的从`ActiveResource::Base`.

# windows-phone-7 - 如何在windows phone camera中选择区域

> ID：11214992
> 
> 赞同：0
> 
> 时间：2012-06-26T19:54:59.513
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone-7-emulator

我想在拍照时选择两个特定区域。必须覆盖其他区域（例如：- 为仪表拍照，我想捕获仪表计数和仪表序列号）

如何在 Windows 手机中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T11:33:18.210

您可以使用附加功能层实现您自己的自定义版本的 Camera Capture 应用程序，如下文所示。通过访问相机预览缓冲区，您可以将额外的蒙版/滤镜应用到不应被覆盖的区域。

[在 Windows Phone 应用程序中使用相机](http://msdn.microsoft.com/en-us/magazine/hh708750.aspx)

另请查看 [适用于相机和照片的 Windows Phone 示例](http://msdn.microsoft.com/en-us/library/ff431744%28v=vs.92%29.aspx#BKMK_CameraAndPhotos)

另一个想法是使用[CameraCaptureTask捕获照片，然后在](http://msdn.microsoft.com/en-us/library/hh394006%28v=vs.92%29.aspx)*CameraCaptureTask.Completed*事件处理程序中应用蒙版图像（或进行任何其他图像处理）

# css - 是否可以编辑尚不适用于 Firebug 中的任何内容的 CSS 规则？

> ID：11214998
> 
> 赞同：0
> 
> 时间：2012-06-26T19:55:23.807
> 
> 标签：css, firebug, responsive-design, media-queries

我正在通过响应式设计帮助改进 Wordpress 网站。目前，我为不同的屏幕尺寸设置了媒体查询，但现在它们中没有 CSS 规则。

```
@media only screen 
and (min-device-width : 320px) 
and (max-device-width : 480px) {
/* Styles go here */
} 
```

有没有办法在 Firebug 上的媒体查询中编辑和添加全新的规则？这比添加“虚拟” CSS 规则、将其放在 FTP 上、然后在浏览器中测试并从那里进行编辑更方便。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:59:43.743

如果我正确理解您的问题，那么您不能在 firebug 中进行编辑，这将永久影响您的网站。您可以更改代码以查看它的作用，然后将其复制并粘贴到单独的脚本中。至于你的答案，你最终必须为它编写一个单独的 css 脚本。

如果可以（可能是升级），那就太好了，但出于安全目的，它可能需要某种密码，所以不仅仅是任何人都可以编辑它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T20:05:09.647

是的，您可以，只需单击 CSS 选项卡，然后单击 Source Edits。然后将您的更改复制到您的实际 CSS（如果您想要的话）。请记住，虽然您使用 定义媒体查询`min-device-width`，但在桌面上这不会呈现任何更改，因为如果您调整浏览器大小，设备宽度不会改变。

同样，您也可以使用 Chrome 的调试器工具 - 我发现这更有帮助。您可以在“元素”选项卡上更改 CSS。然后单击“资源”选项卡，找到您的 Styles 文件夹 - Chrome 实际上会告诉您您编辑了哪些 CSS 文件，并为您进行版本控制。只需右键单击并保存与您想要的编辑相匹配的 CSS 文件版本。

# lucene - Neo4j Cypher：在 lucene 查询之后限制起始节点

> ID：11214999
> 
> 赞同：1
> 
> 时间：2012-06-26T19:55:25.973
> 
> 标签：lucene, neo4j, cypher

我有一个 Cypher 查询，它首先使用 lucene 查询从索引中查找节点列表：

```
START n=node:people("name:ROBERT")
MATCH n--o
RETURN n.name, COLLECT(o.task_name) 
```

当索引的查询返回大量结果时，它会变得非常慢。我想限制在查询的其余部分中使用的节点数 - 即将 n=node:people("name:ROBERT") 限制为 30 个结果。

我在 lucene 或 Cypher 中看不到任何明显的方法来做到这一点。

我想我可以把它分成两个查询，例如：

START n=node:people("name:ROBERT") RETURN n LIMIT 10

然后使用返回的节点执行查询的第二部分，但我想知道是否有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:09:05.013

对不起，但不，现在没有更好的方法。