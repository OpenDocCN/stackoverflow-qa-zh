# StackOverflow 问答 000898000-000898999

# xml - Msxml2.FreeThreadedDOMDocument.4.0 或 Msxml2.FreeThreadedDOMDocument.6.0

> ID：898005
> 
> 赞同：1
> 
> 时间：2009-05-22T14:03:15.000
> 
> 标签：xml, com, vbscript, msxml

我有一个使用 Msxml2.FreeThreadedDOMDocument.4.0 的 VBScript COM 组件，但是使用 Msxml2.FreeThreadedDOMDocument.6.0 是否有/会有什么好处

我在本地机器上玩了一下，看到使用 6.0 的性能略有改进，但是我在网上找不到任何与任何可能的陷阱有关的好的参考资料

还有其他人有任何提示/指示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T14:24:36.717

如果您的测试和您的数据没有显示出令人信服的改进，那么对您来说，其他人所看到的并不重要......

也就是说，您可能只想升级以完成它。无论如何，您可能迟早要...

# sql - SQL：使用连接、联合将 2 个表分组为 1，然后呢？

> ID：898019
> 
> 赞同：3
> 
> 时间：2009-05-22T14:05:14.247
> 
> 标签：sql, select, join, union

我有 5 张桌子：

客户 ID - 姓名

p_orders id - id_customer - 代码 - 日期

p_items id - id_order - 描述 - 价格

和 h_orders 和 h_items，它们正是 p_orders 和 p_items 的副本。

当 p_ 表达到大量行时，我将最旧的表移至 h_ 表..它们作为历史记录。

所以，我的问题是：**如何从 p_ 表和 h_ 中检索数据，将它们视为一个唯一表**？

例如，我想检索每个客户的订单数量和总价格（**所有客户订单的**），我使用该查询：

```
SELECT
    customer.id,
    customer.name,
    count(DISTINCT p_orders.id) AS num_orders,
    sum(p_items.price) AS total_money
FROM
    customer
    INNER JOIN p_orders ON p_orders.id_customer = customer.id
    INNER JOIN p_items ON p_items.id_order = p_orders.id
GROUP BY
    customer.id,
    customer.name,
    p_orders.id_customer
ORDER BY
    customer.id 
```

它仅适用于一组“表”（p_ 或 h_）..但我都想要它们。

我尝试使用 UNION：

```
(
    SELECT
        customer.id,
        customer.name,
        count(DISTINCT p_orders.id) AS num_orders,
        sum(p_items.price) AS total_money
    FROM
        customer
        INNER JOIN p_orders ON p_orders.id_customer = customer.id
        INNER JOIN p_items ON p_items.id_order = p_orders.id
    GROUP BY
        customer.id,
        customer.name,
        p_orders.id_customer
)
UNION
(
    SELECT
        customer.id,
        customer.name,
        count(DISTINCT h_orders.id) AS num_orders,
        sum(h_items.price) AS total_money
    FROM
        customer
        INNER JOIN h_orders ON h_orders.id_customer = customer.id
        INNER JOIN h_items ON h_items.id_order = h_orders.id
    GROUP BY
        customer.id,
        customer.name,
        h_orders.id_customer
)
ORDER BY id ASC 
```

这个可行，但如果客户在 p_ 表和 h_ 表中都有订单，我将为该客户提供 2 行具有 2 个不同的 num_orders 和 total_money （分别来自 p_ 表和 h_ 表）

我试图在联合之外添加一个 GROUP BY id：

```
(
    --SELECT 2
)
UNION
(
    --SELECT 1
)
GROUP BY id
ORDER BY id ASC 
```

但是查询失败并出现*ERROR: syntax error at or near "GROUP" at character 948*，似乎 GROUP BY 不能以这种方式使用。

有什么建议吗？

**编辑：**

对于 uriDium，是的，所有表都将 id 列作为主键，并且引用的字段（又名 p_orders.id_customer）也是外键。这里是测试数据库结构转储（我在创建表后添加了一些索引和外键，但我不认为这意味着什么）：

```
CREATE TABLE customer (
    id serial NOT NULL,
    name character(50)
);
CREATE TABLE p_orders (
    id serial NOT NULL,
    id_customer integer NOT NULL,
    date date DEFAULT now(),
    code character(5)
);
CREATE TABLE p_items (
    id serial NOT NULL,
    id_order integer NOT NULL,
    descr character(250),
    price money
);
CREATE TABLE h_orders (
    id integer NOT NULL,
    id_customer integer NOT NULL,
    date date,
    code character(5)
);
CREATE TABLE h_items (
    id integer NOT NULL,
    id_order integer NOT NULL,
    descr character(250),
    price money
);
CREATE UNIQUE INDEX id_h_orders ON h_orders USING btree (id);
CREATE INDEX id_h_o_c ON h_orders USING btree (id_customer);
CREATE UNIQUE INDEX id_items_h ON h_items USING btree (id);
CREATE INDEX id_ordinr_dsve ON h_items USING btree (id_order);

ALTER TABLE ONLY customer
    ADD CONSTRAINT customer_pkey  (id);
ALTER TABLE ONLY p_orders
    ADD CONSTRAINT p_orders_pkey PRIMARY KEY (id);
ALTER TABLE ONLY p_items
    ADD CONSTRAINT p_items_pkey PRIMARY KEY (id);
ALTER TABLE ONLY stats
    ADD CONSTRAINT stats_pkey PRIMARY KEY (id);
ALTER TABLE ONLY p_orders
    ADD CONSTRAINT "$1" FOREIGN KEY (id_customer) REFERENCES customer(id) ON DELETE CASCADE;
ALTER TABLE ONLY p_items
    ADD CONSTRAINT "$1" FOREIGN KEY (id_order) REFERENCES p_orders(id) ON DELETE CASCADE;
ALTER TABLE ONLY h_orders
    ADD CONSTRAINT "$1" FOREIGN KEY (id_customer) REFERENCES customer(id) ON DELETE CASCADE;
ALTER TABLE ONLY h_items
    ADD CONSTRAINT "$1" FOREIGN KEY (id_order) REFERENCES h_orders(id) ON DELETE CASCADE; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T14:22:00.843

您可能应该在两个表上创建视图：

```
CREATE VIEW All_Orders
AS
     SELECT
          id,
          id_customer,
          code,
          date,
          'H' AS order_type
     FROM
          h_orders
     UNION ALL
     SELECT
          id,
          id_customer,
          code,
          date,
          'P' AS order_type
     FROM
          p_orders

CREATE VIEW All_Order_Items  -- A table name of "items" is pretty bad in my opinion
AS
     SELECT
          id,
          id_order,
          description,
          price,
          'H' AS order_item_type
     FROM
          h_items
     UNION ALL
     SELECT
          id,
          id_order,
          description,
          price,
          'P' AS order_item_type
     FROM
          p_items 
```

现在您可以加入这些视图。我包括了类型（P & H），以便您知道“id”列现在指的是什么。如果两个表中的 ids（“h”和“p”可以有重复，那么你将不得不在 All_Order_Items 视图中加入 Orders 表。否则你将在两个视图之间加入很多麻烦。希望你的 id列是智能设计的，而不仅仅是自动递增或标识列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T14:19:03.767

你可以试试这个：

```
SELECT tbl.ID, 
       tbl.Name, 
       sum(tbl.num_orders) num_orders, 
       sum(tbl.total_money) total_money
FROM (    
      SELECT customer.id, 
             customer.name,        
             count(DISTINCT p_orders.id) AS num_orders,        
             sum(p_items.price) AS total_money    
      FROM customer        
            INNER JOIN p_orders 
                ON p_orders.id_customer = customer.id        
            INNER JOIN p_items 
                ON p_items.id_order = p_orders.id    
      GROUP BY customer.id, customer.name, p_orders.id_customer

      UNION

      SELECT customer.id, 
             customer.name,        
             count(DISTINCT h_orders.id) AS num_orders,
             sum(h_items.price) AS total_money    
      FROM  customer        
             INNER JOIN h_orders 
                 ON h_orders.id_customer = customer.id
             INNER JOIN h_items 
                 ON h_items.id_order = h_orders.id    
      GROUP BY customer.id, customer.name, h_orders.id_customer
    ) tbl
 GROUB BY tbl.id, tbl.name
 ORDER BY tbl.id ASC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T14:25:58.667

使用两个查询的联合创建一个视图，但没有聚合函数。使用 Union All，因为同一记录不在两个表中，您不需要服务器浪费时间查看。您可能会有其他时间想要在查询中访问两个表。

然后使用视图编写查询。

查看代码将类似于（您可能还希望其他字段用于其他目的：

```
Create view customerOrders
AS
SELECT      customer.id as CustomerID,  customer.name, p_orders.id as OrderID,  p_items.price  as price
FROM        customer        
INNER JOIN  p_orders ON p_orders.id_customer = customer.id        
INNER JOIN  p_items ON p_items.id_order = p_orders.id
union all
SELECT      customer.id,  customer.name,  h_orders.id as id, H_items.price           
FROM        customer        
INNER JOIN  h_orders ON h_orders.id_customer = customer.id        
INNER JOIN  h_items ON h_items.id_order = h_orders.id 
```

那么对您的查询的调用将类似于（这些都没有经过测试可能需要调整）

```
SELECT    CustomerID,    customer.name,    count(DISTINCT OrderID) AS num_orders,    
sum(price) AS total_money
FROM    customerOrders
GROUP BY     CustomerID,    customer.name
ORDER BY    CustomerID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T14:09:40.663

据我所知 SQL Server 应该自动消除重复。使用 UNION ALL 将包括重复项。我想 SQL Server 会使用主键来计算出什么是重复的。这些表上的主键是否由相同的数据类型组成，并且您的 p 表中的 ID 1 也是您的 h 表中的 ID 1？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T14:23:18.000

做你正在看的最简单的方法是创建视图（比如“a_orders”和“a_items”）。视图将被定义为：

```
SELECT * FROM p_orders
UNION
SELECT * FROM h_orders 
```

如果在将行插入到 h_orders 时从 a_orders 中删除行（因此给定的订单不会在两个表中），使用 UNION ALL 而不是 UNION 会更有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T15:15:25.587

感谢所有的回复，伙计们。。

Jimmie R. Houts 的“视图方式”和“子查询方式”都可以完美运行，也许视图使用起来更方便......而且它们都应该花费相同的时间（或不？）

因此，我将关于意见的第一个标记为最佳答案。

无论如何，如果可以，请问我使用的结构和索引是否良好或可以优化？

# php - 如何将 URL（其中包含 vars）作为单个 var 发送？

> ID：898026
> 
> 赞同：2
> 
> 时间：2009-05-22T14:06:17.487
> 
> 标签：php, ajax, urlvariables

我有一个这样的 url 字符串：

```
http://www.google.com/cse?cx=017840637368510444960:ny1lmky7r-0&client=google-csbe&output=xml_no_dtd&q=simon+g 
```

我需要将此 url 作为单个字符串变量从 ajax 发送到 php 脚本。

但是我遇到了麻烦，因为由于 url 字符串本身的变量，它一直被分成几个变量。有道理？如何将其作为单个字符串发送？

谢谢！！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T14:10:20.833

您需要对其进行编码。

在 PHP 中：[`urlencode()`](http://www.php.net/urlencode)

```
$str = urlencode('http://....'); 
```

在 Javascript 中：encodeURIComponent

```
str = encodeURIComponent('http://...'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T14:09:24.690

您需要对网址进行[urlencode 。](http://us3.php.net/urlencode)然后，您将在接收它的页面上进行[urldecode](http://us3.php.net/manual/en/function.urldecode.php)。

所以网址会变成

```
http%3A%2F%2Fwww.google.com%2Fcse%3Fcx%3D017840637368510444960%3Any1lmky7r-0%26client%3Dgoogle-csbe%26output%3Dxml_no_dtd%26q%3Dsimon%2Bg%0D%0A 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T14:09:45.250

`escape()`或者`encodeURIComponent()`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T14:11:02.597

我想你需要像这样在 javascript 中进行 escape()

转义（“cx=017840637368510444960:ny1lmky7r-0&client=google-csbe&output=xml_no_dtd&q=simon+g”）

**编辑：**我刚刚搜索并发现 encodeURIComponent() 是最好的解决方案。

请参阅[http://xkr.us/articles/javascript/encode-compare/](http://xkr.us/articles/javascript/encode-compare/)以获得对 escape()、encodeURI() 和 encodeURIComponent() 的一个很好的比较

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T14:21:42.903

```
<?php 
// In your URL-emitter page
$decoded_url = "http://www.google.com/cse?cx=017840637368510444960:ny1lmky7r-0&client=google-csbe&output=xml_no_dtd&q=simon+g";
$link_addr = "/index.php?encodedurl=".urlencode($decoded_url);

echo '<a href="'.$link_addr.'">Click me</a>';

// in your URL-reciever page (here the same page)
if(array_key_exists("encodedurl",$_GET)) {
    echo 'decoded url='.urldecode($_GET["encodedurl"]);
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-22T14:10:00.133

另外，您可以尝试加密（如base64）

# jquery - 使用 django-debug-toolbar 访问 $(document).ready() 中的 jquery 插件的问题

> ID：898040
> 
> 赞同：1
> 
> 时间：2009-05-22T14:08:32.490
> 
> 标签：jquery, django, jquery-plugins

我编写了自己的 jquery 插件，但很惊讶我无法在 $(document).ready 函数中访问它。

我写了这个测试页并且更加惊讶：

```
//jQuery anchor plugin

(function ($) {
    $.anchor = {
        hashTrim: /^.*#/,
    }
})(jQuery);

console.log($.ajax);
console.log($.anchor);

$(function () {
    console.log($.ajax);
    console.log($.anchor);
}); 
```

我在萤火虫控制台中有 4 个完全不同的值。有人知道并且可以描述我为什么会这样吗？主要问题 - 我如何访问 $(function() {} 中的 $.anchor 变量？

谢谢！

**更新：**

我刚刚发现了问题 - django-debug-toolbar。当我禁用它时，一切都会好起来的！

有谁知道如何在 jquery 和 django-debug-toolbar 之间建立友谊？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T14:17:32.787

尝试

```
$.fn.anchor 
```

刚刚测试了您的代码示例，两次结果都是相同的。但总的来说，为了将来扩展**$.fn**，因为它扩展了 jQuery 对象原型。当您只做**$.anchor**时，您只是在扩展该对象的实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T14:17:35.220

我认为应该是：

```
(function($) {
    $.fn.anchor = {
        hashTrim: /^.*#/,
    }
})(jQuery); 
```

**编辑：**

我也两次得到相同的结果，和其他人一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T15:02:49.290

我通过切换到另一个 fork - [alex 的 django_debug_toolbar](http://github.com/alex/django-debug-toolbar/tree/master)部分解决了这个问题。

但我认为它更丑陋，然后是我之前使用[的 david cramer 的 django_debug_toolbar](http://github.com/dcramer/django-debug-toolbar/tree/master)，它包含 jQuery 的这个问题。我希望将来能将避免这个问题的功能从 alex 的分支转移到 dcramer 的分支。

# sql-server - COBOL 到 SQL Server

> ID：898055
> 
> 赞同：1
> 
> 时间：2009-05-22T14:09:59.697
> 
> 标签：sql-server, cobol

谁能指出我从 Fujitsu COBOL 与 SQL Server 对话的方法？与 COM / ActiveX 对话的事件将是一个开始。

非常感谢

尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-13T11:44:39.737

Here is some information that could get you started in another direction. That is using ODBC to connect to SQL Server from COBOL.

[http://www.easysoft.com/applications/micro-focus-cobol/server-express-openesql-odbc.html](http://www.easysoft.com/applications/micro-focus-cobol/server-express-openesql-odbc.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T15:26:40.810

几年前，我使用了一个名为 Transoft U/SQL 的产品，它允许 SQL Server 连接到 Solaris UNIX 机器上的 MicroFocus COBOL 数据，就好像它连接到一个链接服务器一样。

不确定这是否适合您的情况，但也许值得一看。

凯夫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T22:07:32.577

我对COBOL一无所知，但是..如果您可以使用COM，那么也许您可以使用ADO（msado15.dll）或者COBOL是否有自己的OLE DB或ODBC驱动程序。如果是这样，您可以使用它们。但是如果 COM 工作，ADO 肯定值得一看，因为它有大量的方法和属性

# iis - 带有 IPP 和 IIS 的非 PostScript 打印机的 PostScript 接口？

> ID：898059
> 
> 赞同：2
> 
> 时间：2009-05-22T14:10:15.077
> 
> 标签：iis, postscript

是否可以使用 IPP 和 IIS 为本身不支持 PostScript 的打印机提供 PostScript 接口？

此处的目的是为通过 IPP 打印提供通用接口，以便客户端可以在单个驱动程序 (PostScript) 上进行标准化，而不必为不同的打印机下载驱动程序。我可以用 CUPS 做到这一点，但想知道它是否也适用于 IIS。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-11T07:34:53.157

通过 IIS 的 IPP 只能用于作业提交。您仍然需要一个额外的 postscript-renderer 才能打印到不支持 postscript 的打印机。CUPS 带有一组默认过滤器，可以为您完成这项工作。

答：不可能使用 IPP 或 IIS 来提供“通用后记打印机接口”。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-08-19T21:18:50.813

虽然 IPP 使用 HTTP 作为传输，但它是一种不同的协议。如果没有对 IIS 的大量过滤器/扩展，您将无法将其用作 IPP 服务器。

# emacs - 使 php-mode（和其他 cc-mode 派生模式）与 Emacs 23 兼容

> ID：898063
> 
> 赞同：29
> 
> 时间：2009-05-22T14:10:45.653
> 
> 标签：emacs, php-mode, cc-mode

我正在使用 Emacs 23 和[php-mode.el](http://php-mode.sourceforge.net/) 1.5.0。当我有这个时`.emacs`：

```
(require 'php-mode) 
```

当 Emacs 启动时，我收到此错误消息：

> 警告（初始化）：加载“/Users/kdj/.emacs”时出错：
> 
> 错误：必须在文件中使用“c-lang-defconst”
> 
> 为确保正常运行，您应该调查并删除初始化文件中的错误原因。使用 `--debug-init' 选项启动 Emacs 以查看完整的错误回溯。

如果我在 Emacs 启动后进行评估`(require 'php-mode)`，我不会收到任何错误消息。

我发现一个[博客条目](http://atomized.org/2008/12/php-mode-150-is-out/)表明这个问题是 Emacs 23 特有的（也就是说，Emacs 22.x 没有错误），但它没有给出任何解决方案。

我不知道这是否重要，但我使用的是 Mac OS X，并且我从当前的 CVS 源构建 Emacs，使用`./configure --with-ns`.

这里发生了什么，和/或我该如何解决？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-05-27T20:02:04.837

在尝试启动并运行 csharp-mode 时，我遇到了同样的问题。在深入研究 csharp-mode 的实际 Emacs Lisp 文件时，我终于找到了解决方案：

```
;;   This code doesn't seem to work when you compile it, then
;;   load/require in the Emacs file. You will get an error (error
;;   "`c-lang-defconst' must be used in a file") which happens because
;;   cc-mode doesn't think it is in a buffer while loading directly
;;   from the init. However, if you call it based on a file extension,
;;   it works properly. Interestingly enough, this doesn't happen if
;;   you don't byte-compile cc-mode. 
```

因此，放入 .emacs 的快速而肮脏的修复方法是在扩展名上自动加载，而不是放入`(require 'php-mode)`或`(load "php-mode")`放入其中。无需再费周折，

```
(autoload 'php-mode "php-mode" "Major mode for editing php code." t)
(add-to-list 'auto-mode-alist '("\\.php$" . php-mode))
(add-to-list 'auto-mode-alist '("\\.inc$" . php-mode)) 
```

我希望这有帮助！现在我只需要让 PHP/HTML 模式切换的东西工作。祝我好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-16T19:49:23.650

它适用于[http://mewde.googlecode.com/files/php-mode-new.el](http://mewde.googlecode.com/files/php-mode-new.el)。

# sql - 我如何建模这个锯齿状数据？

> ID：898069
> 
> 赞同：2
> 
> 时间：2009-05-22T14:11:33.390
> 
> 标签：sql, jagged-arrays

我负责为一个 3 楼的仓库建模，将存放成箱的文件。方程式中有行、列和架子。

此外：

一些地板/行/列/货架组合存储 2 个盒子，一些 3。

有些行没有正常数量的列。

他们希望我的应用程序自动增加打印标签（一次 20 个），告诉用户扫描它们时盒子的去向。所以扫描框 1 将打印 f1r1c1s1b1 框 2 将打印 f1r1c1s1b2 ... f3r26c26b3

我正在考虑构建一个 MSSql 数据库，用所有可能的组合填充它并减去异常数据。（使用 vb.net2005 for 循环进行填充）然后基于 smalldatetime 或者可能是表上的时间戳列，只需获取下一个没有设置 spotFilled 列的列。

**这行得通吗？有没有更好的办法？**

（下一步是一次屏蔽 20 个，因此 2 个用户可以扫描盒子而不会在同一楼层/行/列上相互碰撞，大多数地板/行/列/货架组合存储 21 个盒子，1 个碰撞可能是好的。他们也希望按照收到的顺序大致相同的盒子）

MSSQL 服务器和 VS2005 已经存在于我的工作环境中，所以这些是我最熟悉的工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:17:08.437

我假设没有简单的模式，所以你可以将整个位置向量映射到一个简单的整数索引？例如，如果它始终是允许 3 个框的第一列，您仍然可以将 f3r26c26s1b3 向量映射为整数。

否则，最好的解决方案可能不是存储每个组合。相反，假设每个架子实际上确实存储了 3 个盒子，并将第三个盒子的“spotFilled”设置为一个虚拟值（-1 左右；除了 NULL=unfill 之外的任何值）。这将使您将其视为正常的矩形阵列。它之所以有效，是因为您的阵列几乎是规则的，但是嘿 - 现实世界的 IT 就是要识别异常的异常

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T15:19:21.803

为什么不只是有一个普通的桌子，就好像它是非锯齿状的（列：Floor, Row, Column, Shelf, Box）；对数据设置适当的界限，以最大限度地减少 db 需要的大小，然后将假盒子存储在假点中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T13:50:20.793

```
Public Function SecondFloor() As List(Of List(Of bDatafield))
    Dim result As New List(Of List(Of bDatafield))
    For Aisle As Short = 1 To MaxAisle
        For Column As Short = 1 To MaxColumn
            If Not SecondFloorExceptions(Aisle, Column) Then
                For shelf As Short = 1 To MaxShelf
                    For Position As Short = 1 To MaxPositions
                        Dim Location As New List(Of bDatafield)
                        Location.Add(MakeNewField("Floor", Floor2))
                        Location.Add(MakeNewField("Aisle", Aisle.ToString))
                        Location.Add(MakeNewField("Column", Column.ToString))
                        Location.Add(MakeNewField("Shelf", shelf.ToString))
                        Location.Add(MakeNewField("Position", Position.ToString))
                        result.Add(Location)
                    Next
                Next

            End If
        Next
    Next
    Return result
End Function

Public Function MakeNewField(ByVal column As String, ByVal value As String) As bDatafield
    MakeNewField = New bDatafield(column, New Nullable(Of Integer))
    MakeNewField.SqlColumnTransformer = New TransformField(AddressOf MapSqlColumn)
    MakeNewField.Value = value
End Function

Public Function SecondFloorExceptions(ByVal Aisle As Short, ByVal column As Short) As Boolean
    If column > MinAisleLength Then
    ElseIf column > MaxColumn Then
        SecondFloorExceptions = True
    Else
        Select Case Aisle
            Case 2 ''//Items with 39
                If column > 39 Then SecondFloorExceptions = True
            Case 3 To 10, 26 To 30, 32 To 38 ''//Items with 41
                If column > 41 Then SecondFloorExceptions = True
            Case 11 ''//Items with 32
                If column > 32 Then SecondFloorExceptions = True
            Case 12, 13 ''//Items with 38
                If column > 38 Then SecondFloorExceptions = True
            Case 14 To 24 ''//Items with 36
                If column > 36 Then SecondFloorExceptions = True
            Case 25, 31 ''//Item with 35
                If column > 35 Then SecondFloorExceptions = True

        End Select
    End If
End Function 
```

然后我将它转储到数据库中：

```
Public Sub InsertLocationRow(ByVal cn As bInheritance.bCnNativeMs _
        , ByVal data As List(Of bDatafield))
    Dim leftSide As String = "insert into " + My.Settings.ProjectSchema + "." + My.Settings.tblLocations + "("
    Dim rightSide As String = " values ("
    Dim first As Boolean = True
    For index As Integer = 0 To data.Count - 1
        If data(index).isValid Then
            If Not first Then
                leftSide += ","
                rightSide += ","
            End If
            leftSide += data(index).SqlColumn()
            rightSide += BLib.AddQSafe(data(index).Value, True)
            first = False
        End If

    Next
    leftSide += ")"
    rightSide += ")"

    cn.ExeNonQuery(leftSide + rightSide)
End Sub 
```

# c++ - 在 C++ 中求解二次方程

> ID：898076
> 
> 赞同：8
> 
> 时间：2009-05-22T14:12:48.410
> 
> 标签：c++, math, equation, quadratic

我正在尝试用 C++ 编写一个函数，该函数使用二次方程求解 X。这是我最初写的，只要没有复数作为答案，它似乎就可以工作：

```
float solution1 = (float)(-1.0 * b) + (sqrt((b * b) - (4 * a * c)));
solution1 = solution1 / (2*a);

cout << "Solution 1: " << solution1 << endl;

float solution2 = (float)(-b) - (sqrt((b*b) - (4 * a * c)));
solution2 = solution2 / (2*a);
cout << "Solution 2: " << solution2; 
```

例如，如果我使用方程：x^2 - x - 6，我会正确地得到解 3, -2。

我的问题是我将如何解释复数....例如，给定等式：

x^2 + 2x + 5

手动求解，我会得到 -1 + 2i，-1 - 2i。

好吧，我猜有两个问题，我可以把上面的写得更好，也可以解释复数吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-22T21:44:10.097

所有这一切的重要说明。这些回复和原始问题中显示的解决方案并不可靠。

*当ac与**b^2*相比非常小时，众所周知的解决方案*(-b +- sqrt(b^2 - 4ac)) / 2a*在计算中是非鲁棒的，因为减去两个非常相似的值。对于另一个根，最好使用鲜为人知的解决方案*2c / (-b -+ sqrt(b^2 -4ac)) 。*

 ***一个稳健的解决方案可以计算为：

```
temp = -0.5 * (b + sign(b) * sqrt(b*b - 4*a*c);
x1 = temp / a;
x2 = c / temp; 
```

使用 sign(b) 确保我们不会减去两个相似的值。

对于 OP，将其修改为复数，如其他海报所示。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T14:26:54.000

像这样的东西会起作用：

```
struct complex { double r,i; }
struct pair<T> { T p1, p2; }

pair<complex> GetResults(double a, double b, double c)
{
  pair<complex> result={0};

  if(a<0.000001)    // ==0
  {
    if(b>0.000001)  // !=0
      result.p1.r=result.p2.r=-c/b;
    else
      if(c>0.00001) throw exception("no solutions");
    return result;
  }

  double delta=b*b-4*a*c;
  if(delta>=0)
  {
    result.p1.r=(-b-sqrt(delta))/2/a;
    result.p2.r=(-b+sqrt(delta))/2/a;
  }
  else
  {
    result.p1.r=result.p2.r=-b/2/a;
    result.p1.i=sqrt(-delta)/2/a;
    result.p2.i=-sqrt(-delta)/2/a;
  }

  return result;
} 
```

这样，您就可以以类似的方式获得真实和复杂结果的结果（真实结果只是将虚部设置为 0）。加了boost会更漂亮！

编辑：修复了 delta 事物并添加了对退化情况的检查，例如 a=0。不眠之夜ftl！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T14:16:08.093

你或多或少有它，只需检查平方根内的部分是否为负，然后在你的减少中单独跟踪它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T14:47:42.973

您基本上可以只使用`std::complex<float>`而不是`float`获得对复数的支持。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T15:05:09.570

从 Blindy 那里得到灵感：

```
typedef std::complex<double> complex;
using std::pair;
pair<complex> GetResults(double a, double b, double c)
{
  double delta=(b*b-4*a*c);
  double inv_2a = 1/2/a;
  if(delta >= 0) {
    double root = sqrt(delta);
    return std::make_pair(
        complex((-b-root)*inv_2a),
        complex((-b+root)*inv_2a);
  } else {
    double root = sqrt(-delta);
    return std::make_pair(
        complex(-b*inv_2a, -root*inv_2a)),
        complex(-b*inv_2a, +root*inv_2a)));
  }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-01T09:13:49.747

我在没有使用“math.h”标头的情况下尝试了该程序，并且还尝试了不同的逻辑......但我的程序只能回答那些具有“x平方”系数的二次方程......并且其中的“x”系数' 可以表示为两个数的加法，这两个数是常数项的因数。例如。x平方+8x+16；x平方+7x+12；等等这里 8=4+4 & 16=4*4; 这里 x 的系数可以表示为两个数的加法，它们是常数项 16 的因数……我自己对此并不完全满意，而是尝试了一些不同的方法，没有使用求解二次方程的公式。代码是；

```
 #include<iostream.h>
        #include<conio.h>
         class quadratic
              {
                int b,c ;
                float l,k;
                public:
               void solution();
              };
        void quadratic::solution()
             {
                 cout<<"Enter coefficient of x and the constant term of the quadratic eqn where coefficient of x square is one";
                 cin>>b>>c;

                 for(l=1;l<b;l++)
                  {
                   for(k=1;k<b;k++)
                    {
                     if(l+k==b&&l*k==c)
                        {
                          cout<<"x="<<-l<<"\t"<<"or"<<"\t"<<"x="<<-k;
                          cout<<"\n";
                         }
                    }
                }
            }
              void main()
                 {
                  quadratic a;
                   clrscr();
                  a.solution();
                  getch();
                 } 
```

# workflow-foundation - 我应该通过 ExternalDataExchange 还是使用 WCF 与我的 Windows 工作流主机通信？

> ID：898079
> 
> 赞同：1
> 
> 时间：2009-05-22T14:13:55.337
> 
> 标签：workflow-foundation

我知道我可以使用接口上的 ExternalDataExchange 与我的 Windows 工作流主机（从我的工作流）进行通信。或者我可以使用 .NET 3.5 提供的 SendActivity 使用 WCF 与我的主机通信。

我不确定我应该选择哪种方法。关于这些方法的优缺点有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T14:19:54.620

在我们的应用程序中，我们使用 IIS 应用程序池中的 WF。至于通信，我们使用 WCF（SendActivities 或基于合约的自定义代理）。只要您可以引用程序集，它就像一个魅力。

如果您想与 WF 主机通信，您很可能需要编写更多代码。

# iphone - 使用 NSUserDefaults 存储 iPhone 应用程序的最新状态是个好主意吗？

> ID：898080
> 
> 赞同：4
> 
> 时间：2009-05-22T14:14:01.793
> 
> 标签：iphone, cocoa-touch, uikit, nsuserdefaults

我有一个基于视图的应用程序，用户可以在其中进行很多自定义操作，例如选择颜色、选择图片等。

首先，我考虑过为此使用 sqlite3，但由于这会导致表只有一行（没有多用户应用程序），这对我来说似乎是一个很大的开销。然后我听说了 NSUserDefaults。但我不确定这些数据存储在哪里。它是否存储在应用程序的沙箱中？还是存储在其他地方？其他应用程序是否有权访问该数据？记住这种定制的东西有好处吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T14:20:45.900

该类[`NSUserDefaults`](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)用于存储应用程序的用户首选项。它存储在应用程序沙箱`Library`目录中的 plist 文件中。

```
[[NSUserDefaults standardUserDefaults] setObject:@"Test" forKey:@"myPref"];
NSString *val = [[NSUserDefaults standardUserDefaults] stringforKey:@"myPref"]; 
```

# ms-access - 根据当前记录计算对子表单的控制

> ID：898081
> 
> 赞同：3
> 
> 时间：2009-05-22T14:14:06.023
> 
> 标签：ms-access, cumulative-sum

我有以下内容：“客户”表中的主表单“客户”。子表格“发票”，带有“发票日期”、“发票金额”、“客户 ID”等字段，来自“发票”表

每当用户单击或转到“发票”子表单中的记录时。我想要一个“到目前为止的总数”控件来计算“发票金额”的总和，直到当前记录被“点击”或选择的日期。

即对于带有发票的客户 microsoft：1) 09 年 5 月 2 日，150 美元 2) 09 年 5 月 3 日，200 美元 3) 09 年 5 月 4 日，500 美元

如果用户点击记录 2)，“total so far”应该显示 $350 如果用户点击记录 1)，“total so far”应该显示 $150 如果用户点击记录 3)，“total so far”应该显示 $850

目前，我在子表单“发票”中的事件“OnCurrent”上使用 DSum 函数来设置“到目前为止的总计”值。这种方法慢，效率低吗？

还有其他更简单、更干净、更优雅、更快、更高效的使用 ms 访问功能的方法吗？

无论单击哪条记录，我都希望“发票”子表单显示该客户的所有发票。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:43:44.550

如果 DSum 方法适合您，请使用它。

如果它太慢，那么另一种方法是使用记录克隆并循环记录。这是更多的代码，但它更有效，因为它不必访问数据库。您确实需要一个唯一的密钥。

```
Private Sub Form_Current()

  Dim rst As DAO.Recordset
  Dim subTotal As Currency
  Dim rec_id As Long

  'get clone of current records in subform'
  Set rst = Me.RecordsetClone

  'save current record id'
  rec_id = Me.rec_id

  rst.MoveFirst

  'loop and total until current is reached'
  Do Until rst![rec_id] = rec_id
    subTotal = subTotal + rst![InvoiceAmt]
    rst.MoveNext
  Loop

  'add last amount on current record' 
  subTotal = subTotal + rst![InvoiceAmt]

  Set rst = Nothing

  'set text box with subtotal'
  Me.Text2 = subTotal

End Sub 
```

另一种方法是使用 sum() 构建一个 sql 查询，但这需要更多代码并再次访问数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-05T12:37:31.850

您可以在子窗体的页脚中放置一个带有 Dsum 的隐藏控件，然后从主窗体中引用该控件。Dsum 将有其第三个参数，例如`"InvoiceId <= " & InvoiceId`

在这种情况下不需要任何 VBA/事件。

# c# - 适当使用自定义属性？

> ID：898082
> 
> 赞同：4
> 
> 时间：2009-05-22T14:14:07.690
> 
> 标签：c#, .net, performance, reflection, attributes

我有一个 DataContract 类，我必须用我们公司的 Active Directory 中的值填充它。

```
[DataContract(Namespace = Global.Namespace)]
public class UserProfile
{
    [DataMember(IsRequired = true, EmitDefaultValue = false)]
    public string EmployeeID { get; private set; }

    [DataMember(IsRequired = true, EmitDefaultValue = false)]
    public string GivenName { get; private set; }

    ...

    public static readonly string[] PropertiesToLoad = new[] { "EmployeeID", "GivenName" };
} 
```

我正在考虑制作一个自定义属性来装饰我的属性，以便从 AD 填充我的对象的代码不需要对映射进行硬编码，而是我可以只装饰属性以自动填充对象。

从长远来看，我也许还可以摆脱这个“PropertiesToLoad”。你认为属性是解决这个问题的好方法吗？还有一个问题，如果我确实通过属性解决了这个问题，我是否可能会造成巨大的性能瓶颈，或者使用属性是否真的不是性能问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T14:29:22.107

使用反射和属性*比*编译为 IL 的常规 C# 慢，但问题是：你做了多少？如果你没有做**很多**这样的事情，你就不会注意到它。

有一些方法可以提高反射的性能，但它们是相当先进的。

这似乎是一种指定映射的合理方式（并且可以与大多数序列化和持久性框架相媲美——尽管通常也提供一个没有属性的单独 API）。

对于（不）适当的用途，请参阅[Eric Lippert 的博客](http://blogs.msdn.com/ericlippert/archive/2009/02/02/properties-vs-attributes.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T14:33:35.903

我喜欢使用属性来解决这种问题，因为它有助于在代码中清楚地表明该属性正在以某种方式使用。在将 PropertiesToLoad 放在一个地方（如上面的示例中）或在属性声明点之间进行权衡。我倾向于发现使用属性有助于代码维护，因为如果属性被删除或修改，我不必寻找更改。

至于性能，是的，它会导致性能下降，但不会很大。它是可测量的，但除非这是性能关键代码，否则您可能不会注意到。即使在那个时候，我猜你会发现更大的问题。如果属性反射成为问题，有办法通过使用缓存或其他方法来减轻性能影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T15:59:33.750

我最终编写了以下代码。

```
public class UserProfile
{
    [DataMember(IsRequired = true, EmitDefaultValue = false)]
    [ActiveDirectoryProperty]
    public string EmployeeID { get; set; }

    [DataMember(IsRequired = true, EmitDefaultValue = false)]
    [ActiveDirectoryProperty]
    public string GivenName { get; set; }

    [DataMember(IsRequired = true, EmitDefaultValue = false)]
    [ActiveDirectoryProperty("SN")]
    public string Surname { get; set; }

    [DataMember(IsRequired = true, EmitDefaultValue = false)]
    [ActiveDirectoryProperty]
    public string Company { get; set; }

    [DataMember(IsRequired = true, EmitDefaultValue = false)]
    [ActiveDirectoryProperty]
    public string Department { get; set; }

    [DataMember(IsRequired = true, EmitDefaultValue = false)]
    [ActiveDirectoryProperty("CN")]
    public string UserName { get; set; }

    [DataMember(IsRequired = true, EmitDefaultValue = false)]
    [ActiveDirectoryProperty("Mail")]
    public string Email { get; set; }

    [DataMember(IsRequired = true, EmitDefaultValue = false)]
    [ActiveDirectoryProperty]
    public LanguageType Language { get; set; }

    [DataMember(IsRequired = true, EmitDefaultValue = false)]
    public DateTime? NextPasswordChangeDate { get; set; }
} 
```

然后我可以使用反射来获取旧的“PropertiesToLoad”，它本身几乎是无害的，因为在那之后我只使用一次反射来填充数组，我不再需要调用 GetProperties。

唯一需要测试的是，如果我可以足够快地从 SearchResult 中填充对象 - 但是，tbh，AD 查询通常比一些内存操作慢得多，所以我期待结果。:)

# php - php中的unicode

> ID：898091
> 
> 赞同：1
> 
> 时间：2009-05-22T14:15:57.937
> 
> 标签：php, unicode, ascii

我之前读过 Spolsky 的关于字符编码的文章，以及[从潜入 python 3](http://diveintopython3.org/strings.html)中的这篇文章。我知道 php 在某些时候会使用 Unicode，但我无法理解为什么这很重要。

如果正在使用 php-CLI，那是有道理的。但是，在 Web 服务器世界中，浏览器是否可以获取这个整数并将其转换为字符（基于字符编码）。

我没有得到什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T14:59:10.767

PHP 确实“支持”UTF8，请查看 mbstring [1](http://uk2.php.net/mbstring)扩展名。大多数问题来自在处理 UTF8 数据时不使用 mb* 函数的 PHP 开发人员。

UTF8 字符通常不止一个字符，因此您需要使用能够理解这一事实的函数，例如 mb_strpos [2](http://uk2.php.net/manual/en/function.mb-strpos.php)而不是 strpos [3](http://uk2.php.net/manual/en/function.strpos.php)。

如果您从浏览器获取 UTF8 -> 放入数据库 -> 将其取出 -> 将其显示给用户，则它工作正常。如果您正在做更多涉及 UTF8 数据（或任何主要文本处理）的事情，您可能应该考虑使用替代语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T14:46:07.703

PHP 字符串函数通常将字符串视为 8 字节字符序列。我在通过字符串函数时遇到了各种各样的中文文本问题。`substr()`例如，可以将一个多字节字符切成两半，这会给 XML 解析器带来各种问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T14:19:12.453

好吧，一方面，您需要以某种方式生成浏览器显示的字符串:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T14:19:39.380

这里有一个很棒的关于 Unicode 和 Web 的常见问题解答部分[。](http://unicode.org/faq/unicode_web.html)看看它是否回答了你的一些问题。

# sharepoint - Sharepoint WSP 解决方案和页面 URL

> ID：898094
> 
> 赞同：0
> 
> 时间：2009-05-22T14:16:28.340
> 
> 标签：sharepoint, moss, wss

我一直在玩 wsp 解决方案，我想到了一个关于如何从 sharepoint Web 应用程序中访问位于文件系统上的 aspx 文件的问题。例如，这是我的 Visual Studio Explorer 视图……</p>

[替代文字 http://abbeylegal.com/downloads/alp%20solution%20image.jpg](http://abbeylegal.com/downloads/alp%20solution%20image.jpg)

你可以看到我创建的 aspx 文件，当我在我的 sharepoint Web 应用程序中浏览到这个文件时，URL 是

[http://example.org/alplogin.aspx](http://example.org/alplogin.aspx)

如果我希望通过更深的 URL 访问此网页怎么办……</p>

例如[http://example.org/adminstration/servererrrors/alplogin.aspx](http://example.org/adminstration/servererrrors/alplogin.aspx)

我是否需要使用我的 Visual Studio 解决方案创建这些虚拟文件夹，以便一对一映射到我想要的更深的共享点 Web 应用程序 URL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T14:49:46.120

您的功能元素清单中的“模块”元素应该描述这一点。此外，如果您希望将文件部署得“更深”，您可能希望确保您的功能的范围为“Web”。然后，为特定 SharePoint 网站激活您的功能将导致您的文件被部署为该网站中的页面。

[我认为，名为How to: Provision a file](http://msdn.microsoft.com/en-us/library/ms441170.aspx)的 MSDN 页面涵盖了这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T14:37:29.907

检查您的 elements.xml 文件。您可以在此处指定部署 aspx 页面的位置。

# visual-studio - VS2005 - 从单独的项目中调用方法？（相同的解决方案）

> ID：898096
> 
> 赞同：0
> 
> 时间：2009-05-22T14:16:49.107
> 
> 标签：visual-studio

我在 VS2005 的同一解决方案中从单独的项目调用方法时遇到问题。我只是愚蠢还是我在这里遗漏了什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T14:22:57.360

您是否在当前项目中添加了对单独项目的引用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T14:40:12.537

还要检查您的访问修饰符。需要声明包含您尝试调用的方法的类`public`。

如果您未指定访问修饰符，则该类默认为`internal`这意味着它只能被同一程序集中的代码访问。

（我假设 C#）

# java - 将数据从休眠层拉到另一层的最佳方法是什么？

> ID：898121
> 
> 赞同：2
> 
> 时间：2009-05-22T14:21:19.643
> 
> 标签：java, hibernate, spring, migration

正如我以前的帖子可以证明的那样，我正在改进内存中的网络缓存性能，以适应曾经完全休眠的场景。在这样做时，我遇到了处理代理对象并需要重新附加到会话的问题，但在这样做时，我还想保持可交易性。将复杂逻辑移出休眠层的最佳实践是什么？我现在刚刚“完全”进入休眠状态，所以这是一种相当可恶的经历。

任何从事过这种数据移动的人都可以详细说明您是如何克服事务问题、处理代理对象等的吗？我现在只是在寻找一般资源，因为我正在努力游泳。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T16:19:13.967

你需要决定两件事：

*   您的会话管理策略
*   您关联的抓取策略

Gavin King有一篇很好[的文章](http://blog.hibernate.org/Bloggers/Everyone/Year/2004/Month/01/Day/27#perf-problems)解释了处理会话的一些选项（这篇文章是关于性能的，但通常也适用）。

至于获取，要考虑的一件事是增加 Hibernate 层可用的原语数量。例如，假设您有一个与 Bar 具有 1-N 关系的实体 Foo，在某些情况下您只需要 Foo 对象，但在其他情况下您需要 Foos 和子 Bar 对象。您可以将它们表示为对 Hibernate 层的单独调用。

```
class HibernateLayer {
    public List<Foo> findFoo(String someCriteria) {
        Query q = new Query("from Foo f where f.someCriteria = :1");
        //...
    }

    public List<Foo> findFooWithBars(String someCriteria) {
        Query q = new Query("from Foo f left join fetch Bar b where f.someCriteria = :1");
        //...
    } 
```

这有 2 个好处，1 您不会处理延迟加载的代理对象，您将拥有所需的所有数据，并且它会执行得更好，因为生成的 SQL 将更适合这种情况。然而，它有一个缺点，您需要在调用 Hibernate 层之前知道您是否需要更深层次的数据。为了确保您的数据保持一致（事务的主要目的），请确保您至少使用[乐观锁定。](http://docs.jboss.org/hibernate/stable/core/reference/en/html/transactions-optimistic.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T15:09:24.897

我认为您指的是“修改分离的对象”的做法？通常这是使用 session.merge() API 完成的。

见：[http ://docs.jboss.org/hibernate/stable/core/reference/en/html_single/#objectstate-detached](http://docs.jboss.org/hibernate/stable/core/reference/en/html_single/#objectstate-detached)

高温高压

# visual-studio-2008 - 视觉工作室 2008 主题

> ID：898122
> 
> 赞同：1
> 
> 时间：2009-05-22T14:21:27.740
> 
> 标签：visual-studio-2008

我刚刚进入视觉工作室主题来为我的 ide 着色。我找到了一个我非常喜欢的，但问题是它改变了我经常使用的大纲 +/- 的大小。你如何增加这个的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T17:47:01.253

我相信框的大小是由环境根据您的字体大小设置的。实际上，更准确地说，它被设置为一行代码的高度。我查看了可以在字体和颜色窗口中个性化的不同项目，并没有看到任何改变该框大小的内容。

当然，通过更改我的字体大小，框会随着它所在行的高度而缩放。更大的字体大小 = 更高的行 = 更大的框。反之亦然。

# wpf - 为添加到 XamDataGrid 的新记录的背景设置动画

> ID：898128
> 
> 赞同：1
> 
> 时间：2009-05-22T14:22:21.513
> 
> 标签：wpf, mvvm, infragistics

好的，我花了 2 天时间试图弄清楚如何做到这一点，并且到目前为止已经获得了“失败”的分数。

设计是这样的：

1.  ViewModel 类公开了一个名为 People 的公共 ObservableCollection 属性。
2.  XAML 视图绑定到此属性

期望的行为是这样的：

1.  向 ViewModel 的集合中添加一个新的 Person
2.  当新记录出现在 XamDataGrid 中时，视图会为新记录的背景设置动画，基本上会以红色闪烁 2 秒。

我尝试将 grid 的 InitializeRecord 挂接到 EventTrigger 的 RoutedEvent 属性中，但无济于事。（事件名称无效，所以我认为这不是 RoutedEvent）

此外，由于我试图尽可能保持 MVVM，因此我想避免任何需要代码隐藏更改的解决方案。请仅使用 XAML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-10T09:32:48.980

向您的 People 类添加一个属性，例如 newRow。然后使用 newRow 属性上的数据触发器将新样式应用于 CellValuePresenter，将其背景颜色更改为您喜欢的任何颜色。在内部，您可以更改 newRow 的值以禁用触发器。

```
 <DataTrigger Binding="{Binding .DataItem[IsRecentUpdate]}" Value="True">
      <Setter Property="Background" Value="#FFFFE87C" />
      <Setter Property="BackgroundHover" Value="#FFFFE87C" />
      <Setter Property="BackgroundActive" Value="#FFFFE87C" />
      <Setter Property="BackgroundSelected" Value="#FFFFE87C" />
    </DataTrigger> 
```

# c# - C# 轻松创建 yyyy-mm-dd 目录

> ID：898133
> 
> 赞同：0
> 
> 时间：2009-05-22T14:23:06.800
> 
> 标签：c#

我应该如何轻松创建 yyyy/mm/dd 目录？
mysite.com/blog**/2009/01/01/**hello-world.aspx！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T14:29:01.263

```
String.Format(CultureInfo.InvariantCulture, 
              "mysite.com/blog**/{0:yyyy/MM/dd}/**hello-world.aspx", 
              DateTime.Now) 
```

会给你日期。您可以为其添加更多参数以使其恰到好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T14:34:02.127

使用 Uri 类将 url 组合在一起并使用 / 将 \ 字符转义为显式而不是文化日期分隔符。

```
Uri oSiteBase = new Uri("http://mysite.com/blog");
Uri oSiteDay = new Uri(oSiteBase, DateTime.Now.ToString("yyyy\/MM\/dd")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T14:34:04.110

杰夫答案的变体：

```
String foo = "mysite.com/blog/" + DateTime.Now.ToString("yyyy\/mm\/dd") + "/hello-world.aspx"; 
```

# python - Python 3 C API 中的文件 I/O

> ID：898136
> 
> 赞同：10
> 
> 时间：2009-05-22T14:23:39.903
> 
> 标签：python, python-3.x, python-c-api

Python 3.0 中的 C API 已更改（弃用）文件对象的许多函数。

之前，在 2.X 中，您可以使用

```
PyObject* PyFile_FromString(char *filename, char *mode) 
```

创建一个 Python 文件对象，例如：

```
PyObject *myFile = PyFile_FromString("test.txt", "r"); 
```

...但是这样的功能在 Python 3.0 中不再存在。与这种调用等效的 Python 3.0 是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-23T05:21:37.050

您可以通过调用 io 模块以旧的（新的？）方式来实现。

此代码有效，但不进行错误检查。有关说明，请参阅文档。

```
PyObject *ioMod, *openedFile;

PyGILState_STATE gilState = PyGILState_Ensure();

ioMod = PyImport_ImportModule("io");

openedFile = PyObject_CallMethod(ioMod, "open", "ss", "foo.txt", "wb");
Py_DECREF(ioMod);

PyObject_CallMethod(openedFile, "write", "y", "Written from Python C API!\n");
PyObject_CallMethod(openedFile, "flush", NULL);
PyObject_CallMethod(openedFile, "close", NULL);
Py_DECREF(openedFile);

PyGILState_Release(gilState);
Py_Finalize(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T14:32:28.637

[此页面](http://docs.python.org/3.0/c-api/file.html)声称 API 是：

```
PyFile_FromFd(int fd, char *name, char *mode, int buffering, char *encoding, char *newline, int closefd); 
```

不确定这是否意味着无法让 Python 从文件名打开文件，但在 C 语言中，这对你自己来说应该是微不足道的。

# scripting - vmware - 脚本自动备份

> ID：898141
> 
> 赞同：2
> 
> 时间：2009-05-22T14:24:58.120
> 
> 标签：scripting, automation, backup, vmware, vmware-tools

我在 WinXP 上运行**VMWare Workstation 6.5 。**

如何*编写脚本*来自动克隆我的 VM 映像？

我已经阅读了有关“ `vmware-cmd`”工具的信息，但相信它仅适用于 VMWare ESX，不适用于 Workstation。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T23:33:29.693

由于 VMWare 映像只是磁盘上的文件，因此您可以只使用 XCOPY。下次运行 VM 时，系统会提示您询问您是移动还是复制了 VM。确保选择复制以确保为克隆的 VM 网卡分配不同的硬件 MAC 地址。

```
XCOPY /S /I WinXP WinXPClone 
```

如果您的客人是基于 Windows 的机器，请确保您在克隆上生成新的 SID。[如果您只是为了个人用途进行克隆， Sysprep](http://support.microsoft.com/kb/302577)会很痛苦，一个更快更简单的方法是使用[NewSID](http://technet.microsoft.com/en-us/sysinternals/bb897418.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T23:52:40.733

vmrun 将做 vmware-cmd 所做的事情。它存在于 ESX、Workstation 和 Server 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-12T16:54:13.437

我认为在 vSphere 中备份虚拟机时，使用脚本是一种不好的方法，我以前做过这种方法，但在移动虚拟机时遇到了麻烦，而有些机器有依赖关系，或者有人留下了虚拟磁盘仍然连接到克隆的机器。我认为您最好使用免费的 vMware 数据保护，这样做的缺点是您需要推荐 1.5TB 的可用空间，但其好处是牺牲存储空间

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-23T10:42:23.327

您可以尝试 PowerShell 脚本

```
Param( 
    [Parameter(Position=0,Mandatory=$true,HelpMessage="What Environment do you want exported?")]
    [ValidateSet("VCAC","IDENT","IAAS","ORCH","VCENTER","CA","DC","ALL")]
    [String[]]$vmExports)

###connect to server statement -- add later
if ( (Get-PSSnapin -Name VMware.VimAutomation.Core -ErrorAction SilentlyContinue) -eq $null )
{
    Add-PSsnapin VMware.VimAutomation.Core
}

if ($vmExports -Contains "ALL" )
{
    $vmExports = ("VCENTER")

}

function exportova ([string[]]$servers) 
{
    foreach($server in $servers)
        {

        $date = Get-Date -format MMddyyyy
        $datastore = ''
        $VMhost = ''
        $newVMName = $server+'_'+$date
        $my_vm = New-VM -Name $newVMName -VM $server -Datastore $datastore -VMHost $VMhost
        Export-VApp -Destination "E:\VMs\" -VM $newVMName -Format Ova
        Remove-VM $newVMName -DeletePermanently -Confirm:$false

        }

}

switch ($vmExports)

{

    "VCENTER"
        {

        $servers= ("")
        exportova $servers

        }       
} 
```

# c# - 在 ASP.NET 中，如何让浏览器将字符串内容下载到文件中？（C＃）

> ID：898145
> 
> 赞同：5
> 
> 时间：2009-05-22T14:27:50.470
> 
> 标签：c#, asp.net, file, csv, export

我想从 ASP.NET 应用程序创建一个用于导出/下载的文本文件，例如 *.csv。我知道[Response.TransmitFile](http://msdn.microsoft.com/en-us/library/12s31dhy.aspx)，但我想这样做而不在服务器上物理创建和保存文件。那可能吗？有没有人做过类似的事情？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T14:32:17.000

当您说“创建要导出的文件”时，我理解您希望将其下载到浏览器。如果是这样，这里有一个例子。

```
public void btnGo_Click (Object sender, EventArgs e)
{
    Response.Clear();

    string fileName= String.Format("data-{0}.csv", DateTime.Now.ToString("yyyy-MMM-dd-HHmmss")); 
    Response.ContentType = "text/csv";
    Response.AddHeader("content-disposition", "filename=" + fileName);

    // write string data to Response.OutputStream here
    Response.Write("aaa,bbb,ccc\n");

    Response.End();
} 
```

引用：[RFC 4180](http://www.rfc-editor.org/rfc/rfc4180.txt)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T14:35:11.953

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T14:31:06.080

您尚未保存的文件只是一个字符串变量或 MemoryStream。但是对于大量数据，您可能不想将其全部保存在内存中。一旦你有了这个“文件”，你想做什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T14:32:47.263

您可以直接写入[Response.OutputStream](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.outputstream.aspx)并设置正确的内容类型和内容处置标头。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T14:34:29.913

哦，那还不错。在您的 ASPX 页面的 Page_Load 中执行以下操作：

```
Response.ContentType = "text/xml";
Response.ContentEncoding = System.Text.Encoding.UTF8;
Response.Write(/* your text goes here */); 
```

以上是一个示例，如果您的“文件”是 xml，但它可以是任何东西，从 excel 文件到 pdf。您所要做的就是更新您可以通过 Google 或 Live 查找的 ContentType。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T14:34:56.993

试试这个示例：

```
protected void Button1_Click(object sender, EventArgs e)
{
     Response.ContentType = "text/csv";
     Response.AddHeader("content-disposition", "attachment; filename=download.csv");
     Response.Write("your,csv,file,contents");
     Response.End();
} 
```

# security - 如何在 HTTPSession 中使用未加密的密码重定向到 logon.jsp？

> ID：898148
> 
> 赞同：0
> 
> 时间：2009-05-22T14:29:37.817
> 
> 标签：security, authentication, jsp, session, jakarta-ee

我有一个使用基于 JAAS 表单的身份验证的 j2ee Web 应用程序。但是，由于一些不寻常的要求，我不能让用户直接在 logon.jsp 表单中输入他们的用户名和密码并让他们提交。相反，我必须在单独的页面上收集数据，然后再重定向到 logon.jsp 以将它们登录。

我想做的是将未加密的用户名/密码存储在 HTTPSession 中。当我准备好进行身份验证时，我使用 response.redirect 路由到 logon.jsp。在 logon.jsp 中，我从 Session 中取出用户名和密码，填充标准的“j-security-check”表单，然后使用 javascript 提交表单。

这是多大的安全漏洞？我不愿意通过浏览器将请求路由到 logon.jsp（这就是重定向的作用），因为有人可能会访问会话，因此会获得未加密的密码。如果我使用的是 HTTPS / SSL，这可能吗？它将如何被利用？

我考虑在不使用表单的情况下直接在 JSP 中调用登录 servlet，但这似乎不是一个可行的选择，特别是因为我失去了与不同 J2EE 容器/应用程序服务器的隔离。

有人知道如何限制这个安全漏洞吗？使用转发而不是重定向会更好，因为它不会返回浏览器吗？

这有多糟糕？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T15:19:53.217

似乎很容易将这种做法描述为可怕的，但要解释*为什么*它是可怕的，或者在使用 SSL 的情况下如何利用它则要困难得多。我们一直把敏感信息放在 HTTPS / SSL 手中，我看不出这有什么不同。

最佳实践是在不必要时避免与浏览器交互。您必须管理安全性和可用性之间的回报，评估您的应用程序要求和敏感性，并采取相应的行动。

无论如何，使用转发而不是重定向将阻止浏览器参与，因为转发是在 Web 层内部执行的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T14:34:24.000

听起来您正在将密码发送回用户，以便用户可以将表单重新提交给真正的 login.jsp。这听起来对我来说是可怕的地球战场。假设用户在输入用户名后输入密码，密码表单不能简单地直接提交给登录处理程序吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-22T14:38:31.433

天啊。密码安全的第一条规则是永远不要以明文形式传输密码。如果您以明文形式将其存储在会话中，这意味着您可能会以明文形式将密码从用户发送到您的服务器（除非您使用的是我*强烈*建议的 SSL）。这意味着任何数据包嗅探器都可以找到密码。至于以明文形式将它们存储在会话中，这意味着您很容易受到会话劫持。

换句话说。太**可怕了**。不要这样做。

# php - PHP 正则表达式问题

> ID：898150
> 
> 赞同：1
> 
> 时间：2009-05-22T14:30:18.063
> 
> 标签：php, regex

我在网络文档中有一系列网址，如下所示：

```
<a href="somepage.php?x=some_document.htm">click here</a> 
```

我想要做的是替换粗体：

<a **href="somepage.php?x= some_document.htm** ">点击这里</a>

.. 带有某种加密变体（让我们说 base64_encoding）.. 像这样：

**对于每场比赛，将其转换为 base64_encode(match)**

**笔记：**

1\. 短语**href="somepage.php?x=**将始终位于短语之前。
2\. 双引号 ( **"** ) 将始终跟随在短语之后。

我不是正则表达式大师——但我知道你们中的一些人是。有什么简单的方法可以做到这一点？

**更新：**

我通过使用 Chris 提交的修改版本解决了这个问题，这里是：

```
function encrypt_param( $in_matches ) {    
  return   'href="somepage.php?x=' . base64_encode( $in_matches[1] ) . '"';
}

$webdoc = preg_replace_callback( '/href="somepage.php\?x=([^"]+)"/',
                                 'encrypt_param', 
                                 $webdoc ); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T14:41:46.667

我想你正在寻找这样的东西：

```
function doSomething($matches) {
   return base64_encode($matches[1]);
}

preg_replace_callback('/href="somepage.php?x=([^"]+)"/', 'doSomething', $webdoc); 
```

`preg_replace`答案类似。如果您想做更精细的事情，回调将允许您这样做

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T14:41:37.603

我会考虑使用 PHP [DOM](http://us3.php.net/dom)解析器。任何少的东西都是黑客。（并不是说黑客总是不好的，只要知道简单的正则表达式和 DOM 解析器之间的区别。）`getElementsByTagName()`会得到你的 <a> 标签，`getAttribute()`会得到你的 href 属性，并`setAttribute()`修改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T14:41:41.363

`preg_replace('/href="somepage.php\?x=([^"]*)"/e', "somepage.php?x='.base64_encode("$1").'"', $url)`

（未测试）。/e 表示您可以在替换字符串中使用表达式

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T14:53:02.403

似乎您可能将多步骤任务混为一谈，从长远来看，这最终可能会造成更多麻烦。你基本上想做三件事：

1.  查找页面上的所有锚标记
2.  从这些标签中提取 href 属性中的 URL
3.  从该 URL 中提取查询字符串中的特定变量

在 PHP 中有很多方法可以做到这一点。是的，一种直接的方法是使用正则表达式，但它不太透明。对于这种特殊情况，您实际上是在拟合一个非常小的问题，降低了代码在未来应用程序中的可伸缩性。

我的建议是实现 Source Forge 提供的轻型 DOM 解析器，称为[SimpleHTMLDom](http://simplehtmldom.sourceforge.net/)。使用此解析器，您可以为正在执行的任务编写更清晰的代码。

```
foreach ($dom_object->find('a') as $anchor){
    $url = $anchor->href;
    $queryArray = array();
    parse_str(parse_url($url, PHP_URL_QUERY), $queryArray);
    $myVariable = $queryArr['x'];
} 
```

然后当然 $myVariable 将是您希望通过该正则表达式获得的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T15:05:53.140

正则表达式根本不擅长解析 HTML（请参阅[您能否提供一些示例，说明为什么用正则表达式解析 XML 和 HTML 很困难？](https://stackoverflow.com/questions/701166)为什么）。您需要的是一个 HTML 解析器。请参阅[您能否提供一个使用您最喜欢的解析器解析 HTML 的示例？](https://stackoverflow.com/questions/773340)对于使用各种解析器的示例。

# c# - C#：列表的继承问题

> ID：898152
> 
> 赞同：5
> 
> 时间：2009-05-22T14:30:51.510
> 
> 标签：c#, .net, inheritance, list

让我们假设这个类在 C# 中：

```
public class LimitedList<T> : List<T>
{
    private int _maxitems = 500;

    public void Add(T value) /* Adding a new Value to the buffer */
    {
        base.Add(value);
        TrimData(); /* Delete old data if lenght too long */
    }

    private void TrimData()
    {
        int num = Math.Max(0, base.Count - _maxitems);
        base.RemoveRange(0, num);
    }
} 
```

编译器在“public void Add(T value)”行中给了我这个警告：

> 警告 CS0108：“System.LimitedList.Add(T)”隐藏了继承的成员“System.Collections.Generic.List.Add(T)”。如果打算隐藏，请使用 new 关键字。

我该怎么做才能避免这个警告？

谢谢 4 你的帮助

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T14:35:40.347

不 -**不要**在这里使用`new`；这不会给你多态性。`List<T>`不打算以这种方式继承；用途`Collection<T>`和方法`override`。~~`Add`~~ `InsertItem`

```
public class LimitedCollection<T> : Collection<T>
{
    private int _maxitems = 500;

    protected override void InsertItem(int index, T item)
    {
        base.InsertItem(index, item);
        TrimData(); /* Delete old data if lenght too long */
    }

    private void TrimData()
    {
        int num = Math.Max(0, base.Count - _maxitems);
        while (num > 0)
        {
            base.RemoveAt(0);
            num--;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-22T14:33:34.110

您可以通过在声明中添加“new”来避免此警告。

```
public new void Add(T value) { 
 ...
} 
```

但是我认为您可能通过使用继承来解决这个问题有点错误。从我的角度来看，LimitedList 不是一个列表，因为它表达了非常不同的行为，因为它对列表中的数据量施加了严格的限制。我认为不从 List 继承但将 List 作为成员变量会更好。

这是一个坏主意的另一个原因是，当您将课程视为列表时，您将无法满足您的课程合同。以下代码将使用 List 的 Add 方法，而不是 LimitedList。

```
List<int> list = new LimitedList<int>(10);
for ( i = 0; i < 10000; i++ ) {
  list.Add(i);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T14:35:46.197

您需要将“添加”方法声明为“新”（替换）方法。尝试这个：

```
public class LimitedList<T> : List<T>
{
    private int _maxitems = 500;

    public new void Add(T value) /* Adding a new Value to the buffer */
    {
        base.Add(value);
        TrimData(); /* Delete old data if length too long */
    }

    private void TrimData()
    {
        int num = Math.Max(0, base.Count - _maxitems);
        base.RemoveRange(0, num);
    }
} 
```

注意 'Add(...' 声明中的 'new' 关键字。

**尽管在这种情况下，您应该创建自己的通用类来实现 IList 接口。** 希望有帮助。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-22T14:40:24.907

正如其他人所说，您需要添加新的关键字。这是因为在基类 (List<T>) 中，Add 方法没有用关键字“virtual”标记，这基本上意味着“可覆盖”。因此，应将其标记为“新”。

# php - 如何在 CakePHP 中获取控制器名称列表以验证用户数据？

> ID：898159
> 
> 赞同：3
> 
> 时间：2009-05-22T14:32:24.020
> 
> 标签：php, cakephp

我正在为客户构建一个 CakePHP 站点，但遇到了一个有趣的问题。他们想添加一个新功能，用户可以使用这种类型的 URL 在站点内创建自己的登录页面：`http://mainsite.com/username`. 由于这是一个 Cake 站点，因此有很多值`username`会导致各种路由疯狂，特别是如果他们碰巧选择了与站点内的控制器相同的用户名。

我的方法是这样的：在`beforeValidate`用户控制器的函数中，根据所有控制器名称的列表检查提供的用户名，`false`如果匹配则返回。我的问题是 - 如何获得所有控制器名称的列表（实际上没有循环遍历 中的文件`/app/controllers`）？甚至有可能做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T14:40:10.370

你可能会使用 CakePHP 1.x

```
$Controllers = Configure::listObjects('controller') 
```

CakePHP 2.x

```
$Controllers = App::objects('controller'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T14:53:34.163

完美的！我的解决方案的开始：

```
$human_controllers = Configure::listObjects('controller');
$u_controllers = array();
foreach($human_controllers as $c){
    $u_controllers[] = Inflector::underscore($c); // converts "PageContents" to "page_contents"
}
debug($u_controllers); die(); 
```

# wcf - WCF 流传输支持的绑定

> ID：898168
> 
> 赞同：0
> 
> 时间：2009-05-22T14:34:02.423
> 
> 标签：wcf, streaming, wcf-binding

我正在使用 basicHttpBinding 进行流传输，当我将绑定更改为 netTcpBinding 时，服务开始抛出异常...请帮助我了解传输流的最快绑定...
非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T15:43:31.597

一些用于文件传输的好链接，可能会帮助您深入了解正在发生的事情：

*   流媒体：[MSDN](http://msdn.microsoft.com/en-us/library/ms733742.aspx)

> ...您只能使用传输级安全选项进行流式传输，并且无法打开可靠会话。流式处理仅适用于以下系统定义的绑定：
> 
> *   基本HttpBinding
> *   NetTcpBinding
> *   网络命名管道绑定
> *   WebHttpBinding

*   传输块：[代码项目](http://www.codeproject.com/KB/WCF/WCF_FileTransfer_Progress.aspx)（可能不相关）
*   流媒体问题：[weblogs.asp.net](http://weblogs.asp.net/jclarknet/archive/2008/02/14/wcf-streaming-issue-under-iis.aspx)

# html - 我应该使用或者，提交样式化的 Web 表单

> ID：898174
> 
> 赞同：7
> 
> 时间：2009-05-22T14:34:39.803
> 
> 标签：html, css, webforms, cross-browser, accessibility

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T15:01:44.130

我看到自己一遍又一遍地使用可访问性的模式是从每个人都可以访问的内容开始，然后在客户端用首选的解决方案替换它。然后，如果他们没有那种技术，它就会优雅地退化。具体来说，我们在这里讨论的是 javascript。

例如，首先在表单中使用普通按钮。这适用于所有人，无论他们是否启用了 javascript。然后使用 javascript 用锚标记替换该按钮（这样你就可以在你的 css 中使用 :hover ），或者简单地使用 javascript 来执行你想要的悬停效果（如果你使用 jQuery，你可以将一个事件绑定到按钮的[鼠标悬停](http://docs.jquery.com/Events/bind)）。

这意味着一小部分没有启用 javascript 并且没有使用支持更高级 :hover 的浏览器的人不会看到您的悬停效果，但您将确保它始终优雅地降级。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T15:02:07.127

Internet Explorer 6 仅支持锚点的 :hover CSS 属性。

如果您支持 IE6，您将需要使用一些 javascript 解决方案，例如 @charles 建议的，基本上您需要动态地向元素添加/删除类。我通常将这些“修复”放在带有条件注释的 IE6.js 文件中。

使用[jQuery](http://www.jquery.com/)是可选的，但它确实有助于减少为实现这些效果而必须编写的 javascript 数量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T15:53:00.273

使用 javascript，您还可以按照 Jon 的建议用 a-tag 替换按钮。这是使用 jQuery，但您可以使用普通的 javascript 或任何其他库来执行此操作：

```
 var ahtml = "<div class='button'><a href=#>blabla</a></div>"; //whatever the HTML is for the styled a tag
 $('button.submit') //select button
    .hide()//Hide the button
    .after(ahtml) //insert the styled a html
    .next() //find the inserted html
       .click( function(e) { //add click behaviour to the inserted HTML
         $(this).prev().click(); //trigger click event of submit button
         return false; //stop both event bubbling and event triggering
       }); 
```

这样你就有了按钮，对于没有 javascript 的人。并且还为使用 javascript 的人提供了一个漂亮的样式标签。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T14:46:46.283

我尚未对此进行广泛测试，也尚未跨平台测试，但对于 Midori 和 FF3.x（在 Ubuntu 8.04 上），`button`标签采用 :hover、:focus 和 :active 的样式（类似于`a`标签）。

这当然有效：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
    <head>

    <title></title>

    <style type="text/css">

    button {color: #f00; 
        background-color: #ccc;
        border: 0 none transparent;}
    button:hover {color: #0f0; }
    button:active {color: #00f; }

    </style>

</head>

<body>

    <div id="wrapper">

    <form method="post" action="" enctype="form/multipart">

        <fieldset>
            <label for="input1">Label 1:</label>
            <input id="input1" name="input1" type="text" />

            <label for="input2">Label 2:</label>
            <input id="input2" name="input2" type="text" />
        </fieldset>

        <fieldset>

            <button class="reset" type="reset">Reset</button>
            <button class="submit" type="submit">Submit</button>

        </fieldset>

    </for>

    </div>

</body

</html> 
```

演示在：[http ://www.davidrhysthomas.co.uk/so/buttons.html](http://www.davidrhysthomas.co.uk/so/buttons.html)

## 进一步编辑以回应问题编辑：

您可以尝试添加第三个列表元素并命名它们（我会进一步建议使用字段集而不是列表，但让我们使用您所拥有的）。

```
<head>
<link rel="stylesheet" type="text/css" href="regularStylesheet.css" />

    <!--[if ie lte7]>
<link rel="stylesheet" type="text/css" href="ie-adaptations.css" />
    <![endif]-->

<form name="contact" action="index.php" method="post">
    <ul>
        <li>
            <label for="name" class="name">Name</label>
            <input type="text" name="name" id="name" size="30" />
        </li>
        <li class="submit-buttons">
            <button type="submit" class="submit">Send</button>
            <input type="hidden" name="submit" value="yes">
        </li>
        <li class="submit-links">
            <a href="where/ever/you/send.html">Send</a>
            <input type="hidden" name="submit" value="yes">
        </li>
    </ul>
</form> 
```

然后在常规 CSS 中添加：

```
li.submit-buttons
{
    display: block;
}

li.submit-links
{
    display: none;
} 
```

并在 IE-adaptations.css 中反转：

```
li.submit-buttons
{
    display: none;
}

li.submit-links
{
    display: block;
} 
```

它无论如何都不是完美的，但它不会扰乱使用表单模式的设备，并且应该允许按钮显示；并且应该只强制 IE 7（及以下）显示链接。所以......希望不应该过多地扰乱可访问性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T15:17:10.183

我可能会把脚放在嘴里或这里的东西，但我只是想指出其他需要考虑的事情。无论您决定解决这个问题，如果您的按钮或锚点应该执行某些操作（如删除记录或更改您的银行帐户），那么我强烈建议您确保执行回发 (POST)。这就是按钮通常在表单中所做的事情。不要执行 GET，这是 achor 通常所做的。

这是因为 GET 很容易被搜索引擎、浏览器预缓存器和其他东西意外跟踪。POST 被识别为执行操作且不会自动执行的操作。

另一方面，如果您的“按钮”只是进行某种查询，那么 GET 就可以了。

您也可以使用锚点发布帖子，尤其是使用 javascript。

有这个想法的人很可能会填写一些我忽略的细节。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T14:41:55.450

即使您可以找到解决方案（Matt Ross 提到的可能是其中一个），您应该更好地选择可访问性而不是抛光外观！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-22T14:43:39.533

一个 jQuery 解决方案怎么样，像这样：

```
$("input:button").mouseover(function(e) {
    $(this).addClass("hovered");
}).mouseout(function(e) {
    $(this).removeClass("hovered");
}).mousedown(function(e) {
    $(this).addClass("pressed");
}).mouseup(function(e) {
    $(this).removeClass("pressed");
}); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-23T06:27:34.563

你绝对可以单独使用 CSS 来做到这一点（对于可怜的 ie6，还有一点 js）。

首先，通过 :hover、:active 等使其在 FF 中工作。然后添加一些 js 以在悬停按钮上添加类，单击....将这些类添加到您的 :hover, :active... 声明 (button:hover, button.hover{color:red}) 然后就可以了. 您需要为 safari 和 IE 做一些按摩，但绝对可以做到。

另一种可能性是对先前建议的一种混搭。如果我没记错的话，JAWS 会读取具有可见性的元素：隐藏（不确定窗口的眼睛）。而不是使用 js 删除按钮或将其设置为 display:none，将其设置为不可见应该可以跨用户代理工作。然后只需我们 JS 将链接点击绑定到表单提交即可。

# delphi - Delphi - MadCrypt - 加密和解密字符串的问题

> ID：898175
> 
> 赞同：1
> 
> 时间：2009-05-22T14:34:50.253
> 
> 标签：delphi, encryption

我正在尝试加密字符串，但通常只有部分字符串被加密。我没有看到其他人有这个问题，所以我可能做错了什么。我在 Delphi 2007 和 2009 中遇到了同样的问题。我使用的是 Win XP SP3。这是代码：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  sTestToConvert: ansistring;
  sPassword: ansistring;
begin
  sTestToConvert := trim(Memo1.Text);
  sPassword := trim(Edit1.Text);
  madCrypt.Encrypt(sTestToConvert, sPassword);
  Memo2.Text := sTestToConvert;
end;

procedure TForm1.Button2Click(Sender: TObject);
var
  sTextToConvert: ansistring;
  sPassword: ansistring;
begin
  sPassword := trim(Edit1.Text);
  sTextToConvert := trim(memo2.Text);
  madCrypt.Decrypt(sTextToConvert, sPassword);
  Memo1.Text := sTextToConvert;
end; 
```

我在尝试使用 OldEncrypt 和 OldDecrypt 时也遇到了同样的问题。关于导致问题的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T15:52:18.230

当您说“只有部分字符串被加密”时，我不确定您的意思。你的意思是`sTestToConvert`即使在调用之后你仍然可以看到一些明文`Encrypt`？

更有可能的是，我希望您的意思是，当您调用 时`Decrypt`，您只会得到原始字符串的一部分。

这是因为`Encrypt`可能会在结果中存储*任何*字节值，包括非打印字符，甚至`#0`是空字符。当您将这样的字符串存储在 a`TMemo`或`TEdit`中时，底层 Windows 控件将该`#0`字符视为字符串的结尾。它不存储其余的加密值。因此，当您调用`Decrypt`存储在编辑控件中的内容时，您只是在解密您最初拥有的内容的一部分。

如果您想要加密数据的文本版本，请使用`Encode`and`Decode`函数；[在线文档](http://help.madshi.net/madCryptUnit.htm)提到了这一点。那些使用 base-64 编码。

```
procedure TForm1.Button1Click(Sender: TObject);
var
  sTestToConvert: AnsiString;
  sPassword: AnsiString;
begin
  sTestToConvert := Trim(Memo1.Text);
  sPassword := Trim(Edit1.Text);
  madCrypt.Encrypt(sTestToConvert, sPassword);
  Memo2.Text := madCryt.Encode(sTestToConvert);
end;

procedure TForm1.Button2Click(Sender: TObject);
var
  sTextToConvert: AnsiString;
  sPassword: AnsiString;
begin
  sPassword := Trim(Edit1.Text);
  sTextToConvert := madCrypt.Decode(Memo2.Text);
  madCrypt.Decrypt(sTextToConvert, sPassword);
  Memo1.Text := sTextToConvert;
end; 
```

# delphi - RpDesignerVCL 到西班牙语 (reportmanager)

> ID：898183
> 
> 赞同：0
> 
> 时间：2009-05-22T14:35:50.160
> 
> 标签：delphi, reportmanager

如何将 RpDesignerVCL 的语言更改为西班牙语，我有一个 delphi 应用程序，当我执行 RpDesignerVCL 组件时，它似乎是英语。谢谢亚历杭德罗·乔丹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T16:45:25.170

你必须把“reportmanres.es”放在应用程序目录中

# c# - 从 VS 2008 中的通用服务合同生成的 WSDL 问题

> ID：898184
> 
> 赞同：1
> 
> 时间：2009-05-22T14:35:53.043
> 
> 标签：c#, wcf, generics, wsdl

[编辑]**我想出了一种让它工作的方法，代码中的注释。**

我有几十个，很快就会有数百个具有以下合同的工作流：

```
[ServiceContract(Namespace = "http://schema.company.com/messages/")]
public interface IBasicContract<TRequest, TResponse>
  where TRequest : class
  where TResponse : class
{
  [OperationContract]
  [XmlSerializerFormat]
  [ServiceKnownType(typeof(Aggregate))]
  TResponse GetReport(TRequest inquiry);

  [OperationContract]
  [XmlSerializerFormat]
  [ServiceKnownType(typeof(Aggregate))]
  string GetRawReport(string guid);

  [OperationContract]
  [XmlSerializerFormat]
  [ServiceKnownType(typeof(Aggregate))]
  TResponse GetArchiveReport(string guid);
} 
```

我创建了一个通用实现：

```
// v added
[ServiceBehavior(Namespace = "http://schema.company.com/messages/")]
// ^ added
public abstract class BasicWorkflowSvc<TRequest, TResponse, TWorkflow> : IBasicContract<TRequest, TResponse>
  where TRequest : class
  where TResponse : class
  where TWorkflow : class
{
  //...
} 
```

实际实现如下所示：

```
[XmlSerializerFormat]
// v changed
[ServiceContract(Namespace = "http://services.company.com/messages/")]
// ^ changed
public interface IActualProductSvc : IBasicContract<ActualProductRq_Type, ActualProductRs_Type>
{
}

[ServiceBehavior(Namespace = "http://services.company.com/ActualProduct/v1.0")]
// v added
[MessageContract(WrapperNamespace = "http://services.company.com/ActualProduct/v1.0")]
// ^ added
public class ActualProductSvc : BasicWorkflowSvc<ActualProductRq_Type, ActualProductRs_Type, EF>, IActualProductSvc
{
  //...
} 
```

我的问题是：当我将此项目的服务引用添加到另一个项目中时，生成的代码具有额外的（且无用的）请求和响应类型：

```
[GeneratedCode("System.ServiceModel", "3.0.0.0")]
[ServiceContract(Namespace = "http://services.company.com/ActualProduct/v1.0", ConfigurationName = "ActualProduct.IActualProductSvc")]
public interface IActualProductSvc
{
  // CODEGEN: Generating message contract since the wrapper namespace (http://schema.company.com/messages/) of message GetReportRequest does not match the default value (http://services.company.com/ActualProduct/v1.0)
  [OperationContract(Action = "http://schema.company.com/messages/IBasicContractOf_ActualProductRq_Type_ActualProductRs_Type/GetReport",
    ReplyAction = "http://schema.company.com/messages/IBasicContractOf_ActualProductRq_Type_ActualProductRs_Type/GetReportResponse")]
  [XmlSerializerFormat()]
  [ServiceKnownType(typeof (Aggregate))]
  GetReportResponse GetReport(GetReportRequest request);

  // CODEGEN: Generating message contract since the wrapper namespace (http://schema.company.com/messages/) of message GetRawReportRequest does not match the default value (http://services.company.com/ActualProduct/v1.0)
  [OperationContract(
    Action = "http://schema.company.com/messages/IBasicContractOf_ActualProductRq_Type_ActualProductRs_Type/GetRawReport",
    ReplyAction = "http://schema.company.com/messages/IBasicContractOf_ActualProductRq_Type_ActualProductRs_Type/GetRawReportResponse")]
  [XmlSerializerFormat()]
  [ServiceKnownType(typeof (Aggregate))]
  GetRawReportResponse GetRawReport(GetRawReportRequest request);

  // CODEGEN: Generating message contract since the wrapper namespace (http://schema.company.com/messages/) of message GetArchiveReportRequest does not match the default value (http://services.company.com/ActualProduct/v1.0)
  [OperationContract(
    Action = "http://schema.company.com/messages/IBasicContractOf_ActualProductRq_Type_ActualProductRs_Type/GetArchiveReport",
    ReplyAction =
      "http://schema.company.com/messages/IBasicContractOf_ActualProductRq_Type_ActualProductRs_Type/GetArchiveReportResponse")]
  [XmlSerializerFormat()]
  [ServiceKnownType(typeof (Aggregate))]
  GetArchiveReportResponse GetArchiveReport(GetArchiveReportRequest request);
} 
```

...有一堆包装：

```
[DebuggerStepThrough()]
[GeneratedCode("System.ServiceModel", "3.0.0.0")]
[MessageContract(WrapperName = "GetReport", WrapperNamespace = "http://schema.company.com/messages/", IsWrapped = true)]
public partial class GetReportRequest
{
  [MessageBodyMember(Namespace = "http://schema.company.com/messages/", Order = 0)]
  public ActualProductRq_Type inquiry;

  public GetReportRequest()
  {
  }

  public GetReportRequest(ActualProductRq_Type inquiry)
  {
    this.inquiry = inquiry;
  }
} 
```

除了手动删除它们之外，有没有办法使这些包装器不被生成？我要问的原因是，在我尝试从所有工作流中提取通用合同之前，它们没有生成——没有具有不同命名空间的通用接口——使用这些工作流的人抱怨必须更新所有引用，然后从 Reference.cs 文件中手动删除很多东西。

我讨厌 Visual Studio 中的 WSDL 导入器 :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T14:45:31.277

当您在客户端添加或配置服务引用时，有一个复选框，其中提到了有关生成异步方法的内容。

如果已选中，请尝试取消选中它并查看这是否会删除自动生成的请求/响应方法。

一年多前我遇到了类似的问题，所以解决方案有点模糊。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T15:40:25.610

如果您使用 svcutil.exe 生成代理类，您是否有同样的问题？如果是这样，那么这不是VS2008的问题。

这个问题并不让我感到惊讶。.NET 中的泛型不是宏。您期望 WSDL 生成器挖掘出用作通用服务契约实例化的实际类型参数的特定类型。我认为这是一件很重要的事情。

我建议您创建此问题的简单版本并在[http://connect.microsoft.com/visualstudio/](http://connect.microsoft.com/visualstudio/)上报告它。做一个快速搜索，首先，看看它是否已经被报告。报告后，将报告的 URL 发布为对您问题的修改，以便其他人可以对其进行投票。

# wcf - sharepoint - 在不创建虚拟目录的情况下部署 Web 服务

> ID：898185
> 
> 赞同：0
> 
> 时间：2009-05-22T14:36:43.167
> 
> 标签：wcf, sharepoint, iis, service

我有一个 wcf Web 服务，并希望将其部署到我的 sharepoint 解决方案。

在 IIS 中，我创建了一个虚拟目录，该目录指向 C:\Inetpub\wwwroot\wss\VirtualDirectories\80_wcf 中的 web 服务。Web 服务从 12 hive 复制到此目录。

有没有更好的方法来部署 Web 服务，而不必做任何跨 Web 服务（.svc + web.config 文件）复制的东西......并创建一个虚拟目录等......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T16:29:50.253

[sharepoint 上](http://www.sharepoint-tips.com/2007/08/web-services-on-sharepoint-making-f5.html)的 Web 服务指南应该是一个好的开始。您可能希望将解决方案制作成 wsp 进行部署，并使用激活/停用功能代码将您的 wcf 配置条目添加/删除到 sharepoint web.config。

# c# - 如何在自定义 XML 序列化方法中使用默认 XML 序列化

> ID：898187
> 
> 赞同：8
> 
> 时间：2009-05-22T14:37:14.837
> 
> 标签：c#, .net, xml-serialization

我在 .NET 中有一个实现 IXmlSerializable 的类。我想序列化它的属性，但它们可能是复杂的类型。这些复杂类型将与 XML 序列化兼容，但它们本身不实现 IXmlSerializable。从我的 ReadXml 和 WriteXml 方法中，如何调用传递给我的 XmlReader/XmlWriter 上的默认读/写逻辑。

也许代码会让我想要的更清楚：

```
public class MySpecialClass : IXmlSerializable
{
    public List<MyXmlSerializableType> MyList { get; set; }

    System.Xml.Schema.XmlSchema IXmlSerializable.GetSchema()
    {
        return null;
    }

    void IXmlSerializable.ReadXml(System.Xml.XmlReader reader)
    {
        //  Read MyList from reader, but how?
        //  Something like this?
        //  MyList = (List<MyXmlSerializableType>)
            reader.ReadObject(typeof(List<MyXmlSerializableType>));
    }

    void IXmlSerializable.WriteXml(System.Xml.XmlWriter writer)
    {
        //  Write MyList to writer, but how?
        //  Something like this?
        //  writer.WriteObject(MyList)

    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T14:43:39.347

对于 writer，您可以为 MySerializableType 创建一个 XmlSerializer，然后通过它将列表序列化给您的 writer。

```
void IXmlSerializable.WriteXml(System.Xml.XmlWriter writer)
{
    // write xml decl and root elts here
    var s = new XmlSerializer(typeof(MySerializableType)); 
    s.Serialize(writer, MyList);
    // continue writing other elts to writer here
} 
```

读者也有类似的方法。 **编辑**：要仅读取列表，并在列表完成后停止读取，但在流结束之前，您需要使用[ReadSubTree](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.readsubtree.aspx)（信用 Marc Gravell）。

# asp-classic - 无法在经典asp中写入文件

> ID：898188
> 
> 赞同：3
> 
> 时间：2009-05-22T14:37:19.937
> 
> 标签：asp-classic, filesystemobject

好的，自从我使用经典 asp 以来已经有一段时间了，所以我有点生疏了。这是我的问题。

我正在尝试使用 FSO 将文件写入文件系统。下面的代码非常简单。但是，该文件没有出现，也没有出现错误。我知道它正在运行代码，因为我可以在此代码段之前和之后添加 response.writes，它们都出现在输出中。但是，没有创建文件，也没有引发错误。我什至改变了它，所以这是一个强制错误的虚假路径。没有骰子。我添加了每个人对目录的读写权限。还是一样。

想法？

这是我的代码：

```
Dim objFSO
Set objFSO = Server.CreateObject("Scripting.FileSystemObject")

'Open the text file
Dim objTextStream
Set objTextStream = objFSO.OpenTextFile("d:\test.txt", True)

'Display the contents of the text file
objTextStream.WriteLine "howdy"

'Close the file and clean up
objTextStream.Close
Set objTextStream = Nothing
Set objFSO = Nothing 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T15:04:27.137

代码不会产生错误消息的唯一可能原因是您的页面中有这个：

```
On Error Resume Next 
```

这很糟糕，因为你刚刚看到的原因。它只是默默地忽略任何错误消息，让您不知道为什么它没有按预期工作。

（它应该只用于您预计会出现错误的代码的孤立部分，并在每次操作后实际检查错误情况。）

从您的页面中删除它，您可能收到的错误消息是参数对于此行的调用无效：

```
Set objTextStream = objFSO.OpenTextFile("d:\test.txt", True) 
```

您忘记了第二个参数，即 I/O 模式。您应该使用值 1 来编写：

```
Set objTextStream = objFSO.OpenTextFile("d:\test.txt", 1, True) 
```

或者，您可以改用该`CreateTextFile`方法：

```
Set objTextStream = objFSO.CreateTextFile("d:\test.txt", True) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T14:42:28.897

尝试这个：

```
<%

if Append = true then
   iMode = 8
else 
   iMode = 2
end if
set oFs = server.createobject("Scripting.FileSystemObject")
set oTextFile = oFs.OpenTextFile("C:\wwwroot\Test.txt", iMode, True)
oTextFile.Write "Test Content"
oTextFile.Close
set oTextFile = nothing
set oFS = nothing

%> 
```

我在本地尝试了这个，在我的目录上设置了权限并且它起作用了。

您可以从这里获取原始来源： [http ://www.freevbcode.com/ShowCode.Asp?ID=89](http://www.freevbcode.com/ShowCode.Asp?ID=89)

# jquery - jQuery：同时发出 ajax 请求，有可能吗？

> ID：898190
> 
> 赞同：21
> 
> 时间：2009-05-22T14:37:31.997
> 
> 标签：jquery, ajax

我正在使用 jQuery 尝试同时检索多条数据。要求的背景是不同位的数据需要不同长度的时间才能变得可用，所以我想在返回时显示每一块。

问题是请求似乎“排队”；直到前一个请求返回后，下一个请求才会执行。经过大量阅读，似乎“异步：假”选项可能是我所追求的，但这似乎没有什么区别。

从 TCP/IP 调试中，我可以看到浏览器不会启动多个连接；当先前的请求返回时，它使用相同的连接。

在我的时间里，我见过很多网站同时通过 ajax 加载数据，所以显然这是可能的，但我正在努力让这个工作正常进行。

这是我的代码：

```
$.ajax({
    type: "GET",
    async: false,
    url: "foo1.php"
    });
$.ajax({
    type: "GET",
    async: false,
    url: "foo2.php"
    });
$.ajax({
    type: "GET",
    async: false,
    url: "foo3.php"
    }); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-22T14:39:53.677

您想要异步（这是默认设置）。浏览器在任何给定时间将您限制为两个请求。这是 HTTP 规范的一部分。（[HTTP 1.1 规范，第 8.1.4 节](http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.1.4)）

将请求放入队列是您的最佳选择。

我应该注意，这可以在 Firefox 和其他一些浏览器中被覆盖。（但由于它不是标准的，它对你没有多大帮助）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T14:46:25.537

浏览器将您限制为两个同时请求。您可能想要使用队列管理器，如下所示：http: [//www.protofunc.com/scripts/jquery/ajaxManager/](http://www.protofunc.com/scripts/jquery/ajaxManager/)

# xml - 创建动态 XML

> ID：898192
> 
> 赞同：0
> 
> 时间：2009-05-22T14:37:42.557
> 
> 标签：xml, jsp

我们有一个从 XML 文件中检索信息的闪存。现在我们不得不对 XML 内容进行硬编码，并将其放在闪存的相对位置。除了写入输出流以更改存储的 xml 之外，还有什么方法可以使 XML 动态化。我希望 xml 像 JSP 一样提供内容。我能想到的方法是将 Flash 指向 JSP 而不是 XML，但我们周围没有任何 Flash 专家来做这件事。有什么建议么？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T14:42:07.417

好吧，您也可以提供 xml 请求（示例`web.xml`片段）

```
<servlet-mapping>
  <servlet-name>some your servlet</servlet-name>
  <url-pattern>*.xml</url-pattern>
</servlet-mapping> 
```

然后，您可以编写一个生成 XML 文档的 HttpServlet（我建议使用`dom4j`它），然后您将`HttpServletRequest.getWriter()`使用`Transformer`(TrAX) api 将其序列化为输出（请参阅 参考资料）。

您也可以使用 jsp 处理此类请求，但我不建议这样做。制作一个servlet。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T14:54:04.617

如果您只需要更新 XML 文件中的某些值，最好对某些值进行标记并将它们存储在属性文件中，这样可能更容易更新。

本质上，您的 XML 文件将包含以下行：

```
<node value="${name.of.variable}" />
<!-- imagine a large xml file continuing here, most of which doesn't need to be edited  --> 
```

并且您的属性文件可以包含以下行：

```
name.of.variable="customize this value"
name.of.variable2="customize this value2"
name.of.variable3="customize this value3" 
```

# http - 什么是经典 ASP 中 ASP.NET 的 HttpContext.Current.Items 的等价物？

> ID：898194
> 
> 赞同：2
> 
> 时间：2009-05-22T14:38:20.137
> 
> 标签：http, asp-classic, request, httpwebrequest, httpcontext

`HttpContext.Current.Items`是具有 HTTP 请求生命周期的存储。

我想知道经典的 ASP 等价物。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T14:40:58.307

经典 ASP 中没有类似的东西。为此，您只有请求、响应、会话、应用程序、服务器等对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T15:43:18.293

您可以使用 Session 以类似的方式在页面之间存储内容：

Session("MyVar") = "我要保持的价值"

但是在 ASP 中并没有像在 .net 中那样使用用户控件等跳过页面。使用一些全局变量可能会更好？

如果你给我们更多的背景信息（不是双关语），也许可以更好地为你指明正确的方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T15:51:03.190

具有全局范围的集合对象将完成同样的事情。

# asp.net - 为什么我要在公共站点上使用 ASP.NET MVC 而在 Intranet 上使用 WebForms？

> ID：898198
> 
> 赞同：8
> 
> 时间：2009-05-22T14:38:50.120
> 
> 标签：asp.net, asp.net-mvc

我问了这个问题：

[ASP.NET MVC 是否注定要取代 Webforms？](https://stackoverflow.com/questions/894865/is-asp-net-mvc-destined-to-replace-webforms/895400#895400)

一些答案是，如果网站是公共/互联网使用 MVC，但如果它是内部使用 WebForms。我看到了其中的一些原因，但其中一些并没有真正帮助我理解为什么这种理性会如此。

我希望得到评论。为什么我不想将 ASP.NET MVC 用于除小型网站之外的所有内容？为什么 Internet 或 Intranet 很重要？

另外，我知道一个工具不能做所有事情。我不想使用网络表单，并不是我认为我不能或者它在某种程度上“不好”。在这个问题中，我专门询问 MVC 以及为什么它对网站的位置（公共或私人）很重要。

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T14:51:25.197

我想我知道为什么在您之前的问题中会出现内部与外部的区别。

**将 MVC 用于外部网站**可为您提供支持更多浏览器所需的灵活性，并使开发符合 Web 标准的网站更容易。MVC 需要更多的工作来完成一些与 Web 窗体相同的事情，但是您可以更好地控制向客户端输出的内容。

**建议将 WebForms 用于内部应用程序**，因为您可以完全控制网络上使用的浏览器。此外，内部应用程序通常不会获得与外部站点相同的预算。Web 表单允许您通过将代码拖放到 ASPX 页面在几分钟内将数据库网格、分页、排序等组合在一起。我相信的动机纯粹是基于金钱和时间的。

* * *

然而，我不认为*沙中的这条线*是一个好方法。我知道有一些我使用 WebForms 工作过的网站需要大量的头发拉扯，如果我使用 MVC 根本不会发生这种情况。但我也有一些不需要灵活性级别的网站，所以我使用了 WebForms。

我看到 ASP.NET MVC 的最大优势是 AJAX。与 WebForms 相比，使用 MVC 时处理 jQuery AJAX 请求对我来说更容易。我也是一个控制狂，所以使用 MVC 也可以满足这方面的要求......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T14:50:31.643

位置不是很重要，解释的是一个*典型的*内网网站具有以下属性：

*   非常低的用户负载，通常在内部 LAN 上提供服务
*   **非常短的开发时间表**
*   由 CRUD 附加组件组成的非常频繁的“功能添加”

因此，使用 MVC 开发它可能是矫枉过正，而不是与 WebForms 一起拍打一些东西。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T16:15:51.427

我认为内部/外部网站的区别最好归类为数据驱动的网站与内容驱动的网站。

IM(very)HO 使用当前版本的 MVC 来构建，例如，与使用 WebForms 相比，具有大量表格数据、内联编辑、排序、分页、过滤等的数据输入系统是相当多的工作。

但是，如果网站更关心向最终用户呈现内容（典型的网站：博客、电子商务应用程序、门户网站），则 MVC 提供了许多优于 WebForms 的优势。通常，像这样的网站更关心呈现问题（如果您过度依赖 WebForms 服务器控件进行呈现，这可能是一个问题）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T14:50:04.187

对我来说，ASP.NET Webforms 的优势在于您可以比 ASP.NET MVC 更快地开发它们。代价：使它们成为现代 CSS 兼容的应用程序以及 Viewstate 和页面生命周期的权重变得更加困难。

如果您关闭了 ASP.NET MVC，则没有理由不将其用于 Intranet 应用程序。

如果您已投入数年时间来精简 ASP.NET Webforms，您可能可以将它们用于 Internet 应用程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T14:53:09.827

MVC 提供了比 webforms 更好的关注点分离，但是，它确实带来了一些开销，这在较小的项目中很难证明是合理的。使用一种模型而不是另一种模型的决定不应基于它是内部网还是互联网解决方案，而应基于寿命、可维护性和可扩展性等因素。根据我的经验，如果项目很大、拥有庞大且多样化的开发团队并且可能需要持续维护，则 MVC 是一个更好的选择。Webforms 更适合小型短期项目的快速开发。

不用说，WebForms 可以并且已经用于大型项目，因为 MVC 可以用于较小的项目。您需要根据项目的需要来提高每种方法的好处。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-24T14:38:03.577

在公共/内部网应用程序的上下文中，我没有看到这两者的区别，我只看到了编写应用程序的方法和风格的区别，所以，选择你喜欢的任何东西 :)

干杯

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T14:55:07.903

作为其他答案的旁注，在 Intranet 环境中，URL 命名约定（即 /controller/method ... 等）的重要性要小得多，因为不需要 SEO。

# jquery - 将 jquery.getJson 与 Google 的 GeoCoding HTTP 服务一起使用

> ID：898201
> 
> 赞同：8
> 
> 时间：2009-05-22T14:39:25.720
> 
> 标签：jquery, geocoding, getjson

Google 提供了一个很棒的 REST 接口，用于对地址进行地理编码和反向地理编码。我的 API 密钥是有效的，如果我将请求直接输入到浏览器地址中，效果会很好。但是，下面的 jquery 失败了，我不明白为什么。希望你能在这里帮助我。

```
$.getJSON("http://maps.google.com/maps/geo?q="+ address+"&key="+apiKey+"&sensor=false&output=json",
  function(data, textStatus){
     console.log(data);
  }); 
```

此服务的 Google REST 接口文档：[http ://code.google.com/apis/maps/documentation/geocoding/index.html](http://code.google.com/apis/maps/documentation/geocoding/index.html)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-22T15:04:12.427

这里的问题是我没有指定 JSONP 回调。正确的代码如下

```
$.getJSON("http://maps.google.com/maps/geo?q="+ address+"&key="+apiKey+"&sensor=false&output=json&callback=?",
  function(data, textStatus){
     console.log(data);
  }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T14:43:53.373

由于安全限制，您不能从不同域中的页面向 URL 发送 AJAX 请求。这就是为什么如果您在浏览器中输入 URL，它会起作用，但如果您尝试从您的 javascript 代码发出请求，则不会。

一种常见的解决方法是使用[充当代理的服务器端组件](http://developer.yahoo.com/javascript/howto-proxy.html)：它接收您的 AJAX 请求并将它们发送到谷歌地理定位器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T14:48:21.383

添加误差函数

```
 error: function(xhr, ajaxOptions, thrownError) {
            alert("Ajax Error: " + xhr.status + "\nMsg: " + xhr.responseText);
        } 
```

并尝试调试它是否只是一个与 json 相关的错误

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-16T03:41:52.903

我遇到了完全相同的麻烦。这就是我最终能够让它为我工作的方式。

[请参阅谷歌地图 api 文档](http://code.google.com/apis/maps/documentation/javascript/services.html#Geocoding)

# javascript - jQuery + Ubiquity：从 URL 返回文档对象

> ID：898203
> 
> 赞同：2
> 
> 时间：2009-05-22T14:39:52.507
> 
> 标签：javascript, jquery, ubiquity

我正在尝试编写一个简单的[Ubiquity命令，该命令将在](https://wiki.mozilla.org/Labs/Ubiquity)[Wolfram Alpha](http://www.wolframalpha.com/)上运行查询，并在 Ubiquity 预览对象中显示结果。

我需要设置`innerHTML`预览对象的。我目前正在这样做以获取 HTML，这只是一个开始：

```
//...
jQuery.get( 'http://www.wolframalpha.com/input/?i=' + input.text, 
    null, 
    function( page ) {
        previewBlock.innerHTML = page;
    }
); 
```

我有 2 个问题/问题：

1.  Wolfram 需要 5-10 秒来生成页面上的所有 HTML，因此该`get()`命令返回不完整的 HTML
    **如何等待页面完全加载？**

2.  结果`id="results"`在 Wolfram 页面上，我想通过执行以下操作来获得结果：
    `previewBlock.innerHTML = page.getElementById('results').innerHTML`
    **如何使用我正在使用的 URL 来完成？**

另一种选择可能是使用 Wolfram URL 作为源创建一个新元素并将其附加到`previewBlock`-- 我不知道该怎么做。任何建议，将不胜感激。

**更新**
这是我正在使用的 Ubiquity 脚本——它将从源 HTML 中获取图像并循环输出。注：`CmdUtils.previewGet(pblock, opt)`来电`jQuery.get(opt)`

```
CmdUtils.CreateCommand({
  name: "wolfram",
  takes: {"input": noun_arb_text},
  icon: "http://www.wolframalpha.com/favicon.ico",
  homepage: "http://www.wolframalpha.com",
  author: {name:"Jason Coon"},
  description: "Searches Wolfram Alpha and loads results in to Preview pane.",

  preview: function(pblock, input) {
    CmdUtils.previewGet(pblock,
      'http://www.wolframalpha.com/input/?i=' + input.text,
      null,
      function(data){
        var resultStart = data.indexOf("results",0);
        var beginPos = data.indexOf("<img src", resultStart);
        var endPos = 0;
        var html = ""
        while(beginPos != -1){
          endPos = data.indexOf(">", beginPos);
          html = html + "<br><br>" + data.substring(beginPos, endPos);
          beginPos = data.indexOf("<img src", endPos);
        }
        pblock.innerHTML = html;
      }
    );
  }
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T22:39:07.460

我认为这甚至不可能使用**Ubiquity Preview**。问题是，当向 Wolfram 发送请求时，页面完成加载非常快，但它继续异步获取附加信息，正如您已经知道的那样。

如果这是通过浏览器窗口而不是 Ubiquity 预览完成的，您实际上可以将页面加载到隐藏的 iframe 中并在更新结果 div 之前检查内容。但是，此选项在当前版本的 Ubiquity 中不可用。

这是运行命令并传递文本“USA GDP”的屏幕截图。页面加载完成后，两个 div 获取显示信息，另外 2 个开始异步获取附加数据。
[替代文字 http://exterbase.com/wolfram-result.png](http://exterbase.com/wolfram-result.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T14:01:21.863

我认为您的想法是可行的，但我认为通过 AJAX 调用 Wolfram|Alpha API 比尝试解析对 WA Web 前端的响应更成功。有关 WolframAlpha API 的文档，请参见此处：www.wolframalpha.com/WolframAlphaAPI.pdf

我认为改变你与 API 交互的方法应该可以解决你的问题。如果您想继续采用当前方法，您可能需要检查内置 Wikipedia 命令的代码，以了解它们如何解析搜索结果，然后异步检索文章摘要以进行预览。

# c++ - 通过 boost::lexical_cast 将 C++Builder AnsiString 转换为 std::string

> ID：898209
> 
> 赞同：2
> 
> 时间：2009-05-22T14:40:44.207
> 
> 标签：c++, boost, c++builder, lexical-cast

对于学校作业，我必须使用 Borland C++ Builder 在 C++ 中实现一个项目。

由于 VCL 对所有 GUI 组件使用 AnsiString，我必须将所有 std::strings 转换为 AnsiString 以便显示。

```
std::string inp = "Hello world!";
AnsiString outp(inp.c_str()); 
```

当然可以，但是我想避免编写和代码重复有点乏味。当我们在其他上下文中使用 Boost 时，我决定提供一些帮助函数 go get boost::lexical_cast 来使用 AnsiString。到目前为止，这是我的实现：

```
std::istream& operator>>(std::istream& istr, AnsiString& str) {
    istr.exceptions(std::ios::badbit | std::ios::failbit | std::ios::eofbit);
    std::string s;
    std::getline(istr,s);
    str = AnsiString(s.c_str());
    return istr;
} 
```

一开始我在访问冲突之后得到了访问冲突，但是由于我添加了 .exceptions() 东西，所以图片变得更清晰了。执行转换时，我得到以下异常：

```
ios_base::eofbit set [Runtime Error/std::ios_base::failure] 
```

有谁知道如何解决它并可以解释为什么会发生错误？我的 C++ 经验非常有限。

反过来，转换例程将是：

```
std::ostream& operator<<(std::ostream& ostr,const AnsiString& str) {
    ostr << (str.c_str());
    return ostr;
} 
```

也许有人也会在这里发现错误:)

最诚挚的问候！

编辑：

目前我正在使用 Jem 的编辑版本，它在一开始就可以工作。在使用该程序一段时间后，Borland Codeguard 在已经释放的区域中提到了一些指针算法。任何想法这怎么可能相关？

Codeguard 日志（我使用的是德文版本，译文标有星号）：

```
------------------------------------------
Fehler 00080\. 0x104230 (r) (Thread 0x07A4):
Zeigerarithmetik in freigegebenem Speicher: 0x0241A238-0x0241A258\. **(pointer arithmetic in freed region)**
| d:\program files\borland\bds\4.0\include\dinkumware\sstream Zeile 126:
|               {   // not first growth, adjust pointers
|               _Seekhigh = _Seekhigh - _Mysb::eback() + _Ptr;
|>              _Mysb::setp(_Mysb::pbase() - _Mysb::eback() + _Ptr,
|                   _Mysb::pptr() - _Mysb::eback() + _Ptr, _Ptr + _Newsize);
|               if (_Mystate & _Noread)
Aufrufhierarchie: **(stack-trace)**
   0x00411731(=FOSChampion.exe:0x01:010731) d:\program files\borland\bds\4.0\include\dinkumware\sstream#126
   0x00411183(=FOSChampion.exe:0x01:010183) d:\program files\borland\bds\4.0\include\dinkumware\streambuf#465
   0x0040933D(=FOSChampion.exe:0x01:00833D) d:\program files\borland\bds\4.0\include\dinkumware\streambuf#151
   0x00405988(=FOSChampion.exe:0x01:004988) d:\program files\borland\bds\4.0\include\dinkumware\ostream#679
   0x00405759(=FOSChampion.exe:0x01:004759) D:\Projekte\Schule\foschamp\src\Server\Ansistringkonverter.h#31
   0x004080C9(=FOSChampion.exe:0x01:0070C9) D:\Projekte\Schule\foschamp\lib\boost_1_34_1\boost/lexical_cast.hpp#151

Objekt (0x0241A238) [Größe: 32 Byte] war erstellt mit new **(Object was created with new)**
| d:\program files\borland\bds\4.0\include\dinkumware\xmemory Zeile 28:
|   _Ty _FARQ *_Allocate(_SIZT _Count, _Ty _FARQ *)
|   {   // allocate storage for _Count elements of type _Ty
|>  return ((_Ty _FARQ *)::operator new(_Count * sizeof (_Ty)));
|   }
| 
Aufrufhierarchie: **(stack-trace)**
   0x0040ED90(=FOSChampion.exe:0x01:00DD90) d:\program files\borland\bds\4.0\include\dinkumware\xmemory#28
   0x0040E194(=FOSChampion.exe:0x01:00D194) d:\program files\borland\bds\4.0\include\dinkumware\xmemory#143
   0x004115CF(=FOSChampion.exe:0x01:0105CF) d:\program files\borland\bds\4.0\include\dinkumware\sstream#105
   0x00411183(=FOSChampion.exe:0x01:010183) d:\program files\borland\bds\4.0\include\dinkumware\streambuf#465
   0x0040933D(=FOSChampion.exe:0x01:00833D) d:\program files\borland\bds\4.0\include\dinkumware\streambuf#151
   0x00405988(=FOSChampion.exe:0x01:004988) d:\program files\borland\bds\4.0\include\dinkumware\ostream#679

Objekt (0x0241A238) war Gelöscht mit delete **(Object was deleted with delete)**
| d:\program files\borland\bds\4.0\include\dinkumware\xmemory Zeile 138:
|   void deallocate(pointer _Ptr, size_type)
|       {   // deallocate object at _Ptr, ignore size
|>      ::operator delete(_Ptr);
|       }
| 
Aufrufhierarchie: **(stack-trace)**
   0x004044C6(=FOSChampion.exe:0x01:0034C6) d:\program files\borland\bds\4.0\include\dinkumware\xmemory#138
   0x00411628(=FOSChampion.exe:0x01:010628) d:\program files\borland\bds\4.0\include\dinkumware\sstream#111
   0x00411183(=FOSChampion.exe:0x01:010183) d:\program files\borland\bds\4.0\include\dinkumware\streambuf#465
   0x0040933D(=FOSChampion.exe:0x01:00833D) d:\program files\borland\bds\4.0\include\dinkumware\streambuf#151
   0x00405988(=FOSChampion.exe:0x01:004988) d:\program files\borland\bds\4.0\include\dinkumware\ostream#679
   0x00405759(=FOSChampion.exe:0x01:004759) D:\Projekte\Schule\foschamp\src\Server\Ansistringkonverter.h#31

------------------------------------------ 
```

Ansistringkonverter.h 是带有已发布运算符的文件，第 31 行是：

```
std::ostream& operator<<(std::ostream& ostr,const AnsiString& str) {
    ostr << (str.c_str()); **(31)**
    return ostr;
} 
```

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T14:51:48.147

仍然没有使用 boost，但可能是解决您当前问题的第一步。你可以试试这个：

```
std::istream& operator>>(std::istream& istr, AnsiString& str) {
    istr.exceptions(std::ios::badbit | std::ios::failbit | std::ios::eofbit);
    std::string s;
    istr >> s;
    str = AnsiString(s.c_str());
    return istr;
} 
```

编辑：更完整的解决方案，考虑到 op 的评论：

```
std::istream& operator>> (std::istream& istr, AnsiString& str) 
{ 
    std::string tmp;

    std::istreambuf_iterator<char> it(istr), end; 
    std::copy(it, end, std::inserter(tmp, tmp.begin())); 

    str = AnsiString(tmp.c_str());

    return istr; 
} 
```

但是，对于 std::string 和 AnsiString 具有不同的 operator >> 行为可能可以满足您的需求，但总的来说不是很好。您仍然可以给它一个明确的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T14:48:53.767

您的转换转换输入的一行。如果有两行，这是一个严重的问题，如果没有，这是一个相当致命的错误。在这种情况下，最好的解决方案不是新的`operator>>`，而是模板专业化。我的头顶：

```
template< > AnsiString lexical_cast<AnsiString, std::string>(std::string const& s)
{
    return AnsiString(s.c_str());
} 
```

（您不应该*超载*其他人的模板。在 std:: 中，这是非法的，在其他地方只是不好的做法）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T10:55:09.260

你也可以试试这个！我在使用 hashlib++ 时也遇到了这种问题。

```
String toAnsiString(const std::string& myString)
{
  return String(myString.c_str());
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T20:16:21.813

除了 MSalters 注释之外，将 std::string 的实际长度也传递给 AnsiString 会更有效，这样它就不需要浪费 CPU 周期来手动计算长度：

```
template<> System::AnsiString lexical_cast<System::AnsiString, std::string>(std::string const& s)
{
    return System::AnsiString(s.c_str(), s.length());
} 
```

# windows-installer - 如何防止在 Vista 上出现“此程序可能未正确安装”消息

> ID：898220
> 
> 赞同：50
> 
> 时间：2009-05-22T14:42:15.497
> 
> 标签：windows-installer, installation, uac, windows-appcompat-platform

我有一个产品设置可执行文件，可以将一些文件复制到用户的硬盘上。它不是一般意义上的典型安装程序（它不会向“开始”菜单或“程序文件”文件夹添加任何内容）。

每次在 Vista 上运行安装程序时，exe 终止后，Vista 都会生成一个任务对话框：

*   **此程序可能未正确安装**
*   使用推荐配置重新安装
*   这个程序正确地安装了

我需要从 exe 或注册表项中调用一个函数来设置，以向操作系统指示程序安装正确（或至少抑制此消息）？

**相关问题：** [Windows 7 RC 中的“此程序可能未正确安装”消息](https://stackoverflow.com/questions/1069135/this-program-might-not-have-installed-correctly-message-in-windows-7-rc)（针对特定于 Windows 7 的问题）

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-04-15T01:43:50.760

将此部分包含在程序的清单文件中：

```
<compatibility xmlns="urn:schemas-microsoft-com:compatibility.v1">
  <application>
    <!--The ID below indicates application support for Windows Vista -->
      <supportedOS Id="{e2011457-1546-43c5-a5fe-008deee3d3f0}"/>
    <!--The ID below indicates application support for Windows 7 -->
      <supportedOS Id="{35138b9a-5d96-4fbd-8e2d-a2440225f93a}"/>
    <!--The ID below indicates application support for Windows 8 -->
      <supportedOS Id="{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}"/>
    <!--The ID below indicates application support for Windows 8.1 -->
      <supportedOS Id="{1f676c76-80e1-4239-95bb-83d0f6d0da78}"/>
    <!--The ID below indicates application support for Windows 10 -->
      <supportedOS Id="{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}"/>

  </application>
</compatibility> 
```

它会通过声明您的应用与 Vista 和 Win 7 兼容来禁止程序兼容性助手。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T14:56:38.743

您需要将一些信息添加到注册表的 AppCompat 部分。

请参阅[此链接](http://support.microsoft.com/kb/931709)并查找“如何禁用程序兼容性助手警告”。

显然还有[一种方法](http://blogs.msdn.com/astebner/archive/2007/05/17/2705372.aspx)涉及将清单文件添加到您的安装程序可执行文件以将其标记为“Vista-aware”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T19:19:18.127

您应该尝试的第一件事是添加带有 requestedExecutionLevel 的“Vista 清单”

如果这还不够（在卸载时单击取消并关闭 UAC 等），您需要使用未记录的内容，例如将 PE 标头中的图像版本字段设置为 6.0

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-23T14:52:00.913

弹出此消息的原因之一是系统认为您正在运行安装程序，但在添加/删除程序列表中找不到该应用程序的条目。

我不知道您的应用程序是否属于这种情况，但值得检查。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-09T16:50:02.947

这似乎还有更多的原因。如果您重命名了您的应用程序，还请记住程序集信息中的名称，它们都必须相同，否则可能会弹出“此程序可能未正确安装”的 nag-screen :-P [![在此处输入图像描述](https://i.stack.imgur.com/hZkwI.jpg)](https://i.stack.imgur.com/hZkwI.jpg)

也可以直接在AssemblyInfo.vb/.cs文件中修改

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-13T02:07:30.077

我通过更改程序集标题解决了它。

# asp.net - asp.net：部署本地资源 - 嵌入可能吗？

> ID：898231
> 
> 赞同：0
> 
> 时间：2009-05-22T14:44:37.207
> 
> 标签：asp.net, deployment, localization, resx

我有一个带有一些本地资源的 asp.net 应用程序。这些资源在 aspx 和代码隐藏文件中使用：

```
aspx:
<asp:TextBox ID="TextBox1" runat="server" Text="<%$ Resources:testTag %>" />

.vb:
TextBox1.Text = GetLocalResourceObject("testTag").ToString 
```

如果我使用应用程序部署 .resx 文件，则没有问题。

但是，如果我将 resx 文件上的构建操作更改为“嵌入式资源”，则资源不可用，即使它们位于构建的 DLL 中。

是否可以在 DLL 中部署资源，或者我是否坚持在服务器上管理和部署 resx 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T15:06:59.863

是的，这是可能的。

查看[此代码项目](http://www.codeproject.com/KB/cs/cs-multi-assembly-res.aspx)示例。它有点旧，但仍然有效。

另一个来自微软的例子是[here](http://msdn.microsoft.com/en-us/library/aa984332(VS.71).aspx)。

**更新**

老实说，我们自己的本地化还没有走到这一步（我们仍然使用通常嵌入的资源文件）；但是，[这里有](http://forums.asp.net/p/1055760/1506338.aspx#1506338)一个示例链接，说明如何从您的 aspx 页面访问资源管理器。这是该线程中的最后一个帖子。

GeorgeZ 声明在 page_init 方法中加载资源管理器。我敢肯定，您可以将其放入所有页面都继承的某种类型的 BasePage 中，以防止将其直接包含在其所有代码后面。

# linq - 如何处理以编程方式添加字段？

> ID：898239
> 
> 赞同：0
> 
> 时间：2009-05-22T14:46:00.730
> 
> 标签：linq, linq-to-sql, database-design, search

昨天，我问[了这个](https://stackoverflow.com/questions/893036/best-practices-for-building-a-search-app)关于我开始研究的简单信息检索系统的最佳实践的问题。

今天，我的客户问我是否可以允许他们在以后使用管理界面向主要实体添加字段。也就是说，该应用程序允许您搜索一个数据库表（让我们称之为实体），它可能与其他对象有各种关联，但重点是实体。

现在，当然，天空是极限，这是可能的。

我对这个问题的最初想法是创建两个新表：

**AdditionalFields**（FieldID *PK*、FieldName、IsShownInSearchResults 和其他元数据）这是由管理界面创建其行的表。例如，如果客户后来决定他们想要添加跟踪实体的眼睛颜色的能力，他们将创建一个字段名称为“眼睛颜色”的 AdditionalField。

**AdditionalFieldData** (FieldDataID *PK* , EntityID *FK* , FieldID *FK* , FieldValue) 这是将实体与客户添加的任何附加字段的各自值相关联的表格。例如，对于我们的眼睛颜色示例，如果在添加字段时我们有两个实体（EntityID 3 和 4）并且新的 AdditionalField 的 FieldID 为 1，则没有与实体关联的眼睛颜色数据是有效的. 然后，客户可以选择将眼睛颜色“蓝色”添加到实体 3，我们将向 AdditionalFieldData 插入一行，如下所示：（*自动生成的 PK* , 3, 1, “蓝色”）。

由于我想轻松地搜索这些，我只需要所有其他字段都具有字符串值。

按照我在上一个问题中发布的方法，当用户执行搜索时，我将使用带有类似于以下查询的 Linq-To-SQL 进行信息检索（当然，过滤的逻辑在实践中会更加复杂):

```
var results = from s in db.Stuff
          where (s.Name.Contains(textFilter) ||
                 s.Title.Contains(textFilter))
          select s; 
```

我会将查询修改为如下所示：

```
var results = from s in db.Stuff
              where (...existing filter logic...) ||
                    s.AdditionalFieldData.Any(afd => afd.FieldName.Contains(textFilter))
              select s; 
```

所以我的问题是：这合理吗？我错过了更好的解决方案吗？我应该注意这种方法的任何含义吗？

（请原谅我愚蠢的标识符，对我来说还早:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T14:59:35.697

我不是 LINQ 专家，但从数据库设计的角度来看，您的建议对我来说似乎很好。

An alternative which I've seen used a few times is to have a whole bunch of 'spare' fields defined on the Entities table, which the users can enable/disable through the admin interface. You gain some database performance this way (due to the smaller number of joins), but you have to choose up front how many of these spare fields you want, and you end up with large, mostly empty tables for most of the time.

Oh, and you can safely assume that if you choose to add *N* spare fields, your users will want *N+1* ;-)

# c# - 如何使用 C# 中的线程或进程打开与当前项目不同的项目。？

> ID：898247
> 
> 赞同：1
> 
> 时间：2009-05-22T14:48:09.213
> 
> 标签：c#, .net, winforms

我使用 C# 在 VS2005 中开发了一个窗口应用程序。我需要将另一个项目与我的项目集成

编辑：即将一个变量从第一个项目传递到第二个项目并加载第二个项目的形式。

所以我称其他项目的主要用途是，

```
namespace.className.Main(args); 
```

但如果我这样做，当第二个项目打开时，我无法切换到我的第一个项目。我需要退出我的第二个项目才能导航到我的第一个项目。

我还注意到第二个项目在第一个项目的同一进程中运行，而不是在一个新进程中运行。那么我该如何解决这个问题。？我是否需要创建一个新线程或新进程并让第二个项目在其中运行以及如何做到这一点，以便它们都是独立的，我可以在两个应用程序之间切换。？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T14:52:41.763

你有没有尝试过

```
System.Diagnostics.Process.Start(filename); 
```

[MSDN 链接](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T14:52:28.987

你试过跟随吗？

```
var formFrom2ndProject = new FormFrom2ndProject()
formFrom2ndProject.Show() 
```

# javascript - TinyMCE + Safari 3 - 表格插入不起作用

> ID：898251
> 
> 赞同：0
> 
> 时间：2009-05-22T14:48:32.707
> 
> 标签：javascript, safari, tinymce

有没有其他人遇到过这个问题并找到了可行的解决方案？我启用了 Safari 兼容性插件，但它对我来说仍然不正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T14:54:59.513

[http://tinymce.moxiecode.com/examples/full.php](http://tinymce.moxiecode.com/examples/full.php)

耸肩，对我来说很好用。

# linux - 有什么好的 PostgreSQL 客户端用于 linux 吗？

> ID：898255
> 
> 赞同：32
> 
> 时间：2009-05-22T14:49:18.430
> 
> 标签：linux, postgresql, client, database-administration

我对没有一个好的 PostgreSQL 的 Linux GUI 管理和开发工具感到沮丧。

pgAdmin III 是有缺陷且无法使用的……嗯，软件，与仅 Windows 的 PostgreSQL Maestro 和 EMS PostgreSQL 管理器相比。

phpPgaAmin 看起来并不乐观。

EMS PostgreSQL manager 可以在 Wine 下工作，但是这样的设置有很多问题。

要求是：

1.  大表（1M+）的表数据编辑和浏览，可以FK跳转或者一些主从编辑，GUI过滤等。
2.  具有就地模式编辑的 ER 图
3.  带有所有有用的 GUI 支持的模式编辑和浏览
4.  架构更改日志以放入数据库版本控制（迁移脚本）。
5.  选项卡式界面能够同时处理多个表和 SQL 查询。

等等。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T14:53:31.607

你试过松鼠 SQL 吗？

[http://squirrel-sql.sourceforge.net/](http://squirrel-sql.sourceforge.net/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-03-31T16:54:24.667

目前我建议使用支持 Postgres 和许多其他数据库的 DBeaver ( [http://dbeaver.jkiss.org/download/ )。](http://dbeaver.jkiss.org/download/)

[2016 更新] 其实我正在使用 DataGrip [https://www.jetbrains.com/datagrip/](https://www.jetbrains.com/datagrip/)是 Intellij 开发的工具

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T17:39:22.003

## PostgreSQL 工具

*   [Phppgadmin](http://phppgadmin.sourceforge.net/) - 我认为你应该重新评估你对这个工具的彻底解雇。它具有比 PgAdmin III 更大的功能集，并允许您通过本地套接字进行连接，而不是通过 JDBC 严格通过 tcp 端口进行连接。
*   [Aqua Data Studio](http://www.aquafold.com/) - 我以前经常使用这个工具，但我不确定它的当前状态。它支持 ER 映射并具有许多对开发人员有用的功能。

我怀疑你会在一个工具中找到你想要的一切。我使用 Postgresql 进行了很多开发，但我仍然发现自己是最高效的文本编辑器和命令行 psql 工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-20T17:12:48.377

目前，Navicat 似乎为数据库生成了最好的管理工具，恕我直言。

查看他们的免费版本（支持多个数据库的高级版，包括 postgres 或仅 postgres 版本：...对于 postgresql）

[http://navicat.com/en/download/download.html](http://navicat.com/en/download/download.html)

# .net - 带有“/”字符的广告组名称正在炸毁我的绑定

> ID：898256
> 
> 赞同：0
> 
> 时间：2009-05-22T14:49:22.113
> 
> 标签：.net, directoryservices

我使用以下代码为我的用户获取 memberOf 属性：

```
DirectorySearcher search = new DirectorySearcher(new DirectoryEntry(connectionString));
search.Filter=string.Format("(&(sAMAccountName={0})(objectClass=user))",userName);
SearchResult result = search.FirndOne(); 
```

到现在为止还挺好。但是，我必须为用户所属的每个组获取 cn 值：我在 memberOf 属性的循环中执行此操作。

```
List<string> groupList = new List<string>();
DirectoryEntry user = result.GetDirectoryEntry();

foreach(string groupPath in user.Properties["memberOf"])
{
    DirectoryEntry groupBinding = new DirectoryEntry("LDAP://"+groupPath);
    DirectorySearcher groupSearch = new DirectorySearcher(groupBinding);
    DirectoryEntry gorupEntry = groupSearch.FindOne().GetDirectoryEntry();
    groupList.Add(groupEntry.Properties["cn"].Value.ToString()));
} 
```

问题是，当 groupPath 包含“/”字符时，`groupSearch.FindOne()`会引发异常。

如何转义 / 字符以便可以搜索该组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:13:15.280

使用反斜杠转义 /

信用：[http ://www.rlmueller.net/CharactersEscaped.htm](http://www.rlmueller.net/CharactersEscaped.htm)

# c# - EntityKey 和 ApplyPropertyChanges()

> ID：898260
> 
> 赞同：6
> 
> 时间：2009-05-22T14:50:03.687
> 
> 标签：c#, .net, asp.net-mvc, entity-framework

我需要设置一个EntityObject 的EntityKey。我知道它的类型和它的 id 值。我不想不必要地查询数据库。

这有效...

```
//
// POST: /Department/Edit/5

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, Department Model)
{
    Model.EntityKey = (from Department d in db.Department
                       where d.Id == id
                       select d).FirstOrDefault().EntityKey;
    db.ApplyPropertyChanges(Model.EntityKey.EntitySetName, Model);
    db.SaveChanges();
    return RedirectToAction("Index");
} 
```

这失败了...

```
//
// POST: /Department/Edit/5

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, Department Model)
{
    String EntitySetName = db.DefaultContainerName + "." + Model.GetType().Name;
    Model.EntityKey = new System.Data.EntityKey(EntitySetName, "Id", Model.Id);
    db.ApplyPropertyChanges(Model.EntityKey.EntitySetName, Model);
    db.SaveChanges();
    return RedirectToAction("Index");
} 
```

*ApplyPropertyChanges()*行因以下异常而失败：

> ObjectStateManager 不包含引用“Sample.Models.Department”类型对象的 ObjectStateEntry。

两个 EntityKey 是相等的。为什么第二个代码块会失败？我该如何解决？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T15:06:43.093

您的第二个代码块失败的原因是因为 EF 在 ObjectStateManager 中找不到对象 - 即，当它从数据库中提取对象时，它会将它们放入状态管理器中以便它可以跟踪它们 - 这类似于[身份映射](http://www.martinfowler.com/eaaCatalog/identityMap.html)模式. 尽管有 EntityKey，但您的对象不在状态管理器中，因此 EF 无法保留更改。您可以通过自己将对象放入状态管理器来解决此问题，但您对此有点偷偷摸摸。

这有效：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, Department model)
{
  var entitySetName = db.DefaultContainerName + "." + model.GetType().Name;
  var entityKey = new System.Data.EntityKey(entitySetName, "Id", model.Id);

  db.Attach(new Department{Id = id, EntityKey = entityKey});
  db.AcceptAllChanges();

  db.ApplyPropertyChanges(entitySetName, model);
  db.SaveChanges();
} 
```

...但它不是很干净。基本上，这是用一个实体键附加一个“空”对象，接受所有更改，然后使用实际更新的值调用 ApplyPropertyChanges。

这是包含在扩展方法中的相同内容 - 这应该适用于任何使用单个 db 列作为主键的东西。调用该方法的唯一有趣的部分是您需要告诉它如何通过委托作为扩展方法的第二个参数来找到关键属性：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, Department model)
{
  db.ApplyDetachedPropertyChanges(model, x => x.Id);
  db.SaveChanges();
} 
```

和扩展方法：

```
public static class EfExtensions
{
  public static void ApplyDetachedPropertyChanges<T>(this ObjectContext db, T entity, Func<T, int> getIdDelegate)
  where T : EntityObject
  {
    var entitySetName = db.DefaultContainerName + "." + entity.GetType().Name;
    var id = getIdDelegate(entity);
    var entityKey = new EntityKey(entitySetName, "Id", id);

    db.Attach(new Department {Id = id, EntityKey = entityKey});
    db.AcceptAllChanges();

    db.ApplyPropertyChanges(entitySetName, entity);
  }
} 
```

由于扩展方法正在调用 AcceptAllChanges，因此如果您同时对多个实体进行更新，则需要小心调用它 - 如果您不小心，您很容易“丢失”更新。因此这种方法只适用于简单的更新场景——例如很多 MVC 动作方法 :)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-26T10:42:45.503

```
public static class EfExtensions
{
    public static void ApplyDetachedPropertyChanges<T>(this ObjectContext db, T entity, Func<T, int> getIdDelegate)
    where T : EntityObject
    {
        var entitySetName = db.DefaultContainerName + "." + entity.GetType().Name;

        T newEntity = Activator.CreateInstance<T>();
        newEntity.EntityKey = db.CreateEntityKey(entitySetName, entity);

        Type t = typeof(T);
        foreach(EntityKeyMember keyMember in newEntity.EntityKey.EntityKeyValues) {
            PropertyInfo p = t.GetProperty(keyMember.Key);
            p.SetValue(newEntity, keyMember.Value, null);
        }

        db.Attach(newEntity);
        //db.AcceptAllChanges();

        db.ApplyPropertyChanges(entitySetName, entity);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-16T13:16:34.223

改进 Steve Willcock 的出色实现，这是我的建议。

它比原始示例更多地使用反射（.NET 的一部分），以节省一些代码。它还自动支持任何类型的实体类，而不仅仅是“部门”。

此外，它摆脱了过时的`ApplyPropertyChanges`方法，并使用了新的`ApplyCurrentValues`方法。

**方法**

该方法基本上只是使用反射来动态获取“Id”属性的值，并对其进行设置。这省去了委托人的所有麻烦。

```
public static void ApplyDetachedPropertyChanges<T>(this ObjectContext db, T entity) where T : EntityObject
{
    PropertyInfo idProperty = typeof(T).GetProperty("Id");

    var entitySetName = db.DefaultContainerName + "." + entity.GetType().Name;
    var id = idProperty.GetValue(entity, null);
    var entityKey = new EntityKey(entitySetName, "Id", id);

    Type type = entity.GetType();
    EntityObject obj = (EntityObject)Activator.CreateInstance(type);

    idProperty.SetValue(obj, id, null);
    obj.EntityKey = entityKey;

    db.Attach(obj);
    db.AcceptAllChanges();

    db.ApplyCurrentValues(entitySetName, entity);
} 
```

**用法**

使用它也很简单。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, Department Model)
{
    db.ApplyDetachedPropertyChanges(Model);
    db.SaveChanges();
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-29T07:31:48.737

尝试使用下面的代码，让我知道它是否适合您。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Guid id, Department Model)
{
    using (var context =  new EntityContext())
    {
        try
        {
            Object entity = null;
            IEnumerable<KeyValuePair<string, object>> entityKeyValues =
                new KeyValuePair<string, object>[] {
                    new KeyValuePair<string, object>("DepartmentID", id) };

            // Create the  key for a specific SalesOrderHeader object. 
            EntityKey key = new EntityKey("EntityContext.Deparment",   
                                                                   entityKeyValues);

            // Get the object from the context or the persisted store by its key.
            if (context.TryGetObjectByKey(key, out entity))
            {
               context.ApplyPropertyChanges(key.EntitySetName, Model);
               context.SaveChanges();
            }
            else
            {
               // log message if we need
               //"An object with this key could not be found." 
            }                
        }
        catch (EntitySqlException ex)
        {
           // log message
        }
    }
 } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-15T09:38:43.187

当它在其他页面上工作时，我遇到了同样的问题。我不知道这个评论是否有用......但我终于发现，在我的对象（相当于你的部门）中，我的“Id”没有出现在表格中......

只是在我的表单上添加它（虽然我已经删除了它......）这一事实已经解决了我的问题。（带有style="visibility:hidden"，为了不看到他...）

# vb.net - 在VB中使用OR运算符动态构建LINQ查询

> ID：898262
> 
> 赞同：1
> 
> 时间：2009-05-22T14:50:22.733
> 
> 标签：vb.net, linq, predicate

我需要使用 or 运算符构建动态 linq 查询。我见过 PredicateBuilder 但那是在 C# 中，我的项目是在 VB 中。基本上我需要建立一个类似于这样的 WHERE 子句：

```
Where((this = 1 AND that = 2) OR (this = 1 AND that = 4) OR (this = 2 AND that = 4)) 
```

但问题是数字必须在运行时动态确定，并使用循环添加，比如

```
for each item in myItems
    query = query.OR (this = item.a AND this = item.b)
next 
```

我怎么能这样做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:45:44.580

让 LinqKit.dll 正常工作，现在即使在我的 VB 项目中也可以使用 PredicateBuilder，而且效果很好！

对于其他需要这个的人，请参阅[http://rocksthoughts.com/blog/archive/2008/04/10/linq-to-sql-dynamic-queries-3-ands--ors-together.aspx](http://rocksthoughts.com/blog/archive/2008/04/10/linq-to-sql-dynamic-queries-3-ands--ors-together.aspx)，非常好的文章关于如何去做这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T15:22:47.850

您是否查看过[LINQ 动态查询库](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)？

# c# - 如何为 DataGridView 设置标题

> ID：898265
> 
> 赞同：1
> 
> 时间：2009-05-22T14:50:37.023
> 
> 标签：c#, winforms, datagridview, internationalization

我在 WinForm 应用程序中使用 DataGridView 来显示数据表。除了 DataColumn 的 Caption 属性外，一切正常。我试图设置 Caption 属性，但似乎 DataGridView 使用 DataColumn 的名称作为标题而不是 Caption 属性的值？

有谷歌这个，似乎这个标题属性是故意禁用的。

我的 WinForm 应用程序是本地化的，我需要用中文显示标题。有谁知道我该怎么做？

这是我设置数据表的代码

```
// Create a new DataTable.
DataTable table = new DataTable("Payments");

// Declare variables for DataColumn and DataRow objects.
DataColumn column;
DataRow row;

// Create new DataColumn, set DataType, 
// ColumnName and add to DataTable.    
column = new DataColumn();
column.DataType = System.Type.GetType("System.Int32");
column.ColumnName = "id";
column.ReadOnly = true;
column.Unique = true;
column.Caption = LocalizedCaption.get("id") //LocalizedCaption is my library to retrieve the chinese caption

// Add the Column to the DataColumnCollection.
table.Columns.Add(column);

// Create three new DataRow objects and add them to the DataTable
for (int i = 0; i <= 2; i++)
{
    row = table.NewRow();
    row["id"] = i;
    table.Rows.Add(row);
}

//assign the DataTable as the datasource for a DataGridView
dataGridView1.DataSource = table; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T15:02:16.220

你有几个选择。这是一个应该有效的快速修复，只需将其添加到代码块的末尾：

```
 //Copy column captions into DataGridView
        for (int i = 0; i < table.Columns.Count; i++) {
            if (dataGridView1.Columns.Count >= i) {
                dataGridView1.Columns[i].HeaderText = table.Columns[i].Caption;
            }
        } 
```

如您所见，这只是将现有的列标题复制到每个 DataGridView 列的正确 HeaderText 属性中。这假定在绑定 DataTable 之前 DataGridView 中不存在以前的列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-20T09:13:39.213

这对我有用：

```
private void DataGrid_AutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
{
    var dGrid = (sender as DataGrid);
    if (dGrid == null) return ;
    var view = dGrid.ItemsSource as DataView;
    if (view == null) return;
    var table = view.Table;
    e.Column.Header = table.Columns[e.Column.Header as String].Caption;
} 
```

# iis-6 - 为什么我的 IIS 虚拟目录可以使用 http://localhost 而不是 http://computername？

> ID：898266
> 
> 赞同：8
> 
> 时间：2009-05-22T14:50:42.813
> 
> 标签：iis-6, virtual-directory

我的任务是向现有的 IIS 6.0 网站添加功能。为此，我构建了一个 ASP.NET MVC 应用程序。当部署为它自己的站点时它工作正常，但当我尝试将它部署为它需要存在的实际站点上的虚拟目录时似乎不起作用。

服务器名称为 CWEBSERVER，IP 为 192.168.1.11。通过查看 IIS 管理器，这是站点结构：

```
(Default Website) (root)
  - PRODUCTION (vDir)
  - CONTENT (not a vDir)
  - DATAFOLDER (vDir, contains MVC app, just added by me, not working) 
```

奇怪的是，当我从服务器上的浏览器中键入以下 URL 时，它可以工作：

```
http://localhost/DATAFOLDER/account.aspx
http://127.0.0.1/DATAFOLDER/account.aspx
http://192.168.1.11/DATAFOLDER/account.aspx 
```

以下 URL（这是我需要工作的 URL）没有：

```
http://CWEBSERVER/DATAFOLDER/account.aspx 
```

我得到的错误是“找不到资源”。

仔细观察后，我意识到对[http://CWEBSERVER](http://CWEBSERVER)的请求将发送到 PRODUCTION vDir，但对[http://localhost](http://localhost)或[http://192.168.1.11](http://192.168.1.11)的调用将发送到网站的根目录。我想这是原始网站设计师设置的。我不确定如何更改此设置，但我认为无论如何我都无法更改它，因为实际上还有大量其他目录会受到影响。我想指出的另一件事是：可以通过访问[http://CWEBSERVER/CONTENT](http://CWEBSERVER/CONTENT)访问 CONTENT 文件夹。这真的很奇怪，因为我认为[http://CWEBSERVER](http://CWEBSERVER)将我指向根目录，所以我认为“/CONTENT”实际上无法访问 CONTENT 文件夹。

现在我的问题是：如何通过[http://CWEBSERVER/DATAFOLDER 访问我的 DATAFOLDER](http://CWEBSERVER/DATAFOLDER)？我认为我应该将 DATAFOLDER vDir**放在**PRODUCTION vDir 中。我试过了，使用 localhost 或 IP 仍然可以通过以下方式访问：

```
http://localhost/PRODUCTION/DATAFOLDER/account.aspx
http://127.0.0.1/PRODUCTION/DATAFOLDER/account.aspx
http://192.168.1.11/PRODUCTION/DATAFOLDER/account.aspx 
```

但是，当我使用 CWEBSERVER 时，它仍然失败：

```
http://CWEBSERVER/DATAFOLDER/account.aspx 
```

错误仍然是“找不到资源。”。任何人都可以对此有所了解吗？具体来说，我有这些问题：

1.  [http://localhost](http://localhost)如何进入根目录，而[http://CWEBSERVER 如何](http://CWEBSERVER)进入 PRODUCTION vDir？我在哪里可以更改此设置？
2.  为什么“ [http://localhost/PRODUCTION/DATAFOLDER/account.aspx](http://localhost/PRODUCTION/DATAFOLDER/account.aspx) ”可以工作，但“ [http://CWEBSERVER/DATAFOLDER/account.aspx](http://CWEBSERVER/DATAFOLDER/account.aspx) ”不行？

这个问题的公认答案（赏金将授予谁）需要能够做到，这样我才能访问[http://CWEBSERVER/DATAFOLDER/account.aspx](http://CWEBSERVER/DATAFOLDER/account.aspx)。谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T15:04:35.857

很可能您只将 IIS 绑定到 IP 地址。转到 IIS 管理器，然后转到网站上的属性。然后，从网站选项卡中，转到属性。

为该主机标头值添加标识。

如有必要，您可以添加多个绑定。

**更新**

我想我知道你现在想要什么了。从 IIS 管理器中，展开您的默认网站。然后右键单击生产虚拟目录并选择“创建虚拟目录”。称这个新的DATAFOLDER。然后将其绑定到文件系统上的现有位置。

我真的认为你需要清理一下。我要做的第一件事是决定如何真正访问所有内容。换句话说，当他们键入[http://www.mysite.org/](http://www.mysite.org/)时 ，应该是什么？如果是 PRODUCTION 目录，则创建一个新**站点**并将其指向 PRODUCTION 目录，然后在其下创建您的 DATAFOLDER 虚拟应用程序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-01-11T06:36:48.430

虽然我没有浏览整个答案列表，但我通过以下方式遇到了这个解决方案。我的网页链接可以使用，`localhost`但不能使用 IP 或计算机名称。它没有任何错误，尤其是 GREAT IE (****)。

为了解决这个问题，我在 IE 的受信任站点中添加了该站点。

可能有助于减少一些挫败感！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-23T13:39:58.930

我有一个类似的问题，通过为我的临时 IIS 服务器分配一个静态 IP 解决了这个问题。（我分配的 IP 地址与动态分配的 IP 地址相同，即 192.168.56.101。）

愿这对某人有所帮助。

还要检查[防火墙](https://stackoverflow.com/questions/1625345/iis7-access-website-from-remote-computer/1625417#1625417)设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T17:58:14.840

像 Chris Lively 所说的那样，为其他主机名添加更多绑定，或者添加一个具有相同内容设置的新站点。IIS 通过查看主机标头信息来做出响应，如果您只有一个绑定到端口 80 的默认网站，它不会处理所有可能的标头。

如果名称是您公司内部的名称，例如机器名称或内部 DNS 条目，您可能会放弃让默认绑定完成这项工作。如果它在测试中不起作用，请为该情况添加一个绑定（CWEBSERVER 或 mysite.org）。如果您关心它的双向工作，请在使用和不使用 www 的情况下对其进行测试。

在 IIS 中为相同的内容添加多个“站点”并没有太大的缺点。例如你可以有

mysite.org 指向 /PRODUCTION/DATAFOLDER/index.html

和

Marketingsite.com 指向 /PRODUCTION/DATAFOLDER/index.html

然后你可以做一些事情，比如有不同的 SSL 设置等等。在我的 Web 服务器上，除非出现问题（比如我设置了一个新的外部 IP 地址并且需要尚未修改绑定），否则默认网站没有任何内容。

选择你的毒药，但基本上你只需要在 IIS 中添加设置，直到它按照你想要的方式处理所有可能的地址。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-28T21:02:28.947

对我来说，这是一个防火墙问题：

1.  转到：控制面板 -> Windows 防火墙 -> 允许程序或功能通过 Windows 防火墙

2.  滚动到列表底部并选择 www 服务 (http) 的复选框。

3.  节省

现在我可以访问[http://computername.domain](http://computername.domain) name

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T15:07:14.153

将“192.168.1.11 cwebserver”添加到 %Windir%/system32/drivers/etc/hosts

# c# - Linq To SQL 附加/刷新实体对象

> ID：898267
> 
> 赞同：11
> 
> 时间：2009-05-22T14:50:44.310
> 
> 标签：c#, .net, linq, linq-to-sql

在 Linq To Sql 中，当更新我的一个实体，Faculty 时，我正在创建一个新的 Faculty 对象实例，然后使用用户提供的值初始化*一些属性。*

如果我将此新对象附加到实体集并提交更改，那么我未设置的属性将采用它们的任何数据类型的默认值。

如何刷新新对象，以便已设置的属性保持其值，而尚未设置的属性从数据库中获取值？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-24T16:02:39.073

你试过了吗

`context.Refresh(RefreshMode.OverwriteCurrentValues, faculty);`

提交更改后，`context`您的 linq2sql 数据上下文在哪里，`faculty`您要刷新的实体是哪里？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T14:54:28.937

如何从数据库中检索对象，然后更改适当的值，然后提交更新？

# c++ - 带有静态 std::vector 的内存泄漏（有点）

> ID：898273
> 
> 赞同：6
> 
> 时间：2009-05-22T14:51:55.493
> 
> 标签：c++, memory, stl, vector, memory-leaks

我`std::vector`在一堂课上有一个静态的。当我使用微软的内存泄漏检测工具时：

```
_CrtMemState state;
_CrtMemCheckpoint( & state);
_CrtMemDumpAllObjectsSince( & state ); 
```

在我将东西插入向量后，它会报告泄漏。这对我来说很有意义，因为当将某些内容插入向量时会分配新空间。在程序终止之前，这个空间不会被释放（因为向量是静态的）。这是正确的吗？

在包含向量的类的析构函数中，我正在删除放入向量中的对象。但是，插入发生时分配的内存仍然存在。有没有办法删除这个空间？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-22T14:57:34.467

您可以将向量与空向量交换 - 这将释放内存。

另请参阅[Q：缩小向量](https://stackoverflow.com/questions/586634/shrinking-a-vector)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T14:59:48.177

补充詹姆斯所写的内容。他的意思是这样做：

```
std::vector<T>().swap(v); 
```

其中“v”是要释放其内存的向量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T09:01:41.750

这只是 Visual Studio 的一个怪癖。矢量析构函数确实释放了内存，但内存检查模块并不总是发现它，所以它会抱怨。这有点痛苦，但没什么好担心的。

# asp.net - 在 IIS 7 问题上托管 Silverlight 视频播放器

> ID：898274
> 
> 赞同：0
> 
> 时间：2009-05-22T14:52:11.797
> 
> 标签：asp.net, iis, hosting, silverlight-2.0

我正在尝试托管一个运行[Silverlight Video Player](http://www.codeplex.com/sl2videoplayer)的 ASP.NET 应用程序。我最近将此应用程序部署到了新的 Windows Server 2008 Virtual PC。我已经在服务器（和 .NET Framework 3.5 SP1）上安装了 Silverlight 插件和 Silverlight 2 SDK。

当我尝试浏览此站点时，视频播放器应加载并向我显示视频。但是，我看到的行为是布局了一个“块”空白，但我没有看到视频或播放器加载。在单独的 Vista 机器上，当托管在 Visual Studio IIS 服务器“Cassini”中时，应用程序可以工作。该应用程序内置于 .NET 3.5 SP1。

有人对 Silverlight 播放器为什么不工作有任何想法吗？要加载的内容包含在项目中，并使用“~/”语法进行引用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:37:19.370

您知道 Silverlight 插件是否正在加载您的应用程序吗？（你能在 App.xaml.cs:Application_Startup 中放一个断点吗？）

如果没有，您是否检查以确保您的 IIS 服务器具有 XAP 文件的 mime 类型？

托管 Silverlight 应用程序的最低要求：

1.  任何网络服务器
2.  XAP 文件的 Mime 类型已设置。

解决此问题时要考虑的一些事项：

*   XAP 文件是否到达客户端？
*   您可以右键单击“空白块”并获得 Silverlight 菜单吗？
*   您看到 XAP 文件通过服务器发送了吗？（尝试 fiddler 或 firebug 来查看流量）
*   如果 Silverlight 应用程序确实可以访问客户端，那么您应该尝试附加调试器。将调试器附加到浏览器，您应该能够调试 Silverlight 应用程序以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T21:10:24.003

问题是由于我将站点部署到 Windows Server 2008 上默认网站下的“应用程序目录”。因此，.XAP 文件的相对链接没有正确解析。我通过将网站部署到默认网站的根目录解决了这个问题，这对我来说很好。

仔细阅读 Brian 的建议对解决这个问题非常有帮助： 1\. 你能右键单击“空白块”并获得 Silverlight 菜单吗？就我而言，我可以。2\. XAP 文件是否到达客户端？您可以从客户端计算机检查 Internet 临时文件以查看它是否正在下载。我的不在这一点上。

# jquery - jQuery遍历问题

> ID：898276
> 
> 赞同：1
> 
> 时间：2009-05-22T14:52:22.263
> 
> 标签：jquery

我有一个可能无限嵌套的树`ol > li`

给定树中的 li ，我需要将一些函数应用于`li`给定 下的所有其他 s `li`，但在当前`ol`. 举个例子：

例如：

```
<ol>
    <li>
        Do not apply to me
        <ol>
            <li>Do not apply to me</li>
            <li>Do not apply to me</li>
        </ol> 
    </li>
    <li>
        Do not apply to me
        <ol>
            <li id='given'>I am the "given" li</li>  <------------- you are here
            <li>Do not apply to me</li>
            <li>
                Do not apply to me
                <ol>
                    <li>Do not apply to me</li>
                    <li>Do not apply to me</li>
                </ol> 
            </li>
        </ol> 
    </li>
    <li>
        Apply to me
    </li>
    <li>
        Apply to me
        <ol>
            <li>Apply to me</li>
            <li>
                Apply to me
                <ol>
                    <li>Apply to me</li>
                    <li>Apply to me</li>
                </ol> 
            </li>
        </ol> 
    </li>
</ol> 
```

实现这一目标的最优雅方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:11:11.943

你可以写：

```
 $("#given").parents("li:first").nextAll("li").find("li").andSelf(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T16:42:21.633

@Gordon 的答案将适用于给定的示例，但如果在包含#given 的 OL 之后立即有另一个 OL，它将不起作用。

```
$("#given").parents("ol").nextAll("ol").find("li").each(function() {
    // function
});
$("#given").parents("li").nextAll("li").find("li").andSelf().each(function() {
    //function
}); 
```

这将起作用，但可能有一种更优雅的方式来完成它。

# xml - XML 中“解析”的反义词

> ID：898280
> 
> 赞同：9
> 
> 时间：2009-05-22T14:52:53.480
> 
> 标签：xml

在 XML 文档中“解析”的反义词是什么。

例如：

*   当您使用 DOM 解析器读取 XML 文件时，它被称为“解析”。
*   当您使用 DOM 解析器创建 XML 文件时，它叫什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T14:56:03.113

序列化

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T15:01:04.290

[序列化](http://en.wikipedia.org/wiki/Serialization)。通货紧缩。构成。存储。冷冻。坚持。

[编组](http://en.wikipedia.org/wiki/Marshalling_(computer_science))是一个类似的概念，但[了解它们之间的差异可能是有益的。](http://www.jguru.com/faq/viewquestion.jsp?EID=429488).

在 Objective-C 中，序列化被称为[归档](http://en.wikipedia.org/wiki/Serialization#Objective-C)。

蟒蛇[泡菜](http://en.wikipedia.org/wiki/Pickle_(Python))。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-11-06T09:17:55.480

我已经看到许多动词被用作“**解析**”的反义词。我不认为它有一个共同的标准。

在 XML 上下文中，我更喜欢将术语“**呈现**”作为“**解析**”的反义词。如果您不喜欢在非视觉环境中使用动词“渲染”，我的第二个选择是“**作曲”。**

但是，尽管从低级别的角度来看它在技术上可能是正确的，但我永远不会为此使用“序列化”一词。如果在同一上下文中也使用“反序列化”一词，这对我来说才合适。但我认为“解析 XML”是这里被广泛接受的标准术语。所以我建议用“渲染XML”或“合成XML”来描述相反的过程。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T14:59:33.713

有人告诉我：作曲

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-22T15:02:49.293

解析，也称为**加载**，是**反序列**化的同义词，即将任意输入转换为易于阅读/可操作的形式。

因此，您不能使用 DOM 解析器创建新文档。然而，完整的 DOM 实现包含**生成**（或**构造**）和**序列化**（或**保存**）XML 文档的机制。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T15:03:50.447

序列化是将 DOM 树转换为输出（文本、文件等）的过程。

我听说组合、生成和构造是新 DOM 树的实际“构建”的术语。

# javascript - 使用 E4X 处理通过 Ajax 返回的 XML？

> ID：898282
> 
> 赞同：0
> 
> 时间：2009-05-22T14:53:07.830
> 
> 标签：javascript, xml, ajax, e4x

我正在通过 Ajax 加载一些 XML。

这是脚本的一个片段：

```
ajaxRequest.onreadystatechange = function()
    {
        if(ajaxRequest.readyState == 4)
        {
            document.getElementById('loading').innerHTML = 'done';
            google_xml = ajaxRequest.responseXML;
            document.getElementById('xml').innerHTML = 'XML: '+google_xml.toXMLString();
        }
    } 
```

我正在加载的页面是一个 XML 文件，文件加载是因为如果我 alert(ajaxRequest.responseText); 我看到了。但我不确定如何将其作为 XML 处理，我认为上面的脚本会将 XML 作为字符串放入 < div id="xml" >< /div > 元素中，但事实并非如此。

我在 Actionscript 中使用 E4X 处理 XML 很多，但在 JS 中从未使用过，有人可以给我提示吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T14:56:56.637

我不确定您使用的是什么浏览器，但[Firefox 是目前唯一支持 E4X 的浏览器](http://www.w3schools.com/e4x/e4x_browsers.asp)。

但是，要扩展此答案，您可能需要了解替代方法：

在浏览器中解析 XML 有很多支持，只是不支持 E4X。您可能想要使用 jQuery 并使用 dataType:XML。请参阅 xml.com/pub/a/

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-12T02:50:01.193

对于那些追随同样问题的人：

var x = new XML('<xml>字符串值</xml>');

...现在您的 x 值是一个 xml 对象，您可以使用 E4X 进行操作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T02:08:16.883

只需在请求完成后使用 xhr.responseXML，它已经是一个支持 DOM 的 XML 对象。如果浏览器支持 XmlHttpRequest 对象，这应该可以直接工作。此外，IIRC，您可以使用 jQuery 来包装对象并使用它自己的 find/each 方法来遍历对象。

# c# - 如何一点一点地建立一个 Linq to Sql where 子句？

> ID：898286
> 
> 赞同：11
> 
> 时间：2009-05-22T14:53:37.753
> 
> 标签：c#, linq-to-sql

我在参数类中传递了一组查询字符串参数，用于查询图像数据库。每次调用时，一些参数可能为空。所以在sql中我会建立这样的查询

```
if (parameters.Value1 != null)
{
    sql.Append("sql_where_clause");
}

if (parameters.Value2 != null)
{
    sql.Append("sql_where_clause");
} 
```

我如何使用 Linq 做同样的事情？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T14:59:39.923

动态构建 where 子句的最佳方法是使用出色的 Albahari [PredicateBuilder](http://www.albahari.com/nutshell/predicatebuilder.aspx)。

您可以使用它来构建包含`OR`和 的where 子句表达式`AND`。对此的语言集成支持最初是打算的，但[并没有完全](http://social.msdn.microsoft.com/forums/en-US/linqprojectgeneral/thread/f79d7065-a3b7-47ad-a02f-44858b8ad3b6/)融入 C# 3。

例如：

```
var whereClause = PredicateBuilder.False<Customer>();

if (parameters.Value1 != null)
{
    whereClause = whereClause.Or(customer => customer.City == parameters.Value1);
}

var query = db.Customers.Where(whereClause); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-22T14:56:34.890

很简单，在您枚举之前不会评估 IQueryables，因此只需继续标记 where 子句。

```
if (parameters.Value1 != null)
{
    results = results.Where(x => <some condition>);
}

if (parameters.Value2 != null)
{
    results = results.Where(x => <some other condition>);
} 
```

# emacs - 如何发现细微的 Lisp 语法错误？

> ID：898287
> 
> 赞同：14
> 
> 时间：2009-05-22T14:53:56.037
> 
> 标签：emacs, syntax, lisp, elisp, indentation

我是一个使用 Lisp（实际上是 Emacs Lisp）的新手。这很有趣，除非我似乎一次又一次地遇到相同的语法错误。

例如，这是我多次遇到的情况。我有一些`cond`形式，比如

```
(cond
 ((foo bar)
  (qux quux))
 ((or corge
      (grault warg))
  (fred)
  (t
   xyzzy))) 
```

并且返回的默认子句`xyzzy`永远不会执行，因为它实际上嵌套在前一个子句中：

```
(cond
 ((foo bar)
  (qux quux))
 ((or corge
      (grault warg))
  (fred))
 (t
  xyzzy)) 
```

当缩进的差异只有一个空格时，我很难看到这样的错误。随着时间的推移，这会变得更容易吗？

当（错误）缩进线和它应该缩进的线之间的距离很大时，我也会遇到问题。`let`例如，具有许多复杂绑定的`unless`表单，或具有长条件的表单：

```
(defun test ()
  (unless (foo bar
               (qux quux)
               (or corge
                   (grault warg)
                   (fred))))
  xyzzy) 
```

事实证明`xyzzy`根本不在`unless`表单内：

```
(defun test ()
  (unless (foo bar
               (qux quux)
               (or corge
                   (grault warg)
                   (fred)))
    xyzzy)) 
```

我习惯性地自动缩进并使用括号突出显示来避免计算括号。在大多数情况下，它的工作就像轻而易举，但偶尔，我只是通过调试才发现我的语法错误。我能做些什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-22T15:08:49.343

### 突出性别

首先，`show-paren-mode`如果还没有打开内置的括号匹配突出显示 ( )。它总是让您了解您所处的缩进级别。

还有一些更复杂的软件包。例如，请参阅[TJ 对 的回答`mic-paren`](https://stackoverflow.com/questions/898287/how-can-i-spot-subtle-lisp-syntax-mistakes/898514#898514)。或者虽然我觉得它不适合我，但是[舒马赫的高亮括号模式](http://amitp.blogspot.com/2007/05/emacs-highlighting-parentheses.html)可以用不同的颜色突出显示每个表情块。甚至[爱德华·奥康纳（Edward O'Connor）也有](http://edward.oconnor.cx/elisp/hl-sexp.el)突出当前性别的模式。

### 编辑

使用[`paredit-mode`](http://www.emacswiki.org/emacs/ParEdit)它可以帮助您编写 sexps。您可以轻松地在 sexps 之间导航并重新构建代码。此外，它确保括号始终平衡。当我第一次尝试它时，Paredit 如何限制编码方式对我来说非常烦人，但从那以后我习惯了使用它，我的工作效率提高了很多，并且永远不会对左括号和右括号感到困惑。

### 自动缩进

使用[Emacs Starter Kit](http://www.emacsblog.org/2008/12/05/emacs-starter-kit/)，默认情况下，它为 Elisp 中的编码提供了许多有用的帮助程序，例如在换行符上重新缩进。

### 埃尔多克

`emacs-lisp-mode`有几个有用的扩展。例如，我总是使用`eldoc-mode`在回显区域显示当前正在输入的函数的参数列表或变量的文档字符串。它还可以帮助您轻松识别您是否在错误的街区。

### 调试

我差点忘了提到[Edebug](http://www.gnu.org/software/emacs/elisp/html_node/Using-Edebug.html)，作为最后的机会，它总是可以帮助您弄清楚代码中发生了什么。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T15:35:22.850

以下是您可以做的三件事来帮助您发现 Lisp 语法问题。随着时间的推移，它会成为第二天性。但在那之前：

### 括号匹配

括号匹配是检查分组的最简单方法。我最喜欢的包是[mic-paren](http://www.emacswiki.org/emacs/mic-paren.el)。我喜欢这个特殊的配置：

```
(setq paren-dont-touch-blink t)
(require 'mic-paren)
(paren-activate)
(setq paren-match-face 'highlight)
(setq paren-sexp-mode t) 
```

这会导致当点位于 sexp 的开头/结尾时突出显示 sexp（匹配括号）。如果括号不匹配，则突出显示颜色不同 - 并且更亮。当匹配的括号不在屏幕上时，它会向您显示该端在 minibuffer 中的样子（并告诉您它有多少行）。

### 汇编

对于稍微复杂一点的方法，您可以使用`M-x compile-defun`. 例如，当我编译这个简单的例子时：

```
(defun mytestfun ()
  (let ((cur (current-buffer)))
    )
  (set-buffer cur)) 
```

我有一个名为的缓冲区`*Compile-Log*`，它说：

> 警告：对自由变量“cur”的引用

这使我了解到我在定义它`cur`的语句之外使用的事实。`let`

### 更改缩进级别

如果您希望缩进更突出，您可以自定义变量`listp-body-indent`：

```
(setq lisp-body-indent 4) ;# default is 2 
```

您还可以自定义各种结构的缩进方式，但我不建议这样做，因为它是非标准的，并且在查看大多数 Lisp 代码时可能会导致混淆。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T15:02:19.933

一件简单的事情是将光标移动到每个`cond`条件的开头，然后查看结束括号的位置。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T15:08:37.520

编写 lisp 的“最佳”方式是 emacs + slime 组合。它提供括号突出显示、制表符补全，您可以直接跳转到 lisp hyperspec 文档，它提供函数的变量名（见下文）等等。

(defun foo (bar) ...)

当你开始输入 (foo 它会告诉你 foo 想要一个名为 bar 的参数。这样你可以很容易地“猜测”一个函数需要什么参数。这对于不遵循 Lisp 约定的函数特别方便。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T14:58:59.457

> 当缩进的差异只有一个空格时，我很难看到这样的错误。随着时间的推移，这会变得更容易吗？

至少不适合我.. 它确实部分取决于您使用的特定 xterm 字体，但我发现我需要一个四空格缩进才能有效工作（是的，我使用旧的原始 xterm 字体 - 归咎于 SunOS 4） ，甚至两个都是有问题的。

我也使用括号突出显示，并且“ `%`”键在`vi`.

不幸的是，这不是一个非常有用的答案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-20T15:01:05.797

我看到您可以采取两种方法来帮助您的两个示例。

第一种方式是先画大图写代码，后面再填写细节。对于你的第一个例子，你可以先写这个

```
(cond
 (--
  --)
 (--
  --)
 (t
  --)) 
```

然后您可以开始填写详细信息。' `--`s 就像 TODO 填充物。

你的第二个例子。你可以从

```
(defun test ()
  --) 
```

然后填写更多这样的：

```
(defun test ()
  (unless (--)
    --)) 
```

然后填充更多。

另一种方法是自定义彩虹分隔符，以便它以一种颜色突出显示偶数级别的括号，并以另一种颜色突出显示奇数级别的括号。这将有助于 cond 形式。它对您的第二个示例没有帮助，但如果它是`(xyzzy)`而不是`xyzzy`，它将有。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-30T10:33:11.790

为了补充其他人的宝贵意见，我会说“使用基于结构的移动命令” `backward-sexp`，`forward-sexp`等等。这使您可以四处导航。

# sharepoint - SharePoint - 无需手动解析即可获取计算字段的值

> ID：898291
> 
> 赞同：10
> 
> 时间：2009-05-22T14:54:45.893
> 
> 标签：sharepoint, sharepoint-2007

我在一个列表中有一个计算字段，这个公式：
`=CID & " - " & Title`

查看列表时，可能会显示为：“2 - Big Meeting”。当我像这样从代码中获取值时：
`myItem["CIDandTitle"]`

该值返回为：“字符串；#2 - BigMeeting”。sharepoint 中是否有“正确”的方法来提取值，或者我应该简单地拆分分号和井号？

我正在使用MOSS2007。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-22T15:00:36.223

您必须将其转换为 SPCalculatedField：

```
SPFieldCalculated cf = (SPFieldCalculated)myItem.Fields["CIDandTitle"];
string value = cf.GetFieldValueForEdit(myItem["CIDandTitle"]); 
```

或者

```
string value = cf.GetFieldValueAsText(myItem["CIDandTitle"]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-20T10:15:17.740

@Nathan 给出的答案没有指定您需要提供该字段的显示名称。它不适用于内部名称。此外，我可能会使用*as*来转换结果。

```
var cf = list.Fields["calculatedfieldDisplayName"] as  SPFieldCalculated;
String value = cf.GetFieldValueAsText(item["calculatedfieldDisplayName"]); 
```

# report - SAS BI 仪表板反馈 - 您的体验如何？

> ID：898294
> 
> 赞同：1
> 
> 时间：2009-05-22T14:55:24.533
> 
> 标签：report, sas, business-intelligence, dashboard

**Backgroup：** 我们正在研究 SAS BI Dashboard。我们目前已经实现了几乎所有 SAS 的其他应用程序（Enterprise Miner 除外）。其他在线技术包括 Business Objects、一些自定义报告内容和 Project R。

**问题：** 您有什么反馈：

1.  实施 SAS BI 仪表板
2.  在 BI 中构建仪表板和报告
3.  将 BI 与其他技术、数据库和 SAS 数据集联系起来

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:04:15.730

由于许可成本和实施难度（您必须使用特定的——而不是最新的——WebLogic 版本等），我们完全放弃了 BI Dashboard 并用 LifeRay（开源门户）取而代之。

SAS 分析、图形等通过对 SAS 存储过程服务器的 weblogic 调用浮出水面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T23:40:02.467

我自己并没有经常使用它，但一个朋友已经为上一届 SAS 全球论坛写了一篇论文，该主题可能会为您提供一些有用的信息。

[http://support.sas.com/resources/papers/proceedings09/044-2009.pdf](http://support.sas.com/resources/papers/proceedings09/044-2009.pdf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-26T20:08:17.280

我没有使用新的 SAS“BI Dashboard”产品，但我已经使用 SAS/Graph 完成了很多仪表板，例如以下（包括这里，以及用于创建它们的 SAS 代码）：

[http://robslink.com/SAS/dashboards/aaaindex.htm](http://robslink.com/SAS/dashboards/aaaindex.htm)

以这种方式制作仪表板，您可以以交互方式或从批处理作业创建独立的 Web 输出（如上面的输出），或者您可以在通过 SAS/Intrnet 或 BI 单击网页时即时生成它们存储过程。可以在简单的 Web 浏览器中查看输出，和/或您可以在门户（无论是 SAS 门户、SAS Web Report Studio 或其他）中显示 URL 输出。

# iphone - NSUserDefaults：+resetStandardUserDefaults 方法有什么用？如何提供“系统设置”？

> ID：898301
> 
> 赞同：2
> 
> 时间：2009-05-22T14:56:38.760
> 
> 标签：iphone, cocoa-touch, uikit, nsuserdefaults

我希望用户能够做出一些偏好，如颜色、首选图像等。当我为此使用 NSUserDefaults 时，在应用程序的第一次启动时不会有偏好，对吧？所以，每次我想得到一个偏好

NSInteger avatarID = (NSInteger)[[NSUserDefaults standardUserDefaults] objectForKey:@"avatar"];

我必须检查它是否为空，然后使用我的系统偏好。但后来我在文档中看到了这一点：+resetStandardUserDefaults

是否有两个默认分支保存在某处？来自用户的，来自开发者的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T15:07:27.973

是的，但这与您正在做的事情有点不同。NSUserDefaults 有一个`registerDefaults`方法，它允许您使用您提供的值填充 NSDictionary 中的“空白”默认值。把它放在你的应用控制器的 +initialize 方法中，你就会知道默认值是合理的。如果用户默认对象找到一个键的“真实”值，无论是您在当前应用程序启动期间设置的值还是从磁盘加载的值，它将始终优先于您在`registerDefaults`. `resetStandardUserDefaults`将从内存中删除共享用户默认对象并撤消您对其所做的任何自定义，这不是您需要提供默认值的东西。

另外，请记住，您不能只是将对象转换为原始的 NSInteger 值，因为您最终会得到一个表示对象指针的内存位置的数字。要么使用 NSUserDefault`integerForKey:`直接获取原始值，要么使用`objectForKey:`获取 NSNumber 并使用`integerValue`获取原始值。

# c# - 如何自动滚动到多行文本框的底部？

> ID：898307
> 
> 赞同：337
> 
> 时间：2009-05-22T14:57:54.733
> 
> 标签：c#, winforms, textbox, scroll

我有一个将 .Multiline 属性设置为 true 的文本框。我会定期向其中添加新的文本行。我希望文本框在添加新行时自动滚动到最底部的条目（最新的条目）。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：475
> 
> 时间：2013-02-15T01:12:33.737

> 我会定期向其中添加新的文本行。我希望文本框在添加新行时自动滚动到最底部的条目（最新的条目）。

如果使用[`TextBox.AppendText(string text)`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.appendtext.aspx)，它将自动滚动到新附加文本的末尾。如果您在循环中调用它，它可以避免闪烁的滚动条。

它也恰好比连接到`.Text`属性上快一个数量级。尽管这可能取决于您调用它的频率；我正在用一个紧密的循环进行测试。

* * *

如果在显示文本框之前调用它，或者如果文本框不可见（例如在 TabPanel 的不同选项卡中），则不会滚动。请参阅[TextBox.AppendText() not autoscrolling](https://stackoverflow.com/questions/18260702/textbox-appendtext-not-autoscrolling)。这可能很重要，也可能不重要，具体取决于您在用户看不到文本框时是否需要自动滚动。

在这种情况下，其他答案的替代方法似乎也不起作用。一种解决方法是对`VisibleChanged`事件执行额外的滚动：

```
textBox.VisibleChanged += (sender, e) =>
{
    if (textBox.Visible)
    {
        textBox.SelectionStart = textBox.TextLength;
        textBox.ScrollToCaret();
    }
}; 
```

* * *

在内部，`AppendText`做这样的事情：

```
textBox.Select(textBox.TextLength + 1, 0);
textBox.SelectedText = textToAppend; 
```

但是应该没有理由手动进行。

^(（如果你自己反编译它，你会发现它使用了一些可能更有效的内部方法，并且似乎是一个小特例。）)

* * *

## 回答 #2

> 赞同：154
> 
> 时间：2009-05-22T14:58:50.923

您可以使用以下代码片段：

```
myTextBox.SelectionStart = myTextBox.Text.Length;
myTextBox.ScrollToCaret(); 
```

它将自动滚动到最后。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2013-01-13T01:33:31.010

[.NET](http://en.wikipedia.org/wiki/.NET_Framework) 4.0中的界面似乎发生了变化。有以下[方法](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k%28SYSTEM.WINDOWS.CONTROLS.PRIMITIVES.TEXTBOXBASE.SCROLLTOEND%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK,VERSION=V4.0%22%29;k%28DevLang-CSHARP%29&rd=true)可以实现上述所有功能。正如 Tommy Engebretsen 所建议的那样，将它放在 TextChanged 事件处理程序中使其自动化。

```
textBox1.ScrollToEnd(); 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-08-29T08:49:04.137

尝试将建议的代码添加到 TextChanged 事件：

```
private void textBox1_TextChanged(object sender, EventArgs e)
{
  textBox1.SelectionStart = textBox1.Text.Length;
  textBox1.ScrollToCaret();
} 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2015-04-15T09:03:55.403

```
textBox1.Focus()
textBox1.SelectionStart = textBox1.Text.Length;
textBox1.ScrollToCaret(); 
```

对我不起作用（Windows 8.1，不管是什么原因）。
由于我仍在使用 .NET 2.0，因此无法使用 ScrollToEnd。

但这有效：

```
public class Utils
{
    [System.Runtime.InteropServices.DllImport("user32.dll", CharSet = System.Runtime.InteropServices.CharSet.Auto)]
    private static extern int SendMessage(System.IntPtr hWnd, int wMsg, System.IntPtr wParam, System.IntPtr lParam);

    private const int WM_VSCROLL = 0x115;
    private const int SB_BOTTOM = 7;

    /// <summary>
    /// Scrolls the vertical scroll bar of a multi-line text box to the bottom.
    /// </summary>
    /// <param name="tb">The text box to scroll</param>
    public static void ScrollToBottom(System.Windows.Forms.TextBox tb)
    {
        if(System.Environment.OSVersion.Platform != System.PlatformID.Unix)
             SendMessage(tb.Handle, WM_VSCROLL, new System.IntPtr(SB_BOTTOM), System.IntPtr.Zero);
    }

} 
```

VB.NET：

```
Public Class Utils
    <System.Runtime.InteropServices.DllImport("user32.dll", CharSet := System.Runtime.InteropServices.CharSet.Auto)> _
    Private Shared Function SendMessage(hWnd As System.IntPtr, wMsg As Integer, wParam As System.IntPtr, lParam As System.IntPtr) As Integer
    End Function

    Private Const WM_VSCROLL As Integer = &H115
    Private Const SB_BOTTOM As Integer = 7

    ''' <summary>
    ''' Scrolls the vertical scroll bar of a multi-line text box to the bottom.
    ''' </summary>
    ''' <param name="tb">The text box to scroll</param>
    Public Shared Sub ScrollToBottom(tb As System.Windows.Forms.TextBox)
        If System.Environment.OSVersion.Platform <> System.PlatformID.Unix Then
            SendMessage(tb.Handle, WM_VSCROLL, New System.IntPtr(SB_BOTTOM), System.IntPtr.Zero)
        End If
    End Sub

End Class 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2011-08-23T23:55:24.860

我需要添加一个刷新：

```
textBox1.SelectionStart = textBox1.Text.Length;
textBox1.ScrollToCaret();
textBox1.Refresh(); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-04-22T10:03:28.733

我发现了这个线程中没有解决的一个简单的区别。

如果您将所有`ScrollToCarat()`调用作为表单`Load()`事件的一部分进行，则它不起作用。我刚刚将我的`ScrollToCarat()`调用添加到我的表单`Activated()`事件中，它工作正常。

**编辑**

重要的是仅在第一次`Activated`触发表单事件时进行滚动（而不是在后续激活时），否则**每次**激活表单时都会滚动，这可能是您不想要的。

因此，如果您只是`Activated()`在程序加载时捕获事件以滚动文本，那么您可以取消订阅事件处理程序本身内的事件，因此：

```
Activated -= new System.EventHandler(this.Form1_Activated); 
```

如果您在每次激活表单时都需要做其他事情，您可以`bool`在第一次`Activated()`触发事件时将 a 设置为 true，这样您就不会滚动后续激活，但仍然可以做您需要做的其他事情做。

此外，如果您`TextBox`的选项卡不是`SelectedTab`,`ScrollToCarat()`将无效。因此，您至少需要在滚动时将其设为选定选项卡。如果您在执行此操作时表单闪烁，您可以将代码包装在 a`YourTab.SuspendLayout();`和pair 中。`YourTab.ResumeLayout(false);`

**编辑结束**

希望这可以帮助！

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2021-09-03T05:30:31.417

我用这个。简单、干净、快速！

```
txtTCPTxRx.AppendText(newText); 
```

下面是我使用的实际代码

```
ThreadSafe(() =>
      {
          string newLog = $"{DateTime.Now:HH:mm:ss:ffff->}{dLog}{Environment.NewLine}";
          txtTCPTxRx.AppendText(newLog);
      }); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-02-26T21:45:46.240

关于皮特关于选项卡上的文本框的评论，我让它工作的方式是添加

```
textBox1.SelectionStart = textBox1.Text.Length;
textBox1.ScrollToCaret(); 
```

到选项卡的 Layout 事件。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-04-16T16:05:08.550

当文本更改时，这将滚动到文本框的末尾，但仍允许用户向上滚动

```
outbox.SelectionStart = outbox.Text.Length;
outbox.ScrollToEnd(); 
```

在 Visual Studio Enterprise 2017 上测试

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-02-14T19:35:02.250

对于其他希望看到 webforms 实现的人，您希望使用页面请求管理器的 endRequest 事件处理程序 ( [https://stackoverflow.com/a/1388170/1830512](https://stackoverflow.com/a/1388170/1830512) )。这是我在母版页的内容页中为我的 TextBox 所做的，请忽略我没有为控件使用变量的事实：

```
var prm = Sys.WebForms.PageRequestManager.getInstance();

function EndRequestHandler() {
    if ($get('<%= ((TextBox)StatusWindow.FindControl("StatusTxtBox")).ClientID %>') != null) {
        $get('<%= ((TextBox)StatusWindow.FindControl("StatusTxtBox")).ClientID %>').scrollTop = 
        $get('<%= ((TextBox)StatusWindow.FindControl("StatusTxtBox")).ClientID %>').scrollHeight;
    }
}

prm.add_endRequest(EndRequestHandler); 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2014-10-10T09:51:05.433

这只对我有用......

txtSerialLogging->Text = "";

txtSerialLogging->AppendText(s);

我尝试了上述所有情况，但问题是在我的情况下 text 可以减少，增加并且也可以长时间保持静止。静态意味着，静态长度（行），但内容不同。

所以，当长度（线）在一段时间内保持不变时，我最后面临着一种跳线的情况......

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2014-12-18T18:08:28.280

我为此使用了一个函数：

```
private void Log (string s) {
    TB1.AppendText(Environment.NewLine + s);
    TB1.ScrollToCaret();
} 
```

# iphone - 如何简化 iPhone 本地化？

> ID：898308
> 
> 赞同：13
> 
> 时间：2009-05-22T14:57:58.867
> 
> 标签：iphone, localization

我需要为英语和西班牙语本地化开发中的应用程序。

尽管我遵循 Apple 使用 NSLocalizedString 的方式并为两者创建 nib，但我已经丢失了需要本地化的新字符串的踪迹，并且惊讶地发现当我更换 master 时我需要用西班牙语重做 nib。

（就像这个[http://www.gigliwood.com/weblog/Cocoa/A_Great_Need_for_Be.html](http://www.gigliwood.com/weblog/Cocoa/A_Great_Need_for_Be.html)）

我想知道是否存在更好/替代/更自动化的方式。

我知道 gettext 和 poedit 的用法，想知道是否可以使用类似的东西。

或者，如果存在一些脚本或工具。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-22T15:27:01.477

这里真的没有一个简单的解决办法。NIB 需要为每种语言单独布局。在某种程度上，这改善了整体用户界面，因为不同的语言实际上通常需要不同的布局才能看起来最好。俄语和德语在屏幕空间中是比英语“更大”的语言。中文通常可以小得多，并且不同的布局看起来更好用中文字符。阿拉伯语和希伯来语是从右到左的，可能需要彻底改变布局。自动布局很容易，但通过在所有语言中呈现不同程度的丑陋来实现这一点。当在开发人员容易和丑陋与开发人员困难和美观之间进行选择时，Apple 几乎总是选择后者。话虽如此，Apple 仍然没有尽可能简单地做到这一点。

所以这里的第一课是保持你的NIB*简单*。这在 iPhone 上比在 Mac 上更容易，因为 iPhone 没有绑定，而且 iPhone NIB 通常更简单。您还可以对具有非常少量文本（如标题）的 NIB 使用文本注入。“文本注入”是一种奇特的说法，即“在加载视图时使用标签的出口并将其设置为本地化文本”。

ibtool 能够从 NIB 中拉出字符串并将它们推回，这会很有帮助。我使用过 iLocalize，它有助于与合同本地化人员一起工作，但对您所说的问题并没有真正的帮助。

我尝试摆脱 NIB 并只使用代码，认为它会使事情变得更容易，但事实并非如此。在 NIB 中布局每种语言比提出在所有语言中看起来都不错的布局逻辑更容易（见第一段）。文本注入仅在少数地方有用。如果您可以将您的 NIB 拆分为需要本地化的和不需要本地化的，那会很有帮助。在 iPhone 上，我发现我的 NIB 中只有不到一半实际上有文本或本地化图像。

当然，您应该阅读[Internationalization Programming Topics](http://developer.apple.com/iphone/library/documentation/MacOSX/Conceptual/BPInternational/BPInternational.html)，但很抱歉，您的问题确实没有简单的答案。运送产品以 19 种语言本地化，我感到你的痛苦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-29T06:48:48.367

有时需要为每种语言布局 NiB，但大多数时候不必为每种语言重新布局。

如果您使用 ibtool 从笔尖生成字符串

*ibtool --generate-strings-file*

您可以将它们导入每种语言的新笔尖。

*ibtool --import-strings-file*

这些是命令行工具，因此它们是可编写脚本的。看看'man ibtool'

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-05T10:03:48.800

我所做的是为我的 nib 文件（UILabel、UITextField、UITextView 等）中的所有文本 ui 创建 IBOutlets，并以编程方式将其 text/placeHolder 属性分配给所需的 NSLocalizaedString。

鉴于我已经提供了不同语言的特定字符串的翻译，当 iPhone 语言环境更改时，文本的翻译版本将出现在 nib 文件中。

希望其他人觉得这很有用

# reporting-services - 如何在 Reporting Services 的文本框中引用组数据？

> ID：898309
> 
> 赞同：2
> 
> 时间：2009-05-22T14:58:39.597
> 
> 标签：reporting-services, textfield

我正在创建一个包含按部门代码分组的表格的报告。最后有一个分页符，所以每一页只有那个部门代码的数据。在表格之外，我想要一个包含该页面/组的部门代码的文本框。

我已经尝试使用隐藏的数据列，但文本框最终只在每一页上显示最后一页的部门代码。我想我错过了一个简单的解决方案，但我想不通，谷歌似乎让我失望了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T12:15:13.907

您是否可以向表中添加一个列，该列对用户来说看起来就像它在表的其余部分之外，但实际上在表中。也许填充几个空白列然后显示数据。

如果您正在处理表格逻辑中的分页符，您可能必须将数据保留在表格中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:36:44.950

问题是您只是将报表设置为在数据中的某些点处中断，而不是通过向子报表传递参数来多次呈现子报表。数据只存在于表的范围内。

您可以做的是设置一个接受部门参数并为一个部门生成数据的子报表。在子报告中，您可以通过引用正在传递的参数来添加标题。然后在您的主报告中创建一个包含独特部门数据集的表格。在表格中按部门分组，将子报表拖入表格并设置参数。如果你做对了，你应该得到相同的效果，但使用部门标题。

如果您需要更多说明，请随时询问。

# sql-server - 我的数据库安全性是如何失败的？

> ID：898319
> 
> 赞同：6
> 
> 时间：2009-05-22T15:00:01.310
> 
> 标签：sql-server, sql-server-2005, security

在我的 SQL Server 2005 数据库中的几个表中，我的所有数据都已被删除。无论如何，是否可以在 SQL Server 中记录过去一天运行的所有语句？我试图找出是否有人意外执行此操作，我的网络应用程序中存在漏洞，或者实际数据库已被破坏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T15:04:37.497

您正在寻找*事务日志*。根据设置的方式和设置，您将能够看到运行的内容。[在http://www.databasedesign-resource.com/sql-server-transaction-log.html](http://www.databasedesign-resource.com/sql-server-transaction-log.html)上有一些关于它的信息。鉴于此，我相信你也可以谷歌一些更好的资源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T15:11:06.470

您也可以尝试运行命令 DBCC LOG(database,3)。它将输出事务日志中的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T15:01:35.333

请参阅以下内容，其中有几个程序可以让您阅读日志。

[https://web.archive.org/web/20080215075500/http://sqlserver2000.databases.aspfaq.com/how-do-i-recover-data-from-sql-server-s-log-files.html](https://web.archive.org/web/20080215075500/http://sqlserver2000.databases.aspfaq.com/how-do-i-recover-data-from-sql-server-s-log-files.html)

Red Gate的那个[叫 SQL Rescue](http://www.red-gate.com/products/SQL_Log_Rescue/index.htm)，看起来还不错。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T15:02:46.640

您可以尝试使用 Log Rescue 之类的日志救援[工具](http://www.red-gate.com/products/SQL_Log_Rescue/index.htm)

我也会整理一些你自己的审计。

Log Rescue 不支持 SQL 2005，因此您也可以尝试[Apex SQL Log](http://www.apexsql.com/sql_tools_log.asp)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T15:04:32.970

您可以购买一些应用程序，它们可以将事务日志备份转换为实际运行的语句。您也许可以找到其中一些的试用版，但不幸的是，我无法推荐任何特定的版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T15:10:32.337

还有一点要记住：如果黑客获得了足够的访问权限来清理某些表，那么他们很有可能获得了足够的访问权限来处理您的日志文件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-22T15:11:40.617

在 SQL Server 中进行事务日志备份，下载 TOAD for SQL Server 的试用版，您可以在其中导入事务日志备份。

如果您愿意，您还可以创建已删除记录的插入脚本。但是不知道TOAD试用版有没有限制。

# rest - 记录 RESTful API 的标准方法

> ID：898321
> 
> 赞同：73
> 
> 时间：2009-05-22T15:00:21.247
> 
> 标签：rest, documentation

我正在为新的内部 Web 服务编写 RESTful API 规范。它不是很长而且相当简单，但即便如此，这是我第一次使用严格的 REST（而不是出于实际原因作弊 - 避免`PUT`并且`DELETE`因为它们是 PHP 的痛苦，等等）。我想知道是否有任何标准方法或最佳实践来记录 REST 接口？我希望团队的其他成员一眼就能理解它，并且任何想要编写客户端的人都能够在不了解底层代码的情况下这样做。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2014-08-12T13:44:58.953

当然，[REST API 应该在理想情况下使用 HATEOAS 并且是超文本驱动的](http://www.django-rest-framework.org/topics/rest-hypermedia-hateoas)（大量使用媒体类型），但为开发人员提供简单的人性化文档也是有帮助的。

一些有助于生成这样的文档的特定工具：

*   [昂首阔步](https://helloreverb.com/developers/swagger)
    *   描述 REST API 的开放规范 [ [github](https://github.com/wordnik/swagger-spec) ]
    *   自动生成工具
        *   文档
        *   API 代码
    *   捐赠给 OpenAPI 倡议并[于 2015 年更名为 OpenAPI](https://swagger.io/blog/difference-between-swagger-and-openapi/)
*   [捣碎](http://support.mashery.com/docs/read/IO_Docs)
    *   一个开源项目 [ [github](https://github.com/mashery/iodocs) ]
    *   生成工具
        *   文档
        *   API 的探索接口
*   [养蜂场](http://apiary.io/how-it-works)和[API 蓝图](http://apiblueprint.org/)
    *   将 API 描述写在 markdown 中的 DSL 中
    *   自动生成工具
        *   文档
        *   模拟服务器
    *   *似乎专注于 ruby​​+mac 开发人员*
*   [随机存取存储器](http://raml.org/)
    *   描述 REST API 的规范 [ [github](https://github.com/raml-org/raml-spec) ]
*   [WADL](http://www.w3.org/Submission/wadl/)
    *   使用 XML 编写可发现 API 文档的规范
    *   [比较 WSDL 和 WADL 的](http://rest.elkstein.org/2008/02/documenting-rest-services-wsdl-and-wadl.html)一些讨论
*   [APIgee](http://apigee.com/docs/developer-services/content/using-smartdocs-document-apis)
    *   具有一些文档功能的商业产品
*   [3规模](http://www.3scale.net/)
    *   具有一些文档功能的商业产品
*   [缩孔](http://www.miredot.com/)
    *   商业 REST API 文档生成器
    *   特定于 Java

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-05-19T23:06:45.430

我一直在使用[http://apiary.io](http://apiary.io)，非常好。您还可以将 API 文档导出到 github。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-22T17:11:39.303

在罗伊的帖子中[，](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)他说

> REST API 应该花费几乎所有的描述性工作来定义用于表示资源和驱动应用程序状态的媒体类型，或定义扩展关系名称和/或现有标准媒体类型的超文本启用标记。描述在感兴趣的 URI 上使用什么方法所花费的任何努力都应该完全在媒体类型的处理规则范围内定义（并且在大多数情况下，已经由现有媒体类型定义）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-26T20:26:27.360

一个好的 ReST 文档意味着记录您的媒体类型并且仅记录您的媒体类型。

在典型情况下，您会生成如下文档：

## Acme Corp XML 格式

### 链接发现

各种资源的链接在文档中进行了描述，可以通过在书签 URI（通常是服务器的根目录，[http://www.acme.org](http://www.acme.org)）上向服务器发出 GET 或 HEAD 请求并查找HTTP 链接头：

`Link: <xxx>;rel="http://rel.acme.org/services";type=application/vnd.acme.services+xml`

其中`rel`part是链接关系，and`xxx`是已经建立关系的URI。

## 链接关系

本文档定义了以下关系名称：

*   [http://rel.acme.org/services](http://rel.acme.org/services) 链接关系描述了可以导航的链接列表。
*   [http://rel.acme.org/customers](http://rel.acme.org/customers) 使用此关系的链接是客户列表。

## 媒体类型

这`application/vnd.acme.services+xml`是一个带有`xml`序列化的文档，描述了应用程序可能想要处理的链接列表。

```
<links>
 <link rel="http://rel.acme.org/customers" href="http://www.acme.org/services/customers" type="application/vnd.acme.customers+xml" />
</link> 
```

这`applcation/vnd.acme.customers+xml`是一个描述客户的带有`xml`序列化的文档。

### 示例文档：

```
<customers>
 <customer firstname="Darth" lastname="Vador" href="http://www.acme.org/services/customers/28" />
</customer> 
```

ETC...

关键是为开发人员提供一种方法来遵循您定义的链接。首先找到指向*索引*的链接，以便他们可以获取可以导航到的内容列表。

一旦他们发现了该文档，他们就会发现他们可以看到某个 Uri 的客户列表，并且可以`GET`针对它进行操作。

如果他们找到感兴趣的客户，他们可以按照定义的链接`/customers/customer/@href`并发出 a`GET`来检索该客户的表示。

从那里，您的媒体类型可以使用更多链接嵌入用户可用的操作。您还可以选择在资源上发出 OPTIONS 请求以了解您是否可以允许删除资源，或者如果您可以在修改后将文档保存回来，则可以使用 PUT。

所以一个好的文档永远不会：

*   给静态链接
*   进行交互，例如“您可以使用此媒体类型在 Customer 上发出 POST，这将意味着移动操作”。客户应该只因为您的 XML 文档已经以这种方式指定了它，才应该针对 Customer 发出 POST。

所有这一切的重点是实现客户端和服务器之间的最小耦合。客户端可以非常聪明地显示和发现资源（显示表单，天知道还有什么），但对于实际的工作流程是完全愚蠢的：服务器决定。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-22T17:22:34.780

在我的公司，我们很高兴使用[WADL](https://wadl.dev.java.net/)，Web 应用程序描述语言。维基百科将其[描述](http://en.wikipedia.org/wiki/Web_Application_Description_Language)为：“一种基于 XML 的文件格式，提供基于 HTTP 的 Web 应用程序的机器可读描述”。我发现原始 WADL 易于编写、阅读和理解，并且它直接映射到 RESTful 概念。官方项目提供了一个简单的规范、XSD 和 RELAX NG 模式以及 Java 工具。

存在许多用于使用 WADL 的工具和资源，包括：

*   [wadl_stylesheets](http://github.com/mnot/wadl_stylesheets/tree/master) , XSLT 样式表，用于从 WADL 文件创建 HTML 文档
*   [Restlet](http://www.restlet.org)是一个用于构建 RESTful 服务器和客户端的 Java 框架，包括一个 WADL 扩展

`doc`提示：尝试通过使用 XHTML 命名空间包含 HTML 元素，在 WADL 文档的元素中包含人类可读的文档，例如描述、概念、入门、使用提示等。它可以带来很大的不同！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-06-29T11:23:43.347

最初，我们寻求资源的静态文档，但不得不提出太多问题。最终，我们转而使用使用 IO/Docs（实际上是[fork](https://github.com/vkorapaty/iodocs)）的 Live 文档页面。工作得很好。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-03-01T10:27:08.960

您可能会发现[rest-tool](http://tombenke.github.io/rest-tool/index.html)很有用。

它遵循与语言无关的方法来为 RESTful API 编写规范、模拟实现和自动化单元测试。它还提供了一本烹饪书，但它处于非常早期的阶段，但它的内容正在不断增长。

您刚才描述的服务可以立即使用，因此也适合进行实验。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-09T21:28:16.353

要创建理解/文档，并不总是需要重量级的解决方案。（伟大的）重量级工具的例子有：IO/Docs / Apigee（虽然是伟大的工具）。

对于已经有 docchain 设置（doxygen/phpdoc/phpdoctor/custom/etc）的小型项目，我使用以下 shellscript 将页面包含在完整生成的文档中：

[https://gist.github.com/4496972](https://gist.github.com/4496972)

演示： http: [//pastie.org/5657190](http://pastie.org/5657190)

它只是在您的源代码中使用自定义注释标签。它也可以是记录任何源代码（语言）的一个很好的起点。

# delphi - Delphi 代码完成性能

> ID：898327
> 
> 赞同：28
> 
> 时间：2009-05-22T15:01:20.810
> 
> 标签：delphi, intellisense, code-completion

我有一些大型（约 60 万行代码）Delphi 项目。它们包括我们团队开发的一些自定义组件。

通常，当我使用 ctrl+space 或仅按“.”调用代码完成时，IDE 会锁定并且很难思考很长时间。有时延迟可能是一分钟或更长时间。其他时候，它会立即弹出建议。

哪些因素会影响 Delphi 中智能感知的性能？有什么办法可以提高这种性能吗？

到目前为止，我最好的解决方案是关闭自动完成，当我需要安静地冥想一分钟左右时使用 ctrl+space。

我不得不提到 VS2005、VS2008 和 XCode 似乎都可以提供几乎即时的智能反馈（尽管我从未在这么大的项目上尝试过）。

作为替代方案，[我提出了这个建议](http://delphi.uservoice.com/pages/4432-general/suggestions/196926)。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-22T15:12:43.813

当用户请求 Code Insight（Ctrl+Space、'.' 等）时，Delphi Code Insight 调用编译器 dll 进行自定义编译。此自定义编译在单元中进行构建并跳过代码生成、链接等，直到它到达文件缓冲区中的当前偏移量。考虑到这一点，编译器在到达您当前位置之前看到的单元列表将在确定 Code Insight 操作的速度方面发挥重要作用。可能有一个单元（或多个单元）导致严重的文件系统依赖性等。很可能重新排序使用子句，将使用子句重构为多个文件，或删除使用子句中的单元编译当前单元所必需的可能会提高性能。此外，

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T20:00:36.190

请务必在 dpr 中明确包含项目使用的所有单位 (*)。
不要依赖搜索路径来查找从另一个单元调用的单元，将其添加到 dpr。dpr 会更长，但所有与编译相关的东西都会更快，包括代码洞察力。

(*) 不是已安装组件的单位。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T20:15:59.997

我不知道您使用的是哪个版本，但代码完成速度更快是我最喜欢 Delphi 2009 的原因之一。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T15:08:09.330

这是 Delphi 长期存在的问题，我不得不求助于关闭自动完成。以这种方式工作了一段时间后，我对此感到非常满意。即使只需要几分之一秒，让 IDE 滞后我的打字也令人不安并打断了我的流程。关闭自动装置会更好，IMO。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-05T16:29:33.153

I just came across this problem myself, I fixed it by removing a dead network link from my environment library path. Solved my issue 100%.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T11:27:13.243

您是否将团队自定义组件的源目录包含在库路径中？如果只有组件 DCU 文件在库路径中，而不是在其中也有源文件，那么看看速度差异会很有趣。

# c# - 进行拆分并将结果转换为整数的最佳方法

> ID：898341
> 
> 赞同：1
> 
> 时间：2009-05-22T15:02:54.193
> 
> 标签：c#, string

我有一个数据库表，其中包含一个逗号分隔的 ID（整数）列表，这些列表存储为 nvarchar。

我有一个 get 方法可以一次性将这些作为列表返回。目前我想我必须做这样的事情：

```
List<int> ids = new List<int>();
string[] pageids = experssion.Split(separators)

foreach (string number in pageids)
{
    ids.Add(Convert.ToInt32(number));
} 
```

谁能想到一个更好的方法来做到这一点？我可以以某种方式在拆分时完成所有操作吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T15:04:52.050

我会这样：

```
var ids = expression.Split(separator).Select(s => int.Parse(s)); 
```

它使用 .NET 3.0 的 Linq 扩展。作为替代方案（保存一个 lambda），您也可以这样做，这可以说是可读性较差：

```
var ids = expression.Split(separator).Select((Func<string, int>)int.Parse); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T15:14:50.597

如果你没有使用 C# 3.0，或者不是 LINQ 的粉丝，你可以使用 C# 2.0 的方式：

```
// This gives you an int[]
int[] pageids = Array.ConvertAll(expression.Split(separator), new Converter<string,int>(StringToInt));

// Add each id to the list
ids.AddRange(pageids);

public static int StringToInt(string s)
{
 return int.Parse(s);
} 
```

编辑：

或者，根据 Konrad 的建议，甚至更简单：

```
int[] pageids = Array.ConvertAll<string,int>(expression.Split(separator),int.Parse);
ids.AddRange(pageids); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T15:05:56.167

使用 LINQ，您可以这样做：

```
List<int> ids 
  = expression
  .Split(separators)
  .Select(number => Convert.ToInt32(number))
  .ToList() 
```

# iphone - iPhone - 在 UITableViewController 上设置背景

> ID：898351
> 
> 赞同：50
> 
> 时间：2009-05-22T15:04:26.403
> 
> 标签：iphone, background, uitableview

有没有办法在 UITableViewController 上设置背景视图？

我尝试使用我在 a 上使用的代码`UIViewController`，但视图覆盖​​了表视图的所有内容。如果我在 中添加背景视图`cellForRowAtIndexPath-method`，它根本不会显示。有没有人这样做过或知道如何做到这一点？这是我正在使用的代码：

```
UIImage *image = [UIImage imageNamed: @"background.jpg"];
UIImageView *backImage = [[UIImageView alloc] initWithImage: image];
[self.view addSubview: backImage];
[self.view sendSubviewToBack: backImage]; 
```

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-02-29T16:46:33.333

我知道这已经很长时间了，但只是为了记录..我想我找到了一个更好的解决方案`UITableView.backgroundView`：

```
UIImageView *imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"lisbon.png"]];

self.tableView.backgroundView = imageView;
[imageView release]; 
```

我在 iPhone 上尝试了 320x480 的图像尺寸，效果很好（我也尝试过 .jpg）。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2010-03-17T02:38:22.827

（这与上面 Hans Espen 的解决方案基本相同，但为简洁起见使用了方便的方法）

把它放在你的 -`[UITableViewControllerSubclass viewDidLoad]`方法中：

```
self.tableView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"BackgroundPattern.png"]]; 
```

在 viewDidLoad 方法中避免几次自动释放是没有意义的，因为它很少被调用（当视图实际加载时），因此对性能的影响可以忽略不计。

注意：您应该始终在 iPhone 上使用 PNG 图像，而不是 JPEG 或任何其他格式。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-22T15:10:52.287

事实上，我得到了它的工作！:)

```
NSString *backgroundPath = [[NSBundle mainBundle] pathForResource:@"background" ofType:@"jpg"];
UIImage *backgroundImage = [UIImage imageWithContentsOfFile:backgroundPath];
UIColor *backgroundColor = [[UIColor alloc] initWithPatternImage:backgroundImage];
self.tableView.backgroundColor = backgroundColor; 
[backgroundColor release]; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-12-29T06:51:51.223

对于**Swift**使用这个，

```
self.tableView.backgroundView = UIImageView(image: UIImage(named: "backgroundImage.png")) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-29T09:02:46.243

```
self.parentViewController.view.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"yourImage.png"]]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-23T05:07:06.967

在**C#**中，对于带有部分的静态 UITableViewController，您可以使用：

```
using System;
using Foundation;
using UIKit;
using CoreGraphics;
using CoreAnimation;

namespace MyNamespace
{
    public class CustomTableViewController : UITableViewController
    {
        public override void ViewDidLoad()
        {
            base.ViewDidLoad();

            SetGradientBackgound();
        }

        private void SetGradientBackgound()
        {
            CGColor[] colors = new CGColor[] {
                UIColor.Purple.CGColor,
                UIColor.Red.CGColor,
            };

            CAGradientLayer gradientLayer = new CAGradientLayer();
            gradientLayer.Frame = this.View.Bounds;
            gradientLayer.Colors = colors;
            gradientLayer.StartPoint = new CGPoint(0.0, 0.0);
            gradientLayer.EndPoint = new CGPoint(1.0, 1.0);

            UIView bgView = new UIView()
            {
                Frame = this.View.Frame
            };
            bgView.Layer.InsertSublayer(gradientLayer, 0);

            UITableView view = (UITableView)this.View;
            view.BackgroundColor = UIColor.Clear;
            view.BackgroundView = bgView;
        }

        // Setting cells background transparent
        public override UITableViewCell GetCell(UITableView tableView, NSIndexPath indexPath)
        {
            var cell = base.GetCell(tableView, indexPath);
            cell.BackgroundColor = UIColor.Clear;
            return cell;
        }

        // Setting sections background transparent
        public override void WillDisplayHeaderView(UITableView tableView, UIView headerView, nint section)
        {
            if (headerView.GetType() == typeof(UITableViewHeaderFooterView))
            {
                UITableViewHeaderFooterView hView = (UITableViewHeaderFooterView)headerView;
                hView.ContentView.BackgroundColor = UIColor.Clear;
                hView.BackgroundView.BackgroundColor = UIColor.Clear;
            }
        }

    }
} 
```

结果可能是这样的：

[![设置 TableViewController 分级背景](https://i.stack.imgur.com/9Bbxv.png)](https://i.stack.imgur.com/9Bbxv.png)

# c# - 模拟跨上下文连接--LINQ/C#

> ID：898363
> 
> 赞同：24
> 
> 时间：2009-05-22T15:06:03.263
> 
> 标签：c#, entity-framework, linq, datacontext

这是问题：

我有 2 个要加入的数据上下文。现在我知道 LINQ 不允许从一个上下文连接到另一个上下文，并且我知道 2 种可能的解决方案是创建单个数据上下文或具有 2 个单独的查询（这是我现在正在做的）。但是我想做的是“模拟”一个连接。

这是我尝试过的。

```
using (var _baseDataContext = Instance)
{
    var query = from a in _baseDataContext.Account.ACCOUNTs
                where a.STR_ACCOUNT_NUMBER.ToString() == accountID
                join app in _baseDataContext.Account.APPLICATIONs on a.GUID_ACCOUNT_ID equals
                            app.GUID_ACCOUNT
                join l in GetLoans() on app.GUID_APPLICATION equals l.GUID_APPLICATION
                select l.GUID_LOAN;

    return query.Count() > 0 ? query.First() : Guid.Empty;
}

private static IQueryable<LOAN> GetLoans()
{
    using (var _baseDataContext = Instance)
    {
        return (from l in _baseDataContext.Loan.LOANs
                select l).AsQueryable();
    }
} 
```

在运行时我得到的是

System.InvalidOperationException：查询包含对在不同数据上下文中定义的项目的引用

编辑：

工作解决方案：

```
using (var _baseDataContext = Instance)
{
    var query = from a in _baseDataContext.Account.ACCOUNTs
                where a.STR_ACCOUNT_NUMBER.ToString() == accountID
                join app in _baseDataContext.Account.APPLICATIONs on a.GUID_ACCOUNT_ID equals
                           app.GUID_ACCOUNT
                join l in GetLoans() on app.GUID_APPLICATION equals l.GUID_APPLICATION 
                select l.GUID_LOAN;

     return (query.Count() > 0) ? query.First() : Guid.Empty;
}

private static IEnumerable<LOAN> GetLoans()
{
    using (var _baseDataContext = Instance)
    {
        return (from l in _baseDataContext.Loan.LOANs
                select l).AsQueryable();
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-22T15:40:05.703

也许这样的事情可以让你朝着正确的方向开始。我根据您的列名制作了一个包含类似列的模拟数据库，并得到了一些结果。

```
 class Program
{
    static AccountContextDataContext aContext = new AccountContextDataContext(@"Data Source=;Initial Catalog=;Integrated Security=True");
    static LoanContextDataContext lContext = new LoanContextDataContext(@"Data Source=;Initial Catalog=;Integrated Security=True");

    static void Main()
    {

        var query = from a in aContext.ACCOUNTs
                    join app in aContext.APPLICATIONs on a.GUID_ACCOUNT_ID equals app.GUID_ACCOUNT
                    where app.GUID_APPLICATION.ToString() == "24551D72-D4C2-428B-84BA-5837A25D8CF6"
                    select GetLoans(app.GUID_APPLICATION);

        IEnumerable<LOAN> loan = query.First();
        foreach (LOAN enumerable in loan)
        {
            Console.WriteLine(enumerable.GUID_LOAN);
        }

        Console.ReadLine();
    }

    private static IEnumerable<LOAN> GetLoans(Guid applicationGuid)
    {
        return (from l in lContext.LOANs where l.GUID_APPLICATION == applicationGuid select l).AsQueryable();
    }
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T16:23:47.260

这是我们发现的“解决方法”......

我们从另一个数据库手动构建我们的表，如果它在同一台服务器上，那么我们在表名前加上：

```
<DatabaseName>.<SchemaName>.<YourTableName> 
```

如果它们在链接服务器上，那么您还必须在其前面加上服务器名称：

```
<ServerName>.<DatabaseName>.<SchemaName>.<YourTableName> 
```

这将允许您进行连接并仍然返回一个未执行的 IQueryable... 这是我们想要的。其他两种方式涉及加入内存中的 IEnumerables，这意味着您在进行联接（上图）之前为每个记录提取所有记录，并使用具有限制的 contains 方法进行 IQueryable 联接...

希望将来 DataContext 将构建得足够智能，以知道如果服务器已链接，那么您可以在两个不同的服务器之间进行连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T15:27:24.267

我赞成创建一个单独的数据上下文，其中只包含您要连接的两个表。但我想你可以在第二个上下文中维护一个临时表（包含第一个上下文中的数据），然后加入临时表。

# xml - 当 xsd 可用时使用 Linq 访问 xml

> ID：898364
> 
> 赞同：0
> 
> 时间：2009-05-22T15:06:10.113
> 
> 标签：xml, linq, xsd

我有一个包含大量数据的 xml 文件。该文件的结构源自我拥有 xsd 文件的几种格式。它们都合并到完成视图的模式中。

当我需要获取所有数据并使用它时，使用 linq 访问 xml 文件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T20:34:38.947

您正在寻找 XDocument，它是一种新的 xml 模型，用于为 LINQ 提供支持。您可以在此处找到更多信息：http: [//msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T20:39:47.360

Microsoft 一直在试验 LINQ to XSD 提供程序。这可能值得一试。

# grails - 从插件加载应用程序类

> ID：898368
> 
> 赞同：0
> 
> 时间：2009-05-22T15:06:53.513
> 
> 标签：grails, groovy, grails-plugin

在 Grails 1.1 插件中，我尝试使用以下代码从主应用程序加载一个类：

```
class MyClass {
  static Map getCustomConfig(String configName){
    return new ConfigSlurper().
      parse(ApplicationHolder.application.classLoader.loadClass(configName))                    
  }
} 
```

包含配置信息`configName`的类的名称在哪里。`$MAIN_APP/grails-app/conf`但是，当上面的代码在单元测试中运行时`applicationHolder.application`返回 null，导致上面的方法抛出一个`NullPointerException`. 为这个问题创建了一个 Grails [JIRA](http://jira.codehaus.org/browse/GRAILS-1576)问题，但它已被标记为已修复，尽管问题似乎仍然存在。

我知道在插件描述符类中，我可以`GrailsApplication`通过隐式`application`变量访问主应用程序（的实例）。但是上面显示的代码不在插件描述符中。

有没有办法可以从插件内的主应用程序加载一个类（但在插件描述符之外）？

谢谢，唐

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T17:31:16.933

事实证明，有 2 个可能的答案。

**正确答案**

GrailsApplication 在单元测试中不可用，所以为了让上面的代码工作，它应该是一个集成测试

**有效的黑客**

改变

```
parse(ApplicationHolder.application.classLoader.loadClass(configName)) 
```

到

```
parse(MyClass.classLoader.loadClass(configName)) 
```

# tfs - TeamBuild 和 Web 部署项目

> ID：898378
> 
> 赞同：2
> 
> 时间：2009-05-22T15:09:31.370
> 
> 标签：tfs, tfsbuild

随着新的 TFS 2008 和即将推出的 TFS 2010，Web 部署项目是否贬值？我们在 2005 年的项目中使用了它们，因为我们需要跨集群的多个文件分布，但现在 TeamBuild 做到了，而且我们刚刚从 VSS 迁移到 TFS 2008，我想知道是否有一个论点要提出删除 WDP 并使用严格的 TeamBuild 解决方案。

我们目前使用 CruiseControl.NET 构建，但正在考虑转向一种解决方案，而不是仅使用 CC.NET 插件从 TFS 源代码控制构建。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T15:22:52.030

通常来说，在团队环境中，无论如何您都希望使用适合 xcopy 样式部署的 Web 应用程序项目。我们有几十个正在使用这种方法积极开发的应用程序。

使用 Team Build 时，我强烈建议您获取[TFS Deployer](http://www.codeplex.com/tfsdeployer)的副本， 它使您能够利用与构建质量设置挂钩的 powershell 脚本。

我们的设置是带有 TFS Deployer 的 CI（利用 TFS 2008）。成功签入会导致构建和部署到我们的开发服务器。当我们将构建质量更改为“In Staging”时，TFS Deployer 会将项目移动到我们的暂存服务器。当我们的基础架构团队在部署到我们的网络农场时将其更改为“生产中”。

简单，重点

# sql-server - 如何为用户禁用 SQL Server Management Studio

> ID：898380
> 
> 赞同：8
> 
> 时间：2009-05-22T15:09:52.023
> 
> 标签：sql-server, sql-server-2008

有没有办法阻止用户进入 SQL Server Management Studio，这样他们就不能手动编辑表行？他们仍然需要通过运行我的应用程序来访问这些表。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-22T15:29:44.013

您可以对特定用户使用**[DENY VIEW ANY DATABASE](http://msdn.microsoft.com/en-us/library/ms189077.aspx)**命令。这是 SQL Server 2008 中提供的一项新功能。

它阻止用户查看系统目录（sys.databases、sys.sysdatabases 等），因此使数据库在 SQL Management Studio (SSMS) 中对他们不可见。

从主数据库运行此命令：

```
DENY VIEW ANY DATABASE TO 'loginName' 
```

用户仍然可以通过您的应用程序访问数据库。但是，如果他们通过 SSMS 登录，您的数据库将不会显示在数据库列表中，并且如果他们打开查询窗口，您的数据库将不会出现在下拉列表中。

然而，这并不是万无一失的。如果用户足够聪明，可以运行查询命令：

```
USE <YourDatabaseName> 
```

然后他们将在查询分析器中看到数据库。

由于此解决方案将您 90% 带到那里，我会给数据库一些晦涩的名称，而不是让用户知道数据库的名称。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T15:16:12.107

您***不必***担心他们可以访问该工具。只需确保他们不知道具有读/写权限的特定数据库的任何 SQL 登录名，如果知道，请更改密码。如果他们可以通过 Windows 身份验证访问数据库，请确保他们处于***datareader 角色***。您可以使用角色来管理用户可以在 SQL 中执行的操作。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-04-26T22:53:15.190

您可以使用触发器。

```
CREATE TRIGGER [TR_LOGON_APP]
ON ALL SERVER 
FOR LOGON
AS
BEGIN

   DECLARE @program_name nvarchar(128)
   DECLARE @host_name nvarchar(128)

   SELECT @program_name = program_name, 
      @host_name = host_name
   FROM sys.dm_exec_sessions AS c
   WHERE c.session_id = @@spid

   IF ORIGINAL_LOGIN() IN('YOUR_APP_LOGIN_NAME') 
      AND @program_name LIKE '%Management%Studio%' 
   BEGIN
      RAISERROR('This login is for application use only.',16,1)
      ROLLBACK;
   END
END; 
```

[https://www.sqlservercentral.com/Forums/1236514/How-to-prevent-user-login-to-SQL-Management-Studio-#bm1236562](https://www.sqlservercentral.com/Forums/1236514/How-to-prevent-user-login-to-SQL-Management-Studio-#bm1236562)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-22T15:13:08.353

我建议您锁定数据库并为用户提供适当的只读（或其他）权限。这样用户仍然可以使用管理工作室来运行选择查询等。

如果您根本不希望用户拥有任何权利，那么您也可以这样做。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T15:53:23.657

如果您的应用程序作为服务/用户帐户运行，则只有该帐户需要访问数据库。个人用户的帐户不需要对数据库的任何访问权限，因此他们甚至没有读取权限。您的应用程序将成为数据的网关。

如果用户在他们的用户帐户下运行应用程序，则授予他们只读权限。您可以简单地将它们添加到 db_datareader 角色。

希望这可以帮助！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-03-21T10:31:56.507

您可以拒绝“用户”对 ssms.exe 可执行文件的访问权限，同时授予相关用户/管理员权限。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-22T15:13:16.683

如果您的应用程序仅使用存储过程来修改数据，您可以授予最终用户运行存储过程的访问权限，但拒绝他们访问修改表。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-22T15:13:41.457

*   不要让他们知道数据库登录是什么。
*   如果您无法限制登录，请专门使用存储过程进行更新，并禁用该用户的任何 CREATE、DELETE、INSERT 或 UPDATE 权限。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-22T15:15:28.707

应用[程序角色](http://msdn.microsoft.com/en-us/library/ms190998.aspx)将允许您将数据库对象保护到您的应用程序而不是登录用户。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-22T15:16:44.833

我同意[Jon Erickson](https://stackoverflow.com/questions/898380/how-to-disable-sql-server-management-studio-for-a-user/898397#898397)作为一般规则

*   不允许任何用户访问表，但只允许通过存储过程进行访问
*   不允许一般用户帐户访问存储的过程，但只允许您的应用程序运行的帐户（无论是集成登录还是 SQL 登录）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-22T15:24:32.540

充分利用数据库角色，如果用户应该只有 SELECT（读取）访问权限，请为他们分配 db_datareader 角色。即使他们使用 SSMS 登录，他们也只能执行 SELECT 语句。

# flash - 允许 Silverlight（和 Flash）应用程序保持全屏状态

> ID：898384
> 
> 赞同：6
> 
> 时间：2009-05-22T15:11:03.753
> 
> 标签：flash, silverlight, fullscreen, multiple-monitors

我正在编写一个可以全屏显示的 Silverlight 应用程序（想想 YouTube 全屏显示）。这很简单。但是，我想为用户提供保持应用全屏的能力，即使他们点击离开。

许多用户有多个显示器，因此将应用程序缩小到浏览器中并不总是有意义的。目前，如果他们让我的应用全屏显示，他们会看到“按 ESC 退出全屏”消息，然后在其他显示器上对应用的任何点击都会导致全屏 Silverlight 应用缩小。

我相信 Silverlight（以及 Flash）的这种行为是一种安全功能，可以防止人们编写保持全屏状态的应用程序。但是，我想知道是否有一种“选择加入”的方式让用户说“我不介意这个应用程序保持全屏显示”。

我也很想知道这是否可以用 Flash 完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-11-18T07:15:38.130

Silverlight 4 添加了全屏固定模式：

[http://www.silverlight.net/learn/videos/all/fullscreen-window-pinning/](http://www.silverlight.net/learn/videos/all/fullscreen-window-pinning/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T15:51:59.663

我不相信这在 Silverlight 中是可能的 - 正如您正确地说，由于安全问题，全屏时控制受限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-18T07:19:42.610

在 silverlight 4 中可以使用 Content.FullScreenOptions 属性 [http://msdn.microsoft.com/en-us/library/system.windows.interop.content.fullscreenoptions(v=VS.95).aspx](http://msdn.microsoft.com/en-us/library/system.windows.interop.content.fullscreenoptions(v=VS.95).aspx) 演示： [http： //www.michaelsnow.com/2010/06/21/silverlight-tip-of-the-day-31-pinning-full-screen-mode/](http://www.michaelsnow.com/2010/06/21/silverlight-tip-of-the-day-31-pinning-full-screen-mode/)

# database - 如何访问旧 DOS RapidFile 数据文件中的数据

> ID：898386
> 
> 赞同：0
> 
> 时间：2009-05-22T15:11:07.093
> 
> 标签：database, export, legacy-database

我需要访问一些以旧 DOS 格式存储的数据。特别是使用 Ashton-Tate 的 RapidFile 格式。

有谁知道是否有 ADO 驱动程序或任何其他更“现代”的数据访问技术可以让我读取数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:21:59.177

我没有找到 RapidFile 的任何 ODBC 驱动程序，但我确实找到了该公司的链接，它*可能*能够帮助您。 [http://www.rapidfile.co.uk/](http://www.rapidfile.co.uk/)

# c++ - 通过类成员函数访问静态 const 变量的问题

> ID：898387
> 
> 赞同：1
> 
> 时间：2009-05-22T15:11:11.257
> 
> 标签：c++

我在访问我的类私有成员变量部分中定义的静态 const 变量时遇到问题。具体来说，下面编写的代码可以在构造函数中输出变量，但是当我尝试通过访问器函数访问它时，会出现下面讨论的错误。如果有人知道为什么我会感谢你的帮助。

```
#include <iostream>
using namespace std;

class TestStaticVariables
{
 // Private member variable:
 static const double static_double_variable;
public:
 // Constructor:
 TestStaticVariables()
 {
  // Initialization:
  static const double static_double_variable = 20.0;
  cout << static_double_variable;
 }
 // Member Function:
 void test();
};

void TestStaticVariables::test()
{ 
```

取消注释下一行时，我收到以下错误消息：

行定位工具：0：“TestStaticVariables::static_double_variable”，引用自：

```
 //cout << static_double_variable;
}

int main(int argc, char* const argv[])
{

 TestStaticVariables test_instance;

 return 0;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T15:18:25.767

尝试在类定义之外初始化变量，这是一个工作示例：

```
#include <iostream>

class Foo {
    static const double _bar;

public:
    Foo();

    void Bar();
};

const double Foo::_bar = 20.0;

Foo::Foo() {
    std::cout << Foo::_bar << std::endl;
}

void Foo::Bar() {
    std::cout << Foo::_bar << std::endl;
}

int main( int argc, char *argv[] ) {
    Foo f;
    f.Bar();

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T15:21:15.107

您标记为“// Initialization”的内容实际上是在不同的范围内创建和初始化具有相同名称的第二个变量。构造函数内部创建的static_double_variable变量是构造函数中的局部变量，并不指代同名的类级静态变量。

为了避免这种情况，您需要做的是简单地删除类型信息，使其成为正常语句而不是初始化，如下所示：

```
 // Initialization:
   static_double_variable = 20.0; 
```

但是当然这实际上不起作用，因为它是对 const 变量的赋值，而且你还有第二个问题，我认为这实际上是导致你看到的错误的原因。当你写：

```
 // Private member variable:
 static const double static_double_variable; 
```

您声明将存在这样的变量。但是，您实际上并没有定义该变量（即指示编译器为其创建存储）。

为了做到这一点，并在你的`class { }`构造之外解决你的两个问题，你会写：

```
 const double  TestStaticVariables::static_double_variable = 20.0; 
```

这既定义了变量，又赋予了它一个初始的常量值。

如果不清楚，C++ FAQ 中也简要描述了这个问题：http: [//www.parashift.com/c++-faq-lite/ctors.html#faq-10.10](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.10)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T15:23:18.970

您在构造函数中所做的是**隐藏**成员变量。
您必须初始化`static_double_variable`类声明的外部。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T15:25:32.413

您的构造函数声明并定义了一个局部静态变量，它恰好与类静态成员变量同名。局部变量隐藏了类成员。

这就是您可以在构造函数中看到的内容。然后，当您尝试在另一个方法中链接该类成员时，链接器发现它已声明但未定义，因此它放弃了。

无论如何，您可能不应该在构造函数中初始化静态类成员，因为该类只有一个变量，但构造函数会为每个实例调用一次。您应该在任何函数之外定义变量（或仅在声明中，除非您想对 API 的用户隐藏该值）。

# python - 将列表列表转换为分隔字符串

> ID：898391
> 
> 赞同：7
> 
> 时间：2009-05-22T15:11:44.783
> 
> 标签：python, string, list

如何仅使用内置模块执行以下操作？

我有一个这样的列表列表：

```
[['dog', 1], ['cat', 2, 'a'], ['rat', 3, 4], ['bat', 5]] 
```

从它，我想生成一个这样的表的字符串表示形式，其中列由制表符分隔，行由换行符分隔。

```
dog 1
cat 2   a
rat 3   4
bat 5 
```

IE

```
'dog\t1\ncat\t2\ta\nrat\t3\t4\nbat\t5' 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-22T15:13:44.903

像这样，也许：

```
lists = [['dog', 1], ['cat', 2, 'a'], ['rat', 3, 4], ['bat', 5]]
result = "\n".join("\t".join(map(str,l)) for l in lists) 
```

这使用制表符连接所有内部列表，并使用换行符连接字符串的结果列表。

它使用称为[列表理解](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)的功能来处理外部列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T15:15:39.860

```
# rows contains the list of lists
lines = []
for row in rows:
    lines.append('\t'.join(map(str, row)))
result = '\n'.join(lines) 
```

# c# - 我可以避免在 LINQ to XML 中使用完全限定的元素名称吗？

> ID：898394
> 
> 赞同：1
> 
> 时间：2009-05-22T15:12:28.120
> 
> 标签：c#, linq-to-xml, xml-namespaces

假设我使用以下 XML 字符串调用 XElement.Parse()：

```
var xml = XElement.Parse(@"
  <?xml version="1.0" encoding="UTF-8"?>
  <AccessControlPolicy xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
    <Owner>
      <ID>7c75442509c41100b6a413b88b523bd6f46554cdbee5b6cbe27bc08cb3f6a865</ID>
      <DisplayName>me</DisplayName>
    </Owner>
    <AccessControlList>
      <Grant>
        <Grantee xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="Group">
      ...
  "); 
```

在查询元素时，我不得不使用完全限定的元素名称，因为该 XML 文档`xmlns`在其根中包含一个属性。这需要繁琐的 XName 实例创建：

```
var AWS_XMLNS = "http://s3.amazonaws.com/doc/2006-03-01/";
var ownerElement = xml.Element(XName.Get("AccessControlPolicy", AWS_XMLNS)).Element(XName.Get("Owner", AWS_XMLNS)); 
```

当我真正想要的只是简单的时候，

```
var ownerElement = xml.Element("AccessControlPolicy").Element("Owner"); 
```

有没有办法让 LINQ to XML*假定*一个特定的命名空间，所以我不必继续指定它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T15:17:21.027

您可以通过使用来简化

```
XNamespace ns = "http://s3.amazonaws.com/doc/2006-03-01/";
var ownerElement = xml.Element(ns + "AccessControlPolicy").Element(ns + "Owner"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T02:05:00.260

我不认为你可以（见 Jon Skeet 的[评论](https://stackoverflow.com/questions/793580/my-linq-query-doesnt-work-when-adding-the-xmlns-attribute-to-the-root-element-in/793601#793601)），但你可以做一些技巧。

1) 创建一个扩展方法，将 XNamespace 附加到您的字符串

2）使用[VB](http://www.danielmoth.com/Blog/2008/05/linq-to-xml-namespaces-and-vb.html)？！？

# html - 菜单中的 umbraco 宏

> ID：898396
> 
> 赞同：0
> 
> 时间：2009-05-22T15:13:07.667
> 
> 标签：html, xslt, umbraco

我为左侧的菜单创建了一个宏，没关系。

我想对右侧的菜单使用相同的宏而不创建另一个。

我应该怎么办？

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE xsl:Stylesheet [ <!ENTITY nbsp "&#x00A0;"> ]>
<xsl:stylesheet 
    version="1.0" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    xmlns:msxml="urn:schemas-microsoft-com:xslt"
    xmlns:umbraco.library="urn:umbraco.library"
    exclude-result-prefixes="msxml umbraco.library">

<xsl:output method="xml" omit-xml-declaration="yes" />

<xsl:param name="currentPage"/>

<xsl:template match="/">

  <xsl:call-template name="drawNodes">  
  </xsl:call-template>

</xsl:template>

<xsl:template name="drawNodes">    
  <ul>    
    <xsl:for-each select="$currentPage/ancestor-or-self::root/node [string(data[@alias='posizione_menu']) = 'left']">

      <xsl:choose>
        <xsl:when test="$currentPage/ancestor-or-self::node/@id = current()/@id">
          <li><xsl:value-of select="@nodeName"/></li>
        </xsl:when>
        <xsl:otherwise>
          <li>
            <a href="{umbraco.library:NiceUrl(@id)}" title="Accedi a {@nodeName}">
              <xsl:text disable-output-escaping="yes"><![CDATA[&laquo;]]> </xsl:text>
              <xsl:value-of select="@nodeName"/>
            </a>
          </li>
        </xsl:otherwise>
      </xsl:choose>
    </xsl:for-each>

  </ul>

</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T10:03:46.057

如果您想重用一个宏，您可以通过将其插入您想要重用它的 .NET 母版页来轻松实现。

如果您想要不同的 XHTML 标记，具体取决于它是在左侧还是右侧，请告诉我，以便我进一步帮助您。

沃伦:)

# .net - 使用命令行发布 WCF 服务（或 ASP.NET Web 应用程序）

> ID：898399
> 
> 赞同：12
> 
> 时间：2009-05-22T15:13:16.637
> 
> 标签：.net, msbuild

我想在 Visual Studio 2008 中模拟 WCF 服务项目（或 ASP.NET Web 应用程序或...）上下文菜单中的“发布...”菜单项。我不需要将其发布到正在运行的 IIS 实例，只是将 web 内容与 bin 文件夹放在某个本地目录上。有什么方法可以将它添加到构建后事件中，或者作为 MSBuild 任务添加？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-25T07:25:22.023

这是答案，感谢这个链接：[http](http://codingcockerel.co.uk/2008/05/18/how-to-publish-a-web-site-with-msbuild/) ://codingcockerel.co.uk/2008/05/18/how-to-publish-a-web-site-with-msbuild/ 所以，我刚刚修改了 . Web 应用程序的 csproj 文件，并将其写入 AfterBuild 目标（已经存在）：

```
<Target Name="BeforeBuild">
    <Message Text="##############Before build##################" Importance="high"/>
    <RemoveDir Directories="publish"
        ContinueOnError="true"/>
</Target>
<Target Name="AfterBuild">
    <Message Text="##############After build##################$(OutputFolder)" Importance="high"/>
    <MSBuild Projects="$(ProjectName).csproj"
           Targets="ResolveReferences;_CopyWebApplication"
           Properties="WebProjectOutputDir=publish\;OutDir=publish\bin\" />
</Target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T16:10:41.677

您应该能够编写一个 xcopy 命令来将您需要的文件复制到正确的位置。Microsoft 有一篇关于[asp.net 的 xcopy 部署](http://support.microsoft.com/kb/326355)的文章。

一旦您拥有正确的命令，您就可以将其放入 Post Build 操作中，以便在构建后自动触发。

有关仅复制 dll 输出的示例，另请参阅[VS Post Build Event](https://stackoverflow.com/questions/371302/vs-post-build-event)（注意使用 $(TargetPath) 和 $(TargetDir)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T22:16:11.737

嗨，您应该看看[Web 部署项目](http://www.microsoft.com/downloads/details.aspx?familyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)。这些实际上是具有 Visual Studio GUI 支持的 MSBuild 文件。他们将预编译您的网站。您可以扩展这些行为以将生成的文件复制到您的 Web 服务器。

赛义德·易卜拉欣·哈希米

我的书：[Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)

# emacs - 如何在emacs中的缓冲区上获得焦点跟随鼠标？

> ID：898401
> 
> 赞同：13
> 
> 时间：2009-05-22T15:13:32.033
> 
> 标签：emacs, focus, window, dot-emacs

假设我打开了一个源文件并启动了一个 shell。我可以点击 Cx o 在两个缓冲区之间切换。但是我怎样才能得到它，以便当我移动鼠标时鼠标下的缓冲区获得焦点，就像窗口管理器中常见的“焦点跟随鼠标”选项一样？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-22T15:16:43.837

放：

```
(setq mouse-autoselect-window t) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T19:40:05.750

回答 shift+arrow 注释，在您的 .emacs 中执行：

```
(windmove-default-keybindings) 
```

# usability - 可用性：语音识别与键盘

> ID：898402
> 
> 赞同：1
> 
> 时间：2009-05-22T15:13:32.703
> 
> 标签：usability, speech-recognition, voice, ivr

我们看到越来越多的语音识别被实现，并且需要能够进行良好语音识别的库。与键盘或小键盘相比，它背后的基本原理（在可用性方面）是什么？你有什么理由投资这个开发项目？

例如，让我们以呼叫中心为例。几年前，几乎每个呼叫中​​心都使用提示输入菜单键的 IVR。现在，我们看到越来越多的菜单提示输入关键字和/或按下键盘：“请说出发票或按 1 查看您的发票”。或者我们在公司的电话簿中看到同样的内容：“请说出您要联系的人的姓名”……“弗兰克·洛伊德”……“你说的是杰克·弗洛伊德吗？如果你愿意，请说是联系此人或拒绝重试”。

我想当你在车里而不拿着手机时这是一个加分，但值得额外的等待时间吗？所有选项的交互时间更长，尝试分析是否有人说了什么时的提示时间更长等等？此外，可靠性肯定比以前更好，但有时感觉更像是某人决定插入系统的玩具，因此它可以让人感觉未来感。

有设计 IVR 或使用（或选择不使用）语音识别的软件的经验吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:17:20.107

我认为语音识别和任何输入方法一样都有优点和缺点。

专业人士

*   没有学习曲线，我们从很小的时候就开始说话了。
*   非常用户直观。
*   在电话中，无需经常将耳机从耳边移开。

骗局

*   更长的等待时间
*   如果音质不好，需要多次尝试才能正确选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T01:36:42.660

语音识别与触摸屏技术相结合无疑是未来的潮流。例如，我使用 tazti 语音识别。它在 XP 和 Vista 版本中可用。由于微软的触摸屏“Surface”平台在 Vista 上运行，我确信 tazti 将与触摸屏技术一起工作。当我尝试 tazti 语音识别时，内置命令效果很好。它也让我创建自己的语音命令，这些命令也很好用。语音搜索 Google 和 Yahoo、Wikipedia Youtube 和许多其他搜索引擎效果很好。还有许多其他功能。但它没有听写。我发现我消除了 70% 或更多的互联网点击次数......也许更多。注意：Tazti 可以从他们的网站免费下载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T02:46:01.190

在某些情况下，公司需要处理转盘电话。可能会发现仅设置识别系统而不是同时设置两者更具成本效益。

语音识别的开销比按键音多得多。如果您想要最好的结果，您需要不断调整应用程序并训练系统处理无法识别的单词发音。您还需要非常注意如何通过语音识别提示用户，否则您可能会得到意想不到的响应。

整体按键音要容易得多，因为在任何给定时间只有一组有限的可能选项。

如果您的应用程序足够直截了当，那么您的语音记录只会使其复杂化。按 2 获取其他语言..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-17T13:09:55.033

> 与键盘或小键盘相比，它背后的基本原理（在可用性方面）是什么？

可用性是一个非常广泛的术语。如果我试图用触摸板输入我的地址，它就不会被认为很有用。有人认为，使用整体成功率为 70-80% 的语音引擎也不是很有用。正如其他帖子中所指出的，对于那些使用手机的人来说，免提输入会容易得多。但是，如果主题对呼叫者来说有些陌生，那么使用文字输入与数字输入实际上可能不如按键式电话那么直观。呼叫者听到不太熟悉的术语和短语在提示的 10-30 秒内无法记住它们，但他们可以用手指将鼠标悬停在听起来最好的选择上或记住选择的顺序。

> 你有什么理由投资这个开发项目？

这是一个奇怪的问题。通常，在 IVR 环境中是否使用语音的决定并非来自世界的发展观。除非您有真正需要语音的特定要求，否则您几乎总是会降低总体成功率。演讲通常是企业形象的一个因素……或者拥有最新的技术玩具。

> 我想当你在车里而不拿着手机时这是一个加分，但值得额外的等待时间吗？

如今，使用现代 ASR 时，语音识别延迟并不是很高。在大多数情况下，输入与语音并行处理，语音识别结束之间的时间为 0.5 到 1 秒。请注意，许多 IVR 需要在某些输入后执行数据查找，这可能会显示为较慢的系统。超过 1 秒的正常输入通常是部署功率不足的迹象。

它在最初实施时可能并没有动力不足，但是通过调整工作，您可以做出很多性能与准确性的决定。为了获得下一个 0.1%，可以将资源推到超出峰值时的水平。

> 此外，可靠性肯定比以前更好，但有时感觉更像是某人决定插入系统的玩具，因此它可以让人感觉未来感。

一般来说，是的。在可靠性方面，您需要真正查看总体数字以了解系统。这是一场统计数据之战，个人不是很重要（除非他们拥有 VP 或以上的头衔）。通过优化输入（移动提示）、资源使用和其他语音识别调整参数，您可以尝试最大限度地提高准确性。对于基本的自然语言响应，您可以达到 90 多岁。但是，您的总体成功率要低得多。想象一下 5 个提示全部为 98%（实际上，您往往有一堆 99，然后是几个 90 年代中期或略低于）：.98 * .98 * .98 * .98 * .98 = 90%。这意味着十分之一的失败。那是在呼叫者混淆和业务规则之前。DTMF 输入通常非常接近 100%，即使在多次输入后也是如此。

> 有设计 IVR 或使用（或选择不使用）语音识别的软件的经验吗？是的。但是，我怀疑这真的不是你想要的问题。作为技术方面的人，这通常不是你的决定，你对它的影响有限。如果您真的在寻找演讲的利弊：

**优点：**

*   酷/时髦（注意，仅语音是不够的。您需要出色的 VUI 和语音才能）
*   适合避开耳塞的高度流动的人群。未来应该是将语音与触觉输入相结合。也许。它可能不会来自市场的 IVR 方面。
*   适用于 DTMF 无法完成的任务。请注意，其中许多问题在语音方面的成功率也很低。成本（相对于人力）通常是驱动因素而不是可用性。将呼叫放入语音信箱以更改地址可能非常划算。

**缺点：**

*   开发、部署和维护成本高昂。如果您不小心，添加新选择可能会对成功率产生重大影响。始终监控变化的影响。
*   经常部署不当。例如，只需说出您的数字菜单选择。这几乎常常是我们想要言语冷静，但却买不起真正需要什么才能实现言语冷静的情况。
*   成功率会更低，因此呼叫中心的成本会更高。
*   失败往往集中在特定的提示和个别呼叫者上。经常遇到系统问题的呼叫者会对您非常不满。
*   当他们不被理解时，呼叫者会生气。您的目标是确定您的客户群的一个子集并真正激怒他们吗？

# java - java - 如何在java中实现类似“LIKE”运算符的SQL？

> ID：898405
> 
> 赞同：43
> 
> 时间：2009-05-22T15:14:29.083
> 
> 标签：java, sql, regex, string, wildcard

我需要一个 java 中的比较器，它与 sql 'like' 运算符具有相同的语义。例如：

```
myComparator.like("digital","%ital%");
myComparator.like("digital","%gi?a%");
myComparator.like("digital","digi%"); 
```

应该评估为真，并且

```
myComparator.like("digital","%cam%");
myComparator.like("digital","tal%"); 
```

应该评估为假。有什么想法如何实现这样的比较器，或者有人知道具有相同语义的实现吗？这可以使用正则表达式来完成吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-22T15:16:15.007

.* 将匹配正则表达式中的任何字符

我认为java语法是

```
"digital".matches(".*ital.*"); 
```

对于单个字符匹配，只需使用一个点。

```
"digital".matches(".*gi.a.*"); 
```

并匹配一个实际的点，将其转义为斜线点

```
\. 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-22T15:26:02.740

是的，这可以通过正则表达式来完成。请记住，Java 的正则表达式与 SQL 的“like”有不同的语法。不是“ `%`”，而是“ `.*`”，而不是“ `?`”，而是“ `.`”。

有点棘手的是，您还必须转义 Java 视为特殊的任何字符。由于您试图使其类似于 SQL，我猜它`^$[]{}\`不应该出现在正则表达式字符串中。但是在进行任何其他替换之前，您必须将“ `.`”替换为“”。`\\.`（**编辑：** 通过用“ ”和“ ”[`Pattern.quote(String)`](http://java.sun.com/javase/6/docs/api/java/util/regex/Pattern.html#quote(java.lang.String))包围字符串来转义所有内容，这将导致表达式中的所有内容都被视为文字（根本没有通配符）。所以你*绝对*不想使用它。）`\Q``\E`

 *此外，正如 Dave Webb 所说，您还需要忽略大小写。

考虑到这一点，以下是它的示例：

```
public static boolean like(String str, String expr) {
    expr = expr.toLowerCase(); // ignoring locale for now
    expr = expr.replace(".", "\\."); // "\\" is escaped to "\" (thanks, Alan M)
    // ... escape any other potentially problematic characters here
    expr = expr.replace("?", ".");
    expr = expr.replace("%", ".*");
    str = str.toLowerCase();
    return str.matches(expr);
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-07-19T13:30:41.510

正则表达式是最通用的。但是，一些 LIKE 函数可以在没有正则表达式的情况下形成。例如

```
String text = "digital";
text.startsWith("dig"); // like "dig%"
text.endsWith("tal"); // like "%tal"
text.contains("gita"); // like "%gita%" 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-07-20T11:32:23.580

我能找到的每个 SQL 参考都说“任何单个字符”通配符是下划线 ( `_`)，而不是问号 ( `?`)。这稍微简化了一些事情，因为下划线不是正则表达式元字符。`Pattern.quote()`但是，由于mmyers给出的原因，您仍然无法使用。当我以后可能想编辑正则表达式时，我有另一种方法来转义正则表达式。有了这些，`like()`方法变得非常简单：

```
public static boolean like(final String str, final String expr)
{
  String regex = quotemeta(expr);
  regex = regex.replace("_", ".").replace("%", ".*?");
  Pattern p = Pattern.compile(regex,
      Pattern.CASE_INSENSITIVE | Pattern.DOTALL);
  return p.matcher(str).matches();
}

public static String quotemeta(String s)
{
  if (s == null)
  {
    throw new IllegalArgumentException("String cannot be null");
  }

  int len = s.length();
  if (len == 0)
  {
    return "";
  }

  StringBuilder sb = new StringBuilder(len * 2);
  for (int i = 0; i < len; i++)
  {
    char c = s.charAt(i);
    if ("[](){}.*+?$^|#\\".indexOf(c) != -1)
    {
      sb.append("\\");
    }
    sb.append(c);
  }
  return sb.toString();
} 
```

如果您真的想使用`?`通配符，最好的办法是将其从`quotemeta()`方法中的元字符列表中删除。替换其转义形式 -- `replace("\\?", ".")`-- 并不安全，因为原始表达式中可能存在反斜杠。

这给我们带来了真正的问题：大多数 SQL 风格似乎都支持`[a-z]`和`[^j-m]`or形式的字符类`[!j-m]`，它们都提供了一种转义通配符的方法。后者通常通过`ESCAPE`关键字来完成，它允许您每次定义不同的转义字符。可以想象，这使事情变得相当复杂。转换为正则表达式可能仍然是最好的选择，但解析原始表达式会困难得多——事实上，您要做的第一件事就是将`LIKE`-like 表达式本身的语法形式化。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-06-24T04:49:32.693

要在 java 中实现 sql 的 LIKE 函数，您不需要正则表达式它们可以如下获得：

```
String text = "apple";
text.startsWith("app"); // like "app%"
text.endsWith("le"); // like "%le"
text.contains("ppl"); // like "%ppl%" 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-22T15:18:00.993

Java 字符串具有 .startsWith() 和 .contains() 方法，它们可以帮助您完成大部分工作。对于更复杂的事情，您必须使用正则表达式或编写自己的方法。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-22T15:20:08.930

你可以`'%string%'`转向[`contains()`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#contains(java.lang.CharSequence))，`'string%'`转向[`startsWith()`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#startsWith(java.lang.String))和`'%string"'`转向[`endsWith()`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#endsWith(java.lang.String))。

您还应该在不区分大小写的情况下[`toLowerCase()`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#toLowerCase(java.lang.String))同时在字符串和模式上运行`LIKE`。

不知道你会如何处理`'%string%other%'`，除非使用正则表达式。

如果您使用正则表达式：

*   [`%`在替换字符之前引用字符串](https://stackoverflow.com/questions/60160/how-to-escape-text-for-regular-expression-in-java)
*   [`LIKE`注意字符串中的转义字符](http://www.techonthenet.com/sql/like.php)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-01-12T14:31:35.973

```
public static boolean like(String toBeCompare, String by){
    if(by != null){
        if(toBeCompare != null){
            if(by.startsWith("%") && by.endsWith("%")){
                int index = toBeCompare.toLowerCase().indexOf(by.replace("%", "").toLowerCase());
                if(index < 0){
                    return false;
                } else {
                    return true;
                }
            } else if(by.startsWith("%")){
                return toBeCompare.endsWith(by.replace("%", ""));
            } else if(by.endsWith("%")){
                return toBeCompare.startsWith(by.replace("%", ""));
            } else {
                return toBeCompare.equals(by.replace("%", ""));
            }
        } else {
            return false;
        }
    } else {
        return false;
    }
} 
```

可能会帮助你

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-08-16T19:11:51.300

[Comparator](http://java.sun.com/javase/6/docs/api/java/util/Comparator.html)和[Comparable](http://java.sun.com/javase/6/docs/api/java/lang/Comparable.html)接口在这里可能不适用。它们处理排序，并返回符号或 0 的整数。您的操作是关于查找匹配项并返回真/假。那不一样。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-07-20T20:30:06.127

Apache Cayanne ORM 有一个“[内存评估](http://cayenne.apache.org/doc20/in-memory-evaluation.html)”

它可能不适用于未映射的对象，但看起来很有希望：

```
Expression exp = ExpressionFactory.likeExp("artistName", "A%");   
List startWithA = exp.filterObjects(artists); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-03-01T19:32:42.633

[http://josql.sourceforge.net/](http://josql.sourceforge.net/)有你需要的。寻找 org.josql.expressions.LikeExpression。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-07-19T12:42:53.880

我不完全了解贪婪的问题，但如果它适合你，试试这个：

```
public boolean like(final String str, String expr)
  {
    final String[] parts = expr.split("%");
    final boolean traillingOp = expr.endsWith("%");
    expr = "";
    for (int i = 0, l = parts.length; i < l; ++i)
    {
      final String[] p = parts[i].split("\\\\\\?");
      if (p.length > 1)
      {
        for (int y = 0, l2 = p.length; y < l2; ++y)
        {
          expr += p[y];
          if (i + 1 < l2) expr += ".";
        }
      }
      else
      {
        expr += parts[i];
      }
      if (i + 1 < l) expr += "%";
    }
    if (traillingOp) expr += "%";
    expr = expr.replace("?", ".");
    expr = expr.replace("%", ".*");
    return str.matches(expr);
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2022-02-22T17:53:29.357

我有类似的要求，通过一些修改可能会有所帮助，这里是代码：

```
package codeSamplesWithoutMaven; 
```

公共类 TestLikeInJava {

```
public static void main(String[] args) {
    String fromDb = "erick@gmail.com";
    String str1 = "*gmail*";
    String str2 = "*erick";
    String str3 = "*rick";
    String str4 = "*.com";
    String str5 = "erick*";
    String str6 = "ck@gmail*";
    System.out.println(belongsToStringWithWildcards(str1, fromDb));
    System.out.println(belongsToStringWithWildcards(str2, fromDb));
    System.out.println(belongsToStringWithWildcards(str3, fromDb));
    System.out.println(belongsToStringWithWildcards(str4, fromDb));
    System.out.println(belongsToStringWithWildcards(str5, fromDb));
    System.out.println(belongsToStringWithWildcards(str6, fromDb));
}

private static Boolean belongsToStringWithWildcards(String strToTest, String targetStr) {
    Boolean result = Boolean.FALSE;
    int type = 0; //1:start, 2:end, 3:both
    if (strToTest.startsWith("*") && strToTest.endsWith("*")) {
        type = 3;
    } else {
        if (strToTest.startsWith("*")) {
            type = 1;
        } else if (strToTest.endsWith("*")) {
            type = 2;
        }
    }
    System.out.println("strToTest " + strToTest + " into " + targetStr + " type " + type);
    strToTest = strToTest.replaceAll("[*]", "");
    System.out.println("strToTest " + strToTest + " into " + targetStr + " type " + type);
    switch (type) {
        case 1: result = targetStr.endsWith(strToTest);  
                break;
        case 2: result = targetStr.startsWith(strToTest);
                break;
        case 3: result = targetStr.contains(strToTest);
                break;
    }
    return result;
} 
```

}

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-12-30T04:43:43.453

查看[https://github.com/hrakaroo/glob-library-java](https://github.com/hrakaroo/glob-library-java)。

它是 Java 中的一个零依赖库，用于进行 glob（和类似 sql）类型的比较。在大型数据集上，它比转换为正则表达式要快。

基本语法

```
MatchingEngine m = GlobPattern.compile("dog%cat\%goat_", '%', '_', GlobPattern.HANDLE_ESCAPES);
if (m.matches(str)) { ... } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-02-14T12:57:00.243

这是我对此的看法，它在 Kotlin 中，但可以毫不费力地转换为 Java：

```
val percentageRegex = Regex("""(?<!\\)%""")
val underscoreRegex = Regex("""(?<!\\)_""")

infix fun String.like(predicate: String): Boolean {

    //Split the text by every % not preceded by a slash.
    //We transform each slice before joining them with .* as a separator.
    return predicate.split(percentageRegex).joinToString(".*") { percentageSlice ->

        //Split the text by every _ not preceded by a slash.
        //We transform each slice before joining them with . as a separator.
        percentageSlice.split(underscoreRegex).joinToString(".") { underscoreSlice ->

            //Each slice is wrapped in "Regex quotes" to ignore all
            // the metacharacters they contain.
            //We also remove the slashes from the escape sequences
            // since they are now treated literally.
            Pattern.quote(
                underscoreSlice.replace("\\_", "_").replace("\\%", "%")
            )
        }

    }.let { "^$it$" }.toRegex().matches(this@like)
} 
```

它可能不是这里所有解决方案中性能最好的，但它可能是最准确的。

它忽略除 % 和 _ 之外的所有其他正则表达式元字符，并且还支持用斜杠转义它们。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-01-30T09:18:02.167

```
public static boolean like(String source, String exp) {
        if (source == null || exp == null) {
            return false;
        }

        int sourceLength = source.length();
        int expLength = exp.length();

        if (sourceLength == 0 || expLength == 0) {
            return false;
        }

        boolean fuzzy = false;
        char lastCharOfExp = 0;
        int positionOfSource = 0;

        for (int i = 0; i < expLength; i++) {
            char ch = exp.charAt(i);

            // 是否转义
            boolean escape = false;
            if (lastCharOfExp == '\\') {
                if (ch == '%' || ch == '_') {
                    escape = true;
                    // System.out.println("escape " + ch);
                }
            }

            if (!escape && ch == '%') {
                fuzzy = true;
            } else if (!escape && ch == '_') {
                if (positionOfSource >= sourceLength) {
                    return false;
                }

                positionOfSource++;// <<<----- 往后加1
            } else if (ch != '\\') {// 其他字符，但是排查了转义字符
                if (positionOfSource >= sourceLength) {// 已经超过了source的长度了
                    return false;
                }

                if (lastCharOfExp == '%') { // 上一个字符是%，要特别对待
                    int tp = source.indexOf(ch);
                    // System.out.println("上一个字符=%，当前字符是=" + ch + "，position=" + position + "，tp=" + tp);

                    if (tp == -1) { // 匹配不到这个字符，直接退出
                        return false;
                    }

                    if (tp >= positionOfSource) {
                        positionOfSource = tp + 1;// <<<----- 往下继续

                        if (i == expLength - 1 && positionOfSource < sourceLength) { // exp已经是最后一个字符了，此刻检查source是不是最后一个字符
                            return false;
                        }
                    } else {
                        return false;
                    }
                } else if (source.charAt(positionOfSource) == ch) {// 在这个位置找到了ch字符
                    positionOfSource++;
                } else {
                    return false;
                }
            }

            lastCharOfExp = ch;// <<<----- 赋值
            // System.out.println("当前字符是=" + ch + "，position=" + position);
        }

        // expr的字符循环完了，如果不是模糊的，看在source里匹配的位置是否到达了source的末尾
        if (!fuzzy && positionOfSource < sourceLength) {
            // System.out.println("上一个字符=" + lastChar + "，position=" + position );

            return false;
        }

        return true;// 这里返回true
    } 
```

```
Assert.assertEquals(true, like("abc_d", "abc\\_d"));
        Assert.assertEquals(true, like("abc%d", "abc\\%%d"));
        Assert.assertEquals(false, like("abcd", "abc\\_d"));

        String source = "1abcd";
        Assert.assertEquals(true, like(source, "_%d"));
        Assert.assertEquals(false, like(source, "%%a"));
        Assert.assertEquals(false, like(source, "1"));
        Assert.assertEquals(true, like(source, "%d"));
        Assert.assertEquals(true, like(source, "%%%%"));
        Assert.assertEquals(true, like(source, "1%_"));
        Assert.assertEquals(false, like(source, "1%_2"));
        Assert.assertEquals(false, like(source, "1abcdef"));
        Assert.assertEquals(true, like(source, "1abcd"));
        Assert.assertEquals(false, like(source, "1abcde"));

        // 下面几个case很有代表性
        Assert.assertEquals(true, like(source, "_%_"));
        Assert.assertEquals(true, like(source, "_%____"));
        Assert.assertEquals(true, like(source, "_____"));// 5个
        Assert.assertEquals(false, like(source, "___"));// 3个
        Assert.assertEquals(false, like(source, "__%____"));// 6个
        Assert.assertEquals(false, like(source, "1"));

        Assert.assertEquals(false, like(source, "a_%b"));
        Assert.assertEquals(true, like(source, "1%"));
        Assert.assertEquals(false, like(source, "d%"));
        Assert.assertEquals(true, like(source, "_%"));
        Assert.assertEquals(true, like(source, "_abc%"));
        Assert.assertEquals(true, like(source, "%d"));
        Assert.assertEquals(true, like(source, "%abc%"));
        Assert.assertEquals(false, like(source, "ab_%"));

        Assert.assertEquals(true, like(source, "1ab__"));
        Assert.assertEquals(true, like(source, "1ab__%"));
        Assert.assertEquals(false, like(source, "1ab___"));
        Assert.assertEquals(true, like(source, "%"));

        Assert.assertEquals(false, like(null, "1ab___"));
        Assert.assertEquals(false, like(source, null));
        Assert.assertEquals(false, like(source, "")); 
```

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2018-05-22T08:29:42.843

好的，这是一个奇怪的解决方案，但我认为仍然应该提到它。

我们可以利用任何数据库中已有的现有实现，而不是重新创建类似的机制！

（唯一的要求是，您的应用程序必须能够访问任何数据库）。

每次只需运行一个非常简单的查询，根据同类比较的结果返回真或假。然后执行查询，直接从数据库中读取答案！

对于 Oracle 数据库：

```
SELECT
CASE 
     WHEN 'StringToSearch' LIKE 'LikeSequence' THEN 'true'
     ELSE 'false'
 END test
FROM dual 
```

对于 MS SQL 服务器

```
SELECT
CASE 
     WHEN 'StringToSearch' LIKE 'LikeSequence' THEN 'true'
     ELSE 'false'
END test 
```

您所要做的就是将“StringToSearch”和“LikeSequence”替换为绑定参数并设置您要检查的值。

# ajax - Ajax 深度链接？

> ID：898408
> 
> 赞同：5
> 
> 时间：2009-05-22T15:15:15.663
> 
> 标签：ajax, deep-linking

我之前制作了一个 flex 应用程序深层链接，但现在我想制作一个 ajax 应用程序深层链接。

我不知道从哪里开始。

我假设我需要一种方法来监听 url 中的 #hash 何时更改并能够读取它。我假设我需要一种方法来更新 url 中的#hash。

有谁知道该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T15:46:25.827

你在正确的轨道上。

对于您希望能够链接到的 ajax 页面的每个状态，更改哈希标记：

```
window.location.hash = "this_state" 
```

当页面加载时，您需要检查 window.location.hash 值是否与您的状态之一匹配，以及它是否确实使应用程序进入该状态。（“监听”哈希标签的变化是页面加载。）

通过这种方式，您的用户可以为状态添加书签和共享，从而制作出更实用的应用程序，因此需要关心它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T15:45:20.850

查看[SWFAddress](http://www.asual.com/swfaddress/)（Flash 和 Ajax 的深度链接）

更新：如果您使用 jQuery，请查看他们的[jQuery 地址](http://www.asual.com/jquery/address/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-03T18:48:36.613

如果您使用的是 jquery，您可能想看看这个：

[使用 jQuery 地址插件进行深度链接](http://www.electricfairground.com/2009/10/01/restoring-conventional-page-navigation-to-your-javascript-application-with-jquery-history-plugin/)

# java - 显示标签问题

> ID：898417
> 
> 赞同：1
> 
> 时间：2009-05-22T15:16:53.103
> 
> 标签：java, jsp, servlets, jstl

我第一次尝试使用 displaytag，但 displaytag 有问题，我似乎无法解决。我搜索了解决方案，但在互联网上找不到任何东西。其他一切都在工作，这是唯一不工作的事情。

几乎我正在尝试做简单的表格显示。

我得到的错误是：

```
org.apache.jasper.JasperException: javax.servlet.ServletException: javax.servlet.jsp.JspException: org.apache.jasper.JasperException: Unable to load class for JSP 
```

JSP 页面是：

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://displaytag.sf.net" prefix="dt" %>

<%--<jsp:useBean id="ForumList" scope="session" class="mysql.Forum" />--%>

<% session.setAttribute( "test2", mysql.Forum.getMyTopics() ); %>

<dt:table name="sessionScope.test2" /> 
```

我的课真的很简单

```
package mysql;

import java.sql.*;
import java.sql.Connection;
import java.lang.*;
import javax.servlet.*;
import javax.servlet.http.*;

import javax.servlet.jsp.jstl.sql.Result;
import javax.servlet.jsp.jstl.sql.ResultSupport;

public class Forum {
    public Connection con = null;
    public Result myTopics = null;
    public MysqlBase mysql = new MysqlBase();

    public Result getMyTopics()
    {
        try
        {
            con = mysql.getConnection();
            Statement stmt = con.createStatement();
            ResultSet result = stmt.executeQuery("Select * from lawers_topics");
            myTopics = ResultSupport.toResult(result);

            con.close();
            stmt.close();
        }
        catch(Exception e)
        {
        }

        //request.setAttribute("MyTopics", this.myTopics);
        return this.myTopics;
    }
} 
```

如果有人能指出我正确的方向，我将不胜感激。

**编辑：**我忘了说我使用 NetBeans 和 Tomcat6.0 进行开发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:27:52.970

您尝试在表格中显示的对象是否必须实现`java.util.List`？

`Result`不一定会那样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T15:38:28.153

错误“无法为 JSP 加载类”告诉我 Tomcat 没有找到您在 jsp 中引用的一个或多个类文件。您确定您的 mysql.Forum 类在类路径中（在本例中为 WEB-INF/classes/mysql/Forum.class）吗？

此外，您似乎正在尝试从您的 scriptlet 调用 getMyTopics() ，就好像它是 Forum 类的静态方法一样，但它不是静态的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T16:34:05.107

尝试改变

```
<dt:table name="sessionScope.test2" /> 
```

至

```
<dt:table name="${test2}"/> 
```

# sql-server - SQL Server SMO 是否需要特殊权限才能使用？

> ID：898423
> 
> 赞同：1
> 
> 时间：2009-05-22T15:17:53.833
> 
> 标签：sql-server, smo

我有 SMO 代码，可以将表从一个数据库复制到另一个数据库。它在桌面应用程序中运行良好。放入服务中的完全相同的代码会产生错误。该错误确实很模糊，并且没有暗示权限。

我想知道 SMO 对象是否需要使用任何类型的安全性。安全上下文？Windows凭据..等？我不是在谈论 SQL Server 安全性，而是围绕使用 SMO 方法的安全性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T16:03:35.903

你需要完全的信任。在某些托管的 ASP.NET 帐户、从 Internet 下载的应用程序或从共享驱动器上运行此程序时，您可能会遇到问题，其中 CAS 会启动并为代码提供不完全信任的东西，并且某些 API 将无法调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T15:26:54.207

您是否在连接中使用集成安全性？如果是这样，请确保运行服务的凭据具有必要的访问权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T15:28:53.860

确保您的服务帐户（运行 Windows 服务的帐户）具有“作为操作系统的一部分”策略。

# python - Django 购物车/购物篮解决方案（或者我应该 DIM）？

> ID：898426
> 
> 赞同：1
> 
> 时间：2009-05-22T15:19:03.893
> 
> 标签：python, django, e-commerce, shopping-cart

我即将建立一个网站，其中包含大约六种相当相似的产品。它们都是 DVD，因此它们非常适合非常“固定”的数据库。我打算制作一个DVD模型。标记它们。一切都非常简单。一切都很容易。

但我们需要能够出售它们。当前站点将整个采购系统外包，但在新站点上不会进行。我们希望在付款之前集成所有内容（出于用户体验的原因，加上我们可以更多地自定义流程）。

外包问题的另一个问题是它不考虑不需要支付增值税（销售税）的人，或者如果你购买多件相同的东西或多于一件，你可以获得折扣。 SKU 同时。

所以我一直在环顾四周。

Satchmo 看起来像一个完整的迷你框架。它具有我正在处理的 SKU 数量所不需要的列表选项。

django-cart 自 3 月起已重新散列，但从那时起它看起来已经被废弃了。

我正在寻找可以让我：

*   将模型实例、价格和数量传递给它
*   根据同一标题中唯一 SKU 和副本的数量应用数量公式
*   在每个页面上列出购物车中的内容

就是这样（但它非常繁琐）。我可以处理最后的订单处理废话。

* * *

还是我只是傻？

我应该继续自己做吗？如果那是您的投票，我以前从未制造过购物车，那么对于以前只使用过购物车的人来说，是否有任何不明显的考虑因素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T18:46:41.733

既然你问：如果你的需求那么有限，对我来说这听起来像是一个 DIY 的情况。我看不出它有什么特别之处。定价公式有什么复杂性，您打算以任何一种方式提供。添加 Django 的内置会话支持，您就大功告成了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T15:36:26.077

有一个可用的开源解决方案：[http](http://www.getlfs.com)
://www.getlfs.com 我不知道您是否可以对其进行调整以适合您，但它基于您提到的技术。该许可证非常自由，并且维护得很好。

# design-patterns - 如何根据消息传递和工作单元 (XA) 命名以下模式？

> ID：898428
> 
> 赞同：2
> 
> 时间：2009-05-22T15:19:59.930
> 
> 标签：design-patterns, architecture, jakarta-ee, transactions, messaging

我在命名我一直在研究的应用程序常用的模式时遇到了困难。只是为了设置场景：这是一个 Java EE 应用程序，它大量使用消息传递 (JMS)，将数据持久保存在关系数据库 (JDBC) 中，并依赖于由应用程序服务器 (JTA) 管理的全局事务 (XA)。

我所说的模式可以描述如下：

*   使用 JTA 事务管理器启动 XA 事务
*   使用 JMS 从队列接收消息
*   通过执行一些业务逻辑来处理消息，这些业务逻辑可能会更新数据库表 (JDBS) 并将一些其他消息发送到队列 (JMS)。重要的是所有操作都参与正在进行的事务（工作单元）。
*   最后可以选择发回消息或请求转发。

如果发生未捕获的异常，正在进行的工作单元将被回滚，并且触发该过程的原始消息将返回队列以重新传递。

那么，问题是**如何命名这种模式？**不幸的是，我不知道这种模式有什么好名字，但如果这种模式已经很好地命名了，我不会感到惊讶。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T18:06:44.483

在 Gregor Hohpe 和 Bobby Woolf 的 Enterprise Integration Patterns 一书中，这被简单地称为“[事务性客户端](http://www.enterpriseintegrationpatterns.com/TransactionalClient.html)”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T20:32:12.327

交易客户确实。

但是，您可以尝试 Atomikos 变体，消息驱动的 POJO。它将减轻应用程序的事务控制负担，并产生更简单的代码。

看[http://www.atomikos.com/Publications/J2eeWithoutApplicationServer](http://www.atomikos.com/Publications/J2eeWithoutApplicationServer)了解更多详情。

HTH 家伙

# linq-to-sql - 将 Linq 中的 sql 语句分成 2 个或更多部分，取决于程序条件

> ID：898431
> 
> 赞同：1
> 
> 时间：2009-05-22T15:20:34.390
> 
> 标签：linq-to-sql

我是 Linq 的负责人，所以我需要一些帮助..

我不知道是否在 Linq 语法中通过将查询分成 2 个或更多部分，

就像下面的例子一样，

记录将在每个步骤中立即从 sql server 下载，或者在我开始查看所有数据的那一刻将它们发送到服务器？例如，当我绑定一些对象时（例如 Datagrid）

```
System.Linq.IQueryable<Panorami> Result = db.Panorami;
byte FoundOneContion = 0;

//step 1
if (!string.IsNullOrEmpty(Title))
{
  Result = Result.Where(p => SqlMethods.Like(p.Title, "%" + Title + "%"));

  FoundOneContion = 1;
}
//step 2
if (!string.IsNullOrEmpty(Subject))
{
  Result = Result.Where(p => SqlMethods.Like(p.Subject, "%" + Subject + "%"));
  FoundOneContion = 1;
}
if (FoundOneContion == 0)
{
  return null;
}
else
{
  return Result.OrderBy(p => p.Title).Skip(PS * CP).Take(PS);
} 
```

如果不幸的是 Linq 立即下载所有记录

（因此我的怀疑是对的！）

是否存在任何语法来解决问题？

例如：三元运算符（条件？真部分：假部分）

对于任何建议，我将不胜感激。感谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:23:57.970

上述方法不枚举查询 - 因此不进行数据库调用。查询已构造但未执行。

`foreach`您可以通过调用或调用某些调用的方法`foreach`（例如`ToList`, `ToArray`）或调用来枚举查询`GetEnumerator()`。这将导致查询执行。

# c++ - 编译器如何实现静态变量初始化？

> ID：898432
> 
> 赞同：22
> 
> 时间：2009-05-22T15:20:50.490
> 
> 标签：c++, compiler-construction, static, initialization

我很好奇函数中静态变量的底层实现。

如果我声明一个基本类型（char、int、double 等）的静态变量，并给它一个初始值，我想编译器只是在`main()`调用程序的最开始时设置该变量的值：

```
void SomeFunction();

int main(int argCount, char ** argList)
{
    // at this point, the memory reserved for 'answer'
    // already contains the value of 42
    SomeFunction();
}

void SomeFunction()
{
    static int answer = 42;
} 
```

但是，如果静态变量是类的实例：

```
class MyClass
{
    //...
};

void SomeFunction();

int main(int argCount, char ** argList)
{
    SomeFunction();
}

void SomeFunction()
{
    static MyClass myVar;
} 
```

我知道在第一次调用该函数之前它不会被初始化。由于编译器无法知道函数何时第一次被调用，它是如何产生这种行为的？它本质上是否在函数体中引入了一个 if 块？

```
static bool initialized = 0;
if (!initialized)
{
    // construct myVar
    initialized = 1;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T15:51:34.640

[这个问题](https://stackoverflow.com/questions/838917/how-does-the-compiler-resolve-infinite-reference-loops/838932#838932)涵盖了类似的基础，但没有提到线程安全。对于它的价值，C++0x 将使函数静态初始化线程安全。

（参见[C++0x FCD](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3092.pdf) , 6.7/4 关于函数静态：“如果控制在变量初始化时同时进入声明，则并发执行应等待初始化完成。”）

尚未提及的另一件事是函数静态以与其构造相反的顺序被破坏，因此编译器维护一个析构函数列表以在关闭时调用（这可能与 atexit 使用的列表相同，也可能不同）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-22T15:29:30.037

在我看到的编译器输出中，函数局部静态变量完全按照您的想象进行初始化。

请注意，通常这*不是*以线程安全的方式完成的。因此，如果您有可能从多个线程调用的带有静态局部变量的函数，您应该考虑到这一点。在调用任何其他函数之前在主线程中调用一次函数通常可以解决问题。

我应该补充一点，如果本地静态的初始化是通过像您的示例中那样的简单常量，编译器不需要经过这些回转 - 它可以`main()`像常规静态初始化一样初始化图像中或之前的变量（因为你的程序无法区分）。但是，如果您使用函数的返回值对其进行初始化，那么编译器几乎必须测试一个标志，该标志指示是否已完成初始化或类似的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T15:32:25.910

您对所有事情都是正确的，包括作为通用实现的初始化标志。这基本上就是为什么静态局部变量的初始化不是线程安全的，以及为什么 pthread_once 存在。

一个轻微的警告：编译器必须发出“表现得好像”静态局部变量在第一次使用时构造的代码。由于整数初始化没有副作用（并且不调用用户代码），因此在初始化 int 时由编译器决定。用户代码不能“合法地”找出它的作用。

显然，您可以查看汇编代码，或者引发未定义的行为并从实际发生的情况中进行推断。但是 C++ 标准并不认为这是声称该行为不是“好像”它按照规范所说的那样的有效理由。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T15:32:31.747

> 我知道在第一次调用该函数之前它不会被初始化。由于编译器无法知道函数何时第一次被调用，它是如何产生这种行为的？它本质上是否在函数体中引入了一个 if 块？

是的，没错：而且，FWIW，它不一定是线程安全的（如果两个线程同时“第一次”调用该函数）。

出于这个原因，您可能更喜欢在全局范围内定义变量（尽管可能在类或命名空间中，或者在没有外部链接的情况下静态）而不是在函数内，以便在程序启动之前初始化它而无需任何运行时“如果” .

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T16:27:56.823

另一个转折是在嵌入式代码中，其中 run-before-main() 代码（cinit/whatever）可以将预初始化数据（静态和非静态）从 const 数据段复制到 ram 中，可能位于 ROM 中。这在代码可能不是从某种可以重新加载的后备存储（磁盘）运行的情况下很有用。同样，这并不违反语言的要求，因为这是在 main() 之前完成的。

轻微切线：虽然我没有看到它做了太多（在 Emacs 之外），但程序或编译器基本上可以在进程中运行您的代码并实例化/初始化对象，然后冻结并转储进程。Emacs 做了类似的事情来加载大量的 elisp（即对其进行咀嚼），然后将运行状态转储为工作可执行文件，以避免每次调用的解析成本。

# objective-c - 预设 uislider 值

> ID：898436
> 
> 赞同：1
> 
> 时间：2009-05-22T15:22:00.737
> 
> 标签：objective-c, iphone, cocoa-touch

有没有办法将 UISlider 值预设为：

100、121、10000、40505、100000、460322、1000024、5005230等...

数字没有模式。当用户移动滑块时，我想将上述数字显示为与用户在滑块上的位置相对应。滑块以特定增量将数字显示为浮点数。将这些值转换为上述值的最佳方法是什么……或者我应该使用不同的控件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T01:36:25.947

没有内置任何东西，但似乎并不难使某些东西起作用。只需定义最小值 0 和最大值 X，其中 X 是您需要的不同值的数量。然后当您需要获取值时，只需打开`(int)value`

# c - 如何忽略从标准输入读取的 C 中的箭头键？

> ID：898443
> 
> 赞同：2
> 
> 时间：2009-05-22T15:23:06.430
> 
> 标签：c, stdout, stdin, system-calls, arrow-keys

我正在使用 read() 系统调用从标准输入中读取数据，但是有一件小事困扰着我。我不能使用箭头键...我真正想做的是使用箭头键在键入的文本中来回移动，但我认为这并不容易...所以，我至少想做的，就是忽略它们。

现在，按下任何箭头键都会产生奇怪的输出，我想阻止任何东西被写入标准输出（随后在我的 read() 系统调用中从标准输入读取）。

这很容易实现还是没那么容易？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T15:30:35.603

为了以理想的方式解释箭头键（即来回移动和编辑输入），您通常需要使用库。对于 Linux，标准是[GNU Readline](http://tiswww.case.edu/php/chet/readline/rltop.html)。希望其他人可以说出您通常用于 Windows CLI 应用程序的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T23:19:01.467

答案最终取决于密钥的来源。我在 Cygwin 下运行这个程序：

```
int main(void)
{
    int c=0;

    while( c != 'X' ) {
        c = getchar();
        printf("\nc=%d", c);
    }
} 
```

每次出现光标键时，我都会看到转义 (27)、括号和另一个字符。所以，如果你得到这样的结果，你可以在每次看到 27 时跳过 3 个键。你也可以看看它们并利用它们！

如前所述，YMMV，特别是对于操作系统，以及您调用的实际密钥获取函数。

# authentication - 尝试在 URL 中使用 IP 地址时的身份验证问题

> ID：898444
> 
> 赞同：2
> 
> 时间：2009-05-22T15:23:13.090
> 
> 标签：authentication, iis, active-directory, windows-authentication

我正在使用 IIS 6.0 并且有一个虚拟目录设置。服务器设置在我公司的 Intranet 上。在安全设置下，禁用匿名访问，启用集成 windows 身份验证，启用 windows 域服务器的摘要身份验证，并且领域有我们的 AD 域地址。

[当使用包括机器名称（如“ http://myServerName/myWebSite/](http://myServerName/myWebSite/) ” ）的 URL 访问站点时，此身份验证一切正常。但是，当我们使用这种格式“ [http://myIPAddress/myWebSite/](http://myIPAddress/myWebSite/) ”时，会弹出一个安全框。如果在此框中输入凭据，则一切正常。为什么在 URL 中使用 IP 地址代替机器名称时会弹出此问题？

我们需要在 URL 中使用 IP 地址的原因是带有服务器名称的 URL 在我们所有的位置都无法识别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T11:54:48.093

Microsoft 知识库文章*[Internet Explorer 可能会提示您输入密码](http://support.microsoft.com/kb/258063)* 有答案，因为 IP 地址将被视为 Internet 区域中的地址：

> Internet Explorer 必须认为请求的 URL 位于 Intranet（本地）上。如果请求的 URL 的计算机名称部分包含句点（例如[http://www.microsoft.com](http://www.microsoft.com)和[http://10.0.0.1](http://10.0.0.1)），Internet Explorer 会假定请求的地址存在于 Internet 上并且不传递任何凭据自动地。没有句点的地址（如[http://webserver](http://webserver)）被认为在内网（本地）；Internet Explorer 自动传递凭据。唯一的例外是 Internet Explorer 中 Intranet 区域中包含的地址。

您可以设置 DNS 以便将服务器名称正确解析为 IP，或者按照上面知识库文章中提到的建议进行操作

# javascript - YUI 压缩器可以缩小 ASP.NET 内联脚本吗？

> ID：898446
> 
> 赞同：4
> 
> 时间：2009-05-22T15:23:35.913
> 
> 标签：javascript, minify, yui-compressor

如何压缩内联脚本和样式标签？

YSlow 说[除了缩小外部脚本和样式外，内联脚本和样式块可以而且也应该缩小](http://developer.yahoo.com/performance/rules.html#minify)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-06T14:52:09.900

不要忘记[YUI Compressor 有一个 .NET 端口](http://yuicompressor.codeplex.com/)。:)

您可以将它用于构建后事件或 TFS 构建，或者仅在您自己的项目中使用 dll。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T15:27:53.550

您可能会查看[MBCompression](http://www.codeplex.com/MbCompression) 它允许您压缩来自 .net 应用程序的几乎所有内容（包括那些可爱的 webresource.axd 文件）。

这与常规 javascript 压缩具有类似的效果。除此之外，我仍然会考虑将内联脚本提取到单独的文件中，以删除重复并允许浏览器缓存该数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T15:27:23.237

这只是文字。从它周围的 HTML 中删除它，通过 YUI 压缩器运行它，然后将它放回去。

如果它是由 ASP.NET 组件生成的——那么你可能不得不在离开 ASP 的过程中拦截它（例如使用代理），并且在这一点上几乎可以肯定不值得付出努力。

# c# - ASP.NET/Jquery：更新面板中的文档准备好了吗？

> ID：898448
> 
> 赞同：0
> 
> 时间：2009-05-22T15:23:45.337
> 
> 标签：c#, asp.net, jquery

我有以下用户控制：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="FadingMessage.ascx.cs" Inherits="includes_FadingMessage" %>

<asp:PlaceHolder Visible="false" runat="server" ID="plhMain">
<span id="<%= this.ClientID+"_panel" %>" style="background-color:yellow; padding:10px;">
<b><%= Message %></b>
</span>

<script type="text/javascript" language="javascript">

$(document).ready(function() {
    alert("never gets here??");
    jQuery('#<%= this.ClientID+"_panel" %>').fadeOut(1000);  
});

</script>

</asp:PlaceHolder> 
```

在 asp:UpdatePanel 中使用。我的问题是 $(document).ready 永远不会被解雇？

如何检测部分渲染何时完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:29:26.667

在你的头标签中放置一个方法，然后在你的占位符中调用它。这里的问题是你的 PlaceHolder Visible="false" 所以它永远不会被渲染。如果您通过 ajax 动态显示它，则脚本将不会运行。当您动态显示占位符时，您必须重新绑定它。我建议不要使用 document(ready) ...

# c# - 如何知道谁连接到 WPF 中的应用程序？

> ID：898451
> 
> 赞同：1
> 
> 时间：2009-05-22T15:23:58.610
> 
> 标签：c#, .net, wpf

大家好，我希望开始为我开发一个新功能，在我的项目中，我有一个数据库（使用 SqlServer）和一个应用程序（在 WPF 中开发），该应用程序的目的是管理/处理会计和其他部门，所以我创建了一个密码和角色（供用户）在应用程序中访问，现在我将创建一个系统来知道有多少用户连接到应用程序（通过数据库）并在列表框中显示（例如像普通的聊天应用程序我希望知道谁在线和离线）但我不知道我需要从哪里开始解决这个功能，我对这个功能很陌生，所以如果你有任何建议，链接，否则我会非常感激你的帮助。

非常感谢。

PS如果我的问题不清楚，我会重写它......但是很抱歉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:46:13.830

也许在数据库本身？当用户登录时，您可以为每个用户设置一个标志“LoggedInd = true”，并在他们注销时设置“LoggedIn = false”。并对该标志“SELECT * FROM Users WHERE LoggedIn = true”进行查询

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T17:10:20.350

在不知道您的应用程序详细信息的情况下，我建议在他们登录时在数据库中设置一个时间戳字段，然后在他们登录时每 X 分钟再次设置一次。与仅设置一个标志相比，这有两个优点：

1）如果应用程序崩溃，或者用户的机器崩溃了，flag不会被重置，你将无法知道他们还没有登录。

2) 时间戳会告诉你每个用户最后一次登录的时间，即使他们当前没有登录。

# mysql - MySql FLOAT 数据类型和超过 7 位数的问题

> ID：898454
> 
> 赞同：4
> 
> 时间：2009-05-22T15:25:05.397
> 
> 标签：mysql, rounding, mysql-5.0

我们在 Ubuntu 9.04 上使用 MySql 5.0。完整版为：5.0.75-0ubuntu10

我创建了一个测试数据库。和一个测试表。我从插入语句中看到以下输出：

```
mysql> CREATE TABLE test (floaty FLOAT(8,2)) engine=InnoDb;
Query OK, 0 rows affected (0.02 sec)

mysql> insert into test value(858147.11);
Query OK, 1 row affected (0.01 sec)

mysql> SELECT * FROM test;
+-----------+
| floaty    |
+-----------+
| 858147.12 | 
+-----------+
1 row in set (0.00 sec) 
```

mySql 中设置的比例/精度似乎有问题......或者我错过了什么？

更新：

找到我们要插入的数字之一的边界，这里是代码：

```
mysql> CREATE TABLE test (floaty FLOAT(8,2)) engine=InnoDb;
Query OK, 0 rows affected (0.03 sec)

mysql> insert into test value(131071.01);
Query OK, 1 row affected (0.01 sec)

mysql> insert into test value(131072.01);
Query OK, 1 row affected (0.00 sec)

mysql> SELECT * FROM test;
+-----------+
| floaty    |
+-----------+
| 131071.01 | 
| 131072.02 | 
+-----------+
2 rows in set (0.00 sec)

mysql> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T15:49:08.307

面对手掌！！！！

浮点数是存储为尾数和指数的 32 位数字。我不是 100% 确定 MySql 将如何拆分存储，但以 Java 为例，他们将使用 24 位作为有符号尾数，使用 8 位作为指数（科学记数法）。这意味着 FLOAT 可以具有的最大值为 +8388608*10^127，最小值为 -8388608*10^127。这意味着只有 7 个有效数字，而我的 FLOAT 定义使用了 8。

我们将把所有这些 8,2 从 FLOAT 转换为 DOUBLE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T15:38:41.913

MySQL 文档提到“MySQL 在存储值时执行舍入”，我怀疑这是这里的问题。我重复了您的问题，但将存储类型更改为 DOUBLE：

```
CREATE TABLE test (val, DOUBLE); 
```

并且检索到的值与您提供的测试值匹配。

对于它的价值，我的建议是使用 DOUBLE 或 DECIMAL。我尝试了相同的原始测试：

```
CREATE TABLE test (val, DECIMAL(8,2)); 
```

它检索了我给它的值：858147.11。

# c# - 使用实体框架选择特定列而不是整个对象会有什么问题？

> ID：898455
> 
> 赞同：0
> 
> 时间：2009-05-22T15:25:15.800
> 
> 标签：c#, .net, entity-framework

如果我从这里更改我的实体框架查询，我会遇到什么问题：

```
var contracts = from contract in Context.Contracts select contract; 
```

对此：

```
var contracts = from contract in Context.Contracts select new MyContract{ Key = contract.key, Advertiser = new MyAdvertiser{ Key = contract.Advertiser.Key } }; 
```

即从选择合同更改为根据合同的列选择新对象。

在任何一种方法中，我都会在加载后将实体映射到域对象，然后在保存时将其映射回实体。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T17:16:48.110

这种方法没有任何问题。有几件事要记住：

1) 域对象应始终完全填充，以防止域进程尝试使用看起来存在但不存在的数据的情况。如果您有不需要来自域对象的完整数据集的相同域进程，并且您不想加载不必要的数据，请创建第二个域对象以用于这些进程。

2) 数据库服务器可以比具有不同字段列表的查询更好地优化具有相同字段列表的查询。如果性能对此应用程序至关重要，请确保衡量此更改对查询性能的影响。似乎限制结果集会提高性能，而且通常确实如此，但并非总是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T15:30:43.637

我认为您不会有任何问题（我也是这样做的），只需确保您编写了一个方法来进行映射，因此您不必在每个查询中重复它们。

# delphi - C++ Builder（和 Delphi）中的默认文件布局

> ID：898458
> 
> 赞同：3
> 
> 时间：2009-05-22T15:25:35.660
> 
> 标签：delphi, c++builder, c++builder-2007

一段时间以来，我一直对 C++ Builder IDE 感到非常烦恼。当我编码时，我总是对代码文件使用标准布局。我有一个我使用的标准标题，包括，即。文件的许可证、文件名、日期等。

但是我找不到任何地方可以插入这个，所以当我 - 例如 - 创建一个新单元时，会自动插入这个标题。当然，我可以每次都将其粘贴进去，但是花时间这样做会有点烦人。

所以我的问题是 - 是否可以为默认 C++ 文件创建文件模板或修改现有文件，以便它们始终以我预定义的布局开始。我担心的是，就像 C++ Builder IDE 中的大多数其他东西一样，这是硬编码到其中的。

当前创建一个新单元会创建一个 .cpp 文件，其中包含：

```
//---------------------------------------------------------------------------

#pragma hdrstop

#include "Unit1.h"

//---------------------------------------------------------------------------

#pragma package(smart_init) 
```

和相应的头文件：

```
//---------------------------------------------------------------------------

#ifndef Unit1H
#define Unit1H
//---------------------------------------------------------------------------
#endif 
```

这就是我希望将其更改为我自己定义的布局。

我正在使用 Codegear C++ Builder 2007。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T15:39:06.577

请参阅帮助文件中的“将项目添加到对象存储库”。

基本上， 1\. 根据需要创建单元文件 2\. 转到 Project -> Add to Repository 3\. 添加信息。4\. 可从文件 -> 新建... 区域获得

还有一些方法可以共享和编辑存储库项目。默认分发项不是那么灵活，但是创建自己的分发项应该可以满足您的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T21:05:16.183

对于默认值，请参阅关于减少也位于堆栈溢出上[的“uses”子句样板](https://stackoverflow.com/questions/880125/how-do-i-reduce-uses-boilerplate-for-new-forms)的问题的答案。这将需要相同的更改。

# vbscript - VBscript问题：如果vercode不等于1234如何结束

> ID：898459
> 
> 赞同：0
> 
> 时间：2009-05-22T15:25:37.360
> 
> 标签：vbscript

我是 VBscript 的新手，所以我需要以下帮助。正如您在第 12 行所注意到的，提到了 vercode。我想要一个声明，说如果vercode 不是“1234”，其他任何事情都无济于事（即脚本终止）。你知道如何？

```
<%@LANGUAGE="VBSCRIPT" CODEPAGE="65001"%>
<!-- #INCLUDE file="inc/settings.asp" -->
<!-- #INCLUDE file="inc/functions.asp" -->
<!-- #INCLUDE file="inc/db_connect.asp" -->
<%
nameSurname = sqlquote(trim(request.form("name"))) & ""
comment = sqlquote(trim(request.form("comment")) & "")
nid = request.form("nid")
pid = request.form("pid")
comment_date = DatePart("d",now()) & "/" & DatePart("m",now()) & "/" & DatePart("yyyy",now())

if vercode = "1234" then
if nameSurname = "" then nameSurname = "Anonymous" end if
if comment <> "" then 
    strSQL = "INSERT INTO Comments (fName, Comment, DateSubmitted, NewsID) " &_
              "VALUES ('" & nameSurname & "', '" & comment & "', #" & comment_date & "#, " & nid & ");"
    con.execute strSQL
    con.close
end if
response.redirect("news.asp?NewsID=" & encrypt(nid) & "&PID=" & encrypt(pid) )
%> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:32:32.150

如果 vercode 不是“1234”，而不是终止脚本，如果它等于“1234”，则运行脚本的有趣部分，如下所示：

```
<%@LANGUAGE="VBSCRIPT" CODEPAGE="65001"%>
<!-- #INCLUDE file="inc/settings.asp" -->
<!-- #INCLUDE file="inc/functions.asp" -->
<!-- #INCLUDE file="inc/db_connect.asp" -->
<%
nameSurname = sqlquote(trim(request.form("name"))) & ""
comment = sqlquote(trim(request.form("comment")) & "")
nid = request.form("nid")
pid = request.form("pid")
comment_date = DatePart("d",now()) & "/" & DatePart("m",now()) & "/" & DatePart("yyyy",now())

if vercode = "1234" then
  if nameSurname = "" then 
    nameSurname = "Anonymous" 
  end if
  if comment <> "" then 
    strSQL = "INSERT INTO Comments (fName, Comment, DateSubmitted, NewsID) " &_
                                        "VALUES ('" & nameSurname & "', '" & comment & "', #" & comment_date & "#, " & nid & ");"
                                        'debugging strsql
    con.execute strSQL
    con.close
  end if
  response.redirect("news.asp?NewsID=" & encrypt(nid) & "&PID=" & encrypt(pid) )
end if    
%> 
```

# jquery - 每次使用 jQuery 选择 DropDownList 项目时触发事件

> ID：898463
> 
> 赞同：34
> 
> 时间：2009-05-22T15:26:14.253
> 
> 标签：jquery, html-select

我有一个下拉列表：`<asp:DropDownList id="dropdownid" runat="server" class=blah"/>`

在我的 jQuery 中，我分配了这样的更改事件：

```
$('#dropdownid').change(function() {......}); 
```

现在，当我从下拉列表中选择不同的值时，这有效，但是假设我想再次选择相同的值。（因为我想用相同的值进行另一个调用）所以，当我再次选择它时，（不更改值）只需从下拉列表中单击所选值并再次“选择”它，就不会触发任何事件。我必须分配给它的 jquery 中是否还有另一个事件？什么是解决方法？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-22T16:28:39.817

为了扩展**[Vincent Ramdhanie 的](https://stackoverflow.com/questions/898463/using-jquery-with-select-control/898620#898620)**建议，看看做这样的事情。本质上，您最终会得到您自己的 jQuery 函数，您可以在其他地方重复使用。

**第 1 步**：创建 jQuery 函数

```
(function($) {
    $.fn.selected = function(fn) {
        return this.each(function() {
            var clicknum = 0;
            $(this).click(function() {
                clicknum++;
                if (clicknum == 2) {
                    clicknum = 0;
                    fn(this);
                }
            });
        });
    }
})(jQuery); 
```

**第 2 步**：确保引用了新创建的 jQuery 函数的文件以供使用：

```
<script src="Scripts/jqDropDown.js" type="text/javascript"></script> 
```

**第 3 步**：使用新功能：

```
$('#MyDropDown').selected(function() {
    //Do Whatever...
}); 
```

**原始信息**
使用您当前的代码库，从 asp:DropDownList 中选择相同的值不会触发更改事件。

您可以尝试为 .blur 事件添加另一个 jQuery 函数。当控件失去焦点时会触发：

```
$('#dropdownid').blur(function() {......}); 
```

如果它们模糊功能对您不起作用，我会添加一个刷新按钮或其他可以触发您尝试使用的功能的影响。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-22T15:54:51.787

试试这个：

```
$(document).ready(function(){
 var clicknum = 0;
 $("#dropdownid").click(function(){
    clicknum++;
    if(clicknum == 2){
        alert($(this).val());
        clicknum = 0;
    }
 });
}); 
```

首先，您要创建一个变量 clicknum 来跟踪点击次数，因为您不希望每次用户点击下拉框时都会触发该事件。第二次点击是用户做出的选择。

如果 click num 恰好是 2，那么这是第二次点击，因此触发事件并将 clicknum 重置为 0 以供下次使用。否则什么都不做。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-22T16:51:15.630

只需将单击事件处理程序连接到封闭的选项控件而不是选择：

```
$('#dropdownid option').click(function() {......}); 
```

这只会在您从下拉列表中选择一个选项时触发，无论它是否更改。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T15:36:37.187

根据[API](http://docs.jquery.com/Events/change#fn)：

> 当控件失去输入焦点并且其值在获得焦点后已被修改时，将触发 change 事件。

您可能想尝试使用 mousedown 或单击事件作为替代方法。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-04-25T15:49:34.077

许多当前的解决方案将在很多情况下中断。任何依赖于两次检查点击计数的解决方案都将是非常善变的。

### 需要考虑的一些场景：

*   如果您单击，然后关闭，然后再打开，它将同时计算点击次数和触发次数。
*   在 Firefox 中，您可以通过单击鼠标打开菜单并拖动到所选选项，而无需抬起鼠标。
*   如果您使用键盘敲击的任何组合，您可能会导致点击计数器不同步或完全错过更改事件。
    *   `Alt`您可以使用+打开下拉菜单`↕</kbd> (or the `Spacebar` in Chrome and Opera).`
    *   当下拉菜单有焦点时，任何箭头键都会改变选择
    *   当下拉菜单打开时，单击`Tab`或`Enter`将进行选择

### 这是一个更全面的扩展：

查看是否选择了选项的最可靠方法是使用[`change`](https://developer.mozilla.org/en-US/docs/Web/Reference/Events/change)事件，您可以使用 jQuery 的[`.change()`](http://api.jquery.com/change/)处理程序来处理它。

唯一剩下要做的就是确定是否再次选择了原始元素。
这已经被问了很多（[一](https://stackoverflow.com/q/15452103/1366033)、[二](https://stackoverflow.com/q/11785479/1366033)、[三](https://stackoverflow.com/q/1402227/1366033)），在任何情况下都没有很好的答案。

最简单的做法是检查元素上是否有`click`或`keyup`事件**但****[Chrome、IE 和 safari 似乎不支持](http://webbugtrack.blogspot.ca/2007/11/bug-280-lack-of-events-for-options.html)****[元素](http://webbugtrack.blogspot.ca/2007/11/bug-280-lack-of-events-for-options.html)**上的事件，即使它们在[w3c 推荐中](http://www.w3.org/TR/html401/interact/forms.html#h-17.6)`option:selected`**[`option`](http://webbugtrack.blogspot.ca/2007/11/bug-280-lack-of-events-for-options.html)**

元素内部`Select`似乎是一个黑盒子。如果您在其上收听事件，您甚至无法判断事件发生在哪个元素上或列表是否打开。

接下来最好的事情似乎是处理`blur`事件。这将表明用户已将注意力集中在下拉列表上（可能看到了列表，也可能没有）并做出了他们想要坚持原始值的决定。要立即继续处理更改，我们仍将订阅该`change`事件。并且为了确保我们不会重复计算，如果更改事件被引发，我们将设置一个标志，这样我们就不会回击两次：

### 代码：

```
(function ($) {
    $.fn.selected = function (fn) {
        return this.each(function () {
            $(this).focus(function () {
                this.dataChanged = false;
            }).change(function () {
                this.dataChanged = true;
                fn(this);
            }).blur(function (e) {
                if (!this.dataChanged) {
                    fn(this);
                }
            });
        });
    };
})(jQuery); 
```

然后像这样调用：

```
$("#dropdownid").selected(function (e) {
    alert('You selected ' + $(e).val());
}); 
```

## [更新了 jsFiddle 中的示例](http://jsfiddle.net/KyleMit/QxS6T/3/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-31T10:32:06.887

查看此解决方案：http:
[//ledomoon.blogspot.com/2009/12/dropdown-selected-change-event-by.html](http://ledomoon.blogspot.com/2009/12/dropdown-selected-change-event-by.html)

```
$(document).ready(function () {
    // select all the divs and make it invisible
    $("div.Content").css("display", "none");
    // Find all the combos inside the table or gridview
    $("#tblItems").find("select.Status").each(function () {
        // Attached function to the change event of each combo
        $(this).change(function () {
            if ($(this).val() == "test1") {
                // Change the visibility of the next div after the selected combo if the selected value = test1
                $(this).parent().find("div.Content").fadeIn("slow"); //css("display","block");
            } else {
                $(this).parent().find("div.Content").fadeOut("slow"); //.css("display","none");
            }
        });
    });
}); 
```

希望这可以帮助

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T15:38:54.393

您遇到的这个问题是由于客户端对基本选择 HTML 的处理。由于大多数客户不会标记未更改，因此您将不得不尝试不同的东西。

我可能会添加一个“刷新”按钮或类似的东西，但我是开发人员而不是设计师，所以我可能错了。:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T16:44:13.003

下拉列表中的选定项目反映了已经做出的选择。

我的建议是每次完成所需的操作时，将下拉菜单重置为默认值，如“选择...”。因此，如果用户需要执行两次操作 A，则下拉菜单将在每次操作后重置。

1.  用户从下拉列表中选择操作 A。
2.  执行操作 A 并重置下拉菜单。
3.  用户从下拉列表中选择操作 A。
4.  执行操作 A 并重置下拉菜单。

希望这可以帮助，

富有的

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-28T02:30:10.720

对我来说，以下解决方案效果很好：

```
$("#dropdownid select").click(function() {
  alert($("#dropdownid select option:selected").html());
}); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-08-23T11:53:01.353

还：

```
$('#dropdownid select option').click(function() {
   ....
} 
```

# javascript - 显示多行通知

> ID：898473
> 
> 赞同：10
> 
> 时间：2009-05-22T15:28:20.880
> 
> 标签：javascript, jquery, firefox-addon, firefox-addon-sdk

我刚开始玩[Mozilla Jetpack](https://jetpack.mozillalabs.com/)，到目前为止我很喜欢它。我写了一个小代码，在状态栏中显示一个图标，当点击它时，会弹出一个通知：

```
var myTitle = 'Hello World!';
var line1 = 'I am the very model of a modern Major-General,';
var line2 = 'I\'ve information vegetable, animal, and mineral,';
var line3 = 'I know the kings of England, and I quote the fights historical,';
var line4 = 'From Marathon to Waterloo, in order categorical.';
var myBody = line1 + ' ' + line2 + ' ' + line3 + ' ' + line4;
var myIcon = 'http://www.stackoverflow.com/favicon.ico';

jetpack.statusBar.append({
  html: '<img src="' + myIcon + '">',
  width: 16,
  onReady: function(doc) {
    $(doc).find("img").click(function() {
      jetpack.notifications.show({title: myTitle, body: myBody, icon: myIcon});
    });
  }
}); 
```

由于此示例中的文本很长，因此通知如下所示：

[Jetpack 通知 http://img33.imageshack.us/img33/7113/jetpack.png](http://img33.imageshack.us/img33/7113/jetpack.png)

我想在显示通知的文本时将它们拆分为四个不同的行，以便通知框更高更窄。我该怎么做呢？

**编辑 1（感谢[Rudd Zwolinski](https://stackoverflow.com/users/219/rudd-zwolinski)）：**

我试过了，但这无济于事：

```
var myBody = line1 + '\n' + line2 + '\n' + line3 + '\n' + line4; 
```

**编辑 2（感谢[Ólafur Waage](https://stackoverflow.com/users/22459/olafur-waage)）：**

这也无济于事：

```
var myBody = line1 + '<br />' + line2 + '<br />' + line3 + '<br />' + line4; 
```

**编辑 3（感谢[马特](https://stackoverflow.com/users/85803/matt)）：**

即使这样也无济于事：

```
var myBody = line1 + "\n" + line2 + "\n" + line3 + "\n" + line4; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T17:21:46.967

不幸的是，创建的警报不允许在 Windows 中弹出 toast 的新行。根据 Jetpack API：

> 最终，这个对象将成为与您的用户轻松沟通的终极目标。通知栏、透明消息、咆哮、门把手消息等等都会经过这里。**目前，它只有简单的通知。**

如[源代码](http://hg.mozilla.org/labs/jetpack/file/696629c0ba99/extension/content/js/notifications.js)所示，该`jetpack.notifications.show`方法调用了 Mozilla [`nsIAlertsService`](https://developer.mozilla.org/En/NsIAlertsService)，它不允许 Windows toast 弹出窗口使用多行。

好处是该 API 表明您将来可以更好地控制警报，但对于预发布版本，您必须将通知文本保持在最低限度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T15:42:17.823

我无法对此进行测试，因为我在 Mac 上并从中获取 Growl 通知`jetpack.notifications.show`，并且 Growl 会限制宽度，但请尝试更改`myBody`为：

```
var myBody = line1 + '\n' + line2 + '\n' + line3 + '\n' + line4; 
```

换行符确实出现在我身上，所以这可能就是你要找的。

**编辑**：这不适用于 Windows toast 通知，因此它不能回答问题。但是，**它将在 Mac OS X 的 Growl 通知中显示换行符**，因此我将保留此答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T15:47:25.610

IIRC 正确，jetpack 使用 JavaScript 和 HTML，所以只需尝试在行`<br />`之间添加。

# c - VIDIOCGCAP ioctl 调用的 V4L 问题

> ID：898474
> 
> 赞同：1
> 
> 时间：2009-05-22T15:28:40.520
> 
> 标签：c, ioctl

我在使用 V4L（为 Linux 提供对各种视频捕获的统一访问的 API）时遇到了一些问题。我正在尝试进行 VIDIOCGCAP ioctl 调用，但收到 INVALID ARGUMENT 错误。这是一个strace：

```
execve("./test", ["./test"], [/* 26 vars */]) = 0
brk(0) = 0x8d5c000
access("/etc/ld.so.nohwcap", F_OK) = -1 ENOENT (没有那个文件或目录)
mmap2(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7fc9000
access("/etc/ld.so.preload", R_OK) = -1 ENOENT (没有这样的文件或目录)
打开（“/etc/ld.so.cache”，O_RDONLY）= 3
fstat64(3, {st_mode=S_IFREG|0644, st_size=29703, ...}) = 0
mmap2(NULL, 29703, PROT_READ, MAP_PRIVATE, 3, 0) = 0xb7fc1000
关闭（3）= 0
access("/etc/ld.so.nohwcap", F_OK) = -1 ENOENT (没有那个文件或目录)
打开（“/lib/i686/cmov/libc.so.6”，O_RDONLY）= 3
读(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\260e\ 1\0004\0\0\0\4"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=1413540, ...}) = 0
mmap2(NULL, 1418864, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xb7e66000
mmap2(0xb7fbb000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x155) = 0xb7fbb000
mmap2(0xb7fbe000, 9840, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xb7fbe000
关闭（3）= 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7e65000
set_thread_area({entry_number:-1 -> 6, base_addr:0xb7e656b0, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}) = 0
mprotect(0xb7fbb000, 4096, PROT_READ) = 0
munmap(0xb7fc1000, 29703) = 0
打开（“/dev/video0”，O_RDONLY）= 3
ioctl(3, EXT2_IOC_GETVERSION 或 VIDIOCGCAP, 0xbf8e4ca4) = -1 EINVAL（无效参数）
fstat64(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 0), ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7fc8000
写（1，“错误”...，3err）= 3
退出组（3）=？= ?

```

这是代码：

```
#include "linux/videodev.h"
#include "fcntl.h"
#include “stdio.h”
int main() {
int fd = open("/dev/video0", O_RDONLY);
struct video_capability chan；
if (ioctl(fd, VIDIOCGCAP, &chan) == -1) printf("err");
}

```

和：

```
gcc -o 测试 test.c

```

更多信息：我在这台机器上有其他使用 V4L 没有问题的视频捕获软件。所以，我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T17:25:47.037

也许您需要尝试使用 V4L2，即 VIDIOC_QUERYCAP ioctl。

# java - 如何在 AppEngine 上动态创建图像

> ID：898475
> 
> 赞同：5
> 
> 时间：2009-05-22T15:28:52.907
> 
> 标签：java, image, google-app-engine

我在 AppEngine 上有一个用 Java 托管的应用程序，我想添加一个功能，用户可以在其中获得数据的图形摘要。BufferedImage 在 AppEngine 上被列为不支持。显示过程将很简单——一系列两种颜色中的一种的小方块。

问候，

肯特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T15:32:04.007

如果您没有找到更好的解决方案，您可以将图形生成委托给[Google Charts](http://code.google.com/intl/en/apis/chart/types.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:58:54.933

在 App Engine 中查看有关[图像服务的文档。](http://code.google.com/appengine/docs/java/images/overview.html)您可以使用合成功能做您想做的事。

# javascript - ajax请求浏览器限制

> ID：898477
> 
> 赞同：9
> 
> 时间：2009-05-22T15:29:11.643
> 
> 标签：javascript, ajax, json

一个更通用的问题开始。如果是 JSON 请求，ajax 请求的响应大小是否有限制？

我通过 JSON 请求传递大量数据并在 FF3 中遇到“脚本堆栈配额已用完”消息。现在在 FF2 中，配额是 4mb，但在 FF3 中是 640kb。我想知道这是否以某种方式特定于 JSON。正常的 ajax 请求是否有响应大小限制？一种可能由浏览器强加的？如果非 JSON 请求在脚本堆栈配额方面没有这些相同的问题，我如何对返回的数据进行分类？也许是 XML……我不确定我的数据是否会在 w3c 规范的范围内。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T15:52:21.037

iirc 这是去年 FF3 上的一个错误，但我相信（是的，[在这里](https://bugzilla.mozilla.org/show_bug.cgi?id=420869)检查过）它已修复。但是，查看评论，有这个注释：

> 注意：此测试取决于架构和可用内存。在具有 2G 和 64 位构建的 x86_64 机器上，它将失败并显示 InternalError：脚本堆栈空间配额已用完，但是在具有 4G 和 64 位构建的 x86_64 上它将通过。

评论还指出这是一个纯粹的 JS 问题，这意味着尽管数据格式严格来说并不重要，但非常大的 JSON 块可能会破坏 JS 堆栈，而 XML 字符串可能不会。我想你只需要尝试一下。

OTOH，它被标记为已修复，所以有一个问题是确保你也使用最新版本的 FF。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T15:48:35.360

如果您发送数据和接收数据，我怀疑限制是不同的，所以我假设它是围绕向客户端发送数据。JSON 只是一种数据类型，真的。值得怀疑的是，您真正在做的是对 JavaScript 脚本发出 GET 请求，该脚本应限制在合理的大小范围内。JSON 的 wiki 还说使用 XMLHTTPRequest 方法，这可能会绕过您的限制，但您仍然需要代理来避免跨域脚本限制并使用更合理的 mime 类型，如 html、xml、二进制等。如果您将任何图像放入 JSON 中，请记住它们可以是链接，因为这些请求不存在跨域问题。

还要仔细检查，这不是给您带来麻烦的请求数量，浏览器也有限制。有时低至 2。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T16:24:27.617

我认为阿纳卡塔是对的。

错误消息的文本还表明问题的发生是由于您的 json 结构的深度，而不是它的 KB 大小。

这意味着当您评估 json 时，JavaScript 引擎在解析 json 期间使用堆栈。由于 json 结构中的深度（嵌套元素的数量），此堆栈已达到其最大限制。

您可能想检查更扁平的结构是否适合您的要求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T15:49:48.510

作为一般规则，我尽量保持我的 AJAX 数据很小。如果我必须传递大量数据，我将通过多次调用来检索它。因此，如果我正在加载一个表，我将有一个方法告诉我将返回多少条记录，另一种方法以 # 为一组（通常为 20 条）返回记录。

这样做的好处是我可以在检索数据时加载页面，并且用户无需等待一个大的有效负载。

此外，最好使用 JSON 而不是 XML。JSON 通常是比 XML 更小的有效负载，许多测试表明浏览器更容易加载它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T15:56:02.300

我没有遇到任何切实的限制，但是您的用户交互性将大数据分解为多个调用。大表需要很长时间才能通过 ajax 传输，尤其是在用户运行 IE 时。大数据 + Ajax + IE = IE 崩溃。

# unit-testing - 查询汇编

> ID：898487
> 
> 赞同：2
> 
> 时间：2009-05-22T15:30:44.197
> 
> 标签：unit-testing, reflection, powershell

我有一个 .NET 程序集，其中包含数十个作为单元测试方法的类和方法。我想生成一个带有所有标记为属性 Ignore 的方法的报告，你知道一个简单的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T15:33:00.387

您想要获取[自定义属性](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getcustomattributes.aspx)方法

```
Assembly ass = Assembly.Load("yourassembly.dll");
object[] attributes = ass.GetCustomAttributes(typeof(IgnoreAttribute), false)); 
```

此方法也存在于方法对象上，因此您可以遍历程序集中的所有类型并遍历它们的所有方法，并调用相同的方法。

```
foreach(Type type in ass.GetTypes()) {
    foreach(MethodInfo method in type.GetMethods()) {
       method.GetCustomAttributes(typeof(IgnoreAttribute), true));
    }
} 
```

编辑，这里有一些关于 powershell 语法的帮助，虽然我必须说，我不是 powershell 流利的。我相信有人可以比我下面的废话做得更好。

```
$types = [System.Reflection.Assembly]::LoadFile("C:\dll.dll").GetTypes()
$attribute = [System.Type]::GetType("IgnoreAttribute")
foreach ($type in $types) { 
    $methods = $type.GetMethods()
    foreach ($method in $methods) { 
    if ($method .GetCustomAttributes($attribute).Length -gt 0) { 
        $method.Name
    }
} 
```

# iphone - 使用编码加号 (%2B) 创建一个 NSURL

> ID：898488
> 
> 赞同：11
> 
> 时间：2009-05-22T15:30:52.793
> 
> 标签：iphone, url, html-encode

我需要在 GET 请求中传递带有时区偏移量的时间戳，例如，

> 2009-05-04T11:22:00+01:00

这看起来像是接收 PHP 脚本的两个参数“2009-05-04T11:22:00”和“01:00”（我无法控制）。

NSURL 不编码加号，但如果我使用字符串创建 NSURL

> 2009-05-04T11:22:00%2B01:00

我最终得到的网址包含：

> 2009-05-04T11:22:00%252B01:00

有什么想法可以保留我编码的加号或只是简单地阻止 NSURL 编码任何东西？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-02-15T22:00:28.350

对我有用的是进行 UTF8 转换，然后用 %2B 替换 + 符号：

```
NSString *urlString =
    [NSString stringWithFormat:@"%@/iphone/push/create?pn[token]=%@&pn[send_at]=%@",
     kHTTPURL, appDelegate.deviceAPNToken, [dateTimeToUse description]];

urlString =
    [[urlString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]
     stringByReplacingOccurrencesOfString:@"+" withString:@"%2B"]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-18T05:22:20.977

字符串应该是 URL 编码的。

这是 NSString 的一个类别，它会有所帮助：

**NSString+Additions.h**

```
@interface NSString (Additions)

- (NSString *)stringByURLEncoding; 
```

**NSString+Additions.m**

```
#import "NSString+Additions.h"

@implementation NSString (Additions)

- (NSString *)stringByURLEncoding {
    return (__bridge NSString *)CFURLCreateStringByAddingPercentEscapes(NULL,
                                                           (CFStringRef)self,
                                                           NULL,
                                                           (CFStringRef)@"!*'\"();:@&=+$,/?%#[]% ",
                                                           CFStringConvertNSStringEncodingToEncoding(NSUTF8StringEncoding));
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T16:39:41.853

在要作为参数包含的文本上使用`NSString`'方法。`stringByAddingPercentEscapesUsingEncoding:`

顾名思义，该方法将转换返回一个自动发布的字符串，其中包含接收器的 url 安全版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T07:38:23.057

认为我不妨提供我的解决方法作为答案，因为我认为原始问题没有很好的解决方案。

加号 (+) 在 URL 中完全有效，因此我的解决方案是将时间转换为 GMT 并从字符串中删除时区/DST 偏移量。我将把它作为练习留给读者来确定下面*secondsFromGMT*的值，因为在我的情况下，它总是相同的，因为我只对 Web 服务器生成的时间戳感兴趣。

```
NSString *gmtWhen = [[self descriptionWithCalendarFormat:nil
                           timeZone:[NSTimeZone
                           timeZoneForSecondsFromGMT:secondsFromGMT
                     ] locale:nil] stringByReplacingOccurrencesOfString:@" +0000" withString:@""]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-06T01:12:08.143

使用**URLComponents** (Swift 3) 时的解决方案：

```
var params = ["email": "user+ios-default@example.com", "name": "John Brown"]
var components = URLComponents(string: "http://www.example.com")!
components.path = "/login"
components.queryItems = params.map { URLQueryItem(name: $0, value: $1) }

let url_NoFix = components.url!
// http://www.example.com/login?name=John%20Brown&email=user+ios-default@example.com

let cs = CharacterSet(charactersIn: "+").inverted
let q =  components.percentEncodedQuery?.addingPercentEncoding(withAllowedCharacters: cs)
components.percentEncodedQuery = q

let url_Fixed = components.url!
// http://www.example.com/login?name=John%20Brown&email=user%2Bios-default@example.com 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-01T06:56:43.837

使用以下代码对字符串进行编码

NSString *result = (NSString *)CFURLCreateStringByAddingPercentEscapes(NULL, (CFStringRef)self,NULL,(CFStringRef)@"+",kCFStringEncodingUTF8);

这将对你的字符串进行编码，这将防止在 post 方法中发布数据时将 + 替换为 %2b

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-29T10:50:20.920

要获得编码加 (%2B)（它适用于所有字符），请使用`CFURLCreateStringByAddingPercentEscapes` as

```
/**
 get parameterized url from url and query parameters.
 */
+(NSString *)getParameterizedUrl:(NSString *)url withParameters:(NSDictionary *)queryDictionary
{
    NSMutableArray *mutablePairs = [NSMutableArray array];
    for (NSString *key in queryDictionary) {
        [mutablePairs addObject:[NSString stringWithFormat:@"%@=%@", CTPercentEscapedQueryStringKeyFromStringWithEncoding(key, NSUTF8StringEncoding), CTPercentEscapedQueryStringValueFromStringWithEncoding(queryDictionary[key], NSUTF8StringEncoding)]];
    }

    return [[NSString alloc]initWithFormat:@"%@?%@",url,[mutablePairs componentsJoinedByString:@"&"]];
}

static NSString * const kCharactersToBeEscapedInQueryString = @":/?&=;+!@#$()',*";

static NSString * CTPercentEscapedQueryStringKeyFromStringWithEncoding(NSString *string, NSStringEncoding encoding) {
    static NSString * const kCharactersToLeaveUnescapedInQueryStringPairKey = @"[].";

    return (__bridge_transfer  NSString *)CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault, (__bridge CFStringRef)string, (__bridge CFStringRef)kCharactersToLeaveUnescapedInQueryStringPairKey, (__bridge CFStringRef)kCharactersToBeEscapedInQueryString, CFStringConvertNSStringEncodingToEncoding(encoding));
}

static NSString * CTPercentEscapedQueryStringValueFromStringWithEncoding(NSString *string, NSStringEncoding encoding) {
    return (__bridge_transfer  NSString *)CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault, (__bridge CFStringRef)string, NULL, (__bridge CFStringRef)kCharactersToBeEscapedInQueryString, CFStringConvertNSStringEncodingToEncoding(encoding));
} 
```

并在您的代码中使用

```
NSMutableDictionary *params = [[NSMutableDictionary alloc]init];
[params setObject:@"2009-05-04T11:22:00+01:00" forKey:@"timestamp"];

NSString *urlString = [self getParameterizedUrl:@"http://www.example.com" withParameters:params];
NSURL *url = [NSURL URLWithString:[urlString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]]; 
```

# compiler-theory - 哪些编程语言是上下文无关的？

> ID：898489
> 
> 赞同：80
> 
> 时间：2009-05-22T15:31:14.617
> 
> 标签：compiler-theory, context-free-grammar

或者，更准确一点：哪些编程语言是由上下文无关文法定义的？

据我所知，由于宏和模板之类的原因，C++ 不是上下文无关的。我的直觉告诉我，函数式语言可能是上下文无关的，但我没有任何硬数据来支持它。

简洁示例的额外代表:-)

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-07-16T20:18:45.113

> 哪些编程语言是上下文无关的？[...]

> 我的直觉告诉我，函数式语言可能是上下文无关的*[...]*

**简短的版本：**几乎没有任何现实世界的编程语言在任何意义上都是上下文无关的。一种语言是否与上下文无关与它的功能无关。这只是语法复杂程度的问题。

这是*命令式*语言[Brainfuck](https://en.wikipedia.org/wiki/Brainfuck)的 CFG ：

```
Program → Instr Program | ε
Instr → '+' | '-' | '>' | '<' | ',' | '.' | '[' Program ']' 
```

这是*功能性* [SKI 组合器演算](https://en.wikipedia.org/wiki/SKI_combinator_calculus)的 CFG ：

```
Program → E
E → 'S' E E E
E → 'K' E E
E → 'I'
E → '(' E ')' 
```

这些 CFG 识别两种语言的*所有*有效程序，因为它们非常简单。

* * *

**更长的版本：**通常，上下文无关语法 (CFG) 仅用于*粗略*地指定语言的语法。必须区分*语法正确的程序*和正确*编译/评估的程序*。最常见的是，编译器将语言分析分为构建和验证一段代码的一般结构的*语法分析*和验证程序*含义的**语义分析*。

 *如果“上下文无关语言”的意思是“ **……所有程序都为其编译**”，那么答案是：几乎没有。符合这一要求的语言几乎没有任何规则或复杂的特性，例如变量的存在、空格敏感性、类型系统或任何其他*上下文*：在一个地方定义并在另一个地方依赖的信息。

另一方面，如果“上下文无关语言”仅意味着“ **......所有程序都通过了语法分析**”，那么答案就是语法本身的复杂程度。有许多句法特征很难或不可能单独用 CFG 来描述。通过向解析器添加额外的状态来跟踪计数器、查找表等，可以克服其中的一些问题。

无法用 CFG 表达的句法特征示例：

*   缩进和空格敏感的语言，如 Python 和 Haskell。跟踪任意嵌套的缩进级别本质上是上下文相关的，并且需要单独的缩进级别计数器；每个级别使用多少空间以及有多少级别。

    通过为每个缩进级别复制语法来仅允许使用固定数量的空格的固定级别的缩进将起作用，但实际上这很不方便。

*   [C Typedef Parsing Problem](http://calculist.blogspot.dk/2009/02/c-typedef-parsing-problem.html)表示 C 程序在词法分析期间是模棱两可的，因为它无法仅从语法中知道某物是常规标识符还是现有类型的 typedef 别名。

    例子是：

    > ```
    >  typedef int my_int;
    >   my_int x; 
    > ```

    > 在分号处，需要使用 my_int 的条目来更新类型环境。但是，如果词法分析器已经提前查看了 my_int，它会将其作为标识符而不是类型名称进行词法分析。

    在上下文无关的语法术语中，`X → ...`触发的规则`my_int`是模棱两可的：它可能是产生标识符的规则，也可能是产生`typedef`'ed 类型的规则；知道哪个依赖于语法本身之外的查找表（上下文）。

*   基于宏和模板的语言，如 Lisp、C++、Template Haskell、Nim 等。由于语法在解析时会发生变化，因此一种解决方案是将解析器变成一个自修改程序。另请参阅[C++ 是上下文无关的还是上下文敏感的？](https://stackoverflow.com/questions/14589346/is-c-context-free-or-context-sensitive)

*   通常，即使*有可能*，运算符优先级和关联性也不会直接在 CFG 中表达。例如，对于小表达式语法的 CFG，其中 ^ 绑定比 × 更紧密，而 × 绑定比 + 更紧密，可能如下所示：

    ```
     E → E ^ E
      E → E × E
      E → E + E
      E → (E)
      E → num 
    ```

    然而，这个 CFG 是[模棱两可](https://en.wikipedia.org/wiki/Ambiguous_grammar)的，并且通常伴随着一个[优先级/关联性表](https://introcs.cs.princeton.edu/java/11precedence/)，例如 ^ 绑定最紧密，× 绑定比 + 更紧密， ^ 是右关联的，并且 × 和 + 是左关联的。

    优先级和关联性可以以机械方式编码到 CFG 中，这样它是明确的，并且只生成运算符行为正确的语法树。上面语法的一个例子：

    ```
     E₀ → EA E₁
      EA → E₁ + EA
      EA → ε
      E₁ → EM E₂
      EM → E₂ × EM
      EM → ε
      E₂ → E₃ EP
      EP → ^ E₃ EP
      E₃ → num
      E₃ → (E₀) 
    ```

    但是模棱两可的 CFG + 优先级/关联性表很常见，因为它们更具可读性，而且各种类型的[LR 解析器](https://en.wikipedia.org/wiki/LR_parser)生成器库可以通过[消除移位/归约冲突](https://efxa.org/2014/05/17/techniques-for-resolving-common-grammar-conflicts-in-parsers/)而不是处理一个明确的、已转换的更大尺寸的语法来生成更高效的解析器。

理论上，所有有限字符串集都是正则语言，因此所有有界大小的合法程序都是正则的。由于常规语言是上下文无关语言的子集，所有有界大小的程序都是上下文无关的。争论还在继续，

> 虽然可以说，对于一种语言来说，只允许少于一百万行的程序是可以接受的限制，但将编程语言描述为常规语言是不切实际的：描述太大了。
>      — Torben Morgensen 的[《编译器设计基础》，ch。2.10.2](http://www.diku.dk/hjemmesider/ansatte/torbenm/Basics/)

CFG 也是如此。为了解决您的子问题有点不同，

> 哪些编程语言是由上下文无关文法*定义的？*

大多数现实世界的编程语言都是由它们的实现定义的，大多数现实世界的编程语言的解析器要么是手写的，要么使用扩展上下文无关解析的解析器生成器。不幸的是，为您最喜欢的语言找到精确的 CFG 并不常见。当您这样做时，它通常采用[巴科斯-瑙尔形式](https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form)(BNF)，或者很可能不是纯上下文无关的解析器规范。

来自野外的语法规范示例：

*   [标准机器学习的 BNF](http://www.csci.csusb.edu/dick/samples/ml.syntax.html)
*   [类似于 Haskell 的 BNF](https://www.haskell.org/onlinereport/syntax-iso.html)
*   [用于 SQL 的 BNF](https://github.com/ronsavage/SQL)
*   [PHP 的 Yacc 语法](https://github.com/php/php-src/blob/master/Zend/zend_language_parser.y)

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-05-22T15:37:22.427

语法正确的程序集对于几乎所有语言都是无上下文的。

几乎所有语言的编译程序集都不是上下文无关的。例如，如果所有编译 C 程序的集合都是上下文无关的，那么通过与正则语言（也称为正则表达式）相交，匹配的所有编译 C 程序集合

```
^int main\(void\) { int a+; a+ = a+; return 0; }$ 
```

将是上下文无关的，但这显然与语言 a^kba^kba^k 同构，众所周知，它*不是*上下文无关的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-08-02T06:50:53.430

根据您对问题的理解，答案会发生变化。但是 IMNSHO，正确的答案是所有现代编程语言实际上都是上下文敏感的。例如，没有上下文无关文法只接受语法正确的 C 程序。指向 C 的 yacc/bison 上下文无关语法的人没有抓住重点。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-08-18T03:14:29.610

举一个非上下文无关语法的最引人注目的例子，据我所知，Perl 的语法是[图灵完备的](http://perlmonks.org/?node_id=663393)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-25T13:46:31.917

如果我理解您的问题，您正在寻找可以由上下文无关语法 (cfg) 描述的编程语言，以便 cfg 生成所有有效程序并且仅生成有效程序。

我相信大多数（如果不是全部）现代编程语言因此不是上下文无关的。例如，一旦您拥有用户定义的类型（在现代语言中非常常见），您就会自动对上下文敏感。

验证语法和验证程序的语义正确性是有区别的。检查语法是上下文无关的，而检查语义正确性不是（同样，在大多数语言中）。

然而，这并不意味着这种语言不存在。例如，无类型 lambda 演算可以使用上下文无关文法来描述，并且当然是图灵完备的[。](http://en.wikipedia.org/wiki/Lambda_calculus)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-01T14:51:32.890

大多数现代编程语言都不是上下文无关的语言。作为证明，如果我深入研究 CFL 的根，其对应的机器 PDA 无法处理字符串匹配，例如`{ww | w is a string}`. 所以大多数编程语言都需要这个。

例子：

```
int fa; // w
fa=1; // ww as parser treat it like this 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-22T15:46:43.393

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-08T22:13:54.783

让我们以 Swift 为例，用户可以在其中定义运算符，包括运算符优先级和关联性。例如，运算符 + 和 * 实际上是在标准库中定义的。

上下文无关语法和词法分析器可能能够解析 a + b - c * d + e，但语义是“五个操作数 a、b、c、d 和 e，由运算符 +、-、* 和 + 分隔”。这就是解析器在不了解运算符的情况下可以实现的。上下文无关文法和词法分析器也可以解析 a +-+ b -+- c，它是由运算符 +-+ 和 -+- 分隔的三个操作数 a、b 和 c。

解析器可以根据上下文无关的 Swift 语法“解析”源文件，但这还远远不够。另一个步骤是收集有关运算符的知识，然后将 a + b - c * d + e 的语义更改为与 operator+ (operator- (operator+ (a, b), operator* (c, d)) 相同， e)。

所以有（或者也许有，我没有仔细检查过）上下文无关语法，但它只能让你解析一个程序。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-06-22T07:39:11.333

我认为[Haskell](http://www.haskell.org)和[ML](http://smlnj.sourceforge.net/)支持无上下文。请参阅此[链接](http://www.haskell.org/haskellwiki/Embedding_context_free_grammars)以了解 Haskell。

# asp.net - 我可以根据文本的长度动态更改 asp.net 按钮的宽度吗

> ID：898492
> 
> 赞同：0
> 
> 时间：2009-05-22T15:31:28.597
> 
> 标签：asp.net, css

我有多种样式，例如宽度为 50px 的 button_50、宽度为 75px 的 button_75 等等......

有没有办法根据文本的长度动态生成按钮的长度，所以我可能只需要创建一种类似按钮的样式，我可以将它应用于任何按钮，它会根据长度收缩或拉伸的文本。

这是我的 asp.button 声明：

```
<asp:Button ID="btnReset" runat="server" Text="Reset" OnClick="btnReset_Click"/> 
```

这是一些样式，其中我有一个小图像，我希望能够根据文本的长度进行扩展和缩小。

```
.test_button
{
background: url(../images/test/grey-left.png) top right left bottom;
background-repeat:no-repeat;
border-style: none;
font-family: Arial,Helvetica,Sans-Serif;
height: 23px;

} 
```

我将右上角的左下角添加到类中，从而扩展了图像。如何将 4 个不同的图像应用到按钮的每个背景位置，这样我就可以有一种渐变，而不是右上角的左下角的相同按钮。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T17:05:11.573

当我第一次回复时，您的更改已经阐明了您想要的很多东西。

每个元素只能有一个背景图像*。解决方案是拥有多个背景图像是拥有多个 HTML 元素：

```
<span class="fake_button">
  <span>
    <span>
      <input type="submit">
    </span>
  </span>
 </span> 
```

然后在您的 CSS 中将图像添加到每个图像的不同角落。

它既不简单也不漂亮，但它是拥有多个背景图像的唯一方法。

*我认为 Safari 和 Firefox 的一些夜间版本可以做到这一点，但我怀疑这不是被问到的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T15:38:47.310

`<asp:button>`输出`<input type="submit">`（提供或获取一些属性）

在没有其他样式的情况下，像这样的提交按钮应该只是展开以适合其文本。也许你应该看看是什么阻止了这种情况的发生。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T15:47:55.313

只是不要设置宽度。

更新

如评论中所述，该案例使用图像，可能作为背景。

对于动态调整大小的图像按钮，我唯一能想到的是使用单独的图像作为按钮左右两侧的端盖，然后是可以重复或足够大以适应所有尺寸的背景图像。这将限制中心图像如何淡入末端，可能充其量您可以使用从上到下的渐变。

另一种方法是使用 css/javascript 包/方法，例如[SpiffyCorners](http://www.spiffycorners.com/)。

如果您尝试拉伸图像，则会冒像素化的风险，并且您必须使用字体宽度估计值，例如您可以从打印或字体 API 中获得。由于并非所有客户端都具有相同字体的风险，这将非常容易出错。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T15:48:38.090

您可以使用这样的循环在 PageLoad 上执行此操作：

```
// set default length
string cssclass = "button_25";
int text_length = button.Text.Length;
int[] sizes = {50, 75};
for (int x = 0; x < sizes.Length; x++)
{
    if (text_length > sizes[x])
        cssclass = "button_" + sizes[x].ToString();
    else
        break;
}
button.CssClass = cssclass; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T06:12:30.563

您可以通过 CSS 为理解它的浏览器添加圆角功能（加上渐变 bg 图像或其他）并为不理解它的浏览器使用 JS 来保持源代码的清洁。

对于 ff/sf/op 只需使用

```
button{
  background: #ccc (../path/img.gif) left bottom;
  -moz-border-radius: 6px;
  -webkit-border-radius:6px;
  border-radius: 6px;
} 
```

然后对于 IE，包括一段 js 来用 span 包装按钮并通过 css 应用样式。如果您不喜欢手动滚动，那么有很多 jquery 插件可以为您做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-18T21:52:52.493

试试 CSS3PIE。它会让你的生活更轻松......看看我的博客页面：

[Internet Explorer 6-8 没有 CSS 边框半径。如何制作圆角？](http://blog.robertolopes.com/2011/02/18/internet-explorer-6-8-dont-have-css-border-radius-how-to-make-rounded-corners/)

干杯!

罗伯托。

# reporting-services - 为什么在 SSRS 中的报表在预览模式下查看时在打印布局模式下看起来不同？

> ID：898494
> 
> 赞同：1
> 
> 时间：2009-05-22T15:32:15.460
> 
> 标签：reporting-services

我有一个最初在报表生成器中构建的报表，然后导入到 Visual Studio 中以向其中添加一些其他格式。该报告有一个标题和一个正文部分。在正文部分有一个显示佣金的列，佣金是每个销售人员的小计。每个销售人员也有一个分页符。当我预览报表时，每个销售人员的小计都会按原样显示，但是当我在打印布局模式下查看它或将其发送到打印机时，小计出现在下一页的正文部分，即下一位销售人员。为什么它会这样，我该如何解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T18:30:44.490

“报告查看器”的渲染与打印、pdf 导出和其他渲染不同。您必须更改布局以使其适合您所需的渲染目标。在这种情况下打印。

检查您的报告并确保没有任何内容超出打印页边距。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T18:36:02.903

根据我的经验，几乎不可能让打印渲染和报表渲染完全相同。

# iphone - 如何在 iPhone 模拟器中重置 NSUserDefaults 数据？

> ID：898498
> 
> 赞同：54
> 
> 时间：2009-05-22T15:32:32.633
> 
> 标签：iphone, ios, cocoa-touch, uikit, nsuserdefaults

我已经`NSUserDefaults`在我的应用程序中添加了数据检索，这非常好。但是为了测试，我想重置我添加到默认数据库中的所有数据，以便用户第一次启动应用程序时一切都处于状态。

我试着打电话：

```
[NSUserDefaults resetStandardUserDefaults]; 
```

但这无济于事。默认值仍然被保存并且可以被检索。

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-03-12T18:29:08.873

你想要`NSUserDefaults removePersistentDomainForName`。这将删除应用程序的所有用户默认值：

```
NSString *appDomain = [[NSBundle mainBundle] bundleIdentifier];
[[NSUserDefaults standardUserDefaults] removePersistentDomainForName:appDomain]; 
```

有关`NSUserDefaults`该类的更多信息，请参阅[Apple 文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsuserdefaults_Class/Reference/Reference.html)。

或者，如果您只关心 iOS 模拟器中的数据，您可以通过*iOS Simulator > Reset Content and Settings*来完成。

![在此处输入图像描述](https://i.stack.imgur.com/lCusQ.png)

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-05-22T16:02:27.947

最简单的方法是从模拟器中删除应用程序 - 就像您从真实手机中删除它一样，通过点击（单击）并按住直到图标开始振动。这会删除所有应用程序数据，下次从 Xcode 安装时就像第一次一样。

如果您有其他需要保留的应用程序数据，您有几个选择。

一种方法是在每个默认键上都有一些调用 removeObjectForKey: 的调试代码。

另一种是找到安装模拟器副本的目录，并删除包含首选项的文件。使用它来查找应用程序：

```
ls -ld ~/Library/Application\ Support/iPhone\ Simulator/User/Applications/*/*.app 
```

您的应用程序的完整路径将包含名称为 UUID 的目录。在该目录中，在 Library/Preferences 中查找首选项文件。删除它，用户偏好就消失了。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-09T05:25:34.270

您可能会发现您为应用程序“写入”到 userdefaults 的内容都在文件中删除此 .plist 文件有效：

```
user name/Library/Preferences/com.theAppYouAreHandling.plist 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-10-16T12:44:49.023

在 Swift 2.0 中，以下 1 行将重置应用程序的所有 NSUserDefaults：

`NSUserDefaults.standardUserDefaults().removePersistentDomainForName(NSBundle.mainBundle().bundleIdentifier!)`

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-22T22:00:48.037

实际上，这可能并不适用于所有情况，但由于我在模拟器中没有保留任何有价值的信息，所以我只是从模拟器本身的 iPhone 菜单中重置内容和设置。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-10-16T11:48:54.317

直到 Xcode 6 和 iOS 8 Simulator 更改了 plist 文件的位置。

我在以下目录中找到了 *.plist：

[1] /Users/SOME-USERNAME/Library/Developer/CoreSimulator/Devices/SOME-DEVICE-ID/data/Library/Preferences/SP.UserDefaultsTest.plist

手动从路径 [1] 中删除找到的文件，并且 NSUserDefaults 消失了。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-10-03T06:45:31.333

这是快速版本：

```
let domainName = NSBundle.mainBundle().bundleIdentifier!       
NSUserDefaults.standardUserDefaults().removePersistentDomainForName(domainName) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-05-28T17:42:43.863

在模拟器顶部菜单中：

```
Simulator -> Reset Content and Settings... 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-01T11:28:31.577

您可以使用NSUserDefaults 类提供的**removePersistentDomainForName**方法。

句法 ：

```
- (void)removePersistentDomainForName:(NSString *)domainName 
```

例子 ：

```
NSString *strAppBundleId = [[NSBundle mainBundle] bundleIdentifier];
[[NSUserDefaults standardUserDefaults] removePersistentDomainForName:strAppBundleId]; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-07-08T04:53:44.977

如果您在单元测试中执行此操作，您可能希望将应用程序的状态保留在当前模拟器中，而不是在每次运行单元测试时无意中擦除它。一种方法是简单地保留应用程序域的旧值，`setUp()`然后将它们恢复到`tearDown()`：

```
class MyClass_Tests: XCTestCase {
    static let domainName = Bundle.main.bundleIdentifier!
    static var oldUserDefaults: [String : Any]?

    override class func setUp() {
        super.setUp()
        // Hang onto this so we don't inadvertently wipe the app's state while running tests.
        oldUserDefaults = UserDefaults.standard.persistentDomain(forName: domainName)
    }

    override class func tearDown() {
        // Restore the old values.
        UserDefaults.standard.setPersistentDomain(oldUserDefaults!, forName: domainName)
        super.tearDown()
    }

    override func setUp() {
        super.setUp()
        // Wipe the state for each test.
        UserDefaults.standard.removePersistentDomain(forName: MyClass_Tests.domainName)
    }

    override func tearDown() {
        super.tearDown()
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-09-13T14:19:07.780

您可以在以下路径中找到 UserDefaults `Finder`，删除`.plist`

~/Users/ `<USER>`/Library/Developer/CoreSimulator/Devices/ `<DEVICE_ID>`/data/Containers/Data/Application/ `<APP_ID>`/Library/Preferences/<APP_BUNDLE_ID>.plist

要替换的路径组件：

```
1\. <USER> = MAC user name
2\. <DEVICE_ID> = Device/Simulator Identifier, e.g., 999271B8-FAA6-41DE-9864-4111F422ED12
3\. <APP_ID> = Application identifier, e.g., 69928AEF-BCD5-413A-B06F-BC4A07080D62
4\. <APP_BUNDLE_ID> = Your apps bundle identifier, e.g., com.company.appname.plist 
```

# apache - 按地理/国家/地区 IP 重定向 Apache

> ID：898507
> 
> 赞同：3
> 
> 时间：2009-05-22T15:34:53.783
> 
> 标签：apache, mod-rewrite

你们中是否有人通过 IP（在 Apache 内）为来自不同国家/地区访问您网站的人进行重定向？

你们用什么？mod_geoip 和/或一大堆 mod_rewrite 规则？mod_geoip 是否可靠/性能良好/准确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T15:37:49.137

我曾经使用 mod_geoip，但最近为[Cherokee](http://www.cherokee-project.com/)转储了 Apache （它有自己的 GEOIP 逻辑）。

我不能说我有任何性能问题，但 Cherokee 肯定更容易设置。

准确性非常好，但（显然）两者都无法判断是否有人正在通过另一个国家的透明代理进行浏览。

# asp.net-mvc - MVC View - 如何显示对象集合的“类别”，而不仅仅是对象本身

> ID：898511
> 
> 赞同：0
> 
> 时间：2009-05-22T15:35:07.683
> 
> 标签：asp.net-mvc, entity-framework

使用 ASP MVC 和实体框架。在视图中，您有一个页面声明，指定此视图的模型将是一个实现 IEnumerable 的集合。假设集合包含 Car 对象，这些对象仅来自福特（福特是类别）。

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<IEnumerable<detelete.Models.Car>>" %> 
```

此仅福特汽车列表是通过 LINQ to Entities 查询生成的。EF 对象 thingee 知道 Cars 与 Manufacturers 的关系（我称之为类别）

```
 var dat = ent.CarSet.Where(m => m.Manufacturer.Name == nm);

        List<Car> cars = dat.ToList<Car>();
        return View("ListingByManufacturer", cars); 
```

因此，在视图中，我显示了所有福特汽车的列表。我有正确显示所有汽车属性的视图，但没有办法显示**汽车来自**哪个类别（本示例中为制造商） 。我看过一些 EF/MVC 示例，它们有两个 foreach 循环，最上面的一个显示了制造商——但这感觉很糟糕。

似乎应该很简单，但我被卡住了......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T15:40:54.330

您可以通过`ViewData`在控制器中传递制造商名称：

```
ViewData["Manufacturer"] = nm; 
```

或者使用另一个对象作为模型，同时包含汽车和制造商名称

```
public class CategoryViewModel {
     public string ManufacturerName { get; set; }
     public List<Car> Cars { get; set; }
} 
```

并将该类的实例传递给视图。

# .net - Excel 单元格值被 OLEDB-provider 截断

> ID：898513
> 
> 赞同：15
> 
> 时间：2009-05-22T15:35:22.317
> 
> 标签：.net, excel, oledb, oledbconnection

我正在使用 OleDbConnection 类从 Excel 2000/2003 工作簿中检索数据：

```
string connectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" +
                          "Data Source=" + filename + ";" +
                          "Extended Properties=\"Excel 8.0;IMEX=1\";";

OleDbConnection connection = new OleDbConnection(connectionString);
connection.Open();

// code to get table name from schema omitted

var dataAdapter = new OleDbDataAdapter(string.Format("SELECT * FROM [{0}]", name),connection);
var myDataSet = new DataSet();
dataAdapter.Fill(myDataSet, "ExcelInfo"); 
```

现在事实证明，工作表中长度大于 255 个字符的单元格将被截断。这是 Microsoft.Jet.OLEDB 提供程序的限制，还是我可以做些什么？

任何人？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-22T15:47:53.050

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-03T20:01:27.517

试试我通过堆栈溢出发布的这个[OleDBAdapter Excel QA 。](https://stackoverflow.com/questions/3232281/oledb-mixed-excel-datatypes-missing-data/5721521#5721521)

我填充了一个包含 445 个字符的工作表单元格 (Rows[0][4])，它运行良好...将其添加到输出代码的末尾

```
// DataSet:          
Object row0Col3 = ds.Tables["xlsImport"].Rows[0][2];
Object row0Col4 = ds.Tables["xlsImport"].Rows[0][4];

string rowZeroColumn3 = row0Col3.ToString();
string rowZeroColumn4 = row0Col4.ToString();

Console.WriteLine("Row 0, Col 4 string length: {0} " + Environment.NewLine + "Excel content: {1}", rowZeroColumn4.Length, rowZeroColumn4); 
```

# c# - 空格的正则表达式模式

> ID：898519
> 
> 赞同：1
> 
> 时间：2009-05-22T15:36:23.240
> 
> 标签：c#, .net, regex

我正在创建一个正则表达式库来处理 HTML（完成后我会将其发布在 MSDN 代码上）。其中一种方法会删除结束标记之前的所有空格。

```
<p>See the dog run </p> 
```

它将消除最后一段之前的空格。我正在使用这个：

```
 public static string RemoveWhiteSpaceBeforeClosingTag(string text)
    {
        string pattern = @"(\s+)(?:</)";
        return Regex.Replace(text, pattern, "</", Singleline | IgnoreCase);
    } 
```

如您所见，我用 </ 替换空格，因为我似乎无法仅匹配空格并排除结束标记。我知道有办法——我只是还没想出来。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T15:38:33.410

```
\s+(?=</) 
```

是你所追求的那个表达。它表示一个或多个空格字符后跟

*   `(?=...)`是一个[积极的前瞻](http://www.regular-expressions.info/lookaround.html)。这不会包含在表达式中；
*   `(?:...)`是一个[非捕获组](http://www.regular-expressions.info/named.html)。这将包含在表达式中。

话虽如此，正则表达式是处理 HTML 的一种不稳定且容易出错的方式，因此应谨慎使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T15:38:49.183

您想要一个前瞻 (?=) 模式：

```
\s+(?=</) 
```

可以用“”代替

# fluent-nhibernate - Fluent NHibernate HasMany in Component

> ID：898522
> 
> 赞同：1
> 
> 时间：2009-05-22T15:36:45.313
> 
> 标签：fluent-nhibernate, dictionary

下面是一个类模型和一个 Oracle 模式，我想将其映射到使用 Fluent NHibernate。

```
public enum EnumA { Type1, Type2, Type3 };
public class ClassB
{
    public virtual string Property1 { get; set; }
    public virtual string Property2 { get; set; }
}

public class ClassA
{
    public virtual int ID { get; set; }
    public virtual string Name { get; set; }
    public virtual IDictionary<EnumA, IList<ClassB>> MyDictionary { get; set; }
} 
```

TableA (NUMBER(38) ID PK, VARCHAR2(255) 名称)
TableB (NUMBER(38) ID PK FK, NUMBER(38) 类型 PK, VARCHAR(255) Prop1, VARCHAR(255) Prop2)

我应该如何定义 Fluent NHibernate 映射类？
如有必要，我不介意引入一个新的域类。我尝试了以下方法：

```
public class ClassB
{
    public virtual string Property1 { get; set; }
    public virtual string Property2 { get; set; }
}

public class classC
{
    public virtual EnumA EnumA { get; set; }
    IList<ClassB> ClassBList { get; set; }
}

public class ClassA
{
    public virtual int ID { get; set; }
    public virtual string Name { get; set; }
    public virtual IDictionary<EnumA, classC> MyDictionary { get; set; }
} 
```

具有以下映射类

```
 public ClassAMap()
    {
        WithTable("ClassA");
        Id(x => x.ID);
        Map(x => x.Name);

        HasMany(x => x.MyDictionary).AsMap<EnumA>(d => d.EnumA).Component(c =>
        {
            c.HasMany(e => e.ClassBList).Component(f =>
                {
                    f.Map(x => x.Property1);
                    f.Map(x => x.Property1);
                });
        });
    } 
```

但是，这不会生成有效的配置。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T09:05:17.577

B类不是A的组件，它是具有自己标识（ID，Type）的相关实体，因此它在逻辑上不能成为组件，因为组件没有自己的标识（PK），否则它们将是分开的实体。

# eclipse - Eclipse 可以生成方法链设置器吗

> ID：898526
> 
> 赞同：5
> 
> 时间：2009-05-22T15:37:23.487
> 
> 标签：eclipse, eclipse-plugin, method-chaining

我想生成方法链接设置器（返回被设置对象的设置器），如下所示：

```
public MyObject setField (Object value) {
    this.field = value;
    return this;
} 
```

这使得单行实例化变得更容易，我发现它更容易阅读：

```
myMethod (new MyObject ().setField (someValue).setOtherField (someOtherValue)); 
```

可以修改 Eclipse 的模板来执行此操作吗？我已更改要包含的内容，`return this;`但签名未更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T15:53:13.080

我确认 eclipse（最高 3.5RC1）不支持“方法链接”设置器生成。
它只允许注释和正文自定义，而不是 setter 的 API 修改（意味着生成的 setter 仍然返回' `void`'）。

可能是插件[**生成器模式**](http://boss.bekk.no/bpep/)可以在这里提供帮助......（虽然未经测试）

经典方式（不是“傻瓜”，因为它总是会生成一个“ `void`”作为 setter 的返回类型）：（[来源：][[eclipse.org](http://help.eclipse.org/help33/topic/org.eclipse.jdt.doc.user/gettingStarted/images/generate_getter_setter_dialog.png)][）]
[![替代文字](https://i.stack.imgur.com/jarV8.png)](https://i.stack.imgur.com/jarV8.png)

比。新方法（[Builder Pattern](http://java.dzone.com/news/design-pattern-builder-pattern)，可能用作[Eclipse 插件](http://boss.bekk.no/bpep/)）
[替代文本 http://www.javadesign.info/media/blogs/JDesign/DesignConcepts/DesignPatterns/GOF/Creational-BuilderPatternStructure.jpeg](http://www.javadesign.info/media/blogs/JDesign/DesignConcepts/DesignPatterns/GOF/Creational-BuilderPatternStructure.jpeg)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T15:48:30.913

不要自己使用 eclipse，但如果找不到功能，则必须更改其中一个标准模板。

顺便说一下，它被称为**方法链接**（这可能有助于一两次谷歌搜索）。

# java - 使用来自 Hibernate 实体的现有数据填充 envers 修订表

> ID：898529
> 
> 赞同：24
> 
> 时间：2009-05-22T15:38:30.650
> 
> 标签：java, hibernate, hibernate-envers

我正在向现有的休眠实体添加环境。就审计而言，一切工作顺利，但是查询是一个不同的问题，因为修订表没有填充现有数据。有没有其他人已经解决了这个问题？也许您已经找到了用现有表填充修订表的方法？只是想我会问，我相信其他人会发现它很有用。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-12-01T21:08:58.870

我们通过运行一系列原始 SQL 查询来填充初始数据，以模拟“插入”所有现有实体，就好像它们刚刚同时创建一样。例如：

```
insert into REVINFO(REV,REVTSTMP) values (1,1322687394907); 
-- this is the initial revision, with an arbitrary timestamp

insert into item_AUD(REV,REVTYPE,id,col1,col1) select 1,0,id,col1,col2 from item; 
-- this copies the relevant row data from the entity table to the audit table 
```

请注意，**REVTYPE**值为**0**表示插入（与修改相反）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-01-17T13:46:40.053

如果您使用 Envers [ValidityAuditStrategy](http://docs.jboss.org/hibernate/core/4.2/devguide/en-US/html/ch15.html)并且创建的数据不是在启用 Envers 的情况下创建的，那么您将在此类别中遇到问题。

在我们的例子中（Hibernate 4.2.8.Final），一个基本的对象更新抛出“无法更新实体和的先前版本”（记录为 [org.hibernate.AssertionFailure] HHH000099）。

我花了一段时间才找到这个讨论/解释，所以交叉发布：

[没有审计记录的 ValidityAuditStrategy](https://community.jboss.org/thread/160195?tstart=0)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-06-02T10:26:16.190

你不需要。
AuditQuery 允许您通过以下方式获取 RevisionEntity 和数据修订：

```
AuditQuery query = getAuditReader().createQuery()
                .forRevisionsOfEntity(YourAuditedEntity.class, false, false); 
```

这将构造一个返回 Object [3] 列表的查询。第一个元素是您的数据，第二个是修订实体，第三个是修订类型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-23T09:01:51.957

我们已经解决了使用现有数据填充审计日志的问题，如下所示：

```
SessionFactory defaultSessionFactory;

// special configured sessionfactory with envers audit listener + an interceptor 
// which flags all properties as dirty, even if they are not.
SessionFactory replicationSessionFactory;

// Entities must be retrieved with a different session factory, otherwise the 
// auditing tables are not updated. ( this might be because I did something 
// wrong, I don't know, but I know it works if you do it as described above. Feel
// free to improve )

FooDao fooDao = new FooDao();
fooDao.setSessionFactory( defaultSessionFactory );
List<Foo> all = fooDao.findAll();

// cleanup and close connection for fooDao here.
..

// Obtain a session from the replicationSessionFactory here eg.
Session session = replicationSessionFactory.getCurrentSession();

// replicate all data, overwrite data if en entry for that id already exists
// the trick is to let both session factories point to the SAME database.
// By updating the data in the existing db, the audit listener gets triggered,
// and inserts your "initial" data in the audit tables.
for( Foo foo: all ) {
    session.replicate( foo, ReplicationMode.OVERWRITE ); 
} 
```

我的数据源的配置（通过 Spring）：

```
<bean id="replicationDataSource" 
      class="org.apache.commons.dbcp.BasicDataSource" 
      destroy-method="close">
  <property name="driverClassName" value="org.postgresql.Driver"/>
  <property name="url" value=".."/>
  <property name="username" value=".."/>
  <property name="password" value=".."/>
  <aop:scoped-proxy proxy-target-class="true"/>
</bean>

<bean id="auditEventListener" 
      class="org.hibernate.envers.event.AuditEventListener"/>

<bean id="replicationSessionFactory"
      class="o.s.orm.hibernate3.annotation.AnnotationSessionFactoryBean">

  <property name="entityInterceptor">
    <bean class="com.foo.DirtyCheckByPassInterceptor"/>
  </property>

  <property name="dataSource" ref="replicationDataSource"/>
  <property name="packagesToScan">
    <list>
      <value>com.foo.**</value>
    </list>
  </property>

  <property name="hibernateProperties">
    <props>
      ..
      <prop key="org.hibernate.envers.audit_table_prefix">AUDIT_</prop>
      <prop key="org.hibernate.envers.audit_table_suffix"></prop>
    </props>
  </property>
  <property name="eventListeners">
    <map>
      <entry key="post-insert" value-ref="auditEventListener"/>
      <entry key="post-update" value-ref="auditEventListener"/>
      <entry key="post-delete" value-ref="auditEventListener"/>
      <entry key="pre-collection-update" value-ref="auditEventListener"/>
      <entry key="pre-collection-remove" value-ref="auditEventListener"/>
      <entry key="post-collection-recreate" value-ref="auditEventListener"/>
    </map>
  </property>
</bean> 
```

拦截器：

```
import org.hibernate.EmptyInterceptor;
import org.hibernate.type.Type;
..

public class DirtyCheckByPassInterceptor extends EmptyInterceptor {

  public DirtyCheckByPassInterceptor() {
    super();
  }

  /**
   * Flags ALL properties as dirty, even if nothing has changed. 
   */
  @Override
  public int[] findDirty( Object entity,
                      Serializable id,
                      Object[] currentState,
                      Object[] previousState,
                      String[] propertyNames,
                      Type[] types ) {
    int[] result = new int[ propertyNames.length ];
    for ( int i = 0; i < propertyNames.length; i++ ) {
      result[ i ] = i;
    }
    return result;
  }
} 
```

ps：请记住，这是一个简化的示例。它不会开箱即用，但会引导您找到可行的解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-15T08:30:50.740

看看[http://www.jboss.org/files/envers/docs/index.html#revisionlog](http://www.jboss.org/files/envers/docs/index.html#revisionlog)

基本上，您可以使用 @RevisionEntity 注释定义自己的“修订类型”，然后实现一个 RevisionListener 接口来插入您的附加审计数据，如当前用户和高级操作。通常这些是从 ThreadLocal 上下文中提取的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-27T09:21:21.790

您可以使用 find 方法的后备选项扩展`AuditReaderImpl`，例如：

```
 public class AuditReaderWithFallback extends AuditReaderImpl {

    public AuditReaderWithFallback(
            EnversService enversService,
            Session session,
            SessionImplementor sessionImplementor) {
        super(enversService, session, sessionImplementor);
    }

    @Override
    @SuppressWarnings({"unchecked"})
    public <T> T find(
            Class<T> cls,
            String entityName,
            Object primaryKey,
            Number revision,
            boolean includeDeletions) throws IllegalArgumentException, NotAuditedException, IllegalStateException {
        T result = super.find(cls, entityName, primaryKey, revision, includeDeletions);
        if (result == null)
            result = (T) super.getSession().get(entityName, (Serializable) primaryKey);
        return result;
    }
} 
```

`null`在某些情况下，您可以在退货方面添加更多检查。您可能还想使用自己的工厂：

```
 public class AuditReaderFactoryWithFallback {

    /**
     * Create an audit reader associated with an open session.
     *
     * @param session An open session.
     * @return An audit reader associated with the given sesison. It shouldn't be used
     * after the session is closed.
     * @throws AuditException When the given required listeners aren't installed.
     */
    public static AuditReader get(Session session) throws AuditException {
        SessionImplementor sessionImpl;
        if (!(session instanceof SessionImplementor)) {
            sessionImpl = (SessionImplementor) session.getSessionFactory().getCurrentSession();
        } else {
            sessionImpl = (SessionImplementor) session;
        }

        final ServiceRegistry serviceRegistry = sessionImpl.getFactory().getServiceRegistry();
        final EnversService enversService = serviceRegistry.getService(EnversService.class);

        return new AuditReaderWithFallback(enversService, session, sessionImpl);
    }

} 
```

# ruby-on-rails - 使用 Ferret 搜索子模型

> ID：898540
> 
> 赞同：0
> 
> 时间：2009-05-22T15:40:20.460
> 
> 标签：ruby-on-rails, full-text-search

我有一个 Rails 应用程序，我正在尝试在其中进行一些全文搜索。雪貂似乎是最受欢迎的选择。但是，我有一个问题。

我有一个“东西”，它包含一个 id，它确定用户是否可以看到它（并因此搜索它），但我想搜索这个“东西”的子模型，这些子模型与我的“东西”相关但不直接包含返回给用户的任何引用。

因此，我该如何实施呢？有没有一种聪明的方法来实现这一点，或者我是否需要通过指向域标识符的链接来弄脏我的模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T16:56:33.860

我认为假设雪貂是最受欢迎的选择是非常错误的。我认识的大多数人都抛弃了雪貂并用狮身人面像取而代之。而那些由于某种原因不能使用 Sphinx 的人选择了 Xapian。

也就是说，无论您选择哪种索引系统，您的问题的答案可能基本相同：

当您处理权限和索引时，您无法有效地索引与权限系统相关的任何内容，因为它将是特定于用户的。您所有的权限内容都需要存在于您的模型/控制器中的某个地方。我喜欢将我所有的权限内容放在一个模块中，然后将其包含在我的模型中，以便我可以轻松地在模型之间共享它。

分页对于这种事情来说真的很痛苦，因为您从搜索引擎请求 10 个项目，然后您的权限代码拒绝其中 5 个项目，这意味着您必须继续运行搜索，直到您显示前 10 个项目。现在，当您想要第二页时，那么事情就会变得一团糟。天堂禁止他们决定直接跳到第 10 页，因为现在您无法使用诸如给出起始 ID 而不是页码之类的技巧。真的，如果你能帮忙的话，这根本不是你想做的事情。

确实没有“聪明”的方法来解决权限和全文索引之间的不匹配问题。至少，我不知道。这只是一种痛苦。

当我们刚开始时，我向我的老板建议，唯一明智的解决方案是平等的权限系统：如果我们给你一个用户名和密码，那么你就可以访问。他不是粉丝。

# c# - Linq to SQL DataContext 生命周期管理问题

> ID：898546
> 
> 赞同：3
> 
> 时间：2009-05-22T15:42:32.053
> 
> 标签：c#, linq, linq-to-sql

我阅读了 Rick Strahl关于处理数据上下文的方法的[文章。](http://www.west-wind.com/weblog/posts/246222.aspx)我的 DBML 在类库中，我通过在库中的单独自定义部分类中创建静态 Current 方法来保持数据上下文打开。

```
public partial class DataContext
{
    public static DataContext Current
    {
        get
        {
            DataContext dc = HttpContext.Current.Items["dc"] as DataContext;
            if (dc == null)
            {
                dc = new ImmediacyPageDataContext();
                HttpContext.Current.Items["dc"] = dc;
            }

            return dc;
        }
    } 
```

然后像这样访问它

```
DataContext dc = DataContext.Current; 
```

但是，每当我更新我的 DBML 文件时，这都会导致问题。每当我尝试构建项目时编辑 DBML 文件后，我的设计器文件不会重新生成/被删除。如果我尝试运行自定义工具选项，它会返回错误。

我可以解决这个问题的唯一方法是重命名或删除自定义部分类，重新生成设计器文件，然后将我的自定义部分类添加回解决方案。这是一个确实有效的工作，但是..它有点痛苦。

有没有更好的方法可以使编辑我的 DBML 文件更容易，同时尽可能延长我的 DC？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T13:57:19.723

使用您的部分 DataContext 类进入代码文件，并将您的 using 语句移动到您的命名空间中。出于某种原因，除非是这种情况，否则该工具不会生成设计器。

```
namespace MyNamespace
{
    using System;
    using System.Data.Linq;
    using System.Data.Linq.Mapping;
    using System.Reflection;
    using System.Xml.Linq;

    partial class DataContext
    {
    }
} 
```

我相信从 VS2008 迁移到 VS2008 SP1 时需要进行此更改，尽管我可能会混淆某些版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T16:14:50.380

您应该在不同的文件中创建分部类，而不是 .designer.cs 文件。最简单的方法是在解决方案资源管理器（或 DBML 设计器的空白区域）中右键单击您的 DBML，然后单击“查看代码”。这将创建一个新的 .cs 文件，当您保存 DBML 时该文件不会被覆盖。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T16:16:16.480

我不相信您的 DataContext 持久性和 DBML 问题相关。听起来 IDE 与 Cached DataContext 的冲突很混淆（HttpContext.Current.Items 是每个请求，所以无论如何都没有长期缓存）。

当我的数据模型包含与另一个类冲突的类名时，我遇到了 DBML 编译问题。例如，名为“Application”（保险应用程序）的 DBML 对象可能与 HttpApplicationState.Page.Application 冲突。

检查您的错误消息，看看它是否特定于您的 DBML 中的名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-04T20:52:37.623

我想不出一个过于令人信服的理由，为什么您的新静态属性必须是 DataContext 类的一部分。将它放在不同的班级中同样容易。

# javascript - IE中的ajax隐藏div问题

> ID：898551
> 
> 赞同：1
> 
> 时间：2009-05-22T15:43:56.263
> 
> 标签：javascript, ajax

我有一个检查电子邮件和用户名的 javascript 页面，这在除 Internet Explorer 之外的所有浏览器中都可以正常工作。显示错误的 div 框应该被隐藏，除非给出错误，例如使用用户名或无效电子邮件。

如果电子邮件收到错误，则会显示在 div 标签中，但不适用于用户名（在所有浏览器中）

下面是我的代码：

```
<script type="text/javascript">
     var usernameok;
    var emailok;

    function checksubmit()
    {
      if (usernameok && emailok) {
        document.getElementById("button").disabled = false;
      } else {
        document.getElementById("button").disabled = true;
      }
    }

    function username(username)
    {
               make_request();

      function stateck()
      {
        if (httpxml.readyState == 4) { 
          if (httpxml.responseText.indexOf("Username Ok") >= 0) {
                            usernameok = true;
          } else {
                          usernameok = false;
          }
          checkCanSubmit();           
        }
      }

      httpxml.onreadystatechange = stateck;
      user_url = "check_username.php?username=" + username.value;
      httpxml.open("GET", user_url, true);
      httpxml.send(null);
    }

    function email(email)
    {

      make_request();

      function stateck()
      {
        if (httpxml.readyState == 4) {
          if (httpxml.responseText.indexOf("Email Ok") >= 0) {
                          emailok = true;
          } else {
                          emailok = false;
          }
          checkCanSubmit();           
        }
      }

      httpxml.onreadystatechange = stateck;
      email_url = "check_email.php?email=" + email.value;
      httpxml.open("GET", email_url, true);
      httpxml.send(null);
    }
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T15:55:52.113

我看到你的函数 stateck() 是 HTTP 请求的返回函数。但是，您是在另一个函数中定义它。不是作为匿名函数，而是作为另一个函数中的函数。

我知道你现在在做什么......好吧，试试这个：

```
httpxml.onreadystatechange = function()
{
  if (httpxml.readyState == 4) {
    if (httpxml.responseText.indexOf("Email Ok") >= 0) {
      document.getElementById("email").style.backgroundColor = "green";
      document.getElementById("email").style.color = "white";
      document.getElementById("email_div").style.display = 'none';
      emailok = true;
    } else {
      document.getElementById("email").style.backgroundColor = "red";
      document.getElementById("email_div").innerHTML=httpxml.responseText;
      emailok = false;
    }
    checkCanSubmit();           
  }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T16:15:19.990

您是否需要将初始状态设置为显示：无？我认为 IE 可能会以非 0 的高度初始化 div，而 div 在其他浏览器中可能在技术上可见但太短而无法看到。

编辑：

好的，我想我误解了你的问题。您的问题不在于隐藏 div，而是显示用户名错误。

没有什么明显的跳出我。尝试使用 VS 或 VWDE 单步执行代码： [http ://www.berniecode.com/blog/2007/03/08/how-to-debug-javascript-with-visual-web-developer-express/](http://www.berniecode.com/blog/2007/03/08/how-to-debug-javascript-with-visual-web-developer-express/)

# sql-server - SQL Server 2008 作为 xml 文档数据库

> ID：898552
> 
> 赞同：2
> 
> 时间：2009-05-22T15:44:07.963
> 
> 标签：sql-server, xml

有没有人使用 SQL Server 2008 作为 xml 文档数据库？你对这样做有什么想法。XML 数据类型的索引和查询是否足以支持这种类型的角色？XML 的查询性能是否可以接受？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T15:50:42.267

我不知道您的具体要求是什么，以及我们在这里谈论的文件数量和大小。

SQL Server 2005 确实允许您指定 XML 模式，因此您肯定可以对等式进行一些验证，这肯定是有益的。

至于 XML 索引 - 一旦您创建了基本的主要 XML 索引，您就可以对三种不同的策略进行索引。

*   当您对节点执行大量基于 XPath 的查询时，第一种索引类型更用于将 XPath 优化为单个 XML 节点 ( `CREATE XML INDEX ..... FOR PATH`)
*   第二种索引类型更多地用于优化对 XML 节点内的值的访问，当您更多地基于 XML 文档中的值进行搜索时 ( `CREATE XML INDEX ..... FOR VALUE`)
*   第三个是上述两者的混合体（老实说，我从来没有完全摸过自己；`CREATE XML INDEX ..... FOR PROPERTY`）

XML 索引在我们的示例中运行良好，但在我们的示例中，主要缺点是磁盘上索引的绝对大小。仅通过将 PRIMARY XML 和 XML FOR PATH 索引添加到大约 45,000 个带有 XML 字段的条目，我们的 1.3 GB 数据库就增长到超过 11 GB。由于磁盘限制，我们最终不得不删除这些索引:-(

考虑到如何使用每个 XML 节点、属性等的条目来构建 XML 索引，这真的并不令人惊讶——它只是大量的数据。

我们最终所做的是创建了许多存储函数，这些函数从我们的`Entry`表中访问 XML，并且我们提取了我们最经常需要的那些点点滴滴。这些现在`Entry`作为计算的持久属性存储在表中。这与表上的“正确”字段一样快`Entry`，它始终是最新的，并在插入新数据时自动设置，我们几乎不再需要真正使用任何重要的 XQuery 请求。

根据我的个人经验，我认为 SQL Server 2005 中的 XML 支持确实非常深刻且经过深思熟虑，在我看来。所以总而言之，我会说 - 去试试吧！在您尝试之前，您将无法真正判断它是否在您的特定情况下工作和扩展得足够好。

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T18:57:50.073

我还没有尝试过，但 XML 对我来说似乎有点过于冗长。我想我以后可以从我的数据中生成 xml，为什么还要担心将它存储在 XML 中。

# migration - 从企业迁移到万维网

> ID：898555
> 
> 赞同：1
> 
> 时间：2009-05-22T15:45:04.690
> 
> 标签：migration

我将把我的工作领域从为具体业务流程编写的企业 Web 应用程序转变为可供周围所有用户访问的公共网站。

这两个领域在最顶层有什么区别？关于现代网站开发，我需要了解哪些具体特征？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T15:59:44.953

我怀疑有人可以写这方面的书。

我想第一个区别是用户群。对于企业，您至少可以部分确保用户正在做他们应该做的事情——如果没有，您知道他们是谁以及他们住在哪里。此外，他们可能会因滥用职权而被解雇。在公共网站上，您几乎必须假设您的用户群的某些部分出于积极的原因而没有出现。所以要多疑——如果他们还没有攻击你，那就等着吧。

第二个相关点是用户会找到使用（滥用？）您从未想过的网站的方法。做最坏的打算，希望更好。

第三，世界各地的语言、文化和用法各不相同。例如，带有仅接受 5 位数字的“邮政编码”的表格在美国可能有意义，但在英国则无用。在意大利说意大利是“国家”时，要求一个国家并将其限制为两个字符同样没有意义。这也适用于实际内容——你认为非常有趣的笑话在其他国家可能会令人反感。永远不要低估某些人对任何事情的冒犯能力。

第四 - 获得大量的 beta 测试人员并仔细彻底地测试您的网站和更新。

菲斯，有一个可扩展性的计划——如果你突然被“发现”，你的网站可以占用流量。

至少有5件事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T15:52:26.373

在企业应用程序中，功能和效率每次都胜过美学。这是因为你有一个俘虏观众。使用您的应用程序的人正在付费使用它。

然而，当向公众开放应用程序时，美学变得更加重要。总是有替代方案，一个特定的人会更喜欢看起来更好的应用程序。诚然，功能对于重复用户来说仍然*非常*重要，但是如果您的应用程序看起来很业余，您将不会让人们进门。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T16:00:47.743

浏览器不可知论——在企业应用程序中，过去开发人员会将应用程序定位到特定浏览器，只是为了简单起见。在互联网可访问的应用程序中，开发人员必须针对绝大多数浏览器。虽然这在过去几年里变得更容易了，但它仍然是一个需要关注的问题。

可扩展性 - 更容易扩展企业应用程序，更容易预测应用程序的使用增长，或者简单地为组织中的所有用户一次访问而设计。互联网站点通常不是这种情况。你被点划线的那一天，或 dugg 就是你学会这一点的那一天。最好从一开始就设计可扩展性，而不是在您的网站开始受到影响时学习它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T16:02:54.220

除了 Zack 的回答之外，我想说一个向公众开放的网站/应用程序需要不断发展/更新，以扩大您的用户群并留住他们。而在更封闭的系统上，一致性和可靠性是关键优先事项。

根据应用程序的性质，如果它有大量的内容，国际化和内容的呈现是非常重要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T15:56:29.650

正如 Zack 所提到的，与企业客户相比，公共用户对糟糕的 UI 的容忍度要低得多。也就是说，公共用户更能容忍增量变化；您可以随心所欲地升级实时站点（当然，只要它可以工作！！），而无需经过无休止的功能请求优先级委员会和用户培训要求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T18:01:15.257

公共网站需要***易于使用***。虽然重要的是它们看起来有点抛光，但不要让抛光妨碍易用性。例如，许多设计师喜欢固定宽度布局，因为它们更容易预测，许多用户喜欢流动宽度布局，因为他们更有效地利用空间。 **站在你的用户一边。**

企业用户可能被迫处理不必要的复杂系统（天知道我比我想要的要多），普通大众则不能。

# visual-studio - 错误“在 Visual Studio 中找不到元数据文件 '...\Release\project.dll'”

> ID：898559
> 
> 赞同：137
> 
> 时间：2009-05-22T15:45:25.813
> 
> 标签：visual-studio, debugging, release, resolveassemblyreference

最近我开始随机收到这条消息：

> 在 Visual Studio 中找不到元数据文件“...\Release\project.dll”

我有一个包含多个项目的解决方案。当前的构建模式是 Debug，所有项目的配置都设置为 Debug。但是当我尝试运行主项目时 - 有时它会给我一些错误，所有这些都是“找不到元数据文件'...\Release\projectX.dll'” - 而且，看，它说的是关于 RELEASE文件夹，虽然当前模式是调试。为什么？我尝试在所有解决方案文件中搜索对“Release\projectX.dll”的引用，并在 ResolveAssemblyReference.cache 文件中找到了一个。

我在互联网上进行了很好的搜索，发现有几个人有类似的问题，但没有解决方案，或者至少没有有效的解决方案。

我试图删除对这些项目的引用并阅读它们，但一段时间后我又开始遇到这些错误。

这似乎是一个错误。为什么我总是使用调试模式时它会在 Release 文件夹中搜索引用的项目？

**PS。**对于那些遇到这个问题的人：我无法以简单的方式解决它。只有在我重新安装 Windows 后它才消失 :(

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2012-10-23T13:44:49.717

每个人都是正确的......尝试一切......（为了浪费一点到很多时间）

1.  你有坏代码吗？先解决这个问题。
2.  清理解决方案并重新启动 Visual Studio
3.  删除/添加参考
4.  检查带有较大项目的构建顺序并验证
5.  手动重建子项目
6.  手动将项目之间的 dll 复制到关联的 bin 文件夹中
7.  去喝杯咖啡，打弹球，明天再回来……你可能会想到别的事情。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-01-05T10:50:28.247

我有同样的问题。包含 50 多个项目的大型视觉工作室解决方案。

所有引用都作为项目添加。项目构建顺序正确（右键单击项目并选择构建顺序）。

然而，在构建一些更高级别的项目时，他们所依赖的“根”项目并未构建。

问题是这些项目没有选择在当前配置下构建（不知道这是怎么发生的）。

要检查这一点，请选择“配置管理器”（构建菜单）并检查有问题的项目是否设置为构建。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-06-10T17:03:06.107

当您说您删除了对这些项目的引用并重新添加它们时，您是如何重新添加它们的？您是否在 Visual Studio 的“添加引用”对话框中使用了“浏览”选项卡？或者，您是否使用了“项目”选项卡（其中列出了解决方案中的相邻项目）？

**编辑**：如果您使用“浏览”选项卡，并手动添加对位于 /Release 文件夹中的 .dll 的引用，那么无论您使用哪种模式，Visual Studio 都将始终在该位置查找 .dll目前在（调试或发布）。

如果您从 Release 文件夹中删除了实际的 .dll 文件（手动或通过执行“清理解决方案”），那么您的引用将中断，因为 .dll 不存在。

我建议删除对 ProjectX.dll 的引用，然后再次添加它——但这一次，使用“添加引用”对话框中的“项目”选项卡。以这种方式添加引用时，Visual Studio 知道从何处获取适当的 .dll。如果您处于调试模式，它将从 /Debug 文件夹中获取。如果处于发布模式，则为 /Release 文件夹。您的构建错误应该会消失，并且您也将不再（不正确地）在调试模式下引用 Release .dll。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-06-27T15:13:55.043

*好吧，我的回答不仅仅是对所有解决方案的总结，而且提供的还不止这些。*

**第 (1) 节：**

**一般解决方案：**

我有 4 个此类错误（“找不到元数据文件”）以及 1 个错误说“无法打开源文件（'未指定错误'）”。

我试图摆脱“找不到元数据文件”错误。为此，我阅读了许多帖子、博客等，发现这些解决方案可能是有效的（在这里总结它们）：

1.  重新启动 VS 并再次尝试构建。

2.  转到**“解决方案资源管理器”**。右键单击解决方案。转到**属性**。转到**“配置管理器”**。检查是否选中了**“构建”**下的复选框。如果其中任何一个或全部未选中，则检查它们并再次尝试构建。

3.  如果上述解决方案不起作用，则按照上面步骤 2 中提到的顺序，即使所有复选框都已选中，也不要选中它们，再次选中并尝试再次构建。

4.  **构建顺序和项目依赖关系：**

    转到**“解决方案资源管理器”**。右键单击解决方案。转到**“项目依赖项...”**。您将看到 2 个选项卡：**“依赖项”**和**“构建顺序”**。此构建顺序是构建解决方案的顺序。检查项目依赖项和构建顺序以验证是否某个依赖于其他项目（例如“project2”）的项目（例如“project1”）正在尝试在该项目（project2）之前构建。这可能是错误的原因。

5.  **检查丢失的 .dll 的路径：**

    检查丢失的 .dll 的路径。如果路径包含空格或任何其他无效路径字符，请将其删除并再次尝试构建。

    如果这是原因，则调整构建顺序。

    * * *

**第 (2) 节：**

**我的特殊情况：**

我用各种排列和组合尝试了上述所有步骤，并重新启动了几次 VS。但是，它对我没有帮助。

所以，我决定摆脱我遇到的其他错误（'源文件无法打开（'未指定的错误'）'）。

我遇到了一个博客： [http ://www.anujvarma.com/tfs-errorsource-file-could-not-be-opened-unspecified-error/#comment-1539](http://www.anujvarma.com/tfs-errorsource-file-could-not-be-opened-unspecified-error/#comment-1539)

我尝试了该博客中提到的步骤，我摆脱了错误**“无法打开源文件（'未指定错误'）”**，令人惊讶的是，我也摆脱了其他错误**（“找不到元数据文件”）**。

* * *

**第 (3) 节：**

**故事的道德启示：**

尝试上面第 (1) 节中提到的所有解决方案（以及任何其他解决方案）以消除错误。如果没有任何结果，根据上面第 (2) 节中提到的博客，***从您的 .csproj 文件中删除所有不再存在于源代码控制和文件系统中的源文件的条目***。

* * *

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-06-13T19:58:17.193

我以前遇到过这个问题，我发现解决它的唯一方法是运行 Clean Solution，然后重新启动 Visual Studio。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-06-01T13:40:26.153

对我来说，通常是目标框架关闭（4.5.2 而不是 4.6）如果您修复项目的目标框架以匹配解决方案的目标框架并构建，则会创建一个新的 .dll。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-09-24T14:55:42.743

以管理员身份重新打开 Visual Studio。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-10T16:07:23.207

您是否检查了配置管理器设置？在项目设置对话框右上角。

有时，在所有发布条目之间会出现一个调试条目。如果是这样，解决方案的依赖关系图创建的自动依赖关系就会变得混乱。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-07-04T18:55:14.797

大多数答案都说您需要删除解决方案的库，这是真的，但是当您重新添加库时，将再次显示错误。**您需要验证所有引用的库是否具有与您的解决方案的 .net 框架兼容的 .net 框架。**然后修复代码中的所有错误并重建解决方案。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-01-19T14:16:43.967

就我而言，这是由两件事引起的（VS.2012）：

1) 其中一个项目配置为 AnyCPU 而不是 x86

2）被引用的项目以某种方式未选中“构建”复选框。

请检查您的构建 | 配置管理器以概览正在构建的内容以及针对哪个平台。还要确保检查它的调试和发布，因为它们可能有不同的设置。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-01-05T00:46:44.587

就我而言，我的代码中有一些错误。Visual Studio 显示的是您遇到的错误，而不是实际的错误，例如语法错误或未知的类名。尝试在项目后清理解决方案并构建项目。这样你就会发现实际的错误。

同样，这正是导致*我*出错的原因。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-10-27T17:20:14.197

我们最近在从 Office 2007 升级到 Office 2010 后遇到了这个问题 - 我们不得不手动将项目中的引用更改为我们在某些项目中使用的 Office Interops 版本 14。

希望对您有所帮助-我们花了几天时间才弄清楚。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-06-12T14:28:49.007

我们经常遇到这个问题，但仅限于从 C# 项目中引用 C++/CLI 项目。这显然是微软决定不修复的 Visual Studio 深处的一个错误，因为它“太复杂”并且他们承诺对现在针对 Visual Studio 2010 的 C++ 构建系统进行大修。

那是前一段时间的事了，也许这个修复程序甚至进入了 Visual Studio 2008；我没有再跟进了。但是，我们典型的解决方法是

*   交换机配置
*   重新启动 Visual Studio
*   构建解决方案

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-11-12T02:52:41.830

我还在我有多个项目的解决方案中看到了这个错误（通常是 netTiers 项目，我已经更新了一个或多个子项目以针对 4.0 框架）。删除可能会有问题。但是，通常可以通过首先修复子项目中的所有其他错误（例如，任何缺少的引用），单独重建这些子项目，然后在 Visual Studio 中删除/添加对这些子项目的任何引用来解决它。就个人而言，我很难通过单独清理解决方案来解决这个错误。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2010-11-05T09:08:52.463

此问题是由 pdb 文件或 CodeContracts 引起的。

要解决它：

1.  清理您的输出文件夹并重建解决方案。

2.  重新配置 CodeContracts 或将其禁用以进行临时构建。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-07-09T10:31:40.987

我自己也有同样的问题。

Visual Studio 2013 只告诉我它无法引用它，也找不到元数据。当我打开我的解决方案（其中有多个项目）时，它说我使用的项目低于我的一个项目的框架版本。

所以我把所有东西都切换到了 4.5 版，它又能正常工作了。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2016-06-07T17:27:57.263

我遇到了这个问题，花了很长时间才弄清楚。当我从解决方案中删除项目并用 nuget 包替换这些项目时，问题出现了。

解决方案似乎很好，但 .csproj 文件仍然多次包含这些项目作为参考。

似乎 VS 没有适当地清理该文件。它仍在后台引用已删除的项目。当手动从 csproj 文件中删除引用时，一切都会再次起作用！呜呼

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2011-12-06T20:34:38.443

有时 VS2010 会将我的配置从任何 CPU 切换到混合平台。发生这种情况时，我会收到此错误消息。

为了解决它，我切换回任何 CPU：
1\. 右键单击​​解决方案并选择属性。
2\. 单击配置属性，然后单击配置管理器...按钮。
3\. 在活动解决方案平台下选择任何 CPU

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-08-16T21:07:59.467

我遇到了这个问题，这是由于违规库（dll）中的无效方法没有返回值，例如

```
public bool DoSomething()
{
   //I never bothered putting code here....

} 
```

当我注释掉所有编译的内容时:)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-05-22T16:11:46.357

我似乎记得几个月前遇到过类似的问题。我通过将引用的 DLL 复制到 Release 文件夹临时解决了这个问题，从而满足了 Visual Studio 的期望。后来，我在我的实际代码中发现了对 Release DLL 的引用。您应该尝试在整个项目中搜索 \release\project.dll。

另外，我注意到 Visual Studio 单元测试项目有时会在指向目标 DLL 的每个测试方法上放置一个“DeploymentItem”属性，如果在 Debug 和 Release 之间切换，如果 DLL 不再存在，Visual Studio 可能会感到困惑在预期的位置。根据我的经验，如果您自己没有将这些属性作为“单一部署”方案的一部分放置在那里，则可以安全地删除它们。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2013-10-04T07:16:26.830

我最终删除了我的引用（我已经使用项目选项卡正确添加了它们，并且它们过去构建得很好），手动编辑我的 .csproj 文件并删除不属于的奇怪条目 - 并将我的输出设置为调试和发布，x86 和 x64 以及任何 cpu 都为“\bin”——我构建了一次，然后重新添加了引用（再次，使用项目选项卡），一切都重新开始为我工作。根本不必重新启动 Visual Studio。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2014-02-19T13:21:44.860

对我来说，这是由于 Build 目标被重写为不输出 dll 造成的。删除它以回退到默认的构建目标解决了这个问题。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2012-08-27T10:11:32.767

我发现当我在一个类实现的接口中仍然有一个方法声明时，我通常会发生这种情况，但是我后来将其删除并且忘记将其从接口中删除。我通常每 30 分钟保存一次整个解决方案，然后如果找不到错误，只需恢复到早期版本。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2017-11-07T13:06:32.990

对我来说是删除/删除整个 .vs 文件夹（这是一个不可见的文件夹），然后：

```
- Build
- Rebuild 
```

并做了。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2019-02-26T12:13:07.053

就我而言，我正在研究master的一个分支。所以我检查了主分支，运行了一个构建，然后检查了我的分支。它解决了这个问题。如果您已经在 master 上，我建议您检查以前的提交，然后构建它。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-05-31T08:37:42.500

我有同样的问题。手动删除和添加 dll 没有帮助。ClassLibraries 没有为所有项目编译，并且在项目的**...\bin\Debug**文件夹中丢失[因为我错误地清理了解决方案]。**由于类库没有编译，这意味着这些子项目之一的某处可能存在一些错误**。

**解决方案：**由于我的 dll 用于**...\bin\Release**文件夹，因此我尝试在 Release 模式下重建，并在其中一个子项目的一行中发现错误。解决错误并重建解决方案摆脱了构建错误。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2014-05-15T11:36:53.250

您是否在项目中使用 SQLMETAL 等数据库代码生成工具？

如果是这样，您可能会面临多元化到非多元化的过渡问题。

在我的例子中，我注意到一些旧的复数 (*) 表名（SQLMETAL 默认在其末尾添加一个“ **s** ”字母）对 SQLMETAL 生成的类的表引用。

因为，我最近禁用**了名称的多元化**，在重新调整了一些与数据库相关的类之后，其中一些失去了它们的“ **s** ”前缀。因此，对受影响的表类的所有引用都变得无效。出于这个原因，我有几个编译错误，如下所示：

> “xxxx”不包含“TableNames”的定义，并且找不到接受“yyyy”类型的第一个参数的扩展方法“TableNames”（您是否缺少 using 指令或程序集引用？）

如您所知，我只接受错误以防止程序集编译。那就是缺少的程序集可链接到依赖程序集，导致原始“找不到元数据文件'XYZ'”

在手动修复受影响的类表引用到它们的当前名称（未复数）之后，我终于能够让我的项目恢复活力！

(*) 如果选项 Visual Studio > **Tools menu** > **Options** > **Database Tools** > **O/R Designer** > Pluralization **of names**被启用，一些 SQLMETALl 代码生成器会在一些生成的表类的末尾添加一个“ **s** ”字母，尽管表有目标数据库上没有“s”后缀。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/bb386987(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/bb386987%28v=vs.110%29.aspx)

这篇文章有很多很好的建议。刚刚又加了一个。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2013-06-20T17:44:01.513

对我来说，Visual Studio 创建了一个“Visual Studio 解决方案用户选项”类型的 projectname.v11。我删除了这个文件并重新启动，一切都很好。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2014-06-25T14:11:13.540

就我而言，在合并期间，解决方案文件似乎缺少一些项目引用。手动将项目重新添加到解决方案中修复了它。您也可以手动编辑解决方案文件，但您需要小心并知道自己在做什么。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2011-11-25T06:56:16.213

正如 Vidar 所描述的那样，今天我也发生了同样的事情。

我在 Helper Library 中有一个 Build 错误（由其他项目引用），编译器没有告诉我 Helper Library 中有错误，而是提供了 MetaFile-not-found 类型错误列表。更正 Helper Library 中的 Build 错误后，MetaFile 错误消失了。

VS中是否有任何设置可以改善这一点？

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2014-05-06T12:09:48.247

我今天也遇到了这个问题。我的是由**循环依赖**引起的。项目 A 引用了项目 B，反之亦然。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2011-09-02T19:18:42.437

当您签出具有多个项目的解决方案时似乎会发生这种情况，这些项目之间有引用，而您之前没有构建过它。如果您直接引用了 dll，而不是引用项目，您将收到此消息。您应该始终使用“添加引用”对话框中的“项目”选项卡来添加对同一解决方案中项目的引用。这样，VS 可以知道构建解决方案的正确顺序

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2012-05-02T07:30:00.617

今天遇到了同样的问题。

我的应用程序，一个 Windows 窗体应用程序，意外地引用了它自己。诡异的。

删除后，错误消失了。

每次我将位于 Windows 窗体项目本身的用户控件拖动到窗体时，都会添加该引用。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2013-10-15T11:56:14.803

我有同样的问题，这个问题背后的原因是参考项目的 dll 文件正在被其他进程使用。就我而言，我正在调试一个应用程序，并且应用程序与 Visual Studio 调试器相连。当我重新构建另一个使用相同项目的应用程序时，我收到了这个错误。卸载后，我能够成功构建第二个应用程序。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2013-11-11T20:18:58.187

此问题已得到解决。我打开包管理器设置并单击“允许 NuGet 下载丢失的包”。该项目现在构建。

[https://github.com/gitextensions/gitextensions/issues/1969](https://github.com/gitextensions/gitextensions/issues/1969)

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2012-03-29T08:27:28.183

我有同样的问题。我注意到由于某种原因无法识别位于项目 dll 中的数据库上下文 (EF4)。我删除了它并创建了另一个。这为我解决了这个问题。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2015-05-27T15:37:03.757

我在尝试添加项目引用时遇到了这个问题，经过大量搜索和尝试上述许多事情后，我的构建配置和输出是正确的。

我终于从源和引用项目中删除了**\bin**和**\obj文件夹。**

老实说，我相信是`obj`文件夹不包含正确的元数据或损坏的元数据。

现在一切都解决了。

这是 Visual Studio 2015 - .NET 4.6 项目。

**更新：**

以上在第一次构建时有效，但在后续构建中失败了，所以我最终重新创建了解决方案文件，并删除并读取了我的项目文件中错误引用的 NuGet 包，这些包指向了不正确的**提示路径**。

到目前为止，这似乎已经在后续构建中修复了它。

### .csproj 文件中的示例参考

```
<ItemGroup>
    <Reference Include="Antlr3.Runtime, Version=3.5.0.2, Culture=neutral, PublicKeyToken=eb42632606e9261f, processorArchitecture=MSIL">
  <SpecificVersion>False</SpecificVersion>
  <HintPath>..\..\packages\Antlr.3.5.0.2\lib\Antlr3.Runtime.dll</HintPath>
    </Reference>
</ItemGroup> 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2015-09-10T13:28:31.320

我有一个类似的问题。我删除了类和一个接口，之后我的构建开始失败。

1.  删除所有构建，以便没有项目构建（配置管理器）
2.  检查构建顺序（截取屏幕截图并将其放入 Paint :D）
3.  逐一启用，并在每次清理和重建和构建时执行。
4.  现在您知道失败的项目了。:-)

在我的情况下，我有一个文件夹，里面有一个界面。例如 FooSolution.StupidProject.Interfaces 发生的事情是我将接口 IUnicorns (FooSolution.StupidProject.Interfaces.IUnicorns) 注释掉了，这样就不会再使用它了。没有其他项目在使用 IUnicorn。一切都很好。

但是......其他一些项目仍在对该文件夹使用语句：

```
using FooSolution.StupidProject.Interfaces 
```

**解决方案：**

1.  而不是像这样评论界面，

    //公共接口 IUnicorn {

我还评论了接口上方的命名空间，如下所示：

```
// namespace FooSolution.StupidProject.Interfaces
//{
//   public interface IUnicorn { 
```

2.  我搜索了我的其他项目，并确保该名称空间不再使用！
3.  清洁和重建以及一杯好咖啡;-)

**结论：** 检查您在其他项目中的使用情况。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2015-12-12T18:41:55.693

在 VS 2015 中，删除“参考”下的“分析器”解决了这个问题

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2015-09-30T22:51:18.897

〜第30个答案:-)

在 VS2015 中：

*   右键单击解决方案
*   选择项目构建顺序
*   查看 Project Build Order 中的项目列表
*   按该顺序构建每个项目
*   检查输出

就我而言，一步一步地做有助于发现我的问题是什么，而没有左右抛出所有错误。

如果您必须知道，当项目设置为 .NET 4.5.2 时，我通过 NuGet 添加了实体框架 (EF) 6.1.3。后来我把.NET Framework降级到了4，然后错误就更明显了。通过 NuGet，我卸载了 EF 并重新添加了它。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2018-12-08T00:47:57.323

我有同样的问题，之前提供的答案都没有解决。显然这可能是 .csproj 文件的问题。由于某种原因，对我的代码中任何地方都没有的文件的引用仍然“丢失”。

使用文本编辑器打开您的 .csproj 文件并查找丢失的文件、删除、保存并开心。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2019-12-16T08:53:59.487

对我来说，我使用的是 EntityFramework.6.2.0 更新到 EntityFramework.6.4.0 然后问题就解决了。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2016-10-27T09:01:58.710

检查项目根目录中的 .vs 文件夹是否隐藏。我的不是（而且应该），因为我从另一台电脑复制/粘贴。删除它解决了这个问题，Visual Studio 2015 刚刚为我重新创建了它。

* * *

## 回答 #44

> 赞同：-1
> 
> 时间：2013-03-11T04:48:52.533

检查您的项目路径。它应该没有不规则字符，如逗号和空格

例如，这是不正确的路径：d:\my applications\Project1

这是真正的路径 d:\my_applications\Project1

当磁盘中的路径中有非字母和数字字符并且没​​有显示此故障的消息时，Visual Studio 无法构建项目！

还有一些安装工具在开始安装时也有同样的问题，无法解压。

# objective-c - 为什么我的目标 c 方法给我一个“错误：不能使用对象作为方法的参数”

> ID：898561
> 
> 赞同：1
> 
> 时间：2009-05-22T15:46:02.630
> 
> 标签：objective-c, cocoa

我一遍又一遍地看着这个，我看不出问题所在。这可能很明显，我可能是个白痴，我为此提前道歉。

在我的界面中，我有：

```
@interface PolygonShape：NSObject
{
    int numberOfSides;
    int minimumNumberOfSides;
    int maximumNumberOfSides;

}

@property int numberOfSides, minimumNumberOfSides, maximumNumberOfSides;

// 类方法
+ (float)getAngleInDegrees:(PolygonShape *) 多边形；
+ (float)getAngleInRadians:(PolygonShape *) 多边形；
+ (NSString)getName:(PolygonShape *) 多边形；

//实例方法
- (id)初始化；
- (id)initWithNumberOfSides:(int)sides minimumNumberOfSides:(int)min
       maximumNumberOfSides:(int)max;
@结尾

```

我得到错误的实现部分是 getName 方法：

```
@实现...

+ (NSString)getName:(PolygonShape *) 多边形
{
// 这是我得到“错误：不能使用对象作为方法的参数”的地方
    int 边 = [polyshape numberOfSides];
    NSString * s = [NSString 初始化];

    开关（边）{
        案例3：
            s = "@Triangle";
// 还有一个“来自不兼容指针类型的赋值”警告..​​....但它是次要的
            休息;
        案例4：
            返回“@Square”；
            休息;

        默认：
            休息;
    }
}

```

让我发狂的是类方法工作得很好：

```
+ (float)getAngleInDegrees:(PolygonShape *) polyshape;
+ (float)getAngleInRadians:(PolygonShape *) polyshape; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T15:49:51.520

您的 getName: 方法应该返回 (NSString *)，而不是 (NSString)。我认为这是错误；如果是这样，那么是的，错误消息肯定会提供更多信息。

事实上，在 Objective-C 中，你永远不会看到对象在没有 * 的情况下被传递，不是作为返回值，不是作为参数，不是作为局部变量，也不是作为成员变量。

顺便说一句，您提到的警告是因为您有错字，将“@foo”与@“foo”混淆了。后者是一个 Objectice-C 字符串文字，前者是一个 C 字符串文字，其第一个字符恰好是 @。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T16:14:03.577

除了其他答案之外，您正在使用的`[NSString init]`地方应该使用`[[NSString alloc] init]`. 但是，这只会分配一个空字符串，因此您最好将 s 初始化为`@""`or 或`nil`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T15:53:32.113

我认为在这种情况下，这个错误有点误导。在 Objective-C 中，通常不可能通过值（包括返回值）传递对象。在这种情况下，您将返回值声明为`NSString`而不是`NSString*`。声明应为：

```
+ (NSString*)getName:(PolygonShape *) polyshape 
```

不是

```
+ (NSString)getName:(PolygonShape *) polyshape 
```

# git-svn - 多个 svn 项目到一个 git 存储库中？

> ID：898568
> 
> 赞同：7
> 
> 时间：2009-05-22T15:47:13.253
> 
> 标签：git-svn

我已经开始在我的一些工作中使用 git-svn 来进行本地提交。这对于使用标准 svn 布局的项目非常有用。最近我开始研究一个 Java 项目，该项目被分成多个连接的模块（20-25），每个模块在同一个 svn 存储库中都有自己的根文件夹，并有自己的主干/分支/标签。

```
svnrepo/    
  module-1
    trunk
    branches
    tags
  module-N
    trunk
    branches
    tags 
```

我已经用 git svn clone -s /path/to/svnrepo/module[1-N] 克隆了每个模块。“问题”是当我想对所有模块执行 git svn rebase 时，我必须执行 N 次。

我试图做 git svn clone /path/to/svnrepo/ 避免做 N 次 rebase 操作，但这让我的目录布局与 svn repo 中的相同。

有没有一种方法可以在一个 git repo 中跟踪所有模块的所有主干？这样我就可以在我的 git 存储库中获得这样的目录布局：

```
module-1
module-2
module-N 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T18:41:26.360

不幸的是，不，没有办法做到这一点。一个问题是没有什么可以阻止两个或多个模块拥有同名的分支。然后，在 git-svn 中，当你给它分支名称时，它怎么知道你在说哪个模块？

这个问题实际上源于这样一个事实，即在 Subversion 中分支不是一流的概念，而在 git 中它们是。git-svn 能够或多或少地使用 kludge 来解决这个事实，但是如果 repo 具有“非标准”布局（例如您正在使用的布局），kludge 就会崩溃。

我的建议：给`git-svn rebase`他们写一个脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-22T02:04:18.090

我发现自己和你遇到了同样的问题，并且发现没有标准的方法可以做到这一点。然而，环顾四周，我发现了一种有助于做到这一点的策略，并在此基础上创建了一个 power shell 脚本。我不记得出处，否则我会给他们功劳。我会解释它，但我更容易看到脚本和评论。

您可以使用此脚本，或者如果不使用 windows/powershell，则基于它进行制作。好消息是，一旦您为每个子模块拥有了自己的 git 存储库，如果出现故障，只需删除新的“主”git 存储库、更改脚本并再次运行它就真的很快/很容易，因为这一切当地的。

请注意，有些情况未处理，例如当一个子模块具有与另一个子模块相同的文件夹时（因此，如果您有一个名为 BIN 的子模块，然后您的其他子模块有一个 BIN 子文件夹，它将失败）。在开始之前，请确保您的所有子模块 git repos 都是最新的！

您可以在此 gist 中查看脚本： [Gist Script](https://gist.github.com/bangoker/85a3004a1b153ccbd521)

如果由于某种原因主旨不正确，我也在这里添加了它（尽管可读性差很多）

```
$GitReposLocation = "path\to\individual\git\repos"; #1 git repo for each module (you svn cloned each one using std layout)
$MasterGitRepoLocation = "path\to\masterRepo"; #the path where you want your main repo that contains all the modules
git reset --hard;

write-host Creating folder $MasterGitRepoLocation -foregroundcolor "green";
mkdir $MasterGitRepoLocation;

write-host Moving to folder $MasterGitRepoLocation -foregroundcolor "green";
cd $MasterGitRepoLocation;

write-host Creating Git Repository -foregroundcolor "cyan";
git init;

#this is hacky, but we need to have an initial commit
"" > root;
git add root;
write-host Creating root node -foregroundcolor "cyan";
git commit -m "Initial commit to create parent root.";

#we are going to be moving files around, and don't want to move the files we already got in our MasterRepo root/workspace
$NotMoveThesFiles = @();
dir |%{$NotMoveThesFiles+=@($_.FullName) };

$repos = @();
# you should add a repo here if for some reasong you don't want to process that one.
# $repos+=@("SomeRepo");

dir -Path $GitReposLocation -Directory |Where-object{ $repos -NotContains $_.Name }|%{$repos+=@($_.Name) };

# for-each repo....
$repos|%{ 
        $SubRepoName = $_;
        write-host Processing GitRepo $SubRepoName -foregroundcolor "green";        
        $Remote = "remote"+$SubRepoName;        

        #add this git repo (of a module) as a remote of our main repo
        write-host Adding reference to $SubRepoName as remote repo -foregroundcolor  "cyan";
        git remote add -f $Remote $GitReposLocation\$SubRepoName;

        #Merge that sub repo into the main repo. The only problem? It will copy that repo's workspace
        #directly into our main repo Root folder
        write-host Merging remote$SubRepoName/master into master -foregroundcolor  "cyan";
        git merge remote$SubRepoName/master;

        #so now we are going to create a folder with  the name of this module (subRepo)
        #and move everything that is in the Master's root folder to that folder, except of course
        #things that we already had in the root folder before the merge. (in the NotMoveTheseFiles array)

        write-host Moving files got from $SubRepoName to a subdir called $SubRepoName -foregroundcolor  "green";

        #create folder folr the module
        mkdir $SubRepoName;
        #add these new folde to the list of things we don't want to move into it.
        $NotMoveThesFiles+=@($SubRepoName);

        #copy all files not in the NotMoveTheseFiles array into the newly created folder.
        dir |where-object {$NotMoveThesFiles -NotContains $_} |%{git mv $_ $SubRepoName};

        #commit the change where we moved all these files around.
        $CommitMessage = "Moving files got from " + $SubRepoName + " to a subdir called $SubRepoName"
        git commit -m $CommitMessage;
    } 
```

# php - mysql数据导入Dojo datagrid表

> ID：898574
> 
> 赞同：1
> 
> 时间：2009-05-22T15:48:19.370
> 
> 标签：php, javascript, mysql, dojo

大家好。

我有一个调用 MYSQL 并在表中显示数据的 php 脚本。它相当难看，我宁愿将它显示在 Dojo 样式表/数据网格中。谁能指出我正确的方向？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T23:56:02.313

将数据从 MySQL 传递到 Dojo DataGrid 需要一个简单的服务器端组件。[Dojo 论坛上最近的一次讨论](http://www.dojotoolkit.org/forum/dojox-dojox/dojox-grid-support/getting-values-mysql-db#comment-22276)演示了如何将 PHP 中的 MySQL 查询结果格式化为 Dojo 的标准数据存储能够理解的格式：

```
// do your mysql query and get a result set
$arr = array();
while($row = mysql_fetch_object($result)){               
  $arr[] = $row;
}

// assuming you're running php version 5.2.x or higher
// this also assumes each row in the array has a identifer field 'id' and a field "name" in the database table which are returned from the mysql query.
$jsonStr = json_encode($arr);
echo "{'identifier':'id','label':'name','items':$jsonStr}"; 
```

另请查看[有关 PHP 后端进行排序和搜索的评论](http://www.dojotoolkit.org/book/dojo-book-0-9-1-0/part-2-dijit-dojo-widget-library/advanced-editing-and-display/grid-1-0/sortin#comment-10703)。还有另一个 PHP 后端示例的消息（虽然没有网格）：[Bringing PHP, MySQL, and Dojo together](http://www.dojotoolkit.org/forum/dojo-core-dojo-0-9/dojo-core-support/bringing-php-mysql-and-dojo-together)。

此外，Dojo 的[测试](http://download.dojotoolkit.org/release-1.3.1/dojo-release-1.3.1/dojox/grid/tests/)总是有用的资源。就像这个演示[在 mysql 数据库中显示和编辑数据的](http://download.dojotoolkit.org/release-1.3.1/dojo-release-1.3.1/dojox/grid/compat/tests/test_mysql_edit.html)一样。**但请注意**：它只能**在您的本地**机器上工作，并且只有在您**编辑了用户名/密码**并将其指向[示例协议实现](http://download.dojotoolkit.org/release-1.3.1/dojo-release-1.3.1/dojox/grid/compat/tests/support/data.php)中的现有数据库之后。此外，它适用于较旧的 Grid 组件，尚未移植到较新的 DataGrid。但是，该文件是一个很好的起点，因为它显示了编辑数据所需的功能以及如何开始使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T17:17:55.177

我不知道 Dojo 的 DataGrid，但这里有一些我在 ExtJS 中使用的简单代码：

```
while($row = db_fetch_array($db_result)) $rows[] = $row;
echo json_encode($rows); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T18:35:18.760

[http://jslib-test.amplio-vita.net/JSLib/demos/DBGrid/](http://jslib-test.amplio-vita.net/JSLib/demos/DBGrid/)

# iphone - 如何检测用户是否只想滚动，而不是点击 UIScrollView 内的 UIImageView？

> ID：898575
> 
> 赞同：0
> 
> 时间：2009-05-22T15:48:24.487
> 
> 标签：iphone, cocoa-touch, uikit

我已经实现了一个包含 UIImageView 对象网格的 UIScrollView。对于超级视图和它的子视图，userInteractionEnabled 都是 YES。当用户滚动并且他/她的手指触摸 UIImageView 时，它会立即识别出点击，这不是我想要的；）

在那个 UIImageView 对象里面我有这个方法：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    if ([touch view] == self && [touch tapCount] >= 1) {
        NSLog(@"Cooooool! The user touched me!");
    }
} 
```

有没有办法让我识别出类似“哦不，用户实际上只想滚动，所以不要太认真地触摸！”？基本上，我需要的是主屏幕的行为，手指可能会触摸图标，但是当用户开始滚动并抬起手指时，触摸的应用程序将不会启动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T16:33:56.963

`UIScrollView`已经为您实现了该行为。如果用户足够快地拖动，您的`touchesBegan:withEvent:`方法将永远不会被调用。

另一方面，如果用户很慢并且滚动视图将触摸转发到您的`UIImageView`子类，但随后只意识到用户打算滚动，它将调用您的自定义类的`-(void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event`方法。

只需实施它，您就会收到取消触摸的通知。

# java - 如何在 Java 中扩展 IconNodeWidget 类？

> ID：898595
> 
> 赞同：0
> 
> 时间：2009-05-22T15:50:08.277
> 
> 标签：java, user-interface

我应该制作一个使用 Visual Library 的 GUI。我有一个场景，用户可以放置节点并编辑一些属性。然后我想保存每个节点的属性。为此，我正在尝试扩展 IconNodeWidget 类以向节点添加一些成员（我们称它们为 X 和 Y）。当用户选择一个节点并选择编辑属性时，我应该显示该值。问题是我无法扩展 IconNodeWidget 类。我怎么能做这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T16:49:46.350

我不知道您正在使用的 GUI 库的细节，但我建议您考虑 MVC 模式。

小部件属性（又名模型）将存储在单独的树中，视图将是 Visual Library 对象。

# sql - 通过更改标志将值从一个表插入到另一个表

> ID：898597
> 
> 赞同：0
> 
> 时间：2009-05-22T15:50:54.937
> 
> 标签：sql, sql-server, database

我必须将一个表中的值插入到另一个表中，该表都有两个字段，第一个字段名称是 ID，第二个字段名称是标志。

插入时，如果 ID 值已存在于任何目标表行中，它将在源表中插入新行作为相同的 ID 和标志作为 NEW

如果 ID 值在任何目标表行中都不匹配，它将插入行作为 ID 并将标志插入 OLD。

例如（来自下面的评论）：

```
表格1
--------
AO
博
一氧化碳

表 2
一个
国阵
DN

插入后
------------
一个
国阵
C n
一个
国阵
DN
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T16:38:56.737

如果我正确地跟随你，给出以下

```
Source Table

ID  |  Flag
-----------
1      NULL  
2      NULL
3      NULL

Dest Table

ID  |  Flag
-----------
1      NULL 
```

您想将记录`Source`插入`Dest`.

*   如果`ID`已经存在于 中，则用***NEW***的a`Dest`插入`ID``Source``flag`
**   如果`ID`中不存在，则使用***OLD***的a`Dest`插入`ID``Dest``flag`*

 *** * *

首先获取`ID`两者中存在的 s`Dest`并将***NEW***记录`Source`插入*`Source`*

 *```
 INSERT INTO Source (ID, Flag)
SELECT 
    s.ID, 'NEW'
FROM
    Source s
INNER JOIN
    Dest d
    ON d.ID = s.ID 
```

然后获取`ID`不存在`Dest`但存在的s`Source`并将***OLD***记录插入`Dest`

```
 INSERT INTO Dest (ID, Flag)
SELECT 
    s.ID, 'OLD'
FROM
    Source s
LEFT JOIN
    Dest d
    ON d.ID = s.ID
WHERE
    d.ID IS NULL 
```

这导致

```
Source Table

ID    |     Flag
----------- ----
1           NULL
2           NULL
3           NULL
1           NEW

Dest Table

ID    |     Flag
----------- ----
1           NULL
2           OLD
3           OLD 
```

那是你要找的吗？

老实说，这感觉不是一种很好的做事方式，例如，我认为更新表中已有的记录而不是插入新的记录会更好`ID`，尽管我不知道您要达到什么目的，也不知道您在桌子上有什么键（如果有的话）。如果您可以提供更多信息，我可能会提供进一步的帮助。

# visual-studio - 有人在 VS 2010 Beta 1 之后安装了 VS 2008 吗？

> ID：898602
> 
> 赞同：1
> 
> 时间：2009-05-22T15:51:28.137
> 
> 标签：visual-studio

我知道在已经安装了 VS 2008 的系统上安装 VS 2010 B1 是可以的。

有人按相反的顺序安装吗？有什么问题或问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T15:56:24.313

我遇到的唯一问题是，即使在将项目文件设置为使用 VS 2008 打开它们之后，项目文件仍然使用 VS 2010 打开。没什么大不了的，在我杀死 explorer.exe 之后它工作得很好。

# c# - 在 Windows Server 2003 中加载报告失败

> ID：898618
> 
> 赞同：1
> 
> 时间：2009-05-22T15:54:10.680
> 
> 标签：c#, asp.net, crystal-reports

我有一个 asp.net 应用程序，其中使用了水晶报告。当我单击显示按钮时，我收到一条错误消息，指出“加载报告失败”。应用程序在我的本地系统中工作正常。我也尝试使用 report.close() 和report.Dispose() 但没有运气。也设置了权限但仍然存在同样的问题。任何人都可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T17:31:08.780

检查几个基础知识：

1.  报告是否在您的应用程序所期望的目录中？您提到您已将权限设置得很好，但请仔细检查它实际上是否在正确的位置开始。甚至可以打印出它在某处寻找报告的位置，以便您确定。

2.  确保报表使用的所有表、视图和任何其他对象都在服务器上，并且它们匹配相同的格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T16:00:45.810

您遇到问题的服务器上是否有有效的 Crystal Reports 许可证？

即使使用 Visual Studio 附带的免费版本，也需要在计算机上提供许可证密钥才能运行 Crystal Reports。以下是我过去经历过的一些解决方案：

1.  在目标服务器上进行 Visual Studio 的基本安装。让它安装 C# 和 Crystal Reports 并完成它。主要问题是 Visual Studio 将获得许可证密钥设置。我认为从技术上讲，您必须启动一个新项目并将 Crystal Report 对象拖到项目上以启动密钥安装，但这可能会随着时间而改变。

2.  在您的项目中设置一个合并模块以插入 Crystal Reports 键。Crystal Reports 站点上有关于此的文档。有时这会成为一个棘手的过程。

3.  在目标服务器上安装完整的 Crystal Reports 副本。这假设您有可用的许可证。

不幸的是，这些都不是真正快速简便的解决方案，但所有这些都在过去有效。您只需要选择对您的商店来说是万恶之源中较轻的。8^D

# mercurial - Mercurial - 聪明编码 - 聪明解码 - 多个文件模式 - mercurial.ini

> ID：898619
> 
> 赞同：2
> 
> 时间：2009-05-22T15:54:38.120
> 
> 标签：mercurial, newline, hgrc

如何在 Windows 的 mercurial.ini 中指定 CRLF 编码/解码选项？

该文档提供了以下选项：

```
[extensions]
win32text =
[decode]
** = cleverdecode:
[encode]
** = cleverencode: 
```

对于所有文件，并且，

```
[extensions]
win32text =
[decode]
**.txt = cleverdecode:
[encode]
**.txt= cleverencode: 
```

对于一种文件（此处为 .txt 文件）。

我需要指定 *.xml、*.java 等！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T21:37:47.257

`[decode]`在和`[encode]`部分添加更多行：

```
[extensions]
win32text =

[decode]
**.txt = cleverdecode:
**.java = cleverdecode:
**.xml = cleverdecode:

[encode]
**.txt = cleverencode:
**.java = cleverencode:
**.xml = cleverencode: 
```

顺便说一句，双星匹配任何路径并跨越目录分隔符。有关`hg help patterns`Mercurial 中所谓的“通配符”选项的更多信息，请参阅参考资料。

# regex - 如何动态构建 Perl 正则表达式？

> ID：898621
> 
> 赞同：10
> 
> 时间：2009-05-22T15:55:20.617
> 
> 标签：regex, perl, configuration

我有一个使用 File::Next::files 遍历目录层次结构的 Perl 脚本。它只会返回以“.avi”、“.flv”、“.mp3”、“.mp4”和“.wmv”结尾的脚本文件。它还将跳过以下子目录：“.svn”和任何以“.frames”结尾的子目录。这在下面的`file_filter`和`descend_filter`子例程中指定。

```
my $iter = File::Next::files(
        { file_filter => \&file_filter, descend_filter => \&descend_filter },
        $directory );

sub file_filter { 
    # Called from File::Next:files.
    # Only select video files that end with the following extensions.
    /.(avi|flv|mp3|mp4|wmv)$/
}

sub descend_filter { 
    # Called from File::Next:files.
    # Skip subfolders that either end in ".frames" or are named the following:
    $File::Next::dir !~ /.frames$|^.svn$/
} 
```

我想要做的是将允许的文件扩展名和不允许的子目录名称放在配置文件中，以便可以即时更新它们。

我想知道的是如何根据配置文件中的参数对子例程进行编码以构建正则表达式结构？

```
/.(avi|flv|mp3|mp4|wmv)$/

$File::Next::dir !~ /.frames$|^.svn$/ 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-22T16:11:28.103

假设您已解析配置文件以获取扩展名和忽略目录的列表，您可以将正则表达式构建为字符串，然后使用`qr`运算符将​​其编译为正则表达式：

```
my @extensions = qw(avi flv mp3 mp4 wmv);  # parsed from file
my $pattern    = '\.(' . join('|', @wanted) . ')$';
my $regex      = qr/$pattern/;

if ($file =~ $regex) {
    # do something
} 
```

编译不是绝对必要的；您可以直接使用字符串模式：

```
if ($file =~ /$pattern/) {
    # do something
} 
```

目录有点困难，因为您有两种不同的情况：全名和后缀。您的配置文件必须使用不同的键来明确哪个是哪个。例如“dir_name”和“dir_suffix”。对于全名，我只需构建一个哈希：

```
%ignore = ('.svn' => 1); 
```

后缀目录可以与文件扩展名相同的方式完成：

```
my $dir_pattern = '(?:' . join('|', map {quotemeta} @dir_suffix), ')$';
my $dir_regex   = qr/$dir_pattern/; 
```

您甚至可以将模式构建到匿名子例程中以避免引用全局变量：

```
my $file_filter    = sub { $_ =~ $regex };
my $descend_filter = sub {
    ! $ignore{$File::Next::dir} &&
    ! $File::Next::dir =~ $dir_regex;
};

my $iter = File::Next::files({
    file_filter    => $file_filter,
    descend_filter => $descend_filter,
}, $directory); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T17:39:04.993

假设您为配置文件使用[Config::General](http://search.cpan.org/perldoc?Config::General)并且它包含以下行：

```
<MyApp>
    extensions    avi flv mp3 mp4 wmv
    unwanted      frames svn
</MyApp> 
```

然后您可以像这样使用它（有关更多信息，请参阅 Config::General ）：

```
my $conf = Config::General->new('/path/to/myapp.conf')->getall();
my $extension_string = $conf{'MyApp'}{'extensions'};

my @extensions = split m{ }, $extension_string;

# Some sanity checks maybe...

my $regex_builder = join '|', @extensions;

$regex_builder = '.(' . $regex_builder . ')$';

my $regex = qr/$regex_builder/;

if($file =~ m{$regex}) {
    # Do something.
}

my $uw_regex_builder = '.(' . join ('|', split (m{ }, $conf{'MyApp'}{'unwanted'})) . ')$';
my $unwanted_regex = qr/$uw_regex_builder/;

if(File::Next::dir !~ m{$unwanted_regex}) {
    # Do something. (Note that this does not enforce /^.svn$/. You
    # will need some kind of agreed syntax in your conf-file for that.
} 
```

（这是完全未经测试的。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T18:01:09.717

像普通字符串一样构建它，然后在最后使用插值将其转换为已编译的正则表达式。还要小心，你没有逃跑。或将其放在字符类中，因此它表示任何字符（而不是文字句点）。

```
#!/usr/bin/perl

use strict;
use warnings;

my (@ext, $dir, $dirp);
while (<DATA>) {
    next unless my ($key, $val) = /^ \s* (ext|dirp|dir) \s* = \s* (\S+)$/x;
    push @ext, $val if $key eq 'ext';
    $dir = $val     if $key eq 'dir';
    $dirp = $val    if $key eq 'dirp';
}

my $re = join "|", @ext;
$re = qr/[.]($re)$/;

print "$re\n";

while (<>) {
    print /$re/ ? "matched" : "didn't match", "\n";
}

__DATA__
ext = avi
ext = flv
ext = mp3
dir = .svn
dirp= .frames 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T20:12:14.483

如果您想构建一个可能很大的正则表达式并且不想麻烦调试括号，请使用 Perl 模块为您构建它！

```
use strict;
use Regexp::Assemble;

my $re = Regexp::Assemble->new->add(qw(avi flv mp3 mp4 wmv));

...

if ($file =~ /$re/) {
    # a match!
}

print "$re\n"; # (?:(?:fl|wm)v|mp[34]|avi) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-24T01:48:30.357

它与 File::Find::Rule 相当直接，只是事先创建列表的一个例子。

```
use strict;
use warnings;
use aliased 'File::Find::Rule';

# name can do both styles. 
my @ignoredDirs = (qr/^.svn/,  '*.frames' );
my @wantExt = qw( *.avi *.flv *.mp3 );

my $finder = Rule->or( 
    Rule->new->directory->name(@ignoredDirs)->prune->discard, 
    Rule->new->file->name(@wantExt)
);

$finder->start('./');

while( my $file = $finder->match() ){
    # Matching file.
} 
```

然后它只是填充这些数组的一个例子。（注意：上面的代码也未经测试，但可能会工作）。我通常会为此使用 YAML，它让生活更轻松。

```
use strict;
use warnings;
use aliased 'File::Find::Rule';
use YAML::XS;

my $config = YAML::XS::Load(<<'EOF');
---
ignoredir:
- !!perl/regexp (?-xism:^.svn)
- '*.frames'
want:
- '*.avi'
- '*.flv'
- '*.mp3'
EOF

my $finder = Rule->or( 
    Rule->new->directory->name(@{ $config->{ignoredir} })->prune->discard, 
    Rule->new->file->name(@{ $config->{want} })
);

$finder->start('./');

while( my $file = $finder->match() ){
    # Matching file.
} 
```

**注意**使用方便的模块“aliased.pm”，它为我导入“File::Find::Rule”作为“Rule”。

*   [File::Find::Rule](http://p3rl.org/File::Find::Rule) - File::Find 的替代接口
*   [YAML::XS](http://p3rl.org/YAML::XS) - 使用 XS 和 libyaml 的 Perl YAML 序列化
*   [别名](http://p3rl.org/aliased)- 使用较短版本的类名。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T13:11:21.263

尽管 File::Find::Rule 已经有办法处理这个问题，但在类似的情况下，您并不需要正则表达式。正则表达式在这里不会给您带来太多好处，因为您要在每个文件名的末尾寻找固定的字符序列。您想知道该固定序列是否在您感兴趣的序列列表中。将所有扩展存储在哈希中并查看该哈希：

```
my( $extension ) = $filename =~ m/\.([^.]+)$/;
if( exists $hash{$extension} ) { ... } 
```

您不需要构建正则表达式，也不需要通过几种可能的正则表达式替换来检查您必须检查的每个扩展。

# c++ - 在c ++ gdb核心转储中，我可以查看是否仍然分配了指针？

> ID：898622
> 
> 赞同：3
> 
> 时间：2009-05-22T15:55:25.233
> 
> 标签：c++, gdb

我在磁盘上有一个核心转储，由一个断言失败并中止的应用程序创建。该应用程序是在 Linux/g++ 上以调试模式编译的。我怀疑在堆栈顶部的堆栈框架中，我的`this`对象已被`delete`'d （我认为`this`不再是有效的 ptr）。但是，重现此中止可能需要几天或更长时间。

有没有办法让我从 gdb （或其他地方）中查询新的/免费的实现并验证给定的内存地址是否是有效的分配内存？换句话说，我可以看看 my`this`是否仍然被分配，或者它是否可能已经被分配`deleted`？它必须是静态的，因为我只有一个核心转储而不是一个正在运行的可执行文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T16:38:40.967

这不是不可能的，但如果您使用标准的 malloc/free/new/delete 调用，它非常接近。如果您认为您可以在几天内再次重现该问题，那可能是更快的方法。

与此同时，您可以做的是为下一次事件做好准备，以便更好地分析它。

[Dmalloc](http://dmalloc.com/)是一个免费实用程序，您可以使用它用可以执行额外检查和簿记的版本替换默认的 C/C++ 内存函数。

`LD_PRELOAD=libdmalloc.so your_program_here`将使用 dmalloc 运行程序，您可以设置标志以擦除内存，以便您知道是否有任何内存已被删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T16:41:24.410

核心转储包含程序在退出时的完整状态（包括进程内存分配的状态）。但是，您必须深入了解内存分配的工作原理才能确定对象是否仍然有效。然而，即使不知道确切的内存分配策略，在调试器中检查程序状态也可能导致发现问题。您是否检查了所有线程的堆栈中是否存在明显的“坏”值？他们可能会给你非常有价值的提示。

另一个非常好的主意是在[valgrind](http://valgrind.org/)中运行您的应用程序。

# sql-server-2005 - 如何以线性方式显示数据

> ID：898624
> 
> 赞同：0
> 
> 时间：2009-05-22T15:55:41.240
> 
> 标签：sql-server-2005

使用[此处找到的示例](http://www.experts-exchange.com/Microsoft/Development/MS-SQL-Server/SQL-Server-2005/Q_22938684.html)

> 我有一个我想创建的报告，它将向我显示如下信息：
> 
> Account ID , DateEntered, DateFirst contact was made, Dealt by, Date 2nd contact was made, Dealt by....
> 
> 然而，所有这些信息都在一张桌子上，但信息是这样的（参见链接中的示例）
> 
> 现在我想以线性方式查看这样的数据：
> 
> 123 12-04-07 约翰 14-04-07 玛丽 15-06-07 凯特
> 
> 但是，不同的帐户中会有不同数量的数据，所以有些可能有 5 行，而另一些可能有 10 行？

我想以线性方式显示数据，以便每一行都是唯一的。在本例中，唯一标识符将是 accountID。我的个人情况有点不同，因为我在几个表中都有数据，但可以轻松地将它们连接起来以获得与上述示例类似的输出。我遇到麻烦的地方是使数据线性化，以便每一行都是唯一的，并且不会针对每个不同的方差重复。

这可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T16:24:19.957

您没有提到您使用的是哪个 SQL Server 版本，或者每个帐户 ID 的行数是否固定。上述信息限制了需要使用的解决方案，下面的这些信息将帮助您实现您想要的或回复更多详细信息。

[http://www.simple-talk.com/community/blogs/andras/archive/2007/09/14/37265.aspx](http://www.simple-talk.com/community/blogs/andras/archive/2007/09/14/37265.aspx) [http://sqlserver2000.databases.aspfaq.com/how-do-i-create-a -cross-tab-or-pivot-query.html](http://sqlserver2000.databases.aspfaq.com/how-do-i-create-a-cross-tab-or-pivot-query.html) [http://www.mssqltips.com/tip.asp?tip=1019](http://www.mssqltips.com/tip.asp?tip=1019)

# mysql - MYSQL 连接一个表，其名称作为字段值存储在另一个表上

> ID：898628
> 
> 赞同：10
> 
> 时间：2009-05-22T15:56:15.467
> 
> 标签：mysql

我正在尝试在 MYSQL 中构建一个动态查询来加入一个表，该表的名称作为字段值存储在另一个表上，如下所示：

```
SELECT * FROM CATEGORIES 
INNER JOIN CATEGORISATIONS ON CATEGORISATIONS.id = CATEGORIES.fk_categorisation
INNER JOIN [CATEGORISATIONS.nom_table] LV_REGIONS ON LV_REGIONS.id = CATEGORIES.valeur 
```

有答案吗？！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-23T06:45:02.273

您应该构建动态 SQL [http://dev.mysql.com/doc/refman/5.1/en/sql-syntax-prepared-statements.html](http://dev.mysql.com/doc/refman/5.1/en/sql-syntax-prepared-statements.html)

喜欢：

```
select CATEGORISATIONS.nom_table into @tmp FROM ...;
PREPARE stmt1 FROM "SELECT * FROM ... INNER JOIN @tmp ..."; 
EXECUTE stmt1;
DEALLOCATE PREPARE stmt1; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T16:05:37.697

我的第一个建议是找到设计该模式的人，并给他们一本关于关系数据库设计的好书。

从那里，您可以朝两个方向前进：第一个是通过将 CATEGORIZATIONS.nom_table 命名的单独表加载到您可以直接查询的单个 REGIONS 表中来消除架构中的混乱。

或者，您需要将该查询分成多个部分，使用第一个 INNER JOIN 的结果来构造一个 UNION 查询来执行第二个 INNER JOIN。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T17:39:02.373

也许这样做的人意识到这真的不是一个好的设计实践......但有时你必须做出糟糕的黑客来做你想做的事情......

根据我对该主题的了解，我认为您无法仅通过 SELECT 查询来实现这一目标。

也许使用存储过程...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T20:27:46.447

我之前曾尝试使用从子查询返回的 mysql 表值作为字段名，但没有成功。我永远无法让 mysql 接受记录集值作为字段名。不幸的是，我不得不使用 php 来完成这项任务。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T16:05:28.227

我将假设您正在尝试让“[CATEGORISATIONS.nom_table]”解析为表名。

在这种情况下，您可以尝试在那里使用子查询，该子查询将仅解析为 1 个表名（因此结果集具有 1 行和 1 列）。我不确定 MySQL 是否会接受那里的表的字符串名称，但值得一试。

# asp.net-mvc - 处理 asp.net MVC 下拉列表中的空值

> ID：898632
> 
> 赞同：1
> 
> 时间：2009-05-22T15:56:42.440
> 
> 标签：asp.net-mvc

如何在 ASP.NET MVC 中创建一个可以处理空值的下拉列表？

应用程序是数据库中的查找字段，其中主键在查找表中，即Category，外键在另一个表中，即CategoryID，但CategoryID 是OPTIONAL（即它可以包含null）。

我会想象用户网页中生成的标记看起来像这样：

```
<select id="foo">
    <option value="">(Not Specified)</option>
    <option value="1">Alpha</option>
    <option value="2">Bravo</option>
    <option value="3">Charlie</option>
</select> 
```

我可以在不必编写自定义 HtmlHelper 的情况下做这样的事情吗？当需要保存时，这会正确绑定到底层模型吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T17:07:41.477

您不需要编写帮助程序。它已经存在。使用带有 optionLabel 参数的 Html.Select 重载之一。将其设置为“（未指定）”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T17:10:14.577

此外，您绑定到的任何字段都必须可以为空 - 在这种情况下，可以是字符串，也可以是可以为空的 int。

# c# - 为什么 Visual Studio .net 2008 添加 global.asax 文件后失去调试能力？

> ID：898633
> 
> 赞同：3
> 
> 时间：2009-05-22T15:56:44.437
> 
> 标签：c#, asp.net, visual-studio-2008

我没有收到正常的错误消息，说调试未启用红色错误消息。如果我删除我的全局 asax 文件，我的代码会转到我的断点。如果我重新添加文件，项目运行完全忽略任何断点。这是我的全局 asax 文件中的代码

公共类 Global_asax 继承 System.Web.HttpApplication

```
Sub Session_Start(ByVal sender As Object, ByVal e As EventArgs)
    ' Fires when the session is started
    Application("concurentUsers") += 1
End Sub

Sub Session_End(ByVal sender As Object, ByVal e As EventArgs)
    ' Fires when the session ends
    If Session("loggedout") = Nothing Then
        Application("concurentUsers") += -1
    End If
End Sub 
```

结束类

所以你可以看到它并不多。在运行具有全局 .asax 文件*的*项目时，我确实收到了来自 Visual Studio 的以下消息框

“以下模块是在启用优化或没有调试信息的情况下构建的：（我的临时 asp.net 文件的路径）要调试此模块，请将项目构建配置更改为调试模式。要抑制此消息，请禁用 'Warn if no启动时的用户代码调试器选项。”

我曾尝试删除这些临时文件，但随后导致项目完全不可调试并得到红色错误消息框说明，并且必须从回收站恢复以使我的项目恢复正常。因此，我必须删除全局 asax 文件才能调试项目（以及与之相关的任何代码都丢弃了项目文件），这非常令人讨厌

PS 一切都在调试模式下运行，并在 web 配置中标记为这样。正如我所说，它在没有 global.asax 文件的情况下调试得很好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:55:14.623

发布 global.asax 和 global.asax.cs 的全部内容（如果存在）。我的猜测是 global.asax 顶部的 Application 指令有一个编译器指令或导致该行为的某些东西（例如，/debug- 或 /debug:pdbonly 可能导致此行为）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T15:57:06.547

您可以尝试清除 Temporary ASP.NET 文件夹。

这有时会导致配置问题。

不要删除文件夹，只需删除其内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T21:36:07.383

作为一个附带问题，您应该使用[Application.Lock](http://msdn.microsoft.com/en-us/library/ms525184.aspx)。也是`+= -1`奇葩。你应该做`-= 1`

```
Application.Lock()
Application("concurentUsers") -= 1
Application.UnLock() 
```

不要介意并发的拼写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-04T18:02:17.937

这个问题让我在几个场合都发疯了。我发现在投入生产期间，我已将“配置”从“活动”（调试）更改为“发布”，并在“高级编译器设置”窗口（项目属性/编译/高级编译选项）上设置了“启用优化”选项。如果我稍后将配置类型设置回“活动（调试）”，我往往会忘记取消选中“启用优化”选项。发生这种情况时，我收到有关“启用优化”或“没有调试信息”的错误消息。过去，我总是在“没有调试信息”上提供线索，这让我偏离了轨道。

所以简短的回答是：仔细检查“启用优化”选项是否未选中，并且“生成调试信息：”在高级编译器设置中设置为完整或仅 pbd。

高温下，

詹姆士。

# iphone - 如何使使用 Tab Bar 管理的视图平滑地淡入/淡出，而不是几乎不闪入/淡出？

> ID：898638
> 
> 赞同：0
> 
> 时间：2009-05-22T15:58:27.697
> 
> 标签：iphone, cocoa-touch, uikit

我的应用程序底部有一个标签栏控制器和一个漂亮的标签栏。有三个按钮。当我点击一个时，该选项卡栏中的视图控制器被“调用”并且新视图立即出现。这就像用力敲门，让附近的每个人都能听到。如果可能的话，我希望有一个更柔和的过渡。诸如淡出、淡入或翻页过渡之类的东西。我需要看什么才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T18:25:32.970

您可以尝试覆盖 viewController 的`viewWillAppear`方法并实现一个视图动画，例如，将视图 alpha 设置为 0.0 并将其移动到 1.0 以获得淡入效果。在出去的路上，你可以覆盖`viewWillDisappear`.

但是，请记住，花哨的页面动画往往会变老，有时会在新奇感消失后阻碍。大多数资深用户只想开始。如果您最终做某事，您可能希望有一个允许他们关闭它的用户设置。

# .net - 托管可扩展性框架 (MEF) 与复合 UI 应用程序块 (CAB)

> ID：898641
> 
> 赞同：5
> 
> 时间：2009-05-22T15:59:23.830
> 
> 标签：.net, architecture, frameworks, mef, cab

我们目前正在考虑将 CAB 或 MEF 用于我们的下一个应用程序。我没有看到任何关于如何处理同级控制通信的事件代理的 codeplex 示例，也许我错过了。MEF 中的控件间通信如何工作？

此外，我们计划使用为 CAB 框架提供附加组件的 Infragistics。Infragistics 控制与 MEF 的集成程度如何？

总体而言，MEF 值得追求一个相当大的、15,000 小时的严格开发、应用程序吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T16:25:35.200

我可能错了，但我认为 MEF 没有任何事件代理。它是一个类似于 ioc 容器的通用组合引擎，但旨在提供更通用的插件和应用程序可扩展性解决方案。另一方面，CAB 和 Prism 是允许由 UI 组件组成的复合应用程序的 UI 框架。由于 UI 组件很可能需要相互通信并响应其他 UI 组件中的活动，因此底层框架需要提供 UI 组件之间的事件（发布/订阅）机制。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-25T12:04:26.577

如果您将 MEF 与 WPF 和 MVVM 模式一起使用，那么您的部件通常会导出 ViewModel 类和 View 类（例如 DataTemplates 等）。您的 View 绑定到 ViewModel 并使用依赖属性和命令来回通信。因此，如果 Part A 需要与 Part B 通信，那么 Part A 可以 Import 对 Part B 的 ViewModel 的引用，他们可以来回进行方法调用。Part A 还可以为 Part B 的事件等注册事件处理程序。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-25T17:47:16.640

MEF 不包括事件机制，但是您可以将 Prism 的事件聚合器与 MEF 一起使用。我在这里做了一个关于这个的帖子。

[http://codebetter.com/blogs/glenn.block/archive/2009/02/23/event-aggregation-with-mef-with-and-without-eventaggregator.aspx](http://codebetter.com/blogs/glenn.block/archive/2009/02/23/event-aggregation-with-mef-with-and-without-eventaggregator.aspx)

它的工作方式基本上是导出 Prism 的复合事件类。

HTH格伦

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-23T16:55:05.740

我同意斯科特的观点。“通用” pub/sub 模型看起来很有趣，但我很少需要它。如果我想要一个解耦的消息，我只需使用 MEF 定义一个合同 IMessage，然后导出一个实现，然后在我需要的地方导入。如果是强类型消息，我将导入我需要与之交谈的确切部分并直接发送消息。

# listviewitem - ListViewItem 生成“字典中不存在给定的键。” 错误

> ID：898644
> 
> 赞同：0
> 
> 时间：2009-05-22T16:00:14.720
> 
> 标签：listviewitem

怎么能

```
ItemCheckedEventArgs.Item.Selected = ItemCheckedEventArgs.Item.Checked 
```

生成“给定的键不在字典中。” ??

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T16:10:30.193

混淆是由于当您单步执行属性时 VS 没有进入事件处理程序，所以我在 SelectedIndexChanged 处理程序中没有看到错误。

# c# - 缓慢加载表格

> ID：898654
> 
> 赞同：0
> 
> 时间：2009-05-22T16:05:03.673
> 
> 标签：c#, .net

我一直在编写 C# .NET 应用程序。我正在使用 WinForms。所以，我有一些表单加载非常缓慢，特别是因为它们从一些 XML 文件中获取一些数据并将它们显示在 ListBox 控件中。

我要问的是：如何使表单加载更快。或者我如何继续显示一些旋转轮的图像（您通常在等待软件完成操作时看到的图像）。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T16:07:11.927

查看[BackgroundWorker 类](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)，它允许您在后台线程中启动任务（在您的情况下读取 XML 文件）并在任务完成时触发表单回调。这使您的 UI 线程可以自由地执行有用的操作（注册取消单击）或显示加载图形。

后台工作人员还支持实现进度回调的可能性，以便您的 UI 可以通知用户他们需要等待多长时间。

快速谷歌搜索弹出[这篇文章](http://www.c-sharpcorner.com/UploadFile/Ashush/BackgroundWorker03082008094954AM/BackgroundWorker.aspx)，似乎涵盖了基础知识。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-22T16:07:03.750

当您向 ListBox 添加许多项目时，请确保您调用

```
lst.BeginUpdate(); 
```

在您开始添加项目之前，以及

```
lst.EndUpdate(); 
```

添加完所有项目后。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T16:13:53.047

要显示旋转轮，如果您使用`System.Windows.Forms`，请查看 Cursor 类。

例如我做了一个这样的类：

```
class WaitCursor : IDisposable
{
    Cursor m_previous;

    internal WaitCursor()
    {
        m_previous = Cursor.Current;
        Cursor.Current = Cursors.WaitCursor;
    }

    #region IDisposable Members

    public void Dispose()
    {
        Cursor.Current = m_previous;
    }

    #endregion
} 
```

我这样使用：

```
 using (WaitCursor waitCursor = new WaitCursor())
    {
        //... any statements here, which take a long time ...
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T16:09:45.140

*   将长时间运行的代码放入 BackgroundWorker 以将工作卸载到单独的线程中并保持 UI 响应。
*   从窗体的 Shown 事件调用 BackgroundWorker（不是构造函数）。
*   可以选择处理 BackgroundWorker 的 ProgressChanged 事件，以便在加载数据时逐步更新 UI。
*   启动BackgroundWorker后设置UseWaitCursor = true，Enabled = false，并在BackgroundWorker的Complete事件中恢复。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T15:58:23.517

如果您使用 XmlSerializer，您应该知道，由于每种类型的自定义 XmlSerializer 是在运行时创建和编译的，因此可能会导致性能问题（尽管只要您的应用程序正在运行，它就会为每种类型创建和编译一次）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T16:10:54.903

此外，您可以在 init 开始时将光标更改为等待光标，然后在结束时返回标准光标，让用户知道正在发生某些事情，但最好使用线程，以便（主窗体？）不锁起来。没有什么比锁定的主屏幕更能说明“我僵住了”。如果它是一个主窗体，则可能是一个显示“正在加载...”或类似内容的启动画面。

# tsql - 在 T-SQL 中将分钟格式化为小时和分钟

> ID：898658
> 
> 赞同：5
> 
> 时间：2009-05-22T16:05:35.700
> 
> 标签：tsql

是否有一种干净简单的方法将整数格式化为整数，将整数计数为小时和分钟的十进制表示。很遗憾，在 T-SQL 中没有 Timespan 这样的东西来支持这一点。

为了清楚我的意思是，如果我有 70 分钟，我想将其转换为 1 小时 10 分钟的表示，即`1.10`. 我还希望将其保留为 varchar 或其他内容，以确保尾随零保持在原位。

无论如何，这可以作为 SQL 中的自定义函数创建，以便可以从不同的查询中重用吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-22T16:09:38.697

要获得小时数，您需要除以 60。要获得剩余分钟数，您需要将总分钟数 mod 60 或总分钟数和小时数之间的差乘以 60。要使余数出现在右侧小数位，除以 100.0：

```
SELECT minutes / 60 + (minutes % 60) / 100.0 ... 
```

请注意，您将丢失尾随零，恕我直言，以这种方式存储持续时间是一个坏主意，因为 a）您不能再用它做任何数学运算，并且 b）有人在稍后查看此代码时会感到困惑。

最好使用如下的字符串表示形式（我建议再次使用 ':' 而不是 '.' 来表示*这不是数字*）：

```
SELECT CAST((minutes / 60) AS VARCHAR(8)) + ':' + 
       RIGHT('0' + CAST((minutes % 60) AS VARCHAR(2)), 2) ... 
```

* * *

至于创建自定义函数，您可以创建一个存储过程，然后从其他代码中调用它。请注意，必须在每个数据库中创建存储过程。

~~不确定创建存储过程是否值得付出努力，除非您想变得更漂亮并返回类似 TimeSpan 的行。~~

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T16:56:08.823

```
select 70/60 + ( 70 % 60)/100.0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T12:11:34.543

我花了一段时间试图做同样的事情，我是这样做的：

```
convert( varchar, cast((RouteMileage / @average_speed) as integer))+ ':' +  convert( varchar, cast((((RouteMileage / @average_speed) - cast((RouteMileage / @average_speed) as integer)) * 60) as integer)) As TravelTime,

dateadd( n, -60 * CAST( (RouteMileage / @average_speed) AS DECIMAL(7,2)), @entry_date) As DepartureTime 
```

输出：

```
DeliveryDate                TravelTime             DepartureTime
2012-06-02 12:00:00.000       25:49         2012-06-01 10:11:00.000 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-23T18:19:47.413

```
CAST(Duration/60 + (duration % 60) /100.0 as Decimal(10,1)) 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2016-12-20T19:36:25.790

在 SQL Server 2012 中：

```
SELECT format(DATEADD(minute, 70, 0), N'hh\.mm') 
```

# vb.net - LogonUser API 在 VB.Net 中对用户进行身份验证

> ID：898660
> 
> 赞同：2
> 
> 时间：2009-05-22T16:06:46.980
> 
> 标签：vb.net, authentication, active-directory

我在使用`LogonUser`from`vb.net`对用户进行身份验证时遇到问题。我正在使用`LogonType`（`LOGON32_LOGON_NETWORK`3）。

文档指定使用此选项进行简单身份验证，并且不缓存凭据。

我遇到的问题是，如果用户刚刚更改了密码，他们可以使用旧密码或新密码登录。

`LogonType`进行简单身份验证的正确方法是什么？

这是我目前正在使用的代码：

```
Public Shared Function login(ByVal domain As String, ByVal userid As String, ByVal pwd As String, ByVal logonType As Integer, ByRef errorMessage As String) As Boolean
        'The Windows NT user token.
        Dim token As IntPtr = IntPtr.Zero
        Dim LOGON32_PROVIDER_DEFAULT As Integer = 0

        'Get the user token for the specified user, machine, and password using the unmanaged LogonUser method.

        If LogonUserA(userid, domain, pwd, logonType, LOGON32_PROVIDER_DEFAULT, token) <> 0 Then
            If Not token.Equals(IntPtr.Zero) Then
                CloseHandle(token)
            End If
            Return True
        End If

        'Call GetLastError to try to determine why logon failed if it did not succeed.
        Dim ret As Integer = GetLastError()
        Select Case ret
            Case 1326
                errorMessage = "Logon failure: unknown user name or bad password."
            Case 1331
                errorMessage = "Logon failure: account currently disabled."
            Case 1330
                errorMessage = "Logon failure: the specified account password has expired."
            Case 1907
                errorMessage = "The user's password must be changed before logging on the first time."
            Case 1909
                errorMessage = "The referenced account is currently locked out and may not be logged on to."
            Case Else
                errorMessage = "Logon failure: unknown code = " & ret
        End Select
        If Not token.Equals(IntPtr.Zero) Then
            CloseHandle(token)
        End If
        Return False
    End Function 
```

# asp.net - 创建文件 HttpPost 请求

> ID：898663
> 
> 赞同：2
> 
> 时间：2009-05-22T16:07:50.850
> 
> 标签：asp.net, post

我将与现有应用程序集成，该应用程序将在对我们的 ASP.NET 应用程序的初始 HTTP 发布请求中包含一个附件。

我已经构建了从**HttpRequest.Files**中提取文件的逻辑，甚至使用 JMeter 对其进行了测试。

我想要做的是构建一个独立的 ASP.NET 页面，它可以将用户引导到我们应用程序的第一页，并可以选择是否在请求中包含文件。我通常只是通过 Response.Redirect 来访问另一个页面，但我无法确定以这种方式附加文件的方式。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T16:24:31.097

Eurgh，确实是一个棘手的问题。显然您不能重定向，因为文件只能通过 http POST 操作发送。重定向导致 GET。

也许让您的初始 asp.net 页面在服务器端使用文件执行第一次回发，然后将生成的页面流式传输回用户，注意设置给您的任何 cookie，以确保将会话传递到用户（因为它最初属于发布文件的服务器端 asp.net 代码）。

这可能会或可能不会起作用，具体取决于目标应用程序如何处理传入请求。如果有代理服务器或负载均衡器，事情可能会变得棘手，特别是如果它正在使用粘性会话和/或监视传入请求的 IP。

无论如何，只是我的0.02c。

祝你好运！

-Oisin

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T16:25:13.157

如果可能，为您的初始页面绕过整个“网络表单”模型，然后对您的其他页面执行 HTTP POST。

这有点麻烦，特别是如果您的网站使用母版页并且几乎所有内容都嵌套在标签中。

# ide - 为什么 IDE 不支持动态格式化？

> ID：898664
> 
> 赞同：10
> 
> 时间：2009-05-22T16:08:17.510
> 
> 标签：ide, formatting

鉴于围绕各种代码格式化风格的所有圣战，以及许多公司严格的格式化要求，为什么 IDE 不允许动态重新格式化代码？
我的意思是让 IDE 每次都按照用户想要的方式格式化代码，并在没有任何格式化的情况下保存代码。（好吧，也许换行符让差异仍然很容易）
用户不必担心遵守编码标准，人们不会因为使用不是按照他们喜欢的方式格式化的代码而弯曲变形，并且格式更改不会显示在存储库差异中。
必须有某种机制来关闭它，这样它就不会破坏旧的、预先格式化的代码，但除此之外，是什么阻止了它成为标准功能？

编辑：我知道某些 IDE 具有重新格式化功能，但这会导致几乎与它解决的问题一样多 - 源代码控制差异变得几乎无用，因为实际更改在无意义的格式更改和不同的制表符的海洋中丢失了宽度仍然会使事物不对齐。此外，它不允许程序员以他们喜欢的格式处理代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T16:14:24.810

我认为 Eclipse 允许您随意格式化代码。

编辑：是的，Java Code Formatter 格式基于您在项目中设置的规则。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-22T16:17:51.673

因为大多数人喜欢看到将提交的代码。除非您用于查看代码的所有工具（diff 程序、grep、基于 Web 的源代码库查看器等）都了解如何以相同的方式动态格式化代码，否则您在查看时会被不同的格式混淆它在您的 IDE 中与其他工具相比。

我同意，如果我们有更多的结构化编程工具，而不是固定宽度的文本工具，那就太好了，但它需要更新工具链中的所有内容才能真正使其可行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T18:22:43.113

我认为这也是一个好主意，但作为源代码控制软件而不是 IDE 的功能。

代码可以存储为令牌列表，然后在复制到开发机器时重新构建。这回答了 aleemb 的观点，因为没有存储任何空白。不过，可能需要更复杂的格式规则来处理所有情况。

它还回答了 Martin Harris 的担忧——您机器上的代码不会包含任何特殊字符，只是标记之间的空格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T16:23:25.200

我认为在大多数情况下，实际机器上的文件应该是通用的文本格式，能够打开我在记事本或任何其他方便的文本编辑器中处理的任何源代码文件是没有用的. 因此，我不希望我的本地副本包含任何被 IDE 解释为“这是缩进，请在此处使用您认为合适的制表符或空格”的特殊字符。我的观点是，进行这种格式化的最佳点是源代码控制系统，你检查一个你喜欢的格式的文件，我检查它的格式。

不久前，我问[了这个](https://stackoverflow.com/questions/802504/are-there-any-merge-tools-for-source-control-that-understand-code)关于源代码控制工具不理解代码的问题，而 ascalonx 的回答将我指向[数据库中的源代码控制](http://en.wikipedia.org/wiki/Source%5FCode%5Fin%5FDatabase)。遗憾的是，这个想法似乎没有更多的吸引力，因为它既可以解决我们的问题，也可以解决[更多](http://mindprod.com/project/scid.html)问题。我是一名 .NET 开发人员，所以目前我对此非常冷淡，但显然 Java 世界中的 Eclipse 和 IntelliJ 正在接近这个理想（我不知道有多接近，因为我我从来没有用过）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-22T02:23:18.273

我认为最大的障碍是重构源代码注释，因为它们没有正式的语义——我不是在谈论 JavaDocs 或类似的东西，而是在源代码中放置的注释。如果没有源代码注释的语义规则，整个概念就会分崩离析。

当然，您可以对 AST 进行版本控制，但是如何将注释映射到 AST 节点上呢？

一种天真的方法是将注释与语言中的语句相关联，但是如果我有一个适用于“接下来的 3 行”的注释，然后有人将其中一行移到其他地方怎么办。评论去哪儿了？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T16:31:07.413

我确信有可用的程序和脚本以您指定的方式格式化代码。

虽然某些 IDE 支持这种代码重新格式化（Eclipse、Intellij for Java、Wing for Python、VS2007? for .net），即使它们不支持，也应该只在源代码上运行这些脚本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T17:54:03.270

如果您可以处理以下情况，我会认为这是一个好主意，但我的直觉是它并非微不足道，这意味着它不直观且不可预测，这对用户体验不利。

如果代码是这样写的：

```
if(value!=null) 
```

和动态格式化程序显示：

```
if (value != null) 
```

我将其修改为：

```
if ((value != null) && (value.Length > 0)) 
```

然后另一个开发人员将其动态格式化为：

```
if ( (value != null) && (value.Length > 0) ) 
```

并更改代码中的其他一些行并保存它。上述格式是否也被保存？您如何协调两个开发人员的不同格式偏好，因为他的新添加将采用不同的格式。

您必须以通用格式存储，但即便如此，行长也会不同，开发人员会在不同的位置断开行以进行 80 或 100 个字符的换行，这会变得非常混乱。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T17:55:20.210

抄袭很难被发现:)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-22T16:25:55.573

因为大多数人并不关心代码的外观，只要它是一致的。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-22T17:31:15.377

我认为现在是 IDE 开始将其代码存储为 XML 的时候了，然后使用用户定义的 XSL 样式表在呈现时格式化代码。

# seo - 元关键字标签中的重复“单词”是什么？

> ID：898665
> 
> 赞同：2
> 
> 时间：2009-05-22T16:08:23.593
> 
> 标签：seo, metadata, keyword

我意识到关键字和描述是老式的 SEO 技术，许多搜索引擎都忽略了它们。但是，将它们包含在您的 HTML 页面中似乎是一种很好的做法。

我读过的最佳实践之一是不在标题标签中重复关键字。那么我的问题是，究竟什么是重复？

例如，如果我这样写一个关键字标签：

```
<meta name="keywords" content="college football, college, football, college sports" /> 
```

“学院”这个词是否被认为是重复的，还是逗号表示完全不同的词？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T16:17:51.520

大多数引擎只计算 2 个关键字，所以为什么要浪费关键字利用率，你知道吗？但这是一个重复，但不应该恶化你的机会。您可能应该将此用作您的短语：

```
college football sports, 
```

---全部作为一个短语。你不应该重复一个关键词超过两三次。

# python - 如何在 Python 中检测文件是否为二进制（非文本）文件？

> ID：898669
> 
> 赞同：117
> 
> 时间：2009-05-22T16:09:50.630
> 
> 标签：python, file, binary

如何判断文件在 Python 中是否为二进制（非文本）文件？

我在 Python 中搜索大量文件，并不断在二进制文件中找到匹配项。这使得输出看起来非常混乱。

我知道我可以使用`grep -I`，但我对数据的处理比 grep 允许的要多。

过去，我只会搜索大于`0x7f`, but`utf8`之类的字符，这在现代系统上是不可能的。理想情况下，解决方案会很快。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2011-09-12T18:44:23.713

另一种[基于 file(1) 行为的方法](https://github.com/file/file/blob/f2a6e7cb7db9b5fd86100403df6b2f830c7f22ba/src/encoding.c#L151-L228)：

```
>>> textchars = bytearray({7,8,9,10,12,13,27} | set(range(0x20, 0x100)) - {0x7f})
>>> is_binary_string = lambda bytes: bool(bytes.translate(None, textchars)) 
```

例子：

```
>>> is_binary_string(open('/usr/bin/python', 'rb').read(1024))
True
>>> is_binary_string(open('/usr/bin/dh_python3', 'rb').read(1024))
False 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-05-22T16:21:50.707

您还可以使用[mimetypes](https://docs.python.org/3.6/library/mimetypes.html)模块：

```
import mimetypes
...
mime = mimetypes.guess_type(file) 
```

编译二进制 mime 类型列表相当容易。例如，Apache 分发了一个 mime.types 文件，您可以将其解析为一组列表、二进制和文本，然后检查 mime 是否在您的文本或二进制列表中。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2015-05-16T08:14:24.040

如果您将 python3 与 utf-8 一起使用，这很简单，只需在文本模式下打开文件并在收到`UnicodeDecodeError`. Python3 在文本模式下处理文件时将使用 unicode（在二进制模式下使用 bytearray） - 如果您的编码无法解码任意文件，您很可能会得到`UnicodeDecodeError`.

例子：

```
try:
    with open(filename, "r") as f:
        for l in f:
             process_line(l)
except UnicodeDecodeError:
    pass # Fond non-text data 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-22T16:23:17.273

如果有帮助，许多二进制类型都以幻数开头。[这是](http://www.garykessler.net/library/file_sigs.html)文件签名的列表。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-06-09T01:14:54.017

试试这个：

```
def is_binary(filename):
    """Return true if the given filename is binary.
    @raise EnvironmentError: if the file does not exist or cannot be accessed.
    @attention: found @ http://bytes.com/topic/python/answers/21222-determine-file-type-binary-text on 6/08/2010
    @author: Trent Mick <TrentM@ActiveState.com>
    @author: Jorge Orpinel <jorge@orpinel.com>"""
    fin = open(filename, 'rb')
    try:
        CHUNKSIZE = 1024
        while 1:
            chunk = fin.read(CHUNKSIZE)
            if '\0' in chunk: # found null byte
                return True
            if len(chunk) < CHUNKSIZE:
                break # done
    # A-wooo! Mira, python no necesita el "except:". Achis... Que listo es.
    finally:
        fin.close()

    return False 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-07-24T09:25:19.027

我们可以使用 python 本身来检查文件是否是二进制文件，因为如果我们尝试以文本模式打开二进制文件会失败

```
def is_binary(file_name):
    try:
        with open(file_name, 'tr') as check_file:  # try open file in text mode
            check_file.read()
            return False
    except:  # if fail then file is non-text (binary)
        return True 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-22T16:28:25.917

这是使用 Unix[文件](http://en.wikipedia.org/wiki/File_(Unix))命令的建议：

```
import re
import subprocess

def istext(path):
    return (re.search(r':.* text',
                      subprocess.Popen(["file", '-L', path], 
                                       stdout=subprocess.PIPE).stdout.read())
            is not None) 
```

示例用法：

```
>>> istext('/etc/motd')
真的
>>> istext('/vmlinuz')
错误的
>>> open('/tmp/japanese').read()
'\xe3\x81\x93\xe3\x82\x8c\xe3\x81\xaf\xe3\x80\x81\xe3\x81\xbf\xe3\x81\x9a\xe3\x81\x8c\xe3\x82\x81\ xe5\xba\xa7\xe3\x81\xae\xe6\x99\x82\xe4\xbb\xa3\xe3\x81\xae\xe5\xb9\x95\xe9\x96\x8b\xe3\x81\x91\xe3\ x80\x82\n'
>>> istext('/tmp/japanese') # 适用于 UTF-8
真的

```

它的缺点是不能移植到 Windows（除非你有类似`file`命令的东西），并且必须为每个文件生成一个外部进程，这可能不合适。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-11-07T09:10:05.463

使用[binaryornot](https://pypi.python.org/pypi/binaryornot/)库（[GitHub](https://github.com/audreyr/binaryornot)）。

它非常简单，并且基于this stackoverflow question中的代码。

您实际上可以用 2 行代码编写它，但是这个包使您不必编写和彻底测试具有各种奇怪文件类型、跨平台的那 2 行代码。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-22T16:14:44.717

通常你必须猜测。

如果文件有扩展名，您可以将扩展名视为一条线索。

您还可以识别已知的二进制格式，并忽略它们。

否则，请查看您拥有的不可打印 ASCII 字节的比例并从中猜测。

您还可以尝试从 UTF-8 解码，看看是否会产生合理的输出。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-07-02T21:45:13.493

一个较短的解决方案，带有 UTF-16 警告：

```
def is_binary(filename):
    """ 
    Return true if the given filename appears to be binary.
    File is considered to be binary if it contains a NULL byte.
    FIXME: This approach incorrectly reports UTF-16 as binary.
    """
    with open(filename, 'rb') as f:
        for block in f:
            if b'\0' in block:
                return True
    return False 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-06-17T17:22:25.293

尝试使用当前维护的[python-magic](http://github.com/ahupp/python-magic)，这与@Kami Kisiel 的答案中的模块不同。这确实支持包括 Windows 在内的所有平台，但是您将需要`libmagic`二进制文件。这在自述文件中进行了解释。

与[mimetypes](https://docs.python.org/3.6/library/mimetypes.html)模块不同，它不使用文件的扩展名，而是检查文件的内容。

```
>>> import magic
>>> magic.from_file("testdata/test.pdf", mime=True)
'application/pdf'
>>> magic.from_file("testdata/test.pdf")
'PDF document, version 1.2'
>>> magic.from_buffer(open("testdata/test.pdf").read(1024))
'PDF document, version 1.2' 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-05-22T20:55:56.780

如果您不在 Windows 上，则可以使用[Python Magic](http://pypi.python.org/pypi/python-magic/0.1)来确定文件类型。然后你可以检查它是否是文本/mime 类型。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-06-01T11:39:45.790

[如果文件包含NULL 字符](https://en.wikipedia.org/wiki/Null_character)，则大多数程序认为该文件是二进制文件（即任何非“面向行”的文件）。

这是用 Python 实现的perl 版本的`pp_fttext()`( )：`pp_sys.c`

```
import sys
PY3 = sys.version_info[0] == 3

# A function that takes an integer in the 8-bit range and returns
# a single-character byte object in py3 / a single-character string
# in py2.
#
int2byte = (lambda x: bytes((x,))) if PY3 else chr

_text_characters = (
        b''.join(int2byte(i) for i in range(32, 127)) +
        b'\n\r\t\f\b')

def istextfile(fileobj, blocksize=512):
    """ Uses heuristics to guess whether the given file is text or binary,
        by reading a single block of bytes from the file.
        If more than 30% of the chars in the block are non-text, or there
        are NUL ('\x00') bytes in the block, assume this is a binary file.
    """
    block = fileobj.read(blocksize)
    if b'\x00' in block:
        # Files with null bytes are binary
        return False
    elif not block:
        # An empty file is considered a valid text file
        return True

    # Use translate's 'deletechars' argument to efficiently remove all
    # occurrences of _text_characters from the block
    nontext = block.translate(None, _text_characters)
    return float(len(nontext)) / len(block) <= 0.30 
```

> 另请注意，此代码无需更改即可在 Python 2 和 Python 3 上运行。

资料来源：[Perl 用 Python 实现的“猜测文件是文本还是二进制”](http://eli.thegreenplace.net/2011/10/19/perls-guess-if-file-is-text-or-binary-implemented-in-python/)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-05-04T17:21:35.220

这是一个函数，它首先检查文件是否以 BOM 开头，如果不是，则在初始 8192 字节中查找零字节：

```
import codecs

#: BOMs to indicate that a file is a text file even if it contains zero bytes.
_TEXT_BOMS = (
    codecs.BOM_UTF16_BE,
    codecs.BOM_UTF16_LE,
    codecs.BOM_UTF32_BE,
    codecs.BOM_UTF32_LE,
    codecs.BOM_UTF8,
)

def is_binary_file(source_path):
    with open(source_path, 'rb') as source_file:
        initial_bytes = source_file.read(8192)
    return not any(initial_bytes.startswith(bom) for bom in _TEXT_BOMS) \
           and b'\0' in initial_bytes 
```

从技术上讲，对 UTF-8 BOM 的检查是不必要的，因为出于所有实际目的，它不应包含零字节。但由于它是一种非常常见的编码，因此在开始时检查 BOM 比扫描所有 8192 字节的 0 更快。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-05-29T09:26:28.233

```
from binaryornot.check import is_binary
is_binary('filename') 
```

[文档](https://binaryornot.readthedocs.io/)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-08-02T14:11:20.957

我想最好的解决方案是使用guess_type 函数。它包含一个包含多个 mimetype 的列表，您还可以包含自己的类型。这是我为解决问题所做的脚本：

```
from mimetypes import guess_type
from mimetypes import add_type

def __init__(self):
        self.__addMimeTypes()

def __addMimeTypes(self):
        add_type("text/plain",".properties")

def __listDir(self,path):
        try:
            return listdir(path)
        except IOError:
            print ("The directory {0} could not be accessed".format(path))

def getTextFiles(self, path):
        asciiFiles = []
        for files in self.__listDir(path):
            if guess_type(files)[0].split("/")[0] == "text":
                asciiFiles.append(files)
        try:
            return asciiFiles
        except NameError:
            print ("No text files in directory: {0}".format(path))
        finally:
            del asciiFiles 
```

它位于类内部，正如您根据代码的结构所看到的那样。但是你几乎可以改变你想要在你的应用程序中实现它的东西。使用起来非常简单。getTextFiles 方法返回一个列表对象，其中包含您在路径变量中传递的目录中的所有文本文件。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-01-04T07:51:21.167

我来这里是为了寻找完全相同的东西——标准库提供的用于检测二进制或文本的综合解决方案。在查看了人们建议的选项之后，nix **file**命令看起来是最好的选择（我只是为 linux boxen 开发）。其他一些人使用**文件**发布了解决方案，但我认为它们不必要地复杂，所以这就是我想出的：

```
def test_file_isbinary(filename):
    cmd = shlex.split("file -b -e soft '{}'".format(filename))
    if subprocess.check_output(cmd)[:4] in {'ASCI', 'UTF-'}:
        return False
    return True 
```

不言而喻，但调用此函数的代码应确保在测试之前可以读取文件，否则会错误地将文件检测为二进制文件。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-05-29T23:48:16.687

## 在 *NIX 上：

### 如果您可以访问`file`shell 命令，则 shlex 可以帮助使 subprocess 模块更可用：

```
from os.path import realpath
from subprocess import check_output
from shlex import split

filepath = realpath('rel/or/abs/path/to/file')
assert 'ascii' in check_output(split('file {}'.format(filepth).lower())) 
```

### 或者，您也可以将其粘贴在 for 循环中，以便使用以下命令获取当前目录中所有文件的输出：

```
import os
for afile in [x for x in os.listdir('.') if os.path.isfile(x)]:
    assert 'ascii' in check_output(split('file {}'.format(afile).lower())) 
```

### 或所有子目录：

```
for curdir, filelist in zip(os.walk('.')[0], os.walk('.')[2]):
     for afile in filelist:
         assert 'ascii' in check_output(split('file {}'.format(afile).lower())) 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-22T16:14:35.357

你在unix吗？如果是这样，那么尝试：

```
isBinary = os.system("file -b" + name + " | grep text > /dev/null") 
```

shell 返回值是反转的（0 是可以的，所以如果它找到“文本”，那么它将返回一个 0，而在 Python 中这是一个 False 表达式）。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-06-01T18:35:59.310

`\x00`更简单的方法是使用运算符检查文件是否包含 NULL 字符 ( ) `in`，例如：

```
b'\x00' in open("foo.bar", 'rb').read() 
```

请参阅下面的完整示例：

```
#!/usr/bin/env python3
import argparse
if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('file', nargs=1)
    args = parser.parse_args()
    with open(args.file[0], 'rb') as f:
        if b'\x00' in f.read():
            print('The file is binary!')
        else:
            print('The file is not binary!') 
```

示例用法：

```
$ ./is_binary.py /etc/hosts
The file is not binary!
$ ./is_binary.py `which which`
The file is binary! 
```

# javascript - 如何将选项添加到, 在 IE Windows Mobile 5 中尝试以编程方式将选项添加到 IE Windows Mobile 中的 SELECT 下拉列表中。因为这是 IE Windows Mobile 5，大多数涉及 getElementID 的解决方案都不起作用，所以我不得不求助于更普通的 HTML /Java 脚本，下面的示例在 IE 6 和 FF 中运行良好，但失败并显示“对象不支持此属性或方法”在 Windows Mobile 5 function insertBarcode

> ID：898681
> 
> 赞同：2
> 
> 时间：2009-05-22T16:12:20.693
> 
> 标签：javascript, windows-mobile, ie-mobile

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T17:31:15.660

有 4 种方法（我知道）来设置选项...（希望其中一种对您有用（让我们知道哪个））

```
//option 1
var newOpt = document.createElement('option');
newOpt.innerText = 'Hello';
mySelectObject.appendChild(newOpt);

//option 2
mySelectObject.innerHTML = '<option>Hello</option>';
//KNOWN TO FAIL IN IE6,7,8 (see url below)

//option 3
mySelectObject.outerHTML = '<select><option>Hello</option></select>'; //IE Only

//option 4
var newOpt = new Option('Hello','Hello');
mySelectObject.options[index] = newOpt; 
```

设置[.innerHTML的 IE 错误](http://webbugtrack.blogspot.com/2007/08/bug-274-dom-methods-on-select-lists.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T15:56:35.027

在这里找到了答案：

首先我在这里查看了官方参考来源：http: [//msdn.microsoft.com/en-us/library/bb159677.aspx](http://msdn.microsoft.com/en-us/library/bb159677.aspx)

我注意到 selectObj 有一个 add 方法，所以我尝试了它并且它有效..

这是工作代码，

```
function AddSelectOption(selectObj, text, value, isSelected){
  if(selectObj != null && selectObj.options != null){
    var newOpt = new Option('Hello','Hello'); //create the option object
    selectObj.add(newOpt); //it's the .add(option) method
  }
} 
```

谢谢大家

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T18:04:22.443

来自[史蒂文哈曼的博客](http://old.stevenharman.net/blog/archive/2007/07/10/add-option-elements-to-a-select-list-with-javascript.aspx)：

```
function AddSelectOption(selectObj, text, value, isSelected) 
{
    if (selectObj != null && selectObj.options != null)
    {
        selectObj.options[selectObj.options.length] = 
            new Option(text, value, false, isSelected);
    }
} 
```

所以你的代码会变成；

```
function insertBarcodes()
{
    val = document.form1.barcode.value ;
    AddSelectOption( document.form1.blist, val, val, false );
} 
```

该网站指出，作者遇到了您提到的确切问题。作者承认他不知道为什么四参数 Option 对象有效，只知道它有效。

# c - 如何在服务和用户进程之间共享内存？

> ID：898683
> 
> 赞同：8
> 
> 时间：2009-05-22T16:12:40.677
> 
> 标签：c, security, winapi, windows-vista

`CreateFileMapping()` 我有一组 Win32 应用程序，它们使用使用和创建的共享内存段共享信息`MapViewOfFile()`。其中一个应用程序是系统服务；其余的由登录用户启动。在 Windows XP 上，没有问题。我们将细分命名为“Global\Something”，一切都很好。

Vista（假设是 Windows 7）中的额外安全性似乎阻止了这种架构的工作。普通用户不允许在全局命名空间中创建（Win32 错误 5）对象。MSDN 指出，如果该帐户具有“创建全局”权限，那么一切都应该很好，但在实践中似乎并非如此。此外，Vista 的“完整性”功能似乎可以防止“低完整性”用户进程访问“高完整性”服务创建的共享内存对象。看起来我应该能够通过一些神奇的`SetSecurityDescriptorSacl()`咒语来解决这个问题，但我在学习说 sacl 时遇到了困难。

所以问题是：**在服务和普通用户进程之间使用共享内存段的正确方法是什么？**

为了抢占“关闭 UAC”的简单答案，我们处于一个相当封闭的环境中，这是不可能的。

编辑：服务和用户进程都需要对该段进行读/写访问。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-22T16:51:41.370

最简单的方法是让您的服务创建共享内存并在 CreateFileMapping 中指定一个 DACL，以授予普通用户对共享内存的读取访问权限。

普通用户没有创建全局权限，但服务可以有这个权限。如果您必须让您的用户创建共享内存，然后让服务对其进行探测，您可以有一个 IPC 方案，其中您的用户代码向包含文件映射句柄的服务发送一条消息，然后该服务将调用 DuplicateHandle 以获取参考它。这将要求您的服务以调试权限运行。

创建 DACL 的最简单方法是使用 ConvertStringSecurityDescriptorToSecurityDescriptor，它采用称为 SDDL 格式的字符串来指定 ACL。

[编写安全代码](https://rads.stackoverflow.com/amzn/click/com/0735617228)包含有关使用 SDDL 创建 DACL 的精彩章节。

```
// Error handling removed for brevity
SECURITY_ATTRIBUTES attributes;
ZeroMemory(&attributes, sizeof(attributes));
attributes.nLength = sizeof(attributes);
ConvertStringSecurityDescriptorToSecurityDescriptor(
         L"D:P(A;OICI;GA;;;SY)(A;OICI;GA;;;BA)(A;OICI;GR;;;IU)",
         SDDL_REVISION_1,
         &attributes.lpSecurityDescriptor,
         NULL);

CreateFileMapping(INVALID_HANDLE_VALUE, &attributes,
              PAGE_READWRITE, sizeHigh, sizeLow, L"Global\\MyObject");

LocalFree(attributes.lpSecurityDescriptor); 
```

“D:P(A;OICI;GA;;;SY)(A;OICI;GA;;;BA)(A;OICI;GR;;;IU)”指定 DACL。D:P 表示这是一个 DACL（而不是 SACL ......你很少使用 SACL）后跟几个 ACE 字符串来控制谁可以访问。每个都是 A（允许）并允许对象并包含继承 (OICI)。第一个授予系统（SY）和管理员（BA，内置管理员）所有访问权限（GA - 全部授予）。最后一个授权读取 (GR) 给交互式用户 (IU)，它们是实际登录到会话的用户。

完成此操作后，普通用户应该能够调用 OpenFileMapping 来获取共享映射的句柄，并能够将其映射到他们的进程中。由于普通用户对该对象的权限有限，因此他们必须确保打开它并将其映射为只读访问。

如果用户需要写入权限，您可以将 GR 替换为 GWGR。请注意，这并不安全——有限的用户将能够在您的服务正在读取并尝试解析信息时修改共享内存，从而导致您的服务崩溃。

# mysql - 如何通过查询在 MySQL 中获取数据库结构

> ID：898688
> 
> 赞同：198
> 
> 时间：2009-05-22T16:14:12.563
> 
> 标签：mysql

是否有可能以某种方式获得 MySQL 数据库的结构，或者只是一些带有简单查询的表？

或者还有其他方法，我该怎么做？

* * *

## 回答 #1

> 赞同：291
> 
> 时间：2009-05-22T16:18:43.907

我认为你所追求的是[`DESCRIBE`](http://dev.mysql.com/doc/refman/4.1/en/describe.html)

```
DESCRIBE table; 
```

你也可以使用[`SHOW TABLES`](https://dev.mysql.com/doc/refman/5.0/en/show-tables.html)

```
SHOW TABLES; 
```

获取数据库中表的列表。

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2009-05-22T17:57:18.867

要将整个数据库结构作为一组[CREATE TABLE](http://dev.mysql.com/doc/refman/5.1/en/create-table.html)语句，请使用[mysqldump](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)：

```
mysqldump database_name --compact --no-data 
```

对于单个表，在 mysqldump 中的 db name 后面添加表名。使用 SQL 和[SHOW CREATE TABLE](http://dev.mysql.com/doc/refman/5.1/en/show-create-table.html)得到相同的结果：

```
SHOW CREATE TABLE table; 
```

或者，如果您更喜欢列列表，请[描述：](http://dev.mysql.com/doc/refman/5.1/en/describe.html)

```
DESCRIBE table; 
```

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2009-05-22T16:20:20.567

看看`INFORMATION_SCHEMA`。`TABLES`桌子。它包含有关所有表的元数据。

例子：

```
SELECT * FROM `INFORMATION_SCHEMA`.`TABLES`
WHERE TABLE_NAME LIKE 'table1' 
```

与其他方法相比，此方法的优点是您可以轻松地将上述查询用作其他查询中的子查询。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2009-05-22T16:18:37.370

使用这个：

```
SHOW CREATE TABLE `users`; 
```

将为您提供该表的[DDL](http://en.wikipedia.org/wiki/Data_Definition_Language)

```
DESCRIBE `users` 
```

将列出该表中的列

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2013-12-22T12:47:34.603

```
SELECT *
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE TABLE_SCHEMA = 'test' AND TABLE_NAME ='products'; 
```

`Table_schema`数据库名称在哪里

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-05-22T16:20:09.617

这就是[SHOW CREATE TABLE](http://dev.mysql.com/doc/refman/5.1/en/show-create-table.html)查询。您也可以查询[SCHEMA TABLES](http://dev.mysql.com/doc/refman/5.0/en/information-schema.html)。

```
SHOW CREATE TABLE YourTableName; 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2013-02-20T16:11:06.687

我发现有用的第一个答案的变体

打开您的命令提示符并输入（您不必登录到您的 mysql 服务器）

```
mysqldump -hlocalhost -u<root> -p<password>  <dbname>  --compact --no-data > </path_to_mydump/>mysql.dmp 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2021-04-18T14:47:53.120

您可以选择以下任一命令。它们都或多或少相同：

`SHOW CREATE TABLE TABLE_NAME;`

`DESC TABLE_NAME;`

`SHOW FULL COLUMNS FROM TABLE_NAME;` *（对于列属性）*

`EXPLAIN TABLE_NAME;`

`DESCRIBE TABLE_NAME;`

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-07-11T10:32:08.213

在以下示例中，

> **`playground`**是数据库名，**`equipment`**是表名

另一种方法是使用[SHOW-COLUMNS:5.5](https://dev.mysql.com/doc/refman/5.5/en/show-columns.html)（也可用于`5.5>`）

```
$ mysql -uroot -p<password> -h<host> -P<port> -e \
    "SHOW COLUMNS FROM playground.equipment" 
```

和输出：

```
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(11)     | NO   | PRI | NULL    | auto_increment |
| type  | varchar(50) | YES  |     | NULL    |                |
| quant | int(11)     | YES  |     | NULL    |                |
| color | varchar(25) | YES  |     | NULL    |                |
+-------+-------------+------+-----+---------+----------------+ 
```

也可以使用[mysqlshow-client](https://dev.mysql.com/doc/refman/8.0/en/mysqlshow.html)（也可用于`5.5>`），如下所示：

```
$ mysqlshow -uroot -p<password> -h<host> -P<port> \
    playground equipment 
```

和输出：

```
mysqlshow: [Warning] Using a password on the command line interface can be insecure.
Database: playground  Table: equipment
+-------+-------------+-------------------+------+-----+---------+----------------+---------------------------------+---------+
| Field | Type        | Collation         | Null | Key | Default | Extra          | Privileges                      | Comment |
+-------+-------------+-------------------+------+-----+---------+----------------+---------------------------------+---------+
| id    | int(11)     |                   | NO   | PRI |         | auto_increment | select,insert,update,references |         |
| type  | varchar(50) | latin1_swedish_ci | YES  |     |         |                | select,insert,update,references |         |
| quant | int(11)     |                   | YES  |     |         |                | select,insert,update,references |         |
| color | varchar(25) | latin1_swedish_ci | YES  |     |         |                | select,insert,update,references |         |
+-------+-------------+-------------------+------+-----+---------+----------------+---------------------------------+---------+ 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-03-09T14:43:39.423

`COLUMN_NAME` 从中选择`INFORMATION_SCHEMA`。`COLUMNS` WHERE `TABLE_SCHEMA`='bodb' AND `TABLE_NAME`='abc';

适用于获取所有列名

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-06-15T06:38:31.967

如今，人们使用`DESC`而不是`DESCRIPTION`. 例如：- `DESC users;`

# .net - 任何语言的所有国家列表？

> ID：898694
> 
> 赞同：19
> 
> 时间：2009-05-22T16:15:14.297
> 
> 标签：.net, vb.net, localization

> **可能重复：**
> [我在哪里可以获得所有国家/城市的列表以填充列表框？](https://stackoverflow.com/questions/1788950/where-can-i-get-a-list-of-all-countries-cities-to-populate-a-listbox)

我有点进退两难，我需要一份所有德语国家名称的列表。我可以使用以下代码获取英语的此信息，但我不知道如何为德语做到这一点。有任何想法吗？

```
 Dim countries As Generic.List(Of String) = New Generic.List(Of String)
     For Each ci As Globalization.CultureInfo In Globalization.CultureInfo.GetCultures(Globalization.CultureTypes.AllCultures And Globalization.CultureTypes.NeutralCultures)
         Dim ri As Globalization.RegionInfo = New Globalization.RegionInfo(ci.LCID)
         countries.Add(ri.EnglishName)
 Next ci 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-25T12:03:47.607

Unicode 联盟维护几乎所有语言的语言环境翻译列表，当然包括德语。数据存储在非常简单的 XML 文件中。

从 Unicode Consortium 站点下载[此 zip 文件](http://unicode.org/Public/cldr/1.7.0/core.zip)（核心[CLDR](http://cldr.unicode.org/index/downloads)数据）并提取 de.xml。所有你想要的（以及更多）都在那里。

国家：XPATH=`/ldml/localeDisplayNames/territories/territory`

当您需要另一种语言的信息时，只需从 zip 文件中选择匹配的 xml 文件（例如：French = fr.xml）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T16:18:47.510

从 MSDN 中，评论说“获取国家/地区的全名，使用 .NET Framework 的本地化版本的语言”用于属性 DisplayName。

如果您有德语 .net 框架，它应该是德语的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T16:17:15.107

Deutsche Nationalbibliothek 有一份符合 ISO 3166 的清单：

> [http://www.d-nb.de/standardisierung/pdf/laendercodes_alph.pdf](http://www.d-nb.de/standardisierung/pdf/laendercodes_alph.pdf)

可以从 ISO 获得带有英文名称的列表：

> [http://www.iso.ch/iso/country_codes/iso_3166_code_lists.htm](http://www.iso.ch/iso/country_codes/iso_3166_code_lists.htm)

更新：使用 .NET Framework 的德语本地化，您可以使用该类的[`DisplayName`](http://msdn.microsoft.com/en-us/library/system.globalization.regioninfo.displayname.aspx)属性`RegionInfo`来获取本地化的德国国家名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T16:21:54.857

快速谷歌搜索显示[此页面](http://www.foreignword.com/countries/German.htm)，其中包含相当多的德语国家列表。该列表在网站上以 15 种语言提供。如果您不想依赖框架语言，您可能可以从中抓取数据并制作一个 XML 文件以动态加载。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T17:08:57.887

维基百科有一个[主权国家列表](http://en.wikipedia.org/wiki/List_of_Countries)。由于此 wiki 页面已被翻译成几乎任何语言，我想您可以在此处截屏信息。

# subsonic - 使用 OR 语句查询数据库的最佳方法

> ID：898702
> 
> 赞同：0
> 
> 时间：2009-05-22T16:17:26.353
> 
> 标签：subsonic

我正在尝试将以下 sql 脚本创建到可以与集合一起使用的亚音速查询中：

```
Select * from tableA
where tableA.InvoiceID = @Invoice
and tableA.VersionID = @VersionID
and tableA.ActiveDate >= GetDate()
and (tableB.InActiveDate is null or tableB.InActiveDate <= GetDate()) 
```

这是我当前的代码：

```
orders = new OrdersCollection();
query = new SubSonic.Query(Tables.Orders);
query.WHERE("InvoiceID", Invoice.InvoiceID);
query.AND("VersionID", version.VersionID);
query.AND("ActiveDate", SubSonic.Is.LessThanOrEqualTo(System.DateTime.Now.ToString()).Value);
query.AND("InActiveDate", SubSonic.Comparision.Is, null).OR("InActiveDate", SubSonic.Is.GreaterThanOrEqualTo("System.DateTime.Now.ToString()).Value); 
```

query.CommandTimeOut = intSubSonicTimeOut; partXrefColl.Load(FilePartXref.FetchByQuery(query));

我认为我遇到的问题是对日期和 OR 语句的评估。我仅使用 InvoiceID 和 VersionID 进行了尝试，并将数据返回到集合中。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T14:46:38.263

经过一些调试后，我能够使用以下内容完成查询：

```
 OrderColl =  DB.Select().From(Orders.Schema)
                    .Where(Orders.Columns.VersionID).IsEqualTo(version.VersionID)
                    .And(Orders.Columns.FulfillNumber).IsEqualTo(invoice.InvocieID)
                    .And(Orders.Columns.ActiveDate).IsLessThanOrEqualTo(DateTime.Now)
                    .AndExpression(Orders.Columns.InactiveDate).IsNull()
                    .Or("InActiveDate").IsGreaterThanOrEqualTo(DateTime.Now)
                    .ExecuteAsCollection<OrdersCollection>(); 
```

感谢大家的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T17:27:55.647

假设您使用的是 SubSonic 2.1 或更高版本，您可以将该查询编写为：

```
OrdersCollection orders = DB.Select.From(Orders.Schema)
  .Where(Orders.Columns.InvoiceID).IsEqualTo(1)
  .And(Orders.Columns.VersionID).IsEqualTo(1)
  .And(Orders.Columns.ActiveDate).IsLessThanOrEqualTo(DateTime.Now)
  .AndExpression(Orders.Columns.InActiveDate).IsNull()
  .Or(Orders.Columns.InActiveDate).IsGreaterThanOrEqualTo(DateTime.Now)
  .ExecuteAsCollection<OrdersCollection>(); 
```

AndExpression 嵌套后会导致 Or 约束

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T16:20:14.903

您的 SQL 显示“小于或等于”运算符 (<=)，但您的代码显示 GreaterThanOrEqualTo()。逻辑的反转会导致您的问题吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T16:26:17.617

抱歉，sql 查询的正确语法应该是：

```
Select * from tableA
where tableA.InvoiceID = @Invoice
and tableA.VersionID = @VersionID
and tableA.ActiveDate <= GetDate()
and (tableB.InActiveDate is null or tableB.InActiveDate >= GetDate()) 
```

代码应该是：

```
orders = new OrdersCollection();
query = new SubSonic.Query(Tables.Orders);
query.WHERE("InvoiceID", Invoice.InvoiceID);
query.AND("VersionID", version.VersionID);
query.AND("ActiveDate", SubSonic.Is.LessThanOrEqualTo(System.DateTime.Now.ToString()).Value);
query.AND("InActiveDate", SubSonic.Comparision.Is, null).OR("InActiveDate", SubSonic.Is.GreaterThanOrEqualTo("System.DateTime.Now.ToString()).Value); 
```

orders.Load（Invoices.FetchByQuery（查询）；

对困惑感到抱歉。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T17:10:40.520

胡乱猜测：

“SubSonic.Comparision.Is, null”没有映射到“IS NULL”，而是映射到“= NULL”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T18:19:48.907

亚当完全有它 - 你缺少的是它的表达式部分，它是用 AndExpression 给出的

# c# - 无法在 WPF 中设置 DialogResult

> ID：898708
> 
> 赞同：30
> 
> 时间：2009-05-22T16:18:06.293
> 
> 标签：c#, wpf, modal-dialog, dialogresult

我使用调用窗口中的 ShowDialog() 显示 WPF 窗口。窗口打开并且是模态的，如预期的那样。但是，在对话框窗口中的“确定”和“取消”按钮的单击事件中，我分别设置了 this.DialogResult = true （或 false），并且没有设置该值。窗口按预期关闭，但 DialogResult 仍然为空。

这是 WPF 中的错误吗？或者是否有原因无法设置 DialogResult 属性但不会引发异常？该窗口未托管在浏览器中。

调用窗口中的代码：

```
Window2 win = new Window2();
bool? result = win.ShowDialog();
if (result.HasValue && result.Value) {
   //never gets here because result is always null
} 
```

对话窗口中的代码：

```
this.DialogResult = true; 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-24T23:36:37.813

`DialogResult`是一个可为空的布尔值。但是，您不必强制转换它来获得它的价值。

```
bool? result = myWindow.ShowDialog();
if (result ?? false)
{
  // snip
} 
```

这 ？？如果结果为空，则设置要返回的默认值。更多信息： [使用 Nullable 类型（C# 编程指南）](http://msdn.microsoft.com/en-us/library/2cf62fcy.aspx)

至于最初的问题，我唯一一次看到并追踪到这个问题是在设置 DialogResult 和关闭窗口之间设置窗口时。不幸的是，我能提供的唯一建议是让您逐步检查代码并检查操作的顺序。我相信我通过设置`DialogResult`然后显式关闭窗口来“修复”它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-22T16:28:55.060

那么首先你必须考虑到它返回一个可为空的布尔值（布尔值？），所以为了比较它或将它设置为另一个变量，你必须将它转换为一个普通的布尔值

```
bool result = (bool)myWindow.DialogResult; 
```

至于它是空的......我不明白为什么会发生这种情况，除非它在设置为真或假之后以某种方式被设置回空。你能显示你的代码吗？

编辑：

你的代码对我来说很好，这就是我在第二个窗口中的内容：

```
private void button2_Click(object sender, RoutedEventArgs e)
{
    this.DialogResult = false;
}

private void button1_Click(object sender, RoutedEventArgs e)
{
    this.DialogResult = true;
} 
```

在 Window1 中：

```
private void window1_Loaded(object sender, RoutedEventArgs e)
{
    Window2 win = new Window2();

    bool? result = win.ShowDialog();

    if (result.HasValue && result.Value)
    {
        //it DID get here
    }
} 
```

有什么大的区别吗？

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-11-08T07:21:46.207

我刚刚遇到了**完全相同**的问题，这似乎是由我重写 OnClosing() 方法引起的。我需要重写 OnClosing() 以阻止用户通过关闭 (X) 按钮关闭模式窗口。

当我注释掉 OnClosing() 方法时，问题就消失了，DialogResult 返回了预期的 true 或 false 值，如设置的那样。

感兴趣的是我的按钮单击处理程序和 OnClosing 方法：

```
private void AlternateButton_Click(object sender, RoutedEventArgs e)
{
    this.DialogResult = false;
    buttonHasBeenClicked = true;
    this.Close();
}

private void DefaultButton_Click(object sender, RoutedEventArgs e)
{
    this.DialogResult = true;
    buttonHasBeenClicked = true;
    this.Close();
}

protected override void OnClosing(System.ComponentModel.CancelEventArgs e)
{
    base.OnClosing(e);
    if (!buttonHasBeenClicked)
    {
        // Prevent the user closing the window without pressing one of the buttons.
        e.Cancel = true;
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-12-11T03:48:35.963

我也遇到过这个问题，我发现解决它的唯一方法是在我的类中使用这个代码：

```
public new bool? DialogResult { get; set; } 
```

在设置我的 DialogResult 之后，它对我有用！（非常奇怪的问题）。这是我使用的代码：

```
cmdCancel = new RelayCommand(() => { DataContact.Reload(); this.DialogResult = false; this.Close(); }); 
```

并打开我的对话框：

```
public static MessageBoxResult ShowQuestionYesNo(string message)
        {
            POLMessageBox w = new POLMessageBox("سوال", MessageBoxType.QuestionYesNo, message);
            w.ShowDialog();
            var b = w.DialogResult;
            if (b == true) return MessageBoxResult.Yes;
            if (b == false) return MessageBoxResult.No;
            return MessageBoxResult.No;
        } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-12T15:07:49.973

在设置 DialogResult 之前关闭窗口吗？您应该发布按钮事件处理程序的全部内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-11T19:06:32.813

我也遇到了这个问题。事实证明，我在 IF 语句的大括号内设置了 DialogResult，因此（尽管看起来很奇怪）导致了错误。删除这一行后，问题就解决了。

```
private void OKButton_Click(object sender, RoutedEventArgs e)
    {
        if (!string.IsNullOrEmpty(startBlockPosBox.Text))
        {
          .. do stuff ..
        }
        else
        {
          .. do stuff ..
          DialogResult = true; // this line caused the problem
        }

        DialogResult = true;
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-17T16:27:52.790

问题是由于表单的生命周期：

**对话事件** private void _loginViewModel_LoginEvent(object sender, LoginViewModel.LoginEventArgs e) { DialogResult = true; this.Close(); }

**作品：**

```
var login = new Login();
var result = login.ShowDialog(); 
```

**不工作：**

```
var result = new Login().ShowDialog(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-10T22:07:30.057

我在对话框窗口页面中有以下内容。（对话框窗口.xaml.cs）

```
 private void dlgWindowYesButton_Click(object sender, RoutedEventArgs e)
    {
        this.DialogResult = true;
        this.Close();
    }

    private void dlgWindowNoButton_Click(object sender, RoutedEventArgs e)
    {
        this.DialogResult = false;
        this.Close();
    } 
```

在调用页面中，我使用了这样的对话框窗口：

```
dialogwindow dWinObj = new dialogwindow();
if(dWinObj.ShowDialog().Value == true)
{
  //perform the operation when the user clicks "Yes"
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-04T10:45:12.763

我通过在 add和return`this.close()`之后添加解决了这个问题。`this.DialogResult=true``window.ShowDialog()``true`

```
private void Button1_Click(object sender, RoutedEventArgs e)
{
    this.Close();
    this.DialogResult = true;
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-06-16T22:43:12.267

我有一个类似的问题，但我的问题来自我结束语中的代码。我试图在窗口关闭之前 Dispose() 一个 List，然后将 List<> 属性设置为 null ......在我的 set 属性方法中遵循笨拙的解决方法，之后一切正常：

```
 List<SettingItem> settingItems;
    public IEnumerable<SettingItem> Settings
    {
        get
        {
            return settingItems.OrderBy(t => t.Name).AsEnumerable();
        }
        set
        {
            if (value == null)
            {
                settingItems.Clear();
            }
            else
            {
                settingItems = value.ToList();
            }
        }
    } 
```

# sitecore - 以编程方式在媒体库下创建图像

> ID：898719
> 
> 赞同：4
> 
> 时间：2009-05-22T16:20:50.397
> 
> 标签：sitecore, sitecore6

如何以编程方式在媒体库下创建图像？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T22:08:07.397

站点核心 6？此代码假设如此

```
TemplateItem templateItem = Sitecore.Context.Database.GetTemplate("system/media/unversioned/flash");
Item parentItem = Sitecore.Context.Database.GetItem( "/sitecore/media library", Language.Parse("en) );
var mco = new MediaCreatorOptions();
mco.Database = Sitecore.Context.Database;
mco.Language = Sitecore.Context.Language;
mco.Versioned = false;
mco.Destination = string.Format( "{0}/{1}", parentItem.Paths.FullPath, "my media item name" );
mco.FileBased = Settings.Media.UploadAsFiles;

var mc = new MediaCreator();
newItem = mc.CreateFromFile( "path to your media file", mco ); 
```

这就是它的本质。显然（或不是？），切换模板名称以匹配您要上传的内容，并插入适当的路径。如果您上传的内容来自实时站点 - 也许考虑将硬连线上传到“主”数据库而不是上下文数据库（这将是“网络”）。

希望这可以帮助 ：-）

# visual-studio-2008 - Microsoft ISA 服务器 - 筛选器 - 从 Visual Studio 2005 转换到 Visual Studio 2008 时出现错误

> ID：898721
> 
> 赞同：0
> 
> 时间：2009-05-22T16:21:09.833
> 
> 标签：visual-studio-2008, com

我们有一个用 C++ 编写的 Microsoft ISA Server 2006 过滤器。该代码最初是使用 Visual Studio 2005 和 hunky dory 编译的。由于我们使用 Visual Studio 2008 处理其他所有内容，因此我尝试将此项目转换为 Visual Studio 2008。转换向导运行良好并且代码编译正确。

但是，当我尝试将输出 dll 部署到服务器上时，出现以下错误

ISA 服务器未能加载 Web 过滤器 DLL“C:\Program Files\Microsoft ISA Server\”。

部署

*   我使用 regsvr32 \u 注销了原始 dll
*   使用 regsvr32 注册了新的 dll
*   启动windows防火墙服务。

我怀疑这个错误是因为 Visual Studio 2008 对 COM dll 的处理。有没有人以前见过这个错误。

干杯，哈米德

-

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T17:25:55.853

这可能是因为您需要部署新的 VS 2008 C 运行时自由。
[这是 SP1 版本 (x86) 的链接](http://www.microsoft.com/downloads/details.aspx?FamilyID=a5c84275-3b97-4ab7-a40d-3802b2af5fc2&displaylang=en)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-19T06:51:38.187

在 ISA 服务器中安装过滤器的命令

* * *

净停止 fwsrv regsvr32.exec

## 网络启动 fwsrv

从 ISA 服务器卸载过滤器的命令

* * *

net stop fwsrv regsvr32.exe /u /i net start fwsrv

# django - 在管理员中更改折叠字段集行为的最佳方法？

> ID：898724
> 
> 赞同：0
> 
> 时间：2009-05-22T16:21:51.253
> 
> 标签：django, django-admin

当管理字段集被赋予“collapse”类时，它会使用由 CollapsedFieldset.js 安装的 Show/Hide 链接呈现，该链接会折叠或展开它。

在所有出现折叠类的情况下，我希望链接是整个字段集框（或该维度的 div），而不仅仅是“显示”一词。

“覆盖”默认管理 Javascript 文件的最佳方法是什么？如果模板stacked.html中有一个extrahead块，似乎可以这样做，但没有——可能是因为在使用stacked.html时，head已经写好了？

我可以只修改管理 Javascript 文件，但这似乎不对。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T14:08:17.303

您可以将自己的 Javascript 添加到页面中，该页面仅删除由 CollapsedFieldset.js 创建的链接并根据需要创建链接。所需的 JS 不会超过几行 jQuery，理想情况下，您应该将其包含在您[在 ModelAdmin 子](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.form)类中使用的自定义 Form 子类的[内部 Media 类](http://docs.djangoproject.com/en/dev/topics/forms/media/#media-on-forms)中（尽管它需要出现在 CollapsedFieldsets.js 和我之后没有检查是否会）。

另一种选择是完全忽略 class="collapse" 并仅将您自己的类应用于字段集，然后包含您自己的 Javascript（通过内部 Media 类，如上所述）复制 CollapsedFieldset.js 的所有功能，除了完成你想要的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-09T12:21:52.080

我在这里发布了一个相关的答案：

[Django Admin - 将折叠添加到字段集中，但让它开始展开](https://stackoverflow.com/questions/1766864/django-admin-add-collapse-to-a-fieldset-but-have-it-start-expanded/8063833#8063833)

您可以轻松修改此示例以动态重构

```
<h2><a> 
```

构造为

```
<a><h2> 
```

一个。

# c# - 为什么这个捕获所有块实际上不能捕获所有

> ID：898726
> 
> 赞同：7
> 
> 时间：2009-05-22T16:22:09.880
> 
> 标签：c#, .net, directoryservices, roleprovider

代码相当简单 --- 问题是 groupPath 字符串中有一个无效字符（准确地说是“/”）。

我正在尝试做的（至少作为权宜之计）是跳过我无法获得 cn 的 DirectoryEntries --- 不管为什么。

但是，当我运行此代码时，catch 块没有运行，而是得到：服务器无法运行。和未处理的 System.Runtime.InteropServices.COMException。

为什么 catch 块不会捕获此异常。

```
try
{
    using (DirectoryEntry groupBinding = new DirectoryEntry("LDAP://" + groupPath))
    {
        using (DirectorySearcher groupSearch = new DirectorySearcher(groupBinding))
        {

            using (DirectoryEntry groupEntry = groupSearch.FindOne().GetDirectoryEntry())
            {
                results.Add(string.Format("{0}", groupEntry.Properties["cn"].Value.ToString()));
            }
        }
    }
}
catch
{
    Logger.Error("User has bad roles");
} 
```

补充观察：代码实际上是在一个自定义的 RoleProvider 中，奇怪的是，如果我在一个简单的 winforms 应用程序中引用这个提供程序，并使用相同的输入调用这个相同的方法，catch 块完全按照它的假设做。我认为这表明关于 .NET 异常与 COM 异常的建议答案并不准确。尽管我不明白为什么从 WebDev 服务器执行此代码时无法捕获

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T16:53:45.033

当您不指定要捕获的内容时，它默认为 .NET 异常。您的异常在 COM 中，其中 .NET 未设置为捕获异常。处理这个问题的最好方法是捕获 COM 异常，它应该看起来像这样：

```
 try
    {

    }
    catch (System.Runtime.InteropServices.COMException COMex)
    {

    }
    catch (System.Exception ex)
    {

    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T19:53:39.680

原因有以下三个：

1.  运行时存在错误
2.  应用程序和/或线程作为执行的某些代码的一部分而结束
3.  你没有看到全貌

就我个人而言，我投了 3 票，并且我进行过无数次调试会话，我想知道为什么某些代码没有处理我的异常，而实际上是 Visual Studio 被配置为停止所有抛出的异常，无论它们是否是抓住与否。

您是否尝试过仅要求程序继续在调试器中运行并查看它是否最终进入 catch 块？

此外，检查 Visual Studio 中的设置，转到“调试”->“异常”对话框，并检查是否选中了任何“抛出”复选框。如果你有，那可能是你的问题。

当然，如果你在运行时看到这个问题，没有附加调试器，那我就不知道了，除了上面的第 1 点和第 2 点。

当然，总有第 4 点：未知。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T19:48:48.490

从该 try 块中抛出的 COMException 将被 catch 块捕获并吞下。

休息一下，给自己喝杯咖啡，在“Logger.Error...”行设置一个断点，然后再试一次。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T20:14:59.013

除了 COMException 之外，还有一些**不会**被捕获的异步异常，例如：

*   内存不足异常
*   StackoverflowException（不，这不是与本网站相关的笑话 :)）
*   线程中止异常

你确定不是这样吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-27T21:36:35.800

I had a similar problem. I was invoking a VB6 COM object that raised an error. The actual exception type turned out to be System.Reflection.TargetInvocationException. The innerException was set to the COMException. I ended up catching the System.Reflection.TargetInvocationException and checking the innerException

# pdf - 文档模板引擎

> ID：898728
> 
> 赞同：7
> 
> 时间：2009-05-22T16:23:15.760
> 
> 标签：pdf, templates, ms-word, pdf-generation, document

我需要选择一个好的模板引擎来在我们的应用程序中生成文档。要求是：

*   至少生成 Microsoft Word 和 PDF
*   良好的模板功能，包括支持简单的可替换参数、数组/列表和层次结构（如果可能）
*   允许包含自定义图形
*   理想情况下，模板应该可以使用 Microsoft 应用程序或其他用户友好的等效程序进行编辑

任务是从系统中提供一些数据结构并从中制作一个漂亮的文档。示例包括报告、业务提案、产品愿景等。欢迎提出想法:)

一种方法是自己写一个，但也许有一些开箱即用的东西，不一定是免费的。如果它可以是跨平台的，从技术上讲是最好的，但仅限 Windows 也可以，也是最后的手段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T18:00:36.633

人们正在使用[docx4j](http://dev.plutext.org/trac/docx4j)来做这种事情。（免责声明：这是我的项目）

docx4j 为您提供了创建 docx 文档（与旧的二进制文件相反）和输出到 PDF（虽然是 ymmv）的工具。

对于商业文档生成，请查看 Exari 和 Thunderhead 之类的工具。

# c++ - 如何通过 C++ 中的位运算找到素数？

> ID：898731
> 
> 赞同：4
> 
> 时间：2009-05-22T16:23:42.423
> 
> 标签：c++, math, primes

如何通过 C++ 中的位运算找到素数？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-22T17:12:39.380

我认为做到这一点的方法是不要像我们通常那样将位集视为其数字表示，而是将其视为数字列表。所以位集

```
1111 
```

将代表数字 1、2、3 和 4。现在，如果我们说“1”代表素数，“0”代表非素数，我们可以如下制作筛子。

将所有位设置为 1（我将使用 16 位表示整数 1 到 16）

```
1111 1111 1111 1111 
```

我知道一个不是素数，所以我将它设置为零。

```
0111 1111 1111 1111 
```

现在，我知道我遇到的下一个“1”代表一个素数，但根据定义，该数字的所有倍数*都不*是素数，所以我不理会下一个“1”，但将其所有倍数设置为“0”。由于下一个“1”代表数字 2，因此我每隔一比特置零。

```
0110 1010 1010 1010 
```

这种方法相对于其他方法的好处是，当我遍历其余的位时，我不需要检查每个位是否可以被 2 整除（所以没有`if i % 2 == 0`必要）。我可以继续将索引增加 2，我知道我将永远落在非素数上。

现在我再次对遇到的下一个“1”做同样的事情（下一个从我识别的最后一个素数开始的素数，2）。我知道它是素数，因为它不能被它下面的任何数字整除。我知道它的所有倍数都是素数，所以由于它位于第三位，我将后面的每三个位设置为“0”。其中一些已经是“0”，因为它们也是 2 的倍数。没关系，只需将它们保留为“0”。

```
0110 1010 0010 1000 
```

您遇到的下一个“1”是第五位。现在你*可以*继续直到你到达终点，但由于 5 大于我开始的位数的平方根，我知道我不会再找到任何复合了，所以我完成了。

* * *

After a little more searching I found a really good implementation example in Deitel & Deitel's [C++ How to Program](http://books.google.com/books?id=HhGB8fOiUy8C&pg=RA2-PA132&lpg=RA2-PA132&dq=test+if+number+is+prime+using+bitset&source=bl&ots=wOeGo29Tfg&sig=QxFsYkfB9dLyOCVP6SaQ6ihZzl4&hl=en&ei=OO0XSrjcLaOxtgei3-X2DA&sa=X&oi=book_result&ct=result&resnum=4#PRA2-PA133,M1). They also provide good explanations of the algorithm and code.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-22T16:26:21.173

尝试使用 bitset实现[素筛。](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)该算法只需要存储某个数是否为质数。一点就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T16:28:17.867

如果你不知道，那么从别人那里得到答案是一种作弊，不是吗？告诉你不认识的人。在面试中不知道每个问题是可以的。被发现作弊或抄袭看起来比说“我不知道”要糟糕得多。解释你如何知道素数是什么，解释素数的一些性质，解释你对位运算的了解。如果你不知道这些事情，那么也许这份工作不适合你？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-22T16:27:39.973

我找到了这个 c# 代码，我相信你可以很好地阅读它。

```
using System;
using System.Collections.Generic;
using System.Text;

namespace eratosthenes
{
    class Program
    {
        static void Main(string[] args)
        {
            int n = 100;
            bool[] primes = new bool[n];
            for (int i = 2; i < n; i++) {
                primes[i]=true;
            }

            for (int i = 2; i < n; i++) {
                if (primes[i] == true) {
                    for (int j = i * i; j < n; j=j+i)
                    {
                        primes[j] = false;
                    }
                    Console.WriteLine(i);
                }
            }
            Console.ReadLine();
        }
    }
} 
```

[德语 wikibooks 页面](http://de.wikibooks.org/wiki/Primzahlen:_Programmbeispiele#C.23)的链接。

# c# - How do you set the text direction for a TextTable Cell in OpenOffice?

> ID：898739
> 
> 赞同：1
> 
> 时间：2009-05-22T16:24:54.357
> 
> 标签：c#, python, openoffice.org, openoffice-writer, uno

I want to set the text direction for some cells in a TextTable so that they are vertical (i.e., the text is landscape instead of portrait). You can do this in Writer by selecting the cell(s), and going to: Table - Text Properties - Text Flow - Text Direction

However, I cannot figure out how to do this through the API. I tried using CharRotation, but it does not behave the right way. CharRotation simply takes the text, and rotates it (without adjusting any formatting). The text I am dealing with is formatted by tab stops, and does not behave correctly when rotated this way.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-02T23:09:47.323

I finally figured this out after all these months!

You have to set the "WritingMode" property for the cell. In C#:

```
XCell cell = table.getCellByName(cellName);
((XPropertySet)cell).setPropertyValue("WritingMode", new Any((short) 
WritingMode.TB_RL)); 
```

I haven't tried it in python yet, but I suppose it would be something like this:

```
cell = table.getCellByName(cellName)
cell.WritingMode = 2 
```

If you're using a statically typed language, make sure you cast it to a short. Doing `typeof(WritingMode)` won't work, for some odd reason.

See [this issue](http://www.openoffice.org/issues/show_bug.cgi?id=106535) in the OOo bug tracker.

# sql-server - 如何将数据从 SQL Server 2005 导入和导出为 XML 格式？

> ID：898741
> 
> 赞同：2
> 
> 时间：2009-05-22T16:25:18.537
> 
> 标签：sql-server, xml, import, export

我对 SQL Server 2005 如何支持 XML 文件的导入和导出感到非常困惑。我在想BCP是要走的路。然而，在阅读了所有文档之后，似乎没有办法只获取一个常规表并将其导出为 XML 格式。我问的原因是我正在与一个客户端合作，它将以 XML 格式向我发送数据更新。我们都有相同的数据库，具有相同的结构。他向我发送了示例 XML 文件。我假设会有一些非常简单的方法来导入数据文件，但我想不通。谁能帮助我了解如何获取 XML 文件并将数据导入现有表？它应该很简单，因为 XML 文件是从具有完全相同结构的表中生成的。

谢谢，科里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-08T19:50:42.197

为什么首先使用 XML 作为交换格式？

如果您在双方都有完全相同的数据模型，纯文本文件或 BCP 文件将完全满足您的需求，并且大小也更小（即提取和加载更快）！

仅仅因为 XML 是“最先进的”，它并不意味着它总是最好的选择！当然，如果您认为您在未来某个时间需要与不共享相同数据模型甚至相同平台或接口的第三方交换数据，情况当然会有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T22:08:06.573

SQL Server 2005 allows to store XML data in two ways: - As a Rowset & - An XML Column

**Storing XML Data in a Rowset**

*   If your client has sent you data as an XML document and you need to store this data in a database table, first you need to "shred" the XML data. SQL Server allows you to shred XML data by using the **OPENXML** function and its related stored procedures.

Shredding XML document involves the following tasks:

*   i) Parse the XML document SQL server 2005 provides the **`sp_xml_preparedocument`** stored procedure to parse the xml document. This stored procedure reads the xml document and parses it with the MSXML parser. The parsed document is an internal tree representation of various nodes in the xml doc such as elements,attributes,text and comments.
*   ii)Retrieve the rowset from the tree. Now you need to extract the data from the available xml data. You use **openxml** function for this purpose and to generate an in-memory rowset from the parsed data. Syntax: `openxml(idoc int[in],rowpattern nvarchar[in],[flags byte[in]]) [WITH (SchemaDeclaration | TableName)]`
    idoc- specifies the doc handle of the internal tree representation of xml doc rowpattern- specifies the XPath pattern used to identify the nodes to be processed as rows. flags- indicates the mapping that should be used between xml data and relational rowset, and how the spill-over column should be filled. It is optional and can have 0,1,2,3 to use default mapping, to retrieve attribute values, to retrieve element values and to retrieve both values respectively. SchemaDeclaration- specifies the rowset schema declaration for the columns to be returned by using a combination of column names, data types and patterns. TableName- specifies the table name that can be given instead of SchemaDeclaration, if a table with the desired schema already exists and no patterns are required.
*   iii)Store the data from the rowset. You can use the rowset created by **openxml** to store the data, in the same way that you would sue any other rowset. You can insert the rowset data into permanent tables in a database.
*   iv)Clear the memory. You need to release the memory where you stored the rowset. For this, you use the **`sp_xml_removedocument`** stored procedure.

For example, following is the data available in an XML doc:

```
 DECLARE @Doc int
    DECLARE @XMlDoc nvarchar(1000)
    SET @XMLDoc = N'<ROOT>
    <Customer CustomerID="JHO1" Name="Jack">
      <Order OrderID="1001" CustomerID="JH01"
             OrderDate="2009-07-04T00:00:00">
      <OrderDetail ProductID="11" Quantity="12"/>
      <OrderDetail ProductID="22" Quantity="10"/>
     </Order>
    </Customer>
<Customer CustomerID="SG01" Name="Steve">
     <Order OrderID="1002" CustomerID="SG01"
            OrderDate="2009-08-16T00:00:00">
    <OrderDetail ProductID="32" Quantity="3"/>
   </Order>
  </Customer>
</ROOT>' 
```

To view this xml data in a rowset, you need to execute the following statements:

**1.** Create internal representation of xml document `EXEC sp_xml_preparedocument @Doc OUTPUT, @XMLDoc`

**2.** Execute the following query to store the data in a table using OPENXML function:

```
INSERT INTO CustomerDetails
 SELECT *
 FROM openxml (@Doc, '/ROOT/Customer' , 1)
      WITH (CustomerID varchar(10),
            Name varchar(20) ) 
```

The data will be displayed as in the table:

* * *

```
CustomerID | Name    |
___________|_________|
JH01       | Jack    |
           |         | 
SG01       | Steve   |
___________|_________| 
```

**3.** Remove the internal tree from the memory by executing

```
EXEC sp_xml_removedocument @Doc 
```

You're done now.

I think this method would help rather than the other one, ie, storing xml data as XML Column.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T16:59:21.347

[将 XML 导入 SQL Server](https://stackoverflow.com/questions/688015/importing-xml-into-sql-server/688790#688790)

[在 SQL 中搜索 XML 列](https://stackoverflow.com/questions/697256/search-xml-column-in-sql/697379#697379)

您必须将 XML 解析为类似表格的格式。请记住：xml 只是文本，因此您必须告诉 SQL Server 数据类型是什么等。

没有一发的灵丹妙药`INSERT MyTable FROM File = 'bob.xml'`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T17:02:57.627

我假设客户端使用 FOR XML 将关系数据包装为 xml 文档？没有自动将 xml 分解回原始关系结构的方法，但如果原始 xml 生成也使用 XMLSCHEMA 指令，您应该能够以编程方式执行此操作。如果客户端包含此内容，则将生成一个 xml 模式，该模式描述了在 xml 实例中的哪个位置表示哪个列（及其类型）。不久前我开始使用这种方法，但从未完成。

# asp.net-mvc - ASP.NET MVC：在控制器方法执行后清除 TempData

> ID：898745
> 
> 赞同：6
> 
> 时间：2009-05-22T16:25:44.827
> 
> 标签：asp.net-mvc

根据我的阅读，放置在 TempData 中的信息将用于当前请求和下一个请求（以便您可以跨重定向传递信息）。问题是，如果我浏览到不重定向的控制器操作，TempData 中的信息仍将存在于下一个请求中。我正在使用 TempData 存储向用户显示的信息性消息，所以现在我也在第二个屏幕上获取第一个屏幕的消息。

一旦不再使用，控制器生命周期中是否有清除 TempData 的好时机？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T16:51:38.767

[如果您不重定向，请使用 ViewData 而不是 TempData](http://blogs.teamb.com/craigstuntz/2009/01/23/37947/ "ASP.NET MVC TempData 真的是 RedirectData")。您永远不需要手动清除 TempData。如果您仅在重定向时使用它，它将在正确的时间自动为您清除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T17:20:43.427

[如果您不使用POST-REDIRECT-GET](http://en.wikipedia.org/wiki/Post/Redirect/Get)，我认为您应该使用 ViewData 。但是如果你真的需要你上面描述的行为，你应该创建自己的自定义 TempDataProvider：

```
public class YourTempDataProvider : SessionStateTempDataProvider
{
    public override void SaveTempData(ControllerContext controllerContext, IDictionary<string, object> values)
    {
        bool redirecting = ...

        if(redirecting)
        {
            base.SaveTempData(controllerContext, values);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T17:23:41.567

除了自定义的 TempDataProvider 之外，我不会在这里寻找某个地方。但这很棘手。如果您想要其他控制器中的常规行为怎么办？我暂时先用 YAGNI 把它清理掉，然后在你需要清理的地方清理掉它。当你注意到一个模式时，你可以把它拉到某个常见的地方。

# ruby-on-rails - Rails 错误消息中的翻译属性（Rails 2.3.2，I18N）

> ID：898754
> 
> 赞同：7
> 
> 时间：2009-05-22T16:27:32.580
> 
> 标签：ruby-on-rails, internationalization

我在翻译文件中定义了翻译的属性和模型名称，Modelname.human_attribute_name(...) 返回正确翻译的属性名称，但错误消息中的属性名称未翻译。翻译错误消息中的属性名称需要什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-22T20:19:43.060

从有关该主题的[指南](http://guides.rubyonrails.org/i18n.html)中，您需要使用模型名称和属性名称正确设置本地化文件：

```
en: 
  activerecord: 
    models: 
      user: Dude 
    attributes: 
      user: 
        login: "Handle" 
```

由于这是 YAML，请确保您的所有“选项卡”实际上都是两个软空格。`User.human_name`然后你可以用and把它们弄出来`User.human_attribute_name(:login)`。

我没有把它当作福音——可能有一个错误。我测试了它，它工作正常。我制作了一个名为`Model`attribute的模型`title`。这是我的`fr.yml`文件片段`config/locales`：

```
fr:
  activerecord:
    models:
      model: "Sumfink"
    attributes:
      model:
        title: "Tiltile" 
```

这是相关的视图代码：

```
<h1>New <%= Model.human_name %></h1>
<% form_for(@model) do |f| %>
  <%= f.error_messages %>
  <%= Model.human_attribute_name("title") %><br />
  <%= f.text_field :title %>
  <%= f.error_message_on :title %>
... 
```

以及正确翻译输出的截图： http: [//screencast.com/t/et5FhVe1Gp](http://screencast.com/t/et5FhVe1Gp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-24T12:19:10.353

感谢 Ian，只是想补充一点，以便在验证失败的情况下突出显示标签，您需要这样编写：

```
 <%= f.label "title", Model.human_attribute_name("title") %><br /> 
```

出于某种原因，写它就像：

```
 <%= f.label "title" %><br /> 
```

不显示翻译。

# vbscript - VB 使用 WMI - 获取登录用户

> ID：898757
> 
> 赞同：3
> 
> 时间：2009-05-22T16:28:03.407
> 
> 标签：vbscript, wmi

如何使用带有 WMI 的 VB 脚本来获取已登录用户的数量。我的安装只能让一个用户登录，如果有多个用户登录（通过使用 Citrix 的终端服务），则需要报告错误。我对 Citrix 了解不多，但`Win32_LogonSession`with`LogonType = 10`似乎会返回各种垃圾（端口会话等）。我只需要用户...是否有任何 WMI 调用可以让我登录 Citrix 的用户数？下面是我的 VB 代码的片段：

```
Set objWMIService = _
    GetObject("winmgmts:" & "{impersonationLevel=impersonate}!\\" & _
    strComputer & "\root\cimv2") 
Set colComputer = _
    objWMIService.ExecQuery("Select * from Win32_LogonSession Where LogonType = 10") 
```

谢谢！-J.P

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T16:49:43.837

以下代码应该可以帮助您（`strComputer="."`用于本地计算机或`strComputer="MachineName"`）：

```
strComputer = "."   
Set objWMI = GetObject("winmgmts:" _ 
              & "{impersonationLevel=impersonate}!\\" _ 
              & strComputer & "\root\cimv2") 

Set colSessions = objWMI.ExecQuery _ 
    ("Select * from Win32_LogonSession Where LogonType = 10") 

If colSessions.Count = 0 Then 
   Wscript.Echo "No interactive users found" 
Else 
   WScript.Echo "RDP Sessions:"
   For Each objSession in colSessions 

     Set colList = objWMI.ExecQuery("Associators of " _ 
         & "{Win32_LogonSession.LogonId=" & objSession.LogonId & "} " _ 
         & "Where AssocClass=Win32_LoggedOnUser Role=Dependent" ) 
     For Each objItem in colList 
       WScript.Echo "Username: " & objItem.Name & " FullName: " & objItem.FullName 
     Next 
   Next 
End If 
```

原始代码在这里：

[如何显示已登录的用户？（Tek-Tips 论坛）](http://www.tek-tips.com/viewthread.cfm?qid=1308179&page=2)

这确实适用于 Windows 2003，我不能对更高版本做出任何保证。

# c++ - 使用 Cygwin 的 C++ 递归文件/目录扫描

> ID：898766
> 
> 赞同：0
> 
> 时间：2009-05-22T16:30:57.430
> 
> 标签：c++, recursion, filesystems, cygwin

我正在寻找一个便携式文件系统扫描仪，能够递归地列出给定目录路径上的所有文件。

为此，我尝试将 cygwin 用于我的编译器，使用 dirent.h 并使用模板：

```
#include <dirent.h> 
#include <stdio.h> 

int main(void)
{
  DIR           *d;
  struct dirent *dir;
  d = opendir(".");
  if (d)
  {
    while ((dir = readdir(d)) != NULL)
    {
      // Stuff
    }    
    closedir(d);
  }    
  return(0);
} 
```

但还需要添加递归目录搜索。为此，我的解决方案是尝试在下一个文件上 opendir()，并判断错误代码以确定它是否作为目录成功打开（然后我将对其进行递归），或者它是否返回为 'not一个目录'，然后将其列为一个文件。

我承认感觉很笨拙，但是即使经过数小时的搜索，我也找不到可以保留一些可移植性（不是 win32）的更好方法。

所以我的简化解决方案（为了简单起见有些伪）看起来像这样：

```
整数扫描（字符串 startdir）
{
  目录 *d;
  结构 dirent *dir;
  d = opendir(startdir.cstr());
  如果 (d)
  {
    而 ((dir = readdir(d)) != NULL)
    {
      if( 不是 '.' 而不是 '..')
      {
        如果（temp = opendir（startdir + d）== NULL）
        {
           //文件或错误
        }别的{
          //作为目录打开成功，所以递归
          扫描（开始目录 + d->d_name + “\\”）；
        }
      }
    }
    关闭（d）；
  }
  返回（0）；
}

```

这只是为了保持简单而重写了一半的伪代码，但它似乎有效（尽管我非常愿意接受有关更好方法的建议）。

然而，我遇到的主要问题是一个特定的链接文件 'c:\cygwin\dev\fd'，它似乎作为一个目录打开，并以递归方式一遍又一遍地无限地打开。

'fd' 文件大小为 4KB，106 字节，无扩展名，是一个快捷方式，不指向 Windows 中的任何位置。

这个错误似乎表明这个 kludgey 方法有问题，或者我正在编译的 cygwin 实现中存在问题。

作为一个简短的例子：

```
读取错误：c:\cygwin\dev\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\ fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\ 5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\ fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\5\fd\ 5\fd\0 没有这样的文件或目录
```

排除该目录，搜索似乎运行良好。但是我不同意将排除项硬编码到扫描仪中。

如果有人对此问题有任何想法、建议、解决方案或替代方法，我们将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T16:43:00.993

如果可以使用 boost，请考虑使用[boost::filesystem](http://www.boost.org/doc/libs/1_39_0/libs/filesystem/doc/index.htm)。这些教程包括一个简单的 ls 程序，您可以轻松地将其扩展为递归工作。该库还包括查询文件类型的方法，这可能可以解决您的特定问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T17:37:26.063

罪魁祸首似乎是 fd 文件链接到 /proc/

我不保证它是真的，但我的印象是这使扫描器能够递归地循环遍历它自己的目录结构。

起初，我使用 readlink() 解决此问题的努力很有希望，但我发现随着更深层次的扫描，它变得不可靠，并且仍然可能发生错误。

我现在正在研究实现此功能的其他方法（即 boost::filesystem）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T16:34:53.233

那是一个虚拟文件系统，可能带有符号链接。Cygwin 支持符号链接，您可能必须将其考虑在内。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T01:04:06.857

您确实意识到 cygwin 拥有所有的 UNIX 工具。

查找非常有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T13:32:28.197

cygwin 库同时具有 ftw() 和 fts()，使用其中之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-25T13:34:00.497

在您的示例中，您尝试再次使用 opendir() 来确定某物是文件还是目录。您可以使用“sys/stat.h”中的 stat() 更直接地执行此操作。这也应该在 cygwin 中可用。您可以使用宏 S_ISREG() 和 S_ISDIR() 来检查常规文件或目录。大概是这样的：

```
 struct stat *buf = new struct stat;
    if(!stat(d->d_name, buf))
    {
        if(S_ISREG(buf->st_mode))
        {
            std::cout << "    File: " << entry->d_name << "\n";
        }
        if(S_ISDIR(buf->st_mode) && 
```

另请查看我为另一个[问题提供的](https://stackoverflow.com/questions/67273/how-do-you-iterate-through-every-file-directory-recursively-in-standard-c)[答案](https://stackoverflow.com/a/8929479/1127914)。

# asp.net-mvc - 与常规 Django 模板相比，NDjango 模板有哪些限制？

> ID：898768
> 
> 赞同：3
> 
> 时间：2009-05-22T16:31:29.240
> 
> 标签：asp.net-mvc, django, templates, ndjango

NDjango 和 Django 模板之间是否有任何差异、限制或陷阱？我对在未来的 ASP.NET MVC 项目中实现它们特别感兴趣。

我确定我将无法使用我为 Django 编写的任何自定义模板标签，但我可以将它们移植到 NDjango 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T22:42:27.533

是的，你会的。您可以通过编写自己的标签和过滤器集并在应用程序启动时注册它们来扩展默认标签和过滤器集。只需要记住一件事 - 过滤器意味着非常容易扩展，因此您只需实现两个直接接口之一（ISimpleFilter 用于无参数过滤器或 IFilter 用于具有 1 个参数的过滤器）。对于标签，概念是相同的，但由于 NDjango 本身是用 F# 编写的，因此从 C# 或 VB 中使用 ITag 接口有点困难。这当然是可行的，但有点混乱。从 F# 开始，它非常简单。

在 f# 中，它看起来像这样：

```
/// A single tag implementation
and ITag = 
    /// Transforms a {% %} tag into a list of nodes and uncommited token list
    member Perform: Lexer.BlockToken -> IParser -> 
             Lexer.Token seq -> (Node list * Lexer.Token seq) 
```

在 c# 中，它看起来像这样：

```
 public Tuple<FSharpList<Interfaces.Node>, IEnumerable<Lexer.Token>>
              Perform(Lexer.BlockToken __p1, Interfaces.IParser __p2,
                   IEnumerable<Lexer.Token> __p3) 
```

再次 - 过滤器在 c# 中很容易 - 事实上，它附带的大多数过滤器都是用 c# 编写的。标签在 f# 中很容易，但在 c# 中有点混乱

就限制而言，没有任何已知的限制，我不知道。

全面披露 - 我是 ndjango 的作者之一。

# java - 使用 JXPath 查询列表

> ID：898770
> 
> 赞同：3
> 
> 时间：2009-05-22T16:32:21.563
> 
> 标签：java, xpath, jakarta-ee, jxpath

我有一个简单的类（用于测试目的），我试图使用 JXPath 进行查询。

我创建了一个各种动物对象的列表，我想获得一个迭代器：

1.  type='CAT' 的所有动物

2.  numLegs = 4 的所有动物

这是一个简单的类：

```
public class Animal {

    private UUID uuid;
    private int numLegs;
    private AnimalType type;

    public enum AnimalType {
        CHICKEN, FROG, DOG, CAT
    }

    public Animal(AnimalType type) {
        this.type = type;
        uuid = UUID.randomUUID();
        switch (type) {
        case CHICKEN:
            numLegs = 2;
            break;
        case FROG:
            numLegs = 2;
            break;
        case DOG:
            numLegs = 4;
            break;
        case CAT:
            numLegs = 4;
            break;
        }
    }

    public UUID getUuid() {
        return uuid;
    }

    public int getNumLegs() {
        return numLegs;
    }

    public AnimalType getType() {
        return type;
    }

    public String toString(){
        return "UUID: "+uuid+", Animal: "+type+ ", Legs: "+numLegs;
    }

} 
```

这是我用来构建动物列表供我查询的方法：

```
private static List<Animal> getAnimals(int numAnimals) {
    ArrayList<Animal> animals = new ArrayList<Animal>();
    for(int i = 0; i<numAnimals; i++){
        if(i%4==0){
            animals.add(new Animal(AnimalType.CAT));
        }
        else if(i%3==0){
            animals.add(new Animal(AnimalType.DOG));
        }
        else if(i%2==0){
            animals.add(new Animal(AnimalType.FROG));
        }
        else{
            animals.add(new Animal(AnimalType.CHICKEN));
        }

    }

    return animals;
} 
```

这是我尝试执行查询的方式：

```
public static void main(String[] args){
    List<Animal> animals = getAnimals(10000);

    JXPathContext animsContext = JXPathContext.newContext(animals);

    Iterator<BeanPointer> iter = 
        animsContext.iteratePointers("/*[type='CAT']");

    List<Animal> cats = new ArrayList<Animal>();

    while(iter.hasNext()){
        cats.add((Animal) iter.next().getParent().getValue());
    }
    System.out.println("Number of Cats is: "+cats.size());
} 
```

这部分：

```
 Iterator<BeanPointer> iter = 
        animsContext.iteratePointers("/*[type='CAT']"); 
```

不管用。我究竟做错了什么？我也无法让它为 /*[numLegs=4] 工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T06:31:42.710

我从未使用过 JXPath，但我希望有一个根节点，在这种情况下

```
/*[type='CAT'] 
```

意思是“给我根节点，前提是它的属性类型等于 CAT”

我认为你所追求的更像是

```
/*/*[type='CAT'] 
```

读起来像“给我直接在根节点下面的节点，其属性类型等于 CAT”

布赖恩的建议

```
//*[type='CAT'] 
```

读起来像“给我树中任何具有等于 CAT 的属性类型的节点”

希望有点帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T17:10:15.590

我不确定上面有什么不起作用。但是有几点。

1.  我不确定枚举是否按您的预期工作。您的 JXPath 查询正在查询`getType()`将返回枚举而不是字符串的类型。我不确定 JXPath 是否那么聪明。枚举。
2.  `[type='CAT']`本身不是 XPath 表达式。我希望像`//*[type='CAT']`

所以我会尝试以下方法：

1.  实现一个 getTypeName() 方法，该方法返回枚举名称，例如 CAT/DOG 等，并使用该方法进行查询
2.  尝试使用 XPath `//*`（不带任何谓词）来确认 JXpath 将按预期查询 ArrayList。

# python - 在Python中，如何按字典的某个值+字母顺序对字典列表进行排序？

> ID：898773
> 
> 赞同：3
> 
> 时间：2009-05-22T16:33:27.883
> 
> 标签：python, list, sorting, dictionary

好的，这就是我想要做的......我知道 itemgetter() 排序可以很容易地按字母排序，但如果我有这样的事情：

> [{'Name':'TOTAL', 'Rank':100}, {'Name':'Woo Company', 'Rank':15}, {'Name':'ABC Company', 'Rank':20} ]

我希望它按字母顺序（按名称）排序+包括名称：'TOTAL'的那个应该在序列中最后列出的条件，如下所示：

> [{'Name':'ABC Company', 'Rank':20}, {'Name':'Woo Company', 'Rank':15}, {'Name':'TOTAL', 'Rank':100} ]

我该怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T16:38:18.547

这里最好的方法是装饰排序键...... Python将按元组组件按顺序对元组进行排序，因此使用您的排序标准构建一个元组键：

```
sorted(list_of_dicts, key=lambda d: (d['Name'] == 'TOTAL', d['Name'].lower())) 
```

这会产生一个排序键：

*   (True, 'total') for {'Name': 'TOTAL', 'Rank': 100}
*   (False, 'woo company') for {'Name': 'Woo Company', 'Rank': 15}
*   (False, 'abc company') for {'Name': 'ABC Company', 'Rank': 20}

由于 False 比 True 排序更早，因此名称不是 TOTAL 的那些将最终放在一起，然后按字母顺序排序，TOTAL 将在最后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T16:39:07.143

```
>>> lst = [{'Name':'TOTAL', 'Rank':100}, {'Name':'Woo Company', 'Rank':15}, {'Name':'ABC Company', 'Rank':20}]
>>> lst.sort(key=lambda d: (d['Name']=='TOTAL',d['Name'].lower()))
>>> print lst
[{'Name': 'ABC Company', 'Rank': 20}, {'Name': 'Woo Company', 'Rank': 15}, {'Name': 'TOTAL', 'Rank': 100}] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T16:38:08.097

使用 sort 或 sorted 的[key](http://wiki.python.org/moin/HowTo/Sorting#Sortingbykeys)参数。

例如：

```
dicts = [
     {'Name':'TOTAL', 'Rank':100}, 
     {'Name':'Woo Company', 'Rank':15},
     {'Name':'ABC Company', 'Rank':20}
]

def total_last(d):
    if d['Name'] == 'TOTAL':
        return '\xff\xff\xff\xff\xff\xff'
    return d['Name'].lower()

import pprint
pprint.pprint(sorted(dicts, key = total_last))

>python sort_dict.py
[{'Name': 'ABC Company', 'Rank': 20},
 {'Name': 'Woo Company', 'Rank': 15},
 {'Name': 'TOTAL', 'Rank': 100}] 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-22T16:39:27.003

好吧，我会使用列表的排序方法对它进行多次排序。

```
list = [{'Name':'TOTAL', 'Rank':100}, {'Name':'Woo Company', 'Rank':15}, {'Name':'ABC Company', 'Rank':20}]

list.sort(key = lambda x: x['Name']) # Sorted by Name, alphabetically

list.sort(key = lambda x: 'b' if x['Name'] == 'TOTAL' else 'a') 
```

# search - 搜索技术的重要组成部分是什么？

> ID：898779
> 
> 赞同：0
> 
> 时间：2009-05-22T16:35:20.690
> 
> 标签：search, search-engine

搜索技术的重要组成部分是什么？

*   分布式文件系统
*   云计算
*   存储系统
*   排名算法
*   搜索算法

或者是其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T16:41:11.087

//开始讽刺回答

RAM + CPU + 带宽 + 非常棒的搜索引擎软件

//结束讽刺的回答

不过说真的，像搜索技术这样复杂的东西将取决于许多问题，正如您已经列出的那样。试图将其固定在一颗奇异的银弹上确实不适用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T17:16:19.750

我认为在搜索中尚未解决的更大问题是[Onotology](http://en.wikipedia.org/wiki/Category_of_being)。我们很难以人性化的方式理解和分类结果。有人称其为“语义网”。我们有大量的数据和索引，但我们对它进行分类或*很好*地理解它是一种非常糟糕的方式。错误在于我们缺乏以搜索（算法）可以理解的方式进行原子的自我表达。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T16:38:19.377

[索引](http://en.wikipedia.org/wiki/Index_(search_engine))?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T16:40:09.497

搜索和排名至关重要，索引也是如此。您需要有效的算法来找到与我输入的关键字（ala google、yahoo 等）非常匹配的结果，然后您需要对这些结果进行排名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T17:24:35.603

搜索引擎的性能至关重要；缓慢的服务是死的，但这不是最重要的方面；我认为，该徽章与结果的相关性有关。

我们要求搜索引擎做不可能的事；*获取一个短语或几个关键字，并以某种方式返回与我们想要*的完全相关的一大堆结果——我们可能不知道我们在寻找什么，但只要我们看到它，我们就可以识别它。同样，当搜索引擎返回“错误的东西”时，我们会立即知道。

归根结底，这一切都是为了让一台愚蠢的机器按照我们的意思去做，而不是我们所说的，这在计算中基本上是一个无法解决的问题。最好的搜索解决方案总是那些拥有最新颖的结果排名方式并将它们与我们的原始查询相关联的解决方案。正如韦恩·哈特曼 (Wayne Hartman) 在他的回答中所描述的那样，这个概念与本体论的概念密切相关。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T17:29:44.677

作为我最后一年项目的一部分，我构建了一个小型搜索引擎，我可以告诉你倒排索引是搜索引擎的重要组成部分。

我也可以说爬行者是一个重要的部分。

您也可以说 Page Rank 算法很重要。

你可以说集群很重要。

……

你到底在找什么？你的问题对我来说似乎很广泛。

# .net - 向 ASP.NET 程序员教授 ASP.NET MVC 的最佳学习资源是什么？

> ID：898780
> 
> 赞同：5
> 
> 时间：2009-05-22T16:36:00.330
> 
> 标签：.net, asp.net, asp.net-mvc, resources

对于有经验的 ASP.NET 学习 ASP.NET MVC，您推荐哪些材料？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T16:45:53.623

如果您通过阅读书籍来学习，我建议您查看[Professional ASP.NET MVC 1.0](https://rads.stackoverflow.com/amzn/click/com/0470384611)。它由 Scott Hanselman、[Phil Haack](https://stackoverflow.com/users/598/haacked)、Scott Guthrie 和 Rob Conery 编写。[在这里](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)，您可以免费下载本书的整章，它会引导您从头到尾构建一个名为“Nerd Dinner”的应用程序。

如果您通过示例学习，那么也许您想查看“ [Haackoverflow](http://haacked.com/archive/2008/11/07/haackoverflow-vs-stackoverflow.aspx) ”。这是一个在 ASP.NET MVC 中创建的 Stackoverflow 式站点，您可以在其中发布问题和答案。[您可以在 channel9 上](http://channel9.msdn.com/pdc2008/PC21/)观看它正在创建的视频。

最后，如果您是视觉学习者，我强烈建议您查看[官方 ASP.NET MVC 网站](http://www.asp.net/mvc/learn/)上的教程视频。它们涵盖了诸如路由、视图、控制器、验证、安全等主题。

搜索网络或观看视频时，请确保它们是 1.0 或更高版本。预发布版本发生了一些重大更改，它们只会让您感到困惑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T17:18:07.750

我将从这里开始：

[http://weblogs.asp.net/scottgu/archive/2009/04/28/free-asp-net-mvc-nerddinner-tutorial-now-in-html.aspx](http://weblogs.asp.net/scottgu/archive/2009/04/28/free-asp-net-mvc-nerddinner-tutorial-now-in-html.aspx)

这是Professional ASP.NET MVC 1.0的免费在线章节。这是由负责项目的团队编写的创建 asp.net mvc 站点的逐步演练。他们的个人博客通常也充满了 asp.net mvc 功能和代码示例。

*   Rob Conery [http://blog.wekeroad.com/](http://blog.wekeroad.com/)
*   斯科特·汉塞尔曼[http://www.hanselman.com/](http://www.hanselman.com/)
*   菲尔·哈克[http://haacked.com/](http://haacked.com/)
*   斯科特·格思里[http://weblogs.asp.net/scottgu/](http://weblogs.asp.net/scottgu/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T17:36:00.880

如果您喜欢视频培训，有一个付费网站，我使用它来动手操作与 ASP.NET MVC 相关的系列。

学习视觉工作室

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T16:41:53.753

学习一些被 Web Forms 抽象出来的基础知识，如果做得不好的话：

*   HTTP
*   HTML / CSS
*   JavaScript - 客户端编程
*   无状态编程

仅举几例。MVC 的乐趣在于您获得了更多控制权，但这意味着您需要更好地了解您正在处理的核心技术。学习其他互补技术/想法也可能会有所帮助，例如 REST 背后的想法会影响很多人的决策。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T17:11:17.837

以下列表应该足以让您走上自助之路。

*   [ASP.NET MVC](http://www.asp.net/mvc/)主页 - 视频和教程
*   MSDN 上的[ASP.NET 模型视图控制器 (MVC)](http://msdn.microsoft.com/en-us/library/dd394709.aspx)
*   Rob Conery、Scott Hanselman、Phil Haack 的[专业 ASP.NET 3.5 MVC](https://rads.stackoverflow.com/amzn/click/com/0470384611)

还有很多不错的博客，包括上述书籍作者的博客。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T17:14:52.620

阅读源代码。

*   [代码营服务器](http://codecampserver.org)
*   [速记店](http://code.google.com/p/sutekishop/)
*   [夏普架构](http://code.google.com/p/sharp-architecture/)
*   [ASP.NET MVC](http://aspnet.codeplex.com/SourceControl/ListDownloadableCommits.aspx)（当我学习开放源代码的框架时非常宝贵）

# xpath - 在 Dynamics AX、X++ 中，如何增加日期变量

> ID：898781
> 
> 赞同：7
> 
> 时间：2009-05-22T16:36:31.327
> 
> 标签：xpath, x++, axapta

我不确定它是否与 xslt 或 xpath..但我如何将日期增加 1 天？例如，如果日期是 2009 年 2 月 16 日，我希望日期增加 1 以变为 2009 年 2 月 17 日等。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-03-09T09:29:40.827

在 X++、Dynamics AX 中递增日期变量：

```
static void IncDate(Args _args)
{
    TransDate transDate = 16\02\2009;
    ;

    transDate++;

    print transDate;
    pause;
} 
```

结果：**2009 年 2 月 17 日**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-01-02T10:12:14.900

DateTimeUtil::addDays

[http://msdn.microsoft.com/en-US/library/cc552939(v=AX.50).aspx](http://msdn.microsoft.com/en-US/library/cc552939(v=AX.50).aspx) (AX 2009)

[http://msdn.microsoft.com/en-us/library/datetimeutil.adddays.aspx（AX](http://msdn.microsoft.com/en-us/library/datetimeutil.adddays.aspx) 2012）

# perl - 如何告诉 CPAN 安装所有依赖项？

> ID：898782
> 
> 赞同：122
> 
> 时间：2009-05-22T16:36:36.617
> 
> 标签：perl, dependencies, cpan

如何告诉 CPAN 安装所有依赖项？

我尝试将这些设置为`cpan`：

```
cpan> o conf prerequisites_policy follow
cpan> o conf commit 
```

我仍然不得不回答“y”几次（但比之前感觉要少）。

有没有办法让它总是继续安装？我想让它无人看管。

似乎我想要一个标志来始终信任 CPAN 做正确的事情，如果它建议一个答案，我想遵循它（`Enter`当它问什么时总是点击它）。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-06-10T20:33:51.267

尝试像这样设置 PERL_MM_USE_DEFAULT：

```
PERL_MM_USE_DEFAULT=1 perl -MCPAN -e 'install My::Module' 
```

它应该使 CPAN 默认回答所有提示。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2011-10-31T02:09:45.117

这个问题的最新和最好的答案是使用[`cpanm`](http://p3rl.org/App%3a%3acpanminus)（也称为 App::cpanminus 或 cpanminus）！

> 描述
> 
> cpanminus 是一个从 CPAN 获取、解包、构建和安装模块的脚本，它什么也不做。
> 
> 它是无依赖的（可以自行引导），需要零配置，并且是独立的。运行时，它只需要 10MB 的 RAM。

要引导安装它：

```
curl -L http://cpanmin.us | perl - --sudo App::cpanminus 
```

或者如果您只是[`perlbrew`](http://p3rl.org/App%3a%3aperlbrew)使用

```
perlbrew install-cpanm 
```

或来自 cpan 本身：

```
cpan install App::cpanminus 
```

从那时起，通过执行安装模块（必要时以 root 身份）

```
cpanm Foo::Bar 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2014-02-12T18:18:11.050

这是使这些更改永久化的单线，包括自动首次 CPAN 配置：

```
perl -MCPAN -e 'my $c = "CPAN::HandleConfig"; $c->load(doit => 1, autoconfig => 1); $c->edit(prerequisites_policy => "follow"); $c->edit(build_requires_install_policy => "yes"); $c->commit' 
```

或将其与`local::lib`非特权用户的模块结合使用：

```
perl -MCPAN -Mlocal::lib=~/perl5 -e 'my $c = "CPAN::HandleConfig"; $c->load(doit => 1, autoconfig => 1); $c->edit(prerequisites_policy => "follow"); $c->edit(build_requires_install_policy => "yes"); $c->commit' 
```

在使用 CPAN shell 或其他任何东西之前运行它。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2010-01-14T16:20:14.567

在prerequisites_policy 之上更改以下参数。

```
cpan> o conf prerequisites_policy 'follow'
cpan> o conf build_requires_install_policy yes
cpan> o conf commit 
```

这会将它从“询问/是”更改为“是”并停止询问您。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2009-12-18T23:24:51.440

这就是我很确定您正在寻找的内容：

```
cpan> o conf prerequisites_policy follow
cpan> o conf commit 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-22T16:52:02.837

放

```
prerequisites_policy 
```

在配置中。

请参阅[配置变量](https://metacpan.org/pod/CPAN#Config-Variables)。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-22T18:41:45.843

也许它与正在使用的[ExtUtils::AutoInstall](http://search.cpan.org/dist/ExtUtils-AutoInstall)或[Module::AutoInstall](http://search.cpan.org/dist/Module-AutoInstall)有关。尝试设置 PERL_AUTOINSTALL 环境变量。（参见这些模块的文档。）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-23T00:41:58.727

就我个人而言，我只尝试过几次以这种方式修改设置，并且实际上发现通过不提供任何参数，然后从交互式提示进行配置更容易进入`CPAN.pm`shell ：`cpan``CPAN.pm`

```
$ cpan
cpan> o conf init 
```

这将启动`CPAN.pm`接口配置实用程序。只需运行它并指定“跟随”你需要的地方（我忘记了这个问题），你应该很高兴。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-07-29T14:08:59.990

到目前为止，我发现这是安装 CPAN 模块最快、最可靠的方法：

```
yes | perl -MCPAN -e "CPAN::Shell->notest(qw!install Your::Module!)" 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-08-02T19:48:57.510

我写这篇文章是为了帮助那些可能来到这个页面的人，他们正在寻找一种方法来安装特定 perl 脚本所需的所有模块依赖项。我为此写了一个脚本：

它应该运行为`./installdep.pl yourscript.pl`

```
#!/usr/bin/perl
`sudo apt install cpanminus`;
while (<>) {
    if (/USE /i)
    {
        my $line=$_;
        $line=~ s/\s//g;
        $line=~ /^(.*)\./;
        $line=~ s/\;//;
        $line=~s/^USE//i;
        $line=~s/lib.*//i;
        $line=~s/feature.*//i;
        $line=~s/strict//i;
        $line=~s/warnings//i;
        $line =~ s/^(.*)\(.*/$1/;
        unless ($line eq '') {
        my $cmd='sudo cpanm '.$line;
        print "Installing $line \n";
        open my $cmd_fh, "$cmd |";
        while (<$cmd_fh>) {
          print "$_";
        }
        close $cmd_fh;
        print "\n";
    }
    }
} 
```

这将使用 cpanminus 安装脚本所需的所有模块依赖项。如果没有安装 cpanm，它将安装它。

# iphone - 在一个应用程序中拥有多个标签栏视图是否违反 iPhone HIG？

> ID：898788
> 
> 赞同：0
> 
> 时间：2009-05-22T16:37:56.553
> 
> 标签：iphone

从我在 iPhone 应用程序中看到的情况来看，一个应用程序应该只有一个选项卡栏视图，可以让您选择它的主要功能区域。这样做是否令人困惑或反对 HIG，例如：

点击一个选项卡，显示一个表格视图，选择一个单元格，加载一个新的选项卡栏视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T12:19:09.637

在 Apples HIG 中，这很令人困惑，并且特别建议不要使用。它们适用于具有多个导航控制器的选项卡控制器，但反之则不然。

此外，由于大多数 iphone 应用程序都有一组稳定的选项卡（即使它们有时被隐藏或替换为工具栏），这也会让用户感到困惑。

祝你好运。

卡尔

# c++ - 在 C++ 中，是否有任何特定情况下按值传递优于按常量引用传递？

> ID：898789
> 
> 赞同：7
> 
> 时间：2009-05-22T16:37:57.987
> 
> 标签：c++

我读到它们在概念上是平等的。在实践中，是否有任何场合

```
foo(T t) 
```

优先于

```
foo(const T& t) 
```

? 为什么？

* * *

感谢到目前为止的答案，请注意我不是在问 by-ref 和 by-val 之间的区别。

**实际上，我对by-const-ref**和**by-val**之间的区别很感兴趣。

我曾经认为 by-const-ref 可以在调用案例中替换按值，因为即使 Herb Sutter 和 Bjarne 也表示它们在概念上是相等的，并且“by ref”（无论是 const）意味着更快。直到最近，我在某处读到 by-val 在某些情况下可能会得到更好的优化。

那么何时以及如何？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-22T16:47:35.853

内置类型和小对象（例如 STL 迭代器）通常应该按值传递。

这部分是为了增加编译器的优化机会。编译器很难知道引用参数是别名另一个参数还是全局参数 - 它可能必须通过函数多次从内存中重新读取对象的状态，以确保值没有改变。

`restrict`这就是 C99关键字的原因（同样的问题，但有指针​​）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T16:41:12.040

如果你想在`t`你的方法体中局部修改（不影响原始）（比如在计算过程中），第一种方法将是优先的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T16:48:14.683

如果传递的对象是一个智能指针（即它自己进行引用计数），那么按值传递可能更合理。

我意识到这是对您的问题的一种侧面回答 - 由智能指针包装的对象在按值传递时不会被复制，因此在这种情况下它更类似于通过引用传递。不过，在这种情况下，您不需要“通过引用”语义。

不过，到目前为止，我的推理路线存在问题 - 通过按值传递，您将失去论点的“常量性”。也许您毕竟应该只使用“通过引用”语义......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T17:42:19.030

不要忘记在某些情况下存在差异 - 当您处理具有奇怪复制/赋值语义的对象时。

`auto_ptr<>`是一个典型的例子——通过价值传递那些而不考虑后果，你最终可能会一团糟。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T16:48:43.137

此外，当 T 是简单类型（int、bool 等）时，通常使用 foo(T t)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T16:54:39.043

另一个没有提到的案例是对象的大量使用。假设您传递了一个具有 5 个整数的结构作为成员。如果您要在函数中大量访问所有 5 个，那么在某个时候取消引用成本超过了复制成本。但是，您必须运行探查器才能知道是什么时候。

不过，我应该指出，像 STL 容器这样在堆上分配内存的东西，如果可以避免的话，几乎不应该按值传递，因为与堆栈分配相比，堆分配非常慢。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-22T16:56:19.900

这是您没有其他选择而只能按值传递参数的情况。当然 boost 确实可以处理这个问题。但是如果没有 boost，我们必须传递一个 Value 来按值运行。

```
class Test
{
public:
    Test()
    {
        std::set<std::string> values;
        values.insert("A");
        values.insert("V");
        values.insert("C");

        std::for_each(values.begin(), values.end(), 
                bind1st(mem_fun(&Test::process), this));
    }

private:
    void process( std::string value )
    {
        std::cout << "process " << value << std::endl;
    }
}; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-22T16:57:05.030

const 引用传递和值传递在概念上相同的原因是两者都不能修改原始内容。

通常，我非常喜欢按值传递，因为它创建的代码避免了多个线程共享对公共数据的访问时发生的许多复杂性。

也就是说，它确实可能会让你的代码变慢。我过去的看法一直是更喜欢按值传递，除非我知道他们这样做是（或将是）性能问题。我可能需要稍微修改一下，以包含通过 const 引用作为更好的选择。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-22T17:10:33.220

如果函数最直接的实现涉及在本地修改参数值，那么通过值而不是 const 引用传递它是有意义的

例如，strcpy 的单行版本：

```
char *strcpy(char *dest, const char *src)
{
   while (*dest++ = *src++);

   return s1;
} 
```

如果您将指针作为 const 引用，则需要将它们复制到程序主体中的临时对象，而不是让参数传递机制为您完成。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-22T22:02:58.517

两个非常具体的案例：

当您编写具有强异常保证的赋值运算符时，您可以像这样编写它们

```
X& X::operator=(const X& orig)
{
    X tmp(orig);
    swap(this, tmp);
    return *this;
} 
```

或者您可以认识到发生的第一件事是您制作了一个副本，然后将其作为通话的一部分完成

```
X& X::operator=(X tmp)
{
    swap(this, tmp);
    return *this;
} 
```

如果您有一个具有所有权语义的智能指针，例如`auto_ptr`，并且您想将所有权转移给被调用函数，您应该按值传递它。当然，现在有 8 个人会很快指出您可能不想使用`auto_ptr`，他们可能是对的，但有时您不会做出这样的选择。

虽然不是很具体，但我经常最终会按值传递小对象，因为这可以节省我在堆上的分配。不仅实际分配和最终解除分配需要时间，而且通过指针引用所有内容也无助于改善数据局部性。换句话说，它可能会对您的表现产生影响。收支平衡点的确切位置取决于您的应用程序，但我个人会毫不犹豫地传递一个指针大小较大的对象。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-22T22:37:36.387

它们在概念上根本不相等......

前者在函数内部创建对象的副本。这意味着可以安全地在函数中修改该值。这也意味着发生了对象的完整副本，如果对象很大，这可能是一个问题。

后者创建对象的别名并声明它不能在对象内修改。不会发生复制，但每次访问函数内的对象都需要取消引用。编译器会为我们处理这个问题，但知道这一点仍然很重要。

如果您有一个通常在寄存器中传递的类型，则差异变得非常重要。例如，整数、浮点数，甚至某些平台上的 4 浮点向量。性能问题表明您希望对象尽可能长时间地保留在寄存器中而不将其自身写回内存，并且通过值传递使这更有可能。

因此，对于基本类型（char、short、int、long、float、double），您应该始终更喜欢按值传递，*除非*您特别需要使用引用来存储函数退出后使用的值。对于完整对象，通常更喜欢通过 const 引用传递。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-22T16:47:47.460

1.  如前所述，如果您想要函数中的对象副本，则首选按值传递。
2.  如果复制 T 比创建/复制引用便宜，我通常使用按值传递，例如 T=char，T=short。这里的好处可能取决于平台，并且您可能仍然希望 const 在适用的情况下帮助优化器。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-22T17:00:31.343

有些例程需要副本，因此不应通过引用传递。例如，国际象棋程序的移动生成器可能需要当前位置的副本来处理（递归），而不是实际修改位置的原始实例。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-24T14:46:57.740

在[这个答案](https://stackoverflow.com/questions/270408/is-it-better-in-c-to-pass-by-value-or-pass-by-constant-reference/271344#271344)中回答。这是该答案的[符号链接。](http://en.wikipedia.org/wiki/Symlink)请在那里投票，如果有的话:)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-25T01:48:15.863

[Boost.CallTraits](http://www.boost.org/doc/libs/1_39_0/libs/utility/call_traits.htm)是一个鲜为人知但很有帮助的工具，用于执行参数和结果传递，它应该是相关类型可用的最有效方法。

# svn - SVN服务器版本

> ID：898795
> 
> 赞同：5
> 
> 时间：2009-05-22T16:39:00.810
> 
> 标签：svn

有什么方法可以从我的 SVN 项目的本地副本（.svn 中的内容）中确定正在运行哪个版本的 SVN 服务器？

谢谢，巴里

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T17:03:26.630

只需使用 Web 浏览器并调用 subversion 存储库的 URL。在出现页面的底部显示版本号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T17:37:58.007

如果不访问该存储库，就无法确定运行特定存储库的 Subversion 版本，原因有两个：

1.  首先，工作副本几乎完全不受存储库功能的影响。完全由本地Subversion客户端控制，版本间兼容性高。
2.  另外，你怎么知道你退房后服务器是否升级了？

如果您的存储库是通过 访问的`file://`，那么您使用的 Subversion 版本与客户端和服务器相同。这很简单`svnadmin --version`——但我认为情况并非如此，否则你不会在这里问。:-)

`http://`要通过或查找可用的存储库版本，`https://`此处其他答案中提供的任何方法都可以使用。如果您不需要以编程方式检查，我偏爱“只需在浏览器中访问它”方法。

要查找`ssh+svn://`存储库的版本，请照常通过 SSH 进入该框并运行`svnadmin --version`.

我不知道确定存储库版本的方法只能通过`svn://`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T17:00:07.537

[这里](http://svn.collab.net/repos/svn/trunk/tools/client-side/server-version.py)托管了一个 python 脚本，它完全符合您的要求。

另外，看看[这个问题](https://stackoverflow.com/questions/141146/how-to-find-my-subversion-server-version-number)。

我总是发现[这](http://svnbook.red-bean.com/)也是一个有用的 SVN 资源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-30T05:48:34.893

Subversion 服务器版本在服务器返回的 HTTP RESPONSE 标头中可用。您可以使用以下 shell 命令获取它：

```
wget -S --spider 'http://svn.server.net/svn/repository' 2>&1 | \ 
grep 'SVN' | sed 's/.*\(SVN[0-9\/\.]*\).*/\1/'; 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-22T16:47:31.343

如果有办法，我找不到。如果您通过 HTTP[S] 访问服务器，您可能可以从 HEAD 命令的输出中获取版本：

```
远程登录服务器 80
HEAD / HTTP/1.0（按两次返回）

```

对于 HTTPS：

```
openssl s_client -连接服务器：https
HEAD / HTTP/1.0（按两次返回）

```

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2009-05-22T16:50:35.897

```
svn --version 
```

# windows-xp - Win XP上显示/隐藏桌面图标的RegKey在哪里

> ID：898797
> 
> 赞同：1
> 
> 时间：2009-05-22T16:39:26.940
> 
> 标签：windows-xp, registry, desktop

在 WinXP 上，如果您右键单击桌面，选择查看，然后选择“显示桌面图标”，图标将被隐藏。

你知道存储这个值的 reg 键吗？

也许更重要的是，你是怎么知道或找到价值的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T16:52:09.547

关键在

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\HideIcons 
```

将其设置为 1 以隐藏图标，设置为 0 以显示它们。您必须注销并重新登录才能看到更改。

我查看了 HKEY_CURRENT_USER 配置单元，因为隐藏桌面图标是每个用户的设置（与每台机器的设置相反，我会在 HKEY_LOCAL_MACHINE 中查看）。

如果您要针对特定​​程序设置设置，请查看软件密钥，然后按公司和产品搜索。在这种情况下，它是 Software\Microsoft\Windows\CurrentVersion

由于我们正在搞乱作为资源管理器一部分的桌面，我开始查看资源管理器键。从那里只是一个快速搜索。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T17:09:49.243

[Windows Sysinternals的](http://technet.microsoft.com/en-us/sysinternals/default.aspx)[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)是回答此类问题的绝佳工具。您甚至可以[从 live.sysinternals.com 运行进程监视器](http://live.sysinternals.com/Procmon.exe)。

将其设置为监控**Operation** `is` *RegSetValue*，然后通过 UI 进行更改并观察更新了哪些注册表项。

如果您从过滤器选择中得到太多噪音，您可以为**进程名称** `is`（在这种情况下）*explorer.exe*和/或**路径** `contains`（在这种情况下）*hide*添加额外的过滤器。

Process Monitor may seem like an IT-only tool, but it is also a developers' tool. It is an excellent way to ensure Registry keys are being updated, DLLs are being loaded, configuration files are being read and/or processes are being spawned.

# delphi - 数据网格导出为 pdf

> ID：898801
> 
> 赞同：6
> 
> 时间：2009-05-22T16:39:46.847
> 
> 标签：delphi, pdf, vcl

如何将 DBgrid 上显示的数据导出为 pdf 文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T16:50:36.503

好吧，DBGrid 中显示的数据由附加到该 dbgrid 的数据集提供，因此将 DBGrid 中的数据导出为 PDF 意味着将数据集中的数据导出为 PDF。

最简单的选择是使用报告工具。Delphi 有许多不同的报告工具可用，例如 Rave Report、FastReport、Report Builder、QuickReport 等。

此类工具可让您根据数据设计打印报告，并让您打印报告或将其导出为 HTML、DOC、PDF 等格式。Rave Report 随 Delphi 一起提供，您可以免费使用它。我个人喜欢 FastReport 并在我的应用程序中使用它。

另一种选择是，如果您在目标系统上安装了虚拟 PDF 打印机，您可以选择它作为您的打印机并使用 Delphi 的 TPrinter 类直接在打印机画布上书写，您的虚拟 PDF 打印机将为您制作一个 PDF 文件，而不是而不是将数据打印在纸上。

第三种选择是使用专门为 PDF 操作而构建的第三方组件，让您可以在应用程序中创建或编辑 PDF 文件。

问候

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T11:18:03.573

Delphi的[Scalabium](http://www.scalabium.com/)导出套件（包括 2009）支持多种导出格式，包括 PDF 和其他带或不带 OLE 的办公格式。导出组件可以与 TDBGrid 和 TDataSet 后代一起使用。

它可以用于非可视化，但也提供可配置的导出向导。我们在从 Delphi 7 到 2009 的应用程序套件迁移中成功使用了它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T20:58:59.393

试试 EMS 高级数据导出 VCL

[http://sqlmanager.net/en/products/tools/advancedexport](http://sqlmanager.net/en/products/tools/advancedexport)

*   数据（数据集）导出为 17 种最流行的格式：MS Access、MS Excel、MS Word、Open XML Format、Open Document Format (ODF)、RTF、HTML、XML、PDF、TXT、DBF、CSV、SYLK、DIF、LaTeX , SQL 和 Windows 剪贴板
*   Borland Delphi 5-7、2005、2006、CodeGear Delphi 2007、2009 和 Borland C++ Builder 5-6、CodeGear C++ Builder 2007、2009 支持
*   导出 Unicode 数据。为导出的数据手动预设文本编码（UTF-8、UTF-16/UCS-2、UTF-32/UCS-4、Latin1、Latin2、Latin5、Latin7 等）
*   保存数据以供将来查看、修改、打印或网络发布
*   易于使用的向导允许您的最终用户快速导出数据
*   每种数据格式的强大导出选项
*   100% 原生 Delphi 代码
*   无需额外的库或软件即可运行
*   详细的帮助系统和演示应用
*   强大的组件和属性编辑器
*   分别设置每个字段的用户格式
*   多语言支持

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T22:21:32.180

您可以自己遍历数据并使用来自 Gnostice 的出色的导出 VCL eDocEngine。它还连接到报告工具和其他组件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-18T11:32:14.890

```
Public Sub ExportDataTableToPDF(ByVal dtImport As DataTable)
    Dim strQuery As String = "select er_num,er_shortd,er_longd,er_severity from mv_error"
    Dim doc As New Document(iTextSharp.text.PageSize.LETTER, 10, 10, 42, 35)
    Try

        '====================================================================
        'Dim str As String = DateTime.Now.ToString("yyyyMMddHHmmssff")
        'Dim sWebSettingPath As String = ConfigurationSettings.AppSettings("ExptLoctPath")
        'Dim str1 As String = "E:\ExportPdf_File"
        'Dim WorkingFile As String
        'Dim s As String
        'If (Directory.Exists(sWebSettingPath)) Then
        '    s = "already exists"
        '    WorkingFile = Path.Combine(sWebSettingPath, "" & str & " DataTestData.pdf")
        'Else
        '    Dim ss As String = "C:\ReportPDF"
        '    WorkingFile = Path.Combine(str1, "" & str & " DataTestData.pdf")
        '    Directory.CreateDirectory(ss)
        'End If

        '====================================================================

        'Folder Exists in Particular folder or not cheak ifnot create a folder
        Dim strDateTime As String = DateTime.Now.ToString("yyyyMMddHHmmssff")
        Dim sWebSettingPath As String = ConfigurationSettings.AppSettings("ExptLoctPath")
        Dim str1 As String = "E:\ExportPdf_File"
        Dim WorkingFile As String
        Dim s As String
        If (Directory.Exists(sWebSettingPath)) Then
            s = "already exists"
            WorkingFile = Path.Combine(sWebSettingPath, "" & strDateTime & "_DataTestData.pdf")
        Else
            Dim sWebStingNotPath As String = "C:\ReportPDFTest"
            Directory.CreateDirectory(sWebStingNotPath)
            WorkingFile = Path.Combine(sWebStingNotPath, "" & strDateTime & " DataTestData.pdf")

        End If
        '====================================================================

        Dim fs As New FileStream(WorkingFile, FileMode.Create, FileAccess.Write, FileShare.None)

        'Create Document class object and set its size to letter and give space left, right, Top, Bottom Margin
        PdfWriter.GetInstance(doc, fs)
        ' Dim wri As PdfWriter = PdfWriter.GetInstance(doc, New FileStream("C:\Documents and Settings\lessly.l\Desktop\iTextSharp\Test11.pdf", FileMode.Create))
        doc.Open()
        'Open Document to write
        Dim font8 As Font = FontFactory.GetFont("ARIAL", 7)

        'Write some content
        Dim paragraph As New Paragraph("Team :: CataPult")

        Dim dt As DataTable = dtImport

        If dt IsNot Nothing Then
            'Craete instance of the pdf table and set the number of column in that table
            Dim PdfTable As New PdfPTable(dt.Columns.Count)

            Dim PdfPCell As PdfPCell = Nothing
            Dim pdfrow As PdfPRow = Nothing

            For column As Integer = 0 To dt.Columns.Count - 1

                PdfTable.HeaderRows = dt.Columns.Count

                PdfPCell = New PdfPCell(New Phrase(New Chunk(dt.Columns(column).Caption.ToString().ToUpper, New Font(Font.HELVETICA, 8.0F, Font.BOLD, Color.WHITE))))
                PdfPCell.BackgroundColor = New Color(System.Drawing.ColorTranslator.FromHtml("#66CCFF"))

                PdfTable.AddCell(PdfPCell)

            Next

            'Each Row Values added

            For rows As Integer = 0 To dt.Rows.Count - 1
                For column As Integer = 0 To dt.Columns.Count - 1
                    PdfTable.HeaderRows = dt.Columns.Count
                    PdfPCell = New PdfPCell(New Phrase(New Chunk(dt.Rows(rows)(column).ToString(), font8)))
                    PdfTable.AddCell(PdfPCell)
                Next
            Next

            PdfTable.SpacingBefore = 15.0F
            ' Give some space after the text or it may overlap the table
            doc.Add(paragraph)
            ' add paragraph to the document
            ' add pdf table to the document
            doc.Add(PdfTable)

        End If
    Catch docEx As DocumentException
        'handle pdf document exception if any
    Catch ioEx As IOException
        ' handle IO exception
    Catch ex As Exception
        ' ahndle other exception if occurs
    Finally
        'Close document and writer

        doc.Close()
    End Try
End Sub 
```

# c# - 为什么编译器对这行代码有问题？

> ID：898802
> 
> 赞同：2
> 
> 时间：2009-05-22T16:39:49.700
> 
> 标签：c#, string, csc

整个解决方案在 Visual Studio 中构建良好，但是当我运行 Nant 脚本来编译网站时，我在这一行遇到了几个错误：

```
string[] qs = (Request.QueryString["e"] ?? String.Empty)
               .Split(new[] { '?' }, StringSplitOptions.RemoveEmptyEntries); 
```

第一个说 Type Expected，然后是 Syntax error (value expected), ) expected, ; 预期等。我以前在项目中使用过这样的行，它似乎并没有抱怨这些行。

我很确定错误来自对该条件语句调用拆分，但我不知道为什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T16:41:31.367

我建议尝试

```
string[] qs = (Request.QueryString["e"] ?? String.Empty)
    .Split(new char[] { '?' }, StringSplitOptions.RemoveEmptyEntries); 
```

注意`new[]`去`new char[]`。

# sql - 如何在 TSQL 中以随机顺序从表中选择列

> ID：898804
> 
> 赞同：2
> 
> 时间：2009-05-22T16:40:02.463
> 
> 标签：sql, sql-server, tsql

我有一个包含 5 列的表，选择所有行的最简单方法是什么，但是每列是单独随机化的？

我能想到的就是分别选择每一列，以及

```
row_number over ( order by newid()) as lookup 
```

然后在查找时将每一列重新连接在一起。

有没有更简单的方法？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T16:49:08.020

不，差不多就是这样。我假设您想要每列的随机行顺序（不是来自同一随机行的所有列）。

SQL 是基于行的，因此对于 5 列，您需要分隔每个列选择（对于每列的随机行），然后使用任意行将结果连接在一起。

一个有趣的问题...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T17:52:28.670

您可以准备`5`有序集和`PIVOT`它们：

```
SELECT  *
FROM    (
        SELECT  'col1' AS name, col1 AS col, ROW_NUMBER() OVER (ORDER BY NEWID()) AS rn
        FROM    table
        UNION ALL
        SELECT  'col2', col2, ROW_NUMBER() OVER (ORDER BY NEWID())
        FROM    table
        UNION ALL
        SELECT  'col3', col3, ROW_NUMBER() OVER (ORDER BY NEWID())
        FROM    table
        UNION ALL
        SELECT  'col4', col4, ROW_NUMBER() OVER (ORDER BY NEWID())
        FROM    table
        UNION ALL
        SELECT  'col5', col5, ROW_NUMBER() OVER (ORDER BY NEWID())
        FROM    table
        ) q
PIVOT   (
        MIN(col)
        FOR name IN ([col1], [col2], [col3], [col4], [col5])
        ) pt 
```

有关更多详细信息，请参阅我的博客中的此条目：

*   [**独立排序列**](http://explainextended.com/2009/05/22/ordering-columns-independently/)

# asp.net - 从 asp.net 页面重定向

> ID：898808
> 
> 赞同：0
> 
> 时间：2009-05-22T16:40:57.717
> 
> 标签：asp.net, redirect

在使用 vb 的 asp.net 3.5 中，当用户单击按钮时，我想转到我的应用程序中的另一个页面。这样做的命令是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T16:41:16.500

```
Response.Redirect("url") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T16:46:23.077

正如 TheTXI 提到的，`Response.Redirect`它可以正常工作。

但是，您的按钮单击代码要到页面生命周期的后期才会运行。您的服务器可能必须首先做很多额外或不必要的工作。如果这是您*唯一*要做的事情，只需将按钮包装在锚标记中：

```
<a href="url"><asp:button .../></a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T16:46:35.433

这是一个如何发生的[例子](http://www.java2s.com/Code/ASP/Response/RedirectpagetoanotherURLvbnet.htm)

```
 Public Sub Click (ByVal sender As Object, ByVal e As System.EventArgs)
     Response.Redirect(SelectedItem.Text)
 End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T16:50:48.097

server.Transfer("url",true) 更好用，因为它隐藏了你想要传递的变量（如果有的话）。

# sql - 从具有匹配 ID 的不同表中获取总行数

> ID：898818
> 
> 赞同：0
> 
> 时间：2009-05-22T16:42:00.337
> 
> 标签：sql, join

对于我的第一张桌子，我有这样的问题：

```
qid  | question | date
 1      blah      22-05-2009 
```

然后我有表格评论

```
cid | qid
 1     1
 2     1 
 3     1 
```

所以然后在我的问题表中，我可以添加一个包含 total_comments 的列，该列将是三个

我试过使用这段代码

```
SELECT
questions.qid,
questions.question,
questions.date,
sum(comments.qid) AS total_money
FROM
questions
INNER JOIN comments ON comments.qid = questions.qid
ORDER BY questions.date
LIMIT 1 
```

但是它会出错并且仅在有日期更大的行时才抓取第一行？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T16:48:54.573

尝试：

```
;WITH comment_summary AS (
    SELECT comments.qid
        ,COUNT(*) AS comment_count
    FROM comments
    GROUP BY comments.qid
)
SELECT questions.qid
    ,questions.question
    ,questions.date
    ,ISNULL(comment_summary.comment_count, 0) AS comment_count
FROM questions
LEFT JOIN comment_summary
    ON comment_summary.qid = questions.qid
ORDER BY questions.date 
```

或者，如果您的 SQL 方言不支持 CTE：

```
SELECT questions.qid
    ,questions.question
    ,questions.date
    ,ISNULL(comment_summary.comment_count, 0) AS comment_count
FROM questions
LEFT JOIN (
    SELECT comments.qid
        ,COUNT(*) AS comment_count
    FROM comments
    GROUP BY comments.qid
) AS comment_summary
    ON comment_summary.qid = questions.qid
ORDER BY questions.date 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T16:46:34.327

```
 SELECT COUNT(qid), qid
    FROM comments
    GROUP BY qid 
```

将显示每个 qid 的评论数。
如果你想要一个特定的 qid 计数，它将是：

```
SELECT COUNT(qid)
FROM comments
WHERE qid = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T16:46:37.133

您需要在“ORDER BY”之前的语句中包含“GROUP BY questions.qid, questions.question, questions.date”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T16:47:04.933

如果我理解正确，我想你想要：

```
SELECT questions.qid, question, date, SUM(comments.qid) 
FROM Questions 
LEFT OUTER JOIN Comments ON Questions.qid = Comments.qid
GROUP BY Questions.qid, Question, Date
ORDER BY Questions.Date 
```

# c# - 在 C# 中使用 Finalize/Dispose 方法

> ID：898828
> 
> 赞同：406
> 
> 时间：2009-05-22T16:44:45.687
> 
> 标签：c#, .net, idisposable, finalizer

C# 2008

我已经为此工作了一段时间，但我仍然对在代码中使用 finalize 和 dispose 方法感到困惑。我的问题如下：

1.  我知道在处理非托管资源时我们只需要一个终结器。但是，如果有托管资源调用非托管资源，是否还需要实现终结器？

2.  但是，如果我开发一个不直接或间接使用任何非托管资源的类，我是否应该实现`IDisposable`允许该类的客户端使用“使用语句”？

    实现 IDisposable 只是为了让你的类的客户使用 using 语句是否可行？

    ```
    using(myClass objClass = new myClass())
    {
        // Do stuff here
    } 
    ```

3.  我在下面开发了这个简单的代码来演示 Finalize/dispose 的使用：

    ```
    public class NoGateway : IDisposable
    {
        private WebClient wc = null;

        public NoGateway()
        {
            wc = new WebClient();
            wc.DownloadStringCompleted += wc_DownloadStringCompleted;
        }

        // Start the Async call to find if NoGateway is true or false
        public void NoGatewayStatus()
        {
            // Start the Async's download
                // Do other work here
            wc.DownloadStringAsync(new Uri(www.xxxx.xxx));
        }

        private void wc_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)
        {
            // Do work here
        }

        // Dispose of the NoGateway object
        public void Dispose()
        {
            wc.DownloadStringCompleted -= wc_DownloadStringCompleted;
            wc.Dispose();
            GC.SuppressFinalize(this);
        }
    } 
    ```

关于源代码的问题：

1.  这里我没有添加终结器，通常终结器会被GC调用，终结器会调用Dispose。由于我没有终结器，我什么时候调用 Dispose 方法？是必须调用它的类的客户端吗？

    因此，我在示例中的类称为 NoGateway，客户端可以像这样使用和处置该类：

    ```
    using(NoGateway objNoGateway = new NoGateway())
    {
        // Do stuff here   
    } 
    ```

    执行到 using 块的末尾时会自动调用 Dispose 方法，还是客户端必须手动调用 dispose 方法？IE

    ```
    NoGateway objNoGateway = new NoGateway();
    // Do stuff with object
    objNoGateway.Dispose(); // finished with it 
    ```

2.  我在`WebClient`课堂上使用该`NoGateway`课程。因为`WebClient`实现了`IDisposable`接口，这是否意味着`WebClient`间接使用了非托管资源？是否有严格的规则来遵循这一点？我怎么知道一个类使用了非托管资源？

* * *

## 回答 #1

> 赞同：444
> 
> 时间：2009-05-22T16:52:59.980

推荐的 IDisposable 模式在[这里](https://msdn.microsoft.com/en-us/library/fs2xkftw(v=vs.110).aspx)。在编写使用 IDisposable 的类时，通常应该使用两种模式：

当实现一个不使用非托管资源的密封类时，您只需像普通接口实现一样实现一个 Dispose 方法：

```
public sealed class A : IDisposable
{
    public void Dispose()
    {
        // get rid of managed resources, call Dispose on member variables...
    }
} 
```

当实现一个非密封类时，这样做：

```
public class B : IDisposable
{    
    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (disposing)
        {
            // get rid of managed resources
        }   
        // get rid of unmanaged resources
    }

    // only if you use unmanaged resources directly in B
    //~B()
    //{
    //    Dispose(false);
    //}
} 
```

请注意，我没有在`B`;中声明终结器。如果您有实际的非托管资源要处置，您应该只实施终结器。CLR 处理可终结对象与不可终结对象的方式不同，即使`SuppressFinalize`被调用也是如此。

因此，除非必须，否则不应声明终结器，但如果您的类的继承者`Dispose`直接使用非托管资源，则您可以为其调用并自己实现终结器：

```
public class C : B
{
    private IntPtr m_Handle;

    protected override void Dispose(bool disposing)
    {
        if (disposing)
        {
            // get rid of managed resources
        }
        ReleaseHandle(m_Handle);

        base.Dispose(disposing);
    }

    ~C() {
        Dispose(false);
    }
} 
```

如果您不直接使用非托管资源（`SafeHandle`并且朋友不计算在内，因为他们声明了自己的终结器），那么不要实现终结器，因为 GC 以不同的方式处理可终结的类，即使您稍后禁止终结器。另请注意，即使`B`没有终结器，它仍会调用`SuppressFinalize`以正确处理任何实现终结器的子类。

当一个类实现 IDisposable 接口时，这意味着在某个地方存在一些非托管资源，当您使用完该类时应该摆脱这些资源。实际资源封装在类中；您不需要明确删除它们。只需在 a 中调用`Dispose()`或包装类`using(...) {}`将确保在必要时摆脱任何非托管资源。

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2010-01-29T17:19:14.513

实现的官方模式`IDisposable`很难理解。我相信这个[更好](http://codecrafter.blogspot.com/2010/01/better-idisposable-pattern.html)：

```
public class BetterDisposableClass : IDisposable {

  public void Dispose() {
    CleanUpManagedResources();
    CleanUpNativeResources();
    GC.SuppressFinalize(this);
  }

  protected virtual void CleanUpManagedResources() { 
    // ...
  }
  protected virtual void CleanUpNativeResources() {
    // ...
  }

  ~BetterDisposableClass() {
    CleanUpNativeResources();
  }

} 
```

一个[更好](http://codecrafter.blogspot.com/2010/01/revisiting-idisposable.html)的解决方案是制定一个规则，即您**始终**必须为需要处理的任何非托管资源创建一个包装类：

```
public class NativeDisposable : IDisposable {

  public void Dispose() {
    CleanUpNativeResource();
    GC.SuppressFinalize(this);
  }

  protected virtual void CleanUpNativeResource() {
    // ...
  }

  ~NativeDisposable() {
    CleanUpNativeResource();
  }

} 
```

和[`SafeHandle`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.safehandle.aspx)它的衍生物，这些类应该是*非常少见的*。

不直接处理非托管资源的一次性类（即使存在继承）的结果是强大的：**它们不再需要关心非托管资源**。它们很*容易*实现和理解：

```
public class ManagedDisposable : IDisposable {

  public virtual void Dispose() {
    // dispose of managed resources
  }

} 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2010-01-13T21:40:07.420

请注意，任何 IDisposable 实现都应遵循以下模式（恕我直言）。我根据几个优秀的 .NET“神”和[.NET Framework 设计指南](https://rads.stackoverflow.com/amzn/click/com/0321545613)（请注意，MSDN 出于某种原因不遵循这一点！）的信息开发了这种模式。.NET Framework 设计指南由 Krzysztof Cwalina（当时的 CLR 架构师）和 Brad Abrams（我相信当时的 CLR 项目经理）和 Bill Wagner（[Effective C#] 和 [More Effective C#]（只需在 Amazon.com 上查找这些：

请注意，除非您的类直接包含（而不是继承）非托管资源，否则您永远不应该实现终结器。一旦你在一个类中实现了一个终结器，即使它从未被调用，它也可以保证为一个额外的集合而存在。它会自动放置在 Finalization Queue（在单个线程上运行）中。另外，一个非常重要的注意事项......在终结器中执行的所有代码（如果您需要实现一个）必须是线程安全和异常安全的！否则会发生不好的事情......（即未确定的行为，在异常的情况下，致命的不可恢复的应用程序崩溃）。

我整理的模式（并为其编写了代码片段）如下：

```
#region IDisposable implementation

//TODO remember to make this class inherit from IDisposable -> $className$ : IDisposable

// Default initialization for a bool is 'false'
private bool IsDisposed { get; set; }

/// <summary>
/// Implementation of Dispose according to .NET Framework Design Guidelines.
/// </summary>
/// <remarks>Do not make this method virtual.
/// A derived class should not be able to override this method.
/// </remarks>
public void Dispose()
{
    Dispose( true );

    // This object will be cleaned up by the Dispose method.
    // Therefore, you should call GC.SupressFinalize to
    // take this object off the finalization queue 
    // and prevent finalization code for this object
    // from executing a second time.

    // Always use SuppressFinalize() in case a subclass
    // of this type implements a finalizer.
    GC.SuppressFinalize( this );
}

/// <summary>
/// Overloaded Implementation of Dispose.
/// </summary>
/// <param name="isDisposing"></param>
/// <remarks>
/// <para><list type="bulleted">Dispose(bool isDisposing) executes in two distinct scenarios.
/// <item>If <paramref name="isDisposing"/> equals true, the method has been called directly
/// or indirectly by a user's code. Managed and unmanaged resources
/// can be disposed.</item>
/// <item>If <paramref name="isDisposing"/> equals false, the method has been called by the 
/// runtime from inside the finalizer and you should not reference 
/// other objects. Only unmanaged resources can be disposed.</item></list></para>
/// </remarks>
protected virtual void Dispose( bool isDisposing )
{
    // TODO If you need thread safety, use a lock around these 
    // operations, as well as in your methods that use the resource.
    try
    {
        if( !this.IsDisposed )
        {
            if( isDisposing )
            {
                // TODO Release all managed resources here

                $end$
            }

            // TODO Release all unmanaged resources here

            // TODO explicitly set root references to null to expressly tell the GarbageCollector
            // that the resources have been disposed of and its ok to release the memory allocated for them.

        }
    }
    finally
    {
        // explicitly call the base class Dispose implementation
        base.Dispose( isDisposing );

        this.IsDisposed = true;
    }
}

//TODO Uncomment this code if this class will contain members which are UNmanaged
// 
///// <summary>Finalizer for $className$</summary>
///// <remarks>This finalizer will run only if the Dispose method does not get called.
///// It gives your base class the opportunity to finalize.
///// DO NOT provide finalizers in types derived from this class.
///// All code executed within a Finalizer MUST be thread-safe!</remarks>
//  ~$className$()
//  {
//     Dispose( false );
//  }
#endregion IDisposable implementation 
```

这是在派生类中实现 IDisposable 的代码。请注意，您不需要在派生类的定义中显式列出从 IDisposable 继承的内容。

```
public DerivedClass : BaseClass, IDisposable (remove the IDisposable because it is inherited from BaseClass)

protected override void Dispose( bool isDisposing )
{
    try
    {
        if ( !this.IsDisposed )
        {
            if ( isDisposing )
            {
                // Release all managed resources here

            }
        }
    }
    finally
    {
        // explicitly call the base class Dispose implementation
        base.Dispose( isDisposing );
    }
} 
```

我已经在我的博客上发布了这个实现：[如何正确实现 Dispose 模式](http://dave-black.blogspot.com/2011/03/how-do-you-properly-implement.html)

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2010-01-14T00:25:15.513

我同意[pm100](https://stackoverflow.com/a/2060550/3195477)（并且应该在我之前的帖子中明确说明这一点）。

除非你需要，否则你永远不应该在一个类中实现 IDisposable。具体来说，大约有 5 次您需要/应该实现 IDisposable：

1.  您的类显式包含（即不是通过继承）任何实现 IDisposable 的托管资源，一旦您的类不再使用，就应该清理它们。例如，如果您的类包含 Stream、DbCommand、DataTable 等的实例。

2.  您的类显式包含任何实现 Close() 方法的托管资源 - 例如 IDataReader、IDbConnection 等。请注意，其中一些类确实通过具有 Dispose() 和 Close() 方法来实现 IDisposable。

3.  您的类明确包含非托管资源 - 例如 COM 对象、指针（是的，您可以在托管 C# 中使用指针，但它们必须在“不安全”块中声明等。在非托管资源的情况下，您还应该确保在 RCW 上调用 System.Runtime.InteropServices.Marshal.ReleaseComObject()。尽管理论上 RCW 是一个托管包装器，但仍然存在引用计数。

4.  如果您的班级使用强引用订阅事件。您需要从事件中注销/分离自己。在尝试注销/分离它们之前，请始终确保它们不为空！

5.  您的课程包含上述任何组合...

使用 COM 对象并且必须使用 Marshal.ReleaseComObject() 的推荐替代方法是使用 System.Runtime.InteropServices.SafeHandle 类。

BCL（基类库团队）在这里有一篇很好的博客文章[http://blogs.msdn.com/bclteam/archive/2005/03/16/396900.aspx](http://blogs.msdn.com/bclteam/archive/2005/03/16/396900.aspx)

**一个非常重要的注意事项是，如果您正在使用 WCF 并清理资源，您应该几乎总是避免使用“使用”块。那里有很多博客文章，还有一些在 MSDN 上关于为什么这是一个坏主意。我也在这里发布过 -[不要在 WCF 代理中使用 'using()'](http://dave-black.blogspot.com/2012/03/dont-use-using-with-wcf-proxy.html)**

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-07-20T16:25:06.647

使用 lambdas 而不是 IDisposable。

我从来没有对整个 using/IDisposable 的想法感到兴奋。问题是它要求调用者：

*   知道他们必须使用 IDisposable
*   记得使用“使用”。

我的新首选方法是使用工厂方法和 lambda

想象一下，我想用 SqlConnection 做一些事情（应该包含在 using 中的东西）。经典地你会做

```
using (Var conn = Factory.MakeConnection())
{
     conn.Query(....);
} 
```

新方法

```
Factory.DoWithConnection((conn)=>
{
    conn.Query(...);
} 
```

在第一种情况下，调用者根本无法使用 using 语法。在第二种情况下，用户别无选择。没有创建SqlConnection 对象的方法，调用者必须调用DoWithConnection。

DoWithConnection 看起来像这样

```
void DoWithConnection(Action<SqlConnection> action)
{
   using (var conn = MakeConnection())
   {
       action(conn);
   }
} 
```

`MakeConnection`现在是私人的

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2010-01-13T21:53:49.110

没有人回答有关是否应该实施 IDisposable 的问题，即使您不需要它。

简短的回答：没有

长答案：

这将允许您班级的消费者使用“使用”。我要问的问题是——他们为什么要这样做？大多数开发人员不会使用“使用”，除非他们知道他们必须 - 以及他们是如何知道的。任何一个

*   从经验中可以看出他们（例如套接字类）
*   其记录在案
*   他们很谨慎，可以看到该类实现了 IDisposable

因此，通过实现 IDisposable 你是在告诉开发者（至少是一些）这个类包含了一些必须发布的东西。他们将使用“使用”——但在其他情况下使用是不可能的（对象的范围不是本地的）；在其他情况下，他们将不得不开始担心对象的生命周期——我肯定会担心。但这不是必需的

您实现 Idisposable 以使他们能够使用 using，但除非您告诉他们，否则他们不会使用 using。

所以不要这样做

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-08-28T10:57:14.353

处置模式：

```
public abstract class DisposableObject : IDisposable
{
    public bool Disposed { get; private set;}      

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    ~DisposableObject()
    {
        Dispose(false);
    }

    private void Dispose(bool disposing)
    {
        if (!Disposed)
        {
            if (disposing)
            {
                DisposeManagedResources();
            }

            DisposeUnmanagedResources();
            Disposed = true;
        }
    }

    protected virtual void DisposeManagedResources() { }
    protected virtual void DisposeUnmanagedResources() { }
} 
```

继承示例：

```
public class A : DisposableObject
{
    public Component components_a { get; set; }
    private IntPtr handle_a;

    protected override void DisposeManagedResources()
    {
        try
        {
          Console.WriteLine("A_DisposeManagedResources");
          components_a.Dispose();
          components_a = null;
        }
        finally
        { 
          base.DisposeManagedResources();
        }
    }

    protected override void DisposeUnmanagedResources()
    {
        try
        {
          Console.WriteLine("A_DisposeUnmanagedResources");
          CloseHandle(handle_a);
          handle_a = IntPtr.Zero;
        }
        finally
        { 
          base.DisposeUnmanagedResources();
        }
    }
}

public class B : A
{
    public Component components_b { get; set; }
    private IntPtr handle_b;

    protected override void DisposeManagedResources()
    {
        try
        {
          Console.WriteLine("B_DisposeManagedResources");
          components_b.Dispose();
          components_b = null;
        }
        finally
        { 
          base.DisposeManagedResources();
        }
    }

    protected override void DisposeUnmanagedResources()
    {
        try
        {
          Console.WriteLine("B_DisposeUnmanagedResources");
          CloseHandle(handle_b);
          handle_b = IntPtr.Zero;
        }
        finally
        { 
          base.DisposeUnmanagedResources();
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-22T16:55:34.987

1.  如果您正在使用使用非托管资源的其他托管对象，则确保这些对象已完成不是您的责任。您的责任是在对您的对象调用 Dispose 时对这些对象调用 Dispose，并且它会停在那里。

2.  如果您的课程不使用任何稀缺资源，我看不出您为什么要让您的课程实现 IDisposable。只有在以下情况下，您才应该这样做：

    *   知道你很快就会在你的对象中拥有稀缺的资源，而不是现在（我的意思是“我们仍在开发，它会在我们完成之前就在这里”，而不是“我认为我们需要这个")
    *   利用稀缺资源
3.  是的，使用您的代码的代码必须调用对象的 Dispose 方法。是的，使用您的对象的代码可以`using`像您展示的那样使用。

4.  （又是 2 次？）WebClient 可能使用非托管资源或其他实现 IDisposable 的托管资源。然而，确切的原因并不重要。重要的是它实现了 IDisposable，因此当您完成对象时，即使 WebClient 根本不使用任何其他资源，也需要您通过处置该对象来根据该知识采取行动。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-03-09T14:48:51.353

由于两个原因，[另一个答案](http://%20stackoverflow.com/a/898856/3195477)的某些方面略有不正确：

第一的，

```
using(NoGateway objNoGateway = new NoGateway()) 
```

实际上相当于：

```
try
{
    NoGateway = new NoGateway();
}
finally
{
    if(NoGateway != null)
    {
        NoGateway.Dispose();
    }
} 
```

这听起来很荒谬，因为除非您有 OutOfMemory 异常，否则“new”运算符永远不应该返回“null”。但请考虑以下情况： 1\. 您调用返回 IDisposable 资源的 FactoryClass 或 2\. 如果您有一个类型可能会或可能不会从 IDisposable 继承，具体取决于其实现 - 请记住，我已经看到 IDisposable 模式被错误地实现了很多在许多客户端，开发人员只是添加一个 Dispose() 方法而不从 IDisposable 继承（坏、坏、坏）。您还可能遇到从属性或方法返回 IDisposable 资源的情况（再次糟糕，糟糕，糟糕 - 不要“放弃您的 IDisposable 资源）

```
using(IDisposable objNoGateway = new NoGateway() as IDisposable)
{
    if (NoGateway != null)
    {
        ... 
```

如果“as”运算符返回 null（或返回资源的属性或方法），并且您在“using”块中的代码防止出现“null”，则在尝试对 null 对象调用 Dispose 时，您的代码不会因为以下原因而崩溃“内置”空值检查。

您的回复不准确的第二个原因是由于以下 stmt：

> 在 GC 销毁您的对象时调用终结器

首先，最终化（以及 GC 本身）是不确定的。CLR 确定何时调用终结器。即开发人员/代码不知道。如果正确实现了 IDisposable 模式（正如我在上面发布的）并且已调用 GC.SuppressFinalize()，则不会调用终结器。这是正确实现模式的重要原因之一。由于每个托管进程只有 1 个 Finalizer 线程，无论逻辑处理器的数量是多少，您都可以通过忘记调用 GC.SuppressFinalize() 备份甚至挂起 Finalizer 线程来轻松降低性能。

我已经在我的博客上发布了 Dispose 模式的正确实现：[如何正确实现 Dispose 模式](http://dave-black.blogspot.com/2011/03/how-do-you-properly-implement.html)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-22T16:50:58.203

1) WebClient 是托管类型，因此您不需要终结器。如果您的用户不使用 NoGateway 类的 Dispose() 并且需要在之后清理本机类型（不被 GC 收集），则需要终结器。在这种情况下，如果用户不调用 Dispose()，则包含的 WebClient 将在 NoGateway 之后立即被 GC 释放。

2）间接是的，但您不必担心。你的代码是正确的，你不能防止你的用户很容易忘记 Dispose()。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-03-28T09:52:50.790

**来自 msdn 的模式**

```
public class BaseResource: IDisposable
{
   private IntPtr handle;
   private Component Components;
   private bool disposed = false;
   public BaseResource()
   {
   }
   public void Dispose()
   {
      Dispose(true);      
      GC.SuppressFinalize(this);
   }
   protected virtual void Dispose(bool disposing)
   {
      if(!this.disposed)
      {        
         if(disposing)
         {
            Components.Dispose();
         }         
         CloseHandle(handle);
         handle = IntPtr.Zero;
       }
      disposed = true;         
   }
   ~BaseResource()      
   {      Dispose(false);
   }
   public void DoSomething()
   {
      if(this.disposed)
      {
         throw new ObjectDisposedException();
      }
   }
}
public class MyResourceWrapper: BaseResource
{
   private ManagedResource addedManaged;
   private NativeResource addedNative;
   private bool disposed = false;
   public MyResourceWrapper()
   {
   }
   protected override void Dispose(bool disposing)
   {
      if(!this.disposed)
      {
         try
         {
            if(disposing)
            {             
               addedManaged.Dispose();         
            }
            CloseHandle(addedNative);
            this.disposed = true;
         }
         finally
         {
            base.Dispose(disposing);
         }
      }
   }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-22T16:50:11.437

```
using(NoGateway objNoGateway = new NoGateway()) 
```

相当于

```
try
{
    NoGateway = new NoGateway();
}

finally
{
    NoGateway.Dispose();
} 
```

在 GC 销毁您的对象时调用终结器。这可能与您离开方法时完全不同。离开 using 块后立即调用 IDisposable 的 Dispose。因此，该模式通常用于在您不再需要资源后立即使用 using 来释放资源。

* * *

## 回答 #13

> 赞同：-5
> 
> 时间：2009-05-22T16:56:53.360

据我所知，强烈建议不要使用终结器/析构函数：

```
public ~MyClass() {
  //dont use this
} 
```

大多数情况下，这是由于不知道何时或是否会调用它。dispose 方法要好得多，特别是如果您直接使用或 dispose。

使用是好的。用它 ：）

# .net - 如何从 .Net Web 服务返回 DataTable？

> ID：898829
> 
> 赞同：3
> 
> 时间：2009-05-22T16:45:10.177
> 
> 标签：.net, web-services, json, datatable

我已经能够从为 .Net 2.0 设置的 Web 服务返回 HashTable，但该服务无法以 JSON 格式重新调整 DataTable。我不断收到以下错误：“序列化对象时检测到循环引用”。有小费吗？

```
 [WebMethod(EnableSession = true) ]
public DataTable getSavedAddresses()
{
    DataTable dt = new DataTable();
    if (Session["ClientID"] != null)
    {
        int clientId = Convert.ToInt32(Session["ClientID"]);
        dt = Address.GetClientShippingAddresses(clientId);
    }
    return dt; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T19:56:02.623

循环引用很可能是因为`DataTable`有一个`Columns`属性，每个`DataColumn`对象都有一个`Table`属性。

[Rick Strahl](http://www.west-wind.com/Weblog/posts/471835.aspx)的这篇博文中的信息或许对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-13T23:18:34.250

只是快速重新访问这个老问题......我这样做：

```
var header = datatable.Columns.Cast<DataColumn>().Select(r => new KeyValuePair<string, object>(r.ColumnName, r.DataType.Name));
var data = datatable.Select().AsEnumerable()
    .Select(r => r.Table.Columns.Cast<DataColumn>()
        .Select(c => new KeyValuePair<string, object>(c.ColumnName, r[c.Ordinal] is DBNull ? null : r[c.Ordinal] )
    ).ToDictionary(z=>z.Key,z=>z.Value)
);

return new DatatableRequestResponse
{
    data = data,
    header = header
}; 
```

# .net - 在 ASP.NET 上将 XSLT 应用于 XML

> ID：898831
> 
> 赞同：3
> 
> 时间：2009-05-22T16:45:26.933
> 
> 标签：.net, asp.net, xml, xslt

我在这里学习教程：[http ://www.aspfree.com/c/a/XML/Applying-XSLT-to-XML-Using-ASP.NET/2/](http://www.aspfree.com/c/a/XML/Applying-XSLT-to-XML-Using-ASP.NET/2/)

本教程展示了如何通过 xslt 将 xml 转换为 html。不幸的是，第一步是“将 XML 控件从工具箱拖到 Web 窗体上”。这是工具的哪个部分，他们在谈论哪个控件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T16:56:57.027

它位于工具箱的标准部分。

您也可以通过源视图创建它：

```
<asp:Xml ID="xmlMyXmlControl" runat="server" DocumentSource="myXml.xml" TransformSource="myXsl.xsl"></asp:Xml> 
```

可以在 MSDN 站点上找到有关此控件的其他信息：http: [//msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.xml.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.xml.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-17T19:46:21.673

它在 Visual Studio 的“标准”菜单中称为“Xml”。

# enterprise-library - Enterprise Library 1.0 是否支持 sql server 2005

> ID：898840
> 
> 赞同：0
> 
> 时间：2009-05-22T16:46:58.147
> 
> 标签：enterprise-library

我曾经连接到SQL Server2000。是否可以改成SQL Server2005？如果是，如何更改设置？多谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T17:08:16.967

您可以使用基本相同的连接字符串连接到 MSSQL2k5，向后兼容是 MS 平台的一大特点。

请注意，您需要将表（可能还有数据库）迁移到新服务器安装的数据库中。

我记得 EntLib 1.0 代码没有利用 MSSQL2k5 上的功能。

# math - 如何使用四元数围绕一个点旋转对象？

> ID：898848
> 
> 赞同：5
> 
> 时间：2009-05-22T16:48:50.313
> 
> 标签：math, 3d

在我的 3D 应用程序中，我将对象的位置存储在一个向量中，并且它以四元数围绕原点旋转。我需要围绕具有任意原点的向量旋转对象。我尝试将位置 - vectorOrigin 和旋转转换为矩阵，旋转矩阵，然后从结果矩阵中提取位置和旋转作为向量和四元数。位置正常，但旋转保持不变（对象围绕给定向量旋转，但始终面向同一方向）。

我的方法是错误的还是我有错误？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T17:10:56.043

我不确定您为什么希望轮换发生变化。您有代表起点、终点和旋转的程序化“生物”。根据其他两个“生物”计算目标点不应影响它们。

通常的方法呢？如果您需要围绕点 (a, b, c) 旋转位置 (x, y, z)，首先平移位置，以便旋转围绕原点：使用 (xa, yb, zc) 作为位置，像往常一样围绕原点旋转以获得新的平移位置（x'-a，y'-b，z'-c），然后平移回来并获得新位置（x'，y'，z'）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T17:16:49.733

我对四元数不熟悉，也许这完全是题外话，但你不能围绕一个点旋转一个 3d 对象，旋转轴必须是一条线。

# wpf - 在 DataTemplate 中为 MenuItem 指定命令

> ID：898852
> 
> 赞同：20
> 
> 时间：2009-05-22T16:49:28.643
> 
> 标签：wpf, datatemplate, command

我有一个上下文菜单。它绑定到某个集合，并且它具有如下定义的 ItemTemplate：

```
<ContextMenu
    ItemsSource={Binding ...}
    ItemTemplate={StaticResource itemTemplate}
    /> 
```

itemTemplate 是一个带有 TextBlock 的简单 DataTemplate：

```
<DataTemplate x:Key="itemTemplate">
    <TextBlock Text={Binding ...} />
</DataTemplate> 
```

如何将 MenuItem 的 Command 属性绑定到基础对象的属性？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-22T16:56:38.727

我认为您需要将 TextBlock 包装在 MenuItem 中：

```
<DataTemplate x:Key="itemTemplate">
    <MenuItem Command={Binding ...}>
        <TextBlock Text={Binding ...} />
    </MenuItem>
</DataTemplate> 
```

但是我现在没有 IDE 来尝试这个。让我知道事情的后续。

* * *

看起来您需要使用[这里](http://weblogs.asp.net/okloeten/archive/2007/11/14/5149692.aspx)看到的 ItemContainerStyle 。很抱歉一开始就让你走错了路——但我在一个 IDE 前面，这很有效：

```
<ContextMenu.ItemContainerStyle>
    <Style TargetType="MenuItem">
        <Setter Property="Command" Value="{Binding ...}"/>
    </Style>
</ContextMenu.ItemContainerStyle> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-04T19:33:41.867

虽然这只是马丁哈里斯答案的微小变化，但我想我还是会分享它。我发现为整个集合指定单个命令并发送命令参数更有用：

```
<MenuItem.ItemContainerStyle>
    <Style TargetType="MenuItem">
       <Setter Property="Command" Value="{x:Static v:ViewModel.CommandForAll}"/>
       <Setter Property="CommandParameter" Value="{Binding ValueForCommand}"/>
    </Style>
</MenuItem.ItemContainerStyle> 
```

然后您可以确定在该命令的处理程序中要做什么：

```
private void CommandForAll_Executed(object sender, ExecutedRoutedEventArgs e)
{
    var cmdParam = e.Paramater as ExpectedType
    if (cmdParam != null)
        //DoStuff...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-03T07:30:29.263

我意识到我在事后回答了这个问题，但我遇到了同样的问题，以前的答案似乎使绑定到多个不同的命令变得困难。我到达的解决方案与 MatrixManAtYrService 非常相似，分为 3 个部分：

1）使用 ItemContainerStyle 属性将命令绑定到 ViewModel 中的命令——这与前面的答案相同。一个例外是我将 CommandParameter 绑定到 MenuItem。

```
<Setter Property="CommandParameter" Value="{Binding RelativeSource={RelativeSource Self}}"/> 
```

2) 创建一个自定义类来定义每个 MenuItem 的外观和行为。菜单的 ItemsSource 将设置为这些列表。这与其他答案相同。但是，在我的实现中，我为类提供了一个 Action，以便在调用 MenuItemCommand 时执行。我还包括了一个允许禁用 MenuItem 的布尔值。

```
public class MenuAction
{
    public string Name { get => name; set => name = value; }
    public Action Action { get => action; set => action = value; }
    public bool CanExecute { get => canExecute; set => canExecute = value; }
} 
```

3) 在命令执行路由控制到MenuAction 中的代表。

```
public void HandleCommand(object sender)
{
    MenuItem clickedMenuItem = sender as MenuItem;
    MenuAction menuAction = clickedMenuItem?.DataContext as MenuAction;
    if(menuAction != null)
        menuAction.Action();
}

public bool CanMenuItemExecute(object sender)
{
    MenuItem clickedMenuItem = sender as MenuItem;
    MenuAction menuAction = clickedMenuItem?.DataContext as MenuAction;
    if (menuAction != null)
        return menuAction.CanExecute;
    else
        return false;
} 
```

这应该允许您在列表中定义命令的所有行为。虽然它在技术上绑定到单个命令，但它在功能上类似于拥有多个不同的命令。同样的方法也应该适用于嵌套的 MenuItems 和 HierarchicalDataTemplates 并进行一些调整。

# asp.net - 将虚拟目录中的 IIS/ASP 应用程序转换为具有专用 IP 的新网站时性能下降

> ID：898864
> 
> 赞同：0
> 
> 时间：2009-05-22T16:51:57.643
> 
> 标签：asp.net, iis

我有一个在默认 IIS 网站下的虚拟目录中运行的 asp.net 应用程序。

在使用自己的 IP 地址（在同一台机器上）将其部署到自己的网站后，性能会急剧下降。

我的第一个猜测可能是这可能是某种路由问题，但我对网络端的东西不是太敏锐，所以我不确定我应该首先看什么。或者，也许这完全是另一回事？

更新：这个场景中的其他一切都保持不变，本质上，创建了一个具有静态 IP 地址的新网站，指向一个新文件夹，虚拟目录中的*所有文件都被复制到该文件夹​​。*

整个网站看起来很慢（但它会随着时间的推移而上下波动）......图像，脚本，你的名字。没有非常不寻常的内存或 CPU 消耗。

是否有*可能*是某种路由问题？如果是这样，一个人将如何诊断？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T20:07:36.470

您应该使用 ASP.Net 跟踪来检测您的应用程序是否缓慢或网络配置有问题。

`Trace="true"`您可以通过在 aspx 中添加页面指令来启用页面级别的跟踪：

```
<%@ Page Trace="true" %> 
```

或者您也可以通过 web.config 为整​​个应用程序启用跟踪：

```
<configuration>
  <system.web>
    <trace enabled="true" requestLimit="40" localOnly="false"/>
  </system.web>
</configuration> 
```

有关更多详细信息，请查看[ASP.Net Trace 上的 MSDN 文章。](http://www.eggheadcafe.com/articles/20050613.asp)

我的赌注（我遇到的问题）：

1.  ASP.Net 配置问题
    *   一些重要参数的默认值`machine.config`非常低您应该检查以下参数：
        *   `maxconnection`
        *   `maxIoThreads`
        *   `maxWorkerThreads`
        *   `minFreeThreads`
        *   `minLocalRequestFreeThreads`
    *   以下是描述和推荐值： [IIS 6.0 Tuning for Performance](http://msdn.microsoft.com/en-us/library/y13fw6we(VS.71).aspx)
2.  数据库问题
    *   另一台服务器上的数据库和应用程序非常健谈（很多小查询）
    *   另一台服务器上的数据库和导致延迟的内部网络配置错误
3.  网络配置问题

    *   检查路由
    *   呼叫网络管理员

    检查这个 SO 问题以获得更多想法：[ASP.NET 性能瓶颈之谜](https://stackoverflow.com/questions/242614/an-asp-net-performance-bottleneck-mystery/243460#243460)

# java - java servlets：更好的方法来做多个插入和锁定表？

> ID：898868
> 
> 赞同：0
> 
> 时间：2009-05-22T16:53:01.277
> 
> 标签：java, tsql, servlets, transactions

我目前正在使用建议的 ParparedStatement 类在 java servlet 中运行以下代码段。它目前正在将库存数据插入到会计系统的 SQL Server 数据库中。我有两个问题。

1.  因为插入语句将数据插入到 3 个不同的表中，我应该将这些 sql 语句移动到数据库上的 tsql 过程调用并使用 Transaction 锁定表吗？
2.  每当用户打开会计软件清单屏幕时，最后 2 个插入语句都会失败。我猜软件客户端会在用户打开屏幕时锁定表格。

这是代码：

```
try {   

        con = java.sql.DriverManager.getConnection(getConnectionUrl()); 
        //get next itemkey 
        CallableStatement cstmt = con.prepareCall("{call spGetNextSurrogateKey (?,?)}");
        cstmt.setString("iTableName","timitem");
        cstmt.registerOutParameter("oNewKey", java.sql.Types.INTEGER);
        cstmt.execute(); 
        int rs4 = cstmt.getInt(2);
        cstmt.close();

        String query = "insert into timitem (itemkey, AllowCostOvrd,AllowDecimalQty,AllowDropShip,AllowPriceOvrd,AllowRtrns,AvailForSale,CompanyID,CreateDate,CreateUserID,CreateType,DateEstab,DfltSaleQty,HazMat,InclOnPackList,InternalLongDesc,IntrnlDeliveryReq,ItemClassKey,ItemID,ItemSubType,ItemType,MinGrossProfitPct,MinSaleQty,PerUsageOrdLimit,PriceSeq,PriceUnitMeaskey,PurchProdLineKey,PurchUnitMeasKey,RcptReq,RestockRate,SaleMultiple,SalesUnitMeasKey,Seasonal,ShelfLife,Status,STaxClasskey,StdPrice,StdUnitCost,StockUnitMeasKey,SubjToTradeDisc,TargetMargin,TrackMeth,UpdateCounter,ValuationMeth,WarrantyDays,WarrantyProvider) values ( '" +rs4 + "', 0,0,1,1,1,1,'ens','" + DateFormat.format(Date) + "','admin',1,'" + DateFormat.format(Date) + "',1,0,1,0,0,"+itemclasskey+",'" + partnumber + "',1,5,0,1,0,0,112,"+PurchProdLineKey+","+UnitMeasKey+",1,0,0,112,0,0,1,12,"+ itemlistprice + ","+itemcost + ",112,0,0,2,0,5,0,0)";
        PreparedStatement pstmt = con.prepareStatement(query); 
        pstmt.executeUpdate(); 
        pstmt.close();            

                String query_descrip = "insert into timitemdescription (itemkey, languageid, longdesc, shortdesc) values ('" + rs4 + "', 1033, '" + itemdescription + "','"+ "_" + "')";

                PreparedStatement pstmt2 = con.prepareStatement(query_descrip); 
        pstmt2.executeUpdate();                         
                pstmt2.close();

                String query_UOM = "insert into timItemUnitOfMeas (itemkey, TargetUnitMeasKey, conversionfactor, unitvolume, unitweight,upc,useforpurchases,useforsales,usestdconv) values ('" + rs4 + "', "+UnitMeasKey+", '1',0,0,NULL,0,0,0)";

                PreparedStatement pstmt3 = con.prepareStatement(query_UOM); 
        pstmt3.executeUpdate();                         
                pstmt3.close();

}catch(java.sql.SQLException e){ e.printStackTrace(); }     //end try 
```

有什么建议么？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T17:08:48.917

在底层使用 JDBC，每条语句在执行时都会自动提交。要在单个事务中执行多个语句，请在`setAutoCommit(false)`上调用 ，并通过对连接`Connection`的调用来完成工作单元。`commit()`如果出现故障，请`rollback()`改为调用。

如今，更常见的是拥有像 JPA 这样的持久性机制来管理事务，与框架或容器一起工作。该基础架构可以很好地处理常见的事务场景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T20:53:03.040

我建议您不要在 servlet 中执行此操作。将代码移动到可以离线测试的持久层中，无需 servlet 容器。

我还推荐[Spring 和 JPA](http://java.sys-con.com/node/366275)。对您的应用程序进行分层，使 Web 和持久层不合二为一，这将是一个好主意。

[http://java.sun.com/developer/technicalArticles/J2EE/jpa/](http://java.sun.com/developer/technicalArticles/J2EE/jpa/) [http://www.springsource.org/](http://www.springsource.org/)

# oracle - Oracle 外部表：高级平面文件布局

> ID：898872
> 
> 赞同：3
> 
> 时间：2009-05-22T16:55:32.707
> 
> 标签：oracle, external, sql-loader

我希望在 Oracle 数据库中创建一个外部表，从服务器上的平面文件中检索其数据。这个文件的格式很重要。此文件中的每一行都可以是几种不同布局之一，具体取决于行的前缀（前缀本身始终是固定长度）。例如，以 开头的行与以 开头的行`'TYPE1'`具有不同的布局`'TYPE2'`。

我已经读到外部表可以利用 SQL *Loader 的控制文件可用的所有结构。但是，我读过的任何文档都只用于处理琐碎的平面文件布局，其中所有行都共享一个共同的布局。SQL*`WHEN` Loader 控制文件可以使用以下子句轻松处理这种情况：

```
WHEN (1:5) = 'TYPE1'
(
    field1 POSITION(10:18),
    field2 POSITION(26:35)
)
WHEN (1:5) = 'TYPE2'
(
    field1 POSITION(23:27),
    field2 POSITION(15:19)
) 
```

如何使用 Oracle 的外部表定义语法来表达这样的布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T17:22:49.430

这是来自 9.2 文档，但您需要 LOAD WHEN 子句。

[http://download.oracle.com/docs/cd/B10500_01/server.920/a96652/ch12.htm](http://download.oracle.com/docs/cd/B10500_01/server.920/a96652/ch12.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-01T09:07:35.377

如果你有固定记录试试这个

```
create table EXT_TABLE
(
  record_type        char(2),
  customer_id        char(10),
  customer_name      char(60),
  item_id            char(12)
  quantity           char(10)
)
organization external
(
  type ORACLE_LOADER
  default directory DIR_FLUX_DEV
  access parameters
  (
    RECORDS DELIMITED BY NEWLINE
     BADFILE 'ext_table.bad'
     LOGFILE 'ext_table.log'
     SKIP 0
     FIELDS
    (
     TP_REC               position(1:2)   char(2),
     customer_id          position(3:10)  char(10),
     customer_name        position(13:60) char(60),
     item_id              position(3:12)  char(12),
     quantity             position(15:10) char(10)
    )
  )
  location (DIR_FLUX_DEV:'file.txt')
)
reject limit 0; 
```

然后您可以根据记录类型访问然后列声明游标 c1 是

```
select e.* from ext_table;

begin
  for r in c1 loop
    if r.tp_rec = '02' then
       dbms_output.put_line(r.tp_rec || ' ' || r.customer_id);
    elsif r.tp_rec = '03' then
       dbms_output.put_line(r.tp_rec || ' ' || r.item_id);
    end if;
  end loop;
end; 
```

希望这可以帮助

# c++ - C++ - 线程和多个队列

> ID：898881
> 
> 赞同：5
> 
> 时间：2009-05-22T16:57:14.233
> 
> 标签：c++, multithreading, queue, posix, pthreads

我需要建立一个工人系统（表示为线程）和（多个）队列。单个作业在其中一个队列中等待，并等待工作线程处理它们。每个工作人员只能处理一些队列中的作业。没有旋转等待。C/C++、pthreads、标准 POSIX。

对我来说，问题是“多个队列”的事​​情。我知道如何用一个队列来实现它。工作人员需要等待他们可以处理的所有队列（等待其中的任何一个）。

在 Windows 上，我会使用 WaitForMultipleObjects，但这需要是多平台的。

我不想要任何特定的代码，只想要我应该使用的模型的提示或描述。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T17:19:03.210

怎么样：

*   所有工作线程都在一个信号量上等待
*   当任何东西添加到队列中时，信号量会增加，这会唤醒单个线程
*   线程检查它感兴趣的队列，处理其中一个并返回等待信号量

您将需要额外的互斥锁来控制对队列的实际读写。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T17:03:50.810

您可以做的是使用[条件变量](https://computing.llnl.gov/tutorials/pthreads/#ConditionVariables)。让您的工作线程等待条件变量。当作业被添加到任何作业队列时，向条件变量发出信号。然后，当工作线程唤醒时，它会检查它正在等待的队列。如果他们中的任何一个有工作，它就会将该工作从队列中删除。否则，它会返回等待条件变量。等待条件变量会使线程进入睡眠状态，因此它不会消耗 CPU 时间。

当然，不用说您应该使用互斥锁（例如`pthread_mutex_t`）保护对作业队列的所有访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T17:03:05.180

如果每个队列没有太多工作人员，您可以为每个工作人员创建一个条件变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T17:03:20.950

听起来您应该使用[boost::thread](http://www.boost.org/doc/libs/1_39_0/doc/html/thread.html)、[boost::condition](http://www.boost.org/doc/libs/1_34_0/doc/html/boost/condition.html)和[std::queue](http://www.sgi.com/tech/stl/queue.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T17:04:19.997

我要做的是使用 boost::asio 对数据进行排队，以便您的多个线程可以使用它。您可以通过 post 命令将 ref 传递给队列，并相应地处理线程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T17:04:59.577

与其为每个队列设置一个单独的锁，不如为所有队列设置一个锁？

1.  等锁
2.  拿到锁
3.  从任何队列中出列
4.  释放锁
5.  处理出队的项目
6.  转到第 1 步

假设出队花费的时间可以忽略不计（因此锁只持有可忽略不计的时间），可能不需要多个锁。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T17:08:14.283

你可以这样做：每个作业都有一个与之关联的“队列”。例如：

假设您有 2 个队列。你的工作可以说：

```
job[0].queue = 1; /* That job is in queue 1 */
job[1].queue = 1;
job[2].queue = 2; /* this job is in queue 2 */
... 
etc 
```

那么你就有了你的“线袋”。一个线程简单地选择一个工作——比如说，工作[2]。如果只允许该线程处理来自队列 1 的作业，那么它将将该作业放回就绪队列并选择不同的作业。

所以每个线程都知道它允许处理哪些队列，并且当它选择一个作业时，它确保该作业的“队列”字段匹配。如果没有，它会选择不同的工作。

（这在很多方面是进程调度在 linux 上的多核上的工作方式。每个进程都有一个位掩码，说明允许在哪些处理器上运行，然后处理器确保在这样做之前“允许”它运行该进程。 )

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-25T21:40:14.053

我最近一直在考虑这个问题，我能想到的唯一想法是（假设你有线程安全的队列）只有多个线程服务于一个队列。

然后，您可以让一个或多个工作线程将作业添加到单个队列，并让一个或多个工作线程阻塞队列，直到它们找到要处理的内容。

如果您曾经有多个队列需要多个工作线程轮询，那么解决方案可能是为每个队列添加一个额外的线程和一个额外的队列。额外的线程每个都阻塞在自己的单个队列中，但只是将作业转发到额外的队列。现在，现有的工作线程又回到了阻塞单个队列的状态。

# sql - 适合 MS SQL Server 的表编辑器？

> ID：898885
> 
> 赞同：6
> 
> 时间：2009-05-22T16:58:51.563
> 
> 标签：sql, sql-server, linq

我有用于编辑表格数据的 MS SQL Management Studio，但它的可用性并不好。我需要像在 Excel 中那样编辑数百行，能够对列进行排序以简化编辑过程（SQL Mgmt 仅具有“打开表”功能，没有对列进行排序，与只能使用 UPDATE SQL 代码进行的更新不同）。

LinqPad 很棒，但仅用于查询。我想编辑表格结果。

我安装了 Acqua Studio，它拥有一切，但试用期已过。你知道任何可以做到这一点的免费软件替代品吗？

**编辑**：我确实需要更改和输入数据，当然我可以通过 SQL 代码来完成，但是当您必须手动更新大量行时它并不快。我需要一个**可编辑的有序网格**。我会试试 MSManager Lite。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T17:17:39.513

我将这个工具永久保存在 USB 记忆棒上 - 真的非常适合免费的“精简”版（也有专业版）

[http://sqlmanager.net/products/mssql/manager](http://sqlmanager.net/products/mssql/manager)

它是一个单一的整体 exe，非常适合便携性。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T17:05:03.150

我建议学习必要的 SQL 来更新表中的适当数据。您可以使用带有 ORDER BY 子句的 SELECT 语句以您希望查看的顺序查看数据，然后构建查询来更新该数据。

您可以使用事务来确保您的更新是正确的（如果您仍在学习 SQL 并且不想弄乱数据库）。

```
BEGIN TRANSACTION -- starts a transaction
ROLLBACK          -- stops the transaction and rolls back all changes to the tables
COMMIT            -- stops the transaction and commits all changes to the tables 
```

您要完成/更新什么，也许我们可以帮助您？

**编辑**

您提到您想要编辑存储在表格中的一些产品名称。这将是一项一次性的任务。我在下面设置了一个小演示，希望能帮助指导您找到适合您情况的解决方案。将其复制并粘贴到 SQL Management Studio 会话中。

此外，如果您愿意，您可以将当前数据导出为 excel，在 excel 中编辑该数据，将其作为新的临时表导入并运行 SQL 更新脚本来更新原始表。

```
/*
Products Before Update          Products After Update
===========================     =============================================
ID      ProductName             ID      ProductName
---------------------------     ---------------------------------------------
1       MSFT                    1       Microsoft Corp.
2       APPL                    2       Apple Inc.
3       Cisco Systems, Inc.     3       Cisco Systems, Inc.
4       IBM                     4       International Business Machines Corp.
5       JAVA                    5       Sun Microsystems, Inc.
6       ORCL                    6       Oracle Corp.
*/

-- Imagine that this table is a table in your database
DECLARE @products TABLE (
                        ID          INT,
                        ProductName VARCHAR(255)
                        )

-- And this table has some product information
-- which you are trying to update with new information
INSERT  @products
SELECT  1, 'MSFT' UNION ALL
SELECT  2, 'APPL' UNION ALL
SELECT  3, 'Cisco Systems, Inc.' UNION ALL
SELECT  4, 'IBM' UNION ALL
SELECT  5, 'JAVA' UNION ALL
SELECT  6, 'ORCL'

-- Either build an in-memory temporary table of the product names you wish to update
-- Or do a database task to import data from excel into a temporary table in the database
DECLARE @products_update TABLE  (
                                ID          INT,
                                ProductName VARCHAR(255)
                                )

INSERT  @products_update
SELECT  1, 'Microsoft Corp.' UNION ALL
SELECT  2, 'Apple Inc.' UNION ALL
SELECT  4, 'International Business Machines Corp.' UNION ALL
SELECT  5, 'Sun Microsystems, Inc.' UNION ALL
SELECT  6, 'Oracle Corp.'

-- Update the table in the database with the in-memory table
-- for demo purposes, we use @products to represent the database table
UPDATE      p1
SET         ProductName = ISNULL(p2.ProductName, p1.ProductName)
FROM        @products p1
LEFT JOIN   @products_update p2
        ON  p1.ID = p2.ID

-- Now your products table has been updated
SELECT      *
FROM        @products 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-22T17:04:11.480

MS Access 具有一定的灵活性：您很有可能已经安装了它。

adp 或 mdb（带有链接表）应该允许您做您想做的事情（更容易排序、重新排序列等来管理数据。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T17:13:05.620

您可以考虑只使用 Excel。[http://support.microsoft.com/kb/306397/EN-US/](http://support.microsoft.com/kb/306397/EN-US/) 我相信还有 Excel 插件/VB 宏可以使这种集成更加紧密。

否则，MS Access 是一个合理的答案，gbn 也表示。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T22:57:45.287

考虑[Apex SQL 编辑](http://www.apexsql.com/sql_tools_edit.asp)。它具有您提到的所有功能以及更多功能，尽管它不是免费的。

顺便说一句，如果您只需要免费产品，您应该编辑您的主题行来说明。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T21:02:11.617

使用 SQL Server 管理工作室。您正在对表格使用 Open 功能，对吗（右键单击表格 -> 打开）？仍然这样做，但寻找突出显示的按钮：

[http://www.bgalert.com/images/ssms1.jpg](http://www.bgalert.com/images/ssms1.jpg)

然后，您可以添加订单或任何您喜欢的订单，然后按突出显示的执行按钮：

[http://www.bgalert.com/images/ssms2.jpg](http://www.bgalert.com/images/ssms2.jpg)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-18T09:57:56.717

您可以直接在 SQL Server Management Studio 中执行此操作。当您右键单击表格时，一个选项是“编辑前 200 行”。您可以通过转到工具->选项并单击 SQL Server 对象资源管理器来扩展它。将“编辑顶部行的值”更改为 0 以编辑所有行。

（从用户 Adam Maras[之前的帖子中获得的答案）](https://stackoverflow.com/questions/1535469/how-to-quickly-edit-values-in-table-in-sql-server-management-studio)

# udp - UDP 锁定？

> ID：898894
> 
> 赞同：1
> 
> 时间：2009-05-22T17:01:52.590
> 
> 标签：udp

嘿伙计们，我需要人们猜测解决方案:(。

我正在使用 UDP 套接字，我正在做的是发送大约 8、4 或任何字节的播放器输入。我正在使用 recvfrom 和 sendto。它工作几分钟，然后随机锁定。然而，这可能是因为我的应用程序逻辑，但我想知道是否有人对此有经验，这是一个 UDP/网络问题。我的代码在这里[http://www.pastie.org/486583](http://www.pastie.org/486583)但我主要想知道我可以根据您的经验来解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T17:07:53.660

使用 Wireshark 找出失败的一方。

是发件人不发吗？

还是接收方没有收到？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T17:22:52.313

锁定是什么意思，谁被锁定。您还没有检查“recvfrom”和“sendto”系统调用的返回值。您是否尝试过运行 Wireshark 来观察行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T17:10:39.973

您的 GetInput() 函数是否期望 sendTo 和 recvFrom 始终完成？UDP 不保证发送或接收您的消息，也不保证消息到达的顺序。我认为您的超时也设置为无穷大，所以每隔一段时间就会发生一次消息失败，您会无限期地等待已经丢失的消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T17:10:40.707

“锁定”是什么意思？

请注意，允许网络丢失（丢弃）UDP 数据包：您的协议应该允许偶尔丢失一些数据包，或者愿意重新传输。

# installation - 如何使用 Inno Setup 取消安装程序？

> ID：898901
> 
> 赞同：1
> 
> 时间：2009-05-22T17:03:48.813
> 
> 标签：installation, inno-setup, abort

我正在使用 Inno 安装程序来安装我的产品，在安装程序中，如果该程序被取消或中止，我将执行一个外部程序 (Validator.exe)，我必须取消我自己的安装程序。

我将 Validator.exe 保存在 {app} 路径中并执行它。

当安装程序运行时，我调用 Validator.exe 文件并获得执行结果：Exec(ExpandConstant('{app}/Validator.exe'), '', '', SW_SHOW, ewWaitUntilTerminated, ResultCode)。

但这是我尝试过的所有解决方案的问题：

InitializeSetup：Validator.exe 文件尚未复制到 {app} 中，因此永远不会执行。

中止：只能在 (InitializeSetup,InitializeWizard,CurStepChanged(ssInstall)) 中调用，因此在这些情况下验证器尚未复制。

DeinitializeSetup：我可以在安装后执行 Validator.exe，但此时我无法中止我的安装程序。

在 Validator.exe 被复制并执行后，我需要一些方法来取消安装，也许调用卸载但我做不到。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T18:29:15.583

您可以简单地使用*ExtractTemporaryFile()*辅助函数在任何较早的安装步骤中提取*validator.exe 。*[在启动设置而不是结束时](https://stackoverflow.com/questions/797888/inno-setup-extracting-files-at-the-start-up-setup-instead-of-the-end)查看问题inno setup extracting files以及我的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T17:58:54.197

在 Inno Setup 中，“外部”文件是*不*包含在安装程序 EXE 文件中的文件。它存在于外部，可能作为安装程序 EXE 文件的单独文件包含在内。您说您没有`Abort`在`InitializeSetup`事件中调用的原因是验证程序尚未复制到`{app}`目录中，这是可以理解的，因为此时用户尚未指定安装目标应该是什么。但是您不需要验证器位于目标目录中。它已经是一个外部文件，所以只需从它所在的任何目录运行它。

另一种可能性是将所需的验证功能放入 DLL。您可以在安装程序中包含 DLL，Inno Setup 会将 DLL 提取到临时位置，以便您可以从安装脚本中调用其函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T19:30:39.027

谢谢它工作得很好。这就是我修复它的方法：

```
function InitializeSetup(): Boolean;.
var
  ResultCode : Integer;
begin
  Result := True;
  ExtractTemporaryFile('Validator.exe');

  if Exec(ExpandConstant('{tmp}\Validator.exe'), '', '', SW_SHOW,
    ewWaitUntilTerminated, ResultCode)
  then begin
    if not (ResultCode = 0) then begin
      Result := false;
    end;
  end;
end; 
```

# java - 是否可以在超类对象上调用子类的方法？

> ID：898909
> 
> 赞同：18
> 
> 时间：2009-05-22T17:06:01.697
> 
> 标签：java, inheritance, subclass, superclass

Animal 是 Dog 的超类，Dog 有一个叫做 bark 的方法

```
public void bark()
{
    System.out.println("woof");
} 
```

考虑以下：

```
Animal a = new Dog();
if (a instanceof Dog){
    a.bark();
} 
```

会发生什么？

1.  不允许分配
2.  允许调用 bark 并在运行时打印“woof”
3.  允许调用 bark，但没有打印任何内容
4.  对 bark 的调用导致编译时错误
5.  对 bark 的调用导致运行时错误

我说 2 因为我们正在检查对象是否是狗；因为 dog 是其中包含 bark 方法的类，如果是，则我们调用它，它将打印出：s

我的理解在这里正确吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-22T17:08:45.327

这不会编译，因为 Animal 没有名为 bark 的方法。这样想，所有的狗都是动物，但不是所有的动物都是狗。所有的狗都会吠叫，但并非所有的动物都会吠叫。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-05-22T17:10:13.907

否 - 答案是；

4) 调用 bark 导致编译时错误

bark 方法未定义为分配类型 Animal 上的方法，因此将导致编译时问题；这可以通过铸造来解决；

```
((Dog)a).bark(); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-22T17:11:20.130

关键在以下行：

```
Animal a = new Dog(); 
```

尽管创建了 的新实例`Dog`，但它的引用被`a`声明为 type `Animal`。因此，任何对 的引用`a`都会将`new Dog`其作为`Animal`.

因此，除非`Animal`有`bark`方法，否则以下行将导致编译器错误：

```
a.bark(); 
```

即使`a`经过测试以查看它是否是 的实例`Dog`，并且`a instanceof Dog`实际上会返回`true`，但变量`a`仍然是 is 类型`Animal`，因此`if`语句内的块仍然`a`作为`Animal`.

这是[静态类型语言](http://en.wikipedia.org/wiki/Type_system#Static_typing)的一个特性，其中变量被提前分配类型，并在编译时检查以查看类型匹配。如果此代码是在[动态类型语言](http://en.wikipedia.org/wiki/Type_system#Dynamic_typing)上执行的，在运行时检查类型，则可能允许以下内容：

```
var a = new Dog();
if (a instanceof Dog)
    a.bark(); 
```

`a.bark()`保证仅在实例为 a 时执行`Dog`，因此对的调用`bark`将始终有效。但是，Java 是一种静态类型的语言，因此不允许使用这种类型的代码。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-22T17:19:36.860

在[Head First Java](http://oreilly.com/catalog/9780596004651/)中，他们使用电视遥控器的非常好的类比作为*参考*，并将您的电视作为参考指向的*对象。*如果你的遥控器只有开、关、频道上下以及音量上下的按钮（方法），那么你的电视有什么很酷的功能并不重要。你仍然只能从遥控器上做那几件基本的事情。例如，如果您的遥控器没有静音按钮，您就无法将电视静音。

Animal 参考只知道 Animal 方法。不管底层对象有什么其他方法，你都不能从 Animal 引用中访问它们。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-05-12T21:06:12.673

如果想法是从超类对象打印子类方法，这将起作用：

而不是`Animal a = new Dog(); if (a instanceof Dog){ a.bark(); }` 更改为

```
Animal a = new Dog();

if (a instanceof Dog){ 
    Dog d = (Dog) a; 
    d.bark();
} 
```

这会将超类转换回子类并打印它。尽管它的设计很糟糕，但它是动态知道它指向哪个子类对象的一种方法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-22T17:10:14.967

是 4。你不能要求一个通用的 Animal ——这就是你的代码所说的 a ——吠叫。因为你可以很容易地说

```
Animal a = new Cat(); 
```

并且树皮线没有办法知道你没有。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-05-04T14:52:40.200

在java（我知道的唯一语言）中，您可以创建一个空方法并在超类中调用它。然后你可以在子类中覆盖它来做任何你想做的事情。这样，超类调用其子类的方法。

```
public class Test {
    public static void main(String[] args){
        Snake S = new Snake();
        Dog d = new Dog();
    }
}

class Animal{ //Super Class
    public Animal(){
        bark(); //calls bark when a new animal is created
    }
    public void bark(){
        System.out.println("this animal can't bark");
    }
}

class Dog extends Animal{ //Subclass 1
    @Override
    public void bark(){
        System.out.println("Woof");
    }
}

class Snake extends Animal{//Subclass 2
    public void tss(){
    }
} 
```

此代码调用 Snake 的对象，然后调用 Dog 的对象。它把这个写到控制台：

```
this animal can't bark
Woof 
```

Snake 没有任何树皮方法，因此调用了超类的方法。它将第一行写入控制台。Dog 有一个 bark 方法，所以超类调用它。它将第二行写入控制台。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-22T17:41:56.970

仅供参考，这不是一个好的设计。

几乎任何时候你都有这种形式的代码：

```
if (x instanceof SomeClass)
{
   x.SomeMethod();
} 
```

您正在滥用类型系统。这不是使用类的方式，也不是编写可维护的面向对象代码的方式。它很脆。很复杂。这不好。

您可以在基类中创建模板方法，但它们必须调用存在于基类中并在子类中被覆盖的方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-22T17:38:39.423

> *“我说 2，因为我们正在检查对象是否是狗；因为 dog 是其中包含 bark 方法的类，如果是，那么我们称之为它将打印出：s”*

你的理由是正确的，但这不是它的工作方式。

Java 是一种静态类型语言，这意味着对象可能响应的方法的有效性在**编译时**得到验证。

你可能会认为支票：

```
if( a instanceof Dog ) 
```

会做，但实际上并没有。编译器所做的是检查声明类型的“接口”（在这种情况下为 Animal ）。“接口”由在 Animal 类上声明的方法组成。

如果*bark()*方法没有在超类**Animal**中定义，编译器会说：“嘿，这行不通”。

这很有帮助，因为“有时”我们在编码时会打错字（例如输入 barck() ）

如果编译器没有对此发出警告，您将不得不在“运行时”找到它，并且并不总是带有明确的消息（例如 IE 中的 javascript 会说“意外对象”之类的内容）

尽管如此，像 java 这样的静态类型语言允许我们强制调用。在这种情况下，它使用“cast”运算符 ()

像这样

```
1\. Animal a = new Dog();
2\.  if (a instanceof Dog){
3\.     Dog imADog = ( Dog ) a;
4\.     imADog.bark();
5\. } 
```

在第 3 行中，您正在“强制转换”为 Dog 类型，因此编译器可以检查 bark 是否是有效消息。

这是对编译器的指令，说“嘿，我是这里的程序员，我知道我在做什么”。并且编译器检查，好的，狗，可以接收到消息 bark()，继续。然而，如果在运行时动物不是狗，则会引发运行时异常。

演员表也可以缩写为：

```
if( a instanceof Dog ) {
   ((Dog)a).bark();  
} 
```

那会运行。

所以，正确答案是**4：** “*对 bark 的调用导致编译时错误*”

我希望这有帮助。

# vb6 - 存储过程超时 - 但从 SSMS 运行时很好

> ID：898911
> 
> 赞同：3
> 
> 时间：2009-05-22T17:06:20.370
> 
> 标签：vb6, timeout, ado

我有一个存储过程，它因“超时已过期”而出错。

涉及的代码是ADO/VB6。

存储过程本身没有问题，您可以在查询窗口中运行它，只需不到一秒钟。

用于获取连接等的代码也是模块化的，并在整个巨大的应用程序中使用。超时仅在这个地方发生，在一个特定的数据库上。

无论是否在调试中运行 VB6 代码，每次尝试都会重现该错误，然后突然间一切都会神奇地重新开始工作。然后在未来的某个时间，同样的问题会再次出现。

我不确定要放多少代码，没有什么复杂的；基本上是；

```
Set adoCommandObject.ActiveConnection = ...{open ADODB.Connection object}
Set rs = CreateObject("ADODB.Recordset")
Call rs.Open(adoCommandObject, , adOpenForwardOnly, adLockReadOnly)'Timeout occurs here 
```

我一直在观察分析器，但没有给出任何线索，除了偶尔看到在 sp 运行之前和之后发生的“SET NO_BROWSETABLE ON”/“SET NO_BROWSETABLE OFF”语句。

我已经在网上搜索过，但找不到任何令人满意的帮助；在这一点上，我愿意尝试任何事情（除了在 .NET 中重写，不幸的是，这不是一个选项！）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-24T14:49:53.767

我认为你想太多了。无意冒犯，但如果你使用的是 MSSQL，它就像有人打开查询窗口一样简单，它会占用数据库。这很容易测试。我以前也遇到过同样的麻烦。我之前已经运行过存储过程，没有超时，通常会立即运行，但会在一夜之间运行而不运行。只是为了发现另一名员工打开了他们的查询窗口。关闭他们的窗口，然后它终于运行了。看看这个，你会惊讶于表锁可以对你的应用程序做些什么。

我这么说是因为你说问题是间歇性的。它来来去去。我怀疑是表锁。无论是应用程序执行此操作，还是由另一个用户对数据库进行查询来完成。如果不是其他用户，请检查以确保您的应用程序在每次使用它们时都关闭与数据库的连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T18:15:03.983

*   也许有一些潜伏的代码意外地将连接或命令的超时设置为一个非常小的值。
*   也许程序确实偶尔需要一段时间才能运行，例如，如果服务器正在执行其他操作或统计信息已过时
*   您能否使用探查器捕获超时情况，如果是这样，proc 实际上是否需要很长时间才能执行？

[如此处](http://support.microsoft.com/kb/885146)所述SET NO_BROWSETABLE ON 类似于在选择中使用[FOR BROWSE](http://msdn.microsoft.com/en-us/library/aa936959(SQL.80).aspx)。我猜它是 ado 自动生成的，它认为您可能想要更新该记录集。您可以设置 Recordset 的一个属性来阻止那些被发布，但这似乎不太可能是问题所在。

# vb6 - 帮助阅读文本文件中的换行符

> ID：898912
> 
> 赞同：0
> 
> 时间：2009-05-22T17:07:16.593
> 
> 标签：vb6, line-breaks

我有一个 TXT 文件，需要通过应用程序导入，但由于某种原因，我需要先在写字板中打开它，然后在导入之前保存它。我猜这与换行符有关。因为如果我先在记事本中打开它，则没有换行符，但如果我用写字板打开它，则行是分开的。

有谁知道为什么会发生这种情况以及我如何避免手动打开文件并使用写字板保存它？该应用程序是用 vb 6 (Yikes!) 编写的。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T17:12:24.310

这是一个行尾问题。您的代码（和记事本）希望看到回车（CR）/换行（LF）对，这可能是仅 CR（Macintosh）或仅 LF（Unix）文件。写字板更宽容，并且在保存时显然（尚未测试）为您保存 CR/LF 对。

您可以更改应用程序中的代码以查找任何结尾并轻松处理它们：只需停止将 vbCrLf 作为一对查找并查找其中之一作为行尾。我自己的策略是扫描 CR 或 LF 并消耗所有随后的 CR/LF 字符：这也会清除空白行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T17:12:29.550

该文件可能在每行的末尾只有一个回车 (CR) 或换行 (LF) 字符。

在 Windows 中，每行的末尾都需要一个 CR 和 LF 字符。这可以通过使用常量 vbCRLF 在 VB6 中轻松完成。

另一方面，如果您是读取文件的人，您可以在读取文件时确定缺少哪个文件并手动添加（即，使用替换功能将 CR 转换为 CRLF 或将 LF 转换为 CRLF）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:31:46.640

除非这些文件非常大并且性能很关键，否则可以通过 ADODB.Stream 对象轻松完成逐行读取它们。

这不仅可以处理多个行分隔符（Stream.LineSeparator = adCR、adCRLF 或 adLF），它还可以用于处理包含 Unicode (UTF-16)、UTF-8、系统代码页 ANSI 和替代“ANSI”编码的文件对于其他语言环境。

例如，如果您有一个包含来自俄语语言环境的“ANSI”的文本文件，您可以设置 Stream.Charset = "koi8-r" 并通过正确翻译成 VB6 Unicode (UTF-16) 来读取数据：

```
Dim Stm As ADODB.Stream
Dim Line As String
Dim Counter As Long
Set Stm = New ADODB.Stream
With Stm
    .Open
    .LoadFromFile "russian.txt"
    .Type = adTypeText
    .Charset = "koi8-r"
    .LineSeparator = adLF
    Do Until .EOS
        Line = .ReadText(adReadLine) 'Text is in Unicode now.
        Counter = Counter + 1
    Loop
    .Close
End With 
```

Charset 默认值为“unicode”（UTF-16），但要使用默认代码页读取或写入 ANSI 流，您可以将其设置为“ascii”。

HKCR\MIME\Database\Charset 包含可用值。

# jsp - 尝试在 JSTL 标签中使用 EL 时遇到问题

> ID：898922
> 
> 赞同：1
> 
> 时间：2009-05-22T17:09:04.923
> 
> 标签：jsp, jstl, el

我正在尝试在 jstl 标签中使用表达式语言，但出现了奇怪的错误。

“根据标记文件中的 TLD 或属性指令，属性值不接受任何表达式”

代码是这样的：

```
<c:out value="${header['host']}"/> 
```

但接下来的代码执行得很好：

```
${header["host"]}
<c:out value="hello"/> 
```

我将 jstl.jar 和 standard.jar 添加到 WEB-INF/lib/ （以及类路径）。包含 jstl 的指令是标准的：

```
<%@ taglib uri="http://java.sun.com/jstl/core" prefix="c" %> 
```

JSTL 版本为 1.1.2

应用服务器：tomcat 6.0.16

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T17:23:22.813

您必须在 taglib 声明中使用此 URL。

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %> 
```

确保您的 web.xml 已声明 servlet 规范 2.4+

这篇文章有解释：[How to Reference and Use JSTL in your Web Application](http://www.mularien.com/blog/2008/04/24/how-to-reference-and-use-jstl-in-your-web-application/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-02T07:27:49.443

检查 web.xml 中的网络应用版本

```
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"> 
```

并检查jstl-version.jar的META-INF中的jstl uri，选择c.tld，fmt.tld等。lib版本必须是：

```
<tlib-version>1.1</tlib-version> 
```

# c# - LINQ 中的第二个“from”语句

> ID：898923
> 
> 赞同：2
> 
> 时间：2009-05-22T17:09:12.737
> 
> 标签：c#, linq

我是 LINQ 的新手，我对该库的了解来自 Jon Skeet 的书“C# In Depth 1”

在过去的几天里，我阅读了很多关于 LINQ 的教程，包括 Skeet 的书，但是我永远找不到显示普通 C# 代码的代码片段，然后是使用 LINQ 的代码的较短版本，因此读者可以理解什么是什么。

我的问题：下面的函数打开一个文本文件并搜索放置在文本文件中特定位置的数字。数字（我在代码中使用 ID）从 1 到 25000 开始，并且有一些缺失（例如没有生命 25，而是 24、23、26、27 等）。我希望代码复制数组“Ids”中的行。它并不意味着是一个数组，我只是新来的，我不知道是否还有其他东西对 LINQ 更方便。

```
 public static IEnumerable<string> ReadLines(StreamReader reader)
    {
        while (!reader.EndOfStream)
        {
            yield return reader.ReadLine();
        }
    }

    static void Filter(string filename)
    {
        using(var writer = File.CreateText(Application.StartupPath + "\\temp\\test.txt"))
        {
            using (var reader = File.OpenText(filename))
            {
                int[] Ids = { 14652, 14653, 14654, 14655, 14656, 14657, 14658, 14659, 14660 };
                var myId = from id in Ids
                           from line in ReadLines(reader)
                           let items = line.Split('\t')
                           where items.Length > 1
                           let ItemId = int.Parse(items[1])
                           where ItemId == id
                           select line;
                foreach (var id in myId)
                {
                    writer.WriteLine(id);
                }

            }
        }
    } 
```

它写了什么：它只写一行数字，这是 Ids[] 数组（14652）的第一个成员。

我必须添加第二个'from'，它位于代码的第一位，因此它将检查数组的每个成员。我将from语句作为“while”，因为我找不到sniper使用普通代码-> linq。

代码中的问题在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T17:19:12.973

```
from line in ReadLines(reader)
where Ids.Contains(line.Split('\t')[1])
select line; 
```

您可以使用 ? 调整包含？绕过在 1 处没有项目的拆分。

这是你想要做的吗？我认为第二个来自就像一个交叉连接，因为我理解你的问题，这不是必需的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T17:26:12.390

> 它只写一行数字，这是 Ids[] 数组（14652）的第一个成员。代码中的问题在哪里？

```
from id in Ids
from line in ReadLines(reader) 
```

此代码在概念上类似于（忽略延迟执行）：

```
foreach(int id in Ids)
{
  foreach(string line in ReadLines(reader)
  {
    ...
  }
} 
```

这对第一个 id 非常有用，但是阅读器将在文件末尾找到第二个 id，并且找不到匹配项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T17:24:55.417

此代码未经测试，但您是否正在寻找类似的东西？

```
var lines = from line in ReadLines(reader)
            let items = line.Split('\t')
            where items.Length > 1
            select new { Text = line, ItemId = int.Parse(items[1]) };

var myId = from id in Ids
           join line in lines on id equals line.ItemId
           select line.Text; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T20:07:50.483

您需要执行连接，就像连接两个表一样。从 SQL 查询的角度考虑这个过程……你有两个表……Ids 和 Lines。Lines 有两个字段，Id 和 Line，需要内连接到 Ids 表。您可以使用以下 LINQ 查询来完成此操作：

```
var lines = from id in Ids
            join line in
            (
                 from l in ReadLines(reader)
                 let items = l.Split('\t')
                 where items.Length > 1
                 select new { Id = int.Parse(items[1]), Line = l }
            ) on id equals line.Id
            select line.Line; 
```

# .net - 用于人群模拟的 .NET 库/书籍

> ID：898924
> 
> 赞同：2
> 
> 时间：2009-05-22T17:09:46.637
> 
> 标签：.net, artificial-intelligence, simulation

我的任务是模拟人们四处走动。可能是一群人穿过餐厅或离开学校。环顾四周，我发现了一堆与 A* 相关的东西，这对一个人来说很好，但我会有一堆。人们是否有用于这些东西的标准库？还是我应该看的一种算法？还是一本能让我前进的书？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T17:21:26.247

我绝不是一个人工智能人，但我什至可以理解这一点：

[http://www.red3d.com/cwr/boids/](http://www.red3d.com/cwr/boids/)

我发现它是紧急行为算法和自然运动/植绒的一个很好的起点。这里的入口页面以飞行动物为主，但页面底部有很多链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T22:57:42.010

很少有游戏能真正吸引观众，但刺客信条令人印象深刻。每个人都有一些（基本的）目标，例如乞讨、提着罐子去市场、成群结队地散步等，所有这些都融入了一个非常令人印象深刻（与其他游戏相比）的人群模拟。

这是一篇文章，它汇集了对人群建模的各个方面以及各种研究论文的链接： [模拟人群流动动力学](http://aigamedev.com/open/article/simulating-crowd-flow-dynamics/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T22:51:13.630

就餐工具包 ( [http://repast.sourceforge.net/repast_3/index.html](http://repast.sourceforge.net/repast_3/index.html) ) 有一个 .Net 实现，您可以从[http://sourceforge.net/project/showfiles.php?group_id=1703&package_id=1655](http://sourceforge.net/project/showfiles.php?group_id=1703&package_id=1655)下载。

更一般地，您想查找“基于代理的建模”，请参阅[http://jasss.soc.surrey.ac.uk/12/2/2.html](http://jasss.soc.surrey.ac.uk/12/2/2.html)或[http://en.wikipedia.org/wiki/ABM_Software_Comparison](http://en.wikipedia.org/wiki/ABM_Software_Comparison)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T21:04:51.327

感谢大家的帮助。我相信我发现的最好的文章也是由 Craig Reynolds 在与@x0n sited 相同的网站上写[的](http://www.red3d.com/cwr/steer/)。如果您单击链接，有一堆简单的 java 小程序可以为他的论文提供示例。

有许多网站建议使用C++ 编写的[OpenSteer库。](http://opensteer.sourceforge.net/)我终于找到了[SharpSteer](http://sharpsteer.codeplex.com/)，它采用相同的库并将其移植到 C#。他们有很多为 XNA 编写的很棒的演示。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T17:42:23.447

您可以[尝试谷歌搜索](http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=fPE&q=ages+of+empires+algorithm&btnG=Search)一些您最喜欢的游戏。例如，这里有两个关于[Ages of Empires 的](http://en.wikipedia.org/wiki/Age_of_Empires)[有趣](http://books.google.com/books?id=1hwR5gIq0I8C&pg=PA228&lpg=PA228&dq=ages+of+empires+algorithm&source=bl&ots=nmDhO5uGy3&sig=dRN1k1Ves1llmWaiD3c9pCMXoXI&hl=en&ei=h-MWSvjbJp2xtgf395zfDA&sa=X&oi=book_result&ct=result&resnum=1) [结果](http://artho.com/age/pathfinding.html)。

# svn - 如何 svn 完整的 cms 安装（如何使用自己的模块管理官方 cms 核心文件）？

> ID：898945
> 
> 赞同：1
> 
> 时间：2009-05-22T17:13:05.993
> 
> 标签：svn, joomla

我已经阅读了 SO 建议的一些主题（“您提出的问题似乎是主观的，并且可能已关闭。”）但找不到我正在寻找的答案。

我在一个项目中使用 Joomla。使用 Joomla，我有大约 8 个不同的第三方模块，每个模块都有自己不同的版本号和 Joomla 兼容性。有些可能是 Joomla 的最新版本（现在是 1.5.10），有些可能不是。一些模块是我们制作的。他们都工作，他们都需要完成我们公司网站的要求。

事实是：将所有这些置于源代码控制中的最佳方式是什么？您是否将 Joomla 源代码“捆绑”在您的存储库中，即使它是第三方并且您不太可能修改这些文件？或者你只是 svn 真正在你控制之下的核心文件？

恕我直言：

将 Joomla 的核心文件放入存储库的好处是，如果需要的话，我可以在一段时间内创建标签并拥有一个完整的系统，而无需阅读可能的文档 txt 文件，上面写着“这些模块与 joomla XX、joomla 组件 XX 兼容joomla 版本 XX”等。

缺点是在放置不会真正版本化的文件时，除非有新的 joomla 版本。

你认为最好的主意是什么？当您的项目（例如我们的门户网站）由来自不同来源的许多不同组件组成时，您通常会怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T17:26:50.033

我们通常将第三方模块的编译版本包含在 SVN 中它们自己的文件夹中。然后可以使用构建脚本（或外部：属性）将它们复制到需要去的任何地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T17:29:39.920

我会制作一个“部署状态”特定的树，它使用[svn:externals](http://svnbook.red-bean.com/en/1.5/svn.advanced.externals.html)指向我的自定义 Joomla、我的模块等 - 每个都在他们自己的树中。“部署树”只会跟踪模块的聚合方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T17:29:55.690

首先，如果您的更改是通用的并且是改进的，那么您应该将其提交回项目。

否则，将其放入源代码管理中。复制更改并合并它们。换句话说，将“真实”源存储库视为另一位开发人员。

# asp.net - 停止页面进程

> ID：898954
> 
> 赞同：0
> 
> 时间：2009-05-22T17:17:29.543
> 
> 标签：asp.net, ajax

我已经解决了几个小时的问题。我想创建动态 Javascript，在需要时将其加载到页面中。这是一个基于 Ajax 技术的项目。首先，我尝试通过 PageMethods 来实现，但由于 viewstate 和其他原因，PageMethods 只能是静态的。问题是我无法针对页面对象或任何其他控件进行编程，因为该方法是静态的。

我的下一个想法是我有一个更新面板，在这个面板中我有一个隐藏字段来存储我的脚本。我触发隐藏字段通过 javascript 进行回发。在 Page_Init 中，我检查它是否是异步回发，以及是否是导致它的隐藏字段。如果是这样，我注册我的新脚本。

现在来解决问题。发生这种情况时，我不想在页面生命周期中走得更远。我做完。我不希望 Page_Load 运行和 Pre_Render 等。我怎样才能做到这一点？Response.End() 停止页面的进程，但显然我的脚本没有注册。

好吧，我可以检查每个方法是否是异步回发，以及是否是导致它的隐藏字段，但我想将其构建到所有页面都将继承的基页面类中。我希望它尽可能通用。

有任何想法吗？如果有人可以帮助我，我将不胜感激。谢谢。/约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T17:59:30.937

您不想运行的方法是事件处理程序。只要您不结束响应，这些事件就会触发。这是 aspx 页面如何工作的基本部分，它触发事件。

如果您不想运行的事件处理程序中有代码，那么您可以：

- 在 page_init 中设置一个标志，然后在您的事件处理程序中检查该标志 - 尝试解开您的页面事件（这是一个坏主意，会破坏进一步的回发）

我怀疑您真正想要做**的是创建一个自定义处理程序，该处理程序返回您的 javascript 并从您加载的 javascript 中调用它。**

因此，您有一个名为 MyJavascriptGenerator.ashx 之类的处理程序，并且您有隐藏的 javascript 调用该页面，而不是回发到同一个 aspx 页面。

如果没有有关页面预期行为的更多详细信息，这就是我能想到的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T18:18:55.820

ASPX页面：

```
 function Generate() {
        __doPostBack('hdJS', 'function SayHello(){alert(\'Hello to you\')}');
    }

    function Execute() {
        SayHello();
    }

</script> 
```

代码隐藏：

使用系统；使用 System.Collections.Generic；使用 System.Linq；使用 System.Web；使用 System.Web.UI；使用 System.Web.UI.WebControls；使用 System.Web.UI.HtmlControls；

命名空间 WebApp { public partial class _Default : System.Web.UI.Page { protected void Page_Init(object sender, EventArgs e) { if (ScriptManager1.IsInAsyncPostBack) { if (Request["__EVENTTARGET"] == "hdJS") ScriptManager。 RegisterClientScriptBlock(hdJS, hdJS.GetType(), "key", Request["__EVENTARGUMENT"], true); } }

```
 protected void Page_Load(object sender, EventArgs e)
    {
    }
} 
```

}

那是一个代码示例。您如何将其转换为 httphandler。正如我能想到的，我需要以某种方式回发同一页面，以便在页面中注入 javascript，对吗？该页面已加载，我不想重新加载它。这是主要目标。好的，我可以像更新面板一样使用部分页面渲染重新加载它，但这意味着再次执行整个页面生命周期并且仅更新面板内的部分，但所有控件仍然被初始化并且所有代码都被再次处理。我想避免这种情况。如何使用 HttpHandler 实现这一点？/约翰

# c++ - 引用指针和 C++ 多态性

> ID：898955
> 
> 赞同：11
> 
> 时间：2009-05-22T17:17:30.713
> 
> 标签：c++, reference, polymorphism, pointers, parameters

有谁知道为什么这会导致编译器错误？我尝试了 VS 2005 和 Codewarrior：

```
class Parent {
   protected:
      int m_Var;
   public:
      Parent() : m_Var(0) {}
      virtual ~Parent() {}
      void PubFunc();
};

class Child : public Parent {
   protected:
      bool m_Bool;
   public:
      Child() : m_Bool(false) {}
      virtual ~Child() {}
      void ChildFunc();
};

void RemoveObj(Parent *& ppObj)
{
   delete ppObj;
   ppObj = 0;
}

int main()
{
   Parent* pPObj = 0;
   Child*  pCObj = 0;
   pPObj = new Parent();
   pCObj = new Child();

   RemoveObj(pPObj);
   RemoveObj(pCObj);
   return 1;
} 
```

视觉工作室 说：

> refptr.cpp(33)：错误 C2664：“RemoveObj”：无法将参数 1 从“子 *”转换为“父 *&”

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-22T17:21:56.980

`ppObj`RemoveObj的参数是对 Parent* 的引用。如果该方法用指向新对象`RemoveObj()`的指针替换了指针怎么办？`Parent`当方法返回时，您的`pCObj` `Child*`将不再指向`Child`对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T17:22:19.350

来自 C++ 标准 (1998)

> 除了在通过用户定义的转换（13.3.1.4、13.3.1.5）进行初始化的上下文中，格式良好的隐式转换序列是以下形式之一： —标准转换序列（13.3.3.1.1），-用户定义...

13.3.3.1.1

> 在单个标准转换序列中最多允许每个类别进行一次转换

所以 c++ 不能连续两次隐式转换：从指针到指针，然后再从指针。

为了澄清这一点，考虑这样的 RemoveObj 声明

```
void RemoveObj(Parent ** ppObj) 
```

你会看到这个错误

```
error: invalid conversion from 'Child**' to 'Parent**' 
```

您必须使用显式转换，例如

```
 RemoveObj((Parent**)&pCObj);
   RemoveObj((Parent*&)&pCObj); 
```

或不得不改变

```
void RemoveObj(Parent *& ppObj) 
```

至

```
void RemoveObj(Parent * ppObj) 
```

或者

```
template <typename T>
void RemoveObj(T *& pObj)
{
   delete pObj;
   pObj = 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-06T15:41:17.597

指向引用的指针允许指针值在函数中改变。正如[Michael Burr](https://stackoverflow.com/users/12711/michael-burr)所指出的，可能会分配不正确的类引用并将其返回。想象一下你的整个程序错误地使用 *pchickens 作为 *peggs :)

我认为值得添加（尽管没有明确您的要求）：我对多态实现的偏好是将常用函数作为方法移动到内部。如果它们都共享一个函数，只需将其添加到基类中。

然后无论哪种方式，您都可以简单地调用 Foo->Bar() 并获得所需的结果。但是对于您给出的具体实现示例，只需 delete Foo 将调用适当的析构函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T17:43:25.253

ppobj 是指针的引用。*ppobj 取消引用变量指向的内容，因此您可以获取变量指针。

由于取消引用的类型不正确，您会看到错误。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-22T17:23:14.670

这不是权威的，但我认为问题在于 C++ 类的多态性并没有扩展到它们的指针；您期望在这里完成的是将 a`Child *`转换为 a `Parent *`; 虽然您可以将 a 强制`Child`转换为 a `Parent`，但不能将指针**引用强制**转换。也就是说，类是多态的，但指向类的指针在作为引用时不是。这是迈克尔·伯尔（Michael Burr）在上面给出的原因；`Child *`暗示了某种记忆结构，而不是`Parent *`。

# silverlight - Silverlight 文本框覆盖

> ID：898961
> 
> 赞同：3
> 
> 时间：2009-05-22T17:19:10.230
> 
> 标签：silverlight, keydown

我正在尝试获取一个文本框 keydown 事件来捕获退格键按下事件。我通过添加一个覆盖文本框的类来实现这一点。我不知道该怎么做是与文本框在用户控件中的类进行通信。

当用户在文本框中键入...说 abcd 或退格时，我需要更新用户控件上的某些内容。假设我想要显示文本框中有多少个字符的东西。有人可以帮我吗？这是我到目前为止所拥有的

```
Option Strict On
Imports System.Text.RegularExpressions

Partial Public Class Page
    Inherits UserControl

    Public Sub New()
        InitializeComponent()
        Dim textbox As New MyTextBox() With {.Width = 300, .Height = 100}
        LayoutRoot.Children.Add(textbox)
    End Sub
End Class

Public Class MyTextBox
    Inherits TextBox
    Protected Overrides Sub OnKeyDown(ByVal e As KeyEventArgs)
        MyBase.OnKeyDown(e)
        If e.Key = Key.Back Then
            e.Handled = True
            MyBase.OnKeyDown(e)

        ElseIf e.Key = Key.Delete Then
            e.Handled = True
            MyBase.OnKeyDown(e)
        End If
    End Sub
End Class 
```

谢谢香农

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T17:29:18.157

您不需要子类`TextBox`来执行此操作。相反，在您的类中添加[TextBox.TextChanged事件的处理程序。](http://msdn.microsoft.com/en-us/library/system.windows.controls.textbox.textchanged(VS.95).aspx)`UserControl`当它被调用时，事件的发送者应该是你的`TextBox`. 然后，您可以从中获取文本并执行您需要执行的操作。

**更新**：根据评论，以下应该有效：

```
Partial Public Class Page
    Inherits UserControl

    Private TextBox1 as TextBox

    Public Sub New()
        InitializeComponent()
        TextBox1 = New TextBox() With {.Width = 300, .Height = 100}
        LayoutRoot.Children.Add(textbox)
    End Sub

    Private Sub OnTextChanged(sender as Object, e as TextChangedEventArgs) Handles TextBox1.TextChanged
        If e.Key = Key.Back Then
            e.Handled = True
        ElseIf e.Key = Key.Delete Then
            e.Handled = True
        End If
    End Sub
End Class 
```

（我的 VB 有点生疏，所以事件处理程序的语法可能不完全正确。）

基本思想是`TextBox`在`UserControl`. 这样您就可以`UserControl`根据需要修改其他部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T17:28:46.987

你可能想错了方向。由于您在 Silverlight 中，因此您可以使用绑定表达式获取此信息。举个简单的例子，你说你想知道一个文本框中有多少个字符。您可以使用以下 xaml 实现此目的：

```
 <TextBox x:Name="txtInput" />
    <TextBlock Text="{Binding ElementName=txtInput, Path=Text.Length}" /> 
```

# visual-studio - 更改字体大小的快捷方式

> ID：898964
> 
> 赞同：102
> 
> 时间：2009-05-22T17:20:38.590
> 
> 标签：visual-studio, visual-studio-2008, settings, font-size

有人知道在 Visual Studio 2008 的文本编辑器中更改字体大小是否有快捷方式或类似的东西？

我的意思是像 Firefox 中的 Ctrl + 鼠标滚轮。

如果您不必一直更改字体大小，则访问“选项”窗口然后选择“环境”>“字体和颜色”很好，但在我的情况下，我希望能够根据我正在做的事情来更改它（编写和阅读代码或只是阅读它）。

我想我可以创建两个几乎相同的设置文件并随时导入它们，但这会更慢。

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2012-05-31T21:07:51.217

您可能会发现这些快捷方式很有用：

`Ctrl`+ `Shift`+`.`放大。

`Ctrl`+ `Shift`+`,`缩小。

这些字符分别是句号和逗号。

* * *

## 回答 #2

> 赞同：118
> 
> 时间：2010-09-08T03:47:59.910

活动编辑器上的 Ctrl + MouseWheel。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-05-22T17:25:07.337

在示例/可访问性下的宏资源管理器中，有一个增加文本编辑器字体大小和一个减少文本编辑器字体大小。将它们绑定到一些键盘快捷键。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-10-06T21:49:25.890

Ctrl + MouseWheel 几乎适用于任何东西......不仅仅是视觉工作室

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2019-11-20T08:01:36.213

我正在使用 Visual Studio 2017，我发现下面可以更改字体大小

[![在此处输入图像描述](https://i.stack.imgur.com/fLnBJ.png)](https://i.stack.imgur.com/fLnBJ.png)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-11-14T13:23:24.543

使用：菜单中的工具 -> 选项 -> 环境 -> 字体和颜色

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-07-03T04:14:56.563

在 Visual Studio 2019 中，您可以使用，

任何一个：

**Ctrl + 移 + 。** 增加

**Ctrl + Shift + ,**减少

或者

转到 **工具>选项...>环境>字体和颜色**

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-23T04:15:55.097

请务必查看刚刚发布的[VS 2010 Beta 。](http://www.microsoft.com/visualstudio/en-us/products/2010/default.mspx)新编辑应该有这个。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-01-18T12:06:50.303

Ctrl + **Alt** + MouseWheel 将在 Visual Studio 2015 中工作。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-08-29T05:15:57.270

您可以通过 ctrl + 鼠标滚轮更改字体大小。

或者

工具 --> 选项 --> 环境 --> 字体和颜色。

[此处](https://blossomprogramming.blogspot.in/2017/08/change-font-and-size-in-visual-studio.html)提及带有屏幕截图的详细信息

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-05-28T23:59:35.623

这对我有用：

**Ctrl** + **-** 最小化

**Ctrl** + **+** 最大化

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-01-16T06:04:52.420

在 Visual Studio 代码中，如果你的前面太小或太大，那么你只需要缩小或放大。要做到这一点，你只需要这样做：

*   对于放大：`ctrl`+ `=`（ctrl 和两者都相等）
*   缩小：`ctrl`+ `-`（ctrl 和 - 两者）

# c++ - 使用 WinSocks 的非阻塞 connect()

> ID：898967
> 
> 赞同：3
> 
> 时间：2009-05-22T17:20:57.857
> 
> 标签：c++, sockets, connect, nonblocking

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms737625(VS.85).aspx)，您必须像这样创建一个非阻塞套接字：

```
unsigned nonblocking = 1;
ioctlsocket(s, FIONBIO, &nonblocking);
```

然后在 write-fdset 中使用它`select()`。要检查连接是否成功，您必须查看套接字是否可写。但是，MSDN 文章没有描述如何检查错误。

我如何查看是否*没有*`connect()`成功，如果是这样，*为什么*它没有成功？

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T18:58:55.890

您使用 . 检查套接字错误`getsockopt()`。这是 Stevens 的一个片段（当然是 Unix，但 winsock 应该有类似的东西）：

```
 if ( FD_ISSET( sockfd, &rset ) || FD_ISSET( sockfd, &wset )) {
    len = sizeof(error);
    if ( getsockopt( sockfd, SOL_SOCKET, SO_ERROR, &error, &len ) < 0 )
        return -1;
} else {
    /* error */
} 
```

现在`error`给你错误号，如果有的话。

# asp.net - JSON.Net 和类型化数据集

> ID：898976
> 
> 赞同：1
> 
> 时间：2009-05-22T17:22:26.543
> 
> 标签：asp.net, json, json.net

有谁知道 JSON.net 是否可以序列化/反序列化 asp.net 中的类型化数据集？或者如果没有，还有其他选择吗？

我环顾四周，但在 JSON.net 文档中找不到任何明确表示“是”以支持类型化数据集的内容。

谢谢！

埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T18:47:05.697

我假设是的。我使用了一个带有类型集合的 JSON.net 版本，它工作得很好。

# php - 使用新的 cpanel 将用户重定向到子域，并在用户的浏览器上保留原始 URL

> ID：898979
> 
> 赞同：1
> 
> 时间：2009-05-22T17:22:51.160
> 
> 标签：php, drupal, cpanel

我的提供商有一个 php 帐户，我还为我安装了 cpanel。

我目前在那里有两个drupal 站点，我们将其称为主站点myMainSite，另一个正在建设中，称为myNewSite。

因此，当我访问**www.myMainSite.com**时，我会访问主站点。当我访问**myNewSite.myMainSite.com**时，我会访问正在建设中的 drupal 站点。

我的问题是，当我正在建设的站点上线时，我希望所有访问**www.myMainSite.com**的用户都能看到新站点（位于**myNewSite.myMainSite.com**下的站点）。

我怎样才能用cpanel做到这一点？它在“插件域”配置中吗？我不想要更改地址栏的重定向，即我想保留原始网址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T17:32:51.430

您只需将 www.mainsite.com 的 DocumentRoot 更改为指向与 myNewSite.myMainSite.com 相同的 DocumentRoot。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T03:25:20.860

我假设您已经使用 cPanel 的子域控制面板来添加**myNewSite.myMainSite.com**。我假设**myMainSite.com**在`/public_html/`文件夹中。因此，新站点（以及具有子域的站点）将位于`/public_html/myNewSite.myMainSite.com`

为什么不能只使用文件管理器（或 FTP）将所有文件`/public_html/`移入`/public_html/OLDsite`？

然后将所有内容从`/public_html/myNewSite.myMainSite`文件`/public_html/`夹中移出。

然后检查您的站点是否正在使用新文件。

也许您也可以向您的主机发送支持票，看看是否有其他方法。这可能就像他们在 Apache 的 conf 文件中为**myNewSite.myMainSite.com**子域更改某些内容一样简单。

我还认为您需要更改 Drupal 中的设置（当您更改域时），以便 Drupal 也知道新域名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-23T20:15:50.630

您可以使用 cPanel 中的“重定向”选项将所有访问者从旧站点重定向到新站点。或者您可以简单地将 Apache 中的 Virtualhost 更改为您的主域到您完成的目录（当前正在建设中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-30T10:25:49.927

同意前面的回答。如果您想在主站点上加载子域的内容，那么您需要将数据从子域的目录移动到 public_html 的根目录。

只要确保您的主域上没有任何实时站点，如果您的主域有工作站点并且您将在根目录下上传内容，那么您的网站将由于内容冲突而无法运行。

如果不可能，那么您需要将内容上传到 public_html 的一个子目录下，然后您可以通过您的 P_website_name/目录名称访问该站点。

完成移动内容后，您需要将基本 UR L 更新为新站点 URL。它位于 cPanel >> 文件管理器 >> public_html >> Sites/Default/Settings.php

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-10T01:21:30.597

我建议您将主要的 2 个用户帐户分别称为 oldlive 和 newlive。

你可能有类似的域

oldlive.myMainSite.com 和 newlive.myMainSite.com

然后，您可以在未准备好时将 Park Domain myMainSite.com 添加到 oldlive.myMainSite.com。

完成当前位于 newlive.myMainSite.com 的新站点后，您将从 oldlive.myMainSite.com 中删除公园域并移至 newlive.myMainSite.com。

然后就可以顺利转移域名了。

# f# - 避免堆栈溢出（使用 F# 无限序列）

> ID：898988
> 
> 赞同：31
> 
> 时间：2009-05-22T17:25:06.757
> 
> 标签：f#, stack-overflow, tail-recursion, sequences

我有我为 f# 中的 morris seq 编写的这个“学习代码”，它遭受了我不知道如何避免的堆栈溢出。"morris" 返回一个无限的 "see and say" 序列（即 {{1}, {1,1}, {2,1}, {1,2,1,1}, {1,1,1 ,2,2,1}, {3,1,2,2,1,1},...}）。

```
 let printList l =
        Seq.iter (fun n -> printf "%i" n) l
        printfn ""

    let rec morris s = 
        let next str = seq {
            let cnt = ref 1  // Stack overflow is below when enumerating
            for cur in [|0|] |> Seq.append str |> Seq.windowed 2 do
                if cur.[0] <> cur.[1] then
                    yield!( [!cnt ; cur.[0]] )
                    cnt := 0
                incr cnt
        }
        seq {
        yield s
        yield! morris (next s) // tail recursion, no stack overflow
        }

    // "main"
    // Print the nth iteration
    let _ =  [1] |> morris |> Seq.nth 3125 |> printList 
```

您可以使用 Seq.nth 选择第 n 次迭代，但您只能在遇到堆栈溢出之前完成此操作。我有一点递归是尾递归，它本质上构建了一组链接的枚举器。这不是问题所在。这是在第 4000 个序列上调用“枚举”的时候。请注意，对于 F# 1.9.6.16，之前的版本最高超过 14000）。这是因为链接序列的解析方式。序列是惰性的，因此“递归”是惰性的。也就是说， seq n 调用 seq n-1 ，后者调用 seq n-2 等等以获取第一项（第一个 # 是最坏的情况）。

我知道，`[|0|] |> Seq.append str |> Seq.windowed 2`这使我的问题变得更糟，如果我消除它，我可以产生三倍的#。实际上，代码运行良好。morris 的第 3125 次迭代长度将超过 10^359 个字符。

我真正想要解决的问题是如何保留惰性 eval，并且对于我可以选择的迭代没有基于堆栈大小的限制。我正在寻找合适的 F# 习惯用法来根据内存大小进行限制。

**2010 年 10 月更新**

在更好地学习 F#，一点点 Haskell，思考和研究这个问题一年多之后，我终于可以回答我自己的问题了。但与难题一样，问题始于错误的问题。问题不在于序列的序列——这实际上是因为递归定义的序列。我的函数式编程技能现在稍微好一点，所以更容易看到下面的版本发生了什么，它仍然得到一个 stackoverflow

```
let next str = 
    Seq.append str [0]
    |> Seq.pairwise
    |> Seq.scan (fun (n,_) (c,v) ->
            if (c = v) then (n+1,Seq.empty)
            else (1,Seq.ofList [n;c]) ) (1,Seq.empty)
    |> Seq.collect snd

let morris = Seq.unfold(fun sq -> Some(sq,next sq)) 
```

这基本上创建了一个非常长的 Seq 处理函数调用链来生成序列。F#自带的Seq模块就是不使用栈就不能跟链的。它对追加和递归定义的序列进行了优化，但该优化仅在递归实现追加时才有效。

所以这会起作用

```
let rec ints n = seq { yield n; yield! ints (n+1) }
printf "%A" (ints 0 |> Seq.nth 100000);; 
```

这个会得到一个stackoverflow。

```
let rec ints n = seq { yield n; yield! (ints (n+1)|> Seq.map id) }
printf "%A" (ints 0 |> Seq.nth 100000);; 
```

为了证明 F# 库是问题所在，我编写了自己的 Seq 模块，该模块使用延续实现了追加、成对、扫描和收集，现在我可以毫无问题地开始生成和打印 50,000 个序列（它永远不会完成，因为它已经结束了10^5697 位长）。

一些附加说明：

*   Continuations 是我一直在寻找的习语，但在这种情况下，它们必须进入 F# 库，而不是我的代码。我从[Tomas Petricek 的](http://tomasp.net/) *Real-World Functional Programming*一书中了解了 F# 中的延续。
*   我接受的惰性列表答案是另一个成语；懒惰的评价。在我重写的库中，我还必须利用惰性类型来避免 stackoverflow。
*   惰性列表版本是靠运气工作的（可能是设计使然，但这超出了我目前的能力范围）——它在构建和迭代时使用的活动模式匹配导致列表在所需的递归变得太深之前计算值，所以它很懒，但不是那么懒，它需要继续以避免stackoverflow。例如，当第二个序列需要第一个序列中的一个数字时，它已经被计算出来了。换句话说，LL 版本对于序列生成并不是严格的 JIT 惰性，只是列表管理。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-22T18:27:11.093

你一定要看看

[http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/FSharp.PowerPack/Microsoft.FSharp.Collections.LazyList.html](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/FSharp.PowerPack/Microsoft.FSharp.Collections.LazyList.html)

但我稍后会尝试发布更全面的答案。

**更新**

好的，下面有一个解决方案。它将莫里斯序列表示为 int 的 LazyLists 的 LazyList，因为我假设您希望它在“两个方向”上都是惰性的。

F# LazyList（在 FSharp.PowerPack.dll 中）具有三个有用的属性：

*   它是惰性的（直到第一次被要求才对第 n 个元素进行评估）
*   它不会重新计算（重新计算同一对象实例上的第 n 个元素不会重新计算它 - 它会在第一次计算后缓存每个元素）
*   您可以“忘记”前缀（当您“尾随”到列表中时，不再引用的前缀可用于垃圾收集）

第一个属性在 seq (IEnumerable) 中很常见，但其他两个属性是 LazyList 独有的，对于计算问题非常有用，例如在这个问题中提出的问题。

废话不多说，代码：

```
// print a lazy list up to some max depth
let rec PrintList n ll =
    match n with
    | 0 -> printfn ""
    | _ -> match ll with
           | LazyList.Nil -> printfn ""
           | LazyList.Cons(x,xs) ->
               printf "%d" x
               PrintList (n-1) xs

// NextMorris : LazyList<int> -> LazyList<int>
let rec NextMorris (LazyList.Cons(cur,rest)) = 
    let count = ref 1
    let ll = ref rest
    while LazyList.nonempty !ll && (LazyList.hd !ll) = cur do
        ll := LazyList.tl !ll
        incr count
    LazyList.cons !count
        (LazyList.consf cur (fun() ->
            if LazyList.nonempty !ll then
                NextMorris !ll
            else
                LazyList.empty()))

// Morris : LazyList<int> -> LazyList<LazyList<int>>
let Morris s =
    let rec MakeMorris ll =
        LazyList.consf ll (fun () ->
            let next = NextMorris ll
            MakeMorris next
        )
    MakeMorris s

// "main"
// Print the nth iteration, up to a certain depth
[1] |> LazyList.of_list |> Morris |> Seq.nth 3125 |> PrintList 10
[1] |> LazyList.of_list |> Morris |> Seq.nth 3126 |> PrintList 10
[1] |> LazyList.of_list |> Morris |> Seq.nth 100000 |> PrintList 35
[1] |> LazyList.of_list |> Morris |> Seq.nth 100001 |> PrintList 35 
```

**更新2**

如果您只想数数，那也没关系：

```
let LLLength ll =
    let rec Loop ll acc =
        match ll with
        | LazyList.Cons(_,rest) -> Loop rest (acc+1N)
        | _ -> acc
    Loop ll 0N

let Main() =
    // don't do line below, it leaks
    //let hundredth = [1] |> LazyList.of_list |> Morris |> Seq.nth 100
    // if we only want to count length, make sure we throw away the only
    // copy as we traverse it to count
    [1] |> LazyList.of_list |> Morris |> Seq.nth 100
        |> LLLength |> printfn "%A" 
Main() 
```

内存使用率保持不变（我的盒子上低于 16M）......尚未完成运行，但我快速计算了第 55 个长度，即使在我的慢盒子上也是如此，所以我认为这应该可以正常工作。另请注意，我使用'bignum's 作为长度，因为我认为这会溢出'int'。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-16T21:00:00.390

我认为这里有两个主要问题：

*   惰性是非常低效的，因此您可以期望惰性函数实现的运行速度要慢几个数量级。例如，[这里](http://www.research.att.com/~njas/sequences/A005150)描述的 Haskell 实现比我在下面给出的 F# 慢 2,400 倍。如果您想要一种解决方法，您最好的选择可能是通过将它们捆绑在一起成按需生产批次的急切批次来摊销计算。

*   该`Seq.append`函数实际上是从 C# 代码中调用的`IEnumerable`，因此，它的尾调用不会被消除，并且每次通过它时都会泄漏更多的堆栈空间。当您枚举序列时，就会出现这种情况。

在计算第 50 个子序列的长度时，以下代码比您的实现快 80 倍以上，但可能对您来说还不够懒惰：

```
let next (xs: ResizeArray<_>) =
  let ys = ResizeArray()
  let add n x =
    if n > 0 then
      ys.Add n
      ys.Add x
  let mutable n = 0
  let mutable x = 0
  for i=0 to xs.Count-1 do
    let x' = xs.[i]
    if x=x' then
      n <- n + 1
    else
      add n x
      n <- 1
      x <- x'
  add n x
  ys

let morris =
  Seq.unfold (fun xs -> Some(xs, next xs)) (ResizeArray [1]) 
```

这个函数的核心是一个折叠 a `ResizeArray`，如果你使用一个结构体作为累加器，它可以被分解出来并在功能上使用而不会造成太多的性能下降。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T19:21:46.877

只需保存您查找的上一个元素。

```
let morris2 data = seq {
    let cnt = ref 0
    let prev = ref (data |> Seq.nth 0)

     for cur in data do
        if cur <> !prev then
            yield! [!cnt; !prev]
            cnt := 1
            prev := cur
        else
            cnt := !cnt + 1

    yield! [!cnt; !prev]
}

let rec morrisSeq2 cur = seq {
    yield cur
    yield! morrisSeq2 (morris2 cur)
} 
```

# asp.net - 在 asp.net 中使用会话

> ID：898990
> 
> 赞同：2
> 
> 时间：2009-05-22T17:25:20.410
> 
> 标签：asp.net, session-state

我希望我在 pageA 的文本框中输入的数据可以在 pageB 上访问

例如：用户在页面 A 的文本框中输入他们的姓名

B页说你好（他们在文本框中输入的信息）

我听说这可以通过使用会话来完成，但我不知道如何。

有人可以告诉我如何设置会话以及如何在其中存储数据吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T17:30:11.323

```
Session["valueName"]=value; 
```

或者

```
Session.Add("valueName",Object); 
```

您可以通过以下方式检索标签中的值（例如）

```
/*if String value */     
Label1.Text=Session["valueName"].ToString(); 
```

或者

```
Label1.Text=Session.item["valueName"].ToString(); 
```

您还可以通过以下方式删除会话；

```
/*This will remove what session name by valueName.*/
 Session.Remove( "valueName"); 

/*All Session will be removed.*/ 
Session.Clear(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T17:28:13.307

```
// Page A on Submit or some such
Session["Name"] = TextBoxA.Text;

// Page B on Page Load
LabelB.Text = Session["Name"]; 
```

默认情况下启用会话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T17:35:16.340

是的，你可以像 JohnOpincar 所说的那样做，但你不需要这样做。

您可以使用跨页回发。在 ASP.Net 2.0 中，跨页面回发允许发布到不同的网页，从而产生更直观、结构化和可维护的代码。在[本文中](http://www.c-sharpcorner.com/UploadFile/DipalChoksi/xpgpostbk_asp2_dc08102006235543PM/xpgpostbk_asp2_dc.aspx?ArticleID=9e2b12e6-7842-419d-a3c9-df58f6aba523)，您可以探索跨页面回发机制的各种选项和设置。

您可以使用目标页面中的以下代码访问源页面中的控件：

```
protected void Page_Load(object sender, EventArgs e)
{
    ...
    TextBox txtStartDate = (TextBox) PreviousPage.FindControl("txtStartDate ");
    ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T17:36:24.390

您可以使用会话来执行此操作，但如果您是 ASP.NET 2.0 或更高版本，也可以使用跨页面回发

[http://msdn.microsoft.com/en-us/library/ms178139.aspx](http://msdn.microsoft.com/en-us/library/ms178139.aspx)

```
if (Page.PreviousPage != null) {
    TextBox SourceTextBox = 
        (TextBox)Page.PreviousPage.FindControl("TextBox1");
    if (SourceTextBox != null) {
        Label1.Text = SourceTextBox.Text;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T21:03:56.140

甚至还有更简单的方法。使用查询字符串：

在页面 A 中：

```
<form method="get" action="pageB.aspx">
    <input type="text" name="personName" />
    <!-- ... -->
</form> 
```

在 B 页：

```
Hello <%= Request.QueryString["personName"] %> ! 
```

# ironpython - IronPython 2.0 执行代码缓慢

> ID：898993
> 
> 赞同：0
> 
> 时间：2009-05-22T17:25:53.653
> 
> 标签：ironpython

IronPython 2.0.1 执行脚本文件的速度似乎比 IronPython 1.x 慢 3 倍。我不相信这不是我正在做的事情，所以我想知道其他人是否有类似的经历。

我有一个 200k 的 python 脚本，从 IP 1.x 上的文件执行需要 5 秒，在 IP 2.0.1 上需要将近 18 秒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T16:30:13.963

IronPython 中肯定有一些事情比 Python 慢得多。这通常是因为您在实现中遇到了一个奇怪的极端情况。值得尝试将其简化为一个非常简单的脚本，该脚本展示了性能差异并将其发送到[IronPython 邮件列表](http://lists.ironpython.com/listinfo.cgi/users-ironpython.com)- 开发人员非常敏感。

最近有一系列关于 IronPython 性能的有趣博客文章 -[这是一个很好的概述](http://ironpython-urls.blogspot.com/2009/05/python-jython-and-ironpython.html)。总结是，一旦你避免了陷阱，你可以获得非常好的性能，并且 IP 团队非常有兴趣找出这些问题并快速修复它们。缩小重现范围以找到陷阱是最困难的部分——一旦你弄清楚是什么触发了这种行为，通常很容易解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T23:44:24.513

当我开始使用 IronPython 2.0 时，我也遇到了类似的问题。对我来说，问题是 DLR 的启动时间很短。加载运行时后，脚本性能相当快。

要减少运行时启动时间，您可以尝试[对二进制文件进行 NGEN 处理](https://stackoverflow.com/questions/382487/how-do-i-install-ironpython-2-0-with-ngened-binaries)。这为我减少了大约 60% 的启动时间。

即使有了这个修复，相对来说它仍然没有那么快。如果您的脚本没有做太多，启动仍将占用总时间的很大一部分。希望 DLR 团队能尽快解决启动性能问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T06:15:25.977

您的时间是否包括启动时间？IronPython 2.6 Beta 对启动时间和代码编译/执行进行了彻底的改进。如果可以，建议您尝试该版本。

干杯，戴维

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T16:21:35.153

您可以阅读文章[IronPython：重用导入符号以避免性能影响](http://www.hardcodet.net/2008/12/ironpython-performance-with-imports)，这可以使嵌入式场景运行得更快。

# java - 是否可以使用 Axis 2 wsdl2java 生成使用 HTTPS 的客户端代码？

> ID：898999
> 
> 赞同：1
> 
> 时间：2009-05-22T17:26:34.243
> 
> 标签：java, soap, axis2

使用默认参数，axis 2 wsdl2java 工具将 wsdl 文件作为输入，并生成客户端 Java 代码，该代码使用 HTTP 协议与 SOAP 端点通信，如下例所示：

```
wsdl2java -uri MyService.wsdl 
```

我想知道的是是否有一个输入参数可以传递给 wsdl2java 工具以生成通过 HTTPS 与 SOAP 端点通信的客户端代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T18:45:15.120

我们经常使用 Axis over HTTPS。正如 Ted 提到的，按顺序获取 SSL 证书（尤其是自签名证书）非常重要，因为它实际上是一个交易破坏者。

代码方面，我们通常针对普通的 HTTP 服务生成 Axis 存根。由 wsdl2java 命令生成的对 ServiceLocator 子类的调用将具有一个“getMyService”方法，该方法将 URL 作为参数以及不带参数的方法。根据您的服务的确切 Axis 版本和名称，类名称可能会有所不同。但在大多数情况下，以下示例演示了在实例化存根对象时更改 URL（HTTPS 或 HTTP）以指向您想要的任何位置是多么容易。

```
MyServiceServiceLocator locator = new MyServiceServiceLocator();
MyService_PortType myservice = locator.getMyService(new URL("https://www.myservice.net/MyService.jws")); 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T17:33:26.903

下面的帖子有你的答案，我不会抄袭和复制。您可以从提供的 ant xml 中提取这些参数。您需要担心 Java 拥有它需要的证书。我相信这篇文章是在与客户端代码对话。https url 也可能只需要在 WSDL 中指定为 https。

[http://article.gmane.org/gmane.comp.apache.webservices.axis.user/58499](http://article.gmane.org/gmane.comp.apache.webservices.axis.user/58499)**********