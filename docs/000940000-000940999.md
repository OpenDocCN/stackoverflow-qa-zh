# StackOverflow 问答 000940000-000940999

# .net - 使用反射获取类型的静态字段值

> ID：940002
> 
> 赞同：9
> 
> 时间：2009-06-02T14:51:41.410
> 
> 标签：.net, vb.net, reflection

我有一组静态“枚举”类，我用它们来保存有意义的变量名，以表示我在输入文件中收到的无意义的代码值。这是一个例子。

```
Public Class ReasonCodeValue
    Private Sub New()
    End Sub
    Public Shared ReadOnly ServiceNotCovered As String = "SNCV"
    Public Shared ReadOnly MemberNotEligible As String = "MNEL"
End Class 
```

我想编写一个方法来接受这些静态类之一的类型和一个字符串值，并确定该值是否是静态字段值之一。我知道如何获取特定对象的实例字段，也知道如何获取特定类型的静态字段列表；我想不通的是如何在没有实例的情况下获取静态字段值。这是我到目前为止所得到的。

```
Public Function IsValidValue(ByVal type As Type, ByVal value As String) As Boolean
    Dim fields = type.GetFields(BindingFlags.Public Or BindingFlags.Static)
    For Each field As FieldInfo In fields
        DoSomething()
    Next
End Function 
```

我想我可以使枚举类成为非静态的，这样我就可以创建一个实例来传递给`FieldInfo.GetValue`我的验证方法。如果可以的话，我宁愿让我的课堂保持原样。

我看到一个方法叫做`GetRawConstantValue`. 看起来很危险。这会给我我想要的东西吗？还有其他想法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-02T14:53:53.310

称呼

```
field.GetValue(Nothing) 
```

会好的。您不需要静态成员的实例。

我不*认为* `GetRawConstantValue`这是你想要的 - 我会坚持上面的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T15:54:04.427

从更大的意义上看你想要做的事情，也许这会更合适：

```
Public Interface ICustomEnum(Of T)
    Function FromT(ByVal value As T) As ICustomEnum(Of T)
    ReadOnly Property Value() As T

    ''// Implement using a private constructor that accepts and sets the Value property, 
    ''// one shared readonly property for each desired value in the enum,
    ''// and widening conversions to and from T.
    ''// Then see this link to get intellisense support
    ''// that exactly matches a normal enum:
    ''// https://stackoverflow.com/questions/102084/hidden-features-of-vb-net/102217#102217
End Interface

'
''' <completionlist cref="ReasonCodeValue"/>
Public NotInheritable Class ReasonCodeValue
    Implements ICustomEnum(Of String)

    Private _value As String
    Public ReadOnly Property Value() As String Implements ICustomEnum(Of String).Value
        Get
            Return _value
        End Get
    End Property

    Private Sub New(ByVal value As String)
        _value = value
    End Sub

    Private Shared _ServiceNotCovered As New ReasonCodeValue("SNCV")
    Public Shared ReadOnly Property ServiceNotCovered() As ReasonCodeValue
        Get
            Return _ServiceNotCovered
        End Get
    End Property

    Private Shared _MemberNotEligible As New ReasonCodeValue("MNEL")
    Public Shared ReadOnly Property MemberNotEligible() As ReasonCodeValue
        Get
            Return _MemberNotEligible
        End Get
    End Property

    Public Shared Function FromString(ByVal value As String) As ICustomEnum(Of String)
        ''// use reflection or a dictionary here if you have a lot of values
        Select Case value
            Case "SNCV"
                Return _ServiceNotCovered
            Case "MNEL"
                Return _MemberNotEligible
            Case Else
                Return Nothing ''//or throw an exception
        End Select
    End Function

    Public Function FromT(ByVal value As String) As ICustomEnum(Of String) Implements ICustomEnum(Of String).FromT
        Return FromString(value)
    End Function

    Public Shared Widening Operator CType(ByVal item As ReasonCodeValue) As String
        Return item.Value
    End Operator

    Public Shared Widening Operator CType(ByVal value As String) As ReasonCodeValue
        Return FromString(value)
    End Operator
End Class 
```

然后使用此链接，您可能可以获得与普通枚举完全匹配的智能感知支持：
[VB.NET 的隐藏功能？](https://stackoverflow.com/questions/102084/hidden-features-of-vb-net/102217#102217)

# java - 使用 System.out.println 语句检测 java 源文件？

> ID：940003
> 
> 赞同：0
> 
> 时间：2009-06-02T14:51:43.173
> 
> 标签：java, debugging

我正在寻找一种简单的方法（例如，单个脚本/批处理文件或简单程序）来检测一组 Java 源文件，以便每个方法在进入和退出时都有一个添加的 System.out.println 语句。

我找不到这样的实用程序。我需要这个的原因（以及为什么它必须在源文件而不是 .class 文件上工作）是目标系统是嵌入式 Java 系统。

在此先感谢， pd

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T15:01:21.500

[这是面向方面编程](http://www.eclipse.org/aspectj/)的一个极好的用例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T14:55:48.563

您可能没有找到太多东西，因为使用`System.out`将是检测应用程序的一种非常可怕的方式。

你想做什么——分析性能、代码覆盖率等？如果是这样，两者都有很多工具。

*   [关于分析器的另一个问题](https://stackoverflow.com/questions/90176/java-how-can-i-see-what-parts-of-my-code-are-running-the-most)
*   [链接到开源 Java 分析器](http://java-source.net/open-source/profilers)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:35:30.830

我同意 Kees，您应该使用面向方面的编程来自动将日志记录添加到每个功能。我使用以下代码对计时做了类似的事情：

```
import org.apache.commons.logging.LogFactory;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;
import org.springframework.util.StopWatch;

@Aspect
public class ProfilingAspect {

    @Around("methodsToBeProfiled()")
    public Object profile(ProceedingJoinPoint pjp) throws Throwable {
        StopWatch sw = new StopWatch(pjp.getSignature().getClass().getSimpleName());
        try {
            sw.start(pjp.getSignature().getName());
            return pjp.proceed();
        } finally {
            sw.stop();
            LogFactory.getLog(pjp.getSignature().getClass()).debug(sw.shortSummary());
        }
    }

    @Pointcut("execution(public * *.*(..))")
    public void methodsToBeProfiled(){}
} 
```

这几乎是您可以添加的最简单的方面。关键部分是切入点注释，它声明您希望将此方面应用于每个包中每个公共类的每个公共方法，无论其返回类型或输入参数是什么。你可能想让它更具体。@Around 注释指的是切入点，并指定了您希望“围绕”函数执行的一堆代码。在您的情况下，如果您只想记录一个被调用的函数，您可以将 @Around 替换为 @Before 或 @AfterReturning，具体取决于您想要记录的位置。如果您正在构建应用程序的所有内容，请针对“编译时编织”而不是加载时间。它降低了应用程序的运行时要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T16:40:17.880

我以前在没有其他方法的情况下做过。一旦我将其归结为正确的方法，我实际上已经进入并每隔一行插入一个系统输出。

（例如，我只是在一个 JVM 上工作，其中引发异常的 RMI 调用被静默吃掉，调用线程无限期挂起！哦，当然，我们不能使用调试器。你还能找到什么？ ?)

无论如何，仅仅运行一个在任何地方插入调试输出的程序都无济于事。你会迷失分析输出的页面。而是尝试将问题所在的位置括起来并在此处手动插入输出行。

如果您的线程“消失”在单行上或出现意外转弯，则将该行分解为最小的可运行部分，找出哪个部分失败，然后深入研究并重复 - 没什么可做的。

顺便说一句，另一个有用的工具——即使在一个非常旧的 JVM 上，你也可以在任何时候抛出一个“(new Exception()).printStackTrace();” 在不影响程序流程的情况下转储堆栈。如果您发现自己在某个位置并且不知道自己是如何到达那里的，这会有所帮助。

最后，如果你真的很懒惰，你可以使用一个静态方法来完成所有调试输出（仅委托给 System.out.println），并添加几行以获得堆栈跟踪，只获取“调用”行/方法并在调试语句之前将其打印出来，为您提供穷人的日志记录实用程序。

只是我从多年来在嵌入式平台上使用旧版本的 java 中学到的一些手动调试技巧。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T19:38:21.063

我为 slf4j 编写了一个扩展，它提供了您正在寻找的功能（除了作为记录器调用而不是 System.out，但将记录器调用发送到 System.out 很简单）。

看看[http://www.slf4j.org/extensions.html#javaagent](http://www.slf4j.org/extensions.html#javaagent)

# reporting-services - 如何省略登录到 MS Reporting Services？

> ID：940014
> 
> 赞同：1
> 
> 时间：2009-06-02T14:53:47.677
> 
> 标签：reporting-services, login

在工作中，我们有一个基于 Web 的 PHP 应用程序，它充当单个 UI，根据用户的访问权限（较近的 windows-logon 或 ldap）授予对某些模块的访问权限。

对于其中一个模块，我们现在希望使用嵌入在 UI 中的 MS Reporting Services 来显示报告。我们不希望用户为此拥有另一个登录名和密码，因此我们考虑将用户名传递给报告服务，从而省略登录。我们找不到有关如何执行此操作的任何信息...我们错过了什么？

有没有办法将登录信息传递给服务？通过 GET？通过邮政？任何事物？

最好的祝福，

卡西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T15:05:50.290

您可以以允许匿名连接的方式设置您的报告服务。我猜测作为一个 PHP 系统，你 a) 没有 Active Directory b) 使用你自己的安全机制。您可以从服务器请求报告，并在此过程中模拟用户，但听起来您更愿意使用匿名？

我个人会小心的。但我相信你已经考虑过其中的含义。如果您想了解有关如何运行报告服务器以及为匿名用户提供页面的更多信息，我可以概述我之前使用的流程。

如果用户在 Active Directory 域上，并且浏览器在组策略的控制下，您可以设置该区域，以自动传递 Windows 凭据，那么只需配置您的报表服务器以授予对所有用户。这将是最少的努力，我认为是最安全的方法。

希望能帮助到你

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T15:01:27.583

您应该能够查看报告服务的 URL 访问功能，并且应该允许您执行所需的任何操作。

# windows - Windows 上的 ZLIB：gzopen/gzwrite/gzclose 产生阉割的输出文件/防病毒错误？

> ID：940018
> 
> 赞同：0
> 
> 时间：2009-06-02T14:54:02.543
> 
> 标签：windows, antivirus, zlib

这几天我一直在追一个非常神秘的错误，它似乎围绕着（[ZLIB 库](http://www.zlib.net)）；它每月左右发生一次，并且仅在某些特定的生产环境中发生。以下是代码的作用：

1.  程序调用`gzopen`写入文件`X`。
2.  程序将数据写入文件，执行几个`gzwrite`.
3.  程序最终调用`gzclose`它刷新文件。

通常，一切正常，文件`X`有效；它以 CRC 和源流的长度正确终止。

但是，在其中一个故障中，我观察到这`X`是损坏的：数据的开头是正确的，但是从 offset 开始`0x00302000`，每个字节都是空的。即使是编码 CRC 和长度的最后八个字节也为零。但是，该文件具有正确的大小！更糟糕的是：同一个系统在几分钟前成功压缩了一个非常相似的文件。

注意：我们使用的 ZLIB.DLL 版本为 1.1.3；是的，我知道，它包含一些安全漏洞，我们应该升级到最新的 ZLIB 1.2.3，但在找到归零的原因之前，我不想更改我的设置中的任何内容。

我认为我已经排除了内存损坏（顺便说一下，损坏的内存堆怎么会干扰`fwrite`到它只向输出流写入零？这是否合理？），打开/写入/关闭流的循环很简单，没有发现我能发现的任何缺陷，代码不会分配/释放/弄乱 ZLIB 中的结构（这可能是个问题，因为 ZLIB 链接到另一个 C 库而不是我的应用程序 DLL），所以我只能怀疑系统中的其他元素。

不知何故，我倾向于对 C 库 (CRTDLL.DLL)、Win32 API、NTFS 堆栈、I/O 堆栈、低级设备驱动程序、硬盘固件和硬盘本身充满信心......是的，我也倾向于相信 Visual C++ 2008 会生成正确的二进制文件，至少在这种情况下是这样 ;-)

那么，我是否正确怀疑杀毒软件可能是罪魁祸首？ZLIB 应该谨慎，因为至少 Kaspersky 将 DLL 识别为可能的威胁。但是，如果（错误地）发现感染，杀毒软件只写零而不是数据在政治上是否正确？或者这可能是防病毒软件中的错误？

还是我完全错过了重点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T18:52:56.943

在不知道其他任何事情的情况下，我会怀疑您的代码，而不是防病毒代码。

将正确长度的数据写入文件需要一个简单的错误，但传入的缓冲区不正确，导致文件中的数据“全为零”。

很难发现的简单错误有时会导致非常大的混乱，就像你遇到的那样。

如果我对此进行故障排除，我会：

*   简化 简化 简化，直到问题停止。然后逐步添加复杂性。
*   检查你的指针和指针算术
*   检查您是否正确刷新和关闭文件
*   使用分配器将标记字节存储在分配的缓冲区中，例如 0xAA 而不是 0x00。通过这种方式，您可以查看正在写入文件的是否是您的（归零）缓冲区。
*   在调试器中逐步完成所有操作

在正常情况下，经过 GZIP 压缩的数据永远不会有很长的连续零。这些将被折叠成字典和长度代码。

# clickonce - 将文件添加到单击一次部署

> ID：940025
> 
> 赞同：29
> 
> 时间：2009-06-02T14:55:17.223
> 
> 标签：clickonce

我有一个要转移到 ClickOnce 的应用程序，该应用程序有一个中等大小的数据文件夹，其中包含数百个文件，我需要在部署中包含这些文件。该文件夹需要在部署后相对于 EXE 位于同一位置。我已经看到了一些关于如何做到这一点的建议，但似乎没有达成一致的方法来做到这一点。

任何建议都会很棒-

谢谢！

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-06-13T15:41:51.787

这样做的一种好方法是：

*   在应用程序下以 VS 名称创建一个文件夹，例如“datafiles”
*   **选择在文件夹上添加现有项目**后，使用对话框中的**添加为链接**将所有文件添加到该文件夹
***   **如果较新**，则将所有文件标记为复制（*复制到输出目录*属性）*   确保*构建操作*是**内容****

 **--> 当您发布文件时，这些文件将被放入该文件夹并成为应用程序安装的一部分

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T21:18:04.107

部署后，所有标记为数据的文件都放置在 ApplicationDeployment.DataDirectory 文件夹中。我知道没有办法改变这一点。您可以在应用程序的第一次运行期间复制数据文件，但这种方法将无法在任何包含数据文件更改的升级中继续存在。

或者，如果您在开发期间可以控制数据文件夹的位置，则可以将其放置在与部署后指定的相同的相对（相对于应用程序文件夹）位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-18T19:35:40.507

[https://msdn.microsoft.com/en-us/library/kzy0fky2.aspx](https://msdn.microsoft.com/en-us/library/kzy0fky2.aspx)

[https://msdn.microsoft.com/en-us/library/6fehc36e.aspx](https://msdn.microsoft.com/en-us/library/6fehc36e.aspx)

这两篇文章提供了执行此操作的方法。在这两者之间，您可以找到适合您的。对我有用的是：

> 在解决方案资源管理器中选择一个项目后，在“项目”菜单上，单击“属性”。单击发布选项卡。单击应用程序文件按钮打开应用程序文件对话框。在“应用程序文件”对话框中，选择要标记为数据的文件。在发布状态字段中，从下拉列表中选择数据文件。

# c# - How do I use a transaction in LINQ to SQL using stored procedures?

> ID：940040
> 
> 赞同：5
> 
> 时间：2009-06-02T14:59:42.157
> 
> 标签：c#, sql-server, sql-server-2005, linq-to-sql, .net-3.5

I have a piece of code that looks something like this (ClearImportTable and InsertPage are stored procedures):

```
datacontext.ClearImportTable() //Essentially a DELETE FROM table
for (int i = 1; i < MAX_PAGES; ++i){
    datacontext.InsertPage(i); //Inserts data into the table
} 
```

This is a somewhat simplified version of my code, but the idea is that it clears the table before inserting records. The only problem is that if an error occurrs after ClearImportTable, all of the data from the table is wiped. Is there any way to wrap this in a transaction so that if there are any errors, everything will be put back the way it was?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T15:03:44.770

You can do a transaction scope:

```
 using (var transaction = new TransactionScope())
 {
     // do stuff here...
     transaction.Complete();
 } 
```

If an exception occurs or the using block is left without hitting the transaction.Complete() then everything performed within the using block is rolled back.

You will need to reference the System.Transactions assembly.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-02T16:16:12.333

As "Sailing Judo" mentioned above, I've used the TransactionScope blocks with great success when I need to call stored procs. However there's one "gotcha" that I've run into where an exception gets thrown saying that the "transaction is in doubt." To get around this I had to call a nondeferred method on the proc to make it evaluate the result immediately. So instead of

```
using (var transaction = new TransactionScope())
{
    var db = new dbDataContext();

    db.StoredProc();
    transaction.Complete();
} 
```

I had to call it like this...

```
using (var transaction = new TransactionScope())
{
    var db = new dbDataContext();

    db.StoredProc().ToList();
    transaction.Complete();
} 
```

In this example, ToList() could be any nondeferred method which causes LINQ to immediately evaluate the result.

I assume this is because LINQs lazy (deferred) nature isn't playing well with the timing of the transaction, but this is only a guess. If anyone could shine more light on this, I'd love to hear about it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T15:55:50.557

Set the Transaction property on the DataContext?

# excel - 如何在 Excel 下载时抑制文件损坏警告？

> ID：940045
> 
> 赞同：18
> 
> 时间：2009-06-02T15:00:39.583
> 
> 标签：excel, coldfusion

我有一个链接到 Excel 2007 工作表的网页。它是一个`.xls`文件而不是`.xlsx`文件。当我单击链接时，我会看到通常的对话框来打开/保存 Excel 文件。单击“打开”时，我收到以下警告消息-

> 您尝试打开的文件“filename.xls”的格式与文件扩展名指定的格式不同。在打开文件之前，请确认文件没有损坏并且来自受信任的来源。您现在要打开文件吗？

我可以如何以编程方式抑制此警告消息（即隐藏它或阻止它出现？）我正在使用 ColdFusion 进行 Web 开发。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-02T15:05:58.697

如果您不想寻找解决方案，而只是想解决问题，请在注册表中插入此键以禁止通知：

[HKEY_CURRENT_USER\Software\Microsoft\Office\12.0\Excel\Security] “ExtensionHardening”=dword:00000000

您可以通过执行以下操作来完成上述操作：

1.  打开您的注册表（开始 -> 运行 -> regedit.exe）
2.  导航到 HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\OFFICE\12.0\EXCEL\SECURITY
3.  右键单击右侧窗口并选择新建 -> DWORD
4.  键入“ExtensionHardening”作为名称（不带引号）
5.  验证数据的值是否为“0”</li>

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-02T15:24:01.953

[此问题是由称为扩展强化的功能引起的，您可以在此处](https://web.archive.org/web/20090615225051/http://blogs.msdn.com/vsofficedeveloper/pages/Excel-2007-Extension-Warning.aspx)找到有关它的更多信息

我在我的项目中经常遇到这个问题，就像 Jon 说的那样，关闭扩展强化是每个客户端用户都必须完成的事情。

不幸的是，上面的链接还指出，至少在 Office 14 之前，此代码没有预期的更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-18T17:08:32.037

## 对于旧的 Excel 格式 (.xls)

假设您使用以下语法创建电子表格对象：

```
<cfset sheet = SpreadsheetNew() /> 
```

您将使用它来创建下载：

```
<cfheader name="content-disposition" value="attachment;filename=my_spreadsheet.xls">
<cfcontent type="application/vnd.ms-excel" variable="#spreadsheetReadBinary(sheet)#" reset="true"> 
```

## 对于较新的 Excel 格式 (.xlsx)

使用以下语法创建电子表格对象：

```
<cfset sheet = SpreadsheetNew("", "true") /> 
```

并使用它来创建下载：

```
<cfheader name="content-disposition" value="attachment;filename=my_xml_spreadsheet.xlsx">
<cfcontent type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" variable="#spreadsheetReadBinary(sheet)#" reset="true"> 
```

感谢[Raymond Camden](http://www.raymondcamden.com/index.cfm/2011/7/12/One-more-I-swear-this-is-it-follow-up-to-my-CFSpreadSheet-Example)的大部分工作（他的示例是用旧格式创建电子表格——我更新了新格式并使用了稍微不同的 MIME 值）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T15:05:19.900

我不相信你可以对用户隐藏它。这些类型的警告在您的浏览器之外。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T15:27:15.160

该消息表明文件内容和文件扩展名不匹配。因此，要么是 XLSX 文件，要么服务器上的当前文件以某种方式损坏。我建议尝试使用 ZIP 工具打开文件。如果可行，它实际上是一个 XLSX 格式的文件。然后，您可以通过重命名文件来修复警告。

如果不是这种情况，则文件发生了问题。

但无论哪种方式，抑制警告都不能解决您的问题。下次病毒出现并要求您的客户打开`nakedgrls.gif.exe`时，您最好不要弄乱安全设置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T13:50:59.873

如果您使用方便的 cfcontent 技巧输出为 excel 文件，请考虑使用 cfx_query2excel，它会编写真正的 excel 文件，可以帮助您完成此操作。这是一个 Java 库，值得。

祝你好运。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T14:33:03.687

如果您没有指定文件扩展名，它可能被命名为内容类型为“application/vnd-excel”的 .cfm 文件，这会导致此警告。

在文件输出开始之前尝试添加：

```
<cfheader name="Content-Disposition" value="attachment;filename=myexcelfile.xls">
<cfcontent type="application/ms-excel" reset="true"> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-01-30T04:28:41.973

我有同样的问题和客户抱怨它。我做了很多谷歌搜索，但没有运气。最后，我使用 cfspreadsheet 创建了电子表格，我知道它需要额外的工作而不是直接通过 HTML 创建，但它删除了警告。

# svn - 在颠覆中，我如何取消劫持文件？

> ID：940057
> 
> 赞同：7
> 
> 时间：2009-06-02T15:02:00.390
> 
> 标签：svn, version-control

目前，我的团队有一组不应受版本控制的文件，但它们是。我想从我们的 subversion 存储库中删除它们，并允许每个人保留他们的本地版本。实现这一目标的最佳方法是什么？

删除文件会将它们从存储库以及每个人的本地文件系统中删除。使用 --keep-local 标志几乎可以工作。它允许我将副本保留在我的机器上，将其从存储库中删除，但仍会从其他所有人的文件系统中删除文件。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T19:15:54.103

删除文件后，您的用户必须使用`svn export`.

```
$ svn export -r x path ./ 
```

Where`x`是文件在被删除之前存在的修订版，是文件`path`的完整路径，并且`./`是放置文件的位置。

有关[`svn help export`](http://svnbook.red-bean.com/en/1.0/re10.html)更多信息，请参阅。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T15:17:31.233

当您从 repo 中删除它时，它最终会从其他工作副本中删除它。

当您确实要安装一个新系统时，一种通常效果很好的技术是让代码查找一个被特别忽略的本地文件（比如 config-local.php）（因此永远不会被放入存储库)，如果没有找到更具体的文件，则读取一个公共文件。这要么具有通用配置，要么引发错误以让他们创建本地版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T17:11:18.120

您只能删除该文件，并接受它在任何地方都被删除。用户始终可以使用 subversion 导出命令从 subversion 中恢复文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T15:12:04.910

与其删除它，不如将其移动到某个备份文件名（当然在 SVN 中）。然后在旧名称上设置 svn:ignore 属性。

无论如何，这些文件*都将被删除，但没有人会丢失他们的更改。*

# c# - 如何强制 StringTemplate 评估属性内的属性？

> ID：940062
> 
> 赞同：4
> 
> 时间：2009-06-02T15:03:33.460
> 
> 标签：c#, stringtemplate

我有以下代码：

```
StringTemplate st = new StringTemplate("$msg$");
st.SetAttribute("msg", "Hello $usr$");
st.SetAttribute("usr", "Jakub");
Console.WriteLine(st); 
// current output:  "Hello $usr$"
// expected output: "Hello Jakub" 
```

有人知道如何强制[StringTemplate](http://www.stringtemplate.org/)评估`$usr$`属性吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T15:12:10.213

正确的解决方案应该如下所示。

```
StringTemplate st = new StringTemplate("$msg$");
st.SetAttribute("msg", new StringTemplate("Hello $usr$"));
st.SetAttribute("usr", "Jakub");
Console.WriteLine(st); 
// current output:  "Hello Jakub"
// expected output: "Hello Jakub" 
```

下次我会在问之前两次。我保证 ：-）

# php - 使用来自一个 mysql 的结果进行第二个查询

> ID：940065
> 
> 赞同：0
> 
> 时间：2009-06-02T15:03:48.047
> 
> 标签：php, mysql

我有两张桌子：

*   帖子 - 保存帖子信息
*   听 - 保存有关您正在收听的其他用户的信息。（您想查看哪些用户帖子）

听的结构是：

*   id（唯一）
*   userid（用户唯一ID）
*   listenid（他们也在收听的用户的 ID）

我如何从listen中收集与活动用户用户ID相匹配的所有条目，然后使用这些条目来查找与找到的任何listenid值匹配的所有帖子，以便创建我想要查看的组合用户帖子的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:09:04.183

```
SELECT  posts.*
FROM    listen
JOIN    posts
ON      posts.userid = listen.listenid
WHERE   listen.userid = @current_user 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T15:09:48.877

您可以使用简单的自然连接或其他答案中给出的直接连接来执行此操作。

```
select 
  *
from 
  posts, listen 
where 
  listen.userid == $active_user and 
  posts.userid = listen.userid 
```

**您可能希望对要引入的列更有选择性。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T15:11:00.187

我认为你在谈论这样的事情：

```
select postid from posts 
where userid in
(
    select listenid from listen
    where userid = CURRENT-USER
) 
```

这是假设表 posts 有一个 userid 字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T15:12:43.647

一个简单的加入行不通？

```
select 
 posts.* 
from 
 posts
inner join 
 listen
on 
 listen.listenID = posts.userID
where 
 listen.userID = ACTIVEUSER 
```

# sql-server - 查找 SQL Server 2005 Management Studio 的注册表

> ID：940066
> 
> 赞同：5
> 
> 时间：2009-06-02T15:04:02.803
> 
> 标签：sql-server, sql-server-2005, ssms

我想要注册表值 SQL Server 2005 Management Studio（因为我们的应用程序是依赖的；）在安装我们的应用程序之前，我正在检查 SQL Server 2005 Management Studio 是否存在，并且我已经交叉检查了带有 Express Edition 的 SQL Server Management Studio具有不同的注册表值，对于 SQL Server Management Studio Developer Edition，它具有不同的注册表值；我想要的只是一个 SQL Server 2005 Management Studio 的通用注册表，这样我就可以在安装我的产品之前检查它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T15:11:25.490

SQL 2005 SSMS 将其设置存储在

```
HKEY_CURRENT_USER\Software\Microsoft\Microsoft SQL Server\90\Tools\Shell 
```

SQL 2008 SSMS 将其设置存储在

```
HKEY_CURRENT_USER\Software\Microsoft\Microsoft SQL Server\100\Tools\Shell 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T16:33:32.213

我试过这条路，希望它有帮助：

```
HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\MICROSOFT SQL SERVER\90\TOOLS\SETUP\PRODUCT CODE 
```

# asp.net - 将表单身份验证/授权与重写的 URL 结合使用

> ID：940067
> 
> 赞同：3
> 
> 时间：2009-06-02T15:04:14.473
> 
> 标签：asp.net, url-rewriting, forms-authentication, authorization

我正在使用一些重写的​​ URL（示例取自 Scott Guthrie 的博客）和表单身份验证/授权进行快速沙盒测试。

我有一个非常简单的设置。

```
~/View/(\d{1,6})      =>      ~/Public/View.aspx?ContentID=$1 
```

和

```
~/Buy/(\d{1,6})       =>      ~/Private/Purchase.aspx?ContentID=$1 
```

我已通过分别浏览以下各项来确认 URL 重写正在工作

*   [http://localhost/urltest/Public/View.aspx?contentID=123456](http://localhost/urltest/Public/View.aspx?contentID=123456)
*   [http://localhost/urltest/View/123456](http://localhost/urltest/View/123456)
*   [http://localhost/urltest/Private/Purchase.aspx?contentID=123456](http://localhost/urltest/Private/Purchase.aspx?contentID=123456)
*   [http://localhost/urltest/Buy/123456](http://localhost/urltest/Buy/123456)

接下来，我为 Web.Config 中的这两个目录启用了表单身份验证/授权。设置如下

```
 <location path="Private">
    <system.web>
      <authorization>
        <deny users="?" />
      </authorization>
    </system.web>
  </location>
  <location path="Public">
    <system.web>
      <authorization>
        <allow users="*" />
      </authorization>
    </system.web>
  </location> 
```

当我浏览到 2 个原始 URL（.aspx）时，这非常有效，但当我浏览到 URL 重写版本时根本不会触发。

我试图单独添加`<location>`部分，`Buy`但这仍然无法导致授权/身份验证模块启动。

大概这是因为它没有将这些 URL 视为 ASPX 资源......我可以通过让重写器规则查找来绕过它

```
 <LookFor>~/Buy/(\d{1,6})\.aspx</LookFor> 
```

即强制重写的版本最后有一个ASPX，但这看起来很难看。无论如何，无论扩展名（或缺少扩展名）如何，都可以让 Auth Handlers 为任何 url 类型触发

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-23T15:23:54.097

要使用内置身份验证，您必须决定是否要基于原始“原始”URL 或重写的 URL 进行身份验证。看起来好像您正在使用的 URL 重写器在执行身份验证后已连接到一个事件，这就是为什么只遵循“公共”和“私人”文件夹规则的原因。如果您想基于重写的 URL 进行身份验证，那么您必须使用连接到较早事件（例如 BeginRequest）的重写器，并使用重写的 URL 更新您的 web.config。

或者，您可以插入您自己的身份验证提供程序，并做一些花哨的事情，例如检查重写的和原始的 URL，但这对于沙盒测试站点来说可能是多余的。

请参阅这篇文章了解更多信息：

[http://msdn.microsoft.com/en-us/library/ms972974.aspx](http://msdn.microsoft.com/en-us/library/ms972974.aspx)

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-19T12:24:51.737

在 ASP.NET 4.0（我相信它是在 3.5 SP1 中）中，包含了一个新的路由功能。使用此路由功能的好处是它现在直接在 ASP.NET 内部得到支持，因此您可以指定在执行路由时，它应尊重实际 .ASPX 文件的授权设置。

因此，我建议您调查是否可以实现此路由功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-26T14:11:21.673

目前尚不清楚您使用的是什么 url 重写库，但从外观上看，我认为它可能是 urlrewriter.net，但我没有看到任何标签？

*   [http://urlrewriter.net/index.php/support](http://urlrewriter.net/index.php/support)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-23T01:37:59.433

尝试对所有请求启用表单身份验证和授权。默认情况下，它仅对 .aspx 等 asp.net 请求启用。可以在 IIS (7) 中完成，也可以直接在 webserver/modules 部分的 web.config 中完成

```
<system.webServer>
   <modules>
        <remove name="FormsAuthentication" />
        <add name="FormsAuthentication" type="System.Web.Security.FormsAuthenticationModule" preCondition=""/>
        <remove name="UrlAuthorization" />
        <add name="UrlAuthorization" type="System.Web.Security.UrlAuthorizationModule" preCondition="" />
   </modules>
</system.webServer> 
```

# c# - C# 初始加载页面

> ID：940068
> 
> 赞同：7
> 
> 时间：2009-06-02T15:04:30.853
> 
> 标签：c#, winforms, load, splash-screen

我即将开始开发一个大型应用程序（无论如何对我来说都很大：P），我想知道，我如何为该程序创建一个启动页面，该页面在 exe 启动后立即显示并在所有 exe 消失时消失加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:13:05.017

如果您使用的是 VB.NET，MS 会让这一切变得简单。但是，您仍然可以在 C# 中完成这项工作。看看[WindowsFormsApplicationBase](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.applicationservices.windowsformsapplicationbase.aspx)。

也看到[这个问题](https://stackoverflow.com/questions/48916/multi-threaded-splash-screen-in-c)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:19:08.203

如果您使用的是 WPF，那么只需将图像加载到项目中，右键单击 > 属性，然后选择启动画面。WPF 应该为你处理剩下的事情:)

# .net - 我可以将节点文本包装在 WinForms TreeView 中吗

> ID：940076
> 
> 赞同：3
> 
> 时间：2009-06-02T15:05:27.623
> 
> 标签：.net, winforms, treeview

ASP.NET TreeView 有一个 NodeWrap 属性，是否有在 WinForms TreeView 中完成同样事情的等效方法？

编辑：

感谢您对其他控件的建议，很遗憾我的客户不允许使用第三方控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:10:30.780

这似乎是不可能的。您可能会寻找具有更多功能的 3rd 方树视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-19T13:33:15.227

您可以使用面板将您的树视图放入其中，尽管它并不完全符合您的要求，但它有助于控制一致性和控制边界。

# apache-flex - MXML中的字典声明，可能吗？

> ID：940086
> 
> 赞同：0
> 
> 时间：2009-06-02T15:06:29.307
> 
> 标签：apache-flex, mxml

在 MXML 中，可以声明对象实例，甚至是动态对象，如下所示：

```
<mx:Object>
    <mx:foo>bar</mx:foo>
    <mx:bar>foo</mx:bar>
</mx:Object> 
```

是否可以在不使用某些 MXML 包装类的情况下对 Dictionary 类做同样的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T17:17:44.133

我不完全确定我理解这个问题，但如果你问是否可以在 MXML 中声明字典，是的，你可以；下面是一些演示在 MXML 中声明的 Dictionary 的代码，以及一个显示如何将项目动态添加到字典的表单：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical" xmlns:utils="flash.utils.*" creationComplete="onCreationComplete()">

    <mx:Script>
        <![CDATA[

            private function onCreationComplete():void
            {
                showContents();
            }

            private function onBtnClick():void
            {
                addProperty();
                showContents();
            } 

            private function showContents():void
            {
                txt.text = "";

                for (var k in d) 
                    txt.text += k + ": " + d[k] + "\n"
            }

            private function addProperty():void
            {
                d[pname.text] = pvalue.text;

                pname.text = ""; 
                pvalue.text = "";

                pname.setFocus();
            }

        ]]>
    </mx:Script>

    <mx:VBox>
        <mx:Label text="Dictionary Contents" />
        <mx:TextArea id="txt" width="350" height="200" />
        <mx:HBox>
            <mx:VBox>
                <mx:Label text="New Property Name" />
                <mx:TextInput id="pname" text="pets" />
            </mx:VBox>
            <mx:VBox>
                <mx:Label text="New Property Value" />
                <mx:TextInput id="pvalue" text="dog, cat, fish" />
            </mx:VBox>
        </mx:HBox>
        <mx:Button id="btn" label="Add" click="onBtnClick()" />
    </mx:VBox>

    <utils:Dictionary id="d">
        <utils:fname>Chris</utils:fname>
        <utils:lname>Nunciato</utils:lname>
    </utils:Dictionary>

</mx:Application> 
```

希望有帮助！如果我完全错过了重点，请回复，我会看看我是否可以提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-09T21:05:06.277

如果您导入正确的命名空间，这是可能的

```
 <mx:Application ... xmlns:utils="flash.utils.*">
        <utils:Dictionary>
            <utils:foo>bar</utils:foo>
            ...
        </utils:Dictionary>
        ... 
```

但我认为没有充分的理由这样做。Dictionary 相对于您通常使用的普通对象（或 <mx:Model>）的优势在于，您可以使用 String 以外的对象作为键。但是您不能在 MXML 中编写非字符串键。

换句话说：是的，您可以创建一个，但没有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:06:10.013

不，我不认为 Dictionary 绑定到 MXML。

你真的需要一本字典来完成你想要完成的事情吗？

# c++ - 使用 printf 打印 size_t 的正确方法是什么？

> ID：940087
> 
> 赞同：74
> 
> 时间：2009-06-02T15:07:14.343
> 
> 标签：c++, c

`Size_t`被定义为一个`unsigned`整数，但它的大小取决于你是在 32 位还是 64 位机器上。打印出的正确且便携的方法是`size_t`什么？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-06-02T15:11:27.003

尝试使用`%zu`格式字符串

```
size_t val = get_the_value();
printf("%zu",val); 
```

z 部分是一个长度说明符，表示参数的长度为 size_t。

来源 - [http://en.wikipedia.org/wiki/Printf#printf_format_placeholders](http://en.wikipedia.org/wiki/Printf#printf_format_placeholders)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-02T15:59:53.800

这上面有一个 C++ 标签，所以`cout <<`是另一个可能的答案。

这在所有版本的 C 中都很难做到。在 C90 中，强制转换`unsigned long`应该可以工作，但这在 C99 中可能不工作，C99 解决方案不一定在 C90 中工作。在 1995 年的更改中引入了可靠地区分 C90 和 C99 的能力（指定 的允许值`__STDC__`）。我不认为有一种完全可移植的方式适用于 C90、C99 和 C++，尽管有针对其中任何一个的解决方案。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-02T17:06:36.037

我认为 C++ 的答案是：

```
std::size_t n = 1;
std::cout << n; 
```

对于 C 风格的 IO，它有点复杂。在 C99 中，他们为值添加了`z`长度修饰符。`size_t`但是，在 TR1 之前，不支持此功能，因此您只能投射到特定大小，例如：

```
std::size_t n = 1;
std::printf("%lu\n", static_cast<unsigned long>(n)); 
```

再说一次，`unsigned long long`C++ 并不真正支持，所以上面的代码可以正常工作，因为`unsigned long`它是最大的合法整数类型。在 TR1 之后，您可以`%zu`安全地使用`size_t`值。

# python - 如何使用字典更新对象的成员？

> ID：940089
> 
> 赞同：11
> 
> 时间：2009-06-02T15:07:29.273
> 
> 标签：python, django

我正在编写一个执行各种功能的 Django 应用程序，包括通过 URL 将新记录插入或更新到数据库中。

例如，一些内部应用程序向 发送请求`/import/?a=1&b=2&c=3`。在视图中，我想创建一个新对象，`foo = Foo()`并将其成员`foo`设置为 request.GET 字典中的数据。

这是我现在正在做的事情：

1.  请求发送到`/import/?a=1&b=2&c=3`
2.  视图创建新对象：`foo = Foo()`
3.  对象随数据更新。

这是我到目前为止得到的：

```
foo.a = request['a']
foo.b = request['b']
foo.c = request['c'] 
```

显然，这是乏味且容易出错的。URL 中的数据与对象的成员具有完全相同的名称，因此它是一个简单的一对一映射。

理想情况下，我想做这样的事情：

```
foo = Foo()
foo.update(request.GET) 
```

或类似的东西。

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-02T15:09:14.667

您可以使用 setattr 函数动态设置属性：

```
for key,value in request.GET.items():
    setattr(foo, key, value) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-05T00:51:04.347

如果`request.GET`是字典并且`class Foo`不使用`__slots__`，那么这也应该有效：

```
# foo is a Foo instance
foo.__dict__.update(request.GET) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T15:13:08.340

你几乎明白了。

```
foo = Foo(**request.GET) 
```

应该做的伎俩。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T15:24:36.150

如果您使用它来创建一个模型对象，然后将其持久化，我强烈建议您使用[ModelForm](http://docs.djangoproject.com/en/1.0/topics/forms/modelforms/)。这将以 Django 的规范方式执行您所描述的操作，并添加验证。

扩展一下——我不是要把它用于表单输出，只是表单输入。如下：

```
class Foo(models.Model):
      a = models.CharField(max_length=255),
      b = models.PositiveIntegerField()

class FooForm(forms.ModelForm):
      class Meta:
          model = Foo

def insert_foo(request):
      form = FooForm(request.GET)
      if not form.is_valid():
          # Handle error conditions here
          pass
      else:
          form.save()

      return HttpResponse('Your response') 
```

然后，假设它绑定到 /import/，对 /import/?a=Test&b=1 的 GET 将插入一个带有 a = "Test" 和 b="1" 的新 Foo。

# c++ - 你开始使用 C++0x 了吗？

> ID：940100
> 
> 赞同：5
> 
> 时间：2009-06-02T15:09:14.213
> 
> 标签：c++, c++11

大多数编译器[已经支持 C++0x](https://stackoverflow.com/questions/657511/c-compiler-that-supports-c0x-features)。你是开始使用 C++0x 还是在等待 x 的定义？我必须对我的代码进行一些重构；我应该开始使用新功能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T15:19:50.963

C++0x 还不是一个完整的标准。在发布国际公认标准之前，可能会有很多修订。所以这一切都取决于，你写代码是为了什么？如果是为了工作任务，我会坚持使用常规的 C++，等待标准被设置，并给编程社区调整所需的时间。不要重构你真正需要实现的代码，它可能会给你带来很多麻烦。

然而，我认为 C++0x 非常适合使用，而且当 0x 被全球接受时，熟悉语法也无妨。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T16:27:26.997

从您提供的链接看来，您实际上是指[TR1](http://en.wikipedia.org/wiki/Technical_Report_1)，而不是真正的 C++0x。*是*的，我使用大部分新的 TR1 库已经有一段时间了，因为它们中的许多都是以前的[Boost](http://www.boost.org/)库。

我只能鼓励每个人也使用它们。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T16:18:47.730

我已经开始使用`nullptr`,`#define nullptr 0`用于那些还不支持它的编译器（即大多数）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T18:51:09.113

很少有编译器支持某些东西。实际上 VS 只支持 TR1 库，gcc 支持一些特性，如可变参数模板、右值、自动等等。英特尔编译器有一些。

我主要开始使用可变参数模板，例如：

```
#ifdef HAvE_VARIADIC
template<typename... Args>
void format(std::string,Args... args);
#else
template<typename T1>
void format(std::string,T1 p1);
template<typename T1,typename T2,>
void format(std::string,T1 p1,T2 p2);
...
template<typename T1,typename T2,...,typename T10>
void format(std::string,T1 p1,T2 p2,..., T10 p10);
#endif 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-02T15:14:57.977

我会推迟编写生产代码，直到 '0x+y，y 是他们从编译器中处理错误并将其纳入标准兼容性（无论标准可能是什么）。

但是为了发展？我用它来玩，写[项目 euler](http://projecteuler.net/)等等。我也用它来做演示和新闻组。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-19T06:06:19.573

我们经常使用 c++0x，现在当 gcc 支持某些功能时，我们将在它们可用时立即使用它们。原因很简单 - 使用 auto 关键字可以节省大量输入，使用右值引用可以获得性能提升，使用初始化列表和可变参数模板可以减少输入并提高代码的可读性。

实际上，c++0x 标准的主要目标也是我们的目标，因为我们将通过这些特性对我们的竞争对手有优势。这就是为什么我们不用等待就可以使用它们的原因。当然如果需要多平台兼容，这一步是不行的。万一你不在乎，立即使用它，你只能赢。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-07-01T14:31:08.503

是的，我已经在使用 C++0x 并发布开源库和代码。我未来所有的 C++ 开源项目都将使用这个变体编写。使用可变参数模板参数和 decltype/auto 后，我无法返回！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-02T16:25:48.917

We are still in the process of switching from VS6 to VS 2005\. We probably wont be using exclusively C++0x compilers for new work until late 201x.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-02T15:46:21.743

当 Visual Studio**完全**支持它时，我将开始使用它。目前 VS10 只支持一些功能。

# mysql - 操作“find_in_set”的排序规则（latin1_swedish_ci，COERCIBLE）和（utf8_general_ci，IMPLICIT）的非法混合

> ID：940107
> 
> 赞同：0
> 
> 时间：2009-06-02T15:09:40.423
> 
> 标签：mysql, collation

我收到以下错误：

> 操作“find_in_set”的排序规则（latin1_swedish_ci，COERCIBLE）和（utf8_general_ci，IMPLICIT）的非法混合

这是我试图执行的查询：

```
SELECT ID FROM xs_user_profiles WHERE ID='' AND FIND_IN_SET('1',site_structure); 
```

我查了这张表的属性，它有 charset utf8 和 collat​​ion utf8_general_ci。

这适用于我所有的网站，所以我不确定出了什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T15:15:26.637

如果您正在使用`mysqli`，请在连接后立即发出此命令：

```
$mysqli->set_charset("utf8"); 
```

这会将您的连接编码设置为`UTF8`（与您的表使用的相同）。

使用 plain `mysql`，使用这个：

```
mysql_query("SET NAMES utf8", $conn);
mysql_query("SET CHARACTER SET utf8", $conn); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:17:30.750

我猜你的字符串文字（'1'）由于不同的连接变量而处于不同的排序规则中。看[这里](http://dev.mysql.com/doc/refman/5.0/en/charset-literal.html)

# delphi - MS Word Ole 自动化、ADO 和外来字符

> ID：940113
> 
> 赞同：1
> 
> 时间：2009-06-02T15:10:49.220
> 
> 标签：delphi, ms-word, ado, ole, widestring

我正在尝试将 WideString 文本从数据库（ADO / MS Access）导出到 MS Word 文档（Delphi 7），但未正确传输外来字符（即“ **è** ”而不是“ **č** ”）：

```
while not ADOQuery1.Eof do
begin
  WordApplication1.Selection.TypeText(ADOQuery1Text.AsVariant); // TWideStringField
  WordApplication1.Selection.TypeParagraph;
  ADOQuery1.Next;
end; 
```

我也尝试过`CreateOleObject()`直接使用，但没有区别。

我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-05T21:51:49.420

I think it's not a problem with Word but rather with the way the strings are stored in the database. They are probably saved as Ansi strings, not as Unicode/WideString strings. And if that is true, then they are saved in some encoding which you must know if you want them to be decoded correctly.

Here is a sample application demonstrating how to convert Ansi string into WideString and save it in Word:

```
program Project1;
{$APPTYPE CONSOLE}
uses
  SysUtils,
  ComObj,
  ActiveX,
  CodecUtilsWin32;

procedure Test();
var
  wordApp, wordDoc: Variant;
  ansiStr: string;
  codec: TUnicodeCodec;

  function str2WideStr(const s: string): WideString;
  var
    i: Integer;
  begin
    codec.DecodeStr(@s[1], Length(s), Result);
  end;

begin
  codec := TEncodingRepository.CreateCodecByAlias('ISO-8859-2');

  ansiStr := #$BF#$F3#$B3#$E6; //"zólc"

  wordApp := CreateOleObject('Word.Application'); 
  wordDoc := wordApp.Documents.Add;
  wordApp.Selection.TypeText(str2WideStr(ansiStr));
  wordDoc.SaveAs('C:\sample.doc');
  wordDoc.Close();
  wordApp.Quit(False);
end;

begin
  CoInitialize(nil);
  Test();
end. 
```

The code above uses freeware unit CodecUtilsWin32.pas from [Utility Library v.2.0.18](http://www.philo.de/xml/downloads.shtml)

So I'd suggest using TStringField instead of TWideStringField and converting the strings to WideStrings as in the above example.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:23:49.197

Have you tried using

```
WordApplication1.Selection.TypeText(ADOQuery1Text.AsWideString); 
```

Short of that, I know that Delphi 2009 has better handling of Unicode (entire VCL now supports it directly) that would most likely correct your problem.

# javascript - setInterval/setTimeout 返回值

> ID：940120
> 
> 赞同：43
> 
> 时间：2009-06-02T15:11:37.127
> 
> 标签：javascript, settimeout, setinterval

两个问题：

1.  `setInterval`和`setTimeout`（用于清除计时器的）返回的值是如何计算的？

2.  这两个函数是否有可能在运行时返回相同的值？例如：

    `var a = setInterval(fn1, 1000);`
    `var b = setTimeout(fn2, 1000);`

`a`是否有可能`b`具有相同的价值？

第一个问题更多是我的知识问题，但第二个问题更重要。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-02T15:15:41.987

[返回一个可用于取消计时器的值。](http://msdn.microsoft.com/en-us/library/ms536749(VS.85).aspx)因此，它们似乎不太可能返回相同的值（除非它们正在重用值并且其中一个计时器已被取消）

[Mozilla 声明它是 DOM 级别 0，但不是规范的一部分。](https://developer.mozilla.org/En/Window.setInterval)（看页面底部）

我有一个更好的参考：

[纳布尔](http://www.nabble.com/Timers-td23406399.html)说：

> SetTimeout 和 setInterval 来自原始的 Javascript 规范，即 ECMA 之前的规范。该规范在任何地方都没有正式标准化，但所有 Web 浏览器和 Javascript 语言的大多数实现都支持它。（包括 ActionScript。）
> 
> ECMA 之前的规范通常被称为“DOM-0”API。由于它们以前从未被标准化，因此 HTML5 最终指定未弃用的 API 以尝试提供跨浏览器的一致环境是有意义的。尤其是当最近的事件证明，有些公司喜欢执行标准的字母，而不是精神。

[在此处](http://docs.sun.com/source/816-6408-10/)阅读原始规范，或来自[Sun](http://docs.sun.com/source/816-6408-10/window.htm#1203758)（他是 JavaScript 的早期支持者）。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-06-02T15:27:50.277

在 Opera 9、Safari 3、Firefox 3 和 IE 7 下进行了测试。

所有返回的整数值，从 1 开始，然后每次调用`setTimeOut()`and时递增 1 `setInterval()`。但是，我注意到浏览器启动了计数器并以不同的方式处理它们：

*   IE 以一个（看似）随机的 6 位数字开始，但随后对任一函数的调用都会增加该数字。关闭并重新打开 IE 后，我发现起始数字似乎是随机生成的，因为它与上一个会话的计数相去甚远。
*   Opera 为每个选项卡维护一个计数器 - 关闭一个选项卡并打开一个新选项卡从新选项卡中的 1 开始计数器。
*   在 Safari 中，计数是全局的——打开一个新选项卡并调用不同选项卡中的函数似乎会增加全局引用计数器。
*   在 Firefox 中，计数器似乎从 2 开始，并在每次后续调用任一函数时递增。与 Opera 一样，每个选项卡都有自己的计数器值，但它们似乎都从 2 开始。

但请注意，在所有场景中，没有两个标识符（至少在同一个选项卡中）是相同的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-02T15:14:17.213

我认为这不是一种标准化的行为。在 Firefox 中，它只是整数，在每次调用`setTimeout`or时递增`setInterval`。而且，不，它们不能具有相同的值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T15:13:55.233

从 Mozilla 网站：

> intervalID 是可以传递给 clearInterval() 的唯一间隔 ID。

所以它是独一无二的:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T15:24:40.203

它们是否可以具有相同的值取决于 JavaScript 实现。正如 Maciej 在 Firefox 中提到的，它们不能具有与使用相同计数器相同的值。但是，在其他浏览器中可能会有所不同，因此最好不要依赖它们永远不会具有相同的值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-05T16:52:27.067

在我看来，返回的值是它们所保留的任何内部维护的计时器/间隔列表的索引值。

如题，我调用了 clearInterval(18) 而不是 clearInterval(var_returned_from_set) 并停止了所需的计时器/间隔。（测试过FF17.0.1和IE9.0.8）

同样在我自己的测试中，它们在这两种浏览器的页面生命周期内似乎都是独一无二的。

# reporting-services - 如何在 SQL Reporting Services 中使用表达式来表示页眉高度？

> ID：940127
> 
> 赞同：1
> 
> 时间：2009-06-02T15:12:27.560
> 
> 标签：reporting-services

在 SQL Reporting Services 中，我想在第一页的页眉中显示报告参数，而不是其余页面。我可以通过使用表达式设置页眉中包含参数的框的可见性来做到这一点，但是，框所在的页眉中有一个空格。我想让页眉缩小到其内容并消除丢失框留下的空白。SSRS 不允许页眉高度的表达式。如何调整除第一页以外的所有页面的页眉高度？

见[第一页页眉](http://img155.imageshack.us/img155/3631/headertall.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T15:28:36.153

我发现矩形或标题不可能在 SSRS 中自动缩小。请参阅[https://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=383350](https://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=383350)

# python - 如何在 Python 中为包装的 C++ 函数传递指向数组的指针

> ID：940132
> 
> 赞同：4
> 
> 时间：2009-06-02T15:13:49.510
> 
> 标签：python, arrays, pointers, word-wrap, boost-python

我是 C++/Python 混合语言编程的新手，对 Python/C API 不太了解。我刚开始使用 Boost.Python 为 Python 包装一个 C++ 库。我坚持包装一个将指向数组的指针作为参数的函数。以下 (2nd ctor) 是它在 C++ 中的原型。

```
class AAF{
  AAF(AAF_TYPE t);
  AAF(double v0, const double * t1, const unsigned * t2, unsigned T);
  ~AAF();
} 
```

通过在 boost::python 中这样包装它，我做得对吗？

```
class_<AAF>("AAF", init<AAF_TYPE>())
  .def(init<double, const double*, const unsigned*, unsigned>()); 
```

请注意，它已成功编译和链接，但我不知道如何在 Python 中调用它。我的天真尝试如下失败。

```
>>> z = AAF(10, [4, 5.5, 10], [1, 1, 2], 3);

Traceback (most recent call last):
  File "./test_interval.py", line 40, in <module>
    z = AAF(10, [4, 5.5, 10], [1, 1, 2], 3);
Boost.Python.ArgumentError: Python argument types in
    AAF.__init__(AAF, int, list, list, int)
did not match C++ signature:
    __init__(_object*, AAF_TYPE)
    __init__(_object*, double, double const*, unsigned int const*, unsigned int)

>>> t1 = array.array('d', [4, 5.5, 10])
>>> t2 = array.array('I', [1, 1, 2])
>>> z = AAF(10, t1, t2, 3);

Traceback (most recent call last):
  File "./test_interval.py", line 40, in <module>
    z = AAF(10, t1, t2, 3);
Boost.Python.ArgumentError: Python argument types in
    AAF.__init__(AAF, int, array.array, array.array, int)
did not match C++ signature:
    __init__(_object*, AAF_TYPE)
    __init__(_object*, double, double const*, unsigned int const*, unsigned int) 
```

我的第二个问题是我还需要包装析构函数吗？请说明在某些情况下是否需要这样做，但并非总是如此。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T17:22:33.597

包装是正确的（原则上）但在

```
AAF(10, [4, 5.5, 10], [1, 1, 2], 3); 
```

（正如解释器指出的那样）你传递给你的函数 python 的列表对象，而不是指针。

简而言之，如果您的函数只需要在 python 的列表上工作，您需要更改代码以使用该接口（而不是使用指针）。如果您需要保留该接口，则必须编写一个包装函数，该函数从 python 中获取一个列表，进行适当的转换并调用您的原始 c++ 函数。这同样适用于 numpy 数组。

请注意 boost::python 提供了一些内置机制来将 python 容器转换为 stl 兼容容器。

您的案例的示例包装代码可能是

```
void f(list o) {
    std::size_t n = len(o);
    double* tmp = new double[n];
    for (int i = 0; i < n; i++) {
        tmp[i] = extract<double>(o[i]);
    }
    std::cout << std::endl;
    // use tmp
    delete tmp;
} 
```

请查看[http://www.boost.org/doc/libs/1_39_0/libs/python/doc/tutorial/doc/html/index.html](http://www.boost.org/doc/libs/1_39_0/libs/python/doc/tutorial/doc/html/index.html)上的 boost.python 教程。

# ruby-on-rails - 如何在每次测试之前重建 Rails 测试数据库？

> ID：940136
> 
> 赞同：7
> 
> 时间：2009-06-02T15:14:18.493
> 
> 标签：ruby-on-rails, unit-testing, testing

我目前正在开始从固定装置迁移到工厂并遇到一些测试数据库挑战。

当我运行我的整个测试套件时，数据库被清除并重新加载新的工厂生成的数据。但是，当我运行单个单元测试时，数据库不会清除旧值。

我可以在每个单独的测试之前运行 rake db:test:prepare，但这会减慢我的开发速度。

这是我的测试设置：

```
 self.use_transactional_fixtures = false
  self.use_instantiated_fixtures  = true 
```

例如：

```
require File.dirname(__FILE__) + '/../test_helper'
class LocationTest < ActiveSupport::TestCase
  test "should require name to save" do
    location = Factory.create(:location)
  end
end 
```

将成功运行一次，但在测试文件的后续运行中失败。这以前从未发生过，因为每次运行都会加载测试装置。

我添加了工厂排序，但在每次运行期间只对属性进行排序：

```
 Factory.define :location do |l|
    l.sequence(:name) {|n| "place#{n}"}
    l.street  '123 N Pitt Street'
    l.state_id 4
    l.city 'San Francisco'
    l.location_type_id LocationType::COMMON
    l.shipper_id 1
    l.zip 23658
  end 
```

结果是：

```
trunk>ruby test\unit\location_test.rb
Loaded suite test/unit/location_test
Started
.
Finished in 0.162 seconds.

1 tests, 0 assertions, 0 failures, 0 errors

>ruby test\unit\location_test.rb
Loaded suite test/unit/location_test
Started
E
Finished in 0.134 seconds.

  1) Error:
test_should_require_name_to_save(LocationTest):
ActiveRecord::RecordInvalid: Validation failed: Name has already been taken
    c:/ruby/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.1/lib/factory_girl/proxy/create.rb:5:in `result'
    c:/ruby/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.1/lib/factory_girl/factory.rb:293:in `run'
    c:/ruby/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.1/lib/factory_girl/factory.rb:237:in `create'
    test/unit/location_test.rb:18:in `test_should_require_name_to_save'

1 tests, 0 assertions, 0 failures, 1 errors 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:35:13.757

首先检查您的测试设置以确保它们是您想要的，尽管我怀疑您可能有理由禁止在事务中运行测试的标准做法（退出时回滚）。

其他选项是（1）手动使用事务进行上述测试（其中还没有事务），加上（2）添加`teardown`手动清理相关表的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:24:36.990

您可以在单元测试中覆盖该`setup`方法，以便它删除您要清除的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-02T17:36:32.567

由于每个测试*都应该从一个干净的数据库开始，因此请尝试将代码库中的内容放到**可以*为每个测试使用事务的地步。因此，您的测试质量将大大提高。

此外，这与您的问题没有直接关系......但在任何情况下都不要使用 Rails 固定装置。改用工厂（查看 factory_girl_rails gem）。另外，请查看 RSpec 而不是 Test::Unit。

# mirth - 欢乐：在同一通道中的目的地之间共享 SOAP 响应

> ID：940138
> 
> 赞同：1
> 
> 时间：2009-06-02T15:14:23.517
> 
> 标签：mirth

考虑一个 Mirth 频道有一个或多个目的地的场景。在这种情况下，有 4 个目的地。

通道的 Source Type 是 LLP Listener，传入数据类型为 HL7 v2.x。

该频道的目的地如下：

1.  文件写入器 - 将消息写入磁盘。实际上，这只是出于开发目的。
2.  Javascript Writer - 将消息写入数据库。获取主键。将该键放在 ChannelMap 上以供将来的目的地使用。
3.  SOAP Sender - 调用 Web 服务并接收响应。通话流畅。
4.  Javascript Writer - 从上面的 SOAP Sender 获取响应，并将其写入数据库，将答案与来自第一个目标的主键相关联。

一项挑战是从 SOAP Sender Destination 获取 SOAP 响应，并将其保存在某个位置以供第四个目标使用。SOAP Sender 允许您将 SOAP 响应发送到另一个**通道**，但我需要在下一个目标中使用它。我必须能够在同一个频道中接收它。

问题：如何将来自第三个目的地的 XML SOAP 结果保存/发送到第四个目的地？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:35:00.217

我假设你的频道是同步的

假设您的第 3 步 SOAP 发送者目的地称为 SOAPDestination，那么在第 4 步中，您可以这样做：

> var 目的地 = responseMap.get('SOAPDestination');
> 
> var responseMessage = destination.getMessage();
> 
> // 打开数据库连接
> 
> // 将 responseMessage 与您在第 2 步中存储的主键一起写入
> 
> //关闭数据库连接

# java - 操作不同的数组（对象数组）索引时是否需要同步

> ID：940139
> 
> 赞同：2
> 
> 时间：2009-06-02T15:14:36.980
> 
> 标签：java, arrays, synchronization

在Java的上下文中，我有这样的代码，

```
MyObject[] array; 
```

在不同的线程中我有这样的代码

```
array[i] = new MyObject(val); 
```

如果我确保我的每个线程都使用不同的“ `i`”值，那么我是否需要同步上述语句以处理竞争条件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T15:17:47.707

只有当两个线程可以同时读取和修改同一个变量时，竞争条件才是一个问题。

只要您确定每个线程使用不同范围的索引，并且没有重新定义底层数组，那么将每个单元格视为不同的变量应该是安全的。因此，每个线程都在一组单独的变量上工作，您不会得到竞争条件。

话虽如此，请确保您在使用索引时确实没有重叠 - 这通常比看起来更棘手。

此外，您必须确保没有两个单元格映射到对象中 - 如果您从两个线程修改同一个对象（而不仅仅是对它的引用），您可能会得到竞争条件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T15:20:11.197

也许。如果每个任务都写入数组中的不同位置，它们不会覆盖彼此的输出。所以这行得通。

但是，在最终处理数组时，您可能会遇到问题，因为 Java 不保证何时将值写入内存。优化器可能决定写的太晚了（或者对你来说太晚了）。因此，您应该创建数组`volatile`，这意味着在访问其中的值时必须不进行缓存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T15:35:50.340

如果您绝对确定每个线程将始终访问不同的索引，那么您不需要同步这些访问。

但是您确实需要确保对数组的***引用*正确地发布**到不同的线程——在实践中，这通常意味着引用需要是[final](http://www.javamex.com/tutorials/synchronization_final.shtml)或[volatile](http://www.javamex.com/tutorials/synchronization_volatile.shtml)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T09:34:41.857

这里有*三个*与同步有关的谨慎的兴趣点。

**数组变量本身：**将变量声明`array`为`volatile`or `final`（或同步 on `array`）很重要，这样可以保证两个线程都访问同一个实例化数组。如果没有，以下是可能的：

1.  线程 A 和 B 启动
2.  Thread A 实例`array`作为新的 Array 对象
3.  线程 B 尝试访问线程 A `array`，但得到一个 NullPointerExceptoin，因为它还没有看到线程 A 对新数组的分配`array`。

不好。

**对 MyObject 实例的数组引用**（以及似乎是 Venkatraman 的实际问题）：随着`array`变量本身正确同步，那么*是的，两个线程可以安全地访问数组中的不同元素。* 一旦子线程完成了它正在做的任何事情，那么“主”线程将想要同步数组以确保它在使用它们之前获得子数组元素的最终状态。

**MyObject 实例本身**，但这似乎超出了问题的范围

# java - 如何使用 jruby（使用码头运行）创建 servlet？

> ID：940143
> 
> 赞同：1
> 
> 时间：2009-06-02T15:14:54.763
> 
> 标签：java, servlets, jetty, jruby

我对 jruby 和 java 还很陌生，想在 jruby 中创建一个 servlet，同时使用 jetty 作为 Web 服务器。我不确定我是否走在正确的道路上，下面的代码显示了到目前为止的输入表单。我想我现在必须扩展 HttpServlet 类来处理发布的数据，但我不知道在这种情况下如何执行此操作，以及是否可以在同一个脚本中执行此操作。

```
require 'java'

Dir["./jetty-6.1.18/lib/*jar"].each { |jar| require jar }
Dir["./Java/lib/jsdk2.1/javax/*jar"].each { |jar| require jar }

include_class 'javax.servlet.ServletException'
include_class 'javax.servlet.http.HttpServlet'
include_class 'javax.servlet.http.HttpServletRequest'
include_class 'javax.servlet.http.HttpServletResponse'

include_class 'org.mortbay.jetty.Server'
include_class 'org.mortbay.jetty.handler.AbstractHandler'
include_class 'org.mortbay.jetty.servlet.Context'
include_class 'org.mortbay.jetty.servlet.ServletHolder'

def main
  handler = Handler.new
  server = Server.new(8080)
  server.setHandler(handler)
  server.start()
end

class Handler < AbstractHandler
  def handle(target, request, response, dispatch)
    response.setContentType("text/html")
    response.setStatus(HttpServletResponse::SC_OK)
    response.getWriter().print('                                                          
       <form action="RequestProcessing" method="post" enctype="multipart/form-data">              
       <p>Select a file:<br>                                                       
       <input name="file" type="file" size="20" maxlength="1000" accept="text/*">   
       </p>                                                                               
       <input type="submit" value=" Send"/>                                               
       </form>')
    request.setHandled(true)
  end
end

class RequestProcessing < HttpServlet
  # So what do we do here?
end

main 
```

我会感谢任何提示。提前谢谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T15:14:21.250

我得到了一些外部帮助，可以提出适当的解决方案。为了提供完整但简单的设置，我使用 html 文件作为数据输入（但这可以在码头完成，如上所述）。

```
<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Data input</title>
</head>
<body>
<form action="http://localhost:8080/" method="post">
  <textarea name="input" cols="4" rows="20"></textarea>
  </p>
  <input type="submit" value=" Send"/>
</form>
</body>
</html> 
```

jruby 部分非常简单；）：

```
require 'java'

Dir["./Java/jetty-6.1.18/lib/*.jar"].each { |jar| require jar }
Dir["./Java/lib/jsdk2.1/javax/*.jar"].each { |jar| require jar }

include_class 'javax.servlet.http.HttpServlet'
include_class 'org.mortbay.jetty.Server'
include_class 'org.mortbay.jetty.servlet.Context'
include_class 'org.mortbay.jetty.servlet.ServletHolder'

def main
  server = Server.new(8080)
  context = Context.new(server, '/', 0)
  servlet = TestServlet.new()
  holder = ServletHolder.new(servlet)
  context.addServlet(holder, '/')
  server.start()
end

class TestServlet < HttpServlet

  def doPost(request, response)
    input = request.getParameter('input')
    response.writer.println("
    <html>
     <head><title>Output</title></head>
     <body>
     Raw input: <pre>#{input}</pre> 
     </body>
    </html>")
    request.handled = true
  end

end

main 
```

要收集通过 GET 发送的数据，只需以类似方式定义 doGet。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:24:38.917

我猜您正在使用[Embedding Jetty](http://docs.codehaus.org/display/JETTY/Embedding+Jetty)文档（因为您已经开始使用处理程序）。

我会（相反）进一步检查该文档并遵循**快速入门 - Servlets**部分。派生您自己的 servlet`HttpServlet`并实现这些`doGet()/doPost()`方法。您将希望像在上面的示例中所做的那样返回表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T00:40:40.487

我知道这并不是您问题的真正答案，但是在 (J)Ruby-land 中，我们倾向于使用 mongrel 或 webrick 而不是 jetty。

[http://mongrel.rubyforge.org/web/mongrel/files/README.html](http://mongrel.rubyforge.org/web/mongrel/files/README.html)

[http://www.webrick.org/](http://www.webrick.org/)

# python - 分发 Ruby/Python 桌面应用程序

> ID：940149
> 
> 赞同：10
> 
> 时间：2009-06-02T15:15:46.277
> 
> 标签：python, ruby, user-interface, desktop, software-distribution

除了 Shoes 之外，还有什么方法可以开发和分发用 Ruby 编写的跨平台 GUI 桌面应用程序？

我开始相信 _why 应用程序的一般错误在鞋子的情况下异常严重，任何比两个按钮表单更复杂的东西都很难维护。

RubyGTK、wxRuby 等似乎很有希望，但它们并没有解决以不需要在用户计算机上预安装 Ruby 的方式分发应用程序的问题——而且像 ruby​​2exe 这样的库似乎非常过时——日期和不完整。

一般来说——当前的时尚是什么？

顺便说一句：如果在 Python 中有一个非常简单的解决方案，我可能会考虑重做我在 Python 中要做的事情。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T15:31:46.663

我不知道 ruby​​2exe，但 py2exe 工作得很好。即使有像 wxWidgets 这样的库。**编辑**：您甚至不必要求用户安装 wxWidgets，它与应用程序捆绑在一起（py2app 也是如此）

[我在这里](http://github.com/loicwolff/notagapp/)将它用于我非常小的项目。

对于 Mac 人群，py2app 也适用于 wxWidgets。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-02T19:48:28.720

对于 Ruby，[One-Click Ruby Application Builder](http://rubyforge.org/projects/ocra/) (OCRA) 正在成为[RubyScript2Exe](http://www.erikveen.dds.nl/rubyscript2exe/)的继任者。

Ocra 可与 Ruby 1.8.6 和 1.9.1 以及 wxRuby 一起使用。支持相对紧凑的可执行文件的 LZMA 压缩。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-02T15:37:18.437

我不了解 Ruby，但 Python 的标准是[py2exe](http://www.py2exe.org/)来创建 Windows 二进制文件。对我来说，跨平台的[pyinstaller](http://www.pyinstaller.org/)曾经运行良好。对于您的 GUI，[TkInter](http://wiki.python.org/moin/TkInter)是标准。很多人喜欢[wxPython](http://www.wxpython.org/)。所有这些都得到了相当积极的发展。我建议尝试使用这些选项来决定 Python 是否是更好的选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T15:26:15.567

情况相当糟糕。目前最可靠的方法大概就是使用JRuby了。我知道这可能不是您想听到的答案，但是，正如您所说，ruby2exe 是不可靠的，而且 Shoes 还很遥远（甚至不打算成为一个完整的应用程序）。就个人而言，我不喜欢强迫用户安装 GTK 或 Qt 或 wxWidgets，但 JVM 相当普遍。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T16:30:05.280

取决于你的发展程度，[鞋子](http://shoesrb.com/)是相当不错的。它基本上是它自己的 Ruby 发行版。它可能有点隐藏（在文件菜单中），但它允许您为所有 3 个平台打包您的应用程序，而无需该鞋启动屏幕。

它背后的渲染引擎是 Cairo。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-10T14:50:17.077

我认为没有人真正回答他的问题。

至于我，我使用 VB 对 Ocra 编译的 Ruby 脚本进行 Shell() 调用。它工作得很好，让我可以创建在所有现代操作系统中运行的应用程序。

Linux 测试是通过使用 Wine 运行并确保我使用预 .NET 版本的 VB 进行 .exe 编译来完成的。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-06-03T01:32:42.987

我读过（但没用过）Seattlerb 的 Wilson，它把自己描述为一个纯 x86 汇编程序，但听起来不像是跨平台或 GUI。

# asp.net - ASP.Net 网站安装程序参考

> ID：940154
> 
> 赞同：0
> 
> 时间：2009-06-02T15:16:46.383
> 
> 标签：asp.net, installation, windows-installer, dependencies, web-site-project

默认情况下，我的网站 - 属性页 - 参考选项卡中的所有 dll 是否都复制到了 .msi istaller 中以用于网站项目类型？引用似乎没有任何选项，因为它们在 Web 应用程序或桌面应用程序项目类型（例如复制本地等）中。我的安装程序包括来自我的网站项目的内容文件，并且我在解决方案中作为项目引用的任何类库都显示在输出列表中。但是，我手动添加为引用的任何系统或第 3 方 dll 都不会显示在此列表中。它们会被编译到安装程序中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:18:47.360

您可以添加 Web 设置部署项目。这将检查依赖项，您可以选择将它们添加到 .MSI 安装程序。

**编辑**顺便说一句，这是在 MVC 项目上。我必须说我不确定网站项目是否属于这种情况，我经常使用 XCopy 部署那些

# winapi - 带有 WH_MOUSE 的 SetWindowsHookEx 未捕获 HTCAPTION 区域上的鼠标移动

> ID：940156
> 
> 赞同：0
> 
> 时间：2009-06-02T15:17:03.480
> 
> 标签：winapi, hook

我尝试使用 SetWindowsHookEx 和 WH_MOUSE 来捕获鼠标移动事件。它可以在任何地方工作，但在 HTCAPTION 区域（至少在我的代码示例中）。我找不到对这种行为的任何引用，我试图将 windbg 放入另一个应用程序，该应用程序执行相同的操作来监视鼠标移动。使用的方法也是 WH_MOUSE，即使鼠标在标题区域上也会生成事件。因此，它应该工作，但它没有。

有任何想法吗 ？

编辑：我正在使用它来挂钩所有进程。我构建了一个单独的 dll，将消息转发到我的应用程序中的某个内部窗口。我使用 dwThreadId = 0。我也没有在标题区域单击鼠标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-15T15:53:09.313

我想到了 ：

MouseHookProc 给 SetWindowsHookEx 的 mouseproc 接收鼠标的所有事件，这意味着我必须测试 wParam 是否等于 WM_MOUSE 或**WM_NCMOUSEMOVE**。当光标在客户区域上时 WM_MOUSE 被接收，当它在非客户区域上时 WM_NCMOUSEMOVE 被触发（就像在普通消息 proc 中一样）。

```
LRESULT CALLBACK MouseHookProc(int nCode, WORD wParam, DWORD lParam)
{
    if(nCode>=0 && (wParam==WM_MOUSEMOVE || wParam==WM_NCMOUSEMOVE))
    {
        if(!hwnd)
            hwnd=FindWindow(0, "MyWindow");

        MSLLHOOKSTRUCT *mhs=(MSLLHOOKSTRUCT*)lParam;        
        PostMessage(hwnd, WM_MOUSEHOOK, wParam, 0);
    }
    return CallNextHookEx(hHook,nCode,wParam,lParam);
} 
```

我认为 WM_MOUSE 是某种对应的值，但不是真正的鼠标消息，但确实如此。

# xml - Firefox 3 和 XML/XSLT

> ID：940157
> 
> 赞同：1
> 
> 时间：2009-06-02T15:17:13.090
> 
> 标签：xml, xslt, firefox-3

Firefox 3 和 XML/XSLT

我对在 Firefox 中使用客户端处理开发 Web 应用程序比较陌生。关于在 Firefox 中使用 XML/XSLT，我有几个直截了当的问题。我将带有 XSLT 引用的初始 XML 文档发送到浏览器。浏览器使用引用的 XSLT 样式表成功地将 XML 转换为 XHTML。

这适用于 Internet Explorer 6+ 和 Firefox 3+。现在我必须在 JavaScript 中更改 XML 文档和 XSLT 样式表，然后将 XML 重新转换为 HTML。我不打算创建 XML 文档或从 ​​AJAX HTTPRequest 获取文档。我只关心发送到浏览器的原始 XML 文档。

使用 IE，这一点很清楚。在 Firefox 中，我遇到困难可能是由于缺乏文档。要在 JavaScript 中执行新的转换，您需要两个对象和一个操作：

对象/操作 --> 在 Internet Explorer 6+ JavaScript 中

发送到浏览器的初始 XML 文档-->document.XMLdocument

通过 xml-stylesheet --> document.XSLdocument 在 XML 中引用的初始 XSLT 文档

使用 XSLT 转换 XML 以获得新的 HTML 输出 -->
document.XMLdocument.documentElement.transformNode(document.XSLdocument)

我正在寻找的是等同于 Firefox 3 DOM 中的这 3 个概念。我在网络上进行了相当详尽的搜索，并想出了一些方法来进行 XML 操作，但不是最初的 XML 和 XSL 文档。

谁能指出我正确的方向？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-22T16:39:45.720

[Emle - 电子数学实验室设备](http://emle.sourceforge.net/emle020405/emle_index.html)Javascript 文件[emle_lab.js](http://emle.sourceforge.net/emle020405/emle_lab.js)使用 parseFromString() 从字符串创建文档：

```
 var inputText = '<?xml version="1.0" encoding="UTF-8"?>' +
    '<emle xmlns="http://emle.sf.net/emle02">' +
    '  <lab refid="' + aLabId + '"></lab>' +
    '</emle>';
  var inputDoc = new DOMParser().parseFromString(inputText, "application/xml"); 
  var xsltDoc = emleHttpGetXML('emle_lab.xsl'); 
  var processor = new XSLTProcessor();
  processor.setParameter(null, 'emleLang',  aLang);
  processor.importStylesheet(xsltDoc);
  var outputDoc = processor.transformToDocument(inputDoc.firstChild); 
```

# sharepoint - SharePoint Web 部件内容消失

> ID：940158
> 
> 赞同：1
> 
> 时间：2009-06-02T15:17:28.177
> 
> 标签：sharepoint, web-parts, content-editor

我一直在使用 MS Word 2007 创建网页并在其中创建超链接。然后我将它们变成网页文档。然后，我在 SharePoint 上专门为该页面创建了一个图片库，并使用 DreamWeaver 2004 将图片库中的图片链接到网页源代码中。然后，我创建了一个内容编辑器 Web 部件，并使用源代码编辑器使用 Dreamwever 中的代码。在扩展像素高度和宽度以适应我应用和发布的文件之后。它一直像梦一样工作，给了我精彩的页面。但是现在我已经两次进入页面，发现 Web 部件的内容是空白的！在所有页面上！我尝试查看发生了什么，所以我编辑了页面，但是当我专门去修改 Web 部件时，页面会跳转并且不会让我单击“编辑”。然而，我可以 单击它旁边的“x”并完全删除 Web 部件。查看页面并查看源代码时，我可以看到我的原始代码在那里，所以它就像隐藏而不是消失一样。左下角出现的错误消息显示“'MSOMenu_WebPartMenu' 未定义”。这让我工作中的每个人都感到困惑，包括 ICT 领域的人。任何人都可以为我阐明这一点并提供帮助吗？我在谷歌上看到的一切似乎都是一样的。这让我工作中的每个人都感到困惑，包括 ICT 领域的人。任何人都可以为我阐明这一点并提供帮助吗？我在谷歌上看到的一切似乎都是一样的。这让我工作中的每个人都感到困惑，包括 ICT 领域的人。任何人都可以为我阐明这一点并提供帮助吗？我在谷歌上看到的一切似乎都是一样的。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T18:25:22.847

你最近有没有改变布局？这似乎有点像这里描述的问题：http: [//blog.mastykarz.nl/css-causes-javascript-error-while-moving-web-parts-in-edit-mode/](http://blog.mastykarz.nl/css-causes-javascript-error-while-moving-web-parts-in-edit-mode/)（Web 部件变空白除外）。

# c# - IList 实现分为三类：只读、固定大小、可变大小

> ID：940165
> 
> 赞同：1
> 
> 时间：2009-06-02T15:18:01.200
> 
> 标签：c#, generics, list

这是什么意思？我`IList<T>`从业务层返回一个，然后从 UI 添加项目，但应用程序抱怨它是一个固定大小的列表。我该如何克服这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-27T04:28:51.763

你能创建一个新列表吗？IE：

```
List<myObject> foo = new List<myObject>(someClass.getReadOnlyList(...)) 
```

如果您必须将列表*返回*到业务逻辑，请检查以确保没有其他`add()`功能（`insert`、`add`、`append`、`prepend`等）。有些类不允许您直接修改它们的内部集合，因为它们更喜欢先进行一些完整性检查，或者对可能不应该向消费者公开的新数据执行一些其他类型的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:22:09.087

据我所知，您无法以编程方式告诉您是否能够添加到可写列表中。另一方面，最常见的例子可能是`Array`- 所以你总是可以尝试：

```
if (list is Array)
{
    // Copy to another list or whatever
} 
```

看起来技术含量低，我只是在业务层中指出您将返回的列表的属性 - 它是否可写等等。或者只是*假设*它不会是可写的，并且无论如何在 UI 中创建一个新列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T17:59:37.793

如果您可以控制您的业务逻辑（例如，它不是代码生成的），那么最简单的解决方案可能是确保您使用的是非`IList<T>`固定大小的实现（例如 a `List<T>`）。

# regex - 构建用于搜索和编辑的正则表达式

> ID：940168
> 
> 赞同：1
> 
> 时间：2009-06-02T15:18:37.517
> 
> 标签：regex, perl, replace

我正在尝试构建一个正则表达式来搜索和替换文件。以下是脚本。

```
#!use/bin/perl 
use strict; 
use warnings; 
my $line = $ARGV[0]; 
my $find = "[^a-zA-Z0-9]+seqfile[^a-zA-Z0-9]+=[^a-zA-Z0-9]+[a-z]+.."; 
my $replace = "done"; open (FILE, ">>/home/user/Desktop/test") || die "cant open file \n"; 
my @body = <FILE>; 
foreach $line (@body) { 
if (my $line =~ s/$find/$replace/g){ 
print FILE $line;
} 
else { 
print "did not replace \n\n"; 
} 
} 
close(FILE); 
print "reached here\n"; 
exit; 
```

我正在运行以测试我的程序的示例测试文件包含几行文本。我要替换的字符串出现在第一行，**即“tobereplaced = file.aa”**。我不得不对字母/数字以外的字符使用胡萝卜 (^)，因为我的系统不接受空格“\s”的正则表达式。我知道该程序已执行，因为它打印“到达这里”。任何人都可以建议

1.  为什么我的程序无法使用我指定的正则表达式搜索字符串。
2.  为什么我的系统无法识别 '\s' 并给出错误“无法识别的转义 \s 在测试中通过”
3.  而且，任何人都可以建议一些学习正则表达式的好资源。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T15:27:07.047

`\s`不被接受，因为您使用的是双引号字符串。双引号字符串试图理解`\s`并且不知道如何处理它，您可以说出以下任何内容来使其工作：

*   `"\\s+seqfile\\s+=\\s+[a-z]+.."`
*   `'\s+seqfile\s+=\s+[a-z]+..'`
*   `qr/\s+seqfile\s+=\s+[a-z]+../`

最后一种是首选形式，因为它创建的编译正则表达式比普通字符串要快。如果您在不期望正则表达式的上下文中使用已编译的正则表达式，它会被字符串化，所以您可以说

```
print "$find\n"; 
```

然后回来`(?-xism:\s+seqfile\s+=\s+[a-z]+..)`。

此外，如果您要否定字符类，则必须将插入符号放在字符类中：`[^a-zA-Z0-9]`表示不是字母数字（至少对于 ASCII），但`^[a-zA-Z0-9]`表示匹配字符串开头的字母数字（或者如果该`/m`选项已设置）。

此外，当文件以`>>`模式打开时，您无法从中读取。我已将您的代码更改为从 STDIN（或命令行上的文件）读取并写入 STDOUT。这是一种称为过滤的标准 Perl 技术。它允许您构建程序的管道。您可以像这样运行脚本

```
./script.pl inputfile > outputfile 
```

或这个

```
cat inputfile | ./script.pl > outputfile 
```

这是脚本

```
#!use/bin/perl 

use strict; 
use warnings; 

my $find    = qr{ \s+ seqfile \s+ = \s+ [a-z]+ .. }x; 
my $replace = "done";

while (<>) {
    s/$find/$replace/g;
    print;
} 
```

它也可以归结为单行：

```
perl -pe 's/\s+seqfile\s+=\s+[a-z]+../done/g' inputfile 
```

研究正则表达式的好来源是：

*   [`perldoc perlretut`](http://perldoc.perl.org/perlretut.html)
*   [`perldoc prelrequick`](http://perldoc.perl.org/perlrequick.html)
*   [`perldoc prelreref`](http://perldoc.perl.org/perlreref.html)
*   [`perldoc prelre`](http://perldoc.perl.org/perlre.html)
*   [正则表达式.info](http://www.regular-expressions.info/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:30:00.990

您以附加模式打开了一个文件，然后尝试读取和写入它。可以同时读取和写入文件，但您需要使用不同的模式。但是，除非您想替换完全相同数量的字符，否则您将不得不从一个文件中读取并将所有内容（更改和未更改的部分）写入第二个文件。

# asp.net - 用于密码的 Html 输入控件 - 不显示输入的字符或显示空格而不是点

> ID：940174
> 
> 赞同：0
> 
> 时间：2009-06-02T15:19:49.060
> 
> 标签：asp.net, html, security, input, passwords

是否可以在 html input type="password" 中使用密码元素，在这种模式下，人们不会将字符类型显示为星号/圆圈，而是显示为空格/无，因此没有人会知道密码的长度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T15:21:51.177

你能让文字颜色和背景一样吗？（自己没试过……）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:21:53.767

理论上：

```
some-selector {
  background-color: white;
  color: white;
} 
```

`input[type=password]`如果您不关心不支持属性选择器的浏览器（即旧版本的 IE），则选择器可能是

# javascript - 使用 prevent default 接管空格键

> ID：940180
> 
> 赞同：4
> 
> 时间：2009-06-02T15:20:35.843
> 
> 标签：javascript, jquery

我有一些这样的代码来接管空格键的功能：

```
 $(document).keypress(function (e) { 
        e.preventDefault();                            
        if (e.which == 32) {
            // func
        }
    }); 
```

不幸的是，这会破坏所有密钥的默认值。

这：

```
 $(document).keypress(function (e) { 
        if (e.which == 32) {
            e.preventDefault();
            // func
        }
    }); 
```

不幸的是无效。

我怎样才能使它阻止只有空格键的默认值？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T15:30:16.200

试试这个：

```
//e= e || window.event); you may need this statement to make sure IE doesn't keep the orginal event in motion
var code;  
if (e.keyCode) {
 code = e.keyCode;
} else if (e.which) {
 code = e.which;
 }
if (code == 32) {
 if (e.stopPropagation) {
 e.stopPropagation();
 e.preventDefault();
 }
 return false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-27T13:07:16.750

对于上面的一些事情，比如使用 $ 可能会有点混乱。所以我用javascript代码发布我的答案。将此添加到任何文件中以阻止空格键（或者您也可以添加其他操作）。

```
window.onkeydown = function (event) {
    if (event.keyCode === 32) {
        event.preventDefault();
    }
}; 
```

键码 32 是空格键。对于其他键码，请查看此站点：

[http://www.javascripter.net/faq/keycodes.htm](http://www.javascripter.net/faq/keycodes.htm)

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T15:34:09.797

尝试

```
$(document).keydown(function(e){<br>
    if(e.which==32) e.preventDefault();<br>
}); 
```

我用它来阻止 Esc 键，对我来说效果很好。

# sql-server - 当列名是变量时，从 INSERT 动态查找触发器中的列值

> ID：940189
> 
> 赞同：2
> 
> 时间：2009-06-02T15:22:19.443
> 
> 标签：sql-server, sql-server-2008, triggers, dynamic-sql

我有一个触发器，可以插入和更新视图。我需要找到正在修改的列并将值放入正确的表中。

```
INSERT INTO TempTableAttr_Lot(ID, [% Num]) VALUES(3, 24.0) 
```

我试图弄清楚如何在我的触发器中获取 ID 和 [% Num] 列的值。问题是在插入或更新中可以设置 32 个不同的列，所以我想循环查看该列是否在“插入”表中。

一个问题是，如果我使用 exec 或 execute 来构建动态查询，则 insert 不在此范围内。

该视图是动态的，因为如果添加了属性，则该视图将由存储过程重新生成，因此我不能假设在任何给定时间视图中有哪些列名，它可以增长和缩小。

理想情况下我想做`SET @Value = (SELECT i.[@Name] FROM inserted i)`但是@Name不是列名，而是触发器中的一个变量，所以当我尝试

```
DECLARE @ValueTable TABLE ( value sql_variant)
INSERT INTO @ValueTable EXECUTE('SELECT i.[' + @Name + '] FROM inserted i')
SET @Value = CONVERT(nvarchar(128), (SELECT DISTINCT * FROM @ValueTable)) 
```

这不起作用，因为插入的似乎不在范围内。

对于第一个循环 @Name = 'ID' 和第二个循环将是 'Col2' 没有插入，所以 @Value 的值应该为空，我继续循环遍历可能的列名，直到我完成，并且触发器被处理。

我称它为触发器，它被定义为：

```
CREATE TRIGGER TempTableAttr_LotTrigger 
ON  TempTableAttr_Lot 
INSTEAD OF UPDATE, INSERT 
```

我目前正在使用 INSERT 命令进行测试。我意识到在进行更新时我可能需要查看“已删除”表。

更新：我假设目前只插入一行，用于我的测试，看看如何让它工作。这是一个实体-属性-值数据库，但我有一个使它看起来有关系的视图。使用集成服务时，更新正在进行时，对视图的任何插入或更新都会调用触发器。我只是想了解如何获取我需要的信息，以便我可以使用正确的值更新正确的表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T15:33:22.137

要访问 INSERTED 表，您可以执行以下操作。

```
SELECT * INTO #MYINSERTED FROM INSERTED

EXEC('SELECT * FROM #MYINSERTED')

DROP TABLE #MYINSERTED 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T12:14:07.067

```
CREATE TRIGGER  triggerRowLog_tblMember 
--After INSERT  
ON dbo.tblMember
 AFTER UPDATE
--for EACH ROW
As
BEGIN

DECLARE @temptblCategory TABLE ( 
        idx smallint Primary Key IDENTITY(1,1)
        , CategoryID int
        , CategoryName nvarchar(100)
    )
    declare @i int
    set @i = 1
    declare @catcount int 
    set @catcount = 0
    Select @catcount=  Count(*) from tblCategoryMst Where Tag = 'A' or Tag = 'L'  and Active =1
    declare @CatName nvarchar(100)
    declare @CatID int
    declare @ValueCompare nvarchar(100)
    declare @PrevValueCompare nvarchar(100)
if(@catcount > 0)
begin
INSERT @temptblCategory 
    SELECT distinct CategoryID, CategoryName FROM tblCategoryMst  Where (Tag = 'A' or Tag = 'L' )and (TableName = 'Transactions' or TableName ='tblMember')  and Active =1
    While @i <= @catcount
        Begin

            set @CatName = (SELECT CategoryName FROM @temptblCategory WHERE idx = @i)
            set @CatID = (SELECT CategoryID FROM @temptblCategory WHERE idx = @i)

            if(@CatName = 'Form')
            Begin
                set @CatName = @CatName + 'Member'
            End
            else if(@CatName = 'Type')
            Begin
                set @CatName = 'Membership' + @CatName 
            End
            else if(@CatName = 'Address')
            Begin
                set @CatName = 'Cor' + @CatName 
            End

            declare @Query nvarchar(4000)
            SELECT * INTO #MYInserted FROM Inserted
            SELECT * INTO #MYDeleted FROM Deleted
            set @Query ='(Select @PrevValueCompare = ' + @CatName+' from #MYDeleted )'
            exec sp_executesql @Query ,N'@PrevValueCompare nvarchar(50) output', @PrevValueCompare output
            set @Query ='(Select @ValueCompare = ' + @CatName+' from #MYInserted )'
            exec sp_executesql @Query ,N'@ValueCompare nvarchar(50) output', @ValueCompare output

            DROP TABLE #MYInserted
            DROP TABLE #MYDeleted

            if( @ValueCompare <> 'no compare' and @ValueCompare  <>  @PrevValueCompare)
            Begin
                INSERT INTO dbo.tblLogMst(ID,IDOf,CategoryID, PreviousData, ChangedData,
                    ExchangeCode,CreatedBy,CreatedIP )
                      SELECT i.MemberID,'MS',@CatID, @PrevValueCompare, @ValueCompare ,
                    i.ExchangeCode,i.UpdatedBy,i.UpdatedIP
                      FROM Inserted i
                      INNER JOIN Deleted d ON i.MemberID = d.MemberID
            End
        set @i =  Convert(int,@i) + Convert(int,1)
        End
    end
END; 
```

# html - 字段集上的圆角

> ID：940191
> 
> 赞同：26
> 
> 时间：2009-06-02T15:22:29.943
> 
> 标签：html, css, internet-explorer, rounded-corners, fieldset

我注意到“fieldset”标签在 IE 上呈现圆角边框（它在其他浏览器上呈现方形）。

```
<fieldset>
         <legend>My legend</legend>
</fieldset> 
```

但是，如果我在字段集上设置 CSS 样式，圆角就会消失！！

有人知道为什么吗？如何保持圆角但使用另一种边框颜色？

**[编辑]：抱歉造成混淆，我不问如何在 Firefox/其他浏览器上设置圆角，我想知道如何在 IE 上**保留圆角并使用另一种边框颜色（border-color:red; on字段集将圆形更改为正方形...）。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-07-01T14:12:20.053

该站点修复了有关 fieldset 圆角和 IE10 的问题。IE中仍然存在问题（悲伤的脸）。你必须让它在 100% 的时间内工作。

```
fieldset {
  margin: 20px;
  padding: 0 10px 10px;
  border: 1px solid #666;
  border-radius: 8px;
  box-shadow: 0 0 10px #666;
  padding-top: 10px;
}
legend {
  padding: 2px 4px;
  background: #fff;
  /* For better legibility against the box-shadow */
}
fieldset > legend {
  float: left;
  margin-top: -20px;
}
fieldset > legend + * {
  clear: both;
}
```

```
<fieldset>
  <legend>Legend</legend>
</fieldset>
```

[http://www.456bereastreet.com/archive/201302/fieldset_legend_border-radius_and_box-shadow/](http://www.456bereastreet.com/archive/201302/fieldset_legend_border-radius_and_box-shadow/)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-02T15:30:40.053

没有这样的原因，浏览器的行为不同已经不是什么秘密了。

您是否探索过[-moz-border-radius](http://www.the-art-of-web.com/css/border-radius/)属性？

我想像

```
fieldset {   
  -moz-border-radius:5px;  
  border-radius: 5px;  
  -webkit-border-radius: 5px; //edit :D
} 
```

在 FireFox/Mozilla 中工作，但我已经很久没有尝试了：D

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-02T16:02:57.013

默认情况下，某些项目（按钮、输入框）使用系统视觉样式 - 在默认的 Windows XP/Vista 主题中，字段集具有圆角。（例如，查看显示属性。）

例如，如果您将任何样式分配给`<input />`，它也会失去悬停效果、渐变和其他内容。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-08-27T11:25:25.327

IE 中的边框仅在以下情况下是圆形的： 1）您在性能 | 下启用了“在按钮上的窗口上使用视觉样式”。视觉效果选项卡。说白了：如果你启用了“XP 主题”，它会被四舍五入，当你拥有经典的 Win2000 外观时，它不会被四舍五入。

第二个要求 2) 是字段集的“没有与边框相关的 CSS”。每当您分配边框颜色或边框样式或边框宽度时，“圆度”就消失了，没有解决方法。输入（按钮和字段）、文本框和选择标签也是如此。每当 IE 没有找到要呈现的控件的 CSS 主题时，它就会将“默认 Windows 主题”应用于控件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T12:39:08.070

[http://www.webteacher.ws/2010/02/27/style-a-fieldset-with-rounded-corners-using-css/](http://www.webteacher.ws/2010/02/27/style-a-fieldset-with-rounded-corners-using-css/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T15:32:27.427

您可以使用 CSS 3 border-radius 属性，该属性适用于 Firefox 和 Safari：

```
fieldset {
 -moz-border-radius: 5px;
 -webkit-border-radius: 5px;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-12-17T14:25:46.627

```
fieldset {   
  -moz-border-radius:5px;  
  border-radius: 5px;  
  -webkit-border-radius: 5px; //edit :D
} 
```

# wpf - WPF 动画首次运行

> ID：940194
> 
> 赞同：4
> 
> 时间：2009-06-02T15:23:25.153
> 
> 标签：wpf, animation, storyboard

我有一个简单的 WPF 应用程序，其中包含一个用户控件，该控件由主窗口上的一对故事板动画进出。我正在为用户控件的不透明度、scaletransform.scalex 和 scaletransform.scaley 设置动画以将其弹出和弹出视图。除了第一次运行之外，它看起来很酷。动画设置为 3/10 秒，尽管我在测试期间增加了这个时间。我尝试在几分之一秒内设置默认值，以查看是否存在我正在制作动画的属性值未按预期默认的问题。那什么也没做。我什至在加载的窗口上明确调用我的“隐藏”动画，看看这是否有助于我设置默认值，但这也不起作用。我第一次触发动画时，运行时是否进行了一些初始化？有没有办法在显示 UI 之前显式调用这种初始化？症状是控件直到第一个动画大约 2/10 秒时才可见。有时它会更长，并且控件在完全动画后显示（不透明度和大小是它们最终显示时的最终值）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T19:38:00.637

听起来您在动画之前设置了 UserControl 的 DataContext 。大概您正在进行绑定，即创建视觉对象并将它们添加到视觉树中，同时动画应该开始。这需要动画正在争取的处理。避免这种情况的方法是将控件实例化（设置了 DataContext），但将其隐藏，因此不需要在动画时执行可视对象创建。（通过我的同事蒂姆·李）

# php - 如何从基于 PHP 的 Web 应用程序访问 kiosk id reader 数据

> ID：940195
> 
> 赞同：1
> 
> 时间：2009-06-02T15:23:32.610
> 
> 标签：php, dojo, kiosk

有没有人做过这样的事情？如何？

我刚刚开始了一个项目，该项目将有一个基于浏览器的 Web 应用程序（使用 PHP 和可能的 Ajax 框架，如 Dojo 或 JQuery），该应用程序从信息亭单元内呈现给用户。它基本上是浏览器中的一项调查，但需要通过设备上的身份证刷卡器识别用户。

我什至不知道这是什么确切的单位（抱歉缺乏硬件信息！）因为我昨天刚刚了解了这个项目。我在等着看这个单元是否带有某种软件来帮助我，但我的感觉不是从我最初的会议开始的。尽管他们可能会决定稍后切换到 Linux，但他们最初将运行某种版本的 Windows。我没有使用信息亭的经验，所以我只是想了解这类事情通常涉及什么。

主要问题是如何将信息亭硬件中的数据输入到基于 Web 的 PHP 应用程序中？

在与项目负责人交谈时，他对如何解决这个问题的第一个猜测是：
- 有某种驱动程序来获取输入到 id 读取器的数据。
- 写入文件。
- 使用 Dojo Offline 定期或在需要时读取文件并比较时间戳等。

还不关心解决安全问题。首先，我只想弄清楚如何实现这一目标的基础知识。我可以看到如何使用 Flex/Air、Silverlight 等进行相同的操作，但我们是一家 PHP 商店，坦率地说，我的老板不会考虑这些。此外，使用数据库、套接字等似乎有点矫枉过正（但也许不是？？？）

有什么建议、警告等吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T15:31:47.990

您正在使用的硬件应该带有您需要能够从中检索数据的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T15:47:47.017

如果没有该设备的软件或文档，您将很难从它发送的数据中获得任何有用的信息。

如果您没有，那么您应该确定制造商（网络搜索序列号、ID 号或硬件上的任何其他内容）并向他们索取这些信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T09:46:12.113

我最近一直在研究一些扫描技术和 OCR，并一直在对一家名为 CSSN 的公司的一些产品进行一些研发。他们还为其产品提供了完整的 SDK，这应该会使集成变得更加容易。看看：[IdScan Kiosk](http://www.cssn-developers.com/idscan_kiosk.htm)

还有一个名为 Scan2Web 的产品，我认为它可能会有所帮助。

希望这可以帮助。

大卫

# logging - Grails 应用程序中没有 log4j 输出

> ID：940197
> 
> 赞同：11
> 
> 时间：2009-06-02T15:23:47.430
> 
> 标签：logging, grails, groovy, log4j

我的 Grails 1.1 应用程序中有以下 log4j 配置

```
log4j = {

    // Enable Hibernate SQL logging with param values
    trace 'org.hibernate.type'
    debug 'org.hibernate.SQL'

    debug 'com.mycompany'

    appenders {
        console name: 'stdout', layout: pattern(conversionPattern: '%d{dd-MM-yyyy HH:mm:ss,SSS} %5p %c{1} - %m%n')
        file name: 'hibeFile', file: 'hibe.log', layout: pattern(conversionPattern: '%d{dd-MM-yyyy HH:mm:ss,SSS} %5p %c{1} - %m%n')
    }

    // By default, messages are logged at the error level to both the console and hibe.log
    root {
        error 'stdout', 'hibeFile'
        additivity = true
    }
} 
```

当我运行单元测试时，生成的唯一日志输出来自 Hibernate 类。我不明白为什么没有为我自己的类（即`com.mycompany`命名空间下的类）生成日志输出。奇怪的是，当我运行集成测试时，log4j 输出符合预期。

如果我转到单元测试的测试报告，然后单击“System.out”链接，我会看到以下格式的日志消息：

```
DEBUG (member.InviteServiceTests): Calling getInvite with member (4517) 
```

请注意，这与我在 log4j 配置中指定的模式不同。此外，如果我从以下位置更改 log4j 配置：

```
debug 'com.mycompany' 
```

至：

```
fatal 'com.mycompany' 
```

我仍然在测试报告中看到调试级别的日志消息。似乎在运行单元测试时根记录器被覆盖了？我尝试过`com.mycompany`使用单独的记录器记录类，但这似乎没有任何区别

谢谢，唐

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-07T19:13:42.097

大学教师，

如果您尝试记录的类是标准 Grails 类（域、控制器、服务等），您应该能够使用以下内容：

```
 log4j = {

    // Logging warnings and higher for all of the app
    warn 'grails.app'
    // Logging infos and higher for all controllers
    info 'grails.app.controller'
    // Logging debug and higher for the BarService
    debug 'grails.app.service.BarService'

    appenders {
    // ...as above...
    }    
    root {
    // ...as above...
    }
} 
```

Grails 用户指南[中有关日志记录的部分有更多描述。](http://grails.org/doc/1.1.x/guide/3.%20Configuration.html#3.1.2%20Logging)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-05T13:39:18.473

由于 grails 日志记录委托给 log4j，您可以使用`-Dlog4j.debug`并查看 log4j 是如何配置的（[参考](http://logging.apache.org/log4j/1.2/manual.html)）。也许另一个文件被拾取。

* * *

至少有一个针对 1.2 而不是 1.1.x 的日志记录[严重错误修复。](http://jira.codehaus.org/browse/GRAILS-4376)配置和你的差不多。也许消息被错误地记录在不同的文件中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-01T00:49:23.487

您需要在单元测试中将记录器注入控制器：

```
mockLogging(<controller class name>, true) 
```

第二个参数表示记录调试消息及以下。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-03T15:45:04.300

大学教师，

我还没有完全破解 1.1 中记录 DSL 的复杂性，但这可能对您有用：动态日志插件允许您在应用程序启动时打开/关闭日志通道，并生成一些您可以然后放入的配置进入 Conf.groovy。

希望这可以帮助。

# php - 使用 file_get_contents 或 curl 到同一服务器上的 url

> ID：940198
> 
> 赞同：2
> 
> 时间：2009-06-02T15:23:49.643
> 
> 标签：php, rss, curl, file-get-contents

我有一个 PHP 脚本需要处理同一个站点的 RSS 提要。具体来说，我在主页上显示来自 WordPress RSS 提要的最新博客。在我们的登台服务器上它运行良好，但在我们的现场（这是一个完全不同的，但 LAMP 的）托管环境中它不工作。

我可以正常运行`file_get_contents`或`curl`在远程 url 上运行，但是当我尝试检索我们自己的 RSS 提要时，我返回了一个 404 not found 页面。另一个奇怪的是，如果我尝试`file_get_contents(http://domain.com/test.txt)`它会以 404 失败，但如果我这样做，`file_get_contents(http://www.domain.com/test.txt)`我会得到测试文本文件的内容。这一切都假设我从 domain.com（不是 www.domain.com）运行脚本

我在这里设置了一个示例：http: [//bkwld.com/test.php](http://bkwld.com/test.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T01:18:39.830

好的，我仍然不知道它为什么要这样做，但我将通过 feedburner 运行我的提要然后解析它的 RSS 提要来解决它。因为它在远程域上，所以它在我的测试中有效。不理想，但 w/e。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-17T15:05:39.733

我刚刚遇到了类似的问题。DNS是问题所在，它没有解析您的域名。您应该在脚本中使用 IP 而不是域。

您可以在 cmd 中 ping 您的域并使用该 IP。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T15:27:33.083

我有一个非常相似的问题 - 您可以尝试使用 127.0.0.1 而不是您自己的域名（假设您的 apache 设置不会阻止您这样做）。我相信与域解析有关，api的怪癖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T20:38:47.650

确实，奇怪。你将如何解析文件？您可以直接将其加载到 SimpleXML 中；

```
$xml = simplexml_load_file("http://domain.com/blog/feed/index.php");
/* Use Simple XML to parse the RSS feed */ 
```

我意识到这种方法不能解决您的问题，您只能使用另一种方法 - 但也许对您来说已经足够了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-26T11:31:37.447

如果 domain.com/test.txt 返回 404 并且 www.domain.com/test.txt 成功，则主机 DNS 可能具有不同配置的托管域。无论如何，我确定您已经尝试使用“www”检索 RSS 提要，但您是否尝试使用相对路径？例如：`file_get_contents('../../feed/')`

# http - 如果我只使用 OpenID，我应该为 401 上的 WWW-Authenticate 标头传递什么？

> ID：940206
> 
> 赞同：34
> 
> 时间：2009-06-02T15:25:06.443
> 
> 标签：http, authentication, openid, http-headers

HTTP 规范指出：

> **10.4.2 401 未经授权**
> 
> 该请求需要用户身份验证。响应必须包含一个 WWW-Authenticate 头字段（第 14.47 节），其中包含适用于所请求资源的质询。

如果我支持的唯一登录方案是 OpenID（或 CAS，或 OAuth 令牌等），我应该在此字段中输入什么？也就是说，我如何指示客户端需要*预先验证*并创建会话，而不是尝试随每个请求一起发送凭据？

在您回答“不要发送 401；发送 3xx 重定向到 OpenID 登录页面”之前，对于非 HTML 客户端呢？例如，Stack Overflow 如何实现我的自定义软件可以与之交互的 API？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-07-06T17:11:33.573

根据[RFC2617](https://www.rfc-editor.org/rfc/rfc2617#section-1.2)`auth-scheme`可以是任何东西；如果你真的想要一个 401，你在*技术上*并没有通过制造类似`WWW-Authenticate: OpenID realm="My Realm" location="http://my/login/location"`. 话虽如此，当你这样做时其他人的代码的行为当然是未定义的。:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T16:39:15.400

有一个[OAuth Discovery 规范](http://oauth.net/discovery/1.0/)将指示将什么放入 WWW-Authenticate 标头中——如果该规范在没有替代规范的情况下还没有过时。

# wpf - 基于条件的 WPF 数据绑定

> ID：940210
> 
> 赞同：1
> 
> 时间：2009-06-02T15:25:31.153
> 
> 标签：wpf, data-binding, controls, custom-controls, datasource

**目标** 开发一个自定义控件，显示指定周的摘要数据。

传入的数据如下：

```
3rd May 2009        Customer A     $2000
4th May 2009        Customer A     $3900
6th May 2009        Customer B     $1900 
```

预期的显示将是

```
 3rd May      4th May        5th May        6th May
   Customer A   Customer A                    Customer B
    $2000        $1900                          $1900 
```

如您所见，数据是基于日期的条件。

是否可以根据 WPF 中的条件对项目进行数据绑定？

即当数据源日期==当前项目日期时显示摘要

还是我应该坚持在 C# 后面编写这个逻辑？

----------------- 编辑安迪的问题 -----------------

我可以让它实现一个接口而不是一个基类。

我想要做的是让控件显示一年的日期中的 1 周，这将通过一个名为当前周的属性来设置。

然后，当传入已知数据源（参见上面的示例表）时，我希望控件中的任何日期项从数据源中提取它们的数据（如果有），如果没有，则仍然显示，但只显示日期。

数据将是网格摘要对象的列表

```
public class GridSummary
{
     public DateTime SummaryDate;
     public Client Customer;
     public decimal Amount;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-09T02:52:29.850

如果我理解正确，您希望以列表格式显示一些表格数据。它是否正确？

你对数据输入了解多少？是否保证实现接口，或从基类继承？如果是后者，那么我认为数据模板是可行的方法 - 为您希望给出的每种可能类型创建一个数据模板，并为每个设置`TargetType`它应该显示的类型。当您将数据绑定到控件时，WPF 将自动为集合中的每个对象选择正确的数据模板。

如果你对传入的数据一无所知，你怎么可能知道要显示什么，或者如何显示呢？看起来至少应该有一些关于传入数据必须知道的事情。

（我可能不明白你想要做什么 - 请澄清一下，我会看看我是否能提供更多帮助。）

**更新**

听起来您的控件的数据源将是一个`GridSummary`对象列表。如果是这种情况，那么我认为您可以使用[CollectionViewSource](http://msdn.microsoft.com/en-us/library/ms613527.aspx)作为数据源（它基本上包装了您的`GridSummary`对象集合），并订阅其[Filter](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource.filter.aspx)事件。对于传入的每个对象，将日期与`CurrentWeek`属性的周进行比较，如果日期在该周，则接受它（链接的 MSDN 页面有一个示例）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:34:42.463

你可以这样做：

```
if(a)
    this.DataSource = a;
else
    this.DataSource = b; 
```

我不确定那是你的意思。

你是在做自己的渲染吗？或者你是从基本控制中建立你的控制吗？您也许可以使用嵌套控件来获得所需的内容，并且可以有条件地控制嵌套控件。

# operating-system - 不分离共享内存段有什么影响

> ID：940213
> 
> 赞同：1
> 
> 时间：2009-06-02T15:26:03.697
> 
> 标签：operating-system, shared-memory

*   不分离共享内存段有什么影响？

*   不同的操作系统如何处理这个问题？

*   能不能分离妥协操作系统的稳定性？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T04:59:01.207

不分离会阻止其他人删除内存段，这在 windows 和 linux 上都是如此。因此，您将有内存泄漏。它不会影响操作系统的稳定性，但为什么你不想在使用完后分离和删除段呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-21T18:59:26.217

如果共享内存段没有分离，那么内核会继续认为特定的段（内核称之为区域）正在使用中，并且永远不会将其标记为删除 - 内部使用了一种引用计数机制。另一个问题是进程的虚拟地址空间会被不必要地占用。

但是，我不确定我们是否可以称之为内存泄漏（Java 人会说，不过），因为这个内存段会在进程退出时自动分离和释放。

这可能不会影响整个操作系统，但系统可能不得不关闭 - 这也是在没有任何通知的情况下 - 如果内存不足，某些进程会占用大量内存（请参阅 Linux OOM 杀手）。但这是最坏的情况。

# c++ - 如何编写一个接受每个类和类模板的 C++ 模板？

> ID：940216
> 
> 赞同：4
> 
> 时间：2009-06-02T15:27:01.353
> 
> 标签：c++, templates, overloading

预先警告：这个问题似乎比实际更明显。

我想编写一个可以接受任何具体类或模板类作为模板参数的模板。这可能看起来没用，因为如果不知道传入的 T 是否被模板化，您将不知道如何使用它。我想要这个的原因是我可以声明一个没有定义的通用模板，然后用户可以专门化。因为用户专门研究它，所以他们总是知道他们正在处理的类型。但是用户不能在没有首先声明模板的情况下专门化模板。

你可以这样做：

```
template<class T>
class myclass; 
```

但是如果你传入一个模板化的 T 就行不通了，例如`myclass<std::vector>`就行不通了。那么我们试试这个：

```
template<class T>
class myclass;

template<template<class> T>
class myclass; 
```

这可能是正确的轨道，但它不会按原样工作，因为类模板不能重载。所以让我们把它切换到函数模板，它可以是：

```
template<class T>
void myfunc();

template<template<class> T>
void myfunc(); 
```

亲爱的，所以我们做对了吗？好吧，模板模板参数可能有不同数量的参数，所以我们也需要考虑到这一点。

```
template<class T>
void myfunc();

template<template<class> T>
void myfunc();

template<template<class, class> T>
void myfunc();

template<template<class, class, class> T>
void myfunc();

// etc. 
```

丑陋，但[Boost 预处理器库](http://www.boost.org/doc/libs/1_39_0/libs/preprocessor/doc/index.html)可以为我们生成此代码（并且在 C++0x 中将添加对可变参数模板的支持，因此这种丑陋只是暂时的）。但是我们还是忘记了一个案子！如果 T 的一个参数不是一个类，而是一个常量整数怎么办。让我们尝试支持这一点：

```
template<class T>
void myfunc();

template<template<class> T>
void myfunc();

template<template<class, class> T>
void myfunc();

template<template<class, class, class> T>
void myfunc();

// etc.

template<template<class> T>
void myfunc();

template<template<class, int> T>
void myfunc();

template<template<int, class> T>
void myfunc();

template<template<int, class, class> T>
void myfunc();

template<template<class, int, class> T>
void myfunc();

template<template<class, class, int> T>
void myfunc();

// etc. 
```

哦哦。鉴于任何常量类型都可以传入模板，以任意数量与类参数混合，KABLOOEY 组合爆炸。只是为了让事情变得更加困难，如果 T 的任何参数本身就是模板怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T15:44:41.010

boost::mpl 做了这样的事情（这是他们[绑定参数](http://www.boost.org/doc/libs/1_39_0/libs/mpl/doc/refmanual/metafunctions.html)的想法）。但是，您必须做出很多假设才能使其正常工作，例如使用；

```
template <class T> foo { }; typedef foo< int_<4> > my_foo_4; 
```

代替

```
template <int T> foo { }; typedef foo<4> my_foo_4; 
```

不必为所有 int、char、bool 等组合提供重载。

我想不出比 boost::mpl 方法更有效的方法，而且总的来说，我认为任何方法都会遇到很多问题；类模板不是类型，它不能真正嵌入到类型系统中（boost::mpl 将其视为创建新类型的函数；更一般地说，它用于创建“MetaFunction”） . 我什至不确定可变参数模板是否会影响模板模板参数（虽然很有趣）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T15:41:06.377

解决方案是：使用函数重载而不是模板特化！编译时间会更好，约束消失了......

请记住，任何模板都被认为是在最近的全局范围内实例化的，之后才使用它们。这意味着这将起作用：

```
template <class T>
int f(const T& t)
{
  return g(t);
} 

int g(int a)
{
  return a+1;
}

int main()
{
   return f(5);
} 
```

如您所见，即使函数`g`是在`f`. 这意味着您可以定义使用该函数的任何模板，只要用户在**使用**模板之前定义了该函数，就可以了，C++会找到它。

还要记住，函数不存在模板特化！如果存在许多同名的函数，C++ 将总是期望重载，而不是模板特化。

简而言之，最好的解决方案是：就像函数存在一样使用它，并期望用户在使用模板之前定义函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T16:25:10.990

```
template <class T> class myclass;

template <> class myclass<int>{};
template <> class myclass<std::vector<int>>{};
template <> class myclass<std::vector<std::vector<int> > >{}; 
```

这是你想要的吗？

# jquery - 如何允许用户修改前端菜单？

> ID：940221
> 
> 赞同：0
> 
> 时间：2009-06-02T15:27:25.143
> 
> 标签：jquery, asp.net-mvc

我正在为网站编写后端/管理区域。用户希望能够在网站上修改他们的菜单。

*   这些菜单的层次可以不超过 3 级。
*   你允许用户这样做吗？
*   你如何存储层次结构？
*   你如何以编程方式显示菜单？
*   你如何让用户轻松创建层次结构——某种 jQuery 拖放？

期待您的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:48:16.970

**你允许用户这样做吗？** 不，但某些网站的管理员。（虽然没有使用 MVC 或 jQuery 构建。）

**你如何存储层次结构？** 在一个表中，有一个父字段。

**你如何以编程方式显示菜单？** 我遍历表格并输出 HTML。

**你如何让用户轻松创建层次结构——某种 jQuery 拖放？** 制作菜单编辑页面，在页面的内容区域中输出菜单，然后使用 jQuery sortable 插件之类的东西来移动东西，以及自定义代码来删除和插入新项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:38:47.220

这些菜单的深度不超过 3 级。好的

你允许用户这样做吗？不是一般情况，但我可以看到这可能有用的情况。

你如何存储层次结构？在数据库中的表中，按用户 ID。您还需要表中的一列来实现层次结构，并需要另一个表来包含菜单选项和基本 URL。

你如何以编程方式显示菜单？这是一个棘手的问题。您必须找到一种方法将菜单层次结构从控制器推送到页面中。JSON 似乎是一个可能的候选者。来自[jQuery UI](http://jqueryui.com/)的东西应该能够获取这个 JSON 并为您呈现一个菜单。

你如何让用户轻松创建层次结构——某种 jQuery 拖放？jQuery UI 具有拖放功能。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T15:48:51.167

乔恩，

查看此链接以获取其他想法：

[http://www.webappers.com/2007/09/05/smooth-and-clean-fastfind-menu-jquery-plugin/](http://www.webappers.com/2007/09/05/smooth-and-clean-fastfind-menu-jquery-plugin/)

> FastFind Menu Script 是一个由 ActiveSpotLight 在 BSD 许可下创建的 javascript 菜单。它将内容提要作为数据拉取来填充菜单，这可以是静态的或动态的。他们在内部使用的版本使用 JSON/XML 作为数据馈送。该脚本允许基于动态 Ajax 响应的嵌套菜单。也可以使用 jQuery 界面库拖放菜单。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-02T15:30:49.117

你问了很多问题，伙计；）

您显然了解 jQuery，因此标签... jQuery 将使您的生活变得如此轻松。请看一下 jQuery UI，它将解决您的所有问题：http: [//jqueryui.com/](http://jqueryui.com/)

# asp.net - 将 jQuery 对话框值发布到 ASP.NET 中的服务器

> ID：940226
> 
> 赞同：0
> 
> 时间：2009-06-02T15:28:48.293
> 
> 标签：asp.net, jquery

我是 jQuery 的新手。我有一个对话框，里面有几个输入框。我希望用户能够点击一个按钮并将值发布回服务器 - 理想情况下可以在服务器事件中获取。有什么方法可以实现这一目标？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-11T21:31:29.717

如果您要进行回发，为什么不能在对话框中使用标准的 asp.net 控件？我一直在使用[jqModal](http://dev.iceburg.net/jquery/jqModal/)，这似乎工作正常。

我使用标准的 HTML 输入按钮来触发对话框（在页面中作为隐藏的 div）。当用户单击对话框中的 asp.net 按钮或控件时，服务器不知道也不关心控件是否在模式对话框中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:05:38.450

There are a few different approaches you could take. You are probably going to want to use a jquery plugin.

I would look into [Thickbox](http://jquery.com/demo/thickbox/), its very easy to implement. Other options would be using the [jQuery UI](http://jqueryui.com/) plugin or [jQModal](http://dev.iceburg.net/jquery/jqModal/) depending on your needs. Each one offers some pros and cons.

# asp.net - 当 Gridview 为空白 VB.net 时显示页眉/页脚

> ID：940234
> 
> 赞同：2
> 
> 时间：2009-06-02T15:30:43.110
> 
> 标签：asp.net, vb.net, gridview, postback

我意识到有一个解决方案，但我正在努力让它正确转换为 VB :(

我已经设法获得了一组级联的下拉列表，其中包含基于彼此结果的数据，这让我非常满意。

然而，由于回发，网格将消失，直到选择第二个值并且看起来很糟糕

如果网格视图中没有数据，VB中是否有允许标题保留？

提前谢谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T15:58:52.727

是的，有一种方法可以手动完成，这是在 C#[示例](https://web.archive.org/web/20161114032518/http://blogs.claritycon.com:80/blog/2006/02/displaying-gridview-when-no-data-exists/)中完成所有操作的代码，只需使用[转换器](http://www.developerfusion.com/tools/convert/csharp-to-vb/)，它就会在 VB 中提供给您

或按照这些示例[SO GridView - 在空数据源上显示标题。](https://stackoverflow.com/questions/354369/gridview-show-headers-on-empty-data-source)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T19:20:36.357

你有两种方法可以做到：

1-通过模拟里面的输入字段

```
<asp:GridView ID="GridView1" runat="server">
        <EmptyDataTemplate>
            <tr>
                <td>
                    First Cell
                </td>
                <td>
                    Second Cell
                </td>
                <tb>
                    Third Cell
                </tb>
            </tr>
        </EmptyDataTemplate>
        </asp:GridView> 
```

2-是创建空数据集并将其绑定到 GirdView。

```
If ds.Tables(0).Rows.Count > 0 Then
            grd_codes.DataSource = ds
            grd_codes.DataMember = ds.Tables(0).TableName

            grd_codes.DataBind()

        Else
            Try
                If ds.Tables(0).Rows.Count = 0 Then

                    ds.Tables(0).Rows.Add(ds.Tables(0).NewRow())
                    grd_codes.DataSource = ds
                    grd_codes.DataBind()
                    Dim columnCount As Integer = grd_codes.Rows(0).Cells.Count
                    grd_codes.Rows(0).Cells.Clear()
                    grd_codes.Rows(0).Cells.Add(New TableCell)
                    grd_codes.Rows(0).Cells(0).ColumnSpan = columnCount
                    grd_codes.Rows(0).Cells(0).Text = "No Records Found."

                End If 
```

我更喜欢第一种方式，因为 Binding empty DataSet 有一些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-17T08:45:38.650

在标记中有一种更简单、更简洁的方法（因此无论您使用的是 VB 还是 C#）：只需将 GridView 的**[ShowHeaderWhenEmpty](https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.webcontrols.gridview.showheaderwhenempty?redirectedfrom=MSDN&view=netframework-4.8#System_Web_UI_WebControls_GridView_ShowHeaderWhenEmpty)**属性设置为 true。:)

参考。在此处查看最佳答案：[GridView - 在空数据源上显示标题](https://stackoverflow.com/questions/354369/gridview-show-headers-on-empty-data-source)

然而，这并没有显示页脚，微软以其无限的智慧，不知何故认为不适合添加明显的等价**ShowFooterWhenEmpty**属性:(所以，我仍在调查。

*注意：以下现有 GridView 属性对于空数据集是不够的：将**ShowFooter****[属性](https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.webcontrols.gridview.showfooter?view=netframework-4.8)**设置为 true*。*

为了显示页脚，我们有 sproc（存储过程），当相关的 SQL SELECT 没有找到匹配项时，它会填充我们的网格，返回一行空值，或者主要是空值。效果很好。;)

# .net - VB6 HTTP 请求到 VB.Net 2.0 的转换

> ID：940237
> 
> 赞同：2
> 
> 时间：2009-06-02T15:30:56.340
> 
> 标签：.net, vb.net, vb6, httpwebrequest

我正在尝试将旧版 VB6 组件（不是我编写的）更新到 .NET 平台。有一个函数可以将 XML 字符串发布到 URL：

```
Function PostToUrl(ByRef psUrl, ByRef psData, Byref psResponseText, ByRef psErrorMsg, ByRef psUsername, ByRef psPassword)

    On Error Resume Next    
    Dim objWinHTTP

    PostToUrl = False
    psErrorMsg = ""
    psResponseText = ""
    Dim m_lHTTPREQUEST_SETCREDENTIALS_FOR_SERVER
    m_lHTTPREQUEST_SETCREDENTIALS_FOR_SERVER    =0  

    Set objWinHTTP = CreateObject("WinHttp.WinHttpRequest.5.1")

    objWinHTTP.Open "POST", psUrl

    If psUsername <> "" Then
        Call objWinHTTP.SetCredentials(psUsername, psPassword, m_lHTTPREQUEST_SETCREDENTIALS_FOR_SERVER)
    End If
    objWinHTTP.SetRequestHeader "Host", "http://www.xxx.com/CSIHTTP.asp"
    objWinHTTP.SetRequestHeader "X-Method", "Submit"
    objWinHTTP.SetRequestHeader "Content-Type", "text/xml"

    objwinHTTP.setTimeouts 3000, 15000, 15000, 120000

    Call objWinHTTP.Send(psData)

    ' Handle errors  '

    If Err.Number <> 0 Then

        psErrorMsg = Err.Description & " test"
        PostToUrl = False

    ElseIf objWinHTTP.Status <> 200 AND objWinHTTP.Status <> 202 Then

        psErrorMsg = "(" & objWinHTTP.Status & ") " & objWinHTTP.StatusText
        PostToUrl = False

    Else

        psErrorMsg = objWinHTTP.ResponseText & "(" & objWinHTTP.Status & ") " & objWinHTTP.StatusText
        PostToUrl = True

    End If

    Set objWinHTTP = Nothing
End Function 
```

我已将其更新为：

```
Public Function PostXml(ByVal XML As String) As Boolean

        Try
            Dim URL As String = My.Settings.NTSPostURL 
            'TODO: supply username and password!  '
            Dim Bytes As Byte() = Me.Encoding.GetBytes(XML)
            Dim HTTPRequest As HttpWebRequest = DirectCast(WebRequest.Create(Me.PostURL), HttpWebRequest)
            Dim Cred As New NetworkCredential("username", "password", "http://www.xxx.com")

            With HTTPRequest
                .Method = "POST"
                .ContentLength = Bytes.Length
                .ContentType = "text/xml"
                .Credentials = Cred
                .Timeout = 120000
                .Method = "Submit"
            End With

            Using RequestStream As Stream = HTTPRequest.GetRequestStream()
                RequestStream.Write(Bytes, 0, Bytes.Length)
                RequestStream.Close()
            End Using

            Using Response As HttpWebResponse = DirectCast(HTTPRequest.GetResponse(), HttpWebResponse)

                If Response.StatusCode <> HttpStatusCode.OK Then

                    Dim message As String = [String].Format("POST failed. Received HTTP {0}", Response.StatusCode)

                    Throw New ApplicationException(message)

                End If

            End Using

        Catch ex As WebException
            Dim s As String = ex.Response.ToString() & " " & ex.Status.ToString()
            Throw
        End Try

    End Function 
```

但是，当我运行 .NET 代码时，服务器在以下行返回错误“403 Forbidden - protocol error” `Using Response As HttpWebResponse = DirectCast(HTTPRequest.GetResponse(), HttpWebResponse)` ：. VB6 代码运行良好。任何人都可以找出可能导致这种情况的两者之间的任何差异吗？让我一脸懵逼......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T15:38:19.450

除非我错过了，否则您似乎没有在 .net 版本中设置 HOST 标头。如果您的服务器使用 HostHeaderResolution 在同一 IP 地址上托管多个域，那么您将获得 403。

这当然只是一个疯狂的猜测。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T15:40:57.190

您是否尝试过从两个来源捕获流量并进行比较？

我首先尝试 Fiddler [http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)，它是一个免费的 HTTP 调试代理。

如果这不起作用，您可以尝试 WireShark，它是一个免费的协议分析器（级别较低，因此会有很多细节需要过滤掉）。[http://www.wireshark.org/](http://www.wireshark.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T19:24:48.500

我认为您没有正确排序凭据。您正在使用 URL 的授权部分作为凭证域。

像这样尝试：-

```
Dim myCache as New CredentialCache()
myCache.Add(New Uri("http://www.xxx.com"), "Basic", New NetworkCredential("username", "password"))

HTTPRequest.Credentials = myCache 
```

这假设需要基本身份验证，另一个竞争者将是“Digest”或“NTLM”，这可能需要一个域。例如，如果用户名的文本在旧代码中是这样的“域\用户名”，那么你会想要：-

```
Dim myCache as New CredentialCache()
myCache.Add(New Uri("http://www.xxx.com"), "NTLM", New NetworkCredential("username", "password", "domain"))

HTTPRequest.Credentials = myCache 
```

顺便说一句，我同意 steamer25，对于这种事情你真的需要一个工具，比如 fiddler。

如果您在运行此代码的机器上有一个旧的工作场所提琴手的例子。启动 fiddler 并使用命令 proxycfg -u。现在您可以观察原始内容与 ASP 服务器的转换。在关闭 fiddler 之前使用 proxycfg -d。

现在在您的 .NET 代码中将以下内容放在*应用程序*.config 中：-

```
<system.net>
    <defaultProxy enabled="false">
        <proxy proxyaddress="http://127.0.0.1:8888" bypassonlocal="False"/>
    </defaultProxy>
</system.net> 
```

启动提琴手并将启用的属性轻弹为“true”。现在您应该看到您的新代码尝试与 ASP 服务器进行的对话。确保在使用新代码之前设置 enabled="false" 而不进行 fiddler 捕获。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-24T13:37:36.907

在经历了很多痛苦之后，我终于设法让它工作了。问题出在文本编码上，我已将其更改为 ASCII 并且一切正常：

```
Try
            Dim Bytes As Byte() = Me.Encoding.GetBytes(XML)
            Dim HTTPRequest As HttpWebRequest = DirectCast(WebRequest.Create(Me.PostURL), HttpWebRequest)

            With HTTPRequest
                .Method = "POST"
                .ContentLength = Bytes.Length
                .ContentType = "text/xml"
                .Credentials = New NetworkCredential("user", "password") 'myCache
            End With

            Using RequestStream As Stream = HTTPRequest.GetRequestStream()
                RequestStream.Write(Bytes, 0, Bytes.Length)
                RequestStream.Close()
            End Using

            Using Response As HttpWebResponse = DirectCast(HTTPRequest.GetResponse(), HttpWebResponse)

                Return Response.StatusCode

            End Using

        Catch ex As WebException
            Dim s As String = ex.Status.ToString
            Throw
        End Try 
```

感谢所有帮助过的人。全场点赞。

# visual-studio - Visual Studio 使用几个未使用的文件和库构建我的项目

> ID：940238
> 
> 赞同：4
> 
> 时间：2009-06-02T15:31:19.660
> 
> 标签：visual-studio, build-process

一段时间以来，我已经让 Visual Studio 生成了其中包含各种额外文件的构建。我已经检查了我所知道的所有内容，以了解这些可能来自哪里，但我没有想法。

例如，我以前使用 MbUnit，但现在我使用 NUnit。我的任何项目都没有引用 MbUnit，但是当我构建时它仍然出现在我的*bin\Debug*和*bin\Release文件夹中。*此外，我的引导程序项目甚至没有引用任何使用测试框架的库，那么为什么它会出现在*BootStrapper\bin\Relase*文件夹中？

此外，即使我使用 Release 目标构建，我的某些（但不是全部）项目和 vshost 文件的 pdb 文件也会继续传输到 bin 目录。我根本没有弄乱配置目标的定义！

有谁知道这些可能来自哪里？我一定缺少一些知识。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T15:44:31.557

默认情况下，发布版本会创建 pdb 文件，因此在其中看到它们并不罕见。我假设 vshost 文件也是如此。如果您想在没有它们的情况下进行构建，请打开项目设置（从解决方案资源管理器中的项目上下文菜单）转到“构建”选项卡，确保您正在查看发布配置，然后单击“高级”底部的按钮。在弹出的新窗口中，有一个标有“调试信息”的下拉菜单，将其设置为无以禁用 pdb 创建。

至于引用，这听起来不像是正确的行为，但请记住它们是递归的，因此如果 projectA 引用 projectB 而 projectB 引用 mbunit，那么 mbunit dll 将被复制到 projectA 的任何构建文件夹中。因此，您可能在某处错过了一个参考，而这正在整个解决方案中传播……？

此外，请确保您正在重建解决方案而不是构建 - 构建不会删除文件夹中已存在的任何文件。最好在构建之前手动删除 bin 和 obj 文件夹，以确保您有一个干净的状态。

* * *

刚刚在 Visual Studio 中进行了快速测试，看起来无论调试信息设置是什么，都为在调试和发布中设置为启动项目的任何项目创建了一个 vshost 文件。要停止这种情况，您需要取消选中项目设置的“调试”选项卡下的“启用 Visual Studio 托管进程”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T15:35:28.313

您可以安全地删除 .pdb 文件和 .vshost 文件，前者用于调试信息（是的，即使发布版本也可以在一定程度上进行调试），后者仅适用于 Visual Studio，它可以使用 vs 作为附件运行调试器更快（再次，发布与否）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T15:45:53.240

简单地从目录中删除文件不会阻止它们出现在未来的构建中。检查项目属性中的构建前和构建后步骤。如果您不想在发布版本中使用符号，请禁用项目属性中的调试符号链接选项（但我建议保留它们，除非您编写完美的代码）。

# wpf - 如何从代码中选择 TreeView 项目

> ID：940243
> 
> 赞同：30
> 
> 时间：2009-06-02T15:32:16.460
> 
> 标签：wpf, treeview

我有一个三层树视图。如何从代码中选择第三级的任何项目？我尝试了许多博客和 stackoverflow 中提到的方法，但它似乎仅适用于第一级（对于第一级以下的项目，dbObject 为空）。

这是我用来选择 TreeViewItem 的代码。我错过了什么吗？

```
public static void SetSelectedItem(this TreeView control, object item)
{
    try
    {
        var dObject = control.ItemContainerGenerator.ContainerFromItem(item);

        //uncomment the following line if UI updates are unnecessary
        ((TreeViewItem)dObject).IsSelected = true;

        MethodInfo selectMethod = typeof(TreeViewItem).GetMethod("Select",
            BindingFlags.NonPublic | BindingFlags.Instance);

        selectMethod.Invoke(dObject, new object[] { true });
    }
    catch { }
} 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-06-03T17:38:22.673

另一种选择是使用绑定。如果您有一个正在使用绑定的对象来获取每个对象的文本`TreeViewItem`（例如），您可以创建一个也绑定该`IsSelected`属性的样式：

```
<TreeView>
    <TreeView.Resources>
        <Style TargetType="TreeViewItem">
            <Setter Property="IsSelected"
                    Value="{Binding Path=IsSelected, Mode=TwoWay}" />
        </Style>
    </TreeView.Resources>
</TreeView> 
```

这假定绑定对象具有`IsSelected`type 的属性`bool`。然后，您可以通过为相应的对象`TreeViewItem`设置`IsSelected`为来选择一个。`true`

可以对`IsExpanded`属性使用相同的方法来控制 a 何时`TreeViewItem`展开或折叠。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-03-03T14:35:44.593

您可以使用以下`TreeView`扩展，我发现这是一个更简单的解决方案：

```
public static class TreeViewExtension
{
    public static bool SetSelectedItem(this TreeView treeView, object item)
    {
        return SetSelected(treeView, item);
    }

    private static bool SetSelected(ItemsControl parent, object child)
    {
       if (parent == null || child == null)
          return false;

       TreeViewItem childNode = parent.ItemContainerGenerator
       .ContainerFromItem(child) as TreeViewItem;

       if (childNode != null)
       {
          childNode.Focus();
          return childNode.IsSelected = true;
       }

       if (parent.Items.Count > 0) 
       {
          foreach (object childItem in parent.Items)
          {
             ItemsControl childControl = parent
               .ItemContainerGenerator
               .ContainerFromItem(childItem) 
               as ItemsControl;

             if (SetSelected(childControl, child))
               return true;
          }
       }

      return false;
   }
} 
```

有关更多信息，请阅读此博客文章； [http://decompile.it/blog/2008/12/11/selecting-an-item-in-a-treeview-in-wpf/](http://decompile.it/blog/2008/12/11/selecting-an-item-in-a-treeview-in-wpf/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T23:14:12.483

在尝试了不同的解决方案后，我来到了[这个](http://shevaspace.spaces.live.com/blog/cns!FD9A0F1F8DD06954!581.entry)网站。周勇展示了如何以编程方式展开 TreeView 的所有节点。他的方法有两个主要思想：

*   只有当 item 是元素的直接子元素时，ContainerFromItem 才会返回容器。在 TreeView 中，这意味着只会返回第一级子容器，您必须在子 TreeViewItem 上调用 ContainerFromItem 才能从下一级获取容器
*   为了使 ContainerFromItem 工作，应创建 TreeViewItem 可视子项，并且仅在展开 TreeViewItem 时才会发生这种情况。这意味着要选择 TreeViewItem 必须展开所需项目之前的所有项目。在实践中，这意味着我们必须提供我们想要选择的项目的路径，而不仅仅是项目。

这是我最终得到的代码

```
public static void SelectItem(this ItemsControl parentContainer, List<object> path)
{
    var head = path.First();
    var tail = path.GetRange(1, path.Count - 1);
    var itemContainer = parentContainer.ItemContainerGenerator.ContainerFromItem(head) as TreeViewItem;

    if (itemContainer != null && itemContainer.Items.Count == 0)
    {
        itemContainer.IsSelected = true;

        var selectMethod = typeof(TreeViewItem).GetMethod("Select", BindingFlags.NonPublic | BindingFlags.Instance);
        selectMethod.Invoke(itemContainer, new object[] { true });
    }
    else if (itemContainer != null)
    {
        itemContainer.IsExpanded = true;

        if (itemContainer.ItemContainerGenerator.Status != GeneratorStatus.ContainersGenerated)
        {
            itemContainer.ItemContainerGenerator.StatusChanged += delegate
            {
                SelectItem(itemContainer, tail);
            };
        }
        else
        {
            SelectItem(itemContainer, tail);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-20T12:46:34.850

就我而言（我遇到了同样的问题），但使用绑定到 Data 对象的 IsSelected 属性是不合适的，而且我也无法轻松获取树项的路径，因此以下代码完美地完成了这项工作：

```
 private void SelectTreeViewItem(object item)
    {
        try
        {
            var tvi = GetContainerFromItem(this.MainRegion, item);

            tvi.Focus();
            tvi.IsSelected = true;

            var selectMethod =
                typeof(TreeViewItem).GetMethod("Select",
                System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance);

            selectMethod.Invoke(tvi, new object[] { true });
        }
        catch { }
    }

  private TreeViewItem GetContainerFromItem(ItemsControl parent, object item)
    {
        var found = parent.ItemContainerGenerator.ContainerFromItem(item);
        if (found == null)
        {
            for (int i = 0; i < parent.Items.Count; i++)
            {
                var childContainer = parent.ItemContainerGenerator.ContainerFromIndex(i) as ItemsControl;
                TreeViewItem childFound = null;
                if (childContainer != null && childContainer.ItemContainerGenerator.Status != GeneratorStatus.ContainersGenerated)
                {
                    childContainer.ItemContainerGenerator.StatusChanged += (o, e) =>
                        {
                             childFound = GetContainerFromItem(childContainer, item);
                        };
                }
                else
                {
                     childFound = GetContainerFromItem(childContainer, item);                            
                }
                if (childFound != null)
                    return childFound;                 
            }
        }
        return found as TreeViewItem;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T22:34:18.913

是的，ContainerFromItem 方法没有返回任何东西，即使您从直接父 TreeViewItem 调用它也是如此。

您可能需要进行一些重新设计。如果您将所有内容创建为显式 TreeViewItem，您应该能够保留对它的引用并在其上设置 IsSelected。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-06T23:16:02.843

我的回答迟到了，但对于那些想要纯 MVVM 解决方案的人来说，这可以通过事件触发器（在用户选择新项目时更新绑定）和数据触发器（在值时更新所选项目）来完成绑定更改）。

为此，主 ViewModel 需要项目、当前选定项目的属性和当前选定项目更改时将调用的命令属性：

```
public class MainViewModel : ViewModelBase
{
    // the currently selected node, can be changed programmatically
    private Node _CurrentNode;
    public Node CurrentNode
    {
        get { return this._CurrentNode; }
        set { this._CurrentNode = value; RaisePropertyChanged(() => this.CurrentNode); }
    }

    // called when the user selects a new node in the tree view
    public ICommand SelectedNodeChangedCommand { get { return new RelayCommand<Node>(OnSelectedNodeChanged); } }
    private void OnSelectedNodeChanged(Node node)
    {
        this.CurrentNode = node;
    }

    // list of items to display in the tree view
    private ObservableCollection<Node> _Items;
    public ObservableCollection<Node> Items
    {
        get { return this._Items; }
        set { this._Items = value; RaisePropertyChanged(() => this.Items); }
    }
} 
```

TreeView 需要一个事件触发器来在选择更改时调用 SelectedNodeChangedCommand，并且需要一个 TreeViewItem 样式的 DataTrigger，以便在代码中以编程方式更改 CurrentNode 的值时选择控件项：

```
<TreeView x:Name="treeView" ItemsSource="{Binding Items}"
            xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
            xmlns:cmd ="http://www.galasoft.ch/mvvmlight">
        <TreeView.Resources>

            <conv:EqualityConverter x:Key="EqualityConverter" />

            <Style TargetType="TreeViewItem">
                <Setter Property="IsExpanded" Value="True" />
                <Setter Property="IsSelected" Value="False" />
                <Style.Triggers>
                    <!-- DataTrigger updates TreeViewItem selection when vm code changes CurrentNode -->
                    <DataTrigger Value="True">
                        <DataTrigger.Binding>
                            <MultiBinding Converter="{StaticResource EqualityConverter}">
                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type TreeView}}" Path="DataContext.CurrentNode" />
                                <Binding />
                            </MultiBinding>
                        </DataTrigger.Binding>
                        <Setter Property="IsSelected" Value="True" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>

            <!-- *** HierarchicalDataTemplates go here ***  -->

        </TreeView.Resources>

        <!-- EventTrigger invokes SelectedNodeChangedCommand when selection is changed by user interaction -->
        <i:Interaction.Triggers>
            <i:EventTrigger EventName="SelectedItemChanged">
                <cmd:EventToCommand Command="{Binding SelectedNodeChangedCommand}" CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=TreeView}, Path=SelectedItem}"  />
            </i:EventTrigger>
        </i:Interaction.Triggers>

    </TreeView> 
```

DataTrigger 通过检测 CurrentNode 的值何时与当前列表项的 Node 匹配来工作。不幸的是，DataTriggers 不能绑定它们的值，所以它必须使用 EqualityConverter 进行测试，而不是只做一个简单的比较：

```
 public class EqualityConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        return values[0] == values[1];
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

# latex - 为什么我不能在 Latex 中显示口音？

> ID：940249
> 
> 赞同：3
> 
> 时间：2009-06-02T15:34:35.287
> 
> 标签：latex, utf-8

一旦我在文本中使用重音符号，它就不再起作用了。它报告错误：

```
! Undefined control sequence.
<argument> R\UTF 
                 {00E9}seau Ethernet
l.88 \section{R\UTF{00E9}seau Ethernet}

? 
```

为了稍微解释一下输出，我试图`\section{Réseau Ethernet}`在该行中进行编译。

我认为这与编码有关。有人可以告诉我应该在哪里解决这个问题吗？我将 TeXShop 与 MacOs X 一起使用。我应该提供任何其他信息吗？

编辑：我认为实际问题似乎与此警告有关：

```
Package frenchb.ldf Warning: The definition of \@makecaption has been changed,
(frenchb.ldf)                frenchb will NOT customize it;
(frenchb.ldf)                reported on input line 83. 
```

由于我已经使用

```
\usepackage[french]{babel}
\usepackage[T1]{fontenc} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T15:38:38.170

看看这里：[http](http://en.wikibooks.org/wiki/LaTeX/Internationalization) ://en.wikibooks.org/wiki/LaTeX/Internationalization 。

这是我在 GNU/Linux 上与 TeXlive 一起使用的内容：

```
\usepackage[french]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc} 
```

您的设置代码可能会有所不同，例如 TeTeX 我必须添加`\usepackage{ucs}`和使用`utf8x`而不是`utf8`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T15:40:55.770

这是[LaTeX 备忘](http://www.stdout.org/~winston/latex/latexsheet.pdf)单[PDF 警告]。é 字符可以使用 \'e 命令生成。我认为您不需要更改编码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T15:38:21.527

尝试添加；

```
\usepackage[utf8]{inputenc} 
```

到文档的开头。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T21:52:42.147

[TexShop](http://scripts.sil.org/cms/SCRIPTs/page.php?site_id=nrsi&item_id=xetex_texshop)从 1.35 版开始支持[XeTeX](http://en.wikipedia.org/wiki/XeTeX)，所以告别 LaTeX utf8 地狱，用你想要的任何语言和字体书写。

# c# - 方法的通用接口重载？

> ID：940253
> 
> 赞同：3
> 
> 时间：2009-06-02T15:35:00.480
> 
> 标签：c#, interface, generics, overloading

有没有一种好的、通用的方法可以在不使用第二种方法或大量强制转换的情况下执行以下操作 - 我想保持 API 尽可能轻，而且在我看来 OO 明智：

```
class Foo
{
  public T Bar<T>() where T: IAlpha
  {
    /* blahblahblah */
  }

  public T Bar<T>() where T: IBeta
  {
    /* blahblahblah */
  }
}

interface IAlpha
{
  string x {set;}
}

interface IBeta
{
  string y {set;}
} 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T15:40:18.217

您不能仅通过返回值（通用或非通用）重载方法。此外，不可能解决对 的调用`Bar`，因为一个对象可以同时实现`IAlpha`和`IBeta`，因此使用重载是不可能的。

```
public class AlphaBeta : IAlpha, IBeta
{
    string x {set;}
    string y {set;}
}

// too ambiguous
AlphaBeta parkingLot = myFoo.Bar<AlphaBeta>(); 
```

以下也不起作用，因为方法仅因返回类型而异

```
class Gar
{
    public string Foo()
    {
        return "";
    }

    public int Foo()
    {
        return 0;
    }
} 
```

不幸的是，您最好的解决方案是使用不太通用的解决方案。命令模式在这里可能会很好地为您服务。

```
public class Foo
{
    private readonly static Dictionary<Type, Command> factories =
        new Dictionary<Type, Command>();

    static Foo()
    {
        factories.Add(typeof(IAlpha), new AlphaCreationCommand());
        factories.Add(typeof(IBeta), new BetaCreationCommand());
    }

    public T Bar<T>()
    {
        if (factories.ContainsKey(typeof(T)))
        {
            return (T) factories[typeof(T)].Execute();
        }
        throw new TypeNotSupportedException(typeof(T));
    }
}

// use it like this
IAlpha alphaInstance = myFoo.Bar<IAlpha>();
IBeta betaInstance = myFoo.Bar<IBeta>(); 
```

另一种实现 Bar 的方法是使用 out 参数，它允许您在不显式声明类型（在尖括号中）的情况下调用它。但是，我会避免它，因为 100% 管理的输出参数通常会散发出糟糕的设计。

```
public void Bar<T>(out T returnValue)
{
    if (factories.ContainsKey(typeof(T)))
    {
        returnValue = (T) factories[typeof(T)].Execute();
        return;
    }
    throw new TypeNotSupportedException(typeof(T));
}

// call it like this
// T is inferred from the parameter type
IAlpha alphaInstance;
IBeta betaInstance;
myFoo.Bar(out alphaInstance);
myFoo.Bar(out betaInstance); 
```

我排除了`Command`, `AlphaCreationCommand`,`BetaCreationCommand`和`TypeNotSupportedException`. 它们的实现应该是相当不言自明的。

或者，您可以使用 Func 而不是命令，但这会迫使您实现所有实例化代码，`Foo`随着代码库的增长，这些代码可能会失控。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-04T11:59:57.183

这个怎么样？

```
class Foo
{
  public void Bar<T>(Action<T> @return) where T: IAlpha
  {
    @return(new AlphaImpl());
  }

  public void Bar<T>(Action<T> @return) where T: IBeta
  {
    @return(new BetaImpl());
  }
}

interface IAlpha
{
  string x {set;}
}

interface IBeta
{
  string y {set;}
} 
```

# apache - 如何使用第三方 CA-NOT 自签名 CA 生成客户端证书

> ID：940262
> 
> 赞同：3
> 
> 时间：2009-06-02T15:37:27.580
> 
> 标签：apache, openssl, ssl-certificate, httpd.conf

我正在尝试导出客户端证书以用于 Web 浏览器。

目标是使用 <Location> 指令限制对管理区域的访问。我看过很多关于使用自签名 CA 的教程。您将如何使用第三方来做到这一点？

1) 如果 CA 是受信任的根 CA，我是否需要在客户端 pfx 中包含 CA？这两个例子我都看过。

没有 CA：

```
openssl pkcs12 -export -inkey KEYFILENAME -in CERTFILEFILENAME -out XXX.pfx 
```

使用 CA：

```
openssl pkcs12 -export  -in my.crt- inkey my.key -certfile my.bundle -out my.pfx 
```

2) 我是否仍需要在 httpd.conf 设置中包含 SSLCACertificateFile 以用于受信任的 CA？

```
SSLVerifyClient none
SSLCACertificateFile conf/ssl.crt/ca.crt
<Location /secure/area>
SSLVerifyClient require
SSLVerifyDepth 1
</Location> 
```

[http://www.modssl.org/docs/2.8/ssl_howto.html#ToC8](http://www.modssl.org/docs/2.8/ssl_howto.html#ToC8)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-24T09:23:49.683

您不能使用第三方 CA 签名证书颁发客户端证书。您必须拥有自签名 CA 才能颁发客户端证书并将此 CA 指定为`SSLCACertificateFile`

样本：

```
 SSLCertificateFile /etc/apache2/ssl/apache.cer # site certificate signed by verisign
    SSLCertificateKeyFile /etc/apache2/ssl/apache.key # site key for certificate signed by verisign
    SSLCACertificateFile /etc/apache2/ssl/apachelca2.pem # your self signed CA 
```

请注意，其中`apachelca2.pem`包含密钥和证书...颁发客户端证书的命令行：

```
openssl req -config /usr/share/apache2/ssleay.cnf -new -key client.key -out client.csr

openssl x509 -req -days 365 -CA /etc/apache2/ssl/apachelca2.pem -CAkey /etc/apache2/ssl/apachelca2.pem -CAcreateserial -in client.csr -extfile /usr/share/apache2/ssleay.cnf -extensions v3_req -out client.crt 
```

# c - SIC 汇编器 I/O

> ID：940274
> 
> 赞同：0
> 
> 时间：2009-06-02T15:40:39.637
> 
> 标签：c, assembly

我编写了一个 SIC 汇编器，除了 I/O 方面，一切似乎都运行良好。

我已经将目标代码加载到内存中（将字符格式转换为机器表示），但是当我调用 SICRun(); 要执行代码，我收到一条错误消息，指出“找不到 devf1”。

我知道这与源代码中的输入/输出设备指令有关。
c 文件声明它依赖于外部文件，尤其是 Dev[6]。我应该自己创建这个吗？我的导师没有给我们任何其他文件可以使用。有什么见解吗？

示例：TD OUTPUT ;测试输出设备

[此](https://web.archive.org/web/20100221225221/http://cs.panam.edu/~egle/CSCI3334/)目录包含源代码 (source.asm)、头文件 (sic.h) 和 SIC 模拟器 (sicengine.c)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T09:50:02.840

从`sicengine.c`源文件看来，`devf1`（也是`dev2`/ `dev3`）文件应该存在，因此可以从（作为参数`fopen`传递）读取这个“输入设备”：`"r"`

```
if (opcode == 216) {  /* RD */
    /* ... */
    if ((Dev[Devcode] = fopen(SICFile[Devcode],"r")) == NULL) {
        printf("cannot open file %s\n", SICFile[Devcode]);
        exit(1);
    } 
```

代码中关于依赖文件的注释`Dev[6]`不明确。它实际上是指数组中文件的名称`Dev`，分别是`devf1`,`devf2`和`devf3`（输入设备）和`devf04`,`devf05`和`devf05`（输出设备）。

我建议创建文件`devf1`和.`devf1``devf3`

# java - 负载均衡情况下的 OpenID

> ID：940275
> 
> 赞同：3
> 
> 时间：2009-06-02T15:40:40.620
> 
> 标签：java, session, openid, load-balancing, failover

我正在考虑使用 Java + Tomcat/JBoss 实现 OpenID 提供程序（'OP'）。

现在关于 OpenID 的关键之一是

1.  用户与 OP 和 RP 进行通信，并与两个站点进行会话。
2.  OP 和 RP 相互通信以确保用户没有伪造任何东西。

我找不到任何文档的一个主题是关于如何在负载平衡的情况下正确实现这一点的问题。

我担心的一般问题是 RP 连接到 OP 并最终在与用户不同的应用程序服务器上。

我的问题：

*   处理这个问题的正确方法是什么？
*   什么是“最好的” OpenID 库？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T17:07:11.933

> 我担心的一般问题是 RP 连接到 OP 并最终在与用户不同的应用程序服务器上。

将对话状态保存在共享存储中。即数据库或[分布式缓存](http://www.manageability.org/blog/stuff/distributed-cache-java)。缓存会更快，而且你不需要太多的持久性。

具有粘性会话的负载平衡（来自同一客户端的所有后续请求都到达同一服务器）将减少缓存更新的数量。

（我最初打算建议的群集 HTTP 会话不起作用，因为相同的会话分布在两个会话之间：用户会话和应用程序会话。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T22:18:12.640

在 OP 方面，真正需要在集群中的机器之间共享的唯一特定于 OpenID 的状态是关联（共享密​​钥及其句柄）。这是相当可缓存的；给定关联句柄的秘密永远不会改变，它们具有明确定义的生命周期，并且不应该有*那么*多。（也许，除非您使用一些使用无状态模式的大容量 RP。）

根据您的功能集和用户界面，用户可能会有一些其他会话状态，但这不需要应用于直接 RP-OP 通信，您可以使用标准的技巧包。

# asp.net - 会话变量成员？

> ID：940282
> 
> 赞同：2
> 
> 时间：2009-06-02T15:41:51.823
> 
> 标签：asp.net, vb.net, session-variables

我正在使用其他人提供的已编译 .dll —— 我对此知之甚少，除了它有一个会话变量，我必须以一种对我来说很奇怪的方式访问它。不知道该怎么称呼它——已经用谷歌搜索了我认为可能是正确的词，但到目前为止还没有成功。这是它的样子：

会话（“收据”）.用户名

这是我不明白的 .username 部分。它是什么？它是如何创建的？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T15:44:52.600

Session 可能是一个全局对象，它有一个返回 SessionItem 对象的默认属性。SessionItem 对象由 Session 对象从浏览器会话（可能）加载。SessionItem 对象有一个属性用户名，它是存储在浏览器会话中某处的值。

一些代码来清理事情：

```
Public Class Session
    Private Items As SessionItemCollection

    Default Public ReadOnly Property SessionItem(ByVal id As String) As Object
        Get
            Return Me.Items.Find(id)
        End Get
    End Property
End Class 
```

然后你调用代码（它在 SessionItemCollection Items from Session 中搜索“receipt”项目）：

```
Session("receipt") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:46:08.280

我的第一个猜测（因为没有太多其他代码可以使用）是存储在会话变量中并通过它访问的对象`Session("receipt")`是一个包含`username`您以这种方式访问​​的称为属性或成员的类。

基本思想是，`Session("receipt")`无论这个对象是什么（为了说明起见，我们会说它是一个收据对象），它都将拉回该收据对象`.username`的用户名属性。

# iphone - iPhone 和 iPod 模拟器

> ID：940286
> 
> 赞同：6
> 
> 时间：2009-06-02T15:43:31.103
> 
> 标签：iphone

我打算为 iPod 和 iPhone 编写一些代码。所以，我正在为这些设备寻找模拟器。

基本上是一个模拟器，可以帮助我测试我正在编写的应用程序。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T15:51:06.860

要开发 iPhone 应用程序，您需要下载 iPhone SDK。这包括用于编写应用程序的工具和库以及用于测试代码的模拟器。此工具仅适用于英特尔 mac。

您可以在这里免费获得 sdk：http: [//developer.apple.com/iphone/](http://developer.apple.com/iphone/)

要在真正的 iPhone 中测试您的代码，您需要加入 iPhone 开发者计划 ( [http://developer.apple.com/iphone/program/](http://developer.apple.com/iphone/program/) )，该计划不是免费的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T15:50:55.207

您是在谈论为您的网站编写应用程序或编写代码以在 iPhone 上正确显示吗？

前者需要向 Apple 订阅开发人员才能访问他们的 SDK 和模拟器。

对于后者，似乎有几个模拟器可以测试您的网站，请查看：

*   [http://iphonetester.com/](http://iphonetester.com/)
*   [http://www.testiphone.com/](http://www.testiphone.com/)

谷歌搜索“iPhone 模拟器”应该会为您找到很多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T15:51:26.907

iPhone SDK 附带一个 iPhone 模拟器，您可以在开发期间与 Xcode 一起使用。

[您可以从http://developer.apple.com/iphone](http://developer.apple.com/iphone/)下载 SDK - 您需要成为注册的 iPhone 开发人员，不过，虽然这是免费的，但之后您可以使用模拟器。

请注意，如果您想将应用程序发送到物理设备，您需要注册[iPhone 开发者计划](http://developer.apple.com/iPhone/program/)，起价为 99 美元。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T16:45:57.980

你可能真的想为此买一部 iPhone。您必须注册 99 美元，然后您才能将应用程序上传到您的 iPhone/pod。

您还可以越狱您的手机/吊舱并做任何您想做的事情。

还有一些应用程序可以让您在应用程序商店中将内容传输到您的手机或从您的手机传输（如果我没记错的话，至少有一个免费）

如果您想对文件做更多的事情而不仅仅是将它们传输到手机/pod，那么您很可能无论如何都必须越狱您的手机/pod。

我一直想找到一个更好的输入 iPod/iPhone 的缩写。iP（od/hone）怎么样？嗯，不是更好！

# sql - 如何在 ColdFusion 中覆盖 SQL 清理

> ID：940287
> 
> 赞同：5
> 
> 时间：2009-06-02T15:43:59.187
> 
> 标签：sql, coldfusion, sanitization, cfquery

我有清理一堆旧的 ColdFusion 代码的不幸任务。查询无处不在，我正在努力将它们全部转移到常见的 CFC 以便于维护。

我遇到了一个问题，因为`cfquery`它会自动将单引号转换为双单引号。我怎样才能覆盖这种行为？

更具体的信息如下。

* * *

所以这是我开始的查询：

```
<cfquery name="getObjectInfo" datasource="#BaseDS#">
  SELECT groupName AS lastname, '[Group]' AS firstname
  FROM   groups
  WHERE  groups.group_id = #objectreference_id#
</cfquery> 
```

这里奇怪的是，一个文字被“选择”了，因为我们希望它显示的方式（同样，我没有写这个，我只是想把它清理一下）。所以在普通函数中，select子句有一个可选参数：

```
 <cffunction name="fSelGroup" access="public" returntype="query"
              hint="Returns query selecting given group.">

    <cfargument name="intGroupID" type="numeric" required="true"
                hint="ID of group to be returned." />
    <cfargument name="strSelectAttributes" type="string" required="false"
                hint="Attributes to be selected in query"
                default="*" />

    <cfquery name="getObjectInfo" datasource="#Application.DataSource#">
      SELECT #Arguments.strSelectAttributes#
      FROM   Groups
      WHERE  Group_ID = #Arguments.intGroupID#
    </cfquery>

    <cfreturn getObjectInfo />

  </cffunction> 
```

**这是问题**：当我传入`"GroupName AS LastName, '[Group]' AS FirstName"`strSelectAttributes 参数时，发送到数据库的查询是：

```
SELECT GroupName AS LastName, ''[Group]'' AS FirstName
FROM   Groups
WHERE  Group_ID = 4 
```

你看，我的报价被“清理”成无效的查询。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-02T15:52:53.723

ColdFusion 不会转义*所有*单引号，而只会转义那些通过变量插值到达查询的单引号。这是罪犯：

```
SELECT #Arguments.strSelectAttributes# 
```

这通常是一件有用的事情，也是抵御 SQL 注入攻击的一小道防线。所以第一条规则是（这里和其他地方）：不要从变量构建你的 SQL 字符串。

如果您*确实必须*使用变量来构建 SQL 字符串，尽管有所有可能的负面影响，请使用以下`PreserveSingleQuotes()`函数：

```
SELECT #PreserveSingleQuotes(Arguments.strSelectAttributes)# 
```

此函数阻止 ColdFusion 自动转义单引号。

顺便说一句，任何其他函数调用都会做同样的事情。尝试：

```
SELECT #LCase(Arguments.strSelectAttributes)# 
```

这意味着 PreserveSingleQuotes() 实际上只是一个将字符串转换为函数结果的空操作，从而防止发生自动变量插值例程。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-02T16:00:03.787

在您的变量周围调用 preserveSingleQuotes()。它专门用于编写动态 SQL。另外，你真的，真的应该使用 cfqueryparam 作为你的值，我希望你以某种方式清理你的输入，以便 arguments.strSelectAttributes 不能包含类似 ';drop table groups; 在里面。

```
<cfquery name="getObjectInfo" datasource="#Application.DataSource#">
  SELECT #preserveSingleQuotes(Arguments.strSelectAttributes)#
  FROM   Groups
  WHERE  Group_ID = <cfqueryparam value="#Arguments.intGroupID#" cfsqltype="cf_sql_integer"/>
</cfquery> 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-07-17T15:52:39.367

如果您真的想清理代码，第二步是将意大利面条转换为存储过程。

# google-maps - 是否可以更改谷歌地图给出的路线

> ID：940288
> 
> 赞同：2
> 
> 时间：2009-06-02T15:44:00.840
> 
> 标签：google-maps, customization

我正在写一个谷歌地图混搭。我问谷歌从一个位置到另一个位置的路径。谷歌地图给了我一张带有路线的地图。我想以某种方式采用这条路线并在地图中显示之前对其进行修改（添加或删除点）。是否可以？你会怎么做？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T15:54:51.633

根据[Google Maps API Reference](http://code.google.com/apis/maps/documentation/reference.html#GDirections)，有一个 loadFromWaypoints 函数，它将获取数组中的航点并使用它们来计算方向。

编辑：炮弹+1。他说的。

# django - 在管理通用内联表单中创建新的通用相关对象的问题

> ID：940289
> 
> 赞同：0
> 
> 时间：2009-06-02T15:44:04.410
> 
> 标签：django, django-admin, django-forms

我对管理通用内联表单有奇怪的问题。我有两个模型，主项目和通过VideoLink具有**多对多关系的视频，因为我需要能够将不同数量的视频链接到项目，并将许多项目链接到视频：**

```
class VideoLink(models.Model):
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = generic.GenericForeignKey('content_type', 'object_id')
    video = models.ForeignKey(Video)

class Project(models.Model):
    name = models.CharField(max_length=50)
    image_set = generic.GenericRelation('Image') 
```

我没有在这里展示视频模型，但这对我的问题并不重要。

我所需要的只是以两种方式定义链接​​到主对象（项目）的新相关对象（VideoLink）：

*   在管理内联表单中选择视频（这很好用！）
*   在假 video_url 字段中定义新视频的 URL，创建新的 Video 对象并在主（项目）和新（视频）对象之间创建新的 VideoLink 对象。

对于第二种情况，我需要设置中间功能。它将处理新视频的 url（如[http://www.youtube.com/watch?v=WIXVzeB0DUo](http://www.youtube.com/watch?v=WIXVzeB0DUo)），创建新的 Video 对象并将其与 youtube.com 同步。我认为最好的方法 - 将其放入 AdminVideoLink 的表单*清理方法*中，对吗？

所以，我写了这段代码：

```
class VideoForm(forms.ModelForm):

    # new field for absolute video urls
    video_url = forms.CharField()

    def clean(self):
        cleaned_data = self.cleaned_data
        if not cleaned_data.get('id') and not cleaned_data.get('video') and cleaned_data.get('video_url'):
            ... some extra functionality:
            1) get id from video_url
            2) create new Video object with id
            3) define cleaned_data['video'] = <Video object>
             ....  

        return cleaned_data

class VideoInline(generic.GenericTabularInline):
    model = VideoLink
    form = VideoForm

class ProjectAdmin(admin.ModelAdmin):
    inlines = [VideoInline] 
```

但是每次保存表单后，我都会在管理内联表单中看到错误：近选择带有视频对象 - “需要字段”（我的翻译）。但是我在我的 clean 方法中设置了这个字段。我检查了一下：self.cleaned_data['video'] 包含我刚刚创建和同步的新 Video 对象。

*还有一个很奇怪的问题：我在这个干净*的方法中找不到父实例（主项目对象）。如果我使用简单的 ManyToMany 对象（没有通用关系和 generic.GenericTabularInline 表单）做同样的事情，我会在我的内联表单中看到 video 和 project 字段，但在一般情况下我没有。

我检查了相关[帖子](https://stackoverflow.com/questions/467985/adding-a-generic-image-field-onto-a-modelform-in-django)，但没有找到答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T14:56:32.923

解决这个问题很简单，只需在内联表单中添加*required=False即可：*

```
class VideoForm(forms.ModelForm):

    video_url = forms.CharField(required=False, widget=AdminVideoPreviewWidget())

    def __init__(self, *args, **kwargs):
        super(VideoForm, self).__init__(*args, **kwargs)
        self.fields['video'].required = False

    .... 
```

有了它，我可以在创建和同步新的 Video 对象后手动填充视频字段。

# c# - 如何在 IE 中使用 asp.net 和 C# 在页面加载时更改图像的 ImageUrl 属性

> ID：940293
> 
> 赞同：3
> 
> 时间：2009-06-02T15:44:38.623
> 
> 标签：c#, asp.net, internet-explorer, image

我的主页上有链接，可能有也可能没有相关的附件。如果链接有附件，则会在链接旁边放置一个图标。仅当链接具有附件时，该图标才会出现。

```
protected void Page_Load(object sender, EventArgs e)
    {
        foreach (Image pic in imgAttachment)
            {
                 int type = ds.Current_Events[index].AttachmentID;
                 //ds is the dataset 
```

foreach 循环遍历主页上的每个“当前事件”图片，然后获取与每个链接关联的附件类型，即 AtachmentID。AttachmentID 可以是 0、1、2 或 3，分别表示没有附件、附加照片、附加视频或附加文档。

然后使用 switch 语句将 ImageUrl 属性更改为相应的图片。

```
 switch (type)
                     {
                            case 0:
                                break;
                            case 1:
                                pic.ImageUrl = "images/eventicons/Photo.jpg";
                                //changed from just "Photo.jpg"
                                break;
                            case 2:
                                pic.ImageUrl = "images/eventicons/Video.jpg";
                                //changed from just "Video.jpg"
                                break;
                            case 3:
                                pic.ImageUrl = "images/eventicons/Doc.jpg";
                                //changed from just "Doc.jpg"
                                break;
                            default:
                                pic.Visible = false;
                                break;
                      }
                  index++;
            }
    } 
```

该图像不会在 IE 中加载，但它确实适用于 Firefox。

下面是aspx前面

```
<div>
  <ul>
   <li>
      <asp:HyperLink ID="lblEvent1" runat="server">              
           <img src="images/bar_blank.gif" />
      </asp:HyperLink>
      <asp:Image ID="Image1" runat="server" />
   </li>
   <li>
      <asp:HyperLink ID="lblEvent2" runat="server">
           <img src="images/bar_blank.gif" />
      </asp:HyperLink>
      <asp:Image ID="Image2" runat="server" />
   </li>
  </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:47:49.450

您应该添加图像的完整路径。代替

```
pic.ImageUrl = "Photo.jpg"; 
```

你可以这样做让 ASP.Net 也写出照片的路径......

```
pic.ImageUrl = "~/MyImagePath/Photo.jpg"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:59:13.643

我解决了这个问题。

我使用的图片将近500kb。我假设图片的磁盘空间很小，因为图像本身很小，但事实并非如此。我调整了图像的大小并将它们缩小到 40kb 左右。图像现在加载到 ie 中。

因此，如果您在页面加载期间更改asp.net 中图像控件的ImageUrl 并且您指向的图像文件很大（500kb），这似乎存在问题。

解决方案是通过调整图片大小、使其成为 gif 等来使图片本身占用更少的磁盘空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T16:59:19.430

从您的代码生成的 html 代码是什么样的？您能否发布此内容，因为 IE 和 firefox 根据您引用图像的方式呈现图像的方式存在已知问题。很高兴看到渲染以及背后的代码。

# windows - 如何配置 Windows explorer.exe

> ID：940302
> 
> 赞同：0
> 
> 时间：2009-06-02T15:46:15.440
> 
> 标签：windows, profiling

对于 Explorer.exe 分析，您会推荐什么工具/技术？

主要在 Windows XP / x86...

为避免混淆，这不是一个系统问题。想象一下，您已经开发了一个 BHO 或其他 shell 扩展，并且您必须对其进行概要分析。

目前，我正在使用[AMD CodeAnalyst](http://developer.amd.com/cpu/CodeAnalyst/Pages/default.aspx)，但我正在寻找更适合目的的东西。

干杯，斯特凡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T15:48:32.367

这属于 serverfault.com，是吗？

尝试进程资源管理器： [http ://technet.microsoft.com/en-us/sysinternals/bb896653.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T02:57:42.293

如果您使用的是 Vista，那么 XPerf 是 Microsoft 用来测试应用程序性能的工具。

# mfc - MFC 对话框应用程序的布局管理器

> ID：940303
> 
> 赞同：9
> 
> 时间：2009-06-02T15:46:18.467
> 
> 标签：mfc

MFC 应用程序有哪些好的布局管理器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T17:06:01.967

对于 MFC 对话框，请查看[ResizableLib](http://sourceforge.net/projects/resizablelib/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T21:51:00.733

我多年来一直在使用[http://www.codeproject.com/KB/dialog/layoutmgr.aspx](http://www.codeproject.com/KB/dialog/layoutmgr.aspx)，它很棒。我还没有发现无法使用此类完成特定布局的情况。我唯一“想念”的是视觉布局设计师，但我不认为有一个布局管理器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-19T23:04:55.613

具有锚属性的 MFC 调整大小

[http://www.codeproject.com/KB/dialog/WndResizer.aspx](http://www.codeproject.com/KB/dialog/WndResizer.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-04T09:44:41.043

我发现了这个： http: [//www.codeproject.com/KB/MFC/UltimateToolbox_Layout.aspx](http://www.codeproject.com/KB/MFC/UltimateToolbox_Layout.aspx)

我正在寻找同样的东西。我怀疑微软永远不会想出任何像林间空地一样好的东西。为 Windows 开发确实很糟糕。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-20T07:36:34.017

我已经多次使用这个**CSizingDialog**类：

[http://www.codeproject.com/Articles/11538/Resize-Reposition-the-Controls-in-a-Dialog-at-your](http://www.codeproject.com/Articles/11538/Resize-Reposition-the-Controls-in-a-Dialog-at-your)

但是，您是否知道在**Visual Studio 2015**中您可以使用**资源编辑器**本身来管理控件大小调整？这个概念很难理解，但是当你正确使用它时，你不需要额外的布局管理器。

# web-services - 使用 Reporting Services Web 服务，您如何获得特定用户的权限？

> ID：940304
> 
> 赞同：4
> 
> 时间：2009-06-02T15:46:18.687
> 
> 标签：web-services, reporting-services, permissions

使用`SQL Server Reporting Services Web Service`，我如何确定特定域用户对特定报告的权限？有问题的用户不是访问 Web 服务的用户。

我正在使用`MYDOMAIN\SSRSAdmin`具有完全权限的域服务帐户（比如说 ）访问 Web 服务`SSRS`。`MYDOMAIN\JimBob`我想以编程方式查找特定报告的域用户（比如说）的权限。

Web 服务上的`GetPermissions()`方法将返回**当前用户**拥有的权限列表 ( `MYDOMAIN\SSRSAdmin`)，但这不是我想要的。如何获得相同的权限列表`MYDOMAIN\JimBob`？我不会拥有用户的域密码，因此不能使用他们的凭据调用该`GetPermissions()`方法。但是，我是从具有完全权限的帐户访问它的，因此我认为理论上应该可以使用该信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T06:08:58.627

SSRS 从用户的 NT 登录令牌中获取 NT 组。这就是为什么当您被添加到新组时，您需要注销并重新登录。这同样适用于大多数 Windows 检查（SQL Server、共享、NTFS 等）。

如果您知道 NT 组...

您可以直接查询 ReportServer 数据库。我几乎直接从我们用来检查文件夹安全性（C.Type = 1）的一份报告中删除了这一点。过滤 U.UserName。

```
SELECT
    R.RoleName,
    U.UserName,
    C.Path
FROM
    ReportServer.dbo.Catalog C WITH (NOLOCK)    --Parent
    JOIN
    ReportServer.dbo.Policies P WITH (NOLOCK) ON C.PolicyID = P.PolicyID
    JOIN
    ReportServer.dbo.PolicyUserRole PUR WITH (NOLOCK) ON P.PolicyID = PUR.PolicyID 
    JOIN
    ReportServer.dbo.Users U WITH (NOLOCK) ON PUR.UserID = U.UserID 
    JOIN
    ReportServer.dbo.Roles R WITH (NOLOCK) ON PUR.RoleID = R.RoleID
WHERE
    C.Type = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T18:27:39.593

查看“GetPolicies Method”，您可以在以下链接中看到。

[http://msdn.microsoft.com/en-us/library/reportservice2010.reportingservice2010.getpolicies.aspx](http://msdn.microsoft.com/en-us/library/reportservice2010.reportingservice2010.getpolicies.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-17T14:26:24.367

希望这会让你开始。我在复制文件夹结构时使用它，当我想将我的 SSRS 项目从源服务器“迁移”到目标服务器时，我会使用它从旧服务器向新服务器报告。在我将项目从源服务器复制到目标服务器之后，在一台服务器上获取项目的安全策略，然后在另一台服务器上为相同项目设置安全策略是一种方法。您必须设置自己的源和目标服务器名称。

```
using System;

using System.Collections.Generic;
using System.Diagnostics;
using System.Web.Services.Protocols;    //<=== required for SoapException

namespace SSRS_WebServices_Utility
{
internal static class TEST
{

    internal static void GetPoliciesForAnItem_from_Source_ThenSetThePolicyForTheItem_on_Destination(string itemPath)
    {

        string sSourceServer = "SOURCE-ServerName";
        Source_ReportService2010.ReportingService2010 sourceRS = new Source_ReportService2010.ReportingService2010();
        sourceRS.Credentials = System.Net.CredentialCache.DefaultCredentials;
        sourceRS.Url = @"http://" + sSourceServer + "/reportserver/reportservice2010.asmx";

        string sDestinationServer = "DESTINATION-ServerName";
        Destination_ReportService2010.ReportingService2010 DestinationRS = new Destination_ReportService2010.ReportingService2010();
        DestinationRS.Credentials = System.Net.CredentialCache.DefaultCredentials;
        DestinationRS.Url = @"http://" + sDestinationServer + "/reportserver/reportservice2010.asmx";

        Boolean val = true;
        Source_ReportService2010.Policy[] curPolicy = null;
        Destination_ReportService2010.Policy[] newPolicy = null;
        try
        {

            curPolicy = new Source_ReportService2010.Policy[1];
            curPolicy = sourceRS.GetPolicies(itemPath, out val);        //e.g. of itemPath:  "/B2W/001_OLD_PuertoRicoReport"

            //DestinationRS.SetPolicies(itemPath, newPolicy);
            int iCounter = 0;
            //int iMax = curPolicy.Length;

            newPolicy = new Destination_ReportService2010.Policy[curPolicy.Length];
            foreach (Source_ReportService2010.Policy p in curPolicy)
            {
                //create the Policy
                Destination_ReportService2010.Policy pNew = new Destination_ReportService2010.Policy();
                pNew.GroupUserName = p.GroupUserName;
                pNew.GroupUserName = p.GroupUserName;
                Destination_ReportService2010.Role rNew = new Destination_ReportService2010.Role();
                rNew.Description = p.Roles[0].Description;
                rNew.Name = p.Roles[0].Name;

                //create the Role, which is part of the Policy
                pNew.Roles = new Destination_ReportService2010.Role[1];
                pNew.Roles[0]=rNew;
                newPolicy[iCounter] = pNew;
                iCounter += 1;

            }

            DestinationRS.SetPolicies(itemPath, newPolicy);

            Debug.Print("whatever");

        }
        catch (SoapException ex)
        {

            Debug.Print("SoapException: " + ex.Message);

        }
        catch (Exception Ex)
        {
            Debug.Print("NON-SoapException: " + Ex.Message);

        }

        finally
        {
            if (sourceRS != null)
                sourceRS.Dispose();
            if (DestinationRS != null)
                DestinationRS.Dispose();                    

        }
    }

} 
```

}

要调用它，请使用以下命令：

```
 TEST.GetPoliciesForAnItem_from_Source_ThenSetThePolicyForTheItem_on_Destination("/FolderName/ReportName"); 
```

您必须在其中放置您自己的 SSRS 文件夹名称和报告名称，即项目的路径。

事实上，我使用了一种方法，它遍历 Destination 文件夹中的所有项目，然后调用如下方法：

```
 internal static void CopyTheSecurityPolicyFromSourceToDestinationForAllItems_2010()
    {
        string sDestinationServer = "DESTINATION-ServerName";

        Destination_ReportService2010.ReportingService2010 DestinationRS = new Destination_ReportService2010.ReportingService2010();
        DestinationRS.Credentials = System.Net.CredentialCache.DefaultCredentials;
        DestinationRS.Url = @"http://" + sDestinationServer + "/reportserver/reportservice2010.asmx";

        // Return a list of catalog items in the report server database
        Destination_ReportService2010.CatalogItem[] items = DestinationRS.ListChildren("/", true);

        // For each FOLDER, debug Print some properties
        foreach (Destination_ReportService2010.CatalogItem ci in items)
        {
            {
                Debug.Print("START----------------------------------------------------");
                Debug.Print("Object Name:         " + ci.Name);
                Debug.Print("Object Type:         " + ci.TypeName);
                Debug.Print("Object Path:         " + ci.Path);
                Debug.Print("Object Description:  " + ci.Description);
                Debug.Print("Object ID:           " + ci.ID);
                Debug.Print("END----------------------------------------------------");
                try
                {
                    GetPoliciesForAnItem_from_Source_ThenSetThePolicyForTheItem_on_Destination(ci.Path);
                }
                catch (SoapException e)
                {
                    Debug.Print("SoapException START----------------------------------------------------");
                    Debug.Print(e.Detail.InnerXml);
                    Debug.Print("SoapException END----------------------------------------------------");

                }
                catch (Exception ex)
                {
                    Debug.Print("ERROR START----------------------------------------------------");
                    Debug.Print(ex.GetType().FullName);
                    Debug.Print(ex.Message);
                    Debug.Print("ERROR END----------------------------------------------------");
                }
            }
        }
    } 
```

# sql - 如何访问使用 ADO.NET 事务插入的数据？

> ID：940311
> 
> 赞同：0
> 
> 时间：2009-06-02T15:47:56.237
> 
> 标签：sql, sql-server-2005, ado.net, transactions

我正在尝试通过 ADO.NET 事务获取已成功输入数据库的数据。

一旦你调用了 trans.Commit() ，似乎没有办法取回已提交的数据，因为在事务期间创建的所有身份列都是“虚拟的”，因为它是一个离线数据集，直到提交

非常感谢

[编辑]

啊，问题是，我无法重新选择，因为除了作为交易的一部分插入的数据的身份之外，我没有任何独特的选择。

我无法获取最后输入的项目，因为这是一个多用户系统

书中的代码示例，不是有问题的代码，但足以说明我需要什么：

```
using System.Data;
using System.Data.SqlClient;

namespace DataAdapterTransaction
{
    class Program
    {
        private static string sqlConnectString = "Data Source=(local);" +
            "Integrated security=SSPI;Initial Catalog=AdoDotNet35Cookbook;";

        private static string sqlSelect = "SELECT * FROM DataAdapterTransaction";

        static void Main(string[] args)
        {
            object[,] o1 = {{ "1", "field 1.1", "field 2.1" },
                          { "2", "field 1.2", "field 2.2" }};
            InsertRecords(o1);

            object[,] o2 = {{ "3", "field 1.3", "field 2.3" },
                           { null, "field 1.4", "field 2.4" }};
            InsertRecords(o2);

            // Retrieve and output the contents of the table
            SqlDataAdapter daRead = new SqlDataAdapter(sqlSelect, sqlConnectString);
            DataTable dtRead = new DataTable( );
            daRead.Fill(dtRead);
            Console.WriteLine("---TABLE DataAdapterTransaction---");
            foreach (DataRow row in dtRead.Rows)
                Console.WriteLine("Id = {0}\tField1 = {1}\tField2 = {2}",
                    row["Id"], row["Field1"], row["Field2"]);

            Console.WriteLine("\nPress any key to continue.");
            Console.ReadKey( );
        }

        static void InsertRecords(object[,] o)
        {
            DataTable dt = new DataTable( );
            SqlTransaction tran;

            SqlConnection connection = new SqlConnection(sqlConnectString);

            // Create a DataAdapter
            SqlDataAdapter da = new SqlDataAdapter(sqlSelect, connection);
            // Stop updating when an error is encountered for roll back.
            da.ContinueUpdateOnError = false;
            // Create CommandBuilder and generate updating logic.
            SqlCommandBuilder cb = new SqlCommandBuilder(da);
            // Create and fill a DataTable with schema and data
            da.Fill(dt);
            // Open the connection
            connection.Open( );
            // Begin a new transaction and assign it to the DataAdapter
            tran = connection.BeginTransaction( );
            da.SelectCommand.Transaction = tran;

            // Add two rows that will succeed update
            for (int i = 0; i <= o.GetUpperBound(0); i++)
            {
                dt.Rows.Add(new object[] { o[i, 0], o[i, 1], o[i, 2] });
                Console.WriteLine(
                    "=> Row with [Id = {0}] added to DataTable.", o[i, 0]);
            }

            Console.WriteLine("=> Updating data source using DataAdapter.");
            try
            {
                da.Update(dt);
                tran.Commit( );

                Console.WriteLine("\nTRANSACTION COMMIT.\n");
            }
            catch (Exception ex)
            {
                tran.Rollback( );
                Console.WriteLine("\nTRANSACTION ROLLBACK.\n{0}\n", ex.Message);
            }
            finally
            {
                connection.Close( );
            }
        }
    }
} 
```

好的，所以我要在事务提交之后，我想获得最后插入的行的（范围）身份。

作为事务的一部分，我的应用程序成功更新了三个数据适配器，但是我很难查看最终提交的数据。我可以选择表格并在其中查看它，但这对于生产代码来说确实不够好。

SC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:51:38.310

您可能只需要重新选择数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T20:19:11.980

联机丛书说您应该再次调用 Fill 以更新您的数据集：

[http://msdn.microsoft.com/en-us/library/33y2221y(VS.71).aspx](http://msdn.microsoft.com/en-us/library/33y2221y(VS.71).aspx)

我通常设置我的插入和更新命令，以便它们为我的 DataTable 返回一个有效的 DataRow 并以这种方式控制应用程序中行的更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T05:28:12.637

对，所以我应该这样做：

```
// update datatable
da.Update(dt);
// commit updates
tran.Commit( );
// get the updated datatable
da.Fill(dt); 
```

我假设所有的身份列都会被更新。

我会试一试

SC

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T05:36:36.993

我了解您正在使用身份列，但数据中是否有任何自然键可用于重新选择？

（然后提出了“为什么使用身份”的问题，但那是另一个主题……）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T06:17:56.350

不幸的是，不，我无法使用自然键重新选择......我被身份困住了......经过 8 小时的头部撞击后，我考虑添加一个 guid 字段以便我可以让它工作，但认为这违反了我的原则放弃！

SC

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T06:33:33.000

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ks9f57t0.aspx)介绍了在调用 DataAdapter 的 Update 方法时如何取回标识值。

# cakephp - 在 CakePHP 中处理别名 URL

> ID：940326
> 
> 赞同：1
> 
> 时间：2009-06-02T15:50:59.340
> 
> 标签：cakephp, routes

我正在用 cakephp 重写我们公司的网站，需要找到一种方法来执行以下操作：

1.  用户使用为特定媒体广告（杂志、网络推广等）预先生成的促销别名 URL 之一进入我们的网站
2.  根据别名 URL 数据库检查 URL，如果存在别名，则将特定跟踪代码写入会话中。

我考虑了几种选择，但似乎都不适合此目的。他们是：

1.  将查找脚本放在 appcontroller 的 beforeFilter() 中，使其包含在每个控制器中。（写入一个会话值，因此它只执行一次。）
    *   此选项仅适用于现有控制器，如果 URL 不存在，则会给出 Cake 'missing controller' 错误。
2.  Routes.php 中每个别名的特定路由 - 可以通过管理界面定期添加/删除数百个别名 url。
3.  将所有站点 URL 路由到它们自己的操作，并为映射到我的查找脚本的别名 URL 设置“其他所有”规则。- 凌乱，我失去了内置的蛋糕路由。
4.  自定义 404。-我不想为这些 url 返回 404，因为我觉得这是不好的做法，除非它们真的没有映射到任何东西。

我真的可以在应用程序流程中放置一个可以放置此查找/跟踪脚本的位置，而且我对蛋糕还很陌生，所以我很难过。

编辑：另外，我知道一个名为 say 'promo' 的子文件夹很容易做到这一点，但我有很多来自旧站点的旧 URL，也需要处理。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T07:21:36.353

注意：我假设您的促销网址是“domain.com/advert-259”或类似的形式（即没有“domain.com/adverts/advert-259 **”**）。那只是太简单 ：）

希望您可以使用带有一些正则表达式的路由。将此添加到您的 /config/routes.php 并让我知道不同的正则表达式是否有帮助:)

```
$controllers = Configure::listObjects('controller');

foreach ($controllers as &$value)
{
    $value = Inflector::underscore($value);
}

Router::connect('/:promo', array('controller' => 'promos', 'action' => 'process'), array('promo' => '(?!('.implode('|', $controllers).')\W+)[a-zA-Z\-_]+/?$')); 
```

现在您可以在`PromosController::process()`.

基本上，它会检查 url 中的促销代码，*不包括*$controllers 数组中的促销代码（即您的常规路线不会被弄乱）。

稍后您可能需要考虑`Configure::listObjects()`根据应用程序的速度和您的要求缓存 的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:00:38.720

一个非常有趣的问题。我想我会使用第 3 项。它并没有那么*混乱*——毕竟，这通常是由我的东西中的页面控制器处理的。这就是我处理它的方式 - 在 routes.php 中硬编码你的路由到你的控制器，然后有一个 matchall 路由适用于你的促销代码。这使您可以保留旧版 URL，并使用许多标准蛋糕的东西（您可能只需要明确说明每个控制器路由，而不是这样的苦差事……）此外，它还可以让您做一些带有 404 错误的很酷的东西——您可以在其中放置一些逻辑来尝试找出他们试图去哪里，这样您就可以为您的 404 提供超级强大的功能。

# jquery - 通过 CSS 用框包围 ValidationSummary

> ID：940335
> 
> 赞同：8
> 
> 时间：2009-06-02T15:52:21.837
> 
> 标签：jquery, asp.net-mvc, css, validation, html-helper

默认情况下 Html.ValidationSummary() 生成如下 HTML：

```
<span class="validation-summary-errors">There were some errors...</span>
<ul class="validation-summary-errors">
   <li>First Name too long</li>
   <li>Invalid Email Address</li>
</ul> 
```

我想选择整个验证摘要并通过 CSS 在其周围添加一个边界框，所以我添加了一个这样的 CSS 类：

```
.validation-summary-errors{
background-color:#D9FFB2;
border: 1px solid #5CBA30;
color:#000000;
margin-top:15px;
margin-bottom:15px;
} 
```

现在的问题是，这会在验证摘要消息和每个错误消息周围绘制单独的框。当然不是我想的那样。

我可以像这样在摘要周围添加一个 div，但是如果没有验证错误，这将导致一个空的红色框，所以这不是方法：

```
 <div class="my-validation-summary">
        <h2>
            <%=Model.Message%>
        </h2>
        <%= Html.ValidationSummary("There were some errors...")%>
    </div> 
```

我可以想到几种方法来解决这个问题：

*   使用服务器端标签有条件地添加边界 div
*   通过 jQuery 添加边界 div
*   编写我自己的 HtmlHelper 包装器，打印 CSS 友好的 ValidationSummary

然而，对于解决这样一个简单的任务，所有这些看起来都非常尴尬。必须有更好的方法来做到这一点。也许其他一些编写 CSS 类的方式，所以当没有验证摘要时我不会得到一个空框？

**编辑：**为了澄清，我这样调用 html 助手：

```
<%=Html.ValidationSummary("There were some errors...") %> 
```

**编辑2：**这个问题的范围是看看我是否忽略了一些非常简单和明显的东西。看来我没有，所以我将简单地添加适合我需要的自己的 HtmlHelper 函数。我投票结束我自己的问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T16:13:13.927

这是一些可以工作的CSS：

```
.validation-summary-errors {
    background-color: #D9FFB2;
    border:1px solid #5CBA30;
    width: 400px;
    }
span.validation-summary-errors {
    border-bottom-color: #D9FFB2;
    display:block;
    }
ul.validation-summary-errors {
    margin:0;
    padding:0;
    border-top:none;
    } 
```

您可能需要根据您的其他 css 来调整宽度。

*评论后编辑*

我将 ul.validation-summary-errors 更改为将边距和填充归零并删除了宽度。它现在应该可以跨浏览器工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:22:29.993

如果您有一个像您提供的第二个代码示例一样的包装 div。然后很容易使用 jQuery 将错误类从 span & ul 中“移动”到外部 div。

```
<html>
<head>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
  <script type="text/javascript">
    $(function() {
      var className = "validation-summary-errors";
      $("." + className).removeClass(className).closest("div").addClass(className);
    });
  </script>
  <style type="text/css">
    .validation-summary-errors { border: solid 1px red; },
  </style>
</head>

<body>
  <div>
    <h2>My Modal Message</h2>
    <span class="validation-summary-errors">There were some errors...</span>
    <ul class="validation-summary-errors">
      <li>First Name too long</li>
      <li>Invalid Email Address</li>
    </ul>
  </div>
</body>
</html> 
```

此代码将操纵 HTML 看起来像这样......

```
 <div class="validation-summary-errors">
    <h2>My Modal Message</h2>
    <span class="">There were some errors...</span>
    <ul class="">
      <li>First Name too long</li>
      <li>Invalid Email Address</li>
    </ul>
  </div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:39:14.183

如果我没看错，并且您只想要`span.validation-summary-errors`（而不是内部内容）上的边框，那么：

```
.validation-summary-errors     {border: 0 none transparent; /* set defaults for inner */
                               }

span.validation-summary-errors {background-color:#D9FFB2;   /* sets the span */
                               border: 1px solid #5CBA30;
                               color:#000000;
                               margin-top:15px;
                               margin-bottom:15px;
                               } 
```

应该这样做。

或者，可靠性稍差：

```
.validation-summary-errors     {background-color:#D9FFB2;
                               border: 1px solid #5CBA30;
                               color:#000000;
                               margin-top:15px;
                               margin-bottom:15px;
                               }

.validation-summary-errors > .validation-summary-errors,
.validation-summary-errors .validation-summary-errors
                               {border: 0 none transparent; /* should apply styles to */
                               }                            /* the children/descendants */
                                                            /* with the same name - untested though... */ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-01T20:07:14.767

另一个需要的解决方案。

```
@Html.ValidationSummary(false, "", new { @class = "***YOUR CSS CLASS***" }) 
```

# networking - 客户端将如何访问 Bugzilla 服务器？

> ID：940337
> 
> 赞同：1
> 
> 时间：2009-06-02T15:53:15.953
> 
> 标签：networking, client, bugzilla

我刚刚在我的笔记本电脑上安装了 Bugzilla，我将成为 Bugzilla 服务器。我想知道我的队友将如何访问 Bugzilla 服务器？我知道 Apache 是 Web 服务器，但你能指出我关于客户端如何访问服务器的参考吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:54:10.947

如果您的公司有您的笔记本电脑的 DNS 条目，您的用户将使用 Web 浏览器并将其指向 IP 地址或您的笔记本电脑或 DNS 名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T16:01:56.640

[在您提出的上一个stackoverflow](https://stackoverflow.com/questions/896616/how-does-a-bugzilla-server-work)问题中使用提供给您的链接。此外，这里是他们的[管理](http://www.bugzilla.org/docs/3.4/en/html/administration.html)文档页面的链接。

# asp.net - ASP.NET 列表框数据绑定到自定义对象列表。它是否保留实际对象？

> ID：940338
> 
> 赞同：0
> 
> 时间：2009-06-02T15:53:41.790
> 
> 标签：asp.net, data-binding, listbox

在 ASP.NET 中，我将一个列表框控件绑定到一个自定义类列表（由 TimeSpan 和 Int 成员组成）。ToString() 函数只是将它们都显示为一个长字符串。

现在我想再次将修改后的列表框保存到数据库中，我需要再次使用自定义类对象。

ListBox 是否在数据绑定后保存实际的自定义对象？还是只有字符串表示？

如果是这样，我如何从 LB 获得它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:18:13.493

将值创建到绑定到列表框的集合中后，您可以使用视图状态在回发之间保留它们。

例如

ViewState["TimespanItems"] = myListHere;

myListHere = (myListTypeHere) ViewState["TimespanItems"];

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T16:24:58.027

Googling doesn't seem to help much, but it seems to me that a databound ListBox contains objects called ListItems, which have a Text and a Value property. The databinding figures out which is which from your custom class and displays them.

Short answer: no, it does not look like the ListBox is storing the actual class.

# javascript - 是否可以找到与特定 HTML 片段相关联的 JavaScript 事件？

> ID：940339
> 
> 赞同：4
> 
> 时间：2009-06-02T15:53:52.587
> 
> 标签：javascript, firebug

我正在使用其他人的代码，我希望能够查看他们将哪些 JavaScript 绑定到页面上的特定按钮。有什么方法可以通过单击 FireBug 中的按钮或其他方式来查看正在触发的代码吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T15:55:14.207

试试[视觉事件](http://www.sprymedia.co.uk/article/Visual+Event)。这是一个小书签，它将突出显示页面中的所有元素以及绑定到它们的事件，并为您提供一个很好的小读数，了解每个元素绑定的内容。

# .net - DataGridView、DataTable、SqlDataAdapter 和 SqlCommandBuilder - 禁用删除

> ID：940348
> 
> 赞同：2
> 
> 时间：2009-06-02T15:55:59.230
> 
> 标签：.net, winforms, data-binding, datagridview, sqldataadapter

我有一个带有 DataGridView 表的 WinForm。它与 SqlDataAdapter 和 SqlCommandBuilder 一起绑定到 DataTable。禁用删除但允许选择、更新、插入的最佳方法（简单且易于管理）是什么？

我可以在网格上设置单行属性吗？这就是我更愿意这样做的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T16:01:58.543

可能最简单的做法是查看 DataGridView 上的属性并将 AllowUserToDeleteRow 更改为 false。

# c# - 关闭 WebBrowser 控件时应用程序冻结

> ID：940349
> 
> 赞同：1
> 
> 时间：2009-06-02T15:55:59.700
> 
> 标签：c#, winforms, mono, webbrowser-control

我是 WinForms 的新手，我正在尝试将`WebBrowser`GNU/Linux 上的控件与 Mono 一起使用。它运行良好，但是当我关闭表单时会收到奇怪的警告，并且当我尝试创建另一个包含`WebBrowser`.

事实上，我可以启动任意数量的浏览器，直到我关闭一个。然后，如果我创建一个新的应用程序冻结。

这是一个示例代码：

```
 public class TestForm : Form
 {
   Button button = new Button();

   public TestForm()
   {
     button.Parent = this;
     button.Text = "Run browser";
     button.Click += button_Click;
   }

   [STAThread]
   public static void Main()
   {
     Application.Run(new TestForm());
   }

   public void button_Click(object sender, EventArgs e)
   {
     new MyBrowser("www.google.com").Show();
   }
 }

 class MyBrowser : Form
 {
   WebBrowser browser = new WebBrowser();

   public MyBrowser(string url)
   {
     browser.Parent = this;
     browser.Dock = DockStyle.Fill;
     browser.Navigate(url);
   }
 } 
```

以下是我收到的警告：

```
 (essai.exe:9108): Gdk-WARNING **: GdkWindow 0x2800094 unexpectedly destroyed

 (essai.exe:9108): Gdk-WARNING **: GdkWindow 0x2800093 unexpectedly destroyed

 (essai.exe:9108): Gdk-WARNING **: GdkWindow 0x280007e unexpectedly destroyed

 (essai.exe:9108): Gdk-WARNING **: GdkWindow 0x280007d unexpectedly destroyed

 (essai.exe:9108): Gdk-WARNING **: GdkWindow 0x280001c unexpectedly destroyed

 (essai.exe:9108): Gdk-WARNING **: GdkWindow 0x280001b unexpectedly destroyed

 (essai.exe:9108): Gdk-WARNING **: GdkWindow 0x280001a unexpectedly destroyed

 (essai.exe:9108): Gdk-WARNING **: GdkWindow 0x2800016 unexpectedly destroyed 
```

所以我的问题是：我做错了什么？问题是否可能来自 Mono？

* * *

**更新**：在 Windows 上，如果我添加`[STAThread]`before`Main`的定义，它就可以工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T13:43:37.283

Mono 的 WebBrowser 控件存在一些已知问题。尝试在单站点中找到 mwf-DESIGNER。

# c# - 两次接收相同的 MSMQ 消息？

> ID：940351
> 
> 赞同：0
> 
> 时间：2009-06-02T15:56:55.800
> 
> 标签：c#, .net, msmq, message-queue

我有一个基于 MSMQ 的系统，它具有相互通信的三层。为简单起见，我将它们称为第 1、2 和 3 层。它们的位置如下：

```
Layer 1 <-> Layer 2 <-> Layer 3 
```

因此，第 1 层仅与第 2 层对话，第 3 层仅与第 2 层对话，第 2 层与其他两个对话。我有四个队列，

```
Layer1_in
Layer1_out
Layer3_out
Layer3_in 
```

各层通过此基础设施进行通信：

```
Layer 1 -> Layer1_out -> Layer 2
Layer 1 <- Layer1_in <- Layer 2
Layer 3 -> Layer3_out -> Layer 2
Layer 3 <- Layer3_in <- Layer 2 
```

（对不起，如果这比必要的更详尽）

无论如何，一条消息从第 1 层传递到第 2 层，进行一些处理，然后将另一条（相关）消息发送到第 3 层，反之亦然。我遇到的问题是，有时我会从第 1 层向第 2 层发送两条消息，但不是按顺序接收两条消息，而是两次接收第一条消息。我正在使用`BeginReceive`on`Layer1_out`异步接收消息。完成后，我处理收到的消息并`BeginReceive`再次调用以获取下一条消息。

为了追踪这一点，我在发送端实现了一个消息计数器，并将其写入文本文件。我正在使用该`Extension`属性来存储此消息号的字符串表示形式，以便我可以在处理端检索消息号。当我收到一条消息时，我将这个号码写入另一个文件。这应该产生两个具有相同内容的文件，但我会看到类似的东西

```
00000000000000000214
00000000000000000215
00000000000000000215 <- this is bad!
00000000000000000217
00000000000000000218
00000000000000000219 
```

在回执日志中，表明消息 215 被处理了两次，而 216 没有通过。就我的目的而言，两次处理同一条消息对我没有任何影响（因此这在一段时间内一直未被注意到），但完全丢失一条消息是一个大问题。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T17:30:45.680

问题解决了......我想有一天我会给出多线程建议，然后我自己就会被违规咬到！

罪魁祸首是这一行：

```
receiveResult = <queueName>.BeginReceive() 
```

当我有另一条消息已经在队列中等待时，我的`ReceiveCompleted`事件在另一个线程上触发并`EndReceive(receiveResult)`在返回值`BeginReceive`实际写入`receiveResult`变量之前到达我的调用。结果，我`EndReceive`用相同的值调用并再次收到相同的消息！围绕同步对象锁定整个事件处理程序可以解决这个问题。

# c++ - 在编译时使用模板计算浮点数

> ID：940354
> 
> 赞同：1
> 
> 时间：2009-06-02T15:57:38.903
> 
> 标签：c++, templates

我是 C++ 混乱中的整个模板元编程的新手，我根本无法做到这一点。

场景：例如，我有分数 2/5, 6/9,... 我想在编译时计算这些分数的结果，然后在运行时使用该值对它们进行排序。

这甚至可能吗？可能是宏？

**编辑：** 感谢 Naveen，但如果可以在编译时使用模板计算浮点数，它并没有回答这个问题。例如，使用递归。

我在网上找不到任何信息：/

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T16:00:58.123

您不需要模板。当您执行以下操作时，任何体面的编译器都会优化计算：`float f = 2.0/5;`顺便说一句，如果所有都是编译时变量，为什么要在运行时对它们进行排序？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T16:07:59.837

不知道你在问什么。你的意思是这样的：

```
#include <iostream>
using namespace std;;

template <int a, int b> struct Fract {
    double value() const {
        const double f = a / double(b);
        return f;
    }
};

int main() {
    Fract <2,5> f;
    cout << f.value() << endl;
} 
```

**编辑：**如果您真的想进入模板编程，元或其他方面，我强烈建议您阅读《[C++ 模板：完整指南》](http://www.josuttis.com/tmplbook/)一书，这本书非常棒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T16:19:54.407

[以下是模板递归的一些示例](http://ubiety.uwaterloo.ca/~tveldhui/papers/Template-Metaprograms/meta-art.html)。

# sql - 审核是否执行了存储过程 - 在事务日志中

> ID：940361
> 
> 赞同：2
> 
> 时间：2009-06-02T16:00:10.027
> 
> 标签：sql, sql-server, stored-procedures, audit, transaction-log

我们有带有完整备份和事务日志的 SQL Server 2005 数据库。我们的数据库有问题 - 需要 SQL CSI Forensic 团队提供帮助。

有没有办法查看事务日志并确定是否执行了存储过程？我们知道它发生的时间（如果它发生了），但它是否发生存在争议。

有什么建议么。我知道我们应该一直在记录——我们现在显然正在考虑这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T16:26:18.167

**For updating & deleting data** you may be able to figure out what happened using DBCC LOGINFO There are products like [apex sql log](http://www.apexsql.com/sql_tools_log.asp) that will make this analysis much easier. THis will tell you when it happened, but not what user made the call. Although you make have other application level logs (iis logs for example) that may help in this respect.

**For selecting or looking at data** i'd say you have no chance.

In future if you need this kind of audit trail i suggest you look at SQL's C2 Auditing feature.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T16:07:23.520

There used to be a company called Lumigent that had a program called Log Explorer. I couldn't find the companies web site...and I am not sure if theyr explorer would be able to tell you if a proc was executed...however it would tell you if the statements insite the proc were executed at the time you think they were. If you could find it, Lumigent Log Explorer would probably help.

# generics - 通用列表的 .NET 通用参数

> ID：940371
> 
> 赞同：1
> 
> 时间：2009-06-02T16:03:54.393
> 
> 标签：generics, .net-2.0

运行 .NET 2.0，我有一个具有以下签名的通用方法：

```
static listType FillCollection<listType, objType>(IDataReader dr) where listType : ICollection<objType>, new() 
```

它的目的是将数据读取器转换为我选择的对象集合。我的问题并不完全是问题，当我调用它时，调用最终看起来像这样：

```
List<MyObject> data = FillCollection<List<MyObject>, MyObject>(dr); 
```

**我很好奇是否有办法消除在调用中必须两次指定 MyObject 的冗余。** 理想情况下，我只能将它与集合类型一起指定一次，并保持该方法的强类型化特性。添加另一个包装器方法来抽象 ICollection 类型排序就可以了：

```
List<MyObject> data = FillList<MyObject>(dr);

static List<objType> FillList<objType>(dr)
{
    return FillCollection<List<objType>, objType>(dr);
} 
```

但我宁愿没有为我想使用的每个集合提供包装方法。

也许我在这件事上别无选择，但如果是这样，我不必喜欢它！;)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T16:13:08.607

这可能是值得尝试的事情：

```
static listType FillCollection<objType>(IDataReader dr, ICollection<objType> list) 
```

这将允许您在不指定类型两次的情况下调用它，但您将被迫在 FillCollection 之外创建集合。

```
var list = new List<MyObject>();
var data = FillCollection<MyObject>(dr, list); 
```

可能不是您所希望的，因为您仍然两次引用 MyObject（一次在创建 List 时，另一次在 FillCollection 中），但我认为您不会在不失去强大的情况下摆脱这种情况打字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T16:08:06.390

如果您使用 Visual Studio 2008，您仍然可以面向 .NET 2.0，但使用 C# 3.0 语法。这意味着您可以使用“var”关键字：

```
var data = FillCollection<List<MyObject>, MyObject>(dr); 
```

当您使用 Visual Studio 2005 时，恐怕您不走运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T16:09:41.727

你能用var吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T16:28:19.900

就个人而言，我不太确定为什么您需要您的方法来创建多个不同的 ICollection 实现。我的倾向是有一个方法签名如下，只需在方法内创建一个 List 并返回它。

```
static ICollection<T> FillCollection<T>(IDataReader dr) where T : class, new() 
```

如果这不能接受，那么我会接受约瑟夫的回答。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T16:35:32.033

有点像约瑟夫提到的那样，我过去使用过“out”参数并取得了很好的效果，但从来没有一种泛型类型依赖于另一种泛型类型而不获取或返回该类型的值。无论如何，你可以做这样的事情，尽管你必须有一个 objType 列表和一个 objType 的单个对象在调用 FillCollection 之外声明，并且 FillCollection 将变为无效。这是它的样子，但增加可读性是否是一个好主意取决于你。

```
public static void FillCollection<listType, objType>(IDataReader dr, out listType collection, out objType obj) 
    where listType : ICollection<objType>, new() 
    where objType : new()
{
    collection = new listType();
    obj = new objType();

    // Do whatever you do to fill the collection
}

public static void TestFillCollection()
{
    IDataReader dr;
    List<MyObject> myObjects;
    MyObject myObject;

    FillCollection(dr, out myObjects, out myObject);
} 
```

# c# - 您将如何从现有的面向对象 API 创建控制台应用程序？

> ID：940373
> 
> 赞同：3
> 
> 时间：2009-06-02T16:04:15.923
> 
> 标签：c#, c++, delphi, console

我有：

*   现有的面向对象的本机代码 API（非 GUI）
*   使用此 API 的 GUI 应用程序

目标：创建一个额外的控制台应用程序，让用户通过键入命令来执行一些工作流（类似于上面的 GUI 应用程序）。这个应用程序应该是“有状态的”——可用的命令及其结果将取决于先前发出的命令。

问题：我不想“重新发明轮子”。是否存在用于构建应用程序和定义“词汇表”的现有模式？目前，在我看来，最好的选择是“从头开始”编写一组帮助程序和命令解析器。

PS 如果我的 API 在 .Net 中，我会研究 PowerShell 方向，但 API 很大，将其包装到 .Net 中非常耗时。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T16:12:31.897

您描述的使用模式听起来像 Read-Eval-Print 循环 (REPL)，这是解释语言的常见交互模式。

事实上，您似乎在描述一种命令语言和解释器，因此我建议检查该域以查找与您现有的 API 绑定匹配的模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T16:07:13.083

Do you have any COM interfaces? PowerShell can seamlessly script COM, WMI or .NET; you could even do runtime p/invoke calls with pure script; a lot less time consuming to prototype. Once you solidify the design, you can optionally wrap as native Cmdlets later for speed.

-Oisin

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T16:10:03.660

If you do end up using .net, perhaps you could take a look @ the Mono.Options library: [http://tirania.org/blog/archive/2008/Oct-14.html](http://tirania.org/blog/archive/2008/Oct-14.html)

> "Mono.Options is a beautiful command line parsing library. It is small, succinct, a joy to use, easy and powerful, all in one."

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T17:40:21.547

要开始使用命令行，首先不要重新发明轮子。有很多选项可以解析命令。

在 Java 中，[Commons CLI](http://commons.apache.org/cli/)可以为您提供所需的一切。还有一个[.NET CLI 端口](http://sourceforge.net/projects/dotnetcli/)。

[InfiniteRed](http://blog.infinitered.com/)有[一篇](http://blog.infinitered.com/entries/show/5)关于如何在 Ruby 中执行此操作的很好的文章。

就实施而言，您的想法是正确的。但也不要在这里重新发明轮子。将工作封装在`Command`对象中，并考虑使用责任链模式；[共享链](http://commons.apache.org/chain/)运行良好。还有一个[.NET Chain 端口](http://sourceforge.net/projects/nchain/)。

如果无法选择使用这些框架，请查看它们是如何实现的。此外，如果您在与其中一些选项进行互操作时遇到问题，Ruby 确实是做这类事情的一把好刀。它相对可移植，并且代码最终可以非常干净且易于维护。

更新：[JCommander](http://beust.com/weblog/2010/08/08/complex-line-command-syntaxes-with-jcommander/)看起来也很有趣。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T23:12:41.240

[使用SIP](http://www.riverbankcomputing.co.uk/software/sip/intro)或[SWIG](http://www.swig.org/)等自动工具包装您的 API ，将它们作为 python 模块导入[ipython](http://ipython.scipy.org/moin/)会话，从命令行处理您的对象。任务完成。

如果这失败了，那将是因为：

*   您的对象/API 不适合自动包装（但使它们进入可包装状态的过程通常意味着改进它们）。
*   Python 并不是您真正想到的命令行（即使具有 ipython 增强功能）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T16:34:26.530

我非常同意 xOn 的回答，但要在调用之间保持状态，只需将其设为单个实例 com 对象，然后编写一个“登录”函数来调用 AddRef 和一个“注销”函数来调用 Release。这样，对象将在调用之间停留。唯一的风险是在同一个盒子上多次运行多次登录......所以你会想为此设下陷阱。

根据您需要的状态，如果它不多并且可以轻松地流式传输到磁盘文件或数据库，那么多实例 com 对象会表现得更好，并且不需要 addref 或 release 调用。

# linux - How can I monitor data on a serial port in Linux?

> ID：940374
> 
> 赞同：26
> 
> 时间：2009-06-02T16:04:31.150
> 
> 标签：linux, monitoring, serial-port

I'm debugging communications with a serial device, and I need to see all the data flowing both directions.

It seems like this should be easy on Linux, where the serial port is represented by a file. Is there some way that I can do a sort of "bi-directional tee", where I tell my program to connect to a pipe that copies the data to a file and also shuffles it to/from the actual serial port device?

I think I might even know how to write such a beast, but it seems non-trivial, especially to get all of the ioctls passed through for port configuration, etc.

Has anyone already built such a thing? It seems too useful (for people debugging serial device drivers) not to exist already.

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-03T08:41:14.023

[strace](http://linux.die.net/man/1/strace)对此非常有用。您拥有所有 ioctl 调用的可视化，并解码了相应的结构。以下选项在您的情况下似乎特别有用：

> -e 读取=设置
> 
> 对从指定集中列出的文件描述符读取的所有数据执行完整的十六进制和 ASCII 转储。例如，要查看文件描述符 3 和 5 上的所有输入活动，请使用 -e read=3,5。请注意，这与由选项 -e trace=read 控制的 read(2) 系统调用的正常跟踪无关。
> 
> -e 写=设置
> 
> 对写入指定集中列出的文件描述符的所有数据执行完整的十六进制和 ASCII 转储。例如，要查看文件描述符 3 和 5 上的所有输出活动，请使用 -e write=3,5。请注意，这与 write(2) 系统调用的正常跟踪无关，后者由选项 -e trace=write 控制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T16:08:21.227

I have found [**pyserial**](https://pyserial.readthedocs.io/en/latest/) to be quite usable, so if you're into Python it shouldn't be too hard to write such a thing.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T15:34:47.573

一个简单的方法是编写一个打开 pty 的主端和被测 tty 的应用程序。然后，您会将您的 tty 应用程序作为“tty 设备”传递给 pty 的从属端。

如果属性发生变化，您必须[`tcgetattr()`](http://man7.org/linux/man-pages/man3/termios.3.html)在 pty master 上监视 pty 属性并调用[`tcsetattr()`](http://man7.org/linux/man-pages/man3/termios.3.html)真正的 tty。

其余的将是一个简单[`select()`](http://man7.org/linux/man-pages/man2/select.2.html)的 fd 双向复制数据并将其复制到日志。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-26T06:00:30.360

我看了很多串行嗅探器。所有这些都基于制作虚拟串行端口并从该端口嗅探数据的想法。但是，任何波特/奇偶校验/流量更改都会中断连接。

所以，我写了自己的嗅探器:)。现在大多数串口只是USB转串口转换器。我的嗅探器通过 debugfs 从 USB 收集数据，对其进行解析并输出到控制台。此外，还记录任何波特率变化、流量控制、线路事件和串行错误。该项目处于早期开发阶段，目前仅支持 FTDI。

[http://code.google.com/p/uscmon/](http://code.google.com/p/uscmon/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-15T02:26:23.387

就像[@MBR](https://stackoverflow.com/a/12595408/5798824)一样，我正在研究串行嗅探器，但`pty`s 打破了奇偶校验。然而，他的嗅探器并没有帮助我，因为我使用的是 CP2102，而不是 FT232。[所以我按照这个](https://stackoverflow.com/a/9614429/5798824)编写了自己的嗅探器，现在我有了一个可以在任意文件上记录文件 I/O 的嗅探器：我称之为[tracie](https://github.com/bence98/tracie/tree/master)。

# ruby-on-rails - Pattern for unidirectional has_many join?

> ID：940376
> 
> 赞同：1
> 
> 时间：2009-06-02T16:04:59.480
> 
> 标签：ruby-on-rails, activerecord, has-many

It occurred to me that if I have a has_many join, where the foreign model does not have a belongs_to, and so the join is one way, then I don't actually need a foreign key.

We could have a column, category_ids, which stores a marshaled Array of IDs which we can pass to `find`.

So here is an untested example:

```
class page < AR

  def categories
    Category.find(self.category_ids)
  end

  def categories<<(category)
    # get id and append to category_ids
    save!
  end

  def category_ids
    @cat_ids ||= Marshal.load(read_attribute(:category_ids)) rescue []
  end

  def category_ids=(ids)
    @cat_ids = ids
    write_attribute(:category_ids, ids)
  end

end 
```

page.category_ids => [1,4,12,3] page.categories => Array of Category

Is there accepted pattern for this already? Is it common or just not worth the effort?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T20:10:11.500

当您编组/解组时，性能不会在这里受到影响吗？

我个人认为这不值得付出努力，而且您要尝试做的事情似乎还不清楚。

实际上，这看起来像一个多对多映射而不是多对一，因为没有代码可以阻止一个类别属于多个页面，当然你想要这样的东西：

```
create table categories_pages (
  category_id integer not null references categories(id),
  page_id integer not null references pages(id),
  primary_key(category_id, page_id)
); 
```

两边都有一个 has 和属于 many 或 has_many :through 在两边（取决于你是否想存储更多的东西）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-24T21:13:28.327

我同意奥马尔的观点，这似乎不值得付出努力。

您的数据库不再反映您的数据模型，并且不会为加强这种关系提供任何帮助。此外，如果您想限制与 has_many 的关系，您现在必须使编组后的 id 数组与 Category 表同步，并在 Pages 之间强制执行唯一性。

但我想最重要的是，这种方法有什么好处？这将增加复杂性并增加您必须编写的代码量。

# sql - SQL Sum Column before inserting into #temp

> ID：940377
> 
> 赞同：1
> 
> 时间：2009-06-02T16:05:30.180
> 
> 标签：sql, sum, group-by

In my SPROC a table named #temp1 contains the following columns:

```
#temp1 (StoreId, StoreDesc, ReservedQty, AvgPrice, QtyOnHand) 
```

My question is based on the following query

```
INSERT INTO #temp2 (StoreId, StoreDesc, CommittedQty)
(SELECT     StoreId,  StoreDesc, 
    CASE WHEN ReservedQty > QtyOnHand THEN
        sum(QtyOnHand * AvgPrice) 
    ELSE
        sum(ReservedQty * AvgPrice) 
    END AS CommittedQty
    FROM #temp1 
    GROUP BY StoreId, StoreDesc, QtyOnHand, ReservedQty) 
```

A sample result set looks like this:

```
StoreId                 StoreDesc   CommittedQty    
C4ED0D8B-22CF-40FE-8EF9-7FD764310C94    FramersBranch   0
C4ED0D8B-22CF-40FE-8EF9-7FD764310C94    FarmersBranch   88978
C4ED0D8B-22CF-40FE-8EF9-7FD764310C94    FarmersBranch   0
C4ED0D8B-22CF-40FE-8EF9-7FD764310C94    FarmersBranch   3152
6369D3A6-83BC-4BB0-9A25-86838CD2B7BA    Woodlands   5582
6369D3A6-83BC-4BB0-9A25-86838CD2B7BA    Woodlands   389 
```

Unfortunatly since I have to `GROUP BY` the `QtyOnHand` & `ReservedQty` columns in my `CASE` statement I get multiple rows for each StoreId.

I would like to know if there is a simple way for me to sum the results (again) based on the CommittedQty so that I may get the following result set I desire:

```
StoreId v               StoreDesc   CommittedQty    
C4ED0D8B-22CF-40FE-8EF9-7FD764310C94    FramersBranch   92130
6369D3A6-83BC-4BB0-9A25-86838CD2B7BA    Woodlands   5971 
```

I realize I could use another temp table but wondered if there was an easier way to accomplish this inside the `SELECT` statement

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T16:08:26.623

```
SELECT  StoreId,  StoreDesc, 
        SUM(
        CASE
        WHEN ReservedQty > QtyOnHand THEN
                QtyOnHand * AvgPrice 
        ELSE
                ReservedQty * AvgPrice
        END
        ) AS CommittedQty
FROM    #temp1 
GROUP BY
        StoreId, StoreDesc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T16:49:33.263

首先要做的事情是：如果您可以避免使用#temp 和##temp 表，那么您应该这样做。它们是导致全球变暖和山洪暴发的邪恶讨厌的小东西，是各种温室气体排放的罪魁祸首。（：

开个玩笑，除非绝对必要，否则请摆脱临时表并在必要时将其替换为子查询。

您可以简单地围绕此语句包装另一个选择

```
INSERT INTO #temp2 (StoreId, StoreDesc, CommittedQty)
SELECT StoreId, StoreDesc, Sum (CommittedQty)
FROM 
(SELECT         StoreId,  StoreDesc, 
        CASE WHEN ReservedQty > QtyOnHand THEN
                sum(QtyOnHand * AvgPrice) 
        ELSE
                sum(ReservedQty * AvgPrice) 
        END AS CommittedQty
        FROM #temp1 
        GROUP BY StoreId, StoreDesc, QtyOnHand, ReservedQty)
)
GROUP BY StoreId, StoreDesc 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T16:08:29.247

I wouldn't use a temp table. My guess is that you're already using at least one too many :)

You need to put the SUM around your whole CASE statement:

```
SUM(AvgPrice *
     CASE
          WHEN ReservedQty > QtyOnHand THEN QtyOnHand
          ELSE ReservedQty
     END) 
```

# haskell - What is the difference between . (dot) and $ (dollar sign)?

> ID：940382
> 
> 赞同：770
> 
> 时间：2009-06-02T16:06:36.640
> 
> 标签：haskell, syntax, function-composition

What is the difference between the dot `(.)` and the dollar sign `($)`?

As I understand it, they are both syntactic sugar for not needing to use parentheses.

* * *

## 回答 #1

> 赞同：1314
> 
> 时间：2009-08-17T22:01:59.793

`$`运算符用于避免括号。在它之后出现的任何东西都将优先于之前出现的任何东西。

例如，假设您有一行内容为：

```
putStrLn (show (1 + 1)) 
```

如果你想去掉这些括号，下面的任何一行也可以做同样的事情：

```
putStrLn (show $ 1 + 1)
putStrLn $ show (1 + 1)
putStrLn $ show $ 1 + 1 
```

运算符的主要目的`.`不是避免括号，而是链接函数。它使您可以将右侧出现的任何内容的输出与左侧出现的任何内容的输入联系起来。这通常也会导致更少的括号，但工作方式不同。

回到同一个例子：

```
putStrLn (show (1 + 1)) 
```

1.  `(1 + 1)`没有输入，因此不能与`.`运算符一起使用。
2.  `show`可以取 a`Int`并返回 a `String`。
3.  `putStrLn`可以取 a`String`并返回 a `IO ()`。

你可以`show`像`putStrLn`这样链接：

```
(putStrLn . show) (1 + 1) 
```

如果您喜欢的括号太多，请使用`$`运算符删除它们：

```
putStrLn . show $ 1 + 1 
```

* * *

## 回答 #2

> 赞同：204
> 
> 时间：2009-06-02T16:14:22.443

它们有不同的类型和不同的定义：

```
infixr 9 .
(.) :: (b -> c) -> (a -> b) -> (a -> c)
(f . g) x = f (g x)

infixr 0 $
($) :: (a -> b) -> a -> b
f $ x = f x 
```

`($)`旨在替换普通函数应用程序，但优先级不同，以帮助避免括号。`(.)`用于将两个函数组合在一起以形成一个新函数。

在某些情况下，它们可以互换，但通常情况并非如此。它们所在的典型示例是：

```
f $ g $ h $ x 
```

==>

```
f . g . h $ x 
```

换句话说，在一个`$`s 链中，除了最后一个之外，所有的都可以替换为`.`

* * *

## 回答 #3

> 赞同：134
> 
> 时间：2009-06-02T16:32:36.497

另请注意，这`($)`是*专用于函数类型的标识函数*。身份函数如下所示：

```
id :: a -> a
id x = x 
```

虽然`($)`看起来像这样：

```
($) :: (a -> b) -> (a -> b)
($) = id 
```

请注意，我有意在类型签名中添加了额外的括号。

`($)`通常可以通过添加括号来消除使用（除非在一个部分中使用了运算符）。例如：`f $ g x`变成`f (g x)`.

的使用`(.)`通常更难替换；它们通常需要 lambda 或引入显式函数参数。例如：

```
f = g . h 
```

变成

```
f x = (g . h) x 
```

变成

```
f x = g (h x) 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：83
> 
> 时间：2010-01-07T01:43:45.647

`($)`允许将函数链接在一起而无需添加括号来控制评估顺序：

```
Prelude> head (tail "asdf")
's'

Prelude> head $ tail "asdf"
's' 
```

compose 运算符`(.)`在不指定参数的情况下创建一个新函数：

```
Prelude> let second x = head $ tail x
Prelude> second "asdf"
's'

Prelude> let second = head . tail
Prelude> second "asdf"
's' 
```

上面的例子可以说是说明性的，但并没有真正展示使用组合的便利性。这是另一个类比：

```
Prelude> let third x = head $ tail $ tail x
Prelude> map third ["asdf", "qwer", "1234"]
"de3" 
```

如果我们只使用第三次，我们可以避免使用 lambda 来命名它：

```
Prelude> map (\x -> head $ tail $ tail x) ["asdf", "qwer", "1234"]
"de3" 
```

最后，组合让我们避免了 lambda：

```
Prelude> map (head . tail . tail) ["asdf", "qwer", "1234"]
"de3" 
```

* * *

## 回答 #5

> 赞同：61
> 
> 时间：2009-06-10T20:11:07.537

简短而甜蜜的版本：

*   `($)`调用作为其右手参数的值的函数，该函数是其右手参数。
*   `(.)`将作为其左侧参数的函数组合到作为其右侧参数的函数上。

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2010-01-31T12:12:29.260

[一个有用的应用程序，我花了一些时间从Learn You a Haskell](http://learnyouahaskell.com/higher-order-functions#function-application)的简短描述中弄清楚：因为

```
f $ x = f x 
```

并且在包含中缀运算符的表达式的右侧加上括号将其转换为前缀函数，可以写`($ 3) (4 +)`类似于`(++ ", world") "hello"`.

为什么会有人这样做？例如，对于函数列表。两个都：

```
map (++ ", world") ["hello", "goodbye"]
map ($ 3) [(4 +), (3 *)] 
```

比

```
map (\x -> x ++ ", world") ["hello", "goodbye"]
map (\f -> f 3) [(4 +), (3 *)] 
```

显然，后一种变体对大多数人来说更具可读性。

* * *

## 回答 #7

> 赞同：28
> 
> 时间：2017-11-09T23:12:45.800

> ## `.`Haskell：（点）和`$`（美元符号）之间的区别
> 
> `(.)`点和美元符号有什么区别`($)`？据我了解，它们都是不需要使用括号的语法糖。

它们***不是***不需要使用括号的语法糖 - 它们是函数， - 中缀，因此我们可以称它们为运算符。

## 撰写，`(.)`以及何时使用它。

`(.)`是撰写功能。所以

```
result = (f . g) x 
```

与构建一个将其参数的结果传递给`g`on的函数相同`f`。

```
h = \x -> f (g x)
result = h x 
```

`(.)`当您没有可用于传递给您希望编写的函数的参数时使用。

## 右结合应用，，`($)`以及何时使用它

`($)`是具有低绑定优先级的右关联应用函数。所以它只是先计算它右边的东西。因此，

```
result = f $ g x 
```

在程序上与此相同（这很重要，因为 Haskell 是惰性评估的，它将首先开始评估`f`）：

```
h = f
g_x = g x
result = h g_x 
```

或更简洁地说：

```
result = f (g x) 
```

`($)`在将前面的函数应用于结果之前，当您有所有要评估的变量时使用。

我们可以通过阅读每个函数的源代码来看到这一点。

### 阅读源代码

以下是的[来源](http://hackage.haskell.org/package/base-4.10.0.0/docs/src/GHC.Base.html#.)`(.)`：

```
-- | Function composition.
{-# INLINE (.) #-}
-- Make sure it has TWO args only on the left, so that it inlines
-- when applied to two functions, even if there is no final argument
(.)    :: (b -> c) -> (a -> b) -> a -> c
(.) f g = \x -> f (g x) 
```

这是[来源](http://hackage.haskell.org/package/base-4.10.0.0/docs/src/GHC.Base.html#%24)`($)`：

```
-- | Application operator.  This operator is redundant, since ordinary
-- application @(f x)@ means the same as @(f '$' x)@. However, '$' has
-- low, right-associative binding precedence, so it sometimes allows
-- parentheses to be omitted; for example:
--
-- >     f $ g $ h x  =  f (g (h x))
--
-- It is also useful in higher-order situations, such as @'map' ('$' 0) xs@,
-- or @'Data.List.zipWith' ('$') fs xs@.
{-# INLINE ($) #-}
($)                     :: (a -> b) -> a -> b
f $ x                   =  f x 
```

## 结论

当您不需要立即评估函数时，请使用组合。也许您想将组合产生的函数传递给另一个函数。

当您提供所有参数以进行全面评估时，请使用应用程序。

因此，对于我们的示例，在语义上更可取的是

```
f $ g x 
```

当我们有`x`（或者更确切地说`g`是 的论点），并且做：

```
f . g 
```

当我们不这样做时。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2012-12-04T10:24:49.533

...或者您可以通过使用*流水线*来避免`.`and结构：`$`

 *```
third xs = xs |> tail |> tail |> head 
```

那是在你添加了辅助函数之后：

```
(|>) x y = y x 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2013-08-20T15:53:44.970

我的规则很简单（我也是初学者）：

*   `.`如果要传递参数（调用函数），请不要使用，并且
*   `$`如果还没有参数就不要使用（组成一个函数）

那是

```
show $ head [1, 2] 
```

但从不：

```
show . head [1, 2] 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2015-04-15T06:10:17.183

了解任何事物（任何函数）的好方法是记住一切都是函数！一般的口头禅会有所帮助，但在像运算符这样的特定情况下，记住这个小技巧会有所帮助：

```
:t (.)
(.) :: (b -> c) -> (a -> b) -> a -> c 
```

和

```
:t ($)
($) :: (a -> b) -> a -> b 
```

只要记住要`:t`自由使用，并将您的运算符包装在`()`!

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-06-08T18:05:53.070

$ 最重要的部分是它具有最低的运算符优先级。

如果你输入信息，你会看到：

```
λ> :info ($)
($) :: (a -> b) -> a -> b
    -- Defined in ‘GHC.Base’
infixr 0 $ 
```

这告诉我们它是具有最低可能优先级的右结合性中缀运算符。普通函数应用程序是左关联的并且具有最高优先级 (10)。所以 $ 是相反的东西。

因此，我们在普通函数应用程序或 using () 不起作用的地方使用它。

因此，例如，这有效：

```
λ> head . sort $ "example"
λ> e 
```

但这不会：

```
λ> head . sort "example" 
```

因为 。优先级低于 sort 并且 (sort "example") 的类型是 [Char]

```
λ> :type (sort "example")
(sort "example") :: [Char] 
```

但 。需要两个函数，并且由于 sort 和 .

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-08-09T02:59:36.960

所有其他答案都很好。但是关于 ghc 如何处理 $ 有一个重要的可用性细节，即 ghc 类型检查器允许具有更高等级/量化类型的 instatiarion。如果你看一下 `$ id`example 的类型，你会发现它会采用一个函数，其参数本身就是一个多态函数。类似的小事情没有与等效的翻转操作符相同的灵活性。（这实际上让我想知道 $! 是否应该得到同样的待遇）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-10-15T23:26:42.517

我认为一个简短的例子说明你会在哪里使用`.`而不是在哪里`$`有助于澄清事情。

```
double x = x * 2
triple x = x * 3
times6 = double . triple

:i times6
times6 :: Num c => c -> c 
```

请注意，`times6`这是从函数组合创建的函数。

# jquery - jquery IE8 selector bizarreness

> ID：940383
> 
> 赞同：0
> 
> 时间：2009-06-02T16:06:45.017
> 
> 标签：jquery, xml, internet-explorer-8, css-selectors

I'm working with an xml node of the following structure:

```
<CF>
    <T>
        <TX>title</TX>
        <em>15:2:</em>
    </T>
    <KW>
        <TX>SOMETHING ELSE</TX>
    </KW>
    <!-- OTHER TAGS, SOME OF WHICH HAVE A <TX> CHILD -->
</CF> 
```

Things work more or less as I expect in firefox, but I'm getting weird behavior in IE8\. For example, the following gives me a jquery object of length 14:

```
jQuery("T TX", xmlDoc).length 
```

where it should be only one (the "CF" tag contains only one "T" tag, which in turn contains only one "TX" tag).

Adding to the strangeness, if I remove the "T" from the selector, as in the following:

```
jQuery("TX", xmlDoc).length 
```

I get FEWER, rather than an equal or greater number of results (the jquery object's length is 12).

So, the first question is: if there's only one TX tag, and it has only one "T" tag, why does jquery find 14 "TX" tags which are descendants of a "T"?

The second question is: if I simplify the selector, removing the "T", why do I get fewer, rather than more results?

Am I doing something wrong, or have I stumbled upon a bug?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T16:23:06.733

也许你可以尝试这样的事情：

```
jQuery('T', mydoc).find('TX').length 
```

看看会发生什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-09T15:02:49.840

使用 jQuery 解析 IE8 中的非 html 标签似乎存在问题。我刚刚偶然发现了[这个讨论](http://forum.jquery.com/topic/each-or-find-isn-t-working-in-ie8)，其中建议的答案是使用 Microsoft.XMLDOM 从 XML 构建您的 DOM 对象。这是关键部分：

```
xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
xmlDoc.async="false";
xmlDoc.loadXML(text); 
```

我试过这个，它解决了我在从字符串构建 XML 文档时使用 IE8 时遇到的一些问题（$() 和 $.find 没有返回任何内容，只有 $.filter 可以工作）。

更新：您可能会查看 $.parseXML() 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T16:11:29.493

“<TX>title</TX>”共有14个字符。因为我不知道有多少实际的 TX 元素，所以我不能说第二个查询中的 12 是否是文档中 TX 元素的数量。

有点疯狂，离墙...但也许长度属性没有返回您认为的返回值？

# vb.net - 以编程方式更改 LINQ dmbl 的连接字符串

> ID：940384
> 
> 赞同：0
> 
> 时间：2009-06-02T16:07:08.277
> 
> 标签：vb.net, linq-to-sql

我有两个独立的数据库，一个是生产数据库，另一个是测试数据库。在 LINQ 之前，我可以简单地将连接字符串更改为 swtich db。但是，字符串是只读的，我无法更改字符串。

如何以编程方式更改连接字符串？

**为清晰而编辑**

我使用 my.settings 存储所有这些信息

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T16:13:46.843

DataContext 对象应该有一个将连接字符串作为参数的构造函数。或者，默认行为是从配置文件中提取它，因此您可以在 app.config/web.config 文件中更改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:31:51.053

我找到了一个简单的解决方案。将类型从连接字符串更改为字符串，并将范围设置回用户。

就像以前一样工作。

这确实会导致不同的问题。每当更新 dmbl 文件时，都会导致底层 vb 文件出现问题。我正在使用的解决方法是创建一个新的构造函数并确保正确指向连接字符串

# sql-server - SQL Server FTI：如何检查表状态？

> ID：940386
> 
> 赞同：4
> 
> 时间：2009-06-02T16:07:21.117
> 
> 标签：sql-server, full-text-search

在 SQL Server 全文索引方案中，我想知道一个表是否在

*   `start_chage_tracking`模式
*   `update_index`模式
*   `start_change_tracking`和`start_background_updateindex`模式

问题是我将表设置为“后台更新索引”，然后告诉它“开始更改跟踪”，但几个月后它似乎没有跟踪更改。

我如何查看“后台更新索引”和“更改跟踪”标志的状态？

**例子：**

```
sp_fulltext_table @tabname='DiaryEntry', @action='start_background_updateindex' 

Server: Msg 15633, Level 16, State 1, Procedure sp_fulltext_table, Line 364
Full-text auto propagation is currently enabled for table 'DiaryEntry'.

sp_fulltext_table @tabname='Ticket', @action='start_background_updateindex' 
Server: Msg 15633, Level 16, State 1, Procedure sp_fulltext_table, Line 364
Full-text auto propagation is currently enabled for table 'Ticket'. 
```

显然，一个表*有*一个索引状态，我只想知道它表明我可以将它显示给用户（即我）。

其他可用的 API：

```
EXECUTE sp_help_fulltext_tables 
```

只返回目录中的表，不返回它们的状态。

```
TABLE_OWNER  TABLE_NAME  FULLTEXT_KEY_INDEX_NAME  FULLTEXT_KEY_COLID  FULLTEXT_INDEX_ACTIVE  FULLTEXT_CATALOG_NAME
===========  ==========  =======================  ==================  =====================   =====================
dbo          DiaryEntry  PK_DiaryEntry_GUID       1                   1                      FrontlineFTCatalog
dbo          Ticket      PK__TICKET_TicketGUID    1                   1                      FrontlineFTCatalog 
```

我可以获得整个目录的**PopulateStatus ：**

```
SELECT FULLTEXTCATALOGPROPERTY('MyCatalog', 'PopulateStatus') AS PopulateStatus 
```

它返回目录的状态：

```
0 = Idle 
1 = Full population in progress
2 = Paused 
3 = Throttled 
4 = Recovering 
5 = Shutdown 
6 = Incremental population in progress 
7 = Building index 
8 = Disk is full. Paused.
9 = Change tracking 
```

但不是为了一张桌子。

* * *

SQL Server 2000 SP4

```
SELECT @@version
Microsoft SQL Server  2000 - 8.00.194 (Intel X86) 
    Aug  6 2000 00:57:48 
    Copyright (c) 1988-2000 Microsoft Corporation
    Standard Edition on Windows NT 5.0 (Build 2195: Service Pack 4) 
```

不管有什么错误，我都想创建 UI 以便能够轻松查看其状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T18:15:40.723

基督。我有一个格式很好的答案。当 IE 崩溃时，我正在滚动以点击保存。

简洁版本：

**对象属性**

*   表FullTextPopulateStatus
*   TableFullTextBackgroundUpdateIndexOn
*   TableFullTextCatalogId
*   表FullTextChangeTrackingOn
*   表FullTextKeyColumn
*   TableHasActive全文索引

TableFullTextBackgroundUpdateIndexOn 1=真 0=假

TableFullTextPopulateStatus 0=无填充 1=完全填充 2=增量填充

完整示例：

```
SELECT
    --indicates whether full-text change-tracking is enabled on the table (0, 1)
    OBJECTPROPERTY(OBJECT_ID('DiaryEntry'), 'TableFullTextChangeTrackingOn') AS TableFullTextChangeTrackingOn,

    --indicate the population status of a full-text table (0=No population, 1=Full Population, 2=Incremental Population)
    OBJECTPROPERTY(OBJECT_ID('DiaryEntry'), 'TableFullTextPopulateStatus') AS TableFullTextPopulateStatus,

    --indicates whether a table has full-text background update indexing (0, 1)
    OBJECTPROPERTY(OBJECT_ID('DiaryEntry'), 'TableFullTextBackgroundUpdateIndexOn') AS TableFullTextBackgroundUpdateIndexOn,

    -- provides the full-text catalog ID in which the full-text index data for the table resides (0=table is not indexed)
    OBJECTPROPERTY(OBJECT_ID('DiaryEntry'), 'TableFullTextCatalogId') AS TableFullTextCatalogId,

    --provides the column ID of the full-text unique key column (0=table is not indexed)
    OBJECTPROPERTY(OBJECT_ID('DiaryEntry'), 'TableFullTextKeyColumn') AS TableFullTextKeyColumn,

    --indicates whether a table has an active full-text index (0, 1)
    OBJECTPROPERTY(OBJECT_ID('DiaryEntry'), 'TableHasActiveFulltextIndex') AS TableHasActiveFulltextIndex 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:23:30.133

您正在运行什么版本的 SQL / Service Pack；这曾经是 sql 2000 中的错误

[http://support.microsoft.com/kb/290212](http://support.microsoft.com/kb/290212)

按此顺序执行 sp_fulltext_table 以暂时解决问题。（磁盘空间不足可能是原因）

*   stop_change_tracking
*   start_change_tracking
*   stop_background_updateindex
*   start_background_updateindex

可以监控您需要的状态，请查看MSSQL Tips上[SQL Server FTI上的这个非常方便的资源；](http://www.mssqltips.com/tip.asp?tip=1681)我认为那里的脚本会给你你正在寻找的东西。

# java - JAX-WS Exception

> ID：940397
> 
> 赞同：1
> 
> 时间：2009-06-02T16:08:55.907
> 
> 标签：java, exception, jax-ws, fault

How to assign the **fault** field of the **SOAPFaultException** on the server side?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T16:16:16.373

据我所知，分配故障字段的唯一方法是通过[构造函数](http://java.sun.com/javase/6/docs/api/javax/xml/ws/soap/SOAPFaultException.html#SOAPFaultException(javax.xml.soap.SOAPFault))。因此，最简单的方法是创建一个`SOAPFaultException`以故障为参数的新方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-08T17:30:32.943

定义异常

```
public class SomeFault extends Exception
{
   public SomeFault(String code)
   {
   }

   public String getA() {...}
   public void setA() {..}

   public String getB() {...}
   public void setB() {..}
} 
```

然后是网络服务

```
@WebService
public class MyWS
{
   public MyWS()
   {
   }

   public Response getSomething(String id) throws SomeFault 
   {
      throw new SomeFault(id);
   }
} 
```

# vb.net - How to call a com+ component?

> ID：940399
> 
> 赞同：3
> 
> 时间：2009-06-02T16:09:36.733
> 
> 标签：vb.net, vb6, com+

I'm making some archeology, dealing with COM+

I managed to enlist a simple COM dll as a COM+ component, so far so good.

So I've got this 'foobar' com+ component, with it's interface, and the method I'd like to call.

My question is then rally simple: how am I supposed to make a call to this component?

Any .NET or VB6 answer is accepted (I have to check the component is OK, don't care about the client)

Thanks

Edit (06/03/09): Well, I'm confused. so as to work properly, my COM+ component needs it's dll to be registered. Why not? But then, how to be sure I'm making a COM+ call, and not a COM one?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T16:34:56.137

可能的最简单的 VB.NET 代码片段：

```
Dim myCom As Object
myCom = CreateObject("MyCom.ProgId")
myCom.Method(parms) 
```

您需要将“MyCom.ProgId”替换为组件的实际 ProgId - 您可以从组件服务管理工具中组件属性的“常规”选项卡中获取此信息（听起来您已经掌握了这一点）

myCom.Method(参数)

只是您要调用的任何方法的占位符，带有该方法所采用的参数。

下面是一些 VB.NET 语法示例的链接：

[http://msdn.microsoft.com/library/de...eateObject.asp](http://msdn.microsoft.com/library/de...eateObject.asp)

[http://www.samspublishing.com/article...le.asp?p=25857](http://www.samspublishing.com/articl...le.asp?p=25857)

[http://msdn.microsoft.com/library/en...asp?frame=true](http://msdn.microsoft.com/library/en...asp?frame=true)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T19:22:40.097

Adam 在 VB6 中的代码类似：

```
Dim myCom As Object
Set myCom = CreateObject("MyCom.ProgId")
myCom.Method(parms 
```

这个例子是后期绑定的，并带有一些性能损失。您可以以早期绑定的方式调用您的方法，从而避免惩罚。在 VB6 或 VB.NET 中，只需将 COM+ dll 添加到您的引用中，您就可以通过以下方式调用对象：

VB6

```
dim myCom as MyCom.ProgId
set myCom = new MyCom.ProgId
myCom.Method 
```

VB.NET

```
dim myCom as new MyCom.ProgId
myCom.Method(...) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T06:15:50.470

如果您只想检查组件在调用时的响应，请使用快速的 VBScript，而不是在 VB6/VB.NET 中构建一些东西。

```
 Dim o : Set o = CreateObject("Lib.Class")
 o.YourMethod "someParam" 
```

在组件服务中观察您的 COM+ 应用程序，以查看请求的类是否启动。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T10:37:01.997

当你想为 RMI 使用 COM+ 时，请使用这个

```
Dim o As Object
Set o = CreateObject("Lib.Class", "MYSERVER") 
```

其中 MYSERVER 是创建 COM+ 应用程序和注册 DLL 的机器名称。随后

```
o.YourMethod "someParam" 
```

将被远程调用。如果您只使用自动化兼容接口，COM+ 将成功地为 RMI 创建代理。否则，您需要在客户端机器上提供 typelib。这可以是单独的 TLB 或 DLL 本身。

# c - Function prototype declared inside main - best practice?

> ID：940402
> 
> 赞同：11
> 
> 时间：2009-06-02T16:10:24.533
> 
> 标签：c

Is this a good style to have the function prototype declared inside of the main function?

I was looking at a C tutorial, I think is quite out of date. However, they declare the function prototype inside of main. I normally declare outside before main.

```
#include <stdio.h>

int main ()
{
    char myname [30];
    int theage;
    int getage ();

    printf ("\nEnter your name:");
    gets (myname);
    theage = getage ();
    printf("\n AGE = %d and NAME = %s", theage, myname);
    return 0;
}

int getage ()
{
    int myage; /* local to only getage() */

    printf ("\nEnter your age: ");
    scanf ("%d",&myage);
    return (myage);
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-02T16:15:53.987

我个人会说“不”有几个原因：

*   它使 main 的代码更长
*   它可能会让新手感到困惑，认为该功能是由 main 限定的
*   在实际代码中，我通常会将函数放在不同的编译单元中并#include它的头文件

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T16:29:42.427

我还要说不，另外一个原因是，如果您开始在整个代码中使用显式声明，那么当您调用的函数突然更改其签名时，您肯定会得到未解析的外部变量。如果 ONE 头文件中有 ONE 声明，则只需在函数更改时更改 ONE 声明即可。

但是，我会说是，因为以下原因：如果您只是编写一个仅用于一次性使用的简单测试方法，即如果您想快速测试某些东西然后立即放弃该功能。那么在你想打电话之前就直接声明是很不错的。

对于生产代码 -> 不不不！:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T16:19:47.030

这不是一个好的风格。

要么在开头声明局部函数原型，要么将它们移动到头文件中。

函数原型（以及外部变量）几乎可以在 c 语言中的任何地方声明。然而，仅仅因为它是可能的，不应该成为写意大利面条式 C 的理由。

它使代码的可读性降低。对我来说，这种做法是代码气味的明显标志。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T17:02:44.637

由于我没有在这个小马表演中跳过所需数量的箍，我别无选择，只能发布此评论作为答案。

请记住，这只是一本书的片段，而不是人们在生产环境中看到的那种代码。代码片段很好，但并不理想。尼尔给出了最好的答案，所以我给了他+1。如果您真的想知道它是如何在教程/教科书之外完成的，我会注意到他的第三点。

另外，因为我正在制作它们：“stdio.h”vs 只是告诉预处理器在哪里搜索文件 stdio.h 的一种方式。同样，在大多数情况下，您会看到 stdio.h 被 <> 而不是 "" 包围。但是，正如 Neil 的第 3 点所提到的，您自己的头文件将被“”包围。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T16:19:20.943

我认为这只是本教程的一个小例子......这就是你开始引入函数时所做的......

我同意尼尔...

# jms - Weblogic 10 - JMS - This RJVM has already been shutdown

> ID：940403
> 
> 赞同：1
> 
> 时间：2009-06-02T16:10:33.287
> 
> 标签：jms, weblogic

Any idea why the following errors comes up.This is happening when posting a JMS message to a queue deployed on Admin server from the application on managed server.

009-06-02 11:21:18,688 (com.xxx.util.servicelocator.ServiceLocator:612) ERROR - Error while loading Queue ProfilerNotify

javax.naming.CommunicationException [Root exception is java.rmi.ConnectException: This RJVM has already been shutdown 3481854169479569584S:XX.XXX.X.XXX:[9200,9200,-1,-1,-1,-1,-1]:Production10:AdminServer]

```
 at weblogic.jndi.internal.ExceptionTranslator.toNamingException(ExceptionTranslator.java:64)

        at weblogic.jndi.internal.WLContextImpl.translateException(WLContextImpl.java:426)

        at weblogic.jndi.internal.WLContextImpl.lookup(WLContextImpl.java:382)

        at weblogic.jndi.internal.WLContextImpl.lookup(WLContextImpl.java:367)

        at javax.naming.InitialContext.lookup(InitialContext.java:351)

        at com.xxx.util.servicelocator.ServiceLocator.loadQueue(ServiceLocator.java:607)

        at com.xxx.util.servicelocator.ServiceLocator.getQueue(ServiceLocator.java:285) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-27T22:06:15.770

我们最近在听起来类似的情况下遇到了这个错误。

原来是因为我们在 DNS 中没有服务器的域名。我们没有使用域名（我们使用了 IP），但似乎 weblogic 需要能够反向查找 IP 地址，否则它会给出这个最具误导性的错误。

我们刚刚将相关行添加到 /etc/hosts ，一切都开始工作了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T14:50:05.383

确实是 DNS 名称解析问题。虽然我在应用程序服务器的 /etc/hosts 中添加了条目，但同样需要在外部服务器中添加，因为它无法解析 DNS。我发现的另一种方法（在 /etc/hosts 中没有任何条目）是在 Weblogic Console-->Server-->Managed Server-->General Tab->Listen Address 字段中，我给出了主机名我的托管服务器。我将其更改为我的托管服务器的 IP 地址，然后能够连接到外部服务器。Listen Address 字段的 More Info 部分说明了一些关于提供 DNS 名称的信息：

要将 DNS 名称解析为 IP 地址，WebLogic Server 必须能够联系适当的 DNS 服务器或在本地获取 IP 地址映射。因此，如果为侦听地址指定 DNS 名称，则必须让端口保持足够长的时间以使 WebLogic Server 实例连接到 DNS 服务器并缓存其映射，或者必须在本地文件中指定 IP 地址映射。如果为 ListenAddress 指定 IP 地址，然后客户端请求指定 DNS 名称，WebLogic Server 将尝试解析 DNS 名称，但如果无法访问 DNS 名称映射，则请求将失败

# java - Mirth: calling an SSL SOAP web service with a client certificate

> ID：940404
> 
> 赞同：1
> 
> 时间：2009-06-02T16:11:14.953
> 
> 标签：java, web-services, ssl, client-certificates, mirth

The scenario is around calling an external SSL SOAP web service from within Mirth. The web service is requires an SSL/TLS connection along with a client certificate.

The intention is to use the built-in SOAP Sender Destination to call the remote secure web service, and somehow include that client certificate.

I understand that you first need to install that client certificate into the Java runtime. This may be within the Java runtime's certificate store or the Jetty certstore.

The platform:

*   Windows 2003 SP2
*   Mirth 1.8
*   Java jre1.5.0_09

**Question**: what configuration steps (Mirth, JRE certificate stores, etc.) would you suggest to successfully have a Mirth SOAP Sender include a client certificate (*.cer) when calling a web service secured by SSL?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T16:21:24.097

如果设置了某些系统属性，Java 运行时，或者更具体地说，Sun JSSE 提供程序，将提供客户端证书。您可以阅读[JSSE 参考指南中的详细信息，](http://java.sun.com/j2se/1.5.0/docs/guide/security/jsse/JSSERefGuide.html#InstallationAndCustomization)但重要的属性是`javax.net.ssl.keyStore`和`javax.net.ssl.keyStorePassword`。

这种方法有一些缺点。首先，将密钥库密码设置为系统属性，使得在该进程中运行的任何代码都可以访问它——尽管如果安装了 a 则可以控制这`SecurityManager`一点。其次，这些设置将用于通过“默认”创建的任何 SSL 套接字`SSLContext`。如果您需要为不同的端点使用不同的凭据，您将需要一个 Mirth 特定的解决方案。

问题中没有指定起点，但如果从头开始，最简单的方法是创建一个新的 Java 密钥库（“JKS”格式）并生成一个新的密钥对和一个 CSR。将 CSR 发送到 CA 并取回证书后，将其导入同一密钥库。该密钥库已准备好使用。

如果证书已经可用，它很可能与对应的私钥一起存储在 PKCS #12 格式（.p12 或 .pfx 文件）中。这些可以由 Java 应用程序直接使用，但`javax.net.ssl.keyStoreType`需要将属性设置为`"PKCS12"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-11T15:46:47.983

Mirth 1.8 在调用 SOAP Web 服务时无法发送客户端证书。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-27T18:10:29.723

我在这里迟到了一点，但实际上它有可能。通过向 JVM 发送一些配置参数，您可以让底层 SOAP 引擎切换到 HTTPs 并提供正确的证书。

有关为配置 VM 设置哪些参数的详细信息，请参阅此问题

[Java HTTPS 客户端证书认证](https://stackoverflow.com/questions/1666052/java-https-client-certificate-authentication)

你会注意到有很多事情需要处理。通常，一旦您正确配置了证书，HTTPs 和客户端身份验证应该“正常工作”。但是有些服务器对 B2B 风格的客户端不太友好，所以你必须小心。

使用 JDK 6_21 和对证书进行一些调整，我能够让其中一个服务器正常运行，但对于我们来说，这需要大约 15 分钟才能在服务器上正确配置。

这是解决这个问题的另一个问题（对不友好服务器的客户端身份验证）。

[客户端 SSL 身份验证导致 IIS 出现 403.7 错误](https://stackoverflow.com/questions/1531712/client-ssl-authentication-causing-403-7-error-from-iis)

# mysql - 为什么我的日期没有正确排序？

> ID：940405
> 
> 赞同：1
> 
> 时间：2009-06-02T16:11:27.420
> 
> 标签：mysql, sorting, date

我想知道是否有人以前遇到过这个问题。
我有一个字符串转换为日期并按升序排序。日期按数字排序，但未按月份排序。我想知道是否有人遇到过这个问题，并且可以就如何正确排序日期提供一些见解。

```
SELECT
  u.url_id, 
  url, 
  title, 
  description, 
  pub_date, 
  DATE_FORMAT(STR_TO_DATE(pub_date, '%d-%b-%Y'), '%d.%b.%Y') AS pub_date,
  pub_date AS sortdate 
FROM 
  urls AS u, 
  url_associations AS ua 
WHERE
  u.url_id = ua.url_id 
  AND ua.url_category_id=$type
  AND ua.approved = 'Y'
ORDER BY
  sortdate DESC 
```

以上是代码，它可以工作，但日期没有排序，例如它的排序如下：

```
 29-may-2009
 28-may-2009
 27-may-2009
 02-june-2009
 01-june-2009 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T16:14:05.673

我有过类似的问题。我所做的（并且仅使用 ORACLE）是在您的 orderby 中使用 date_format 而不是已经格式化的日期。

所以在你的订单中使用：

```
DATE_FORMAT(STR_TO_DATE(pub_date, '%d-%b-%Y') DESC 
```

或 - 将首先按年订购

```
DATE_FORMAT(STR_TO_DATE(pub_date, '%Y-%b-%d') DESC 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T16:15:42.287

好吧，我之前有点困惑。当您在列列表中选择时，您的原始查询有些混乱`pub_date`，然后转换*也*为`pub_date`. 但是，您随后按`pub_date`列排序（实际上，给定`sortdate as pub_date`） - 这似乎是一个字符串列。

您的排序应该在转换为日期之后但*在**转换*为字符串之前的列上：

```
SELECT
  u.url_id, 
  url, 
  title, 
  description, 
  pub_date,
  STR_TO_DATE(pub_date, '%d-%b-%Y') AS sortdate,
  DATE_FORMAT(STR_TO_DATE(pub_date, '%d-%b-%Y'), '%d.%b.%Y') AS formatted_date
FROM 
  urls AS u, 
  url_associations AS ua 
WHERE
  u.url_id = ua.url_id 
  AND ua.url_category_id=$type
  AND ua.approved = 'Y'
ORDER BY
  sortdate DESC 
```

请注意，我已将“格式化”版本重命名为`formatted_date`. 目前尚不清楚您是否还需要选择原件`pub_date`。该`formatted_date`位可能是：

```
DATE_FORMAT(sortdate, '%d.%b.%Y') AS formatted_date 
```

但我不完全确定。我希望查询优化器无论如何都能解决这个问题。

你的`pub_date`专栏真的必须是一个字符串吗？为什么不将其作为更合适的类型保留在数据库中，以避免所有的解析呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T16:14:18.370

看起来“pub_date”是一个字符串字段？如果是这样，您需要将其转换为日期时间才能按预期进行排序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T16:14:56.890

您告诉查询对转换后的字符串进行排序，这意味着它正在对**字符串**而不是**日期**进行排序。请尝试按 pub_date 订购。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T16:54:53.680

你想这样排序..

```
ORDER BY DATE_FORMAT(STR_TO_DATE(pub_date, '%d-%b-%Y'), '%d.%b.%Y') 
```

但如果可以的话，我认为您应该考虑将基列从字符串更改为日期 - 有很多原因：可扩展性、性能、可维护性、数据完整性、yada yada yada。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-02T16:13:04.720

尝试

```
"SELECT u.url_id, url, title, description, pub_date, DATE_FORMAT(STR_TO_DATE(pub_date, '%d-%b-%Y'), '%d.%b.%Y') AS pub_date, pub_date AS sortdate FROM urls AS u, url_associations AS ua WHERE u.url_id = ua.url_id AND ua.url_category_id=$type AND ua.approved = 'Y' ORDER BY pub_date DESC"; 
```

问题是你有

```
 pub_date AS sort_date 
```

在查询内部，因此当您按 sort_date 排序时，您按字符串排序。将排序顺序替换为

```
ORDER BY pub_date DESC 
```

一切都应该工作。

# c++ - Windows Mobile 无法卸载

> ID：940407
> 
> 赞同：3
> 
> 时间：2009-06-02T16:12:02.223
> 
> 标签：c++, windows-mobile, installation, uninstallation

在某些 WM Std 6.1 上测试我的应用程序，我发现它无法卸载。我收到此错误：

“[app] 没有被完全删除。是否要将其从已安装程序列表中删除？”

检查我的 setup.dll 我可以知道每次都调用 Uninstall_Init 和 Uninstall_Exit 但所有文件都保留（它们没有被锁定，我已经检查过）并且它的条目不会从已安装的应用程序列表中消失（无论我选择它留下与否）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T17:22:03.770

这实际上只有三个可能的原因：

1.  Uninstall_Init 不返回继续。
2.  Uninstall_Exit 不返回继续。
3.  安装程序引擎失败。

如果您已经验证了 1 和 2 就可以了，那么 3 将很难弄清楚。

我遇到的一些问题：

*   检查您的安装 DLL 的 DLL 依赖项并尝试删除尽可能多的。我发现对 MSXML 的依赖可能会导致问题。
*   删除 INF 文件中的所有注册表设置，将其移动到设置 dll 中。因此，我发现这会导致随机设备上的卸载随机失败。

我需要为现有客户做的是编写一个卸载应用程序，以便在卸载成功时手动删除我们的应用程序。如果您确实需要编写手动卸载，您需要执行以下操作： * 删除所有注册表项 * 删除所有文件 * 删除注册表项 HKLM\Security\AppInstall{app name} * 在 WM6.1 中，您需要删除来自 EDB 数据库“SwMgmtMetadataStore”的数据库记录，其中 SWT_INSTALL_NAME_TAG 属性等于您的 {app name}。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T02:14:22.103

另一件值得调查的事情是 cab 安装/卸载过程创建的安装日志。

您可以在 \Application Data\Volatile\ 目录（通常称为 setup.log）中找到它。

将此文件复制到您的台式 PC 并在记事本中打开它可能会提供更多关于卸载失败原因的线索（例如卸载期间正在使用的文件）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-08T11:57:12.893

我有几个在 WM 6.0 上完美运行的 CAB 文件，但在 WM 6.1 中停止运行。

原来这是因为 AppName 或制造商中有空格。删除空格修复了 CAB 文件，它们现在在 WM 6.1 中成功卸载！

# .net - 如何创建行特定的 sql 缓存依赖项？

> ID：940418
> 
> 赞同：5
> 
> 时间：2009-06-02T16:13:32.083
> 
> 标签：.net, sql, caching, dependencies, row

我想在我的 .net C# 应用程序上使用数据缓存。到目前为止，我添加了数据缓存并在特定表上添加了 sql 缓存依赖项。但这还不够好。这些表会更新得太频繁，但与很多缓存对象无关。这将使数据缓存几乎无用，因为它会被频繁刷新。我想对每个对象的特定行实现 sql 缓存依赖。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T18:21:01.743

您需要了解 SqlDependency 的工作原理。您[订阅一个结果集并在该结果集发生更改时收到通知](http://rusanu.com/2006/06/17/the-mysterious-notification/)。您可以订阅任何类型的结果集，即任何类型的查询，只要它符合[受支持语句的限制](http://msdn.microsoft.com/en-us/library/ms181122(SQL.90).aspx)即可。如果是表格或视图，这真的没有区别。

因此，从技术上讲，您可以通过提交特定于该行的查询来订阅特定通知，即。带有硬编码的 WHERE 子句。您必须更改代码以逐行检索和缓存所需的数据，而不是检索整个表并将它们缓存在内存中。哎呀，如果您至少关心这些表的大小，那么无论如何您都必须这样做。只应为不经常更改或根本不更改的目录和参考数据缓存整个表。

您还可以选择检索和缓存数据的分区，即。各个键范围（比如在“A”和“D”、“E”和“H”等之间，并订阅该特定数据分区的通知。

如果您想[了解 SqlDependency 的工作原理](http://rusanu.com/2006/06/17/the-mysterious-notification/)，我的博客中有一些文章涵盖了它，包括[SqlDependency 的常见编程陷阱和 SqlDependency 的](http://rusanu.com/2008/01/04/sqldependencyonchange-callback-timing/)部署[问题](http://rusanu.com/2007/11/10/when-it-rains-it-pours/)。

# javascript - 获取高度以在绝对模式下定位 div

> ID：940428
> 
> 赞同：1
> 
> 时间：2009-06-02T16:15:54.267
> 
> 标签：javascript, css, html, height, css-position

因为我的最后一个问题立即得到了回答.. 我决定发布一个新的，它把我所有的头发都拿走了，XD

这就是问题..

我有一个绝对定位的 div 的设计。它有一个透明的 png 和一个简单的锚点......就像这样。

```
<div class="buyfloat">
      <img src="img/buy.png" />
</div> 
```

所以..我需要这个 div.buyfloat 定位在一个绝对位置...不要四处移动..不跳跃不褪色..我只需要距离页面最底部 200px 的位置...因为我只需要它我的页脚的顶部.. 随着页面高度的增加或减少.. 我不能使用顶部选择器。

好吧..“使用底部！” 你可能会说..是的先生我试过..但出于某种原因..底部选择器使用窗口高度（可见部分）而不是整个东西..如果我向下滚动页面..图像是就在页面的中间。

```
.buyfloat{
    width:333px;
    height:135px;
    position:absolute;
    left:10px;
    bottom:200px; /**   not working         **/
    margin:5px auto 0 auto;
    z-index:99;
} 
```

我正在寻找一些javascript（我想我前一段时间看过一个），它可以让我在css上获得正确的身高。但如果你有任何不同且更简单的解决方案..我全神贯注！

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T16:22:16.920

请记住，“位置：绝对”实际上是相对于具有“静态”以外的位置值的元素的第一个祖先（参见[http://www.w3.org/TR/CSS2/visudet 中的第 4 点。 html# contains-block-details](http://www.w3.org/TR/CSS2/visudet.html#containing-block-details)）。所以也许你有这种情况，“底部”是从其他元素而不是 html/body 测量的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T16:34:11.473

首先，JS 在 CSS 中工作的唯一方式是通过仅 IE 的“表达式”，其次，这将要求您的用户也打开 JS。

pos:abs 从正常布局中移除元素，并相对于最近的绝对或相对父级放置它。如果您使用的是严格的或过渡性的 xhtml，那么如果您也将 body 设为相对，bottom 绝对可以工作：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <style>
        body {height: 9000px;position:relative;}
        #a {position:absolute; bottom:0px;}
        </style>
    </head>
    <body>
    <div id="a">bottomDweller</div>
    </body>
</html> 
```

# jquery - Jquery触发点击

> ID：940429
> 
> 赞同：0
> 
> 时间：2009-06-02T16:16:11.960
> 
> 标签：jquery, triggers

我一直在尝试使用 jquery 来触发点击。

我发现触发的点击是这样的： $(button).trigger('click'); 不要遵循href。我一直在尝试通过触发提交按钮来进行 ajax 提交，但没有成功。

我知道我可以直接提交。但是有什么方法可以触发按钮吗？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T17:48:22.187

jQuery 不会故意触发对 A 元素的原生“点击”。我不知道为什么。

但是您可以使用他们使用的技术来自己触发链接：

```
$link[0].click(); // extract the native DOM element and trigger the click 
```

这是未经测试的，但它是从 jQuery 源代码中提取的，应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T16:21:58.993

我不明白你为什么需要这样做。也许您希望提交按钮的标签与表单一起提交（这样您的服务器代码就知道按下了哪个按钮）。在这种情况下，您可以执行以下操作：

```
var $form = $("form"); // your form
var $button = $(":submit",$form); // your button
var $hidden = $("<input type='hidden' />");

$hidden.attr("name",$button.attr("name"));
$hidden.val($button.val());

$form.append($hidden);
$form.submit(); 
```

我确信这可以优化，但它会起作用（它将使用提交按钮模拟“真实”提交）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T17:02:47.117

不知道你为什么要这样做，但我在这里用下面的方法测试过它并且它有效。

```
<form id="frm" action="#">
 <input type="submit" id="btnSubmit" />
  ...
  ...
</form> 
```

调用这个 -> jQuery("#btnSubmit").trigger("click");

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-19T16:51:04.593

另一种选择，在 Chrome、Firefox、IE6、IE8 中测试：

```
window.location = $('a').trigger('click').href('attr'); 
```

我最终使用了它，因为我们对点击事件有默认的 jquery 链接处理，但我们还想触发实际的链接访问（链接可以是散列或跨域链接）。

# certificate - 如何将他人的服务证书加载到我的 WebLogic 信任库？

> ID：940432
> 
> 赞同：0
> 
> 时间：2009-06-02T16:16:45.860
> 
> 标签：certificate, weblogic, truststore

一项在线服务向我提供了他们的证书（一个 pfx 文件）及其密码。

我希望将其加载到我在 Unix 中的 WebLogic 8.1 信任库中。

我的 WebLogic 中当前存在一个信任库。

我是新手，所以我想知道将对方的证书添加到我现有的 WebLogic 密钥库的过程是什么。

我需要将 pfx 文件转换为 Unix 的不同文件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-27T14:33:58.133

I did [something similar](http://jonwilliams.wordpress.com/2009/07/27/configure-ssl-for-nodemanager/)--import a self-signed certificate into custom keystore on 9.x.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-01T10:41:07.953

您可以尝试使用开源 GUI 密钥工具替换 Portecle。

[http://freshmeat.net/projects/portecle/](http://freshmeat.net/projects/portecle/)

# sharepoint - 将 SharePoint 超链接列输出为 URL

> ID：940433
> 
> 赞同：2
> 
> 时间：2009-06-02T16:16:57.590
> 
> 标签：sharepoint, xslt

我有一些文档 URL 存储在 Sharepoint 发布列中。当我使用以下命令将信息输出到 HTML 页面时：

```
<xsl:value-of select="@[ColumnName]" /> 
```

在`ItemStyle.xml`, 我得到`[url]`,`[document name]`在页面中。我想将此显示为 URL 任何人都可以帮助使用 XSL 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T18:21:57.860

你可以使用：

```
<xsl:value-of select="substring-before(@[ColumnName],',')"/> 
```

或任何分隔符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T09:23:09.430

[谢谢大家，最后我根据sguk](http://suguk.org/forums/thread/17877.aspx)的帖子想出了以下内容

```
<xsl:variable name="Doc">
  <xsl:call-template name="OuterTemplate.GetTitle">
    <xsl:with-param name="Title" select="@DocumentLink1"/>
  </xsl:call-template>
</xsl:variable> 
```

带有以下标签代码：

```
<a href="{substring-before($Doc,',')}">
  <xsl:value-of select="substring-after($Doc,',')" />
</a> 
```

或图像：

```
<xsl:variable name="Image">
  <xsl:call-template name="OuterTemplate.GetTitle">
    <xsl:with-param name="Title" select="@img" />
  </xsl:call-template>
</xsl:variable> 
```

带有以下 img 标签：

```
<img src="{substring-before($Image,',')}" alt="{substring-after($Image,',')}" /> 
```

我将解决方案放回此处，因为事实证明这很难弄清楚（可能是我的错，因为我并没有真正“获得”XSL），但以防万一有人在寻找它，此代码会输出来自“ Sharepoint 中的“超链接”或“图片”列类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-27T04:48:51.270

在 SharePoint 2013 中，您必须做一些不同的事情，因为`@Url`属性不再用逗号分隔。现在有 的`.desc`子属性`@Url`。下面是一个如何工作的示例，希望这可以节省其他人一些时间。

```
 <xsl:template name="dvt_1.rowview">
    <xsl:if test="string-length(@URL) &gt; 0">
      <div class="link-item item">
        <a title="{@Comments}" target="_blank" href="{@URL}">
          <xsl:value-of select="@URL.desc" />
        </a>
      </div>
    </xsl:if>
  </xsl:template> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T21:14:03.693

您可以做的另一件事是获取正确显示 URL 的列表（如链接列表）并使用 SharePoint Designer 将其转换为 DataView WebPart。将有适当的 XSL 进行转换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-16T14:06:23.240

希望这会有所帮助。输入超链接时显示“项目站点”，未输入时显示空格。

```
 <!--Project Site--><TD Class="{$IDAAO2UG}">
        <xsl:variable name="Field" select="@Project_x0020_Site" />
        <xsl:choose>
            <xsl:when test="substring-before(@Project_x0020_Site, ', ')=''"><xsl:value-of select="substring-after(@Project_x0020_Site, ', ')" /></xsl:when>
            <xsl:otherwise><A HREF="{substring-before(@Project_x0020_Site, ', ')}">
                <xsl:choose>
                    <xsl:when test="substring-after(@Project_x0020_Site, ', ')=''"><xsl:value-of disable-output-escaping="no" select="substring-before(@Project_x0020_Site, ', ')" /></xsl:when>
                    <xsl:otherwise><xsl:value-of select="substring-after(@Project_x0020_Site, ', ')" /></xsl:otherwise>
                </xsl:choose>
                </A></xsl:otherwise>
        </xsl:choose>
        </TD> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T10:27:54.433

最简单的方法是使用 SharePoint 设计器：

*   单击显示“ [http://link](http://link) , description”的字段
*   将出现一个带有 > 的框，单击它，您将获得“common xsl:value-of tasks”弹出框。
*   它将具有字段名称和类型，类型设置为“文本”。
*   将类型更改为“超链接”，您将获得一个允许您格式化超链接的框。它将已填充所有必要的 xsl，但您可以输入自己的文本或删除链接。

# wpf - 更改 WPF WebBrowser 控件上的“活动内容”安全设置

> ID：940435
> 
> 赞同：19
> 
> 时间：2009-06-02T16:17:12.740
> 
> 标签：wpf, activex, wpf-controls

我正在组装一个 WPF 应用程序，一旦文件保存为 .MHT 或 .HTML，用户就可以通过 WebBrowser 控件查看 PowerPoint 文件。问题是这些文件包含 ActiveX 控件，默认情况下，WebBrowser 控件在我每次加载这些文件时都会显示警告，说“为了帮助保护您的安全，您的 Web 浏览器已限制此文件显示可以访问您的活动内容计算机。”

我在网上看到几个不同的地方谈论将[网络标记](http://msdn.microsoft.com/en-us/library/ms537628(VS.85).aspx)放入每个页面，但在这种情况下这对我来说真的不起作用，因为内容作者可以控制文件，而不是开发人员，我' 宁愿不告诉他们必须在记事本中打开每个文件并在每个文件中添加网络标记。

有什么方法可以更改 WebBrowser 控件的设置以不显示该警告消息？IE 也有类似的设置，但它不会延续到此控件中。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-05T14:27:47.610

我们最终找到了一个不错的解决方案，尽管我仍然希望控件本身有某种设置。要加载文档，我们只需设置`browser.Source`如下：

file://127.0.0.1/c$/path/to/the/file（其中路径为不带C:\的绝对路径，例如c$/Users/jschuster/mydocument.html）

无论出于何种原因，控件都将以该格式显示 URL 引用的文件，而不会发出警告。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-01-13T08:37:40.317

希望这可能对某人有所帮助，即使这个问题有点老了......

根据[“The Mark Of The Web”](http://msdn.microsoft.com/en-us/library/ms537628%28VS.85%29.aspx)的链接，添加如下评论

```
<!-- saved from url=(0016)http://localhost --> 
```

就在 HTML 标签下工作。

我的 index.html 位于 HTML 文件夹中，使用 WebBrowser 控件在 WPF 项目中添加为“内容”设置为“始终复制”。执行期间文件的地址如下所示：

```
file:///E:/SRC_2013/WebBrowserTestApp/WebBrowserTestApp/bin/Debug/HTML/index.html 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T23:31:39.730

为什么不在加载时在文件开头动态插入 MOTW？

顺便说一句，谢谢你的问题：我不知道“网络标记”，它解决了我遇到的一个问题:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-08T17:38:24.923

file://127.0.0.1/c$/path/to/the/file (where the path is an absolute path without C:\, for example, c$/Users/jschuster/mydocument.html)

This worked for me as well on Win7.

# c# - C# 中 node.GetElementsByTagName 的问题

> ID：940436
> 
> 赞同：1
> 
> 时间：2009-06-02T16:17:20.243
> 
> 标签：c#, xml, readxml

我有一个非常简单的 XML 文件，我正在尝试读取它，但我似乎无法让它工作。这是 XML 文件：

```
<?xml version="1.0"?> <Results><One>45364634</One><Two>-1</Two><Three>B</Three></Results> 
```

我正在尝试获取两个这样的内容：

```
XmlNode node = doc.DocumentElement.SelectSingleNode("/Results/Two"); 
```

或者

```
XmlNodeList list = doc.GetElementsByTagName("Two"); 
```

两者都不起作用。当我将 XML 作为字符串复制粘贴到 XmlDocument 中时，它就可以工作了。但是，当我使用从响应中提取的字符串（从中获取 XML）时，它不起作用。

我想知道这是否像字符问题或没有查看正确的根一样奇怪，但我无法弄清楚。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T16:26:20.163

检查 XML 文件编码...

是安西吗？utf-8 还是 utf-16？

检查是否从文件中加载了 xml。检查是否有任何错误，查看文档是否已填充。

我认为从文件加载时没有填充文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:32:00.740

通过您使用“响应”一词，我假设您通过 http 传递 xml？如果是这样，请尝试使用 HttpServerUtility.HtmlDecode( xml ) 看看是否有效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-29T19:48:31.530

呜呜。

原来我在 XML 文档中返回了一个 XML 文档。这就是为什么打印到屏幕上看起来不错但我无法将其拉出的原因。

多谢你们。

# asp.net - 页面加载（）或页面初始化（）

> ID：940440
> 
> 赞同：16
> 
> 时间：2009-06-02T16:18:11.303
> 
> 标签：asp.net, pageload, page-init

在 asp.net 中，你什么时候绑定你的 gridviews？在 Page Load() 或 Page Init() .... 为什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-02T16:21:21.630

您通常应该在 Load() 处或之后绑定。Init() 事件旨在允许您在绑定发生之前创建任何动态创建的控件，以便在需要进行绑定时它们存在。Load() 不是唯一的选择，但是……如果您出于某种原因需要延迟对控件的绑定，您也可以在 PreRender() 事件中进行绑定。如果需要，还可以在 Load() 中进行进一步设置，调用页面的 DataBind() 方法，并处理页面绑定事件以更加结构化的方式进行绑定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T16:26:53.783

It would depend on the particular case, however, the most common answer would be `Page_Load` because that is generally sufficient for most databinding scenarios.

Even for complex databinding scenarios, `Page_Init` would ***not*** be an appropriate place because container controls like the GridView load their children only during the `Page_Load` event. You need to go farther down the life cycle to access those children.

In my case, however, the answer would be "neither". This is because I never databind a control directly within `Page_Load`. What I instead prefer is to have a separate method which does the databinding and can be called from Page_Load or any other function if I need to re-bind after postbacks.

# agile - 当设计赶上实施时避免杂乱无章

> ID：940441
> 
> 赞同：1
> 
> 时间：2009-06-02T16:18:28.510
> 
> 标签：agile, implementation

我是一名承包商，经常被带入项目中，以便在截止日期前实现功能。尽管我的步伐常常比底层设计更快。因此，在等待最终设计时，我经常不得不创建函数/方法以初步方式执行任务。

举个例子，目前我的任务是以一种对于当前数据库设计来说过于复杂的方式执行一些记录的默认排序（实际上我会使用 MySQL 的“字段”功能，除非我认为 Java/Hibernate 不支持它）。所以我创建了一个函数，记录可以暂时在应用程序级别进行排序，一旦必要的数据库设计工作完成，可以重新实现或完全避免。

我担心的是，一旦完成了所有必要的设计（一般和/或特别针对上述场景），我不想留下可能不必要的功能/方法的痕迹。有时它们可​​能会为设计增加价值，但有时它们最终可能会成为不必要的间接层。

我应该对此有多担心？我能做些什么来减轻这种情况？通常作为一个*非常*短期的承包商，我通常没有时间或权力来实施诸如“战略模式”之类的东西，如果我实际上负责整体设计，这可能是我的倾向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T16:30:26.340

我认为随着代码库的发展，预计会有一定数量的杂乱无章。即使您尝试系统地删除旧的未使用代码，也很难将其全部删除。在我的系统中找到可以删除的未使用代码总是令人满意的。

强类型是你的朋友，因为它允许你以比弱类型更好的方式跟踪类型和用法。所以远离那些字符串数据类型，它们使清理变得更加困难。

一个非常巧妙的技巧是，如果您可以通过同时运行代码覆盖工具的测试系统重放来自生产系统的 24 小时流量。这通常是死代码的金矿，但很难找到时间来处理如此大量的清理以及其他优先事项；）

# python - 从python中的字典列表中获取特定索引项的列表（列表理解）

> ID：940442
> 
> 赞同：1
> 
> 时间：2009-06-02T16:18:43.067
> 
> 标签：python

我有一个像这样的字典列表：

```
listDict = [{'id':1,'other':2},{'id':3,'other':4},{'id':5,'other':6}] 
```

我想要字典中所有 id 的列表。所以，从给定的列表中，我会得到列表：

```
[1,3,5] 
```

应该是一行。我知道我以前做过这个，我只是忘记了语法......谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T16:22:07.263

```
>>> listDict = [{'id':1,'other':2},{'id':3,'other':4},{'id':5,'other':6}]
>>> [item["id"] for item in listDict]
[1, 3, 5] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T16:20:59.930

```
[i['id'] for i in listDict] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-01T21:03:00.143

根据您的数据有多大，在概念上更令人愉悦且可能更快的方法。

使用 pandas 包将键简单地称为列标题并使用相同的键对值进行分组：

```
import pandas as pd
listDict = [{'id':1,'other':2},{'id':3,'other':4},{'id':5,'other':6}]
df = pd.DataFrame(listDict)

# Then just reference the 'id' column to get a numpy array of it
df['id']

# or just get a list
df['id'].tolist() 
```

在下面的一些基准测试中，pandas 在大数据上的表现明显优于。小案例使用给定的 3 个条目，大案例有 150k 条目：

```
setup_large = "listDict = [];\
[listDict.extend(({'id':1,'other':2},{'id':3,'other':4},\
{'id':5,'other':6})) for _ in range(50000)];\
from operator import itemgetter;import pandas as pd;\
df = pd.DataFrame(listDict);"

setup_small = "listDict = [];\
listDict.extend(({'id':1,'other':2},{'id':3,'other':4},{'id':5,'other':6}));\
from operator import itemgetter;import pandas as pd;\
df = pd.DataFrame(listDict);"

method1 = '[item["id"] for item in listDict]'
method2 = "df['id'].tolist()"

import timeit
t = timeit.Timer(method1, setup_small)
print('Small Method LC: ' + str(t.timeit(100)))
t = timeit.Timer(method2, setup_small)
print('Small Method Pandas: ' + str(t.timeit(100)))

t = timeit.Timer(method1, setup_large)
print('Large Method LC: ' + str(t.timeit(100)))
t = timeit.Timer(method2, setup_large)
print('Large Method Pandas: ' + str(t.timeit(100)))

#Small Method LC: 8.79764556885e-05
#Small Method Pandas: 0.00153517723083
#Large Method LC: 2.34853601456
#Large Method Pandas: 0.605192184448 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T17:51:56.237

对于 python 极客：

```
import operator
map(operator.itemgetter('id'), listDict) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T16:21:57.980

[elem['id'] 用于 listDict 中的元素]

# winapi - QT 和 Win32 控制台应用程序

> ID：940443
> 
> 赞同：1
> 
> 时间：2009-06-02T16:18:43.877
> 
> 标签：winapi, console, qt4

我有一个显示此行为的 Win32 控制台应用程序。

1）使用VC 2005 cl编译和链接，应用程序工作正常。我所说的工作正常的意思是根据代码页 437 正确显示 128 以上的字符。

2）当我使用 QT qmake 构建项目（QT += 控制台）和 SOURCES = main.c 时，构建顺利，我的 main.exe 被创建。但是 128 以上的字符，使用 WriteConsoleOutput 函数显示不同（一些奇怪的字符）。我觉得这与代码页设置不正确有关。我没有调用任何 QT 函数，也没有创建 QApplication 或 QCoreApplication 对象。当我创建 QApplication 对象或 QCoreApplication 对象时，结果相同（未显示正确的字符）。

有没有办法使用 Win32 控制台和 QT 正确显示 128 以上的字符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T19:20:39.307

`WriteConsoleA`我通过使用函数解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:31:21.693

`WriteConsoleOuput`如果那是 Windows 特定的 API，我当然不建议使用。Qt 提供了一种写出字符串的简单方法[`QTextStream`](http://doc.trolltech.com/4.5/qtextstream.html)：

```
// setup
QFile f;
f.open(stdout, QIODevice::WriteOnly);
QTextStream qout(&f);

// usage
qout << tr("translate this text"); 
```

如果可能，我建议您对所有内容都使用 UTF-8。那么您不必担心不同的编码等。如果由于某种原因需要以本地编码输出，请考虑[`QString::fromLocal8bit()`](http://doc.trolltech.com/4.5/qstring.html#fromLocal8Bit).

# sql-server - 多用途故障转移服务器？

> ID：940449
> 
> 赞同：3
> 
> 时间：2009-06-02T16:20:57.263
> 
> 标签：sql-server, sql-server-2005

我不是 DBA，所以这可能是一个愚蠢的问题，但我还是会问。我们正在将我们的 SQL Server 从 2000 升级到 2005，我们可能会使用数据库复制或数据库镜像。我们的 DBA 想要“多用途”备用服务器，这意味着他想通过在备用服务器上运行其他数据库应用程序来增加我们的能力和容量，因为“它无论如何都会坐在那里”（他的话，不是我的话） . 这是个好主意吗？目前，我们的主应用服务器只使用一个包含 50 多个数据库的实例。据我了解，我们现在正在做的事情以及我们的 DBA 为故障转移服务器提出的建议是一个坏主意，因为所有这些数据库都共享内存、CPU 和工作区域。如果一个应用程序开始表现不佳，

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T16:34:18.370

这真的是一个需要回答的商业问题？如果您负担不起额外硬件的费用，那么一个缓慢的应用程序是否比没有应用程序更好？

备用数据库和镜像数据库可用于报告。如果您有足够的空间，可以将它用作故障转移数据库（即两个数据库都可以在服务器上轻松运行）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:26:08.650

你会依赖这些额外的应用程序吗？在故障转移情况下它们在哪里运行？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T16:41:09.110

你真的需要了解你的失败模式。

如果您将其视为基本的资源数学，那么这通常没有意义，除非您在故障场景中运行的资源可以处理整个预期负载。有时是这样，但并非总是如此。在这种情况下，要处理实际负载，您可能需要另一台服务器进入（例如 RAID - 也许您的负载需要至少 5 台服务器，但您有 6 台服务器场，那么您需要 1 台备用服务器来运行服务器1）以上失败。有时农场可能会退化，但有时他们只是呕吐和死亡。

并且在运行不正常的情况下，您经常会发生事故级联，其中合法事件会导致一连串问题 - 例如，您的备份磁带正忙于从备份恢复服务器（甚至是测试环境 - 没有真正的“失败”），现在您的 sql 服务器或 exhcange 服务器（或两者）未备份，您的日志已满。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T16:45:19.120

在我看来，数据库镜像不是解决问题的方法，因为它仅在数据库级别提供冗余。因此，您需要根据您提供的信息为多达 50 个数据库配置数据库镜像。如果一个数据库全部失败，那么可能会出现 50 个失败，因为失败通常发生在硬件级别，而不是特定数据库。

在我看来，您应该使用 SQL Server 群集技术。您可以创建一个 Active/Active 集群来支持您的要求。

**什么是 Active/Active 集群？**

Active/Active SQL Server 群集意味着 SQL Server 在双向群集的两个节点上运行。每个 SQL Server 副本独立运行，用户看到两个不同的 SQL Server。如果群集中的一个 SQL Server 发生故障，则故障的 SQL Server 实例将故障转移到其余服务器。这意味着 SQL Server 的两个实例都将在一台物理服务器上运行，而不是两台。

**将此应用于您的方案**

然后，您可以在两个 SQL Server 实例之间拆分数据库，每个节点上都有一个活动实例。如果一个节点发生故障，另一个节点将接手，反之亦然。

**延伸阅读**

[SQL Server 群集简介](http://www.sql-server-performance.com/articles/clustering/clustering_intro_p1.aspx)

[我怀疑您会发现以下 MSDN 线程也很有用](http://social.msdn.microsoft.com/Forums/en-US/sqldatabasemirroring/thread/b6787cbc-e165-4730-9fba-7898af1716a6)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T19:53:33.810

“无论如何它都会坐在那里”

它将坐在那里应用交易......

请注意 John Sansom 的建议。请记住，Active/Active 集群需要两个 sql server 许可证，而故障转移集群/镜像只需要一个。

为大量数据库设置镜像可能会变得很痛苦。您还需要任何工作/维护来转移 - 这可以通过 WMI 故障转移事件的警报来实现。可能还有更多需要考虑的事情可能会使事情复杂化。

# html - 在 CSS 文件中使用相对 URL，它相对于什么位置？

> ID：940451
> 
> 赞同：514
> 
> 时间：2009-06-02T16:21:00.303
> 
> 标签：html, css

在 CSS 文件中定义诸如背景图像 URL 之类的东西时，当使用相对 URL 时，它相对于哪里？例如：

假设文件`/stylesheets/base-styles.css`包含：

```
div#header { 
    background-image: url('images/header-background.jpg');
} 
```

如果我通过将这个样式表包含到不同的文档中，`<link ... />`CSS 文件中的相对 URL 是**相对于其中的样式表文档**还是**相对于它所包含的当前文档**？可能的路径，如：`/stylesheets/`

 **```
/item/details.html
/about/index.html
/about/extra/other.html
/index.html 
```

* * *

## 回答 #1

> 赞同：576
> 
> 时间：2009-06-02T16:24:58.323

According to [W3](http://www.w3.org/TR/REC-CSS1/#url):

> Partial URLs are interpreted relative to the source of the style sheet, not relative to the document

Therefore, in answer to your question, it will be relative to `/stylesheets/`.

If you think about this, this makes sense, since the CSS file could be added to pages in different directories, so standardising it to the CSS file means that the URLs will work wherever the stylesheets are linked.

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2009-06-02T16:23:06.357

它与 CSS 文件相关。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2009-06-02T16:28:17.963

它与样式表相关，但我建议使 URL 与您的 URL 相关：

```
div#header { 
  background-image: url(/images/header-background.jpg);
} 
```

这样，您可以移动您的文件，而无需在将来重构它们。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2009-06-02T16:27:11.270

> In order to create modular style sheets that are not dependent on the absolute location of a resource, authors may use relative URIs. Relative URIs (as defined in [[RFC3986]](http://www.ietf.org/rfc/rfc3986)) are resolved to full URIs using a base URI. RFC 3986, section 5, defines the normative algorithm for this process. For CSS style sheets, the base URI is that of the style sheet, not that of the source document.
> 
> For example, suppose the following rule:
> 
> ```
> body { background: url("yellow") } 
> ```
> 
> is located in a style sheet designated by the URI:
> 
> ```
> http://www.example.org/style/basic.css 
> ```
> 
> The background of the source document's BODY will be tiled with whatever image is described by the resource designated by the URI
> 
> ```
> http://www.example.org/style/yellow 
> ```
> 
> User agents may vary in how they handle invalid URIs or URIs that designate unavailable or inapplicable resources.

Taken from the [CSS 2.1 spec](http://www.w3.org/TR/CSS21/syndata.html#value-def-uri).

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-06-02T16:24:21.990

[For CSS style sheets, the base URI is that of the style sheet, not that of the source document.](http://www.w3.org/TR/CSS21/syndata.html#uri)

(Anything else would be broken, IMNSHO)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-01-27T04:03:32.127

一个可能出现的问题，并且似乎打破了这一点，是在使用 css 的自动最小化时。缩小包的请求路径可以具有与原始 css 不同的路径。这可能会自动发生，因此可能会引起混淆。

缩小包的映射请求路径应该是“/originalcssfolder/minifiedbundlename”，而不仅仅是“minifiedbundlename”。

换句话说，将您的包命名为与原始文件夹结构具有相同的路径（使用 /），这样任何外部资源（如字体、图像）都将映射到浏览器的正确 URI。另一种方法是在您的 css 中使用绝对 url( refs ，但这通常是不可取的。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2015-08-10T17:18:53.150

尝试使用：

```
body {
  background-attachment: fixed;
  background-image: url(./Images/bg4.jpg);
} 
```

`Images`是保存您要发布的图片的文件夹。

# windows - 如何为 ReadFileEx() 的完成例程提供上下文信息？

> ID：940461
> 
> 赞同：3
> 
> 时间：2009-06-02T16:22:56.467
> 
> 标签：windows, file-io, asynchronous

Win32`ReadFileEx`定义为：

```
BOOL WINAPI ReadFileEx(
  __in       HANDLE hFile,
  __out_opt  LPVOID lpBuffer,
  __in       DWORD nNumberOfBytesToRead,
  __inout    LPOVERLAPPED lpOverlapped,
  __in_opt   LPOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine
); 
```

我试图弄清楚如何使完成例程（最后一个参数）在操作完成时调用动态函数指针。似乎没有办法传递用户数据。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T16:43:04.287

传递给 ReadFileEx 的 lpOverlapped 函数被传递给 lpCompletionRoutine 函数。

您可以将 lpOverlapped 嵌入到您自己的结构中，然后使用它来查找指向您的上下文的指针：

```
struct ReadFileExContext
{ 
    OVERLAPPED _Overlapped; 
    LPVOID MyContext; 
}; 
```

然后在您的回调函数中，您将 LPOVERLAPPED 转换为 ReadFileContext ，您就可以开始了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T21:42:25.280

今天正在做一些 IO 工作，并在 WSA 和文件读/写函数中注意到，如果您使用完成例程，例如来自 ReadFileEx，则不使用 OVERLAPPED 结构的 hEvent

> ReadFileEx 函数忽略 OVERLAPPED 结构的 hEvent 成员。在 ReadFileEx 调用的上下文中，应用程序可以自由地将该成员用于自己的目的。ReadFileEx 通过调用或排队调用 lpCompletionRoutine 指向的完成例程来表示其读取操作的完成，因此它不需要事件句柄。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-02T16:42:31.760

您可以使用[线程本地存储](http://msdn.microsoft.com/en-us/library/ms686801.aspx)......只需创建一个插槽并存储指向您想要的任何数据的指针。由于 lpCompletionRoutine 在调用线程上运行，你应该没问题。

# svn - 在 Windows 上与 Subversion 集成时使用哪些工具？

> ID：940464
> 
> 赞同：32
> 
> 时间：2009-06-02T16:23:22.287
> 
> 标签：svn, version-control

我刚刚进入 Subversion 进行个人项目，并且有兴趣了解您使用哪些工具与 Windows 平台上的 Subversion 集成。诸如可视化、备份、IDE 集成、问题跟踪集成等。

任何扩展 Subversion 基本功能的东西，真正让它变得更强大。

* * *

很棒的东西，我相信人们使用的东西肯定更多。请继续贡献！

简要总结一下您一直建议的工具和我自己的一些工具，

**颠覆客户**

*   [Tortoise](http://tortoisesvn.net/)在我看来是最好的颠覆客户端。它与 Windows Explorer 集成的事实使它成为一个非常直观的工具，并且它具有我在 subversion 客户端中看到的最好的开箱即用用户体验。内置的差异和历史工具通常不会让我接触其他客户。
*   如果您正在寻找跨平台的东西，[RapidSVN也非常好。](http://rapidsvn.tigris.org/)
*   [SVN-监视器](http://www.svnmonitor.com/default.shtml)

**颠覆服务器**

*   [VisualSVN Server](http://www.visualsvn.com/server/) - 让在 Windows 上设置 subversion 服务器变得轻而易举，它具有简单的基于 MMC 的管理 UI。

**IDE 集成**

*   [Ankhsvn](http://ankhsvn.open.collab.net/)非常适合 Visual Studio
*   [Subclipse](http://subclipse.tigris.org/)是 Eclipse IDE 的集成
*   [VisualSVN](http://www.visualsvn.com/)是 Visual Studio 的另一个流行集成

**错误跟踪系统**

*   [FogBugz](http://www.fogcreek.com/FogBugz/)提供了与 subversion 的一些很好的集成，并为您提供了一个提交后脚本，您可以将其添加到您的 subversion 安装中。我已经使用了一段时间并且非常喜欢它。
*   [Trac](http://trac.edgewall.org/)具有最紧密的 Subversion 集成，并且非常适合错误跟踪和项目管理。

**可视化**

*   [SVNMapper](http://svnmapper.tigris.org/)是一个非常好的可视化分支的工具，但我只是偶尔使用它。如果您的项目广泛使用分支，那么这样的工具将非常宝贵。
*   [WebSVN](http://www.websvn.info/) - 在线颠覆存储库浏览器

**合并**

*   [WinMerge](http://winmerge.org/) - 也是我个人最喜欢的合并工具。

**构建管理/持续集成**

*   [CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome%2Bto%2BCruiseControl.NET)是帮助管理 .NET 项目的持续集成的工具。
*   [TeamCity](http://www.jetbrains.com/teamcity/)是一个持续集成和构建服务器，可以很好地连接 subversion 和许多其他东西

**托管颠覆**

*   [豆茎](http://beanstalkapp.com/)
*   [解惑](http://unfuddle.com/)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-02T16:27:07.963

[Tortoise](http://tortoisesvn.net/) is the classic interface to SVN on windows. It integrates into the Windows shell, so it's just a right-click away to add or checkin a file, or group of files.

It does include some visualisation (showing the structure of the branches and merges). For IDE integration and issue tracking integration, there are other tools, such as add-ins for Eclipse. The repository can also have various 'hooks' setup to perform work beforee/after checkins, such as passing the message you write when you check-in files (you do, don't you?) to a bug-tracker (like Trac) which takes some very simple markup (literally 'ticket:999' or r1234 for a ticket/bug number or revision number) and make them into links and the like.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-02T16:38:57.850

## 颠覆客户

*   [Tortoise](http://tortoisesvn.net/)在我看来是最好的颠覆客户端。它与 Windows Explorer 集成的事实使它成为一个非常直观的工具，并且它具有我在 subversion 客户端中看到的最好的开箱即用用户体验。内置的差异和历史工具通常不会让我接触其他客户。

*   如果您正在寻找跨平台的东西，[RapidSVN也非常好。](http://rapidsvn.tigris.org/)

## IDE 集成

*   [Ankhsvn](http://ankhsvn.open.collab.net/)非常适合 Visual Studio

## 错误跟踪系统

*   [FogBugz](http://www.fogcreek.com/FogBugz/)提供了与 subversion 的一些很好的集成，并为您提供了一个提交后脚本，您可以将其添加到您的 subversion 安装中。我已经使用了一段时间并且非常喜欢它。

*   [Trac](http://trac.edgewall.org/)具有最紧密的 Subversion 集成，并且非常适合错误跟踪和项目管理。

## 分支可视化

*   [SVNMapper](http://svnmapper.tigris.org/)是一个非常好的可视化分支的工具，但我只是偶尔使用它。如果您的项目广泛使用分支，那么这样的工具将非常宝贵。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-02T16:28:43.923

正如其他人所提到的，[乌龟](http://tortoisesvn.tigris.org/)很棒。

此外，对于 Eclipse 集成，我使用[Subclipse](http://subclipse.tigris.org/)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-02T16:24:33.987

We use [Ankh](http://ankhsvn.open.collab.net/) and [Tortoise](http://tortoisesvn.tigris.org/).

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-02T16:32:00.803

我强烈建议[Visual SVN](http://www.visualsvn.com/)。它非常便宜，基本上将 Tortoise 的功能扩展到 Visual Studio。他们俩一起工作得很好。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-06-03T09:09:42.937

其他内容已经说过了，但我可以补充一点，[Beyond Compare](http://www.scootersoftware.com/)是一个很棒的差异/合并工具。虽然它**不是免费**的。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-06-02T16:28:05.203

我已经使用过 AnhkSVN 和 TortoiseSVN，并且必须强烈建议使用 TortoriseSVN 与 SVN 服务器进行交互。Tortoise 中有一些工具可用于统计，但实际上，您将使用它的最重要的事情是您的正常更新和提交，然后是合并和分支。

由于您在“个人”项目中使用它，我假设您将是项目中唯一的人，因此分支可能不是您关心的问题。

还有一些您可能想要研究与 SVN 集成的工具。例如，您可能希望在向服务器提交更改时自动构建代码。在这种情况下，您可以设置 Cruise Control 服务器[链接文本](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)，然后每隔 X 分钟读取您的 SVN 服务器以查找更改。如果发现更改，它会做它的事情。

我没有使用过这个产品，但是 Trac 是一个非常常见的项目管理工具，可以与 SVN 一起使用：[link text](http://trac.edgewall.org/)

另一个未列出的 SVN 提供者是[Assembla](http://www.assembla.com/)。我已经使用过它并且非常喜欢它。但是，我已经有一个[Unfuddle](http://www.unfuddle.com)帐户，所以我继续使用 Unfuddle。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-06-02T16:39:01.203

我推荐[WinMerge](http://winmerge.org/)作为 TortoiseDiff 的替代差异查看应用程序。对于 SVN 的前端，TortoiseSVN 是一个很好的整体工具，但在处理大型（许多文件）项目时可能会变慢。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-06-02T16:36:00.317

If you have other contributors, [SVN-Monitor](http://www.svnmonitor.com/default.shtml) is worth its weight in gold. However, for a single developer, it won't be very useful.

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-06-03T08:55:08.300

[Hudson](http://hudson-ci.org/)是我们的构建管理和持续集成工具。

用java编写，但在windows中无缝工作，作为windows服务安装。通过直观的前端美观且易于配置。与 redmine 和 subversion 很好地集成。一个非常强大，非常易于使用的工具。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-06-02T16:28:16.670

SMARTSVN、TkSVN、Subversion 本机客户端、Subclipse。

我个人非常不喜欢 Tortoise，因为它安装了一个在空闲模式下消耗约 10MB 的守护进程。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-06-02T18:29:50.653

有一个有趣的 Java 存储库浏览应用程序，称为[Sventon](http://www.sventon.org/)。我在测试服务器上玩过这个，喜欢它的发展方向。[PushOK](http://www.pushok.com/soft_svncom.php)还有一些工具可用于将 SVN 集成到 Delphi 和其他开发环境中。我早在 2006 年就在 Delphi 7 中使用了他们的 SVN 代理，它运行得相当好。

在文件比较方面，[BeyondCompare](http://www.scootersoftware.com/)是内置 Tortoise 比较/合并的一个很好的低成本商业替代方案。我也使用过 WinMerge 并给了两个高分。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-02T17:53:10.167

I use both Tortoise and Subclipse concurrently. I tend to grab alot of open source libraries from code.google.com and Tortoise makes it a snap to checkout, and even make copies using SVN Checkout. While working with large team projects Subclipse is the way to go if you're working on projects within Eclipse, once your code is checked out you can still use tortoise to run all sorts commands on the SVN, as well as Subclipse commands, without any major issues.

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-06-02T18:03:36.547

Apart from those already mentioned, I have my SVN install integrated with [Mantis](http://www.mantisbt.org/blog/?p=4), its straightforward, but I did modify my post-commit hook so it tries the regexp in the hook to check whether to update a bug or not (for performance).

I also use [Doxygen](http://www.doxygen.org/) to build documentation for my code, its triggered from a post-commit hook too. When a directory with the x.doxy config file is committed, that directory is written to a file and a cron runs doxygen on a export of those sources at midnight.

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-06-02T17:26:02.313

Like many others, I use Ankh and TortoiseSVN. However, once I upgraded TortoiseSVN to 1.6.x from 1.5.y, all my files in Visual Studio were marked as "New".

The solution, [as I mention in this StackOverflow posting](https://stackoverflow.com/questions/695136/all-files-in-ankhsvn-soloution-marked-as-new/751509#751509), is to update to a later "daily" build of Ankh. This is because the working copy versions were updated to 1.6, but the latest stable version of Ankh was still compiled for version 1.5\. The daily build "recognized" the newer version, and thus the files were marked appropriately.

I have had no problems with the daily build of Ankh that I installed (specific version is AnkhSvn-Daily-2.1.6649.29.msi).

Hope this helps!

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-06-02T18:48:13.147

附带说明：Tortoise 中的差异工具很酷，但我最终每周使用 3 次的工具是 BeyondCompare。我用它来查看签出文件之间的差异，极大的合并灵活性，用它来比较目录，在外部硬盘上保持 MyDocs 的副本是最新的，比较从剪贴板粘贴的文本等。顺便说一句，我不隶属于公司，这只是我花过的最有成效的 30 美元。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-07-20T21:18:10.540

我同意 KSchmidt 的观点，即 winmerge 是 TortoiseDiff 的一个很好的替代品。但是，您还提到它是一个合并工具，这很奇怪，因为 winmerge 不进行 3 路合并...

我确实推荐[KDiff3](http://kdiff3.sourceforge.net/)作为 TortoiseMerge 的替代品，我觉得这有点违反直觉（但这可能只是我 :-)）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-02T16:52:34.837

Visual Studio 的 Ankh 插件 [http://ankhsvn.open.collab.net/](http://ankhsvn.open.collab.net/)

乌龟 [http://tortoisesvn.tigris.org/](http://tortoisesvn.tigris.org/)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-02T18:12:31.133

I like the [Bitten](http://bitten.edgewall.org/) plugin for Trac. It provides continuous integration support by enabling different tasks to be automatically performed when specified paths inside the repository are updated.

I recently used this with a web-based system I was working on to automatically deploy the most recent version of our prototype to our development server from the repository

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-06-02T16:47:06.683

我正在使用 Eclipse 中集成的 Subversive。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-06-21T00:02:59.703

tortoise + redmine

redmine has excellent subversion support... works like a charm an integrates really nice...

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-11-04T17:12:20.840

Beyond Compare 是一个出色的差异程序。它不是那么贵，在我看来它是最好的。

*无耻的插头*

[Sublime](http://www.sublimesvn.com/)是另一个基于 Windows 的 SVN 服务器。它对个人使用免费，但对其他用户收取许可费。它是一个基于 Web 的 subversion 服务器，可处理存储库管理、权限、电子邮件通知和自动 subversion 备份。

*结束无耻插头*

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-06-21T00:08:25.233

我使用[Wush.net](http://www.wush.net "武什网")进行基本的颠覆托管。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-06-02T17:45:48.353

我使用过 VisualSVN 和 Ankhsvn，我更喜欢 VisualSVN。我的 Ankh 撞到了我。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-06-02T20:44:30.540

[Subversive](http://www.eclipse.org/subversive/)是另一个 Eclipse 插件，现在是 Eclipse 孵化的一部分。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-06-03T08:52:32.220

[Redmine](http://www.redmine.org/)是我们选择的错误跟踪系统工具。它就像 Trac，但多 scm 和多项目。很多不错的插件，通常效果很好。Wiki、论坛、新闻、任务跟踪。

# asp.net - 在 2.0 下运行 ASP.NET 1.1 应用程序

> ID：940465
> 
> 赞同：0
> 
> 时间：2009-06-02T16:23:22.597
> 
> 标签：asp.net, migration

我有一个用 ASP.NET 1.1 编写的应用程序。如果我将 IIS 切换为使用 2.0，我可能会遇到什么问题？最初的测试没有引发任何问题，但我想知道是否有人有在 2.0 下运行 ASP.NET 1.1 应用程序的经验，并且可能会指出一些需要注意的地方？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T16:33:29.680

如果它们需要不同版本的 .NET 框架，请确保您没有在同一个应用程序池中运行不同的 Web 应用程序。

创建单独的应用程序池（每个版本的框架至少一个）。

也许还可以看看Brad Abrams 的[这篇关于 .NET 框架 1.1 和 2.0 之间的重大变化的博客文章](http://blogs.msdn.com/brada/archive/2005/11/14/breaking-changes-between-net-framework-1-1-and-2-0.aspx)。这是一个简短的报价：

> ...我们*非常*努力地确保您的 V1.1 应用程序只能在 2.0 上运行，但无论如何，当您迁移到 2.0 时，此文档可能值得快速浏览

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:30:17.637

当我们将 1.1 应用程序迁移到 2.0 时，我认为我们没有任何问题。在少数情况下，编译器警告我们应该使用不同的（更新的）程序集，但除此之外一切都很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T16:34:06.233

大多数 ASP.NET 1.1 应用程序都可以在 ASP.NET 2.0 下正常运行。不过要注意的一点是，您不在同一个应用程序池中运行 ASP.NET 1.1 和 ASP.NET 2.0 应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T16:35:23.173

我们遇到的最大问题是在与 javascript 库连接的 web.config 文件中插入 xhtmlConformance 元素，删除它对我们来说效果很好， [请查看 Scott Gu 的这篇文章](http://weblogs.asp.net/scottgu/archive/2006/12/10/gotcha-don-t-use-xhtmlconformance-mode-legacy-with-asp-net-ajax.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T16:43:37.907

通常将 asp.net 1.1 应用程序迁移到 2.0 不会引发任何问题。您可能需要更改放置类文件的位置。

你会看到一些警告，一些不推荐使用的方法调用等。

# php - Does HTTP hostname case (upper/lower) matter?

> ID：940466
> 
> 赞同：11
> 
> 时间：2009-06-02T16:23:29.103
> 
> 标签：php, http, dns, case-sensitive

In other words, does it matter whether I use [http://www.example.com/](http://www.example.com/) or [http://wwW.exAmPLe.COm/](http://wwW.exAmPLe.COm/) ?

I've been running into strange issues with host-names lately: I have an Apache2.2+PHP5.1.4 webserver, accessed by all kinds of browsers. IE6 users in particular (esp. when their UA string is burdened with numerous BHOs, no pattern yet) seem to have problems accessing the site (cookies disappear, JS refuses to load) when entering via [http://www.Example.com/](http://www.Example.com/), but not [http://www.example.com/](http://www.example.com/)

I've checked the [HTTP](http://www.faqs.org/rfcs/rfc2616.html) and [DNS](http://www.dns.net/dnsrd/rfc/) RFCs, my [P3P policies](https://stackoverflow.com/questions/389456/cookie-blocked-not-saved-in-iframe-in-internet-explorer), cookie settings and [SOP](http://en.wikipedia.org/wiki/Same_origin_policy); yet nowhere I've seen even a mention of domain names being case-sensitive.

(I know path and query string are case sensitive ( `?x=foo` is different from `?x=Foo` ) and treat them appropriately; am doing no parsing/processing on domain name in my code)

Am I doing something wrong or is this just some browser+toolbar crap I should work around?

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-02T16:25:39.167

Domain names are **not** case-sensitive; `Example.com` will resolve to the same IP as `eXaMpLe.CoM`. If a web server or browser treats the `Host` header as case-sensitive, that's a bug.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T16:27:09.370

No, this shouldn't make any difference.

Check out the URL RFC Spec ([http://www.ietf.org/rfc/rfc1738.txt](http://www.ietf.org/rfc/rfc1738.txt)). From section 2.1:

> For resiliency, programs interpreting URLs should treat upper case letters as equivalent to lower case in scheme names

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-17T07:35:04.613

由于您将问题表述为实际问题，然后描述了现实世界的问题，因此答案实际上是：是的。

关于 RFC 规范关于主机名的内容，其他答案是正确的。从技术上讲，它们应该不区分大小写。（事实上​​，较早的约定是顶级域（TLD）应该全部大写......比如“apple.COM”）。

然而，在现实世界中，像操作系统解析器和主流浏览器这样的成熟软件可以做到这一点。任何类型的辅助代码都可能会处理这个错误，并把你搞砸。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T16:28:38.323

根据[https://www.rfc-editor.org/rfc/rfc1035](https://www.rfc-editor.org/rfc/rfc1035)：

> 对于作为官方协议一部分的 DNS 的所有部分，字符串（例如，标签、域名等）之间的所有比较都以不区分大小写的方式进行。目前，该规则无一例外地在整个域系统中生效。

然后它继续说这可能会在未来发生变化。我认为可以安全地假设 COM 域不区分大小写，但其他允许使用非 ASCII 字符的域可能会有所不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T16:25:07.667

No, there is no case sensitivity with regards to the protocol specifier.

[You can see this in the RFC for URLs](http://www.ietf.org/rfc/rfc1738.txt).

> 2.1\. The main parts of URLs
> 
> Scheme names consist of a sequence of characters. The lower case letters "a"--"z", digits, and the characters plus ("+"), period ("."), and hyphen ("-") are allowed. For resiliency, programs interpreting URLs should treat upper case letters as equivalent to lower case in scheme names (e.g., allow "HTTP" as well as "http").

# .net - Custom shaped text box/edit control in .net?

> ID：940471
> 
> 赞同：0
> 
> 时间：2009-06-02T16:24:24.237
> 
> 标签：.net, editor, textbox, shape, editcontrol

I'm looking for a way to display and edit text inside a custom shaped box (e.g. a circle.) The text needs to use as much of the allowed space as possible, so just positioning an edit box inside the shape is not good enough.

Requirements:

1.  Given a GraphicsPath and a string, draw the text within the path. If the text overflows, truncate or raise an event.
2.  Allow the user to edit text within the GraphicsPath.
3.  All the intelligence of the standard text box with respect to word breaks, word wrap, localization.

There don't seem to be any controls out there that fit these requirements. It probably requires low-level line layout APIs to accomplish this, and I can't find documentation in MSDN about such API's in Windows either.

This is for a high precision tool, so we're willing to put in a lot of effort to get what we need.

Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T17:07:26.580

因为您提到它是用于高精度工具，所以我会完全避免依赖内置的 TextRenderer 方法，因为它们在准确性和一致性方面存在问题。

至于对编辑控件进行整形，是指将其形状从矩形更改为圆形，还是控件仍会占用矩形区域？如果是前者，您可以更改 Region 属性或 P/Invoke SetWindowRgn 系列。

# jquery-ui - jQuery UI Sortable and Google gadgets

> ID：940479
> 
> 赞同：0
> 
> 时间：2009-06-02T16:25:14.580
> 
> 标签：jquery-ui, iframe, google-gadget

I have seen a couple similar questions, but nothing that specifically covers my problem. I am trying to place several Google gadgets in a set of sortable divs. When I drag one of these divs and drop it in a new location, the whole page is refreshing and showing me only the content of that gadget's iframe.

I have seen from the other SO questions that Firefox contains a bug in which iframe content is refreshed if it is moved in the DOM tree. That behavior isn't ideal, but I'd gladly take it over what I'm experiencing now. Firefox and Chrome both give me this problem. IE and Opera properly sort the gadgets.

Does anybody have some insight as to how I can work around this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T08:26:51.167

在dragstart 上销毁小部件（即删除iframe）并在拖动完成后重建它呢？

# unit-testing - 如何在 Powershell 中进行 TDD 和单元测试？

> ID：940497
> 
> 赞同：69
> 
> 时间：2009-06-02T16:28:02.050
> 
> 标签：unit-testing, powershell, tdd, pester

随着 MS 将 powershell 推入所有新的服务器产品，我开始（不情愿地）认为我需要认真对待它。“认真对待”的一部分是 TDD。您是否找到了对 power shell 脚本进行单元测试的好方法？

我从[Geek Noise 先生](http://www.peterprovost.org/blog/post/TDD-with-PowerShell-Mocking-Things.aspx)那里找到了嘲笑的样本——但我真的很喜欢[RhinoMocks](http://ayende.com/projects/rhino-mocks.aspx)之类的东西。[Brian Hartsock](http://blog.brianhartsock.com/2009/03/27/tdd-with-powershell-from-the-client-perspective/)有一个来自 MS Test 的 powershell 字符串运行测试示例。有点hacky，但它似乎工作。

我想要的是一种与“真实”语言一样干净的 Powershell TDD 体验。

* * *

**更新澄清：**

前两个答案试图引导我远离测试 Powershell。意见很有趣。我不想知道在 powershell 中测试是否是个好主意。这是一个主观问题，应该在不同的论坛中提出。我想要一个单元测试powershell的解决方案。如果您认为这是一个坏主意（可能是），请将其视为一个有趣的学术问题。

*   是的，脚本语言将不同的系统粘合在一起。然而，正如已经指出的，用动态语言模拟和打破接缝也很容易。
*   我不是在问“调试”。调试是一个非常有用的话题。我让别人问。
*   也许 PS 脚本应该很简单。该语言支持模块化，并且不可避免地会在 PS 中实现复杂的流程（即使是一个坏主意）。
*   这个问题的答案不是“你不能”。我可以看到（从链接的博客 - 有点旧）有些人已经在这个问题上取得了进展。

重新声明：**您如何以 xUnit 的风格实现 Powershell 逻辑的自动化测试？** 集成测试很有趣，打破依赖关系的单元测试最有趣。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2011-01-04T21:31:57.883

Scott Muc 为 PowerShell 启动了一个名为 Pester 的轻量级 BDD 框架项目：

[https://github.com/pester/Pester](https://github.com/pester/Pester)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-08-21T05:21:50.190

[PsUnit](http://psunit.codeplex.com/)现在更新了一个框架。几个月前我遇到了和你一样的问题，我觉得 PsUnit 对于我必须编写的脚本数量来说太大而复杂，所以我为 PS 编写了自己的单元测试框架。PS具有与其他脚本语言（例如python）相同的特性，即您可以随时随地覆盖函数，即使测试方法中的范围非常适合伪造（也称为模拟）。也就是说，如果您要测试的函数或对象依赖于其他函数，则可以在测试方法中声明它们以创建本地假实现。

因此，无论您选择使用哪种测试框架，我都会说 PS 非常容易进行 TDD。这至少是我的经验。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T20:54:56.010

我想你问的是“测试策略”而不是专门的 TDD，所以我会回答这两个问题。

您在 PowerShell 中的大部分工作将通过 cmdlet 和对象管道集成一堆不同的系统。如果您想确信您的 PowerShell 脚本可以正常工作，请尽可能多地努力构建完美的暂存环境，以便尽可能准确地测试所有这些系统。

在完美的暂存环境中运行脚本将比通过 TDD “充实你的设计”或通过事后单元测试“测试代码的意图”更有价值。

可能有帮助的小笔记：

*   该`-whatif`开关存在于内置 cmdlet 上。另外我刚刚发现你也可以这样做：`-whatif:$someBool`- 你会知道什么时候需要它。
*   V2 中的 ISE 有一个调试器。甜的。
*   您始终可以在 C# 中编写自定义 cmdlet 并在那里做任何您想做的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-09-25T10:57:31.807

我正在使用 TDD 编写一些基本的 PowerShell 脚本，如下面的模型：

首先，SUT_spec.ps1 中的规范：

```
Import-Module -Name .\my_SUT.ps1

$case1_input=@{}
$case1_output=@{}
f1 $case1_input $case1_output

$case1_result = $case1_output["Output"] -eq "expected"
"f1 case1: $case1_result"

# repeat for all test cases

Remove-Module -Name my_SUT 
```

其次，我的单位（SUT）作为 my_SUT.ps1 文件中的一个函数：

```
function f1($the_input, $the_output)
{
    #take input from $the_input hashtable, process it and put output into $the_output hashtable.

    $the_output["Output"]="results"
} 
```

第三，可发布的主入口点作为单独的文件，如 SUT_spec.ps1，但输入来自实际外部源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T14:02:58.187

死的讨论，但担忧是非常活跃的。

鉴于 PS 的预期用途涉及到企业系统中的模块，我在讨论单元测试 PS 的有用性时发现缺少的一件事。想象一个企业环境，它有一个中央存储库，用于在 PS 中实现的常见网络/文件级任务。在这种情况下，您有少量的开发人员和网络专家，他们的职责都略有重叠。开发人员创建了一个封装业务逻辑的模块，并且它的有用性立即得到承认，因此其他人很快就会加入并在他们自己的工作中加入该模块。该模块包含在从一次性交互式脚本到中型客户端应用程序的任何内容中；虽然有些人可能不同意 shell 脚本语言的用例，但在这个领域进化是一个常数。

在这种情况下，我相信为这些通用模块定义一组“合同”是有价值的。如果知识共享是组织不可或缺的一部分，那么可能不止一个人会修改这些模块。让单元测试验证模块的完整性将大大有助于维持秩序和最大限度地减少混乱，从而维持（可能增加）模块本身的价值。

至于首选的方法，我还没有采用。PS 让人想起流体/动态/敏捷的物质。将它包含在一个僵化的结构中，就像我在 TDD 中看到的那样，感觉很不自然。但是，鉴于上述情况，这个目标不容忽视。没关系，我很伤心，很抱歉浪费你的时间。感谢您的阅读。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-06-02T18:32:31.647

从你的问题来看，我认为你正在走向失望。Powershell 只是一种小小的命令行语言。当然，它*可以*做 C# 可以做的任何事情，甚至更多，但汇编语言也可以。当然，它也是 OO 并与 .NET 库挂钩，但 C# 也是如此，它是一种更简洁的语言。

如果一个解决方案比一个班轮更长，或者您认为您需要对它进行 TDD，那么您就不想使用 Powershell。这是一种充满惊喜的神秘语言，任何复杂的事情都应该避免。

如果您想做一些特别的搜索和替换或格式化文本，或者在您的文件系统中查看，那么 Powershell 是您的朋友。您真正想做的是每天使用一点，并经常重复自己，以便熟悉语法。出于这个原因，还要避免使用开源 Powershell 库，并且忘记编写自己的 CmdLets，除非您有一个非常专门的临时命令行使用案例。管道绑定规则晦涩难懂。

当然，这只是我的观点，但我是 Powershell 的长期用户，现在我对它更满意了，因为我是这样看待它的。

# java - ThreadLocal 资源泄漏和弱引用

> ID：940506
> 
> 赞同：19
> 
> 时间：2009-06-02T16:28:59.883
> 
> 标签：java, thread-local, weak-references

[我对ThreadLocal](http://java.sun.com/javase/6/docs/api/java/lang/ThreadLocal.html)的有限理解是它存在[资源泄漏问题](http://www.google.com/search?q=threadlocal+leak)。我收集到这个问题可以通过正确使用带有 ThreadLocal 的[WeakReferences](http://java.sun.com/javase/6/docs/api/java/lang/ref/WeakReference.html)来解决（尽管我可能误解了这一点。）我只是想要一个正确使用带有 WeakReference 的 ThreadLocal 的模式或示例（如果存在）。例如，在这段代码片段中，WeakReference 会在哪里引入？

```
static class DateTimeFormatter {
    private static final ThreadLocal<SimpleDateFormat> DATE_PARSER_THREAD_LOCAL = new ThreadLocal<SimpleDateFormat>() {
        protected SimpleDateFormat initialValue() {
            return new SimpleDateFormat("yyyy/MM/dd HH:mmz");
        }
    };
    public String format(final Date date) {
        return DATE_PARSER_THREAD_LOCAL.get().format(date);
    }
    public Date parse(final String date) throws ParseException
    {
      return DATE_PARSER_THREAD_LOCAL.get().parse(date);
    }
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-02T16:57:33.443

`ThreadLocal`在内部使用 a `WeakReference`。如果`ThreadLocal`没有被强引用，它将被垃圾收集，即使各种线程都有通过 that 存储的值`ThreadLocal`。

此外，`ThreadLocal`值实际上存储在`Thread`; 如果一个线程死亡，所有通过 a 与该线程关联的值都会`ThreadLocal`被收集。

如果您将 a`ThreadLocal`作为最终类成员，则这是一个强引用，并且在卸载类之前无法收集它。但这就是任何类成员的工作方式，并且不被视为内存泄漏。

* * *

*更新：*`ThreadLocal`仅当存储在强引用中的值（`ThreadLocal`类似于循环引用）时，引用的问题才会发挥作用。

在这种情况下，值 (a `SimpleDateFormat`) 没有向后引用`ThreadLocal`。此代码中没有内存泄漏。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-02T16:45:51.147

我猜你正在跳过这些障碍，因为 SimpleDateFormat*不是线程安全的*。

虽然我知道我没有解决你上面的问题，但我可以建议你看看[Joda](http://joda-time.sourceforge.net/)的日期/时间工作吗？Joda 有一个线程安全的日期/时间格式化机制。您也不会浪费时间学习 Joda API，因为它是新标准日期/时间 API 提案的基础。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T16:35:21.490

不*应该*有这样的问题。

线程的 ThreadLocal 引用被定义为只存在于对应的线程还活着（参见 javadoc）——或者换句话说，一旦线程不活着，如果 ThreadLocal 是对该对象的唯一引用，那么该对象有资格进行垃圾收集。

所以要么你发现了一个真正的错误并且应该报告它，要么你做错了什么！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T17:35:57.200

我意识到这并不是对您问题的严格回答，但作为一般规则，我不建议使用`ThreadLocal`在请求/交互结束时没有明确拆除的环境。经典的做法是在 servlet 容器中执行此类操作，乍一看似乎还不错，但由于线程是池化的，因此`ThreadLocal`即使在处理完每个请求后，挂在资源上也成为问题。

建议：

1.  对每次交互使用类似包装器的过滤器，以在每次交互结束时清除 ThreadLocal
2.  您可以使用 SimpleDateFormat 的替代方法，例如[commons-lang](http://commons.apache.org/lang/api/org/apache/commons/lang3/time/FastDateFormat.html)或 Joda 中的 FastDateFormat，正如有人已经建议的那样
3.  只需在每次需要时创建一个新的 SimpleDateFormat。我知道这似乎很浪费，但在大多数应用程序中你不会注意到差异

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T16:40:31.827

只是为了补充@Neil Coffey 所说的，只要您的 ThreadLocal 实例是静态的，这应该不是问题。因为您一直在静态实例上调用 get()，所以它应该始终保持对您的简单日期格式化程序的相同引用。因此，正如尼尔所说，当线程终止时，简单日期格式化程序的唯一实例应该有资格进行垃圾收集。

如果您有数字或其他形式的调试来显示此引入资源问题，那就是另一回事了。但我相信它不应该是一个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T16:56:47.623

在您的示例中，使用 ThreadLocal 应该没有问题。

当线程局部变量设置为由类加载器加载的实例以稍后卸载时，线程局部变量（以及单例也是！）成为一个问题。servlet 容器（如 tomcat）中的典型情况：

1.  webapp 在请求处理期间设置一个本地线程。
2.  线程由容器管理。
3.  应取消部署 webapp。
4.  webapp的类加载器不能被垃圾，因为剩下一个引用：从线程本地到实例到它的类到它的类加载器。

单例（webapp 提供的 java.sql.DriverManger 和 JDBC 驱动程序）也是如此。

因此，尤其是在不受您完全控制的环境中，请避免此类事情！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-23T12:53:50.547

使用后清理本地线程，添加 servlet 过滤器：

```
protected ThreadLocal myThreadLocal = new ThreadLocal();

public void doFilter (ServletRequest req, ServletResponse res, chain) 抛出 IOException, ServletException {
    尝试 {
        // 设置 ThreadLocal（例如，每个请求只存储一次繁重的计算结果）
        myThreadLocal.set(context());

        链.doFilter(req, res);
    } 最后 {
        // 重要：清理 ThraLocal 以防止内存泄漏
        userIsSmartTL.remove();
    }
}

```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-02T21:06:24.760

上面的代码示例没有问题，因为它在静态变量中使用了 ThreadLocal。

当您将 ThreadLocals 实例初始化为非静态变量时，会出现 ThreadLocal 内存泄漏的一个问题。当持有该变量的对象被垃圾回收时，ThreadLocal 的引用保留在线程中。如果您随后在某种循环中实例化并使用许多 ThreadLocals，则会出现内存泄漏。

我在netty的FastThreadLocal上遇到了这个问题（我猜java ThreadLocal应该有同样的问题）。我的解决方案是在 ThreadLocal 中使用弱引用映射值来解决此问题。这允许使用 ThreadLocal 变量作为实例变量，当持有对象被释放时，这些变量可以被垃圾回收。

这里的代码（可以用来代替ThreadLocals）： [https ://github.com/invesdwin/invesdwin-util/blob/master/invesdwin-util-parent/invesdwin-util/src/main/java/de/invesdwin /util/concurrent/reference/WeakThreadLocalReference.java](https://github.com/invesdwin/invesdwin-util/blob/master/invesdwin-util-parent/invesdwin-util/src/main/java/de/invesdwin/util/concurrent/reference/WeakThreadLocalReference.java)

# objective-c - 单击时如何使状态项显示或隐藏窗口？

> ID：940508
> 
> 赞同：0
> 
> 时间：2009-06-02T16:29:53.220
> 
> 标签：objective-c, cocoa, menuitem

当在菜单栏中单击实际按钮而不是在下拉菜单中显示或隐藏窗口时，如何制作状态项？对不起，如果这有点模糊。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T18:48:33.473

`NSStatusItem`像许多其他控件一样支持目标/动作机制。我自己没有使用过这个——我只使用过`NSStatusItem`带有菜单的 an ——所以我不知道消息*何时*发送（即当鼠标按钮被单击或释放时）。如果默认情况下它没有执行您想要的操作，则您需要像 Daniel 建议的那样自定义视图。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T16:44:26.250

要使用 NSStatusItem 实现此目的，您需要创建一个自定义视图并通过调用其“setView:”方法替换默认的 NSStatusItem 视图。

您将在自定义视图中实现代码以响应鼠标点击，例如设置一个窗口。（如果最适合您，您可以使用按钮或其他标准视图）。

我会警告你，这有点棘手。许多细微差别，例如让您的自定义视图的外观在菜单栏中看起来正确。但如果您想覆盖默认的菜单提示状态项视图，这是您需要采用的一般方法。

# oracle - Oracle优化查询涉及日期计算

> ID：940513
> 
> 赞同：1
> 
> 时间：2009-06-02T16:31:39.133
> 
> 标签：oracle, query-optimization

数据库

```
Table1
 Id
 Table2Id

...

Table2
  Id
  StartTime
  Duration  //in hours 
```

询问

```
select * from Table1 join Table2 on Table2Id = Table2.Id 
where starttime < :starttime and starttime + Duration/24 > :endtime 
```

此查询当前需要大约 2 秒才能运行，这太长了。在 id 列上有一个索引，在 Start_time+duration/24 上有一个函数索引。在 Sql Developer 中，查询计划显示没有使用任何索引。该查询为我的测试开始和结束时间返回 475 行。Table2 有 ~800k 行 Table1 有 ~200k 行

如果从查询中删除持续时间/24 计算，将其替换为静态值，则查询时间将减少一半。这不会检索完全相同的数据，但让我相信除法成本很高。

我还测试了向 Table2 添加一个 endtime 列，该列填充有 (starttime + duration/24) 该列是通过单个更新预填充的，如果它将在生产中使用，我将通过更新触发器填充它。

```
select * from Table1 join Table2 on Table2Id = Table2.Id 
where starttime < :starttime and endtime > :endtime 
```

此查询将在大约 600 毫秒内运行，并且它使用索引进行连接。由于具有冗余数据的附加列，它不太理想。

有什么方法可以让这个查询更快吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T18:16:19.240

在 starttime 和表达式上创建一个函数索引`starttime + Duration/24`：

```
create index myindex on table2(starttime, starttime + Duration / 24); 
```

应该选择查询的整个谓词上的复合索引，而单独索引优化器可能会决定基于对这些索引之一的扫描的 rowid 重复表访问实际上比全表扫描慢。

还要确保您没有从 varchar 到 date 进行隐式转换，方法是确保您在绑定变量中传递 DATE。

尝试降低`optimizer_index_cost_adj`系统参数。我相信默认值为 100。尝试将其设置为 10 并查看是否选择了您的索引。

考虑按开始时间对表进行分区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T16:52:18.003

如果 where 子句的选择性不是很好，Oracle 不会使用索引。如果返回的行数占表中总行数的某个百分比，则将使用索引（百分比会有所不同，因为 oracle 将计算读取索引和读取表的成本）。

此外，当在 where 子句中修改索引列时，索引将被禁用。例如，UPPERCASE(some_index_column) 将禁用 some_index_column 上的索引。这就是 starttime + Duration/24 > :endtime 不使用索引的原因。

你能试试这个

```
select * from Table1 join Table2 on Table1.Id = Table2.Table1Id 
where starttime < :starttime and starttime  > :endtime - Duration/24 
```

这应该允许使用索引并且不需要额外的列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T03:44:26.717

您有两个带有范围谓词的标准（大于/小于）。索引范围扫描可以从索引中的一个点开始，在另一个点结束。

对于 starttime 和 "Starttime+duration/24" 的复合索引，由于前导列是 starttime 并且谓词是 "小于绑定值"，它将从索引的最左边缘（最早的 starttime）开始并进行范围扫描直到 starttime 达到限制的所有行。对于这些匹配中的每一个，它可以根据绑定值评估索引上“Starttime+duration/24”的计算值，并通过或拒绝该行。我怀疑表中的大部分数据都是旧的，所以大多数条目都有旧的开始时间，你最终会扫描大部分索引。

对于“Starttime+duration/24”和 starttime 的复合索引，由于前导列是函数并且谓词“大于绑定值”，它将从索引的中途开始并一直工作到末尾。对于这些匹配中的每一个，它可以根据绑定值评估索引上的开始时间，并通过或拒绝该行。如果传入的结束日期是最近的，我怀疑这实际上涉及的索引数量要少得多。

即使没有 starttime 作为索引的第二列，基于“Starttime+duration/24”的现有函数索引仍然应该有用和使用。检查解释计划以确保绑定值是日期或转换为日期。如果已转换，请确保使用了适当的格式掩码（例如，输入的值 '1/Jun/09' 可能会转换为 0009 年，因此 Oracle 会认为条件非常宽松，并且倾向于不使用索引- 加上结果可能是错误的）。

“在 Sql Developer 中，查询计划显示没有使用索引。”如果没有使用索引来查找 table2 行，我怀疑优化器认为 table2 的大部分/全部将被返回 [显然不是，由你的号码]。我猜它虽然大部分 table1 会被返回，因此你的谓词都没有做很多过滤。正如我上面所说，我认为“小于”谓词不是选择性的，但“大于”应该是。看explain plan，尤其是ROWS值，看看Oracle是怎么想的

PS。调整值意味着优化器会更改其估计的基础。如果行程规划师说您的行程需要 6 小时，因为它假设平均速度为 50，如果您告诉它假设平均速度为 100，它会用 3 小时得出结果。它实际上不会影响您的旅行速度，也不会影响实际旅行所需的时间。因此，您只想更改该值以使其更准确地反映数据库（或会话）的实际值。

# c++ - C 或 C++ 新手应该知道哪些库？

> ID：940514
> 
> 赞同：8
> 
> 时间：2009-06-02T16:31:43.470
> 
> 标签：c++, c

我向朋友推荐了《数值食谱》一书中的图书馆。但是，他们似乎对他来说太具有挑战性了。

我不确定哪些库最适合 C/C++ 新手。

**C 或 C++ 新手应该知道哪些库？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-02T16:34:24.000

标准库、STL 以及他们需要的任何东西来完成他们想要的任务。为本质上是标准库扩展的东西添加一些增强的东西。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-02T16:35:16.513

[C 标准库](http://www.utas.edu.au/infosys/info/documentation/C/CStdLib.html)和[C++ 标准库](http://books.google.com/books?id=n9VEG2Gp5pkC&dq=c%2B%2B+standard+library&printsec=frontcover&source=bn&hl=en&ei=FmklSrGBKN-wtgfAxbDiBg&sa=X&oi=book_result&ct=result&resnum=5)中的那些是必须的（正如 Neil 在他的回答中提到的，确保他们理解 C 和 C++ 之间的区别）。除此之外，他应该学习他将在项目中使用的那些。

我忽略了 Boost 有两个原因：1）我不认为新手*需要它，2）一旦*[C++0x](http://en.wikipedia.org/wiki/C%2B%2B0x)取代旧标准，它的大部分计划被纳入标准库。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-02T16:40:46.257

由于没有像“C/C++”这样的语言，你在这里得到的答案可能不是很有用。C 程序将无法使用 C++ 库，而 C++ 程序可能有比任何建议的 C 库更好的替代品。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-02T17:41:48.050

*   [C：这里](http://publications.gbdirect.co.uk/c_book/chapter9/)对 C89 库有很好的描述。一旦他掌握了这一点，[GLib](http://library.gnome.org/devel/glib/stable/)就非常有用。它提供了链表、可扩展字符串、目录访问功能等，并且具有足够的可移植性。
*   C++：我认为标准库已经够难理解了。一旦他了解了 iostreams、字符串等，他应该专注于模板、智能指针、异常和多态性等高级主题。这应该需要一段时间。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-02T16:34:24.673

库。libstdc++。

仅凭这两个，您就可以取得相当大的成功。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-02T19:24:29.797

我在意大利的一所高中教 C。
在 2 年内，一旦他们掌握了语言的核心（C 中的指针和流），学生必须学习不同的库并“展示和讲述”一些示例。
图书馆是根据他们的兴趣和技能来提供的。
一些例子：
计算机图形 -> freeimage
文本匹配 -> 正则表达式
游戏 -> allegro
网络 -> 套接字
数据库 -> sqllite

等等......基本上我认为一旦你理解了语言（以及数据结构......），它一定是“娱乐时间”并跟随你的倾向。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-02T16:34:29.570

C++：升压，STL

C：数学

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-06-02T16:34:47.293

**string.h** 可能会被大量使用，如果您正在处理一些计算，那么[**math.h**](http://www.acm.uiuc.edu/webmonkeys/book/c_guide/2.7.html)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-02T16:34:00.303

`libm`. :)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-06-02T16:35:10.320

例如，要编写纯 C 代码，让他从**ncurses**开始。很有趣。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-06-02T17:12:55.543

这取决于说新手想做什么。

您的语言的标准库显然非常重要。除此之外，这取决于。C++ 程序员可能希望至少熟悉*一些*Boost 库。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-06-02T18:06:52.313

这真的取决于你要做什么......我使用了很多 libCurl，因为我做了很多与互联网相关的事情。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-06-03T02:28:10.957

对于 C：

*   标准库：知道这一点才有意义
*   glib：跨平台，相当完整，广泛使用，并且有据可查。
*   gtk：非常复杂，但是如果您需要用 C 编写图形应用程序，则很难被击败。

对于 C++：

*   STL 和升压
*   Qt4：跨平台，非常完整，免费，广泛使用，并且有据可查。

另外，请记住，当您学习 C 或 C++（甚至 Java）之类的东西时，您并没有真正学习“语言”，而是在学习“平台”。选择一个平台，其中包含您在编写真正的应用程序时需要的所有基本组件，而不是玩弄语法。要精通和高效地使用一门语言，您真的必须知道您拥有哪些工具，而做到这一点的唯一方法是使用现有工具包的良好示例。反正我的2美分。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-06-02T16:37:04.747

显然标准 C 库（它的良好文档位于[http://www.cppreference.com/wiki/](http://www.cppreference.com/wiki/)）。除此之外，这实际上取决于您的朋友想要做什么。

如果他真的想做数值方面的事情（并且非常关心性能），那么 libblas 就是他想要的[http://www.netlib.org/blas/](http://www.netlib.org/blas/)。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-06-02T17:54:25.657

对于 C：string.h（用于 strcpy、strcmp、memcpy 等函数）和 stdio.h（用于 printf 和朋友）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-06-02T19:53:30.173

关于 C++，Boost 库 ( [http://www.boost.org/](http://www.boost.org/) ) 是最常用的库，因此如果您已经了解 C++，您应该从那里开始（与我在之前的一些答案中看到的相反，您必须了解 STL 现在是标准的一部分，因此也是 C++ 语言的一部分）。

有太多其他库可供选择，都取决于您打算生产什么，如果有任何您“必须”知道的，它无疑将是一个 GUI 库，如果您不介意臃肿，请尝试查看Qt (www.qtcentre.org) 这个会给你一个几乎完整的工具集。

请记住，在您花一些时间学习新的 API 之前，您应该选择那些不是太新、真正免费、没有附加条件和平台锁定的 API，这包括 GPL 许可证，因为它会限制您生成 GPL 代码.

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-06-03T18:21:35.957

我建议您查看 ACE 库，特别是如果您想进行分布式和跨平台开发。对于“新手”来说可能有点多，但这是学习 STL 和 Boost 之后的一个很好的下一步。ACE 还提供实现的设计模式。

[http://www.cse.wustl.edu/~schmidt/ACE.html](http://www.cse.wustl.edu/~schmidt/ACE.html)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-04T14:11:13.063

如果为 Windows 编写，我会建议 MFC

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-09-19T11:52:22.813

我也是 C 编程的新手，但这套库绝对足以编写简单的程序。希望这些帮助。

```
1)**stdio.h** for instance: scanf, printf, fopen, fseek, feof.
2)**string.h** for instance: strlen, memmove, strtok.
3)**stdlib.h** for instance: malloc, calloc, realloc, strtol.
4)**math.h** for instacne: abs, log, sin, cos.
5)**limits.h**
6)**ctype.h**
7)**errno.h** 
```

# c# - ASP.NET MVC 调试非常慢 - SQL Server Express 连接问题？

> ID：940521
> 
> 赞同：-4
> 
> 时间：2009-06-02T16:32:29.493
> 
> 标签：c#, sql-server, asp.net-mvc

我正在用 ASP.NET MVC 开发一个应用程序，使用 SQL Server Express 作为后端，使用 Cassini 作为开发 Web 服务器（Visual Studio 2008 附带的服务器）。

应用程序的性能非常快（几乎是瞬时的页面切换）。然而，启动调试器非常缓慢。从我按下 F5 到 ASP.NET 欢迎页面出现大约需要 30 秒。

我注意到在加载 SQL Server Management Studio Express 时出现了类似的延迟，并且在我第一次在数据库中打开表进行查看时出现了另一个延迟。在我打开我的第一张桌子后，一切都很顺利。

鉴于 SQL Server Management Studio Express 的行为，我怀疑问题出在与 SQL Server Express 的初始连接上。这真的是问题所在吗？如果是，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T17:23:42.490

我会检查数据库上的 auto_close 属性。

```
sp_dboption 'MyDatabaseName', 'autoclose' 
```

我认为 express 的默认设置可能是将 autoclose 设置为 on。当设置为 TRUE 时，当数据库中没有用户时，服务器将关闭数据库并从中释放所有资源。将 autoclose 设置为 FALSE 将告诉服务器挂在数据库上，以便无论用户是否在数据库中，它都处于就绪状态。

请参阅[此处](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.databaseoptions.autoclose(SQL.90).aspx)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:24:46.293

如果它只是在调试时很慢，那么有几个阻塞点需要考虑：

1.  调试时应用程序启动速度较慢，因为每当重新构建程序集时 JITer 必须进行预编译。
2.  如果您每次都在编译和调试，那么可能是您的编译速度慢，而不是您的应用程序性能。*按 F5 后浏览器*需要多长时间才能出现？如果您的解决方案中有多个项目，构建它们将需要时间。尝试设置排除类项目的构建配置（确保在必要时手动重新构建它们）
3.  我在使用 Cassini 时没有遇到任何问题，但您可以尝试 IIS 只是为了开心。

只是一些想法，HTH。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-08T14:44:10.103

我终于通过使用命令提示符窗口中的 Netshell 重建我的 TCP/IP 堆栈解决了这个问题。显然我遇到了 TCP/IP 超时。

```
netsh int ip reset c:resetlog.txt 
```

[http://support.microsoft.com/kb/299357](http://support.microsoft.com/kb/299357)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-28T10:27:07.847

在我的情况下，我得到了抛出和捕获的异常，这些异常在“调试”>“输出”窗口中可见，这在调试时大大降低了我的应用程序的速度。

我最终启用了此处概述的异常中断，然后只是修复了代码，因此没有抛出太多异常

[为什么 ASP.NET 会抛出这么多异常？](https://stackoverflow.com/questions/5487729/why-is-asp-net-throwing-so-many-exceptions)

# c# - 如何要求访问 .NET 胖客户端应用程序中的 Windows 共享？

> ID：940529
> 
> 赞同：0
> 
> 时间：2009-06-02T16:34:15.360
> 
> 标签：c#, .net, windows, security, network-share

我们有一个胖客户端，它需要访问客户端可能未登录的共享上的资源。客户端可能位于 Windows 域上，也可能是没有域的混合环境，因此用户必须在本地登录到服务器。过去，一种解决方法是在用户桌面上创建一个到共享的快捷方式，这会打开 Windows 资源管理器，它会打开一个密码提示，允许或拒绝访问该共享。如何让用户在不依赖 Windows 资源管理器的情况下登录共享？Windows 资源管理器做了哪些我可以让我的应用程序请求访问共享的操作？

我已经阅读[了 c# web app 中网络共享的访问文件](https://stackoverflow.com/questions/29346/access-files-from-network-share-in-c-web-app)，但我在 WinForms 应用程序中执行此操作并希望它是交互式的。我还阅读[了 How to prompt for a Password](http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/HowToPromptForAPassword.html)，但该代码只是提示用户输入字符串，而不是调用要求并授予对共享的访问权限的 UI。我宁愿让我的应用程序不知道用户的密码，也不想触发操作系统要求访问网络资源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T17:17:39.080

您可以查看 Win32 API CredUIPromptForCredentials（或 CredUIPromptForWindowsCredential，如果您在 Vista/Win2k8 上运行，您应该检查 winver 以决定进行哪个调用）。

此方法实际上调用了常规凭据提示，但您获得了凭据（我知道这很糟糕）。

PInvoke.Net 的[示例代码](http://www.pinvoke.net/default.aspx/credui/CredUIPromptForCredentialsW.html)显示了如何从 C# 调用此函数（在 PInvoke 示例中，如果您在保存中指定了 false，则必须为标志传递 CREDUI_FLAGS.DO_NOT_PERSIST。很奇怪，我知道）。

更多关于安全的伟大的[Keith brown wikibook的信息（和非托管样本）](http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/HowToPromptForAPassword.html)

一旦获得凭据（在安全字符串中），您就可以模拟用户访问资源（使用 logonuser）。

而且很丑。我了解您希望 Windows 显示标准提示对话框，并且您不想了解凭据。

我想知道像使用 System.Diagnostics.Process 在远程 UNC 上启动隐藏的 explorer.exe 这样的丑陋黑客是否可以解决问题。您必须找到一种方法来等待用户输入凭据，然后终止生成的资源管理器进程。

# unix - 如何设置 $PATH 以使 `ssh user@host command` 工作？

> ID：940533
> 
> 赞同：136
> 
> 时间：2009-06-02T16:34:24.063
> 
> 标签：unix, shell, path, ssh

我似乎无法设置一个新的 $PATH 以便在通过`ssh user@host command`. 我曾尝试`export PATH=$PATH:$HOME/new_path`在远程机器上添加 ~/.bashrc 和 ~/.profile，但执行`ssh user@host "echo \$PATH"`显示更改尚未被拾取（它显示 /usr/local/sbin:/usr/local/bin:/usr/ sbin:/usr/bin:/sbin:/bin:/usr/games)。远程机器正在运行 Ubuntu 8.04。

我确信我可以将它破解到 /etc/profile 中，但这不是一个干净的解决方案，它仅在具有 root 访问权限时才有效。

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2009-06-02T21:25:35.607

正如grawity所说， ~/.bashrc 是你想要的，因为它是由非交互式非登录 shell 提供的。

我预计您遇到的问题与默认的 Ubuntu ~/.bashrc 文件有关。它通常以这样的开头：

```
# If not running interactively, don't do anything
[ -z "$PS1" ] && return 
```

您想在此行*之前*放置非交互式 shell 的任何内容。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-06-02T16:42:58.983

你有`~/.bash_login`or`~/.bash_profile`吗？

交互模式下的 Bash 会检查这些文件，并按以下顺序使用第**一个现有文件：**

1.  `~/.bash_profile`
2.  `~/.bash_login`
3.  `~/.profile`

因此，如果您有一个`~/.bash_profile`，那么您所做的任何更改都`~/.profile`将不可见。

非交互模式下的 Bash*有时会*读取文件`~/.bashrc`（通常也来自交互脚本。）“有时”是指它依赖于分发：很奇怪，有一个编译时选项可以启用它. Debian 启用`~/.bashrc`读取，而例如 Arch 则不启用。

`ssh`似乎在使用非交互模式，~~所以`~/.bashrc`应该足够了。当遇到这样的问题时，我通常会添加一些 echo 来查看正在运行的文件。~~

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-06-02T17:01:37.523

ssh 文档说：

> 如果指定了 command，它将在远程主机而不是登录 shell 上执行。

这就是为什么添加到 bashrc 文件不起作用的原因。但是，您确实有以下选择：

1.  如果`PermitUserEnvironment`在 sshd 配置中设置了该选项，则可以将 PATH 设置添加到`~/.ssh/environment`

2.  `ssh remotemachine 'bash -l -c "somecommand"'`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-02T16:41:56.753

你总是可以说：

```
ssh remotemachine 'export PATH=wedontneedastinkingpath; echo $PATH' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-19T12:03:18.760

我自己也遇到了同样的问题，解决了：

```
ssh user@remotehost PATH=\$HOME/bin:\$PATH\; remote-command 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-01-02T19:31:30.273

除了@signpolyma 答案之外，您还必须在这些行之前添加您的导出

```
# If not running interactively, don't do anything
case $- in
    *i*) ;;
      *) return;;
esac 
```

# iphone - 如何将时间字符串插入 GDB 日志？

> ID：940540
> 
> 赞同：5
> 
> 时间：2009-06-02T16:34:57.107
> 
> 标签：iphone, xcode, debugging, gdb, breakpoints

我最近发现您可以在 Xcode 中设置断点，这些断点将打印到控制台并自动继续——这意味着您可以插入日志语句而无需编写 NSLog() 调用和重新编译（即时日志记录，woot）。

唯一的问题是，在做日志时可以显示的内容似乎有点有限。它显示了您可以插入的一些标记，例如 %B 用于打印有关当前断点的一些信息或 %H 用于命中计数。

我想知道是否有任何方法可以将特定格式的时间戳插入日志行？

我尝试使用“shell脚本”断点操作，但它告诉我日期命令不存在......奇怪......

任何帮助都会很棒，谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T16:52:50.530

阅读[有关断点命令列表的 GDB 手册](http://sourceware.org/gdb/current/onlinedocs/gdb_6.html#SEC40)

> 您可以为任何断点（或观察点或捕获点）提供一系列命令，以便在程序因该断点而停止时执行。例如，您可能想要打印某些表达式的值，或启用其他断点。

特别是：

> 例如，当 x 为正时，您可以使用断点命令在 foo 的入口处打印 x 的值。

```
break foo if x>0
commands
silent
printf "x is %d\n",x
cont
end 
```

这回答了你的问题了吗？

# c# - C#判断表单是否最大化

> ID：940549
> 
> 赞同：2
> 
> 时间：2009-06-02T16:35:47.213
> 
> 标签：c#, winforms, resize, wndproc, maximize

好的，这是我的问题。我有一个表单，当它没有被最大化时，它的最大尺寸必须是表单内组件的总高度。为了实现这一点，我使用这个：

```
 private void resize_form(object sender, EventArgs e)
    {
        this.MaximumSize = new System.Drawing.Size(1000, this.panel4.Height + this.label2.Height + this.HeightMin);
    } 
```

这会触发表单的 Resize 事件。因为组件大小总是在变化，所以在调整大小事件上这样做是有意义的。但是，如果我想最大化表单，表单只会进入 this.MaximumSize 中定义的最高设置。所以我想知道是否有一种方法可以判断何时最大化表单并将其最大尺寸设置为表单最大化之前的屏幕边界。

如果有更好的方法可以在没有调整大小事件的情况下更改最大尺寸值，那也很棒:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T16:39:18.003

您仍然需要使用 resize 事件，但请检查`WindowState`：

```
if (this.WindowState == FormWindowState.Maximized)
{
    // Do your stuff
} 
```

正如 yshuditelu 指出的那样，您也可以设置表单的最小尺寸属性 - 这应该与明智地使用锚值相结合，意味着它永远不会缩小太多，并且当它确实增长时，组件将移动和/或增长为必需的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T17:14:42.203

我找到了非常适合我的答案。一个 lil WndProc 覆盖：D（我现在喜欢 WndProc）

```
protected override void WndProc(ref Message message)
{
    const int WM_SYSCOMMAND = 0x0112;
    const int SC_MAXIMIZE = 0xF030; 

    switch (message.Msg)
    {
        case WM_SYSCOMMAND:
            int command = message.WParam.ToInt32() & 0xfff0;
            if (command == SC_MAXIMIZE) 
            {
                this.maximize = true;
                this.MaximumSize = new System.Drawing.Size(0, 0);
            }
            break;
    }

    base.WndProc(ref message);
}

private void resize_form(object sender, EventArgs e)
{
    if (!maximize)
    {
        this.MaximumSize = new System.Drawing.Size(1000, this.panel4.Height + this.label2.Height + this.HeightMin);
    }
} 
```

基本上它在收到 SC_MAXIMIZE 消息时将 this.maximize 设置为 true。如果 this.maximize 设置为 false，resize 事件只会设置一个新的 MaximumSize。漂亮的 xD

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T16:41:17.830

您确定不想设置[MinimumSize](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.minimumsize.aspx)属性吗？如果将 MinimumSize 设置为所有标签的大小，则表单永远不会小于该大小。但它仍然可以增长到用户想要的任何大小，只要它大于最小值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T16:41:55.817

查看[System.Windows.Forms.Screen](http://msdn.microsoft.com/en-us/library/system.windows.forms.screen.aspx)类。从相关点获取屏幕（以处理多监视器情况），然后获取其分辨率。

这应该与有关检查 FormWindowState.Maximized 的其他评论结合使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-17T21:33:04.290

如果用户点击上栏，他们可以调整窗口大小，所以我使用这个：

```
private void Form1_Resize(object sender, EventArgs e)
{
    if (this.WindowState == FormWindowState.Normal)
    {
        this.WindowState = FormWindowState.Maximized;
    }
} 
```

# mysql - 计算日期/时间部分的平均值

> ID：940550
> 
> 赞同：3
> 
> 时间：2009-06-02T16:35:47.883
> 
> 标签：mysql, datetime, select, timespan

**问题：**

我有一个传感器读数数据库，其中包含读取传感器时间的时间戳。基本上它看起来像这样：

```
Sensor | Timestamp | Value 
```

现在我想用这些数据制作一个图表，我想制作几个不同的图表。假设我想要一个用于最后一天，一个用于上周，一个用于最后一个月。每个图表的分辨率会有所不同，因此对于日图，分辨率将为 1 分钟。对于周图，它将是一小时，对于月图，它将是一天或四分之一天。

所以我想要一个输出是每个分辨率的平均值（例如，天 = 一分钟内的平均值，周 = 一小时内的平均值等等）

前任：

```
Sensor | Start | End | Average 
```

如何在 mySQL 中轻松快速地完成此操作？我怀疑它涉及创建一个临时表或排序并将传感器数据与其连接以获得传感器的平均值？但我对 mySQL 的了解充其量是有限的。

有没有真正聪明的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T16:43:33.897

```
SELECT  DAY(Timestamp), HOUR(Timestamp), MINUTE(Timestamp), AVG(value)
FROM    mytable
GROUP BY
        DAY(Timestamp), HOUR(Timestamp), MINUTE(Timestamp) WITH ROLLUP 
```

`WITH ROLLUP`此处的子句产生额外的行，其中每个`HOUR`和具有平均值`DAY`，如下所示：

```
SELECT  DAY(ts), HOUR(ts), MINUTE(ts), COUNT(*)
FROM    (
        SELECT  CAST('2009-06-02 20:00:00' AS DATETIME) AS ts
        UNION ALL
        SELECT  CAST('2009-06-02 20:30:00' AS DATETIME) AS ts
        UNION ALL
        SELECT  CAST('2009-06-02 21:30:00' AS DATETIME) AS ts
        UNION ALL
        SELECT  CAST('2009-06-03 21:30:00' AS DATETIME) AS ts
        ) q
GROUP BY
        DAY(ts), HOUR(ts), MINUTE(ts) WITH ROLLUP 
```

```
2, 20, 0, 1
2、20、30、1
2、20、空、2
2、21、30、1
2、21、空、1
2，空，空，3
3、21、30、1
3、21、空、1
3、空、空、1
空，空，空，4

```

`2, 20, NULL, 2`这里的意思`COUNT(*)`是`2`,`DAY = 2`和`HOUR = 20`所有分钟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T16:42:36.003

不完全是您想要的结果表，但这是进行 1 分钟解析的入门：

```
SELECT sensor,minute(timestamp),avg(value) 
FROM table 
WHERE <time period specifier limits to a single hour>
GROUP BY sensor, minute(timestamp) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T16:47:06.420

我使用了与此非常相似的代码（未经测试，但它取自工作代码）

设置变量：

```
$seconds = 3600;
$start = mktime(...);  // say 2 hrs ago
$end   = .... // 1 hour after $start 
```

然后运行查询

```
SELECT MAX(`when`) AS top_When, MIN(`when`) AS low_When,
   ROUND(AVG(sensor)) AS Avg_S,
   (MAX(`when`) - MIN(`when`)) AS dur, /* the duration in seconds of the actual period */
   ((floor(UNIX_TIMESTAMP(`when`) / $seconds)) * $seconds) as Epoch
   FROM `sensor_stats`
   WHERE `when` >= '$start' AND `when` <= '$end' and duration=30
   GROUP BY Epoch/*((floor(UNIX_TIMESTAMP(`when`) / $seconds)) * $seconds)*/ 
```

这样做的好处是您可以拥有任何您想要的时间段 - 甚至不需要将它们放在“整数”上，例如完整的时钟小时（甚至是时钟分钟，0-59）。

# python - Python 2.6 subprocess.call() 似乎正在调用触发 Perl 污点检查的 setgid 行为。我该如何解决？

> ID：940552
> 
> 赞同：2
> 
> 时间：2009-06-02T16:36:22.783
> 
> 标签：python, perl, subprocess

我在 Python 的 subprocess.call() 和 os.system() 之间有一些奇怪的行为差异，这似乎与 setgid 有关。不同之处在于，在使用 subprocess.call() 时会调用 Perl 的污染检查，这会产生问题，因为我无法修改所有需要添加无污染代码的 Perl 脚本。

例如，“process.py”

```
#!/usr/bin/python

import os, subprocess

print "Python calling os.system"
os.system('perl subprocess.pl true')
print "Python done calling os.system"
print "Python calling subprocess.call"
subprocess.call(['perl', 'subprocess.pl', 'true'])
print "Python done calling subprocess.call" 
```

“子进程.pl”

```
#!/usr/bin/perl

print "perl subprocess\n";
`$ARGV[0]`;
print "perl subprocess done\n"; 
```

输出 - subprocess.pl 的两次运行应该是相同的，但是使用 subprocess.call() 运行的一次会出现污染错误：

```
mybox> process.py
Python calling os.system
perl subprocess
perl subprocess done
Python done calling os.system
Python calling subprocess.call
perl subprocess
Insecure dependency in `` while running setgid at subprocess.pl line 4.
Python done calling subprocess.call
mybox> 
```

虽然使用 os.system() 有效，但我真的更愿意使用 subprocess.check_call() 因为它更向前兼容并且具有很好的检查行为。

任何可以解释为什么这两者不同的建议或文档？这可能是我的本地 unix 环境中调用这些行为的一些奇怪设置吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T18:45:03.357

我认为您的错误在于 perl，或者它与您的环境交互的方式。您的反引号进程出于某种原因正在调用 setgid。我可以复制它的唯一方法是在/usr/bin/perl (-rwxr-sr-x) 上设置gid。[编辑] 使用 python setgid 也可以做到这一点！

[编辑] 我忘了 os.system*正在*为你工作。我认为这里唯一相关的区别是 os.system 环境*不是*由子进程继承的。查看每个子进程的环境，你可能会找到你的罪魁祸首。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:13:47.150

不会发生在我身上：

```
$ python proc.py
Python calling os.system
perl subprocess
perl subprocess done
Python done calling os.system
Python calling subprocess.call
perl subprocess
perl subprocess done
Python done calling subprocess.call

$ python --version
Python 2.5.2

$ perl --version
This is perl, v5.8.8 built for i486-linux-gnu-thread-multi 
```

你的版本号是多少？

您在哪种帐户下运行？

编辑：

抱歉错过了标题 - 我没有易于访问的 python 2.6，所以我将不得不离开这个问题。

编辑：

所以看起来我们解决了问题——python 2.6 二进制文件上的 sgid。

看看带有 shell 的子进程是否也能避免这个问题也会很有趣。

# python - PyQt在连接到信号时将参数发送到插槽

> ID：940555
> 
> 赞同：35
> 
> 时间：2009-06-02T16:38:00.970
> 
> 标签：python, qt4, pyqt

我有一个任务栏菜单，当单击它时，它连接到一个获取触发事件的插槽。现在的问题是我想知道单击了哪个菜单项，但我不知道如何将该信息发送到连接的功能。这是用于将动作连接到函数的方法：

```
QtCore.QObject.connect(menuAction, 'triggered()', menuClickedFunc) 
```

我知道有些事件会返回一个值，但trigger() 没有。那么我该如何实现呢？我必须自己发出信号吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-06-02T16:52:11.950

用一个`lambda`

这是[PyQt 书中](http://www.qtrac.eu/pyqtbook.html)的一个例子：

```
self.connect(button3, SIGNAL("clicked()"),
    lambda who="Three": self.anyButton(who)) 
```

顺便说一句，您也可以使用`functools.partial`，但我发现该`lambda`方法更简单明了。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-11-03T10:56:42.807

[正如这里](https://stackoverflow.com/questions/8824311)已经提到的，您可以使用 lambda 函数将额外的参数传递给您要执行的方法。

在此示例中，您可以将字符串 obj 传递给按下按钮时调用的函数 AddControl()。

```
# Create the build button with its caption
self.build_button = QPushButton('&Build Greeting', self)
# Connect the button's clicked signal to AddControl
self.build_button.clicked.connect(lambda: self.AddControl('fooData'))
def AddControl(self, name):
    print name 
```

来源：[snip2code - 在 PyQt4 中使用 Lambda 函数传递额外参数](http://www.snip2code.com/Snippet/12165/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-11-30T15:13:04.773

使用 functools.partial

否则，如果您使用 lambda，您会发现在脚本运行时无法动态传递参数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-04-17T19:43:35.943

我还想补充一点，`sender`如果您只需要找出发送信号的小部件，您可以使用该方法。例如：

```
def menuClickedFunc(self):
    # The sender object:
    sender = self.sender()
    # The sender object's name:
    senderName = sender.objectName()
    print senderName 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T16:52:40.530

通常，您应该将每个菜单项连接到不同的插槽，并让每个插槽仅处理它自己的菜单项的功能。例如，如果您有“保存”、“关闭”、“打开”之类的菜单项，则应该为每个菜单项创建一个单独的插槽，而不是尝试在其中包含一个带有 case 语句的插槽。

如果您不想那样做，您可以使用[QObject::sender()](http://doc.trolltech.com/4.5/signalsandslots.html#advanced-signals-and-slots-usage)函数来获取指向发送者的指针（即：发出信号的对象）。不过，我想更多地了解您要完成的工作。

# xcode - 如何使用 MacOS Shark 分析我的应用程序？

> ID：940560
> 
> 赞同：4
> 
> 时间：2009-06-02T16:38:49.130
> 
> 标签：xcode, macos

我有一个 XCode 项目。我可以用它构建和调试。我是否可以使用 Shark 对我的应用程序进行分析（例如，找出在什么方法上花费的时间百分比？创建和销毁了多少对象？每个对象在哪里创建？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T18:39:26.127

是的，您可以在您的应用程序上运行 Shark 以获取时间配置文件信息；例如看 [这个 Apple 教程](http://developer.apple.com/tools/shark_optimize.html)。dtrace 是另一种选择；但学习曲线更陡峭。

对于更一般的分析，例如对象分配，您需要使用 Instruments（它也是 Apple 开发人员工具套件的一部分）。

# python - Python 扩展返回对象礼仪

> ID：940563
> 
> 赞同：1
> 
> 时间：2009-06-02T16:39:04.043
> 
> 标签：python, python-c-api

我正在编写一个 python 扩展来提供对 Solaris kstat 数据的访问（本着与运送 perl 库 Sun::Solaris::Kstat 相同的精神），我有一个关于有条件地返回列表或单个对象的问题。python 用例看起来像：

```
    cpu_stats = cKstats.lookup(module='cpu_stat')
    cpu_stat0 = cKstats.lookup('cpu_stat',0,'cpu_stat0')

```

由于它目前已实现，lookup() 返回匹配的所有 kstat 对象的列表。第一种情况会产生一个对象列表（与 CPU 一样多），第二种调用完全指定一个 kstat 并返回一个包含一个 kstat 的列表。

我的问题是，当只有一个匹配时返回单个对象，而当有很多匹配时返回列表？

谢谢你周到的回答！由于像你这样的人，我的python-fu很弱，但正在变得更强大。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T17:13:49.817

“我的问题是，当只有一个匹配时返回单个对象，当有很多匹配时返回列表？”

返回不一致的类型是一种糟糕的形式。

返回一致的类型：kstat 列表。

大多数 Pythonista 不喜欢使用`type(result)`它来确定它是 kstat 还是 kstat 列表。

我们宁愿以一种简单、一致的方式检查列表的长度。

此外，如果长度取决于一条系统信息，也许 API 方法可以提供此元数据。

查看[DB-API PEP](http://www.python.org/dev/peps/pep-0249/)以获取有关如何处理类似查询的事情的建议和想法。

# java - Spring for Python 与 Spring for Java 相比如何

> ID：940564
> 
> 赞同：18
> 
> 时间：2009-06-02T16:39:13.933
> 
> 标签：java, python, spring

我是 Java 的 Spring 框架（由 Rod Johnson 撰写）的狂热粉丝。我正在学习 Python，很高兴能找到有关 Spring for Python 的信息。我很想听听社区对这两种 Spring 风格的比较的看法。它在多大程度上适合 Python 的范例等。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-02T17:26:25.107

Dependency injection frameworks are not nearly as useful in a dynamically typed language. See for example the presentation [Dependency Injection: Vitally important or totally irrelevant?](http://onestepback.org/articles/depinj/index.html) In Java the flexibility provided by a dependency injection framework is vital, while in Python it usually results in unneeded complexity.

This doesn't mean that the principles are wrong. See this example how to achieve loose coupling between classes by using simple idioms:

```
# A concrete class implementing the greeting provider interface
class EnglishGreetingProvider(object):
    def get_greeting(self, who):
        return "Hello %s!" % who

# A class that takes a greeting provider factory as a parameter
class ConsoleGreeter(object):
    def __init__(self, who, provider=EnglishGreetingProvider):
        self.who = who
        self.provider = provider()
    def greet(self):
        print(self.provider.get_greeting(self.who))

# Default wiring
greeter = ConsoleGreeter(who="World")
greeter.greet()

# Alternative implementation
class FrenchGreetingProvider(object):
    def get_greeting(self, who):
        return "Bonjour %s!" % who
greeter = ConsoleGreeter(who="World", provider=FrenchGreetingProvider)
greeter.greet() 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-06-03T16:54:44.320

披露：我是 Spring Python 的项目负责人，所以你可以认为我的意见有偏见。

我发现 Spring Python 提供的几个选项很有用，包括：面向方面的编程、依赖注入、远程处理、安全性和简单的数据库访问。

正如他们所说，面向方面的编程比使用 java 更容易用 python 实现。但是 Spring Python 可以很容易地添加到现有的 Python 模块，而无需编辑它们的源代码。其他解决方案需要元编程或修改原始源代码。我已经有一个人访问了我们的论坛，询问如何向 PyGame 应用程序添加拦截器，这样他就可以不显眼地“点击”一些代码。

许多人很快就认为“依赖注入”或“IoC”即刻意味着“XML 配置文件”。不是这样。虽然我们支持 XML 配置，但直接跳到使用 python 装饰器。

我已经知道一家公司正在使用 Spring Python 作为他们系统的关键部分。他们对进行改进、添加新功能以及通常将其用作解决方案的一部分感兴趣。他们还尝试在 jython 中运行它，以防引起您的兴趣。

归根结底，我的建议是检查所有功能，看看它们是否适合您的需求。这是否增加了不必要的复杂性或简洁的价值只能由您确定。您不必使用所有东西；只有你需要的。要获得有关可用内容的更多信息，我邀请您查看我在 SpringOne Americas 2008 会议上[介绍的 Spring Python 简介。](https://www.slideshare.net/gturnquist/intro-to-spring-python)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T14:04:41.770

好东西。我使用过 Spring Java、Spring Dot Net，现在开始使用 Spring Python。对于程序员来说，Python 一直很容易使用。我认为，尤其是因为它很容易编写。我发现 Spring Dot Net 有点令人困惑，但 Spring Java 和 Python 似乎都相似。我确信他们有他们的不同，但至少到目前为止，我对 Spring 的 Python 实现并没有那么困惑。

# javascript - 在设置时间之前结束 setTimeout 函数

> ID：940572
> 
> 赞同：11
> 
> 时间：2009-06-02T16:40:10.670
> 
> 标签：javascript, jquery

我有一个 jquery 函数，单击该函数会在使 div 可见时产生设置超时。

但是，如果在 settimeout 长度期间选择了另一个选项，我想知道如何销毁这个函数并阻止它发生的任何其他事情。

我当前的代码是：

```
$(document).ready(function () {

    $('li#contact').click(function () {
        $('ul.image_display').css('display', 'none');
        $('ul.projects').fadeOut().hide();
        $('li#cv').removeClass('cur');
        $('li#projects').removeClass('cur');
        $('li#contact').addClass('cur');
        $('ul.contact').fadeIn(function () {
            setTimeout(function () {
                $('ul.contact').fadeOut('slow');
            }, 8000);
        });
        setTimeout(function () {
            $('li#contact').removeClass('cur');
            $('li#cv').addClass('cur');
            $('ul.projects').fadeIn('slow');
            $('ul.image_display').css('display', 'block');
        }, 8625);

    });

}); 
```

有点麻烦，但在单击之前有效：

```
$(document).ready(function () {

    $('#projects').click(function () {
        $('li#cv').removeClass('cur');
        $('ul.contact').fadeOut().hide();
        $('#contact').removeClass('cur');
        $('ul.projects').fadeIn('slow');
        $('#projects').addClass('cur');
        $('ul.image_display').css('display', 'block');
    });

}); 
```

如果在第一个之后单击第二个，则在设定的时间之后，类 'cur' 仍然出现在 li#cv 上。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-06-02T16:42:09.903

该[`setTimeout`](https://developer.mozilla.org/En/Window.setTimeout)函数将一个标识符返回给该超时。然后，您可以使用该[`clearTimeout`](https://developer.mozilla.org/en/DOM/window.clearTimeout)功能取消该超时。所以你可以做这样的事情（用你的代码填空）：

```
var timer;
$(function() {
    $(...).click(function() {
        ...
        timer = setTimeout(...);
        ...
    });

    $(...).click(function() {
        clearTimeout(timer);
    });
}); 
```

然而，为此保留一个全局变量并不是特别干净。您可以将计时器存储在[`data`](http://docs.jquery.com/Data)对您的情况最有意义的任何元素的属性中。像这样的东西：

```
$(function() {
    $(...).click(function() {
        ...
        var timer = setTimeout(...);
        $(someelement).data('activetimer', timer);
        ...
    });

    $(...).click(function() {
        var timer = $(someelement).data('activetimer');
        if(timer) {
            clearTimeout(timer);
            $(someelement).removeData('activetimer');
        }
    });
}); 
```

*它看起来*并不干净，但它是存储计时器的另一种方式......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T16:43:09.857

你可以用它`clearTimeout()`来做到这一点。您需要将返回值保留`setTimeout()`在变量中以传递给`clearTimeout()`.

# javascript - JavaScript 正则表达式电子邮件验证

> ID：940577
> 
> 赞同：138
> 
> 时间：2009-06-02T16:40:50.203
> 
> 标签：javascript, regex

这段代码总是在警告 out `"null"`，这意味着字符串与表达式不匹配。

```
var pattern = "^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$"; 

function isEmailAddress(str) {

    str = "azamsharp@gmail.com";      

    alert(str.match(pattern)); 
    return str.match(pattern);    

} 
```

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-06-02T16:45:26.810

如果您将正则表达式定义为字符串，则所有反斜杠都需要转义，因此您应该使用 '\\w' 而不是 '\w'。

或者，将其定义为正则表达式：

```
var pattern = /^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/; 
```

* * *

顺便说一句，请不要在客户端验证电子邮件地址。无论如何，您的正则表达式太简单而无法通过可靠的实现。

在这里查看真实的东西：**[http ://www.ex-parrot.com/~pdw/Mail-RFC822-Address.html](http://www.ex-parrot.com/~pdw/Mail-RFC822-Address.html)**

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2011-06-27T23:55:50.567

这是我在我的页面上使用的。

[http://www.zparacha.com/validate-email-address-using-javascript-regular-expression/](http://www.zparacha.com/validate-email-address-using-javascript-regular-expression/)

`/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/`

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-08-31T20:46:54.243

我已经使用这个功能有一段时间了。它返回一个布尔值。

```
// Validates email address of course.
function validEmail(e) {
    var filter = /^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/;
    return String(e).search (filter) != -1;
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-06-02T16:47:54.983

您可能对[这个问题](https://stackoverflow.com/questions/156430/regexp-recognition-of-email-address-hard)（或[这个](https://stackoverflow.com/questions/201323/what-is-the-best-regular-expression-for-validating-email-addresses)问题）感兴趣，它强调了通过正则表达式识别有效电子邮件地址是一个非常难以解决的问题（如果完全可以解决的话）

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-09-23T17:07:06.540

有时大多数注册和登录页面都需要验证电子邮件。在此示例中，您将学习简单的电子邮件验证。首先在html中输入文本和像这样的按钮输入

```
<input type='text' id='txtEmail'/>
<input type='submit' name='submit' onclick='checkEmail();'/>

<script>
    function checkEmail() {
        var email = document.getElementById('txtEmail');
        var filter = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        if (!filter.test(email.value)) {
            alert('Please provide a valid email address');
            email.focus;
            return false;
        }
    }
</script> 
```

您还可以使用此正则表达式进行检查

```
<input type='text' id='txtEmail'/>
<input type='submit' name='submit' onclick='checkEmail();'/>

<script>
    function checkEmail() {

        var email = document.getElementById('txtEmail');
        var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;

        if (!filter.test(email.value)) {
            alert('Please provide a valid email address');
            email.focus;
            return false;
        }
    }
</script> 
```

检查此演示输出，您可以在此处检查

```
function checkEmail() {
        var email = document.getElementById('txtEmail');
        var filter = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        if (!filter.test(email.value)) {
            alert('Please provide a valid email address');
            email.focus;
            return false;
        }
    }
```

```
<input type='text' id='txtEmail'/>
<input type='submit' name='submit' onclick='checkEmail();'/>
```

如果电子邮件无效，则发出警报消息，如果电子邮件有效，则不发出警报消息。有关正则表达式的更多信息

[https://www.w3schools.com/jsref/jsref_obj_regexp.asp](https://www.w3schools.com/jsref/jsref_obj_regexp.asp)

希望对你有帮助

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-12-06T14:12:27.853

使用更简单的[正则表达式](/questions/tagged/regex "显示标记为“正则表达式”的问题")

这里是 ：

```
var regexEmail = /\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;
var email = document.getElementById("txtEmail");

if (regexEmail.test(email.value)) {
    alert("It's Okay")
} else {
    alert("Not Okay")

} 
```

祝你好运。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2013-04-24T09:59:34.127

```
function isEmailAddress(str) {
   var pattern =/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
   return pattern.test(str);  // returns a boolean 
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-06-02T16:49:10.003

您可能有兴趣查看此[页面](http://www.regular-expressions.info/email.html)，它列出了用于验证电子邮件地址的正则表达式，涵盖了更一般的情况。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-10-09T16:17:35.853

电子邮件验证很容易出错。因此，我建议您使用[Verimail.js](https://github.com/comfirm/Verimail.js)。

**为什么？**

*   语法验证（根据 RFC 822）。
*   IANA TLD 验证
*   最常见 TLD 和电子邮件域的拼写建议
*   拒绝临时电子邮件帐户域，例如 mailinator.com
*   [jQuery插件支持](https://github.com/comfirm/Verimail.js/blob/master/src/verimail.jquery.js)

Verimail.js 的另一个优点是它为最常见的电子邮件域和注册的 TLD 提供了拼写建议。对于那些拼错常见域名（如 gmail.com、hotmail.com、aol.com 等）的用户，这可以大大降低您的跳出率。

**例子：**

*   test@gnail.com -> 你是说 test@gmail.com 吗？
*   test@hottmail.con -> 你是说 test@hotmail.com 吗？

**如何使用它？**

最简单的方法是在您的页面上下载并包含[verimail.jquery.js 。](https://github.com/comfirm/Verimail.js/blob/master/src/verimail.jquery.js)之后，通过在需要验证的输入框上运行以下函数来连接 Verimail：

```
$("input#email-address").verimail({
    messageElement: "p#status-message"
}); 
```

message 元素是一个可选元素，它显示诸如“Invalid email..”或“Did you mean test@gmail.com?”之类的消息。如果您有一个表单并且只想在验证电子邮件后继续，您可以使用 getVerimailStatus 函数，如下所示：

```
if($("input#email-address").getVerimailStatus() < 0){
    // Invalid email
}else{
    // Valid email
} 
```

getVerimailStatus 函数根据对象 Comfirm.AlphaMail.Verimail.Status 返回一个整数代码。如上所示，如果状态是一个负整数值，那么验证应该被视为失败。但如果该值大于或等于 0，则验证应视为成功。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-08-31T20:39:24.133

最好使用：

`var pattern = /^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,20}$/;`

这允许域，例如：**whatever.info**（最后 4 个字母）

还要测试，使用

`pattern.test("exampleemail@testing.info")`

如果有效则返回 true

[http://www.w3schools.com/js/js_obj_regexp.asp](http://www.w3schools.com/js/js_obj_regexp.asp)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-06-15T15:18:56.167

你也可以试试这个表达式，我已经针对许多电子邮件地址进行了测试。

```
var pattern = /^[A-Za-z0-9._%+-]+@([A-Za-z0-9-]+\.)+([A-Za-z0-9]{2,4}|museum)$/; 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2012-12-28T06:27:31.030

我一直在用这个......

```
/^[\w._-]+[+]?[\w._-]+@[\w.-]+\.[a-zA-Z]{2,6}$/ 
```

它允许`+`之前`@` `(xyz+abc@xyz.com)`

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-05-20T05:51:07.573

晚会有点晚了，但这里什么都没有……

```
function isEmailValid(emailAdress) {
    var EMAIL_REGEXP = new RegExp('^[a-z0-9]+(\.[_a-z0-9]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,15})$', 'i');
    return EMAIL_REGEXP.test(emailAdress)
} 
```

[http://jsfiddle.net/yrshaikh/xvd6H/](http://jsfiddle.net/yrshaikh/xvd6H/)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-02-27T11:47:55.173

```
var emailRegex = /^[A-Z0-9_'%=+!`#~$*?^{}&|-]+([\.][A-Z0-9_'%=+!`#~$*?^{}&|-]+)*@[A-Z0-9-]+(\.[A-Z0-9-]+)+$/i;
if(emailRegex.test('yoursamplemail'))
alert('valid');
else
alert('invalid'); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-05-14T12:36:29.330

**用于检查电子邮件语法的简单但强大的电子邮件验证：**

```
var EmailId = document.getElementById('Email').value;
var emailfilter = /^[\w._-]+[+]?[\w._-]+@[\w.-]+\.[a-zA-Z]{2,6}$/;
if((EmailId != "") && (!(emailfilter.test(EmailId ) ) )) {
    msg+= "Enter the valid email address!<br />";
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-07-03T09:44:46.387

您应该记住，az、AZ、0-9、.、_ 和 - 并不是电子邮件地址开头的唯一有效字符。

例如，Gmail 允许您在地址中添加“+”号来“伪造”不同的电子邮件（例如，someone@gmail.com 也会收到发送到someone+else@gmail.com 的电子邮件）。

micky.o'finnagan@wherever.com 不会感谢您的代码阻止他们输入他们的地址......撇号在电子邮件地址中完全有效。

上面提到的有效电子邮件地址的关闭“检查”，正如它所说的那样，非常幼稚：

[http://code.google.com/p/closure-library/source/browse/trunk/closure/goog/format/emailaddress.js#198](http://code.google.com/p/closure-library/source/browse/trunk/closure/goog/format/emailaddress.js#198)

我建议在您的客户端代码中非常开放，然后更重量级，例如发送带有链接的电子邮件以真正检查它是否“有效”（如 - 在语法上对其提供商有效，并且也没有拼写错误）。

像这样的东西：

`var pattern = /[^@]+@[-a-z\.]\.[a-z\.]{2,6}/`

请记住，理论上您可以在电子邮件地址中有两个 @ 符号，而且我什至没有在域名中包含 latin1 以外的字符！

[http://www.eurid.eu/en/eu-domain-names/idns-eu](http://www.eurid.eu/en/eu-domain-names/idns-eu)

[http://haacked.com/archive/2007/08/21/i-knew-how-to-validate-an-email-address-until-i.aspx](http://haacked.com/archive/2007/08/21/i-knew-how-to-validate-an-email-address-until-i.aspx)

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2014-03-19T09:21:06.567

您可以将函数添加到字符串对象

```
//Add this wherever you like in your javascript code
String.prototype.isEmail = function() {
    return !!this.match(/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/);
}

var user_email = "test.email@example.com";

if(user_email.isEmail()) {
    //Email is valid !
} else {
    //Email is invalid !
} 
```

# jquery - jQuery中的按键事件

> ID：940580
> 
> 赞同：2
> 
> 时间：2009-06-02T16:41:14.430
> 
> 标签：jquery

我有一个带有两个按钮的页面。当我按“5”时，我希望单击该按钮 1，并在按“6”时单击按钮 2。可以使用 jQuery 吗？

我也可以在 jQuery 中处理 Ctrl+5 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T17:00:51.487

我建议绑定到[keyup 事件](http://docs.jquery.com/Events/keyup)以防止事件重复触发。下面是一些示例，假设按钮具有 ID、button1 和 button2。

```
$(function() {
    $(document).keyup(function(e) {
       if(e.keyCode == 53 || e.keyCode == 101) { //number 5
          $("#button1").trigger('click');
       } else if(e.keyCode == 54 || e.keyCode == 102) { //number 6
          $("#button2").trigger('click');
       }
   });
}); 
```

捕获 CTRL+5 非常棘手，在 Chrome 的情况下，它会被浏览器拦截。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T16:44:09.247

查看 jQuery 中的[事件助手](http://docs.jquery.com/Events)。[诸如按键](http://docs.jquery.com/Events/keypress#fn)之类的东西。

在按键演示中，当您在框中输入一个键时，您会知道该键的字符码。

例如 5 是 53 而 6 是 64

# c# - 如何在不使用 3rd-party API 的情况下用 C# 压缩文件？

> ID：940582
> 
> 赞同：185
> 
> 时间：2009-06-02T16:41:26.643
> 
> 标签：c#, compression, zip, download

我很确定这不是重复的，所以请耐心等待一分钟。

如何在不使用任何第三方库的情况下以编程方式（C#）压缩文件（在 Windows 中）？我需要一个本地 Windows 调用或类似的东西；我真的不喜欢开始一个过程的想法，但如果我绝对必须这样做，我会的。PInovke 电话会好得多。

如果做不到这一点，让我告诉你我真正想要完成的事情：我需要能够让用户在一个请求中下载一组文档。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：334
> 
> 时间：2013-11-25T18:00:46.007

> 如何在不使用任何第三方库的情况下以编程方式（C#）压缩文件（在 Windows 中）？

如果使用 4.5+ 框架，现在有[ZipArchive](http://msdn.microsoft.com/en-us/library/system.io.compression.ziparchive%28v=vs.110%29.aspx)和[ZipFile](http://msdn.microsoft.com/en-us/library/system.io.compression.zipfile%28v=vs.110%29.aspx)类。

```
using (ZipArchive zip = ZipFile.Open("test.zip", ZipArchiveMode.Create))
{
    zip.CreateEntryFromFile(@"c:\something.txt", "data/path/something.txt");
} 
```

您需要添加对以下内容的引用：

*   **System.IO.压缩**
*   **System.IO.Compression.FileSystem**

对于面向 net46 的 .NET Core，您需要为

*   **System.IO.压缩**
*   **System.IO.Compression.ZipFile**

示例项目.json：

```
"dependencies": {
  "System.IO.Compression": "4.1.0",
  "System.IO.Compression.ZipFile": "4.0.1"
},

"frameworks": {
  "net46": {}
} 
```

对于 .NET Core 2.0，只需添加一个简单的 using 语句即可：

*   **使用 System.IO.Compression；**

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2009-06-02T16:46:50.100

您使用的是 .NET 3.5 吗？您可以使用[`ZipPackage`](http://msdn.microsoft.com/en-us/library/system.io.packaging.zippackage%28v=VS.90%29.aspx)类和相关类。它不仅仅是压缩文件列表，因为它需要您添加的每个文件的 MIME 类型。它可能会做你想做的事。

我目前正在使用这些类来解决类似的问题，将几个相关文件归档到一个文件中以供下载。我们使用文件扩展名将下载文件与我们的桌面应用程序相关联。我们遇到的一个小问题是不可能只使用 7-zip 之类的第三方工具来创建 zip 文件，因为客户端代码无法打开它——ZipPackage 添加了一个隐藏文件，描述了每个组件文件，如果缺少该内容类型文件，则无法打开 zip 文件。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-06-01T12:29:40.617

我处于同样的情况，想要.NET 而不是第三方库。正如上面提到的另一张海报，仅使用 ZipPackage 类（在 .NET 3.5 中引入）是不够的。为了使 ZipPackage 工作，必须在存档中包含一个附加文件。如果添加此文件，则可以直接从 Windows 资源管理器打开生成的 ZIP 包 - 没问题。

您所要做的就是将 [Content_Types].xml 文件添加到存档的根目录，并为您希望包含的每个文件扩展名添加一个“默认”节点。添加后，我可以从 Windows 资源管理器浏览包或以编程方式解压缩并读取其内容。

可以在此处找到有关 [Content_Types].xml 文件的更多信息：http: [//msdn.microsoft.com/en-us/magazine/cc163372.aspx](http://msdn.microsoft.com/en-us/magazine/cc163372.aspx)

以下是 [Content_Types].xml（必须准确命名）文件的示例：

```
<?xml version="1.0" encoding="utf-8" ?>
<Types xmlns=
    "http://schemas.openxmlformats.org/package/2006/content-types">
  <Default Extension="xml" ContentType="text/xml" /> 
  <Default Extension="htm" ContentType="text/html" /> 
  <Default Extension="html" ContentType="text/html" /> 
  <Default Extension="rels" ContentType=
    "application/vnd.openxmlformats-package.relationships+xml" /> 
  <Default Extension="jpg" ContentType="image/jpeg" /> 
  <Default Extension="png" ContentType="image/png" /> 
  <Default Extension="css" ContentType="text/css" /> 
</Types> 
```

以及用于创建 ZIP 文件的 C#：

```
var zipFilePath = "c:\\myfile.zip"; 
var tempFolderPath = "c:\\unzipped"; 

    using (Package package = ZipPackage.Open(zipFilePath, FileMode.Open, FileAccess.Read)) 
    { 
        foreach (PackagePart part in package.GetParts()) 
        { 
            var target = Path.GetFullPath(Path.Combine(tempFolderPath, part.Uri.OriginalString.TrimStart('/'))); 
            var targetDir = target.Remove(target.LastIndexOf('\\')); 

            if (!Directory.Exists(targetDir)) 
                Directory.CreateDirectory(targetDir); 

            using (Stream source = part.GetStream(FileMode.Open, FileAccess.Read)) 
            { 
                source.CopyTo(File.OpenWrite(target)); 
            } 
        } 
    } 
```

笔记：

*   此代码使用 .NET 4.0 中的 Stream.CopyTo 方法
*   随着 .NET 4.5 中 ZipArchive 类的引入，这将变得更加简单：http: [//msdn.microsoft.com/en-us/library/system.io.compression.ziparchive (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/system.io.compression.ziparchive(v=vs.110).aspx)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2015-04-21T01:59:57.230

```
 private static string CompressFile(string sourceFileName)
    {
        using (ZipArchive archive = ZipFile.Open(Path.ChangeExtension(sourceFileName, ".zip"), ZipArchiveMode.Create))
        {
            archive.CreateEntryFromFile(sourceFileName, Path.GetFileName(sourceFileName));
        }
        return Path.ChangeExtension(sourceFileName, ".zip");
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-08T11:42:09.293

根据 Simon McKenzie[对这个问题](https://stackoverflow.com/questions/1023476/recommend-a-library-api-to-unzip-file-in-c-sharp?rq=1)的回答，我建议使用如下两种方法：

```
 public static void ZipFolder(string sourceFolder, string zipFile)
    {
        if (!System.IO.Directory.Exists(sourceFolder))
            throw new ArgumentException("sourceDirectory");

        byte[] zipHeader = new byte[] { 80, 75, 5, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };

        using (System.IO.FileStream fs = System.IO.File.Create(zipFile))
        {
            fs.Write(zipHeader, 0, zipHeader.Length);
        }

        dynamic shellApplication = Activator.CreateInstance(Type.GetTypeFromProgID("Shell.Application"));
        dynamic source = shellApplication.NameSpace(sourceFolder);
        dynamic destination = shellApplication.NameSpace(zipFile);

        destination.CopyHere(source.Items(), 20);
    }

    public static void UnzipFile(string zipFile, string targetFolder)
    {
        if (!System.IO.Directory.Exists(targetFolder))
            System.IO.Directory.CreateDirectory(targetFolder);

        dynamic shellApplication = Activator.CreateInstance(Type.GetTypeFromProgID("Shell.Application"));
        dynamic compressedFolderContents = shellApplication.NameSpace(zipFile).Items;
        dynamic destinationFolder = shellApplication.NameSpace(targetFolder);

        destinationFolder.CopyHere(compressedFolderContents);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T16:47:08.323

看起来Windows可能会让你这样[做](http://www.codeproject.com/KB/cs/decompresswinshellapics.aspx?df=100&forumid=221403&exp=0&select=1253354)......

不幸的是，除非您使用第三方组件，否则我认为您不会绕过启动单独的流程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-22T08:37:58.140

将这 4 个函数添加到您的项目中：

```
 public const long BUFFER_SIZE = 4096;
    public static void AddFileToZip(string zipFilename, string fileToAdd)
    {
        using (Package zip = global::System.IO.Packaging.Package.Open(zipFilename, FileMode.OpenOrCreate))
        {
            string destFilename = ".\\" + Path.GetFileName(fileToAdd);
            Uri uri = PackUriHelper.CreatePartUri(new Uri(destFilename, UriKind.Relative));
            if (zip.PartExists(uri))
            {
                zip.DeletePart(uri);
            }
            PackagePart part = zip.CreatePart(uri, "", CompressionOption.Normal);
            using (FileStream fileStream = new FileStream(fileToAdd, FileMode.Open, FileAccess.Read))
            {
                using (Stream dest = part.GetStream())
                {
                    CopyStream(fileStream, dest);
                }
            }
        }
    }
    public static void CopyStream(global::System.IO.FileStream inputStream, global::System.IO.Stream outputStream)
    {
        long bufferSize = inputStream.Length < BUFFER_SIZE ? inputStream.Length : BUFFER_SIZE;
        byte[] buffer = new byte[bufferSize];
        int bytesRead = 0;
        long bytesWritten = 0;
        while ((bytesRead = inputStream.Read(buffer, 0, buffer.Length)) != 0)
        {
            outputStream.Write(buffer, 0, bytesRead);
            bytesWritten += bytesRead;
        }
    }
    public static void RemoveFileFromZip(string zipFilename, string fileToRemove)
    {
        using (Package zip = global::System.IO.Packaging.Package.Open(zipFilename, FileMode.OpenOrCreate))
        {
            string destFilename = ".\\" + fileToRemove;
            Uri uri = PackUriHelper.CreatePartUri(new Uri(destFilename, UriKind.Relative));
            if (zip.PartExists(uri))
            {
                zip.DeletePart(uri);
            }
        }
    }
    public static void Remove_Content_Types_FromZip(string zipFileName)
    {
        string contents;
        using (ZipFile zipFile = new ZipFile(File.Open(zipFileName, FileMode.Open)))
        {
            /*
            ZipEntry startPartEntry = zipFile.GetEntry("[Content_Types].xml");
            using (StreamReader reader = new StreamReader(zipFile.GetInputStream(startPartEntry)))
            {
                contents = reader.ReadToEnd();
            }
            XElement contentTypes = XElement.Parse(contents);
            XNamespace xs = contentTypes.GetDefaultNamespace();
            XElement newDefExt = new XElement(xs + "Default", new XAttribute("Extension", "sab"), new XAttribute("ContentType", @"application/binary; modeler=Acis; version=18.0.2application/binary; modeler=Acis; version=18.0.2"));
            contentTypes.Add(newDefExt);
            contentTypes.Save("[Content_Types].xml");
            zipFile.BeginUpdate();
            zipFile.Add("[Content_Types].xml");
            zipFile.CommitUpdate();
            File.Delete("[Content_Types].xml");
            */
            zipFile.BeginUpdate();
            try
            {
                zipFile.Delete("[Content_Types].xml");
                zipFile.CommitUpdate();
            }
            catch{}
        }
    } 
```

并像这样使用它们：

```
foreach (string f in UnitZipList)
{
    AddFileToZip(zipFile, f);
    System.IO.File.Delete(f);
}
Remove_Content_Types_FromZip(zipFile); 
```

# sql - 这些选择语句中哪一个“更好”，为什么？

> ID：940590
> 
> 赞同：8
> 
> 时间：2009-06-02T16:42:09.717
> 
> 标签：sql, sql-server

我有 2 个表人和角色。我必须对所有的人基于角色。

```
select person.* from person inner join role on
person.roleid = role.id Where role.id = @Roleid 
```

或者

```
select person.* from person inner join role on
person.roleid = role.id AND role.id = @Roleid 
```

以上两种解决方案中哪一种更好，为什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-02T16:45:33.207

第一个更好，因为它在逻辑上是连贯的。作用域条件与联接无关，因此将其作为联接的一部分是一种混乱，在这种情况下是无用的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-02T16:46:59.413

关系代数没有区别。像这样的 where 和 inner join 的标准是可以互换的。我根据可读性和情况使用两者。

在这种特殊情况下，您还可以使用：

```
select person.* from person WHERE person.roleid = @Roleid 
```

唯一的区别是它不需要角色表中存在一行（但我假设您对此具有引用完整性）并且如果 roleid 不是唯一的（在大多数情况下几乎可以肯定是我），它将不会返回多行可以预见）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-02T16:57:19.683

最好的办法是尝试这些查询并通过 MS Sql 的执行计划运行它们。我这样做了，结果如下所示：

[显示查询性能相同的执行计划 http://img223.imageshack.us/img223/6491/querycompare.png](http://img223.imageshack.us/img223/6491/querycompare.png)

如您所见，性能是相同的（当然*，在您的数据库上运行它可能会产生不同的结果。*）因此，**最好**的查询是遵循您用于编写查询的一致约定的查询。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T16:45:05.690

SQL Server 应该以相同的方式评估这些查询。就个人而言，我会使用 AND。我喜欢将连接表的所有标准保留在连接本身中，以便它们组合在一起并且易于查找。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T16:46:27.903

两个查询是相同的。在查询处理期间，SQL Server 在应用连接条件过滤器后立即应用 WHERE 过滤器，因此您最终会得到相同的过滤方式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-02T16:46:36.233

我更喜欢#1，我相信它更好地表达了声明的意图。您正在根据 roleid 和 role.id 加入两个表，并且您正在根据 @Roleid 进行过滤

```
SELECT person.* 
FROM person INNER JOIN role ON person.roleid = role.id 
Where role.id = @Roleid 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T16:46:00.540

Sqlserver 可能具有相当于 Oracle、PostgreSQL 和 MySQL 都以一种或另一种形式支持的“解释计划”语句。它在告诉您查询解析器和优化器将如何处理您的查询时非常有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T20:48:57.037

我会选择第一个，但请记住，在完成测试代码后，您应该明确选择每个表，而不是执行 select *

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T07:57:30.850

由于您没有从`role`您那里获取列，因此最好不要将其包含在`FROM`子句中。用这个：

```
SELECT *
FROM   person
WHERE  person.roleid IN (SELECT id FROM role WHERE id = @Roleid) 
```

这样优化器在`FROM`子句中只看到一个表，并且可以快速找出结果集的基数（即结果集中的行数 <= table 中的行数`person`）。

当您使用`JOIN`优化器抛出两个表时，必须查看`ON`子句以确定这些表是否是等连接的以及连接列上是否存在唯一索引。如果`ON`子句中的谓词很复杂（多个 AND 和 OR）或完全错误（有时非常错误），则优化器可能会选择次优连接策略。

显然，这个特定的示例非常做作，因为您可以直接过滤`persons`（`roleid = @Roleid`无连接或子查询），但如果您必须过滤`role`（例如@Rolename）中的其他列，则上述注意事项是有效的。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2009-06-02T16:47:49.180

使用此查询是否会对性能产生任何影响/提升？

```
SELECT person.* FROM person,role WHERE person.roleid=role.id AND role.id=@RoleID 
```

# c# - wpf 图像资源和在运行时在 wpf 控件中更改图像

> ID：940592
> 
> 赞同：11
> 
> 时间：2009-06-02T16:42:13.523
> 
> 标签：c#, wpf, image, dictionary, resources

我想确切地知道如何在后面的 C# 代码中动态使用字典资源 - 即.. 我想在运行时从字典中的图像资源加载图像

我有一个在 WPF 字典中有 3 个图像的程序 - 这些是设置为图像资源的图像。

然后在我的 WPF 窗口后面的代码中，我想根据用户启动的事件加载三个图像中的任何一个。

没有我必须展示的真正代码，因为我所做的任何工作都没有。

想法？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-03T02:09:22.397

首先，确保您已像这样定义图像资源：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ImageSource x:Key="image1">images/image1.jpg</ImageSource>
    <ImageSource x:Key="image2">images/image2.jpg</ImageSource>
</ResourceDictionary> 
```

其次，我假设您的 WPF 字典在它自己的文件中。现在您必须确保已将字典合并到主窗口的 XAML 中（如果您的资源字典是在窗口的 XAML 中定义的，请跳过此步骤）。在你的窗口的 XAML 文件中，确保你有这样的东西：

```
<Window.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="myDictionary.xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Window.Resources> 
```

现在，在您的代码隐藏中，您可以使用 FindResource() 方法通过它的键名（资源字典中 ImageSource 上 x:Key 属性的值）来定位您的图像资源，如下所示：

```
imageControl.Source = (ImageSource)FindResource("image1"); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-11T21:27:45.487

这是对[已接受答案](https://stackoverflow.com/a/942766/)的补充：在`ViewModel`from MVVM 中工作时，请确保`FindResource`从添加资源目录的视图中使用。

```
<Window x:Class="My.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ViewModels="clr-namespace:My.ViewModels"
        Title="USA Hockey Player Evaluation tool" 
        Icon="/USAHockeyPlayerEval;component/View/Images/HET.ico"
        SizeToContent="WidthAndHeight"
        MinHeight="500px" MinWidth="800px">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Images.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <Window.DataContext>
        <ViewModels:MainWindowMV/>
    </Window.DataContext>
    <StackPanel>
        <Menu>
            <MenuItem Header="File">
                <MenuItem Header="Save"></MenuItem> 
```

在这种情况下，我的观点是一个窗口（我知道不正确的 MVVM ;-)）

```
Image img = new Image();                                    
img.Source = (ImageSource)WindowReference.FindResource("Pluse"); 
```

这里`WindowReference`是对 的参考`My.MainWindow`。

# sharepoint - Sharepoint Masterpage 的 WSPBuilder 和 Code behind

> ID：940604
> 
> 赞同：0
> 
> 时间：2009-06-02T16:44:51.290
> 
> 标签：sharepoint, moss, wss, wspbuilder

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:05:51.513

您是否仍然必须包含 SafeControls 条目才能使其工作，例如：

```
<SafeControl Assembly="[FullAssembly Name]"
                     Namespace="[YourMasterPageNamespace]"
                     TypeName="*"
                     Safe="True" /> 
```

或在 WSPBuilder 配置中：

```
<add key="BuildSafeControls" value="True" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T10:40:12.723

从来没有见过这个.. 但我怀疑没有多少人在 SharePoint 中创建母版页的代码隐藏（微软也没有！）。

我不知道您要构建什么，但我可能会使用母版页中包含的服务器控件来实现它。

AllowPartiallyTrustedCallers 一直为我的服务器控件修复它。

您的 web.config 文件中的信任设置为什么？尝试完整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:31:28.283

Are you calling a third party assembly?

I ran into a situation recently that I was using a third party assembly and it did not have **AllowPartiallyTrustedCallers** in its code. When I tried to use the assebmly, it would fail.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T18:18:30.190

您确定程序集已意外部署到 bin 而不是 GAC 吗？如果有两个程序集，则 GAC 中的一个优先。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-12T20:20:29.810

您可以尝试检查您是否使用了完全限定的**五**部分名称，包括正确的公钥令牌和程序集的命名空间。

# .net - .NET DataReader 和 SQL 连接

> ID：940611
> 
> 赞同：1
> 
> 时间：2009-06-02T16:45:45.250
> 
> 标签：.net, sql, sqldatareader

```
string query = 
    "SELECT * FROM table1, table2 WHERE table1.Id = table2.fId";
...
using(IDataReader dataReader = 
    db.ExecuteReader(CommandType.Text, query))
..
string value = dataReader["table2.field"]; //dies 
```

我目前正在编写一些 .NET 代码，其中涉及执行连接查询，然后使用 DataReader 访问返回的数据。我想知道是否可以使用某种前缀表示法（参见上面的示例）从返回的行中访问字段，而不必使用序数位置来访问行中的值（在两个表都包含重叠字段的情况下）名字）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T16:49:31.020

既然你提前知道了字段名称，为什么不在 select 语句中表达出来呢？

```
string query = "SELECT table2.field as field2, ... FROM table1, table2 " + 
               "WHERE table1.Id = table2.fId"; 
```

那你可以参考一下`dataReader["field2"]`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T17:11:02.600

您永远不应该将 select * 查询发送到生产服务器，因为它会浪费资源。当您加入时，至少有一个字段重复，完全没有必要同时发送。如果您实际上并不需要每一列，则不应返回所有列。此外，当数据库结构发生变化时，您将使用 select * 来中断代码。这确实是个坏主意。

您还应该真正学习使用 ANSII 92 连接语法。您使用的语法仅过时 18 年，并且可能会导致很多问题，因为当人们忘记 where 子句中的连接条件之一时，它过于频繁地导致交叉连接（使用 ANSII 92 连接语法，这不会通过语法检查）。在 SQL Server 中使用旧式左连接语法 (*=) 时，它也并不总是给出正确的答案，因为它有时但并非始终将其解释为交叉连接（并且该样式左连接已被弃用并且不允许在下一个版本中）。我不知道您使用的是什么数据库，但如果您有 SQL Server 后端，则需要注意这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T17:30:05.257

Using * instead of a fieldlist is the **number 1** sql anti-pattern as determined by stack overflow voters.

[What are the most common SQL anti-patterns?](https://stackoverflow.com/questions/346659/what-are-the-most-common-sql-anti-patterns/346679#346679)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T16:49:58.083

无论列的来源如何，选择的结果都是单个表。您可以看到，当表格有一个共同的列时，它往往会抱怨。:) 如果您上面列出的表具有唯一的列，那么您只需拥有 ["field"]。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T17:34:26.547

有一些合法的情况，也许你得到了一个数据阅读器或一个存储过程，而你不一定能控制源——例如，在工具或实用程序库中。

虽然总的来说我建议不要使用 *，而是使用别名

您可以通过使用[DataReader.GetSchemaTable](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getschematable(vs.71).aspx)并查看 BaseTableName 来获得所需的内容。

您还需要使用 ExecuteReader(System.Data.CommandBehavior.KeyInfo) 调用 ExecuteReader。

# .net - .NET 和 TSQL “For Xml Auto”拆分 XML 结果

> ID：940617
> 
> 赞同：0
> 
> 时间：2009-06-02T16:46:20.303
> 
> 标签：.net, xml, tsql

我正在使用一些带有“For XML Auto”的 TSQL。如果我在管理工作室中运行 TSQL，我会得到一行。如果我使用 DataAdapter.Fill() 命令填充 DataTable，我会得到两个结果。结果似乎在其中一个标签的中间进行了拆分。它不是一个巨大的 XML 文件，实际上它非常小（可能 20 行），所以大小可能不是问题。这是SQL。

> 选择 Organization.Name、Organization.Abbreviation、Organization.WebsiteURL、Organization.AddressLine1、Organization.AddressLine2、Organization.City、Organization.Province、Organization.Country、Organization.PostalCode、Organization.Phone、Organization.Email、Organization.ContactFirstName、Organization .ContactLastName FROM
> StudentLife.MissionWeekOrganization Organization INNER JOIN StudentLife.MissionWeekOrganizationAttendee reg ON Organization.MissionWeekOrganizationId = reg.MissionWeekOrganizationId WHERE (reg.AttendingYear = 2010 AND ReceivedDate IS NOT NULL) ORDER BY Organization.Name FOR XML AUTO

结果在元素的中间被拆分

> ... 组织名称=\"Samaritan's Purse Canada\" 缩写=\"\" WebsiteURL=\"http

然后 DataTable 中的第二行从它停止的地方开始。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:39:44.433

谢谢你们的建议。我想到了。问题不在于sql server（正如我所说的管理工作室在一行中正确返回答案）。添加 Type 也无济于事，（Sql server 从一开始就知道它是 xml）。问题是 ADO.NET 在创建数据表时会分解结果。

事实证明，我不应该使用 Command.ExecuteReader 中的 SqlDataReader。相反，我应该使用 Command.ExecuteXmlReader 中的 System.Xml.XmlReader。然后按照您的建议进行操作，连接这些结果（尽管使用 DataAdapter.Fill 方法连接所有行的所有结果可能会起作用）。

因此是这样的：

> ```
>  System.Xml.XmlReader rdr = Command.ExecuteXmlReader();
>               try
>               {
>                   System.Text.StringBuilder sb = new System.Text.StringBuilder();
> 
>                   rdr.Read();
>                   while (! rdr.EOF)
>                   {
>                       sb.Append(rdr.ReadOuterXml());
>                   }
> 
>                   result = sb.ToString();
>               }
>               finally
>               {
>                   rdr.Close();
>               } 
> ```

谢谢您的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:04:48.253

我记得几年前我使用 xml auto 时，每行有一个字符限制，这就是引擎将数据拆分为单独行的原因。我认为您需要连接这些片段，然后才能将其用作任何数据表的源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:11:27.433

你可以使用“FOR XML AUTO, TYPE”吗？它将返回“XML”类型的列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T17:17:21.453

那是sql server的问题，当它认为结果很大时，它会将结果拆分为多个项目。您必须阅读结果并附加到字符串。

我不知道为什么会出现这种行为，但我正在从 IDataReader 读取数据，我感到很困惑。后来我附加到一个字符串生成器并得到了输出 xml。我得到了一个很大的 xml，它被拆分了 30 次。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T22:24:45.390

看看这个： http: [//support.microsoft.com/default.aspx ?scid=kb;en-us;310378](http://support.microsoft.com/default.aspx?scid=kb;en-us;310378)

您可以通过将 xml 结果分配给“xml”类型的变量并返回它来解决 SQL（如果这是一个选项）。

```
DECLARE @ResultXML xml

SET @ResultXML = 
 (SELECT ...
  FROM MyTable
  FOR XML AUTO)

SELECT @ResultXML as [MyXML] 
```

# html - 有人打印网页时的服务器端日志记录

> ID：940632
> 
> 赞同：4
> 
> 时间：2009-06-02T16:48:13.127
> 
> 标签：html, css, printing

在我的工作中，我们有兴趣跟踪人们打印我们网页的频率。（如果很多人都在这样做，我们可能会更加关注使打印视图更好。）

显然，如果我们在页面上放置一个“打印”按钮，我们可以在人们点击它时进行记录，但如果用户只是使用“文件”菜单并选择“打印”，我们无法知道他们是否这样做了。

是否有一些巧妙的方法可以使用仅打印 CSS 使浏览器仅在打印时发出 Web 请求？我的实验似乎说不，但这似乎应该是可能的。

编辑：下面提供了一个适用于 FF 的合理答案；我为一个也适用于 IE 的解决方案提供 100 分赏金。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-10T01:21:56.493

为了建立来自 Tyson 和 Jao 的响应，您可以尝试这种方法来解决默认情况下不显示/打印背景图像的问题。而不是背景图像，使用子弹图像...

在您的 HTML 源代码中插入一个元素，例如：

```
<div id="print_tracker"><ul><li>&nbsp;</li></ul></div> 
```

在您的屏幕 CSS 中：

```
@media screen {
    #print_tracker { display: none; }
}
@media print {
    #print_tracker { display: block; }
    #print_tracker UL { list-style-image: url(/images/printtracker.gif); }
} 
```

然后跟踪该图像的点击量。哈基...我知道

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T16:53:21.920

也许您可以将背景图像添加到 print.css 文件并将该背景图像链接到服务器上执行日志记录的文件。

例如：

```
body {background-image:url(http://www.example.com/printlogger.aspx);} 
```

我不确定这是否有效，只是一个想法

**更新：**我刚刚尝试了上述方法。如果您进行打印预览，它会增加计数器。但是，在打印页面时更新计数器时不会（即使关闭打印背景图像）。另一种选择可能是使用 CSS 内容属性。

**更新二**您可以使用 content 属性，在 Firefox 中工作，而不是在 IE8 中。我没有测试过其他浏览器：

```
body
{
    content:url(http://www.example.com/Count.aspx);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T16:59:33.080

没有准确的方法可以查看何时打印页面（有些人可能认为这是侵犯隐私）。使用单独的`print`CSS 的建议确实有效，但它们会产生很多误报——打印预览、预取和镜像工具（甚至`wget`）也会请求 CSS 文件，即使它们不打算打印任何东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T16:56:54.957

在您的 HTML 源代码中插入一个元素，例如：

```
<div id="print_tracker"></div> 
```

在您的屏幕 CSS 中：

```
#print_tracker { display: none } 
```

（这并不是真正需要的，除非您有一些 div 的默认样式使其具有大小。）

在您的打印 CSS 中：

```
#print_css { display: block; height: 1px; background-image: url(clear.gif); } 
```

然后只需跟踪该图像的点击量。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T17:00:09.820

您可以使用 javascript 检查您的打印 CSS 是否已加载（您可以使用媒体选择器为特定布局选择 CSS）。然后，javascript 可以将此请求记录到服务器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-10T01:28:52.157

对于 IE，探索使用 Document body 的 print 相关事件。

window.onbeforeprint - 在打印页面之前触发 window.onafterprint - 在要打印的页面加载到打印机队列/缓存后立即触发。

$（函数（）{

```
 //Check to see if browser supports onbeforeprint (IE6, IE7 and IE8)
    if (window.onbeforeprint !== undefined) {
       window.onbeforeprint = TrackPrint;

    }

}); function TrackPrint(){
$.get("http://www.example.com/Count.aspx");} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-10T01:20:25.573

您可以有一个“打印版本”页面并在该页面上放置一些服务器端日志记录，但这对于所有相关方来说可能有点烦人。

你还能做的其他事情是这样的：

1.  在页面加载时，使用 javascript 在页面上添加一个仅打印样式表，该样式表隐藏所有内容，除了一条消息“请使用此页面上的打印链接”。
    *   在此处使用 javascript，以便禁用 JS 的用户仍然可以正常打印。您将无法记录它们，但也不会激怒它们。
2.  在页面上放置一个链接，单击该链接时，通过 AJAX 记录事件，删除该样式表，然后调用`window.print()`

# ms-access - MS 访问控制从连续形式复制/粘贴数据

> ID：940633
> 
> 赞同：0
> 
> 时间：2009-06-02T16:48:32.877
> 
> 标签：ms-access, copy-paste

我有一个用户正在处理 Access Database 连续表单页面，他们可以在其中执行一堆过滤和数据输入。

有时，用户希望能够从该表单中选择几行并将它们直接粘贴到电子邮件中。Outlook 可以很好地将数据格式化为表格，但我们遇到的问题是标题中的下拉控件包含在粘贴的数据中，如下所示：

```
Employee_Absences
drpEmployee drpOrgDescrip   lstTimeCode txtToDate   txtFromDate chkShowExcused  DESCR   AbsenceDate Hours   Excused_Hours   Time Code   employee_lookup.ORG_DESCRIP ImportedDate
            6/2/2009    1/1/2009    0   Bob 1/4/2009    4   0   VAC Medical 5/7/2009 4:51:31 PM
            6/2/2009    1/1/2009    0   Bill    1/4/2009    6   0   VAC Medical     5/7/2009 4:51:31 PM
            6/2/2009    1/1/2009    0   Betty   1/4/2009    4   0   VAC Medical 5/7/2009 4:51:31 PM
            6/2/2009    1/1/2009    0   Beth    1/5/2009    2   0   VAC Gamers  5/7/2009 4:51:31 PM 
```

用户不想在每次想要在电子邮件中包含几行时都删除和重新排序列，并且为了获得两到三行而强制它们进入单独的报告或数据表是相当不友好的。我尝试弄乱填充表单的查询中参数的顺序，但这根本没有帮助。

是否有某种类型的 Copy-to-Clipboard 事件，我可以挂钩并对数据行做一些魔术？还有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T02:59:13.933

这肯定是表单上的布局问题。选择连续表单的行不应从表单标题中的控件复制数据。

也许我误解了这个问题？

当然*可以*将数据放在剪贴板上。请参阅此页面：

[将变量/控制内容复制到内存](http://www.mvps.org/access/api/api0049.htm)

但是要粘贴到电子邮件中，您需要纯文本，并且电子邮件需要以固定宽度的字体显示。除非您想编写 HTML，否则没有简单的方法来格式化将粘贴到非纯文本电子邮件中的表格。如果他们以 HTML 格式发送（他们不应该这样），则 HTML 表格将起作用。如果他们使用的是 RTF（他们不应该），我不知道如果你粘贴 HTML 会发生什么。

尝试找出表单标题控件被复制的原因。我敢打赌，用户没有正确定义初始选择，而您教他们这样做（或设计子表单以防止它），您无需编写任何程序——这就是 Access 的全部优点。

另一方面，我不相信允许在连续或数据表表单中进行编辑，因为如果您需要动态组合框等进行数据验证，则可能会导致各种问题。相反，我使用连续和数据表表单作为列表，并将详细信息子表单绑定到连续/数据表表单的 PK，这样当您在连续/数据表表单中选择记录时，数据将出现在可编辑的详细信息子表单中。

我在编辑连续表格和数据表表格时遇到了太多问题，这就是我这样做的原因。我为此做的唯一例外是发票类型的表格，否则没有好的方法可以做到这一点。

# c# - WPF - 从 System.Windows.Application 继承

> ID：940644
> 
> 赞同：6
> 
> 时间：2009-06-02T16:49:43.310
> 
> 标签：c#, .net, wpf, xaml, visual-studio-2008

我想拥有自己的继承自 System.Windows.Application 的应用程序类。问题是在 Application.xaml 文件中，我必须像这样声明应用程序：

```
 <src:MyBaseApplication x:Class="MyApplication"
    xmlns:src="clr-namespace:MyApplication;assembly=WpfTestApplication"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    StartupUri="FPrincipal.xaml">    
    <Application.Resources>

    </Application.Resources>
</src:MyBaseApplication> 
```

它在运行时运行良好，但是当我编辑项目属性时，我收到 Visual Studio 的项目属性编辑器的以下错误消息：

> 尝试加载此项目的应用程序定义文件时发生错误。无法解析文件“[...]\Application.xaml”。请在 XAML 编辑器中编辑文件以修复错误。在应用程序定义文件中找不到预期的根元素“应用程序”。

该项目是一个 VB.NET 项目。有人有解决方法吗？我想保留 application.xaml 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-11-16T09:29:29.950

我已经使用 Visual Studio 2013 进行了尝试，但没有遇到任何问题。所以，它应该是 VS 2008 特有的。您是否尝试将您的应用程序类重新组织到一个单独的类库中？也许这是一个锁定问题。

**更新**

为了实现它，我在 VB.NET VS2013 中执行的步骤：

1.  创建自定义应用程序类。我在同一个程序集中创建了它。我的程序集名称是：WPFVBTest

> ```
> Public Class CustomApplication
>   Inherits System.Windows.Application
> 
> End Class 
> ```

2.  修改 Application.xaml。添加命名空间引用并将根容器更改为自定义应用程序类。

> ```
>  <self:CustomApplication x:Class="Application"
>         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
>         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
>       xmlns:self="clr-namespace:WPFVBTest"
>         StartupUri="MainWindow.xaml">
>     </self:CustomApplication> 
> ```

3.  修改文件后面的代码：Application.xaml.vb 以继承自 CustomApplication 类

> ```
> Class Application
>   Inherits CustomApplication
> 
> End Class 
> ```

4.  构建应用程序。应该出现一个错误，表明 MyWpfExtension.vb 与应用程序类名称不同步。这是一个生成的类，但不是在每次构建时都重新生成。我知道它作弊，但这是我能管理它的唯一方法。所以我手动修改了它：

> ```
> Partial Class Application
>   Inherits CustomApplication 
> ```

这样，应用程序就可以毫无问题地构建和运行。我希望它可以帮助您解决您的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-17T12:38:48.110

我知道这不会是一个流行的答案，但是......你为什么不升级到 Visual Studio 2015？免费！

见鬼，他们昨天刚刚宣布了 VS 2017；也是免费的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-02T16:58:14.363

它应该说 < src:MyBaseApplication.Resources > 吗？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-05T12:00:52.773

应用程序通常指向一个窗口并尝试从 xaml 文件中获取此信息；但是您的 xaml 文件中有 Visual Studio 无法确定的引用。

```
xmlns:src="clr-namespace:MyApplication;assembly=WpfTestApplication" 
```

因此 VS 无法解析您的 xaml 文件，从而给出该错误...

我的建议：覆盖窗口，或在应用程序上使用扩展，如下所示：

```
public static class ApplicationExtensions
{
    public static string GetAwesomeName(this Application)
    {
        return "I am an awesome application";
    }
} 
```

像这样使用它：

```
Application.Current.GetAwesomeName(); 
```

# eclipse - 由于路径长，eclipse插件不加载dll

> ID：940648
> 
> 赞同：0
> 
> 时间：2009-06-02T16:50:19.100
> 
> 标签：eclipse, dll, eclipse-plugin, java-native-interface, osgi

我正在构建一个 Eclipse 插件（一个注释插件，但它最终是一个 Eclipse 插件）。我的插件依赖的插件之一需要加载本机 dll。

问题是，这取决于此类 dll 在磁盘中的位置而失败。如果它长于某个阈值，我会收到以下错误

java.lang.UnsatisfiedLinkError: nlsxbe (The filename or extension is too long.) at java.lang.ClassLoader.loadLibraryWithPath(ClassLoader.java:952) at java.lang.ClassLoader.loadLibraryWithClassLoader(ClassLoader.java:921) at java. lang.System.loadLibrary(System.java:452) at lotus.domino.NotesThread.load(Unknown Source) at lotus.domino.NotesThread.checkLoaded(Unknown Source) at lotus.domino.NotesThread.sinitThread(Unknown Source) at com .atempo.adam.lotus.plugin.views.TopicView.createPartControl(TopicView.java:609)

我已经添加了 Path env var 的路径，并且还注册了 dll 无济于事。我的环境是 ms vista profesional、java1.5、eclipse3.4（和 lotus 8）

有人有线索吗？

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T16:58:35.720

我遇到过类似的问题，只需要确保文件不在长路径中。

有很多程序似乎存在长路径问题，包括一些内置的 Windows 程序。

您是否可以控制此 DLL 所在的位置？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-24T10:36:46.427

这是 Windows MAX_PATH 限制的症状之一。有关于它的知识库注释（例如[320081](http://support.microsoft.com/?kbid=320081)）和一些关于处理这些文件的手动方法的讨论，您可以使用 Google 轻松找到这些文件。

问题是 Windows 对用于各种系统和命令级调用的*完整文件路径的长度有限制。*尽管用户社区已经进行了很多讨论（甚至在 Microsoft KB 中尝试了一些新奇的东西），但它们都归结为您通过公平或错误的方式缩短了相关文件的文件路径。

以太坊中有一些迹象表明，Microsoft 的 Unicode API 允许（最多）32k 字节的文件路径，但我不知道这是否属实。但是，仍然存在许多现有程序不使用这些 API 并因此超出此限制的情况。（Windows API 甚至有可能使用 UTF16（或 UCS2），在这种情况下，这仅意味着 16k 个字符——有人知道吗？）

系统允许您通过多种方法创建“无法访问”的文件路径——一种是通过导航逐步创建路径中的步骤；另一个是挂载共享——有时系统功能和实用程序在内部依赖于完整的文件路径进行操作，这超出了这个限制。

除非从 Windows 系统代码中删除这个基本的愚蠢限制，否则唯一的办法就是移动和/或重命名文件……</p>

…或运行 Unix。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:46:43.583

我尝试注册 dll 并将其移动到 c:\windows\system32（更短的路径），但我的 Lotus Notes 插件无法加载所需的库（Notes.jar）。

只有当我将 Lotus Notes 安装在比“c:\program files\IBM\lotus\Notes”更短的路径中时它才能正常工作。例如，如果我将它安装在“c:\Archivos de programa\IBM\lotus\Notes”中，它可以找到我的 dll，但无法加载库。

错误是：

GRAVE 无法创建视图 ID com.atempo.adam.lotus.plugin.views.TopicView: nlsxbe (文件名或扩展名太长。) ::class.method=unknown ::thread=main ::loggername=org.eclipse .ui.workbench

```
java.lang.UnsatisfiedLinkError: nlsxbe (The filename or extension is too long. )
at java.lang.ClassLoader.loadLibraryWithPath(ClassLoader.java:952)
at java.lang.ClassLoader.loadLibraryWithClassLoader(ClassLoader.java:921)
at java.lang.System.loadLibrary(System.java:452)
at lotus.domino.NotesThread.load(Unknown Source)
at lotus.domino.NotesThread.checkLoaded(Unknown Source)
at lotus.domino.NotesThread.sinitThread(Unknown Source)
at com.atempo.adam.lotus.plugin.views.TopicView.createPartControl(TopicView.java:639)
at org.eclipse.ui.internal.ViewReference.createPartHelper(ViewReference.java:332)
at org.eclipse.ui.internal.ViewReference.createPart(ViewReference.java:197)
at org.eclipse.ui.internal.WorkbenchPartReference.getPart(WorkbenchPartReference.java:566)
at org.eclipse.ui.internal.PartPane.setVisible(PartPane.java:290)
at org.eclipse.ui.internal.ViewPane.setVisible(ViewPane.java:525)
at org.eclipse.ui.internal.presentations.PresentablePart.setVisible(PresentablePart.java:140)
at com.ibm.rcp.ui.internal.presentations.FolderStackPresentation.selectPart(FolderStackPresentation.java:692)
at org.eclipse.ui.internal.PartStack.refreshPresentationSelection(PartStack.java:1144)
at org.eclipse.ui.internal.PartStack.createControl(PartStack.java:620)
at org.eclipse.ui.internal.PartStack.createControl(PartStack.java:532)
at org.eclipse.ui.internal.PartSashContainer.createControl(PartSashContainer.java:562)
at org.eclipse.ui.internal.PerspectiveHelper.activate(PerspectiveHelper.java:244)
at org.eclipse.ui.internal.Perspective.onActivate(Perspective.java:815)
at org.eclipse.ui.internal.WorkbenchPage.setPerspective(WorkbenchPage.java:3269)
at org.eclipse.ui.internal.WorkbenchPage.busySetPerspective(WorkbenchPage.java:956)
at org.eclipse.ui.internal.WorkbenchPage.access$12(WorkbenchPage.java:940)
at org.eclipse.ui.internal.WorkbenchPage$12.run(WorkbenchPage.java:3368)
at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67)
at org.eclipse.ui.internal.WorkbenchPage.setPerspective(WorkbenchPage.java:3366)
at org.eclipse.ui.internal.Workbench.showPerspective(Workbench.java:2102)
at com.ibm.rcp.portal.app.ui.internal.serviceImpl.DoInternalUIService.openApplicationPerspective(DoInternalUIService.java:981)
at com.ibm.rcp.portal.app.ui.internal.serviceImpl.DoInternalUIService.openApplicationPerspective(DoInternalUIService.java:886)
at com.ibm.rcp.portal.app.ui.internal.serviceImpl.DoInternalUIService.openApplicationPerspectiveWithNavigator(DoInternalUIService.java:863)
at com.ibm.rcp.portal.app.ui.internal.serviceImpl.DoInternalUIService.access$12(DoInternalUIService.java:857)
at com.ibm.rcp.portal.app.ui.internal.serviceImpl.DoInternalUIService$8.run(DoInternalUIService.java:1197)
at org.eclipse.ui.internal.UILockListener.doPendingWork(UILockListener.java:155)
at org.eclipse.ui.internal.UISynchronizer$1.run(UISynchronizer.java:36)
at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)
at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)
at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3659)
at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3296)
at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1931)
at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1895)
at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:423)
at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
at com.ibm.rcp.personality.framework.internal.RCPApplication.run(RCPApplication.java:72)
at org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:400)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:177)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:615)
at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:549)
at org.eclipse.equinox.launcher.Main.basicRun(Main.java:504)
at org.eclipse.equinox.launcher.Main.run(Main.java:1236)
at org.eclipse.equinox.launcher.Main.main(Main.java:1212)
at org.eclipse.core.launcher.Main.main(Main.java:30) 
```

谢谢。

# php - 如何将 Google 搜索结果重定向到动态网页？

> ID：940665
> 
> 赞同：1
> 
> 时间：2009-06-02T16:54:00.420
> 
> 标签：php, mysql, dynamic-data, google-base

我正在尝试通过 XML 提要将项目列表输入[Google Base](http://www.google.com/base/?gsessionid=4zzSowZKNrT4MlmWGPr7jA)，这样，当用户搜索这些项目之一，然后单击 Google Base（或纯 Google）中的搜索结果链接时，用户将被定向到我网站上的动态网页。我假设指定特定链接（静态或动态）的唯一方法是通过 XML 提要中的属性。那是对的吗？因此，例如，如果我的属性是：

```
http://www.example.com/product1-info.html 
```

用户将被定向到该`product1-info.html`页面。

但是，如果我想让用户重定向到一个动态页面，而不是静态产品页面，该页面会从我的本地数据库（在我的网站上）为所有包含关键字“product1”的产品生成搜索结果，我能做到吗？做这样的事情？：

```
http://www.example.com/products.php?productID=product1 
```

最后，也是最重要的，有没有办法从“常规”谷歌搜索中指定这个登陆页面（或任何特定的登陆页面）？还是只能通过 Google Base 和属性实现？换句话说，如果我将一堆东西放入 Google Base，如果其中任何一个出现在常规的 Google 搜索中，我有没有办法控制将哪些参数传递到登录页面（因此，什么是搜索在着陆页上执行），还是我无法控制？我希望我正确地解释了这一点。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T21:42:18.037

第一个问题：是的，允许包含 query_string 部分的 url。
[http://base.google.com/support/bin/answer.py?hl=en&answer=78170](http://base.google.com/support/bin/answer.py?hl=en&answer=78170)说：

```
XML 示例：
<link> http://www.example.com/asp/sp.asp?cat=12&id=1030</link> ;
```

--
让我重新表述第二个问题，看看**是否**我理解正确（可能完全走错了方向）：例如 products.php?productID=product1 对产品“FooEx”和 products.php?productID=product2 对“BarPlus”执行数据库搜索。现在你希望谷歌显示链接 .../products.php?productID=product1 但不是 ....?productId=product2 如果有人搜索“FooEx”并且谷歌认为你的网站是相关的？那么这就是我们在搜索引擎中都面临的同一个“问题”：传达每个 url 的相关内容。例如，在页面的 title/h1 元素中出现适当的（并且只有适当的）关键字，避免使用不同的 url 链接到相同的内容（例如 product.php?x=1&productId=1 <-> product.php? productId=1&x1，不同的 url 请求最有可能完全相同的内容），

[编辑：您可以通过使用类似mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)的东西（例如，zend 框架的[前端控制器](http://framework.zend.com/manual/en/zend.controller.html)[使用它](http://framework.zend.com/manual/en/zend.controller.html#zend.controller.quickstart.go.rewrite)）或通过解析 $_SERVER["PATH_INFO"] 的内容（这需要网络服务器）来避免查询字符串部分[提供](http://httpd.apache.org/docs/2.0/mod/core.html#acceptpathinfo)该信息），例如[http://localhoast/test.php/foo/bar](http://localhoast/test.php/foo/bar) -> $_SERVER['PATH_INFO']=='/foo/bar'
另请查看此线程的链接：[如何将 Google 搜索结果重定向到动态网页？](https://stackoverflow.com/questions/940665/how-to-redirect-a-google-search-result-to-a-dynamic-web-page)，它包含线程的标题，但 SO 非常满意[如何将 Google 搜索结果重定向到动态网页？](https://stackoverflow.com/questions/940665)， 也。标题是搜索引擎和（甚至更多）用户的“唯一”附加数据。您也可以这样做：
[http](http://www.example.com/products.php/product1/FooEx) ://www.example.com/products.php/product1/FooEx <-> [http://www.example.com/products.php/product2/BarPlus](http://www.example.com/products.php/product2/BarPlus)

# c# - 从 methodinfo 获取委托

> ID：940675
> 
> 赞同：44
> 
> 时间：2009-06-02T16:58:13.863
> 
> 标签：c#, reflection, delegates

我有一个下拉列表，通过检查类的方法并包括与特定签名匹配的方法来填充。问题在于从列表中获取所选项目并让委托在类中调用该方法。第一种方法有效，但我无法弄清楚第二种方法的一部分。

例如，

```
public delegate void MyDelegate(MyState state);

public static MyDelegate GetMyDelegateFromString(string methodName)
{
    switch (methodName)
    {
        case "CallMethodOne":
            return MyFunctionsClass.CallMethodOne;
        case "CallMethodTwo":
            return MyFunctionsClass.CallMethodTwo;
        default:
            return MyFunctionsClass.CallMethodOne;
    }
}

public static MyDelegate GetMyDelegateFromStringReflection(string methodName)
{
    MyDelegate function = MyFunctionsClass.CallMethodOne;

    Type inf = typeof(MyFunctionsClass);
    foreach (var method in inf.GetMethods())
    {
        if (method.Name == methodName)
        {
            //function = method;
            //how do I get the function to call?
        }
    }

    return function;
} 
```

如何使第二种方法的注释掉部分起作用？我如何将其`MethodInfo`转换为委托？

谢谢！

**编辑：这是有效的解决方案。**

```
public static MyDelegate GetMyDelegateFromStringReflection(string methodName)
{
    MyDelegate function = MyFunctionsClass.CallMethodOne;

    Type inf = typeof(MyFunctionsClass);
    foreach (var method in inf.GetMethods())
    {
        if (method.Name == methodName)
        {
            function = (MyDelegate)Delegate.CreateDelegate(typeof(MyDelegate), method);
        }
    }

    return function;
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2016-11-13T21:32:51.033

```
public static Delegate CreateDelegate(this MethodInfo methodInfo, object target) {
    Func<Type[], Type> getType;
    var isAction = methodInfo.ReturnType.Equals((typeof(void)));
    var types = methodInfo.GetParameters().Select(p => p.ParameterType);

    if (isAction) {
        getType = Expression.GetActionType;
    }
    else {
        getType = Expression.GetFuncType;
        types = types.Concat(new[] { methodInfo.ReturnType });
    }

    if (methodInfo.IsStatic) {
        return Delegate.CreateDelegate(getType(types.ToArray()), methodInfo);
    }

    return Delegate.CreateDelegate(getType(types.ToArray()), target, methodInfo.Name);
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-06-02T17:01:47.633

您需要调用某种形式的[Delegate.CreateDelegate()](https://docs.microsoft.com/en-us/dotnet/api/system.delegate.createdelegate)，具体取决于所讨论的方法是静态方法还是实例方法。

# active-directory - 将数据库记录与 Active Directory 条目匹配？

> ID：940689
> 
> 赞同：0
> 
> 时间：2009-06-02T17:01:08.023
> 
> 标签：active-directory

我的任务是提出一个解决方案，但我不确定是否有可靠的答案：如何将应用程序数据库中的用户名记录与我们的 Active Directory 中的用户匹配？我有两个需要完成的应用程序 - 第一个应用程序我只有名字和姓氏信息。第二个应用程序我有应用程序的用户名，它类似于 activeD，但不是一个明确的匹配项。我也有名字姓氏信息。

现在，简单地说，我可以编写一个脚本来匹配 ActiveD 中与应用程序数据库中的 firstname lastname 匹配的所有记录，但这充满了错误。开始时没有唯一标识符可能会使这成为一项不可能完成的任务，但在我开始让其他人在运行脚本后手动比较数据之前，我想我会请令人愉快的 StackOverflow 工作人员仔细研究它。毕竟，总有我想不到的方法。

那么有什么绝妙的想法可以完成这项任务吗？

多谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:07:52.930

一旦您自动匹配它们并手动匹配异常，请在 Active Directory 中创建一个自定义属性，您可以在其中存储信息以使它们在未来保持匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T19:07:39.033

嗯，在 AD 中确实独一无二的一件事是`sAMAccountName`针对每个用户。如果您找到一种方法将您的两个数据库中的用户与一个 SAM 帐户名称相关联，那么您应该不再有太大的麻烦来使用 AD 进行自动同步检查。

该属性已在 AD 中可用，您无需添加任何额外的人工 ID，而且它比 GUID 更容易阅读。

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T19:13:37.603

您可以根据数据库记录存储 Active Directory 对象 GUID。

# jpa - JPA NamedQuery 不会获取对已修改实体的更改

> ID：940696
> 
> 赞同：1
> 
> 时间：2009-06-02T17:02:39.443
> 
> 标签：jpa, flush

我有一个使用`NamedQuery`. 我更新每个实体的值，然后运行另一个命名查询（以相同的方法和`Transaction`）过滤旧值，它返回相同的实体，就好像我没有更改它们一样。

我知道`EntityManager`需要刷新并且它应该自动发生，但这没有任何区别。

我启用了休眠 SQL 日志记录，并且可以看到当我调用刷新但容器事务提交时实体*没有更新。*

```
EntityManager entityManager = getPrimaryEntityManager();
MyEntity myEntity = entityManager.find(MyEntityImpl.class, allocationId);
myEntity.setStateId(State.ACTIVE);
// Flush the entity manager to pick up any changes to entity states before we run this query.
entityManager.flush();
Query countQuery = entityManager
        .createNamedQuery("MyEntity.getCountByState");
// we're telling the persistence provider that we want the query to do automatic flushing before this
// particular query is executed.
countQuery.setParameter("stateId", State.CHECKING);
Long count = (Long) countQuery.getSingleResult();
// Count should be zero but isn't. It doesn't see my change above 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:11:55.903

老实说，我对 JPA 不是很熟悉，但是我在使用 Hiberate 的会话管理器时遇到了类似的问题。我的解决方法是在再次查询之前从 Hibernate 的会话中手动删除指定的对象，因此它被迫从数据库中进行查找并且不会从缓存中获取对象。您可以尝试对 JPA 的 EntityManager 执行相同的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-27T09:55:10.850

我刚刚遇到同样的问题并发现了两件事：

*   首先，您应该检查持久性上下文和/或查询的 FlushMode。
*   其次，确保实体管理器是事务管理和查询执行的完全相同的对象。就我而言，我在 entityManager 上有了 Mockito 间谍，这足以破坏事务管理。

# dynamics-crm - 统计机会中的活动

> ID：940702
> 
> 赞同：1
> 
> 时间：2009-06-02T17:03:31.530
> 
> 标签：dynamics-crm, dynamics-crm-4

我有一个机会的工作流程。我正在尝试计算机会工作流程中的活动数量。

并在工作流程中使用此计数条件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T21:36:11.553

我不相信有办法在工作流引擎中本地完成此任务。您必须创建一个自定义工作流活动，为您获取此计数，然后将其返回到工作流，然后您可以在您的条件下使用它。

CodePlex 上的一些自定义活动的示例：http: [//crm4activities.codeplex.com/](http://crm4activities.codeplex.com/)

MSDN 上的自定义工作流活动文档：http: [//msdn.microsoft.com/en-us/library/cc151142.aspx](http://msdn.microsoft.com/en-us/library/cc151142.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-13T00:50:53.070

我同意马特的回答。您需要挂钩自定义工作流活动以获取您当前感兴趣的机会对象，最后在自定义工作流活动中，您可以使用 CRM SDK 查找有关机会的相关活动。

这是设置基本自定义工作流活动的链接：http: [//www.stunnware.com/crm2/topic.aspx?id=CustomWorkflowActivity](http://www.stunnware.com/crm2/topic.aspx?id=CustomWorkflowActivity)

# c++ - 如何以编程方式获取 DLL 或 EXE 文件的版本？

> ID：940707
> 
> 赞同：82
> 
> 时间：2009-06-02T17:04:57.130
> 
> 标签：c++, winapi, dll, version, exe

我需要使用 C 或 C++ 中的 Win32 本机 API 获取 DLL 或 EXE 文件的产品版本和文件版本。我*不是*在寻找 Windows 版本，而是通过右键单击 DLL 文件，选择“属性”，然后查看“详细信息”选项卡所看到的版本号。这通常是一个四部分的虚线版本号 xxxx

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-06-02T17:14:38.820

您将使用[GetFileVersionInfo](http://msdn.microsoft.com/en-us/library/ms647003.aspx) API。

请参阅MSDN 站点上的[使用版本信息。](http://msdn.microsoft.com/en-us/library/ms646985(VS.85).aspx)

样本：

```
DWORD  verHandle = 0;
UINT   size      = 0;
LPBYTE lpBuffer  = NULL;
DWORD  verSize   = GetFileVersionInfoSize( szVersionFile, &verHandle);

if (verSize != NULL)
{
    LPSTR verData = new char[verSize];

    if (GetFileVersionInfo( szVersionFile, verHandle, verSize, verData))
    {
        if (VerQueryValue(verData,"\\",(VOID FAR* FAR*)&lpBuffer,&size))
        {
            if (size)
            {
                VS_FIXEDFILEINFO *verInfo = (VS_FIXEDFILEINFO *)lpBuffer;
                if (verInfo->dwSignature == 0xfeef04bd)
                {

                    // Doesn't matter if you are on 32 bit or 64 bit,
                    // DWORD is always 32 bits, so first two revision numbers
                    // come from dwFileVersionMS, last two come from dwFileVersionLS
                    TRACE( "File Version: %d.%d.%d.%d\n",
                    ( verInfo->dwFileVersionMS >> 16 ) & 0xffff,
                    ( verInfo->dwFileVersionMS >>  0 ) & 0xffff,
                    ( verInfo->dwFileVersionLS >> 16 ) & 0xffff,
                    ( verInfo->dwFileVersionLS >>  0 ) & 0xffff
                    );
                }
            }
        }
    }
    delete[] verData;
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-11-08T13:45:18.020

所有这些解决方案都无法正常工作（使用我的系统）。我发现版本号的四个部分中的每一个都保存为一个 16 位的值。

前两个数字保存在 32 位 DWORD dwFileVersionMS 中，后两个数字保存在 dwFileVersionLS 中。所以我在输出部分编辑了你的代码，如下所示：

```
 TRACE( "File Version: %d.%d.%d.%d\n",
        ( pFileInfo->dwFileVersionMS >> 16 ) & 0xffff,
        ( pFileInfo->dwFileVersionMS >>  0 ) & 0xffff,
        ( pFileInfo->dwFileVersionLS >> 16 ) & 0xffff,
        ( pFileInfo->dwFileVersionLS >>  0 ) & 0xffff
        ); 
```

而且效果很好。输出的格式类似于我的系统：

## major.minor.build.revision

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-06-02T17:22:40.617

[您可以使用版本信息 API](http://msdn.microsoft.com/en-us/library/ms646981.aspx)获取此信息。这是一个示例：

```
void PrintFileVersion( TCHAR *pszFilePath )
{
    DWORD               dwSize              = 0;
    BYTE                *pbVersionInfo      = NULL;
    VS_FIXEDFILEINFO    *pFileInfo          = NULL;
    UINT                puLenFileInfo       = 0;

    // Get the version information for the file requested
    dwSize = GetFileVersionInfoSize( pszFilePath, NULL );
    if ( dwSize == 0 )
    {
        printf( "Error in GetFileVersionInfoSize: %d\n", GetLastError() );
        return;
    }

    pbVersionInfo = new BYTE[ dwSize ];

    if ( !GetFileVersionInfo( pszFilePath, 0, dwSize, pbVersionInfo ) )
    {
        printf( "Error in GetFileVersionInfo: %d\n", GetLastError() );
        delete[] pbVersionInfo;
        return;
    }

    if ( !VerQueryValue( pbVersionInfo, TEXT("\\"), (LPVOID*) &pFileInfo, &puLenFileInfo ) )
    {
        printf( "Error in VerQueryValue: %d\n", GetLastError() );
        delete[] pbVersionInfo;
        return;
    }

    // pFileInfo->dwFileVersionMS is usually zero. However, you should check
    // this if your version numbers seem to be wrong

    printf( "File Version: %d.%d.%d.%d\n",
        ( pFileInfo->dwFileVersionLS >> 24 ) & 0xff,
        ( pFileInfo->dwFileVersionLS >> 16 ) & 0xff,
        ( pFileInfo->dwFileVersionLS >>  8 ) & 0xff,
        ( pFileInfo->dwFileVersionLS >>  0 ) & 0xff
        );

    // pFileInfo->dwProductVersionMS is usually zero. However, you should check
    // this if your version numbers seem to be wrong.

    printf( "Product Version: %d.%d.%d.%d\n",
        ( pFileInfo->dwProductVersionLS >> 24 ) & 0xff,
        ( pFileInfo->dwProductVersionLS >> 16 ) & 0xff,
        ( pFileInfo->dwProductVersionLS >>  8 ) & 0xff,
        ( pFileInfo->dwProductVersionLS >>  0 ) & 0xff
        );
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-02T17:11:45.500

找到这些文章...抱歉，但我没有直接经验如何使用本机 API 执行此操作，所以我推迟到 Internet 搜索：

*   C++：[确定 DLL 或可执行文件的版本号](http://www.codeproject.com/KB/DLL/dllversion.aspx "确定 DLL 或可执行文件的版本号")
*   VB（可能是版本 6）：[如何使用 VERSION.DLL 中的函数](http://support.microsoft.com/kb/139491 "如何使用 VERSION.DLL 中的函数")

希望这些帮助！

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-10-15T14:16:43.460

此代码正确显示文件版本号。

```
( pFileInfo->dwFileVersionMS >> 16 ) & 0xff,
( pFileInfo->dwFileVersionMS >> 0 ) & 0xff,
( pFileInfo->dwFileVersionLS >>  16 ) & 0xff,
( pFileInfo->dwFileVersionLS >>  0 ) & 0xff); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-02T17:15:10.363

最简单的方法是使用[GetFileVersionInfoEx](http://msdn.microsoft.com/en-us/library/aa969434(VS.85).aspx)或[GetFileVersionInfo](http://msdn.microsoft.com/en-us/library/ms647003(VS.85).aspx) API 函数。

您也可以从您的应用程序资源中执行此操作，如此处[所述](http://www.codeproject.com/KB/cpp/GetLocalVersionInfos.aspx)。

# clojure - 在 Clojure 循环中重新定义 let'd 变量

> ID：940712
> 
> 赞同：37
> 
> 时间：2009-06-02T17:05:44.103
> 
> 标签：clojure, let, function

好的。我一直在修补 Clojure，并且不断遇到同样的问题。让我们看一下这段代码：

```
(let [x 128]
  (while (> x 1)
    (do
      (println x)
      (def x (/ x 2))))) 
```

现在我希望这会打印出一个以 128 开头的序列，如下所示：

```
128
64
32
16
8
4
2 
```

相反，它是一个无限循环，一遍又一遍地打印 128。显然我预期的副作用不起作用。

那么我应该如何在这样的循环中重新定义 x 的值呢？我意识到这可能不像 Lisp（我可以使用递归的匿名函数，也许），但如果我不知道如何设置这样的变量，我会发疯的。

我的另一个猜测是使用 set!，但这给出了“无效的分配目标”，因为我不是绑定形式。

请告诉我这应该如何工作。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-06-02T17:47:45.277

`def`定义一个顶级变量，即使您在某些代码的函数或内部循环中使用它。你得到`let`的不是vars。根据[以下文档`let`](https://clojure.org/reference/special_forms#let)：

> **用 let 创建的局部变量不是变量。一旦创造了他们的价值观就永远不会改变！**

（重点不是我的。）您在这里的示例不需要可变状态；你可以使用`loop`and `recur`。

```
(loop [x 128]
  (when (> x 1)
    (println x)
    (recur (/ x 2)))) 
```

如果你想变得花哨，你可以`loop`完全避免显式。

```
(let [xs (take-while #(> % 1) (iterate #(/ % 2) 128))]
  (doseq [x xs] (println x))) 
```

如果您*真的*想使用可变状态，[原子](https://clojure.org/reference/atoms)可能会起作用。

```
(let [x (atom 128)]
  (while (> @x 1)
    (println @x)
    (swap! x #(/ %1 2)))) 
```

（你不需要`do`;`while`将它的主体包裹在一个明确的主体中。）如果你*真的非常*想用[vars](https://clojure.org/reference/vars)做到这一点，你必须做一些像这样可怕的事情。

```
(with-local-vars [x 128]
  (while (> (var-get x) 1)
    (println (var-get x))
    (var-set x (/ (var-get x) 2)))) 
```

但这很丑陋，而且根本不是惯用的 Clojure。要有效地使用 Clojure，您应该尝试停止考虑可变状态。尝试以非函数式风格编写 Clojure 代码肯定会让你发疯。一段时间后，您可能会发现实际上很少需要可变变量，这令人惊喜。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-18T04:23:17.653

Vars（这就是你“定义”某些东西时得到的）并不意味着要重新分配（但可以）：

```
user=> (def k 1)
#'user/k
user=> k
1 
```

没有什么能阻止你这样做：

```
user=> (def k 2)
#'user/k
user=> k
2 
```

如果你想要一个线程本地可设置的“地方”，你可以使用“绑定”和“设置！”：

```
user=> (def j) ; this var is still unbound (no value)
#'user/j
user=> j
java.lang.IllegalStateException: Var user/j is unbound. (NO_SOURCE_FILE:0)
user=> (binding [j 0] j)
0 
```

那么你可以写一个这样的循环：

```
user=> (binding [j 0]
         (while (< j 10)
           (println j)
           (set! j (inc j))))
0
1
2
3
4
5
6
7
8
9
nil 
```

但我认为这是非常单调的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-20T17:02:47.920

如果您认为在纯函数中具有可变局部变量将是一个很好的方便功能，并且不会造成任何伤害，因为该函数仍然是纯函数，您可能会对这个邮件列表讨论感兴趣，其中 Rich Hickey 解释了他从语言中删除它们的原因. [为什么不是可变的本地人？](https://groups.google.com/forum/#!topic/clojure/PCKzXweeDeY)

相关部分：

> 如果局部变量是变量，即可变的，那么闭包可以关闭可变状态，并且考虑到闭包可以逃逸（没有额外的禁止），结果将是线程不安全的。人们肯定会这样做，例如基于闭包的伪对象。结果将是 Clojure 方法中的一个巨大漏洞。
> 
> 如果没有可变的局部变量，人们就不得不使用 recur，一种功能性循环结构。虽然一开始这可能看起来很奇怪，但它就像带有突变的循环一样简洁，并且生成的模式可以在 Clojure 的其他地方重用，即 recur、reduce、alter、commute 等都（逻辑上）非常相似。即使我可以检测并防止变异闭包逃逸，我还是决定保持这种方式以保持一致性。即使在最小的上下文中，非变异循环也比变异循环更容易理解和调试。在任何情况下，Var 都可以在适当的时候使用。

大部分后续帖子都涉及实现`with-local-vars`宏；）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-07-04T22:09:10.697

您可以更惯用地使用`iterate`and`take-while`来代替，

```
user> (->> 128
           (iterate #(/ % 2))
           (take-while (partial < 1)))

(128 64 32 16 8 4 2)
user> 
```

# c# - C# SendKey 到 MS-DOS 应用程序

> ID：940729
> 
> 赞同：2
> 
> 时间：2009-06-02T17:10:35.390
> 
> 标签：c#, legacy

我需要通过 C# 中的 SendKey 来驱动遗留的 DOS 应用程序。但是，我发现它不起作用。

从[http://www.vbforums.com/showthread.php?t=39626](http://www.vbforums.com/showthread.php?t=39626)，我了解到 SendKey 并不真正适用于 MS-DOS 应用程序。调用 SendKey 时，所有 MS-DOS 应用程序接收到的都是“\”。

但是，论坛指向[MSDN 文章 142819](http://support.microsoft.com/kb/q142819/)，该文章利用剪贴板将密钥推送到 MS-DOS 应用程序中。给出了一个 VB 示例，但我不知道如何将其转换为 C#。

任何人都有或知道任何用 C# 编写的类似示例，我可以参考？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T17:27:59.643

您应该改用[keybd_event](http://msdn.microsoft.com/en-us/library/ms646304(VS.85).aspx) ( [pinvoke](http://www.pinvoke.net/default.aspx/user32/keybd_event.html) )。您需要使用[SetForegroundWindow](http://msdn.microsoft.com/en-us/library/ms633539(VS.85).aspx) ( [pinvoke](http://www.pinvoke.net/default.aspx/user32/SetForegroundWindow.html) ) 将控制台窗口设置为前景窗口，然后调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T17:48:53.013

如果我正确理解问题，您可以尝试使用[Process.StandardInput](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardinput.aspx)属性发送密钥。要获取 Process 对象，您可以使用 GetProcessBy... 方法之一。

# jpa - 如何在多个数据库（分布式系统）中保留相同的 JPA 实体？

> ID：940731
> 
> 赞同：4
> 
> 时间：2009-06-02T17:11:04.330
> 
> 标签：jpa, persistence, glassfish, ejb-3.0, toplink

（如何）是否可以在不将所有内容复制到 DTO 的情况下将 JPA 实体保存在多个服务器的数据库中？

我们有一个分布式系统。某些应用程序确实具有用于缓存目的的数据库。JPA 提供程序抛出一个异常，它抱怨它不能持久化一个分离的对象。

但我想保留实体的 ID，只需将其保存在这个额外的数据库中。

（JPA 1.2、EJB 3.0、Glassfish v2.1、Toplink Essentials）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T17:22:24.083

不要 em.persist(obj)，只需 em.merge(obj)。合并适用于附加和分离的对象。

如果您从一个分离的对象开始，我会将该对象与相应的 EntityManager 合并。如果您试图在对象之间保持身份密钥相同，我会从合并的第一个对象中提取密钥，并在将来使用它。

您可能（我不知道）不想做的是尝试将由一个 EM 管理的对象与另一个 EM 合并。你可以测试一下它是否有效，我只是不知道如果你尝试会发生什么。

所以。

```
YourEntity unattachedEntity = ... // your original entity object.

YourEntity managedEntity = em1.merge(unattachedEntity);

// managedEntity now has the primary key assigned by the DB
unattacheEntity.setPrimaryKey(managedEntity.getPrimaryKey());

em2.merge(unattachedEntity);
em3.merge(unattachedEntity); 
```

像这样的东西应该可以正常工作。

# asp.net - Oracle ODP.NET 和双击超链接

> ID：940734
> 
> 赞同：0
> 
> 时间：2009-06-02T17:11:42.957
> 
> 标签：asp.net, session, odp.net, session-state

我已经安装了 ODP.NET，并且正在通过 Oracle 为 ASP.NET 网站使用会话状态服务。我测试了它，我想，非常彻底，没有发现任何重大问题。一些用户在使用系统时一直抱怨异常错误。我添加了一些额外的日志记录，并找出了如何重现该问题。当用户双击超链接时会发生这种情况。我以前从未想过双击超链接，也不知道用户喜欢这样做，所以我没有测试过这种可能性。这会发送 2 个相同的请求以保存具有相同主键的会话项。我将 ODP.NET 11.1.0 用于 .NET 2.0 框架，并且被调用的函数已被 Oracle 混淆，所以我无法在那里修复它。有没有其他人有这个问题？除了告诉用户您不要双击超链接之外，有谁知道解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T17:32:51.980

首先，这听起来像是 Oracle 应该解决的问题。他们的代码应该检查并阻止它。

您可能必须检查您的超链接处理程序以防止重复提交。您可以使用实用程序类作为 Oracle 会话提供程序的包装器，并使用一些`lock`语句来防止重复提交。但是，我会小心-您可能会引入性能问题。

# asp.net - Session 和 HttpContext.Current.Session 的区别

> ID：940742
> 
> 赞同：78
> 
> 时间：2009-06-02T17:14:27.650
> 
> 标签：asp.net

Session 和 HttpContext.Current.Session 对象有什么区别？

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2011-05-16T17:49:11.817

这里有点晚了，但这是我刚刚发现的东西。

@Phillipe Leybaert 和 @CSharpAtl 都不正确。`HttpApplication`的`Session`财产表现出与财产不同的行为`HttpContext.Current.Session`。**如果**一个实例可用，它们都将返回对同一`HttpSessionState`实例的引用。当当前请求没有可用的实例时，它们的作用不同。**`HttpSessionState`**

 **并非所有`HttpHandler`s 都提供会话状态。为此，`HttpHandler` **必须**实现 [一个或两个？] 标记接口`IRequiresSessionState`或`IReadOnlySessionState`.

`HttpContext.Current.Session``null`如果没有可用的会话，则简单地返回。

的属性`HttpApplication`实现`Session`抛出一个`HttpException`带有消息`Session state is not available in this context.`而不是返回一个`null`引用。

一些`HttpHandler`不实现会话的示例是通常静态资源的默认处理程序，例如图像和 CSS 文件。在这种情况下（如在事件处理程序中）对`HttpApplication`'属性的任何引用都将导致被抛出。`Session``global.asax``HttpException`

不用说，意外`HttpException`提供了一个WTF？！如果你不期待它的时刻。

类的`Session`属性`HttpApplication`是这样实现的（来自 Reflector）：

```
[Browsable(false), DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public HttpSessionState Session
{
  get
  {
    HttpSessionState session = null;

    if (this._session != null)
    {
        session = this._session;
    }
    else if (this._context != null)
    {
        session = this._context.Session;
    }

    if (session == null)
    {
        throw new HttpException(SR.GetString("Session_not_available"));
    }

    return session;
  }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-02T17:15:41.890

没有区别。

Page.Session 的 getter 返回上下文会话。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T17:15:47.287

没有什么。`Session`只是指向`HttpContext.Current.Session`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-12-26T21:55:35.213

**在内部，Page.Session 仅指向*它的*HttpContext.Current.Session，但根据调用位置的不同，仍然存在两个差异。**

Page.Session 只能从继承自 System.Web.UI.Page 的类中访问，从 WebMethod 访问时会抛出 HttpException。
只要您在 Web 应用程序的上下文中运行，就可以从任何地方访问 HttpContext.Current.Session。

您可以访问 Page.Session 但不能访问 HttpContext.Current.Session 的其他重要区别：

如果您的页面中有一个名为 GetData 的方法（继承自 System.Web.UI.Page），该方法在与其他线程不同的线程中同时执行page方法，GetData方法可以访问Page.Seession，但是不能访问HttpContext.Current.Session。

这是因为 GetData 是从不同的线程调用的，所以 HttpContext.Current 为空，HttpContext.Current.Session 会抛出空引用异常，但 Page.Session 仍然会附加页面对象，因此页面方法 GetData 可以访问 Page.Session。

# jquery - jquery 选择器——查找根节点的子节点

> ID：940752
> 
> 赞同：9
> 
> 时间：2009-06-02T17:16:21.860
> 
> 标签：jquery, css-selectors

看起来这应该很简单，但我无法弄清楚如何构造一个只返回根节点的直接子元素的选择器。

例如，如果我引用了一个 div (myDiv)，并且我只想选择该 div 的直接子级图像，则以下操作不起作用：

```
jQuery("div > img", myDiv); 
```

选择器中的“div”似乎与上下文的根不匹配，只有后代，并且没有一个可以给我根的选择器，我不能使用“>”。关于如何选择上下文根的直接子级的任何其他想法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-02T17:18:52.590

你不应该重复 div 标签：

```
jQuery("> img",myDiv); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T17:18:56.880

如果 mydiv 是对 jQuery 对象的引用

```
mydiv.children("img") 
```

别的

```
$(mydiv).children("img")
jQuery(mydiv).children("img") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:20:19.420

如果您只想要直系后代，则需要[children](http://docs.jquery.com/Traversing/children#expr)。

```
jQuery(myDiv).children('img') 
```

或者，如果它是一个 jquery 对象......

```
myDiv.children('img') 
```

或者，如果没有，你也可以这样做......

```
jQuery('>img', myDiv) 
```

# .net - 如何从 xml 创建对象集合

> ID：940753
> 
> 赞同：0
> 
> 时间：2009-06-02T17:16:25.010
> 
> 标签：.net, xml, collections, data-collection

我有一个如下的 xml

```
<DataCollection>
  <Data>
    <Name>John</Name>
    <Age>30</Age>
  </Data>
  ... more person
</DataCollection> 
```

我想创建一个以名称、年龄为字段的对象（或某种类型）集合。我遇到的一个问题是我事先不知道结构（我所知道的是，会有 DataCollection 和 Data）来创建一个类，然后使用 linq 来使用 select new。当前的实现，我正在遍历每个数据的 XML，读取元素并创建一个逗号分隔的列表。

有一个更好的方法吗？XML 的目的是在数据网格中显示在数据下传入的所有数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T18:58:15.607

FWIW 这是 LINQ 查询，它将 XML 文档转换为对象集合：

```
 var coll = from XElement c in doc.Descendants("Data") 
       select new { 
           Name = c.Element("Name").Value, 
           Age = int.Parse(c.Element("Age").Value) 
       }; 
```

~~但我认为您真正需要的是一种将 XML 文档直接绑定到 DataGrid 的方法。一种方法是将 DataGrid 绑定到 DataTable 并使用其 WriteXml/ReadXml 方法来读取/写入文件。~~

在预览中......我错过了传入 XML 的结构未知的要求。您可以在不知道数据块结构的情况下使用此 LINQ 构建对象集合的集合：

```
var coll = from XElement c in loaded.Descendants("Data")
       select (from XElement d in c.Elements() select d.Value); 
```

或者您可以使用以下命令生成 CSV：

```
string csv = string.Join(Environment.NewLine, 
( from XElement c in loaded.Descendants("Data") 
  select string.Join(",", 
    (from XElement d in c.Elements() select d.Value).ToArray())
).ToArray()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T17:41:28.860

我希望我能理解你的问题......无论如何 - 假设你使用 asp.net，因为你提到了 Linq，字典是你的最佳选择。

你可以在这里找到更多关于它们的信息：[http://msdn.microsoft.com/en-us/library/xfhwa508.aspx](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)

通常，字典包含键/值对，因此您不必使用逗号并且能够像您应该使用的那样使用循环。

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:36:27.943

如果数据是只读的，您是否考虑过使用 Xslt 将其格式化为 Html 表？

这是我在stackoverflow上找到的[一篇文章，涵盖了这个......](https://stackoverflow.com/questions/88773/flatten-xml-to-html-table-using-xslt)

然后似乎子元素可以更改他们想要的所有内容，但它们仍然会呈现到您的网格（html表）......

# c# - 如何检查 ASP.NET 页面中是否没有或所有文本框都输入了文本？

> ID：940755
> 
> 赞同：2
> 
> 时间：2009-06-02T17:17:31.107
> 
> 标签：c#, asp.net

我正在创建一个发票应用程序，在用户可以输入行项目的部分中，一些字段将包括：数量、价格、扩展价格、描述等。

如果用户在任何字段中输入内容，则需要相应的字段，但如果没有在任何字段中输入数据，则在相应的字段中不需要任何内容​​。在不执行一堆 if 语句的情况下，什么是一种有效且干净的方法？

我想这就像只有一个文本框有文本时进行验证。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T17:30:56.990

您可以在 CustomValidator 的 ServerValidate 事件中尝试类似的操作。

```
// test for all textboxes having some text in them...
e.IsValid = (from TextBox c in this.Controls
             where c is TextBox
             select c).All(tb => !string.IsNullOrEmpty(tb.Text)); 
```

这可能需要一些修补才能正确 - 但你明白了。相应地更改以测试所有文本框是否为空白。

您还可以在 CustomValidator 中使用 jQuery 进行客户端验证

```
function clientValidate(sender, e) {

    // get array of textboxes with a common css class
    var textBoxes = $("#SomeCssSelector input").val();

    // loop here to test for having text or no text.
    e.IsValid = ... ;

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T17:22:59.993

您可以创建一个 TextBox 数组并存储对数组中所有相关文本框的引用。当您需要时，您可以在 for 循环中迭代数组，以查找具有值的第一项。一旦你找到一个值，你就知道该数组中的所有其他项也需要值。

此外，如果您有其他相关文本框组，您可以创建其他数组来帮助将它们分组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:36:24.767

如果这是 ASP.NET，有几种方法。

1.  使用 ASP.NET 中可用的字段验证器。
2.  将 JavaScript 用于 Windows 窗体。

对于 Windows 窗体，还可以使用控件验证器，或者您可以使用传递控件数组的简单函数。如果数组中的任何项目被填充，那么它需要通过返回哪些字段未填充等来填充所有项目。

# php - 使用 PHP exec 命令执行批处理文件的问题

> ID：940756
> 
> 赞同：0
> 
> 时间：2009-06-02T17:17:32.513
> 
> 标签：php, exec, openoffice.org

我试图让 PHP 调用一个批处理文件，该文件将获取一个 RTF 文件并使用 OpenOffice 宏将其转换为 PDF。我已经在命令行上测试了批处理文件，它工作正常，但我没有任何运气从 PHP 调用和使用相同的批处理文件。

我的机器操作系统是 XP Professional SP 3。我正在运行 IIS 6 和 PHP 版本 5.2.9。我已授予互联网用户在 c:\windows\system32\cmd.exe 上的执行权限。我指定了正在执行的批处理文件的完整路径以及要转换的 RTF 文件的完整路径。

PHP 看起来像这样，其中 $arg 是要转换的 RTF：

```
$arg = "C:\\web_root\\whatever\\tempOutput.rtf";
$command = "c:\\windows\\system32\\cmd.exe /c c:\\web_root\\whatever\\convert.bat $arg"; 
```

然后在 try-catch 中调用 exec 命令：

```
exec("$command 2>&1 && exit", $ret, $err); 
```

我在捕获后回显结果：

```
echo "ret: ";
print_r ($ret);
print "<br>";
echo "err is ";
echo $err;
print "<br>";
echo "DONE!"; 
```

这就是我所看到的：

```
ret: Array ( ) 
err is 0
DONE! 
```

RTF 文件没有得到转换，我没有看到错误。关于下一步我可以尝试什么的任何想法？谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:27:36.680

I'm going to bet this is about permissions.

In a typical setup, PHP runs as apache - so you'll want to make sure apache has the rights to execute the batch file.

also, check [this relevant SO question](https://stackoverflow.com/questions/538939), and [this google search](http://www.google.com/search?q=php+execute+shell+command).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T17:29:42.607

Looks like the output array is empty. Is your batch script supposed to have output?

Also, [escapeshellcmd](http://us.php.net/manual/en/function.escapeshellcmd.php) and escapeshellarg should be used

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T17:37:02.470

您是否使用 IIS 作为您的网络服务器？如果是这样，默认情况下 PHP exec 函数将不起作用，您不应规避阻止其运行的安全措施。

检查您的事件查看器，您应该会发现一些与您的问题有关的错误。通过 google 运行查询：IIS PHP exec。这应该为您提供有关该问题的大量信息。

基本上，PHP exec 函数会尝试创建一个新的 cmd.exe 实例。IIS 禁止这样做，因为它可能会在系统中打开一个安全漏洞。

我想出的最佳解决方案是让您的 php 脚本将要执行的命令写入平面文件或创建数据库条目。然后，您将需要编写一个由 Windows 调度程序启动的单独脚本，每隔 10 分钟左右运行一次，以检查您的平面文件或数据库是否有要运行的命令。然后，新脚本将运行命令，然后放置结果或执行确认，以便您的 Web 应用程序稍后能够访问。

这肯定是一团糟。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T17:27:07.273

Is PHP running in safe-mode? If so, shell commands are escaped with [escapeshellcmd](http://se2.php.net/manual/en/function.escapeshellcmd.php). Perhaps this is the problem?

Do you have control of the server running the PHP script?

# coldfusion - ColdFusion 8 作为 JBoss 4.2.3 WEB-INF/flex-config.xml 上的 WAR 错误

> ID：940760
> 
> 赞同：0
> 
> 时间：2009-06-02T17:17:51.310
> 
> 标签：coldfusion, jboss, centos, war, coldfusion-8

我已经多次按本书完成此操作，并且还尝试使用其他人的 WAR 进行部署，但我一直遇到同样的错误。我正在运行 JBoss 4.2.3 并在多个安装（4.2.3）上尝试过这个

我已经验证了假定的丢失文件存在。

```
19:19:15,853 INFO [ContextLoader] Root WebApplicationContext: initialization completed in 54014 ms
19:19:18,172 ERROR [STDERR] javax.servlet.ServletException: The configuration file cound not be found at /WEB-INF/cfform/flex-config.xml
19:19:18,174 ERROR [STDERR] at flex.server.j2ee.cache.CacheFilter.setupFlexService(CacheFilter.java:93) 
```

此错误导致 WAR 无法部署：

```
--- MBeans waiting for other MBeans ---
ObjectName: jboss.web.deployment:war=cfusion.war,id=611163449
State: FAILED
Reason: org.jboss.deployment.DeploymentException: URL file:/jee/workspace/tools/server/default/deploy/cfusion.war/ deployment failed 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-09-25T21:08:15.310

我找到了解决方案。这太疯狂了，但它现在已经工作了两次（至少在 OS X 上）。

将 WEB-INF 目录复制到文件系统根目录。

例如：cp -R ./cfusion.war/WEB-INF /

启动实例。一切正常。

删除新复制的文件系统根目录 /WEB-INF 文件夹。

从现在开始，它将起作用。疯了，但你去。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-08T04:57:22.647

我已经看过这个一百万次了。通常是当我忘记我的战争的 WEB-INF 中的一个文件时。flex-config.xml 在您的 WEB-INF 中吗？

# apache-flex - 弹性散点图？

> ID：940763
> 
> 赞同：0
> 
> 时间：2009-06-02T17:18:18.347
> 
> 标签：apache-flex, charts

有谁知道我可以与 Flex Builder 3 一起使用的好的散点图/图表组件？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T17:21:57.327

好吧，Flex Visualization 的东西有一个散点图：[Plot Charts](http://livedocs.adobe.com/flex/3/html/help.html?content=charts_types_01.html)

还有 Flare，如果您正在寻找免费的开源解决方案：[Flare](http://flare.prefuse.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:20:59.217

PlotCharts 包含在 flex 图表组件中：http: [//www.adobe.com/livedocs/flex/3/html/help.html? content=charts_types_10.html](http://www.adobe.com/livedocs/flex/3/html/help.html?content=charts_types_10.html)

# java - 整数的ArrayList到一个int？

> ID：940766
> 
> 赞同：6
> 
> 时间：2009-06-02T17:19:04.570
> 
> 标签：java, arraylist

将整数的 ArrayList 转换为一个 int 的最简单方法是什么，列表中的第一个整数是 int 中的第一个数字，等等。在 Java 中？

例如整数的 ArrayList：1 4 6 7 8 3 8
变为 int 值 1467838

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-02T17:27:59.393

The simplest way in Java is:

```
int total = 0;
for (Integer i : list) { // assuming list is of type List<Integer>
    total = 10*total + i;
} 
```

For example, if the list consists of 1 4 6 7 8 3 8, you get:

*   `total = 0`
*   `total = 10*0 + 1 = 1`
*   `total = 10*1 + 4 = 14`
*   `total = 10*14 + 6 = 146`
*   `...`
*   `total = 10*146783 + 8 = 1467838`

which is the correct answer.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T17:21:36.190

注意：最简单的并不总是最有效的。这是在 java 中，因为您没有指定语言。但你可以这样做：

```
List<Integer> list = new ArrayList<Integer>();
list.add(1);
list.add(4);
list.add(6);

for (Integer x : list) {
    s += x.toString();
}

Integer finalResult = Integer.parseInt(s); 
```

**编辑**：为了取悦所有在评论中注意到这一点的人，如果你真的担心效率但由于某种原因想要使用这个字符串方法，应该这样做：

```
StringBuilder sb = new StringBuilder();
List<Integer> list = new ArrayList<Integer>();
list.add(1);
list.add(4);
list.add(6);

String s;

for (Integer x : list) {
    sb.append(x.toString());
}

Integer finalResult = Integer.parseInt(sb.toString()); 
```

在第一个示例中，为简单起见没有使用 StringBuilder，因为这看起来像是一项家庭作业。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T17:21:30.730

假设 C#（你没有指定 :-），但一般算法可以在你需要的任何语言中工作：

```
int num = 0;
for( int i = 0 ; i < list.Count ; i++ ) 
{
    num *= 10;
    num += (int)list[i];
} 
```

显然，代码假定生成的数字足够小，可以用 int 表示，并且 ArrayList 中的每个项目都介于 0 和 9 之间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T17:22:14.707

Only handles numbers up to 2 billion or so. Use long, long-long, or your favorite bigint class if you want bigger numbers. Won't work with negative numbers unless they're all negative.

```
int runningtotal = 0;
foreach(int i in myList) {
    runningtotal *= 10;
    runningtotal += i;
}
return runningtotal; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-15T17:59:23.833

另一种解决方案，这将接受大于 9 的数字

```
List<Integer> list = 
int num = Integer.parseInt(list.toString().replaceAll("\\D","")); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T17:22:56.313

```
int result = 0;
for(int i=list.Count - 1;i>=0;--i)
{
  result += list[i] * (int)(Math.Pow((double)10, (double)(list.Count - 1 - i)));
} 
```

Also won't work with negative numbers...you could use Math.Abs() to handle that.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T17:23:17.777

Without knowing which language you want, I think your best approach is to find the sum of 1000000 + 400000 + 60000 + 7000 + 800 + 30 + 8

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T17:26:07.790

I am assuming from your question that index 0 of the ArrayList is the most significant value. Your example show the first number being equivalent to 1,000,000.

You could either treat them as characters then concatenate them then parse back to Integer.

Or you can add each item to the result, then multiply the result by ten to set the magnitudes.

Or you can add each element's value * 10^(count-index); where count is the number of elements in the ArrayList.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-02T17:28:00.503

In Python! Just for fun:

i = int( "".join( [str(z) for z in x] ) )

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-02T17:34:41.227

在哈斯克尔，

```
listToNumber = foldl (\a b -> a*10 + b) 0 
```

在 Python 中，

```
def list_to_number(some_list):
    return reduce(lambda x, y: x*10 + y, some_list, 0) 
```

# asp.net - 在 javascript 文件中使用 ASP.NET 资源字符串

> ID：940769
> 
> 赞同：29
> 
> 时间：2009-06-02T17:20:05.007
> 
> 标签：asp.net, javascript, resources

如何将 resx 资源字符串转换为存储在 .js 文件中的 javascript 代码？

如果您的 javascript 在标记中的脚本块中，则可以使用以下语法：

```
<%$Resources:Resource, FieldName %> 
```

并且它会在呈现页面时解析资源值......不幸的是，只有当 javascript 出现在页面的正文中时才会被解析。在 <script> 标签中引用的外部 .js 文件中，这些服务器标签显然永远不会被解析。

我不想编写一个 ScriptService 来返回这些资源或类似的东西，因为它们在页面呈现后不会改变，所以让某些东西处于活动状态是一种浪费。

一种可能性是编写一个 ashx 处理程序并将 <script> 标记指向该处理程序，但我仍然不确定在将文本流式传输到客户端之前如何读取 .js 文件并解析任何类似的服务器标记。有没有我可以运行的代码行来完成与 ASP.NET 解析器类似的任务？

或者有人有其他建议吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2011-03-25T06:00:51.770

这是我现在的解决方案。我相信我将来需要让它更加通用......但到目前为止这很好。

```
using System.Collections;
using System.Linq;
using System.Resources;
using System.Web.Mvc;
using System.Web.Script.Serialization;

public class ResourcesController : Controller
{
    private static readonly JavaScriptSerializer Serializer = new JavaScriptSerializer();

    public ActionResult GetResourcesJavaScript(string resxFileName)
    {
        var resourceDictionary = new ResXResourceReader(Server.MapPath("~/App_GlobalResources/" + resxFileName + ".resx"))
                            .Cast<DictionaryEntry>()
                            .ToDictionary(entry => entry.Key.ToString(), entry => entry.Value.ToString());
        var json = Serializer.Serialize(resourceDictionary);
        var javaScript = string.Format("window.Resources = window.Resources || {{}}; window.Resources.{0} = {1};", resxFileName, json);

        return JavaScript(javaScript);
    }

}

// In the RegisterRoutes method in Global.asax:
routes.MapRoute("Resources", "resources/{resxFileName}.js", new { controller = "Resources", action = "GetResourcesJavaScript" }); 
```

所以我可以

```
<script src="/resources/Foo.js"></script> 
```

然后我的脚本可以引用例如`window.Resources.Foo.Bar`并获取一个字符串。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-02T18:43:53.920

对此没有本机支持。

不久前，我构建了一个 JavaScriptResourceHandler，它可以通过对象将服务器端资源提供给客户端页面，其中对象上的每个属性都代表一个本地化资源 ID 及其值。您可以查看并从此博客文章中下载它：

[http://www.west-wind.com/Weblog/posts/698097.aspx](http://www.west-wind.com/Weblog/posts/698097.aspx)

我一直在许多应用程序中广泛使用它，并且效果很好。这方面的主要胜利是您可以将资源本地化在一个地方（Resx 或在我的情况下使用数据库的自定义 ResourceProvider），而不必有多个本地化方案。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-01-30T02:03:45.093

而“Common”是资源文件的名称，Msg1 是字段名。这也适用于文化变革。

```
 Partial Javascript...:
            messages: 
            {
                <%=txtRequiredField.UniqueID %>:{                       
                    required: "<%=Resources.Common.Msg1 %>",
                    maxlength: "Only 50 character allowed in required field."
                }
            } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T17:33:07.190

简而言之，让 ASP.NET 为特定页面提供 javascript 而不是 HTML。如果作为自定义 IHttpHandler 完成，则最干净，但在紧要关头，页面也可以，只需记住：

1) 清除所有 ASP.NET 的东西，让它看起来像一个 JS 文件。

2) 在代码隐藏中将内容类型设置为“text/javascript”。

一旦你有了这样的设置脚本，你就可以创建资源的客户端副本，其他客户端脚本可以从你的应用程序中引用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-08T10:25:21.083

如果您将资源放在单独的程序集中，则可以使用`ResourceSet`文件名而不是文件名。在@Domenics 的基础上做出很好的回答：

```
public class ResourcesController : Controller
{
    private static readonly JavaScriptSerializer Serializer = new JavaScriptSerializer();

    public ActionResult GetResourcesJavaScript()
    {
        // This avoids the file path dependency.
        ResourceSet resourceSet = MyResource.ResourceManager.GetResourceSet(CultureInfo.CurrentUICulture, true, true);

        // Create dictionary.
        var resourceDictionary = resourceSet
                        .Cast<DictionaryEntry>()
                        .ToDictionary(entry => entry.Key.ToString(), entry => entry.Value.ToString());
        var json = Serializer.Serialize(resourceDictionary);
        var javaScript = string.Format("window.Resources = window.Resources || {{}}; window.Resources.resources = {1};", json);

        return JavaScript(javaScript);
    }
} 
```

**缺点是每个操作不会启用多个资源文件。这样@Domenics 的答案就更加通用和可重用了。**

您也可以考虑使用`OutputCache`，因为资源在请求之间不会发生太大变化。

```
[OutputCache(Duration = 3600, Location = OutputCacheLocation.ServerAndClient)]
public ActionResult GetResourcesJavaScript()
{ 
    // Logic here...
} 
```

[http://www.asp.net/mvc/overview/older-versions-1/controllers-and-routing/improving-performance-with-output-caching-cs](http://www.asp.net/mvc/overview/older-versions-1/controllers-and-routing/improving-performance-with-output-caching-cs)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T17:22:29.167

我通常将资源字符串作为参数传递给我正在调用的任何 javascript 函数，这样我就可以继续使用 HTML 中的表达式语法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-13T14:42:46.757

在我正在开发的棕色现场应用程序中，我们有一个 xslt，它可以将 resx 文件转换为 javascript 文件，作为构建过程的一部分。这很好用，因为这是一个 Web 应用程序。我不确定原始问题是否是 Web 应用程序。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-16T11:21:26.680

使用隐藏字段来保存资源字符串值，然后在 javascript 中访问字段值，例如：" />

var todayString= $("input[name=TodayString][type=hidden]").val();

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-05-09T19:03:52.473

在 BasePage 类中添加函数：

```
 protected string GetLanguageText(string _key)
    {
        System.Resources.ResourceManager _resourceTemp = new System.Resources.ResourceManager("Resources.Language", System.Reflection.Assembly.Load("App_GlobalResources"));
        return _resourceTemp.GetString(_key);
    } 
```

Javascript：

```
 var _resurceValue = "<%=GetLanguageText("UserName")%>"; 
```

* * *

或直接使用：

```
 var _resurceValue = "<%= Resources.Language.UserName %>"; 
```

注意：语言是我的资源名称。考试：Language.resx 和 Language.en-US.resx

# ruby - 如何使用 FasterCSV 更改 CSV 文件中的标题然后保存新标题？

> ID：940774
> 
> 赞同：3
> 
> 时间：2009-06-02T17:21:16.237
> 
> 标签：ruby, fastercsv

我无法理解 FasterCSV 中的 :header_converters 和 :converters 。基本上，我要做的就是将列标题更改为适当的列名。

就像是：

```
FasterCSV.foreach(csv_file, {:headers => true, :return_headers => false, :header_converters => :symbol, :converters => :all} ) do |row|
    puts row[:some_column_header] # Would be "Some Column Header" in the csv file. 
```

execpt 我不理解转换器参数中的 :symbol 和 :all 。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T17:41:36.037

转换器`:all`意味着它会尝试所有的内置转换器，具体来说：

```
:integer:   Converts any field Integer() accepts.
:float:     Converts any field Float() accepts.
:date:      Converts any field Date::parse() accepts.
:date_time: Converts any field DateTime::parse() accepts. 
```

本质上，这意味着它将尝试将任何字段转换为这些值（如果可能），而不是将它们保留为字符串。因此，如果您这样做`row[i]`并且它会返回字符串值“9”，它将改为返回整数值 9。

标头转换器改变了标头用于索引行的方式。例如，如果做这样的事情：

```
FastCSV.foreach(some_file, :header_converters => :downcase) do |row| 
```

您可以将标题为“Some Header”的列索引为`row['some header']`.

如果你`:symbol`改用它，你会用`row[:some_header]`. 符号将标题名称小写，用下划线替换空格，并删除 az、0-9 和 . 以外的字符`_`。它很有用，因为符号的比较比字符串的比较快得多。

如果要使用 索引列`row['Some Header']`，则不要提供任何`:header_converter`选项。

* * *

## 编辑：

恐怕，对于您的评论， headers_convert 不会做您想做的事。它不会更改标题行的值，只是它们如何用作索引。相反，您必须使用该`:return_headers`选项、检测标题行并进行更改。要更改文件并再次将其写出，您可以使用以下内容：

```
require 'fastercsv'

input = File.open 'original.csv', 'r'
output = File.open 'modified.csv', 'w'
FasterCSV.filter input, output, :headers => true, :write_headers => true, :return_headers => true do |row|
  change_headers(row) if row.header_row?
end
input.close
output.close 
```

如果您需要完全替换原始文件，请在执行上述操作后添加此行：

```
FileUtils.mv 'modified.csv', 'original.csv', :force => true 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-16T15:54:39.407

我找到了解决这个问题的简单方法。FasterCSV 库工作得很好。我敢肯定，从创建帖子到现在大约 7 年的时间可能与它有关，但我认为这里值得注意。

在我看来，在阅读 CSV 文件时，FasterCSV`:header_converters`选项没有得到很好的记录。`header_converters: :symbol`但是，可以分配一个 lambda ( ) ，而不是分配一个符号 ( `header_converters: lambda {...}`)。当 CSV 库读取文件时，它使用 lambda 转换标题。然后，可以保存一个新的 CSV 文件来反映转换后的标题。

例如：

```
options = {
  headers: true,
  header_converters: lambda { |h| HEADER_MAP.keys.include?(h.to_sym) ? HEADER_MAP[h.to_sym] : h }
}

table = CSV.read(FILE_TO_PROCESS, options)

File.open(PROCESSED_FILE, "w") do |file|
  file.write(table.to_csv)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-17T18:54:05.097

重写 CSV 文件标题是任何将导出的 CSV 文件转换为导入的人的常见要求。

我发现以下方法给了我所需的东西：

```
lookup_headers = { "old": "new", "cat": "dog" } # The desired header swaps

CSV($>, headers: true, write_headers: true) do |csv_out|
  CSV.foreach( ARGV[0],
               headers: true, 
               # the following lambda replaces the header if it is found, leaving it if not...
               header_converters: lambda{ |h| lookup_headers[h] || h}, 
               return_headers: true) do |master_row|

    if master_row.header_row?
      # The headers are now correctly replaced by calling the updated headers
      csv_out << master_row.headers
    else
      csv_out << master_row
    end
  end
end 
```

希望这可以帮助！

# python - 使用列表推导和异常？

> ID：940783
> 
> 赞同：4
> 
> 时间：2009-06-02T17:22:34.223
> 
> 标签：python, list, list-comprehension

好的，假设我有一个列表，我想检查该列表是否存在于另一个列表中。我可以这样做：

```
all(value in some_map for value in required_values) 
```

哪个工作正常，但是可以说我想在缺少所需值时引发异常，并且缺少它的值。如何使用列表理解来做到这一点？

我或多或少好奇，所有迹象似乎都指向不。

*编辑*啊，我的意思是：

```
for value in required_values:
 if value not in some_map:
  raise somecustomException(value) 
```

看着那些我看不到如何找到发生错误的值

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T17:33:13.257

> 假设我想在缺少所需值时引发异常，并且缺少该值。我如何使用列表理解来做到这一点？

列表推导式是一种基于现有列表创建列表的语法简洁的方法——它们*不是*`for`在单行中编写任何-loop的通用方法。在此示例中，您实际上并没有创建列表，因此使用列表推导式没有任何意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T17:24:05.530

如果您不想考虑重复并且值是可散列的，请使用集合。它们更容易、更快，并且可以提取单个操作中缺少的“所有”元素：

```
required_values = set('abc') # store this as a set from the beginning
values = set('ab')
missing = required_values - values
if missing:
    raise SomeException('The values %r are not in %r' % 
                        (missing, required_values)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T17:27:55.540

你不能在列表理解中使用 raise。您可以通过查看[Python 语言参考中的语法自行](http://docs.python.org/3.0/reference/expressions.html#comprehensions)检查。

但是，您可以调用一个为您引发异常的函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T18:11:28.717

另一个（丑陋的）可能性是`error_on_false`函数：

```
def error_on_false(value)
    if value:
        return value
    else:
        raise Exception('Wrong value: %r' % value)

if all(error_on_false(value in some_map) for value in required_values):
    continue_code()
    do_something('...') 
```

太丑了 我会`set`改用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-29T01:31:36.073

我想知道今晚的事。我的用例是遍历对象列表并在对象不是特定类型时引发错误。我的解决方案是使用发电机。

```
def iter_my_class(my_class_list):
    for c in my_class_list:
        if not isinstance(c, MyClass):
            raise ValueError('Expected MyClass')
        yield c 
```

然后用作

```
classes = [c for c in iter_my_class(my_class_list)] 
```

这是我在手机上写的。如果运行没有错误，你们都欠我一杯啤酒。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-20T13:07:24.780

你当然可以一起破解一些东西，但它不是特别可读。

`(_ for _ in ())`定义了一个生成器，您可以从中使用该`throw`方法来引发您想要的任何异常。

```
all((_ for _ in ()).throw(somecustomException(value)) for value in required_values if value not in some_map) 
```

也就是说，抛开可读性不谈，除非你真的要使用列表，否则使用列表推导是没有意义的。这可能更有意义，例如：

```
map_values=[some_map[value] if value in some_map else (_ for _ in ()).throw(somecustomException(value)) for value in required_values] 
```

But even then it probably makes more sense to handle the exception outside the loop. If you want to raise a custom exception for some reason you can just catch the KeyError and raise your own exception.

```
try:
    found_values=[some_map[value] for value in required_values]
except KeyError as e:
    raise somecustomException(e.args[0]) 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-06-02T17:54:05.937

虽然我认为使用集合（如 nosklo 的示例）更好，但您可以执行以下简单操作：

```
def has_required(some_map, value):
  if not value in some_map:
    raise RequiredException('Missing required value: %s' % value)

all(has_required(some_map, value) for value in required_values) 
```

# java - ResultSet 中的内存不足 allocLargeObjectOrArray

> ID：940800
> 
> 赞同：1
> 
> 时间：2009-06-02T17:25:26.467
> 
> 标签：java, jdbc, bea

我正在使用 JDBC 来获取大量数据。调用成功完成，但调用时`resultSet.next()`出现以下错误：

```
java.lang.OutOfMemoryError: allocLargeObjectOrArray - Object size: 15414016, Num elements: 7706998 
```

我试图增加 JVM 内存大小，但这并不能解决问题。我不确定这个问题是否可以解决，因为我没有使用 JDBC 访问数据库，而是系统通过 JDBC 访问 BEA AquaLogic 服务。

有没有人遇到这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:36:45.500

请注意，在第一次调用 resultSet.next() 之前，结果可能尚未从数据库中读取，或者仍位于某个地方的另一个缓存结构中。

您应该尝试限制您的 Select 以返回合理数量的结果，并且如果您需要所有数据，则可以重复调用直到没有更多结果。

除非您可以确定 JDBC 调用将返回的数据量存在绝对限制，否则增加 JVM 内存大小将无济于事。

此外，通过 JDBC 访问任何服务本质上归结为使用 JDBC :)

另一种（不太可能）可能是您正在使用的 JDBC 驱动程序中存在错误。如果可能，请尝试不同的实现，并检查问题是否仍然存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-04T04:10:33.953

首先——弄清楚你是否真的需要一次在内存中获取那么多数据。RDBMS 擅长聚合/排序/等大型数据集，如果可能，您应该尝试利用这一点。

如果不是（并且由于某种原因，您确实确实需要工作内存中的那么多数据）...并且提高 JVM 的内存参数并不能提高标准...查看内存中分布式缓存解决方案，例如[Coherence](http://www.oracle.com/technology/products/coherence/index.html) (COTS) 或 TerraCotta（开源）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T20:55:04.010

您可以尝试在语句中设置 setFetchSize(int rows) 方法。
但是 setFetchRows 只是一个提示，这意味着它可能不会被实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T21:05:24.520

尝试将内存大小增加到 1.2g，例如 -mx1200m 或比您机器的物理内存小一些。您可能会发现它一次读取的数据比您想象的要多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-06T10:40:27.723

您从数据库返回多少行？像 kosi2801 我建议只获取数据的一个子集，从一个合理的数字开始，然后增加以找到阈值。

# database - Oracle throwing ORA-16198 on database switch over

> ID：940814
> 
> 赞同：1
> 
> 时间：2009-06-02T17:28:11.000
> 
> 标签：database, oracle

We are trying to do a manual failover of our oracle database servers through enterprise manager and it keeps throwing an ORA-16198 timeout incurred on internal channel during remote archival. How do I go about troubleshooting this problem?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T00:44:15.550

这是生产问题，还是您只是在测试环境中工作？如果它的生产...与 oracle 支持联系。

# python - 将数据传递给 mod_wsgi

> ID：940816
> 
> 赞同：0
> 
> 时间：2009-06-02T17:29:07.630
> 
> 标签：python, mod-wsgi, wsgi

在 mod_wsgi 中，我通过运行函数 start_response() 发送标题，但所有页面内容都通过 yield/return 传递。有没有办法以类似于 start_response() 的方式传递页面内容？在处理分块数据时，使用 return.yield 语句非常严格。

例如

```
def Application():

    b = buffer()

    [... page code ...]

    while True:
        out = b.flush()    
        if out:
            yield out

class buffer:

    def __init__(self):        
        b = ['']
        l = 0

    def add(self, s):
        s = str(s)
        l += len(s)
        b.append(s)

    def flush(self):

        if self.l > 1000:
            out = ''.join(b)
            self.__init__()
            return out 
```

我希望缓冲区在页面加载时输出内容，但仅在内容堆积到一定程度后才输出内容（例如，1000 字节）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T17:31:52.433

不; 但我不认为这是限制性的。也许您想粘贴一个示例代码来描述您的限制，我们可以提供帮助。

要使用块数据，您只需`yield`使用块：

```
def application(environ, start_response):
    start_response('200 OK', [('Content-type', 'text/plain')]
    yield 'Chunk 1\n'    
    yield 'Chunk 2\n'    
    yield 'Chunk 3\n'
    for chunk in chunk_data_generator():
        yield chunk

def chunk_data_generator()
    yield 'Chunk 4\n'
    yield 'Chunk 5\n' 
```

* * *

**编辑**：根据您给出的评论，在发送前将数据堆积到一定长度的示例：

```
BUFFER_SIZE = 10 # 10 bytes for testing. Use something bigger
def application(environ, start_response):
    start_response('200 OK', [('Content-type', 'text/plain')]
    buffer = []
    size = 0
    for chunk in chunk_generator():
        buffer.append(chunk)
        size += len(chunk)
        if size > BUFFER_SIZE:
            for buf in buffer:
                yield buf
            buffer = []
            size = 0

def chunk_data_generator()
    yield 'Chunk 1\n'    
    yield 'Chunk 2\n'    
    yield 'Chunk 3\n'
    yield 'Chunk 4\n'
    yield 'Chunk 5\n' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:19:46.990

您的应用程序*可以*将数据“推送”到 WSGI 服务器：

> 一些现有的应用程序框架 API 以不同于 WSGI 的方式支持无缓冲输出。具体来说，它们提供“写入”函数或某种方法来写入无缓冲的数据块，或者它们提供缓冲的“写入”函数和“刷新”机制来刷新缓冲区。
> 
> 不幸的是，除非使用线程或其他特殊机制，否则此类 API 无法根据 WSGI 的“可迭代”应用程序返回值来实现。
> 
> 因此，为了允许这些框架继续使用命令式 API，WSGI 包含一个特殊`write()`的可调用对象，由可调用对象返回`start_response`。
> 
> 如果可以避免的话，新的 WSGI 应用程序和框架**不应该**使用callable。`write()`
> 
> [http://www.python.org/dev/peps/pep-0333/#the-write-callable](http://www.python.org/dev/peps/pep-0333/#the-write-callable)

但不建议这样做。

> 一般来说，应用程序将通过缓冲其（中等大小的）输出并一次发送所有输出来实现最佳吞吐量。这是现有框架（如 Zope）中的一种常见方法：输出缓冲在 StringIO 或类似对象中，然后与响应标头一起一次性传输。
> 
> WSGI 中的相应方法是让应用程序简单地返回一个包含作为单个字符串的响应主体的单元素可迭代（例如列表）。这是绝大多数应用程序功能的推荐方法，这些功能可以呈现文本很容易放入内存的 HTML 页面。
> 
> [http://www.python.org/dev/peps/pep-0333/#buffering-and-streaming](http://www.python.org/dev/peps/pep-0333/#buffering-and-streaming)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-25T00:13:09.477

如果您不想将 WSGI 应用程序本身更改为在发送响应数据之前对其进行部分缓冲，那么请实现一个 WSGI 中间件来包装您的 WSGI 应用程序并执行该任务。

# c# - .Net FileWatcher 对约 80 多个文件失败

> ID：940819
> 
> 赞同：13
> 
> 时间：2009-06-02T17:30:01.030
> 
> 标签：c#, .net

我正在使用 .net 2.0 filewatcher 来监视文件夹中的新文件。它工作得很好，除非我一次放置超过 80 个文件。该事件不再触发。就好像文件观察器设置为跟踪一定数量的文件。

目前我已经要求用户一次不要放置超过 50 个文件，这似乎可行，但是我想修复它，以便可以一次将数百个文件放入文件夹中。

这是我用于事件的代码。这是很标准的东西，没什么特别的。

```
 FileWatcher = new FileSystemWatcher();
FileWatcher.Path = ConfigurationManager.AppSettings["FolderOfFilesToWatch"];
FileWatcher.NotifyFilter = NotifyFilters.FileName;
FileWatcher.Filter = "*_*_*.*";
FileWatcher.Created += new FileSystemEventHandler(watcher_Created);
FileWatcher.EnableRaisingEvents = true;

static void watcher_Created(object sender, FileSystemEventArgs e)
{
Console.Write(e.Name);
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T17:35:05.640

您可能需要增加 FileSystemWatcher。[内部缓冲区大小](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.internalbuffersize.aspx)。默认情况下，FileSystemWatcher 使用较小的缓冲区来提高性能，如果在短时间内发生太多更改，可能会溢出。

尝试设置更大的缓冲区大小以防止这种情况发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T17:46:22.050

我使用 FileWatcher，但我采用了“腰带和吊带”的方法。每当我收到 FileWatcher 事件时，我都会坚持并检查我以前从未见过的文件（在我的情况下，我有一个文件目录）。相信我，有时您会将数千个文件放入一个文件夹中，并且您必须有另一种保护措施来解决所有这些问题。

您可能会考虑的另一个替代方法是[更改​​日志](http://msdn.microsoft.com/en-us/library/aa363798(VS.85).aspx)，尽管它（AFAIK）仅限于连接到您机器的磁盘，而您也可以使用 FileWatcher 来观察 UNC 路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T17:47:30.800

您可能超出了系统的 ThreadPool 计数。当 FileSystemWatcher 触发事件时，它会从从此池中检索的线程执行此操作。如果您没有为 ThreadPool 分配足够的线程，则可能会丢失这些事件。

[http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx)

正如其他人，尤其是“ocdecio”所指出的，最好不要完全信任 FileSystemWatcher。在重负载下它是出了名的不一致。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T01:36:15.027

信不信由你 CIFS 共享有一些您需要注意的自己的设置。50 显然是大多数文件共享命令计数的默认值（我对此知之甚少，无法知道除了术语之外的任何内容......抱歉）

不管怎样——这个问题一直困扰着我们——幸运的是，我们的存储供应商很友好地让我们了解了这个问题。

看看这里，看看这是否能帮助你克服神奇的 50...

[http://support.microsoft.com/kb/810886](http://support.microsoft.com/kb/810886)

# python - “不匹配”的正则表达式语法？

> ID：940822
> 
> 赞同：99
> 
> 时间：2009-06-02T17:30:50.233
> 
> 标签：python, regex

我有一个大量使用正则表达式的 python 模板引擎。它使用如下连接：

```
re.compile( regexp1 + "|" + regexp2 + "*|" + regexp3 + "+" ) 
```

我可以修改各个子字符串（regexp1、regexp2 等）。

是否有任何不匹配的小而轻的表达式，我可以在不需要任何匹配的模板中使用它？不幸的是，有时 '+' 或 '*' 被附加到正则表达式原子，所以我不能使用空字符串 - 这会引发“没有重复”错误。

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2009-06-02T17:34:15.737

这不应该匹配任何东西：

```
re.compile('$^') 
```

因此，如果您将 regexp1、regexp2 和 regexp3 替换为 '$^'，将无法找到匹配项。除非您使用的是多行模式。

* * *

经过一些测试，我找到了更好的解决方案

```
re.compile('a^') 
```

这是不可能匹配的，并且会比以前的解决方案更早地失败。您可以将 a 替换为任何其他字符，并且始终无法匹配

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-06-02T22:02:15.047

`(?!)`应该总是不匹配。它是零宽度负前瞻。如果括号中的内容匹配，则整个匹配失败。鉴于它没有任何内容，它将使匹配失败（包括任何内容）。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-06-02T17:45:58.870

要匹配一个空字符串 - 即使在多行模式下 - 你可以使用`\A\Z`, 所以：

```
re.compile('\A\Z|\A\Z*|\A\Z+') 
```

不同之处在于`\A`and`\Z`是*字符串*的开始和结束，而`^`和这些可以匹配*行*`$`的开始/结束，因此可能匹配包含换行符的字符串（如果启用了标志）。*`$^|$^*|$^+`*

 *并且无法匹配任何内容（甚至是空字符串），只需尝试在字符串开头之前查找内容，例如：

```
re.compile('.\A|.\A*|.\A+') 
```

由于没有字符可以出现在 \A 之前（根据定义），这将始终无法匹配。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-02T17:34:58.107

也许`'.{0}'`？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-02T17:58:27.663

您可以使用
`\z..`
This is the absolute end of string ，后跟两个任意

如果`+`或`*`最后被附加，这仍然有效，拒绝匹配任何东西

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T21:56:16.450

或者，使用一些列表理解来删除无用的正则表达式条目并加入以将它们放在一起。就像是：

```
re.compile('|'.join([x for x in [regexp1, regexp2, ...] if x != None])) 
```

不过，请务必在该代码行旁边添加一些注释 :-)

# apache-flex - Is it possible to get a custom ItemRenderer to scroll the DataGrid rather than its cell?

> ID：940825
> 
> 赞同：0
> 
> 时间：2009-06-02T17:31:10.843
> 
> 标签：apache-flex, actionscript-3, mxml

I'm having an issue with a custom ItemRenderer I've written for a DataGrid. With this ItemRenderer, it's possible that the contents could exceed the width and height of the DataGrid cell - and when this happens, scroll bars appear, letting me scroll the individual cell.

What I would like, however, is that when the contents of the cell are too large, the entire DataGrid scrolls, rather than the individual cells.

Now, when I set the custom ItemRenderer's horizontal and vertical scroll bar policies to "off", I get the vertical scrolling on the DataGrid that I want (the individual cells stretch to accommodate the full height of the contents) but I don't get any horizontal scrolling. Instead, any content too wide for the cell is clipped. Incidentally, setting the DataGrid's horizontal scroll bar policy to "on" has no effect, the scroll bar gutter is drawn, but nothing scrolls

Is there a way to force the DataGrid to scroll horizontally when my custom ItemRenderer's contents are too wide for the cell?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T17:36:38.010

您可能必须找到一种方法来计算并在画布中水平扩展 DataGrid 的大小，以便它显示所有单元格，并且滚动条将显示为画布的一部分。

# java - constructor problem in java

> ID：940829
> 
> 赞同：0
> 
> 时间：2009-06-02T17:32:29.013
> 
> 标签：java, class

```
public class StateQueryFilter extends FieldQueryFilter {
   // private static final Log LOG = LogFactory.getLog(RecommendedParser.class.getName());

    public StateQueryFilter() {
        super("state", 5f);
        super("city", 5f);
        super("notdirectory", 5f);
        //LOG.info("Added a state query");
    }

} 
```

And it reports:

```
Constructor call must be the first statement in a constructor 
```

Is there a way to make it work?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T17:34:07.077

You can only call `super` once in a constructor, and it must be the first line.

It does not even make sense to call it more than once as you are doing. Calling `super` does not create a new object; it just lets the superclass initialize its fields. Are you really trying to initialize the same fields more than once? You probably are trying to create three separate objects, but that is not the way to do it.

See also [Using the keyword `super`](http://java.sun.com/docs/books/tutorial/java/IandI/super.html) in the Java tutorials.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T17:34:26.220

没有。您尝试构造对象 3 次，逻辑有缺陷。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T17:39:02.797

从[Java 语言规范的第 8.8.7 节](http://java.sun.com/docs/books/jls/third_edition/html/classes.html#8.8.7)：

> 构造函数主体的第一条语句可能是对同一类或直接超类的另一个构造函数的显式调用（第 8.8.7.1 节）。

注意“第一个”声明 - 你不能有多个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T18:44:05.977

我发现调用 setter 的构造函数很丑陋。

另一种选择是有一个接受参数的构造函数。

```
public StateQueryFilter() {
    super(/*state*/ 5, /* city */ 5, /*notdirectory*/ 5);
    //LOG.info("Added a state query");
} 
```

但是看起来你应该做类似的事情

```
public class StateQueryFilter extends FieldQueryFilter {
    private final String city;
    private final String state;
    private final boolean noDirectory;

    public StateQueryFilter(String city, String state, boolean noDirectory) {
        this.state = state;
        this.city = city;
        this.notDirectory = notDirectory;
    }
}
// later
FieldQueryFilter filter = new StateQueryFiler("Los Angeles", "California", true); 
```

顺便说一句：不要使用浮点值，它们几乎从来都不是最佳选择。

# design-patterns - 如何将 log4net 与依赖注入一起使用

> ID：940831
> 
> 赞同：79
> 
> 时间：2009-06-02T17:32:48.593
> 
> 标签：design-patterns, dependency-injection, log4net

我正在尝试通过依赖注入框架找出 log4net 的正确模式和用法。

Log4Net 使用 ILog 接口，但需要我调用

```
LogManager.GetLogger(Reflection.MethodBase.GetCurrentMethod().DeclaringType) 
```

在我需要记录信息的每个类或方法中。这似乎违背了 IoC 原则，并且使我不得不使用 Log4Net。

我应该以某种方式在某处放置另一层抽象吗？

此外，我需要像这样记录当前用户名等自定义属性：

```
log4net.ThreadContext.Properties["userName"] = ApplicationCache.CurrentUserName; 
```

我怎样才能封装它，这样我就不必每次都记得这样做并且仍然保持当前正在记录的方法。我应该做这样的事情还是我完全错过了标记？

```
public static class Logger
{
    public static void LogException(Type declaringType, string message, Exception ex)
    {
        log4net.ThreadContext.Properties["userName"] = ApplicationCache.CurrentUserName;
        ILog log = LogManager.GetLogger(declaringType);
        log.Error(message, ex);
    }
} 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-06-02T17:37:59.663

我想你不是只见树木不见森林。ILog 和 LogManager 是一个轻量级外观，几乎 1:1 等效于 Apache commons-logging，实际上并没有将您的代码耦合到 log4net 的其余部分。

`<rant>`
我还发现，*几乎总是*当有人围绕 log4net 创建 MyCompanyLogger 包装器时，他们会严重忽略这一点，要么失去框架的重要和有用的功能，丢弃有用的信息，甚至失去使用简化的 ILog 接口可能获得的性能提升，或以上所有。换句话说，**包装 log4net 以避免与其耦合是一种反模式**。
`</rant>`

如果您觉得需要注入它，请通过属性使您的记录器实例可访问以启用注入，但以老式方式创建默认实例。

至于在每条日志消息中包含上下文状态，您需要添加一个全局属性，其`ToString()`解析为您要查找的内容。例如，对于当前堆大小：

```
public class TotalMemoryProperty
{
    public override string ToString()
    {
        return GC.GetTotalMemory(false).ToString();
    }
} 
```

然后在启动时将其插入：

```
GlobalContext.Properties["TotalMemory"] = new TotalMemoryProperty(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-12T15:42:10.433

另一种方法是连接 log4net ILog 接口容器注册序列，如下所示：（在下面的 ASP.NET 上下文中使用 Castle 作为示例）

```
container.Register(Component.For<ILog>().LifeStyle
    .PerWebRequest.UsingFactoryMethod(() => LogManager.GetLogger(
    MethodBase.GetCurrentMethod().DeclaringType))); 
```

并且只要你需要它就可以在构造函数中注入 ILog 。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T17:36:30.257

我的做法是创建自己的接口，并让一个类实现使用 Log4Net 的接口，并注入该类。这样，您就不会与 Log4Net 绑定……您可以为新的记录器创建另一个类并注入该类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T17:41:09.143

如果您真的担心拥有多个记录器，您可以随时声明一个全局记录器并调用它来满足您的所有记录需求。这样做的缺点是您失去了识别发出日志的类的内置能力，但您也可以将自己的自定义消息注入日志中以识别类。

这取决于您希望日志记录的健壮程度。您也可以简单地将记录器放在主类中，让所有未处理的异常冒泡到它进行记录。

# scrollbar - 将滚动条添加到 JList

> ID：940838
> 
> 赞同：6
> 
> 时间：2009-06-02T17:33:41.930
> 
> 标签：scrollbar, jlist

我正在尝试将滚动条添加到 JList（它使用自定义数据模型）。添加 JScrollPane 实际上*隐藏*了 JList，而不是添加滚动条。当我使用滚动条运行代码时，JList 不可见，也看不到数据。

```
playlistField = new JList(playlist); // playlist is a data model
playlistField.setLocation(32, 220-36);
playlistField.setSize(350,120);
playlistField.setVisible(true);
this.add(playlistField);

listScrollPane = new JScrollPane(playlistField, JScrollPane.VERTICAL_SCROLLBAR_ALWAYS, JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS); 
```

注释掉 listScrollPane = ... 行使 JList 再次可见并且它按预期工作。

我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T17:44:56.030

您需要将滚动窗格添加到容器，而不是列表。

在您当前的示例中，通过在滚动窗格中添加列表，它会从其原始容器中删除列表，因为组件只能有一个父级。

# smalltalk - Squeak 系统浏览器问题

> ID：940841
> 
> 赞同：4
> 
> 时间：2009-06-02T17:34:25.143
> 
> 标签：smalltalk, squeak

我正在为 OOP/OOD 类使用“Squeak By Example”（SBE）图像（学校修改版本）。但是，我的系统浏览器缺少 SBE 中出现的一些功能。我假设有一些配置选项可以帮我找回它们，但我还找不到它们。

我的问题是：

1) 如何取回按钮？在底部窗格中应该有一堆按钮（浏览、发件人、实施者、版本、...、源）。我的按钮不见了。

2）如何让按钮上方的小工作区出现？顶部窗格下方和按钮上方应该有一个我可以输入的区域，但它没有出现。

提前致谢！

罗伯特

编辑 - 我确实在首选项浏览器中闲逛并尝试了很多设置。我设法让按钮回来，然后又把那个小的（未知名称）工作区窗格拿回来，但我不知道怎么做。我试图再次系统地关闭东西以找出哪些设置控制了什么，但我无法确定是什么控制了这两个问题。所以即使我有它的工作，我希望一些知识渊博的人让我知道如何控制这些，因为它可能会帮助我学习......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T12:30:52.763

“在底部窗格中应该有一堆按钮（浏览，发件人，实施者，版本，...，来源）。” - 在首选项浏览器中打开 optionalButtons 首选项。

“我可以在顶部窗格下方和按钮上方输入的区域，但它没有出现”听起来像注释窗格 - 这为您提供有关您当前正在查看的方法的摘要信息，它由控制annotationPanes 首选项。或者，您可能指的是用于快速导航到其他类和方法的 Mercury 面板；这（当然:-) 由mercuryPanel 偏好控制。

如果您一直在搞乱，您可能还会发现您现在选择了不正确的系统浏览器。Squeak 可以选择可以充当系统浏览器的浏览器。您可以通过单击系统浏览器上的菜单按钮并选择“选择新的默认浏览器”来在它们之间进行选择。打开一个新的浏览器窗口，看看这有什么影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-12T08:17:01.240

您可能还想尝试一个[Pharo 图像](http://pharo-project.org/download)，它默认配置了您想要的所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:39:22.593

您可以访问首选项浏览器吗？它应该在主系统菜单中。您可以通过此浏览器更改各种内容，包括系统浏览器中出现哪些按钮？

# java - 获取方法（），Java

> ID：940844
> 
> 赞同：2
> 
> 时间：2009-06-02T17:34:37.297
> 
> 标签：java, reflection

在 java 中，方法“Class.getMethods()”返回接收者类及其超类中所有方法的数组。有没有像 Class.getMethods() 这样的方法，它只给我们类的方法，而没有从它的超类继承的方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-02T17:36:12.940

[getDeclaredMethods()](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getDeclaredMethods())

# algorithm - 递归算法：建议的模式和实践？

> ID：940850
> 
> 赞同：0
> 
> 时间：2009-06-02T17:35:22.473
> 
> 标签：algorithm, recursion, design-patterns

我正在编写一个反映两个对象图并返回一个值以指示图是否相同的实用程序。这让我开始思考，是否有一种普遍接受的模式来编写递归算法，该算法从递归中的某个位置返回一个值？

我的解决方案可能会使用 ref 参数，看起来像这样的伪代码：

```
public static bool IsChanged(T current, T previous)
{
    bool isChanged = false;           
    CheckChanged(current, previous, ref isChanged);          
    return isChanged ;
}

private static void CheckChanged(T current, T previous, ref isChanged)
{
    //perform recursion
    if (graphIsChanged)
       isChanged = true;
    else
       CheckChanged(current, previous, ref isChanged);
} 
```

有没有更好/更清洁/更有效的方法？这种功能是否有一般模式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T17:44:09.107

与这个非常琐碎的版本相比，我没有看到您的版本有任何好处：

```
public static bool IsChanged(T current, T previous)
{
    //perform recursion
    if (graphIsChanged)
       return true;
    else
       return IsChanged(current, previous);
} 
```

作为一个额外的好处，一些编译器能够使用尾调用优化将这个版本变成一个简单的循环，这样更有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T17:50:34.197

尾递归不仅更有效，它还可以防止您在深度递归中炸毁堆栈： [http ://en.wikipedia.org/wiki/Tail_recursion](http://en.wikipedia.org/wiki/Tail_recursion)

也就是说，它可以防止“堆栈溢出”:)

[http://en.wikipedia.org/wiki/Stack_overflow](http://en.wikipedia.org/wiki/Stack_overflow)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:41:30.843

我一直喜欢从递归函数中获得实际返回值，而不仅仅是传递对变量的引用。我[不确定您要在示例中做什么，但是为什么不从 CheckChanged 返回一个布尔值？

# c# - WCF/LINQ to SQL 中的序列化

> ID：940853
> 
> 赞同：2
> 
> 时间：2009-06-02T17:35:51.973
> 
> 标签：c#, linq, wcf, serialization

我用我需要的表创建了我的 dbml 文件。生成的方法之一就是这样，名称已更改且语法不正确。但是我的代码使用创建的原始方法进行编译。

```
[Association(Name="Clients_ToEmployee", Storage="_ToEmployees", ThisKey="ClientID", OtherKey="ClientID")]
[DataMember(Order=70, EmitDefaultValue=false)]
public EntitySet<ClientToEmployee> ClientToEmployees
{
    get
    {
        if ((this.serializing &&(this._ToEmployees.HasLoadedOrAssignedValues == false)))
        {
            return null;
        }
        return this._ToEmployees;
    }
    set
    {
        this._ToEmployees.Assign(value);
    }
} 
```

当我尝试使用序列化我的结果集时

```
 DataContractSerializer ser =
                new DataContractSerializer(clientObj.GetType());
var memStream = new System.IO.MemoryStream();
ser.WriteObject(memStream ,clientObj);
memStream .Seek(0, System.IO.SeekOrigin.Begin);
var streamReader = new System.IO.StreamReader(memStream );
var xml = streamReader.ReadToEnd(); 
```

看起来像这段代码，见下文，它总是返回 null

```
if ((this.serializing && (this._ToEmployees.HasLoadedOrAssignedValues == false))) 
```

如果我设置一个断点并单步执行代码，那么上面的语句

```
this._ToEmployees.HasLoadedOrAssignedValues 
```

是真的，我得到我的对象而不是返回一个空值。

为什么在我单步执行代码时它的行为正确？我应该引入延迟以便填充 Entityset 对象吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-16T17:23:39.570

我在 WCF 服务中遇到了同样的问题。在我的情况下，在调试时，Linq 有足够的时间延迟加载子记录。当不处于调试模式时，它只是返回父记录。我的大多数方法都很好，但是一个有很多父记录和很多子记录，没有一个子记录成功。所以我把这段代码放在我的 WCF 方法中：

```
DataLoadOptions dlOptions = new DataLoadOptions();
dlOptions.LoadWith<ParentTable>(Parent => Parent.Child);
dc.LoadOptions = dlOptions; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-04T23:53:25.100

```
DataLoadOptions dlOptions = new DataLoadOptions();
dlOptions.LoadWith<ParentTable>(Parent => Parent.Child);
dc.LoadOptions = dlOptions; 
```

有用。

我真的花了很多时间来寻找解决方案......！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:40:28.473

您必须包含更多代码才能让我们确定，但请考虑它告诉您真相的可能性。也许没有。由于某种原因，您可能正在单步执行与在调试器外部执行的代码路径不同的代码路径。我们无法判断，因为您没有发布代码。

我建议您简化场景并重试。

我还建议不要从 Web 服务返回 LINQ to SQL 或 LINQ to Entities 对象。不幸的是，Microsoft 选择在基类中包含依赖于实现的数据，因此它们不能干净地序列化。

# php - 如何使用 PHP 正则表达式匹配所有内容？

> ID：940867
> 
> 赞同：1
> 
> 时间：2009-06-02T17:37:12.847
> 
> 标签：php, regex

如何使用 PHP 正则表达式匹配所有内容？我试过：/[.\r\n]*/，但它不起作用。有任何想法吗？谢谢。

这是我为 PHP 类创建的用于解析电子邮件的方法：

```
public function getHeader($headerName) { 
    preg_match('/[\r\n]' . $headerName . '[:][ ](.+)[\r\n][^ \t]/Uis', "\n" . ltrim($this->originalMessage), $matches); return preg_replace('/[\r\n]*/', '', $matches[1]); 
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T17:41:28.893

`/.*/s`（参见[perl 的文档](http://perldoc.perl.org/perlop.html)）。该`s`选项意味着（引用该 URL）：

> 将字符串视为单行。（使 . 匹配换行符）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T17:43:17.453

我假设，根据您的包含`\n`及`\r`以上内容，您希望*跨*多行进行匹配。在这种情况下，请使用：

`/.*/s`

（请注意显式`/s`修饰符，即更改`.`以匹配任何字符，甚至是换行符，它通常不会匹配。）

请参阅[http://www.perl.com/doc/manual/html/pod/perlre.html](http://www.perl.com/doc/manual/html/pod/perlre.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T16:14:31.750

为什么要匹配所有内容？将它用作条件是没有意义的，因为它总是正确的。如果要捕获文本，则不需要正则表达式，因为您只需使用整个字符串。如果你试图绕过污点检查，那么你会感到羞耻（并提出一个单独的问题来做正确的事）。

请注意，这里有一些[XY 问题](http://www.perlmonks.org/index.pl?node_id=542341)。你有一些任务 X，并认为 Y 是解决方案的一部分。您询问 Y 但从不告诉我们 X。当我们不知道您要做什么时，很难回答您的真正问题。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T22:46:36.457

做`/[\.\r\n]+/`你想做的事吗？

这个kludge以前也为我工作过：

```
my $abstract_text = /Abstract:([\s\S]+?)\nReferences/m; 
```

如果您想捕获包含任意文本的模式或在多个捕获之间进行干预，这将非常有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T17:38:35.370

/.*/s 呢？

在字符类（ [] ）中， . 只是意味着时期。

# javascript - javascript中有没有一种快速的方法来确定祖先节点是否绝对定位而不走整棵树？

> ID：940870
> 
> 赞同：1
> 
> 时间：2009-06-02T17:37:39.460
> 
> 标签：javascript, dom, css

我需要确定 HTML 元素是否嵌套在绝对定位的元素中。(1)*

例如我可以这样做：

```
function hasAbsoluteAncestor(obj){
  while(obj != null){
    if(window.getComputedStyle(obj,null).position == 'absolute'){
      return true;
    } else {
      obj = obj.offsetParent;
    }
  }
  return false;
}
//yes I'm aware IE doesn't play by the W3C game here...  but I have a separate
//IE fix to enable this method in IE
//I'm also aware the above checks the "test" element too (ignore that for now) 
```

但是测试一个罕见的案例似乎相当昂贵。我猜 95% 的时间它将是一个相对元素的树。

是否有任何指示元素嵌套在这样的层次结构中？任何人都知道的任何巧妙的技巧？

***更新：***基于彼得关于过早优化的评论，我改变了我的逻辑以返回坐标以返回 2 对... 1 对 (x,y) 到根，另一对到第一个绝对定位的父级。它仍然“感觉”很脏，但似乎对性能没有任何重大影响。

(1)* 为什么我需要这个？我在测试元素下方添加一个新的绝对定位元素，设置 .left 和 .top 属性...（***如果***）祖先是绝对定位的，是距该祖先的偏移量，而不是距主体/视口的偏移量，因此我需要知道我是否需要将测试元素的位置作为坐标，与身体或特定祖先相关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T17:45:30.633

“看起来”相当昂贵？对我来说，这听起来很像过早的优化。

你知道它很贵吗？你测试过吗？

我实际上愿意打赌它不是非常昂贵。即使在具有非常深节点的非常复杂的 HTML 页面上，我们在这里谈论的是什么 - 30 次迭代？40？

恕我直言，在您需要时进行优化 - 即，当您的测试表明存在问题时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:52:34.193

与对 DOM 做某事的开销相比，我无法想象在祖先树上行走会花费很多时间。

在 jQuery 中，如果我正确理解您的需求，我可能只会比较直接祖先的 position() 和 offset()。不确定这些是如何实现的，但它们利用了一些你不知道的技巧。

# tdd - 哪个社区（语言/框架）最接受敏捷实践？

> ID：940873
> 
> 赞同：1
> 
> 时间：2009-06-02T17:38:05.183
> 
> 标签：tdd, agile, extreme-programming

几年来我一直在练习 TDD 和（一些）XP，并发现它解决了我在采用它之前在我的职业生涯中遇到的许多问题。通过消除如此多的头痛，我对编码的热爱重新焕发了活力。问题是我也发现很难找到利用这些实践的 .NET（我当前的堆栈）项目。

我对 SO 社区的问题是：您认为哪些社区（语言和/或框架）最接受敏捷实践，例如 tdd、（所有 xDD 真的）xp、ci 等？

要问这个问题，必须定义一种测量方法。我将为给定的社区/堆栈将其定义为：

（当前采用敏捷方法的项目数量）/（当前项目数量）

显然，如果没有可能不存在的数据，这是不可能确定的……我只是在寻找人们的看法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T17:53:04.427

如果说社区是关于人的，那么真正的社区是什么，这里有几个群体：

[敏捷项目领导网络](http://apln.org/)在其名称中暗示它包含敏捷方法。

[Alt.Net](http://altdotnet.org/)让我印象深刻，因为您可以带来各种敏捷实践并获得各种结果，因为有些人可能喜欢它们，有些人可能会遇到问题。

不过，敏捷通常更多地是关于过程而不是特定的技术。如果您的问题更多是关于使用敏捷的公司采用哪些技术和框架，那么在我看来，这完全是另一回事，价值值得怀疑。在我附近的阿尔伯塔省卡尔加里，拥抱敏捷的公司可能与其他公司大不相同，例如，印度班加罗尔或英国伦敦或硅谷或纽约市、纽约市或华盛顿州西雅图的公司提供几个地点那里有一些开发人员在工作，通常除非你指的是像[Thoughtworks](http://www.thoughtworks.com/how-we-do-it/)这样的公司，如果你在他们有办公室的大城市附近，他们会做敏捷。

另一种思路是考虑某些技术如何可能具有各种子社区或规模，这些子社区或规模可能会使事情变得混乱。例如，可能有许多 Java 和 .Net 开发人员拥护敏捷，但也有许多人厌恶它。如果一些公司有适合他们的瀑布方法，他们为什么要转向敏捷？同时，某些技术可能拥有非常小的社区，因此可能会以截然不同的方式看待它们。如果您认为这是一个因素，那么使用这些新技术和新兴技术的人的组织程度也很重要。

希望有人发现这个大脑转储很有趣……；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-05T00:57:19.570

我在 Rails 和 Django 营地都有脚趾。从我所见，Rails 的人真的得到了测试。他们在博客中谈论测试，在会议中谈论测试，并衍生出一些有趣的测试工具（例如，ScrewUnit）来测试他们应用程序的非 Rails 部分。成为 Rails 社区的一员而不进行测试真的很难。

The Django community lags behind on the testing front. Django ships with basic support for testing, but you have to look for it. None of current Django books do much more than give testing a footnote, and I rarely see any substantive "how to test" blogs from Django community members. There were no talks on testing at the first DjangoCon.

On the flip side, Rails people are far more likely to get themselves into messes dues to monkeypatching and gem version conflicts (or gems or plugins doing conflicting monkeypatching), so automated testing is essential. The Django projects I've seen have been able to skate by because it's harder to get yourself into the same trouble.

As for other agile practices, it's hard to say without being able to peek inside of a lot of projects on a day-to-day basis.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T17:41:42.200

我不认为这些工作流中的任何一个都与特定语言相关联，我也不认为任何语言都必然适用于这些工作流。任何与此的偏差主要是文化上的。

例如，规范的 rails 项目框架对于编写测试或使用 TDD 的障碍非常低，但没有什么能阻止您使用 NUnit 并编写 TDD .NET 项目。

以下是一些您可能有兴趣研究的 .NET 工具：

单元测试：

*   [单元](http://www.nunit.org/index.php)

持续集成：

*   [团队城市](http://www.jetbrains.com/teamcity/)
*   [巡航控制](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-06T22:57:43.273

根据我有限的经验，我发现 Ruby/rail 社区一直在推动测试的前沿。引入新技术，并将 TDD 和 BDD 的概念普遍集成到大多数事物中。另一方面，PHP 有点随意。一些团体虔诚地使用它，而另一些团体似乎根本不使用它。PHP 中的工具集似乎不如 Ruby 和 Rails 社区中的强大和深入。

YMMV。

# c++ - 扩展现有 API：使用默认参数或包装函数？

> ID：940877
> 
> 赞同：2
> 
> 时间：2009-06-02T17:38:58.007
> 
> 标签：c++, backwards-compatibility

我有一个现有的方法（或一般的函数），我需要增加额外的功能，但我不想在代码的其他地方破坏该方法的任何使用。例子：

```
int foo::bar(int x)
{
 // a whole lot of code here
 return 2 * x + 4;
} 
```

在代码库中被广泛使用。现在我需要将 4 变成一个参数，但是任何已经调用 foo::bar 的代码仍然应该收到它所期望的。我是否应该扩展并重命名旧方法并将其包装成一个新方法，例如

```
int foo::extended_bar(int x, int y)
{
 // ...
 return 2 * x + y;
}

int foo::bar(int x)
{
 return extended_bar(x,4);
} 
```

或者我应该在头文件中声明一个默认参数，比如

```
int bar(int x, int y=4); 
```

并且只是扩展功能

```
int foo::bar(int x, int y)
{
 // ...
 return 2 * x + y;
} 
```

每个变体的优点和缺点是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T17:40:10.360

我通常使用**包装函数**（大部分时间通过重载）而不是默认参数。

原因是*向后兼容*有两个级别：

1.  具有*源级*向后兼容性意味着您必须重新编译调用代码而不进行更改，因为新函数签名与旧函数签名兼容。两者都可以达到这个水平；默认值和包装器/重载。

2.  更强的级别是*二进制级别的*向后兼容性，它甚至可以在不重新编译的情况下工作，例如当您无权访问调用代码时。想象一下，您以二进制形式部署您的函数，例如在 DLL 等中。在这种情况下，签名必须完全相同才能使其工作，而默认值并非如此——它们会破坏这种级别的兼容性.

包装函数的另一个优点是 - 如果您的应用程序有任何类型的日志记录 - 您可以在旧函数中转储一个警告，指出它将在未来版本中过时，并且建议使用新函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:45:48.510

我使用 C++ 的时间越长，我就越不喜欢默认函数参数。我无法确定我不喜欢的任何具体原因，但我发现如果我使用它们，我几乎总是会在以后删除它们。所以我的（主观）投票支持新的命名函数——名称当然可以与旧函数的名称相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:06:40.380

我个人认为，隐性行为是万恶之源（之一）。

任何让维护者或调用者混淆被调用目标的身份的东西都应该有非常充分的理由，尤其是当它是主要 API 的一部分时。

因此，我强烈反对使用默认操作的选项。

此外，我相信如果可以使用不同数量的参数调用某个函数，那么这两个版本的函数在本质上会有所不同，或者它们做得太多。区别可能应该在名称中，并且可能比“_extended”更有意义

# c# - 从 WPF UserControl 访问 ResourceDictionary

> ID：940879
> 
> 赞同：7
> 
> 时间：2009-06-02T17:39:04.387
> 
> 标签：c#, wpf, xaml, resourcedictionary

我正在尝试通过 C# 访问 UserControl 代码隐藏中的资源字典，但收效甚微。

合并字典：

```
<UserControl.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="/Resources/BiometricDictionary.xaml" />                
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</UserControl.Resources> 
```

嵌入式词典：

```
<UserControl.Resources>
    <BitmapImage x:Key="imageDefault">/Resources/Images/default_thumb.png</BitmapImage>
    <BitmapImage x:Key="imageDisconnected">/Resources/Images/disconnect_thumb.png</BitmapImage>
    <BitmapImage x:Key="imageFailed">/Resources/Images/failed_thumb.png</BitmapImage>
    <BitmapImage x:Key="imageSuccess">/Resources/Images/success_thumb.png</BitmapImage>
</UserControl.Resources> 
```

后面的代码：

```
 var resourceDictionary = new ResourceDictionary();
        resourceDictionary.Source = new Uri("/Resources/BiometricDictionary.xaml", UriKind.Relative); 
```

我已经尝试了所有示例和有用的提示，但都不够用。现在，成功将是加载字典的能力。有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T17:45:21.350

要在代码隐藏中访问 UserControl 的 XAML 资源之一，您需要做的就是访问 UserControl 的 Resources 属性。像这样的东西：

```
BitmapImage myImage = (BitmapImage)this.Resources["imageDefault"]; 
```

不过，首选方法是使用 FindResource()，它将搜索整个逻辑树以查找与键的匹配项，而不仅仅是调用它的对象。

```
BitmapImage myImage = (BitmapImage)this.FindResource("imageDefault"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-15T10:17:10.387

尝试删除您所在位置前面的正斜杠。您应该使用 /Resources 的唯一时间是您必须先上图书馆。像../资源

```
<UserControl.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
           <ResourceDictionary Source="Resources/BiometricDictionary.xaml" />                
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</UserControl.Resources> 
```

希望这对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:43:54.193

那么，您在 UserControl 的程序集中定义了一个 ResourceDictionary，并且想从该 UserControl 的代码隐藏中访问它？

你应该能够。但是，如果您列出的代码在构造函数中，您可能无法访问资源字典（可能尚未加载）。尝试将相同的代码添加到您的 UserControl 的“加载”事件中，看看是否有效。如果您只是尝试访问资源，例如样式或模板，那么直接从您的类中使用“ [FindResource](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.findresource.aspx) ”或“ [TryFindResource](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.tryfindresource.aspx) ”函数应该也可以正常工作（即，您不需要类型为“的对象”资源字典”）。

希望有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T18:24:38.477

d'哦...在编译到本地 bin 以便引用是相对的之后，我实现了在此处找到的包 URI 解决方案：[ResourceDictionary in a separate assembly](https://stackoverflow.com/questions/338056/wpf-resource-dictionary-in-a-separate-assembly)，然后 FindResource(x:key value here)。

@PeterAllenWeb，@Pwninstein，感谢您的快速回复并让我重新思考。

# javascript - 如何在服务器上运行 JavaScript

> ID：940880
> 
> 赞同：3
> 
> 时间：2009-06-02T17:39:06.540
> 
> 标签：javascript, iphone

我正在编写一个需要与 Google Maps API 交互的 iPhone 应用程序，因此我必须使用 JavaScript（如果我错了，请纠正我）来访问结果和创建的路线。

由于原生 iPhone 应用程序对 JavaScript 的支持很差而且很慢，所以我的想法是让远程 Web 服务器为我完成这项工作。该服务器将运行 Apache 和 PHP。

所以我的问题是，可以在服务器端运行 JavaScript 吗？如果可能的话，你会怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T17:50:42.433

除了服务器端 Javascript，您还可以通过其他语言的包装器访问 Google Maps API；例如，[这](http://code.google.com/p/pymaps/)是一个为 Python 包装 API 的开源项目（它通过生成和包装所需的 Javascript 来实现）——当然，这可能对您的特定用例有所帮助，也可能没有帮助（但类似的问题也适用于服务器端 JS）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T16:16:35.153

在做了一些研究之后，我发现了 Aptana Jaxer，这是一个开源软件，它允许您在服务器端运行 Ajax、HTML、JavaScript 和 DOM 修改。它可以在： [http ://aptana.com/jaxer](http://aptana.com/jaxer)

在他们的网站上写道：

> HTML、JavaScript 和 CSS 都是 Jaxer 原生的，XMLHttpRequests、JSON 和 DOM 脚本也是如此。作为服务器，它提供对数据库、文件和网络的访问，以及日志记录、流程管理、可扩展性、安全性、集成 API 和可扩展性。

还有一个非常好的截屏视频，可以让您在一分钟内开始：[http ://tv.aptana.com/videos/introduction-to-jaxer-10?ref=search&refId=jaxer](http://tv.aptana.com/videos/introduction-to-jaxer-10?ref=search&refId=jaxer)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T17:41:42.230

您可以在服务器上使用 javascript，有关示例列表，请参阅[此维基百科文章](http://en.wikipedia.org/wiki/Server-side_JavaScript)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T19:55:12.683

[Google Maps API v3](http://googlegeodevelopers.blogspot.com/2009/05/announcing-google-maps-api-v3.html)支持 iPhone Web 应用，iPhone OS 3.0 支持 Google Maps 原生应用。在我写这篇文章的时候，两者都有点前沿而且还不是很完整。

# c# - 如何在 .NET Compact Framework 中获取所有已加载程序集（引用）的编程列表

> ID：940885
> 
> 赞同：5
> 
> 时间：2009-06-02T17:39:39.580
> 
> 标签：c#, .net, compact-framework, assemblies, windows-ce

我在 Windows CE 上运行并使用 Compact Framework。我需要获取我的应用程序已加载的所有参考程序集的列表。如果能够访问这些程序集的 AssemblyName（对象），那就太好了。

一个例子就像让我正在运行的程序集：Assembly.GetExecutingAssembly(); 除了我需要获取对所有其他加载程序集（第 3 方 Dll）的引用。

完整的框架具有[Assembly.GetExecutingAssembly().GetReferencedAssemblies()](https://stackoverflow.com/questions/866487/how-to-retrieve-info-on-a-loaded-assembly-at-runtime-c-net)方法，但它在 Compact Framework 上不可用。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T18:30:31.947

基于[此](http://blogs.msdn.com/robtiffany/archive/2009/04/09/memmaker-for-the-net-compact-framework.aspx)，托管 dll 似乎并没有真正“加载”，因为它们在传统框架中。相反，IL 是内存映射的，而 JIT 只是在执行过程中获取它需要的内容（无需为已执行但不再使用的代码维护大量内存）

这可以解释为什么 CF 没有提供迭代加载的 dll 的方法。至于为什么它不允许迭代**引用的 dll** ，这些 dll是一个完全编译时的构造......

作为一种可能的解决方法：
使用[GetExecutingAssembly](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getexecutingassembly.aspx)获取活动代码。确保这发生在您的可执行文件中，以便它获取根程序集。

为清单编写一些能够解析 dll 的代码，指示哪些程序集被引用（这不需要是托管代码 - 微软提供的非托管自省 API 甚至可以为您执行此操作，并且 dll 格式规范既是公开的，也不可能从根本上改变不久的将来）。我建议从 GAC 加载黑名单 dll（尽管这可能是不必要的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T18:04:38.620

我想如果没有 API 可以做到这一点，你可以试试这个......

请记住，这不是执行此操作的好方法...

1.  在 Windows CE 中查找 PInvoke 调用并调用它们来确定进程加载了哪些 dll。

2.  然后遍历 dll 以检查它们是否具有 CLI 标头。或者您可以尝试将 dll 作为程序集加载，如果加载，则它是应用程序加载的 .NET 程序集。

我知道这样做不是正确的方法，但这可能会奏效。

# .net - ELMAH 与企业库异常处理块

> ID：940888
> 
> 赞同：9
> 
> 时间：2009-06-02T17:39:52.623
> 
> 标签：.net, asp.net, asp.net-mvc, exception-handling, elmah

我的团队目前正在构建一个 ASP.NET MVC 应用程序，我们正在尝试确定要实现哪些框架来处理错误处理和日志记录。

选择其中一个而不是另一个的原因是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T18:10:27.177

就个人而言，我一直在为我们的许多客户使用 Enterprise Library，但我还没有使用 ELMAH。这是我对 Ent Lib 的看法。

*   您需要一点时间来熟悉 Ent Lib - 这不是 5 秒的安装并开始使用它。
*   在 app.config/web.config 文件中有很多配置要做，只是为了让它工作。也就是说，一旦你理解了它，在其他项目上就更容易了。
*   您必须实现日志记录块，而不仅仅是异常处理块以在某处记录信息（事件日志、平面文件、数据库等）
*   它不仅用于记录异常。例如，我们的许多客户希望在用户登录或注销应用程序时获取日志事件。
*   您可以使用配置文件根据环境更改日志记录的工作方式（即记录生产的异常，记录开发的所有内容等）。
*   它不仅适用于网络，还适用于各种应用程序。

对 ELMAH 的粗略一瞥让我相信这是快速完成任务的好方法。从长远来看，您可能想要一些具有额外功能的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T17:47:27.290

ELMAH 简单、易于使用且易于实施。EntLib 是大的、“企业”和强大的。就您而言，根据我对您的情况的了解很少，我会毫不犹豫地推荐任何东西。但是，如果我必须为您选择一个，我会说 ELMAH 出于上述原因。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T18:21:55.033

我可能在这里偏离了基地，这种情况经常发生，但 EntLibrary 旨在帮助开发异常处理，而 ELMAH 只是要向您展示异常发生的时间和地点。如果您只想要异常报告，请使用 ELMAH，如果您需要更多功能 EntLib。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-12-22T14:54:31.423

此外，Elmah 专为捕获和记录**未处理**的异常而设计。它可以配置为记录捕获的异常，但这是最近添加的，并不是它的主要目的。

# ruby-on-rails - 如何创建可配置的 Ruby on Rails 插件？

> ID：940892
> 
> 赞同：1
> 
> 时间：2009-06-02T17:40:22.093
> 
> 标签：ruby-on-rails, ruby, plugins, ruby-on-rails-plugins

我正在尝试创建我的第一个 rails 插件，并且我希望它是可配置的，也就是说，我希望能够在 environment.rb 文件或其他东西中设置一个变量。

更新：我正在尝试做类似这里所做的事情：http: [//soakedandsoaped.com/articles/read/exception-notifier-ruby-on-rails-plugin](http://soakedandsoaped.com/articles/read/exception-notifier-ruby-on-rails-plugin)。我试过模仿他们的代码，但我无法让它工作。

我的插件使用硬编码的值，但到目前为止我为使其可配置所做的一切尝试都没有奏效。

这是一些代码：

```
#vendor/plugin/markup/lib/markup_helper.rb
module MarkupHelper
    def stylesheet_cache_link_tag(*sources)
      cache = assests_cache_dir ? assests_cache_dir : ""
      options = sources.extract_options!.stringify_keys
      cached_name = options.delete("cached_name")
      stylesheet_link_tag(sources, :cache=> File.join(cache, cached_name))
    end

    def javascript_cache_include_tag(*sources)
      cache = assests_cache_dir ? assests_cache_dir : ""
      options = sources.extract_options!.stringify_keys
      cached_name = options.delete("cached_name")
      javascript_include_tag(sources, :cache=> File.join(cache, cached_name))
    end
end

#something like the following in config/environment.rb or probably config/environments/production.rb
MarkupConfig.assests_cache_dir = "cache" 
```

我希望assets_cache_dir 默认为“缓存”，但能够在环境配置文件中设置。我已经用谷歌搜索了很长时间，但找不到任何讨论这个的东西。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T18:45:54.633

```
module MarkupHelper
  mattr_accessor :assets_cache_dir
  self.assets_cache_dir = "cache"

  def assets_cache_dir
    MarkupHelper.assets_cache_dir
  end
end 
```

然后在 environment.rb （或 development.rb/test.rb/production.rb 如果你想为每个环境不同的值）：

```
MarkupHelper.assets_cache_dir = "my-value" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T22:08:12.027

虽然 tomafro 使用的方法很容易使用，但另一种方法是使用 database.yml 样式的配置文件，可以根据环境进行拆分：

> ```
> 模块 MyPlugin
>   类配置
>     # == 常量 ================================================ =============
> 
>     配置文件 = [
>       "#{RAILS_ROOT}/config/myplugin.yml",
>       “#{RAILS_ROOT}/config/myplugin.yaml”
>     ]。冻结
> 
>     DEFAULT_CONFIGURATION = {
>       :url => DEFAULT_HOSTNAME
>     }。冻结
> 
>     # == 类方法 ============================================== =========
> 
>     # :nodoc:
>     def self.config_file_found
>       CONFIG_FILES.find 做|路径|
>         文件存在吗？（路径）
>       结尾
>     结尾
> 
>     # 返回配置文件的默认路径
>     def self.default_path
>       config_file_found 或 CONFIG_FILES.first
>     结尾
> 
>     # == 实例方法 ============================================== ======
> 
>     # 通过读取创建一个新的 MyPlugin::Configuration 实例
>     # 配置文件。
>     # +env+ 要加载的 Rails 环境
>     定义初始化（环境）
>       config_file = self.class.config_file_found
> 
>       @env_config = DEFAULT_CONFIGURATION
> 
>       if (@config = (config_file and YAML.load(File.open(config_file))))
>         [ @config['defaults'], @config[env] ].each 做 |options|
>           如果（选项）
>             @env_config = @env_config.merge(options.symbolize_keys)
>           结尾
>         结尾
>       结尾
>     结尾
> 
>     # 如果找到并加载了配置文件，将返回 +true+，或者
>     # +false+ 否则。
>     def 存在吗？
>       @env_config != DEFAULT_CONFIGURATION
>     结尾
> 
>     # 返回一个特定的配置选项。
>     def []（键）
>       @env_config[key.to_sym]
>     结尾
>   结尾
> 
>   def self.config
>     @config ||= Configuration.new(Rails.env)
>   结尾
> 结尾
> 
> ```

您可以将其用作：

> ```
> 设置 = MyPlugin.config[:param_name]
> 
> ```

您还可以编写实用程序方法来获取特定值，或使用 OpenStruct 代替配置哈希。这仅作为另一种设计模式的示例发布。

# c++ - Lua 比 C/C++ 更适合的示例用法

> ID：940896
> 
> 赞同：17
> 
> 时间：2009-06-02T17:41:25.553
> 
> 标签：c++, c, lua

我目前正在嵌入 Lua 并将其用作美化的智能配置文件。然而，我认为我错过了一些东西，因为人们对 Lua 的使用赞不绝口。

例如，通过展示这个例子，我可以很容易地解释为什么你可以使用 shell 脚本而不是 C（诚然，boost regexp 是多余的）：

```
#include <dirent.h> 
#include <stdio.h> 
#include <boost/regex.hpp>

int main(int argc, char * argv[]) {
    DIR           *d;
    struct dirent *dir;
    boost::regex re(".*\\.cpp$");
    if (argc==2) d = opendir(argv[1]); else d = opendir(".");
if (d) {
    while ((dir = readdir(d)) != NULL) {
            if (boost::regex_match(dir->d_name, re)) printf("%s\n", dir->d_name);
    }

    closedir(d);
}

return(0); 
```

并将其与：

```
for foo in *.cpp; do echo $foo; done; 
```

您可以在 Lua 中提供任何可以让我“点击”的示例吗？

编辑：也许我的问题是我对 Lua 的了解还不够好，还不能流利地使用它，因为我发现编写 C 代码更容易。

编辑2：

一个例子是 C++ 和 Lua 中的一个玩具阶乘程序：

```
#include <iostream>

int fact (int n){
    if (n==0) return 1; else
    return (n*fact(n-1));
}

int main (){
    int input;
    using namespace std;
    cout << "Enter a number: " ;
    cin >> input;
    cout << "factorial: " << fact(input) << endl;
    return 0;
} 
```

卢阿：

```
function fact (n)
    if n==0 then
        return 1
    else 
        return n * (fact(n-1))
    end
end

print ("enter a number")
a = io.read("*number")
print ("Factorial: ",fact(a)) 
```

在这里，这些程序看起来很相似，但在 include、namespace 和 main() 声明中显然有些杂乱无章，您可以摆脱它。还要删除变量声明和强类型。

现在人们是说这是一个更大的程序的优势，还是有更多的优势？这与 bash 示例不同。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-02T17:45:27.670

使用像 Lua 这样的脚本语言还有很多其他的好处。

Lua 与 C++ 相比有几个优点：

*   由于高级特性，开发时间通常更短，如您的示例所示。
*   它不需要重新编译来改变行为。
*   可以在非开发机器上更改行为。
*   原型制作非常快速和简单，因为您可以在运行时调整逻辑。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-05T01:13:20.290

脚本语言减少了构建复杂 GUI 所需的工作量，否则需要大量的框架粘合和代码重复。Lua 绑定提供了几个 GUI 工具包，包括[wxWidgets](http://wxlua.sourceforge.net/)和[IUP 工具包](http://www.tecgraf.puc-rio.br/iup/)。

在这两种绑定中，一流的函数值和完整的闭包使事件回调易于编码和使用。

以 Lua 为核心的大型应用程序（例如 Adob​​e Photoshop Lightroom）有一个外部 C/C++ 程序，该程序托管 Lua 解释器并通过向该解释器注册 C 函数来提供对其核心功能的访问。它通常在 C 函数中实现计算密集型核心功能，但将整体流程、操作甚至 GUI 布局留给 Lua 脚本。

我在自己的项目中发现，当与在运行时加载的 IUP 以及一个或两个自定义 DLL 结合使用时，通常的独立 Lua 解释器（lua.exe 或 wlua.exe）对于外部应用程序来说已经足够了——基于 Lua 模块，用 C 编码，实现需要该级别性能的功能，或通过其他 C 可调用库实现的功能。

我的项目的要点包括：

*   真正的尾调用允许简单地表达有限状态机。
*   垃圾收集内存管理。
*   匿名函数、闭包、第一类函数值。
*   哈希表。
*   足够丰富的字符串库。
*   Userdata 将垃圾收集器扩展到 C 端分配。
*   元表允许丰富多样的面向对象和函数式技术。
*   小但足够强大的 C API。
*   良好的[文档](http://www.lua.org/docs.html)，以开源作为备份。
*   [通过邮件列表](http://www.lua.org/lua-l.html)和[wiki](http://lua-users.org/wiki/)提供良好的用户对用户支持。
*   强大的模块，例如作者和[社区提供的](http://luaforge.net/)[PEG](http://www.inf.puc-rio.br/%7Eroberto/lpeg.html)解析器。

我最喜欢引用的例子之一是我为嵌入式系统构建的测试夹具，它需要大约 1000 行 Lua 和 1000 行 C，在 lua.exe 下运行，并使用 IUP 呈现完整的 Windows GUI。第一个版本大约在一天内运行。在带有 MFC 的 C++ 中，这至少需要一周的工作，以及数千行代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T17:46:13.923

尝试用 C/C++ 实现一个 Lua 表，你就会看到 Lua 的强大之处。

在 Lua 中：

```
a["index"] = "value" 
```

在 C 语言中，首先阅读链表...

C++ STL 可能会有所帮助，但它会比 Lua 更冗长。

**此外**，Lua 可以制作很好的胶水。与 C 接口非常容易（恕我直言）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T17:47:45.217

我不知道我是否会为您“点击”，但我会尝试。

嵌入 Lua 的优点之一是，您不仅可以将其用作配置文件，而且实际上可以为 lua 提供 C/C++ 接口，并通过 Lua 脚本语言“编写”它们的使用。

如果您想更改应用程序的行为/逻辑，您只需更改 Lua 脚本中的代码，而无需重新编译整个应用程序。

突出的用途是游戏逻辑，如 AI 或状态机，从更改到游戏的快速往返时间对于开发游戏至关重要。

当然，主要逻辑必须出现在 Lua 脚本中，而不是 C/C++ 代码中，才能有效使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T19:37:43.857

仅用 C 语言编程可能是一项非常乏味和冗余的任务，与更抽象的高级语言相比，这当然适用。

从这个意义上说，你可以比直接在 C 中做任何事情更快地开始和完成事情，这是因为许多需要在 C 中显式地手动设置、完成和清理的事情通常由隐式自动处理诸如 Lua 之类的脚本语言（例如想象内存管理）。

类似地，更多抽象的数据结构和算法通常由此类高级语言直接提供，因此如果您只需要一个标准容器（想想链表，树，地图等）。

因此，当使用相当抽象的脚本语言（例如 Lua 甚至 Python）时，您可以获得相当好的投资回报率，特别是如果相应的语言带有良好的核心功能库。

因此，脚本实际上是理想的想法和项目原型，因为那时您需要能够专注于您的工作，而不是大多数项目可能相同的所有机械冗余。

一旦你完成了一个基本的原型，你总是可以看到如何进一步改进和优化它，可能是在 C 空间中重新实现基本的关键功能，以提高运行时性能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-07-09T20:46:48.730

LUA 有[闭包](http://www.lua.org/pil/6.1.html)，而闭包很摇滚。例如：[_](http://www.lua.org/pil/6.1.html)

```
function newCounter ()
  local i = 0
  return function ()   -- anonymous function
           i = i + 1
           return i
         end
end

c1 = newCounter()
print(c1())  --> 1
print(c1())  --> 2 
```

您可以创建一个函数并传递它。有时它比创建单独的类并实例化它更方便。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T18:10:07.097

For an example of where Lua fits better then c++ look at distributing scripts. [Mush Client](http://mushclient.com/scripts/function.php) offers Lua as a scripting language. As shown by the link above you can do a lot with Lua to extend the program. Unlike C++ though Lua doesn't have to be compiled and can be restricted. For example you can sandbox Lua so it can't access the file system. This means that if you get a script from someone else it is incapable of destroying your data since it can't write to the disk.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-05-07T12:13:47.177

我使用一个名为 Love2D 的游戏引擎，它使用 Lua 编写游戏。所有的系统调用和繁重的工作都是在一个读取 Lua 脚本的 C 程序中完成的。

用 C 或 C++ 编写游戏时，您会发现自己在尝试处理系统的微妙之处，而不仅仅是实现您的想法。

Lua 允许“干净”的脏样式编码。

下面是一个用纯 lua 编写的游戏对象的示例：

```
local GameObj = {}              -- {} is an empty table
GameObj.position = {x=0,y=0}
GameObj.components = {}

function GameObject:update()
    for i,v in ipairs(self.components) do    -- For each component...
        v:update(self)                       -- call the update method
    end
end 
```

实例化：

```
myObj = setmetatable({},{__index=GameObj})
-- tables can have a meta table which define certain behaviours
-- __index defines a table that is referred to when the table
-- itself doesn't have the requested index 
```

让我们定义一个组件，键盘控制呢？假设我们有一个为我们输入的对象（将由 C 端提供）

```
KeyBoardControl = {}
function KeyBoardControl:update(caller)
    -- assuming "Input", an object that has a isKeyDown function that returns
    -- a boolean
    if Input.isKeyDown("left") then
        caller.position.x = caller.position.x-1
    end
    if Input.isKeyDown("right") then
        caller.position.x = caller.position.x+1
    end
    if Input.isKeyDown("up") then
        caller.position.y = caller.position.y-1
    end
    if Input.isKeyDown("down") then
        caller.position.y = caller.position.y+1
    end
end
--Instantiate a new KeyboardControl and add it to our components
table.insert(myObj.components,setmetatable({},{__index=KeyboardControl}) 
```

现在，当我们调用 myObj:update() 时，它将检查输入并移动它

假设我们将使用大量带有 KeyboardControl 的 GameObj，我们可以实例化一个原型 KeyObj 并像继承对象一样使用它：

```
KeyObj = setmetatable( {}, {__index = GameObj} )
table.insert(KeyObj.components,setmetatable( {}, {__index = KeyboardControl} )    

myKeyObjs = {}

for i=1,10 do
    myKeyObjs[i] = setmetatable( {}, {__index = KeyObj} )
end 
```

现在我们有了一个可以玩的 KeyObj 表。在这里，我们可以看到 Lua 如何为我们提供了一个强大、易于扩展、灵活的对象系统，它允许我们根据我们试图解决的问题来构建我们的程序，而不是必须弯曲问题以适应我们的语言.

此外，Lua 还有一些不错的其他特性，比如函数作为一等类型，允许 lambda 编程、匿名函数和其他通常让 comp-sci 老师笑得令人毛骨悚然的东西。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-04T03:45:10.943

Lua 作为编程语言的主要优点（除了可嵌入性）是

*   强大、高效的哈希表作为主要数据结构
*   字符串处理库，在复杂性和表现力之间取得了出色的平衡
*   一流的函数和通用`for`循环
*   自动内存管理！！

很难找到一个简短的例子来说明所有这些。我的`~/bin`目录中有 191 个 Lua 脚本；这是一个输出`pstotext`并连接以连字符结尾的行：

```
local function  printf(...) return io.stdout:write(string.format(...)) end
local function eprintf(...) return io.stderr:write(string.format(...)) end

local strfind, strlen = string.find, string.len

function joined_lines(f)
  return coroutine.wrap(function()
                          local s = ''
                          for l in f:lines() do
                            s = s .. l
                            local n = strlen(s)
                            if strfind(s, '[%-\173]$', n-1) then
                              s = string.sub(s, 1, n-1)
                            else
                              coroutine.yield(s)
                              s = ''
                            end
                          end
                        end)
end

-- printf('hyphen is %q; index is %d\n', '­', string.byte('­'))

for _, f in ipairs(arg) do
  for l in joined_lines(io.popen('pstotext ' .. f, 'r')) do
    printf('%s\n', l)
  end
end 
```

这个例子展示了几个优点，但对表格没有任何意义。

下面是 Key Word In Context 索引程序的一个简短片段，它从表中获取上下文并在上下文中格式化关键字。这个例子更广泛地使用了嵌套函数，并展示了更多的表格和字符串内容：

```
local function showpos(word, pos, lw, start)
  -- word is the key word in which the search string occurs
  -- pos is its position in the document
  -- lw is the width of the context around the word
  -- start is the position of the search string within the word
  local shift = (start or 1) - 1  -- number of cols to shift word to align keys
  lw = lw - shift -- 'left width'
  local rw = cols - 20 - 3 - lw - string.len(words[pos])  -- right width
  local data = assert(map:lookup(pos)[1], "no map info for position")
     -- data == source of this word
  local function range(lo, hi)
    -- return words in the range lo..hi, but only in the current section
    if lo < data.lo then lo = data.lo end
    if hi > data.hi then hi = data.hi end
    local t = { }
    for i = lo, hi-1 do table.insert(t, words[i]) end
    return table.concat(t, ' ')
  end
  -- grab words on left and right, 
  -- then format and print as many as we have room for
  local left  = range(pos-width, pos)
  local right = range(pos+1, pos+1+width)
  local fmt = string.format('[%%-18.18s] %%%d.%ds %%s %%-%d.%ds\n', 
                            lw, lw, rw, rw)
  printf(fmt, data.title, string.sub(left, -lw), word, right)
end 
```

# http - Can I read the hash portion of the URL on my server-side application (PHP, Ruby, Python, etc.)?

> ID：940905
> 
> 赞同：226
> 
> 时间：2009-06-02T17:41:55.897
> 
> 标签：http, language-agnostic, uri-fragment

Assuming a URL of:

```
www.example.com/?val=1#part2 
```

PHP can read the request variables `val1` using the GET array.

Is the hash value `part2` also readable? Or is this only upto the browser and JavaScript?

* * *

## 回答 #1

> 赞同：210
> 
> 时间：2009-06-02T17:45:22.600

The main problem is that the browser won't even send a request with a fragment part. The fragment part is resolved right there in the browser. So it's reachable through JavaScript.

Anyway, you could parse a URL into bits, including the fragment part, using [parse_url()](http://www.php.net/manual/en/function.parse-url.php), but it's obviously not your case.

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2009-06-02T17:57:05.980

Simple test, accessing [http://localhost:8000/hello?foo=bar#this-is-not-sent-to-server](http://localhost:8000/hello?foo=bar#this-is-not-sent-to-server)

```
python -c "import SimpleHTTPServer;SimpleHTTPServer.test()"
Serving HTTP on 0.0.0.0 port 8000 ...
localhost - - [02/Jun/2009 12:48:47] code 404, message File not found
localhost - - [02/Jun/2009 12:48:47] "GET /hello?foo=bar HTTP/1.1" 404 - 
```

The server receives the request without the #appendage - anything after the hash tag is simply an anchor lookup on the client.

You can find the anchor name used within the URL via javascript using, as an example:

```
<script>alert(window.location.hash);</script> 
```

The parse_url() function in PHP can work if you already have the needed URL string including the fragment ([http://codepad.org/BDqjtXix](http://codepad.org/BDqjtXix)):

```
<?
echo parse_url("http://foo?bar#fizzbuzz",PHP_URL_FRAGMENT);
?>

Output: fizzbuzz 
```

But I don't think PHP receives the fragment information because it's client-only.

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2009-06-02T17:53:26.813

It is retrievable from Javascript - as `window.location.hash`. From there you could send it to the server with Ajax for example, or encode it and put it into URLs which can then be passed through to the server-side.

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-06-02T17:44:22.070

The hash is never sent to the server, so no.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-06-29T13:06:03.523

The answer is no.

The main purpose of the hash is to scroll to a certain part of the page where you have defined a bookmark. e.g. Scroll to this Part when page loads.

The browse will scroll such that this line is the first visible content in the page, depending on how much content follows below the line.

Yes javascript can acces it, and then a simple ajax call will do the magic

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-08-06T02:16:33.723

What about:

**Dynamically grab the #hash**

```
<script>
var urlhash = window.location.hash, //get the hash from url
    txthash = urlhash.replace("#", ""); //remove the #
    //alert(txthash);
</script>

<?php
$hash = "<script>document.writeln(txthash);</script>";
echo $hash;
?> 
```

To make it more fluent:

**Full Example using just Javascript and PHP**

```
<script>
var urlhash = window.location.hash,  //get the hash from url
txthash = urlhash.replace("#", "");  //remove the #

function changehash(a,b){
   window.location.hash = b; //add hash to url
   //alert(b); //alert to test
   location.reload(); //reload page to show the current hash
}
</script>

<?php $hash = "<script>document.writeln(txthash);</script>";?>

<a onclick="changehash(this,'#hash1')" style="text-decoration: underline;cursor: pointer;" >Change to #hash1</a><br/>
<a onclick="changehash(this,'#hash2')" style="text-decoration: underline;cursor: pointer;">Change to #hash2</a><br/> 

<?php echo "This is the current hash: " . $hash; ?> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-02T17:47:04.717

I think the hash-value is only used client-side, so you can't get it with php.

you could redirect it with javascript to php though.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-12-27T18:15:44.207

Th part of an [URI](https://www.rfc-editor.org/rfc/rfc3986) after the `#` is called "fragment" and is by definition only available/processed on client side (see [https://en.wikipedia.org/wiki/Fragment_identifier](https://en.wikipedia.org/wiki/Fragment_identifier)).

On the client side, this can be accessed using javaScript with `window.location.hash`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-07-17T05:11:39.690

```
<?php
$url=parse_url("http://domain.com/site/gallery/1?user=12#photo45 ");
echo $url["fragment"]; //This variable contains the fragment
?> 
```

This is should work

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-03-07T03:21:20.267

Yes you can:

Use this method to prevent errors:

```
<script> 
query=location.hash;
document.cookie= 'anchor'+query;
</script> 
```

And of course in PHP, explode that puppy and get one of the values

```
$split = explode('/', $_COOKIE['anchor']);
print_r($split[1]); //to test it, use print_r. this line will print the value after the anchortag 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-05-15T04:07:52.070

We can do it with another approach too, Like first of all get the hash value from js and call the ajax using that parameter and can do whatever we want

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-03-30T13:24:15.773

Another solution is to add a hidden input field to the php page:

```
<input type="hidden" id="myHiddenLocationHash" name="myHiddenLocationHash" value=""> 
```

Using javascript/jQuery you can set the value of this field on the page load or responding to an event :

```
$('#myHiddenLocationHash').val(document.location.hash.replace('#','')); 
```

In php on the server side you can read this value using the $_POST collection:

```
$server_location_hash = $_POST['myHiddenLocationHash']; 
```

# javascript - 获取 URL 的最终/定时呈现

> ID：940907
> 
> 赞同：0
> 
> 时间：2009-06-02T17:42:07.423
> 
> 标签：javascript, html, rendering

我正在寻找一种方法来提供 URL，在 JavaScript 运行后获取网页的源代码。例如：

我有一个带有 . 在加载页面时，一些 JavaScript 会填充 div。通过浏览器查看页面的源代码不会给出 div 中的信息。

据我所知，为了让浏览器渲染页面，div必须已经填充了（X|D）HTML，这意味着渲染后页面的源仍然只是嵌套标记，所以理论上应该是页面源的“最终”版本。

我考虑过使用像 WebKit 或 Gecko 这样的渲染引擎，并以某种方式调整它们来做到这一点，但是这是一项相当大的任务，我真的不想复制已经完成的事情。有谁知道执行此任务的方法。

问候。

更新：我的目标是使用 Selenium（如对已接受答案的评论中所述）自动执行几页。我的项目是一个网络蜘蛛，它的设计需要针对许多页面，在这些页面中，我要访问的内容在 JavaScript 填充所有内容之前不可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:58:34.700

诸如[WebDev 工具栏](https://addons.mozilla.org/en-US/firefox/addon/60)或[Firebug](http://getfirebug.com/)之类的 Firefox 插件具有“查看生成的源代码”之类的选项。

就时间而言，您唯一的选择就是拥有一段 javascript 代码。您可以在页面加载时尽快设置开始时间，并在页面完成时再次检查（dom-ready 或页面完全下载）。但是，它将是高度可变的，并且如果您尝试对其进行计时以提高速度（这是很好的知道和做的） - 只是让 Firebug + [Yslow](http://developer.yahoo.com/yslow/)会更有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:51:54.133

在 Firefox 中，您可以通过等待浏览器完成渲染，然后按 ctrl-A 选择页面上的所有内容，最后从右键菜单中选择“显示选择源”来获得最终渲染的 DIV。

这向您显示了页面的操纵/填充的 DOM 代码。

# c# - Web 应用程序中的 LinqToSql 静态 DataContext

> ID：940912
> 
> 赞同：8
> 
> 时间：2009-06-02T17:43:19.263
> 
> 标签：c#, asp.net, linq-to-sql, datacontext

在我遇到的一个Web应用程序中，我在处理LinqToSQL时发现了以下代码来处理DataContext

```
public partial class DbDataContext
  {
    public static DbDataContext DB
    {
      get
      {
        if (HttpContext.Current.Items["DB"] == null)
          HttpContext.Current.Items["DB"] = new DbDataContext();
        return (DbDataContext)HttpContext.Current.Items["DB"];
      }
    }
  } 
```

然后稍后引用它：

```
DbDataContext.DB.Accounts.Single(a => a.accountId == accountId).guid = newGuid;
DbDataContext.DB.SubmitChanges(); 
```

在处理 LinqToSQL 时，我一直在研究最佳实践。

我不确定在处理 DataContext 不是 ThreadSafe 并保留它的静态副本时所采取的方法。

这是采用 Web 应用程序的好方法吗？

@ Longhorn213 - 根据您所说的以及因此我对 HttpContext 的了解越多，我认为您是对的。但是在我继承的应用程序中，这令人困惑，因为在每个方法的开头，他们都在重新查询数据库以获取信息，然后修改数据上下文的该实例并提交更改。

由此看来，我认为这种方法应该被劝阻，因为它给人一种错误的印象，即数据上下文是静态的并且在请求之间持续存在。如果未来的开发人员认为在方法开始时重新查询数据，因为他们认为数据已经存在，他们可能会遇到问题并且不明白为什么。

所以我想我的问题是，在未来的发展中应该不鼓励这种方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T17:45:07.340

这不是静态副本。请注意，该属性从 Context.Items 中检索它，这是按请求进行的。这是 DataContext 的每个请求副本，通过静态属性访问。

另一方面，这个属性假设每个请求只有一个线程，这可能不会永远正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:44:54.423

A`DataContext`的制作成本很低，并且以这种方式缓存它不会获得太多收益。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:46:55.560

我已经完成了许多 Linq to Sql 网络应用程序，但我不确定你所拥有的是否可行。

datacontext 应该跟踪您对对象所做的更改，在这种情况下它不会这样做。

因此，当您点击提交更改时，它不会知道您的任何对象已更新，因此不会更新数据库。

您必须在断开连接的环境（如 Web 应用程序）中对数据上下文做一些额外的工作。更新是最难的，但并不是那么糟糕。我不会缓存并重新创建它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T17:52:47.453

此外，上下文本身不是事务性的，因此理论上可能会在另一个请求上发生更新，并且您的更新可能会失败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T22:22:49.343

我更喜欢创建一个 Page 基类（继承自 System.Web.UI.Page），并公开一个 DataContext 属性。它确保每个页面请求都有一个 DataContext 实例。

这对我来说效果很好，恕我直言，这是一个很好的平衡。您可以在页面末尾调用 DataContext.SubmitChanges() 并确保所有内容都已更新。您还可以确保所有更改一次只针对一个用户。

通过静态执行此操作会导致痛苦——我担心 DataContext 会丢失对更改的跟踪，因为它试图同时跟踪许多用户的更改。我不认为它是为此而设计的。

# java - 防止 Swing GUI 在后台任务期间锁定

> ID：940913
> 
> 赞同：11
> 
> 时间：2009-06-02T17:43:45.223
> 
> 标签：java, multithreading, swing, swingworker, event-dispatch-thread

我有一个存储对象列表的摇摆应用程序。当用户点击一个按钮时，

我想对列表中的每个对象执行两个操作，然后在完成后在 JPanel 中绘制结果。我一直在尝试 SwingWorker、Callable 和 Runnable 来进行处理，但无论我做什么，在处理列表时（可能需要几分钟，因为它是 IO 绑定的），GUI 被锁定。

我有一种感觉，这可能是我调用线程或其他东西的方式，还是与绘图功能有关？这不是线程，因为它非常快。

我也必须按顺序执行两个处理阶段，那么确保第二个处理阶段等待第一个处理阶段的最佳方法是什么？我使用了 join()，然后

```
while(x.isAlive())  
{  
        Thread.sleep(1000);  
} 
```

尝试确保这一点，但我担心这也可能是我的问题的原因。

我一直在到处寻找一些指示，但是由于我找不到任何指示，所以我确定我在这里做了一些愚蠢的事情。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-02T17:49:00.393

问题是，您长时间运行的任务正在阻塞保持 GUI 响应的线程。

您需要做的是将长时间运行的任务放在另一个线程上。

一些常见的方法是使用 Timers 或[`SwingWorker`](http://java.sun.com/javase/6/docs/api/javax/swing/SwingWorker.html).

[Java 教程](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/)在他们的并发课程中有很多关于这些事情的信息。

为了确保第一个任务在第二个之前完成，只需将它们放在同一个线程上。这样您就不必担心保持两个不同的线程正确计时。

这是您的情况下 SwingWorker 的示例实现：

```
public class YourTaskSwingWorkerSwingWorker extends SwingWorker<List<Object>, Void> {
    private List<Object> list
    public YourClassSwingWorker(List<Object> theOriginalList){
        list = theOriginalList;
    }

    @Override
    public List<Object> doInBackground() {
        // Do the first opperation on the list
        // Do the second opperation on the list

        return list;
    }

    @Override
    public void done() {
        // Update the GUI with the updated list.
    }
} 
```

To use this code, when the event to modify the list is fired, create a new `SwingWorker` and tell it to start.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-02T18:18:09.830

You are not returning the swing thread properly. I realize you are using callable/runnable but i'm guessing you are not doing it right (although you didn't post enough code to know for sure).

The basic structure would be:

```
swingMethod() { // Okay, this is a button callback, we now own the swing thread
    Thread t=new Thread(new ActuallyDoStuff());
    t.start();
}

public class ActuallyDoStuff() implements Runnable {
    public void run() {
        // this is where you actually do the work
    }
} 
```

This is just off the top of my head, but I'm guessing that you either aren't doing the thread.start and are instead calling the run method directly, or you are doing something else in the first method that locks it up (like thread.join). Neither of these would free up the swing thread. The first method MUST return quickly, the run() method can take as long as it wants.

If you are doing a thread.join in the first method, then the thread is NOT being returned to the system!

Edit: (Second edit actually) I think to speak to the problem you are actually feeling--you might want to think more in terms of a model/view/controller system. The code you are writing is the controller (the view is generally considered to be the components on the screen--view/controller are usually very tightly bound).

When your controller gets the event, it should pass the work off to your model. The view is then out of the picture. It does not wait for the model, it's just done.

When your model is finished, it needs to then tell the controller to do something else. It does this through one of the invoke methods. This transfers control back to the controller and you go on your merry way. If you think about it this way, separating control and deliberately passing it back and forth doesn't feel so bulky, and it's actually very common to do it this way.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T18:26:14.043

It sounds like the problem might be that you are waiting on the threads to finish from inside the GUI thread. Your GUI thread should not wait on these threads, instead you should have the worker threads invoke some method on the GUI thread that sets a flag. When both flags are set then you know both threads finished and you can do the graph.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T18:53:09.033

I can't really speak to the swing threading model, but:

> I have to do the two processing stages in order too, so what is the best way to ensure the second one has waited on the first?

For this kind of functionality, I'd suggest you create two worker threads, and embed a JMS broker. Deliver work to the two threads by passing messages into JMS queues that they read from. Your GUI thread is free to examine the queues to determine when work is happening and represent the state of play in your UI.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T23:22:45.003

The solution to my problem was a mixture of jjnguy and Bill K's answers, so thanks very much for that guys. I needed to use threads within a SwingWorker like this:

```
public class Worker extends SwingWorker<Void, Void>   
{  
    private List<Object> list;  
    public YourClassSwingWorker(List<Object> theOriginalList){  
        list = theOriginalList;  
    }

    @Override
    public List<Object> doInBackground() {
        Thread t = new Thread(new ProcessorThread(list));  
        t.start();
    }

    @Override
    public void done() {
        // draw graph on GUI
    }
}  
class ProcessorThread implements Runnable {  
    //do lots of IO stuff  
    Thread t2 = new Thread(new SecondProcess());
    t2.start();  
} 
```

This made sure all the work was being done by worker threads away from the GUI, and also ensuring that the SwingWorker itself wasn't doing all of the work, which might have been a problem.

# asp.net-mvc - ModelState.IsValid 用于不可见控件

> ID：940929
> 
> 赞同：0
> 
> 时间：2009-06-02T17:45:41.600
> 
> 标签：asp.net-mvc

我正在使用 C# 开发 MVC。

我有 2 个单选按钮。在选择第一个单选按钮时，将显示一个允许输入日期值的文本框。<%= Html.TextBox("ReceivedDate")%>

在选择第二个单选按钮时，文本框被隐藏。

第一次，当我选择第一个单选按钮并输入日期并单击下一步导航到下一页并再次返回此页面并单击第二个单选按钮并单击下一步继续时，我再次返回此页面并且没有更改任何选项单击继续，它不允许导航并显示错误。

```
 A value is required. 
```

这意味着 ModelState 也验证隐藏控件。

请建议如何控制它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T17:53:52.273

如果再次选择第一项，则不要隐藏它，而是从 DOM 中删除元素并重新插入它。另一种方法是在未选择第一项时将输入控件的名称更改为其他名称（模型数据中不存在的键）。

验证隐藏的输入类型是一件好事，我经常使用它们来同步来自复杂控件的数据（例如带有复选框的树视图）。具有隐藏 css 样式的输入类型不会使其不提交它所属的表单。

# sql - 将数据从一个数据库中的表复制到另一个单独的数据库

> ID：940930
> 
> 赞同：53
> 
> 时间：2009-06-02T17:45:43.580
> 
> 标签：sql, sql-server

基本上我在 SQL Server 2005 上有两个数据库。

我想从一个数据库中获取表数据并将其复制到另一个数据库的表中。

我试过这个：

```
SELECT * INTO dbo.DB1.TempTable FROM dbo.DB2.TempTable 
```

这没有用。

我不想使用还原来避免数据丢失...

有任何想法吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-06-02T17:50:37.347

SELECT ... INTO 创建一个新表。您需要使用 INSERT。此外，您还颠倒了数据库和所有者的名称。

```
INSERT INTO DB1.dbo.TempTable
SELECT * FROM DB2.dbo.TempTable 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-06-02T17:51:47.313

SELECT * INTO 要求目标表不存在。

试试这个。

```
INSERT INTO db1.dbo.TempTable
 (List of columns here)
SELECT (Same list of columns here)
FROM db2.dbo.TempTable 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-02T17:49:41.110

它是 db1.dbo.TempTable 和 db2.dbo.TempTable

四部分命名方案如下：

ServerName.DatabaseName.Schema.Object

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-02T17:53:28.733

很难说不知道“它不起作用”是什么意思。有很多事情可能会出错，我们在排除其中一条路径时提供的任何建议都可能使您越来越远离找到解决方案，这可能非常简单。

这是我会寻找的东西，

如果该表包含一个身份字段并且您手动提供它，则身份插入必须在您要导入的表上。Identity Insert 也只能在数据库中一次只为 1 个表启用，因此您必须记住为该表启用它，然后在完成导入后立即禁用它。

另外，尝试列出所有字段

```
INSERT INTO db1.user.MyTable (Col1, Col2, Col3)
SELECT Col1, COl2, Col3 FROM db2.user.MyTable 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-06-04T11:39:34.297

我们可以像**database_name..object_name这样的三部分命名**

下面的查询将在我们的数据库中创建表（没有约束）

```
SELECT * 
INTO DestinationDB..MyDestinationTable 
FROM SourceDB..MySourceTable 
```

或者，您可以：

```
INSERT INTO DestinationDB..MyDestinationTable 
SELECT * FROM SourceDB..MySourceTable 
```

如果您的目标表存在并且为空。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-14T13:00:55.353

不要忘记插入`SET IDENTITY_INSERT MobileApplication1 ON`到顶部，否则会出错。这适用于**SQL Server**

```
SET IDENTITY_INSERT MOB.MobileApplication1 ON
INSERT INTO [SERVER1].DB.MOB.MobileApplication1 m
      (m.MobileApplicationDetailId,
       m.MobilePlatformId)
SELECT ma.MobileApplicationId,
       ma.MobilePlatformId 
FROM [SERVER2].DB.MOB.MobileApplication2 ma 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-04-21T05:25:43.647

```
INSERT INTO DB1.dbo.TempTable
SELECT * FROM DB2.dbo.TempTable 
```

如果我们使用这个查询，它将返回`Primary key error`.... 所以最好选择需要移动哪些列，比如

```
INSERT INTO db1.dbo.TempTable // (List of columns here)
SELECT (Same list of columns here)
FROM db2.dbo.TempTable 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-10-24T07:27:07.063

我更喜欢这个。

```
INSERT INTO 'DB_NAME' 
(SELECT * from 'DB_NAME@DB_LINK')
MINUS 
(SELECT * FROM 'DB_NAME'); 
```

这意味着将插入未包含`DB_NAME`但包含在的任何内容`DB_NAME@DB_LINK`。希望这有帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-02T17:50:31.233

试试这个

```
INSERT INTO dbo.DB1.TempTable
    (COLUMNS)
    SELECT COLUMNS_IN_SAME_ORDER FROM dbo.DB2.TempTable 
```

仅当 dbo.DB2.TempTable 中的项目已在 dbo.DB1.TempTable 中时，此操作才会失败。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-28T13:41:54.487

这成功了。

```
INSERT INTO DestinationDB.dbo.DestinationTable (col1,col1)
 SELECT Src-col1,Src-col2 FROM SourceDB.dbo.SourceTable 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-07-28T11:43:21.143

即使有一些额外的列，您也可以将一个表复制到另一个数据库表。

```
insert into [SchoolDb1].[dbo].Student(Col1, Col2,Col3, CreationTime, IsDeleted) 
select Col1, Col2,Col3,,getdate(),0 from [SchoolDb2].[dbo].Student 
```

这些是附加列：（CreationTime 是数据时间，IsDeleted 是布尔值）

# c# - 查看发送到 SQLite 的参数查询

> ID：940936
> 
> 赞同：0
> 
> 时间：2009-06-02T17:46:16.340
> 
> 标签：c#, sqlite, parameterized

尝试通过 C# 包装器更新 SQLite 中的一行时，我遇到了奇怪的格式错误。问题不在于包装器，而在于我如何将参数传递给参数查询。

有没有办法查看生成的 SQL 发送到数据库？我查了很多资料，但似乎不太常见，或者至少是不可能的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T17:57:40.970

In SQLite's fundamental (C) interface you could use [sqlite3_trace](http://www.sqlite.org/c3ref/profile.html) (or `sqlite3_profile`, documented at the same URL) -- I'm not sure how those functions map to the C# interface though (indeed, SQLite might be specially compiled to omit them...).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T13:40:27.977

似乎答案可能有点棘手..您可以[在此处](https://stackoverflow.com/a/2789596/838405)查看有关 SqlServer 的解释，我认为对于 Sqlite 是相同的

# iphone - UINavigationController NIB 需要文件的所有者才能查看？

> ID：940952
> 
> 赞同：6
> 
> 时间：2009-06-02T17:49:18.550
> 
> 标签：iphone, uiview, uiviewcontroller, interface-builder, uinavigationcontroller

我在 Interface Builder 中设置 View Controller nib 的默认 View Outlet 时遇到问题。这是我的设置：

我有一个基于 TabBar 的应用程序，在其中我将导航控制器加载为模态视图...

```
MyNavCtrlrSubClass *menu = [[MyNavCtrlrSubClass alloc]initWithNibName:@"MenuController" bundle:nil];
[tabBarController presentModalViewController:menu animated:anim]; 
```

MenuController 本身的结构如下：

```
菜单控制器.xib
  文件的所有者（MyNavCtrlrSubClass：UIViewController）
  导航控制器 (UINavigationController)
    导航栏 (UINavigationBar)
    根视图控制器（Nib Name 设置为加载 AnotherViewController.nib）
      导航项 -> (UINavigationItem)

```

这一切正常，除了加载 MyNavCtrlrSubClass 时，我收到以下错误：

> `Loaded the "MenuController" nib but the view outlet was not set`

很清楚为什么会发生这种情况 - File's Owner 没有用于其视图的插座连接。**问题是我应该设置什么作为它的视图，并且必须首先设置一些东西吗？**导航栏是 MenuController.xib 中唯一的候选者，但这样做只会将 UINavigationBar 本身调整为全屏模式，可以这么说。

我显然在 IB 中遗漏了一些东西，但是什么？MyNavCtrlrSubClass.m 本身没有代码，除了 UINavigationController 的 IBOutlet。我在尝试完全在 IB 中进行设置是否犯了错误？这个想法是将模态导航控制器保留在一个 nib 中，并将它加载的所有视图都加载到单独的 nib 中，但是由于 MenuController 只是导航的容器并且本身不包含视图，因此我显然设计错了。:)

如果您想知道我为什么不以其他方式设计它，那是因为我试图服从我（可能是错误的）对 IB 如何要求您建立理想层次结构的看法。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T03:14:41.050

我认为您可能不了解文件所有者是如何在 NIB 文件中使用的。我[在另一个问题下](https://stackoverflow.com/questions/789251/is-there-an-easy-to-understand-guide-new-to-cocoa-xcode-etc-for-interface-bui/886472#886472)写了一个描述文件所有者的回复。

当您调用此行时：

```
[[MyNavCtrlrSubClass alloc] initWithNibName:@"MenuController" bundle:nil] 
```

您创建一个 MyNavCtrlrSubClass 实例，并告诉它加载 @"MenuController"。然后在 MenuController.xib 文件中，有第二个不相关的 UINavigationController 里面有东西。在运行时加载 MenuController.nib 时，将创建第二个导航控制器。

第二个问题是告诉 UINavigationController 加载 NIB 文件并不明智，因为导航控制器创建和管理自己的视图。您确实想创建根视图控制器，并告诉该视图控制器加载 NIB 文件。

试试这个：

```
MyRootViewController *rootController = [[[MyRootViewController alloc] initWithNibName:@"AnotherViewController" bundle:nil] autorelease];
MyNavCtrlrSubClass *menu = [[MyNavCtrlrSubClass alloc] initWithRootViewController:rootController]; 
```

您的 XIB 文件如下所示：

*   文件的所有者（类设置为 MyRootViewController，视图出口连接到后续 UIView）
*   界面视图
    *   子视图 A
    *   子视图 B

在您对所有这些工作方式感到满意之后，您还可以考虑在一个 XIB 文件中实例化导航控制器和根视图控制器，就像您在发布的代码中开始做的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-19T21:51:00.873

这个问题的症结由 Travis 自己说：“你将如何加载 Navigation Controller nib，尽可能在 Interface Builder 中进行设计？” 从示例中也可以看出，这意味着 UINavigationController 和关联的 UIViewControllers。

通过这种解释，答案是您无法在单个 XIB 中完全配置 UINavigationController 和 UIViewControllers。是的，想要这样做是很直观的，所以你不会发疯。

当我说你不能这样做时，我的意思是最常用的框架方法没有办法处理这个问题。没有**[UINavigationController alloc] initWithMegaNibName**。是的，您可以在单个 XIB 中填充几乎任何东西，并编写代码以特殊方式水合对象，但我认为这不是您想要的。

正如 Jon 建议的那样，您可以使用两个或更多 XIB，但是事情不那么独立，因此您有很多人发现在代码中执行部分或全部控制器更简单。

不幸的是，Interface Builder 功能和代码之间并没有像其他开发平台上那样的 1:1 对应关系。我通常更喜欢让设计师尽可能多地参与创建资产，但我知道他们中的大多数人都不编写 Objective-c 代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:28:11.343

在 IB 中，在 MenuController nib 中添加一个 UIView 并将该视图设置为插座。您需要为 UIViewController 设置该视图。 [这](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhone101/Articles/04_AddingNib.html#//apple_ref/doc/uid/TP40007514-CH6-SW8)是一个指向 Apple 页面的快速链接，其中显示了基本设置。不确定它是否会在您当前的阶段对您有所帮助。

# objective-c - 当所有子复选框都被选中时，如何使大纲视图中的复选框被选中？

> ID：940957
> 
> 赞同：0
> 
> 时间：2009-06-02T17:49:45.587
> 
> 标签：objective-c, cocoa

当所有子复选框都被选中时，如何使大纲视图中父母/组行上的复选框被选中。但是当只有一些被选中时会显示一行。这是我正在谈论的一个例子：

[替代文字 http://snapplr.com/snap/042v](http://snapplr.com/snap/042v)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T20:21:51.833

每当您选中一个框时，请检查它的所有兄弟是否都被选中。如果是这样，请检查父级。（并在该级别再次运行检查。）

要做到这一点......好吧，你的 NSOutlineView 有一个数据源，对吧？告诉它要显示什么的东西？好吧，在单击复选框时调用的方法中（无论您将其设置为什么），获取被单击行后面的父对象，然后更新其状态。如果您没有直接引用模型中的复选框，则可以使用`-[NSOutlineView parentForItem:]`来查找它。

希望这能给你足够的开始。如果没有，那么您需要问一个更具体的问题，详细说明您遇到问题的部分。

# javascript - 如果 URL 哈希发生变化，页面会显示不同的内容吗？

> ID：940964
> 
> 赞同：3
> 
> 时间：2009-06-02T17:50:43.340
> 
> 标签：javascript, ajax, url, hash, fragment-identifier

页面如何根据[URL 哈希](https://stackoverflow.com/questions/940905/can-php-read-the-hash-portion-of-the-url)显示不同的内容？

我不是在谈论浏览器向下滚动以显示锚定部分，而是像 JavaScript 对那个哈希做出反应并通过 AJAX 加载不同的内容。

这是常见的还是可能的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T17:55:59.400

偶尔会这样做。Youtube 使用哈希链接到视频中的特定时间戳。

编辑：我曾假设您可能会遇到一个问题，如果用户在地址栏中手动编辑哈希，页面不会重新加载，甚至 javascript 也不会知道它已更改。我错了。我在 Youtube 上试过，效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T17:57:12.220

哦，是的 - 当内容是 AJAX 驱动时，它正在成为处理页面状态到 URL 持久性的一种常见模式。

Javascript 可以通过 window.location.hash 访问这个值。完成后，您可以根据该哈希值执行任何操作

*   显示/隐藏节点
*   进行其他 AJAX 调用
*   更改页面标题或颜色
*   交换图像
*   ETC

真的，任何 DHTML 效果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T17:57:32.483

几周前我刚刚建立了一个系统来做到这一点

取决于您需要检测哈希的浏览器，这是如何做到的

```
// test all possible places hash could be on different browsers
if(window.location.hash){
   hash = window.location.hash;
} else if (document.location.hash){
   hash = document.location.hash;
} else if (location.hash){
   hash = location.hash;
}

// some browsers start the hash with #, remove it for consistency
if(hash.substring(0,1) == '#'){
    hash = hash.substring(1,hash.length);
} 
```

然后根据需要处理散列变量的值以触发页面更改。

例如： [http://www.example.com#pageA](http://www.example.com#pageA)

```
if(hash = 'pageA'){
  document.getElementById('mainContentDiv').innerHTML = '<p> content for the page displayed when the hash sais pageA</p>';
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T00:15:34.357

[Sammy](http://sammyjs.org/)是一个 javascript 库，它就是这样做的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T17:56:00.833

由于 JavaScript 可以访问 URL 字符串，它当然可以对 url 的内容采取不同的行动。

我偶尔会看到这样的事情，但我认为这不是一种很好的反应方式，除非在非常特定的用途中。

我记得的其中一个用途是[TiddlyWiki](http://www.tiddlywiki.com)使用哈希的后部分来设置页面渲染等的首选项。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T17:56:54.793

在 AJAX 繁重的应用程序（想想 Gmail）中，能够拥有所有 AJAXy 的东西，同时仍然可以为特定页面添加书签或将某人链接到特定页面，这是相当普遍的。如果他们不这样做，就会被认为对可用性不利。通过这样做很容易获得 URL 哈希`window.location.hash`- 因此，如果存在哈希，您可以在页面加载时使用类似 switch 的语句来执行一组特定的 Javascript 函数。

一些实现此功能的 jQuery 插件：[history/remote](http://stilbuero.de/jquery/history/)，[history](http://www.mikage.to/jquery/jquery_history.html)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-28T17:02:52.440

这个问题的答案与我对这些问题的答案或多或少相同：

*   [如何在 URL 中显示 Ajax 请求？](https://stackoverflow.com/questions/3205900/how-to-show-ajax-requests-in-url/3276206#3276206)
*   [Gmail 如何在富 JavaScript 中处理后退/前进？](https://stackoverflow.com/questions/3460041/how-does-gmail-handle-back-forward-in-rich-javascript/3460269#3460269)

总而言之，您可能想要查看的两个项目解释了整个 hashchange 过程并将其与 ajax 一起使用：

*   [jQuery 历史](http://www.balupton.com/projects/jquery-history)（使用哈希来管理您的页面状态并绑定到更改以更新您的页面）。

*   [jQuery Ajaxy](http://www.balupton.com/projects/jquery-ajaxy)（jQuery History 的 ajax 扩展，允许完整的 ajax 网站，同时完全不显眼并且可以优雅地降解）。

# c# - 使用正则表达式修剪 html

> ID：940965
> 
> 赞同：1
> 
> 时间：2009-06-02T17:51:22.307
> 
> 标签：c#, html, regex

一段时间以来一直在尝试解决这个问题。

我需要一个正则表达式来去除下面示例中演示的 html 标记之间的换行符、制表符和空格：

来源：

```
<html>
   <head>
     <title>
           Some title
       </title>
    </head>
</html> 
```

想要的结果：

```
<html><head><title>Some title</title></head></html> 
```

“某些标题”之前的空格的修剪是可选的。我会很感激任何帮助

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-02T17:58:20.753

如果 HTML 是严格的，则使用 XML 阅读器加载它并在不格式化的情况下将其写回。这将保留标签内的空格，但不会保留它们之间的空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T21:53:03.663

\d 在 Perl 5.8 和 5.10 中不只匹配 [0-9]；它匹配任何具有数字属性的 UNICODE 字符（包括“\x{1815}”和“\x{FF15}”）。如果您的意思是 [0-9] 您必须使用 [0-9] 或使用 bytes 杂注（但它将所有字符串转换为 1 字节字符，通常不是您想要的）。

正则表达式根本不擅长解析 HTML（请参阅[您能否提供一些示例，说明为什么用正则表达式解析 XML 和 HTML 很困难？](https://stackoverflow.com/questions/701166)为什么）。您需要的是一个 HTML 解析器。请参阅[您能否提供一个使用您最喜欢的解析器解析 HTML 的示例？](https://stackoverflow.com/questions/773340)对于使用各种解析器的示例。

您可能会发现[HTMLAgilityPack 答案](https://stackoverflow.com/questions/773340/can-you-provide-an-example-of-parsing-html-with-your-favorite-parser/773769#773769)很有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:56:13.267

试试这个：

```
s/[^\w\/\d<>]+/gs 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T17:58:02.563

`s/>\s+</></gs`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T17:58:30.313

`s/\s*(<[^>]+>)\s*/\1/gs`

或者，在 C# 中：

`Regex.Replace(html, "\s*(<[^>]+>)\s*", "$1", RegexOptions.SingleLine);`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T19:18:46.780

这将删除标签之间的空格以及标签和文本之间的空格。

```
s/(\s*(<))|((>)\s*)/\2\4/g 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-17T06:18:47.167

```
Regex.Replace(input, "<[^>]*>", String.Empty); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-29T19:07:50.063

使用 XSLT 的解决方案如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">    
<xsl:output  method="xml" encoding="UTF-8" indent="no"/>

<xsl:template match="*|@*">
    <xsl:copy>
        <xsl:apply-templates/>
    </xsl:copy>
</xsl:template>

<!-- trim whitespaces from the content -->
<xsl:template match="text()">
    <!-- remove from tag to content -->
    <xsl:variable name="trimmedHead" select="replace(.,'^\s+','')"/>
    <xsl:variable name="trimmed" select="replace($trimmedHead,'\s+$','')"/>
    <xsl:value-of select="$trimmed"/>
</xsl:template>

<!-- do not trim where text content exist -->
<xsl:template match="text()">
    <xsl:if test="not(matches(.,'^\s+$'))">
        <xsl:value-of select="."/>
    </xsl:if>
</xsl:template> 
```

您可以选择要使用的模板。第一个在内容存在时也删除所有空格，第二个仅在只有空格或换行符时删除。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2010-06-14T05:00:27.387

我想保留新行，因为删除换行符会弄乱我的 html。所以我去了以下。.

```
private static string ProcessHTMLFile(string input)
{
    string opt = Regex.Replace(input, @"(  )*", "", RegexOptions.Singleline);
    opt = Regex.Replace(opt, @"[\t]*", "", RegexOptions.Singleline);
    return opt;
} 
```

# c# - 跨层枚举

> ID：940966
> 
> 赞同：5
> 
> 时间：2009-06-02T17:51:34.820
> 
> 标签：c#, enums

我想在我的应用程序的三层（演示文稿-> bal-> dal）中使用相同的枚举。我在数据层定义了枚举，我想在表示层使用相同的枚举（表示层没有对数据层的引用）。使用其他人对我认为类似问题的[回答](https://stackoverflow.com/questions/40107/using-attributes-to-cut-down-on-enum-to-enum-mapping-and-enum-const-to-action-swi)，我在业务层中构建了以下枚举：

```
namespace bal
{
    public enum TransactionCode
    {
        Accepted = dal.TransactionCode.Accepted,
        AcceptedWithErrors = dal.TransactionCode.AcceptedWithErrors,
        InvalidVendorCredentials = dal.TransactionCode.InvalidVendorCredentials,
        BrokerOffline = dal.TransactionCode.BrokerOffline
    }
} 
```

这是在层之间构建枚举的适当方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T17:53:53.770

*一种方法是拥有一个跨所有*层共享的“层”（好吧，实际上并不是这样的层）。

不久前我[在博客上写过这个](http://perfectprojectquest.blogspot.com/2007/03/of-layers-and-designs.html)（不幸的是，在一个现在处于休眠状态的博客/项目中）。它可能看起来“不纯”，但它在许多方面使生活变得更轻松，并减少了重复。当然，它也会降低灵活性——如果您希望表示枚举与数据层枚举*不同，则必须重构......*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T17:58:14.870

您的枚举实际上是 API 的一部分。当您考虑分层软件时，通常很难考虑共享类型，但大多数时候，一组类型总是跨层共享。而不是仅仅考虑标准分层：

```
Presentation -> Business -> Data 
```

试着这样想：

```
Presentation -> API
|-> Business ----^
    |-> Data ----^ 
```

API 是您系统的一个共享方面。API 包含任何共享的数据类型、实体、枚举、服务接口等。API 可以隔离到自己的库中，并在您的演示文稿中重用，同时也是您的域（即业务和数据逻辑）的网关。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T17:54:59.697

如果是我，我会创建另一个包含此类内容的项目，并让所有项目都引用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T17:55:47.993

在这些情况下，我通常将我的“数据类型”分离到它自己的小程序集中。然后在您需要的任何地方引用该程序集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T17:54:33.020

这真的取决于你的互动是如何进行的。dal.TransactionCode 到 bal.TransactionCode 的转换很可能在您尝试设置相等性的任何操作中不起作用。

如果您真的将它一路传递并且需要跨越所有层，我会在 bal 层定义它，或者从 UI 中引用 dal。

# python - 将python与c集成以提高性能是否合理？

> ID：940982
> 
> 赞同：3
> 
> 时间：2009-06-02T17:54:54.143
> 
> 标签：python, c, performance

我喜欢在几乎所有事情上都使用 python，并且我一直很清楚，如果由于某种原因我要在我的 python 代码中找到一个瓶颈（由于 python 的限制），我总是可以使用集成到我的代码中的 C 脚本。

但是，当我开始阅读有关如何集成 python的[指南时。](http://www.suttoncourtenay.org.uk/duncan/accu/integratingpython.html)作者在文章中说：

人们可能希望在 C 或 C++ 中扩展 Python 有几个原因，例如：

> *   调用现有库中的函数。
> *   向 Python 添加新的内置类型
> *   优化代码中的内部循环
> *   向 Python 公开 C++ 类库
> *   在 C/C++ 应用程序中嵌入 Python

与性能无关。所以我再问，为了性能，把python和c结合起来合理吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T17:57:11.283

> * 优化代码内循环

这不是关于性能吗？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-02T18:06:23.843

根据我的经验，很少需要使用 C 进行优化。我更喜欢完全在 Python 中识别瓶颈并改进这些领域的算法。使用哈希表、缓存以及通常重新组织数据结构以适应未来的需求，对于加速您的程序具有惊人的潜力。随着程序的开发，您将更好地了解可以预先计算哪种材料，因此不要害怕返回并重做您的存储和算法。此外，寻找“用一块石头杀死两只鸟”的机会，例如在渲染对象时对其进行分类，而不是进行大量分类。

当一切都尽您所知时，我会考虑使用像[Psyco](http://psyco.sourceforge.net/)这样的优化器。仅通过使用 Psyco 并在我的程序中添加一行代码，我就体验到了 10 倍的性能提升。

如果一切都失败了，在适当的地方使用 C，你会得到你想要的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-02T18:02:36.643

性能是一个广泛的主题，因此您应该更具体。如果您的程序中的瓶颈涉及大量网络，那么用 C/C++ 重写它可能不会有什么不同，因为占用时间的是网络调用，而不是您的代码。您最好重写程序的慢速部分以使用更少的网络调用，从而减少程序花在等待 entwork IO 上的时间。如果你在做数学密集型的事情，比如解微分方程，并且你知道有 C 库可以提供更好的性能，那么你目前在 Python 中执行的方式你可能想要重写程序的部分以使用这些库来增加它表现。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-02T20:28:29.917

众所周知，C 扩展 API 很难使用，但还有许多其他方法可以集成 C 代码。

有关一些更有用的替代方案，请参阅[http://www.scipy.org/PerformancePython](http://www.scipy.org/PerformancePython)，特别是有关使用 Wea​​ve 轻松内联 C 代码的部分。

[Cython](http://www.cython.org/)也很有趣，它提供了一个与 C 代码集成的好系统。Cython 被一些备受推崇的高性能 Python 项目（如[NumPy](http://numpy.org)和[Sage](http://sagemath.org) ）用于优化。

如上所述，[Psyco](http://psyco.sourceforge.net/)是另一种有吸引力的优化选项，它只[需要](http://psyco.sourceforge.net/psycoguide/node8.html)

```
import psyco
psyco.bind(myfunction) 
```

Psyco 将识别您的内部循环并自动替换例程的优化版本。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-02T18:17:51.033

C 绝对可以加速处理器绑定的任务。现在，使用 ctypes 库进行集成变得更加容易，或者您可以使用您提到的任何其他方法。

如果您想以他们的代码为例，我觉得 mercurial 在集成方面做得很好。计算密集型任务在 C 中，其他一切都是 python。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-02T18:07:35.743

使用 Python 中的 C 语言（假设您的代码编写良好等）将获得很大的性能提升，因为 Python 是在运行时解释的，而 C 是预先编译的。这将大大加快速度，因为对于 C，您的代码只是在运行，而对于 Python，Python 解释器必须弄清楚您在做什么并将其解释为机器指令。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T19:12:54.687

我被告知计算部分使用 C 来编写脚本使用 python。所以是的，你可以整合两者。C的计算速度比python快

# regex - 有哪些奇特的解析技术？

> ID：940984
> 
> 赞同：4
> 
> 时间：2009-06-02T17:55:02.427
> 
> 标签：regex, ocaml, grammar

在过去的一年里，我一直在解析扑克手牌的历史，并且在一般的解析方面学到了很多东西。

我们从正则表达式开始，但很快意识到这不会轻易扩展。我们跳过了从 ruby​​ 到 c++ 的语言，最后意识到必须改变的是算法。

我们拿起了 Boost::Spirit 并看到我们的速度以我们原始速度的 10 倍以上的顺序急剧上升。然后我们跳到 java，目前正在使用 antlr 为每个站点创建语法。这绝对是迄今为止最快的方法，而且非常彻底，这很好，因为您确切地知道您在“完整”语法方面的立场。不幸的是，我花费了大量的时间来处理这些语法——它们工作得非常好，但还不完美。

无论如何，关于手头问题的背景已经足够了——是否有任何我不知道的“异国情调”或鲜为人知的解析技术？我只知道词法分析/解析语法和其他劣质正则表达式/循环方法。

对于那些不熟悉扑克手牌历史的人，我会发布一个，以便您了解结构是什么。

```
Full Tilt Poker Game #12037626529: Table durrrr (heads up, deep) - $500/$1000 -
Pot Limit Omaha Hi - 2:00:48 ET - 2009/05/05
Seat 1: durrrr ($196,456.50)
Seat 2: Gus Hansen ($65,499)
durrrr posts the small blind of $500
Gus Hansen posts the big blind of $1,000
The button is in seat #1
*** HOLE CARDS ***
durrrr raises to $3,000
Gus Hansen raises to $9,000
durrrr calls $6,000
*** FLOP *** [3d 4d 7d]
Gus Hansen has 15 seconds left to act
Gus Hansen checks
durrrr checks
*** TURN *** [3d 4d 7d] [Jh]
Gus Hansen checks
durrrr checks
*** RIVER *** [3d 4d 7d Jh] [Ah]
Gus Hansen has 15 seconds left to act
Gus Hansen checks
durrrr has 15 seconds left to act
123stayfree (Observer): GUS I NOW BRING U LUCK
durrrr bets $7,600
Gus Hansen has 15 seconds left to act
Gus Hansen has requested TIME
Hernandez777 (Observer): Gus has the super-duper nuts
Gus Hansen calls $7,600
Podobed45 (Observer): fluuuuuuuuuush
*** SHOW DOWN ***
durrrr shows [Kc 3s Qd As] two pair, Aces and Threes
Gus Hansen mucks
durrrr wins the pot ($33,199.50) with two pair, Aces and Threes
*** SUMMARY ***
Total pot $33,200 | Rake $0.50
Board: [3d 4d 7d Jh Ah]
Seat 1: durrrr (small blind) collected ($33,199.50)
Seat 2: Gus Hansen (big blind) mucked 
```

我很清楚其他收集信息的方法（例如屏幕抓取和 dll 注入），但仍然需要将手牌历史转换为结构化数据，所以我只关注获取信息的方法，例如正则表达式/语法...

我想如果我找不到东西，我会用 ocamllex/ocamlyacc 重写我们的语法。

**更新**

仅供参考：正则表达式速度约为 60 手/秒，而语法处理 600+ 手/秒...在数据全部整理好后，整只手都转换为 xml... 需要 20-30 个正则表达式（在最后一次计数）对于您要解析的每个站点....语法方面的每个站点都有自己的语法，其中包含大量的词法分析器/解析器规则（但它的代码量仍然较小）

我确实有龙书并且一直在阅读它——这让我对使用 ocamllex/ocamlyacc 失去了兴趣……速度是这里游戏的名称……

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T18:45:18.253

由于您正在寻找异国情调，请阅读有关 Vaughan Pratt 的自上而下运算符优先级的这篇文章......

[http://javascript.crockford.com/tdop/tdop.html](http://javascript.crockford.com/tdop/tdop.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T17:57:59.973

[解析器组合](http://en.wikipedia.org/wiki/Parser_combinator)器是一种非常流行的用函数式语言（例如 Haskell）构建解析器的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T18:28:04.760

如果您希望最大限度地提高速度，那么您可能会更好地使用 OcamlYacc/FsYacc 而不是 ANTLR。~~OcamlYacc 创建 LL(1) 解析器，它通常比 ANTLR 样式的 LL(*) 解析器具有更好的性能（如果我错了，有人可以纠正我）。~~ *[编辑添加：] 看起来有人纠正了我：OCamlYacc 生成 LALR(1) 解析器。我不能肯定地说 OcamlYacc 解析器是否比 ANTLR 解析器快。*

OCaml/F# 是构建 DSL 的非常好的语言，在我看来比 Java 更适合这项工作，主要是因为它非常容易创建和遍历表示为联合数据结构的 AST。我推荐[了本教程](http://en.wikibooks.org/wiki/F_Sharp_Programming/Lexing_and_Parsing)，该教程演示了如何在 F# 中解析 SQL。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-12T17:11:13.267

你必须问自己，你真正想做的是玩解析器（诚然很有趣，而且我更喜欢我自己），或者你是否真的想在你的扑克机器人上完成工作。最有可能的是，异国情调的解析技术对于您需要的东西来说太过分了。只需选择具有一些简单易用的解析器的快速语言即可。您应该能够使用直接 C + flex 处理 10k 手/秒。或者，ocamllex + ocamlyacc 应该绰绰有余。如果你必须对你的代码进行 hadoopify，我认为你做错了什么。网络延迟应该最终成为您真正的瓶颈，而不是解析速度。你在什么机器上运行这个？

另一种选择是使用解析器生成器自动生成解析表，然后手动优化它，或者从 NFA 手动优化（虽然你可能不会节省太多，而且程序员时间的权衡可能不值得）。组合器解析可能会更慢。

平均而言，对于给定的等效功率语法，LL 将比 LALR 慢。特别是，如果扑克牌实际上可以被 LALR 解析器解析，那么 bison/byacc + flex 每次都会击败 ANTLR 牌。我个人对 menhir 非常满意，尽管与 godi + ocamlbuild 一起工作是一个疯狂的婊子。

——尼科

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T18:12:08.763

阅读龙书： [http ://www.amazon.com/Compilers-Principles-Techniques-Alfred-Aho/dp/0201100886](https://rads.stackoverflow.com/amzn/click/com/0201100886)

它深入涵盖了词汇和句法分析（以及其他主题）。您可以使用它来帮助您理解您尝试解析的“语言”以确定最佳的解决方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T18:13:41.897

维基百科对解析器类型有一个很好的概述，这里： [http ://en.wikipedia.org/wiki/Parser](http://en.wikipedia.org/wiki/Parser)

还有一个关于解析器生成器工具的比较，在这里：[http ://en.wikipedia.org/wiki/Comparison_of_parser_generators](http://en.wikipedia.org/wiki/Comparison_of_parser_generators)

我认为[GLR](http://en.wikipedia.org/wiki/GLR_parser)是一种鲜为人知的方法，它很有趣，因为它处理语言的歧义。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T18:37:59.750

[递归下降解析](http://en.wikipedia.org/wiki/Recursive_descent_parser)可能对您有用。它是非常可定制的。它可能比 yacc/antlr 慢一点，但可能足够快。基本思想：您将每个语法规则编码为一个函数。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-05T21:19:02.357

由于您正在谈论使用 OCaml 进行解析，因此此页面概述了该语言的不同解析选项：

[OCaml 语言的解析器生成器](http://www.lama.univ-savoie.fr/~raffalli/ocaml-parsing.html)

如果您决定接受`ocamlyacc`（或`menhir`），这些教程可能比参考手册要容易一些：

*   [Ocamllex 教程](http://plus.kaist.ac.kr/~shoh/ocaml/ocamllex-ocamlyacc/ocamllex-tutorial/)
*   [Ocamlyacc 教程](http://plus.kaist.ac.kr/~shoh/ocaml/ocamllex-ocamlyacc/ocamlyacc-tutorial/)

# javascript - 在鼠标悬停或悬停时隐藏图像标题工具提示弹出窗口

> ID：940994
> 
> 赞同：0
> 
> 时间：2009-06-02T17:56:35.327
> 
> 标签：javascript, html, browser

我希望我能在这里得到这个问题的答案......

我有一个客户想要在 Lightbox 窗口中添加一个 PayPal“添加到购物车”按钮。我可以通过将 PayPal 代码放在图像标题标签中来实现这一点。

不确定这是否是最好的方法，但它确实有效。

然而，这是我的问题......

现在，当您将鼠标悬停在图像缩略图上时，图像标题工具提示弹出窗口会显示 PayPal 代码。不好...

有没有办法禁用此功能？我可以告诉浏览器不显示此弹出窗口吗？

这是链接（我只将代码应用于前两张照片）：

[http://lancemissionart.com/index.php?Page=gallery&title=fof&gallery=msd](http://lancemissionart.com/index.php?Page=gallery&title=fof&gallery=msd)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T18:19:49.437

您应该从使用 Lightbox 更改为 Thickbox（看起来您可能正在代码中尝试使用它）。Lightbox 仅适用于图像（即使您将其全部放在标题标签中并且非常错误），Thickbox 会让您包含您的表单。

[http://jquery.com/demo/thickbox/](http://jquery.com/demo/thickbox/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T18:21:07.783

我会修改灯箱以使用不同的属性而不是标题，例如 paypalForm。lightbox.js第398行的修改。

```
398: imageArray.push(new Array(anchor.getAttribute('href'), anchor.getAttribute('paypalForm'))); 
```

另一种选择是仅设置标题属性`onMouseDown`，并在灯箱关闭时将其设置回空字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-19T14:36:49.037

[厚箱](http://jquery.com/demo/thickbox/)不再维护！********