# StackOverflow 问答 000223000-000223999

# iis - 在 IIS 中使用 IP 地址或主机标头

> ID：223009
> 
> 赞同：1
> 
> 时间：2008-10-21T18:50:44.840
> 
> 标签：iis, hostheaders

我想知道这方面的最佳做法？我知道有两种方法可以使用 IIS 和托管多个网站。

首先是每个网站都有一个IP

第二种是使用主机头，以及 IIS 的单个 IP 地址

我想知道哪个是最佳实践，为什么应该首选一个而不是另一个？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T19:01:14.663

如果每个站点都有自己的 IP 地址/域名，则更容易实施和管理 SSL。您只需获得该名称的证书并将其安装在该站点上。使用主机标头执行[SSL](http://technet.microsoft.com/en-us/library/cc738897.aspx)需要通配符服务器证书，该证书在共享 IP 的所有站点之间实施和同步。您也没有所有站点都在同一个域中的限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T13:15:38.190

虚拟主机通常比单独的 IP 地址更好，但您的里程会有所不同。

这实际上是一个网络与系统部署连接。您想查看系统上将拥有的站点和服务的总数。您可能希望它们存在于不同的网络接口上（因此有多个 IP 地址）。您可能希望它们使用绑定的物理接口。

由于安全原因，您可能希望运行需要与其他应用程序分开运行的 Web 应用程序。

上面的其他答案提到了其他因素，例如 SSL、组织边界。（某些软件确实通过 IP 地址进行关联，例如垃圾邮件控制）。可能还有很多其他我没有想到的因素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T18:57:30.927

我个人根据彼此的关系将站点分开。例如，我所有的业务站点都共享一个 IP 地址（目前 1 个域）。我所有的个人/社区网站共享第二个 IP 地址。

当发送电子邮件时，差异可能会随着时间的推移而出现，因为我知道 IP 在某些黑名单系统中发挥作用，因此如果一个具有共享 IP 地址的站点导致问题，它可能会导致使用该 IP 的其他站点出现问题。

我敢肯定还有其他项目、原因和理由，但至少这些是我的……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T20:39:59.973

就我个人而言，我发现主机头配置使标准网络托管的生活变得非常容易。

我实际上有数百个站点在多个服务器上运行单个 IP 地址 - IIS 和 *nix Apache，都配置为虚拟主机。在实时网络托管环境中，它在 DNS 配置和服务器配置方面都变得更轻松。

我唯一一次使用基于 IP 的分离是我想在不同网络上运行站点，从而为不同网络接口的流量提供服务。

我没有看到主机头方法有任何性能损失，但想听听任何人的恐怖故事 - 肯定有一些:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-26T13:27:39.477

首选主机标头，因为它们可以节省 IPv4 地址空间。自 HTTP/1.1 以来，它们一直是强制性的。

使用 https，事情会稍微复杂一些；您需要一个支持 TLS/SSL server_name 扩展（RFC 4366 和以前的 RFC 3546）的现代浏览器。这包括：

*   Opera 8.0 或更高版本
*   火狐 2.0 或更高版本
*   Vista 上的 IE 7
*   谷歌浏览器

当然你的服务器必须支持它。如果您想支持早期的浏览器并使用 SSL/TLS，您需要为每个虚拟主机提供一个 IP 地址；随着这些浏览器过时，您将要共享 TLS/SSL 的 IP 地址。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-05T04:06:17.627

[托管多个网站时的主机标头与多个 IP](http://www.gafvert.info/iis/article/host_headers_vs_ip.htm)

# sql - MS SQL Server 中的字符串操作

> ID：223011
> 
> 赞同：3
> 
> 时间：2008-10-21T18:50:46.183
> 
> 标签：sql, sql-server, string

谁能给我 Microsoft SQL Server（2000 或 2005）中字符串操作函数的完整列表？

（我不需要关于在表示层进行所有字符串处理的讲座。而且，我不需要 MySQL 字符串函数的列表。）

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-21T18:52:40.827

[字符串函数 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms181984.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T18:52:42.530

MSDN 和 Google 是你的朋友

[这是 2008 版本](http://msdn.microsoft.com/en-us/library/ms181984.aspx)，深入了解您的特定口味。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T18:55:28.543

查看 msdn 列表，我注意到缺少[HashBytes()](http://msdn.microsoft.com/en-us/library/ms174415.aspx)。我想它属于不同的类别，但它绝对是对字符串执行的操作，并且了解它很有用。

# java - 是否有“reduce”的类型安全 Java 实现？

> ID：223013
> 
> 赞同：7
> 
> 时间：2008-10-21T18:51:05.463
> 
> 标签：java, collections, reduce

我经常需要在 java 中运行 reduce（也称为 foldl / foldr，具体取决于您的上下文）来聚合 Itterable 的元素。

Reduce 接受一个集合/可迭代/等，一个由两个参数组成的函数，以及一个可选的起始值（取决于实现细节）。该函数依次应用于集合的一个元素和上一次reduce调用的输出，直到处理完所有元素，并返回最终值。

在任何常见的 java api 中是否有类型安全的 reduce 实现？[谷歌收藏](http://google-collections.googlecode.com) *似乎*应该有一个，但我一直没能找到它。（可能是因为我不知道它会使用什么其他名称。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T19:26:24.177

根据您的描述，您可能很容易推出自己的通用产品：

```
public interface Reducer<A, T>
{
    public A foldIn(A accum, T next);
} 
```

然后使用策略模式：

```
public class Reductor<A, T>
{
    private Reducer<A, T> worker;
    public Reductor<A, T>(Reducer<A, T> worker)
    {
        this.worker = worker;
    }

    public A fold(A rval, Iterator<T> itr)
    {
        while(itr.hasNext())
        {
            A rval = worker.foldIn(rval, itr.next());
        }
        return rval;
    }
} 
```

我敢肯定有大量的语法错误，但这是重点（关于如何获取空的累加器值，您可以做出一些选择。然后在特定的迭代器上使用它，只需动态定义您的 Reducer：

```
Reductor r = new Reductor<A, T>(new Reducer<A, T>()
{
    public A foldIn(A prev, T next)
    {
        A rval;
       //do stuff...
       return rval;
     }
 }

 A fold = r.fold(new A(), collection.getIterator()); 
```

根据您的迭代器的工作方式，只要迭代器朝着正确的方向前进，它就可以向左折叠或向右折叠。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-21T20:45:21.630

根据 Luke 的建议，这是一个合法的 Java 实现：

```
public interface Reducer<A,T>
{
    A foldIn(A accum, T next);
}

public static <T> T reduce(final Reducer<T,T> reducer, 
        final Iterable<? extends T> i)
{
    T result = null;
    final Iterator<? extends T> iter = i.iterator();
    if (iter.hasNext())
    {
        result = iter.next();
        while (iter.hasNext())
        {
            result = reducer.foldIn(result, iter.next());
        }
    }
    return result;
}

public static <A,T> A reduce(final Reducer<A,T> reducer, 
        final Iterable<? extends T> i, 
        final A initializer)
{
    A result = initializer;
    final Iterator<? extends T> iter = i.iterator();
    while (iter.hasNext())
    {
        result = reducer.foldIn(result, iter.next());
    }
    return result;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T18:59:15.870

试试[commons 函子包](http://commons.apache.org/sandbox/functor/)。它一直在沙盒中，但我认为它会做你想做的事。

# flash - Flex Builder 3：调试器跟踪错误，修复 as 文件时，不断抛出相同的错误，卡在过去

> ID：223016
> 
> 赞同：1
> 
> 时间：2008-10-21T18:51:37.867
> 
> 标签：flash, actionscript-3, actionscript, flexbuilder

我正在运行我正在使用 flex builder 编译的第一个项目。之前我都是用flash编译或者flash develop。

有一段时间它工作得非常整洁。但是一旦它开始抛出类型错误，我似乎就无法编译更新和保存的动作脚本文件。似乎它一直停留在时间上，并从错误仍然存​​在时开始编译 actionscript 文件。

也许我错过了有关配置调试器的任何选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T19:09:02.277

你试过做清洁吗？在 FlexBuilder 的 Project 菜单中，选择 Clean...

Flex 可能正在构建临时文件，在这种情况下，清理应该清除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-05T21:00:34.043

最小化 Eclipse 并查看是否有其他窗口潜伏在 IDE 后面，也尝试终止所有会话，并像 Herms 建议的那样转到 Project->Clean...->YourProject

我敢肯定 Chris 从 08 年开始就已经继续前进了，但对于其他任何人来说，这都为我解决了问题。

# c++ - C++ 中“使用”声明的范围是什么？

> ID：223021
> 
> 赞同：112
> 
> 时间：2008-10-21T18:52:27.663
> 
> 标签：c++

我在 C++ 中使用 'using' 声明将 std::string 和 std::vector 添加到本地命名空间（以节省键入不必要的 'std::'s）。

```
using std::string;
using std::vector;

class Foo { /*...*/ }; 
```

该声明的范围是什么？如果我在标头中执行此操作，它会将这些“使用”声明注入到包含标头的每个 cpp 文件中吗？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2008-10-21T18:57:25.560

头文件没有什么特别之处可以阻止`using`声明。在编译开始之前，这是一个简单的文本替换。

您可以将`using`声明限制在范围内：

```
void myFunction()
{
   using namespace std; // only applies to the function's scope
   vector<int> myVector;
} 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2008-10-21T18:56:32.770

当您在 C++ 中#include 头文件时，它会将头文件的全部内容放入您将其包含在源文件中的位置。因此，包含具有声明的文件与将声明放在包含该头文件的每个文件的顶部`using`具有完全相同的效果。`using`

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2008-10-21T19:53:01.533

using 语句的范围取决于它在代码中的位置：

*   放置在文件的顶部，它具有整个文件的范围。
*   如果这是一个头文件，它将在包含该头文件的所有文件中具有作用域。一般来说，这*不是一个好主意*，因为它可能会产生意想不到的副作用
*   否则，*using*语句在包含它的块内具有范围，从它出现的点到块的末尾。如果它被放置在一个方法中，它将在该方法中具有范围。如果它被放置在一个类定义中，它将在该类中具有范围。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-21T19:46:14.387

范围是 using 声明所在的任何范围。

如果这是全局范围，那么它将在全局范围内。如果它在头文件的全局范围内，那么它将在包含头文件的每个源文件的全局范围内。

因此，一般建议是**避免在头文件的全局范围内使用声明**。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-21T18:53:23.417

在引用的情况下，文件（“翻译单元”），这意味着是的，包括它的每个文件。

您也可以将 using 语句放在类中，在这种情况下，它仅对该类有效。

通常，如果您需要在标头中指定命名空间，通常最好只对每个必要的标识符进行完全限定。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-21T18:54:27.017

那是对的。范围是使用`using`声明的模块。如果模块包含的任何头文件具有`using`声明，则这些声明的范围将是该模块以及包含相同头文件的任何其他模块。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-22T08:42:33.540

当他们说“不要”时，有一些评论是相当不合格的。这太严厉了，但你必须明白什么时候可以。

写作`using std::string`永远不行。在您自己的标头中编写`using ImplementationDetail::Foo`，当该标头声明 ImplementationDetail::Foo 时可以，如果 using 声明发生在您的命名空间中，则更是如此。例如

```
namespace MyNS {
    namespace ImplementationDetail {
        int Foo;
    }
    using ImplementationDetail::Foo;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-14T13:54:28.800

编辑：

作为附加信息，当语句放在**“#include”之前**时，将“使用”放在源文件中会影响您的标题。（使用范围**不“向后”延伸**）

头文件.h

```
//header.h
#include <string>

std::string t1; // ok
string t2; // ok 
```

头文件.cpp

```
//header.cpp
using namespace std ;

#include "header.h"

... 
```

# algorithm - tf-idf 和以前看不见的术语

> ID：223032
> 
> 赞同：8
> 
> 时间：2008-10-21T18:53:35.867
> 
> 标签：algorithm, statistics, nlp, tf-idf

[TF-IDF（词频-逆文档频率）](http://en.wikipedia.org/wiki/Tf-idf)是信息检索的主要内容。不过，这不是一个合适的模型，当新术语被引入语料库时，它似乎会崩溃。当查询或新文档有新术语时，人们如何处理它，特别是如果它们是高频率的。在传统的余弦匹配下，这些对总匹配没有影响。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T22:11:20.833

呃，不，不会崩溃。

假设我有两个文件，A“鼬鼠山羊”和 B“奶酪地鼠”。如果我们实际上将它们表示为向量，它们可能看起来像：

A [1,1,0,0]
B [0,0,1,1]

如果我们在索引文件中分配了这些向量，是的，我们在添加新术语时遇到了问题。但它的诀窍是，*那个向量永远不存在*。关键是[倒排索引](http://en.wikipedia.org/wiki/Inverted_index)。

至于不影响余弦匹配的新术语，根据您的意思，这可能是正确的。如果我用查询“marmoset kungfu”搜索我的 (A,B) 语料库，语料库中既不存在狨猴也不存在 kungfu。所以代表我的查询的向量将与集合中的所有文档正交，并得到一个糟糕的余弦相似度分数。但考虑到所有条款都不匹配，这似乎很合理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T22:15:25.173

当您谈论“分解”时，我认为您的意思是新术语对相似性度量没有影响，因为它们在原始词汇表定义的向量空间中没有任何表示。

处理此平滑问题的一种方法是考虑将词汇表固定为较小的词汇表，并将所有比某个阈值稀有的词视为属于特殊`_UNKNOWN_`词。

但是，我认为您对“崩溃”的定义不是很清楚。你能澄清你的意思吗？如果你能澄清这一点，也许我们可以讨论解决这些问题的方法。

# datagrid - 支持复制/粘贴到 Excel 电子表格的开源 Web 网格控件

> ID：223035
> 
> 赞同：1
> 
> 时间：2008-10-21T18:54:04.960
> 
> 标签：datagrid

我正在寻找一个 Web 数据网格控件以集成到 ASP.NET 应用程序中。所需的最重要功能是能够直接从网页上的网格复制粘贴到 Excel 电子表格。

除了谷歌电子表格，我发现这个产品（非开源） - [http://www.editgrid.com/](http://www.editgrid.com/) 看起来最符合我的要求，但不是开源的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T19:12:38.387

尝试查看codeplex上的[extjs 扩展](http://www.codeplex.com/ExtJsExtenderControl)

# image - 在没有 Photoshop 的情况下使用 CMYK PSD

> ID：223038
> 
> 赞同：29
> 
> 时间：2008-10-21T18:54:50.467
> 
> 标签：image, photoshop, gimp, cmyk, psd

我遇到了一个常见但困难的问题。我不使用 Photoshop 进行图像处理。由于我所有的工作都是基于网络的，因此[GIMP](http://en.wikipedia.org/wiki/GIMP)在 99% 的情况下都能满足我的需求。*问题*是我偶尔会收到带有[CMYK](http://en.wikipedia.org/wiki/CMYK_color_model)编码而不是[RGB](http://en.wikipedia.org/wiki/RGB_color_model)编码的[PSD](http://en.wikipedia.org/wiki/Adobe_Photoshop#Features)文件。这些文件不会在 GIMP 中打开，也不会在[ImageMagick](http://en.wikipedia.org/wiki/ImageMagick)中转换。

有没有人找到一个很好的解决方案，将 CMYK 文件转换为 RGB 文件（PSD 格式或 PNG 等平面格式），**而不**涉及使用 Photoshop？说是 GIMP 插件还是独立实用程序？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-11-08T00:27:04.373

我刚刚对 Imagemagick 很幸运：

```
convert input.psd -colorspace rgb output.png 
```

它为每一层创建了一堆名为 output-[0-9].png 的文件。足以开始在 Gimp 上使用它。当我尝试在 Gimp 2.6 中打开这些 PSD 时，我收到的消息是：

```
Error loading PSD file: Unsupported color mode: CMYK 
```

我正在使用 Ubuntu Lucid 的 Imagemagick：

```
Version: ImageMagick 6.5.7-8 2009-11-26 Q16 http://www.imagemagick.org
Copyright: Copyright (C) 1999-2009 ImageMagick Studio LLC
Features: OpenMP 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-21T19:43:10.820

假设您可以访问 Windows 计算机，IrfanView 或 XnView 等免费软件也可以打开它并以您需要的任何格式重新保存。XnView 知道更多的格式，并且有一个 NConvert 命令行版本来完成这个任务，但是 IrfanView 也可以做命令行操作——我通常安装两者，更喜欢 IrfanView 的界面。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-07-01T10:58:39.160

Superuser.com 上有一个[非常相似的问题](https://superuser.com/questions/353451/using-a-cmyk-psd-file-with-the-gimp)，其中一个答案引导我使用 Program [Krita](https://krita.org/)。我在[Krita](https://krita.org/)版本 2.8.1 和 KDE 版本 4.13.3 在 Ubuntu Linux 14.04 中打开了一个大小约为 26 Mb（6761 x 2423 像素）的 CMYK .psd 文件。使用 Krita 中的对话框将颜色空间从 CMYK 转换为 RGB 后`Image-->Properties`，该程序能够将图像存储为 RGB PNG 文件。**更新**：[Nicolas](https://stackoverflow.com/users/1458491/nicolas)在下面的评论中指出：如果您的 .psd 文件包含多个图层，则可能需要`Image-->Convert Image Color Space`在保存之前进入。

之后，我能够使用 gimp 打开生成的 RGB PNG，并且据我所知，所有颜色都以合理的方式进行了转换。

[上面的评论（由 Heiken 撰写](https://stackoverflow.com/users/1331993/heiken)）中已经提到了 Krita 。但由于我认为 Krita 是对原始问题最合适的答案之一，因此我决定发布此答案以报告我在这里的经历。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-15T00:36:10.780

Open Office 实际上可以导入 CMYK PSD 文件。只需右键单击 PSD 文件并选择“使用其他应用程序打开”并选择 OpenOffice.org 绘图。（假设您使用的是 GNOME。）

但是它不支持图层，所以你不能做任何真正花哨的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-12T18:17:05.097

也可以导入到 Scribus，如果在 Scribus 中使用 1.3.5 或更高版本，可以更改图层可见性和混合模式，图像可以保存为 tif、jpg、png、pdf、ps/eps；之后，可以使用 Gimp 编辑其中的任何内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-01T07:56:00.320

似乎这里有一个插件[http://cue.yellowmagic.info/softwares/separate-plus/index.html](http://cue.yellowmagic.info/softwares/separate-plus/index.html)其中包括：

单独的 RGB 到 CMYK 转换/Softproofing 插件（Alastair M. Robinson 的“Separate”插件的改进版本

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-21T23:54:42.413

我在寻找相同问题的答案时发现了你的问题，我自己在我的 Ubuntu 机器上遇到了这个问题。

更有希望的是，我将 PSD 文件传输到我的 Windows XP 机器上，在那里我发现可以使用**paint.net**打开它。然后我再次保存了它，这花了很长时间——当我看到文件令人难以置信的大小时，这并不奇怪。原来是3.7Mb，重新保存的版本是197Mb！幸运的是，它压缩到了大约 940K。

无论如何，关键是当我尝试在 Linux 上的 GIMP 上重新保存文件时，它似乎工作正常。它甚至给了我层次。

顺便说一句，**paint.net**是一个不错的小程序，尽管它的工作方式与 The Gimp 略有不同。它也是免费的:-)

希望这会有所帮助。

R。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-11-01T17:11:23.853

Gimp 有一个名为[Ghostscript](http://www.id-meneo.com/img/Ghostscript-install-trouble.html)的插件，它似乎对我有用。

问题的答案迟到了，可能不在你提出问题的时候，但你去了。我不知道它的效果如何，因为我刚开始使用它。

# wiki - wiki 使用哪些方法来合并并发编辑？

> ID：223040
> 
> 赞同：8
> 
> 时间：2008-10-21T18:55:21.150
> 
> 标签：wiki, merge

如果两个用户编辑同一个 wiki 主题，在 wiki（或类似的协作编辑软件）中使用了哪些方法将第二个用户的编辑与第一个用户的编辑合并？

我想要一个解决方案：

*   不需要锁定
*   不会丢失对页面的任何添加。
*   它可能会添加额外的“样板”文本以指示进行不同更改的位置。

（我对可用于实现[此用户语音想法](https://web.archive.org/web/20081009065531/http://stackoverflow.uservoice.com:80/pages/general/suggestions/28245)以解决堆栈溢出的解决方案感兴趣。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T19:00:04.980

我对大多数 Wiki 软件（例如 MediaWiki）的体验是它会跟踪您正在编辑的文档的版本。如果在您编辑期间文档发生更改，您的更改将被拒绝，并提示您执行手动合并。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-21T21:28:46.270

[TWiki](http://twiki.org)自动合并[同步编辑](http://twiki.org/cgi-bin/view/TWiki.SimultaneousEdits)。

> TWiki 允许多个同时编辑同一主题，然后自动合并不同的更改。除非存在无法自动合并的冲突，否则您可能甚至不会注意到这种情况。在这种情况下，您可能会看到 TWiki 在文本中插入“更改标记”以突出您的编辑与其他人的编辑之间的冲突。这些更改标记仅在您与其他人编辑主题的同一部分时使用，它们指示文本过去的样子、其他人的编辑内容以及您的编辑内容。
> 
> 如果您尝试编辑其他人正在编辑的主题，TWiki 会发出警告。如果在保存过程中需要合并，它也会发出警告。

该功能还有一些[文档](http://twiki.org/cgi-bin/view/Codev/DakarMergeModel)正在开发中，详细说明了它的行为方式。

> 我在编写合并算法时使用的基本原则是：
> 
> 1.  如果可以在不使用冲突标记的情况下进行合并，请这样做。
> 2.  如果可以使用冲突标记进行合并，请这样做。
> 3.  如果无法合并，则最近签入获胜。

值得注意的是，TWiki 具有与 Stack Overflow 类似的功能，用于在特定时间限制内折叠同一用户的后续修订，这[在与 merge 一起发生时会导致错误](http://develop.twiki.org/~twiki4/cgi-bin/view/Bugs/Item1897)。

> 1.  用户 A 编辑主题
> 2.  用户 A 保存 rev N
> 3.  用户 B 编辑主题，选择 rev N
> 4.  用户 A 再次编辑主题，选择 rev N
> 5.  用户 A 保存更改；save 看到更改在 ReplceIfEditiedWithin? 窗口，**所以不增加转速**
> 6.  用户 B 保存，代码看到**光盘上的版本号自他们开始编辑以来没有改变，**因此没有检测到需要合并。

另外值得注意的是，TWiki 会警告第二个用户该主题正在被编辑：

> 所以我发明了“租约”的概念。编辑主题时，会在固定时间段（默认 1 小时）内对该主题进行租用。如果其他人尝试编辑，他们会被告知该主题已经有租约，但这并不能阻止他们进行编辑。这不是锁，这只是一种建议他们的方式。合并仍然是主要的解决机制；租约纯粹是建议性的。如果用户 - 或插件 - 选择退出某个主题，因为有人对其进行了租约，那么这取决于插件。
> 
> TWiki.cfg 中的描述性注释如下：
> 
> ```
>  # When a topic is edited, the user takes a "lease" on that topic.
>    # If another user tries to also edit the topic while the lease
>    # is still active, they will get a warning. The warning text will
>    # be different depending on whether the lease has "expired" or
>    # not i.e. if it was taken out more than LeaseLength seconds ago. 
> ```

请注意，租赁术语仅适用于开发人员，不适用于最终用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T18:59:55.807

您可以在其他数据库表中使用用户的 ID 和时间编写“锁”，并在该人保存时或 x 分钟后删除“锁”（对于不理解的人来说，这不是真正的锁） .

这样，当有人尝试编辑并且有人已经在这样做时。一条消息可以显示剩余时间，或者只是告诉其他人当前正在编辑帖子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T19:16:25.257

好吧，您可以使用合并算法，就像源代码控制软件使用的那样。您可能想让它检查段落级别的更改，以帮助保持可读性。

如果存在潜在冲突（例如，两个用户编辑同一段落），您可能需要简单地展示两个版本以及样板文本和/或通知第二个和后续提交者他们的帖子内容可能与他们提交的内容有所不同.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T22:07:42.480

好吧，我认为那将是一个可怕的想法。老实说：合并在代码中是相当冒险的，而且至少有可能被隔离的元素。不要这样做——人类的智慧总是会更好。相反，您试图用自动解决方案替换它，这可能会导致输出不正常，没有任何好处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T22:08:38.203

在研究 TWiki 答案时，我还偶然发现了[SynchroEdit](http://synchroedit.com/)，它似乎是一个基于[SubEthaEdit](http://www.codingmonkeys.de/subethaedit/)风格的基于浏览器的同步多用户编辑器。看起来它可能已在 2007 年 9 月左右被放弃，但有源代码可供下载。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T05:14:25.220

出于文档考虑：[DokuWiki](http://www.dokuwiki.org/dokuwiki)对已编辑的页面设置了 15 分钟的锁定，每当您预览您的编辑时（即从您的预览或编辑开始后 15 分钟），该锁定就会更新。

# ssl - 处理 SChannel 中的 SEC_I_RENEGOTIATE 和 TLS1_ALERT_NO_RENEGOTIATION

> ID：223044
> 
> 赞同：5
> 
> 时间：2008-10-21T18:55:51.010
> 
> 标签：ssl, schannel

我目前正在与 SChannel 合作开发基于异步 (IOCP) 的服务器，我的大部分工作都正常，但我在重新协商时遇到了问题。具体来说，当对等点 A 向对等点 B 发送重新协商请求并且对等点 B 以 TLS1`NO RENEGOTIATION`警报响应时，对等点 A 如何继续？我在收到`SEC_I_NO_RENEGOTIATION`响应时似乎有一个无效的上下文，这使我无法继续使用流...

**更新**我已经做了一些更多的测试，它似乎不是一个无效的上下文，但我确实`SEC_E_ENCRYPT_FAILURE`从下一次调用 Encrypt 中得到......

重新谈判的请求真的可以拒绝吗？还是`NO RENEGOTIATION`alert 只是一条信息性错误消息，现在意味着连接无用？如果是这样，为什么将其评论为“警告”而不是“错误”？没有; TLS RFC (5246) 明确指出，在没有重新协商警报后，我们是否可以继续由对等方决定......

**更新**如果我使用...发送 TLS 警报没有任何区别`ApplyControlToken() `or if I send it using EncryptMessage()` with SECQOP_WRAP_OOB_DATA`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-21T18:50:27.183

不久前，针对基于 Intel AMT 的硬件发布了一个 HOTFIX。本质上，根证书存储为 SHA-1 哈希，而不是缓存整个证书。SSPI 通过除根以外的所有证书，期望根拥有此证书以进行信任链验证。当完整的根不存在时，SSPI 会强制重新协商。

此修补程序更新安装了 Intel AMT 的 Win 2003 系统上的 schannel。

查看此知识库： http: [//support.microsoft.com/kb/942841](http://support.microsoft.com/kb/942841)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T08:32:58.017

可能这会对您有所帮助：[代码项目：SSLSocket](http://www.codeproject.com/KB/IP/sslsocket.aspx)。

# vba - 查找 CorelDraw Web 链接

> ID：223052
> 
> 赞同：4
> 
> 时间：2008-10-21T18:58:25.170
> 
> 标签：vba, url, hyperlink, coreldraw

有谁知道如何在 CorelDraw 文档中获取 Web 链接？我在 Windows 上使用 CorelDraw 13 X3，它带有链接管理器和 VBA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T20:32:25.480

看起来下面会得到一个形状的地址。

```
Dim s As Shape
  For Each s In ActiveDocument.ActivePage.Shapes
   s.URL.Address ....
  Next s
End Sub 
```

# c# - 如何继承构造函数？

> ID：223058
> 
> 赞同：189
> 
> 时间：2008-10-21T18:59:47.537
> 
> 标签：c#, inheritance, constructor

***想象***一个有许多构造函数和一个虚方法的基类

```
public class Foo
{
   ...
   public Foo() {...}
   public Foo(int i) {...}
   ...
   public virtual void SomethingElse() {...}
   ...
} 
```

现在我想创建一个覆盖虚拟方法的后代类：

```
public class Bar : Foo 
{
   public override void SomethingElse() {...}
} 
```

还有另一个做更多事情的后代：

```
public class Bah : Bar
{
   public void DoMoreStuff() {...}
} 
```

我真的必须将所有构造函数从 Foo 复制到 Bar 和 Bah 吗？然后，如果我在 Foo 中更改构造函数签名，我是否必须在 Bar 和 Bah 中更新它？

有没有办法继承构造函数？有没有办法鼓励代码重用？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2008-10-21T19:01:56.723

是的，您必须实现对每个派生有意义的构造函数，然后使用`base`关键字将该构造函数指向适当的基类，或者使用`this`关键字将构造函数指向同一类中的另一个构造函数。

如果编译器对继承构造函数做出假设，我们将无法正确确定我们的对象是如何实例化的。在大多数情况下，您应该考虑为什么有这么多构造函数，并考虑将它们减少到基类中的一两个。然后，派生类可以使用常量值屏蔽其中的一些，`null`并且只通过它们的构造函数公开必要的值。

# 更新

在 C#4 中，您可以指定默认参数值并使用命名参数来使单个构造函数支持多个参数配置，而不是每个配置都有一个构造函数。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2008-10-21T19:03:30.293

387个构造函数？？那是你的主要问题。这个怎么样？

```
public Foo(params int[] list) {...} 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2008-10-21T19:03:09.590

是的，您必须复制所有 387 个构造函数。您可以通过重定向它们来进行一些重用：

```
 public Bar(int i): base(i) {}
  public Bar(int i, int j) : base(i, j) {} 
```

但这是你能做的最好的。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2009-04-11T05:50:18.737

太糟糕了，我们不得不告诉编译器显而易见的事情：

```
Subclass(): base() {}
Subclass(int x): base(x) {}
Subclass(int x,y): base(x,y) {} 
```

我只需要在 12 个子类中做 3 个构造函数，所以没什么大不了的，但我不太喜欢在每个子类上重复，因为我已经习惯了不用写这么久。我确信这是有正当理由的，但我认为我从未遇到过需要这种限制的问题。

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2008-10-21T20:49:53.587

不要忘记，您还可以将构造函数重定向到同一继承级别的其他构造函数：

```
public Bar(int i, int j) : this(i) { ... }
                            ^^^^^ 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2011-11-15T22:14:58.637

另一个简单的解决方案是使用包含参数作为属性的结构或简单数据类；这样，您可以提前设置所有默认值和行为，将“参数类”作为单个构造函数参数传递：

```
public class FooParams
{
    public int Size...
    protected myCustomStruct _ReasonForLife ...
}
public class Foo
{
    private FooParams _myParams;
    public Foo(FooParams myParams)
    {
          _myParams = myParams;
    }
} 
```

这避免了多个构造函数（有时）的混乱，并提供了强类型、默认值和参数数组不提供的其他好处。这也使得继承变得容易，因为从 Foo 继承的任何东西仍然可以根据需要到达，甚至添加到 FooParams。您仍然需要复制构造函数，但您总是（大部分时间）仅（作为一般规则）曾经（至少，目前）需要一个构造函数。

```
public class Bar : Foo
{
    public Bar(FooParams myParams) : base(myParams) {}
} 
```

我真的更喜欢重载的 Initialize() 和 Class Factory Pattern 方法，但有时你只需要一个智能构造函数。只是一个想法。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-10-21T21:03:46.680

作为`Foo`一个类，你不能创建虚拟重载`Initialise()`方法吗？那么它们将可用于子类并且仍然可以扩展？

```
public class Foo
{
   ...
   public Foo() {...}

   public virtual void Initialise(int i) {...}
   public virtual void Initialise(int i, int i) {...}
   public virtual void Initialise(int i, int i, int i) {...}
   ... 
   public virtual void Initialise(int i, int i, ..., int i) {...}

   ...

   public virtual void SomethingElse() {...}
   ...
} 
```

这不应该有更高的性能成本，除非您有很多默认属性值并且您经常使用它。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-09-30T14:20:40.047

```
public class BaseClass
{
    public BaseClass(params int[] parameters)
    {

    }   
}

public class ChildClass : BaseClass
{
    public ChildClass(params int[] parameters)
        : base(parameters)
    {

    }
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-07-21T23:49:42.757

我个人认为这是微软的一个错误，他们应该允许程序员覆盖基类中构造函数、方法和属性的可见性，然后使其始终继承构造函数。

这样，我们只需简单地覆盖（以较低的可见性 - 即私有）我们不想要的构造函数，而不必添加我们想要的所有构造函数。Delphi 就是这样做的，我很怀念它。

举个例子，如果你想重写 System.IO.StreamWriter 类，你需要将所有 7 个构造函数添加到你的新类中，如果你喜欢注释，你需要用标题 XML 注释每个构造函数。更糟糕的是，元数据视图不会将 XML 注释作为正确的 XML 注释，因此我们必须逐行复制并粘贴它们。微软在这里是怎么想的？

我实际上编写了一个小实用程序，您可以在其中粘贴元数据代码，它会使用覆盖的可见性将其转换为 XML 注释。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-07-14T18:36:45.800

> 我真的必须将所有构造函数从 and 复制`Foo`到`Bar`and`Bah`吗？然后，如果我在 中更改构造函数签名`Foo`，我是否必须在`Bar`和中更新它`Bah`？

是的，如果您使用构造函数来创建实例。

> 有没有办法继承构造函数？

没有。

> 有没有办法鼓励代码重用？

好吧，我不会讨论继承构造函数是好事还是坏事，以及它是否会鼓励代码重用，因为我们没有它们，我们也不会得到它们。:-)

但是在 2014 年，使用当前的 C#，您可以通过使用泛型方法来获得非常*类似于继承构造函数的东西。*`create`随身携带它可能是一个有用的工具，但你不会轻易伸手去拿它。我最近在面临需要将某些内容传递给用于数百个派生类的基类型的构造函数时（直到最近，基不需要任何参数，因此默认构造函数很好 - 派生类根本没有声明构造函数，而是获得了自动提供的构造函数）。

它看起来像这样：

```
// In Foo:
public T create<T>(int i) where: where T : Foo, new() {
    T obj = new T();
    // Do whatever you would do with `i` in `Foo(i)` here, for instance,
    // if you save it as a data member;  `obj.dataMember = i;`
    return obj;
} 
```

也就是说，您可以`create`使用类型参数调用泛型函数，该类型参数是`Foo`具有零参数构造函数的任何子类型。

然后，而不是做`Bar b new Bar(42)`，你会这样做：

```
var b = Foo.create<Bar>(42);
// or
Bar b = Foo.create<Bar>(42);
// or
var b = Bar.create<Bar>(42); // But you still need the <Bar> bit
// or
Bar b = Bar.create<Bar>(42); 
```

我已经展示了直接开启的`create`方法`Foo`，但当然它可以在某种工厂类中，如果它设置的信息可以由该工厂类设置。

只是为了清楚起见：名称`create`并不重要，它可以是`makeThingy`或您喜欢的任何其他内容。

完整示例

```
using System.IO;
using System;

class Program
{
    static void Main()
    {
        Bar b1 = Foo.create<Bar>(42);
        b1.ShowDataMember("b1");

        Bar b2 = Bar.create<Bar>(43); // Just to show `Foo.create` vs. `Bar.create` doesn't matter
        b2.ShowDataMember("b2");
    }

    class Foo
    {
        public int DataMember { get; private set; }

        public static T create<T>(int i) where T: Foo, new()
        {
            T obj = new T();
            obj.DataMember = i;
            return obj;
        }
    }

    class Bar : Foo
    {
        public void ShowDataMember(string prefix)
        {
            Console.WriteLine(prefix + ".DataMember = " + this.DataMember);
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-10-21T19:08:19.877

问题不在于 Bar 和 Bah 必须复制 387 个构造函数，问题在于 Foo 有 387 个构造函数。Foo 显然做了太多的事情 - 快速重构！此外，除非您有充分的理由在构造函数中设置值（如果您提供无参数构造函数，则可能不会），我建议您使用属性获取/设置。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-21T19:15:58.550

不，您不需要将所有 387 个构造函数复制到 Bar 和 Bah。Bar 和 Bah 可以拥有任意数量的构造函数，与在 Foo 上定义的数量无关。例如，您可以选择仅使用一个 Bar 构造函数来使用 Foo 的第 212 个构造函数构造 Foo。

是的，您在 Foo 中更改 Bar 或 Bah 所依赖的任何构造函数都需要您相应地修改 Bar 和 Bah。

不，.NET 中没有办法继承构造函数。但是您可以通过在子类的构造函数中调用基类的构造函数或调用您定义的虚拟方法（如 Initialize()）来实现代码重用。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-21T19:17:04.163

您可能能够适应[C++ 虚拟构造函数 idiom](http://www.parashift.com/c++-faq-lite/virtual-functions.html#faq-20.8)的一个版本。据我所知，C# 不支持协变返回类型。我相信这在许多人的愿望清单上。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-21T19:05:58.413

太多的构造函数是设计失败的标志。更好的类具有很少的构造函数和设置属性的能力。如果您确实需要控制属性，请考虑在同一名称空间中创建工厂并将属性设置器设置为内部。让工厂决定如何实例化类并设置其属性。工厂可以有一些方法，这些方法可以根据需要使用尽可能多的参数来正确配置对象。

# c# - 如何在 C# 中的随机端口上创建 HttpListener 类？

> ID：223063
> 
> 赞同：32
> 
> 时间：2008-10-21T19:00:24.213
> 
> 标签：c#, httplistener, embeddedwebserver

我想创建一个在内部为网页提供服务的应用程序，并且可以在同一台机器上的多个实例中运行。为此，我想创建一个`HttpListener`侦听以下端口的端口：

1.  随机选择
2.  目前未使用

本质上，我想要的是：

```
mListener = new HttpListener();
mListener.Prefixes.Add("http://*:0/");
mListener.Start();
selectedPort = mListener.Port; 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2010-10-20T12:55:46.973

如果绑定到端口 0，TcpListener 将找到一个随机未使用的端口来监听。

```
public static int GetRandomUnusedPort()
{
    var listener = new TcpListener(IPAddress.Any, 0);
    listener.Start();
    var port = ((IPEndPoint)listener.LocalEndpoint).Port;
    listener.Stop();
    return port;
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-21T19:38:45.603

像这样的东西怎么样：

```
 static List<int> usedPorts = new List<int>();
    static Random r = new Random();

    public HttpListener CreateNewListener()
    {
        HttpListener mListener;
        int newPort = -1;
        while (true)
        {
            mListener = new HttpListener();
            newPort = r.Next(49152, 65535); // IANA suggests the range 49152 to 65535 for dynamic or private ports.
            if (usedPorts.Contains(newPort))
            {
                continue;
            }
            mListener.Prefixes.Add(string.Format("http://*:{0}/", newPort));
            try
            {
                mListener.Start();
            }
            catch
            {
                continue;
            }
            usedPorts.Add(newPort);
            break;
        }

        return mListener;
    } 
```

我不确定您如何找到该机器上正在使用的所有端口，但是如果您尝试侦听已被使用的端口，您应该会遇到异常，在这种情况下，该方法将简单地选择另一个港口。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-10-10T12:06:37.903

这是一个来自[Snooganz 的答案的答案](https://stackoverflow.com/a/223188/24874)。它避免了可用性测试和后续绑定之间的竞争条件。

```
public static bool TryBindListenerOnFreePort(out HttpListener httpListener, out int port)
{
    // IANA suggested range for dynamic or private ports
    const int MinPort = 49215;
    const int MaxPort = 65535;

    for (port = MinPort; port < MaxPort; port++)
    {
        httpListener = new HttpListener();
        httpListener.Prefixes.Add($"http://localhost:{port}/");
        try
        {
            httpListener.Start();
            return true;
        }
        catch
        {
            // nothing to do here -- the listener disposes itself when Start throws
        }
    }

    port = 0;
    httpListener = null;
    return false;
} 
```

在我的机器上，这种方法平均需要 15 毫秒，这对于我的用例来说是可以接受的。希望这对其他人有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-08T06:51:19.050

不幸的是，这是不可能的。正如 Richard Dingwall 已经建议的那样，您可以创建一个 TCP 侦听器并使用该端口。这种方法有两个可能的问题：

*   理论上可能会出现竞争条件，因为另一个 TCP 侦听器可能会在关闭此端口后使用它。
*   如果您不是以管理员身份运行，那么您需要分配前缀和端口组合以允许绑定到它。如果您没有管理员权限，这是无法管理的。从本质上讲，这将要求您需要以管理员权限运行 HTTP 服务器（这通常是一个坏主意）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-29T14:20:33.197

由于您使用的是 HttpListener（因此使用 TCP 连接），您可以使用对象`GetActiveTcpListeners`的方法获取活动 TCP 侦听器的列表`IPGlobalProperties`并检查它们的`Port`属性。

可能的解决方案可能如下所示：

```
private static bool TryGetUnusedPort(int startingPort, ref int port)
{
    var listeners = IPGlobalProperties.GetIPGlobalProperties().GetActiveTcpListeners();

    for (var i = startingPort; i <= 65535; i++)
    {
        if (listeners.Any(x => x.Port == i)) continue;
        port = i;
        return true;
    }

    return false;
} 
```

此代码将从`startingPort`端口号开始找到第一个未使用的端口并返回`true`。如果所有端口都已被占用（这不太可能），则该方法返回`false`.

还要记住，当其他进程在您之前占用找到的端口时，可能会发生竞争条件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-25T17:55:51.380

我建议尝试[Grapevine](http://www.nuget.org/packages/Grapevine/)。它允许您在应用程序中嵌入 REST/HTTP 服务器。它包括一个`RestCluster`类，允许您`RestServer`在一个地方管理所有实例。

将每个实例设置为使用随机的开放端口号，如下所示：

```
using (var server = new RestServer())
{
    // Grab the next open port (starts at 1)
    server.Port = PortFinder.FindNextLocalOpenPort();

    // Grab the next open port after 2000 (inclusive)
    server.Port = PortFinder.FindNextLocalOpenPort(2000);

    // Grab the next open port between 2000 and 5000 (inclusive)
    server.Port = PortFinder.FindNextLocalOpenPort(200, 5000);
    ...
} 
```

入门指南：[https ://sukona.github.io/Grapevine/en/getting-started.html](https://sukona.github.io/Grapevine/en/getting-started.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-15T20:28:52.980

我不相信这是可能的。UriBuilder.Port 的文档指出，“如果未将端口指定为 URI 的一部分，...协议方案的默认端口值将用于连接到主机。”。

请参阅[https://msdn.microsoft.com/en-us/library/system.uribuilder.port(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.uribuilder.port(v=vs.110).aspx)

# asp.net - 如何查找显示网页的窗口的垂直大小

> ID：223064
> 
> 赞同：1
> 
> 时间：2008-10-21T19:00:29.940
> 
> 标签：asp.net, javascript

我有一个只有一个母版页的 ASP.NET 站点。在此站点的一个页面上，我将 PDF 文件显示为页面内容。

我需要一种方法来知道我可以制作 PDF 控件的大小，这样我就不会为网页创建滚动条（PDF 控件有它自己的滚动条）。

我可以通过将控件的宽度设置为 100% 来水平解决这个问题。遗憾的是，这不适用于垂直尺寸。

任何帮助表示赞赏。

瓦卡诺

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T19:09:30.153

无法确定此服务器端，因此您需要使用 JavaScript。我推荐[jQuery Dimensions 插件](http://plugins.jquery.com/project/dimensions)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T19:12:11.383

但是，如果您确实使用 JavaScript，则有一种解决方法，您可以将该值放入 HiddenField（当然 JavaScript 将其视为输入），然后单击提交按钮，这一切都在幕后进行。如果您使用 UpdatePanel，您可能无需用户干预即可完成部分回发。

对于按钮点击，查看 Document.Forms[0].btnMyButton.Click();。

# database - 软件数据库

> ID：223070
> 
> 赞同：0
> 
> 时间：2008-10-21T19:02:13.353
> 
> 标签：database

我正在寻找常用安装的 Windows 软件的数据库。至少我需要软件的名称和可执行文件的名称，但最好有发布者和公共安装路径等。基本上，我希望能够查询它以找到所有软件通过 Adob​​e 和相关的可执行文件名称等。

基本上我希望能够做到

```
SELECT * FROM Software WHERE Publisher = 'Microsoft' 
SELECT * FROM Software WHERE Executable = 'devenv.com' 
```

我很久以前就尝试过创建这样一个数据库，但现在似乎找不到。也许它失败了。任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-21T19:24:19.407

最好的办法是[查询](http://www.developer.com/net/asp/article.php/3079381)amazon.com，因为他们出售大量软件并提供公共接口来访问他们的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T18:32:43.237

[因此，有人在 reddit ( http://www.reddit.com/r/programming/comments/7civs/ask_prog_where_can_i_find_lists_of_data_in_useful/](http://www.reddit.com/r/programming/comments/7civs/ask_prog_where_can_i_find_lists_of_data_in_useful/) )上提出了一个问题，其中包含我正在寻找的原始网站。

任何寻找一般信息数据库（包括我正在寻找的软件数据库）的人都可以在[http://www.freebase.com/](http://www.freebase.com/)上找到它。

[在http://infochimps.org/、http://theinfo.org/](http://infochimps.org/)和[http://www.datawrangling.com/some-datasets-available-on-the-web](http://theinfo.org/)上还有一些其他有趣的开放[数据库](http://www.datawrangling.com/some-datasets-available-on-the-web)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-18T08:09:56.707

安全公司 Secunia 有一个名为[Secunia PSI](http://secunia.com/vulnerability_scanning/personal/)的工具，它试图列出 Windows 计算机上的所有软件，并根据已知漏洞的数据库对其进行检查，这样你就可以让你的东西保持最新。这可能与您尝试做的事情有一些重叠。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-05T05:30:34.740

如果有人也在寻找，请尝试[wikidata.org](https://wikidata.org) - 他们有一个很棒的[在线查询编辑器](https://query.wikidata.org)，您可以使用它来探索数据集。

快速查询 13155 个软件的列表以及相关的编程语言和操作系统（不幸的是，有很多空白和重复，但仍然非常可行）：

```
SELECT ?monarch ?monarchLabel ?programming_language ?programming_languageLabel ?operating_system ?operating_systemLabel WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }
  { ?monarch wdt:P31 wd:Q7397\. } UNION { ?monarch wdt:P31 wd:Q40056\. }
  OPTIONAL { ?monarch wdt:P277 ?programming_language. }
  OPTIONAL { ?monarch wdt:P306 ?operating_system. }
} 
```

根据您要查找的内容，您可能希望通过添加更多联合案例来包含网站或其他类别，或者添加更多属性（查询编辑器有很好的建议，例如*developer*、*license*和*use*）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T19:23:48.067

您可以对一些包含**软件列表的网站进行一些****屏幕抓取**，并为自己建立一个包含所有软件和发布者的数据库。

 **这是一些包含一些软件列表的网站：

*   [http://www.digital-digest.com/software/index.php](http://www.digital-digest.com/software/index.php)
*   [http://www.bestshareware.net/allsoftware-w.htm](http://www.bestshareware.net/allsoftware-w.htm)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-09T15:37:36.180

这是与 windows vista 兼容的应用程序列表。

microsoft 那里有一个 excel 表，您可以找到更多的软件产品。

[http://www.iexbeta.com/wiki/index.php/Windows_Vista_Software_Compatibility_List](http://www.iexbeta.com/wiki/index.php/Windows_Vista_Software_Compatibility_List)

希望这可以帮助

# c# - 禁用调试输出

> ID：223085
> 
> 赞同：5
> 
> 时间：2008-10-21T19:08:04.027
> 
> 标签：c#, .net, debugging, console

我想在我的代码中添加一些打印语句来显示我的位置并将重要的值打印到控制台窗口。

我该怎么做，但随后可以为发布版本关闭它？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-21T19:09:40.450

[`System.Diagnostics.Debug.Print()`](http://msdn.microsoft.com/en-us/library/system.diagnostics.debug.print.aspx)当您切换到发布版本时，所有调用都将被删除。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-21T19:10:32.213

使用[Log4net](http://logging.apache.org/log4net/index.html)在发布中的调试级别和生产中的警告或错误级别进行日志记录。

这样做的好处是，如果您在发布环境中遇到无法在开发中重新创建的问题，您可以在发布环境中重新打开日志记录。

[编辑] FWIW，我发现现在我使用测试驱动开发，我做的调试日志少了**很多。**我的大部分日志记录都是警告/错误类型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-21T19:10:17.173

查看 System.Diagnostics.Debug 和 System.Diagnostics.Trace 类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T19:43:05.157

调试和跟踪是相关但不同的活动。命名空间同时`System.Diagnostics`支持它们。

用于`Debug.Write/WriteLine`将调试消息写入日志文件。（然后到输出窗口。）`Debug.Assert`嗯，几乎无处不在。`Debug`如果您没有在代码中定义 DEBUG 符号，则在编译之前使用该类编写的所有代码都将被删除 - 默认情况下，这是在 Debug 和 Release 配置选项中完成的。

用于`Trace.Write/WriteLine`编写跟踪消息。这些方法在功能上等同于 Debug 类的方法；不同之处在于，如果您未在代码中定义 TRACE 符号，它们将被删除。

Debug 和 Trace 类还具有其他类的整体略显繁琐的基础结构，例如`TextWriterTraceListener`，它允许您做一些漂亮的事情，例如将跟踪日志的输出从磁盘上的本地文件更改为 Web 服务（或什么都没有）通过编辑应用程序配置文件。我最喜欢的技巧是实现`TextWriter`可以将文本写入 a 的 a `TextBox`，并使用它将所有调试和跟踪输出重定向到 UI。

您还可以在应用程序配置文件中设置`WriteIf`和`WriteLineIf`方法尊重的标志，但根据我的经验，这些标志非常笨拙。

我发现一般来说，如果我构建自己的静态类来包装`Trace`方法，我会更开心。这让我可以通过设置我的类的属性来执行诸如在 UI 中打开和关闭跟踪之类的操作`Trace`。

最后：如果您需要在每个方法开始和结束时对您的应用程序执行类似跟踪之类的操作，那么可以使用神奇的 PostSharp 工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T19:37:49.770

我使用：[System.Console.WriteLine()](http://msdn.microsoft.com/en-us/library/system.console.writeline.aspx "System.Console.WriteLine()")

```
#if DEBUG
  System.Console.WriteLine("Message");
#endif 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T19:59:16.263

您还可以查看面向方面的编程解决方案。他们在这种事情上做得非常好。将 PostSharp 视为一个很好的实现。他们的示例代码通常包含一个您正在寻找的示例。

# php - 在 html 或 php 中创建客户端可编辑的事件日历

> ID：223089
> 
> 赞同：2
> 
> 时间：2008-10-21T19:09:11.590
> 
> 标签：php, html, wordpress, calendar

潜在客户希望在其网站上具有日历功能。他们希望选择去编辑此日历以更新事件。Word Press 是否提供类似的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T21:51:59.140

我见过人们为此使用谷歌日历。然后，您可以轻松地将 google cal 嵌入到您的网页中。此外，如果其他人使用 Google Cal，他们可以将事件添加到他们的日历中。

[http://www.google.com/support/calendar/bin/answer.py?hl=en&answer=41207](http://www.google.com/support/calendar/bin/answer.py?hl=en&answer=41207)

更新：如果您正在寻找这个插件，看起来这个插件将有助于将 google cal 导入 Wordpress：

[伍格卡尔](http://www.blueace.nl/wooglecal/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T19:56:40.467

听起来你可能正在搜索[这个](http://wordpress.org/extend/plugins/event-calendar/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T19:30:30.563

我不确定 Wordpress 是否具有该功能，但我知道 PHP 的 Calendar 类相当简单、易于实现且非常易于设置样式。[在这里](http://oscarm.org/page/calendarClass/)查看教程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T22:15:43.040

还有一个用于日历的 PEAR 包：http: [//pear.php.net/package/calendar](http://pear.php.net/package/calendar)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T22:34:36.433

我支持可嵌入的谷歌日历。它们非常易于管理并将其添加到 HTML 中。如果您正在寻找特定于 Wordpress 的解决方案，请特别查看[这个插件](http://wordpress.org/extend/plugins/calendar/)。

# javascript - 我想用 Javascript 编写桌面 OSX 或 Windows 应用程序——有什么经验吗？

> ID：223092
> 
> 赞同：7
> 
> 时间：2008-10-21T19:10:16.940
> 
> 标签：javascript, user-interface, desktop, portability

我想为 Windows 和 OSX 编写一些小应用程序。

便携很好。例如，如果我能够长时间地观察 Tcl，那么用于 TCL 的简单 TclKit 解决方案就会很好地工作。

我正在考虑使用 Javascript + 扩展——我真的很喜欢 Javascript——在我看来应该有某种方法可以将 Javascript 引擎连接到 WxWin 甚至 Tk 工具集——它已经为 Perl、Python、Ruby 等完成了。为什么不是 JS？

任何意见表示赞赏。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-21T19:20:10.663

我宁愿推荐使用[Adob​​e Air](http://www.adobe.com/products/air/)执行容器，与 Microsoft 的 HTA 甚至Mozilla的[XULRunner相比，它提供了更多的功能/操作系统集成功能。](http://developer.mozilla.org/en/XULRunner)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-21T19:13:43.627

如果您想用 Javascript 编写桌面应用程序，请查看 HTA：http: [//msdn.microsoft.com/en-us/library/ms536496 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms536496(VS.85).aspx)

这是我很久以前在 HTA 中编写的应用程序示例：http: [//www.boltbait.com/htmleditor/](http://www.boltbait.com/htmleditor/)

希望这可以帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-21T20:36:35.160

如果您有使用 HTML+JS Web 应用程序的经验，我会推荐 Mozilla XULRunner。它为您提供了具有原生外观的界面小部件（Firefox 界面的每个部分都是一个 XUL 元素），以及类似于构建基于 HTML 的界面的工作流程。

您使用基于 XML 的语言 XUL 定义界面，因此它几乎就像编写 HTML 一样，减去浏览器不兼容性和 CSS（您可以使用 CSS，但前提是您需要）。所有应用程序逻辑都可以用 JavaScript 编写，但在 XULRunner 中，您可以在 JS 中做比在浏览器中更多的事情（读/写文件、执行系统命令、进行跨域 XMLHTTPRequest 以及许多其他事情）。

更多：http: [//xulplanet.com/](http://xulplanet.com/)

很多示例应用程序：[http ://code.google.com/p/xulapps/](http://code.google.com/p/xulapps/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T21:02:51.160

Mac OS X 用户倾向于不喜欢不遵循平台可用性指南的应用程序（菜单必须位于屏幕顶部，标准快捷方式和拖放必须有效，“OK”必须位于右侧警报框，首选项中没有“应用”按钮等等）。

使用一刀切的工具包，这可能很难实现。

好消息是[JavaScript<>Cocoa](http://inexdo.com/JSCocoa)桥可用于在 JS 中创建独立的全功能 Mac OS X 应用程序——只需将应用程序的前端和后端保持足够分离，以便能够插入不同的每个操作系统的 UI。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T19:20:44.080

[Rhino](http://www.mozilla.org/rhino/)可能会让你获得摇摆。不过，我不知道会涉及多少工作。

另一方面，使用 JRuby 构建一个摇摆应用程序非常容易[，即使是袜子木偶也可以做到](http://www.artima.com/weblogs/viewpost.jsp?thread=220459)，所以*应该不会*太难。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T20:38:18.540

如果您想使用 JavaScript 来实现它，Adobe Air 绝对是您的不二之选。您甚至可以在 Linux 上获得支持。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-06T16:13:07.253

给 Titanium Appceletaror 看看： http: [//www.appcelerator.com/](http://www.appcelerator.com/)。

# reporting-services - 如何以高分辨率将 SSRS 图表导出为 PDF？

> ID：223094
> 
> 赞同：5
> 
> 时间：2008-10-21T19:10:20.793
> 
> 标签：reporting-services

我有一个带有条形图的简单 SQL Server 2005 Reporting Services 报告。当我直接从 Visual Studio 中的预览窗口打印时，一切看起来都不错，但如果我将报告导出到 PDF 文件并打印出来，那么标签甚至一些垂直线都会出现像素化。如何提高 PDF 导出的分辨率？

编辑：

设置`HumanReadablePDF=True`使 PDF 更大（4 mb vs. 20 kb），但图表看起来仍然相同。

我可以直接从预览窗口打印到 PDF 文件（使用 PrimoPDF）并且图表看起来不错——也许有一种方法可以代替使用 SSRS 导出功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T02:08:15.347

尝试弄乱设备信息设置，尤其是 HumanReadiblePdf 属性。 [http://msdn.microsoft.com/en-us/library/ms154682.aspx](http://msdn.microsoft.com/en-us/library/ms154682.aspx)
IIRC 该设置实际上与文档暗示的压缩方式相反。

也看看这里：http: [//blogs.msdn.com/donovans/pages/reporting-services-pdf-renderer-faq.aspx](http://blogs.msdn.com/donovans/pages/reporting-services-pdf-renderer-faq.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T19:23:33.683

看来这仍然是**SSRS 2008 R2**中的一个问题。解决方法是将我的图像从**PNG**更改为**JPEG**。 **@DanielAuger**通过他的最后一个链接朝着正确的方向前进。我在这里再次将它的标题包括在内：

## [Reporting Services：PDF 渲染器常见问题解答](http://blogs.msdn.com/b/donovans/archive/2007/07/20/reporting-services-pdf-renderer-faq.aspx)

* * *

我的答案在上述链接底部的以下摘录中找到：

> ## 我没有在本地模式下使用控件，我的 PDF 仍然很大。为什么？
> 
> **如果您的 PDF 包含图表或 PNG 图像**，则这些图像可能会在添加到 PDF 文件之前转换为位图。尽管此位图数据将被重新压缩，但它不会像原始图像那样节省空间。为避免这种转换，请**使用颜色类型为 3 的 JPEG 图像**或 PNG 文件（PNG 颜色类型信息可在[http://en.wikipedia.org/wiki/PNG](http://en.wikipedia.org/wiki/PNG)找到）。
> 
> 在 Reporting Services 2005 SP1 之前，允许使用其他颜色类型的 PNG 图像。不幸的是，为了修复**导致某些 PNG 在呈现为 PDF 时出现损坏**的错误，我们需要添加颜色类型限制。更不幸的是，图表作为高 DPI 的非颜色类型 3 PNG 发送到 PDF 渲染器。这当然是我们希望在未来消除的限制，但它不太可能在 Reporting Services 2005 中修复。*。
> 
> [***注意：强调我的。***]

# sql - 在 oracle.sql.TIMESTAMPTZ 和 DbUnit 的标准 JDBC 类之间进行转换

> ID：223096
> 
> 赞同：2
> 
> 时间：2008-10-21T19:11:25.533
> 
> 标签：sql, oracle, datetime, jdbc, dbunit

我正在运行 Oracle 10g 并有带有 Type_Name 的列

```
带有时区的时间戳（6）
```

当膨胀成java类时，它们会变成

```
oracle.sql.TIMESTAMPTZ
```

但是 DbUnit 无法处理将 Oracle 特定类转换为字符串以写入 XML。我想知道是否有任何简单的方法可以让我将这些 Oracle 特定时间戳（例如，在我的 SELECT 语句中）从这些 Oracle 特定时间戳转换为 java.sql 中的某些内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T21:04:04.260

我不必完全处理这个问题，但我认为将它作为 SELECT 查询中的字符串通过就可以了。

您可以使用[to_char](http://download.oracle.com/docs/cd/B28359_01/olap.111/b28126/dml_functions_2113.htm)函数。将其转换为字符串。例如：

```
SQL> select to_char(systimestamp, 'YYYY-MM-DD HH24:MI:SS.FF TZD') as d from dual;

D
----------------------------------
2008-10-21 17:00:43.501591 
```

然后，您的程序会将其视为字符串。`TZD`包括时区信息（本例中没有时区信息）

稍后，Java 可以使用[SimpleDateFormat](http://java.sun.com/j2se/1.3/docs/api/java/text/SimpleDateFormat.html)类对其进行解析。

或者，[oracle.sql.TIMESTAMPTZ](https://docs.oracle.com/cd/E11882_01/appdev.112/e13995/oracle/sql/TIMESTAMPTZ.html)类有一个调用方法，该方法`dateValue`返回一个`java.sql.Date`类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-12T14:18:57.753

我想指出，除非您真的想获得 ISO 年份，否则使用 IYYY 作为年份格式可能不是一个好主意。您应该使用 YYYY 而不是 IYYY。

尝试使用 31.12.2012 运行您的 SQL

```
select to_char(timestamp'2012-12-31 00:00:00 +00:00', 'IYYY-MM-DD HH24:MI:SS.FF TZD') as d from dual; 
```

返回“2013-12-31 00:00:00.000000000”，这不是您期望的年份。

# javascript - 您在哪里记录 Web 应用程序中表单数据的验证规则？

> ID：223097
> 
> 赞同：11
> 
> 时间：2008-10-21T19:11:32.257
> 
> 标签：javascript, design-patterns, validation

假设您有一个 Web 表单，其中包含一些您想要验证为只是字母数字子集、最小或最大长度等的字段。

您可以使用 javascript 在客户端进行验证，您可以将数据发送回服务器并通过 ajax 或不通过 ajax 向用户报告。您可以在数据库中拥有验证规则，并以这种方式将错误消息推送给用户。

或以上所有的任何组合。

如果您想要一个地方来保存持久化到数据库的 Web 应用程序用户数据的验证规则，那么有哪些最佳实践、模式或一般的好建议？

[编辑]

我已经编辑了问题标题以更好地反映我的实际问题！顺便说一句，到目前为止有一些很好的答案。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-21T19:13:26.013

上述所有的：

1.  客户端验证对用户来说更方便
2.  但你不能信任客户端，所以代码隐藏也应该验证
3.  同样，数据库不能相信您已验证，所以也在那里验证

编辑：我看到您已编辑问题以要求验证规则的单点规范。这被称为“数据字典”（DD），拥有并用于在不同层中生成验证规则是一件好事。然而，大多数系统都没有，所以如果你从来没有时间去构建这样的东西，不要感到难过；-)

现代 3 层系统的 DD 的一种可能/简单设计可能只包括 - 连同通常的 max-size/min-size/datatype 信息 - Javascript 表达式/函数字段、C# 程序集/类/方法字段（s ) 和一个 sql 表达式字段。javascript 可以插入客户端验证，C# 信息可以用于服务器端验证的反射加载/调用，sql 表达式可以用于数据库验证。

但是，虽然这在理论上都很好，但我不知道有任何现实世界的系统在实践中真正做到这一点[尽管它“听起来”像是一个好主意]。

如果你这样做了，请告诉我们进展如何！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-21T20:08:08.960

要回答实际问题：

首先，数据库限制并不总是与客户端限制相匹配。因此，将自己限制为仅基于数据库约束进行验证可能是一个坏主意。

但是话又说回来，您确实希望数据库约束反映在您的数据模型中。因此，第一个近似值可能是定义一些可映射到检查约束、系统语言和 javascript 的谓词。

要么这样，要么您只需注意将三个表示保持在同一个位置，以便在更改某些内容时记住使它们保持同步。

但是假设您确实想要在域模型不够严格的特定上下文中使用另一组限制，或者可能是模型中根本没有的数据。如果您可以使用用于定义模型限制的相同框架来定义其他类型的限制，这可能是一个好主意。

也许要走的路是为描述限制的谓词定义一个小的可管理的 DSL。然后你生成解析这个 DSL 并提供你需要的表示的“编译器”。

“DSL”不必那么花哨，简单的字符串和 int 验证也不是什么大问题。但是，如果您的数据库不支持 RegEx 验证，则可能会出现问题。您可能可以将此 DSL 设计为只是一组类，或者您的系统语言提供的可以组合成简单布尔代数的表达式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T20:01:55.510

为了将验证规则保存在一个地方，我只使用服务器端验证。为了使其更加用户友好，我只是向服务器发出异步 post 请求，服务器以 JSON 格式返回错误信息，例如：

```
{ "fieldName1" : "error description", 
"fieldName2" : "another error description" }; 
```

如果服务器返回一个空对象，则正在提交表单，否则我可以使用来自服务器的信息来显示错误。它的工作方式很像这些注册表单，甚至在您提交表单之前检查您的登录是否已登录，但有两个关键区别：请求在提交时发送，并发送所有字段值（除了 input type="file"）。

如果 JavaScript 验证因任何原因无法正常工作，则会使用相同的服务器端脚本进行常规的服务器端验证场景（带有错误信息的页面重新加载）。

这个解决方案不像纯客户端验证那样响应迅速（需要时间在客户端和服务器之间发送/接收数据），但是非常简单，您不需要将验证规则“翻译”为 JavaScript。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T19:16:02.513

始终验证每个输入服务器端。您不知道他们的客户端“正确”地支持 javascript，或者他们没有欺骗他们的 http 请求并完全绕过您的 javascript。

不过，我建议不要将您的检查限制在一个位置 - javascript 中的额外检查可以让您的用户更加敏感。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-21T19:29:18.010

正如其他人所说，出于安全和数据完整性的原因，您需要在服务器端进行验证，而在客户端进行验证将改善用户体验，因为用户将有机会更快地修复他们的错误。

似乎问题是更多地询问您如何定义验证，以便验证的每个地方都是同步的。我建议在一个地方定义您的验证规则，例如 XML 文件或其他东西，并拥有一个框架来读取该文件并生成 javascript 函数以在客户端上进行验证。然后它可以使用相同的规则在服务器上进行验证。

这样，如果您需要更改规则，您就可以去一个地方。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T19:43:03.330

正如其他人所指出的，您必须在数据库、客户端和服务器层进行验证。您要求在一个地方进行验证，因此所有这些都是同步的。

[多个 Web 开发框架（包括CakePHP](http://Cakephp.org) ）使用的一种方法是将您的代码组织成模型、视图、控制器对象。

您可以将包括验证在内的所有数据代码放入模型层（如果需要，对数据库表结构或存储过程进行注释）。

接下来，在此模型中为您的验证的每个字段定义一个正则表达式（以及通用的最大尺寸、最小尺寸、必填字段）。

最后，使用这个正则表达式在 javascript（视图）和服务器表单处理代码（控制器）中进行验证。

如果正则表达式不够 - 即您必须检查数据库以查看用户名是否可用，您可以在模型上定义验证方法，直接在表单处理代码中使用它，然后使用 ajax 和 a小验证页面。

我将插入一个插件以从一个好的框架开始，这样您就不必自己连接所有这些。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-21T19:15:18.770

一个好的数据验证解决方案可以利用基于[XML Schema](http://www.w3.org/TR/xmlschema-2/)的数据类型定义，然后客户端和服务器都将重用这些类型，因为它们都需要执行它。值得注意的是，Backbase Ajax 框架基于 XML Schema 数据类型（内置和用户定义的）实现客户端用户输入验证

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-21T19:16:55.867

1.  良好的响应式用户界面的客户端验证
2.  服务器端验证，因为客户端代码可以被绕过或修改，因此不可信
3.  如果您有多个应用程序输入一个数据库，则数据库验证。这很重要，因为验证的更改会自动传播到所有应用程序，并且您不会失去数据一致性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-21T19:17:09.360

我们试图在它到达数据库服务器之前完成我们的验证，特别是对于我们面向公共互联网的应用程序。如果您在数据到达数据库之前不进行验证，您的数据库就会面临 SQL 注入攻击的风险。我们通过混合使用 javascript 和代码隐藏进行验证。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-22T00:47:44.560

过去，我使用 XSLT 进行验证。我们将创建值的 XML 文档并针对 XSLT 运行它。XSLT 是由 XPath“规则”构建的。生成的 XML 文档由破坏规则列表和破坏规则的字段组成。

我们有能力：

1.  将规则存储在关系数据库中
2.  从数据库生成 XSLT
3.  在客户端上使用 XSLT
4.  在服务器上使用 XSLT
5.  使用数据库中的原始规则

# mysql - MySQL相关子查询

> ID：223115
> 
> 赞同：2
> 
> 时间：2008-10-21T19:16:23.790
> 
> 标签：mysql, sql, inner-join

难以表达这个相关的子查询。我有两张虚构的桌子，foo 和 bar。foo 有 foo_id 和 total_count 两个字段。bar 有两个字段，seconds 和 id。

我需要为每个单独的 id 汇总 bar 中的秒数并更新 foo 中的 total_count。id 是 bar 中 foo_id 的外键。

我尝试过类似的事情，但运气不佳：

```
UPDATE foo f1 set total_count = (SELECT SUM(seconds) from bar b1 INNER JOIN foo f2     WHERE b1.foo_id = f2.id) WHERE f1.foo_id = bar.id; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T19:29:55.153

```
UPDATE foo f1
SET total_count = (SELECT SUM(seconds)
FROM bar b1 WHERE b1.id = f1.foo_id) 
```

您应该可以在子查询中访问适当的 foo id，因此无需加入表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T19:15:33.153

在较大的数据集中，相关的子查询可能会占用大量资源。连接到包含适当聚合的派生表会更有效：

```
create table foo ( foo_id int identity, total_count int default 0 )
create table bar ( foo_id int, seconds int )

insert into foo default values
insert into foo default values
insert into foo default values

insert into bar values ( 1, 10 )
insert into bar values ( 1, 11 )
insert into bar values ( 1, 12 )
    /* total for foo_id 1 = 33 */
insert into bar values ( 2, 10 )
insert into bar values ( 2, 11 )
    /* total for foo_id 2 = 21 */
insert into bar values ( 3, 10 )
insert into bar values ( 3, 19 )
    /* total for foo_id 3 = 29 */

select *
from foo

foo_id      total_count
----------- -----------
1           0
2           0
3           0

update  f
set     total_count = sumsec
from    foo f
        inner join (
                     select foo_id
                          , sum(seconds) sumsec
                     from   bar
                     group by foo_id
                   ) a
            on f.foo_id = a.foo_id

select *
from foo

foo_id      total_count
----------- -----------
1           33
2           21
3           29 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T19:26:55.237

我希望我理解你的问题是正确的。

您有以下表格：

*   表`foo`- 列：`id`和`total_count`
*   表`bar`- 列：（`foo_id`参考`foo.id`）和`seconds`

以下查询应该可以工作（更新`total_count`table 中的所有行`foo`）：

```
UPDATE foo AS f1
SET total_count = (
  SELECT SUM(seconds) 
  FROM bar INNER JOIN foo 
  WHERE foo_id = f1.id
); 
```

我不确定您要对最后一个`WHERE`子句 ( `WHERE f1.foo_id = bar.id;`) 做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T19:34:35.347

这确实为一致性问题打开了大门。您可能会考虑创建一个视图而不是改变 foo 表：

```
CREATE VIEW foo AS
SELECT id, sum(seconds) from bar group by id; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T21:18:39.520

只是为了提供一个替代方案，我喜欢使用 MySQL 漂亮的多表更新功能：

```
UPDATE foo SET total_count = 0;

UPDATE foo JOIN bar ON (foo.foo_id = bar.id)
  SET foo.total_count = foo.total_count + bar.seconds; 
```

# internet-explorer - 如何在我的计算机上查看多个版本的 IE？

> ID：223120
> 
> 赞同：4
> 
> 时间：2008-10-21T19:17:01.933
> 
> 标签：internet-explorer, internet-explorer-6, internet-explorer-7

在我工作的地方，我们只有 IE 7。我也想在我的电脑上查看 IE 6。

如何在同一台计算机上查看两者？

我想要的不仅仅是屏幕截图。我想在编写代码时查看两个版本的 IE。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-21T19:19:13.223

Microsoft 为每个版本的 IE 提供可供测试人员使用的虚拟机映像，这些映像可以与同样免费的 Virtual PC 程序一起使用。你可以在这里找到这些：

[http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-21T19:18:07.687

您想要[多个 IE](http://tredosoft.com/Multiple_IE) ... IE3 到 6 合一！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-21T19:24:20.890

试试[IETester](http://www.my-debugbar.com/wiki/IETester/HomePage)。它在一个程序中支持 IE5.5、IE6、IE7 和 IE8 beta。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T19:20:24.050

我曾经使用Multiple IE，但发现了一些限制——它只处理浏览器窗口显示功能，但它不显示打印预览并且有一些其他限制。

所以我建议[Virtual PC](http://www.microsoft.com/downloads/details.aspx?FamilyID=04d26402-3199-48a3-afa2-2dc0b40a73b6&DisplayLang=en)。它是免费的，您也可以免费找到带有[IE6 映像的 Win XP](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-21T19:20:24.173

虽然 MultipleIE 适用于大多数情况，但最好在 VM 中运行您需要支持的每个版本，因为它应该安装。这样可以避免独立实现中的一些错误，例如 cookie 问题、某些表单不可编辑、条件注释是废话等等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-21T19:28:00.087

这里列出了不同版本的IE，可以下载解压：[http ://browsers.evolt.org/?ie/32bit/standalone](http://browsers.evolt.org/?ie/32bit/standalone)

我在我的 Windows 安装中有一个独立版本的 IE6，我只需双击 IE6 可执行文件，它就可以顺利运行。

# ruby-on-rails - 如何将旧版本的 Rails 与 Aptana RadRails 一起使用？

> ID：223126
> 
> 赞同：1
> 
> 时间：2008-10-21T19:18:56.487
> 
> 标签：ruby-on-rails, aptana, radrails

我是 Rails 开发的新手，我正试图弄清楚如何将旧版本的 Rails 与 Apatana 的 RadRails IDE 一起使用。我正在尝试帮助一个朋友，他的网站基于旧版本而不是 RadRails 自动下载的版本，我很确定这两个版本不兼容（该网站使用的是 2.0 之前的版本，不确定确切的数字）。

有没有办法告诉 RadRails 获取和使用特定版本的 Rails？或者我可以在命令行上做些什么来更改已安装的 Rails 版本？我只是模糊地熟悉“gem”包系统，但我假设它会涉及到这一点。

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T15:13:18.523

在您的 rails 项目中使用 Rake 任务`rails:freeze:gems`并为其提供您想要使用的版本。例如：

```
rake rails:freeze:gems VERSION=2.1.0 
```

这会将正确版本的 Rails 放入`vendor/rails`，如果存在则默认加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T12:39:34.073

如果您不想将 gem 冻结到您的项目中（使用 rake rails:freeze:gems），您可以安装您要使用的版本的 rails gem：

`gem install rails -v 2.0.2`

然后指定要在 config/environment.rb 中使用的 rails gem：

`RAILS_GEM_VERSION = '2.0.2'`

# asp.net-mvc - 如何处理 ASP.NET MVC 中动态生成的表单的输出？

> ID：223149
> 
> 赞同：4
> 
> 时间：2008-10-21T19:24:57.517
> 
> 标签：asp.net-mvc, forms, post

假设您使用具有动态数量的表单元素的 ASP.NET MVC 创建了一个表单。

例如，您需要为每个产品设置一个复选框，并且产品数量每天都在变化。

您将如何处理将表单数据发送回控制器？您无法在操作方法上设置参数，因为您不知道将返回多少表单值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-21T19:31:55.803

只需给每个复选框一个唯一的名称值：

```
<input class="approveCheck" id="<%= "approveCheck" + recordId %>" 
 name="<%= "approveCheck" + recordId %>" type="checkbox" /> 
```

然后解析Action中的表单值列表，提交后：

```
foreach (var key in Request.Form.Keys)
    {
        string keyString = key.ToString();
        if (keyString.StartsWith("approveCheck", StringComparison.OrdinalIgnoreCase))
        {
            string recNum = keyString.Substring(12, keyString.Length - 12);

            string approvedKey = Request.Form["approveCheck" + recNum];
            bool approved = !String.IsNullOrEmpty(approvedKey);
            // ... 
```

您不需要将表单值作为参数传递；您可以从 Request.Form 中获取它们。

另一种选择：编写模型绑定器以将列表更改为自定义类型以进行表单提交。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T19:41:06.283

根据克雷格的回答……那更安全。发布具有相同名称的多个表单元素有一些怪癖。我要补充一点，以类似于 WebForms 的方式包装使控件“集合”的逻辑是明智的。Web 窗体预先添加容器控件的名称并添加索引。例如，在 Repeater 中，内部的表单元素将被命名为（类似于）RepeaterName_Element1、RepeaterName_Element2。当你去取出元素时，你必须使用 FindControl 或类似的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T19:56:04.977

根据您使用的活页夹，这应该有效：

```
<%var i = 0;
  foreach (var product (IList<ProductSelection>)ViewData["products"]) {%>
      <%=Html.Hidden(string.Format("products[{0}].Id", i), product.Id)%>
      <%=Html.Checkbox(string.Format("products[{0}].Selected", i))%>
      <%=product.Name%><br/>
<%}%> 
```

...这将导致 HTML 类似这样（注意名称上的数组表示法）：

```
<input name="products[0].Id" type="hidden" value="123">
<input name="products[0].Selected" type="checkbox">
Widget
<input name="products[1].Id" type="hidden" value="987">
<input name="products[1].Selected" type="checkbox">
Gadget 
```

...以及处理帖子的控制器方法：

```
public ActionResult SelectProducts(IList<ProductSelection> products)
{
     ...
} 
```

绑定后， products 参数将包含 ProductSelection 的两个实例。

需要注意的是，我没有对复杂对象使用新的默认绑定。相反，我使用的是来自 MvcContrib 的 NameValueDeserializer 或 CastleBind。他们都以这种方式行事。我猜 Beta 版中的绑定会以同样的方式工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T19:28:48.853

根据您的数据，您可以输出“CheckboxList”（在较新的版本中不再可能）并使用`string[]`参数，或者您可以设置多个表单并仅修改操作。

# ruby - 如何编写一个在安装 RubyGem 时调用的钩子？

> ID：223151
> 
> 赞同：4
> 
> 时间：2008-10-21T19:25:31.603
> 
> 标签：ruby, gem

我想编写一个 Ruby 片段，当我的 Gem 首次通过`[sudo ]gem install mygem`. 可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T14:22:03.900

它看起来并不真正受到支持。我找到了一个“post_install_message”属性，您应该可以在 gem 规范中设置它，但它不会执行代码。

您可以通过将安装时的代码打包为 gem 中的扩展（就好像它是本机扩展一样）并提供 Rakefile 来“构建”扩展（即调用您的代码）来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-17T11:04:39.310

我有同样的问题。我找到的最佳解决方案如下：

```
# your_gem.gemspec
Gem::Specification.new do |spec|
  # ...
  spec.extensions = ['Rakefile']
end 
```

-

```
# Rakefile
task :prepare do
  # Execute your post-installation code here
end

task default: :prepare 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-10-22T15:56:56.440

您可以尝试使用调用操作系统命令来执行此操作。我会从 irb 引用 eample，但你也可以在你的脚本中做同样的事情。

```
irb(main):001:0> system 'gem list | grep rails'
rails (2.1.1, 2.1.0)
=> true
irb(main):002:0> system 'gem list | grep railssssss'
=> false 
```

您可以使用此命令的结果作为代码段执行的条件。

# php - 如何使用 OLE_COLOR 作为参数从 PHP 调用 COM 函数？

> ID：223153
> 
> 赞同：0
> 
> 时间：2008-10-21T19:26:49.700
> 
> 标签：php, com, colors, ole

我正在尝试使用 COM 互操作扩展从 PHP 调用 COM 对象。一个函数需要 OLE_COLOR 作为参数？有没有办法从 PHP 传递这种值？

我尝试传递一个简单的整数值但没有成功。

```
$this->oBuilder->Font->Color = 255; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T13:21:31.670

PHP 可以定义 COM 自动公开的常量。

set_ini(' [com.autoregister-typelib](http://php.net/manual/en/com.configuration.php#ini.com.autoregister-typelib) ', true);

或手动

[com_load_typelib](http://php.net/manual/en/function.com-load-typelib.php) ($typelib_name);

但是如果 OLE_COLOR 是一个**对象**而不是一个整数，那么使用常量（或整数）的字符串或其他原语
将不起作用。

```
$Color = new COM('ColorClass');
$Color->set_color_function($red, $green, $blue); 
```

或者类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T17:20:51.107

当我从 PHP 调用 COM 函数时，我只是在调用中传递了它们。所以我的旧代码有：

```
$myComObject = new COM("MY_COM_OBJECT");
$myComObject->Myfunction(myVar1, myVar2, '我的字符串变量');

```

# c# - 在 C# 中使用正则表达式从完整路径解析文件名

> ID：223162
> 
> 赞同：21
> 
> 时间：2008-10-21T19:30:19.660
> 
> 标签：c#, .net, regex

如何使用 C# 中的正则表达式从完整路径中提取文件名？

说我有完整的路径`C:\CoolDirectory\CoolSubdirectory\CoolFile.txt`。

如何使用 .NET 风格的正则表达式获取 CoolFile.txt？我对正则表达式不是很擅长，我和我的 RegEx 伙伴都想不通。

另外，在尝试解决这个问题的过程中，我意识到我可以使用 `System.IO.Path.GetFileName`，但是我无法弄清楚正则表达式的事实只是让我不开心，它会困扰我直到我知道答案是。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-21T19:33:18.703

为什么必须使用正则表达式？.NET 具有专门用于此的内置`Path.GetFileName()`方法，可跨平台和文件系统工作。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-21T19:34:50.743

```
//  using System.Text.RegularExpressions;

/// <summary>
///  Regular expression built for C# on: Tue, Oct 21, 2008, 02:34:30 PM
///  Using Expresso Version: 3.0.2766, http://www.ultrapico.com
///  
///  A description of the regular expression:
///  
///  Any character that is NOT in this class: [\\], any number of repetitions
///  End of line or string
///  
///
/// </summary>
public static Regex regex = new Regex(
      @"[^\\]*$",
    RegexOptions.IgnoreCase
    | RegexOptions.CultureInvariant
    | RegexOptions.IgnorePatternWhitespace
    | RegexOptions.Compiled
    ); 
```

**更新：**删除了开头的斜线

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-21T19:35:14.987

这是一种方法：

```
string filename = Regex.Match(filename, @".*\\([^\\]+$)").Groups[1].Value; 
```

基本上，它匹配最后一个反斜杠和字符串末尾之间的所有内容。当然，正如您所提到的，使用 Path.GetFileName() 要容易得多，并且可以处理许多使用正则表达式难以处理的边缘情况。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-21T19:43:41.083

更短：

```
string filename = Regex.Match(fullpath, @"[^\\]*$").Value; 
```

或者：

```
string filename = Regex.Match(fullpath, "[^\\"+System.IO.Path.PathSeparator+"]*$").Value; 
```

没有`Regex`：

```
string[] pathparts = fullpath.Split(new []{System.IO.Path.PathSeparator});
string file = pathparts[pathparts.Length-1]; 
```

您提到的官方图书馆支持：

```
string file = System.IO.Path.GetFileName(fullpath); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-21T19:35:54.797

```
\w+:\\(\w+\\)*(?<file>\w*\.\w*) 
```

这显然需要扩展以覆盖所有路径字符，但命名组“文件”包含给定示例路径的文件名。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T05:31:48.493

您应该使用 System.Path 类。这意味着如果您决定支持 Mono/Linux，您将不必担心更少（dlamblin 的示例考虑了路径分隔符，但您可能会得到一个具有奇怪路径的奇怪操作系统）。System.Path 类也可以将两条路径合二为一。例如：

```
Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments), "My App Stuff"); 
```

将决定：

*   Windows：C:\Documents and Settings\[用户]\我的文档\我的应用程序
*   Linux：/[用户]/我的应用程序

# php - 如何将 ODBC 驱动程序添加到 MAMP 环境？

> ID：223165
> 
> 赞同：1
> 
> 时间：2008-10-21T19:30:51.453
> 
> 标签：php, ms-access, mamp

我正在使用 php 和 ms 访问数据库在 PC 设置上构建的东西。当我将应用程序移植到我的 MAMP 环境时，我得到

```
Fatal error: Call to undefined function odbc_connect() in /path/to/index.php on line 37 
```

第 37 行如下所示：

```
return odbc_connect("DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=myfile.mdb",
"ADODB.Connection", "", "SQL_CUR_USE_ODBC"); 
```

似乎 odbc 没有编译到 PHP (5) 的 MAMP 版本中。我也尝试过使用 PDO，并得到了类似的错误。

有人知道怎么修这个东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T22:42:49.537

您需要将 ODBC 驱动程序（如[Actual ODBC](http://www.actualtechnologies.com/) ）添加到您的计算机，也就是说，如果您的 PHP 版本具有任何符合的 ODBC 功能，它应该具有，但如果没有，您将需要安装具有适当支持的不同版本. 我在使用[MacPorts](http://www.macports.org/)安装 PHP 方面很幸运。但请注意，仍然缺少一些函数，您可能希望您必须为这些函数编写包装器，如下所示：

```
 if(!function_exists("odbc_fetch_array"))
  {
    function odbc_fetch_array($aResult,$anAssoc=false)
    {
        # Out of rows? Pass back false!
        if(!odbc_fetch_row($aResult)) return false;

        $theRow = array();

          # Build up array
        $theNumFields = odbc_num_fields($aResult);
        $theLimit = $theNumFields+1;
          for($i=1; $i<$theLimit; $i++)
          {
            # WARNING: Starts our index at 0, unlike standard ODBC which starts at 1
              $theRow[odbc_field_name($aResult, $i)] = odbc_result($aResult, $i);
              if(!$anAssoc) $theRow[$i-1] = $theRow[odbc_field_name($aResult, $i)];
        }
        return $theRow;
    }
  }

  if(!function_exists("odbc_fetch_assoc"))
  {
    function odbc_fetch_assoc($aResult)
    {   
        if (DIRECTORY_SEPARATOR == '/') // call local function on MACs
        {
            return odbc_fetch_array($aResult,true);
        }
        else // call built in function on Windows
        {
            return odbc_fetch_array($aResult);
        }
    }
  } 
```

# mp3 - 检测重复的音乐文件

> ID：223173
> 
> 赞同：3
> 
> 时间：2008-10-21T19:33:46.657
> 
> 标签：mp3

我有两个目录，其中包含约 20 GB 的音乐文件（主要是 mp3，一些 ogg），我想检测所有重复的歌曲。有两个复杂的因素：

1.  一首歌曲在两个目录中可能有不同的文件名。
2.  包含同一首歌曲的两个文件可能具有不同的 ID3 标签，因此具有不同的校验和。

解决这个问题的好方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-21T20:06:02.473

我过去的做法是使用来自 Music IP 的 genpuid。闭源软件创建文件的音频指纹，无论格式、id3、校验和等如何。

更多信息可以在[这里](http://musicbrainz.org/doc/genpuid)找到。

这应该确保最多的正重复匹配并最大限度地减少误报。它还可以正确标记不正确的 id3 标签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T19:59:20.740

这是我会做的（或以前做过的）......

1.  将所有歌曲加载到 iTunes 上（请耐心等待）（请注意，如果您可以在此处使用 iTunes，请停止……我假设您的受骗名单很长且难以管理）
2.  删除所有歌曲，将它们发送到垃圾桶，这样你就摆脱了目录结构
3.  显然，不要“清空垃圾”。将歌曲保存到桌面上的文件夹中
4.  使用[mediamonkey](http://www.mediamonkey.com/)、 dupe [eliminator](http://www.bestshareware.net/download/dupe-eliminator-for-itunes.htm)甚至[iTunes](http://apple.com/itunes)等软件来识别重复项。Dupe eliminator 很好，因为它检查了不同数量的因素，艺术家，长度，文件大小等等，并猜测什么是骗子，什么不是）
5.  重新加载到 Itunes，这一次检查“自动排列歌曲”，这会将你的新的、无重复的列表放到一个不错的按艺术家按专辑的排列中

……瞧！（或者如果您阅读 digg：“...利润！”）

/mp

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T19:34:45.610

ID3/OGG​​-equiv 艺术家和歌曲元标签是否准确？如果是，您可以使用它们。

编辑：如果他们不是，也许他们可以被制作成......如果你只处理整个专辑，有几个工具可以根据曲目的数量和长度获取所有标签数据。

如果您正在处理专辑和单个文件的混合，它会变得更加复杂。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T19:38:12.780

如果您有一个可以解析文件的库，您可以对音频数据运行哈希。如果歌曲是不同的翻录或已重新压缩/转码/等，这对您没有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-21T20:33:25.663

我确信那里有更优雅的解决方案 - 但如果音频数据是等效的，那么剥离 ID3 标签和散列应该可以解决问题。散列后，您可以根据需要将 ID3 标签放回去。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T19:39:12.887

或许[Last.fm API](http://www.last.fm/api/show?service=356)会很有用。它包括一个 track.getInfo 调用，该调用返回 XML，包括曲目的长度、艺术家姓名、曲目编号等。您可以比较曲目并查看它们是否有超过 N 个字段相等，如果是，则假设它们是相同的曲目。

不过，我不知道他们是否会同意你提交 40gb 音乐的 API 请求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-21T19:54:23.700

像这样的事情怎么样：找到一个库来获取 mp3 的长度以及指向音频数据的指针（看起来有几个库可以做到这一点），根据歌曲长度进行第一次通过过滤器，然后对于具有匹配长度的歌曲校验和它们的音频数据。与此[脚本类似，用于查找重复文件/图像](http://parand.com/say/index.php/2008/10/15/python-script-for-finding-and-removing-duplicate-files/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-05T09:45:59.967

[ffTES](https://github.com/monfort/ffTES)的一些改编对我非常相似的任务非常有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-14T03:19:41.107

我遇到了同样的问题，所以我编写了一个命令行程序，试图通过比较声学指纹来检测相似的音频文件：[https ://github.com/derat/soundalike](https://github.com/derat/soundalike)

它使用[Chromaprint](https://github.com/acoustid/chromaprint)`fpcalc`的实用程序来生成指纹，然后在更严格地比较指纹之前构建一个查找表以查找可能的匹配项。

当我运行我的音乐库时，它运行得很好，但如果需要，有各种标志来调整它的行为。如果它对你有用（或者如果它不），请告诉我！

# visual-studio - Subversion、外部引用、二进制文件和 MSBuild/Visual Studio

> ID：223184
> 
> 赞同：2
> 
> 时间：2008-10-21T19:37:51.860
> 
> 标签：visual-studio, visual-studio-2008, svn, copy, external

我有一个存储在 Subversion 存储库中的项目。

在这个存储库中，在不同的文件夹中，我有一组在我的许多项目中使用的库。这些库存储为二进制文件，即。dll、pdb 和 xml。

这是一个示例布局：

```
<repo-url>
    \Libraries
        \SQLite
        \SystemHooks
        \Moq 
```

在应用程序项目中，我添加了一个“libs”目录，然后将一个 svn:externals 引用属性添加到该目录以拉入我需要的库。

例如，对于我现在正在处理的这个项目，它提示了这个问题，我需要 SystemHooks 库，所以在我的应用程序项目文件夹结构中，它现在看起来像这样：

```
SketchingMode         <-- solution folder, other projects here as well
    SketchingMode     <-- app project folder
        libs
            SystemHooks 
```

这样做的好处是我可以更轻松地更新库，并且只需将 -rXYZ 说明符用于外部定义以避免拉入比我准备接受的新版本，并且每个文件仍然只有一个副本/我的存储库中的版本。

在这种特殊情况下，坏事是 SystemHooks 目录中的一个 dll（如果我也想要 pdb，则为 2 个）需要复制到输出目录，而不是项目引用。

引用正常工作，但是一旦我将此目录中的一个文件标记为“内容”和“始终复制”或“如果较新则复制”，那么 libs 和 SystemHooks 目录结构也会被复制到输出目录。

因此，在构建之后，我的磁盘目录结构如下所示：

```
SketchingMode         <-- solution folder, other projects here as well
    SketchingMode     <-- app project folder
        libs
            SystemHooks
        bin
            Debug               <-- main build output here
                libs
                    SystemHooks <-- 1-2 files in here 
```

避免这种情况的唯一方法是使用构建后步骤并仅添加必要的复制语句吗？或者我可以以某种方式调整项目文件以避免复制这样的完整结构吗？

为了清楚起见，在 bin\Debug 目录中，我不希望那里有另一层 libs\SystemHooks，并且当前复制到 bin\Debug\libs\SystemHooks 文件夹的所有文件都需要复制到bin\Debug 文件夹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T16:09:08.940

将 libs 目录签出到*解决方案*级别而不是项目级别怎么样？这就是我们所做的，因为库程序集往往被多个项目使用；直接放在一个项目的目录中不会产生高度可共享的资源。

```
SketchingMode solution
  SketchingMode proj
    bin
      Debug
      Release
  Libs
    SystemHooks 
```

# .net - 垃圾收集器的意义何在

> ID：223187
> 
> 赞同：3
> 
> 时间：2008-10-21T19:38:26.867
> 
> 标签：.net, garbage-collection

```
SqlConnection connection = new SqlConnection(FROM_CONFIGURATION) 
SqlCommand command = new SqlCommand("SomeSQL", connection); 
connection.Open(); 
command.ExecuteNonQuery(); 
command.Dispose(); 
connection.Dispose(); 
```

建议上面的代码应该包含try/catch（或using），这样如果抛出异常，所有资源都会被正确处理。

但是如果你不得不担心手动处理东西，那么 GC 的意义何在？！GC 不是为编码员处理这个问题吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-21T19:46:49.707

正如这里的其他人所说，GC 是不确定的，所以你不知道什么时候会收集你的对象。我想澄清的是，这不是内存的问题，而是系统资源（打开的文件、数据库连接）的问题，这些资源很昂贵，应该尽快释放。当您知道不再使用连接时，Dispose 允许您执行此操作。如果它们没有及时释放，系统可能会耗尽这些资源，而 GC 不会意识到这一点。这就是为什么您必须手动执行此操作的原因。

另外我想补充一点，使用“使用”语句会以一种很好的方式为您完成。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-21T19:48:51.120

垃圾收集在这里负责释放未使用的**内存**。

扩展 GC 以释放其他资源存在问题的原因有多种。其中之一是终结器（在对象被垃圾回收时执行的方法）使引用周期无法回收，除非您强烈限制对终结器的取消引用，这使得它们使用起来非常棘手。

另一个原因是大多数资源需要以某种及时的方式释放，这在依赖垃圾收集时是不可能的。

还有一个原因是，将 GC 限制在内存管理上会处理任何应用程序中的*大量*资源管理，以及几乎所有*不感兴趣*的资源管理。其他资源通常很有趣，值得一些额外的代码来明确说明它们是如何发布的。

另一个原因是，在某些应用程序中，GC 使应用程序运行得更快，因为它减少了为满足所有权语义而完成的复制量。这与其他资源无关。

其他人可以这样持续几个小时。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-21T19:40:40.747

> 但是如果你不得不担心手动处理东西，那么 GC 的意义何在？！GC 不是为编码员处理这个问题吗？

问题是您不知道GC**何时**运行。如果您的应用程序从不给内存施加压力，它可能根本无法运行。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-21T19:55:57.080

假设我有这个代码：

```
class MonkeyGrabber : IDisposable {
   public MonkeyGrabber() { /* construction grabs a real, live monkey from the cage */
   public void Dispose() { Dispose(true); /* releases the monkey back into the cage */ }
   // the rest of the monkey grabbing is left as an exercise to grad student drones
}

class MonkeyMonitor {
    public void CheckMonkeys() {
        if (_monkeyPool.GettingTooRowdy()) {
            MonkeyGrabber grabber = new MonkeyGrabber();
            grabber.Spank();
        }
    }
} 
```

现在，我的 MonkeyMonitor 会检查猴子，如果它们太吵闹，它会获取宝贵的系统资源 - 连接到系统的单个猴子抓爪，并用它抓住猴子并打它。由于我没有处理它，猴爪仍然抓着猴子在休息笼上方晃来晃去。如果其余的猴子继续吵闹，我就无法制作新的 MonkeyGrabber，因为它仍然在帮助。哎呀。一个人为的例子，但你明白了：实现 IDisposable 的对象可能会占用应该及时释放的有限资源。GC 最终可能会放手，也可能不会放手。

另外，有些资源需要及时释放。我有一组类，如果它们在应用程序退出之前没有被应用程序或 GC 处理，将导致应用程序严重崩溃，因为它们来自的非托管资源管理器在 GC 处理它时已经消失了.

[更多关于 IDisposable](http://www.atalasoft.com/cs/blogs/stevehawley/archive/2006/09/21/10887.aspx)。

[using 是你的朋友](https://stackoverflow.com/questions/212198/what-is-the-c-using-block-and-why-should-i-use-it#212210)——它是迄今为止我们最接近[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-21T19:44:16.573

实现 IDisposable 的对象试图告诉您它们与非托管内存的结构有链接。垃圾收集器分批运行以提高效率。但这意味着可能需要一段时间才能处理您的对象，这意味着您持有资源的时间将超过应有的时间，这可能会对性能/可靠性/可扩展性产生负面影响。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-21T19:47:38.893

GC 偶尔运行并负责内存管理，为您保持一切整洁。当您看到像您发布的代码片段时，您可能会认为它没有用，但通常情况下，它为您省去了很多麻烦（想想 C/C++ 手动内存管理），因为它大大减少了内存泄漏并让您担心关于您的应用程序将如何运行，而不是您将如何管理内存。处理文件句柄和数据库连接是一种提高效率的方法，因为垃圾收集不是确定性的，可能不会立即发生，并且您不希望这些文件句柄和打开的数据库连接削弱系统性能。顺便说一句，你的代码真的很丑，我一直提倡 using 语句，经常这样写我的 db 代码：

```
using (SqlConnection connection = new SqlConnection(...))
using (SqlCommand command = connection.CreateCommand())
{
   ...
} 
```

当连接和命令对象超出范围时，即执行离开块时，这会自动调用连接和命令对象。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-21T19:43:31.910

因为 GC 不是最有效的——它并不总是在资源不再使用时立即发生。因此，当您处理文件 I/O、数据库连接等非托管资源时，最好在等待并依靠 GC 处理之前释放/清理这些资源。

并考虑使用`using`关键字：

```
using (SqlConnection connection = new SqlConnection(FROM_CONFIGURATION))
using (SqlCommand command = new SqlCommand("SomeSQL", connection))
{
  connection.Open(); 
  command.ExecuteNonQuery(); 
  command.Dispose(); 
  connection.Dispose();
} 
```

此外，作为一般规则，任何可以处理的东西都应该放在一个`using`块中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-21T20:01:40.703

> ... GC 从来都不是用来管理资源的；它旨在管理内存分配......在数据库连接的特定情况下，您正在处理的不仅仅是内存......（Scott Dorman）

OP 没有标记特定平台，尽管大多数答案都是特定于 .net 的，并指出 GC 主要用于避免内存泄漏，但`using`表达式等扩展`IDisposable`可以提供很大帮助。

其他平台提供其他解决方案。例如，在 C++ 中，没有（内置）垃圾收集，但某些形式的共享指针可用于帮助内存管理，而 RAII 风格的编码在管理其他类型的资源时非常有帮助。

在 cPython 中，使用了两种不同的垃圾收集系统。当最后一个引用被删除时，引用计数实现立即调用析构函数。对于常见的“堆栈”对象，这意味着它们会立即被清理，就像 C++ RAII 对象所发生的一样。缺点是如果你有一个引用循环，引用计数收集器永远不会处理对象。因此，它们有一个辅助的非确定性垃圾收集器，其工作方式类似于 Java 和 .NET 收集器。与使用 using 语句的 .NET 一样，cPython 尝试处理最常见的情况。

因此，为了回答 OP，非确定性垃圾收集有助于简化内存管理，它也可以用于处理其他资源，只要及时性不是问题，以及另一种机制（如仔细编程、引用计数 GC、在需要及时释放其他资源时，需要使用 using 语句或真实的 RAII 对象。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-22T03:35:13.973

啊，我现在明白了。我将内存管理与非托管资源管理混淆了。感谢您的澄清！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-21T19:40:09.063

上述代码释放获取的资源（尽管我不认为您应该自己调用 Dispose() 方法，释放资源意味着关闭流和类似的东西）。GC 从内存中删除对象（释放对象使用的内存），但只有在对象释放资源后才能完成。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-21T19:41:18.967

我不太确定 c#，这就是它的样子，但通常，垃圾收集器管理内存。除了对象内存之外，此连接还具有服务器资源。处于单独进程中的数据库必须保持连接。关闭清理这些。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-21T19:47:51.870

.NET 中的垃圾收集器 (GC) 是 .NET 公共语言运行时 (CLR) 的核心部分，适用于所有 .NET 编程语言。GC 从来都不是用来管理资源的。它旨在管理内存分配，并且在管理直接分配给本机 .NET 对象的内存方面做得非常出色。它并非旨在处理非托管内存和操作系统分配的内存，因此管理这些资源成为开发人员的责任。

在数据库连接的特定情况下，您正在处理的资源不仅仅是内存 - 特别是连接池、可能的隐式事务范围等。通过调用 Close() 和/或 Dispose() 您明确告诉对象释放那些非托管资源立即被托管，而托管资源将等待一个 GC 周期发生。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-21T19:41:24.130

GC 确实会处理对象，但处理可能不会立即发生。手动处理对象将更快地释放内存。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-21T19:42:59.480

GC 在释放外部资源（例如数据库连接或文件句柄）时受到限制。但是，为了在 .NET 世界中分配内存，它需要处理许多普通的内存管理任务。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-21T19:49:07.157

上面提供了一个示例，说明当本地分配的内存或资源作为句柄进入托管世界时。在这种情况下，因为托管世界没有分配内存，所以它不能“自动整理”它。内存/资源必须显式地配置或至少配置在终结器中。

但是，在绝大多数情况下，尤其是在谈论对大多数公司核心目标（是的业务逻辑）至关重要的代码时，您不必担心这种事情，更少的代码意味着更少的错误。

# c# - 如何在 C# 2.0 中创建 Delphi TSpeedButton 或 SpeedButton？

> ID：223189
> 
> 赞同：4
> 
> 时间：2008-10-21T19:38:51.297
> 
> 标签：c#, delphi

如何在 C# 2.0 中创建 Delphi TSpeedButton 或 SpeedButton？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-02-11T12:28:14.663

使用 Button 并将 TabStop 属性设置为 false 仅在点击表单时才有效...

如果您需要（像我一样）单击它时没有被选中的按钮，我发现只有一种方法可以做到这一点。

我这样做的方式是继承 Button 类并在构造函数中调用 SetStyles，从而将 Selectable 设置为 false，如下所示：

```
public class ButtonNoFocus : Button
{
    public ButtonNoFocus()
        : base()
    {
        base.SetStyle(ControlStyles.Selectable, false);
    }
} 
```

这对我来说很有效，如果你有一个带有按钮的控制面板，可以对选定的对象执行操作，那就完美了……

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T09:37:58.887

我想知道你是否想创建一个像 TSpeedButton 这样的控件，或者你只需​​要同样的最终结果......

从头开始编程当然是可能的，但我只会将其作为一种学习练习来解决。

假设您想获得类似的最终结果......

Delphi 的 TSpeedButton 与开发人员认为有用的标准 TButton 有所不同——它是扁平的，没有焦点，而且它比普通按钮消耗更少的资源（因为它没有底层的 Windows 句柄）。

其中哪些对你很重要？

如果您只想要一个不接受焦点的平面按钮，请使用 FlatStyle=Flat（或 PopUp）且 TabStop=false 的常规按钮。您可以通过设置 Image 属性或 ImageList 和 ImageIndex/ImageKey 的组合来配置字形。

另一种方法是寻找一个接近您需求的现有按钮组件 - 一个寻找的地方可能是 Krypton Toolkit（免费使用，请参阅[http://www.componentfactory.com/toolkit_buttoncontrols.php](http://www.componentfactory.com/toolkit_buttoncontrols.php)）。

如果您想减少应用程序消耗的资源数量，您可能会在其他地方获得更好的回报。

在 Windows 3.1 (Delphi 1) 和 Windows 95 (Delphi 2) 时代，可用句柄的数量受到严格限制，在系统范围内可用的最大数量。今天，在 Windows XP 和 Vista 中，可用句柄的数量要高得多，而且数量是每个进程的，而不是系统范围的。除非您要创建成千上万个按钮，否则您不太可能接近用完。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T09:06:32.087

常规的 .net 2.0 按钮支持 TSpeedbutton 的部分功能：

*   字形：**图像**
*   平面：平面**样式**

它不处理：

*   下
*   团体

这两个是相关的，你可以从按钮继承，并拥有它，添加向下和分组功能。

[Codeproject 有一个 ownerdraw](http://www.codeproject.com/KB/buttons/od_buttons.aspx)按钮的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T01:49:51.390

[这](https://stackoverflow.com/questions/148729/how-to-setchangeremove-focus-style-on-a-button-in-c)有帮助吗？看起来你必须处理 OnPaint 事件，而不是集中注意力......

# schema - 在 BizTalk 2006 R2 中将换行符附加到平面文件架构

> ID：223190
> 
> 赞同：2
> 
> 时间：2008-10-21T19:39:03.980
> 
> 标签：schema, biztalk, flat-file, biztalk2006r2

我有一个包含标题和详细记录的平面文件架构。它看起来像这样：

```
HDR**2401*XX0062484*22750***20081006000000*000*******
LIN**001*788-0538-001*4891-788538010*20000*EA**0000*** 
```

我需要在消息末尾附加两个空行。现在，如果我有多个记录，我会得到以下输出：

```
HDR**2401*XX0062484*22750***20081006000000*000*******
LIN**001*788-0538-001*4891-788538010*20000*EA**0000***
HDR**2401*XX0062484*22750***20081006000000*000*******
LIN**001*788-0538-001*4891-788538010*20000*EA**0000*** 
```

我想看到的是这样的：

```
HDR**2401*XX0062484*22750***20081006000000*000*******
LIN**001*788-0538-001*4891-788538010*20000*EA**0000***

HDR**2401*XX0062484*22750***20081006000000*000*******
LIN**001*788-0538-001*4891-788538010*20000*EA**0000*** 
```

我可以构建一个自定义管道组件来执行此操作，但我想知道是否有更简单的方法来获得我需要的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T00:00:29.490

您应该能够通过使用平面文件架构的分隔符属性来完成您想要的操作。

根据您的示例文件，我创建了一个具有以下记录结构的模式：

```
<架构>    
  <根>    
    <HDR组>    
      <HDR>    
      <林>    

```

如果单击架构的根节点，您应该会看到该根节点的属性列表。一个属性部分具有标题“平面文件”。在此平面文件部分中，您可以设置的前三个属性是子分隔符、子分隔符类型和子顺序。

这是您配置架构以创建空行的地方（在本例中为 CR LF，但您可以根据需要设置不同的内容）对于您的示例，我设置以下内容：

```
子分隔符：0x0D 0x0A 0x0D 0x0A    
子分隔符类型：十六进制    
子订单：中缀

```

0x0D 0x0A 是一个回车换行，所以上面只是创建了两个空行，在根节点的每个子节点之间插入。

<HDRGroup> 然后起作用以确保每个标题及其行保持在一起。对于我设置的分隔符设置：

```
子分隔符：0x0D 0x0A    
子分隔符类型：十六进制    
子订单：后缀

```

然后，<HDR> 和 <LIN> 记录包含消息行的实际架构定义，用星号分隔。

这个模式适用于在我看来就像你所要求的东西 - 这种平面文件模式以及它如何解析文件高度依赖于小细节，但是，例如有什么类型的换行符以及是否有文件末尾的换行符。

使用分隔符的原则将成立，您可能会发现需要修改设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T22:45:32.870

对于任何关心的人，我终于屈服并编写了一个自定义管道组件来完成此任务。

# c# - 引用同一程序集的不同版本

> ID：223195
> 
> 赞同：34
> 
> 时间：2008-10-21T19:39:55.290
> 
> 标签：c#, dll, build-process, assemblies, versioning

如果 A 引用程序集 B 1.1 和 C，而 C 引用 B 1.2，如何避免程序集冲突？

我很好地假设 C 的引用会被封装掉并且不会导致任何问题，但似乎所有的 dll 都被复制到了 bin 中，这就是问题发生的地方。

我了解解决此问题的两种方法是使用 GAC 或程序集绑定？GAC 对我来说似乎不是最好的方法，因为我不喜欢假设 dll 会在那里，我更喜欢在我的解决方案中从 lib 目录中引用 dll。

由于程序集绑定对我来说似乎不健壮，如果程序集的一个版本具有另一个版本没有的功能怎么办，这不会产生问题吗？

* * *

在我的情况下，因为我使用的是第 3 方 dll，它使用的是旧版本的 nHibernate，而不是我自己使用的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-21T19:45:17.010

我过去使用 GAC 也取得了相同的结果，但您应该质疑您必须参考多个版本的原因，并尽可能避免使用它。如果您必须这样做，[绑定重定向](http://msdn.microsoft.com/en-us/library/2fc472t2(VS.80).aspx)可能会对您的情况有所帮助。

另外，你读过[这个](http://blogs.msdn.com/abhinaba/archive/2005/11/30/498278.aspx)吗？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-08-23T21:03:03.153

一种看似鲜为人知的方法是使用 extern 关键字。

来自[C# 参考](http://msdn.microsoft.com/en-us/library/ms173212%28v=VS.100%29.aspx)

> 要引用具有相同完全限定类型名称的两个程序集，必须在命令提示符处指定别名，如下所示：
> 
> /r:GridV1=grid.dll
> 
> /r:GridV2=grid20.dll
> 
> 这将创建外部别名 GridV1 和 GridV2。要在程序中使用这些别名，请使用`extern` 关键字引用它们。例如：
> 
> 外部别名 GridV1；
> 
> 外部别名 GridV2；
> 
> 每个外部别名声明都引入了一个额外的根级命名空间，它与全局命名空间平行（但不在其中）。因此，每个程序集的类型可以通过使用它们的完全限定名称来毫无歧义地引用，该名称植根于适当的命名空间别名中。
> 
> 在前面的示例中，GridV1::Grid 将是来自 grid.dll 的网格控件，而 GridV2::Grid 将是来自 grid20.dll 的网格控件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-01T19:37:46.897

我被要求支持多个版本的程序集并找到了这个解决方案：

```
 <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="MyAssembly" publicKeyToken="..." />
        <codeBase version="1.1.0.0" href="MyAssembly_v1.1.0.0.dll"/>
        <codeBase version="2.0.0.0" href="MyAssembly_v2.0.0.0.dll"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T19:59:59.117

您可以将[bindingRedirect 元素](http://msdn.microsoft.com/en-us/library/eftw1fys.aspx)添加到配置文件中，以指定要在运行时使用的程序集版本。

```
<configuration>
   <runtime>
      <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
         <dependentAssembly>
            <assemblyIdentity name="myAssembly"
                              publicKeyToken="32ab4ba45e0a69a1"
                              culture="neutral" />
            <bindingRedirect oldVersion="1.0.0.0"
                             newVersion="2.0.0.0"/>
         </dependentAssembly>
      </assemblyBinding>
   </runtime>
</configuration> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-21T20:04:44.210

.NET 运行时完全能够同时加载同一程序集的多个版本。但是，如果您要打开这个蠕虫罐头，我强烈建议您只命名您的程序集并使用 Major.Minor.* 命名方案以避免命名冲突。

我认为您不应该想出一种千篇一律的方法来使用（或不使用）GAC。如果您想自动使用随 DLL 的未来版本发布的新功能，GAC 会非常好。当然，这种祝福的代价是新版本可能不会像您期望的那样工作:)。这完全取决于什么是最实用的，以及您对发布到 GAC 的内容有多少控制权。

问候，-艾伦。

# c++ - 编码恐怖或绝妙想法的 C++ 示例？

> ID：223215
> 
> 赞同：12
> 
> 时间：2008-10-21T19:44:13.500
> 
> 标签：c++, optimization, syntax

在以前的雇主中，我们正在编写必须“通过网络”传输到其他计算机的二进制消息。每条消息都有一个标准标题，例如：

```
class Header
{
    int type;
    int payloadLength;
}; 
```

所有数据都是连续的（标题，紧随其后的数据）。鉴于我们有一个指向标头的指针，我们想要访问有效负载。传统上，您可能会这样说：

```
char* Header::GetPayload()
{
    return ((char*) &payloadLength) + sizeof(payloadLength);
} 
```

甚至：

```
char* Header::GetPayload()
{
    return ((char*) this) + sizeof(Header);
} 
```

这似乎有点冗长，所以我想出了：

```
char* Header::GetPayload()
{
    return (char*) &this[1];
} 
```

起初它似乎相当令人不安，使用起来可能太奇怪了——但非常紧凑。关于它是聪明的还是可憎的，有很多争论。

那么它是什么 - 对编码的犯罪，还是很好的解决方案？你有过类似的取舍吗？

-更新：

我们确实尝试了零大小的数组，但当时编译器给出了警告。我们最终采用了继承的技术：Message 派生自 Header。它在实践中效果很好，但原则上你说的是一条消息 IsA Header - 这似乎有点尴尬。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-21T19:48:45.597

我会反对编码犯罪。

两种方法都将生成完全相同的目标代码。第一个明确了它的意图。第二个非常令人困惑，唯一的优点是它节省了几次击键。（只要学着打字）。

另外，请注意，这两种方法都不能保证有效。对象的 sizeof() 包括用于字对齐的填充，因此如果标题是：

```
class Header
{
    int type;
    int payloadLength;
    char  status;
}; 
```

您描述的两种方法都将有效负载从 Header+12 开始，而实际上它很可能从 Header+9 开始。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-21T19:47:28.237

就我个人而言，我认为如果有犯罪，它会向头部询问有效载荷。

但只要你打算那样做，'this+1' 就和任何方法一样好。

理由：'&this[1]' 是一段通用代码，不需要您深入研究类定义即可完全理解，并且不需要在有人更改类的名称或内容时进行修复。

顺便说一句，第一个例子是真正的反人类罪。在类的末尾添加一个成员，它会失败。在班级周围移动成员，它会失败。如果编译器填充类，它将失败。

此外，如果您要假设编译器的类/结构布局与您的数据包布局相匹配，那么您应该了解相关编译器的工作原理。例如。在 MSVC 上，您可能想了解`#pragma pack`.

PS：有多少人认为“this+1”或“&this[1]”难以阅读或理解，这有点可怕。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-21T20:00:23.220

您依赖编译器以特定方式布局您的类。我会将消息定义为一个结构（由我定义布局），并有一个封装消息并为其提供接口的类。清晰的代码 = 好的代码。“可爱”的代码 = 糟糕（难以维护）的代码。

```
struct Header
{
    int type;
    int payloadlength;
}
struct MessageBuffer
{
   struct Header header;
   char[MAXSIZE] payload;
}

class Message
{
  private:
   MessageBuffer m;

  public:
   Message( MessageBuffer buf ) { m = buf; }

   struct Header GetHeader( )
   {
      return m.header;
   }

   char* GetPayLoad( )
   {
      return &m.payload;
   }
} 
```

自从我编写任何 C++ 以来已经有一段时间了，所以请原谅任何语法问题。只是试图传达总体思路。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-10-21T22:24:18.577

这是一个常见的问题，但你真正想要的是这个。

```
class Header
{
    int type;
    int payloadLength;
    char payload[0];

};

char* Header::GetPayload()
{
    return payload;
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-21T19:48:42.587

我的投票是编码恐怖。不要误会我的意思，它很聪明——但是你为自己节省了一个完整的加法运算，代价是使代码更难理解和阅读。我不认为这种权衡是值得的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-21T19:50:52.567

如果标头需要“返回”未包含在其中的数据，我认为这从一开始就有缺陷。

由于您已经将自己置于这些骇人听闻的基础上，因此我真的很喜欢您的想法。

但请注意，这不是选美比赛。您应该找到一个完全不同的解决方案。对于您提供的所有三个版本的 GetPayload()，如果没有您的进一步解释，我将无法理解那里到底发生了什么。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-21T20:51:23.770

您是否考虑过“空数组成员”技巧？我记得经常看到它，甚至使用过一次或两次，但我似乎找不到任何真正好的参考资料（也许除了下面提到的那个）。

诀窍是将您的结构声明为

```
struct bla {
    int i;
    int j;
    char data[0];
} 
```

然后，“数据”成员只是指向标题后面的任何内容。我不确定它的便携性；我也看到它以 '1' 作为数组大小。

（使用下面的 URL 作为参考，使用 '[1]' 语法，似乎不起作用，因为它太长了。这是链接：）

[http://developer.apple.com/documentation/DeveloperTools/gcc-4.0.1/gcc/Zero-Length.html](http://developer.apple.com/documentation/DeveloperTools/gcc-4.0.1/gcc/Zero-Length.html)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-21T19:56:01.607

如果它有效——始终如一——那么它就是一个优雅的解决方案。

它通常会在内存中工作，因为编译器会处理对齐问题，并且您可以假设 Payload 在正确对齐的内存空间中跟随标头。

当 Header/Payload 对象“通过网络”流式传输时，我可以看到这种情况分崩离析，因为您使用的流式传输机制可能不关心在任何特定边界上对齐对象。因此，Payload 可以直接跟在 Header 后面而没有填充，以强制它进行特定的对齐。

用一句话来说，优雅就是优雅。因此，只要您小心流式传输它，它就很优雅。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-21T20:29:22.350

首先，“反对编码的犯罪”和“好的解决方案”之间有很大的空间，但我想说这更接近前者。

Header 是它的 Payload 的守护者吗？

这是这里的基本问题——标头和有效负载都应该由另一个保存整个消息的对象管理，这是请求有效负载的适当位置。它可以在没有指针算术或索引的情况下这样做。

鉴于此，我赞成第二种解决方案，因为它更清楚发生了什么。

但我们一开始就处于这种情况似乎表明你们团队的文化重视聪明而不是清晰，所以我想所有的赌注都没有了。

如果你真的想变得可爱，你可以概括。

```
template<typename T. typename RetType>
RetType JustPast(const T* pHeader)
{
   return reinterpret_cast<RetType>(pHeader + sizeof(T));
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-21T19:50:00.527

就我而言，它们基本上是一样的。两者都是字节杂耍的形式，这总是有风险的，但并非不可能做到正确。第一种形式更容易被接受和识别。我会亲自写：

```
char* Header::GetPayload()
{
    return ((char*) this) + sizeof(*this);
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-21T20:03:44.943

不要忘记 VC++ 可能会对`sizeof()`类的值施加填充。由于提供的示例预计为 8 个字节，因此它会自动对齐 DWORD，所以应该没问题。检查[`#pragma pack`](http://msdn.microsoft.com/en-us/library/2e70t5y1(VS.80).aspx)。

虽然，我同意，提供的例子是某种程度的编码恐怖。当可变长度数据跟随时，许多 Win32 数据结构在标头结构中包含一个指针占位符。一旦加载到内存中，这可能是引用此数据的最简单方法。MAPI[`SRowSet`](http://msdn.microsoft.com/en-us/library/ms527417(EXCHG.10).aspx)结构就是这种方法的一个例子。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-21T21:37:15.007

我实际上做了类似的事情，几乎所有的 MMO 或在线视频游戏也是如此。尽管他们有一个称为“数据包”的概念，并且每个数据包都有自己的布局。所以你可能有：

```
struct header
{
    short id;
    short size;
}

struct foo
{
    header hd;
    short hit_points;
}

short get_foo_data(char *packet)
{
    return reinterpret_cast<foo*>(packet)->hit_points;
}

void handle_packet(char *packet)
{
    header *hd = reinterpret_cast<header*>(packet);
    switch(hd->id)
    {
        case FOO_PACKET_ID:
            short val = get_foo_data(packet);
        //snip
    }
} 
```

他们对大部分数据包都这样做。一些数据包显然具有动态大小，对于这些成员，它们使用长度前缀字段和一些逻辑来解析该数据。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-22T00:37:54.610

我认为在当今时代，在 C++ 中，将 C 风格转换为 char* 会使您失去任何“出色设计理念”奖项的资格，而没有得到太多的聆听。

我可能会去：

```
#include <stdint.h>
#include <arpa/inet.h>

class Header {
private:
    uint32_t type;
    uint32_t payloadlength;
public:
    uint32_t getType() { return ntohl(type); }
    uint32_t getPayloadLength() { return ntohl(payloadlength); }
};

class Message {
private:
    Header head;
    char payload[1]; /* or maybe std::vector<char>: see below */
public:
    uint32_t getType() { return head.getType(); }
    uint32_t getPayloadLength() { return head.getPayloadLength(); }
    const char *getPayload() { return payload; }
}; 
```

当然，这是假设 C99-ish POSIX：要移植到非 POSIX 平台，您必须根据平台提供的任何内容自行定义 uint32_t 和 ntohl 之一或两者。通常并不难。

理论上，您可能需要两个类中的布局编译指示。在实践中，考虑到这种情况下的实际字段，我会感到惊讶。可以通过一次从 iostream 读取/写入数据一个字段来避免该问题，而不是尝试在内存中构造消息的字节然后一次性写入。这也意味着你可以用比 char[] 更有用的东西来表示有效负载，这反过来意味着你不需要有最大的消息大小，或者弄乱 malloc 和/或放置 new 等等。当然，它引入了一些开销。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-21T19:48:47.563

也许您应该使用详细方法，但用#define 宏替换它？通过这种方式，您可以在键入时使用速记，但任何需要调试代码的人都可以毫无问题地跟进。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-21T23:39:40.890

我投票给 &this[1]。我已经看到它在解析已加载到内存中的文件（同样可以包括接收到的数据包）时使用了很多。当你第一次看到它时，它可能看起来有点奇怪，但我认为它的含义应该立即显而易见：它显然是刚刚超过这个对象的内存地址。这很好，因为很难出错。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-06T00:11:25.127

我不喜欢使用“犯罪”之类的词。我宁愿指出 &this[1] 似乎对编译器可能不同意的内存布局做出了假设。例如，任何编译器都可能出于自身原因（如对齐），在结构中的任何位置插入虚拟字节。如果编译器或选项发生更改，我更喜欢一种能够更多保证获得正确偏移量的技术。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-03T07:45:41.420

除了上述之外，我想说这是对互操作性和良好的有线协议设计原则的犯罪。令人惊讶的是，有多少程序员不能/不愿意明确区分有线协议定义和它的实现。如果您的协议必须存活超过两天，它很可能必须存活超过两年/操作系统/编译器/语言/字节序，并且在某些时候它会中断，而不是迟早。因此，让其他人的生活更轻松，写下有线协议规范并编写适当的（反）序列化例程。否则，人们会在不太愉快的环境中不断提及您的名字。

# sql-server - 如何在 MS SQL Server 中插入子选择的内容？

> ID：223219
> 
> 赞同：3
> 
> 时间：2008-10-21T19:45:25.073
> 
> 标签：sql-server

我想做类似的事情

```
insert into my table (select * from anothertable where id < 5) 
```

什么是正确的 MSSQL 语法？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-21T19:49:43.787

这是你要找的吗？

```
INSERT INTO MyTable
SELECT * FROM AnotherTable
WHERE AnotherTable.ID < 5 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-21T19:50:41.100

该语法看起来是正确的，但您的字段必须完全匹配，否则它将无法工作。

您可以指定字段，例如：

```
INSERT INTO myTable(COL1, COL2, COL3) 
SELECT COL1, COL2, COL3 FROM anotherTable where anotherTable.id < 5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T19:51:11.990

`Insert Into MyTable ( Col1, Col2, Col3 ) Select Col1, Col2, Col3 From AnotherTable Where ID < 5`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T20:33:54.370

你也可以做

```
select *
into MyTable
from AnotherTable
where ID < 5 
```

这将使用所需的列创建 MyTable，并填写数据。

# winforms - WinForms：如何在即将显示时自定义工具提示？

> ID：223220
> 
> 赞同：1
> 
> 时间：2008-10-21T19:46:13.670
> 
> 标签：winforms, tooltip

我想为树视图中的每个项目和列表视图中的每个项目提供工具提示，并且列表视图中的每个子项目（即列）都不同。

我可以确定我想要显示的文本（使用当前鼠标位置的命中测试等）：

```
private void toolTip1_Popup(object sender, PopupEventArgs e)
{
   if (e.AssociatedControl == listView1)
   {
      toolTip1.SetToolTip(listView1, "foo");
   }
} 
```

但是任何设置工具提示文本的尝试都会导致[stackoverflow](http://stackoverflow.com)。

如何在工具提示（图标、标题、文本）出现之前对其进行自定义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T19:51:02.677

您需要在`Popup`事件处理程序中保护您的代码，这样如果您`SetToolTip`从其中调用，就不会`SetToolTip`再次调用。

就像是：

```
private bool updatingTooltip;
private void toolTip1_Popup(object sender, PopupEventArgs e)
{   
    if (!this.updatingTooltip && (e.AssociatedControl == listView1))
    {
        this.updatingTooltip = true;
        toolTip1.SetToolTip(listView1, "foo");
        this.updatingTooltip = false;
    }
} 
```

# database - Oracle 数据库角色 - 从没有模式标识符的模式的表中选择

> ID：223238
> 
> 赞同：2
> 
> 时间：2008-10-21T19:50:07.360
> 
> 标签：database, oracle, roles, grant

哪个 Oracle 数据库角色将允许用户在不指定模式标识符的情况下从另一个模式中的表中进行选择？即，作为用户A-将A.table上的选择授予用户B；然后B可以-“从表中选择*”而不指定'A'。我们的一个数据库允许这样做，另一个返回“表或视图不存在”错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-21T19:59:11.257

您可以为此创建同义词。在对象“A.CoffeeTable”上创建一个名为“CoffeeTable”的同义词。您可以创建一个公共同义词，这样每个人都可以看到它，或者只是用户 B 下的同义词。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T10:07:28.330

只是为了仔细检查您使用的模式是否没有表的私有同义词（或 Leigh 建议的视图），您可以执行以下操作

```
SELECT * FROM all_objects WHERE object_name = 'mytablename' 
```

并查看 owner 和 object_type 信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T02:43:15.480

如果没有同义词，模式 B 中是否有一个视图从模式 A 中的表中选择，使用与表相同的名称？在许多方面，这似乎是一个本地引用的表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-21T20:00:06.853

也许只有 current_schema 不同。尝试：

`alter session set current_schema=A`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T19:43:51.177

@erno-TOAD 没有向您显示公共同义词的原因可能是因为它过滤了列表中显示的信息-我面前没有蟾蜍，但我*认为*如果您右键单击选项卡，您将进入过滤选项（例如“仅显示架构拥有的对象”、“显示公共对象”、“显示系统对象”等）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T20:13:22.430

布雷特是对的。同义词用于此。实际上，在某些情况下，您不知道生产中的模式名称是什么。也许您将 A 用于某些模式名称，并且 A 已在某些 Oracle 实例中使用。

# c# - 我可以在 Visual Studio 中创建一个位于 .Designer.cs 文件旁边的文件吗？

> ID：223249
> 
> 赞同：8
> 
> 时间：2008-10-21T19:52:39.147
> 
> 标签：c#, .net, visual-studio-2008

在 Visual Studio 中，当您在解决方案中创建新的 Windows 窗体时会创建两个文件（例如，如果您创建 MyForm.cs，则还会创建 MyForm.Designer.cs 和 MyForm.resx）。后两个文件在解决方案资源管理器中显示为子树。

**有没有办法将文件添加到 Windows 窗体类的子树或组？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-21T19:55:09.127

在编辑模式下打开 .csproj，查找您想要在另一个文件下的文件，然后添加 DependentUpon 元素，如下所示：

```
<Compile Include="AlertDialog.xaml.cs">
  <DependentUpon>AlertDialog.xaml</DependentUpon>
</Compile> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-21T19:54:15.430

您需要直接编辑 csproj。有一个 DependentUpon 标记，您必须将其添加为要放置在 MyForm.cs 下的文件的子标记。

例子：

```
<Compile Include="MyForm.MyCoolSubFile.cs">
  <DependentUpon>MyForm.cs</DependentUpon>
</Compile> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-21T19:56:21.060

是的，但这有点麻烦——基本上你需要手动编辑项目文件。

这是我和 Marc Gravell 共同从事的一个项目的示例：

```
<Compile Include="Linq\Extensions\DataProducerExt.cs" />
<Compile Include="Linq\Extensions\DataProducerExt.SingleReturn.cs">
  <DependentUpon>DataProducerExt.cs</DependentUpon>
</Compile>
<Compile Include="Linq\Extensions\DataProducerExt.Grouping.cs">
  <DependentUpon>DataProducerExt.cs</DependentUpon>
</Compile>
<Compile Include="Linq\Extensions\DataProducerExt.Pipeline.cs">
  <DependentUpon>DataProducerExt.cs</DependentUpon>
</Compile>
<Compile Include="Linq\Extensions\DataProducerExt.Conversion.cs">
  <DependentUpon>DataProducerExt.cs</DependentUpon>
</Compile>
<Compile Include="Linq\Extensions\DataProducerExt.Math.cs">
  <DependentUpon>DataProducerExt.cs</DependentUpon>
</Compile> 
```

Note the "DependentUpon" element in each of the dependencies. This displays appropriately in VS, with DataProducerExt.cs as the parent.

# dll - 从 VBScript 中检索 DLL 元数据？

> ID：223252
> 
> 赞同：0
> 
> 时间：2008-10-21T19:53:42.000
> 
> 标签：dll, scripting, vbscript, wsh

仅使用 VBScript（从 Windows 脚本主机启动）可以从 kernel32.dll 中提取 DLL 元数据吗？具体来说，我正在寻找 DLL 标头中指定的版本信息和体系结构。这可以在没有任何依赖关系的情况下完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T20:01:10.130

如果您只是在寻找版本，则可以使用[`FileSystemObject`](http://msdn.microsoft.com/en-us/library/b4e05k97.aspx).

如果您正在寻找 FileVersion 之外的其他信息，这里有一些预先编写的[代码](http://www.jsware.net/jsware/scripts.php5#fvinfo)。

# c# - 仅当程序集发生更改时，如何使用 MSBuild 更新版本信息？

> ID：223253
> 
> 赞同：8
> 
> 时间：2008-10-21T19:53:59.690
> 
> 标签：c#, asp.net, installation

我需要将多个 Web 设置项目（使用 VS2005 和 ASP.Net/C#）安装到同一个虚拟文件夹中。这些项目共享一些程序集引用（文件系统都被构造为使用相同的“bin”文件夹），使对这些程序集的更改的部署有问题，因为 MS 安装程序只会在当前安装的版本比微星。

我并不是说悲观的安装方案是错误的——只是它在我工作的环境中造成了问题。由于有大量通用程序集和大量开发人员可能会更改通用程序集但忘记更新其版本号，因此尝试手动管理版本控制最终会导致安装时出现大量混乱。

在这个问题的另一面，同样重要的是不要在*每次安装时自发更新版本号并替换**所有*常见的程序集，因为这可能（至少暂时）掩盖实际更改的情况。

 *也就是说，我正在寻找的是一种仅在程序集组成部分（代码模块、资源等）已经/已经实际更改的情况下更新程序集版本信息（最好使用 MSBuild）的方法。

[我在这里](http://social.msdn.microsoft.com/Forums/en-US/msbuild/thread/94054d89-ba19-4658-9e4e-ce7d8ff4dea3/ "这里")找到了一些至少部分相关的参考资料（MSDN 上的 AssemblyInfo 任务）和[此处](http://code.msdn.microsoft.com/AssemblyInfoTaskvers/Release/ProjectReleases.aspx?ReleaseId=232 "这里")（看起来与我需要的相似，但已有两年多的历史，并且没有明确的解决方案）。

我的团队还使用 TFS 版本控制，因此自动化解决方案可能应该包括一种可以在构建期间签出/签入 AssebmlyInfo 的方法。

任何帮助将非常感激。

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-22T00:55:07.650

我无法回答您的所有问题，因为我没有 TFS 经验。

但我可以推荐一种比使用 AssemblyInfo 任务更好的方法来更新您的 AssemblyInfo.cs 文件。该任务似乎只是从头开始重新创建一个标准的 AssemblyInfo 文件，并且丢失了您可能添加的任何自定义部分。

出于这个原因，我建议您从 MSBuild 社区任务项目中查看 FileUpdate 任务。它可以在文件中查找特定内容并替换它，如下所示：

```
<FileUpdate 
Files="$(WebDir)\Properties\AssemblyInfo.cs"
Regex="(\d+)\.(\d+)\.(\d+)\.(\d+)"
ReplacementText="$(Major).$(ServicePack).$(Build).$(Revision)" 
Condition="'$(Configuration)' == 'Release'"
/> 
```

有几种方法可以控制内部版本号的递增。因为我只想在构建完全成功时增加构建号，所以我使用了两步法：

*   从文本文件中读取一个数字（文件中唯一的就是数字）并加 1 而不更改文件；
*   作为构建过程的最后一步，如果一切成功，将递增的数字保存回文本文件。

有诸如 ReadLinesFromFile 之类的任务可以帮助您解决此问题，但我发现编写一个小型自定义任务最容易：

```
using System;
using System.IO;
using Microsoft.Build.Framework;
using Microsoft.Build.Utilities;

namespace CredibleCustomBuildTasks
{
    public class IncrementTask : Task
    {
        [Required]
        public bool SaveChange { get; set; }

        [Required]
        public string IncrementFileName { get; set; }

        [Output]
        public int Increment { get; set; }

        public override bool Execute()
        {
            if (File.Exists(IncrementFileName))
            {
                string lines = File.ReadAllText(IncrementFileName);
                int result;
                if(Int32.TryParse(lines, out result))
                {
                    Increment = result + 1;
                }
                else
                {
                    Log.LogError("Unable to parse integer in '{0}' (contents of {1})");
                    return false;
                }
            }
            else
            {
                Increment = 1;
            }

            if (SaveChange)
            {
                File.Delete(IncrementFileName);
                File.WriteAllText(IncrementFileName, Increment.ToString());
            }
            return true;
        }
    }
} 
```

我在 FileUpdateTask 之前使用它来获取下一个内部版本号：

```
<IncrementTask 
IncrementFileName="$(BuildNumberFile)" 
SaveChange="false">
  <Output TaskParameter="Increment" PropertyName="Build" />
</IncrementTask> 
```

作为我在构建中的最后一步（在通知其他人之前）：

```
<IncrementTask 
IncrementFileName="$(BuildNumberFile)" 
SaveChange="true"
Condition="'$(Configuration)' == 'Release'" /> 
```

您的另一个问题是如何仅在源代码更改时更新版本号，这在很大程度上取决于您的构建过程如何与源代码控制进行交互。通常，签入源文件更改应该启动持续集成构建。那是用来更新相关版本号的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-25T05:22:18.597

我写了一个客户任务，你可以参考下面的代码。它将创建一个实用程序，您可以将程序集信息路径主要、次要和内部版本号传递给该实用程序。您可以对其进行修改以获取修订号。因为在我的情况下，这个任务是由开发人员完成的，我曾经搜索它并再次替换整个字符串。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.Text.RegularExpressions;

namespace UpdateVersion
{
    class SetVersion
    {
        static void Main(string[] args)
        {
            String FilePath = args[0];
            String MajVersion=args[1];
            String MinVersion = args[2];
            String BuildNumber = args[3];
            string RevisionNumber = null;

            StreamReader Reader = File.OpenText(FilePath);
            string contents = Reader.ReadToEnd();
            Reader.Close();

            MatchCollection match = Regex.Matches(contents, @"\[assembly: AssemblyVersion\("".*""\)\]", RegexOptions.IgnoreCase);
            if (match[0].Value != null)
            {
                string strRevisionNumber = match[0].Value;

                RevisionNumber = strRevisionNumber.Substring(strRevisionNumber.LastIndexOf(".") + 1, (strRevisionNumber.LastIndexOf("\"")-1) - strRevisionNumber.LastIndexOf("."));

                String replaceWithText = String.Format("[assembly: AssemblyVersion(\"{0}.{1}.{2}.{3}\")]", MajVersion, MinVersion, BuildNumber, RevisionNumber);
                string newText = Regex.Replace(contents, @"\[assembly: AssemblyVersion\("".*""\)\]", replaceWithText);

                StreamWriter writer = new StreamWriter(FilePath, false);
                writer.Write(newText);
                writer.Close();
            }
            else
            {
                Console.WriteLine("No matching values found");
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-08T14:00:46.040

我不想这么说，但看起来你可能做错了。如果您确实即时生成程序集版本而不是尝试修补它们，那么会容易得多。

看看[https://sbarnea.com/articles/easy-windows-build-versioning/](https://sbarnea.com/articles/easy-windows-build-versioning/)

为什么我认为你做错了？* 一个版本不应该修改版本号 * 如果你两次构建相同的变更集，你应该得到相同的版本号 * 如果你把内部版本号放在微软所谓的内部版本号中（正确的命名是 PATCH 级别）你最终会达到 65535局限性。

# apache-flex - How far can you push Flex built-in tool-tip functionality?

> ID：223255
> 
> 赞同：0
> 
> 时间：2008-10-21T19:54:16.010
> 
> 标签：apache-flex

Looking at tooltip support in Flex, I've seen you can apply colors and styles to modify the appearance. Is it possible to do cooler stuff like make tool tips appear with a simple animation like how menus work on modern Windows apps?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T20:10:48.720

Take a look at the ToolTipManager class ([http://livedocs.adobe.com/flex/3/langref/mx/managers/ToolTipManager.html](http://livedocs.adobe.com/flex/3/langref/mx/managers/ToolTipManager.html)). It has a "showEffect" property which is what you are looking for I suppose.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T12:45:55.357

Take a look here: [http://blog.flexmonkeypatches.com/the-monkey-index/tooltips/](http://blog.flexmonkeypatches.com/the-monkey-index/tooltips/)
You'll find A TON of useful tutorials/docs about Flex tooltips !

# c# - 如何打开替代网络浏览器（Mozilla 或 Firefox）并显示特定 URL？

> ID：223268
> 
> 赞同：11
> 
> 时间：2008-10-21T19:59:07.013
> 
> 标签：c#, .net, browser

我知道有内置的 Internet Explorer，但我正在寻找的是使用指定的 URL 打开 Firefox/Mozilla 窗口（运行应用程序）。任何人都可以告诉我如何在 C# (.nET) 中做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-03-23T08:05:37.380

你可以这样做：

```
System.Diagnostics.Process.Start("firefox.exe", "http://www.google.com"); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-21T20:14:09.587

这将启动系统定义的默认浏览器：

```
string url = "http://stackoverflow.com/";
System.Diagnostics.Process.Start(url); 
```

请记住，如果浏览器配置不正确， Process.Start(url) 可能会引发异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T20:03:42.777

请参阅 ProcessInfo.UseShellExecute

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T20:03:39.360

使用使用 URL 作为进程名称的进程类 (System.Diagnostics)。这将使用系统默认浏览器打开 URL。如果您指定浏览器，您将面临浏览器不存在的风险。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T20:04:16.957

在 Visual Studio 中，单击菜单上的文件 -> 浏览方式...，然后选择要使用的浏览器。您也可以在那里更改浏览器。如果没有出现 Browse With... 菜单选项，那么您需要从解决方案中选择一个可以在浏览器中启动的项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T20:09:45.587

如果您明确不想使用用户的默认浏览器，您可以使用 URL 作为第一个参数来运行浏览器。

> ```
> C:\Program Files\Mozilla Firefox>firefox.exe http://google.com 
> ```

为我启动带有 google 的 Firefox。但正如人们所说，你冒着没有安装它的风险，或者安装到不同的地方等等。

# sql-server - MSSQL 存储过程中变量的语法是什么？

> ID：223272
> 
> 赞同：5
> 
> 时间：2008-10-21T19:59:21.520
> 
> 标签：sql-server, syntax

我有一个这样的简单查询：

```
select * from mytable where id > 8 
```

我想让 8 成为变量。有一些语法像

```
declare @myvar int
myvar = 8 
```

但我不知道确切的语法。

它是什么？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-21T20:01:06.713

它的：

```
DECLARE @MyVariable INT
SET @MyVariable = 8 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-21T20:01:58.630

```
declare @myvar int

Set @myvar = 8

select * from mytable where id > @myvar 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-21T22:39:12.523

澄清一下：SET 和 SELECT 都有效，但 SET 是 ANSI 标准。但是，如果您一次设置多个值，那么

```
SET @one = 1
SET @two = 2 
```

会比

```
SELECT @one = 1, @two = 2 
```

但是，您在速度上获得的收益很可能会被可读性和清晰度所抵消。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T20:01:03.920

```
declare @myvar int

select @myvar = 8 
```

# windows-mobile - 从 Windows Mobile (.NET 3.5) 调用 Web 服务的最佳方式是什么

> ID：223274
> 
> 赞同：0
> 
> 时间：2008-10-21T19:59:34.110
> 
> 标签：windows-mobile, compact-framework

使用 CF 3.5 从 Web 服务获取数据的首选方式是什么？我正在从网络服务中取回一系列表格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T21:24:23.267

正如 John 所指出的，它实际上与桌面调用没有什么不同。您通常可以从 IDE 添加对服务的引用并让 Studio 生成调用包装器，或者您可以手动敲定它。如果您尝试传递强类型数据集，您的情况可能会略有不同，因为桌面的序列化可能与设备想要的反序列化不匹配。这实际上取决于您的确切使用场景。

无论您的调用机制如何，需要注意的一点是 CF Web 服务调用生成代理的速度非常慢。代理已缓存，但在第一次调用时仍可能需要几秒钟才能返回。一个好的做法是让 Web 服务公开一个简单的虚拟方法（或如果适用，则为真正的方法），它什么都不做，但可能返回一个 blittable 类型。当应用程序启动时，产生一个工作线程来调用该方法，这将反过来生成代理。然后，当您需要调用服务以获取真实数据时，时间仅用于服务调用，而不是生成代理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T20:09:19.333

我一直只使用 WebRequest/WebResponse 类；或 HttpWebRequest/HttpWebResponse 类（如果需要）。它们使用起来有点乏味，并且不如完整的框架 WebClient 类那么好，但它们可以工作。

# .net - .NET EXE 内存占用

> ID：223283
> 
> 赞同：22
> 
> 时间：2008-10-21T20:01:24.123
> 
> 标签：.net

即使是 C# 中的简单[记事本](http://en.wikipedia.org/wiki/Notepad_%28software%29)应用程序也会消耗数兆字节的 RAM，如任务管理器中所示。在最小化应用程序时，任务管理器中的内存大小会显着下降，并在应用程序最大化时备份。

我在某处读到 .NET 进程提前为运行时分配预留了大量内存。这就是为什么 .NET 应用程序一开始就有更大的内存占用。但是可以使用 Win32 API 调用来释放此内存。一个权衡是运行时分配变得缓慢 - 这是真的吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-21T20:06:20.307

大内存占用的原因是 JIT 编译器和[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)引擎正在与您的进程一起加载。为了减少这种情况，您可以执行以下操作：

```
[DllImport("psapi.dll")]
static extern int EmptyWorkingSet(IntPtr hwProc);

static void MinimizeFootprint()
{
    EmptyWorkingSet(Process.GetCurrentProcess().Handle);
} 
```

这应该尽可能多地从您的内存占用中删除。可能还有一种方法可以减少为运行时内存分配预留的内存量。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-10-21T20:20:17.343

TaskManager 不应用于测量 .NET 应用程序的内存占用。

当 .NET 应用程序启动时，它会向操作系统请求一块内存，然后将其分段成为托管堆、堆栈和大型对象堆。TaskManager 报告的正是这个总内存块，它可能会或可能不会被 .NET 完全使用。一旦为 .NET 应用程序提供了一块内存，它将在操作系统要求之前不会释放它，这只会在操作系统确定需要更多内存资源时发生。

如果要测量内存分配，则需要查看各种性能监视器 (PerfMon) 计数器。

您可以使用互操作代码调用 Win32 API 来调整您的工作集大小，但是下次您的应用程序从操作系统请求内存时，工作集将重新启动，并且在操作系统分配和分发额外的内存时会影响性能内存和 .NET 运行时“配置”它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-21T20:06:44.970

任务管理器不显示 .NET 应用程序的实际内存使用情况。要查看您几乎必须在应用程序上放置一个性能计数器或使用分析器。

您在任务管理器中看到的是应用程序的工作内存，其中包括框架本身的大量开销，这些开销也必须在您的应用程序加载时加载。

# php - 假定有效的正则表达式在 PHP 中不返回任何数据

> ID：223285
> 
> 赞同：1
> 
> 时间：2008-10-21T20:01:39.830
> 
> 标签：php, regex

我正在使用以下代码：

```
<?php
$stock = $_GET[s]; //returns stock ticker symbol eg GOOG or YHOO
$first = $stock[0];

$url = "http://biz.yahoo.com/research/earncal/".$first."/".$stock.".html";
$data = file_get_contents($url);

$r_header = '/Prev. Week(.+?)Next Week/';
$r_date = '/\<b\>(.+?)\<\/b\>/';

preg_match($r_header,$data,$header);
preg_match($r_date, $header[1], $date);

echo $date[1];
?> 
```

我在[这里](http://www.quanetic.com/regex.php)检查了正则表达式，它们似乎是有效的。如果我只检查 $url 或 $data 它们会正确显示，并且如果我打印 $data 并检查源代码，那么我正在寻找在正则表达式中使用的代码就在那里。如果您有兴趣检查任何内容，正确 URL 的示例是[http://biz.yahoo.com/research/earncal/g/goog.html](http://biz.yahoo.com/research/earncal/g/goog.html)

我已经尝试了所有我能想到的方法，包括 var_dump($header) 和 var_dump($date)，它们都返回空数组。

我已经能够创建其他有效的正则表达式。例如，以下正确返回“收益”：

```
$r_header = '/Company (.+?) Calendar/';
preg_match($r_header,$data,$header);
echo $header[1]; 
```

我要疯了，试图弄清楚为什么这不起作用。任何帮助都是极好的。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-21T20:26:02.403

您的正则表达式不允许 HTML Try 中的换行符：

```
$r_header = '/Prev\. Week((?s:.*))Next Week/'; 
```

告诉它匹配(match any)中的`s`换行符。`.`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-21T20:29:07.747

问题是 HTML 中有换行符，您需要将其与 s 正则表达式修饰符合并，如下所示

```
<?php
$stock = "goog";//$_GET[s]; //returns stock ticker symbol eg GOOG or YHOO
$first = $stock[0];

$url = "http://biz.yahoo.com/research/earncal/".$first."/".$stock.".html";
$data = file_get_contents($url);

$r_header = '/Prev. Week(.+?)Next Week/s';
$r_date = '/\<b\>(.+?)\<\/b\>/s';

preg_match($r_header,$data,$header);
preg_match($r_date, $header[1], $date);

var_dump($header);
?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T20:28:17.827

1.  默认情况下，点不匹配换行符。采用`/your-regex/s`
2.  `$r_header`应该是`/Prev\. Week(.+?)Next Week/s`
3.  仅供参考：您不需要逃避`<`并`>`使用正则表达式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-21T20:31:25.870

您要添加`s (PCRE_DOTALL)`修饰符。默认情况下`.`不匹配换行符，我看到页面在您查找的两个部分之间有它们。

**旁注：**虽然它们不会受到伤害（可读性除外），但您不需要在`<`and之前使用反斜杠`>`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T20:23:36.527

我认为这是因为您将值应用于正则表达式，就好像它是纯文本一样。但是，它是 HTML。例如，应修改您的正则表达式以解析：

`<a href="...">Prev. Week</a> ...`

不解析常规纯文本，例如：“Prev. Week ....”

# c# - asp.net 页面方法返回未定义

> ID：223308
> 
> 赞同：2
> 
> 时间：2008-10-21T20:10:31.950
> 
> 标签：c#, asp.net, asp.net-ajax

我正在尝试在我的 asp.net 页面中使用页面方法。我已在脚本管理器上启用页面方法设置为 true，该方法上定义的 webmethod 属性，该函数是公共静态字符串，我知道该函数有效，因为当我从后面的代码运行它时，它会生成预期的结果，但是当我在结果函数中通过 page 方法调用它，结果总是被警告为未定义。如果我使用提琴手，它甚至看起来都没有额外的流量或创建了新的请求。如果这有所作为，我将在端口 82 上运行该站点。我在这里不知所措。有人可以给我一些指示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T21:07:48.700

在您的 PagesMethods 调用中，从回调函数和错误函数中删除括号：

```
PageMethods.getAdCodeInfo(value, onSuccess, onError) 
```

`onSuccess`并且`onError`基本上是指向函数的变量。因此，变量名称不需要括号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T20:52:07.390

好吧，愚蠢的我。这是一些代码。

```
 function getName()
 {
    var ddlAdCodes=$get('<%=ddlAdCodes.ClientID %>');
    var value=ddlAdCodes.options[ddlAdCodes.selectedIndex].value;
    //alert(value);
    PageMethods.getAdCodeInfo(value,onSuccess(),onError());
 }

 function onSuccess(result)
 {
    alert(result);
 }

 function onError(error)
 {
    alert("error "+error);
 } 
```

# html - bg 中是否加载 noscript 内容

> ID：223311
> 
> 赞同：6
> 
> 时间：2008-10-21T20:11:39.017
> 
> 标签：html, noscript

html 标签 noscript 是否在后台加载内容，即使启用了 javascript？

我有一个随机图像，每次页面加载时 JS 都会调用它，但我希望抓取所有链接（不仅仅是当前的随机链接）。同时，我不希望页面加载速度变慢，因为图像在后台加载，就像它们使用 display:none 一样。由于 Javascript 的 CMS 参考问题，我还想在 html 中调用这些图像和链接。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-21T20:29:51.320

启用 Javascript 时，根本不会加载 NOSCRIPT 标记中的图像引用。

您可以通过制作大量大图像来测试这一点，将它们放在 NOSCRIPT 标记中并观察浏览器活动。

# actionscript-3 - 使用方法 GET 的 URLRequest/URLStream 可以自定义标头吗？

> ID：223312
> 
> 赞同：4
> 
> 时间：2008-10-21T20:11:55.317
> 
> 标签：actionscript-3, http-headers

真的很简单：

```
var req:URLRequest=new URLRequest();
req.url="http://somesite.com";
var header:URLRequestHeader=new URLRequestHeader("my-bespoke-header","1");
req.requestHeaders.push(header);
req.method=URLRequestMethod.GET;
stream.load(req); 
```

但是，如果我使用 WireShark 检查流量，`my-bespoke-header`则不会发送。如果我更改为`URLRequestMethod.POST`并将一些数据附加到`req.data`，则发送标头，但接收应用程序需要 GET 而不是 POST。

该文档提到了一个不会发送的标头黑名单。`my-bespoke-header`不是其中之一。可能值得一提的是，原始请求来自同一域上的不同端口。策略文件日志中没有报告任何内容，因此似乎不太可能，但是`allow-http-request-headers-from`尽管这不是跨域问题，但可以通过强制加载带有 a 的 crossdomain.xml 来解决这个问题吗？或者它只是 Flash Player 的一个未记录的功能，它只能通过 POST 请求发送自定义标头？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-22T15:01:24.350

据我所知，您对 HTTP GET 缺乏自定义标头支持的假设似乎确实是标准库中未记录的功能（或错误？）。

无论如何，您可能想看看[as3httpclient](http://code.google.com/p/as3httpclient/)是否适合您的目的并让您解决这个问题。以下是该库开发人员博客中一篇[文章](http://www.abdulqabiz.com/blog/archives/flash_and_actionscript/http_authentica.php)的相关片段：

> *“我无法设置 HTTP/GET 请求的标头。Macromedia Flash Player 允许您仅为 POST 请求设置标头。我与 Ted Patrick 讨论了这个问题，他告诉我如何使用 Socket 来实现所需的和他非常好心地给了我一段代码，这让我开始了。”*

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T03:04:23.400

如果此限制曾经没有记录在案，则不再是这种情况。看：

[http://livedocs.adobe.com/flex/3/langref/flash/net/URLRequest.html#requestHeaders](http://livedocs.adobe.com/flex/3/langref/flash/net/URLRequest.html#requestHeaders)

“[...]**由于浏览器限制，自定义 HTTP 请求标头仅支持 POST 请求，不支持 GET 请求。** [...]”

# sql - 什么相当于 MySQL 中 MS Access 中的 Nz 函数？Nz 是 SQL 标准吗？

> ID：223313
> 
> 赞同：11
> 
> 时间：2008-10-21T20:11:56.940
> 
> 标签：sql, mysql, database, ms-access

什么是 MySQL 等效`Nz`于 Microsoft Access 中的函数？是`Nz`SQL 标准吗？

在 Access 中，该`Nz`函数允许您在变体为空时返回一个值。[来源](http://www.techonthenet.com/access/functions/advanced/nz.php)

该`Nz`函数的语法是：

```
Nz ( variant, [ value_if_null ] ) 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-21T21:24:47.277

该[`COALESCE()`](https://dev.mysql.com/doc/refman/8.0/en/comparison-operators.html#function_coalesce)功能按照您的描述进行。它是标准 SQL，所有 SQL 数据库都应该支持它。

该[`IFNULL()`](https://dev.mysql.com/doc/refman/8.0/en/flow-control-functions.html#function_ifnull)函数不是标准 SQL。只有部分品牌的数据库支持此功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-10T20:05:07.540

COALESCE 正是 OP 要求的，IFNULL 也是如此：

```
SELECT Nz(MightBeNullVar, 0) FROM ...  (MS Access version)
SELECT COALESCE(MightBeNullVar, 0) FROM ... (MySQL version)
SELECT IFNULL(MightBeNullVar, 0) FROM ... (MySQL version) 
```

不同之处在于 COALESCE 可以搜索多个变量并返回第一个非空变量：

```
SELECT COALESCE(MightBeNullVar, MightAlsoBeNullVar, CouldBeNullVar, 0) FROM ... (MySQL version) 
```

如果没有任何值具有设定值（为空），则每个都将返回 0（零）。

IFNULL 更快（毫无意义）。在处理 IFNULL 与 COALESCE 问题之前，您的查询中可能还有其他更好的东西需要优化。如果您要检查多项内容，请使用 COALESCE。如果您只有一个值要检查，请使用 IFNULL。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-21T20:16:26.917

您可能想查看`IFNULL`或`COALESCE`。如果我没记错的话，`IFNULL`适用于 MySQL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-28T13:34:58.120

看看空安全运算符 <=>

也许它可以帮助： [http ://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#operator_equal-to](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#operator_equal-to)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-08-31T20:09:12.033

也许了解 MS Access NZ() 函数的实际作用会有所帮助（在回答完全无效的建议之前）。NZ() 函数测试 Null 并将 Null 替换为空字符串、零或用户输入的可选值。

COALESCE 甚至没有接近，事实上，如果'List???'中没有任何 Null 值，它会返回 Null

IFNULL() 函数是您正在寻找的。

[http://dev.mysql.com/doc/refman/5.1/en/control-flow-functions.html](http://dev.mysql.com/doc/refman/5.1/en/control-flow-functions.html)

# c++ - 如何创建一个空的 DOMElement

> ID：223314
> 
> 赞同：2
> 
> 时间：2008-10-21T20:12:07.533
> 
> 标签：c++, xml, xerces

我在我的项目中使用 Xerces-c，并且想创建一个`DOMElement`而不需要创建一个全新的`DOMDocument`. 这样的事情可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T03:35:13.067

我还没有看到方法。AFAIK DOMDocument 充当“内存池”，所有元素都在此池中创建。在 Xerces[文档](http://xerces.apache.org/xerces-c/program-dom-3.html#DOMMemMgmt)中，我们看到：

> 由 DOMDocument::createXXXX 创建的对象 用户可以调用 release() 函数来指示任何孤立节点的释放。当一个孤立节点被释放时，其关联的子节点也将被释放。访问已发布的节点将导致意外行为。这些孤立节点最终将在其所有者文档发布时被释放，如果尚未这样做的话

我已经解决了这种情况，方法是保留一个*便签*本DOMDocument 并使用它来创建片段或孤立节点，并在我准备好时将它们采用到目标文档中。例如

```
// Create a fragment holding two sibling elements. The first element also has a child.
DOMDocumentFragment* frag = scratchDom->createDocumentFragment();
DOMNode* e1 = frag->appendChild( frag->getOwnerDocument()->createElement("e1") );
e1->appendChild( e1->getOwnerDocument()->createElement("e1-1") );
DOMNode* e2 = frag->appendChild( frag->getOwnerDocument()->createElement("e2") );
...
// Paste the contents of the fragment into a "parent" node from another document
DOMNode* parentFromOtherDom = ...;
parentFromOtherDom->appendChild( parentFromOtherDom->getOwnerDocument()->adopt(frag) );
scratchDom->removeChild(frag); 
```

# windows - 如何从 Windows 命令行构建 CD ISO 映像文件？

> ID：223316
> 
> 赞同：33
> 
> 时间：2008-10-21T20:12:53.490
> 
> 标签：windows, build-process, build-automation, iso

为了满足“乔尔测试”问题#2“你可以一步构建吗？”，我试图通过从收集的文件集合中创建一个 CD iso 来完成一个发布候选构建脚本，并且由安装程序创建者生成。

似乎有很多很好的工具（很多免费）可以创建 ISO，但我需要找到一个可以在 Windows 命令行上运行的工具，这样我就可以将它集成到由 Cruise Control 启动的 NAnt 构建脚本中。

构建环境为：

*   视窗服务器 2003
*   .NET 1.1 - 3.5（我们正在创建的应用程序基于 2.0）
*   NullSoft 安装程序 (NSIS)
*   CruiseControl.net
*   南安特

我一直在谷歌搜索，但还没有运气。

有人有推荐吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-21T20:17:16.070

试试 mkisofs。它是[cdrecord](http://freshmeat.net/projects/cdrecord/)项目的一部分。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-08-19T06:53:23.210

## 创建一个简单的 CD ISO

我发现了一种简单*得多*的方法，并且不需要 Cygwin：**[CDBurnerXP](http://cdburnerxp.se/)**

它并没有在网站上真正宣传，但它包括一个命令行版本，如`cdbxpcmd.exe`. 还有[一些关于命令行选项的文档](http://cdburnerxp.se/help/Appendices/commandlinearguments)。

特别感兴趣的是`-iso`和`-format`选项；使用了类似的东西：

```
cdbxpcmd --burn-data -folder:input -iso:output.iso -format:iso -changefiledates 
```

生成`output.iso`从文件`input`夹中的文件调用的 ISO

* * *

## 创建可引导 ISO

命令行工具似乎不允许您直接制作可引导 CD。但是，如果您知道您的文件列表不会更改（即仅这些文件的内容），您可以尝试以下操作（未经测试）：

*   加载 CDBurnerXP GUI 版本
*   以交互方式添加文件
*   选择光盘->刻录选项...
*   设置启动映像
*   选择File->Save创建一个DXP文件（是CDBurnerXP的编译格式）

然后，您可以使用以下命令

```
cdbxpcmd --burn-data -layout:mycompilation.dxp -iso:output.iso -format:iso 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-12-06T13:15:47.370

公然的插件，但我刚刚发布了一个可以创建 ISO 文件的开源 C# 库的 alpha 版本。不直接与 Nant 集成，但您可以封装库来实现这一点。有一个示例应用程序 (ISOCreate) 从目录结构创建 ISO，但此示例也可以帮助您入门：

```
CDBuilder builder = new CDBuilder();
builder.UseJoliet = true;
builder.VolumeIdentifier = "A_SAMPLE_DISK";
builder.AddFile(@"Folder\Hello.txt", Encoding.ASCII.GetBytes("Hello World!"));
builder.Build(@"C:\temp\sample.iso"); 
```

[.NET DiscUtils](https://github.com/DiscUtils/DiscUtils ".NET DiscUtils")（在 GitHub 上）

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-11-06T08:30:16.573

`mkisofs` [到这里](http://cdrecord.berlios.de/private/cdrecord.html)——它是 cdrtools 的一部分。适用于大多数平台。

用法示例：

```
mkisofs -v -dvd-video -V "VOLUME_NAME" -o "c:\my movies\iso\movie.iso" "c:\my movies\dvd"
mkisofs -r -R -J -l -L -o image-file.iso c:\project\install 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-06T09:11:54.040

If you want to be Microsoft addictive (not install additional software). You can use IMAPI, build into Windows to burn images. Additional information regarding scripting IMAPI [can be found in MSDN](http://www.microsoft.com/technet/scriptcenter/topics/imapi/imapi2-1.mspx)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-09-06T06:22:22.803

Powershell 可以创建 ISO。下面的示例包括一个 GUI。归功于[http://blog.apps.id.au/?p=5321](http://blog.apps.id.au/?p=5321)

[![在此处输入图像描述](https://i.stack.imgur.com/A36qZ.png)](https://i.stack.imgur.com/A36qZ.png)

```
# Author: Hrisan Dzhankardashliyski
# Date: 20/05/2015

# Inspiration from
#
#   http://blogs.msdn.com/b/opticalstorage/archive/2010/08/13/writing-optical-discs-using-imapi-2-in-powershell.aspx</a>
#
# and
#
#   http://tools.start-automating.com/Install-ExportISOCommand/</a>
#
# with help from
#
#   http://stackoverflow.com/a/9802807/223837</a>

$InputFolder = ""

function WriteIStreamToFile([__ComObject] $istream, [string] $fileName)
{
# NOTE: We cannot use [System.Runtime.InteropServices.ComTypes.IStream],
# since PowerShell apparently cannot convert an IStream COM object to this
# Powershell type.  (See <a href="http://stackoverflow.com/a/9037299/223837">http://stackoverflow.com/a/9037299/223837</a> for
# details.)
#
# It turns out that .NET/CLR _can_ do this conversion.
#
# That is the reason why method FileUtil.WriteIStreamToFile(), below,
# takes an object, and casts it to an IStream, instead of directly
# taking an IStream inputStream argument.

$cp = New-Object CodeDom.Compiler.CompilerParameters
$cp.CompilerOptions = "/unsafe"
$cp.WarningLevel = 4
$cp.TreatWarningsAsErrors = $true

Add-Type -CompilerParameters $cp -TypeDefinition @"
using System;
using System.IO;
using System.Runtime.InteropServices.ComTypes;

namespace My
{

public static class FileUtil {
public static void WriteIStreamToFile(object i, string fileName) {
IStream inputStream = i as IStream;
FileStream outputFileStream = File.OpenWrite(fileName);
int bytesRead = 0;
int offset = 0;
byte[] data;
do {
data = Read(inputStream, 2048, out bytesRead);
outputFileStream.Write(data, 0, bytesRead);
offset += bytesRead;
} while (bytesRead == 2048);
outputFileStream.Flush();
outputFileStream.Close();
}

unsafe static private byte[] Read(IStream stream, int toRead, out int read) {
byte[] buffer = new byte[toRead];
int bytesRead = 0;
int* ptr = &bytesRead;
stream.Read(buffer, toRead, (IntPtr)ptr);
read = bytesRead;
return buffer;
}
}

}
"@

[My.FileUtil]::WriteIStreamToFile($istream, $fileName)
}

# The Function defines the ISO parameturs and writes it to file
function createISO([string]$VolName,[string]$Folder,[bool]$IncludeRoot,[string]$ISOFile){

# Constants from <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa364840.aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/aa364840.aspx</a>
$FsiFileSystemISO9660   = 1
$FsiFileSystemJoliet    = 2
$FsiFileSystemUDF      = 4

$fsi = New-Object -ComObject IMAPI2FS.MsftFileSystemImage

#$fsi.FileSystemsToCreate = $FsiFileSystemISO9660 + $FsiFileSystemJoliet

$fsi.FileSystemsToCreate = $FsiFileSystemUDF
#When FreeMediaBlocks is set to 0 it allows the ISO file to be with unlimited size
$fsi.FreeMediaBlocks = 0
$fsi.VolumeName = $VolName

$fsi.Root.AddTree($Folder, $IncludeRoot)

WriteIStreamToFile $fsi.CreateResultImage().ImageStream $ISOFile
}

Function Get-Folder($initialDirectory)

{
[System.Reflection.Assembly]::LoadWithPartialName("System.windows.forms")

$foldername = New-Object System.Windows.Forms.FolderBrowserDialog
$foldername.rootfolder = "MyComputer"

if($foldername.ShowDialog() -eq "OK")
{
$folder += [string]$foldername.SelectedPath
}
return $folder
}

# Show an Open Folder Dialog and return the directory selected by the user.
function Read-FolderBrowserDialog([string]$Message, [string]$InitialDirectory, [switch]$NoNewFolderButton)
{
$browseForFolderOptions = 0
if ($NoNewFolderButton) { $browseForFolderOptions += 512 }
$app = New-Object -ComObject Shell.Application
$folder = $app.BrowseForFolder(0, $Message, $browseForFolderOptions, $InitialDirectory)
if ($folder) { $selectedDirectory = $folder.Self.Path }
else { $selectedDirectory = '' }
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($app) > $null
return $selectedDirectory
}

#Prompts the user to save the ISO file, if the files does not exists it will create it otherwise overwrite without prompt
Function Get-SaveFile($initialDirectory)
{
[System.Reflection.Assembly]::LoadWithPartialName("System.windows.forms") |
Out-Null

$SaveFileDialog = New-Object System.Windows.Forms.SaveFileDialog
$SaveFileDialog.CreatePrompt = $false
$SaveFileDialog.OverwritePrompt = $false
$SaveFileDialog.initialDirectory = $initialDirectory
$SaveFileDialog.filter = "ISO files (*.iso)| *.iso"
$SaveFileDialog.ShowHelp = $true
$SaveFileDialog.ShowDialog() | Out-Null
$SaveFileDialog.filename
}

# Show message box popup and return the button clicked by the user.
function Read-MessageBoxDialog([string]$Message, [string]$WindowTitle, [System.Windows.Forms.MessageBoxButtons]$Buttons = [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]$Icon = [System.Windows.Forms.MessageBoxIcon]::None)
{
Add-Type -AssemblyName System.Windows.Forms
return [System.Windows.Forms.MessageBox]::Show($Message, $WindowTitle, $Buttons, $Icon)
}

# GUI interface for the PowerShell script
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Drawing")
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms")  #loading the necessary .net libraries (using void to suppress output)

$Form = New-Object System.Windows.Forms.Form    #creating the form (this will be the "primary" window)
$Form.Text = "ISO Creator Tool:"
$Form.Size = New-Object System.Drawing.Size(600,300)  #the size in px of the window length, height
$Form.FormBorderStyle = 'FixedDialog'
$Form.MaximizeBox = $false
$Form.MinimizeBox = $false

$objLabel = New-Object System.Windows.Forms.Label
$objLabel.Location = New-Object System.Drawing.Size(20,20)
$objLabel.Size = New-Object System.Drawing.Size(120,20)
$objLabel.Text = "Please select a Folder:"
$Form.Controls.Add($objLabel)

$InputBox = New-Object System.Windows.Forms.TextBox
$InputBox.Location = New-Object System.Drawing.Size(150,20)
$InputBox.Size = New-Object System.Drawing.Size(300,20)
$InputBox.Enabled = $false
$Form.Controls.Add($InputBox)

$objLabel2 = New-Object System.Windows.Forms.Label
$objLabel2.Location = New-Object System.Drawing.Size(20,80)
$objLabel2.Size = New-Object System.Drawing.Size(120,20)
$objLabel2.Text = "ISO File Name:"
$Form.Controls.Add($objLabel2)

$InputBox2 = New-Object System.Windows.Forms.TextBox
$InputBox2.Location = New-Object System.Drawing.Size(150,80)
$InputBox2.Size = New-Object System.Drawing.Size(300,20)
$InputBox2.Enabled = $false
$Form.Controls.Add($InputBox2)

$objLabel3 = New-Object System.Windows.Forms.Label
$objLabel3.Location = New-Object System.Drawing.Size(20,50)
$objLabel3.Size = New-Object System.Drawing.Size(120,20)
$objLabel3.Text = "ISO Volume Name:"
$Form.Controls.Add($objLabel3)

$InputBox3 = New-Object System.Windows.Forms.TextBox
$InputBox3.Location = New-Object System.Drawing.Size(150,50)
$InputBox3.Size = New-Object System.Drawing.Size(150,20)
$Form.Controls.Add($InputBox3)

$objLabel4 = New-Object System.Windows.Forms.Label
$objLabel4.Location = New-Object System.Drawing.Size(20,120)
$objLabel4.Size = New-Object System.Drawing.Size(120,20)
$objLabel4.Text = "Status Msg:"
$Form.Controls.Add($objLabel4)

$InputBox4 = New-Object System.Windows.Forms.TextBox
$InputBox4.Location = New-Object System.Drawing.Size(150,120)
$InputBox4.Size = New-Object System.Drawing.Size(200,20)
$InputBox4.Enabled = $false
$InputBox4.Text = "Set ISO Parameters..."
$InputBox4.BackColor = "LimeGreen"
$Form.Controls.Add($InputBox4)

$Button = New-Object System.Windows.Forms.Button
$Button.Location = New-Object System.Drawing.Size(470,20)
$Button.Size = New-Object System.Drawing.Size(80,20)
$Button.Text = "Browse"
$Button.Add_Click({
$InputBox.Text=Read-FolderBrowserDialog
$InputBox4.Text = "Set ISO Parameters..."

})
$Form.Controls.Add($Button)

$Button2 = New-Object System.Windows.Forms.Button
$Button2.Location = New-Object System.Drawing.Size(470,120)
$Button2.Size = New-Object System.Drawing.Size(80,80)
$Button2.Text = "CreateISO"
$Button2.Add_Click({

if(($InputBox.Text -eq "") -or ($InputBox3.Text -eq "")){
Read-MessageBoxDialog "You have to select folder and specify ISO Volume Name" "Error: No Parameters entered!"
} else{
$SaveDialog = Get-SaveFile
#If you click cancel when save file dialog is called
if ($SaveDialog -eq ""){
return
}
$InputBox2.Text= $SaveDialog
$InputBox2.Refresh()
if($checkBox1.Checked){
$includeRoot=$true
}
else{
$includeRoot=$false
}
$InputBox4.BackColor = "Red"
$InputBox4.Text = "Generating ISO File!"
$InputBox4.Refresh()
createISO $InputBox3.Text $InputBox.Text $includeRoot $InputBox2.Text
$InputBox4.BackColor = "LimeGreen"
$InputBox4.Text = "ISO Creation Finished!"
$InputBox4.Refresh()
}
})
$Form.Controls.Add($Button2)

$objLabel5 = New-Object System.Windows.Forms.Label
$objLabel5.Location = New-Object System.Drawing.Size(20,160)
$objLabel5.Size = New-Object System.Drawing.Size(280,20)
$objLabel5.Text = "Check the box if you want to include the top folder:"
$Form.Controls.Add($objLabel5)

$checkBox1 = New-Object System.Windows.Forms.CheckBox
$checkBox1.Location = New-Object System.Drawing.Size(300,156)
$Form.Controls.Add($checkBox1)

$Form.Add_Shown({$Form.Activate()})
[void] $Form.ShowDialog() 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-22T09:18:49.613

我使用过magiciso，但尚未对其进行广泛测试。（经过一些测试，我可能会尝试这里提到的其他一些）我首先制作一个安装程序（单个文件），然后将其制作为 iso。

[http://www.magiciso.com/](http://www.magiciso.com/)

这是我努力让它在 python 中工作的结果：

```
add_option = '-a'
add_option_value = installer_fullpath
response_option = '-py' # answer yes to all options 

# Get the tempfile name -- to resolve long name issue
# --> My file names were initially too long for MagicIso and it would choke
f_handle = tempfile.TemporaryFile(suffix='.iso', prefix='mi_', dir='.')
temp_filename = f_handle.name
f_handle.close() # File automatically deleted on close                                

args = (magiciso_exe_fullpath,temp_filename,response_option,add_option,add_option_value)

# log output to file
magiciso_con_f = open(MAGICISO_CON_LOG,'w')

magiciso_process = subprocess.Popen(args,stdout=magiciso_con_f,stderr=magiciso_con_f)
magiciso_process.wait() 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-06T13:27:19.233

我正在使用[nLite](http://www.nliteos.com/download.html)或[BartPE](http://www.nu2.nu/pebuilder/#download)`mkisofs.exe`的安装套件，从中我还学习了构建可启动 cd 所需的参数。

# asp.net-mvc - 控制器实例上的 HttpContext 在 ASP.net MVC 中为空

> ID：223317
> 
> 赞同：29
> 
> 时间：2008-10-21T20:12:56.237
> 
> 标签：asp.net-mvc, httpcontext

这可能不是使用控制器的正确方法，但我确实注意到了这个问题并且没有想出纠正它的方法。

```
public JsonResult SomeControllerAction() {

    //The current method has the HttpContext just fine
    bool currentIsNotNull = (this.HttpContext == null); //which is false    

    //creating a new instance of another controller
    SomeOtherController controller = new SomeOtherController();
    bool isNull = (controller.HttpContext == null); // which is true

    //The actual HttpContext is fine in both
    bool notNull = (System.Web.HttpContext.Current == null); // which is false        

} 
```

我注意到控制器上的 HttpContext 不是您在 System.Web.HttpContext.Current 中找到的“实际”HttpContext。

有没有办法在控制器上手动填充 HttpContextBase？还是创建控制器实例的更好方法？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-10-22T14:13:51.110

现在我要做以下事情。这似乎是一个可以接受的修复...

```
public new HttpContextBase HttpContext {
    get {
        HttpContextWrapper context = 
            new HttpContextWrapper(System.Web.HttpContext.Current);
        return (HttpContextBase)context;                
    }
} 
```

这被添加到这些控制器继承自的控制器类中。

我不确定 HttpContext 为 null 是否是所需的行为，但这会同时为我修复它。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-22T14:19:29.227

Controllers are not designed to be created manually like you're doing. It sounds like what you really should be doing is putting whatever reusable logic you have into a helper class instead.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-21T22:44:28.740

ControllerContext 中的 HttpContext 为 null，因为在创建控制器时未设置它。控制器的构造器没有分配这个属性，所以它将为空。通常，HttpContext 设置为 ControllerBuilder 类的 HttpContext。控制器由 ControllerBuilder 类创建，然后是 DefaultControllerFactory。当您想创建自己的控制器实例时，可以将控制器的 ExecuteMethod 与您自己的 ControllerContext 一起使用。你不想这样做是一个真正的应用程序。当您对框架有更多经验时，您会找到合适的方法来做您想要的。当您在单元测试中需要 ControllerContext 时，您可以使用模拟框架来模拟 ControllerContext 或者您可以对它进行类伪造。

[您可以在此博客](http://www.codethinked.com/post/2008/09/27/ASPNET-MVC-Request-Flow.aspx)上找到 asp.net mvc 中的请求流模型。

当您刚接触 Asp.net mvc 时，值得努力下载源代码并阅读跟踪请求是如何处理的路由。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T20:17:08.567

您是否想使用控制器中的某些功能？或者让控制器执行一个动作？

如果是前者，也许那是一些应该被拆分成另一个类的代码。如果是后者，您可以这样做以简单地让该控制器执行特定操作：

```
 return RedirectToAction("SomeAction", "SomeOtherController", new {param1 = "Something" }); 

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T13:50:14.557

您使用的是控制器工厂吗？如果是这样，您如何注册组件？

我遇到了这个问题，我无意中将基于 HttpContext 的依赖项添加为 Singleton，而不是 Windsor 中的 Transient。

除第一个请求外，其他所有请求的 HttpContext 均为空。我花了一段时间才找到那个。

# version-control - Expression Web 源代码控制集成？

> ID：223321
> 
> 赞同：1
> 
> 时间：2008-10-21T20:14:10.867
> 
> 标签：version-control, visual-sourcesafe, expression-web, expression-studio

有谁知道 Expression Web（和 Blend，就此而言）是否与源代码管理有任何形式的直接集成？

现在，这是我们在使用它几天后发现的唯一真正的缺点。但这是一个**很大**的缺点。

快速编辑：

是的，我们目前正在使用恶魔生成源安全。（作为记录，对于我们正在做的规模庞大的团队和项目，它实际上已经足够了，并且除了由于缺乏交易签到而导致偶尔的构建打嗝之外，没有给我们带来任何痛苦。）但是，我一点也不在乎关于 Source Safe 本身——我试图找出是否有任何方法可以让 Expression 产品与任何源代码控制系统集成，无论是 Team Foundation Server、Subversion 还是任何东西。（是的，我们最终希望摆脱 VSS。如果只是为了阻止其他 Stack'ers 嘲笑我们。:)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-11T08:18:58.840

是的，现在有可用于 Blend 3 的 TFS 集成：http: [//blogs.msdn.com/unnir/archive/2009/03/17/team-foundation-server-support-in-blend-3.aspx](http://blogs.msdn.com/unnir/archive/2009/03/17/team-foundation-server-support-in-blend-3.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T20:17:02.733

我试着忍受你……但我就是做不到！我认为您可能已经到了摆脱 sourcesafe 的束缚的时候了！

安装颠覆，生活将再次美好。

# jquery - JQuery 在现有内容之上插入一个层

> ID：223322
> 
> 赞同：3
> 
> 时间：2008-10-21T20:14:39.307
> 
> 标签：jquery

当单击链接/按钮时，我正在尝试在我的网站上现有内容上方显示一个新图层。我正在使用 jquery - 但我拥有的代码似乎没有按预期工作。

这是我所拥有的：

```
 $(document).ready(function(){
  $("#button").click(function () {
  $("#showme").insertAfter("#bodytag")
  $("#showme").fadeIn(2000);
}); 
```

});

我想要的效果是`<div id="showme">...</div>`直接出现在#bodytag 之后。 `<div id="showme">...</div>`z-index 比网站上的其他任何东西都高，所以它应该直接出现在内容上方 #bodytag 之后。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T20:28:46.453

在我看来，要获得所需的效果，您插入#showme 的 div 必须是位置：相对，而#showme 应该是位置：绝对。绝对定位会将元素从文档流中取出，使其位于内容之上。

此外，还有两个提示 - $() 是 $(document) 的快捷方式，您可以链接 jQuery 命令：

```
$().ready(function(){
  $("#button").click(function () {
    $("#showme").insertAfter("#bodytag").fadeIn(2000);
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T20:16:45.387

确保`#showme`有一个`position`以外的`static`。

# apache-flex - 如何取消/不接受 Flex 3 中的拖放操作？

> ID：223324
> 
> 赞同：2
> 
> 时间：2008-10-21T20:15:07.853
> 
> 标签：apache-flex, actionscript-3, actionscript, flex3, drag-and-drop

**目标：** 允许用户通过从 AdvancedDataGrid 中拖动一行来删除记录，将其放到垃圾桶图标上，并通过带有“确定”和“取消”按钮的弹出警报验证用户是否打算这样做。

**什么工作：**

*   将一行拖放到垃圾桶图标上。
*   如果用户单击“确定”按钮，则删除该记录。
*   如果用户单击“取消”按钮，则操作被取消。

**问题：** 用户点击“取消”按钮，弹出警报关闭后，ADG 中的行无法拖动。我发现在对 ADG 进行排序后，通过单击列标题，用户可以再次开始拖动行。

**代码：（**从原始帖子更改）

```
<mx:Image source="{trashImage}" buttonMode="true" 
toolTip="drag a participant here to delete them from the project"
dragDrop="deleteParticipantDrop(event)" dragEnter="deleteParticipantEnter(event)" 
dragExit="deleteParticipantDragExit(event)" top="4" right="122" id="image2" />  

// trashImage Event Handlers:
private function deleteParticipantEnter(event:DragEvent):void
{
    var component:IUIComponent = IUIComponent(event.currentTarget);
    dragComponent = component;
    DragManager.acceptDragDrop(component);
    DragManager.showFeedback(DragManager.MOVE);
    deleteParticipantDragEvent = event;
}

private function deleteParticipantDrop(event:DragEvent):void
{
    var selectedKitNum:String = memberRpt.selectedItem.KitNum;
    var selectedName:String = memberRpt.selectedItem.ParticipantName;
    var component:IUIComponent = IUIComponent(event.currentTarget);
    dragComponent = component;
    DragManager.acceptDragDrop(component);
    isEditingParticipantInfo = false;
    isDeletingParticipant = true;
    deleteParticipantDropEvent = event;
    event.stopImmediatePropagation(); // Added as per mrm
    alert.confirm("Are you sure you want to delete this participant, Kit #" + memberRpt.selectedItem.KitNum + " ("  + 
        memberRpt.selectedItem.ParticipantName + ") from the project?  This cannot be reversed!!  An email will be " +
        "sent to notify this participant and you will receive a copy of it for your records.", confirmRemoveParticipant);
}

private function deleteParticipantDragExit(event:DragEvent):void
{
    var component:IUIComponent = IUIComponent(event.currentTarget);
    dragComponent = component;
    DragManager.acceptDragDrop(component);
    DragManager.showFeedback(DragManager.NONE);
}

private function confirmRemoveParticipant(event:CloseEvent):void
{
    if (event.detail == Alert.YES)
    {
        deleteReason = DeleteParticipantTitleWindow(PopUpManager.createPopUp( this, DeleteParticipantTitleWindow , true));
        dispatchEvent(deleteParticipantDropEvent); // Added as per mrm
        PopUpManager.centerPopUp(deleteReason);
        deleteReason.showCloseButton = true;
        deleteReason.title = "Reason for removal from project";
        deleteReason.addEventListener("close", cleanupRemoveParticipant);
        deleteReason["cancelButton"].addEventListener("click", cleanupRemoveParticipant);
        deleteReason["okButton"].addEventListener("click", finalizeDeleteParticipant);
        isDeletingParticipant = false; 
    }
    else
    {
        cleanupRemoveParticipant();
    }
}

private function cleanupRemoveParticipant(event:Event = null):void
{
    memberRpt.invalidateDisplayList();
    memberRpt.executeBindings();
    if (deleteReason != null)
    {
        PopUpManager.removePopUp(deleteReason);
        deleteReason = null;
    }
}

public function finalizeDeleteParticipant(event:Event):void
{
    if (deleteReason.reason.text != null)
    {
        selectedReportItem = memberRpt.selectedItem;
        selectedReportItemIndex = memberRpt.selectedIndex;
        memberReportData.removeItemAt(selectedReportItemIndex);
    }
    else
    {
        alert.info("You must provide a reason for removing a participant from your project!!");
    }

    cleanupRemoveParticipant();
} 
```

提前感谢所有有用的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-25T20:28:04.637

您是否尝试在取消事件后在 ADG 上运行 validateNow() 方法？

这是有关 validateNow() 方法的更多信息。

[为什么您需要了解 validateNow...](http://www.judahfrangipane.com/blog/?p=220)

我真的认为这就是你要找的东西！如果是这种情况，请告诉我们...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T13:23:41.663

DragManager.showFeedback(DragManager.NONE);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T20:30:55.653

尝试使用封闭控件中的 executeBindings 和/或 invalidateDisplayList 刷新数据网格上的数据绑定。

老实说，这听起来有点像一个错误。你在[flexcoders](http://tech.groups.yahoo.com/group/flexcoders/messages)上发布过这个吗？Adobe 的人在那里闲逛（可能也在这里，但肯定在那里）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T20:41:01.903

等等……刚刚发现在弹出事件和取消按钮之间有一个异步 Web 服务调用，它似乎由 GetParticipantOrderInformation 处理。那是对的吗？

如果是，那么在您这样做之前，您是否尝试过为“取消”提供一个更简单的对话框？我想知道事件层的组合是否会导致问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T23:05:06.980

通过 executeBindings 和 invalidateDisplayList 方法刷新数据网格上的数据绑定没有任何成功。在进行网络服务调用之前显示确认警报，我也没有任何运气。事实上，我发现完全没有必要进行 web 服务调用并将其删除。所以现在代码流程如下：

1.  将 ADG 行拖放到垃圾桶图标上。
2.  显示确认警报框。
3.  如果用户单击“取消”按钮，则重新显示 ADG。

但同样的问题仍然存在。我将使用最新代码更新**代码**部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T01:34:09.007

这是一个想法： - 就在您创建警报窗口之前，停止 DragEvent

```
event.stopImmediatePropagation();
```

*   存储事件，以便在用户单击“是”按钮时我们可以恢复

```
queuedEvent = 作为 DragEvent 的事件；
```

*   显示警报窗口
*   如果用户单击“是”按钮，则恢复排队的事件

```
调度事件（排队事件）；
```

# java - 为不同的语言环境定制 java.text 格式化程序

> ID：223325
> 
> 赞同：5
> 
> 时间：2008-10-21T20:15:34.607
> 
> 标签：java, localization, internationalization, locale

构建一个支持不同区域设置的 Java 应用程序，但希望自定义`DateFormat`显示超出 、 、 和 DateFormat 选项之间`FULL`可用`LONG`的`MEDIUM`内容`SHORT`。想做一些事情，比如在 a 的日期和时间组件之间放置一个字符`DateFormat.getDateTimeFormat()`，小写 AM/PM 等，至少对于英语。

可以想到3种方法来做到这一点：

`new SimpleDateFormat`1）如果语言环境是英语，请在对象上使用我的自定义格式字符串。

2) 修改现有语言环境的默认格式字符串

3）创建一个新的语言环境变体，指定我想要的格式字符串

无法弄清楚如何做 2 或 3（或者如果它甚至可能），并且宁愿不做 1 ......以前有没有人处理过这样的事情？

另外，小写 AM/PM 似乎需要 2 或 3 ？（为区域设置的日期格式设置指定 AmPmMarkers 资源）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T17:32:06.717

Java 有一个专门用于此的类，它是[ResourceBundle](http://java.sun.com/docs/books/tutorial/i18n/resbundle/index.html)类。[使用属性文件支持](http://java.sun.com/docs/books/tutorial/i18n/resbundle/propfile.html)它，您将拥有所需的一切以及更多。

即使没有 ResourceBundle 类，您也可以使用[属性](http://java.sun.com/javase/6/docs/api/java/util/Properties.html#load(java.io.Reader))文件来保存所有 SimpleDateFormat 格式。

```
Settings formats = new Settings();
Properties SDFFormats = formats.load(propertiesFile);

String SDFAmerica = SDFFormats.getProperty("FormatAmerica"); 
```

虽然属性文件中的条目可能会读取

```
FormatAmerica = MMM-dd-yyyy 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T23:53:45.463

为什么不改用 MessageFormat 呢？

使用模式“{0,date,short} your text here {0,time,short}”来做你想做的事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T15:55:13.603

我们想出的最令人满意的解决方法是从特定于语言环境的资源包中加载字符串 am,pm,formatString，然后：

```
SimpleDateFormat sdf = (SimpleDateFormat)sdf.getDateTimeInstance(DateTime.SHORT,DateTime.SHORT, locale);
if (formatString != null) {
    sdf = new SimpleDateFormat(formatString);
}
if (am!= null && pm != null) {
    DateFormatSymbols symbols = sdf.getDateFormatSymbols();
    symbols.setAmPmStrings(new String[]{am, pm});
    sdf.setDateFormatSymbols(symbols);
} 
```

保罗：不确定 DateFormatSymbols 中是否有分隔符......所以你可能需要保留 str.replace

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T09:19:37.257

我建议您使用[Joda Time](http://joda-time.sourceforge.net/)进行日期格式设置。它的格式具有强大而优雅的灵活性。您可能会发现它的格式化程序使您想做的事情变得非常简单。

顺便说一句：一旦你去了 Joda，你就再也回不去了！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T20:19:36.567

我处理过的唯一类似的事情是“strftime”和“locale”表示意大利语应该在时间字段之间使用冒号，但Java在它们之间放置句号。所以我添加了以下代码：

```
 // This is an incredibly ugly hack, but it's based on the fact that
  // Java for some reason decided that Italy uses "." between
  // hours.minutes.seconds, even though "locale" and strftime say
  // something different.
      hmsTimeFormat = DateFormat.getTimeInstance(DateFormat.MEDIUM);
      if (hmsTimeFormat instanceof SimpleDateFormat)
      {
        String str = ((SimpleDateFormat)hmsTimeFormat).toPattern();
        str = str.replace('.', ':');
        hmsTimeFormat = new SimpleDateFormat(str);
      } 
```

# asp.net - 与将 Web 应用程序保存在一个默认应用程序池中相比，拥有专用应用程序池的优缺点

> ID：223326
> 
> 赞同：35
> 
> 时间：2008-10-21T20:15:36.463
> 
> 标签：asp.net, iis, application-pool

与将 Web 应用程序保留在一个默认应用程序池中相比，拥有专用应用程序池的优点和缺点是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-21T20:44:38.823

优点：

*   应用程序彼此隔离，除非 IIS 与之配套，否则应用程序池锁定只会取出该池中的应用程序
*   能够在不同的 ASP.NET 运行时下运行应用程序，如果需要，一个池用于 1.1，另一个用于 2.0
*   能够为或多或少的关键应用程序设置不同的应用程序池设置。例如，ASP.NET 中的公司网站可能希望在 __ 分钟不活动后关闭，以防止卸载，因为响应至关重要。其他网站可能不需要它。
*   可以在文件访问方面相互保护池，非常适合第三方或不受信任的应用程序，因为它们可以在非常严格的用户帐户下运行。

缺点：

*   每个应用程序池都有自己的内存库和自己的进程，因此可以使用更多资源
*   有些人发现很难调试应用程序，因为您有多个进程

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-21T20:20:52.680

在应用程序池中组合站点的主要原因是为了节省内存。运行多个 w3wp.exe 进程会产生大量内存开销。如果您没有具体的理由将它们分开，最好将它们放在一起。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-21T20:18:55.070

专用应用程序池通常会防止一个站点中出现的问题影响其他站点。如果您跨站点共享应用程序池，则当仅特定站点（或应用程序池）存在错误情况时，您可以关闭盒子上的所有站点。

此外，如果您在同一 Web 服务器上混合 ASP.Net 版本，则每个 ASP.Net 版本至少需要不同的应用程序池，或者每个网站都需要不同的应用程序池。

我想不出不分离应用程序池的充分理由，这很容易做到。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-21T20:33:44.040

我同意杰森。

此外，您可以为不同的应用程序池指定不同的用户（例如 Windows 帐户）。这样就可以在数据库中设置具有不同权限的用户。这有助于增强安全性，并能够跟踪哪个网站/用户正在访问数据库，这在跟踪数据库性能问题时很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-23T03:27:20.383

如果您有单独的应用程序池，那么您会在第一个访问您网站的人的初始加载时间支付罚款，并在应用程序池回收后重新启动它。

例如，假设一夜之间没有人访问您的服务器，IIS 将停止运行（我相信默认为 20 分钟）。第一个访问服务器的人将遭受延迟，直到您的应用程序被加载回内存。

根据您部署站点的方式（例如发布模式等），这可能不是问题，也可能是烦人的。

这就是为什么我们正在考虑迁移到单个应用程序池/服务器，而不是为每个站点迁移 1 个。

# .net - 我应该打印异常堆栈跟踪吗？

> ID：223327
> 
> 赞同：3
> 
> 时间：2008-10-21T20:15:40.847
> 
> 标签：.net, debugging, error-handling, stack-trace

获取异常的堆栈跟踪效率有多低？我知道这很昂贵，但到底有多贵？它们绝对*不*应该在生产环境中使用吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-21T20:19:43.023

在生产环境中，*记录*堆栈跟踪很有帮助，以便用户在联系技术支持时可以找到它。应避免打印堆栈跟踪来代替可理解的（由典型用户）消息。

您不应该关心异常代码块的效率。错误恢复是这里最重要的事情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-21T20:19:49.950

如果异常出现在您的[关键路径](http://en.wikipedia.org/wiki/Critical_path_method)上，那么您已经遇到了性能问题。获取堆栈跟踪以追踪异常是*至关重要*的，IMO。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-21T20:22:20.740

我的问题是，当某些事情出乎意料地出错时，你为什么要关心性能？在这一点上，您的应用程序的健全性存在问题，所以谁在乎它是否快？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T20:39:54.590

账单点真的很重要，我添加了评论，但也想在这里添加答案。

在生产环境中，在面向公众的站点中，我永远不会将堆栈跟踪打印给用户。根据遇到的错误的性质，堆栈跟踪可能包含可能泄漏安全信息（数据库名称等）的信息。

同样的规则也适用于错误消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T20:18:28.080

如果我知道堆栈跟踪可能发生在严重依赖于其他部分或其他系统的系统的一部分中，我通常只打印或保存它。对于负责集成的部分尤其如此，因为错误可能是间歇性的，并且严重依赖于环境状态。

# python - 如何使用 BeautifulSoup 从 HTML 数据单元中获取文本

> ID：223328
> 
> 赞同：6
> 
> 时间：2008-10-21T20:16:13.670
> 
> 标签：python, html, parsing, beautifulsoup

我一直在尝试从 HTML 文件中删除一些数据。我有逻辑编码以获得正确的单元格。现在我正在努力获取“单元格”的实际内容：

这是我的 HTML 片段：

headerRows[0][10].contents

```
 [<font size="+0"><font face="serif" size="1"><b>Apples Produced</b><font size="3">       
  </font></font></font>] 
```

请注意，这是来自 Python [] 的列表项。

我需要 Apples Produced 的价值，但无法实现。

任何建议，将不胜感激

对一本解释这一点的好书的建议将赢得我永恒的感激

* * *

谢谢你的回答。然而，没有更普遍的答案。如果我的单元格没有粗体属性会怎样

说它是：

```
 [<font size="+0"><font face="serif" size="1"><I>Apples Produced</I><font size="3">       
  </font></font></font>] 
```

*生产的苹果*

我正在努力学习阅读/理解文档，您的回复将有所帮助

我真的很感激这个帮助。这些答案最好的一点是，从它们中概括起来要容易得多，然后我可以从 BeautifulSoup 文档中做到这一点。我在 Fortran 时代学会了编程，现在我正在学习 python，我对它的力量感到惊讶——BeautifulSoup 就是一个例子。制作一个连贯的整个文档对我来说很难。

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-21T21:14:21.743

[BeautifulSoup 文档](http://www.crummy.com/software/BeautifulSoup/documentation.html)应该涵盖您需要的所有内容 - 在这种情况下，它看起来像是您想要使用的`findNext`：

```
headerRows[0][10].findNext('b').string 
```

不依赖`<b>`标签的更通用的解决方案是使用[text](http://www.crummy.com/software/BeautifulSoup/documentation.html#arg-text)参数 to `findAll`，它允许您仅搜索`NavigableString`对象：

```
>>> s = BeautifulSoup(u'<p>Test 1 <span>More</span> Test 2</p>')
>>> u''.join([s.string for s in s.findAll(text=True)])
u'Test 1 More Test 2' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T08:30:14.033

```
headerRows[0][10].contents[0].find('b').string 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T23:57:03.133

我有一个基类，我用一堆方法扩展了所有 Beautiful Soup 类，这些方法帮助我在一组我不一定要依赖其结构的元素中获取文本。其中一种方法如下：

```
 def clean(self, val):
    if type(val) is not StringType: val = str(val)
    val = re.sub(r'<.*?>', '', s) #remove tags
    val = re.sub("\s+" , " ", val) #collapse internal whitespace
    return val.strip() #remove leading & trailing whitespace 
```

# c# - 具有多个 GUI 线程的 mdi 应用程序

> ID：223340
> 
> 赞同：3
> 
> 时间：2008-10-21T20:19:15.757
> 
> 标签：c#, multithreading

C# MDI 应用程序为 MDI 中的每个子级具有单独的 GUI 线程，这可能吗？

例如，如果其中一个子窗体被某个同步请求阻塞，它会冻结整个容器（ MDI Parent ）并且其他打开的窗口也变得可访问。

一般来说，.net windows form app domain 中是否可以有多个 GUI 线程？

在 Visual Studio 中，默认的 winform 应用程序具有**STA**（单线程单元）设置。从理论上讲，我理解**MTA**在这里的含义，但它的实际用途是什么。

在我的用例中，单个 mdi 子项是由不同的团队开发的，他们可能不会以异步方式推迟阻塞调用，所以我只是想知道是否可以有多个 UI 线程，尽管这不是可取的——我完全同意。

**编辑＃1：**

> 我可以将 google chrome 浏览器视为一个示例，其中单个选项卡是一个单独的进程，可能具有专用的 GUI 线程？在 dot.net 应用程序中是否可能发生这样的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T20:26:23.230

与其试图强制多个线程进入 GUI 层，不如让 GUI 层将其所有工作推迟到后台线程。这样，如果某个后台线程变得无响应，则包括反映无响应后台线程的 MDI 子项在内的整个 GUI 都会响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T20:52:21.133

不。您不能在 .NET 中使用多个 UI 线程。您最好使用后台线程来处理那里的耗时操作。如果您需要在操作运行时阻止窗口，最好创建一些解决方法。

# linux - 确定 Linux 上进程停滞的原因

> ID：223352
> 
> 赞同：5
> 
> 时间：2008-10-21T20:22:14.720
> 
> 标签：linux, process, resources, stalled

我正在尝试确定 Linux 上进程停滞的原因。这是一个电信应用程序，在相当重的负载下运行。8 个 T1 跨度中的每一个都有一个单独的过程。每隔一段时间，其中一个进程就会变得非常无响应 - 在通常非常繁忙的进程日志中记录事件之前最多可能 50 秒。

可能是某些系统资源不足。显而易见的事情 - CPU 使用率 - 看起来没问题。

哪些 linux 实用程序可能最适合捕获和分析这类事情，并且尽可能不引人注目，因为这是一个高负载系统？看起来，它需要是过程而不是面向系统的。也许对 /proc/pid/XX 的持续监控？Top 在这里似乎不太有用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-21T21:34:53.373

如果您能够发现这个“无响应的时刻”，那么您可以使用 strace 在此期间附加到有问题的进程，并尝试找出它“休眠”的位置：

```
strace -f -o LOG -p <pid> 
```

更轻量级但不太可靠的方法：

1.  当进程挂起时，使用 top/ps/gdp/strace/ltrace 找出进程的状态（例如它是否在“select”中等待或在某些库调用中消耗 100% cpu）

2.  了解相关调用的一般性质，定制 strace 的调用以记录特定的系统调用或系统调用组。例如，要仅记录与文件访问相关的系统调用，请使用：

    ```
    strace -e file -f -o LOG .... 
    ```

如果 strace 对您来说太重了，请尝试监控：

1.  “vmstat 1 > /some/log”的内存使用情况 - 可能在此期间进程正在被换入（或换出）

2.  vmstat/iotop 的 IO 使用 - 可能是其他一些进程正在破坏磁盘

3.  /proc/interrupts - 也许您的 T1 卡的驱动程序遇到问题？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T20:25:37.613

您可以对有问题的程序进行 strace 并查看它正在执行的系统调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T22:04:50.503

谢谢 - strace 听起来很有用。在正确的时间抓住这个过程将是乐趣的一部分。我想出了一个定期将时间戳写入共享内存的方案，然后用另一个进程进行监控。然后，发送 SIGSTOP 至少可以让我使用 gdb 检查应用程序堆栈。我不知道暂停进程上的 strace 是否会告诉我很多信息，但我也许可以打开 strace 看看它会说什么。或者打开 strace 并使用 SIGCONT 访问该进程。

# ruby-on-rails - Rails 忽略 render 和 redirect_to

> ID：223354
> 
> 赞同：5
> 
> 时间：2008-10-21T20:22:32.863
> 
> 标签：ruby-on-rails, ruby

我在这里有一个非常简单的 rails 问题，但我似乎无法在任何地方找到答案。我想一些问题源于我遵循 Rails 1.2 和 Rails 2.1 的教程。反正..

我正在写一个博客系统，我正在实现评论位。使用脚本/控制台创建评论后，我的评论显示良好，但让评论表单本身工作很难。

在 posts_controller.rb 我有

```
 def comment
    Post.find(params[:id]).comments.create(params[:comment])
    flash[:notice] = "Added comment"
    #render :action => show
    redirect_to :action => show
  end 
```

在 show.html.erb （视图）中我有

```
<%= form_tag :action => "comment", :id => @post %>
  <%= text_area "comment", "body" %><br>
  <%= submit_tag "Post Comment" %> 
```

当我提交表单时，它会尝试转到 urb /posts/comment/1，这显然是不正确的，并且它抱怨找不到模板。显然我不想要一个模板，因为我已经告诉它重定向到显示操作，因为我希望它只是重新显示帖子的显示页面，那里有新的评论。

我已经尝试了注释掉的行（render :action => show）和 redirect_to 行，但似乎都没有做任何事情。

我确定我错过了一些简单的东西，但它是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-21T21:29:47.970

`redirect_to :action => 'show', :id => params[:id]`周围的报价是否有效？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T21:23:25.157

Rails 2.1 包含“RESTful 资源”。`show`恰好是所有 Rails 控制器使用的预定义 REST 操作之一的名称。

Rails 在幕后做了一些魔术， :show 相当于“显示具有特定给定 ID 的特定元素”。听起来好像和那个混在一起了。ID 可能默认为“1”。因此，您从渲染调用中看到的生成的 URL

Rails 2.1 的做法将使用以下操作和模板：

*   `index`- 显示完整的评论列表
*   `create`- 添加新评论
*   `show`- 仅显示特定评论（不是完整列表）。听起来这不是你想要的，但 Rails 内部的“魔法”将默认为这个。

还有`new`（显示视图以输入新评论）`edit`（显示视图以编辑现有评论）`update`（处理更新提交）和`destroy`（duh）的操作，但看起来您不会在此使用它们例子。

你有教程的链接吗？将它移植到 Rails 2.1 风格不会太难。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-21T21:08:13.893

是的，您使用旧的导轨样式。

新鲜玩意：

```
 form_for :comment, :url => { :post_id => @post } do |f|
     f.text_area :body
     submit_tag "Post"
   end 
```

您可以将资源用于帖子和评论，在 google 上搜索更好的教程或安装 rails 1.2.6：

```
gem install -v 1.2.6 rails 
```

# svn - 在 SVN 中合并后我无法提交更改

> ID：223355
> 
> 赞同：5
> 
> 时间：2008-10-21T20:22:46.840
> 
> 标签：svn, tortoisesvn, merge, svn-merge

使用 TortoiseSVN 合并项目的两个分支后，我在提交更改时遇到了问题。

以下是详细信息：

我做了一个合并分支到我正在处理的*项目的主干。*

*项目*包括主存储库和与主存储库连接的库，作为*svn 外部*（库也有分支）作为*项目*的子目录。

当我试图提交更改时，TortoiseSVN 说：

```
Commit A
re all the targets part of the same working copy? 
Unable to lock 'D:\websites\project\lib' 
Please execute the "Cleanup" command. 
```

当然*清理*没有帮助。

**项目*目录的*svn:external*关键字定义良好， *lib*文件夹仍然包含正确版本的库（主干版本）。*

 *SVN 服务器和客户端都是 1.5.x 版本（TortoiseSVN 是 1.5.3.x）。

从技术角度来看，*项目*和*库*都是同一个 SVN 存储库中的项目。

知道出了什么问题吗？

我一直在谷歌上搜索解决方案，但没有发现任何有用的东西，所以我尝试分两步提交我的更改：

1.  从项目文件夹提交更改
2.  从库文件夹提交更改

这没有任何问题。

但我仍然想知道为什么我不能在一次提交中提交所有内容。

编辑：

*   （在 Ken G 回答后） TortoiseSVN 1.3.x -> 1.5.3.x 的固定版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T21:25:17.900

TortoiseSVN 1.3 已经**很老**了，最新的版本是 1.5.x。自 1.3 以来，Subversion 和 TortoiseSVN 都发生了许多变化，因此升级您的客户端可能是您最好的选择。

话虽如此，1.5 TortoiseSVN 将创建/更新工作副本到版本 1.5 格式。在使用 TortoiseSVN（或任何 SVN 客户端）对以前的 Subversion 的工作副本时要非常小心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T20:27:38.843

我想我记得在 TortoiseSVN 中读过一个与此相关的错误，该错误已在最新版本中修复。检查最新的[发行说明](http://tortoisesvn.tigris.org/tsvn_1.5_releasenotes.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T15:17:41.730

***svn:external***将导致 Subversion 在签出时合并不同的存储库路径，但最终这些路径仍然“不相交”，因此您必须执行两次提交才能应用更改。

[这是来自带有 Subversion 的版本控制](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.advanced.externals)的相关引用

> 而且 Subversion 仍然只在不相交的工作副本上运行。因此，例如，如果您想提交您在一个或多个外部工作副本中所做的更改，则必须在这些工作副本上显式运行 svn commit——在主工作副本上提交不会递归到任何外部工作副本.

# python - urllib2 何时真正从 url 下载文件？

> ID：223356
> 
> 赞同：2
> 
> 时间：2008-10-21T20:23:02.673
> 
> 标签：python

```
url = "http://example.com/file.xml"
data = urllib2.urlopen(url)
data.read() 
```

问题是，文件何时从互联网上下载？当我执行 urlopen 或 .read() 时？在我的网络接口上，我两次都看到高流量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-21T20:31:01.877

如果不看代码，我希望会发生以下情况：

1.  `urlopen()`打开连接，并发送查询。然后服务器开始提供回复。此时，数据在缓冲区中累积，直到它们已满，操作系统告诉服务器等待一段时间。
2.  然后`data.read()`清空缓冲区，所以操作系统告诉服务器继续，其余的回复被下载。

自然地，如果回复足够短，或者如果回复足够`.read()`快，那么缓冲区就没有时间填满，下载会一次性完成。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-21T23:48:31.357

我同意ddaa。但是，如果您想了解这类事情，您可以使用`nc`（在 *nix 中）之类的东西设置一个虚拟服务器，然后在交互式 Python 解释器中打开 URL。

在一个终端中，运行`nc -l 1234`它将打开一个套接字并侦听本地计算机端口 1234 上的连接。`nc`将接受传入连接并显示它从套接字读取的任何内容。您输入的任何内容都`nc`将通过套接字发送到远程连接，在这种情况下是 Python 的`urlopen()`.

在另一个终端中运行 Python 并输入您的代码，即

```
data = urllib2.urlopen('http://127.0.0.1:1234')
data.read() 
```

调用`urlopen()`将建立与服务器的连接，发送请求，然后阻塞等待响应。您将看到`nc`将 HTTP 请求打印到其终端。

现在在正在运行的终端中输入一些内容`nc`。调用`urlopen()`仍然会阻塞，直到您在 中按 ENTER `nc`，也就是说，直到它收到一个换行符。所以`urlopen()`在读取至少一个换行符之前不会返回。（对于那些担心可能缓冲的人`nc`，这不是问题。`urlopen()`将阻塞直到它看到第一个换行符。）

所以需要注意的是`urlopen()`会阻塞，直到接收到第一个换行符，之后才能从连接中读取数据。实际上，HTTP 响应是简短的多行响应，因此`urlopen()`应该很快返回。

# unicode - GB18030 与 Unicode 有何不同？

> ID：223360
> 
> 赞同：13
> 
> 时间：2008-10-21T20:24:54.947
> 
> 标签：unicode

中文 GB18030 代码集与 Unicode 有何不同？

办理GB18030需要哪些特殊技术？

是否有任何（开源）库用于处理 GB18030？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-21T22:33:45.093

根据[关于 GB18030 的 Wikipedia 文章](http://en.wikipedia.org/wiki/GB_18030)，“GB18030 可以被认为是一种 Unicode 转换格式（即所有 Unicode 代码点的编码），它保持与旧字符集的兼容性。” 也就是说，所有 Unicode 字符都可以用 GB18030 编码，但它们将使用不同于使用 UTF-8 或 UTF-16 生成的字节序列进行编码。处理 GB18030 编码不需要比任何其他非 Unicode 编码更多的特殊技术。

[ICU 项目](http://www.icu-project.org/)是一个开源库（用于 C 或 Java），它完全支持许多不同的编码，包括 GB18030。可以在[此处](http://icu-project.org/userguide/conversion.html)找到有关使用 ICU 在不同编码之间进行转换的信息。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-07-11T20:49:55.257

> 办理GB18030需要哪些特殊技术？

最需要注意的是，与 UTF-8 不同，GB18030 允许 ASCII 字节出现在多字节字符的编码中。（例如，'ß' 被编码为字节 81 **30** 89 **38**，其中包含 '0' 和 '8' 的 ASCII 编码。）这意味着您不能使用简单的面向字节的`find`/`index`函数。

# .net - ASP.NET MVC：使用 LINQ To SQL 将表单复选框放入多对多 DB 关联表的最佳方法？

> ID：223363
> 
> 赞同：12
> 
> 时间：2008-10-21T20:25:26.540
> 
> 标签：.net, asp.net-mvc, linq-to-sql, forms

我有一个 ASP.NET MVC 视图，其中包含用户定义类别的复选框。

```
<td><% foreach (Category c in (List<Category>)ViewData["cats"]) {
       if (selCats.ContainsKey(c.ID)) { %>
       <input name="CategoryIDs" type="checkbox" value="<%=c.ID %>" checked="checked" />&nbsp;<%= c.Name%><% } 
        else { %>
       <input name="CategoryIDs" type="checkbox" value="<%=c.ID %>" />&nbsp;<%= c.Name%> <% } %>
     <% } %>
</td> 
```

表单发布到以下控制器操作：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(int id, int [] CategoryIDs)
{
    PostsDataContext db = new PostsDataContext();
    var post = db.Posts.Single(p => p.ID == id);
    UpdateModel(post, new[] { "Title", "Subtitle", "RawContent", "PublishDate", "Slug" });
    db.SubmitChanges();
    return Redirect("/archives/" + post.Slug);
} 
```

表单复选框将被转换为一个整数 ID 数组“CategoryIDs”，每个代表一个选定的类别。然后，我想将它们放入包含两列的关联表中：PostID 和 CategoryID。这用于在帖子和类别之间建立多对多关联。

目前我正在强制它：遍历类别，并为每个类别添加一行到包含类别 ID 的关联表，以及它所属的帖子的 ID。

但是我想知道在 ASP.NET MVC 和 LINQ to SQL 的上下文中是否有一种更简洁的方法可以自动执行此操作？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T03:04:14.237

我认为你正在做的很好......我唯一要说的是，如果你不想循环遍历 ID，你可以使用“InsertAllOnSubmit”同时添加它们（即使这真的是也只是循环）：

```
int[] categoryIDs = new int[] { 0, 1, 2 };

dataContext.PostCategories.InsertAllOnSubmit(
categoryIDs.Select(id =>
    new PostCategory
    {
        CategoryID = id,
        PostID = myPostID
    })
); 
```

但无论哪种方式，这仍然和你所拥有的一样。

# database - 使用 OpenOffice DB 与 Microsoft Access 的主要缺点是什么？

> ID：223370
> 
> 赞同：6
> 
> 时间：2008-10-21T20:27:01.980
> 
> 标签：database, ms-access, openoffice.org

我知道 Open Office Database 使用 java 数据库后端。有没有人知道这与 Jet 数据库引擎相比如何？

查询设计器/报告是否与 MS Access 一样强大？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-21T20:33:10.983

我这么说很奇怪，因为我根本不是 Access 的粉丝。但是，我认为 Access 实际上是这里更好的产品，原因有很多：

*   它的存在时间更长（成熟度）
*   核心数据库引擎包含在 windows 中。
*   如果您的用户还没有 Access 并且您需要分发应用程序，则可以轻松分发运行时。
*   多年来，已经有足够多的人尝试将它用于它不适合做的事情（网站、工作组），他们已经在性能和并发性方面投入了足够多的工作，因此最近的两个版本（2003 年、2007 年）实际上非常强大如果您正在做一些它旨在做的事情（桌面 crud 应用程序，与链接的 sql server 表交谈，非常小的工作组）。（*我想这和第一点真的一样*）

另一方面，OpenOffice DB 没有任何*问题*，而且它是免费的。

# java - GWT 程序有没有办法判断它是处于托管模式还是网络模式？

> ID：223373
> 
> 赞同：8
> 
> 时间：2008-10-21T20:27:34.520
> 
> 标签：java, gwt

我希望我的 GWT 程序能够确定它是处于托管模式还是 Web 模式。有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-21T21:35:49.360

GWT.isScript() 在非托管模式下返回 true，在托管模式下返回 false。

[http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/core/client/GWT.html#isScript()](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/core/client/GWT.html#isScript())

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T22:41:43.017

小心这个。您仍然无法在语句中运行未模拟的 Java 代码。

```
if(GWT.isScript()) {
  //some code not in the JRE emulation here
} 
```

示例代码将导致编译时问题。

# xml - 为 SQL 2005 寻找一个好的批量插入 XML 粉碎示例

> ID：223376
> 
> 赞同：2
> 
> 时间：2008-10-21T20:28:15.597
> 
> 标签：xml, sql-server-2005, shred

需要一点帮助。我收到一个类似这样的 xml 文件：

```
<?xml version="1.0" encoding="utf-16"?>
<dc:GRANTEE xsi:schemaLocation="http://www.blahblahblah.com/FullSchema test.xsd " xmlns:dc="http://www.blahblahblah.com/FullSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <RPGID>90CU0024</RPGID>
    <PLANID>01</PLANID>
    <CASE>
        <CASEID>100001</CASEID>
        <RPGID>90CU0024</RPGID>
        <FILE_O>2008-02-08T00:00:00</FILE_O>
        <ADULT>
            <ADULTID>100001A1</ADULTID>
            <CASEID>100001</CASEID>
            <APRIMARY>1</APRIMARY>
            <ARLTNSHP>BM</ARLTNSHP>
            <ADOB>1978-12-03T00:00:00</ADOB>
            <ARACAI>1</ARACAI>
            <ASEX>2</ASEX>
            <SATX>
                <SATXID>MD2120378</SATXID>
                <ADULTID>100001A1</ADULTID>
                <SAASSESS>2008-02-22T00:00:00</SAASSESS>
                <PUBPRVTX>1</PUBPRVTX>
                <TXADMIT>2008-02-23T00:00:00</TXADMIT>
                <TXSET>5</TXSET>
            </SATX>
        </ADULT>
        <CHILD>
            <CHILDID>100001C1</CHILDID>
            <CASEID>100001</CASEID>
            <CINDEX>1</CINDEX>
            <CHBDATE>2008-02-05T00:00:00</CHBDATE>
            <CHSEX>1</CHSEX>
            <CHRACAI>0</CHRACAI>
            <MALTX>
                <MALTXID>10000023</MALTXID>
                <CHILDID>100001C1</CHILDID>
                <RPTDT>2008-02-05T00:00:00</RPTDT>
                <CHMAL1>2</CHMAL1>
             </MALTX>
         </CHILD>
    </CASE> 
```

我需要做的是导入它并将其切碎到带有存储过程的表中。除了在线书籍中的示例的一般反刍之外，我一直找不到任何东西，呃，在线。我需要的是一些语法演练，它显示了如何批量插入文件（使用 OPENROWSET？），然后获取所有数据并将其拆分到匹配的表中，同时维护键。看起来应该很容易，但参考资料却很难获得。如果需要，我也可以访问模式并且也可以进行注释。

有人有好的参考吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T08:41:47.750

您可以使用带有 RAW 关键字的 BULK INSERT 语句将数据加载到具有单列的表中。它会将整个文档放在一行中。然后查询表并将数据放入数据类型为 XML 的变量中。

这篇[博客文章](http://itknowledgeexchange.techtarget.com/sql-server/xml-in-the-database-whats-the-big-deal-any-way/)展示了如何从 XML 文档中获取数据。

# c# - .NET 运行时对象的内存占用是多少？

> ID：223384
> 
> 赞同：6
> 
> 时间：2008-10-21T20:29:58.837
> 
> 标签：c#, .net-3.5

我在运行时有一个静态对象，它基本上是其他对象（整数、字符串、字典、其他对象等）的列表。有没有办法确定我的静态“其他对象列表”对象在运行时使用的内存？这对于仪表和报告目的很方便。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T20:36:50.133

Sizeof 可用于值类型，还有 Marshal.SizeOf 可用于 .NET 的一些提示：

[http://www.pixelicious.net/2008/07/03/exception-trying-to-get-the-size-of-ac-class-using-marshalsizeof](http://www.pixelicious.net/2008/07/03/exception-trying-to-get-the-size-of-a-c-class-using-marshalsizeof)

但是......这并不是总成本，因为运行时确实为同步块等类分配了额外的字节。

但是，如果您真的对测量此类事物感兴趣，则应该使用分析 API：

[http://msdn.microsoft.com/en-us/library/ms404386.aspx](http://msdn.microsoft.com/en-us/library/ms404386.aspx)

或者像windbg这样的免费工具，可以做各种奇妙的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T20:35:30.170

您可能正在要求您可以从代码中调用的东西（我也想知道），但我觉得我应该提到 Ants profiler [ [http://www.red-gate.com/Products/ants_profiler/index.htm ]](http://www.red-gate.com/Products/ants_profiler/index.htm])以防其他人不寻找特定的东西。它会在代码执行时告诉您有关代码的各种信息，包括正在使用的内存量。

从他们的网站...

> 分析内存以了解您的应用程序如何使用内存并定位内存泄漏。内存分析器允许您在程序执行的任何时候拍摄快照，因此您可以查看当时正在使用的内存。您可以在应用程序运行时在不同时间拍摄多个快照，以便比较应用程序内存状态。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T20:49:09.657

试试 SOS 调试库。这是最好的。[这里](http://blogs.msdn.com/tess/pages/net-debugging-demos-information-and-setup-instructions.aspx)和[这里的](http://blogs.msdn.com/jasonz/archive/2004/04/05/108054.aspx)文章

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T20:42:12.387

不是没有探查器。仅仅对于一个班级来说已经够难了——请看[这里](https://stackoverflow.com/questions/207592/getting-the-size-of-a-field-in-bytes-with-c#207605)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T15:13:53.343

感谢您的回复。我认为我最初的攻击计划，因为我确信大多数对象都是可序列化的，将是这样的：

```
using (MemoryStream memstream = new MemoryStream())
{
    BinaryFormatter formatter = new BinaryFormatter();

    try
    {
        formatter.Serialize(memstream, myObjectOfObjects);
        mem_footprint += memstream.Length;
    }
    catch 
    {
        // not a serializable object 
    }
} 
```

# perl - 如何在 Perl 中获取字符串的长度？

> ID：223393
> 
> 赞同：56
> 
> 时间：2008-10-21T20:31:38.490
> 
> 标签：perl, string

Perl 的等价物是`strlen()`什么？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-10-21T20:32:52.547

`length($string)`

```
perldoc -f 长度

   长度 EXPR
   length 返回 EXPR 值的字符长度。如果 EXPR 是
           省略，返回 $_ 的长度。请注意，这不能用于
           整个数组或散列以找出它们有多少元素。为了
           也就是说，分别使用“scalar @array”和“scalar keys %hash”。

           注意字符：如果 EXPR 是 Unicode，你会得到 num-
           ber 字符，而不是字节数。得到长度
           字节，使用“做{使用字节；长度（EXPR）}”，见字节。

```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-10-22T14:19:45.840

尽管 'length()' 是应该在任何理智的代码中使用的正确答案，但应该提到[Abigail 的长度恐惧](https://web.archive.org/web/20071024192714/http://www.perlfoundation.org/perl5/index.cgi?abigail_s_length_horror)，即使只是为了 Perl 知识。

基本上，诀窍在于使用包罗万象的音译运算符的返回值：

```
print "foo" =~ y===c;   # prints 3 
```

y///c 用自己替换所有字符（感谢补码选项'c'），并返回替换的字符数（因此，实际上是字符串的长度）。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2008-10-22T00:12:38.420

```
length($string) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-26T07:00:14.930

`length()`功能：

```
$string ='String Name';
$size=length($string); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-11T14:34:30.533

您不应该使用它，因为 length($string) 更简单且更具可读性，但是我在查看代码时遇到了其中一些并且感到困惑，所以如果其他人这样做，这些也会得到字符串的长度：

```
my $length = map $_, $str =~ /(.)/gs;
my $length = () = $str =~ /(.)/gs;
my $length = split '', $str; 
```

The first two work by using the global flag to match each character in the string, then using the returned list of matches in a scalar context to get the number of characters. The third works similarly by splitting on each character instead of regex-matching and using the resulting list in scalar context

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-21T05:37:01.347

Not an answer but an observation: I'm running v5.30.2 built for darwin-2level, and I've noticed that if I don't `chomp` my input first (as with stdin), then calculate the length, the `length` of a single character is not 1, but 2.

Remember those newlines and other hidden characters that could be a factor.

And I would love to find Abigail's post, but alas it seems to have been consumed by the ether.

# asp.net - 跨站点脚本和 HTML 编码

> ID：223395
> 
> 赞同：2
> 
> 时间：2008-10-21T20:31:50.317
> 
> 标签：asp.net, xss, html-encode

如果我在重新显示网站用户输入的任何数据时对其进行 HTML 编码，这会防止 CSS 漏洞吗？

此外，是否有可用的工具/产品可以为我清理我的用户输入，这样我就不必编写自己的例程了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-21T21:01:38.557

这个问题有各种微妙之处，尽管总体上答案是肯定的。

*   您网站的安全性在很大程度上取决于您将数据放在哪里。如果你把它作为合法文本，攻击者基本上没有办法执行 XSS。如果你把它放在一个属性中，如果你忘记转义引号或者不检查多字节格式是否正确，你就有可能受到攻击。如果将它放在 JSON 变量中，则不正确转义可能会导致任意 JavaScript。等等等等。上下文非常重要。

*   其他用户建议使用 XSS 删除或 XSS 检测功能。我倾向于认为 XSS 删除对用户不友好；如果我发布了一个像 <foo@example.com> 这样的电子邮件地址，而您的删除 XSS 函数认为它是一个 HTML 标记，那么这个文本就会神秘地消失。如果我正在运行一个 XSS 论坛，我不希望人们的示例代码被删除。检测更明智一些；如果您的应用程序可以判断何时有人在攻击它，它可以禁止 IP 地址或用户帐户。但是，您应该小心使用这种功能；无辜者可以而且将会陷入交火。

*   验证是网站逻辑的重要组成部分，但它也独立于转义。如果我不验证任何东西而逃避一切，就不会有 XSS 攻击，但有人可以说他们的生日是“音乐死去的那一天”，应用程序不会更聪明。理论上，对某些数据类型进行足够严格的验证可以执行转义的所有职责（想想数字、枚举等），但无论如何逃避它们是深度防御的一般良好做法。即使你是 100%，它也是一个整数。可能不是。

*   转义明文是一个小问题；如果你的语言没有给你一个函数，一个字符串替换`<`, `>`, `"`,`'`和`&`它们对应的 HTML 实体就可以了。（仅当您不使用 UTF-8 时才需要其他 HTML 实体）。允许 HTML 标记并非易事，值得拥有自己的 Stack Overflow 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T20:35:32.353

通过不允许 HTML 呈现到页面，HtmlEncoding 输入为您提供了很大的帮助。

根据您的语言项目应该存在那里清理数据。在 .NET 中，您可以使用 Server.HtmlEncode(txtInput.Text) 从名为 txtInput 的文本框输入数据。

正如其他人所提到的，需要真正保护更多物品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T20:35:56.690

编码您的 HTML 是一个开始……它并不能防止所有 XSS 攻击。

如果你使用 PHP，这里有一个很好的函数可以在你的站点中使用：[Kallahar 的 RemoveXSS() 函数](http://kallahar.com/smallprojects/php_xss_filter_function.php)

如果你不使用 PHP，至少代码有很好的注释，解释了每个部分的目的，然后可以适应另一种编程语言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T20:48:55.883

答案是否定的，编码是不够的。对 XSS 的最佳保护是对所有传入数据的“白名单”验证和对所有输出数据的适当编码的组合。验证允许检测攻击，编码防止任何成功的脚本注入在浏览器中运行。如果您使用的是 .NET，您可以查看此库[http://msdn.microsoft.com/en-us/library/aa973813.aspx](http://msdn.microsoft.com/en-us/library/aa973813.aspx)

您还可以查看一些备忘单来测试您的保护：[http ://ha.ckers.org/xss.html](http://ha.ckers.org/xss.html)

问候，

胜利者

# linq - 使用 Linq 或 Lambda 表达式检查复杂对象中的重复项

> ID：223400
> 
> 赞同：4
> 
> 时间：2008-10-21T20:32:50.253
> 
> 标签：linq, lambda, linq-to-objects

我刚刚开始学习 linq 和 lambda 表达式，它们似乎非常适合在复杂的对象集合中查找重复项，但我有点困惑，希望有人能帮助我回到快乐编码的道路上.

我的对象的结构类似于 list.list.uniqueCustomerIdentifier

我需要确保整个复杂对象中没有重复的 uniqueCustomerIdentifier。如果有重复项，我需要确定哪些重复项并返回重复项列表。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-22T00:02:23.247

*   解包层次结构
*   将每个元素投影到其 uniqueID 属性
*   将这些 ID 分组
*   按具有超过 1 个元素的组过滤组
*   将每个组投影到组的密钥（返回到 uniqueID）
*   枚举查询并将结果存储在列表中。

* * *

```
var result = 
  myList
    .SelectMany(x => x.InnerList)
    .Select(y => y.uniqueCustomerIdentifier)
    .GroupBy(id => id)
    .Where(g => g.Skip(1).Any())
    .Select(g => g.Key)
    .ToList() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T20:35:40.450

有一个 linq 运算符 Distinct()，如果您只需要 id，它允许您过滤到一组不同的记录。如果你已经设置你的类来覆盖等于你或者有一个[IEqualityComparer](http://msdn.microsoft.com/en-us/library/ms132151.aspx)你可以直接调用 Distinct 扩展方法来从列表中返回唯一的结果。作为额外的奖励，您还可以使用 Union 和 Intersect 方法在两个列表之间合并或过滤。

另一种选择是按 id 分组，然后选择第一个元素。

```
var results = from item in list
              group item by item.id into g
              select g.First(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T20:58:20.137

如果要展平两个列表层次结构，请使用`SelectMany`方法展平`IEnumerable<IEnumerable<T>>`into `IEnumerable<T>`。

# c++ - 将单元测试添加到现有项目

> ID：223421
> 
> 赞同：9
> 
> 时间：2008-10-21T20:39:12.300
> 
> 标签：c++, unit-testing, legacy

[我的问题与之前](https://stackoverflow.com/questions/42785/how-do-you-retrofit-unit-tests-into-a-code-base)提出的问题非常相关，但我需要一些实用的建议。

我手中有“有效地使用遗留代码”，并且在我正在从事的项目中阅读这本书时，我正在使用书中的建议。该项目是一个 C++ 应用程序，由几个库组成，但代码的主要部分被编译为单个可执行文件。当我不得不触摸某些东西时，我正在使用 googletest 将单元测试添加到现有代码中。

我的问题是如何设置构建过程以便构建单元测试，因为有两个不同的可执行文件需要共享代码，而我无法将代码从“被测”应用程序中提取到库中。现在我已经为包含单元测试链接的应用程序创建了我的构建过程，该链接针对从主应用程序的构建过程生成的目标文件，但我真的不喜欢它。有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T20:54:52.423

[有效地使用遗留代码](https://rads.stackoverflow.com/amzn/click/com/0131177052)是如何开始测试旧代码的最佳资源。确实没有不会导致事情变得更糟的短期解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T21:36:17.410

我将勾勒出您可以使用的 makefile 结构：

```
all: tests executables

run-tests: tests
    <commands to run the test suite>

executables: <file list>
    <commands to build the files>

tests: unit-test1 unit-test2 etc

unit-test1: ,files that are required for your unit-test1>
    <commands to build unit-test1> 
```

作为我项目的唯一开发人员，这大致就是我所做的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T06:49:41.473

如果您的测试应用程序仅链接它需要测试的目标文件，那么您实际上已经将它们视为一个库，那么应该可以将这些目标文件分组到一个单独的库中，用于主应用程序和测试应用程序。如果你不能，那么我不认为你正在做的事情太糟糕了。

如果您必须链接其他未测试的目标文件，那么这表明需要打破依赖关系，您拥有完美的书。我们有类似的问题并使用 Vlion 建议的系统

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T20:56:54.430

我个人会像您一样继续这样做，或者考虑使用一个构建脚本来同时进行目标应用程序和单元测试（两个生成的二进制文件来自同一个代码库）。是的，它闻起来很腥，但它非常实用。

向你致敬，祝你测试顺利。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T21:33:34.357

我更喜欢每个测试一个测试可执行文件。这启用了链接时接缝，还有助于允许 TDD，因为您可以在一个单元上工作而不必担心其余代码。

我使库依赖于所有测试。希望这意味着您的测试仅在代码实际更改时运行。

如果您确实失败了，测试将在正确的位置中断构建过程。

# database - 数据库比较

> ID：223431
> 
> 赞同：0
> 
> 时间：2008-10-21T20:41:15.290
> 
> 标签：database, comparison

哪个行业级数据库具有最**独特的**功能？（“唯一”意味着没有其他 RDBMS 拥有它们）

我认为我这里的选择是 Oracle 11g：

1.  闪回查询（您可以提取过去的数据）
2.  ASM - 自动存储管理
3.  存储过程的本机代码编译
4.  审计功能（跟踪一切，从登录到报表）

和许多其他人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T08:35:39.980

有趣的是，我根据供应商是否符合 ANSI/ISO SQL 标准来评价供应商，例如对于 SQL Server，我的购物清单是支持子查询和对s 和s 的`CHECK`适当支持的可延迟约束——这些可以追溯到 SQL-92 之前。对我来说，供应商应该在他们实现了标准之后才加入专有功能:)`DOMAIN``ASSERTION`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T20:47:31.843

[http://en.wikipedia.org/wiki/Comparison_of_relational_database_management_systems](http://en.wikipedia.org/wiki/Comparison_of_relational_database_management_systems) && [http://en.wikipedia.org/wiki/Comparison_of_object-relational_database_management_systems](http://en.wikipedia.org/wiki/Comparison_of_object-relational_database_management_systems)将是我开始的地方。

至于真正的“独特”功能？我已经看到了我认为独特的东西，一旦我做了更多的挖掘，结果就很常见了:)

# tsql - 如何比较两个日期时间字段但忽略年份？

> ID：223433
> 
> 赞同：6
> 
> 时间：2008-10-21T20:41:34.133
> 
> 标签：tsql

我开始摆脱我的 VBScript 帽子并编写一些经典的 ASP 来查询 SQL Server 2000 数据库。

这是场景：

*   我有两个名为**fieldA**和**fieldB的***日期*时间字段。
*****   **fieldB**的年份值永远不会大于**fieldA的年份***   这两个字段可能具有相同的年份**。******

 ****我想要的是**fieldA** >= **fieldB**的所有记录，*与 year 无关*。假设每个字段只是一个月和一天。

我怎样才能得到这个？我对 T-SQL 日期/时间函数的了解充其量只是参差不齐。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-21T20:47:36.370

您可能想要使用内置的时间函数，例如 DAY 和 MONTH。例如

```
SELECT * from table where
MONTH(fieldA) > MONTH(fieldB) OR(
MONTH(fieldA) = MONTH(fieldB) AND DAY(fieldA) >= DAY(fieldB)) 
```

选择字段 A 的月份较大或月份相同且字段 A 的日期较大的所有行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-21T20:47:27.553

```
select *
from t
where datepart(month,t.fieldA) >= datepart(month,t.fieldB)
      or (datepart(month,t.fieldA) = datepart(month,t.fieldB)
            and datepart(day,t.fieldA) >= datepart(day,t.fieldB)) 
```

如果您关心小时、分钟、秒，则需要将其扩展以涵盖案例，尽管转换为合适的字符串、删除年份并进行比较可能会更快。

```
select *
from t
where substring(convert(varchar,t.fieldA,21),5,20)
         >= substring(convert(varchar,t.fieldB,21),5,20) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T20:51:24.193

```
SELECT *
FROM SOME_TABLE
WHERE MONTH(fieldA) > MONTH(fieldB)
OR ( MONTH(fieldA) = MONTH(fieldB) AND DAY(fieldA) >= DAY(fieldB) ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T20:55:22.360

我会从儒略日期的角度来处理这个问题，将每个字段转换为儒略日期（第一年之后的天数），然后比较这些值。

这可能会或可能不会产生与闰年相关的预期结果。

如果您担心小时、分钟、秒等，您可以调整 DateDiff 函数来计算自年初以来的小时数（或分钟数或秒数）。

```
选择 *
FROM SOME_Table
WHERE DateDiff(d, '1/01/' + Cast(DatePart(yy, fieldA) AS VarChar(5)), fieldA) >=
      DateDiff(d, '1/01/' + Cast(DatePart(yy, fieldB) AS VarChar(5)), fieldB)

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-28T14:17:01.810

测试用温度表

```
Create table #t (calDate date)
Declare @curDate date  = '2010-01-01'
while @curDate < '2021-01-01'
begin
   insert into #t values (@curDate)
   Set @curDate = dateadd(dd,1,@curDate)
end 
```

任何大于或等于今天的日期示例

```
Declare @testDate date = getdate()
SELECT *
FROM #t
WHERE datediff(dd,dateadd(yy,1900 - year(@testDate),@testDate),dateadd(yy,1900 - year(calDate),calDate)) >= 0 
```

比今天少的任何一天的另一个例子

```
Declare @testDate date = getdate()
SELECT *
FROM #t
WHERE datediff(dd,dateadd(yy,1900 - year(@testDate),@testDate),dateadd(yy,1900 - year(calDate),calDate)) < 0 
```

# sql-server - SQL Server 中嵌套事务的隔离范围是什么？

> ID：223436
> 
> 赞同：8
> 
> 时间：2008-10-21T20:42:21.527
> 
> 标签：sql-server, transactions

考虑以下 SQL：

```
开始传输
设置事务隔离级别读取已提交

插入乐队
    （ 姓名 ）
选择“Depeche 模式”
联盟
选择“街机火灾”

    -- 我已经缩进了内部事务以使其更清晰。

    开始传输
    设置事务隔离级别读取未提交

    选择 *
      从乐队

    犯罪

-- 这里的隔离级别是多少？

更新乐队
   SET Name = '谦虚的老鼠'
 WHERE Name = 'Oddest House'

犯罪

```

总之，我们启动一个事务并将其隔离级别设置为`READ COMMITTED`。然后我们执行一些随机 SQL 并启动另一个嵌套事务。在此事务中，我们将隔离级别更改为`READ UNCOMMITTED`. 然后我们提交该事务并返回给另一个。

现在，我的猜测是，在内部提交之后，隔离级别返回到`READ COMMITTED`. 它是否正确？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-22T07:37:00.257

你[鲍勃普罗布斯特]是正确的。有趣的是，根据您链接的[文档：](http://msdn.microsoft.com/en-us/library/ms173763(SQL.90).aspx)

> 如果在存储过程或触发器中发出 SET TRANSACTION ISOLATION LEVEL，则当对象返回控制权时，隔离级别将重置为调用对象时有效的级别。例如，如果在批处理中设置 REPEATABLE READ，然后批处理调用将隔离级别设置为 SERIALIZABLE 的存储过程，则当存储过程将控制权返回给批处理时，隔离级别设置将恢复为 REPEATABLE READ。

所以，这里的底线是 SET TRANSACTION ISOLATION LEVEL 具有*过程亲和性*，而不是*事务亲和性*（正如我所想的）。

惊人的！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-21T21:13:37.283

我不认为这是正确的。

参考这里的备注： [设置交易](http://msdn.microsoft.com/en-us/library/ms173763(SQL.90).aspx)

> 一次只能设置一个隔离级别选项，并且它会一直为该连接设置，直到它被显式更改。

# visual-studio-2005 - 如何更新 Visual Studio 部署项目中的环境变量

> ID：223438
> 
> 赞同：8
> 
> 时间：2008-10-21T20:43:52.507
> 
> 标签：visual-studio-2005, windows-installer

我想在 Visual Studio 2005 部署项目中将路径附加到 PATH 环境变量。如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T15:55:14.990

使用安装项目中的注册表编辑器视图并在适当的位置创建路径键，即。HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment 并创建一个名为“Path”的字符串值并将其输入为您的值：“[%Path];[TARGETDIR]”

[%Path] 是现有 Path 值中原始字符串的占位符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-20T21:45:34.027

上述使用注册表编辑器视图并创建名为 PATH 且值为“[%Path];[TARGETDIR]”的键的方法存在问题。虽然该方法在安装程序时工作正常，但卸载期间的默认行为是删除整个 PATH 变量，而不仅仅是添加的 [TARGETDIR]。我还没有找到禁用此行为的方法，尽管似乎某些条件行为可能是可能的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T21:13:13.213

您需要在 MSI 文件的环境表中添加一行来执行此操作。您可以在此处找到有关该表的信息， http: [//msdn.microsoft.com/en-us/library/aa368369](http://msdn.microsoft.com/en-us/library/aa368369(VS.85).aspx) (VS.85).aspx 。您可以使用 Orca 来执行此操作或使用一些 VB 脚本自动执行该过程。平台 SDK 包含 VB 脚本文件 WiRunSQL.vbs，您可以使用它来自动执行程序的构建操作。

# c++ - 清除野牛生成的解析器的解析器状态

> ID：223445
> 
> 赞同：2
> 
> 时间：2008-10-21T20:45:24.983
> 
> 标签：c++, bison, flex-lexer

我使用的是 Flex 生成的 C 词法分析器和 Bison 生成的 C++ 解析器。我已修改解析器以仅接受字符串输入。

我`yyparse()`在循环中调用解析器函数，并逐行读取用户输入。如果输入是“退出”，我会停止循环。

我面临的问题是，当输入与任何规则都不匹配时，解析器会突然停止，并且在下一次迭代时以相同的状态开始，期望被停止的规则（由于语法错误）完成。

如果输入有效并且与解析器规则匹配，则它可以正常工作。

关于语法错误，我重新定义了该`yyerror()`函数，该函数显示一条简单的错误消息。

当输入与任何解析器规则都不匹配时，如何清除解析器的状态，以便在下一次迭代时重新启动解析器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T21:11:30.673

根据我的 Lex & Yacc 书，有一个函数 yyrestart(file) 。

否则（我引用书中的一段话：

这意味着您不能仅通过调用 yylex() 来重新启动词法分析器。您必须使用 BEGIN INITIAL 将其重置为默认状态，丢弃任何由 unput() 缓冲的输入文本，否则安排以便下一次调用 input() 将开始读取新输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T22:17:07.547

有趣的问题 - 我有一个可以用 Bison、Byacc、MKS Yacc 或 Unix Yacc 编译的解析器，无论它失败还是成功，我都没有做任何特别的事情来处理重置语法。我不使用 Flex 或 Lex 标记器；那是手工编码的，但它严格使用字符串。所以，我不得不同意Gamecat；问题的最可能原因是词法分析器，而不是解析器本身。

（如果您想获得我的代码，可以从[IIUG](http://www.iiug.org/software)（International Informix User Group）网站下载 SQLCMD。虽然完整的产品需要 Informix ESQL/C，但语法原则上可以转换为独立的测试程序。但遗憾的是，我似乎有一段时间没有运行该测试了 - 测试编译存在一些问题。一些结构元素名称在 2006 年 4 月更改，另外还有链接问题。我需要重新组织代码以便可以再次独立测试语法。）

# lisp - 有人可以帮助解释这个计划程序

> ID：223468
> 
> 赞同：3
> 
> 时间：2008-10-21T20:53:49.883
> 
> 标签：lisp, scheme

问题：

```
((lambda (x y) (x y)) (lambda (x) (* x x)) (* 3 3)) 
```

这是期中考试的第一名，我写了“81 9”，他以为我忘了划掉一个法律，所以我划掉了 81，然后他就哭了。无论如何，我不明白为什么是81。

我明白为什么`(lambda (x) (* x x)) (* 3 3) = 81`，但是第一个 lambda 我不明白 x 和 y 值是什么，以及它们的`[body] (x y)`作用。

所以我希望有人能向我解释为什么第一部分似乎没有任何作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-21T21:00:04.673

这需要一些缩进来澄清

```
((lambda (x y) (x y))
 (lambda (x) (* x x))
 (* 3 3)) 
```

*   `(lambda (x y) (x y))`; 仅作为参数调用`x`。`y`
*   `(lambda (x) (* x x))`; 计算为其参数的平方。
*   `(* 3 3)`; 评价为 9

所以整个事情的意思是：“以 9 为参数调用 square 函数”。

编辑：同样的事情可以写成

```
((lambda (x) (* x x))
 (* 3 3)) 
```

我想这个练习的目的是强调评估方案形式如何涉及隐式函数应用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-21T21:40:52.470

让我们再看看这个...

```
((lambda (x y) (x y)) (lambda (x) (* x x)) (* 3 3)) 
```

为了评估一个表格，我们依次评估它的每个部分。我们的表单中有三个元素。这个位于第一个（功能）位置：

```
(lambda (x y) (x y)) 
```

这是表单的第二个元素和函数的第一个参数：

```
(lambda (x) (* x x)) 
```

表单的最后一个元素，因此是函数的第二个参数。

```
(* 3 3) 
```

在这种情况下，评估顺序无关紧要，所以让我们从左边开始。

```
(lambda (x y) (x y)) 
```

Lambda 创建了一个函数，因此它计算为一个接受两个参数 x 和 y 的函数，然后将 x 应用于 y（换句话说，使用单个参数 y 调用 x）。我们称之为**call-1**。

```
(lambda (x) (* x x)) 
```

这计算为一个接受单个参数并返回此参数的平方的函数。所以我们可以称之为**square**。

```
(* 3 3) 
```

这显然评估为**9**。

好的，所以在第一次评估之后，我们有：

```
(call-1 square 9) 
```

为了评估这一点，我们调用**call-1**并带有两个参数**square**和**9**。应用**call-1**给我们：

```
(square 9) 
```

因为这就是**call-1**所做的 - 它用它的第二个参数调用它的第一个参数。**现在， 9**的平方是**81**，这是整个表达式的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T23:22:18.430

也许将该代码翻译成 Common Lisp 有助于澄清其行为：

```
((lambda (x y) (funcall x y)) (lambda (x) (* x x)) (* 3 3)) 
```

或者更明确地说：

```
(funcall (lambda (x y) (funcall x y))
         (lambda (x) (* x x))
         (* 3 3)) 
```

事实上，第一个 lambda 并没有做任何有用的事情，因为它归结为：

```
(funcall (lambda (x) (* x x)) (* 3 3)) 
```

这等于

```
(let ((x (* 3 3)))
  (* x x)) 
```

等于

```
(let ((x 9))
  (* x x)) 
```

等于

```
(* 9 9) 
```

等于 81。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T02:48:53.347

到目前为止发布的答案都很好，所以与其重复他们已经说过的话，也许这是您可以查看该程序的另一种方式：

```
(define (square x) (* x x))

(define (call-with arg fun) (fun arg))

(call-with (* 3 3) square) 
```

看起来还是很奇怪吗？

# c# - 我可以在我的 asp.net 应用程序中使用 GNU Aspell for English 吗？

> ID：223472
> 
> 赞同：3
> 
> 时间：2008-10-21T20:55:29.660
> 
> 标签：c#, open-source, licensing, aspell

Aspell-net 是 GNU Aspell for .Net Framework 的一个端口。该库本身是开源的，并且在 LGPL 许可下，但在[http://aspell-net.sourceforge.net/的 sourceforge.net 项目主页上提到 aspell 的英语词典受版权保护](http://aspell-net.sourceforge.net/)

你们中有人用过 aspell-net 吗？你发布软件的许可证是什么？我做的项目是商业项目，你们预见到有什么问题吗？我应该为 aspell 英语词典付费吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T21:16:46.340

我不是律师，但我看到想要保持封闭源代码的 Opera 只是指向 Gnu Aspell 及其字典并告诉用户自己安装它们，当他们尝试使用拼写检查器时......因此他们留在中性水域。

不确定它是否对您来说是一个可行的解决方案。现在，如果您想分发词典，您可以联系词典所有者，看看他们是否会授予您许可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T21:38:32.397

如果您下载 aspell 的[英语词典](http://ftp://ftp.gnu.org/gnu/aspell/dict/en/)，存档中有一个“版权”文件。据我所知，它是免费使用的。有一些条款包含版权说明，但我想只有在您分发它时才会这样做。

您可以随时向 Kevin Atkinson（作者）发送电子邮件以获取更多详细信息。

干杯

# asp.net - asp.net 登录控件是否加密密码字段？

> ID：223474
> 
> 赞同：3
> 
> 时间：2008-10-21T20:56:51.967
> 
> 标签：asp.net, login

我正在使用 asp 身份验证提供程序并使用内置的 asp.net 登录控件设置我的第一个站点。

我的问题是，在使用 asp.net 登录控件将密码发送到服务器时，密码是加密还是散列？还是我需要使用 https/ssl 来完成这个？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-21T20:57:39.000

使用 HTTPS。

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms178329.aspx)，“默认情况下，ASP.NET 登录控件通过 HTTP 以纯文本形式工作。如果您担心安全性，请使用带有 SSL 加密的 HTTPS。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T21:00:07.543

除非您使用 HTTPS，否则不会。ASP.Net 正在利用可用的 HTML 控件，并且发送回服务器的数据是纯文本形式。如果您希望您的身份验证安全，我会使用 SSL/HTTPS。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T21:00:10.430

登录控件作为普通表单帖子工作。没有加密或质询-响应方法。如果您需要任何安全性，您必须使用 SSL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T21:00:08.700

无论服务器使用何种语言，任何基于文本的数据都按原样发送到服务器，因为这是由 HTML 框架控制的。您可以创建 Javascript 加密或哈希算法，并在提交表单数据之前使用它。

然而，最安全的方法是使用 HTTPS。

# html - 在存储或显示时对用户输入进行 HTML 编码

> ID：223480
> 
> 赞同：31
> 
> 时间：2008-10-21T20:58:58.593
> 
> 标签：html, security, xss, html-encode

简单的问题一直困扰着我。

我应该立即对用户输入进行 HTML 编码并将编码的内容存储在数据库中，还是应该在显示时存储原始值和 HTML 编码？

存储编码数据大大降低了开发人员在显示数据时忘记编码数据的风险。但是，存储编码数据会使数据挖掘更加麻烦，并且会占用更多空间，即使这通常不是问题。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-21T21:02:41.267

我强烈建议在出路时编码信息。如果您希望更改在某个点查看原始数据的方式，则将原始数据存储在数据库中很有用。流程应该类似于：

```
sanitize user input -> protect against sql injection -> db -> encode for display 
```

考虑一下您可能希望将信息显示为 RSS 提要的情况。在重新显示之前必须重做任何 HTML 特定编码似乎有点愚蠢。任何开发都应始终遵循“不信任输入”的模因，无论该输入来自用户还是来自数据库。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-21T21:03:33.483

请记住，您可能需要使用无法理解 HTML 编码文本的东西（例如，报告工具）来访问数据库。我同意空间不是问题，但是恕我直言，将 HTML 编码放入数据库中会将您的视图/前端的知识转移到应用程序的最低层，这是一个设计错误。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-21T21:07:21.337

编码只能在显示器中完成。没有例外。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-21T21:09:02.987

**输出。**

使用 HTML，您不能简单地检查字符串的长度（`&amp;`是 1 个字符，但`strlen()`会告诉您 5 个字符），您可以轻松裁剪它（它可能会破坏实体）。

您可能需要将数据库中的字符串与其他来源的字符串混合，或者将它们读回并写回。在不遗漏任何转义和避免双重转义的情况下在整个应用程序范围内执行此操作是一场噩梦。

PHP 试图做类似的事情，`magic_quotes`结果却是一个巨大的失败。不走`magic_entities`路线！:)

# outlook - 在 Outlook 之外保存/组织/搜索 Outlook 电子邮件

> ID：223490
> 
> 赞同：5
> 
> 时间：2008-10-21T21:00:33.643
> 
> 标签：outlook, email

我的公司要求我将 Outlook 用于我的电子邮件。Outlook 几乎没有按照我想要的方式做任何事情，这让我非常沮丧。（我不是想在这里发起一场激烈的战争，它必须完全按照成千上万的 CEO 的意愿去做，但我不是 CEO。）

我希望能够自动提取当前在我的 Outlook 帐户中的数千封电子邮件和附件，并将它们保存在我自己的替代存储格式中，以便我可以轻松地搜索它们并按照我想要的方式组织它们。（我不是要求对新格式提出建议。）

也许一些不错的开源程序已经可以做到这一点……那太好了。请告诉我。

否则，**如何在不通过大量的手动收集的情况下获取消息内容和附件？** 即使我只能得到消息内容和附件的名称，那也足够了。是否有 Outlook 邮件存储格式的文档？有没有办法在 Outlook 中查询数据？

也许我没有考虑过另一种方法？

我首选的语言是 C#，但如果需要，我可以使用其他语言。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-21T21:17:16.077

[Outlook Redemption](http://www.dimastr.com/redemption/)是我发现目前使用的最好的东西。它将允许您进入邮件并提取附件和邮件正文。我现在正在使用它来做到这一点。

这是我在课堂上使用的一些代码。我包括了我用来保存附件的构造函数和处理函数。我剪掉了特定于我需要的代码，但您可以在这里了解要使用的内容。

```
 private RDOSession _MailSession = new RDOSession();
    private RDOFolder _IncommingInbox;
    private RDOFolder _ArchiveFolder;
    private string _SaveAttachmentPath;

    public MailBox(string Logon_Profile, string IncommingMailPath, 
                   string ArchiveMailPath, string SaveAttPath)
    {
        _MailSession.Logon(Logon_Profile, null, null, true, null, null);
        _IncommingInbox = _MailSession.GetFolderFromPath(IncommingMailPath);
        _ArchiveFolder = _MailSession.GetFolderFromPath(ArchiveMailPath);
        _SaveAttachmentPath = SaveAttPath;
    }
public void ProcessMail()
        {

            foreach (RDOMail msg in _IncommingInbox.Items)
            {
                foreach (RDOAttachment attachment in msg.Attachments)
                {
                    attachment.SaveAsFile(_SaveAttachmentPath + attachment.FileName);
                    }
                }
                if (msg.Body != null)
                {
                    ProcessBody(msg.Body);
                }

            }

        } 
```

**编辑：** 这就是我所说的以及传递的内容

```
MailBox pwaMail = new MailBox("Self Email User", @"\\Mailbox - Someone\Inbox",
                              @"\\EMail - Incomming\Backup", @"\\SomePath"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T19:07:46.423

如果您想提取您的电子邮件，请查看代码项目 [http://69.10.233.10/KB/dotnet/OutlookEmailExtractor.aspx上的 Outlook 电子邮件提取器](http://69.10.233.10/KB/dotnet/OutlookEmailExtractor.aspx)

抢劫 www.filefriendly.com

# .net - 如何使用反射在 .NET 中调用重载方法

> ID：223495
> 
> 赞同：77
> 
> 时间：2008-10-21T21:02:43.827
> 
> 标签：.net, reflection, .net-2.0, invoke, overloading

有没有办法在.NET（2.0）中使用反射来调用重载方法。我有一个应用程序可以动态实例化从公共基类派生的类。出于兼容性目的，该基类包含 2 个同名方法，一个带参数，一个不带参数。我需要通过 Invoke 方法调用无参数方法。现在，我得到的只是一个错误，告诉我我正在尝试调用一个模棱两可的方法。

是的，我*可以*将对象转换为我的基类的实例并调用我需要的方法。最终这*会*发生，但现在，内部复杂性不允许它发生。

任何帮助都会很棒！谢谢。

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2008-10-21T21:10:55.980

您必须指定所需的方法：

```
class SomeType 
{
    void Foo(int size, string bar) { }
    void Foo() { }
}

SomeType obj = new SomeType();
// call with int and string arguments
obj.GetType()
    .GetMethod("Foo", new Type[] { typeof(int), typeof(string) })
    .Invoke(obj, new object[] { 42, "Hello" });
// call without arguments
obj.GetType()
    .GetMethod("Foo", new Type[0])
    .Invoke(obj, new object[0]); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-21T21:05:23.197

是的。当您调用该方法时，传递与您想要的重载匹配的参数。

例如：

```
Type tp = myInstance.GetType();

//call parameter-free overload
tp.InvokeMember( "methodName", BindingFlags.InvokeMethod, 
   Type.DefaultBinder, myInstance, new object[0] );

//call parameter-ed overload
tp.InvokeMember( "methodName", BindingFlags.InvokeMethod, 
   Type.DefaultBinder, myInstance, new { param1, param2 } ); 
```

如果您以相反的方式执行此操作（即通过查找 MemberInfo 并调用 Invoke），请小心您得到正确的 - 无参数重载可能是第一个找到的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-21T21:09:32.270

使用采用 System.Type[] 的 GetMethod 重载，并传递一个空的 Type[]；

```
typeof ( Class ).GetMethod ( "Method", new Type [ 0 ] { } ).Invoke ( instance, null ); 
```

# .net - 使用 VirtualMode=True 时如何更新 WinForms ListView？

> ID：223516
> 
> 赞同：3
> 
> 时间：2008-10-21T21:08:36.013
> 
> 标签：.net, winforms, listview, virtualmode

我有一个带有大型 ListView 的应用程序，它非常慢，所以我正在实现 VirtualMode。MSDN 似乎没有涵盖我将如何在列表视图中间添加和删除新项目。

例如，ListView 有 1000 个项目（表示磁盘上的文件），在 ListView 的初始填充之后（通过 RetrieveVirtualItem 事件），一些文件将被删除并添加一些文件，因此 VirtualListSize 在更新后甚至可能相同。

问题 1）我如何对 ListView 说“这些项目已被更改/删除”以便它重新查询？

此外，一些文件只是更改，我想在列表视图中反映它们的更改状态。

问题 2）鉴于 VirtualMode 不允许我访问我之前使用的 Items 集合（我在该集合上使用了 ContainsKey 方法），我如何在列表视图中找到一个项目。

听起来很简单，但我自己看不到。非常感谢帮助。

瑞安

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T00:05:24.613

要添加或删除项目，simplay 将 VirtualListSize 设置为项目的总数。要刷新单个项目，请使用 RedrawItems。

要定位特定项目，请使用已有的容器，不要返回 ListView。列表中的索引应与 ListView 中的项目匹配。

# asp.net - 这些值是否属于配置文件或数据库？

> ID：223517
> 
> 赞同：6
> 
> 时间：2008-10-21T21:08:41.413
> 
> 标签：asp.net, web-config, configuration-files

对于每个“模块”，我在 ASP.NET configSections 部分中存储了多个值。我一直想知道它们是否甚至属于这些文件。

背景是：这些是部署的 Web 应用程序的多个实例。所有人都使用相同的数据库，但有自己的设置。

我确信开发和生产之间的差异在配置文件中。我知道的一些值应该包括：连接字符串、要使用的提供程序、设置调试等。

我已经将所有常见的部分分解到具有自己的规则和方法的类中。剩下的部分是每个站点中每个模块的杂项设置。我不确定的一些选项包括：

*   对于模块 A，显示/隐藏选项
*   对于 ModuleB，该字段使用的术语是什么
*   对于 ModuleC，允许最终用户执行 X 操作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-21T21:14:01.370

嗯，这些听起来像是您可能希望能够在运行时为您的应用程序更改而无需修改 app.config 的东西。我喜欢遵循的一条经验法则是，配置中的任何内容都应该用于部署或服务器配置。在这种情况下，您的设置似乎正在修改应用程序行为，因此如果不是很多努力，我可能会将它们移动到数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T21:14:09.187

ModuleA 和 ModuleC 听起来像是用户个人资料信息。如果它们不是用户动态的，但您可以添加以后的功能，然后可能将它们移动到数据库中。

我已经编写了将 ModuleB 也放入数据库的应用程序。诸如表单标签等之类的东西可以很容易地进入数据库。如果以后有人决定为所有表单标签添加或删除冒号，那么如果所有文本都存储在数据库中，那将是一件非常容易的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T21:15:29.043

考虑需要编辑其中一个值的情况。

如果该值在 web.config 中，将更改保存到该文件将导致应用程序回收，不方便地丢弃当前用户。如果您的应用程序位于仅在工作时间使用的 Intranet 上，则问题不大（尽管您可能会接到工作迟到的人的愤怒电话）。但在具有国际用户的公共网站上可能存在问题。

如果该值在数据库中，那么它不会以这种方式对应用程序的处理产生影响。

无论哪种方式，请考虑这些值是否缓存在应用程序的 RAM 中（web.config 是）。数据库值是在应用程序变量中还是在缓存中？如果是这样，您可能不知道何时会发生更改。除非您想重新启动应用程序。

并且，适当的管理员需要哪些不同的访问和权限来进行更改？有人必须有权访问 Web 服务器才能更改 web.config，或者必须有权访问数据库（和表）才能更改它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T21:29:38.000

几个问题：为什么您对应用程序的多个实例使用相同的数据库，这将如何影响维护？将来是否可以选择拆分数据库以提高性能？配置模型是否比基于数据库的模型更好地支持该更改？

换句话说，您必须考虑很多变量才能回答您的问题:-)

# c# - 如何从客户端机器检测当前的共享点页面？

> ID：223520
> 
> 赞同：0
> 
> 时间：2008-10-21T21:09:19.710
> 
> 标签：c#, sharepoint, object, process

在客户端机器上，我需要能够以某种方式检测当前用户正在查看哪些站点。我知道 sharepoint 应用程序的基本 URL，比如 sharepoint.thecompany.net，但是我如何从服务器获取最后请求的 url？在尝试迭代当前进程并将 iexplorer 进程转换为我可以使用的东西时，我遇到了死机，我只是不知道将进程转换为哪种对象:-(

我希望在 C# 程序集中实现这个逻辑，它应该在客户端上运行。

还有其他可行的方法吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-21T21:28:08.550

[WatiN](http://watin.sourceforge.net/)将允许您附加到 IE 实例并从中获取当前 url。它还允许您对 Firefox 实例执行相同的操作。

然而，尝试使用wireshark类型概念在网络级别获取请求的url可能更有效，您只是在计算机上监听http流量并跟踪url，但这样的解决方案有点让我头疼。

编辑：我在寻找解决方案时遇到了这个问题：http: [//www.codeproject.com/KB/IP/networkmonitor.aspx](http://www.codeproject.com/KB/IP/networkmonitor.aspx) 据我所知，我认为您可以调整监控代码来监控和查找 http 请求数据包并解析标题以获取所需的 url 信息。

# xml - 如何在 VB.NET 中编写对象以便轻松进行 XML 序列化？

> ID：223526
> 
> 赞同：3
> 
> 时间：2008-10-21T21:11:24.293
> 
> 标签：xml, vb.net, xml-serialization

我正在 VB.NET 中编写一个小型应用程序，我希望某些类能够将自己写到 XML 中以用作“保存”功能。我见过用于生成 VB 类的 XSD 文件，这些类可以很容易地将自己序列化进出 XML。如果我确实有任何预先存在的 XML 格式需要遵守，因为我只是自己创建类，我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-21T21:26:15.823

使用 System.Xml 和 System.Xml.Serialization 命名空间。它们描述了类，您可以使用这些类用相应的标签来注释类的成员。

例如（在 C# 中）：

```
[XmlRoot("foo")]
public class Foo
{
     [XmlAttribute("bar")] 
     public string bar;
     [XmlAttribute("baz")] 
     public double baz;
} 
```

或者在 VB.NET 中（可能在语法上不完全正确）：

```
<XmlRoot ("foo")> _
Public Class Foo
     <XmlAttribute ("bar")>_
     Public bar As String
     <XmlAttribute ("baz")>_
     Public baz As String
End Class 
```

然后，您可以使用 XmlSerializer 类来输出 XML。

在 C# 中：

```
using(XmlSerializer xmls = new XmlSerializer(typeof(Foo)){
    TextWriter tw = new StreamWriter( "foo.xml" );
    //use it!
} 
```

或 VB：

```
Using xmls As New XmlSerializer(gettype(Foo)), _
    tw As TextWriter = New StreamWriter("foo.xml")

    ''//use it!
End Using 
```

[参考](http://msdn.microsoft.com/en-us/library/system.xml.serialization.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T21:18:35.450

既然你问要让它“简单”，那么需要遵循三个规则，这将有助于让事情变得非常简单：

1.  仅使用可序列化的属性类型
2.  不要使用集合或数组作为需要序列化的属性
3.  没有具有“坏”副作用的属性。我所说的“坏”主要是指由同一底层私有字段支持的两个公共属性。

请注意，如果您违反这些规则，您可能仍然可以序列化您的课程，但这可能需要更多的工作。

对于第 2 项，快速解决方法是使用数据表或数据集，因为它们是可序列化的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T21:25:22.627

要使用简单的“保存”功能，可以使用 .net xml 序列化 [1] 或在内存中创建一个 DateSet 以在您认为合适的任意数量的 DateTable 中保存“世界状态”。这取决于您尝试坚持的对象模型的复杂程度。

[1] 我能很快找到的最简单的例子（C#，对不起，但你会明白要点）[http://www.jonasjohn.de/snippets/csharp/xmlserializer-example.htm](http://www.jonasjohn.de/snippets/csharp/xmlserializer-example.htm)

# asp.net - 将 CSV 文件或 Excel 电子表格转换为 RESX 文件

> ID：223533
> 
> 赞同：4
> 
> 时间：2008-10-21T21:14:19.637
> 
> 标签：asp.net, excel, csv, globalization

我正在为我遇到的问题寻找解决方案或建议。我有一堆将本地化的 ASPX 页面，还有一堆需要支持 6 种语言的文本。

进行翻译的人员将无法访问 Visual Studio，可能最简单的工具是 Excel。如果我们使用 Excel 甚至导出到 CSV，我们需要能够导入以移动到 .resx 文件。那么，最好的方法是什么？

我知道这个问题，[将 Visual Studio 资源文件转换为文本文件？](https://stackoverflow.com/questions/198772/convert-a-visual-studio-resource-file-to-a-text-file)已经使用 Resx 编辑器，但更简单的解决方案将是首选。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T02:02:25.377

我不确定您正在寻找的答案有多全面，但如果您真的只是使用 [string, string] 对进行本地化，并且您只是在寻找一种快速加载资源的方法（.resx）包含翻译结果的文件，那么以下将作为一种相当快速、低技术含量的解决方案。

要记住的是 .resx 文件只是 XML 文档，因此应该可以从外部代码段手动将数据加载到资源中。以下示例在 VS2005 和 VS2008 中对我有用：

```
namespace SampleResourceImport
{
    class Program
    {
        static void Main(string[] args)
        {

            XmlDocument doc = new XmlDocument();
            string filePath = @"[file path to your resx file]";
            doc.Load(filePath);
            XmlElement root = doc.DocumentElement;

            XmlElement datum = null;
            XmlElement value = null;
            XmlAttribute datumName = null;
            XmlAttribute datumSpace = doc.CreateAttribute("xml:space");
            datumSpace.Value = "preserve";

            // The following mocks the actual retrieval of your localized text
            // from a CSV or ?? document...
            // CSV parsers are common enough that it shouldn't be too difficult
            // to find one if that's the direction you go.
            Dictionary<string, string> d = new Dictionary<string, string>();
            d.Add("Label1", "First Name");
            d.Add("Label2", "Last Name");
            d.Add("Label3", "Date of Birth");

            foreach (KeyValuePair<string, string> pair in d)
            {
                datum = doc.CreateElement("data");
                datumName = doc.CreateAttribute("name");
                datumName.Value = pair.Key;
                value = doc.CreateElement("value");
                value.InnerText = pair.Value;

                datum.Attributes.Append(datumName);
                datum.Attributes.Append(datumSpace);
                datum.AppendChild(value);
                root.AppendChild(datum);
            }

            doc.Save(filePath);
        }
    }
} 
```

显然，上述方法不会为您的资源生成代码隐藏，但是在 Visual Studio 中打开资源文件并切换资源的可访问性修饰符将为您（重新）生成静态属性。

如果您正在寻找一个完全基于 XML 的解决方案（相对于 CSV 或 Excel 互操作），您还可以指示您的翻译人员将他们翻译的内容存储在 Excel 中，另存为 XML，然后使用 XPath 检索您的本地化信息。唯一需要注意的是文件大小往往会变得非常臃肿。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T21:31:45.163

我遇到了类似的问题，并意识到从 excel 文件创建 .resx 文件的最简单方法是使用 excel 的连接函数为 . resx 文件，然后在任何文本编辑器中手动将生成的行复制到 .resx 文件。因此，假设您在 excel 文档的 A 列中有“名称”，在 excel 文档的 B 列中有“值”。在 C 列中使用以下公式

```
=CONCATENATE("<data name=","""",A14,""" xml:space=""preserve"">","<value>", B14, "</value>", "</data>") 
```

您将获得资源的数据节点。然后，您可以将此公式复制到所有行，然后将 C 列的内容复制到 .resx 文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-26T19:36:25.157

如果它在 csv 中，这里有一个快速的 Ruby 脚本来生成数据元素。

```
require 'csv'
require 'builder'

file = ARGV[0]

builder = Builder::XmlMarkup.new(:indent => 2)

CSV.foreach(file) do |row|
  builder.data(:name => row[0], "xml:space" => :preserve) {|d| d.value(row[1]) }
end

File.open(file + ".xml", 'w') { |f| f.write(builder.target!) } 
```

# asp.net - 如何修改aspx页面的超时时间？

> ID：223535
> 
> 赞同：8
> 
> 时间：2008-10-21T21:15:13.257
> 
> 标签：asp.net, timeout

有没有办法手动增加/减少特定 aspx 页面的超时？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-21T21:20:21.700

在 web.config 中：

```
 <configuration>
      <location path="~/Default.aspx">
        <system.web>
          <httpRuntime executionTimeout="1000"/>      
        </system.web>    
      </location>
   </configuration> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T21:29:05.770

要记住的一件事是这里的超时功能只会使会话超时无效，但用户仍将留在他们所在的任何页面上。这可能会导致应用程序流程出现问题。作为补救措施，我在 Web.config 文件中保留以下内容：

```
<appSettings>
     <!-- Application Timeout is 10 minutes -->
     <add key="SessionTimeoutMilliseconds" value="600000"/>     
</appSettings> 
```

此外，我的母版页在我的代码隐藏文件中有以下代码：

```
' Register Javascript timeout event to redirect to the login page after inactivity
Page.ClientScript.RegisterStartupScript(Me.GetType, "TimeoutScript", _
                                        "setTimeout(""top.location.href = '/EAF/Login.aspx'""," & _
                                        ConfigurationManager.AppSettings("SessionTimeoutMilliseconds") & ");", True) 
```

你应该在两端都做好准备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T21:23:05.393

如果您正在谈论页面返回超时之前所花费的时间，那么 mnour 的示例 - 您可能还想查看 machine.config 文件。如果您谈论会话超时，那么您将需要使用 JS 计时器，该计时器在达到 0 时回发。

# lucene - 我们如何使用 Lucene、Solr 或 Nutch 创建一个简单的搜索引擎？

> ID：223536
> 
> 赞同：8
> 
> 时间：2008-10-21T21:15:17.733
> 
> 标签：lucene, solr, nutch

我们公司有数千份PDF文件。我们如何使用 Lucene、Solr 或 Nutch 创建一个简单的搜索引擎？我们将提供一个基本的 Java/JSP 网页，人们可以输入单词并执行基本和/或查询，然后向他们显示所有匹配 PDF 的文档链接。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-21T22:06:44.463

我在 lucene 上运气不错，但它不是点击、安装和搜索，它确实需要一些工作。
如果您需要可以在 10 分钟内下载和安装并搜索的东西，请查看免费的 Ominifind 雅虎版[http://omnifind.ibm.yahoo.net/](http://omnifind.ibm.yahoo.net/)，它使用 Lucene，但被打包成配置和准备好在安装时运行，这是尝试 Lucene 的一种更简单的方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-12T18:22:52.160

Nutch 中启用的 Nutch + Lucene + Pdf 插件是您的解决方案。Nutch 允许您通过启用 pdf 插件来解析 pdf。

Lucene 将允许您对爬取和解析的数据进行索引，而 Nutch 具有为您提供搜索界面的 serverlet。

我们对内部局域网使用相同的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-21T21:41:47.507

谷歌搜索设备[http://www.google.com/enterprise/gsa/](http://www.google.com/enterprise/gsa/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-17T02:39:03.313

Lucene 系列中的所有项目都不能原生处理 PDF，但是您可以使用一些实用程序和编写良好的示例来说明如何滚动您自己的文档。

Lucene 几乎可以完成您需要做的任何事情，但是正如 Tony 上面所说的，您的时间会产生开销。数以千计的文档确实不是*很多*，因此您可以选择重量更轻的替代品。

也就是说，我仍然建议查看 Solr - 它比 Lucene 设置起来容易得多，支持备份、复制等，以及非常适合您的用例的漂亮 JSON 接口：[http： //wiki.apache.org/solr/SolJSON](http://wiki.apache.org/solr/SolJSON)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-17T03:10:47.197

我认为您需要一个系统来管理您的 PDF 文件。请尝试使用 dspace 系统。Dspace是一个数字图书馆，它支持基于Lucene。www.dspace.org。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-21T21:39:31.913

看看[eprints](http://www.eprints.org)。它包括用于添加新文档、自动索引和缩略图 PDF 的工作流程，并具有相当全面的全文搜索功能。它也可以轻松定制和品牌化。

为什么要重新发明轮子。再次。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-21T21:32:56.043

在这个论坛上回答如此广泛的问题将很困难。我建议您查看*[Lucene in Action](http://www.manning.com/hatcher2/)一书，*它以非常易读的方式介绍了索引和搜索的基础知识。

鉴于您的应用程序，听起来 Nutch 和 Solr 可能不是必需的。由于您的所有文档都可以在本地获得，因此 Nutch 可能不会有帮助。如果您的查询负载很高，Solr 可以帮助您管理搜索器集群，但是 Lucene 具有高性能，并且以非常可扩展的方式处理大型文档集。

可能会耗费您大量精力的一个领域是使用 PDF。可以对 PDF 文档进行索引，并且[Lucene 有助于从 PDF 中提取原始文本](http://wiki.apache.org/lucene-java/LuceneFAQ#head-c45f8b25d786f4e384936fa93ce1137a23b7e422)，但根据文档的不同，结果的质量可能会有所不同。通常，由于格式说明的原因，PDF 文档中关键字的上下文不清楚，这可能会导致难以进行邻近搜索或显示命中的上下文。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-08-24T07:16:59.747

您可能会看到一个很棒的免费搜索技术是 IBM Yahoo! 免费搜索。我不确定他们是否遵循了在幕后使用 Lucene 的计划，但它仍然是使用免费搜索技术的真正伟大的东方之一。我相信它可以处理多达 500K 的文档，并且它还支持 PDF 和其他非文本格式。图形用户界面；易于自定义搜索结果和基本搜索分析。基本词库和强大的 API，因此如果开箱即用的结果不符合您的喜好，您几乎可以做任何您想做的事情。我们已经向一些文档少于 50 万份的客户提出了这个建议，他们很喜欢。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-21T21:27:50.047

如果你有一个 Linux 服务器，你可以使用[Beagle](http://www.beagle-project.org/)来索引它们，然后只使用它附带的搜索功能。它有一个（实验性的）网络搜索界面，也可以连接到 FireFox 搜索框。

它会在包含文件时自动为文件编制索引，我怀疑您会发现增强或修复 beagle 比编写自己的 Lucene 搜索界面更有效。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2008-10-21T21:40:42.113

拥有在 Mac 上的（恕我直言）明显优势，我在稍旧的 G5 上使用[SearchLight 。](http://www.gravityapps.com/searchlight/overview/)漂亮的 Web 界面，Mac OS 的内置索引服务。

# asp.net - ASP.NET Model View Presenter 项目结构

> ID：223538
> 
> 赞同：1
> 
> 时间：2008-10-21T21:16:11.880
> 
> 标签：asp.net, asp.net-mvc, design-patterns, mvp

我刚刚开始一个新的 ASP.NET 项目并使用 MVP 模式。我确实考虑过 MS MVC，但它还没有发布，对于团队中的一些人来说将是一个很大的学习曲线，所以我现在选择了 MVP，并且可能选择了未来的项目 MVC。

无论如何，似乎我将为每个我拥有它的项目的网络表单提供一个 Controller/Presenter 类。这是很多额外的类，本质上是使 web 项目中的文件数量增加了一倍。这是其他人如何构建 MVP 还是有什么替代方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T21:45:32.943

这似乎是一个常见的误解->“更多文件/类==更复杂”

我们选择遵循 UI 分离模式的原因是为了帮助分离关注点，使代码更容易、更便宜地更改和维护，并且（大、重要**和**）我们可以对复杂部分进行单元测试，并且仍然保持 UI 层纤薄。

我将使用 beta ASP MVC。原因是，虽然它仍然只是一个测试版（PDC 很快，这可能会对发布产生影响，我们已经发布了 5 个预览版），但它有一个更好的框架来支持这种风格，而不是我可以在合理的时间内编写框架。

您当然可以使用其他框架，例如城堡单轨列车。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T21:44:27.173

我认为这在很大程度上取决于，但在大多数情况下，这确实是最终的结果。

我个人使用带有数据、业务、演示代码的 n 层架构。（谁知道我遵循什么实际格式）。我确实得到了比我在 aspx 中做所有事情时更多的文件，但是代码更容易管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T22:15:58.920

对于您的问题-我已经看到了许多对 MVP 的不同看法，但没有看到任何减少文件数量的方法，而且我想不出减少文件数量的方法。

根据我的经验，我重用了视图接口，甚至是视图结构相同但呈现不同数据的代码隐藏。您还可以考虑在适用的情况下重用控制器。

我认为值得注意的是，拥有更多文件将是转向更敏捷和测试驱动开发的自然结果，开发人员会发现它越来越自然。（就像我们中的一些人发现在单个文件中有很多方法很自然......）

# statistics - 从集合中选择元素的概率

> ID：223545
> 
> 赞同：3
> 
> 时间：2008-10-21T21:19:32.810
> 
> 标签：statistics, probability, normal-distribution, gamma-distribution

从一组 n 个元素中随机选择一个元素的预期概率是 P=1.0/n 。假设我使用无偏方法检查 P 足够多次。P的分布类型是什么？很明显，P 不是正态分布的，因为它不能是负数。因此，我可以正确假设 P 是[伽马分布](http://en.wikipedia.org/wiki/Gamma_distribution)的吗？如果是，这个分布的参数是什么？[此处](http://img267.imageshack.us/my.php?image=imageqa2.png)显示了从 100 个元素集中选择一个元素 1000 次的概率直方图。

有什么办法可以将其转换为标准分布

现在假设观察到的选择给定元素的概率是 P* (P* != P)。如何估计偏差在统计上是否显着？

编辑：这不是作业。我正在做一个爱好项目，我需要这个统计数据。大约 10 年前我已经完成了我的最后一个作业:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T21:58:48.567

这是一个明确的[二项分布](http://en.wikipedia.org/wiki/Binomial_Distribution)，p=1/（元素数）和 n=（试验数）。

要测试观察到的结果是否与预期结果有显着差异，您可以进行[二项式检验](http://en.wikipedia.org/wiki/Binomial_test)。

两个维基百科页面上的骰子示例应该为您提供一些关于如何制定问题的良好指导。在您的 100 元素、1000 试验示例中，这就像将 100 面模具滚动 1000 次。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-21T22:30:54.337

通过重复，您的分布将是二项式的。所以让 X 是你选择某个固定对象的次数，总共有 M 个选择

P{ X = x } = ( M 选择 x ) * (1/N)^x * (N-1/N)^(Mx)

对于大的 N，您可能会发现这很难计算。事实证明，对于足够大的 N，这实际上会收敛到概率为 1 的正态分布（中心极限定理）。

如果 P{X=x} 将由正态分布给出。平均值为 M/N，方差为 M * (1/N) * ( N-1) / N。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T13:50:25.777

正如其他人所指出的，您需要二项式分布。不过，您的问题似乎暗示着对它的连续近似感兴趣。它实际上可以用正态分布来[近似，也可以用](http://en.wikipedia.org/wiki/Binomial_distribution#Normal_approximation)[泊松分布](http://en.wikipedia.org/wiki/Binomial_distribution#Poisson_approximation)来近似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T21:25:29.973

您的分布是[离散均匀分布](http://en.wikipedia.org/wiki/Uniform_distribution_%28discrete%29)吗？

# c - 将消息从子类传递到原始 WndProc

> ID：223548
> 
> 赞同：5
> 
> 时间：2008-10-21T21:19:56.523
> 
> 标签：c, user-interface, winapi

我一直在阅读关于子类化的[MSDN](http://msdn.microsoft.com/en-us/library/ms997565.aspx)文档，并且我已经成功地处理了子类中的事件

我的问题是将消息传递回原始 WndProc。

例如，如果我有一个窗口，它有一个子类 groupbox 控件和一个按钮作为该 groupbox 的子项，我想在原始窗口过程中处理按钮事件，而不是子类 groupbox 过程。

本质上，我想要一个空的子类过程：

```
LRESULT FAR PASCAL SubClassFunc(HWND hwnd,
                        UINT uMsg,
                WPARAM wParam,
                LPARAM lParam)
{
    return CallWindowProc(oldProc, hwnd, uMsg, wParam, lParam);
} 
```

oldProc 在哪里：

```
FARPROC oldProc = (FARPROC)SetClassLong(group_box, GCL_WDPROC, (DWORD)SubCLassFunc); 
```

窗口和组框和按钮在哪里：

```
HWND window = CreateWindowEx(
    WS_EX_WINDOWEDGE, 
    appname,
    TEXT("Subclass Test"),
    WS_VISIBLE |WS_OVERLAPPEDWINDOW,
    CW_USEDEFAULT,
    CW_USEDEFAULT,
    300,
    400,
    NULL,
    NULL,
    hInstance,
    0);

HWND group_box = CreateWindowEx(
    0,
    TEXT("BUTTON"),
    TEXT("Group Box"),
    WS_CHILD | WS_VISIBLE | BS_GROUPBOX,
    8,
    8,
    275,
    350,
    window,
    NULL,
    hInstance,
    0);

HWND push_button = CreateWindowEx(
    0,
    TEXT("BUTTON"),
    TEXT("Push Button"),
    WS_CHILD | WS_VISIBLE | BS_PUSHBUTTON | BS_VCENTER,
    50,
    100,
    100,
    25,
    group_box,
    (HMENU)PUSH_BUTTON,
    hInstance,
    0); 
```

我可以处理 SubClassFunc 中的按钮事件，但我想做的是将它们传递回窗口 WndProc。似乎 CallWindowProc 没有这样做，或者我对 CallWindowProc 的工作方式可能完全错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-21T22:57:32.380

按钮通知被发送到按钮的父级，即组框。因为您已经对组框进行了子类化，所以您`SubClassFunc`会收到这些消息，然后使用 .将它们传递给组框的原始窗口过程`CallWindowProc`。

如果您希望按钮通知转到父窗口（即`window`在您的代码中），您可以将按钮的父窗口设置为`window`而不是`group_box`，或者使用`PostMessage`from `SubClassFunc`inside 将消息（`WM_COMMAND`或`WM_NOTIFY`根据需要）发布到`window`。

另外，我看到您正在使用`SetClassLong`设置窗口过程。这样做是替换整个`BUTTON`类的窗口过程，但仅适用于随后创建的窗口。在调用之前创建的任何`BUTTON`窗口`SetClassLong`都不会被子类化。您可能要考虑`SetWindowLong`改为使用子类化单个窗口而不是整个类。

编辑：组框的原始窗口过程不会向`WM_COMMAND`其父级发送消息。[Charles Petzold 的Programming Windows](http://www.charlespetzold.com/pw5/)书中对此进行了解释：

> 具有`BS_GROUPBOX`样式的组框在按钮类中是一个奇怪的东西。它既不处理鼠标或键盘输入，也不向`WM_COMMAND`其父级发送消息。

`window`您应该会发现即使您没有子类化组框，按钮通知也不会通过。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T23:21:27.370

我怀疑如果您将子类全部删除，按钮事件仍将无法达到您期望的原始窗口过程。

由于您有一个子类过程，只是调用**CallWindowProc**窗口实际上不是子类。

我的建议是使用**Spy++**工具来查看哪个窗口正在获取按钮事件消息。

Win32 编程的一个更困难的方面是确定哪个窗口获取哪个消息，而**Spy++**在找出这些信息时非常宝贵。

# c# - 想要在 C# 中具有不同构建的不同图标

> ID：223549
> 
> 赞同：5
> 
> 时间：2008-10-21T21:20:00.470
> 
> 标签：c#, icons, resources

我们有一个产品，但我们正在进行一些品牌重塑，因此我们需要能够构建和维护两个版本。我使用资源文件和一些#if 东西来解决字符串、图像和其他任何问题，但是程序图标给我带来了麻烦。我无法从 msdn 或谷歌搜索中弄清楚。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-21T21:37:09.763

你指的是应用程序图标吗？您可以手动编辑项目文件并输入类似于以下的代码：

```
<PropertyGroup>
  <ApplicationIcon Condition=" '$(Configuration)' == 'Version1' ">Icon1.ico</ApplicationIcon>
  <ApplicationIcon Condition=" '$(Configuration)' == 'Version2' ">Icon2.ico</ApplicationIcon>
</PropertyGroup>
<ItemGroup Condition=" '$(Configuration)' == 'Version1' ">
  <Content Include="Icon1.ico" />
</ItemGroup>
<ItemGroup Condition=" '$(Configuration)' == 'Version2' ">
  <Content Include="Icon2.ico" />
</ItemGroup> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T21:36:47.643

创建以您的配置命名的图标文件。（例如 DebugOld.app.ico DebugBranded.app.ico、ReleaseBranded.app.ico）

创建预构建步骤：

```
copy "$(ProjectDir)$(ConfigurationName).app.ico" "$(ProjectDir)app.ico" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T21:34:02.797

在普通代码中设置图标，您应该能够使用与其他地方相同的技术。您将需要资源文件中的两个图标（至少我怀疑是这样），但它应该可以工作。

或者，设置一个预构建步骤，将适当的图标复制到一个通用文件名中——例如，将 debug.ico 或 release.ico 复制到 app.ico。有点hacky，但我认为它会工作。这样，您最终只会在完成的二进制文件中得到一个图标。

还有一个选择：查看构建文件并查看图标是如何内置的，然后对其进行条件化。Marc Gravell 这样做是为了在[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)中引用- 该项目可以针对 .NET 2.0 或 3.5 构建，具体取决于配置。我怀疑资源可以以非常相似的方式设置条件。

# metaprogramming - Nemerle 宏的中缀格式

> ID：223556
> 
> 赞同：3
> 
> 时间：2008-10-21T21:23:37.200
> 
> 标签：metaprogramming, dsl, nemerle

假设我需要一些非常特殊的乘法运算符。它可以在以下宏中实现：

```
macro @<<!(op1, op2)
{
    <[ ( $op1 * $op2 ) ]>
} 
```

我可以像这样使用它

```
def val = 2 <<! 3 
```

及其工作。

但我真正想要的是我现在正在开发的 DSL 的一些类似“英语”的运算符：

```
macro @multiply(op1, op2)
{
    <[ ( $op1 * $op2 ) ]>
} 
```

如果我尝试像这样使用它

```
def val = 2 multiply 3 
```

编译器因“预期；”而失败 错误

问题是什么？如何实现这个中缀格式的宏？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-21T21:48:38.353

直接来自编译器源代码：

```
namespace Nemerle.English
{
  [assembly: Nemerle.Internal.OperatorAttribute ("Nemerle.English", "and", false, 160, 161)]
  [assembly: Nemerle.Internal.OperatorAttribute ("Nemerle.English", "or", false, 150, 151)]
  [assembly: Nemerle.Internal.OperatorAttribute ("Nemerle.English", "not", true, 181, 180)]  

  macro @and (e1, e2) {
    <[ $e1 && $e2 ]>
  }

  macro @or (e1, e2) {
    <[ $e1 || $e2 ]>
  }

  macro @not (e) {
    <[ ! $e ]>
  } 
```

您需要在周围撒上 OperatorAttributes，它会起作用。顺便说一句，OperatorAttribute 定义如下：

```
public class OperatorAttribute : NemerleAttribute
{
  public mutable env : string;
  public mutable name : string;
  public mutable IsUnary : bool;
  public mutable left : int;
  public mutable right : int;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T21:49:40.860

通常，我比社区响应更快地找到答案:) 所以，解决方案是简单地使用特殊的装配级别属性，将宏指定为二元运算符：

```
namespace TestMacroLib
{
  [assembly: Nemerle.Internal.OperatorAttribute ("TestMacroLib", "multiply", false, 160, 161)]
  public macro multiply(op1, op2)
  {
    <[ ( $op1 * $op2 ) ]>
  }
} 
```

# python - 在 Python 中使用变量作为类名？

> ID：223559
> 
> 赞同：45
> 
> 时间：2008-10-21T21:24:24.813
> 
> 标签：python, dynamic-typing

我想知道如何在 Python 中为对象和函数名使用变量。在 PHP 中，您可以这样做：

```
$className = "MyClass";

$newObject = new $className(); 
```

你如何在 Python 中做这种事情？或者，我是否完全不了解与 Python 的一些根本区别，如果是，那是什么？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-10-21T21:33:05.263

假设 some_module 有一个名为“class_name”的类：

```
import some_module
klass = getattr(some_module, "class_name")
some_object = klass() 
```

我应该注意你在这里应该小心：如果字符串来自用户，那么将字符串转换为代码可能会很危险，所以在这种情况下你应该牢记安全性。:)

另一种方法（假设我们仍在使用“class_name”）：

```
class_lookup = { 'class_name' : class_name }
some_object = class_lookup['class_name']()  #call the object once we've pulled it out of the dict 
```

后一种方法可能是最安全的方法，因此如果可能的话，它可能是您应该使用的方法。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-10-21T21:26:09.333

在 Python 中，

```
className = MyClass
newObject = className() 
```

第一行使变量`className`引用与 相同的东西`MyClass`。然后下一行通过变量调用`MyClass`构造函数。`className`

作为一个具体的例子：

```
>>> className = list
>>> newObject = className()
>>> newObject
[] 
```

（在 Python 中，`list`是`list`类的构造函数。）

不同之处在于，在 PHP 中，您将要引用的类的名称表示为字符串，而在 Python 中，您可以直接引用同一个类。如果您*必须*使用字符串（例如，如果类的名称是动态创建的），那么您将需要使用其他技术。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2010-05-20T15:14:38.470

如果您需要在 Python 中创建一个动态类（即名称为变量的类），您可以使用 type()，它需要 3 个参数：名称、基数、属性

```
>>> class_name = 'MyClass'
>>> klass = type(class_name, (object,), {'msg': 'foobarbaz'})

<class '__main__.MyClass'>

>>> inst = klass()
>>> inst.msg
foobarbaz 
```

*   但是请注意，这不会“实例化”对象（即不调用构造函数等。它会创建一个具有相同名称的 new(!) 类。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-21T21:32:34.017

如果你有这个：

```
class MyClass:
    def __init__(self):
        print "MyClass" 
```

然后你通常会这样做：

```
>>> x = MyClass()
MyClass 
```

但你也可以这样做，这就是我认为你要问的：

```
>>> a = "MyClass"
>>> y = eval(a)()
MyClass 
```

但是，要非常小心你从哪里得到你使用“eval()”的字符串——如果它来自用户，你实际上是在创造一个巨大的安全漏洞。

更新：使用`type()`如 coleifer 的答案所示远远优于此解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-24T16:39:14.773

我用：

```
newObject = globals()[className]() 
```

# .net-3.5 - 为什么 NameObjectCollectionBase 类不提供按索引将对象插入集合的方法？

> ID：223591
> 
> 赞同：1
> 
> 时间：2008-10-21T21:34:41.687
> 
> 标签：.net-3.5

该`System.Collections.Specialized.NameObjectCollectionBase`课程在我的公司被广泛用作收集课程的基础。（我们不要质疑为什么。）我最近遇到了一种情况，我需要在特定索引处添加一个对象，但该功能不存在。起初我想知道为什么我们把这个功能从*我们的*集合类中去掉了，但我很快发现这个功能在`NameObjectCollectionBase`!

`BaseGet(int index)`您可以通过索引 ( )访问集合中的对象。您可以通过索引 ( )
从集合中删除对象。 但是您不能在特定索引处插入对象。`BaseRemoveAt(int index)`

我想不出这个功能不可用的充分理由。你能？

[更新]底层实现不仅仅是一个`HashTable`. 该集合同时维护 a`HashTable`和 an `ArrayList`。您可以使用 Reflector 来验证这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T22:04:29.053

因为底层实现是 a`HashTable`并且直接插入它会破坏它（索引与键的哈希有关）。期望什么是散列，除了名称之外，在与键值散列无关的序列中被排序（即，特定元素存在于其他两个元素之间）似乎有点奇怪。如果您需要订购它，您最好使用`OrderedDictionary`or `SortedDictionary<T,T>`。

有关[NameObjectCollectionBase](http://msdn.microsoft.com/en-us/library/system.collections.specialized.nameobjectcollectionbase.aspx)、[OrderedDictionary](http://msdn.microsoft.com/en-us/library/system.collections.specialized.ordereddictionary.aspx)和[SortedDictionary<T,T>](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)的更多信息。

# c# - .NET RegionInfo 类

> ID：223611
> 
> 赞同：11
> 
> 时间：2008-10-21T21:41:57.273
> 
> 标签：c#, .net, globalization, regioninfo

当我尝试使用某些 ISO 3166 国家代码（孟加拉国的“BD”，索马里的“SO”，斯里兰卡的“LK”）创建一个新的 RegionInfo 时，我收到一个 ArgumentException 说它无法识别。

这是怎么回事？RegionInfo(string) 的 Intellisense 表示它符合 ISO 3166，但不支持这些国家/地区代码？

我不明白。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-21T21:58:23.043

.NET 没有提供所有开箱即用的文化/区域。请注意此处的“预定义”区域信息：http: [//msdn.microsoft.com/en-us/library/system.globalization.regioninfo](http://msdn.microsoft.com/en-us/library/system.globalization.regioninfo(VS.80).aspx) (VS.80).aspx 。

不幸的是，如果你想使用非预定义区域，你必须自己定义它们。这是 MSDN 操作方法：http: [//msdn.microsoft.com/en-us/library/ms172469](http://msdn.microsoft.com/en-us/library/ms172469(VS.80).aspx) (VS.80).aspx 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-14T14:35:49.533

~~现在支持您错过~~的所有区域（在较新版本的 .NET Framework 和操作系统中）。

以下代码`RegionInfo`从特定文化中查找所有“可访问”的内容：

```
foreach (var ri in CultureInfo.GetCultures(CultureTypes.SpecificCultures).Select(ci => new RegionInfo(ci.ToString())).OrderBy(x => x.TwoLetterISORegionName))
    Console.WriteLine("{0,3}: {1,11}: {2} ({3})", ri.TwoLetterISORegionName, ri, ri.EnglishName, ri.NativeName); 
```

现在在我的机器上它给出：

```
001：ar-001：世界（العالم）
001：en-001：世界（World）
001：eo-001：世界（世界）
001：ia-001：世界（世界）
001：la-001：世界（World）
001: prg-001: 世界 (swītai)
001：vo-001：世界（World）
001：yi-001：世界（וועלט）
029：en-029：加勒比（加勒比）
029：fr-029：加勒比海（caraïbes）
029：pap-029：加勒比（加勒比）
150：en-150：欧洲（欧洲）
419：es-419：拉丁美洲（Latinoamérica）
 AD：ca-AD：安道尔（Andorra）
 AE: ar-AE: 阿拉伯联合酋长国 (الإمارات العربية المتحدة)
 AF: prs-AF: 阿富汗 (افغانستان)
 AF: ps-AF: 阿富汗 (افغانستان)
 AF: uz-Arab-AF: 阿富汗 (افغانستان)
 AG: en-AG: Antigua and Barbuda (安提瓜和巴布达)
 AI: en-AI: 安圭拉 (Anguilla)
 AL: sq-AL: 阿尔巴尼亚 (Shqipëri)
 AM: hy-AM: 亚美尼亚 (Հայաստան)
 AO: ln-AO: 安哥拉 (Angóla)
 AO：pt-AO：安哥拉（安哥拉）
 AR：es-AR：阿根廷（阿根廷）
 AS: en-AS: 美属萨摩亚（美属萨摩亚）
 AT: de-AT: 奥地利 (Österreich)
 AT: en-AT: 奥地利（奥地利）
 AU: en-AU: 澳大利亚（澳大利亚）
 AW: nl-AW: 阿鲁巴 (Aruba)
 AX: sv-AX: 奥兰群岛 (Åland)
 AZ: az-Cyrl-AZ: 阿塞拜疆 (Азәрбајҹан)
 AZ: az-Latn-AZ: 阿塞拜疆 (Azərbaycan)
 BA: bs-Cyrl-BA: 波斯尼亚和黑塞哥维那 (Босна и Херцеговина)
 BA: bs-Latn-BA: 波斯尼亚和黑塞哥维那 (Bosna i Hercegovina)
 BA：hr-BA：波斯尼亚和黑塞哥维那（Bosna i Hercegovina）
 BA: sr-Cyrl-BA: 波斯尼亚和黑塞哥维那 (Босна и Херцеговина)
 BA: sr-Latn-BA: 波斯尼亚和黑塞哥维那 (Bosna i Hercegovina)
 BB: en-BB: 巴巴多斯 (Barbados)
 BD: bn-BD: 孟加拉国 (বাংলাদেশ)
 BE：de-BE：比利时（比利时）
 BE: en-BE: 比利时（比利时）
 BE：fr-BE：比利时（比利时）
 BE: nl-BE: 比利时 (België)
 BF：fr-BF：布基纳法索（Burkina Faso）
 BG: bg-BG: 保加利亚 (България)
 BH: ar-BH: 巴林 (البحرين)
 BI: en-BI: 布隆迪 (Burundi)
 BI：fr-BI：布隆迪（Burundi）
 BI：rn-BI：布隆迪（乌布隆迪）
 BJ：fr-BJ：贝宁（Bénin）
 BJ: yo-BJ: 贝宁 (Orílɛ́ède Bɛ̀nɛ̀)
 BL：fr-BL：圣巴泰勒米（Saint-Barthélemy）
 BM: en-BM: 百慕大 (Bermuda)
 BN：ms-BN：文莱（文莱）
 BO：es-BO：玻利维亚（玻利维亚）
 BO：quz-BO：玻利维亚（玻利维亚）
 BQ: nl-BQ: Bonaire, Sint Eustatius and Saba (Bonaire, Sint Eustatius en Saba)
 BR：es-BR：巴西（巴西）
 BR：pt-BR：巴西（巴西）
 BS: en-BS: Bahamas (巴哈马)
 BT：dz-BT：不丹（འབྲུག）
 BW: en-BW: 博茨瓦纳 (Botswana)
 BW：tn-BW：博茨瓦纳（博茨瓦纳）
 BY: be-BY: 白俄罗斯 (Беларусь)
 BY: ru-BY: 白俄罗斯 (Беларусь)
 BZ: en-BZ: 伯利兹 (Belize)
 BZ：es-BZ：伯利兹（Belice）
 CA: en-CA: 加拿大（加拿大）
 CA：fr-CA：加拿大（加拿大）
 CA: iu-Cans-CA: 加拿大 (ᑲᓇᑕ)
 CA：iu-Latn-CA：加拿大（卡纳塔）
 CA：moh-CA：加拿大（加拿大）
 CC: en-CC: 科科斯（基林）群岛（Cocos (Keeling) Islands）
 CD: fr-CD: 刚果 (DRC) (刚果民主共和国)
 CD: ln-CD: 刚果 (DRC) (Republíki ya Kongó Demokratíki)
 CD: lu-CD: 刚果 (DRC) (Ditunga wa Kongu)
 CD: sw-CD: 刚果 (DRC) (Jamhuri ya Kidemokrasia ya Kongo)
 CF: fr-CF: 中非共和国 (République centrafricaine)
 CF: ln-CF: 中非共和国 (Repibiki ya Afríka ya Káti)
 CF: sg-CF: 中非共和国 (Ködörösêse tî Bêafrîka)
 CG：fr-CG：刚果（刚果）
 CG：ln-CG：刚果（刚果）
 CH: de-CH: 瑞士 (Schweiz)
 CH: en-CH: 瑞士（瑞士）
 CH: fr-CH: 瑞士 (Suisse)
 CH: gsw-CH: 瑞士 (Schwiiz)
 CH：it-CH：瑞士（Svizzera）
 CH: pt-CH: 瑞士 (Suíça)
 CH: rm-CH: 瑞士 (Svizra)
 CH: wae-CH: 瑞士 (Schwiz)
 CI：fr-CI：科特迪瓦（Côte d'Ivoire）
 CK: en-CK: 库克群岛（Cook Islands）
 CL：arn-CL：智利（智利）
 CL：es-CL：智利（智利）
 CM：agq-CM：喀麦隆（Kàmàlûŋ）
 CM: bas-CM: 喀麦隆 (Kàmɛ̀rûn)
 CM：dua-CM：喀麦隆（喀麦隆）
 CM: en-CM: 喀麦隆 (Cameroon)
 CM：ewo-CM：喀麦隆（Kamərún）
 CM：ff-CM：喀麦隆（Kameruun）
 CM：fr-CM：喀麦隆（喀麦隆）
 CM：jgo-CM：喀麦隆（Kamɛlûn）
 CM：kkj-CM：喀麦隆（Kamɛrun）
 CM: ksf-CM: 喀麦隆 (kamɛrún)
 CM：mgo-CM：喀麦隆（卡马伦）
 CM: mua-CM: 喀麦隆 (kameruŋ)
 CM：nmg-CM：喀麦隆（Kamerun）
 CM：nnh-CM：喀麦隆（Kàmalûm）
 CM：yav-CM：喀麦隆（Kemelún）
 CN: bo-CN: 中国 (ཀྲུང་ཧྭ་མི་དམངས་སྤྱི་མཐུན་རྒྱལ་ཁབ།)
 CN: ii-CN: 中国 (ꍏꉸꏓꂱꇭꉼꇩ)
 CN: mn-Mong-CN: 中国 (ᠪᠦᠭᠦᠳᠡ ᠨᠠᠢᠷᠠᠮᠳᠠᠬᠤ ᠳᠤᠮᠳᠠᠳᠤ ᠠᠷᠠᠳ ᠣᠯᠣᠰ)
 CN: ug-CN: 中国 (جۇڭخۇا خەلق جۇمھۇرىيىتى)
 CN: zh-CN: 中国 (中国)
 CO：es-CO：哥伦比亚（哥伦比亚）
 CR：es-CR：哥斯达黎加（哥斯达黎加）
 CU：es-CU：古巴（古巴）
 CV: kea-CV: Cabo Verde (Kabu Verdi)
 CV: pt-CV: 佛得角 (Cabo Verde)
 CW: nl-CW: 库拉索 (Curaçao)
 CX: en-CX: 圣诞岛（Christmas Island）
 CY: el-CY: 塞浦路斯 (Κύπρος)
 CY: en-CY: Cyprus (塞浦路斯)
 CY: tr-CY: 塞浦路斯 (Kıbrıs)
 CZ: cs-CZ: 捷克 (Česko)
 DE：de-DE：德国（德国）
 DE：dsb-DE：德国（尼姆斯卡）
 DE: en-DE: 德国（德国）
 DE: hsb-DE: 德国 (Němska)
 DE：ksh-DE：德国（Doütschland）
 DE：nds-DE：德国（Düütschland）
 DJ：aa-DJ：吉布提（亚布提）
 DJ: ar-DJ: 吉布提 (جيبوتي)
 DJ：fr-DJ：吉布提（吉布提）
 DJ：so-DJ：吉布提（Jabuuti）
 DK：da-DK：丹麦（丹麦）
 DK: en-DK: 丹麦（丹麦）
 DK：fo-DK：丹麦（丹麦）
 DM: en-DM: 多米尼克 (Dominica)
 DO: es-DO: 多米尼加共和国 (República Dominicana)
 DZ: ar-DZ: 阿尔及利亚 (الجزائر)
 DZ：fr-DZ：阿尔及利亚（Algérie）
 DZ：kab-DZ：阿尔及利亚（Lezzayer）
 DZ: tzm-Latn-DZ: 阿尔及利亚 (Djazaïr)
 EC：es-EC：厄瓜多尔（厄瓜多尔）
 EC：quz-EC：厄瓜多尔（厄瓜多尔）
 EE：et-EE：爱沙尼亚（Eesti）
 EG: ar-EG: 埃及 (مصر)
 ER：aa-ER：厄立特里亚（Eretria）
 ER: ar-ER: 厄立特里亚 (إريتريا)
 ER: byn-ER: 厄立特里亚 (ኤርትራ)
 ER: en-ER: 厄立特里亚（厄立特里亚）
 ER：ssy-ER：厄立特里亚（Eretria）
 ER: ti-ER: 厄立特里亚 (ኤርትራ)
 ER: tig-ER: 厄立特里亚 (ኤርትራ)
 ES: ast-ES: 西班牙 (España)
 ES：ca-ES：西班牙（西班牙）
 ES：ca-ES-valencia：西班牙（西班牙）
 ES: es-ES: 西班牙 (España)
 ES: eu-ES: 西班牙（西班牙）
 ES：gl-ES：西班牙（西班牙）
 ET：aa-ET：埃塞俄比亚（奥托比亚）
 东部时间：上午-东部时间：埃塞俄比亚 (ኢትዮጵያ)
 ET: om-ET: 埃塞俄比亚 (Itoophiyaa)
 ET：so-ET：埃塞俄比亚（Itoobiya）
 ET: ti-ET: 埃塞俄比亚 (ኢትዮጵያ)
 ET: wal-ET: 埃塞俄比亚 (ኢትዮጵያ)
 FI: en-FI: 芬兰（芬兰）
 FI: fi-FI: 芬兰 (Suomi)
 FI: se-FI: 芬兰 (Suopma)
 FI: smn-FI: 芬兰 (Suomâ)
 FI: sms-FI: 芬兰 (Lää´ddjânnam)
 FI: sv-FI: 芬兰（芬兰）
 FJ: en-FJ: 斐济（斐济）
 FK: en-FK: 福克兰群岛（Falkland Islands）
 FM: en-FM: 密克罗尼西亚 (Micronesia)
 FO: fo-FO: 法罗群岛 (Føroyar)
 FR: br-FR: 法国 (Frañs)
 FR: ca-FR: 法国 (França)
 FR: co-FR: 法国 (法兰西)
 FR: fr-FR: 法国（法国）
 FR: gsw-FR: 法国 (Frànkrisch)
 FR: ia-FR: 法国（法兰西）
 FR: oc-FR: 法国 (França)
 GA: fr-GA: Gabon (加蓬)
 GB：cy-GB：英国（Y Deyrnas Unedig）
 GB：en-GB：英国（英国）
 GB：gd-GB：英国（An Rìoghachd Aonaichte）
 GB：kw-GB：英国（Rywvaneth Unys）
 GD: en-GD: Grenada (格林纳达)
 GE: ka-GE: 格鲁吉亚 (საქართველო)
 GE: os-GE: 格鲁吉亚 (Гуырдзыстон)
 GF：fr-GF：法属圭亚那（Guyane française）
 GG: en-GG: 根西岛 (Guernsey)
 GH：ak-GH：加纳（Gaana）
 GH：ee-GH：加纳（Ghana nutome）
 GH: en-GH: Ghana (加纳)
 GH：ha-Latn-GH：加纳（Gana）
 GI: en-GI: 直布罗陀 (Gibraltar)
 GL: da-GL: 格陵兰 (Grønland)
 GL: kl-GL: 格陵兰 (Kalaallit Nunaat)
 GM: en-GM: Gambia (冈比亚)
 GN: ff-GN: 几内亚 (Gine)
 GN: fr-GN: 几内亚 (Guinée)
 GN：nqo-GN：几内亚
 GP：fr-GP：瓜德罗普岛（Guadeloupe）
 GQ：es-GQ：赤道几内亚（Guinea Ecuatorial）
 GQ：fr-GQ：赤道几内亚（Guinée équatoriale）
 GQ：pt-GQ：赤道几内亚（Guiné Equatorial）
 GR: el-GR: 希腊 (Ελλάδα)
 GT：es-GT：危地马拉（危地马拉）
 GT：quc-Latn-GT：危地马拉（危地马拉）
 GU: en-GU: 关岛 (Guam)
 GW: pt-GW: 几内亚比绍 (Guiné-Bissau)
 GY: en-GY: Guyana (圭亚那)
 HK: en-HK: 香港特别行政区 (Hong Kong SAR)
 HK：zh-Hans-HK：香港特别行政区（香港特别行政区）
 HK: zh-HK: Hong Kong SAR (香港特别行政区)
 HN：es-HN：洪都拉斯（洪都拉斯）
 HR: hr-HR: 克罗地亚 (Hrvatska)
 HT: fr-HT: 海地 (Haïti)
 HU: hu-HU: 匈牙利 (Magyarország)
 ID：en-ID：印度尼西亚（印度尼西亚）
 ID：id-ID：印度尼西亚（印度尼西亚）
 ID：jv-Java-ID：印度尼西亚（印度尼西亚）
 ID：jv-Latn-ID：印度尼西亚（印度尼西亚）
 IE: en-IE: 爱尔兰（爱尔兰）
 IE: ga-IE: 爱尔兰 (Éire)
 IL: ar-IL: 以色列 (إسرائيل)
 IL: en-IL: 以色列（以色列）
 IL: he-IL: 以色列 (ישראל)
 IM: en-IM: 马恩岛 (Isle of Man)
 IM: gv-IM: 马恩岛 (Ellan Vannin)
 IN: as-IN: 印度 (ভাৰত)
 IN: bn-IN: 印度 (ভারত)
 IN: bo-IN: 印度 (རྒྱ་གར་)
 IN: brx-IN: 印度 (भारत)
 IN: en-IN: 印度 (印度)
 IN: gu-IN: 印度 (ભારત)
 IN: hi-IN: 印度 (भारत)
 IN: kn-IN: 印度 (ಭಾರತ)
 IN: kok-IN: 印度 (भारत)
 IN: ks-Arab-IN: 印度 (ہِنٛدوستان)
 IN：ks-Deva-IN：印度（印度）
 IN：ml-IN：印度 (ഇന്ത്യ)
 IN: mni-IN: 印度 (印度)
 IN: mr-IN: 印度 (भारत)
 IN: ne-IN: 印度 (भारत)
 IN: 或-IN: 印度 (ଭାରତ)
 IN: pa-IN: 印度 (ਭਾਰਤ)
 IN: sa-IN: 印度 (भारतम्)
 IN：sd-Deva-IN：印度（印度）
 IN: ta-IN: 印度 (இந்தியா)
 IN: te-IN: 印度 (భారత దేశం)
 IN: ur-IN: 印度 (بھارت)
 IO：en-IO：英属印度洋领地（British Indian Ocean Territory）
 智商: ar-IQ: 伊拉克 (العراق)
 IQ: ku-Arab-IQ: 伊拉克 (عێراق)
 智商：lrc-智商：伊拉克（伊拉克）
 IR: fa-IR: 伊朗 (ایران)
 IR: ku-Arab-IR: 伊朗 (ئێران)
 IR：lrc-IR：伊朗（伊朗）
 IR: mzn-IR: 伊朗 (ایران)
 IS：is-IS：冰岛（Ísland）
 IT: ca-IT: 意大利 (Itàlia)
 IT: de-IT: 意大利 (Italien)
 IT：毛皮-IT：意大利（意大利）
 IT：it-IT：意大利（意大利）
 JE: en-JE: 泽西 (Jersey)
 JM: en-JM: Jamaica (牙买加)
 JO：ar-JO：乔丹（الأردن）
 JP：ja-JP：日本（日本）
 KE：dav-KE：肯尼亚（肯尼亚）
 KE：ebu-KE：肯尼亚（肯尼亚）
 KE: en-KE: 肯尼亚（肯尼亚）
 KE：guz-KE：肯尼亚（肯尼亚）
 KE: kam-KE: 肯尼亚（肯尼亚）
 KE：ki-KE：肯尼亚（肯尼亚）
 KE：kln-KE：肯尼亚（Emetab Kenya）
 KE: luo-KE: 肯尼亚（肯尼亚）
 KE：luy-KE：肯尼亚（肯尼亚）
 KE：mas-KE：肯尼亚（肯尼亚）
 KE：mer-KE：肯尼亚（肯尼亚）
 KE: om-KE: 肯尼亚 (Keeniyaa)
 KE：saq-KE：肯尼亚（肯尼亚）
 KE: so-KE: 肯尼亚 (Kiiniya)
 KE：sw-KE：肯尼亚（肯尼亚）
 KE：teo-KE：肯尼亚（肯尼亚）
 KG: ky-KG: 吉尔吉斯斯坦 (Кыргызстан)
 KG: ru-KG: 吉尔吉斯斯坦 (Киргизия)
 KH: km-KH: 柬埔寨 (កម្ពុជា)
 KI: en-KI: 基里巴斯（基里巴斯）
 KM: ar-KM: 科摩罗 (جزر القمر)
 KM：fr-KM：科摩罗（科摩罗）
 KN: en-KN: 圣基茨和尼维斯（Saint Kitts and Nevis）
 KP: ko-KP: 朝鲜 (조선민주주의인민공화국)
 KR: ko-KR: 韩国 (대한민국)
 KW: ar-KW: 科威特 (الكويت)
 KY: en-KY: 开曼群岛（Cayman Islands）
 KZ: kk-KZ: 哈萨克斯坦 (Қазақстан)
 KZ: ru-KZ: 哈萨克斯坦 (Казахстан)
 LA: lo-LA: 老挝 (ລາວ)
 LB: ar-LB: 黎巴嫩 (لبنان)
 LC: en-LC: 圣卢西亚 (Saint Lucia)
 LI: de-LI: 列支敦士登（列支敦士登）
 LI: gsw-LI: 列支敦士登 (Liächteschtäi)
 LK: si-LK: 斯里兰卡 (ශ්‍රී ලංකාව)
 LK: ta-LK: 斯里兰卡 (இலங்கை)
 LR: en-LR: 利比里亚 (Liberia)
 LR: vai-Latn-LR: 利比里亚 (Laibhiya)
 LR: vai-Vaii-LR: 利比里亚 (ꕞꔤꔫꕩ)
 LS: en-LS: Lesotho (莱索托)
 LS: st-LS: 莱索托 (Lesotho)
 LT: lt-LT: 立陶宛 (Lietuva)
 LU：de-LU：卢森堡（卢森堡）
 LU：fr-LU：卢森堡（卢森堡）
 LU: lb-LU: 卢森堡 (Lëtzebuerg)
 LU：pt-LU：卢森堡（卢森堡）
 LV: lv-LV: 拉脱维亚 (Latvija)
 LY: ar-LY: 利比亚 (ليبيا)
 MA：ar-MA：摩洛哥（المملكة المغربية）
 MA：fr-MA：摩洛哥（摩洛哥）
 MA：shi-Latn-MA：摩洛哥（lmɣrib）
 MA：shi-Tfng-MA：摩洛哥（ⵍⵎⵖⵔⵉⴱ）
 MA：tzm-Arab-MA：摩洛哥（摩洛哥）
 MA：tzm-Latn-MA：摩洛哥（Meṛṛuk）
 MA：tzm-Tfng-MA：摩洛哥（ⵍⵎⵖⵔⵉⴱ）
 MA：zgh-Tfng-MA：摩洛哥（ⵍⵎⵖⵔⵉⴱ）
 MC：fr-MC：摩纳哥（摩纳哥）
 MD：ro-MD：摩尔多瓦（摩尔多瓦共和国）
 MD：ru-MD：摩尔多瓦（Молдова）
 我：sr-Cyrl-我：黑山（Црна Гора）
 我：sr-Latn-ME：黑山（Crna Gora）
 MF：fr-MF：圣马丁（Saint-Martin）
 MG: en-MG: 马达加斯加 (Madagascar)
 MG：fr-MG：马达加斯加（马达加斯加）
 MG：mg-MG：马达加斯加（Madagasikara）
 MH: en-MH: 马绍尔群岛（Marshall Islands）
 MK: mk-MK: 马其顿, FYRO (Република Македонија)
 MK: sq-MK: 马其顿, FYRO (Republika e Maqedonisë)
 ML：bm-Latn-ML：马里（马里）
 ML：fr-ML：马里（马里）
 ML：khq-ML：马里（Maali）
 ML：ses-ML：马里（Maali）
 MM: my-MM: 缅甸 (မြန်မာ)
 MN: mn-MN: 蒙古 (Монгол)
 MN: mn-Mong-MN: 蒙古 (ᠮᠣᠩᠭᠣᠯ ᠣᠯᠣᠰ)
 MO: en-MO: 澳门特别行政区 (Macao SAR)
 MO: pt-MO: 澳门特别行政区 (RAE de Macau)
 MO：zh-Hans-MO：澳门特别行政区（澳门特别行政区）
 MO: zh-MO: 澳门特别行政区 (澳门特别行政区)
 MP: en-MP: 北马里亚纳群岛（Northern Mariana Islands）
 MQ：fr-MQ：马提尼克岛（Martinique）
 MR: ar-MR: 毛里塔尼亚 (موريتانيا)
 MR：ff-MR：毛里塔尼亚（Muritani）
 MR：fr-MR：毛里塔尼亚（毛里塔尼亚）
 MS: en-MS: 蒙特塞拉特 (Montserrat)
 MT: en-MT: 马耳他（马耳他）
 MT：mt-MT：马耳他（马耳他）
 MU：en-MU：毛里求斯（毛里求斯）
 MU：fr-MU：毛里求斯（莫里斯）
 MU：mfe-MU：毛里求斯（莫里斯）
 MV：dv-MV：马尔代夫
 MW: en-MW: 马拉维 (Malawi)
 MX：es-MX：墨西哥（墨西哥）
 MY: en-MY: 马来西亚（马来西亚）
 MY: ms-MY: 马来西亚（马来西亚）
 MY: ta-MY: 马来西亚 (மலேசியா)
 MZ：mgh-MZ：莫桑比克（Umozambiki）
 MZ：pt-MZ：莫桑比克（莫桑比克）
 MZ：seh-MZ：莫桑比克（Moçambique）
 NA: af-NA: 纳米比亚 (Namibië)
 NA: en-NA: 纳米比亚（纳米比亚）
 NA: naq-NA: 纳米比亚 (Namibiab)
 NC: fr-NC: 新喀里多尼亚 (Nouvelle-Calédonie)
 NE: dje-NE: 尼日尔 (Nižer)
 NE：fr-NE：尼日尔（尼日尔）
 NE: ha-Latn-NE: 尼日尔 (Nijar)
 东北：twq-东北：尼日尔（Nižer）
 NF: en-NF: 诺福克岛（Norfolk Island）
 NG：bin-NG：尼日利亚（尼日利亚）
 NG: en-NG: 尼日利亚（尼日利亚）
 NG：ff-NG：尼日利亚（尼日利亚）
 NG：ha-Latn-NG：尼日利亚（纳杰里亚）
 NG：ibb-NG：尼日利亚（尼日利亚）
 NG：ig-NG：尼日利亚（Naịjịrịa）
 NG：kr-NG：尼日利亚（尼日利亚）
 NG：yo-NG：尼日利亚（Orílẹ́ède Nàìjíríà）
 NI：es-NI：尼加拉瓜（尼加拉瓜）
 NL: en-NL: 荷兰（荷兰）
 NL: fy-NL: 荷兰 (Nederlân)
 NL: nds-NL: 荷兰 (Nedderlannen)
 NL：nl-NL：荷兰（荷兰）
 NO：nb-NO：挪威（挪威）
 NO: nn-NO: 挪威 (Noreg)
 NO: se-NO: 挪威 (Norga)
 NO: sma-NO: 挪威 (Nöörje)
 NO: smj-NO: 挪威 (Vuodna)
 NP: ne-NP: 尼泊尔 (नेपाल)
 NR: en-NR: 瑙鲁（瑙鲁）
 NU: en-NU: 纽埃（纽埃）
 NZ: en-NZ: 新西兰（新西兰）
 NZ: mi-NZ: 新西兰 (Aotearoa)
 OM: ar-OM: 阿曼 (عمان)
 PA：es-PA：巴拿马（巴拿马）
 PE：es-PE：秘鲁（Perú）
 PE：quz-PE：秘鲁（Perú）
 PF：fr-PF：法属波利尼西亚（Polynésie française）
 PG: en-PG: 巴布亚新几内亚（巴布亚新几内亚）
 PH: en-PH: 菲律宾（菲律宾）
 PH：es-PH：菲律宾（菲律宾人）
 PH: fil-PH: 菲律宾 (Pilipinas)
 PK: en-PK: 巴基斯坦（巴基斯坦）
 PK: pa-Arab-PK: 巴基斯坦 (پاکستان)
 PK: sd-Arab-PK: 巴基斯坦 (پاکستان)
 PK: ur-PK: 巴基斯坦 (پاکستان)
 PL：pl-PL：波兰（Polska）
 下午：fr-PM：圣皮埃尔和密克隆（Saint-Pierre-et-Miquelon）
 PN: en-PN: 皮特凯恩群岛（Pitcairn Islands）
 PR: en-PR: Puerto Rico (波多黎各)
 PR：es-PR：波多黎各（波多黎各）
 PS: ar-PS: 巴勒斯坦权力机构 (ال​​سلطة الفلسطينية)
 PT: pt-PT: 葡萄牙（葡萄牙）
 PW: en-PW: Palau (帕劳)
 PY：es-PY：巴拉圭（巴拉圭）
 PY：gn-PY：巴拉圭（Paraguái）
 QA: ar-QA: 卡塔尔 (قطر)
 RE: fr-RE: 留尼汪 (La Réunion)
 RO: ro-RO: 罗马尼亚 (România)
 RS：sr-Cyrl-RS：塞尔维亚（Србија）
 RS: sr-Latn-RS: 塞尔维亚 (Srbija)
 RU: ba-RU: 俄罗斯 (Рәсәй)
 RU: ce-RU: 俄罗斯 (Росси)
 RU: cu-RU: 俄罗斯 (рѡссі́а)
 RU: os-RU: 俄罗斯 (Уӕрӕсе)
 RU: ru-RU: 俄罗斯 (Россия)
 RU: sah-RU: 俄罗斯 (Россия)
 RU: tt-RU: 俄罗斯 (Россия)
 RW: en-RW: Rwanda (卢旺达)
 RW：fr-RW：卢旺达（卢旺达）
 RW: rw-RW: 卢旺达 (U Rwanda)
 SA: ar-SA: 沙特阿拉伯 (المملكة العربية السعودية)
 SB: en-SB: 所罗门群岛 (Solomon Islands)
 SC: en-SC: 塞舌尔 (Seychelles)
 SC：fr-SC：塞舌尔（Seychelles）
 SD：ar-SD：苏丹（السودان）
 SD：en-SD：苏丹（苏丹）
 SE: en-SE: 瑞典（瑞典）
 SE: se-SE: 瑞典 (Ruoŧŧa)
 SE: sma-SE: 瑞典 (Sveerje)
 SE: smj-SE: 瑞典 (Svierik)
 SE：sv-SE：瑞典（Sverige）
 SG: en-SG: 新加坡（新加坡）
 SG：ms-SG：新加坡（新加坡）
 SG: ta-SG: 新加坡 (சிங்கப்பூர்)
 SG：zh-SG：新加坡（新加坡）
 SH: en-SH: St Helena, Ascension, Tristan da Cunha (St Helena, Ascension, Tristan da Cunha)
 SI: en-SI: 斯洛文尼亚（斯洛文尼亚）
 SI: sl-SI: 斯洛文尼亚 (Slovenija)
 SJ: nb-SJ: 斯瓦尔巴和扬马延 (Svalbard og Jan Mayen)
 SK：sk-SK：斯洛伐克（Slovensko）
 SL: en-SL: Sierra Leone (塞拉利昂)
 SM：it-SM：圣马力诺（San Marino）
 SN：dyo-SN：塞内加尔（Senegal）
 SN: ff-Latn-SN: 塞内加尔 (Senegal)
 SN：fr-SN：塞内加尔（Sénégal）
 SN：wo-SN：塞内加尔（Senegal）
 SO: ar-SO: 索马里 (الصومال)
 SO：马马虎虎：索马里（Soomaaliya）
 SR：nl-SR：苏里南（苏里南）
 SS：ar-SS：南苏丹 (جنوب السودان)
 SS: en-SS: 南苏丹（南苏丹）
 SS：nus-SS：南苏丹（南苏丹）
 ST: pt-ST: 圣多美和普林西比 (São Tomé e Príncipe)
 SV：es-SV：萨尔瓦多（El Salvador）
 SX: en-SX: 荷属圣马丁 (Sint Maarten)
 SX: nl-SX: 荷属圣马丁 (Sint-Maarten)
 SY: ar-SY: 叙利亚 (سوريا)
 SY：fr-SY：叙利亚（Syrie）
 SY: syr-SY: 叙利亚
 SZ: en-SZ: Swaziland (斯威士兰)
 SZ：ss-SZ：斯威士兰（斯威士兰）
 TC: en-TC: 特克斯和凯科斯群岛（特克斯和凯科斯群岛）
 TD: ar-TD: 乍得 (تشاد)
 TD: fr-TD: 乍得 (Tchad)
 TG：ee-TG：多哥（Togo nutome）
 TG：fr-TG：多哥（多哥）
 TH: th-TH: 泰国 (ไทย)
 TJ: tg-Cyrl-TJ: 塔吉克斯坦 (Тоҷикистон)
 TK: en-TK: Tokelau (托克劳)
 TL：pt-TL：东帝汶（东帝汶）
 TM：tk-TM：土库曼斯坦（Türkmenistan）
 TN: ar-TN: 突尼斯 (تونس)
 TN：fr-TN：突尼斯（突尼斯）
 TO: en-TO: 汤加 (Tonga)
 TO: to-TO: 汤加 (Tonga)
 TR：tr-TR：土耳其（Türkiye）
 TT: en-TT: 特立尼达和多巴哥 (Trinidad and Tobago)
 电视：en-TV：图瓦卢（图瓦卢）
 TW：zh-TW：台湾（台湾）
 TZ：asa-TZ：坦桑尼亚（Tadhania）
 TZ：bez-TZ：坦桑尼亚（Hutanzania）
 TZ: en-TZ: 坦桑尼亚（坦桑尼亚）
 TZ：jmc-TZ：坦桑尼亚（坦桑尼亚）
 TZ：kde-TZ：坦桑尼亚（坦桑尼亚）
 TZ：ksb-TZ：坦桑尼亚（坦桑尼亚）
 TZ: lag-TZ: 坦桑尼亚 (Taansanía)
 TZ：mas-TZ：坦桑尼亚（Tansania）
 TZ：rof-TZ：坦桑尼亚（坦桑尼亚）
 TZ：rwk-TZ：坦桑尼亚（坦桑尼亚）
 TZ：sbp-TZ：坦桑尼亚（Tansaniya）
 TZ：sw-TZ：坦桑尼亚（坦桑尼亚）
 TZ：vun-TZ：坦桑尼亚（坦桑尼亚）
 UA: ru-UA: 乌克兰 (Украина)
 UA: uk-UA: 乌克兰 (Україна)
 UG：cgg-UG：乌干达（乌干达）
 UG: en-UG: Uganda (乌干达)
 UG：lg-UG：乌干达（Yuganda）
 UG：nyn-UG：乌干达（乌干达）
 UG：sw-UG：乌干达（乌干达）
 UG：teo-UG：乌干达（乌干达）
 UG：xog-UG：乌干达（Yuganda）
 UM: en-UM: US Outlying Islands (US Outlying Islands)
 美国：chr-Cher-US：美国 (ᏌᏊ ᎢᏳᎾᎵᏍᏔᏅ ᏍᎦᏚᎩ)
 US: en-US: 美国（美国）
 US: es-US: 美国 (Estados Unidos)
 美国：haw-美国：美国（`Amelika Hui Pū`Ia）
 US: lkt-US: 美国 (Mílahaŋska Tȟamákȟočhe)
 UY：es-UY：乌拉圭（乌拉圭）
 UZ: uz-Cyrl-UZ: 乌兹别克斯坦 (Ўзбекистон)
 UZ: uz-Latn-UZ: 乌兹别克斯坦 (Oʻzbekiston)
 VA：it-VA：梵蒂冈城（Città del Vaticano）
 VC: en-VC: 圣文森特和格林纳丁斯 (Saint Vincent and the Grenadines)
 VE：es-VE：委内瑞拉（委内瑞拉）
 VG: en-VG: 英属维尔京群岛（British Virgin Islands）
 VI: en-VI: 美属维尔京群岛（US Virgin Islands）
 VN: vi-VN: 越南 (Việt Nam)
 VU: en-VU: 瓦努阿图 (Vanuatu)
 VU: fr-VU: 瓦努阿图 (Vanuatu)
 WF: fr-WF: 瓦利斯和富图纳 (Wallis-et-Futuna)
 WS: en-WS: 萨摩亚 (Samoa)
 XK: sq-XK: 科索沃 (Kosovë)
 XK: sr-Cyrl-XK: 科索沃 (Косово)
 XK：sr-Latn-XK：科索沃（科索沃）
 YE: ar-YE: 也门 (اليمن)
 YT: fr-YT: 马约特 (Mayotte)
 ZA：af-ZA：南非（Suid-Afrika）
 ZA: en-ZA: 南非（南非）
 ZA：nr-ZA：南非（南非）
 ZA：nso-ZA：南非（Afrika Borwa）
 ZA：ss-ZA：南非（南非）
 ZA：st-ZA：南非（南非）
 ZA：tn-ZA：南非（Aforika Borwa）
 ZA：ts-ZA：南非（南非）
 ZA：ve-ZA：南非（南非）
 ZA: xh-ZA: 南非 (eMzantsi Afrika)
 ZA: zu-ZA: 南非 (iNingizimu Afrika)
 ZM：bem-ZM：赞比亚（赞比亚）
 ZM: en-ZM: Zambia (赞比亚)
 ZW: en-ZW: 津巴布韦（津巴布韦）
 ZW：nd-ZW：津巴布韦（津巴布韦）
 ZW：sn-Latn-ZW：津巴布韦（津巴布韦）

```

**编辑：**更新到我的 Windows 10（版本 1803“2018 年 4 月更新”）机器 .NET Framework 4.7.2 中看到的内容。

# java - 使用java将文件从一个solaris 9复制到另一个

> ID：223614
> 
> 赞同：0
> 
> 时间：2008-10-21T21:43:18.363
> 
> 标签：java, ssh

如何仅使用 java 将文件从一台 solaris 9 机器复制到另一台 solaris 9 机器？

我们对两台机器都有 ssh 访问权限。java 程序将在这两台机器中的一台上运行。

更新： rsync 并不是一个真正的选择。不能轻易安装（UNIX 团队，嗯，很难对付）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T21:47:26.980

您可以使用 Runtime.exec() 启动[rsync](http://samba.anu.edu.au/rsync/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T22:50:38.837

或者你可以使用 FTP。或者您可以安装一些共享存储。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T00:47:07.510

使用 ssh 库 jsch -- [http://www.jcraft.com/jsch/](http://www.jcraft.com/jsch/)。ant 使用该程序进行 ssh 传输。非常好——在那里呆了很长时间（> 5 年），文档不错。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T02:30:49.703

如果你走的是 FTP 的道路，这里有 2 个库

1) [http://www.geocities.com/SiliconValley/Code/9129/javabean/ftpbean/](http://www.geocities.com/SiliconValley/Code/9129/javabean/ftpbean/)
2) [http://commons.apache.org/net/](http://commons.apache.org/net/)

# wpf - XAML - 文本框换行符

> ID：223615
> 
> 赞同：16
> 
> 时间：2008-10-21T21:43:53.527
> 
> 标签：wpf, xaml, textbox

无论如何，XAML 中是否只有在 TextBox 中有换行符？

我知道我可以在代码中设置 myTextBox.Text = "something\r\nsomething2" ，但我不能这样做：

```
<TextBox x:Name="myTextBox">
    <TextBox.Text>
        Something
        <Linebreak/>
        Something2
    </TextBox.Text>
</TextBox> 
```

或这个

```
<TextBox x:Name="myTextBox" Text="something\r\nsomething2" /> 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-21T21:49:24.497

试用...

```
<TextBox x:Name="myTextBox" Text="something1&#x0a;something2" /> 
```

[在这里](https://stackoverflow.com/questions/183406/xaml-newline-in-string-attribute)找到

# sql-server - Perl ADO 认为存储过程中的打印输出是错误的！

> ID：223618
> 
> 赞同：2
> 
> 时间：2008-10-21T21:44:55.800
> 
> 标签：sql-server, perl, ado, activestate

首先（如果这很重要）我使用的是 ActiveState 的 Perl（为 MSWin32-x86-multi-thread 构建的 v5.8.7）。

我刚刚从长达三个小时的调试会议中走出来，试图找到错误的根源。我发现根本没有错误，但由于某种原因，ADO 的连接对象`Errors.Count`随着存储过程输出中的每条打印消息而增加。

考虑以下 Transact SQL 代码：

```
CREATE PROCEDURE dbo.My_Sample() AS
BEGIN TRAN my_tran
-- Does something useful
if @@error <> 0 BEGIN
  ROLLBACK TRAN my_tran
  RAISERROR( 'SP My_Sample failed', 16, 1)
END ELSE BEGIN
  COMMIT TRAN my_tran
  PRINT 'SP My_Sample succeeded'
END 
```

现在想象一个 Perl sub 或多或少像：

```
sub execute_SQL {
  # $conn is an already opened ADO connection object
  # pointing to my SQL Server
  # $sql is the T-SQL statement to be executed
  my($conn, $sql) = @_;
  $conn->Execute($sql);
  my $error_collection = $conn->Errors();
  my $ecount = $error_collection->Count;
  if ($ecount == 0 ) { return 0; }
  print "\n" . $ecount . " errors found\n";
  print "Executed SQL Code:\n$sql\n\n";
  print "Errors while executing:\n";
  foreach my $error (in $error_collection){
    print "Error: [" . $error->{Number} . "] " . $error->{Description} . "\n";
  }
  return 1;
} 
```

在其他地方，在主 Perl 代码中，我将上面的子代码称为：

```
execute_SQL( $conn, 'EXEC dbo.My_Sample' ); 
```

最后，我知道*每个*PRINT 语句都会导致一个新的伪错误附加到 ADO 错误集合中。我实施的快速修复是将 SP 中的 PRINT 更改为 SELECT，以绕过它。

我想问的问题是：

*   这种行为正常吗？
*   有没有办法避免/绕过它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-21T22:05:55.010

这是意料之中的，因为它是 ADO 所做的，而 Win32::ADO 在它之上是相当薄的一层。

ref: 知识库[注意，RAISERROR 和 PRINT 语句是通过 ADO 错误集合返回的](http://support.microsoft.com/kb/194792)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T18:37:03.527

好的，经过**大量**的测试和阅读，我发现它在 BOL 的文章“使用 PRINT”中进行了解释（我的重点）：

> PRINT 语句用于向应用程序返回消息。PRINT 将字符或 Unicode 字符串表达式作为参数，并将字符串作为消息返回给应用程序。该消息作为信息错误返回给使用 SQLClient 命名空间或 ActiveX 数据对象 (ADO)、OLE DB 和开放式数据库连接 (ODBC) 应用程序编程接口 (API) 的应用程序。**SQLSTATE 设置为 01000，本机错误设置为 0，错误消息字符串设置为 PRINT 语句中指定的字符串。**该字符串返回给 DB-Library 应用程序中的消息处理程序回调函数。

有了这些知识，我从[这篇 DevX 文章中](http://www.devx.com/tips/Tip/13483)改编了这个 VB6，直到我得到这个：

```
sub execute_SQL {
  # $conn is an already opened ADO connection object
  # pointing to my SQL Server
  # $sql is the T-SQL statement to be executed
  # Returns 0 if no error found, 1 otherwise
  my($conn, $sql) = @_;
  $conn->Execute($sql);
  my $error_collection = $conn->Errors();
  my $ecount = $error_collection->Count;
  if ($ecount == 0 ) { return 0; }

  my ($is_message, $real_error_found);
  foreach my $error (in $error_collection){
    $is_message = ($error->{SQLState} eq "01000" && $error->{NativeError}==0);
    $real_error_found=1 unless $is_message;

    if( $is_message) {
      print "Message # " . $error->{Number}
      . "\n Text: " . $error->{Description} ."\n";
    } else {
      print "Error # " . $error->{Number}
      . "\n Description: " . $error->{Description}
      . "\nSource: " . $error->{Source} . "\n";
    }
  }

  print $message_to_print;
  return $real_error_found;
} 
```

所以现在我的 Perl 子程序正确地整理出真正的错误（通过 RaisError 从 SQL Server 发出）和通过“PRINT”输出的常见消息。

感谢 Richard Harrison 的回答，让我走上了成功之路。

# javascript - Swf 对象似乎在 Blogger 帖子中不起作用

> ID：223621
> 
> 赞同：0
> 
> 时间：2008-10-21T21:45:49.387
> 
> 标签：javascript, flash, swfobject, blogger, script-tag

任何想法为什么？

在下面的链接中，它显示“所以...”应该有一个嵌入式 swf。

[http://blog.iainlobb.com/2008/10/wrong-door-creating-papervision3d.html](http://blog.iainlobb.com/2008/10/wrong-door-creating-papervision3d.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T21:53:31.213

```
 <div id="walkmovie"></div>
        <script type="text/javascript">
            var so = new SWFObject("http://content.iainlobb.com/walk.swf", "walk", "400", "400", "9", "#336699");
            so.write("walkmovie");
        </script> 
```

您缺少加载 swf 的 div。

编辑：我看到你把那个 div 放在你的 html 中。我可以将您的 swf 加载到一个简单的 html 中。您应该在调用 SWFObject 之前加载 swfobject 库。

# .net - Spring.NET 和 Common.Logging XML 模式 (XSD) 是否存在？

> ID：223625
> 
> 赞同：1
> 
> 时间：2008-10-21T21:48:04.623
> 
> 标签：.net, xsd, spring.net, common.logging

[Spring.NET](http://www.springframework.net/) 1.2.0 M1 附带了几个用于 <objects> 节点、数据库内容等的 XSD 文件。但是，它是一个不完整的集合，因为它似乎不包括 <spring>（用于`App.config`）、<context>、或 <parsers> 元素。此外，[Common.Logging](http://netcommon.sourceforge.net/)似乎没有*任何*XSD 包含在源或分发中。

我们希望拥有这些，以便 Visual Studio 在验证`App.config`. 有模式很好，因为编译时检查可以帮助您在程序在 Spring 中抛出*之前发现 XML 错误。*

这些是否存在于任何地方/正在开发中，或者是否有人自己编写了一些？

同样，有没有人看到/解决了以下消息？

> 找不到属性“ [http://schemas.microsoft.com/Visual-Studio-Intellisense:friendlyname](http://schemas.microsoft.com/Visual-Studio-Intellisense:friendlyname) ”的架构信息（spring-objects-1.1.xsd）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T20:16:35.007

对于 App.config 中使用的其他顶级元素，它们不存在。[请在此处](http://jira.springframework.org/secure/BrowseProject.jspa?id=10020)输入 Spring 的 JIRA 问题以及 Common Logging -[此处](http://sourceforge.net/tracker/?group_id=182424&atid=901159)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T21:52:00.700

您是否尝试过使用 XSD 工具将 XML 输出文件逆向工程为您需要的 XSD？在为 log4net 编写自己的工具以获取 XSD 文件时，我做了类似的事情。

# sql - 返回部分匹配值的记录

> ID：223627
> 
> 赞同：4
> 
> 时间：2008-10-21T21:48:42.737
> 
> 标签：sql, ms-access, sql-like

我正在尝试使查询工作，该查询从表单控件中获取值（有时只是字符串的第一部分）。我遇到的问题是它仅在输入完整字符串时才返回记录。

即在姓氏框中，我应该可以输入 gr，它会弹出

绿色灰色格雷厄姆

但目前它没有提出任何东西，除非使用完整的搜索字符串。

有问题的表单上有 4 个搜索控件，它们仅在填写框的情况下用于查询。

查询是：

```
SELECT TabCustomers.*,
       TabCustomers.CustomerForname AS NameSearch,
       TabCustomers.CustomerSurname AS SurnameSearch,
       TabCustomers.CustomerDOB AS DOBSearch,
       TabCustomers.CustomerID AS MemberSearch
FROM TabCustomers
WHERE IIf([Forms]![FrmSearchCustomer]![SearchMember] Is Null
          ,True
          ,[Forms]![FrmSearchCustomer]![SearchMember]=[customerid])=True
      AND IIf([Forms]![FrmSearchCustomer].[SearchFore] Is Null
              ,True
              ,[Forms]![FrmSearchCustomer]![SearchFore] Like [customerforname] & "*")=True
      AND IIf([Forms]![FrmSearchCustomer]![SearchLast] Is Null
              ,True
              ,[Forms]![FrmSearchCustomer]![SearchLast] Like [customersurname] & "*")=True
      AND IIf([Forms]![FrmSearchCustomer]![Searchdate] Is Null
              ,True
              ,[Forms]![FrmSearchCustomer]![Searchdate] Like [customerDOB] & "*")=True; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-21T22:33:16.657

你有你的 LIKE 表达倒退。我重写了查询以删除不必要的 IIF 命令并修复 LIKE 运算符的操作数顺序：

```
SELECT TabCustomers.*
FROM TabCustomers
WHERE (Forms!FrmSearchCustomer!SearchMember Is Null Or Forms!FrmSearchCustomer!SearchMember=[customerid]) 
And (Forms!FrmSearchCustomer.SearchFore Is Null Or [customerforname] Like Forms!FrmSearchCustomer!SearchFore & "*") 
And (Forms!FrmSearchCustomer!SearchLast Is Null Or [customersurname] Like Forms!FrmSearchCustomer!SearchLast & "*") 
And (Forms!FrmSearchCustomer!Searchdate Is Null Or [customerDOB] Like Forms!FrmSearchCustomer!Searchdate & "*"); 
```

我通过复制最可能的情况来构建该查询：我创建了一个包含提到的字段的虚拟表，以及一个包含字段的表单和一个包含上面列出的查询的子表单，当按下搜索按钮时，它会刷新。如果您愿意，我可以提供我创建的示例的下载链接。该示例按预期工作。J 只拾取 Jim 和 John，而 John 或 Jo 只提取 John 记录。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-22T09:09:12.393

## 有一种访问方法！

如果您在表单上有“过滤器”控件，为什么不使用 Application.buildCriteria 方法，这将允许您将过滤条件添加到字符串，然后使用该字符串进行过滤，并构建您的 WHERE即时条款？

```
selectClause = "SELECT TabCustomers.* FROM TabCustomers"
if not isnull(Forms!FrmSearchCustomer!SearchMember) then
    whereClause = whereClause & application.buildCriteria(your field name, your field type, your control value) &  " AND "
endif
if not isnull(Forms!FrmSearchCustomer!SearchFore) then
    whereClause = whereClause & application.buildCriteria(...) &  " AND "
endif
if not isnull(Forms!FrmSearchCustomer!SearchLast) then
    whereClause = whereClause & application.buildCriteria(...) &  " AND "
endif
if not isnull(Forms!FrmSearchCustomer!SearchDate) then
    whereClause = whereClause & application.buildCriteria(...) & " AND "
endif
--get rid of the last "AND"
if len(whereClause) > 0 then
     whereClause = left(whereClause,len(whereClause)-5)
     selectClause = selectClause & " WHERE " & whereClause
endif
-- your SELECT instruction is ready ... 
```

编辑： buildCriteria 将返回（例如）：

*   `'field1 = "GR"'`当您在控件中键入“GR”时
*   `'field1 LIKE "GR*"'`当您输入`"GR*"`控件时
*   `'field1 LIKE "GR*" or field1 like "BR*"'`如果您输入`'LIKE "GR*" OR LIKE "BR*"'`控件

PS：如果您的表单上的“过滤器”控件始终具有相同的语法（例如“search_fieldName”，其中“fieldName”对应于基础记录集中的字段）并且始终位于同一区域（例如 formHeader），然后可以编写一个自动为当前表单生成过滤器的函数。然后可以将此过滤器设置为表单过滤器，或用于其他用途：

```
For each ctl in myForm.section(acHeader).controls
    if ctl.name like "search_"
        fld = myForm.recordset.fields(mid(ctl.name,8))
        if not isnull(ctl.value) then
           whereClause = whereClause & buildCriteria(fld.name ,fld.type, ctl.value) & " AND "
        endif
    endif
next ctl
if len(whereClause)> 0 then ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T22:16:34.317

发生了两件事 - 应该颠倒比较，并且您没有正确引用字符串。

它应该是[数据库字段]，如“部分字符串+通配符”

并且所有字符串都需要用引号引起来-不确定为什么您的查询不会引发错误

所以以下应该工作：

```
,[customerforname] Like  """" & [Forms]![FrmSearchCustomer]![SearchFore] & "*""" )=True 
```

请注意 """" 这是将单个双引号附加到字符串的唯一方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T21:54:04.253

我唯一的想法是可能需要一个 () 来分组类似

例如第一部分的片段

```
,[Forms]![FrmSearchCustomer]![SearchFore] Like ([customerforname] & "*"))=True 
```

自从我使用访问以来已经有一段时间了，但这是我想到的第一件事

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T22:09:58.807

这是一个完整的重写，以允许名称字段或出生日期字段中的空值。如果在数字 customerid 字段中输入文本，此查询不会因为过于复杂而失败。

```
SELECT TabCustomers.CustomerForname AS NameSearch, TabCustomers.CustomerSurname AS SurnameSearch, TabCustomers.CustomerDOB AS DOBSearch, TabCustomers.customerid AS MemberSearch
FROM TabCustomers
WHERE TabCustomers.customerid Like IIf([Forms]![FrmSearchCustomer].[Searchmember] Is Null,"*",[Forms]![FrmSearchCustomer]![Searchmember])
AND Trim(TabCustomers.CustomerForname & "") Like IIf([Forms]![FrmSearchCustomer].[SearchFore] Is Null,"*",[Forms]![FrmSearchCustomer]![SearchFore] & "*")
AND Trim(TabCustomers.CustomerSurname & "") like IIf([Forms]![FrmSearchCustomer].[Searchlast] Is Null,"*",[Forms]![FrmSearchCustomer]![SearchLast] & "*")
AND (TabCustomers.CustomerDOB Like IIf([Forms]![FrmSearchCustomer].[SearchDate] Is Null,"*",[Forms]![FrmSearchCustomer]![SearchDate] ) Or TabCustomers.CustomerDOB Is Null) 
```

# c# - 派生的所有者绘制的 TabControl 的双缓冲问题？

> ID：223628
> 
> 赞同：2
> 
> 时间：2008-10-21T21:49:12.733
> 
> 标签：c#, tabcontrol, doublebuffered, ownerdrawn

我已经派生了一个 TabControl，其明确目的是启用双缓冲，除了没有按预期工作。这是 TabControl 代码：

```
class DoubleBufferedTabControl : TabControl
{
    public DoubleBufferedTabControl() : base()
    {
        this.DoubleBuffered = true;
        this.SetStyle
            (
                ControlStyles.UserPaint |
                ControlStyles.AllPaintingInWmPaint |
                ControlStyles.ResizeRedraw |
                ControlStyles.OptimizedDoubleBuffer |
                ControlStyles.SupportsTransparentBackColor,
                false
            );
    }
} 
```

然后将此 Tabcontrol 的绘制模式设置为“OwnerDrawnFixed”，以便我可以更改颜色。这是自定义绘图方法：

```
 private void Navigation_PageContent_DrawItem(object sender, DrawItemEventArgs e)
    {
        //Structure.
        Graphics g = e.Graphics;
        TabControl t = (TabControl)sender;
        TabPage CurrentPage = t.TabPages[e.Index];

        //Get the current tab
        Rectangle CurrentTabRect = t.GetTabRect(e.Index);

        //Get the last tab.
        Rectangle LastTab = t.GetTabRect(t.TabPages.Count - 1);

        //Main background rectangle.
        Rectangle BackgroundRect = new Rectangle(LastTab.Width, t.Bounds.Y - 4, t.Width - (LastTab.Width), t.Height);

        //Tab background rectangle.
        Rectangle TabBackgroundRect = new Rectangle(0, LastTab.Y + LastTab.Height, LastTab.Width, t.Bounds.Height - (LastTab.Y + LastTab.Height));

        //Set anitialiasing for the text.
        e.Graphics.TextRenderingHint = System.Drawing.Text.TextRenderingHint.ClearTypeGridFit;

        //String format for the text.
        StringFormat StringFormat = new StringFormat();
        StringFormat.Alignment = StringAlignment.Center;
        StringFormat.LineAlignment = StringAlignment.Center;

        //Fill the background.
        g.FillRectangle(Brushes.LightGray, BackgroundRect);
        g.FillRectangle(Brushes.Bisque, TabBackgroundRect);

        //Draw the selected tab.
        if(e.State == DrawItemState.Selected)
        {
            g.FillRectangle(Brushes.White, e.Bounds);
            Rectangle SelectedTabOutline = new Rectangle(e.Bounds.X + 2, e.Bounds.Y + 2, e.Bounds.Width, e.Bounds.Height - 4);
            g.DrawRectangle(new Pen(Brushes.LightGray, 4f), SelectedTabOutline);
            g.DrawString(CurrentPage.Text, new Font("Arial", 12f, FontStyle.Bold, GraphicsUnit.Point), new SolidBrush(Color.FromArgb(70, 70, 70)), CurrentTabRect, StringFormat);
        }
        else
        {
            g.FillRectangle(new SolidBrush(Color.FromArgb(230, 230, 230)), e.Bounds);
            g.DrawString(CurrentPage.Text, new Font("Arial", 12f, FontStyle.Regular, GraphicsUnit.Point), Brushes.Gray, CurrentTabRect, StringFormat);
        }

    } 
```

然而，一切都无济于事，因为这个控件不是双缓冲的，并且在调整大小时仍然会闪烁。

**有任何想法吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T00:03:39.263

如果您阅读文档，它会说，“此成员对于此控件没有意义。” 如果您希望使用双缓冲来绘制控件，则必须自己实现它。除了如果您拥有控件，您将不得不自己实现双缓冲这一事实。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-10T19:53:32.433

首先，您可以摆脱您的`TabControl`代码——您打开缓冲，然后立即将其关闭，因此它实际上并没有做任何有用的事情。

*您的部分*问题是您试图仅绘制`TabControl`.

提供大约 90% 解决方案的最简单解决方案（仍然可能会出现闪烁）是将其添加到您的表单类中：

```
protected override CreateParams CreateParams
{
    get
    {
        CreateParams cp = base.CreateParams;
        cp.ExStyle |= 0x02000000;
        return cp;
    }
} 
```

如果您想*非常*确定没有闪烁，则需要自己绘制整个画面`TabControl`，并确保忽略背景绘制请求。

编辑：请注意，这仅适用于 XP 及更高版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T17:48:02.643

过去，我在控件上遇到了双重缓冲问题，而停止闪烁的唯一方法是确保不调用继承的 OnPaintBackground 方法。（参见下面的代码）您还需要确保在您的绘制调用期间绘制整个背景。

```
protected override void OnPaintBackground( PaintEventArgs pevent )
{
    //do not call base - I don't want the background re-painted!
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T22:00:30.903

不确定，但您可以尝试对包含选项卡控件的控件进行双缓冲。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T03:49:09.187

我环顾四周，尝试了您的代码以及我能想到的任何其他方法，但我看不到消除闪烁的方法。不幸的是，在我的测试中，即使是常规的（非所有者绘制的）选项卡控件在调整大小时也会闪烁。

对于它的价值，关闭“拖动时显示窗口内容”将修复它，但我意识到这可能没有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-10T13:43:56.267

我认为它不起作用，因为您禁用了双缓冲！

所做`this.DoubleBuffered = true`的只是将 ControlStyles.OptimizedDoubleBuffer 设置为 true。由于您在程序的下一行禁用了该标志，因此您实际上什么也没做。删除 ControlStyles.OptimizedDoubleBuffer（也许还有 ControlStyles.AllPaintingInWmPaint），它应该适合你。

# .net - Windows 窗体的类似 Awesomebar 的行为

> ID：223631
> 
> 赞同：3
> 
> 时间：2008-10-21T21:49:43.373
> 
> 标签：.net, winforms, devexpress

我正在尝试制作一个类似于 Firefox 3 Awesomebar 的组合框，具有以下行为：

1.  输入文字
2.  异步带回结果
3.  上下选择列表中的结果，**但保留**在输入框中键入的文本，以便用户可以继续编辑以不同方式限制结果集
4.  Enter 触发父表单将处理的事件

我有异步结果和过滤所有工作，但我没有在结果中显示和选择的好方法。

当您向下箭头时，组合框会自动填充输入框。失败#3。

我有 DevExpress 控件，但他们的组合框做同样的事情，我不知道如何覆盖。

LookupEdit 不允许输入任意内容。PopupContainerEdit 也没有。

我想要的行为就像一个下面有一个列表框的文本框，并且文本框中的向上/向下事件传递给列表框。但是，如果我尝试制作一个将两者结合在一起的自定义控件，我不知道如何像普通组合框上的下拉菜单一样“浮动”列表框。

线索非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T21:59:44.477

您可能需要使用文本框而不是组合框，因为使用箭头键是从组合列表中选择值并覆盖当前值。通过使用文本框，您可以在 TextChanged 事件中进行查找，并且可以通过覆盖 KeyPress 事件来存储当前键入的值，以收集和存储用户键入的键。
您必须在绘制事件中自行绘制值的弹出列表。

这可能看起来过于复杂，但您可能需要删除组合控件并自己实现它的一些功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-21T22:06:27.647

我一直在使用 Skybound 的 AutoComplete 控件。免费。它可以自定义，以便它可以近似于 Awesomebar 的行为。

[http://dev.skybound.ca/Products/AutoComplete/](http://dev.skybound.ca/Products/AutoComplete/)

# c++ - Linux编程环境配置

> ID：223634
> 
> 赞同：2
> 
> 时间：2008-10-21T21:50:26.587
> 
> 标签：c++, linux, development-environment

前几天我在虚拟机中安装了一个 Ubuntu，然后去收集我认为主要用 C++ 进行编程所需的工具和库。

但是我遇到了一个问题，将诸如 3rd 方源库之类的东西放在哪里。据我所知，很多源代码发行版都假设它们的许多依赖项已经安装在某个位置，并假设很多工具也安装在特定位置。

举一个我目前在 Windows 上所做的例子，我有一个目录来保存所有源代码。`C:\code`. 在这个目录中，我有一个所有 3rd 方库的目录，`c:\code\thirdparty\libs`. 这样，我可以轻松地为我编写或遇到并希望编译的任何项目的所有依赖项设置相对路径。我对设置 linux 编程环境感兴趣的原因是，似乎工具和库依赖问题都得到了有效解决，例如从源代码构建 OpenSSH 变得容易。

因此，当我尝试在 linux 上组织我的项目和库时，我一直在寻找一个体面的约定，它易于维护和使用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-21T21:58:54.790

简短的回答：不要做“本地目录中的大量代码”的事情。

长答案：不要做“本地目录中的大量代码”的事情，因为保持最新状态将是一场噩梦，如果您决定分发您的代码，将其打包以获取任何体面的代码将是一场噩梦分配。

只要有可能，请坚持使用发行版中提供的库（ubuntu 有 20000 多个数据包，它应该预先打包了您需要的大部分内容）。当没有软件包时，您可以手动安装到 /usr/local （但请参阅上面关于升级的内容，不要这样做）。

更好的是，使用“stow”或“installwatch”（或两者）安装到每个库目录（/usr/local/stow/libA-ver123），然后将文件从那里符号链接到 /usr/local 或 /usr/（stow做simlinking部分）。或者只是为您的发行版打包 lib。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-21T21:51:35.570

对于库/包含...

```
/usr/local/lib
/usr/local/include 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-22T09:15:49.573

尽可能针对系统/发行版提供的库的代码。这使得在该发行版上发布产品变得最容易。

但是，如果您正在构建一个商业应用程序，因为 Linux 发行版的风格如此之多，这可能意味着您必须为每个发行版维护大量不同的应用程序构建。这不一定是坏事，因为这意味着您可以更干净地与发行版的包管理系统集成。

但是在你不能这样做的情况下，下载你拥有的每个 3rd 方依赖项的源代码并将该依赖项的构建集成到一个链接到你的可执行文件的静态库中应该是相当容易的。这样，您就可以确切地知道要链接的内容，但缺点是会增大可执行文件的大小。如果您需要发行版未提供的特定库（或版本），这也可能是必需的。

如果您希望您的代码构建在各种不同的 Unix 系统上，那么您可能明智地研究 GNU [autoconf](http://www.gnu.org/software/autoconf/)和[automake](http://www.gnu.org/software/automake/)。这些可以帮助您构建`configure`脚本并`makefile`为您的项目构建脚本，以便它可以构建在几乎任何 Unix 系统上。

还可以查看现在在 Linux 发行版上大量使用的[pkg-config](http://pkg-config.freedesktop.org/wiki/)，以帮助您包含和链接到正确的库（对于支持 pkg-config 的库）。

如果您使用颠覆来管理您的源代码，那么大多数颠覆存储库都使用“约定”来管理自己的代码和“供应商”代码。

大多数 svn 存储库都有一个“供应商”树（与树干、分支和标签树一起）。这是所有 3rd 方供应商代码的顶部。在该目录中，您使用的每个库都有目录。例如：

```
branches/
tags/
trunk/
vendor/somelib
vendor/anotherlib 
```

在每个库下面是每个库版本的目录和存储库中最新版本的“当前”目录。

```
vendor/somelib/1.0
vendor/somelib/1.1
vendor/somelib/current 
```

然后你的项目的树应该像这样布置：

trunk/source #所有代码都在这里 trunk/libs #所有供应商代码都在这里

libs 目录应该是空的，但它会有`svn:externals`与之关联的元数据，通过：

```
svn propedit svn:externals trunk/libs 
```

该属性的内容类似于（假设颠覆 1.5）：

```
^/vendor/somelib/current   somelib
^/vendor/anotherlib/1.0    anotherlib 
```

这意味着当您签出代码颠覆时，也会将您的供应商库签出到您的 trunk/libs 目录中。因此，当签出时，它看起来像这样：

```
trunk/source
trunk/libs/somelib
trunk/libs/anotherlib 
```

[这在Subversion Book](http://svnbook.red-bean.com/en/1.5/index.html)中有描述（可能要好得多）。特别是关于处理[供应商分支](http://svnbook.red-bean.com/en/1.5/svn.advanced.vendorbr.html)和[外部](http://svnbook.red-bean.com/en/1.5/svn.advanced.externals.html)的部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T21:56:10.880

Ubuntu = Debian = apt-get goodness

[从Linux 实用程序](http://packages.debian.org/stable/base/util-linux)开始：

```
%> sudo apt-get install util-linux 
```

# java - Java泛型 - 从方法返回声明类型的子类型

> ID：223640
> 
> 赞同：7
> 
> 时间：2008-10-21T21:52:00.327
> 
> 标签：java, generics

我的班级正在实现一个超类方法，该方法返回`List<JComponent>`. 返回的列表是只读的：

```
public abstract class SuperClass {
    public abstract List<JComponent> getComponents();
} 
```

在我的课堂上，我想返回一个声明为 List 的字段 - 即一个子列表：

```
public class SubClass extends SuperClass {
    private List<JButton> buttons;
    public List<JComponent> getComponents() {
        return buttons;
    }
} 
```

这会产生编译器错误，因为`List<JButton>`它不是`List<JComponent>`.

我可以理解为什么它不能编译，因为它不应该被允许将 JTextField 添加到 JButtons 列表中。

但是，由于该列表是只读的，因此“从概念上”应该允许这样做。但是，当然，编译器不知道它是只读的。

有没有什么方法可以实现我想要实现的，不改变超类中的方法声明，以及子类中的字段声明？

谢谢，卡鲁姆

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-21T21:55:19.463

声明`getComponents()`为：

```
public List<? extends JComponent> getComponents() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-21T22:32:08.297

我想我已经找到了我正在寻找的答案......

```
return Collections.<JComponent>unmodifiableList(buttons); 
```

我之前尝试过：

```
return Collections.unmodifiableList(buttons); 
```

但这被类型推断为`List<JButton>`.

放入显式类型参数允许`List<JButton>`将 视为 a `List<JComponent>`，这是允许的`unmodifiableList()`。

我现在很高兴 ;-) 并且由于讨论，我学到了一些东西。

卡鲁姆

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-21T22:26:57.167

我认为你不能在不改变超类方法签名或子类列表声明的情况下做你想做的事。超类将返回类型严格定义为 JComponent。除了 JComponent 之外，没有其他方法可以让您的返回类型。

如果它是只读的，我会这样做：

```
public class SubClass extends SuperClass {
    private List<JComponent> buttons = new ArrayList<JComponent>();
    public void addButton(JButton button) {
        buttons.add(button);
    }
    public List<JComponent> getComponents() {
        return Collections.unmodifiableList(buttons);
    }
} 
```

如果您可以修改超类，则可以尝试以下操作：

```
public abstract class SuperClass<E extends JComponent> {
    public abstract List<E> getComponents();
}

public class SubClass extends SuperClass<JButton> {
    private List<JButton> buttons = new ArrayList<JButton>();
    public List<JButton> getComponents() {
        return Collections.unmodifiableList(buttons);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T03:15:38.573

返回带有通配符的泛型类型不是一个好主意，因为它会迫使客户端考虑返回的内容......它还会使客户端代码更加繁琐且难以阅读。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T22:00:00.763

为此，您需要扩展泛型。:)

```
public abstract class SuperClass {
    public abstract List<? extends JComponent> getComponents();
}

public class SubClass extends SuperClass {
    private List<JButton> buttons;
    public List<? extends JComponent> getComponents() {
        return buttons;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T22:00:09.390

嗯，不确定

设置它的通常方法是让 super 看起来像

```
public abstract class SuperClass {
    public abstract List<? extends JComponent> getComponents();
} 
```

不知道如何在不改变它的情况下做到这一点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-21T22:36:29.177

泛型的全部意义在于为诸如集合的“类型”之类的事物提供编译时类型安全。不幸的是， a`List<JButton>`不是 a 的子类型`List<JComponent>`。原因很简单，如下：

```
List<JComponent> jc;
List<JButton> jb = new ArrayList<JButton>();
//if List<JButton> was a sublcass of List<JComponent> then this is a valid assignment
jc = jb;
jc.add(new JCheckBox()); //valid, as jc accepts any JComponent

JButton b = jb.get(0); //this will throw a ClassCastException, rendering Generic type-safety pointless 
```

泛型以这种方式是*逆变的*，您最初的愿望可能是用返回 a 的方法覆盖返回 a 的`String`方法`Float`

我认为在设计泛型类时要**非常小心是一个很好的一般规则。**你真的需要泛型吗？它将如何使用？一些通用设计最终会出现糟糕的结构，这意味着用户必须恢复到*原始*版本。`JTable`的过滤机制就是一个很好的例子：当你想实现一个过滤链（你肯定会的！）时，整个事情就崩溃了。事实上; 在这种情况下，添加仿制药是有代价的，实际上没有任何好处。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-21T22:13:15.620

你可以用`@SuppressWarnings`. 我相信这在这种情况下是合适的，只需确保您在评论中记录原因。

或者，执行以下操作：

```
public List<JComponent> getComponents()
{
  return new ArrayList<JComponent>( buttons );
} 
```

是的，我知道这是一个副本，并且该列表已经是只读的。但是除非分析器告诉你否则，我会假设惩罚很小。

@Calum：我同意在返回类型中使用 ?-expressions 是不好的形式，因为调用代码无法执行此操作，例如：

```
List<JComponent> list = obj.getComponents(); 
```

# c# - 在 c# 的 switch 中使用'is'关键字

> ID：223643
> 
> 赞同：23
> 
> 时间：2008-10-21T21:52:16.177
> 
> 标签：c#, switch-statement

我目前正在向此代码添加一些新的扩展类：

```
foreach (BaseType b in CollectionOfExtendedTypes) {
  if (b is ExtendedType1) {
    ((ExtendedType1) b).foo = this;

  }
  else if (b is ExtendedType2) {
    ((ExtenedType2) b).foo = this;

  } 
  else {
    b.foo = this;

  }
} 
```

并且很好奇是否有办法`is`在 switch 语句中使用关键字功能？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2017-11-30T14:06:29.567

最新版本的 C# (7) 现在包含此功能

[类型模式](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/switch#type-pattern)

类型模式可以实现简洁的类型评估和转换。当与 switch 语句一起使用来执行模式匹配时，它会测试表达式是否可以转换为指定的类型，如果可以，则将其转换为该类型的变量。它的语法是：

```
 case type varname 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-21T22:06:15.290

这看起来确实像是一个好的多态实现的情况。如果在派生类中重写适当的方法，则可能根本不需要循环中的检查。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-21T21:54:46.687

没有。看

[C# switch 语句限制 - 为什么？](https://stackoverflow.com/questions/44905/c-switch-statement-limitations-why)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-21T21:57:03.920

在 C# 中，不能将“is”关键字用作 switch 语句的一部分。switch 中的所有 case 标签都必须计算为常量表达式。"is" 不能转换为常量表达式。

不过，在切换类型时，我肯定会感到痛苦。因为您概述的解决方案确实有效，但它是 x do y 和 a do b 的一种复杂说法。像下面这样写会更自然

```
 TypeSwitch.Do(
    sender,
    TypeSwitch.Case<Button>(() => textBox1.Text = "Hit a Button"),
    TypeSwitch.Case<CheckBox>(x => textBox1.Text = "Checkbox is " + x.Checked),
    TypeSwitch.Default(() => textBox1.Text = "Not sure what is hovered over")); 
```

这是我写的关于如何实现此功能的博客文章。

[http://blogs.msdn.com/jaredpar/archive/2008/05/16/switching-on-types.aspx](http://blogs.msdn.com/jaredpar/archive/2008/05/16/switching-on-types.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-21T22:04:58.240

虽然不可能使用 switch 语句来检查类型，但将问题减少到更易于管理的代码库并非不可能。

根据具体情况和要求，我会考虑。

*   使用 a`IDictionary<Type, T>`将结果存储在字典中。T 本身可以是您可以调用的委托。如果您不需要担心继承，这将起作用 - 满足继承需要更多的工作。

*   在 switch 语句中使用类的类型名称（字符串）。这使用`switch (b.GetType().Name)`并且没有用于深度继承结构的选项。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-04-06T08:11:25.733

正如[MikeT的](https://stackoverflow.com/users/735897/miket)[回答](https://stackoverflow.com/a/47575390/4949005)中提到的，您可以使用需要 C# 7的[模式数学。](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/switch)

这是您的代码的示例：

```
foreach (BaseType b in CollectionOfExtendedTypes) {
  switch (b) {
    case ExtendedType1 et1:
        // Do stuff with et1.
        et1.DoStuff();
        break;
    case ExtendedType2 et2:
        // Do stuff with et2.
        et2.DoOtherStuff();
        break;
    default:
        // Do something else...
        break;
  }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-21T21:59:29.047

您可以添加一个由每个具体子类实现的方法`getType()`以`BaseType`返回一个唯一的整数 ID（可能是一个枚举）并打开它，是吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-21T22:01:10.323

并非如此，开关将变量（字符串或 int（或枚举））与常量表达式匹配为 switch 语句。

[http://msdn.microsoft.com/en-us/library/06tc147t(VS.71).aspx](http://msdn.microsoft.com/en-us/library/06tc147t(VS.71).aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-16T04:23:47.570

根据我的经验，类型案例和面向对象的代码似乎并没有很好地结合在一起。在这种情况下我更喜欢的方法是[双重调度模式](http://c2.com/cgi/wiki?DoubleDispatch)。简而言之：

*   **使用空虚方法 Process(ExtendedTypeN arg) 为您将分派的每个扩展类型 **创建一个侦听器类型。****
*   ****将虚拟方法**Dispatch(Listener listener) 添加到将侦听器作为参数的基本类型。它的实现将是调用 listener.Process((Base) this)。**
*   *****覆盖每个扩展类型中的******Dispatch***方法，以调用侦听器类型中适当的 Process**过*****载***。****
*   ******通过为您感兴趣的每个子 **类型覆盖适当的 Process 方法来扩展侦听器类型。********

 ******参数改组舞蹈通过将其折叠到对 Dispatch 的调用中来消除缩小范围——接收者知道它的确切类型，并通过回调其类型的 Process 的确切重载来传达它。这也是 .NET Compact Framework 等实现中的一大性能优势，在这些实现中，缩小转换非常慢，但虚拟调度非常快。

结果将是这样的：

```
 public class Listener
{
    public virtual void Process(Base obj) { }
    public virtual void Process(Derived obj) { }
    public virtual void Process(OtherDerived obj) { }
}

public class Base
{
    public virtual void Dispatch(Listener l) { l.Process(this); }
}

public class Derived
{
    public override void Dispatch(Listener l) { l.Process(this); }
}

public class OtherDerived
{
    public override void Dispatch(Listener l) { l.Process(this); }
}

public class ExampleListener
{
    public override void Process(Derived obj)
    {
        Console.WriteLine("I got a Derived");
    }

    public override void Process(OtherDerived obj)
    {
        Console.WriteLine("I got an OtherDerived");
    }

    public void ProcessCollection(IEnumerable collection)
    {
        foreach (Base obj in collection) obj.Dispatch(this);
    }
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-10-21T21:53:56.767

在 C# 中，我相信 switch 语句只适用于整数和字符串。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-10-21T22:56:51.117

`switch`除了编译器处理语句的方式之外，还有一件事要考虑，那就是`is`运算符的功能。两者之间有很大区别：

```
if (obj is Foo) 
```

和

```
if (obj.GetType() == typeof(Foo)) 
```

尽管有名称，但`is`运算符会告诉您对象是否与给定类型*兼容，而不是告诉您它**是否*属于给定类型。这会导致看起来像这样的不完全明显的错误（尽管这个非常明显）：

```
if (obj is System.Object)
{
   //this will always execute
}
else if (obj is Foo)
{
   //this will never execute
} 
```

这里的许多建议为您指明了使用对象类型的方向。如果您真正想要的是与每种类型关联的逻辑，那很好。但如果是这种情况，使用`is`操作员时请小心行走。

另外：虽然您不能修改这些基本类型，但这并不意味着您不能使用 Owen 的建议。您可以实现扩展方法：

```
public enum MyType { Foo, Bar, Baz };
public static class MyTypeExtension
{
   public static MyType GetMyType(this Foo o)
   {
      return MyType.Foo;
   }
   public static MyType GetMyType(this Bar o)
   {
      return MyType.Bar;
   }
   public static MyType GetMyType(this Baz o)
   {
      return MyType.Baz;
   }
} 
```

然后你*可以*使用一个`switch`语句：

```
switch (myObject.GetType())
{
   case MyType.Foo:
     // etc. 
```

# linux - 什么是不间断进程？

> ID：223644
> 
> 赞同：174
> 
> 时间：2008-10-21T21:52:26.440
> 
> 标签：linux, scheduling, preemption

有时，每当我在 Linux 中编写程序并且由于某种错误而崩溃时，它将成为一个不可中断的进程并永远继续运行，直到我重新启动计算机（即使我注销）。我的问题是：

*   是什么导致进程变得不可中断？
*   我该如何阻止这种情况发生？
*   这可能是一个愚蠢的问题，但是有没有办法在不重新启动计算机的情况下中断它？

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2008-10-21T22:14:55.460

不可中断进程是恰好处于系统调用（内核函数）中且不能被信号中断的进程。

要理解这意味着什么，您需要了解可中断系统调用的概念。经典的例子是`read()`。这是一个可能需要很长时间（几秒钟）的系统调用，因为它可能涉及旋转硬盘驱动器或移动磁头。在这段时间的大部分时间里，进程将处于休眠状态，在硬件上阻塞。

当进程在系统调用中处于休眠状态时，它可以接收到一个 Unix 异步信号（例如 SIGTERM），然后会发生以下情况：

*   系统调用过早退出，并设置为将 -EINTR 返回到用户空间。
*   信号处理程序被执行。
*   如果进程仍在运行，它会从系统调用中获取返回值，并且可以再次进行相同的调用。

从系统调用中提前返回使用户空间代码能够立即改变其行为以响应信号。例如，干净地终止以响应 SIGINT 或 SIGTERM。

另一方面，一些系统调用不允许以这种方式被中断。如果系统调用由于某种原因停止，进程可以无限期地保持在这种不可杀死的状态。

LWN 在 7 月份发表了[一篇很好的文章](http://lwn.net/Articles/288056/)，触及了这个话题。

要回答原始问题：

*   如何防止这种情况发生：找出哪个驱动程序给您带来麻烦，然后停止使用，或者成为内核黑客并修复它。

*   如何在不重新启动的情况下杀死不可中断的进程：以某种方式使系统调用终止。在不敲击电源开关的情况下执行此操作的最有效方法通常是拉电源线。您也可以成为内核黑客，并让驱动程序使用 TASK_KILLABLE，如 LWN 文章中所述。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-10-22T00:16:43.467

当一个进程处于用户模式时，它可以随时被中断（切换到内核模式）。当内核返回到用户模式时，它会检查是否有任何信号未决（包括用于终止进程的信号，例如`SIGTERM`和`SIGKILL`）。这意味着只有在返回用户模式时才能终止进程。

一个进程不能在内核模式下被杀死的原因是它可能会破坏同一台机器中所有其他进程使用的内核结构（同样的方式杀死一个线程可能会破坏同一进程中其他线程使用的数据结构） .

当内核需要做一些可能需要很长时间的事情时（例如，等待另一个进程写入的管道或等待硬件做某事），它会通过将自己标记为睡眠并调用调度程序切换到另一个来休眠进程（如果没有非睡眠进程，它会切换到一个“虚拟”进程，告诉 cpu 放慢一点并处于一个循环中 - 空闲循环）。

如果一个信号被发送到一个休眠的进程，它必须在它返回到用户空间之前被唤醒，从而处理待处理的信号。在这里，我们有两种主要睡眠类型之间的区别：

*   `TASK_INTERRUPTIBLE`，可中断的睡眠。如果一个任务被标记了这个标志，它正在休眠，但可以被信号唤醒。这意味着将任务标记为睡眠的代码正在等待一个可能的信号，并且在它唤醒后将检查它并从系统调用返回。处理完信号后，系统调用可能会自动重新启动（我不会详细说明它是如何工作的）。
*   `TASK_UNINTERRUPTIBLE`，不间断的睡眠。如果一个任务被标记了这个标志，除了它正在等待的任何东西之外，它不会被其他任何东西唤醒，要么是因为它不容易重新启动，要么是因为程序期望系统调用是原子的。这也可用于已知非常短的睡眠。

`TASK_KILLABLE`（在 ddaa 的答案链接到的 LWN 文章中提到）是一个新变体。

这回答了你的第一个问题。至于您的第二个问题：您无法避免不间断的睡眠，它们是正常的事情（例如，每次进程从磁盘读取/写入磁盘时都会发生这种情况）；但是，它们应该只持续几分之一秒。如果它们持续更长时间，通常意味着硬件问题（或设备驱动程序问题，在内核看来是一样的），设备驱动程序正在等待硬件做一些永远不会发生的事情。这也可能意味着您正在使用 NFS 并且 NFS 服务器已关闭（它正在等待服务器恢复；您也可以使用“intr”选项来避免该问题）。

最后，您无法恢复的原因与内核等待返回用户模式以传递信号或终止进程的原因相同：它可能会破坏内核的数据结构（等待可中断睡眠的代码可能会收到一个错误，告诉它返回用户空间，该进程可以被杀死；等待不间断睡眠的代码不会出现任何错误）。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-10-22T21:22:46.687

不可中断进程通常在页面错误后等待 I/O。

考虑一下：

*   线程尝试访问不在核心中的页面（请求加载的可执行文件、已换出的匿名内存页面或请求加载的 mmap() 文件）一样）
*   内核现在（试图）加载它
*   在页面可用之前，该过程无法继续。

进程/任务在这种状态下不能被中断，因为它不能处理任何信号；如果确实如此，则会发生另一个页面错误，并且会回到原来的位置。

当我说“进程”时，我真正的意思是“任务”，在 Linux (2.6) 下大致翻译为“线程”，在 /proc 中可能有也可能没有单独的“线程组”条目

在某些情况下，它可能会等待很长时间。一个典型的例子是可执行文件或 mmap 文件位于服务器出现故障的网络文件系统上。如果 I/O 最终成功，任务将继续。如果最终失败，任务一般会得到一个 SIGBUS 什么的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-28T19:50:09.647

对于您的第三个问题：我认为您可以通过运行 `sudo kill -HUP 1`. 它将重新启动 init 而不会结束正在运行的进程，并且在运行它之后，我的不间断进程就消失了。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-10-21T22:07:19.093

如果您谈论的是“僵尸”进程（在 ps 输出中被指定为“僵尸”），那么这是进程列表中等待某人收集其返回码的无害记录，可以安全地忽略它。

您能否描述一下您的“不间断过程”是什么？它是否在“kill -9”中幸存下来并愉快地前进？如果是这种情况，那么它会卡在某个系统调用上，该系统调用卡在某个驱动程序中，并且您会一直卡在这个过程中，直到重新启动（有时最好尽快重新启动）或卸载相关驱动程序（这不太可能发生） . 您可以尝试使用“strace”来找出您的流程卡在哪里并在将来避免它。

# .net - 开发 ArcMap 扩展 .Net 书籍？

> ID：223649
> 
> 赞同：2
> 
> 时间：2008-10-21T21:54:29.103
> 
> 标签：.net, esri, arcobjects, arcmap

我们部门有 2 位新的 GIS 程序员/分析师（编程和 ArcObjects 新手），我觉得我不够资格或没有时间教他们。所以我正在寻找入门级书籍/教程供他们用作参考。

我能找到的用于开发 ArcMap 扩展的唯一书籍是为 VBA 编写的。

除了您从 Redlands 培训中获得的 ESRI 课程书籍外，是否有人知道在 .Net 中学习针对 ArcObjects 进行编码的良好资源？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T20:39:43.813

试图同时教程序员 ArcObjects 和一般软件开发是一个非常糟糕的主意。我现在正在努力解决完全相同的问题。您冒着找到两个既不擅长编程 ArcObjects 也不擅长 C# 的开发人员的风险。

首先教他们成为优秀的开发人员。通过让他们处理非 ArcObjects 代码来做到这一点（这是否意味着高级 ArcGIS ADF 或完整的非 GIS 应用程序取决于您）。确保他们了解应用程序上下文（Web、桌面、中间等）的基础知识。这将简化向 ArcObjects 的过渡。

一旦他们掌握了软件开发的基础知识（特别是继承和 OOP），就可以将他们介绍给 ArcObjects。VBA 参考是足够的，但很难抽象到 C# 和现代工具。一个聪明的开发人员可以做到，但你的普通开发人员可能会学习很多坏习惯。

最好的办法是咬紧牙关，将它们发送到开发人员研讨会。有时，ESRI 会在您可能更本地的区域办事处提供课程。或者，将它们分别发送到春季和夏季的开发者峰会或用户大会。对于初学者来说，技术研讨会有点先进。也就是说，如果开发人员对 ArcMap 或 ArcObjects 有非常基本的了解，则可以从工作坊中学到很多东西。

此外，***他们需要学习如何使用 ArcMap***。他们学习 ArcObjects 可以做的最重要的有用的事情就是学习 ArcMap。了解它在桌面产品中的工作方式可以经常揭示如何使用 API。一个简单的例子是投影数据。在 ArcMap 中，您必须使用工具来显式投影数据。简单地“设置”投影是行不通的。这直接转化为 API，您必须在其中调用“项目”方法或使用项目 GPTool。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-05T20:53:20.963

我同意每个人在这里表达的一般观点（从编程开始，从小处着手，尤其是通过示例/实践来学习）。

让开发人员学习 ArcObjects 比让 GIS 分析师学习编程要容易得多。你的任务（两者都做）非常困难！

不过，如果您必须从某个地方开始，我会首先对他们进行 C# 或 VB .NET 基础知识培训（通过良好的基于​​ Web 的教程或付费课程），然后再进行针对 ESRI .NET 的培训。正如我在上面的评论中所说，ESRI 培训课程给我留下了深刻的印象。我有软件开发背景，并且能够在几个月内学习 ArcObjects API - 与两个月的实践知识相比，培训课程是 ArcObjects 材料的基础。不过，它可能对学徒有用，而且你可能会在你的雇员中走运。

我还想补充一点，您肯定希望首先强调软件培训，并附带考虑 ArcObjects API。如果此 ArcMap 扩展是您打算出售给人们并作为客户拥有的产品，那么要意识到支持、增强和维护一个漏洞百出的产品是一项昂贵的操作。因此，从长远来看，花在软件培训上的任何一美元都会收回成本。

我什至会告诉你考虑以合同的形式聘请一名软件开发人员担任指导和导师，比如说六个月。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T22:23:24.007

据我回忆，ESRI 开发人员网络上的一些代码现在是 C#，至少那是我为 GIS 提供 C# 代码的主要来源，但没有书，抱歉。

也许这将是一个很好的入门： http: [//www.pragprog.com/titles/sdgis/gis-for-web-developers](http://www.pragprog.com/titles/sdgis/gis-for-web-developers)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T13:37:44.270

如果您的员工真的是编程新手，我会先让他们学习 C#（或其他一些 .Net 语言，但 C# 可能是初学者的最佳选择）的基础知识和良好的编程实践。我想有现有的 stackoverflow 线程会对此提出建议。我认为对面向对象编程的扎实理解和对示例语言语法的了解将有助于 ArcObjects 的学习。

我不太了解有关 ArcObjects 的非 ESRI 书籍。但是我认为他们的资源足以让初学者入门。除了 ESRI 课程书籍，我建议从[http://resources.esri.com/arcgisdesktop/dotnet/index.cfm上的在线资源开始](http://resources.esri.com/arcgisdesktop/dotnet/index.cfm)

其他建议是学习如何阅读对象模型图并使用帮助来探索 ArcObjects 的方法和属性。还鼓励员工利用 ESRI 用户论坛。那里有很多知识渊博的人愿意帮助解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T03:50:47.793

以身作则。

当我第一次开始使用简单但有趣的工具时，我获得了一些乐趣，比如截取当前地图并将其发布到 MediaWiki 站点（只需单击一下）的工具。大部分 API 看起来都像 Deep Magic，而且我不止一次通过浏览 Windows 注册表并做出有根据的猜测（例如如何在“数据视图”上下文菜单上创建自定义菜单项）偶然发现了完全未记录的功能。

比起被迫阅读枯燥乏味的书，我总是通过简单、可完成的任务学到很多东西。

有很多力量，但我在了解和理解其中的大部分方面肯定很慢。

如果不让它变得有趣，我认为开发人员会用这么大的 API 自杀。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-29T11:40:26.127

也不知道专注于 ArcObjects 的非 ESRI 书籍。对于 ArcGIS Server 软件和我来说，我只能推荐 ArcGIS Server Administrator and Developer Guide（即 AGS 安装框中包含的 AFAIK）——有很多代码示例，适用于 C# 和 VB。即使不使用 AGS 进行编程，示例仍然有助于了解 ArcObjects 代码的工作原理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T15:32:11.050

我完全同意詹姆斯。

作为 4 年前在这条船上工作的人，我坚信您应该从 .NET 编程开始，然后转向 ESRI 平台，而不是在尝试学习 OOP 概念时陷入 ESRI 问题。

我还想指出，ESRI 开发人员资源中心为初学者提供了丰富的信息 [ [http://resources.esri.com/gateway/index.cfm]](http://resources.esri.com/gateway/index.cfm])

[如果您从 .NET 和桌面开发开始，您可以在 [ http://resources.esri.com/help/9.3/ArcGISDesktop/dotnet/concepts_start.htm]](http://resources.esri.com/help/9.3/ArcGISDesktop/dotnet/concepts_start.htm])下看到“入门页面”

祝你好运。

# xml - 有没有办法在 xml 中转义 CDATA 结束令牌？

> ID：223652
> 
> 赞同：138
> 
> 时间：2008-10-21T21:54:58.510
> 
> 标签：xml, escaping, cdata

我想知道是否有任何方法可以`]]>`在 xml 文档的 CDATA 部分中转义 CDATA 结束标记 ()。或者，更一般地说，如果在 CDATA 中使用了一些转义序列（但如果它存在，我想它可能只对转义开始或结束标记有意义，无论如何）。

基本上，您是否可以在 CDATA 中嵌入开始或结束标记，并告诉解析器不要解释它，而是将其视为另一个字符序列。

或许，如果您发现自己尝试这样做，您应该重构您的 xml 结构或代码，但即使我在过去 3 年左右每天都在使用 xml，而且我从来没有遇到过这个问题，我想知道这是否可能。只是出于好奇。

编辑：

除了使用 html 编码...

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2008-10-21T22:27:56.540

您必须将数据分解成碎片以隐藏`]]>`.

这是整个事情：

`<![CDATA[]]]]><![CDATA[>]]>`

第一个`<![CDATA[]]]]>`有`]]`. 第二个`<![CDATA[>]]>`有`>`。

* * *

## 回答 #2

> 赞同：148
> 
> 时间：2008-10-21T22:31:04.210

显然，这个问题纯粹是学术性的。幸运的是，它有一个非常明确的答案。

您不能转义 CDATA 结束序列。[XML规范](http://www.w3.org/TR/REC-xml/#sec-cdata-sect)的生产规则 20非常明确：

```
[20]    CData      ::=      (Char* - (Char* ']]>' Char*)) 
```

编辑：此产品规则的字面意思是“CData 部分可能包含您想要的任何内容，但序列']]>'。没有例外。”。

EDIT2：[同一部分](http://www.w3.org/TR/REC-xml/#sec-cdata-sect)还显示：

> 在 CDATA 部分中，只有 CDEnd 字符串被识别为标记，因此左尖括号和 & 符号可能以其文字形式出现；它们不需要（也不能）使用“ `&lt;`”和“ `&amp;`”进行转义。CDATA 部分不能嵌套。

换句话说，不可能使用实体引用、标记或任何其他形式的解释语法。CDATA 部分中唯一解析的文本是`]]>`，它终止了该部分。

因此，不可能`]]>`在 CDATA 部分中转义。

EDIT3：[同一部分](http://www.w3.org/TR/REC-xml/#sec-cdata-sect)还显示：

> 2.7 CDATA 部分
> 
> [定义：CDATA 段可能出现在任何可能出现字符数据的地方；它们用于转义包含字符的文本块，否则这些字符会被识别为标记。CDATA 部分以字符串“<![CDATA[”开头，以字符串“]]>”结尾：]

然后在任何可能出现字符数据的地方都可能存在一个 CDATA 节，包括多个相邻的 CDATA 节，而不是单个 CDATA 节。这样就可以拆分`]]>`令牌并将其两部分放在相邻的 CDATA 部分中。

前任：

```
<![CDATA[Certain tokens like ]]> can be difficult and <invalid>]]> 
```

应该写成

```
<![CDATA[Certain tokens like ]]]]><![CDATA[> can be difficult and <valid>]]> 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-03-30T20:24:37.557

您不会逃避，`]]>`而是通过在 之前插入来逃避`>`之后，就像C/Java/PHP/Perl 字符串中的 a 一样，但只需要在 a 之前和之后 a 。`]]``]]><![CDATA[``>``\``>``]]`

顺便提一句，

S.Lott 的回答与此相同，只是措辞不同。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2016-03-31T11:09:20.940

只需替换`]]>`为`]]]]><![CDATA[>`

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-22T00:00:47.087

S. Lott 的回答是正确的：您不对结束标签进行编码，而是将其拆分为多个 CDATA 部分。

如何在现实世界中解决这个问题：使用 XML 编辑器创建一个将输入内容管理系统的 XML 文档，尝试写一篇关于 CDATA 部分的文章。您在 CDATA 部分中嵌入代码示例的普通技巧将在这里失败。你可以想象我是如何学会这个的。

但在大多数情况下，您不会遇到这种情况，原因如下：如果您想将 XML 文档的文本存储（例如）为 XML 元素的内容，您可能会使用 DOM 方法，例如：

```
XmlElement elm = doc.CreateElement("foo");
elm.InnerText = "<[CDATA[[Is this a problem?]]>"; 
```

并且 DOM 相当合理地转义了 < 和 >，这意味着您没有无意中在文档中嵌入了 CDATA 部分。

哦，这很有趣：

```
XmlDocument doc = new XmlDocument();

XmlElement elm = doc.CreateElement("doc");
doc.AppendChild(elm);

string data = "<![[CDATA[This is an embedded CDATA section]]>";
XmlCDataSection cdata = doc.CreateCDataSection(data);
elm.AppendChild(cdata); 
```

这可能是 .NET DOM 的一种理念，但这不会引发异常。这里抛出异常：

```
Console.Write(doc.OuterXml); 
```

我猜想，幕后发生的事情是 XmlDocument 正在使用 XmlWriter 生成其输出，并且 XmlWriter 在写入时检查格式是否正确。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-08T05:34:38.803

这是另一种`]]>`需要转义的情况。假设我们需要在 XML 文档的 CDATA 块中保存一个完全有效的 HTML 文档，而 HTML 源恰好有它自己的 CDATA 块。例如：

```
<htmlSource><![CDATA[ 
    ... html ...
    <script type="text/javascript">
        /* <![CDATA[ */
        -- some working javascript --
        /* ]]> */
    </script>
    ... html ...
]]></htmlSource> 
```

注释的 CDATA 后缀需要更改为：

```
 /* ]]]]><![CDATA[> *// 
```

因为 XML 解析器不知道如何处理 javascript 注释块

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-21T09:49:09.390

在 PHP 中：`'<![CDATA['.implode(explode(']]>', $string), ']]]]><![CDATA[>').']]>'`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-08-23T14:57:40.467

PHP中一种更清洁的方式：

```
 function safeCData($string)
   {
      return '<![CDATA[' . str_replace(']]>', ']]]]><![CDATA[>', $string) . ']]>';
   } 
```

如果需要，不要忘记使用多字节安全的 str_replace （非 latin1 `$string`）：

```
 function mb_str_replace($search, $replace, $subject, &$count = 0)
   {
      if (!is_array($subject))
      {
         $searches = is_array($search) ? array_values($search) : array ($search);
         $replacements = is_array($replace) ? array_values($replace) : array ($replace);
         $replacements = array_pad($replacements, count($searches), '');
         foreach ($searches as $key => $search)
         {
            $parts = mb_split(preg_quote($search), $subject);
            $count += count($parts) - 1;
            $subject = implode($replacements[$key], $parts);
         }
      }
      else
      {
         foreach ($subject as $key => $value)
         {
            $subject[$key] = mb_str_replace($search, $replace, $value, $count);
         }
      }
      return $subject;
   } 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2017-11-22T23:33:34.640

看这个结构：

```
<![CDATA[
   <![CDATA[
      <div>Hello World</div>
   ]]]]><![CDATA[>
]]> 
```

对于内部 CDATA 标记，您必须使用`]]]]><![CDATA[>`而不是`]]>`. 就那么简单。

# eclipse - Eclipse中的SVN责备

> ID：223657
> 
> 赞同：86
> 
> 时间：2008-10-21T21:56:45.153
> 
> 标签：eclipse, svn

昨天，我发现了 Subversion (SVN) 的[责备](http://theadmin.org/articles/subversion-blame/)功能，我想知道，这个功能可以从 Eclipse 中获得吗？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2008-10-22T02:03:44.467

正如所指出的，您目前必须先安装插件才能启用 Subversion 支持。我推荐[Subversive](http://www.eclipse.org/subversive/index.php)，我自己和在 Stack Overflow 上搜索标签“eclipse”和“subversion”一起将显示几个关于“gotchas”的先前线程，以便在安装连接器时注意（Subversive 分为两部分 -提供 SVN 胶水的核心支持和“连接器”）。

安装完成后，您可以配置存储库，通过直接输入新的存储库地址并将其签出来创建新项目，或者将已附加到 SVN 的现有项目与存储库相关联，让 Subversion 进行查看。

一旦你完成***了***，这就是你如何访问“svn blame”命令，也称为“annotate”或“praise”：

对于资源，右键单击文件资源管理器窗格中的资源名称以弹出上下文菜单（您也可以通过右键单击编辑器本身的任意位置来获取此菜单）。在“**团队**”标题下（这也是您访问所有 SVN 命令的地方，因为 Eclipse 在“团队共享”标题下概括了源代码控制），选择“**显示注释**”。在我的[Mac PowerBook](http://en.wikipedia.org/wiki/PowerBook)上，为此的键盘快捷键是`Ctrl`++ ，我不在我的 Linux 或 Windows XP 平台附近查看我们在它们中的任何一个上的快捷键（Mac OS X 端口倾向于调整键盘快捷键以遵守`Option`“`A`更好”的 Mac 应用程序应该做什么的观点）。

在与 Subversion 存储库交谈一段时间后，编辑器窗口的左侧将显示一系列彩色条。如果您为编辑器启用了行号，这些将覆盖数字。否则，他们将只是酒吧。每种颜色的变化都代表了一个中断，责任从一个用户转移到另一个用户。如果将指针悬停在条上，则会出现一个工具提示，标识负责用户、行来自的修订/提交、日期和签入注释。条形的颜色因提交者和修订版而异。它们将是相同基色的不同深浅，但 Eclipse 会尝试使它们在视觉上不同（尽可能）。当您将鼠标悬停在一个片段上时，它会略微突出显示，

（现在，不要问我如何关闭它*。*到目前为止，我唯一的解决方案是关闭缓冲区并重新打开它！）

# c# - 从非静态类动态调用非静态方法的最简洁方法？

> ID：223666
> 
> 赞同：0
> 
> 时间：2008-10-21T21:59:10.560
> 
> 标签：c#

我正在寻找最干净的方法。我很想使用代表，但不确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T22:21:39.097

你在追求这样的事情吗？

```
class A
{
    public int Value;
    public int Add(int a) { return a + Value; }
    public int Mul(int a) { return a * Value; }
}

class Program
{
    static void Main( string[] args )
    {
        A a = new A();
        a.Value = 10;
        Func<int, int> f;
        f = a.Add;
        Console.WriteLine("Add: {0}", f(5));
        f = a.Mul;
        Console.WriteLine("Mul: {0}", f(5));
    }
} 
```

如果您需要取消绑定调用它的对象，例如 C++ 成员函数指针，我不确定 C# 是否支持。但是，您始终可以使用 lambda 或委托：

```
Func<A,int,int> f = delegate( A o, int i ) { return o.Add( i ); };
Console.WriteLine( "Add: {0}", f( a, 5 ) );
f = ( A o, int i ) => o.Mul( i );
Console.WriteLine( "Mul: {0}", f( a, 5 ) ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T22:14:05.697

您可能需要添加更多详细信息。委托是一个很好的选择选项，如果您只有方法名称而不是指向它的实际指针，则反射也是如此。

# dns - 内部 DNS 配置问题

> ID：223673
> 
> 赞同：1
> 
> 时间：2008-10-21T22:00:13.523
> 
> 标签：dns, bind, dig

好吧，我要预先声明这个问题对于这个媒体来说可能过于复杂（细节量而不是复杂性）。但我认为这是最好的起点。

我正在尝试建立一个概念验证项目，而我的 BIND 配置是我的第一个大障碍。我想在 3 个物理盒子上设置 3 个 DNS 服务器。 **这些盒子都不**需要解析公共地址，这只是内部**的**。我已经阅读了（主要是）优秀的 DNS & BIND 第 5 版书中如何设置内部根。但是我对他们示例的翻译不起作用。所有 IP 都是 RFC 1918 不可路由的。

框 1 对*box1.bogus*域中的地址具有权威性，框 2 对*box2.bogus*域中的地址具有权威性。框 3 将作为域*bogus*的内部根和 TLD 服务器。

当前未解决的问题：

*   我在框 1 和框 2 上有一个提示文件，其中包含根区域的 NS 定义的单个**NS记录。**此外，还有一条**A**记录将 NS 转换为根的 ip。如果我`dig .`从框 1 中得到一个带有 NS 名称的*权限*部分，而不是*答案*和*附加*记录部分。因此，我无法从框 1 中实际解析根服务器的 IP。

*   如果我将我`/etc/resolv.conf`的 from box 1 直接指向根服务器并执行 a，`dig box1.bogus`我将获得 ns.box1.bogus*答案*记录和*附加*部分中的翻译。但是在下一次迭代中（什么时候应该得到 A 记录）我得到`dig: couldn't get address for ns.box1.bogus`

显然我的配置**不**正确。我看不到将它们附加到此帖子的方法，因此，如果人们想逐步完成此操作，我会将它们剪切'n'粘贴到此问题的评论中。否则，我愿意与“DNS 人员”一起“离线”，以找出我缺少“。”的地方。或者有太多！

我个人认为网络可以使用另一个不使用 Movie-U 示例的内部根示例。

好的，如果我们要这样做，那么我们应该使用一个具体的例子吧？我在专用 VLAN 上设置了 3 台机器来进行测试。作为健全性检查，我将所有相关配置配对，在可能的情况下进行压缩，并重新部署 2 个名称服务器。我暂时忽略了 Scratchy。结果与上述相同。这是配置和初始挖掘输出。

* * *

## 虚假

```
Machine Name: Bogus (I just realized I should change this...)  
Role:         Internal Root and TLD Nameserver  
IP:           10.0.0.1  
BIND:         9.5.0-16.a6.fc8 
```

### /etc/named.conf

```
// Controls who can make queries of this DNS server. Currently only the
// local test bed. When there is a standardized IP addr scheme, we can have
// those addr ranges enabled so that even if firewall rules get broken, the
// public internet can't query the internal DNS.
//
acl "authorized" {
        localhost;      // localhost
        10.0.0.0/24;          // Local Test
};

options {
    listen-on port 53 {
        127.0.0.1;
        10.0.0.1;
    };
    listen-on-v6 port 53 { ::1; };
    directory   "/var/named";
    dump-file   "/var/named/data/cache_dump.db";
    statistics-file "/var/named/data/named_stats.txt";
    memstatistics-file "/var/named/data/named_mem_stats.txt";
    pid-file    "/var/run/named/named.pid";
    allow-query     { any; };
    recursion no;
};

logging {
        channel default_debug {
                file "data/named.run";
                severity dynamic;
        };
};

//
// The fake root.
//
zone "." {
    type master;
    file "master/root";
    allow-query { authorized; };
};

//
// The TLD for testing
//
zone "bogus" {
    type master;
    file "master/bogus";
    allow-query { authorized; };
    allow-transfer { authorized; };
}; 
```

### /var/named/master/root

```
$TTL    3600
.                   SOA ns.bogustld. hostmaster.internal.bogus. (
                        2008101601  ; serial
                        1H      ; refresh
                        2H      ; retry
                        14D     ; expire
                        5M )        ; minimum
;
; Fake root zone servers defined.
;
.                   NS  ns.bogustld.
ns.bogustld.        A   10.0.0.1
;
; Testing TLD
;
bogus           NS  ns1.bogus.
ns1.bogus.              A   10.0.0.1 
```

### /var/named/master/bogus

```
$TTL 3600
@           SOA ns1.internal.bogus. hostmaster.internal.bogus. (
                2008102201  ; serial date +seq
                1H      ; refresh
                2H      ; retry
                14D     ; expire
                5M)     ; min TTL
;
            NS  ns1.internal.bogus.
;
; Auth servers
;
ns1.internal.bogus. A   10.0.0.1
;
; Customer delegations each customer 2nd level domain has it's
; own zone file.
;
;Modified to be unique nameservers in the bogus domain
itchy           NS  ns1-itchy.bogus.
ns1-itchy.bogus.    A   10.0.0.2
;
scratchy        NS  ns1-scratchy.bogus.
ns1-scratchy.bogus. A   10.0.0.3 
```

### 来自 dig 的输出。

```
; <<>> DiG 9.5.0-P2 <<>> .
;; global options:  printcmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 57175
;; flags: qr aa rd; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 0
;; WARNING: recursion requested but not available

;; QUESTION SECTION:
;.                              IN      A

;; AUTHORITY SECTION:
.                       300     IN      SOA     ns.bogustld. hostmaster.internal
.bogus. 2008101601 3600 7200 1209600 300

;; Query time: 1 msec
;; SERVER: 10.0.0.1#53(10.0.0.1)
;; WHEN: Tue Oct 21 12:23:59 2008
;; MSG SIZE  rcvd: 88 
```

### dig +trace itchy.bogus 的输出

```
; <<>> DiG 9.5.0-P2 <<>> +trace itchy.bogus
;; global options:  printcmd
.                       3600    IN      NS      ns.bogustld.
;; Received 57 bytes from 10.0.0.1#53(10.0.0.1) in 1 ms

itchy.bogus.            3600    IN      NS      ns1-itchy.bogus.
;; Received 69 bytes from 10.0.0.1#53(ns.bogustld) in 0 ms

itchy.bogus.            3600    IN      A       10.0.0.2
itchy.bogus.            3600    IN      NS      ns1.itchy.bogus.
;; Received 79 bytes from 10.0.0.2#53(ns1-itchy.bogus) in 0 ms 
```

* * *

## 发痒

```
Machine Name: Itchy   
Role:         SLD Nameserver (supposed to be owner of itchy.bogus) 
IP:           10.0.0.2  
BIND:         9.5.0-16.a6.fc8 
```

### /etc/named.conf

```
// Controls who can make queries of this DNS server. Currently only the
// local test bed. When there is a standardized IP addr scheme, we can have
// those addr ranges enabled so that even if firewall rules get broken, the
// public internet can't query the internal DNS.
//
acl "authorized" {
        localhost;      // localhost
        10.0.0.0/24;          // LAN Test
};

options {
    listen-on port 53 {
        127.0.0.1;
        10.0.0.2;
    };
    listen-on-v6 port 53 { ::1; };
    directory   "/var/named";
    dump-file   "/var/named/data/cache_dump.db";
        statistics-file "/var/named/data/named_stats.txt";
        memstatistics-file "/var/named/data/named_mem_stats.txt";
    pid-file    "/var/run/named/named.pid";
    allow-query     { any; };
    recursion no;
};

logging {
        channel default_debug {
                file "data/named.run";
                severity dynamic;
        };
};

zone "." IN {
    type hint;
    file "master/root.hint";
 };

zone "itchy.bogus" {
    type master;
    file "master/itchy.bogus";
    allow-query { authorized; };
    allow-transfer { authorized; };
}; 
```

### /var/named/master/itchy.bogus

```
$TTL    3600
@       SOA     ns1.itchy.bogus. hostmaster.itchy.bogus. (
                2008102202  ; serial
                1H      ; refresh
                2H      ; retry
                14D     ; expire
                5M )        ; minimum
;
        A   10.0.0.2
        NS      ns1.itchy.bogus.
ns1     A   10.0.0.2 
```

### /var/named/master/root.hint

```
.                        3600000      NS    ns.bogustld.
ns.bogustld.         3600000       A    10.0.0.1
; End of File 
```

### /etc/resolv.conf

```
nameserver 10.0.0.2 
```

### 来自 dig 的输出。

```
; <<>> DiG 9.5.0-P2 <<>> .
;; global options:  printcmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 31291
;; flags: qr rd; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 0
;; WARNING: recursion requested but not available

;; QUESTION SECTION:
;.                              IN      A

;; AUTHORITY SECTION:
.                       3600000 IN      NS      ns.bogustld.

;; Query time: 0 msec
;; SERVER: 10.0.0.2#53(10.0.0.2)
;; WHEN: Tue Oct 21 17:09:53 2008
;; MSG SIZE  rcvd: 41 
```

### dig + trace itchy.bogus 的输出

```
; <<>> DiG 9.5.0-P2 <<>> +trace itchy.bogus
;; global options:  printcmd
.                       3600000 IN      NS      ns.bogustld.
;; Received 41 bytes from 10.0.0.2#53(10.0.0.2) in 0 ms

dig: couldn't get address for 'ns.bogustld': failure 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T18:50:14.390

通过使用@，您定义了itchy.bogus。然后，您不能在带有 itchy.bogus 线的区域中进一步重新定义它。

试试这个：

```
@       SOA     ns1.itchy.bogus. hostmaster.itchy.bogus. (
                        2008102201      ; serial
                        1H              ; refresh
                        2H              ; retry
                        14D             ; expire
                        5M )            ; minimum
;
            NS      ns1
            A       10.0.0.2
    ns1     A       10.0.0.2 
```

因为这是itchy.bogus 的区域文件，所以应该做正确的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T19:41:50.307

现在我的代表团问题看起来已经解决了，但我仍然无法进行根查找（我认为这很容易。）

我认为问题源于这样一个事实，即当我`dig`从发痒的机器中获得权威记录而不是答案记录时。我只是不确定我做了什么（或没有）导致这种情况。

如果您使用 Internet 的典型提示文件从机器“挖掘 [no args]”，您将获得根名称服务器的答案块和附加部分中的翻译。

如果我从伪造的机器（根和 TLD 名称服务器）上这样做，我会得到

```
;; QUESTION SECTION:
;.                              IN      NS

;; ANSWER SECTION:
.                       3600    IN      NS      ns.bogustld.

;; ADDITIONAL SECTION:
ns.bogustld.            3600    IN      A       10.0.0.1 
```

如果我从发痒的机器上这样做，我会得到

```
;; QUESTION SECTION:
;.                              IN      NS

;; AUTHORITY SECTION:
.                       3600000 IN      NS      ns.bogustld.

;; Query time: 0 msec 
```

如果你尝试它会变得更有趣`dig +trace .`

### 互联网盒子

```
; <<>> DiG 9.5.0a6 <<>> +trace .
;; global options:  printcmd
.                       3005    IN      NS      C.ROOT-SERVERS.NET.
.                       3005    IN      NS      D.ROOT-SERVERS.NET.
.                       3005    IN      NS      E.ROOT-SERVERS.NET.
.                       3005    IN      NS      F.ROOT-SERVERS.NET.
.                       3005    IN      NS      G.ROOT-SERVERS.NET.
.                       3005    IN      NS      H.ROOT-SERVERS.NET.
.                       3005    IN      NS      I.ROOT-SERVERS.NET.
.                       3005    IN      NS      J.ROOT-SERVERS.NET.
.                       3005    IN      NS      K.ROOT-SERVERS.NET.
.                       3005    IN      NS      L.ROOT-SERVERS.NET.
.                       3005    IN      NS      M.ROOT-SERVERS.NET.
.                       3005    IN      NS      A.ROOT-SERVERS.NET.
.                       3005    IN      NS      B.ROOT-SERVERS.NET.
;; Received 500 bytes from 64.105.172.26#53(64.105.172.26) in 19 ms

.                       86400   IN      SOA     a.root-servers.net. nstld.verisi
gn-grs.com. 2008102201 1800 900 604800 86400
;; Received 92 bytes from 128.63.2.53#53(H.ROOT-SERVERS.NET) in 84 ms 
```

### 我的内部根盒（伪造）

```
; <<>> DiG 9.5.0-P2 <<>> +trace .
;; global options:  printcmd
.                       3600    IN      NS      ns.bogustld.
;; Received 57 bytes from 10.0.0.1#53(10.0.0.1) in 1 ms

.                       3600    IN      NS      ns.bogustld.
;; Received 72 bytes from 10.0.0.1#53(ns.bogustld) in 0 ms 
```

### 发痒

```
; <<>> DiG 9.5.0-P2 <<>> +trace .
;; global options:  printcmd
.                       3600000 IN      NS      ns.bogustld.
;; Received 41 bytes from 10.0.0.2#53(10.0.0.2) in 0 ms

dig: couldn't get address for 'ns.bogustld': failure 
```

为什么我的面向 Internet 的机器找到 SOA，但没有找到我的内部机器？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T22:22:49.670

假设您已经检查了所有明显的事情——例如确保主绑定配置文件是您认为的那样。首先检查您认为命名使用的文件是否正确 - 有时很容易编辑位于错误目录中的文件，并想知道为什么没有注意到更改。

你也用过named-checkconf和named-checkzone

调试绑定已经够难了，但是看不到配置文件几乎是不可能的，所以请将它们添加到原始帖子中。

（我已将此作为对问题的评论添加 - 我已发布作为答案，因为 OP 在这里是新的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T22:24:15.177

3 个服务器中的每一个都需要具有相同的提示文件。它应该有一个“。”的 NS 记录。带有根服务器的名称和该名称的 A 记录。

根服务器应该有“。” 区设立。这 ”。” zone 需要自己拥有带有 ns 记录的“伪造”。然后它应该有 box1.bogus 到 box1 和 box2.bogus 到 box2 的 A 记录。

请注意，您不应将 box1 和 box2 同时用作主机名和二级域的名称。假设域是 zone1.bogus 和 zone2.bogus。

所以 box1 和 box2 应该在虚假区域中，并带有 A 记录。zone1 和 zone2 应该是指向 box1 和 box2 的 NS 记录。

清如泥？:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T16:58:16.283

行。我看到你已经添加了你的配置。优秀的。

我将因此更改根区域：

```
;Should this be ns1.itchy.bogus or ns1.itchy.internal.bogus??
itchy                   NS      ns1-itchy.bogus.
ns1-itchy.bogus.    A   10.0.0.2
;
scratchy        NS      ns1-scratchy.bogus.
ns1-scratchy.bogus. A   10.0.0.3 
```

我认为问题在于您正在委派itchy.bogus，因此您不能将名称放在那里。

我相信，“com”名称服务器使用提示，以便它们可以为委派区域的名称服务器提供 A 记录，但在您的情况下，确保所服务的任何给定区域仅具有子区域的委托和当前区域内的主机。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T21:51:03.590

像高地人一样，只能有一个。

通过使用正常的 Internet 根提示，您或多或少地无法使用自己的内部根，因为没有一个真正的 Internet 根服务器知道“伪造”。

您唯一的选择是镜像根“。” 从您的“.”中划出区域，然后在其中添加“虚假”。为此，您可以定期转储根区域并通过一些处理运行它以将您的自定义区域添加到其中。

一些备用的 DNS 根提供商会这样做，但他们为“客户”提供根提示以供使用，这些提示根本不引用“真正的”根服务器。

...我是否正确理解了这个问题？没有把握。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T23:33:32.943

挖。@10.0.0.1 (bogus) 应该返回 '.' 的权威记录，因为它确实对该区域具有权威性。

挖。@10.0.0.2 (itchy) 不应该返回 '.' 的权威记录，因为它不是。它*可能会*在您第一次在根区域中查询名称时返回权威记录，因为它必须递归并从权威服务器获取权威记录。但是如果你第二次这样做，你会得到一个缓存的结果，并且'aa'标志将被清除。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-24T18:17:58.247

您的名称服务器不会使用提示来给出 dig 的答案。也就是说，它不会给出挖掘作为答案的提示。它将坚持实际为 bogustld 查询 10.0.0.1。我认为您没有将 bogustld 设置为区域，只是伪造的。

您可能应该将 ns.bogustld 更改为 ns.bogus。将 10.0.0.1 命名为 ns.bogus。

或者，您可以在 . 对于bogustld。

如果你挖掘 ns1.bogus。@10.0.0.2，这行得通，对吧（假设上面的配置仍然存在）？

# php - 将 sed 字符串转换为 PHP

> ID：223677
> 
> 赞同：4
> 
> 时间：2008-10-21T22:00:43.867
> 
> 标签：php, regex

我有一个与 sed 一起使用的正则表达式，但现在我还需要让它在 PHP 中工作。我不能使用系统调用，因为它们被禁用了。

```
$猫丑数.txt：
票号 : 303905694, FOO:BAR:BAR: 一些文字
案例 ID：123,456,789：Foobar - 其他一些文本
303867970;[FOOBAR] 这里有一些文字
案例参考：303658850 - 这里有一些随机文本 - host.tld #78854w

```

```
$ 猫丑数.txt | sed "s/[, ]//g;s/.*\([0-9]\{9\}\).*/\1/g"
303905694
123456789
303867970
303658850

```

那么，如何用 PHP 做同样的事情呢？

我找到了一个这样的例子，但我不能将那个正则表达式注入其中。

```
if (preg_match("/.../", $line, $matches)) {
  echo "找到匹配";
  回声 $matches[0];
}

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T22:12:35.823

尝试使用[`preg_replace()`](http://us2.php.net/preg_replace)而不是`preg_match()`. `grep`是`sed`什么`preg_match`是什么`preg_replace`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T22:16:59.933

`preg_replace()`是您正在寻找的功能。您可以传递模式数组并替换参数

```
$pattern = array('/[, ]/','/.*\([0-9]\{9\}\).*/');
$replace = array('','$1');

foreach($lines as $line) {
   $newlines[] = preg_replace($pattern, $replace, $line);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T22:19:53.233

您的具体 SED 示例显然是 2 个正则表达式，1 个替换逗号，一个在技术上抓取 9 位连续数字。

SED 字符串的前半部分最适合该`preg_replace()`函数。

```
//`sed s/regex/replace_value/flags`

preg_replace('/regex/flags', 'replace_value', $input); 
```

您的 SED 字符串的后半部分将是`preg_match_all()`：

```
//`sed ...;s/regex/\1/flags`

$matches_array = array();
preg_match_all('/regex/flags', $input, &$matches_array); 
```

因此，您的特定代码将类似于：

```
<?php
$input = file_get_contents('uglynumbers.txt');

$input = preg_replace('/[, ]/m','', $input);

$matches = array();
//No need for the .* or groupings, just match all occurrences of [0-9]{9}
if( preg_match_all('/[0-9]{9}/m', $input, $matches) )
{
    //...
    var_dump($matches);
} 
```

* * *

看起来`g`是一个 SED 修饰符，意思是匹配所有行。`preg_match_all()`应该已经处理了这个修饰符，但`m`根据[PCRE 修饰符](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)手册似乎是一个合适的替代品。

# git - 哪个提交有这个 blob？

> ID：223678
> 
> 赞同：172
> 
> 时间：2008-10-21T22:00:45.003
> 
> 标签：git, version-control

给定一个 blob 的哈希值，有没有办法获取在他们的树中有这个 blob 的提交列表？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2008-10-21T23:11:22.663

以下两个脚本都将 blob 的 SHA1 作为第一个参数，在它之后，可以选择任何[`git log`](http://git-scm.com/docs/git-log)可以理解的参数。例如`--all`在所有分支中搜索而不是仅在当前分支中`-g`搜索，或者在 reflog 中搜索，或者您喜欢的任何其他内容。

这里是一个 shell 脚本——短小精悍，但速度很慢：

```
#!/bin/sh
obj_name="$1"
shift
git log "$@" --pretty=tformat:'%T %h %s' \
| while read tree commit subject ; do
    if git ls-tree -r $tree | grep -q "$obj_name" ; then
        echo $commit "$subject"
    fi
done 
```

还有一个 Perl 的优化版本，仍然很短但速度更快：

```
#!/usr/bin/perl
use 5.008;
use strict;
use Memoize;

my $obj_name;

sub check_tree {
    my ( $tree ) = @_;
    my @subtree;

    {
        open my $ls_tree, '-|', git => 'ls-tree' => $tree
            or die "Couldn't open pipe to git-ls-tree: $!\n";

        while ( <$ls_tree> ) {
            /\A[0-7]{6} (\S+) (\S+)/
                or die "unexpected git-ls-tree output";
            return 1 if $2 eq $obj_name;
            push @subtree, $2 if $1 eq 'tree';
        }
    }

    check_tree( $_ ) && return 1 for @subtree;

    return;
}

memoize 'check_tree';

die "usage: git-find-blob <blob> [<git-log arguments ...>]\n"
    if not @ARGV;

my $obj_short = shift @ARGV;
$obj_name = do {
    local $ENV{'OBJ_NAME'} = $obj_short;
     `git rev-parse --verify \$OBJ_NAME`;
} or die "Couldn't parse $obj_short: $!\n";
chomp $obj_name;

open my $log, '-|', git => log => @ARGV, '--pretty=format:%T %h %s'
    or die "Couldn't open pipe to git-log: $!\n";

while ( <$log> ) {
    chomp;
    my ( $tree, $commit, $subject ) = split " ", $_, 3;
    print "$commit $subject\n" if check_tree( $tree );
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2015-09-16T14:32:13.647

不幸的是，脚本对我来说有点慢，所以我不得不优化一下。幸运的是，我不仅有哈希，还有文件的路径。

```
git log --all --pretty=format:%H -- <path> | xargs -I% sh -c "git ls-tree % -- <path> | grep -q <hash> && echo %" 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2018-02-02T20:15:45.613

除此之外[`git describe`，我在之前的回答中提到过](https://stackoverflow.com/a/48027778/6309)`git log`，现在`git diff`还可以从“”选项中受益，`--find-object=<object-id>`以将发现限制在涉及命名对象的更改中。
那是在 Git 2.16.x/2.17（2018 年第一季度）中

请参阅[Stefan Beller (](https://github.com/stefanbeller) [)的](https://github.com/stefanbeller)[提交 4d8c51a](https://github.com/git/git/commit/4d8c51aa19be94bddb7cac6b11bccb4d23dfd4f8)、[提交 5e50525](https://github.com/git/git/commit/5e505257f2651647c072f9c61fdc5dd52bbce8b2)、[提交 15af58c](https://github.com/git/git/commit/15af58c1adba431c216e2a45fa0d22944560ba02)、[提交 cf63051](https://github.com/git/git/commit/cf63051adad03e827e0313a57db0a79ad39a04a0)、[提交 c1ddc46](https://github.com/git/git/commit/c1ddc4610c553b06591aac74b610b56448cbb976)、[提交 929ed70](https://github.com/git/git/commit/929ed70a7263fc3be909b363993672b649153706)（2018 年 1 月 4 日） 。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 c0d75f0](https://github.com/git/git/commit/c0d75f0e2e2cbf432358bfd00be593fd28e257a3))^(中，2018 年 1 月 23 日）)[`stefanbeller`](https://github.com/stefanbeller)
^([`gitster`](https://github.com/gitster))

> ## `diffcore`：添加一个镐选项来查找特定的 blob

> 有时用户会得到一个对象的哈希值，他们想进一步识别它（例如：使用 verify-pack 查找最大的 blob，但这些是什么？或者这个 Stack Overflow 问题“[哪个提交有这个 blob？](https://stackoverflow.com/q/223678/6309) ”）
> 
> 有人可能会想扩展`git-describe`为也可以使用 blob，这样就可以`git describe <blob-id>`将描述描述为 ' `<commit-ish>:<path>`'。
> 这是[在这里实现的](https://public-inbox.org/git/20171028004419.10139-1-sbeller@google.com/)；从响应的绝对数量 (>110) 可以看出，事实证明这很难做到。
> 正确的难点在于选择正确的“commit-ish”，因为这可能是（重新）引入 blob 或删除 blob 的 blob 的提交；blob 可能存在于不同的分支中。
> 
> Junio 暗示了解决这个问题的不同方法，这个补丁实现了。
> 教`diff`机器另一个标志，用于将信息限制为显示的内容。
> 例如：
> 
> ```
> $ ./git log --oneline --find-object=v2.0.0:Makefile
>   b2feb64 Revert the whole "ask curl-config" topic for now
>   47fbfde i18n: only extract comments marked with "TRANSLATORS:" 
> ```
> 
> 我们观察到`Makefile`随附的`2.0`出现在 `v1.9.2-471-g47fbfded53`和 中`v2.0.0-rc1-5-gb2feb6430b`。
> 这些提交都发生在 v2.0.0 之前的原因是使用这种新机制找不到的邪恶合并。

* * *

正如[marcono1234](https://stackoverflow.com/users/4288506/marcono1234)[的评论](https://stackoverflow.com/questions/223678/which-commit-has-this-blob/48590251#comment122173464_48590251)中所述，您可以将其与[git log --all](https://git-scm.com/docs/git-log#Documentation/git-log.txt---all)选项结合使用：

> 当您不知道哪个分支包含该对象时，这可能很有用。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-12-29T19:54:30.920

> 给定一个 blob 的哈希值，有没有办法获取在他们的树中有这个 blob 的提交列表？

使用 Git 2.16（2018 年第一季度）[`git describe`](https://git-scm.com/docs/git-describe)将是一个很好的解决方案，因为它被教导要更深入地挖掘树以找到`<commit-ish>:<path>`引用给定 blob 对象的 a。

请参阅[提交 644eb60](https://github.com/git/git/commit/644eb60bd01a15f665b63774fd80e3b6316073a1)、[提交 4dbc59a](https://github.com/git/git/commit/4dbc59a4cce418ff8428a9d2ecd67c34ca50db56)、[提交 cdaed0c](https://github.com/git/git/commit/cdaed0cf023a47cae327671fae11c10d88100ee7)、[提交 c87b653](https://github.com/git/git/commit/c87b653c46c4455561642b14efc8920a0b3e44b9)、[提交 ce5b6f9](https://github.com/git/git/commit/ce5b6f9be84690ba38eba10c42b3f7c7e2511abb)（2017 年 11 月 16 日）和[提交 91904f5](https://github.com/git/git/commit/91904f5645196ceef92c6fca21cc9454928613f0)、[提交 2deda00](https://github.com/git/git/commit/2deda00707f8278382d64c696d75f33cc16e1233)（2017 年 11 月 2 日），作者是[Stefan Beller ( `stefanbeller`)](https://github.com/stefanbeller)。
^(（由[Junio C Hamano 合并`gitster`——](https://github.com/gitster)在[提交 556de1a](https://github.com/git/git/commit/556de1a8e38ff03d31fd35751582447001f39d0c)中，2017 年 12 月 28 日）)

> ## [`builtin/describe.c`](https://github.com/git/git/blob/644eb60bd01a15f665b63774fd80e3b6316073a1/builtin/describe.c): 描述一个 blob
> 
> 有时用户会得到一个对象的哈希值，他们想进一步识别它（例如：`verify-pack`用于查找最大的 blob，但这些是什么？或者这个非常SO的问题“[哪个提交有这个 blob？](https://stackoverflow.com/q/223678/6309) ”）
> 
> 在描述提交时，我们尝试将它们锚定到标签或引用，因为它们在概念上比提交更高。如果没有完全匹配的 ref 或标签，我们就不走运了。
> 因此，我们采用启发式方法来为提交命名。这些名称是模棱两可的，可能有不同的标签或引用要锚定到，并且 DAG 中可能有不同的路径可以准确地到达提交。
> 
> 在描述 blob 时，我们也想从更高层描述 blob，这是一个元组，`(commit, deep/path)`因为所涉及的树对象相当无趣。
> 同一个 blob 可以被多个提交引用，那么我们如何决定使用哪个提交呢？
> 
> 这个补丁实现了一个相当幼稚的方法：**由于没有从 blob 指向 blob 发生的提交的反向指针，我们将从任何可用的提示开始，按提交的顺序列出 blob，一旦我们找到blob，我们将采用列出 blob 的第一个提交**。
> 
> 例如：
> 
> ```
> git describe --tags v0.99:Makefile
> conversion-901-g7672db20c2:Makefile 
> ```
> 
> 告诉我们`Makefile`原样是在[提交 7672db2](https://github.com/git/git/commit/7672db20c2060f20b01788e4a4289ebc5f818605#diff-b67911656ef5d18c4ae36cb6741b7965)`v0.99`中引入的。
> 
> 步行以相反的顺序执行，以显示一个 blob 的引入，而不是它的最后一次出现。

这意味着[`git describe`手册页](https://github.com/git/git/blob/644eb60bd01a15f665b63774fd80e3b6316073a1/Documentation/git-describe.txt)增加了此命令的用途：

> `git describe`当使用 as 时，实际上将根据可用的 ref 为对象提供一个人类可读的名称，而不是简单地使用可从它访问的最新标记来描述提交`git describe <blob>`。
> 
> 如果给定对象引用了一个 blob，它将被描述为`<commit-ish>:<path>`，以便可以在`<path>`中找到该 blob `<commit-ish>`，它本身描述了该 blob 在从 HEAD 的反向修订遍历中出现的第一次提交。

但：

> ## 错误
> 
> **无法描述树对象以及不指向提交的标记对象**。
> 在描述 blob 时，会忽略指向 blob 的轻量级标记，但仍将 blob 描述为`<committ-ish>:<path>`尽管轻量级标记是有利的。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2021-03-16T19:55:48.870

对于人类来说，最有用的命令可能是

```
git whatchanged --all --find-object=<blob hash> 
```

这会跨`--all`分支显示添加或删除具有该哈希的文件的任何提交，以及路径是什么。

```
git$ git whatchanged --all --find-object=b3bb59f06644
commit 8ef93124645f89c45c9ec3edd3b268b38154061a 
⋮
diff: do not show submodule with untracked files as "-dirty"
⋮
:100644 100644 b3bb59f06644 8f6227c993a5 M      submodule.c

commit 7091499bc0a9bccd81a1c864de7b5f87a366480e 
⋮
Revert "submodules: fix of regression on fetching of non-init subsub-repo"
⋮
:100644 100644 eef5204e641e b3bb59f06644 M  submodule.c 
```

请注意，`git whatchanged`它的输出行中已经包含了之前和之后的 blob 哈希。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-21T23:01:18.750

我认为这将是一个普遍有用的东西，所以我写了一个小 perl 脚本来做到这一点：

```
#!/usr/bin/perl -w

use strict;

my @commits;
my %trees;
my $blob;

sub blob_in_tree {
    my $tree = $_[0];
    if (defined $trees{$tree}) {
        return $trees{$tree};
    }
    my $r = 0;
    open(my $f, "git cat-file -p $tree|") or die $!;
    while (<$f>) {
        if (/^\d+ blob (\w+)/ && $1 eq $blob) {
            $r = 1;
        } elsif (/^\d+ tree (\w+)/) {
            $r = blob_in_tree($1);
        }
        last if $r;
    }
    close($f);
    $trees{$tree} = $r;
    return $r;
}

sub handle_commit {
    my $commit = $_[0];
    open(my $f, "git cat-file commit $commit|") or die $!;
    my $tree = <$f>;
    die unless $tree =~ /^tree (\w+)$/;
    if (blob_in_tree($1)) {
        print "$commit\n";
    }
    while (1) {
        my $parent = <$f>;
        last unless $parent =~ /^parent (\w+)$/;
        push @commits, $1;
    }
    close($f);
}

if (!@ARGV) {
    print STDERR "Usage: git-find-blob blob [head ...]\n";
    exit 1;
}

$blob = $ARGV[0];
if (@ARGV > 1) {
    foreach (@ARGV) {
        handle_commit($_);
    }
} else {
    handle_commit("HEAD");
}
while (@commits) {
    handle_commit(pop @commits);
} 
```

我今晚回家时会把它放在github上。

更新：看起来有人[已经这样做了](http://github.com/jwiegley/git-scripts/tree/master/git-find-blob)。那个使用相同的一般思想，但细节不同，实现*要*短得多。我不知道哪个会更快，但性能可能不是这里的问题！

更新 2：就其价值而言，我的实现速度要快几个数量级，尤其是对于大型存储库。那`git ls-tree -r`真的很痛。

更新 3：我应该注意，我上面的性能评论适用于我在第一个更新中链接的实现。[亚里士多德的实现](https://stackoverflow.com/questions/223678/git-which-commit-has-this-blob#223890)与我的表现相当。对于那些好奇的人，评论中的更多细节。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-03-17T08:16:45.010

虽然最初的问题没有要求，但我认为检查暂存区域以查看是否引用了 blob 很有用。我修改了原始的 bash 脚本来执行此操作，并在我的存储库中找到了引用损坏 blob 的内容：

```
#!/bin/sh
obj_name="$1"
shift
git ls-files --stage \
| if grep -q "$obj_name"; then
    echo Found in staging area. Run git ls-files --stage to see.
fi

git log "$@" --pretty=format:'%T %h %s' \
| while read tree commit subject ; do
    if git ls-tree -r $tree | grep -q "$obj_name" ; then
        echo $commit "$subject"
    fi
done 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-10-04T23:28:34.967

所以...我需要在一个大小超过 8GB 的​​ repo 中找到所有超过给定限制的文件，并且有超过 108,000 个修订。我改编了 Aristotle 的 perl 脚本以及我编写的 ruby​​ 脚本来实现这个完整的解决方案。

首先，`git gc`- 这样做是为了确保所有对象都在包文件中 - 我们不会扫描不在包文件中的对象。

Next 运行此脚本以定位 CUTOFF_SIZE 字节上的所有 blob。将输出捕获到“large-blob.log”之类的文件中

```
#!/usr/bin/env ruby

require 'log4r'

# The output of git verify-pack -v is:
# SHA1 type size size-in-packfile offset-in-packfile depth base-SHA1
#
#
GIT_PACKS_RELATIVE_PATH=File.join('.git', 'objects', 'pack', '*.pack')

# 10MB cutoff
CUTOFF_SIZE=1024*1024*10
#CUTOFF_SIZE=1024

begin

  include Log4r
  log = Logger.new 'git-find-large-objects'
  log.level = INFO
  log.outputters = Outputter.stdout

  git_dir = %x[ git rev-parse --show-toplevel ].chomp

  if git_dir.empty?
    log.fatal "ERROR: must be run in a git repository"
    exit 1
  end

  log.debug "Git Dir: '#{git_dir}'"

  pack_files = Dir[File.join(git_dir, GIT_PACKS_RELATIVE_PATH)]
  log.debug "Git Packs: #{pack_files.to_s}"

  # For details on this IO, see http://stackoverflow.com/questions/1154846/continuously-read-from-stdout-of-external-process-in-ruby
  #
  # Short version is, git verify-pack flushes buffers only on line endings, so
  # this works, if it didn't, then we could get partial lines and be sad.

  types = {
    :blob => 1,
    :tree => 1,
    :commit => 1,
  }

  total_count = 0
  counted_objects = 0
  large_objects = []

  IO.popen("git verify-pack -v -- #{pack_files.join(" ")}") do |pipe|
    pipe.each do |line|
      # The output of git verify-pack -v is:
      # SHA1 type size size-in-packfile offset-in-packfile depth base-SHA1
      data = line.chomp.split(' ')
      # types are blob, tree, or commit
      # we ignore other lines by looking for that
      next unless types[data[1].to_sym] == 1
      log.info "INPUT_THREAD: Processing object #{data[0]} type #{data[1]} size #{data[2]}"
      hash = {
        :sha1 => data[0],
        :type => data[1],
        :size => data[2].to_i,
      }
      total_count += hash[:size]
      counted_objects += 1
      if hash[:size] > CUTOFF_SIZE
        large_objects.push hash
      end
    end
  end

  log.info "Input complete"

  log.info "Counted #{counted_objects} totalling #{total_count} bytes."

  log.info "Sorting"

  large_objects.sort! { |a,b| b[:size] <=> a[:size] }

  log.info "Sorting complete"

  large_objects.each do |obj|
    log.info "#{obj[:sha1]} #{obj[:type]} #{obj[:size]}"
  end

  exit 0
end 
```

接下来，编辑文件以删除您不等待的所有 blob 和顶部的 INPUT_THREAD 位。一旦您只有要查找的 sha1 行，请运行以下脚本，如下所示：

```
cat edited-large-files.log | cut -d' ' -f4 | xargs git-find-blob | tee large-file-paths.log 
```

脚本在`git-find-blob`下面。

```
#!/usr/bin/perl

# taken from: http://stackoverflow.com/questions/223678/which-commit-has-this-blob
# and modified by Carl Myers <cmyers@cmyers.org> to scan multiple blobs at once
# Also, modified to keep the discovered filenames
# vi: ft=perl

use 5.008;
use strict;
use Memoize;
use Data::Dumper;

my $BLOBS = {};

MAIN: {

    memoize 'check_tree';

    die "usage: git-find-blob <blob1> <blob2> ... -- [<git-log arguments ...>]\n"
        if not @ARGV;

    while ( @ARGV && $ARGV[0] ne '--' ) {
        my $arg = $ARGV[0];
        #print "Processing argument $arg\n";
        open my $rev_parse, '-|', git => 'rev-parse' => '--verify', $arg or die "Couldn't open pipe to git-rev-parse: $!\n";
        my $obj_name = <$rev_parse>;
        close $rev_parse or die "Couldn't expand passed blob.\n";
        chomp $obj_name;
        #$obj_name eq $ARGV[0] or print "($ARGV[0] expands to $obj_name)\n";
        print "($arg expands to $obj_name)\n";
        $BLOBS->{$obj_name} = $arg;
        shift @ARGV;
    }
    shift @ARGV; # drop the -- if present

    #print "BLOBS: " . Dumper($BLOBS) . "\n";

    foreach my $blob ( keys %{$BLOBS} ) {
        #print "Printing results for blob $blob:\n";

        open my $log, '-|', git => log => @ARGV, '--pretty=format:%T %h %s'
            or die "Couldn't open pipe to git-log: $!\n";

        while ( <$log> ) {
            chomp;
            my ( $tree, $commit, $subject ) = split " ", $_, 3;
            #print "Checking tree $tree\n";
            my $results = check_tree( $tree );

            #print "RESULTS: " . Dumper($results);
            if (%{$results}) {
                print "$commit $subject\n";
                foreach my $blob ( keys %{$results} ) {
                    print "\t" . (join ", ", @{$results->{$blob}}) . "\n";
                }
            }
        }
    }

}

sub check_tree {
    my ( $tree ) = @_;
    #print "Calculating hits for tree $tree\n";

    my @subtree;

    # results = { BLOB => [ FILENAME1 ] }
    my $results = {};
    {
        open my $ls_tree, '-|', git => 'ls-tree' => $tree
            or die "Couldn't open pipe to git-ls-tree: $!\n";

        # example git ls-tree output:
        # 100644 blob 15d408e386400ee58e8695417fbe0f858f3ed424    filaname.txt
        while ( <$ls_tree> ) {
            /\A[0-7]{6} (\S+) (\S+)\s+(.*)/
                or die "unexpected git-ls-tree output";
            #print "Scanning line '$_' tree $2 file $3\n";
            foreach my $blob ( keys %{$BLOBS} ) {
                if ( $2 eq $blob ) {
                    print "Found $blob in $tree:$3\n";
                    push @{$results->{$blob}}, $3;
                }
            }
            push @subtree, [$2, $3] if $1 eq 'tree';
        }
    }

    foreach my $st ( @subtree ) {
        # $st->[0] is tree, $st->[1] is dirname
        my $st_result = check_tree( $st->[0] );
        foreach my $blob ( keys %{$st_result} ) {
            foreach my $filename ( @{$st_result->{$blob}} ) {
                my $path = $st->[1] . '/' . $filename;
                #print "Generating subdir path $path\n";
                push @{$results->{$blob}}, $path;
            }
        }
    }

    #print "Returning results for tree $tree: " . Dumper($results) . "\n\n";
    return $results;
} 
```

输出将如下所示：

```
<hash prefix> <oneline log message>
    path/to/file.txt
    path/to/file2.txt
    ...
<hash prefix2> <oneline log msg...> 
```

等等。将列出在其树中包含大文件的每个提交。如果您`grep`删除了以选项卡开头的行，`uniq`那么您将获得所有路径的列表，您可以 filter-branch 删除，或者您可以做一些更复杂的事情。

让我重申一下：这个过程在一个 10GB 的 repo 上运行成功，有 108,000 次提交。但是，在大量 blob 上运行时，它花费的时间比我预期的要长得多，超过 10 个小时，我将不得不看看记忆位是否有效......

# c# - 时间：2019-04-10 标签：c#locking

> ID：223679
> 
> 赞同：4
> 
> 时间：2008-10-21T22:01:05.627
> 
> 标签：c#, multithreading, locking

我试图防止多线程服务器中的数据竞争。我的问题如下：有一个`List<RServer>`，类型`RServer`是一个有几个字段的类。现在，服务器有多个线程同时运行，它们可以修改`List`（添加更多项目）和单个`RServer`实例（更改字段）。

因此，我的策略是`readonly object RServerLock = new object( )`在每个`RServer`实例中创建 a 并附加 a`readonly object RServerListLock = new object( )`并将所有修改（`List`或`RServer`实例）的代码包含在 a 中`lock`。这安全吗？如果一个线程试图锁定`RServerLock` *而*另一个线程正在锁定它会发生什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-21T22:09:41.850

如果你有一个竞争锁，第二个线程必须等到第一个线程释放锁。

您的计划听起来*几乎没问题 - 但您在**读取*数据时也需要锁定，以确保您获得最新的值和一致的值。否则，您可能会在一个线程中编写一些值的一半，并在不同的线程中同时看到一些新值（但可能不是全部）和旧值。

如果您可以尽可能避免这样做，您的生活会更轻松 :) 不可变类型使线程更简单。

不要忘记，如果您的代码同时需要两个锁（例如，添加一个 RServer 并以原子方式修改另一个），您*必须*确保始终以相同的顺序获取锁 - 如果一个线程试图获取在持有锁 A 时锁定 B，并且另一个线程在持有锁 B 时尝试获取锁 A，您将最终陷入死锁。

有关详细信息，请参阅我的[线程教程](http://pobox.com/~skeet/csharp/threads)或[Joe Albahari 的](http://www.albahari.com/threading/default.aspx)。此外，如果您对并发感兴趣，Joe Duffy 有一本非常[好的书](https://rads.stackoverflow.com/amzn/click/com/032143482X)即将出版。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T05:21:36.270

看起来你有一个 ReaderWriterLock 的主要候选人。最好使用的类（如果您的运行时支持它，我认为是 3.0+）是 ReaderWriterLockSlim，因为原始的 ReaderWriterLock 存在性能问题。

一位 MSDN 杂志的作者也遇到了 RWLS 类的问题，我不会在这里详细介绍，但您可以在[这里查看](http://msdn.microsoft.com/en-us/magazine/cc163532.aspx "MSDN 文章")。

我知道下面的代码会激起 IDisposable 纯粹主义者的愤怒，但有时它确实是很好的语法糖。无论如何，您可能会发现以下内容很有用：

```
 /// <summary>
    /// Opens the specified reader writer lock in read mode,
    /// specifying whether or not it may be upgraded.
    /// </summary>
    /// <param name="slim"></param>
    /// <param name="upgradeable"></param>
    /// <returns></returns>
    public static IDisposable Read(this ReaderWriterLockSlim slim, bool upgradeable)
    {
        return new ReaderWriterLockSlimController(slim, true, upgradeable);
    } // IDisposable Read

    /// <summary>
    /// Opens the specified reader writer lock in read mode,
    /// and does not allow upgrading.
    /// </summary>
    /// <param name="slim"></param>
    /// <returns></returns>
    public static IDisposable Read(this ReaderWriterLockSlim slim)
    {
        return new ReaderWriterLockSlimController(slim, true, false);
    } // IDisposable Read

    /// <summary>
    /// Opens the specified reader writer lock in write mode.
    /// </summary>
    /// <param name="slim"></param>
    /// <returns></returns>
    public static IDisposable Write(this ReaderWriterLockSlim slim)
    {
        return new ReaderWriterLockSlimController(slim, false, false);
    } // IDisposable Write

    private class ReaderWriterLockSlimController : IDisposable
    {
        #region Fields

        private bool _closed = false;
        private bool _read = false;
        private ReaderWriterLockSlim _slim;
        private bool _upgrade = false;

        #endregion Fields

        #region Constructors

        public ReaderWriterLockSlimController(ReaderWriterLockSlim slim, bool read, bool upgrade)
        {
            _slim = slim;
            _read = read;
            _upgrade = upgrade;

            if (_read)
            {
                if (upgrade)
                {
                    _slim.EnterUpgradeableReadLock();
                }
                else
                {
                    _slim.EnterReadLock();
                }
            }
            else
            {
                _slim.EnterWriteLock();
            }
        } //  ReaderWriterLockSlimController

        ~ReaderWriterLockSlimController()
        {
            Dispose();
        } //  ~ReaderWriterLockSlimController

        #endregion Constructors

        #region Methods

        public void Dispose()
        {
            if (_closed)
                return;
            _closed = true;

            if (_read)
            {
                if (_upgrade)
                {
                    _slim.ExitUpgradeableReadLock();
                }
                else
                {
                    _slim.ExitReadLock();
                }
            }
            else
            {
                _slim.ExitWriteLock();
            }

            GC.SuppressFinalize(this);
        } // void Dispose

        #endregion Methods
    } // Class ReaderWriterLockSlimController 
```

将其放入扩展方法类（公共静态类 [Name]）中并按如下方式使用它：

```
using(myReaderWriterLockSlim.Read())
{
  // Do read operations.
} 
```

或者

```
using(myReaderWriterLockSlim.Read(true))
{
  // Read a flag.
  if(flag)
  {
    using(myReaderWriterLockSlim.Write()) // Because we said Read(true).
    {
      // Do read/write operations.
    }
  }
} 
```

或者

```
using(myReaderWriterLockSlim.Write()) // This means you can also safely read.
{
  // Do read/write operations.
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T22:09:32.380

如果一个线程试图锁定一个已经被锁定的对象，它将阻塞直到锁定被释放。当两个线程试图同时锁定它时不会出现并发问题，因为锁定是原子操作，因此其中一个线程将始终成为锁定的受害者并最终阻塞。

如果您需要对 RServer 实例进行完全锁定，那么您的策略听起来很合理。如果您可以专门锁定特定的 RServer 实例字段，那可能会更有效。然而，它会增加锁定操作的数量并且会更加复杂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T22:08:50.403

那是安全的。如果一个线程获得了锁，其他线程将不得不等待直到锁被释放。

但是，尽管不太可能，但您可能会遇到性能问题，因为锁可能过于全局。这实际上取决于您的状态是什么以及这些线程如何改变它，所以我无法帮助您。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T22:08:51.167

重申一下 - 每个 RServer 实例都有一个名为 RServerLock 的变量，该变量将使用锁定块锁定。

线程 1 (T1) 锁定 RServer 1 (R1)。线程 2 (T2) 尝试修改 R1，这会导致进入 R1 锁定块。在这种情况下，T2 将等到 T1 完成。

需要真正小心的一件事是最终有多少 RServer 实例。如果您最终得到过多的实例，那么您将携带额外的 20 字节数据只是为了锁定。此时，您可能需要考虑锁定条带化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T22:12:00.113

如果我正确理解您的问题，听起来您正在尝试创建一个已经存在完美轮子的轮子。

查看 MSDN 中的 system.threading 命名空间。它有许多专门为处理此类情况而设计的锁定机制。

[http://msdn.microsoft.com/en-us/library/system.threading.aspx](http://msdn.microsoft.com/en-us/library/system.threading.aspx)

# mysql - 已安装 C MySQL gem 时使用基于 Ruby 的 MySQL 适配器？

> ID：223692
> 
> 赞同：1
> 
> 时间：2008-10-21T22:06:12.623
> 
> 标签：mysql, ruby-on-rails, ruby

好吧，这令人难以置信。在被 Rails 唠叨说我需要安装基于 C 的 MySQL 适配器之后，我这样做了……然后发现它在版本 6 下无法与 MySQL 一起使用。现在“gem uninstall mysql”导致“unknown gem mysql” '。

我只花了半个小时试图首先安装这个东西（通过处理所有“我的配置文件到底在哪里，无论如何？”类型的选项）。

无论如何，我现在在任何地方都找不到关于如何使用 ORIGINAL MySQL 适配器的提示，因为我发现它要么是那个，要么是升级到 MySQL 6，因为我使用的是 XAMPP 包，所以我不想这样做已经很好用了

（这是在我的本地盒子上进行测试，这不是开发或生产服务器问题。我稍后会处理。）

那么如何确保 Rails 使用内置版本（使用命令行选项？）或删除 MySQL gem？

（可选的第三个选项：接受并升级我的本地 MySQL 副本。）

编辑：原来我对我首先需要的 MySQL 版本是错误的，我修复并升级了一堆东西。

但是，我对原始问题的回答仍然有效：删除 gem。如果 gem 本身无法删除它，只需删除它的所有痕迹，RoR 将默认为原始适配器。这可能在较新版本的 Rails 中不起作用，（我认为）需要新的适配器。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2008-10-22T17:16:00.040

好吧，我有点强迫自己的答案。

gem 无法卸载 MySQL gem 的事实完全奇怪，这让#rubyonrails IRC 频道的人感到困惑。

我的解决方案？手动删除我的文件系统上 gem 的所有痕迹。现在一切都恢复正常了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-04T16:57:56.720

提示：您是否尝试过使用 JRuby 和与之配套的 MySQL-JDBC 适配器？毕竟这可能是一个更好的选择。

# c# - 优化多维泛型数组的二进制序列化

> ID：223700
> 
> 赞同：7
> 
> 时间：2008-10-21T22:08:29.140
> 
> 标签：c#, .net, serialization, binary

我有一个需要二进制序列化的类。该类包含一个字段，如下所示：

```
private T[,] m_data; 
```

这些多维数组可以相当大（数十万个元素）并且可以是任何原始类型。当我在一个对象上尝试标准的 .net 序列化时，写入磁盘的文件很大，我认为 .net 存储了大量有关元素类型的重复数据，并且可能没有达到可以做到的效率。

我四处寻找自定义序列化程序，但没有看到任何处理多维泛型数组的方法。在序列化成功后，我还在内存流的字节数组上尝试了内置 .net 压缩，但没有我希望的那么快/压缩。

我的问题是，我应该尝试编写一个自定义序列化程序来优化序列化这个数组以获得适当的类型（这似乎有点令人生畏），还是应该使用标准的 .net 序列化并添加压缩？

任何关于最佳方法的建议将不胜感激，或者链接到显示如何处理多维通用数组的序列化的资源 - 正如我发现[的现有示例](http://www.codeproject.com/KB/dotnet/FastSerializer.aspx)所提到的那样，我发现不支持这种结构。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T00:00:58.100

这就是我想出的。下面的代码创建了一个 int[1000][10000] 并使用 BinaryFormatter 将其写入 2 个文件 - 一个已压缩，一个未压缩。

压缩文件为 1.19 MB（1,255,339 字节），解压缩后为 38.2 MB（40,150,034 字节）

```
 int width = 1000;
        int height = 10000;
        List<int[]> list = new List<int[]>();
        for (int i = 0; i < height; i++)
        {
            list.Add(Enumerable.Range(0, width).ToArray());
        }
        int[][] bazillionInts = list.ToArray();
        using (FileStream fsZ = new FileStream("c:\\temp_zipped.txt", FileMode.Create))
        using (FileStream fs = new FileStream("c:\\temp_notZipped.txt", FileMode.Create))
        using (GZipStream gz = new GZipStream(fsZ, CompressionMode.Compress))
        {
            BinaryFormatter f = new BinaryFormatter();
            f.Serialize(gz, bazillionInts);
            f.Serialize(fs, bazillionInts);
        } 
```

我想不出更好/更简单的方法来做到这一点。带拉链的版本非常紧。

我会选择 BinaryFormatter + GZipStream。做一些定制的东西一点也不好玩。

* * *

[MG 编辑] 我希望您不会被编辑冒犯，但统一重复的 Range(0,width) 会极大地扭曲事物；改成：

```
 int width = 1000;
        int height = 10000;
        Random rand = new Random(123456);
        int[,] bazillionInts = new int[width, height];
        for(int i = 0 ; i < width;i++)
            for (int j = 0; j < height; j++)
            {
                bazillionInts[i, j] = rand.Next(50000);
            } 
```

试试看；你会看到`temp_notZipped.txt`40MB`temp_zipped.txt`和 62MB。没那么吸引人...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T22:14:04.977

最好的代码长度/输出大小比率是使用 BitConverter 对数组进行编码，将所有元素转换为其紧凑的二进制格式。我知道这是手动的，但与 .NET 二进制序列化相比，它将节省 80-90% 的空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T05:56:28.663

你能定义“大”吗？1000x10000xint 示例（另一篇文章）的大小为 40Mb；1000x10000x4 字节 (=int) 为 38MB。随着开销的增加，这并不可怕。

T 可能是什么类型的数据？只是原语？我在想我可能可以编辑[protobuf-net](http://code.google.com/p/protobuf-net/)以支持矩形数组`*`- 但为了保持某种线路兼容性，我们可能需要*每个元素*一个标题（一个字节） - 即 1000x10000 示例的 9MB 开销。

`float`这对于诸如,等之类的东西可能是不值得的`double`（因为它们逐字存储在“协议缓冲区”下） - 但可能会`int`因为它如何打包整数而节省一些东西......（特别是如果他们倾向于在较小的一侧[幅度]）。最后，如果 T 实际上是`Person`etc 之类的对象，那么它应该比二进制序列化好*很多*，因为它非常擅长打包对象。

在矩形阵列中插入鞋拔并非易事，但如果您有兴趣尝试，请告诉我。

`*`：目前不支持，因为“协议缓冲区”规范不支持它们，但我们可以解决这个问题......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-25T14:54:08.703

需要有这么多关于类型的数据的原因是您的 T 数组可以是任何类型，但更具体地说，T 可以是 SomeBaseClass 类型，您仍然可以将 SomeDerivedClass 存储在该数组中，并且反序列化器需要知道这个。

但正如其他人所指出的，这种冗余数据使其成为压缩的良好候选者。

# asp.net-mvc - 我可以将匿名类型传递给我的 ASP.NET MVC 视图吗？

> ID：223713
> 
> 赞同：46
> 
> 时间：2008-10-21T22:11:41.020
> 
> 标签：asp.net-mvc

我刚刚开始使用 ASP.NET MVC，因为它处于测试阶段。在我的代码中，我正在运行一个简单的 LINQ to SQL 查询来获取结果列表并将其传递给我的视图。这种事情：

```
var ords = from o in db.Orders
           where o.OrderDate == DateTime.Today
           select o;

return View(ords); 
```

然而，在我看来，我意识到我需要访问每个订单的客户姓名。我开始使用`o.Customer.Name`，但我相当确定这是为每个订单执行单独的查询（因为 LINQ 的延迟加载）。

减少查询数量的合乎逻辑的方法是同时选择客户名称。就像是：

```
var ords = from o in db.Orders
           from c in db.Customers
           where o.OrderDate == DateTime.Today
               and o.CustomerID == c.CustomerID
           select new { o.OrderID, /* ... */, c.CustomerName };

return View(ords); 
```

除了现在我的“ords”变量是匿名类型的 IEnumerable。

是否可以声明一个 ASP.NET MVC 视图，使其接受 IEnumerable 作为其视图数据，其中 T 由从控制器传递的内容定义，或者我必须定义一个具体类型以从我的查询中填充?

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-22T00:00:31.160

你能把它传递给视图吗？是的，但您的视图不会是强类型的。但助手会工作。例如：

```
public ActionResult Foo() {
  return View(new {Something="Hey, it worked!"});
}

//Using a normal ViewPage

<%= Html.TextBox("Something") %> 
```

该文本框应呈现“嘿，它成功了！” 作为价值。

那么你能定义一个视图，其中 T 由控制器传递给它的内容定义吗？好吧，是的，但显然不是在编译时。

想一想。当您为视图声明模型类型时，您会获得视图的智能感知。这意味着必须在编译时确定类型。但问题是，我们能否根据运行时给予它的东西来确定类型。当然，但不是保留强类型。

对于您甚至还不知道的类型，您将如何获得 Intellisense？控制器最终可能会在运行时将任何类型传递给视图。我们甚至无法分析代码和猜测，因为我们所知道的动作过滤器可能会更改传递给视图的对象。

我希望这可以澄清答案，而不会进一步混淆它。:)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-01-13T14:11:49.307

您*可以*将匿名类型传递给视图，只需记住将模型转换为动态。

你可以这样做：

```
return View(new { 
    MyItem = "Hello", 
    SomethingElse = 42, 
    Third = new MyClass(42, "Yes") }) 
```

然后您可以在视图顶部执行此操作（在此处使用剃刀）

```
@{
    string myItem = (dynamic)Model.MyItem;
    int somethingElse = (dynamic)Model.SomethingElse;
    MyClass third = (dynamic)Model.Third;
} 
```

或者您可以像这样从 ViewData 中投射它们：

```
@{
    var myItem = ViewData.Eval("MyItem") as string
    var somethingElse = ViewData.Eval("SomethingElse") as int?
    var third = ViewData.Eval("Third") as MyClass 
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-04-14T23:51:04.453

在 .NET 4.0 上，匿名类型可以很容易地转换为 ExpandoObjects，因此所有问题都可以通过转换本身的开销来解决。[在这里](https://stackoverflow.com/questions/5120317/dynamic-anonymous-type-in-razor-causes-runtimebinderexception/5670899#5670899)查看

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-22T10:26:11.910

值得一提的是，今晚我发现了[DataLoadOptions](http://msdn.microsoft.com/en-us/library/system.data.linq.dataloadoptions.aspx)类及其[LoadWith](http://msdn.microsoft.com/en-us/library/bb534268.aspx)方法。我能够告诉我的 LINQ to SQL DataContext 在检索到 Orders 行时始终加载 Customers 行，因此原始查询现在可以一次性获得我需要的一切。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-11-12T06:40:26.610

[这](http://www.dotnetfunda.com/articles/show/2655/binding-views-with-anonymous-type-collection-in-aspnet-mvc)是一篇解释如何将匿名类型传递给视图并绑定数据的文章。

谢谢

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-21T23:18:41.837

这篇[文章](http://tomasp.net/blog/cannot-return-anonymous-type-from-method.aspx)展示了如何从方法返回匿名类型，但它不符合您的要求。

另一种选择可能是将匿名类型转换为 JSON（JavaScriptSerializer 将执行此操作），然后将该 JSON 返回到视图，然后您将需要一些 jQuery 等来执行您喜欢的操作。

我一直在使用 Linq 将我的数据“塑造”成我的视图所需的 JSON 格式，并取得了巨大的成功。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-25T10:42:33.057

您可以编写具有与匿名类型相同属性的类，并且可以将匿名类型转换为手写类型。缺点是在 linq 查询中进行投影更改时必须更新类。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-05-21T18:12:18.047

**请记住：** `anonymous`类型是内部的，这意味着它们的属性不能在其定义的程序集之外看到。

您最好使用扩展方法将类型转换为，将`dynamic`对象（而不是`anonymous`一个）传递给您的对象。`View``anonymous``dynamic`

```
public class AwesomeController : Controller
{
    // Other actions omitted...
    public ActionResult SlotCreationSucceeded(string email, string roles)
    {
        return View("SlotCreationSucceeded", new { email, roles }.ToDynamic());
    }
} 
```

* * *

扩展方法如下所示：

```
public static class DynamicExtensions
{
    public static dynamic ToDynamic(this object value)
    {
        IDictionary<string, object> expando = new ExpandoObject();

        foreach (PropertyDescriptor property in TypeDescriptor.GetProperties(value.GetType()))
            expando.Add(property.Name, property.GetValue(value));

        return (ExpandoObject) expando;
    }
} 
```

* * *

尽管如此，您**仍然可以**传递一个`anonymous`对象，但您必须稍后将其转换为一个对象`dynamic`。

```
public class AwesomeController : Controller
{
    // Other actions omitted...
    public ActionResult SlotCreationSucceeded(string email, string roles)
    {
        return View("SlotCreationSucceeded", new { email, roles });
    }
} 
```

**看法：**

```
@{
    var anonymousModel = DynamicUtil.ToAnonymous(Model, new { email = default(string), roles = default(string) });
}

<h1>@anonymousModel.email</h1>
<h2>@anonymousModel.roles</h2> 
```

辅助方法如下所示：

```
public class DynamicUtil
{
    public static T ToAnonymous<T>(ExpandoObject source, T sample)
        where T : class
    {
        var dict = (IDictionary<string, object>) source;

        var ctor = sample.GetType().GetConstructors().Single();

        var parameters = ctor.GetParameters();

        var parameterValues = parameters.Select(p => dict[p.Name]).ToArray();

        return (T) ctor.Invoke(parameterValues);
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-21T22:40:44.440

您也许可以传递一个对象并使用反射来获得您想要的结果。查看 ObjectDumper.cs（包含在 csharpexamples.zip 中）作为示例。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-21T22:52:13.543

如果我没记错的话，匿名类型会在编译时转换为强类型对象。强类型对象是否对视图数据有效是另一个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-22T23:28:50.597

我也有同样的问题......经过一番思考，我得出的结论是，最正确和最具可扩展性的解决方案是在发送到 View 之前序列化这个匿名类型。因此，您可以使用相同的方法使用后面的 View 代码填充页面并使用 JSON 填充页面

# c# - .NET - 将数据集（XML 数据）流式传输到 ZIP 文件？

> ID：223738
> 
> 赞同：8
> 
> 时间：2008-10-21T22:17:29.933
> 
> 标签：c#, compression, zip

我有一个由 XML 数据组成的 DataSet，我可以轻松地将其输出到文件中：

```
DataSet ds = new DataSet();
DataTable dt = new DataTable();
ds.Tables.Add(dt);
ds.Load(reader, LoadOption.PreserveChanges, ds.Tables[0]);
ds.WriteXml("C:\\test.xml"); 
```

但是，我想要做的是将 XML 压缩成 ZIP 或其他类型的压缩文件，然后将此文件保存到磁盘，同时将 ZIP 文件拆分为 1MB 块。我真的不想保存未压缩的文件，然后压缩它，然后拆分它。

**我正在寻找的具体是：**

1.  一个合适的压缩库，我可以将 XML 流式传输到并将 zip 文件保存到磁盘
2.  一些示例 C# 代码可以向我展示如何执行此操作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-21T22:25:42.520

我已经设法使用 .NET 2.0 的 gzip 压缩来压缩 DataSet 的 XML 流。

这是我几年前写的关于它的博客文章：

[使用压缩在本地保存数据集](http://www.madprops.org/blog/saving-datasets-locally-with-compression)

...这是我添加到我的 DataSet 的部分类中以编写压缩文件的代码（博客文章也有阅读代码）：

```
public void WriteFile(string fileName)
{
    using (FileStream fs = new FileStream(fileName, FileMode.Create))
    {
        Stream s;
        if (Path.GetExtension(fileName) == ".cmx")
        {
            s = new GZipStream(fs, CompressionMode.Compress);
        }
        else if (Path.GetExtension(fileName) == ".cmz")
        {
            s = new DeflateStream(fs, CompressionMode.Compress);
        }
        else
        {
            s = fs;
        }
        WriteXml(s);
        s.Close();
    }
} 
```

请注意，此代码根据文件的扩展名使用不同的压缩方案。这纯粹是为了让我可以用我的 DataSet 对另一种方案进行测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T00:39:16.370

这适用于流或文件，具有良好的许可证和来源： http: [//www.codeplex.com/DotNetZip](http://www.codeplex.com/DotNetZip)

这是执行原始海报要求的代码：将 DataSet 写入一个 zip 中，该 zip 被拆分为 1mb 块：

```
// get connection to the database
var c1= new System.Data.SqlClient.SqlConnection(connstring1);
var da = new System.Data.SqlClient.SqlDataAdapter()
{
    SelectCommand= new System.Data.SqlClient.SqlCommand(strSelect, c1)
};

DataSet ds1 = new DataSet();

// fill the dataset with the SELECT 
da.Fill(ds1, "Invoices");

// write the XML for that DataSet into a zip file (split into 1mb chunks)
using(Ionic.Zip.ZipFile zip = new Ionic.Zip.ZipFile())
{
    zip.MaxOutputSegmentSize = 1024*1024;
    zip.AddEntry(zipEntryName, (name,stream) => ds1.WriteXml(stream) );
    zip.Save(zipFileName);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T01:57:11.313

3.5 框架中包含一个不太知名的打包 API。程序集引用位于 GAC 中，称为 WindowsBase。System.IO.Packaging 命名空间包含用于创建 OPC 文件（例如 OOXML）的内容，这些文件是包含 xml 和任何其他所需内容的 zip 文件。你会得到一些你不需要的额外东西，但是 ZipPackage 类使用流接口来迭代地添加内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T22:26:01.787

该框架包括一些用于压缩流的类。其中之一是 GZipStream。如果你搜索它，你会发现很多命中。这是[其中](http://geekswithblogs.net/podwysocki/archive/2006/06/21/82628.aspx)之一。我想分块输出会涉及一些额外的工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T00:52:45.173

您应该使用[Xceed Zip](http://xceed.com/Zip_Net_Intro.html)。代码看起来像这样（未经测试）：

```
ZipArchive archive = new ZipArchive( new DiskFile( @"c:\path\file.zip" ) );

archive.SplitSize = 1024*1024;
archive.BeginUpdate();

try
{
  AbstractFile destFile = archive.GetFile( "data.xml" );

  using( Stream stream = destFile.OpenWrite( true ) )
  {
    ds.WriteXml( stream );
  }
}
finally
{
  archive.EndUpdate();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T18:21:30.780

[DotNetZip](http://dotnetzip.codeplex.com)通过流进行 zip 压缩，但不进行多部分 zip 文件。:(

**编辑**：截至 2009 年 9 月，DotNetZip 可以制作多部分 zip 文件。

# asp.net - 防止浏览器在大文件上传时超时

> ID：223748
> 
> 赞同：10
> 
> 时间：2008-10-21T22:22:39.673
> 
> 标签：asp.net, file-upload

我为使用 IFrame 和 ASP.NET AJAX 的 ASP.NET 网络表单编写了一个不错的小文件上传控件。

但是，在大量上传时，浏览器会在完成发布表单之前超时。

有没有办法可以增加这个？

我对替代解决方案并不感兴趣，所以请不要建议改变整个事情。它适用于 <5 meg 的上传，我只想让它达到大约 8mb。

编辑：在 Page_Load 中设置超时似乎没有改变任何东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-23T18:37:16.770

您需要在 IIS6 及更高版本上更新元数据库设置。键是“AspMaxRequestEntityAllowed”，以字节表示。我强烈推荐 Metabase Explorer 进行更改，但可以通过 %systemroot%\system32\inetserv\metabase.xml 中的 XML 进行更改。

元数据库浏览器：http: [//support.microsoft.com/kb/840671](http://support.microsoft.com/kb/840671)

嗯，也许我找错了树……如果还没有调整，你就不会做 5 MB 的文件。

另一个尝试：查看您的 web.config：

```
<system.web>
  <httpRuntime  maxRequestLength="10240" executionTimeout="360"/>
</system.web> 
```

最大请求长度以千字节为单位，执行超时以秒为单位。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-07-21T22:09:58.130

把它放在你的 web.config 中

```
 <system.web>
     <httpRuntime executionTimeout="360" maxRequestLength="100000" /> 
```

这可以实现 360 秒的超时和一次 100,000 Kb 的上传数据。

如果这不起作用，请在您的 IIS 服务器上运行此命令。（替换 [IISWebsitename]）

```
C:\Windows\System32\inetsrv>appcmd set config "[IISWebsitename]" -section:requestFiltering -requestLimits.maxAllowedContentLength:100000000 -commitpath:apphost 
```

这一次可以上传 100,000,000 字节的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T22:30:21.433

在 Page_Load 中，将 Server.ScriptTimeout 设置为适合您的值。我相信以秒为单位。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T18:43:49.770

我认为您可能需要调整[MaxRequestLength](http://msdn.microsoft.com/en-us/library/system.web.configuration.httpruntimesection.maxrequestlength.aspx)

它在 Web.config 我认为默认情况下它的 4megs。

以下将允许〜10兆文件：

```
<httpRuntime maxRequestLength="10240" /> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-03T06:12:07.227

打开您的 Web.config 文件，并在标签下方`<system.web>`添加以下标签：

`<httpRuntime executionTimeout="90" maxRequestLength="4096" useFullyQualifiedRedirectUrl="false" minFreeThreads="8" minLocalRequestFreeThreads="4" appRequestQueueLimit="100" enableVersionHeader="true" />`

现在，看一下`<httpRuntime>`标签的 maxRequestLength="4096" 属性。您可能已经意识到，您需要做的就是将该值更改为您选择的其他值（8192 为 8 Mb，16384 为 16 Mb，65536 为 64 Mb，等等......）。

* * *

## 回答 #6

> 赞同：-7
> 
> 时间：2008-12-02T10:37:41.920

检查[Velodoc XP 版](http://www.codeplex.com/VelodocXP)的代码。它包括一个上传流模块、一个可恢复下载处理程序和基于 ASP.NET Ajax 扩展的 ASP.NET 上传控件，并且都是开源的。

如需更多信息，请[访问 www.memba.com](http://www.memba.com)和[www.velodoc.com](http://www.velodoc.com)。

* * *

## 回答 #7

> 赞同：-7
> 
> 时间：2011-03-06T22:39:23.683

我使用带有 HTML 的 PHP 解决了这个问题：

1.  我开始一个会话
2.  进入循环
3.  创建一个循环，重新加载一次完成部分工作的页面
4.  做直到工作完成
5.  循环内的代码完成了部分工作
6.  增加一个会话变量以指向作业的下一部分
7.  使用 java 脚本重新加载页面 //这将重新启动服务器页面计时器
8.  环形
9.  加载页面以报告工作已完成

# asp.net - .NET 站点如何隐藏其文件的 .aspx 扩展名？

> ID：223750
> 
> 赞同：31
> 
> 时间：2008-10-21T22:22:55.460
> 
> 标签：asp.net

我很确定 stackoverflow.com 是用 ASP.NET 创建的，但无论我在哪里单击，地址栏中都看不到 .aspx 扩展名。它是如何完成的，这有什么特别的原因吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-21T22:31:51.137

在 stackoverflow 的情况下，他们使用 ASP.NET MVC 而不是 ASP.NET Web 表单。对于 Web 表单，url 指向磁盘上的文件，而 MVC 指向控制器操作。如果您使用的是网络表单，则需要使用 URL 重写。Scott Guthrie 有一篇关于 URL 重写的[好文章。](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-21T22:26:10.133

该站点使用 ASP.NET MVC 框架和 Urls 映射到路由而不是物理页面。路由传递给控制器​​，然后控制器决定如何显示页面。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-21T22:26:49.773

很可能是通过 URL 重写完成的......

网络服务器正在获取类似于浏览器地址栏中的 URL，并将它们重新指向幕后的 ASPX 页面

这可以在 .NET HTTP 模块中完成，也可以作为 IIS 中的 ISAPI 处理程序完成

Scott Gutherie 在他的网站上有一篇关于 URL 重写的好文章

[http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-04-14T05:35:51.280

您可以通过修改您的 web.config 文件来实现。

```
<configuration>
<system.webserver>
<rewrite>
   <rules>
            <rule name="RemoveASPX" enabled="true" stopProcessing="true">
                <match url="(.*)\.aspx" />
                <action type="Redirect" url="{R:1}" />
            </rule>
            <rule name="AddASPX" enabled="true">
                <match url=".*" negate="false" />
                <conditions>
                    <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
                    <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
                    <add input="{URL}" pattern="(.*)\.(.*)" negate="true" />
                </conditions>
                <action type="Rewrite" url="{R:0}.aspx" />
            </rule>
   </rules>
</rewrite>
</system.webserver>
</configuration> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-21T23:25:44.710

正如其他人回答的那样，StackOverflow 是使用 ASP.NET MVC 构建的，而 ASP.NET MVC 使用 System.Web.Routing。但是 System.Web.Routing 不是 ASP.NET MVC 的一部分，它是带有 SP1 的 RTMd，这意味着可以在没有 ASP.NET MVC 的情况下使用它。您可以在此处查看如何将其与 WebForms 一起使用： http: [//haacked.com/archive/2008/03/11/using-routing-with-webforms.aspx](http://haacked.com/archive/2008/03/11/using-routing-with-webforms.aspx)和此处： http: [//www.codeplex.com/ASPNET35Routing](http://www.codeplex.com/ASPNET35Routing)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-21T22:25:18.700

您可以通过 ISAPI 重写（用于 IIS）来完成此操作以及更多操作。它允许您创建友好的 url，而无需所有丑陋的查询字符串。它为用户提供了更友好的界面，并使您的内容更易于搜索。

如果您使用的是 Apache，请使用 mod_rewrite。

两者的基本前提是它们采用友好的 url（就像您在本网站看到的那样），然后使用一系列规则（通常是您指定的正则表达式）将其转换为易于理解的内部 url 或查询字符串编码。

一个例子是它们使用转换规则转换`posts/edit/<postnumber>`为。`editPost.aspx?postNumber=<postnumber>`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-18T14:20:16.980

只要页面 .aspx、.ashx 位于应用程序文件夹中，下面的代码就可以正常工作。优先级是先解析.aspx页面，再解析.ashx。

例如，如果您尝试 localhost/AppFolder/Time，它将尝试解析 localhost/AppFolder/Time.aspx，如果未找到，则解析 localhost/AppFolder/Time.ashx。

附言

1.  我没有完全测试这段代码，所以要小心。

2.  它不考虑可能包含 .aspx 文件的文件夹，因此，如果您尝试访问 /PhysicalApplicationPath/MYFOLDER/page，它将无法解析为 /PhysicalApplicationPath/MYFOLDER/page.aspx。

代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.SessionState;

namespace NameSpace
{
    public class Global : System.Web.HttpApplication
    {
        private void mapearUrlAmigaveis()
        {
            String url = Request.Path.ToString().ToLower();
            int positionQuestionMarkParameter = url.IndexOf('?');

            String urlSemParametros = (positionQuestionMarkParameter != -1) ? url.Substring(0, (positionQuestionMarkParameter - 1)) : url;
            String[] splitBarra = urlSemParametros.Split('/');
            int indexOfUltimaBarra = urlSemParametros.LastIndexOf('/');

            if (splitBarra.Length > 0)
            {
                String ultimaBarra = splitBarra[(splitBarra.Length - 1)];
                String caminhoLocalUltimaBarra = Request.PhysicalApplicationPath + ultimaBarra;
                String parametros = ((positionQuestionMarkParameter != -1) ? url.Substring((positionQuestionMarkParameter - 1), (url.Length - 1)) : String.Empty);
                if (System.IO.File.Exists(caminhoLocalUltimaBarra + ".aspx"))
                {
                    Context.RewritePath(urlSemParametros + ".aspx" + parametros);
                }
                else if (System.IO.File.Exists(caminhoLocalUltimaBarra + ".ashx"))
                {
                    Context.RewritePath(urlSemParametros + ".ashx" + parametros);
                }
            }
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-07T12:12:02.893

您可以在 c# .NET 中执行此操作，以便在 ASP.NET 中的 URL 中使用自定义扩展。

让代码中的“.recon”成为您自定义的扩展名。（即将“.recon”替换为您自己的扩展名）

```
 protected void Application_BeginRequest(object sender, EventArgs e)
 {
    HttpApplication app = sender as HttpApplication;
    if (app.Request.Path.ToLower().IndexOf(".recon") > 0)
    {
        string rawpath = app.Request.Path;
        string path = rawpath.Substring(0, rawpath.IndexOf(".recon"));
        app.Context.RewritePath(path+".aspx");
    }
 } 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-02-25T19:48:06.320

就一个原因而言：

*   您可以更改技术（比如 PHP）而不破坏索引或书签 URL
*   您的 URL 更加“REST”并且对应于资源而不仅仅是一个文件
*   您可以更轻松地记住 URL 或通过电话将其朗读给某人

# asp.net - 通过网络服务接收文件的最佳方式

> ID：223761
> 
> 赞同：4
> 
> 时间：2008-10-21T22:25:10.697
> 
> 标签：asp.net, web-services

我有一个由可通过 GET/POST/SOAP 调用的 ASP.NET Web 服务组成的 API。

一项新功能将要求我通过此 Web 服务接受文件。基本上，我允许用户通过 API 将文件上传到文件存档，否则他们会通过登录我们基于浏览器的管理系统来完成。

API 需要尽可能易于使用。我正在考虑放弃 SOAP 支持，因为我们的 PHP 客户端主要使用 GET/POST 方法，而 .NET 客户端不介意任何一种方式。以此为先决条件，我正在考虑简单地创建一个 UploadFile(fileName) 方法，并要求用户通过 POST 发送文件作为普通文件上传。

但是，我不能将文件字段指定为方法的参数，对吧？因此，如果我只是在文档中声明“文件应该在名为'文件'的 POST 字段中发送”，那么当我需要读取文件时会不会造成任何问题？

所有文件均为二进制格式、PDF、各种图像格式、FLV 等。此外，文件大小主要在 2-20MB 附近，但鉴于上述解决方案，我在接受 250MB 区域中的文件时会遇到什么麻烦吗？

以这种方式接收文件会导致文件在我将其写入磁盘之前完全加载到内存中 - 除了让服务接收 Stream 并因此使我无法接受其他参数并阻碍简单之外，还有什么办法可以解决这个问题服务的使用？

* * *

除了我这边的可能性之外，我也很好奇如何让被调用者尽可能轻松地发送文件。我猜 POST 是最容易接收文件的方式之一，但如果有人有任何意见，我也想听听。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T22:45:38.597

“当我需要读取文件时，这会带来什么问题吗？” 没问题。当您处理 POST 请求时，您有一个 POST 的 MIME 附件，即文件。阅读此文件相对简单。

“我在接受 250MB 区域的文件时会遇到什么问题吗？” 不，除了传输大文件需要一些时间。

“以这种方式接收文件会导致文件完全加载到内存中”不一定是真的。许多 Web 服务器将请求处理到 MIME 附件并停止读取，从而使 HTTP 标头、请求和打开的套接字可用于进一步处理。我不了解 ASP，但我知道几乎所有框架都避免读取数据。该框架将其留给您的应用程序。

因此，您可以分块读取数据并写入（或处理）这些块，而无需将整个数据读入内存。

POST 正是这样做的。如果不跳出狭窄的 HTTP Web 服务空间，没有很多替代方案。当然，您可以使用其他协议，例如 FTP（TFTP、SFTP）来移动文件，但这通常会让编写客户端应用程序的人感到困惑。

如果需要，您可以提供一个客户端库，该库`HttpWebRequest`使用 POST 方法创建一个对象，以及一个带有附件的流。但是你不会节省太多，因为这个`HttpWebRequest`类看起来很简单。这是一个[代码示例](http://blog.brezovsky.net/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T22:50:59.973

使用简单的 POST 方法提交文件并没有什么可怕的错误，只是将文件上传与任何相关元数据联系起来的细节（即，如果方法与方法捆绑在一起，则方法的其他参数）。

然而，今天，我相信在 SOAP 调用中处理大对象的方法是 MTOM。这是一种优化，但它为您提供了实际有效负载的流接口。因此，如果需要，该框架可以轻松地将大对象缓存到磁盘（它们是否真的这样做是另一个问题，但没有人愿意将 250M 上传到内存中，所以我想任何现代人都会卸载大附件） .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T00:51:14.537

> 但是，我不能将文件字段指定为方法的参数，对吧？因此，如果我只是在文档中声明“文件应该在名为'文件'的 POST 字段中发送”，那么当我需要读取文件时会不会造成任何问题？

没有理由不能包含额外的 POST（或 GET，就此而言）参数。我自己可能会将文件名作为附加的 POST 参数，以便在请求中自动使用本地文件名的客户端可以轻松重命名。如果我预计会发生命名冲突，我什至可能会在发生冲突时返回服务器选择的名称……我认为 REST 人员为此使用某种 HTTP Created 状态代码。

> 所有文件均为二进制格式、PDF、各种图像格式、FLV 等。此外，文件大小主要在 2-20MB 附近，但鉴于上述解决方案，我在接受 250MB 区域中的文件时会遇到什么麻烦吗？

您需要调整 web.config 中的 maxRequestLengths 和 executionTimeouts。而且，如果有人尝试通过拨号上传 250MB - 好吧，我们只是说它可能行不通。

> 以这种方式接收文件会导致文件在我将其写入磁盘之前完全加载到内存中 - 除了让服务接收 Stream 并因此使我无法接受其他参数并阻碍简单之外，还有什么办法可以解决这个问题服务的使用？

ASP.NET 2.0+ 在文件进入时将上传的文件假脱机到磁盘，以避免将整个请求预加载到 RAM 中。适当调整 web.config 的[requestLengthDiskThreshold](http://msdn.microsoft.com/en-us/library/system.web.configuration.httpruntimesection.requestlengthdiskthreshold.aspx)以平衡速度和内存使用。如果您愿意，您不能使用 Stream ......尽管您可以使用 byte[] 数组。虽然我真的不确定那是什么意思....

对于小文件，您可以使用 base 64，这对客户来说应该是微不足道的。但是，对于 20MB - 开销是不值得的。

有许多不同的 ASP.NET 文件上传组件——它们基本上以 HttpModule 的形式连接到 Begin_Request，并拦截任何 multippart/form-uploads 的请求流。对于 ASP.NET 2.0，这可能是不必要的，除非您想提供某种进度回调或其他东西。如果是这样的话——它们的机制应该同样适用于 Web 服务。

RFC 1867 是相关规范，但是如果您打算自己解析，这个[上传组件](http://darrenjohnstone.net/2008/07/04/aspnet-file-upload-revisited-part-2-rfc-1876-parser/)可以很好地展示请求的外观。

我要问的一个问号是，您的客户端的 http 库中对 multipart/form-data 的支持级别是多少。我怀疑它周围都很好，但你可能想检查一下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T23:15:12.890

不是直接的答案，但您可能还想查看[BITS - 后台智能传输服务 [wiki]](http://en.wikipedia.org/wiki/Background_Intelligent_Transfer_Service)

它可能与您/您的客户相关，也可能不相关。

# c++ - 由于在多个 cpps 中包含相同的标头而导致重复的多个定义错误

> ID：223771
> 
> 赞同：15
> 
> 时间：2008-10-21T22:27:45.933
> 
> 标签：c++, dev-c++, multiple-definition-error, multiple-inclusions

因此，无论我做什么，我似乎都无法避免 Dev C++ 出现大量多重定义错误，因为我在同一个项目的多个源代码文件中包含了相同的头文件。我强烈希望避免将所有源代码转储到一个文件中，并且只包含一次标题，因为这会使我的文件非常长且难以管理。

本质上，这就是正在发生的事情：

```
#ifndef _myheader_h
#define _myheader_h

typedef struct MYSTRUCT{
int blah;
int blah2; } MYSTRUCT;

MYSTRUCT Job_Grunt;
MYSTRUCT *Grunt = &Job_Grunt;
MYSTRUCT Job_Uruk;
MYSTRUCT *Uruk = &Job_Grunt;

int Other_data[100];

void load_jobs();

#endif 
```

示例 Cpp 文件（它们几乎都像这样）：

```
#include "myheader.h"

void load_jobs(){

Grunt->blah = 1;
Grunt->blah2 = 14;

Uruk->blah = 2;
Uruk->blah2 = 15;

return; } 
```

请记住，我有大约 5 个包含这个头文件的 cpp 文件，每个文件都处理头文件中的不同类型的结构。在这个例子中，只有一个结构包含几个成员，而实际头文件中有大约 4-6 个不同的结构和更多的成员。我包含的所有文件都遵循与您在此示例中看到的相同的公式。

现在我明白标头保护只会阻止每个单独的 cpp 文件多次包含头文件。似乎正在发生的事情是，当编译器在每个 cpp 的开头读取包含时，它会重新定义头文件，这导致它吐出以下行和行：

```
Multiple Definition of Uruk, first defined here  
Multiple Definition of Job_Uruk, first defined here  
Multiple Definition of Grunt, first defined here  
Multiple Definition of Job_Grunt, first defined here  
Multiple Definition of Other_data, first defined here 
```

我会为项目中几乎每个包含标头的 cpp 文件看到一组这样的文件。我已经尝试将结构和结构变量的定义移动到 cpp 文件中，但是其他 cpp 文件看不到它们或无法使用它们，这非常重要，因为我需要项目中的所有文件才能工作使用这些结构。

但是关于这个问题的最令人困惑的部分需要更多解释：

我在这个项目中设置这些多个文件的方式与我正在使用的书相同，John S. Harbour 的 All In One Game Programming。当我为书中的示例项目创建文件时，我遇到了完全相同的问题，这些文件要求同一项目中的多个 cpp 包含一个标头。

我可以逐字逐句地从书中输入它们，而且我的意思是逐字逐句......
我会得到项目中每个 cpp 的一系列 MD 错误。

如果我从本书附带的 CD 中加载示例项目，它会毫无问题地编译和运行，尽管文件本身以及项目选项在所有外观上都与我创建的相同。

如果我创建了自己的项目文件，并简单地从 CD 中添加示例项目的源文件和头文件，这也将编译和运行，尽管我发现它们和我的没有区别。

因此，我尝试制作自己的项目文件，然后创建空白的源文件和头文件并将它们添加到其中，然后通过从 CD 上它们要对应的文件中复制和粘贴它们的内容来填充它们（相同那些已经工作的）。果然，我会得到同样的东西……一行又一行的 MD 错误消息。

我完全感到困惑。我已经多次重复所有这些方法，并且确定我没有输入错误或错误复制代码。预制文件本身似乎有些东西。一些配置设置或其他我完全丢失的东西......这将导致它们正确编译，而我自己制作的文件不会。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-21T22:36:05.027

由于您在头文件中声明这些变量，并在每个 C++ 文件中包含头文件，因此每个 C++ 文件都有自己的副本。

解决这个问题的常用方法是*不在*头文件中声明任何变量。相反，在单个 C++ 文件中声明它们，并`extern`在您可能需要它们的所有其他文件中声明它们。

我之前处理过的另一种方式，有些人可能会认为这很不愉快......在头文件中声明它们，如下所示：

```
#ifdef MAINFILE
    #define EXTERN
#else
    #define EXTERN extern
#endif

EXTERN MYSTRUCT Job_Grunt;
EXTERN MYSTRUCT *Grunt = &Job_Grunt;
EXTERN MYSTRUCT Job_Uruk;
EXTERN MYSTRUCT *Uruk = &Job_Uruk; 
```

然后，在您的*一个*C++ 文件中，添加一个...

```
#define MAINFILE 
```

...在你的`#include`台词之前。这将处理所有事情，并且（在我个人看来）比必须重新声明每个文件中的所有变量要好得多。

当然，*真正的*解决方案是根本不使用全局变量，但是当您刚开始时，这很难实现。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-21T22:41:13.440

定义变量时，编译器会为该变量留出内存。通过在头文件中定义一个变量，并将该文件包含到所有源文件中，您可以在多个文件中定义同一个变量。

将关键字放在`extern`变量定义之前将告诉编译器该变量已经在某个地方定义，并且您只是*声明*（即命名）该变量以便其他文件可以使用它。

因此，在您的头文件中，您应该通过添加关键字来使所有定义*前向声明。*`extern`

```
extern MYSTRUCT Job_Grunt;
extern MYSTRUCT *Grunt;
extern MYSTRUCT Job_Uruk;
extern MYSTRUCT *Uruk;

extern int Other_data[100]; 
```

然后在**一个**（也是唯一一个）源文件中，正常定义变量：

```
MYSTRUCT Job_Grunt;
MYSTRUCT *Grunt = &Job_Grunt;
MYSTRUCT Job_Uruk;
MYSTRUCT *Uruk = &Job_Grunt;

int Other_data[100]; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-22T01:21:37.830

虽然大多数其他答案对于您为什么看到多个定义都是正确的，但术语并不精确。理解声明与定义是解决问题的关键。

声明宣布项目的存在，但不会导致实例化。因此， extern 语句是声明 - 而不是定义。

定义创建已定义项的实例。因此，如果您在标头中有定义，它将在每个 .cpp 文件中实例化，从而产生多个定义。定义也是声明 - 例如，如果项目的范围仅限于一个 .cpp 文件，则不需要单独的声明。

注意：这里使用的实例化这个词实际上只适用于数据项。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-21T22:32:03.350

您需要在头文件中将变量定义为 extern，然后在 cpp 文件中定义它们。IE：

```
extern MYSTRUCT Job_Grunt; 
```

在您的头文件中，然后在您的项目中的 cpp 文件中正常声明它们。

头文件仅用于定义，当您在头文件中实例化一个变量时，它会在每次头文件包含在您的项目中时尝试实例化它。使用 extern 指令告诉编译器它只是一个定义，并且实例化是在其他地方完成的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-06-07T09:09:21.483

对于 .h 文件中定义的函数，我也收到了此错误。头文件的目的不是声明一个类，而是定义项目中不同位置所需的一些函数。（我可能会混淆“定义”和“声明”的用法，但我希望我能给出主要思想。）当我在给出“多重定义”错误的函数定义之前放置一个“内联”关键字时，避免了错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T22:36:45.057

为了扩展 Gerald 所说的内容，标题定义了结构的一个实例（这不是您想要的）。这导致包含标头的每个编译单元（cpp 文件）都获得自己的结构实例版本，这会导致链接时出现问题。

正如 Gerald 所说，您需要在标头中定义对结构的引用（使用“extern”），并在项目中有一个实例化实例的 cpp 文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-19T07:36:42.360

前段时间我也遇到过这个问题。让我试着解释是什么解决了它。我有一个 global.h 文件，其中包含所有声明并且需要包含在每个 cpp 文件中。我没有将其包含在每个 .cpp 中，而是将其包含在 .h 中。我所有的“.h”文件都添加了#ifndef 和#define 行，并以#endif 结尾。这解决了MD问题。希望这对你也有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-23T12:58:03.747

这对我有用：将源链接到单独的库中。（我的问题不在于创建程序，而是创建一个/多个库。）然后我（成功地）将一个程序与我创建的*两个库链接。*

我在同一个源文件中有两组函数（一组取决于另一组），并在同一个头文件中声明。然后我尝试将两个函数集分开在两个头文件+源文件中。

我尝试了一次#pragma 并使用#ifndef ... #define ... #endif 包含警卫。我还在头文件中将变量和函数定义为 extern。

正如 Steve Fallows 所指出的，问题不在于编译，而在于链接。在我的特定问题中，我可以使用两组函数，每组函数都在自己的源文件中，编译然后链接到*两个单独的库*中。

```
g++ -o grandfather.o -c grandfather.cpp
g++ -o father.o -c father.cpp
g++ -fPIC -shared -o libgf.so grandfather.o
g++ -fPIC -shared -o libfather.so father.o 
```

这迫使我将我的程序与 libgf.so 和 libfather.so 链接起来。在我的特殊情况下，这没有什么区别；但否则我无法让他们一起工作。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2008-10-21T22:41:36.590

GCC 3.4 及更高版本支持`#pragma once`. 只需放在`#pragma once`代码的顶部，而不是使用包含防护。这可能会或可能不会更成功，但值得一试。不，这并不（总是）完全等同于包含防护。

# c# - How to create .odt files with C#.NET?

> ID：223777
> 
> 赞同：7
> 
> 时间：2008-10-21T22:30:09.407
> 
> 标签：c#, document, openoffice.org

*Note: I found this ["Creating a Word Doc in C#.NET"](https://stackoverflow.com/questions/10412/creating-a-word-doc-in-cnet), but that is not what I want.*

Do you know how to create a **.odt** to create file from C# .NET?
Is there a .NET component or wrapper for an OpenOffice.org library to do this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T20:13:27.450

Have a look at AODL (see [http://odftoolkit.org/projects/odftoolkit/pages/AODL](http://odftoolkit.org/projects/odftoolkit/pages/AODL)).

*   fully managed .NET 1.1 (so it runs on MS.Net and Mono)
*   support for text and spreadsheet documents
*   create, read, edit, save documents
*   ...

EDIT by kame: New link [AODL-Wiki](https://wiki.openoffice.org/wiki/AODL)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T22:43:50.470

You can check out the [OASIS Standards site](http://www.oasis-open.org/specs/index.php#opendocument) for information on the ODT standard. From what I've seen, they're using an XML based standard and have an XSD available for the the document standard, so you could use that in conjunction with your own code to build a document file in the proper format.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-21T23:21:35.200

You might be interested in [OpenOffice, UNO CLI Language Binding](http://wiki.services.openoffice.org/wiki/Documentation/DevGuide/ProUNO/CLI/CLI_Language_Binding).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-20T03:28:47.237

I found this one yesterday when looking for a way to create Spreadsheeets, it looks like creating writer files is quite similar: [http://www.suite101.com/content/creating-an-openoffice-calc-document-with-c-a124112](http://www.suite101.com/content/creating-an-openoffice-calc-document-with-c-a124112), dont forget to install the Open Office SDK from Oracle first.

Unfortunately I have not found a way to create a file without opening it yet.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-02T11:55:15.043

The code would look like this:

```
private XComponentContext oStrap = uno.util.Bootstrap.bootstrap();
XMultiServiceFactory oServMan = (XmultiServiceFactory) oStrap.getServiceManager();
XComponentLoader oDesk = (XComponentLoader) oServMan.createInstance("com.sun.star.frame.Desktop");
string url = @"private:factory/swriter";
PropertyValue[] propVals = new PropertyValue[0];
XComponent oDoc = oDesk.loadComponentFromURL(url, "_blank", 0, propVals);
string docText = "File Content\n\r";
((XTextDocument)oDoc).getText().setString(docText);
string fileName = @"C:\FolderName\FileName.odt";
fileName = "file:///" + fileName.Replace(@"\", "/");
((XStorable)oDoc).storeAsURL(fileName, propVals);
((Xcomponent)oDoc).dispose(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-06T01:32:56.463

OpenOffice documents (odt) are ZIP files. You can unzip an existing one, modify the content.xml file by code and then use the ZipFile class from System.IO.Compression for example to get a zip file again. [Open Office Specification](http://docs.oasis-open.org/office/v1.1/OS/OpenDocument-v1.1-html/OpenDocument-v1.1.html#outline:17.1.Introduction)

# php - 是否可以在不使用整个框架的情况下在 PHP 中为 ORM 安装 Kohana 库？

> ID：223788
> 
> 赞同：1
> 
> 时间：2008-10-21T22:32:43.770
> 
> 标签：php, orm, kohana

在上一个问题中，我询问了各种 ORM 库。事实证明，对于 ORM 而言，Kohana 看起来非常干净但功能强大。不过，我已经有一个正在使用的 MVC 框架。如果我不想将它作为框架运行，那么包含什么正确的文件集来只给我 DB 和 ORM 基类文件？

更新：

我跳进去开始查看 ORM 源​​代码。有一件事让我立即感到困惑。所有的 ORM 类的类名都附加了 _CORE，即 ORM_Core ORM_Iterator_Core，但到处的代码都在扩展 ORM 类。问题是，我已经以 6 种不同的方式搜索了整个代码库，但我从未见过普通的 ORM 类 def 或 ORM 接口 def 或任何东西。有人能告诉我魔法发生在哪里吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T06:28:18.740

为什么不只是有一个

```
class ORM extends ORM_Core {} 
```

在你的代码的某个地方？这消除了使用任何加载程序代码的需要。

您还需要 Kohana_Exception、数据库库（和适当的驱动程序）、Kohana::config()、Kohana::auto_load()、Kohana::log() 方法（在 Database.php 中搜索这些方法）。

Kohana 是一个很棒的 MVC 框架，但并不是真的被设计成像这样被分解成块。您可能还想研究[Doctrine](http://www.doctrine-project.org/)，这是 PHP 的另一个 ORM（它被设计为独立的）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T02:58:06.947

事实证明，Kohana 使用了魔术类加载，因此，如果具有 _Core 扩展的已定义类不作为类存在

即 ORM_Core 存在，但 ORM 不存在，因此 Kohana 将神奇地定义一个 ORM 类，因为该包使用 100% 魔术类加载。

万一有人感兴趣，我在这里记录我的发现，以便每个人以后都可以找到它：

```
From Kohana.php in the system directory:

<-- snip if ($extension = self::find_file($type, self::$configuration['core']['extension_prefix'].$class))
{
// Load the extension
require $extension;
}
elseif ($suffix !== 'Core' AND class_exists($class.'_Core', FALSE))
{
// Class extension to be evaluated
$extension = 'class '.$class.' extends '.$class.'_Core { }';
-->

<-- snip

// Transparent class extensions are handled using eval. This is
// a disgusting hack, but it gets the job done.
eval($extension);

--> 
```

所以它做了一个评估..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T00:25:33.060

Zak，检查可维护框架的 ORM。[http://framework.maintainable.com/mvc/3_model.php#c3.7](http://framework.maintainable.com/mvc/3_model.php#c3.7) 仔细阅读，我相信你会喜欢的。我将其更详细地发布在： [PHP 最容易使用的 ORM 框架是什么？](https://stackoverflow.com/questions/220229/what-is-the-easiest-to-use-orm-framework-for-php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T04:12:08.370

[http://obando.com.ve/2009/04/29/modelado-orm-rapido-y-facil/](http://obando.com.ve/2009/04/29/modelado-orm-rapido-y-facil/)

这就是你所需要的！！

# sql - 合并主键 - 级联更新

> ID：223797
> 
> 赞同：5
> 
> 时间：2008-10-21T22:34:48.133
> 
> 标签：sql, sql-server, cascade

有没有办法将两个主键合并为一个，然后级联更新所有受影响的关系？这是场景：

客户（idCustomer int PK、Company varchar(50) 等）

CustomerContacts（idCustomerContact int PK、idCustomer int FK、Name varchar(50) 等）

CustomerNotes（idCustomerNote int PK、idCustomer int FK、注释文本等）

有时客户需要合并为一个。例如，您有一个 id 为 1 的客户和另一个 id 为 2 的客户。您想要合并两者，以便所有 2 的内容现在都为 1。我知道我可以编写一个脚本来更新所有受影响的表一，但我想通过使用级联规则使其更具未来性，因此我不必每次添加新关系时都更新脚本。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T00:46:37.260

没有自动的方法可以做到这一点，但是您有几个选择，您可以手动编写过程，或者您可以定期生成合并代码或在运行时动态生成它。为此，您可以使用`INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS`and`INFORMATION_SCHEMA.KEY_COLUMN_USAGE`和`INFORMATION_SCHEMA.TABLE_CONSTRAINTS`and`INFORMATION_SCHEMA.COLUMNS and INFORMATION_SCHEMA.TABLES`动态构建过程。

您也可以简单地将整个操作包装在事务中（无论如何都是个好主意）。最后一步是删除要合并的客户，因此如果您从未添加过的表上有 RI，并且您尝试进行合并，它将失败，因为您无法删除要合并的客户，因为存在依赖项尚未添加到合并过程的表中的记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T22:58:25.730

考虑改用触发器。在更新客户（idCustomer 列）时，您可以对相关表进行任何需要的修改（删除、更新...）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T02:52:24.683

听起来您最终会为每个具有相同主键的表得到两条记录。这是你的意图吗？

```
        顾客
    id客户公司
         1 美国电话电报公司
         2 辛格勒

```

合并后会变成

```
        顾客
    id客户公司
         1 美国电话电报公司
         1 辛格勒

```

无论如何，最面向未来的解决方案是编写一个程序。您可以通过两个客户的过程，它会根据需要完成所有更新所有表的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-13T06:07:20.850

对此有任何更新的解决方案吗？

我有同样的问题，目前动态构建程序似乎太复杂了。以下是它在理论上如何工作，但我想它不是？

在一个事务中：1) 暂时禁用对客户的主键约束 2) 将 Cingular 的主 ID 更新为“1”，该 ID 具有照顾孩子的关系更新级联规则 3) 使用辅助键字段删除（仅）Cingular 4 ) 对客户启用主键约束

期待在未来的 T-SQL 中出现这样的事情：

更新 idCustomer = 1 从客户中删除，其中 idCustomer = 2；

;-)

# php - 如何放宽 PHP 的 open_basedir 限制？

> ID：223800
> 
> 赞同：22
> 
> 时间：2008-10-21T22:36:27.383
> 
> 标签：php, security, apache

[open_basedir](http://www.php.net/features.safe-mode)限制 PHP 在目录树中可以打开的文件。

我在我的 web 根目录之外存储了几个类库和配置文件。这样，Web 服务器就不会让它们公开访问。但是，当我尝试从我的应用程序中包含它们时，我得到一个 open_basedir 限制错误，如下所示：

> 警告：realpath() [function.realpath]：open_basedir 限制生效。文件(/var/www/vhosts/domain.tld/zend/application) 不在允许的路径中：/var/www/ 中的 (/var/www/vhosts/domain.tld/httpdocs:/tmp)第 5 行的 vhosts/domain.tld/httpdocs/index.php

我的网络根目录在这里：

```
/var/www/vhosts/domain.tld/httpdocs 
```

我的库和配置目录在这里：

```
/var/www/vhosts/domain.tld/zend 
```

放宽 open_basedir 限制以便域文件夹下的目录树可供我的应用程序使用的最佳解决方法是什么？我有许多域我想这样做，而且我显然也对创建安全漏洞持谨慎态度。

注意：我使用的是 CentOS、Apache、Plesk，并且我拥有对服务器的 root ssh 访问权限。虽然这并不直接适用于 Zend Framework，但我在本例中使用它。所以这里是 Zend 的引导程序中包含的内容：

```
define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/../zend/application/'));
set_include_path(APPLICATION_PATH . '/../zend/library' . PATH_SEPARATOR . get_include_path()); 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-21T22:47:03.210

您还可以使用 Apache（假设这是您的 Web 服务器）配置文件（例如 httpd.conf）在每个目录的基础上轻松完成此操作

```
<Directory /var/www/vhosts/domain.tld/httpdocs>
php_admin_value open_basedir "/var/www/vhosts/domain.tld/httpdocs:/var/www/vhosts/domain.tld/zend"
</Directory> 
```

您也可以完全删除限制

```
<Directory /var/www/vhosts/domain.tld/httpdocs>
php_admin_value open_basedir none
</Directory> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T22:42:51.970

将您需要访问的路径 (/var/www/vhosts/domain.tld/zend) 添加到您的 open_basedir 指令中（您可以在 windows 中使用路径分隔符 ':' 或 ';' 指定多个路径）

请注意，open_basedir 中的值是前缀，这意味着 /var/www/vhosts/domain.tld/zend 下的任何内容都可以访问

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-09T14:36:46.390

在 Parallels Plesk Panel（例如 1and1）中，您可以在 PHP 面板设置中执行此操作：

![在此处输入图像描述](https://i.stack.imgur.com/gcRFS.png)

这里：

![在此处输入图像描述](https://i.stack.imgur.com/c2AJK.png)

# mysql - 根据 CSV 文件检查注册

> ID：223802
> 
> 赞同：2
> 
> 时间：2008-10-21T22:36:41.953
> 
> 标签：mysql, csv, registration

我是 MySQL 和 PHP 的新手（你可能知道），我想知道是否有人知道将 CSV 文件导入 MySQL 表的简单方法。

> “有多种方法可以将 csv 输入 mysql，具体取决于您拥有的访问权限，如果您可以直接使用 mysql 客户端，则有一个命令可以加载分隔数据，基本上可以直接在 cron 中输入类似的内容并保存本身是最新的。否则有各种 php 脚本来做那种事情。

那是朋友告诉我要做的事情，这是最简单/最好的方法吗？如果有人介意向我解释一下吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T22:42:08.853

使用“加载数据文件”命令。通过 deafulat 它将传入文件视为 csv，尽管您可以定义要导入的自定义文件类型。加载数据文件的文档在这里：

[http://dev.mysql.com/doc/refman/5.0/en/load-data.html](http://dev.mysql.com/doc/refman/5.0/en/load-data.html)

FTA，在其最简单的形式中，该命令如下所示：

```
LOAD DATA INFILE 'data.txt' INTO TABLE db2.my_table; 
```

假设数据文件和文本文件中的列对齐。文档的其余部分解释了如何导入非排队字段，以及如何处理 windows 与 unix 样式的行终止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T02:47:56.487

这是扩展 Mrgreen 答案的分步操作：

1.  安装 phpmyadmin
2.  选择您的数据库
3.  选择你的桌子
4.  '进口'
5.  选择您的 CSV 文件
6.  将“导入文件的格式”设置为 CSV

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T00:01:20.957

如果您要使用 MySQL 和 PHP，我开始使用[XAMPP](http://www.apachefriends.org/en/index.html)是一个不错的方法。

> XAMPP 是一个易于安装的 Apache 发行版，包含 MySQL、PHP 和 Perl。XAMPP 非常易于安装和使用——只需下载、解压并启动。

该软件包包括 phpMyAdmin，它使上传 CSV 和管理 MySQL 数据库变得非常容易。

# sql - has_many 的索引：通过

> ID：223804
> 
> 赞同：8
> 
> 时间：2008-10-21T22:37:12.030
> 
> 标签：sql, ruby-on-rails, ruby, database, has-many

假设您有两个模型，用户和城市，由第三个模型 CityPermission 连接：

```
class CityPermission < ActiveRecord::Base
  belongs_to :city
  belongs_to :user
end

class City < ActiveRecord::Base
  has_many :city_permissions
  has_many :users, :through => :city_permissions
end

class User < ActiveRecord::Base
  has_many :city_permissions
  has_many :cities, :through => :city_permissions
end 
```

目前，我使用以下迁移代码片段创建连接表和表的索引：

```
create_table :city_permissions do |t|
      t.integer :user_id, :city_id
      t.other_fields ...
end

add_index(:city_permissions, :user_id)
add_index(:city_permissions, :city_id) 
```

这些是要创建的最佳索引吗？这些索引是否允许通过连接表来回快速访问，以及在表本身内快速查找，还是有其他更好的方法？以不同的方式重申这一点，这些索引，给定`city`并且`user`是类 City 和 User 的实例变量，是否允许`city.users`、`city.city_permissions`、`user.cities`和`user.city_permissions`都表现得同样好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-21T22:40:47.747

对我来说看上去很好。

生成的连接应该只是在实体表的 PK ID 上，或者在连接表中的 FK ID 上——它们都是索引。

查看生成的 ActiveRecord SQL 并将其与索引进行比较可能会很好。

然后，根据您使用的数据库，您可以通过解释计划运行该 SQL（或任何存在的工具，我在这里认为是 Oracle）

为了简化您的代码，您也可以考虑使用[`has_and_belongs_to_many`](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#M001114)。这会让你摆脱 CityPermission 对象（除非你想用它来存储数据本身）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T22:42:35.450

这是 ActiveRecord 生成的 SQL `user.cities`：

```
SELECT `cities`.* FROM `cities` INNER JOIN city_permissions ON (cities.id = city_permissions.city_id) WHERE (city_permissions.user_id = 1 ) 
```

在下面解释结果：

```
+----+-------------+------------------+--------+---------------------------------------------------------------------+-----------------------------------+---------+-------------------------------------------------+------+-------------+
| id | select_type | table            | type   | possible_keys                                                       | key                               | key_len | ref                                             | rows | Extra       |
+----+-------------+------------------+--------+---------------------------------------------------------------------+-----------------------------------+---------+-------------------------------------------------+------+-------------+
|  1 | SIMPLE      | city_permissions | ref    | index_city_permissions_on_user_id,index_city_permissions_on_city_id | index_city_permissions_on_user_id | 5       | const                                           |    1 | Using where |
|  1 | SIMPLE      | cities           | eq_ref | PRIMARY                                                             | PRIMARY                           | 4       | barhopolis_development.city_permissions.city_id |    1 |             |
+----+-------------+------------------+--------+---------------------------------------------------------------------+-----------------------------------+---------+-------------------------------------------------+------+-------------+ 
```

这是 ActiveRecord 生成的 SQL `user.city_permissions`：

```
SELECT * FROM `city_permissions` WHERE (`city_permissions`.user_id = 1) 
```

使用该查询的 EXPLAIN 结果：

```
+----+-------------+------------------+------+-----------------------------------+-----------------------------------+---------+-------+------+-------------+
| id | select_type | table            | type | possible_keys                     | key                               | key_len | ref   | rows | Extra       |
+----+-------------+------------------+------+-----------------------------------+-----------------------------------+---------+-------+------+-------------+
|  1 | SIMPLE      | city_permissions | ref  | index_city_permissions_on_user_id | index_city_permissions_on_user_id | 5       | const |    1 | Using where |
+----+-------------+------------------+------+-----------------------------------+-----------------------------------+---------+-------+------+-------------+ 
```

看起来它**确实工作正常**。来自 MySQL 手册：

## eq_ref

对于先前表中的每个行组合，从该表中读取一行。除了 system 和 const 类型之外，这是最好的连接类型。当连接使用索引的所有部分并且索引是 PRIMARY KEY 或 UNIQUE 索引时使用它。

## 参考

对于先前表中的每个行组合，从该表中读取具有匹配索引值的所有行。如果连接仅使用键的最左侧前缀，或者如果键不是 PRIMARY KEY 或 UNIQUE 索引（换句话说，如果连接不能基于键值选择单行），则使用 ref。如果使用的键只匹配几行，这是一个很好的连接类型。

# c - Linux 中的 C 和现代实践/示例

> ID：223806
> 
> 赞同：5
> 
> 时间：2008-10-21T22:38:33.790
> 
> 标签：c, linux

我正在寻找大小适中的程序/项目，这些程序/项目展示了在 Linux 上用 C 语言开发应用程序的良好现代实践。我想通过例子来学习，并好奇在现实世界中事情是如何完成的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-21T23:30:31.673

[Unix 编程的艺术](http://www.faqs.org/docs/artu/ "Unix 编程的艺术")

一本好书，读起来简直是一种享受。即使您不是 *nix 程序员或 C 程序员，示例和案例研究也很棒。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T03:03:12.460

XMMS2 代码库相当年轻，是编码风格和技术的一个很好的例子，以现代但非常干净（它必须建立在许多平台上）的方式使用 C。

它包括一个具有跨平台通信的客户端-服务器模型、一个服务器内部的面向对象系统、一个复杂的插件系统、线程来满足馈送声卡的实时需求。这些插件还提供了整合第三方库的好例子。与导出的 API 相得益彰，该 API 还提供多种语言绑定（向您展示如何操作）。

您将看到 xmms2 代码中涵盖了许多不同的现代问题。代码库非常干净，到处都有很少的“旧代码”，仍然写得很好。

它还使用复杂的构建系统，开发人员严重依赖 git 的功能。因此，除了纯代码本身之外，还有更多需要学习的东西。如果您对代码有任何疑问，社区在 IRC 上非常活跃且乐于助人。

[http://xmms2.xmms.se](http://xmms2.xmms.se)

缺点：不小。但它是相对模块化的，尤其是服务器组件是不同的对象，因此您可以选择其中包含特定问题的部分并从中学习。甚至尝试编写自己的客户端、插件等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T23:42:38.090

警惕一些较大的项目。它们可能是遗留代码和其他疯狂的混合体。例如：不要以 Mozilla/Firefox 代码库为例，它是一个巨大的混乱（虽然慢慢变得更好）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T23:21:38.540

我的建议是选择巨大的。好的做法几乎不依赖于小项目，而对于一个大项目来说，好的做法主要是让你对一个人的小项目感到厌烦。

# database-design - 如何使用多个数据库挽救参照完整性

> ID：223809
> 
> 赞同：2
> 
> 时间：2008-10-21T22:39:21.137
> 
> 标签：database-design, integrity

我正在设计一个系统，该系统将用于为全国多个生产站点提供数据（所有信息都在一个站点中），并有可能添加更多。最初我认为我可以只使用一个数据库就可以逃脱。我现在正在重新考虑我的原始设计并倾向于一个更具可扩展性的解决方案。保持每个数据库/表的大小也很重要。

将有一个“主”数据库，其中包含跨越站点概念的信息，然后为每个站点创建一个单独的数据库，其中包含特定于站点的信息。

我的斗争是在哪里分离数据。这些数据都是相当相关的。无论我在哪里做，我都会失去一些参照完整性。我读到的所有内容都说要不惜一切代价避免这种情况，因为我认为这是非常好的理由，但我看不到解决办法。

我已经研究过触发器，但如果数据库位于不同的服务器上，我认为它们不会起作用（虽然不确定——我认为 Oracle 会这样做）。我仅限于开源解决方案，因此如果有帮助的话，它将是 MySQL 或 postgre。

有没有人有一些建议来缓解这个问题或有其他设计建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T23:44:09.897

在不了解您的具体情况的情况下，有点难以提供帮助 - 但这是我的直觉......

我猜你建议的信息应该放在你的“主”数据库中，可能比每个站点的数据库更稳定（对数据的更改次数很少）。

也许您可以查看一个解决方案，其中“主”数据库中的数据也存储在每个站点的数据库中。然后，您可以查看某种复制系统，以将对主数据库所做的更改传播到站点数据库。

这样，您仍然可以在每个站点的数据库中维护参照完整性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T23:37:54.560

MySQL 有[联合表](http://dev.mysql.com/doc/refman/5.0/en/federated-storage-engine.html)，但尚不清楚外键约束是否会在它们之间起作用。我有点怀疑——但应该触发。

否则，您必须将参照完整性上移一层 - 进入应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T23:54:42.280

你在说多少数据？你真的需要这种架构吗？数据库可以驱动大量容量。

“不要这样做”的警告来自艰难而痛苦的经历。分布式数据集的维护和管理真的很痛苦。所以，认真考虑一下。

也许考虑将数据分解为运营存储与报告存储或数据仓库，您可以每晚或每周提供它们（取决于您需要分析报告的最新程度）。许多运营数据存储不需要那么大。

关于仅在后端维护的表（例如，出于数据完整性目的）与那些经常由用户更新和添加的操作表，这也是一个不同的问题。可以认为更“静态”的表 - 只是静态的。如有必要，有一个可靠的过程可以在您的节点上更新它们，理想情况下，很少。

一旦您的数据分解到“动态”与“静态”表中，分区会更容易一些，因为您的静态数据可以根据需要进行单一主控和复制（从根实例），而分区存储是真实数据的单一来源用于为后端数据仓库和报告系统提供数据。然后几乎不需要实际的复制，而是更多的“它在哪台机器上”的问题，可以很容易地自动化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T00:11:08.440

如果正确理解您，您是否希望（也许）使用触发器来检查每次插入/更新/删除是否将参照完整性保留在远程数据库上？

如果是这样，我认为您应该避开这一点，我只是认为性能开销太大了。特别是如果您希望解决方案具有可扩展性。

我会担心数据是如何插入的，并且对此非常严格，您的应用程序逻辑应该涵盖这是一个高级别的细节。您可以运行每周报告以查看哪些数据不正确并查看其插入错误的原因等，但我认为如果您的应用程序正确完成，多数据库引用完整性将难以实施。

但不要误会我的意思，我 100% 保证数据处于稳定、稳健的状态，但有时这并不总是可执行的。

但正如前面所说，如果没有关于解决方案的更多信息，很难给出建议...... :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T00:40:58.800

让我看看我是否可以为问题域提供更好的概要：

希望创建一个“企业”解决方案，其中有 n 个生产站点，其中 n 将增加。

我们处理数据以创建 Web 和打印文档。

系统将管理流程以将数据文件从提交（通过集中式网站）到打印机或网络或两者兼而有之。

每个生产站点都有自己的客户等。所有这些信息都将存储在数据库中。该信息的大部分管理将在中心站点进行

由于我们使用的软件的许可限制，我们在一台服务器上处理所有数据。

所以会有一个守护进程查看队列（在数据库中）并处理作业。流将由数据库中的状态列控制，以便其他进程知道它在进程中的位置。

大量数据来自我们的网络工具。我们需要为我们为网络生成的每个文档存储搜索索引。这变得相当大相当快。这些记录不会永远保留，但至少在大多数情况下会很大（估计有 5 亿行）。

我认为摆脱表大小问题单独的数据库可能是答案以及在不同服务器上分离生产站点的能力。

问题是我不知道何时会收购另一个站点或它将有多大。

我想我想将可扩展性的东西扼杀在萌芽状态，而不是在一年后获得一个将我们推向边缘的网站，而不必购买更好的服务器来容纳这个怪物。不幸的是，金钱是一个对象。

如果增长不是未知数，我什至不会考虑数据库。

我还考虑过为每个站点完全创建单独的数据库。这使得我们的应用程序的管理以及其他问题变得更加困难。

我为漫不经心的回应道歉。这是一个12小时的一天。我真的可以永远继续下去，但希望无论如何都能提供更多的见解。

与一个数据库的示例关系

网站有很多客户 客户有很多提交者 提交者有很多提交 提交有很多文档 文档有很多索引

所以我可以通过连接轻松计算客户的文档数量

# javascript - 你让 Rails 生成多少 JavaScript？

> ID：223810
> 
> 赞同：9
> 
> 时间：2008-10-21T22:40:42.583
> 
> 标签：javascript, ruby-on-rails, ruby

Ruby on Rails 有很多方法可以生成 JavaScript。特别是在涉及 Ajax 时。不幸的是，我经常看到它生成的 JavaScript 存在一些问题。

*   Rails 通常使用内联事件处理。

    ```
    <a onclick="somejavascript(); return false;" /> 
    ```

    这通常是不受欢迎的，因为它与 XHTML 混合了行为。

*   生成的 JavaScript 也严重依赖 Prototype。就个人而言，我更喜欢 jQuery。

*   根据我的经验，许多 Rails 开发人员的态度是尽可能多地用 Ruby 编写代码。最后一步是生成一些非常程序化和重复的 JavaScript。通常，此代码最终会变得非常不灵活且难以调试。

所以，我的问题是：你为你的项目手动编写了多少 JavaScript，有多少是使用 Rails/Ruby 在服务器端生成的？或者有没有一种快乐的媒介可以让你同时获得两者的好处？有一个子问题：如果您手动编写大量 JavaScript，您使用什么技术将其融入 MVC 模型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T00:55:30.487

如果您更喜欢 jQuery，您可以使用[jQuery on Rails 项目](http://ennerchi.com/projects/jrails)。用 jQuery 替换 Prototype。

Rails 对 Javascript 生成所做的一些事情是好的，有些是坏的。在不好的情况下，自己编写并保持不引人注目。在任何给定时间，您对 Javascript Rails 生成感到不舒服，您都可以继续自己编写。

And be sure to check out this great intro to [unobtrusive Javascript](http://www.railsenvy.com/2008/1/3/unobtrusive-javascript) that was done with Rails in mind.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-21T23:14:37.633

我曾经在 Symfony（Rails 克隆）中工作，起初，我们使用了很多 Javascript 助手。客户需求导致我们（我！）不得不编写大量的帮助者无法生成的代码。我最终得出结论，我根本不喜欢使用助手**。**

在我看来，渐进式增强是要走的路。生成在不启用 JavaScript 的情况下工作的标准友好的 HTML，然后在文档就绪时添加花哨的功能。

顺便说一句，我也从 Prototype 切换到 jQuery 并且不想切换回来！在我看来，jQuery 更适合渐进增强。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T22:54:06.520

让 Rails 做尽可能多的事情。然后当你遇到问题时，开始用手工编码的版本重写它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T23:03:23.210

没有，如果需要，使用 jquery。Ajax 和 ie js 的 bug 很难追踪

# hosting - 网站后端的低成本技术架构

> ID：223829
> 
> 赞同：3
> 
> 时间：2008-10-21T22:46:23.853
> 
> 标签：hosting, bandwidth, cdn

我正在考虑在不久的将来开设一个网站，除了标准的域名注册费用外，我不确定如何进行。我预计数据量会非常大，并且查看许多虚拟主机似乎虽然它们可能会提供极高的带宽上限，但我被告知他们经常在您达到每月限制之前暂停帐户。

有什么方法可以将带宽密集型组件卸载到专门处理大量数据消耗的单独主机上，并将网站元素托管在标准帐户上。虽然我意识到拥有自己的一组服务器是最好的，但我试图在一开始就找到一种相对具有成本效益的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T22:47:48.607

查看[Amazon S3](http://aws.amazon.com/s3/)，我认为他们刚刚修改了定价模型......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T23:07:54.010

除了 S3，Cachefly 也可能是一个选项。Cachefly 相对来说是一个成本很低的 CDN。与 S3 相比，它更昂贵，但 Cachefly 还充当 CDN，而 S3 没有。

如果您的所有访问者都是美国/欧盟，那么 S3 可能是完美的。如果您有来自全球不同地区的访问者并且速度是一个问题，那么 CDN 可能会更好地为您服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T22:49:45.873

您可能需要查看 Amazon AWS 之类的东西。它们旨在帮助提高可扩展性，尤其是当您的带宽和空间需求可能变大时。[http://aws.amazon.com/](http://aws.amazon.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T23:07:30.160

看看使用[内容交付网络](http://en.wikipedia.org/wiki/Content_delivery_network)。

CDN 是一项服务，可让您将大型资产（想想图像或视频）托管到单独的主机上。您仍然可以从您的普通 Web 服务器运行您的网站，但带宽密集型托管由 CDN 处理。

它们还有其他好处，例如在全球拥有多台服务器，并将传入请求路由到离每个用户最近的服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T23:45:00.927

我支持将静态项目移动到单独的资产服务器的建议。据我所知，Cachefly 是一个不错的 CDN。

如果您想预先省钱，Velocix 提供“免费”CDN 服务，最高限额。

我要提出的另一个建议是，如果您使用任何 Javascript 框架来检查 Google 是否将它们作为 Google AJAX Lib API 的一部分托管。使用他们的基础设施快速加载库。

# c# - 检查字符串以查看是否所有字符都是十六进制值

> ID：223832
> 
> 赞同：63
> 
> 时间：2008-10-21T22:46:47.423
> 
> 标签：c#

在 C# 2.0 中检查字符串中的每个字符并在它们都是有效的十六进制字符时返回 true 否则返回 false 的最有效方法是什么？

### 例子

```
void Test()
{
    OnlyHexInString("123ABC"); // Returns true
    OnlyHexInString("123def"); // Returns true
    OnlyHexInString("123g"); // Returns false
}

bool OnlyHexInString(string text)
{
    // Most efficient algorithm to check each digit in C# 2.0 goes here
} 
```

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-10-21T22:55:26.313

像这样的东西：

（我不知道 C#，所以我不确定如何遍历字符串的字符。）

```
loop through the chars {
    bool is_hex_char = (current_char >= '0' && current_char <= '9') ||
                       (current_char >= 'a' && current_char <= 'f') ||
                       (current_char >= 'A' && current_char <= 'F');

    if (!is_hex_char) {
        return false;
    }
}

return true; 
```

**上面的逻辑代码**

```
private bool IsHex(IEnumerable<char> chars)
{
    bool isHex; 
    foreach(var c in chars)
    {
        isHex = ((c >= '0' && c <= '9') || 
                 (c >= 'a' && c <= 'f') || 
                 (c >= 'A' && c <= 'F'));

        if(!isHex)
            return false;
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2008-10-21T22:56:54.830

```
public bool OnlyHexInString(string test)
{
    // For C-style hex notation (0xFF) you can use @"\A\b(0[xX])?[0-9a-fA-F]+\b\Z"
    return System.Text.RegularExpressions.Regex.IsMatch(test, @"\A\b[0-9a-fA-F]+\b\Z");
} 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-10-21T22:55:07.283

您可以对字符串执行[TryParse](https://msdn.microsoft.com/en-us/library/zc2x2b1h%28v=vs.110%29.aspx)以测试整个字符串是否为十六进制数。

如果它是一个特别长的字符串，您可以将它分成块并循环遍历它。

```
// string hex = "bacg123"; Doesn't parse
// string hex = "bac123"; Parses
string hex = "bacg123";
long output;
long.TryParse(hex, System.Globalization.NumberStyles.HexNumber, null, out output); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-21T22:51:33.170

我`Int32.TryParse()`用来做这个。 [这是 MSDN 页面](http://msdn.microsoft.com/en-us/library/zf50za27(VS.80).aspx)。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-04-03T21:11:42.480

只是：

`bool isHex = text.All("0123456789abcdefABCDEF".Contains);`

这基本上是说：检查`text`字符串中的所有字符是否确实存在于有效的十六进制值字符串中。

这对我来说是最简单的仍然可读的解决方案。

（不要忘记添加`using System.Linq;`）

**编辑：**
刚刚注意到[`Enumerable.All()`](https://msdn.microsoft.com/en-us/library/bb548541(v=vs.90).aspx)仅在 .NET 3.5 之后才可用。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-04-25T17:21:26.217

这是上面[yjerem](https://stackoverflow.com/users/813/yjerem)解决方案的 LINQ 版本：

```
private static bool IsValidHexString(IEnumerable<char> hexString)
{
    return hexString.Select(currentCharacter =>
                (currentCharacter >= '0' && currentCharacter <= '9') ||
                (currentCharacter >= 'a' && currentCharacter <= 'f') ||
                (currentCharacter >= 'A' && currentCharacter <= 'F')).All(isHexCharacter => isHexCharacter);
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-11-06T02:22:13.657

[发布Jeremy's answer](https://stackoverflow.com/q/223832/482691#223854)的 VB.NET 版本，因为我是在寻找这样的版本时来到这里的。应该很容易将其转换为 C#。

```
''' <summary>
'''   Checks if a string contains ONLY hexadecimal digits.
''' </summary>
''' <param name="str">String to check.</param>
''' <returns>
'''   True if string is a hexadecimal number, False if otherwise.
''' </returns>
Public Function IsHex(ByVal str As String) As Boolean
    If String.IsNullOrWhiteSpace(str) Then _
        Return False

    Dim i As Int32, c As Char

    If str.IndexOf("0x") = 0 Then _
        str = str.Substring(2)

    While (i < str.Length)
        c = str.Chars(i)

        If Not (((c >= "0"c) AndAlso (c <= "9"c)) OrElse
                ((c >= "a"c) AndAlso (c <= "f"c)) OrElse
                ((c >= "A"c) AndAlso (c <= "F"c))) _
        Then
            Return False
        Else
            i += 1
        End If
    End While

    Return True
End Function 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-01-27T00:39:28.267

在最好的情况下，正则表达式并不是很有效。最有效的方法是使用普通`for`循环搜索字符串的字符，并在找到的第一个无效字符处中断。

但是，它可以用[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)非常简洁地完成：

```
bool isHex = 
    myString.ToCharArray().Any(c => !"0123456789abcdefABCDEF".Contains(c)); 
```

我不能保证效率，因为 LINQ 是 LINQ，但是 Any() 应该有一个非常优化的编译方案。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-11-06T02:39:14.527

就性能而言，最快的可能是简单地枚举字符并进行简单的比较检查。

```
bool OnlyHexInString(string text) {
  for (var i = 0; i < text.Length; i++) {
    var current = text[i];
    if (!(Char.IsDigit(current) || (current >= 'a' && current <= 'f'))) {
      return false;
    }
  }
  return true;
} 
```

要真正知道哪种方法最快，尽管您需要进行一些分析。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-08-26T20:57:26.103

```
 //Another workaround, although RegularExpressions is the best solution
     boolean OnlyHexInString(String text)
    {
      for(int i = 0; i < text.size(); i++)
        if( !Uri.IsHexDigit(text.charAt(i)) )
          return false;
      return true;
    } 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-21T22:53:22.013

就*程序员时间*而言，最好调用您平台的字符串到整数解析函数（例如 Java 的*Integer.parseInt(str, base)*），看看是否有异常。如果您想自己编写它，并且可能更节省时间/空间......

我想最有效的是每个字符的查找表。您将有一个 2^8（对于 Unicode 为 2^16）条目的布尔数组，如果它是有效的十六进制字符，则每个数组都为*真，否则为**假*。代码看起来像（在 Java 中，抱歉 ;-)：

```
boolean lut[256]={false,false,true,........}

boolean OnlyHexInString(String text)
{
  for(int i = 0; i < text.size(); i++)
    if(!lut[text.charAt(i)])
      return false;
  return true;
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-06-18T16:57:57.850

没有正则表达式的简单解决方案是：

VB.NET：

```
Public Function IsHexString(value As String) As Boolean
    Dim hx As String = "0123456789ABCDEF"
    For Each c As Char In value.ToUpper
        If Not hx.Contains(c) Then Return False
    Next
    Return True
End Function 
```

或者在 C# 中

```
public bool IsHexString(string value)
{
    string hx = "0123456789ABCDEF";
    foreach (char c in value.ToUpper()) {
        if (!hx.Contains(c))
        return false;
    }
    return true;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-21T23:02:14.583

这可以通过正则表达式来完成，这是一种检查字符串是否与特定模式匹配的有效方法。

十六进制数字的可能正则表达式是 [A-Ha-h0-9] *，一些实现甚至具有十六进制数字的特定代码，例如 [[:xdigit:]]*。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-06-22T16:19:08.617

您可以使用以下方式扩展字符串和字符：

```
 public static bool IsHex(this string value)
    {   return value.All(c => c.IsHex()); }

    public static bool IsHex(this char c)
    {
        c = Char.ToLower(c);
        if (Char.IsDigit(c) || (c >= 'a' && c <= 'f'))
            return true;
        else
            return false;
    } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-07-16T13:31:01.783

我使用这种方法：

```
public static bool IsHex(this char c)
{
  return   (c >= '0' && c <= '9') ||
           (c >= 'a' && c <= 'f') ||
           (c >= 'A' && c <= 'F');
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-04-19T10:48:25.990

这作为 C# 扩展方法......

```
public static class StringExtensions
{
    public static bool IsHexString(this string str)
    {
        foreach (var c in str)
        {
            var isHex = ((c >= '0' && c <= '9') ||
                          (c >= 'a' && c <= 'f') ||
                          (c >= 'A' && c <= 'F'));

            if (!isHex)
            {
                return false;
            }
        }

        return true;
    }

    //bonus, verify whether a string can be parsed as byte[]
    public static bool IsParseableToByteArray(this string str)
    {
        return IsHexString(str) && str.Length % 2 == 0;
    }
} 
```

像这样使用它...

```
if("08c9b54d1099e73d121c4200168f252e6e75d215969d253e074a9457d0401cc6".IsHexString())
{
    //returns true...
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-05-08T10:09:05.123

我做了这个解决方案来解决这个问题。在执行之前检查请求字符串不为空。

```
for (int i = 0; i < Request.Length; i += 2)
  if (!byte.TryParse(string.Join("", Request.Skip(i).Take(2)), NumberStyles.HexNumber, CultureInfo.InvariantCulture, out _)) return false; 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-11-30T07:39:58.743

```
public static bool HexInCardUID(string test)
        {
            if (test.Trim().Length != 14)
                return false;
            for (int i = 0; i < test.Length; i++)
                if (!Uri.IsHexDigit(Convert.ToChar(test.Substring(i, 1))))
                    return false;
            return true;
        }**strong text** 
```

* * *

## 回答 #19

> 赞同：-4
> 
> 时间：2012-06-21T17:07:35.497

现在只

```
if (IsHex(text)) {
    return true;
} else {
    return false;
} 
```

# css - @media 中的 @import 在 Firefox 3.0.3 中不起作用

> ID：223833
> 
> 赞同：5
> 
> 时间：2008-10-21T22:47:01.277
> 
> 标签：css, media, firefox-3

这就是我所拥有的，它适用于 IE7，但不适用于 Firefox：

```
@media screen { @import 'screen.css'; } 
```

它在 Firefox 中的 @media 块之外工作：

```
@import 'screen.css'; 
```

**更新：**

这有效：

```
@media screen { 

    .yui-d3f
    {
        border: 1px solid #999;
        height: 250px;
    }

} 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-22T02:30:03.603

Firefox 遵循 CSS2 规范，而 IE 则玩得又快又松。

确切的原因是`@import`指令必须是可选指令之后的第一个`@charset`指令。它们不能出现在任何块内。如果您希望`@import`仅适用于一种媒体类型，请在导入的 URI 之后指定。

这是 CSS2 规范的相关部分：[6.3`@import`规则](http://www.w3.org/TR/CSS2/cascade.html#at-import "6.3 @import 规则")。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T23:35:40.337

好的，所以 Firefox 不喜欢我选择的方法，赞成：

```
@import 'stylesheet.css' media_type; 
```

但是 IE7 不理解这种方法，但这可能很好：

```
@import 'firefox-screen.css' screen;
@media screen { @import 'IE7-screen.css'; } 
```

# vb.net - VB.NET Nullable 语法的历史

> ID：223844
> 
> 赞同：5
> 
> 时间：2008-10-21T22:51:42.030
> 
> 标签：vb.net, syntax, nullable

我找不到明确的答案。从 C# 2.0 开始，您已经能够声明

```
int? i = 125; 
```

作为简写

```
Nullable<int> i = Nullable<int>(123); 
```

我记得在某处读到 VB.NET 不允许此快捷方式。但是，瞧，我今天在 VS 2008 中尝试过它并且它有效。

有谁知道自 .NET 2.0 以来是这种方式还是后来添加的？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-22T00:51:32.710

*System.Nullable 是在 .Net 2.0 中引入的，可作为泛型类型*用于 VB 。您只是不能使用可为空的语法。所以在 VS 2005 中你可以这样做：

```
Dim x as Nullable(of Integer) 
```

我不知道空等价和装箱是否适用于 VB 2005 中的可空值，但我怀疑答案是肯定的，因为 .Net 团队对 2.0 CLR 进行了更改以使用可空值实现装箱。我想VB会利用这一点。

在 2008 年，您显然可以这样做：

```
Dim x as Integer? 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T16:12:14.070

它在 VB 2005 (dotnet 2.0) 中工作，但它很丑。

您不能像普通变量一样使用它，我认为它可能像 Object 类型一样工作，但事实并非如此。

而不是这样：

```
dim oInt as object

dim i as integer

if oInt is nothing then 

    msgbox("int is null")
else

    i = cint(oInt)

end if 
```

你有这个。

```
Dim oInt as nullable(of integer)

dim i as integer

if oInt.HasValue = false then 

    msgbox("int is null")

else

   i = oInt.Value

end if 
```

这里的问题是，如果您的变量为 null 并且您碰巧调用了 Value 属性，则会引发未处理的异常。

例如，我最喜欢的是这个。

```
AddParamToSQLCmd(sqlCmd, "@SomeID", SqlDbType.Int, 0, ParameterDirection.Input, iif(oInt.HasValue, oInt.Value, DBNull.value)) 
```

当您的 Supposed Nullable 值为 null 时将导致运行时错误！！！

所以这里是可空的（整数）与对象代码

可空（整数）

```
if oInt.HasValue then 
    AddParamToSQLCmd(sqlCmd, "@SomeID", SqlDbType.Int, 0, ParameterDirection.Input, oInt.Value)
else
    AddParamToSQLCmd(sqlCmd, "@SomeID", SqlDbType.Int, 0, ParameterDirection.Input, dbnull.value)
end if 
```

目的

```
AddParamToSQLCmd(sqlCmd, "@SomeID", SqlDbType.Int, 0, ParameterDirection.Input, oInt) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-08T12:09:05.393

IIRC，可空类型是在很晚的阶段在 .NET 2.0 中引入的。C# 编译器团队设法为它们提供了比 VB.NET 团队更多的语言支持。VB.NET 团队或多或少地赶上了 VS2008。这就是为什么您可以在 C# 2.0 中使用 == 运算符比较可空值，而在 VB.NET 中您必须忍受 Nullable.Equals() 方法。嗯。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T22:54:00.997

我不知道历史，但是是的，它是 VS 2008 的增强。

# python - 优雅的结构化文本文件解析

> ID：223866
> 
> 赞同：21
> 
> 时间：2008-10-21T23:00:20.767
> 
> 标签：python, ruby, perl, text-parsing

我需要解析实时聊天对话的记录。我看到文件的第一个想法是在问题上抛出正则表达式，但我想知道人们使用了哪些其他方法。

我在标题中加上了优雅，因为我之前发现这种类型的任务存在仅依靠正则表达式难以维护的危险。

成绩单由 www.providesupport.com 生成并通过电子邮件发送到一个帐户，然后我从电子邮件中提取纯文本成绩单附件。

解析文件的原因是提取对话文本以备后用，同时识别访问者和操作员的姓名，以便可以通过 CRM 提供信息。

以下是转录文件的示例：

```
Chat Transcript

Visitor: Random Website Visitor 
Operator: Milton
Company: Initech
Started: 16 Oct 2008 9:13:58
Finished: 16 Oct 2008 9:45:44

Random Website Visitor: Where do i get the cover sheet for the TPS report?
* There are no operators available at the moment. If you would like to leave a message, please type it in the input field below and click "Send" button
* Call accepted by operator Milton. Currently in room: Milton, Random Website Visitor.
Milton: Y-- Excuse me. You-- I believe you have my stapler?
Random Website Visitor: I really just need the cover sheet, okay?
Milton: it's not okay because if they take my stapler then I'll, I'll, I'll set the building on fire...
Random Website Visitor: oh i found it, thanks anyway.
* Random Website Visitor is now off-line and may not reply. Currently in room: Milton.
Milton: Well, Ok. But… that's the last straw.
* Milton has left the conversation. Currently in room:  room is empty.

Visitor Details
---------------
Your Name: Random Website Visitor
Your Question: Where do i get the cover sheet for the TPS report?
IP Address: 255.255.255.255
Host Name: 255.255.255.255
Referrer: Unknown
Browser/OS: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; .NET CLR 1.1.4322; InfoPath.1; .NET CLR 2.0.50727) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-21T23:25:53.397

不，实际上，对于您描述的特定类型的任务，我怀疑是否有比正则表达式“更清洁”的方法。看起来您的文件已经嵌入了换行符，所以通常我们在这里要做的是将行作为分解单元，应用每行正则表达式。同时，您创建一个小型状态机并使用正则表达式匹配来触发该状态机中的转换。这样您就知道您在文件中的位置，以及您可以期待哪些类型的字符数据。此外，考虑使用命名捕获组并从外部文件加载正则表达式。这样，如果您的成绩单格式发生变化，只需调整正则表达式即可，而不是编写新的特定于解析的代码。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-22T03:01:20.187

使用 Perl，您可以使用[Parse::RecDescent](http://search.cpan.org/perldoc?Parse::RecDescent)

这很简单，您的语法将在以后维护。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-22T00:23:33.343

您可能需要考虑一个完整的解析器生成器。

正则表达式非常适合在文本中搜索小子字符串，但如果您真的有兴趣将整个文件解析为有意义的数据，它们的功能就会严重不足。

如果子字符串的上下文很重要，它们尤其不足。

大多数人在所有事情上都使用正则表达式，因为他们知道这一点。他们从未学习过任何解析器生成工具，他们最终编写了许多生产规则组合和语义动作处理，您可以使用解析器生成器免费获得这些内容。

正则表达式很棒，但如果您需要解析器，它们是无可替代的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-11-01T16:17:57.083

这是两个基于[`lepl`](http://www.acooke.org/lepl/)解析器生成器库的解析器。它们都产生相同的结果。

```
from pprint import pprint
from lepl import AnyBut, Drop, Eos, Newline, Separator, SkipTo, Space

# field = name , ":" , value
name, value = AnyBut(':\n')[1:,...], AnyBut('\n')[::'n',...]    
with Separator(~Space()[:]):
    field = name & Drop(':') & value & ~(Newline() | Eos()) > tuple

header_start   = SkipTo('Chat Transcript' & Newline()[2])
header         = ~header_start & field[1:] > dict
server_message = Drop('* ') & AnyBut('\n')[:,...] & ~Newline() > 'Server'
conversation   = (server_message | field)[1:] > list
footer_start   = 'Visitor Details' & Newline() & '-'*15 & Newline()
footer         = ~footer_start & field[1:] > dict
chat_log       = header & ~Newline() & conversation & ~Newline() & footer

pprint(chat_log.parse_file(open('chat.log'))) 
```

### 更严格的解析器

```
from pprint import pprint
from lepl import And, Drop, Newline, Or, Regexp, SkipTo

def Field(name, value=Regexp(r'\s*(.*?)\s*?\n')):
    """'name , ":" , value' matcher"""
    return name & Drop(':') & value > tuple

Fields = lambda names: reduce(And, map(Field, names))

header_start   = SkipTo(Regexp(r'^Chat Transcript$') & Newline()[2])
header_fields  = Fields("Visitor Operator Company Started Finished".split())
server_message = Regexp(r'^\* (.*?)\n') > 'Server'
footer_fields  = Fields(("Your Name, Your Question, IP Address, "
                         "Host Name, Referrer, Browser/OS").split(', '))

with open('chat.log') as f:
    # parse header to find Visitor and Operator's names
    headers, = (~header_start & header_fields > dict).parse_file(f)
    # only Visitor, Operator and Server may take part in the conversation
    message = reduce(Or, [Field(headers[name])
                          for name in "Visitor Operator".split()])
    conversation = (message | server_message)[1:]
    messages, footers = ((conversation > list)
                         & Drop('\nVisitor Details\n---------------\n')
                         & (footer_fields > dict)).parse_file(f)

pprint((headers, messages, footers)) 
```

输出：

```
({'Company': 'Initech',
  'Finished': '16 Oct 2008 9:45:44',
  'Operator': 'Milton',
  'Started': '16 Oct 2008 9:13:58',
  'Visitor': 'Random Website Visitor'},
 [('Random Website Visitor',
   'Where do i get the cover sheet for the TPS report?'),
  ('Server',
   'There are no operators available at the moment. If you would like to leave a message, please type it in the input field below and click "Send" button'),
  ('Server',
   'Call accepted by operator Milton. Currently in room: Milton, Random Website Visitor.'),
  ('Milton', 'Y-- Excuse me. You-- I believe you have my stapler?'),
  ('Random Website Visitor', 'I really just need the cover sheet, okay?'),
  ('Milton',
   "it's not okay because if they take my stapler then I'll, I'll, I'll set the building on fire..."),
  ('Random Website Visitor', 'oh i found it, thanks anyway.'),
  ('Server',
   'Random Website Visitor is now off-line and may not reply. Currently in room: Milton.'),
  ('Milton', "Well, Ok. But… that's the last straw."),
  ('Server',
   'Milton has left the conversation. Currently in room:  room is empty.')],
 {'Browser/OS': 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; .NET CLR 1.1.4322; InfoPath.1; .NET CLR 2.0.50727)',
  'Host Name': '255.255.255.255',
  'IP Address': '255.255.255.255',
  'Referrer': 'Unknown',
  'Your Name': 'Random Website Visitor',
  'Your Question': 'Where do i get the cover sheet for the TPS report?'}) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-22T00:03:23.323

[构建解析器](http://pyparsing.wikispaces.com/)？我无法确定您的数据是否足够定期，但可能值得研究。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-21T23:18:14.210

使用多行注释正则表达式可以在一定程度上缓解维护问题。尽量避免使用单行超级正则表达式！

此外，考虑将正则表达式分解为单独的任务，每个任务对应您想要获得的每个“事物”。例如。

```
visitor = text.find(/Visitor:(.*)/)
operator = text.find(/Operator:(.*)/)
body = text.find(/whatever....) 
```

代替

```
text.match(/Visitor:(.*)\nOperator:(.*)...whatever to giant regex/m) do
  visitor = $1
  operator = $2
  etc.
end 
```

然后，它可以轻松更改任何特定项目的解析方式。至于解析具有许多“聊天块”的文件，只需一个简单的正则表达式匹配单个聊天块，迭代文本并将匹配数据从中传递给您的其他匹配器组。

这显然会影响性能，但除非您处理*大量*文件，否则我不会担心。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-22T17:05:41.823

我使用过 Paul McGuire 的 pyParsing 类库，我一直对它印象深刻，因为它文档齐全、易于上手，而且规则易于调整和维护。顺便说一句，规则在您的 python 代码中表示。显然，日志文件有足够的规律性将每一行作为一个独立的单元进行解析。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-22T00:36:12.943

考虑使用 Ragel [https://www.colm.net/open-source/ragel/](https://www.colm.net/open-source/ragel/)

这就是引擎盖下的杂种力量。多次解析字符串会大大减慢速度。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-22T00:11:12.963

只是一个快速的帖子，我只看了你的成绩单示例，但我最近也不得不研究文本解析，并希望避免走手动解析的路线。我确实遇到了[Ragel](http://www.complang.org/ragel/)，我才刚刚开始了解它，但它看起来非常有用。

# java - 登录 Eclipse/OSGi 插件

> ID：223875
> 
> 赞同：22
> 
> 时间：2008-10-21T23:02:49.293
> 
> 标签：java, eclipse, logging, osgi

我开始开发一个 Eclipse 插件（从技术上讲，一个 OSGi 插件），我遇到的第一个问题是我似乎无法像往常一样控制公共日志输出。

我在插件依赖项中包含了 commons-logging 包，实际上，当我记录某些内容（在 INFO 或更高严重性下）时，它会记录到控制台。但是，我似乎无法在任何较低级别（例如 DEBUG 或 TRACE）登录。

我指定了一个 log4j.properties 文件，它位于类路径中（对于运行时，就像 commons-logging 包一样），但该属性文件中的任何设置都不会影响记录器的行为。

这是 log4j.properties 文件：

```
#  Log4j Logging levels, in order of decreasing importance are:
#   FATAL, ERROR, WARN, INFO, DEBUG, TRACE
#

# Root logger option
log4j.rootLogger=ERROR,stdout
#,LOGFILE

# Direct log messages to stdout
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.Target=System.out
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d{ABSOLUTE} %5p %r (%l) %t%n - %m%n 
```

我需要做什么才能真正控制记录器的输出？

以下是一些示例输出消息，希望格式可能与 java.util.logging 的默认值一致，或向某人提供其他提示：

```
Oct 21, 2008 11:01:23 PM com.stottlerhenke.sentinel.client.Activator start
SEVERE: fatal_message
Oct 21, 2008 11:01:23 PM com.stottlerhenke.sentinel.client.Activator start
WARNING: warn_message
Oct 21, 2008 11:01:23 PM com.stottlerhenke.sentinel.client.Activator start
INFO: info_message 
```

**更新：**

我现在尝试了以下各种组合：

*   org.osgi.service.log.LogService 等。
*   [slf4j](http://www.slf4j.org/)
*   [日志4J](http://logging.apache.org/log4j/)
*   [共享日志](http://commons.apache.org/logging/)
*   [java.util.logging](http://java.sun.com/j2se/1.4.2/docs/api/java/util/logging/package-summary.html)

如果我在提示符下手动运行 OSGi（这对于我正在开发的东西是不切实际的），我*只能获得 DEBUG 或更低级别的消息。*此外，我无法通过各种属性文件影响任何其他类型的日志记录配置。我在这方面尝试的一切似乎都被日食设置所覆盖。

[我还尝试将上述库的各种配置文件放在许多地方，包括按照此处](http://www.eclipsezone.com/eclipse/forums/t99588.html)的建议作为附加到各自库的插件片段，但仍然会发生相同的结果。

我已经实现了一个自定义 LogListener，并使用 System.out.println 跟踪了日志消息的整个路径（无论如何我都知道如何），并且调试消息*一直*存在，直到它们被任何底层日志记录 API 输出我正在使用，然后它们消失了。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-24T22:53:48.317

3天后...

我发现了问题！我需要做两件事，首先，一个 MANIFEST.MF 文件有问题：

我在一个捆绑包的 MANIFEST.MF 中有以下内容：

```
Bundle-ClassPath: lib/jena.jar,
 .,
 org.apache.log4j-1.2.12.jar,
 lib/google-collect-snapshot.jar
Import-Package: com.acme.client.translation,
 com.acme.translation.interfaces,
 com.acme.shared.osgi,
 com.acme.utilities 
```

那*应该*是这样的：

```
Bundle-ClassPath: lib/jena.jar,
 .,
 lib/google-collect-snapshot.jar
Import-Package: com.acme.client.translation,
 com.acme.client.translation.interfaces,
 com.acme.shared.osgi,
 com.acme.utilities,
 org.apache.log4j 
```

主要区别在于 log4j 被用作一个包，而它应该被用作一个包。（当我期望 Log4j 与 OSGi 一起“正常工作”时，我的 lib 目录中有一个 log4j jar。）这个 jar*确实*可以工作。它显然找到了一些 eclipse 级别的 log4j 配置，并利用了它。由于它只是一个 jar（不是包），它没有使用任何可以指定自定义日志记录配置的片段，这导致我们不得不发生另一件事：

我需要设置一个包片段来指定日志配置。 [VonC的](https://stackoverflow.com/questions/223875/logging-in-eclipseosgi-plugins#224821)[此链接](http://www.eclipsezone.com/eclipse/forums/t99588.html)为我提供了执行此操作的信息。这需要做很多事情，不幸的是，带有不正确 MANIFEST.MF 的包仍然在 Bundle-ClassPath 中指定了 log4j jar，这似乎覆盖了 Import-Package 列表。

我终于弄清楚了当我需要登录另一个包时发生了什么（我刚刚放弃，并回到使用警告级别和更高级别的日志。）这个新包找不到日志配置！（所以我在同一个 OSGi 环境中运行了三个包，每个包都有不同的 log4j 行为——一个使用我的片段设置，另一个使用一些随机 Eclipse 日志记录设置，最后是没有任何日志记录配置的新包。）这三个包的详细比较揭示了Manifest.MF文件的差异，现在它们都使用了片段包。

我*非常*感谢[Eclipse Zone](http://www.eclipsezone.com/eclipse/forums/t99588.html)、[VonC](https://stackoverflow.com/questions/223875/logging-in-eclipseosgi-plugins#224821)、[Ekkes](http://ekkes-corner.blogspot.com/2008/09/logging-in-osgi-enterprise-applications.html)的作者以及 freenode 上#eclipse 中的每个人的帮助和耐心:)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-22T08:14:01.570

这不是您问题的实际答案，但您可能会在[ekke 的这组文章](http://ekkescorner.wordpress.com/blog-series/osgi-apps/)中找到一些线索。

我想您已经阅读了“[在 Eclipse Equinox/OSGi 中使用 Log4J](http://www.eclipsezone.com/eclipse/forums/t99588.html) ”：

您是否在控制台模式下启动了 osgi 会话？

```
java -jar org.eclipse.osgi_3.3.0.v20070530.jar -console -noExit -clean 
```

这样，您可以在纯 osgi 环境中测试 log4j 并检查它是否在那里工作。

让使用知道您是否找到解决方案（将其作为答案发布），我会投票；）

# unit-testing - 如何在测试中避免重复代码并避免嘲笑自己？

> ID：223878
> 
> 赞同：1
> 
> 时间：2008-10-21T23:04:33.970
> 
> 标签：unit-testing, mocking, code-duplication

在我的问题[中，作为“mockist” TDD 从业者，我是否应该在与被测方法相同的类中模拟其他方法？](https://stackoverflow.com/questions/184729/as-a-mockist-tdd-practitioner-should-i-mock-other-methods-in-the-same-class-as), [Avdi](https://stackoverflow.com/users/20487/avdi)回答说：“我个人认为嘲笑 self 几乎总是一种代码味道。它是在测试实现而不是行为。” 他可能是对的，但我常常无法区分实现和行为。

我有另一个示例（在 Python 样式的伪代码中）可能会导致有用的答案：

```
class Consumer:

    def spec_dirpath:
        client = VCS.get_connection(self.vcs_client_name)
        client.sync()
        return client.dirpath()

    def spec_filepath:
        filepath = os.path.join(spec_dirpath(), self.spec_filename)
        if not os.path.exists(filepath):
            raise ConsumerException
        return filepath

    def get_components:
        return Components.get_components_from_spec_file(self.spec_filepath()) 
```

这里的想法是 get_components 方法调用 spec_filepath 方法以获取 get_components_from_spec_file 组件类方法将从中读取组件列表的文件的路径。spec_filepath 方法依次调用spec_dirpath，它从VCS 系统同步包含spec 文件的目录并返回该目录的路径。（尽量不要在这段代码中寻找错误——毕竟它是伪代码。）

我正在寻找有关如何测试这些方法的建议...

测试 spec_dirpath 应该非常简单。我可以模拟 VCS 类并让它返回一个模拟对象并确认调用了适当的方法（并且 spec_dirpath 方法返回模拟的 dirpath 方法返回的内容）。

但是，如果我在测试 spec_filepath 时不模拟 spec_dirpath，如何避免在 spec_filepath 测试中从 spec_dirpath 代码中复制相同的测试代码？如果我在测试 get_components 时不模拟 spec_filepath，如何避免从 spec_filepath*和*spec_dirpath 复制测试代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T23:13:57.650

通常在单元测试中，行为是指外部可观察到的行为。

使用您的示例，可观察到的行为将是您从 get 返回的组件列表。它们来自文件的事实是实现，因此我建议围绕您返回的组件列表构建您的测试，而不要模拟文件检索，因为它是类内部的，并使用设置代码提供适当的文件。

另一种方法是制作从类的依赖项加载组件的文件，例如，使其成为构造函数参数或方法参数，以允许在类外部指定文件。在这种情况下，它将是外部的，所以我会模拟它以确保您从中获得一致的行为，以确保您的班级正确使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T00:07:52.487

单元测试更适合某种形式的依赖注入。在这种情况下，因为您在代码中创建客户端，所以您在测试中创建了一个依赖项，需要某种形式的动态模拟来处理。（在这种情况下，我们将使用部分模拟来模拟创建依赖项的调用，以避免也必须测试这些依赖项）。

如果您在启动时注入依赖项（即传入客户端对象），那么您可以轻松地模拟它，并且只测试一个类不会遇到重大困难。

因此，您需要部分模拟或依赖注入解决方案来满足这些目标。

# opengl - 使用gldrawpixels的opengl旋转

> ID：223894
> 
> 赞同：4
> 
> 时间：2008-10-21T23:12:23.253
> 
> 标签：opengl, rotation, gldrawpixels

我的团队目前仅限于在opengl 1.4平台上绘制图像，这意味着我们不能使用任何漂亮的纹理映射来绘制图像（是的，我们仅限于使用intel集成图形平台，这很烦人）。到目前为止，我们能够绘制、缩放和翻转图像，但是做图形的人声称在使用 glDrawPixels 时无法通过 glRotate 进行旋转，我们必须使用纹理等等，这在英特尔平台上不起作用。

我和他打赌午餐有一个旋转功能，比如 glRotate，它适用于直接位图。有这样的功能吗？glRotate 会起作用吗？我对这个图形的东西有点新手，但是库不允许位图旋转，除非通过纹理旋转，这似乎很可笑。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-21T23:23:51.187

您不能将 glRotate 与 glDrawPixels 一起使用。

glDrawPixels 是迄今为止将像素放到屏幕上的最差和性能最低的方法。您甚至可以通过使用糟糕的软件光栅化器将像素放到屏幕上来获得更好的性能。

简而言之，glDRawPixels 会将像素数据从进程内存复制到图形内存，并会进行一些非常简单的转换，例如翻转和缩放。所有更高级的东西（如旋转）都需要您实际使用图形芯片组的功能。例如，您必须使用纹理。

纹理确实有效。它们还适用于 GL 1.4 和 Intel 图形芯片组。我自己在这样的芯片组上工作了很长一段时间。您不会获得现代 ATI 或 NVIDIA 芯片组的性能，但它们也没有**那么**糟糕。

我最好的选择是，有人试图创建非两倍大小的纹理，但没有这样做，并决定纹理通常不适用于芯片组。

这不是真的。他们确实工作。您只需要知道 OpenGL 要求您以二维的幂创建纹理，并且您必须使用较大纹理的子矩形或将多个图像放入一个非常大的纹理（后者称为纹理图集）。

您可以通过调整纹理坐标来补偿较大纹理中的较小图像。

# windows - 如何在 Windows 上为 SSL 配置 Apache？

> ID：223901
> 
> 赞同：0
> 
> 时间：2008-10-21T23:16:03.480
> 
> 标签：windows, apache, ssl

启用 ssl 模块的代码后，当我们尝试重新启动 Apache 时，Apache 无法启动并显示 NO 错误消息。

注意：我能够使用 OpenSSL 生成请求并拥有合法的通配符证书并在 httpd.conf 中引用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T10:55:39.323

Windows 上的 Apache 在启动失败时写入 Windows 事件日志，而不是 ErrorLog。你检查了事件查看器吗？

# java - 你如何处理java中的“超级”泛型？

> ID：223902
> 
> 赞同：5
> 
> 时间：2008-10-21T23:17:25.990
> 
> 标签：java, generics

采取以下泛型示例

```
import java.util.List;
import java.util.ArrayList;

public class GenericsTest {
    private List<Animal> myList;

    public static void main(String args[]) {
        new GenericsTest(new ArrayList<Animal>()).add(new Dog());
    }

    public GenericsTest(List<Animal> list) {
        myList = list;
    }

    public void add(Animal a) {
      myList.add(a);
    }

    public interface Animal {}
    public static class Dog implements Animal {}
    public static class Cat implements Animal {}
} 
```

它工作正常。但如你所知，你不能用

```
new GenericsTest(new ArrayList<Dog>()); 
```

因为，如您所知， add(Animal) 将使添加`Cat`s 成为可能。解决这个问题的*建议*方法，即通配符也不起作用，因为，是的，你可以改变 every `List<Animal>`in`List<? extends Animal>`但它有同样的问题：你可以创建`GenericsTest`with`List<Cat>`然后添加`Dog`s。

所以我的问题是：有没有一种方便的方法来编写这个类，然后尽可能地使用它`Animals`？当然它应该直接解决上述问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-21T23:25:35.613

如果我了解您要做什么，那么您需要将泛型类型放在类级别：

```
public class GenericsTest<T extends Animal>
{
  private List<T> myList;

  public static void main(String args[])
  {
    new GenericsTest<Dog>(new ArrayList<Dog>());
  }

  public GenericsTest(List<T> list)
  {
    myList = list;
  }

  public void add(T a)
  {
    myList.add(a);
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T23:28:35.390

您可能希望使**整个**类通用，而不仅仅是参数：

```
import java.util.List;
import java.util.ArrayList;

public class GenericsTest<T extends Animal> {
    private final List<T> myList;

    public static void main(final String args[]) {
        new GenericsTest<Animal>(new ArrayList<Animal>()).add(new Dog());
        new GenericsTest<Dog>(new ArrayList<Dog>()).add(new Dog());
        new GenericsTest<Cat>(new ArrayList<Cat>()).add(new Cat());
    }

    public GenericsTest(final List<T> list) {
        myList = list;
    }

    public void add(final T a) {
      myList.add(a);
    }
}

// Can't nest as Animal needs to be in scope of class declaration
interface Animal {}
class Dog implements Animal {}
class Cat implements Animal {} 
```

# corporate-policy - 您如何在企业编码环境中生存？

> ID：223915
> 
> 赞同：9
> 
> 时间：2008-10-21T23:21:51.957
> 
> 标签：corporate-policy

我在一家小型软件商店工作，里面混合了内部产品和外部咨询。在过去的几年里，我一直在办公室和其他一群极客一起开发内部应用程序。相当悠闲和富有成效。几乎完美的编码条件：

*   好设备
*   安静、专注的团队室，有几个开发人员都在同一个项目上
*   自由使用我们想要的任何工具
*   敏捷过程
*   每个人都是开发者（甚至是老板）
*   具有实际范围的明确要求
*   热情，热情的人，真正投入其中

然而最近我改变了项目并进入了一个嵌入在一个大公司网站的外部咨询团队，随之而来的是官僚主义的 BS​​ 和开销：

*   不断的中断
*   大声的开放式隔间环境
*   慢设备
*   繁重的过程（即使他们称之为“敏捷”）
*   限制性 IT 环境
*   速度慢、过于复杂、工具有限
*   模糊的要求。似乎没有人知道发生了什么
*   愤世嫉俗的团队。可依赖的普通和平庸客户联系人的混合

它让我发疯。

那么在这艘船上的其他人都做了什么来保持他们的理智呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-21T23:32:17.160

对我有帮助的事情：

*   只专注于你的责任，并在情况允许的情况下尽可能完美地做到这一点
*   找一个既有权力又有理解力的人，礼貌地向他们提出改进建议
*   提出问题以阐明要求；这很烦人，但你可能会惹恼他们做得更好
*   获取耳机
*   找一份不同的工作，这样你就可以感觉自己不会永远被困在这里面

我还了解到，另一边的草不一定像看起来那样绿——所以要感谢你所拥有的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-22T00:07:05.157

我在工作的地方对此有一些经验。一般来说，告诉你的老板你的顾虑，如果没有解决，请继续提出，因为它们会影响你的工作效率，并向你的经理推销帮助你解决这些问题。

这是我所做的：

*   对于嘈杂的工作空间，听音乐，声音大到足以淹没音乐。
*   对于不断的打扰，听音乐，但要戴大耳机！我发现人们发现它们比耳塞更令人生畏。如果很明显您在该区域内，人们就不太可能打扰您。此外，如果音乐足够响亮，他们必须通过挥手或其他方式来吸引你的注意力。这让他们更容易打扰你。
*   对于缓慢、僵化的流程，请尝试说服您的同事和老板，改用更敏捷的方法将是有益的。我正在开发一个发布周期为一年的产品，并通过大量会议、电子邮件等设法说服每个人，敏捷是一种更好的方法。只是无情，但永远善良。
*   对于模糊的要求，请继续澄清。向他们展示你所做的，并询问是否可以。解释说你很难猜测他们想要什么，并且只有在你们之间有交流时才能澄清。通过创建一些样本或原型，您可以为他们提供一种阐明需求的方法，而无需做太多工作。（我知道很难过，但它有效）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-22T00:06:57.497

认识到驾驭公司水域对您来说只是又一项工程挑战，您将开始为您的问题提出新颖的解决方案。例如，我在一家公司担任顾问，我需要亲自进入服务器机房才能完成工作。我每天都必须做大量的文书工作才能进去，这让我很累。所以有一天，我带了一大袋自制的巧克力曲奇给负责管理服务器机房的女士，我的文书工作就这样结束了。

或者你可以利用你在新环境中的无足轻重，认真地上网。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-21T23:26:08.327

干脆放弃吧。生命太短暂，不能悲惨。你清楚地知道什么环境适合你，什么环境不适合。找一份像第一份工作一样的工作。我知道说起来容易做起来难……但你真的欠你自己。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-21T23:43:32.333

大多数情况下还不错。我几乎为各种规模的公司工作过，每个公司的差异比任何基于实际规模的公司都要大。

大公司强加的一些结构可能会为我们行业中的许多年轻、更独立的人才带来一些好处。

有时，当我被告知要做一件非常愚蠢的事情或以一种非常愚蠢的方式去做时，我有一句口头禅：“我得到了丰厚的报酬，并且可以得到更少的报酬来做更多的工作，所以闭嘴，去做”。然后我 5:00 回家，专注于自己的生活。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-21T23:48:16.317

正如其他帖子中所述，听音乐非常适合消除噪音。

您提出的大多数观点在大型部门\项目中都很常见，解决它们的最佳方法是尝试教育和说服您周围的人选择替代方案。

您可以为更快的机器提供商业案例（joelonsoftware 提供了大量有关开发人员生产力的信息）。

在利益相关者通常不知道他们想要什么并且变化频繁的业务环境中，不明确的需求是不可避免的，这通常会覆盖许多技术问题，因此也会使它们变得模糊。解决这个问题的最好方法是采用一个承认这一点并对其进行管理的过程，例如敏捷。

如果您对工具和流程有疑虑，我会先与其他开发人员讨论此问题，然后将其提交给开发\项目经理。

角色和环境的限制性（通常不像最初想象的那样紧密）通常有一些好处，但最初可能并不清楚。这些可以包括由于专业化而获得更深层次的知识以及将某些活动委托给组织中的其他人的能力，但这通常意味着事情更多地并行但更慢地发生。您还可能获得更广泛的角色和活动的曝光\经验，并结识很多人。

就这些问题进行教育和说服人们需要时间和大量的努力，尽管一旦这种情况开始发生，愤世嫉俗的情绪可能会开始放松和消失，对大型团队/部门实施变革并不容易，通常需要通过获得动力更多人的热情和参与。就我个人而言，尽管这常常令人沮丧，但我还是靠它茁壮成长，因为它让我能够让人们参与辩论和指导人们。但是，我非常关注软件开发的人员\过程方面，而不是技术。如果这不适合您，那么我会考虑调动工作或要求重新分配给内部团队。

这取决于您正在工作的人，因为这是开发中最重要的事情，平易近人并致力于项目\部门\组织，如果不是这种情况，您可能想要寻找替代工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-21T23:57:36.190

*   环境音乐/谈话广播
*   在家里保留一个博客或一个业余项目，以“正确的方式”去做

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-21T23:29:04.843

对于噪音，我带了个好耳机并使用音乐。

缓慢的设备和持续的中断是您应该与项目经理交谈的问题。我只是他希望你尽可能快地工作。他可能会帮助你。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-21T23:30:19.363

我换了工作，以便在一个良好/富有成效/友好/鼓励/好奇的环境中工作。

不过我可以同情你。我在几个和你描述的完全一样的糟糕地方工作过。问题是，我无法改变环境或他们的过程。

# java - 遍历集合，在循环中删除对象时避免 ConcurrentModificationException

> ID：223918
> 
> 赞同：1268
> 
> 时间：2008-10-21T23:23:33.123
> 
> 标签：java, collections, iteration

我们都知道您不能执行以下操作，因为`ConcurrentModificationException`：

```
for (Object i : l) {
    if (condition(i)) {
        l.remove(i);
    }
} 
```

但这显然有时有效，但并非总是如此。下面是一些具体的代码：

```
public static void main(String[] args) {
    Collection<Integer> l = new ArrayList<>();

    for (int i = 0; i < 10; ++i) {
        l.add(4);
        l.add(5);
        l.add(6);
    }

    for (int i : l) {
        if (i == 5) {
            l.remove(i);
        }
    }

    System.out.println(l);
} 
```

当然，这会导致：

```
Exception in thread "main" java.util.ConcurrentModificationException 
```

即使多个线程没有这样做。反正。

这个问题的最佳解决方案是什么？如何在不引发此异常的情况下循环从集合中删除项目？

我在`Collection`这里也使用了任意的，不一定是`ArrayList`，所以你不能依赖`get`.

* * *

## 回答 #1

> 赞同：1654
> 
> 时间：2008-10-21T23:27:15.203

[`Iterator.remove()`](https://docs.oracle.com/javase/9/docs/api/java/util/Iterator.html#remove--)是安全的，你可以像这样使用它：

```
List<String> list = new ArrayList<>();

// This is a clever way to create the iterator and call iterator.hasNext() like
// you would do in a while-loop. It would be the same as doing:
//     Iterator<String> iterator = list.iterator();
//     while (iterator.hasNext()) {
for (Iterator<String> iterator = list.iterator(); iterator.hasNext();) {
    String string = iterator.next();
    if (string.isEmpty()) {
        // Remove the current element from the iterator and the list.
        iterator.remove();
    }
} 
```

请注意，这[`Iterator.remove()`](https://docs.oracle.com/javase/9/docs/api/java/util/Iterator.html#remove--)是在迭代期间修改集合的唯一安全方法；如果在迭代过程中**以任何其他方式**修改了基础集合，则行为未指定。

来源：[docs.oracle > 集合接口](http://docs.oracle.com/javase/tutorial/collections/interfaces/collection.html)

* * *

同样，如果您有 a`ListIterator`并且想要*添加*项目，您可以使用[`ListIterator#add`](http://docs.oracle.com/javase/8/docs/api/java/util/ListIterator.html#add-E-)，出于同样的原因，您可以使用`Iterator#remove` - 它旨在允许它。

* * *

在您的情况下，您尝试从列表中删除，但如果尝试在`put`一段`Map`时间内迭代其内容，则同样的限制适用。

* * *

## 回答 #2

> 赞同：353
> 
> 时间：2008-10-21T23:26:31.383

这有效：

```
Iterator<Integer> iter = l.iterator();
while (iter.hasNext()) {
    if (iter.next() == 5) {
        iter.remove();
    }
} 
```

我假设由于 foreach 循环是迭代的语法糖，使用迭代器无济于事……但它为您提供了此`.remove()`功能。

* * *

## 回答 #3

> 赞同：233
> 
> 时间：2014-05-28T10:11:44.693

在 Java 8 中，您可以使用[新`removeIf`方法](http://docs.oracle.com/javase/8/docs/api/java/util/Collection.html#removeIf-java.util.function.Predicate-)。应用于您的示例：

```
Collection<Integer> coll = new ArrayList<>();
//populate

coll.removeIf(i -> i == 5); 
```

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2010-05-15T19:57:56.713

由于问题已经得到解答，即最好的方法是使用迭代器对象的 remove 方法，我将详细介绍`"java.util.ConcurrentModificationException"`引发错误的地方。

每个集合类都有一个私有类，它实现了 Iterator 接口并提供了`next()`,`remove()`和`hasNext()`.

next 的代码看起来像这样......

```
public E next() {
    checkForComodification();
    try {
        E next = get(cursor);
        lastRet = cursor++;
        return next;
    } catch(IndexOutOfBoundsException e) {
        checkForComodification();
        throw new NoSuchElementException();
    }
} 
```

这里的方法`checkForComodification`实现为

```
final void checkForComodification() {
    if (modCount != expectedModCount)
        throw new ConcurrentModificationException();
} 
```

因此，如您所见，如果您明确尝试从集合中删除一个元素。它导致`modCount`得到不同`expectedModCount`，导致异常`ConcurrentModificationException`。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2008-10-21T23:32:17.427

您可以像您提到的那样直接使用迭代器，或者保留第二个集合并将要删除的每个项目添加到新集合中，然后在最后 removeAll 。这允许您以增加内存使用和 cpu 时间为代价继续使用 for-each 循环的类型安全（不应该是一个大问题，除非您有非常非常大的列表或非常旧的计算机）

```
public static void main(String[] args)
{
    Collection<Integer> l = new ArrayList<Integer>();
    Collection<Integer> itemsToRemove = new ArrayList<>();
    for (int i=0; i < 10; i++) {
        l.add(Integer.of(4));
        l.add(Integer.of(5));
        l.add(Integer.of(6));
    }
    for (Integer i : l)
    {
        if (i.intValue() == 5) {
            itemsToRemove.add(i);
        }
    }

    l.removeAll(itemsToRemove);
    System.out.println(l);
} 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2014-08-29T09:56:15.023

在这种情况下，一个常见的技巧是（曾经？）倒退：

```
for(int i = l.size() - 1; i >= 0; i --) {
  if (l.get(i) == 5) {
    l.remove(i);
  }
} 
```

也就是说，我很高兴您在 Java 8 中有更好的方法，例如`removeIf`在`filter`流上。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2013-08-21T12:39:45.337

与带有 for 循环的[Claudius](https://stackoverflow.com/a/223927/1433392)的答案相同：

```
for (Iterator<Object> it = objects.iterator(); it.hasNext();) {
    Object object = it.next();
    if (test) {
        it.remove();
    }
} 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2012-06-26T05:28:35.773

制作现有列表的副本并迭代新副本。

```
for (String str : new ArrayList<String>(listOfStr))     
{
    listOfStr.remove(/* object reference or index */);
} 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2012-12-18T23:08:46.757

使用[Eclipse Collections](https://www.eclipse.org/collections/)，[MutableCollection](https://github.com/eclipse/eclipse-collections/blob/master/eclipse-collections-api/src/main/java/org/eclipse/collections/api/collection/MutableCollection.java#L236)`removeIf`上定义的方法将起作用：

```
MutableList<Integer> list = Lists.mutable.of(1, 2, 3, 4, 5);
list.removeIf(Predicates.lessThan(3));
Assert.assertEquals(Lists.mutable.of(3, 4, 5), list); 
```

使用 Java 8 Lambda 语法，可以这样写：

```
MutableList<Integer> list = Lists.mutable.of(1, 2, 3, 4, 5);
list.removeIf(Predicates.cast(integer -> integer < 3));
Assert.assertEquals(Lists.mutable.of(3, 4, 5), list); 
```

此处调用 to是必要的，因为在 Java 8 的接口上添加`Predicates.cast()`了默认`removeIf`方法。`java.util.Collection`

**注意：**我是[Eclipse Collections](https://www.eclipse.org/collections/)的提交者。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2017-04-16T20:29:06.973

使用传统的 for 循环

```
ArrayList<String> myArray = new ArrayList<>();

for (int i = 0; i < myArray.size(); ) {
    String text = myArray.get(i);
    if (someCondition(text))
        myArray.remove(i);
    else
        i++;   
} 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2018-03-17T11:02:30.790

人们断言**无法**从 foreach 循环迭代的 Collection 中删除。我只是想指出这在*技术上*是不正确的并准确地描述了（我知道 OP 的问题是如此先进以至于避免知道这一点）该假设背后的代码：

```
for (TouchableObj obj : untouchedSet) {  // <--- This is where ConcurrentModificationException strikes
    if (obj.isTouched()) {
        untouchedSet.remove(obj);
        touchedSt.add(obj);
        break;  // this is key to avoiding returning to the foreach
    }
} 
```

并不是说您不能从迭代中删除，`Colletion`而是一旦这样做就无法继续迭代。因此`break`在上面的代码中。

抱歉，如果这个答案是一个有点专业的用例并且更适合我从这里到达的原始[线程](https://stackoverflow.com/questions/1110404/remove-elements-from-a-hashset-while-iterating)，那个被标记为重复（尽管这个线程看起来更细微）并被锁定。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2016-06-23T11:18:58.893

[ConcurrentHashMap](https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentHashMap.html)或[ConcurrentLinkedQueue](https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)或[ConcurrentSkipListMap](https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentSkipListMap.html)可能是另一种选择，因为它们永远不会抛出任何 ConcurrentModificationException，即使您删除或添加项目。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-03-14T11:18:16.507

另一种方法是使用 arrayList 的副本仅用于迭代：

```
List<Object> l = ...

List<Object> iterationList = ImmutableList.copyOf(l);

for (Object curr : iterationList) {
    if (condition(curr)) {
        l.remove(curr);
    }
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-10-13T15:16:20.077

A`ListIterator`允许您添加或删除列表中的项目。假设您有一个`Car`对象列表：

```
List<Car> cars = ArrayList<>();
// add cars here...

for (ListIterator<Car> carIterator = cars.listIterator();  carIterator.hasNext(); )
{
   if (<some-condition>)
   { 
      carIterator().remove()
   }
   else if (<some-other-condition>)
   { 
      carIterator().add(aNewCar);
   }
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2021-03-31T14:01:16.110

**Java 并发修改异常**

1.  单线程

```
Iterator<String> iterator = list.iterator();
while (iterator.hasNext()) {
    String value = iter.next()
    if (value == "A") {
        list.remove(it.next()); //throws ConcurrentModificationException
    }
} 
```

解决方案：迭代器`remove()`方法

```
Iterator<String> iterator = list.iterator();
while (iterator.hasNext()) {
    String value = iter.next()
    if (value == "A") {
        it.remove()
    }
} 
```

2.  多线程

*   复制/转换并迭代另一个集合。对于小型收藏
*   `synchronize`[^([关于])](https://stackoverflow.com/a/59500618/4770877)
*   线程安全集合[^([关于])](https://stackoverflow.com/a/65410514/4770877)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-11-19T09:18:45.460

对于上面的问题，我有一个建议。不需要二级名单或任何额外的时间。请找到一个例子，它会以不同的方式做同样的事情。

```
//"list" is ArrayList<Object>
//"state" is some boolean variable, which when set to true, Object will be removed from the list
int index = 0;
while(index < list.size()) {
    Object r = list.get(index);
    if( state ) {
        list.remove(index);
        index = 0;
        continue;
    }
    index += 1;
} 
```

这将避免并发异常。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-05-03T17:59:35.887

> 最好的方法（推荐）是使用 java.util.Concurrent 包。通过使用这个包，你可以很容易地避免这个 Exception 。参考修改后的代码

```
public static void main(String[] args) {
    Collection<Integer> l = new CopyOnWriteArrayList<Integer>();

    for (int i=0; i < 10; ++i) {
        l.add(new Integer(4));
        l.add(new Integer(5));
        l.add(new Integer(6));
    }

    for (Integer i : l) {
        if (i.intValue() == 5) {
            l.remove(i);
        }
    }

    System.out.println(l);
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-09-26T20:15:21.577

我知道这个问题对于 Java 8 来说太老了，但是对于那些使用 Java 8 的人来说，您可以轻松地使用 removeIf()：

```
Collection<Integer> l = new ArrayList<Integer>();

for (int i=0; i < 10; ++i) {
    l.add(new Integer(4));
    l.add(new Integer(5));
    l.add(new Integer(6));
}

l.removeIf(i -> i.intValue() == 5); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-09-22T14:22:27.867

现在，您可以使用以下代码删除

```
l.removeIf(current -> current == 5); 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-12-28T10:40:17.500

您可以使用 while 循环。

```
Iterator<Map.Entry<String, String>> iterator = map.entrySet().iterator();
while(iterator.hasNext()){
    Map.Entry<String, String> entry = iterator.next();
    if(entry.getKey().equals("test")) {
        iterator.remove();
    } 
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-02-04T17:25:28.073

如果**ArrayList:remove(int index)** - if(index is last element's position) 它可以避免`System.arraycopy()`并且不需要时间。

如果（索引减少），数组复制时间会增加，顺便说一下列表的元素也会减少！

最有效的删除方式是 - 按降序删除其元素： `while(list.size()>0)list.remove(list.size()-1);`//takes O(1) `while(list.size()>0)list.remove(0);`//takes O(factorial(n))

```
//region prepare data
ArrayList<Integer> ints = new ArrayList<Integer>();
ArrayList<Integer> toRemove = new ArrayList<Integer>();
Random rdm = new Random();
long millis;
for (int i = 0; i < 100000; i++) {
    Integer integer = rdm.nextInt();
    ints.add(integer);
}
ArrayList<Integer> intsForIndex = new ArrayList<Integer>(ints);
ArrayList<Integer> intsDescIndex = new ArrayList<Integer>(ints);
ArrayList<Integer> intsIterator = new ArrayList<Integer>(ints);
//endregion

// region for index
millis = System.currentTimeMillis();
for (int i = 0; i < intsForIndex.size(); i++) 
   if (intsForIndex.get(i) % 2 == 0) intsForIndex.remove(i--);
System.out.println(System.currentTimeMillis() - millis);
// endregion

// region for index desc
millis = System.currentTimeMillis();
for (int i = intsDescIndex.size() - 1; i >= 0; i--) 
   if (intsDescIndex.get(i) % 2 == 0) intsDescIndex.remove(i);
System.out.println(System.currentTimeMillis() - millis);
//endregion

// region iterator
millis = System.currentTimeMillis();
for (Iterator<Integer> iterator = intsIterator.iterator(); iterator.hasNext(); )
    if (iterator.next() % 2 == 0) iterator.remove();
System.out.println(System.currentTimeMillis() - millis);
//endregion 
```

*   索引循环：1090 毫秒
*   对于 desc 索引：**519**毫秒---最好的
*   迭代器：1043 毫秒

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-06-30T07:24:49.550

```
for (Integer i : l)
{
    if (i.intValue() == 5){
            itemsToRemove.add(i);
            break;
    }
} 
```

如果您跳过内部 iterator.next() 调用，则捕获是从列表中删除元素之后。它仍然有效！虽然我不建议编写这样的代码，但它有助于理解它背后的概念 :-)

干杯!

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-09-17T09:03:02.437

线程安全集合修改示例：

```
public class Example {
    private final List<String> queue = Collections.synchronizedList(new ArrayList<String>());

    public void removeFromQueue() {
        synchronized (queue) {
            Iterator<String> iterator = queue.iterator();
            String string = iterator.next();
            if (string.isEmpty()) {
                iterator.remove();
            }
        }
    }
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-12-19T23:40:53.403

我知道这个问题只是假设 a `Collection`，而不是更具体地说是 any `List`。但是**对于那些确实在使用`List`参考文献的阅读这个问题的人，您可以避免`ConcurrentModificationException`使用`while`-loop（在其中进行修改时），而不是如果您想避免`Iterator`**（或者如果您想总体上避免它，或者专门避免它以实现与在每个元素处停止的从头到尾不同的循环顺序[我相信这是`Iterator`它本身可以做的唯一顺序]）：

***更新：请参阅下面的评论，阐明类似的情况也可以通过*传统*的-for-loop 实现。**

```
final List<Integer> list = new ArrayList<>();
for(int i = 0; i < 10; ++i){
    list.add(i);
}

int i = 1;
while(i < list.size()){
    if(list.get(i) % 2 == 0){
        list.remove(i++);

    } else {
        i += 2;
    }
} 
```

*该代码没有 ConcurrentModificationException。*

在那里我们看到循环不是从一开始就开始，也不是在*每个*元素处都停止（我相信`Iterator`它自己做不到）。

FWIW 我们还看到`get`被调用 on `list`，如果它的引用只是`Collection`（而不是更具体`List`的 -type `Collection`）- `List`interface 包括`get`，但`Collection`interface 没有，则无法完成。如果不是因为这种差异，那么`list`参考可以改为`Collection`[因此从技术上讲，此答案将是直接答案，而不是切线答案]。

FWIWW 相同的代码在修改为在每个元素的开始处停止后仍然有效（就像`Iterator`顺序一样）：

```
final List<Integer> list = new ArrayList<>();
for(int i = 0; i < 10; ++i){
    list.add(i);
}

int i = 0;
while(i < list.size()){
    if(list.get(i) % 2 == 0){
        list.remove(i);

    } else {
        ++i;
    }
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-07-31T20:16:13.733

一种解决方案可能是旋转列表并删除第一个元素以避免 ConcurrentModificationException 或 IndexOutOfBoundsException

```
int n = list.size();
for(int j=0;j<n;j++){
    //you can also put a condition before remove
    list.remove(0);
    Collections.rotate(list, 1);
}
Collections.rotate(list, -1); 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-11-13T19:15:38.360

试试这个（删除列表中等于的所有元素`i`）：

```
for (Object i : l) {
    if (condition(i)) {
        l = (l.stream().filter((a) -> a != i)).collect(Collectors.toList());
    }
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2021-07-03T19:11:07.213

我结束了这个`ConcurrentModificationException`，同时使用方法迭代列表`stream().map()`。但是，`for(:)`在迭代和修改列表时没有引发异常。

这是代码片段，如果它对任何人都有帮助：这里我正在迭代 a `ArrayList<BuildEntity>`，并使用 list.remove(obj) 对其进行修改

```
 for(BuildEntity build : uniqueBuildEntities){
            if(build!=null){
                if(isBuildCrashedWithErrors(build)){
                    log.info("The following build crashed with errors ,  will not be persisted -> \n{}"
                            ,build.getBuildUrl());
                    uniqueBuildEntities.remove(build);
                    if (uniqueBuildEntities.isEmpty()) return  EMPTY_LIST;
                }
            }
        }
        if(uniqueBuildEntities.size()>0) {
            dbEntries.addAll(uniqueBuildEntities);
        } 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-11-28T09:17:05.533

如果使用 HashMap，在较新版本的 Java (8+) 中，您可以选择 3 个选项中的每一个：

```
public class UserProfileEntity {
    private String Code;
    private String mobileNumber;
    private LocalDateTime inputDT;
    // getters and setters here
}
HashMap<String, UserProfileEntity> upMap = new HashMap<>();

// remove by value
upMap.values().removeIf(value -> !value.getCode().contains("0005"));

// remove by key
upMap.keySet().removeIf(key -> key.contentEquals("testUser"));

// remove by entry / key + value
upMap.entrySet().removeIf(entry -> (entry.getKey().endsWith("admin") || entry.getValue().getInputDT().isBefore(LocalDateTime.now().minusMinutes(3))); 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2020-06-04T13:23:36.340

你也可以使用**递归**

java中的递归是一个方法不断调用自身的过程。java中调用自身的方法称为递归方法。

* * *

## 回答 #30

> 赞同：-2
> 
> 时间：2013-10-12T04:57:52.660

这可能不是最好的方法，但对于大多数小情况，这应该是可以接受的：

> *“创建第二个空数组并仅添加您想要保留的那些”*

[我不记得我是从哪里读到这篇文章的……为了公正起见，我会制作这个维基，希望有人能找到它，或者只是为了不赢得我不应该得到的代表。]

# c++ - 无法链接静态库 C++

> ID：223919
> 
> 赞同：3
> 
> 时间：2008-10-21T23:23:46.647
> 
> 标签：c++, static, linker

我已经想出了如何设置 VC++ 将代码编译成 .lib 文件而不是 .exe，但是我无法让 lib 与我的其他 .obj 文件链接在一起。

这是我设置库和应用程序文件夹的方式。（我不确定这是否正确）

```
AppFolder
  App.sln
  App.ncb
  *.h
  *.cpp
  Debug
    *.obj
    App.exe 
```

以及硬盘驱动器上的其他地方...

```
LibraryFolder
  lib
    Library.lib
  include
    LibrarySolutionFolder
      Library.sln
      Library.ncb
      *.h
      *.cpp
      Debug
        *.obj
        Library.lib 
```

我一直在#include 我的应用程序的 cpp 文件中的库 *.h 文件，并且一切都编译得很好。只是当它链接时，我得到了所有正在搜索的 .lib 文件的列表，即使我在 VC++ 目录中列出了 Library.lib，它也不在那里。我怎样才能得到这个链接？（我是否正确地构建了库文件夹？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-21T23:32:47.423

关于项目属性：

配置属性 -> 链接器 -> 输入 -> 附加依赖项

把它加进去。

或者，在库的 .h 文件中，添加：

```
#pragma comment(lib, "Library") 
```

这将自动为您完成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-21T23:35:56.340

VC++ 目录是链接期间要搜索的目录位置列表。它不是要链接的库列表。

您需要将 lib 文件添加到***Project Linker***设置的***Additional Dependencies***字段中。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T23:41:08.873

要链接到库，您可以：

*   在 Project-> Properties...->Linker, Input->Additional Dependancies 中列出它（VC++ 目录只允许您使用 .lib 名称而不是完整路径），
*   将库项目添加到您的应用程序。解决方案（在解决方案上，右键单击 -> 添加 -> 现有项目...），然后使用项目 -> 项目依赖项...，然后检查您的库项目（确保在下拉列表中选择了应用程序项目）。如果您同时编辑这两个项目，这可能是最好的方法，因为如果在构建您的应用程序之前它已更改，VC++ 将重新构建库。
*   如果你确定你只会使用 VC++，

    ```
     #pragma comment(lib,"C:\\path\\to\\library.lib")` 
    ```

    （感谢@尼尔斯）

注意：将您的库解决方案文件夹放在“包含”目录中似乎很奇怪：这实际上是用于 *.h （或其他`#include`d 文件）的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T04:37:09.447

从命令行：

> cl /EHsc {objfiles}+ /link /LIBPATH:LibraryFolder Library.lib

其中 {objfiles}+ 表示一个或多个对象或 cpp 文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T23:34:25.237

如果包含头文件，VC 不会简单地链接库。

您必须告诉链接器使用该库。有充分的理由：您的库文件夹中已经有数千个库。如果每次链接程序时 MSVC 都必须搜索所有这些，那么它就必须遍历数百兆字节的数据。

这将花费相当长的时间，因此默认情况下不会执行此操作。

对于 VC，您还可以提示源代码中的链接器。为此，您在源代码中的某处添加以下行（lib 的标头可能是一个好地方）。

```
#pragma comment(lib,"c:\\path_to_library\\libname.lib") 
```

这不是平台独立，而是使用 MSVC 将库自动链接到项目的最便捷方式。

另一种方法是简单地将链接器添加到项目设置中。可以在项目的链接器设置中找到相关信息。不要忘记将 lib 添加到发布和调试配置中。

# oracle - Pro*C 可以与 MSVC 6 一起使用吗？

> ID：223921
> 
> 赞同：1
> 
> 时间：2008-10-21T23:24:33.103
> 
> 标签：oracle, visual-c++-6, oracle-pro-c

如何让 Pro*c 在 MSVC 6 中工作？

换句话说，将 .pc 文件编译成 .cpp 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T10:21:42.153

我对 Pro*C 不熟悉，但通常可以在 MSVC 中使用自定义构建步骤。如果您将 .pc 文件添加到您的项目，然后查看该文件的“项目设置”对话框，在“自定义构建”选项卡上，您可以指定将 .pc 文件编译为 .cpp 所需的命令。当然，您还应该在“输出”部分输入输出 .cpp 的名称，以便构建系统了解文件依赖关系，并将输出 .cpp 添加到您的项目中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T23:38:35.993

除了作为编辑器之外，Visual C++/Visual Studio 不会有太大帮助，但您应该能够让它与 Makefile 项目一起工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T09:50:25.353

你可以做到（不幸的是，自从我上次使用 VC6 以来已经有很多年了，我不会有太大帮助。）根据我的记忆力差，我们设置了文件类型“.pc”（在工具部分VC?) 以便 VC 知道调用 proC 来生成文件的 .c 或 .cpp 版本。
我相信我们在项目中包含了（源）.pc 和（生成的）.cpp 文件（可能有更好的方法来做到这一点），以便我们可以轻松地在 VC 中编辑 proC 文件。
（我不记得我们是如何告诉 VC 的 cpp 文件依赖于 pc 文件）
祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-13T00:35:41.240

在**.pc**文件的**自定义构建选项卡**中。

 ****我在输出**中弹出这个。**proc**的输出是一个 cpp 文件

```
$(ProjDir)\$(InputName).cpp 
```

**命令**窗口中有 2 行。一是设置 MSVC 6 环境。另一个在 .pc 文件上调用 proc。

```
call vcvars32.bat 
proc sqlcheck=semantics userid=scott/tiger@instance   code=cpp char_map=string   sqlcheck=semantics parse=partial mode=ansi    $(ProjDir)\$(InputName).pc    include=c:\ora920\oci\include   include="%MSVCDIR%\include" include="$(MSDEVDIR)\..\vc\include"      include="$(MSDEVDIR)\..\..\vc98\include" 
```

您必须将 .cpp 文件添加到您的项目中才能编译它。如果需要调试，请在 .cpp 文件中设置断点。

这几乎涵盖了它。

# linq-to-sql - LINQ to SQL 实体和数据上下文类：业务对象封装

> ID：223931
> 
> 赞同：13
> 
> 时间：2008-10-21T23:28:11.130
> 
> 标签：linq-to-sql, c#-3.0

您最喜欢将 LINQ to SQL 实体类和数据上下文类封装到业务对象中的方法是什么？

你发现什么在特定情况下有效？

你有没有发明或采用任何特定的模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-29T22:27:30.363

我找到了一种我认为效果最好的模式——至少就我而言。

我使用部分类扩展实体类。我使用部分类，因此实体的签名不会改变（参见方法`DeleteOnSubmit`中的调用`Delete`）。

我做了一个小例子。这是数据库和 LINQ to SQL 类设置的图像：

![](https://i.stack.imgur.com/WqEHH.png)

这是我实现业务逻辑的部分类：

```
/// <summary>
/// This class extends BusinessLogicDataContext.Products entity class
/// </summary>
public partial class Product
{
    /// <summary>
    /// New up a product by column: dbo.Products.ProductId in database
    /// </summary>
    public Product(Int32 id)
    {
        var dc = new BusinessLogicDataContext();

        // query database for the product
        var query = (
            from p in dc.Products 
            where p.ProductId == id 
            select p
        ).FirstOrDefault();

        // if database-entry does not exist in database, exit
        if (query == null) return;

        /* if product exists, populate self (this._ProductId and
           this._ProductName are both auto-generated private
           variables of the entity class which corresponds to the
           auto-generated public properties: ProductId and ProductName) */
        this._ProductId = query.ProductId;
        this._ProductName = query.ProductName;
    }

    /// <summary>
    /// Delete product
    /// </summary>
    public void Delete()
    {
        // if self is not poulated, exit
        if (this._ProductId == 0) return;

        var dc = new BusinessLogicDataContext();

        // delete entry in database
        dc.Products.DeleteOnSubmit(this);
        dc.SubmitChanges();

        // reset self (you could implement IDisposable here)
        this._ProductId = 0;
        this._ProductName = "";
    }
} 
```

使用实现的业务逻辑：

```
// new up a product
var p = new Product(1); // p.ProductId: 1, p.ProductName: "A car"

// delete the product
p.Delete(); // p.ProductId: 0, p.ProductName: "" 
```

此外：LINQ to SQL 实体类本质上是非常开放的。这意味着对应于*dbo.Products.ProductId*列的属性同时实现了一个 getter 和一个 setter——这个字段不应该是可更改的。

据我所知，你不能使用部分类覆盖属性，所以我通常做的是实现一个使用接口缩小对象的管理器：

```
public interface IProduct
{
    Int32 ProductId { get; }

    void Delete();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T13:16:29.227

我倾向于使用存储库模式来封装 DataContexts。

[存储库模式](http://aspalliance.com/1672_Implementing_the_Repository_Pattern_with_LINQtoSQL.3)

不过，我想找到一种更好的方法来从我的数据层发出 POCO 对象，同时使用 LINQ2SQL。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-14T21:20:42.960

我刚刚发布了一个示例，说明如何使用 IoC 和 T4 模板构建使用 Linq to Sql 进行存储的应用程序。

[http://daniel.wertheim.se/2010/03/14/linq-to-sql-how-to-separate-the-entities-and-the-datacontext/](http://daniel.wertheim.se/2010/03/14/linq-to-sql-how-to-separate-the-entities-and-the-datacontext/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T08:50:52.510

现在我正在尝试使用 LINQ to SQL 实体类作为业务对象，在函数和服务之间传递它们。

当然，你应该有**单独的实体类来访问数据库**，这样你的数据库布局就可以在不改变业务对象的情况下改变！

我也对一个好的解决方案最感兴趣！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T21:41:55.540

查看 Rob Conery 整理的 MVC 示例应用程序的源代码：

[http://www.codeplex.com/mvcsamples/](http://www.codeplex.com/mvcsamples/)

他有一个单独的实体层，映射到 LINQ to SQL 类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T13:52:25.287

我使用 Entity Framework 和 Linq to Entities 进行了一些实验，以进一步将我的客户端代码与数据库分开，但我发现它使用起来很笨拙并且担心性能。

在我当前的项目中，我使用 Linq to SQL 作为我的数据层，但有单独的类，我在其中实现所有 Linq 查询。这些类返回在我的 Linq to SQL 上下文中定义的实体，但查询隐藏在方法中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T21:28:19.220

我发现[Ian Cooper 在 CodeBetter.com](http://codebetter.com/blogs/ian_cooper/archive/2008/07/01/architecting-linq-to-sql-part-10.aspx#184170)和[Stephen Walther](http://feeds.feedburner.com/StephenWalther)系列上的文章对于理解需要先编写 POCO 实体然后将它们映射到数据库而不是反其道而行之（这是我一直以来的做法）非常宝贵）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-23T21:38:48.213

我正在考虑拥有一个单独的 OO 模型层（更好地支持 OO 实践）的想法，但在底层使用 LINQ to SQL。这个想法是有一个自定义工具将用来生成代码的 xml 文件。由于 LINQ to SQL 实体对于我的偏好来说过于杂乱，因此我将自动生成新类以用作我的实体，当然 DataContext 将对客户端代码完全隐藏。简短的回答是：创建新的实体类，但使用底层 LINQ to SQL 实体和 DataContext。

# asp.net - 我需要在 asp.net 中注销事件吗

> ID：223938
> 
> 赞同：2
> 
> 时间：2008-10-21T23:30:46.507
> 
> 标签：asp.net, events, web-user-controls

我有一个 Web 用户控件，其中包含其他几个（Web 用户）控件并订阅孩子们提出的事件。

我看到有人在类似情况下在包含控件上提供 Dispose() 并取消注册它已订阅的事件。

当请求处理完成时，这一切不会被吹走吗？/ 是否有必要注销这些事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T01:21:57.203

由于当包含控件本身不再被引用时，包含的控件（事件发布者）将不再被任何东西引用，它们应该被垃圾回收。当这种情况发生时，包含控件也可以被垃圾收集。由于这些对象都在同一代中，我看不出如何更快地收集容器。似乎没有必要取消注册事件处理程序。如果事件发布者是比容器寿命更长的对象，那么这将是有道理的。

有关更多信息，请参考此[讨论](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/3c5552ea-4241-46b4-b1cf-c8b9ee9c639b/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T01:15:09.433

我认为这不是必要的步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T01:20:35.537

正如您所说，每次回发时都会重新创建页面（及其所有控件），因此没有必要

# firefox - 内联禁用 Firefox 拼写检查？

> ID：223940
> 
> 赞同：31
> 
> 时间：2008-10-21T23:31:10.627
> 
> 标签：firefox, spell-checking, html-input

我前一段时间研究过这个，不记得怎么做。我希望能够阻止 Firefox 在页面内的某些输入字段上运行它的拼写检查功能。我知道这是可能的，但不记得如何设置它。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-21T23:35:30.133

谈论有一个大的“duh”时刻！经过反复试验，我找到了答案：

```
<textarea spellcheck="false"></textarea> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T18:55:52.023

“拼写检查”属性目前是仅在 Firefox 中可用的额外功能，但正在[考虑将其包含在 HTML5 中](http://blog.whatwg.org/the-road-to-html-5-spellchecking)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-07-21T03:41:26.047

使用 JQuery 添加属性 $('.textarea_className').attr('spellcheck',false);

这将允许您返回一个有效的 XHTML 标记。=)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T22:08:15.650

这样做的缺点是 W3 严格验证器给出 - 属性“拼写检查”不是有效属性。对于我们这些喜欢在验证我们的网站时看到 0 个错误的强迫症患者来说是个坏消息。

# vb.net - 用另一个 LINQ 对象更新一个 LINQ 对象中的列

> ID：223946
> 
> 赞同：1
> 
> 时间：2008-10-21T23:34:22.880
> 
> 标签：vb.net, linq-to-sql

我有两个具有完全相同列的 LINQ 对象，我希望能够使用另一个字段更新一个。我首先从文件中的一些数据创建一个新对象，然后在数据库中查询具有相同 ID 的现有项目。我想做的是用新创建的对象详细信息更新现有对象详细信息。

到目前为止，我一直在做的方式是列出所有列并手动更新它们，但正如您所见，这可能会导致维护问题。

```
 With OldCaller
            .ADDRESS = NewCaller.ADDRESS
            .COMPANY = NewCaller.COMPANY
            .CONTACT_HOURS = NewCaller.CONTACT_HOURS
            .CONTACT_NAME = NewCaller.CONTACT_NAME
            .CUSTOMER_ID = NewCaller.CUSTOMER_ID
            .EMAIL_ADDRESS = NewCaller.EMAIL_ADDRESS
            .FAX_NUMBER = NewCaller.FAX_NUMBER
            .FAX_TYPE = NewCaller.FAX_TYPE
            .MOBILE = NewCaller.MOBILE
            .POSTCODE = NewCaller.POSTCODE
            .PUBLIC_ADDRESS = NewCaller.PUBLIC_ADDRESS
            .PUBLIC_TELEPHONE = NewCaller.PUBLIC_TELEPHONE
            .STATE = NewCaller.STATE
            .SUBURB = NewCaller.SUBURB
            .TELEPHONE = NewCaller.TELEPHONE
        End With 
```

我希望能够找到一种方法来清理它。有谁知道做我需要的更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T23:52:11.987

当我从模板创建对象的实例时，我会做这种事情。基本上，我有一个方法可以遍历模板的公共属性，在正在创建的对象中找到相应的属性，并在新对象上调用属性设置器，所有这些都通过反射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T03:41:51.413

我还没有测试过，但这就是我想出的。

```
 Dim _OldCallerProperties = OldCaller.GetType().GetProperties(Reflection.BindingFlags.Public)
        Dim _NewCallerProperties = NewCaller.GetType.GetProperties(Reflection.BindingFlags.Public)

        For Each Prop In _OldCallerProperties
           Dim _matchingProperty = _NewCallerProperties.Where(Function(p) p.Name = Prop.Name).FirstOrDefault
           Dim _newvalue = _matchingProperty.GetValue(_matchingProperty, Nothing)
           Prop.SetValue(Prop, _newvalue, Nothing)
        Next 
```

就像我说的我没有测试过它，但我相信它应该可以工作。

# c# - 从字符串创建类的实例

> ID：223952
> 
> 赞同：245
> 
> 时间：2008-10-21T23:38:04.950
> 
> 标签：c#, .net, instantiation, system.type

有没有办法根据我在运行时知道类的名称这一事实来创建类的实例。基本上我会在一个字符串中包含类的名称。

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2008-10-21T23:39:03.667

看一下[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)方法。

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2014-11-25T05:19:57.933

它很简单。假设您的类名是`Car`并且命名空间是`Vehicles`，然后将参数作为`Vehicles.Car`返回类型的对象传递`Car`。像这样，您可以动态创建任何类的任何实例。

```
public object GetInstance(string strFullyQualifiedName)
{         
     Type t = Type.GetType(strFullyQualifiedName); 
     return  Activator.CreateInstance(t);         
} 
```

如果您的[完全限定名称](https://msdn.microsoft.com/en-us/library/dfb3cx8s%28v=vs.71%29.aspx)（即，`Vehicles.Car`在这种情况下）在另一个程序集中，则`Type.GetType`将为空。在这种情况下，您需要遍历所有程序集并找到`Type`. 为此，您可以使用以下代码

```
public object GetInstance(string strFullyQualifiedName)
{
     Type type = Type.GetType(strFullyQualifiedName);
     if (type != null)
         return Activator.CreateInstance(type);
     foreach (var asm in AppDomain.CurrentDomain.GetAssemblies())
     {
         type = asm.GetType(strFullyQualifiedName);
         if (type != null)
             return Activator.CreateInstance(type);
     }
     return null;
 } 
```

现在，如果您想调用**参数化构造函数**，请执行以下操作

```
Activator.CreateInstance(t,17); // Incase you are calling a constructor of int type 
```

代替

```
Activator.CreateInstance(t); 
```

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2008-10-21T23:43:24.470

我已经成功地使用了这个方法：

```
System.Reflection.Assembly.GetExecutingAssembly().CreateInstance(string className) 
```

您需要将返回的对象转换为所需的对象类型。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-10-22T00:38:37.917

可能我的问题应该更具体。我实际上知道字符串的基类，因此通过以下方式解决了它：

```
ReportClass report = (ReportClass)Activator.CreateInstance(Type.GetType(reportClass)); 
```

Activator.CreateInstance 类有多种方法以不同的方式实现相同的事情。我本可以将它投射到一个对象上，但以上对我的情况最有用。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-12-19T11:50:07.633

要从解决方案中的另一个项目创建类的实例，您可以获取由任何类的名称（例如 BaseEntity）指示的程序集并创建一个新实例：

```
 var newClass = System.Reflection.Assembly.GetAssembly(typeof(BaseEntity)).CreateInstance("MyProject.Entities.User"); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-11-16T22:15:50.130

我知道我迟到了……但您正在寻找的解决方案可能是上述的组合，并使用接口来定义您的对象可公开访问的方面。

然后，如果以这种方式生成的所有类都实现了该接口，则可以将其强制转换为接口类型并使用生成的对象。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-09-23T18:33:50.470

例如，如果您将各种类型的值存储在数据库字段中（存储为字符串），并有另一个字段类型名称为（即 String、bool、int、MyClass），那么从该字段数据中，您可以想象，使用上面的代码创建一个任意类型的类，并用第一个字段中的值填充它。这当然取决于您存储的类型是否有将字符串解析为正确类型的方法。我已经多次使用它来将用户首选项设置存储在数据库中。

* * *

## 回答 #8

> 赞同：-14
> 
> 时间：2010-05-11T09:04:09.173

```
ReportClass report = (ReportClass)Activator.CreateInstance(Type.GetType(reportClass)); 
```

你为什么要写这样的代码？如果你有一个类'ReportClass'可用，你可以直接实例化它，如下所示。

```
ReportClass report = new ReportClass(); 
```

`ReportClass report = (ReportClass)Activator.CreateInstance(Type.GetType(reportClass));`当您没有必要的类可用时使用该代码，但您想动态地实例化和/或调用方法。

我的意思是当你知道程序集但在编写代码时你没有可用的类时它很有`ReportClass`用。

# database - 如何配置 cocoon 以将数据库用作石英作业和触发器的存储

> ID：223954
> 
> 赞同：1
> 
> 时间：2008-10-21T23:38:23.873
> 
> 标签：database, scheduling, quartz-scheduler, apache-cocoon

我正在使用 Cocoon 并希望将石英调度程序的作业和触发器存储在数据库中，以便它们被持久化。我可以看到我需要在哪里进行更改，`cocoon.xconf`但我找不到太多关于如何配置数据源等的信息。

如何配置它以使用我们现有的（postgres）数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T00:04:09.810

你需要做两件事：

*   将以下配置添加到quartz.properties，并用适当的值代替$ 占位符

* * *

```
org.quartz.jobStore.dataSource=myDS
org.quartz.dataSource.myDS.URL=$URL
org.quartz.dataSource.myDS.driver=$driver
org.quartz.dataSource.myDS.maxConnections=5
org.quartz.dataSource.myDS.password=$password
org.quartz.dataSource.myDS.user=$user
org.quartz.dataSource.myDS.validationQuery=$any query that doesn't return an error when properly connected
org.quartz.jobStore.tablePrefix=QREPL_
org.quartz.jobStore.driverDelegateClass=org.quartz.impl.jdbcjobstore.PostgreSQLDelegate 
```

* * *

*   创建 Quartz 存储作业数据的数据库表 - 您应该找到包含在 Quartz 发行版中的 DDL 脚本，该脚本将为您创建它们。每个 Quartz 表名都应该以相同的前缀开头。在上面的配置中，我假设这个前缀是“QREPL_”

希望这会有所帮助，唐

# .net - .Net 网络服务，如何访问...？

> ID：223964
> 
> 赞同：1
> 
> 时间：2008-10-21T23:42:19.417
> 
> 标签：.net, web-services, soap

注意：我只是在使用网络服务，我无法控制网络服务代码。

所以在 .net 2.0 中，我引用了 webservice 并在 webservice 命名空间中看到了一个类，比如 foobar。它定义为：

```
public class foobar : System.Web.Services.Protocols.SoapHttpClientProtocol 
```

但是在 .net 3.5 中，当我添加对同一个 web 服务的引用时，我不再有这个 foobar 类可用。我确实看到了 foobarSoap，它是一个接口，它公开了上面 foobar 类中的所有方法。它定义为：

```
public interface foobarSoap 
```

但是它不会公开属性（出于显而易见的原因）。

我需要访问这些属性。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T23:52:10.210

您可以尝试使用**Web 服务描述语言工具**( `Wsdl.exe`) 来生成一个实际的类文件：

> `wsdl.exe /language:cs http://www.example.com/FooService.wsdl`

您可以在其[MSDN Page](http://msdn.microsoft.com/en-us/library/7h3ystb6.aspx "Web 服务描述语言工具 (Wsdl.exe)")上获得有关[**WSDL 工具**](http://msdn.microsoft.com/en-us/library/7h3ystb6.aspx "Web 服务描述语言工具 (Wsdl.exe)")的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T01:37:03.570

我有一种偷偷摸摸的感觉，这些属性不会成为服务定义 (WSDL) 的一部分，这意味着您可能无法使用它们。如果可能，请尝试说服曾经维护服务的人将属性公开为实际方法。

您很可能无法访问这些属性，在这种情况下，您可能只是运气不佳。对不起。

我将尝试公开一个属性，然后我会在这里报告结果。

编辑：无法使用 WCF 公开接口属性，它根本不会编译

```
[ServiceContract]
public interface IFooService
{
    [OperationContract] // This is not allowed, it will not compile
    string Name { get; set; }
} 
```

编辑：也不能使用 ASMX Web 服务来完成。: (

```
[WebService(Namespace = "http://tempuri.org/")]
public class FooService : System.Web.Services.WebService
{
    [WebMethod] // This is not allowed, it will not compile
    string Name { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T01:51:18.080

我刚刚创建了一个示例项目，并使用 Add Service Reference 菜单为该服务创建了一个 Web 代理：

```
http://www.xmlme.com/WSShakespeare.asmx 
```

Visual Studio 2008 基于 WSDL 生成一个接口和一个代理类。例如，我有一个实现 ShakespeareSoap 接口的类 ShakespeareSoapClient。

它似乎工作正常。我是不是错过了什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T19:46:49.637

当我从 2005 年升级到 2008 年时，我遇到了类似的问题。我认为您缺少什么，当您单击“添加服务参考”时，会出现一个较新的对话框。单击底部的高级按钮，然后在出现的下一个对话框中，单击兼容性部分底部的添加 Web 引用按钮。然后你会得到你最可能习惯的对话框，并且会有标准的 2.0 代理类。

# cocoa - 从共享实用程序窗口和最前面的文档窗口绑定的好方法是什么？

> ID：223966
> 
> 赞同：12
> 
> 时间：2008-10-21T23:43:17.340
> 
> 标签：cocoa, cocoa-bindings, key-value-observing

我有一个允许打开多个 NSDocument 的应用程序。在这个应用程序中是一个单一的实用程序窗口，其中包含一些我想应用于最前面的文档的功能。

我在这里尝试使用绑定，所以诀窍是如何将实用程序窗口的用户界面干净地绑定到最前面的文档。目标是切换最前面的文档窗口将更新实用程序窗口中的视图；当文档模型的状态发生变化时，绑定到最前面文档模型属性的控件将被适当地更新，等等。

对于从这样的窗口发送动作，很容易只使用第一响应者；文档对象可以通过响应者链拦截动作。但我想要的不止这些，当然你不能绑定到第一响应者。

我有几个想法：

*   在我的笔尖中为共享窗口放置一个对象控制器。当文档窗口更改最前面的状态时，更改该绑定的内容。这样做的一个缺点是，如果我有另一种实用程序窗口，我必须记住将文档窗口的绑定也连接到该实用程序窗口！
*   在应用程序委托中创建一个访问器，通过遍历窗口列表来获取最前面的文档窗口。我的实用程序窗口将通过应用程序委托的方法进行绑定。这里的一个缺点是它不符合 KVO
*   在应用程序委托中有一个 getter 和 setter 来确定（并且可能设置为与 KVO 兼容？这有意义吗？）最前面的文档。当窗口失去主状态时，也许使用窗口通知将 ivar 设置为适当的值。**更新：我现在正在使用它，它实际上看起来很干净。*我从我的文档窗口的windowDidBecomeMain*通知中设置值并在*windowWillClose*中清除它（如果它是当前值）。除非有任何重大反对意见，否则这可能是我将使用的方法。**
*   [一个想法](http://forums.macrumors.com/showthread.php?t=215361)是绑定到 mainWindow.windowController.document ......这很接近，除了当我的共享窗口变为主窗口时，这个绑定就消失了。所以我真的需要找到最前面的*文档*窗口的控制器（以及正确的类）。

这些似乎都不对。有没有更好的方法来做到这一点，我错过了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T17:55:51.987

我一直通过 Shared Application 绑定`mainWindow.document`，效果很好。如果您有没有文档的窗口，您可能希望添加一个键，该键通过根据某些过滤条件`mainYourKindOfWindow`观察和更新值来实现。`mainWindow`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T02:10:33.377

Leopard 的 TextEdit 为其检查员执行此操作。在 file:///Developer/Examples/AppKit/TextEdit 中查看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T17:57:24.153

> *   在我的笔尖中为共享窗口放置一个对象控制器。当文档窗口更改最前面的状态时，更改该绑定的内容。

这对我来说最有意义。您将内容更改为文档实例 ( `[NSDocumentController currentDocument]`)。

> 这样做的一个缺点是，如果我有另一种实用程序窗口，我必须记住将文档窗口的绑定也连接到该实用程序窗口！

嗯？我不明白这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T13:31:25.790

> Leopard 的 TextEdit 为其检查员执行此操作。在 >file:///Developer/Examples/AppKit/TextEdit 中查看。

在 TextEdit 中，检查器值通过中间对象控制器绑定。控制器内容对象绑定到共享应用程序 mainWindow。

您可以将内容绑定到 mainWindow.firstResponder 并取消选中“Raises for not applicable keys”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-14T00:07:39.073

使用关键窗口，而不是主窗口。NSApplication 的 keyWindow 属性可能不支持 KVO，但如果它不起作用，您仍然可以使用 NSNotifications。这样做的原因是 NSDocumentController 的 currentDocument 使用了 keyWindow，所以它更好地代表了内置的功能。此外，面板可以设置为避免成为关键窗口。

# java - 生成光谱调色板

> ID：223971
> 
> 赞同：14
> 
> 时间：2008-10-21T23:47:22.323
> 
> 标签：java, colors

有没有一种简单的方法可以在 Java（RGB、HSV 和 Lab）中的颜色模型之间进行转换。

假设 RGB 颜色模型：

*   如何计算黑体光谱调色板？我想将它用于热图图表。
*   单波长光谱怎么样？

**编辑：**我发现[ColorSpace](http://java.sun.com/javase/6/docs/api/java/awt/color/ColorSpace.html)类可用于 RGB/CIE 和许多其他颜色模型之间的转换。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-22T02:31:28.810

Java 有内置的 RGB 到 HSB 的转换。每当我需要 Java 中的快速调色板时，我都会这样做：

```
public Color[] generateColors(int n)
{
    Color[] cols = new Color[n];
    for(int i = 0; i < n; i++)
    {
        cols[i] = Color.getHSBColor((float) i / (float) n, 0.85f, 1.0f);
    }
    return cols;
} 
```

这是一个快速而肮脏的 hack（我会为您的应用程序调整“神奇”数字），但对于我的简单用途，它会生成一个漂亮明亮宜人的托盘。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T00:50:27.097

也许我不理解您的问题，但您无法真正从 RGB 输出设备生成真正的黑体光谱。如果没有别的，有限的色域将是一个问题。如果你想要的只是视觉上类似于黑体光谱的东西，那可能会容易得多。

作为近似值，从 (R,G,B) (0,0,0) 到 (255,0,0)，然后到 (255,255,0)，然后到 (255,255,255)。这会给你从暗红色到橙色，到黄色，到白色的过渡。

如果你想要更科学的东西，维基百科关于[黑体辐射](http://en.wikipedia.org/wiki/Black_body)的文章有一些颜色与温度的关系图。一旦你计算出 CIE 坐标，你就可以在你最喜欢的色彩空间中将它们转换为 RGB。

编辑：找到其他一些在线参考资料： [太阳是什么颜色？](http://casa.colorado.edu/~ajsh/colour/Tspectrum.html) [黑体是什么颜色的？](http://www.vendian.org/mncharity/dir3/blackbody/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-21T23:52:16.730

您可以使用 HSV 颜色模型构建这样的调色板。一旦您准备好 HSV 到 RGB 代码并使用这些数字玩几分钟，这很容易。

但是，我认为将代码添加到您的项目中只是为了生成一个小调色板是不值得的。

从文件中提取所需的调色板并将它们添加为静态数组更容易且工作量更少。

Photoshop 让您编辑调色板，并附带一个非常漂亮的黑色主体调色板作为预设。

您可以简单地将这些保存为 .act 文件。该文件本身只是一个简单的 256 色 á 3 字节文件（顺序为读取，绿色，蓝色。每个通道 8 位）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-24T18:25:14.933

您可以生成此色谱[https://i.stack.imgur.com/ktLmt.jpg](https://i.stack.imgur.com/ktLmt.jpg)

使用以下代码：

```
public void render(Screen screen) {
    int green = 255;
    int red = 0;

    for (int i = 0; i <= 255 * 2; i++) {
        int rate = i / 255;

        screen.fillRect((x + (i * width)/6), y, width, height, new Color(red, green, 0));

        red += 1 - rate;
        green -= rate;
    }   
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-04-08T06:59:09.800

这是在 AS3 中制作 HSL 颜色方块的好方法。

```
/**
 * Generate a BitmapData HSL color square (n x n) of hue
 * At a low n dimension you get cool blocky color palettes (e.g. try n=10)
 */
function generateColorSquare(n:uint, hue:uint):BitmapData
            {
                var bd:BitmapData = new BitmapData(n, n, false, 0xFFFFFF);
                for (var i:uint=n*n; i > 0; i--)
                {
                    bd.setPixel(i % n, Math.floor(i / n),  HSBColor.convertHSBtoRGB(hue, i / (n*n), (1/n) * (i % n) ));
                }
                return bd;
            } 
```

# sml - SML 在位级别比较文件

> ID：223973
> 
> 赞同：1
> 
> 时间：2008-10-21T23:48:17.877
> 
> 标签：sml, smlnj

我正在尝试使用 SML 比较目录中的文件。使用 TextIO 库相当容易，但我需要在位级别比较文件。也就是说，二进制比较。我正在使用与此类似的功能：

```
fun listDir (s) = let
    fun loop (ds) = (case OS.FileSys.readDir (ds)
        of "" => [] before OS.FileSys.closeDir (ds)
      | file => file::loop (ds))
      val ds = OS.FileSys.openDir (s)
      in
         loop (ds) handle e => (OS.FileSys.closeDir (ds); raise (e))
      end 
```

列出给定目录中的所有文件。但是现在，我需要查看每个文件中的位。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T03:19:00.463

看看[`BinIO`结构](http://www.smlnj.org/doc/basis/pages/bin-io.html)。

# .net - 大型winforms应用程序中的业务逻辑入侵UI

> ID：223982
> 
> 赞同：8
> 
> 时间：2008-10-21T23:52:22.720
> 
> 标签：.net, unit-testing

我已经不止一次看到这个主题出现了。我希望目前处于类似情况或过去曾有过类似情况的人可以提供一些有见地的建议。如果您也分享过去的经验，这可能会很有用。

因此，多年来开发了一个相当大的 Windows 窗体应用程序。尽管开发团队已经尝试将业务逻辑与 UI 分离，但这并没有完全实现，并且在许多代码区域中业务逻辑与 UI 是硬连接的。事实上，在很多地方都可以看到以前尝试采用 MVP 架构的残余。也有单元测试，但代码覆盖率相对较低。然而，有一些热点——每个人都知道的领域已经变得更加复杂，它们必然需要。

很多时候，只有在测试人员拿起手电筒并真正开始寻找错误时才发现可能更早发现的错误，不幸的是为时已晚、昂贵且有风险。工程、测试人员和产品经理——都意识到需要做一些事情。

什么是完全解决这种情况或改善这种情况的最实际的方法？既然这将是一项长期的任务，那么衡量目标进展的最佳方法是什么？开始时如何用客观的术语来定义目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-21T23:59:55.543

您需要重新架构业务层，然后将 UI 连接回这个重新架构的层。
在完成此操作时，您保持现有 UI 和硬连线业务逻辑继续运行，并一次将其切换到新的表单。

这样做的好处是允许您在影响很小的情况下添加您需要的所有单元测试和自动化测试工具。您还可以确保您的组件正在执行它们需要正确执行的操作。

基本上，这是一项长期投资，短期内投资回报有限，但在中长期（实际上只是长期）中具有潜在的巨大利益。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T00:21:25.580

产品的盈利能力如何？团队有多大？

这些问题将是您解决问题的起点。团队越有利可图，规模越大，你就能越快地将代码重构为更新的形式。

但是对于大型项目，代码更改通常存在很大风险。必须有一些多年来没有被关注的“正常工作”的领域。在这些领域发现错误将是一个巨大的挑战。让你的齿轮旋转甚至调试这些区域都需要一段时间。

我的想法是详细研究代码。当你真的确定你知道它很冷时，向代码库中知识渊博的其他人做一个演示。这将指出你认为你知道但不知道的下一批代码。随着代码开始进入您的脑海，您脑海中就会浮现出对所需内容的更清晰和更清晰的画面。然后你就可以为第一步制定计划了。让它变得合理，不要咬太多。

最重要的是，学习并享受乐趣。只要您有正确的态度，重新处理一个大型项目可能会很有趣。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T00:07:12.863

“侵入 UI 的业务逻辑”……我喜欢这个词的选择。

*   首先，通过单元测试来提高代码覆盖率。
*   之后，查看 Martin Fowler 的[Refactoring](http://www.refactoring.com/)一书。
*   应用一长串[提取类](http://www.refactoring.com/catalog/extractClass.html)重构来形成领域层。在每一个之后，重新运行您的单元测试以确保您有绿色条。
*   一旦您对新代码感到满意，请删除旧代码。
*   最终，你会想要[介绍 Controller](http://www.refactoring.com/catalog/introduceAController.html)。

当然，一个棘手的部分是对 UI 进行单元测试。您可能必须首先在 UI 本身中[提取方法](http://www.refactoring.com/catalog/extractMethod.html)，以便对其中浮动的逻辑位进行单元测试，然后按照上述步骤操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T00:00:41.097

听起来你面临着相当大的挑战！

从广义上讲，我认为您必须首先与您的团队合作，以非常清楚地定义您认为可以接受的内容和不可接受的内容。

根据我的经验，一定程度的业务逻辑（例如验证）必须在 UI 中（尽管它也应该在业务层中强制执行）。

一旦你清楚地定义了什么是可接受的，什么是不可接受的，列出项目中的违规行为应该是一项相对机械（尽管令人生畏）的任务。

这将使您清楚地表明问题的规模——如果您打算以任何可衡量的方式解决它，这确实是您唯一可以明智地开始的地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T23:54:29.470

对我来说听起来像是一个典型的应用程序。

# php - 使用 PHP 进行实时视频流

> ID：223983
> 
> 赞同：39
> 
> 时间：2008-10-21T23:53:12.937
> 
> 标签：php, video, streaming

我有一个 PHP/AJAX/MYSQL 聊天应用程序。我想在我的应用程序中添加视频聊天。如何在 PHP 应用程序中创建用于实时视频会议/聊天的实时视频流。如果我想构建这样一个系统，我需要知道哪些关键术语？首先使用 PHP 是个好主意吗？有什么我没有考虑的吗？我可以使用哪些其他语言，也许与 PHP 结合使用？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-22T01:42:28.880

我并不是说你必须放弃 PHP，但你需要不同的技术。

让我们从简单的开始（没有 Akamai :-)）并考虑这里的含义。视频、聊天等 - 一开始都是客户端。用户有一个网络摄像头，您想以某种方式获取信号并将其发送到服务器。到目前为止还没有 PHP。

我知道 Flash 支持这一点（查看[有关网络摄像头和 flash 的本教程](http://www.adobe.com/devnet/flash/articles/webcam_motion.html)），因此您可以使用 Flash 将内容传输到服务器。我认为如果您继续使用 Flash，那么[Flex](http://www.adobe.com/products/flex/)（[flex 和网络摄像头教程](http://blog.flexexamples.com/2008/01/22/displaying-a-webcams-video-in-a-flex-videodisplay-control/)）可能是一个值得研究的好主意。

所以这些只是基础知识，也许它可以让您了解需要研究的地方，因为显然这不会在您的应用程序中为您提供完整的视频聊天。对于初学者，您将需要某种方式来记录流并*重新发布*它们，以便其他人从聊天中看到其他人等。

我也不确定这会消耗多少流量和带宽，一般来说，解决这个问题需要的不仅仅是 Stackoverflow 问题。最好的办法是对你的应用做一个完整的规范，然后雇佣一些人来帮助你构建它。

！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-01T07:12:38.603

> Please note that the below described service is no longer available as it was based on FLV media (Flash)

This project which utilizes the Red5, Flex and PHP for Live Video Streaming and Recording has many features

1.  Stream Live video to the viewers

2.  Record the streams from your cam or other video input devices to the server

3.  Preview the recorded streams and files and thumbnail the frame which you would like to display for the video.

4.  Upload the videos from your computer and convert them to FLV which can be streamed using Red5 .

5.  Choose from any resolutions

6.  Can be plugged to any script

7.  Each website user can have a separate Directory for storing their videos and thumbnails use this link [http://code.google.com/p/red5-flex-streamer/](http://code.google.com/p/red5-flex-streamer/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-22T00:45:43.703

PHP 将允许您构建构成视频会议和聊天应用程序的站点页面，但它不会为您提供或流式传输视频 - PHP 仅在服务器上运行并将 HTML 呈现给客户端浏览器。

对于视频，您需要的第一件事是与 akamai 等人或该领域的众多其他人的实时流媒体帐户。使用此帐户可为您的视频提供一个入口点 - 即：您将流式传输实时视频的服务器。

接下来，您希望将您的视频输出到浏览器 - windows 媒体播放器、flash 或 silverlight 将让您实现这一点 - 将您选择的技术的适当控件嵌入到您的页面（使用 PHP 或其他）并给出您的直播地址视频馈送。

PHP（或其他脚本语言）将用于构建应用程序的聊天部分并将整个事物组合在一起（聊天和嵌入式视频播放器）。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T04:34:09.017

对于实时视频会议，您不能忽视流媒体服务器的需求。

是的，flash 可以让您在本地 flash 控件中显示来自网络摄像头的视频，但这不会让您通过网络发送该视频 - 因为您需要一个流媒体服务器将其发送到。

如果您要构建这样的东西，那么从一开始就考虑如何托管视频是明智的，因为它会影响您构建应用程序的方式。Flash/Flex/Silverlight/Windows Media....等....

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-22T00:11:54.350

PHP/AJAX/MySQL 不足以创建实时视频流应用程序 这里有一个类似的[线程](https://stackoverflow.com/questions/219476/using-php-to-access-a-users-webcam)。它主要建议使用 Flex 或 Silverlight。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-25T11:24:00.930

有很多“现成的”“服务器”将在您的环境中运行。其中大部分使用前面提到的 Flex 或 Silverlight 来实现实际的视频本身，但我很确定所有这些都将在 LAMP/PHP 下运行。

挑战将是从所有可用的软件中挑选最好的软件，并让您的托管服务提供商让您流式传输视频（不用说流式传输对带宽很重要）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-08-05T10:49:19.103

您可以根据要求轻松构建网站。PHP 将在那里处理网站开发部分。所有托管和正常的网站开发都将按原样工作。但是，对于流媒体部分，您必须选择一个好的流媒体服务。无论是 Red5 还是 Adob​​e，您都可以从众多服务中进行选择。

选择提供专用存储的服务以正确完成工作。如果您不知道如何正确配置服务器，您可以选择流媒体服务。良好的服务通常会提供有助于有效广播流的 CDN。只需在 PHP 中启动您的网站并将 YouTube 播放器嵌入到所述网页中即可使其正常工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-08T13:42:20.283

同样的问题/答案[在这里](https://stackoverflow.com/questions/12782644/add-making-video-call-and-voice-call-to-my-site-php/12782932#12782932)，引用如下

> 我假设您的意思是您想要运行自己的私人视频通话，而不是简单地链接到 Skype 通话或类似的通话。您在这里确实有 2 个选择：自己托管，或使用托管解决方案并将其集成到您的产品中。
> 
> * * *
> 
> 自托管 ----------------- 这很混乱。这一切都可以用 PHP 来完成，但这可能不是最可取的解决方案，因为它不是所有方面工作的最佳工具。Flash 在用户端的 a/v 捕获和传输方面效率更高。您可以尝试在不使用 Flash 的情况下执行此操作，但您会感到头疼。HTML5 可能会让您的生活更轻松，但如果您追求最大的兼容性，flash 是创建客户端的最简单方法。然后，就中继音频/视频的实际服务器端而言，您可以用 php 编写聊天服务器，但最好使用开源项目，例如 [janenz00](https://stackoverflow.com/users/1142004/janenz00)提到的[red5](http://code.google.com/p/red5/)，它已经通过您的客户端构建并与之交互（如果它还没有）。或者，您可以像之前提到的那样自制一个 Flash 客户端，并将其连接到两侧的 Flash 流媒体服务器……无论哪种方式，它都会很快变得复杂，而且我的专业知识根本无法帮助您。
> 
> * * *
> 
> 托管服务 ----------------- 总而言之，我的建议是，除非您想管理许多复杂服务器和故障点的荒谬设置，否则请使用像 [UserPlane](http://www.userplane.com/)或类似的托管服务并将所有处理和技术工作卸载给擅长此操作的人，然后担心与他们的 api 接口并让他们的客户端很好地集成到您的站点中。如果你这样做，你将成为一个更快乐的开发者。

# ruby-on-rails - 使用表单助手设置 tabindex 的自动方法

> ID：223984
> 
> 赞同：17
> 
> 时间：2008-10-21T23:53:38.100
> 
> 标签：ruby-on-rails

在 Rails 中使用表单助手时，是否有一种简单的方法可以让表单助手自动设置 tabindex 参数？

基本上，我不想在构建表单时手动设置每个表单元素上的选项卡索引（我在更改内容时总是忘记更新它们）。我写的大部分表格基本上都是一个字段列表。选项卡索引应该按照它们定义的顺序排列。理想情况下，我会在`form_for`调用中设置初始索引，其他一切都会为我处理。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-22T08:08:26.150

我通常会添加这样的方法`ApplicationHelper`

```
def autotab
  @current_tab ||= 0
  @current_tab += 1
end 
```

然后在我看来，我用这样的方式调用助手`:tabindex => autotab`：

```
<%= text_field "post", "login",:tabindex => autotab, :value => @login %> 
```

您还可以一次修改所有`text_field`, `check_box`, 方法以自动添加 tabindex，方法是向您的应用程序助手添加类似这样的内容：（未经测试，但您明白了）

```
def text_field_with_tabindex(*args)
  options = args.last
  options[:tabindex] = autotab if options.is_a?(Hash) && options[:tabindex].nil?

  text_field_without_tabindex(*args)
end

def self.included(base)
  base.class_eval do
    alias_method_chain :text_field, :tabindex
  end
end 
```

这可能比它的价值更麻烦

# python - 如何在 django 模板中执行查询过滤

> ID：223990
> 
> 赞同：92
> 
> 时间：2008-10-21T23:55:57.487
> 
> 标签：python, django, django-templates

我需要从 django 模板中执行过滤查询，以在视图中获取一组等效于 python 代码的对象：

```
queryset = Modelclass.objects.filter(somekey=foo) 
```

在我的模板中我想做

```
{% for object in data.somekey_set.FILTER %} 
```

但我似乎不知道如何编写过滤器。

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2008-10-22T00:00:27.900

你不能这样做，这是设计使然。Django 框架的作者打算将表示代码与数据逻辑严格分离。过滤模型是数据逻辑，输出 HTML 是表示逻辑。

所以你有几个选择。最简单的方法是进行过滤，然后将结果传递给`render_to_response`. 或者你可以在你的模型中写一个方法，这样你就可以说`{% for object in data.filtered_set %}`. 最后，您可以编写自己的模板标签，尽管在这种特定情况下我建议不要这样做。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2013-05-07T21:41:18.687

我只是添加了一个额外的模板标签，如下所示：

```
@register.filter
def in_category(things, category):
    return things.filter(category=category) 
```

然后我可以这样做：

```
{% for category in categories %}
  {% for thing in things|in_category:category %}
    {{ thing }}
  {% endfor %}
{% endfor %} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-23T17:22:35.767

我经常遇到这个问题，并且经常使用“添加方法”解决方案。但是，肯定存在“添加方法”或“在视图中计算”不起作用（或效果不佳）的情况。例如，当您缓存模板片段并需要一些重要的数据库计算来生成它时。除非您需要，否则您不想做 DB 工作，但在深入了解模板逻辑之前，您不会知道是否需要。

其他一些可能的解决方案：

1.  [使用http://www.djangosnippets.org/snippets/9/](http://www.djangosnippets.org/snippets/9/)上的 {% expr <expression> as <var_name> %} 模板标签。表达式是任何合法的 Python 表达式，模板的 Context 作为本地范围。

2.  更改您的模板处理器。Jinja2 ( [http://jinja.pocoo.org/2/](http://jinja.pocoo.org/2/) ) 的语法几乎与 Django 模板语言相同，但具有完整的 Python 功能。它也更快。您可以批量执行此操作，或者您可以将其使用限制为*您*正在处理的模板，但对设计师维护的页面使用 Django 的“更安全”模板。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-09-10T11:37:01.857

另一种选择是，如果您有一个始终想要应用的过滤器，请在相关模型上添加一个[自定义管理器](https://docs.djangoproject.com/en/1.4/topics/db/managers/#custom-managers)，该管理器始终将过滤器应用于返回的结果。

一个很好的例子是`Event`模型，对于模型上 90% 的查询，您将需要类似 的`Event.objects.filter(date__gte=now)`内容，即您通常对`Events`即将到来的内容感兴趣。这看起来像：

```
class EventManager(models.Manager):
    def get_query_set(self):
        now = datetime.now()
        return super(EventManager,self).get_query_set().filter(date__gte=now) 
```

在模型中：

```
class Event(models.Model):
    ...
    objects = EventManager() 
```

但同样，这对`Event`模型上完成的所有默认查询应用相同的过滤器，因此上述一些技术并不灵活。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-12-23T12:27:28.033

这可以通过赋值标签来解决：

```
from django import template

register = template.Library()

@register.assignment_tag
def query(qs, **kwargs):
    """ template tag which allows queryset filtering. Usage:
          {% query books author=author as mybooks %}
          {% for book in mybooks %}
            ...
          {% endfor %}
    """
    return qs.filter(**kwargs) 
```

**编辑：** assignment_tag 在 Django 2.0 中被删除，这将不再有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-04-30T09:13:01.020

对于任何在 2020 年寻找答案的人。这对我有用。

在视图中：

```
 class InstancesView(generic.ListView):
        model = AlarmInstance
        context_object_name = 'settings_context'
        queryset = Group.objects.all()
        template_name = 'insta_list.html'

        @register.filter
        def filter_unknown(self, aVal):
            result = aVal.filter(is_known=False)
            return result

        @register.filter
        def filter_known(self, aVal):
            result = aVal.filter(is_known=True)
            return result 
```

在模板中：

```
{% for instance in alarm.qar_alarm_instances|filter_unknown:alarm.qar_alarm_instances %} 
```

在伪代码中：

```
For each in model.child_object|view_filter:filter_arg 
```

希望有帮助。

# javascript - 如何使用 JavaScript 获取 HTML 节点所属的窗口对象？

> ID：223991
> 
> 赞同：10
> 
> 时间：2008-10-21T23:56:02.370
> 
> 标签：javascript, xul, xulrunner

由于有几个 iframe、XUL 浏览器元素等等，我的 XULRunner 应用程序中有很多窗口对象。我正在寻找使用 JavaScript 查找指定节点所属的窗口对象的最佳方法。

所以，更具体地说，给定节点 x，我需要找到包含 x 的特定窗口对象。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-04-28T10:06:32.707

+1 对您的问题，这正是我正在寻找的，并感谢您通过回答自己直接给出的提示。

我用谷歌搜索了一下，根据[http://www.quirksmode.org/dom/w3c_html.html](http://www.quirksmode.org/dom/w3c_html.html)跨浏览器表，我认为正确的答案是：

```
function GetOwnerWindow(html_node)
{
   /*
   ownerDocument is cross-browser, 
   but defaultView works on all browsers except Opera/IE that use parentWinow
   */
   return (html_node.ownerDocument.defaultView) ?
      html_node.ownerDocument.defaultView : 
      html_node.ownerDocument.parentWindow;
} 
```

或者甚至更好：

```
return html_node.ownerDocument.defaultView || html_node.ownerDocument.parentWindow; 
```

请让我知道你的想法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T00:00:10.863

您可能想使用**self**。self 是对当前文档的引用。

**从 iframe 中：**

```
<body>
<div id="example">Example!</div>
<script type="text/javascript">
    window.onload = function () {
        var exampleNode = document.getElementById('example');
        exampleNode.bar = function () {
            // The highest window object:
            top;
            // The parent node:
            self;
            // The parent node ( except in IE );
            this.ownerDocument.defaultView;
        };
    };
</script>
</body> 
```

**遍历多个窗口对象：**

在浏览器对象模型中，主窗口对象称为**top**。其他全局对象排列在树结构中，该结构源于顶部。**通过对top**的引用，您可以使用它们的**名称和关系**导航到树中的其他全局对象，这与**遍历 DOM**的方式非常相似。

当您有多个窗口对象时，就像在 iframe 的情况下（使用老式框架集）一样，框架具有**name 属性**。给定对象相对于顶部窗口对象的位置，您可以使用子对象的名称来访问该对象。

`<iframe src ="/default.html" name="advertisement"></iframe>`

然后从顶部窗口的上下文中：

`self.advertisement`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-22T00:13:09.527

我找到了我所追求的属性组合：

node.ownerDocument.defaultView

这将返回节点所属的窗口对象。请注意，这在 IE 中不起作用。

# php - 您如何调试 SugarCRM 问题/了解 SugarCRM 的工作原理？

> ID：223993
> 
> 赞同：15
> 
> 时间：2008-10-21T23:57:00.793
> 
> 标签：php, sugarcrm

我正在尝试将我们的公司从 SalesForce 转移到 SugarCRM，但我遇到了一个令人讨厌的错误（当我将自定义字段添加到 Accounts 时，所有帐户都停止显示）。我们已经支付了 SugarCRM 人员的支持费用，但他们只为开源版本提供了“永远然后得到一个毫无价值的响应”级别的技术支持（我们避免了像瘟疫这样的专有软件）。哦，我有没有提到我们的 Salesforce 合同在本周末到期？

所以，长话短说，我一直在自己调试 SugarCRM 应用程序。我是一位经验丰富的程序员，我有基本的 PHP 能力，但我什至不知道在哪里尝试解决这个问题。那里的任何 Sugar 开发人员都可以推荐任何一种调试 Sugar 的过程吗？是否有任何资源可以帮助我了解不同的 PHP 文件的作用，或者 Sugar 系统的整体工作方式？

就像我正在谈论的那种事情的一个例子：我想出了如何让糖来打印堆栈跟踪，并且通过遵循几个我注意到一个模式，其中包含所有涉及的问题行

```
$this->_tpl_vars
```

我很想尝试弄清楚为什么该方法调用不起作用，但我不知道：

A）`_tpl_vars`应该做什么
B）在哪里`_tpl_vars`定义
C）`$this`应该是什么
D）在框架中`$this`设置的位置
等。

因此，如果有人可以帮助解释我将如何/从哪里开始寻找这些问题的答案，我将非常感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-24T16:30:41.863

几年前我曾与 SugarCRM 合作过，虽然我喜欢我在表面上看到的东西，但由于您现在所经历的，我最终拒绝了我们的项目。可悲的是，该产品的内部记录不足。我曾设想为该产品编写一堆精巧的模块，但资源根本不存在。您将花费所有时间来挖掘代码、翻阅论坛帖子，并尝试找到您想要完成的工作的示例。听起来事情并没有变得更好。

鉴于您的 PHP 经验低于大师级别，而且您无疑忙于许多其他任务和截止日期，我认为如果为时不晚，您可能应该重新考虑这种过渡，至少在您获得更好的舒适之前与糖水平。如果您因为与 Salesforce 的合同到期而被迫搬到 Sugar，我认为您可能会遭受严重的胃灼热！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-10-14T15:34:53.993

使用[Krumo](http://krumo.sourceforge.net/)库来提供帮助。它超级简单，而且比`var_dump`or更好`print_r`。

只需下载源代码并将其添加到您的自定义文件夹中的某个位置。我使用自定义/包含文件夹。

然后覆盖视图或您需要查看的任何内容。包括文件 class.krumo.php 文件的路径，以及 krumo 任何您想查看的对象：

快速示例 -

```
<?php
  require_once('include/MVC/View/views/view.detail.php');
  require_once('custom/include/krumo/class.krumo.php');
  class AccountsViewDetail extends ViewDetail {

    function AccountsViewDetail() {
      parent::ViewDetail();
    }

    // Override the parent function "preDisplay" to add our own template
    function preDisplay(){
      krumo($this->bean);
      $metadataFile = $this->getMetaDataFile();
      $this->dv = new DetailView2();
      $this->dv->ss =&  $this->ss;
      $this->dv->setup($this->module, $this->bean, $metadataFile, 'custom/modules/Accounts/tpls/AccountsDetailView.tpl');
    }

  }
?> 
```

您将在页面上获得一个可以钻取的漂亮对象。

![在此处输入图像描述](https://i.stack.imgur.com/NWNdJ.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-23T22:23:51.400

虽然这不是我问题的完美答案，但这篇文章：

[http://developers.sugarcrm.com/wordpress/2008/09/26/where-is-the-code-for-x/](http://developers.sugarcrm.com/wordpress/2008/09/26/where-is-the-code-for-x/)

确实有点帮助。此外，当我进一步查看官方的 Sugar 文档时，我发现开发人员指南确实包含了一些关于 Sugar 工作原理的解释（尽管显然它不像关注如何让 Sugar 做新事物那样关注 Sugar 的工作原理）。

希望这可以帮助任何其他新兴的 Sugar 开发人员。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-06T09:02:05.693

这些代码来自 Smarty 库，而不是直接来自 SugarCRM。

也许这个 chm 文档会有点帮助，[http://code.google.com/p/sugardoc/downloads/list](http://code.google.com/p/sugardoc/downloads/list)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-06T15:42:21.490

您还可以尝试安装 xdebug（PHP 扩展）并使用兼容的 IDE（例如 eclipse 或 Komodo）单步执行代码。

URL 告诉您正在访问哪个模块目录以及哪个操作/视图。大多数模块下都有一个“views”文件夹。如果它不存在，它要么使用包含文件夹中的默认 MVC 视图和元数据布局，要么使用经典视图架构：index.php (listview)、DetailView.php 和 EditView.php 和模板。

在过去的几年里，很多事情都变得更好了，所以我不确定第一个答案（Nack）是否仍然相关。它的边缘仍然很粗糙，但是新的 Sugar 框架是 PHP 黑客最好的朋友（真的很容易以升级友好的方式覆盖东西）。对于碰巧已经拥有 PHP 黑客并且只需要一些增强功能的公司来说，这非常有用。找到负担得起的 PHP 承包商来提供帮助并不难（免责声明：我就是其中之一）。我认为如果你喜欢开源，它是一个很棒的工具，只需要基本的 CRM 并且用户少于 100 个。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-18T10:50:21.493

tpl 是 smarty 模板文件。在屏幕上显示数据时使用它们。我如何进行调试过程是创建大量的 var 转储到错误 lof，或者只是将它们打印在屏幕上。

还要在服务器上获取 xdebug，这将对您有很大帮助。Sugar 是 mvc 平台，所以了解它是如何工作的，然后会容易得多。

看看我在 www.eontek.rs 上发布的一些片段

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-09-28T04:11:05.220

如果我遇到同样的问题，当帐户的详细信息页面没有显示并给出 500 内部错误时。我检查了它不是由 TPL 生成的。起初我检查了该文件夹的权限，就我而言，它们都已设置。所以我备份了 cache\modules\accounts\DetailView.tpl 并手动添加了该字段，之后一切正常。每次在开发者模式下都需要手动复制这个文件。这是一种痛苦，但仍然没有答案。我在论坛、Bug、Twitter 上问过这个问题，没有任何帮助。顺便说一句，我们正在使用 Sugar Professional。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-08T18:00:18.813

我建议确保它确实是一个代码错误，而不仅仅是一个未配置的错误。您是通过 Admin > Studio > Contacts > Fields 还是通过 SOAP API 添加字段？

您使用的是最新版本的 Sugar 吗？

我真的同意该项目的文档严重不足并且缺乏教程和示例。

我自己正在经历过时/丢失文档的痛苦。祝你好运！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T00:54:24.397

`$this`是对当前对象的引用。

```
class Test {

    var $tmp;

    function __construct() {
        $this->tmp = 42;    
    }
} 
```*****************