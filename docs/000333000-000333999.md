# StackOverflow 问答 000333000-000333999

# c++ - C++类识别题

> ID：333029
> 
> 赞同：2
> 
> 时间：2008-12-02T04:08:58.147
> 
> 标签：c++, class, identification

我将用一个例子的形式来表达这一点，以使其更清楚。

假设我有一个动物向量，我想通过数组查看元素是狗还是猫？

```
class Dog: public Animal{/*...*/};
class Cat: public Animal{/*...*/};

int main()
{
vector<Animal*> stuff;
//cramming the dogs and cats in...

for(/*all elements in stuff*/)
//Something to the effect of:  if(stuff[i].getClass()==Dog) {/*do something*/}

} 
```

我希望这有点清楚。我知道 typeid，但我真的没有任何 Dog 对象可以与之比较，如果可以的话，我想避免创建 Dog 对象。

有没有办法做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-02T04:40:06.523

正如其他人所指出的，您既不应该使用`typeid`, 也不应该使用`dynamic_cast`运算符来获取指针指向的动态类型。创建虚函数是为了避免这种讨厌的事情。

**无论如何，如果您真的**想这样做，这就是您要做的（请注意，取消引用迭代器会给您`Animal*`。因此，如果您这样做`**it`，您将得到一个`Animal&`）：

```
for(std::vector<Animal*>::iterator it = v.begin(); it != v.end(); ++it) {
    if(typeid(**it) == typeid(Dog)) {
        // it's a dog
    } else if(typeid(**it) == typeid(Cat)) {
        // it's a cat
    }
} 
```

请注意，您也可以将`typeid`运算符应用于类型本身，如上所示。您不需要为此创建对象。另请注意，如果您将指针传递给 typeid 方式，则它不起作用`typeid(*it)`。像那样使用它只会给你带来`typeid(Animal*)`无用的东西。

类似，`dynamic_cast`可以使用：

```
for(std::vector<Animal*>::iterator it = v.begin(); it != v.end(); ++it) {
    if(Dog * dog = dynamic_cast<Dog*>(*it)) {
        // it's a dog (or inherited from it). use the pointer
    } else if(Cat * cat = dynamic_cast<Cat*>(*it)) {
        // it's a cat (or inherited from it). use the pointer. 
    }
} 
```

请注意，在这两种情况下，您的 Animal 类型都应该是多态的。这意味着它必须具有或继承至少一个虚拟功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T04:13:09.683

`dynamic_cast`只要向量包含 Animal 指针，您就可以使用。

```
vector <Animal *> stuff;

for(int i=0;i<stuff.size();i++) {
    Dog *pDog = dynamic_cast <Dog *> (stuff[i]);
    if(pDog) {
        // do whatever with the dog
    }

    Cat *pCat = dynamic_cast <Cat *> (stuff[i]);
    if(pCat) {
        // and so on
    }
} 
```

但您应该知道，这通常不是最佳做法。您应该尝试使用多态性，而不是反对它。换句话说，尝试编写一个虚`Animal`函数`Dog`并`Cat`覆盖，并让编译器自动调用正确的函数。

（而且，`dynamic_cast`速度相对较慢，所以太多会影响性能；而虚函数调用通常只是一条指令。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T04:14:49.460

你确定要这样做吗？你要做的是与多态完全相反，多态是面向对象编程中最好的东西。

*粗略地说：如果您的动物是狗*，请不要做某事；让 Animal 层次结构知道当其中一个对象是 Dog 时该做什么！:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T04:59:04.927

如果你真的需要你的应用程序级别来识别狗和非狗，你应该避免使用 RTTI (`dynamic_cast`和`typeid`)，并在你的类层次结构中明确表示这些知识。

```
for (size_t i = 0; i != v.size(); ++i) {
    if (v[i]->isDog()) { v->cleanupPoop(); }
} 
```

有一些小的性能优势，但主要的优势是将类接口中的必要行为公开给维护程序员。为了使类层次结构起作用，不应该需要 RTTI（尽可能受限）。

现在，与其他人所说的一样，该`isDog()`函数很可能被重构为不需要预先了解整个层次结构的东西（例如`needsPoopCleanup()`）。就像其他人所说的那样，如果您的应用程序逻辑无论如何基于对象类型有条件地执行，那么您将失去多态性的好处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T04:16:18.523

您可以使用`typeid`运算符来执行此操作，例如

```
if (typeid(stuff[i].getClass())==typeid(Dog)) 
```

但是，如果它是 的派生类，则无法捕获`Dog`。你可以使用 a `dynamic_cast`。然而，任何使用`typeid`或`dynamic_cast`通常表示设计缺陷。通常，您不需要知道派生类型是什么，并且可能有更好的方法涉及多态性。但是，如果没有真实的例子，很难给出正确的建议。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T05:14:23.460

# 使用虚函数：

正如其他人的反应所示，使用虚函数实际上就足够了，并且是“C++”的思维方式。下面是一个使用虚函数的例子：

```
#include<iostream>
#include<vector>
using namespace std;

/////////////

class Animal {
  public:
    virtual void move() { cout << "animal just moved" << endl; }
};
class Dog : public Animal {
  public:
    void move() { cout << "dog just moved" << endl; }
};
class Cat : public Animal {
  public:
    void move() { cout << "cat just moved" << endl; }
};

void doSomethingWithAnimal(Animal *a) {
  a->move();
}

/////////////

int main() {
  vector<Animal*> vec;
  vector<Animal*>::iterator it;

  Animal *a = new Animal;
  Dog *d = new Dog;
  Cat *c = new Cat;

  vec.push_back(a);
  vec.push_back(d);
  vec.push_back(c);

  it = vec.begin();

  while( it != vec.end() ) {
    doSomethingWithAnimal(*it);

    it++;
  }

  return 0;
} 
```

如果这还不够，那么其他人已经发布了实际上使用条件逻辑而不是聚合逻辑的答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-02T05:15:49.573

接受的答案是正确的，但您应该知道还有另一个选项没有被提及。你可以在 Animal 类中有一个名为“type()”的虚函数，它可以返回一个 int 或一个字符串（或任何可比较的类型）。

例如：

```
class Animal {
    /*...*/
public:
    virtual std::string type() const { return "animal"; }
};

class Dog: public Animal{
    /*...*/
public:
    virtual std::string type() const { return "dog"; }
};

class Cat: public Animal{
    /*...*/
public:
    virtual std::string type() const { return "cat"; }
}; 
```

这样你就可以这样做：

```
if(array[i]->type() == "dog") { } 
```

type 函数可以返回任何东西（每个派生类型唯一的 int 也可以，但字符串可以更好地说明它）。

只是另一种选择。

# statistics - 开源或免费的财务分析程序/库

> ID：333030
> 
> 赞同：6
> 
> 时间：2008-12-02T04:09:17.070
> 
> 标签：statistics, finance

我正在寻找包含与 Matlab 的金融和金融衍生工具箱类似功能的东西，但没有现金可以花在 matlab 上。我将不胜感激有关免费或开源库或程序的任何信息，这些信息可以让我轻松计算利率、风险等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-02T04:15:19.773

[JQuantLib](http://www.jquantlib.org/index.php/Main_Page)或[QuantLib](http://quantlib.org/index.shtml)怎么样？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T04:13:43.630

[Octave](http://www.gnu.org/software/octave/)财务功能怎么样？

[http://www.gnu.org/software/octave/doc/interpreter/Financial-Functions.html#Financial-Functions](http://www.gnu.org/software/octave/doc/interpreter/Financial-Functions.html#Financial-Functions)

我不熟悉 Matlab 工具箱，所以你必须自己判断。

> GNU Octave 是一种高级语言，主要用于数值计算。它提供了一个方便的命令行界面，用于数值求解线性和非线性问题，以及使用与 Matlab 最兼容的语言执行其他数值实验。它也可以用作面向批处理的语言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T05:10:14.920

你究竟需要什么功能？有多先进？您在 .Net 中有一些财务功能

我确定它不能涵盖所有内容，但计算兴趣和其他一些没有问题：

[http://msdn.microsoft.com/en-us/library/daksysx3(VS.80).aspx](http://msdn.microsoft.com/en-us/library/daksysx3(VS.80).aspx)

> 计算折旧。**DDB、SLN、SYD**
> 
> 计算未来价值。 **FV**
> 
> 计算利率。 **速度**
> 
> 计算内部收益率。 **内部收益率、内部收益率**
> 
> 计算周期数。 **NPer**
> 
> 计算付款。 **IPmt、Pmt、PPmt**
> 
> 计算现值。 **净现值、现值**

# nunit - 这安全吗？- NUnit 基类打开和回滚一个 TransactionScope

> ID：333033
> 
> 赞同：2
> 
> 时间：2008-12-02T04:12:22.633
> 
> 标签：nunit, transactionscope

我想为 NUnit 测试夹具创建一个基类会很好，它在 SetUp 阶段打开一个 TransactionScope，然后在拆卸期间回滚事务。像这样的东西：

```
 public abstract class TestFixtureBase
{
    private TransactionScope _transaction;

    [TestFixtureSetUp]
    public void TestFixtureSetup()
    {
        _transaction = new TransactionScope();
    }

    [TestFixtureTearDown]
    public void TestFixtureTearDown()
    {
        if (_transaction != null)
        {
            _transaction.Dispose();
        }
    }
} 
```

你认为这是个好主意吗？

显然，该数据库只是一个测试数据库，而不是实时数据库，但如果它充满了来自单元测试的垃圾数据，它仍然会很烦人。

当运行涉及大量数据访问的单元测试时，其他人会做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T04:19:57.017

你要在这里小心。如果您打开多个与数据库的连接，TransactionScope 会将事务提升为分布式事务。我发现在开始运行测试之前编写一些简单的 SQL 来清除我的测试类感兴趣的表会更容易。

**编辑：**通常我会将任何涉及数据库的测试称为集成测试，因为它涉及另一个系统。通常，我会在对代码进行单元测试时模拟数据库。

```
[TestSetup]
public void Setup()
{
   foreach (string table in new string[] { "table1", "table2" })
   {
        ClearTable( table );
   }
}

private void ClearTable( string table )
{
     ...standard stuff to set up connection...
     SqlCommand command = connection.CreateCommand() );
     command.CommandText = "delete from " + table;
     command.ExecuteNonQuery();
     ... stuff to clean up connection...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T19:04:49.767

我用过[XtUnit](http://weblogs.asp.net/rosherove/archive/2004/10/05/238201.aspx) 它会在单元测试结束时自动回滚。您可以简单地将 [Rollback] 属性添加到测试中。它是 NUnit 或 MbUnit 的扩展

# c++ - C++中线程的使用

> ID：333043
> 
> 赞同：6
> 
> 时间：2008-12-02T04:15:51.177
> 
> 标签：c++, multithreading

你能告诉我如何在 C++ 程序中使用线程，以及如何编译它，因为它将是多线程的？你能告诉我一些可以从根目录开始的好网站吗？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-02T04:20:34.473

我自己没有使用过它，但有人告诉我 Boost 线程库使它变得异常简单。

[http://www.boost.org/doc/libs/1_37_0/doc/html/thread.html](http://www.boost.org/doc/libs/1_37_0/doc/html/thread.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T04:18:24.900

对于 Unix/Linux/BSD，有[pthread](http://opengroup.org/onlinepubs/007908799/xsh/pthread.h.html)库：[tutorial](https://computing.llnl.gov/tutorials/pthreads/)。

我猜在 Win32 API 中有等价物。

*   [进程和线程](http://msdn.microsoft.com/en-us/library/ms684841.aspx)
*   [同步](http://msdn.microsoft.com/en-us/library/ms686353.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-02T08:06:20.710

我使用英特尔线程构建块库中的 tbb_thread 类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T06:21:48.317

我使用我的大学教授写的图书馆。它实现起来非常简单并且效果很好（现在已经使用了很长一段时间）。我会征求他的同意与你分享。

抱歉让您久等了，但必须检查:)

++++++编辑+++++++

好的，所以我和我的教授谈过，他不介意我在这里分享。以下是 Paul Davies 编写的“RT 库”的 .h 和 .cpp 文件

[http://www.filefactory.com/file/7efbeb/n/rt_h](http://www.filefactory.com/file/7efbeb/n/rt_h)

[http://www.filefactory.com/file/40d9a6/n/rt_cpp](http://www.filefactory.com/file/40d9a6/n/rt_cpp)

关于线程和这个库的使用需要注意的几点：

**0) 本教程将解释线程创建和在 windows 平台上的使用。**

1) c++ 中的线程通常被编码为同一源的一部分（与每个进程都有自己的源文件和函数 main() 的进程不同）

2）当一个进程启动并运行时，它可以通过适当的内核调用来创建其他线程。

3) 多线程比多进程运行得更快，因为它们是同一进程的一部分，从而减少了操作系统的开销，并减少了内存需求。

4）您将在您的案例中使用的是 rt 库中的 CThread 类。

5) （确保 rt.h 和 rt.cpp 是您的“解决方案”的一部分，并确保将 rt.h 包含在您的 main.cpp 中）

6) 下面是来自您未来主线程的部分代码（当然是在 main.cpp 中），您将在其中使用 CThread 类创建线程。

```
void main() 
{
    CThread   t1(ChildThread1, ACTIVE, NULL) ;      
    . . . 
    t1.WaitForThread() ;                // if thread already dead, then proceed, otherwise wait

} 
```

t1 的参数按顺序是：充当我们线程的函数的名称、线程状态（它可以是 ACTIVE 或 SUSPENDED - 取决于您想要什么），最后，一个指向您可能想要传递的**可选**数据的指针到创建时的线程。执行一些代码后，您需要调用 WaitForThread() 函数。

7) 下面是来自您未来主线程的部分代码（当然是在 main.cpp 中），您将在其中描述子线程的作用。

```
UINT  _ _stdcall  ChildThread1(void *args)      
{

    . . .           
} 
```

看起来很奇怪的是微软的线程签名。我敢肯定，通过一些研究，您可以弄清楚如何在其他操作系统中执行此操作。参数是可以在创建时传递给子级的可选数据。

8) 可以在 rt.cpp 文件中找到成员函数的详细说明。以下是摘要：

CThread() - 负责创建线程的构造函数

Suspend() - 挂起子线程有效地暂停它。

Resume() - 唤醒一个挂起的子线程

SetPriority(int value) - 将子线程的优先级更改为指定的值

Post(int message) - 向子线程发布消息

TerminateThread() - 终止或杀死一个子线程

WaitForThread() - 暂停父线程，直到子线程终止。如果子线程已经终止，父线程不会暂停

9) 下面是一个示例完整程序的示例。您可以做的一件聪明的事情是创建单个线程的多个实例化。

```
 #include “..\wherever\it\is\rt.h” //notice the windows notation

    int       ThreadNum[8] = {0,1,2,3,4,5,6,7} ;   // an array of thread numbers

    UINT _ _stdcall ChildThread (void *args)    // A thread function 
    {   
        MyThreadNumber = *(int *)(args);    

        for ( int i = 0; i < 100; i ++)
            printf( "I am the Child thread: My thread number is [%d] \n", MyThreadNumber) ;

        return 0 ;
    }
int     main()
{
    CThread     *Threads[8] ;   

// Create 8 instances of the above thread code and let each thread know which number it is.

    for ( int i = 0; i < 8; i ++) {
        printf ("Parent Thread: Creating Child Thread %d in Active State\n", i) ;
        Threads[i] = new CThread (ChildThread, ACTIVE, &ThreadNum[i]) ;
    }

    // wait for threads to terminate, then delete thread objects we created above

    for( i = 0; i < 8; i ++) {
        Threads[i]->WaitForThread() ;
    delete Threads[i] ; // delete the object created by ‘new’
    }
    return 0 ;
} 
```

10) 就是这样！rt 库包含一堆类，使您能够使用进程和线程以及其他并发编程技术。发现其余部分；）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-02T08:14:56.107

有许多与 c++ 兼容的线程库。所以首先你必须选择一个。我更喜欢[OpenMP](http://openmp.org/)或 POSIX 线程（也称为 pthreads）。如何编译它取决于您选择的库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T06:16:19.497

[您可能想阅读我之前关于 SO 的帖子。](https://stackoverflow.com/questions/326487/multithreaded-image-processing-in-c#327143)

（事后看来，该帖子对 pthread 有点片面。但我是一个 Unix/Linux 类型的人。就原始主题而言，这种方法似乎最好。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-27T08:54:51.460

**C/C++中线程的使用：**

```
#include <iostream>

using namespace std;

extern "C" 
{
     #include <stdlib.h>
     #include <pthread.h>
     void *print_message_function( void *ptr );
}

int main()
{
     pthread_t thread1, thread2;
     char *message1 = "Thread 1";
     char *message2 = "Thread 2";
     int  iret1, iret2;

     iret1 = pthread_create( &thread1, NULL, print_message_function (void*) message1);
     iret2 = pthread_create( &thread2, NULL, print_message_function, (void*) message2);

     pthread_join( thread1, NULL);
     pthread_join( thread2, NULL); 

     //printf("Thread 1 returns: %d\n",iret1);
     //printf("Thread 2 returns: %d\n",iret2);
     cout<<"Thread 1 returns: %d\n"<<iret1;
     cout<<"Thread 2 returns: %d\n"<<iret2;

     exit(0);
}

void *print_message_function( void *ptr )
{
     char *message;
     message = (char *) ptr;
     //printf("%s \n", message);
     cout<<"%s"<<message;
} 
```

# c# - 关于传递许多参数

> ID：333056
> 
> 赞同：9
> 
> 时间：2008-12-02T04:30:41.863
> 
> 标签：c#, .net, asp.net, .net-2.0

我有大约 8-9 个参数来传递一个返回数组的函数。我想知道直接在函数中传递这些参数还是传递数组更好？哪种方法更好，为什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-02T04:35:30.060

如果我愿意做任何事情，那就是创建一个包含所有参数的结构，以获得良好的智能和强大的名称。

```
public struct user 
{ 
    public string FirstName; 
    public string LastName; 
    public string zilionotherproperties; 
    public bool SearchByLastNameOnly; 
} 
public user[] GetUserData(user usr) 
{ 
    //search for users using passed data and return an array of users. 
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-02T04:34:46.393

单独传递它们，因为：

*   这是类型安全的方式。
*   IntelliSense 将在 Visual Studio 中获取它，当您编写调用函数时，您将知道是什么。
*   以这种方式执行会更快。

但是，如果参数确实是数组，则传递数组。例子：

对于看起来像这样的函数，请使用以下符号：

```
Array FireEmployee(string first, string middle, string last, int id) {...} 
```

对于看起来像这样的函数，请使用数组：

```
Array FireEmployees(Employee[] unionWorkers) {...} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-02T07:04:37.607

Martin Fowler 的重构书中的 Introduce Parameter Object 重构涵盖了您的场景。这本书非常值得拥有，但对于那些不拥有的人，[这里](http://blogs.jetbrains.com/idea/2008/11/intellij-idea-8-refactorings-introduce-parameter-object/)描述了重构。[出版商网站](http://safari.oreilly.com/9780321603968/ch10lev1sec9)和 Google 图书上也有预览。它建议不要用数组替换参数，而是用一个新对象。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-02T08:35:39.310

关于 Skeets 对上面我的示例的评论，他将使用类而不是结构，并且可能更清楚地在哪里使用类以及在哪里使用结构，我也发布了这个。我认为还有其他人对此也感到好奇。

正如我所见，使用类的主要原因是你可以让它不可变，但是结构也可以吗？

例如：

```
struct user 
{ 
public user(string Username, string LastName) 
{ 
    _username = Username; 
} 
private string _username; 
public string UserName { 
    get { return _username; } 
} 
```

}

很长一段时间以来，当我们可以拥有属性、初始化器、字段以及类在结构中拥有的所有东西时，我一直觉得我不再知道类和结构之间的区别。我知道类是引用类型，结构是值类型，但是在将其用作函数中的参数时，在上述情况下有什么区别？

[我在网站http://www.startvbdotnet.com/oop/structure.aspx](http://www.startvbdotnet.com/oop/structure.aspx)上找到了对差异的描述， 该描述正是我在脑海中映射它的方式：

> 结构可以定义为处理一组逻辑相关数据项的工具。它们是用户定义的，并提供了一种将不同类型的数据打包在一起的方法。结构与类非常相似。与类一样，它们也可以包含字段和方法等成员。类和结构的主要区别在于，类是引用类型，结构是值类型。实际上，结构用于不会长期存在的较小的轻量级对象，而类用于预期会长期存在于内存中的较大对象。

也许这应该是一个自己的问题，但是当我们对结构与类事物作为参数有不同的看法时，我觉得这是相关的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-02T04:43:42.787

我假设您使用的是 C# 4，并且可以只使用命名参数：

```
FireEmployee(
    first: "Frank",
    middle: "",
    last: "Krueger",
    id: 338); 
```

这些使代码几乎与 VB 或 Smalltalk 一样具有可读性。:-)

如果不是，我会同意戴夫马克尔所说的话。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-02T04:45:14.330

如果这是会被大量使用的库代码，并且如果某些参数具有可作为默认值候选的典型值，那么您应该考虑 Dave Markle 的建议，并提供一系列参数逐渐减少的重载。这是 Microsoft 框架设计指南中推荐的方法。

或者，您可以使用 Stefan 的方法获得类似的效果，方法是使用成员初始化器设置默认值并使用一系列 ctor 重载。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-02T04:52:57.917

如果您真的不想单独传递参数，我建议创建一个封装所有参数的新类。为此，您可以（在 Java 中，最有可能在 C# 中）在包含 gnarly 方法的类中声明一个公共内部类。这避免了浮动的类实际上只是辅助类型。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-02T04:55:59.300

我会说也单独通过它们。我不喜欢创建一个类，然后将该类作为参数传递的想法。它是一种标记耦合形式，这意味着由于一个类使用另一个类，因此进行更改将更加困难。重用一个类意味着您也必须重用另一个类。

您可以使用接口来减少标记耦合，但这对我的口味来说开销太大，所以这就是我喜欢单独传递参数的原因。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-02T05:42:18.363

一个函数真的需要 8-9 个参数吗？在我看来，如果您需要这么多参数，那么您可能在该函数中做了太多不同的事情。尝试将代码重构为单独的函数，以便每个函数都有一个目的。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-12-02T05:24:50.270

除非函数作用于数组，否则不要将它们作为数组传递，我也不会创建新的数据结构来对参数进行分组，原因如下

1.  传递一个新的数据结构隐藏了函数真正需要的输入（它是否需要所有的数据结构/它的一部分？）

2.  与 1 相关，它使 UT 变得更加困难（在编写 UT 时，您需要重新创建整个数据结构）

3.  如果输入参数不相关，你最终会得到一个新的数据结构，它将不相关的数据类型分组，只是为了让函数调用看起来更整洁

4.  如果您选择将新数据结构传递给您的函数，则该函数不能在定义新数据结构的范围内使用

实际上，将每个参数传递给函数的唯一缺点是您可能无法将函数放入一行代码中，但不要忘记在函数调用之前需要填写数据结构的行.

# ruby-on-rails - 如何使用冷冻 Capistrano？

> ID：333072
> 
> 赞同：1
> 
> 时间：2008-12-02T04:43:07.220
> 
> 标签：ruby-on-rails, ruby, rubygems, capistrano, release-management

## 背景故事

我在 Rails 2.1 上，需要将 Capistrano gem 冻结到我的供应商文件夹（因为我的主机已经破坏了他们的 cap gem 依赖项，我想让自己尽可能独立）。

在我的本地 Windows 机器上，我将以下内容放在了 environment.rb

```
config.gem "capistrano", :version => "2.5.2"
config.gem "net-ssh", :lib => "net/ssh", :version => "2.0.4"
config.gem "net-scp", :lib => "net/scp", :version => "1.0.1"
config.gem "net-sftp", :lib => "net/sftp", :version => "2.0.1"
config.gem "net-ssh-gateway", :lib => "net/ssh/gateway", :version => "1.0.0" 
```

宝石已经安装，所以我冻结了它们。检查...

```
>rake gems
...
[F] capistrano = 2.5.2
[F] net-ssh = 2.0.4
[F] net-scp = 1.0.1
[F] net-sftp = 2.0.1
[F]net-ssh-gateway = 1.0.0 
```

然后我在本地提交到 SVN 并在 prod Linux 机器上进行更新。

## 问题

当我尝试运行 Capistrano 的冻结版本时，出现以下错误。

```
$ ./vendor/gems/capistrano-2.5.2/bin/cap deploy-with-migrations 
./vendor/gems/capistrano-2.5.2/bin/cap:3:in `require': no such file to load --capistrano/cli (LoadError)
    from ./vendor/gems/capistrano-2.5.2/bin/cap:3 
```

任何想法我做错了什么？

## 更新

[查看新的相关问题](https://stackoverflow.com/questions/339613/how-do-i-use-frozen-capistrano-part-2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T07:46:42.327

你没有做错任何事。您看到这个问题是因为`cap`下面的文件`capistrano/bin/cap`不打算作为独立运行。如果您尝试从主 gem 文件夹运行它，您将看到相同的结果。`cap`可执行文件（存储在标准`/usr/bin/cap`linux 安装中）需要`rubygems`，注册 capistrano，*然后*加载`capistrano/bin/cap`文件。

一种解决方案是添加`require 'rubygems'`到您的 capistrano/bin/cap 文件中：

```
#!/usr/bin/env ruby
require 'rubygems'
require 'capistrano/cli'
Capistrano::CLI.execute 
```

如果您不想修改`capistrano/bin/cap`，则可以在使用 -r 标志运行 ruby​​gems 库时特别包含它。您给定的命令如下所示：

```
$ ruby -r rubygems ./vendor/gems/capistrano-2.5.2/bin/cap deploy-with-migrations 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T11:41:33.927

使用特定版本的 Capistrano 的另一种方法是，为您的 .bash_login 添加别名，如下所示：

```
alias cap1='cap _1.4.2_ ' 
```

其中 cap1 是您将运行的命令，而*1.4.2*是您希望该命令运行的版本，那么您可以：

```
cap1 deploy 
```

然后将使用该版本的 capistrano 来部署您的应用程序。

# .net - 是否有 .NET（C# 或 VB.NET）的 UPnP 库？

> ID：333079
> 
> 赞同：41
> 
> 时间：2008-12-02T04:47:22.453
> 
> 标签：.net, networking, upnp

我正在开发一个 P2P 应用程序，我需要让它使用 UPnP 通过 NAT 路由器/防火墙进行通信。但是，.NET Framework 似乎不包括对 UPnP 的支持。

有 .NET 的 UPnP 库吗？C# 还是 VB.NET？

更新：我已经找到了 NATUPnP 1.0 类型库 (NATUPNP.DLL) COM 组件，它是 Windows 的一部分（从 Windows XP 开始），它允许您使用 UPnP 轻松设置/维护端口转发。

我在这里写了一篇带有代码示例的文章： [.NET Framework: Communicate through NAT Router via UPnP (Universal Plug and Play)](http://pietschsoft.com/post.aspx?id=31200e6d-4b61-48b8-a9cb-91e3dd8e97f3)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2011-05-20T05:59:44.343

我围绕 microsoft UPnP 控制点 COM 对象编写了一个完全托管的 UPnP 库，它提供了完整的源代码和一个演示项目，您可以在此处从 CodePlex 下载它：

[http://managedupnp.codeplex.com/](http://managedupnp.codeplex.com/)

它支持使用对象层次结构完全遍历 UPnP 描述文档，并且非常易于使用。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-02T04:57:32.840

有一个很容易访问的 COM 库：

> **[UPnP API](http://msdn.microsoft.com/en-us/library/aa382303.aspx)用途**
> 
> UPnP™ 框架支持智能设备、无线设备和 PC 的动态联网。有两个 API 可用于使用 UPnP 认证的设备：
> 
> **控制点 API**，由一组用于查找和控制设备的 COM 接口组成。**设备主机 API**，它由一组 COM 接口组成，用于实现由计算机托管的设备。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-13T14:08:09.143

Mono.Nat 是一个非常好的 upnp 库，至少就我而言，到目前为止，与使用 NATUPnP 时相比，我遇到的问题更少。

[你可以在这里](http://projects.qnetp.net/projects/show/mono-nat)下载它，你可以在[http://www.fluxbytes.com/csharp/upnp-port-forwarding-the-easy-way/](http://www.fluxbytes.com/csharp/upnp-port-forwarding-the-easy-way/)找到一个关于如何操作它的不错的教程

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-12-13T00:23:45.090

此英特尔 UPnP 工具已作为开源工具重新发布，网址为：http: [//opentools.homeip.net](http://opentools.homeip.net)。新工具被称为“UPnP 技术的开发者工具”。它们是用 C# 构建的，但有一个免费的代码生成器可以输出 C 和 C# 堆栈。C 堆栈将在 Windows 和 Linux 上运行。

依莲

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-03-01T00:10:58.673

亲自四处寻找这些东西，发现::

mono-upnp:: [https://github.com/mono/mono-upnp](https://github.com/mono/mono-upnp)

Mono.Nat:: [https://github.com/mono/Mono.Nat](https://github.com/mono/Mono.Nat)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-06T22:57:24.497

我用这个，它似乎工作正常：

[http://code.google.com/p/dotnetportmapper/](http://code.google.com/p/dotnetportmapper/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-11T00:24:49.273

[英特尔的 UPNP 工具](http://www.intel.com/cd/ids/developer/asmo-na/eng/downloads/upnp/index.htm)曾经能够在 C# 中导出 UPnP 客户端。该套件已弃用，但应该仍然可以使用。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-01-02T11:00:24.577

如果有人需要一个简单的库，我编写了使用 UPnPLib COM 组件的 ac# 类库。它具有打开和关闭端口的一些基本功能。我还没有在多个平台上对其进行测试，但它可以在 Windows 7 中的 Visual Studio 2010 上运行。请随时在[http://sourceforge.net/projects/easyupnp/下载它](http://sourceforge.net/projects/easyupnp/)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-02-21T17:38:49.380

对于 NAT，有 Mono.Nat。

# asp.net - 防止页面显示在 iframe 之外

> ID：333086
> 
> 赞同：4
> 
> 时间：2008-12-02T04:55:34.683
> 
> 标签：asp.net, javascript

我有一个像导航一样工作的页面，并且在这个页面中有一个显示内容的 iframe。

现在有一些内页直接显示在浏览器中的情况。eg：如果有人在浏览器地址栏中输入内页的url，页面就会显示在窗口中。

我想防止这种情况。

更好的是，我想重定向到任何其他页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T07:43:30.100

**window.parent**：包含框架的窗口对象。如果窗口是顶级窗口，则 window.parent 指的是窗口本身。（它永远不会为空。）

**window.top**：顶层窗口对象，即使当前窗口是顶层窗口对象。

**window.self**：当前窗口对象。（它是窗口的同义词。）

所以，我会这样写我的支票：

```
if (window.top == window.self) {
  window.location = "index.html";
} 
```

这与稍微模棱两可的情况相同：

```
if (window.top == window) {
  window.location = "index.html";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T05:16:00.600

```
<script language="Javascript"><!-- 
if (top.location == self.location) { 
  top.location = "index.html" // must be viewed in main index
}
//--></script> 
```

在 iframe 决定成为主框架的情况下对其进行了修改。

# c# - 适用于 Windows 和 Windows Mobile 的通用 C# 源代码

> ID：333089
> 
> 赞同：6
> 
> 时间：2008-12-02T04:56:35.057
> 
> 标签：c#, .net, winapi, windows-mobile, compact-framework

我的目标是构建一个可以在 Windows Mobile 和“普通”桌面 Windows 上运行的 UI 应用程序。优先考虑的是它在 Windows Mobile 下“看起来不错”，而对于桌面 Windows，如果它变形也可以。在我投入几天时间尝试之前，我想知道这是否可能开始。这个问题有几个部分：

1.  .NET Compact Framework 是“普通”（请编辑）.NET Framework 的子集吗？如果没有，MSDN 是否有任何关于 .NET Compact Framework 中的类的信息，但在“正常”（再次请编辑）框架中没有？

2.  两个框架中共享类的行为是否相同？

3.  是否可以为两个平台提供一个 Visual Studio 2005 解决方案/项目？如果是，如何设置？

4.  还有其他意见和建议吗？有没有相关链接？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-02T14:51:46.743

1.  CF**包含**完整框架 (FFx) 的子集，但它不是纯子集。CF 中实际上有一些 FFx 中没有的东西，这使得它有点困难。除了最基本的情况外，CF 应用程序也使用 P/Invoke。从桌面到设备的这些调用永远不会相同，因此它们不是直接可移植的（尽管通过一点抽象，您可以拥有与平台无关的接口）。
2.  在大多数情况下，行为是相同的。我见过一些情况[并非如此](http://blog.opennetcf.com/ctacke/2008/10/02/BehavioralDifferencesBetweenTheCFAndFFx.aspx)，我记得一些事件顺序并不总是相同，所以请相信但要验证。
3.  通过非常仔细地按摩配置是可能的，但我当然不推荐它。它很难维护并且非常脆弱。而是有两个项目文件，一个用于 CF，一个用于 FFx。无论如何，您可能会有代码文件差异。将代码文件作为链接添加到每个项目，以便它们都使用相同的物理源文件。我建议使用某种形式的[CI](http://www.martinfowler.com/articles/continuousIntegration.html)来帮助确保它们始终构建。
4.  查看[Dan Moth](http://msdn.microsoft.com/en-us/magazine/cc163387.aspx)关于共享代码资产的 MSDN 文章和[博客条目。](http://www.danielmoth.com/Blog/2006/10/mobile-cross-platform-development.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-02T05:33:50.550

PS 我在网上找到了这张海报——它会告诉你所有的 CF 课程。我从 Microsoft 订购了它，因为 Kinkos 想要 65 美元为我打印彩色！微软免费给我寄了几份——我所要做的就是问：

[http://www.microsoft.com/downloads/details.aspx?familyid=7B645F3A-6D22-4548-A0D8-C2A27E1917F8&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=7B645F3A-6D22-4548-A0D8-C2A27E1917F8&displaylang=en)

我把它挂在我的隔间里，当我试图记住可以在哪些命名空间中找到类时，这是天赐之物。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-02T05:26:05.650

很好的多部分问题：

1.  [完整框架和紧凑框架之间的差异](http://msdn.microsoft.com/en-us/library/2weec7k5.aspx)
2.  上面的文章链接到有关类行为如何不同的相关文档（在某些情况下肯定会有所不同）
3.  非常简单！[在类库](http://www.vbdotnetheaven.com/UploadFile/mahesh/BuildingClassLibrary04262005091233AM/BuildingClassLibrary.aspx)中创建具有一组基本功能的单个解决方案，然后创建两个客户端项目（一个用于桌面应用程序，一个用于 Windows 移动应用程序）。最后，将类库的引用添加到两个客户端项目。
4.  根据您正在处理的项目的广度，您可能需要查看[模型视图控制器模式](http://en.wikipedia.org/wiki/Model-view-controller)。这对你的项目来说可能有点多，但如果你想在项目之间共享 UI 行为，它可以成为救命稻草。

希望有帮助！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-02T05:07:14.177

CF，通常包含来自常规框架的*类*的子集- 但您不能直接从一个上执行代码。此外，除了作为一个子集之外，compact 中可能还有一些常规版本中没有的东西，例如特定于移动设备的 GUI 东西（软键等）——假设你正在编写一个 winform exe，而不是网页（这可能是获得兼容性的最简单方法）。

通过一些努力，可以共享*逻辑*代码，特别是实用程序 dll - 但它们需要不同的 csproj 文件（因为它们具有完全不同的编译时“目标”）。为了减少维护，您通常可以通过破解 csproj 使用通配符来作弊，[例如](http://code.google.com/p/protobuf-net/source/browse/trunk/protobuf-net-CF35/protobuf-net-CF35.csproj)：

```
<ItemGroup>
  <Compile Include="..\protobuf-net\**\*.cs" />
</ItemGroup> 
```

对于 UI，事情变得更加棘手。一般来说，期望是为不同的目标设备共享业务逻辑和单独的 UI。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-02T05:07:26.577

1）。有一个紧凑的框架，所以是的；它是完整 .NET 框架的一个子集。我在办公室的墙上贴了一张海报，上面写着一大堆在 CF 中工作的课程......我不记得是否有任何纯粹的 CF，但我想有一定是一些。有几本关于这个主题的好书——我有 Paul Yao 的一本，Andy Wigley 的另一本——都可以在亚马逊上找到。

2）。据我所知，CF 类和完整框架类的工作方式相同，但需要针对不同的目标进行编译。

3）。我会冒险猜测，如果您只使用两者通用的类，您可以使用相同的解决方案，但我不知道您必须在多大程度上使其针对紧凑型设备和完整版本进行编译，我也不能完全肯定地说可以做到。我冒险猜测这个过程并不简单。

4）。去你当地的书店看看我提到的那两本书。就像我说的，我有 Paul Yao 的那个，它似乎涵盖了我能想象到的紧凑型设备所需的大部分内容。

# python - 整数（表示位序列）在 Python 中重新解释为字符数组

> ID：333097
> 
> 赞同：4
> 
> 时间：2008-12-02T05:03:37.973
> 
> 标签：python

我写了一些我想移植到 python 的 C 代码，因为我觉得 python 是一种更好的“概念”语言。

在我的 C 代码中，我使用内存重新解释来实现我的目标，例如：

```
sizeof(int)  is 4 byte
sizeof(char) is 1 byte

char c[4]={0x01,0x30,0x00,0x80};
int* i=(int*)c;

*i has the value 0x80003001 
```

同样，如果我有：

```
int* j = (int*)malloc(sizeof(int));
char* c = (char*)j;
*j = 0x78FF00AA;

c is now {0xAA, 0x00, 0xFF, 0x78} 
```

我想在 python 中做类似的事情，我意识到我可以使用位操作来完成这个：

```
chararray=[]
num=1234567890
size=8

while len(chararray) < size:
   char = chr( (num & 255 ) )
   num = num >> 8
   chararray.append(char) 
```

但是我希望有一种更快的方法来实现这一点。

python有什么类似于C的联合吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-02T05:16:21.693

您可以使用[结构模块](http://www.python.org/doc/2.5.2/lib/module-struct.html)：

```
import struct

# Pack a Python long as if it was a C unsigned integer, little endian
bytes = struct.pack("<I", 0x78FF00AA)
print [hex(ord(byte)) for byte in bytes]

['0xaa', '0x0', '0xff', '0x78'] 
```

阅读文档页面以了解数据类型，并注意字节顺序。

# php - 在没有 exec/passthru 的 PHP 目录中构建 Tar 文件

> ID：333130
> 
> 赞同：10
> 
> 时间：2008-12-02T05:29:33.460
> 
> 标签：php, linux, backup, archive

所以我有一个客户，他的当前主机不允许我通过 exec()/passthru()/ect 使用 tar，我需要定期以编程方式备份​​站点，所以有解决方案吗？

这是一个linux服务器。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2011-07-06T19:35:23.160

PHP 5.3 提供了一种更简单的方法来解决这个问题。

看这里：[http ://www.php.net/manual/en/phardata.buildfromdirectory.php](http://www.php.net/manual/en/phardata.buildfromdirectory.php)

```
<?php
$phar = new PharData('project.tar');
// add all files in the project
$phar->buildFromDirectory(dirname(__FILE__) . '/project');
?> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-02T05:37:18.640

在[http://pear.php.net/package/Archive_Tar](http://pear.php.net/package/Archive_Tar)你可以下载 PEAR tar 包并像这样使用它来创建存档：

```
<?php
require 'Archive/Tar.php';
$obj = new Archive_Tar('archive.tar');
$path = '/path/to/folder/';
$handle=opendir($path); 
$files = array();
while(false!==($file = readdir($handle)))
 {
    $files[] = $path . $file;
 }

if ($obj->create($files))
 {
    //Sucess
 }
else
 {
    //Fail
 }
?> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-02T05:34:39.457

有[Archive_Tar](http://pear.php.net/package/Archive_Tar)库。如果由于某种原因无法使用，则[zip](http://php.net/zip)扩展名可能是另一种选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T20:52:50.867

我需要一个可以在 Azure 网站 (IIS) 上运行的解决方案，并且无法使用其他答案中的方法在服务器上创建新文件。对我有用的解决方案是使用小型[TbsZip](http://freecode.com/projects/tbszip-a-zip-modifier-for-php)库进行压缩，它不需要在服务器的任何地方写入文件——它只是通过 HTTP 直接返回。

这个线程很旧，但这种方法可能更通用和更完整的答案，所以我发布代码作为替代：

```
// Compress all files in current directory and return via HTTP as a ZIP file
// by buli, 2013 (http://buli.waw.pl)
// requires TbsZip library from http://www.tinybutstrong.com

include_once('tbszip.php'); // load the TbsZip library
$zip = new clsTbsZip(); // instantiate the class
$zip->CreateNew(); // create a virtual new zip archive

// iterate through files, skipping directories
$objects = new RecursiveIteratorIterator(new RecursiveDirectoryIterator('.'));
foreach($objects as $name => $object)
{ 
    $n = str_replace("/", "\\", substr($name, 2)); // path format
    $zip->FileAdd($n, $n, TBSZIP_FILE); // add fileto zip archive
}

$archiveName = "backup_".date('m-d-Y H:i:s').".zip"; // name of the returned file 
$zip->Flush(TBSZIP_DOWNLOAD, $archiveName); // flush the result as an HTTP download 
```

这是[我博客上的整篇文章](http://buli.waw.pl/compress-files-ftp-php)。

# asp.net - ASP.NET 默认按钮

> ID：333141
> 
> 赞同：4
> 
> 时间：2008-12-02T05:39:10.210
> 
> 标签：asp.net, master-pages

我有一个带有搜索框和顶部按钮的母版页。此搜索功能正在接管我所有使用此母版页的 Web 表单的“输入”键。也就是说，如果我有一个使用此母版页的登录页面并且用户输入他们的用户名/密码并点击“输入”，而不是登录用户，系统会执行搜索。

设置默认提交按钮的最佳方法是什么。我可以将所有内容包装在 asp Panels 中并设置 DefaultButton 属性，但这似乎有点乏味。有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T05:59:59.623

使用表单或面板的默认按钮属性

```
<form defaultbutton=“button1” runat=“server”&gt;    
    <asp:button id=“button1” text=“Same Page” runat=“server”/>    
    <asp:panel defaultbutton=“button2” runat=“server”&gt;    
       <asp:textbox id=“foo” runat=“server”/>    
       <asp:button id=“button2” runat=“server”/>    
    </asp:panel>    
</form> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T06:56:37.373

正如您所发现的，当页面上有多个按钮时，默认按钮可能会导致问题。我会接受 Geeks 的建议，但通过删除 setfocus 客户端脚本来简化它，并通过将 keydown 事件添加到搜索文本框和登录文本框来扩展它，以便输入键触发正确的按钮，具体取决于您的用户是否使用搜索框或登录框，或您想要添加 javascript 的任何其他文本框。

如果有一个合理的控件可供用户开始，您可以将焦点设置在加载页面上（如果您愿意，可以在代码后面）为用户节省一些鼠标工作或选项卡，但否则用户与之交互的控件应该确定页面的流程和回车键的作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T05:54:51.600

将焦点放在文本框上，

Page.RegisterStartupScript("SetFocus", "<script>document.getElementById('" + TextBox1.ClientID + "').focus();</script>");

接着

在最后一个文本框的 keydown 事件中，您可以执行以下操作：

If e.KeyCode = Keys.Enter Then Me.Button1.Select() End If

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-08T16:27:19.630

这就是我们在我们的项目上尝试过的，似乎很有效。我将 Search asp:Button 更改为 asp:LinkBut​​ton。然后我添加了一些 CSS 样式给它一个背景图像，使它看起来像一个按钮。页面显然没有使用 LinkBut​​tons 来确定按下 Enter 时哪个 Button 是默认操作。甜蜜的部分是 LinkBut​​ton 仍然可以具有与之关联的单击操作，因此我不必更改任何代码隐藏内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T10:06:32.903

您可以将搜索框和提交按钮放入母版页上的 IFRAME，而不是使用 javascript 来操作页面。如果焦点在 iframe 点击将提交搜索表单，如果用户在页面内的主表单上，他们将提交普通页面。

`<iframe>`src 属性指向一个小的自包含 aspx 页面，其中包含您的文本框和提交按钮，该按钮重定向到您的搜索结果表单。

# database - 哪种数据挖掘算法最好？

> ID：333142
> 
> 赞同：2
> 
> 时间：2008-12-02T05:39:20.930
> 
> 标签：database, algorithm

长期聆听者，第一次来电者。

我白天是全职 SE，晚上是全职数据挖掘学生。我参加了课程，并听取了我们教授的想法。现在，我来找你 - **stackoverflowers**，带出真正的真相。

你最喜欢的数据挖掘算法是什么，为什么？过去，您使用过哪些特殊技术帮助您取得成功？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-02T06:50:30.007

我的大部分专业经验都涉及最后一刻的功能添加，例如“嘿，我们应该在这个电子商务网站上添加一个推荐系统。” 解决方案通常是快速而肮脏的最近邻搜索 - 蛮力，欧几里得距离，如果网站变得流行，注定会失败。但是，嘿，过早的优化等等……

我确实喜欢数据挖掘可以优雅而美妙的想法。我关注了[Netflix Prize](http://netflixprize.com/)并使用了它的数据集。特别是，我喜欢想象力和实验在开发前十名条目中发挥了如此重要作用的事实：

*   [Acmehill 博客](http://acmehill.blogspot.com/)
*   [Acmehill 纽约时报文章](http://www.nytimes.com/2008/11/23/magazine/23Netflix-t.html)
*   [只是车库博客里的一个人](http://justaguyinagarage.blogspot.com/)
*   [只是车库里的一个人 有线文章](http://www.wired.com/techbiz/media/magazine/16-03/mf_netflix)

所以大多数情况下，就像很多软件开发人员一样，我认为最好的算法是开放的思想和一些创造力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-09T20:45:10.370

有很多针对不同任务的数据挖掘算法，所以我发现选择起来有点困难。

可以说我最喜欢的数据挖掘算法是 Apriori，因为它启发了数百种其他算法，并且有多种应用。Apriori 算法本身非常简单。但它为使用所谓的“Apriori 属性”的许多其他算法（FPGrowth、PrefixSpan 等）奠定了基础。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-02T06:13:58.520

如果您可以更具体地了解数据挖掘算法将执行的任务，请确保我们可以帮助您（分类、聚类、关联规则检测等）

# svn - 使用 LDAP 的 svnserve

> ID：333146
> 
> 赞同：20
> 
> 时间：2008-12-02T05:40:46.293
> 
> 标签：svn, ldap, svnserve

我想知道如何使用 LDAP 身份验证设置 SVN 存储库。不过我不想使用 Apache DAV。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-02T07:23:15.557

有两种选择：

1.  将 svnserve 作为服务器运行，并使用[SASL](https://svn.apache.org/repos/asf/subversion/trunk/notes/sasl.txt)进行身份验证。配置[SASL 以针对 LDAP 进行身份验证](https://web.archive.org/web/20140528175339/http://www.imc.org:80/ietf-sasl/mail-archive/msg01862.html)。
2.  通过 ssh 访问存储库。为所有用户创建 ssh 帐户（可能是自动），并让这些帐户使用 PAM 针对 LDAP 进行身份验证。将所有用户放入一个组，并使存储库文件归该组所有。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-05-05T14:17:13.333

由于我花了一些时间来找到执行此操作的部分，因此我想发布我是如何在 RHEL5 服务器上执行此操作的：

1.  安装 CollabNet rpms（[客户端](http://www.open.collab.net/downloads/subversion/linux.html)、[服务器和附加组件](http://www.open.collab.net/downloads/subversion/linux-other.html)）。

2.  `/opt/CollabNet_Subversion/bin/Configure-CollabNet-Subversion`在没有 Apace 和 svnserve 的情况下运行配置。

3.  修改您的`repo/conf/svnserve.conf`文件以具有：

    ```
    [sasl]
    use-sasl=true 
    ```

4.  `/opt/CollabNet_Subversion/etc/saslauthd.conf`使用以下内容创建文件：

    ```
    ldap_servers: ldaps://...
    ldap_search_base: ...
    ldap_bind_dn: ...
    ldap_bind_pw: ...
    ldap_auth_method: bind
    ldap_timeout: 10 
    ```

5.  使用这些内容创建`/etc/opt/CollabNet_Subversion/sasl2/svn.conf`文件以用于 MS AD LDAP：

    ```
    pwcheck_method: saslauthd
    auxprop_plugin: ldap
    mech_list: PLAIN LOGIN
    ldapdb_mech: PLAIN LOGIN 
    ```

6.  复制`/etc/openldap/ldap.conf`到`/etc/opt/CollabNet_Subversion/conf/openldap`并添加`TLS_REQCERT allow`. 这是我们的自签名 LDAP 服务器所必需的

7.  运行 collabnet saslauthd

    *   `mkdir -p /var/state/saslauthd`
    *   编辑`/etc/init.d/collabnet_subversion`以包括接近功能`/opt/CollabNet_Subversion/sbin/saslauthd -a ldap`结束`start()`
    *   `stop/start /etc/init.d/collabnet_subverison`

注意：您可以`/opt/CollabNet_Subversion/sbin/testsaslauthd -u <userid> -p <password>`用来测试 sasl 与 ldap 的连接

有点涉及，但对我来说，它允许我们的客户`svn://`使用他们的 ldap 密码进行连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-10T05:55:51.433

您可以使用具有 ldap 插件的[scm-manager 。](https://bitbucket.org/sdorra/scm-manager)

# java - Java：如何通过引用传递字节 []？

> ID：333151
> 
> 赞同：21
> 
> 时间：2008-12-02T05:42:53.450
> 
> 标签：java, pass-by-reference

您可以使用关键字“ref”在 .NET 中执行此操作。Java有什么办法吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-12-02T06:34:38.617

你在你的方法中做什么？如果您只是填充现有数组，那么您不需要传递引用语义 - 无论是在 .NET 中还是在 Java 中。在这两种情况下，引用都将通过值传递 - 因此调用者可以看到对*对象的更改。*这就像告诉某人你家的地址，并要求他们送东西给它——没问题。

如果您*真的*想要传递引用语义，即调用者将看到对参数本身所做的任何更改，例如将其设置为 null 或对不同字节数组的引用，那么任一方法都需要返回新值，或者您需要传递对某种“持有人”的引用，该持有人包含对字节数组的引用，并且稍后可以从中获取（可能已更改的）引用。

换句话说，如果你的方法看起来像这样：

```
public void doSomething(byte[] data)
{
    for (int i=0; i < data.length; i++)
    {
        data[i] = (byte) i;
    }
} 
```

那你就没事了。如果您的方法如下所示：

```
public void createArray(byte[] data, int length)
{
    // Eek! Change to parameter won't get seen by caller
    data = new byte[length]; 
    for (int i=0; i < data.length; i++)
    {
        data[i] = (byte) i;
    }
} 
```

那么您需要将其更改为：

```
public byte[] createArray(int length)
{
    byte[] data = new byte[length]; 
    for (int i=0; i < data.length; i++)
    {
        data[i] = (byte) i;
    }
    return data;
} 
```

或者：

```
public class Holder<T>
{
    public T value; // Use a property in real code!
}

public void createArray(Holder<byte[]> holder, int length)
{
    holder.value = new byte[length]; 
    for (int i=0; i < length; i++)
    {
        holder.value[i] = (byte) i;
    }
} 
```

有关详细信息，请阅读[C# 中](http://pobox.com/~skeet/csharp/parameters.html)的[参数传递和 Java](http://pobox.com/~skeet/java/parameters.html)中的参数传递。（恐怕前者比后者写得好。总有一天我会抽空做一个更新。）

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-02T06:00:30.370

实际上，在 Java 中，**引用是按值传递的**。

在这种情况下，引用是一个`byte[]`对象。任何影响对象本身的更改都将从调用者方法中看到。

但是，如果您尝试替换引用，例如使用 `new byte[length]`，您只是替换了通过值传递获得的引用，因此您不会更改调用方方法中的引用。

这里有一篇关于这个问题的有趣读物：[Java is Pass-by-Value Dammit！](http://javadude.com/articles/passbyvalue.htm)

* * *

这是一个具体的例子：

```
public class PassByValue
{
    public static void modifyArray(byte[] array)
    {
        System.out.println("Method Entry:  Length: " + array.length);
        array = new byte[16];
        System.out.println("Method Exit:   Length: " + array.length);
    }

    public static void main(String[] args)
    {
        byte[] array = new byte[8];
        System.out.println("Before Method: Length: " + array.length);
        modifyArray(array);
        System.out.println("After Method:  Length: " + array.length);
    }
} 
```

该程序将在方法中创建一个`byte`长度数组，`8`该`main`方法将调用该`modifyArray`方法，在该方法中创建一个新`byte`的长度数组`16`。

看起来通过在方法中创建一个新`byte`数组，返回该方法时数组`modifyArray`的长度将是，但是，运行这个程序会发现一些不同的东西：`byte``main``16`

```
Before Method: Length: 8
Method Entry:  Length: 8
Method Exit:   Length: 16
After Method:  Length: 8 
```

从该方法返回`byte`时数组的长度恢复为，而不是。`modifyArray``8``16`

这是为什么？

那是因为该`main`方法调用了该方法并使用**pass-by-value**`modifyArray`发送**了一个复制的引用`new byte[8]`**。然后，该方法**通过创建一个**. 当我们离开时，对 的引用超出了范围（最终将被垃圾回收。）但是，该方法仍然具有对的引用，因为它只**发送了复制的引用**，而不是对引用的实际引用。**`modifyArray`**`new byte[16]`**`modifyArray``new byte[16]``main``new byte[8]`**

 ****这应该证明 Java 将使用按值传递来传递引用。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-02T05:57:06.073

**Java 对方法参数使用按值传递**。

*   [基元](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/datatypes.html)（int、boolean 等）是 Java 中的特例……不是对象本身。在这种情况下，原始（参数）的副本被传递到函数中。这与价值传递理论非常吻合。
*   对于对象，发生的情况是对象的引用是按值传递的（生成引用的副本而不是对象）......但是两个引用都指向同一个对象。因此，如果您在方法中修改对象参数，则实际对象将被修改。

这篇文章应该可以帮助你.. [http://www.javaworld.com/javaworld/javaqa/2000-05/03-qa-0526-pass.html](http://www.javaworld.com/javaworld/javaqa/2000-05/03-qa-0526-pass.html)

*至于OP的问题，只需将对 byte[] 数组的引用传递给方法。最终结果将类似于通过引用传递。如果您修改字节数组，调用者将能够看到方法执行后的更改。*

**更新以平息阻力:)** => 表示输出

## .NET 土地

```
class Counter
{
  private int m_count = 0;
  public override string  ToString()
  {
     return String.Format("Counter ID{0} : Value {1}", this.GetHashCode(), m_count);
  }
  public void Increment()
  {  m_count++;  }
}
class MakeAPass
{
   public void PassByValueAndModify(int i)
   {   i = 20;    }

   public void PassByRefAndModify(ref int i)
   {   i = 20;   }

   public void PassByValueAndModify(Counter c)
   {   c.Increment();   }

   public void PassByRefAndModify(ref Counter c)
   {   c.Increment();   }

   public void PassByRefAndReassign(ref Counter c)
   {
      c = new Counter();
      for (int i=0; i<5; ++i)
         c.Increment();
   }
}

static void Main(string[] args)
{
   MakeAPass obj = new MakeAPass();
   int intVal = 10;
   obj.PassByValueAndModify(intVal);
   Console.WriteLine(intVal);              // => 10
   obj.PassByRefAndModify(ref intVal);
   Console.WriteLine(intVal);              // => 20

   Counter obCounter = new Counter();
   obj.PassByValueAndModify(obCounter);
   Console.WriteLine(obCounter.ToString());  // => Counter ID58225482 : Value 1
   obj.PassByRefAndModify(ref obCounter);
   Console.WriteLine(obCounter.ToString());  // => Counter ID58225482 : Value 2
   obj.PassByRefAndReassign(ref obCounter);
   Console.WriteLine(obCounter.ToString());  // => Counter ID54267293 : Value 5
} 
```

## 爪哇地

Minor mods reqd：使用 hashCode() 和 + 在 Counter.java 中连接字符串...

```
class MakeAPass
{
   public void PassByValueAndModify(int i)
   {   i = 20;   }

   // can't be done.. Use Integer class which wraps primitive
   //public void PassByRefAndModify(ref int i)

   public void PassByValueAndModify(Counter c)
   {   c.Increment();   }

   // same as above. no ref keyword though
   //public void PassByRefAndModify(ref Counter c)

   // this can't be done as in .net
   //public void PassByRefAndReassign(ref Counter c)
   public void PassAndReassign(Counter c)
   {
      c = new Counter();
      for (int i=0; i<5; ++i)
         c.Increment();
   }
}
public static void main(String args[])
{
   MakeAPass obj = new MakeAPass();
   int intVal = 10;
   obj.PassByValueAndModify(intVal);
   System.out.println(intVal);                 // => 10 
   //obj.PassByRefAndModify(ref intVal);
   //System.out.println(intVal);               // can't get it to say 20

   Counter obCounter = new Counter();
   obj.PassByValueAndModify(obCounter);
   System.out.println(obCounter.ToString());    // => Counter ID3541984 : Value 1
   //obj.PassByRefAndModify(ref obCounter);
   //Console.WriteLine(obCounter.ToString());   // no ref. but can make it 2 by repeating prev call
   obj.PassAndReassign(obCounter);
   System.out.println(obCounter.ToString());    // => Counter ID3541984 : Value 1
                                                // can't get it to say 5  
} 
```

# visual-studio-2005 - 如何设置 MSBuild VC++ 目录

> ID：333159
> 
> 赞同：12
> 
> 时间：2008-12-02T05:49:46.867
> 
> 标签：visual-studio-2005, msbuild

我有一个混合 VB.NET 和 C++ 项目的解决方案。使用 Visual Studio 2005 时，您可以设置“工具->选项->项目和解决方案->VC++ 目录”以帮助编译器找到您的包含文件。使用 MSBuild 构建相同的解决方案时，我看不到如何传递这些设置。如果没有指定此路径，C++ 将无法编译。从 Visual Studio 构建此解决方案时，它构建完美。

为 MSBUild 传递这条路径的方法是什么？

编辑：看起来 MSBuild 没有将路径（或 /u 开关）传递给 vcbuild。从 VCBuild 开始会因依赖而失败。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-02T06:15:43.757

要设置包含目录，您可以将它们添加到您的 INCLUDE 环境变量中。您使用与 PATH 环境中相同的格式。变量 - 你用分号分隔路径。

要设置库目录 - 您可以以类似的方式进行，将它们放入您的 LIB 环境变量中。

要设置环境变量，您只需右键单击“我的电脑”，选择“属性”。然后你转到“高级”选项卡，有一个名为“环境变量”的按钮。

或者，您可以从 BATCH 脚本运行 MSBuild，在这种情况下，在调用 MSBuild 之前，您可以设置 INCLUDE 和 LIB 变量，如下所示：

```
set INCLUDE=C:\Libraries\LibA\Include
set LIB=C:\Libraries\LibA\Lib\x86 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-11-16T10:51:32.687

...而且您也可能希望将 %INCLUDE% 和 %LIB% 附加到您的变量中以避免覆盖它们

```
set INCLUDE=C:\Libraries\LibA\Include;%INCLUDE%
set LIB=C:\Libraries\LibA\Lib\x86;%LIB% 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-28T10:29:02.320

您可以使用`/p[roperty]:useenv=true`switch 在较新版本的 MSBuild 中转发环境变量。在此处查看全文[http://blogs.msdn.com/b/vcblog/archive/2010/01/11/vcbuild-vs-c-msbuild-on-the-command-line.aspx](http://blogs.msdn.com/b/vcblog/archive/2010/01/11/vcbuild-vs-c-msbuild-on-the-command-line.aspx)

# asp.net - 如何将 GridView 绑定到多种类型的列表？

> ID：333163
> 
> 赞同：2
> 
> 时间：2008-12-02T05:53:51.243
> 
> 标签：asp.net, gridview, domain-driven-design

我收到此错误：

System.Reflection.TargetException：对象与目标类型不匹配。

当尝试绑定`List<IEvent>`IEvent 可以是约会、生日或其他一些与日历相关的事件类型时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T08:15:24.827

ChanChan，GridView 不**支持**绑定到接口集合，尝试重新设计您的应用程序以确保仅绑定到 concreate 类的集合。唯一的解决方法是使用基类（在您的情况下为 Event）并绑定到事件集合。

```
 public  class Event
        {
            public  DateTime StartDate { get; set; }
        }
        public class Birthday : Event
        {       

            public DateTime? EndDate { get; set; }
        } 
        public class Appointment : Event
        {       

            public string Place { get; set; }
        }
        public class EventCollection : Collection<Event>
        {
            public static EventCollection GetEvents()
            {
                var events = new EventCollection();
                events.Add(new Birthday
                {
                     EndDate = DateTime.Now.AddDays(1),
                     StartDate = DateTime.Now
                });
                events.Add(new Appointment
                {
                    Place = "Gallery",
                    StartDate = DateTime.Now
                });
                return events;
             }
         } 
```

请注意，从基类继承会创建“is a”关系，但从接口继承会创建“can do”关系。换句话说，IMO 实施 IEvent 将是一个糟糕的设计，因为生日是一个事件。我会从这里的基类继承。

希望这会有所帮助，Valve。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-13T15:36:44.567

这样做有点痛苦，但是可以将多个类型的列表绑定到 GridView - 您只需`TypeDescriptionProvider`为您的基本类型实现 a 。

本文中的更多详细信息：[多态数据绑定解决方案](http://ayende.com/Blog/archive/2006/07/25/PolymorphicDatabindingSolutions.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-08T14:56:24.297

这是无法做到的，如果您需要此功能，请不要使用 gridview，这是我可以绕过它的唯一方法。

# c++ - 从 MySQL 中选择 LONGTEXT 列时，CRecordset 中出现“内存不足”异常

> ID：333169
> 
> 赞同：0
> 
> 时间：2008-12-02T05:58:21.623
> 
> 标签：c++, mysql, database, mfc, recordset

我正在使用 CODBCRecordset（CodeProject 上的一个类）在具有 39 列的表中查找单个记录。如果没有找到记录，那么调用 CRecordset::Open 就可以了。如果记录与条件匹配，则在调用 CRecordset::Open 时会出现内存不足异常。我正在选择查询中的所有列（如果我将查询更改为仅选择具有相同 where 子句的列之一，那么也不例外）。

我认为这是因为 CRecordset 中的一些限制，但我找不到任何告诉我任何限制的信息。该表只有 39 列。

有没有人遇到过这个问题？如果是这样，您是否有解决方法/解决方案？

这是一个使用 Visual Studio 6.0 的 MFC 项目，如果它有什么不同的话。

这是查询（此处格式化，因此将在没有滚动条的情况下显示）：

```
    选择`id`，`member_id`，`member_id_last_four`，`card_number`，`first_name`，
           `mi`、`last_name`、`participant_title_id`、`category_id`、`gender`、
           `date_of_birth`，`address_line_1`，`address_line_2`，`city`，`state`，
           `zip`，`phone`，`work_phone`，`mobile_phone`，`fax`，`email`，
           `emergency_name`，`emergency_phone`，`job_title`，`mail_code`，
           `comments`, `contract_unit`, `contract_length`, `start_date`,
           `end_date`、`head_of_household`、`parent_id`、` added_by`、`im_active`、
           `ct_active`、`organization`、`allow_members`、`organization_category_id`、  
           `修改日期`
   来自“参与者”
   WHERE `member_id` = '27F7D0982978B470C5CF94B1B833CC93F997EE23'

```

复制并粘贴到我的查询浏览器中只会给我一个结果。

更多信息：

注释掉 select 语句中除 id 之外的每一列。运行查询，没有例外。

然后我系统地检查并取消注释每一列，一次一个，并在每次取消注释之间重新运行查询。

当我取消注释评论列时，我得到了错误。

这被定义如下（使用 MySQL）： LONGTEXT

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T06:20:30.317

我们可以假设您的意思是您正在调用 C **ODBC** Recordset::Open()，是吗？或者更准确地说，类似：

```
CDatabase db;
db.Open (NULL,FALSE,FALSE,"ODBC;",TRUE);
CODBCRecordSet rs (&db);
rs.Open ("select blah, blah, blah from ..."); 
```

**回复后编辑：**

各种 ODBC 驱动程序存在一些已知错误，这些错误似乎是由检索无效字段长度引起的。请参阅以下链接：

*   [http://forums.microsoft.com/msdn/showpost.aspx?postid=2700779&siteid=1](http://forums.microsoft.com/msdn/showpost.aspx?postid=2700779&siteid=1)
*   [https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=296391](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=296391)

这个特殊的似乎是因为 CRecordset 将分配一个足够大的缓冲区来保存该字段。由于该列返回的长度为零，它被解释为最大 32 位大小 (~2G) 而不是最大 8 位大小（255 字节）。不用说，它不能为字段分配足够的内存。

Microsoft 已承认这是一个问题，请查看以下解决方案：

*   [http://support.microsoft.com/kb/q272951/](http://support.microsoft.com/kb/q272951/)
*   [http://support.microsoft.com/kb/940895/](http://support.microsoft.com/kb/940895/)

**问题附录后编辑：**

因此，鉴于您的 MySQL 字段是 LONGTEXT，CRecordSet 似乎正在尝试为其分配最大可能大小（2G）。你真的需要 2 场演出来评论区吗？以 80 wpm 和 6cpw 的速度打字需要一个打字员 7 年多一点的时间来填补这个领域，每天 24 小时工作，没有休息:-)。

查看数据库中的所有列以查看它们是否具有适当的数据类型可能是一个有用的练习。我并不是说你**不能**有一个 2G 列，只是你应该确定它是必要的，特别是考虑到当前的 ODBC 类不适用于这么大的字段这一事实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T07:03:34.237

阅读 Pax 的回复。它使您对问题发生的原因有了很好的理解。

解决方法：

仅当定义为（TEXT、LONGTEXT 等）的字段为 NULL（并且可能为空）时，才会发生此错误。如果字段中有数据，那么它将仅分配字段中数据的大小而不是最大大小（从而导致错误）。

因此，如果在某些情况下您绝对必须拥有这些大字段。这是一个潜在的解决方案：

1.  在数据库中为该字段指定一个默认值。（即。`'<blank>'`）
2.  然后在显示值的时候；如果找到默认值，则传递 NULL/empty。
3.  然后在更新值时；如果发现 NULL/空，则传递默认值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-03T03:33:59.433

我同意 Pax 的建议，即此错误是由于尝试分配足够大的缓冲区以容纳可能的最大 LONGTEXT。客户端在获取数据之前不知道数据有多大。

LONGTEXT 确实比您在大多数应用程序中所需要的要大得多。考虑使用 MEDIUMTEXT（最大大小 16MB）或仅使用 TEXT（最大大小 64KB）。

PHP数据库接口也有类似的问题。PHP 通常有内存大小限制，任何 LONGBLOB 或 LONGTEXT 的获取都可能超过该限制。

# c# - 将非模态表单重新映射到现有应用程序

> ID：333171
> 
> 赞同：4
> 
> 时间：2008-12-02T05:59:56.923
> 
> 标签：c#, modal-dialog

我希望能够在已经存在的应用程序中显示非模态表单。目前我可以做类似的事情：

```
myform.ShowDialog(handleToApp); 
```

但这将创建一个以应用程序为父的模态表单以及我真正在寻找的不是模态的东西，因此当表单失去焦点时，它不会破坏控制流程并纠缠用户不被关闭。

有谁知道我如何或是否可以做我正在寻找的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T06:05:19.643

我找到了我要找的东西，你必须创建一个如下所示的类：

```
public class MapinfoWindowHandle : System.Windows.Forms.IWin32Window
    {
        private IntPtr handle;
        public MapinfoWindowHandle(IntPtr hWnd)
        {
            handle = hWnd;
        }

        #region IWin32Window Members

        IntPtr System.Windows.Forms.IWin32Window.Handle
        {
            get { return handle; }
        }

        #endregion
    } 
```

然后你可以这样做：

```
IntPtr windowhandle = new IntPtr(hWnd);
MyForm.Show(new MapinfoWindowHandle(windowhandle)); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-02T06:27:59.817

简单的怎么样`myForm.Show()`？

# c# - 有没有办法在 c# 中使字符串文件路径安全？

> ID：333175
> 
> 赞同：101
> 
> 时间：2008-12-02T06:00:49.717
> 
> 标签：c#, .net, string, filepath

我的程序将从互联网上获取任意字符串并将它们用作文件名。有没有一种简单的方法可以从这些字符串中删除坏字符，还是我需要为此编写一个自定义函数？

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2008-12-02T07:35:06.203

呃，当人们试图猜测哪些字符是有效的时，我讨厌它。除了完全不可移植（一直在考虑 Mono）之外，之前的两条评论都遗漏了更多 25 个无效字符。

```
foreach (var c in Path.GetInvalidFileNameChars()) 
{ 
  fileName = fileName.Replace(c, '-'); 
} 
```

或者在 VB 中：

```
'Clean just a filename
Dim filename As String = "salmnas dlajhdla kjha;dmas'lkasn"
For Each c In IO.Path.GetInvalidFileNameChars
    filename = filename.Replace(c, "")
Next

'See also IO.Path.GetInvalidPathChars 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2010-09-09T15:58:10.483

要去除无效字符：

```
static readonly char[] invalidFileNameChars = Path.GetInvalidFileNameChars();

// Builds a string out of valid chars
var validFilename = new string(filename.Where(ch => !invalidFileNameChars.Contains(ch)).ToArray()); 
```

要替换无效字符：

```
static readonly char[] invalidFileNameChars = Path.GetInvalidFileNameChars();

// Builds a string out of valid chars and an _ for invalid ones
var validFilename = new string(filename.Select(ch => invalidFileNameChars.Contains(ch) ? '_' : ch).ToArray()); 
```

要替换无效字符（并避免像 Hell* 与 Hell$ 这样的潜在名称冲突）：

```
static readonly IList<char> invalidFileNameChars = Path.GetInvalidFileNameChars();

// Builds a string out of valid chars and replaces invalid chars with a unique letter (Moves the Char into the letter range of unicode, starting at "A")
var validFilename = new string(filename.Select(ch => invalidFileNameChars.Contains(ch) ? Convert.ToChar(invalidFileNameChars.IndexOf(ch) + 65) : ch).ToArray()); 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2010-09-09T16:24:47.190

这个问题之前已经被问过[很多](https://stackoverflow.com/questions/1862993) [次了，正如](https://stackoverflow.com/questions/1976007) [之前](https://stackoverflow.com/questions/62771)多次指出的那样，这个问题`IO.Path.GetInvalidFileNameChars`是不充分的。

首先，有许多名称（例如 PRN 和 CON）是保留的并且不允许用于文件名。还有其他名称不允许仅在根文件夹中。也不允许使用以句点结尾的名称。

其次，有多种长度限制。[在此处](http://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx)阅读 NTFS 的完整列表。

第三，您可以附加到具有其他限制的文件系统。例如，ISO 9660 文件名不能以“-”开头，但可以包含它。

四、如果两个进程“任意”取同名怎么办？

一般来说，使用外部生成的文件名是一个坏主意。我建议生成您自己的私有文件名并在内部存储人类可读的名称。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-12-02T08:03:36.737

我同意 Grauenwolf 并强烈推荐`Path.GetInvalidFileNameChars()`

这是我的 C# 贡献：

```
string file = @"38?/.\}[+=n a882 a.a*/|n^%$ ad#(-))";
Array.ForEach(Path.GetInvalidFileNameChars(), 
      c => file = file.Replace(c.ToString(), String.Empty)); 
```

ps——这比它应该的更神秘——我试图简洁。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-09-20T12:59:40.057

这是我的版本：

```
static string GetSafeFileName(string name, char replace = '_') {
  char[] invalids = Path.GetInvalidFileNameChars();
  return new string(name.Select(c => invalids.Contains(c) ? replace : c).ToArray());
} 
```

我不确定 GetInvalidFileNameChars 的结果是如何计算的，但“Get”表明它并不简单，所以我缓存了结果。此外，这只遍历输入字符串一次而不是多次，就像上面的解决方案迭代一组无效字符，一次一个地替换源字符串中的它们。此外，我喜欢基于 Where 的解决方案，但我更喜欢替换无效字符而不是删除它们。最后，我的替换正好是一个字符，以避免在迭代字符串时将字符转换为字符串。

我说了所有没有做剖析的事情——这个对我来说只是“感觉”很好。:)

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2010-08-06T17:47:03.537

这是我现在使用的函数（感谢 jcollum 的 C# 示例）：

```
public static string MakeSafeFilename(string filename, char replaceChar)
{
    foreach (char c in System.IO.Path.GetInvalidFileNameChars())
    {
        filename = filename.Replace(c, replaceChar);
    }
    return filename;
} 
```

为了方便起见，我只是把它放在“帮助者”类中。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-05-28T02:42:19.583

如果您想快速去除所有特殊字符，这些特殊字符有时对于文件名来说更易于用户阅读，这很好用：

```
string myCrazyName = "q`w^e!r@t#y$u%i^o&p*a(s)d_f-g+h=j{k}l|z:x\"c<v>b?n[m]q\\w;e'r,t.y/u";
string safeName = Regex.Replace(
    myCrazyName,
    "\W",  /*Matches any nonword character. Equivalent to '[^A-Za-z0-9_]'*/
    "",
    RegexOptions.IgnoreCase);
// safeName == "qwertyuiopasd_fghjklzxcvbnmqwertyu" 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-04-18T12:30:27.767

```
static class Utils
{
    public static string MakeFileSystemSafe(this string s)
    {
        return new string(s.Where(IsFileSystemSafe).ToArray());
    }

    public static bool IsFileSystemSafe(char c)
    {
        return !Path.GetInvalidFileNameChars().Contains(c);
    }
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-07-12T19:55:30.680

这是我刚刚添加到 ClipFlair ( [http://github.com/Zoomicon/ClipFlair](http://github.com/Zoomicon/ClipFlair) ) StringExtensions 静态类 (Utils.Silverlight 项目) 中的内容，基于从上面 Dour High Arch 发布的相关 stackoverflow 问题的链接中收集的信息：

```
public static string ReplaceInvalidFileNameChars(this string s, string replacement = "")
{
  return Regex.Replace(s,
    "[" + Regex.Escape(new String(System.IO.Path.GetInvalidPathChars())) + "]",
    replacement, //can even use a replacement string of any length
    RegexOptions.IgnoreCase);
    //not using System.IO.Path.InvalidPathChars (deprecated insecure API)
} 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2017-04-28T02:47:31.203

为什么不将字符串转换为 Base64 等效项，如下所示：

```
string UnsafeFileName = "salmnas dlajhdla kjha;dmas'lkasn";
string SafeFileName = Convert.ToBase64String(Encoding.UTF8.GetBytes(UnsafeFileName)); 
```

如果您想将其转换回来以便阅读：

```
UnsafeFileName = Encoding.UTF8.GetString(Convert.FromBase64String(SafeFileName)); 
```

我用它来保存随机描述中具有唯一名称的 PNG 文件。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-02-19T18:22:19.107

```
private void textBoxFileName_KeyPress(object sender, KeyPressEventArgs e)
{
   e.Handled = CheckFileNameSafeCharacters(e);
}

/// <summary>
/// This is a good function for making sure that a user who is naming a file uses proper characters
/// </summary>
/// <param name="e"></param>
/// <returns></returns>
internal static bool CheckFileNameSafeCharacters(System.Windows.Forms.KeyPressEventArgs e)
{
    if (e.KeyChar.Equals(24) || 
        e.KeyChar.Equals(3) || 
        e.KeyChar.Equals(22) || 
        e.KeyChar.Equals(26) || 
        e.KeyChar.Equals(25))//Control-X, C, V, Z and Y
            return false;
    if (e.KeyChar.Equals('\b'))//backspace
        return false;

    char[] charArray = Path.GetInvalidFileNameChars();
    if (charArray.Contains(e.KeyChar))
       return true;//Stop the character from being entered into the control since it is non-numerical
    else
        return false;            
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-09-11T17:07:57.117

从我的旧项目中，我找到了这个解决方案，它已经完美运行了 2 年。我用“！”替换非法字符，然后检查双 !!，使用你自己的字符。

```
 public string GetSafeFilename(string filename)
    {
        string res = string.Join("!", filename.Split(Path.GetInvalidFileNameChars()));

        while (res.IndexOf("!!") >= 0)
            res = res.Replace("!!", "!");

        return res;
    } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-04-09T18:28:04.637

我发现使用它既快速又容易理解：

```
<Extension()>
Public Function MakeSafeFileName(FileName As String) As String
    Return FileName.Where(Function(x) Not IO.Path.GetInvalidFileNameChars.Contains(x)).ToArray
End Function 
```

这是有效的，因为 a`string`是`IEnumerable`一个`char`数组，并且有一个带有数组的`string`构造函数字符串`char`。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-01-11T14:59:18.657

许多人建议使用`Path.GetInvalidFileNameChars()`这对我来说似乎是一个糟糕的解决方案。我鼓励您使用白名单而不是黑名单，因为黑客总能找到最终绕过它的方法。

这是您可以使用的代码示例：

```
 string whitelist = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.";
    foreach (char c in filename)
    {
        if (!whitelist.Contains(c))
        {
            filename = filename.Replace(c, '-');
        }
    } 
```

# asp.net - 填充 Datagrid 和 Sql 查询

> ID：333181
> 
> 赞同：0
> 
> 时间：2008-12-02T06:04:21.893
> 
> 标签：asp.net, datagrid, oracle10g, pivot, reporting

我在数据库中有 3 个表，如下所示。我想制作一份报告，就像下面显示的链接一样。如何使用 datagrid 或 datalist 做到这一点？哪个是最好的chois？我已经尝试了一个星期。

![http://img123.imageshack.us/my.php?image=61519307xx5.jpg](https://i.stack.imgur.com/uZtmk.jpg)

> **公司**：ID_COMPANY，COMPANY_NAME
> 
> **产品**：ID_PRODUCT、PRODUCT_NAME
> 
> **PRODUCT_SALE**：ID_COMPANY、ID_PRODUCT、SALE_COUNT

**更新**：

在你的帮助下，我可以做到。但是现在我也有一个小问题。

当我使用枢轴编写查询时，产品名称成为列标题。如果产品名称的长度大于 30 个字符，Oracle 不接受它作为列标题。所以我已经裁剪并制作了 30 个字符的产品名称来解决这个问题。之后也出现了问题。

当我将产品名称裁剪为 30 个字符时，某些产品会变成相同的名称，并且出现“ORA-00918：列不明确定义”错误消息。

在这种情况下可以做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T06:21:45.913

您正在运行什么版本的 SQL？使用 PIVOT 可能是将数据转换为所需形式的快速方法，然后您可以使用通用 DataGrid 以（几乎）“原始”形式显示数据 - 即数据的呈现方式SQL 服务器。然后，您可以认为 DataGrid 更像是一个电子表格，而不是代表数据库中的数据表。

这是一个很好的入门文档，介绍了如何使用 PIVOT 以您所追求的形式表示数据：

```
http://www.tsqltutorials.com/pivot.php 
```

当然，我认为这可能只在 SQL 2005 中可用......所以如果您运行的是旧版本，这可能没有帮助。

**更新 ：**

在 Oracle 10g 上，您将需要 MODEL 扩展，这与 SQL 中的 PIVOT 没有什么*不同*，但显然 Oracle 10g 以自己的方式做事：[检查此链接](http://technology.amis.nl/blog/300/pivoting-in-sql-using-the-10g-model-clause)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T06:26:02.723

如果产品编号是静态的，以下将起作用：

```
<asp:gridview>
    <columns>
        <asp:boundfield datafield="companyname" itemstyle-headertext="" />
        <asp:boundfield datafield="SALE_COUNT" itemstyle-headertext='<%# FunctionToLoadurproduct(product1) %>' />
        <asp:boundfield datafield="SALE_COUNT" itemstyle-headertext='<%# FunctionToLoadurproduct(product1) %>' />

        and so on...
    </columns>
</gridview > 
```

使用内联查询根据查询中的产品 ID 管理产品销售。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T06:26:58.603

对我来说，这看起来像是一份交叉表报告。您有 2 个选项可以解决此问题

1.  透视数据库中的数据并将其绑定到数据网格。执行此操作的确切语法将根据您使用的数据库引擎而有所不同。[这是 SQL 中的一个示例](http://www.simple-talk.com/sql/t-sql-programming/creating-cross-tab-queries-and-pivot-tables-in-sql/)
2.  使用可以基于简单联接进行交叉表的报告工具，如 SQL Reporting Services、Crystal Reports、XtraReports 等

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T09:25:59.303

在 Oracle 10g 上，您将需要 MODEL 扩展，这与 SQL 中的 PIVOT 没有什么*不同*，但显然 Oracle 10g 以自己的方式做事：

[http://technology.amis.nl/blog/300/pivoting-in-sql-using-the-10g-model-clause](http://technology.amis.nl/blog/300/pivoting-in-sql-using-the-10g-model-clause)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-03T06:02:12.193

使用标准 sql 查询（数据透视在性能方面很昂贵）并在服务器端代码中创建自定义数据透视函数。这里有几个例子。

```
''' <summary>
''' Pivots columnX as new columns for the X axis (must be unique values) and the remaining columns as 
''' the Y axis. Optionally can include columns to exclude from the Y axis.
''' </summary>
''' <param name="dt"></param>
''' <param name="columnX"></param>
''' <param name="columnsToIgnore"></param>
''' <returns>DataTable</returns>
''' <remarks></remarks>
Public Shared Function Pivot(ByVal dt As DataTable, ByVal columnX As String, ByVal ParamArray columnsToIgnore As String()) As DataTable

    Dim dt2 As New DataTable()

    If columnX = "" Then
        columnX = dt.Columns(0).ColumnName
    End If

    'Add a Column at the beginning of the table 
    dt2.Columns.Add(columnX)

    'Read all DISTINCT values from columnX Column in the provided DataTable 
    Dim columnXValues As New List(Of String)()

    'Create the list of columns to ignore 
    Dim listColumnsToIgnore As New List(Of String)()
    If columnsToIgnore.Length > 0 Then
        listColumnsToIgnore.AddRange(columnsToIgnore)
    End If

    If Not listColumnsToIgnore.Contains(columnX) Then
        listColumnsToIgnore.Add(columnX)
    End If

    ' Add the X axis columns
    For Each dr As DataRow In dt.Rows
        Dim columnXTemp As String = dr(columnX).ToString()
        If Not columnXValues.Contains(columnXTemp) Then
            columnXValues.Add(columnXTemp)
            dt2.Columns.Add(columnXTemp)
        Else
            Throw New Exception("The inversion used must have unique values for column " + columnX)
        End If
    Next

    'Add a row for each non-columnX of the DataTable 
    For Each dc As DataColumn In dt.Columns
        If Not columnXValues.Contains(dc.ColumnName) AndAlso Not listColumnsToIgnore.Contains(dc.ColumnName) Then
            Dim dr As DataRow = dt2.NewRow()
            dr(0) = dc.ColumnName
            dt2.Rows.Add(dr)
        End If
    Next

    'Complete the datatable with the values 
    For i As Integer = 0 To dt2.Rows.Count - 1
        For j As Integer = 1 To dt2.Columns.Count - 1
            dt2.Rows(i)(j) = dt.Rows(j - 1)(dt2.Rows(i)(0).ToString()).ToString()
        Next
    Next

    Return dt2

End Function

''' <summary>
''' Can pivot any column as X, any column as Y, and any column as Z. Sort on X, sort on Y and optionally, the 
''' values at the intersection of x and y (Z axis) can be summed.
''' </summary>
''' <param name="dt"></param>
''' <param name="columnX"></param>
''' <param name="columnY"></param>
''' <param name="columnZ"></param>
''' <param name="nullValue"></param>
''' <param name="sumValues"></param>
''' <param name="xSort"></param>
''' <param name="ySort"></param>
''' <returns>DataTable</returns>
''' <remarks></remarks>
Public Shared Function Pivot(ByVal dt As DataTable, ByVal columnX As String, ByVal columnY As String, ByVal columnZ As String, _
    ByVal nullValue As String, ByVal sumValues As Boolean, ByVal xSort As Sort, ByVal ySort As Sort) As DataTable

    Dim dt2 As New DataTable()
    Dim tickList As List(Of Long) = Nothing

    If columnX = "" Then
        columnX = dt.Columns(0).ColumnName
    End If

    'Add a Column at the beginning of the table 
    dt2.Columns.Add(columnY)

    'Read all DISTINCT values from columnX Column in the provided DataTable 
    Dim columnXValues As New List(Of String)()
    Dim cols As Integer = 0

    For Each dr As DataRow In dt.Rows
        If dr(columnX).ToString.Contains("'") Then
            dr(columnX) = dr(columnX).ToString.Replace("'", "")
        End If
        If Not columnXValues.Contains(dr(columnX).ToString) Then
            'Read each row value, if it's different from others provided, 
            'add to the list of values and creates a new Column with its value. 
            columnXValues.Add(dr(columnX).ToString)
        End If
    Next

    'Sort X if needed
    If Not xSort = Sort.None Then
        columnXValues = SortValues(columnXValues, xSort)
    End If

    'Add columnX
    For Each s As String In columnXValues
        dt2.Columns.Add(s)
    Next

    'Verify Y and Z Axis columns were provided 
    If columnY <> "" AndAlso columnZ <> "" Then
        'Read DISTINCT Values for Y Axis Column 
        Dim columnYValues As New List(Of String)()

        For Each dr As DataRow In dt.Rows
            If dr(columnY).ToString.Contains("'") Then
                dr(columnY) = dr(columnY).ToString.Replace("'", "")
            End If
            If Not columnYValues.Contains(dr(columnY).ToString()) Then
                columnYValues.Add(dr(columnY).ToString())
            End If
        Next

        ' Now we can sort the Y axis if needed. 
        If Not ySort = Sort.None Then
            columnYValues = SortValues(columnYValues, ySort)
        End If

        'Loop all Distinct ColumnY Values
        For Each columnYValue As String In columnYValues
            'Create a new Row 
            Dim drReturn As DataRow = dt2.NewRow()
            drReturn(0) = columnYValue
            Dim rows As DataRow() = dt.[Select](columnY + "='" + columnYValue + "'")

            'Read each row to fill the DataTable 
            For Each dr As DataRow In rows
                Dim rowColumnTitle As String = dr(columnX).ToString()

                'Read each column to fill the DataTable 
                For Each dc As DataColumn In dt2.Columns
                    If dc.ColumnName = rowColumnTitle Then
                        'If sumValues, try to perform a Sum 
                        'If sum is not possible due to value types, use the nullValue string
                        If sumValues Then
                            If IsNumeric(dr(columnZ).ToString) Then
                                drReturn(rowColumnTitle) = Val(drReturn(rowColumnTitle).ToString) + Val(dr(columnZ).ToString)
                            Else
                                drReturn(rowColumnTitle) = nullValue
                            End If
                        Else
                            drReturn(rowColumnTitle) = dr(columnZ).ToString
                        End If
                    End If
                Next
            Next

            dt2.Rows.Add(drReturn)

        Next
    Else
        Throw New Exception("The columns to perform inversion are not provided")
    End If

    'if nullValue param was provided, fill the datable with it 
    If nullValue <> "" Then
        For Each dr As DataRow In dt2.Rows
            For Each dc As DataColumn In dt2.Columns
                If dr(dc.ColumnName).ToString() = "" Then
                    dr(dc.ColumnName) = nullValue
                End If
            Next
        Next
    End If

    Return dt2

End Function

''' <summary>
''' Sorts a list of strings checking to see if they are numeric or date types.
''' </summary>
''' <param name="list"></param>
''' <param name="srt"></param>
''' <returns></returns>
''' <remarks></remarks>
Private Shared Function SortValues(ByVal list As List(Of String), ByVal srt As Sort) As List(Of String)

    Dim tickList As List(Of Long) = Nothing
    Dim dblList As List(Of Double) = Nothing

    ' Figure out how to sort columnX
    For Each s As String In list
        Dim colDate As Date = Nothing
        If Date.TryParse(s, colDate) Then
            tickList = New List(Of Long)
            Exit For
        End If
    Next

    Dim dateTicks As Long

    If Not tickList Is Nothing Then
        For Each s As String In list
            dateTicks = DateTime.Parse(s).Ticks
            If Not tickList.Contains(dateTicks) Then
                tickList.Add(dateTicks)
            End If
        Next

        If srt = Sort.DESC Then
            tickList.Sort()
            tickList.Reverse()
        ElseIf srt = Sort.ASC Then
            tickList.Sort()
        End If

        list.Clear()
        For Each lng As Long In tickList
            list.Add(New Date(lng).ToString("G"))
        Next
    Else
        Dim dbl As Double = Nothing

        For Each s As String In list
            If IsNumeric(s) Then
                dblList = New List(Of Double)
            End If
        Next

        If Not dblList Is Nothing Then
            'Doubles or Integers
            For Each s As String In list
                dbl = Val(s)
                If Not dblList.Contains(dbl) Then
                    dblList.Add(dbl)
                End If
            Next

            If srt = Sort.DESC Then
                dblList.Sort()
                dblList.Reverse()
            ElseIf srt = Sort.ASC Then
                dblList.Sort()
            End If

            list.Clear()
            For Each d As Double In dblList
                list.Add(d.ToString)
            Next
        Else
            'Strings
            If srt = Sort.DESC Then
                list.Sort()
                list.Reverse()
            ElseIf srt = Sort.ASC Then
                list.Sort()
            End If
        End If

    End If

    Return list

End Function 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T13:13:45.207

使用嵌套的中继器控件。外部中继器将重复公司，内部将重复产品。

# haskell - Haskell 使用什么类型的作用域？

> ID：333185
> 
> 赞同：7
> 
> 时间：2008-12-02T06:05:53.807
> 
> 标签：haskell, scope, alias

我试图弄清楚 Haskell 是使用动态范围还是静态范围。我意识到，例如，如果您定义：

```
let x = 10 
```

然后定义函数

```
let square x = x*x 
```

您有 2 个不同的“x”，这是否意味着它是动态范围的？如果不是，它使用什么范围，为什么？

此外，Haskell 变量可以有别名（相同内存位置/值的不同名称）吗？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-02T06:09:50.010

Haskell 使用（广义上）与大多数其他语言完全相同的词法作用域。

例如。

```
x = 10 
```

导致在全局范围内引用的值`x`，而

```
square x = x * x 
```

将导致`x`词法范围限定为函数 square。如果您认为上述形式是一种语法上的精巧，它可能会有所帮助：

```
square = \ x -> x * x 
```

至于你的另一个问题，我不确定你所说的别名是什么意思

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-02T10:57:42.050

只回答问题的第二部分：

同一个“内存位置”可以有多个别名，但由于它们都是不可变的，所以大多数时候都没有关系。

愚蠢的例子：

```
foo x y = x * y
bar z = foo z z 
```

在`foo`调用 from`bar`时，两者`x`和`y`显然是相同的值。但由于您不能修改`x`或`y`，您甚至不会注意到。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-02T06:39:59.370

你的说法有些地方不对...

*   Haskell 中没有可变变量，只有定义（或不​​可变变量）
*   可变内存位置是 Haskell 中不存在的概念

在您的示例中，函数中的*x*不是10**只是**square 的一个参数，它可以采用任何值（您可以稍后指定类型）在这种情况下为 10，但只是在这种情况下。

[以下是Curt Sampson](https://stackoverflow.com/users/107294/curt-sampson)提供的别名示例：

```
import Data.IORef

main :: IO ()
main = do x <- newIORef 0         -- write 0 into x
          readIORef x >>= print   -- x contains 0
          let y = x
          readIORef y >>= print   -- y contains 0
          writeIORef x 42         -- write 42 into x
          readIORef y >>= print   -- y contains 42 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-02T15:43:32.660

由于问题的第一部分已经被其他人回答，这里是第二部分：

我假设`aliasing`你的意思是`one name for another`。由于 haskell 是一种函数式语言，并且函数在任何情况下都表现为普通标识符，因此您可以这样做：

```
y = x 
```

`y`这将为函数定义一个别名`x`。请注意，一切都是函数。即使它看起来像一个*“变量”*，它也只是一个不带参数的空函数。类型的别名如下所示：

```
type Function = Double -> Double 
```

`Function`这将为该类型定义一个别名`Double -> Double`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-02T15:46:09.830

在您的示例中，x 的全局定义被 x 的局部定义所掩盖。在 Haskell 中，变量的作用域由源代码的静态读取决定——这称为词法作用域，但可以得到类似于带有隐式参数的动态作用域的东西（但这可能导致一些意外行为（我读过；从不我自己试过））。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-10T09:54:05.137

Haskell 使用静态嵌套作用域。与其他具有静态嵌套范围的语言相比，有点令人困惑的是，**名称的范围是一个块，其中包括在其定义之前的测试**。例如

```
evens = 0 : map (+1) odds
odds  = map : (+1) evens 
```

在这里，“赔率”这个名称在“偶数”的定义范围内，尽管令人惊讶的事实是“赔率”尚未定义。（该示例定义了两个无限的偶数和奇数列表。）

具有类似范围规则的死语言是 Modula-3。但是 Haskell 有点棘手，因为您可以尝试在同一范围内“重新定义”一个变量，但您只需引入另一个递归方程。对于首先学习 ML 或 Scheme 的人来说，这是一个陷阱：

```
let x = 2 * n
    x = x + 1   -- watch out! 
```

这是非常好的 ML 或 Scheme let*，但 Haskel 具有 scheme letrec 语义，不受 lambda 值的限制。难怪这是棘手的事情！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-03T18:53:51.403

简明扼要地总结其他答案：

1.  词汇范围
2.  别名很简单，`x = 1; y = x`但通常并不重要，因为事物是不可变的。

`let`您在示例中使用的语法看起来像是在交互式`ghci>`提示中。交互模式中的所有内容都发生在 IO monad 中，因此那里的事情可能看起来比正常情况更易变。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-07T20:59:01.100

好吧，正如我认为人们已经说过的那样，Haskell 没有在大多数其他语言中发现的任何变量，它只有表达式。在您的示例`let x = 10`中，x 是一个始终计算为 10 的表达式。稍后您实际上无法更改 x 的值，尽管您可以使用范围规则通过将 x 定义为另一个表达式来隐藏它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-15T01:44:04.750

是的，Haskell 有别名。试试这个小程序：

```
import Data.IORef

main :: IO ()
main = do x <- newIORef 0         -- write 0 into x
          readIORef x >>= print   -- x contains 0
          let y = x
          readIORef y >>= print   -- y contains 0
          writeIORef x 42         -- write 42 into x
          readIORef y >>= print   -- y contains 42 
```

# c# - MVC 的大量服务使得控制器构造函数非常庞大。

> ID：333188
> 
> 赞同：2
> 
> 时间：2008-12-02T06:09:34.177
> 
> 标签：c#, mvp

我最终在模型类的构造函数中有大约 20 个不同的参数，每个服务一个？这是正常现象还是有问题的迹象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T08:55:16.273

我认为，明确地说，您的控制器正在与太多服务进行交互。我还没有看到你的代码——所以我放弃了假设——但在我看来，你的控制器正在通过调用大量“小”服务来组成业务逻辑，而不是利用更少、“更大”的服务来组成业务逻辑从较小的服务。

查看有关“编排服务”与“实体”或“能力”服务的信息，您就会明白我的意思。如果您创建为控制器提供所需逻辑的编排服务，那么您的架构就会得到改进，因为您的控制器实际上根本不应该包含任何业务逻辑。

我真的认为您使用的服务数量是这里的问题。IoC 容器可能会以某种方式解决如何将类型绑定到注入参数等，但我认为问题在于此时的架构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T06:16:39.137

您可以尝试整合一些服务或考虑将控制器视图部分重构为更小的范围组件。此外，像 Spring 这样的依赖注入风格的框架可以帮助解决这样的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T07:21:16.620

虽然我不知道你的设置。20 似乎有点多，我认为您违反了 SRP（单一责任原则）。但是由于我看不到您的代码，因此无法分辨。如果您确实需要该模型类中的所有这些服务，那么也许您需要将它们放在工厂类中并将其用作参数。

由于我们不知道您的域，因此很难就此给出任何好的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T07:12:15.047

正如@Matt 所说，依赖注入可以帮助你，sprint.NET 是一个很好的，还有其他几个。

当你特别提到 MVP 时，你至少应该看看现在有**Unity的**[Ent Lib 4.1](http://www.microsoft.com/downloads/details.aspx?FamilyId=1643758B-2986-47F7-B529-3E41584B6CE5&displaylang=en)，微软对 DI 的看法。如果这是新的，他们的[codeplex](http://www.codeplex.com/entlib)站点可能是一个不错的起点。

 **还有一些**与 Visual Studio 集成的**[软件工厂](http://www.codeplex.com/websf)，并为您提供了为网站创建 MVP 作为链接或 Web 服务的工具。这些也来自模式和实践。

 **# performance - Hibernate 适合批处理吗？内存使用情况如何？

> ID：333198
> 
> 赞同：6
> 
> 时间：2008-12-02T06:19:34.060
> 
> 标签：performance, hibernate, memory, jdbc, memory-management

我有一个日常批处理过程，其中涉及选择大量记录并格式化文件以发​​送到外部系统。我还需要将这些记录标记为已发送，以便明天不会再次发送它们。

在我幼稚的 JDBC 方式中，我会准备并执行一个语句，然后开始循环遍历记录集。由于我只通过记录集前进，因此我的应用程序服务器无需一次将整个结果集保存在内存中。可以从数据库服务器馈送记录组。

现在，假设我正在使用休眠。我不会一次得到一堆代表内存中整个结果集的对象吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T09:03:49.660

Hibernate 也会遍历结果集，因此内存中只保留一行。这是默认设置。如果它贪婪地加载，你必须告诉它。

使用休眠的原因：

*   “某人”具有“创造性”的列名 (PRXFC0315.XXFZZCC12)
*   DB 设计仍在不断变化和/或您想要一个将列名映射到 Java 的地方。
*   无论如何你都在使用 Hibernate
*   您有复杂的查询并且您不精通 SQL

**不**使用 Hibernate 的原因：

*   您的应用程序的其余部分是纯 JDBC
*   您不需要任何 Hibernate 的强大功能
*   您有复杂的查询，并且精通 SQL
*   您需要数据库的特定功能来执行 SQL

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-02T17:05:26.613

Hibernate 提供了一些保持会话小的可能性。

您可以使用 Query.scroll()、Criteria.scroll() 进行类似 JDBC 的滚动。您可以使用 Session.evict(Object entity) 从会话中删除实体。您可以使用 StatelessSession 来抑制脏检查。还有一些更多的性能优化，请参阅 Hibernate 文档。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T16:49:37.300

Hibernate 作为任何 ORM 框架旨在开发和维护基于面向对象编程主体的系统。但是大多数数据库都是关系型的，而不是面向对象的，所以无论如何，ORM 总是在方便的 OOP 编程和优化/最有效的数据库访问之间进行权衡。

我不会将 ORM 用于特定的隔离任务，而是将其用作应用程序持久层的整体架构选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T09:20:37.613

在我看来，我**不会**使用 Hibernate，因为它会让你的应用程序变得更大，更难维护，而且你真的没有机会快速优化生成的 sql 脚本。此外，您可以使用 JDBC-bridge 支持的所有 SQL 功能，而不仅限于休眠功能。另一件事是，每一层遗留代码也有限制。

但归根结底，这是一个哲学问题，你应该按照最适合你的思维方式去做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T15:37:03.360

如果可能存在性能问题，请坚持使用 JDBC 代码。

有许多众所周知的纯 SQL 优化在 Hibernate 中很难做到。

只选择您使用的列！（没有“选择*”的东西）。

保持 SQl 尽可能简单。例如，不要在连接中包括像货币代码这样的小型参考表。而是将货币表加载到内存中，并通过程序查找来解析货币描述。

取决于 SQL 的 DBMS 次要重新排序，其中谓词可能对性能产生重大影响。

如果您要更新/插入，则只提交每 100 到 1000 次更新。即不要提交每个工作单元，而是保留一些计数器，以便减少提交的频率。

利用数据库的聚合函数。如果您想按部门代码计算总计，请在 SQL 中使用“ SUM(amount) ... GROUP BY DEPT ”。

# java - 开发 Eclipse 插件期间的运行时问题

> ID：333201
> 
> 赞同：2
> 
> 时间：2008-12-02T06:20:51.080
> 
> 标签：java, eclipse, plugins, runtime

现在，我正在尝试创建一个依赖于其他 jar 的 Eclipse 插件；因此，我在 jar 上创建了一个插件库，并将其部署在我的 Eclipse 插件文件夹下。当我通过 Eclipse 从我的工作环境启动它时，它运行良好。但是，一旦我将它导出到一个 jar 并部署到 Eclipse 中，它就不再工作了，因为它无法找到依赖的 jar。发生了什么以及如何解决问题？有人知道吗？请救救我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T07:11:57.920

MANIFEST.MF 有一个名为“Dependencies”的选项卡，所有插件都应在其中放置当前插件所依赖的所有插件。在运行时，您必须将“依赖项”插件放在与您要启动或要使用的插件相同的文件夹中。

当一个插件有它应该使用的 jars 时，你必须将 jars 放到“Runtime”类路径条目中，并且应该将 jars 添加到“Build”Binary Build 条目中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T07:14:13.920

此外，与您的“外部 jar”插件关联的 plugin.xml 是否[导出了正确的包](http://dev.eclipse.org/newslists/news.eclipse.platform/msg46526.html)？

您是否查看过**[这篇](http://www.eclipsezone.com/eclipse/forums/t54726.html)**描述将 3rd 方 jar 打包为插件所需的所有步骤的文章？

其他非常重要的点**[在 OSGI Enterprise 应用程序中的 PDE 和 3rdParty Bundles](http://ekkes-corner.blogspot.com/2008/09/pde-and-3rdparty-bundles-in-osgi.html)**文章中进行了描述，其规则如下：

*   始终将依赖的 JAR 文件放在单独的包中，并在清单文件中描述依赖关系。不要将这些 JAR 隐藏在您自己的包中。

*   如果可能，请使用 Import-Package 来解决您的依赖关系。

*   仅导出您的“公共”包 - 没有内部包。

*   仅使用 Require-Bundle 来解决您自己的“宇宙”内的依赖关系，而不是针对常见的捆绑包。

*   始终版本 Require-Bundle、Import-Package 和 Export-Package。
    **Require-Bundle**始终依赖于具有特定名称的包。
    **Import-Package**不依赖于包的名称，因此它更灵活。当然，与使用 Require-Bundle 的单行程序相比，查看您的包并决定需要导入或导出哪些包需要做更多的工作

*   如果一个包本身包含包内的包并导出它们，切勿将这些包也作为导入包放入清单中。

*   在将捆绑包部署为插件之前，请确保重新计算 Package-Uses。导出包的错误包使用条目可能会阻止 PDE 导出您的插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T06:58:14.530

Eclipse 的工作行为是正常的，因为依赖的 jar 在项目的类路径中。

你看过你部署的插件文件夹吗？我怀疑插件文件夹中不包含依赖项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T07:41:29.450

我只是有一个类似的问题。我使用插件视图修复了它：

1.  使用 Runtime 选项卡的 Classpath 部分添加 jar
2.  使用概览选项卡中的组织清单向导进行所有必需的清单更改
3.  使用概览选项卡中的导出向导导出完成的插件。

注意我使用的是 Eclipse 3.3，所以你的里程可能会有所不同。

# jsf - ui:calendar 标签渲染问题

> ID：333216
> 
> 赞同：0
> 
> 时间：2008-12-02T06:33:59.447
> 
> 标签：jsf

我是这个 JSF 世界的新手，如果我问一些愚蠢的事情，请多多包涵

我正在为我的应用程序使用 UI 标签，并且我有一个场景，我需要生成一个日历控件以使用户选择我遵循 ui 标签文档并编写如下代码的日期：

```
 <table width="100%">
    <tr>
    <td>
           <ui:calendar binding="#{booking.calDate}"
           id="calDate"
          dateFormatPattern="dd/MM/yyyy" 
          label="Date ::"/>
          </td>
          </tr>
     </table> 
```

我的支持豆包含

```
 private Calendar calDate = new Calendar(); 
```

使用适当的 getter 和 setter

当我尝试加载页面时，日历组件被弄乱了。我得到了交叉标记和一些 javascript 错误的废话。

请帮我解决这个问题

感谢期待

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T13:09:18.723

I got the solution by myself - the issue is with the javascript code. it reads the javascript from themes.jar, which i placed in web-inf/lib folder still it was unable to access that. so I extracted the same and placed it in web-inf and it's working fine

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T08:21:59.867

该组件来自哪个 JSF 库？换句话说，您在 XHTML 文件的开头有什么？

我知道的唯一库来自[Facelets](https://facelets.dev.java.net/)，它不提供任何组件！

另外，如果 calDate 是一个 **java.util.**Calendar 类，那么你不能将这个类绑定到一个 JSF 组件！

也许你可以看看[Tomahawk](http://myfaces.apache.org/tomahawk-project/tomahawk12/tagdoc/t_inputCalendar.html)或[Richfaces](http://livedemo.exadel.com/richfaces-demo/richfaces/calendar.jsf)，它们提供了很好的日历组件......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T15:05:46.043

您在使用 MyFaces 吗？如果是这样，您可能需要配置[MyFaces 过滤器](http://myfaces.apache.org/tomahawk/extensionsFilter.html)。这会加载 JavaScript 和图像等，并且可能是您的 JavaScript 和图像加载问题的原因。

显然，如果您不使用 MyFaces，这将不是问题！

# php - 是否有一个很好的预先存在的类来处理 PHP 中的 URL？

> ID：333221
> 
> 赞同：3
> 
> 时间：2008-12-02T06:42:48.243
> 
> 标签：php, url

是否有一个被广泛接受的类来处理 PHP 中的 URL？

诸如：获取/更改现有 URL 的部分（例如路径、方案等），从基本 URL 解析相对路径。有点像双向[parse_url()](http://php.net/parse_url)，封装了一堆方便的函数。

这样的事情存在吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T06:48:47.920

这个**[URL.php 类](http://www.phpclasses.org/browse/file/3008.html)**可能是一个好的开始（虽然不确定它是否被“广泛”接受）。

> 用于 http 和 https 方案的 URL 类
> 
> 此类允许您存储绝对或相对 URL 并访问它的各个部分（方案、主机、端口、部分、查询、片段）。
> 
> 它还将接受并尝试根据已存储的绝对 URL 解析相对 URL。
> 
> 注意：此 URL 类基于 HTTP 方案。
> 
> 例子：

```
$url =& new URL('http://www.domain.com/path/file.php?query=blah');
echo $url->get_scheme(),"\n";    // http
echo $url->get_host(),"\n";      // www.domain.com
echo $url->get_path(),"\n";      // /path/file.php
echo $url->get_query(),"\n";     // query=blah
// Setting a relative URL against our existing URL
$url->set_relative('../great.php');
echo $url->as_string(); // http://www.domain.com/great.php 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-02T07:36:22.613

您已经在 PEAR 获得了[Net_URL2](http://pear.php.net/package/Net_URL2/docs)包，它似乎已经取代了[原来的 Net_URL](http://pear.php.net/package/Net_URL/docs)。我没有第一手经验，但我几乎总是会在“网站上找到的随机库”上使用 PEAR 包。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-02T18:36:49.907

[`Zend_Uri`](http://framework.zend.com/manual/en/zend.uri.html)是一个很好的候选人。

# linq - 没有主键的 Linq 插入

> ID：333228
> 
> 赞同：7
> 
> 时间：2008-12-02T06:56:09.963
> 
> 标签：linq, linq-to-sql

我需要使用 LINQ to SQL 将记录插入到没有主键的表中。桌子设计得很差；我无法控制表结构。该表由几个 varchar 字段、一个文本字段和一个时间戳组成。它用作其他实体的审计跟踪。

完成插入的最佳方法是什么？我可以为这个表扩展 Linq 部分类并添加一个“假”键吗？我对任何黑客都持开放态度，无论多么笨拙。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-02T07:05:00.477

LINQ to SQL 不适用于此任务，因此不要使用它。只需将插入扭曲到存储过程中，然后将该过程添加到您的数据模型中。如果您不能这样做，请使用一些内联 SQL 编写一个普通函数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-02T07:04:09.447

在设计器中打开您的 DBML 文件，并为映射提供一个键，无论您的数据库是否有一个键。这将解决您的问题。但是请注意，如果数据库中没有真正的密钥，则不能指望用于标识或其他任何内容的列。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-12-15T06:30:08.370

我能够使用复合键解决此问题。

我对只包含两列的表有类似的问题：用户名、角色。该表显然不需要标识列。因此，我创建了一个包含用户名和角色的复合键。这使我能够使用 LINQ 来添加和删除条目。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-02T07:19:41.210

您可以使用[DataContext.ExecuteCommand](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.executecommand.aspx)方法来运行您自己的自定义插入语句。

或者，您可以向列添加[主键](http://msdn.microsoft.com/en-us/library/bb386963.aspx)，这将允许数据上下文[跟踪对象](http://msdn.microsoft.com/en-us/library/bb399376.aspx)的插入/更新/删除。即使该列实际上不是数据库中的强制主键，这也将起作用（linq 怎么知道？）。如果您只进行插入并且从不在同一数据上下文中重复使用主键值，那么您会没事的。

# linq - Linq 是如何工作的（在幕后）？

> ID：333242
> 
> 赞同：12
> 
> 时间：2008-12-02T07:08:41.153
> 
> 标签：linq, lua

我正在考虑为 Lua 制作类似 Linq 之类的东西，我大致了解 Linq 的工作原理，但想知道是否有一篇好文章，或者是否有人可以解释 C# 如何使 Linq 成为可能

注意：我的意思是在幕后，比如它如何生成代码绑定等等，而不是最终用户语法。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-02T07:19:00.337

很难回答这个问题，因为 LINQ 有很多不同的东西。比如坚持C#，就涉及到以下几点：

*   查询表达式被“预处理”成“没有查询表达式的 C#”，然后正常编译。规范的查询表达式部分非常短——它基本上是一种机械翻译，除了“order by 被翻译成 OrderBy/ThenBy/etc”之外，它不假设查询的真正含义。
*   委托用于将具有特定签名的任意操作表示为可执行代码。
*   表达式树用于表示相同的事物，但作为数据（可以检查并转换为不同的形式，例如 SQL）
*   Lambda 表达式用于将源代码转换为委托或表达式树。
*   大多数 LINQ 提供程序使用扩展方法将静态方法调用链接在一起。这允许一个简单的接口（例如`IEnumerable<T>`）有效地获得更多的权力。
*   匿名类型用于预测 - 您有一些不同的数据集合，并且您想要该数据的每个方面的位，匿名类型允许您将它们收集在一起。
*   `var`隐式类型局部变量（
*   迭代器块通常用于实现进程内查询，例如用于 LINQ to Objects。
*   类型推断用于使整个事情变得更加顺畅 - LINQ 中有很多通用方法，如果没有类型推断，那将非常痛苦。
*   代码生成用于将模型（例如 DBML）转换为代码
*   部分类型用于为生成的代码提供可扩展性
*   属性用于向 LINQ 提供程序提供元数据

显然，其中很多*不仅*被 LINQ 使用，而且不同的 LINQ 技术将依赖于它们。

如果您可以提供更多关于您感兴趣的方面的指示，我们或许可以提供更多详细信息。

如果您对有效实现 LINQ to Objects 感兴趣，您可能会对几周前我在 DDD 的 Reading 上发表的演讲感兴趣 - 基本上是在一个小时内实现尽可能多的 LINQ to Objects。到最后我们还远未完成，但它应该很好地了解您需要做的事情（以及缓冲/流式传输、迭代器块、查询表达式翻译等）*。*视频还没有发布（我还没有上传代码供下载）但是如果你有兴趣，请给我发邮件至 skeet@pobox.com，我会在视频发布时通知你. （我可能也会写博客。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-02T07:16:40.547

[Mono](http://www.mono-project.com/Main_Page)（部分？）实现 LINQ，并且是开源的。也许你可以看看他们的实施？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T07:17:07.707

阅读这篇文章：

[了解如何创建自定义 LINQ 提供程序](http://dotnetslackers.com/articles/csharp/LINQProviderBasics.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-02T07:39:16.973

也许我的[LINQ for R6RS Scheme](https://ironscheme.svn.codeplex.com/svn/IronScheme/IronSchemeConsole/ironscheme/linq.ss)会提供一些见解。

它在语义上是 100%，在语法上几乎 100% 与 LINQ 相同，除了使用 'then' 而不是 ',' 的附加排序参数之外。

一些规则/假设：

*   只处理列表，没有查询提供者。
*   不是懒惰，而是渴望理解。
*   没有静态类型，因为 Scheme 不使用它们。

我的实现取决于几个核心程序：

*   地图 - 用于“选择”
*   过滤器 - 用于“哪里”
*   flatten - 用于“SelectMany”
*   sort - 多键排序过程
*   groupby - 用于对结构进行分组

结构的其余部分都是使用宏构建的。

绑定存储在一个列表中，该列表带有绑定标识符以确保卫生。无论何时出现表达式，绑定都会被提取并在本地反弹。

我确实在我的[博客](http://xacc.wordpress.com/category/ironscheme/)上跟踪了进度，这可能会为可能的问题提供一些见解。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-02T09:58:44.307

对于设计理念，请查看催生 Linq 的研究项目[c omega 。](http://research.microsoft.com/Comega/)Linq 是 c omega 的更实用或淡化的版本，具体取决于您的观点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-02T09:15:32.210

Matt Warren 的博客提供了所有答案（以及一个示例 IQueryable 提供程序实现，让您抢先一步）：

[http://blogs.msdn.com/mattwar/](http://blogs.msdn.com/mattwar/)

# visual-studio - 检查 Visual Studio 是否可以加载程序集

> ID：333244
> 
> 赞同：0
> 
> 时间：2008-12-02T07:09:32.027
> 
> 标签：visual-studio, sharepoint, assemblies

我有一些用户控件将通过 SmartPart 添加到 SharePoint 中。

我正在本地计算机上进行测试，但我计划使用 SharePoint 安全性。

我想知道是否有一种方法可以快速测试以查看 Microsoft.SharePoint 程序集是否可以实际加载，以便我可以继续在我的机器上进行测试，然后在我将它上传到服务器时启用它。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T12:58:08.267

您当然可以将 Microsoft.SharePoint.dll 复制到本地计算机并引用该 DLL。但是，它只提供 Intellisense 有用。您将无法使用它在本地计算机上执行任何 SharePoint 代码，因为 SharePoint 代码仅在服务器上运行。（另一种选择是使用远程调试，但相信我，这很痛苦！）

阅读[如何构建 SharePoint 开发机器](http://weblogs.asp.net/erobillard/archive/2007/02/23/build-a-sharepoint-development-machine.aspx)以获取更多信息。

# xml - 如何应用 XPath 函数 'substring-after'

> ID：333249
> 
> 赞同：17
> 
> 时间：2008-12-02T07:15:01.813
> 
> 标签：xml, xpath

我将使用什么 XPath 表达式来获取每本书的“HarryPotter:”后面的字符串。

IE。鉴于此 XML：

```
<bookstore>
<book>
  HarryPotter:Chamber of Secrets 
</book>
<book>
  HarryPotter:Prisoners in Azkabahn 
</book>
</bookstore> 
```

我会回来的：

```
Chamber of Secrets
Prisoners in Azkabahn 
```

我尝试过这样的事情：

```
/bookstore/book/text()[substring-after(. , 'HarryPotter:')] 
```

我认为我的语法不正确...

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-02T15:07:06.663

在 XPath 2.0 中，这可以由单个 XPath 表达式产生：

      **`/*/*/substring-after(., 'HarryPotter:')`**

在这里，我们使用了 XPath 2.0 非常强大的特性，在定位步骤路径的末尾我们可以放置一个函数，该函数将应用于当前结果集中的所有节点。

**在 XPath 1.0 中没有这样的特性**，这不能在一个 XPath 表达式中完成。

我们可以执行如下的 XSLT 转换：

```
<xsl:stylesheet 版本="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:输出方法="文本"/>

    <xsl:模板匹配="/">
      <xsl:for-each select="/*/*[substring-after(., 'HarryPotter:')]">
        <xsl:value-of 选择=
         "substring-after(., 'HarryPotter:')"/>
        <xsl:text>
</xsl:text>
      </xsl:for-each>
    </xsl:模板>
</xsl:样式表>  

```

应用于原始 XML 文档时：

```
<书店>
    <book> 哈利波特：密室</book>
    <book>哈利波特：阿兹卡班的囚徒</book>
</书店>

```

这种转换产生了想要的结果：

 **Azkabahn的密室囚犯**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-02T07:33:49.607

在您的 XML 中，Harry Potter 之间没有空格，但在 XQuery 中，您有空格。只要让它匹配和presto，你会得到数据回来......

```
 Dim xml = <bookstore>
                  <book>HarryPotter:Chamber of Secrets</book>
                  <book>HarryPotter:Prisoners in Azkabahn</book>
                  <book>MyDummyBook:Dummy Title</book>
              </bookstore>

    Dim xdoc As New Xml.XmlDocument
    xdoc.LoadXml(xml.ToString)

    Dim Nodes = xdoc.SelectNodes("/bookstore/book/text()[substring-after(., 'HarryPotter:')]")

    Dim Iter = Nodes.GetEnumerator()
    While Iter.MoveNext
        With DirectCast(Iter.Current, Xml.XmlNode).Value
            Console.WriteLine(.Substring(.IndexOf(":") + 1))
        End With
    End While 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-02T12:35:53.367

XPath 表达式

```
/bookstore/book/text()[substring-after(. , 'HarryPotter:')] 
```

将返回一个节点集，其中所有文本节点都包含值“HarryPotter:”。要使书名继承“HarryPotter：”，您需要遍历此节点集并获取每个节点的子字符串。如果您使用的是 XSLT，则可以使用 substring-after 来完成，如果您使用的是 VB，则可以使用 Substring 和 IndexOf 来完成，如 balabaster 所示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-01T17:47:15.067

Xpath：

```
substring-after(//book, 'HarryPotter:') 
```

我在这个领域是全新的，但对我来说，它有效......！

# c# - 用于公开从 xml 读取的数据的单例与静态类

> ID：333260
> 
> 赞同：1
> 
> 时间：2008-12-02T07:24:56.987
> 
> 标签：c#, .net, static, singleton

我们有一个 PageRoles xml 文件，其中包含页面路径和可以访问该页面的用户角色。

我们在一个静态类中维护一个 Dictionary，该类为该类加载了 int 静态构造函数。该类有一个 CheckIfRoleAllowed 方法，它接受页面路径并返回一个布尔值。

每个页面在 Page Init 上调用 CheckIfRoleAllowed。

```
static class PageAccessChecker
{
 static Dictionary<string, UserRoleType[]> _PageAccessPermissions;
 static FileSystemWatcher _XmlWatcher;

 static PageAccessChecker()
 {
   // Load page access permissions from xml
   // Set FileSystemWatcher watcher to watch for changes
 }

 public static CheckIfRoleAllowed(string pagePath)
 {
 }

} 
```

使用单例模式会更好吗？如果是，为什么？

亲切的问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T07:33:49.903

我可以看到使用单例模式的两个优点（如果通过静态属性实现）：

1.  您可以延迟加载 XML 文件，直到访问第一页。
2.  您可以检查磁盘上的 XML 文件是否已更改，并在下次访问时自动重新加载。

一个缺点可能是您需要使用锁使访问线程安全。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-02T08:04:25.253

实际上，您真的不想要单例或静态类。

首先，静态类*是*单例。我想您真正要问的是“添加繁琐的内容以确保其威胁安全并且仅存在一个是否有好处，或者换句话说，我是否需要一个'特殊'单身人士？” 答案是“否”，因为您不想要单身人士。

单例适用于**只能有一个**的对象，而不适用于只需要一个的对象。这不是这里的情况。这种情况不需要单例。你真正想要的是一个叫做“*全局变量*”的东西。

“可是等等！！！” 你说。“全局变量不是邪恶的吗？” 嗯，是的，有。但这在这里无关紧要。无论你称它为静态类还是单例或其他什么，你实际上拥有*的是*一个全局变量。将其称为其他东西不会改变任何事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T07:31:34.383

你确实使用了单例。简单地说，单例有两种常用的实现，另一种是实例化类并具有引用此实例的静态成员。

您的实现使调用更简单 IMO ：

```
PageAccessChecker.CheckIfRoleAllowed(path); 
```

代替：

```
PageAccessChecker._default.CheckIfRoleAllowed(path); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-02T08:08:09.507

如果您将类构造函数保持为私有，则没有真正的区别-它们都是可以延迟初始化的全局变量。

如果您将类构造函数保持为公共或受保护，并且仅使用该模式来创建全局（而不是强制执行单个实例），那么您至少可以测试您的单例类。

但是您真正应该尝试的是避免单例并改用依赖注入。请参阅Miško Hevery 的[单身人士是病态的骗子。](http://misko.hevery.com/2008/08/17/singletons-are-pathological-liars/)

# c# - 正则表达式 - 如果开始标记不存在，则匹配结束 html 标记

> ID：333264
> 
> 赞同：2
> 
> 时间：2008-12-02T07:32:05.600
> 
> 标签：c#, .net, regex

我想获得一个结束 html 标记，例如`</EM>`只有在它之前的某个地方，即在任何先前的标记或文本之前没有起始`<EM>`标记我的示例字符串是

```
ddd d<STRONG>dfdsdsd dsdsddd<EM>ss</EM>r and</EM>and strong</STRONG> 
```

在这个字符串中，输出应该是`</EM>`，这也是第二个`</EM>`，因为它缺少开始`<EM>`。我试过了

```
(?!=<EM>.*)</EM> 
```

但它似乎不工作请帮助thnks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T07:42:36.250

我不确定正则表达式是否最适合这种任务，因为标签总是可以嵌套的。

无论如何，一个 C# 正则表达式，如：

```
(?<!<EM>[^<]+)</EM> 
```

只会带来第二个`</EM>`标签

注意：

*   `?!`是一种消极的展望*，*它解释了为什么两者都`</EM>`被发现。
    所以... `(?!=<EM>.*)`xxx 实际上意味着如果没有跟随 xxx，则捕获 xxx `=<EM>.*`。我不确定您是否想在其中包含`=`一个
*   `?<!`是一个消极的*后*视，更适合你想做的事，但它不适用于 java 正则表达式引擎，因为这个后视正则表达式没有明显的最大长度。

但是，使用 .Net 正则表达式引擎，正如在[RETester](http://regexlib.com/RETester.aspx)上测试的那样，它确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T08:09:07.087

你需要一个[下推自动机](http://en.wikipedia.org/wiki/Pushdown_automaton)。正则表达式不足以捕捉这个概念，因为它们等同于[有限状态自动机](http://en.wikipedia.org/wiki/Finite_state_automaton)，所以严格来说，正则表达式解决方案是不可行的。

也就是说，.NET 正则表达式背后*确实*有一个下推自动机，因此它们理论上可以应对这种情况。如果您真的觉得需要使用正则表达式而不是正式的 HTML 解析器来执行此操作，[请看这里](http://blog.stevenlevithan.com/archives/balancing-groups)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-10T22:07:28.017

您应该会看到[另一个 Stack Overflow 问题](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)的最佳答案，因为它给出了完美的答案。简而言之，不要使用正则表达式来尝试解析 HTML - 这是一个非常糟糕的主意。

# photo-gallery - 我应该为 Web 画廊使用什么 Web 应用程序框架？

> ID：333269
> 
> 赞同：0
> 
> 时间：2008-12-02T07:36:16.747
> 
> 标签：photo-gallery

我需要为运行 IIS 4.0 或 IIS 5.0 的网站创建一个照片库（我不确定是哪个）。它需要向任何人显示画廊的低分辨率版本，并且必须为“特权”用户显示低分辨率和高分辨率图像。所以我需要访问权限、相册，一旦网站完成，我为之做这件事的人需要能够将他们自己的图像上传到画廊。它还需要有一个最小的界面，因为它需要集成到现有的网站中。

所以我需要一些关于我应该接近它的方向的建议。

有谁知道他们是否是一个可定制的画廊，可以做这样的事情，比如 Coppermine 或 Jgallery 之类的。另一种方法是使用 Web 框架，如 Ruby on Rails、CodeIgniter 或 Sproutcore（每个都需要学习一门新语言）。该框架会做更多的工作，但现有的画廊可能不够可定制。重要的是管理面板中的用户权限。

我对“网络编程”相对较新，尽管对普通/游戏编程并不陌生。我有几年的 C/C++ OpenGL 和 Java 经验。我还阅读了 MVC 等，并用[sproutcore](http://www.sproutcore.com/)做了 hello world ，所以我有点明白了。虽然学习一个框架是一项更重的投资。

你怎么认为？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T08:11:27.517

如果您不想重新发明轮子，您可以使用[Gallery2](http://gallery.menalto.com/)（[此处](http://codex.gallery2.org/Gallery2:Installation_Requirements)的要求）。它在 IIS 上运行——你只需要 PHP 和一个数据库。它非常可配置（包括用户帐户），有很多插件，如果这还不够的话，它是开源的。此外，开发和支持社区庞大而活跃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T08:05:42.020

你总是可以走 Dotnetnuke 的路线，然后使用 Ventrian 的 Simple Gallery 模块（[http://www.ventrian.com/Products/Modules/SimpleGallery/Demo.aspx](http://www.ventrian.com/Products/Modules/SimpleGallery/Demo.aspx)）

使用 DNN 可以提供大量功能，包括您需要的安全性，并且可以让您免于进行任何 Web 开发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T08:46:28.943

Flickr.com 及其 API 可能适合您所描述的内容。

[http://www.flickr.com/services/api/](http://www.flickr.com/services/api/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T09:18:25.153

如果您更喜欢冒险，请尝试基于 Smaltalk 的[Aida/Web](http://www.aidaweb.si)和特别是 Aida/Scribo CMS（目前仍处于测试阶段），其中还包括所谓的 scriblet 画廊。Scribo scriblets 是可以直接包含在文本中的 Web 组件。因此，您将画廊直接添加到环绕文本中。例如，将[演示文稿视为图库](http://www.swazoo.org/documentation.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T09:58:19.907

我会推荐我自己的，但是...如果不是具有权限的低/高分辨率的东西，我认为它会满足您的其余需求。我会留下一个链接，以防你想看看它： [nzFotolog](http://www.nazgulled.net/?lg=en&id=nzfotolog)

它也是开源的（尽管许可证不是最好的），您可以根据需要随意更改它。代码本身是干净且不言自明的。缺点是我已经有一段时间没有开发它了:(

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-03T09:56:28.647

我自己也面临过类似的困境，我不得不说我发现 Gallery2 和 Coppermine 都太包罗万象了，而且很难按照我希望的程度进行定制。我最终使用直接的程序化 PHP 和各种 jQuery 用于 GUI 花哨位。同时，我能够为我的婚纱摄影客户进行一些电子商务和数据收集，最终得到完全符合我需求的东西。当然，对于一个完整的编程（尽管不是 HTML）新手来说，这个项目的画廊方面是最不具挑战性的——这正是 PHP 的用途。

我现在正在为我的下一个项目（照片博客软件）使用 CodeIgniter 迈出步履蹒跚的第一步，我已经可以看到该框架将使画廊项目变得非常快速、简单和安全。

# factor-lang - 学习因素的好资源

> ID：333271
> 
> 赞同：27
> 
> 时间：2008-12-02T07:38:07.727
> 
> 标签：factor-lang

最近看到[这个对 Factor 的介绍](http://elasticdog.com/2008/11/beginning-factor-introduction/)，我有点好奇想了解更多。除了那里提到的官方常见问题解答之外，您是否有学习语言的资源（以及基于堆栈的“范式”，如果这是正确的词），您发现有帮助吗？

作为旁注，学习 Forth 会有所帮助吗，或者就像比较 C 和 Python（或者你有什么）？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-19T11:12:09.183

Factor 深受 Forth 和其他堆栈语言的启发。它还从 Lisp 和 Smalltalk 中汲取灵感。根据我在网上阅读的内容，在学习 Factor 之前没有必要学习任何这些语言。但是，如果您这样做，它不会受到伤害:)

我遇到的最大问题是语言的年轻化。换句话说，各种博客/网站上的代码示例将会过时，因为它们使用了较旧版本的 Factor（0.6、0.7、0.8 等）。系数 0.9 及以上最有可能保持不变。

一旦您掌握了基础知识，文档（在线 + 在侦听器中）就非常清楚了。文档偶尔会遇到与博客文章相同的问题：一些过时的代码示例。如果您真的遇到困难，您仍然可以使用邮件列表/IRC 来帮助您。

到目前为止，我只使用了文档，而不是邮件列表/IRC。然后我与听众进行实验，以进一步学习/探索我在文档中找到的新概念。

这是第一种仅通过深入研究函数文档就可以回答我的大多数问题的语言。Factor 的大部分内容都是用 Factor 编写的，因此随着您花更多时间在文档上，事情会变得更加清晰。

（我遇到的第二大问题是试图理解 Web 框架（Furnace）。Web 框架比我习惯的功能更丰富。这不是不可能的，只需要一些练习和探索文档。）

最快的介绍。到我发现的连接语言：http: [//github.com/raganwald/homoiconic/blob/master/2008-11-16/joy.md#readme](http://github.com/raganwald/homoiconic/blob/master/2008-11-16/joy.md#readme)

您进入 Factor 的第一步： http: [//concatenative.org/wiki/view/Factor/Learning](http://concatenative.org/wiki/view/Factor/Learning)

这些视频更详细地介绍了编写因子代码：

*   90 分钟的视频可能有助于学习 Factor 基础知识：[YouTube：Factor：一种可扩展的交互式语言](http://www.youtube.com/watch?v=f_0QlhYlS8g)- 基本上，Slava（Factor 创建者）提供了一个视频介绍。因素。它是 Google Talk 系列的一部分。（有一个高质量和低质量的版本，以防你看不到幻灯片。）因子概念也与其他语言进行了比较。
*   13 分钟视频：[Forth @ RubyConf 2008](http://rubyconf2008.confreaks.com/forth.html "Forth 在 RubyConf 2008")。Forth 的简短演示。它还提到了一些在整个软件世界中普遍存在的想法。
*   100 分钟视频：[向 Lisp 程序员展示的因素](http://www.vimeo.com/6203360)。音频不是最好的，但视频质量仍然非常好。如果您观看其他视频，则可以跳过其中的一些开头部分。

一些转移：

*   创建一个计算器 + GUI：[http ://re-factor.blogspot.com/2010/08/calculator-with-gui.html](http://re-factor.blogspot.com/2010/08/calculator-with-gui.html)
*   “我为什么喜欢因子”：http: [//jedahu.blogspot.com/2010/08/why-i-like-factor.html](http://jedahu.blogspot.com/2010/08/why-i-like-factor.html)
*   行星因子：[http ://planet.factorcode.org/](http://planet.factorcode.org/)

以下是一些可以帮助提供方向的博客文章：

*   从 2008 年 1 月开始，但它应该仍然适用：[Daniel Ehrenberg 的“Learning Factor”](http://useless-factor.blogspot.com/2008/01/learning-factor.html)（他是 Factor 的核心贡献者之一。）
*   以下引文来自 2008 年 9 月的博客文章：[使用嵌入数字对字符串进行排序](http://factor-language.blogspot.com/2008/09/sorting-strings-with-embedded-numbers.html)

> 了解可用的各种抽象和库是掌握 Factor 的关键：集合、通用词、fry、locals、宏、memoization、PEG、prettyprinter 等等。有效利用这些工具可以将解决问题所需的工作量减少一个数量级。

Factor 绝对是最有趣的语言。与其他语言相比，它的惊喜更少。我发现它比 Ruby 或 Lisp 更容易学习。只是为了好玩，这里是 Lisp 和 Factor 之间的语言大战：

*   [Lisp 代码](http://shootout.alioth.debian.org/u32/benchmark.php?test=nbody&lang=mzscheme&id=1)
*   [因子代码](http://gitweb.factorcode.org/gitweb.cgi?p=factor/.git;a=blob;f=extra/benchmark/nbody/nbody.factor;hb=HEAD)

对于任何对基于堆栈的语言感兴趣的人，这篇文章可能会有所帮助：[串联语言的乐趣（第 1、2、3 部分）](http://www.codecommit.com/blog/cat/the-joy-of-concatenative-languages-part-1 "连接语言的乐趣（第 1 部分）")（它更通用，并使用 Cat 语言作为示例。它帮助我学习了 Factor 基础知识。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-03T18:29:37.130

你可以从这里开始：[http ://concatenative.org/wiki/view/Factor](http://concatenative.org/wiki/view/Factor)

运行时/GUI 中包含一个很好的文档。只需安装然后“浏览器”，您就会看到包含“您的第一个程序”等主题的文档。

该文档也可以在线获得：http: [//docs.factorcode.org/](http://docs.factorcode.org/)
（与安装 Factor 时获得的文档相同。）

不要忘记订阅[planet-factor](http://planet.factorcode.org/)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-13T11:00:30.533

我最近一直在自学 Factor —— 实际上，我发现 Forth 是对基于堆栈的语言概念的一个很好的下午介绍（作为一个软件考古学家，退后几年来上一堂历史课很有趣）。

为此，我认为花几个小时来安装[gforth](http://www.gnu.org/software/gforth/)或类似的 Forth 实现并开始阅读开始或使用 ANS 的前几章[没有](http://www.forth.com/starting-forth/)任何[害处](http://www.forth.org/ansforth/ansforth.html)——我觉得这很有趣，因为我只当我开始学习因素时，它没有教给我任何我必须忘掉的东西。

一旦我在学习 Factor 方面取得了进一步的进展，我会让你知道我发现什么有用（或没那么有用！）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-09-01T18:43:26.030

我认为 Slava Pestov 在 Google（Google Tech Talk）上的出色演讲“ [Factor：一种可扩展的交互语言](http://www.youtube.com/watch?v=f_0QlhYlS8g)”算是学习 Factor 的一个很好的资源。有很多关于 Factor 不同方面的演示，您应该能够在您的系统上进行尝试。例如使用 Factor 实现 Internet 时间服务器的演示，大约。1 小时 7 分 20 秒和词汇关闭，46 分 35 秒。事实上，大部分演示文稿都是演示。

Flash 视频为 141 MB，1 小时 36 分 38 秒，演示时间为 2008 年秋季[。Slava Pestov](http://en.wikipedia.org/wiki/Slava_Pestov)是 Factor 编程语言和流行的文本编辑器 jEdit 的创建者。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-09-16T17:50:40.790

你也可以从 Forth 开始，因为它也是一种基于堆栈的语言：

*   [从头开始](http://www.forth.com/starting-forth/index.html)*   [思考](https://docs.google.com/viewer?url=http://thinking-forth.sourceforge.net/thinking-forth-ans.pdf)*   [第四入门](http://www.xs4all.nl/~thebeez/ForthPrimer/Forth_primer.html)*   [第四语言](http://c2.com/cgi/wiki?ForthLanguage)*   [第四教程](http://www.forth.org/tutorials.html)*   [Pforth 教程](http://www.softsynth.com/pforth/pf_tut.html)*   [Gforth 手册](http://www.complang.tuwien.ac.at/forth/gforth/Docs-html/)*   [开始](http://galileo.phys.virginia.edu/classes/551.jvn.fall01/primer.htm#intro)*   [第四链接](http://cis.csuohio.edu/~somos/forth.html)*   [维基福斯](http://en.wikipedia.org/wiki/Forth_%28programming_language%29)*   [OLPC 第四版](http://wiki.laptop.org/go/Forth_Lessons)*   [让我们构建一个编译器](http://home.iae.nl/users/mhx/crenshaw/tiny.html)*   [琼斯福斯](http://git.annexia.org/?p=jonesforth.git;a=summary)

（编辑：更新 Jonesforth 链接到新的 git 存储库 - 2014 年 4 月 18 日）

# java - 并行化：除了同步和 I/O 之外，是什么导致 Java 线程阻塞？

> ID：333280
> 
> 赞同：7
> 
> 时间：2008-12-02T07:49:56.187
> 
> 标签：java, multithreading, parallel-processing

短版在标题中。

长版：我正在开发一个使用 Java 进行科学优化的程序。程序的工作量可以分为并行和串行阶段——并行阶段意味着正在执行高度可并行化的工作。为了加速程序（它运行数小时/数天），我创建了与我正在使用的机器上的 CPU 内核数相等的线程数——通常是 4 或 8 个——并在它们之间分配工作。然后我在进入串行阶段之前启动这些线程并加入（）它们。

到目前为止，一切都很好。困扰我的是，并行阶段的 CPU 利用率和加速远未接近“理论最大值”——例如，如果我有 4 个内核，我预计会看到 350-400% 的“利用率”（如顶部报告）但相反，它在 180 到 310 之间反弹。仅使用一个线程，我得到 100% 的 CPU 利用率。

我所知道的线程不能全速运行的唯一原因是： - 由于 I/O 阻塞 - 由于同步而阻塞

在我的并行线程中没有任何 I/O 发生，也没有任何同步——线程共享的唯一数据结构是只读的，并且是基本类型或（非并发）集合。所以我正在寻找其他解释。一种可能性是多个线程反复阻塞垃圾收集，但这似乎只在内存压力的情况下才有意义，而且我分配的内存远高于所需的最大堆空间。

任何建议，将不胜感激。

**更新：**以防万一有人好奇，经过更多调查后，我调整了代码以获得一般性能并看到更好的利用率，即使我所做的任何更改都与同步无关。然而，一些变化应该会导致更少的新堆分配，特别是我摆脱了一些**迭代器**和**临时盒装数字**的使用（用于高性能 Java 计算的 CERN“Colt”库在这里很有用：它提供了像 IntArrayList 这样的集合, DoubleArrayList 等用于基本类型。）。所以我认为垃圾收集可能是罪魁祸首。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T07:54:54.337

所有图形操作都在一个单一的线程上运行。如果他们正在渲染到屏幕上，他们将有效地争夺对该线程的访问。

如果您在 Windows 上运行，那么无论如何，所有图形操作都在单个线程上运行。其他操作系统也有类似的限制。

实际上，有时很难获得线程工作者的适当粒度，有时很容易使它们变得太大或太小，这通常会使您对所有内核的使用率低于 100%。

如果您没有渲染太多 gui，那么最可能的罪魁祸首是您争夺的共享资源比您想象的要多。使用 jprofiler 之类的分析器工具很容易看到这一点。一些 VM 像 bea 的 jrockit 甚至可以直接告诉您这一点。

这是您不想凭猜测采取行动的地方之一。获取分析器！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T08:46:16.013

首先，GC 不仅会在“内存压力的情况下”发生，而且会在 JVM 认为合适的任何时候发生（据我所知，这是不可预测的）。

其次，如果您的线程在堆中分配内存（您提到他们使用集合，所以我猜他们确实在堆中分配内存），您永远无法确定该内存当前是在 RAM 中还是在虚拟内存页面上（操作系统决定)，因此对“内存”的访问**可能会产生**阻塞 I/O 访问！

最后，正如先前答案中所建议的那样，您可能会发现使用探查器检查发生的情况很有用（甚至 JMX 监控可能会在那里提供一些提示）。

我相信除非您提供更具体的（代码）信息，否则很难获得有关您的问题的进一步提示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T09:11:34.307

首先，我假设你没有在盒子上做任何其他重要的工作。如果你是，那显然会把事情搞砸。

如果你*真的*不分享任何东西，这听起来确实很奇怪。你能给我们更多关于代码真正在做什么的想法吗？

如果您将程序的 n 个副本作为不同的 Java 进程运行，而每个副本只使用一个线程，会发生什么情况？如果这完全使用了每个 CPU，那么至少我们知道它不会是操作系统的问题。说到操作系统，它在哪个操作系统上运行，哪个 JVM？如果您可以尝试不同的 JVM 和不同的操作系统，结果*可能会*提示您出了什么问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T09:17:24.560

还有一点很重要：您使用哪种硬件？例如，4-8 核可能意味着您使用 Suns Niagara CPU 之一。尽管有 4-8 个核心，但它们的[FPU](http://en.wikipedia.org/wiki/Floating_point_unit)更少。在计算科学数据时，可能会发生 FPU 是瓶颈。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T20:10:58.920

您正在某种程度上进行同步。

也许只存在于内存分配系统中，包括垃圾收集。尽管 JVM 供应商已努力将这些区域的阻塞降至最低，但他们无法将其减少到零。也许您的应用程序的某些内容正在推动该领域的薄弱环节。

公认的智慧是“不要建立自己的内存回收池，让 GC 为你工作”。大多数情况下都是如此，但至少在我维护的一段代码中并非如此（通过分析证明）。也许您需要以某种主要方式重新设计您的对象分配。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T09:03:03.483

您尝试使用完整的 CPU 功能进行计算，但操作系统本身也使用资源。因此请注意，操作系统会阻止您的某些执行以满足其需求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T02:33:16.010

试试 JRockit Mission Control 附带的延迟分析器。如果应用程序正在等待文件 I/O、TLA 获取、对象分配、线程挂起、JVM 锁、gc 暂停等，它将向您显示 CPU 在不做任何事情时正在做什么。您还可以查看转换，例如当一个线程唤醒另一个线程时。开销可以忽略不计，1% 左右。

有关更多信息，请参阅此[博客](http://blogs.oracle.com/hirt/2008/08/the_mission_control_30_latency.html)。该工具可免费用于开发，您可以[在此处下载](http://www.oracle.com/technology/products/jrockit/missioncontrol/index.html)

# c++ - 简单的效率问题 C++（内存分配）..也许一些碰撞检测有帮助？

> ID：333285
> 
> 赞同：0
> 
> 时间：2008-12-02T07:53:43.077
> 
> 标签：c++, memory, performance, allocation

我正在用 C++（一个多向 2d 空间射击游戏）编写一个类似街机的小游戏，我正在完成碰撞检测部分。

这是我组织它的方式（我只是编造它，所以它可能是一个糟糕的系统）：

每艘船都由圆形组件组成——每艘船中组件的数量是任意的（更多的组件，更多的 CPU 周期）。我有一个 maxComponent 距离，我在创建船时计算它，这基本上是我可以从船中心到最远组件边缘绘制的最长线。我跟踪屏幕上的东西并使用这个 maxComponentDistance 来查看它们是否足够接近以发生碰撞。

如果它们距离很近，我会开始检查不同船只的组件是否相交。这就是我的效率问题所在。

我有一个组件相对于船中心的 (x,y) 位置，但它没有考虑船当前的旋转方式。我保持它们是相对的，因为我不想在每次船移动时都重新计算组件。所以我有一个旋转计算的小公式，我返回一个二维向量，对应于相对于船舶中心的旋转考虑位置。

碰撞检测在 GameEngine 中，它使用 2d 向量。我的问题是关于返回类型。我应该在每次调用该函数时创建并返回一个二维向量对象，还是应该为该组件对象提供一个额外的私有二维向量变量，在调用函数时编辑私有变量，并返回指向该对象的指针？

我不确定内存分配与永久、可编辑、私有变量的效率。我知道也必须为私有变量分配内存，但不是每次检查冲突时，只有在创建新组件时。组件在我的环境中不是恒定的，因为它们在船被摧毁时被删除。

这是我的主要困境。我也很感激任何关于我的实际碰撞检测系统设计的指针。这是我第一次破解它（也许应该读一下）

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T07:57:44.067

您绝对应该尽量避免在每次调用 getter 函数时为您的组件向量分配内存。相反，尽可能少地进行分配。例如，您可以在船舶的组件组成发生变化时执行此操作，或者更不用说（通过过度分配）。

当然，您也可以研究内存池，在内存池中预先分配大量此类组件并放入一个池中，这样您就可以在恒定时间内分配一个新组件。

作为进行这种碰撞检测时的一般（如果太明显，请道歉）点：对距离进行平方，而不是计算平方根。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-03T01:17:54.233

如果您的 2D 矢量只是：

```
 class Vector2D { double x, y; }; 
```

然后一定要退货！例如：

```
 Vector2D function( ... ); 
```

或通过引用传递：

```
 void function( Vector2D * theReturnedVector2D, ... ); 
```

**不惜一切代价避免：**

```
 vector<double> function(...); 
```

Vector 类固有的常量堆分配/释放是一个错误！

* * *

从计算上讲，复制您自己的 Vector2D 类非常便宜。与 Vector<> 不同，您自己的 Vector2D 类可以包含您喜欢的任何方法。

我过去曾使用此功能来合并诸如 distanceToOtherPointSquared()、scanfFromCommandLineArguments()、printfNicelyFormatted() 和 operator[](int) 等方法。

* * *

***或者我应该给那个组件对象一个额外的私有二维向量变量，在调用函数时编辑私有变量，然后返回一个指向该对象的指针？***

注意使先前数据无效的多个函数调用。这是灾难的秘诀！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T08:02:11.390

1.  您可以从返回一个向量开始，然后对其进行基准测试。谁知道，它可能已经足够快了。使用分析器，您甚至可以查看哪些部分占用了运行时间。
2.  您可以使用[内存池](http://en.wikipedia.org/wiki/Memory_pool)来重用向量并减少复制
3.  如果它们在整个引擎中重复，您可以尝试使用[享元模式的坐标来减少复制和分配。](http://en.wikipedia.org/wiki/Flyweight_pattern)
4.  将数据保留在组件中是减少分配的好方法，但会在您的设计中引入一些陷阱，例如使用向量的人取决于组件的生命周期。内存池可能更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T08:24:56.180

不要使用 2D 矢量。而是使用 a `vector`of `point`s。同样适用于您的碰撞检测。在这里使用二维向量只是错误的数据结构。

根据函数的内容，编译器将能够执行 NRVO（即[命名返回值优化](http://blogs.msdn.com/slippman/archive/2004/02/03/66739.aspx)），这意味着在最佳情况下，返回向量*没有*开销，即它永远不会被复制。但是，这只发生在您使用函数的返回值初始化新实例时，并且当编译器能够跟踪函数内部的执行路径并看到对于每个返回路径，返回相同的对象时。考虑以下两个：

```
vector<int> f(int baz) {
    vector<int> ret;
    if (baz == 42)
        ret.push_back(42);
    return ret;
}

vector<int> g(int baz) {
    if (baz == 42)
        return vector<int>(1, 42);
    else
        return vector<int>();
} 
```

编译器可以对 的调用执行 NRVO `f`，但不能对`g`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-03T03:20:38.523

在堆上分配内存和在栈上分配内存有很大的不同。在堆上分配，例如，使用 new/delete 或 malloc/free 非常慢。在堆栈上分配确实非常快。使用堆栈，通常较慢的部分是复制您的对象。所以要注意向量等，但返回简单的结构可能是可以的。

# c# - HttpModule - 获取 HTML 内容或修改控件

> ID：333287
> 
> 赞同：3
> 
> 时间：2008-12-02T07:54:56.693
> 
> 标签：c#, httpmodule, .net-1.1

尝试过这样的事情：

```
HttpApplication app = s as HttpApplication; //s is sender of the OnBeginRequest event
System.Web.UI.Page p = (System.Web.UI.Page)app.Context.Handler;
System.Web.UI.WebControls.Label lbl = new System.Web.UI.WebControls.Label();
lbl.Text = "TEST TEST TEST";
p.Controls.Add(lbl); 
```

运行此程序时，我得到“对象引用未设置为对象的实例。” 最后一行...

如何在原始文件的特定位置插入两行文本（asp.net/html）？以及如何确定文件的扩展名（我只想将其应用于 aspx 文件......？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-06-04T14:31:55.027

它比你想象的要简单：

```
 public void Init(HttpApplication app)
    {
        app.PreRequestHandlerExecute += OnPreRequestHandlerExecute;
    }

    private void OnPreRequestHandlerExecute(object sender, EventArgs args)
    {
        HttpApplication app = sender as HttpApplication;
        if (app != null)
        {
            Page page = app.Context.Handler as Page;
            if (page != null)
            {
                page.PreRender += OnPreRender;
            }
        }
    }

    private void OnPreRender(object sender, EventArgs args)
    {
        Page page = sender as Page;
        if (page != null)
        {
            page.Controls.Clear(); // Or do whatever u want with ur page...
        }
    } 
```

如果 PreRender 事件不够，您可以在 PreRequestHandlerExecute EventHandler 中添加您需要的任何事件...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T08:37:07.403

我不确定，但我认为您不能使用 HttpModule 来更改页面的控制树（如果我错了，请纠正我）。您可以修改 HTML 标记，但是，您必须为此编写一个“响应过滤器”。例如，请参阅[http://aspnetresources.com/articles/HttpFilters.aspx](http://aspnetresources.com/articles/HttpFilters.aspx)或 google 中的“httpmodule 响应过滤器”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-03T07:34:28.230

似乎 HttpFilter 解决方案在这里起到了作用:o)

如果我使用过 MOSS/.net 2.x+，我可以使用 Runes 版本或者只是在母版页中添加我的标签......

超级建议，在我测试解决方案后，我会接受 miies.myopenid.com 的解决方案，因为它似乎解决了实际问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T09:21:59.903

与 IIS6 或 5 相比，您在 IIS7 中编写 HttpModules 的方式发生了一些变化，因此如果您使用的是 IIS7，我的建议可能无效。

如果您使用 HttpContext 的 Current 静态属性，您可以获得对当前上下文的引用。HttpContext 类具有请求（HttpRequest 类型）和响应（HttpResponse）的属性，并且根据您正在处理的事件（可能是 Application.EndRequest？），您可以对这些对象执行各种操作。

如果您想更改正在交付的页面的内容，您可能希望尽可能晚地执行此操作，因此响应 EndRequest 事件可能是执行此操作的最佳位置。

检查请求的文件类型可以通过检查 Request.Url 属性来完成，可能与 System.IO.Path 类一起检查。尝试这样的事情：

```
string requestPath = HttpContext.Current.Request.Url.AbsolutePath;
string extension = System.IO.Path.GetExtension(requestPath);
bool isAspx = extension.Equals(".aspx"); 
```

修改内容更难。您也许可以在 Context 对象的事件之一中做到这一点，但我不确定。

一种可能的方法是编写您自己的自定义页面派生类，该类将检查 Context.Items 集合中的值。如果找到此值，您可以将标签添加到 PlaceHolder 对象并将标签的文本设置为您想要的任何内容。

**像这样的东西应该工作：**

将以下代码添加到 HttpModule 派生类：

```
public void Init(HttpApplication context)
{
  context.BeginRequest += new EventHandler(BeginRequest);
}

void BeginRequest(object sender, EventArgs e)
{

  HttpContext context = HttpContext.Current;
  HttpRequest request = context.Request;

  string requestPath = HttpContext.Current.Request.Url.AbsolutePath;
  string extension = System.IO.Path.GetExtension(requestPath);
  bool isAspx = extension.Equals(".aspx");

  if (isAspx)
  {
    // Add whatever you need of custom logic for adding the content here
    context.Items["custom"] = "anything here";
  }

} 
```

然后将以下类添加到 App_Code 文件夹：

```
public class CustomPage : System.Web.UI.Page
{
  public CustomPage()
  { }

  protected override void OnPreRender(EventArgs e)
  {
    base.OnPreRender(e);

    if (Context.Items["custom"] == null)
    {
      return;
    }

    PlaceHolder placeHolder = this.FindControl("pp") as PlaceHolder;
    if (placeHolder == null)
    {
      return;
    }

    Label addedContent = new Label();
    addedContent.Text = Context.Items["custom"].ToString();
    placeHolder .Controls.Add(addedContent);

  }

} 
```

然后你像这样修改你的页面：

```
public partial class _Default : CustomPage 
```

请注意，继承从 System.Web.UI.Page 更改为 CustomPage。

最后，您将 PlaceHolder 对象添加到您想要自定义内容的任何位置的 aspx 文件中。

# flv - 可以将 XSPF 用于视频内容吗？

> ID：333288
> 
> 赞同：0
> 
> 时间：2008-12-02T07:57:04.613
> 
> 标签：flv, flvplayback, xspf

可以将 XSPF 用于视频内容吗？

如果没有，还应该使用什么？

我的目标是 Flash 播放器，包括 Jeroen Wijering 的 JW FLV 媒体播放器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T10:09:47.780

您可以直接在 FLV 中进行流式传输，我相信这是最理想的解决方案。

查看[FFmpeg的 FLV 功能（包括流式传输）](http://ffmpeg.mplayerhq.hu/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T14:46:50.480

是的，XSPF 适用于“视频播放列表”。

让我邀请您加入 XSPF 邮件列表： http:
[//lists.musicbrainz.org/mailman/listinfo/playlist](http://lists.musicbrainz.org/mailman/listinfo/playlist)

再见，

塞巴斯蒂安

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-11-13T12:45:15.910

当然可以... [http://feedpixel.com](http://feedpixel.com) 在播放前将播客 RSS 提要转换为 xspf 格式...

# programming-languages - 有什么理由不使用“this”（“Self”，“Me”，...）？

> ID：333291
> 
> 赞同：10
> 
> 时间：2008-12-02T08:01:21.110
> 
> 标签：programming-languages, multiple-languages

我阅读[了这个答案](https://stackoverflow.com/questions/218123/what-was-the-strangest-coding-standard-rule-that-you-were-forced-to-follow#220591)及其评论，我很好奇：有什么理由不使用`this`/ `Self`/`Me`吗？

BTW：很抱歉，如果之前有人问过这个问题，似乎无法`this`在 SO 上搜索这个词。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-02T08:08:23.327

警告：以下纯属主观答案。

我认为不使用 this/self/me 的最佳“理由”是简洁。如果它已经是成员变量/函数，那么为什么要冗余添加前缀？

我个人避免使用 this/self/me 除非有必要为编译器消除特定表达式的歧义。很多人不同意这一点，但在我工作过的任何团队中，我从来没有认为它是一个真正的症结所在。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-02T08:09:22.607

我认为已经引用的两篇文章已经涵盖了大多数常见场景；主要是简洁和冗余与清晰 - 一个小补充：在 C# 中，需要使用“this”才能访问当前类型的“扩展方法” - 即

```
this.Foo(); 
```

where 在`Foo()`外部声明为：

```
public static void Foo(this SomeType obj) {...} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-02T08:23:19.757

它在某些情况下进行了澄清，例如 c# 中的这个示例：

```
public class SomeClass
{
    private string stringvar = "";

    public SomeClass(string stringvar)
    {
        this.stringvar = stringvar;
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-02T09:54:27.327

如果您使用带有所有规则的 StyleCop，它会让您`this.`加入。自从我开始使用它以来，我发现我的代码更具可读性，但这是个人喜好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-02T08:24:30.440

我认为这不是问题，因为它只会增加代码的可读性，这是一件好事。

对于某些语言，例如 PHP，如果您需要使用类字段或方法，甚至必须使用 $this-> 作为前缀。

我不喜欢这样一个事实，即如果 PHP 有某种方法可以在没有它的情况下引用类成员，它会使某些行不必要地长于它们可能的长度。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-02T08:26:25.537

我个人觉得这`this.whatever`不太可读。您可能不会注意到 2 行方法的区别，但请等到您在课堂上的任何地方`this.variable`。`this.othervariable`

此外，我认为使用 of`this.`可以替代部分令人讨厌的匈牙利符号。有些人发现，读者更清楚地看到变量是类成员，并且`this.`成功了。但是，如果我们需要额外的清晰度，为什么要自欺欺人而不使用普通的旧的`"m_"`或简单的呢？`"_"`这是 5 个字符对 2 个（甚至 1 个）。更少的打字，相同的结果。

话虽如此，风格的选择仍然是个人喜好的问题。很难说服曾经以某种对更改代码有用的方式阅读代码的人。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-02T08:27:12.417

好吧，eclipse用不同的颜色为字段、参数和局部变量着色，所以至少在eclipse环境中工作，不需要在语法上区分字段，以便专门将它们标记为你自己和后代的“字段”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-02T08:05:46.093

在“java中的变量”上下文中确实有人问过：

[你在java中用'this'作为你的实例变量的前缀吗？](https://stackoverflow.com/questions/132777)

主要原因似乎是：

> “它增加了你需要筛选以找到代码含义的视觉噪音。”

可读性，换句话说......我不买，我觉得`this.`非常有用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-02T08:07:04.500

这对我来说听起来像是胡说八道。使用“this”可以使代码更好，我看不出有什么问题。像这样的政策是愚蠢的（至少当你甚至不告诉人们为什么要实施这些政策时）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-02T08:13:47.560

至于我，我`this`用来调用实例化对象的方法，而`self`用于静态方法

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-02T08:25:28.223

归根结底，这始终是个人选择的问题。就个人而言，我使用这种编码约定：

```
public class Foo
{
  public string Bar
  {
    get
    {
      return this.bar;
    }
    /*set
    {
      this.bar = value;
    }*/
  }
  private readonly string bar;

  public Foo(string bar)
  {
    this.bar = bar;
  }
} 
```

所以对我来说，“this”实际上是保持构造函数可读的必要条件。

编辑：在我编写上面的代码时，“sinje”发布了完全相同的示例。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-02T08:38:17.527

'这。' in code 总是向我暗示编码器使用了智能感知（或其他 IDE 等效项）来完成繁重的工作。

我当然对此感到内疚，但是出于纯粹的虚荣原因，我会在之后删除它们。

我使用它们的唯一其他原因是限定不明确的变量（不好的做法）或构建扩展方法

限定变量

```
string name; //should use something like _name or m_name

public void SetName(string name)
{
     this.name = name;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-02T09:19:23.497

在 VB.NET 中，我使用的一种常见做法是以下代码：

```
Class Test
    Private IntVar AS Integer
    Public Function New(intVar As Integer)
       Me.Intvar = intvar
    End Function    
End Class 
```

并非一直如此，但主要是 Me / this / self 非常有用。阐明您正在谈论的范围。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-02T10:19:39.677

在典型的 setter 方法中（取自 lagerdalek 的回答）：

```
string name;

public void SetName(string name)
{
     this.name = name;
} 
```

如果你不使用它，编译器就不会知道你指的是成员变量。
的用途**`this.`**是告诉编译器您需要访问一个成员变量——它超出了方法的直接范围。在方法中创建与成员变量同名的变量是完全合法的，就像在扩展了另一个类的类中重写方法是完全合法的一样。
但是，如果您仍然需要使用超类的方法，请使用**`super.`**在我看来使用 this。并不比使用超级差。并允许程序员在其代码中具有更大的灵活性。

就我而言，可读性甚至不涉及它，这完全与变量的可访问性有关。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-02T11:28:57.463

我不仅经常使用“this”。我有时用“那个”。

```
class Foo
{
    private string bar;

    public int Compare(Foo that)
    {
        if(this.bar == that.bar)
        {
            ... 
```

等等。我的代码中的“那个”通常意味着同一类的另一个实例。

# arrays - 你如何链接两个数组？

> ID：333294
> 
> 赞同：1
> 
> 时间：2008-12-02T08:03:12.353
> 
> 标签：arrays, linker, pseudocode, multidimensional-array

我在一个基本的编程课上，一切都是用伪代码完成的。

我的问题是：如何链接两个数组？

我有一个列出学生姓名的一维数组，我有一个列出每个学生的前八名分数的二维数组……这一切都很好，但现在我需要按学生对数组进行排序姓名。我在网上闲逛并通读了书籍章节两次，它只简要提到了链接两个数组，但没有显示示例。

如果有任何帮助，我们正在使用冒泡排序，这是我相当熟悉的......我可以对名称进行排序，这很容易，但我不知道如何对成绩进行排序，所以他们不会出故障。

感谢您的输入！

旁注：我明白了！我最终按照 Greg Hewgill 提到的方式做了。当我对他的建议发表评论时，我开始随机输入代码行，直到我想到这个想法......它看起来并不漂亮（一个模块交换了名称，另一个交换了成绩，甚至还有第三个在多维数组中交换个别学生的成绩），但它确实似乎工作......没有办法用一种语言测试它，因为我没有编译器，也没有足够的知识将伪代码变成实际代码，如果我要下载一个，但在我打出来的纸上听起来真的很棒！

正如我在笔记中提到的，我非常感谢大家的快速和有益的洞察力，我什至没想到今晚我会得到回复，再次感谢大家的帮助！

杰弗里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T08:40:38.643

像这样定义一个简单的 Student 类：

```
public class Student : IComparable<Student>
{
    public string Name { get; set; }
    public int[] Scores { get; set; }

    #region IComparable<Student> Members

    public int CompareTo(Student other)
    {
        // Assume Name cannot be null
        return this.Name.CompareTo(other.Name);
    }

    #endregion
} 
```

然后更简单

```
 var students = new[] {
        new Student(){ Name = "B", Scores = new [] { 1,2,3 } },
        new Student(){ Name = "C", Scores = new [] { 3,4,5 } },
        new Student(){ Name = "A", Scores = new [] { 5,6,7 } }
    };

    Array.Sort(students); 
```

将为您完成工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T08:12:39.077

您可能想要做的是：当您对名称进行排序并且必须交换两个位置时，请在分数数组中进行*相同*的交换。这样，您对名称数组所做的所有更改都将反映在分数数组中。完成后，分数将按照与名称相同的排序顺序。

正如其他评论将显示的那样，有更有效的方法可以使用不同的数据结构来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T08:08:15.513

你的前提是错误的。首先，您不应该有两个数组。

您应该有一个*对象*数组，每个对象都包含一个学生的姓名和他的分数：

```
public class Record
{
    public string Student;
    public int[] Scores;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T08:18:06.397

两种方法：首先，在对名称进行排序时，每次交换两个名称时，交换相同位置的分数的行（或列或任何您想称呼的名称）。最后，分数仍应与名称保持同步。

其次，不是对名称进行排序，而是创建第三个数组，该数组将包含其他两个数组中的任何一个的索引，最初为 0 到 n-1，但随后排序，比较 name[a] 和 name[b]，而不是排序名称数组本身。

# tabs - 制表符间隔数据到填充列

> ID：333315
> 
> 赞同：3
> 
> 时间：2008-12-02T08:12:27.640
> 
> 标签：tabs, alignment, spaces

寻找一个列格式化脚本，我觉得这可能是一个单行 awk。理想情况下，我只需要一个小的 shell 脚本。

数据是制表符分隔的，每行中的每个单元格的长度都是可变的，当然，其中可能有空格。

所以我们有这样的东西

```
dasj dhsahdwe dhasdhajks ewqhehwq dsajkdhas
e dward das dsaw 达斯 daswf
fjdk ewf jken dsajkw dskdw
hklt ewq vn1 daskcn daskw

```

最终应该是这样的：

```
dasj dhsahdwe dhasdhajks ewqhehwq dsajkdhas
e dward das dsaw 达斯 daswf     
fjdk ewf jken dsajkw dskdw     
hklt ewq vn1 daskcn daskw     

```

理想情况下，能够调整每个之间的硬间隔量。如果它在逐列的基础上查看会更好，因此前导的短单元格不会都获得相同的正确填充。

不理想：

```
1 dhsahdwe dhasdhajks ewqhehwq dsajkdhas
2 das dsaw 达斯 daswf     
3 ewf jken dsajkw dskdw     
4 ewq vn1 daskcn daskw     

```

理想的：

```
1 dhsahdwe dhasdhajks ewqhehwq dsajkdhas
2 das dsaw 达斯 daswf     
3 ewf jken dsajkw dskdw     
4 ewq vn1 daskcn daskw     

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T18:14:23.433

如果您使用的是 BSD 派生的操作系统（包括 Mac OS X），则 column(1) 及其 -t 选项可能会执行您想要的操作：

```
% column -t coltest                                                               
dasj  dhsahdwe  dhasdhajks  ewqhehwq  dsajkdhas
e     dward     das         dsaw      das        daswf
fjdk  ewf       jken        dsajkw    dskdw
hklt  ewq       vn1         daskcn    daskw 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T08:27:33.833

在未混淆的 Perl 中：

```
#!/usr/bin/perl -w

use strict;

my (@data, @length);
while (<>) {
    chomp;
    my @line = split(/\t/);
    foreach my $i (0 .. $#line) {
        my $n = length($line[$i]);
        $length[$i] = $n if (!defined($length[$i]) || $n > $length[$i]);
    }
    push(@data, [ @line ]);
}

$length[$#length] = 0; # no need to pad the last column
my $fmt = join("  ", map { "%-${_}s" } @length) . "\n";
foreach my $ref (@data) {
    printf $fmt, @$ref;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T08:39:05.387

干得好。用“gawk”测试。

```
BEGIN {
    FS = "\t";
    # max: Column width
    # fpl: Fields per line
    # data: Fields in every line
}
 { # Note the blank before this brace
    fpl[FNR] = NF;
    for (i=1; i<=NF; i++) {
        data[FNR, i] = $i;
        if (length($i) > max[i]) {
            max[i] = length($i);
        }
    }
}
END {
    for (l=1; l<=length(fpl); l++) {
        for (i=1; i<=fpl[l]; i++) {
            fmt = "%-" max[i] "s";
            if (i > 1) {
                printf " "; # This goes between columns
            }
            printf fmt, data[l, i];
        }
        printf "\n";
    }
} 
```

# java - 在 Java 中保存用户设置/数据库/缓存...（在每个操作系统上）

> ID：333317
> 
> 赞同：7
> 
> 时间：2008-12-02T08:12:54.723
> 
> 标签：java, operating-system, settings, configuration-files

我的 Java 应用程序正在“user.home”中保存内容，但在 Windows 上，这似乎不是保存应用程序信息的正确路径（正如一位朋友告诉我的那样）。另一个选项是使用首选项 api，但无法使用首选项 api 设置 hsqldb 位置。另外，我希望所有文件都在同一个文件夹中可用（本地数据库、配置、缓存......）。

我正在寻找一些示例代码或处理特定于操作系统的东西的框架。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T09:54:17.887

在我的 WinXP Pro SP3 系统上，user.home 指向`C:\Documents and settings\<username>` 很多应用程序只是将它们的数据存储在那里（而不是这个路径 + 应用程序数据，但其他一些会到那里），创建一个 Unix 风格的目录，即。点 + 应用程序名称（例如：.antexplorer、.sqlworkbench、.squirrel-sql、.SunDownloadManager、.p4qt、.gimp-2.4 等）。

看起来像一个体面的，常见的做法......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T08:48:13.200

窗口应用程序将数据保存在 user.home 中是不寻常的，但并非“错误”。Windows 应用程序喜欢将其数据分布在各处（注册表中的一些位置，应用程序的安装目录中的位置，Windows 目录中的位置，System32 中的位置，这里和那里的一些位置）。最后，这使得彻底备份或删除导致著名的“Windows rot”（即您必须每隔几个月重新安装）的东西变得不可能。

反正。如果您真的不想使用 user.home（我认为没有理由不这样做），请使用[Apache commons-lang 中的此类](http://commons.apache.org/lang/xref/org/apache/commons/lang/SystemUtils.html#1007)代码来确定您是否在 Windows 上运行。如果结果为真，弹出一个目录选择对话框，用户可以在其中指定他们想要保存数据的位置。

将此信息保存在 Preferences 中，并在下次启动您的应用程序时使用此路径。这样，用户可以指定他们想要数据的位置，而您只需在首选项中留下一点信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T09:00:51.210

对于应用程序“foo”，我会在 user.home 中创建一个名为“.foo”的目录。对于 Windows，它看起来会有些奇怪，但几乎没有人会查看该目录（无论如何它都充满了不起眼的目录），而在 Linux/Solaris/... 上，它会导致一个隐藏目录，不会弄乱用户的主目录视觉上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-26T18:07:39.283

动态读取（从您的代码）`APPDATA`环境变量的值，并将您的配置文件存储在`%APPDATA%\\.myapp\config`

==> 值取决于平台，不要使用任何硬编码路径，始终读取 env。变种。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T09:15:46.857

问题不是 Windows，而是标准的 java 设置。

长讨论 http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4787931>这里

我建议在命令行上的“-D MYLOC=%USERPROFILE%”属性上选择它。

请注意，如果用户进行了桌面登录，您只会获得“USERPROFILE”，如果用户使用 citrix 或类似或通过 ssh 远程登录，则不会设置此设置，此外，公司桌面会混淆此设置并可能设置它到无法使用的东西。

# ms-access - 访问 VBA：如何在表单中获取输入并在查询中使用它们

> ID：333318
> 
> 赞同：2
> 
> 时间：2008-12-02T08:13:32.117
> 
> 标签：ms-access, forms

你好

我有一个带有几个按钮的表单。每个按钮运行几行代码。代码中也有查询，例如“select * from table where number =6”

现在，如果我想在表格中输入数字作为输入，我该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T09:26:02.873

1.  在按钮附近添加一个未绑定的文本控件。
2.  更新您的按钮代码以生成查询字符串：

    "SELECT * FROM myTable WHERE myNumber =" & me.controls("myControlName").value

3.  您可能觉得需要确保“myControlName”控件只允许数字/不接受 null，或者在您的过程中处理所有情况

* * *

```
myQuery = "SELECT * FROM myTable"
If Isnull(me.controls("myControlName").value) then
Else
    If isnumeric(me.controls("myControlName").value) then 
        myQuery = myQuery & " WHERE myNumber =" & me.controls("myControlName").value     
    Else 
        msgBox me.controls("myControlName").value & " is not accepted" 
        Exit function 
    Endif
Endif 
```

# sharepoint - CAML 查询：如何从结果集中过滤文件夹？

> ID：333328
> 
> 赞同：21
> 
> 时间：2008-12-02T08:22:20.210
> 
> 标签：sharepoint, caml

我正在使用 caml 查询来选择用户修改或添加的所有文档。查询在指定网站集的所有子网站上递归运行。

现在的问题是我无法摆脱也是结果集一部分的文件夹。现在我正在从结果数据表中过滤它们。但我想知道：是否可以仅使用 caml 从结果集中过滤掉文件夹？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-09-03T14:54:16.153

这个 CAML 实际上可以解决问题：

```
<Where>
    <Eq>
        <FieldRef Name='FSObjType' />
        <Value Type='Integer'>0</Value>
    </Eq>
</Where> 
```

那不会给你任何文件夹。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-02T10:35:59.630

所以，我想通了 :) 您可以在 caml 查询中使用 FieldRef='ContentType' 并指定要从选择中选择或排除的内容类型的类型。

所以就我而言，我已将此条件添加到我的 caml 表达式中：

`<Neq><FieldRef Name='ContentType' /><Value Type='Text'>Folder</Value></Neq>`

注意：多语言设置存在问题。内容类型的名称可以不同，所以最好从资源中获取内容类型的名称

**更新：**

看来我的假设太快了。我需要根据文件夹内容类型过滤掉所有内容类型，因为在我们的项目中使用了这样的内容类型:(

我无法在 caml 中创建可行的查询，因此我将视图字段元素添加到我的查询中，该元素选择列表项的 ContentTypeId，并过滤掉基于文件夹内容类型的行。

执行此操作的代码微不足道，但让我感到困扰的是，纯 caml 无法完成如此简单的任务。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-04-22T14:42:10.717

如果您正在使用文件夹并且您正在使用 SPQuery 对象，您可能还希望使用 ViewAttributes 字段来允许递归项目检索。将该值设置为 Scope="Recursive" 将从子文件夹中检索项目，并且不会检索结果集中的文件夹对象。

```
myQuery.ViewAttributes = "Scope=\"Recursive\""; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-05-14T03:49:21.077

根据[CAML Designer](http://sharepoint.biwug.be/SitePages/Caml_Designer.aspx)的输出（由 Karine Bosch 和 Andy Van Steenbergen 创建并由 Belux 信息工作者用户组分发），正确的 CAML 语法是：

```
<Where>
  <Eq>
    <FieldRef Name='FSObjType' />
    <Value Type='Integer'>0</Value>
  </Eq>
</Where>
<QueryOptions>
  <ViewAttributes Scope='RecursiveAll' />
</QueryOptions> 
```

我在 PowerShell 中对此进行了测试并得到了预期的结果：

```
$qry = new-object Microsoft.SharePoint.SPQuery
$qry.Query = "<Where><Eq><FieldRef Name='FSObjType' /><Value Type='Integer'>0</Value></Eq></Where><QueryOptions><ViewAttributes Scope='RecursiveAll' /></QueryOptions>"

$items = $lib.GetItems($qry)
$items.Count 
```

如果您愿意，可以将 CAML 中的标记替换`<QueryOptions>`为 SPQuery 对象属性 ViewAttributes，即`$qry.ViewAttributes = “Scope=’RecursiveAll’"`.

测试时，请确保每次都重新实例化 SPQuery 对象，因为您不能简单地重新分配 Query 属性。执行查询后，将忽略分配给 Query 属性的任何新值。所以执行整个 PowerShell 片段。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-12-01T08:58:34.807

[戴夫 T. 的回答](https://stackoverflow.com/a/8606519/1500805)对我不起作用，但以此为灵感，这就是我想出的：

```
<Where>
  <BeginsWith><FieldRef Name="ContentTypeId" />
    <Value Type="ContentTypeId">0x0101</Value>
  </BeginsWith>
</Where> 
```

主要问题是我们只能**在站点级别知道 ContentTypeId**，因为当将内容类型添加到列表/库时，它会变成**列表内容类型**，并且其 ID 会附加另一个 GUID (0x010100 ...)。并且 CAML 中**没有 NotBeginsWith**条件，因此我们无法过滤掉文件夹，但我们只能包含**站点**内容类型 id 为**0x0101**的文档。

具有**FSObjType**字段的解决方案对我不起作用，因为我的库中的文件远多于阈值，因此必须对查询中的所有字段进行索引，而我还没有找到索引该字段的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-29T21:43:03.823

这对我有用

```
 <Where>
      <Eq>
         <FieldRef Name='FSObjType' />
         <Value Type='Number'>1</Value>
      </Eq>
   </Where> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-22T16:04:12.977

检查我的其他答案[CAML 查询，其中包括结果集中的文件夹](https://stackoverflow.com/questions/1557675/caml-query-that-includes-folders-in-result-set/8567213#8567213)

简单地改变运营商可能会得到你所需要的

```
<Where>
  <NotIncludes>
    <FieldRef Name='ContentTypeId' />
    <Value Type='ContentTypeId'>0x0120</Value>
  </NotIncludes>
</Where> 
```

我不确定这是否可行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-09T08:59:05.097

对我来说，它的工作方式如下： -

```
<Where><Eq><FieldRef Name='FSObjType' /><Value Type='Integer'>1</Value></Eq></Where> 
```

# javascript - Firefox 处理 xxx.submit()，Safari 没有……能做什么？

> ID：333329
> 
> 赞同：1
> 
> 时间：2008-12-02T08:22:25.263
> 
> 标签：javascript, django, django-templates

当用户在菜单中的一个选项上选择（释放鼠标）时，我正在尝试使下拉菜单发布表单。此代码在 FF 中运行良好，但 Safari 出于某种原因不提交表单。我使用 jquery 重新编写了代码，以查看 jquery 的 .submit() 实现是否更好地处理了浏览器的怪癖。同样的结果，在 FF 中工作在 safari 中不起作用。

以下片段来自同一页面，其中混合了一些 django 模板语言。

这是香草js的尝试：

```
function formSubmit(lang) {
    if (lang != '{{ LANGUAGE_CODE }}') {
        document.getElementById("setlang_form").submit();
    }
} 
```

这是 jquery 的尝试：

```
$(document).ready(function() {
    $('#lang_submit').hide()
    $('#setlang_form option').mouseup(function () { 
        if ($(this).attr('value') != '{{ LANGUAGE_CODE }}') { 
            $('#setlang_form').submit()
        } 
    });
}); 
```

这是表格：

```
<form id="setlang_form" method="post" action="{% url django.views.i18n.set_language %}">
    <fieldset>
    <select name="language">
    {% for lang in interface_languages %}
        <option value="{{ lang.code }}" onmouseup="formSubmit('{{ lang.name }}')" {% ifequal lang.code LANGUAGE_CODE %}selected="selected"{% endifequal %}>{{ lang.name }}</option>
    {% endfor %}
    </select>
    </fieldset>
</form> 
```

我的问题是，我怎样才能让它在 Safari 中工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T08:25:32.747

您可能应该使用 the`onchange`事件来`<select>`代替（或同时使用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T08:29:38.247

代码将是：

```
<form id="setlang_form" method="post" action="{% url django.views.i18n.set_language %}">
    <fieldset>
    <select name="language" onchange="formSubmit(this)">
    {% for lang in interface_languages %}
        <option value="{{ lang.code }}" {% ifequal lang.code LANGUAGE_CODE %}selected="selected"{% endifequal %}>{{ lang.name }}</option>
    {% endfor %}
    </select>
    </fieldset>
</form> 
```

要获取值：

```
function formSubmit(theForm)
{
 .... theForm.options[theForm.selectedIndex].value
} 
```

你也可以用 jquery 来做：

```
$(document).ready(function() {
    $('#lang_submit').hide()
    $('#setlang_form select').change(function () { 
        ....     $("select option:selected").text() ....  
        } 
    });
}); 
```

看这里以了解使用 Jquery 的更改事件：http: [//docs.jquery.com/Events/change](http://docs.jquery.com/Events/change)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T03:05:21.270

xxx.submit() 似乎也从来没有为我工作过。简单但丑陋的解决方法是在页面的 HEAD 标记中而不是外部 JS 文件中执行提交的函数，并且使用 document.getElementById('whatever_the_id_of_the_form_is).submit 而不是定义 var 然后执行 var 。提交（）

不要问为什么。但这是我可以让 safari 使用 submit() 函数实际提交的唯一方法。

# asp.net - 在 ASP.NET 和 ASP.NET MVC 中使用 url 参数实现搜索页面

> ID：333340
> 
> 赞同：5
> 
> 时间：2008-12-02T08:26:11.747
> 
> 标签：asp.net, asp.net-mvc

假设我有一个名为 Search.aspx 的搜索页面，它采用搜索字符串作为 ala Google 的 url 参数（例如 Search.aspx?q=This+is+my+search+string）。

目前，我的页面上有一个 asp:TextBox 和一个 asp:Button。我正在处理按钮的 OnClick 事件并在代码隐藏文件中重定向到 Search.aspx?q=

当您没有用于重定向的代码隐藏时，如何使用 ASP.NET MVC？您会创建一个 GET 表单元素来代替将发布到 Search.aspx 吗？或者您会以其他方式处理重定向（例如，附加到按钮的 jQuery 事件）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T08:34:31.620

您需要了解 MVC 不会在其 URL 中直接引用 WebForms 之类的 .aspx 页面。它的主要目的是分离关注点，即模型（数据）、控制器（逻辑）和视图（表示）。

首先，您必须创建一个与您的 URL 匹配的路由，例如：/home/search/This+is+my+search+string

这将调用 Home 控制器的 Search 操作方法，该方法将“这是我的搜索字符串”作为输入参数。此操作负责访问模型并可能从数据库中提取结果。

通常，您的搜索操作将返回一个 ViewResult，其中包含放置在文件夹 /Views/Home/Search.aspx 中的视图。在这里，您既不能使用 Postback 功能，也不能像在 WebForms 中那样使用 Web 控件的事件，因为 MVC 应用程序是无状态的并且不是事件驱动的。它更像是一种请求/调度的做事方式。

[在此处阅读有关 MVC 的更多信息](http://www.asp.net/learn/mvc/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T15:25:12.323

使用表单创建一个名为 Search.ascx 的用户控件：

```
<% using (Html.BeginForm ("Search", "Home")) { %>
    <input name="search" type="text" size="16" id="search" />
    <input type="image" name="search-image" id="search-image" src="search.gif" />
<% } %> 
```

在您的搜索操作中，您只需要以下内容：

```
public class HomeController : Controller
{
    public ActionResult Search (string search)
    {
        throw new Exception (string.Format ("Search: {0}", search));
    }
} 
```

在您的母版页或您可以添加的任何地方

```
<% Html.RenderPartial ("Search"); %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T11:06:39.893

您可以在按钮的 onclick 中使用简单的 javascript 来重定向到搜索页面：

```
Search <input type="text" id="go" size="4" /><input type="button" value="<%=Html.Encode(">>") %>" onclick="javascript:window.location='<%=Url.Action("Search", "Home") %>/' + document.getElementById('go').getAttribute('value')" /> 
```

# java - 如何知道是Applet还是Application

> ID：333346
> 
> 赞同：1
> 
> 时间：2008-12-02T08:28:19.200
> 
> 标签：java, applet, java-native-interface

我在应用程序和小程序使用的类中包含此代码。

```
static
{
    if (System.getProperty("os.name").startsWith("Windows"))
    {
        System.loadLibrary("extmapi");
    }
} 
```

不幸的是，当小程序加载此代码时，我收到一个错误，因为它无法加载“extmapi”库。

为了避免这个错误，我需要知道我正在运行的代码是Applet还是应用程序，这样我才能做到：

```
if (isApplet)
    return;
else
    //load library 
```

我怎么知道我是否在 Applet 中运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T08:32:05.043

你不能抓住（安全？）异常吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T08:33:40.890

您的顶级容器将是 Applet 的一个实例。

```
if (thispanel instanceof Applet) 
```

# .net - 目录监视类 (.net)

> ID：333357
> 
> 赞同：0
> 
> 时间：2008-12-02T08:35:21.073
> 
> 标签：.net

我需要一个快速的是/否的答案...

是否可以让目录监视类监视目录及其子目录（一直向下），还是目录监视类仅监视父目录中的更改/事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T08:40:45.867

是的，有可能。属性 IncludeSubDirectories 允许您这样做。你是说 FileSystemWatcher 吗？

# sharepoint - 查询 infopath 表单库

> ID：333359
> 
> 赞同：1
> 
> 时间：2008-12-02T08:36:41.210
> 
> 标签：sharepoint, moss, infopath

是否有允许在 MOSS 中查询（和聚合数据）信息路径表单库的工具？我不能使用提升字段，因为我要查询的某些项目位于无法提升（AFAIK）的重复组中。所以我必须查询底层的 XML。

我意识到我可以编写自定义代码来遍历表单并在每个表单上执行 xpath 查询，我只是想知道是否有现有的工具或功能可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T08:43:10.637

您可以使用 lists.asmx Web 服务来检索 XML 并在报告服务甚至 Excel 中使用它。

查看在[SQL 报告服务中使用 XML 作为数据源](http://msdn.microsoft.com/en-us/library/aa964129.aspx)

如果您将列表导出到电子表格，您也应该能够像使用任何其他电子表格一样工作。这一切都取决于您想如何处理这些信息以及它最终将在哪里结束。

您还可以查看将数据绑定到登打[士图表 Web 部件](http://www.dundas.com/Products/Chart/SharePoint/index.aspx)

# java - 从 Java 包加载属性文件

> ID：333363
> 
> 赞同：116
> 
> 时间：2008-12-02T08:39:43.593
> 
> 标签：java, properties-file

我需要读取一个隐藏在我的包结构中的属性文件`com.al.common.email.templates`。

我已经尝试了一切，但我无法弄清楚。

最后，我的代码将在 servlet 容器中运行，但我不想依赖容器做任何事情。我编写 JUnit 测试用例，它需要在两者中都工作。

* * *

## 回答 #1

> 赞同：238
> 
> 时间：2008-12-02T08:52:20.853

从包中的类加载属性时，`com.al.common.email.templates`您可以使用

```
Properties prop = new Properties();
InputStream in = getClass().getResourceAsStream("foo.properties");
prop.load(in);
in.close(); 
```

（添加所有必要的异常处理）。

如果您的类不在该包中，则需要稍微不同地获取 InputStream：

```
InputStream in = 
 getClass().getResourceAsStream("/com/al/common/email/templates/foo.properties"); 
```

/ 中的相对路径（没有前导“/”的路径）`getResource()`意味着`getResourceAsStream()`将相对于表示类所在的包的目录搜索资源。

使用`java.lang.String.class.getResource("foo.txt")`将在类路径上搜索（不存在的）文件`/java/lang/String/foo.txt`。

使用绝对路径（以“/”开头的路径）意味着忽略当前包。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-07-03T03:19:25.283

要添加到 Joachim Sauer 的答案，如果您需要在静态上下文中执行此操作，您可以执行以下操作：

```
static {
  Properties prop = new Properties();
  InputStream in = CurrentClassName.class.getResourceAsStream("foo.properties");
  prop.load(in);
  in.close()
} 
```

（和以前一样，异常处理被忽略了。）

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-08-15T00:24:32.103

以下两种情况与从名为`TestLoadProperties`.

**案例 1：使用加载属性文件`ClassLoader`**

```
InputStream inputStream = TestLoadProperties.class.getClassLoader()
                          .getResourceAsStream("A.config");
properties.load(inputStream); 
```

在这种情况下，属性文件必须在`root/src`目录中才能成功加载。

**案例2：加载属性文件而不使用`ClassLoader`**

```
InputStream inputStream = getClass().getResourceAsStream("A.config");
properties.load(inputStream); 
```

在这种情况下，属性文件必须与`TestLoadProperties.class`成功加载的文件位于同一目录中。

**注意：** `TestLoadProperties.java`和`TestLoadProperties.class`是两个不同的文件。前者，`.java`文件，通常在项目的`src/`目录中，而后者，`.class`文件，通常在其`bin/`目录中。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-02-06T20:53:30.960

```
public class Test{  
  static {
    loadProperties();
}
   static Properties prop;
   private static void loadProperties() {
    prop = new Properties();
    InputStream in = Test.class
            .getResourceAsStream("test.properties");
    try {
        prop.load(in);
        in.close();
    } catch (IOException e) {
        e.printStackTrace();
    }

} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-05-01T05:53:29.340

```
public class ReadPropertyDemo {
    public static void main(String[] args) {
        Properties properties = new Properties();

        try {
            properties.load(new FileInputStream(
                    "com/technicalkeeda/demo/application.properties"));
            System.out.println("Domain :- " + properties.getProperty("domain"));
            System.out.println("Website Age :- "
                    + properties.getProperty("website_age"));
            System.out.println("Founder :- " + properties.getProperty("founder"));

            // Display all the values in the form of key value
            for (String key : properties.stringPropertyNames()) {
                String value = properties.getProperty(key);
                System.out.println("Key:- " + key + "Value:- " + value);
            }

        } catch (IOException e) {
            System.out.println("Exception Occurred" + e.getMessage());
        }

    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-02T08:54:21.223

假设您使用[Properties](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Properties.html)类，通过它的[load](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Properties.html#load(java.io.InputStream))方法，我猜您正在使用 ClassLoader [getResourceAsStream](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ClassLoader.html#getResourceAsStream(java.lang.String))来获取输入流。

你是怎么传入名字的，看来应该是这样的形式：`/com/al/common/email/templates/foo.properties`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-02T14:30:58.810

我设法通过这个电话解决了这个问题

```
Properties props = PropertiesUtil.loadProperties("whatever.properties"); 
```

另外，您必须将whatever.properties 文件放在/src/main/resources

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-06-21T13:28:16.760

没有人提到与上面类似但甚至更简单的解决方案，而无需处理类的包。假设 myfile.properties 在类路径中。

```
 Properties properties = new Properties();
        InputStream in = ClassLoader.getSystemResourceAsStream("myfile.properties");
        properties.load(in);
        in.close(); 
```

享受

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2014-02-03T17:49:53.547

请使用以下代码：

```
    属性 p = new Properties();
    StringBuffer path = new StringBuffer("com/al/common/email/templates/");
    path.append("foo.properties");
    InputStream fs = getClass().getClassLoader()
                                    .getResourceAsStream(path.toString());

`if(fs == null){
     System.err.println("Unable to load the properties file");
  }
else{
   try{
       p.load(fs);
     } 
catch (IOException e) {
        e.printStackTrace();
      }
   }` 

        c# - 在 C# 中，如何在不知道它的类型的情况下向下转换以前向上转换的对象？

ID：333364

赞同：1

时间：2008-12-02T08:39:51.580

标签：c#, .net, inheritance, casting

我有一个接口方法

```
 public void Execute(ICommand command); 
```

它需要将已知的子类型传递`ICommand`给适当的`Handle(SpecificCommand command)`方法实现并对未知类型进行一些通用处理。我正在寻找一种通用（即不需要巨型开关）的方法，类似于

```
 Handle(command as command.GetType()); // this obviously does not compile 
```

我知道我可以以某种方式注册处理程序，例如将它们作为委托存储在字典中，但这仍然需要复制处理逻辑（一次在特定`Handle(...)`方法签名中，一次在委托请求中）。如果我通过用反射检查我的类（寻找`Handle(XXX command)`方法）来填充字典，我会受到性能影响。

总结一下：我怎样才能向下转换一个对象（通过调用向上转换`Execute(ICommand command)`）来调用一个需要具体类型的方法，而不知道它在编译时是哪种类型。

            回答 #1

赞同：9

时间：2008-12-02T08:46:44.793

好吧，“正确”的答案是 Handle() 应该是 ICommand 中的一个方法，因此`Handle(command)`您会说`command.Handle()`.

            回答 #2

赞同：5

时间：2008-12-02T09:04:13.167

转换是在编译时发出的，因此您需要在编译时知道类型。重载也是在编译时确定的——所以当你真正知道要使用的具体类型时，为时已晚。

我没有看到您实际上会通过使用委托来复制任何*逻辑。*或者，如果您使用反射进行此操作，则可以使用 Delegate.CreateDelegate 非常轻松地构建委托 - 您只会获得一次性能打击，之后它会非常快。有关更多信息，请参阅我[关于 Delegate.CreateDelegate 的博客条目](http://msmvps.com/blogs/jon_skeet/archive/2008/08/09/making-reflection-fly-and-exploring-delegates.aspx)。

我想我会根据我有多少方法以及它们更改的频率决定使用手工构建的字典或使用反射构建的字典。您可能会发现[KeyedByTypeCollection](http://msdn.microsoft.com/en-us/library/ms404549.aspx)对字典很有用。

            回答 #3

赞同：2

时间：2008-12-02T08:45:14.750

你不能，你为什么要这样做？

这就是我们拥有多态性的全部原因。如果您想拥有特定于某些类型的自定义行为，那么该行为应该存在于类型本身中，并通过在基类类型中声明的函数调用。

            回答 #4

赞同：1

时间：2008-12-02T15:29:12.267

我已经尝试过一种可以使用 Double Dispatch ( [http://en.wikipedia.org/wiki/Double_dispatch](http://en.wikipedia.org/wiki/Double_dispatch) ) 的方法，但似乎您遇到的情况是实现 ICommand 的类和实现 Execute( ) 可以在运行时变化（或者，至少在编译和运行时之间，这本质上是相同的），所以我能看到的唯一解决方案是使用 Jon Skeet 提出的字典。

        graphics - 学习 SVG 的书籍/教程

ID：333367

赞同：13

时间：2008-12-02T08:40:36.007

标签：graphics, svg

这里有人知道SVG吗？如果有，你是怎么学的？

任何书籍/教程指针都将是有益的。另外我是程序员，不是设计师，所以我也想在那里学习一些技能。

            回答 #1

赞同：10

时间：2008-12-02T10:00:59.497

您可能想尝试的一种方法是直接实验。[Inkscape](http://www.inkscape.org/)是一个开源 SVG 编辑器，可让您在以图形方式编辑的同时直接查看和操作 XML 树。因此，通过这种方式，您可以对事物进行试验，看看它们如何影响生成的 XML。

            回答 #2

赞同：7

时间：2008-12-11T08:22:48.223

我主要是通过阅读规范来学习开发[SVG Tiny软件的。](http://www.w3.org/TR/SVGMobile12/)SVG Tiny 基本上是完整 SVG 的一个子集，主要用于手机和其他“设备”。

添加到以前答案的链接，[KevLinDev](http://www.kevlindev.com/tutorials/basics/index.htm)有一堆适合初学者的教程。

编辑：删除了 Ikivo Animator 链接，因为它现在指向一个完全不同类型的网站。

            回答 #3

赞同：4

时间：2008-12-02T08:47:24.997

您可以查看[w3schools 上的 SVG 教程](http://www.w3schools.com/svg/default.asp)。他们在那里也有一个[SVG 参考](http://www.w3schools.com/svg/svg_reference.asp)。

另一个很好的来源是[SelfSVG](http://www.selfsvg.info/)，但它是德文的。

            回答 #4

赞同：1

时间：2009-01-13T18:14:56.617

我看过的关于 SVG 的最佳参考书是J. David Eisenberg 的[SVG Essentials](http://oreilly.com/catalog/9780596002237/)。我用那本书来学习 SVG。我还使用 Firefox 查看 SVG，并使用[Inkscape](http://www.inkscape.org/)创建它们。

            回答 #5

赞同：0

时间：2008-12-02T08:45:20.053

[http://en.wikibooks.org/wiki/SVG](http://en.wikibooks.org/wiki/SVG)可能会有所帮助。

            回答 #6

赞同：0

时间：2008-12-02T09:43:42.853

我通过规范了解到它：[Scalable Vector Graphics on W3C](http://www.w3.org/Graphics/SVG/ "可缩放矢量图形")。请参阅[SVG 1.1 规范](http://www.w3.org/TR/SVG11/ "SVG 1.1")。有点干，但这是真的。他们还提供了很多资源链接。

当然，我建议先阅读 XML 规范... :-) 一点 JavaScript 知识也有帮助。

            回答 #7

赞同：0

时间：2008-12-02T10:02:51.990

回答您的问题：是的，我确实知道 SVG - 或者至少是其中的一个子集。

我是如何学习的：我有一个特定的任务想要解决，而 SVG 似乎是最简单的课程。这是一个映射系统，所以我需要一小部分功能，然后将图像输出为 jpg。为此，我使用了 Batik，查看他们的示例，了解图像是如何在 XML 中构建的，这非常有用，并在论坛/邮件列表上提问。即使有时令人沮丧，犯错也是有帮助的。

            回答 #8

赞同：0

时间：2009-02-14T05:20:01.250

我发现[SVGbasics](http://www.svgbasics.com/index.html)是一个很好的起点。我支持 Rich 对[SVG Essentials](http://oreilly.com/catalog/9780596002237/)的选择。

对于最终细节，您希望[SVG 规范](http://www.w3.org/TR/SVG11/REC-SVG11-20030114.pdf)触手可及。随着规范的发展，这是一个相当乏味的阅读，但它也包含许多示例。

            回答 #9

赞同：0

时间：2010-03-06T21:31:02.503

您可以使用此实用程序练习 SVG 路径：
 [Spark Path Utility](http://flextip.blogspot.com/2010/03/spark-path-utility.html)

        sql - 有关学习如何在 SQL Server 2005 中解释 SQL 查询的执行计划的任何指南？

ID：333383

赞同：13

时间：2008-12-02T08:51:44.630

标签：sql, performance, sql-server-2005, sql-execution-plan

是否有任何关于解释 SQL Server 2005 中查询的执行计划的好文章、教程或类似参考资料？

            回答 #1

赞同：21

时间：2008-12-02T09:07:28.763

Red Gate 提供了一[本免费的电子书](http://downloads.red-gate.com/ebooks/HighPerformanceSQL_ebook.zip):)

        c - 关于“C”的 TAP 和 TDD 的信息

ID：333388

赞同：0

时间：2008-12-02T08:53:47.103

标签：c, unit-testing, tdd

我正在寻找类似的信息，

TAP 用于回归，TDD 用于单元测试......或者它们是互斥的（不需要同时使用它们）？

为 C 中的 TDD 建议“好”单元测试框架工作的奖金（期望也能解决好的方面:)）

最后用于测试 C 代码（不是从 xUnit 模式派生）的 cMockery（谷歌代码）可以用于 TDD 吗？如何 ？

**为清楚起见添加：** 
TAP 是测试任何协议，您可以在 CPAN（perl 存档）中找到文档。libtap 是 C 的 TAP。[http://www.onlamp.com/pub/a/onlamp/2006/01/19/libtap.html?page=1](http://www.onlamp.com/pub/a/onlamp/2006/01/19/libtap.html?page=1)很好地解释了 TAP

            回答 #1

赞同：1

时间：2008-12-02T09:29:10.293

对于 C 的单元测试框架，您可以参考这个[问题](https://stackoverflow.com/questions/177251/unit-testing-frameworks-for-c)。

回归和单元测试之间没有冲突，因为单元测试被用作检测不希望的变化的安全网。

您当然可以将 TAP 用于 TDD，没有禁忌症。如果您已经使用 Perl Test::More，那么共享相同的输出格式会很有帮助。

你为什么问 cMockery 是否可以用于 TDD ？你认为它不能吗？为什么 ？

**TDD 和单元测试框架只是手段，而不是目的。** 

            回答 #2

赞同：0

时间：2008-12-02T09:11:41.530

我猜你指的是这个[TAP](http://tap.ethz.ch/2007/index.html)：“测试和证明”。TAP 是一个人们讨论 TDD 和数学证明程序正确的方法的会议。所以这两者并没有真正的关系（编写软件的方式与可以讨论这个话题的论坛）。

TDD 用于单元测试和回归测试。有关详细信息，请参阅[此答案](https://stackoverflow.com/questions/2260/what-is-tdd)。

我没有为 C 使用过任何 TDD 框架，但是在谷歌上搜索“单元测试 c”会产生一些有趣的链接。

            回答 #3

赞同：0

时间：2009-02-12T21:56:32.887

我使用[CUnitWin32](http://code.google.com/p/cunitwin32/)作为我的测试框架。头版突出了积极因素

        c# - 如何检测我当前在哪个应用程序池下运行？(IIS6)

ID：333391

赞同：4

时间：2008-12-02T08:55:24.277

标签：c#, iis-6, application-pool

我需要知道如何检测我正在运行的当前应用程序池，以便以编程方式对其进行回收。

有谁知道如何为 IIS6 做到这一点？

我当前用于回收应用程序池的代码是：

```
 /// <summary>
    /// Recycle an application pool
    /// </summary>
    /// <param name="IIsApplicationPool"></param>
    public static void RecycleAppPool(string IIsApplicationPool) {
        ManagementScope scope = new ManagementScope(@"\\localhost\root\MicrosoftIISv2");
        scope.Connect();
        ManagementObject appPool = new ManagementObject(scope, new ManagementPath("IIsApplicationPool.Name='W3SVC/AppPools/" + IIsApplicationPool + "'"), null);

        appPool.InvokeMethod("Recycle", null, null);
    } 
```

            回答 #1

赞同：7

时间：2008-12-02T09:38:14.800

经过搜索，我自己找到了答案：

```
 public string GetAppPoolName() {

        string AppPath = Context.Request.ServerVariables["APPL_MD_PATH"];

        AppPath = AppPath.Replace("/LM/", "IIS://localhost/");
        DirectoryEntry root = new DirectoryEntry(AppPath);
        if ((root == null)) {
            return " no object got";
        }
        string AppPoolId = (string)root.Properties["AppPoolId"].Value;
        return AppPoolId;
    } 
```

唔。他们需要一种方法让我将自己的答案设置为答案。

            回答 #2

赞同：2

时间：2012-09-19T18:40:04.730

我也找到了这个，它对我有用。请注意，您可能需要包含对`using System.DirectoryServices`;的参考。

```
 private static string GetCurrentApplicationPoolId()
    {
        string virtualDirPath = AppDomain.CurrentDomain.FriendlyName;
        virtualDirPath = virtualDirPath.Substring(4);
        int index = virtualDirPath.Length + 1;
        index = virtualDirPath.LastIndexOf("-", index - 1, index - 1);
        index = virtualDirPath.LastIndexOf("-", index - 1, index - 1);
        virtualDirPath = "IIS://localhost/" + virtualDirPath.Remove(index);
        DirectoryEntry virtualDirEntry = new DirectoryEntry(virtualDirPath);
        return virtualDirEntry.Properties["AppPoolId"].Value.ToString();
    } 
```

        asp.net - 新 MVC 项目上的母版页错误

ID：333393

赞同：1

时间：2008-12-02T08:58:15.660

标签：asp.net, asp.net-mvc

我刚刚创建了一个新的 MVC 项目，并且根本没有进行任何更改，但是当我尝试在设计模式下查看 ChangePasswordSuccess 视图时，出现错误：

```
The page has controls that require a Master Page reference, but none is supplied. 
```

该页面除了内容控件和文字文本外没有其他控件，并且它确实具有母版页引用。有谁知道怎么回事？

```
<%@Language="C#" MasterPageFile="~/Views/Shared/Site.Master" AutoEventWireup="true" CodeBehind="ChangePasswordSuccess.aspx.cs" Inherits="BasicMvcApp.Views.Account.ChangePasswordSuccess" %>

<asp:Content ID="changePasswordSuccessContent" ContentPlaceHolderID="MainContent" runat="server">
    <h2>Change Password</h2>
    <p>
        Your password has been changed successfully.
    </p>
</asp:Content> 
```

            回答 #1

赞同：3

时间：2008-12-02T09:00:51.613

一问就注意到了。默认的 ChangePasswordSuccess 视图的 Page 指令缺少单词`Page`。

        soa - SOA 上的好资源？

ID：333394

赞同：12

时间：2008-12-02T08:58:33.383

标签：soa

最近有一个项目要完成，该项目非常广泛地使用 XML。我正在查看一个使用 SOA 的现有项目。我渴望加快 SOA 的速度，因此想知道是否有人可以推荐任何好的网站/书籍等。

我有一本 Thomas Erl 的书，名为面向服务的架构，我希望用其他资源来补充它。

干杯

            回答 #1

赞同：5

时间：2008-12-02T09:09:48.960

从不那么技术的角度来看，Sogeti 和 IBM 出版了一本名为[SOA For Profit](https://rads.stackoverflow.com/amzn/click/com/9075414145)的好书，它很好地涵盖了 SOA 流程 SOA 治理。这是一本有趣的短书，为您提供了另一种观点。然后，根据您选择的平台，每个供应商都会给您他们的观点，例如，如果您选择 Microsoft 技术，那么他们的[SOA 站点](http://www.microsoft.com/soa/)就是一个很好的资源。IBM 也有另一个[有趣的站点](http://www-01.ibm.com/software/solutions/soa/)。

            回答 #2

赞同：2

时间：2008-12-02T10:25:07.717

[Infoq](http://www.infoq.com/soa/)有很多 SOA 内容。

就像任何被中间件供应商劫持的东西一样，您会发现很多关于 SOA 的讨论与投资回报的现实评估相去甚远。保持批判的眼光。

            回答 #3

赞同：2

时间：2010-10-10T06:11:15.540

I know it is too late to answer. But still, I would recommend reading the following books to gain an in depth knowledge of SOA.
[SOA](http://www.soabooks.com/ctd/) by Thomas Erl actually clears confusion about how SOA is used as buzzword marketing agents. Also, He is founder of [SOA systems.](http://www.soasystems.com/) 

Also, [SOA Design patterns](http://www.soapatterns.com/) is a good book to read.

Specifically mentioned the SOA again. So that others could get a direct link to it. :)

Cheers  :)

            回答 #4

赞同：1

时间：2008-12-02T09:17:14.157

也许这些也可以帮助你：

[http://soa.sys-con.com/](http://soa.sys-con.com/)

[http://www-128.ibm.com/developerworks/webservices/newto/](http://www-128.ibm.com/developerworks/webservices/newto/)

            回答 #5

赞同：0

时间：2008-12-02T09:16:01.710

也许这些资源可以帮助你：

[http://soa.sys-con.com/](http://soa.sys-con.com/) 
[http://www-128.ibm.com/developerworks/webservices/newto/](http://www-128.ibm.com/developerworks/webservices/newto/)

            回答 #6

赞同：0

时间：2008-12-02T09:21:03.337

这个 http://service-architecture.blogspot.com/> 博客对在大型企业项目中实施 SOA 有一些明智的建议。

对技术细节不感兴趣，但对设计理念和如何成功实施很感兴趣。

            回答 #7

赞同：0

时间：2008-12-02T09:33:46.243

我推荐高可扩展性博客。这不仅仅是关于 SOA，而且任何大中型 SOA 解决方案都可以从那里表达的想法中受益：

[http://highscalability.com/](http://highscalability.com/)

            回答 #8

赞同：0

时间：2009-04-17T14:18:45.887

Springer Verlag 出版的题为 Enterprise Service Oriented Architectures 的书比 Thomas Erl 的书更详细，强烈推荐。

        c++ - 如何设计一个简单的 C++ 对象工厂？

ID：333400

赞同：13

时间：2008-12-02T09:02:24.107

标签：c++, factory

在我的应用程序中，有 10-20 个类被实例化一次 [*]。这是一个例子：

```
class SomeOtherManager;

class SomeManagerClass {
public:
    SomeManagerClass(SomeOtherManager*);
    virtual void someMethod1();
    virtual void someMethod2();
}; 
```

类的实例包含在一个对象中：

```
class TheManager {
public:
    virtual SomeManagerClass* someManagerClass() const;
    virtual SomeOtherManager* someOtherManager() const;
    /** More objects... up to 10-20 */
}; 
```

目前 TheManager 使用*new*操作符来创建对象。

我的意图是能够使用插件替换 SomeManagerClass （或任何其他类）实现与另一个。为了替换实现，需要两个步骤：

1.  定义一个类 DerivedSomeManagerClass，继承 SomeManagerClass [插件]
2.  创建新类 (DerivedSomeManagerClass) 而不是默认的 (SomeManagerClass) [应用程序]

我想我需要某种对象工厂，但它应该相当简单，因为总是只有一种类型要创建（默认实现或用户实现）。

关于如何设计一个像我刚才描述的简单工厂的任何想法？考虑到将来可能会有更多类的事实，所以它应该很容易扩展。

[*] 我不在乎它是否不止一次发生。

**编辑：**请注意，TheManager 中包含两个以上的对象。

            回答 #1

赞同：19

时间：2009-02-11T14:55:20.007

Assuming a class (plugin1) which inherits from SomeManagerClass, you need a class hierarchy to build your types:

```
class factory
{
public:
    virtual SomeManagerClass* create() = 0;
};

class plugin1_factory : public factory
{
public:
    SomeManagerClass* create() { return new plugin1(); }
}; 
```

Then you can assign those factories to a std::map, where they are bound to strings

```
std::map<string, factory*>  factory_map;
...
factory_map["plugin1"] = new plugin1_factory(); 
```

Finally your TheManager just needs to know the name of the plugin (as string) and can return an object of type SomeManagerClass with just one line of code:

```
SomeManagerClass* obj = factory_map[plugin_name]->create(); 
```

**EDIT**: If you don't like to have one plugin factory class for each plugin, you could modify the previous pattern with this: 

```
template <class plugin_type>
class plugin_factory : public factory
{
public:
   SomeManagerClass* create() { return new plugin_type(); }
};

factory_map["plugin1"] = new plugin_factory<plugin1>(); 
```

I think this is a much better solution. Moreover the 'plugin_factory' class could add itself to the 'factory_map' if you pass costructor the string.

            回答 #2

赞同：10

时间：2009-02-13T09:11:42.093

I think there are two separate problems here.

One problem is: how does TheManager *name* the class that it has to create? It must keep some kind of pointer to "a way to create the class". Possible solutions are:

*   keeping a separate pointer for each kind of class, with a way to set it, but you already said that you don't like this as it violates the DRY principle
*   keeping some sort of table where the key is an enum or a string; in this case the setter is a single function with parameters (of course if the key is an enum you can use a vector instead of a map)

The other problem is: what is this "way to create a class"? Unfortunately we can't store pointers to constructors directly, but we can:

*   create, as others have pointed out, a factory for each class
*   just add a static "create" function for each class; if they keep a consistent signature, you can just use their pointers to functions

Templates can help in avoiding unnecessary code duplication in both cases.

            回答 #3

赞同：3

时间：2009-02-10T22:26:49.587

I have answered in another SO question about C++ factories. Please see [there](https://stackoverflow.com/questions/410823/factory-method-implementation-c/534396#534396) if a flexible factory is of interest. I try to describe an old way from ET++ to use macros which has worked great for me.

[ET++](http://www.ubilab.org/publications/wei94.html) was a project to port old MacApp to C++ and X11\. In the effort of it Eric Gamma etc started to think about *Design Patterns*

            回答 #4

赞同：2

时间：2008-12-02T09:36:06.193

Here's the solution I thought of, it's not the best one but maybe it will help to think of better solutions:

For each class there would be a creator class:

```
class SomeManagerClassCreator {
public:
    virtual SomeManagerClass* create(SomeOtherManager* someOtherManager) { 
        return new SomeManagerClass(someOtherManager); 
    }
}; 
```

Then, the creators will be gathered in one class:

```
class SomeManagerClassCreator;
class SomeOtherManagerCreator;

class TheCreator {
public:
    void setSomeManagerClassCreator(SomeManagerClassCreator*);
    SomeManagerClassCreator* someManagerClassCreator() const;

    void setSomeOtherManagerCreator(SomeOtherManagerCreator*);
    SomeOtherManagerCreator* someOtherManagerCreator() const;
private:
    SomeManagerClassCreator* m_someManagerClassCreator;
    SomeOtherManagerCreator* m_someOtherManagerCreator;
}; 
```

And TheManager will be created with TheCreator for internal creation:

```
class TheManager {
public:
    TheManager(TheCreator*);
    /* Rest of code from above */
}; 
```

The problem with this solution is that it violates DRY - for each class creator I would have to write setter/getter in TheCreator.

            回答 #5

赞同：2

时间：2008-12-02T10:06:10.250

I'd create a "base" factory that has virtual methods for creation of all the basic managers, and let the "meta manager" (TheManager in your question) take a pointer to the base factory as a constructor parameter.

I'm assuming that the "factory" can customize the instances of CXYZWManager by deriving from them, but alternatively the constructor of CXYZWManager could take different arguments in the "custom" factory.

A lengthy code example that outputs "CSomeManager" and "CDerivedFromSomeManager":

```
#include <iostream>
//--------------------------------------------------------------------------------
class CSomeManager
  {
  public:
    virtual const char * ShoutOut() { return "CSomeManager";}
  };

//--------------------------------------------------------------------------------
class COtherManager
  {
  };

//--------------------------------------------------------------------------------
class TheManagerFactory
  {
  public:
    // Non-static, non-const to allow polymorphism-abuse
    virtual CSomeManager   *CreateSomeManager() { return new CSomeManager(); }
    virtual COtherManager  *CreateOtherManager() { return new COtherManager(); }
  };

//--------------------------------------------------------------------------------
class CDerivedFromSomeManager : public CSomeManager
  {
  public:
    virtual const char * ShoutOut() { return "CDerivedFromSomeManager";}
  };

//--------------------------------------------------------------------------------
class TheCustomManagerFactory : public TheManagerFactory
  {
  public:
    virtual CDerivedFromSomeManager        *CreateSomeManager() { return new CDerivedFromSomeManager(); }

  };

//--------------------------------------------------------------------------------
class CMetaManager
  {
  public:
    CMetaManager(TheManagerFactory *ip_factory)
      : mp_some_manager(ip_factory->CreateSomeManager()),
        mp_other_manager(ip_factory->CreateOtherManager())
      {}

    CSomeManager  *GetSomeManager()  { return mp_some_manager; }
    COtherManager *GetOtherManager() { return mp_other_manager; }

  private:
    CSomeManager  *mp_some_manager;
    COtherManager *mp_other_manager;
  };

//--------------------------------------------------------------------------------
int _tmain(int argc, _TCHAR* argv[])
  {
  TheManagerFactory standard_factory;
  TheCustomManagerFactory custom_factory;

  CMetaManager meta_manager_1(&standard_factory);
  CMetaManager meta_manager_2(&custom_factory);

  std::cout << meta_manager_1.GetSomeManager()->ShoutOut() << "\n";
  std::cout << meta_manager_2.GetSomeManager()->ShoutOut() << "\n";
  return 0;
  } 
```

            回答 #6

赞同：2

时间：2009-02-14T18:57:54.873

This seems like it would be a lot simpler with function templating as opposed to an Abstract Factory pattern

```
class ManagerFactory
{
public:
    template <typename T> static BaseManager * getManager() { return new T();}
};

BaseManager * manager1 = ManagerFactory::template getManager<DerivedManager1>(); 
```

If you want to get them via a string, you can create a standard map from strings to function pointers.  Here is an implementation that works:

```
#include <map>
#include <string>

class BaseManager
{
public:
    virtual void doSomething() = 0;
};

class DerivedManager1 : public BaseManager
{
public:
    virtual void doSomething() {};
};

class DerivedManager2 : public BaseManager
{
public:
    virtual void doSomething() {};
};

class ManagerFactory
{
public:
    typedef BaseManager * (*GetFunction)();
    typedef std::map<std::wstring, GetFunction> ManagerFunctionMap;
private:
    static ManagerFunctionMap _managers;

public:
    template <typename T> static BaseManager * getManager() { return new T();}
    template <typename T> static void registerManager(const std::wstring& name)
    {
        _managers[name] = ManagerFactory::template getManager<T>;
    }
    static BaseManager * getManagerByName(const std::wstring& name)
    {
        if(_managers.count(name))
        {
            return _managers[name]();
        }
        return NULL;
    }
};
// the static map needs to be initialized outside the class
ManagerFactory::ManagerFunctionMap ManagerFactory::_managers;

int _tmain(int argc, _TCHAR* argv[])
{
    // you can get with the templated function
    BaseManager * manager1 = ManagerFactory::template getManager<DerivedManager1>();
    manager1->doSomething();
    // or by registering with a string
    ManagerFactory::template registerManager<DerivedManager1>(L"Derived1");
    ManagerFactory::template registerManager<DerivedManager2>(L"Derived2");
    // and getting them
    BaseManager * manager2 = ManagerFactory::getManagerByName(L"Derived2");
    manager2->doSomething();
    BaseManager * manager3 = ManagerFactory::getManagerByName(L"Derived1");
    manager3->doSomething();
    return 0;
} 
```

**EDIT**:  In reading the other answers I realized that this is very similar to Dave Van den Eynde's FactorySystem solution, but I'm using a function template pointer instead of instantiating templated factory classes.  I think my solution is a little more lightweight.  Due to static functions, the only object that gets instantiated is the map itself. If you need the factory to perform other functions (DestroyManager, etc.), I think his solution is more extensible.

            回答 #7

赞同：1

时间：2008-12-02T09:23:12.100

You could implement an object factory with static methods that return an instance of a Manager-Class. In the factory you could create a method for the default type of manager and a method for any type of manager which you give an argument representing the type of the Manager-Class (say with an enum). This last method should return an Interface rather than a Class.

Edit: I'll try to give some code, but mind that my C++ times are quite a while back and I'm doing only Java and some scripting for the time being.

```
class Manager { // aka Interface
    public: virtual void someMethod() = 0;
};

class Manager1 : public Manager {
    void someMethod() { return null; }
};

class Manager2 : public Manager {
    void someMethod() { return null; }
};

enum ManagerTypes {
    Manager1, Manager2
};

class ManagerFactory {
    public static Manager* createManager(ManagerTypes type) {
        Manager* result = null;
        switch (type) {
        case Manager1:
             result = new Manager1();
             break;
        case Manager2:
             result = new Manager2();
             break;
        default:
             // Do whatever error logging you want
             break;
        }
        return result;
     }
 }; 
```

Now you should be able to call the Factory via (if you've been able to make the code sample work):

```
Manager* manager = ManagerFactory.createManager(ManagerTypes.Manager1); 
```

            回答 #8

赞同：1

时间：2008-12-02T11:24:48.297

I would use templates like this as I can't see the point of factories classes:

```
class SomeOtherManager;

class SomeManagerClass {
public:
    SomeManagerClass(SomeOtherManager*);
    virtual void someMethod1();
    virtual void someMethod2();
};

class TheBaseManager {
public:
      // 
};

template <class ManagerClassOne, class ManagerClassOther> 
class SpecialManager : public TheBaseManager {
    public:
        virtual ManagerClassOne* someManagerClass() const;
        virtual ManagerClassOther* someOtherManager() const;
};

TheBaseManager* ourManager = new SpecialManager<SomeManagerClass,SomeOtherManager>; 
```

            回答 #9

赞同：1

时间：2009-03-12T00:16:35.730

You should take a look at the tutorial at
[http://downloads.sourceforge.net/papafactory/PapaFactory20080622.pdf?use_mirror=fastbull](http://downloads.sourceforge.net/papafactory/PapaFactory20080622.pdf?use_mirror=fastbull)

It contains a great tutorial on implementing an Abstract factory in C++ and the source code that comes with it is also very robust

Chris

            回答 #10

赞同：0

时间：2008-12-02T09:38:26.767

Mh I don't understand a hundred percent, and I am not really into factory stuff from books and articles.

If all your managers share a similar interface you could derive from a base class, and use this base class in your program.
Depending on where the decision which class will be created will be made, you have to use an identifier for creation (as stated above) or handle the decision which manager to instantiate internally.

Another way would be to implement it "policy" like by using templates. So that You ManagerClass::create() returns a specific SomeOtherManagerWhatever instance. This would lay the decision which manager to make in the code which uses your Manager - Maye this is not intended.

Or that way:

```
template<class MemoryManagment>
class MyAwesomeClass
{
    MemoryManagment m_memoryManager;
}; 
```

(or something like that)
With this construct you can easily use other managers by only changing the instantiation of MyAwesomeClass.

Also A class for this purpose might be a little over the top. In your case a factory function would do I guess. Well it's more a question of personal preference.

            回答 #11

赞同：0

时间：2009-02-09T23:41:25.010

If you plan on supporting plugins that are dynamically linked, your program will need to provide a stable ABI (Application Binary Interface), that means that you cannot use C++ as your main interface as C++ has no standard ABI.

If you want plugins to implement an interface you define yourself, you will have to provide the header file of the interface to plugin programmer and standardize on a very simple C interface in order to create and delete the object.

You cannot provide a dynamic library that will allow you to "new" the plugin class as-is. That is why you need to standardize on a C interface in order to create the object. Using the C++ object is then possible as long as none of your arguments use possibly incompatible types, like STL containers. You will not be able to use a vector returned by another library, because you cannot ensure that their STL implementation is the same as yours.

Manager.h

```
class Manager
{
public:
  virtual void doSomething() = 0;
  virtual int doSomethingElse() = 0;
}

extern "C" {
Manager* newManager();
void deleteManager(Manager*);
} 
```

PluginManager.h

```
#include "Manager.h"

class PluginManager : public Manager
{
public:
  PluginManager();
  virtual ~PluginManager();

public:
  virtual void doSomething();
  virtual int doSomethingElse();
} 
```

PluginManager.cpp

```
#include "PluginManager.h"

Manager* newManager()
{
  return new PluginManager();
}
void deleteManager(Manager* pManager)
{
  delete pManager;
}

PluginManager::PluginManager()
{
  // ...
}

PluginManager::~PluginManager()
{
  // ...
}

void PluginManager::doSomething()
{
  // ...
}

int PluginManager::doSomethingElse()
{
  // ...
} 
```

            回答 #12

赞同：0

时间：2009-02-11T12:21:56.227

You didnt talk about TheManager. It looks like you want that to control which class is being used? or maybe you trying to chain them together?

It sounds like you need a abstract base class and a pointer to the currently used class. If you wish to chain you can do it in both abstract class and themanager class. If abstract class, add a member to the next class in chain, if themanager then sort it in order you which to use in a list. You'll need a way to add classes so you'll need an addMe() in themanager. It sounds like you know what your doing so w/e you choose should be right. A list with an addMe func is my recommendation and if you want only 1 active class then a function in TheManager deciding it would be good.

            回答 #13

赞同：0

时间：2009-02-13T14:11:25.383

This maybe heavier than you need, but it sounds like you are trying to make a frame work class that supports plugins.

I would break it up into to 3 sections.

1) The FrameWork class would own the plugins.
This class is responsable for publishing interfaces supplied by the plugins.

2) A PlugIn class would own the componets that do the work.
This class is responsable for registering the exported interfaces, and binding the imported interfaces to the components.

3) The third section, the componets are the suppliers and consumers of the interfaces.

To make things extensible, getting things up and running might be broke up into stages.

1.  Create everything.
2.  Wire everything up.
3.  Start everything.

To break things down.

1.  Stop everything.
2.  Destroy everything.

```
class IFrameWork {
public:
    virtual ~IFrameWork() {}
    virtual void RegisterInterface( const char*, void* ) = 0;
    virtual void* GetInterface( const char* name ) = 0;
};

class IPlugIn {
public:
    virtual ~IPlugIn() {}
    virtual void BindInterfaces( IFrameWork* frameWork ) {};
    virtual void Start() {};
    virtual void Stop() {};
};

struct SamplePlugin :public IPlugIn {
    ILogger* logger;

    Component1 component1;
    WebServer  webServer;

public:
    SamplePlugin( IFrameWork* frameWork ) 
        :logger( (ILogger*)frameWork->GetInterface( "ILogger" ) ),  //assumes the 'System' plugin exposes this
        component1(),
        webServer( component1 )
    {
        logger->Log( "MyPlugin Ctor()" );

        frameWork->RegisterInterface( "ICustomerManager", dynamic_cast( &component1 ) ); 
        frameWork->RegisterInterface( "IVendorManager", dynamic_cast( &component1 ) ); 
        frameWork->RegisterInterface( "IAccountingManager", dynamic_cast( &webServer ) ); 
    }

    virtual void BindInterfaces( IFrameWork* frameWork ) {
        logger->Log( "MyPlugin BindInterfaces()" );

        IProductManager* productManager( static_cast( frameWork->GetInterface( "IProductManager" ) ) );
        IShippingManager* shippingManager( static_cast( frameWork->GetInterface( "IShippingManager" ) ) );

        component1.BindInterfaces( logger, productManager );
        webServer.BindInterfaces( logger, productManager, shippingManager );
    }

    virtual void Start() {
        logger->Log( "MyPlugin Start()" );

        webServer.Start();
    }

    virtual void Stop() {
        logger->Log( "MyPlugin Stop()" );

        webServer.Stop();
    }
};

class FrameWork :public IFrameWork {
    vector plugIns;
    map interfaces;
public:
    virtual void RegisterInterface( const char* name, void* itfc ) {
        interfaces[ name ] = itfc;
    }
    virtual void* GetInterface( const char* name )  {
        return interfaces[ name ];
    }

    FrameWork() {
        //Only interfaces in 'SystemPlugin' can be used by all methods of the other plugins
        plugIns.push_back( new SystemPlugin( this ) );

        plugIns.push_back( new SamplePlugin( this ) ); 
        //add other plugIns here

        for_each( plugIns.begin(), plugIns.end(), bind2nd( mem_fun( &IPlugIn::BindInterfaces ), this ) );
        for_each( plugIns.begin(), plugIns.end(), mem_fun( &IPlugIn::Start ) );
    }

    ~FrameWork() {
        for_each( plugIns.rbegin(), plugIns.rend(), mem_fun( &IPlugIn::Stop ) );
        for_each( plugIns.rbegin(), plugIns.rend(), Delete() );
    }
};

```

            回答 #14

赞同：0

时间：2009-02-13T15:20:39.240

Here's a minimal factory pattern implementation that I came up with in about 15 minutes. We use a similar one that uses more advanced base classes.

```
#include "stdafx.h"
#include <map>
#include <string>

class BaseClass
{
public:
    virtual ~BaseClass() { }
    virtual void Test() = 0;
};

class DerivedClass1 : public BaseClass 
{ 
public:
    virtual void Test() { } // You can put a breakpoint here to test.
};

class DerivedClass2 : public BaseClass 
{ 
public:
    virtual void Test() { } // You can put a breakpoint here to test.
};

class IFactory
{
public:
    virtual BaseClass* CreateNew() const = 0;
};

template <typename T>
class Factory : public IFactory
{
public:
    T* CreateNew() const { return new T(); }
};

class FactorySystem
{
private:
    typedef std::map<std::wstring, IFactory*> FactoryMap;
    FactoryMap m_factories;

public:
    ~FactorySystem()
    {
        FactoryMap::const_iterator map_item = m_factories.begin();
        for (; map_item != m_factories.end(); ++map_item) delete map_item->second;
        m_factories.clear();
    }

    template <typename T>
    void AddFactory(const std::wstring& name)
    {
        delete m_factories[name]; // Delete previous one, if it exists.
        m_factories[name] = new Factory<T>();
    }

    BaseClass* CreateNew(const std::wstring& name) const
    {
        FactoryMap::const_iterator found = m_factories.find(name);
        if (found != m_factories.end())
            return found->second->CreateNew();
        else
            return NULL; // or throw an exception, depending on how you want to handle it.
    }
};

int _tmain(int argc, _TCHAR* argv[])
{
    FactorySystem system;
    system.AddFactory<DerivedClass1>(L"derived1");
    system.AddFactory<DerivedClass2>(L"derived2");

    BaseClass* b1 = system.CreateNew(L"derived1");
    b1->Test();
    delete b1;
    BaseClass* b2 = system.CreateNew(L"derived2");
    b2->Test();
    delete b2;

    return 0;
} 
```

Just copy & paste over an initial Win32 console app in VS2005/2008\. I like to point out something:

*   You don't need to create a concrete factory for every class. A template will do that for you.
*   I like to place the entire factory pattern in its own class, so that you don't need to worry about creating factory objects and deleting them. You simply register your classes, a factory class gets created by the compiler and a factory object gets created by the pattern. At the end of its lifetime, all factories are cleanly destroyed. I like this form of encapsulation, as there is no confusion over who governs the lifetime of the factories.

        singleton - Symbian S60 - 使用单个连接对话框的多个连接

ID：333405

赞同：1

时间：2008-12-02T09:04:17.363

标签：singleton, symbian, s60

我的应用程序最多需要 3 个同时下载连接。我目前正在使用 Carbide UI 框架中提供的（稍作改动的）CWebClient 类，但是为每个连接使用该类的多个实例会提示我使用多种类型来“选择接入点”

类中存在一个`RSocketServ`和一个`RConnection`对象，这些似乎是打开访问点的东西。制作这些静态对象（单例）是否是一个足够好的解决方案，以便只调用一次访问点？

任何人有任何经验/想法？

谢谢！

以防万一您想知道，我使用的是 S60 3rd ed。FP2 v1.1

            回答 #1

赞同：1

时间：2008-12-03T14:40:08.293

RConnection 应该是触发接入点选择对话框的类。

如果您编写自己的代码，则获取一个 RSocketServ 实例和 3 个 RSocket 实例。这应该足够了。接入点选择对话框只会在建立连接时出现，只会出现一次，直到您到达非覆盖区域或下载超时。

            回答 #2

赞同：0

时间：2008-12-02T19:57:46.577

另一种方法是禁止“选择接入点”对话框。您可以通过使用 CIntConnectionInitiator 建立连接来做到这一点。虽然没有记录这个类，但是[forum.nokia.com](http://forum.nokia.com)上有很多例子。

            回答 #3

赞同：0

时间：2008-12-09T09:06:14.343

滚动您自己的接入点 (AP) 选择器并存储 AP ID。然后使用 TCommDbConnPref 设置 AP ID 并抑制对话框。

        sql - 带有图像字段的图片项目的单独表格

ID：333419

赞同：3

时间：2008-12-02T09:12:41.823

标签：sql, sql-server, performance, database-design, scalability

我将不同的项目（笔记、文章、图片、文件）存储在一个表中（所有项目类型都有许多共同的元数据 - 例如，类别、标签、评级、统计信息等）。

我的第一个设计是这样的：表**Items**，加上每个项目类型（**NoteItems**、**ArticleItems**、**PictureItems**等）的另一个“详细”表。要检索单个项目，表必须一对一连接（SELECT * FROM Items INNER JOIN PictureItems ON Items.Id = PictureItems.Id WHERE Items.Id = N）。

我很确定这种“按部就班”的设计会很好地工作（多次这样做），但是，我开始怀疑这种设计是否是矫枉过正。拥有一个表（**Items**）会简单得多。

假设有大约 5% 的图片或文件类型的项目。

现在，问题是：如果我选择（几乎）单表设计，那么无论如何都有图像字段的详细表会更好（当然，对于图片和文件项）？

场景一：只有一张表：**Items**（用于存放笔记、文章、图片、文件...）

场景二：两张表：**Items**（用于存储笔记、文章、图片文件）、**ImageItems**（仅用于存储item类型图片、文件的图片字段）；一对一的关系

（场景 3 是场景 2 的一个小变体；有 3 个表（项目、图片项目、文件项目））

方案 1 的优点是：

*   更简单的选择查询（无连接）
*   **无事务更新**（INSERT/UPDATE 仅更新一张表）
*   无事务更新带来的性能、可扩展性？

方案 2 的优点是：

*   更清洁的设计
*   **较低的数据消耗**（在场景 1 中，除了图片或文件之外，大约 95% 的类型项在图像字段中具有 NULL 值，即浪费了大约 16 个字节用于指针）

您会选择哪种方案：1（无事务更新）或 2（更低的数据消耗）？感谢您的意见。

            回答 #1

赞同：2

时间：2008-12-02T13:58:45.990

如果程序员足够明智地只从表中查询所需的列而不是“SELECT *”，那么第一种设计方法看起来还可以。

需要为第二个设计处理索引、引用约束等。

            回答 #2

赞同：0

时间：2008-12-03T21:46:23.533

如果您使用某种 ORM 或自动生成 DAL（SubSonic？），第一种方法通常会受到惩罚。每次传递 DAL 对象（或集合）时，您都会检索 Image 列（及其数据），所以通常我将使用场景 2（或 3）

从 SQL 的角度来看，根据您的存储引擎（ISAM、InnoDB 等），两种场景的工作方式大致相同，但即便如此，场景之间的好处和差异也很小。

            回答 #3

赞同：0

时间：2009-02-05T21:39:33.603

如果你是对的，只有大约 5% 的行实际上有额外的图像/二进制数据，那么我肯定会说使用单表方法，并结合 Murthy 给出的提示 - 确保不要在这张表上执行 SELECT * ，但只请求您真正需要的那些列 - 尽可能多地省略 BLOB 列。

如果您的数据库增长，您可能还想为 BLOB 数据检查一个单独的文件组，以保持分离和清洁（但这实际上只有在您处理数十万行或更多行时，并且如果您可以拆分文件组到几个单独的磁盘上）。

KISS - 保持智能和简单 - 尽可能！:-)

马克

            回答 #4

赞同：0

时间：2008-12-02T11:07:45.820

如果数据库不需要知道这些项目中的内容（不会对它们进行索引或搜索），那么选项 1 似乎是最好的选择（假设您只有一个“项目”列作为 BLOB）-您可以阅读将项目作为二进制数据取出并自行处理 - 从而避免内部连接。

我不相信方案 2 会降低数据消耗 - 您可以只使用 BLOB 字段（无论如何，额外的 ImageItems 表的开销可能相当于每行 16 个字节）

所以我个人会选择选项 1，但当然这取决于您在项目从数据库中出来时如何处理它们。

        database - 关于数据库建模的问题

ID：333431

赞同：2

时间：2008-12-02T09:17:42.750

标签：database, database-design, entity-attribute-value

您将如何在数据库中建模这些关系？

您有一个可以包含 PageElements 的 Page 实体。

PageElement 例如可以是文章或图片。文章表显然具有除图片之外的其他成员/列。一篇文章可以有ie。“Title”、“Lead”、“Body”列都是 nvarchar 类型，而 Picture 可能有“AltText”、“Path”、“Width”、“Height”之类的内容。我喜欢它是可扩展的，谁知道我在 3 个月内可能需要什么 PageElements？所以我想我需要一个 PageElementTypes 表。

对于关系，像这样的表呢：

**带有 Id 的页面**，以及其他的胡言乱语。（创建日期，可见，什么不）

**Pages_PageElements**与 PageId 和 PageElementId。

**具有 Id 和PageElementTypeId**的 PageElements 以及更多的 mumbojumbo（SortOrder、Visibility 等）。

**具有 Id 和名称的PageElementTypes**（例如“文章”、“图片”、“地址块”）

现在，我应该在每个 Articles、Pictures、AddressBlocks 表中创建一个 PageElementId 列来完成吗？这就是我有点卡住的地方，这是一个简单的 1:1 关系，所以这应该可以工作，但不知何故我可能会错过一些东西。

*跟进：*

下面推荐的具有单独属性的解决方案将迫使我将所有属性存储为同一类型，或者不是？如果一个 PageElement 的属性是 nvarchar(255) 并且有些是 nvarchar(1000)，如果有些是整数怎么办？

如果我采用 EAV 方式，我将不得不创建大量表来保存所有不同数据类型的属性值。

            回答 #1

赞同：2

时间：2008-12-02T10:10:21.210

两个常见的选择是[Single Table Inheritance](http://martinfowler.com/eaaCatalog/singleTableInheritance.html)和[Multi Table Inheritance](http://martinfowler.com/eaaCatalog/classTableInheritance.html)。其他方法包括[为每个我从未使用过的具体类创建表](http://martinfowler.com/eaaCatalog/concreteTableInheritance.html)，以及我称之为元表实现的方法，其中属性定义被移动到数据中，而不是任何类型的模式中。

我在[STI](http://martinfowler.com/eaaCatalog/singleTableInheritance.html)方面总体上有很好的经验，如果您不期望有过多的类和属性，这是最简单的解决方案。简单在我的书中非常好。

除非用户需要在运行时创建新的页面元素类型，否则我会避免使用元表方法和任何看起来像它的东西。根据我的经验，与开发人员定期更新的更具体的实现相比，这样的代码很快就会变成一个泥潭，并且很少能提供太多价值。

            回答 #2

赞同：1

时间：2008-12-02T09:52:29.700

正如您已配置页面元素一样，您需要配置与页面元素关联的**属性。**

所以我们有两个项目是可扩展的页面元素及其属性。

我建议以下表格：

**页面**：页面 ID | ...

**页面元素**：页面元素 ID | 元素类型 ID | 页面编号 | ...

**页面元素类型**：元素类型 ID | 页面元素类型标签

**页面元素属性类型**：属性类型 ID | 元素类型 ID | 属性标签

**页面元素属性**：页面元素 ID | 属性类型 ID | 属性值

**页面元素属性类型**表将包含与元素关联的属性列表。例子 ：

*属性类型 ID 1 | 文章 | “标题”*

*属性类型 ID 2 | 文章 | “带领”*

*属性类型 ID 3 | 图片 | “替代文本”*

**页面元素属性**表将存储与页面元素关联的属性的实际值。例子 ：

*页面元素 ID 1 | 属性类型 ID 1 | “大家都爱雷蒙德”*

*页面元素 ID 2 | 属性类型 ID 3 | “世界地图”*

            回答 #3

赞同：0

时间：2008-12-02T09:24:40.130

通用的解决方案是：

```
PageElementType: ID, Name, [Mumbo Jumbo]
PageElementTypeParameter: ID, PageElementTypeID, [Mumbo Jumbo]
Page: ID, [Mumbo Jumbo]
PageElement: ID, PageElementTypeID, [Mumbo Jumbo]
PageElementParameters: ID, PageElementID, PageElementTypeParameterID, Value, [Mumbo Jumbo] 
```

用人类的话来说：有一个页面元素类型表和一个关联表，其中列出了每个页面元素的可能参数（例如图像的 SRC 和 ALT；文章的 TEXT 等）。

然后是一个包含所有页面的表格；列出每个页面中的元素的关联表；以及列出每个元素的参数值的表格。

            回答 #4

赞同：0

时间：2008-12-02T09:24:41.817

我使用与您不同的命名约定，但这基本上是我会做的：

PageElementType(PageElementTypeID, PageElementTypeName)

PageElement(PageElementID, PageElementTypeID)

文章（ArticleID，PageElementID，...）

图片(PictureID, PageElementID, ...)

页面（页面 ID，...）

PageHasPageElement(PageHasPageElementID, PageID, PageElementID) => {PageID, PageElementID} 是唯一的

这是我所做的，似乎已经很好地标准化并且表现良好。

            回答 #5

赞同：0

时间：2008-12-02T12:23:43.530

我想我会选择我所得到的，EAV 对我来说是没有选择的。我现在得到的是一种有点混合的方法。

        excel - 文件读/写锁

ID：333435

赞同：1

时间：2008-12-02T09:19:23.387

标签：excel, file

我有一个应用程序，可以在其中打开一个日志文件进行写入。在某个时间点（在应用程序运行时），我使用 Excel 2003 打开了该文件，它表示该文件应该以只读方式打开。我没关系。

但后来我的应用程序抛出了这个异常：

System.IO.IOException：该进程无法访问该文件，因为另一个进程已锁定该文件的一部分。

我不明白 Excel 如何锁定文件（*我的应用程序*对其具有写访问权限），并导致我的应用程序无法写入它！

为什么会这样？

（注意：我没有在 Excel 2007 中观察到这种行为。）

            回答 #1

赞同：1

时间：2008-12-02T10:28:59.300

这是一个记录同步锁的记录器。（您可以修改它以适应您的要求）

```
using System;
using System.Collections.Generic;
using System.Text;
using System.IO;

namespace Owf.Logger
{
    public class Logger
    {
        private static object syncContoller = string.Empty;
        private static Logger _logger;
        public static Logger Default
        {
            get
            {
                if (_logger == null)
                    _logger = new Logger();

                return _logger;
            }
        }

        private Dictionary<Guid, DateTime> _starts = new Dictionary<Guid, DateTime>();

        private string _fileName = "Log.txt";

        public string FileName
        {
            get { return _fileName; }
            set { _fileName = value; }
        }

        public Guid LogStart(string mesaage)
        {
            lock (syncContoller)
            {
                Guid id = Guid.NewGuid();

                _starts.Add(id, DateTime.Now);

                LogMessage(string.Format("0.00\tStart: {0}", mesaage));

                return id;
            }
        }

        public void LogEnd(Guid id, string mesaage)
        {
            lock (syncContoller)
            {
                if (_starts.ContainsKey(id))
                {
                    TimeSpan time = (TimeSpan)(DateTime.Now - _starts[id]);

                    LogMessage(string.Format("{1}\tEnd: {0}", mesaage, time.TotalMilliseconds.ToString()));
                }
                else
                    throw new ApplicationException("Logger.LogEnd: Key doesn't exisits.");
            }
        }

        public void LogMessage(string message)
        {
            lock (syncContoller)
            {
                string filePath = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);

                if (!filePath.EndsWith("\\"))
                    filePath += "\\owf";
                else
                    filePath += "owf";

                if (!Directory.Exists(filePath))
                    Directory.CreateDirectory(filePath);

                filePath += "\\Log.txt";

                lock (syncContoller)
                {
                    using (StreamWriter sw = new StreamWriter(filePath, true))
                    {
                        sw.WriteLine(DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss.sss") + "\t" + message);
                    }
                }
            }
        }
    }
} 
```

            回答 #2

赞同：0

时间：2008-12-02T09:52:35.723

你怎么写日志？有您自己的打开/关闭或使用大约三十个派对产品吗？

我认为只有在写入内容时才会打开和锁定日志。数据写入完成后，代码会关闭文件，当然也会释放锁

            回答 #3

赞同：0

时间：2009-12-12T06:58:56.697

这似乎是一个 .NET 问题。（好吧；如果你问我，这是一个错误）。

基本上我已经通过使用以下多线程代码复制了这个问题：

```
 Dim FS As System.IO.FileStream
  Dim BR As System.IO.BinaryReader

  Dim FileBuffer(-1) As Byte

  If System.IO.File.Exists(FileName) Then
   Try
    FS = New System.IO.FileStream(FileName, System.IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
    BR = New System.IO.BinaryReader(FS)

    Do While FS.Position < FS.Length
     FileBuffer = BR.ReadBytes(&H10000)

     If FileBuffer.Length > 0 Then
      ... do something with the file here... 
     End If
    Loop

    BR.Close()
    FS.Close()

   Catch
    ErrorMessage = "Error(" & Err.Number & ") while reading file:" & Err.Description
   End Try 
```

基本上，错误在于尝试使用所有不同的共享模式（READ、WRITE、READ_WRITE）读取文件对文件锁定绝对没有影响，无论您尝试什么；您总是会得到相同的结果： 已锁定，任何其他用户都无法使用。

微软甚至不会承认这个问题。

解决方案是使用内部 Kernel32 CreateFile API 来完成正确的访问，因为这将确保操作系统在请求读取具有共享锁定或锁定访问权限的文件时听取您的请求。

            回答 #4

赞同：0

时间：2009-11-06T17:38:14.683

我相信我遇到了相同类型的锁定问题，转载如下：

*   用户 1 从网络打开 Excel2007 文件（读写）（WindowsServer，版本 unkn）。
*   用户 2 打开相同的 Excel 文件（当然，以只读方式打开）。
*   用户1多次成功保存文件

在某些时候，用户 1 无法保存文件，因为消息显示“文件已锁定”。关闭用户 2 的只读版本...解锁，用户 1 现在可以再次保存。

以只读模式打开文件如何锁定该文件？

因此，这似乎是 Excel2007 问题或服务器问题。

        ios - 将 UILabel 添加到 UIToolbar

ID：333441

赞同：98

时间：2008-12-02T09:23:11.117

标签：ios, iphone, uibarbuttonitem

我正在尝试向我的工具栏添加标签。按钮效果很好，但是当我添加标签对象时，它会崩溃。有任何想法吗？

```
UIBarButtonItem *setDateRangeButton = [[UIBarButtonItem alloc] initWithTitle:@"Set date range"
                                                                       style:UIBarButtonItemStyleBordered
                                                                      target:self
                                                                      action:@selector(setDateRangeClicked:)];

UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(5, 5, 20, 20)];
label.text = @"test";

[toolbar setItems:[NSArray arrayWithObjects:setDateRangeButton,label, nil]];

// Add the toolbar as a subview to the navigation controller.
[self.navigationController.view addSubview:toolbar];

// Reload the table view
[self.tableView reloadData]; 
```

            回答 #1

赞同：129

时间：2008-12-02T09:59:34.443

看看这个

```
[[UIBarButtonItem alloc] initWithCustomView:yourCustomView]; 
```

基本上每个项目都必须是一个“按钮”，但它们可以用您需要的任何视图进行实例化。这是一些示例代码。请注意，由于其他按钮通常位于工具栏上，因此在标题按钮的每一侧都放置了分隔符，因此它保持居中。

```
NSMutableArray *items = [[self.toolbar items] mutableCopy];

UIBarButtonItem *spacer = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
[items addObject:spacer];
[spacer release];

self.titleLabel = [[UILabel alloc] initWithFrame:CGRectMake(0.0 , 11.0f, self.view.frame.size.width, 21.0f)];
[self.titleLabel setFont:[UIFont fontWithName:@"Helvetica-Bold" size:18]];
[self.titleLabel setBackgroundColor:[UIColor clearColor]];
[self.titleLabel setTextColor:[UIColor colorWithRed:157.0/255.0 green:157.0/255.0 blue:157.0/255.0 alpha:1.0]];
[self.titleLabel setText:@"Title"];
[self.titleLabel setTextAlignment:NSTextAlignmentCenter];

UIBarButtonItem *spacer2 = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
[items addObject:spacer2];
[spacer2 release];

UIBarButtonItem *title = [[UIBarButtonItem alloc] initWithCustomView:self.titleLabel];
[items addObject:title];
[title release];

[self.toolbar setItems:items animated:YES];
[items release]; 
```

            回答 #2

赞同：121

时间：2011-01-07T21:15:50.630

对于那些使用 Interface Builder 来布局的人`UIToolBar`，也可以单独使用 Interface Builder 来做到这一点。

要将 a 添加`UILabel`到 a`UIToolBar`您需要通过将新`UIView`对象`UIToolBar`拖到. 将自动创建一个将使用您的自定义初始化的. 接下来添加一个并以图形方式编辑以匹配您的首选样式。然后，您可以根据需要直观地设置固定和/或可变垫片以适当定位。`UIView``UIToolBar``IB``UIBarButtonItem``UIView``UILabel``UIView``UILabel``UILabel`

您还必须同时设置`UILabel`和`UIView`to的背景，`clearColor`才能`UIToolBar`在`UILabel`.

            回答 #3

赞同：33

时间：2014-09-12T13:01:33.487

我发现 answerBot 的回答非常有用，但我认为我在 Interface Builder 中找到了一种更简单的方法：

*   创建一个 UIBarButtonItem 并将其添加到 Interface Builder 中的工具栏

![在此处输入图像描述](https://i.stack.imgur.com/CkbRL.png)

*   取消选中此 BarButtonItem 的“启用”

![在此处输入图像描述](https://i.stack.imgur.com/GtCxh.png)

*   将此 BarButtonItem 插入您的类中的属性（这是在 Swift 中，但在 Obj-C 中非常相似）：

    ```
    @IBOutlet private weak var lastUpdateButton: UIBarButtonItem! // Dummy barButtonItem whose customView is lastUpdateLabel 
    ```

*   为标签本身添加另一个属性：

    ```
    private var lastUpdateLabel = UILabel(frame: CGRectZero) 
    ```

*   在viewDidLoad中，添加如下代码来设置你的label的属性，并将其添加为你的BarButtonItem的customView

    ```
    // Dummy button containing the date of last update
    lastUpdateLabel.sizeToFit()
    lastUpdateLabel.backgroundColor = UIColor.clearColor()
    lastUpdateLabel.textAlignment = .Center
    lastUpdateButton.customView = lastUpdateLabel 
    ```

*   要更新`UILabel`文本：

    ```
    lastUpdateLabel.text = "Updated: 9/12/14, 2:53"
    lastUpdateLabel.sizeToFit() 
    ```

结果 ：

![在此处输入图像描述](https://i.stack.imgur.com/zNpiX.png)

`lastUpdateLabel.sizetoFit()`每次更新标签文本时都必须调用

            回答 #4

赞同：6

时间：2009-02-07T02:36:09.200

我使用这个技巧的一件事是`UIActivityIndicatorView`在 之上实例化 a `UIToolBar`，否则这是不可能的。例如，在这里我有 a`UIToolBar`和 2 `UIBarButtonItem`， a `FlexibleSpaceBarButtonItem`，然后是另一个`UIBarButtonItem`。我想在灵活空间和最终（右手）按钮之间`UIActivityIndicatorView`插入一个。`UIToolBar`所以在我的`RootViewController`我做以下，

```
- (void)viewDidLoad {
[super viewDidLoad];// Add an invisible UIActivityViewIndicator to the toolbar
UIToolbar *toolbar = (UIToolbar *)[self.view viewWithTag:767];
NSArray *items = [toolbar items];

activityIndicator = [[UIActivityIndicatorView alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 20.0f, 20.0f)];
[activityIndicator setActivityIndicatorViewStyle:UIActivityIndicatorViewStyleWhite];    

NSArray *newItems = [NSArray arrayWithObjects:[items objectAtIndex:0],[items objectAtIndex:1],[items objectAtIndex:2],
                     [[UIBarButtonItem alloc] initWithCustomView:activityIndicator], [items objectAtIndex:3],nil];
[toolbar setItems:newItems];} 
```

            回答 #5

赞同：4

时间：2016-11-28T22:20:13.427

细节

*   Xcode 10.2.1 (10E1001)、斯威夫特 5

完整样本

```
import UIKit

class ViewController: UIViewController {

    private weak var toolBar: UIToolbar?

    override func viewDidLoad() {
        super.viewDidLoad()

        var bounds =  UIScreen.main.bounds
        let bottomBarWithHeight = CGFloat(44)
        bounds.origin.y = bounds.height - bottomBarWithHeight
        bounds.size.height = bottomBarWithHeight
        let toolBar = UIToolbar(frame: bounds)
        view.addSubview(toolBar)

        var buttons = [UIBarButtonItem]()
        buttons.append(UIBarButtonItem(barButtonSystemItem: .add, target: self, action: #selector(ViewController.action)))
        buttons.append(UIBarButtonItem(barButtonSystemItem: .camera, target: self, action: #selector(ViewController.action)))
        buttons.append(UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil))
        buttons.append(UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil))
        buttons.append(ToolBarTitleItem(text: "\(NSDate())", font: .systemFont(ofSize: 12), color: .lightGray))
        buttons.append(UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil))
        buttons.append(UIBarButtonItem(barButtonSystemItem: .cancel, target: self, action:  #selector(ViewController.action)))
        toolBar.items = buttons

        self.toolBar = toolBar
    }
    @objc func action() { print("action") }
}

class ToolBarTitleItem: UIBarButtonItem {

    init(text: String, font: UIFont, color: UIColor) {
        let label =  UILabel(frame: UIScreen.main.bounds)
        label.text = text
        label.sizeToFit()
        label.font = font
        label.textColor = color
        label.textAlignment = .center
        super.init()
        customView = label
    }
    required init?(coder aDecoder: NSCoder) { super.init(coder: aDecoder) }
} 
```

结果

[![在此处输入图像描述](https://i.stack.imgur.com/fm1eG.png)](https://i.stack.imgur.com/fm1eG.png)

            回答 #6

赞同：2

时间：2012-10-11T15:51:10.117

类似于 Matt RI 使用的界面构建器。但是我想在`UIWebView`里面放 1，这样我就可以将一些文本加粗，而其他文本则不加粗（比如邮件应用程序）。所以

1.  改为添加 web 视图。
2.  取消选中不透明
3.  确保背景颜色清晰
4.  把所有东西都挂起来`IBOutlet`
5.  使用下面`html`的透明背景，使工具栏发光

代码：

```
NSString *path = [[NSBundle mainBundle] bundlePath];
NSURL *baseURL = [NSURL fileURLWithPath:path];
NSString *html = [NSString stringWithFormat:@"<html><head><style>body{font-size:11px;text-align:center;background-color:transparent;color:#fff;font-family:helvetica;vertical-align:middle;</style> </head><body><b>Updated</b> 10/11/12 <b>11:09</b> AM</body></html>"];
[myWebView loadHTMLString:html baseURL:baseURL]; 
```

            回答 #7

赞同：1

时间：2013-03-08T16:46:17.497

试试这个：

```
UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(140 , 0, 50, 250)];
[label setBackgroundColor:[UIColor clearColor]];
label.text = @"TEXT";
UIView *view = (UIView *) label;
[self.barItem setCustomView:view]; 
```

注意：`self.barItem`是`UIBarButtonItem`从对象库中添加并放置在两个灵活空间之间的。

另一种方法是删除`[self.barItem setCustom:view]`线并更改`label`（宽度）的参数，使其填充整个工具栏并在代码中自行设置对齐方式为中间和字体，

            回答 #8

赞同：1

时间：2013-07-04T10:13:54.597

如果你想在工具栏视图上添加一个视图，你可以试试这个：

```
[self.navigationController.tabBarController.view addSubview:yourView]; 
```

            回答 #9

赞同：0

时间：2020-12-11T01:45:07.817

可以使用禁用的 BarButtonItem

```
let resultsLabel = UIBarButtonItem(title: "number of results", style: .plain, target: self, action: nil)
resultsLabel.isEnabled = false 
```

            回答 #10

赞同：0

时间：2021-08-04T02:54:27.820

**Swift 中的解决方案**
您可以做到这一点的一种方法是创建 a`UILabel`然后将其作为自定义视图添加到 a`UIBarButtonItem`然后添加到工具栏。例如：

```
 class ViewController: UIViewController {

    override func viewDidLoad() {
        super.viewDidLoad()
        navigationController?.setToolbarHidden(false, animated: false)

        let textLabel = UILabel()
        textLabel.font = UIFont.systemFont(ofSize: 17)
        textLabel.text = "Text Label" // Change this to be any string you want
        let textButton = UIBarButtonItem(customView: textLabel)
        let spacer = UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil)
        setToolbarItems([spacer, textButton, spacer], animated: false)
    }

} 
```

注意：`flexibleSpace`' 将标签放置在工具栏的中心

这是一个屏幕截图：
[![示例截图](https://i.stack.imgur.com/nuxPZ.png)](https://i.stack.imgur.com/nuxPZ.png)

注意：如果没有标签栏，工具栏将占据屏幕底部。

        c++ - C++ 对象实例化

ID：333443

赞同：114

时间：2008-12-02T09:23:35.627

标签：c++, instantiation

我是一名试图理解 C++ 的 C 程序员。许多教程使用片段演示对象实例化，例如：

```
Dog* sparky = new Dog(); 
```

这意味着稍后您将执行以下操作：

```
delete sparky; 
```

这是有道理的。现在，在不需要动态内存分配的情况下，是否有任何理由使用上述内容而不是

```
Dog sparky; 
```

并在 sparky 超出范围时调用析构函数？

谢谢！

            回答 #1

赞同：168

时间：2008-12-02T10:15:34.100

相反，您应该始终更喜欢堆栈分配，因为根据经验，您永远不应该在用户代码中使用 new/delete。

正如您所说，当变量在堆栈上声明时，它的析构函数会在超出范围时自动调用，这是您跟踪资源生命周期和避免泄漏的主要工具。

所以一般来说，每次你需要分配一个资源，无论是内存（通过调用new）、文件句柄、套接字还是其他任何东西，都将它包装在一个类中，构造函数获取资源，析构函数释放它。然后，您可以在堆栈上创建该类型的对象，并保证您的资源在超出范围时被释放。这样您就不必到处跟踪您的新/删除对，以确保避免内存泄漏。

这个成语最常见的名字是[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)

当您必须在专用 RAII 对象之外分配新的东西时，还可以查看用于在极少数情况下包装结果指针的智能指针类。相反，您将指针传递给智能指针，然后智能指针跟踪其生命周期，例如通过引用计数，并在最后一个引用超出范围时调用析构函数。标准库具有`std::unique_ptr`简单的基于范围的管理，并`std::shared_ptr`通过引用计数来实现共享所有权。

许多教程使用片段演示对象实例化，例如...

所以你发现大多数教程都很糟糕。;) 大多数教程教你糟糕的 C++ 实践，包括在不需要时调用 new/delete 来创建变量，并且让你很难跟踪分配的生命周期。

            回答 #2

赞同：20

时间：2013-06-29T11:05:18.297

尽管在分配和自动释放方面将东西放在堆栈上可能是一个优势，但它也有一些缺点。

1.  您可能不想在堆栈上分配大对象。

2.  动态调度！考虑这段代码：

```
#include <iostream>

class A {
public:
  virtual void f();
  virtual ~A() {}
};

class B : public A {
public:
  virtual void f();
};

void A::f() {cout << "A";}
void B::f() {cout << "B";}

int main(void) {
  A *a = new B();
  a->f();
  delete a;
  return 0;
} 
```

这将打印“B”。现在让我们看看使用 Stack 时会发生什么：

```
int main(void) {
  A a = B();
  a.f();
  return 0;
} 
```

这将打印“A”，这对于熟悉 Java 或其他面向对象语言的人来说可能不直观。原因是您不再有指向实例的指针`B`。相反，`B`会创建一个 的实例并将其复制到`a`type 的变量中`A`。

有些事情可能会以不直观的方式发生，尤其是当您不熟悉 C++ 时。在 C 中，你有你的指针，就是这样。你知道如何使用它们，而且它们总是一样的。在 C++ 中，情况并非如此。想象一下，当您在此示例中使用 a 作为方法的参数时会发生什么 - 事情变得更加复杂，如果`a`是类型`A`或`A*`什`A&`至（通过引用调用），它确实会产生巨大的差异。许多组合是可能的，它们的行为都不同。

            回答 #3

赞同：13

时间：2008-12-02T09:25:53.810

好吧，使用指针的原因与在 C 中使用 malloc 分配的指针的原因完全相同：如果您希望对象的寿命比变量长！

如果可以避免的话，甚至强烈建议不要使用 new 运算符。特别是如果您使用异常。一般来说，让编译器释放你的对象要安全得多。

            回答 #4

赞同：13

时间：2008-12-02T17:26:27.460

我从不太了解 & address-of 运算符的人那里看到了这种反模式。如果他们需要使用指针调用函数，他们将始终在堆上分配，以便获得指针。

```
void FeedTheDog(Dog* hungryDog);

Dog* badDog = new Dog;
FeedTheDog(badDog);
delete badDog;

Dog goodDog;
FeedTheDog(&goodDog); 
```

            回答 #5

赞同：7

时间：2008-12-02T17:06:25.893

将堆视为非常重要的不动产并非常明智地使用它。基本的经验法则是尽可能使用堆栈**，**并在没有其他方法时使用堆。通过在堆栈上分配对象，您可以获得许多好处，例如：

(1)。您不必担心出现异常时堆栈展开

(2)。您不必担心由于堆管理器分配的空间过多而导致的内存碎片。

            回答 #6

赞同：5

时间：2008-12-02T09:28:52.883

我担心的唯一原因是 Dog 现在分配在堆栈上，而不是堆上。所以如果 Dog 的大小是兆字节，你可能会遇到问题，

如果您确实需要走新/删除路线，请注意例外情况。因此，您应该使用 auto_ptr 或 boost 智能指针类型之一来管理对象的生命周期。

            回答 #7

赞同：1

时间：2008-12-02T09:30:51.383

当您可以在堆栈上分配时，没有理由（在堆上）新建（除非由于某种原因您有一个小堆栈并且想要使用堆。

如果您确实想在堆上分配，您可能需要考虑使用标准库中的 shared_ptr（或其变体之一）。一旦对 shared_ptr 的所有引用都不存在，这将为您处理删除操作。

            回答 #8

赞同：0

时间：2013-03-13T11:50:34.220

还有一个其他人没有提到的原因，您可能会选择动态创建对象。动态的、基于堆的对象允许您利用[多态性](https://stackoverflow.com/questions/1031273/what-is-polymorphism)。

            回答 #9

赞同：-4

时间：2012-08-12T23:31:47.957

我在 Visual Studio 中遇到了同样的问题。你必须使用：

yourClass->classMethod();

而不是：

yourClass.classMethod();

        visual-studio-2008 - Visual Studio 2008 中最大的节省时间的功能是什么

ID：333447

赞同：0

时间：2008-12-02T09:25:39.613

标签：visual-studio-2008

我问这个问题的原因是：-

我从发现 Visual Studio 2008 中的功能中获得了真正的嗡嗡声，这些功能最终每天为我节省了大量时间。最近发现了一个 Sara Ford 的博客，她每天都会在她的博客上写出一个小费。

我想知道在 Visual Studio 2008 中使用 IDE 时可以提供的最大的节省时间的技巧是什么？

到目前为止，我发现的最佳功能是 Ctrl + 和 Ctrl - 用于来回导航。

            回答 #1

赞同：3

时间：2008-12-02T09:28:04.213

[这里](https://stackoverflow.com/questions/100420/hidden-features-of-visual-studio-2005-2008)提到了很多功能......特别是[这个](http://blogs.msdn.com/saraford/archive/tags/Visual+Studio+2008+Tip+of+the+Day/default.aspx)博客有很多有用的提示。

            回答 #2

赞同：2

时间：2008-12-02T09:29:11.900

使用重构快捷方式。单击菜单中的重构，您将看到简短列表。例如，Ctrl+R,M 表示“提取方法”。

            回答 #3

赞同：1

时间：2008-12-02T09:30:03.367

我最大的省时功能是 IntelliSense，尽管这并不是真正的隐藏功能。;)

            回答 #4

赞同：0

时间：2008-12-02T09:30:08.607

只是对上下文菜单的**重构......**

编辑：如果不明显，++条件中断

            回答 #5

赞同：0

时间：2008-12-02T09:34:47.710

当您发布快捷方式时，请根据您使用的键盘映射方案考虑它的不同。例如，我正在使用“Visual Basic 6”。

因此，请使用快捷方式添加您正在使用的方案作为信息。

SHIFT+F2 跳转到变量/函数的定义/无论光标指向什么，CTRL+SHIFT+F2 从我所在的位置跳回是我的时间节省。

            回答 #6

赞同：0

时间：2008-12-02T10:10:31.817

在 c# 中，您可以使用 CTRL+å（挪威键盘，美国/英国键盘上 P 右侧的键）在括号对之间跳转。如果您的光标在 { 括号上，您将跳转到匹配的结束后备箱，反之亦然。

            回答 #7

赞同：0

时间：2008-12-02T10:32:21.057

如果您有大型解决方案，请关闭设置中的自动填充工具箱条目。如果您与 WinForms 等图形设计师一起工作，这将为您节省*大量时间。*

        unit-testing - 基本上执行持久性的单元测试代码 - 我应该打扰吗？

ID：333454

赞同：4

时间：2008-12-02T09:28:10.170

标签：unit-testing, integration-testing

我正在使用与数据库交互的 api。这个 api 具有查询、加载和保存元素到数据库的方法。我已经编写了集成测试，它们执行诸如创建新实例之类的操作，然后检查当我对该实例进行查询时，是否找到了正确的实例。这一切都很好。  

我想对此代码进行更快的单元测试，但我想知道任何单元测试的有用性以及它们是否真的给了我任何东西。例如，假设我有一个类可以通过 API 保存一些元素。这是伪代码，但了解我使用的 api 是如何工作的。

```
public class ElementSaver
{
    private ITheApi m_api;

    public bool SaveElement(IElement newElement, IElement linkedElement)
    {
        IntPtr elemPtr = m_api.CreateNewElement()
        if (elemPtr==IntPtr.Zero)
        {
            return false;
        }
        if (m_api.SetElementAttribute(elemPtr,newElement.AttributeName,newElement.AttributeValue)==false)
        {
             return false;
        }
        if (m_api.SaveElement(elemPtr)==false)
        {
             return false;
        }

        IntPtr linkedElemPtr = m_api.GetElementById(linkedElement.Id)
        if (linkedElemPtr==IntPtr.Zero)
        {
            return false; 
        }
        if (m_api.LinkElements(elemPtr,linkedElemPtr)==false)
        {
            return false;
        }
        return true;

    }
} 
```

是否值得编写模拟 m_api 成员的单元测试？似乎我可以测试，如果任何各种调用失败，则返回 false，如果所有各种调用都成功，则返回 true，并且我可以设置期望使用预期参数调用各种方法，但是这有用吗？如果我要重构这段代码，使它使用一些稍微不同的 api 方法，但获得相同的结果，这会破坏我的测试，我需要更改它们。这种脆性似乎不是很有用。  

我应该为这样的代码进行单元测试，还是应该坚持使用已有的集成测试？

            回答 #1

赞同：4

时间：2008-12-02T09:51:28.847

看看测试是什么样的。如果您只测试传入的内容是否最终进入数据库等。您可能只做自动化集成测试就可以做正确的事情。如果有要测试的逻辑，那么您可能想看看是否可以将逻辑分解为单独的类，您可以对它们进行单元测试，并围绕不包含逻辑的基础设施代码进行外观。

            回答 #2

赞同：2

时间：2008-12-02T09:48:04.390

出于以下原因，在我的代码中模拟 m_api 是个好主意（并非所有这些都适用于您的伪代码示例）：

*   正如您所提到的，您可以验证您的类是否正确执行错误处理
*   如果您的类中有更复杂的代码（例如，缓存），您可以在您的模拟中使用期望来确保类的行为正确。例如，两次检索相同的对象，但确保 m_api 只被调用一次。
*   您的单元测试可以在不创建适当数据集的情况下测试行为。随着 m_api 下的数据模型发生变化，这会随着时间的推移增加可维护性。

        iis - 内网正常运行时间监控组件

ID：333461

赞同：1

时间：2008-12-02T09:29:42.477

标签：iis, intranet, uptime

我有一个 MOSS 2007 测试站点，它不是面向公众的，而是在我们的 Intranet 上，我正在寻找一个免费且易于安装的正常运行时间监控组件，有什么建议吗？

更新：我不需要图表或任何花哨的东西，我只需要确保在网站出现故障时通过电子邮件收到通知。

            回答 #1

赞同：2

时间：2008-12-02T09:50:58.660

[Nagios](http://www.nagios.org/)可能有点矫枉过正，但实施起来并不难......

            回答 #2

赞同：0

时间：2008-12-02T12:02:55.100

我还遇到了 OpManager - [http://manageengine.adventnet.com/products/opmanager/](http://manageengine.adventnet.com/products/opmanager/)

有一个免费版本可以监控 10 项服务。

我试图让它安装在我的 SQL 2008 Server 上，但最终只使用了产品默认的 mySQL 安装。

我还决定在使用 10 分钟后卸载它，对于完全合格的网络管理员来说，这似乎是一个很棒的工具，但它会增加太多的臃肿，无法将它安装在我的开发服务器上。

        ruby-on-rails - rails 路由控制器动作改变

ID：333462

赞同：4

时间：2008-12-02T09:29:56.953

标签：ruby-on-rails, ruby, routing

我在这里遇到一个问题：我有一个控制器*questions*，它有 action *new*。每当我需要创建新问题时，我都会输入

```
/questions/new 
```

我应该对 routes.rb 进行哪些更改才能将 URI 更改为

```
/questions/ask 
```

谢谢你。阀门。

            回答 #1

赞同：7

时间：2008-12-02T10:29:03.903

试试这个：

```
map.ask_question   '/questions/ask', :controller => 'questions', :action => 'new' 
```

然后你会有一个命名的路线，你可以：

```
link_to "Ask a question", ask_question_path 
```

            回答 #2

赞同：5

时间：2009-02-02T17:36:43.863

如果您使用的是 RESTful 路由，也许您想使用 map.resources 来解决您的*问题*。

要重命名操作 URL，您可以这样做：

`map.resources :questions, :path_names => { :new => 'ask', :delete => 'withdraw' }`

（为了示例，我添加了删除）

            回答 #3

赞同：0

时间：2008-12-02T09:49:55.197

哪个版本的导轨？

通常，默认路由应该捕获 /:controller/:action 之类的任何内容，因此您可以在问题控制器中创建一个 ask 方法。如果您想要更流畅的操作，请查看 named_route 和 map_resource 的 api 文档。

        xslt - 不能停止从程序方面考虑 XSLT... 帮助应用模板

ID：333463

赞同：4

时间：2008-12-02T09:30:01.930

标签：xslt

我知道 XSLT 在过程方面不起作用，但不幸的是，我从事过程语言的时间太长了。谁能帮助我，用简单的术语解释应用模板之类的东西是如何工作的，并帮助像我这样的人理解它。

            回答 #1

赞同：5

时间：2008-12-02T09:42:09.987

我很久以前写[了一篇博客文章](http://gregbee.ch/blog/using-xsl-for-each-is-almost-always-wrong)，其中显示了一个以“程序”风格编写的简单样式表 using`xsl:for-each`和等效的 using `xsl:apply-templates`。这绝不是一个全面的指南，但希望它会有一些用处。

            回答 #2

赞同：5

时间：2008-12-02T13:28:17.720

是什么让您认为程序性条款在这里不适用？只是调用约定比您通常预期的要隐含一些，因为涉及到一个不可见的上下文。所做的一切`apply-templates`都可以用程序术语来表达。

基本上，`apply-templates`无非就是一个 for-each 循环。从您当前在文档中的位置（上下文，想想“ `this`”）开始，它遍历子节点。

对于每个孩子，处理器选择`xsl:template`具有最高优先级的匹配项（基于它们各自的`match`和`priority`属性），为手头的孩子设置上下文并运行此模板（想想“ `function`”）。模板返回后，上下文快速恢复，轮到下一个孩子了。

即使事情变得递归（这在 XSLT 中有点难以避免），整个过程实际上并没有变得更加复杂。上下文“指针”被移动，模板被调用。

您可以使用以下属性限制`apply-templates`迭代的节点集：`select`

```
<!-- all children of the context node regardless -->
<xsl:apply-templates />  

<!-- all children of the context node being "data" with a @name of "Foo" -->
<xsl:apply-templates select="data[@name='Foo']" /> 
```

如果您愿意，可以在迭代之前对节点集进行排序：

```
<!-- all children of the context node being "data" with a @name of "Foo",
     ordered by their respective "detail" count -->
<xsl:apply-templates select="data[@name='Foo']"> 
  <xsl:sort select="count(detail)" data-type="number" order="descending"/>
</xsl:apply-templates> 
```

如果需要，您可以将参数传递给模板，就像使用常规函数调用一样：

```
<!-- pass in some parameter -->
<xsl:apply-templates select="data[@name='Foo']"> 
  <xsl:with-param name="DateSetIcon" select="$img_src" />
</xsl:apply-templates> 
```

这就是它的全部内容。

编辑：

我知道最后的评论有点挑衅。这是非常有意的，因为基本了解`apply-templates`这或多或少是它的工作原理。*不是您*定义要调用什么模板，而是让处理器为您选择正确的模板，这一事实带来的影响和可能性当然比未经训练的耳朵听起来更大。整个事情的声明式/隐式方法肯定需要一些时间来理解。

            回答 #3

赞同：2

时间：2008-12-02T17:44:38.220

我非常同意 Greg Beech 的回答和博客文章。

有关更详细的比较`<xsl:for-each>`，`<xsl:apply-templates>`请参阅[**我**](http://markmail.org/message/xbm7tsglnhqogdzd)对 xsl-list 中“xsl:for-each vs. xsl:apply-templates”问题的回答，并享受[**整个线程**](http://markmail.org/message/xbm7tsglnhqogdzd#query:+page:1+mid:u6vldphwj263tejm+state:results)。

" *xsl:apply-templates 比 xsl:for-each 更丰富、更深入，甚至仅仅是因为我们不知道将在选择的节点上应用什么代码——在一般情况下，该代码对于不同的节点会有所不同节点列表的节点。**此外，将应用的代码可以在编写 xsl:apply 模板之后由不知道原作者的人编写***。

与过程编程语言的另一个区别是模板的应用顺序不是预先定义的。在纯函数式编程语言中没有“状态”或“执行顺序”的概念。

[**XSLT 2.0**](http://www.w3.org/TR/xslt20/#applying-templates)和[**XSLT 1.0**](http://www.w3.org/TR/xslt#section-Processing-Model)都没有指定应用所选模板规则的任何特定顺序——只是它们的结果将根据节点的顺序进行组合（按照排序顺序，如果有任何`<xsl:sort>`指令，或者按照文档顺序）节点），在其上应用模板。

[**XSLT 2.0 规范**](http://www.w3.org/TR/xslt20/#applying-templates)说：

"*每个被评估的模板规则都会产生一个项目序列作为其结果。然后将结果序列（排序序列中的每个节点一个）连接起来，形成一个序列。它们被连接起来，保留了节点中的节点的顺序排序后的序列。最终连接的序列形成 xsl:apply-templates 指令的结果*“

[**XSLT 1.0**](http://www.w3.org/TR/xslt#section-Processing-Model)规范说：

“*实现可以自由地以任何产生与使用此处理模型处理的结果相同的结果的方式处理源文档*。”

XSLT 实现甚至可以`<xsl:for-each>`并行应用模板（或 的主体）。

        web-services - 开发一个安全的 WS 客户端来使用带有 Rampart WS 安全模块的 Axis2 Web 服务？

ID：333467

赞同：1

时间：2008-12-02T09:31:48.043

标签：web-services, jax-ws, axis2, ws-security, rampart

我有一个使用 Rampart 保护的 Axis2 Web 服务。我确实想为它开发安全客户端，最好是基于 JAX-WS 的。我尝试了很多教程，但它们之间的联系非常紧密，比如在客户端包含 Axis2 库。客户端应该完全独立于 WS 服务框架，因为该服务可以由基于 .NET 的客户端甚至基于 PHP 的客户端使用。

提前致谢...

            回答 #1

赞同：1

时间：2009-08-27T19:01:46.250

据我了解，您希望能够为您的 Rampart 安全 Web 服务定义的策略提供给您的 JAX-WS 客户端。

这应该是可行的。正如你所说——这个想法是能够执行不同的客户端和服务器技术，围绕 WSDL 进行标准化......

我们只是刚刚进入这个 - 所以我没有任何知识给你。

但我认为您应该能够在 services.xml 文件中复制服务器上城墙的策略信息并将其放入您的客户端。

这似乎很有帮助：

[https://metro.dev.java.net/guide/](https://metro.dev.java.net/guide/)

特别是第 12 和 18 条。

        c# - 可以为 GridView CommandField 设置 PostbackUrl 吗？

ID：333484

赞同：0

时间：2008-12-02T09:45:26.267

标签：c#, asp.net, gridview, postback

我的页面上有一个 GridView 控件，我为其定义了许多 BoundFields。数据绑定的 GridView 的每一行都有一个 CommandField (Select)，我想为此将 PostBack 发送到新页面。

当然，我可以轻松地在 QueryString 中发送 NewSelectedIndex，但我宁愿对用户隐藏该信息。建议？

            回答 #1

赞同：1

时间：2008-12-02T14:18:59.600

莱皮是对的。GridView 没有 PostbackUrl 属性。但是，您可以使用具有 PostbackUrl 属性的标准控件来做您想做的事情。

```
<asp:TemplateField AccessibleHeaderText="Edit">
    <ItemTemplate>
        <asp:Button runat="server" ID="btnEdit" PostBackUrl="~/Default.aspx" OnClientClick='form1.ActivityId.value = this.Tag;' Tag='<%# Eval("ActivityId") %>' Text="Edit"/>
    </ItemTemplate>
</asp:TemplateField> 
```

在此示例代码中，我向 GridView 添加了一个 TemplateColumn。我为按钮使用动态添加的 Tag 属性来传递 Id，然后我使用 Javascript 代码将值放在隐藏字段中，然后按钮简单地回发到 PostbackUrl 属性中指定的页面。

            回答 #2

赞同：0

时间：2008-12-02T13:06:51.650

在 GridView 中使用 HyperLinkField 列：

```
<asp:HyperLinkField AccessibleHeaderText="Edit" DataNavigateUrlFields="ActivityId" DataNavigateUrlFormatString="AcitivtyEdit.aspx?id={0}" Text="Edit Activity" /> 
```

当然，正如您所说，此选项在 url 中显示 id。要隐藏它（尽管任何人都可以查看您的 javascript 并查看您的操作），您有两种选择： 1\. 使用 Javascript 代码设置一个带有 id 的隐藏字段，更改表单回发（操作）地址，然后提交表单。您必须允许您的 asp.net 站点允许从不同页面回发 2\. 允许命令回发到托管 GridView 的同一页面，并在服务器端事件处理程序中回发到 Server.Transfer 到您的页面（此选项提供关于顺序回发的其他问题...）

            回答 #3

赞同：0

时间：2009-05-21T17:30:10.130

谢谢塞尔吉乌·达米安。

我使用 MasterPages，UniqueID os 隐藏字段可能会有所不同。我需要发布两个值。

在事件 Gridview_RowDataBound 我把这个代码：

```
If e.Row.RowType = DataControlRowType.DataRow Then
   e.Row.Cells(12).Text = ""
   Dim img As New WebControls.ImageButton
   img.PostBackUrl = "NecesidadesPostBack.aspx"
   img.ImageUrl = "imagenes/edit.png"
   img.OnClientClick = HDLB.UniqueID.ToString & ".value = '" & e.Row.Cells(0).Text & "'; " & HDPT.UniqueID.ToString & ".value = '" & e.Row.Cells(1).Text & "';"
   img.AlternateText = "Edit"
   e.Row.Cells(12).Controls.Add(img)
End If 
```

我有 2 个隐藏字段（HDLB 和 HDPT）。OnClientClick 事件将这个隐藏字段的值修改为网格上第一个和第二个单元格的值。

        javascript - 调试期间的 Javascript 不是最新的

ID：333485

赞同：1

时间：2008-12-02T09:45:33.850

标签：javascript, visual-studio-2008

我正在使用 VS 2008 编写我的 Javascript 代码（主要是在 JQuery 中）。但是，当我完成编辑并按 F5 调出调试器时，js 文件没有更新。我需要关闭我的 vs2008 并重新打开它才能查看 js 文件的最新更改。

关于如何解决这个问题的任何想法？

            回答 #1

赞同：3

时间：2008-12-18T17:20:13.067

在浏览器中执行 CTRL-F5 以强制硬刷新页面正在使用的所有文件。

            回答 #2

赞同：1

时间：2008-12-02T09:46:50.180

清除浏览器中的缓存。通常它有一个本地缓存的副本。

            回答 #3

赞同：0

时间：2008-12-03T01:40:58.443

js 被大量缓存。使用时间戳并将其附加到 url：

script.js?_s=12345678

这将强制刷新

            回答 #4

赞同：0

时间：2008-12-03T17:25:49.987

清除浏览器缓存..这是通常的罪魁祸首

            回答 #5

赞同：0

时间：2008-12-10T14:21:35.813

如果您可以使用 Firefox，安装[Web Developer Toolbar](https://addons.mozilla.org/en-US/firefox/addon/60)插件，您可以禁用某些站点的缓存，即您正在开发的站点。

        python - 为 admin_only 装饰器获取重定向循环

ID：333487

赞同：1

时间：2008-12-02T09:47:08.917

标签：python, google-app-engine, redirect, decorator

我制作了这个装饰器，它会导致无限重定向循环。

问题是这样的：

```
args[0].redirect(users.create_login_url(args[0].request.path)) 
```

它似乎是一个完全有效的 URL。那么为什么它不能正确重定向呢？

```
def admin_only(handler, *args):

    def redirect_to_login(*args, **kwargs):
        return args[0].redirect(users.create_login_url(args[0].request.path))

    user = users.get_current_user()
    if user:
        if authorized(user):
            return handler(args[0])
        else:
            logging.warning('An unauthorized user has attempted to enter an authorized page')
            return redirect_to_login
    else:
        return redirect_to_login 
```

            回答 #1

赞同：2

时间：2008-12-02T11:11:45.487

您似乎没有正确定义您的装饰器。

每次用它包装函数时，装饰器只会被调用**一次；**从那时起，装饰器**返回**的函数将被调用。您似乎（错误地）相信装饰器函数**本身**每次都会被调用。

尝试这样的事情：

```
def redirect_to_login(*args, **kwargs):
    return args[0].redirect(users.create_login_url(args[0].request.path))

def admin_only(handler):
    def wrapped_handler(*args, **kwargs):    
        user = users.get_current_user()
        if user:
            if authorized(user):
                return handler(args[0])
            else:
                logging.warning('An unauthorized user has attempted '
                                'to enter an authorized page')
                return redirect_to_login(*args, **kwargs)
        else:
            return redirect_to_login(*args, **kwargs)

    return wrapped_handler 
```

请注意，在上面的代码中，装饰器只是定义了一个新函数并返回它，而这个新函数本身会进行相关检查。

            回答 #2

赞同：0

时间：2008-12-02T10:43:07.023

您确定正在发送正确的状态代码吗，您可以使用 Firefox 的实时 http 标头插件来检查是否正在发送 301 或 303。

            回答 #3

赞同：0

时间：2008-12-02T11:10:45.550

您应该使用 firebug 或 live http headers 或类似的东西来查看这里到底发生了什么。我的猜测：您的 authorized() 函数总是返回 false （即使用户已登录），因此它会重定向到登录页面，该页面（如果用户已经登录）立即将用户重定向回您的页面，这重定向......你明白了。

            回答 #4

赞同：0

时间：2008-12-02T18:37:27.567

问题实际上是当我使用

```
return args[0].redirect(users.create_logout_url(args[0].request.uri)) 
```

这将转到注销页面，然后重定向到当前页面。但是，我的日志显示当前页面认为我仍然登录，即使在注销完成后也是如此。

这很奇怪，因为我没有修改应用引擎用户 API 中的任何内容。

        asp.net - ASP.NET“DataSourceHelper”类本质上是 Dal 吗？

ID：333495

赞同：0

时间：2008-12-02T09:51:52.557

标签：asp.net

我在几个现代开源 ASP.NET 项目中看到了一个名为 DataSourceHelper 的类，它的属性为 DataObject(true)。

使用这样的类现在是 ASP.NET 惯用语吗？如果是，它是否等同于 DAL？

            回答 #1

赞同：1

时间：2008-12-02T10:13:37.973

我看到的唯一用途是 .NET 框架的内部，它实现的唯一方法如下：

```
System.Web.UI.DataSourceHelper.GetResolvedDataSource(object o, string data_member) 
```

这相当于

```
System.Web.UI.DataSourceResolver.ResolveDataSource(object o, string data_member) 
```

在此处查找完整代码（在单声道项目中）：

[http://www.koders.com/csharp/fid546A9F9796B7DC3E5B9C739D76B5C18F8C27B9CB.aspx?s=DataSourceHelper#L2](http://www.koders.com/csharp/fid546A9F9796B7DC3E5B9C739D76B5C18F8C27B9CB.aspx?s=DataSourceHelper#L2)

[http://www.koders.com/csharp/fid6346172865991F983A0546451DF02B2E2F868D8D.aspx?s=DataSourceResolver#L2](http://www.koders.com/csharp/fid6346172865991F983A0546451DF02B2E2F868D8D.aspx?s=DataSourceResolver#L2)

        vb.net - 在 CF 3.5 中从 VB.NET 调用外部 gps 应用程序并返回到 VB.NET 应用程序

ID：333498

赞同：1

时间：2008-12-02T09:52:47.487

标签：vb.net, compact-framework, garmin

我正在用 VB.NET 编写一个应用程序，允许用户调用 Garmin Mobile XT 来获取路线。

我有一个在 Garmin 后面保持打开状态的表单，在退出 Garmin 时，允许用户返回。

但是，有时 WM OS 会自动隐藏此表单。

有什么想法可以让表单保持不变 - 或者我可以检查启动我的应用程序以检查应用程序是否已经在运行并且表单是否隐藏，并使表单回到顶部？

我尝试将表单设置为 TopMost 但这意味着 GPS 应用程序无法被视为我的表单位于 GPS 应用程序的最顶层。

我已经尝试捕获表单的关闭处理程序，但这不会触发 - 我猜是因为 WM OS 只是隐藏表单而不是实际关闭它。

我尝试在表单 Deactivate 处理程序上捕获以防止焦点丢失，但这与 TopMost 属性的作用相同，我看不到 GPS 应用程序。

任何人对我可以从这里去哪里有任何想法，因为我现在真的不知道！

谢谢，亚当

            回答 #1

赞同：1

时间：2009-02-19T22:33:57.733

我相信这必须通过 OS API 在“常规”VB /VBA 中完成。为自己获取一个 winAPI 帮助文件 :-)。

现在我建议您的应用程序迭代所有窗口，找到您的 GPS 应用程序，使用：

HWND 查找窗口（

```
LPCTSTR lpClassName,  // pointer to class name
LPCTSTR lpWindowName  // pointer to window name    ); 
```

然后您可以更改其 Z 顺序（将其放在其他特定窗口的上方或下方）：

BOOL 设置窗口位置（

```
HWND hWnd,    // handle of window
HWND hWndInsertAfter, // placement-order handle
int X,    // horizontal position
int Y,    // vertical position
int cx,   // width
int cy,   // height
UINT uFlags   // window-positioning flags    ); 
```

，或者只是要求使用以下命令恢复它（这应该会自动将其带到最高 Z 顺序）：

BOOL SetWindowPlacement(

```
HWND hWnd,    // handle of window
CONST WINDOWPLACEMENT *lpwndpl    // address of structure with position 
```

数据 ）;

        javascript - 如果不考虑 IE，那么其他浏览器中还有哪些附加的 JavaScript 功能？

ID：333499

赞同：0

时间：2008-12-02T09:53:34.253

标签：javascript

我在这里只谈论 JavaScript，而不是 CSS 或 DOM 的实现。

我知道 getter 和 setter 现在可以在除 IE 之外的所有主要浏览器的最新版本中使用。如果我们拥有其他浏览器的最新版本并且暂时忘记 IE，那么还有哪些其他 JavaScript 功能可以跨浏览器使用？

            回答 #1

赞同：2

时间：2008-12-02T11:02:03.447

使用 Gecko 引擎浏览器，您可以获得：

*   [https://developer.mozilla.org/en/New_in_JavaScript_1.6](https://developer.mozilla.org/en/New_in_JavaScript_1.6)
*   [https://developer.mozilla.org/en/New_in_JavaScript_1.7](https://developer.mozilla.org/en/New_in_JavaScript_1.7)
*   [https://developer.mozilla.org/en/New_in_JavaScript_1.8](https://developer.mozilla.org/en/New_in_JavaScript_1.8)

至于实现这些功能的其他浏览器，我只知道 Webkit 实现了[Array Extras](https://developer.mozilla.org/en/New_in_JavaScript_1.6#Array_extras)，但实际上很容易为[所有浏览器中的这些功能提供monkeypatch 支持，](http://erik.eae.net/archives/2005/06/05/17.53.19/)因为它们只是附加方法。

Gecko、Opera 和 Webkit 也支持[`canvas`element](https://developer.mozilla.org/en/Canvas_tutorial)，虽然它是一个新的 HTML 元素，但通过 JavaScript 使用，所以我不确定这是否符合您的标准。话虽如此，目前[正在进行独立的努力](http://blog.vlad1.com/2008/07/30/no-browser-left-behind/)以将其引入 IE。

            回答 #2

赞同：0

时间：2008-12-02T09:55:58.353

我建议您访问[www.quirksmode.org](http://www.quirksmode.org)以获取不同浏览器/版本的大量详细比较。

            回答 #3

赞同：0

时间：2008-12-02T12:06:00.447

XML API：

*   [DOMParser](http://www.xulplanet.com/references/objref/DOMParser.html)对象
*   [XMLSerializer](http://www.xulplanet.com/references/objref/XMLSerializer.html)对象
*   [XSLTProcessor](http://www.xulplanet.com/references/objref/XSLTProcessor.html)对象
*   [DOM XPath](http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html)实现

尽管这些不是“JavaScript 功能”，而是 DOM API

        ruby - 是否可以将“gem install”配置为默认在 /usr/bin/ 之外安装可执行文件？

ID：333508

赞同：19

时间：2008-12-02T09:58:50.063

标签：ruby, installation, rubygems

默认情况下，当您`sudo gem install thegemname`将可执行文件安装到`/usr/bin/`

有没有办法改变这个？例如，将它们安装到`/usr/local/rubygems/bin`（或任何其他路径）？

该路径似乎没有被硬编码到 gemspec 文件中，所以我不明白为什么这是不可能的（尽管我对 Ruby/Gems 的经验很少）

            回答 #1

赞同：20

时间：2010-04-20T22:07:19.473

我将此添加为答案，以便当我再次遇到此问题时很明显:)

首先，将所有垃圾箱`/var/lib/gems/1.8/bin/`移入`/usr/bin/`. 如果您不这样做，那么卸载或更新 gem 将不会从原始 bin 目录中删除二进制文件。

您可能还希望从`$PATH`

接下来，编辑`~/.gemrc`并添加（或更新）以下行：

```
gem: --bindir /usr/bin 
```

这会覆盖 gem，以便它始终使用 /usr/bin/ 作为 bin 目录。

无需更新路径（对于多用户机器尤其混乱）。

            回答 #2

赞同：15

时间：2008-12-02T10:04:55.637

请参阅[http://www.rubygems.org/read/chapter/11](http://www.rubygems.org/read/chapter/11)并指定`~/.gemrc`定义 gemhome 变量的 a。

例如：

```
gemhome: /usr/local/rubygems 
```

你也可以把这个文件放在`/etc/gemrc`

或者，您可以设置[`GEM_HOME`env-variable](http://docs.rubygems.org/read/chapter/12)：

```
$ export GEM_HOME=/tmp/gemtest
$ gem install bundler
$ ls /tmp/gemtest/bin/
bundle 
```

**更新（10年后）：**

下面的 Andrey Rodionov 建议使用

```
gem: --bindir /usr/bin 
```

            回答 #3

赞同：2

时间：2008-12-02T11:03:45.580

在 OS X 上，可执行目录`/usr/bin`在文件中被覆盖`/Library/Ruby/Site/1.8/rubygems/defaults.rb`

```
# The default directory for binaries
def self.default_bindir
  if defined? RUBY_FRAMEWORK_VERSION then # mac framework support
    '/usr/bin'
  else # generic install
    ConfigMap[:bindir]
  end
end 
```

作为一个 hackish 解决方法，我更改`/usr/bin`为我想要的 bin 位置，它可以正常工作。似乎没有任何方法可以从`~/.gemrc`配置中覆盖 bindir？

            回答 #4

赞同：0

时间：2019-04-24T09:26:20.947

要将可执行文件安装到所需目录，`--bindir`可以使用命令行选项：

```
sudo gem install thegemname --bindir /usr/local/rubygems/bin 
```

使用 gem 版本 2.0.14.1 成功尝试了此选项。

如需更多命令行选项，`gem install --help`请在命令行上运行。

        sharepoint - MOSS 2007 保活文件

ID：333513

赞同：0

时间：2008-12-02T10:01:30.137

标签：sharepoint, moss

我有一个标准的 MOSS 2007 网站（MOSS 术语：应用程序和 SiteCollection）

我找到了主目录（作为它在 IIS 中的设置）

```
C:\InetPub\wwwRoot\wss\VirtualDirectories\nyMOSSApp.com:80 
```

我在这个目录中创建了一个 keepAlive.aspx 文件。内容非常基本......但它是一个有效的 winForm 文件（不是 0KB 文件）

当我尝试导航到该文件时，我得到一个 404（找不到文件）。

有任何想法吗？

            回答 #1

赞同：0

时间：2008-12-02T10:05:23.920

得到了答案，由于某种原因，当您将物理文件添加到文件系统时，SharePoint 需要 IISReset。该死的SharePoint :)

        rdlc - RDLC：在不使用子报表的情况下显示子集合数据

ID：333515

赞同：3

时间：2008-12-02T10:02:22.363

标签：rdlc

我正在尝试创建具有以下要求的 RDCL 报告：

*   数据源是一个主业务对象，也有一个子业务对象。
*   我想使用列表显示主 BO 的一些数据。
*   我想使用表格显示孩子 BO 的详细信息。
*   我不想使用子报表。
*   我不想展平我的对象图并使用分组

这可能吗？

            回答 #1

赞同：3

时间：2011-09-27T20:56:44.900

我不确定你能否实现你想要的。要么您必须使用子报表，要么根据主子数据的定义，您必须使用分组。

我知道这个答案来晚了，但这篇文章仍然显示在搜索结果中，并且有 1K 浏览量。

希望这可以帮助！

        database - AdventureWorks 演示文稿

ID：333517

赞同：0

时间：2008-12-02T10:03:15.157

标签：database, adventureworks

我想在 AdventureWorks 数据库上实现一个应用程序（学术练习）。我已经下载了图表。是否有不太正式的数据库描述？

谢谢，卢锡安

            回答 #1

赞同：1

时间：2011-05-10T06:21:38.940

Adventure Works Cycles 业务场景
[http://msdn.microsoft.com/en-us/library/ms124825.aspx](http://msdn.microsoft.com/en-us/library/ms124825.aspx)

高温高压

            回答 #2

赞同：1

时间：2008-12-02T10:21:53.650

找到它：http: [//msdn.microsoft.com/en-us/library/ms124659.aspx](http://msdn.microsoft.com/en-us/library/ms124659.aspx)

        vb.net - 正则表达式拼图

ID：333518

赞同：0

时间：2008-12-02T10:03:53.453

标签：vb.net, regex

在（Visual Basic，.NET）中：

```
 Dim result As Match = Regex.Match(aStr, aMatchStr)
  If result.Success Then
      Dim result0 As String = result.Groups(0).Value
      Dim result1 As String = result.Groups(1).Value
  End If 
```

其中：aStr 等于（空格是正常空格，和之间有七个空格`n`）`(`：

```
"AMEVDIEERPK + 7 Oxidation &nbsp; &nbsp; &nbsp; (M)" 
```

为什么`result1`aMatchStr等于一个空字符串

```
"\s*(\d*).*?Oxidation\s+\(M\)" 
```

但变为“7”`aMatchStr`等于

```
"\s*(\d*)\s*Oxidation\s+\(M\)" 
```

?

(`result0`等于 "AMEVDIEERPK + 7 氧化 (M)")

（这来自[MSQuant](http://msquant.sourceforge.net/)、[MascotResultParser.vb](http://pmortensen.eu/1/MSQuant/MSQsrcWWW,1.5,2008-12-19/MascotResultParser.vb.html)、 function `modificationParseMatch()`）。

            回答 #1

赞同：4

时间：2008-12-02T10:26:20.973

\s* 零个或多个空格

(\d*) 零个或多个数字（捕获）

.*? 任何字符（非贪婪，所以直到下一个匹配

氧化与氧化这个词匹配

\s+(M) 匹配一个或多个空格 then (M)

这里的问题是您在单词 Oxidation 之前匹配 0 个或多个任何字符，包括任何可能的数字，吃掉可能与前一个 \d 匹配的数字

\s*(\d*)\s*氧化\s+(M)

此处的区别在于您仅在氧化之前指定空格。不吃数字。

将 \d* 更改为 \d+ 以捕获数字

            回答 #2

赞同：3

时间：2008-12-02T10:14:15.163

我认为这是因为匹配从第一个字符开始并从那里继续......

对于您的第一个正则表达式：

```
Does "AMEVDIEERPK + 7 Oxidation (M)" match "\s*(\d*).*?Oxidation\s+(M)"?  Yes.. stop matching. 
```

对于您的第二个正则表达式：

```
Does "AMEVDIEERPK + 7 Oxidation (M)" match "\s*(\d*)\s*Oxidation\s+(M)"?  No...
Does "MEVDIEERPK + 7 Oxidation (M)" match "\s*(\d*)\s*Oxidation\s+(M)"?  No...
Does "EVDIEERPK + 7 Oxidation (M)" match "\s*(\d*)\s*Oxidation\s+(M)"?  No...
...
Does " 7 Oxidation (M)" match "\s*(\d*)\s*Oxidation\s+(M)"?  Yes 
```

如果你使用第一个正则表达式`\d+`而不是`\d*`你会得到更好的结果。

这不是*正*则表达式的工作原理，但你明白了。

            回答 #3

赞同：1

时间：2008-12-02T13:34:17.147

我决定暂时使用`\w*`。用户将需要为任何空白指定匹配，但它涵盖了此特定应用程序的大多数情况以及它的常用方式。

所以对于这个例子，正则表达式是：

```
\s*(\d*)\s*\w*Oxidation\s+\(M\) 
```

            回答 #4

赞同：1

时间：2008-12-02T14:04:56.103

对不起，语法还有更多...

不能依赖加号。它将（肽）序列和（肽）修饰分开。每个序列可以有多个修改。有两个修改的示例（“2”和“L”之间有 7 个空格）：

“KLIDLTQFPAFVTPMGK + 氧化 (M)；2 赖氨酸-13C615N2 (K-full)”

用户可以为第二次修改指定“\S+\s+(K-full)”，并且应该提取“2”。

以下是更多示例行（在加号之后）：

" 磷酸 (ST)；2 二甲基 (K)；二甲基 (N-term)"

" 磷酸 (ST);2 二甲基:2H(4) (K);二甲基:2H(4) (N-term)"

" N-乙酰基 (蛋白质)"

" 2 二甲基:2H(4) (K); 二甲基:2H(4) (N-term)"

" N-乙酰基（蛋白质）；2 赖氨酸-13C615N2 (K-full)"

" 氧化 (M)；N-乙酰基 (蛋白质)"

" 氧化 (M)；N-乙酰基（蛋白质）；赖氨酸-13C615N2 (K-full)"

" N-乙酰基（蛋白质）；赖氨酸-13C615N2 (K-full)"

" 氧化 (M)；赖氨酸-13C615N2 (K-full)"

" 氧化 (M)"

" 2 氧化 (M)；赖氨酸-13C615N2 (K-full)"

可以在以下位置找到包含用户定义规则的示例文件（以 7-zip 格式打包）：

< [http://www.pil.sdu.dk/1/MSQuant/CEBIquantModes,2008-11-10.7z](http://pmortensen.eu/1/MSQuant/CEBIquantModes,2008-11-10.7z) >

            回答 #5

赞同：1

时间：2008-12-02T12:13:33.707

要回答您的第二条消息，您（或您的用户）可以指定`\w*dation\s+\(M\)`匹配 Oxydation (M) 或 Gradation (M) 或 dation (M)。

            回答 #6

赞同：1

时间：2008-12-02T13:16:40.070

通过语法更新，我们似乎不需要担心 \d+ 和 \d* 之间的区别。即使没有数字，也总是存在 + 号。匹配这个 + 将正则表达式约束到它按预期工作的程度：

```
"\s*    // whitespace before +
 \+     // The + sign itself
 \s*    // whitespace after +
 (\d*)  // optional digits
 .*?    // any non-digit between the last digit and Oxidation (M)
 Oxidation\s+\(M\)" 
```

由于 + 必须首先匹配，并且必须精确匹配一次，所以 AMEVDIEERPK 前缀不能用 .*? 匹配。

            回答 #7

赞同：1

时间：2008-12-02T10:53:29.047

感谢您的快速回复！

如果只有一个（肽）修饰而不是前面示例中的 7 个修饰，则输入中的数字将被省略，例如：

**“AMEVDIEERPK + 氧化 (M)”**

如果使用“\d+”，则不会匹配。但也许我应该使用两个正则表达式，一个用于这两种情况。这会在一定程度上增加程序的复杂性（因为我想避免内存垃圾为每个要匹配的字符串构建正则表达式），但可以接受。

我真正想做的是让用户指定一个匹配规则，而不需要从（肽）修改的开头匹配该规则（这就是我尝试引入非贪婪匹配的原因）。

现在，用户的规则前面带有“\s*(\d*)\s*”，因此用户必须指定“Oxidation\s+(M)”才能匹配。指定例如“dation\s+(M)”将不起作用。

            回答 #8

赞同：1

时间：2008-12-02T10:13:36.350

“。*？” 在此示例中将始终匹配零个字符，因为 "* ?" 做最短的匹配。结果，由于 'O' 前面的东西是空格，“\d *”可以匹配 0 个数字。

（对不起引号中的空格；自动格式化程序正在吃我的语法。）

参考：*[正则表达式中的量词](http://msdn.microsoft.com/en-us/library/3206d374.aspx)*(MSDN)

        iis - IIS 配置。1个领域，多个应用

ID：333524

赞同：1

时间：2008-12-02T10:08:24.677

标签：iis, dns, configure

我这里有点问题。我们有 2 个 url，我称它们为[http://www.testUrl.com/](http://www.testUrl.com/)和[http://www.test-url.com/](http://www.test-url.com/)
这个 url 指向使用“A-Record”的服务器。

在 IIS 中，我通过“高级网站识别”将这些 url 指定给正确的应用程序。现在我们有 2 个应用程序。一个应用程序是一个版本，另一个是更高级的应用程序。现在我的老板要我将一个 url 链接到 2 个不同的应用程序。因此，当您浏览[http://www.testurl.com/](http://www.testurl.com/)或[http://www.testurl.com](http://www.testurl.com)时，您会看到最新版本，但当您浏览[http://www.testurl.com/folderinversion1/](http://www.testurl.com/folderinversion1/)时，您会看到查看第一个应用程序的文件夹。

这是一种情况，我认为没有解决方案，但我想仔细检查您是否可以将 1 个 url 分配给 2 个应用程序。

            回答 #1

赞同：1

时间：2008-12-02T13:05:32.587

您能否在 testurl.com 站点中创建一个名为 /folderinversion1 的虚拟目录，指向当前位于其他站点上的应用程序根目录？

        mysql - 从 Oracle CTL 迁移到 MySQL

ID：333529

赞同：1

时间：2008-12-02T10:10:31.973

标签：mysql, database, oracle, migration, ctl

我想从 Oracle 迁移到 MySQL，其中一个重要步骤是替换在 Oracle 环境上构建的实际作业。

基本上，我每天都会从另一个 Oracle 环境（主要是 CTL 或 Oracle 表导出）收到一些“oracle”转储文件。今天，我的 Oracle 作业将接收到的数据 (CTL...) 加载到我的 Oracle 表中。现在我想在 MySQL 表中替换我的 Oracle 表，继续接收来自 Oracle 环境的文件。

所以。您是否有相同的工具或工件来从 MySQL 环境中读取 Oracle CTL 文件（或 Oracle 表转储）？我已经使用了 mysqlimport GUI，但它不能满足我的需要。我需要脚本/命令来执行这些操作。

            回答 #1

赞同：1

时间：2008-12-03T02:26:48.727

如果您使用的是 Windows，请从 dev.mysql.com 尝试 MySQL 迁移工具包：

[MySQL 迁移工具包](http://dev.mysql.com/downloads/gui-tools/5.0.html)

            回答 #2

赞同：1

时间：2008-12-02T11:24:52.900

什么都没有想到 - 您可能需要编写自定义导出/导入脚本 - 例如，从 Oracle 编写 CSV 文件并从这些 CSV 文件加载 MySQL ......或者与两者对话的工作......

尽管[谷歌](http://www.google.co.uk/search?hl=en&q=mysql+import+from+oracle+export&meta=)确实提供了一些跨数据库导入/导出工具——它可能值得一试......

        javascript - 跨站 AJAX 请求

ID：333532

赞同：23

时间：2008-12-02T10:11:49.193

标签：javascript, ajax, security, xss

我需要从网站向托管在另一个域中的 REST Web 服务发出 AJAX 请求。

尽管这在 Internet Explorer 中运行良好，但其他浏览器（例如 Mozilla 和 Google Chrome）施加了更严格的安全限制，禁止跨站点 AJAX 请求。

问题是我无法控制域或托管站点的 Web 服务器。这意味着我的 REST Web 服务必须在其他地方运行，并且我无法实施任何重定向机制。

下面是进行异步调用的 JavaScript 代码：

```
var serviceUrl = "http://myservicedomain";
var payload = "<myRequest><content>Some content</content></myRequest>";
var request = new XMLHttpRequest();
request.open("POST", serviceUrl, true); // <-- This fails in Mozilla Firefox amongst other browsers
request.setRequestHeader("Content-type", "text/xml");
request.send(payload); 
```

我怎样才能在 Internet Explorer 以外的其他浏览器中进行这项工作？

            回答 #1

赞同：14

时间：2008-12-02T10:17:04.113

也许[JSONP](http://en.wikipedia.org/wiki/JSONP)可以提供帮助。

注意，您必须将消息更改为使用 json 而不是 xml

编辑

flickr 和[twitter](http://apiwiki.twitter.com/Search+API+Documentation)等主要网站支持带有回调等的 jsonp

            回答 #2

赞同：5

时间：2009-07-05T21:37:08.793

标记为答案的帖子是错误的：iframe 文档无法访问父级。同源策略双向工作。

事实是，不可能以任何方式使用 xmlhttprequest 来使用基于 rest 的 web 服务。从不同域（没有任何框架）加载数据的唯一方法是使用 JSONP。任何其他解决方案都需要位于您自己域上的服务器端代理，或位于远程域上的客户端代理和某种跨站点通信（如[easyXDM](http://easyxdm.net)）来在文档之间进行通信。

            回答 #3

赞同：3

时间：2008-12-02T10:22:36.583

这在 IE 中有效的事实是 IE 的安全问题，而不是功能。

不幸的是，跨站点脚本被禁止，并且公认的解决方法是通过您自己的域代理请求：您真的没有能力添加或修改服务器端代码吗？

此外，次要解决方法 - 涉及通过脚本标签获取数据 - 仅支持 GET 请求，您可以使用 SOAP 服务破解它，但对于您描述的 RESTful 服务的 POST 请求则不支持。

我真的不确定是否存在 AJAX 解决方案，您可能会回到 <form> 解决方案。

            回答 #4

赞同：3

时间：2008-12-02T12:11:51.713

不是很明确的解决方法（但有效）是使用 iframe 作为对其他站点的请求的容器。问题是，父级无法访问 iframe 的内容，只能导航 iframe 的“src”属性。但是 iframe 内容可以访问父级的内容。

因此，如果 iframe 的内容知道，他们可以调用父页面中的一些 javascript 内容或直接访问父页面的 DOM。

**编辑：**
示例：

```
function ajaxWorkaroung() {
    var frm = gewtElementById("myIFrame")
    frm.src = "http://some_other_domain"
}
function ajaxCallback(parameter){
    // this function will be called from myIFrame's content
} 
```

            回答 #5

赞同：2

时间：2012-07-07T14:02:45.643

让您的服务域接受跨域资源共享 (CORS)。

典型场景：大多数符合 CORS 的浏览器会首先发送一个 OPTIONS 标头，服务器应向该标头返回有关接受哪些标头的信息。如果标头满足服务对所提供请求的要求（允许的方法为 GET 和 POST、Allowed-Origin * 等），则浏览器将使用适当的方法（GET、POST 等）重新发送请求。

这一点与您使用 IE 时的所有内容相同，或者更简单地说，如果您发布到同一个域。

注意事项：一些服务开发SDK（特别是WCF）会尝试处理请求，在这种情况下你需要预处理OPTIONS方法来响应请求，避免在服务器上调用该方法两次。

简而言之，问题出在服务器端。

**编辑**IE 9 及更低版本的 CORS 存在一个问题，即它没有完全实现。幸运的是，您可以通过从服务器端代码调用服务并让它通过您的服务器返回来解决这个问题（例如 mypage.aspx?service=blah&method=blahblah&p0=firstParam=something）。从这里开始，您的服务器端代码应该实现请求/响应流模型。

            回答 #6

赞同：1

时间：2012-01-04T06:43:33.160

只需在您的原始域上使用服务器端代理。这是一个例子：http: [//jquery-howto.blogspot.com/2009/04/cross-domain-ajax-querying-with-jquery.html](http://jquery-howto.blogspot.com/2009/04/cross-domain-ajax-querying-with-jquery.html)

            回答 #7

赞同：0

时间：2012-08-26T09:28:40.137

这也可以使用本地网络服务器设置来完成，该本地设置使用正确的参数调用 curl 并返回 curl 输出。

应用程序.rb

```
require 'sinatra'
require 'curb'

set :views,lambda {"views/"+self.name.to_s.downcase.sub("controller","")}
set :haml, :layout => :'../layout', :format => :html5, :escape_html=>true
disable :raise_errors

get '/data/:brand' do
  data_link =  "https://externalsite.com/#{params[:brand]}"
  c = Curl::Easy.perform(data_link)
  c.body_str
end 
```

向 localhost:4567/data/something 发送 ajax 请求将从 externalsite.com/something 返回结果。

            回答 #8

赞同：0

时间：2013-12-07T05:05:58.767

另一种选择是在您自己的域上设置 CNAME 记录以“屏蔽”远程域主机名。

        javascript - 如何使用 JavaScript 导出 Excel 文件？

ID：333537

赞同：68

时间：2008-12-02T10:13:52.497

标签：javascript, excel

有没有办法通过 Javascript 生成 Excel/CSV？（它也应该是浏览器兼容的）

            回答 #1

赞同：52

时间：2013-12-30T21:28:49.320

github 上有一个名为**Excel Builder (.js)的有趣项目，它提供了一种下载 Excel** **xlsx**文件
的客户端方式，并包括用于格式化 Excel 电子表格的选项。

[https://github.com/stephenliberty/excel-builder.js](https://github.com/stephenliberty/excel-builder.js)

使用此库时您可能会遇到浏览器和 Excel 兼容性问题，但在适当的条件下，它可能非常有用。

另一个具有较少 Excel 选项但较少担心 Excel 兼容性问题的 github 项目可以在这里找到：**ExcellentExport.js** 

[https://github.com/jmaister/excellentexport](https://github.com/jmaister/excellentexport)

如果您使用的是 AngularJS，则有**[ng-csv](https://github.com/asafdav/ng-csv)**：

一个“将数组和对象转换为可下载的 CSV 文件的简单指令”。

            回答 #2

赞同：34

时间：2013-02-13T03:46:05.143

如果您可以在服务器上生成 Excel 文件，那可能是最好的方法。使用 Excel，您可以添加格式并使输出看起来更好。已经提到了几个 Excel 选项。如果你有 PHP 后端，你可以考虑[phpExcel](https://github.com/PHPOffice/PHPExcel)。

如果您尝试使用 javascript 在客户端上执行所有操作，我认为 Excel 不是一种选择。您可以创建一个 CSV 文件并创建一个数据 URL 以允许用户下载它。

我创建了一个 JSFiddle 来演示：http:
 [//jsfiddle.net/5KRf6/3/](http://jsfiddle.net/5KRf6/3/)

这个 javascript（假设您使用的是 jQuery）将从表中的输入框中取出值并构建一个 CSV 格式的字符串：

```
var csv = "";
$("table").find("tr").each(function () {
    var sep = "";
    $(this).find("input").each(function () {
        csv += sep + $(this).val();
        sep = ",";
    });
    csv += "\n";
}); 
```

如果您愿意，您可以将数据放入页面上的标签中（在我的例子中是一个 id 为“csv”的标签）：

```
$("#csv").text(csv); 
```

您可以使用以下代码生成该文本的 URL：

```
window.URL = window.URL || window.webkiURL;
var blob = new Blob([csv]);
var blobURL = window.URL.createObjectURL(blob); 
```

最后，这将添加一个链接来下载该数据：

```
$("#downloadLink").html("");
$("<a></a>").
attr("href", blobURL).
attr("download", "data.csv").
text("Download Data").
appendTo('#downloadLink'); 
```

            回答 #3

赞同：10

时间：2017-06-22T05:16:13.490

类似的答案张贴[在这里](https://stackoverflow.com/a/44690209/7666504)。

[工作示例](http://jsfiddle.net/sujit77/9d6yrom9/69/)的链接

```
var sheet_1_data = [{Col_One:1, Col_Two:11}, {Col_One:2, Col_Two:22}];
var sheet_2_data = [{Col_One:10, Col_Two:110}, {Col_One:20, Col_Two:220}];
var opts = [{sheetid:'Sheet One',header:true},{sheetid:'Sheet Two',header:false}];
var result = alasql('SELECT * INTO XLSX("sample_file.xlsx",?) FROM ?', [opts,[sheet_1_data ,sheet_2_data]]); 
```

需要主要库 -

```
<script src="http://alasql.org/console/alasql.min.js"></script> 
<script src="http://alasql.org/console/xlsx.core.min.js"></script> 
```

            回答 #4

赞同：2

时间：2008-12-02T10:32:28.263

创建一个 AJAX 回发方法，该方法将 CSV 文件写入您的网络服务器并返回 url。在浏览器中将隐藏的 IFrame 设置为服务器上 CSV 文件的位置。

然后，您的用户将看到 CSV 下载链接。

            回答 #5

赞同：1

时间：2013-05-21T07:30:14.997

用一个工作示例回答您的问题：

```
<script type="text/javascript">
function DownloadJSON2CSV(objArray)
{
    var array = typeof objArray != 'object' ? JSON.parse(objArray) : objArray;

    var str = '';

    for (var i = 0; i < array.length; i++) {
        var line = new Array();

        for (var index in array[i]) {
           line.push('"' + array[i][index] + '"');
        }

        str += line.join(';');
        str += '\r\n';
    }
    window.open( "data:text/csv;charset=utf-8," + encodeURIComponent(str));
}
</script> 
```

        javascript - 是否有 javascript 库可以在 stackoverflow 中生成顶部消息功能区？

ID：333553

赞同：6

时间：2008-12-02T10:21:51.077

标签：javascript, jquery

stackoverflow 和 uservoice.com 中的这些功能区看起来不错。有没有这种效果的 javascript 库/jquery 插件？

            回答 #1

赞同：4

时间：2008-12-02T10:33:48.197

通过一些调整，这是一个有效的等价物，您会收到带有淡入/淡出效果的通知，它也会自动消失：

[http://projects.zoulcreations.com/jquery/growl/](http://projects.zoulcreations.com/jquery/growl/)

它基于它在 Mac 中 Growl 的外观：Growl 是 Mac OS X 的通知系统：它允许支持 Growl 的应用程序向您发送通知。

Mootools 也有类似的东西：

[http://icebeat.bitacoras.com/mootools/growl/](http://icebeat.bitacoras.com/mootools/growl/)

            回答 #2

赞同：1

时间：2008-12-02T11:08:17.067

经过一番谷歌搜索后，我在这里找到了类似的 jquery 效果教程[http://roshanbh.com.np/2008/07/top-floating-message-box-using-jquery.html](http://roshanbh.com.np/2008/07/top-floating-message-box-using-jquery.html)

        .net - IIS7 / WPAS：同一个 AppDomain 中有多个 WCF 服务？

ID：333557

赞同：4

时间：2008-12-02T10:22:49.547

标签：.net, wcf, web-services, iis-7

如果在 IIS7 或 WPAS 中托管我的 WCF 服务，是否可以将两个或多个服务加载到同一个 AppDomain 中，以便它们可以共享静态变量？

            回答 #1

赞同：5

时间：2010-04-24T19:46:56.720

**当然，您可以在Web 应用程序**中公开任意数量的端点（即使是不同的 WCF 服务）。这不应仅限于 IIS 或 WPAS。

这样做将使您能够访问**任何类型的共享数据**。尽管我通常建议不要使用静态变量来共享信息（但我当然不知道您的要求）。

            回答 #2

赞同：2

时间：2010-04-24T20:56:10.353

当然。在 Visual Studio 中，只需添加另一个 WCF 服务项。IIS 将在同一个 AppDomain 中运行这两个服务。在这个例子中，我首先创建了一个只有以下接口定义的库：

```
namespace ServiceInterface
{
    [ServiceContract]
    public interface IClass
    {
        [OperationContract]
        string GetMessage();
    }
} 
```

然后我在 VS 中创建了一个 Web 应用程序并添加了两个服务：`MyService`它们`Service2`都实现了`IClass`. 这是我的 web.config 文件部分`serviceModel`

```
 <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="WebService1.MyServiceBehavior">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
        <behavior name="WebService1.Service2Behavior">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <services>
      <service behaviorConfiguration="WebService1.MyServiceBehavior"
       name="WebService1.MyService">
        <endpoint address="" binding="wsHttpBinding" contract="ServiceInterface.IClass">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
      <service behaviorConfiguration="WebService1.Service2Behavior"
       name="WebService1.Service2">
        <endpoint address="" binding="wsHttpBinding" contract="ServiceInterface.IClass">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>
  </system.serviceModel> 
```

在客户端应用程序中，您的配置信息可能如下所示：

```
<client>
    <endpoint address="http://mymachinename.local/MyService.svc"
        binding="wsHttpBinding" bindingConfiguration="WSHttpBinding_IClass"
        contract="ServiceReference1.IClass" name="WSHttpBinding_IClass">
        <identity>
            <dns value="localhost" />
        </identity>
    </endpoint>
    <endpoint address="http://mymachinename.local/Service2.svc"
        binding="wsHttpBinding" bindingConfiguration="WSHttpBinding_IClass1"
        contract="ServiceReference2.IClass" name="WSHttpBinding_IClass1">
        <identity>
            <dns value="localhost" />
        </identity>
    </endpoint>
</client> 
```

            回答 #3

赞同：0

时间：2010-04-25T01:52:10.123

是的，您可以在 IIS 和 WPAS 中执行此操作。但这样做的唯一方法是在同一个程序集 AFAIK 中编译这两个服务。

        eclipse - Mac OS X 上的 Eclipse PDE：在运行时获取正确的字体大小？

ID：333558

赞同：1

时间：2008-12-02T10:24:48.763

标签：eclipse, macos, eclipse-pde

在 Mac OS X 上使用 Eclipse PDE 时有一个烦人的“特性”：运行时 IDE 的字体大小与真正的 IDE 不同。如果您正在开发一个插件并启动一个 Eclipse 实例来测试它（从 Eclipse 中），您会注意到生成的实例看起来与原始运行的 Eclipse 实例非常不同。字体又大又丑。这使得微调插件 UI 变得很困难。

顺便说一句，我没有遇到 Windows 的这种行为。

任何想法如何快速解决这个问题？

谢谢。

            回答 #1

赞同：3

时间：2008-12-04T10:57:33.593

找到了答案。

您需要在启动配置中添加以下 VM 参数：-Dorg.eclipse.swt.internal.carbon.smallFonts

我打开了一个关于它的缺陷。希望它会得到修复。

            回答 #2

赞同：0

时间：2008-12-02T12:51:08.140

Eclipse 将其首选项保存在每个工作区的基础上。您可能不会对两个 Eclipse 实例使用相同的工作区。因此，您需要为 spawn 设置一次首选项，或者将其从原始文件复制到 spawn-workspace。

现在您已经有了默认设置，这可能不是您在实例中设置的。

        c++ - C++/Win32：如何从 HBITMAP 中获取 alpha 通道？

ID：333559

赞同：10

时间：2008-12-02T10:24:53.287

标签：c++, windows, gdi, hbitmap, getdibits

我有一个`HBITMAP`包含 alpha 通道数据。我可以使用`::AlphaBlend`GDI 函数成功渲染它。

但是，当我调用`::GetPixel`GDI 函数时，我永远不会返回带有 alpha 分量的值。文档确实说它返回像素的 RGB 值。

有没有办法检索像素中的 alpha 通道值`HBITMAP`？

我希望能够检测何时使用 ::AlphaBlend，以及何时使用老式方法将源 HBITMAP 中的特定颜色视为透明。

```
HDC sourceHdc = ::CreateCompatibleDC(hdcDraw);
::SelectObject(sourceHdc, m_hbmp);

// This pixel has partial transparency, but ::GetPixel returns just RGB.
COLORREF c = ::GetPixel(sourceHdc, 20, 20);

// Draw the bitmap to hdcDraw
BLENDFUNCTION bf1;
bf1.BlendOp = AC_SRC_OVER;
bf1.BlendFlags = 0;
bf1.SourceConstantAlpha = 0xff;  
bf1.AlphaFormat = AC_SRC_ALPHA;            
::AlphaBlend(di.hdcDraw, x, 10, 64, 64, sourceHdc, 0, 0, 64, 64, bf1);

::DeleteDC(sourceHdc); 
```

回答

使用 GetDIBits 检索图像的第一条（或更多条）扫描线：

```
 byte* bits[1000];// = new byte[w * 4]; 
  BITMAPINFO bmi;
  memset(&bmi, 0, sizeof(BITMAPINFO)); 
  bmi.bmiHeader.biSize = sizeof(BITMAPINFOHEADER);
  bmi.bmiHeader.biWidth = w;
  bmi.bmiHeader.biHeight = -h;
  bmi.bmiHeader.biBitCount = 32;
  bmi.bmiHeader.biPlanes = 1;
  bmi.bmiHeader.biCompression = BI_RGB;
  bmi.bmiHeader.biSizeImage     = 0;
  bmi.bmiHeader.biXPelsPerMeter = 0;
  bmi.bmiHeader.biYPelsPerMeter = 0;
  bmi.bmiHeader.biClrUsed       = 0;
  bmi.bmiHeader.biClrImportant  = 0;
  int rv = ::GetDIBits(sourceHdc1, m_hbmp, 0, 1, (void**)&bits, &bmi, DIB_RGB_COLORS);

  //bits[3] == alpha of topleft pixel;

  //delete[] bits; 
```

            回答 #1

赞同：6

时间：2008-12-02T10:30:06.037

使用 GetDIBits。这样你就得到了一个 RGBQUAD 数组，你可能猜到 R、G 和 B 分量旁边有一个 alpha 通道。

        visual-studio - Visual Studio 2008 - 跳转到行号快捷方式

ID：333563

赞同：26

时间：2008-12-02T10:26:13.003

标签：visual-studio, visual-studio-2008, ide, keyboard-shortcuts

我可以通过在 Visual Studio 的状态栏中双击来转到特定的行号。有没有做同样事情的键盘快捷键？

            回答 #1

赞同：40

时间：2008-12-02T10:34:04.330

`Ctrl`+`G` 

查看所有键盘快捷键：

[http://www.microsoft.com/downloads/details.aspx?familyid=e5f902a8-5bb5-4cc6-907e-472809749973&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=e5f902a8-5bb5-4cc6-907e-472809749973&displaylang=en)

            回答 #2

赞同：15

时间：2008-12-02T10:27:06.993

`Ctrl`+  `G`为我工作。

如果它不适合您，您可以随时在工具 | 下映射您想要的任何快捷方式。选项 | 环境 | 键盘。

**编辑：**是的，正如@Brian 提到的，这种情况下的命令是`Edit.GoTo`

我刚刚意识到这个命令在 C# 设置中的默认设置是`Ctrl`+ `G`，而在 VB 设置中，没有默认的短键盘 - 它被映射为显示即时窗口 - 我觉得很奇怪。我交换了映射，以便两个环境的行为相同。

            回答 #3

赞同：1

时间：2008-12-02T10:37:13.870

我曾经使用过的每个 IDE 甚至文本编辑器都使用`Ctrl`+`L`或`Ctrl`+`G`来实现此目的。

我认为这可能代表`Ctrl`+ Line 或`Ctrl`+ Goto

            回答 #4

赞同：0

时间：2008-12-02T10:33:55.187

`Ctrl`是的+ `G`。

从[这个答案](https://stackoverflow.com/questions/320119/visual-studio-hotkey-to-switch-between-code-behind-and-source-file#320151)中，您可以获得一张不错的快捷方式海报。

        asp.net - ASP.NET：System.UnauthorizedAccessException - 拒绝访问路径

ID：333571

赞同：8

时间：2008-12-02T10:29:18.770

标签：asp.net, excel

我有一个 ASP.NET Web 应用程序，它执行以下操作：

1.  读取 Excel 文件。
2.  excel 文件中将有一个图像 URL，该 URL 指向 Internet 上的某个位置。
3.  该程序读取每个图像 URL 并将其存储到 Web 服务器的临时文件夹中。
4.  然后应用程序调整图像的大小（更改宽度和高度）。
5.  最后，应用程序将该图像保存到另一个文件夹。

    我收到以下异常：

System.Net.WebException：在 WebClient 请求期间发生异常。---> System.UnauthorizedAccessException: 拒绝访问路径 '\abcserver\target03\3111\35644\www.testing.com\web\content\images\TempStorage\tempImage.jpg'。在 System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath) 在 System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs , String msgPath, Boolean bFromProxy) at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access) at System.Net.WebClient.DownloadFile(Uri address, String fileName) --- 内部异常堆栈跟踪结束---

  在 ProcessImage.GetFileFromUrl(String imageFileUrl, String newFileName) 

  at uploadexceldata.UploadExcelData(String fileName)

```
 foreach (DataRow dr in dt.Rows) // Reading each excel row
            {

                if (dr[0].ToString() != "")
                {
                    id= "";
                    path = "";
                    manuId = "";

                    id= dr[0].ToString();
                    path = dr[1].ToString();
                    fileNameOnly = iProImg.GetFileNameOnly(path);
                    objDb.openConnection();
                    strSqlGroupInfo = "select ManufacturerID from  manufacturers where id='" + id+ "'";

                    dTblManu = objDb.BuildDT(strSqlGroupInfo); // To Fill data to Datatable
                    objDb.closeConnection();
                    if (dTblManu.Rows.Count > 0)
                    {
                        manuId = dTblManu.Rows[0][0].ToString();
                    }

                    if (manuId != "")
                    {
                        tempUploadPath = "images/TempStorage/";
                        tempUploadPath = Server.MapPath(tempUploadPath);
                        if (!Directory.Exists(tempUploadPath))
                        {
                            Directory.CreateDirectory(tempUploadPath);
                        }
                        tempFilePath = tempUploadPath + "\\tempImage.jpg";
                        tempFilePath = tempFilePath.Replace("/", "\\");

                        previewPath = Server.MapPath("images/previews/" + manuId);
                        thumbNailPath = Server.MapPath("images/thumbnails/" + manuId);

                        if (!Directory.Exists(previewPath))
                        {
                            Directory.CreateDirectory(previewPath);
                        }
                        if (!Directory.Exists(thumbNailPath))
                        {
                            Directory.CreateDirectory(thumbNailPath);
                        }
                        fileNameOnly = "\\preview" + id+ ".jpg";
                        fileNameOnly = fileNameOnly.Replace("/", "\\");
                        previewPath = previewPath + fileNameOnly;
                        tempPartialPathP = "images\\previews\\" + manuId + fileNameOnly;

                        fileNameOnly = "\\thumbnail" + id+ ".jpg";
                        thumbNailPath = thumbNailPath + fileNameOnly;
                        tempPartialPathT = "images\\thumbnails\\" + manuId + fileNameOnly;

                        try
                        {

                            iProImg.GetFileFromUrl(path, tempFilePath);
                            rowCounter++;
                            iProImg.ReSizeImage(tempFilePath, previewPath, previewSize);
                            iProImg.ReSizeImage(previewPath, thumbNailPath, thumbNailSize);

                        }
                        catch (Exception ec)
                        {

                            errorRowCount++;
                            iLog.LogErrorToFile("uploadExcel", ec.ToString(), "path : " + path + ",tempFilePath :" + tempFilePath);

                        }
                        finally
                        {
                            if(File.Exists(tempFilePath))
                            {
                            File.Delete(tempFilePath);
                            }
                        }
                    } // If manuid!=""
                }  //if (dr[0].ToString() != "") 
```

有人对如何解决此异常有任何建议吗？

            回答 #1

赞同：9

时间：2008-12-02T10:36:30.860

尝试将您正在读取/保存文件的 .Net 用户的访问权限设置为“完全控制”。

            回答 #2

赞同：4

时间：2010-01-22T22:49:25.867

世界上没有任何答案可以为我解决这个问题，直到我自己偶然发现了答案：

**取消加密文件**

您可以向整个硬盘驱动器上的每个人授予完全权限，但它仍然不允许 ASP.NET 解密文件。

如果您确定文件未加密，则只需将 ASPNET 帐户添加到您要访问的文件或文件夹中。但请确保它没有先加密！

            回答 #3

赞同：3

时间：2008-12-02T10:37:21.653

确保 ASP.NET 帐户对您正在写入的文件夹具有读/写权限（基本的 Windows 安全性）。

如何： 
 http: [//www.microsoft.com/windowsxp/using/networking/security/permissions.mspx](http://www.microsoft.com/windowsxp/using/networking/security/permissions.mspx)

（前 4 个步骤，选中复选框并单击`OK`）

[编辑]

您需要使用远程服务器上已知的帐户对自己进行身份验证。您可能授予了远程服务器上本地 ASP.NET 帐户的权限，这将不起作用，因为这不是您访问文件夹的用户（从网络服务器）。

[/编辑]

            回答 #4

赞同：3

时间：2008-12-02T11:03:02.273

回复所说的内容：“这是一个远程服务器，该文件夹已授予完全读/写权限。仍然无法正常工作”

确保 .Net 用户/机器帐户用户对该文件夹具有完全权限。

另外，将 <identity /> 添加到您的配置文件中

            回答 #5

赞同：3

时间：2008-12-04T02:25:53.563

以上所有内容，加上您可能需要添加此标签：

```
<identity impersonate="true" userName="accountname" password="password" /> 
```

阅读这篇[知识库文章](http://support.microsoft.com/kb/306158)  ，如果您要从浏览器到 iis 再到文件共享，这算作两跳，现在您需要配置 Kerberos 委派。比我聪明得多的系统管理员尝试配置[kerberos 委派](http://support.microsoft.com/kb/326985)但失败了。移动您的图像或 IIS 实例，使它们位于同一台计算机上。

            回答 #6

赞同：3

时间：2008-12-12T01:01:04.260

首先，通过临时授予每个人对该特定路径的完全权限来缩小您的问题。如果它有效，那么您就知道这是一个简单的权限问题，您只需要弄清楚哪个帐户需要适当的权限。可能是匿名用户帐户（在 IIS Admin 中仔细检查此设置）而不是 ASP.NET 帐户。（不要忘记为所有人拉权限）

如果需要，我相信您可以使用 FileMon 查看哪个帐户正在尝试访问特定文件。可能是错的，我有一段时间没有使用这个工具了。

最后一件事......是在文件上设置的只读标志吗？:)

            回答 #7

赞同：3

时间：2009-06-12T07:42:41.793

我今天遇到了完全相同的问题。在花了几个小时试图找出导致问题的原因后，我发现正在写入的文件夹的权限不正确。从本质上讲，从用于创建文件的用户的角度来看，该文件夹是只读的。

尝试对有问题的文件夹执行以下操作：

1.  右键单击文件夹并选择属性
2.  单击共享选项卡，然后单击权限按钮
3.  确保将要写入的任何用户添加到文件夹权限以执行此操作
4.  返回属性页面，单击安全选项卡
5.  确保将要写入的任何用户添加到文件夹权限以执行此操作

看到这个问题是在 6 个月前被问到的，我假设你已经解决了这个问题......但我只是想我会记录我的解决方案，以防将来在他们尝试时对其他人有用弄清楚如何解决这个 UnauthorizedAccessException。

            回答 #8

赞同：1

时间：2008-12-12T17:25:01.847

检查您写入 tempStorage 的图像文件 (jpg) 是否具有网络用户帐户（aspnet 或 iis_wpg）的适当权限。您可以设置 TempStorage 目录以替换所有子对象上的权限条目。  

1.  右键单击 TempStorage 文件夹并选择属性
2.  选择安全选项卡（确保正确的读/写/修改权限在这里）
3.  单击高级按钮
4.  选中第二个复选框 - 将所有子对象上的权限条目替换为此处显示的适用于子对象的条目。

现在，您添加到 TempStoreage 文件夹的所有文件都将继承允许您的网络用户帐户读取 jpg 文件的权限。

            回答 #9

赞同：1

时间：2012-02-01T14:14:47.940

不授予 ASPNET 用户权限，而是授予 NETWORK SERVICE 用户权限。修改文件夹内的权限应该足够了，不需要给完全权限（没有理由给比需要更多的权限）

更多详情请阅读论坛：[http ://forums.asp.net/t/1013434.aspx/1](http://forums.asp.net/t/1013434.aspx/1)

            回答 #10

赞同：0

时间：2015-02-28T15:37:28.347

错误很明显，对路径“bin\myprojname.pdb\”的访问被拒绝。运行 Web 控制台进程的用户（不是您在 Web 控制台中创建的用户，实际的 Windows 用户），很可能“网络服务”没有对该文件夹的权限。

您可以 - 右键单击​​该文件夹，转到权限并添加“网络服务”用户 - 右键单击​​该文件夹，转到权限并添加“所有人”用户

那应该可以解决这个问题。

        javascript - 基于 Web 的 yahoo-pipes 类似的插件或应用程序或......

ID：333572

赞同：2

时间：2008-12-02T10:29:45.787

标签：javascript, flash, yahoo-pipes

我正在寻找有关如何创建类似于 Yahoo Pipes 的拖放界面的建议：拖放元素并将它们链接在一起。

我真的不在乎它是 Flash 还是 JavaScript 或 SVG 或开源或商业（尽管价格合理会更好）。

理想情况下，我想将我的元素描述为 JSON 或 XML，然后让其他东西神奇地处理。

            回答 #1

赞同：2

时间：2008-12-02T13:21:37.237

有 WireIt JS 库：http: [//javascript.neyric.com/wireit/](http://javascript.neyric.com/wireit/)

实现它很容易，但我不确定它是否可以完成所有 JSON/XML 魔术。

        c++ - SetWindowsHookEx、KeyboardProc 和非静态成员

ID：333575

赞同：8

时间：2008-12-02T10:30:32.790

标签：c++, windows, hook

我正在创建一个键盘钩子，其中 KeyboardProc 是 CWidget 类的静态成员。

```
class CWidget
{
   static LRESULT CALLBACK KeyboardProc(int code, WPARAM wParam, LPARAM lParam );

}; 
```

我想在 CWidget::KeyboardProc 中调用 CWidget 的非静态成员。

最好的方法是什么？

KeyboardProc 没有任何 32 位 DWORD，我可以在其中传递“this”指针。

            回答 #1

赞同：7

时间：2008-12-02T10:42:30.317

鉴于您可能一次只需要安装一个键盘挂钩，只需在您的类中添加一个静态 pThis 成员：

```
// Widget.h
class CWidget
{
    static HHOOK m_hHook;
    static CWidget *m_pThis;

public:
    /* NOT static */
    bool SetKeyboardHook()
    {
        m_pThis = this;
        m_hHook = ::SetWindowsHookEx(WH_KEYBOARD, StaticKeyboardProc, /* etc */);
    }

    // Trampoline
    static LRESULT CALLBACK StaticKeyboardProc(int code, WPARAM wParam, LPARAM lParam)
    {
        ASSERT(m_pThis != NULL);
        m_pThis->KeyboardProc(code, wParam, lParam);
    }

    LRESULT KeyboardProc(int code, WPARAM wParam, LPARAM lParam);

    /* etc. */
}; 
```

您需要定义静态成员：

```
// Widget.cpp
CWidget *CWidget::m_pThis = NULL; 
```

        .net - 使用抗锯齿在 .Net 中调整图像大小

ID：333589

赞同：10

时间：2008-12-02T10:36:45.680

标签：.net, graphics

我有一些 C# 代码可以调整我认为非常典型的图像大小：

```
Bitmap bmp = new Bitmap(image, new Size(width, height));
Graphics graphics = Graphics.FromImage(bmp);
graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;
graphics.CompositingQuality = CompositingQuality.HighQuality;
graphics.SmoothingMode = SmoothingMode.AntiAlias;
graphics.DrawImage(bmp, width, height); 
```

问题是生成的图像明显混叠，对 InterpolationMode 和 SmoothingMode 属性的更改似乎没有任何区别。

任何指针？

            回答 #1

赞同：21

时间：2008-12-02T11:59:32.893

结果证明代码是错误的。它实际上是在 Bitmap 构造函数中调整图像大小而不进行插值，然后尝试将该版本平滑地调整为它已经处于的大小。这是修改后的代码：

```
Bitmap bmp = new Bitmap(width, height);
Graphics graph = Graphics.FromImage(bmp);
graph.InterpolationMode = InterpolationMode.High;
graph.CompositingQuality = CompositingQuality.HighQuality;
graph.SmoothingMode = SmoothingMode.AntiAlias;
graph.DrawImage(image, new Rectangle(0, 0, width, height)); 
```

就抗锯齿而言，最重要的参数是`graph.InterpolationMode`.

谢谢。

            回答 #2

赞同：2

时间：2008-12-02T10:48:02.023

试试 graphics.DrawImage(bmp, 0, 0, width, height); 另请查看[有关插值的 MSDN 文章](http://msdn.microsoft.com/en-us/library/k0fsyd4e.aspx)。

            回答 #3

赞同：2

时间：2008-12-02T11:07:02.827

抗锯齿与光栅图形无关。它仅适用于矢量图形。显然，图像是光栅图形。

您需要查看 InterpolationMode。

            回答 #4

赞同：0

时间：2008-12-02T10:50:39.223

问题可能出在另一个地方。我使用类似的代码来调整图像大小，它工作正常，但最大的区别是当你保存图像时，你必须指定质量（jpeg）：

```
ImageCodecInfo[] codecs=ImageCodecInfo.GetImageEncoders();
ImageCodecInfo codec = null;
for (int i = 0; i<codecs.Length;i++)
{
  if(codecs[i].MimeType.Equals("image/jpeg"))
    codec = codecs[i];
}

EncoderParameters encoderParametersInstance = null;

if (codec!=null)
{
  Encoder encoderInstance=Encoder.Quality;
  encoderParametersInstance = new EncoderParameters(2);
  //100% quality, try different values, around 80-90 gives good results.
  EncoderParameter encoderParameterInstance=new EncoderParameter(encoderInstance, 100L);
  encoderParametersInstance.Param[0]=encoderParameterInstance;
  encoderInstance=Encoder.ColorDepth;
  encoderParameterInstance=new EncoderParameter(encoderInstance, 24L);
  encoderParametersInstance.Param[1]=encoderParameterInstance;
}

MemoryStream ms = new MemoryStream();
resizedImage.Save(ms, codec, encoderParametersInstance); 
```

        java - 如何检测 Selector.wakeup 调用

ID：333593

赞同：5

时间：2008-12-02T10:37:32.560

标签：java, nio

如果我要写：

```
int selectedChannels = selector.select();
设置 selectedKeys = selector.selectedKeys();
if ( selectedChannels != selectedKeys.size() ) {
    // Selector.select() 因为调用了 Selector.wakeup() 而返回
    // 同步也是如此。
}
// 继续处理选定的通道。

```

它会正确检测到唤醒呼叫吗？

**背景资料：**

我正在编写一个服务器，它大部分时间只是接收数据包并将它们存储在一个文件中。应用程序很少需要向自己发送一个特殊的数据包。为此，它会（从不同的线程）启动到服务器套接字的连接：

```
SocketChannel 通道 = SocketChannel.open();
通道.configureBlocking（假）；
channel.connect(new InetSocketAddress(InetAddress.getLocalHost(), PORT));
选择器.唤醒（）；
SelectionKey key = channel.register( selector, SelectionKey.OP_CONNECT );

```

问题是如果主线程已经在 Selector.select() 中，SelectableChannel.register() 可能会阻塞。为了防止这种情况发生，我调用了 Selector.wakeup()，这让主线程过早地从 select() 返回。为了确保其他线程有机会完成注册调用，我必须同步主线程，但我必须在**每次**从 select() 返回后进行同步。如果我可以检测到它是否因为 wakeup() 调用而从 select() 返回，那么我可以针对这种情况对其进行优化。

所以，理论上最上面的代码片段应该可以工作，但我想知道它是否只会这样做，因为它依赖于一些未指定的行为？

感谢您的任何提示。

            回答 #1

赞同：3

时间：2008-12-02T17:08:16.577

`Selector#select()`我猜根据and的合同，建议的代码段原则上根本不起作用`Selector#selectedKeys()`。从[选择器](http://java.sun.com/javase/6/docs/api/java/nio/channels/Selector.html)：

*   所选键集是一组键，使得在先前的选择操作期间检测到每个键的通道已准备好用于在键的兴趣集中标识的至少一个操作。该集合由 selectedKeys 方法返回。

```
公共抽象 int 选择（长时间超时）
                抛出 IOException
    回报：
        键的数量，可能为零，其就绪操作集为
        更新

```

正如我所读到的，`selectedKeys`集合的大小应始终等于`select`定义返回的数字。我已经注意到 - 正如您可能已经注意到的那样 - 一些实现并不完全遵循文档，实际上`selectedKeys`返回所有具有更新就绪操作集的键，即使它们在调用`select`. 选择因调用而唤醒的唯一其他指标`wakeup`可能是键的数量为零；但是，这两种方法充其量都是不可靠的。

处理这个问题的常用方法是，隐含地，通过并发控制。我不会担心这里的执行时间；这是[过早优化](http://en.wikipedia.org/wiki/Optimization_(computer_science)#When_to_optimize)的经典例子。

除非您真的担心个位数的微秒容差，否则您不会注意到任何减速 - 如果您担心该级别的容差，`Selector`无论如何 a 对您来说都不够可靠。

这是一个常用机制的示例，使用 a`ReentrantLock`来完成适当的并发：

```
ReentrantLock selectorGuard;
Selector selector;

private void doSelect() {
    // Don't enter a select if another thread is in a critical block
    selectorGuard.lock();
    selectorGuard.unlock();

    selector.select();
    Iterator<SelectionKey> keyIter = selector.selectedKeys().iterator();

    while(keyIter.hasNext()) {

        SelectionKey key = keyIter.next();
        keyIter.remove();

        // Process key
    }
}

private void addToSelector() {

    // Lock the selector guard to prevent another select until complete
    selectorGuard.lock();

    try {
        selector.wakeup();

        // Do logic that registers channel with selector appropriately

    } finally {
        selectorGuard.unlock();
    }
} 
```

            回答 #2

赞同：0

时间：2008-12-02T12:02:35.633

我不明白为什么您的代码通常可以正常工作。

为什么不只检查一个`volatile`after `select`？

            回答 #3

赞同：0

时间：2017-05-01T23:52:21.887

如果`select()`返回零，要么超时，要么被唤醒。

            回答 #4

赞同：-1

时间：2008-12-02T13:43:27.270

您不能确定选择器唤醒的唯一原因是唤醒呼叫。您可能还有套接字活动。

因此，您需要让 wakeup 的调用者也做一些事情，比如设置一个 volatile 布尔值来表示它对注意力的渴望。选择器循环可以在每次唤醒时检查此布尔值的值。

        .net - 如何在已发布的 .Net 站点上包含 COM 组件？

ID：333595

赞同：2

时间：2008-12-02T10:40:42.910

标签：.net, asp.net, .net-2.0

如何在已发布的 .Net 站点上包含 COM 组件？

            回答 #1

赞同：2

时间：2008-12-03T11:59:04.483

最后我成功解决了这个问题：

要在您发布的网站上包含 COM 组件：

1.  在服务器的配置文件中包含程序集的引用 [在本地添加引用时它会自行添加]。
2.  将 dll 包含在您的 bin 文件夹中
3.  转到开始-->运行-->键入“DCOMCNFG”或转到控制面板-->管理工具-->组件服务-->计算机--> myComputer-->DCOM Config--> Microsoft Excel应用程序。右键获取属性对话框。转到安全选项卡并相应地自定义权限。

注意：请记住，如果您在 Windows 2003 Server 上运行，您必须使用应用程序池标识作为帐户，而不是 ASPNET 帐户。

• 转到开始-运行菜单项。

• 输入“DCOMCNFG”并回车。

• 这应该加载“组件服务”MMC（您也可以从管理工具 - 组件服务加载）

• 展开“组件服务”

• 展开“计算机”

• 展开“我的电脑”

• 选择“DCOM 配置”项目

• 选择“Microsoft Excel 应用程序”项目。

• 右键单击​​并选择属性

• 选择安全选项卡   

• 在“启动和激活权限”下选择“自定义”选项。

• 单击“编辑”按钮

• 单击“添加”按钮将新帐户添加到列表中。

• 在显示的对话框中单击位置按钮（这是因为默认情况下将选择您的域并且我们需要一个本地帐户）

• 单击确定按钮

• 在显示的对话框中，在 Windows XP 上输入“ASPNET”作为帐户名称（确保位置设置为 IIS 所在计算机的名称），或者如果您在 Windows 2003 Server 上运行，则必须输入应用程序池默认运行为“网络服务”

注意：在 Windows XP 上更快捷的方法是只输入计算机名称和帐户，因此在我的情况下是：ccrowe\ASPNET

• 单击确定按钮

• 现在确保为“ASP.NET 机器帐户”或作为应用程序池标识的帐户（默认为网络服务）选择以下选项

o 本地启动：允许

o 远程启动：[空白]

o 本地激活：允许

o 远程激活：[空白]

• 单击确定按钮并再次测试您的Web 应用程序，它应该可以正常工作。

            回答 #2

赞同：0

时间：2008-12-02T13:13:50.183

我可以澄清一下吗？听起来您想使用嵌入在 html 中的客户端 activex 控件（通过`<object/>`）。那是对的吗？

这不是一个非常安全的方法。许多浏览器/平台根本无法以这种方式工作。如果您*知道*您的客户端是 IE/windows，那么您也许可以在 cab 中签署 ocx，并标有 safe-for-scripting / safe-for-initialization 标志。但是 - 不建议这样做。

如果您想要丰富的客户端体验，请考虑 Silverlight，如果您需要更丰富的访问权限，例如扫描仪等，请考虑使用 ClickOnce 部署的智能客户端。

如果您的意思是服务器端，那么您可能需要在服务器上安装组件。无注册表的 COM*可能*工作，但不容易配置。如果您不拥有服务器（即它是为您托管的），那么 COM 可能不是首先要走的路……

        asp.net - 为什么 ASP.NET MVC 需要一个 Default.aspx 文件？

ID：333596

赞同：8

时间：2008-12-02T10:40:48.823

标签：asp.net, asp.net-mvc, routing

在 Visual Studio 2008 中新建 ASP.NET MVC 项目时，默认有一个 Default.aspx 页面。它有一条线

在其 Page_Load 函数中，它只是重定向到“/”以通过路由过程。

```
 public void Page_Load(object sender, System.EventArgs e)
    {
        HttpContext.Current.RewritePath(Request.ApplicationPath);
        IHttpHandler httpHandler = new MvcHttpHandler();
        httpHandler.ProcessRequest(HttpContext.Current);
    } 
```

我尝试删除 Default.aspx，结果发现默认 URI“ [http://localhost:2574/](http://localhost:2574/) ”仍然可以访问。那么，为什么还要费心去拥有这样的 Default.aspx 呢？

            回答 #1

赞同：10

时间：2008-12-02T15:00:06.053

旧版本的 IIS 需要一个启动文档，它还为您提供了一些右键单击以获取“在浏览器中查看”选项的内容。

            回答 #2

赞同：6

时间：2008-12-02T10:51:27.290

这里发生的情况是，请求的 Url（即 Default.aspx）被重新写入应用程序根目录“/”，然后从 Webform HTTP 处理程序转移到 MvcHttpHandler 上。对“/”的请求将匹配默认路由条目（显示更下方）......最终将我们发送到其中一个路由控制器。

有用的链接[在这里](http://www.58bits.com/blog/2008/09/29/asp-net-mvc-and-routing-default-aspx/)

        wpf - UI自动化测试右键菜单

ID：333598

赞同：7

时间：2008-12-02T10:42:35.887

标签：wpf, testing, user-interface, automation

我正在尝试使用 ui 自动化对 wpf 应用程序进行自动化测试。我在模拟鼠标右键单击并在右键单击菜单中选择不同选项时遇到问题。有什么建议么？

我在运行其他使用 ui 自动化编写的测试时也遇到了问题。因为如果我没有打开 UISpy 并且所有程序都最小化，他们只是不想开始。  

            回答 #1

赞同：3

时间：2008-12-16T10:35:25.927

通过大量浏览，我找到了这个解决方案。它可能对其他人有帮助：[Silverlight 中的 UI 自动化](http://blogs.msdn.com/gisenberg/archive/2008/07/17/ui-automation-in-silverlight-part-ii-the-easy-way.aspx)

只添加了简单的右键代码

```
public static class Mouse
    {

        private const UInt32 MouseEventLeftDown = 0x0002;
        private const UInt32 MouseEventLeftUp = 0x0004;
        private const UInt32 MouseEventRightDown = 0x0008;
        private const UInt32 MouseEventRightUp = 0x00010;

        [DllImport("user32.dll")]

        private static extern void mouse_event(UInt32 dwFlags, UInt32 dx, UInt32 dy, UInt32 dwData, IntPtr dwExtraInfo);

        public static void Click()
        {
            mouse_event(MouseEventLeftDown, 0, 0, 0, IntPtr.Zero);
            mouse_event(MouseEventLeftUp, 0, 0, 0, IntPtr.Zero);
            Thread.Sleep(100);
        }

        public static void RightClick()
        {
            mouse_event(MouseEventRightDown, 0, 0, 0, IntPtr.Zero);
            mouse_event(MouseEventRightUp, 0, 0, 0, IntPtr.Zero);
            Thread.Sleep(100);

        } 
```

        flash - 在 Flash (AS2) 中检测鼠标双击

ID：333600

赞同：0

时间：2008-12-02T10:43:39.643

标签：flash, mouse, actionscript-2, double-click

有没有办法使用 ActionScript 2.0 检测鼠标双击按钮对象？

            回答 #1

赞同：2

时间：2008-12-03T01:32:15.390

为了明确其他答案的含义，没有内置的方法。您只需要听两次点击并决定它们是否足够接近以算作双重，或者使用执行此操作的包，或者使用 AS3。

        mysql - 设计用户角色和权限系统的最佳实践？

ID：333620

赞同：52

时间：2008-12-02T10:56:04.440

标签：mysql, database, database-design

我需要将用户角色和权限系统添加到使用 PHP/MySQL 构建的 Web 应用程序中。我想要这个功能：

1.  一个根用户可以创建子根、组、规则和普通用户（所有权限）。
2.  子根只能为他/她自己的组（没有组）创建规则、权限和用户。
3.  用户可以根据组 root 分配给他的权限访问由他或他的组创建的内容。

我需要系统足够灵活，以便为内容分配新的角色和权限。

我有一个`users`存储组键和其他信息的表。目前，我在每个内容表中使用两个字段，即`createdBy`和`CreatedByGroup`，并将其用作某个用户是否具有权限的点。但它不够灵活，因为对于每一个新内容，我都必须通过所有的数据更新和权限更新。请通过讨论您的架构设计最佳实践来帮助我。

            回答 #1

赞同：41

时间：2014-09-03T12:09:01.137

我认为按位运算符是实现用户权限的最佳方式。在这里，我将展示我们如何使用 MySQL 来实现它。

以下是带有一些示例数据的示例表：

**表 1**：存储权限名称的权限表，如 1、2、4、8.. 等（2 的倍数）

```
CREATE TABLE IF NOT EXISTS `permission` (
  `bit` int(11) NOT NULL,
  `name` varchar(50) NOT NULL,
  PRIMARY KEY (`bit`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

将一些示例数据插入表中。  

```
INSERT INTO `permission` (`bit`, `name`) VALUES
(1, 'User-Add'),
(2, 'User-Edit'),
(4, 'User-Delete'),
(8, 'User-View'),
(16, 'Blog-Add'),
(32, 'Blog-Edit'),
(64, 'Blog-Delete'),
(128, 'Blog-View'); 
```

**表 2**：用于存储用户 ID、名称和角色的用户表。角色将被计算为权限的总和。

例子：  

如果用户 'Ketan' 拥有 'User-Add' (bit=1) 和 'Blog-Delete' (bit-64) 的权限，那么角色将为 65 (1+64)。

如果用户 'Mehata' 拥有'Blog-View' (bit=128) 和'User-Delete' (bit-4) 的权限，那么角色将是 132 (128+4)。  

```
CREATE TABLE IF NOT EXISTS `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  `role` int(11) NOT NULL,
  `created_date` datetime NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1; 
```

样本数据-

```
INSERT INTO `user` (`id`, `name`, `role`, `created_date`)
   VALUES (NULL, 'Ketan', '65', '2013-01-09 00:00:00'),
   (NULL, 'Mehata', '132', '2013-01-09 00:00:00'); 
```

加载用户权限 登录后，如果我们想加载用户权限，那么我们可以在下面查询来获取权限：

```
SELECT permission.bit,permission.name  
   FROM user LEFT JOIN permission ON user.role & permission.bit
 WHERE user.id = 1 
```

这里 user.role "&" permission.bit 是一个按位运算符，它将输出为 -

```
User-Add - 1
Blog-Delete - 64 
```

如果我们要检查天气，特定用户是否具有用户编辑权限-

```
 SELECT * FROM `user` 
     WHERE role & (select bit from permission where name='user-edit') 
```

输出 = 无行。

您还可以查看：[http ://sforsuresh.in/implemention-of-user-permission-with-php-mysql-bitwise-operators/](http://sforsuresh.in/implemention-of-user-permission-with-php-mysql-bitwise-operators/)

            回答 #2

赞同：39

时间：2008-12-02T11:15:45.557

适合您需要的模式称为[基于角色的访问控制](http://en.wikipedia.org/wiki/Role-based_access_control)。

PHP 中有几个很好的实现，包括[Zend_Acl](http://framework.zend.com/manual/1.12/en/zend.acl.html)（良好的文档）、[phpGACL](http://phpgacl.sourceforge.net/)和[TinyACL](http://sourceforge.net/projects/tackle/)。大多数框架也有自己的某种形式的 ACL 实现。

即使您选择自己推出，它也会帮助您查看诸如此类的考虑周全的解决方案。

            回答 #3

赞同：7

时间：2008-12-03T11:44:36.027

您可能不需要权限组。而是创建用户组，授予用户组权限，并将用户放入组中。用户还应该能够覆盖他们所在组的权限。如果用户在多个具有权限的组中，拒绝应该总是覆盖授权。

总之：

*   用户拥有零个或多个权限（gray、deny）
*   用户在零个或多个组中
*   组具有零个或多个权限（授予、拒绝）

            回答 #4

赞同：6

时间：2008-12-02T11:16:02.467

我的结构略有不同，但应该可以作为参考。

每个用户都有一个与之关联的“角色”、“GroupID”以及 GroupID 所引用的组表。然后我有3个权限表。

```
PermissionMaster(FormName) 
```

`PermissionChild(PermissionMasterID, PermissionName, Desc, DefaultValue, DependOn)`和

```
PermissionGroupChild(GroupID, PermissionChildID, Allow) 
```

PermissionMaster 持有权限所指的名称/表单/模块。PermissionChild 将列出每个 Master 可用的所有可能权限，例如“创建”、“查看”、“编辑”、“删除”和描述（我在第一个版本中没有这个，开始变得混乱即使对于 1 个模块也有太多权限设置）。我允许添加更多子项来专门引用某些功能，例如“ChangeTimeStamp”，这也将允许比“编辑”更具体的权限

那么 PermissionGroupChild 就是 PermissionChild 和 Group 表之间的链接。每个组都将复制一组 PermissionChild 并设置为默认设置。然后我有一个权限类，它执行表查询并检查每个用户。我只在登录时加载它。然后在每个表单/模块中，我检查它的适当权限并正确应用 UI。

至于角色，我只在登录配置页面使用。较小的角色值意味着较高的排名。所以用户只能看到自己和那些角色价值高于自己的人。他/她可以编辑比自己低但不相似的那些。

            回答 #5

赞同：2

时间：2017-09-18T11:26:10.710

我有组和用户（如活动目录 LDAP 解决方案）。因此，如果我授予组访问权限，我需要该组中的用户具有继承的访问权限。

所以，根据下面的@suresh-kamrushi 回答，我做了这个：

```
INSERT INTO `permission` (`bit`, `name`) VALUES
(1,   'add-yes'),
(2,   'add-no'),
(4,   'edit-yes'),
(8,   'edit-no'),
(16,  'del-yes'),
(32,  'del-no'),
(64,  'view-yes'),
(128, 'view-no'); 
```

如果用户有 bit `00000000`，我取前两位数字`00`，这意味着`add-yes`并且`add-no`是从组权限继承而来的。

如果用户有 bit `01010110`，我取前两位数字`01`，这意味着`add-no`将优先考虑组权限，因此该用户没有添加权限。这按位表示用户只能查看。

它还与家长团体合作。

你觉得这个解决方案怎么样？有没有人有更好的方法？

        java - 如何创建一个 Linux 集群以在 java 中运行物理模拟？

ID：333626

赞同：6

时间：2008-12-02T10:58:25.997

标签：java, linux, cluster-computing, grid-computing, playstation

我正在开发一个用于执行物理模拟的科学应用程序。使用的算法是 O(n3)，因此对于大量数据需要很长时间来处理。该应用程序在大约 17 分钟内运行一次模拟，而我必须运行大约 25,000 次模拟。这大约是一年的处理时间。

好消息是模拟完全相互独立，因此我可以轻松更改程序以在多台计算机之间分配工作。

我可以看到多种解决方案来实现这一点：

*   获得一台多核计算机并在所有内核之间分配工作。不够我需要做的。
*   编写一个连接到多个“处理”服务器并在它们之间分配负载的应用程序。
*   获得一组便宜的 linux 计算机，并让程序将所有内容视为一个实体。

选项 2 相对容易实现，所以我不太会寻找如何实现它的建议（可以通过编写一个在给定端口上等待参数、处理值并返回结果的程序来完成作为序列化文件）。那将是[网格计算](http://en.wikipedia.org/wiki/Grid_computing "网格计算")的一个很好的例子。

但是，我想知道最后一个选项（传统集群）的可能性。在 linux 网格中运行 Java 程序有多难？所有独立的计算机是否都被视为具有多核的单台计算机，从而使程序适应变得容易？是否有任何好的资源指针可以让我开始？或者我让这变得过于复杂，我最好选择第 2 个选项？

编辑：作为额外信息，我对如何实现 Wired Magazine 的这篇文章中描述的内容很感兴趣：[Scientific replace a supercomputer with a Playstation 3 linux cluster](http://www.wired.com/techbiz/it/news/2007/10/ps3_supercomputer)。绝对第二听起来像是要走的路……但凉爽因素。

编辑 2：计算非常受 CPU 限制。基本上对大矩阵有很多运算，例如逆和乘法。我试图为这些操作寻找更好的算法，但到目前为止我发现我需要的操作是 0(n3) （在通常可用的库中）。数据集很大（用于此类操作），但它是根据输入参数在客户端创建的。

我现在看到我对 linux 下的计算机集群如何工作有一个误解。我的假设是，它会以这样一种方式工作，即看起来您拥有所有可用计算机中的所有处理器，就像您拥有一台具有多核的计算机一样，但情况似乎并非如此。似乎所有这些超级计算机的工作方式是让节点执行由某个中央实体分配的任务，并且有几个不同的库和软件包可以轻松执行这种分配。

所以问题真的变成了，因为没有数字 3 这样的东西：创建集群 Java 应用程序的最佳方法是什么？

            回答 #1

赞同：5

时间：2008-12-02T11:03:44.003

我强烈推荐 Java 并行处理框架，特别是因为您的计算已经是独立的。我和这个本科生做了很多工作，效果很好。实现的工作已经为您完成，所以我认为这是实现“第二”目标的好方法。

[http://www.jppf.org/](http://www.jppf.org/)

            回答 #2

赞同：3

时间：2008-12-02T11:29:53.577

3号不难做到。它需要开发两个不同的应用程序，客户端和主管。客户端几乎就是您已经拥有的，一个运行模拟的应用程序。但是，它需要进行更改，以便它使用 TCP/IP 或其他方式连接到主管并请求一组模拟参数。然后它运行模拟并将结果发送回主管。主管侦听来自客户的请求和每个请求，从数据库获取未分配的模拟并更新数据库以指示项目已分配但未完成。模拟完成后，主管用结果更新数据库。如果主管将数据存储在实际数据库（MySql 等）中，则可以轻松地在数据库中查询模拟的当前状态。

            回答 #3

赞同：2

时间：2008-12-05T20:49:29.857

在 Linux 集群上分配计算的最简单方法是使用 MPI。我建议您下载并查看 MPICH2。免费。  [他们的主页在这里](http://phase.hpcc.jp/mirrors/mpi/mpich2/)

如果您的模拟完全独立，则不需要 MPI 的大部分功能。您可能需要编写几行 C 代码来与 MPI 交互并开始执行您的脚本或 Java 程序。

            回答 #4

赞同：2

时间：2009-05-15T06:09:53.167

您应该查看[Hazelcast](http://www.hazelcast.com)，这是 Java 最简单的 peer2peer（无集中式服务器）集群解决方案。尝试使用 Hazelcast Distributed ExecutorService 在集群上执行您的代码。

问候，

-塔利普

            回答 #5

赞同：1

时间：2008-12-02T11:59:44.763

您已经提出了建议，但取消了它的资格：多核。如果你有足够的核心，你可以选择多核。一个热门话题是 GPGPU 计算。特别是。如果您有许多必须执行相同计算的独立任务，则 NVIDIA 的 CUDA 是一种非常优先的方法。GTX 280 为您提供 280 个内核，可同时计算多达 1120 - 15360 个线程。一对可以解决你的问题。如果它真正可实现取决于您的算法（数据流与控制流），因为所有标量处理器都以 SIMD 方式运行。

缺点：它将是 C/C++，而不是 java

            回答 #6

赞同：1

时间：2008-12-02T15:32:27.613

你的算法优化到什么程度？你在使用原生 BLAS 库吗？通过从幼稚的库切换到优化的库，您可以获得大约一个数量级的性能提升。一些，如 ATLAS 也会自动将计算分布在系统上的多个 CPU 上，以便自动涵盖项目符号 1。

AFAIK 集群通常不被视为单个实体。它们通常被视为单独的节点，并使用 MPI 和 SCALAPACK 之类的东西进行编程，以将矩阵的元素分布到多个节点上。如果您的数据集无论如何都适合一个节点上的内存，这并不能真正帮助您。

            回答 #7

赞同：1

时间：2009-01-27T07:44:58.963

你看过[兵马俑](http://www.terracotta.org)吗？  

对于工作分配，您需要使用[Master/Worker 框架](http://www.terracotta.org/web/display/orgsite/Master+Worker)。

            回答 #8

赞同：1

时间：2009-06-15T17:33:26.703

十年前，我工作的公司研究了一个类似的虚拟化解决方案，当时 Sun、Digital 和 HP 都支持它，但只使用具有硬件热插拔等的最先进的超级计算机。从那时起，我听说 Linux 支持您正在寻找的解决方案 #3 的虚拟化类型，但我自己从未使用过它。

Java原语和性能

但是，如果您进行矩阵计算，您希望在本机代码中进行，而不是在 Java 中（假设您使用的是 Java 原语）。尤其是缓存未命中是非常昂贵的，并且在阵列中交错会降低性能。矩阵和本机代码中的非交错内存块将为您提供大部分加速，而无需额外的硬件。

        sockets - UDP 响应

ID：333629

赞同：5

时间：2008-12-02T11:01:09.657

标签：sockets, udp, sendto

UDP 不发回任何确认，但它会发送任何响应吗？

我已经设置了客户端服务器 UDP 程序。如果我让客户端向不存在的服务器发送数据，那么客户端会收到任何响应吗？

我的假设是；

客户端 --> 广播服务器地址 (ARP) 服务器 --> 使用其 MAC 地址回复客户端 (ARP) 客户端向服务器发送数据 (UDP)

在任何情况下，客户端都只会收到 ARP 响应。如果服务器存在与否，它不会得到任何 UDP 响应？

客户端正在使用 sendto 函数发送数据。我们可以在 sendto 调用后得到错误信息。

所以我的问题是当客户没有得到任何回应时如何获得这些信息。错误代码可以从 WSAGetLastError 中获取。

我试图将数据发送到不存在的主机并且 sendto 调用成功。根据文档，它应该失败并返回值 SOCKET_ERROR。

有什么想法吗？？

            回答 #1

赞同：6

时间：2008-12-02T11:03:48.667

对于未到达目的地的 UDP 数据包，您永远不会收到错误或通知。

            回答 #2

赞同：5

时间：2011-09-15T06:53:42.627

`sendto`通话没有失败。数据报被发送到目的地。

数据报的接收者或到达它的某个路由器可能会返回错误响应（主机不可达、端口不可达、超过 TTL）。但是，`sendto`当您的系统收到该呼叫时，该呼叫将成为历史记录。一些操作系统确实提供了一种发现这种情况的方法，通常是通过`getsockopt`调用。但是由于您无论如何都不能依赖得到错误回复，因为它取决于您无法控制的网络状况，因此通常最好忽略它。

位于 UDP 之上的合理协议使用回复。如果你没有得到回复，那么要么对方没有收到你的数据报，要么没有回复给你。

            回答 #3

赞同：3

时间：2008-12-02T11:06:52.907

“UDP 是一种更简单的基于消息的无连接协议。在无连接协议中，没有努力建立专用的端到端连接。通信是通过在**一个方向上**传输信息来实现的，从源到目的地，无需检查查看如果目的地还在那里，或者它是否准备好接收信息。”

            回答 #4

赞同：3

时间：2009-06-12T00:05:24.887

您向其发送数据包的机器可能会回复 ICMP UDP 端口不可达消息。

            回答 #5

赞同：2

时间：2008-12-02T11:06:44.637

UDP 协议是在 IP 之上实现的。您将 UDP 数据包发送到由 IP 地址而非 MAC 地址标识的主机。

正如所指出的那样，UDP 本身不会发送回复，您必须自己添加代码才能做到这一点。然后您将不得不添加代码以期待回复，并在响应丢失时采取适当的措施（通常在计时器上重新发送，直到您确定另一端“死亡”），等等。

            回答 #6

赞同：1

时间：2009-06-11T23:52:36.243

如果您在订购或验证时需要可靠的 UDP，以便 TCP/IP 让您查看 RUDP 或 Reliable UDP。有时您确实需要验证，但 UDP 和 TCP 的混合可能会阻碍 TCP 可靠性，从而导致瓶颈。

对于大多数大型 MMO 来说，UDP 和可靠性 UDP 是通信和可靠性的手段。RUDP 所做的只是添加一小部分 TCP/IP 来验证和排序某些消息，但不是全部。

一个常见的游戏开发网络库是内置的 Raknet。

RUDP
 [http://www.javvin.com/protocolRUDP.html](http://www.javvin.com/protocolRUDP.html)

使用 Raknet 和 Python 的 RUDP 示例
[http://pyraknet.slowchop.com/](http://pyraknet.slowchop.com/)

        scroll - Symbian S60 - 在 CEikLabel 中滚动文本

ID：333630

赞同：1

时间：2008-12-02T11:01:13.713

标签：scroll, symbian, s60, ticker, ceiklabel

我的应用程序中有一行 CEikLabel 需要滚动文本。

想到的简单解决方案（但可能是幼稚的）就像..

```
[begin pseduo code]

 on timer.fire {
  set slightly shifted text in label
  redraw label
 }
 start timer

[end pseudo code] 
```

在每次更新时使用 CPeriodic 类作为计时器和 label.DrawDeferred()。

您认为这是最好的方法吗，每秒重绘标签两到三遍可能效率很低..但是还有其他方法吗？

谢谢 ：）

            回答 #1

赞同：1

时间：2008-12-02T11:10:22.430

我不知道是否有另一种方法可以做到，也不能说你脑海中的方法是否会效率低下。但是，您可能想看看[这个线程](http://www.newlc.com/forum/how-create-moving-text-symbain)，它讨论了与您的问题几乎相同的问题，并且还简要提到了与您构想的解决方案有些相同的解决方案。

            回答 #2

赞同：1

时间：2008-12-02T11:47:59.110

我已经看到用于在列表框中滚动项目名称的基于计时器的解决方案。

需要注意的几件事是它在滚动时可能会闪烁，并且您需要确保放在标签上的文本不会太长，否则它会自动剪切字符串并添加省略号 (.. .)

用于`TextUtils::ClipToFit`获取适合标签的字符串并在将文本放在标签上之前删除它添加的省略号（`KTextUtilClipEndChar`在您剪切的字符串中搜索）。在将字符串传递给剪辑函数之前，您需要计算在字符串的开头要跳过多少个字符。

            回答 #3

赞同：1

时间：2008-12-04T09:45:24.753

我已经这样做了

```
TTimeIntervalMicroSeconds32 scrolltime(70000);
iPeriodicScroll = CPeriodic::NewL(CActive::EPriorityIdle);
iPeriodicScroll->Start(scrolltime, scrolltime, TCallBack(CVisTagContainerView::ScrollTextL, this)); 
```

然后在重复的函数中

```
CEikLabel *label = iContainer->Label();
const TDesC16 *temp = label->Text();
if (temp->Length() <= 0) { 
    if (iTextState != ETextIdle) { return; }
    DownloadMoreTextL();
    return;
}
TPtrC16 right = temp->Right(temp->Length()-1);
label->SetTextL(right);
label->DrawDeferred(); 
```

所以文本从右向左移动，当全部消失时，标签由 DownloadMoreTextL 重新填充

        iis - 经典 ASP“停机维护”页面

ID：333632

赞同：2

时间：2008-12-02T11:02:27.297

标签：iis, ms-access, asp-classic

我正在对传统的经典 ASP 应用程序进行一些更改。我已经在本地进行了更改，现在我想将更改的文件复制到服务器。同时我需要下载Access数据库，给一些表添加一些字段，然后重新上传。出于这个原因，我需要能够在这种情况发生时阻止访问者修改数据库。

我的主要问题是，设置快速“停机维护”页面的最佳方式是什么，无论访问者请求哪个页面，该页面都会立即显示。该应用程序已经建立，所以我宁愿一个不需要我重新设计应用程序架构的答案。

我的第二个问题（也许这应该是一个单独的问题）：有没有更好的方法将字段添加到数据库表而不是将其复制下来、修改并再次粘贴？如果这是一个愚蠢的问题，请原谅-我是 ASP 新手-Windows 也是新手。

我只有 FTP 访问远程服务器。

谢谢。

            回答 #1

赞同：5

时间：2008-12-11T02:57:32.763

两种方式：
1
如果您在每个 asp 页面中进行服务器端包含，则可以在该包含中执行 response.redirect 到 /upgrading.html
2
在 global.asa 中，您可以在开始事件的会话中执行 response.redirect。这可能是最好的方法。仅适用于 .asp 页面，而不适用于客户端访问 .html 页面。

            回答 #2

赞同：3

时间：2009-01-29T11:07:47.007

您是否有任何控制面板访问该站点的权限？

当我过去运行多个 ASP Classic 站点时，我经常将它们关闭五分钟以完成我需要的操作。

我知道对你的访客很粗鲁。

正如其他人所说，您可以重定向到页面，但这不会阻止人们访问 html 页面中的静态内容，但这可能并不重要，至少它可以阻止他们在下载 mdb 时对其进行更改。

可惜 ASP.net 的 app_offline.htm 不适用于 ASP classic。

我曾经使用的另一个选项是创建一个包含脱机消息的 default.htm 文件，而 IIS 的设置方式 default.htm 覆盖了 default.asp，因此只需上传 default.htm 即可更改主页。这当然不会阻止任何人使用任何其他 .asp 页面。

所以没有真正的答案！对不起。

            回答 #3

赞同：2

时间：2008-12-02T11:20:26.997

如果您只有对服务器的 FTP 访问权限（并且无法控制 IIS），只需将 response.redirect 插入到所有 asp 页面顶部的“down for maintenace”页面，并在更新完成后将其删除。

可以使用 ALTER TABLE 语句对数据库进行更改。

            回答 #4

赞同：0

时间：2008-12-02T15:01:04.117

关于“Down Maintanance”页面问题，如果每个页面中都有一个包含文件（用于标题），您可以将 mapache 的想法更进一步，您可以将 Response.Redirect 放入该文件并将其上传到地方。这将避免对所有页面进行更改。

另一种选择是上传一个临时 html 文件，该文件将首先由 IIS 找到。在 IIS 中，您可以设置在域/文件夹中查找哪个页面 name.ext。例如，当您浏览 www.example.com 时，您没有指定要查找的页面，因此它可以加载 index.html 或 index.htm，例如取决于设置。这将取决于您的主机配置设置，但经过一些反复试验，我相信您可以找出他们使用的是哪一个。IIS 常用的有 default.htm、default.html、index.html 和 index.htm。然后，您可以将它放在网站的每个文件夹中（我知道这不太理想），然后进行维护。

更新数据库时，您可以运行用 sql 编写的迁移脚本来更新数据库的模式和数据。由于您只有 FTP 访问权限，这将需要某种页面，您可以将 sql 粘贴到并运行。然而，这会带来安全问题，因此下载数据库、进行更改然后再次上传可能更容易。除了这样做之外，您还可以保存文件并且您将有一个备份:-)

希望这可以帮助。

            回答 #5

赞同：0

时间：2009-09-18T00:14:36.613

比包含文件更好，只需使用 Global.asa。

在 Global.asa 的 Application_onStart 中，添加   

```
Application("Offline")= True 
```

在所有 ASP 文件的顶部，添加

```
If VarType(Application("Offline")) = vbBoolean Then If Application("Offline") Then Response.Redirect "App_Offline.htm" 
```

（double-if 解决了缺少 VBScript 的短路操作符的问题，因此会出现任何数据类型错误。）

您甚至可以将 Global.asa 代码设置为

```
Set fso= Server.CreateObject("Scripting.FileSystemObject")
Application("Offline")= fso.FileExists(Server.MapPath("App_Offline.htm"))
Set fso= Nothing 
```

如果存在，它将启用脱机页面，例如 ASP.NET。但是，只有在服务器重置（使用 iisreset）或修改 Global.asa 文件时，才会重新解析应用程序启动代码，仅添加 App_Offline.htm 是不够的。

            回答 #6

赞同：0

时间：2017-12-18T11:52:25.917

在 web.config 中添加以下代码
    `
    <?xml version="1.0"?>
    <configuration>
        <system.webServer>
          <modules runAllManagedModulesForAllRequests="true" />
        </system.webServer>
    </configuration>`

并将 app_offline 放在根文件夹下。这将起作用。  

        javascript - Javascript/Ajax 中的 HTTP HEAD 请求？

ID：333634

赞同：62

时间：2008-12-02T11:02:37.237

标签：javascript, ajax, http-headers, xmlhttprequest

是否可以仅使用 JavaScript 中的 XMLHTTPRequest 来执行 HTTP Head 请求？

我的动机是节省带宽。

如果没有，是否可以伪造？

            回答 #1

赞同：105

时间：2008-12-02T11:11:41.367

很简单，只需使用 HEAD 方法，而不是 GET 或 POST：

```
function UrlExists(url, callback)
{
    var http = new XMLHttpRequest();
    http.open('HEAD', url);
    http.onreadystatechange = function() {
        if (this.readyState == this.DONE) {
            callback(this.status != 404);
        }
    };
    http.send();
} 
```

这只是一个简短的例子来展示如何使用 HEAD 方法。生产代码可能需要针对不同的结果状态（成功、失败、超时）进行更细粒度的回调，并且可能使用不同的[事件处理程序](http://www.w3.org/TR/XMLHttpRequest2/#event-handlers)（`onload`，`onerror`而`ontimeout`不是`onreadystatechange`）。

            回答 #2

赞同：-4

时间：2008-12-02T11:12:24.377

一个 XMLHTTPRequest 对象应该有

```
getAllResponseHeaders();
getResponseHeader("header-name") 
```

在它上面定义

        .net - 哪个是 google maps api 的最佳 .net 库？

ID：333635

赞同：1

时间：2008-12-02T11:02:43.100

标签：.net, google-maps

我需要一个最新且易于使用的 .net 谷歌地图包装器。

            回答 #1

赞同：4

时间：2008-12-02T12:17:11.920

[Googlemap 控件](http://www.codeplex.com/googlemap)
将 Google Maps API 包装为 ASP.NET 自定义控件。提供在您的 ASP.NET 页面上添加 Google Maps API 支持的极其简单快捷的方式。

            回答 #2

赞同：1

时间：2008-12-02T11:10:55.160

如果你想在你的应用程序中使用谷歌地图，那么你很可能不得不对他们使用 JavaScript的[谷歌地图 API感到厌烦。](http://code.google.com/apis/maps/index.html)不过也不是很糟糕，[文档](http://code.google.com/apis/maps/documentation/reference.html)非常全面，而且还有一个活跃的[Google 群组](http://groups.google.com/group/Google-Maps-API)。

如果您真的想要一个用于映射解决方案的 ASP.Net 服务器控件，那么您也可以尝试[Microsoft 提供的](http://msdn.microsoft.com/en-us/library/cc788749.aspx).

            回答 #3

赞同：0

时间：2020-04-30T20:47:05.720

Google Maps API 的 .NET 包装器库（API 包装器，但不是用于显示地图的控件）：

1.  [谷歌API](https://github.com/vivet/GoogleApi)
2.  [谷歌地图](https://github.com/maximn/google-maps)

[https://stackoverflow.com/a/61531795](https://stackoverflow.com/a/61531795)

        events - Visio 选定页面事件

ID：333641

赞同：0

时间：2008-12-02T11:05:43.047

标签：events, visio

当 Visio 文档中的选定（活动）页面发生更改时，我想做一些事情。有什么方法可以做到这一点吗？

谢谢。

            回答 #1

赞同：0

时间：2008-12-03T12:13:38.497

得到解决方案...

它可以通过处理由 Window 对象触发的 WindowTurnedToPage 事件来完成。

        c# - 如何运行仅知道她的完全限定名的任何方法

ID：333655

赞同：0

时间：2008-12-02T11:11:17.577

标签：c#, reflection, methods

我有一个方法的名称：“Garden.Plugins.Code.Beta.Business.CalculateRest”

如何运行它？我想到了这个基于反射的奇特解决方案，例如 RunMethod(string MethodName)

            回答 #1

赞同：3

时间：2008-12-02T11:19:03.753

*   通过在最后一个点上拆分将其拆分为类型名称和方法名称
*   使用[Type.GetType](http://msdn.microsoft.com/en-us/library/system.type.gettype.aspx)或[Assembly.GetType](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.gettype.aspx)获取类型。（Type.GetType 只会在当前执行的程序集和 mscorlib 中查找，除非您在参数中指定程序集名称。）
*   [使用Type.GetMethod](http://msdn.microsoft.com/en-us/library/system.type.getmethod.aspx)从类型中获取方法。假设它是一个公共静态方法，请指定`BindingFlags.Public | BindingFlags.Static`.
*   通过调用[MethodInfo.Invoke](http://msdn.microsoft.com/en-us/library/system.reflection.methodinfo.invoke.aspx) (null, null) 来执行方法。（第一个 null 指定“无目标” - 即它是一个静态方法；第二个指定没有参数。）

如果你想调用一个实例方法或一个带参数的方法，你也需要弄清楚如何获取这些信息。

            回答 #2

赞同：2

时间：2008-12-02T12:12:58.107

这并不像将最后一个点左侧的所有内容都视为文字类型名那么简单。如果您有一种类型的表格：

XYZ型

那么 X、Y 和 Z 不一定是命名空间。它们本身也可以是类型，后续部分可以是内部类：

```
class X
{
  class Y
  {
   // etc
  }
} 
```

如果是这种情况，则 Type.GetType("X.YU") 不会解析为 Y 类。相反，clr 用 + 符号分隔内部类，因此您实际上需要调用 Type.GetType("X+ Y");

如果您调用的方法是**params**方法，那么您需要做一些额外的工作。您需要将变量参数向上滚动到一个数组中并传递它。**您可以通过获取方法的ParameterInfo**数据并查看最后一个参数是否附加了**ParamArray**属性来检查可变参数。

            回答 #3

赞同：1

时间：2008-12-02T11:14:02.517

它会很慢，相信我。所以不要把它放在关键的地方。

除此之外，您只需要“手动”完成。开始枚举所有命名空间、类等，直到找到所需内容。我不认为已经有任何花哨的预制可以做到这一点。（虽然我没搜过）

            回答 #4

赞同：1

时间：2008-12-02T11:47:44.587

如果类型是实例类型：

```
Type.GetType("Garden.Plugins.Code.Beta.Business")
    .GetMethod("CalculateRest").Invoke(myInstanceOfTheType, param1, param2); 
```

如果是静态方法：

```
Type.GetType("Garden.Plugins.Code.Beta.Business")
    .GetMethod("CalculateRest").Invoke(null, param1, param2); 
```

如果它不带参数，就不用“param1, param2, etc”...

        asp.net - 报告网站架构

ID：333662

赞同：0

时间：2008-12-02T11:13:55.403

标签：asp.net, architecture

我之前在这个问题中提到过这个项目，但是重新设计的范围已经稍微收紧了，即我不能重新设计整个东西，所以我想要一些关于如何构建现有人工制品的一般性建议应用程序作为改进设计的增量步骤。

1.  该站点有两个功能领域，即报告和维护。这是网站的主要功能，不是数据操作，而只是展示。该站点包含少量维护页面，这些页面使用标准 GridView 和 FormView 来维护一小部分数据。这就是为什么我决定不使用丰富、复杂的 DAL 来支持 Enterprise Library DAAB 和普通数据集。

2.  每个报表都是一个独立的页面，它使用动态 SQL 查询的结果来显式呈现报表的 HTML 表行。为了不为每个报告维护一组 mySQL 和 MSSQL 查询，我将把所有数据访问移至存储过程，通过 DAAB 消除与任一数据库引擎的耦合。

3.  我正在寻找报告工具来将报告结构定义与报告演示分离。我不想像 Telerik 报告那样在类中定义报告结构，但还没有研究其他报告工具。

4.  所有报告共享一个通用过滤器页面，该页面在从菜单中选择报告时显示，一旦用户对他们的过滤器选择感到满意，该页面将重定向到所选报告。对于我似乎必须不断改造的这种非常常见的情况，是否有任何可用的指导？  

我正在寻找有关如何将其转向更好的结构化产品的一般建议，而无需实际重组整个项目。简单的东西，例如将维护页面与子目录中的报告页面分开等。  

我不是在寻找其他人来做我的工作，并且在适当的时候会实施我自己所做的许多改进，但我希望能就其他人如何处理这样的项目提出一般意见。

            回答 #1

赞同：1

时间：2008-12-02T12:35:24.507

为了呈现基于事实数据库的报告，我将研究已经实现所有核心功能的工具之一，例如 BIRT（我确信有一些 .NET 替代品）。您可能认为一张数据表足以让聪明的人解析，但最终有人会要求提供图表和 PDF。

维护/管理页面可以是标准网站 - 表单和后端，使用您熟悉的任何框架。

从架构上讲，您是要针对实时数据库还是存档数据库（或故障转移/复制数据库）运行报告？

您是在生成聚合数据表（事实表）以从中生成报告，还是针对更复杂的主模式运行？

            回答 #2

赞同：0

时间：2009-03-02T14:30:19.367

我将使用 DevExpress ASPxGridView 使用报表元数据管理系统，为每页报表系统提供简单的目录结构。此网格完全能够满足此应用程序的报告需求。

我将把维护和管理实现为标准的 Web 表单，为大多数报告使用共享过滤器表单，根据报告元数据动态配置。报表不会有运行时维护，因为添加报表需要添加页面。这是可以接受的，因为维护不频繁。

        php - 如何实现基本的“长轮询”？

ID：333664

赞同：798

时间：2008-12-02T11:14:47.553

标签：php, http, comet

我可以找到很多关于长轮询如何工作的信息（例如[this](http://jfarcand.wordpress.com/2007/05/15/new-adventures-in-comet-polling-long-polling-or-http-streaming-with-ajax-which-one-to-choose/)和[this](http://en.wikipedia.org/wiki/Comet_(programming)#Ajax_with_long_polling)），但没有关于如何在代码中实现它的*简单示例。*

我能找到的只有[cometd](http://code.google.com/p/cometd/)，它依赖于 Dojo JS 框架和一个相当复杂的服务器系统。

基本上，我将如何使用 Apache 来处理请求，以及我将如何编写一个简单的脚本（例如，在 PHP 中）来“长轮询”服务器以获取新消息？

该示例不必是可扩展的、安全的或完整的，它只需要工作！

            回答 #1

赞同：521

时间：2008-12-02T13:15:17.123

它比我最初想象的要简单.. 基本上你有一个页面什么都不做，直到你想要发送的数据可用（比如，一条新消息到达）。

这是一个非常基本的示例，它在 2-10 秒后发送一个简单的字符串。返回错误 404 的几率为三分之一（在接下来的 Javascript 示例中显示错误处理）

`msgsrv.php`

```
<?php
if(rand(1,3) == 1){
    /* Fake an error */
    header("HTTP/1.0 404 Not Found");
    die();
}

/* Send a string after a random number of seconds (2-10) */
sleep(rand(2,10));
echo("Hi! Have a random number: " . rand(1,10));
?> 
```

注意：对于一个真实的站点，在像 Apache 这样的常规 Web 服务器上运行它会很快占用所有“工作线程”，使其无法响应其他请求。有一些方法可以解决这个问题，但建议编写类似 Python 的[twisted](http://twistedmatrix.com/trac/)的“长轮询服务器”，每个请求不依赖一个线程。[cometD](http://cometdproject.dojotoolkit.org/)是一种流行的框架（有多种语言版本），而[Tornado](http://www.tornadoweb.org/)是专门为此类任务而设计的新框架（它是为 FriendFeed 的长轮询代码构建的）......但作为一个简单的例子， A​​pache 绰绰有余！这个脚本可以很容易地用任何语言编写（我选择了 Apache/PHP，因为它们很常见，而且我碰巧在本地运行它们）

然后，在 Javascript 中，您请求上述文件 ( `msg_srv.php`)，并等待响应。当你得到一个时，你就根据数据采取行动。然后你请求文件并再次等待，对数据采取行动（并重复）

下面是这样一个页面的示例。当页面加载时，它会发送对`msgsrv.php`文件的初始请求。如果成功，我们将消息附加到`#messages`div，然后在 1 秒后我们再次调用 waitForMsg 函数，这触发了等待。

1 秒`setTimeout()`是一个非常基本的速率限制器，没有它它可以正常工作，但如果`msgsrv.php` *总是*立即返回（例如语法错误） - 你淹没浏览器并且它可以很快冻结。最好检查文件是否包含有效的 JSON 响应，和/或保持每分钟/秒的请求总数，并适当地暂停。

如果页面出错，它会将错误附加到`#messages`div，等待 15 秒然后重试（与我们在每条消息后等待 1 秒的方式相同）

这种方法的好处是它非常有弹性。如果客户端 Internet 连接中断，它将超时，然后尝试重新连接 - 这是轮询工作时间长短所固有的，不需要复杂的错误处理

无论如何，`long_poller.htm`使用jQuery框架的代码：

```
<html>
<head>
    <title>BargePoller</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js" type="text/javascript" charset="utf-8"></script>

    <style type="text/css" media="screen">
      body{ background:#000;color:#fff;font-size:.9em; }
      .msg{ background:#aaa;padding:.2em; border-bottom:1px #000 solid}
      .old{ background-color:#246499;}
      .new{ background-color:#3B9957;}
    .error{ background-color:#992E36;}
    </style>

    <script type="text/javascript" charset="utf-8">
    function addmsg(type, msg){
        /* Simple helper to add a div.
        type is the name of a CSS class (old/new/error).
        msg is the contents of the div */
        $("#messages").append(
            "<div class='msg "+ type +"'>"+ msg +"</div>"
        );
    }

    function waitForMsg(){
        /* This requests the url "msgsrv.php"
        When it complete (or errors)*/
        $.ajax({
            type: "GET",
            url: "msgsrv.php",

            async: true, /* If set to non-async, browser shows page as "Loading.."*/
            cache: false,
            timeout:50000, /* Timeout in ms */

            success: function(data){ /* called when request to barge.php completes */
                addmsg("new", data); /* Add response to a .msg div (with the "new" class)*/
                setTimeout(
                    waitForMsg, /* Request next message */
                    1000 /* ..after 1 seconds */
                );
            },
            error: function(XMLHttpRequest, textStatus, errorThrown){
                addmsg("error", textStatus + " (" + errorThrown + ")");
                setTimeout(
                    waitForMsg, /* Try again after.. */
                    15000); /* milliseconds (15seconds) */
            }
        });
    };

    $(document).ready(function(){
        waitForMsg(); /* Start the inital request */
    });
    </script>
</head>
<body>
    <div id="messages">
        <div class="msg old">
            BargePoll message requester!
        </div>
    </div>
</body>
</html> 
```

            回答 #2

赞同：41

时间：2008-12-03T21:08:11.613

[作为slosh](http://github.com/dustin/slosh)的一部分，我有一个非常简单的聊天示例。

**编辑**：（因为每个人都在这里粘贴他们的代码）

[这是使用 long-polling 和slosh](http://github.com/dustin/slosh)的完整的基于 JSON 的多用户聊天。这是一个如何进行调用的**演示，所以请忽略 XSS 问题。**如果不先对其进行清理，任何人都不应部署它。

请注意，客户端*始终*与服务器建立连接，并且一旦有人发送消息，每个人都应该大致立即看到它。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- Copyright (c) 2008 Dustin Sallings <dustin+html@spy.net> -->
<html lang="en">
  <head>
    <title>slosh chat</title>
    <script type="text/javascript"
      src="http://code.jquery.com/jquery-latest.js"></script>
    <link title="Default" rel="stylesheet" media="screen" href="style.css" />
  </head>

  <body>
    <h1>Welcome to Slosh Chat</h1>

    <div id="messages">
      <div>
        <span class="from">First!:</span>
        <span class="msg">Welcome to chat. Please don't hurt each other.</span>
      </div>
    </div>

    <form method="post" action="#">
      <div>Nick: <input id='from' type="text" name="from"/></div>
      <div>Message:</div>
      <div><textarea id='msg' name="msg"></textarea></div>
      <div><input type="submit" value="Say it" id="submit"/></div>
    </form>

    <script type="text/javascript">
      function gotData(json, st) {
        var msgs=$('#messages');
        $.each(json.res, function(idx, p) {
          var from = p.from[0]
          var msg = p.msg[0]
          msgs.append("<div><span class='from'>" + from + ":</span>" +
            " <span class='msg'>" + msg + "</span></div>");
        });
        // The jQuery wrapped msgs above does not work here.
        var msgs=document.getElementById("messages");
        msgs.scrollTop = msgs.scrollHeight;
      }

      function getNewComments() {
        $.getJSON('/topics/chat.json', gotData);
      }

      $(document).ready(function() {
        $(document).ajaxStop(getNewComments);
        $("form").submit(function() {
          $.post('/topics/chat', $('form').serialize());
          return false;
        });
        getNewComments();
      });
    </script>
  </body>
</html> 
```

            回答 #3

赞同：32

时间：2011-03-04T14:53:01.773

[Tornado](http://www.tornadoweb.org/)是为长轮询而设计的，并且在 / **examples/chatdemo**中包含一个非常小的（几百行 Python）[聊天应用程序](https://github.com/facebook/tornado/blob/stable/demos/chat/chatdemo.py)，包括服务器代码和 JS 客户端代码。它是这样工作的： *   客户端使用 JS 请求更新，因为（最后一条消息的数量），服务器 URLHandler 接收这些并添加回调以响应客户端到队列。

*   当服务器收到一条新消息时，onmessage 事件触发，循环通过回调，并发送消息。

*   客户端 JS 接收消息，将其添加到页面，然后请求更新，因为有了这个新的消息 ID。

* * *

## 回答 #4

> 赞同：25
> 
>             
> 
> 时间：2008-12-02T11:39:37.927

我认为客户端看起来像一个普通的异步 AJAX 请求，但您希望它需要“很长时间”才能回来。

然后服务器看起来像这样。

```
while (!hasNewData())
    usleep(50);

outputNewData(); 
```

因此，AJAX 请求发送到服务器，可能包括上次更新时间的时间戳，以便您`hasNewData()`知道您已经获得了哪些数据。然后服务器处于循环休眠状态，直到有新数据可用。一直以来，您的 AJAX 请求仍处于连接状态，只是挂在那里等待数据。最后，当有新数据可用时，服务器会将其提供给您的 AJAX 请求并关闭连接。

* * *

## 回答 #5

> 赞同：17
> 
>             
> 
> 时间：2011-09-01T14:20:00.500

[**以下**](https://stackoverflow.com/a/7271441/429949)是我在 C# 中用于长轮询的一些类。基本上有6个类（见下文）。

1.  **控制器**：处理创建有效响应所需的操作（数据库操作等）

2.  **处理器**：管理与网页（本身）的异步通信

3.  **IAsynchProcessor**：实现此接口的服务进程实例

4.  **服务：处理实现IAsynchProcessor**的请求对象

5.  **Request**：包含您的响应（对象）的 IAsynchProcessor 包装器

6.  **响应**：包含自定义对象或字段

* * *

## 回答 #6

> 赞同：15
> 
>             
> 
> 时间：2009-10-20T15:41:38.513

这是一个不错的 5 分钟截屏视频，介绍如何使用 PHP 和 jQuery 进行长轮询：http:
 [//screenr.com/SNH](http://screenr.com/SNH)

**代码与上面dbr**的示例非常相似。

* * *

## 回答 #7

> 赞同：12
> 
>             
> 
> 时间：2012-12-08T12:23:13.797

这是Erik Dubbelboer 在 PHP 中使用标头[的一个简单的长轮询示例](http://blog.dubbelboer.com/2012/01/08/x-mixed-replace.html)`Content-type: multipart/x-mixed-replace`：

```
<?

header('Content-type: multipart/x-mixed-replace; boundary=endofsection');

// Keep in mind that the empty line is important to separate the headers
// from the content.
echo 'Content-type: text/plain

After 5 seconds this will go away and a cat will appear...
--endofsection
';
flush(); // Don't forget to flush the content to the browser.

sleep(5);

echo 'Content-type: image/jpg

';

$stream = fopen('cat.jpg', 'rb');
fpassthru($stream);
fclose($stream);

echo '
--endofsection
'; 
```

这是一个演示：

[http://dubbelboer.com/multipart.php](http://dubbelboer.com/multipart.php)

* * *

## 回答 #8

> 赞同：11
> 
>             
> 
> 时间：2008-12-02T11:21:34.467

我用[它](http://ajaxian.com/archives/comet-with-php)来掌握 Comet，我还使用 Java Glassfish 服务器设置了 Comet，并通过订阅 cometdaily.com 找到了许多其他示例

* * *

## 回答 #9

> 赞同：9
> 
>             
> 
> 时间：2009-11-19T17:36:45.440

看看[这篇博文，其中包含 Python/Django/](http://blog.gevent.org/2009/10/10/simpler-long-polling-with-django-and-gevent/) [gevent](http://www.gevent.org)中的简单聊天应用程序的代码。

* * *

## 回答 #10

> 赞同：9
> 
>             
> 
> 时间：2011-04-21T03:25:00.950

下面是我为 Inform8 Web 开发的一个长轮询解决方案。基本上，您重写该类并实现 loadData 方法。当 loadData 返回值或操作超时时，它将打印结果并返回。

如果您的脚本处理时间可能超过 30 秒，您可能需要将 set_time_limit() 调用更改为更长的时间。

阿帕奇 2.0 许可证。github 上的最新版本 
[https://github.com/ryanhend/Inform8/blob/master/Inform8-web/src/config/lib/Inform8/longpoll/LongPoller.php](https://github.com/ryanhend/Inform8/blob/master/Inform8-web/src/config/lib/Inform8/longpoll/LongPoller.php)

瑞安

```
abstract class LongPoller {

  protected $sleepTime = 5;
  protected $timeoutTime = 30;

  function __construct() {
  }

  function setTimeout($timeout) {
    $this->timeoutTime = $timeout;
  }

  function setSleep($sleep) {
    $this->sleepTime = $sleepTime;
  }

  public function run() {
    $data = NULL;
    $timeout = 0;

    set_time_limit($this->timeoutTime + $this->sleepTime + 15);

    //Query database for data
    while($data == NULL && $timeout < $this->timeoutTime) {
      $data = $this->loadData();
      if($data == NULL){

        //No new orders, flush to notify php still alive
        flush();

        //Wait for new Messages
        sleep($this->sleepTime);
        $timeout += $this->sleepTime;
      }else{
        echo $data;
        flush();
      }
    }

  }

  protected abstract function loadData();

} 
```

* * *

## 回答 #11

> 赞同：9
> 
>             
> 
> 时间：2014-04-09T17:54:34.870

这是 PHP 非常糟糕的选择之一。如前所述，您可以非常快速地捆绑所有 Apache 工作人员来执行类似的操作。PHP 是为启动、执行、停止而构建的。它不是为启动、等待...执行、停止而构建的。你会很快让你的服务器陷入瘫痪，并发现你有令人难以置信的扩展问题。

也就是说，您仍然可以使用 PHP 执行此操作，并且不会使用 nginx HttpPushStreamModule 杀死您的服务器：[http ://wiki.nginx.org/HttpPushStreamModule](http://wiki.nginx.org/HttpPushStreamModule)

您在 Apache（或其他任何东西）前面设置 nginx，它将负责保持打开的并发连接。您只需通过将数据发送到内部地址来响应有效负载，您可以使用后台作业执行此操作，或者只是将消息发送给在新请求进入时等待的人。这可以防止 PHP 进程在长时间轮询期间保持打开状态。

这不是 PHP 独有的，可以使用带有任何后端语言的 nginx 来完成。并发打开连接负载等于 Node.js，所以最大的好处是它让你摆脱了类似这样的需要节点。

您会看到很多其他人提到其他语言库来完成长轮询，这是有充分理由的。PHP 只是不适合这种类型的行为。

* * *

## 回答 #12

> 赞同：8
> 
>             
> 
> 时间：2009-09-15T12:30:50.177

感谢您的代码，**dbr**。*只是long_poller.htm*中的一个小错字

```
1000 /* ..after 1 seconds */ 
```

我认为应该是

```
"1000"); /* ..after 1 seconds */ 
```

让它工作。

对于那些感兴趣的人，我尝试了一个 Django 等价物。启动一个新的 Django 项目，例如***lp***进行长轮询：

```
django-admin.py startproject lp 
```

为消息服务器调用应用程序***msgsrv ：***

```
python manage.py startapp msgsrv 
```

将以下行添加到*settings.py*以获得***模板***目录：

```
import os.path
PROJECT_DIR = os.path.dirname(__file__)
TEMPLATE_DIRS = (
    os.path.join(PROJECT_DIR, 'templates'),
) 
```

*在urls.py*中定义您的 URL 模式，如下所示：

```
from django.views.generic.simple import direct_to_template
from lp.msgsrv.views import retmsg

urlpatterns = patterns('',
    (r'^msgsrv\.php$', retmsg),
    (r'^long_poller\.htm$', direct_to_template, {'template': 'long_poller.htm'}),
) 
```

msgsrv/ *views.py*应该如下所示：

```
from random import randint
from time import sleep
from django.http import HttpResponse, HttpResponseNotFound

def retmsg(request):
    if randint(1,3) == 1:
        return HttpResponseNotFound('<h1>Page not found</h1>')
    else:
        sleep(randint(2,10))
        return HttpResponse('Hi! Have a random number: %s' % str(randint(1,10))) 
```

最后，templates/ *long_poller.htm*应该和上面的一样，并纠正了错字。希望这可以帮助。

* * *

## 回答 #13

> 赞同：4
> 
>             
> 
> 时间：2014-01-16T13:47:58.957

为什么不考虑 Web 套接字而不是长轮询？它们非常高效且易于设置。但是，它们仅在现代浏览器中受支持。这是一个[**快速参考**](https://stackoverflow.com/questions/10028770/html5-websocket-vs-long-polling-vs-ajax)。

* * *

## 回答 #14

> 赞同：3
> 
>             
> 
> 时间：2011-04-20T01:51:06.610

WS-I 小组发布了一个名为[“Reliable Secure Profile”](http://www.ws-i.org/deliverables/workinggroup.aspx?wg=reliablesecure)的东西，它有一个 Glass Fish 和[.NET 实现](http://msdn.microsoft.com/en-us/library/ee818238.aspx)，显然可以很好地[互操作](http://msdn.microsoft.com/en-us/library/ff842400.aspx#requestResponse)。

运气好的话，那里也有一个[Javascript](https://stackoverflow.com/questions/5724558/is-there-a-javascript-implementation-for-ws-i-reliable-secure-profile)实现。

还有一个使用[HTTP Duplex 的 Silverlight 实现。](http://msdn.microsoft.com/en-us/library/cc645027%28v=vs.95%29.aspx)  您可以[将 javascript 连接到 Silverlight](https://stackoverflow.com/questions/5449642/http-push-comet-reverse-ajaxusing-silverlight-to-javascript-bridge)对象以在推送发生时获取回调。

还有[商业付费版本](https://stackoverflow.com/questions/5427681/how-do-modern-implementations-of-comet-reverse-ajax-work-any-stable-c-wcf-or-as)。

* * *

## 回答 #15

> 赞同：2
> 
>             
> 
> 时间：2012-02-09T17:14:13.853

对于 ASP.NET MVC 实现，请查看[NuGet 上提供](http://nuget.org/packages/SignalR)的 SignalR 。请注意，NuGet 通常与 Git 源代码相比已过时，[Git 源代码](https://github.com/SignalR)提交非常频繁。

[在 Scott Hanselman](http://www.hanselman.com/blog/AsynchronousScalableWebApplicationsWithRealtimePersistentLongrunningConnectionsWithSignalR.aspx)的博客上阅读有关 SignalR 的更多信息 

* * *

## 回答 #16

> 赞同：2
> 
>             
> 
> 时间：2013-10-01T02:19:56.673

您可以尝试使用 libevent 构建的 C1000K C++ 彗星服务器 icomet（[https://github.com/ideawu/icomet](https://github.com/ideawu/icomet)）。icomet 还提供了一个 JavaScript 库，使用起来很简单

```
var comet = new iComet({
    sign_url: 'http://' + app_host + '/sign?obj=' + obj,
    sub_url: 'http://' + icomet_host + '/sub',
    callback: function(msg){
        // on server push
        alert(msg.content);
    }
}); 
```

icomet 支持广泛的浏览器和操作系统，包括 Safari（iOS、Mac）、IE（Windows）、Firefox、Chrome 等。

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2018-04-24T13:15:12.830

最简单的 NodeJS

```
const http = require('http');

const server = http.createServer((req, res) => {
  SomeVeryLongAction(res);
});

server.on('clientError', (err, socket) => {
  socket.end('HTTP/1.1 400 Bad Request\r\n\r\n');
});

server.listen(8000);

// the long running task - simplified to setTimeout here
// but can be async, wait from websocket service - whatever really
function SomeVeryLongAction(response) {
  setTimeout(response.end, 10000);
} 
```

Express 中的生产明智场景，例如，您将`response`在中间件中获得。你需要做什么，可以将所有长轮询方法的范围限定为 Map 或其他东西（对其他流可见），并`<Response> response.end()`在你准备好时调用。长轮询连接没有什么特别之处。休息就是您通常如何构建应用程序的方式。

如果你不知道我所说的范围是什么意思，这应该给你一个想法

```
const http = require('http');
var responsesArray = [];

const server = http.createServer((req, res) => {
  // not dealing with connection
  // put it on stack (array in this case)
  responsesArray.push(res);
  // end this is where normal api flow ends
});

server.on('clientError', (err, socket) => {
  socket.end('HTTP/1.1 400 Bad Request\r\n\r\n');
});

// and eventually when we are ready to resolve
// that if is there just to ensure you actually 
// called endpoint before the timeout kicks in
function SomeVeryLongAction() {
  if ( responsesArray.length ) {
    let localResponse = responsesArray.shift();
    localResponse.end();
  }
}

// simulate some action out of endpoint flow
setTimeout(SomeVeryLongAction, 10000);
server.listen(8000); 
```

如您所见，您可以真正响应所有连接，一个，随心所欲。每个`id`请求都有，因此您应该能够使用 map 并访问特定的 api 调用。

# javascript - 如何防止关闭浏览器窗口？

> ID：333665
> 
>         
> 
> 赞同：58
> 
>         
> 
> 时间：2008-12-02T11:14:48.787
> 
>         
> 
> 标签：javascript, browser, window, onbeforeunload

我尝试使用以下代码在关闭浏览器窗口时获得警报：

```
window.onbeforeunload = confirmExit;
function confirmExit() {
  return "You have attempted to leave this page.  If you have made any changes to the fields without clicking the Save button, your changes will be lost.  Are you sure you want to exit this page?";
} 
```

它可以工作，但如果页面包含一个超链接，单击该超链接会引发相同的警报。仅当我关闭浏览器窗口而不是单击超链接时才需要显示警报。

* * *

## 回答 #1

> 赞同：51
> 
>             
> 
> 时间：2008-12-02T11:20:11.037

另一个实现如下，您可以在此网页中找到它：http:
 [//ujap.de/index.php/view/JavascriptCloseHook](http://ujap.de/index.php/view/JavascriptCloseHook)

```
<html>
  <head>
    <script type="text/javascript">
      var hook = true;
      window.onbeforeunload = function() {
        if (hook) {
          return "Did you save your stuff?"
        }
      }
      function unhook() {
        hook=false;
      }
    </script>
  </head>
  <body>
    <!-- this will ask for confirmation: -->
    <a href="http://google.com">external link</a>

    <!-- this will go without asking: -->
    <a href="anotherPage.html" onClick="unhook()">internal link, un-hooked</a>
  </body>
</html> 
```

它的作用是使用变量作为标志。

* * *

## 回答 #2

> 赞同：32
> 
>             
> 
> 时间：2008-12-02T11:19:28.667

保持代码不变并使用 jQuery 处理链接：

```
$(function () {
  $("a").click(function {
    window.onbeforeunload = null;
  });
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2016-01-12T22:45:41.757

您可以检测超链接点击，但您无法确定用户是否：

*   试图刷新页面。

*   试图关闭浏览器选项卡。

*   试图关闭浏览器窗口。

*   在 URL 栏中输入另一个 URL，然后按 Enter。

所有这些操作都会`beforeunload`在 上生成事件`window`，而没有关于该事件的任何更准确信息。

为了在执行上述操作时显示确认对话框，并且在单击超链接时不显示，请执行以下步骤：

*   将`beforeunload`事件侦听器分配给`window`，它将以字符串形式返回确认文本，*除非*将特定变量（标志）设置为`true`。

*   将`click`事件分配给`document`。检查是否`a`已单击元素 ( `event.target.tagName`)。如果是，将标志设置为`true`。

`submit`您还应该通过将事件侦听器分配给 来处理表单提交`document`。

您的代码可能如下所示：

```
let disableConfirmation = false;
window.addEventListener('beforeunload', event => {
  const confirmationText = 'Are you sure?';
  if (!disableConfirmation) {
    event.returnValue = confirmationText; // Gecko, Trident, Chrome 34+
    return confirmationText;              // Gecko, WebKit, Chrome <34
  } else {
    // Set flag back to false, just in case
    // user stops loading page after clicking a link.
    disableConfirmation = false;
  }
});
document.addEventListener('click', event => {
  if (event.target.tagName.toLowerCase() === 'a') {
    disableConfirmation = true;
  }
});
document.addEventListener('submit', event => {
  disableConfirmation = true;
});
```

```
<p><a href="https://stacksnippets.net/">google.com</a></p>
<form action="https://stacksnippets.net/"><button type="submit">Submit</button></form>
<p>Try clicking the link or the submit button. The confirmation dialog won't be displayed.</p>
<p>Try reloading the frame (right click -> "Reload frame" in Chrome). You will see a confirmation dialog.</p>
```

请注意，在某些浏览器中您必须使用`event.returnValue`in `beforeunload`listener，而在其他浏览器中您必须使用`return`statement。

另请参阅[`beforeunload`事件文档](https://developer.mozilla.org/en-US/docs/Web/Events/beforeunload)。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2020-07-08T08:32:18.047

**我添加了一个额外的代码来处理窗口是否关闭的进一步处理**

```
let disableConfirmation = false;
window.addEventListener('beforeunload', event => {
  const confirmationText = 'Are you sure?';
  if (!disableConfirmation) {
    event.returnValue = confirmationText; // Gecko, Trident, Chrome 34+
    return confirmationText;              // Gecko, WebKit, Chrome <34
  } else {
    // Set flag back to false, just in case
    // user stops loading page after clicking a link.
    disableConfirmation = false;
  }
}); 
```

**如果你想发送任何 ajax 请求并且你已经使用了 jquery，那么在 Confimation 之后**

```
 $(window).on('unload', function() {
   // async: false will make the AJAX synchronous in case you're using jQuery
   axios
     .get('ajax_url')
     .then(response => {});
 }); 
```

**如果没有使用 jquery，你可以使用 navigator，它需要 navigator 库**

```
navigator.sendBeacon(url, data); 
```

你可以从这里下载这个库：[https ://github.com/miguelmota/Navigator.sendBeacon](https://github.com/miguelmota/Navigator.sendBeacon)

# c# - SQL 超时错误

> ID：333669
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-12-02T11:16:18.987
> 
>         
> 
> 标签：c#, sql

收到此**错误**：

```
NativeError = 258
Error = [Microsoft][SQL Native Client]Shared Memory Provider: Timeout error [258]. 
SQLState = HYT00, NativeError = 0
Error = [Microsoft][SQL Native Client]Login timeout expired
SQLState = 08001, NativeError = 258
Error = [Microsoft][SQL Native Client]Unable to complete login process due to delay in login response 
```

希望有人能帮忙。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T12:14:53.547

我认为您可能会发现[这篇 Microsoft 知识库文章](http://support.microsoft.com/kb/934751)很有用。如果您的登录问题符合该文章中列出的标准，那么它是一个已知的 SQL Server 2005 错误并且有解决方法。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T11:22:49.707

尝试将 SqlCommand.CommandTimeout 属性设置为 0。有关详细信息，这里有一篇 MSDN[文章](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout.aspx)。

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2008-12-02T11:20:32.333

重新启动 SQL 服务器或尝试增加连接字符串中的池大小。

# unit-testing - 单元测试反模式目录

> ID：333682
> 
>         
> 
> 赞同：203
> 
>         
> 
> 时间：2008-12-02T11:24:33.353
> 
>         
> 
> 标签：unit-testing, tdd, anti-patterns

**[反模式](http://en.wikipedia.org/wiki/Anti-pattern)**：必须至少存在两个关键元素才能正式区分实际的反模式与简单的坏习惯、坏做法或坏主意：

*   一些重复的行动模式、过程或结构，最初看起来是有益的，但最终产生的不良后果多于有益结果，以及

*   一个重构的解决方案，有明确的文档记录，在实际实践中得到证明并且可重复。

投票支持您曾经多次“在野外”看到的 TDD 反模式。

[James Carr 的博客文章](http://blog.james-carr.org/2006/11/03/tdd-anti-patterns/)和   关于测试[驱动开发的相关讨论 yahoogroup](http://tech.groups.yahoo.com/group/testdrivendevelopment/message/20745)

如果您发现了一个“未命名”的.. 也发布它们。**请为每个反模式发布一篇文章，**以使选票有意义。

*我的既得利益是找到前 n 个子集，以便我可以在不久的将来在午餐盒会议上讨论它们。*

* * *

## 回答 #1

> 赞同：70
> 
>             
> 
> 时间：2008-12-02T14:37:26.600

**二等公民**- 测试代码没有像生产代码那样重构，包含大量重复代码，难以维护测试。

* * *

## 回答 #2

> 赞同：67
> 
>             
> 
> 时间：2008-12-02T13:15:03.990

**搭便车/捎带——James** Carr、Tim Ottinger

不是编写新的测试用例方法来测试**另一个/不同的特性/功能**，而是在现有的测试用例中使用新的断言（及其相应的操作，即从 AAA 执行的步骤） .

* * *

## 回答 #3

> 赞同：64
> 
>             
> 
> 时间：2008-12-02T13:43:08.270

**快乐之路**

测试保持在愉快的路径上（即预期的结果），而不测试边界和异常。

[JUnit 反模式](https://web.archive.org/web/20121023221501/http://www.ibm.com/developerworks/opensource/library/os-junit/)

* * *

## 回答 #4

> 赞同：59
> 
>             
> 
> 时间：2008-12-02T11:40:20.670

**当地英雄**

一个测试用例，它依赖于特定于编写它的开发环境才能运行。结果是测试通过了开发盒，但是当有人试图在其他地方运行它时失败了。

**隐藏的依赖**

与本地英雄密切相关，这是一个单元测试，需要在测试运行之前在某处填充一些现有数据。如果没有填充该数据，测试将失败，并且几乎不会向开发人员说明它想要什么，或者为什么……迫使他们挖掘大量代码以找出它所使用的数据应该来自哪里。

* * *

可悲的是，很多次使用古老的 .dll 依赖于模糊多样的 .ini 文件，这些文件在任何给定的生产系统上都经常不同步，更不用说在没有与负责这些 dll 的三个开发人员进行广泛协商的情况下存在于您的机器上。叹。

* * *

## 回答 #5

> 赞同：58
> 
>             
> 
> 时间：2008-12-02T12:30:01.553

**链帮**

必须按特定顺序运行的几个测试，即一个测试更改系统的全局状态（全局变量、数据库中的数据），下一个测试依赖于它。

您经常在数据库测试中看到这一点。测试不是在 中进行回滚，而是`teardown()`将它们的更改提交到数据库。另一个常见的原因是对全局状态的更改没有包含在 try/finally 块中，如果测试失败，这些块会清理它们。

* * *

## 回答 #6

> 赞同：56
> 
>             
> 
> 时间：2008-12-02T11:25:13.150

**嘲弄**

有时候，嘲弄可能很好，而且很方便。但有时开发人员可能会迷失自我，并努力模拟未测试的内容。在这种情况下，单元测试包含如此多的模拟、存根和/或伪造，以至于被测系统甚至根本没有被测试，而是从模拟返回的数据是正在测试的。

资料来源：詹姆斯卡尔的帖子。

* * *

## 回答 #7

> 赞同：40
> 
>             
> 
> 时间：2008-12-02T14:17:34.457

**沉默的捕手**——凯利？

如果抛出异常，则测试通过..即使实际发生的异常与开发人员预期的异常不同。

另见：[秘密捕手](https://stackoverflow.com/questions/333682/tdd-anti-patterns-catalogue#334026)

```
[Test]
[ExpectedException(typeof(Exception))]
public void ItShouldThrowDivideByZeroException()
{
   // some code that throws another exception yet passes the test
} 
```

* * *

## 回答 #8

> 赞同：34
> 
>             
> 
> 时间：2008-12-02T11:57:44.597

**Excessive Setup** -- James Carr

一项测试需要大量设置才能开始测试。有时数百行代码用于为一项测试准备环境，其中涉及多个对象，由于所有设置正在进行的“噪音”，这可能难以真正确定测试的内容。（来源：[詹姆斯卡尔的帖子](http://blog.james-carr.org/2006/11/03/tdd-anti-patterns/)）

* * *

## 回答 #9

> 赞同：34
> 
>             
> 
> 时间：2008-12-02T11:26:25.457

**Inspector**

一种单元测试，它违反封装以实现 100% 的代码覆盖率，但对对象中发生的事情非常了解，以至于任何重构尝试都会破坏现有测试并需要在单元中反映任何更改测试。

* * *

“我如何在不公开它们的情况下测试我的成员变量……*仅*用于单元测试？”

* * *

## 回答 #10

> 赞同：32
> 
>             
> 
> 时间：2008-12-02T12:35:11.400

**肛门探针**

必须使用疯狂、非法或其他不健康的方式来执行其任务的测试，例如：使用 Java 的[setAccessible(true)](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/reflect/AccessibleObject.html#setAccessible(boolean))读取私有字段或扩展类以访问受保护的字段/方法或必须将测试放在某个包中才能访问打包全局字段/方法。

如果您看到这种模式，则测试中的类使用了太多的数据隐藏。

这与 The Inspector 的区别在于，被测试的类甚至试图隐藏你需要测试的东西。所以你的目标不是达到 100% 的测试覆盖率，而是能够测试任何东西。想想一个只有私有字段的类，一个`run()`没有参数且根本没有 getter 的方法。在不违反规则的情况下，没有办法对此进行测试。

* * *

Michael Borgwardt 的评论：*这并不是真正的测试反模式，而是处理被测试代码中的缺陷的实用主义。当然，最好修复这些缺陷，但对于 3rd 方库，这可能是不可能的。*

Aaron Digulla：我有点同意。也许这个条目真的更适合“JUnit HOWTO”wiki 而不是反模式。注释？

* * *

## 回答 #11

> 赞同：26
> 
>             
> 
> 时间：2008-12-03T10:35:20.300

**没有名字的测试**——尼克·佩洛

为重现错误跟踪器中的特定错误而添加的测试，其作者认为不保证有自己的名称。创建一个名为 testForBUG123 的新测试，而不是增强现有的、缺乏的测试。

两年后，当该测试失败时，您可能需要首先尝试在错误跟踪器中找到 BUG-123 以确定测试的意图。

* * *

## 回答 #12

> 赞同：25
> 
>             
> 
> 时间：2008-12-02T11:30:23.483

**慢戳**

运行速度非常慢的单元测试。当开发人员开始测试时，他们有时间去洗手间，抽根烟，或者更糟糕的是，在一天结束回家之前开始测试。（来源：[詹姆斯卡尔的帖子](http://blog.james-carr.org/2006/11/03/tdd-anti-patterns/)）

也就是那些不会像他们应该的那样频繁运行的测试

* * *

## 回答 #13

> 赞同：20
> 
>             
> 
> 时间：2008-12-02T12:46:21.533

**蝴蝶**

您必须测试包含始终变化的数据的东西，例如包含当前日期的结构，并且无法将结果确定为固定值。丑陋的部分是你根本不关心这个值。它只会使您的测试更加复杂，而不会增加任何价值。

*它翅膀的蝙蝠可以在世界的另一端引起飓风。*——爱德华·洛伦兹，[蝴蝶效应](http://en.wikipedia.org/wiki/Butterfly_effect)

* * *

## 回答 #14

> 赞同：19
> 
>             
> 
> 时间：2008-12-04T01:12:47.923

**等着瞧**

运行一些设置代码的测试，然后需要“等待”特定的时间，然后才能“查看”被测代码是否按预期运行。使用 Thread.sleep() 或等效的 testMethod 肯定是“等待和查看”测试。

通常，如果测试正在测试生成系统外部事件（例如电子邮件、http 请求或将文件写入磁盘）的代码，您可能会看到这一点。

这样的测试也可能是[本地英雄](https://stackoverflow.com/questions/333682/tdd-anti-patterns-catalogue#333704)，因为在较慢的机器或过载的 CI 服务器上运行时它会失败。

不要将 Wait and See 反模式与[The Sleeper](https://stackoverflow.com/questions/333682/tdd-anti-patterns-catalogue#339304)混淆。

* * *

## 回答 #15

> 赞同：19
> 
>             
> 
> 时间：2008-12-04T09:37:39.137

**闪烁测试**（来源：Romilly Cocking）

只是偶尔失败的测试，而不是在特定时间失败，通常是由于测试中的竞争条件。通常在测试异步的东西时发生，例如 JMS。

可能是“ [Wait and See](https://stackoverflow.com/questions/333682/tdd-anti-patterns-catalogue#339339) ”反模式和“ [The Sleeper](https://stackoverflow.com/questions/333682/tdd-anti-patterns-catalogue#339304) ”反模式的超级集。

*构建失败，哦，好吧，再次运行构建。*-- 匿名开发者

* * *

## 回答 #16

> 赞同：17
> 
>             
> 
> 时间：2008-12-02T13:12:14.960

**不恰当地共享夹具**——Tim Ottinger

测试夹具中的几个测试用例甚至不使用或不需要设置/拆卸。部分是由于开发人员惯性创建一个新的测试夹具......更容易添加一个测试用例堆

* * *

## 回答 #17

> 赞同：16
> 
>             
> 
> 时间：2008-12-02T11:27:25.703

**巨人**

一个单元测试，虽然它有效地测试被测对象，但可以跨越数千行并包含许多测试用例。这可能表明被测系统是[上帝对象](http://en.wikipedia.org/wiki/God_object)（James Carr 的帖子）。

一个确定的标志是一个跨越几行代码的测试。通常，测试非常复杂，以至于它开始包含自身的错误或不稳定的行为。

* * *

## 回答 #18

> 赞同：15
> 
>             
> 
> 时间：2008-12-04T07:39:32.947

* * *

## 回答 #19

> 赞同：14
> 
>             
> 
> 时间：2008-12-04T01:01:30.240

**沉睡者，又**名维苏威火山——尼克·佩洛

注定在未来某个特定时间和日期失败的测试。这通常是由于在测试使用 Date 或 Calendar 对象的代码时不正确的边界检查引起的。有时，如果在一天中非常特定的时间（例如午夜）运行，测试可能会失败。

'The Sleeper' 不应与' [Wait And See](https://stackoverflow.com/questions/333682/tdd-anti-patterns-catalogue#339339) ' 反模式混淆。

*该代码将在 2000 年之前被替换*——许多开发人员在 1960 年

* * *

## 回答 #20

> 赞同：11
> 
>             
> 
> 时间：2009-10-06T16:10:10.153

**死树**

创建存根的测试，但实际上并未编写测试。

我实际上已经在我们的生产代码中看到了这一点：

```
class TD_SomeClass {
  public void testAdd() {
    assertEquals(1+1, 2);
  }
} 
```

我什至不知道该怎么想。

* * *

## 回答 #21

> 赞同：11
> 
>             
> 
> 时间：2010-01-27T23:01:51.093

今天被这个咬了：

**Wet Floor**：

测试创建的数据保存在某处，但测试完成后不会清理。这会导致测试（相同的测试，或可能的其他测试）在*后续*测试运行中失败。

在我们的例子中，测试在“temp”目录中留下了一个文件，该文件具有第一次运行测试的用户的权限。当不同的用户尝试在同一台机器上进行测试时：繁荣。在 James Carr 网站上的评论中，Joakim Ohlrogge 将其称为“邋遢的工人”，这也是“慷慨的剩菜”灵感的一部分。我更喜欢我的名字（不那么侮辱，更熟悉）。

* * *

## 回答 #22

> 赞同：11
> 
>             
> 
> 时间：2008-12-02T13:23:06.937

**The Cuckoo** -- Frank Carver

一个单元测试，它与其他几个测试一起放在一个测试用例中，并享受与测试用例中的其他测试相同（可能很长）的设置过程，但随后丢弃了设置中的部分或全部工件并创建自己的。

高级症状：[不恰当地共享夹具](https://stackoverflow.com/questions/333682/tdd-anti-patterns-catalogue#333870)

* * *

## 回答 #23

> 赞同：10
> 
>             
> 
> 时间：2008-12-02T14:07:53.243

**The Secret Catcher** -- Frank Carver

由于没有断言，乍一看似乎没有进行测试的测试。但是“魔鬼在细节中”..测试实际上是依赖于抛出异常并期望测试框架捕获异常并将其作为失败报告给用户。   

```
[Test]
public void ShouldNotThrow()
{
   DoSomethingThatShouldNotThrowAnException();
} 
```

* * *

## 回答 #24

> 赞同：10
> 
>             
> 
> 时间：2008-12-04T00:32:59.877

**四十英尺杆测试**

由于害怕与他们试图测试的类太近，这些测试在远处进行，被无数抽象层和数千行代码与他们正在检查的逻辑隔开。因此，它们非常脆弱，并且容易受到在往返感兴趣的班级的史诗般的旅程中发生的各种副作用的影响。

* * *

## 回答 #25

> 赞同：10
> 
>             
> 
> 时间：2008-12-04T00:42:43.727

**图灵测试**

一个测试用例由一些昂贵的工具自动生成，该工具有很多很多断言，这些断言是使用一些过于聪明的半数据流分析从被测类中收集的。让开发人员误以为他们的代码已经过良好测试，从而免除了他们设计和维护高质量测试的责任。如果机器可以为您编写测试，为什么它不能伸出手指并自己编写应用程序！

*你好笨蛋。*-- 世界上最聪明的电脑到新学徒（来自旧的 Amiga 漫画）。

* * *

## 回答 #26

> 赞同：10
> 
>             
> 
> 时间：2008-12-04T00:58:22.617

**环境破坏者**

针对各种“要求”的“单元”测试开始溢出到其环境中，使用和设置环境变量/端口。同时运行其中两个测试将导致“不可用端口”异常等。

这些测试将是间歇性的，让开发人员说“再运行一次”之类的话。

我见过的一种解决方案是随机选择要使用的端口号。这减少了发生冲突的可能性，但显然不能解决问题。因此，如果可以，请始终模拟代码，使其实际上不会分配不可共享的资源。

* * *

## 回答 #27

> 赞同：9
> 
>             
> 
> 时间：2008-12-02T12:39:36.383

**分身**

为了测试某些东西，您必须将部分被测代码复制到具有相同名称和包的新类中，并且您必须使用类路径魔术或自定义类加载器来确保它首先可见（因此选择您的副本向上）。

此模式表明您无法从测试中控制的隐藏依赖项数量不正常。

*我看着他的脸……我的脸！它就像一面镜子，却让我的血液冻结。*

* * *

## 回答 #28

> 赞同：7
> 
>             
> 
> 时间：2012-09-30T04:15:55.817

**测试一切**

我不敢相信直到现在还没有提到这一点，但测试不应该违反*单一责任原则*。

我已经遇到过很多次了，打破这条规则的测试显然是一场噩梦。

* * *

## 回答 #29

> 赞同：7
> 
>             
> 
> 时间：2008-12-02T13:26:10.737

**The Mother Hen** -- Frank Carver

一个常见的设置，它的功能远远超出了实际测试用例的需要。例如，当测试仅断言某物的存在或不存在时，创建各种复杂的数据结构，其中填充了明显重要且唯一的值。

高级症状：[不恰当地共享夹具](https://stackoverflow.com/questions/333682/tdd-anti-patterns-catalogue#333870)

*我不知道它是做什么的......无论如何我都会添加它，以防万一。*-- 匿名开发者

* * *

## 回答 #30

> 赞同：6
> 
>             
> 
> 时间：2012-04-25T20:34:02.443

**线击球手**

乍一看，测试涵盖了所有内容，代码覆盖率工具 100% 确认了这一点，但实际上测试只命中代码而没有任何输出分析。

[覆盖率与可达代码](https://stackoverflow.com/questions/10129864/coverage-vs-reachable-code)

* * *

## 回答 #31

> 赞同：0
> 
>             
> 
> 时间：2015-01-26T09:26:40.340

**连体双胞胎**

人们称之为“单元测试”但实际上是集成测试的测试，因为它们没有与依赖项隔离（文件配置，数据库，服务，换句话说，在你的测试中没有测试的部分，人们变得懒惰并且没有隔离）并且由于应该被存根或模拟的依赖关系而失败。

# c# - 在 C# 中更新 XML 节点值的最佳方法是什么？

> ID：333687
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-12-02T11:25:20.077
> 
>         
> 
> 标签：c#, xml, xmldocument

我的函数遍历`XMLDocument`. 它检查当前节点的名称是否在查找列表中。如果是，它将对当前节点的值应用适当的验证。

当验证方法指示值已更改时，我想将原始文档中的值替换为更新后的值。

我认为实现这一点的最简单方法可能是在`XMLTextWriter`我处理 original 中的每个节点时`XMLDocument`写出，根据需要写出原始或修改的节点和值。此方法将依赖于确定当前节点是否有任何子节点，或者是独立节点。

有没有更好的方法可以更新原始文档中的值？在适当的情况下，我需要以完整`XMLDocument`的但更新的节点值结束。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T11:47:43.743

你不能修改现有的节点（已经在正确的结构和 XMLDocument 中吃，然后重新序列化 XMLDocument？如果节点是简单的文本容器，那么

```
.InnerText 
```

财产是你想要的。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T11:48:24.053

我知道我总是回到这个，但这听起来像是一个例子，在 XSLT 中巧妙地使用应用模板和[ExtensionObjects](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xsltargumentlist.addextensionobject.aspx)会很有效。

也就是说 XMLDocument 已针对修改进行了优化，因此如果您使用纯编程解决方案，我将直接修改对象，而不是创建新的 Writer。

# java - 任何简单的 Java REST 教程？

> ID：333690
> 
>         
> 
> 赞同：33
> 
>         
> 
> 时间：2008-12-02T11:26:14.333
> 
>         
> 
> 标签：java, rest

REST 的每个教程或解释都变得太复杂太快了——在最初解释 CRUD 和假定的 SOAP 简单性之后，学习曲线上升得如此之快。为什么人们不能再写像样的教程了！

我在看 Restlet - 它不是最好的，教程中缺少一些东西，语言/语法有点混乱和不清楚。我花了几个小时来解开他们的第一步教程（在另一位 Java 程序员的帮助下！）

**RESTlet 教程评论**

总的来说，我不确定本教程的确切目标是谁——因为有相当程度的假设知识全面，所以进入 REST 和 Restlet 框架冷让你有很多“赶上工作”要做，并且重新 -一遍又一遍地阅读段落。

1.  我们很难确定必须将 jar 复制到正确的 lib 文件夹中。

2.  web.xml 创建 HTTP 状态 500 错误的问题 -

> 服务器遇到一个内部错误 () 阻止它完成这个请求

，教程说：

> “像往常一样创建一个新的 Servlet Web 应用程序，添加一个“com.firstStepsServlet”包并将资源和应用程序类放入。”

这意味着您的类**FirstStepsApplication**的完全限定名称是**com.firstStepsServlet.FirstStepsApplication**，因此我们必须更改 web.xml 以引用正确的类，例如：

原来的：

```
<param-value>
         firstStepsServlet.FirstStepsApplication
</param-value> 
```

应该：

```
<param-value>
         com.firstStepsServlet.FirstStepsApplication
</param-value> 
```

* * *

**结论**

我的印象是 REST 的概念应该比 SOAP 简单得多——但如果不是更复杂的话，它似乎同样糟糕——根本不明白！呸呸呸

任何好的链接 - 非常感谢。

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2008-12-02T12:01:05.463

您能否在我们的 Restlet 教程中准确描述导致您遇到麻烦的原因？我们有兴趣修复/改进需要的东西。

你检查过屏幕录像吗？
[http://www.restlet.org/documentation/1.1/screencast/](http://www.restlet.org/documentation/1.1/screencast/)

否则，我们在他们的第 12 章中编写的 O'Reilly 书中有一个 Restlet 教程。

如果仍有问题，请联系我们的邮件列表：
 [http ://www.restlet.org/community/lists](http://www.restlet.org/community/lists)

最好的问候，杰罗姆·卢维尔

Restlet ~ 创始人和首席开发者 ~ [http://www.restlet.org](http://www.restlet.org) 
Noelios Technologies ~ 联合创始人 ~ [http://www.noelios.com](http://www.noelios.com)

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2008-12-02T11:47:29.873

听起来您可以充分了解 REST 的基础知识，为此我*强烈*推荐Leonard Richardson 和 Sam Ruby 的[RESTful Web Services](https://rads.stackoverflow.com/amzn/click/com/0596529260)。我对 REST 进行了很好的介绍：它是什么以及如何实现（实用的）RESTful Web 服务。

本书中的大多数示例代码实际上都是 Ruby，但即使您不是 Ruby 专家，也很容易理解。但是有一点应该对你有特别帮助的是，本书后面的章节之一包含了对几个 RESTful 框架的概述，包括 Restlet。它并没有真正进入任何代码（它是一个 50,000 英尺的天桥），但我认为它会为您提供现阶段所需的东西。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2010-11-03T06:09:02.370

Restlet 框架由四个主要部分组成。

**1\. Restlet API**

首先是“Restlet API”，一个支持 REST 概念的中性 API，便于处理客户端和服务器端应用程序的调用。此 API 由 Restlet 引擎提供支持，现在两者都在一个 JAR（“ *org.restlet.jar* ”）中提供。

API 和实现之间的这种分离类似于 Servlet API 和 Web 容器（如 Jetty 或 Tomcat）之间的分离，或者 JDBC API 和具体的 JDBC 驱动程序之间的分离。

**2\. 检索网页的内容**

正如我们在介绍文件中提到的，Restlet 框架同时是一个客户端和一个服务器框架。例如，Restlet 可以使用其 HTTP 客户端连接器轻松处理远程资源。REST 中的连接器是一种软件元素，它通常通过实现网络协议的一侧来实现组件之间的通信。Restlet 基于现有的开源项目提供了几种客户端连接器的实现。连接器部分列出了所有可用的客户端和服务器连接器，并解释了如何使用和配置它们。

在这里，我们将获取现有资源的表示并将其输出到 JVM 控制台中：

```
// Outputting the content of a Web page  
new ClientResource("http://").get().write(System.out); 
```

请注意，上面的示例使用一种简化的方式通过*ClientResource*类发出调用。如果您需要多线程或更多控制，仍然可以直接使用*客户端*连接器类或*请求*对象进行操作。下面的示例如何在您的客户端调用中设置一些首选项，例如引荐来源网址。它也可能是您希望收到的响应的语言和媒体类型：

```
// Create the client resource  
ClientResource resource = new ClientResource("http://www.restlet.org");  

// Customize the referrer property  
resource.setReferrerRef("http://www.mysite.org");  

// Write the response entity on the console  
resource.get().write(System.out); 
```

**3\. 收听网络浏览器**

现在，我们想看看 Restlet 框架如何监听客户端请求并回复它们。我们将使用内部 Restlet HTTP 服务器连接器（即使可以切换到其他连接器，例如基于 Mortbay 的 Jetty 的连接器），并以纯文本形式返回简单的字符串表示“hello, world”。请注意，*Part03*类扩展了Restlet 提供的基础*ServerResource类：*

```
 public class Part03 extends ServerResource {  

    public static void main(String[] args) throws Exception {  
        // Create the HTTP server and listen on port 8182  
        new Server(Protocol.HTTP, 8182, Part03.class).start();  
    }  

    @Get  
    public String toString() {  
        return "hello, world";  
    }  

} 
```

如果您运行此代码并启动您的服务器，您可以打开一个 Web 浏览器并点击 . 实际上，任何 URI 都可以，也可以试试。请注意，如果您从另一台机器测试您的服务器，您需要将“localhost”替换为您的服务器的 IP 地址或其域名（如果已定义）。

到目前为止，我们主要向您展示了 Restlet API 中最高级别的抽象，包括 ClientResource 和 ServerResource 类。但随着我们继续前进，您会发现这两个类由丰富的 API 支持，让您可以操作所有 REST 工件。

**4\. REST 架构概述**

让我们退后一步，从 REST 的角度考虑典型的 Web 架构。在下图中，端口表示启用组件之间通信的连接器，这些组件由较大的框表示。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2008-12-02T16:05:49.790

与 Java 无关，但我认为这些 InfoQ 文章非常好：

*   [REST 简介](http://www.infoq.com/articles/rest-introduction)

*   [解决对 REST 的疑虑](http://www.infoq.com/articles/tilkov-rest-doubts)

*   [REST 反模式](http://www.infoq.com/articles/rest-anti-patterns)

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T15:43:41.363

您指向 web.xml 中的错误，但我刚刚检查了 Restlet 1.0 和 1.1 文档，我没有看到这种错误。我想提一下，您可以在页面末尾找到一个 zip，其中包含完整的 war 文件和源文件列表，以防您想在“独立”模式下运行。你试过单机模式吗？正如教程中所解释的，您只需要类路径中的 2 个 jar 和源文件。

我们还想指出，“firstSteps”教程不是关于 REST 的教程，而是关于使用 Restlet 进行编程的教程。您还可以查看“firstResource”教程（[http://www.restlet.org/documentation/1.1/firstResource](http://www.restlet.org/documentation/1.1/firstResource)），该教程描述了如何开发简单资源并介绍了 REST 架构风格的一些概念。它应该可以帮助你。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T16:22:41.317

另外，教程中建议的合格命名确实是“firstStepsServlet.FirstStepsApplication”而不是“com.firstStepsServlet.FirstStepsApplication”。

因此，web.xml 中建议的参数值是正确的。

您能否确认这可以解决您的问题？另外，在阅读本教程之前，您是否具备 Servlet 部署知识？如果不是，那将解释痛苦。在这种情况下，独立模式可能更合适。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2012-12-28T17:31:22.663

这是一篇写得很好的关于 REST 的教程。
 [http://rest.elkstein.org/2008/02/what-is-rest.html](http://rest.elkstein.org/2008/02/what-is-rest.html)

* * *

## 回答 #8

> 赞同：-2
> 
>             
> 
> 时间：2009-05-07T05:15:16.357

eSoftHead 公司刚刚发布了一个使用 RESTeasy 开发 Restful 应用程序的[简短教程。](http://blog.esofthead.com/develop-restful-application-with-resteasy/)

# internet-explorer - 如果 IE 不存在，我们可以使用哪些当前不可用的 css、js 或 html 功能？

> ID：333693
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2008-12-02T11:27:44.347
> 
>         
> 
> 标签：internet-explorer, cross-browser

在一个不存在 IE 的世界里，什么东西会更容易，更少的 hacky，更少的 bug 并且通常更常用。

如果所有功能都可以跨浏览器使用，那么互联网会是什么？

每个帖子列出一个点。

这是社区 wiki，因此请随时修改问题/答案以清楚起见。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2008-12-02T11:43:59.133

1) :before 和 :after 伪元素。

2）“内容”属性。

3) :hover 任何元素（不仅仅是锚点）。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2008-12-02T11:31:07.567

由于在早期版本的 IE 中的支持，更好地采用了 PNG。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-12-02T11:31:06.303

> “在一个没有 IE 的世界里，有什么事情会更容易？”

```
Web Programming 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T11:54:15.353

更简单？任何涉及浮点数或盒子模型的东西

可能的？`display:table`并且`:focus`会很好，但真正的大问题是刚刚起作用的**最小和最大尺寸。**

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-03-08T00:57:29.303

画布...他们刚刚决定在 ie8 中也跳过它

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T11:48:06.973

让我们从~~javascript~~ [EcmaScript](http://en.wikipedia.org/wiki/ECMAScript)：今天你必须为 Mozilla/Opera/Safari 制作一个版本，为 IE 制作另一个版本。

Opera 和 Firefox 都支持一些 CSS3。你猜怎么着：IE 不会。CSS2 标准呢？不，IE 还没有准备好使用那个。我不确定有多少 CSS1 标准的 IE7 支持，但我知道 IE6 并不完全支持它。

今天你不能正确使用 xhtml：IE 不支持作为 xhtml 服务的文档。

今天许多 web 开发人员所做的一个解决方案是创建大量嵌套的 <div>-tags 来强制 IE 正确显示页面。大多数现代浏览器（不是 IE6）在 'html' 和 'body'-tag 上支持 css-rules，因此可以避免 div-mania。（嗯；今天在 IE 上可以避免 div-mania，所以最后一点无关紧要）

正如 Rich Bradshaw 指出的那样，PNG 图片也是一个问题。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T12:28:29.963

当然是标准盒子模型。

我们将摆脱彩色滚动条、VBScript（我在 Web 上看到的页面仅使用它编写脚本！）、使用 VML 的 hack 等等。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-03-08T00:13:30.127

IE是我生活的祸根。不得不解决所有不受支持的功能和它所做的误解，这对背面来说是一种痛苦。

IE 就像我的母亲，它听不到你实际上说的话，它听到了它认为你说的话。

你最终不得不在它上面练习一些奇怪的逆向心理学，直到它达到你想要的效果。

# python - string.split(text) 或 text.split() ：有什么区别？

> ID：333706
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2008-12-02T11:41:05.630
> 
>         
> 
> 标签：python, string, split

有一件事我不明白...

想象一下，你有一个**text** = "hello world" 并且你想拆分它。

在某些地方，我看到想要拆分**文本**的人在做：

```
string.split(text) 
```

在其他地方，我看到人们只是在做：

```
text.split() 
```

有什么不同？为什么你以一种方式或另一种方式做？你能给我一个理论解释吗？

* * *

## 回答 #1

> 赞同：21
> 
>             
> 
> 时间：2008-12-02T11:49:56.033

有趣的是，两者的文档字符串在 Python 2.5.1 中并不完全相同：

```
>>> import string
>>> help(string.split)
Help on function split in module string:

split(s, sep=None, maxsplit=-1)
    split(s [,sep [,maxsplit]]) -> list of strings

    Return a list of the words in the string s, using sep as the
    delimiter string.  If maxsplit is given, splits at no more than
    maxsplit places (resulting in at most maxsplit+1 words).  If sep
    is not specified or is None, any whitespace string is a separator.

    (split and splitfields are synonymous)

>>> help("".split)
Help on built-in function split:

split(...)
    S.split([sep [,maxsplit]]) -> list of strings

    Return a list of the words in the string S, using sep as the
    delimiter string.  If maxsplit is given, at most maxsplit
    splits are done. If sep is not specified or is None, any
    whitespace string is a separator. 
```

深入挖掘，你会发现这两种形式是完全等价的，因为[string.split(s)](http://svn.python.org/view/python/tags/r251/Lib/string.py?rev=54864&view=markup)实际上调用[了 s.split()](http://svn.python.org/view/python/tags/r251/Objects/unicodeobject.c?rev=54864&view=markup)（搜索*split*函数）。

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2008-12-02T11:46:16.990

这`string.split(stringobj)`是`string`模块的一个特性，必须单独导入。曾几何时，这是拆分字符串的唯一方法。那是您正在查看的一些旧代码。

是字符串对象的`stringobj.split()`一个​​特征`stringobj`，它比`string`模块更新。不过还是挺老的。这就是目前的做法。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-12-02T14:04:17.447

额外说明：`str`是字符串类型，正如 S.Lott 上面指出的那样。这意味着这两种形式：

```
'a b c'.split()
str.split('a b c')

# both return ['a', 'b', 'c'] 
```

...是等价的，因为`str.split`是未绑定的方法，而是对象`s.split`的绑定方法`str`。在第二种情况下，传入的字符串与方法`str.split`中一样使用`self`。

这在这里没有太大区别，但它是 Python 对象系统如何工作的一个重要特征。

[有关绑定和未绑定方法的更多信息。](http://www.python.org/doc/2.6/library/stdtypes.html#methods)

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-12-02T14:32:16.173

简短的回答：字符串模块是在 python 1.6 之前执行这些操作的唯一方法——它们已经作为方法添加到字符串中。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T14:18:56.730

使用任何你喜欢的方法，但要意识到 str.split 是推荐的方法。:-)

string.split 是做同样事情的老方法。

str.split 效率更高一些（因为您不必导入字符串模块或从中查找任何名称），但如果您更喜欢 string.split，则不足以产生巨大的差异。

# user-interface - 在网络浏览器中向用户显示信息的一些准则是什么？

> ID：333721
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-12-02T11:48:06.630
> 
>         
> 
> 标签：user-interface

在网络浏览器中向用户显示信息的一些准则是什么？

我正在尝试确定一些向用户显示信息的准则和最佳实践。

确切的情况是确认按钮：一旦按下它并确认主题，按钮就会被禁用（以防止用户再次单击它）。为了能够单击此确认按钮，需要满足一些先决条件。如果未满足先决条件，则应显示禁用确认按钮的原因。

目前，我将此信息显示为按钮上的工具提示。这是显示此类信息的典型方式吗？

我担心的另一件事是禁用状态发送两个不同的信号

*   一个信号是“一切都井井有条”</li>

*   另一个信号是“出了点问题，但你需要悬停我以找出问题所在”。

这是 GUI 中的设计缺陷吗？或者此信息是否最好以另一种方式显示（如果这是 WinForms，则像状态栏？）或者，可以在指示信息存在的按钮上方/下方或附近显示一个图标。

我不太确定网络世界中关于这个主题的最佳实践是什么。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T12:05:26.483

[**关于 UI 线索，你可以找到一些与表单验证**](http://www.websemantics.co.uk/tutorials/accessible_forms/)相关的好想法。

例如，您可以在每个前提条件前用符号（红色 *）显式显示这些前提条件列表，说明这些前提条件是强制性的。

如果按钮被禁用，并且所有先决条件信息前面不再有 (*)，而是一个绿色复选标记，则可以帮助强化消息，该按钮并非绝对无效。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T11:52:06.527

我将首先以工具提示以外的方式显示信息，因为这是一些关键信息。此外，对于按钮，我会有两个不同的 UI 线索。显然，该按钮应该被禁用，直到它准备好被点击。然后，当单击按钮时，您可能会看到一些图像或其他东西，按钮现在消失了，说明请求已提交，等等。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T12:05:33.753

在用其他颜色突出显示的 div 中显示消息，并将其放在按钮上方。

满足先决条件后，隐藏 div。

# c# - .Net 中的 Midi 实现

> ID：333725
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-12-02T11:49:15.597
> 
>         
> 
> 标签：c#, midi, sysex

有人对在 C# Winforms 中编写基于 MIDI 的应用程序有任何指导或建议吗？我最近购买了一个具有完整 MIDI 实现的新效果踏板（或者我被引导相信），但制造商认为不发布图书管理员/补丁编辑应用程序是合适的。

除了将键盘插入另一个 MIDI 设备之外，我几乎没有 MIDI 经验，但这不会那么难，对吧？;-)

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-12-02T12:24:00.487

查看此链接，这可能是您正在寻找的

*   [http://www.codeproject.com/KB/audio-video/MIDIToolkit.aspx](http://www.codeproject.com/KB/audio-video/MIDIToolkit.aspx)

*   [http://www.codeproject.com/KB/audio-video/midiports.aspx](http://www.codeproject.com/KB/audio-video/midiports.aspx)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-12-09T13:35:05.487

还可以查看[NAudio](http://www.codeplex.com/naudio)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2020-08-21T14:50:56.263

老问题，但你可以查看我的[DryWetMIDI](https://github.com/melanchall/drywetmidi)库。它有很多[功能](https://melanchall.github.io/drywetmidi/index.html#features)和丰富的[文档](https://melanchall.github.io/drywetmidi)。至于使用设备，[本文](https://melanchall.github.io/drywetmidi/articles/devices/Overview.html)将是一个很好的起点。

# jsp - 如何从 JSP 访问语言环境？

> ID：333729
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2008-12-02T11:50:21.803
> 
>         
> 
> 标签：jsp, struts, locale

我想根据当前语言环境的值包含一个 js 文件。我尝试从 JSP 访问它，如下所示：

```
<%@ page import="java.util.Locale" %>  
<% if( ((Locale) pageContext.getAttribute("org.apache.struts.action.LOCALE",PageContext.REQUEST_SCOPE)).getLanguage().equals("de")) { %>
    <script src="../themes/administration/js/languages/i18nDE.js" type="text/javascript"> </script>
<% } else { %>
    <script src="../themes/administration/js/languages/i18nEN.js" type="text/javascript"> </script>
<% } %> 
```

但是，我得到了`java.lang.NullPointerException`因为   `pageContext.getAttribute("org.apache.struts.action.LOCALE",PageContext.REQUEST_SCOPE)`is `NULL`。

有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：20
> 
>             
> 
> 时间：2009-11-10T18:34:06.033

目前我正在使用这个：

```
<c:set var="localeCode" value="${pageContext.response.locale}" /> 
```

稍后可以使用`${localeCode}` 

1.  **脚本模式**，气馁！请参阅[为什么不使用 Scriptlet](http://www.coderanch.com/how-to/java/WhyNotUseScriptlets)以了解不使用 Scriptlet的原因。

`localeCode`可以在**scriptlet**中使用以下命令查询该变量：

```
<%
  Object ob_localeCode = pageContext.getAttribute("localeCode");
  if (ob_localeCode != null) {
    String currentLanguageCode = (String) ob_localeCode;
  }
  //more code
%> 
```

2.  **Scripletless 模式**的正确方法。请参阅[如何避免 JSP 文件中的 Java 代码？](https://stackoverflow.com/q/3177733/112106)在这里。

我目前正在使用 spring 2.5 配置。

因此，在此之后，回到您最初的问题，您可以实现以下内容：

```
<c:set var="localeCode" value="${pageContext.response.locale}" />
<c:choose>
  <c:when test="$localecode == 'de' }"> 
    <script src="../themes/administration/js/languages/i18nDE.js" type="text/javascript"> </script>
  </c:when>
  <c:otherwise>
    <script src="../themes/administration/js/languages/i18nEN.js" type="text/javascript"> </script>
  </c:otherwise>
</c:choose> 
```

或者如果你真的想用一些短代码来打动你的同事，你可以这样做：

```
<c:set var="localeCode" value="${fn:toUpperCase(pageContext.response.locale)}" />
<c:set var="availLanguages" value="EN,DE" />
<c:if test="${!fn:contains(availLanguages,localeCode)}">
  <c:set var="localeCode" value="EN" />
</c:if>

<script src="../themes/administration/js/languages/i18n{$localeCode}.js" type="text/javascript"> </script> 
```

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2011-07-26T13:29:52.963

在 Struts2 中尝试

```
<s:if test="#request.locale.language=='us'">
     <s:select name="gender" list="#{'M':'Male','F':'female'}" ></s:select>
 </s:if> 
```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-03-22T06:10:18.790

Struts 将语言环境放入会话中。获取语​​言环境的正确方法是：

```
Locale locale = (locale)request.getSession().getAttribute(Globals.LOCALE_KEY); 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T13:30:05.720

我在 Struts 1.x 文档中找不到常量`org.apache.struts.action.LOCALE`- 应该是[`org.apache.struts.Globals.LOCALE_KEY`](http://struts.apache.org/1.x/struts-core/apidocs/org/apache/struts/Globals.html#LOCALE_KEY)吗？还是其他`LOCALE_KEY`常数之一？

* * *

编辑：   `org.apache.struts.action.LOCALE`是*值*-`org.apache.struts.Global.LOCALE_KEY`所以值本身，用作键，不应该是问题。

验证是否`LOCALE`在`Request`. 我的理解是，如果`LOCALE_KEY`设置了`PageContext.SESSION_SCOPE`，就会设置。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2013-03-25T04:27:30.703

我添加了新示例以进一步澄清这一点，因为这篇文章对我没有多大帮助。

从 jsp 获取语言环境：

```
<%=request.getLocale()%> 
```

它是一个 ServletRequest 方法 a 根据 Accept-Language 标头返回客户端将接受内容的首选语言环境，

```
Struts2 Locale: <s:property value="#request.locale"/> 
```

返回 Struts2 框架的语言环境，它可能与前一个示例中的相同，也可能不同。例如，如果您传递参数 request_locale=de ......

```
<s:url id="localeDE" namespace="/">
   <s:param name="request_locale" >de</s:param>
</s:url>
<s:a href="%{localeDE}" >German</s:a> 
```

struts2 #request.locale 将更改为覆盖原始 Accept-Language 标头的值的德语

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2014-04-23T10:45:31.133

试试这个

```
<s:if test='locale.toString() == "si"'>
    <script src="../themes/administration/js/languages/i18nDE.js" type="text/javascript"> </script>
</s:if>
<s:elseif test='locale.toString() == "ta"'>
    <script src="../themes/administration/js/languages/i18nEN.js" type="text/javascript"> </script>
</s:elseif>
<s:else>
    ANOTHER SCRIPT
</s:else> 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2010-04-07T17:16:10.447

在 Struts2 中，使用 EL 我成功使用了：

```
${sessionScope["org.apache.struts2.action.LOCALE"]} 
```

例如输出 Locale 的值：

```
<c:out value='${sessionScope["org.apache.struts2.action.LOCALE"]}'/> 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:05:58.707

Ken G. 指出了答案。

```
pageContext.getAttribute("org.apache.struts.action.LOCALE",PageContext.SESSION_SCOPE) 
```

应改为使用

```
pageContext.getAttribute("org.apache.struts.action.LOCALE",PageContext.REQUEST_SCOPE) 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-12-09T12:56:00.073

```
<%@page import="java.util.Locale"%>
<%@page import="org.apache.struts.Globals"%>

<%Locale locale = (Locale)session.getAttribute(Globals.LOCALE_KEY);
if (locale.getLanguage().equals("fr")) {%>
    <script language="JavaScript" src="lib/js/dateofday.js" type="text/javascript"></script>
    <script type="text/javascript" src="<%=request.getContextPath() %>/lib/js/jscalendar-1.0/lang/calendar-fr.js"></script>
<%} else {%>
    <script language="JavaScript" src="lib/js/dateofday-en.js" type="text/javascript"></script>
    <script type="text/javascript" src="<%=request.getContextPath() %>/lib/js/jscalendar-1.0/lang/calendar-en.js"></script>
<%}%> 
```

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2011-11-14T10:41:36.513

获得的两种最佳方法`locale`是在 JSP 上使用由`getLocale`操作继承的操作支持：
`<s:hidden name="locale"/>`或

`<s:property value"%{locale}"/>`  

当使用[此方法](http://struts.apache.org/2.0.14/docs/how-do-we-change-locales.html)更改语言环境时。

它与以下内容不同：

`${pageContext.response.locale}`

# php - 如何使用 PHP/SQL 构建树视图？

> ID：333735
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-12-02T11:54:23.933
> 
>         
> 
> 标签：php, sql, treeview, hierarchical-data

最好的方法是：

1.  使用单个查询从数据库中获取数据

2.  循环构建结果，例如嵌套的无序列表

我的表有`id`,`name`和`parent_id`列。

* * *

这是我上一个答案的更新，带有一个计数器，为每个 ul 提供一个嵌套的“级别”类，以及一些评论。

任何人都可以建议如何调整它以使用表行，而不是嵌套，但具有某种用于 css/js 钩子的类编号层次结构？

```
<?

//
// Get the data
//
include_once("inc/config.php");

$query = "SELECT c.* 
          FROM categories AS c
          ORDER BY c.id
          LIMIT 1000";          

$result = pg_query($db, $query);

//
// Load all the results into the row array
//
while ($row = pg_fetch_array($result, NULL, PGSQL_ASSOC))
{
  //
  // Wrap the row array in a parent array, using the id as they key
  // Load the row values into the new parent array
  //
  $categories[$row['id']] = array(
    'id' => $row['id'], 
    'description' => $row['description'], 
    'parent_id' => $row['parent_id']
  );
}

// print '<pre>';
// print_r($category_array);

// ----------------------------------------------------------------

//
// Create a function to generate a nested view of an array (looping through each array item)
// From: http://68kb.googlecode.com/svn-history/r172/trunk/upload/includes/application/controllers/admin/utility.php
//
function generate_tree_list($array, $parent = 0, $level = 0)
{

  //
  // Reset the flag each time the function is called
  //
  $has_children = false;

  //
  // Loop through each item of the list array
  //
  foreach($array as $key => $value)
  {
    //
    // For the first run, get the first item with a parent_id of 0 (= root category)
    // (or whatever id is passed to the function)
    //
    // For every subsequent run, look for items with a parent_id matching the current item's key (id)
    // (eg. get all items with a parent_id of 2)
    //
    // This will return false (stop) when it find no more matching items/children
    //
    // If this array item's parent_id value is the same as that passed to the function
    // eg. [parent_id] => 0   == $parent = 0 (true)
    // eg. [parent_id] => 20  == $parent = 0 (false)
    //
    if ($value['parent_id'] == $parent) 
    {                   

      //
      // Only print the wrapper ('<ul>') if this is the first child (otherwise just print the item)      
      // Will be false each time the function is called again
      //
      if ($has_children === false)
      {
        //
        // Switch the flag, start the list wrapper, increase the level count
        //
        $has_children = true;  

        echo '<ul class="level-' . $level . '">';

        $level++;
      }

      //
      // Print the list item
      //
      echo '<li><a href="?id=' . $value['id'] . '">' . $value['description'] . '</a>';

      //
      // Repeat function, using the current item's key (id) as the parent_id argument
      // Gives us a nested list of subcategories
      //
      generate_tree_list($array, $key, $level); 

      //
      // Close the item
      //
      echo '</li>';

    }

  }

  //
  // If we opened the wrapper above, close it.
  //
  if ($has_children === true) echo '</ul>';

}

// ----------------------------------------------------------------

//
// generate list
//
generate_tree_list($categories);

?> 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2011-08-29T14:12:09.957

```
function generate_list($array,$parent,$level)
{

  foreach ($array as $value)
  {
    $has_children=false;

    if ($value['parent_id']==$parent)
    {

      if ($has_children==false)
      {
        $has_children=true;
        echo '<ul>';
      }

      echo '<li>'.$value['member_name'].' -- '.$value['id'].' -- '.$value['parent_id'];

      generate_list($array,$value['id'],$level);

      echo '</li>';
    }

    if ($has_children==true) echo '</ul>';

    echo $value['parent_id'];
  }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T12:03:26.113

MySQL 写了一篇关于这个主题的好文章：[Managing Hierarchical Data in MySQL](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2016-04-19T11:52:25.663

您可以使用数组创建面包屑视图样式，而无需使用递归函数。

这是我的工作代码：

首先，进行如下 SQL 查询： 

```
$category = CHtml::listData(TblCategory::model()->findAllCategory(array(
'distinct'=>true,
'join'=>'LEFT JOIN tbl_category b on b.id = t.cat_parent',
'join'=>'LEFT JOIN tbl_category c on c.cat_parent = 0',
'order' => 'cat_name')),'id','cat_name');
```

我正在使用 yii 相关代码，因此您可以使用普通查询，然后在函数`join`中形成一个数组`foreach()`

```
public function findAllCategory($condition='',$params=array())
{

    Yii::trace(get_class($this).'.findAll()','system.db.ar.CActiveRecord');
    $criteria=$this->getCommandBuilder()->createCriteria($condition,$params); 

    $category = array();
    $cat_before;
    $parent_id = array();
    $cat_before = $this->query($criteria,true); 

    //echo "<br><br><br><br><br><br><br>";

    foreach($cat_before as $key => $val)
    {
        $category[$key] = $val;
        $parent_id[$key]['cat_parent'] =$val['cat_parent'];
        $parent_id[$key]['cat_name'] =$val['cat_name']; 

        foreach($parent_id as $key_1=> $val_1)
        {   

            if($parent_id[$key]['cat_parent'] == $category[$key_1]['id'])
            {
                $category[$key]['cat_name']= $category[$key_1]['cat_name'] .' > '.  $parent_id[$key]['cat_name'];

            }
        }
    } 
    return $cat_before;  
}
```

然后你可以得到结果使用`Main cat >> subcat 1 >> subcat_1 inner >> ...`

# language-agnostic - “内存不足”是可恢复的错误吗？

> ID：333736
> 
>         
> 
> 赞同：75
> 
>         
> 
> 时间：2008-12-02T11:55:02.513
> 
>         
> 
> 标签：language-agnostic, exception, memory, memory-management, error-recovery

我已经编程很长时间了，我看到的程序，当它们内存不足时，会尝试清理并退出，即优雅地失败。我不记得我最后一次看到有人真正尝试恢复并继续正常运行是什么时候。

如此多的处理依赖于能够成功分配内存，尤其是在垃圾收集语言中，似乎内存不足错误应该归类为不可恢复。（不可恢复的错误包括堆栈溢出等。）

使它成为可恢复错误的有力论据是什么？

* * *

## 回答 #1

> 赞同：37
> 
>             
> 
> 时间：2008-12-02T12:04:54.207

这实际上取决于您要构建的内容。

网络服务器使一个请求/响应对失败但随后继续处理进一步的请求并不是完全不合理的。但是，您必须确保单个故障不会对全局状态产生不利影响——这将是一个棘手的问题。鉴于在大多数托管环境（例如 .NET 和 Java）中失败会导致异常，我怀疑如果异常是在“用户代码”中处理的，它将可以为未来的请求恢复 - 例如，如果一个请求试图分配 10GB 的内存并且失败了，这不应该损害系统的其余部分。但是，如果系统在尝试将请求移交给用户代码时内存不足 - 这种事情可能更糟糕。

* * *

## 回答 #2

> 赞同：17
> 
>             
> 
> 时间：2008-12-02T12:16:20.613

在库中，您希望有效地复制文件。当您这样做时，您通常会发现使用少量大块进行复制比复制大量较小的块更有效（例如，通过复制 15 个 1MB 块来复制 15MB 文件比复制 15'000 个块更快） 1K 块）。

但是该代码适用于任何块大小。因此，虽然使用 1MB 块可能会更快，但如果您设计一个复制大量文件的系统，捕获 OutOfMemoryError 并减小块大小直到成功可能是明智之举。

另一个地方是存储在数据库中的对象的缓存。您希望在缓存中保留尽可能多的对象，但又不想干扰应用程序的其余部分。由于可以重新创建这些对象，因此将缓存附加到内存不足的处理程序以删除条目，直到应用程序的其余部分再次有足够的空间呼吸，这是一种节省内存的聪明方法。

最后，对于图像处理，您希望将尽可能多的图像加载到内存中。同样，OOM 处理程序允许您在事先不知道用户或操作系统将授予您的代码多少内存的情况下实现它。

[编辑] 请注意，我在这里假设您已为应用程序提供了固定数量的内存，并且此数量小于不包括交换空间的总可用内存。如果您可以分配如此多的内存，以至于必须将其中的一部分换出，那么我的一些评论就不再有意义了。

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2008-12-02T16:08:36.493

MATLAB 的用户在对大型数组执行算术运算时总是会耗尽内存。例如，如果变量 x 适合内存并且它们运行“x+1”，那么 MATLAB 会为结果分配空间然后填充它。如果分配失败 MATLAB 错误，用户可以尝试其他方法。如果 MATLAB 在这个用例出现时退出，那将是一场灾难。

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2009-01-03T22:37:51.073

OOM 应该是可恢复的，因为关闭不是从 OOM 中恢复的唯一策略。

对于应用程序级别的 OOM 问题，实际上有一个非常标准的解决方案。作为应用程序设计的一部分，确定从内存不足情况中恢复所需的安全最小内存量。（例如，自动保存文档、弹出警告对话框、记录关机数据所需的内存）。

在应用程序开始或关键块开始时，预先分配该内存量。如果您检测到内存不足的情况，请释放您的保护内存并执行恢复。该策略仍然可能失败，但总体而言物有所值。

请注意，应用程序无需关闭。它可以显示一个模态对话框，直到 OOM 条件得到解决。

我不是 100% 肯定，但我很确定“[代码完整](https://rads.stackoverflow.com/amzn/click/com/0735619670)”（任何受人尊敬的软件工程师都需要阅读）涵盖了这一点。

PS您可以扩展您的应用程序框架以帮助执行此策略，但请不要在库中实施此类策略（好的库不会在未经应用程序同意的情况下做出全局决策）

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2008-12-02T12:08:28.087

我认为就像很多事情一样，这是一个成本/收益分析。您*可以*编程尝试从 malloc() 失败中恢复 - 尽管这可能很困难（您的处理程序最好不要遇到它要处理的内存短缺问题）。

您已经注意到，最常见的情况是清理并优雅地失败。在这种情况下，已确定优雅中止的成本低于恢复中的开发成本和性能成本的组合。

我相信您可以想到自己的示例，其中终止程序是一个非常昂贵的选择（生命支持机器、宇宙飞船控制、长时间运行和时间关键的财务计算等）——尽管第一道防线是当然要确保程序具有可预测的内存使用量并且环境可以提供。

* * *

## 回答 #6

> 赞同：5
> 
>             
> 
> 时间：2008-12-02T12:18:56.567

我正在开发一个为 IO 缓存分配内存以提高性能的系统。然后，在检测到 OOM 时，它会将其中的一部分取回，以便业务逻辑可以继续进行，即使这意味着更少的 IO 缓存和略低的写入性能。

我还使用嵌入式 Java 应用程序尝试通过强制垃圾收集来管理 OOM，可选择释放一些非关键对象，例如预取或缓存的数据。

OOM处理的主要问题是：

1）能够在发生的地方重试或能够回滚并从更高的点重试。大多数当代程序过于依赖语言来抛出并且并没有真正管理它们最终的位置以及如何重试操作。通常操作的上下文会丢失，如果它不是被设计为保留的

2）能够实际释放一些内存。这意味着一种资源管理器，它知道哪些对象是关键的，哪些不是，并且系统能够在释放的对象以及它们后来变得关键时重新请求它们

另一个重要问题是能够在不触发另一个 OOM 情况的情况下回滚。这在高级语言中是难以控制的。

此外，底层操作系统在 OOM 方面的行为必须是可预测的。例如，如果启用了内存过量使用，Linux 就不会。许多启用交换的系统会在向有问题的应用程序报告 OOM 之前死掉。

而且，在某些情况下，不是您的进程造成了这种情况，因此如果有问题的进程继续泄漏，释放内存也无济于事。

正因为如此，使用这种技术的通常是大型嵌入式系统，因为它们可以控制操作系统和内存来启用它们，以及实现它们的纪律/动机。

* * *

## 回答 #7

> 赞同：4
> 
>             
> 
> 时间：2008-12-02T12:38:31.410

只有抓住并正确处理它才能恢复。

例如，在相同的情况下，请求尝试分配大量内存。这是相当可预测的，你可以很好地处理它。

但是，在多线程应用中很多情况下，后台线程（包括系统/3rd-party库创建的）也可能发生OOE。几乎无法预测，您可能无法恢复所有线程的状态。

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T15:26:12.540

不。来自 GC 的内存不足错误通常不应在当前线程内恢复。（但应支持可恢复线程（用户或内核）的创建和终止）

关于反例：我目前正在从事一个 D 编程语言项目，该项目使用 NVIDIA 的 CUDA 平台进行 GPU 计算。我没有手动管理 GPU 内存，而是创建了代理对象来利用 D 的 GC。因此，当 GPU 返回内存不足错误时，我会运行完整的收集，并且仅在第二次失败时才引发异常。但是，这并不是一个内存不足恢复的例子，它更像是一个 GC 集成。恢复的其他示例（缓存、空闲列表、没有自动收缩的堆栈/哈希等）都是具有自己的收集/压缩内存方法的结构，这些方法与 GC 分开，并且往往不是本地分配的功能。所以人们可能会实现如下内容：

```
T new2(T)( lazy T old_new ) {
    T obj;
    try{
        obj = old_new;
    }catch(OutOfMemoryException oome) {
        foreach(compact; Global_List_Of_Delegates_From_Compatible_Objects)
            compact();
        obj = old_new;
    }
    return obj;
} 
```

这是一个不错的论据，可以为一般的垃圾收集器添加注册/注销自收集/压缩对象的支持。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T12:03:27.270

在一般情况下，它是不可恢复的。  

但是，如果您的系统包含某种形式的动态缓存，内存不足处理程序通常可以转储缓存（甚至整个缓存）中最旧的元素。

当然，您必须确保“转储”过程不需要新的内存分配 :) 此外，恢复失败的特定分配可能会很棘手，除非您能够将缓存转储代码直接插入分配器级别，以便故障不会传播到调用者。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2009-01-03T23:28:15.670

尤其是在垃圾收集环境中，如果您在应用程序的高级别捕获 OutOfMemory 错误，则可能会引用很多内容超出范围并且可以回收以归还内存。

在单个过度分配的情况下，应用程序可能能够继续完美地工作。当然，如果你有一个逐渐的内存泄漏，你只会再次遇到问题（更有可能迟早），但给应用程序一个优雅地关闭的机会，保存未保存的更改仍然是一个好主意。 GUI应用程序等的情况。

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2009-01-03T23:33:38.810

是的，OOM 是可恢复的。作为一个极端的例子，Unix 和 Windows 操作系统在大多数情况下都能很好地从 OOM 条件中恢复。应用程序失败，但操作系统仍然存在（假设有足够的内存供操作系统首先正确启动）。

我只是举这个例子来说明它是可以做到的。

处理OOM的问题真的取决于你的程序和环境。

例如，在许多情况下，最有可能发生 OOM 的地方并不是真正从 OOM 状态恢复的最佳地方。

现在，自定义分配器可以作为处理 OOM 的代码中的中心点。Java 分配器会在实际抛出 OOM 异常之前执行一次完整的 GC。

您的分配器越“了解应用程序”，它就越适合作为 OOM 的中央处理程序和恢复代理。再次使用 Java，它的分配器并不是特别适用于应用程序。

这就是Java之类的东西很容易令人沮丧的地方。您不能覆盖分配器。因此，虽然您可以在自己的代码中捕获 OOM 异常，但并没有说您正在使用的某些库正确地捕获了，甚至正确地抛出了 OOM 异常。创建一个永远被 OOM 异常破坏的类是微不足道的，因为某些对象被设置为 null 并且“永远不会发生”，并且永远无法恢复。

所以，是的，OOM 是可恢复的，但它可能非常困难，特别是在 Java 等现代环境中，它有大量不同质量的 3rd 方库。

* * *

## 回答 #12

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:05:09.233

这取决于您所说的内存不足是什么意思。

在`malloc()`大多数系统上失败时，这是因为您的地址空间已用完。

如果大部分内存被缓存或 mmap'd 区域占用，您可以通过释放缓存或取消映射来回收其中的一部分。然而，这确实需要您知道您使用该内存的目的 - 正如您已经注意到的那样，大多数程序都没有，或者它没有任何区别。

如果您`setrlimit()`在自己身上使用过（可能是为了防止不可预见的攻击，或者可能是 root 对您做了），您可以放宽错误处理程序中的限制。我经常这样做——如果可能的话，在提示用户并记录事件之后。

另一方面，捕捉堆栈溢出有点困难，并且不可移植。[我为ECL](http://ecls.sf.net/)写了一个 posixish 解决方案，并描述了一个 Windows 实现，如果你走这条路的话。几个月前它被检查到 ECL 中，但如果你有兴趣，我可以挖掘原始补丁。

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2013-08-05T19:02:26.717

这个问题被标记为“与语言无关”，但如果不考虑语言和/或底层系统就很难回答。（我看到几个 toher hadns

如果内存分配是隐式的，没有机制来检测给定的分配是否成功，那么从内存不足的情况中恢复可能很困难或不可能。

例如，如果您调用一个试图分配一个巨大数组的函数，大多数语言只是不定义无法分配数组时的行为。（在 Ada 中，这引发了一个`Storage_Error`例外，至少在原则上，应该可以处理它。）

另一方面，如果您有一种尝试分配内存并能够报告分配失败的机制（如 C`malloc()`或 C++ 的`new`），那么是的，当然可以从该失败中恢复。至少在 and 的情况下`malloc()`，`new`失败的分配除了报告失败之外什么都不做（例如，它不会破坏任何内部数据结构）。

尝试恢复是否有意义取决于应用程序。如果应用程序在分配失败后无法成功，那么它应该尽其所能进行清理并终止。但是如果分配失败仅仅意味着一个特定的任务无法执行，或者如果任务仍然可以用更少的内存更慢地执行，那么继续操作是有意义的。

一个具体的例子：假设我正在使用文本编辑器。如果我尝试在编辑器中执行一些需要大量内存的操作，而该操作无法执行，我希望编辑器告诉我它不能按照我的要求进行操作*，让我继续编辑*。在不保存我的工作的情况下终止将是不可接受的反应。保存我的工作并终止会更好，但仍然不必要地对用户怀有敌意。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T12:05:09.887

这是一个困难的问题。乍一看，似乎没有更多的记忆意味着“运气不好”，但是，您还必须看到，如果一个人真的坚持，一个人可以摆脱许多与记忆相关的东西。让我们以其他方式破坏函数 strtok ，一方面它在内存方面没有问题。然后从 Glib 库中获取对应的 g_string_split，它在很大程度上依赖于内存分配，就像 glib 或基于 GObject 的程序中的几乎所有内容一样。可以肯定地说，在更动态的语言中，内存分配比在更不灵活的语言中使用得更多，尤其是 C。但让我们看看替代方案。如果你在内存不足的情况下结束程序，即使是仔细开发的代码也可能停止工作。但是如果你有一个可恢复的错误，你可以做一些事情。所以论据，

所以最有说服力的原因是。如果您提供一种恢复方法，可以尝试恢复，如果您没有选择，则完全取决于始终获得足够的内存...

问候

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2009-01-03T23:35:41.253

内存不足通常意味着你必须放弃你正在做的任何事情。但是，如果您小心清理，它可以使程序本身运行并能够响应其他请求。让程序说“抱歉，内存不足”比说“抱歉，内存不足，正在关闭”要好。

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2008-12-11T21:35:45.063

现在只是让我感到困惑。

在工作中，我们有一堆应用程序一起工作，内存不足。虽然问题是要么使应用程序包变为 64 位（因此，能够超出我们在普通 Win32 操作系统上的 2 Go 限制），和/或减少我们对内存的使用，这个问题“如何从OOM中恢复”不会让我失望。

当然，我没有解决方案，但仍然在为 C++ 寻找一个解决方案（主要是因为 RAII 和异常）。

也许应该优雅恢复的进程应该在原子/可回滚任务中分解其处理（即仅使用提供强/不抛出异常保证的函数/方法），并为恢复目的保留“缓冲区/内存池”。

如果其中一项任务失败，C++ bad_alloc 将展开堆栈，通过 RAII 释放一些堆栈/堆内存。然后，恢复功能将尽可能多地挽救（将任务的初始数据保存在磁盘上，以供以后尝试使用），并可能注册任务数据以供以后尝试。

我确实相信使用 C++ strong/nothrow 保证可以帮助进程在低可用内存条件下生存，即使它类似于内存交换（即缓慢、有点无响应等），但当然，这是只有理论。在尝试模拟之前，我只需要在这个主题上变得更聪明（即创建一个 C++ 程序，使用具有有限内存的自定义新/删除分配器，然后尝试在那些压力条件下做一些工作）。

出色地...

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2012-01-04T18:24:58.820

> 使它成为可恢复错误的有力论据是什么？

*在 Java 中，不*使其成为可恢复错误的一个令人信服的论点是，因为 Java 允许在*任何*时候发出 OOM 信号，包括在结果可能是您的程序进入不一致状态的时候。因此，不可能从 OOM 中可靠地恢复；如果您捕获 OOM 异常，则不能*依赖*任何程序状态。请参阅
[无抛出 VirtualMachineError 保证](https://stackoverflow.com/questions/8728866/no-throw-virtualmachineerror-guarantees)

* * *

## 回答 #18

> 赞同：0
> 
>             
> 
> 时间：2009-05-18T19:50:57.753

如果您真的内存不足，那么您注定要失败，因为您再也无法释放任何东西。

如果你的内存不足，但是像垃圾收集器这样的东西可以启动并释放一些内存，你还没有死。

另一个问题是碎片化。尽管您可能没有内存不足（碎片化），但您可能仍然无法分配您想要的大块。

* * *

## 回答 #19

> 赞同：0
> 
>             
> 
> 时间：2009-02-03T08:06:09.427

内存不足可能是由于可用内存耗尽或试图分配一个不合理的大块（如一个演出）。在“耗尽”情况下，内存不足对系统来说是全局性的，通常会影响其他应用程序和系统服务，整个系统可能会变得不稳定，因此最好忘记并重新启动。在“不合理的大块”情况下，实际上并没有发生短缺，继续下去是安全的。问题是您无法自动检测您所处的情况。因此，使错误不可恢复并为遇到此错误的每种情况找到解决方法会更安全 - 使您的程序使用更少的内存，或者在某些情况下只需修复调用内存分配的代码中的错误。

* * *

## 回答 #20

> 赞同：0
> 
>             
> 
> 时间：2010-01-13T15:31:16.700

当没有更多内存要动态分配时，uClibc 有一个 8 字节左右的内部静态缓冲区用于文件 I/O。

* * *

## 回答 #21

> 赞同：0
> 
>             
> 
> 时间：2009-02-21T19:26:26.110

这里已经有很多好的答案了。但我想从另一个角度做出贡献。

一般来说，几乎任何可重复使用的资源的消耗都应该是可以恢复的。理由是程序的每个部分基本上都是一个子程序。仅仅因为一个子程序在这个时间点无法完成，并不意味着程序的整个状态都是垃圾。仅仅因为停车场里停满了汽车并不意味着你把你的车扔了。要么您等待一段时间让摊位免费，要么您开车到更远的商店购买饼干。

在大多数情况下，还有另一种方法。使错误无法恢复，有效地消除了很多选择，我们谁都不喜欢让任何人为我们决定我们能做什么和不能做什么。

这同样适用于磁盘空间。这其实是一样的道理。与您暗示堆栈溢出是不可恢复的相反，我会说这是任意限制。没有充分的理由不应该抛出异常（弹出很多帧）然后使用另一种效率较低的方法来完成工作。

我的两分钱:-)

* * *

## 回答 #22

> 赞同：0
> 
>             
> 
> 时间：2009-11-09T21:33:08.317

我知道你要求争论，但我只能看到反对的争论。

我无论如何都看不到在多线程应用程序中实现这一点。你怎么知道哪个线程实际上是造成内存不足错误的原因？一个线程可以不断地分配新内存，并且 gc-root 占堆的 99%，但第一次分配失败发生在另一个线程中。

一个实际的例子：每当我在我们的 Java 应用程序（在 JBoss 服务器上运行）中发生 OutOfMemoryError 时，并不是一个线程死掉而服务器的其余部分继续运行：不，有几个 OOME，杀死了几个线程（一些其中是 JBoss 的内部线程）。我看不出我作为一名程序员可以做些什么来从中恢复——甚至 JBoss 可以做些什么来从中恢复。实际上，我什至不确定您是否可以：[VirtualMachineError 的 javadoc](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/VirtualMachineError.html)表明在抛出此类错误后 JVM 可能会“损坏”。但也许这个问题更针对语言设计。

* * *

## 回答 #23

> 赞同：0
> 
>             
> 
> 时间：2019-11-19T13:10:12.913

我正在研究 SpiderMonkey，它是 Firefox（以及 gnome 和其他一些）中使用的 JavaScript VM。当您内存不足时，您可能需要执行以下任何操作：

1.  运行垃圾收集器。我们不会一直运行垃圾收集器，因为它会降低性能和电池电量，因此当您遇到内存不足错误时，可能已经积累了一些垃圾。

2.  空闲内存。例如，摆脱一些内存缓存。

3.  杀死或推迟非必要的任务。例如，从内存中卸载一些长时间未使用的选项卡。

4.  记录事情以帮助开发人员解决内存不足错误。

5.  显示一条不错的错误消息，让用户知道发生了什么。

6.  ...

所以是的，手动处理内存不足错误的原因有很多！

* * *

## 回答 #24

> 赞同：-1
> 
>             
> 
> 时间：2009-08-07T13:40:57.750

我有这个：

```
void *smalloc(size_t size) {
  void *mem = null; 
  for(;;) {
   mem = malloc(size);
   if(mem == NULL) {
    sleep(1);
   } else 
     break;
  }
  return mem;
} 
```

这已经保存了几次系统。仅仅因为您现在内存不足，并不意味着系统的其他部分或系统上运行的其他进程有一些内存，它们很快就会归还。在尝试这些技巧之前，您最好非常小心，并且可以完全控制您在程序中分配的每个内存。

# c# - 评估字符串 "3*(4+2)" 产生 int 18

> ID：333737
> 
>         
> 
> 赞同：112
> 
>         
> 
> 时间：2008-12-02T11:57:15.660
> 
>         
> 
> 标签：c#, string, math, numeric, evaluate

.NET 框架中是否有一个函数可以计算字符串中包含的数值表达式并返回结果？铁：

```
string mystring = "3*(2+4)";
int result = EvaluateExpression(mystring);
Console.Writeln(result); // Outputs 18 
```

是否有一个标准的框架函数可以替换我的`EvaluateExpression`方法？

* * *

## 回答 #1

> 赞同：182
> 
>             
> 
> 时间：2012-06-14T09:03:13.200

如果要评估字符串表达式，请使用以下代码片段。

```
using System.Data;

DataTable dt = new DataTable();
var v = dt.Compute("3 * (2+4)",""); 
```

* * *

## 回答 #2

> 赞同：84
> 
>             
> 
> 时间：2009-10-14T07:47:01.253

使用编译器来做意味着内存泄漏，因为生成的程序集被加载并且从未释放。它的性能也低于使用真正的表达式解释器。为此，您可以使用[Ncalc](https://github.com/sheetsync/NCalc)，它是一个仅用于此目的的开源框架。如果已经包含的变量和自定义函数还不够，您还可以定义自己的变量和自定义函数。

例子：

```
Expression e = new Expression("2 + 3 * 5");
Debug.Assert(17 == e.Evaluate()); 
```

* * *

## 回答 #3

> 赞同：51
> 
>             
> 
> 时间：2009-09-13T11:13:41.233

尝试这个：

```
static double Evaluate(string expression) {
  var loDataTable = new DataTable();
  var loDataColumn = new DataColumn("Eval", typeof (double), expression);
  loDataTable.Columns.Add(loDataColumn);
  loDataTable.Rows.Add(0);
  return (double) (loDataTable.Rows[0]["Eval"]);
} 
```

* * *

## 回答 #4

> 赞同：15
> 
>             
> 
> 时间：2009-09-13T10:47:48.460

你可以看看“XpathNavigator.Evaluate”，我用它来处理我的 GridView 的数学表达式，它对我来说很好用。

这是我用于我的程序的代码：

```
public static double Evaluate(string expression)
{
    return (double)new System.Xml.XPath.XPathDocument
    (new StringReader("<r/>")).CreateNavigator().Evaluate
    (string.Format("number({0})", new
    System.Text.RegularExpressions.Regex(@"([\+\-\*])")
    .Replace(expression, " ${1} ")
    .Replace("/", " div ")
    .Replace("%", " mod ")));
} 
```

* * *

## 回答 #5

> 赞同：14
> 
>             
> 
> 时间：2012-03-16T02:56:13.423

```
static double Evaluate(string expression) { 
  var loDataTable = new DataTable(); 
  var loDataColumn = new DataColumn("Eval", typeof (double), expression); 
  loDataTable.Columns.Add(loDataColumn); 
  loDataTable.Rows.Add(0); 
  return (double) (loDataTable.Rows[0]["Eval"]); 
} 
```

解释它是如何工作的：

首先，我们在 part 中创建一个表`var loDataTable = new DataTable();`，就像在数据库引擎中一样（例如 MS SQL）。

然后是一列，带有一些特定参数 ( `var loDataColumn = new DataColumn("Eval", typeof (double), expression);`)。

`"Eval"`参数是列的名称（ColumnName 属性）。

`typeof (double)``System.Type.GetType("System.Double");`是要存储在列中的数据类型，取而代之等于put 。

`expression`是`Evaluate`方法接收的字符串，存储在`Expression`列的属性中。此属性用于一个非常特定的目的（很明显），即放在列上的每一行都将用“表达式”填充，并且它实际上接受可以放在 SQL 查询中的任何内容。请参阅[http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression(v=vs.100).aspx)以了解可以在 Expression 属性中放入什么以及如何评估它。

然后，`loDataTable.Columns.Add(loDataColumn);`将该列添加`loDataColumn`到`loDataTable`表中。

然后，将一行添加到表中，其中包含具有 Expression 属性的个性化列，通过`loDataTable.Rows.Add(0);`. 当我们添加这一行时，表格的“Eval”列的单元格`loDataTable`会自动填充其“Expression”属性，如果它有运算符和SQL查询等，它会被评估然后存储到单元格中，所以，这里发生了“魔术”，带有运算符的字符串被评估并存储到一个单元格中......

最后，只需将存储的值返回到第 0 行中“Eval”列的单元格（它是一个索引，从零开始计数），并使用`return (double) (loDataTable.Rows[0]["Eval"]);`.

这就是所有......工作完成！

这里有一个更容易理解的代码，它的作用相同......它不在方法内部，它也被解释了。

```
DataTable MyTable = new DataTable();
DataColumn MyColumn = new DataColumn();
MyColumn.ColumnName = "MyColumn";
MyColumn.Expression = "5+5/5"
MyColumn.DataType = typeof(double);
MyTable.Columns.Add(MyColumn);
DataRow MyRow = MyTable.NewRow();
MyTable.Rows.Add(MyRow);
return (double)(MyTable.Rows[0]["MyColumn"]); 
```

首先，创建表`DataTable MyTable = new DataTable();`

然后，一列`DataColumn MyColumn = new DataColumn();`

接下来，我们为列命名。这样我们就可以在它存储到表时搜索它的内容。通过完成`MyColumn.ColumnName = "MyColumn";`

然后是表达式，这里我们可以放一个字符串类型的变量，在这种情况下有一个预定义的字符串“5+5/5”，结果是6。

要存储到列中的数据类型`MyColumn.DataType = typeof(double);`

将列添加到表中...`MyTable.Columns.Add(MyColumn);`

将一行插入到表中，复制表结构`DataRow MyRow = MyTable.NewRow();`

将行添加到表中`MyTable.Rows.Add(MyRow);`

`MyColumn`并返回表格列的第 0 行单元格的`MyTable`值`return (double)(MyTable.Rows[0]["MyColumn"]);`

教训完了！！！

* * *

## 回答 #6

> 赞同：14
> 
>             
> 
> 时间：2010-11-16T14:54:20.537

这是一个使用 Stacks 的简单表达式求值器

```
public class MathEvaluator
{
    public static void Run()
    {
        Eval("(1+2)");
        Eval("5*4/2");
        Eval("((3+5)-6)");
    }

    public static void Eval(string input)
    {
        var ans = Evaluate(input);
        Console.WriteLine(input + " = " + ans);
    }

    public static double Evaluate(String input)
    {
        String expr = "(" + input + ")";
        Stack<String> ops = new Stack<String>();
        Stack<Double> vals = new Stack<Double>();

        for (int i = 0; i < expr.Length; i++)
        {
            String s = expr.Substring(i, 1);
            if (s.Equals("(")){}
            else if (s.Equals("+")) ops.Push(s);
            else if (s.Equals("-")) ops.Push(s);
            else if (s.Equals("*")) ops.Push(s);
            else if (s.Equals("/")) ops.Push(s);
            else if (s.Equals("sqrt")) ops.Push(s);
            else if (s.Equals(")"))
            {
                int count = ops.Count;
                while (count > 0)
                {
                    String op = ops.Pop();
                    double v = vals.Pop();
                    if (op.Equals("+")) v = vals.Pop() + v;
                    else if (op.Equals("-")) v = vals.Pop() - v;
                    else if (op.Equals("*")) v = vals.Pop()*v;
                    else if (op.Equals("/")) v = vals.Pop()/v;
                    else if (op.Equals("sqrt")) v = Math.Sqrt(v);
                    vals.Push(v);

                    count--;
                }
            }
            else vals.Push(Double.Parse(s));
        }
        return vals.Pop();
    }
} 
```

* * *

## 回答 #7

> 赞同：7
> 
>             
> 
> 时间：2011-03-14T12:18:48.637

这是从右到左执行，所以需要使用适当的括号来执行表达式

```
 // 2+(100/5)+10 = 32
    //((2.5+10)/5)+2.5 = 5
    // (2.5+10)/5+2.5 = 1.6666
    public static double Evaluate(String expr)
    {

        Stack<String> stack = new Stack<String>();

        string value = "";
        for (int i = 0; i < expr.Length; i++)
        {
            String s = expr.Substring(i, 1);
            char chr = s.ToCharArray()[0];

            if (!char.IsDigit(chr) && chr != '.' && value != "")
            {
                stack.Push(value);
                value = "";
            }

            if (s.Equals("(")) {

                string innerExp = "";
                i++; //Fetch Next Character
                int bracketCount=0;
                for (; i < expr.Length; i++)
                {
                    s = expr.Substring(i, 1);

                    if (s.Equals("("))
                        bracketCount++;

                    if (s.Equals(")"))
                        if (bracketCount == 0)
                            break;
                        else
                            bracketCount--;

                    innerExp += s;
                }

                stack.Push(Evaluate(innerExp).ToString());

            }
            else if (s.Equals("+")) stack.Push(s);
            else if (s.Equals("-")) stack.Push(s);
            else if (s.Equals("*")) stack.Push(s);
            else if (s.Equals("/")) stack.Push(s);
            else if (s.Equals("sqrt")) stack.Push(s);
            else if (s.Equals(")"))
            {
            }
            else if (char.IsDigit(chr) || chr == '.')
            {
                value += s;

                if (value.Split('.').Length > 2)
                    throw new Exception("Invalid decimal.");

                if (i == (expr.Length - 1))
                    stack.Push(value);

            }
            else
                throw new Exception("Invalid character.");

        }

        double result = 0;
        while (stack.Count >= 3)
        {

            double right = Convert.ToDouble(stack.Pop());
            string op = stack.Pop();
            double left = Convert.ToDouble(stack.Pop());

            if (op == "+") result = left + right;
            else if (op == "+") result = left + right;
            else if (op == "-") result = left - right;
            else if (op == "*") result = left * right;
            else if (op == "/") result = left / right;

            stack.Push(result.ToString());
        }

        return Convert.ToDouble(stack.Pop());
    } 
```

* * *

## 回答 #8

> 赞同：4
> 
>             
> 
> 时间：2011-06-11T11:34:16.513

**编辑：**意识到我真的应该把加法和减法分别拿出来，让它更符合 BODMAS 标准。

非常感谢 Rajesh Jinaga 的基于 Stack 的方法。我发现它对我的需求非常有用。下面的代码是对 Rajesh 方法的轻微修改，它首先处理除法，然后是乘法，最后是加法和减法。它还允许在表达式中使用布尔值，其中 true 被视为 1，false 被视为 0。允许在表达式中使用布尔逻辑。

```
public static double Evaluate(string expr)
    {
        expr = expr.ToLower();
        expr = expr.Replace(" ", "");
        expr = expr.Replace("true", "1");
        expr = expr.Replace("false", "0");

        Stack<String> stack = new Stack<String>();

        string value = "";
        for (int i = 0; i < expr.Length; i++)
        {
            String s = expr.Substring(i, 1);
            // pick up any doublelogical operators first.
            if (i < expr.Length - 1)
            {
                String op = expr.Substring(i, 2);
                if (op == "<=" || op == ">=" || op == "==")
                {
                    stack.Push(value);
                    value = "";
                    stack.Push(op);
                    i++;
                    continue;
                }
            }

            char chr = s.ToCharArray()[0];

            if (!char.IsDigit(chr) && chr != '.' && value != "")
            {
                stack.Push(value);
                value = "";
            }
            if (s.Equals("("))
            {
                string innerExp = "";
                i++; //Fetch Next Character
                int bracketCount = 0;
                for (; i < expr.Length; i++)
                {
                    s = expr.Substring(i, 1);

                    if (s.Equals("(")) bracketCount++;

                    if (s.Equals(")"))
                    {
                        if (bracketCount == 0) break;
                        bracketCount--;
                    }
                    innerExp += s;
                }
                stack.Push(Evaluate(innerExp).ToString());
            }
            else if (s.Equals("+") ||
                     s.Equals("-") ||
                     s.Equals("*") ||
                     s.Equals("/") ||
                     s.Equals("<") ||
                     s.Equals(">"))
            {
                stack.Push(s);
            }
            else if (char.IsDigit(chr) || chr == '.')
            {
                value += s;

                if (value.Split('.').Length > 2)
                    throw new Exception("Invalid decimal.");

                if (i == (expr.Length - 1))
                    stack.Push(value);

            }
            else
            {
                throw new Exception("Invalid character.");
            }

        }
        double result = 0;
        List<String> list = stack.ToList<String>();
        for (int i = list.Count - 2; i >= 0; i--)
        {
            if (list[i] == "/")
            {
                list[i] = (Convert.ToDouble(list[i - 1]) / Convert.ToDouble(list[i + 1])).ToString();
                list.RemoveAt(i + 1);
                list.RemoveAt(i - 1);
                i -= 2;
            }
        }

        for (int i = list.Count - 2; i >= 0; i--)
        {
            if (list[i] == "*")
            {
                list[i] = (Convert.ToDouble(list[i - 1]) * Convert.ToDouble(list[i + 1])).ToString();
                list.RemoveAt(i + 1);
                list.RemoveAt(i - 1);
                i -= 2;
            }
        }
        for (int i = list.Count - 2; i >= 0; i--)
        {
            if (list[i] == "+")
            {
                list[i] = (Convert.ToDouble(list[i - 1]) + Convert.ToDouble(list[i + 1])).ToString();
                list.RemoveAt(i + 1);
                list.RemoveAt(i - 1);
                i -= 2;
            }
        }
        for (int i = list.Count - 2; i >= 0; i--)
        {
            if (list[i] == "-")
            {
                list[i] = (Convert.ToDouble(list[i - 1]) - Convert.ToDouble(list[i + 1])).ToString();
                list.RemoveAt(i + 1);
                list.RemoveAt(i - 1);
                i -= 2;
            }
        }
        stack.Clear();
        for (int i = 0; i < list.Count; i++)
        {
            stack.Push(list[i]);
        }
        while (stack.Count >= 3)
        {
            double right = Convert.ToDouble(stack.Pop());
            string op = stack.Pop();
            double left = Convert.ToDouble(stack.Pop());

            if (op == "<") result = (left < right) ? 1 : 0;
            else if (op == ">") result = (left > right) ? 1 : 0;
            else if (op == "<=") result = (left <= right) ? 1 : 0;
            else if (op == ">=") result = (left >= right) ? 1 : 0;
            else if (op == "==") result = (left == right) ? 1 : 0;

            stack.Push(result.ToString());
        }
        return Convert.ToDouble(stack.Pop());
    } 
```

我知道可能有一种更清洁的方式来做这件事，我想我只是分享一下它的第一眼，以防有人发现它有用。

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T12:00:48.570

您可以相当容易地通过 CSharpCodeProvider 运行它，并使用合适的绒毛包装它（基本上是一种类型和一种方法）。同样，您可以通过 VB 等 - 或 JavaScript，正如另一个答案所建议的那样。在这一点上，我不知道框架中内置的任何其他内容。

我希望.NET 4.0 支持动态语言在这方面可能有更好的能力。

* * *

## 回答 #10

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T15:44:26.340

我最近需要为一个项目做这件事，我最终使用[IronPython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython "铁蟒")来做这件事。您可以声明引擎的一个实例，然后传递任何有效的 python 表达式并获取结果。如果您只是在做简单的数学表达式，那就足够了。我的代码最终看起来类似于：

```
IronPython.Hosting.PythonEngine pythonEngine = new IronPython.Hosting.PythonEngine();
string expression = "3*(2+4)";
double result = pythonEngine.EvaluateAs<double>(expression); 
```

您可能不想为每个表达式创建引擎。您还需要对 IronPython.dll 的引用

* * *

## 回答 #11

> 赞同：2
> 
>             
> 
> 时间：2012-09-21T22:55:41.610

非常感谢拉梅什。我使用他的简单代码的一个版本从数据库中提取一个字符串，并使用它在我的代码中执行布尔运算。

x 是 1500 或 2100 之类的数字。

函数将是一个存储的评估，如 x > 1400 和 x < 1600

```
function = relation[0].Replace("and","&&").Replace("x",x);

DataTable f_dt = new DataTable();
var f_var = f_dt.Compute(function,"");

if (bool.Parse(f_var.ToString()) { do stuff  } 
```

* * *

## 回答 #12

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T12:03:45.787

那没有。您将需要使用一些外部库，或编写自己的解析器。如果您有时间这样做，我建议您编写自己的解析器，因为这是一个非常有趣的项目。否则，您将需要使用[bcParser 之](http://www.bestcode.com/html/bcparser_net.html)类的东西。

* * *

## 回答 #13

> 赞同：-3
> 
>             
> 
> 时间：2008-12-02T12:02:03.853

简短的回答：我不这么认为。据我所知，C# .Net 已编译（转换为字节码）并且无法在运行时评估字符串。但是，JScript .Net 可以；但我仍然建议您自己编写解析器和基于堆栈的评估器。

# sql - 仅获取与联接表中的所有条目匹配的行 (SQL)

> ID：333750
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-12-02T12:01:45.540
> 
>         
> 
> 标签：sql, join

我有以下五个表：

*   互联网服务提供商

*   产品

*   联系

*   添加在

*   AddOn/Product（多对多关系的数据透视表）。

每个产品都链接到一个 ISP，每个连接都列出一个产品。通过使用数据透视表（只有两个字段，一个用于产品 ID，一个用于附加组件 ID），每个产品都可以有多个附加组件。

我感兴趣的结果是与列出的插件的每个连接（为此，我使用 MySQL 的 GROUP_CONCAT 来制作插件*名称*字段的逗号分隔列表）。这工作正常，查询看起来像这样：

```
SELECT i.name AS ispname, i.img_link, c.download, c.upload, c.monthly_price, c.link, 
GROUP_CONCAT(a.name) AS addons, SUM(pa.monthly_fee) AS addon_price
FROM isp i JOIN product p ON i.id = p.isp_id
JOIN `connection` c ON p.id = c.product_id LEFT JOIN product_addon pa ON pa.product_id = p.id AND pa.forced = 0
LEFT JOIN addon a ON pa.addon_id = a.id GROUP BY c.id 
```

我正在使用 LEFT JOINS，因为产品可能根本没有插件。

我的问题是可以选择列出的连接必须具有的一些插件，以插件 ID 列表的形式呈现，例如 (1,14,237)。如果我将其作为附加条件放入 JOIN 语句（*AND pa.addon_id IN (...)*）中，它将返回仅具有列出的插件之一的所有连接，但不一定是全部。

是否有某种方法可以通过 SQL 返回所有**至少**具有所有插件（它们也可以有附加）的连接？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T13:11:06.977

```
GROUP BY set-of-column
HAVING SUM(CASE WHEN ISNULL(pa.addon_id, 0) IN (1,14,237) THEN 1 ELSE 0 END) = 3 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T12:30:30.303

您可以添加到 WHERE 子句：

```
AND NOT EXISTS (SELECT NULL FROM addon a2
                WHERE  a2.addon_id IN (1,14,237)
                AND NOT EXISTS
                ( SELECT NULL
                  FROM   product_addon pa2
                  WHERE  pa2.addon_id = a2.addon_id
                  AND    pa2.product_id = p.product_id
                )
               ) 
```

或等效地：

```
AND NOT EXISTS (SELECT NULL FROM addon a2
                LEFT JOIN product_addon pa2
                  ON pa2.addon_id = a2.addon_id
                 AND pa2.product_id = p.product_id
                WHERE a2.addon_id IN (1,14,237)
                AND   pa2.product_id IS NULL
                )
               ) 
```

# c# - 部署dll后如何在C#中获取安装目录

> ID：333767
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2008-12-02T12:10:04.883
> 
>         
> 
> 标签：c#, deployment, interop

在从不同文件夹中的应用程序调用的 dll (C#) 中工作时，是否有一些聪明的方法来检索安装路径？

我正在为应用程序开发加载项。我的加载项是用 C# 编写的。将使用的应用程序是用 C 编写的，需要在评估期间编译一些东西，所以我有一个 C++ dll 的中间步骤，它处理与 C# 的互操作业务，并且只向外显示一个 C 可以使用的干净接口。

我部署的是一组 .dll 和一个用于 C++ 部分的 .lib 和 .h（有时需要静态绑定）。

尝试设置并从 C# dll 打印出当前目录信息时：

```
 Console.WriteLine(Directory.GetCurrentDirectory()); 
```

或者：

```
 Console.WriteLine(System.Environment.CurrentDirectory); 
```

我得到了可执行文件路径。

所以......再一次，我如何获得我的dll的安装路径？

编辑：他们都工作！感谢你们的快速回复！

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2008-12-02T12:16:14.823

我想你想要的是`Assembly.GetExecutingAssembly().Location`。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2013-04-03T09:20:34.880

这两种方式之一：

```
using System.IO;
using System.Windows.Forms;
string appPath = Path.GetDirectoryName(Application.ExecutablePath); 
```

或者：

```
using System.IO;
using System.Reflection;
string path = Path.GetDirectoryName(
Assembly.GetAssembly(typeof(MyClass)).CodeBase); 
```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T12:18:45.490

试试这个：

```
typeof(TypeInMyModule).Assembly.Location 
```

# mysql - MySQL LEFT JOIN 问题 - 缺少 LEFT 列

> ID：333771
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-12-02T12:12:56.453
> 
>         
> 
> 标签：mysql, left-join

我在用于显示自定义配置文件字段和任何（可选）相应值的 SQL 查询时遇到问题。

这是我正在使用的 SQL 查询：

```
SELECT pf.`id`, pf.`name`, pv.`value` FROM `profile_fields` AS pf
LEFT JOIN `profile_values` AS pv ON (pf.`id` = pv.`field_id`)
WHERE (pf.`site_id` = '0' OR pf.`site_id` = '%d') AND (pv.`user_id` = '%d' OR pv.`user_id` IS NULL)
ORDER BY pf.`order` ASC 
```

我遇到的问题是，任何没有相应`profile_values`记录的列都没有显示，当它们应该显示时，它们只是一个空值。

非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-12-02T12:19:10.403

尝试将配置文件值条件移动到 JOIN 语句：

```
 SELECT pf.`id`, pf.`name`, pv.`value` FROM `profile_fields` AS pf
 LEFT JOIN `profile_values` AS pv ON (
         pf.`id` = pv.`field_id`  AND 
         (pv.`user_id` = '%d' OR pv.`user_id` IS NULL)
  )
 WHERE (pf.`site_id` = '0' OR pf.`site_id` = '%d')
 ORDER BY pf.`order` ASC 
```

# javascript - 使用 Javascript 链接到页面并扩展主题

> ID：333776
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-12-02T12:14:15.360
> 
>         
> 
> 标签：javascript

我想链接到包含多个支持主题的页面。当用户在外部站点上单击链接时，应在用户到达支持页面后立即展开主题。

例子：

我链接到这个页面

```
http://www.nintendo.de/NOE/de_DE/support/nintendo_ds_lite_159_142.html 
```

主题我想在抵达时打开

```
javascript:fadeNAppearDiv('box_3_9277'); 
```

（常见问题解答中的第一个主题）

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T12:23:40.457

目前尚不清楚您是否正在维护目标站点（div 将打开的位置）。如果您无权访问该页面的代码，则无法调用其上的 javascript 函数。如果您可以修改该页面，则可以按照@PhiLho 的建议进行操作，并修改您使用的 URL 以指定要打开的 DIV，并拥有一个解析 URL 并打开相应 DIV 的 onLoad 处理程序。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T12:20:31.900

好主意，但我没有看到问题...... :-)

我在一些网站上看到的方式，比如 deviantART，是使用尖锐的锚符号：myURL.com/foo/page.html#TopicToExpand

JS 可以分析当前 URL 并获取锚点部分，然后执行您需要执行的任何操作以突出显示/跳转到正确的位置。

# delphi - 如何使用 FastReport 根据 DataSet 中字段的值打印不同的波段？

> ID：333780
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-12-02T12:14:45.170
> 
>         
> 
> 标签：delphi, fastreport

我有一个产品的数据集，我想为每种类型的产品设置不同的波段，例如，如果产品是水果，打印它的重量，如果产品是汽车，打印它的颜色等等。

而且我想让我的用户自定义它，这样每种产品的每个频段都将是完美的。

我的数据集包含来自所有类型产品的所有字段，并且我有一个字段确定实际记录的产品类型。

有一些简单的方法可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T17:18:25.823

FastReports 允许您在几个有用的地方通过事件拦截程序的默认报表构建过程。例如，如果您在其 OnBeforePrint 事件中有一个 master band，您可以放置​​检查产品类型的代码，然后 case 语句可以将 visible 属性设置为 true，仅在属于正确属性类型的 detail band 上。  

我发现[news://newsgroups.fast-report.com/fast-reports.public.fastreport.4](http://news://newsgroups.fast-report.com/fast-reports.public.fastreport.4 "快速报告")上的新闻组是一个令人难以置信的帮助和鼓励来源。我相信您可以在那里找到更好的问题答案。

# svn - 为什么我可以两次创建相同的 SVN 分支？

> ID：333785
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-12-02T12:16:06.667
> 
>         
> 
> 标签：svn, branch

我能够两次创建相同的 SVN 分支。我希望 SVN 不会允许我再次创建相同的分支。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2008-12-02T12:28:20.400

来自[SVN 红皮书](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.branchmerge.using.concepts)：

> Subversion 没有内部的分支概念——它只知道如何进行复制。当您复制一个目录时，生成的目录只是一个“分支”，因为您将那个含义附加到它上面。你可能对目录有不同的看法，或者对它有不同的处理方式，但对于 Subversion 来说，它只是一个普通的目录，恰好包含一些额外的历史信息。
> 
> 由于这种复制机制，Subversion 的分支作为存储库中的普通文件系统目录存在。

因此，当您创建分支“补丁”时，您的存储库中可以有多个目录“补丁”。

当您在区分大小写的操作系统中使用不同的大小写（补丁与补丁）在同一父目录中创建两次“补丁”时，您可能会感到困惑。

* * *

为了更好地回答您的问题：

> 我希望 SVN 不会允许我再次创建相同的分支。

如果您真的想防止任何“与案例相关的路径冲突”，您可以设置一个**预提交挂钩**（也[由 svn copy 触发](http://archives.devshed.com/forums/development-94/pre-commit-hook-not-triggered-with-svn-copy-url-url-2148786.html)），就像这个一样，来自[svn tools contrib](http://subversion.tigris.org/tools_contrib.html)

**[不区分大小写.py](http://svn.collab.net/repos/svn/trunk/contrib/hook-scripts/case-insensitive.py)**：

*   检测与现有或其他新路径“冲突”的新路径。

*   忽略已经“冲突”的现有路径

*   如果检测到“冲突”，则以错误代码退出，并在 stderr 上进行诊断。

使用该钩子，您仍然可以创建多个具有相同名称的分支，但至少不在同一个父目录中，但大小写不同。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:23:47.327

在 SVN 中，分支（和标签也是）只是副本。

SVN 不知道分支是什么，它只知道副本。SVN 用户赋予这些副本分支的含义，但这只是人们遵循的约定，而不是 SVN。

# language-agnostic - 给孩子们教基础2记谱法

> ID：333796
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-12-02T12:21:44.063
> 
>         
> 
> 标签：language-agnostic

这不完全是一个编程问题，但它是相关的。

不久前，我读过一篇引人入胜的文章，关于一位老师解释了他如何向一年级的孩子教授 base 2 符号，甚至没有“教”他们任何东西，而是让他们通过提出相关问题来发现问题和解决方案。

我在网络上的任何地方都找不到这篇文章了——有人可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-12-02T12:25:47.723

他使用的是苏格拉底式的方法，因此搜索产生  了由 Rick Garlikov 提出[的通过询问而不是通过讲述来教学。](http://www.garlikov.com/Soc_Meth.html)

从文中：

> 实验是看我是否可以教这些学生二进制算术 [...]

但只有您知道这是否是您要查找的文章。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T12:40:30.983

我学习班社会能力的一种方法：悖论干预。

声称你可以用十根手指数到 1024。他们不会相信你，但你可以。每个手指代表一个数字。如果您的手指伸出，则代表 1，否则代表 0。所有十根手指伸出将代表 1023。

您也可以使用“Die Sendung mit der Maus”（德语教学电视）中的方法进行尝试。一个带有按钮的弹珠滑道，每个转弯处有一盏灯：所有灯熄灭：0 如果你扔一个弹珠，它会击中第一个按钮并掉出滑道。如果你扔第二个，按钮会再次切换（灯 1 关闭），让弹珠滚得更远。弹珠会碰到第二个开关（灯 2 亮）并从运行中掉出。

所以孩子们可以看到，如何以 2 为底数。它可能会帮助你

# java - 是否有免费工具来分析 Java 方法的执行时间？

> ID：333804
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-12-02T12:24:27.820
> 
>         
> 
> 标签：java, methods, benchmarking

我需要知道其他应用程序在执行时对我的项目中创建的 api 的 java 方法的使用情况，有人知道任何免费工具来了解这一点吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T12:26:13.713

好像你需要一个分析器。[VisualVM](https://visualvm.dev.java.net/)包含一个。它可能不是最强大的，但它相当易于使用，并且自 1.6.0_07 以来它随 Sun JDK 一起提供。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T16:05:38.497

是的，您可以下载[Netbeans 分析器](http://profiler.netbeans.org/)，在其中您可以查看统计信息和线程执行情况。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-11-12T15:37:06.577

检查[贾蒙](http://jamonapi.sourceforge.net/)。适用于旧的 JDKS，并且非常易于使用。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T12:42:40.340

也许您可以尝试应用一些面向方面的编程。日志记录似乎是其用法的经典示例。尝试例如[AspectJ](http://en.wikipedia.org/wiki/AspectJ)。

# java - 使用 Java，如何获取 Windows 机器上所有本地用户的列表

> ID：333812
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-12-02T12:29:39.960
> 
>         
> 
> 标签：java, windows, security, operating-system

如何使用java列出在Windows机器（Win2000+）上配置的所有本地用户。

如果可能的话，我宁愿使用任何 java 2 com 桥或任何其他第三方库来执行此操作。

首选Java的一些本机方法。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T12:55:58.147

使用 Java-COM Bridge ，例如[Jacob](http://danadler.com/jacob/)。然后选择适当的 COM 库，例如[用于 WMI 的 COM API](http://msdn.microsoft.com/en-us/library/aa389276(VS.85).aspx)以列出本地用户或任何其他 Windows 管理信息。

Win32_SystemUsers关联 WMI 类将计算机系统和该系统上的用户帐户相关联[。](http://msdn.microsoft.com/en-us/library/aa394490(VS.85).aspx)

Win32_Account抽象 WMI 类包含[有关](http://msdn.microsoft.com/en-us/library/aa394061(VS.85).aspx)运行 Windows 的计算机系统已知的用户帐户和组帐户的信息。Windows NT 域识别的用户或组名是此类的后代（或成员）。

工作示例（jacob 1.17-M2，javaSE-1.6）：

```
import java.util.Enumeration;
import com.jacob.activeX.ActiveXComponent;
import com.jacob.com.ComThread;
import com.jacob.com.EnumVariant;
import com.jacob.com.Variant;

public class ComTst {
public static void main(String[] args) {
    ComThread.InitMTA();
    try {
        ActiveXComponent wmi = new ActiveXComponent("winmgmts:\\\\.");
        Variant instances = wmi.invoke("InstancesOf", "Win32_SystemUsers");
        Enumeration<Variant> en = new EnumVariant(instances.getDispatch());
        while (en.hasMoreElements())
        {
            ActiveXComponent bb = new ActiveXComponent(en.nextElement().getDispatch());
            System.out.println(bb.getPropertyAsString("PartComponent"));
        }
    } finally {
        ComThread.Release();
    }
}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2012-05-10T20:36:18.530

使用 Java COM 对象，即 Jacob：

```
public static void EnumerateUsers() {

    String query = "SELECT * FROM Win32_UserAccount";
    ActiveXComponent axWMI = new ActiveXComponent("winmgmts:\\");
    Variant vCollection = axWMI.invoke("ExecQuery", new Variant(query));
    EnumVariant enumVariant = new EnumVariant(vCollection.toDispatch());
    Dispatch item = null;
    StringBuilder sb = new StringBuilder();

    while (enumVariant.hasMoreElements()) {
            item = enumVariant.nextElement().toDispatch();
            sb.append("User: " + Dispatch.call(item, "Name")).toString();
            System.out.println(sb);
            sb.setLength(0);
    } 

} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T14:22:05.007

我需要一个更简单的解决方案。

这个实现将使用“ [net user](http://support.microsoft.com/kb/251394) ”命令来获取机器上所有用户的列表。这个命令有一些格式，在我的情况下我不关心，我只关心我的用户是否在列表中。如果有人需要实际的用户列表，他可以解析“net user”的输出格式来提取列表，而不需要“net use”生成的垃圾页眉和页脚

```
private boolean isUserPresent() {
    //Load user list
    ProcessBuilder processBuilder = new ProcessBuilder("net","user");
    processBuilder.redirectErrorStream(true);
    String output = runProcessAndReturnOutput(processBuilder);
    //Check if user is in list
    //We assume the output to be a list of users with the net user
    //Remove long space sequences
    output = output.replaceAll("\\s+", " ").toLowerCase();
    //Locate user name in resulting list
    String[] tokens = output.split(" ");
    Arrays.sort(tokens);
    if (Arrays.binarySearch(tokens, "SomeUserName".toLowerCase()) >= 0){
      //We found the user name
      return true;
    }
    return false;
} 
```

方法runProcessAndReturnOutput 运行进程，收集进程的stdout 和stderr 并返回给调用者。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2020-06-03T13:37:35.553

```
import com.sun.jna.platform.win32.Netapi32Util;

    Netapi32Util.User[] users = Netapi32Util.getUsers();
    for(Netapi32Util.User user : users) {
        System.out.println(user.name);
    } 
```

# maven-2 - WSDL2Code (Maven) 自动生成损坏的类（包）

> ID：333819
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-12-02T12:34:14.850
> 
>         
> 
> 标签：maven-2, axis2, wsdl2code

我目前正在用 Axis2 替换 IBM WebService 框架。从 WSDL 文件生成代码时，我使用 Maven 插件 WSDL2Code。但是，创建的代码总是错误的。或者更确切地说，包名总是错误的，这反过来又使每个调用的方法都无法调用（创建更多错误，在 Eclipse 中多达 10.000 多个错误）。

这是一个实际发生的例子（这只是我专门为获得建议而制作的一个例子）：

```
 <plugin>
            <groupId>org.apache.axis2</groupId>
            <artifactId>axis2-wsdl2code-maven-plugin</artifactId>
            <version>1.4.1</version>
            <executions>
                <execution>
                    <id>Test</id>
                    <goals>
                        <goal>wsdl2code</goal>
                    </goals>
                    <configuration>
                        <packageName>test.testpackage</packageName>
                        <databindingName>xmlbeans</databindingName>
                        <wsdlFile>${basedir}/wsdl/service.wsdl</wsdlFile>
                        <outputDirectory>${basedir}/testdirectory</outputDirectory>
                    </configuration>
                </execution>
            </executions>
        </plugin> 
```

理论上，这应该会在目录 testdirectory/test/testpackage 中生成包名为“test.testpackage”的代码。但是，它会创建以下包：目录 testdirectory.src.test.testpackage 中的 Src.test.testpackage。它总是在包名和目录中添加一个“src”——如果我将包名更改为 src.test.testpackage，它将生成以下包：src.src.test.testpackage。

这当然会导致一个巨大的问题，因为每个生成的文件都有以下错误：“声明的包“src.test.testpackage”与预期的包“src.src.test.testpackage”不匹配

我在这里完全不知所措。我根本找不到任何理由为什么它应该在任何地方添加“src”。我注意到一个自动生成的 build.xml 文件包含一个名为 sourcedirectory = x/src （或类似的值）的值，但我无法影响这个值（尝试更改它然后保存文件没有区别，显然，因为它只是在我下次运行 maven 时再次生成）。

哦，我通常使用命令“mvn clean install”和 WSDL2Code 的 1.4.1 版，所以它不是旧的 wsdl2code:wsdl2code 错误之一。

如果有人知道这里到底出了什么问题，我将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-18T16:23:50.127

版本 1.4.1 有更多配置选项没有真正记录（查看 org.apache.axis2.maven2.wsdl2code.WSDL2CodeMojo 的源代码）...

只需使用 <flattenFiles>true</flattenFiles> -应该可以解决您的问题:-)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-06T09:09:10.780

这个问题很老了，所以我不知道你是否还有问题......

我建议改用[Axistools Maven 插件](https://www.mojohaus.org/axistools-maven-plugin/)，它在我们的案例中效果很好。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:29:05.020

恐怕不是。即使是这样，也不应该出现奇怪的问题 - 路径将是正确的 testdirectory/src/test/testpackage，因此不会导致包名出现问题。现在出现问题是因为它被放置在包不期望的目录中 - 它期望 ${basedir}/testdirectory/insert.package.here.divided.by./，但它却得到 ${basedir}/testdirectory/src /insert.package.here.divided.by./。

src 不应出现在路径的该部分中。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T12:44:23.130

也许 'src' 是 ${basedir} 的一部分？

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-09-29T10:22:33.220

这与实际上为您做出决定的 maven/axis2 的（或用户）的“天才”有关……请参阅：[Axis2 邮件列表条目][1]

[1]: [http://markmail.org/search/?q=[Axis2]+indrit#query:[Axis2](http://markmail.org/search/?q=[Axis2]+indrit#query:[Axis2)邮件列表条目]%20indrit+page:1+mid:a34wbp7l3pljagsz+state:results

# php - php mysql日期/时间问题

> ID：333828
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-12-02T12:38:58.540
> 
>         
> 
> 标签：php, mysql, datetime, select

我已经构建了一个小型应用程序，它具有用户管理、一个用于输入数据的前端控制台和一个用于控制前端部分的后端控制台。前端将行添加到带有时间戳的 MySQL 数据库中。后端需要能够从数据库中选择 X 和 Y 日期之间的行。

到目前为止一切正常，除了我真的很努力的日期部分。

前端 SQL 输入如下所示（通过删除虚假代码进行了简化）：

```
$date = time();
$top_level_category = $_POST['top_level_category'];
$sub_level_category = $_POST['sub_level_category'];
$company = $_POST['company'];
$agent_name = $_POST['agent_name'];
$ticket_id = $_POST['ticket_id'];

$sql = "INSERT INTO dacc_data ("
     .     "id, top_level_category, sub_level_category, "
     .     "agent_name, date, ticket_id, company"
     . ") VALUES ("
     .     "NULL, '$top_level_category', '$sub_level_category', "
     .     "'$agent_name', FROM_UNIXTIME('$date'), '$ticket_id', '$company'"
     . ")"
;

$result = mysql_query($sql) or die (mysql_error()); 
```

这似乎工作正常，时间戳正在被拾取并添加到我表中的 DATETIME 列中。它在数据库中显示为 dd/mm/yyyy hh:mm:ss。

所以......我的第一个问题是 - 这是正确的方法吗？

第二个问题是，我需要什么样的 SQL 语句来提取 X 和 Y 日期之间的行数组。

抱歉，如果这有点漫无边际，希望它很清楚，但如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-12-02T12:51:41.493

MySQL 日期时间应该用破折号格式化：

YYYY-MM-DD HH:MM:SS

[http://dev.mysql.com/doc/refman/5.0/en/datetime.html](http://dev.mysql.com/doc/refman/5.0/en/datetime.html)

然后您可以通过以下几种方式查询日期范围：

```
select *
from table
where date >= '[start date]' and date <= '[end date]'; 
```

或者

```
select * 
from table 
where date between '[start date]' and '[end date]'; 
```

*其中“table”是您的数据库表的名称，“date”是您的日期时间字段的名称。*

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:04:45.867

你是对的。我可以确认数据库具有“YYYY-MM-DD HH:MM:SS” - 我正在使用 SQLWave 编辑器快速浏览数据库，它会自动格式化 DATETIME 列。

```
// Initial questions still stand :) 
```

或者不是，只是注意到您更新了答案-非常感谢！实际上，我曾多次尝试相同的查询但无济于事，主要是因为我的 WHERE 错误地指定了日期格式。被 SQLWave 误导 :(

从现在开始回到使用命令行！！！

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:07:26.047

"what sort of SQL statement would I need to pull out an array of rows between X and Y date?"

```
SELECT * FROM `dacc_data` where `date` between "2008-11-01" and "2008-12-01" 
```

# c# - 为什么我不能在 .NET 中为结构定义默认构造函数？

> ID：333829
> 
>         
> 
> 赞同：290
> 
>         
> 
> 时间：2008-12-02T12:39:25.090
> 
>         
> 
> 标签：c#, .net, struct

在 .NET 中，值类型 (C# `struct`) 不能有没有参数的构造函数。根据[这篇文章](https://stackoverflow.com/questions/203695/structure-vs-class-in-c#204009)，这是 CLI 规范强制要求的。发生的情况是，对于每个值类型，都会创建一个默认构造函数（由编译器？），它将所有成员初始化为零（或`null`）。

为什么不允许定义这样的默认构造函数？

一个微不足道的用途是有理数：

```
public struct Rational {
    private long numerator;
    private long denominator;

    public Rational(long num, long denom)
    { /* Todo: Find GCD etc. */ }

    public Rational(long num)
    {
        numerator = num;
        denominator = 1;
    }

    public Rational() // This is not allowed
    {
        numerator = 0;
        denominator = 1;
    }
} 
```

使用当前版本的 C#，默认的 Rational`0/0`不是那么酷。

**PS**：默认参数会帮助 C# 4.0 解决这个问题，还是会调用 CLR 定义的默认构造函数？

* * *

[Jon Skeet](https://stackoverflow.com/questions/333829/why-cant-i-define-a-default-constructor-for-a-struct-in-net#333840)回答：

> 以您的示例为例，当有人这样做时，您希望发生什么：
> 
> ```
>  Rational[] fractions = new Rational[1000]; 
> ```
> 
>   
>   
> 
> 它应该通过您的构造函数运行 1000 次吗？

当然应该，这就是我首先编写默认构造函数的原因。当未定义显式默认构造函数时，CLR 应使用*默认归零*构造函数；这样你只需为你使用的东西付费。然后，如果我想要一个包含 1000 个非默认`Rational`s 的容器（并且想要优化掉 1000 个结构），我将使用 a`List<Rational>`而不是数组。

在我看来，这个原因不足以阻止定义默认构造函数。

* * *

## 回答 #1

> 赞同：211
> 
>             
> 
> 时间：2008-12-02T12:48:21.920

 ~~**注意：**下面的答案是在 C# 6 之前很久写的，它计划引入在结构中声明无参数构造函数的能力 - 但它们仍然不会在所有情况下（例如用于数组创建）~~   （最后此功能[未添加到 C# 6 中](https://stackoverflow.com/questions/31063109/parameterless-constructors-in-structs-for-c-sharp-6)）。

* * *

编辑：由于 Grauenwolf 对 CLR 的深入了解，我编辑了下面的答案。

CLR 允许值类型具有无参数构造函数，但 C# 不允许。我相信这是因为它会引入一个期望，即构造函数会在它不会被调用时被调用。例如，考虑一下：

```
MyStruct[] foo = new MyStruct[1000]; 
```

只需分配适当的内存并将其全部归零，CLR 就能够非常有效地做到这一点。如果它必须运行 MyStruct 构造函数 1000 次，那么效率会低很多。（事实上​​，它没有——如果你*有*一个无参数的构造函数，当你创建一个数组或者你有一个未初始化的实例变量时它不会运行。）

C# 中的基本规则是“任何类型的默认值都不能依赖于任何初始化”。现在他们*可以*允许定义无参数的构造函数，但不需要在所有情况下都执行该构造函数——但这会导致更多的混乱。（或者至少，所以我相信这个论点。）

编辑：以您的示例为例，当有人这样做时，您希望发生什么：

```
Rational[] fractions = new Rational[1000]; 
```

它应该通过您的构造函数运行 1000 次吗？

*   如果不是，我们最终会得到 1000 个无效的有理数

*   如果是这样，那么如果我们要用实际值填充数组，我们可能会浪费大量工作。

编辑：（回答更多问题）无参数构造函数不是由编译器创建的。就 CLR 而言，值类型不必具有构造函数——尽管如果你用 IL 编写它，事实证明它*可以。*当您`new Guid()`在 C# 中编写“”时，它会发出与调用普通构造函数不同的 IL。有关这方面的更多信息，请参阅[这个 SO question 。](https://stackoverflow.com/questions/203695/structure-vs-class-in-c)

我*怀疑*框架中没有任何带有无参数构造函数的值类型。毫无疑问，如果我问得足够好，NDepend 可以告诉我...... C# 禁止它的事实足以让我认为这可能是一个坏主意。

* * *

## 回答 #2

> 赞同：54
> 
>             
> 
> 时间：2008-12-02T16:58:28.093

结构是值类型，值类型在声明后必须具有默认值。

```
MyClass m;
MyStruct m2; 
```

如果您像上面那样声明两个字段而没有实例化任何一个，然后中断调试器，`m`它将为 null 但`m2`不会。鉴于此，无参数构造函数将毫无意义，事实上，结构上的所有构造函数所做的都是赋值，事物本身已经存在，只是通过声明它。实际上，m2 可以很高兴地用于上面的示例，并且可以调用它的方法（如果有的话），并操纵它的字段和属性！

* * *

## 回答 #3

> 赞同：20
> 
>             
> 
> 时间：2009-01-11T17:14:33.383

您可以创建一个静态属性来初始化并返回默认的“有理数”：

```
public static Rational One => new Rational(0, 1); 
```

并像这样使用它：

```
var rat = Rational.One; 
```

* * *

## 回答 #4

> 赞同：14
> 
>             
> 
> 时间：2008-12-02T14:03:56.293

简短的解释：

在 C++ 中，struct 和 class 只是一枚硬币的两个方面。唯一真正的区别是默认情况下一个是公共的，另一个是私有的。

在[.NET](http://en.wikipedia.org/wiki/.NET_Framework)中，结构和类之间的区别要大得多。最主要的是 struct 提供值类型语义，而 class 提供引用类型语义。当您开始考虑此更改的含义时，其他更改也开始变得更有意义，包括您描述的构造函数行为。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2017-09-27T17:31:39.760

我还没有看到相当于我要给出的后期解决方案，所以就在这里。

使用偏移量将值从默认 0 移动到您喜欢的任何值。这里必须使用属性而不是直接访问字段。（也许使用可能的 c#7 功能，您可以更好地定义属性范围字段，以便它们受到保护，不会在代码中被直接访问。）

此解决方案适用于仅具有值类型（无 ref 类型或可为空的结构）的简单结构。

```
public struct Tempo
{
    const double DefaultBpm = 120;
    private double _bpm; // this field must not be modified other than with its property.

    public double BeatsPerMinute
    {
        get => _bpm + DefaultBpm;
        set => _bpm = value - DefaultBpm;
    }
} 
```

这与这个答案不同[，](https://stackoverflow.com/a/336449/4767498)这种方法不是特殊的大小写，而是它使用的偏移量适用于所有范围。

以枚举作为字段的示例。

```
public struct Difficaulty
{
    Easy,
    Medium,
    Hard
}

public struct Level
{
    const Difficaulty DefaultLevel = Difficaulty.Medium;
    private Difficaulty _level; // this field must not be modified other than with its property.

    public Difficaulty Difficaulty
    {
        get => _level + DefaultLevel;
        set => _level = value - DefaultLevel;
    }
} 
```

正如我所说，这个技巧可能并非在所有情况下都有效，即使 struct 只有值字段，也只有您知道它是否适用于您的情况。只是检查。但你明白了。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-12-03T07:59:06.963

只是特例而已。如果您看到分子为 0，分母为 0，请假装它具有您真正想要的值。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2019-11-20T10:09:41.010

我使用的是[空合并运算符 (??)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/null-coalescing-operator)与这样的支持字段相结合：

```
public struct SomeStruct {
  private SomeRefType m_MyRefVariableBackingField;

  public SomeRefType MyRefVariable {
    get { return m_MyRefVariableBackingField ?? (m_MyRefVariableBackingField = new SomeRefType()); }
  }
} 
```

希望这可以帮助 ;）

注意：[null 合并分配](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-8.0/null-coalescing-assignment)当前是 C# 8.0 的功能建议。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-12-03T19:53:48.893

您无法定义默认构造函数，因为您使用的是 C#。

结构可以在 .NET 中具有默认构造函数，但我不知道任何支持它的特定语言。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2021-09-21T13:47:59.080

从 C# 10.0 开始，您可以：

[https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct#parameterless-constructors-and-field-initializers](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct#parameterless-constructors-and-field-initializers)

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2021-12-05T21:47:51.540

我为此找到了简单的解决方案：

```
struct Data
    {
        public int Point { get; set; }
        public HazardMap Map { get; set; }
        public Data Initialize()
        {
            Point = 1; //set anything you want as default
            Map = new HazardMap();
            return this;
        }
    } 
```

在代码中只做：

```
Data input = new Data().Initialize(); 
```

* * *

## 回答 #11

> 赞同：-1
> 
>             
> 
> 时间：2016-11-13T19:20:12.853

这是我对无默认构造函数困境的解决方案。我知道这是一个较晚的解决方案，但我认为值得注意的是这是一个解决方案。

```
public struct Point2D {
    public static Point2D NULL = new Point2D(-1,-1);
    private int[] Data;

    public int X {
        get {
            return this.Data[ 0 ];
        }
        set {
            try {
                this.Data[ 0 ] = value;
            } catch( Exception ) {
                this.Data = new int[ 2 ];
            } finally {
                this.Data[ 0 ] = value;
            }
        }
    }

    public int Z {
        get {
            return this.Data[ 1 ];
        }
        set {
            try {
                this.Data[ 1 ] = value;
            } catch( Exception ) {
                this.Data = new int[ 2 ];
            } finally {
                this.Data[ 1 ] = value;
            }
        }
    }

    public Point2D( int x , int z ) {
        this.Data = new int[ 2 ] { x , z };
    }

    public static Point2D operator +( Point2D A , Point2D B ) {
        return new Point2D( A.X + B.X , A.Z + B.Z );
    }

    public static Point2D operator -( Point2D A , Point2D B ) {
        return new Point2D( A.X - B.X , A.Z - B.Z );
    }

    public static Point2D operator *( Point2D A , int B ) {
        return new Point2D( B * A.X , B * A.Z );
    }

    public static Point2D operator *( int A , Point2D B ) {
        return new Point2D( A * B.Z , A * B.Z );
    }

    public override string ToString() {
        return string.Format( "({0},{1})" , this.X , this.Z );
    }
} 
```

忽略我有一个名为 null 的静态结构的事实，（注意：这仅适用于所有正象限），使用 get;set; 在 C# 中，您可以使用 try/catch/finally 来处理默认构造函数 Point2D() 未初始化特定数据类型的错误。我想这对于某些人来说是难以捉摸的解决方案。这主要是为什么我要添加我的。在 C# 中使用 getter 和 setter 功能将允许您绕过这个默认的构造函数，并尝试捕获您未初始化的内容。对我来说这很好用，对于其他人你可能想要添加一些 if 语句。因此，如果您需要分子/分母设置，此代码可能会有所帮助。我想重申一下，这个解决方案看起来不太好，从效率的角度来看可能效果更差，但是，对于来自旧版 C# 的人来说，使用数组数据类型可以为您提供此功能。如果你只是想要一些有用的东西，试试这个：

```
public struct Rational {
    private long[] Data;

    public long Numerator {
        get {
            try {
                return this.Data[ 0 ];
            } catch( Exception ) {
                this.Data = new long[ 2 ] { 0 , 1 };
                return this.Data[ 0 ];
            }
        }
        set {
            try {
                this.Data[ 0 ] = value;
            } catch( Exception ) {
                this.Data = new long[ 2 ] { 0 , 1 };
                this.Data[ 0 ] = value;
            }
        }
    }

    public long Denominator {
        get {
            try {
                return this.Data[ 1 ];
            } catch( Exception ) {
                this.Data = new long[ 2 ] { 0 , 1 };
                return this.Data[ 1 ];
            }
        }
        set {
            try {
                this.Data[ 1 ] = value;
            } catch( Exception ) {
                this.Data = new long[ 2 ] { 0 , 1 };
                this.Data[ 1 ] = value;
            }
        }
    }

    public Rational( long num , long denom ) {
        this.Data = new long[ 2 ] { num , denom };
        /* Todo: Find GCD etc. */
    }

    public Rational( long num ) {
        this.Data = new long[ 2 ] { num , 1 };
        this.Numerator = num;
        this.Denominator = 1;
    }
} 
```

* * *

## 回答 #12

> 赞同：-2
> 
>             
> 
> 时间：2018-08-17T18:23:23.630

```
public struct Rational 
{
    private long numerator;
    private long denominator;

    public Rational(long num = 0, long denom = 1)   // This is allowed!!!
    {
        numerator   = num;
        denominator = denom;
    }
} 
```

# sql - SQL 查询到休眠查询

> ID：333839
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-12-02T12:48:08.847
> 
>         
> 
> 标签：sql, hibernate, grails, jdbc, groovy

我有一个 MySQL 查询，用于从表中检索随机行。查询是：

```
SELECT * FROM QUESTION WHERE TESTID=1 ORDER BY RAND() LIMIT 10; 
```

现在我需要将此查询更改为***Hibernate***。做了一些谷歌搜索，但找不到答案。有人可以提供帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T14:51:07.103

random 函数在每个底层 DB 之间是不同的，并且不是 SQL92 的标准部分。

鉴于您需要为正在使用的给定数据库类型实现 SQLDialect。

例如：

```
类 PostgresSQLDialect 扩展 org.hibernate.dialect.PostgreSQLDialect {
    PostgresSQLDialect() {
        极好的（）
        registerFunction("rand", new NoArgSQLFunction("random", Hibernate.DOUBLE));
    }
}
```

然后您需要在配置中定义该方言

```
休眠{
    dialect='com.mycompany.sql.PostgresSQLDialect'
}

```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T12:54:12.160

根据这篇[文章](http://cephas.net/blog/2004/05/21/hibernate-returning-n-records-in-a-random-order/)，你可以这样做：

```
String query = "from QUESTION order by newid()";
Query q = session.createQuery(query);
q.setMaxResults(10); 
```

不确定它是否会起作用（尤其是随机部分），但您可以尝试一下：）

# actionscript-3 - 在 AS3 中在运行时（反射）检查匿名函数签名

> ID：333841
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-12-02T12:48:41.500
> 
>         
> 
> 标签：actionscript-3, reflection, function

有没有办法在运行时查看 ActionScript 3 中匿名函数的签名？

我想验证`Function`作为参数传入其他函数的对象，并确保它们接受正确数量的参数（具有正确的类型）并返回正确类型的值。

`flash.utils.describeType()`似乎没有为匿名函数返回此信息。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-12-08T03:13:14.307

看起来运行时不允许您反映匿名函数，这是一种耻辱。

匿名函数（可能根据定义）标记为`dynamic`. 如果将不兼容的类型传递给匿名函数，*则不会引发错误*。任何类型的不匹配都会尽可能地被默默地强制转换。例如，将类似的东西`"minotaur"`作为`uint`参数传递将产生`0`（零）。

如果你真的想过度设计它，你可以得到所有的面向对象。您可以声明一个包含适当函数签名的接口，并接受实现该接口的对象，而不是接受匿名函数。

```
public interface IFancyCallback {
  public function fancyFunction(frog:Frog, princess:Girl):UsefulReturnType;
} 
```

你的函数只需要打包在一个对象中：

```
public class ConcreteCallback implements IFancyCallback {
  public function fancyFunction(frog:Frog, princess:Girl):UsefulReturnType {
    princess.kiss(frog);
    return new UsefulReturnType("jabberwocky");
  }
} 
```

可能会产生大量代码开销。取决于您打算拥有多少回调，谁将进行回调，以及如果 anon 函数的签名不正确会有多严重。

你能分享更多关于你试图解决的问题吗？

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T16:09:26.600

作为粗略的近似值，您可以使用长度属性检查参数的数量，例如：

```
function doStuff(callback:Function) {
  trace(callback.length);
} 
```

我不知道有任何方法可以枚举匿名函数的参数；您当然可以验证事后捕获 ArgumentError。

# windows - Windows 中的内存是如何组织的？

> ID：333845
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-12-02T12:51:59.293
> 
>         
> 
> 标签：windows, memory, memory-management

我正在寻找有关 Windows 系统中内存组织和内存管理的解释或良好的免费在线资源。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-12-02T13:02:35.323

你可以花一分钱（二手）买这本（旧）书，（实际的 Windows 架构在 10 年内并没有太大变化）：

[Windows NT 内部](https://rads.stackoverflow.com/amzn/click/com/1572316772)

这是最新版本：

[MS Windows 内部结构](https://rads.stackoverflow.com/amzn/click/com/0735619174)

还有[马克的博客](http://blogs.technet.com/markrussinovich/)

就在线资源而言，我发现它非常稀少，不过:(

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T13:25:31.877

查看有关 Windows 内存模型[的](http://www.dotnetrocks.com/default.aspx?showNum=361)DotNet Rocks 播客

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T15:07:09.580

在 MSDN 中，一些信息位于此处：http: [//msdn.microsoft.com/en-us/library/aa366525 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa366525(VS.85).aspx)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T15:36:47.417

Windows Internals 是 mm 的规范参考。它比你在这个主题上找到的任何其他东西都要好得多，因为Landy Wang没有写太多:)

# c# - 将 Web 上下文传递给 ASP MVC 应用程序中的“服务”

> ID：333850
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-12-02T12:57:04.930
> 
>         
> 
> 标签：c#, .net, asp.net-mvc, tdd, mocking

我正在尝试找出一种将 Web 当前 http 上下文传递给服务类（或使用对它的引用来初始化类）的方法。我这样做是为了将应用程序的其余部分从需要了解有关 http 上下文的任何信息中抽象出来。

我还希望该服务可以使用 TDD 进行测试，可能使用 Mockable 框架之一。因此，最好使用接口而不是实际的类。

我想实现的一个例子：

```
class WebInstanceService 
{
    private IHttpContext _Context;        

    public WebInstanceService( ... , IHttpContext HttpContext )
    {
        ....
        _Context = HttpContext;
    }

    // Methods...
    public string GetInstanceVariable(string VariableName)
    {
         return _Context.Current.Session[VariableName];
    }
} 
```

我遇到的主要问题之一是没有 IHttpContext，.net http 上下文是无法模拟的抽象类的子类（容易吗？）。

另一个问题是我无法初始化类的全局实例，因为上下文与大多数请求无关。

我可以使类静态，并要求将上下文传递给每个函数，因为它被称为即

```
public static string GetInstanceVariable(string VariableName, HttpContext Context) 
{ ... } 
```

但这并没有使这个类更容易测试，我仍然需要创建一个 HttpContext 并且另外任何想要使用这个类的非 Web 感知服务突然需要能够检索要求它们紧密耦合的 Context到网络服务器——首先想要创建这个类的全部原因。

我对所有建议持开放态度——尤其是那些人们知道有助于轻松进行 tdd 测试的建议。**人们会建议我如何解决这个问题？**

干杯

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T13:10:27.837

这就是引入 HttpContextBase 和 HttpContextWrapper 的原因。您可能想要使用 HttpContextBase 并在传递真实上下文时使用`new HttpContextWrapper( httpContext )`，但是，我认为控制器中可用的内容已经是 HttpContextBase 类型。我每次都会在我的控制器中创建其中一个，而不是尝试从静态的全局 HttpContext.Current 实例中引用当前上下文。如果您在视图中需要它，请在 ViewData 中传递对强类型上下文的引用。

我在测试中经常模拟 HttpContextBase。

```
class WebInstanceService 
{
    private HttpContextBase _Context;        

    public WebInstanceService( ... , HttpContextBase HttpContext )
    {
        ....
        _Context = HttpContext;
    }

    // Methods...
    public string GetInstanceVariable(string VariableName)
    {
         return _Context.Session[VariableName];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:11:14.107

我们所做的是旋转其中一个[http://haacked.com/archive/2007/06/19/unit-tests-web-code-without-a-web-server-using-httpsimulator.aspx](http://haacked.com/archive/2007/06/19/unit-tests-web-code-without-a-web-server-using-httpsimulator.aspx)

就像馅饼一样简单，只需实例化一个 HttpSimulator 并填写值，然后 HttpContext.Current 就会填满您指定的任何内容。

IHttpContext 是 MVC 中的东西，显然有一天会出现在 webforms 中。希望那一天将是.net 4

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:12:41.700

ASP.NET 附带包含 HttpContextBase 的 System.Web.Abstractions，您可以使用它在测试情况下处理 HttpContext。

我个人会抽象出对 HttpContext 的直接依赖。

# vba - 显示更新查询更新了多少记录

> ID：333856
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-12-02T13:02:22.423
> 
>         
> 
> 标签：vba, ms-access

是否可以在不使用记录集的情况下获取使用更新查询更新的记录的报告？

前任：

`sqltext = update table employees set bonus = 0 where salary > 50000

DoCmd.RunSQL sqltext`

运行此查询后，是否可以获得为其执行此更新查询的员工的姓名？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-12-05T04:03:00.467

使用它从来都不是一个好主意，`DoCmd.RunSQL`因为它会生成一个提示（如果你不想要它，你必须关闭它），即使发生错误它也会完成更新，并且不报告错误。更好的是用执行相同 SQL 的函数替换它：

```
Public Function SQLRun(strSQL As String) As Boolean
On Error GoTo errHandler

  CurrentDB.Execute strSQL, dbFailOnError
  SQLRun= True

exitRoutine:
  Exit Function

errHandler:
  MsgBox err.Number & ": " & err.Description, vbExclamation, "Error in SQLRun()"
  Resume exitRoutine
End Function 
```

将其放置在公共模块中后，您可以轻松地进行全局搜索并替换 for`DoCmd.RunSQL`以将其替换为`SQLRun`.

编辑：返回受影响记录数的此函数的另一个版本是[here](https://stackoverflow.com/questions/343396/acess-vba-to-get-value-from-update-query-prompt/348453#348453)。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2015-05-31T12:51:25.087

我知道这是一个老问题，但没有直接回答 OP 问题的答案（我在尝试记住语法时通过 Google Top 3 results 到达这里）如果使用 Execute 方法，则可以直接获得受影响的记录数：

```
sqltext = "update table employees set bonus = 0 where salary > 50000"
CurrentDb.Execute sqltext
AffectedRows = CurrentDb.RecordsAffected
'Optional Notification
   MsgBox CStr(AffectedRows) & " records were affected by this SQL statement." 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:19:45.647

除非您有另一个区别字段（可能是更新的日期字段），否则我目前看不到在更新查询运行后获取信息的任何方法。为什么不为其运行选择查询并根据该数据运行报告，然后运行更新查询以更改“奖金”的值。

让我知道这是否有帮助！联合部队

# asp.net-mvc - 无法转换 WhereListIterator 类型的对象
输入 system.web.mvc.listitem

> ID：333875
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-12-02T13:13:24.943
> 
>         
> 
> 标签：asp.net-mvc

我有一个 SelectList，我首先检查一个选定的值！= null，然后想在 where 子句中使用这个选定的值作为过滤器。像这样：

```
if(searchBag.Qualities.SelectedValue != null){
    ListItem selected = (ListItem)searchBag.Qualities.SelectedValue;
} 
```

我在一个单独的无用的行中制作了演员表以查明问题。这给了我一个

> 无法将“WhereListIterator`1[System.Web.Mvc.ListItem]”类型的对象转换为“System.Web.Mvc.ListItem”类型。

嗯？

**--EDIT--**

这确实是因为进行了多项选择。这是因为在创建时我将所选值设置为 theItems.Where(i=>i.someCriterea) 并且我忘记将 .FirstOrDefault() 放在最后。最终有多个答案的可能性。因为它是一个 IEnumerable，所以它是一个惰性列表，因此我猜是 WhereListIterator。我通过简单地将 FirstOrDefault 放在最后解决了它。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:47:12.910

我假设 SelectList 允许您选择超过 1 个项目？

那么 SelectedValue 可能是一个列表？不是 1 个列表项。

将其投射到：

```
 WhereListIterator<ListItem> selected = (WhereListIterator<ListItem>)searchBag.Qualities.SelectedValue; 
```

相反，看看你在那里有什么属性。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:24:21.523

SelectedValue 不是 ListItem，它是所选列表项的值。所以鉴于此：

```
var selectList = new SelectList(companiesList, "Id", "Name", companiesList[3]); 
```

selectList.SelectedValue 将等于 CompaniesList[3].Id。如果您想要实际的列表项，您可以执行以下操作：

```
ListItem selected = selectList.GetListItems().Where(x => x.Value == selectList.SelectedValue.ToString()) 
```

只是好奇，你为什么要选中的列表项？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:44:59.970

它已经被解释过了，但这里有另一个关于如何获得你想要的东西的建议：

```
if(searchBag.Qualities.SelectedValue != null){
    ListItem selected = (ListItem)searchBag.Qualities.SelectedValue.FirstOrDefault();
} 
```

# ruby-on-rails - Rails 辅助方法中的当前视图文件

> ID：333876
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-12-02T13:13:41.760
> 
>         
> 
> 标签：ruby-on-rails, file, templates, erb, activeview

是否有某种方法可以确定 Rails (2.2) 当前正在帮助方法中呈现的文件。一个示例结果是“/sessions/new.html.erb”或类似的东西。

我正在尝试编写一个辅助函数，该函数根据正在呈现的文件名执行某些操作，因此我需要一种可靠的方法来获取此信息。有没有官方的方式来获取这些信息？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:44:12.527

我现在有这个极其丑陋的解决方案。有更好的主意吗？

```
 begin
  raise "Nasty hack"
rescue 
  render = $@.detect { |bti| /\/app\/views\/(.+)\:\d+\:in \`_run_erb_/ =~ bti }
  return $1
end 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T22:36:15.820

在 Rails 2.2 中，您可以使用`@template.template`

# c++ - 为什么要有头文件和 .cpp 文件？

> ID：333889
> 
>         
> 
> 赞同：532
> 
>         
> 
> 时间：2008-12-02T13:17:55.403
> 
>         
> 
> 标签：c++, header-files

为什么 C++ 有头文件和 .cpp 文件？

* * *

## 回答 #1

> 赞同：655
> 
>             
> 
> 时间：2008-12-02T13:47:57.603

## C++ 编译

C++ 中的编译分两个主要阶段完成：

1.  第一个是将“源”文本文件编译为二进制“目标”文件：CPP 文件是编译后的文件，并且在不了解其他 CPP 文件（甚至库）的情况下进行编译，除非通过原始声明或标题包含。CPP 文件通常编译成 .OBJ 或 .O“对象”文件。

2.  第二个是将所有“对象”文件链接在一起，从而创建最终的二进制文件（库或可执行文件）。

HPP 在所有这些过程中的位置如何？

## 一个可怜的孤独的CPP文件......

每个 CPP 文件的编译独立于所有其他 CPP 文件，这意味着如果 A.CPP 需要在 B.CPP 中定义的符号，例如：

```
// A.CPP
void doSomething()
{
   doSomethingElse(); // Defined in B.CPP
}

// B.CPP
void doSomethingElse()
{
   // Etc.
} 
```

它不会编译，因为 A.CPP 无法知道“doSomethingElse”的存在......除非 A.CPP 中有声明，例如：

```
// A.CPP
void doSomethingElse() ; // From B.CPP

void doSomething()
{
   doSomethingElse() ; // Defined in B.CPP
} 
```

然后，如果您有使用相同符号的 C.CPP，则复制/粘贴声明...

## 复制/粘贴警告！

是的，有问题。复制/粘贴是危险的，并且难以维护。这意味着如果我们有办法不复制/粘贴，并且仍然声明​​符号会很酷......我们该怎么做？通过包含一些文本文件，通常以 .h、.hxx、.h++ 或我更喜欢的 C++ 文件后缀 .hpp 为后缀：

```
// B.HPP (here, we decided to declare every symbol defined in B.CPP)
void doSomethingElse() ;

// A.CPP
#include "B.HPP"

void doSomething()
{
   doSomethingElse() ; // Defined in B.CPP
}

// B.CPP
#include "B.HPP"

void doSomethingElse()
{
   // Etc.
}

// C.CPP
#include "B.HPP"

void doSomethingAgain()
{
   doSomethingElse() ; // Defined in B.CPP
} 
```

### 如何`include`工作？

从本质上讲，包含文件将解析其内容，然后将其内容复制粘贴到 CPP 文件中。

例如，在以下代码中，带有 A.HPP 标头：

```
// A.HPP
void someFunction();
void someOtherFunction(); 
```

...来源B.CPP：

```
// B.CPP
#include "A.HPP"

void doSomething()
{
   // Etc.
} 
```

... 包含后将变为：

```
// B.CPP
void someFunction();
void someOtherFunction();

void doSomething()
{
   // Etc.
} 
```

## 一件小事——为什么在 B.CPP 中包含 B.HPP？

在当前情况下，这不是必需的，B.HPP 有`doSomethingElse`函数声明，B.CPP 有`doSomethingElse`函数定义（它本身就是一个声明）。但在更一般的情况下，B.HPP 用于声明（和内联代码），可能没有相应的定义（例如，枚举、普通结构等），因此如果 B.CPP 可能需要包含使用 B.HPP 的那些声明。总而言之，默认情况下包含其标题的源是“好品味”。

## 结论

因此头文件是必要的，因为 C++ 编译器无法单独搜索符号声明，因此，您必须通过包含这些声明来帮助它。

最后一句话：你应该在你的HPP文件的内容周围放置标题保护，以确保多个包含不会破坏任何东西，但总而言之，我相信上面解释了HPP文件存在的主要原因。

```
#ifndef B_HPP_
#define B_HPP_

// The declarations in the B.hpp file

#endif // B_HPP_ 
```

甚至更简单（虽然不是标准的）

```
#pragma once

// The declarations in the B.hpp file 
```

* * *

## 回答 #2

> 赞同：218
> 
>             
> 
> 时间：2008-12-02T13:23:38.683

好吧，主要原因是为了将接口与实现分开。头文件声明了一个类（或任何正在实现的）将做什么，而 cpp 文件定义了它将如何执行这些功能。

这减少了依赖关系，因此使用标头的代码不一定需要知道实现的所有细节以及仅需要的任何其他类/标头。这将减少编译时间以及当实现中的某些内容发生更改时所需的重新编译量。

它并不完美，您通常会求助于[Pimpl Idiom](http://aszt.inf.elte.hu/~gsd/halado_cpp/ch09s03.html)之类的技术来正确分离接口和实现，但这是一个好的开始。

* * *

## 回答 #3

> 赞同：102
> 
>             
> 
> 时间：2008-12-02T18:15:45.317

因为这个概念起源的 C 语言已经有 30 年的历史了，在当时，它是唯一可行的将多个文件中的代码链接在一起的方法。

今天，这是一个可怕的 hack，它完全破坏了 C++ 中的编译时间，导致无数不必要的依赖（因为头文件中的类定义暴露了太多关于实现的信息）等等。

* * *

## 回答 #4

> 赞同：58
> 
>             
> 
> 时间：2008-12-02T13:19:55.820

因为在 C++ 中，最终的可执行代码不携带任何符号信息，它或多或少是纯机器码。

因此，您需要一种方法来描述一段代码的接口，它与代码本身是分开的。这个描述在头文件中。

* * *

## 回答 #5

> 赞同：21
> 
>             
> 
> 时间：2010-07-28T18:54:20.140

因为 C++ 从 C 继承了它们。不幸的是。

* * *

## 回答 #6

> 赞同：16
> 
>             
> 
> 时间：2008-12-02T13:23:49.650

因为设计库格式的人不想“浪费”空间来存储很少使用的信息，例如 C 预处理器宏和函数声明。

由于您需要该信息来告诉您的编译器“此函数稍后在链接器执行其工作时可用”，因此他们必须提出第二个文件来存储此共享信息。

C/C++ 之后的大多数语言将此信息存储在输出中（例如 Java 字节码），或者它们根本不使用预编译格式，总是以源代码形式分发并即时编译（Python、Perl）。

* * *

## 回答 #7

> 赞同：6
> 
>             
> 
> 时间：2008-12-02T13:19:35.570

它是声明接口的预处理器方式。您将接口（方法声明）放入头文件，并将实现放入 cpp。使用你的库的应用程序只需要知道他们可以通过#include 访问的接口。

* * *

## 回答 #8

> 赞同：5
> 
>             
> 
> 时间：2008-12-02T13:25:03.110

通常你会想要一个接口的定义，而不必发布整个代码。例如，如果您有一个共享库，您将附带一个头文件，其中定义了共享库中使用的所有函数和符号。如果没有头文件，您将需要发布源代码。

在单个项目中，使用头文件，恕我直言，至少有两个目的：

*   清晰，即通过将接口与实现分开，更容易阅读代码

*   编译时间。通过在可能的情况下仅使用接口而不是完整的实现，可以减少编译时间，因为编译器可以简单地对接口进行引用，而不必解析实际代码（理想情况下，只需要完成一次）。

* * *

## 回答 #9

> 赞同：-5
> 
>             
> 
> 时间：2012-02-29T23:08:30.200

回应[MadKeithV 的回答](https://stackoverflow.com/questions/333889/why-have-header-files-and-cpp-files-in-c/333902#333902)，

> 这减少了依赖关系，因此使用标头的代码不一定需要知道实现的所有细节以及仅需要的任何其他类/标头。这将减少编译时间，以及当实现中的某些内容发生更改时所需的重新编译量。

另一个原因是标题为每个类提供了唯一的 id。

所以如果我们有类似的东西

```
class A {..};
class B : public A {...};

class C {
    include A.cpp;
    include B.cpp;
    .....
}; 
```

当我们尝试构建项目时，我们会遇到错误，因为 A 是 B 的一部分，使用标题我们可以避免这种头痛......

# openssl - OpenSSL 并在客户端生成 CSR

> ID：333894
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-12-02T13:20:09.767
> 
>         
> 
> 标签：openssl, public-key, private-key, csr

我需要你的帮助。我的基础架构是 IIS 6.0 和 windows server 2003。

我需要研究 OpenSSL 的使用以及可以发送给最终用户的媒体的构造，使他们能够生成 CSR，并生成支持 CSR 签名的文档。

我的意思是，我需要向最终用户发送一张 CD，其中包含一个脚本，该脚本可以根据我的公司 Publickey CA 在他们的机器上生成 CSR 和私钥。

1.  客户端可以运行我通过某些 cd 或 DVD（可能是 openSSL 脚本）发送的实用程序需要接受一些参数，以便最终用户可以提供关键字/密码数据。

2.  该脚本将通过某种安全方式将私钥和 CSR 生成回我的公司（可能是通过电子邮件，我知道这不安全，但他们如何将 CSR 发回给我们）

3.  我们收到 CSR 并签署并返回给客户。

所以我需要记录这一点，以便最终用户能够理解他在做什么。

所以我的问题是我在哪里可以获得脚本发送给客户，以便他可以生成自己的 CSR 和 PrivateKey。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:23:36.513

看看 openssl 的[req](http://www.openssl.org/docs/apps/req.html)命令。在脚本中调用 req，并为 -config 选项提供一个 ssl 配置文件。req 将从用户那里查询必要的信息，并将请求写入文件（您也可以在命令行中指定）。

**编辑：您可以从**[http://www.slproweb.com/products/Win32OpenSSL.html](http://www.slproweb.com/products/Win32OpenSSL.html)下载 openssl请
阅读 req 手册页。

# .net - Request.UserHostName 是否总是给我用户的计算机名？

> ID：333907
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-12-02T13:25:20.630
> 
>         
> 
> 标签：.net, http-headers

基本上，我想确保我将始终获得计算机的名称，而不是中间的任何代理或其他硬件。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T14:20:10.970

你不能。

服务器所知道的关于客户端的一切都只能通过浏览器提供的用户代理字符串，因为用户可以更改用户代理字符串，代理可能会删除或修改它，你不能对它做任何假设。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:47:54.623

我不认为这总是可能的。如果用户使用匿名代理，那么您真的无能为力。

# jquery - JQuery：animate() 在 IE 中无法按预期工作

> ID：333911
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-12-02T13:27:24.290
> 
>         
> 
> 标签：jquery, firefox, internet-explorer-7, jquery-animate

我对这个 IE 7 越来越疯狂了......

==> hhttp://neu.emergent-innovation.com/

为什么以下功能在 IE 7 中不起作用，但在 Firefox 中却完美？动画功能中是否存在错误？

```
function accordion_starting_page(){
    // hide all elements except the first one
    $('#FCE-Inhalt02-ContentWrapper .FCE-Fade:not(:first)').css("height", "0").hide();
    $('#FCE-Inhalt02-ContentWrapper .FCE-Fade:first').addClass("isVisible");

    $('div.FCE-Title').click(function(){

        // if user clicks on an already opened element => do nothing
        if (parseFloat($(this).next('.FCE-Fade').css("height")) > 0) {
            return false;
        }

        var toHide = $(this).siblings('.FCE-Fade.isVisible');

        toHide.removeClass("isVisible");

        // close all opened siblings
        toHide.animate({"height": "0", "display": "none"}, 1000);

        $(this).next('.FCE-Fade').addClass("isVisible").animate({"height" : "200"}, 1000);

        return false;
    });
} 
```

非常感谢您的帮助...

* * *

非常感谢，这些都是很好的提示！不幸的是，它仍然不起作用......

问题是 IE 会显示两个容器的内容，直到动画结束...... Firefox 的行为正确......我认为这是“溢出：隐藏”的问题 - 但这并没有改变任何东西。

我已经尝试过手风琴插件，但它的行为完全相同......

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-01-29T11:01:26.660

我在 animate 函数中遇到了类似的问题，当它显示来自核心 jQuery 库的错误时，我感到很惊讶。然而 jQuery 很好，它的 IE 你需要迎合。  

在 IE 中为元素的任何属性设置动画时，您需要确保在您的 CSS 中有您要更改的属性的起点。这也适用于 Safari。

例如，将 div 连续向左移动，

查询：

```
var re = /px/;
var currentLeft = $("#mydiv").css('left').replace(re,'') - 0;
$("#mydiv").css('left',(currentLeft-20)+'px'); 
```

CSS：

```
#mydiv { position: absolute;    top: 0;    left: 0; } 
```

如果您不放置在左侧和顶部的起始位置，IE 最终会抛出错误。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2010-03-31T12:47:09.897

正如保罗所说，使用该方法时。Animate() jQuery IE7 浏览器内部无法识别属性“位置”。例如

CSS 规则：

```
li p (bottom:-178px; color: white; background-color: # 4d4d4d; height: 100%; padding: 30px 10px 0 10px;) 
```

jQuery中动画的实现：

```
$('li').hover(function(){

              $this = $(this);

              var bottom = '-45px'; //valor default para subir.

              if( $this.css('height') == '320px' ){bottom = '-115px';}

              $this.css('cursor', 'pointer').find('p').stop().find('.first').hide().end().animate({bottom: bottom}, {queue:false, duration:300});

      }, function(){

         var $this = $(this);

         var bottom = '-178px'; //valor default para descer

            if( $this.css('height') == '320px' ){bottom = '-432px';}

         $this.find('p').stop().animate({***position: 'absolute'***, bottom:bottom}, {queue:false, duration:300}).find('.first').show();

      });//fim do hover() 
```

在所有浏览器中的工作原理：

CSS 规则：

```
li p (position: absolute; left: 0; bottom:-178px; color: white; background-color: # 4d4d4d; height: 100%; padding: 30px 10px 0 10px;) 
```

jQuery代码：

```
 $('li').hover(function(){

                 $this = $(this);

         var bottom = '-45px'; //valor default para subir.

              if( $this.css('height') == '320px' ){bottom = '-115px';}

              $this.css('cursor', 'pointer').find('p').stop().find('.first').hide().end().animate({bottom: bottom}, {queue:false, duration:300});

      }, function(){

         var $this = $(this);

         var bottom = '-178px'; //valor default para descer

            if( $this.css('height') == '320px' ){bottom = '-432px';}

         $this.find('p').stop().animate({bottom:bottom}, {queue:false, duration:300}).find('.first').show();

      });//fim do hover() 
```

就我而言，它是通过这种方式解决的。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2011-05-30T22:22:11.043

经过一天的思考为什么 IE 不会为东西制作动画后，我发现某些版本的 JQuery 不再像以前那样做：

这：

```
$('#bs1').animate({
    "left": bs1x
}, 300, function() {
    // Animation complete.
}); 
```

不适用于此 Jquery：
 [https ://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js](https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js)

但它确实适用于：
 [https ://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js](https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js)

万岁旧版本！

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:50:41.077

我不确定问题到底是什么......也许你不能为 " `display: none`" 制作动画？试试这个：

```
toHide.animate({ height : 0 }, 1000, function() { $(this).hide(); }); 
```

...想，看起来容器`overflow: hidden`上没有设置可能还有其他问题。

最好的方法可能是避免重新发明轮子：jQuery UI 插件内置了手风琴。[http://docs.jquery.com/UI/Accordion](http://docs.jquery.com/UI/Accordion)   我相信尊敬的 Resig & Co 先生已经处理了您可能遇到的任何错误。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:52:53.897

您可以使用 jQuery 选择器 :visible 而不是切换 isVisible 类。

此外，您的动画在功能上似乎与 slideUp(1000) 相同。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:10:08.153

我最近遇到了一个问题，animate() 没有按预期工作，这取决于 IE 渲染我的 css padding: 属性与 FireFox 不同。

这似乎发生在其他人身上，我不得不在我的 css 中破解；而是使用边距和固定宽度以及其他此类可怕的 IE hack。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2010-05-13T17:50:50.490

更改 IE 的持续时间。让它成为你在 FF 中的 1/10，它应该在两个浏览器中接近相同的行为：

法郎

```
$("#map").animate({"top": (pageY - 101) + "px"},{"easing" : "linear", "duration" : 200}); 
```

IE

```
$("#map").animate({"top": (pageY - 101) + "px"},{"easing" : "linear", "duration" : 20}); 
```

应该修复它。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2011-01-12T18:42:29.347

这可能是题外话，但我正在玩 JQuery，它很棒，但对 Javascript 很陌生，我没有意识到 IE 7 和 IE 8 不能识别 const 关键字。这就是阻止我的 JQuery 运行的原因，而不是动画问题..希望这可能会帮助一些绝望的灵魂。伙计，我迫不及待地想回到好的 ol AS3 和 Flex..

见
[http://www.gtalbot.org/BrowserBugsSection/MSIE7Bugs/JSConstKeyword.html](http://www.gtalbot.org/BrowserBugsSection/MSIE7Bugs/JSConstKeyword.html)

更多

# unit-testing - 有人对正式单元测试的效用有衡量标准吗？

> ID：333922
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-12-02T13:33:47.367
> 
>         
> 
> 标签：unit-testing, metrics

有人对正式单元测试的效用有衡量标准吗？我看到很多关注单元测试工具，我很好奇为什么？

我在 5 或 6 年前停止了正式的单元测试，生产力的净收益似乎相当高。我停止了单元测试，因为我注意到它从来没有捕捉到任何东西——更不用说任何有用的东西了。单元测试检测到的错误类型似乎可以通过每小时不喝超过 2 杯葡萄酒/啤酒（或每小时 2 杯）来预防。此外 - 单元测试似乎通过允许开发人员认为有一些保护措施来捕捉他们的错误而产生风险。

我进行测试以确保代码正常工作，但我不使用任何工具。我根据所做的更改进行测试。我对新代码的生产错误率大约为零。我对代码更改的错误率约为每季度 2-3 个错误。上述措施基于我开发/支持的 4 个生产应用程序。

* * *

## 回答 #1

> 赞同：29
> 
>             
> 
> 时间：2008-12-02T13:36:35.147

我承认你作为人类和编码员的优越性。

然而，我只是个白痴，如果没有 Python 单元测试，我会迷路。  

没有单元测试我无法重构，它需要太多的思考。

如果没有单元测试，我几乎无法编码，很难绝对确定我绝对理解每一个细微差别。

我进行单元测试是因为我是个白痴。由于您不会犯错误，因此您显然不需要进行单元测试。我向你们致敬。

* * *

编辑。对我来说，单元测试与指标或成本无关。我不需要任何随机的、受控的实验来向我展示价值。没有他们我无法工作。事实上，我拒绝在没有他们的情况下工作。同样，如果没有编译器、文本编辑器或源代码控制，我将无法工作。没有要求我不会工作；我拒绝在没有先做设计的情况下编程。  

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T13:41:47.337

我不认为单元测试可以替代传统测试，而是作为确保代码正确性的额外步骤。我发现单元测试有用的一些特定领域是：

*   重构/更改现有代码时。单元测试将验证至少这些案例仍然按预期工作。您进行的测试越多，您就越能确定代码更改不会破坏现有代码。

*   提交错误报告时。进行暴露错误的单元测试是展示错误并知道何时修复的好方法。

*   一种设计界面的方法。你有一些测试代码来检查接口。

可能还有一些我已经忘记了:-P

PS：你怎么知道你没有制造错误？我不认为我会在我处理的代码中引入错误，但这肯定不会如此。恕我直言，认为您的代码没有错误是天真的。

（关于单元测试，如果你知道你的代码可能包含错误——我会说大多数代码都有——你不想使用所有可能的方法来捕获它们吗？）

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T13:54:02.380

这是一些关于单元测试的白皮书，可能会对您有所帮助：

*   [白皮书#1](http://www.mobilein.com/WhitePaperonUnitTesting.pdf)

*   [白皮书#2](http://www.scribd.com/doc/2060575/1999-BenchmarkQA-Whitepaper-Efficiency-and-Effectiveness-Measures-To-Help-Guide-the-Business-of-Software-Testing)

*   [白皮书#3](http://se.ethz.ch/people/leitner/publications/min_leitner_ase_2007.pdf)

但是，[Martin Fowler](http://www.martinfowler.com/bliki/CannotMeasureProductivity.html)说，支持单元测试和 TDD 的轶事证据是压倒性的，但你无法衡量生产力。

单元测试很好，因为您可以更改一个部分并知道它是否在其他地方修改了某些内容。有些人“爱上了”单元测试，应该让自己冷静下来。我相信单元测试，但试图隐藏一切的人与不进行单元测试的人一样危险。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T13:37:29.467

我没有任何指标可以指出，但我认为受欢迎程度的上升是因为我们其他人的经历与你的相反。:)

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T14:19:08.353

这是一个线程，对 TDD 方法进行了一些
[研究](https://stackoverflow.com/questions/164354/research-on-tdd)

[单元测试的投资回报率有确凿的证据吗？](https://stackoverflow.com/questions/237000/is-there-hard-evidence-of-the-roi-of-unit-testing)

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:45:32.930

通过单元测试，我可以修复生产代码中的错误并在发现错误的一小时内安装新版本，并且我可以确定新版本不会比我们以前的版本更差 - 因为测试告诉我。不过，它可能会更好。

他们给了我一个较低的水印，我的代码质量永远不会低于这个水印。它们使我能够跟踪更大的图景，并让测试发现我倾向于犯的小错误。它们也让我能够以一种非常轻松的方式发展。

自从我测试以来，我倾向于按时交付，我的代码质量提高了很多，结果通常按预期工作。此外，我的速度要快得多，因为我可以偷工减料，如果我没有进行测试，那将太危险而无法尝试。

也就是说，尽管我多年来一直在进行单元测试和 TDD，但我也没有任何确切的数字，也不知道任何来源。我对测试的热爱是基于纯粹的口口相传和个人经验。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:47:31.333

我发现在添加新功能时单元测试可以帮助我。在这种情况下，我曾经担心我添加的内容会破坏应用程序的某个远程部分中的某些内容。但是通过适当的单元测试，我知道我在运行测试时是否破坏了某些东西。

[这是关于单元测试效用](http://discuss.joelonsoftware.com/default.asp?joel.3.437893.47)的有趣讨论。

如果您不喜欢单元测试，您可能想要研究的另一个概念是[按合同设计。](http://en.wikipedia.org/wiki/Design_by_contract)  这基本上断言，如果满足某些输入条件，那么根据合同将有保证的输出。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-12-04T15:56:57.093

我是一名开发经理。对于我的组织，设置和迁移到 nhibernate 需要一些设置成本并增加了我们的开发时间。一些开发人员喜欢它，有些人认为这是浪费时间。

错误率没有明显变化，但也许现在说还为时过早。

从我的角度来看，我认为它可以帮助那些不确定自己的工作的初级开发人员，但对于高级开发人员来说，这似乎会减慢他们的速度——保持更新是另一回事。我不确定我们是否会继续使用它，恢复到我们的旧方式（临时单元测试），或者让开发人员做出个人选择。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:46:19.947

有几种工具可以通过单元测试来衡量代码覆盖率。它们与单元测试一起是必不可少的部分，以确保代码不仅经过测试，而且经过完整测试。

其他一切都只是纯粹的魔法；）

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:49:10.207

如果您想重构代码，根据定义，您需要某种方式来判断更改是否破坏了代码。缺乏神圣的洞察力，我发现单元测试是一个很好的工具，但是 ymmv。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:05:22.310

我在一个巨大的单片服务器应用程序上使用 C++ 测试驱动开发 (TDD) 获得了很多收益。

当我在一个代码区域工作时，我首先确保在我更改或编写新代码之前测试覆盖了该区域。

在这个用例中，我在生产力方面取得了巨大的进步。

*   构建并运行我的测试：10 秒。

*   构建、运行和手动测试整个服务器：最少 5 分钟。

这意味着我能够非常快速地迭代代码区域，并且仅在需要时才进行全面测试。

除此之外，我还使用了集成测试，它需要更长的时间来构建和运行，但只执行我感兴趣的特定功能。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:44:00.050

我对你所说的有些同情。我的经验是相似的，因为我的新错误很少被单元测试发现。如果有的话，在发现错误后修改单元测试以确保它不会再次出现。

单元测试对我有帮助的地方在于我的（Java）类的设计。我经常重构这些类以使它们可测试（例如删除单例），我认为这改进了整体设计。对我来说，这就是使用它们的充分理由。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:58:40.580

根据我的经验，单元测试帮助我解决了以下问题：

*   现在我可以把所有的注意力都放在我正在编写的代码块/函数/类上，而不用担心其他任何事情，因为我知道如果我做了一些愚蠢的事情或引起副作用，我的测试会告诉我

*   我可以通过知道我没有破坏东西来重构东西

*   我确定我的应用程序按预期工作

*   在发布之前，我不会手动检查每个功能以确认该应用程序仍然有效，

*   我确信我的应用程序在某种程度上总是稳定的

然而，这与我有点相关，因为我对“一次管理多个东西”和“专注”真的很糟糕。因此，单元测试对我有用，并且多次节省了我的时间，在那里我引入了一个新功能，它打破了一些旧功能。

如果您不是这种情况，请不要使用它。如果您仍然拥有相同的结果、性能和质量，但存在相同数量的错误，那么这意味着您不需要单元测试。或者你需要修改你的单元测试方法。

PS根据你的错误率和你所说的你听起来像个天才（假设这些是中型或大型项目），所以我会说不要使用单元测试，看起来你做得很好。但是对于像我这样不是天才的世界其他人，我强烈推荐单元测试，因为它对我有用。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T15:18:50.510

不知道关于你，但我刚刚检查了两个核心转储的两个修复程序，这些修复程序是由我的单元测试捕获的现有代码的更改创建的。而且我刚刚遇到了一个重大的生产问题，如果我对它的结果有更多的信任（我们的单元测试在功能方面比我想承认的要多一点），那么单元测试就会发现这个问题。

* * *

## 回答 #15

> 赞同：-1
> 
>             
> 
> 时间：2008-12-03T07:08:14.260

在我看来，使用流行的测试工具进行正式的单元测试很像美国的机场安检。

*   它提供了安全的假象

*   它让人们“感觉”很好

*   非常不方便（如果你的皮肤颜色不对，非常不方便）

*   如果你批评它，人们会愤怒地向你挥舞拳头......

*   当他们的过程失败时，这些相同的人会感到困惑，他们会跳上下一个乐队......

我认为人们对软件有不同的看法。在我看来，软件是一种赚钱的方式（希望通过增加收入或省钱）。我看过 TDD 的帖子，这是我认为最接近回答问题的科学方法，但该方法缺乏科学严谨性。指定的文章都没有基线或相当对比的替代方法。

我想，正式单元测试的拥护者将继续以他们的方式感到安全。我将继续将我的规格写在一张纸上，然后放入我的圣安东尼雕像脚下的碗中并祈祷。谁能说哪种方式更有效，但我的方式确实感觉很好……也许我会写一篇关于它的白皮书。

* * *

## 回答 #16

> 赞同：-3
> 
>             
> 
> 时间：2008-12-02T14:09:55.313

记住 70 年代和 80 年代的发型和衣服越来越受欢迎……这对我们这些生活在这几十年里的人来说并不是那么好。

正式的单元测试需要大量的工作和努力来维护。我猜想实际开发软件需要 20-50% 的时间。我要问的是，为每项开发工作增加 20-50% 开销的已知价格是值得关注和/或可证明的收益。  

通过不进行正式的单元测试，您正在迫使开发人员考虑要测试的适当事物。开发人员对产品拥有更多所有权。

正式的单元测试听起来像蛇油汁……大家和他哥都说它好、好用、酷等等，但一直没有随机对照试验证明它实际上是省时省钱的。迄今为止的所有回应都是主观的证词。  

我想知道的是，在引入单元测试之后，是否有软件经理能够展示出更高的生产力（甚至更高的质量）。

大声笑 - S.Lott 的诙谐咆哮是排名最高的回应......鉴于这个论坛是匿名的（无论如何对我来说），你的尊重不是我想要的。我认为自己勉强高于平庸。我曾与杰出的开发人员一起工作……这些人通常甚至不对他们的代码进行基本测试——他们只知道它会起作用。  

# .net - 使用 ADO.NET 实体对象和基于 Soap 的 Web 服务

> ID：333923
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-12-02T13:33:56.760
> 
>         
> 
> 标签：.net, web-services, entity-framework

我正在构建一个传统的 ASP.NET Web 服务——使用 asmx 构建的样式。这是一项非常简单的服务。我开始为我的持久层使用新的 Ado.NET Entity Framework，但遇到了一些问题：

1) 我不喜欢自动生成的 WSDL —— 复杂类型被定义为：

```
 <s:complexType name="TestObject">
      <s:complexContent mixed="false">
         <s:extension base="tns:EntityObject"> ... 
```

于是，我构建了自己的 WSDL，并使用 wsdl.exe 工具创建了一个服务定义，其中包含了一个新的类型定义，所以现在的 WSDL 看起来是这样的，我觉得这是一个更跨平台的设计：

```
<xsd:complexType name="TestObject">
  <xsd:sequence>
    <xsd:element minOccurs="0" name="created" type="xsd:dateTime"/> ... 
```

我现在让 ASPX 生成一个不错的 WSDL 文件。但现在我不确定我应该把它带到哪里。对于 TestObject，我有两种基本相同的类型：1) 用于使用 ADO.NET Entity Framework 进行实体持久性 2) 一种用于通过网络定义数据。  

我想弄清楚如何将它们组合成一个。我对修改由 Ado.NEt 实体框架自动生成的 .cs 文件有点紧张，因为它似乎可能会被覆盖。

任何对 Ado.Net 实体体验有丰富经验的人认为它值得使用吗？虽然我喜欢能够以多快的速度为数据层构建持久性的想法，但我需要以非常自定义的方式定义实体对象如何通过网络传输，因此我需要修改与其关联的属性特性。此外，在我的服务实现中，我真的不想从 EntityFramework.TestObject 转换为 WSDLDefenition.TestObject。

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T14:22:23.120

您正面临着我们许多人在尝试在 SOA 风格架构中使用实体框架时所面临的那种墙。  

实体框架 1.0 版在您所描述的场景中效果不佳，因为您最终会在尝试管理对象上下文（并且可能不得不缓存它们）时陷入痛苦的世界。

我建议彻底通读EF 团队发布的关于实体框架未来的以下 (1)[篇文章。](http://blogs.msdn.com/efdesign/archive/2008/11/20/n-tier-improvements-for-entity-framework.aspx)它还具有捕捉和讨论当前一些不足的效果。

简而言之，我不确定实体框架是否完全是您现在想要的解决方案，因为在此阶段在跨线路（或外部服务边界）处理 EF 实体方面没有“干净”的解决方案。  

其他人可能会有所不同...

PS您对手动编辑生成的代码保持警惕是正确的-对数据模型的任何更新都将覆盖任何修改（尽管您可以扩展它，因为它们在部分类中）。但是，如果您想向属性添加属性，则无济于事。

(a) [http://blogs.msdn.com/efdesign/archive/2008/11/20/n-tier-improvements-for-entity-framework.aspx](http://blogs.msdn.com/efdesign/archive/2008/11/20/n-tier-improvements-for-entity-framework.aspx)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:31:02.713

谢谢。这是我所怀疑的，但不想花一整天的时间研究。我暂时要做的是将我的对象分开，这样我可以保持干净的 WSDL，然后在数据访问层中，我将在网络上的对象和 ADO.NET 实体之间进行转换框架。  

可能不是最合理的方法，但这会让我通过演示。

感谢文章的链接，我认为我缺少的关键概念是持久无知。我从事过 Java Web 服务，您可以在其中定义 POJO（普通旧 Java 对象）并轻松地通过网络传输它们，以及持久保存到数据源......

...我现在明白你为什么建议 WCF，因为对持久无知的支持。

# dvcs - 小型远程员工公司的 DVCS

> ID：333926
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-12-02T13:34:34.307
> 
>         
> 
> 标签：dvcs

情况是这样的：在我的小办公室里，因为我们喜欢保持移动，偶尔在家工作，我们没有中央文件服务器，而是将所有办公文档放在一个 SVN 存储库中，每个人都在自己的笔记本电脑上进行结账. 结帐的重量约为 3GB，其中包含修订的 repo：约 6GB。这一切都很好。

问题是很快我们将不再有一个小办公室——我们所有的 5 名员工都将远程工作。我曾考虑购买一台专用服务器并从中运行我们的 SVN 存储库，但我们的两个工作人员将*非常*远程，并且将使用 3GB/月限制的无线“宽带”，我担心一些大型更新会真的撕毁了他们每月的零用钱，更不用说花一整天的时间来完成了。

阅读有关 Stack Overflow 的几个问题后，似乎有相当多的分布式 VCS 爱好者社区认为 git 或 mercurial 绝对是许多情况下的最佳选择。鉴于所有员工仍然能够至少每两周面对面会面一次（因此处于快速 LAN 上），我想知道 DVCS 是否适合我们？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T04:58:12.673

查看[Fossil](http://fossil-scm.org) DVCS，它可能符合您的要求。Fossil 可以像 SVN 或 DVCS 一样使用。如果您担心它会处理您当前的存储库，请尝试一下。它还有一个内置的项目 wiki 和错误跟踪系统，也与存储库一起分发。您可以尝试一下，看看它是否适用于您的小团队。

对您来说痛苦的是丢失您的修订历史，此时我不相信您可以将 svn 存储库导入 Fossil。

加入邮件列表，您将获得任何问题的答案。SQLite 的创建者也是这个项目的创建者。希望这可以帮助。  

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T08:37:47.917

我不明白为什么不。*使用git*之类的东西，存储库是机器本地的，因此您的远程员工实际上可以拥有一个跟踪的更改日志，然后可以与主存储库合并或重新建立基础——无论你决定是什么——当他们有机会时.

此外，与 SVN 相比， *git*的压缩性能非常好，因此 3GB/mo 的配额对于您的远程员工来说可能绰绰有余。

Randal Schwartz 实际上在 Google 的技术讲座上对*git*做了一个非常好的介绍： [http ://www.youtube.com/watch?v=8dhZ9BXQgc4](http://www.youtube.com/watch?v=8dhZ9BXQgc4)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-12-03T20:41:52.010

我不确切知道您的存储库中有什么，但除非您定期更改所有文件，否则 DVCS 应该为您提供非常理想的工作流程。

您可以进行 svn -> git 转换，将 repo 粘贴到 DVD 上并将其邮寄到所有卫星办公室，然后让他们以相当低的增量成本（应该小于 delta一般来说）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-12-03T20:23:45.400

（似乎没有人回答这个问题。） DVCS 当然似乎可以工作，但我没有这方面的经验。如果您不期望每天都有大的变化，那么像 svn 这样的集中式系统也可以工作。（从服务器上来回）在这种情况下，初始获取将是唯一真正昂贵的问题。  

您现在可以监控您的使用情况并查看来回流量吗？

这里真正的问题是 3GB/mo 带宽限制。想出一个更好的连接解决方​​案可能会更好......

# c# - 为什么头文件在其他编程语言中没有流行起来？

> ID：333927
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-12-02T13:34:44.073
> 
>         
> 
> 标签：c#, java, c++

基于对这个问题的回答：[为什么C++有头文件和CPP](https://stackoverflow.com/questions/333889/in-c-why-have-header-files-and-cpp-files)

我已经看到了回复并理解了答案——那为什么没有流行起来呢？C#Java？

* * *

## 回答 #1

> 赞同：28
> 
>             
> 
> 时间：2008-12-02T13:39:52.393

因为它是接口与实现问题的快速、肮脏和不优雅的解决方案。

它完全依赖于 C 预处理器，这是抽屉里最钝的工具。

其他解决方案可避免以下问题：

*   两个文件，一个可以做

*   由于多个定义，在链接时重复符号

*   由于多个“静态”常量导致的代码膨胀

*   要求标头保护以防止多重包含

*   违反 DRY 原则

*   和更多...

[Dviljoen](https://stackoverflow.com/users/29021/dviljoen)认为我对此很努力，他是对的。它几乎是[40 年前的设计](http://en.wikipedia.org/wiki/C_(programming_language)#Early_developments)，来自打孔卡和纸带时代。尽管上面列出了所有潜在的陷阱和问题，但仍有大量使用源/头文件排列的 C/C++ 构建的高质量软件。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-12-02T13:39:42.910

因为这意味着复制可以从源代码中获得的信息。其他语言试图避免这种代码重复。

在我以前的 C 时代，我也是这样做的。我将所有信息保存在我的 .c 文件中，并在正常构建期间使用一个小工具从它们生成头文件。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2008-12-02T13:51:46.567

对于 C#，3.0[规范](http://msdn.microsoft.com/en-us/vcsharp/aa336809.aspx)规定

> 因为程序集是包含代码和元数据的自描述功能单元，所以在 C# 中不需要#include 指令和头文件。特定程序集中包含的公共类型和成员在 C# 程序中可用，只需在编译程序时引用该程序集即可。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-12-02T14:07:27.143

因为它们是过去的遗留物。

现代语言使用模块和包的概念。

如果要使用在另一个文件中定义的函数/类，请导入该文件。编译器计算出符号（即名称），以便您可以使用它们。

C/C++ 方法：手动提取函数/类定义并将它们放在另一个文件中，然后在您想要使用它们的任何地方对这些定义进行文本包含。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2008-12-02T14:36:10.190

在 C 中，您不能进行前向引用，即。使用尚未在其用途之上定义的功能。标头最初是为此而制作的，作为对实现的引用。

我查看了引用问题的公认答案，这是正确的。但是今天，编译速度是一个小问题（也许对于非常大的应用程序除外：清理编译我们拥有的应用程序需要 1/4 小时，至少在 Windows 上是这样）。无论如何，实现的细节都是隐藏的，我们通常只看 API 文档，即。可见界面。

对于轶事，我看到一些 C++ 库在标头中实现了 99%（只有系统请求它们的 .cpp 文件），因此模仿了 Java 风格（当时 C# 还不在这里......）。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T14:01:22.880

我想说，理想情况下，所有信息都应该放在一个地方，并且有一个模块系统，可以智能地避免重新编译/导入不必要的细节，然后让编译器能够在必要时提取仅接口信息（例如，与图书馆或其他任何东西一起运送）。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T13:46:14.923

它们在 C# 和 Java 中并不是真正需要的，因为您可以为每个方法（例如公共或私有）指定访问级别，此外，您还可以像在 C++ 中那样具有反射性。

请注意，对于非 OOP 实践，使用头文件并没有那么糟糕。例如，您可以只在头文件中声明哪些函数应该对客户端公开可用，同时通过仅在 .cpp 或 .c 文件中声明它们来隐藏其他函数（因此不可访问）。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T14:28:05.697

我想说，大多数 OO 语言从拥有接口中获得了他们需要的所有里程。它提供了头文件的所有灵活性（即 - 将接口与实现分离），同时与使用接口的客户端有更严格的合同（因为它们是由语言/编译器强制执行的）。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T14:10:56.450

对我来说，C 和 C++ 中的标头是一个重要的时间和生产力下沉。编译...哎呀，忘了修复方法的签名。编译...哎呀，需要将方法a添加到类X。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T14:27:57.447

为了摆脱头文件，编译器的输出需要包含编译器本身可以理解的代码描述。对于较旧的链接器，这并不容易：它们使用的目标文件不能太聪明。因此，创建代码描述的任务留给了人：头文件。

较新的语言要么完全绕过链接器（解释语言和 VM 语言），要么使用自定义链接器（Turbo Pascal，我也假设为 Delphi）。尽管如此，即使是现在，当您处理链接器（或其年轻的兄弟，动态库加载器）时，您仍需要对库中的内容进行某种描述。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:38:50.227

大多数其他语言并不像 C++ 那样迟钝且难以解析和编译，因此分离标头和实现的“性能优化”并不那么重要。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T18:11:55.887

在 C/C++ 中，头文件基本上是一种对变量进行分组的方法，否则这些变量需要在使用它们的每个编译单元中声明为外部变量。

然而，这并没有限制 C/C++ 可以处理的问题域的复杂性或多样性。只是编程语言是这样进化的。最终，重要的是链接器以某种方式找出您在程序中使用的变量的所有引用和类型。

与似乎具有本地语言支持以处理对变量和方法的外部引用的新型编程语言相比，C/C++ 执行此操作的方式相当粗糙。

# language-agnostic - 重新实现 ToUpper()

> ID：333946
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-12-02T13:44:00.093
> 
>         
> 
> 标签：language-agnostic, unicode, localization, internationalization, toupper

如果 ToUpper() 不存在，你将如何编写它？i18n 和 L10n 的奖励积分

好奇心由此引发：[http ://thedailywtf.com/Articles/The-Long-Way-toUpper.aspx](http://thedailywtf.com/Articles/The-Long-Way-toUpper.aspx)

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-12-02T14:41:54.827

1.  我下载了 Unicode 表

2.  我将表导入数据库

3.  我写了一个方法upper()。

这是一个示例实现；）

```
public static String upper(String s) {
    if (s == null) {
        return null;
    }

    final int N = s.length(); // Mind the optimization!
    PreparedStatement stmtName = null;
    PreparedStatement stmtSmall = null;
    ResultSet rsName = null;
    ResultSet rsSmall = null;
    StringBuilder buffer = new StringBuilder (N); // Much faster than StringBuffer!
    try {
        conn = DBFactory.getConnection();
        stmtName = conn.prepareStatement("select name from unicode.chart where codepoint = ?");
        // TODO Optimization: Maybe move this in the if() so we don't create this
        // unless there are uppercase characters in the string.
        stmtSmall = conn.prepareStatement("select codepoint from unicode.chart where name = ?");
        for (int i=0; i<N; i++) {
            int c = s.charAt(i);
            stmtName.setInt(1, c);
            rsName = stmtName.execute();
            if (rsName.next()) {
                String name = rsName.getString(1);
                if (name.contains(" SMALL ")) {
                    name = name.replaceAll(" SMALL ", " CAPITAL ");

                    stmtSmall.setString(1, name);
                    rsSmall = stmtSmall.execute();
                    if (rsSmall.next()) {
                        c = rsSmall.getInt(1);
                    }

                    rsSmall = DBUtil.close(rsSmall);
                }
            }
            rsName = DBUtil.close(rsName);
        }
    }
    finally {
        // Always clean up
        rsSmall = DBUtil.close(rsSmall);
        rsName = DBUtil.close(rsName);
        stmtSmall = DBUtil.close(stmtSmall);
        stmtName = DBUtil.close(stmtName);
    }

    // TODO Optimization: Maybe read the table once into RAM at the start
    // Would waste a lot of memory, though :/
    return buffer.toString();
} 
```

;)

注意：您可以在[unicode.org](http://unicode.org/)上找到的 unicode 图表包含字符/代码点的名称。该字符串将包含“SMALL”代表大写字符（注意空格，否则它可能匹配“SMALLER”等）。现在，您可以搜索类似的名称，将“SMALL”替换为“CAPITAL”。如果你找到它，你就找到了大写版本。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2008-12-02T13:49:51.967

我不认为 SO 可以在单个帖子中处理 unicode 表的大小:)

不幸的是，它不像 char.ToUpper() 每个字符那么容易。

例子：

```
(string-upcase "Straße")    ⇒ "STRASSE"
(string-downcase "Straße")  ⇒ "straße"
(string-upcase "ΧΑΟΣ")      ⇒ "ΧΑΟΣ"
(string-downcase "ΧΑΟΣ")    ⇒ "χαος"
(string-downcase "ΧΑΟΣΣ")   ⇒ "χαοσς"
(string-downcase "ΧΑΟΣ Σ")  ⇒ "χαος σ"
(string-upcase "χαος")      ⇒ "ΧΑΟΣ"
(string-upcase "χαοσ")      ⇒ "ΧΑΟΣ" 
```

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-12-02T14:25:35.267

没有静态表是足够的，因为您需要先了解语言，然后才能知道正确的转换。

例如，在土耳其语`i`中需要转到`İ`(U+0130) 而在任何其他语言中需要转到`I`(U+0049) 。和`i`U+0069 是同一个字符。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:50:06.867

我不会赢得奖励积分，但这里是 7 位 ASCII：

```
char toupper(char c)
{
    if ((c < 'a') || (c > 'z')) { return c; }
    else { return c & 0xdf; }
}
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:02:00.820

在蟒蛇..

```
touppe_map = { massive dictionary to handle all cases in all languages }
def to_upper( c ):
   return toupper_map.get( c, c ) 
```

或者，如果您想以“错误的方式”进行操作

```
def to_upper( c ):
  for k,v in toupper_map.items():
     if k == c: return v
  return c 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:16:21.883

让我为诸如希伯来语、阿拉伯语、格鲁吉亚语和其他没有大写（大写）字母的语言提供更多奖励积分。:-)

# wpf - 一个好的 WPF 滚动时间线控件？（花哨的日期时间选择器）

> ID：333948
> 
>         
> 
> 赞同：19
> 
>         
> 
> 时间：2008-12-02T13:44:40.340
> 
>         
> 
> 标签：wpf, user-controls, controls, custom-controls

我正在寻找可以用作时间线控件的东西。一种“横幅”，用户可以向左或向右拖动以在时间上向前或向后移动，然后他或她应该能够在该控件上选择一个时间点。

一个花哨的日期时间选择器:-)

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2010-01-11T06:44:28.683

欢迎您试用我的新 TimelineControl。我已在 codeplex 中发布它：[TimelineControl](http://timelinecontrol.codeplex.com/)

我愿意。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-11-15T01:23:35.683

也试试这个[http://timeline.codeplex.com](http://timeline.codeplex.com)

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2008-12-02T16:34:42.650

[您可以在此处](http://www.robzelt.com/blog/2007/01/10/TimeLinePanel+Custom+WPF+Control+Part+1.aspx)和[此处](http://www.blendables.com/products/productsLayoutmix.aspx)找到时间线面板 

还有[这里](http://marlongrech.wordpress.com/2008/02/06/wpf-date-time-picker/)的日期时间选择器，我个人使用  了很多来自 Kevin's [Bag O 技巧的日期选择器](http://j832.com/bagotricks/)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T23:34:32.833

[WPF Toolkit](http://www.codeplex.com/wpf/Release/ProjectReleases.aspx?ReleaseId=15598)上有一个日期时间选择器和月历。

# c# - C# 相当于 Java 的 Exception.printStackTrace()？

> ID：333953
> 
>         
> 
> 赞同：91
> 
>         
> 
> 时间：2008-12-02T13:45:38.047
> 
>         
> 
> 标签：c#, .net, exception, stack-trace

是否有与 Java 等效的 C# 方法，`Exception.printStackTrace()`还是我必须自己编写一些东西，通过 InnerExceptions 工作？

* * *

## 回答 #1

> 赞同：129
> 
>             
> 
> 时间：2008-12-02T13:48:45.107

试试这个：

```
Console.WriteLine(ex.ToString()); 
```

从[http://msdn.microsoft.com/en-us/library/system.exception.tostring.aspx](http://msdn.microsoft.com/en-us/library/system.exception.tostring.aspx)：

> ToString的默认实现获取抛出当前异常的类名、消息、内部异常调用ToString的结果、调用Environment.StackTrace的结果。如果这些成员中的任何一个为 null，则其值不包含在返回的字符串中。

请注意，在上面的代码中，调用`ToString`不是必需的，因为有一个直接`System.Object`调用和调用的重载`ToString`。

* * *

## 回答 #2

> 赞同：111
> 
>             
> 
> 时间：2008-12-04T08:32:23.247

我想补充一点：如果要在异常之外打印堆栈，可以使用：

```
Console.WriteLine(System.Environment.StackTrace); 
```

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2008-12-02T13:52:18.453

正如 Drew 所说，只需将异常转换为字符串即可。例如，这个程序：

```
using System;

class Test
{
    static void Main()
    {
        try
        {
            ThrowException();
        }
        catch (Exception e)
        {
            Console.WriteLine(e);
        }
    }

    static void ThrowException()
    {

        try
        {
            ThrowException2();
        }
        catch (Exception e)
        {
            throw new Exception("Outer", e);
        }
    }

    static void ThrowException2()
    {
        throw new Exception("Inner");
    }
} 
```

产生这个输出：

```
System.Exception: Outer ---> System.Exception: Inner
   at Test.ThrowException2()
   at Test.ThrowException()
   --- End of inner exception stack trace ---
   at Test.ThrowException()
   at Test.Main() 
```

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T13:49:14.310

[http://msdn.microsoft.com/en-us/library/system.exception.stacktrace.aspx](http://msdn.microsoft.com/en-us/library/system.exception.stacktrace.aspx)

Console.WriteLine(myException.StackTrace);

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T13:50:07.710

```
 catch (Exception ex)
{
    Console.WriteLine(ex.StackTrace);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:47:21.397

是否没有 C# Logging API 可以将异常作为参数并为您处理所有事情，就像 Java 的 Log4J 一样？

即，使用 Log4NET。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2020-01-27T11:51:17.757

由于@ryan-cook 的回答对我不起作用，如果你想打印堆栈跟踪而不出现异常，你可以使用：

```
System.Diagnostics.StackTrace stackTrace = new System.Diagnostics.StackTrace();
Console.WriteLine(stackTrace) 
```

不幸的是，这不能在 PCL 或 .NETStandard 库中完成

* * *

## 回答 #8

> 赞同：-1
> 
>             
> 
> 时间：2008-12-02T13:52:59.577

另请查看 Log4Net ...它是 Log4J 到 .NET 的一个端口。

# .net - 远程处理性能会随着时间的推移而降低

> ID：333954
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-12-02T13:46:02.693
> 
>         
> 
> 标签：.net, remoting, client-server

我正在开发一个客户端-服务器解决方案，该解决方案使用 .NET 2.0 Remoting（服务器激活、TCP 通道上的二进制格式、Vista Ultimate）进行通信。目前我正在分析应用程序并在同一台机器上运行所有内容。我注意到，如果我启动应用程序，几分钟内一切正常，然后突然每次远程调用都需要几秒钟才能执行。我在两端都登录并记录每个电话。服务器端的实现只需要几分之一秒的时间来执行，而整个远程调用很慢。进一步的分析表明，远程处理在服务器端降级：虽然远程服务的内部工作在几分之一秒内执行，但响应非常慢。如果我重新启动服务器，一切都会再次恢复正常几分钟。

有没有人经历过这样的事情？

谢谢！

更新：我检查过，如果我将远程对象的生命周期配置为 1 天，我仍然遇到同样的问题。

更新：我正在使用 Ingo Ramer 建议的模式（[HOWTO：使用基于接口的远程对象和配置文件](http://www.thinktecture.com/resourcearchive/net-remoting-faq/useinterfaceswithconfigfiles)）来处理我的所有远程处理内容，如果这有什么不同的话。

客户端代码：

```
public static object CreateInstance(Type type)
{
    if (!Initialized)
        InitWellKnownTypesCache();

    WellKnownClientTypeEntry typeEntry = (WellKnownClientTypeEntry)wellKnownTypesCache[type];
    if (null == typeEntry)
        throw new RemotingException("Type not found.");

    if (string.IsNullOrEmpty(serverObjectActivationUri))
        throw new RemotingException("ServerObjectActivationUri wasn't configured. Cannot create server object instance.");

    return Activator.GetObject(typeEntry.ObjectType, string.Format(serverObjectActivationUri, typeEntry.ObjectUrl));
} 
```

服务器端只有正确的配置文件，如下所示：

```
 <service>
            <wellknown 
                mode="Singleton" 
                type="MyDomain.SomeDomain, MyDomain" 
                objectUri="SomeDomainService"
            /> 
```

除了 RemotingConfiguration.Configure("MyDomainService.exe.config", false); 我什么都不做 在我的服务器和客户端代码中都没有。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T22:42:30.957

使用诸如[Wireshark 之](http://www.wireshark.org/)类的网络监控工具来查看您的问题是与网络相关还是与服务器同步相关。

如果证明不是网络问题，那么尝试在链中（就在通道之前）附加一个简单的自定义同步来记录并获取钩子之间的时间。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-12-04T23:17:56.377

它可能与终身租赁有关。Singleton 对象受为其指定的生命周期租约的约束，因此即使客户端当前持有对它的引用，它也可以被回收。您可以通过重写 MarshalByRefObject 的 InitializeLifetimeService 方法来创建前一种类型的 Singleton 对象。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-12-03T04:21:23.067

我将远程处理通道的类型从 tcp 更改为 http，同时保留二进制格式。我可以在几分钟的不活动中看到同样的减速，但与 tcp 通道不同，在客户端进行“慢”远程调用后，服务器“唤醒”并且所有后续调用都很快，直到下一个不活动期到来并且服务器又睡着了。

这绝不是一个解决方案，但至少是某种解决方法。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:48:51.113

绝不。您是否正在做一些导致您的远程处理层的额外实例被注册/实例化的事情？

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-12-05T13:12:08.640

您可以为您的班级尝试 MTAThread 属性，只是一个想法..

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-12-07T19:07:38.093

您是否偶然拨打了大量的远程电话？如果您的调用速度足够快，您可能会用完线程来处理请求。  

这可能不是你的问题，但我之前遇到过，所以我想我把它传递了。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T22:51:56.930

您是否与客户赞助商赞助您的远程对象？

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T21:22:35.737

A glance at your code, or a subset thereof, would also help.

# svn - 将 SVN 中的树“复制”到本地存储库中，然后将其合并回来

> ID：333960
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-12-02T13:47:28.883
> 
>         
> 
> 标签：svn

我的主 PC 上有一个 SVN 存储库，只有我可以访问。我也有一台笔记本电脑，当我没有连接到我的电脑时，我不想失去 SVN 功能。所以目前，我只是将整个存储库复制到笔记本电脑并将其复制回来。

这当然效果很好（我是唯一的开发人员，所以无论如何我不在时都无法访问 repo），但每次都做起来有点乏味。

我想知道是否有一种方法可以从 SVN 签出目录并将其存储在笔记本电脑上的（新）存储库中，对其进行处理，然后将该存储库与主存储库合并。（是的，我知道这对于 git 或 Mercurial 等分布式系统来说是一个很好的案例，但我不想失去 VisualSVN/TortoiseSVN）。

我不确定我在寻找什么，但我想我正在寻找两个存储库之间的分支和合并：将树从 repo1 分支到 repo2，然后将其合并回来。这里需要注意的是：我想保留 repo2 的历史记录。因此，如果我对 repo2 进行了 10 次提交，我也想将这 10 次提交转移到 repo1 中，这样我仍然可以返回。

这甚至可能吗，还是我最好还是每次都复制整个存储库？（无论如何它都位于虚拟机中，这意味着我每次都复制整个虚拟机）。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:55:16.823

我建议不要每次都复制整个存储库，而是使用[rsync](http://en.wikipedia.org/wiki/Rsync)。如果你使用 svn 的 fsfs 后端（你应该这样做），那么它将只同步新的修订版本，而且速度很快。当然，并发签入是不可能的（但我知道它们也不是必需的）。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:59:32.760

[SVK](http://svk.bestpractical.com/view/HomePage)

svk 是一个分散的版本控制系统，使用强大的 Subversion 文件系统构建。它支持仓库镜像、断连操作、历史敏感合并，并与其他版本控制系统以及流行的可视化合并工具集成。

# jquery - sql搜索查询多个可选参数

> ID：333965
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-12-02T13:48:01.363
> 
>         
> 
> 标签：jquery, sql, sql-server, search, stored-procedures

我正在尝试为我的文档归档系统上的高级搜索页面编写查询。我正在尝试通过多个可选参数进行搜索。我有大约 5 个参数可以是空字符串或搜索字符串。我知道我不应该检查每个字符串或为空，并为每个组合创建一个单独的存储过程。

编辑：最终使用：

```
ISNULL(COALESCE(@var, a.col), '') = ISNULL(a.col, '') 
```

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-12-02T13:53:26.157

您可以像这样使用 COALESCE（或 ISNULL）：

```
WHERE COALESCE(@var1, col1) = col1 
AND COALESCE(@var2, col2) = col2 
AND COALESCE(@var3, col3) = col3 
```

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2008-12-02T14:00:24.897

我通常这样做：P

```
WHERE (@var1 IS NULL OR col1 = @var1)
AND (@var2 IS NULL OR col2 = @var2) 
```

...

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T13:50:34.650

您可以将 OR 放在 WHERE 子句中，如下所示：

```
WHERE 
   (@var1 = '' OR col1 = @var1) AND
   (@var2 = '' OR col1 = @var2) AND
   (@var3 = '' OR col1 = @var3) ... 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T20:58:08.297

另一种方法是在存储过程中动态构建 SQL，这会为查询生成可能的最佳计划，并且无论如何都会创建和使用计划（在 2005 年及以上）。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:53:11.337

您可以将可选参数传递给存储过程，但优化器将根据您对该过程的特定调用构建计划。SQL Server 2005 及更高版本中有一些技巧可以避免这种情况（参数嗅探、“无编译”提示等）

尽管如此，我还是更喜欢用查询的核心构建一个视图，然后在几个带有特定参数的过程中使用该视图。这使 SQL 可以根据需要/应该进行优化，并且我仍然可以整合查询细节。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T13:53:42.430

更好的是使参数可选为 NULL，然后在 WHERE 子句中进行测试，就像空字符串的情况一样......

# database - 更新数据库表的方法应该如何进行单元测试？

> ID：333990
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-12-02T13:56:26.277
> 
>         
> 
> 标签：database, unit-testing, tdd

我有一个数据库密集型应用程序。大多数应用程序方法都是更新数据库中的数据。一些调用是对存储过程的包装，而另一些调用使用 3rd 方 API 在代码中执行数据库更新。  

我应该在单元测试中测试什么？我是不是该...

1.  测试每个方法是否在没有抛出异常的情况下完成 - 或 -

2.  每次测试后验证数据库中的数据，以确保数据状态符合预期

我最初的想法是#2，但我担心我会编写一堆*框架代码*来配合我的单元测试。我读到你不应该为单元测试编写一堆框架代码。

想法？

**编辑：**我所说的框架是编写大量其他代码作为单元测试代码的*库*......而不是第三方框架。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-12-02T13:59:03.713

我做第二个，即通过更新记录来测试更新，然后将其读回并验证值是否与您输入的值相同。在事务中进行更新和读取，然后滚动它回来，以避免对数据库的永久影响。我不认为这是测试框架代码，就像我认为它是测试操作系统代码或网络代码一样......框架（如果你的意思是非应用程序特定的数据库访问层组件）应该被测试和验证独立。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T14:19:52.907

还有第三种选择，即使用一个模拟数据库访问对象，该对象知道如何响应更新，就好像它已连接到实时数据库一样，但它并不真正对数据库执行查询。

该技术可用于补充针对实时数据库的测试。这与针对实时数据库的测试不同，不应替代这种测试。但它至少可以用来测试你的类对数据库更新的调用是通过正确的输入完成的。它的运行速度通常也比针对真实数据库运行测试快得多。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T14:09:09.853

您必须测试代码对数据的实际影响，以及它是否符合验证规则等，而不仅仅是没有引发异常——这有点像只检查程序编译！

很难测试执行插入、更新或删除 (DML)**的**数据库代码，因为测试改变了它运行的环境，即数据库。连续多次运行相同的程序可能（并且可能应该）每次都有不同的结果。这与单元测试“纯代码”非常不同，您可以运行数千次并始终获得相同的结果——即“纯代码”是**确定性**的，而执行 DML 的数据库代码则不是。

出于这个原因，您经常需要构建一个“框架”来支持数据库单元测试——即脚本来设置一些处于正确状态的测试数据，并在测试运行后进行清理。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T14:23:05.363

如果您没有手动写入数据库，而是使用框架（jvm、.net 框架，...），您可以放心地假设框架正确地写入数据库。您必须测试的是您是否正确使用了框架。

只需模拟数据库方法和对象。测试您是否正在调用它们并正确检索数据。这样做将使您有机会更轻松地编写测试，更快地运行它们，并使它们完全并行，没有任何问题。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T17:47:40.100

它们根本不应该进行*单元*测试！这些方法的重点是与外部世界（即数据库）*集成。*因此，请确保您的*集成*测试击败了这些方法中的你知道什么，而忘记单元测试。

无论如何，它们应该非常简单，以至于它们“显然没有错误”——如果它们不是，你应该将它们分解成一个具有逻辑的部分和一个愚蠢的部分，它只需要一个值并将其粘贴在数据库。

记住：目标是 100% 的*测试*覆盖率，而不是 100%的*单元测试*覆盖率；这包括您的*所有*测试：单元、集成、功能、系统、验收和手册。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:04:22.017

如果更新逻辑很复杂，那么您应该执行 #2。

在实践中，真正对复杂计算和更新进行单元测试的唯一方法，例如计算一组客户交易的银行费用，是在单元测试开始时将一组表初始化为已知值并测试预期最后的值。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:08:01.637

我使用[DBUnit](http://www.dbunit.org/)将数据加载到数据库中，执行更新逻辑，最后从数据库中读取更新的数据并进行验证。基本上#2。

# .net - “完美”的 .NET 开发环境？

> ID：333992
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2008-12-02T13:57:25.620
> 
>         
> 
> 标签：.net, version-control, development-environment

我收到了一份早期的圣诞礼物：

    允许退出开发周期以**重新组织**和**记录**我们的应用程序。

    我有完全的自由来重组、重构和设置我认为合适的任何数量的基础设施。

如果您有[全权委托](http://en.wiktionary.org/wiki/carte_blanche)，那么您的“完美”.NET 开发环境是什么？

关于应用程序：

VB.NET 客户端-服务器应用程序。（Windows Forms 前端，ASPX Webservices 后端）

    目前使用 Visual Studio 和 SQL Server 2003 和... Visual SourceSafe。

我想要一些组合：

    * 更好的版本控制。（倾向于 Subversion）

    * Wiki 或其他用于错误跟踪和文档的系统。（倾向于使用 Subversion
的[Trac](http://Trac)
 ）     * 简化的构建过程和日常构建（[Visual Build](http://en.wikipedia.org/wiki/Visual_Build)？[CruiseControl.NET](http://en.wikipedia.org/wiki/CruiseControl)？）

    * SQL Server 数据库的版本控制

    * 升级到 Visual Studio 2005（或 2008）？

... 对于一个由 5 人左右的开发人员组成的小团队

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2008-12-02T13:59:58.377

我认为你们都在朝着正确的方向倾斜。

使用 Visual Studio 2008。它在 SP1 中非常稳定，您可以针对 .NET 框架的版本 2 和版本 3。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-12-02T14:29:15.087

无论您投入多少时间和思想，您都可能永远不会得到一个“完美”的环境。每个工具都有自己的夸克和问题。不过，这里有一些值得深思的地方：

转到最新最好的 Visual Studio 版本，Visual Studio 2008 SP1。  

如果您是 MSDN 订阅者，并且购买了 Visual Studio 的 Team System 版本，则可以安装[Team Foundation Server](http://Team%20Foundation%20Server)(TFS)。TFS 是一个非常漂亮的产品，集成到 Visual Studio 中。它使用 Windows Sharepoint Services (WSS)，这将使您能够拥有 wiki、文档存储库等（基本上是 Microsoft Office Sharepoint Server 的精简版）。TFS 还将为您提供最新版本的 Visual SourceSafe，我对此没有任何问题，Microsoft 谈到它能够扩展到数十万用户。TFS 工作组版将允许您最多 5 名开发人员使用，而无需购买许可证。超过 5 个用户，您必须购买许可证。我也很确定您必须使用 SQL Server 2005 才能运行 TFS，但我可能错了。我们将 TFS 安装在一个盒子（我们的开发者盒子）上，并且没有任何问题。    

  SO TFS 会给你：

*   合作
*   版本控制
*   报告项目状态
*   问题跟踪
*   集成到 Visual Studio
*   很多其他的好东西

对于您的日常和持续构建，我倾向于[CruiseControl.NET](http://en.wikipedia.org/wiki/CruiseControl) (CC.NET)。我们尝试使用 TFS 中内置的构建系统，但遇到了很多很多问题（我认为主要是因为我们项目的结构方式）。CruiseControl.NET 的安装和配置轻而易举，而且运行起来就像一个冠军。您可以将其设置为持续构建（每次签入触发构建）和每日构建。您可能必须找到一些更巧妙的方法来让 CruiseControl.NET 完成一些更困难的任务（如停止服务等），但它无法完成我需要完成的任何事情。它也非常可扩展，所以你可以编写一些代码来让它做你想做的事情，这是一个很好的特性。

不确定数据库的版本控制，但我假设您可以使用 TFS Source Safe 来实现这一点。  

祝你好运！

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2008-12-02T14:23:52.977

我推荐以下工具（主要是因为我们正在使用它）：

*   视觉工作室 2008

*   SQL Server 2008

*   [视觉SVN](http://www.visualsvn.com/)

*   [CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)

*   [MSBuild 社区任务](http://msbuildtasks.tigris.org/)

我们每个人都在我们的本地机器上工作，并且有一个单独的构建服务器来监控 Subversion 存储库（使用 CruiseControl.NET）并在该服务器上构建最新版本。

我们使用“MSBuild 社区任务”将 Subversion 修订号嵌入到程序集中，以便我们可以将其显示给用户。

目前，我们设置中最大的“漏洞”在数据库和我们的自动化测试中。  

目前我们都运行一个中央数据库服务器。理想情况下，您应该努力拥有一个在源代码控制下重新创建数据库的脚本。据我所知，每次构建服务器重建站点时，它也应该重建数据库。您还应该有一个脚本，它将在数据库中生成您想要的任何测试数据。

通过这样的数据库构建，您也可以在数据库的本地副本上工作。

您可能想看看[Red Gate](http://www.red-gate.com/)软件的 SQL 工具带（或其中的一部分）——我们使用 SQL 比较工具将模式部署到实时服务器，我对它们印象深刻。

祝你好运！

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-01-01T17:38:42.437

[任何完美的 .NET 开发环境都会安装ReSharper](http://en.wikipedia.org/wiki/ReSharper)的副本。我是最近的皈依者，**我喜欢它**。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2008-12-02T14:15:19.313

我会为 Team Foundation Server 投票。然后，您可以将源代码控制、自动构建和（某种）错误跟踪都放在一个包中，它与 VS 2008 完美集成。不过，它的价格相当高。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2008-12-02T16:00:23.593

我更喜欢 Visual Studio 2008 / Subversion / [Trac](http://en.wikipedia.org/wiki/Trac) / Anck and Tortoise / [CruiseControl.NET](http://en.wikipedia.org/wiki/CruiseControl) (TeamCity / [Bitten](http://bitten.edgewall.org/) ) 设置。

我并不是说[TFS](http://en.wikipedia.org/wiki/Team_Foundation_Server)不是一个伟大的产品，但我认为它“笨重”。我最近从 Trac / Subversion 解决方案切换到 TFS，我更喜欢第一个设置。有一些细节，但它们使它很好用。

例子：

*   TFS 为签入和构建发送邮件，在 Trac 中有一个简单的[时间线](http://trac.edgewall.org/timeline)提要。（有TFS的**解决方法。）**

*   当有新的签入时，单击链接（来自提要），您将处于 Trac 环境中。您会看到与前一个 chancgeset 的一个很好的[差异。](http://trac.edgewall.org/changeset/7716)（在 TFS 中的什么位置？）

*   集成的 wiki 是一个非常好的内部文档环境。

*   Tortoise 客户端中的[IntelliSense供您发表评论](http://en.wikipedia.org/wiki/IntelliSense)

*   浏览源代码、更新文档的漂亮网络界面（我在家时很容易）

*   ...

小细节使它成为对我来说更好的工具。

我还说团队很小（也是 5 个开发人员），你需要一些时间来设置。我同意当您与更大的团队合作时，TFS 可能更可取。

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2009-01-01T18:04:20.937

在开发箱上

*   视觉工作室 2008

*   SQL Server 2008

*   红门[SQL 比较](http://en.wikipedia.org/wiki/Red_Gate_Software#Products)

*   Red Gate [ANTS 性能分析器](http://en.wikipedia.org/wiki/Red_Gate_Software#Products)

在服务器上

*   [SourceGear 保险库](http://en.wikipedia.org/wiki/Vault_%28revision_control_system%29)

*   [FogBugz](http://en.wikipedia.org/wiki/FogBugz)（维基、发布、估计、错误跟踪）

*   [CruiseControl.NET](http://en.wikipedia.org/wiki/CruiseControl)

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T14:11:12.707

我对 IDE 和源代码控制的建议：

*   VS2008 带 SP1

*   SubVersion，带有[TortoiseSVN](http://tortoisesvn.tigris.org/)（用于 Windows 资源管理器）和[AnkhSVN](http://ankhsvn.open.collab.net/)（用于 VS2008）

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T15:33:11.807

我最近改用 SourceGear Fortress。它便宜、快速且可靠。

我喜欢大型团队（>20 名开发人员）的 TFS。我刚刚开始接触 Subversion，所以我还没有什么要分享的，只是设置起来很容易。

然而，Trac 很难运行。不过，这是文档问题，而不是产品本身。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2009-01-01T17:28:20.743

我的选择是：

> > 更好的版本控制。

我会选择[SourceGear Vault](http://en.wikipedia.org/wiki/Vault_%28revision_control_system%29) - 坚如磐石，像魅力一样工作，您的源存储在 SQL Server 数据库中 -> 可以轻松备份，并且不像 Visual SourceSafe 那样不稳定。

> > 用于错误跟踪和文档的 Wiki 或其他系统。

根据我的个人经验：[FogBugz](http://en.wikipedia.org/wiki/FogBugz)是您最好的选择 - 简单、容易、快速掌握、很好地完成工作、工作，每个人都只是“得到它”，无需冗长且昂贵的适应/定制，也无需太多培训 - 工作正常：- )

> > 简化的构建过程和日常构建（Visual Build？CruiseControl.NET？）

CruiseControl.NET 是一个很好的免费选择——如果你不介意花一点钱，我也会看看 FinalBuilder——无论是作为桌面应用程序还是服务器应用程序。

> > SQL Server 数据库的版本控制

--> 使用保险柜！以同样的方式工作。使用 Apex SQL Scripter 之类的出色工具或类似工具来创建和维护 SQL 以创建和更新数据库架构，并将这些 SQL 脚本放入 Vault。

> > 升级到 Visual Studio 2005（或 2008）？

在 .NET 3.5 SP1 上使用 Visual Studio 2008 SP1 - 可靠且充满了出色的新生产力功能。

只是我的 0.02 美元

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:06:18.817

我们使用 SourceGear 的 Vault 进行版本控制，它对我们这个小团队来说效果很好。

对于项目/错误/支持跟踪，我们使用 AxoSoft 的 OnTime 2008。

我们还使用ScrewTurn Wiki 来记录程序和示例代码/最佳实践。

对于我们的构建过程，我们还没有完全自动化到日常过程中，因为我们通常不会那样工作。但是，对于 beta 和发布版本，我只是在手动更新版本号后使用 NAnt 为我进行完整的构建（我这样做是为了让我们的支持团队更好看版本号）。

并且绝对使用 Visual Studio 2008。2005 版本在大型 VB 项目中确实存在很多问题（至少对我们而言）。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T14:16:58.043

我同意带有 SP1、SVN 的 VS2008（带有 Ankh 和 Tortoise）

查看[sandcastle](http://blogs.msdn.com/sandcastle/) / [docproject](http://www.codeplex.com/DocProject)以生成文档。

CruiseControl 运行良好。

至于数据库的源代码控制，您可以使用 VS2008 中的数据库项目类型并使用 SVN（或您选择的其他源代码控制解决方案）将其保持在源代码控制之下。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2008-12-02T15:10:55.267

我们将 Subversion 与[Jira](http://www.atlassian.com/software/jira/)一起用于错误跟踪、项目管理、[FishEye 和 Crucible](http://www.atlassian.com/software/crucible/)用于源代码浏览和代码审查，并且效果非常好。

我们是一个由 12 名开发人员组成的团队，分布在各处。[我们是FinalBuilder](http://en.wikipedia.org/wiki/FinalBuilder)的长期用户，我们使用它来进行所有构建和自动化部署 - VB.NET 和 Visual Studio 2008 项目的混合，它对我们来说非常好。我们以 SQL Server 2005/2008 数据库为目标，并将数据库对象保存在源代码控制存储库中。大多数时候，我们将 Visual Studio 2008 数据库版与 Redgate 的工具结合使用，它对我们来说效果很好——尤其是管理更改脚本和其他东西。对我们来说，TFS 根本就行不通——尽管您的里程可能会有所不同。我们发现它太麻烦了，难以自定义工作流程，而且没有帮助工作流程，反而有碍事的坏倾向。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2009-05-19T19:20:30.620

在带有 SP1 的 VS 2008 上非常肯定。我也强烈推荐：

*   [锐化器](http://www.jetbrains.com/resharper/)

*   [SourceGear Vault](http://www.sourcegear.com/vault/)（来自 VSS 的绝对零学习曲线，具有 SVN 的所有优点）

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2009-07-07T17:00:05.827

我听说过很多关于 TFS 的好消息。但是，也有成本因素。您列出的工具可以很好地相互配合并且是免费的。

我要做的一个补充是用于 Subversion 客户端的[TortoiseSVN 。](http://tortoisesvn.tigris.org/)纯粹主义者不喜欢它，但它与 Windows shell 的上下文菜单（右键单击）集成的事实使其非常易于使用。

对于 SVN 版本，请使用最近发布的 1.6 版本。此版本改进了分支和合并。

Trac is a great tool. Make sure to read up on [TracWiki](http://trac.edgewall.org/wiki/TracWiki) and [TracLinks](http://trac.edgewall.org/wiki/TracLinks) formatting rules for your SVN commit messages. Trac parses these messages so if you're commiting a fix for Ticket 123, adding '#123' to the SVN message allows Trac to link that commit (and all files associated with it) to the corresponding Trac tickets. This becomes especially usefull if and when you decide to move to delta releases.

# algorithm - 我在哪里可以学习如何结合算法和数据结构？

> ID：333994
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2008-12-02T13:58:00.907
> 
>         
> 
> 标签：algorithm, data-structures

在阅读了一本关于算法和数据结构的介绍性书籍后，我现在渴望获得有关如何将它们结合起来以实现最佳效率的示例。

例如，您可以将哈希图与特定的排序算法结合起来，创建一个简单的文本搜索程序。

有没有这方面的好书或在线资源？

（我已经订购了[Programming Pearls](http://netlib.bell-labs.com/cm/cs/pearls/)，看起来很棒，但我想了解*更多*。）

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-12-03T13:14:43.053

任何一本好的算法书都会有一两章介绍选择正确数据结构的重要性。我推荐以下书籍：

*   [算法简介](https://rads.stackoverflow.com/amzn/click/com/059651624X)

*   [算法简介](https://rads.stackoverflow.com/amzn/click/com/0262032937)

*   [算法设计手册](https://rads.stackoverflow.com/amzn/click/com/0387948600)

我还建议您查看[Stony Brook Algorithm Repository](http://www.cs.sunysb.edu/~algorith/)，尤其是[讲座](http://www.cs.sunysb.edu/~algorith/video-lectures/)。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-11-26T15:28:31.780

访问这些网站并尝试解决问题：

1.  [acm.uva.es](http://acm.uva.es)

2.  [topcoder.com/tc](http://topcoder.com/tc)

3.  [SPOJ](http://www.spoj.pl/)

4.  [代码厨师](http://www.codechef.com/)

他们至少在接下来的 3-4 年内有一些问题可以让你满意。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T18:37:02.950

好书（对我有用）：

[Java中的数据结构和算法分析（第二版）](https://rads.stackoverflow.com/amzn/click/com/0201357542)

Addison-Wesley 出版，2007 年

国际标准书号：0-321-37013-9

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T14:15:51.463

您基本上是在询问程序员整天都在做什么：通过某些算法使数据流动，以便您及时获得所需的结果。我建议您下载[Python](http://www.python.org/)并完成教程。Python 允许您非常快速地测试您的想法。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-12-04T14:37:12.480

要回答我自己的问题，我似乎只需要阅读大量算法和现实世界的用例。

至于书，我已经订购了

*   [Programming Pearls](http://netlib.bell-labs.com/cm/cs/pearls/)阅读有关如何使用算法组合解决现实世界问题的信息。  

*   [Steven Skiena](http://www.cs.sunysb.edu/~skiena/)[的算法设计手册](https://rads.stackoverflow.com/amzn/click/com/0387948600)，其中包含有关如何解决现实世界问题的算法目录和*战争故事。*

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2011-04-05T09:13:11.613

[http://www.amazon.com/Structure-Interpretation-Computer-Programs-Second/dp/0070004846/ref=sr_1_1?ie=UTF8&qid=1301994609&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0070004846)

我可以热烈推荐这本书。Scheme（一种 Lisp 方言）中的示例相当抽象，但它确实会改变您对程序、数据和算法的看法。

# python - 如何检测 Python 代码正在通过调试器执行？

> ID：333995
> 
>         
> 
> 赞同：34
> 
>         
> 
> 时间：2008-12-02T13:58:30.390
> 
>         
> 
> 标签：python, debugging

是否有一种简单的方法可以在 Python 代码中检测到该代码是否正在通过 Python 调试器执行？

我有一个使用 Java 代码的小型 Python 应用程序（感谢 JPype）。当我调试 Python 部分时，我希望嵌入式 JVM 也可以传递调试选项。

* * *

## 回答 #1

> 赞同：27
> 
>             
> 
> 时间：2008-12-02T14:25:10.087

Python 调试器（以及分析器和覆盖工具）使用该`sys.settrace`函数（在`sys`模块中）来注册一个回调，当有趣的事件发生时调用该回调。

如果您使用的是 Python 2.6，则可以调用`sys.gettrace()`以获取当前跟踪回调函数。如果不是，`None`那么您可以假设您应该将调试参数传递给 JVM。

目前尚不清楚如何在 2.6 之前做到这一点。

* * *

## 回答 #2

> 赞同：16
> 
>             
> 
> 时间：2014-10-28T10:28:09.707

如果您使用的 Pydev 也适用于多线程，其他替代方法是：

```
try:
    import pydevd
    DEBUGGING = True
except ImportError:
    DEBUGGING = False 
```

* * *

## 回答 #3

> 赞同：15
> 
>             
> 
> 时间：2008-12-03T19:13:56.963

使用 Python 2.4（它应该适用于任何高于 2.1 的版本）和 Pydev 的解决方案：

```
import inspect

def isdebugging():
  for frame in inspect.stack():
    if frame[1].endswith("pydevd.py"):
      return True
  return False 
```

通过简单地替换为 pdb 也应`pydevd.py`如此`pdb.py`。正如 do3cc 所建议的，它试图在调用者的堆栈中找到调试器。

有用的链接：

*   [Python 调试器](https://docs.python.org/library/pdb.html)

*   [解释器堆栈](https://docs.python.org/library/inspect.html#the-interpreter-stack)

* * *

## 回答 #4

> 赞同：9
> 
>             
> 
> 时间：2011-11-06T16:30:00.217

另一种方法取决于你的 python 解释器是如何启动的。它要求您使用 -O 来启动 Python 进行生产，并且不使用 -O 来进行调试。因此，它确实需要一个可能难以维护的外部纪律......但它可能再次完美地适合您的流程。

[来自 python 文档（请参阅此处](http://docs.python.org/library/constants.html)或[此处](http://docs.python.org/release/3.1.3/library/constants.html)的“内置常量” ）：

```
__debug__
This constant is true if Python was not started with an -O option. 
```

用法类似于：

```
if __debug__:
    print 'Python started without optimization' 
```

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2011-09-25T16:09:11.717

如果您使用的是 Pydev，您可以通过以下方式检测它：

```
import sys
if 'pydevd' in sys.modules: 
    print "Debugger"
else:
    print "commandline" 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T14:21:17.053

通过快速查看 pdb 文档和源代码，看起来并没有内置的方法可以做到这一点。我建议您设置一个环境变量来指示调试正在进行中，并让您的应用程序对此做出响应。

```
$ USING_PDB=1 pdb yourprog.py 
```

然后在 yourprog.py 中：

```
import os
if os.environ.get('USING_PDB'):
    # debugging actions
    pass 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-12-02T16:36:14.223

您可以尝试查看您的堆栈跟踪。

[https://docs.python.org/library/inspect.html#the-interpreter-stack](https://docs.python.org/library/inspect.html#the-interpreter-stack)

当您在调试器会话中尝试此操作时：

```
import inspect
inspect.getouterframes(inspect.currentframe() 
```

您将获得一个帧记录列表，并且可以查看任何引用 pdb 文件的帧。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2014-03-28T22:18:11.233

我找到了一种更清洁的方法，

只需在您的`manage.py`

```
#!/usr/bin/env python
import os
import sys

if __debug__:
    sys.path.append('/path/to/views.py')

if __name__ == "__main__":
    .... 
```

然后它会在您调试时自动添加它。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2021-10-05T21:04:28.407

由于最初的问题没有特别提到 Python2 - 这是为了确认@babbageclunk 建议的 sys 用法*也*适用于 python3：

```
from sys import gettrace as sys_gettrace

DEBUG = sys_gettrace() is not None
print("debugger? %s" % DEBUG) 
```

# drupal - 在 Drupal 中，如何创建以一组菜单作为内容的首页？

> ID：333997
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-12-02T13:59:00.857
> 
>         
> 
> 标签：drupal, drupal-modules

这个网站[http://nationalstrategies.standards.dcsf.gov.uk/](http://nationalstrategies.standards.dcsf.gov.uk/)似乎正在使用 Drupal，我喜欢首页上的菜单系统，但不知道它是如何完成的。

有没有人知道哪些 Drupal 模块可以重现这种外观和功能？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-12-02T15:35:53.627

这看起来像面板模块
[http://drupal.org/project/panels](http://drupal.org/project/panels)

您可以创建迷你面板并创建包含其他小块内容的多列页面。

编辑：查看他们正在运行drupal的页面的源代码，他们正在使用面板模块（包括/sites/all/modules/panels/js/panels.js）

-埃德

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-12-03T12:44:15.283

我设法使用分类法、视图和面板重新创建了样式。

为特定分类术语创建了一个视图，然后将其变成一个块并显示在面板上。

似乎工作得很好。 
```********