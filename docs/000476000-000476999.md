# StackOverflow 问答 000476000-000476999

# sql - SQL 通过选择加入几个 count(*) 组

> ID：476016
> 
> 赞同：2
> 
> 时间：2009-01-24T13:25:49.973
> 
> 标签：sql

我有下表包含 6/49 彩票的中奖号码。

```
+-----+------------+----+----+----+----+----+----+-------+
|  id | draw       | n1 | n2 | n3 | n4 | n5 | n6 | bonus |
+-----+------------+----+----+----+----+----+----+-------+
|   1 | 1982-06-12 |  3 | 11 | 12 | 14 | 41 | 43 |    13 |
|   2 | 1982-06-19 |  8 | 33 | 36 | 37 | 39 | 41 |     9 |
|   3 | 1982-06-26 |  1 |  6 | 23 | 24 | 27 | 39 |    34 |
|   4 | 1982-07-03 |  3 |  9 | 10 | 13 | 20 | 43 |    34 |
|   5 | 1982-07-10 |  5 | 14 | 21 | 31 | 34 | 47 |    45 |
|   6 | 1982-07-17 |  8 | 20 | 21 | 25 | 31 | 41 |    33 |
|   7 | 1982-07-24 | 18 | 25 | 28 | 33 | 36 | 42 |     7 |
|   8 | 1982-07-31 |  7 | 16 | 17 | 31 | 40 | 48 |    26 |
|   9 | 1982-08-07 |  5 | 10 | 23 | 27 | 37 | 38 |    33 |
|  10 | 1982-08-14 |  4 | 15 | 30 | 37 | 46 | 48 |     3 |
+-----+------------+----+----+----+----+----+----+-------+ 
```

我想创建一个频率图表来查看 n1、n2、...、n6 列中数字的出现。

```
SELECT n1, COUNT(n1) as freq1 FROM lottery GROUP BY n1;
SELECT n2, COUNT(n2) as freq2 FROM lottery GROUP BY n2;
SELECT n3, COUNT(n3) as freq3 FROM lottery GROUP BY n3;
SELECT n4, COUNT(n4) as freq4 FROM lottery GROUP BY n4;
SELECT n5, COUNT(n5) as freq5 FROM lottery GROUP BY n5;
SELECT n6, COUNT(n6) as freq6 FROM lottery GROUP BY n6; 
```

基本上我试图将上述查询组合成一个查询。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T13:37:41.727

鉴于您的表布局，除了合并查询或将基表合并为转置版本之外，您无法通过任何其他方式将查询组合成一个查询：

```
SELECT n, COUNT(*) as freq FROM 
(
  SELECT n1 AS n FROM lottery
  UNION ALL
  SELECT n2 FROM lottery
  UNION ALL
  SELECT n3 FROM lottery
  UNION ALL
  SELECT n4 FROM lottery
  UNION ALL
  SELECT n5 FROM lottery
  UNION ALL
  SELECT n6 FROM lottery
) as transposed
GROUP BY n
ORDER BY COUNT(*) DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T13:56:58.490

我会做一些非常相似的事情，但尽量减少子查询返回的记录数......

```
SELECT
    n                     AS [n],
    SUM([data].count_n)   AS [count_n]
FROM
    (
        SELECT n1 AS [n], COUNT(*) AS [count_n] FROM lottery GROUP BY n1
        UNION ALL
        SELECT n2 AS [n], COUNT(*) AS [count_n] FROM lottery GROUP BY n2
        UNION ALL
        SELECT n3 AS [n], COUNT(*) AS [count_n] FROM lottery GROUP BY n3
        UNION ALL
        SELECT n4 AS [n], COUNT(*) AS [count_n] FROM lottery GROUP BY n4
        UNION ALL
        SELECT n5 AS [n], COUNT(*) AS [count_n] FROM lottery GROUP BY n5
        UNION ALL
        SELECT n6 AS [n], COUNT(*) AS [count_n] FROM lottery GROUP BY n6
    )
    as [data]
GROUP BY
    [data].n
ORDER BY
    SUM([data].count_n) DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T13:30:26.000

建立工会：从彩票联盟中选择 n1 从彩票中选择 n2 ....然后进行汇总！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T13:45:58.247

tomalak，我认为您的版本不会返回正确的结果集。编辑：你改变了它，现在它是正确的。:)

```
SELECT COUNT(*), n1 FROM
(
SELECT n1 FROM tbl1
UNION ALL SELECT n2 FROM tbl1
UNION ALL SELECT n3 FROM tbl1
) AS nicetbl
GROUP BY n1 
```

# python - A QuerySet 按聚合字段值

> ID：476017
> 
> 赞同：28
> 
> 时间：2009-01-24T13:26:58.893
> 
> 标签：python, django, database

假设我有以下模型：

```
class Contest:
    title = models.CharField( max_length = 200 )
    description = models.TextField()

class Image:
    title = models.CharField( max_length = 200 )
    description = models.TextField()
    contest = models.ForeignKey( Contest )
    user = models.ForeignKey( User )

    def score( self ):
        return self.vote_set.all().aggregate( models.Sum( 'value' ) )[ 'value__sum' ]

class Vote:
    value = models.SmallIntegerField()
    user = models.ForeignKey( User )
    image = models.ForeignKey( Image ) 
```

站点的用户可以将他们的图像贡献给多个竞赛。然后其他用户可以投票赞成或反对他们。

一切正常，但现在我想显示一个页面，用户可以在该页面上查看对某个竞赛的所有贡献。图像应按其得分排序。因此，我尝试了以下方法：

```
Contest.objects.get( pk = id ).image_set.order_by( 'score' ) 
```

正如我担心的那样，它不起作用，因为`'score'`没有可用于查询的数据库字段。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-24T13:44:37.517

哦，我当然忘记了 Django 中的新聚合支持及其`annotate`功能。

因此查询可能如下所示：

```
Contest.objects.get(pk=id).image_set.annotate(score=Sum('vote__value')).order_by( 'score' ) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-24T13:34:36.600

您可以非常简单地用 Python 编写自己的排序。

```
def getScore( anObject ):
    return anObject.score()
objects= list(Contest.objects.get( pk = id ).image_set)
objects.sort( key=getScore ) 
```

这很好用，因为我们对列表进行了排序，我们将提供给模板。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T13:36:40.060

db 级别`order_by`无法通过模型的 python 方法对查询集进行排序。

解决方案是将`score`字段引入`Image`模型并在每次`Vote`更新时重新计算它。某种非规范化。什么时候可以按它排序。

# c# - WPF 数据绑定：数据库还是对象？

> ID：476020
> 
> 赞同：1
> 
> 时间：2009-01-24T13:30:47.000
> 
> 标签：c#, wpf, database, data-binding, object

我正在尝试创建这个：

Tag1 具有对象的有序列表：O1、O3、O2。Tag2 具有对象的有序列表：O1、O4。

每次单击标签时，我都想查看对象列表。因此，单击 Tag1 将显示在列表框中：

*   O1
*   O3
*   氧气

但是我想**保持自动更新，所以每次我编辑或添加/删除**它自动更新的对象时（我想我需要实现类似接口`INotifyCollectionChanged`和`INotifyPropertyChanged`？）。

我可以使用数据库并拥有表 Tag、Object 和 TagObject，最后一个带有 TagID 和 ObjectID。但我也想避免使用数据库，因为它是一个桌面应用程序。

我也可以使用类似的对象`ObservableCollections`，但我有重复对象的问题。我可以使用对对象的引用，但它会变得混乱。

有人对如何做到这一点有任何建议吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T16:49:02.340

一种选择是创建一个包含数据集（System.Data 命名空间）的对象。在数据集中，它将有 3 个表，这些表将使用定义的外键链接，就像它在数据库中一样。如果需要，这些可以稍后存储到 XML。

然后，您的对象必须公开一个数据视图，该数据视图也可以设置为数据上下文并绑定。

在代码中编辑数据集然后更新屏幕，编辑屏幕将更新数据集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T17:54:33.067

将控制更新数据的所有逻辑移出 WPF 页面并移到另一个类中，该类在新数据发生更改时将新数据*推*送到 WPF 页面中，而不是 WPF将数据从对象中*拉出。*

这是一些示例代码：

```
class WpfPage
{
   public List OrderedListForTag1 { set { /* whatever GUI binding code you need to deal with the new list for tag 1 */ }

   public List OrderedListForTag2 { set { /* whatever GUI binding code you need to deal with the new list for tag 2*/ }

}

class WpfPresenter
{
  WpfPage thePage;

  public void Tag1Selected()
  {
      //Calculate changes to 01, 02, 04 etcetce
      //If changed, update the page
      thePage.OrderedListForTag1 = //new list of objects
  }
} 
```

这是在 GUI 构建中非常常见的模型-视图-控制器模式之一。本[系列文章](http://codebetter.com/blogs/jeremy.miller/archive/2007/05/23/build-your-own-cab-part-2-the-humble-dialog-box.aspx)涵盖了这些概念。

# c# - 您应该使用类内的访问器属性，还是只使用类外的访问器属性？

> ID：476021
> 
> 赞同：9
> 
> 时间：2009-01-24T13:32:29.587
> 
> 标签：c#, .net

我有一个使用 getter 访问某个数组的类“数据”。如果数组为空，那么我希望Data访问文件，填充数组，然后返回具体值。

现在这是我的问题：

在创建 getter 和 setter 时，您是否还应该使用与访问该数组的方式相同的访问器属性（在这种情况下）？还是应该直接访问数组？

我在类中使用访问器时遇到的问题是，当调用类在 Data.array 中查找一些信息时，我得到了无限循环，getter 找到了数组 null，所以从文件中获取它，并且该函数结束从 Data 中再次调用 getter，array 再次为 null，我们陷入了无限循环。

编辑：

那么官方对此没有表态吗？我看到了不使用带有文件访问权限的访问器的智慧，但是你们中的一些人说总是在类中使用访问器，而另一些人说永远不要使用类中的访问器...... ...................................................

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T14:13:20.453

我同意 krosenvold 的观点，并想概括一下他的建议：

不要将属性 getter 和 setter 用于昂贵的操作，例如读取文件或访问网络。对昂贵的操作使用显式函数调用。

通常，该类的用户不会期望简单的属性检索或分配可能会花费大量时间。

[Microsoft 的框架设计指南中也建议这样做。](http://msdn.microsoft.com/en-us/library/ms229054.aspx);

> **在以下情况下，请务必使用方法，而不是属性**。
> 
> 该操作比字段集慢几个数量级。如果您甚至考虑提供操作的异步版本以避免阻塞线程，那么该操作很可能过于昂贵而不能成为属性。特别是，访问网络或文件系统的操作（除了一次初始化之外）应该很可能是方法，而不是属性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-24T13:36:57.657

我认为始终使用访问器是个好主意。然后，如果您在获取或设置属性时需要任何特殊逻辑，您就知道一切都在执行该逻辑。

您可以为这些属性之一发布 getter 和 setter 吗？也许我们可以帮助调试它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-24T13:59:17.207

我写了一个打开文件的getter，后来总是后悔。现在，我永远不会通过 getter 期间的懒惰构造来解决这个问题。有一个带有副作用的 getter 问题，人们不期望在 getter 后面会发生各种疯狂的活动。此外，您可能必须确保线程安全，这会进一步污染此代码。每次执行此操作时，单元测试也会变得稍微困难​​一些。

显式构造是比各种惰性初始化 getter 更好的解决方案。这可能是因为我使用的 DI 框架将所有这些作为标准使用模式的一部分提供给我。我真的尝试尽可能清楚地处理构造逻辑而不是隐藏太多，它使代码更容易理解。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-24T13:50:40.593

不，我不相信你应该这样做，原因是：可维护的代码。

我见过人们在定义类中使用属​​性，起初看起来不错。然后其他人出现并为属性添加功能，然后其他人出现并尝试更改类，他们不完全理解类并且所有地狱都崩溃了。

这不应该是因为维护团队*应该*完全理解他们试图改变什么，但他们经常看到不同的问题或错误，而封装的属性经常会逃避他们。我已经看到了很多，所以从不在内部使用属性。

他们也可能是性能猪，如果有人将数据库代码放在属性中，那么应该是一个简单的查找可能会变得令人讨厌 - 我也看到人们这样做！

这么多年过去了，KISS 原则仍然有效……！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-24T14:24:10.870

除了其他人提出的观点之外，是否直接使用访问器或字段可能需要通过语义来告知。有时，外部消费者访问属性的语义不同于通过内部代码访问其值的机械必要性。

Eric Lippert 最近在几篇文章中就这个主题发表了博客：-

[自动与显式属性](http://blogs.msdn.com/ericlippert/archive/2009/01/14/automatic-vs-explicit-properties.aspx)
[面向未来的设计](http://blogs.msdn.com/ericlippert/archive/2009/01/16/future-proofing-a-design.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-24T13:39:04.580

如果使用 Get 方法导致此类错误，则应直接访问该值。否则，最好使用访问器。如果您应该修改 getter 或 setter 以在将来执行特定操作，如果您未能使用该路径，您将破坏您的对象。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-24T13:41:43.437

您应该始终使用访问器，但是从文件中读取值的函数（应该是私有的，并且称为*getValueFromFile*之类的东西）应该只在必须从文件中读取值时调用，并且应该只读取文件并返回值。该函数在另一个类中可能会更好，专门用于从数据文件中读取值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-24T13:43:49.297

我猜您要实现的是某种延迟加载属性，仅在第一次访问数据时才加载数据。

在这种情况下，我将使用以下方法来防止无限循环：

```
private MyData _data = null;

public MyData Data
{
  get
  {
    if (_data == null)
      _data = LoadDataFromFile();
    return _data;
  }
}

private MyData LoadDataFromFile()
{
  // ...
} 
```

换句话说：

*   不要实现setter
*   始终使用属性访问数据（切勿直接使用字段）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-24T14:12:36.383

如果我理解正确，则您正在尝试从其实现中访问属性（通过使用在属性的实现代码中调用相同属性的方法）。我不确定是否有任何官方标准，但我认为这是一种不好的做法，除非有特定的需要这样做。

我总是更喜欢在类中使用私有成员而不是属性，除非我需要属性实现提供的功能。

# c# - C# - 关于类和内存

> ID：476039
> 
> 赞同：2
> 
> 时间：2009-01-24T13:50:57.443
> 
> 标签：c#, class

我对 C# 还很陌生，但我会**尽量**做到这一点！;)

这只是一个理论上的情况，但想象一下：

**I）**一个有一个类'ClassA'，里面有一个'ClassB'，'ClassB'里面有一个'ClassC'。

**II)** ClassA 有一个被调用的方法。该方法本身是（不知道这个名称）用已经存在的 classB 变量“构造”一个​​新的 ClassB。如下：

```
/*CLASS A*/
ClassA
{
    ClassB classB;

    ClassA()
    {
          classB = new ClassB();
    }

    MethodA()
    {
      classB = new ClassB();
    }
    // Other Methods...

}

/*CLASS B*/
ClassB
{
    ClassC classC;

    ClassB()
    {
        classC = new ClassC();
    }

    // Methods...

}

/*CLASS C*/
ClassC
{
  // Loads of variables being used...
} 
```

所以我想知道的是：

**a)**对于 B 类，在记忆方面会发生什么？堆中的相同空间会用于类还是会分配新空间？如果是后者，那么之前的内存会被 GC 以某种方式释放吗？

**b)**不管上面的结果是什么，装载了变量咀嚼内存的classC会发生什么？

直接回答或只是简单的阅读链接将不胜感激。我试图为自己找到答案，但似乎没有人解释这种荒谬（？）的情况。

在你开始理论化这个问题的起源之前，我已经告诉你了。我确实让自己处于类似的情况，这就是：

*   初级班
    *   子类1
        *   几节课
    *   子类2
        *   几节课

所以这个三级应用程序有时会在控制“场景”的 Sub-Class1 和 2 之间切换。这些“场景”有一些类来帮助管理东西（通常）。这是（根据我的想法）无法确定的。

问题是 Sub-Class1 和 Sub-Class 2 都会占用一些内存并使用一些“资产”。因此，我想抹去，是的，你听到了我的声音，抹去它们的存在，然后再重新创造它们。我做了一些阅读，但无法提出解决方案。（如前所述，我是 C# 和整个托管 .net 的新手）。在这方面的任何建议当然将不胜感激。

好吧，我写的比计划的多一点，但就是这样！期待对此有所了解！:)

问候，罗伯特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-24T13:58:57.317

我稍微重写一下：

```
ClassA()
{
  memberB = new ClassB();
}

MethodA()
{
  memberB = new ClassB();
} 
```

在这种情况下，`memberB`保存对 的实例的引用`classB`。

在 的构造函数中`classA`，创建了 的新实例`classB`（调用它`instance 1`）并将对该实例的引用分配给`memberB`。

当您调用 时`methodA`，会创建另一个实例`classB`，并将其引用分配给`memberB`。`memberB`现在指向`instance 2`. `instance 1`不再在代码中引用，GC 会在它被调用时立即清理它。

> 因此，我想抹去，是的，你听到了我的声音，抹去它们的存在，然后再重新创造它们。

C# 的重点是你不会弄乱内存。当然，您可以`GC.Collect()`随时调用，但不能保证释放所有未引用的实例（尽管确实如此，如实践所示）。

如果您想对资源进行精细控制，请使用 C++/CLI 实现对资源要求较高的类，从 继承它们，并在指令`IDisposable`范围内调用它们。`using`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T14:01:48.573

这是初始设置：

```
Instance of ClassA (original)
  Field refers to an instance of ClassB (original)
    Field refers to an instance of ClassC (original) 
```

MethodA 在 ClassA 的原始实例上被调用。这是之后的图片

```
Instance of ClassA (original)
  Field refers to an instance of ClassB (new)
    Field refers to an instance of ClassC (new)

Instance of ClassB (original) - no references can reach
  refers to an instance of ClassC (original) 
```

由于您的程序中没有任何引用可以到达原始 ClassB 和原始 ClassC，因此垃圾收集器可以自由地收集它。

# c# - 如何使用 C# 在窗口应用程序中创建工具栏

> ID：476042
> 
> 赞同：0
> 
> 时间：2009-01-24T13:51:25.040
> 
> 标签：c#, windows, vb.net, toolbar, thick-client

我想使用 dotnet 中的窗口应用程序创建工具栏。它将使用 yahoo、gmail API。请任何人有任何解决方案请发给我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T13:57:36.790

将“ToolStrip”控件从工具箱拖到您的窗体上。

这是一些文档：[ToolStrip 技术摘要](http://msdn.microsoft.com/en-us/library/a5swc13h.aspx)。

# c# - 有没有办法从 C# 应用程序调用非托管（非 COM）dll？

> ID：476043
> 
> 赞同：0
> 
> 时间：2009-01-24T13:51:25.973
> 
> 标签：c#, c++, interop, unmanaged, marshalling

有没有办法在我的 C# 应用程序中使用（引用）用非托管 C++（不是 COM 库）编写的 DLL？

当我尝试从 Visual Studio 中引用它时，我收到“不是 COM 对象”错误消息。

也许有某种翻译器\路由器可以 COMify 我的 DLL 参考？我不知道 COM 和 COM 互操作是如何工作的，因为我在这对我来说已经没有必要的时候就开始编程了。

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-24T13:56:25.810

您需要使用 DllImport 属性。这是 Win32 PostMessage 函数的示例：

```
[DllImport("user32.dll", SetLastError = true)]
[return: MarshalAs(UnmanagedType.Bool)]
internal static extern bool PostMessage(IntPtr handle, int message, IntPtr wparam, IntPtr lparam); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-24T13:54:02.553

请参阅 MSDN 上的“使用**非托管 DLL 函数**”主题：

[http://msdn.microsoft.com/en-us/library/26thfadc.aspx](http://msdn.microsoft.com/en-us/library/26thfadc.aspx)

无需添加任何 COM 代理，.NET 可以使用**[DllImport]**属性直接使用 DLL。通过指定附加属性，您还可以完全控制 .NET 和非托管 DLL 之间的编组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T12:05:04.113

Joe 已经回答了这个问题，所以我要继续解决这个问题 - 为了节省自己一些时间，而不必挖掘和破坏函数签名，P/Invoke 有一个非常完整的 Win32 签名库，以 wiki 的形式还有一个 Visual Studio 插件！

[在P/Invoke](http://www.pinvoke.net/)上查看

# c# - 使用嵌套母版页

> ID：476049
> 
> 赞同：2
> 
> 时间：2009-01-24T13:56:41.283
> 
> 标签：c#, asp.net, inheritance, master-pages, nested

我对 ASP.NET 很陌生，请帮助我更多地了解 MasterPages 的概念。

我有 Site.master，其中包含常见的标题数据（css、meta 等）、中心表单（空白）和页脚（版权信息、联系我们链接等）。

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="Site.master.cs" Inherits="_SiteMaster" %>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="tagHead" runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body>
    <form id="frmMaster" runat="server">
    <div>
        <asp:ContentPlaceHolder ID="holderForm" runat="server"></asp:ContentPlaceHolder>
        <asp:ContentPlaceHolder ID="holderFooter" runat="server">Some footer here</asp:ContentPlaceHolder>
    </div>
    </form>
</body>
</html> 
```

并且我想将项目的第二个母版页使用到子目录中，该子目录将包含 Page_Load 上的 SQL 查询以进行日志记录（整个站点不需要）。

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="Project.master.cs" Inherits="_ProjectMaster" MasterPageFile="~/Site.master" %>
<asp:Content ContentPlaceHolderID="holderForm" runat="server">
    <asp:ContentPlaceHolder ID="holderForm" runat="server" EnableViewState="true"></asp:ContentPlaceHolder>
</asp:Content>
<asp:Content ContentPlaceHolderID="holderFooter" runat="server">
    <asp:ContentPlaceHolder ID="holderFooter" runat="server" EnableViewState="true"></asp:ContentPlaceHolder>
</asp:Content> 
```

但我有一个问题：页脚不显示。

**我的错误在哪里？我是否可以使用第二个母版页作为超级类进行日志记录？**

项目页面如下所示：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" MasterPageFile="~/Project.master" %>
<asp:Content ContentPlaceHolderID="holderForm" runat="server">
    <p>Hello World!</p>
</asp:Content>
<asp:Content ContentPlaceHolderID="holderFooter" runat="Server">
    Some footer content
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-27T09:43:02.720

我一直在使用嵌套母版页，并且遇到过类似的情况。从我看到的情况来看，您在 Site.Master 中的“此处有一些页脚”是问题所在，我在 contentplaceholder 标记中包含内容时遇到了类似的问题。如果你试试这个

```
<asp:ContentPlaceHolder ID="holderFooter" runat="server"/>Some footer here 
```

然后您应该能够看到页脚内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T10:03:04.037

我不确定我会为此使用母版页。如果真的只是做日志，我会实现 IHttpModule，在 web.config 中注册，然后根据请求的路径检查是否日志。我认为母版页是关于*内容*的，而不是其他处理，例如日志记录。

有关示例，请参阅 MSDN 上的[IHttpModule 演练](http://msdn.microsoft.com/en-us/library/ms227673.aspx)- 在您的 BeginRequest 处理程序中，您可能会检查请求路径并在匹配时正确记录。

如果我误解了你想要做的事情，我深表歉意。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T09:47:37.890

您应该将 ContentPlaceHolder 留空，因为它会被您实际页面中的内容内容所取代...

当您将“此处的某些页脚”文本移动到您的内容时，您将看到您的文本行 :)

高温高压

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-27T10:00:20.533

此链接对母版页进行了简单说明， [http://waxtadpole.wordpress.com/2009/01/16/master-page-content-not-visible-visual-studio-2008/](http://waxtadpole.wordpress.com/2009/01/16/master-page-content-not-visible-visual-studio-2008/)

问题是您在这种情况下使用子母版页是否正确 - 我想说母版页应该帮助您解决围绕构建一致布局的问题，而不是是否应该发生日志记录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T09:57:02.850

问题是，当放置在 Default.aspx 中的文本元素放在它们的相关内容占位符中时，它们会写在 Site.master 页面的占位符上，而不是 Project.master 的占位符上（它们具有相同的名称）。

您应该通过将不同的 ContentPlaceHolderID 分配给 Project.master 中的占位符来解决命名冲突（这意味着您还必须更改 Default.aspx 中的引用）。

这将是您的 Project.master 文件：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="Project.master.cs" Inherits="_ProjectMaster" MasterPageFile="~/Site.master" %>
<asp:Content ContentPlaceHolderID="holderForm" runat="server">
    <!-- whatever... -->
    <asp:ContentPlaceHolder ID="holderFormInternal" runat="server" EnableViewState="true"></asp:ContentPlaceHolder>
    <!-- ... -->
</asp:Content>
<asp:Content ContentPlaceHolderID="holderFooter" runat="server">
    <asp:ContentPlaceHolder ID="holderFooterInternal" runat="server" EnableViewState="true"></asp:ContentPlaceHolder>
</asp:Content> 
```

因此，使用项目母版页而不是全局 Page.master 的 .aspx 页面必须更改为：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" MasterPageFile="~/Project.master" %>
<asp:Content ContentPlaceHolderID="holderFormInternal" runat="server">
    <p>Hello World!</p>
</asp:Content>
<asp:Content ContentPlaceHolderID="holderFooterInternal" runat="Server">
</asp:Content> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-27T10:21:22.580

如果唯一的原因是实现登录，你为什么要搞乱母版页？如果日志记录不应该显示任何文本！？

您要么按照 Skeet 建议的 IHTTP 处理程序进行操作。或者更懒惰的做法是拥有一个派生自网页的类并在该类中实现日志记录，并使您的页面需要从该类进行日志记录服务..

前任：

```
public class LoggingPage : : System.Web.UI.Page
{
  public override void OnLoad()
{
// Do logging
}
}

partial class OneOfTheWebPages : LoggingPage
{
 public void onLoad()
{
base.onLoad();
}
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-24T14:06:06.897

我可能误解了您的问题 - 但从您发布的代码来看，页脚中没有任何*内容*。

在您的项目页面中，内容占位符的`<asp:Content>`标签`holderFooter`中没有任何内容。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-24T23:33:05.193

我有下一个继承树：

```
Site.master <-- Page1.aspx
<-- Project.master <-- Page2.aspx 
```

而且我不知道为什么 Page2 只显示自己的内容，它是母版页 - 项目。但是不显示 Site 的内容（如 Page1 那样） 为什么？我有什么要写的呢？

# c# - 你对如何停止asp.NET网站中相同IP的命中计数器有什么建议？

> ID：476060
> 
> 赞同：0
> 
> 时间：2009-01-24T14:04:38.070
> 
> 标签：c#, asp.net

正如您在问题上看到的那样，您对停止 ASP.NET 网站中相同 IP 的命中计数器有什么建议？

在我的房地产项目中，我会在查看房产时增加其查看次数。但我只想在用户有不同 ip 的情况下增加它。如果用户刷新页面，则不应增加命中计数器。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-24T15:29:03.017

如果它是一个网站，您可以通过删除包含日期和时间的 cookie 来更准确地计算唯一访问者。检查 cookie，如果它存在并且日期是今天，请不要在计数器中添加一个。

# .net - ASP.NET MVC - 以编程方式添加动作过滤器

> ID：476062
> 
> 赞同：5
> 
> 时间：2009-01-24T14:05:43.420
> 
> 标签：.net, asp.net-mvc

我一直在对动作过滤器进行一些研究，并想知道是否有办法以编程方式将它们添加到控制器中？

为了提供一些上下文，如果在 web.config 中配置了日志记录，我想添加一个日志记录过滤器，否则我不希望该过滤器存在于每个操作方法的执行链中。

我很感激我可以检查实际的过滤器代码本身，看看是否启用了日志记录，但不想这样做是可能的。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T15:17:56.923

```
 [LogRequest]
    [PermissionRequired(Permits.View_users, Permits.Edit_users)]
    public ActionResult Edit(int id, .....)
            {
             ...
            }

    public class PermissionRequired : ActionFilterAttribute, IActionFilter
{
    private readonly PermissionsList permits;

    public PermissionRequired(params Permits[] perm)
    {
        permits = new PermissionsList(perm);
    }

    #region IActionFilter Members

    void IActionFilter.OnActionExecuting(ActionExecutingContext filterContext)
    {
        ...
        IEnumerable<int> intersection = (from up in User.CurrentUser.UserPermission
                                         select up.PermissionID).ToList().Intersect(permits.Cast<int>());
        if (intersection.Count() != permits.Count)
        {
            filterContext.Result = null;
            HttpContext.Current.Response.Redirect("/Error/PermissionsRequired.htm");
        }
    }

    #endregion
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T17:38:38.887

更好的解决方案是使用*[空对象模式](http://en.wikipedia.org/wiki/Null_Object_pattern)*。

您的过滤器将正常记录（它的工作是记录，而不是决定如何记录或记录到什么，必然），但默认情况下，实际的记录器将是一个什么都不做的实现。如果已配置，则记录器实例将是按配置记录的实现。

一个简单的工厂可以决定将哪个记录器实现交付给过滤器，或者可以配置任何 IOC 容器来处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T14:31:03.727

我从来没有以编程方式向方法添加属性，因为它看起来像是一个低效的噩梦，我总是找到一个更好的选择。

您需要在某个地方进行检查，虽然我同意属性代码可能不是最适合它的地方，但它并不是特别糟糕。如果您真的不想这样做，那么您可以抽象出日志记录代码，以便它只使用已启用的条目类型，那么您要围绕它放置多少架构取决于您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T15:53:44.480

您可以查看创建自己的 ActionInvoker 实现，这是处理调用过滤器和操作方法的类。话虽如此，我认为这不是一个好的解决方案。它违反了关注点分离。最好让您的日志记录操作过滤器确定是否应该发生日志记录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T12:19:27.070

我一直在查看新的 Oxite 代码（由于大量批评，上一个版本进行了重大重构）并且他们做了一些有趣的事情。他们创建自己的 ActionFilterRepository 来保存不同的过滤器（IActionFilters、IAuthorizationFilters 等）。在自定义 ControllerActionInvoker 中，GetFilters 方法被覆盖，并将过滤器从存储库添加到当前集合。通过这种方式，他们将一组全局过滤器应用于每个动作和控制器。

您可以在此处查看自定义调用程序代码： [OxiteControllerActionInvoker.cs](http://www.codeplex.com/oxite/SourceControl/changeset/view/29318#386343)

还有一个示例过滤器： [LocalizationActionFilter.cs](http://www.codeplex.com/oxite/SourceControl/changeset/view/29318#420627)

希望这可以帮助。

# database-design - 什么是最好的：单独的数据库或额外的“代码”表？

> ID：476065
> 
> 赞同：3
> 
> 时间：2009-01-24T14:08:54.067
> 
> 标签：database-design

我有一个数据库，旨在保存来自各种交易卡牌游戏的卡牌数据。到目前为止，我只跟踪了一款纸牌游戏，但我使用的是属性表，因为并非所有属性都适用于每张纸牌。

我现在正在扩展到多个纸牌游戏，并准备好迁移大量数据。但是，我不太确定如何导入这些数据。我是否应该简单地将模式克隆到每个纸牌游戏的新数据库中，所以我可以在不同的桶中管理东西？或者我应该简单地添加一个名为“CardGame”的新表，并使用它的唯一标识符作为卡的外键，并为它拥有一个庞大的数据库。

如果它对情况有任何影响，这个主数据库将发布到一个网站供用户查询，一个以及分解成更小的数据模块（每个游戏）供人们使用的 WinForms 应用程序。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-24T14:17:30.167

在这些情况下，我的一般偏好是使用一个数据库，原因如下：

*   综合报告变得更加容易
*   与代码一样，DRY 适用 - 如果您有多个“克隆”模式，当您需要进行“核心”更改时会发生什么？
*   简化维护

但最终决定取决于您的具体要求......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-24T14:29:19.440

我会使用一个数据库：

*   不幸的是，克隆的数据库文件就是这样 - 没有继承树，您可以轻松地创建和保留基本模式。如果您必须重构或更改架构，您将陷入困境，试图让您的所有克隆都匹配。

*   如果一切都在一个地方，则更容易维护和移动。

*   您可以使用视图来整理每个游戏的相关部分，以及每种卡片类型。在精心设计的数据库中，必要时信息会分开显示，但会无缝连接在一起。

*   作为奖励，您可以开始收集有关不同游戏之间相关性的数据......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T14:31:00.857

我认为这真的取决于来自不同纸牌游戏的数据是否会被单个应用程序使用。

我有一个应用程序，它处理来自不止一个游戏的数据而不是一个数据库是有意义的。

另一方面，如果逻辑上每个纸牌游戏都有一个应用程序实例，那么每个纸牌游戏都有单独的数据库更有意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T14:27:53.297

我倾向于将每个都放在一个单独的数据库中。起初在表上放置辅助键似乎很容易，但确实会导致令人头疼的问题。这可能尤其如此，因为您已经创建了数据库，认为其中只有一种类型的游戏。在您的所有查询中记住您几乎在任何地方都必须引用第二个键来显示应该访问/修改哪个游戏，这是一个经常令人头疼的问题。这可能是一场真正的噩梦。有一个 SO 播客，其中 Spolsky 谈到了为什么 FogBugs 为每个客户都有一个单独的数据库。（我现在找不到它，但我认为它是 20 年代中后期）。

修改所有它们的模式将是一些额外的工作，但使用工具（如来自 RedGate 的工具），这更易于维护。

如果您认为您可能必须从站点中删除游戏，那么在这种情况下，单独的数据库也将是一个更易于管理的负载。您只需删除与该特定实例相关的数据库，而不是从一个大数据中删除所有数据。

报告所有数据也需要更多的工作，因为它们都在单独的数据库中。我会将所有数据库中的所有数据汇总到一个严格用于报告的报告数据库中。再做一点额外的工作，但不是太难。

编辑：分离数据库是关于数据完整性。每个人都在谈论维护模式和更新存储过程是多么困难。我有一些花费大约 200 美元的程序可以为我做到这一点。没有大碍。

我将通过将所有数据库放在一起来解释什么是困难的和我害怕的。

1.  如果您的一款游戏需要更改会破坏所有其他游戏的架构，会发生什么？（或者更糟的是，你不知道真正会发生什么）。就像更改数字的大小，或扩展字符串的大小，或向存储过程添加参数一样。你几乎完全搞砸了。您将花费数小时和数小时的额外工作来试图弄清楚一项更改将如何影响涉及它的所有其他应用程序。这就像触摸蜘蛛网。没有，“我们会为这场比赛改变它。”

2.  当有人因为错误而运行更新过程来修复数据并忘记包含适当的标识符并且您更新表中的所有数据时会发生什么？你打倒一切。

我知道你在说什么，“我们会小心的。” 这就是说，“我们不需要测试人员，因为我们为什么要编写有缺陷的代码？” 五分钟的额外工作来接收模式，或者程序员额外的几个小时来审查多个应用程序中的代码（当有人更改他们的应用程序所涉及的数据库时，他们应该这样做）与走进去相比是个笑话你老板的办公室，并解释为什么你会在接下来的 10 个小时里在那里解决问题，因为有人并不完全在他们的游戏中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T14:51:07.167

DRY 原则。不要重复自己。我相信尽可能严格地遵循 DRY 原则。将所有内容保存在一个大数据库中。如果你只是克隆 db，维护将是一场噩梦，重构将是地狱，任何未来从事该项目的程序员都会傻眼，他们可能会比 Wily Coyote 的 Road Runner 运行得更快！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T15:08:21.577

首先选择一个数据库有更大的灵活性也许一些交易卡游戏来自同一家公司为什么不选择以这种方式拆分数据库（这不是建议）如果你这样做你不能再次拆分它们这是一个非常组织数据的不灵活方式似乎与关系数据库的思维方式不太兼容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-24T15:44:58.820

我认为尽早进行多租户是个好主意。

如果您现在使数据库成为多租户，您仍然可以稍后将它们放在单独的数据库中，如果您想要进行相对较小的更改 - 另一个方向并不那么容易。在多租户场景中，您必须假设系统将经过精心设计，这样您就不会将信息泄露给其他租户。有许多方法可以在视图或 SP 级别强制执行此操作，以确保编码错误可以被最小化和减轻。

您还可以将游戏分发到数据库中。造成这种隔离的原因有很多。它可能不适用于您，但对于非常大的数据库，从维护窗口的角度来看，拥有多个多租户数据库有时是有意义的。例如，按国家或按时区。

在 SQL Server 中，由于 ACID 完整性和备份的外部单元是数据库，拥有非常大的多租户数据库可能难以满足较小的维护窗口。

# c# - How well does F# perform compared to C#?

> ID：476070
> 
> 赞同：4
> 
> 时间：2009-01-24T14:12:41.580
> 
> 标签：c#, performance, f#

Of course both F# and C# compile to IL and the CLR JITter does most of the hard work, however I wanted to know whether there's anything implicit in the F# language or its core libraries which result in lesser performance compared to C#?

Additionally, is there anything in the use of functional programming in the .net framework that might make it slower compared to C#?

I am going to sit down and *measure* differences of course, as that really is the only real way to know for sure, however I just wondered whether anybody had any broad-stroke knowledge on this topic.

# See Also

*   [C# / F# Performance comparison](https://stackoverflow.com/questions/144227/c-f-performance-comparison)
*   [Is a program F# any more efficient (execution-wise) than C#?](https://stackoverflow.com/questions/142985/is-a-program-f-any-more-efficient-execution-wise-than-c)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T14:30:24.663

There is nothing intrinsic that makes one language faster than the other. They both run on the CLR and hence have roughly the same performance characteristics of any language that runs on the CLR. There are features of the respective languages though that do affect performance.

Tail recursion is a great example. If you write an F# app which heavily uses tail recursion, the compiler will attempt to rewrite it as an iterative loop removing the recursion penalty. Additionally F# uses the .tail IL op code in order to ask the CLR to remove the recursion stack penalty where possible.

It's easy to demonstrate this by translating some F# continuation samples to C# and then insert huge data sets. F# will work and C# will eventually crash.

[http://blogs.msdn.com/jaredpar/archive/2008/11/13/comparing-continuations-in-c-and-f-part-3-double-wrong.aspx](http://blogs.msdn.com/jaredpar/archive/2008/11/13/comparing-continuations-in-c-and-f-part-3-double-wrong.aspx)

But that is not necessarily a deficiency in C#. C# is not meant to be written with continuations while that is certainly the case in F#. It's in fact not surprising that writing algorithms meant for F# in C# produce not so great results.

Conversely, C# iterators are usually more efficient than F# sequence expressions. The reason is that C# iterators are very efficient state machines vs. F#'s are continuation passing.

In general though, in the abscence of threads, if you use the languages as they are intended to be used they will have similar performance characteristics.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-24T14:19:57.290

A good example is the sieve of eratosthenes.

A co-worker and I wrote similar sieves in C# and F#. The performance of the C# version was almost 10 times slower than it's functional counterpart written by my co-worker.

There were probably some inefficiencies in the C# version that could have been cleaned up, but the F# version is noticeably faster.

This sort of problem lends itself to being written in a functional language..

Hope this helps some.

**Edit -**

Here's one of the C# examples using similar functionality to F#'s List.Partition. I'll keep looking for the F# example. I have hundreds of projects that it could be in, it's just a matter of sorting through all of my stuff to find it (I save everything I ever experiment with, so this could be time consuming.. lol)

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ListPartitionTest
{
    public static class IEnumerableExtensions
    {
        public static KeyValuePair<IEnumerable<T>, IEnumerable<T>> Partition<T>(this IEnumerable<T> items, Func<T, bool> f)
        {
            return items.Aggregate(
                new KeyValuePair<IEnumerable<T>, IEnumerable<T>>(Enumerable.Empty<T>(), Enumerable.Empty<T>()),
                (acc, i) =>
                {
                    if (f(i))
                    {
                        return new KeyValuePair<IEnumerable<T>, IEnumerable<T>>(acc.Key.Concat(new[] { i }), acc.Value);
                    }
                    else
                    {
                        return new KeyValuePair<IEnumerable<T>, IEnumerable<T>>(acc.Key, acc.Value.Concat(new[] { i }));
                    }
                });
        }
    }

    class PrimeNumbers
    {
        public int Floor { get; private set; }
        public int Ceiling { get; private set; }

        private IEnumerable<int> _sieve;

        public PrimeNumbers(int floor, int ceiling)
        {
            Floor = floor;
            Ceiling = ceiling;
        }

        public List<int> Go()
        {
            _sieve = Enumerable.Range(Floor, (Ceiling - Floor) + 1).ToList();

            for (int i = (Floor < 2) ? 2 : Floor; i <= Math.Sqrt(Ceiling); i++)
            {
                _sieve = _sieve.Where(x => (x % i != 0 && x != i));

                foreach (int x in _sieve)
                {
                    Console.Write("{0}, ", x);
                }
                Console.WriteLine();
            }

            return _sieve.ToList();
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            System.Diagnostics.Stopwatch s = new System.Diagnostics.Stopwatch();
            int floor = 1;
            int ceiling = 10;

            s.Start();
            PrimeNumbers p = new PrimeNumbers(floor, ceiling);
            p.Go();
            //foreach (int i in p.Go()) Console.Write("{0} ", i);
            s.Stop();

            Console.WriteLine("\n{0} to {1} completed in {2}", floor, ceiling, s.Elapsed.TotalMilliseconds);

            Console.ReadLine();
        }
    }
} 
```

# c# - C# TWAIN 交互

> ID：476084
> 
> 赞同：6
> 
> 时间：2009-01-24T14:30:21.247
> 
> 标签：c#, wpf, imaging, image-scanner, twain

我正在尝试设置一个使用[代码项目中的 TWAIN 示例的 C# 应用程序](http://www.codeproject.com/KB/dotnet/twaindotnet.aspx)

这工作正常，除了我需要强制`Form`转换`IMessageFilter`并调用`IMessageFilter.PreFilterMessage()`以捕获 TWAIN 回调。
我还需要通过调用开始此过滤

```
Application.AddMessageFilter(); 
```

有没有办法在 WPF 窗口中做同样的事情？（添加消息过滤器并捕获 TWAIN 回调）。

另一个完全高级的问题：有人知道替代 C# TWAIN 库\包装器吗？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-22T12:04:28.230

[我刚刚将 Thomas Scheidegger 的文章（ CodeProject: .NET TWAIN 图像扫描](http://www.codeproject.com/KB/dotnet/twaindotnet.aspx)）中的代码打包到[github 项目中](https://github.com/tmyroadctfig/twaindotnet)

我已经稍微清理了 API 并添加了 WPF 支持，所以请检查一下。:)

它有一个简单的 WPF 应用程序，显示消息过滤如何与 WPF 一起工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T11:33:31.077

您可以在活动中尝试一下`ComponentDispatcher.ThreadFilterMessage`。
据我了解，它在*WPF*中的用途与`Application.AddMessageFilter()`在*WinForms*中的用途相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T15:39:06.227

我认为 TWAIN 被认为是过时的。也许看看[WIA](http://www.microsoft.com/whdc/device/stillimage/WIA-arch.mspx)，它从 WinXP 开始就完成了这项工作。在 codeproject也[有一个示例](http://www.codeproject.com/KB/dotnet/wiascriptingdotnet.aspx)。关于 WPF 相关问题，不知道，我只在 windows 窗体应用程序中使用过。

# .net - A Question about the .NET garbage collector when cyclic references exist

> ID：476095
> 
> 赞同：4
> 
> 时间：2009-01-24T14:46:20.467
> 
> 标签：.net

I'm aware that the .net garbage collector detects cyclic references but I was wondering whether cyclic references may cause objects to stay longer than necessary.

I have a cyclic reference in my ASP.NET app (an intended one for performance related reasons), can I get away with that?

Regards

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-24T14:52:21.437

It doesn't take the CLR any longer to remove a cyclic reference than a non-cyclic reference. The CLR uses a combination of techniques to garbage collect. The quick version though is it starts with all rooted objects (objects on the stack, or held with a strong GC handle). Any object that is reachable from these objects is alive. Anything else will be collected. A cyclic reference won't affect the results of this algorithm other than the CLR has to make sure to check for them and not walk in circles

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-24T14:54:58.343

It doesn't need to detect cycles, because in the algorithm it uses, cycles are simply not an issue.

If there is a path from a root (a variable on the stack, or a static variable, basically, because these are known to be live, and must not be GC'ed) to an object, then that object must be live too, and will not get GC'ed.

If there is no path, then the object is dead and can be GC'ed safely. Cycles simply don't matter. So no, cycles won't make a difference in objects lifetime.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-08T15:20:53.543

GC 将收集任何未被根对象引用的对象。根对象通常是所有应用程序域（即加载的程序集/类型对象）、全局和静态对象引用、每个线程各自堆栈上的所有对象引用以及当前加载到 CPU 寄存器中的任何对象引用所引用的对象。

在收集时，GC 遍历所有已知根对象的引用，并将沿途找到的任何对象标记为“正在使用”。完成后，可以安全地收集任何未标记的对象。

因此，如果根对象（直接或间接）没有引用您的任何对象，则是否存在循环引用无关紧要。无论如何，他们都有资格收集。我说合格，因为 GC 使用三种不同的策略来收集合格对象，并且出于性能原因，只有其中一个在运行时收集所有合格对象。

通常你不必考虑这个，它只是工作。但是垃圾收集还有很多内容，您仍然需要了解它的基础知识，以便了解内存管理和编写不泄漏资源的无错误代码等。因此，每个 .NET 开发人员都应该看看它。这里有一些资源可以详细解释 CLR 如何进行垃圾回收。

[MSDN - 垃圾收集器基础知识和性能提示 (Rico Mariani)](http://msdn.microsoft.com/en-us/library/ms973837.aspx)

[MSDN 杂志 - 垃圾收集（第 1 部分）：Microsoft .NET Framework 中的自动内存管理 (Jeffrey Richter)](http://msdn.microsoft.com/en-us/magazine/bb985010.aspx)

[MSDN 杂志 - 垃圾收集（第 2 部分）：Microsoft .NET Framework 中的自动内存管理 (Jeffrey Richter)](http://msdn.microsoft.com/en-us/magazine/bb985011.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T14:14:57.087

基本上，如果任何静态变量、局部变量、参数或成员变量引用了一个对象，它就不能用于垃圾回收。是否存在循环引用并不重要。要么引用了循环，在这种情况下不收集它，要么不引用它，在这种情况下可以收集整个循环。

如果一个类型实现了一个终结器，它将为集合提供服务，直到它的终结器运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T14:51:23.373

The Java GC can detect cycles and deal with them. I'd bet that the C# GC can as well.

# c# - QueryObject Include Entity Framework

> ID：476099
> 
> 赞同：2
> 
> 时间：2009-01-24T14:51:13.560
> 
> 标签：c#, entity-framework, include, objectquery

I have three tables: Scenarios, Components and Blocks. Blocks has a foreign key to ComponentId and Components has a foreign key to Scenarios.

Blocks also has a foreign key (TreeStructureId) to another table TreeStructures.

Now, why does this work:

```
ObjectQuery<Blocks> blocks = edumatic3Entities.Blocks.Include("TreeStructures").Include("Components.Scenarios"); 
```

It loads the TreeStructures, Components and Scenarios.

This however doesn't work:

```
ObjectQuery<Blocks> blocks = edumatic3Entities.Blocks.Include("Components.Scenarios").Include("TreeStructures"); 
```

This loads the Components and Scenarios but doesn't load the TreeStructures...

Seems very strange to me... Why is this?

thx, Lieven Cardoen

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-24T15:29:02.657

**您是否正确设置了逻辑模型**中实体之间的关系？它是否以允许从 Scenarios 导航到 TreeStructures 的方式设置？拥有外键是不够的。

# vb.net - 使用 TagLib 从 MP3 文件中提取专辑封面 - 有没有更好的方法编写此代码？

> ID：476101
> 
> 赞同：3
> 
> 时间：2009-01-24T14:51:46.603
> 
> 标签：vb.net, optimization, performance, mp3, taglib

我正在使用 Visual Basic 9 (VS2008) 和 TagLib。

以下代码从 MP3 文件中提取专辑封面并将其显示在 PictureBox 中。

有没有更好的方法来编写这段代码？

```
 Dim file As TagLib.File = TagLib.File.Create(filepath)

 If file.Tag.Pictures.Length >= 1 Then
    Dim bin As Byte() = DirectCast(file.Tag.Pictures(0).Data.Data, Byte())
    PreviewPictureBox.Image = Image.FromStream(New MemoryStream(bin)).GetThumbnailImage(100, 100, Nothing, System.IntPtr.Zero)
 End If 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T15:05:29.413

乍一看，我觉得没问题。

您可以添加一些错误处理，例如如果`TagLib.File.Create()`抛出错误或返回“ `Nothing`”。此外，如果`Tag`属性由于某种原因为空，如果您尝试访问“”，则会引发错误`.Pictures`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T15:21:29.693

我对 TagLib 不是很熟悉，但看起来没有更好的方法来编写它。我能给出的唯一建议是，您可以利用类型推断来减少代码量。如果“选项推断”当前处于启用状态，则这两个变量声明不需要显式类型。这实际上并没有改变代码的质量，它只是减少了代码的数量。

例子

```
 Option Infer On
 ...
 Dim file = TagLib.File.Create(filepath)

 If file.Tag.Pictures.Length >= 1 Then
    Dim bin = DirectCast(file.Tag.Pictures(0).Data.Data, Byte())
    PreviewPictureBox.Image = Image.FromStream(New MemoryStream(bin)).GetThumbnailImage(100, 100, Nothing, System.IntPtr.Zero)
 End If 
```

# javascript - 如何使用 JavaScript 中的格式规范将字符串转换为日期时间？

> ID：476105
> 
> 赞同：219
> 
> 时间：2009-01-24T14:56:46.810
> 
> 标签：javascript, datetime, type-conversion

如何通过指定格式字符串将字符串转换为 javascript 中的日期时间对象？

我正在寻找类似的东西：

```
var dateTime = convertToDateTime("23.11.2009 12:34:56", "dd.MM.yyyy HH:mm:ss"); 
```

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-01-24T15:07:37.397

如果您的字符串与. 如果您的格式不兼容（我认为是），您必须自己解析字符串（使用正则表达式应该很容易）并创建一个[新的 Date 对象](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Date)，其中包含年、月、日、小时、分钟和秒的显式值。`new Date(*dateString*)`[`Date.parse()`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Date/parse)

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2009-01-24T15:10:31.057

我认为这可以帮助你： http: [//www.mattkruse.com/javascript/date/](https://web.archive.org/web/20090114044719/http://www.mattkruse.com/javascript/date/)

您可以稍微`getDateFromFormat()`调整一下功能来解决您的问题。

[更新： javascripttoolbox.com](https://web.archive.org/web/20090123134657/http://www.javascripttoolbox.com/lib/date/index.php)上提供了示例的更新版本

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2011-10-10T11:53:46.347

@Christoph 提到使用正则表达式来解决问题。这是我正在使用的：

```
var dateString = "2010-08-09 01:02:03";
var reggie = /(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/;
var dateArray = reggie.exec(dateString); 
var dateObject = new Date(
    (+dateArray[1]),
    (+dateArray[2])-1, // Careful, month starts at 0!
    (+dateArray[3]),
    (+dateArray[4]),
    (+dateArray[5]),
    (+dateArray[6])
); 
```

它绝不是智能的，只需配置正则表达式并`new Date(blah)`满足您的需求。

编辑：在 ES6 中使用解构可能更容易理解：

```
let dateString = "2010-08-09 01:02:03"
  , reggie = /(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/
  , [, year, month, day, hours, minutes, seconds] = reggie.exec(dateString)
  , dateObject = new Date(year, month-1, day, hours, minutes, seconds); 
```

但老实说，这些天我达到了像 Moment 这样的东西

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-01-24T15:14:43.203

JavaScript 中不存在复杂的日期/时间格式化例程。

您必须使用外部库来格式化日期输出，Flagrant Badassery 的[“JavaScript Date Format”看起来很有前途。](http://blog.stevenlevithan.com/archives/date-time-format)

对于输入转换，已经提出了一些建议。:)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-06-19T23:37:04.537

查看[Moment.js](http://momentjs.com/)。它是一个现代而强大的库，弥补了 JavaScript 糟糕的 Date 函数（或缺乏）。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2011-02-23T22:02:00.207

只是为了在这里更新答案，[http: //www.datejs.com/ 上有一个很好的 js 库](http://www.datejs.com/)

> Datejs 是一个用于解析、格式化和处理的开源 JavaScript 日期库。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-06-01T06:02:46.247

```
var temp1 = "";
var temp2 = "";

var str1 = fd; 
var str2 = td;

var dt1  = str1.substring(0,2);
var dt2  = str2.substring(0,2);

var mon1 = str1.substring(3,5);
var mon2 = str2.substring(3,5);

var yr1  = str1.substring(6,10);  
var yr2  = str2.substring(6,10); 

temp1 = mon1 + "/" + dt1 + "/" + yr1;
temp2 = mon2 + "/" + dt2 + "/" + yr2;

var cfd = Date.parse(temp1);
var ctd = Date.parse(temp2);

var date1 = new Date(cfd); 
var date2 = new Date(ctd);

if(date1 > date2) { 
    alert("FROM DATE SHOULD BE MORE THAN TO DATE");
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-01-18T11:54:55.333

```
time = "2017-01-18T17:02:09.000+05:30"

t = new Date(time)

hr = ("0" + t.getHours()).slice(-2);
min = ("0" + t.getMinutes()).slice(-2);
sec = ("0" + t.getSeconds()).slice(-2);

t.getFullYear()+"-"+t.getMonth()+1+"-"+t.getDate()+" "+hr+":"+min+":"+sec 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-02-05T11:11:08.083

外部库对于解析一两个日期来说太过分了，所以我使用[Oli](https://stackoverflow.com/a/476122/1801588)和[Christoph 的](https://stackoverflow.com/a/476117/1801588)解决方案创建了自己的函数。在中欧，我们很少使用除 OP 格式之外的任何东西，所以这对于这里使用的简单应用程序来说应该足够了。

```
function ParseDate(dateString) {
    //dd.mm.yyyy, or dd.mm.yy
    var dateArr = dateString.split(".");
    if (dateArr.length == 1) {
        return null;    //wrong format
    }
    //parse time after the year - separated by space
    var spacePos = dateArr[2].indexOf(" ");
    if(spacePos > 1) {
        var timeString = dateArr[2].substr(spacePos + 1);
        var timeArr = timeString.split(":");
        dateArr[2] = dateArr[2].substr(0, spacePos);
        if (timeArr.length == 2) {
            //minutes only
            return new Date(parseInt(dateArr[2]), parseInt(dateArr[1]-1), parseInt(dateArr[0]), parseInt(timeArr[0]), parseInt(timeArr[1]));
        } else {
            //including seconds
            return new Date(parseInt(dateArr[2]), parseInt(dateArr[1]-1), parseInt(dateArr[0]), parseInt(timeArr[0]), parseInt(timeArr[1]), parseInt(timeArr[2]))
        }
    } else {
        //gotcha at months - January is at 0, not 1 as one would expect
        return new Date(parseInt(dateArr[2]), parseInt(dateArr[1] - 1), parseInt(dateArr[0]));
    }
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-24T15:11:36.530

`Date.parse()`相当聪明，但我不能保证格式会正确解析。

如果没有，您必须找到一些东西来弥合两者。您的示例非常简单（纯粹是数字），因此与一些配对的 REGEX（甚至`string.split()`可能更快）`parseInt()`可以让您快速进行约会。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-08-08T08:03:29.240

只给我5美分。

我的日期格式是 dd.mm.yyyy （英国格式），以上示例均不适合我。所有解析器都将 mm 视为日，将 dd 视为月。

我找到了这个库： http: [//joey.mazzarelli.com/2008/11/25/easy-date-parsing-with-javascript/](http://joey.mazzarelli.com/2008/11/25/easy-date-parsing-with-javascript/) 并且它有效，因为您可以这样说字段的顺序：

```
>>console.log(new Date(Date.fromString('09.05.2012', {order: 'DMY'})));
Wed May 09 2012 00:00:00 GMT+0300 (EEST) 
```

我希望这对某人有所帮助。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-06-11T20:21:52.503

[Moment.js](http://momentjs.com/docs/#/parsing/string-format/)将处理这个：

```
var momentDate = moment('23.11.2009 12:34:56', 'DD.MM.YYYY HH:mm:ss');
var date = momentDate.; 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-05-05T13:08:20.137

您可以为此使用 moment.js 库。我仅用于获取特定时间的输出，但您可以选择要选择的格式。

参考：

**1.时刻库：** [https ://momentjs.com/](https://momentjs.com/)

**2.时间和日期具体功能：** [https ://timestamp.online/article/how-to-convert-timestamp-to-datetime-in-javascript](https://timestamp.online/article/how-to-convert-timestamp-to-datetime-in-javascript)

```
convertDate(date) {
        var momentDate = moment(date).format('hh : mm A');
        return momentDate;
} 
```

你可以像这样调用这个方法：

```
this.convertDate('2020-05-01T10:31:18.837Z'); 
```

我希望它有所帮助。享受编码。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-12-26T10:27:52.557

为了完全满足**Date.parse**将字符串转换为 RFC822 中指定的格式 dd-mm-YYYY，如果使用 yyyy-mm-dd 解析可能会出错。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-02-25T09:05:24.377

```
//Here pdate is the string date time
var date1=GetDate(pdate);
    function GetDate(a){
        var dateString = a.substr(6);
        var currentTime = new Date(parseInt(dateString ));
        var month =("0"+ (currentTime.getMonth() + 1)).slice(-2);
        var day =("0"+ currentTime.getDate()).slice(-2);
        var year = currentTime.getFullYear();
        var date = day + "/" + month + "/" + year;
        return date;
    } 
```

# c# - ASP.NET 中 GridView 背后的原因是什么？

> ID：476106
> 
> 赞同：0
> 
> 时间：2009-01-24T14:57:13.173
> 
> 标签：c#, asp.net

我对 ASP.NET 中的 GridView 感到困惑。

GridView 究竟是如何工作的？

我的意思是当我们通过 GridView1.DataBind() 将数据绑定到具有 100 条记录的 gridview 时；

我已经设置**了 Pageindexchangeing**事件，我设置了Pagesize **= "40"**和**AllowPaging="True"** Then....

现在有趣的部分开始了当我单击 GridView 的下一页索引时会发生什么。再次进入数据库并获取数据..或gridview创建自己的数据集并从该数据集或任何不同于此的数据中获取数据......

还有一件事是排序如何在 GridView 中工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T15:14:01.673

简单的答案是肯定的，这`GridView`只是一个放置在 a 上的视图`DataGrid`，所有指定的参数都会影响`GridView`为用户呈现的方式。由于我们正在处理无状态网络，因此您将不得不重新绑定数据。

这样做的一个技巧是，如果您的数据集不是太大，您可以将其存储`DataTable`在用户的会话中，然后从那里简单地检索它，从而节省访问数据库的时间。如果您正在处理大量数据，那么您将需要研究使您的 SQL 查询以“分页”格式运行的选项，以便您只检索您打算显示的行。

通过分页和排序，它们可以作为一个事件来响应，您可以在其中使用数据并重新绑定到网格以进行演示。

的优点`GridView`是您确实有一个中央对象，其中内置了许多可用于快速部署的功能。当您了解排序、分页、行命令和其他操作的工作原理时，您可以用少量代码完成一些非常棒的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T15:58:21.757

这取决于您的数据源是什么，如果您的数据源支持分页，那么它将仅获取显示该页面所需的记录，如果不支持，它将获取所有记录并丢弃您不想要的记录。对于这两个示例，每次更改页面时它都会与数据源对话。

有关更多详细信息，请参见此处：http: [//msdn.microsoft.com/en-us/library/5aw1xfh3.aspx](http://msdn.microsoft.com/en-us/library/5aw1xfh3.aspx)

# android - Scala Programming for Android

> ID：476111
> 
> 赞同：262
> 
> 时间：2009-01-24T15:03:18.060
> 
> 标签：android, scala, resources

I have followed the tutorial at [Scala and Android](http://www.scala-lang.org/node/160) with *Scala 2.7.3* final. The resulting Android App works but even the most basic application takes several minutes (!) to compile and needs **900 kb** compressed, which is a show stopper for mobile applications. Additionally, the IDE runs out of memory every now and then. I assume `dex` is not made for big libraries like the `scala-library`.

*   So my question is: Has anyone actually done this and is there any cure for this?

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2009-04-20T16:24:49.227

我已经用 Scala 编写了一些基本的 Android 应用程序，没有什么史诗般的。不是 Java 程序员，有人建议我使用“treeshake”，一位朋友向我解释说，这会从*jar*文件中删除所有不必要的库。

我没有记录它，但我发现其他人已经有：

[http://chneukirchen.org/blog/archive/2009/04/programming-for-android-with-scala.html](http://chneukirchen.org/blog/archive/2009/04/programming-for-android-with-scala.html)

Proguard 不是唯一的解决方案，您可能会找到适合您的工作流程或更适合您的环境的东西。

此外，谷歌刚刚实现了 JACK，它处理了大量减少构建和内存时间的问题，请参阅[https://source.android.com/source/jack.html](https://source.android.com/source/jack.html)

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2010-04-12T20:59:53.013

您现在可以使用 Gradle 的 Android 插件在 Scala 中创建 Android 应用程序。它结合了 ProGuard 工具来修剪生成的 APK 文件中的脂肪，因此似乎可以满足您的需求。

[https://github.com/jvoegele/gradle-android-plugin/wiki](https://github.com/jvoegele/gradle-android-plugin/wiki)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2010-06-17T09:06:12.210

还有一个基于 Scala 的构建器[sbt](http://code.google.com/p/simple-build-tool/)的插件：[sbt-android-plugin](http://github.com/jberkel/android-plugin)。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2010-07-14T09:06:27.577

有关教程和示例，另请参阅 Stéphane Micheloud 的“探索 Android”页面：[http ://lamp.epfl.ch/~michelou/android/](http://lamp.epfl.ch/~michelou/android/)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2012-06-18T14:31:13.333

我用 Eclipse 3.7、Scala 2.10 和插件 AndroidProguardScala v50 验证了这个详细的解决方案：

[https://stackoverflow.com/a/11084146/1287856](https://stackoverflow.com/a/11084146/1287856)

一切正常。一个带有扩展的主要活动类的简单测试应用程序只需要 38Kb。支持图书馆项目。导出项目时会激活 Proguard。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-05-26T09:24:32.990

为 Scala 开发 Android 应用程序正在不断发展。在 SBT 看来，目前最好的方法是与[android-sdk-plugin](https://github.com/pfn/android-sdk-plugin)结合使用，它得到了维护*，并且在我的 Scala/Android 项目中对我来说效果很好。[还可以找到](https://github.com/pocorall/hello-scaloid-sbt)一个最近的示例，该示例演示了如何将这个插件与已经提到的 Scalaid 一起使用。

请注意，此问题是Stack Overflow 上[回答过时的问题的典型示例。](https://meta.stackexchange.com/questions/92574/adding-obsolete-and-outdated-voting-options-on-questions)这个答案也可能在某个时候变得过时。

* 此答案线程中提到的其他基于 SBT 的项目似乎在撰写本文时的过去六个月内没有为它们编写代码。它们可能与较新版本的 Scala 和 SBT 存在兼容性问题。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-10-15T03:53:10.617

如果您使用 maven，请使用[android-scala-test](https://github.com/rohansingh/android-scala-test)作为启动模板。它开箱即用对我来说非常有用。

[Scalaid](https://github.com/pocorall/scaloid)是一个用 Scala 编写的 Android API 包装器，可帮助您以 Scala 风格编写 Android 程序。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-12-07T19:10:56.660

您可以在没有 SBT 的情况下在 Android 上使用 Scala，它由 Gradle 在外部构建以创建 Android 应用程序。 [https://github.com/yareally/android-scala-intellij-no-sbt-plugin](https://github.com/yareally/android-scala-intellij-no-sbt-plugin)

Gradle 是比 SBT 更适合 Android 的原生构建工具。

有 Scala 客户端和服务器端解决方案概念的很好的例子，以及作为 IntelliJ IDEA 工作台的高级构建工具。

核心类对于客户端和服务器来说是通用的，这是一个很大的进步。

[https://github.com/ghik/akkdroid](https://github.com/ghik/akkdroid)

IDEA 和 android-plugin 的好教程：http: [//fxthomas.github.io/android-plugin/](http://fxthomas.github.io/android-plugin/)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-10-01T00:49:08.167

Android 上 Scala 的最大问题是编译时间。

可能是因为 Proguard 类剥离在具有 8GB 的​​双四核 (8-CPU) E5450 Xeon 上使用 IDEA13/Scala 插件编译可能需要两分钟或更长时间。

在完成一个大型 Scala Android 项目后，我只是简单地回到 Java，因为编译时间太令人沮丧了。

# sql - 如果同一行中的另一个字段被外部进程更改，我如何更新大 SQL 表中的一个小字段？

> ID：476112
> 
> 赞同：0
> 
> 时间：2009-01-24T15:04:57.090
> 
> 标签：sql, sql-server, event-handling, triggers

我想调用 Update ... Set ... Where ... 来更新一个字段，只要那个邪恶的 ERP 流程正在改变另一个字段的值。

我正在运行 MS SQL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T15:06:22.580

您可以使用触发器来更新其他字段。

编辑：我想这可能取决于您正在运行的 SQLesque 数据库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T15:30:56.383

我无法测试，但我想它是这样的触发器

```
CREATE TRIGGER TriggerName ON TableName FOR UPDATE AS
  如果更新（ColumnUpdatedByERP）
  开始
    更新 ...
  结尾

```

- 编辑 - 更好的版本，感谢 Tomalak 的评论

```

CREATE TRIGGER TriggerName ON TableName FOR UPDATE AS
  声明 @oldValue VARCHAR(100)
  声明@newValue VARCHAR(100)
  如果更新（ColumnUpdatedByERP）
  开始
    SELECT @oldValue = (SELECT ColumnUpdatedByERP FROM Deleted)
    SELECT @newValue = (SELECT ColumnUpdatedByERP FROM Inserted)
    如果 @oldValue <> @newValue
    开始
      更新 ...
    结尾
  结尾

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T02:36:22.327

您想使用触发器，但我会非常警惕所选答案中的错误。请参阅 Brent Ozar关于多条记录的文章[http://www.brentozar.com/archive/2009/01/triggers-need-to-handle-multiple-records/ 。](http://www.brentozar.com/archive/2009/01/triggers-need-to-handle-multiple-records/)

# .net - 如何从 wcf 服务中检索未知类型？

> ID：476128
> 
> 赞同：3
> 
> 时间：2009-01-24T15:14:09.240
> 
> 标签：.net, wcf, generics

我目前正在开发一个 wcf 服务，该服务在数据库中进行一些查找并将数据返回给客户端。用户在文本框中输入了他想看到的东西的 id。这可以是客户 ID、产品 ID、订单 ID 或其他任何内容。服务器上的查找方法尝试在客户端表中查找 id。如果它不在那里，它会放在产品表等上，直到找到为止。

当调用服务器时，没有办法告诉用户正在寻找什么。据我所知，我需要指定返回类型设计时间，否则对象的序列化不起作用。我唯一能想到的是包含所有可能对象的辅助类，并从 wcfservice 中返回，有更好的主意吗？

**附加信息：** 我们正在使用 wsHttpBinding 和 Linq-To-Sql。该数据库是遗留的，并且还使用了其他软件，因此无法更改数据对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T15:38:47.740

您没有提及您用于服务的绑定。如果它是基于 SOAP 的绑定，例如 wsHttpBinding 或 basicHttpBinding，那么您的方法可能返回的所有可能类型必须在编译时已知，以便它们可以在 WSDL 中公开，并且客户端可以生成代理类。在这种情况下，您必须定义一个基类，其中包含您的所有实体将从中派生的 id，并使用[ServiceKnownTypeAttribute](http://msdn.microsoft.com/en-us/library/system.servicemodel.serviceknowntypeattribute.aspx)或在您的 app.config/web.config 文件中列出它们：

```
<system.runtime.serialization>
    <dataContractSerializer>
        <declaredTypes>
            <add type="MyNamespace.Entity">
                <knownType type="MyNamespace.Client" />
                <knownType type="MyNamespace.Product" />
                <knownType type="MyNamespace.Order" />
            </add>
        </declaredTypes>
    </dataContractSerializer>
</system.runtime.serialization> 
```

如果您在 TCP 上使用二进制序列化，则无需在编译时指定已知类型，因为二进制序列化程序将传输类型信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T15:43:43.347

您的解决方案应该有效。其他解决方案是：

1.  如果您的类型有一个公共基类（如 Object ;-)），您可以声明 Web 服务以返回此类，并使用[KnownTypes](http://msdn.microsoft.com/en-us/library/ms730167.aspx)属性告诉 WCF 如何序列化/反序列化子类
2.  让 Web 服务返回 XML 并自己序列化和反序列化您的 XML。您完全可以控制，但这可能需要做很多额外的工作。

# python - wxPython中OLE拖拽方式

> ID：476142
> 
> 赞同：2
> 
> 时间：2009-01-24T15:29:45.167
> 
> 标签：python, windows, drag-and-drop, wxpython, ole

我有在 MS Windows 上运行的 wxPython 应用程序，我希望它支持其实例之间的拖放（因此用户打开我的应用程序 3 次并将数据从一个实例拖到另一个实例）。

wxPython 中的简单拖放就是这样工作的：

1.  **用户发起拖动**：源窗口在 wx.DataObject() 中打包必要的数据，创建新的 wx.DropSource，设置其数据并调用 dropSource.DoDragDrop()
2.  **用户将数据拖放到目标窗口**：拖放目标调用库函数 GetData()，它将实际数据传输到其 wx.DataObject 实例，最后 - dataObject.GetData() 解包实际数据。

我想要一些更复杂的拖放功能，允许用户选择在他下降**后拖动哪些数据。***我的梦想*
场景：

 *1.  **用户发起拖拽**：只有一些指向源窗口的指针被打包（一些函数或对象）。
2.  **用户将数据拖放到目标窗口**：显示漂亮的对话框，询问用户他选择了哪种拖放模式（例如 - 仅拖动歌曲标题，或歌曲标题和艺术家姓名或拖动艺术家的整个专辑）。
3.  **用户选择拖拽模式**：Drop target 在拖拽的数据对象上调用一些函数，然后从拖拽源中取出数据并传送到drop target。

我梦想的场景在 MS Windows 中似乎是可行的，但是 wxWidgets 和 wxPython 的文档非常复杂且模棱两可。并非所有 wx.DataObject 类都在 wxPython 中可用（仅 wx.PySimpleDataObject），所以我希望有人分享他对这种方法的经验。这样的行为是否可以在 wxPython 中实现而无需直接在 winAPI 中进行编码？

编辑：Toni Ruža 通过工作拖放示例给出了答案，但这并不是*我梦寐以求*的场景。他的代码在数据被拖放时操作数据（**HandleDrop()**显示弹出菜单），但数据在启动拖动时准备好（在**On_ElementDrag()**中）。在我的应用程序中应该有三种不同的拖放模式，其中一些需要耗时的数据准备。这就是为什么我想将数据检索推迟到用户丢弃数据并选择（可能成本高昂）d&d 模式的那一刻。

对于内存保护问题 - 我想使用 OLE 机制进行进程间通信，就像 MS Office 一样。您可以复制 Excel 图表并将其粘贴到 MS-Word 中，它的行为就像图像（嗯，有点）。由于它有效，我相信它可以在 winAPI 中完成。我只是不知道我是否可以在 wxPython 中对其进行编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T19:59:58.243

由于您不能使用其中一种[标准](http://www.wxpython.org/docs/api/wx.DataFormat-class.html)数据格式来存储对 python 对象的引用，我建议您使用文本数据格式来存储方法调用所需的参数，而不是制作新的数据格式。无论如何，将对象的引用从一个应用程序传递到另一个应用程序是没有好处的，因为有问题的对象将无法访问（还记得内存保护吗？）。

这是满足您要求的简单示例：

```
import wx

class TestDropTarget(wx.TextDropTarget):
    def OnDropText(self, x, y, text):
        wx.GetApp().TopWindow.HandleDrop(text)

    def OnDragOver(self, x, y, d):
        return wx.DragCopy

class Test(wx.Frame):
    def __init__(self):
        wx.Frame.__init__(self, None)

        self.numbers = wx.ListCtrl(self, style = wx.LC_ICON | wx.LC_AUTOARRANGE)
        self.field = wx.TextCtrl(self)

        sizer = wx.FlexGridSizer(2, 2, 5, 5)
        sizer.AddGrowableCol(1)
        sizer.AddGrowableRow(0)
        self.SetSizer(sizer)
        sizer.Add(wx.StaticText(self, label="Drag from:"))
        sizer.Add(self.numbers, flag=wx.EXPAND)
        sizer.Add(wx.StaticText(self, label="Drag to:"), flag=wx.ALIGN_CENTER_VERTICAL)
        sizer.Add(self.field)

        for i in range(100):
            self.numbers.InsertStringItem(self.numbers.GetItemCount(), str(i))

        self.numbers.Bind(wx.EVT_LIST_BEGIN_DRAG, self.On_ElementDrag)
        self.field.SetDropTarget(TestDropTarget())

        menu_id1 = wx.NewId()
        menu_id2 = wx.NewId()
        self.menu = wx.Menu()
        self.menu.AppendItem(wx.MenuItem(self.menu, menu_id1, "Simple copy"))
        self.menu.AppendItem(wx.MenuItem(self.menu, menu_id2, "Mess with it"))
        self.Bind(wx.EVT_MENU, self.On_SimpleCopy, id=menu_id1)
        self.Bind(wx.EVT_MENU, self.On_MessWithIt, id=menu_id2)

    def On_ElementDrag(self, event):
        data = wx.TextDataObject(self.numbers.GetItemText(event.Index))
        source = wx.DropSource(self.numbers)
        source.SetData(data)
        source.DoDragDrop()

    def HandleDrop(self, text):
        self._text = text
        self.PopupMenu(self.menu)

    def On_SimpleCopy(self, event):
        self.field.Value = self._text

    def On_MessWithIt(self, event):
        self.field.Value = "<-%s->" % "".join([int(c)*c for c in self._text])

app = wx.PySimpleApp()
app.TopWindow = Test()
app.TopWindow.Show()
app.MainLoop() 
```

诸如 On_SimpleCopy 和 On_MessWithIt 之类的方法会在拖放后执行，因此您可能想要执行的任何冗长操作都可以根据您通过拖动传输的文本或其他一些标准类型的数据（在我的情况下为 self._text）执行，然后查看...没有OLE :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T14:40:39.423

好吧，似乎无法按照我想要的方式完成。

可能的解决方案是：

1.  在用户在目标进程窗口中删除数据后，在 d&d 中传递一些参数并自行进行一些进程间通信。
2.  使用[DataObjectComposite](http://www.wxpython.org/docs/api/wx.DataObjectComposite-class.html)支持多种拖放格式和键盘修饰符来选择当前格式。设想：
    1.  用户启动拖动。检查 CTRL、ALT 和 SHIFT 的状态，并根据它选择 d&d 格式。DataObjectComposite 已创建，并已以所选格式设置数据。
    2.  用户在目标窗口中放置数据。放置目标向放置的 DataObject 询问支持的格式并检索数据，**知道**它是什么格式。

我选择解决方案**2.**，因为它不需要在进程之间进行手工通信，并且当用户只想拖动最简单的数据时，它可以让我避免不必要的数据检索。

无论如何 - 托尼，谢谢你的回答！玩了一下，它让我想到了 d&d 并改变了我解决问题的方法。

# windows - Windows 窗口对接

> ID：476152
> 
> 赞同：1
> 
> 时间：2009-01-24T15:33:12.540
> 
> 标签：windows, winapi

我想知道如何在 Windows 中将窗口停靠/捕捉到屏幕的一侧，最好使用直接的 Win32 API。我正在寻找的效果就像任务栏——一个在屏幕上保留空间的窗口，因此最大化另一个窗口会使该窗口占据屏幕的其余部分，但让我的窗口保持在原位并且可见。

我知道各种 IM 客户端都会这样做，但无法找到任何有关如何执行此操作的资源。也不确定它的合适名称是什么。

编辑：“应用程序桌面工具栏”是用于查找相关信息的搜索词。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T16:25:12.357

IIUYC 您正在寻找一个应用栏（MS-官方为“应用程序桌面工具栏”）。您确实可以使用 Windows API 创建这些。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T16:38:08.790

“App Bar” - 通过发送 ABM_NEW 消息将窗口变成 App Bar。MSDN 上的示例：

[http://msdn.microsoft.com/en-us/library/cc144177(VS.85).aspx](http://msdn.microsoft.com/en-us/library/cc144177(VS.85).aspx) [http://support.microsoft.com/kb/134206](http://support.microsoft.com/kb/134206)

# .net - NAnt 或 MSBuild，选择哪一个以及何时选择？

> ID：476163
> 
> 赞同：161
> 
> 时间：2009-01-24T15:39:24.337
> 
> 标签：.net, msbuild, automation, nant

我知道 Stack Overflow 上还有其他与[NAnt](http://en.wikipedia.org/wiki/NAnt)和[MSBuild](http://en.wikipedia.org/wiki/MSBuild)相关的问题，但我找不到两者之间的直接比较，所以这里是问题所在。

什么时候应该选择 NAnt 而不是 MSBuild？哪个更适合什么？NAnt 更适合家庭/开源项目，MSBuild 更适合工作项目吗？两者中的任何一个是什么体验？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-01-27T14:08:16.943

这周我做了一个类似的调查。这是我能够确定的：

**南特：**

*   跨平台（支持 Linux/Mono）。例如，将网站安装到多个目标（即 Linux Apache 和 Windows IIS）可能很方便。
*   95% 的语法与 Ant 相似（对于当前的 Ant 用户或 Java 构建者来说很容易上手）
*   与 NUnit 集成以在构建过程中运行单元测试，并与 NDoc 集成以生成文档。

**微软构建：**

*   内置于 .NET。
*   与 Visual Studio 集成
*   在 Visual Studio 中轻松开始使用 MSBuild - 这一切都在幕后。如果你想更深入，你可以手动编辑文件。

**主观差异：** *（YMMV）*

*   NAnt 文档更简单一些。例如，[MSBuild 任务参考](http://msdn.microsoft.com/en-us/library/7z253716.aspx)列出了“Csc 任务 - 描述 Csc 任务及其参数。”（感谢“帮助”？），而[NAnt 任务参考](http://nant.sourceforge.net/release/latest/help/tasks/)“csc - 编译 C# 程序”。***更新：***我注意到[MSBuild 文档](http://msdn.microsoft.com/en-us/library/7z253716.aspx)已经改进并且现在好多了（可能与 NAnt 相当）。
*   不容易弄清楚如何直接从 Visual Studio 中编辑构建脚本源（*.*proj 文件）。使用 NAnt，我只需让 Visual Studio 将 .build 脚本视为 XML 文件。
*   显然，在 Visual Studio 中，Web 应用程序项目默认不会获得 *.*proj 文件，因此我很难弄清楚如何让 MSBuild 在我的服务器上运行以创建部署脚本。
*   NAnt 不是 Visual Studio 内置的，必须通过加载项或作为“外部工具”添加。设置起来有点麻烦。
*   （编辑：）我的一位同事提出了这一点——如果您想使用[CruiseControl](http://cruisecontrol.sourceforge.net/)设置构建机器以进行持续集成，CruiseControl 可以很好地与 NAnt 集成。***更新：*** CruiseControl 也有一个[MSBuild 任务](http://www.cruisecontrolnet.org/projects/ccnet/wiki/MsBuild_Task)。
*   *有关主观差异的完整和最新讨论，请参阅下面的评论。*

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-01-24T16:30:54.203

MSBuild 对我来说（在 Windows 平台上）的主要吸引力之一是它作为 .NET 本身的一部分。这意味着任何安装了 Windows Update 的 Windows 机器都可以使用 MSBuild。除此之外，C# 编译器也是 .NET 本身的一部分，并且您拥有一个可以在干净的机器上构建项目的平台。无需安装 Visual Studio 庞然大物。另一方面，必须在触发构建之前显式安装 NAnt。

仅作记录，我过去曾在非平凡的构建中使用过 NMake、Make、Ant、Rake、NAnt 和 MSBuild（按此顺序）。我最喜欢的是 MSBuild，毫无疑问（我不喜欢它，因为“这就是 Visual Studio 使用的”）。恕我直言，它是一个非常被低估的构建工具。

我会将 NAnt 与 MSBuild 与过程编程和函数式编程之间的区别进行比较。NAnt 非常简单，你得到你所看到的。另一方面，MSBuild 需要更多的思考。学习曲线更陡峭。但是一旦你“得到它”，你就可以用它做一些了不起的事情。

因此，如果您也倾向于函数式或逻辑式编程，我建议您查看 MSBuild - 如果您愿意在看到切实结果之前投入一些时间和精力（当然，我也坚信投资最终会得到回报，并且您可以更有效地做更强大的事情）。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2009-01-24T15:52:00.070

就个人而言，我将两者都用于同一个项目。

MSBuild 非常擅长构建 Visual Studio 解决方案和项目——这就是它的用途。

在我看来，NAnt 更容易手动编辑 - 特别是如果您已经了解 Ant。NAnt 可以使用 NAntContrib 非常轻松地调用 MSBuild。因此，我手工制作了一个 NAnt 脚本来执行复制构建文件、清理等操作 - 并调用 MSBuild 来执行实际的“将我的 C# 源代码转换为程序集”部分。

如果您想要一个示例，请查看我的[Protocol Buffers 构建文件](http://github.com/jskeet/dotnet-protobufs/blob/7d9553b46ea9e1bd56e17dc74498d2150e20b043/ProtocolBuffers.build)。（我不会声称这是一个很棒的 NAnt 脚本，但它确实可以完成这项工作。）

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-03-28T23:57:41.937

**NAnt**具有更多开箱即用的功能，但**MSBuild**具有更好的基本结构（项目元数据岩石），这使得构建可重用的 MSBuild 脚本变得更加容易。

MSBuild 需要一段时间才能理解，但一旦你完成它就会非常好。

学习资料：

*   [在 Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)
    ，作者 Sayed Ibrahim Hashimi（2009 年 1 月）
*   [部署 .NET 应用程序：学习 MSBuild 和 ClickOnce，](https://rads.stackoverflow.com/amzn/click/com/B001D25YT6)
    Y. Hashimi 的 Sayed（2008 年 9 月）

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-06-03T18:03:08.783

[KISS](https://en.wiktionary.org/wiki/KISS#Phrase) = 使用 MSBuild。

当你有一些可以开箱即用的东西时，为什么还要添加其他东西呢？当 MSBuild 到来时，NAnt 死了。[Mono](http://en.wikipedia.org/wiki/Mono_%28software%29)将有一个 MSBuild 实现，( [xbuild](http://www.mono-project.com/Microsoft.Build) )。

[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself) = 使用 MSBuild。

问问自己你想从构建系统中得到什么？[我想要一个我的IDE](http://en.wikipedia.org/wiki/Integrated_development_environment)也使用的构建系统，而不是维护两个不同的配置。

就个人而言，我很想听听一些关于 NAnt 的真正论据，因为我想不出任何真正站得住脚的论据。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2010-03-16T18:19:23.167

我注意到几张海报提到的一件事是必须手动编辑 .csproj（或 .vbproj 等）文件。

MSBuild 允许通过使用 .user 文件自定义这些 .*proj 文件。如果我有一个名为**MyCreativelyNamedProject.csproj**的项目并且想要自定义其中的 MSBuild 任务，我可以创建一个名为**MyCreativelyNamedProject.csproj.user**的文件并使用*CustomBeforeMicrosoftCommonTargets*和*CustomAfterMicrosoftCommonTargets*来自定义这些文件。

此外，NAnt 和 MSBuild 都可以通过自定义 MSBuild 任务和 NantContrib 扩展来定制。

因此，使用 NAnt 或 MSBuild 真的归结为熟悉：

*   如果您已经熟悉 Ant，请使用 NAnt。学习曲线将非常容易。
*   如果您不熟悉这两种工具，MSBuild 已经与 Visual Studio 集成，不需要其他工具。

还值得补充的是，MSBuild 几乎可以保证在所有新版本的[.NET](http://en.wikipedia.org/wiki/.NET_Framework)和 Visual Studio 发布后就可以使用，而 NAnt 可能会有一些滞后。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-10-25T13:53:55.827

我在我的[NAnt](http://en.wikipedia.org/wiki/NAnt)脚本调用 MSBuild 时都使用了这两种方法。我留在 NAnt 的主要原因是**孤立**。让我解释一下为什么我觉得这很重要：

1.  将依赖项添加到您的项目。NAnt 构建文件对 Visual Studio 来说是陌生的（在我的情况下，我认为这是一个专业人士），因此 Visual Studio 不会尝试对它做任何事情。MSBuild 任务是嵌入的，因此是解决方案的一部分，可以引用其他 MSBuild 任务。我从其他人那里收到了源代码，却发现我无法构建，因为没有安装 MSBuild 社区任务。我发现特别令人沮丧的是，Visual Studio 无法构建并抛出一堆错误，让我在调试时失去了时间。尽管没有 MSBuild 任务的一些额外内容，但请求的构建可能已经进行（例如作为调试构建）。简而言之：*如果可以避免的话，我不喜欢在我的项目中添加依赖项*。

2.  我不相信 Visual Studio，因为我可以扔掉它的开发团队。这可以追溯到 Visual Studio 的早期阶段，当时它会屠杀我的 HTML。例如，我仍然不使用设计器（在最近的一次会议上，我发现同事也这样做了）。我发现 Visual Studio 可以搞砸 DLL 文件中的依赖项和版本号（我无法复制这一点，但它确实在项目中始终如一地发生，并导致很多悲伤和浪费时间）。我采用了一个构建过程，它使用 Visual Studio 仅在调试模式下构建。对于生产，我使用 NAnt 以便从**外部**控制一切。如果我使用 NAnt 构建，Visual Studio 就不能再干扰了。

PS：我是一名网络开发人员，不进行 Windows 窗体开发。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-01-24T16:13:15.313

虽然我对 MsBuild 不是很熟悉，但我的印象是双方的一些关键差异可以通过添加来补充：

*   [MsBuildTasks](http://msbuildtasks.tigris.org/)
*   [南特贡献](http://nantcontrib.sourceforge.net/)

我最近不得不在 Nant 构建一个 Silverlight 项目。我发现如果我只是用 MsBuild 来做这件事，生活会更轻松——我最终从 Nant 脚本中调用了一个 MsBuild 任务，所以我想混合和匹配这两者并没有什么不寻常的。

除此之外，我想这将是个人喜好的问题 - 显然，如果这是你的事，你可以从 Visual Studio 中管理 MsBuild 的部分/大部分功能。如果您更喜欢手工编写脚本，Nant 似乎更灵活，更适合，如果您来自 Java 世界，您可能对它很熟悉。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-11T11:12:58.540

我最终都使用了。在重新设计我们的构建系统时，我遇到了一个棘手的问题。也就是说，我无法摆脱 .vcproj（和家庭），因为我们每个人都在使用 VS 来更新项目文件、设置和配置。因此，如果没有大量重复和容易出错的过程，我们就无法将构建系统基于一组新文件。

出于这个原因，我决定保留VS的'proj'文件并使用MSBuild（它们是MSBuild文件，至少VS2005和VS2008使用MSBuild项目文件）。对于其他一切（自定义配置、单元测试、打包、准备文档......）我使用了 NAnt。

对于持续集成，我使用了 CruiseControl。所以我们有触发 NAnt 作业的 CC 脚本，用于构建使用 MSBuild。

最后一点：MSBuild 不支持安装项目！因此，您只能调用 DevEnv.com 或直接使用 Visual Studio。这就是我最终做的事情，但我默认从所有解决方案配置中禁用了安装项目，因为开发人员通常不需要构建它们，如果他们这样做，他们可以手动选择构建它们。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-24T16:06:04.457

我最近从 NAnt 切换到了 MSBuild，因为它能够构建 VS 解决方案。不过，我仍然偶尔使用 NAnt。

您可能还想查看类似于 NAntContrib的[MSBuild 社区任务。](http://msbuildtasks.tigris.org/ "MSBuild 社区任务")

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-01-08T20:39:26.027

可用于 NAnt 的文档和教程使开始学习使用 NAnt 构建脚本变得更加容易。一旦我掌握了 NAnt 并创建了构建脚本，我就开始将这些知识转化为 MSBuild（我在 NAnt 中做了 X，我如何在 MSBuild 中做 X？）。Microsoft 的文档在有用之前通常假定具有相当高的知识水平。

从 NAnt 切换到 MSBuild 的原因是因为 MSBuild 更新。不幸的是，NAnt 的最后一个版本是在 2007 年 12 月 8 日，而 MSBuild 4.0 (.NET 4.0) 也离我们不远了。看起来 NAnt 项目已经死了。

如果您为刚开始学习使用 MSBuild 创建构建脚本的人找到了很好的文档，那么请跳过 NAnt 并直接使用 MSBuild。如果 NAnt 发布了新版本，那么我会考虑坚持使用 NAnt，但他们现在已经落后了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-07-14T11:51:01.337

我们两者都用。NAnt 负责所有“脚本”工作，例如复制、在[IIS](http://en.wikipedia.org/wiki/Internet_Information_Services)上部署、创建包，而 MSBuild 负责构建解决方案。然后我们可以通过新版本的 NAnt 避免不支持的 .NET 4.0 的问题。

NAnt 也更具可扩展性。如果我们想将部署脚本迁移到生产服务器，我们只需复制构建文件并安装正确版本的 .NET - csproj 文件没有 Visual Studio 问题:)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-05-25T08:40:53.420

[Manoj 的YDeliver](https://github.com/manojlds/YDeliver)是一个构建在 PSake 之上的构建框架。它具有一组丰富的库函数、定义工作流的能力，我们已经使用它将超过六个企业项目交付生产。

将它与[TeamCity](http://www.jetbrains.com/teamcity/)、[CruiseControl](http://en.wikipedia.org/wiki/CruiseControl)或任何可以运行[PowerShell](http://en.wikipedia.org/wiki/Windows_PowerShell)的东西结合使用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-10-18T13:04:23.240

我们使用 FlubuCore。它是一个开源 C# 库，用于使用 C# 代码构建项目和执行部署脚本。

如何使用flubu的简单示例：

```
protected override void ConfigureTargets(ITaskContext session)
{           

    var compile = session.CreateTarget("compile")
        .SetDescription("Compiles the solution.")
        .AddTask(x => x.CompileSolutionTask())
        .DependsOn("generate.commonassinfo");
} 
```

您可以在此处找到有关 Flubu 以及如何开始的更多信息： [choice-for-build-tool-msbuild-nant-or-something-else](https://stackoverflow.com/a/46776658/3118784)

# vb6 - (VB6) 将 32bit Long 转换为 String*6 [AZ]

> ID：476164
> 
> 赞同：0
> 
> 时间：2009-01-24T15:39:56.067
> 
> 标签：vb6, bit-manipulation

我希望将 32 位 Long 转换为 String*6，它只使用字符 [AZ]。

使用 VB6（不要问！）。

我计算出单个字母使用 5 位，所以我可以从 32 位长中得到 6 个字母。

谁能给我一个关于如何做到这一点的指针，因为我不知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T16:06:45.903

你的数学有严重缺陷。5 位 x 6 个字母 = 30 位，比您需要的少 2 位。另外，5 位需要 2 ^ 5 = 32 个代码，你只有 26 个（AZ）。鉴于您想要 AZ，您只能编码 4 位。这需要 32 / 4 = 8 个字母。如果你用十六进制编码，你会得到多少。

使用 Hex() 函数和 String*8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T17:15:11.070

> 单个字母使用 5 位

*   正确的

> 我可以从 32 位长中得到 6 个字母。

*   您可以将 6 个字母编码为 32 位长。

但这并不意味着您可以将每 32 位长度编码为 6 个字母。

因为 32^6 (1,073,741,824) < 2^32 (4,294,967,296)

这甚至假设每个字符有 32 个可能的值（5 位）。

26 个字母（小于 32 位）更糟糕：26^6 = 308,915,776

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T13:30:35.257

这两个功能应该让你接近你想要的。第一个使用数字和字母。只有第二个字母。MaxChar 是您要使用比例尺 01234567890ABCDEFGHIGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz 使用的字母数。Alpha only 不使用 0 到 9。

```
Public Function PackNumber(ByVal Value As Long, ByVal MaxChar As Integer, ByRef IsNeg As Boolean) As String
    Dim CurValue As Currency
    Dim CharValue As Integer
    Dim sPacked As String

    If Sgn(n) = -1 Then
        IsNeg = True
        CurValue = -Value
    Else
        IsNeg = False
        CurValue = Value
    End If

    sPacked = ""
    Do Until Abs(CurValue) <= MaxChar
        CharValue = MaxChar * ((CurValue / MaxChar) - Int(CurValue / MaxChar))
        CurValue = Int(CurValue / MaxChar)
        If CharValue < 10 Then
            sPacked = CharValue & sPacked
        ElseIf CharValue <= 36 Then
            sPacked = Chr(55 + CharValue) & sPacked
        Else
            sPacked = Chr(60 + CharValue) & sPacked
        End If
    Loop

    CharValue = CurValue
    If CharValue < 10 Then
        sPacked = CStr(CharValue) & sPacked
    ElseIf CharValue <= 36 Then
        sPacked = Chr(55 + CharValue) & sPacked
    Else
        sPacked = Chr(60 + CharValue) & sPacked
    End If

    PackNumber = sPacked
End Function 
```

仅 Alpha 函数

```
Public Function PackNumberAlphaOnly(ByVal Value As Long, ByVal MaxChar As Integer, ByRef IsNeg As Boolean) As String
    Dim CurValue As Currency
    Dim CharValue As Integer
    Dim sPacked As String

    If Sgn(Value) = -1 Then
        IsNeg = True
        CurValue = -Value
    Else
        IsNeg = False
        CurValue = Value
    End If

    sPacked = ""
    Do Until Abs(CurValue) <= MaxChar
        CharValue = MaxChar * ((CurValue / MaxChar) - Int(CurValue / MaxChar))
        CurValue = Int(CurValue / MaxChar)
        If CharValue <= 26 Then
            sPacked = Chr(65 + CharValue) & sPacked
        Else
            sPacked = Chr(70 + CharValue) & sPacked
        End If
    Loop

    CharValue = CurValue
    If CharValue <= 26 Then
        sPacked = Chr(65 + CharValue) & sPacked
    Else
        sPacked = Chr(70 + CharValue) & sPacked
    End If

    PackNumberAlphaOnly = sPacked
End Function 
```

# php - 您如何将表单的内容发布到它所在的页面？

> ID：476168
> 
> 赞同：0
> 
> 时间：2009-01-24T15:41:27.157
> 
> 标签：php, html

在 Yahoo 或 Google 以及许多网站中，当您填写表格时，如果您的表格有任何错误，它会被重定向到同一页面。请注意，表单中的数据保持原样。我的意思是文本字段中的数据保持不变。我试过 ‹form action="(same page here)" method="post or get"›。它被重定向到页面，但表单的内容被清除。我希望显示数据。

如果用户忘记选中接受条款和条件复选框，他必须再次填写整个表单，您知道这对用户来说是多么令人厌烦。需要帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T15:44:31.037

你需要自己做这件事。当页面发布后，您将可以访问用户通过 $POST['...'] 输入的所有表单值。然后，您可以使用此数据重新填充表单字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T15:45:12.517

这不是自动完成的。他们从 post / get 获取值，然后将用户键入的值分配给模板。您看到的是从处理用户值的脚本生成的 html。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T15:48:29.873

如果你把你的表单和表单数据处理放在同一个脚本里，你可以很方便的打印出表单中已经输入的数据，例如：

```
$valid = false;
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    if (isset($_POST['name']) && $_POST['name'] == 'Hugo') {
        $valid = true;
    } else {
        echo '<p>Seriously, you have to enter "Hugo"!</p>';
    }
    // more data processing
    if ($valid) {
        echo '<p>Everything’s fine!</p>';
    }
}
if (!$valid) {
    echo '<form action="" method="post">';
    echo '<p>Please enter "Hugo": <input type="text" name="name" value="', (isset($_POST['name']) ? htmlspecialchars($_POST['name']) : ''), '"></p>';
    echo '<p><input type="submit"></p>';
    echo '</form>';
} 
```

好吧，这不是一个很好的例子，但这就是它的工作原理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T15:49:00.480

许多框架为您完成这项工作，所以不要浪费您的时间手动执行此操作

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T16:06:15.547

这是我用于*非常*简单的网站的修改版本，我不想/不需要整个框架来完成工作。

```
function input($name, $options = array()) {
    if(!isset($options['type'])) $options['type'] = 'text';

    $options['name'] = $name;

    if(isset($_POST[$name]) && $options['type'] != 'password') {
        $options['value'] = htmlspecialchars($_POST[$name]);
    }

    $opts = array();    
    foreach($options as $key => $value) {
        $opts[] = $key . '="' . $value . '"';
    }

    return '<input ' . implode(' ', $opts) . '/>';
} 
```

（我对`<select`> 等有一些类似的功能`<textarea>`）

当您构建字段时，您可以执行以下操作：

```
First Name: <?=input('first_name')?>
Last Name: <?=input('last_name')?>
Password: <?=input('password', array('type' => 'password'))?> 
```

如果您在与表单本身相同的页面中处理表单，如果有任何错误，它们将自动填写。不过，大多数框架都会为您完成所有这些工作（并且以比上面的代码更好的方式），我个人建议[`CakePHP`](http://cakephp.org/)或[`CodeIgniter`](http://codeigniter.com/).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T15:43:12.880

您必须检查同一文件中的数据，如果正确，则重定向到正确的位置。然后您可以使用用户发布的 $_POST 或 $_GET 信息，他可以修复错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-24T15:47:45.927

您可以使用两种方法（它们不是相互排斥的）：

*   在用户提交表单*之前*，使用 JavaScript 帮助用户。这样，您可以节省到服务器的往返行程。你要求什么：
*   在表单中，`value`使用从服务器发回的数据填充字段的属性。例如：您发送一个字段`name`，您在 PHP 中将其作为 $_POST['name'] 获得（假设您使用`method='post'`了 。如果您发送回数据并修改该字段添加`value='<?php $_POST['name']; ?>`，您应该取回您的数据。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-24T16:18:22.853

如果您使用的是模板或框架系统（我已将 Smarty 引擎合并到我的几个项目中），您通常可以调整模板，以便它们在检测`$_POST[$variable]`到与其字段对应的值已设置时自动用值填充字段.

至于密码，据我所知（我可能是错的）：这是一种约定，可以最大限度地减少通过网络发送密码的时间，从而缩小可能嗅探的任何人的窗口文本。将密码字段留空只是一个好习惯，仅此而已。

# c - 正则表达式提取 C 函数原型声明？

> ID：476173
> 
> 赞同：26
> 
> 时间：2009-01-24T15:44:23.453
> 
> 标签：c, regex, function

当涉及到正则表达式时，我处于学习曲线的某个位置，我需要使用它们来自动修改一堆 C 头文件中的函数原型。有谁知道一个体面的正则表达式可以在 C 标头中找到任何和所有函数原型，同时排除其他所有内容？

编辑：最初不清楚的三件事：

1.  我**不**关心 C++，只关心 C。这意味着无需担心模板等。
2.  该解决方案必须与 typedef 和结构一起使用，不仅限于基本的 C 类型。
3.  这是一种一次性的事情。它不需要很漂亮。只要它有效，我不在乎它有多少杂乱无章，但我不想要一个复杂、难以实施的解决方案。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-24T16:08:21.753

[您可以使用ANSI C yacc/lex 语法](http://www.lysator.liu.se/c/ANSI-C-grammar-y.html)实现解析器。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-24T16:18:47.003

要正确执行此操作，您需要根据 C 语言语法进行解析。但是，如果这仅适用于 C 语言并且仅适用于头文件，那么也许您可以采取一些捷径并在没有完全成熟的 BNF 的情况下度过难关。

```
^
\s*
(unsigned|signed)?
\s+
(void|int|char|short|long|float|double)  # return type
\s+
(\w+)                                    # function name
\s*
\(
[^)]*                                    # args - total cop out
\)
\s*
; 
```

这绝不是正确的，需要工作。但它可以代表一个起点，如果你愿意付出一些努力并改进它。它可以被跨越行的函数定义、函数指针参数、宏以及可能许多其他东西破坏。

请注意，BNF*可以*转换为正则表达式。这将是一个大而复杂的正则表达式，但它是可行的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-24T17:13:55.537

对于一次性练习，您可能最好从简单开始并查看您必须扫描的代码。选择三个最差的标题，生成一个正则表达式或一系列正则表达式来完成这项工作。您必须决定是否以及如何处理包含函数声明的注释（实际上，处理包含注释的函数声明）。处理：

```
extern void (*function(int, void (*)(int)))(int); 
```

（可能是标准 C 函数`signal()`）在正则表达式中很困难，因为嵌套的括号。如果您没有任何这样的函数原型，那么花时间研究如何处理它们就是浪费时间。类似的注释适用于指向多维数组的指针。很有可能你有风格惯例来简化你的生活。您不得使用 C99 (C++) 注释；你不需要围绕它们编写代码。您可能不会将多个声明放在一行中，无论是否使用通用类型 - 所以您不必处理它。

```
extern int func1(int), func2(double); double func3(int);  // Nasty! 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-08-24T16:04:59.920

这是一个正则表达式，它是查找 C 函数名称的良好起点：

```
^\s*(?:(?:inline|static)\s+){0,2}(?!else|typedef|return)\w+\s+\*?\s*(\w+)\s*\([^0]+\)\s*;? 
```

这些是验证表达式的一些测试用例：

```
// good cases
static BCB_T   *UsbpBufCtrlRemoveBack   (BCB_Q_T *pBufCtrl);
inline static AT91_REG *UDP_EpIER               (UDP_ENDPOINT_T *pEndpnt);
int UsbpEnablePort (USBP_CTRL_T *pCtrl)
bool_t IsHostConnected(void)
inline AT91_REG *UDP_EpCSR (UDP_ENDPOINT_T *pEndpnt)

// shouldn't match
typedef void (*pfXferCB)(void *pEndpnt, uint16_t Status);
    else if (bIsNulCnt && bIsBusyCnt)
            return UsbpDump(Buffer, BufSize, Option); 
```

最后，这是一个简单的 TCL 脚本，用于读取文件并提取所有函数原型和函数名称。

```
set fh [open "usbp.c" r]
set contents [read $fh]
close $fh
set fileLines [split $contents \n]
set lineNum 0
set funcCount 0
set funcRegexp {^\s*(?:(?:inline|static)\s+){0,2}(?!else|typedef|return)\w+\s+\*?\s*(\w+)\s*\([^0]+\)\s*;?}
foreach line $fileLines {
    incr lineNum
    if {[regexp $funcRegexp $line -> funcName]} {
        puts "line:$lineNum, $funcName"
        incr funcCount
    }; #end if

}; #end foreach
puts "$funcCount functions found." 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-09-09T22:44:41.043

假设您的代码的格式类似于

```
type name function_name(variables **here, variables &here)
{
    code
} 
```

这是 Powershell 的单行代码：

```
ls *.c, *.h | sls "^(\w+( )?){2,}\([^!@#$+%^]+?\)" 
```

返回结果如下：

```
...
common.h:37:float max(float a, float b)
common.h:42:float fclamp(float val, float fmin, float fmax)
common.h:51:float lerp(float a, float b, float b_interp)
common.h:60:float scale(float val, float valmin, float valmax, float min,
float max)
complex.h:3:typedef struct complex {
complex.h:8:double complexabs(complex in)
complex.h:13:void complexmult(complex *out, complex a, complex b)
complex.h:20:void complexadd(complex *out, complex a, complex b)
complex.h:27:int mandlebrot(complex c, int i)
... 
```

要*仅*查看没有文件详细信息的行，请添加`format-table -property line`（或缩写为`ft -p line`）：

```
ls *.c, *.h | sls "^(\w+( )?){2,}\([^!@#$+%^]+?\)" | format-table -p line 
```

返回：

```
Line
----
void render(SDL_Surface *screen)
void saveframe(SDL_Surface *screen)
int handleevents(SDL_Surface *screen)
int WinMain(/*int argc, char* args[]*/)
void printscreen(SDL_Surface *screen, unsigned int exclude)
void testsection(char name[])
void sdltests(SDL_Surface *screen, SDL_Window *window, int width, int height)
int WinMain(/*int argc, char *argv[]*/)
int random(int min, int max) {
int main(int argc, char *argv[]) 
```

奖金：正则表达式的解释：

```
^(\w+(\s+)?){2,}\([^!@#$+%^]+?\)
^                                Start of a line
 (         ){2,}                 Create atom to appear to or more times
                                 (as many as possible)
  \w+(\s+)?                      A group of word characters followed by
                                 an optional space
                \(            \) Literal parenthesis containing
                  [^!@#$+%^]+?   A group of 0 or more characters
                                 that AREN'T in “!@#$+%^” 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-05T00:10:56.567

单行正则表达式听起来很难。我个人为此使用 perl 脚本。这很容易。基本方法是> 1.调用你最喜欢的c预处理器来消除注释并扩展宏。（所以更容易） 2\. 计算'{' '}' 符号。对于纯 C 中的函数，它们具有可预测的行为，可让您检测函数名称。3\. 在原始源中查看函数名称（在预处理以获取具有 typedef 的签名之前）这是一种效率低下的方法，但对我来说效果很好。第 1 步并不是真正必要的，但它会让您的生活更轻松

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-19T05:45:58.633

假设您将整个 c 文件读入 $buffer。* 首先创建正则表达式，用相同数量的空格和换行符替换所有注释，这样行和列位置不会改变 * 创建可以处理带括号的字符串的正则表达式 * 然后像这样的正则表达式找到函数：(static|)\s+(\w+ )\s*$圆括号正则表达式+*{

此 reg exp 不处理函数定义使用预处理器指令的函数。

如果你选择 lex/yacc，你必须结合 ansic 和预处理器语法来处理函数定义中的那些预处理器指令

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-12T08:52:40.447

作为伟大的[院长 TH 答案的继续](https://stackoverflow.com/a/45866339/5923666))

这会发现

*   只有函数而不是声明
*   和返回指针的函数

`^([\w\*]+( )*?){2,}\(([^!@#$+%^;]+?)\)(?!\s*;)`

# .net - 将 ADO.NET 数据表添加到空白 MDB 文件

> ID：476180
> 
> 赞同：0
> 
> 时间：2009-01-24T15:47:16.473
> 
> 标签：.net, ms-access, ado.net, datatable, dataset

如何将我在代码中构建的多个数据表添加到我的应用程序附带的空白 MDB 文件中？

我发现通过 OledbConnection 对象连接到 MDB 文件很容易，但是我无法找到一种简单的方法来向其中添加我的表。它坐在那里，空旷而空旷，但接下来是什么？

我可以很容易地将我的表添加到数据集，但我仍然看不到将数据集映射到我打开的 MDB 文件的简单方法。

我错过了一个简单的解决方法吗？如果可能，我想避免使用[ADOX 。](http://msdn.microsoft.com/en-us/library/ms803875)我还看到将数据集写成 XML 非常容易，但我发现没有类似的功能可以写出 MDB 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-24T16:10:25.617

DataSet 本质上理解 XML 存储，您可能会（非常松散地）将其视为其本机数据存储。事实上，XML 存储用于临时或晶体管存储，以便在应用程序重新启动或机器之间传输之间可以重新构建 DataSet。

另一方面，真正的持久性存储，如 MDB、SQL Server、Oracle 或其他任何与数据集完全不同的东西，这就是为什么您需要提供者特定的适配器来将数据传输到数据集和从数据集传输数据。

除非您在需要创建自己的代码来分析数据集架构然后将 DDL 发送到您的 MDB 连接以创建表之前，可以在网络领域找到一个有人已经完成此操作的项目。

# php - 如何使用 PHP 之类的方法在 ASP.net 中编程

> ID：476186
> 
> 赞同：0
> 
> 时间：2009-01-24T15:49:43.787
> 
> 标签：php, asp.net, sql, database

我是一名 PHP 程序员，我想使用可视化 Web 开发人员 .net 开发一个网站。我知道 asp.net 在处理数据库方面有许多不同的方法。但是，我更熟悉 PHP 编程方式，例如：

```
$query = "select * from table where user_id > 2"
$result = mysql_query($query);

while($row = mysql_fetch_array($result)){

echo "username is: ".$row["username"]."<br>"; } 
```

问题是“我可以用 PHP 方式处理 asp.net 吗？”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T15:52:23.203

当然...学习 C#（有点类似的语法）或使用以下方法之一进行开发：

*   [PHP4单声道](http://php4mono.sourceforge.net/)
*   [PHP4Apps](http://www.codeproject.com/csharp/php4apps.asp)
*   [PHP 夏普](http://www.akbkhome.com/wiki.php/Projects/PHP_Sharp)
*   [PHP Mono 扩展](http://www.php.net/~sterling/mono/)
*   [帕朗厄尔](http://www.codeplex.com/Wiki/View.aspx?ProjectName=Phalanger)
*   [IronPHP](http://ironphp.sourceforge.net/)

[其他 .NET 支持的语言](http://www.dotnetpowered.com/languages.aspx)

我对你的诚实建议是，如果你想开发一般的 ASP.NET 或 .NET，你应该学习 C#。我做到了，我很高兴做到了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T16:01:38.473

也许你应该考虑你的编程方式。混合逻辑、表示和数据访问在任何语言中都不是一个好主意。您展示的示例不是“PHP方式”。是的，可以在 php 中这样写，但这不是一个好习惯。我认为通过学习 asp.net，你也可以学到很多关于编程的知识，你真的不应该尝试在 asp 中那样编程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T16:13:45.470

C# 3.0 提供了非常强大的语法，允许您以既自然又安全的方式与数据库交互（使用参数化查询）。您在 C# 中使用 LINQ2SQL 的查询如下所示：

```
var query = from t in context.table
            where t.user_id > 2
            select t; 
```

您可能会在视图中使用中继器，因此您可以在代码隐藏中提供查询作为数据源（也可以在标记中执行此操作）。

```
// use ToList so context can be disposed
nameRepeater.DataSource = query.ToList(); 
```

您的标记如下所示：

```
<asp:Repeater runat="server" ID="nameRepeater">
   <ItemTemplate>
   username is:
   <asp:Label runat="server" 
              ID="nameLabel"
              Text='<%= Bind("username") %>' />
   <br />
</asp:Repeater> 
```

（为了便于阅读，分行）

或者您可以使用 ASP.NET MVC，在这种情况下，选择代码将在您的控制器中，您可以在强类型视图中使用更像 PHP 语法的东西。

```
<% foreach (Table t in ViewData.Model) { %>
   username is: <%= t.username %><br/>
<% } %> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T16:09:29.380

asp.net中有很多方法。这有点令人困惑，但它们都基本相同。不同之处在于您使用的数据访问类型。

使用 Enterprise Library（你需要下载这个）可能是最接近的方法之一：

```
Database database = DatabaseFactory.CreateDatabase();
string sqlCommand = @"SELECT * FROM Users WHERE UserID=@UserID";
System.Data.Common.DbCommand dbCommand = database.GetSqlStringCommand(sqlCommand);

DataSet dataSetGroup = database.ExecuteDataSet(dbCommand);
DataTable dt = dataSetGroup.Tables[0];

foreach (DataRow dr in dt.Rows)
{
    Response.Write("User name is: " + dr["Username"].ToString() + "<br/>");
} 
```

Enterprise Library 只是一个简化数据访问的 Microsoft 库。如果您不使用它，您可以直接访问数据库，但它需要多行几行来处理数据连接的打开和关闭，并且您必须更加小心打开和关闭连接。

其他方法是：

1.  使用强类型数据集
2.  使用 LinqToSql 或 LinqToEntities 和 ADO.net 框架

它们都不同但结构相似，您将在其中查询数据库，然后执行 foreach（您也可以使用 while）来循环数据。

我最近一直在使用 LinqToSql，并且更喜欢这种方法。Scott Gu 的博客有一系列很好的关于如何使用 LinqToSql 的文章（链接到上一篇文章，所以你可以看到以前的所有文章）： [http ://weblogs.asp.net/scottgu/archive/2007/09/07/ linq-to-sql-part-9-using-a-custom-linq-expression-with-the-lt-asp-linqdatasource-gt-control.aspx](http://weblogs.asp.net/scottgu/archive/2007/09/07/linq-to-sql-part-9-using-a-custom-linq-expression-with-the-lt-asp-linqdatasource-gt-control.aspx)

# python - 我在哪里可以获得我的 django 应用程序的 wiki 格式化小部件？

> ID：476187
> 
> 赞同：2
> 
> 时间：2009-01-24T15:49:59.323
> 
> 标签：python, django, wiki

我正在为我的 django 应用程序寻找一个 wiki 格式化小部件，就像我用来在 stackoverflow 中输入这个问题一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T19:42:30.790

这个问题有两个部分。如果您正在寻找客户端 Javascript WYSIWYG（或 WYSIWYM）编辑器小部件，那与 Django 无关，WMD 是一个不错的选择（尽管我个人更喜欢[MarkItUp！](http://markitup.jaysalvat.com)）。

如果您正在寻找等式的服务器端（Django）部分，您可以查看[django-markitup](http://www.bitbucket.org/carljm/django-markitup)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T18:02:19.773

Stack Overflow 使用[WMD](http://wmd-editor.com/)进行编辑。这是**Markdown**语言的编辑器，虽然不是*严格*的 wiki 标记，但非常接近。[此处](http://github.com/derobins/wmd/tree/master)
提供了未混淆的 WMD 堆栈溢出版版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-11T20:43:46.157

你可以查看我的 Django CMS 插件，它添加了 Trac wiki 语法（支持 Trac 宏）：

[https://bitbucket.org/mitar/cmsplugin-markup-tracwiki](https://bitbucket.org/mitar/cmsplugin-markup-tracwiki)

# ssms - 使用 Windows 身份验证时，如何在 SQL Server management Studio 2008 中手动输入我的凭据？

> ID：476188
> 
> 赞同：5
> 
> 时间：2009-01-24T15:50:46.170
> 
> 标签：ssms, ntlm

通常，当使用 Windows 身份验证时，软件（例如 Internet Explorer）会尝试使用 Windows 身份验证，如果它不成功（例如，因为域不受信任，或者因为凭据不正确），它只会弹出一个登录窗口，以便您可以输入您的域、登录名和密码。

使用 sql Server Management Studio 2008，如果我选择“Windows 身份验证”，登录/密码框会自动填充我当前的凭据，如果我尝试登录，它会显示：

* * *

登录失败。登录来自不受信任的域，不能用于 Windows 身份验证。（Microsoft SQL Server，错误：18452）

* * *

我从来没有机会在服务器域上输入我的凭据...

我知道我可以通过在我的计算机上加入域或启用“sql server authentication”来解决这个问题，但这不是我想要的:)

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-24T15:59:25.560

试试这个：[使用 RUNAS 为数据库连接设置 Windows Auth 域](http://weblogs.asp.net/jgalloway/archive/2007/09/07/tip-use-runas-to-set-your-windows-auth-domain-for-database-connections.aspx)

```
runas /user:domain\user “C:\Program Files\Microsoft SQL Server\90\Tools\Binn\VSShell\Common7\IDE\ssmsee.exe” 

runas /user:domain\user “C:\WINDOWS\system32\mmc.exe /s \”C:\Program Files\Microsoft SQL Server\80\Tools\BINN\SQL Server Enterprise Manager.MSC\”" 

runas /user:domain\user isqlw 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T15:53:36.103

受信任的身份验证将使用您登录机器​​的凭据来尝试连接，没有办法解决这个问题，如果您想对管理工作室使用受信任的身份验证，您需要使用一个帐户登录到您的机器允许访问 SQL，如果不允许，则必须使用 SQL 身份验证。

**编辑：**正如 Gulzar 所发布的，RunAs 将是一个明确的解决方案。

# jquery - jQuery-textarea换行时调用函数？

> ID：476192
> 
> 赞同：2
> 
> 时间：2009-01-24T15:52:59.897
> 
> 标签：jquery, textarea

当文本换行到新行时，我想增加 textarea 的高度，因此它可以动态扩展为所需的任何内容。我不想使用 onscroll 事件，因为我希望扩展总是比滚动提前一步，所以 textarea 在达到最大高度 x 之前永远不会滚动。

无论如何我可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T16:00:18.587

[已经存在](http://plugins.jquery.com/search/node/textarea+type%3Aproject_project+resizing+OR+growing+OR+expanding+-spelling+-pull+%22textarea%22)许多执行此操作的插件。他们可能不做 maxheight 交易，但您可以将其添加到：

```
if ($(this).height() >= maxHeight) {
  return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T15:58:33.237

我不知道换行时发生的任何事件，您可以只使用按键或更改功能并计算自上次换行以来输入的字符，如果超过给定数量，您可以增加文本区域的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-06T19:07:05.547

我刚决定使用这个插件：http: [//blogs.sitepointstatic.com/examples/tech/textarea-expander/demo.html](http://blogs.sitepointstatic.com/examples/tech/textarea-expander/demo.html)

# c# - 两种方式客户端服务器网络通信

> ID：476211
> 
> 赞同：7
> 
> 时间：2009-01-24T16:08:10.253
> 
> 标签：c#, wcf, networking

我正在考虑使用 winforms 或 WPF 在 C# 中构建客户端服务器应用程序。客户端应用程序必须是本地应用程序，因为它必须与专用硬件交互。

我正在寻找的架构是客户端使用 TCP/IP 连接到服务器端口。然后客户端将向服务器发出请求，服务器将向客户端发送响应。当用户登录时，客户端将保持与服务器的连接。

我查看了 Web 服务，据我所知，WCF 扩展了 Web 服务，这意味着服务器无法向客户端发送消息。

我对 WCF 的看法不正确吗？如果不是，最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T16:22:29.367

WCF 支持[双工消息传递](http://geekswithblogs.net/claeyskurt/archive/2007/09/05/115169.aspx)，这应该可以满足您的需要。

另请参阅：http: [//msdn.microsoft.com/en-us/library/cc645027 (VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc645027(VS.95).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T17:29:54.893

尝试阅读[Juval Lowy 的这篇文章，](http://msdn.microsoft.com/en-gb/magazine/cc163537.aspx)这是对 WCF 消息传递问题的精彩讨论。他提供了一种替代双工的方法，即他的 pub-sub 框架。我将不得不推荐你也购买他的 WCF 书。他是我在任何主题上遇到的最好的技术作者之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T17:37:35.817

谢谢。这正是我想要的。我也找到了两个非常有用的解决方案：http:
[//www.codeproject.com/KB/WCF/WCF_Duplex_UI_Threads.aspx](http://www.codeproject.com/KB/WCF/WCF_Duplex_UI_Threads.aspx)
[http://www.thoughtshapes.com/WCF/ExampleThree.htm](http://www.codeproject.com/KB/WCF/WCF_Duplex_UI_Threads.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T18:06:58.923

我知道 WCF 是蜜蜂的膝盖和所有 - 但我可能只是做一个 TcpServer 和 TcpClient 对。再说一次，也许我是唯一一个认为 WCF 对于 80% 的情况来说太复杂的人。

再说一次，如果您有不同的客户端或服务器或其他东西 - 您可能需要查看 WCF。但是，对于简单的网络套接字——嗯，我们已经在没有 WCF 的情况下进行了多年的套接字编程，并且已经做得很好。

# c++ - C++中long double的精度是多少？

> ID：476212
> 
> 赞同：26
> 
> 时间：2009-01-24T16:08:20.817
> 
> 标签：c++, precision, long-double

有谁知道如何找出`long double`特定平台上的精度？我似乎在 17 位十进制数字后失去了精度，这与我刚使用`double`. 我希望得到更多，因为`double`在我的平台上用 8 个字节表示，而用`long double`12 个字节表示。

在你问之前，这是针对欧拉计划的，所以是的，我*确实*需要超过 17 位数字。:)

**编辑：**感谢您的快速回复。我刚刚确认在我的系统上使用只能获得 18 位十进制数字`long double`。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-24T16:13:29.760

您可以通过以下方式找到`std::numeric_limits`：

```
#include <iostream>     // std::cout
#include <limits>       // std::numeric_limits
int main(){
    std::cout << std::numeric_limits<long double>::digits10 << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-24T16:17:21.670

您可以使用[<cfloat>](http://www.cplusplus.com/reference/clibrary/cfloat/)。具体来说：

```
LDBL_DIG 
```

# sql - sql to linq中的if存在语句

> ID：476214
> 
> 赞同：28
> 
> 时间：2009-01-24T16:08:40.580
> 
> 标签：sql, sql-server, linq

以下语句的 linq 等效项是什么？

```
IF NOT EXISTS(SELECT UserName FROM Users WHERE UserName='michael')
BEGIN
INSERT INTO Users (UserName) values ('michael');
END 
```

您还可以推荐任何 sql-to-linq 转换器吗？我目前正在使用 LINQPad，它在编写 linq 代码方面做得很好，您还可以在其中看到生成的 sql 代码，但是当我单击小 linq 符号时，什么都没有显示。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-24T16:25:01.750

由于 LINQ 语法和扩展方法不支持插入，因此无法在 LINQ2SQL 中使用单个语句来完成。以下（假设一个名为的数据上下文`db`）应该可以解决问题。

```
 if (!db.Users.Any( u => u.UserName == "michael" ))
 {
      db.Users.InsertOnSubmit( new User { UserName = "michael" } );
      db.SubmitChanges();
 } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-02T21:37:34.060

实现 tvanfosson 解决方案的扩展方法：

```
 /// <summary>
  /// Method that provides the T-SQL EXISTS call for any IQueryable (thus extending Linq).
  /// </summary>
  /// <remarks>Returns whether or not the predicate conditions exists at least one time.</remarks>
  public static bool Exists<TSource>(this IQueryable<TSource> source, Expression<Func<TSource, bool>> predicate)
  {
     return source.Where(predicate).Any();
  }

  /// <summary>
  /// Method that provides the T-SQL EXISTS call for any IQueryable (thus extending Linq).
  /// </summary>
  /// <remarks>Returns whether or not the predicate conditions exists at least one time.</remarks>
  public static bool Exists<TSource>(this IQueryable<TSource> source, Expression<Func<TSource, int, bool>> predicate)
  {
     return source.Where(predicate).Any();
  } 
```

然后将使用扩展方法：

```
 bool exists = dataContext.Widgets.Exists(a => a.Name == "Premier Widget"); 
```

尽管 .Where().Any() 组合足够有效，但它确实有助于代码呈现的逻辑流程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-30T17:00:45.583

将 Exists 代码放在静态类中。例如，在您的项目中添加一个类，例如：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Linq.Expressions;

namespace company.project
{
   static class LinqExtensions
    {
        /// <summary>
        /// Method that provides the T-SQL EXISTS call for any IQueryable (thus extending Linq).
        /// </summary>
        /// <remarks>Returns whether or not the predicate conditions exists at least one time.</remarks>
        public static bool Exists<TSource>(this IQueryable<TSource> source, Expression<Func<TSource, bool>> predicate)
        {
            return source.Where(predicate).Any();
        }

        /// <summary>
        /// Method that provides the T-SQL EXISTS call for any IQueryable (thus extending Linq).
        /// </summary>
        /// <remarks>Returns whether or not the predicate conditions exists at least one time.</remarks>
        public static bool Exists<TSource>(this IQueryable<TSource> source, Expression<Func<TSource, int, bool>> predicate)
        {
            return source.Where(predicate).Any();
        }

    }
} 
```

不要忘记将此类的命名空间添加到使用它的任何其他类中。;P

# .net - 从函数返回错误的最佳实践是什么？

> ID：476217
> 
> 赞同：1
> 
> 时间：2009-01-24T16:09:54.870
> 
> 标签：.net, error-handling

当我需要从函数返回错误消息时，我通常会执行以下示例的操作，如果没有发生错误，我只返回一个空字符串。这是最佳实践，还是有从函数返回错误消息的替代方法？

```
Function Test() as String
  ' Do something
  If error occured Then   
    Return "Some error message"
  Else   
    Return ""    
End Functon 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-24T16:14:14.220

您应该抛出包含错误消息的异常，而不是返回错误消息。

这是一个快速概述：[http ://www.vbdotnetheaven.com/UploadFile/rajeshvs/dotnetException04162005022135AM/dotnetException.aspx](http://www.vbdotnetheaven.com/UploadFile/rajeshvs/dotnetException04162005022135AM/dotnetException.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-24T16:15:24.077

[异常处理](http://msdn.microsoft.com/en-us/library/ms229005.aspx)是处理错误的首选方法。使用您的函数的开发人员可能会忽略错误代码返回值。例外情况迫使他们注意。绝对值得学习。

当您在问题中编写代码时，您可能假设它会这样调用：

```
String message = Test();
// process the message for errors. 
```

许多开发人员会绕过处理消息，甚至像这样调用您的函数：

```
Test();
// go about your business, happily ignoring the error message 
```

如果您的代码改为抛出异常，则不能忽略它。开发人员至少必须通过在函数调用周围放置一个 try 块来确认引发了异常。在这一点上，他们被迫用它*做点什么*。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-24T16:21:04.707

正如 Erik 和 Bill 所说，异常是在 .NET 中传播错误的正常方式。但是，在某些情况下它们是不合适的——例如验证用户输入。那时有几种选择：

*   使用错误代码（例如枚举）来指示错误的类型。例如，您可能有一个代码用于“密码太短”，而另一个代码用于“密码不包含任何数字”等。

*   按照您在问题中建议的方式使用错误消息。我个人会为“没关系”的情况使用空引用，或者可能使该方法返回一个布尔值（有效/无效）并为错误消息提供一个输出参数。使用字符串对于国际化来说很糟糕，但在许多方面比错误代码版本更简单（避免额外的查找，更容易添加一种新的错误等）。对于永远不需要国际化的内部应用程序来说，这可能很好。

我强调，这些*只是*例外没有意义的选项——否则，例外是要走的路。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T16:48:26.693

请求-响应模式可以帮助处理错误以及可能失败的多种方式。例如，在信用卡身份验证过程中，您可能有：

```
class CreditCardAuthenticationRequest {
    string CreditCardNumber;
    string FullName;
    ...
}

class CreditCardAuthenticationResponse {
    CreditProcessorStatusCode Status;
    CreditProcessorWarnings[] Warnings;
    CreditProcessorErrors[] Errors;
    Exception Exception;
    ...
} 
```

现在突然之间，您所有的错误处理和验证都可以包含在一个简洁的小包中。DoFactory.com的[Patterns in Action 示例应用程序广泛使用了这一点。](http://www.dofactory.com/Framework/Framework.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T16:20:21.383

我同意，一般来说，当方法不会返回值时，您会希望对错误使用异常。但是，如果该方法确实返回了一个值，那么您可以并且也许应该在某些情况下使用该返回值。例如，如果您尝试从键控集合中检索对象并且键不存在，则返回 null 作为不存在的证据而不是引发异常是完全合理的。但是，您的情况似乎不适合这种情况，我会例外。

# javascript - “a= object,object”的 Javascript 语法

> ID：476218
> 
> 赞同：2
> 
> 时间：2009-01-24T16:10:17.880
> 
> 标签：javascript, syntax

昨天我发现了这个功能：

```
function clone(obj) {
    return typeof obj === 'undefined' ?
        this : (clone.prototype = Object(obj), new clone);
} 
```

我虽然在 Javascript 中看到了很多，但这种语法对我来说是未知的：

```
 clone.prototype = Object(obj), new clone 
```

有人可以解释我如何阅读这个吗？你能给我链接到正确的定义吗？我在 Mozilla 的 MDC 中找不到它，也不知道如何在网上找到它，但这是我第一次看到这种语法。感谢您在这里的努力。

最终解决方案：

我根据这里的答案做了一些测试，我发现了：

```
var b;
b=alert('test'),6;
alert(b);  // alert undefined
b=5,alert('test2');
alert(b);  // alert 5 
```

感谢 christoph 研究，我们发现了更多：

```
var a, b, c;
a = 1, 2;   // a is 1
(b = 1), 2; // b is 1 - same as above!
c = (1, 2); // c is 2 
```

啊，我也在 IE6 上对其进行了测试，它可以工作，所以这必须是非常古老的语法并且没有关于它的信息？：（ 奇怪的...

你们俩都给出了很好的解决方案，在这里感谢您的解决方案！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-24T16:17:06.227

[MDC 的逗号运算符](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Expressions_and_Operators#Comma_operator)：

> 逗号运算符 (,) 只计算其两个操作数并返回第二个操作数的值。

在这种情况下，它确实像调用此函数一样工作：

```
function() {
   clone.prototype = Object(obj);
   return new clone;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T16:54:12.050

由于运算符优先级，您的“最终解决方案”会产生意想不到的结果。以下示例可能有助于澄清问题：

```
var a, b, c;
a = 1, 2;   // a is 1
(b = 1), 2; // b is 1 - same as above!
c = (1, 2); // c is 2 
```

还要注意

```
var a = 1, 2; 
```

产生语法错误！

# macos - os X 上的 mpirun

> ID：476221
> 
> 赞同：4
> 
> 时间：2009-01-24T16:11:56.003
> 
> 标签：macos, osx-leopard, mpi, openmpi

有没有办法在 os X leopard(10.5.6) 上本地运行超过 62 个进程的本地 mpi 作业。当我用 62 个进程运行作业时，它死了

```
$mpirun -np 62 a.out 
mpirun noticed that job rank 0 with PID 0 on node Macintosh-001D4F4BC6BC.private exited on signal 15 (Terminated). 
60 additional processes aborted (not shown) 
```

当我用 61 个进程运行它时，它运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T17:44:44.460

为了回应我的评论，我进行了一些谷歌搜索，我怀疑这是由操作系统设置的资源限制引起的。此外，倍数 2 附近的故障是可疑的。我最好的猜测是 mpi 库中的某些东西（可能是 MPI_Send）正在产生额外的进程，这些进程超过了 266 的限制（参见 ulimit -a）。

# php - 非常先进的 Javascript 所见即所得编辑器

> ID：476222
> 
> 赞同：0
> 
> 时间：2009-01-24T16:12:05.240
> 
> 标签：php, javascript, jquery, dhtml

我需要一个解决方案，用户可以在我的系统中输入网页的 URL。该页面将加载，然后用户可以单击他想要更改的某个部分。所以基本上我需要的是一种在我的应用程序中显示网页的方法（可以用框架完成，但我不希望有水平滚动条），然后是另一种让用户选择文本块的方法或页面元素。

即，如果一个文本块在 a 中`div`，悬停在文本上方会使用微弱的绿色勾勒出该 div（悬停会删除此边框/轮廓），单击文本会在其周围绘制一个实心绿色边框以显示其被选中，然后我页面上的一些内容将显示 div 的 id，并让用户指定我需要的其他一些信息。

因此，我可能需要一种方法来获取所有`<div>s`, `<table>s`,`<span>s`和`<p>s`任何其他“容器”标签，然后能够使它们悬停/单击以更改其`style.border`属性，并能够检索其 ID/名称，

对于一块文本，边框可能会起作用，但是图像之类的呢？另外，如果 a`<div>`没有 ID/名称，如何指定它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T17:41:04.343

您可以使用`<iframe>`标签，然后设置`contentEditable = on`. 这样，浏览器就提供了所见即所得的功能。但是，边界等可能不起作用。一些代码：

```
var idno = 0;

function addEditor(parent, url) {
    parent.innerHTML += '<iframe src="' + url + '" id="edit' + idno + '"></iframe>';
    var el = document.getElementById("edit" + idno);
    el.contentEditable = true;
    return el;
}

addEditor(document.body, "http://google.com").innerHTML += "Hello!"; 
```

应该管用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T17:52:45.910

如果它们适合您的上下文，您可以考虑使用 Adob​​e Flex 或 Microsoft Silverlight 来执行此操作。两者都提供了在 javascript 或框架中更难以实现的功能和控制粒度，尤其是当您需要跨 Windows、Mac 和 Linux 与多个浏览器一致工作时。

Flex 使用增强版的 javascript 作为其编程语言。Silverlight 对版本 1 的处理方式与此类似，尽管在版本 2 中它们仅支持 .NET 语言（根据您的需要，这可能更好、更差或无关紧要。）

两者都将自己描述为 RIA（富 Internet 应用程序）的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T17:29:36.550

这是一个*非常*普遍的问题。周围有很多内容管理系统，它们提供了类似的东西。

> 另外，如果 a`<div>`没有 ID/名称，如何指定它？

您可以通过 XPath 路径识别 DOM 中的节点。向上遍历`parentNode`以创建路径。

> 对于一块文本，边框可能会起作用，但是图像之类的呢？

您可以设置html中几乎所有元素的边框属性。

# python - 检测具有不同比特率和/或不同 ID3 标签的重复 MP3 文件？

> ID：476227
> 
> 赞同：14
> 
> 时间：2009-01-24T16:14:12.427
> 
> 标签：python, file, mp3, duplicates, id3

我如何检测（最好使用 Python）可以用不同比特率编码的重复 MP3 文件（但它们是同一首歌曲）和可能不正确的 ID3 标签？

我知道我可以对文件内容进行[MD5](http://en.wikipedia.org/wiki/MD5)校验和，但这不适用于不同的比特率。而且我不知道 ID3 标签是否会影响生成 MD5 校验和。我应该重新编码具有不同比特率的 MP3 文件，然后我可以进行校验和吗？你有什么建议吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-24T17:39:41.443

[旧 AudioScrobbler 和现在MusicBrainz](http://musicbrainz.org/)的人们很久以前就一直在研究同样的问题。目前，可以帮助您完成任务的 Python 项目是[Picard](http://musicbrainz.org/doc/PicardDownload)，它将使用 GUID（实际上是其中的几个）标记音频文件（不仅是 MPEG 1 第 3 层文件），从那时起，匹配标签非常简单。

如果您更喜欢将其作为自己的项目来做，[libofa](http://code.google.com/p/musicip-libofa/)可能会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-25T15:24:26.403

就像其他人说的那样，简单的校验和不会检测到具有不同比特率或 ID3 标签的重复项。您需要的是音频指纹算法。Python Audioprocessing Suite 有这样一个算法，但我不能说它有多可靠。

[http://rudd-o.com/new-projects/python-audioprocessing](http://rudd-o.com/new-projects/python-audioprocessing)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T11:43:03.290

For tag issues, [Picard](http://musicbrainz.org/doc/PicardTagger) may indeed be a very good bet. If, having identified two potentially duplicate files, what you want is to extract bitrate information from them, have a look at [mp3guessenc](http://shibatch.sourceforge.net/).

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-19T19:20:45.930

Dejavu 项目是用 Python 编写的，完全符合您的要求。

[https://github.com/worldveil/dejavu](https://github.com/worldveil/dejavu)

它还支持许多常见格式（.wav、.mp3 等）以及在原始音轨中查找剪辑的时间偏移。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-24T16:26:11.060

I don't think simple checksums will ever work:

1.  ID3 tags will affect the md5
2.  Different encoders will encode the same song different ways - so the checksums will be different
3.  Different bit-rates will produce different checksums
4.  Re-encoding an mp3 to a different bit-rate will probably sound terrible and will certainly be different to the original audio compressed in one step.

I think you'll have to compare ID3 tags, song length, and filenames.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-24T16:47:41.797

Re-encoding at the same bit rate won't work, in fact it may make things worse as transcoding (that is what re-encoding at different bitrates is called) is going to change the nature of the compression, you are recompressing an already compressed file is going to lead to a significantly different file.

This is a little out of my league but I would approach the problem by looking at the wave pattern of the MP3\. Either by converting the MP3 to an uncompressd .wav or maybe by just running the analysis on the MP3 file itself. There should be a library out there for this. Just a word of warning, this is an expensive operation.

Another idea, use ReplayGain to scan the files. If they are the same song, they should be be tagged with the same gain. This will only work on the exact same song from the exact same album. I know of several cases were reissues are remastered at a higher volume, thus changing the replaygain.

EDIT:
You might want to check out [http://www.speech.kth.se/snack/](http://www.speech.kth.se/snack/), which apparently can do spectrogram visualization. I imagine any library that can visual spectrogram can help you compare them.

This [link](http://wiki.python.org/moin/PythonInMusic) from the official python page may also be helpful.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-07T19:14:15.690

我正在寻找类似的东西，我发现了这个：
[http ://www.lastfm.es/user/nova77LF/journal/2007/10/12/4kaf_fingerprint_(command_line)_client](http://www.lastfm.es/user/nova77LF/journal/2007/10/12/4kaf_fingerprint_(command_line)_client)

希望能帮助到你。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-01-20T17:03:58.367

我会使用长度作为我的主要启发式方法。这就是 iTunes 在尝试使用[Gracenote 数据库](http://en.wikipedia.org/wiki/Gracenote)识别 CD 时所做的事情。以毫秒而不是秒[为单位测量长度。](https://stackoverflow.com/questions/993971/mp3-length-in-milliseconds)请记住，这只是一种启发式方法：您绝对应该在删除之前听取任何检测到的重复项。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-01-11T11:25:44.967

您可以使用 PUID 和 MusicBrainz 的后继者，称为**[AcoustiD](https://musicbrainz.org/doc/AcoustID)**：

> AcoustID 是一个开源项目，旨在创建一个免费的音频指纹数据库，并映射到 MusicBrainz 元数据数据库，并使用该数据库提供用于音频文件识别的网络服务......
> 
> ...指纹以及将歌曲识别到 AcoustID 数据库所需的一些元数据...

[您可以在https://acoustid.org/](https://acoustid.org/)找到各种客户端库和 Web 服务示例

# vb.net - 如何更新 Lucene.NET 索引？

> ID：476231
> 
> 赞同：11
> 
> 时间：2009-01-24T16:16:05.043
> 
> 标签：vb.net, indexing, lucene, lucene.net

我正在使用 Lucene.NET (v2.0) 在 Visual Basic 9 (VS2008) 中开发桌面搜索引擎。

我使用以下代码来初始化 IndexWriter

```
Private writer As IndexWriter

writer = New IndexWriter(indexDirectory, New StandardAnalyzer(), False)

writer.SetUseCompoundFile(True) 
```

如果我两次选择同一个文件夹（包含要编制索引的文件），则会在索引中为该文件夹中的每个文件创建两个不同的条目。

我希望 IndexWriter 丢弃索引中已经存在的任何文件。

我应该怎么做才能确保这一点？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-28T15:41:17.553

正如史蒂夫所提到的，您需要使用 IndexReader 的一个实例并调用它的 DeleteDocuments 方法。DeleteDocuments 接受 Term 对象的实例或 Lucene 的文档内部 id（通常不建议使用内部 id，因为它可以并且会随着 Lucene 合并段而改变）。

最好的方法是使用存储在特定于应用程序的索引中的唯一标识符。例如，在医生办公室的患者索引中，如果您有一个名为“patient_id”的字段，您可以创建一个术语并将其作为参数传递给 DeleteDocuments。请参阅以下示例（对不起，C#）：

```
int patientID = 12;
IndexReader indexReader = IndexReader.Open( indexDirectory );
indexReader.DeleteDocuments( new Term( "patient_id", patientID ) ); 
```

然后您可以使用 IndexWriter 的实例再次添加患者记录。我从这篇文章[http://www.codeproject.com/KB/library/IntroducingLucene.aspx](http://www.codeproject.com/KB/library/IntroducingLucene.aspx)中学到了很多东西。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-02-02T22:58:49.573

有许多关于使用 id 字段进行删除的过时示例。下面的代码适用于 Lucene.NET 2.4。

如果您已经在使用 IndexWriter 或访问 IndexSearcher.Reader，则无需打开 IndexReader。您可以使用 IndexWriter.DeleteDocuments(Term)，但棘手的部分是确保您首先正确存储了 id 字段。确保在存储文档时使用 Field.Index.NOT_ANALYZED 作为 id 字段的索引设置。这会对字段进行索引而不对其进行标记，这非常重要，并且在以这种方式使用时，其他任何 Field.Index 值都不会起作用：

```
IndexWriter writer = new IndexWriter("\MyIndexFolder", new StandardAnalyzer());
var doc = new Document();
var idField = new Field("id", "MyItemId", Field.Store.YES, Field.Index.NOT_ANALYZED);
doc.Add(idField);
writer.AddDocument(doc);
writer.Commit(); 
```

现在您可以使用同一个编写器轻松删除或更新文档：

```
Term idTerm = new Term("id", "MyItemId");
writer.DeleteDocuments(idTerm);
writer.Commit(); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-24T16:27:15.380

要更新 lucene 索引，您需要删除旧条目并写入新条目。因此，您需要使用 IndexReader 查找当前项目，使用 writer 删除它，然后添加新项目。对于我认为您正在尝试做的多个条目也是如此。只需找到所有条目，将它们全部删除，然后写入新条目。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-24T16:30:20.630

如果要删除**索引中的所有内容**并重新填充，可以使用此语句

```
writer = New IndexWriter(indexDirectory, New StandardAnalyzer(), True) 
```

[IndexWriter 构造函数](http://incubator.apache.org/lucene.net/docs/2.1/Lucene.Net.Index.IndexWriter.html)的最后一个参数确定是否创建新索引，或者是否打开现有索引以添加新文档。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-10-25T07:28:53.967

下面列出了一些选项，可以根据需要使用。

请参阅下面的代码快照。[C#源代码，请转成vb.net]

```
Lucene.Net.Documents.Document doc = ConvertToLuceneDocument(id, data);
Lucene.Net.Store.Directory dir = Lucene.Net.Store.FSDirectory.Open(new DirectoryInfo(UpdateConfiguration.IndexTextFiles));
Lucene.Net.Analysis.Analyzer analyzer = new Lucene.Net.Analysis.Standard.StandardAnalyzer(Lucene.Net.Util.Version.LUCENE_29);
Lucene.Net.Index.IndexWriter indexWriter = new Lucene.Net.Index.IndexWriter(dir, analyzer, false, Lucene.Net.Index.IndexWriter.MaxFieldLength.UNLIMITED);
Lucene.Net.Index.Term idTerm = new Lucene.Net.Index.Term("id", id);

foreach (FileInfo file in new DirectoryInfo(UpdateConfiguration.UpdatePath).EnumerateFiles())
{
        Scenario 1: Single step update.
                indexWriter.UpdateDocument(idTerm, doc, analyzer);

        Scenario 2: Delete a document and then Update the document
                indexWriter.DeleteDocuments(idTerm);
                indexWriter.AddDocument(doc);

        Scenario 3: Take necessary steps if a document does not exist.

            Lucene.Net.Index.IndexReader iReader = Lucene.Net.Index.IndexReader.Open(indexWriter.GetDirectory(), true);
            Lucene.Net.Search.IndexSearcher iSearcher = new Lucene.Net.Search.IndexSearcher(iReader);
            int docCount = iSearcher.DocFreq(idTerm);
            iSearcher.Close();
            iReader.Close();
            if (docCount == 0)
            {
                    //TODO: Take necessary steps
                    //Possible Step 1: add document
                    //indexWriter.AddDocument(doc);

                    //Possible Step 2: raise the error for the unknown document
            }
}
indexWriter.Optimize();
indexWriter.Close(); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-10T13:57:20.687

除非您只修改少量文档（例如，少于总数的 10%），否则从头开始重新索引几乎肯定会更快（您的里程可能会因存储/索引字段等而异）。

也就是说，我总是会索引到一个临时目录，然后在完成后将新目录移动到位。这样，在构建索引时几乎没有停机时间，如果出现问题，您仍然有一个好的索引。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-07-31T05:26:34.807

一种选择当然是删除文档，然后添加文档的更新版本。

或者，您也可以使用 IndexWriter 类的 UpdateDocument() 方法：

```
writer.UpdateDocument(new Term("patient_id", document.Get("patient_id")), document); 
```

这当然需要您有一种机制，您可以通过该机制找到要更新的文档（本示例中的“患者 ID”）。

我已经[用更完整的源代码示例在博客上发布了更多详细信息](http://manfredlange.blogspot.com/2010/07/updating-lucene-index-green-version.html)。

# c# - 多次导入同一个 Subversion 存储库目录？

> ID：476233
> 
> 赞同：0
> 
> 时间：2009-01-24T16:16:07.977
> 
> 标签：c#, svn, sharpsvn

由于多种原因，我拥有的某些文件的规范来源不能是存储库的工作副本（Subversion 服务器位于无法访问的防火墙后面，并且数据本身并不存在于我首选结构的文件系统中）。所以，我写了一个工具来下载数据，从中生成一个目录结构，然后使用 SharpSvn 将结果导入到存储库中。这行得通……第一次。第二次，当然，该名称的目录已经存在于存储库中，我无法再次导入。

相反，我可以：

1.  删除目录，*然后*导入。我没有对此进行测试，但除了听起来很愚蠢之外，它可能还会删除各个文件的修订历史记录，因为新文件完全不同。
2.  查看目录是否存在，检查出来，远程删除规范源中不再存在的文件，然后替换剩余部分并提交。这可能会奏效，但听起来容易出错且不必要地困难。

*我的假设是否正确，即删除文件会将新文件标记为与不同*文件相同的方式？有没有比第二种方法更简单的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T16:34:53.540

对于 1)，它不会删除修订历史，但新文件将被视为与旧文件完全无关。不过，您仍然可以取回旧文件。

对于 2)，这将是推荐的方式。但是在'svn delete'现有文件并添加新文件之后，您还必须在提交之前'svn add'这些新文件。

但似乎您应该考虑使用 svn-load-dirs.pl 脚本。[您可以在 Subversion 书籍的“供应商分支](http://svnbook.red-bean.com/en/1.1/ch07s05.html)”一章中了解这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T16:32:59.813

Subversion 与文件的连接松散。对于文件夹中的文件，您可以轻松地进行获取/更新，进行大量更改（包括删除、替换或添加文件），然后提交差异。这种文件级行为是典型的 Subversion 用法。

目录略有不同。Subversion 将存储库信息存储在文件夹级别。因此，如果您创建一个新文件夹，它不会自动连接到 Subversion。（使用 TortoiseSvn 之类的东西，它会为你处理很多事情。）

如果您要在生成过程中添加和删除目录，您将遇到一些与文件本身略有不同的问题。但是，您仍然可以通过命令行、SharpSvn、TortoiseSvn 或其他类似工具来实现您的目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T16:42:38.220

由于您无法覆盖目录，否则您将破坏`.svn`目录并丢失所有存储库信息，因此您必须复制文件但只能创建新目录。这就是我要从要更新的颠覆工作副本中执行此操作的方式：

```
(cd <newdirectory> ; tar -cf - * ) | tar -xf - 
```

当然，您需要一个 Unix-y 系统。它应该与[Cygwin](http://www.cygwin.com/)一起使用，除非 Windows 在系统级别覆盖文件夹做了一些特别奇怪的事情。

# .net - 如何检查 WordprocessingDocument 是否为空？

> ID：476234
> 
> 赞同：0
> 
> 时间：2009-01-24T16:16:38.303
> 
> 标签：.net, ms-word, ms-office

从 WordprocessingDocument 如何检查 word 文档是否为空？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T00:01:27.410

根据此处的示例文档：

[http://msdn.microsoft.com/en-us/library/office/bb521237(v=office.14).aspx](http://msdn.microsoft.com/en-us/library/office/bb521237(v=office.14).aspx)

您可以`ExtendedFilePropertiesPart`从 中`WordprocessingDocument`获取 ，使用 获取“Characters”属性`GetElementsByTagName("Characters")`，如果值为零，这可能是文档为空的一个很好的指示，无论存在任何其他格式。

请参阅上面的链接并滚动到页面底部以获取完整的源代码。

# .net - .net 的最佳序列化库，能够正确反序列化继承

> ID：476239
> 
> 赞同：2
> 
> 时间：2009-01-24T16:19:01.760
> 
> 标签：.net, serialization

我需要一个具有比默认 xml 序列化程序更好功能的 .net 序列化库。问题是它不是多态的——假设你有 class B : A { }，并且已经序列化了一个类型 B，你应该能够在它上面调用 A myBaseType = Deserialize(xml) 并返回一个 B 类型的实例myBaseType 变量。

我在[http://refactormycode.com/codes/710-polymorphic-xml-serializer](http://refactormycode.com/codes/710-polymorphic-xml-serializer)有一个实现，其中包含序列化库应该能够处理的单元测试。如果要序列化的对象的子类型也是多态序列化类型，则此实现将不起作用，因此我需要更好的东西。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T17:39:06.123

如果您可以处理将类型信息嵌入到结果流中的序列化程序的额外冗长可能是最好的。

.Net 提供了过于冗长的[SoapFormatter](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.soap.soapformatter.aspx)并且执行了您可能不需要的事情，但是当您反序列化流时，它只会给您返回适当的对象（无需指定类型，只需将根对象转换为您的类型知道它是）。

作为一个附带好处，它将正确处理对象图中的循环和共享引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T16:41:08.970

您可以使用 .NET 的二进制序列化程序还是必须是 XML？我对 .NET 的 XML 处理有类似的抱怨，特别是在尝试序列化图形而不是树时。

在我需要 XML 正常工作的地方，我最终只是为每个类推出了我自己的序列化代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T21:09:29.583

[protobuf-net](http://code.google.com/p/protobuf-net/)支持大多数继承路由（即使规范不支持）。有一个已知的故障（我正在处理它；-p） - 但它涵盖了大多数选项。

# testing - 自动化测试无用的场景

> ID：476250
> 
> 赞同：2
> 
> 时间：2009-01-24T16:23:29.333
> 
> 标签：testing, tdd

在哪些情况下单元测试和 TDD 之类的东西比它们的价值更麻烦？

我想出的一些事情是：

*   当生成测试数据很棘手时：有时，能够提出有效的、非平凡的测试数据本身就是一个挑战。
*   验证代码正确性的唯一实用方法是运行它。
*   当您测试设计的视觉元素时。

还有哪些其他情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T16:38:40.600

我相信你的前两点是无效的。

*   创建测试数据可能是一个挑战（事实上，它*通常*是编写单元测试的主要部分），但这只是你必须接受的事情，而不是放弃单元测试的理由。这不可能是不可能的，否则你怎么知道你的应用程序正常工作？
*   单元测试运行代码以验证其正确性 - 我没有看到问题。

*应用程序的某些方面*肯定不能进行单元测试——视觉布局（屏幕或打印）就是这样一个方面，一般来说可用性也是如此——实际上不能正式指定的东西。

单元测试可能不适用的情况是，当您面临开发时没有考虑可测试性甚至模块化的现有应用程序（[Big Ball of Mud](http://www.laputan.org/mud/) Anti-pattern）。但即便如此，如果您知道您必须在相当长的时间内维护和扩展这个野兽，那么找到一种方法来自动测试应用程序的至少某些部分几乎总是可行且有用的。没有人说你必须在做任何其他事情之前编写一个达到 100% 代码覆盖率的测试套件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T16:35:17.377

我不确定它是否*无济于事*。在某些情况下，它可能会更困难，您可能会选择不使用它——例如，在您的 UI 的视觉布局的情况下。有时也可能会浪费精力——例如，对设计人员生成的代码或不是您编写的框架进行单元测试。生成数据不应该成为单元测试的障碍。您的测试应该足够小并且足够集中，以至于您通常不需要为任何单个测试生成整个数据集，因此在这些情况下模拟是一种非常有用的技术。如果我发现自己一遍又一遍地嘲笑同样的事情，我有时会将它合并成一个所有测试都可以依赖的假数据库类。

单元测试和运行代码都不会验证其正确性。单元测试可以帮助消除错误，尤其是 TDD，并确保发现的错误得到修复。如果您需要确保您的代码是正确的，您将需要应用不同的、基于逻辑的技术来证明正确性。这些超出了单元测试的范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T16:35:49.043

我不会说在任何情况下自动化测试都没有帮助。

当然也有一些不太有用的地方。我不认为创建夹具数据是其中之一。有一些工具可以提供帮助，例如[factory_girl](http://github.com/thoughtbot/factory_girl/tree/master)（至少在 Ruby 中）。事实上，如果您的模型非常复杂，以至于您需要创建十几个具有各种关联的对象，我会认为代码有异味，并且模型可能没有尽可能简洁。

也就是说，在某些情况下，弊端可能超过好处。前几天我写了一些代码来分叉一个外部进程。我不关心输出，我不关心返回码，我什至不关心它是否工作正常，它完全是一劳永逸的，如果有什么事情不正常，另一个进程将被清理，之后。

在那种情况下，我没有费心编写任何测试，因为这样做的好处不值得花时间设置一个假的外部程序来验证我的论点等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T16:39:13.610

对此只是一些随机的想法：

1.  我假设微软没有单元测试，因为它有各种关闭计算机的方法。可以用 Virtuals 完成，但可能不值得
2.  对于硬件制造商：确保驱动程序适用于不同的硬件可能也是手动完成的（嗨，nvidia，你弄坏了我的 gfx 卡；））
3.  运行一次的 shell 脚本。只需调整它们直到它们起作用

但这些仍然是极端情况。我还认为它们几乎总是可行的，从长远来看，它们通常会给你带来比你一开始投资更多的回报。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T17:21:20.403

```
* When generating test data is tricky: Sometimes, being able to come up with valid, non trivial test data is a challenge in itself. 
```

当您需要系统与“完整数据集”“在上下文中”时，您所做的不是单元测试。它正在测试，但是您对“单元”的压力很大。您需要为此进行*较小*的测试。TDD 的难点在于让您的代码具有您可以在小范围内对其进行测试的形式。它很有价值，但并不容易。如果您进行测试后（不是 TDD），那么几乎不可能避免您的情况。

因此，当您想测试比单元更大的东西（即类上的方法）时，您将需要使用 UAT 之类的东西。但是在这种情况下，您仍然需要像练习 TDD 一样对单个函数进行测试。

```
* When the only practical way of verifying correctness of the code is to run it. 
```

但是代码在单元测试*中运行。*你的意思是当它*在上下文*或其他东西中运行时？

```
* When you're testing visual elements of the design. 
```

我认为这是您的第二个要点，但我想不是。尝试在 UT 中测试布局是困难的，而且通常没有回报。这样的测试是脆弱的。

因此，在某些情况下使用 UT 进行大型子系统测试或验证屏幕布局可能没有价值。但即便如此，它对于你剩下的 90% 的工作来说还是非常有价值的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T17:24:23.970

我认为迈克尔总结得很好：“无法真正正式指定的事物”。原来有很多东西不能正式指定。可用性就是一个例子（尽管一旦你决定了哪种行为是可用的，你当然可以而且应该测试那个行为！）。有点自相矛盾的是，许多数字运算任务无法正式指定：例如天气预报。目标当然是预测明天的天气，但这不是一个正式的规范。所以你可以测试你使用的算法是否做了它们应该做的事情（计算平均值、反转矩阵、可以正式指定的东西），但是你的天气预报程序可以通过所有测试，但 90% 的时间仍然是错误的. 或者您可以使用大量历史数据来测试该算法是否产生了良好的预测，但这很危险，因为它很容易导致算法只对您使用的历史数据准确，而不是一般情况下。这可能意味着您的单元测试需要数小时或数天才能运行。更糟糕的是，您的算法可能具有必须“调整”的参数，例如对于所使用的测量仪器，并且每个算法的最佳参数可能不同，因此单元测试需要手动交互才能找到好的参数。理论上可行，但可能不是很有用。我想同样的论点也适用于 OCR、ICR、许多信号处理任务、人脸识别（和许多其他图像处理任务）、典型的 Photoshop 工具，如“去除红眼”，

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-01-24T17:06:55.113

我坚信深思熟虑的测试；但是，我发现单元测试和 TDD 主要是在浪费时间。

### 从经验的角度来看：

1.  没有经验证据表明更高质量的代码。
2.  没有经验证据表明更高的生产率。
3.  没有经验证据表明可以节省成本。
4.  有一些以伪科学的方式呈现的“故事”表明 TDD 是有益的，但没有对照组，也没有真正的指标。

### TDD 的好处：

1.  “了解” TDD 的布道者通过宣传他们的专业知识而受益。
2.  销售/推广单元测试工具的软件组将从中受益。
3.  如果您的开发人员不是高素质的，那么单元测试可能会有一些好处。

    *   单元测试只捕捉最明显的错误
    *   如果开发人员始终通过单元测试发现错误，我会替换它们。
    *   如果我将开发外包给班加罗尔的一家车身修理厂，我会实施单元测试。否则，我将坚持与强大的开发人员合作——从长远来看，这些人更具成本效益。

### 主观分析：

1.  如果您听取 TDD 支持者的论点，您可以轻松地将 TDD 替换为祈祷，并且推理的有效性不会改变......
2.  单元测试是代码——你正在将代码库的大小增加一倍/三倍……那段时间可能最好花在分析你的代码上。
3.  高质量的软件来自于敌对/合作的团队。编写代码的同一实体没有业务测试代码 - 这应该是 QA 分析师的工作。
4.  高质量和具有成本效益的软件来自遵循良好的设计原则 - SOLID/GRASP/GoF
5.  在回顾了单元测试和 TDD 之后，我会得出的真实世界类比是......这有点像在自己身上运行一个检查清单，其中包含以下项目：
    *   吸入空气检查
    *   呼气检查
    *   左脚向前检查
    *   右脚向前检查
    *   眨眼检查
    *   插入口香糖检查
    *   闭嘴检查
    *   张开嘴检查
    *   迭代直到吞咽检查...
    *   是的，您实际上可能会发现一个问题，但是如果不花费大量精力编写代码，您将永远无法弄清楚任何后果。
6.  Jebus 告诉我，TDD 是一个假神。

# c# - Access to a single pixel in C#

> ID：476255
> 
> 赞同：3
> 
> 时间：2009-01-24T16:25:19.720
> 
> 标签：c#, pixel, draw, windows

I'm working on a school project right now. It's meant to be a 3D editing software, (like a very minimized version of Maya). I have to write it in C#, using the 'Windows Application Project'. I intend to implement all the 3D stuff myself, from projections to shading. My question is, how can I get direct access to a single pixel in the C# windows application? I know I'm going to have a main view port in the window. But I haven't decided yet how it will be made. Is there a built in object that I can use, that will let me define the boundaries of the view port, and then paint each pixel individually? (I'm just shooting in the dark here, I don't know much about C#. I mostly program in C)

Thanks, Malki.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T16:41:25.210

Using the CreateGraphics() method, this should work:

```
Bitmap b = new Bitmap(Width, Height, this.CreateGraphics());
//pixel is:
Color c = b.GetPixel(x, y); 
```

To set a pixel to a specific colour, use this instead of `Color c = b.GetPixel(x,y)`:

```
b.SetPixel(x, y, c); // where c is a Color 
```

If you want a viewport, place a panel or a PictureBox (maybe with Dock: Fill), then use:

```
Bitmap b = new Bitmap(viewport.Width, viewport.Height, viewport.CreateGraphics()); 
```

instead of the first line used previously.

But from what you want to do, I think it would be better to use the OnPaint event:

```
void pnlViewport_Paint(object sender, PaintEventArgs e) {
    if ( e.ClipRectange.Width < 1 || e.ClipRectangle.Height < 1 ) return;
    Bitmap b = new Bitmap(e.ClipRectangle.Width, e.ClipRectangle.Height, e.Graphics);
    // ...
} 
```

This event fires every time the control needs painted. The first line checks whether the area being drawn is empty - this will not just save CPU time, but your application may crash - you are getting it to make a 0x0 bitmap.

**EDIT**: Yes, this is resizable, if Dock = DockStyle.Fill; As your window resizes, the control expands to fill the space. It is then repainted - firing the event.

**EDIT 2**: As pointed out by others, this is still slow. It does sound like it is a requirement to do the 3D drawing yourself, so maybe [SDL.NET](http://cs-sdl.sourceforge.net) (which I think can use hardware acceleration) is the way to go. It even has a (slow) SurfaceControl to use.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T16:34:26.457

Christian Graus has several good graphic-manipulation articles on www.CodeProject.com. They should answer your questions.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T17:00:03.910

3D 编辑器应用程序不仅需要在屏幕上绘图 - 它还需要非常快地完成。.NET 中的标准方法是使用 Bitmap 和 Graphics 类，如**person-b**所述。但这会很慢。您可以通过使用**Bitmap.LockBits()**和巧妙的优化来提高速度，但总而言之，我怀疑您是否仍会获得所需的性能。你会吃掉所有的 CPU，并且仍然会卡在不到 10-20 FPS（数字是一个疯狂的猜测）。硬件加速是真正的方法。**shuggycouk**的链接方向正确。

不幸的是，硬件方法也会消除投影和阴影，因为这就是硬件的用途。所以我不知道你是否可以使用它......也许在.NET中寻找关于“覆盖”的信息。这就是所有媒体播放器软件显示电影的方式。它肯定比标准 GDI/GDI+ 快得多，而且仍然是 2D 的。或者，也许您可​​以使用 DirectX 做一个棘手的解决方法 - 使用它来绘制您自己定义的 2D 形状。;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T16:50:32.150

如果你正在做 3d，那么利用现在几乎所有 GPU 提供的硬件加速是有意义的。如果您乐于使用特定于 Windows 的 API，那么 DirectX 的 3D API 现在会通过[托管包装器](http://gregs-blog.com/2008/02/26/managed-directx-c-graphics-tutorial-1-getting-started/)公开。还有主要是为游戏设计的[XNA工具集，但它提供了大量示例，说明如何从 c# 进行 Direct-X 3D 加速绘图。](http://www.xna.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T18:15:34.973

如果您需要像素速度，[high-speed-graphing-control-for-net-or-mfc](https://stackoverflow.com/questions/179787/high-speed-graphing-control-for-net-or-mfc)可能会提供一些提示。

# c++ - 如何正确重载 ostream 的 << 运算符？

> ID：476272
> 
> 赞同：257
> 
> 时间：2009-01-24T16:34:28.423
> 
> 标签：c++, namespaces, operator-overloading, iostream, ostream

我正在用 C++ 编写一个用于矩阵运算的小型矩阵库。但是我的编译器抱怨，以前没有。这段代码被搁置了 6 个月，在这期间我将计算机从 debian etch 升级到 lenny (g++ (Debian 4.3.2-1.1) 4.3.2 ) 但是我在具有相同 g++ 的 Ubuntu 系统上遇到了同样的问题.

这是我的矩阵类的相关部分：

```
namespace Math
{
    class Matrix
    {
    public:

        [...]

        friend std::ostream& operator<< (std::ostream& stream, const Matrix& matrix);
    }
} 
```

和“实施”：

```
using namespace Math;

std::ostream& Matrix::operator <<(std::ostream& stream, const Matrix& matrix) {

    [...]

} 
```

这是编译器给出的错误：

> matrix.cpp:459: error: 'std::ostream& Math::Matrix::operator<<(std::ostream&, const Math::Matrix&)' 必须只取一个参数

我对这个错误有点困惑，但是在这 6 个月里做了很多 Java 之后，我的 C++ 又变得有点生疏了。:-)

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2009-01-24T22:28:38.647

只是告诉你另一种可能性：我喜欢为此使用朋友定义：

```
namespace Math
{
    class Matrix
    {
    public:

        [...]

        friend std::ostream& operator<< (std::ostream& stream, const Matrix& matrix) {
            [...]
        }
    };
} 
```

该函数将自动定位到周围的命名空间`Math`（即使它的定义出现在该类的范围内），但除非您使用 Matrix 对象调用 operator<< ，否则它将不可见，这将使依赖于参数的查找找到该运算符定义。这有时可以帮助模棱两可的调用，因为它对于 Matrix 以外的参数类型是不可见的。在编写其定义时，您还可以直接引用 Matrix 中定义的名称和 Matrix 本身，而无需使用一些可能很长的前缀来限定名称并提供模板参数，例如`Math::Matrix<TypeA, N>`.

* * *

## 回答 #2

> 赞同：138
> 
> 时间：2009-01-24T16:37:35.983

您已将函数声明为`friend`. 它不是班级的成员。您应该`Matrix::`从实施中删除。`friend`表示指定的函数（不是类的成员）可以访问私有成员变量。您实现该功能的方式就像`Matrix`是错误的类的实例方法。

* * *

## 回答 #3

> 赞同：87
> 
> 时间：2009-01-24T18:51:16.277

要添加到 Mehrdad 的答案，

```
namespace Math
{
    class Matrix
    {
       public:

       [...]

    }   
    std::ostream& operator<< (std::ostream& stream, const Math::Matrix& matrix);
} 
```

在您的实施中

```
std::ostream& operator<<(std::ostream& stream, 
                     const Math::Matrix& matrix) {
    matrix.print(stream); //assuming you define print for matrix 
    return stream;
 } 
```

* * *

## 回答 #4

> 赞同：77
> 
> 时间：2012-02-10T16:09:49.673

假设我们正在讨论对`operator <<`派生自`std::ostream`处理`Matrix`类的所有类进行重载（而不是`<<`对`Matrix`类进行重载），那么在标头中的 Math 命名空间之外声明重载函数更有意义。

仅当无法通过公共接口实现功能时才使用友元功能。

**矩阵.h**

```
namespace Math { 
    class Matrix { 
        //...
    };  
}
std::ostream& operator<<(std::ostream&, const Math::Matrix&); 
```

请注意，运算符重载是在命名空间之外声明的。

**矩阵.cpp**

```
using namespace Math;
using namespace std;

ostream& operator<< (ostream& os, const Matrix& obj) {
    os << obj.getXYZ() << obj.getABC() << '\n';
    return os;
} 
```

另一方面，如果您的重载函数*确实*需要成为朋友，即需要访问私有成员和受保护成员。

**数学.h**

```
namespace Math {
    class Matrix {
        public:
            friend std::ostream& operator<<(std::ostream&, const Matrix&);
    };
} 
```

您需要用命名空间块而不是仅仅将函数定义括起来`using namespace Math;`。

**矩阵.cpp**

```
using namespace Math;
using namespace std;

namespace Math {
    ostream& operator<<(ostream& os, const Matrix& obj) {
        os << obj.XYZ << obj.ABC << '\n';
        return os;
    }                 
} 
```

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2016-03-05T08:24:36.600

在 C++14 中，您可以使用以下模板打印任何具有 T::print(std::ostream&)const; 的对象。成员。

```
template<class T>
auto operator<<(std::ostream& os, T const & t) -> decltype(t.print(os), os) 
{ 
    t.print(os); 
    return os; 
} 
```

在 C++20 中可以使用概念。

```
template<typename T>
concept Printable = requires(std::ostream& os, T const & t) {
    { t.print(os) };
};

template<Printable T>
std::ostream& operator<<(std::ostream& os, const T& t) { 
    t.print(os); 
    return os; 
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-05-27T17:23:42.063

我想通过一个重载`<<`以打印数组的示例来简化这一点。

1.  `<<`首先在运算符周围传递两种对象类型
2.  创建一个函数来重载运算符，如下所示。

```
#include<iostream> 
using namespace std;

void operator<<(ostream& os, int arr[]) {
    for (int i = 0;i < 10;i++) {
        cout << arr[i] << " ";
    }
    cout << endl; 
}

int main() {
    int arr[10] = { 1,2,3,4,5,6,7,8,9,10 };
    cout << arr;
} 
```

如果还需要级联运算符，请确保`cout`在重载函数中返回对象，如下所示，

```
#include<iostream> 
using namespace std;

ostream& operator<<(ostream& os, int arr[]) {
    for (int i = 0;i < 10;i++) {
        cout << arr[i] << " ";
    }
    cout << endl; 
    return os;
}

int main() {
    int arr[10] = { 1,2,3,4,5,6,7,8,9,10 };
    int arr2[10] = { 11,22,33,44,55,66,77,88,99,100 };
    // cascading of operators
    cout << arr << arr2;
} 
```

# javascript - Using Javascript in CSS

> ID：476276
> 
> 赞同：78
> 
> 时间：2009-01-24T16:36:01.273
> 
> 标签：javascript, css

Is it possible to use Javascript inside CSS?

If it is, can you give a simple example?

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-01-27T01:51:46.150

IE 和 Firefox 都包含从 CSS 执行 JavaScript 的方法。正如 Paolo 所提到的，IE 中的一种方式是该`expression`技术，但也有更晦涩的**HTC 行为**，其中包含您的脚本的单独 XML 通过 CSS 加载。存在用于 Firefox 的类似技术，使用**XBL**。这些技术并不*直接*从 CSS 执行 JavaScript ，但效果是一样的。

## HTC 与 IE

使用这样的 CSS 规则：

```
body {
  behavior:url(script.htc);
} 
```

并且在该 script.htc 文件中有类似的内容：

```
<PUBLIC:COMPONENT TAGNAME="xss">
   <PUBLIC:ATTACH EVENT="ondocumentready" ONEVENT="main()" LITERALCONTENT="false"/>
</PUBLIC:COMPONENT>
<SCRIPT>
   function main() 
   {
     alert("HTC script executed.");
   }
</SCRIPT> 
```

HTC 文件在事件上执行`main()`函数`ondocumentready`（指 HTC 文档的准备情况。）

## XBL 与 Firefox

Firefox 使用 XBL 支持类似的 XML 脚本执行 hack。

使用这样的 CSS 规则：

```
body {
  -moz-binding: url(script.xml#mycode);
} 
```

在您的 script.xml 中：

```
<?xml version="1.0"?>
<bindings xmlns="http://www.mozilla.org/xbl" xmlns:html="http://www.w3.org/1999/xhtml">

<binding id="mycode">
  <implementation>
    <constructor>
      alert("XBL script executed.");
    </constructor>
  </implementation>
</binding>

</bindings> 
```

构造函数标记中的所有代码都将被执行（将代码包装在 CDATA 部分中是个好主意。）

在这两种技术中，**除非 CSS 选择器与 document 中的元素匹配，否则代码不会执行**。通过使用类似的东西`body`，它将在页面加载时立即执行。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-01-24T16:40:16.650

I think what you may be thinking of is `expressions` or ["dynamic properties"](http://msdn.microsoft.com/en-us/library/ms537634.aspx), which are only supported by IE and let you set a property to the result of a javascript expression. Example:

```
width:expression(document.body.clientWidth > 800? "800px": "auto" ); 
```

This code makes IE emulate the `max-width` property it doesn't support.

All things considered, however, **avoid using these**. [They are a bad, bad thing.](https://developer.yahoo.com/blogs/ydnfiveblog/high-performance-sites-rule-7-avoid-css-expressions-7202.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-27T01:10:23.363

鉴于您提供的信息，为了便于潜在地解决您的问题，我假设您正在寻找动态 CSS。如果是这种情况，您可以使用服务器端脚本语言来执行此操作。例如（我非常喜欢做这样的事情）：

样式.css.php：

```
body
 {
margin: 0px;
font-family: Verdana;
background-color: #cccccc;
background-image: url('<?php
echo 'images/flag_bg/' . $user_country . '.png';
?>');
 } 
```

这会将背景图像设置为**$user_country**变量中存储的任何内容。这只是动态 CSS 的一个例子；当结合 CSS 和服务器端代码时，几乎有无限的可能性。另一种情况是允许用户创建自定义主题，将其存储在数据库中，然后使用 PHP 设置各种属性，如下所示：

user_theme.css.php：

```
body
 {
background-color: <?php echo $user_theme['BG_COLOR']; ?>;
color: <?php echo $user_theme['COLOR']; ?>;
font-family: <?php echo $user_theme['FONT']; ?>;
 }

#panel
 {
font-size: <?php echo $user_theme['FONT_SIZE']; ?>;
background-image: <?php echo $user_theme['PANEL_BG']; ?>;
 } 
```

不过，这又是一个简单的例子。通过服务器端脚本利用动态 CSS 的力量可以产生一些非常不可思议的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-24T16:38:55.433

Not in any conventional sense of the phrase "inside CSS."

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-24T16:42:45.240

IE supports CSS *expressions*:

```
width:expression(document.body.clientWidth > 955 ? "955px": "100%" ); 
```

but they are not standard and are not portable across browsers. Avoid them if possible. They are deprecated [since IE8](http://msdn.microsoft.com/en-us/library/ms537634.aspx).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-03T05:11:44.927

我遇到了类似的问题，并开发了两个独立的工具来完成此任务：

*   [CjsSS.js](http://opensourcetaekwondo.com/cjsss/)是一个支持回到 IE6 的 Vanilla Javascript 工具（因此没有外部依赖项）。

*   [ngCss](http://opensourcetaekwondo.com/ngcss/)是一个支持 Angular 1.2+ 的 Angular Module+Filter+Factory（又名：插件）（所以回到 IE8）

这两个工具集都允许您在 STYLE 标记或外部 *.css 文件中执行此操作：

```
 /*<script src='some.js'></script>
    <script>
        var mainColor = "#cccccc";
    </script>*/

    BODY {
        color: /*{{mainColor}}*/;
    } 
```

这在您的页面`style`属性中：

```
 <div style="color: {{mainColor}}" cjsss="#sourceCSS">blah</div> 
```

或者

```
 <div style="color: {{mainColor}}" ng-css="sourceCSS">blah</div> 
```

注意：在 ngCss 中，您也可以`$scope.mainColor`代替`var mainColor`

默认情况下，Javascript 在沙盒 IFRAME 中执行，但由于您编写自己的 CSS 并将其托管在自己的服务器上（就像您的 *.js 文件一样），因此 XSS 不是问题。但是沙盒提供了更多的安全性和安心。

CjsSS.js 和 ngCss 介于完成类似任务的其他工具之间：

*   [LESS](http://lesscss.org/)、[SASS](http://sass-lang.com/)和[Stylus](http://learnboost.github.io/stylus/)都只是预处理器，需要你学习一门新语言并破坏你的 CSS。基本上他们用新的语言特性扩展了 CSS。所有这些都仅限于为每个平台开发的插件，而 CjsSS.js 和 ngCss 都允许您通过`<script src='blah.js'></script>`直接在 CSS 中包含任何 Javascript 库！

*   [AbsurdJS](http://absurdjs.com/)看到了同样的问题，并采取了与上面的预处理器完全相反的方向；AbsurdJS 没有扩展 CSS，而是创建了一个 Javascript 库来生成 CSS。

CjsSS.js 和 ngCss 处于中间位置；你已经了解 CSS，你已经了解 Javascript，所以只需让它们以简单、直观的方式协同工作。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-09-07T23:08:55.700

事实证明这是一个非常有趣的问题。设置了一百多个属性，你会认为你可以输入 .clickable { onclick : "alert('hi!');" ; } 在你的 CSS 中，它会工作。它很直观，很有意义。这在猴子修补动态生成的大量 UI 中将非常有用。

问题：
CSS 警察以其无限的智慧，在*表现*和*行为*之间划出了一道中国墙。CSS 故意不支持任何正确标记的 HTML。（[完整的属性表](http://www.w3.org/TR/CSS2/propidx.html)）

解决这个问题的最好方法是使用 jQuery，它会在后台设置一个解释引擎来执行您尝试对 CSS 执行的操作。请参阅此页面： [将 Javascript Onclick 添加到 .css 文件](https://stackoverflow.com/questions/10480840/add-javascript-onclick-to-css-file)。

祝你好运。

# c# - WinCE中的哔声，可能吗？

> ID：476290
> 
> 赞同：5
> 
> 时间：2009-01-24T16:40:20.893
> 
> 标签：c#, compact-framework, audio

是否可以在 WinCE 中发出哔声？

我尝试，我得到一个错误

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-24T17:01:14.860

Beeing 的 .net 框架方法在框架的 CF 版本中不可用。获得哔声的最佳方法是 PInvoke 进入 MessageBeep 函数。此方法的 PInvoke 签名非常简单

```
[DllImport("CoreDll.dll")]
public static extern void MessageBeep(int code);

public static void MessageBeep() {
  MessageBeep(-1);  // Default beep code is -1
} 
```

这篇博文有一个非常详尽的例子：[http://blog.digitforge.com/?p=4（在archive.org上）](http://web.archive.org/web/20090601181423/http://blog.digitforge.com/?p=4)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-24T16:52:01.180

是的。P/Invoke [PlaySound](http://msdn.microsoft.com/en-us/library/aa909766.aspx)或[sndPlaySound](http://msdn.microsoft.com/en-us/library/aa909803.aspx)或[MessageBeep](http://msdn.microsoft.com/en-us/library/aa930642.aspx)。看到[这个](http://social.msdn.microsoft.com/Forums/en-US/vssmartdevicesvbcs/thread/8d96cca1-7883-473b-92db-c6b9f928506d/)或[这个](http://blogs.msdn.com/brada/archive/2004/06/03/148142.aspx)或[这个](http://www.eggheadcafe.com/software/aspnet/29657361/the-old-cfnet-beep-que.aspx)。搜索引擎的 30 秒可以出现令人惊讶的结果。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-21T16:47:47.407

如果您要播放默认系统声音之一并使用 .net 运行时 2.0+（和 framework v 3.5+），那么您可以使用**System.Media.SystemSounds**类（不需要 PInvoke 或 WinAPI 调用），例如所以：

```
//available system sounds
System.Media.SystemSounds.Asterisk.Play();
System.Media.SystemSounds.Beep.Play();
System.Media.SystemSounds.Exclamation.Play();
System.Media.SystemSounds.Hand.Play();
System.Media.SystemSounds.Question.Play(); 
```

请注意，如果用户禁用或静音了系统声音，他们将听不到任何声音。

但是，如果您要播放任意音调，那么您需要查看上述涉及 WinAPI 或 PInvoke 的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-11T20:46:05.330

对于 Compact Framework 中的简单哔声，您不需要所有导入的废话。此外，根据硬件，您无论如何都只能使用默认的哔声。只需使用：

```
Microsoft.VisualBasic.Interaction.Beep() 
```

# iphone - iPhone图像失真

> ID：476291
> 
> 赞同：1
> 
> 时间：2009-01-24T16:40:24.043
> 
> 标签：iphone, cocoa-touch, quartz-graphics

模拟器会正确显示 UIImageViews，但在 iPhone 上显示不正确，有什么原因吗？

我的过程： PNG 文件中的图像 启动 UIGraphicsBeginImageContext() 在 CGrect 中绘制 PNG 在 CGRect 中绘制文本 从上下文创建 UIImage 将 UIImaveView 的图像设置为 UIImage 将 UIImageView 的框架设置为PNG 添加为子视图

结果：图像显示不正确。图像最右边的 1-3 像素只是一条垂直的白线。这仅发生在设备上而不是模拟器上。我可以解决这个问题，但只能通过增加 UIImageView 的大小。如果我将 UIImageView 的 size.height 增加 1 个像素，它会正确显示 UIImage。当然，这些让 iPhone 在将我的图像绘制到屏幕上之前对其进行缩放，这是不可取的。

任何想法为什么会发生这种情况或任何修复它？（如果需要，我会发布我的代码）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T18:02:49.437

这是获取我的 PNG 文件、用文本绘制并保存为 UIImage 的代码。然后将此图像设置为 UIImageView 的图像属性，其框架是图像的大小 (25x25)。

```
-(UIImage *) elementImageWithFrame: (CGRect) aFrame image: (NSString *) anImage{

        int smallFontSize=FONT_SMALL;
        int largeFontSize=FONT_LARGE;

        CGSize mySize = aFrame.size;

        UIGraphicsBeginImageContext(mySize);

        UIImage *backgroundImage = [UIImage imageNamed:anImage];
        CGRect elementSymbolRectangle = CGRectMake(0.0f ,0.0f, aFrame.size.width, aFrame.size.height);
        [backgroundImage drawInRect:elementSymbolRectangle];

        // draw the element name
        [[UIColor whiteColor] set];

        // draw the element number
        UIFont *font = [UIFont boldSystemFontOfSize:(smallFontSize)];
        CGPoint point = CGPointMake(2,1);
        [self.atomicNumber drawAtPoint:point withFont:font];

        // draw the element symbol

        font = [UIFont boldSystemFontOfSize:largeFontSize];
        CGSize stringSize = [self.symbol sizeWithFont:font];
        point = CGPointMake((elementSymbolRectangle.size.width-stringSize.width)/2,aFrame.size.height-(largeFontSize)-(largeFontSize/10));
        [self.symbol drawAtPoint:point withFont:font];

        //get image

        UIImage *theImage=UIGraphicsGetImageFromCurrentImageContext();

            UIGraphicsEndImageContext();

            return (theImage);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T00:15:42.007

知道了！

这是我击败 SDK 的方法。

由于某种原因，A UIImageView 不喜欢由 UIGraphicsBeginImageContext 生成的图像。因此，相反，我将我的类更改为标准 UIView（不是 UIImageView）的子类。然后我实现了drawRect方法。在 drawRect 方法中，我将与 UIGraphicsBeginImageContext 块中的代码相同。

出于某种原因，此代码在 drawRect 方法中正确渲染了图像，但在 UIGraphicsBeginImageContext 中却没有（可能是错误，可能是我）。

代码如下。

```
- (void)drawRect:(CGRect)rect {

    UIImage *backgroundImage = [UIImage imageNamed:imageFile];
    CGRect elementSymbolRectangle = CGRectMake(0.0f ,0.0f, backgroundImage.size.width, backgroundImage.size.height);
    [backgroundImage drawInRect:elementSymbolRectangle];

    // draw the element name
    [[UIColor whiteColor] set];

    // draw the element number
    UIFont *font = [UIFont boldSystemFontOfSize:(smallFontSize)];
    CGPoint point = CGPointMake(2,1);
    [self.atomicNumber drawAtPoint:point withFont:font];

    // draw the element symbol

    font = [UIFont boldSystemFontOfSize:largeFontSize];
    CGSize stringSize = [self.symbol sizeWithFont:font];
    point = CGPointMake((elementSymbolRectangle.size.width-stringSize.width)/2,self.frame.size.height-(largeFontSize)-(largeFontSize/10));
    [self.symbol drawAtPoint:point withFont:font];

} 
```

（此外，此代码可以在 Apple 示例代码中找到：theElements）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T18:37:58.143

您是否检查过 UIImageView 的缩放/调整大小选项？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-06T17:27:44.940

我对 drawInRect 和 CGContextDrawImage 都有类似的问题，最右边的 2 个像素以某种方式变为白色或反转。解决方案是使用不使用 alpha 通道的 PNG 图像。

# sql - SQL Server 到 mySQL 转换器

> ID：476296
> 
> 赞同：0
> 
> 时间：2009-01-24T16:43:13.973
> 
> 标签：sql, mysql, sql-server, database, data-migration

海技术，

我有一些用 SQL server 编写的存储过程。现在我想将它迁移到 mysql。是否有任何免费软件工具可以为我做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T16:53:31.223

我不这么认为。您可以只执行查询来创建过程，即：

```
CREATE PROCEDURE Blah(foo int, bar text)

END; 
```

（我认为）然后问任何问题或谷歌出现的任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T17:21:25.677

[此链接](http://dev.mysql.com/doc/migration-toolkit/en/index.html)提供了一个用于数据迁移的工具包，但您可能必须手动处理存储过程。另一个建议是，如果您可以找到将 SP 迁移到 DB2 的转换工具，您可能会更轻松，因为 MySQL 过程在风格上接近 DB2。

# speech-to-text - 所有语音到文本的算法都是实时运行的吗？

> ID：476299
> 
> 赞同：2
> 
> 时间：2009-01-24T16:44:52.583
> 
> 标签：speech-to-text

当前技术的所有语音到文本算法都是实时运行的吗？我不是指一个人坐在电脑前拿着麦克风，而是输入一个预先录制的音频文件。

ie 如果你有一个 30 分钟的录音，是否总是需要 30 分钟才能被转录？

有不同的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T16:56:50.733

没有什么比实时更快地阻止算法运行。Naturally speak 10 Professional 软件程序提供“从文件转录”选项，用于转换离开计算机时的听写，其运行速度与运行它的计算机一样快。

我相信批处理实现存在于信号智能领域，但这样的程序自然不会被普通大众使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T16:51:20.510

没有理由说语音识别必须花费与要执行的音频长度一样长的时间。但是，由于需要计算，我认为您不会获得比实时算法快得多的算法。有关更多详细信息，请参阅Wikipedia 文章的[这一部分](http://en.wikipedia.org/wiki/Voice_to_text#Performance_of_speech_recognition_systems)（它似乎没有给出任何时间，尽管它确实给出了一个不错的性能概述）。

# c++ - C++ 为什么这个向量访问会产生运行时错误？

> ID：476304
> 
> 赞同：1
> 
> 时间：2009-01-24T16:47:10.300
> 
> 标签：c++, runtime-error

我在这行代码中挑出了一个运行时错误：

```
for (synsAuxCopyIndex=1; synsAuxCopyIndex<synsAux.size(); synsAuxCopyIndex++) 
```

在函数内部`pushSynonyms(string synline, vector<WordInfo> &wordInfoVector)`运行。我不明白为什么这条特定的行会产生错误，因为我认为我没有索引任何超出范围的内容。

调试器说：

```
Uncontrolled Exception 0x00411cbf in program.exe: 0xC0000005: Infracción de acceso al leer la ubicación 0x00000000. 
```

我猜“Infraccón de acceso”会在英语调试器上翻译为未经授权的访问。

输入文件是

字典.txt

```
1 cute
2 hello
3 ugly
4 easy
5 difficult
6 tired
7 beautiful
synonyms
1 7
7 1
antonyms
1 3
3 1 7
4 5
5 4
7 3 
```

* * *

```
#include <iostream>
#include <fstream>
#include <string>
#include <sstream>
#include <vector>

using namespace std;

class WordInfo{
 public:                
  WordInfo() {}

  ~WordInfo() {}

  int id() const { return myId; }

  void readWords(istream &in) {
    in >> myId >> word;     
  }

  vector<int>& getSynonyms () {
    return mySynonyms;
  }

  vector<int>& getAntonyms() {
     return myAntonyms;
  }

  string getWord() {
    return word;
  }

  void pushSynonyms (string synline, vector<WordInfo>& wordInfoVector) {
    stringstream synstream(synline);
    vector<int> synsAux;
    int num;
    while (synstream >> num)
      synsAux.push_back(num);
    int wordInfoVectorIndex;
    int synsAuxCopyIndex;
    for (wordInfoVectorIndex=0;
         wordInfoVectorIndex < wordInfoVector.size();
         wordInfoVectorIndex++) {
      if (synsAux[0] == wordInfoVector[wordInfoVectorIndex].id()) {
        // this is the line that's generating a Runtime Error, Why?                                                       
        for (synsAuxCopyIndex = 1;
             synsAuxCopyIndex < synsAux.size();
             synsAuxCopyIndex++) {
//        wordInfoVector[wordInfoVectorIndex].mySynonyms.push_back(
//            synsAux[synsAuxCopyIndex]);
        }                                                          
      }     
    }
  }

  void pushAntonyms (string antline, vector<WordInfo> wordInfoVector) {
    stringstream antstream(antline);
    vector<int> antsAux;
    int num;
    while (antstream >> num)
      antsAux.push_back(num);
//    for (int i=0; i<antsAux.size(); i++){
//      cout<<antsAux[i]<<endl;  
//    }
  }

  //--dictionary output function
  void printWords (ostream &out) {
    out<<myId<< " "<<word;     
  }

  //--equals operator for String
  bool operator == (const string &aString) const {
    return word ==aString; 
  }

  //--less than operator
  bool operator < (const WordInfo &otherWordInfo) const {
    return word<otherWordInfo.word;
  }

  //--more than operator
  bool operator > (const WordInfo &otherWordInfo) const {
    return word>otherWordInfo.word;
  }

 public: 
  vector<int> mySynonyms;
  vector <int> myAntonyms;

 private:
//vector <int> mySynonyms;
//vector <int> myAntonyms;
  string word;
  int myId;
};

//--Definition of input operator for WordInfo
istream & operator >> (istream &in, WordInfo &word) {
  word.readWords(in); 
}

//--Definition of output operator
ostream & operator << (ostream &out, WordInfo &word) {
  word.printWords(out);  
}

int main() {
  string wordFile;
  cout << "enter name of dictionary file: ";
  getline (cin, wordFile);
  ifstream inStream(wordFile.data());
  if (!inStream.is_open()) {
    cerr << "cannot open " << wordFile << endl; 
    exit(1);                      
  }

  vector <WordInfo> wordInfoVector; 
  WordInfo aword;

  while (inStream >> aword && (!(aword == "synonyms")))
    wordInfoVector.push_back(aword);

  inStream.clear();

  int i=0;          
  while (i < wordInfoVector.size()) {
    cout << wordInfoVector[i] << endl;
    i++;
  }

  vector <int> intVector;
  string synLine; 

  while (getline(inStream, synLine) && (synLine != ("antonyms")))
    aword.pushSynonyms(synLine, wordInfoVector);

  int theIndex;
  for (theIndex=0;
       theIndex < wordInfoVector[0].mySynonyms.size();
       theIndex++)
    cout << "the synonyms of 1 are " <<
        wordInfoVector[0].mySynonyms[theIndex] << endl;
  cout << "the size of mySynonyms of 1 is " <<
      wordInfoVector[0].mySynonyms.size() << endl;

  for (theIndex=0;
       theIndex < wordInfoVector[0].mySynonyms.size();
       theIndex++)  
    cout << "the synonyms of 7 are " <<
        wordInfoVector[6].mySynonyms[theIndex] << endl;
  cout << " the size of mySynonyms of 7 is " <<
      wordInfoVector[6].mySynonyms.size() << endl;

  string antLine;
  while (getline(inStream, antLine))
    aword.pushAntonyms(antLine, wordInfoVector);    

  wordInfoVector[0].mySynonyms.push_back(1);
  system("PAUSE");
  return 0;          
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T17:04:54.337

如果您在程序中添加一些调试输出，您会注意到您从未进入甚至到达“罪魁祸首”for 循环。

问题实际上是针对其正上方的“synsAux[0]”的测试 - synxAux.size() 为零，因此访问第零个元素是索引越界错误。

# qt - Qt Creator - 意见和想法

> ID：476323
> 
> 赞同：8
> 
> 时间：2009-01-24T16:55:59.427
> 
> 标签：qt, ide

我正在寻找任何有机会使用 Troll Tech 的新 IDE [Qt Creator](http://www.qtsoftware.com/developer/qt-creator)的人的反馈。它目前处于公开测试阶段，因此可能还没有很多人使用它。但是，我认为任何第 3 方反馈都可能有用。

此外，如果您进行大量 Qt 开发，那么了解您所依赖的 IDE 以及为什么您认为它是 Qt 开发的最佳选择也是非常棒的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-25T19:29:05.987

Qt 创建者的目标是让 Qt 更容易上手，并与诺基亚的其他战略步骤（如 LGPLing Qt）一起旨在加速该工具包的采用。

Qt Creator 不与 Eclipse 或 Visual Studio 竞争，尽管它可以在许多场景中取代它。它是一个轻量级 IDE，在 Windows 上还包含完整的开发工具链。从零开始，它就聚集了一个活跃的开发人员和测试人员社区。虽然最初的重点是基于 qmake 的项目，但想法是它将通过其基于插件的架构支持其他工具。

您可以在页面上查看[一些视频](http://www.qtsoftware.com/developer/qt-creator)

最令人耳目一新的功能之一是进入“全屏”并忘记您正在使用 IDE 是多么容易。最后请记住，它被认为是测试版，您可能会遇到偶尔的段错误。总而言之，我看到了 Qt 创造者的光明未来。

（免责声明，我公司创建了Qt Creator 使用的[跨平台安装程序）](http://bitrock.com)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T18:11:42.767

我正在使用 Visual Studio 2008 和 Visual Studio 的商业 QT 集成，它是最好的。不幸的是，我没有机会尝试 Qt Creator。

**编辑：** QT 集成确实不适用于开源开发。至少合法...以前[我](http://btjunkie.org/)
使用 KDevelop 使用 QT，使用 minGW 并仅使用 Visual Studio 没有集成，创建`.vcproj`使用 qmake 并使用设计器编辑控件。

与上述大多数插件相比，集成插件有一些优点：

*   它包含设计器的所有功能以及更多您在设计器中无法获得的相关功能，例如双击小部件以轻松将信号从它连接到小部件类中的插槽的能力。
*   对所有 QT 类型和通用容器的完全调试器支持。这基本上是对 VC 的 autoexp.dat 文件的补充。
*   可视化管理嵌入图像，很像 VC 的资源管理器
*   自动为从 QObject 派生的类创建 moc 文件，而无需通过 qmake。事实上，你甚至不需要了解 qmake。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-25T19:42:38.737

有几个实用程序可让您将 Visual Studio 与 GPL 版本一起使用（即没有商业集成工具）

我没有更永久的链接（[http://www.qtcentre.org/forum/f-qt-programming-2/t-the-how-to-guide-qt4-with-visual-studio-2008- 10999.html](http://www.qtcentre.org/forum/f-qt-programming-2/t-the-how-to-guide-qt4-with-visual-studio-2008-10999.html) ) 这些在 VS2005/8 中为您处理额外的 moc 步骤 - 希望 LGPL 版本将为更多工具创造动力

编辑 - 随着 QT 的 LGPL 版本，[Visual Studio 插件](http://www.qtsoftware.com/downloads/visual-studio-add-in)现在也可以免费使用

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T14:49:57.903

我肯定会推荐 Qt 创建者。在这一点上它非常简单，但也令人耳目一新且易于使用。诸如上下文相关帮助和智能代码完成之类的东西使它值得。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-28T18:03:21.563

我已经将它用于 C++ 代码编辑器几个小时了，我的第一印象是 Qt Creator 很敏捷，代码完成速度很快，似乎适用于我有限的测试。我也喜欢干净的外观。我一直在寻找用于 Linux 的 C++ 代码编辑器来替代 GVIM，并且我喜欢我目前在 Qt Creator 1.0 中看到的内容。如果他们继续开发它，并使它成为一个通用的 IDE，而不仅仅是用于创建 Qt 应用程序，我可以看到自己放弃了 GVIM 而使用 Qt Creator。顺便说一句，1.1 刚刚发布。今晚下载...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T18:34:35.333

说实话，我认为它给 .Net GUI 创建工具带来了巨大的挑战。如果“旧”QT 比 MFC 工具好，那么新的 QT 创建者会提供一个令人兴奋的工具。

但我不会将它用于 GUI 以外的其他东西，它太像孩子了......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-28T22:52:35.977

对我来说，即使是远程考虑 Qt Creator，调试器也必须与 Microsoft 在 Visual Studio 2010 中提供的工具相媲美。我知道 Qt Creator 与 GDB 相关联，但这根本不足以让我成功。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-07-25T18:39:02.737

我目前正在 Debian Squeeze 上试用 Qt Creator 2.0.0 版。拥有一个真正跨平台的可与 Visual Studio 相媲美的 IDE 真是太好了。我在工作中使用 VS 来维护 MFC 应用程序（除其他外），虽然我还没有完全探索它，但它对于原生 C++ 似乎和 Visual Studio 一样好，包括调试。无论如何，VS 只能在 Windows 上运行，所以作为 GNU/Linux 用户对我来说没有好处

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-08-04T15:34:48.770

我非常喜欢 Qt Creator；我已经使用它一年多了。我在 Linux 上使用它，所以我无法将它与 Visual Studio 等进行比较，但我确实更喜欢它而不是 KDevelop 3/Kate，这是我的主要参考点。我没有广泛使用 Eclipse。以下是我喜欢的东西：

*   好，快速的代码自动完成（Ctrl+Space）
*   访问项目中文件的快速方法。底部的对话框允许您对文件进行不区分大小写的搜索/打开；比点击目录好得多。
*   Ctrl+单击功能允许您单击变量并找到它的声明位置。Ctrl+单击类类型将带您进入类声明。
*   支持重命名变量、类、函数
*   查找变量、函数的用法。（不完美，某些模板类型很难使用）
*   智能缩进相当容易设置。（虽然 emacs 最适合智能缩进 IMO）
*   页边距线为 80 个字符（可能看起来很小，但对我来说很重要）
*   能够在编辑器中签出或至少使文件可写。（再次，另一件小事，但对我来说很重要）
*   对喜欢这种东西的人有 vi 模式。

老实说，我实际上是使用 Qt Creator 进行一般的源代码编辑；对于实际的 Qt 开发，我并没有做那么多。但是，当我这样做时，它有一个很好的功能，可以在创建 .ui 表单时创建关联的 .hh、.cc 文件类，所以这是一个巨大的帮助。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-02-23T10:04:57.023

很高兴在 SO 找到这个问题。我认为这将是供应商特定问题的边界线。

几周以来，我一直在使用 QT Creator 2.0.1（在 OS X 上）。部分好，部分不好。我最想念的是一种将 IDE 与我最喜欢的编辑器[SubEthaEdit](http://www.subethaedit.net/)集成的简单方法。编辑就像手套一样的私人物品。你熟悉他们，然后很难切换。QT Creator 为我提供了编辑器的所有*功能*，但使用起来感觉很奇怪。我确信这种集成目前在技术上是可行的（= 根本不需要在 Creator 中打开编辑窗格）。

否则，感觉Qt。这是一种非本机 OS X，有时会遇到麻烦，但不是很多。好吧，使用命令行和 SEE 可能是我最终的最佳选择。对不起，创作者。不错的尝试。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-10-09T19:13:03.990

坚持下去，您不花时间弄清楚IDE的功能这一事实并不意味着它没有这些功能。你想使用自己的编辑器，去吧

关于那个调试器，截至 2010 年的 VS 调试器是一个符合标准的调试器，带有一些 MS 扩展，GDB 一直是兼容的并且确实有额外的模块，MS 稍微快一点，但至少对我来说没有什么是真正重要的，无论哪种情况目前没有一个是速度最好的，而是英特尔的编译器。您还可以选择带有 gdb 的 gdbservers。

Visual Debugger 有这个功能，你可以在检测到错误时停止，更正它然后继续，这对许多程序员来说非常方便，而另一些人则批评这助长了“马虎的编程态度”。

Visual Studio 调试器无法跟踪到内核模式代码。但是，这可以使用免费的 VisualDDK 扩展来实现。或者，通常使用 WinDbg、KD 或 SoftICE 执行 Windows 的内核模式调试。

Visual Studio 调试器也无法调试 Lambda-Expressions 或 Linq。

Visual Studio 很好，是的，实际上它可能是微软做过的最好的东西（这没什么好说的）。它最适合 .net 和 C#，但是当涉及到其他任何东西时，平衡要么是均匀的，要么是不利的，要么是 VS。

此外，我们必须考虑到我们中的许多人已经习惯了某些工具，并从这些工具的角度看待事物，无意识地认为其他解决方案是有缺陷的。人们会倾向于提升他们更有经验的工具，并且由于 VS 是最常见的，大多数人会倾向于推广它。

此外，如果一个人无法区分，那么一个人就不需要那个不同的东西，至少现在还不需要，一旦你需要它，你就会知道你需要什么来满足你的特定需求。

另外...这取决于您要编写的代码，办公和低端应用程序会看到很多 .NET 和 C#（.net 程序员往往很懒惰），在这种情况下，您最明智的选择是 Visual Studio，但可以说您从事电信、医疗或航空航天等高端业务，您将有其他更适合您的选择。

# python - 修剪 Mako 输出

> ID：476324
> 
> 赞同：4
> 
> 时间：2009-01-24T16:56:22.780
> 
> 标签：python, layout, template-engine, mako

我真的很喜欢在 Pylons 和其他几个 Python 框架中使用的 Mako 模板系统，我唯一的抱怨是即使是一个简单的继承方案也会有多少 WS 泄漏。

无论如何要在下面完成，而不会造成如此巨大的 WS 差距......或者像我开始使用 base.mako 那样打包我的代码？

否则，要掌握我要在下面完成的工作。

Base 有点像整个应用程序的所有视图的界面类，布局只是 3-4 个不同布局文件（表格、纯 CSS 等）的原型想法，控制器/动作是一个测试，以确保我的想法是理智的。

问题的简短摘要：如何删除在我的 Mako 方案中创建的 WS？

[更新：这不是一个解决方案，因为它涉及使用 \'s http://www.makotemplates.org/docs/syntax.html#syntax_newline](http://www.makotemplates.org/docs/syntax.html#syntax_newline)播种我所有的 mako 文件

/base.mako

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head><%def name="headtags()"></%def>${self.headtags()}</head>
  <body>
    <%def name="header()"></%def>${self.header()}${next.body()}<%def name="footer()"></%def>${self.footer()}
  </body>
</html> 
```

/layout.mako

```
<%inherit file="/base.mako"/>
<%def name="headtags()">
   ${parent.headtags()}
   <script src="http://ajax.googleapis.com/ajax/libs/prototype/1.6.0.3/prototype.js"></script>
</%def>
<%def name="header()">
  <h1>My Blogination</h1>
</%def>
<div id="content">${next.body()}</div> 
```

/控制器/action.mako

```
<%inherit file="/layout.mako" />
<%def name="headtags()">    
    <title> Hello world, templating system is 1 percent done</title>
    ${parent.headtags()}
</%def>
Hello ${c.name}! 
```

渲染输出：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>    
    <title> Hello world, templating system is 1 percent done</title>

   <script src="http://ajax.googleapis.com/ajax/libs/prototype/1.6.0.3/prototype.js"></script>

</head>
  <body>

  <h1>My Blogination</h1>

<div id="content">

Hello Anonymous!

</div>

  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T18:14:20.703

找到我自己的答案 [http://docs.makotemplates.org/en/latest/filtering.html](http://docs.makotemplates.org/en/latest/filtering.html)

它仍然需要一些试验和错误，但使用

```
t = TemplateLookup(directories=['/tmp'], default_filters=['trim']) 
```

显着减少了空白出血。通过检查已编译的模板并查找仅推送“ ”或类似内容的任何写入，可以找到额外的节省。

# scala - 如何在 Scala 中编写一个不错的低通滤波器

> ID：476328
> 
> 赞同：3
> 
> 时间：2009-01-24T16:56:54.837
> 
> 标签：scala, filter

我在我的一个 Scala 项目中需要一个低通滤波器并想出了这个：

```
def filter(numbers: Seq[Double], filterSize: Int): Seq[Double] = {
  assert(filterSize > 0)
  val ringBuffer = new Array[Double](filterSize)
  var ringBufferIndex = 0

  numbers.map(x => {
    // update ring buffer
    ringBuffer(ringBufferIndex) = x

    // increase ring index
    ringBufferIndex += 1 
    if (ringBufferIndex == filterSize) {
      ringBufferIndex = 0
    }

    // get avarage
    ringBuffer.foldLeft(0.0)(_ + _) / filterSize
  })
} 
```

但是，有一些我不喜欢它的地方：

*   它使用 map（功能很好），但需要一个可变变量（ringBufferIndex - BAD）。
*   它工作正常`Seq[Double]`（这很好），但返回`Seq[Double]`，这是不好的，因为它需要调用者调用`.toList`或他实际使用的任何东西。我尝试在这里使用泛型，如下所示：

    `def filter\[T <% Seq[Double]](numbers: T, filterSize: Int): T`

但这不会编译。

有没有人建议如何改善这两个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-25T03:08:43.447

如果索引查找有问题（*O(n)* with `List`），您可以使用[持久向量](http://github.com/djspiewak/scala-collections/tree/master/src/main/scala/com/codecommit/collection/Vector.scala)。这为您提供了*O(1)*索引以及*O(1)*更新。它也是纯函数式的（不可变的），所以在这方面生活仍然很快乐。

稍加想象，我们可以使用以下方法将您的代码直接转换为纯功能版本`Vector`：

```
def filter(numbers: List[Double], size: Int) = {
  def walk(numbers: List[Double], buffer: Vector[Double], i: Int): List[Double] = {
    numbers match {
      case x :: tail => {
        val nextBuffer = buffer(i) = x
        val nextI = if (i == size) 0 else i + 1

        val avg = buffer.foldLeft(0.0) { _ + _ } / size
        avg :: walk(tail, nextBuffer, nextI)
      }

      case Nil => Nil
    }
  }

  walk(numbers, Vector.empty, 0)
} 
```

`numbers`请注意，这不是尾递归，因此当太大时它会崩溃。解决这个问题很容易，但我现在很懒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T14:52:30.117

要让您的方法采用泛型集合类型并返回相同的类型，我相信您需要更高种类的类型，如[更高种类的泛型](http://www.cs.kuleuven.be/~adriaan/files/genericshk/tcpoly-oopsla.pdf)论文中所述。不幸的是，当前的集合库早于 Scala 中的此功能，但这将在 2.8 中得到纠正。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T17:15:43.113

如果输入可以是 List 而不是 Seq，则可以使用 zipWithIndex 对其进行清理：

```
def filter(numbers: List[Double], filterSize: Int): List[Double] = {
  require(filterSize > 0)
  val ringBuffer = new Array[Double](filterSize)
  numbers.zipWithIndex.map(pair => {
    // update ring buffer
    ringBuffer(pair._2 % filterSize) = pair._1
    // get avarage
    ringBuffer.foldLeft(0.0)(_ + _) / filterSize
  })
} 
```

请注意，返回值现在也是 List，我将 assert 替换为 require。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T17:51:52.447

好的，所以我清理了一些。三种可能的数据类型有三个函数（自动解决问题#2）。我从上面拿了所有这些（一个用于 Array，一个用于 List，一个用于 Seq。）：

```
def filter(numbers: Seq[Double], filterSize: Int): Seq[Double] = {
  require(filterSize > 0)
  val ringBuffer = new Array[Double](filterSize)
  var ringBufferIndex = 0

  numbers.map(x => {
    // update ring buffer
    ringBuffer(ringBufferIndex) = x

    // increase ring index
    ringBufferIndex += 1 
    if (ringBufferIndex == filterSize) {
      ringBufferIndex = 0
    }

    // get avarage
    ringBuffer.foldLeft(0.0)(_ + _) / filterSize
  })
}

def filter(numbers: Array[Double], filterSize: Int): Array[Double] = {
  require(filterSize > 0)
  (0 until numbers.length).map(x => {
    (((x - filterSize) max 0) to x).foldLeft(0.0)((sum, index) => sum + numbers(index)) / filterSize
  }).toArray
}

def filter(numbers: List[Double], filterSize: Int): List[Double] = {
  require(filterSize > 0)
  val ringBuffer = new Array[Double](filterSize)
  numbers.zipWithIndex.map(pair => {
    val (value, index) = pair
    // update ring buffer
    ringBuffer(index % filterSize) = value
    // get avarage
    ringBuffer.foldLeft(0.0)(_ + _) / filterSize
  })
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T18:58:35.653

虽然我不了解 Scala，但我不会在这里使用环形缓冲区。据我了解，您希望在每个数组位置取前面 filterSize 元素的平均值。因此，从左到右遍历数组，保持一个累加器保存先前 filterSize 元素的总和（在每个步骤中添加最右边的元素并减去最左边的元素）并`accumulator/filterSize`作为该位置的值产生。一个因素 filterSize 的添加更少，而且原则上纯粹是功能性的。在 Scala 中编写代码不方便吗？

（如果溢出不是问题，我会做一些更简单和更可并行化的事情：计算整个数组的运行总和（`scanl (+) 0 numbers`在 Haskell 中）并产生运行总和减去运行总和置换 filterSize 位置。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T17:12:35.257

这是我为解决第一个问题而提出的较短版本：

```
 def filter(numbers: Seq[Double], filterSize: Int): Seq[Double] = {
    assert(filterSize > 0)
    (0 until numbers.length).map(x => {
      (((x - filterSize) max 0) to x).foldLeft(0.0)((sum, index) => sum + numbers(index)) / filterSize
    })
  } 
```

它的缺点是索引查找对于“列表”之类的东西可能非常糟糕。

# r - 转换 12-okt-2007 形式的本地化日期

> ID：476342
> 
> 赞同：3
> 
> 时间：2009-01-24T17:09:29.570
> 
> 标签：r, date

我已导入具有以下格式日期的时间序列：

```
 test = c("11-Feb-01","12-Feb-01","01-Mai-08") 
```

这产生：

```
> as.Date(test, "%d-%b-%y")
[1] NA           NA           "2008-05-01" 
```

由于 May 已被翻译，因此显然将语言环境考虑在内。

根据文档， %b 应该是月份的缩写名称，但我想那里可能存在一些问题。

我将如何解决这个问题？

我在 Linux t2.6.27-9-generic #1 SMP 下运行 R

* * *

更新：深入挖掘我发现问题出在 LC_TIME 定义中，其中适当的缩写形式为：

```
"jan.","feb.","mars", "apr", "mai", "juni", "juli", "aug.","sep.","okt.","nov.", "des." 
```

而我的数据包含：

```
"Jan", "Feb", "Mar", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Des" 
```

我想我可以考虑对数据进行预处理，但是在 R 中进行此操作的平滑方式将是最受欢迎的。

* * *

这有点工作，但不是那么优雅：

```
> as.Date(gsub("Feb","feb.",test), "%d-%b-%y")
[1] "2001-02-11" "2008-02-12" "2008-05-01" 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T22:47:41.913

我找到的最接近解决方案的方法是对数据进行多次迭代，以用可以解析的内容替换月份的名称。

我不确定这是否是最好的解决方案。

```
setwd("/home/tovare/Data")

v <- read.csv2("valuta_dag.sdv", 
  na.strings = c("NA","ND"), 
  header = TRUE, sep=";", skip=2)

v$Dato <- gsub("Jan","01",v$Dato)
v$Dato <- gsub("Feb","02",v$Dato)
v$Dato <- gsub("Mar","03",v$Dato)
v$Dato <- gsub("Apr","04",v$Dato)
v$Dato <- gsub("Mai","05",v$Dato)
v$Dato <- gsub("Jun","06",v$Dato)
v$Dato <- gsub("Jul","07",v$Dato)
v$Dato <- gsub("Aug","08",v$Dato)
v$Dato <- gsub("Sep","09",v$Dato)
v$Dato <- gsub("Okt","10",v$Dato)
v$Dato <- gsub("Nov","11",v$Dato)
v$Dato <- gsub("Des","12",v$Dato)

v$Dato <- as.Date(v$Dato,"%d-%m-%y") 
```

# c# - 了解 C# 中的 OO 设计的那一刻

> ID：476348
> 
> 赞同：18
> 
> 时间：2009-01-24T17:11:44.540
> 
> 标签：c#, oop

我已经学习 C# 几年了，如饥似渴地阅读，甚至参加了一些 Microsoft 的 C# 数据访问课程。我也一直在阅读有关 OOP 的书籍。我正在编写一个基于 Web 的数据库应用程序。虽然我的职位不是“程序员”，但我很幸运能够将其作为一个副项目来工作。我在 80 年代初使用 Basic 编写代码，甚至擅长利用戳和窥视来操纵 Apple ][ + 和 TRS-80，让我的朋友们大吃一惊。但这是一种非常线性的编码方法。

话虽这么说，但有些事情并没有与我有关。无论是 C# 还是 OOP，我都没有那种让我能够坐下来、打开 VS2008 并开始编码的兴奋时刻。我必须大量研究其他人的代码，以至于看起来我自己什么都没做。我越来越气馁。

这不是我没有能力。我很快就学会了 t-sql。有人可以告诉我他们想要从数据库中得到什么信息，我可以在几分钟内编写出 tsql 来给他们想要的东西。SQL 是我得到的东西。使用 OOP 或 C# 不会发生这种情况。诚然，C# 本质上更复杂，但在某些时候它必须点击。对？

我阅读了stackoverflow，我对你们都是多么的聪明感到不知所措。

是什么让你点击了？

**编辑添加：** 这里的很多答案都很出色。然而，特别是一个似乎已经上升到顶部，这就是我标记为“答案”的那个。我也讨厌没有用答案标记我的问题。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-24T17:32:00.100

学习接口对我有用。来自脚本背景并切换到 OO，我没有看到创建所有这些类的效率更高。然后我读了[Head First Design Patterns](http://oreilly.com/catalog/9780596007126/)，突然间我明白了为什么。这不是最详细的书，但它是解释 OO 编程的“原因”的美妙的第一步，这是我为之苦苦挣扎的东西。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-24T17:46:21.023

SO上的大多数海报并不是特别聪明。有几件事可能会让你认为是这种情况。首先，只有碰巧知道或认为自己知道答案的人才会费心回应。其次，不正确/不好的问题和答案是不可见的。第三，很自然，集体知识将远大于个人知识。

你误认为智力的事情是在竞技场上度过的时间。你花在学习上的时间和精力越多，你就会变得更好、更有知识。从您所说的来看，您并没有以最佳方式处理事情。了解特定语言仅提供语法和语法规则。成为一名优秀的开发人员的关键是成为一名优秀的思考者。不要专注或沉迷于一种语言。

Craig Larman 和 Bruce Eckols 以及 Head Start 书籍非常适合这种学习模式。但是，我必须警告你，看书和炼功是不够的。你必须让自己沉浸在与其他开发人员的讨论和反馈中（当然，除非你是一个非常聪明的人——在这种情况下你会很容易地得到它......）。

你已经表现出比智力更重要的特质。你有谦虚。如果你有谦逊和毅力，你会比 SO 上的绝大多数海报更有效率和知识渊博。

谦虚也很重要，因为它可以帮助你应对这样一个事实，即无论你多么努力工作和学习多少，你永远不会比 Jon Skeet 了解更多。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-24T17:58:15.430

写代码。很多。糟糕的代码，好的代码，无用的代码——没关系。就写吧。当您厌倦了编写代码时（如果您偶尔不厌倦，说明您写得不够多），请阅读有关代码的博客、杂志和书籍。

然后，回过头来看看你之前写的一些代码。重构、清理并更改设计。添加功能，修复错误，等等 - 没关系。删除现有代码，并编写更多代码。

在某些时候，您将开始使用 C# 进行思考——就像您在 SQL 中所做的那样。

请注意，这类似于通过沉浸其中来学习外语。当然，你可以在学校学习，读一本书，听磁带。但是，没有比搬到每天说外语的地方学习外语更好的方法了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-24T18:29:02.887

第一个问题：你每周编码多少小时？

第二个问题：你知道在现实生活中谁会得到它？去和他们谈谈！！！

...

面向对象编程是一种组织和最小化重复自己的编程方式。这使得代码更少，并且更容易更改代码（因为一切都只在一个地方）。

你遇到了问题，所以我可以假设你没有理解继承的需要。继承是一种减少重复代码的方法。OOP 的另一个主要部分是类。类的重点是以保持它们良好组织的方式对事物进行分组，并使它们保持封装以减少耦合（从而使更改代码更容易！）

这就是它的全部。

现在出去 24/7 全天候地编程，找到现实生活中真正了解这些东西的人，然后说他们的耳朵。

祝你好运。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-24T17:15:40.540

1.  我的第一步：理解 Turbo Pascal 5 中的 FOR 循环。这永远改变了我的生活。
2.  第二步：了解每个对象有点像按钮（或任何其他 ui 控件），只是通常不可见。

您可能有兴趣阅读以下内容：

[编码恐怖：将编程绵羊与非编程山羊分开](http://www.codinghorror.com/blog/archives/000635.html)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-24T17:17:47.133

我记得这种感觉。我被签约在 ASP.NET 和 C# 中开发一个应用程序。问题是，我不是 C# 开发人员，而雇主知道这一点！但是因为我以前和他们有过编程经验，所以他们鼓励我试一试。我是一名 PHP 开发人员，正在步入 .NET 世界。

第一周令人沮丧。我记得我很生气地问为什么我不能只包含（“sideNavigation.php”）来让我在页面上导航。相反，我必须进行一些控制，将其添加到其他一些控制中——这没有任何意义。但我一直在读。

ASP.NET 开始流行起来，标记变得很有意义。随着我学习标记方面，我开始对代码隐藏变得更加熟悉。我知道更多事物存在哪些属性和方法，以及它们接受哪些类型的值。

当然，像[www.learnvisualstudio.net](http://www.learnvisualstudio.net)这样的地方也派上用场了，提供 C# 和 VB.NET 的视频教程。

今天我仍然是一名 PHP 开发人员，但我对 .NET 感到很自在，因此我可以重新回到 VS2008 并进行修改，直到我得到我的解决方案。

我的朋友，所有的事情都会随着时间流逝。另一个有用的事情是**找到一个 .NET 用户组并定期访问**。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-24T17:24:02.863

我不能给你真正的建议，因为你是完全正确的：它*必须*点击。OOP 很难解释，所以每个人都明白，就像一个人可能很难理解 Windows 消息、外主键以及几乎所有其他值得一提的话题。

我的建议是你尝试自己做一个真正的项目。它不必很复杂，但它必须包含几个类，这样您就可以着手处理继承和其他甜蜜的 OOP 内容。

我不认为任何阅读量都可以取代你自己的经验......直到它真的*点击*之前，假装你在黑暗中独自玩什么的......

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-24T17:47:11.803

我不确定您在 C# 旅程中的下落，但我确实发现[Head First C#](https://rads.stackoverflow.com/amzn/click/com/0596514824)是一本非常好的读物，并将其中的迷你项目用作练习。作为一个在阅读本书之前已经在业余时间学习了大约一年半的 C# 的人，它给了我一些迷你的“啊哈”时刻，例如，委托和回调。

当然，其中的一些示例是人为设计的，就像许多其他编程书籍一样，但是，嘿，谁不想构建自己的 Space Invaders？！

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-24T17:55:21.910

我同意杰里米·麦科勒姆的观点。也许您需要**停止阅读**并**开始做**！

好的，不要真的*停止阅读*，但在某些时候，成为一名更好的程序员的唯一方法是实际使用您正在尝试学习的工具/语言。

我的场景和你的很像。虽然我的日常工作**是** *程序员*，但它不是 C# 甚至 .Net。我让硬币掉下来的方法是真正开始做一个真正的项目。它甚至不是一个大项目，但它是一个真正的项目，我必须学习如何做一些我从未做过的事情（在 C# 中）。

完全按照你说的去做：坐下来，打开 VS2008，然后开始编码。去做就对了！

像真正的工作一样对待它，没有轻松的出局！假装你的工作取决于它。对我来说，确实如此，因为我确实想在未来的某个时候找到一份 C# 工作。如果我不能完成项目，那将永远不会发生。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-24T18:26:16.187

我的“点击”并非直接与 C# 相关，但我认为有三个实例与我在 C# 中轻松工作的能力有关。

1) 我 8 岁，试图编写一个看似简单的汇编程序来清除 Commodore 64 上的图形屏幕。在我本想用 Basic 编写循环的时候，我碰壁了。据我了解，没有办法用汇编语言编写一个可以跨越 256（单字节）障碍的循环。我翻遍了我拥有的书籍，但找不到解决方案。（答案当然不是为每组 256 行像素编写一个 3 字节的“行”代码。）几天后，它突然袭击了我。（解决方案是编写两个循环，外部循环实际上更改了内部循环的代码。）这不是我们需要用我们当前的语言做的事情，但我几乎可以感觉到我的大脑在成长。

2) 这也发生在我很小的时候。（可能是 10 次？）我的钢琴课已经发展到我必须用每只手演奏不同节奏的歌曲。我为这首歌苦苦挣扎了好几个星期（部分原因是我倾向于避免必要的练习）。练习有所帮助，但还不够。然后，有一天，我坐下来，突然咔哒一声。从那以后，这首歌几乎很容易播放。

3) 在大学期间，在我为了好玩而编程了几年之后，我的导师给了我们一个入门级的 OOP 作业。我们将使用一个包含其他几个对象的对象。这些中的每一个都在屏幕上画了自己。要完成任务，所有东西都需要旋转 45 度。几乎所有学生（包括我自己）都获得了部分学分，因为我们在包含对象内旋转了每个对象。那些获得满分的人只是简单地旋转了一件事：包含对象。我没有听到“咔嚓”一声，但是这节课确实帮助我理解了 OOP。

为了打破你自己的障碍，你可以按照上面的建议。也许找一个你清楚明白的简单项目，并用 C# 实现它。或者，您可以获取一个您相当了解的物理对象（例如带有方向盘、车轮、发动机、制动器等的汽车），并使用 C# 中的类对其进行建模。当然，您也可以通过简单地选择一个您没有得到目的的功能或关键字来实现“点击”，然后研究它直到它点击。一键可能足以完全闯入C#。

不管怎样，玩得开心！（当你不专注于有趣的事情时，你的潜意识总是更容易分析它。）

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-24T20:59:03.413

我认为对我来说最棒的时刻是，当我停止从汽车和蓝图的角度考虑 OOP 以及我的老师试图撬入我大脑的任何其他隐喻时，开始考虑它的实际应用真实的代码。

我写的第一个对象是我真正*明白的，它*是一个创建数据库连接的小类，并封装了一堆用于执行 SQL 查询的方法。在那之后，OOP 从老师们谈论的东西变成了对我和我的代码真正有用的东西。

所以，我的建议是，继续前进，继续学习，最重要的是，尽可能多地编写代码。是什么让某些东西对我或其他人点击，可能不会让它对你点击，所以你需要打造自己的道路。

正如其他人建议的那样，也许暂时放弃 C#，并尝试另一种语言。拓宽你的视野，也许学习一些 C++，或者在 Python 或 Ruby 上玩得一团糟。您将以全新的视角和清晰的调色板回到 C#，并且作为一个更好的程序员，也许那时您会变得更容易点击。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-25T07:00:33.307

试试这个：[找到一个大的 switch 语句并将其重构为 classes](https://elearning.industriallogic.com/gh/submit?Action=PageAction&album=codeSmellsAndRefactoring&path=recognizingSmells/moreCommonCodeSmells/switchStatementExample&devLanguage=Java)。这是一个很大的“啊哈！” 我的时刻。它是经典的重构，说明了过程设计和 OO 设计之间的区别，并且执行起来并不难。然后意识到 if 语句是小开关。

现在，去阅读[设计模式](http://en.wikipedia.org/wiki/Design_Patterns)。使用它们编写一些类。

接下来，获取一些提供某些功能的类，并在[*没有返回语句*](http://c2.com/cgi/wiki?TellDontAsk)的情况下重写它，最好使用接口。这是另一个大的“啊哈！” 为了我。

事实上，花一周时间阅读[c2.com](http://c2.com/cgi/wiki?WelcomeVisitors)是一个不错的选择。

希望对您的旅程有所帮助。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-24T17:39:57.713

不知道...对我来说，是 Turbo Pascal 6 引入了 OOP 的概念，但当时我并没有完全理解。然后我学会了 C++，一切都立刻变得一清二楚。来自 C++，C# 看起来非常简单，所以我不能说我对 C# 或 .NET 有过愉快的经历。

我猜你只需要写代码。很多代码。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-24T17:58:51.467

我完全可以同情。我拥有英语和电影学位；我在 20 多岁之前做过的唯一一次编程是在 Apply ][e，那时我 12 岁。经典 ASP 是我第一次涉足 Web 编程，我只是因为必须这样做才学会的，因为我是一名技术作家，致力于Intranet 项目记录房地产软件。

但最终编程开始了，我决定开始学习如何正确地做事。过渡并不容易。但我可以说学习 C# 用于 Web 开发，特别是如果你还没有“深入了解”OO，可能会令人生畏——主要是因为 OO 是关于创建和管理状态和有状态的，而 Web 本质上是无状态的。

信不信由你，我学到了更多关于 OO 使用 JavaScript 和 Flex 应用程序在 ActionScript 中编写 Ajax 应用程序的知识——即构建有状态的客户端——这比我试图强迫 C# 进入我的大脑，因为 Ajax 应用程序和 Flex 应用程序迫使你从状态的角度思考问题。在花了几年（是的，几年）编写大量 JavaScript 代码和大量 Flex 代码并阅读大量两者之后返回 C# 实际上非常容易，因为到那时，我意识到如何C# 应该可以作为 OO 语言使用。

Head First 系列书也很棒——人们在这里对它们轻描淡写，因为它们相当愚蠢，但它们教授了很棒的概念，我很惊讶这些年来他们的课程对我的影响如此之大。 [试试 OO 标题](https://rads.stackoverflow.com/amzn/click/com/0596008678)。还要花一些时间来玩弄 JavaScript。也许看看[Douglas Crockford 的](http://www.crockford.com/javascript/)作品。它会点击。给它一些时间。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-24T18:43:37.570

题外话，你知道你从哪里得到这个短语，“a-ha moment”：它来自一本书，来自其他人，还是原创的？因为我想我记得有人在 1994 年左右在线学习 OOP 和 C++ 时使用相同的短语。

无论如何：你的问题。

和你一样，我的编程经验早于 OOP：我也做过一些基本编程，还有 C。

正如您所说，在某种程度上，这是“一种非常线性的编码方法”。

当我开始学习 C++ 时，我是专业的 C 语言编程人员。所以就能够“坐下来，打开 VS2008，开始编码”而言，我几乎每天都在这样做：我坐下来用 C 语言编码。

它是事件驱动的编程：软件对事件做出反应，输入：来自网络，来自各种设备，来自 UI ......所以这样的话，即使是这个 C 代码也根本不像那种线性代码我们用来编写的命令式基本代码（“读取击键，写入屏幕”）。

所以这是一件事：事件驱动编程。事件驱动编程不是线性的，它可能有点难以概念化：一堆事件处理程序，一些独立的，一些以非固定顺序与每个处理程序交互。事件驱动编程不是 OOP（你可以用 C 编写事件驱动程序），但众所周知，OOP 擅长的事情之一是 GUI 和事件驱动编程。我建议 OOP 并不一定会让它变得容易：问题可能天生就很困难，而 OOP 让它变得更容易，而不是容易。

所以这是另一回事：如果你能做到这一点，那么你就做对了。不要指望一切都会很容易。一个好的解决方案可能使解决方案看起来简单明了，但是为大型、困难的问题开发一个好的解决方案并不容易，我们可能要感谢 OOP 使之成为可能。

无论如何，回到我的故事：我是用 C 编码的。我逐渐学会了使用 C++，例如：

*   我有一堆数据（结构）和一堆对这些数据进行操作的函数......将函数放在与它们操作的数据相同的结构中，“函数”变成“方法”
*   既然数据具有应该作用于该数据的关联方法，请将数据设为私有，以便其他方法无法直接接触它......封装和/或信息隐藏
*   现在我有了定义良好的类（其中一些已经相互包含作为数据成员），开始使用继承来实现不同类型之间的异同

对我来说，“啊哈”时刻之一是我们为不同类型的传真设备驱动驱动程序，每个设备都有不同的低级 API。使用 OOP，我们可以写...

*   一个简单的抽象类，它声明了我们希望所有设备都支持的简单的高级 API（如、、、、`sendFax`等`receiveFax`）`cancel`
*   子类，它使用特定硬件的API来实现从抽象基类继承的抽象API。

我刚刚想起了别的事情。当我学习 C++ 时，我阅读了各种书籍：

*   *Thinking in C++*学习阅读 C++ 的语法
*   *有效的 C++*学习编写 C++ 时要避免的各种规范战术错误

阅读了这些内容并经过大约 6 个月的练习，我可以将 C++ 用作更好的 C。

我接下来读的一本书是四人组的《*设计模式》：读那本书对我来说是一个“啊哈”的时刻，它让我想，“如果其他书告诉我***如何**在一个对象中写作面向编程语言，这本书向我展示了我**为什么**想要这样做。”

所以，有一个建议：阅读*设计模式*。

我一直在谈论 C++ 等等，因为那是我拥有第一个 a-has 的时代。我认为这很重要……很好地了解了 OOP 和 C++，我花了不到一周的时间就“坐下来，打开 VS2008，并开始在 C# 中编码”。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-01-24T19:47:24.260

1.  你需要一些你需要/想要完成的事情。
2.  坐下来创造它。
3.  在创建它时，您必须弄清楚您不知道的事情。这可能是识别这些东西是什么的最好方法。
4.  当你完成并有一些工作时，你回顾它并思考你可以做些什么不同的事情来更好地组织它。
5.  对这些具体的事情和可能的处理方法进行一些研究。
6.  创造其他东西并反思它。
7.  重复，直到你有一个哈哈的时刻。

对我来说，我的第一个惊喜时刻是在我的第三周培训期间学习霍尼韦尔汇编程序，并最终意识到计算机是如何工作的。

我的 OOP a-ha 时刻是在实时继电器梯形逻辑课程期间，我决定制作一个库来模拟我们必须编写程序的德州仪器硬件。它让我无需去学校使用真正的硬件就可以为班级编写/测试我的程序。它让我对 OOP 大开眼界。我相信那一刻的发生是因为我能够（用代码）模拟真实的东西。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-01-25T05:02:36.900

嗯，这就是我看到你的问题的方式。您来自 SQL，这是一种 4GL（第四代语言），它比 C# 之类的 3GL 更接近人类语言，就像有人用来驾驶飞机一样，驾驶汽车并没有什么大不了的。您应该尝试学习如何骑自行车（类似于 2GL 的汇编语言）或尝试驾驶低端汽车（例如 Fortan 或 C）来欣赏像 C# 这样的语言。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-01-25T05:30:08.310

正如之前的海报所提到的，请检查设计模式。

另外，我发现鲍勃叔叔的东西对学生和讲师都很有用，特别是一些 oo 设计原则：[http ://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-01-25T06:17:14.910

学习 C# 中的泛型对我来说是什么。现在我永远在 if-else 语句中思考。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-01-25T19:13:44.940

也许您面临的挑战是您对 SQL 太熟悉了。OO 和 Relational 是两个相互矛盾的概念。使用关系工具，您主要关注数据及其表示方式。每个编程任务都涉及以完成所需任务的方式处理数据。

另一方面，OO 涉及行为。OO 系统中的编程任务涉及调用适当实例中的行为以完成任务，并设计将以预期方式运行的对象类。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-01-25T23:43:09.547

[这篇关于为什么 getter 和 setter 是邪恶的煽动性文章](http://www.javaworld.com/javaworld/jw-09-2003/jw-0905-toolbox.html)挑战了我认为我在做 OOP 的方式。文章中提出的一些观点可能是微不足道的，但“尽可能告诉，不要问”的想法彻底改变了我对 OO 设计和编写代码的看法。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-01-24T17:36:52.667

任何语言的第一步都应该是“Hello World”教程。这种学习方法（也称为边做边学）背后的魔力在于，它把紧迫的必要性作为主要的学习动机。我自己是一名 C#.NET 开发人员，目前正在努力学习 F#。编写 HelloWorldApp 后我应该采取的步骤是设置小而简单的目标，例如

编写一个控制台应用程序，下载网络上的某个页面并显示其 HTML 内容。
再做一次，但现在是异步的。
再做一次，但现在是多个页面并行。

ETC

我就是这样学到东西的。对于 OOP，事情变得有点复杂，你也应该阅读其他人的代码和文章。帮助您学习 OOP 和自己重构的一件事是重用您自己的代码。在我上面的示例中，您会注意到为同步下载页面而编写的代码与用于异步下载页面的代码非常相似，它们甚至有一些 100% 相等的行。学习 OOP 你应该做的是重构和封装你的代码，所以你可以选择你想要的下载类型（同步或异步），同时在为这两个选项编写的代码中重复最少。如果您使用 TDD（测试驱动开发），学习曲线将会改善。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-01-24T17:44:29.313

我认为真正理解任何新技术的唯一方法就是日复一日地使用它。当然，你可以在高水平上学习很多新东西而不会太深入，但是要获得那个“啊哈”的时刻，真正了解语言和模式，你必须投入大量时间*来做这件事*。

可悲的是，这意味着你的主要工作必须是用 C# 编程。如果你只是在这里和那里做一系列的附带项目，那将会令人沮丧并且进展缓慢。

只是根据我自己的经验得出的看法...

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-01-24T20:06:57.090

以下内容并没有让 OO 对我产生影响（当我听到它时已经有），但我确实发现它是一个非常好的概括性描述。

我的一位同事喜欢引用他的一位大学教授的一句话，大概是这样的：

> 用数据类型标记的行和对数据的操作标记的列写出一个网格。如果您将实现水平切片，那么您就是在进行面向对象的编程。如果你垂直切片，你就是在做函数式编程。

尝试将 OO 视为一种组织代码的方式，其中对程序员定义的数据类型的操作实现捆绑到数据的定义中。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-01-25T04:31:59.067

面向对象设计一般需要精神上的依偎，但对我来说，在大学使用 JAVA 教我们 OOD 之后，C 型 OOD 似乎很自然。

在对需要优雅架构来满足某些用例的业余项目进行大量实践之后，OOP 似乎变得越来越自动化。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-01-25T06:53:50.247

这里有很多好的建议，尽管只有桑普森先生暗示找到合适的人来回答问题是有益的。我数不清有多少次我一直在看某人工作，打断他们问一个类似“你为什么要做*X*？”的问题。并在此后不久有一个哈哈的时刻。并非总是如此，但向足够多的人提出足够多的问题，思维融合就会发生，而且当它发生时它会很棒。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-01-25T18:51:59.353

我对 OOP 的“a-ha”时刻来自使用 .NET 框架。起初，我对将文本写入文件有多么笨拙感到恼火。然后我意识到我不需要决定我的对象是否要打印到文件中。我可以让它使用 TextWriter，让创建它的任何东西决定输出到文件或控制台的位置。然后我意识到创建一个将输出发送到 TextBox 的 TextWriter 子类是多么容易。然后我意识到这种想法是所有框架设计的基础。

突然间（这非常突然，就像发生在一个周末一样）框架以前所未有的方式变得有意义。而且我还意识到使用框架设计者在设计我自己的程序时使用的相同原则很容易。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-01-25T23:12:42.650

嗯，工厂和单例模式为我做到了。不过我仍然有麻烦，我确实觉得我没有使用完整的 OO 功能，但它始终是一个学习曲线。

我遇到的麻烦是弄清楚哪个类应该做什么，例如，员工对象是否应该有一个 RaiseSalary 方法来获取金额，或者 PayMaster 对象是否应该有一个方法来获取员工列表并计算要提高多少支付？我知道的薄弱的例子，但这是一个例子：P

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-01-25T21:35:42.237

**接口。**刚开始使用时，我了解了 OOP 和继承的基础知识，但是接口花了我不合理的时间来掌握。

当我第一次听说这些事情时，我立即对自己说：“我到底为什么需要创建一个*没有*任何实现的伪类东西 {my pet name for interfaces}？这不是重点吗？继承，这样我就不必一遍又一遍地重新键入相同的实现逻辑？”

所以，有一天我对自己说，“我想知道你是如何编写在具有特定方法的所有类型中通用的方法，而不必牺牲类型安全性”。然后我突然想到：这正是接口的用途！一旦我明白了这一点，一切都变得有意义，并且我自己发明了一些与工厂模式和观察者模式非常相似的设计模式。

就在那时它吸引了我，我能够在一个完全不同的层面上考虑 OOP。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-01-25T23:40:31.720

让 OO 对我来说很有吸引力的事情是学习基于 Prototype 的 OO，比如在[Io](http://www.iolanguage.com/)和[Self](http://en.wikipedia.org/wiki/Self_(programming_language))中。C# 的 OO 是一个非常不同的野兽：不是优雅和简单，而是毛茸茸的和复杂的。相反，简单并不意味着不那么强大！我建议先学习一个简单而优雅的系统。然后，如果你眯着眼睛，你可以看到 C# 中的 OO。

另一个 A-Ha 时刻是了解类型系统如何防止在编译时对错误的对象调用错误的方法。由于强制转换，C# 的类型系统并非在所有情况下都这样做。在阅读《对象技术杂志》上关于[类型理论的](http://www.jot.fm/issues/issue_2002_05/column5/index.html)[文章](http://www.google.com/search?q=site%3Awww.jot.fm+theory+of+classification)时，我得到了这个 A-Ha 时刻。

# c - *nix 伪终端如何工作？什么是主/从通道？

> ID：476354
> 
> 赞同：30
> 
> 时间：2009-01-24T17:17:05.733
> 
> 标签：c, linux, tty

我想在 Linux 系统上用 C 语言编写一个简单、愚蠢的 X 终端仿真器。

起初，我只是想我必须打开一个 shell 并显示它的输出。我检查了 xterm 和 rxvt 代码，它看起来有点复杂。

首先，我必须用 openpty 打开一个伪终端。所以我查看了手册页，发现 openpty 填充了 2 个文件描述符，即 master 和 slave。xterm 和 rxvt 代码都很混乱，因为这些特殊文件依赖于系统。

我了解 termios 的东西：它只是一堆关于终端转义码的信息。我真正不明白的是：我想用主/从文件描述符做什么？

打开终端、登录、在 shell 上执行“ls”的示例程序会很棒。

*（英语不是我的母语，请原谅我最终的错误）*

编辑：这是我想出的示例代码：

```
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <string.h>
#include <pty.h>
#include <utmp.h>
#include <ctype.h>

void
safe_print (char* s)
{
    while(*s) { 
        if(*s == '\n')
            putchar("\n");
        else if(iscntrl(*s))
            printf("\\e(%d)", *s);
        else
            putchar(*s);
        s++;
    }
}

int
main (int argc, char** argv)
{
    char buf[BUFSIZ] = {0};
    int master;
    int ret = forkpty(&master, NULL, NULL, NULL);

    if(ret == -1)
        puts("no fork"), exit(0);

    if(!ret) { 
        execl("/bin/sh", "sh", NULL);
        exit(0);
    }

    sleep(1); /* let the shell run */

    if(argc >= 2) {
        write(master, argv[1], strlen(argv[1]));
        write(master, "\n", 1);
    } else {
        write(master, "date\n", sizeof "date\n");
    }

    while(1) {
        switch(ret = read(master, buf, BUFSIZ)) {
        case -1:
            puts("error!"); 
            exit(1);
            break;
        case 0:
            puts("nothing.."), sleep(1);
            break;
        default:
            buf[ret] = '\0';
            safe_print(buf);

        }
    }

    close(master);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-25T00:56:22.967

关于您问题的主/从部分，来自[pty(4)](http://www.freebsd.org/cgi/man.cgi?query=pty&apropos=0&sektion=4&manpath=FreeBSD+7.1-RELEASE&format=html "pty(4) 手册页")手册页（从我系统上的 openpty(3) 手册页中引用）：

> 伪终端是一对字符设备，一个主设备和一个从设备。从设备向进程提供与 tty(4) 中描述的接口相同的接口。然而，尽管提供 tty(4) 中描述的接口的所有其他设备在它们后面都有某种硬件设备，但从设备却有另一个进程通过伪终端的主半部分对其进行操作。 **也就是说，写在主设备上的任何东西都作为输入提供给从设备，而写在从设备上的任何东西都作为输入提供给主设备。**

手册页是你的朋友。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-06-14T12:42:43.117

我刚刚尝试了[本教程](https://web.archive.org/web/20190925164611/http://rachid.koucha.free.fr/tech_corner/pty_pdip.html)中的示例，它们对我来说工作得很好，我认为它们是解决问题的一个有趣的起点。

编辑：本教程简要解释了伪终端功能。解释是一步一步完成的，后面是例子。

下面的例子展示了如何创建一个新的伪终端，并将进程分两部分进行*分叉，一个在伪终端的**主端写入，另一个从伪终端的**从*端读取。

```
#define _XOPEN_SOURCE 600 
#include <stdlib.h> 
#include <fcntl.h> 
#include <errno.h> 
#include <unistd.h> 
#include <stdio.h> 
#define __USE_BSD 
#include <termios.h> 

int main(void) 
{ 
int fdm, fds, rc; 
char input[150]; 

fdm = posix_openpt(O_RDWR); 
if (fdm < 0) 
{ 
fprintf(stderr, "Error %d on posix_openpt()\n", errno); 
return 1; 
} 

rc = grantpt(fdm); 
if (rc != 0) 
{ 
fprintf(stderr, "Error %d on grantpt()\n", errno); 
return 1; 
} 

rc = unlockpt(fdm); 
if (rc != 0) 
{ 
fprintf(stderr, "Error %d on unlockpt()\n", errno); 
return 1; 
} 

// Open the slave PTY
fds = open(ptsname(fdm), O_RDWR); 
printf("Virtual interface configured\n");
printf("The master side is named : %s\n", ptsname(fdm));

// Creation of a child process
if (fork()) 
{ 
  // Father

  // Close the slave side of the PTY 
  close(fds); 
  while (1) 
  { 
    // Operator's entry (standard input = terminal) 
    write(1, "Input : ", sizeof("Input : ")); 
    rc = read(0, input, sizeof(input)); 
    if (rc > 0) 
    {
      // Send the input to the child process through the PTY 
      write(fdm, input, rc); 

      // Get the child's answer through the PTY 
      rc = read(fdm, input, sizeof(input) - 1); 
      if (rc > 0) 
      { 
        // Make the answer NUL terminated to display it as a string
        input[rc] = '\0'; 

        fprintf(stderr, "%s", input); 
      } 
      else 
      { 
        break; 
      } 
    } 
    else 
    { 
      break; 
    } 
  } // End while 
} 
else 
{ 
struct termios slave_orig_term_settings; // Saved terminal settings 
struct termios new_term_settings; // Current terminal settings 

  // Child

  // Close the master side of the PTY 
  close(fdm); 

  // Save the default parameters of the slave side of the PTY 
  rc = tcgetattr(fds, &slave_orig_term_settings); 

  // Set raw mode on the slave side of the PTY
  new_term_settings = slave_orig_term_settings; 
  cfmakeraw (&new_term_settings); 
  tcsetattr (fds, TCSANOW, &new_term_settings); 

  // The slave side of the PTY becomes the standard input and outputs of the child process 
  close(0); // Close standard input (current terminal) 
  close(1); // Close standard output (current terminal) 
  close(2); // Close standard error (current terminal) 

  dup(fds); // PTY becomes standard input (0) 
  dup(fds); // PTY becomes standard output (1) 
  dup(fds); // PTY becomes standard error (2) 

  while (1) 
  { 
    rc = read(fds, input, sizeof(input) - 1); 

    if (rc > 0) 
    { 
      // Replace the terminating \n by a NUL to display it as a string
      input[rc - 1] = '\0'; 

      printf("Child received : '%s'\n", input); 
    } 
    else 
    { 
      break; 
    } 
  } // End while 
} 

return 0; 
} // main 
```

# ruby - proc可以在不使用调用方法的情况下执行吗？

> ID：476356
> 
> 赞同：1
> 
> 时间：2009-01-24T17:17:38.040
> 
> 标签：ruby

我从[这里](https://stackoverflow.com/questions/471952/-parameter-of-ruby-block)提出一个单独的问题。这真的让我很困惑。下面是 add_mapping 方法的定义：

```
def add_mapping(regexp, &proc)
  @test_mappings << [regexp, proc]
end 
```

如果不使用方法，这里如何`proc`执行并返回结果`call`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T18:49:17.043

Eric，add_mapping 所做的只是将一个正则表达式 + proc 元组添加到一个名为 @test_mappings 的数组中。

add_mappings 不执行过程。我不知道 ZenTest 是如何工作的，但它应该在读取所有 add_mapping 调用后执行 procs。

查看 ZenTest 的代码并注意 @test_mappings，它可以告诉您 proc 的执行位置（和时间）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T20:50:54.417

proc 可以通过作为块传递给 yielding 方法来执行，也可以通过手动调用来执行（正如你提到的）。

```
a_proc = proc { puts "The proc" }

def i_am_yielding
  yield
end

a_proc.call
# => "The proc"
i_am_yielding { puts "A block" }
# => "A block"
i_am_yielding(&a_proc)
# => "The proc" 
```

也许还有更多的方法，但我想不出任何方法。不过，我不确定在您的特定情况下这意味着什么。该 proc 位于一个数组中，该数组被添加到另一个数组中（我假设），并且在其他任何地方都没有被引用，因此在您粘贴到此处的那个简短片段中不会调用任何 procs。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T17:31:04.813

是的，根据[文档](http://www.rubycentral.com/book/ref_c_proc.html)，`[]`是`Proc#call`.

# delphi - opendialog.onhint 崩溃

> ID：476359
> 
> 赞同：2
> 
> 时间：2009-01-24T17:20:25.477
> 
> 标签：delphi, crash, fileopendialog, hint

我已经检查了 100% 我正在关闭我最近创建的文件的所有句柄。但是当我调用“opendialog.execute;”时 对话框像往常一样弹出，但是在鼠标悬停在最近创建的文件的提示上时，整个事情都会因越界错误而崩溃。

我知道这不是我的任何越界，就好像我打开文件而不引起（onhint）事件一样没有问题，并且硬编码文件名列表以进行测试表明打开或保存文件没有任何问题。它纯粹是在打开对话框的 onhint 事件上。就像我说的那样，如果我很快或者我使用箭头键，那么我的程序就没有问题。

更有趣的是，它甚至不会发生 100% 的时间，大约 70%，这导致我认为我已经修复了好几次，如果不仅仅是在很短的时间内。有谁知道会发生什么？如果不是，我该如何禁用 onhint 事件？

要求的代码根本没有帮助

```
OpenDialog.execute;    // crashes here
if fileexists(form1.OpenDialog.FileName) then    
  form1.Address.Text:=form1.OpenDialog.FileName; 
```

和错误 [链接文本](http://i44.photobucket.com/albums/f14/keahicheveyo/error.jpg)

编辑：好的，我有一些新信息 opendialog 的新实例仍然存在相同的问题。更有趣的是，我似乎已经解决了 30% 的问题，它提示带有双标签的文件，例如“test.jpg.enc”，它在第一次运行时就很好，它只会在提示时崩溃在这些编码文件中，但只有当我将该文件编码为白色时，应用程序才打开。例如，如果我对其进行编码，然后尝试解码并且它崩溃了..我可以再次运行它并很好地解码它，但是在应用程序的一个实例中解码然后编码没有问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T20:01:11.860

您确定创建了 form1 的实例吗？

如是：

你为什么不这样使用：

```
OpenDialog.Options:=  OpenDialog.Options + [ofFileMustExist];

if OpenDialog.Execute then
  Address.Text:= OpenDialog.FileName 
```

并使用 FastMM4，并在 FastMM4.inc 中定义 FullDebugMode。这可能会帮助您找到真正的问题

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T21:51:51.060

首先——几乎从不需要在代码中引用“form1.xxx”，/尤其是/如果您正在使用 Form1 的方法编写代码。我会删除那些引用。

然后，我会创建一个尽可能简单的应用程序——一个表单、一个 TOpenDialog 和一个按钮，并且我会尝试编写尽可能少的代码来打开相关文件。如果可行，请尝试找出您的简单应用程序和实际应用程序之间的区别。如果失败，请使用 /all/ 失败的简单程序的代码编辑上面的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T14:49:21.883

解决方案是使用activeX，似乎在SP2之后引入了一个错误

使用 ActiveX；

初始化 OleInitialize(nil);

finalization OleUninitialize 结束。

最初由狐狸[在这里发布](https://stackoverflow.com/questions/586482/is-there-a-way-to-disable-the-hint-for-a-topendialog-in-delphi)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T23:06:55.307

两件事情：

**使用Debug DCU**编译您的应用程序（*Project / Options / Use Debug DCU* 's - 然后进行*完整构建*），然后查看发生异常的位置。这将在 vcl/rtl 代码中何时发生异常时为您提供更多信息。向我们发布完整的错误消息以及它在哪个单元中失败。

其次，可能*更重要*的是，文件在您的应用程序之外的行为方式。您建议它在大约 30% 的情况下失败，因此每次保存文件后，在常规资源管理器窗口中浏览到它并将鼠标悬停在那里，看看提示是否正常显示。然后用记事本打开。如果这两个都有效，那么它会在您的应用程序中失败，这将是有趣的。

此外，当您发布上一个问题的后续问题时，如果您链​​接到上一个[问题](https://stackoverflow.com/questions/473966/very-strange-error-in-my-app-from-component)，这样我们就可以看到您之前尝试过的内容，这会很有帮助。

祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T10:49:49.787

错误消息不是越界而是访问冲突。这意味着您正在访问不属于您的内存。这主要发生在类变量（指向类的指针）未初始化或已被释放时。

我认为是form1的方法的代码可以使用一些更改（已经提到过）：

```
OpenDialog.execute;    // crashes here
if fileexists(OpenDialog.FileName) then    
  Address.Text := OpenDialog.FileName; 
```

但是什么是OpenDialog，是拖到form1的组件吗？在这种情况下，form1 可能未初始化。但最有可能的是 OpenDialog 是一个局部变量。在这种情况下，您可以初始化它：

```
OpenDialog := TOpenDialog.Create;
try
  OpenDialog.execute;   
  if fileexists(OpenDialog.FileName) then    
    Address.Text := OpenDialog.FileName;
finally
  OpenDialog.Free;
end; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-25T17:46:45.227

您对 Nick Hodges 的回答的评论表明您正在从 Form1 外部调用 Form1 的 OpenDialog。这似乎是个坏主意。相反，可以调用 Form1 的公共方法，并且该方法可以操作 Form1 的组件。我没有测试你的场景，但似乎这可能会导致你的麻烦。

# .net - 在使用 HTTP 的自托管 WCF（非 IIS）服务上托管文件或流数据？

> ID：476360
> 
> 赞同：1
> 
> 时间：2009-01-24T17:20:50.060
> 
> 标签：.net, wcf

是否可以在不涉及 IIS 的情况下在自托管 HTTP 配置的 WCF 服务上托管自定义数据，例如自定义 HTML 或 XML 文件？我说的是实例化自己的端点/侦听器的 ServiceHost 实例。

我有一个使用自托管 WCF 服务的应用程序，它有一个 Windows 窗体客户端，但我也在考虑添加一个轻量级 Silverilght 界面，但出于同样的原因，我不想使用 IIS。不想使用成熟的 SQL Server——我试图让整个东西在没有 IIS 依赖的情况下自行打包。（是的，我知道不涉及 IIS 不是最佳实践，因为它会降低可靠性和灵活性，但此功能不是其中的主要部分。）

如果这是不可能的，我将不得不在服务器上的完整 IIS 或客户端上的完整 WPF 之间进行选择，我只是好奇之前是否有人发现过这一点。

谢谢，

乔恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T04:59:06.210

好的，找到了我的答案。[OperationContract] 有一个 WebGet 属性，您可以分配一个 URL。然后，与此属性关联的方法可以返回一个 Stream 对象。

此处的示例：[将跨策略文件公开为 WCF 服务的一部分](http://blogs.msdn.com/carlosfigueira/archive/2008/03/07/enabling-cross-domain-calls-for-silverlight-apps-on-self-hosted-web-services.aspx)。:)

有了这个，我就可以在一个单独的端口上使用 Cassini 来通过 HTTP 服务 Silverlight .xap，并且仍然指向原始 WCF URL 处的 WCF 服务。从理论上讲，我什至可以托管 .xap 并包含来自类似 WCF 接口的 HTML，从而不再需要策略文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T06:34:05.207

我有一个示例应用程序可供下载，其中演示了如何托管或流式传输文件中的数据以处理（使用 WebGet 属性）连接到自托管 WCF 服务的 Silverlight 2 RTM 客户端的客户端访问策略要求。

该解决方案包含示例 Silverlight 以及 WPF 客户端项目和一个控制台应用程序项目，该项目自托管双工 WCF 服务并实例化从 ServiceHost 派生的类的实例，以公开不同类型的客户端的适当端点。

也许它可能会有所帮助......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T19:11:47.637

您是否查看过[System.Net.HttpListener](http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx)甚至[Cassini](http://www.asp.net/downloads/archived/cassini/)？也许其中任何一个都可以为您提供所需的东西？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T03:38:44.143

在 Windows 服务中托管 WCF 组件是否更适合您的用例？

# c# - 逐个标签验证 XML 标签

> ID：476364
> 
> 赞同：0
> 
> 时间：2009-01-24T17:23:45.563
> 
> 标签：c#, xml, validation, schema, tags

我在使用 .net 和 C# 针对 Schema 验证某些 XML 时遇到了一些问题。

我将 XmlReaderSettings 与 ValidationEventHandler 一起使用。

但是，这似乎在遇到 XML 文件中特定级别的第一个错误后停止捕获错误，而不是检查同一级别的下一个标签，因此基本上它不会检查 XML 文件中的每个标签发现错误时跳过一个级别。

我希望从成功完成此类验证的人那里得到一些建议。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T19:46:04.213

这听起来像您`xsd:sequence`在架构中定义了一个，并且当您的文档中元素的顺序与架构中定义的元素的顺序不匹配时，就会发生错误。

鉴于此架构：

```
<?xml version="1.0" encoding="utf-8"?>
<xsd:schema 
    attributeFormDefault="unqualified" 
    elementFormDefault="qualified" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <xsd:element name="Dog">
        <xsd:complexType>
            <xsd:sequence>
                <xsd:element name="Age" type="xsd:int"/>
                <xsd:element name="Name" type="xsd:string"/>
            </xsd:sequence>
        </xsd:complexType>
    </xsd:element>
</xsd:schema> 
```

这个XML：

```
<Dog>
    <Name>Rex</Name>
    <Age>three</Age>
</Dog> 
```

你会想象验证会产生两个错误：

```
1\. The element 'Dog' has invalid child element 'Name'.
2\. The 'Age' element is invalid - The value 'three' is invalid according to its datatype 
```

但是您只看到第一个错误。这是因为无效子元素的第一个错误使得它无法`XmlReader`解析文档的其余部分，因为它不再知道接下来会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T19:33:27.563

XMLReader 被描述为

> 提供对 XML 数据的快速、非缓存、只进的访问的阅读器。

从[API 文档](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.aspx)和您对应用程序行为的描述中，听起来好像引发了异常，并且定义了某种形式的验证回调方法，该方法执行非致命的操作（例如记录警告），然后将控制权返回给验证器比有问题的元素高一级。

顺便说一句：xml 元素被称为“元素”，而不是“标签”

# windows - 用于直接 I/O 的 Windows 内核驱动程序 - 有人去过吗？

> ID：476368
> 
> 赞同：3
> 
> 时间：2009-01-24T17:25:32.593
> 
> 标签：windows, driver, port, parallel-processing

我需要以一种更好的方式处理对并行端口的直接 I/O，我们目前正在这样做 - 目前我们使用内核驱动程序，它使用 I/O 保护映射“打开”可用地址。这工作正常，但越来越落后。我们仍然希望继续使用并行端口，并且有非常令人满意的 CardBus ExpressCard 等并行端口卡供应商。我想创建一个驱动程序，该驱动程序知道总线枚举器分配给设备的地址并允许我写入这个地址来自我的（Delphi）应用程序。由于这个主题的明显复杂性，我正在努力从哪里开始。请问有人去过这条路吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T17:33:01.020

你可以试试`inoutp32.dll`。请拜访：

[http://sheepdogguides.com/dt4j.htm](http://sheepdogguides.com/dt4j.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T17:51:49.423

[您可以尝试www.internals.com](http://www.internals.com/)上的 WinIO 库

# python - 有没有办法在没有其他 scipy 的情况下安装 scipy 特殊模块？

> ID：476369
> 
> 赞同：3
> 
> 时间：2009-01-24T17:26:24.620
> 
> 标签：python, numpy, package, scipy

我正在编写一些 Python 数字代码，并想使用[特殊模块](http://scipy.org/SciPyPackages/Special)中的一些函数。到目前为止，我的代码只依赖于 numpy，我发现它很容易安装在各种 Python 环境中。另一方面，安装 scipy 通常是一种令人沮丧的练习。有没有办法只获得特殊模块？

*请注意，我现在看到 Mac 有一个可下载的 scipy 包，但情况并非总是如此*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T23:35:24.547

scipy 子包通常可以单独安装。尝试 cd-ing 到“ `special`”目录并运行正常的“ `python setup.py install`”。导入的名称空间现在应该是`special`and now `scipy.special`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T17:35:03.607

我特别不熟悉*scipy*，但总的来说，软件包的模块取决于软件包本身的安装。所以，是的，我很确定您需要安装*scipy*才能使用特殊模块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T21:07:12.007

如果您已经安装了正确版本的 Numpy，那么您可以尝试获取特殊模块的源代码，将其粘贴到某个目录中，将其添加到您的 PYTHONPATH 中，然后查看它是否有效。这一切都取决于它的依赖关系。如果它具有 Numpy 以外的依赖项，那么您必须安装它们，如果它们具有依赖项......

# emacs - 尝试在 Emacs 中捕获块缩进

> ID：476384
> 
> 赞同：5
> 
> 时间：2009-01-24T17:40:16.387
> 
> 标签：emacs, dot-emacs

我在 emacs 中使用 bsd 缩进样式，我想对其进行一些修改。我的 .emacs 文件的相关部分如下。当我使用 try catch 块编写函数时，大括号会缩进。我希望他们不要像函数一样缩进。

它现在在做什么。

```
try 
    {
    }
catch 
    {
    } 
```

我想让它做什么。

```
try 
{
}
catch 
{
} 
```

.emacs 文件

```
(defun my-c-mode-common-hook ()
  ;; my customizations for all of c-mode and related modes
  ;; other customizations can go here
  (setq c-default-style "bsd")
  (setq c-basic-offset 4)
  (setq indent-tabs-mode nil)
  )

(add-hook 'c-mode-common-hook 'my-c-mode-common-hook) 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-24T19:02:13.383

转到要更改缩进的行并按 Cc Co。这将运行 c-set-offset 并默认为当前行的语法（在本例中为 substatement-open）。'+' 表示一级缩进，'-' 表示一级不缩进，'0' 表示没有额外缩进。您想要 0。要使其永久化，请将 (c-set-offset 'substatement-open 0) 添加到您的钩子中。

# debugging - 使用gdb，在一行中显示多个变量？

> ID：476390
> 
> 赞同：9
> 
> 时间：2009-01-24T17:45:41.323
> 
> 标签：debugging, gdb

如何要求在一行中*显示多个变量？*所以我想得到如下输出：

```
30      if(s[i] != '\0')
5: s[i] = 101 'e'
4: exp = 14
3: val = 123.45
2: sign = 1
1: i = 6 
```

我一直在输入 disp s[i] ENTER disp exp ENTER (etc, etc)，我只知道必须有更好的方法在一行输入中做到这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-25T08:37:21.070

要在每次重新启动 GDB 时建立多个活动的“变量显示”而不重新键入每个`display i`、`display s[i]`等，请使用 GDB“固定命令序列”。

例如，将此添加到您的`~/.gdbinit`：

```
define disp_vars
  disp i
  disp sign
  disp val
  disp exp
  disp s[i]
end 
```

`disp_vars`现在您可以通过在 GDB 提示符下键入来一次添加所有显示。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T16:20:11.360

Employed Russian 给出了正确的解决方案，但对于那些想要在示例中使用它的人来说，请参见下文。如果您不确定是否要承诺将 .gdbinit 放在您的主目录中，您也可以将它放在您正在执行程序的目录中以进行实验。

```
$ gcc -g atof_ex4.2.c 
$ gdb ./a.out
(gdb) b 30
Breakpoint 1 at 0x1907: file atof_ex4.2.c, line 30.
(gdb) h user-defined 
List of commands:
disp_vars -- User-defined
(gdb) disp_vars  #this will enable the user defined canned sequence (but I haven't done run yet! So I'll this actually doesn't work yet.)
No symbol "i" in current context.
(gdb) r
Starting program: a.out 
Breakpoint 1, atof (s=0xbffff028 "123.45e-6") at atof_ex4.2.c:30
30      if(s[i] != '\0')
(gdb) s # No disp_vars output yet because I have to do it AFTER 'run' command
32          if(s[i] == 'e' || s[i] == 'E') 
(gdb) disp_vars # Now it will work ;)
(gdb) s
35              sign = (s[i] == '-') ? -1 : 1;
5: s[i] = 45 '-'
4: exp = 14
3: val = 123.45
2: sign = 1
1: i = 7 
```

当然，'r' 代表运行，'s' 代表步，'b' 代表中断，等等。我也省略了一些输出。请注意，我必须在“运行”之后再次输入“disp_vars”命令。感谢雇用俄罗斯人。

# python - 姜戈：“你的意思是？” 询问

> ID：476394
> 
> 赞同：3
> 
> 时间：2009-01-24T17:47:30.163
> 
> 标签：python, django, spell-checking

我正在编写一个相当简单的 Django 应用程序，用户可以在其中输入字符串查询。应用程序将在数据库中搜索此字符串。

```
Entry.objects.filter(headline__contains=query) 
```

这个查询非常严格，但对于那些不是 100% 确定他们在寻找什么的人来说并没有真正的帮助。所以我扩大了搜索范围。

```
from django.utils import stopwords

results = Entry.objects.filter(headline__contains=query)
if(!results):
    query = strip_stopwords(query)
    for(q in query.split(' ')):
        results += Entry.objects.filter(headline__contains=q) 
```

我想为此添加一些额外的功能。搜索未拼写的单词、复数、常见的同音字（发音相同，拼写不同）等。我只是想知道这些东西是否内置于 Django 查询语言中。编写一个庞大的算法对我来说还不够重要，因为我真的只是在寻找内置的东西。

提前感谢所有答案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-24T18:07:09.610

您可以尝试使用 python 的[difflib](http://docs.python.org/library/difflib)模块。

```
>>> from difflib import get_close_matches
>>> get_close_matches('appel', ['ape', 'apple', 'peach', 'puppy'])
['apple', 'ape']
>>> import keyword
>>> get_close_matches('wheel', keyword.kwlist)
['while']
>>> get_close_matches('apple', keyword.kwlist)
[]
>>> get_close_matches('accept', keyword.kwlist)
['except'] 
```

问题是要使用 difflib，必须从数据库中构建一个单词列表。那可能很昂贵。也许如果您缓存单词列表并且只偶尔重建一次。

一些数据库系统支持搜索方法来做你想做的事，比如 PostgreSQL 的[`fuzzystrmatch`](http://www.postgresql.org/docs/8.3/static/fuzzystrmatch.html)模块。如果这是您的情况，您可以尝试调用它。

* * *

**编辑：**

对于您的新“要求”，您很不走运。不，django 的查询语言中没有内置任何内容。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-24T19:31:54.680

djangos orm 没有开箱即用的这种行为，但是有几个项目将 django 与搜索服务集成在一起，例如：

*   狮身人面像 ( [django-sphinx](http://github.com/dcramer/django-sphinx/tree/master) )
*   solr，一个轻量级版本的 lucene ( [djangosearch](https://code.google.com/p/django-solr-search/) )
*   lucene ( [django-search-lucene](http://code.google.com/p/django-search-lucene/) )

我不能说选项 #2 和 #3 的效果如何，但我已经使用了很多 django-sphinx，并且对结果非常满意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-09T14:17:47.930

```
cal_name = request.data['column']['name']

        words = []
        for col in Column.objects.all():
            if cal_name != col.name:
                words.append(col.name)
        words = difflib.get_close_matches(cal_name, words)
        if len(words) > 0 and is_sure != "true":
            return Response({
                'potential typo': 'Did you mean ' + str(words) + '?',
                "note": "If you think you do not have a typo send {'sure' : 'true'} with the data."}) 
```

# c# - XmlSerializer - 具有不同属性的相同元素

> ID：476402
> 
> 赞同：0
> 
> 时间：2009-01-24T17:52:47.750
> 
> 标签：c#, xml-serialization

我有 xml 包含：

```
<day p="d">
<day p="n"> 
```

为了使用 XmlSerializer 反序列化 xml，我需要向 Day 类添加哪些属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T18:38:40.763

以下装饰品——

```
[XmlType(TypeName="day")]
public class Day
{
    [XmlAttribute("p")]
    public string P { get; set; }
}

[XmlRoot("someObject")]
public class SomeObject
{
    [XmlArray("days")]
    public List<Day> Days { get; set; }
} 
```

将序列化为：

```
<someObject xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <days>
    <day p="n" />
    <day p="p" />
  </days>
</someObject> 
```

希望这能让你有所收获。

凯夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T18:08:04.380

```
[XmlElement("day")]
public class Day
{
  [XmlAttribute("p")]
  public string P {get;set;}
} 
```

# .net - NHibernate：无法成功设置延迟加载

> ID：476405
> 
> 赞同：2
> 
> 时间：2009-01-24T17:55:13.347
> 
> 标签：.net, nhibernate, fluent-nhibernate, lazy-loading, criteria

我有一个表 Parent 和一个表 Child。Child 包含 Parent 表的外键，创建一对多关系。这是我用 fluent NHibernate 定义的映射的一部分：

```
public class ParentMap : ClassMap<Parent>
{
    public ParentMap()
    {
        WithTable("Parents");

        Id(x => x.Id, "ParentID")
        .WithUnsavedValue(0)
        .GeneratedBy.Identity();

        Map(x => x.Description, "Description");

        HasMany<Child>(x => x.Childs)
        .LazyLoad()
        .WithKeyColumn("ParentID")
        .IsInverse()
        .AsSet();
    }
}

public class ChildMap : ClassMap<Child>
{
    public ChildMap()
    {
        WithTable("Childs");

        Id(x => x.Id, "ChildID")
        .WithUnsavedValue(0)
        .GeneratedBy.Identity();

        References(x => x.Parent, "ParentID")
            .CanNotBeNull()
            .LazyLoad();
    }
} 
```

如您所见，我已经在关系上设置了 LazyLoad。另请注意，在我的模型类中，所有属性都设置为虚拟。

现在进行简单查询：

```
ICriteria crit = Session.CreateCriteria(typeof(Child))
    .Add(Expression.Eq("Id", 18));
IList<Child> list = crit.List<Child>(); 
```

并且生成的SQL：

```
SELECT this_.ChildID            as ChildID5_1_,
       this_.ParentID           as ParentID5_1_,
       parent2_.ParentID    as ParentID4_0_,
       parent2_.Description as Descript2_4_0_
FROM   Childs this_
       inner join Parents parent2_
         on this_.ParentID = parent2_.ParentID
WHERE  this_.ChildID = 18 /* @p0 */ 
```

如您所见，它在 Parent 表上进行连接并选择其字段（id 和 description）。但是，既然我要求延迟加载，为什么它会这样做呢？

现在，如果我将查询更改为：

```
ICriteria crit2 = Session.CreateCriteria(typeof(Child))
    .SetFetchMode("Parent", FetchMode.Lazy)
    .Add(Expression.Eq("Id", 18)); 
```

生成了 2 个 sql 查询：

```
SELECT this_.ChildID  as ChildID5_0_,
       this_.ParentID as ParentID5_0_
FROM   Childs this_
WHERE  this_.ChildID = 18 /* @p0 */ 
```

这对我有好处：不加入，不查询父表。但我也得到了第二个：

```
SELECT parent0_.ParentID    as ParentID4_0_,
       parent0_.Description as Descript2_4_0_
FROM   Parents parent0_
WHERE  parent0_.ParentID = 45 /* @p0 */ 
```

再次查询 Parent 表。

这 2 个查询是在行期间生成的：

```
IList<Child> list = crit.List<Child>(); 
```

我完全不知道这里发生了什么。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T12:19:57.320

这取决于您的 Fluent NHibernate 版本。直到某一点，默认情况下所有实体都*不会*被延迟加载。这相当于`lazy="false"`在您的实体中显式设置。现在不再是这种情况，但是如果您在此之前运行任何东西，那么您会看到这种行为。

多对一/引用延迟加载设置会被来自目标的实体级延迟加载覆盖，因此如果您在此旧版本的 FNH 上运行，那么实体设置将使您的`References(...).LazyLoad()`呼叫没有实际意义。

您需要验证您使用的是最新版本的 FNH，这应该可以解决问题；但是，如果没有，那么您需要在您的`Parent`实体中显式设置延迟加载。您可以`LazyLoad`使用`ClassMap<T>`.

# language-agnostic - 对象规范化

> ID：476422
> 
> 赞同：13
> 
> 时间：2009-01-24T18:08:38.827
> 
> 标签：language-agnostic, oop

与数据库规范化在同一行 - 是否有一种对象规范化方法，不是设计模式，而是与规范化对象创建相同的数学方法。例如：第一个范式：没有重复字段....这里有一些 DB Normalization 的链接：

> [http://en.wikipedia.org/wiki/Database_normalization](http://en.wikipedia.org/wiki/Database_normalization) [http://databases.about.com/od/specificproducts/a/normalization.htm](http://databases.about.com/od/specificproducts/a/normalization.htm)

这会使对象创建和自我记录变得更好吗？

这是一本关于类规范化的书的链接（猜想我们真的在谈论类） [http://www.agiledata.org/essays/classNormalization.html](http://www.agiledata.org/essays/classNormalization.html)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T21:47:18.370

规范化在谓词逻辑中有数学基础，并且有一个明确而具体的目标，即同一条信息永远不会在单个模型中表示两次；这个目标的目的是消除数据模型中信息不一致的可能性。可以通过数学证明表明，如果数据模型具有某些特定属性（它通过了第一范式 (1NF)、2NF、3NF 等的测试），则它没有冗余数据表示，即它是规范化的。

面向对象没有这种潜在的数学基础，实际上也没有明确和具体的目标。它只是引入更多抽象的设计思想。DRY 原则、命令-查询分离、Liskov 替换原则、开闭原则、Tell-Don't-Ask、依赖倒置原则和其他用于提高代码质量的启发式方法（其中许多适用于一般代码，而不仅仅是面向对象程序）本质上不是绝对的；它们是程序员发现有助于提高代码的可理解性、可维护性和可测试性的指南。

使用关系数据模型，您可以绝对肯定地说它是否“规范化”，因为它必须通过所有标准形式的测试，而且它们非常具体。另一方面，对于对象模型，由于“可理解、可维护、可测试等”的目标相当模糊，您无法确定是否达到了该目标。对于许多设计启发式方法，您甚至无法确定您是否遵循了它们。如果您将模式应用到您的设计中，您是否遵循了 DRY 原则？重复使用模式肯定不是 DRY 吗？此外，其中一些启发式或原则并不总是总是好的建议。我确实尝试遵循命令查询分离，

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-24T18:12:14.920

我想[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)至少*与*此有关。或者至少，违反 SRP 在某些方面类似于缺乏规范化。

（我可能在胡说八道。我很累。）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-25T05:30:26.250

有趣的。

您可能也有兴趣查看得[墨忒耳法则](http://en.wikipedia.org/wiki/Law_of_Demeter)。

您可能感兴趣的另一件事是[c2 的 FearOfAddingClasses](http://c2.com/cgi/wiki?FearOfAddingClasses)，因为可以说，导致程序员非规范化数据库的相同推理也会导致上帝类和其他代码异味。对于 OO 和 DB 规范化，我们希望分解所有内容。对于数据库，这意味着更多的表，对于 OO，意味着更多的类。

现在，值得牢记[对象关系阻抗失配](http://www.agiledata.org/essays/impedanceMismatch.html)，也就是说，可能并非所有内容都能干净地转换。

对象关系模型或“持久层”通常在对象属性和数据库字段之间具有一对一的映射。那么，我们可以正常化吗？假设我们有具有employee1、employee2 ...等属性的部门对象。显然，应该用员工名单代替。所以我们可以说 1NF 有效。

考虑到这一点，让我们直奔主题，看看 6NF 数据库设计，一个很好的例子是[Anchor Modeling，（忽略命名约定）](http://www.anchormodeling.com/wp-content/uploads/2010/08/AM_Cheat_Sheet.pdf)。Anchor Modeling/6NF 提供*高度分解和灵活的数据库模式*；这如何转化为面向对象的“规范化”？

Anchor Modeling 有以下几种关系：

*   锚点 - 唯一的对象 ID。
*   属性，转换为对象属性：（锚点、值、元数据）。
*   关系 - 两个或多个对象之间的关系（它们自己是锚点）：（锚点，锚点...，元数据）
*   结，归因于领带。

属性元数据可以是任何东西——谁更改了属性、何时、为什么等。

这个的 OO 翻译看起来非常灵活：

*   锚点建议使用无属性占位符，例如知道如何处理属性组合的代理。
*   属性建议表示属性的类以及它们属于什么。这建议将重用应用于如何查找和处理属性，例如自动约束检查等。由此我们有一个基础来一般地实现 GOF 风格的结构模式。
*   Ties and Knots 建议表示对象之间关系的类。行为设计模式的通用实现的基础？

锚建模的有趣且理想的属性也可以转换为：

*   所有这些都需要在暴露的对象中用组合（好）替换继承。
*   属性拥有所有者而不是拥有属性的所有者。尽管这使属性查找更加复杂，但它*巧妙地解决*了某些别名问题，因为只能有一个所有者。
*   不需要NULL。这转化为更清晰的 NULL 处理。Empty-case 属性类可以提供处理缺少特定属性的方法，而不是到处执行 NULL 检查。
*   属性元数据。属性级别的完整历史记录和指责：及时“播放”对象，查看发生了什么变化、时间和原因等（如果需要 - 元数据完全是可选的）

可能会有很多非常简单的类（这很好），以及一种非常声明式的编程风格（也很好）。

感谢您提出这样一个发人深省的问题，我希望这对您有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-24T18:16:15.737

也许您是从关系的角度来看这个，但我认为接口和继承的原则对应于 OOP 世界中的规范化。

例如，包含、和的`Person`抽象类可以被 、 等类用作有效的基类，而无需在此类子类中重复这些属性的定义。`FirstName``LastName``Gender``BirthDate``Employee``User``Member`

DRY 原则（Andy Hunt 和 Dave Thomas 的著作*The Pragmatic Programmer*的核心原则）以及面向对象编程对重用的不断强调，也对应于关系数据库中规范化提供的效率。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-24T18:12:52.797

乍一看，我会说[代码重构](http://en.wikipedia.org/wiki/Code_refactoring)的目标在抽象上类似于规范化的目标。但这很抽象。

更新：我之前几乎写过“我们需要让 Jon Skeet 参与其中。” 我发布了我的答案，谁打败了我？你猜对了...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-24T18:59:30.800

[对象角色建模](https://en.wikipedia.org/wiki/Object-role_modeling)（不要与[对象关系映射](http://en.wikipedia.org/wiki/Object-relational_mapping)混淆）是我所知道的最接近对象规范化的东西。它没有标准化那样的数学基础，但它是一个开始。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-25T16:38:01.013

好问题，抱歉无法深入回答

20 多年来，我一直致力于对象规范化。它深邃、复杂和美丽，是我计划的第二本书《物体力学 II》的主题。ONF = 物体范式，你先在这里听到了！;-)

由于潜在的可专利技术潜伏在其中，我无权说更多，除了规范化数据是非常容易的部分;-)

附录：计划变更 - 请参阅[https://softwareengineering.stackexchange.com/questions/84598/object-oriented-normalization](https://softwareengineering.stackexchange.com/questions/84598/object-oriented-normalization)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-24T21:30:24.817

以一种相当临时和未经指导的方式，这可能会引起纯粹主义者的嘲笑，也许正确地，我认为数据库表是一组特定类型的对象，反之亦然。然后我从那里开始我的想法。从这个角度来看，在我看来，在日常编程中使用范式没有什么特别的要求。每个对象的身份都将作为其主键作为启动器，而引用（指针等）将通过外键来实现。然后只需遵循相同的规则。

（我的对象通常以 3NF 或其近似值结束。我将这一切更多地视为指导方针，并且，就像我说的，“未经指导”。）

如果规则得到正确遵守，那么每一位信息都会在一个地方结束，相互关系是清晰的，并且一切都是结构化的，因此引入不一致需要一些工作。可以说这种方法在此基础上产生了很好的效果，我同意。

一个缺点是最终结果可能感觉有点像意大利面，特别是在一段时间之后，并且很难摆脱持续挥之不去的感觉，即使它通常是错误的，肯定所有这些链接中的一些可以删除...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-24T21:31:47.997

面向对象的设计是合理的，但它没有与关系模型相同的数学定义良好的基础。没有什么完全等同于定义良好的数据库设计规范形式。

这是面向对象设计的优势还是劣势，这是一个解释问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-25T15:59:11.760

我支持 SRP。开放封闭原则也适用于“规范化”，尽管我可能会延伸这个词的含义，因为应该可以通过添加新实现来扩展系统，而无需修改现有代码。[关于 OCP 的反对者](http://www.objectmentor.com/resources/articles/ocp.pdf)

# php - 提交带有空复选框的 HTML 表单

> ID：476426
> 
> 赞同：43
> 
> 时间：2009-01-24T18:12:35.200
> 
> 标签：php, html, forms, checkbox

我有一个 HTML 表单 - 使用 PHP，我将表单的数据发送到 MySQL 数据库。表格上一些问题的答案带有复选框。显然，用户不必为一个问题勾选所有复选框。我还想让其他问题（包括广播组）可选。

但是，如果我提交带有空框、单选组等的表单，我会收到一长串“未定义索引”错误消息的列表。

我怎样才能解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-01-24T20:05:22.647

我不时使用这种技术：

```
<input type="hidden" name="the_checkbox" value="0" />
<input type="checkbox" name="the_checkbox" value="1" /> 
```

**注意：**这在不同的服务器端语言中得到[不同的解释，因此如有必要，请进行测试和调整。](https://stackoverflow.com/questions/1809494/post-the-checkboxes-that-are-unchecked/8972025#8972025)感谢[SimonSimCity](https://stackoverflow.com/users/517914/simonsimcity)的提示。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-01-24T18:18:04.097

未选中的单选或复选框元素不会被提交，因为它们不被视为[成功](http://www.w3.org/TR/REC-html40/interact/forms.html#h-17.13.2)。因此，您必须检查它们是否使用`isset`or`empty`函数发送。

```
if (isset($_POST['checkbox'])) {
    // checkbox has been checked
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-24T18:20:14.933

未选中的复选框不会在 POST 数据中发送。你应该检查它是否为空：

```
if (empty($_POST['myCheckbox']))
     ....
else
     .... 
```

在 PHP中[`empty()`](http://www.php.net/empty)并且[`isset()`](http://www.php.net/isset)不生成通知。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-12-06T08:43:45.250

这是使用 javascript 的简单解决方法：

在提交包含复选框的表单之前，将“关闭”设置为 0 并检查它们以确保它们提交。例如，这适用于复选框数组。

///// 例子 //////

给定一个 id="formId" 的表单

```
<form id="formId" onSubmit="return formSubmit('formId');" method="POST" action="yourAction.php">

<!--  your checkboxes here . for example: -->

<input type="checkbox" name="cb[]" value="1" >R
<input type="checkbox" name="cb[]" value="1" >G
<input type="checkbox" name="cb[]" value="1" >B

</form> 
```

```
<?php

if($_POST['cb'][$i] == 0) {
    // empty
} elseif ($_POST['cb'][$i] == 1) {
    // checked
} else {
    // ????
}

?>

<script>

function formSubmit(formId){

var theForm = document.getElementById(formId); // get the form

var cb = theForm.getElementsByTagName('input'); // get the inputs

for(var i=0;i<cb.length;i++){ 
    if(cb[i].type=='checkbox' && !cb[i].checked)  // if this is an unchecked checkbox
    {
       cb[i].value = 0; // set the value to "off"
       cb[i].checked = true; // make sure it submits
    }
}

return true;

}

</script> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-24T23:00:34.167

要添加到 fmsf 的代码中，在添加复选框时，我通过在名称中包含 [] 来使它们成为一个数组

```
<FORM METHOD=POST ACTION="statistics.jsp?q=1&g=1">
    <input type="radio" name="gerais_radio" value="primeiras">Primeiras Consultas por medico<br/>
    <input type="radio" name="gerais_radio" value="salas">Consultas por Sala <br/>
    <input type="radio" name="gerais_radio" value="assistencia">Pacientes por assistencia<br/>
    <input type="checkbox" name="option[]" value="Option1">Option1<br/>
    <input type="checkbox" name="option[]" value="Option2">Option2<br/>
    <input type="checkbox" name="option[]" value="Option3">Option3<br/>
    <input type="submit" value="Ver"> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-24T20:10:55.133

用这个

```
$myvalue = (isset($_POST['checkbox']) ? $_POST['checkbox'] : 0; 
```

或者用你没有价值的东西代替 0

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-03-23T10:39:41.717

我们很难检测到哪一个检查或没有检查。

如果您在 for 循环中填充表单，请使用 value 属性作为数据持有者：

```
 <?php for($i=1;$i<6;$i++):?>
    <input type="checkbox" name="active[]" value="<?php echo $i ?>"
    <?endfor;?> 
```

如果提交表单，您将获得选中的复选框的订单号（在这种情况下，我选中了第 3 和第 4 个复选框）：

```
 array(1) {       
       ["active"]=>
          array(2) {
            [0]=>       
             string(1) "3"
            [1]=>
             string(1) "4"
          }
   } 
```

当您在循环中处理表单数据时，比如说在 post.php 中，使用以下代码来检测是否选择了相关行：

```
 if(in_array($_POST['active'] ,$i)) 
            $answer_result = true;
        else 
            $answer_result = false; 
```

最终测试代码：

```
 <?php if (isset($_POST) && !empty($_POST)):
        echo '<pre>';
        var_dump($_POST);
        echo '</pre>';
    endif;
    ?>
    <form action="test.php" method="post">
    <?php for($i=1;$i<6;$i++):?>
    <input type="checkbox" name="active[]" value="<?php echo $i; ?>" />
    <?php endfor;?>
    <button type="submit">Submit</button>
    </form> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-02-03T21:23:29.873

尽管提交了许多答案，但我不得不即兴创作自己的解决方案，因为我使用了自定义复选框。换句话说，没有一个答案对我有用。

我想要得到的是一组复选框，带有开和关值。诀窍是为每个复选框的开/关值提交一个分隔符。假设分隔符是“;” 所以你得到的字符串是

**;， 在， ;， ;， ;**

然后，一旦你得到你的帖子，只需使用“，”作为拆分字符将数据拆分为数组，然后如果数组元素包含“on”，则复选框处于打开状态，否则，它处于关闭状态。

对于每个复选框，更改 ID，其他一切都相同......并且重复的语法是：

```
 <div>
    <input type="hidden" name="onoffswitch" class="onoffswitch-checkbox" value=";" />
    ...some other custom code here...
    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch1" checked>
    </div> 
```

编辑：代替“;”，您可以使用一些 KEY 字符串值，这样您就会知道您没有弄乱顺序，一旦在服务器端获得 POST ......这样您就可以轻松创建一个 Map、Hash 或其他任何东西。PS：将它们都放在同一个 div 标签内。

# .net - 如何设计一个 ASP.NET MVC 站点以使用 Velocity 进行缓存？

> ID：476429
> 
> 赞同：5
> 
> 时间：2009-01-24T18:14:30.467
> 
> 标签：.net, asp.net-mvc, appfabric

我来自 LAMP 世界，那里普遍存在“缓存一切”的心态。一切都放在内存缓存中。

我正在使用 ASP.NET MVC 和 SQL Server 开始一个新项目。我可能会使用 LINQ to SQL 或实体框架。我现在是否需要为缓存做出设计决策，或者如果有必要开始使用 Velocity 是否足够容易？为了清楚起见，我说的是 Microsoft 的 Velocity 缓存，而不是 Apache Velocity 模板引擎。

我希望我暂时可以忽略缓存，因为学习 C#、ASP.NET MVC、LINQ、IIS、SQL Server 并精通 VS 让我的盘子满满当当。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T18:22:07.253

Stephen Walther 有一篇关于如何做到这一点的精彩文章

[ASP.NET MVC 技巧 #39 – 使用 Velocity 分布式缓存](http://stephenwalther.com/blog/archive/2008/08/28/asp-net-mvc-tip-39-use-the-velocity-distributed-cache.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-25T17:47:26.940

dswatik 提供了一个很好的链接来说明如何使用它。

我建议在您的存储库/服务层的某处添加此功能，以减轻应用程序的负担并保持 DRY 原则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T07:05:18.680

@dswatic：非常感谢。看起来我以后可以以最小的痛苦添加缓存。这是来自该网站的一个重要警告：

“如果您使用对象关系设计器生成 LINQ to SQL 类，那么您的 LINQ to SQL 类将无法序列化。为了解决这个问题，我手动构建了 LINQ to SQL 类。”

Velocity 只能缓存可序列化的对象。

再次感谢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T13:08:59.610

所选答案适用于 Velocity CTP1。这是最新的[Velocity Programming Guide](http://msdn.microsoft.com/en-us/library/dd187431.aspx)的 MSDN 链接。

至于您关于设计决策的其他问题，Chad Moran 将责任放在存储库层的建议非常好。然后，我会考虑使用类似于此处描述的技术添加对 linq 缓存的支持：http: [//petemontgomery.wordpress.com/2008/08/07/caching-the-results-of-linq-queries/](http://petemontgomery.wordpress.com/2008/08/07/caching-the-results-of-linq-queries/)

您显然必须编写一个使用 Velocity 而不是 ASP.NET 缓存的实现......但实际上，除非您有统计数据证明您需要像 Velocity 这样的东西，否则您可能会坚持使用常规缓存，直到它成为问题. 如果您听听 Joel Spolsky 关于 stackoverflow 的一些演讲，您会发现两个盒子（一个带有 iis，另一个带有 sql server）可以处理**非常**大的容量。

# windows - Windows 服务正在运行，但事件日志不起作用

> ID：476432
> 
> 赞同：1
> 
> 时间：2009-01-24T18:15:45.240
> 
> 标签：windows, logging, windows-services

我有一个 Windows 服务正在侦听来自队列的消息，但未从队列中读取消息。我创建了一个事件日志以在服务启动和关闭期间检查日志，但未写入日志。我不想调试服务，因为这是一个痛苦的过程。有没有办法解决这个问题。消息需要由服务读取并写入数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T18:56:27.607

这听起来确实好像运行 Windows 服务的帐户没有足够的权限写入相关事件日志。

为非管理员帐户设置事件日志权限可能有点玄学，因为您需要使用 SDDL 等配置自定义安全描述符。但是，有一篇非常方便的 MS 知识库文章介绍了如何以编程方式执行此操作：

> [如何使用 .Net Framework 以编程方式设置事件日志安全性](http://support.microsoft.com/kb/953587)

我现在一直在使用它，它很简单：

```
int mask = EventLogSecurity.CustomSD_ALL_ACCESS;

string logName = "Application";
string domain = "MyMachineOrDomainName";
string account = "UserAccount";

EventLogSecurity.AddUserToEventLogCustomSD(logName, domain, account, mask); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T18:24:57.640

根据我的经验，写入事件日志最常见的问题是用户没有足够的权限写入事件日志。您能否检查运行 Windows 服务的身份，并验证它是否有权写入您创建的事件日志？

而且，您能否检查事件日志以查看在尝试写入时是否记录了任何错误？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T19:27:46.793

如果您想使用日志记录而不是调试，请不要使用事件日志。使用普通的旧文本日志。

# javascript - JavaScript 中是否有“空值合并”运算符？

> ID：476436
> 
> 赞同：1514
> 
> 时间：2009-01-24T18:18:02.567
> 
> 标签：javascript, operators, null-coalescing-operator, null-coalescing

Javascript中是否有空合并运算符？

例如，在 C# 中，我可以这样做：

```
String someString = null;
var whatIWant = someString ?? "Cookies!"; 
```

我可以为 Javascript 找出的最佳近似值是使用条件运算符：

```
var someString = null;
var whatIWant = someString ? someString : 'Cookies!'; 
```

恕我直言，这有点恶心。我能做得更好吗？

* * *

## 回答 #1

> 赞同：2272
> 
> 时间：2009-01-24T18:25:31.133

**更新**

JavaScript 现在支持[空值合并运算符 (??)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_Coalescing_Operator)。当其左侧操作数为`null`or时返回其右侧操作数`undefined`，否则返回其左侧操作数。

**旧答案**

请在使用前检查兼容性。

* * *

C# null 合并运算符 ( `??`) 的 JavaScript 等效项使用逻辑 OR ( `||`)：

```
var whatIWant = someString || "Cookies!"; 
```

在某些情况下（下文说明）该行为与 C# 的行为不匹配，但这是在 JavaScript 中分配默认/替代值的一般、简洁的方式。

* * *

## 澄清

无论第一个操作数的类型如何，如果将其转换为 Boolean 会导致`false`，则赋值将使用第二个操作数。请注意以下所有情况：

```
alert(Boolean(null)); // false
alert(Boolean(undefined)); // false
alert(Boolean(0)); // false
alert(Boolean("")); // false
alert(Boolean("false")); // true -- gotcha! :) 
```

这表示：

```
var whatIWant = null || new ShinyObject(); // is a new shiny object
var whatIWant = undefined || "well defined"; // is "well defined"
var whatIWant = 0 || 42; // is 42
var whatIWant = "" || "a million bucks"; // is "a million bucks"
var whatIWant = "false" || "no way"; // is "false" 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2014-03-08T05:24:46.097

```
function coalesce() {
    var len = arguments.length;
    for (var i=0; i<len; i++) {
        if (arguments[i] !== null && arguments[i] !== undefined) {
            return arguments[i];
        }
    }
    return null;
}

var xyz = {};
xyz.val = coalesce(null, undefined, xyz.val, 5);

// xyz.val now contains 5 
```

此解决方案的工作方式类似于 SQL 合并函数，它接受任意数量的参数，如果它们都没有值则返回 null。它的行为类似于 C# ?? 运算符的意义在于，“”、false 和 0 被视为 NOT NULL，因此算作实际值。如果您来自.net 背景，这将是最自然的感觉解决方案。

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2018-05-07T09:32:28.760

是的，它很快就会到来。请参阅此处的[提案和此处](https://github.com/tc39/proposal-nullish-coalescing)的[实施状态](https://github.com/tc39/proposal-nullish-coalescing/issues/29)。

它看起来像这样：

```
x ?? y 
```

## 例子

```
const response = {
  settings: {
    nullValue: null,
    height: 400,
    animationDuration: 0,
    headerText: '',
    showSplashScreen: false
  }
};

const undefinedValue = response.settings?.undefinedValue ?? 'some other default'; // result: 'some other default'
const nullValue = response.settings?.nullValue ?? 'some other default'; // result: 'some other default'
const headerText = response.settings?.headerText ?? 'Hello, world!'; // result: ''
const animationDuration = response.settings?.animationDuration ?? 300; // result: 0
const showSplashScreen = response.settings?.showSplashScreen ?? true; // result: false 
```

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2009-01-24T18:45:42.230

如果`||`作为 C# 的替代品`??`在您的情况下还不够好，因为它会吞下空字符串和零，您总是可以编写自己的函数：

```
 function $N(value, ifnull) {
    if (value === null || value === undefined)
      return ifnull;
    return value;
 }

 var whatIWant = $N(someString, 'Cookies!'); 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2015-05-26T21:07:50.550

在这里没有人提到 的潜力`NaN`，这对我来说也是一个空值。所以，我想我会加上我的两分钱。

对于给定的代码：

```
var a,
    b = null,
    c = parseInt('Not a number'),
    d = 0,
    e = '',
    f = 1
; 
```

如果您要使用`||`运算符，您将获得第一个非 false 值：

```
var result = a || b || c || d || e || f; // result === 1 
```

如果您使用新的`??`（空合并）运算符，您将得到`c`，它具有以下值：`NaN`

```
vas result = a ?? b ?? c ?? d ?? e ?? f; // result === NaN 
```

**这些对我来说似乎**都不对。**在我自己的合并逻辑小世界中，可能与您的世界不同，我认为 undefined、null 和 NaN 都是“null-ish”。所以，我希望`d`从合并方法中恢复（零）。**

 **如果任何人的大脑都像我一样工作，并且您想排除`NaN`，那么这个自定义`coalesce`方法（与[此处发布的](https://stackoverflow.com/a/22265471/482256)不同）将完成：

```
function coalesce() {
    var i, undefined, arg;

    for( i=0; i < arguments.length; i++ ) {
        arg = arguments[i];
        if( arg !== null && arg !== undefined
            && (typeof arg !== 'number' || arg.toString() !== 'NaN') ) {
            return arg;
        }
    }
    return null;
} 
```

对于那些希望代码尽可能短并且不介意有点不清晰的人，您也可以按照@impinball 的建议使用它。这利用了 NaN 永远不等于 NaN 的事实。你可以在这里阅读更多内容：[为什么 NaN 不等于 NaN？](https://stackoverflow.com/questions/10034149/why-is-nan-not-equal-to-nan)

```
function coalesce() {
    var i, arg;

    for( i=0; i < arguments.length; i++ ) {
        arg = arguments[i];
        if( arg != null && arg === arg ) { //arg === arg is false for NaN
            return arg;
        }
    }
    return null;
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2020-07-09T22:00:47.703

# 逻辑无效分配，2020+ 解决方案

目前正在向浏览器中添加一个新的运算符，`??=`. 这将空合并运算符`??`与赋值运算符结合在一起`=`。

> 注意：这在公共浏览器版本中*还不*常见。将随着可用性的变化而更新。

`??=`检查变量是否未定义或为空，如果已定义则短路。如果不是，则将右侧的值分配给变量。

### 基本示例

```
let a          // undefined
let b = null
let c = false

a ??= true  // true
b ??= true  // true
c ??= true  // false 
```

### 对象/数组示例

```
let x = ["foo"]
let y = { foo: "fizz" }

x[0] ??= "bar"  // "foo"
x[1] ??= "bar"  // "bar"

y.foo ??= "buzz"  // "fizz"
y.bar ??= "buzz"  // "buzz"

x  // Array [ "foo", "bar" ]
y  // Object { foo: "fizz", bar: "buzz" } 
```

[浏览器支持](https://caniuse.com/#feat=mdn-javascript_operators_logical_nullish_assignment)22 年 1 月 - 89%

[Mozilla 文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_nullish_assignment)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-03-26T18:56:24.660

是的，它的[提案](https://tc39.es/proposal-nullish-coalescing/)现在是[第 4 阶段](https://tc39.es/process-document/)。这意味着该提案已准备好包含在正式的 ECMAScript 标准中。您已经可以在 Chrome、Edge 和 Firefox 的最新桌面版本中使用它，但我们将不得不等待更长时间，直到此功能达到跨浏览器稳定性。

查看以下示例以演示其行为：

```
// note: this will work only if you're running latest versions of aforementioned browsers
const var1 = undefined;
const var2 = "fallback value";

const result = var1 ?? var2;
console.log(`Nullish coalescing results in: ${result}`);
```

前面的例子等价于：

```
const var1 = undefined;
const var2 = "fallback value";

const result = (var1 !== null && var1 !== undefined) ?
    var1 :
    var2;
console.log(`Nullish coalescing results in: ${result}`);
```

请注意，*无效合并*不会像操作员**那样**威胁*虚假*值`||`（它只检查`undefined`or`null`值），因此以下代码段将按如下方式运行：

```
// note: this will work only if you're running latest versions of aforementioned browsers
const var1 = ""; // empty string
const var2 = "fallback value";

const result = var1 ?? var2;
console.log(`Nullish coalescing results in: ${result}`);
```

* * *

对于 TypesScript 用户，从[TypeScript 3.7](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#nullish-coalescing)开始，此功能现在也可用。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-24T18:23:21.900

阅读您的说明后，@Ates Goral 的回答提供了如何在 JavaScript 中执行您在 C# 中执行的相同操作。

@Gumbo 的答案提供了检查 null 的最佳方法；但是，重要的是要注意`==`与`===`JavaScript中的区别，*尤其是*在检查`undefined`和/或`null`.

[这里](http://saladwithsteve.com/2008/02/javascript-undefined-vs-null.html)有一篇关于两个术语差异的非常好的文章。基本上，了解如果您使用`==`而不是`===`，JavaScript 将尝试合并您正在比较的值并返回合并*后*的比较结果。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-01-24T18:35:39.287

请注意 JavaScript 特定的 null 定义。javascript中有两个“无价值”的定义。1\. Null：当一个变量为null时，表示它里面没有数据，但是这个变量已经在代码中定义了。像这样：

```
var myEmptyValue = 1;
myEmptyValue = null;
if ( myEmptyValue === null ) { window.alert('it is null'); }
// alerts 
```

在这种情况下，变量的类型实际上是 Object。测试它。

```
window.alert(typeof myEmptyValue); // prints Object 
```

2.  未定义：当一个变量之前没有在代码中定义时，正如预期的那样，它不包含任何值。像这样：

    ```
    if ( myUndefinedValue === undefined ) { window.alert('it is undefined'); }
    // alerts 
    ```

如果是这种情况，您的变量的类型是“未定义”。

请注意，如果您使用类型转换比较运算符 (==)，JavaScript 将对这两个空值执行相同的操作。要区分它们，请始终使用类型严格的比较运算符 (===)。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-12-05T12:42:51.200

请注意，React 的工具链从[版本 3.3.0（发布 5.12.2019）](https://github.com/facebook/create-react-app/releases/tag/v3.3.0)`create-react-app`开始支持空合并。从发行说明：

> 可选链接和空值合并运算符
> 
> 我们现在支持可选的链接和无效合并运算符！
> 
> ```
> // Optional chaining
> a?.(); // undefined if `a` is null/undefined
> b?.c; // undefined if `b` is null/undefined
> 
> // Nullish coalescing
> undefined ?? 'some other default'; // result: 'some other default'
> null ?? 'some other default'; // result: 'some other default'
> '' ?? 'some other default'; // result: ''
> 0 ?? 300; // result: 0
> false ?? true; // result: false 
> ```

这就是说，如果您使用`create-react-app`3.3.0+，您今天就可以在您的 React 应用程序中开始使用 null-coalesce 运算符。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2021-11-28T12:00:07.290

## `??`对比`||`对比`&&`

其他答案都没有比较所有这三个。由于[贾斯汀·约翰逊（Justin Johnson）的评论](https://stackoverflow.com/questions/476436/is-there-a-null-coalescing-operator-in-javascript#comment4299407_476445)获得了如此多的选票，并且由于[JavaScript 中的双问号与 &&](https://stackoverflow.com/q/64385309/8910547)`&&`被标记为与此相同，因此将其包含在答案中是有意义的。

首先是受贾斯汀约翰逊评论的启发：

*   `||`返回第一个“truey”值，否则返回最后一个值。

*   `&&`返回第一个“假”值，否则返回最后一个值。

*   `??`返回第一个非空、非未定义的值，否则返回最后一个值，无论它是什么。

然后，在实时代码中演示：

```
let F1,
    F2 = null,
    F3 = 0,
    F4 = '',
    F5 = parseInt('Not a number (NaN)'),
    T1 = 3,
    T2 = 8

console.log( F1 || F2 || F3 || F4 || F5 || T1 || T2 ) // 3 (T1)
console.log( F1 || F2 || F3 || F4 || F5 )             // NaN (F5)

console.log( T1 && T2 && F1 && F2 && F3 && F4 && F5 ) // undefined (F1)
console.log( T1 && T2 )                               // 8 (T2)

console.log( F1 ?? F2 ?? F3 ?? F4 ?? F5 ?? T1 )       // 0 (F3)
console.log( F1 ?? F2)                                // null (F2)
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-01-13T16:19:44.827

它有望很快在 Javascript 中可用，因为它在 2020 年 4 月处于提案阶段。您可以在此处监控状态以获取兼容性和支持 - [https://developer.mozilla.org/en-US/docs/Web/ JavaScript/参考/运算符/Nullish_coalescing_operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator)

对于使用 Typescript 的人，您可以使用[Typescript 3.7](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html)中的[空值合并运算符](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#nullish-coalescing)

从文档 -

> 您可以将此功能（运算符）视为在处理or`??`时“回退”到默认值的一种方式。当我们编写类似的代码时`null``undefined`
> 
> `let x = foo ?? bar();`
> 
> 这是一种新的说法，即`foo`当它“存在”时将使用该值；但是当它是`null`or时`undefined`，计算`bar()`它的位置。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-09-29T22:18:09.250

需要支持旧浏览器并具有对象层次结构

```
body.head.eyes[0]  //body, head, eyes  may be null 
```

可以用这个，

```
(((body||{}) .head||{}) .eyes||[])[0] ||'left eye' 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-02-15T05:52:36.903

话太多，这里有两个项目：

1.  逻辑或

常量 foo = '' || '默认字符串';

控制台.log(foo); // 输出是'默认字符串'

2.  空值合并运算符

常量 foo = '' ?? '默认字符串';

控制台.log(foo); // 输出为空字符串，即 ''

空值合并运算符 (??) 是一个逻辑运算符，当其左侧操作数为空或未定义时返回其右侧操作数，否则返回其左侧操作数。

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-04-08T10:54:43.423

现在它已全面支持最新版本的主流浏览器，如 Chrome、Edge、Firefox、Safari 等。这里是 null 运算符和 Nullish Coalescing 运算符之间的比较

```
const response = {
        settings: {
            nullValue: null,
            height: 400,
            animationDuration: 0,
            headerText: '',
            showSplashScreen: false
        }
    };
    /* OR Operator */
    const undefinedValue = response.settings.undefinedValue || 'Default Value'; // 'Default Value'
    const nullValue = response.settings.nullValue || 'Default Value'; // 'Default Value'
    const headerText = response.settings.headerText || 'Hello, world!'; //  'Hello, world!'
    const animationDuration = response.settings.animationDuration || 300; //  300
    const showSplashScreen = response.settings.showSplashScreen || true; //  true
    /* Nullish Coalescing Operator */
    const undefinedValue = response.settings.undefinedValue ?? 'Default Value'; // 'Default Value'
    const nullValue = response.settings.nullValue ?? ''Default Value'; // 'Default Value'
    const headerText = response.settings.headerText ?? 'Hello, world!'; // ''
    const animationDuration = response.settings.animationDuration ?? 300; // 0
    const showSplashScreen = response.settings.showSplashScreen ?? true; //  false 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-06-05T01:39:42.170

使用 Babel 的人需要升级到最新版本才能使用无效合并 (??)：

> Babel 7.8.0 默认支持新的 ECMAScript 2020 功能：您不再需要使用预设环境为无效合并 (??)、可选链接 (?.) 和动态 import() 启用单个插件

来自[https://babeljs.io/blog/2020/01/11/7.8.0](https://babeljs.io/blog/2020/01/11/7.8.0)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-10-11T11:03:21.643

**ECMAScript 2021**启用了两个新功能：

1.  **空值合并运算符 (??)**，它是一个逻辑运算符，当其左侧操作数为空或未定义时返回其右侧操作数，否则返回其左侧操作数。

```
let b = undefined ?? 5;

console.log(b); // 5
```

2.  **逻辑空赋值 (x ??= y)**运算符，仅在 x 具有空值（空或未定义）时进行赋值。

```
const car = {speed : 20};
car.speed ??= 5;
console.log(car.speed);
car.name ??= "reno";
console.log(car.name);
```

有关逻辑无效分配的更多信息，请参见[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_nullish_assignment](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_nullish_assignment)

可以在此处找到有关 Nullish 合并运算符的更多信息 [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator)

# ruby-on-rails - 在 Rails 中使用 will_paginate 和 partials

> ID：476443
> 
> 赞同：3
> 
> 时间：2009-01-24T18:24:13.333
> 
> 标签：ruby-on-rails, ruby, pagination

我有一组用 will_paginate 分页的人

```
@people = Person.paginate :page => params[:page],
                :limit => 10,
                    :conditions =>   ['company_id = ? ' , @company.id ] 
```

人员显示在公司/视图页面上，并以部分呈现。请注意，部分是在“人”的观点中

```
<%= render :partial => "people/person" , :locals => { :people => @people }%> 
```

在部分...

```
<% for person in @people %>

     ...

<%end%>

<%= will_paginate @people %> 
```

现在部分工作正常了，它渲染了所有人并在底部显示了分页链接。但是，它实际上并没有对集合进行分页，而是在第一页上显示所有内容。

我显然错过了一些相当基本的东西。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T18:49:59.507

你失踪了`per_page`吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T09:38:06.970

Per_page 应该是问题所在。

也使`:page => params[:page]`看起来像`:page => params[:page] || 1`这样 will_paginate 将停止抱怨空白页参数。

# iphone - 是否有适用于 iPhone 的库以使用 HMAC-SHA-1 编码

> ID：476455
> 
> 赞同：14
> 
> 时间：2009-01-24T18:29:46.100
> 
> 标签：iphone, amazon-web-services, signature

对于使用 Amazon 服务（S3、EC2、SimpleDB）的所有操作，您需要使用 HMAC-SHA-1 签名（[http://en.wikipedia.org/wiki/HMAC、http://docs.amazonwebservices.com](http://en.wikipedia.org/wiki/HMAC)）[签署所有请求/AWSFWS/latest/DeveloperGuide/index.html?SummaryOfAuthentication.html](http://docs.amazonwebservices.com/AWSFWS/latest/DeveloperGuide/index.html?SummaryOfAuthentication.html) )。

我在 asp.net 后端工作，没有问题。问题出在 iPhone 应用程序中。iPhone 开发者说没有办法使用 HMAC-SHA-1 编码，而且他没有权利实现自己的算法。作为程序员，我无法理解为什么会出现问题。

所以我也想知道是 iPhone 开发者吗？

*我从来没有为 iPhone 编码过，所以我什至不知道在哪里搜索这样的信息。*

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-11T15:17:59.253

CommonCrypto 可以解决问题。

```
#import <CommonCrypto/CommonHMAC.h> 
```

然后稍后

```
/*
  inputs:
  NSData *keyData;
  NSData *clearTextData
*/

uint8_t digest[CC_SHA1_DIGEST_LENGTH] = {0};

CCHmacContext hmacContext;
CCHmacInit(&hmacContext, kCCHmacAlgSHA1, keyData.bytes, keyData.length);
CCHmacUpdate(&hmacContext, clearTextData.bytes, clearTextData.length);
CCHmacFinal(&hmacContext, digest);

NSData *out = [NSData dataWithBytes:digest length:CC_SHA1_DIGEST_LENGTH]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-24T23:08:56.163

CommonCrypto 会做到这一点。但是如果你想要代码，我这里有一些：

[http://oauth.googlecode.com/svn/code/obj-c/OAuthConsumer/Crypto/](http://oauth.googlecode.com/svn/code/obj-c/OAuthConsumer/Crypto/)

我写的用于 Cocoa OAuth 实现：[http ://code.google.com/p/oauthconsumer/wiki/UsingOAuthConsumer](http://code.google.com/p/oauthconsumer/wiki/UsingOAuthConsumer)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-12-23T04:05:15.160

本文演示了一个小函数，它将生成一个 SHA-1 哈希摘要，如果你给它相同的输入，它将匹配 php sha1() 函数将生成的内容[：](http://spitzkoff.com/craig/?p=122)

```
#import <CommonCrypto/CommonDigest.h>

@implementation SHA1

+(NSString*) digest:(NSString*)input
{
const char *cstr = [input cStringUsingEncoding:NSUTF8StringEncoding];
NSData *data = [NSData dataWithBytes:cstr length:input.length];

uint8_t digest[CC_SHA1_DIGEST_LENGTH];

CC_SHA1(data.bytes, data.length, digest);

NSMutableString* output = [NSMutableString stringWithCapacity:CC_SHA1_DIGEST_LENGTH * 2];

for(int i = 0; i < CC_SHA1_DIGEST_LENGTH; i++)
[output appendFormat:@"%02x", digest[i]];

return output;

}
@end 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-06T16:20:38.363

[谷歌搜索](http://www.google.com/search?hl=en&client=safari&rls=en&q=sha1+export+law&aq=f&oq=&aqi=g-p1)了一下，我找到[了这个文件](http://www.itl.nist.gov/fipspubs/fip180-1.htm)。

> SHA1 的出口受（美国）联邦政府出口管制，建议出口商联系商务部出口管理局了解更多信息。

我还发现[了这个](http://www.sandelman.ottawa.on.ca/ipsec/1996/05/msg00050.html)：

> 中华人民共和国和前苏联地区可​​以进口 SHA，只要它用于民用最终用户应用而不是用于军事目的。以下国家禁止进口 SHA：古巴、伊朗、伊拉克、利比亚、朝鲜、塞尔维亚、叙利亚和苏丹。请注意，此禁运国家名单会随时间而变化。

*（不是对您问题的直接回答，但肯定是相关的。）*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-24T19:10:36.830

不是特别针对 iPhone，但库[libs3](http://libs3.ischo.com.s3.amazonaws.com/index.html)提供了一个用于访问 Amazon 的 S3 服务的 C API。它或 FUSE [s3fs](http://code.google.com/p/s3fs/)组件可能是提取与亚马逊网络服务通信所需的例程的好来源。由于 Objective-C 的核心仍然是 C，因此这些例程在 iPhone 上应该可以正常工作。

我知道至少有一位开发人员在他们的 iPhone 应用程序中使用类似的东西来与 S3 存储桶进行通信。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-24T21:14:03.257

我认为 CommonCrypto 库会做你想做的事。看看这个文件：

/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS2.2.sdk/usr/include/CommonCrypto/CommonHMAC.h

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-24T18:51:18.257

我不知道现在是否是这种情况，但过去加密算法受到限制，您将它们分发到某些国家的权利受到限制。

如果情况仍然如此，则可能是 Apple 不希望/不能限制某些应用程序在这些国家/地区下载。

# apache - 为什么 RewriteRule ^page/?$ page.php [L] 匹配 site.com/page//

> ID：476456
> 
> 赞同：1
> 
> 时间：2009-01-24T18:29:49.127
> 
> 标签：apache, .htaccess, mod-rewrite

```
RewriteEngine on
RewriteRule ^page/?$ page.php [L] 
```

这最终匹配 url www.site.com/page// 但在内部它的行为与 www.site.com/page/ 不同，因为样式表和图像不再正确显示。我是做错了什么，还是如果我不想遇到很多麻烦，这只是我需要处理的事情？

对我来说，它看起来应该只匹配 www.site.com/page 或 www.site.com/page/

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T18:33:11.273

Apache 剥离空路径段。所以`/path//`被视为`/path/`。但是您的浏览器并没有使用`/path//`.

如果要删除多个斜杠，可以使用以下规则：

```
RewriteCond %{THE_REQUEST} ^[A-Z]+\ /(([^/\ ]+/)*)/+([^\ ]*)
RewriteRule ^ /%1%3 [L,R=301] 
```

* * *

**解释**

尽管 Apache 删除了内部的空路径段，但`THE_REQUEST`环境变量（保存[HTTP 请求行](http://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.1)）保持不变。所以我们可以使用这个值来检查多个斜杠。

*   **`^[A-Z]+\ /`**匹配请求方法、后面的空格和 URI 路径的第一个斜杠字符。
*   **`(([^/\ ]+/)*)`**匹配所有后续的非空路径段（`foo/`、`foo/bar/`、`foo/bar/baz/`等）或不匹配（如果没有）。
*   **`/+`**匹配空路径段，因为此斜杠之前的字符始终是另一个斜杠（参见前面的表达式）。
*   **`([^\ ]*)`**匹配 URI 的其余部分（可能包含更多的空路径段）。

*示例：*假设我们请求`http://example.com/foo/bar//baz`，请求行将如下所示：

```
GET /foo/bar//baz HTTP/1.1 
```

然后该模式将匹配如下：

```
0: GET /foo/bar//baz
1: foo/bar/
2: bar/
3: baz 
```

所以请求的路径`/foo/bar//baz`将被重定向到`/foo/bar/baz`( `/%1%3`)。

# c++ - C++中get/set方法变量的方法声明的编程风格？

> ID：476461
> 
> 赞同：6
> 
> 时间：2009-01-24T18:35:51.220
> 
> 标签：c++, coding-style

您应该在 .h 文件中声明类的 getter/setter，然后在 .cpp 中定义它们，还是在 .h 文件中同时进行。你喜欢哪种风格，为什么？我个人喜欢后者，其中所有这些都在 .h 中，并且只有在 .cpp 中具有与其相关联的逻辑的方法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-24T18:39:44.207

对我来说，这取决于谁将使用 .h 文件。如果它主要是模块内部的文件，那么我倾向于将微小的方法放在标题中。如果它是一个更外部的头文件，它提供了一个更固定的 API，那么我会将所有内容都放在 .cpp 文件中。在这种情况下，我会经常使用[PIMPL Idiom](https://stackoverflow.com/questions/60570/usage-of-the-pimpl-idiom)作为完整的编译防火墙。

我看到将它们放在标题中的权衡是：

*   少打字
*   编译器更容易内联（尽管编译器现在有时可以在多个翻译单元之间进行内联。）
*   更多编译依赖

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-24T18:42:58.397

我会说头文件应该是关于接口，而不是实现。我会把它们放在.cpp中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-25T07:29:24.967

对我来说，这取决于我对代码所做的事情。对于我想要维护和持续使用的代码，我将所有内容都放在 .cc 文件中，原因如下：

*   对于想要查找函数和方法定义的人来说，.h 文件可以作为文档保持稀疏。
*   我小组的编码指南规定，我们将所有内容都放在 .cpp 文件中并喜欢遵循这些内容，即使函数定义只占用一行。这消除了关于事物实际位置的猜测游戏，因为您知道应该检查哪个文件。
*   如果您经常重新编译大型项目，与将函数定义保存在头文件中相比，将函数定义保存在 .cpp 文件中可以节省一些时间。这对我们最近很重要，因为我们最近检查了代码并添加了许多运行时断言语句来验证我们的类的输入数据，这需要对 getter 和 setter 进行大量修改。如果这些方法声明存在于 .cpp 文件中，这对我们来说将变成一个干净的重新编译，这在我的笔记本电脑上可能需要大约 30 分钟。

这并不是说我不会偶尔对规则进行快速而肮脏的操作，并且在实现非常快速的东西时将内容放入 .h 文件中，但是对于代码我很认真，我所有的代码（无论长度）都在.cpp 文件。对于大型项目（某些），规则的存在是有原因的，遵守它们可能是一种美德。

说到这，我只是想到了另一个 Perl 脚本，我可以一起破解来发现违反编码准则的情况。受欢迎是好事。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-24T18:49:16.607

只要它们不需要包含太多额外的标题（因为调用其他类的方法），我就把所有单行放在标题中。此外，我不会尝试将所有代码放在一行中，因此我可以将大部分方法放在标题中:-)

但是 Josh 提到了将它们放在 .cpp 中的一个很好的理由：如果标头是供外部使用的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-24T21:51:24.197

我更喜欢保持 .h 文件尽可能干净。因此，我经常使用像 get/set 这样简单的小函数将其作为内联定义的函数放入单独的文件中，然后将该文件（我使用扩展名 .inl）包含到 .h 头文件中：

```
// foo.h

class foo
{
public:
   int bar() const;

private:
   int m_bar;
};

#include "foo.inl"

// foo.inl

inline
int foo::bar() const
{
   return m_bar;
} 
```

我认为这提供了两全其美的效果，同时从头文件中隐藏了大部分实现，并且仍然保持内联简单代码的优势（根据经验，我将其保留在最多 3 个语句中）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-24T18:44:07.537

我几乎总是遵循在标题中声明它们并在源代码中定义的划分。每次我不这样做时，我最终都不得不回去再做任何事。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-24T19:43:36.233

为了快速编译/链接时间，我更喜欢将它们放入 .cpp 文件中。即使是很小的单行代码（空的虚拟析构函数！），如果它们被大量实例化，也会导致编译时间变长。在一个项目中，我可以通过将所有虚拟析构函数移动到 .cpp 文件中来将编译时间缩短几秒钟。

从那时起，我就被卖掉了，如果分析器告诉我可以从内联中获利，我只会将它们再次放入标题中。唯一的缺点是您需要更多的输入，但是如果您在编写标题时创建 .cpp 文件，您通常可以复制和粘贴声明并将它们填写到 .cpp 文件中，所以这还不错。当然更糟糕的是，如果您后来发现要将内容移动到 .cpp 文件中。

一个很好的副作用是，当您的标题中只有文档和声明时，阅读内容会更简单，尤其是当新开发人员加入项目时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-24T20:44:22.413

我使用下一条规则：声明头，实现代码文件。当您的标头在项目之外使用时，它成为实际 - 比您的标头更轻巧，使用起来更舒适

# iis - IIS 6.0 应用程序池崩溃

> ID：476473
> 
> 赞同：14
> 
> 时间：2009-01-24T18:47:14.397
> 
> 标签：iis, iis-6, debugging, crash, application-pool

在生产服务器上有很多麻烦。某些路由导致应用程序池崩溃，事件 id 为 1011：

> 事件类型：警告事件源：W3SVC 事件类别：无事件 ID：1011 日期：2009 年 1 月 21 日时间：上午 9:08:17 用户：N/A 计算机：xxxxxxxxxxxxxxx 描述：
> 
> 为应用程序池“DefaultAppPool”提供服务的进程与万维网发布服务发生了致命的通信错误。进程 ID 为“3788”。数据字段包含错误号。8007006d

在我发现问题之前，我有几个小时非常艰难。感谢 Tess Ferrandez 和她的[博客文章](http://blogs.msdn.com/tess/archive/2006/04/27/asp-net-2-0-crash-case-study-unhandled-exceptions.aspx)，我找到了它。

始终仔细检查您在 asp.net 应用程序中的多线程代码。当发生未处理的异常时，应用程序池崩溃并且很难找到原因。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-06-02T01:24:02.520

苔丝的博客对我来说有点先进。在找到帮助我调试转储文件的正确文章之前，我不得不四处搜索。本文将帮助其他想要[调试崩溃的 asp.net 应用程序池](http://blog.whitesites.com/Debugging-Faulting-Application-w3wp-exe-Crashes__634424707278896484_blog.htm)但不知道如何开始的人。

# networking - 如何正确高效地动态创建与原域不同IP的子域？

> ID：476474
> 
> 赞同：1
> 
> 时间：2009-01-24T18:47:20.527
> 
> 标签：networking, dns, subdomain, infrastructure

如何有效地动态创建解析为与原始域不同的 IP 的子域？

我在这里找到的大多数动态子域创建解决方案都会将 *.domain.com A 记录添加到 DNS 服务器（通常使用 BIND），但这**不是**我想要的。

这是否意味着需要将区域文件设置为始终过期？这不会对我们的 DNS 服务器造成沉重负担吗？

但是，如果客户端 ISP 不去获取我刚刚动态更改的新区域文件怎么办？难道他们不能解析我们新的子域条目吗？

在 BIND 中设置 DDNS 会是实现此类系统的逻辑路径吗？DDNS 将允许我在不重新启动 BIND 的情况下动态插入 A 记录，对吗？

我确信有一些方法可以做到这一点，因为大多数大型博客服务不会将所有帐户都指向与博客引擎相同的 IP，它们正在做与我需要的类似的事情。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T19:43:05.157

我想大多数执行此操作的服务都为这些帐户设置了通配符 (*.) DNS 条目，并可能将其指向负载均衡器，该负载均衡器根据主机名等分配请求。然后它们具有非标准条目设置作为 DNS 中的正常 A 记录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-25T13:48:23.833

是的，您可以使用动态 DNS 更新将区域文件更改推送到您的区域，而不必每次都将它们放入文本区域文件并重新加载 BIND。

每当注册域名时，许多大型域名注册机构都使用该技术。

但是，这并不意味着它是适合您的应用程序的技术。正如昨天对您的另一个问题所建议的那样，确实没有理由不使用通配符选项。

运行 Apache 的低端服务器足以对您的前几千个站点进行前端反向代理，更好的是，在您获得足够的用户来设置您的第二个分区集群之前，您甚至不需要部署它。

# python - Python正则表达式添加到url的链接

> ID：476478
> 
> 赞同：4
> 
> 时间：2009-01-24T18:48:33.910
> 
> 标签：python, regex, url

我正在尝试制作一个能够正确捕获 URL 的正则表达式，包括像 ( [http://example.com ) 中用括号括起来的 URL，并在](http://example.com)[https://blog.codinghorror.com/](https://blog.codinghorror.com/the-problem-with-urls/)上谈到了关于编码恐怖的内容[问题与网址/](https://blog.codinghorror.com/the-problem-with-urls/)

我目前正在使用以下内容在 python 中为以 http 和 www 开头的链接创建 HTML A 标记。

```
r1 = r"(\b(http|https)://([-A-Za-z0-9+&@#/%?=~_()|!:,.;]*[-A-Za-z0-9+&@#/%=~_()|]))"
r2 = r"((^|\b)www\.([-A-Za-z0-9+&@#/%?=~_()|!:,.;]*[-A-Za-z0-9+&@#/%=~_()|]))"
return re.sub(r2,r'<a rel="nofollow" target="_blank" href="http://\1">\1</a>',re.sub(r1,r'<a rel="nofollow" target="_blank" href="\1">\1</a>',text)) 
```

这很好用，除非有人将 url 包裹在括号中。有没有人有更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T18:57:39.383

问题是，URL 可能有括号作为它们的一部分......（[http://en.wikipedia.org/wiki/Tropical_Storm_Alberto_(2006)](http://en.wikipedia.org/wiki/Tropical_Storm_Alberto_(2006))）。你不能单独用正则表达式来处理它，因为它没有状态。你需要一个解析器。因此，您最好的机会是使用解析器，并尝试猜测正确的右括号。这很容易出错（网址可以打开括号而永远不会关闭它）所以我猜你无论如何都不走运。

另请参阅[http://en.wikipedia.org/wiki/](http://en.wikipedia.org/wiki/,)或 ( [http://en.wikipedia.org/wiki/](http://en.wikipedia.org/wiki/)) ) 和其他类似的有效 URL。

# c# - 在OpenGL中将纹理应用于正方形的问题

> ID：476485
> 
> 赞同：0
> 
> 时间：2009-01-24T18:51:47.617
> 
> 标签：c#, .net, windows-mobile, opengl-es

我被困在无法将纹理映射到openGLES中的正方形上。我正在尝试在屏幕上显示 jpg 图像，为了做到这一点，我画了一个正方形，然后将图像映射到该正方形上。然而，我得到的只是一个白色方块。我不知道我做错了什么。这个问题阻碍了我继续我的项目。我正在为 Windows Mobile使用[托管 OpenGL ES 包装器。](http://www.koushikdutta.com/search/label/Managed%20OpenGL%20ES)我验证纹理加载正确，但我无法将它应用到我的对象。[我上传了在这里](http://cid-af14228f1b5d4868.skydrive.live.com/self.aspx/.Public/TestTexture.zip)显示我的问题的示例项目. 您需要带有 Windows Mobile 6 SDK 的 VS2008 才能运行它。我还在此处发布了渲染和纹理对象的表单代码。任何建议都将不胜感激，因为我已经在这个问题上停留了一段时间，而且我不知道我做错了什么。

```
 public partial class Form1 : Form
{
    [DllImport("coredll")]
    extern static IntPtr GetDC(IntPtr hwnd);

    EGLDisplay myDisplay;
    EGLSurface mySurface;
    EGLContext myContext;

    public Form1()
    {
        InitializeComponent();
        myDisplay = egl.GetDisplay(new EGLNativeDisplayType(this));

        int major, minor;
        egl.Initialize(myDisplay, out major, out minor);

        EGLConfig[] configs = new EGLConfig[10];
        int[] attribList = new int[] 
        { 
            egl.EGL_RED_SIZE, 5, 
            egl.EGL_GREEN_SIZE, 6, 
            egl.EGL_BLUE_SIZE, 5, 
            egl.EGL_DEPTH_SIZE, 16 , 
            egl.EGL_SURFACE_TYPE, egl.EGL_WINDOW_BIT,
            egl.EGL_STENCIL_SIZE, egl.EGL_DONT_CARE,
            egl.EGL_NONE, egl.EGL_NONE 
        };

        int numConfig;
        if (!egl.ChooseConfig(myDisplay, attribList, configs, configs.Length, out numConfig) || numConfig < 1)
            throw new InvalidOperationException("Unable to choose config.");

        EGLConfig config = configs[0];
        mySurface = egl.CreateWindowSurface(myDisplay, config, Handle, null);
        myContext = egl.CreateContext(myDisplay, config, EGLContext.None, null);

        egl.MakeCurrent(myDisplay, mySurface, mySurface, myContext);
        gl.ClearColor(0, 0, 0, 0);
        InitGL();
    }

    void InitGL()
    {
        gl.ShadeModel(gl.GL_SMOOTH);
        gl.ClearColor(0.0f, 0.0f, 0.0f, 0.5f);
        gl.BlendFunc(gl.GL_SRC_ALPHA, gl.GL_ONE_MINUS_SRC_ALPHA);
        gl.Hint(gl.GL_PERSPECTIVE_CORRECTION_HINT, gl.GL_NICEST);
    }

    public unsafe void DrawGLScene()
    {
        gl.MatrixMode(gl.GL_PROJECTION);
        gl.LoadIdentity();
        gl.Orthof(0, ClientSize.Width, ClientSize.Height, 0, 0, 1);
        gl.Disable(gl.GL_DEPTH_TEST);

        gl.MatrixMode(gl.GL_MODELVIEW);
        gl.LoadIdentity();

        Texture myImage;
        Bitmap Image = new Bitmap(@"\Storage Card\Texture.jpg");
        using (MemoryStream ms = new MemoryStream())
        {
            Image.Save(ms, System.Drawing.Imaging.ImageFormat.Bmp);
            myImage = Texture.LoadStream(ms, false);
        }

        float[] rectangle = new float[] {
                0, 0,
                myImage.Width, 0,
                0,  myImage.Height,
                myImage.Width,  myImage.Height
            };

        float[] texturePosition = new float[] {
                0, 0,
                myImage.Width, 0,
                0,  myImage.Height,
                myImage.Width,  myImage.Height
            };

        //Bind texture
        gl.BindTexture(gl.GL_TEXTURE_2D, myImage.Name);
        gl.TexParameteri(gl.GL_TEXTURE_2D, gl.GL_TEXTURE_MIN_FILTER, gl.GL_LINEAR);
        gl.TexParameteri(gl.GL_TEXTURE_2D, gl.GL_TEXTURE_MAG_FILTER, gl.GL_LINEAR);
        gl.EnableClientState(gl.GL_TEXTURE_COORD_ARRAY);
        gl.EnableClientState(gl.GL_VERTEX_ARRAY);

        //draw square and texture it.
        fixed (float* rectanglePointer = &rectangle[0], positionPointer = &texturePosition[0])
        {
            gl.TexCoordPointer(2, gl.GL_FLOAT, 0, (IntPtr)positionPointer);
            gl.VertexPointer(2, gl.GL_FLOAT, 0, (IntPtr)rectanglePointer);
            gl.DrawArrays(gl.GL_TRIANGLE_STRIP, 0, 4);
        }

        gl.DisableClientState(gl.GL_TEXTURE_COORD_ARRAY);
        gl.DisableClientState(gl.GL_VERTEX_ARRAY);

    }

    protected override void OnPaintBackground(PaintEventArgs e)
    {

    }

    protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);
        gl.Clear(gl.GL_COLOR_BUFFER_BIT);

        DrawGLScene();
        egl.SwapBuffers(myDisplay, mySurface);
        gl.Clear(gl.GL_COLOR_BUFFER_BIT);
    }

    protected override void OnClosing(CancelEventArgs e)
    {
        if (!egl.DestroySurface(myDisplay, mySurface))
            throw new Exception("Error while destroying surface.");
        if (!egl.DestroyContext(myDisplay, myContext))
            throw new Exception("Error while destroying context.");
        if (!egl.Terminate(myDisplay))
            throw new Exception("Error while terminating display.");
        base.OnClosing(e);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T19:19:29.010

您需要启用纹理：

```
glEnable( GL_TEXTURE_2D ); 
```

在渲染正方形之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T21:01:41.987

如果您使用 OpenGL|ES，还请查看是否支持 glDrawTexImage-Extension（嗯 - 它应该是核心扩展并且是必需的，但您永远不知道......）

它不会直接帮助您解决问题（例如，您还必须启用纹理），但 glDrawTexImage 比多边形渲染更有效。而且它也需要更少的代码来编写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-02T17:06:42.567

如果您使用 UIImage、CGImage 和 CGContext 从 PNG 或 JPG 文件加载纹理，在创建纹理之前将 GL_TEXTURE_MIN_FILTER 设置为 GL_LINEAR 或 GL_NEAREST 非常重要，因为如果不这样做，除了最后一个边界之外的所有纹理都将设置为空白白色。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T20:02:58.313

谢谢您的帮助！但是，您的建议并没有解决问题。现在正方形是黑色而不是白色，但仍然没有纹理。我尝试在每个可能的位置添加 gl.Enable(gl.GL_TEXTURE_2D) ，但结果仍然是黑色方块。

编辑：Upps，对不起，我的图像的左上角是黑色的，这就是为什么我什么都没看到。将图像更改为具有不同的颜色，现在我可以看到渲染的部分图像。它没有正确映射，但我可以弄清楚那部分。非常感谢帮助！！！

# c# - 从 Microsoft .net 调用 mono c# 代码？

> ID：476486
> 
> 赞同：7
> 
> 时间：2009-01-24T18:52:00.377
> 
> 标签：c#, compiler-construction, mono

我有一些用 c# 编写的神经网络代码，可以从使用[SIMD](http://go-mono.com/docs/index.aspx?tlink=0@N%3aMono.Simd)支持中受益。[Mono 2.2](http://www.mono-project.com/news/archive/2009/Jan-13.html)刚刚推出支持 SIMD，但微软的 c# 还不支持。对我的 c# 设置感到满意，我想知道是否可以为该片段编写一个单声道库并从 .net 调用它。

编辑：我想我真正想知道的是是否可以将[单声道](http://www.mono-project.com/Main_Page)编译成类似于 DLL 的东西，然后我可以从 dotnet 调用它。我在[播客](http://www.hanselminutes.com/default.aspx?showID=157)上听到[Miguel de Icaza](http://en.wikipedia.org/wiki/Miguel_de_Icaza)说，对于 iphone，mono 编译器将允许他们编译为月光的 exe，因此它不会违反 iphone 的服务条款，所以它让我想到你还能编译到什么。

我在另一个播[客 Herding Code Episode 28](http://herdingcode.com/?p=109)上听到 Miguel de Icaza说您可以使用单声道编译器编译为 exe，而不仅仅是中间代码。这意味着什么？

这引起了我的好奇心，所以我想我会悬赏它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-24T19:18:03.757

来自[Miguel de Icaza 的博客](http://tirania.org/blog/archive/2008/Nov-03.html)：

> 我们的库为所有加速指令提供 C# 回退。这意味着，如果您的代码在不提供任何 SIMD 支持的机器上运行，或者您的机器不支持您正在使用的操作之一，则代码将继续正常工作。
> 
> 这也意味着您可以在 Windows 上将 Mono.Simd API 与 Microsoft 的 .NET 一起使用来原型化和开发您的代码，然后使用 Mono 全速运行它。

据我了解，这意味着您可以编写使用 Mono.Simd 的代码，并且能够在 .Net 下运行它，但它不会比常规代码快，因为 .Net 运行时不支持SIMD 呢。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T21:58:17.607

为了利用 SIMD 功能，运行时应该能够原生支持它。基本上，Mono`Mono.Simd`在运行时特别对待命名空间。显然，Microsoft .NET 运行时不支持此功能。但是，`Mono.Simd`提供的程序集是用托管代码编写的完全有效且正常的 .NET 程序集，因此它可以在 .NET CLR 上运行，但它只是 SIMD 指令的软件模拟。

您可以在 Windows 上运行 Mono 运行时并利用这些功能，但没有直接的方法可以在 .NET 上运行一半应用程序，而在 Mono 上运行另一半应用程序（当然，您可以使用两个不同的应用程序可以使用的通信机制，但对于这种情况根本没有意义）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-26T22:08:09.923

本质上，如果您使用 Simd 编写它并将 dll 与您的代码一起分发，那么如果目标 VM 支持它，它将使用加速。如果没有，它不会破裂。因此，您可以使用该库并为您的程序中使用 Mono 运行 .NET 应用程序的任何用户提供速度提升。

据说微软计划在其运行时的下一个版本中添加此类支持，尽管我找不到该链接，并且这一秒也没有它方便——如果有人的话，可以从历史备份中挖掘链接足够感兴趣。

# c++ - 如何使用带有参数/修改的 std::foreach

> ID：476488
> 
> 赞同：20
> 
> 时间：2009-01-24T18:53:23.823
> 
> 标签：c++, stl, loops, enumeration

我发现自己在写作

```
for(int i=0;i<myvec.size();i++)
   myvec[i]->DoWhatever(param); 
```

很多，我想把它压缩成一个`foreach`声明，但我不确定如何`param`在不冗长的情况下进入那里。我也有类似的东西

```
for(int i=0;i<myvec.size();i++)
   if(myvec[i]->IsOK())
      myvec[i]->DoWhatever(param); 
```

我也想重写那个人。有什么想法吗？

哦，还有，由于种种原因，我不想用boost。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-24T19:05:47.837

```
#include <vector>
#include <algorithm>
#include <functional>

class X
{
    public:
        void doWhat(int x) {}
        bool IsOK() const {return true;}
};
class CallWhatIfOk
{
    public:
        CallWhatIfOk(int p): param(p) {}

        void operator()(X& x) const
        {   if (x.IsOK())    {x.doWhat(param);}}
    private:
        int param;
};

int main()
{
    std::vector<X>      myVec;

    std::for_each(  myVec.begin(),
                    myVec.end(),
                    std::bind2nd(std::mem_fun_ref(&X::doWhat),4)
                 );

    std::for_each(  myVec.begin(),
                    myVec.end(),
                    CallWhatIfOk(4)
                 );
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-24T19:06:27.850

> 哦，还有，由于种种原因，我不想用boost。

有效的决定，但很可能是错误的决定。将 Boost 视为 STL 的扩展。C++ 是一种库驱动的语言。如果你不考虑到这一点，你的代码会质量较差。

虽然`std::for_each`可以在这里使用，但在 C++0x 之前 C++ 中没有 lambda 表达式使得这变得乏味。我提倡使用[Boost.ForEach](http://www.boost.org/doc/libs/1_37_0/doc/html/foreach.html)！它使这*更*容易：

```
foreach (yourtype x, yourvec)
    if (x.IsOK())
        x.Whatever(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-24T19:14:13.890

我首选的解决方案通常是编写一个仿函数来做我需要的事情：

```
struct doWhatever {
  doWhatever(const Param& p) p(p) {}
  void operator(MyVec v&, Param p) {
    v.DoWhatever(param);
  }

private:
  Param p;
}; 
```

然后循环：

```
std::for_each(myvec.begin(), myvec.end(), doWhatever(param)); 
```

根据您有多少变体，这可能有点过于冗长。不过，有很多选项可以内联。boost::lambda 可以让你在调用点构造你需要的函数。boost::bind （或标准库绑定函数）可以让您将参数 param 绑定到函数，因此您不需要每次都将其作为参数提供。

boost::lambda 可能是最简洁灵活的方法。我通常使用普通函子方法，因为语法更容易记住。;)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-18T09:18:14.130

好吧，当我们有支持 C++0x lambda 表达式的编译器时，这变得简单且微创：

```
std::for_each(myvec.begin(),myvec.end(),[&](X& item){
     item->DoWhatever(param);
}); 
```

第二个示例可能如下所示：

```
std::for_each(myvec.begin(),myvec.end(),[&](X& item){   
   if(item->IsOK())      
      myvec[i]->DoWhatever(param);
}); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-04-13T22:33:58.467

```
#include <vector>
#include <algorithm>
#include <boost/bind.hpp>
#include <boost/lambda/if.hpp>
#include <boost/lambda/bind.hpp>

struct A
{
  bool IsOK () { return true; }
  void DoWhatever (int param) {}
};

struct B
{
  bool IsOk (A * a) { return true; }
  void DoWhatever (A * a, int param) {}
};

typedef std::vector<A *> Myvec;

void main()
{
  Myvec myvec;
  int param = 1;
  B b;

  // first challenge using boost::bind (fnct in the same class)
  std::for_each (myvec.begin(), myvec.end(),
    boost::bind (&A::DoWhatever, _1, param));

  // first challenge using boost::bind (fnct in an external class)
  std::for_each (myvec.begin(), myvec.end(),
    boost::bind (&B::DoWhatever, &b, _1, param));

  // second challange using boost::lambda (fnct in the same class)
  std::for_each (myvec.begin(), myvec.end(),
    boost::lambda::if_then(
      boost::lambda::bind (&A::IsOK, boost::lambda::_1), 
      boost::lambda::bind (&A::DoWhatever, boost::lambda::_1, param)
    )
  );

  // second challange using boost::lambda (fnct in an external class)
  std::for_each (myvec.begin(), myvec.end(),
    boost::lambda::if_then(
      boost::lambda::bind (&B::IsOK, &b, boost::lambda::_1), 
      boost::lambda::bind (&B::DoWhatever, &b, boost::lambda::_1, param)
    )
  );

} 
```

您可以通过使用命名空间来简化它...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-01T17:27:06.390

如果您使用的是 GCC，您可以定义如下内容：

```
#define foreach(element, array) \
    for(typeof((array).begin()) element = (array).begin(), __end_##element = (array).end();\
        element != __end_##element;\
        ++element) 
```

然后像这样使用它：

```
foreach(element, array){
    element->DoSomething(); //or (*element)->DoSomething() if type is already a pointer
} 
```

我在自定义数组上使用它，但它也适用于 std::vector 。

# c# - C# 中的命名约定与 Java 的比较

> ID：476499
> 
> 赞同：5
> 
> 时间：2009-01-24T19:01:04.900
> 
> 标签：c#, java, naming-conventions

Java 世界中的标准命名约定是根据以下内容命名包、类和方法：

```
com.domainname.productname (package)
com.domainname.productname.ClassName (class)
com.domainname.productname.ClassName.isUpperCase(String str) (method) 
```

上述情况的 C#/.NET 标准命名约定是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-24T19:03:54.813

AKU 的回答应该可以帮助您：

[.NET 命名空间](https://stackoverflow.com/questions/55692/-net-namespaces#55700)

他链接到微软的指导方针：

[http://msdn.microsoft.com/en-us/library/893ke618(VS.71).aspx](http://msdn.microsoft.com/en-us/library/893ke618(VS.71).aspx)

您应该考虑从这里开始阅读其余的指南：

[http://msdn.microsoft.com/en-us/library/czefa0ke(VS.71).aspx](http://msdn.microsoft.com/en-us/library/czefa0ke(VS.71).aspx)

帖子的其余部分也非常有用：

[.NET 命名空间](https://stackoverflow.com/questions/55692/-net-namespaces)

在你的情况下，你会去：

```
CompanyName.ProductName
CompanyName.ProductName.ClassName
CompanyName.ClassName.IsUpperCase(string str) 
```

.NET 指南不遵循使用反向 FQ 域名来指定命名空间的 Java 风格，而且我还没有看到诸如 Telerik 或 Infragistics 之类的商业组件遵循除了 MS 指南之外的任何其他指南。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T19:18:57.670

很少见到“com”。在 C# 或 .NET 中：

```
DomainName.ProductName (namespace)
DomainName.ProductName.ClassName (class)
DomainName.ProductName.ClassName.IsUpperCase(String str) (method) 
```

请参阅 Microsoft 的[.NET Library Design Guidelines](http://msdn.microsoft.com/en-us/library/czefa0ke.aspx)以获得完整的独家新闻（这实际上是一个 .NET 问题，而不是 C# 问题）。

# python - 将相对 url 路径解析为其绝对路径

> ID：476511
> 
> 赞同：69
> 
> 时间：2009-01-24T19:09:59.937
> 
> 标签：python, url, path

python中是否有一个像这样工作的库？

```
>>> resolvePath("http://www.asite.com/folder/currentpage.html", "anotherpage.html")
'http://www.asite.com/folder/anotherpage.html'
>>> resolvePath("http://www.asite.com/folder/currentpage.html", "folder2/anotherpage.html")
'http://www.asite.com/folder/folder2/anotherpage.html'
>>> resolvePath("http://www.asite.com/folder/currentpage.html", "/folder3/anotherpage.html")
'http://www.asite.com/folder3/anotherpage.html'
>>> resolvePath("http://www.asite.com/folder/currentpage.html", "../finalpage.html")
'http://www.asite.com/finalpage.html' 
```

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2009-01-24T19:20:19.790

是的，有[`urlparse.urljoin`](https://docs.python.org/2/library/urlparse.html#urlparse.urljoin), or[`urllib.parse.urljoin`](https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urljoin)用于 Python 3。

```
>>> try: from urlparse import urljoin # Python2
... except ImportError: from urllib.parse import urljoin # Python3
...
>>> urljoin("http://www.asite.com/folder/currentpage.html", "anotherpage.html")
'http://www.asite.com/folder/anotherpage.html'
>>> urljoin("http://www.asite.com/folder/currentpage.html", "folder2/anotherpage.html")
'http://www.asite.com/folder/folder2/anotherpage.html'
>>> urljoin("http://www.asite.com/folder/currentpage.html", "/folder3/anotherpage.html")
'http://www.asite.com/folder3/anotherpage.html'
>>> urljoin("http://www.asite.com/folder/currentpage.html", "../finalpage.html")
'http://www.asite.com/finalpage.html' 
```

对于复制和粘贴：

```
try:
    from urlparse import urljoin  # Python2
except ImportError:
    from urllib.parse import urljoin  # Python3 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2019-09-24T09:28:27.853

您也可以`urljoin`通过 Python 的`requests`库调用该函数。

这段代码：

```
import requests

requests.compat.urljoin('http://example.com/foo.html', 'bar.html') 
```

将返回一个值`http://example.com/bar.html`

# c# - C# 中的哪些泛型集合是 IXmlSerializable？

> ID：476522
> 
> 赞同：3
> 
> 时间：2009-01-24T19:24:39.327
> 
> 标签：c#, generics, serialization, collections

是否有任何 .NET 泛型集合标记为 IXmlSerializable？我试过 List<T> 和 Collection<T> 但都没有开箱即用。

在推出我自己的 collection<T>、list<T> 或 dictionary<T> 类之前，我想我会检查一下 Microsoft 是否已经包含了可以做到这一点的东西。这似乎是基本功能。

编辑：通过“滚动我自己的”，我的意思是创建一个继承自通用集合类并且还实现 IXmlSerializable 的类。这是一个示例： http: [//www.codeproject.com/KB/XML/IXmlSerializable.aspx](http://www.codeproject.com/KB/XML/IXmlSerializable.aspx)。这是另一个例子：[http](http://weblogs.asp.net/pwelter34/archive/2006/05/03/444961.aspx) ://weblogs.asp.net/pwelter34/archive/2006/05/03/444961.aspx 。

我在签名如下所示的方法中使用 DataContractSerializer：

```
public static Stream GetXmlStream(IXmlSerializable item) 
```

问题在于，虽然 .NET 框架中有许多可序列化的类，但并非所有类都明确实现了 IXmlSerializable 接口。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T23:15:42.480

不需要将 IXmlSerializable 实现**为**xml 可序列化。

```
public class Foo 
{
    public List<string> Names { get; set; }
} 
```

xml序列化会很好地产生类似的东西：

```
<?xml version="1.0" encoding="utf-16"?>
<Foo 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Names>
    <string>a</string>
    <string>b</string>
    <string>c</string>
  </Names>
</Foo> 
```

然而

```
public class Foo<T> 
{
    public List<T> Names {  get; set; }
} 
```

会产生

```
<?xml version="1.0" encoding="utf-16"?>
<FooOfString 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Names>
    <string>a</string>
    <string>b</string>
    <string>c</string>
  </Names>
</FooOfString> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-24T19:32:17.940

据我所知，没有。不过，您可以查看随附的链接。我想你会发现它很有用。

[在 C# 2.0 中使用泛型类型将对象序列化和反序列化为 Xml](http://geekswithblogs.net/paulwhitblog/archive/2007/07/20/114076.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T19:27:58.630

与您的问题相关，如果您想序列化/反序列化 IDictionary，请参阅[此有用的帖子](http://www.mattberther.com/2004/06/14/serializing-an-idictionary-object/)。不过，我会将[此处](https://stackoverflow.com/questions/279534/proper-way-to-implement-ixmlserializable)显示的模式用于您的读写方法，因为它们可以更好地处理不同的情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T02:12:30.567

经过我自己的进一步研究，我得出了同样的结论。从 .NET 3.5 SP1 开始，所有 .NET 通用集合都不是 IXmlSerializable。

# c# - 家用 Vista 电脑有哪些好的 sql 数据库？

> ID：476526
> 
> 赞同：2
> 
> 时间：2009-01-24T19:30:07.867
> 
> 标签：c#, .net, sql

我一直在尝试在我的计算机上安装 SQL Server Express 来练习我的 C#/SQL，但我仍然没有让它工作。

我可以使用其他程序来设置 SQL 数据库来练习吗？如果是这样，哪些是最适合 Vista 的？

编辑：需要明确的是，我对 SQL 编程并不陌生，我只是有一段时间没有做过任何事情，想保持新鲜感。所以我想要一些具有我专业使用的 SQL 形式的大部分特性的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-24T19:33:49.777

MySQL 或 Postgresql 都是成熟的数据库，非常适合教育/实验。您还可以查看 Oracles 免费版。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T19:33:27.860

你不能为 Sql Express 工作吗？它适用于 Vista。我每天都使用它。它不再标配“northwind”数据库，但您可以下载 AdventureWorks DB。您能否更具体地说明“我还没有让它工作”？

我也听说过关于[火鸟的好消息](http://www.firebirdsql.org/)

尽管我仍然相信 C# 和 SQL Express 是最好的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T19:43:43.020

如果您需要快速、小巧且功能强大的东西，SQLite 是很好的选择……它的下载速度也很快。

[SQLite](http://www.sqlite.org/)

[SQLite 与 C#](http://www.codeproject.com/KB/cs/SQLiteCSharp.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-24T19:54:19.003

SQL Server Express 通常应该是练习 .NET 和 C# 的自然选择。

如果您之前没有使用 SQL Server 及其 Express 版本的经验，那么最令人困惑的一件事是 SQL Server Express 不是作为默认实例安装的，而是作为 SQLEXPRESS 实例安装的。因此，您必须在连接字符串中使用“Data Source=.\SQLEXPRESS”。

如果您无法克服 SQL Express 的问题，您可以尝试[Postgres](http://www.postgresql.org/)，但您需要下载并使用[.NET Data Provider for Postgres](http://npgsql.projects.postgresql.org/references.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T19:57:15.957

Oracle 和 IBM 都以类似于 SQL Server Express 的方式免费提供其旗舰数据库的报价版本。如果您想使用“真正的”数据库系统，两者都是出色的产品。

[Oracle 10g 速成版](http://www.oracle.com/technology/software/products/database/index.html)

[IBM DB2 Express](http://www-01.ibm.com/software/data/db2/express/)

Postgres 也非常值得考虑，因为它也是一个“真正的”关系数据库，最初是在 1980 年代作为备受推崇的 Ingres RDBMS 开始的。然而，直到最近 Postgress 都是基于 Unix 的，我从来没有发现它在 Windows 上安装特别可靠。

就个人而言，我不会为您的场景推荐 MySQL - 尽管最新版本最终可以被描述为 RDBMS，它是从真正具有有限 SQL 查询接口的平面文件集合演变而来的，但它的特性可能会减轻它作为学习工具的使用，除非您实际上专注于 MySQL。为了安抚那些想给我投反对票的人——是的，我确实使用了 MySQL，是的，它（现在）是（现在）并且是它的优秀产品——只是不在这里。

您可以考虑许多其他不太流行的 RDMS。 [Firebird](http://www.firebirdsql.org/)一直是我的最爱，因为我曾经编写过很多 Delphi 代码，而且在许多情况下使用[SQLite](http://www.sqlite.org/)都是一种乐趣。也很遗憾你不能使用 SQL Server Express，因为 SQL Server 产品系列是微软生产的最可靠的产品，通常是我选择的数据库，除了最小、最大或最不寻常的安装

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-25T01:29:28.467

我更喜欢 Firebird，它是一个成熟的 BD，而且它的操作系统非常稳定。

[http://www.firebirdsql.org/](http://www.firebirdsql.org/)

并尝试 ibexpert 管理此 bd。

[http://ibexpert.net/ibe/](http://ibexpert.net/ibe/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-24T19:33:28.327

[Vista DB](http://www.vistadb.net/ "远景数据库")是一个相当不错的轻量级托管平面文件数据库（与 Windows Vista 无关）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-24T19:41:21.277

对于一些非常简单的东西，请查看[sqlite](http://sqlite.org)它支持大多数 SQL 语法并将其数据库存储在单个文件中，因此设置很少。您将需要一个 ado.net 数据提供程序，您可以在[此处](http://sqlite.phxsoftware.com/)找到它。虽然对于具有大量数据的多用户系统来说，这不是一个好的选择，但对于数据库编程的介绍来说应该没问题。

# sql - Linq to SQL Case 何时在 VB.NET 中？

> ID：476529
> 
> 赞同：4
> 
> 时间：2009-01-24T19:32:45.130
> 
> 标签：sql, linq, linq-to-sql, tsql

我如何在 Linq to SQL 中做一个案例（请 vb.net）。

在 SQL 中应该是这样的：

```
SELECT 
CASE
  WHEN condition THEN trueresult
  [...n]
[ELSE elseresult]
END 
```

我将如何在 Linq to SQL 中执行此操作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-08-01T07:51:09.897

```
var data = from d in db.tb select new {

CaseResult = If (d.Col1 = “Case1”, "Case 1 Rised", If (d.Col1 = “Case2”, "Case 2 Rised", "Unknown Case"))

}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-15T16:17:24.060

看一下这个

```
var data = from d in db.tb select new {

 CaseResult = (

 d.Col1 == “Case1” ? "Case 1 Rised" :

 d.Col1 == “Case2” ? "Case 2 Rised" :

 "Unknown Case")

 }; 
```

请注意 [ ? 符号 = 然后]，[：符号 = 或]。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T21:21:27.423

我还没有尝试过，但您可以执行以下操作：

```
Dim query = From tbl In db.Table _
            Select result =_
                If(tbl.Col1 < tbl.Col2,"Less than",_
                    If(tbl.Col1 = tbl.Col2,"Equal to","Greater than")) 
```

您只需要继续嵌套 If 函数来处理所有情况。

[您可以在http://msdn.microsoft.com/en-us/library/bb386913.aspx](http://msdn.microsoft.com/en-us/library/bb386913.aspx)找到更多各种查询的示例

# c# - 泛型类中的 C#-数组协方差

> ID：476534
> 
> 赞同：6
> 
> 时间：2009-01-24T19:34:31.663
> 
> 标签：c#, generics, covariance

我知道 C# 支持这样的数组中的协方差：

```
object[] array = new string[3]; 
```

但是当它尝试编译以下代码时出现错误

```
class Dummy<K,T> where T:K
{
    public void foo()
    {
        K[] arr = new T[4];
    }
} 
```

它说“无法将类型'T[]'隐式转换为'K[]'”

为什么我收到这个错误？？？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-24T19:47:25.867

您必须指定 T 和 K 都是引用类型。数组协方差仅适用于引用类型。将声明更改为：

```
class Dummy<K,T> where T : class, K 
```

它工作正常。您不必指定 K 是引用类型，因为如果 T 是引用类型并且它派生自或实现 K，那么 K 也必须是引用类型。（至少我认为这是推理。`where K : class`为了清楚起见，添加也没有什么坏处。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-24T19:37:07.353

类型 T 必须支持隐式转换为 KEg

T a = 新 T(); K b = a;

必须有效。

# unit-testing - 如何正确模拟和单元测试

> ID：476540
> 
> 赞同：24
> 
> 时间：2009-01-24T19:40:15.023
> 
> 标签：unit-testing, mocking

我基本上是在尝试自学如何编码，并且我想遵循良好的做法。单元测试有明显的好处。在单元测试方面也有很多狂热，我更喜欢更实用的编码和生活方法。作为上下文，我目前正在编写我的第一个“真实”应用程序，它是使用 asp.net MVC 的无处不在的博客引擎。我通过自己的调整松散地遵循 MVC Storefront 架构。因此，这是我第一次真正尝试模拟对象。我将把代码示例放在问题的末尾。

我很感激任何可以用来增加我对测试和模拟基础知识的理解的见解或外部资源。我在网上找到的资源通常是针对嘲笑的“方式”，我需要更多地了解嘲笑的地点、原因和时间。如果这不是问这个问题的最佳地点，请指点我一个更好的地方。

我试图了解我从以下测试中获得的价值。UserService 依赖于 IUserRepository。服务层的价值是将逻辑与数据存储分开，但在这种情况下，大多数 UserService 调用只是直接传递给 IUserRepository。没有太多实际逻辑可以测试的事实也可能是我担心的根源。我有以下顾虑。

*   感觉就像代码只是在测试模拟框架是否正常工作。
*   为了模拟依赖关系，它使我的测试对 IUserRepository 实现有太多的了解。这是必要的邪恶吗？
*   我实际上从这些测试中获得了什么价值？被测服务的简单性是否让我怀疑这些测试的价值。

我正在使用 NUnit 和 Rhino.Mocks，但我想要完成的工作应该很明显。

```
 [SetUp]
    public void Setup()
    {
        userRepo = MockRepository.GenerateMock<IUserRepository>();
        userSvc = new UserService(userRepo);
        theUser = new User
        {
            ID = null,
            UserName = "http://joe.myopenid.com",
            EmailAddress = "joe@joeblow.com",
            DisplayName = "Joe Blow",
            Website = "http://joeblow.com"
        };
    }

    [Test]
    public void UserService_can_create_a_new_user()
    {
        // Arrange
        userRepo.Expect(repo => repo.CreateUser(theUser)).Return(true);

        // Act
        bool result = userSvc.CreateUser(theUser);

        // Assert
        userRepo.VerifyAllExpectations();
        Assert.That(result, Is.True, 
          "UserService.CreateUser(user) failed when it should have succeeded");
    }

    [Test]
    public void UserService_can_not_create_an_existing_user()
    {
        // Arrange
        userRepo.Stub(repo => repo.IsExistingUser(theUser)).Return(true);
        userRepo.Expect(repo => repo.CreateUser(theUser)).Return(false);
        // Act
        bool result = userSvc.CreateUser(theUser);

        // Assert
        userRepo.VerifyAllExpectations();
        Assert.That(result, Is.False, 
            "UserService.CreateUser() allowed multiple copies of same user to be created");
    } 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-24T20:15:08.913

本质上，您在这里测试的是方法被调用，而不是它们是否真的有效。这是模拟应该做的。他们不调用该方法，而是检查该方法是否被调用，并返回 Return() 语句中的任何内容。所以在你的断言中：

```
Assert.That(result, Is.False, "error message here"); 
```

这个断言总是会成功，因为你的期望总是会返回 false，因为 Return 语句：

```
userRepo.Expect(repo => repo.CreateUser(theUser)).Return(false); 
```

我猜这在这种情况下没有那么有用。

例如，当您想在代码中的某处进行数据库调用，但您不想实际调用数据库时，模拟是有用的。你想假装数据库被调用，但是你想设置一些假数据让它返回，然后（这是重要的部分）测试对你的模拟返回的假数据执行某些操作的逻辑。在上面的示例中，您省略了最后一步。想象一下，您有一个方法向用户显示一条消息，说明是否创建了新用户：

```
public string displayMessage(bool userWasCreated) {
    if (userWasCreated)
        return "User created successfully!";
    return "User already exists";
} 
```

那么你的测试将是

```
userRepo.Expect(repo => repo.CreateUser(theUser)).Return(false);
Assert.AreEqual("User already exists", displayMessage(userSvc.CreateUser(theUser))) 
```

现在这有一些价值，因为您正在测试一些实际行为。当然，您也可以直接通过传入“true”或“false”来测试它。您甚至不需要模拟该测试。测试期望很好，但是我已经编写了很多这样的测试，并且得出了与您正在达到的相同的结论 - 它只是没有那么有用。

所以简而言之，当您想要抽象出外部性（如数据库或 Web 服务调用等）并在此时注入已知值时，模拟很有用。但是直接测试模拟并不经常有用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-24T20:12:44.660

你是对的：服务的简单性使这些测试变得无趣。直到您在服务中获得更多业务逻辑，您才能从测试中获得价值。

你可能会考虑一些这样的测试：

```
CreateUser_fails_if_email_is_invalid()
CreateUser_fails_if_username_is_empty() 
```

另一条评论：它看起来像代码气味，您的方法返回布尔值以指示成功或失败。您可能有充分的理由这样做，但通常您应该让异常传播出去。这也使得编写好的测试变得更加困难，因为您将无法检测您的方法是否因“正确的原因”而失败，因此您可以像这样编写 CreateUser_fails_if_email_is_invalid() 测试：

```
[Test]
public void CreateUser_fails_if_email_is_invalid()
{
    bool result = userSvc.CreateUser(userWithInvalidEmailAddress);
    Assert.That(result, Is.False);
} 
```

它可能适用于您现有的代码。使用 TDD Red-Green-Refactor-cycle 可以缓解这个问题，但如果能够实际检测到该方法由于无效电子邮件而不是因为其他问题而失败，那就更好了。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-24T21:00:51.100

如果您在编写代码之前编写测试，您将从单元测试中获得更多。感觉你的测试不值钱的原因之一是你没有得到让你的测试驱动设计的价值。之后写你的测试只是一个练习，看看你是否能记住所有可能出错的东西。首先编写测试会让您考虑如何实际实现功能。

这些测试并不是那么有趣，因为正在实现的功能非常基本。你进行模拟的方式似乎很标准——模拟被测类所依赖的东西，而不是被测类。可测试性（或良好的设计意识）已经引导您实现接口并使用依赖注入来减少耦合。正如其他人所建议的那样，您可能需要考虑更改错误处理。例如，如果只是为了提高测试质量，很高兴知道为什么 CreateUser 失败了。您可以使用异常或`out`参数来执行此操作（如果我没记错的话，这就是 MembershipProvider 的工作方式）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-26T15:57:00.563

您正面临“经典”与“模拟”测试方法的问题。或 Martin Fowler 描述的“状态验证”与“行为验证”：[http ://martinfowler.com/articles/mocksArentStubs.html#ClassicalAndMockistTesting](http://martinfowler.com/articles/mocksArentStubs.html#ClassicalAndMockistTesting)

另一个最优秀的资源是 Gerard Meszaros 的书“xUnit 测试模式：重构测试代码”

# asp.net - 网格视图分页

> ID：476555
> 
> 赞同：1
> 
> 时间：2009-01-24T19:48:04.397
> 
> 标签：asp.net, gridview

我有一个绑定到代码隐藏中的数据视图的网格视图。数据源实际上是powershell，所以我自己处理数据。这工作正常并显示我想要的结果。但是，当我尝试启用分页时，打开页面时出现此错误：

该表必须包含按页眉、正文和页脚顺序排列的行部分。

知道为什么会这样吗？

这是我的绑定代码：

```
 mbGrid.DataSource = MailBoxManager.Instance.getDataTable();
      mbGrid.EnableSortingAndPagingCallbacks = true;
      mbGrid.AllowPaging = true; 
```

填充数据表的代码是：

```
public DataTable getDataTable()
    {
        DataTable dt = new DataTable();
        dt.Columns.Add(new DataColumn("Name", typeof(string)));
        dt.Columns.Add(new DataColumn("Email", typeof(string)));

        foreach (Mailbox mb in MbList)
        {
            DataRow dr;
            dr = dt.NewRow();
            dr["Name"] = mb.Name;
            dr["Email"] = mb.PrimaryEmail;
            dt.Rows.Add(dr);
        }
        return dt;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T22:53:06.277

对于遇到此问题的任何人，这里有 2 个问题。首先，由于某种原因，在 aspx 页面中设置分页设置，而不是后面的代码修复了第一个错误，不太清楚为什么。然后我收到另一个错误，因为我使用的数据源不是 sql 数据源，它是自定义的，所以我必须为 gridview_pageIndexChanging 方法定义代码，一旦我这样做了，它就很好用。代码非常简单：

```
 protected void grid_PageIndexChanging1(object sender, 
                                        GridViewPageEventArgs e)
   {
        grid.PageIndex = e.NewPageIndex;
        grid.DataBind();
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T02:25:08.617

一个[开箱即用的 GridView 控件](http://www.codeproject.com/KB/grid/GenericGridViewWithPaging.aspx)来处理这类问题

# c# - 设计 SOA WCF Web 服务时的最佳实践是什么？

> ID：476557
> 
> 赞同：11
> 
> 时间：2009-01-24T19:48:11.310
> 
> 标签：c#, wcf, web-services, datacontract

给定一个运营合同，例如：

```
[OperationContract]
void Operation(string param1, string param2, int param3); 
```

这可以重新设计为：

```
[MessageContract]
public class OperationRequest
{
    [MessageBodyMember]
    public string Param1 { get; set; }

    [MessageBodyMember]
    public string Param2 { get; set; }

    [MessageBodyMember]
    public int Param3 { get; set; }
}

[MessageContract]
public class OperationResponse
{
}

[OperationContract]
OperationResponse Operation(OperationRequest request); 
```

我喜欢 MessageContract 的一件事是我可以更明确地控制 SOAP 消息的格式。

同样，我可以编写几乎相同的代码，但使用 DataContract：

```
[DataContract]
public class OperationRequest
{
    [DataMember]
    public string Param1 { get; set; }

    [DataMember]
    public string Param2 { get; set; }

    [DataMember]
    public int Param3 { get; set; }
}

[DataContract]
public class OperationResponse
{
}

[OperationContract]
OperationResponse Operation(OperationRequest request); 
```

我喜欢 DataContract 的一件事是我可以定义 IsRequired、Order 和 Name。

今天，我预计唯一的消费者将是 WCF 客户端。但是，我想先设计契约，并尽可能地坚持 SOA 实践。我不想让 WCF 规定我的 SOAP、WSDL 和 XSD，而是希望 XML 定义 WCF 层，但使用 WCF 生成它，以免向 WCF 添加任何自定义消息处理。我想遵循最常见的 SOA XML 约定，我认为这些约定可能所有标签都以小写开头——对吗？我想尽可能地容忍版本。

总是像这样创建请求和响应消息是否明智？三种格式中的哪一种促进了最佳 SOA 实践？我是否应该更进一步并定义一个 DataContract 和一个 MessageContract，而 MessageContract 只包含 DataContract？或者，如果我真正公开一种新类型（即不将消息类型创建为容器），我是否应该只使用 DataContracts？

我知道一组加载的问题，但我正试图深入其中，我不确定将问题分开是否能提供足够的上下文来获得我正在寻找的答案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-26T05:47:30.313

在操作合同中不要有多个参数始终是最佳实践，始终具有包装所有必需参数的类型，从长远来看，这将有所帮助。当您添加新的可选参数时，您现有的客户端不会中断。

我在一个业务集成团队工作，我们定期与其他公司（AT&T、Cox、Exxon ...）进行集成，并且从未见过需要多个参数的 Web 服务调用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-01T23:50:51.067

`XML`通常倾向于驼峰式。`WSDL`和`XML`Schema 对元素和属性都使用 camelCasing，例如检查[syntax](http://www.w3schools.com/wsdl/wsdl_syntax.asp)和[schema](http://www.w3schools.com/Schema/schema_howto.asp)。

为什么`SOAP`定义不同，我不知道，但它对元素使用 PascalCasing，对属性使用 camelCasing，请查看[此处](http://www.w3schools.com/soap/soap_header.asp)。

同样，大多数`WS*`规范（可能全部）使用 PascalCasing 来表示元素和属性，请参见[此处](http://ws-standards.com/)。XML Schema 不知道它为 XML 定义的类型的约定。

[Thomas Erl](http://www.thomaserl.com/)撰写了许多重要的书籍，[`SOA`](http://www.soabooks.com/)包括“面向服务的架构”。在第*13*章和第*15*章中，他提供了一些典型事务各个部分的 XML 示例。它使用 PascalCasing 在 XML Schema 中定义类型和对象成员，这很好地匹配了 C# 中用于类和属性命名的常规模式。因此，`WCF`默认值已经与标准非常接近。

关于实际的消息命名，一些约定使用 camelCasing 而其他约定使用 PascalCasing，所以我的偏好是匹配主要语言需求，在这种`WCF`情况下是 PascalCasing。并且`WCF`默认值匹配请求和响应消息应该如何编写的[一些示例，这里有一些示例](http://www.w3schools.com/soap/soap_example.asp)。

`OperationContract`所以现在唯一悬而未决的问题是围绕,`DataContract`和/或的使用标准化多少的基本问题`MessageContract`。

仅当您具有复杂类型（用`XSD`说法）才有意义时才定义 DataContract，我倾向于认为 Terry 指出的 YAGNI（您不需要它）是正确的选择，但*Erl*似乎建议更多处理密集型版本，所以我仍然不确定用作我的默认选择的最佳方法（问题的主要部分）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T01:36:08.587

老实说，我认为这取决于场景。如果您只是交换简单类型 [即字符串]，那么 OperationContract 肯定是可以接受的。

当您想要修改消息格式时应该使用 MessageContract，而当您想要表达复杂类型（例如地址）时应该利用 DataContract。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T03:34:56.660

这里想到了 [YAGNI 。](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)

我说不要过分幻想未来。WCF 已经很好地支持 SOA。我说，一般来说，坚持默认值并小心耦合，直到你有特殊需要做一些复杂的事情。

# drupal - Drupal问题，如何创建快速内容模块？

> ID：476573
> 
> 赞同：1
> 
> 时间：2009-01-24T20:00:42.390
> 
> 标签：drupal

嗨，我需要在 drupal 中创建一个模块来显示一些数据，而不是作为一个 drupal 开发人员，并且在阅读了几个教程之后，我似乎无法显示任何内容。

我有下一个代码：

```
<?php
function helloworld_perm() {
  return array('access helloworld content');
} 

function helloworld_listado(){
 return "yea";
}

function helloworld_menu(){
    $items = array();
    $items["listado"] = array(
        'title' => t('Listado de empresas'),
        'callback' => 'helloworld_listado',
        'access' => array('access helloworld content'),
        'type' => MENU_NORMAL_ITEM 
      );
    return $items;
} 
```

当我输入 /listado 时，我收到拒绝访问 您无权访问此页面。

知道我做错了什么吗？如果我转到 admin->module->permissions，我已经检查了所有角色访问 helloold 内容的权限。

泰！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T20:47:49.347

从菜单数组的结构方式来看`helloworld_menu()`，我假设这是 Drupal 6。如果是这样，您需要将“访问”重命名为“访问参数”。请参阅[http://api.drupal.org/api/function/hook_menu/6](http://api.drupal.org/api/function/hook_menu/6)。

Drupal API 文档还包括一个被大量注释的 page_example.module，它基本上完成了您在此处所做的工作，您可能想要查看：[http ://api.drupal.org/api/file/developer/examples/page_example .module/6/source](http://api.drupal.org/api/file/developer/examples/page_example.module/6/source)

希望有帮助！

哦。并且不要忘记之后从管理>>站点配置>>性能上的“清除缓存”按钮清除缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-03T01:45:29.647

```
 => t('Listado de empresas'),
    'page callback'    => 'helloworld_listado',
    'access arguments' => array('access helloworld content'),
    'type'             => MENU_NORMAL_ITEM,
  );
return $items;
} 
```

请注意，`MENU_NORMAL_ITEM`作为 的默认值`type`，您无需指定它。

此外，正如我们尊敬的网络小妞刚刚所说的那样

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T10:35:21.517

看来您正在为 hook_menu 使用 Drupal 5（数组内容）和 Drupal 6（没有 $may_cache，$items 由路径索引）语法的混合。

如果您使用的是 Drupal 6，则应如下所示：

```
<?php
function helloworld_perm() {
  return array('access helloworld content');
} 

function helloworld_listado(){
 return "yea";
}

function helloworld_menu(){
    $items = array();
    $items["listado"] = array(
        'title'            => t('Listado de empresas'),
        'page callback'    => 'helloworld_listado',
        'access arguments' => array('access helloworld content'),
        'type'             => MENU_NORMAL_ITEM,
      );
    return $items;
}
?> 
```

请注意，`MENU_NORMAL_ITEM`作为“类型”的默认值，您无需指定它。

另外，正如我们尊敬的网妞刚才所说，您可以在她指向的页面上找到详细的解释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-05T10:56:02.350

仅供参考，以上链接移至

[http://api.drupal.org/api/examples/page_example--page_example.module/6](http://api.drupal.org/api/examples/page_example--page_example.module/6)

# java - 如何翻译 printf("%c",M); 从 C 到 Java 用于我的 DES 实现？

> ID：476576
> 
> 赞同：0
> 
> 时间：2009-01-24T20:01:23.967
> 
> 标签：java, c, cryptography, des

我是一名德国学生，对于计算机课程，我需要用 Java 实现 DES 加密（我自己，而不是使用 Java-API）并详细解释。我没有使用 google 找到任何 Java 代码示例，但是[我确实在 C 中找到了一个简单的实现](http://cppgm.blogspot.com/2008/01/data-encryption-standard.html)。（我不懂 C，我懂一点 C++，但不是那么好，指针仍然不时让我明白。）

因此，我尝试简单地将代码从 C 转换为 Java，这确实完成了大约一半，但是我在最后一部分遇到了问题，尤其是使用以下示例：

```
printf("%c",M); 
```

从谷歌告诉我的来看，这似乎是将数字（整数）转换为 ASCII 字符，但我不太确定。我的代码似乎一直有效，直到最后一部分，所以我会感谢任何能给我修复/提示的人。

我的代码：

```
import java.util.Scanner;

public class DES {

    /**
     * @param args
     */
    public static void main(String[] args) {

        Scanner eingabe = new Scanner(System.in);

        int p, q, key2, fn, encryption_key, temp1 , temp2 ,
            t, s =0 , privatekey1=1, b=0 , passwort_s=0, klartext;
        int[] Cipher = new int [100];
        String passwort;

        System.out.println("Enter the value of p and q");

        p = eingabe.nextInt();
        q = eingabe.nextInt();

        System.out.println(p);
        System.out.println(q);

        key2= p*q;

        fn=(p-1)*(q-1);
        System.out.println("Enter Enryption key e: ");
        encryption_key = eingabe.nextInt();

        do {

            s=(privatekey1*encryption_key)%fn;
            privatekey1++; 

        } while (s!=1); 

        privatekey1=privatekey1-1;

        System.out.println("Public Key : "+ encryption_key + ","+ key2 );
        System.out.println("Private Key: "+ privatekey1 + "," +key2 );
        System.out.println("Enter Message: ");
        passwort= eingabe.next();
        for ( temp2 = 0; temp2 < passwort.length(); temp2++) 
        {
            t = passwort.charAt(temp2);
            passwort_s=1;
            for(temp1 =0 ; temp1< encryption_key ; temp1++){
                passwort_s= passwort_s*t%key2;
            }
            passwort_s= passwort_s%key2;
            System.out.println(passwort_s);
        }

        System.out.println("Enter cipher Text: ");
        for(temp1=0;temp1< passwort.length(); temp1++ )
        {
            Cipher[temp1]= eingabe.nextInt();
        }

        System.out.println("Plainttext: ");
        for(temp2 =0; temp2 < passwort.length(); temp2++);
        {
            klartext=1;

            for(temp1 =0; temp1 < privatekey1; temp1 ++){
                klartext=klartext*Cipher[temp2]%key2;
            }
            klartext=klartext%key2;
            System.out.println(klartext);
        }
    }
} 
```

我怎样才能转换

```
printf("%c",M); 
```

到Java，这是一个完整的DES实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T22:34:24.233

很晚了，我累了，但这不是 DES 实现，是吗？

它看起来更像[RSA](http://en.wikipedia.org/wiki/RSA#Key_Generation)。

是的，您帖子上的链接是非对称密码系统。DES 是对称的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T22:24:26.783

或者，更简洁地说：

```
output.print((char)M); 
```

这假定 M 是一个数值，表示 0-127 的 ASCII 字符（或 0-255 的 ISO 8859-1 字符，或 0-65535 的 Unicode 字符）。

它还假设输出是 PrintWriter 或 PrintStream，其中之一是 System.out（FileOutputStream 很容易被 PrintOutputStream 或 PrintWriter(new OutputStreamWriter) 包装）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T23:02:00.637

Des 实际上是一个相当难理解的算法。我正要写博客，但是当我挖出来的时候。我不能把它分解成我满意的部分。

以下是 DES 的大致工作原理。

1.  选择 64 位密钥。（扔掉 8 位）
2.  对于每个 64 位块分成两半
3.  根据生成的子键做一些基于异或的排列，并对另一半做同样的事情。
4.  做一些替换。
5.  做更多的排列

解密以反向编号运行。

*这是一个粗略的简化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T17:30:08.703

该程序适用于 RSA 算法，而不适用于 DES。DES 代码比 RSA 大 8 倍 :)

# python - 有人在 Python/其他语言中使用元元类/元元类吗？

> ID：476586
> 
> 赞同：15
> 
> 时间：2009-01-24T20:10:48.457
> 
> 标签：python, metaprogramming, design-patterns, factory, metaclass

我最近在 python 中发现了元类。

基本上，python中的元类是一个创建类的类。您想要这样做的原因有很多——例如任何类型的类初始化。在工厂上注册类、复杂的属性验证、改变继承的工作方式等等。所有这些不仅变得可能而且变得简单。

但在 python 中，元类也是普通类。所以，我开始想知道抽象是否可以有用地更高，在我看来它可以而且：

*   元类对应或实现模式中的角色（如在 GOF 模式语言中）。
*   元元类就是模式本身（如果我们允许它创建代表抽象角色的类元组，而不仅仅是一个类）
*   meta-meta-metaclass 是一个*模式工厂*，它对应于 GOF 模式分组，例如 Creational、Structural、Behavioural。一个工厂，您可以在其中描述某种类型的问题的案例，它会为您提供一组解决它的类。
*   一个 meta-meta-meta-metaclass （据我所知），是一个*模式工厂 factory*，一个你可以描述问题类型的工厂，它会给你一个模式工厂来询问。

我在网上找到了一些关于这个的东西，但大多不是很有用。一个问题是不同的语言对元类的定义略有不同。

有没有其他人在 python/其他地方使用过这样的元类，或者在野外看到过这个，或者考虑过它？其他语言的类似物是什么？例如，在 C++ 中，模板递归能走多远？

我非常想进一步研究它。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-24T21:00:00.587

这让我想起了一些人似乎对“模式的通用实现”的永恒追求。就像一个可以创建任何对象（[包括另一个工厂](http://discuss.joelonsoftware.com/default.asp?joel.3.219431.12)）的工厂，或者一个通用的依赖注入框架，它比简单地编写实际*执行*某些操作的代码要复杂得多。

当我管理 Zend Framework 项目时，我不得不与那些想抽象的人打交道。我拒绝了一堆创建不做任何事情的组件的提议，它们只是 GoF 模式的神奇实现，就好像模式本身就是一个目标，而不是实现目标的手段。

抽象有一个收益递减点。一些抽象很棒，但最终您需要编写一些有用的代码。

否则它只是[一路下来的乌龟](http://en.wikipedia.org/wiki/Turtles_all_the_way_down)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-24T20:49:28.050

回答你的问题：没有。

随意进一步研究它。

但是请注意，您将设计模式（只是想法）与代码（这是一种实现）混为一谈。

好的代码通常反映了许多相互关联的设计模式。没有简单的方法可以将其正式化。您能做的最好的事情是一张漂亮的图片、编写良好的文档字符串和反映各种设计模式的方法名称。

另请注意，元类是一个类。那是一个循环。没有更高级别的抽象。在这一点上，它只是意图。meta-meta-class 的想法没有多大意义——它是元类的元类，这很愚蠢，但在技术上是可行的。然而，这一切都只是一堂课。

* * *

**编辑**

“创建元类的类真的那么傻吗？它们的效用怎么突然用完了？”

创建类的类很好。差不多就是这样。目标类是元类或抽象超类或具体类这一事实并不重要。元类产生类。他们可能会创建其他元类，这很奇怪，但它们仍然只是创建类的元类。

该实用程序“突然”耗尽，因为在创建另一个元类的元类中没有您需要（甚至可以编写）的实际东西。并不是它“突然”变得愚蠢。就是那里没有什么用处。

当我播种时，请随意研究它。例如，实际编写一个构建另一个元类的元类。玩得开心。那里可能有一些有用的东西。

OO 的重点是编写模拟现实世界实体的类定义。因此，元类有时可以方便地定义几个相关类的横切方面。（这是一种进行面向方面编程的方法。）这就是元类真正可以做的事情。它是一个存放一些函数的地方，比如`__new__()`，它们不是类本身的适当部分。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-01-19T00:39:14.637

在 2007 年的编程语言历史会议上，Simon Peyton Jones 评论说 Haskell 允许使用类型类进行元编程，但它真的是一路下跌。您可以在 Haskell 中进行 meta-meta-meta-meta 等程序，但他从未听说过有人使用超过 3 级间接。

Guy Steele 指出这在 Lisp 和 Scheme 中是一样的。您可以使用反引号和 eval 进行元编程（您可以将反引号视为 Python lambda，有点），但他从未见过使用超过 3 个反引号。

大概他们看到的代码比你或我看到的更多，所以说没有人超过 3 个元级别只是有点夸张。

如果您考虑一下，大多数人从不使用元编程，而且两个级别很难让您理解。我猜想三个几乎是不可能的，最后一个尝试四个的人最终进入了庇护所。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-08-25T01:40:18.060

自从我第一次了解 Python 中的元类时，我一直想知道“元元类可以做什么？”。这至少是 10 年前的事了——而现在，就在几个月前，我很清楚 Python 类创建中有一种机制实际上涉及“元-元”类。因此，可以尝试想象它的一些用途。

回顾 Python 中的对象实例化：每当在 Python 中通过使用与调用普通函数相同的语法“调用”其类来实例化对象时，类的`__new__`和`__init__`. 在类上“协调”调用这些方法的正是类'元类'`__call__`方法。通常在 Python 中编写元类时，元类的`__new__`or`__init__`方法是自定义的。

因此，事实证明，通过编写“元元”类，可以自定义其`__call__`方法，从而控制传递哪些参数以及元类`__new__`和`__init__`方法，以及是否要在这些之前或之后调用其他代码。最后的结果是，metcalsses 本身通常是硬编码的，即使在非常大的项目中，也只需要几个，如果有的话。因此，可能在“元元”调用中完成的任何定制通常直接在元类本身上完成。

还有它们，Python 元类还有其他不太常见的用途——可以自定义元类中的`__add__`方法，以便它们定义的类是“可添加的”，并创建一个派生类，将两个添加的类作为超类。该机制对元类也完全有效 - 因此，我们“有一些实际代码”，遵循“元元”类的示例，该类允许仅通过在类声明中添加它们来为类组成“元类” ：

```
class MM(type):
    def __add__(cls, other):
        metacls = cls.__class__
        return metacls(cls.__name__ + other.__name__, (cls, other), {})

class M1(type, metaclass=MM):
    def __new__(metacls, name, bases, namespace):
        namespace["M1"] = "here"
        print("At M1 creation")
        return super().__new__(metacls, name, bases, namespace)

class M2(type, metaclass=MM):
    def __new__(metacls, name, bases, namespace):
        namespace["M2"] = "there"
        print("At M2 creation")
        return super().__new__(metacls, name, bases, namespace) 
```

我们可以看到在交互式控制台上工作：

```
In [22]: class Base(metaclass = M1 + M2): 
    ...:     pass
    ...: 
At M1 creation
At M2 creation 
```

请注意，由于 Python 中的不同元类通常难以组合，因此通过允许将用户制作的元类与库或 stdlib 的元类组合起来，这实际上很有用，而不必将这个元类显式声明为前者的父类：

```
In [23]: import abc

In [24]: class Combined(metaclass=M1 + abc.ABCMeta):
    ...:     pass
    ...: 
At M1 creation 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-24T22:08:59.513

Smalltalk 中的班级系统是一个有趣的学习系统。在 Smalltalk 中，一切都是对象，每个对象都有一个类。这并不意味着层次结构趋于无穷。如果我没记错的话，它是这样的：

5 -> 整数 -> 整数类 -> 元类 -> 元类类 -> 元类 -> ...（它循环）

其中 '->' 表示“是一个实例”。

# c# - 安装后不需要的 MSI 外观

> ID：476588
> 
> 赞同：2
> 
> 时间：2009-01-24T20:11:09.530
> 
> 标签：c#, visual-studio-2005, installation, windows-installer, vdproj

我使用了 Windows 安装程序（msi 项目），实际上我有安装后的 msi 文件，它会向桌面抛出一个快捷方式。

我的问题是当我双击我的应用程序的快捷方式时，它会显示类似安装的内容，然后它会运行我的应用程序。我不希望安装窗口出现在我的应用程序不需要抛出任何文件或在运行之前安装某些东西的地方，所有预请求都是通过 msi 文件安装的。我希望当最终用户点击快捷方式时，它直接运行应用程序......

我希望我能很好地解释我的问题。

我正在使用 VS 2005，C# 的另一个注意事项

如果我想删除它总是发生的这个动作怎么办。每次我双击exe文件时都会出现这个窗口。我的申请并没有那么复杂。

编辑：我在哪里可以找到日志文件？！？

请帮忙。thnx indavence

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T20:20:34.300

MSI 安装系统的“*特点*”之一是它可以在你的应用程序运行时自动修复一些东西。

看到这一点的一个好方法是并排安装两个版本的 Microsoft Office。运行 MS Word 2007 后，调用 MS Word 2003 将开始，并在应用程序启动前弹出 MsiExec 以修复一些问题。

几乎可以肯定，您看到的是这种修复 - 检查日志文件并找出正在修复的内容，然后更改您的安装项目，以免在第一次安装时出现问题。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T20:40:06.867

您看到的快速安装程序操作经常是问题。我认为它只在第一次运行时出现，再也不会出现。没关系。也许 Windows Installer 服务会进行一些注册等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T01:01:54.190

您可能需要参考[Windows Installer 快捷方式的工作原理](http://support.microsoft.com/kb/243630)和[Windows Installer 日志记录](http://www.pctools.com/guides/registry/detail/1127/)

如果您真的想避免这种行为，最简单的解决方案是手动添加快捷方式，而不是让 Windows Installer 为您完成。

我的猜测是，您可能在安装程序中有一些 HKCU 密钥需要为当前用户检查/修复。您是否运行过 MSI 验证？这通常可以突出导致不必要维修的问题。

# c# - 如何从一个类型到 TryParse 方法？

> ID：476589
> 
> 赞同：8
> 
> 时间：2009-01-24T20:11:11.793
> 
> 标签：c#, parsing, types

我的特殊问题：

我有一个字符串，它指定配置类中的任意类型

`Config.numberType = "System.Foo";`

`Foo`像`Decimal`or的类型在哪里`Double`

我`Type.GetType(Config.numberType)`用来返回对应的类型。

我如何从那种类型获得能够使用，`System.Foo.TryParse()`？

**一些进一步的相关查询**

*   `TryParse()`可以从`System.Foo.TryParse()`以及访问`foo.TryParse()`。这是否意味着`foo`是 C# 中的某种类？这对我来说似乎很奇怪，`int`, `double`etc 实际上不仅仅是修饰符关键字。
*   在这种情况下如何声明变量？-`var`似乎并不普遍可用，即仅在本地范围内等。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-24T21:07:08.077

正如许多人所说 - 没有直接的路线。我希望一个关闭选项是`TypeConverter`：

```
 Type type = typeof(double);
    string text = "123.45";

    object value = TypeDescriptor.GetConverter(type)
        .ConvertFromInvariantString(text); 
```

当然，您可能需要`try`/`catch`来处理异常。这就是人生。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-24T20:20:10.200

> 我如何从那种类型获得能够使用 System.Foo.TryParse() ？

您需要使用反射进行查找，然后调用静态`TryParse()`方法。并非所有类型都实现此方法 - 因此，如果它丢失，您必须决定如何处理它。您还可以使用[`System.Convert`](http://msdn.microsoft.com/en-us/library/system.convert.aspx)将字符串转换为任意类型，假设该字符串实际上是该类型值的有效表示，*并且*为它实现了转换。

> TryParse() 可以从 System.Foo.TryParse() 以及 foo.TryParse() 访问。这是否意味着 foo 是 C# 中的某种类？

`int`, `double`, 等是 , 等的别名-[它们](https://stackoverflow.com/questions/62503/c-int-or-int32-should-i-care)是 C# 语言的一部分，没有它们会令人不舒服地冗长。`System.Int32``System.Double`

> 在这种情况下如何声明变量？

在编译时不知道类型的情况下，您将被迫将数据声明和使用为`object`/ `System.Object`。C# 4.0 将引入实际的动态类型，这些类型将为您处理一些繁琐的反射工作，但现在您只能手动完成。请注意，如果您在[具有参数化类型参数和 return的方法中](https://stackoverflow.com/questions/170665/helper-functions-for-safe-conversion-from-strings#170731)[使用`System.Convert`](https://stackoverflow.com/questions/476589/how-do-i-get-from-a-type-to-the-tryparse-method#476654)，或者使用诸如[Sebastian Sedlak 链接](https://stackoverflow.com/questions/476589/how-do-i-get-from-a-type-to-the-tryparse-method#476607)的技术，您可以轻松实现编写与静态类型一起使用的客户端代码的能力......只要它们匹配或可以从您正在解析的类型转换为。`TryParse()`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-25T14:20:09.840

已编辑：我删除了通用实现并清理了此响应以更好地适应最初陈述的问题。

注意：如果您只想要给定类型的解析值，Marc Gravell 的答案可能是最简洁的。下面的答案向您展示了如何获取方法（即 MethodInfo 对象以及如何调用它）。

以下应该有效，至少对于实现 public static bool TryParse(string, T value) 的类型：

```
public static class Parsing
{
    static MethodInfo findTryParseMethod(Type type)
    {
        //find member of type with signature 'static public bool TryParse(string, out T)'
        BindingFlags access = BindingFlags.Static | BindingFlags.Public;
        MemberInfo[] candidates = type.FindMembers(
            MemberTypes.Method,
            access,
            delegate(MemberInfo m, object o_ignored)
            {
                MethodInfo method = (MethodInfo)m;
                if (method.Name != "TryParse") return false;
                if (method.ReturnParameter.ParameterType != typeof(bool)) return false;
                ParameterInfo[] parms = method.GetParameters();
                if (parms.Length != 2) return false;
                if (parms[0].ParameterType != typeof(string)) return false;
                if (parms[1].ParameterType != type.MakeByRefType()) return false;
                if (!parms[1].IsOut) return false;

                return true;

            }, null);

        if (candidates.Length > 1)
        {
            //change this to your favorite exception or use an assertion
            throw new System.Exception(String.Format(
                "Found more than one method with signature 'public static bool TryParse(string, out {0})' in type {0}.",
                type));
        }
        if (candidates.Length == 0)
        {
            //This type does not contain a TryParse method - replace this by your error handling of choice
            throw new System.Exception(String.Format(
                "Found no method with signature 'public static bool TryParse(string, out {0})' in type {0}.",
                type));
        }
        return (MethodInfo)candidates[0];
    }

    public static bool TryParse(Type t, string s, out object val)
    {
        MethodInfo method = findTryParseMethod(t); //can also cache 'method' in a Dictionary<Type, MethodInfo> if desired
        object[] oArgs = new object[] { s, null };
        bool bRes = (bool)method.Invoke(null, oArgs);
        val = oArgs[1];
        return bRes;
    }

    //if you want to use TryParse in a generic syntax:
    public static bool TryParseGeneric<T>(string s, out T val)
    {
        object oVal;
        bool bRes = TryParse(typeof(T), s, out oVal);
        val = (T)oVal;
        return bRes;
    }
} 
```

使用以下测试代码：

```
 public bool test()
    {
        try
        {
            object oVal;
            bool b = Parsing.TryParse(typeof(int), "123", out oVal);
            if (!b) return false;
            int x = (int)oVal;
            if (x!= 123) return false;
        }
        catch (System.Exception)
        {
            return false;
        }

        try
        {
            int x;
            bool b = Parsing.TryParseGeneric<int>("123", out x);
            if (!b) return false;
            if (x != 123) return false;
        }
        catch (System.Exception)
        {
            return false;
        }

        try
        {
            object oVal;
            bool b = Parsing.TryParse(typeof(string), "123", out oVal);
            //should throw an exception (//no method String.TryParse(string s, out string val)
            return false;
        }
        catch (System.Exception)
        {
            //should throw an exception
        }

        return true;
    }
} 
```

并在您的情况下使用它：

```
 //input: string s, Config
Type tNum = Type.GetType(Config.numberType);    
object oVal;
bool ok = Parsing.TryParse(tNum, s, out oVal);
//oVal is now of type tNum and its value is properly defined if ok == true 
```

关于 var 的使用：您可能对 var 的作用有误解：它不是“变体”类型（类型对象已用于此），而是将类型的声明语法移至赋值的右侧。以下声明是等价的：

```
var i = 1;  //the compiler infers the type from the assignment, type of i is int.
int i = 1;  //type of i is int via declaration 
```

var 的主要用途是允许创建*匿名类型*：

```
var anon = new { Name = "abc", X = 123 }; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-03T11:30:57.597

另一个[很好的链接到这个问题](http://www.feedgarage.com/item.aspx?ItemID=7563)。该网站上的源代码格式非常糟糕，所以我把它放在这里。希望作者不要起诉我。

```
public static T Parse<T>(string s)
{
    Type t = typeof(T);
    // Attempt to execute the Parse method on the type if it exists. 
    MethodInfo parse = t.GetMethod("Parse", new Type[] { typeof(string) });

    if (parse != null)
    {
        try
        {
            return (T)parse.Invoke(null, new object[] { s });
        }
        catch (Exception ex)
        {
            throw ex.InnerException;
        }
    }
    else
    {
        throw new MethodAccessException(String.Format("The Parse method does not exist for type {0}.", t.Name));
    }
}

public static bool TryParse<T>(string s, out T result)
{
    return TryParse<T>(s, false, out result);
}

public static bool TryParse<T>(string s, bool throwException, out T result)
{
    result = default(T);
    Type t = typeof(T);
    T type = default(T);

    // Look for the TryParse method on the type. 
    MethodInfo tryParse = t.GetMethod("TryParse", new Type[] { typeof(string), Type.GetType(t.FullName + "&") });
    if (tryParse != null)
    {
        // Try parse exists. Call it. 
        Object[] ps = new Object[2];
        ps[0] = s;

        bool isSuccess = (bool)tryParse.Invoke(type, ps);

        if (isSuccess)
            result = (T)ps[1];

        return isSuccess;
    }
    else
    {
        // TryParse does not exist. Look for a Parse method. 
        try
        {
            result = Parse<T>(s);
            return true;
        }
        catch
        {
            if (throwException)
                throw;

            return false;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T20:23:55.590

这可能会有所帮助：[http ://theengineroom.provoke.co.nz/archive/2007/04/27/generic-tryparse-type-conversion.aspx](http://theengineroom.provoke.co.nz/archive/2007/04/27/generic-tryparse-type-conversion.aspx)

# asp.net - 为什么我不能在 Silverlight 2.0 中双击按钮来创建事件处理程序？

> ID：476591
> 
> 赞同：0
> 
> 时间：2009-01-24T20:13:06.580
> 
> 标签：asp.net, wpf, winforms, silverlight

在 WPF、ASP.NET、WinForms 中，我创建了一个按钮，双击它并填写事件处理程序。

在 Silverlight（使用 Visual Web Developer 2008）中，我制作了一个按钮，双击它但没有任何反应。

出于某种原因编写 Silverlight 应用程序时是否不支持此功能？我们必须手动编写这些事件处理程序吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-24T20:49:35.803

silverlight 设计器仅用于显示。如果你想用鼠标移动屏幕上的东西或双击添加事件，你需要使用表达式混合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T10:40:05.087

这将是下一版 Silverlight 中的一项功能，以及许多其他开发人员工具改进。不过，您可以使用 Intellisense 在 XAML 编辑器中“半自动”创建事件处理程序。

# cocoa-touch - 在模拟器中创建用于调整 UIImage 大小的 CGImageContext 失败

> ID：476597
> 
> 赞同：2
> 
> 时间：2009-01-24T20:18:18.907
> 
> 标签：cocoa-touch, ios-simulator, core-graphics

我有一些代码来调整 UIImage 的大小（在 UIImage 的类别中），它首先生成一个图像上下文：

```
CGImageRef oldImage = [self CGImage];
CGSize oldSize = [self size];

CGContextRef context = CGBitmapContextCreate(NULL, //Data
    newSize.width, //Width
    newSize.height, //Height
    CGImageGetBitsPerComponent(oldImage), // Bits per Component
    4 * newSize.width, //Bytes per Row
    CGImageGetColorSpace(oldImage), //Color Space
    CGImageGetBitmapInfo(oldImage)); //Info 
```

在设备上，此代码运行良好，但在模拟器上失败并出现以下错误：

```
<Error>: CGBitmapContextCreate: unsupported parameter combination: 8 integer bits/component; 24 bits/pixel; 3-component colorspace; kCGImageAlphaNone; 428 bytes/row. 
```

有人对此有解释吗？如果我没记错的话，它在 2.2 之前运行良好，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T22:28:23.217

我对此知之甚少，但我的猜测是您的每行字节数参数需要为 3 * newSize.width，因为图像报告没有 alpha 分量。

如果这不起作用，您可能需要查看[Quartz 2D Programming Guide 的 Supported Pixel Formats](http://developer.apple.com/iphone/library/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_context/chapter_3_section_5.html#//apple_ref/doc/uid/TP30001066-CH203-BCIBHHBB)以获取更多信息。令人沮丧的是，没有 24 bpp 的条目，即使这是错误报告的内容。您可能希望在模拟器和设备中记录相关值，以查看是否存在任何其他差异。

# .net - System.Windows.Forms.Timer 性能

> ID：476598
> 
> 赞同：1
> 
> 时间：2009-01-24T20:18:36.693
> 
> 标签：.net, winforms, timer

我们有一个应用程序，其中包含许多基于 System.Windows.Forms.Timer 频繁更新的用户控件。我可以安全地将 Timer 实例添加到每个控件的性能上吗？或者我应该有一个一直运行的单例计时器，供所有实例使用吗？幕后究竟发生了什么？每个计时器都会有一个额外的线程（用于计数）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T20:30:21.270

[`System.Windows.Forms.Timer`](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx)通过良好的 ol' [User32 Timers](http://msdn.microsoft.com/en-us/library/ms644906.aspx)实现。因此，它们不使用或不需要单独的线程进行操作。也就是说，它们是一种有限的资源，因为你不能拥有无限数量的它们。

当您说您有*很多*使用计时器的用户控件时，“很多”的真正含义是什么？10？10000？

当您说他们经常更新时，您的真正意思是什么？每一分钟？每 100 毫秒？他们的计时器可以触发多快？

对您的应用程序进行压力测试。在它开始崩溃或变得如此缓慢以至于无法使用之前，看看您可以激活多少控件。`WM_TIMER`很有可能，在您用完其他资源之前很久，您就会遇到消息内部处理的开销会影响性能的地步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T20:31:00.053

没有额外的线程。您的线程的消息队列中只有很多 WM_TIMER 消息。所以这些定时器不会并行执行它们的代码，即使它们的时间跨度重叠。

我认为有一个单独的计时器来控制每个人并没有什么坏处。至少与使用单个计时器相比，它肯定不会有任何可衡量的性能差异。不过，代码将变得更具可读性。;)

顺便说一句 - 随着今天大规模转向多个 CPU 内核，考虑一下这可能不是您可以从中受益的地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T20:43:12.167

每个控件的计时器是否在不同的时间触发？他们每个人都需要一个单独的计时器吗？

请记住，您可以将多个事件处理程序连接到一个事件，因此如果您使用计时器来执行一些简单的动画，您也许可以使用一个计时器触发多个控件的事件...

# html - xslt 中生成的标签未正确关闭

> ID：476609
> 
> 赞同：1
> 
> 时间：2009-01-24T20:25:43.793
> 
> 标签：html, xml, xslt, xhtml, w3c

我试图让`meta`and`img`标记在 xslt 的输出中关闭。

我已经调查过了，似乎我需要选择一个“xml”方法而不是“html”，但这似乎仍然不起作用。

我目前有：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:php="http://php.net/xsl">

    <xsl:output method="xml"
                omit-xml-declaration="yes"
                indent="yes"
                encoding="iso-8859-1"
                doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
                doctype-public="-//W3C//DTD XHTML 1.0 Strict//EN" />

    <!-- ... -->

    <meta name="keywords" content="{meta/data/here/text()}" />

    <!-- ... --> 
```

我在做任何明显错误的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-04T14:40:44.937

我可以使用 msxsl 复制非终止元标记。这可以通过在 xsl:stylesheet 元素上将 xmlns 设置为 XHTML 标准 (xmlns="http://www.w3.org/1999/xhtml") 来解决。我过去发现 msxsl 在 XSLT 处理方面存在许多问题。除此之外，它几乎已被弃用。

# .net - 识别 DDD 有界上下文和构建项目

> ID：476613
> 
> 赞同：1
> 
> 时间：2009-01-24T20:29:38.137
> 
> 标签：.net, asp.net, visual-studio, domain-driven-design

我试图了解领域驱动设计，我看到的例子似乎很有意义，但我仍然不确定如何将它们应用于我的具体情况。

我正在设计一个用户可以发布/编辑文章的 CMS。然后其他用户可以查看这些内容，他们也可以发表评论、添加标签等。我的问题是，在这种情况下，有界上下文是什么。您可以将用户视为“内容创建者”或“内容用户”。

就项目结构而言，我计划拥有例如 Project.Data（模型类）、Project.Services、Project.Repositories 等。这都是以数据为中心的，我是否应该通过它们所在的有界上下文来拆分它们。如果是这样，您如何处理文章等共享对象？

像往常一样，当您尝试了解新概念时，这些示例非常有意义，直到您尝试将这些想法应用于实际情况。

任何指针或有用的链接都会很棒。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T20:41:30.623

我将使用应用程序的核心创建一个共享内核，并将其他上下文引用到共享内核。我无法比 Eric Evans 在他的书中更好地解释这一点。

# asp.net - 为什么 ScriptResource.axd 的脚本包含未在某些页面上呈现？

> ID：476614
> 
> 赞同：1
> 
> 时间：2009-01-24T20:30:15.653
> 
> 标签：asp.net, asp.net-ajax

我有一个使用 Microsoft Reporting ReportViewer 的页面。该报告似乎正在运行，但该页面给了我两个 javascript 错误，它们都是“'Sys'未定义”。

检查 html 输出，我可以看到该页面没有加载 ScriptResource.axd 文件。这是 <form runat="server"> 生成的输出：

普通页面：

```
<script src="/ScriptResource.axd?d=A7zLSiYT-QHoLdLnJ4qcSxAMYrwOyrYaDQLr4063d4z_oKYldDliKqXbyFe5lSU_BLW1XY7gevJ3qbD0cmlGqFb4n7TXEUowGbFVlAH6qW01&amp;t=ffffffff81a772fc" type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
if (typeof(Sys) === 'undefined') throw new Error('ASP.NET Ajax client-side framework failed to load.');
//]]>
</script>

<script src="/ScriptResource.axd?d=A7zLSiYTQHoLdLnJ4qcSxAMYrwOyrYaDQLr4063d4z_oKYldDliKqXbyFe5lSU_pP3jafRTfoGWk6oNhALZysXq7AipBxlz6Hg1wbpmi5swSCq2gf8Ifthok9c1Qyjf0&amp;t=ffffffff81a772fc" type="text/javascript"></script>
<div>

<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION"  
  value="/wEWBwLqzd6VBwLe87a+BQLe87a+BQKMhJXjCwLDhbnwDQLDhc2YCALFibnGClZTK/SWwK6x3zLDgngtDRWbwIkm" />
</div> 
```

这里是带有reportviewer 控件的页面：

```
<script src="/Reserved.ReportViewerWebControl.axd?OpType=Resource&amp;Version=9.0.30729.1&amp;Name=Microsoft.Reporting.WebForms.Scripts.ReportViewer.js" type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
function RVClientImageToggle(shouldEnable, image1Id, image2Id)
{
var enableHover = document.getElementById(image1Id);
var disableHover = document.getElementById(image2Id);
if (enableHover == null || disableHover == null)
    return;
if (shouldEnable)
{
    enableHover.style.display = "";
    disableHover.style.display = "none";
}
else
{
    disableHover.style.display = "";
    enableHover.style.display = "none";
}
}//]]>
</script>

<div>
<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWGQLrm7KJCwLe87a+BQLe87a+BQKMhJXjCwLDhbnwDQLDhc2YCALFibnGCgL4rMvOCQL4rK/NCQKp9KnKBgKp9I3JBgKQitCjCALzoZ6fCQLzoYKeCQLC2pe+DgLC2vu8DgKsmc6MBgLYo/6MDgKsz4boDQLCqZGDBgL97pJQAv3u/vQHAv3u6pkPAv3u1r4GAv3ugpYJAOTw7r3aR/RClkJpkBgvgn/NGjI=" />
</div> 
```

在那里你可以看到——没有对 axd 文件的引用

<ScriptManager> 标签在任何一种情况下都会产生这个：

```
 <script type="text/javascript">
//<![CDATA[
Sys.WebForms.PageRequestManager._initialize('ctl00$ctl00$smManager', document.getElementById('aspnetForm'));
Sys.WebForms.PageRequestManager.getInstance()._updateControls([], [], [], 90);
//]]>
</script> 
```

这就是 javascript 错误出现的地方——引用 Sys 对象

那么是什么触发了 <form runat="server"> 的不同输出呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T15:43:25.460

我仍然没有答案，但确实在互联网上找到了解决方法：http: [//forums.asp.net/p/1318006/2617880.aspx#2617880](http://forums.asp.net/p/1318006/2617880.aspx#2617880)

如果我将报表查看器塞到用户控件中，然后只在页面上放置用户控件，则表单标签将正确呈现。

请注意，我也在使用母版页，所以可能与此有关。表单标记在母版页中，然后我在内容部分有一个带有用户控件的内容页，然后是用户控件中的 ReportViewer。这样可行。

不起作用的是带有表单标签 (runat=server) 的母版页，以及内容部分中带有 ReportViewer 的内容页。在这种情况下，没有包含任何 ASP.NET AJAX 脚本，从而导致“Sys is undefined”错误。

# c - ungetc（或来自 K&R 的 ungetch）的目的是什么？

> ID：476615
> 
> 赞同：12
> 
> 时间：2009-01-24T20:30:20.303
> 
> 标签：c, kernighan-and-ritchie, kr-c

谁能向我解释 ungetch 的目的？这来自 K&R 第 4 章，您在其中创建了一个逆波兰计算器。

我已经在没有调用 ungetch 的情况下运行了该程序，并且在我的测试中它仍然可以正常工作。

```
 int getch(void) /* get a (possibly pushed back) character */
    {
        if (bufp > 0)
        {
            return buf[--bufp];
        }
        else
        {
            return getchar();
        }
    }

    void ungetch(int c) /* push character back on input */
    {
        if (bufp >= BUFSIZE)
        {
            printf("ungetch: too many characters\n");
        }
        else
        {
            buf[bufp++] = c;
        }

} 
```

（我已经删除了 getch 中的三元运算符以使其更清晰。）

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-24T20:37:51.553

我不知道您所指的具体示例（自从我阅读 K&R 以来可能已经 23 年了，那是第一版。），但通常在解析时“窥视”下一个字符以查看是否很方便它是您当前正在解析的内容的一部分。例如，如果您正在阅读一个数字，您希望继续阅读数字，直到您找到一个非数字。Ungetc 让数字阅读器查看下一个字符而不消耗它，以便其他人可以阅读它。在 Greg Hewgill 的“2 3+”示例中，数字阅读器将阅读 3 位数字，然后阅读加号并知道数字已完成，然后取消加号以便稍后阅读。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-24T20:33:22.357

尝试在运算符周围不带空格的情况下运行程序。我不记得该示例的确切格式，并且我没有方便的 K&R，但不要使用“2 3 +”尝试“2 3+”。可能在解析数字时使用`ungetch()`，因为数字解析器将读取数字，直到它得到非数字的东西。如果非数字是空格，那么下一个`getch()`将读取`+`并且一切正常。但是，如果下一个非数字是 a `+`，则需要将其推回输入流，以便主读取循环可以再次找到它。

希望我正确地记住了这个例子。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-24T20:43:43.333

它被大量用于词法扫描器（编译器的一部分，它将你的文本分成变量名、常量、运算符等块）。该功能对扫描仪来说不是*必需*的，它非常方便。

例如，当您读取一个变量名时，您不知道何时完成，直到您读取一个不能作为变量名一部分的字符。但是你必须记住那个字符并找到一种方法将它传达给词法分析器的下一个块。你可以创建一个全局变量或其他东西，或者将它传递给调用者——但是你如何返回其他东西，比如错误代码？相反，您 ungetch() 将其放回输入流中的字符，对变量名执行任何您需要的操作并返回。然后，当词法分析器开始读取下一个块时，它不必四处寻找多余的字符。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-07-16T15:34:33.603

看看这段代码，你就会明白：

```
#include <conio.h>
#include <stdio.h>
int main()
{
    int y=0;
    char t[10];
    int u=0;
    ungetch('a');
    t[y++]=getch();
    ungetch('m');
    t[y++]=getch();
    ungetch('a');
    t[y++]=getch();
    ungetch('z');
    t[y++]=getch();
    ungetch('z');
    t[y++]=getch();
    ungetch('a');
    t[y++]=getch();
    ungetch('l');
    t[y++]=getch();
    ungetch('\0');
    t[y++]=getch();
    ungetch('\0');
    t[y++]=getch();
    ungetch('\0');
    t[y++]=getch();
    printf("%s",t);
    return 0;
} 
```

# cocoa-touch - 如何简单地为 iPhone 填充 TableView

> ID：476623
> 
> 赞同：3
> 
> 时间：2009-01-24T20:39:04.047
> 
> 标签：cocoa-touch

我有一个 UITableView。如何*简单地*用三个元素填充它，例如“e1”、“e2”、“e3”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-25T00:02:29.003

将表的 DataSource 设置为您的类并在您的类 3 方法中定义：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}

- (NSInteger)tableView:(UITableView*)tableView numberOfRowsInSection:(NSInteger)section {
    return 3;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
  static NSString *cellId = @"identifier";
  UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier: cellId];
  if (cell == nil) {
     cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:cellId] autorelease];
  }
  [cell setText:[NSString stringWithFormat:@"e%i",indexPath:[indexPath row]];
  return cell;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T03:18:25.813

UITableView 是一个奖励学习的组件。阅读有关 UITableView 及其数据源和委托协议的本地文档页面。文档中也有一个表格视图编程指南。这是一本好书。其中一些花了我一段时间来摸索，每次我实施一个方法时，我仍在改进我的方法。使用 API 并实现它所需的方法，您应该能够根据自己的意愿对其进行修改。

Hellra1ser 的示例应该将您推向正确的方向。首先查找这些方法，您将大量使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-30T05:00:46.033

***swift 3.1 中的代码：***

以防万一有人出于测试目的需要复制粘贴它。

```
extension ViewController : UITableViewDataSource, UITableViewDelegate {
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        return 50
    }
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        let cell = tableView.dequeueReusableCell(withIdentifier: "cell", for: indexPath)
        cell.textLabel?.text = "Test"
        return cell
    }
    func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -> CGFloat {
        return 60
    }
} 
```

# ruby-on-rails - 一个简单的正则表达式验证器

> ID：476630
> 
> 赞同：1
> 
> 时间：2009-01-24T20:45:48.883
> 
> 标签：ruby-on-rails, regex

我如何创建一个验证器，它具有这些简单的规则。一个表达式是有效的，如果

它必须以字母开头
它必须以字母结尾
它可以包含破折号（减号），但不能在表达式的开头或结尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T20:58:29.793

```
^[a-zA-Z]+-?[a-zA-Z]+$ 
```

例如

```
def validate(whatever)
  reg = /^[a-zA-Z]+-?[a-zA-Z]+$/
return (reg.match(whatever)) ? true : false;
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T21:04:59.140

此正则表达式匹配由一个或多个字母组成的序列，这些字母由破折号连接。

```
^[a-zA-Z]+(?:-[a-zA-Z]+)*$ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T21:05:02.747

xmammoth 几乎得到了它，有一个小问题。我的解决方案是：

```
^[a-zA-Z]+\-?[a-zA-Z]+$ 
```

请注意，原始问题指出，它**可以**包含破折号。破折号后需要问号，以确保它在正则表达式中是可选的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T21:05:29.000

```
^[A-Za-z].*[A-Za-z]$ 
```

换句话说：信，任何东西，信。

可能还想要：

```
^[A-Za-z](.*[A-Za-z])?$ 
```

以便单个字母也匹配。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T21:07:51.053

```
/^[A-Za-z]+(-?[A-Za-z]+)?$/ 
```

这似乎是你想要的。

^ = 匹配起始位置
^[A-Za-z]+ = 起始位置后跟任何至少一个或多个字母。
-？= 是否有零个或一个连字符（如果一行中可以有多个连字符，请使用“*”）。
[A-Za-z]+ = 连字符后跟一个或多个字母
(-?[A-Za-z]+)？= 对于只有一个字母的情况。
$= 匹配字符串中的结束位置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T21:08:49.493

我的意思是，能够创建标签。例如：“Wild-things”或“something-wild”或“into-the-wild”或“in-wilderness”“my-wild-world”等...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-13T01:03:37.880

好，

```
[A-Za-z].*[A-Za-z] 
```

根据你的规则，这将起作用。它将匹配任何内容：

*   以字母开头
*   以字母结尾
*   可以在两者之间包含一个破折号（在其他所有内容中）。

# java - 向应用程序添加脚本安全性

> ID：476640
> 
> 赞同：3
> 
> 时间：2009-01-24T20:59:30.480
> 
> 标签：java, security, architecture, groovy, scripting

假设我有一个用 Java 编写的现有应用程序，我希望添加脚本支持。这对于 Groovy 来说是相当微不足道的（在 .Net 中对于任何 Iron 系列动态语言来说都是微不足道的）。

与添加支持一样微不足道，它引发了一系列关于脚本执行和安全性以及如何实现该安全性的问题。

有没有人遇到过任何有趣的文章/论文或有任何他们想分享的见解？特别是我会对诸如执行上下文、脚本身份验证、脚本签名等架构方面的东西非常感兴趣......你知道，那种阻止用户运行他们刚刚下载的任意脚本的东西搞砸了他们的整个应用程序，同时仍然允许脚本有用和灵活。

**快速编辑**

我提到签名和身份验证是不同的实体，因为我将它们视为安全的不同方面。

例如，作为应用程序的开发人员/供应商，我分发了一个签名脚本。该脚本在设计上具有合法的“数据破坏性”。就其本质而言，它只能由管理员运行，因此绝大多数用户/系统进程不应该能够运行它。在这种情况下，在我看来，根据脚本执行的操作和运行该脚本的人，需要某种安全/身份验证上下文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T21:18:29.397

> 脚本签名

从概念上讲，这只是进入您的加密工具箱并使用现有的工具。让人们签署他们的代码，在下载时验证签名，并检查签名的发起者是否受信任。

困难的（呃）问题是什么使人们值得信任，以及谁可以选择它。除非您的用户是技术人员，否则他们不想考虑这一点，因此他们不会制定好的政策。另一方面，你可能*不得不*让用户引入信任[除非你想去一个 iPhone AppStore 风格的围墙花园，这听起来不像]。

> 脚本认证

这和签约有什么区别？或者，您的问题仅仅是：“我应该在这里考虑哪些概念”？

真正的问题当然是：您希望您的用户受到什么保护？它只是在途修改，还是您还想对脚本的行为做出保证？一些示例可能是：脚本无法访问文件系统，脚本只能访问文件系统的特定子树，脚本无法访问网络等。

我认为如果脚本是在 haskell 中完成并且 IO monad 被分解成更小的部分，我认为 [通过少量工作] 可以提供一些关于脚本如何访问外部世界的保证。或者，如果您让脚本在它们自己的不透明 monad 中运行，并且可以访问 IO 的有限部分，则可能。请务必删除对不安全功能的访问。

您可能还想查看 Java（小程序）安全模型中的注意事项。

我希望这能给你一些思考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T17:09:39.730

您可以查看有关安全性的文档：http: [//groovy.codehaus.org/Security](http://groovy.codehaus.org/Security) 基本上，您可以使用通常的 Java 安全管理器。

除此之外，还有一个示例应用程序展示了如何通过在编译时分析其 AST（抽象语法树）来内省代码，以便您可以允许/禁止某些代码构造等。这是一个算术 shell 示例这在行动： [http ://svn.groovy.codehaus.org/browse/groovy/trunk/groovy/groovy-core/src/examples/groovyShell](http://svn.groovy.codehaus.org/browse/groovy/trunk/groovy/groovy-core/src/examples/groovyShell)

# c++ - 混合语言编程、VB 和 C++、理解 API 和指针

> ID：476647
> 
> 赞同：2
> 
> 时间：2009-01-24T21:04:01.467
> 
> 标签：c++, vb.net, mixed

我的问题是理解混合语言编程和访问外部库中的 API 的更好点。我在 C++ 方面的技能不存在，而在 VB 方面则平庸。

我编译了一个 c++ dll（portaudio 库），并试图从 VB（Visual Studio 2005）访问它。我在调用函数时遇到 MarshallDirectiveException 错误，我相信是因为我与 dll 交互不正确。

* * *

C++ 函数和结构定义如下：

标题信息：

```
typedef int PaHostApiIndex;
...
typedef double PaTime;
...
typedef struct PaDeviceInfo
 {
     int structVersion;  /* this is struct version 2 */
     const char *name;
     PaHostApiIndex hostApi; /* note this is a host API index, not a type id*/
     int maxInputChannels;
     int maxOutputChannels;
     PaTime defaultLowInputLatency;
     PaTime defaultLowOutputLatency;
     PaTime defaultHighInputLatency;
     PaTime defaultHighOutputLatency;
     double defaultSampleRate;
 } PaDeviceInfo;
 ...
 const PaDeviceInfo* Pa_GetDeviceInfo( PaDeviceIndex device ); 
```

文档中的程序用法：

```
const PaDeviceInfo* Pa_GetDeviceInfo    (   PaDeviceIndex   device   ) 
```

检索指向包含指定设备信息的 PaDeviceInfo 结构的指针。

返回： 指向不可变 PaDeviceInfo 结构的指针。如果设备参数超出范围，则函数返回 NULL。

参数：设备 0 到 (Pa_GetDeviceCount()-1) 范围内的有效设备索引

* * *

在VB程序中，我有：

```
Private Declare Function Pa_GetDeviceInfo Lib "portaudio_x86.dll" (ByVal dindex As Integer) As PaDeviceInfo
...
Private Structure PaDeviceInfo
        Dim structVersion As Integer
        <MarshalAs(Runtime.InteropServices.UnmanagedType.LPStr)> Dim name As String
        Dim hostapi As Integer
        Dim maxInputChannels As Integer
        Dim maxOutputChannels As Integer
        Dim defaultLowInputLatency As Double
        Dim defaultLowOutputLatency As Double
        Dim defaultHighInputLatency As Double
        Dim defaultHighOutputLatency As Double
        Dim defaultSampleRate As Double
End Structure
...
        Dim di As New PaDeviceInfo
        di = Pa_GetDeviceInfo(outputParameters.device) 
```

这感觉是错误的，因为文档状态 Pa_GetDeviceInfo 返回一个指向包含结构信息的结构的指针，这意味着函数最初创建了结构。

我对混合语言编程完全陌生，完全是 C++ 菜鸟，也是一个糟糕的 VB 程序员。谁能指导我以正确的方式解决这个问题？我的感觉是我需要了解如何让 VB 引用在 dll 中创建的内存中的结构，所以我需要让 vb 将“指向事物的指针”理解为函数返回。

非常感谢提供的任何帮助。请不要只说 rtfm，我现在在 FM 中取决于我的眼睛，我只是不知道在哪里看。

非常感谢，大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T22:42:01.130

您的 API 函数声明错误。该函数返回一个未反映在您的代码中的指针。签名转换为 VB 如下：

```
Private Declare Function Pa_GetDeviceInfo Lib "portaudio_x86.dll" ( _
    ByVal dindex As Integer _
) As IntPtr 
```

当然，`IntPtr`直接使用 an 并不容易。事实上，[涉及到](http://msdn.microsoft.com/en-us/library/4ca6d5z7.aspx)相当多的编组：

```
Dim obj As PaDeviceInfo = _
    DirectCast(Marshal.PtrToStructure(ptr, GetType(PaDeviceInfo)), PaDeviceInfo) 
```

（或多或少重要）旁注：由于您的 DLL 显然在内存中创建了一个新对象，因此它还需要释放/销毁它。请务必在使用该结构后调用相应的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T22:58:59.630

是的，你的结构是错误的。您确实必须获得一个指针，然后读取它“指向”的内存。

我之前在 C++ 中完成了外部 DLL 调用，它通常涉及大量文档。我认为这里没有人会为您这样做，但我会尽力为您指明正确的方向。

首先，指针是一个地址，一个“指向”内存中某个位置的值。“取消引用”指针正在读取指针指向的内存（如果您读取或写入错误的内存，内存可能会变得不安并杀死您的程序）。

此外，在底层，调用 DLL 涉及将信息位复制到堆栈，然后让函数检索它们。“调用约定”准确描述了这是如何完成的——有“c”、pascal 和其他此类约定。

您将需要调用 DLL 的函数，获取一个指针，将指向的信息复制到您的本地结构中，然后继续。困难的事情将是弄清楚如何声明 DLL 函数。如果您的库文档有一些示例代码，那可能是开始的地方。

一个简短的 Google 甚至根本没有显示任何一致的方式来处理 VB 中的指针。一个想法是创建一个简短的 C++ 程序，该程序将调用 DLL 并按值返回一个对象。我不知道这是否会有所帮助，但是在处理外部库时会出现这样的问题。

祝你好运

# python - Cygwin 和 Python 2.6

> ID：476659
> 
> 赞同：2
> 
> 时间：2009-01-24T21:09:26.323
> 
> 标签：python, windows-xp, cygwin, python-2.6

python（和编程）的新手。我到底需要 Cygwin 提供什么？我在winxp上运行python 2.6。我可以安全地下载完整的 Cygwin 吗？它看起来就像一大堆东西。

好吧，我不断遇到建议下载各种 cygwin 组件的模块和功能（即管道输出）。cygwin 会改变或修改任何其他操作系统功能或有任何其他副作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T21:16:23.097

有不需要 cygwin 的 python 构建。例如（来自 python.org）：

[链接文本](http://www.python.org/download/releases/)

此外，还有一个名为 Iron Python 的 .NET 版本：

[链接文本](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T22:42:08.663

cygwin 实际上是一个 Unix 子内核。以默认方式设置和安装它不会中断或更改任何现有的 Windows XP 功能。但是，您必须先启动与命令提示符等效的 cygwin，然后才能使用它的功能。

话虽如此，您正在谈论的某些功能在 Windows 中可用。管道绝对是。例如：

网络统计-ano | 发现str：1433

是我用来确保我的 SQL Server 正在侦听默认端口的命令行。netstat 的输出正在通过管道传输到 findstr，因此我只需要查看包含：1433 的任何行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T08:47:26.833

我想说最简单的选择是尝试 Linux Distro。我知道您的新 Linux 是否令人生畏，但是当我看到 Ubuntu 并开始在那里开发时，我的生活发生了变化。Ubuntu 很臃肿（对于 linux），但是它附带了我希望基于 Microsoft 的操作系统预先打包的东西。由有创造力的人为有创造力的人编写的无限量的免费软件是一个奇迹。开源社区非常适合参与学习和体验。我可以保证，在 Linux 上使用任何语言（除了 myabe ...... 一个是 windows 路径，确保您仍然可以创建将移植到 windows 的可移植 Python 应用程序，它只需要另外几行替换字符并转义它们。

我发现 Ubuntu 很好地平衡了一般可用性和开发。

股票发行版：Python 2.7 Perl XTerm MP3 播放器，可杀死 WMP 和 Winamp =+ V.3.0 电子邮件 w/Thunderbird（很像 Fire Fox 浏览器制造商的 Outlook Express，带有附加组件和扩展） Empathy（Internet 聊天客户端AIM、ICQ、FACEBOOK、MySpace 等。它还将您的所有联系人保存在一个列表中，并且所有帐户的操作就像 AIM 一样） Gwibber（社交网络应用程序，可将您在 Twitter 和 Facebook 墙上发布的帖子编译成一个漂亮的桌面小部件，还允许您直接从应用程序回复和评论。）

多桌面支持：您可以通过按热键更改“桌面视图”。每个桌面只有你想要的窗口。因此，您可以创建工作空间、聊天空间、网页浏览空间并在它们之间快速切换。您还可以根据需要在工作空间之间快速移动窗口。

全局热键映射器：在您的管理选项中，您有一个操作系统范围的热键映射。您只需通过默认界面分配热键即可启动程序和许多其他任务。

Bash、Terminal、Shell、XTerm：这些 CLI（命令行界面）提供的功能比通常在 Windows 中找到的要多得多。是的，您可以在 Windows 中通过管道输出，但这不是它的目的。这些 CLI 允许您创建可以接受用户输入并执行通常必须手动完成的复杂任务的脚本。BASH 本身在某种程度上是一种编程语言。允许分配函数、变量、if 语句等。

我很惊讶 Ubuntu 不仅运行良好并且准备好处理开发人员，而且对您的祖父母也非常友好。它提供了您开箱即用所需的一切（对于普通用户而不是开发人员），开发人员只需要几次安装。记住，你也在使用开源软件。因此，您将要处理错误，并且您可能会等待一段时间在 Windows 中解决问题。如果曾经。

此外，Ubuntu 可以从 CD 启动，您只需这样做即可查看主界面。您还可以通过屏幕询问您在 POST 启动后启动哪个分区/磁盘来双重启动它。还有一个关于从拇指驱动器上运行它的教程。

Linux 和计算机的速度：与 Windows 7 相比，Linux 非常轻巧。被认为是 MID 级计算机，例如 AMD Phenom 955 Black Edition x4，它将像高级计算机一样运行。1 gib 的内存在 Linux 中比在 Windows 中走得更远。

尝试 Linux 发行版的最佳方法如下。您不必在系统上安装它。如果你喜欢它，你可以将它与虚拟环境一起沙箱化，并且想要独立运行它的速度和开销改进，也许首先考虑双启动，然后是“更改”。

下载您选择的 Linux Dist ISO。对于新用户来说，Ubuntu、Mint 很简单。Debian的东西。主要是因为易于使用一个好的包管理器。下载[Oracle Virtual Box](https://www.virtualbox.org/ "甲骨文虚拟盒子")。按照说明，创建一个新的虚拟磁盘，然后使用放置在 DVD 驱动器或虚拟 DVD 驱动器中的安装媒体启动虚拟磁盘，并像普通操作系统一样安装。

根据我的经验，除非您必须一直使用 Windows，否则没有理由不尝试 Linux Distro。请小心，因为 ArchLinux 或 SlackWare 之类的东西可能会立即吓跑你；像 Ubuntu、Mint 和其他发行版一样已经内置了 GUI。Linux 有很多种。它比 Windows 更松散耦合，例如您可以使用任何您想要的桌面环境。Linux 只是一个内核。发行版是维护发行版的团队认为适合其总体目标和目的的工具的集合。桌面环境、编程工具、包管理器和其他免费许可的软件。

# .net - Linq To Sql 多对多连接表

> ID：476663
> 
> 赞同：10
> 
> 时间：2009-01-24T21:13:28.267
> 
> 标签：.net, asp.net-mvc, linq-to-sql, join, many-to-many

我是一位经验丰富的 Rails 开发人员，我想我会尝试 ASP.NET 的 MVC 版本。在这样做时，我还决定尝试 Linq->Sql...

我对 Linq->Sql 处理连接的方式有点困惑。

我的架构的一个简单示例是：

**书籍**：
id
标题

**类别**:
id
名称

**book_categories** :
book_id
category_id

简单地将这些表拖到 .dbml 文件似乎并没有做到这一点。我在我的 Book 类 book_categories 上获得了一个属性，我期望的是一个可以迭代并直接获取 Category 类的属性。

现在我必须做一些感觉非常错误的事情

```
 foreach (books_categories bc in book.books_categories)
        {
            category_names.Add(bc.Category.category.Trim());
        } 
```

**[回应接受**
的答案]我勉强接受了“编写自己的胶水代码”的答案。在继续我对 Linq->Sql 的研究之后，我发现它显然正在慢慢被放开，以支持（更强大的 IMO）实体框架。EF 仍然允许人们使用 LINQ 进行查询，并且像 Ruby 的 ActiveRecord 一样可以很好地确定关系。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T21:30:26.860

为 Book 使用部分类实现，并为类别及其属性添加适当的方法。将属性置于 Books_Categories 属性的前端（您可以使其具有私有可见性以通过您的 Categories 属性强制实施）。

```
public partial class Books
{
    public IEnumerable<string> CategoryNames
    {
       get
       {  
            return this.Books_Categories
                       .Select( bc => bc.Category.category.Trim() );
       }
    }

    public void AddCategory( Category category )
    {
       this.Books_Categories.Add( new Book_Category
                                  {
                                      Category = category,
                                      Book = this
                                  } );
    }

    public void RemoveCategory( Category category )
    {
       var bc = this.Book_Categories
                    .Where( c => c.Category == category )
                    .SingleOrDefault();
       this.Books_Categories.Remove( bc );
    }
} 
```

显然，您需要添加一些错误/边界检查等，但您明白了。

我承认这并不理想，但至少你可以灵活地确定它是如何工作的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T15:49:18.910

实体框架明确支持多对多映射，但 LINQ to SQL 不支持。您还可以使用第三方 ORM，例如 NHibernate。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T21:19:14.807

我认为 Linq to Sql 不支持您的预期结果。

您正在做的事情可能感觉不对，但我认为这是解决 L2S 限制的一种方法。

伙计，我真的必须进入 Rails ......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T11:01:27.220

如果您想创建一本书并直接向其中添加类别，您可以做的是：在您看来：

```
 <p>
            <label for="CategorySelect">Category:</label>
            <%= Html.ListBox("CategorySelect") %>
            <%= Html.ValidationMessage("CategorySelect", "*")%>
        </p> 
```

在您的书籍控制器中：

```
 public ActionResult New()
    {
            var data = _entities.Categories.ToList();
        ViewData["CategorySelect"] = new MultiSelectList(data, "Id", "Name");
}

        [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult New([Bind(Exclude = "Id")] Book Booknew)
    {
        IEnumerable<int> selectedCategories = Request["CategorySelect"].Split(new Char[] { ',' }).Select(idStr => int.Parse(idStr));

        if (!ModelState.IsValid)
            return View();

        try {
            foreach(var item in selectedCategories){
                BooksCategories bc = new BooksCategories();
                bc.Book = Booknew;
                bc.CategoryId = item;
                _entities.BooksCategories.InsertOnSubmit(bc);
            }
            _entities.Books.InsertOnSubmit(Booknew);
            _entities.SubmitChanges(); 
```

# python - 针对 Python Web 开发的 TDD 资源

> ID：476668
> 
> 赞同：15
> 
> 时间：2009-01-24T21:19:07.647
> 
> 标签：python, tdd, testing

我不是黑客，也不是全职程序员，但我希望开始自己的完整应用程序开发实验。如果我在这里遗漏了一些简单的东西，我深表歉意。我正在寻找有关书籍、文章、网站等的建议，以了解更多关于专门兼容或针对 Python Web 应用程序编程的测试驱动开发。我知道 Python 有内置的工具来提供帮助。在 RTFM 之外了解这些的最佳方式是什么？我在 StackOverflow 上进行了搜索，找到了 Kent Beck 和 David Astels 的关于该主题的书。我还为 Wikipedia 文章添加了书签，因为它包含许多此类资源。

对于这种语言/应用程序，您有什么特别推荐的吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-24T23:08:13.887

[我在 Django](http://blog.cerris.com/category/django-tdd/)中写了一系列关于 TDD 的博客，其中涵盖了一些带有[鼻子测试框架](http://somethingaboutorange.com/mrl/projects/nose/)的 TDD 。

有很多免费的在线资源可以用来学习 TDD：

*   [c2 wiki 文章](http://c2.com/cgi-bin/wiki?TestDrivenDevelopment)提供了一般 TDD 哲学的良好背景。
*   [onlamp 文章](http://www.onlamp.com/pub/a/python/2004/12/02/tdd_pyunit.html)是一个简单的介绍。
*   这是一个关于[pygame](http://powertwenty.com/kpd/blog/index.php/python/test_driven_development_in_python)中游戏开发的 TDD 演示文稿，它真正帮助我理解了 TDD。

对于测试 Web 应用程序，首先测试或其他方式，我建议使用[twill](http://twill.idyll.org/)和[selenium](http://seleniumhq.org/)作为工具。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-18T07:50:46.073

我可以插入我自己的教程，它涵盖了官方 Django 教程中的材料，但一直使用完整的 TDD - 包括使用 Selenium 浏览器自动化工具的“正确”功能/验收测试...... [http://tdd-django -tutorial.com](http://tdd-django-tutorial.com)

[2014-01 更新] 我现在有一本书，即将由 OReilly 出版，它涵盖了教程中的所有内容等等。[完整内容可在http://www.obeythetestinggoat.com](http://www.obeythetestinggoat.com)在线（免费）获得

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T21:32:14.500

我知道 Kent Beck 的书（您提到过）涵盖了 Python 中的 TDD 相当深入。如果我没记错的话，本书的后半部分将带您完成 Python 单元测试框架的开发。但是，没有什么特定于 Web 开发的，这是我读过的许多 TDD 资源中的一个问题。将业务逻辑与演示文稿分开是一种最佳实践，以使您的 BL 更具可测试性，以及其他原因。

您可能想要查看的另一本好书是[xUnit Test Patterns](https://rads.stackoverflow.com/amzn/click/com/0131495054)。它不使用 Python，但它确实谈论了很多关于可测试性设计、如何使用模拟和存根（测试 Web 应用程序需要它们）以及自动化测试的内容。它比贝克的书更先进，这使它成为一个很好的后续。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-24T21:32:16.233

我推荐 Gerard Meszaros 的“xUnit 测试模式：重构测试代码”。它不是 Python 或 Web 特定的，但它是一本关于 TDD 的好书，特别是 xUnit 框架。由于 python unittest 实际上是一个 xUnit 实现（“JUnit 的 Python 版本”，正如文档所说），我想说这本书对 Python 单元测试人员非常有用。

[它在xunitpatterns.com](http://xunitpatterns.com/)上有一个在线版本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-16T11:07:36.017

[这](http://blog.fruiapps.com/tag/test-driven-development)是一篇关于 Python 测试驱动开发的精彩系列文章。它从基础开始，一直到一个点，在那里你会学到一些东西，比如可维护性设计等。我相信你会喜欢的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-18T09:46:22.583

一个非常好的单元测试框架也是从twisted项目中[试用的。](http://twistedmatrix.com/trac/wiki/TwistedTrial)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-07-31T03:22:50.057

这个游戏有点晚了，但我一直在寻找一本面向 Python 的 TDD 书，我刚刚找到[了 Daniel Arbuckle 的 Python 测试：初学者指南](https://rads.stackoverflow.com/amzn/click/com/1847198848)。还没有机会阅读它，但是当我阅读时，我会尽量记住在此处发布后续内容。亚马逊页面上的评论看起来相当积极。

# .net - 用户在采用 Silverlight 时是否有问题？

> ID：476671
> 
> 赞同：9
> 
> 时间：2009-01-24T21:21:35.317
> 
> 标签：.net, silverlight, user-interface

由于几个原因，我的团队正在考虑将我们的 Web UI 平台从 ASP.net 切换到 Silverlight。需要明确的是，这些是为我们的用户提供服务的商业网站，我们自己开发和托管它们。

是否有人将他们的企业/内联网网站从传统的基于服务器的 Web 技术（如 ASP.net）切换到 Silverlight？或者您是否已将 Silverlight 添加到您的网站？如果是这样的话...

*   您的用户是否抱怨或拒绝安装 Silverlight？
*   是否有大量用户无法安装 Silverlight？
*   他们是否评论过 Silverlight UI 的外观或响应能力？
*   他们还有什么其他意见？

**简而言之，如果我开始在我的页面上使用 Silverlight，我的网站的用户会吓坏吗？**
如果您的答案是“视情况而定”，那么请说明决定因素是什么。

顺便说一句，是否有一种简单的方法可以检测您有多少用户安装/已经安装了 Silverlight？

**编辑：**
感谢到目前为止的答案！我可能会达到，但有没有人有部署 Silverlight 应用程序的具体经验？我想知道是否有人经历过这个，他们的用户是否有任何重大问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-24T21:32:10.273

如果您计划让您的网站仅供使用 Silverlight 的用户使用，那么您将限制该网站的潜在使用。

虽然了解 IT 的人很可能听说过 Silverlight 并安装了它，但许多用户可能根本没有，并且要求他们下载它以便能够查看您的网站很可能会让他们望而却步。

也就是说，如果您的用户不是临时用户，而是经常访问的用户、社区的一部分或只是普通用户必须使用您的网站，那么他们将更倾向于安装 Silverlight。

Flash 在当今网络上变得如此普遍的唯一原因是有足够多的人拥有或将下载客户端，主要是为了能够玩基于 Flash 的游戏！一旦/如果 Silverlight 达到这一点，那么这将不再是一个问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-25T09:30:35.657

作为用户我自己说：

我还没有安装 Silverlight，如果某个站点需要它，我可能会重新考虑我是否真的需要首先访问该站点。作为一个用户，我看不到 Flash 或普通 AJAX 的需要或好处。它没有被广泛使用，所以我只会为 1 或 2 个站点安装它。从用户的角度来看，它并没有做任何新的事情。是的，它运行 .NET，但作为用户，我不在乎。首先，我不是 Flash 的忠实粉丝。对于网站，到目前为止，我更喜欢简单的网站。Javascript 很好，AJAX 很好，Flash 很痛苦，微软的 Flash 克隆也好不到哪里去。不同之处在于无论如何我都需要 Flash 用于其他目的，因为它用于网络上的大量内容。Silverlight 并不那么普遍。

我永远不会为单个网站安装 Flash，也永远不会为单个网站安装 Silverlight。

网站比 Flash/Silverlight 应用程序更易于浏览。它们也可以在任何浏览器中工作，无需特殊插件。随着今天 AJAX 的普及，您可以做很多几年前只能在 Flash 或 Java 小程序中完成的事情。在这方面，Silverlight 似乎迟到了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-25T00:21:36.890

我不确定“商业网络 UI 平台”是指您自己的网站还是您正在销售的某些网络应用程序。

*   如果您指的是您自己的网站，我同意 Samuel 的观点，即您目前将限制您的用户群，因为尚未安装 Silverlight 的“普通用户”不多。
*   如果您谈论的是您正在销售的软件，我认为最重要的事实是您的客户是否会发现与购买他们自己的应用程序相比，他们必须推出软件（Silverlight 框架）是否存在问题。只需要安装在服务器上。我们在我的公司也有过这样的讨论（是否从客户端上有大量 JavaScript 代码的 ASP.net 切换到 Silverlight 或 Flex），但我们没有这样做，因为我们认为客户不会喜欢这种额外的部署工作. 此外，由于公司政策，不允许用户（例如在银行、保险公司等工作）安装浏览器插件，因此当需要 Silverlight 时，您将更难向此类客户销售。

编辑：实际上，从工作场所上网的用户通常不允许安装浏览器插件这一事实适用于这两种情况。似乎越来越多的雇主制定了严格的政策，用户只能使用预装或“白名单”上的软件，并且没有足够的操作系统权限来自行安装任何东西。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-25T10:23:24.897

Netflix 使用 Silverlight 作为其网站播放器，该播放器适用于 Windows 和 MacOS X。每个想要在其计算机上使用 Netflix 流媒体服务的用户都需要使用该播放器，而且奥运会的每个视频都可以通过使用 Silverlight 2 的 NBC 网站获得. 这可能会帮助您找出与安装了插件的用户相关的一些数字。

此外，如果您需要功能示例，则所有来自 ASP .NET 的视频都在 Silverlight 上运行。SDK 与visual studio 和free 集成，还有服务器端控制器，使用XAML 可以编辑和自定义其行为和外观。

是一项新技术，会有怀疑，但最终会迎头赶上，用户/程序员将不再使用它；）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-24T22:18:56.137

我还要说，如果您的目标是所有人都可以使用的东西，无论他们使用什么操作系统。Silverlight 可能不是目前要走的路。

如果你真的想要一些互动的东西，我会选择灵活的方式。由于 Flash 在大多数平台上都可以免费使用。Mac/Linux/Windows 和移动设备。

而且因为我并不真正重视闪光灯/银光。

我想说用 Ajax 和 javascript 效果（原型、jQuery 或我不知道的任何其他 javascript 库）做一些事情。它应该减少用户的加载时间。

完全切换到闪光灯或silverlight可能是一个糟糕的主意......至于我，闪光灯总是让我的Firefox不稳定......内存泄漏和类似的事情。至于silverlight，我的操作系统不支持它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-24T16:45:15.903

每个 .NET 开发人员，尤其是 ASP/WFP(XBAP) 编码人员都是 Silverlight 的主要受益者，他们可以通过使用您熟悉的 C# 或 VB 或其他 .NET 语言选择，只需很少的学习曲线就可以为他们的用户带来丰富的 Internet 体验语言。.NET 开发人员现在可以轻而易举地创建 RIA，而无需学习新的脚本语言；))。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-24T17:06:25.847

将现有网站更改为 Silverlight 时可能需要考虑的其他事项

*   您希望将尽可能多的内容保留为搜索引擎排名的纯文本（如果它是公共网站）
*   如果用户在其浏览器中禁用了 JavaScript，它将无法加载嵌入的 Silverlight 内容

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-11T23:25:16.057

不，作为用户，我不会发疯，但它使我无法使用这些网站...原因..我们现在进入第 4 版，我既不能安装当前版本，也不能卸载文件微软告诉我，为了更新。已经尝试了几次，现在已经浪费了足够的时间，所以如果他们需要 Silverlight 来操作，我不需要在那个站点上。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-25T08:26:40.187

一位高级开发人员向我指出，将 Silverlight 用于公共网站的一个问题是它会完全破坏导航（即使用后退按钮）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-28T09:18:54.480

为什么不看看 Visual WebGui@www.visualwebgui.com。这样，您此时不必选择表示层，而是专注于开发当前支持多浏览器 DHTML（无需安装）或 Silverlight 的通用应用程序......并且他们计划实现您将要实现的 flash/flex能够使用相同的源代码……那有多酷？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-08-05T17:05:35.500

为了解决 Element 关于它破坏后退按钮的答案，Silverlight 3 已经发布并内置了一个导航框架，它允许每个“页面”有一个单独的 url 并维护浏览器历史记录，以便后退按钮起作用。

# c# - 使用 .NET 编译器针对 ARM 架构

> ID：476676
> 
> 赞同：3
> 
> 时间：2009-01-24T21:24:59.227
> 
> 标签：c#, .net, visual-studio, windows-mobile, compiler-construction

当您在 .NET 中编译 Windows 应用程序时，您可以将“平台目标”设置为 x86 或 x64。这会将您的代码优化为处理器的特定架构并允许逃逸 IL。有谁知道是否有什么东西可以让 Windows Mobile 应用程序达到相同的结果？我只对在 ARM 架构上运行我的应用程序感兴趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-24T21:44:01.420

我不相信指定平台目标*确实会*为给定架构优化生成的 IL。相反，它说，“我只在指定的架构上运行，因为我包含特定于该架构的 P/Invoke 调用。” 至少，这是我对它的理解。这意味着在 x64 机器上运行时，可执行文件可以在 32 位版本的 CLR 下运行以实现兼容性。

这如何适应紧凑的框架（我认为这是您的实际平台？）我不确定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T22:05:43.513

使用[Mono](http://go-mono.com/)的[Ahead-of-Time](http://www.mono-project.com/AOT) (AOT) 编译。这就是他们如何将[UNITY](http://unity3d.com/)脚本安装到作为 ARM 平台的 iPhone 上。在 Windows Mobile 上启动和运行它可能需要一些劳动，因为，afaik，还没有人完成那个特定的平台端口，但是编译器等应该已经在那里了。

[您可以在此处](http://channel9.msdn.com/pdc2008/PC54/)查看 Miguel de Icaza 在 MS PDC 上的介绍。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T22:07:56.083

x86 或 x64 不会优化 IL - 这是在已部署机器上运行的 JITter 的工作。x86 或 x64 只是[标记位标志](http://blogs.msdn.com/gauravseth/archive/2006/03/07/545104.aspx)。

当然，在桌面框架中，您可以将您的 MSIL NGEN 到特定的 CPU - 但是 IIRC，缺少本机映像只会恢复为 JIT 编译。不过，除此之外，我认为 NGEN 无论如何都不适用于 .NET CF。

我不确定您*为什么*需要限制为 ARM 处理器，但是对[GetSystemInfo](http://msdn.microsoft.com/en-us/library/ms960847.aspx)的 P/Invoke将返回一个[SYSTEM_INFO](http://msdn.microsoft.com/en-us/library/ms942639.aspx)结构，其中包含处理器类型。这可能会阻止您的应用程序继续在 !ARM 上运行，但不会真正运行。

编辑：重新阅读这个问题，我注意到除了他的 C# 和 .NET 标签之外，没有任何迹象表明您只想要一个托管解决方案。如果您愿意不受管理，您显然可以编译到 ARM。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-24T22:20:45.883

如果您想在基于 Windows Mobile 的设备上创建基于 ARM 的应用程序，请安装 .NET Compact Framework。为此，您将在 VS 中拥有一个新的“智能设备”项目类型。

我不知道是否有任何其他 ARM 平台 WM 的 JIT，还有 .NET Micro Framework 但我无法告诉您任何相关信息，也许这会解决您的问题？

# java - JTabbedPane 中具有相等（恒定）宽度的选项卡

> ID：476678
> 
> 赞同：1
> 
> 时间：2009-01-24T21:25:25.683
> 
> 标签：java, swing, jtabbedpane

我试图让`JTabbedPane`所有选项卡（实际选项卡，而不是组件）具有相同的宽度（最宽标签所需的最小宽度或恒定宽度）。

我试图覆盖`BasicTabbedPaneUI.getTabBounds(int tabIndex, Rectangle dest)`，但显然 的绘画方法并未使用此方法`BasicTabbedPaneUI`，而是使用 rects 数组来确定选项卡大小。

我的下一个方法是覆盖`JTabbedPane.insertTab(String title, Icon icon, Component component, String tip, int index)`并设置标签组件的首选大小，但这似乎不是很优雅，我什至不确定它是否会起作用。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-30T09:19:18.487

答案很简单。当我们为选项卡命名时，只需使用 html 格式化名称。说

tp - JTabbedPane 对象

```
tp.addTab("<html><body><table width='150'>Name</table></body></html>",Componentobject) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-24T22:17:34.237

我认为它没有你做的那么复杂。只需将 setTabComponentAt() 与您设置了首选大小的 JLabel 一起使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-13T07:59:28.457

我尝试了以下方法：

```
tabPane.setUI(new javax.swing.plaf.metal.MetalTabbedPaneUI() {
    @Override
    protected int calculateTabHeight(int tabPlacement, int tabIndex, int fontHeight) {
        return super.calculateTabHeight(tabPlacement, tabIndex, fontHeight) + 12;
    }
}); 
```

这对我来说似乎很好。但是，如果您使用不同的 L&F，无论如何您最终都会使用“金属”来渲染它。

我想你可以得到默认的 UI 并在它上面做一个“instanceof”来确定哪个正在被使用并相应地实例化它。

例如：

```
TabbedPaneUI ui = tabPane.getUI();

if (ui instanceof WindowsTabbedPaneUI) {
    // Create the windows rendition
} else if (ui instanceof MetalTabbedPaneUI) {
    // Create the metal rendition
} else if (ui instanceof MotifTabbedPaneUI) {
    // Create the motif rendition
} else if (ui instanceof SynthTabbedPaneUI) {
    // Etc...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-03T02:03:14.880

这对我有用。

```
 JLabel lab = new JLabel();
        lab.setPreferredSize(new Dimension(200, 30));
        jTabbedPane1.setTabComponentAt(0, lab);  // tab index, jLabel 
```

或尝试对相同大小的所有选项卡组件进行此更改（在 main 方法中调用）

`UIManager.getLookAndFeelDefaults().put("TabbedPane:TabbedPaneTab.contentMargins", new Insets(10, 100, 0, 0));`

# javascript - 使用 jQuery 预加载图像

> ID：476679
> 
> 赞同：696
> 
> 时间：2009-01-24T21:25:54.747
> 
> 标签：javascript, jquery

我正在寻找一种使用 JavaScript 预加载图像的快速简便的方法。如果这很重要，我正在使用 jQuery。

我在这里看到了这个（[http://nettuts.com...](http://nettuts.com/tutorials/javascript-ajax/the-definitive-guide-to-creating-a-practical-jquery-plugin/)）：

```
function complexLoad(config, fileNames) {
  for (var x = 0; x < fileNames.length; x++) {
    $("<img>").attr({
      id: fileNames[x],
      src: config.imgDir + fileNames[x] + config.imgFormat,
      title: "The " + fileNames[x] + " nebula"
    }).appendTo("#" + config.imgContainer).css({ display: "none" });
  }
}; 
```

但是，对于我想要的东西来说，它看起来有点过头了！

我知道有 jQuery 插件可以做到这一点，但它们看起来都有点大（大小）；我只需要一种快速、简单和简短的预加载图像的方法！

* * *

## 回答 #1

> 赞同：977
> 
> 时间：2009-01-24T21:28:26.537

快速*简便*：

```
function preload(arrayOfImages) {
    $(arrayOfImages).each(function(){
        $('<img/>')[0].src = this;
        // Alternatively you could use:
        // (new Image()).src = this;
    });
}

// Usage:

preload([
    'img/imageName.jpg',
    'img/anotherOne.jpg',
    'img/blahblahblah.jpg'
]); 
```

或者，如果你想要一个 jQuery 插件：

```
$.fn.preload = function() {
    this.each(function(){
        $('<img/>')[0].src = this;
    });
}

// Usage:

$(['img1.jpg','img2.jpg','img3.jpg']).preload(); 
```

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2011-09-05T18:12:01.467

这是第一个响应的调整版本，它实际上将图像加载到 DOM 中并默认隐藏它。

```
function preload(arrayOfImages) {
    $(arrayOfImages).each(function () {
        $('<img />').attr('src',this).appendTo('body').css('display','none');
    });
} 
```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2012-06-30T12:41:09.087

使用 JavaScript [Image 对象](https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Canvas_tutorial/Using_images)。

此函数允许您在加载所有图片时触发回调。但是，请注意，如果至少有一个资源未加载，它将永远不会触发回调。这可以通过实现`onerror`回调和递增`loaded`值或处理错误来轻松解决。

```
var preloadPictures = function(pictureUrls, callback) {
    var i,
        j,
        loaded = 0;

    for (i = 0, j = pictureUrls.length; i < j; i++) {
        (function (img, src) {
            img.onload = function () {                               
                if (++loaded == pictureUrls.length && callback) {
                    callback();
                }
            };

            // Use the following callback methods to debug
            // in case of an unexpected behavior.
            img.onerror = function () {};
            img.onabort = function () {};

            img.src = src;
        } (new Image(), pictureUrls[i]));
    }
};

preloadPictures(['http://foo/picture.bar', 'http://foo/picture.bar', 'http://foo/picture.bar', 'http://foo/picture.bar'], function(){
    console.log('a');
});

preloadPictures(['http://foo/picture.bar', 'http://foo/picture.bar', 'http://foo/picture.bar', 'http://foo/picture.bar'], function(){
    console.log('b');
}); 
```

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2011-01-22T00:06:19.173

JP，在检查了您的解决方案后，我仍然在 Firefox 中遇到问题，即在加载页面之前它不会预加载图像。`sleep(5)`我通过在我的服务器端脚本中加入一些来发现这一点。我根据您的解决方案实施了以下解决方案，这似乎解决了这个问题。

基本上，我为您的 jQuery 预加载插件添加了一个回调，以便在正确加载所有图像后调用它。

```
// Helper function, used below.
// Usage: ['img1.jpg','img2.jpg'].remove('img1.jpg');
Array.prototype.remove = function(element) {
  for (var i = 0; i < this.length; i++) {
    if (this[i] == element) { this.splice(i,1); }
  }
};

// Usage: $(['img1.jpg','img2.jpg']).preloadImages(function(){ ... });
// Callback function gets called after all images are preloaded
$.fn.preloadImages = function(callback) {
  checklist = this.toArray();
  this.each(function() {
    $('<img>').attr({ src: this }).load(function() {
      checklist.remove($(this).attr('src'));
      if (checklist.length == 0) { callback(); }
    });
  });
}; 
```

出于兴趣，在我的上下文中，我使用它如下：

```
$.post('/submit_stuff', { id: 123 }, function(response) {
  $([response.imgsrc1, response.imgsrc2]).preloadImages(function(){
    // Update page with response data
  });
}); 
```

希望这可以帮助那些从谷歌来到这个页面的人（就像我一样）寻找在 Ajax 调用上预加载图像的解决方案。

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2012-04-02T21:37:54.760

这一行 jQuery 代码创建（并加载）一个 DOM 元素 img 而不显示它：

```
$('<img src="img/1.jpg"/>'); 
```

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2013-01-22T14:49:14.543

```
$.fn.preload = function (callback) {
  var length = this.length;
  var iterator = 0;

  return this.each(function () {
    var self = this;
    var tmp = new Image();

    if (callback) tmp.onload = function () {
      callback.call(self, 100 * ++iterator / length, iterator === length);
    };

    tmp.src = this.src;
  });
}; 
```

用法很简单：

```
$('img').preload(function(perc, done) {
  console.log(this, perc, done);
}); 
```

[http://jsfiddle.net/yckart/ACbTK/](http://jsfiddle.net/yckart/ACbTK/)

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2011-05-06T00:07:54.470

我有一个处理这个的小插件。

它被称为[waitForImages](https://github.com/alexanderdickson/waitForImages)，它可以处理`img`元素或任何引用 CSS 中的图像的元素，例如`div { background: url(img.png) }`.

如果您只是想加载*所有*图像，包括 CSS 中引用的图像，您可以这样做:)

```
$('body').waitForImages({
    waitForAll: true,
    finished: function() {
       // All images have loaded.
    }  
}); 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2011-03-28T15:02:46.757

这个 jquery [imageLoader](http://alz.so/imageloader)插件只有 1.39kb

用法：

```
$({}).imageLoader({
    images: [src1,src2,src3...],
    allcomplete:function(e,ui){
        //images are ready here
        //your code - site.fadeIn() or something like that
    }
}); 
```

还有其他选项，例如是否要同步或异步加载图像以及每个单独图像的完整事件。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2012-04-18T16:43:59.823

您可以使用 css`display:none;`规则在 html 中的某个地方加载图像，然后在需要时使用 js 或 jquery 显示它们

不要使用 js 或 jquery 函数来预加载只是一个 css 规则与要执行的多行 js

示例：HTML

```
<img src="someimg.png" class="hide" alt=""/> 
```

CSS：

```
.hide{
display:none;
} 
```

jQuery：

```
//if want to show img 
$('.hide').show();
//if want to hide
$('.hide').hide(); 
```

通过 jquery/javascript 预加载图像并不好，因为图像需要几毫秒才能加载到页面中 + 你有几毫秒的时间来解析和执行脚本，特别是如果它们是大图像，所以将它们隐藏在 hml 中也更好地提高性能，因为图像实际上是在根本不可见的情况下预加载的，直到您显示出来！

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2012-06-12T14:50:49.743

在 jQuery 中预加载图像并获得回调函数的一种快速、无插件的方法是`img`一次创建多个标签并计算响应，例如

```
function preload(files, cb) {
    var len = files.length;
    $(files.map(function(f) {
        return '<img src="'+f+'" />';
    }).join('')).load(function () {
        if(--len===0) {
            cb();
        }
    });
}

preload(["one.jpg", "two.png", "three.png"], function() {
    /* Code here is called once all files are loaded. */
});
​    ​ 
```

请注意，如果您想支持 IE7，则需要使用这个稍微不那么漂亮的版本（它也适用于其他浏览器）：

```
function preload(files, cb) {
    var len = files.length;
    $($.map(files, function(f) {
        return '<img src="'+f+'" />';
    }).join('')).load(function () {
        if(--len===0) {
            cb();
        }
    });
} 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2011-05-26T17:10:05.177

谢谢你！我想在 JP 的答案上添加一点即兴 - 我不知道这是否会对任何人有所帮助，但这样你就不必创建图像数组，如果你可以预加载所有大图像正确命名你的拇指。这很方便，因为我有人用 html 编写所有页面，它确保他们少做一步 - 消除创建图像数组的需要，以及另一个可能搞砸的步骤。

```
$("img").each(function(){
    var imgsrc = $(this).attr('src');
    if(imgsrc.match('_th.jpg') || imgsrc.match('_home.jpg')){
      imgsrc = thumbToLarge(imgsrc);
      (new Image()).src = imgsrc;   
    }
}); 
```

基本上，对于页面上的每个图像，它都会抓取每个图像的 src，如果它符合某些条件（是拇指或主页图像），它会更改名称（图像 src 中的基本字符串替换），然后加载图像.

在我的例子中，页面充满了拇指图像，都命名为 image_th.jpg，所有相应的大图像都命名为 image_lg.jpg。大拇指只是用 _lg.jpg 替换 _th.jpg，然后预加载所有大图像。

希望这可以帮助某人。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2012-11-19T14:19:17.467

```
 jQuery.preloadImage=function(src,onSuccess,onError)
    {
        var img = new Image()
        img.src=src;
        var error=false;
        img.onerror=function(){
            error=true;
            if(onError)onError.call(img);
        }
        if(error==false)    
        setTimeout(function(){
            if(img.height>0&&img.width>0){ 
                if(onSuccess)onSuccess.call(img);
                return img;
            }   else {
                setTimeout(arguments.callee,5);
            }   
        },0);
        return img; 
    }

    jQuery.preloadImages=function(arrayOfImages){
        jQuery.each(arrayOfImages,function(){
            jQuery.preloadImage(this);
        })
    }
 // example   
    jQuery.preloadImage(
        'img/someimage.jpg',
        function(){
            /*complete
            this.width!=0 == true
            */
        },
        function(){
            /*error*/
        }
    ) 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-02-08T10:28:51.000

我使用以下代码：

```
$("#myImage").attr("src","img/spinner.gif");

var img = new Image();
$(img).load(function() {
    $("#myImage").attr("src",img.src);
});
img.src = "http://example.com/imageToPreload.jpg"; 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-02-27T06:07:43.450

我会使用 Manifest 文件来告诉（现代）网络浏览器也加载所有相关图像并缓存它们。使用 Grunt 和 grunt-manifest 自动执行此操作，无需再担心预加载脚本、缓存无效器、CDN 等。

[https://github.com/gunta/grunt-manifest](https://github.com/gunta/grunt-manifest)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-04-20T16:46:20.987

```
function preload(imgs) {
    $(imgs).each(function(index, value) {
        $('<img />').attr('src', value).appendTo('body').css('display', 'none');
    });
} 
```

`.attr('src',value)` 不是 `.attr('src',this)`

只是指出它:)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-10-25T15:18:06.430

即使在 IE9 中，这也适用于我：

```
$('<img src="' + imgURL + '"/>').on('load', function(){ doOnLoadStuff(); }); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-02-21T17:18:14.540

我想用 Google Maps API 自定义覆盖来做到这一点。他们的示例代码只是使用 JS 插入 IMG 元素并显示图像占位符框，直到图像加载。我在这里找到了一个对我有用的答案：[https](https://stackoverflow.com/a/10863680/2095698) ://stackoverflow.com/a/10863680/2095698 。

```
$('<img src="'+ imgPaht +'">').load(function() {
$(this).width(some).height(some).appendTo('#some_target');
}); 
```

这会按照之前的建议预加载图像，然后在加载 img URL 后使用处理程序附加 img 对象。jQuery 的文档警告说，缓存的图像不适用于此事件/处理程序代码，但它在 FireFox 和 Chrome 中对我有用，而且我不必担心 IE。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-06-19T10:51:14.223

我通常在我的项目中使用这段代码来加载页面中的图像。你可以在这里看到结果[https://jsfiddle.net/ftor34ey/](https://jsfiddle.net/ftor34ey/)

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<img src="https://live.staticflickr.com/65535/50020763321_d61d49e505_k_d.jpg" width="100" />
<img src="https://live.staticflickr.com/65535/50021019427_692a8167e9_k_d.jpg" width="100" />
<img src="https://live.staticflickr.com/65535/50020228418_d730efe386_k_d.jpg" width="100" />
<img src="https://live.staticflickr.com/65535/50020230828_7ef175d07c_k_d.jpg" width="100" />

<div style="background-image: url(https://live.staticflickr.com/65535/50020765826_e8da0aacca_k_d.jpg);"></div>
<style>
    .bg {
        background-image: url("https://live.staticflickr.com/65535/50020765651_af0962c22e_k_d.jpg");
    }
</style>
<div class="bg"></div>

<div id="loadingProgress"></div> 
```

该脚本将所有页面保存在一个数组中`src`并`background-image`加载所有页面。

您可以通过 var 查看/读取/显示加载进度`loadCount`。

```
let backgroundImageArray = [];

function backgroundLoading(i) {

    let loadCount = 0;

    let img = new Image();
    $(img).on('load', function () {

        if (i < backgroundImageArray.length) {

            loadCount = parseInt(((100 / backgroundImageArray.length) * i));
            backgroundLoading(i + 1);

        } else {

            loadCount = 100;
            // do something when the page finished to load all the images
            console.log('loading completed!!!');
            $('#loadingProgress').append('<div>loading completed!!!</div>');

        }

        console.log(loadCount + '%');
        $('#loadingProgress').append('<div>' + loadCount + '%</div>');

    }).attr('src', backgroundImageArray[i - 1]);

}

$(document).ready(function () {

    $('*').each(function () {

        var backgroundImage = $(this).css('background-image');
        var putInArray = false;

        var check = backgroundImage.substr(0, 3);

        if (check == 'url') {

            backgroundImage = backgroundImage.split('url(').join('').split(')').join('');
            backgroundImage = backgroundImage.replace('"', '');
            backgroundImage = backgroundImage.replace('"', '');

            if (backgroundImage.substr(0, 4) == 'http') {
                backgroundImage = backgroundImage;
            }
            putInArray = true;

        } else if ($(this).get(0).tagName == 'IMG') {

            backgroundImage = $(this).attr('src');
            putInArray = true;

        }

        if (putInArray) {
            backgroundImageArray[backgroundImageArray.length] = backgroundImage;
        }

    });

    backgroundLoading(1);

}); 
```

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2013-08-09T23:56:52.143

咖啡脚本中的 5 行

```
array = ['/img/movie1.png','/img/movie2.png','/img/movie3.png']

$(document).ready ->
  for index, image of array
    img[index] = new Image()
    img[index].src = image 
```

* * *

## 回答 #20

> 赞同：-4
> 
> 时间：2015-06-13T10:19:30.947

对actionscript有一点了解的人，可以毫不费力地检查flash player，并制作一个flash preloader，你也可以导出到html5/Javascript/Jquery。要在未检测到 Flash 播放器时使用，请查看有关如何将 youtube 角色返回到 html5 播放器的示例：) 并创建您自己的。我没有详细信息，因为我还没有开始，如果我没有忘记，我稍后会发布它并尝试一些标准的 Jquery 代码来挖掘。

# c# - C# asp.net 从 viewstate 动态构建 SQL Query

> ID：476701
> 
> 赞同：0
> 
> 时间：2009-01-24T21:40:21.550
> 
> 标签：c#, asp.net, security, viewstate

在我的 C# asp.net webform 上，我有一个搜索页面，其中包含大约 20 个“可以”用作搜索的一部分的元素。以后还会有更多的补充。

我所做的是扩展文本框和下拉列表框以包含一些变量：

fieldname: Tablename.columnname dbtype: DbType.Int32 Joinparam: LEFT Join on otherTable ON xy = ab

这些都存储在视图状态中并重新加载。我这样做的原因是我可以遍历所有控件并拉出所有属于我的类型的控件。然后我可以验证它们以确保它们有输入并且是正确的类型。如果是这样，我可以将它们传递给数据库访问层，让代码动态生成 SQL 语句。

除了 SELECT 语句之外，我不会让任何事情发生。选择和返回的字段不能更改，我使用 db 参数来尝试避免 sql 注入。

我担心的是我将在搜索条件中使用的表和字段名称以及所需的 JOINS 都放在视图状态中。这是一个真正的坏主意吗？

我可以通过在数据库中保存这些信息的表中添加一些 int 索引来掩盖这一点，但这仍然需要放入视图状态，这意味着它们将有一个额外的层来计算。

我采用这种方法的原因是我不想在 DB 层中放置大量的 IF 语句来在那里构建语句。这将是丑陋的地狱和痛苦的维护。

感谢您对此的任何建议。

乔恩

**编辑**

谢谢大家的建议。谢天谢地，这个应用程序只是一个内部的东西，所以损害是有限的。但我永远不会再使用这种技术，而是会研究搜索模板的想法。

干杯:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T22:00:57.720

我认为在视图逻辑中对部分数据访问层进行编码是一个真正的设计错误。撇开安全问题不谈，对于任何追随你的人来说，这将很难维护和理解。我认为从长远来看，从各种选定的输入生成特定查询的工厂类可能会更容易使用。或者，您可以从输入中填充“搜索模板”，并将搜索模板功能用作生成查询的工厂，就像 UserPrincipal 与 System.DirectoryServices.AccountManagement 命名空间中的 PrincipalSearcher 交互的方式一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T22:21:35.617

Viewstate 没有加密，它是 base64 编码的。有现成的实用程序可以让您解码页面的视图状态。

但是，可以加密页面或所有页面的视图状态：http: [//msdn.microsoft.com/en-us/library/aa479501.aspx](http://msdn.microsoft.com/en-us/library/aa479501.aspx)

也就是说，我不会推荐这种方法。应用程序设计的最佳方法是将 UI 与业务和数据访问逻辑分离。在这种情况下，您将紧密耦合它们而没有明显的好处。

如果您确实在数据访问层中构建了更强大的即席查询功能，那么您可能正在为应用程序的后端增加价值。您可以通过 Web 服务、Windows 窗体应用程序等提供搜索功能。即使这种类型的功能不是您设想在不久的将来发生的事情，但当您采用这种方法时，它可以节省大量时间（和 $$$）。

您在 UI 中构建的逻辑可以很容易地构建到某种类型的查询引擎中。您可以构建一个方法来通过动态添加条件来组装查询，而不是您想要避免的 IF。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T22:38:21.310

好的，所以 ViewState 默认为[MACed](http://msdn.microsoft.com/en-us/library/system.web.ui.page.enableviewstatemac.aspx)，并且可以选择加密。因此，尽管您可以（默认情况下）*读取*视图状态，但[篡改并非易事](http://msdn.microsoft.com/en-us/library/ms178199(VS.80).aspx)。

像这样动态构建查询绝对可以让您使用 Sql Injection - 您正在参数化搜索词，但是如果我可以将 ;DROP TABLE 语句注入到您的 JOIN 子句中，那么您将被淹没（除非您已经非常小心当然是设置数据库级别的安全性）。

话虽如此，我看不出有任何理由让您的 JOIN 子句等需要在 ViewState 中。我想你会在 ASPX 标记中将它们设置为子类文本框的属性——它们没有理由改变。您可能需要 ViewState 的唯一事情是搜索条件本身 - 已适当参数化。这类似于 SqlDataSource 保护其 SelectCommand 属性的方式——不要将其存储在 ViewState 中，以免泄露信息（或存在篡改风险——尽管我认为这不是一个严重的漏洞）。

至于这是否可维护的更大问题 - 好吧，我想你必须打这个电话。

# cocoa - Cocoa radio WebView 滚动

> ID：476707
> 
> 赞同：0
> 
> 时间：2009-01-24T21:44:49.107
> 
> 标签：cocoa, uiwebview, webkit, radio-button

在使用 XCode 和 IB 的 cocoa 中，是否可以从 WebKit 中获得兼作单选按钮的 WebView 的滚动视图？如何执行此操作以及如何检索选择了哪个视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T13:07:50.583

对不起，我想我不太明白你的问题。

首先，您可以将您选择的任何内容设置为滚动视图，这并不是 Mac 上 UI 设计的典型做法，但如果您坚持，您可以这样做。

其次，您当然可以添加几个单选按钮，它们都属于一个单选按钮组，因此选择一个会取消选择前一个选择的单选按钮并且不给它们任何文本（您不会被迫给它们一个标签），只需在每个单选按钮旁边放置一个 webview这些按钮。

你如何检索选择了哪一个？要么你只是遍历所有并测试每一个，如果它被检查直到你找到被检查的那个，或者你实现一个带有动作方法的控制器，每当检查一个时调用该控制器，并在每次检查一个时更新一个变量并引用选中的，最后这个变量将指向选中的。

但是，这对我来说听起来很重要，好像单选按钮和 web 视图的数量是动态的（不是恒定的，而是取决于某些条件），在这种情况下，无论如何您都不能使用 Interface Builder 来做到这一点（或者可以说它会是比较尴尬）。在这种情况下，您最好只在 IB 中定义窗口和滚动视图，并在运行时以编程方式向其中添加单选按钮和 web 视图。

也许我完全误解了你的问题，在这种情况下，请回答你的问题来真正解释你的问题。

# regex - 有没有好的在线交互式正则表达式教程？

> ID：476714
> 
> 赞同：61
> 
> 时间：2009-01-24T21:50:00.127
> 
> 标签：regex

现在，我对 SQL 和正则表达式都了如指掌，但有几次在这个网站上，我遇到了有人在[SQLzoo.net](http://sqlzoo.net/)上进行练习。据我所知，这是一个很棒的在线资源，人们可以很容易地通过示例学习 SQL，针对多个玩具数据库编写许多玩具查询。我可能会将想要学习 SQL 的人重定向到该站点。

这些 SQLzoo 人员还运行其他一些教程，包括一些关于一些编程语言的教程。但是，关于正则表达式的部分非常小（*例如*，参见[Java](http://progzoo.net/wiki/Strings_Tutorial%2C_Pattern_Matching)的页面），我认为您实际上无法*从中学习*正则表达式。我认为一个好的在线教程*可能*有助于解决我们在这里遇到的基本正则表达式问题。（也许在回答之后，我们可以建议他们看一下教程。）

那么，**是否有一个很好的、在线的、交互式的正则表达式教程**与那个 SQL 教程相类似？我在网上看了一眼，但我能找到的只是非交互式教程或简单的页面（尽管仍然有用！），它们可以让您将字符串与模式匹配，以便您可以看到它匹配/捕获/等。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2011-09-09T02:33:52.377

无耻插件：我在几个周末写了一个交互式正则表达式教程（[RegexOne](http://regexone.com)）来帮助一些朋友学习正则表达式。他们提到实时示例似乎也很有帮助。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-01-24T22:49:11.850

@wchung 编写的网站 RegexOne 似乎是对原始问题的完美回答。先检查一下；）

正如评论者正确提到的那样，工具 txt2re 非常丑陋。[RegExr](http://gskinner.com/RegExr/) (ht @runrunraygun) 是一个更漂亮的正则表达式编辑工具，虽然功能完全不同，而且还没有教程。

它可能对学习正则表达式有用的主要原因是能够查看每次编辑对匹配的影响。

**原答案：**

我一直认为[txt2re](http://www.txt2re.com/)是一个非常聪明的工具。您只需键入要匹配的某些文本的示例，然后它就可以让您挑选出要匹配的内容。我认为它是学习正则表达式的一个相当有用的工具。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-24T23:57:04.473

它不是真正的交互式，但仍然是一个很好的教程：[www.regular-expressions.info](http://www.regular-expressions.info/tutorialcnt.html)。您可以尝试将该教程与在线 RegEx 工具之一结合来试用示例（进行一些交互性:-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T03:14:53.613

它不在线，但是，您可能会喜欢[RegexExpress](http://www.pyweek.org/e/RegExExpress/)游戏（警告：获奖图片之一是 nsfw）。这是一个在 PyWeek 比赛中制作的游戏，它教你在 curses 类型的界面上使用正则表达式。我觉得很有趣。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-18T17:49:11.210

有正[则表达式英雄](http://regexhero.net/)。这不是教程，但它是交互式的。它会在您键入时突出显示匹配项。即时突出显示使实验变得容易。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-24T18:25:49.733

[交互式正则表达式生成器](http://gskinner.com/RegExr/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-29T17:09:26.390

[Expressions](http://www.wingtiplabs.com/expressions.html)是一个交互式正则表达式教程。重点是组合使用功能，并为常见错误提供出色的反馈。（查看我的博客文章，了解我们如何找出[真正常见的错误](http://www.wingtiplabs.com/blog/posts/2013/01/17/why-i-love-my-error-logs-and-you-should/)。）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-06-23T17:19:28.770

[高保真正则表达式测试器](http://www.gethifi.com/tools/regex#)

> 正则表达式可能很痛苦。该工具旨在帮助开发人员学习、练习和编写正则表达式。

虽然这个工具不是那个 SQL 网站风格的教程，但它的目的是帮助教授正则表达式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-30T20:42:09.243

我喜欢[http://rubular.com](http://rubular.com)互动和友好。

# jquery - json 以及如何使用它

> ID：476715
> 
> 赞同：1
> 
> 时间：2009-01-24T21:50:08.410
> 
> 标签：jquery, json

说我有以下 json 对象；

```
{'fname':'john', 'lname':'Locke'} 
```

和以下文本框

```
<input type="text" name="txtFirstName" value="" />
<input type="text" name="txtLastName" value="" /> 
```

如何继续并使用 jquery 为这些文本框分配 json 对象中的值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T22:01:59.493

这样的事情应该可以解决问题：

```
$("input[@name='txtFirstName']").val(jsonObject.fname);
$("input[@name='txtLastName']").val(jsonObject.lname); 
```

# java - Java 32bit 对 Win(any) 64bit 的影响？

> ID：476716
> 
> 赞同：0
> 
> 时间：2009-01-24T21:50:39.457
> 
> 标签：java, vista64, jai

我正在尝试在我的 Vista 64 中安装 JAI（Java 高级成像）1.1.3，它说为了安装它，必须安装 JDK 1.3 及更高版本。问题是我已经为Win64安装了最新的JDK，而且似乎不愿意使用它。
我想知道如果我在 Vista 64 中安装 JDK 32 位而不是 64 位，是否会有任何严重后果。

提前感谢您提供有关该主题的任何建议！

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T21:56:20.787

我在 Vista x64 上安装了 32 位 JDK (1.6.0_11)，并且到目前为止（使用 3 个月后）没有报告任何不良影响。

请记住，它位于**Program File (x86)**而不是普通的旧**Program Files**中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T22:11:15.467

我认为 Vista 的 64 位 Java 版本实际上有一些缺点，比如没有浏览器插件（所以小程序无法工作）。似乎 64 位 Java 只有在您真的需要 64 位功能时才有意义，对于普通用户来说，预期的版本仍然是 32 位版本。

编辑：Sun 现在已经发布了 64 位版本的浏览器插件和 webstart。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T02:30:47.563

除非您的库使用 32 位共享库，否则使用 32 位版本而不是 64 位版本不太可能产生任何影响。（并且没有 64 位版本）

# java - 合并 JTable 中的单元格

> ID：476721
> 
> 赞同：9
> 
> 时间：2009-01-24T21:52:42.650
> 
> 标签：java, swing, jtable, cell, html

是否可以合并 JTable 对象的某些单元格？

[![合并单元格](https://i.stack.imgur.com/Dcz1D.gif)](https://i.stack.imgur.com/Dcz1D.gif)
[（来源：[codeguru.com](http://www.codeguru.com/java/articles/139_table12.gif)）]

如果通过 JTable 无法实现，那么最好的方法是什么。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T22:00:25.083

您可以使用合并原始 TableModel 的两列的 TableModel 来实现 JTable。

```
class Model2 extends AbstractTableModel
{
private TableModel delegate;
public Model2(TableModel delegate)
 {
 this.delegate= delegate;
 }

public int getRowCount() { return this.delegate.getRowCount();}
public int getColumnCount() { return this.delegate.getColumnCount()-1;}
public Object getValueAt(int row, int col)
 {
 if(col==0) return ""+delegate.getValueAt(row,col)+delegate.getValueAt(row,col+1);
 return delegate.getValueAt(col+1);
 }
(...)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T22:19:35.077

不是开箱即用的。[这是一个](http://codeguru.earthweb.com/java/articles/139.shtml)支持合并任意单元格的示例。[此页面](http://www.crionics.com/products/opensource/faq/swing_ex/JTableExamples4.html)有几个具有跨单元格的表格示例。当然它是旧的，你得到你所支付的。如果付费软件是一个选项，[JIDE Grids](http://codeguru.earthweb.com/java/articles/139.shtml)有一些非常好的 Swing table 支持，包括[自定义单元格跨度](http://www.jidesoft.com/images/cellspantable2.png)。

# r - 在 R 中过滤数据

> ID：476726
> 
> 赞同：13
> 
> 时间：2009-01-24T21:56:23.717
> 
> 标签：r, filtering

我有一个 CSV 的数据文件，我可以使用它在 R 中加载`read.csv()`

一些数据丢失了，所以我想将数据框减少到完全由非缺失数据组成的集合，即如果 a`NULL`出现在任何地方，我想从过滤的数据集中排除该列和行。

我知道我可以通过内置的 R 向量操作相当简单地做到这一点，但我不太确定如何准确地做到这一点？

为了让我的问题更具体一点，这里有一个数据的快速示例，这样你就可以看到我想要做什么。

```
DocID       Anno1    Anno7  Anno8
1           7        NULL   8
2           8        NULL   3
44          10       2      3
45          6        6      6
46          1        3      4
49          3        8      5
62          4        NULL   9
63          2        NULL   4
67          11       NULL   3
91          NULL     9      7
92          NULL     7      5
93          NULL     8      8 
```

所以给定这个输入，我需要一些代码来减少输出。

```
DocID       Anno8
44          3
45          6
46          4
49          5 
```

As`Anno8`是唯一具有非 NULL 数据的列，并且只有四行具有非 NULL 数据。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-25T00:05:19.107

您可以使用 na.omit() 删除任何包含缺失的行，但这不是您想要的。此外，当前接受的答案是错误的。它为您提供完整的列，但不会删除具有一个或多个缺失值的行，这是所要求的。正确答案可以如下得到：

```
> a <- data.frame(a=c(1,2),b=c(NA,1), c=c(3,4))
> a
  a  b c
1 1 NA 3
2 2  1 4
> na.omit(a)[,colSums(is.na(a))==0]
  a c
2 2 4 
```

要看到上面的答案是错误的：

```
> a[ ,apply(a, 2, function(z) !any(is.na(z)))]
  a c
1 1 3
2 2 4 
```

由于第 2 列中的 NA，应删除第 1 行。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-24T22:07:32.417

如果`x`是你的`data.frame`（或`matrix`）那么

```
x[ ,apply(x, 2, function(z) !any(is.na(z)))] 
```

由于您的示例使用`NULL`,`is.na(·)`将替换为`is.null(·)`

或者，您可以查看`subset(·)`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-17T19:35:02.810

```
a <- data.frame(a=c(1,2,0,1),b=c(NA,1,NA,1), c=c(3,4,5,1))

na.omit(a)
  a b c
2 2 1 4
4 1 1 1

a[rowSums(is.na(a))==0,]
  a b c
2 2 1 4
4 1 1 1

a[complete.cases(a),]
  a b c
2 2 1 4
4 1 1 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-06T01:02:36.167

此外，如果您的数据框是，您可以使用`sqldf`库来执行此操作`x`：

```
library(sqldf)
result <- sqldf("SELECT DocID, Anno8 FROM x
                 WHERE Anno1 IS NOT NULL AND Anno7 IS NOT NULL") 
```

# c# - C#：当对象重命名时，如何让 VSC# Express 2008 重构事件名称？

> ID：476728
> 
> 赞同：0
> 
> 时间：2009-01-24T21:59:33.743
> 
> 标签：c#, refactoring

重命名对象时，如何使 Visual Studio C# Express 2008 重构事件名称？

假设我有一个名为 txtCars 的对象，它已经有一个用于 txtCarsTextChanged 的​​事件处理程序，我将对象从 txtCars 重命名为 txtTrucks。其他所有内容都被重构，但事件 txtCarsTextChanged 没有。是否有一种快捷方式可以使其全部重构或至少与事件一起进行，即使在表单 design.cs 文件上，也无需手动编辑事件名称并返回表单 Designer.cs 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-24T22:02:47.590

如果您的意思是您希望`txtCarsTextChanged`重命名`txtCars`对象时，那么恐怕答案是否定的。但是，您可以右键单击事件的名称并对其执行单独的重命名重构。这应该选择使用该事件的任何实例，包括设计器生成的代码。

# javascript - 如何读取元素的内联样式？

> ID：476730
> 
> 赞同：1
> 
> 时间：2009-01-24T22:00:35.393
> 
> 标签：javascript, css, inline, styling

我想知道是否可以确定HTML 元素的**内联样式。**我不需要检索该值，而只是检测它是否被设置为内联。

例如，如果 HTML 是：

```
<div id="foo" style="width: 100px; height: 100px; background: green;"></div> 
```

如何确定`width`,`height`和`background`已明确声明为内联？

据我所知，该解决方案可以通过两种方式发挥作用。我可以询问它是否设置了特定属性，它会告诉我真假，或者它可以告诉我所有已设置的属性。像这样：

```
var obj = document.getElementById('foo');
obj.hasInlineStyle('width');  //returns true;
obj.hasInlineStyle('border'); //returns false;

//or

obj.getInlineStyles();   //returns array with values:
                       // 'width' 'height' and 'background' 
```

我对通过样式表中的声明继承的 CSS 属性不感兴趣，只对内联样式感兴趣。最后一件事，我无法控制 HTML 源代码。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T22:12:35.323

**更新为与 IE 一起使用**

你可以试试这样的

```
function hasInlineStyle(obj, style) {
    var attrs = obj.getAttribute('style');
    if(attrs === null) return false;
    if(typeof attrs == 'object') attrs = attrs.cssText;
    var styles = attrs.split(';');
    for(var x = 0; x < styles.length; x++) {
        var attr = styles[x].split(':')[0].replace(/^\s+|\s+$/g,"").toLowerCase();
        if(attr == style) {
            return true;
        }
    }
    return false;
} 
```

因此，如果您有这样的元素：

```
<span id='foo' style='color: #000; line-height:20px;'></span> 
```

这也有一个像这样的样式表：

```
#foo { background-color: #fff; } 
```

该函数将返回...

```
var foo = document.getElementById('foo');
alert(hasInlineStyle(foo,'color')); // true
alert(hasInlineStyle(foo,'background-color')); // false 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T22:09:34.440

HTML 元素的 style 属性返回一个列出所有属性的样式对象。任何具有值（除了 null 或空字符串）的值都已在内联样式属性上设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T22:13:03.577

您可能想尝试执行以下操作：

```
var obj = document.getElementById("foo");
var obj_has_background = (obj.style.background != "");
var obj_has_width = (obj.style.width != "");
var obj_has_height = (obj.style.height != ""); 
```

似乎有点长，但这是我能想到的最好（也是最短）的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T22:51:35.807

您是要检查某个样式属性是否存在，还是只想要一个可能的属性列表？如果您已经知道该属性，那么您可以使用

```
hasStyle(obj,'width');
function hasStyle(obj, style)
{
     switch(style)
         case 'width':
              return obj.style.width ? true : false;
         case 'background':
              return obj.style.background ? true : false;
} 
```

您可以使用 Paolo 的函数来生成样式数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-04T20:59:24.440

以下是两个返回本地元素样式定义的函数：

```
function getLocalStyle(pEleId, pStyle) {
    var camelStyle = camelCase( pStyle );
    var eleStyles = document.getElementById(pEleId).style
    return eleStyles[camelStyle];
}

function camelCase(str) {
  return str
    .split('-')
    .reduce((a, b) => a + b.charAt(0).toUpperCase() + b.slice(1));
} 
```

用法：

```
var backgroundColor = getLocalStyle( pLayerName, "background-color" ); 
```

# python - 在不请求整个对象的情况下获取外键

> ID：476731
> 
> 赞同：0
> 
> 时间：2009-01-24T22:00:43.663
> 
> 标签：python, django, django-models

我有一个模型 Foo ，它具有 User 模型的 ForeignKey 。

稍后，我需要获取所有用户的 id 并将其放在列表中

```
foos = Foo.objects.filter(...)

l = [ f.user.id for f in foos ] 
```

但是当我这样做时，django 从数据库中获取整个用户实例，而不是只给我数字用户的 id，它存在于每个 Foo 行中。

如何在不查询每个用户或使用 select_related 的情况下获取所有 id？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-25T00:41:14.867

使用[queryset 的 values() 函数](http://docs.djangoproject.com/en/dev/ref/models/querysets/#values-fields)，它将返回一个字典列表，其中包含作为参数传递的每个属性的名称/值对：

```
>>> Foo.objects.all().values('user__id')
[{'user__id': 1}, {'user__id' 2}, {'user__id': 3}] 
```

然后 ORM 将能够优化 SQL 查询以仅返回所需的字段，而不是执行“SELECT *”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T05:11:17.887

每当您在 Django 中定义 ForeignKey 时，它都会自动将 FIELD_id 字段添加到您的模型中。

例如，如果有一个带有名为“”的属性`Foo`的 FK ，那么您还有一个名为**user_id**的属性，其中包含相关用户的 id。`User``user`

 **```
l = [ f.user_id for f in foos ] 
```

`.values()`如果您明智地选择属性，调用也会增加性能

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T22:41:20.383

没关系......我不确定为什么在我尝试之前这不起作用，但这是怎么做的：

```
l = [ f.user_id for f in foos ] 
```

# c# - “do”/Action LINQ 运算符的任何计划？

> ID：476736
> 
> 赞同：13
> 
> 时间：2009-01-24T22:04:53.013
> 
> 标签：c#, linq, c#-4.0

这是一个带有`foreach`循环的简单方法：

```
IEnumerable<XElement> FieldsToXElements(object instance)
{
    var fieldElements = new List<XElement>();

    foreach (var field in instance.GetType().GetFields(instance))
    {
        fieldElements.Add(new XElement(field.Name, field.GetValue(instance)));
    }

    return fieldElements;
} 
```

有点丑。如果 LINQ 中有一些表示“做某事”的运算符（例如，`Action`为 LINQ 语句中选择的每个执行一个），它看起来会更好，更简洁：

```
IEnumerable<XElement> FieldsToXElements(object instance)
{
    var fieldElements = new List<XElement>();

    from field in instance.GetType().GetFields(instance))
    let name = field.Name
    let value = field.GetValue(instance)
    do fieldElements.Add(new XElement(name, value));

    return fieldElements;
} 
```

我意识到这是主观的，只是我的看法。在我看来，对于具有仅调用方法的一行的 foreach 循环，“ `do`”运算符是有意义的。**但我想知道 MS 的任何人是否也有同样的想法。是否计划在任何即将发布的版本中使用这种 LINQ 运算符（例如，与 C# 4.0 一起首次亮相）？**

这是另一个带有谓词的示例，其中虚构的`do`运算符确实会使代码看起来更干净。这：

```
IEnumerable<XElement> FieldsToXElements
    (object instance, Func<FieldInfo, bool> predicate)
{
    var fieldElements = new List<XElement>();

    foreach (var field in instance.GetType().GetFields(instance).Where(predicate))
    {
        fieldElements.Add(new XElement(field.Name, field.GetValue(instance)));
    }

    return fieldElements;
} 
```

与这个：

```
IEnumerable<XElement> FieldsToXElements
    (object instance, Func<FieldInfo, bool> predicate)
{
    var fieldElements = new List<XElement>();

    from field in instance.GetType().GetFields(instance))
    let name = field.Name
    let value = field.GetValue(instance)
    where predicate(field)
    do fieldElements.Add(new XElement(name, value));

    return fieldElements;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-24T22:08:58.530

不，我不希望很快有任何直接的**语言**支持（即在查询语法中）。

听起来您的意思是神话般的`ForEach`扩展方法；添加起来微不足道，但 Eric Lippert 已多次评论无副作用的功能代码和`Action<T>`具有副作用的代码之间的交叉。特别是，C# 3.0 / .NET 3.5 表达式树在副作用方面很糟糕（使完整的 lambda 支持变得棘手）。.NET 4.0 中的运行时方面[要好得多](http://marcgravell.blogspot.com/2008/11/future-expressions.html)，但目前尚不清楚其中有多少会使其成为 C# 4.0 中的语言（lambda 编译器）。

您所需要的（对于委托版本）是：

```
public static void ForEach<T>(this IEnumerable<T> source, Action<T> action)
{   // note: omitted arg/null checks
    foreach(T item in source) { action(item); }
} 
```

然后从任何查询中，您都可以简单地使用`.ForEach(x => /* do something */)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-25T04:35:53.723

对于您的具体示例（填充 a `List<XElement>`），我会这样做。

```
IEnumerable<XElement> FieldsToXElements(object instance)
{
  List<XElement> fieldElements =
  (
    from field in instance.GetType().GetFields(instance))
    let name = field.Name
    let value = field.GetValue(instance)
    select new XElement(name, value)
  ).ToList();  //Another Option is List<T>.AddRange()
  return fieldElements;
} 
```

另外：不要忘记`List<T>`已经 implements `.ForEach<T>()`，所以要对 any 使用它`Enumerable<T>`，这就是您需要的所有代码。

```
myEnumerable.ToList().ForEach( x => myAction(x) ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T22:16:13.677

我不认为这太难了，或者我错过了一些东西......

```
IEnumerable<XElement> FieldsToXElements(object instance)
{
    return instance.GetType()
                   .GetFields(instance)
                   .Select( f => new XElement( f.Name,
                                               f.GetValue(instance) ) );
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T22:40:53.770

如果您只是想从 linq 语句中调用函数，那么您已经可以这样做了，您可以在 Let 赋值中调用函数。

```
var qry = from e in somelist
          let errorcode = DoSomeProcessing(e)
          select e; 
```

# c# - C# - 通过 AppSettings 保存 ListView

> ID：476745
> 
> 赞同：1
> 
> 时间：2009-01-24T22:10:13.083
> 
> 标签：c#, listview, appsettings

晚上好，

我在我的项目的 AppSettings 中设置了一个 ListView 对象，但我不知道我应该使用什么作为值？！因为当我将其留空时，我无法将任何内容保存到我的设置属性中，而是在保存后获取值始终为空。真的可以用 AppSettings 做到这一点吗？

感谢您的回答！

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-25T11:01:57.253

你如何保存你的列表视图，你能提供一些代码吗？如果要保持列表视图的状态，可以尝试使用[XMLSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer(VS.80).aspx)或[SoapFormatter](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.soap.soapformatter.aspx)生成 xml 并将其存储在单独的 xml 文件中。

# user-interface - 任何带有 GUI 系统的好的 2d 引擎？

> ID：476746
> 
> 赞同：1
> 
> 时间：2009-01-24T22:11:14.157
> 
> 标签：user-interface, 2d-engine

我正在尝试开发一个简单的应用程序（它类似于 powerpoint 演示文稿），它需要一些简单的 GUI 控件：按钮、文本框、滑块和列表框。
我希望能够为控件设置皮肤。所以我正在寻找一个易于学习的 2d 引擎，它可以帮助我做我想做的事情。
这种引擎有什么推荐吗？
它可以在 python 或 .net (xna) 中更可取，或者如果不是 c/c++ 我猜也可以。

LE：我正在寻找一个具有指定 gui 控件可用的图形渲染引擎。例如 Irrlicht。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T22:29:20.080

[Qt](http://www.qtsoftware.com/products)是一个非常好的跨平台 C++ 库，它还拥有三个 GPL、LPGP 和商业许可证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T17:42:14.907

[Garage Games](http://www.garagegames.com/)是一个强大的引擎，具有许多不错的功能。他们有各种为 2D、3D、XNA、Wii、iphone 等设计的引擎。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T10:02:41.097

你也可以看看 Popcap 的[SexyAppFramework](http://sexyfaq.jamespoag.com/)。它包括 GUI 元素，比大多数成熟的引擎（如 Irrlicht 或 Ogre）小得多，可以选择使用 3D 硬件加速，并且已由 Popcap 在数百万计算机上进行了测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T16:54:53.137

最后我选择了[Irrlicht](http://irrlicht.sf.net/)

还值得一提：

*   [食人魔3d](http://www.ogre3d.org/)
*   [HGE](http://hge.relishgames.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T22:23:02.633

我不完全确定要求是什么。您是在尝试使用一些 2D 引擎渲染 GUI 小部件，还是在寻找也具有 2D 图形支持的 GUI 库？大多数 GUI 库都有不错的图形支持。例如，请参阅[Java 的 2D 图形教程](http://java.sun.com/docs/books/tutorial/2d/index.html)。对于皮肤，看看[Java 的 Substance](https://substance.dev.java.net/see.html)或[Modzilla XUL Runner](https://developer.mozilla.org/en/XULRunner)及其明星子[Songbird](http://www.getsongbird.com/)。

如果你想做更多，你可以将 OpenGL 嵌入到 WinForm、Java、Delphi 等。请参阅[在 Windows 窗体上创建 OpenGL 视图](http://www.codeproject.com/KB/miscctrl/OpenGLViewWinForms.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T22:27:21.970

[WPF](http://msdn.microsoft.com/en-us/library/ms754130.aspx) for .NET 是一个非常好的平台，可以在其中制作可换肤图形。它完全支持“开箱即用”的换肤。作为一个附带的好处，它会做 3d 渲染很少额外的努力。大多数标准的 GUI 控件都在那里，包括按钮、列表框、文本框和滑块。默认情况下，它们具有标准的窗口外观，但换肤就像改变颜色或指定要使用的图像一样简单。

# mysql - mySQL 数据库设计

> ID：476755
> 
> 赞同：2
> 
> 时间：2009-01-24T22:16:46.533
> 
> 标签：mysql, database

在我的应用程序中，我有不同的类别，用户可以将他们的交易发布为。示例：食品、购物、电影等。我希望用户能够编辑这些类别并添加/删除类别。将此信息存储在数据库中的最佳方法是什么。

1.  包含类别和相应用户的类别表？然后我可以查询 uid 并获取它们的所有类别。

2.  带有类别字段的用户表，并用逗号分隔类别。然后我可以查询用户并将他们的类别分成一个带有爆炸的数组或类似的东西。

3.  或者一个我什至没有想到的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T22:45:51.717

选项 3

类别表 CategoryID、Category_Name 等...

用户表 UserID、User_Name 等。

交集表 USER_Category

用户 ID、类别 ID

为什么？

如果你有

用户名、类别名

说

“吉姆”、“食物”、
“乔”、“食物”、
“朱迪”、“美容产品”

如果您因为不再对她的交易感兴趣而删除“Judy”，您也会失去“美容产品”类别。这样类别和用户是分开的。

也更容易提出诸如“谁将大部分钱花在食品上”之类的问题。如果用户在其中输入类别，您可能会得到“食物”、“杂货”、“外出就餐”以及大量不同的类别，甚至可能是“fod”、“foooooooooooooooood”等拼写错误……所以通过统一您可以根据查询中的 foodID 选择类别。

基本上现在用户可以浏览类别列表，如果他们从列表中发现他们感兴趣的类别，他们将在交集表中创建条目 UserID、CategoryID。这减少了拼写错误的可能性。如果该类别不存在，用户可以添加它。然后，当下一个用户查看类别时，他们将看到新条目，因此如果他们感兴趣，可以单击它并减少拼写错误的机会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T22:26:06.653

如果您可能将它们用作单个值（例如，仅一个类别），请不要在数据库字段中用逗号分隔条目。

阅读有关[数据库规范化](http://en.wikipedia.org/wiki/Database_normalization)的信息。在某些情况下，您不想一直进行规范化，但是用逗号连接不同的值不属于此类别。

不要害怕*长桌*。数据库通常为此进行了优化。如果速度变慢，请创建索引或使用其他优化技术。

选项 1 就是答案。

# java - 设置个人 (Java) 工作区：我需要什么？

> ID：476762
> 
> 赞同：2
> 
> 时间：2009-01-24T22:19:45.323
> 
> 标签：java, workspace

我想在我的家用机器上设置一个个人工作区。我主要打算将它用于家庭项目的Java开发。您推荐我使用哪些工具？（我更喜欢免费工具，因为这仅供家庭使用。）

我希望你能为我推荐一些工具，如果你能给我简要比较每个类别中的一些工具，我将不胜感激。例如，我正在考虑源代码控制和问题跟踪工具，但欢迎任何其他类别。

我还希望获得一些关于在建议的工具之间移动的信息（例如在 CVS 和 SVN 之间迁移），甚至在适用的操作系统之间移动。（我目前使用的是 Windows Vista，但我可能想尽快切换到 Linux。）甚至可能会提供有关将项目移至开源存储库（例如 SF.net）是多么容易的信息。

谢谢你。

（PS 任何关于如何增强/澄清我的问题的评论都非常受欢迎。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T22:32:56.843

这个问题太笼统了，但让我尝试一下：

Netbeans 或 Eclipse IDE。如果您进行 GUI 开发，我建议使用 Netbeans，否则使用 eclipse。

Git 或 Mercurial 作为 VCS。如果您正在处理大型代码库，或者如果您深入了解 UNIX 哲学，请选择 Git。如果您不想处理跨操作系统差异，请选择 Hg。

这些 IDE 中的任何一个都为您提供与源代码控制系统的集成，因此您只需在谷歌搜索即可。

至于开源，如果你使用Git，只需推送到github。如果您使用 Hg，请将其推送到 bitbucket 即可。

对于问题跟踪，我建议您托管与 CVS、SVN、Git、Mercurial 和其他一些集成的 Redmine（RoR 应用程序）。

如果您选择 Eclipse，您可以将其与 Mylyn 集成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T22:33:10.320

在免费工具领域，Eclipse 和 NetBeans 是主要的 IDE 竞争者。IDEA 也可免费用于开源开发，很多人都对它发誓。根据您的背景，您可能会发现 NetBeans 比 Eclipse 更直观。Eclipse 有一种看待世界的方式，这与许多其他 IDE 略有不同，尤其是如果您来自 Visual Studio 背景。这三者都对 CVS 和 SVN 以及集成调试器提供了良好的内置支持。

我个人喜欢Eclipse。我发现它比 NetBeans 响应速度更快、功能更强大。不过，NetBeans 在过去几年中取得了很大进展。

如果您要进行 Swing 开发，我会说 NetBeans 中的 GUI 编辑器比 Eclipse 中可用的任何东西都好。在 Web 服务开发领域，我使用 NetBeans 也取得了更大的成功。对于直接的 Java 代码，我仍然更喜欢 Eclipse。

在我看来，在源代码控制系统之间移动的问题是与开发环境不同的问题。移动代码，然后从新服务器中签出新副本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T22:33:12.303

我使用以下工具，并且很高兴在 Windows/OS X/Linux 之间轻松切换：

IDE

1.  Eclipse 3.4 集成开发环境。很多很棒的免费插件。它作为 IDE 有点慢，但我更喜欢 NetBeans
2.  NetBeans——另一个有很多插件的免费IDE。

版本控制 基本上人们现在使用的是 SVN、CVS 或 GIT。

*   用于版本控制的 SVN——它比 CVS 更成熟，现在似乎更多地被使用。与 Eclipse 有很好的集成。然而，就 sourceforge 而言，我认为它仍然使用 CVS，尽管还有其他可能使用 SVN 的开源托管。

*   尽管很多人已经转向 SVN，但 CVS 仍然得到很好的支持

*   Git 我自己没有使用过它，虽然我听说它获得了很大的吸引力并且比 SVN 更强大。

问题跟踪

*   我使用 Mantis，它实际上是基于 PHP 的。没关系，不是很好。

*   布吉拉

*   追踪

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T22:33:26.890

## 版本控制

我会推荐 SVN 而不是 CVS，尽管[Git](http://git-scm.com/)和[Mercurial](http://www.selenic.com/mercurial/wiki/)等分布式版本跟踪工具似乎在开源项目中非常流行。

导入公共存储库应该很容易；如果您不想保留修订历史，只需“导出”存储库的干净副本，然后将其签入新副本。

如果您确实想保留修订历史，可以使用克隆存储库的工具，尽管从一种类型转换为另一种类型可能会更棘手。

## 错误跟踪

最著名的系统可能是[Bugzilla——](http://www.bugzilla.org/)它是我自己在本地系统上使用过的唯一一个。其他人可能会推荐更好的单人跟踪器。Bugzilla 托管在 MySQL 数据库上，因此您应该能够轻松地将其移动到另一台服务器。不过，在错误跟踪系统之间移动可能需要更复杂的脚本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T09:47:05.953

除了 Eclipse 和 Subversion 之外，还有一些其他的东西。

[IcoFX-免费软件图标编辑器、](http://icofx.ro/) [Effective Java](http://java.sun.com/docs/books/effective/)、[Cygwin](http://www.cygwin.com/)、[VMWare Player](http://www.vmware.com/products/player/)（或[VMware Workstation](http://www.vmware.com/products/ws/)）、[CruiseControl](http://cruisecontrol.sourceforge.net/)和[SciTE-免费源代码编辑器](http://www.scintilla.org/SciTE.html)的副本。

# php - 可以从 PHP 中未实例化的对象中获取当前类的名称吗？

> ID：476763
> 
> 赞同：5
> 
> 时间：2009-01-24T22:20:19.770
> 
> 标签：php

我知道您可以正常使用 get_class($this) 但我需要在尚未实例化对象的静态函数中获取类的名称。

请参阅以下代码：

```
class ExampleClass
{
    static function getClassName()
    {
        echo get_class($this); // doesn't work unless the object is instantiated.
    }
}

$test1 = new ExampleClass();
$test1->getClassName(); // works

ExampleClass::getClassName(); // doesn't work 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T22:30:39.000

如果您希望从静态方法中获取类名，我认为您正在寻找 get_call_class() 函数。

有关更多信息，请参阅[get_call_class 文档](http://php.net/manual/en/function.get-called-class.php)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T22:29:13.153

我发现你可以使用 __CLASS__ 来获取类名。例子：

```
class ExampleClass
{
    static function getClassName()
    {
        echo __CLASS__;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T15:25:51.407

我的问题是，你是如何在不知道类名的情况下调用静态函数的？

我能想到的唯一两种方法是：

```
ExampleClass::getClassName(); //Hard Coded - the class name is hard and visible
$class = "ExampleClass";
$class::getClassName();       //Soft Coded - the class name is the value of $class 
```

如果我们知道您尝试拨打电话的背景，也许可以提供更好的解决方案？

# python - python字符串连接性能

> ID：476772
> 
> 赞同：15
> 
> 时间：2009-01-24T22:26:13.113
> 
> 标签：python, performance, string

网上有很多关于 python 性能的文章，你读的第一件事是：concatenating strings should not be done using '+': Avoid s1+s2+s3, instead use str.join

我尝试了以下方法：将两个字符串连接为目录路径的一部分：三种方法：

1.  '+' 我不应该做的
2.  str.join
3.  os.path.join

这是我的代码：

```
import os,time

s1='/part/one/of/dir'
s2='part/two/of/dir'
N=10000

t=time.clock()
for i in xrange(N):
    s=s1+os.sep+s2
print time.clock()-t

t=time.clock()
for i in xrange(N):
    s=os.sep.join((s1,s2))
print time.clock()-t

t=time.clock()
for i in xrange(N):
    s=os.path.join(s1,s2)
print time.clock()-t 
```

这里的结果（python 2.5 WinXP）

```
0.0182201927899
0.0262544541275
0.120238186697 
```

不应该正好相反吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-24T22:32:32.647

字符串连接的大多数性能问题都是渐近性能问题，因此当您连接许多长字符串时，差异变得最显着。在您的示例中，您多次执行相同的连接。您没有构建任何长字符串，可能是 python 解释器正在优化您的循环。这可以解释为什么当您移动到 ​​str.join 和 path.join 时时间会增加 - 它们是更复杂的函数，不容易减少。（os.path.join 对字符串进行了大量检查，以查看它们是否需要在连接之前以任何方式重写。为了可移植性，这牺牲了一些性能。）

顺便说一句，由于文件路径通常不是很长，因此为了可移植性，您几乎肯定要使用 os.path.join。如果连接的性能有问题，那么您的文件系统正在做一些非常奇怪的事情。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-24T23:43:59.883

建议是关于连接很多字符串。

计算 s = s1 + s2 + ... + sn，

1）使用+。一个新的字符串 s1+s2 被创建，然后一个新的字符串 s1+s2+s3 被创建，……等等，因此涉及到大量的内存分配和复制操作。实际上，s1 被复制了 n-1 次，s2 被复制了 n-2 次，...，等等。

2) 使用 "".join([s1,s2,...,sn])。连接是一次性完成的，字符串中的每个字符只复制一次。

In your code, join is called on each iteration, so it's just like using +. The correct way is collect the items in an array, then call join on it.

edit: fixed the typo

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-24T22:32:25.610

确实，您不应该使用“+”。您的示例非常特殊，请尝试使用相同的代码：

```
s1='*'*100000
s2='+'*100000 
```

然后第二个版本（str.join）要快得多。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-24T22:33:59.743

> 不应该正好相反吗？

不必要。我不太了解 Python 的内部结构，无法具体评论，但一些常见的观察结果是，您的第一个循环使用了一个简单的运算符`+`，它可能由运行时作为原语实现。相反，其他循环首先必须解析模块名称，解析在那里找到的变量/类，然后在其上调用成员函数。

另一个注意事项是您的循环可能太小而无法产生大量数字。考虑到您的整体运行时间较短，这可能会使您的测试毫无用处。

此外，您的测试用例在两个短字符串上高度专业化。这种情况永远无法清楚地了解边缘情况的性能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T00:00:58.473

String concatenation (`+`) has an optimized implementation on CPython. But this may not be the case on other architectures like Jython or IronPython. So when you want your code to performe well on these interpreters you should use the `.join()` method on strings. `os.path.join()` is specifically meant to join filesystem paths. It takes care of different path separators, too. This would be the right way to build a file name.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-11T16:18:24.387

我想添加一个指向 python wiki 的链接，其中有关于字符串连接的注释，并且“*本节在 python2.5 中有些错误。Python 2.5 字符串连接相当快*”。

我相信字符串连接自 2.5 以来有了很大的改进，尽管 str.join 仍然更快（特别是对于大字符串），但您不会看到与旧 Python 版本一样多的改进。

[http://wiki.python.org/moin/PythonSpeed/PerformanceTips#StringConcatenation](http://wiki.python.org/moin/PythonSpeed/PerformanceTips#StringConcatenation)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-11-26T10:13:09.873

尝试在 2020 年使用 Python 3.9 再次进行相同的测试，`join`速度仍然很快，但简单的连接也有了一些改进：

```
from io import StringIO
from array import array

loop_count = 10000
strings = [str(num) for num in range(loop_count)]
bytestrings = [b'%d' % num for num in range(loop_count)]

# 1.1453419709578156 seconds for 1000 repetitions (fastest of 5)
def concat():
  out = ''
  for s in strings:
    out += s
  return out

# 1.468063525040634 seconds for 1000 repetitions
# Removing decode() does not make it faster
def bytearray():
  out = array('b')
  for b in bytestrings:
    out.frombytes(b)
  return out.tobytes().decode()

# 0.9110414159949869 seconds for 1000 repetitions
def join():
  # I am rebuilding the list on purpose: I don't want to include
  # the overhead of printing numbers, but I do want to include
  # the overhead of building the list
  str_list = []
  for s in strings:
    str_list.append(s)
  return ''.join(str_list)

# 1.174764319031965 seconds for 1000 repetitions
def stringio():
  io = StringIO()
  for s in strings:
    io.write(s)
  return io.getvalue() 
```

# php - 搜索两个表

> ID：476774
> 
> 赞同：6
> 
> 时间：2009-01-24T22:27:05.043
> 
> 标签：php, mysql, sql

我目前有以下两个表：

```
CREATE TABLE files_list
(
    'listid' INT, 
    'name' VARCHAR(25), 
    'synonym' VARCHAR(25), 
    'description' VARCHAR(25)
);

CREATE TABLE files_tags
(
    'tag_name' VARCHAR(25), 
    'listid' INT
); 
```

如果有人使用关键字“龙珠”，目前，我使用以下查询来搜索 my_list 以查找可能的匹配项：

```
SELECT * 
FROM files_list
WHERE name LIKE '%dragon%' 
OR synonym LIKE '%dragon%' 
OR description LIKE '%dragon%' 
OR name LIKE '%ball%' 
OR synonym LIKE '%ball%' 
OR description LIKE '%ball%' 
```

我不确定如何使用一个查询来搜索两个表。我想在搜索结果中向用户显示以下数据：名称、同义词、描述和所有标签。

**我的问题** 1\. 有没有办法让当前的 mysql 查询更短？2.我怎样才能将它与`files_tags`表结合起来， - 以显示`files_list`在 中匹配`files_tags`但在 中不匹配的行`files_list`？- 显示在files_tags`files_list`中有匹配的行？`files_list, but may not in`

[您可以在http://hsbsitez.com/](http://hsbsitez.com/)查看当前显示的结果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-16T13:37:27.140

加入表格会更有意义。

```
SELECT name, synonym, description, tag_name FROM `files_list` WHERE ( name LIKE '%dragon%' OR synonym LIKE '%dragon%' OR description LIKE '%dragon%' OR name LIKE '%ball%' OR synonym LIKE '%ball%' OR description LIKE '%ball%' )
OUTER JOIN files_tags on files_tags.listid = files_list.listid 
```

`OUTER JOIN`将确保选择所有标签，当每个 id 有多个标签可用时，这将创建重复的行，唯一的区别是标签

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T04:41:08.057

使用联合实际获取每个联合查询所需的列时要小心。在这种情况下，子查询似乎更有意义：

```
SELECT name, synonym, description FROM files_list WHERE
       name LIKE '%dragon%' OR synonym LIKE '%dragon%' OR description LIKE '%dragon%'
       OR name LIKE '%ball%' OR synonym LIKE '%ball%' OR description LIKE '%ball%'
       OR listid IN (SELECT listid FROM files_tags WHERE tag_name='dragon' OR tag_name='ball'); 
```

一些额外的问题：当你说你想向用户显示“所有标签”时，你的意思是给定 listid 存在的所有标签吗？或者只是那些匹配的？如果描述像“%dragon%”，那么即使它不在 file_tags 中，dragon 是否也是您想要返回的标签之一？

# php - 加载 PHP 模块时出错

> ID：476793
> 
> 赞同：0
> 
> 时间：2009-01-24T22:33:47.997
> 
> 标签：php, windows, apache

我在 Windows XP SP 3 上的 Apache 2.2.11 上运行 PHP 5.2.8。在 php.ini 中，

```
extension_dir = "C:\Program Files\PHP\ext"
extension=php_mysql.dll 
```

在错误日志中：

```
PHP Warning:  PHP Startup: Unable to load dynamic library 'C:\\Program Files\\PHP\\ext\\php_mysql.dll' - The specified module could not be found.\r\n in Unknown on line 0 
```

php_mysql.dll 肯定位于 extension_dir 中，并且是 PHP 5.2.8 捆绑的版本。这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T23:02:10.573

尝试在路径中添加**斜杠。**`extension_dir`

这是我在 WAMP 设置中使用的：

```
extension_dir = "D:\php\ext\"
; ...snip...
extension=php_gd2.dll 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T22:37:36.553

你可以试试

extension_dir = "C:/Program Files/PHP/ext"

编辑：不，不是那样。似乎您需要将其添加到 Windows 中的 PATH 变量中：http: [//us2.php.net/manual/en/install.windows.iis.php](http://us2.php.net/manual/en/install.windows.iis.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T12:35:00.293

您需要使 MySQL 客户端库可用于 PHP。这是通过将 libmysql.dll 文件从 PHP 包根目录复制到系统上 Windows PATH 中的目录来完成的。

最快的方法是将 libmysql.dll 复制到您的 C:\Windows\System 目录中，但如手册中所述，不建议这样做，这只是一个快速修复，看看它是否真的是这里的问题。

[http://us2.php.net/manual/en/mysql.installation.php](http://us2.php.net/manual/en/mysql.installation.php)说：

> 默认情况下不再启用 MySQL，因此必须在 php.ini 中启用 php_mysql.dll DLL。此外，PHP 需要访问 MySQL 客户端库。Windows PHP 发行版中包含一个名为 libmysql.dll 的文件，为了让 PHP 与 MySQL 对话，该文件需要在 Windows 系统 PATH 中可用。有关如何执行此操作的信息，请参阅标题为“如何将我的 PHP 目录添加到 Windows 上的 PATH”的常见问题解答。虽然将 libmysql.dll 复制到 Windows 系统目录也可以（因为系统目录默认在系统的 PATH 中），但不建议这样做。

最好的选择是[将 PHP 目录添加到您的 Windows PATH 中，此常见问题解答中对此进行了说明](http://us2.php.net/manual/en/faq.installation.php#faq.installation.addtopath)。

# c# - C# asp.net 无法打开用户默认数据库.ldf 可能不正确

> ID：476797
> 
> 赞同：0
> 
> 时间：2009-01-24T22:37:01.420
> 
> 标签：c#, asp.net, sql-server-express

我的 SQL Server express 2005 DB 有一个奇怪的问题。它在 2003 服务器上运行。使用 VS2005 我可以毫无问题地访问数据库。但是当我尝试运行应用程序时，我得到：

```
 Cannot open user default database. Login failed.  Login failed for user 'NT AUTHORITY\NETWORK SERVICE'......... .ldf may be incorrect. 
```

我已确保 NETWORK SERVICE 具有对网站文件夹及其所有子文件夹的完全访问权限。

我注意到，当我查看 App_Data 的属性时，它的只读属性上有一个灰色勾号。.MDF 文件不是只读文件，但我无法删除此灰色勾号。我试过点击它直到它消失并应用更改，我试过 ATTRIB *。*-r 但似乎没有任何改变。

我很迷茫。

乔恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T11:49:32.787

您实际上是在使用 SQL Server Express 的实例，还是仅使用 App_Data 文件夹中的数据库文件？

如果您使用的是 SQL Server 实例并且您安装了[SQL Server Management Studio Express](http://go.microsoft.com/fwlink/?LinkId=65110)，您将执行类似这样的操作来授予“网络服务”帐户访问数据库的权限（考虑一下，您应该可以指向 Management Studio在 App_Data 文件夹中的 mdf 中，做同样的事情）：

1.  打开 SQL Management Studio，连接到您的数据库并在对象资源管理器中打开它。
2.  在服务器级别 (MachineName\SQL Express) 展开“安全”部分 - 检查用户尚未在下面的“登录”部分中。
3.  如果没有，请右键单击“登录”，“新建登录...”
4.  确保登录类型设置为“Windows 身份验证”，然后您可以：
    1.  点击“Search...”，然后点击“Advanced...”，然后点击“Find now”，双击“NT Service”，点击“Ok”下一个对话框。
    2.  只需在“登录名：”框中输入“NT Authority\Network Service”即可。
5.  然后，在“用户映射”页面（从左侧窗格中选择）中，在您希望该用户访问的数据库旁边打勾。
6.  如果您有数据库角色（例如，如果此数据库安装了默认的 ASP.NET 成员资格/角色/配置文件表等），请确保为用户提供正确的角色 - 例如“aspnet_Membership_BasicAccess”。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-23T05:43:15.800

刚遇到这个问题。我们在 App_Data 文件夹中使用了一个数据库文件。

“看来我的数据库仍然在我的 IDE（Visual Web Developer Express）中打开，在数据库资源管理器中。右键单击数据库并选择“关闭连接”修复它。“

（感谢[asp.net 论坛](http://forums.asp.net/t/939300.aspx)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T22:52:07.507

区别与文件夹上的 ACL 无关，而是与安全上下文映射到数据库中的用户这一事实有关。您的数据库可能会为您的用户帐户映射到 dbo。

如果网络服务帐户要使用数据库，您需要在数据库中创建一个用户以映射到机器帐户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T12:38:59.020

我猜你正在运行一个非英语操作系统。

不知何故，无论出于何种原因，当操作系统被翻译成其他语言时，网络服务的登录名有时会被本地化。

现在很多程序都希望将登录名硬编码为“NT AUTHORITY\NETWORK SERVICE”——例如在德语版本的 Windows 中，帐户的名称是“NT-AUTORITÄT\NETZWERKDIENST”。所以你的程序正在寻找英文名称，找不到它，并显示错误。

甚至一些微软程序在安装时也会遇到这个陷阱并显示这样的错误！

# c++ - 比较两个整数而不进行任何比较

> ID：476800
> 
> 赞同：12
> 
> 时间：2009-01-24T22:37:57.550
> 
> 标签：c++, if-statement, comparison

是否可以在不进行任何比较的情况下找到两个整数中的最大值？我找到了一些解决方案：

```
if(!(a/b)) // if a is less than b then division result will be zero.
{
    cout << " b is greater than a";
}
else if (!(a-b)) // we know a is greater than or equal to b now.  check whether they are equal.
{
    cout << "a and b are equal";
}
else
    cout << "a is greater than b"; 
```

但是 if(c) 或 if(!c) 是与零的比较。此外，它不适用于负数。事实上，我需要一个避免任何 if 语句的解决方案。相反，我应该使用 switch 语句和算术运算符。比X。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-24T22:55:35.767

减去它们并使用讨厌的小技巧检查标志
[http://graphics.stanford.edu/~seander/bithacks.html](http://graphics.stanford.edu/~seander/bithacks.html)

如果其他程序员知道你住在哪里，不要在生产代码中这样做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-24T23:32:07.723

这是一个没有任何条件分支的有趣的小游戏版本。

```
int g = (int)"greater";
int l = (int)"less";
int e = (int)"equal";

int a = 7;
int b = 10;

char *result = (char*)((((a - b) >> 31) & l) | (((b - a) >> 31) & g) | ((~((a - b) | (b - a))) >> 31) & e);
cout << result; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T22:55:31.400

到目前为止，问题中提供的任何样本或任何答案都不能防止被零除。你到底为什么要避免使用“if”语句？我怀疑关于 ?: 操作员的作业问题。

```
cout << "Maximum is: " << ((a>b)?a:b) 
```

我们去吧。

没有比较就不可能比较两个数字。您可以捏造它并进行间接操作，但归根结底，您是在比较某些东西。相信编译器会优化代码并选择最佳操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T22:58:11.050

您可能会利用这样一个事实，即计算的符号`a - b`取决于哪个数字更大。这在许多比较的实现中使用。但我相信你永远无法完全避免比较。在这种情况下，您至少还需要评估处理器上标志标志的内容。

如果您只需要显示较小的数字，您还可以使用算术技巧：

```
result = ((a + b) - sqrt((a - b) * (a - b))) / 2 
```

**编辑**erm ...您可以使用`switch`吗？

> 我应该使用 switch 语句和算术运算符。

`switch`与链式基本相同，`if`因此它也使用比较。这听起来好像您确实应该与零进行比较以查看符号的含义`a - b`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T23:21:01.583

```
char c;
c=0x3D + (!(b/a) && (a-b)) - (!(a/b) && (a-b));
printf("a %c b",c); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T22:41:38.790

```
(!(a/b) ?  cout << " b is greater than a" : (!(b-a) ? cout << "a and b are equal" :  cout << "a is greater than b") :  cout << "a is greater than b"); 
```

虽然有点乱

编辑：这是作业吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-24T22:51:37.523

我只是看不出有什么好的理由这样做：没有“如果”谁愿意编程？

一个可能的答案是：

( ( a + b ) + abs ( a -b ) ) / 2

我猜“abs”只是在某处隐藏了一个“if”，就像三元运算符只是“if”的另一个名称......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-24T23:25:53.693

错误的想法：使用函数指针数组。然后通过一些算术和按位运算获得该数组的索引。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-25T00:43:41.570

作为一个毫无意义的练习，这里有一种实现`cond`函数的方法——为了达到 的目的`if`，假设它（和`switch`、和`?:`）不知何故从语言中消失了，而你正在使用 C++0x。

```
void cond(bool expr, std::function<void ()> ifTrue, std::function<void ()> ifFalse)
{
    std::function<void ()> choices[2] = { ifTrue, ifFalse };
    choices[expr == false]();
} 
```

例如

```
cond(x > y,
    /*then*/ [] { std::cout << "x is greater than y"; },
    /*else*/ [] { std::cout << "x is not greater than y"; }); 
```

就像我说的，毫无意义。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-10-14T18:24:53.620

试试这个，测试它，效果很好。

```
public static int compare(int a, int b)
{
    int c = a - b;
    return (c >> 31) & 1 ^ 1;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-06-21T18:06:52.823

我认为这种方法比其他方法更好，您可以使用这种逻辑 c 和 java 两种编程语言，但如果 int 为 2 字节，则 int 应为 4 字节，然后右移 15 字节而不是 31 字节。

```
enter code here

#include<stdio.h>

main()
{
   int a, b;
   printf("Enter three numbers\n");
   scanf("%d %d", &a, &b);
   printf("Largest number is %d \n",findMax( a,b ));
}
int findMax( int x, int y)
{
  int z = x - y;
  int i  = (z  >>  31)  &  0x1;
  printf("i = %d shift = %d \n", i, (z>>31));
  int  max  =  x - i  *  z;
  return max;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-03-09T20:56:39.867

在不使用比较/关系运算符的情况下获得最大数

```
void PrintGreatestNumber(int a, int b)
{
   int [] x = new int[] { -1, 0, 1 };
   int greatestNumber =  ((a+b)+ x[ 1 + ((a-b) >> 31) - (-(a-b) >> 31)] * (a-b)) /2;  
   Console.WriteLine(greatestNumber);
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-09-14T18:33:37.637

**您可以使用函数**来检查相等或不使用 xor 位运算符。在这里，您可以将此函数编写为：

```
int Check(int a, int b){
    return (a^b);
} 
```

如果两个整数相同，此函数将返回 0，否则不返回。

在这里，包括一个例子来理解这个功能。

> 让两个整数作为 a = 1, b= 2
> 
> 1 的位是 --> 00000001 和 2 的位是 --> 00000010

如果我们在这里应用异或运算，我们将得到 00000000 的结果，即整数 0。因为异或运算是：

```
1 xor 1 = 0
1 xor 0 = 1
0 xor 1 = 1
0 xor 0 = 0 
```

**另一种方法**是减去数字

```
int Check(int a, int b)
{
   return abs(a-b);
} 
```

这里的逻辑将和以前一样工作。如果我们得到 0 那么它应该是相等的，否则不是！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-12-12T03:19:01.100

假设 X 和 Y 是两个输入。X>Y 将是：((X+Y)+ abs(XY))/2 并且 X<Y 将是：((X+Y)- abs(XY))/2

现在你可以从#include<math.h> 得到abs()，它实际上返回绝对值。

干杯!

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2009-01-24T23:07:07.147

```
void greater(int a, int b) {
    int c = a - b;
    switch(c) {
        case 0:
            cout << "a and b are equal" << endl;
            break;
        default:
            int d = c & (1<<31);
            switch(d) {
                case 0:
                    cout << "a is bigger than b" << endl;
                    break;
                default:
                    cout << "a is less than b" << endl;
            }
    }
} 
```

# sql - 大查询和子查询的问题

> ID：476810
> 
> 赞同：1
> 
> 时间：2009-01-24T22:42:41.083
> 
> 标签：sql, mysql

我以为我会很聪明，使用子查询一口气得到我的[报告](https://stackoverflow.com/questions/470992/how-to-count-number-of-different-items-in-sql#471152)。但是在遇到问题并阅读文档后，我发现我的方法在 MySQL 中不起作用。我的内部查询返回约 100 条记录，外部查询扫描 20000 条记录。当我将外部查询限制为 20 条记录时，它运行 20 秒 - 真的很慢。

我想知道是否有可能以某种方式对其进行重组，以便不会每次都为外部查询中的每条记录运行内部查询？

```
select p1.surname ,p1.name,p1.id,r1.start_date,r1.end_date,c1.short_name
FROM ejl_players p1
left JOIN ejl_registration r1 ON ( r1.player_id = p1.id )
left JOIN ejl_teams t1 ON ( r1.team_id = t1.id )
left JOIN ejl_clubs c1 ON ( t1.club_id = c1.id )
where  r1.season=2008
and p1.id in
 (
SELECT p.id
FROM ejl_players p 
left JOIN ejl_registration r ON (r.player_id = p.id) 
left JOIN ejl_teams t ON (r.team_id = t.id) 
left JOIN ejl_clubs c ON (t.club_id = c.id)
WHERE r.season = 2008
GROUP BY p.id
HAVING COUNT(DISTINCT c.id)  > 1
) 
```

解释（我将外部查询限制为最多 20 条记录：

```
id  select_type  table  type  possible_keys  key  key_len  ref  rows  Extra  
1 PRIMARY p1 range PRIMARY PRIMARY 4 NULL 19 Using where 
1 PRIMARY r1 ref team_id,season season 10 const,d17528sd14898.p1.id 1 Using where 
1 PRIMARY t1 eq_ref PRIMARY PRIMARY 4 d17528sd14898.r1.team_id 1   
1 PRIMARY c1 eq_ref PRIMARY PRIMARY 4 d17528sd14898.t1.club_id 1   
2 DEPENDENT SUBQUERY p index PRIMARY PRIMARY 5 NULL 23395 Using index 
2 DEPENDENT SUBQUERY r ref team_id,season season 10 const,d17528sd14898.p.id 1 Using where; Using index 
2 DEPENDENT SUBQUERY t eq_ref PRIMARY PRIMARY 4 d17528sd14898.r.team_id 1   
2 DEPENDENT SUBQUERY c eq_ref PRIMARY PRIMARY 4 d17528sd14898.t.club_id 1 Using index 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-25T00:46:29.163

尝试使用 INNER JOIN（类似这样）：

```
SELECT p1.surname ,p1.name,p1.id,r1.start_date,r1.end_date,c1.short_name
FROM ejl_players p1
INNER JOIN (
    SELECT p.id
    FROM ejl_players p 
    LEFT JOIN ejl_registration r ON (r.player_id = p.id) 
    LEFT JOIN ejl_teams t ON (r.team_id = t.id) 
    LEFT JOIN ejl_clubs c ON (t.club_id = c.id)
    WHERE r.season = 2008
    GROUP BY p.id
    HAVING COUNT(DISTINCT c.id)  > 1
) p2 ON p1.id = p2.id
LEFT JOIN ejl_registration r1 ON ( r1.player_id = p1.id )
LEFT JOIN ejl_teams t1 ON ( r1.team_id = t1.id )
LEFT JOIN ejl_clubs c1 ON ( t1.club_id = c1.id )
WHERE  r1.season=2008 
```

以这种方式使用子查询应该更有效，但并非总是如此。但是，它确实绕过了对主查询中返回的每条记录执行子查询的问题。相反，子查询被构造为内存中的虚拟表，然后用于与主查询进行比较。

**编辑：**我应该指出，您需要在 MySQL 中使用 EXPLAIN 来验证此查询确实执行得更有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T01:54:50.460

就像我前几天评论你的[问题](https://stackoverflow.com/questions/470992/how-to-count-number-of-different-items-in-sql)一样，在这个例子中你不需要使用 LEFT JOIN。外连接的执行速度通常比内连接慢，因此您可以通过使用简单的内连接来获得更好的性能。

仅当您需要显示所有玩家时才需要使用外部连接，即使是那些*没有*任何注册的玩家。

您的查询似乎是在寻找今年曾在多个俱乐部效力的球员（就像您之前的问题一样），然后输出他们的注册和俱乐部名称的一些详细信息。以下是我将如何解决此查询：

```
SELECT p.surname, p.name, p.id, r.start_date, r.end_date, c1.short_name
FROM ejl_players p
 INNER JOIN ejl_registration r1 ON (r.player_id = p.id)
 INNER JOIN ejl_teams t1 ON (r.team_id = t1.id)
 INNER JOIN ejl_clubs c1 ON (t1.club_id = c1.id)
 INNER JOIN ejl_teams t2 ON (r.team_id = t2.id)
 INNER JOIN ejl_clubs c2 ON (t2.club_id = c2.id)
WHERE r.season = 2008
GROUP BY r.player_id, r.team_id
HAVING COUNT(DISTINCT c2.id) > 1; 
```

这在 MySQL 中有效，因为 MySQL 允许使用单值规则。也就是说，GROUP BY 子句中的列不必与选择列表中命名的非聚合列相同。在其他品牌的 RDBMS 中，此查询会产生错误。

# .net - asp.net AJAX 页面方法非常安全吗？

> ID：476811
> 
> 赞同：3
> 
> 时间：2009-01-24T22:42:49.287
> 
> 标签：.net, jquery, asp.net-ajax

我们目前正在考虑应用程序的安全性。

我们从后端获取数据的首选方法是使用 jQuery AJAX 函数直接访问带有页面方法的 .aspx 页面（不使用脚本管理器），正如 Dave Ward 在这里所描述的那样......

[http://encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/](http://encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/)

所以，我的问题是，这有多安全？

我读过一些关于 XSS 和同源策略等的内容。这些都是由 ASP.NET 自动处理的，还是我们必须明确地做一些事情来确保我们的应用程序安全？

谢谢，乔恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-25T00:25:31.920

ASP.NET 不会自动转义 XSS 或设置 cookie 以防止 CSRF，您需要

维基百科在这两个方面都有很好的页面： http: [//en.wikipedia.org/wiki/Cross-site_scripting](http://en.wikipedia.org/wiki/Cross-site_scripting) [http://en.wikipedia.org/wiki/CSRF](http://en.wikipedia.org/wiki/CSRF)

Microsoft 有[一篇关于防止 CSS 的文章](http://msdn.microsoft.com/en-us/library/ms998274.aspx)，但我无法找到处理 CSRF 的待办事项。

# image - 使用 netpbm 放大图像

> ID：476812
> 
> 赞同：0
> 
> 时间：2009-01-24T22:43:19.210
> 
> 标签：image, image-processing, image-manipulation

我有一个 72 dpi 的 tiff，我正在尝试将其升级到 300 dpi 的 tiff。我可以在 Gimp 甚至内置预览的 OS X 等图像程序中执行此操作。出于某种原因，我似乎无法弄清楚如何在 netbpm 中做到这一点。我尝试了以下命令行：

tifftopnm < sample1.tif | pamditherbw -threshold -value 0.5 | pamscale 4.2 | pamtopnm | pnmtotiff > sample1.out.tif

这会生成一个是原始图像大小的 4.2 倍的图像，但输出仍然是 72 dpi。如何使用 netbpm 增加图像的实际像素/英寸，或者甚至可能？我也尝试过 pamenlarge，它给出了相同的结果。我还为 pnmtotiff 使用了 -xresolution 和 -yresolution 参数，它似乎只是更改了分辨率的标签，但实际上并没有放大图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-25T04:13:46.623

好吧，我无法用 netpbm 完全解决这个问题，所以我切换到 ImageMagick，它相当简单。我在图像魔法中试图实现的目标：

转换 sample1.tif -resample 300 -threshold 50% sample1.out.tif

# apache-flex - Flex/AS3：何时移除监听器？

> ID：476813
> 
> 赞同：8
> 
> 时间：2009-01-24T22:43:30.143
> 
> 标签：apache-flex, actionscript-3

我有一个 FileReference 对象数组，每个对象都附加了几个侦听器，我应该在其处理程序方法中删除每个侦听器，还是应该在完整的处理程序中将它们全部删除？

我在某处读到对侦听器使用弱引用，但我认为显式删除侦听器会更好（是吗？/否？）

```
for each(var f:Object in fileCollection){
   var myFile:FileReference = f.file; 
   myFile.addEventListener(DataEvent.UPLOAD_COMPLETE_DATA, onUploadCompleteData)
   myFile.addEventListener(ProgressEvent.PROGRESS, onProgress);
   myFile.addEventListener(IOErrorEvent.IO_ERROR, onError);
   myFile.addEventListener(Event.COMPLETE, onComplete);
 }

 private function onUploadCompleteData(e:DataEvent):void{
   // doin my thing here
   removeListeners(e)
 }

 private function removeListeners(e:Event):void{
   var myFile:FileReference = FileReference(e.target)
   myFile.removeEventListener(DataEvent.UPLOAD_COMPLETE_DATA, onUploadCompleteData)
   myFile.removeEventListener(ProgressEvent.PROGRESS, onProgress);
   myFile.removeEventListener(IOErrorEvent.IO_ERROR, onError);
   myFile.removeEventListener(Event.COMPLETE, onComplete);
 } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-24T23:00:21.843

当您不再需要听众时，明确删除他们总是一个好主意，是的，而且您这样做的方式很好。这可能看起来有点冗长，但它仍然是一个很好的做法，它让你养成知道听众在哪里的习惯，因为不知道经常会导致泄漏和意外行为。

至于 useWeakReference，我几乎总是自己使用它，除了删除不需要的侦听器。对我来说，它已成为规则而不是例外。但是，如果您必须选择一个，请明确删除您的听众。不过，就我个人而言，我两者都做。

事实上，我发现最好将 useWeakReference 设置为 false 的次数，因为这样做会阻止对象被垃圾收集，这种情况尤其罕见。确实，在我了解该论点的用途之前（[此处的博客文章](http://chris.enunciato.org/entry.aspx?id=542)），在收到源自 Flex 框架调用组件的运行时异常之后，我花了很多时间挠头，我确信我已从显示列表中删除。

Deepa Subramaniam在去年的 MAX 会议上的[组件模型演讲](http://tv.adobe.com/#vi+f15384v1002)中间接提到了它（非常值得一试的精彩演讲）；我相信她所说的方式类似于，“我不知道为什么 Flash 播放器团队选择将 false 作为默认值而不是 true，但 99% 的时间，你会想要将该值设置为真的。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T23:01:35.887

如果您要向 DisplayObject 添加对象，我建议您在 Event.REMOVED_FROM_STAGE 事件触发时移除侦听器，并在将其添加到舞台时添加它们。这是一种确保侦听器被删除的简单方法，并且必须显式调用您编写的 removeListeners 函数。例如，在您的代码段中，如果加载失败，则永远不会删除侦听器。

# javascript - 如何通过 javascript 访问屏幕显示的 DPI 设置？

> ID：476815
> 
> 赞同：57
> 
> 时间：2009-01-24T22:46:06.147
> 
> 标签：javascript, dpi, display-dpi

有没有办法在 Javascript 函数中访问屏幕显示的 DPI 设置？

我试图在页面上放置一个 HTML 面板，当用户的 DPI 设置为大 (120) 时，它会关闭该位置。我需要能够知道 DPI 是什么，以便我可以相应地调整位置。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-08T08:14:44.013

看起来您可以在 IE 中使用“屏幕”DOM 对象，它具有 deviceXDPI、deviceYDPI、logicalXDPI、logicalYDPI 的属性。

[https://www.w3schools.com/jsref/obj_screen.asp](https://www.w3schools.com/jsref/obj_screen.asp)

这是来自[http://www.webdeveloper.com/forum/showthread.php?t=175278](http://www.webdeveloper.com/forum/showthread.php?t=175278)的解决方案 （我没有尝试过，似乎完全是 hack :) 只需创建 1 英寸宽的东西并以像素为单位进行测量！

```
console.log(document.getElementById("dpi").offsetHeight);
```

```
#dpi {
    height: 1in;
    left: -100%;
    position: absolute;
    top: -100%;
    width: 1in;
}
```

```
<div id="dpi"></div>
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-01-25T01:59:43.697

首先，为了帮助解决与术语 DPI（每英寸点数）可能（并且非常常见）的混淆：

DPI 不完全是“显示设置”的一部分。它在两种不同的情况下（误用）：

1.  显示器（或视频）每英寸的原生像素。它决定了像素有多小。您可以在 14" 笔记本电脑屏幕和 17" LCD 显示器上拥有相同的 1024x768 分辨率。前者大致为 1280/14 = 91 DPI，后者大致为 1280/17 = 75 DPI。屏幕的 DPI 是不可变的；它不能通过显示设置进行更改。[更多的...](http://en.wikipedia.org/wiki/Dots_per_inch#DPI_measurement_in_video_resolution)
2.  打印过程中在纸上绘制的每英寸点数。这是打印机/复印机/传真机可以在一英寸纸上打印的并排点数。大多数打印机可以设置为以较低的 DPI 打印，只需将每个点打印为两个、四个等点。[更多的...](http://en.wikipedia.org/wiki/Dots_per_inch#DPI_measurement_in_printing)

打印图像时，有很多因素会影响纸张上图像的最终尺寸：

*   源图像的尺寸——这是像素或数据的数量。
*   源图像的 DPI。此值确定打印图像时应如何解释尺寸。
*   如果源图像没有嵌入 DPI 信息（JPEG 可以有，GIF 从来没有），正在使用的程序可能具有指定 DPI 的设置。这可以是图像查看器/编辑器，甚至是 Web 浏览器。
*   通常在打印对话框中指定的缩放系数。
*   打印机的当前 DPI 设置。
*   打印机的物理（最大）DPI。

最重要的是，您正在打印的图像将有效地重新采样（缩小或放大）以匹配打印过程中使用的最终 DPI。任何相关方都可能导致此问题（程序、打印驱动程序、打印机）。

~~现在，回到你的问题。不，您无法确定屏幕的 DPI，因为它不在软件域中。这是一个硬件领域术语，描述了用户可以购买多大的显示器。~~ **更新：**我最初在 2009 年写了这个答案，我对当前技术的理解。正如@thure 指出的那样，您现在（从 2012 年开始？）可以使用[window.matchMedia](https://developer.mozilla.org/en-US/docs/DOM/window.matchMedia)函数来确定屏幕的 DPI。

如果您尝试在打印 HTML 布局时达到精度，正如其他人所建议的那样，您的 CSS 应使用 em、pt 或 pc 等打印尺寸而不是 px。但是，最终结果可能仍取决于使用的浏览器。如果您可以选择将 HTML 转换为 PDF（或从头开始生成 PDF），那么打印 PDF 将为您在屏幕和纸张上提供最真实的所见即所得。

*   [对dpi的误解](http://www.dpiphoto.eu/dpi.htm)
*   [DPI、PPI、像素 - 事实和谬误](http://www.unleash.com/knpepper/dpi/)

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2016-06-02T20:51:45.133

您可以使用该[`window.devicePixelRatio`](https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio)属性来获取屏幕/页面的缩放比例。这在当前桌面（Windows）上的 IE、Edge、Chrome 和 Firefox 中运行良好，但它似乎不是当前的标准。它在我的台式电脑上用传统显示器返回 1，在 Surface 上用 200% 缩放返回 2。这些天的值应该在 1.0 到 3.0 之间。我可以使用它来校正动态图像投放大小，以在高分辨率屏幕上提供更清晰的图像。

如果您需要一些逻辑 dpi/ppi，请将该值乘以 96。不过，它不是实际的物理 ppi，而是操作系统对待它的方式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-25T01:18:00.113

我不知道有一种方法，但是，它们可能是另一种解决方案：

在“pt”和“em”中指定您的测量值，它们是屏幕相关指标。

**[http://www.w3schools.com/cssref/css_units.asp](http://www.w3schools.com/cssref/css_units.asp)**

**[https://css-tricks.com/the-lengths-of-css/](https://css-tricks.com/the-lengths-of-css/)**

> *   em：
>     `1em`等于当前字体大小。`2em`表示当前字体大小的 2 倍。例如，如果一个元素以 字体显示`12 pt`，`'2em'`则为`24 pt`。在`'em'`CSS 中是一个非常有用的单位，因为它可以自动适应读者使用的字体
> *   pt：
>     点（`1 pt`与 相同`1/72 inch`）
> *   pc：
>     异食癖（`1 pc`同`12 points`）

# entity-framework - 实体框架：在运行时添加属性/实体

> ID：476816
> 
> 赞同：7
> 
> 时间：2009-01-24T22:46:17.610
> 
> 标签：entity-framework

我想使用实体框架。但是，我还需要允许我的用户在我们的系统中定义自定义字段。我想仍然使用实体框架，而不是使用带有哈希表属性的部分类。

以下是我正在考虑的解决方案，但它并不简单，所以我想看看是否有更好的方法。

我目前的想法是拥有一个 ModelManager 对象，该对象将在适当的表上创建一个列，修改 EDM 文件，并使用 edmgen.exe 编译文件。这一切都必须发生在与应用程序不同的进程和/或 appdomain 中，因为应用程序将引用生成的程序集。当应用程序重新启动时，它将可以访问新添加的字段。

这是使用实体框架执行此操作的唯一方法吗？谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T20:19:29.317

在阅读了 Entity Framework 团队和 Julie Lerman 的一些博客文章之后，听起来他们正在考虑在下一个版本中简化这一点。这意味着据我所知，我在问题中陈述的方式是向实体框架动态添加字段的最佳方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T23:17:22.650

您最终将花费更多时间尝试使此解决方案工作，然后使用 HashTables 完成您的整个项目。我真的不认为实体框架适合这种情况，因为，

1.  您的代码不会被编程为使用生成的新字段
2.  您将不得不处理从应用程序域中卸载当前程序集并重新加载新程序集
3.  你真的在为失败做好准备

抱歉，只是有些问题不容易应用于某些框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-05T19:59:00.043

我只是把这个扔在那里......

您可以使用扩展方法和/或部分类让对象接受自定义字段数据的键/值对字典。然后在保存事件之后，您可以使用直接 SQL 插入/更新该数据。

# .net - ASP-MVC：授权后重定向时对象实例丢失

> ID：476818
> 
> 赞同：2
> 
> 时间：2009-01-24T22:47:00.323
> 
> 标签：.net, asp.net-mvc, redirect, authorization

我在绑定表单数据的操作上有一个“授权”属性。

如果用户提交表单但未获得授权，则会出现登录提示。登录后，用户被正确重定向，但模型为空。

如何处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-01T15:03:47.060

一个基本的解决方案是创建一个新的 ActionFilter 属性，其行为类似于 Authorize，不同之处在于它会在重定向之前将模型存储在 Session 中，然后用户登录，然后重定向回数据表单。然后当授权用户获得数据表单时，用可能存储的值填写数据表单，用户可以再次提交填写的表单。您可以根据需要更改它，甚至将数据存储在客户端，这必须是可能的，但主要思想是使用自定义授权 ActionFilter 在重定向之前存储模型，而不是授权。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T23:11:29.510

这总是一个问题，并且需要您跳过很多圈才能保持这种状态。您始终可以将模型双重存储在 Session 和 ViewState 中，这样如果用户来自具有空模型的地方，您可以在 Session 中查找它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-01T05:35:23.023

我考虑过但从未尝试过的一件事是将登录提示显示为同一页面上的模式对话框，而不是重定向到单独的登录页面然后重定向回来。登录 GUI 逻辑通常很简单，您不需要单独的视图。

例如，您可以将登录公开为使用 Json 消息编码的简单 WCF 服务，然后使用 jQuery 从您的模态对话框中与其对话。

# reportviewer - 报告视图排序日期时间列

> ID：476819
> 
> 赞同：0
> 
> 时间：2009-01-24T22:47:18.280
> 
> 标签：reportviewer

如何按包含日期时间的列对 ReportView 中的数据进行排序

在 rdlc 文件中，我将 Table 放置在 Details 的 1 列中`=Fields!StartTime`，在 Header 中，我使用排序表达式设置了 Interactive Sort：`=Fields!StartTime`

在 2 列中，我检查该字段是否包含日期`=IsDate(Fields!StartTime)`

当我执行它时，第二列包含所有内容，但它仍然不能正确排序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-25T12:29:09.337

函数`IsDate`识别`Fields!StartTime`为日期，但仍将其排序为字符串，将排序表达式更改为`=CDate(Fields!StartTime)`工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-19T10:11:54.043

我的问题是相似的。我`to_char`在 sql 查询中有关于日期的函数，交互式排序使用日期作为字符串。

`to_char`在查询排序中删除后，工作正常。

# javascript - DOM 文本节点是否保证不会被解释为 HTML？

> ID：476821
> 
> 赞同：10
> 
> 时间：2009-01-24T22:47:56.627
> 
> 标签：javascript, jquery, dom, xss

有谁知道是否保证 DOM`Node`类型`Text`不会被浏览器解释为 HTML？

更多细节如下。

**背景**

我正在为朋友构建一个简单的网络评论系统，并且一直在考虑 XSS 攻击。我不认为过滤或转义 HTML 标签是一个非常优雅的解决方案——想出一个会滑过过滤器的卷积太容易了。根本问题是我想保证，对于某些内容（即随机未经身份验证的网络用户发布的内容），浏览器*永远不会*尝试解释或运行内容。

**一个普通的（文本）开始**

想到的第一个想法就是使用`Content-Type: text/plain`，但这必须适用于整个页面。您可以将纯文本`IFRAME`放在页面中间，但它很丑陋，并且如果用户单击框架会产生焦点问题。

**内部文本/文本内容/JQuery**

事实证明，有一些特定于浏览器的属性（`innerText`在 IE、`textContent`FF、Safari 等中）在设置时需要创建单个`Text`节点。

JQuery 试图通过实现一个`text(val)`跳过特定于浏览器的属性并直接转到的函数来避免特定于浏览器的属性的差异`document.createTextNode(text)`，正如您可以猜到的那样，它创建了一个`Text`节点。

**W3 `Text` `Node`DOM**

所以我认为这接近我想要的，它看起来不错——`Text`节点不能有子节点，而且看起来它们不能被解释为 HTML。但我不能从官方文档中 100% 确定。

*   接口`Node`：[http ://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-1950641247](http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-1950641247)
*   接口`Text`：[http ://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-1312295772](http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-1312295772)
*   `textContent`：[http ://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-textContent](http://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-textContent)

其中的部分`textContent`特别令人鼓舞，因为它说“在设置时，也不执行解析，输入字符串被视为纯文本内容”。但这是所有`Text`节点的基础，还是只有您设置的节点`textContent`？这可能看起来像是一个愚蠢的狡辩，但它可能很重要，因为*IE 不支持`textContent`*（见上文）。

**回到最初的问题**

任何人都可以确认/拒绝这将起作用吗？也就是说，兼容 w3 DOM 的浏览器*永远不会*将节点解释`Text`为 HTML，无论内容是什么？我会非常感激能解决这个令人痛苦的小不确定性。

感谢您的时间！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T22:58:35.323

是的，这一点得到了证实，在某种程度上，对于任何不是浏览器的浏览器，该浏览器都会有*严重*的缺陷。呈现除文本之外的任何内容的文本节点将是矛盾的。通过使用 document.createTextNode("some string"); 并附加该节点，*保证*字符串呈现为文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T22:52:53.167

> 我不认为过滤或转义 HTML 标签是一个非常优雅的解决方案——想出一个会滑过过滤器的卷积太容易了

这绝对是不真实的，过滤 > 到 > 和 < 到 < 将完全停止任何 HTML 注入。

# javascript - jQuery 时间选择器

> ID：476822
> 
> 赞同：72
> 
> 时间：2009-01-24T22:48:27.187
> 
> 标签：javascript, jquery, time

我希望用用户可以在 15 分钟间隔内选择的时间来填充文本输入。我知道那里有一些插件。我想知道是否有任何“行业标准”插件，或者在常见场景中更喜欢特定插件的强烈客观理由。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-04-15T21:56:01.877

我发现[这个插件](http://labs.perifer.se/timedatepicker/)（[github 存储库](https://github.com/perifer/timePicker)）胜过提到的另一个插件。它模仿谷歌日历的时间选择器。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2011-02-23T00:15:07.907

我尝试了很多时间选择器，但并不满意，所以我[还]写了另一个。我认为它运作良好。它也受到 datepicker 的启发，所以它看起来像标准的 jQuery UI 东西。

默认分钟增量为 5，可在选项中设置为 15。

[http://fgelinas.com/code/timepicker](http://fgelinas.com/code/timepicker)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-01-25T00:11:01.917

我的建议是不要这样做。我发现被迫使用日历控件来输入日期已经够糟糕的了，尤其是当没有选择键入日期时，我可以比导航另一个古怪的控件更快地做到这一点。

时间选择器只是将这种对 UI 的迷恋推向了一个新的极端。为什么不让您的用户输入时间，或者只使用几个下拉框来显示几小时和几分钟。甚至下拉列表也允许用户输入时间。[Shog9 的答案](https://stackoverflow.com/questions/476822/jquery-time-picker#476861)中的时间选择器看起来非常漂亮，但使用起来却非常繁琐。如果我是必须使用数据输入应用程序的最终用户，并且它在页面上有类似的控件，那么它只会减慢我的速度，让我想来切断开发人员的手。:)

先考虑可用性，然后再考虑应用程序的外观。

只是我的拙见。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-24T23:04:22.160

这不是 jQuery ......但我发现一个下拉列表，其中包含 15 分钟的时间间隔列表，上午 8:00、上午 8:15、上午 8:30 等等，用户非常容易与之交互。

不确定您是否**真的**需要一种 jQuery 方式来执行此操作……可能有点矫枉过正。只是基于我对**真实**用户和开发业务应用程序的个人经验的意见。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-06-26T00:36:31.540

如果您有兴趣使用一个好的时间解析器并允许用户输入范围广泛的有效时间字符串（8:00 AM、8AM、8a、8 等），请查看[http://www.datejs .com/](http://www.datejs.com/)。

这是我用来处理它的 jquery 代码。

```
$('.time').blur(function (e) {
    var val = $(this).val();
    if (!isNaN(val))
        // add minutes to numeric value otherwise it will be interpreted as a date
        val = val + ':00'; 
    var dt = Date.parse(val);
    $(this).val(dt.toString('h:mm tt'))
}); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-01-14T08:46:18.253

我认为每个答案，除了 Kev 的，都是主观的。我已经在网上看到了十分之一的时间选择器 JQuery 插件，并且大多数都是无用的耗时噱头，但是如果您已经使用标准的 Jquery 日期选择器，那么[这个插件](http://trentrichardson.com/examples/timepicker/)将是合适的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-24T23:13:03.890

查看 Maxime Haineault 的[jQuery.timepicker](http://haineault.com/media/jquery/ui-timepickr/page/)。很酷，恕我直言...

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-04-23T15:49:29.493

我用过的最好的是 Telerik 提供的。

[http://demos.telerik.com/aspnet-ajax/calendar/examples/datetimepicker/overview/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/calendar/examples/datetimepicker/overview/defaultcs.aspx)

它不显眼，让用户只需输入时间或单击时钟图标即可从列表中进行选择。基本上只是一种使用可编辑下拉菜单的更美观的方法。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-01-20T14:31:01.913

试试这个很棒的库 - [http://code.google.com/p/mobiscroll/](http://code.google.com/p/mobiscroll/)

演示 - [http://demo.mobiscroll.com/](http://demo.mobiscroll.com/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-04-20T17:10:53.260

这是我对这个主题的尝试：http: [//yoka.github.com/jquery-timeselect/](http://yoka.github.com/jquery-timeselect/)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-02-21T11:22:31.543

我一直在使用[Trent Richardson 的 timepicker 库](http://trentrichardson.com/examples/timepicker/)，发现它很棒。它也是一个非常受欢迎的下载数量。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-03-16T11:31:56.227

我的情况略有不同，我需要一个日期时间选择器，但也找不到。所以我决定写一个。你可以在[这里找到完整的源代码](http://www.yart.com.au//DateTime/TimeCalendar.js)；我还发布[了一个快速演示](http://www.yart.com.au/Resources/ASP-NET/ASP-NET-JQuery-Date-Time-Control.aspx)。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-08-22T03:52:18.250

[我](http://github.com/gdoermann/jquery.ui.timepicker)根据 Jim 提到的插件写了一个（像谷歌日历时间选择器一样工作），但它使用 jquery ui 自动完成。它比前面提到的插件稳定得多。我在页面上定位自己时遇到了问题。该插件采用数组、时间范围和间隔或 ajax 源……因此您可以根据自己的喜好对其进行自定义。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-12-30T12:30:34.700

虽然没有标准的，但我一直在使用[Keith Wood 的 jQuery 插件](http://keith-wood.name/timeEntry.html)。与某些不同，这会降级为文本框（您仍然可以输入，同时仍然执行验证），如果您愿意，也可以与鼠标一起使用。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-01-10T02:37:57.447

我找不到可以满足我要求的插件（即多列自动完成与时间输入屏蔽相结合），所以我写了[MenuOptions](http://www.menuoptions.org/examples/ReloadMenuOptions.html)

它看起来像什么 [![在此处输入图像描述](https://i.stack.imgur.com/JDXqs.gif)](https://i.stack.imgur.com/JDXqs.gif)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-05-07T20:39:49.903

Any+Time™ DatePicker [/TimePicker AJAX 日历小部件](http://www.ama3.com/anytime/)允许时间选择，当使用鼠标时，它与手动输入一样快，但具有防止错误的额外好处。时间可以以任何必要的方式格式化。它还支持键盘操作，尽管无可否认，键盘访问不如鼠标或打字快......但同样，它保证了值将采用所需的格式。它也易于定制，也可以处理日期。

# wcf - 创建动态代理对象

> ID：476827
> 
> 赞同：2
> 
> 时间：2009-01-24T22:52:05.570
> 
> 标签：wcf, dynamic, proxy

有没有办法在不使用 codedom 的情况下即时创建 WCF 代理对象？即时我的意思是在运行时。因此，假设我有一个正在访问 WCF 服务的智能客户端应用程序。WCF 服务的数据协定在客户端运行时更改。我想动态创建一个反映更改的数据合同的新代理对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-25T16:28:21.267

您应该阅读这篇文章：[WCF 手动方式……正确的方式](http://www.code-magazine.com/article.aspx?quickid=0809101&page=1)

并研究使用 ChannelFactory 类。如果合同即时更改，您将有很多反思来创建和调用成员，但我想不出您不应该这样做的任何原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T04:03:08.657

我想出了一个解决方案，将共享程序集用于合同和端点接口。

所以项目将是

1.  主持人
2.  联系人和端点
3.  带代理的客户端

    公共类 YourProxy : ClientBase {}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T03:30:59.337

小心不要在飞行中做太多事情。即使使用反射，将您的客户端/代理/服务/合同过多地耦合在一起也可能变得太容易了。

创建手动代理并将它们添加为您的客户的参考是一个绝妙的主意。

# html - CSS还不能做什么？

> ID：476831
> 
> 赞同：6
> 
> 时间：2009-01-24T22:53:21.980
> 
> 标签：html, css, layout, html-table

不久前，我试图找出一种不使用表格布局的方法：

```
<table>
  <tr><td rowspan="2">Left column</td></tr>
  <tr><td>Right Top</td><td>Right bottom</td></tr>
</table> 
```

最终我放弃了，并决定没有表格是不可能的（好吧，CSS 3 或许可以，但再等 5 到 10 年是不切实际的）。

有没有人有更多这样的例子？（或者更好，你能告诉我我错了吗？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T10:58:51.133

要回答标题中的问题，那些很尴尬、很难或不可能做的事情：

*   变量和计算（表达式不计算在内，vars 对于颜色消毒等事情会很方便）
*   垂直居中
*   将尺寸设置为“剩余空间”（如表格中的“*”）
*   有效地混合相对单位和绝对单位（以上将解决大多数这些问题）
*   风格效果，如圆角、褪色背景、阴影
*   文本中的空白控制
*   标准化的亚像素舍入（这不是直接的 CSS 问题，而是环境的结果）

为了公平起见，其中一些内容已被写入未来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T23:03:28.247

您可能想查看[这个问题](https://stackoverflow.com/questions/468038/in-css-how-do-i-get-a-left-side-fixed-width-column-with-a-right-side-table-that#468067)的答案。为答案提交了一些有趣的 CSS 代码——包括一个解决了我以前从未见过的问题的构造。还有很多非常有用的链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-24T23:06:53.497

有人回答了这个设计是否可行的问题。但是我有一个用css无法完成的例子。`cellspacing`出于某种原因，您需要`cellpadding`明确设置表格。`margin`即使有and`padding`属性也不能通过css设置。这是我认为非常烦人的事情，因为我总是想通过 css 控制表格的边距和填充。

例如

```
<h1> This table won't have it's margin or padding reset </h1>
<table style="padding: 0; margin: 0;">
    <tr><td>a</td><td>b</td></tr> 
</table>

<h1> This table will... </h1>
<table cellspacing="0" cellpadding="0">
    <tr><td>a</td><td>b</td></tr> 
</table> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T23:00:03.277

```
<div style='float:left;width:200px;height:300px;'>Left column</div>
<div style='margin-left:200px;'>
    <div>Right top</div>
    <div>Right bottom</div>
</div> 
```

我想你想要这样的东西。请记住，CSS`float`能力是惊人的。这只是一个例子。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T23:50:54.267

`position`使用该属性的另一种解决方案：

```
<style type="text/css">
    .outer {
        position: relative;
        background-color: #EEE;
    }
    .left-column {
        position: absolute;
        top: 0;
        left: 0;
        width: 50%;
        height: 100%;
        background-color: #F88;
    }
    .right-top {
        margin-left: 50%;
        background-color: #8F8;
    }
    .right-bottom {
        margin-left: 50%;
        background-color: #88F;
    }
</style>

<div class="outer">
    <div class="left-column">Left column</div>
    <div class="right-top">Right top</div>
    <div class="right-bottom">Right bottom</div>
</div> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-24T23:51:43.610

还有很多其他方法可以制作类似表格的布局。甚至还有[CSS 表格](http://24ways.org/2008/the-first-tool-you-reach-for)。真的，没有理由使用表格进行布局。曾经。

目前无法完成的事情是正确`text-align: justify;`的连字符不能正常工作，但是通过使用软连字符，您可以使其表现得非常恰当，我期望。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-26T10:32:48.487

我在 CSS 中从未实现过的东西是垂直居中的图像。我总是以这样的方式结束（我讨厌）

```
<style>
  td.pic_frame {
    text-align:center;
    width:220px;
    height:220px;
    vertical-align:middle;
 } 
</style>
<table><tr><td class="pic_frame"><img ...></td></tr></table> 
```

我刚刚按照 dylanfm 的建议使用 CSS 表进行了尝试

```
<style>
  div.pic_frame{
    display:table-cell;
    text-align:center;
    width:220px;
    height:220px;
    vertical-align:middle;
  }
</style>
<div class="pic_frame"><img ...></div> 
```

它在所有浏览器中都能完美运行，*你猜对了*，IE7

*（在 Firefox、Safari、Opera、Chrome 和 IE7 中测试）*

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T11:05:23.507

您可以将具有负边距的图像垂直居中。使用负边距将图像的“锚点”移动到其中心。然后将图像相对定位在中间。

800x800 图像示例：

```
#centered
{
    position:absolute;
    top:50%;
    left:50%;
    height:800px;
    width:800px;
    margin: auto;
    margin-top:-400px;
    margin-left:-400px;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T22:48:03.130

这是一个不起眼的属性，但`value`列表项标记的属性在 CSS 中没有替代品，即使它在 XHTML 1.0 Strict 中已被弃用，并且标准指示您使用 CSS 代替。因此，以下内容无效：

```
<ol>
 <li>Item one</li>
 <li>Item two</li>
 <li value="4">Item four</li>
 <li>Item five</li>
</ol> 
```

这让我在使用语义上有意义的代码的同时将某些法律文件放到网络上让我很伤心。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-25T22:51:23.293

如果您编写一些 WPF 应用程序（编写 XAML 面板），那么您会希望通过窗口丢弃您找到的所有 html 和 css...

# objective-c - 在 Objective-C 中创建一个整数属性数组

> ID：476843
> 
> 赞同：62
> 
> 时间：2009-01-24T23:01:30.467
> 
> 标签：objective-c, arrays, properties

我在 Objective-C 中创建整数数组的属性时遇到了麻烦。我不确定这是否可以在 Obj-C 中做到，所以我希望有人能帮助我找出如何正确地做到这一点或提供替代解决方案。

我的班级.h

```
@interface myClass : NSObject {

@private int doubleDigits[10];
}

@property int doubleDigits;
@end 
```

我的班级.m

```
@implementation myClass

    @synthesize doubleDigits;
    -(id) init {

        self = [super init];

        int doubleDigits[10] = {1,2,3,4,5,6,7,8,9,10};

        return self;
    }

    @end 
```

当我构建并运行时，我收到以下错误：

> 错误：属性“doubleDigits”的类型与 ivar“doubleDigits”的类型不匹配

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-25T01:38:47.420

这应该有效：

```
@interface MyClass
{
    int _doubleDigits[10]; 
}

@property(readonly) int *doubleDigits;

@end

@implementation MyClass

- (int *)doubleDigits
{
    return _doubleDigits;
}

@end 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-12-30T23:15:20.457

C 数组不是属性支持的数据类型之一。请参阅 Xcode 文档中“声明的属性”页面中的“Objective-C 编程语言”：

> **支持的类型**
> 
> 您可以为任何 Objective-C 类、Core Foundation 数据类型或“普通旧数据”（POD）类型声明属性（请参阅 C++ 语言说明：POD 类型）。但是，有关使用 Core Foundation 类型的限制，请参阅“Core Foundation”。</p>

POD 不包括 C 数组。见 [http://www.fnal.gov/docs/working-groups/fpcltf/Pkg/ISOcxx/doc/POD.html](http://www.fnal.gov/docs/working-groups/fpcltf/Pkg/ISOcxx/doc/POD.html)

如果你需要一个数组，你应该使用 NSArray 或 NSData。

在我看来，解决方法就像使用 (void *) 来规避类型检查。你可以这样做，但它会降低你的代码的可维护性。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-10-12T19:10:04.053

就像 lucius 说的，不可能有一个 C 数组属性。使用 an`NSArray`是要走的路。数组只存储对象，所以你必须使用`NSNumber`s 来存储你的整数。使用新的文字语法，初始化它非常简单直接：

```
NSArray *doubleDigits = @[ @1, @2, @3, @4, @5, @6, @7, @8, @9, @10 ]; 
```

或者：

```
NSMutableArray *doubleDigits = [NSMutableArray array];

for (int n = 1; n <= 10; n++)
    [doubleDigits addObject:@(n)]; 
```

更多信息：[NSArray 类参考](http://developer.apple.com/library/ios/#documentation/cocoa/reference/foundation/Classes/NSArray_Class/NSArray.html/)、[NSNumber 类参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html/)、[文字语法](http://joris.kluivers.nl/blog/2012/03/13/new-objectivec-literal-syntax/)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-24T23:05:16.917

我只是推测：

我认为 ivars 中定义的变量在对象中分配空间。这可以防止您创建访问器，因为您不能按值将数组提供给函数，而只能通过指针。因此，您必须在 ivars 中使用指针：

```
int *doubleDigits; 
```

然后在 init-method 中为其分配空间：

```
@synthesize doubleDigits;

- (id)init {
    if (self = [super init]) {
        doubleDigits = malloc(sizeof(int) * 10);
        /*
         * This works, but is dangerous (forbidden) because bufferDoubleDigits
         * gets deleted at the end of -(id)init because it's on the stack:
         * int bufferDoubleDigits[] = {1,2,3,4,5,6,7,8,9,10};
         * [self setDoubleDigits:bufferDoubleDigits];
         *
         * If you want to be on the safe side use memcpy() (needs #include <string.h>)
         * doubleDigits = malloc(sizeof(int) * 10);
         * int bufferDoubleDigits[] = {1,2,3,4,5,6,7,8,9,10};
         * memcpy(doubleDigits, bufferDoubleDigits, sizeof(int) * 10);
         */
    }
    return self;
}

- (void)dealloc {
    free(doubleDigits);
    [super dealloc];
} 
```

在这种情况下，界面如下所示：

```
@interface MyClass : NSObject {
    int *doubleDigits;
}
@property int *doubleDigits; 
```

**编辑：**

我真的不确定是否允许这样做，这些值真的在堆栈上还是存储在其他地方？它们可能存储在堆栈中，因此在这种情况下使用不安全。（请参阅[关于初始化列表](https://stackoverflow.com/questions/476961/where-is-an-array-initialized-by-an-initializer-list-stored)的问题）

```
int bufferDoubleDigits[] = {1,2,3,4,5,6,7,8,9,10};
[self setDoubleDigits:bufferDoubleDigits]; 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-12-29T09:47:54.840

这有效

```
@interface RGBComponents : NSObject {

    float components[8];

}

@property(readonly) float * components; 
```

* * *

```
- (float *) components {
    return components;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-07T18:02:54.840

您可以将它放在您的类的 .h 文件中，并将其定义为属性，在 XCode 7 中：

```
@property int  (*stuffILike) [10]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-02T13:16:29.217

我发现所有以前的答案都太复杂了。我需要将一些整数数组存储为属性，并发现使用 NSArray 的 ObjC 要求是我的软件不必要的复杂性。

所以我用了这个：

```
typedef struct my10ints {
    int arr[10];
} my10ints;

@interface myClasss : NSObject

@property my10ints doubleDigits;

@end 
```

这使用 Xcode 6.2 干净地编译。

我的意图***是***像这样使用它：

```
myClass obj;
obj.doubleDigits.arr[0] = 4; 
```

但是，这不起作用。这是它产生的：

```
int i = 4;
myClass obj;
obj.doubleDigits.arr[0] = i;
i = obj.doubleDigits.arr[0];
// i is now 0 !!! 
```

正确使用它的唯一方法是：

```
int i = 4;
myClass obj;
my10ints ints;
ints = obj.doubleDigits;
ints.arr[0] = i;
obj.doubleDigits = ints;
i = obj.doubleDigits.arr[0];
// i is now 4 
```

因此，完全违背了我的观点（避免使用 NSArray 的复杂性）。

# .net - 在 ASP.NET MVC 中使用 HttpContext.Current.Session 测试一个类

> ID：476846
> 
> 赞同：5
> 
> 时间：2009-01-24T23:02:32.557
> 
> 标签：.net, asp.net-mvc, testing, session

我正在向内部使用 HttpContext.Current.Session 的类添加一些测试，并且我们正在移植到 ASP.NET MVC。我的课看起来像这样：

```
class Foo
{
    public void foo()
    {
        HttpContext.Current.Session["foo"] = "foo";
    }
} 
```

我想像这样改变它：

```
class Foo
{
    IHttpSessionState session;

    public Foo() : this(HttpContext.Current.Session) {}

    public Foo(IHttpSessionState session)
    {
        m_session = session;
    }

    public void foo()
    {
        m_session["foo"] = "foo";
    }
} 
```

问题在于默认构造函数。我不能通过旧类，因为它们没有实现新的 ASP.NET MVC 接口。

无论如何要获取在默认构造函数中实现 IHttpSessionState 的实例吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-24T23:24:27.723

试试这个，它使用了 MVC 框架使用的 IHttpSessionState 包装器。

```
class Foo
{
    // member variable set by constructor
    IHttpSessionState m_session;

    // if no session is passed it attempts to create a new session state wrapper from the current session
    public Foo() : this(new HttpSessionStateWrapper(HttpContext.Current.Session)) {}

    public Foo(IHttpSessionState session)
    {
        m_session = session;
    }

    public void foo()
    {
        m_session["foo"] = "foo";
    }
} 
```

# android - Android TextWatcher.afterTextChanged 与 TextWatcher.onTextChanged

> ID：476848
> 
> 赞同：127
> 
> 时间：2009-01-24T23:03:30.527
> 
> 标签：android, android-textwatcher

在什么情况下我应该使用`afterTextChanged`代替，`onTextChanged`反之亦然？

* * *

## 回答 #1

> 赞同：212
> 
> 时间：2011-05-14T18:03:56.893

这些事件按以下顺序调用：

1.  **beforeTextChanged(CharSequence s, int start, int count, int after)**。
    这意味着这些字符即将被一些新文本替换。*文本不可编辑。*
    *使用：*当您需要查看即将更改的旧文本时。

2.  **onTextChanged(CharSequence s, int start, int before, int count)**。
    已经进行了更改，一些字符刚刚被替换。*文本不可编辑。*
    *用途：*当您需要查看文本中哪些字符是新的时。

3.  **afterTextChanged(Editable s)**。
    与上面相同，除了现在*文本是可编辑的*。
    *使用：*当您需要查看并可能编辑新文本时。

如果我只是在监听 中的变化`EditText`，我根本不需要使用前两种方法。我将在第三种方法中接收新值，并在需要时更正新文本。但是，如果我必须追踪值发生的确切变化，我会使用前两种方法。如果我还需要在听完更改后编辑文本，我会在第三种方法中进行。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-24T23:19:22.210

**public void afterTextChanged(Editable s)**

> 调用此方法是为了通知您，在 中`s`的某处，文本已更改。对此回调进行进一步更改是合法的`s`，但请注意不要让自己陷入无限循环，因为您所做的任何更改都会导致再次递归调用此方法。（您不会被告知更改发生的位置，因为其他 afterTextChanged() 方法可能已经进行了其他更改并使偏移量无效。但是如果您需要在这里知道，您可以使用`setSpan(Object, int, int, int)`in`onTextChanged(CharSequence, int, int, int)`标记您的位置，然后从这里查找跨度结束了。

**public void beforeTextChanged(CharSequence s, int start, int count, int after)**

> 调用此方法是为了通知您，在 内`s`，以`count`开头的字符`start`即将被替换为长度为 的新文本`after`。尝试`s`从此回调进行更改是错误的。

**public void onTextChanged(CharSequence s, int start, int before, int count)**

> 调用此方法是为了通知您，在 内`s`，以`count`开头的字符`start`刚刚替换了具有 length 的旧文本`before`。尝试`s`从此回调进行更改是错误的。

来自[Android 的 TextWatcher 参考](http://code.google.com/android/reference/android/text/TextWatcher.html)。

# c++ - CreateTimerQueueTimer 回调和竞争条件

> ID：476865
> 
> 赞同：5
> 
> 时间：2009-01-24T23:18:21.900
> 
> 标签：c++, winapi, timer

我在我的应用程序中使用计时器队列，并将指向我自己的 C++ Timer 对象之一的指针作为“参数”传递给回调（在 CreateTimerQueueTimer 中）。然后我在回调中调用对象的虚方法。

Timer 对象的析构函数将确保使用 DeleteTimerQueueTimer() 取消计时器。

```
static void callback( PVOID param, BOOLEAN timerOrWaitFired )
{
    Timer* timer = reinterpret_cast< Timer* >( param );
    timer->TimedOut();
}

class Timer
{
public:
   Timer();

   virtual ~Timer()
   {
       ::DeleteTimerQueueTimer( handle );
   }

   void Start( double period )
   {
      ::CreateTimerQueueTimer( &handle, ..., &callback, this, ... );
   }

   virtual void TimedOut() = 0;

   ...
}; 
```

然而，有一个微妙的竞争条件，如果回调已经被调用，但定时器对象在调用 TimedOut()*之前被销毁，应用程序崩溃，因为回调调用了不存在对象上的虚拟方法。*或者更糟糕的是，当它被删除时。

我确实有互斥锁来控制多线程调用，但我仍然遇到问题。

使用对象指针作为回调参数真的是个好主意吗？由于不能保证线程之间的同步，它对我来说只是闻起来很糟糕。

有更好的解决方案吗？其他人做什么？

发生的一件事是保留一组指向每个 Timer 实例的指针（在构造函数中添加，在析构函数中删除）。但我认为这行不通，因为如果 Timer 派生自，我们只会从基类析构函数的集合中删除指针；如果我们已经开始销毁派生对象，损害已经造成。

干杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-25T00:05:45.983

使用对象指针作为回调函数参数的概念本身还不错。但是，您显然需要在最后一个回调退出后开始销毁。

因此，我根本不会将 Timer 抽象化并从中派生。我会使用另一个抽象类`TimerImpl`并使`Timer`该类使用一个`TimerImpl`实例：

```
class Timer
{
  TimerInstance* impl;
  void TimeOut() { impl->TimeOut(); }
public:
  ~Timer() {
    ... make sure the timer has ended and wont fire again after this line...
    delete impl;
  }
}

struct TimerImpl
{
  virtual void TimeOut()=0;
  virtual ~TimerImpl();
} 
```

这样，您可以确保在您说之前不会开始破坏。

第二件事是，您必须等待最后一个计时器事件烧完。根据[MSDN doc](http://msdn.microsoft.com/en-us/library/ms682569(VS.85).aspx)，您可以通过调用

```
DeleteTimerQueueTimer(TimerQueue, Timer, INVALID_HANDLE_VALUE) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-05T19:39:20.597

当您调用 DeleteTimerQueueTimer 时，请确保您为完成事件传递了 INVALID_HANDLE_VALUE。这将阻塞你的析构函数，直到所有挂起的回调都完成或取消。

例如

```
virtual ~Timer()
   {
       ::DeleteTimerQueueTimer( timerQueue, handle, INVALID_HANDLE_VALUE );
   } 
```

这意味着您的代码将阻塞，直到所有计时器回调完成或取消。然后，您可以照常进行销毁。不过要注意的一件事 - 您不能从同一个计时器回调中调用 deletetimerqueuetimer ，否则您将死锁。

我相信仅此一项就足以防止您遇到的竞争状况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T00:07:32.690

你几乎肯定不能用继承模型做到这一点。主要问题是，在输入基类构造函数时，派生对象已经无效，但计时器可能会触发，并且没有任何东西阻止它尝试虚拟函数调用，这将导致未定义的行为。

我认为这样做的方法是这样的包装器。关键是要确保在尝试分派“超时”事件时不存在竞争条件。

这个实现仍然有一个缺陷。当计时器对象开始被删除时，计时器事件可能正在等待。析构函数可以释放互斥锁，然后在计时器线程等待互斥锁时销毁互斥锁​​。我们已经阻止了发送“超时”事件的竞争，但是等待被销毁的互斥锁的线程的行为取决于互斥锁的实现。

```
static void callback( PVOID param, BOOLEAN timerOrWaitFired );

class TimerWrapper
{
    public:

        /* Take reference to std::auto_ptr to ensure ownership transfer is explicit */
        TimerWrapper( std::auto_ptr<Timer>& timer ) : timer_(timer)
        {
            ::CreateTimerQueueTimer( &htimer_, ..., callback, this, ... );
        }

        void TimedOut()
        {
            ScopedGuard guard( mutex_ );
            if( timer_.get() )
                timer_->TimedOut();
        }

        ~TimerWrapper()
        {
            ::DeleteTimerQueueTimer( htimer_, ... );
            ScopedGuard guard( mutex_ );
            timer_.reset();
        }

    private:

        Mutex mutex_;
        std::auto_ptr<Timer> timer_;
        HANDLE htimer_;
};

static void callback( PVOID param, BOOLEAN timerOrWaitFired )
{
    TimerWrapper* timer = reinterpret_cast< TimerWrapper* >( param );
    timer->TimedOut();
} 
```

# google-app-engine - Google App Engine 的应用程序可以在其他服务器上使用吗？

> ID：476876
> 
> 赞同：15
> 
> 时间：2009-01-24T23:29:04.937
> 
> 标签：google-app-engine

Google App Engine 的应用程序的便携性如何？这些是否永远绑定在 GAE 上？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-02-19T17:31:07.010

有一些软件可以在 Google 之外运行 App Engine 应用程序，其中最突出的两个是[AppScale](http://code.google.com/p/appscale/)和[TyphoonAE](http://code.google.com/p/typhoonae/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-13T15:21:19.537

如果不使用 Google 自己的 WebApp 框架，而是依赖更标准化的工具（我这里不是说 Django），那么与核心应用程序逻辑隔离并使可插拔/可交换的东西很少：

*   存储，这似乎是最烦人的部分，但如果你不使用 GQL 太多是可行的（数据存储 API 类似于可供 Python 尝试的足够多的其他 ORM）；
*   身份验证，似乎很容易，但需要编写完整的后端；
*   内存缓存，memcache API 与 Memcached 有所不同（差异很小，所以这应该很简单，因为两个系统的操作是相同的）；
*   应用程序启动，您必须编写自己的 WSGI 启动器（使用[Werkzeug](http://werkzeug.pocoo.org/)非常容易）。

在我看来 - 值得一试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T22:17:18.753

您可以使用 gae2django 将 AppEngine 应用程序转换为 Django 应用程序。

如本文所述 [http://code.google.com/appengine/articles/pure_django.html](http://code.google.com/appengine/articles/pure_django.html)

gae2django [http://code.google.com/p/django-gae2django/](http://code.google.com/p/django-gae2django/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-24T23:39:17.537

作为一名优秀的顾问，我会说答案是“取决于”。

首先，您始终可以在 SDK 中运行 GAE 项目。所以在那个程度上你是不受约束的。除此之外，这取决于您使用的其他 API。webapp 库与其他库非常相似，但我不认为它可以作为独立库使用；但是，GAE 也支持将 Django 作为 Web 框架，当然它也可以单独使用。

代码只是 Python。但是有些 API，比如数据 API，实际上是为了与谷歌云交互；您不能确定是否可以将任意 GAE 程序移动到另一个平台而无需返工。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T05:41:36.187

如果你使用 Django 0.96，你可以在做一些小的工作后将你的代码移动到不同的主机上。您需要将模型从数据存储更改为另一个数据库。您将不得不停止使用 google 提供的 User 类和可能的其他 google 特定 API。

我已经将 Django 应用程序移植到 GAE 没有太多麻烦。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-05T08:35:37.617

我已经为应用程序引擎（java）开发了几个月了。
从理论上讲，如果您坚持使用 JPA 或 JDO 等标准进行数据访问
，并且不使用任务队列等高级功能，那么
将您的应用程序移植到另一个环境应该不会有太大问题。

话虽如此，我经常发现自己使用低级别的 google api 来访问数据存储区以避免噩梦般的性能问题。如果您的应用程序设计具有模块化数据访问层，则可以在一定程度上减少此问题的副作用。

另一方面，如果我有一个应用程序在 app-engine 上运行顺利，我想不出任何理由将它移动到其他任何地方。

# c# - 扩展方法作为重命名属性的一种方式

> ID：476877
> 
> 赞同：0
> 
> 时间：2009-01-24T23:29:19.553
> 
> 标签：c#, .net, extension-methods

有些类有丑陋的字段称为 URL，但我宁愿称它为文件。

```
 public static void setFile(this AxWMPLib.AxWindowsMediaPlayer mp, string filename) {
    mp.URL = filename;
} 
```

和

```
 public static string file(this AxWMPLib.AxWindowsMediaPlayer mp) {
     return mp.URL;
} 
```

有没有办法不使用 setFile，而是让文件像属性一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T23:41:58.670

我认为您所追求的是[不存在](https://stackoverflow.com/questions/138367/most-wanted-feature-for-c-4-0#138378)的扩展属性。扩展方法在调用时要求 () 跟随方法名称。

# ruby - 256种颜色，前景和背景

> ID：476878
> 
> 赞同：6
> 
> 时间：2009-01-24T23:30:50.157
> 
> 标签：ruby, ncurses, terminal, 256color

这是两个脚本的故事，与上一个[问题有关](https://stackoverflow.com/questions/171490/getting-256-colors-out-of-ruby-ncurses)。

这两个脚本位于[http://gist.github.com/50692](http://gist.github.com/50692)。ansi.rb 脚本在所有 256 种背景颜色上显示所有 256 种颜色。ncurses.rb 脚本显示所有 256 种前景颜色，但背景显示基本的 16 种颜色，然后似乎循环显示各种属性，如闪烁和反向视频。

那么给了什么？这是 ncurses 中的错误，它使用有符号整数作为颜色对吗？（即 'tput colors' 表示 256，但 'tput pairs' 表示 32767 而不是 65536） 看起来如果是这种情况，颜色对的前半部分会正确显示，但后半部分会重复或作为 int 进入属性包裹。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T19:40:56.790

原因是因为 ncurses pre ABI 6，其中包括大多数发行版（包括 Debian 和 Amazon AMI）使用的当前版本，`COLOR_PAIR(n)`不能引用任何高于 256 的已定义对。这是因为 to 的参数`COLOR_PAIR(n)`类型为`cchar_t`。低 8 位选择颜色对，其余的被视为`OR`特定终端属性的位标志。这就是为什么当您尝试超出示例代码中的第 255 对时，您会看到闪烁、反转、下划线等。

这是非常不幸的，我计划在我的程序中使用一个队列来动态定义颜色，`init_pair()`并只是覆盖最近最少使用的对作为折衷方案。我写信给 ncurses 维护者 Thomas Dickey 询问是否有办法暂时离开 ncurses 以编写原始终端代码，然后返回到 ncurses。这是他的回复：

> 从本质上讲，您必须忘记屏幕优化，而只需使用 terminfo(3) 中列出的函数（例如 tigetstr、mvcur、tputs）进行自己的绘图。
> 
> 您可以暂时退出 ncurses，但必须重新绘制屏幕。否则 ncurses 会对屏幕上的内容和光标的位置感到困惑。

这个解决方案似乎存在太多陷阱，但如果你在 ncurses 程序中绝对需要超过 256 个同时对（不计算你可以用 inverse 属性伪造的对），那么这就是你必须做的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-18T23:03:18.047

我根本不了解 Ruby，所以无法提供一个工作示例，但是 ncurses.rb 脚本应该告诉你一些事情，因为它比 ansi.rb 脚本短得多。

你没有设置颜色，所以它只是循环默认的 16 调色板，其中包含闪烁下划线、粗体等属性提供的变体。

您需要使用`int init_color(short color, short r, short g, short b)`RGB 值（0 - 1000）初始化颜色索引，然后`int init_pair(short pair, short f, short b)`在调用`COLOR_PAIR(n)`.

为了便携性，您应该检查`bool has_colors(void)`并`bool can_change_color(void)`

在我的系统上，ncurses 的手册页非常宝贵。

# c++ - 在 C++ 中使用 MSHTML 作为 GUI，是否有教程？

> ID：476881
> 
> 赞同：4
> 
> 时间：2009-01-24T23:32:49.967
> 
> 标签：c++, user-interface, dom, mshtml

我想将我的应用程序迁移到对 GUI 使用 MHTML，因为不用每次都重写 C++ 来试验布局会更容易。

不幸的是，我发现的不是我需要的，它们是：

*   从内存中输入 HTML
*   在我的 C++ 代码中接收诸如 onclick 等事件
*   通过 DOM 对其进行操作，例如，设置特定元素的 innerHtml

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-25T00:56:53.150

丑陋的部分将是接收事件。直接在 C++ 中对 MSHTML 的 COM 接口进行编码以将逻辑附加到 HTML GUI，如果你“原始”地这样做，那将是非常难看的。您可能希望在应用程序逻辑和 HSHTML 之间放置一层薄薄的库代码，以隐藏与 COM 相关的直线。

归根结底，这是对 Firefox 的 XUL 之类的重新发明 - 请参阅[http://en.wikipedia.org/wiki/XUL](http://en.wikipedia.org/wiki/XUL)。您可能会发现以这种方式更易于使用。您将托管 Gecko 引擎而不是 MSHTML。

或者，您也可以使用 WPF，这又非常相似。鉴于您在 Windows 上（因为您对 MSHTML 的依赖感到满意），您可以用 C# 编写 GUI 内容，并通过使用 C++/CLI 公开将其绑定到 C++ 代码。

# emacs - 我可以在 Emacs 中获得 ido-mode 样式的完成来搜索标签吗？

> ID：476887
> 
> 赞同：6
> 
> 时间：2009-01-24T23:38:10.953
> 
> 标签：emacs, tags

是否可以使用 ido 模式完成在 TAGS 文件中查找定义？我怀疑 ido-completing-read 是答案的一部分。这是我的非工作代码，它显示了一个未填充的 ido-mode minibuffer：

```
(defun ido-choose-from-tags ()
  "Use ido to select tags "
  (interactive)
    (etags-tags-apropos
     (ido-completing-read "Tags: "  nil t))) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-25T03:58:13.223

有点低效，但是怎么样：

```
(defun my-ido-find-tag ()
  "Find a tag using ido"
  (interactive)
  (tags-completion-table)
  (let (tag-names)
    (mapc (lambda (x)
            (unless (integerp x)
              (push (prin1-to-string x t) tag-names)))
          tags-completion-table)
    (find-tag (ido-completing-read "Tag: " tag-names)))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T10:11:59.007

为了找到定义，我使用了 CEDET 的命令 semantic-ia-fast-jump，它与来自 GNU Global 的 gtags 一起提供了正确和快速的源文件导航。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T23:46:36.820

当然有可能，这是 EMACS。不工作的代码做了什么告诉你它不工作？

我的第一个怀疑是，如果你使用它可能会更好`tags-apropos`（参见 etags.el 中的第 1885 行），因为`etags-tags-apropos`它没有定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-05T06:17:38.850

另请参阅：[http ://www.emacswiki.org/emacs/Icicles_-_Emacs_Tags_Enhancements](http://www.emacswiki.org/emacs/Icicles_-_Emacs_Tags_Enhancements)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-04T08:34:11.617

scottfrazer 解决方案的扩展：

```
(defun my-ido-find-tag ()
  "Find a tag using ido"
  (interactive)
  (tags-completion-table)
  (let* ((initial-input
          (funcall (or find-tag-default-function
                       (get major-mode 'find-tag-default-function)
                       'find-tag-default)))
         (initial-input-regex (concat "\\(^\\|::\\)" initial-input "$")))
    (find-tag (ido-completing-read
               "Tag: "
               (sort
                (remove nil
                        (mapcar (lambda (tag) (unless (integerp tag)
                                                (prin1-to-string tag 'noescape)))
                                tags-completion-table))
                ;; put those matching initial-input first:
                (lambda (a b) (string-match initial-input-regex a)))
               nil
               'require-match
               initial-input)))) 
```

这会将与标记点匹配的标记放在列表的开头。我想如果两个标签匹配，您可以按缓冲区文件名进行第二次排序，但这可能并不总是您想要的。对于真正巨大的标签表，使用[https://github.com/magnars/s.el#s-ends-with-suffix-s-optional-ignore-case](https://github.com/magnars/s.el#s-ends-with-suffix-s-optional-ignore-case)可能比使用字符串匹配更快。

# php - 配置文件的最佳文件格式是什么

> ID：476892
> 
> 赞同：15
> 
> 时间：2009-01-24T23:42:44.783
> 
> 标签：php, configuration, file-format

我正在用 PHP 创建一个框架，需要一些配置文件。其中一些文件不可避免地会有大量条目。

什么格式最适合这些配置文件？

这是我对最佳的量化：

1.  很容易被 PHP 解析。如果我不必编写任何解析代码，那就太好了，但这不是一个交易破坏者。
2.  即使有大量条目，仍然很容易被人类阅读
3.  是一种广泛使用的标准，没有自定义格式
4.  简洁是值得赞赏的

我开始使用 XML，但由于显而易见的原因很快就放弃了。我想到了 JSON 和 YAML，但想看看还有什么。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-24T23:52:44.763

INI 文件格式怎么样？这是一个事实上的配置文件标准，PHP 有一个针对该格式的内置解析器：

[parse_ini_file](http://us.php.net/parse_ini_file)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-24T23:51:42.410

YAML 是一个不错的选择： [http ://www.yaml.org/](http://www.yaml.org/)

它也非常简单和强大

Ruby 项目大量使用它进行配置。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-24T23:48:11.463

为什么不使用 PHP 文件进行配置？

好处很明显：

*   可能的错误将被自动捕获
*   无需使用/创建自定义解析器
*   它被 PHP 程序员广泛理解
*   您可以有一些自定义逻辑，例如使用自定义配置进行开发，其他用于生产等

其他框架，如 Django 和 rails 使用配置文件，它是一个脚本。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-25T01:03:24.933

另一种选择是使用 JSON 并使用`json_encode`and `json_decode`。

您将能够在配置参数中使用更丰富的数据结构。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T01:09:56.200

我个人喜欢在课堂上做配置数据。

```
class appNameConfig {
    var $dbHost = 'localhost';
    var $dbUser = 'root';
    //...
 } 
```

然后使用它们你所要做的就是

```
$config = new appNameConfig;
mysql_connect($config->dbHost, $config->dbUser, $config->dbPassword) or die(/*...*/); 
```

要更改配置，您所要做的就是读取包含类的文件我使用这样的函数：

```
function updateConfig($parameter, $value) {
    $fh = fopen('config.php', 'w+');
    while(!feof($fh)) {
        $file .= fgets($fh);
     }
    $fileLines = explode("\n", $file);
    for($i=0;$i<count($fileLines);$i++) {
        if(strstr($fileLines[$i], $parameter)) {
            $fileLines[$i] = "$" . $parameter . " = '" . $value . "'";
         }
     }
    $file = implode("\n", $fileLines);
    fwrite($fh, $file);
    fclose($fh);
 } 
```

# sql - 用户名还是 guid 用户 ID？

> ID：476898
> 
> 赞同：6
> 
> 时间：2009-01-24T23:46:06.180
> 
> 标签：sql, guid

在不同的sql表中保存数据时，最好使用GUID userID还是只使用用户名？使用 guid 时是否存在性能差异？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-24T23:49:21.603

使用向导。它是您的用户的系统内部标识符。然后，如果人们愿意，这允许更改用户名。

这与对您的系统有意义的内部 ID 与对您的用户有意义的外部 ID 的概念非常吻合。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-24T23:57:15.177

我看到很多关于 GUID 与 INT（自动增量）性能的讨论。但我可以推荐你使用 GUID。

嗯..您是在询问用作主要字段还是关于使用/不使用关系（将 GUID 插入到具有另一个具有 GUID 和用户名关联的表的表中）？

# iis-7 - 监控 IIS7 工作进程的 CPU 使用率

> ID：476926
> 
> 赞同：4
> 
> 时间：2009-01-25T00:03:51.433
> 
> 标签：iis-7, monitoring, worker-processes

监视 IIS7 工作进程并存储有关过度使用 CPU/内存的网站的信息的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T06:44:36.880

我最近开始研究使用 ASP.NET 访问 WMI。假设您的 ASP 服务帐户具有足够的权限，您可以使用标准 WMI 方法调用查询甚至监控各种性能指标。您可能希望首先查看 O'Reilly Media 的文章[A Quick Introduction to WMI from .NET](http://www.ondotnet.com/pub/a/dotnet/2003/04/07/wmi.html)，看看它是否满足您的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-25T04:15:52.687

有一些[商业选项](http://www.servernanny.com/)可以监控进程的 CPU 和内存利用率。

但是[Code Project 上也有一个解决方案](http://www.codeproject.com/KB/system/processescpuusage.aspx)，可以让您利用这些值从 winform 应用程序中监控它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T18:31:06.510

我们最近开始使用商业产品[新遗物](http://newrelic.com/product/real-user-monitoring)，对它印象深刻。它有很好的仪表板，并突出了监控服务器的 CPU、内存、SQL 慢等问题。

# vb.net - 如何测试 String = Enum.Value？

> ID：476931
> 
> 赞同：11
> 
> 时间：2009-01-25T00:06:47.900
> 
> 标签：vb.net, enums

如何对枚举值和应该与枚举名称匹配的字符串进行简单比较？

如何将字符串解析为适当的枚举值。

例如，

```
Enum A
     B=0
     C=1
     D=2
End Enum 
```

如何检查 String = AC 以及如何将字符串转换为其对应的 A 值而不将其与字符串表示形式进行比较？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-25T00:20:03.100

有几种不同的方法是相关的：

```
Enum.GetName(typeof(A), A.C) == "C"
A.C.ToString() == "C"
((A)Enum.Parse(typeof(A), "C")) == A.C 
```

前两个将 的值转换为`A.C`字符串表示 ( `"C"`)，然后将其与字符串进行比较。最后一个将字符串转换`"C"`为类型`A`，然后作为实际类型进行比较`A`。

枚举到字符串：`enumValue.ToString()`或`Enum.GetName(typeof(A), A.C)`

字符串到枚举：`(A)Enum.Parse(typeof(A), "C")`

请注意，如果枚举标有 ，则这些都不会真正起作用`FlagsAttribute`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-25T00:13:37.607

Enum.Parse[方法](http://msdn.microsoft.com/en-us/library/system.enum.parse.aspx)：

> 将一个或多个枚举常量的名称或数值的字符串表示形式转换为等效的枚举对象。参数指定操作是否区分大小写。

[这是来自MSDN](http://msdn.microsoft.com/en-us/library/kxydatf9.aspx)的 VB.NET 示例代码：

```
Module Example
   Public Sub Main()
      Dim colorStrings() As String = {"0", "2", "8", "blue", "Blue", "Yellow", "Red, Green"}
      For Each colorString As String In colorStrings
         Try
            Dim colorValue As Colors = CType([Enum].Parse(GetType(Colors), colorString, True), Colors)        
            If [Enum].IsDefined(GetType(Colors), colorValue) Or colorValue.ToString().Contains(",") Then 
               Console.WriteLine("Converted '{0}' to {1}.", colorString, colorValue.ToString())
            Else
               Console.WriteLine("{0} is not an underlying value of the Colors enumeration.", colorString)            
            End If                    
         Catch e As ArgumentException
            Console.WriteLine("{0} is not a member of the Colors enumeration.", colorString)
         End Try
      Next
   End Sub
End Module 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-25T00:11:01.917

`Enum.GetName(typeof(A),enumValue)==stringValue`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-06T03:12:55.743

您也可以使用 name() 函数来检查这个

```
A.C.name() == "C" 
```

# php - 选择什么来只存储一个整数？石榴石？还是文本文件？

> ID：476933
> 
> 赞同：5
> 
> 时间：2009-01-25T00:08:49.660
> 
> 标签：php, web-services, sqlite, text-files

我用 PHP 构建了一个小型 Web 服务。我想控制对特定 API 方法的调用次数。

起初我想使用文本文件，因为它只是一个整数。但是在仔细查看 SQLite 之后，它似乎更方便了。所以代码就是：从 SQLite 获取“计数器”并在调用该方法时将其递增，然后将其存储回 SQLite db。

这是正确的做法吗？只使用一个文件或者......也许其他东西会更简单，更具可扩展性吗？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-25T03:02:14.473

第三种可能性：[memcachedb](http://memcachedb.org/)。它与[memcached](http://www.danga.com/memcached/)兼容，但将它的键值存储存储到 BDB 文件中。它不仅具有读写命令，还具有数值的原子增量/减量。

另一种选择是编写一个“柜台服务器”。通过套接字获取“读取”和“增量”命令的独立进程。优点是做“原子”增量真的很容易。它将它的计数器存储在一个简单的文件中，没有并发问题，因为从不超过一台服务器。

用不到 100 行的 C 语言编写应该很容易。只需一个紧密循环，一次处理一个命令，每隔几秒刷新一次磁盘。由于处理非常简单，因此延迟很小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-25T00:16:21.813

数据库通常会比文件系统更好地扩展，但您需要小心并使用适当的锁与任何一种机制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-25T00:19:35.457

当然使用平面文件。

*   这将是正确的做法
*   极其简单
*   不依赖第三方库
*   您将能够仅使用普通记事本查看或更新计数器。
*   比 SQLite 更快（没有 SQL 解析，没有其他开销）
*   和 SQLite 一样可扩展（SQLite 只是更复杂的平面文件）

*如果您需要尽可能快的东西，则必须在内存中创建持久进程以消除 I/O 瓶颈。但是请...不要使用 SQL 数据库来存储单个整数。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T00:57:11.873

将它放在一个文本文件和 SQLite DB 的真实数据库中，如果文件当前处于打开状态并且发生新的打开它的请求，则第二个请求将出错。使用真正的数据库，如 MySQL、MSSQL 或任何可用的数据库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T03:27:49.180

您可以使用[共享内存](http://se.php.net/manual/en/book.shmop.php)来保存计数器，并使用[锁定](http://se.php.net/manual/en/ref.sem.php)来确保安全增量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T21:20:32.797

根据 SQLite，它可以处理高达“100K [*原文如此*] 点击/天”的网站。如果您要解决这个问题，您可能需要研究一个更强大的数据库，例如 MySQL。但是，如果您每天为一个网站向数据库写入 10 万条记录，根据您的示例，我认为您正在做的事情有问题。这听起来确实像是一项缓存工作。我对PHP一无所知，对不起。

They have this to say about files vs. SQLite: "Many programs use fopen(), fread(), and fwrite() to create and manage files of data in home-grown formats. SQLite works particularly well as a replacement for these ad hoc data files." ([source](http://www.sqlite.org/whentouse.html))

# editor - 编辑器中的 Jython 支持？

> ID：476939
> 
> 赞同：6
> 
> 时间：2009-01-25T00:13:11.413
> 
> 标签：editor, jython

我最近开始在[The Grinder 3](http://grinder.sourceforge.net/#What+is+The+Grinder%3F "The Grinder：Java（或 Jython，版本 3）负载测试框架")中编写一些性能测试，我注意到的第一件事是 PyCheckMate 不起作用，因为它找不到某些导入。哪些编辑器为 Jython 提供了最好的支持？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-25T04:25:43.450

[作为Eclipse](http://www.eclipse.org/) IDE的长期粉丝，我在处理 Python 和 Jython 项目时使用了[Pydev插件。](http://pydev.sourceforge.net/)

您可以获得代码完成、语法突出显示、重构、大纲视图、调试工具以及您期望从一流编辑器中获得的所有其他功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T21:36:00.723

正如大卫提到的 Pydev 一样，即使它是一款开发良好的软件，我也无法忍受日食。值得庆幸的是还有其他选择。最新版本的 Netbeans 具有 jython / python [www.netbeans.org](http://www.netbeans.org)和来自 activestate 的 Komodo [IDE](http://www.activestate.com/komodo)或免费的[komodo 编辑](http://www.activestate.com/komodo_edit)

并且几乎所有支持 python 的编辑器都会为您提供一定程度的支持，但就为 Jython 构建和设计的 IDE 而言......我认为 netbeans 是最接近的，否则使用名为 eclipse 的臃肿庞然大物的唯一原因是因为pydev 的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-18T06:10:57.397

现在尝试了一堆工具。适合所有人的绝佳解决方案（尤其是那些不喜欢 eclipse 的人——包括我在内！）：IntelliJ IDEA 14+ 社区版 + Python 插件。它为您提供 Jython 的代码完成、语法突出显示等，这意味着您可以编写出色的 Python 语法并为 Sikuli 等第三方内容获得代码完成 - 请查看此[示例](https://github.com/Tset-Noitamotua/Sikuli-and-Robot-Framework-Integration/issues/4)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-07T23:50:20.743

您还可以查看[TigerJython](http://jython.tobiaskohn.ch/)和[JythonMusic](https://jythonmusic.me/)。两者都支持纯 Jython（即 Python 语法 + 访问所有 J​​ava API），但也有额外的库。

# c# - 从基类引发事件

> ID：476942
> 
> 赞同：4
> 
> 时间：2009-01-25T00:15:03.127
> 
> 标签：c#, .net, winforms, events, inheritance

我知道可以在发生实现声明的类中引发事件，但我希望在基类级别引发事件并引发派生类的事件：

```
public interface IFoo
{
    event EventHandler<FooEventArgs> FooValueChanged;
    void RaiseFooValueChanged(IFooView sender, FooEventArgs  e);
}

[TypeDescriptionProvider(typeof(FooBaseImplementor))]
public abstract class FooBase : Control, IFoo
{
    public virtual event EventHandler<FooEventArgs> FooValueChanged;

    public void RaiseFooValueChanged(IFooView sender, FooEventArgs e)
    {
        FooValueChanged(sender, e);
    }
} 
```

我不能有 FooValueChanged 事件抽象，因为这样基类就不能引发事件。当前代码运行，但调用 FooValueChanged(sender, e) 抛出 NullReferenceException 因为它不调用派生类的事件，只调用基类的事件。

我哪里错了？

我可以将事件和引发者都抽象化，但是我需要记住在每个派生类中调用 FooValueChanged(sender, e) 。我试图避免这种情况，同时能够将 Visual Studio 设计器用于派生控件。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-25T00:38:53.377

首先请注意，您使用的事件声明是 C# 中的简写符号：

```
public event EventHandler Event;
public void RaiseEvent() {
    this.Event(this, new EventArgs());
} 
```

相当于：

```
private EventHandler backEndStorage;
public event EventHandler Event {
    add { this.backEndStorage += value; }
    remove { this.backEndStorage -= value; }
}
public void RaiseEvent() {
    this.backEndStorage(this, new EventArgs());
} 
```

backEndStorage 是一个多播委托。

* * *

现在你可以重写你的代码：

```
public interface IFoo
{
    event EventHandler<FooEventArgs> FooValueChanged;
    void RaiseFooValueChanged(IFooView sender, FooEventArgs  e);
}

[TypeDescriptionProvider(typeof(FooBaseImplementor))]
public abstract class FooBase : Control, IFoo
{
    protected event EventHandler<FooEventArgs> backEndStorage;
    public event EventHandler<FooEventArgs> FooValueChanged {
        add { this.backEndStorage += value; }
        remove { this.backEndStorage -= value; }
    }

    public void RaiseFooValueChanged(IFooView sender, FooEventArgs e)
    {
        this.backEndStorage(sender, e);
    }
}

public class FooDerived : FooBase {
    public event EventHandler<FooEventArgs> AnotherFooValueChanged {
        add { this.backEndStorage += value; }
        remove { this.backEndStorage -= value; }
    }
} 
```

所以现在在派生类上添加事件时，它们实际上会被添加到基类的 backEndStorage 中，从而允许基类调用派生类中注册的委托。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-25T00:54:38.803

最终结果：

```
public interface IFoo
{
    event EventHandler<FooEventArgs> FooValueChanged;
    void RaiseFooValueChanged(IFooView sender, FooEventArgs e);
}

[TypeDescriptionProvider(typeof(FooBaseImplementor))]
public abstract class FooBase : Control, IFoo
{
    protected event EventHandler<FooEventArgs> backEndStorage;
    public abstract event EventHandler<FooEventArgs> FooValueChanged;

    public void RaiseFooValueChanged(IFooView sender, FooEventArgs e)
    {
        if (backEndStorage != null)
            backEndStorage(sender, e);
    }
}

public class FooDerived : FooBase {
    public override event EventHandler<FooEventArgs> FooValueChanged {
        add { backEndStorage += value; }
        remove { backEndStorage -= value; }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T00:21:01.243

为什么需要使用事件？你不能只使用一个覆盖的方法。基类调用可覆盖的方法，该方法被派生类“拦截”，然后可以引发事件？

# python - 在 Python 中拆分大型 XML 文件

> ID：476949
> 
> 赞同：10
> 
> 时间：2009-01-25T00:22:01.163
> 
> 标签：python, xml

我希望将一个巨大的 XML 文件拆分成更小的位。我想扫描文件以查找特定标签，然后获取 和 之间的所有信息，然后将其保存到文件中，然后继续浏览文件的其余部分。

我的问题是试图找到一种干净的方法来记录标签的开始和结束，这样我就可以在使用“for line in f”扫描文件时抓取里面的文本

我宁愿不使用哨兵变量。有没有一种pythonic方法来完成这项工作？

文件太大，无法读入内存。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-25T00:49:08.970

处理 XML 数据的常用方法有两种。

一种称为 DOM，它代表文档对象模型。这种 XML 解析方式可能是您在查看文档时看到的，因为它将整个 XML 读入内存以创建对象模型。

第二种称为 SAX，它是一种流式方法。解析器开始读取 XML 并向您的代码发送有关某些事件的信号，例如，当找到新的开始标记时。

所以 SAX 显然是您的情况所需要的。Sax 解析器可以在[xml.sax](http://www.python.org/doc/2.5.2/lib/module-xml.sax.html)和[xml.parsers.expat](http://www.python.org/doc/2.5.2/lib/module-xml.parsers.expat.html)下的 python 库中找到。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-25T00:32:07.507

对于这种情况，您可以考虑使用 ElementTree [iterparse](https://docs.python.org/2/library/xml.etree.elementtree.html)函数。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-28T19:17:39.877

为了完成类似的任务，我使用 cElementTree.iterparse 方法取得了成功。

我有一个大型 xml 文档，其中包含带有标签“resFrame”的重复“条目”，我想过滤掉特定 ID 的条目。这是我用于它的代码：

源文档具有这种结构

```
<snapDoc>
  <bucket>....</bucket>
  <bucket>....</bucket>
  <bucket>....</bucket>
  ...
  <resFrame><id>234234</id>.....</resFrame>
  <frame><id>344234</id>.....</frame>
  <resFrame>...</resFrame>
  <frame>...</frame>
</snapDoc> 
```

我使用以下脚本创建了一个较小的文档，该文档具有相同的结构、存储桶条目，并且只有具有特定 ID 的 resFrame 条目。

```
#!/usr/bin/env python2.6

import xml.etree.cElementTree as cElementTree
start = '''<?xml version="1.0" encoding="UTF-8"?>
<snapDoc>'''

def main():
    print start
    context = cElementTree.iterparse('snap.xml', events=("start", "end"))
    context = iter(context)
    event, root = context.next() # get the root element of the XML doc

    for event, elem in context:
        if event == "end":
            if elem.tag == 'bucket': # i want to write out all <bucket> entries
               elem.tail = None  
               print cElementTree.tostring( elem )
            if elem.tag == 'resFrame':
                if elem.find("id").text == ":4:39644:482:-1:1": # i only want to write out resFrame entries with this id
                    elem.tail = None
                    print cElementTree.tostring( elem )
            if elem.tag in ['bucket', 'frame', 'resFrame']:
                root.clear()  # when done parsing a section clear the tree to safe memory
    print "</snapDoc>"

main() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-25T01:53:15.783

多么巧合！Will Larson 刚刚发表了一篇关于[在 Python 中处理非常大的 CSV 和 XML 文件](https://lethain.com/handling-very-large-csv-and-xml-files-in-python/)的好文章。

正如 Van 所提到的，主要的收获似乎是使用该`xml.sax`模块，并制作一些宏函数来抽象出低级 SAX API 的细节。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-02T16:42:26.303

这是来自 Uche Ogbuji 的也是非常好的 Python 和 XMl 专栏的一篇古老但非常好的文章。它涵盖了您的确切问题，并像其他答案所建议的那样使用标准库的 sax 模块。[分解、处理、重组](http://www.xml.com/pub/a/2004/07/28/py-xml.html)

# perl - Windows 上 Perl 的flock() 在哪里？

> ID：476951
> 
> 赞同：5
> 
> 时间：2009-01-25T00:26:27.347
> 
> 标签：perl, fcntl, flock

我有一个要在 Windows 上运行的 Perl 脚本，使用[Strawberry Perl](http://www.strawberry.com)或[ActivePerl](http://www.activestate.com)；我不在乎哪个。然而，这个脚本使用`flock()`调用，这似乎不包含在任何一个 Perl 版本中。

任何人都可以帮助启动并运行它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-25T01:24:02.253

是否安装了 Fcntl 模块？试试这个：

```
perl.exe -MFcntl -e 1 
```

如果它抱怨，你没有安装 Fcntl 模块。如果它没有抱怨，那么你可以访问 Fcntl::flock，所以把它放在你的脚本中：

```
use Fcntl qw(:DEFAULT :flock); 
```

然后你就走了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T09:32:33.983

尝试使用 perldoc -f flock 检查是否支持，然后查看给定示例以了解该函数的使用标准。这里从 perldoc 复制：

C:>perldoc -f 群

```
 use Fcntl ':flock'; # import LOCK_* constant

 sub lock {
     flock(MBOX,LOCK_EX);
     # and, in case someone appended
     # while we were waiting...
     seek(MBOX, 0, 2);
 }

 sub unlock {
     flock(MBOX,LOCK_UN);
 }

 open(MBOX, ">>/usr/spool/mail/$ENV{'USER'}") 
```

# objective-c - Xcode：删除行热键

> ID：476953
> 
> 赞同：19
> 
> 时间：2009-01-25T00:27:01.730
> 
> 标签：objective-c, xcode, keyboard-shortcuts

我正在寻找一种方法来映射一些热键以在 Xcode 中“删除我的光标所在的行”。我在文本键绑定中找到了“删除到行尾”和“删除到行首”，但是无论我选择了什么，我都想念如何完全删除该行。TextMate 将此功能映射到 Ctrl+Shift+D，如果可能的话，我想要同样的东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-26T00:17:01.427

谢谢你的帮助，阿什利。经过一些实验，我映射了我最喜欢的 TextMate 命令（重复行、删除行）。我创建了文件*~/Library/KeyBindings/PBKeyBinding.dict*并添加了以下内容：

```
{
    "^$K" = (
        "selectLine:",
        "cut:"
    );
    "^$D" = (
        "selectLine:",
        "copy:",
        "moveToEndOfLine:",
        "insertNewline:",
        "paste:"
    );
} 
```

添加的“deleteBackward：”在删除该行的内容后备份该行。您也可以只使用“selectLine:”。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-25T17:34:26.357

您可以设置适用于所有 Cocoa 应用程序的系统范围的键绑定文件。

做你想做的事情应该是这样的：

在您的主文件夹中，Library/KeyBindings/DefaultKeyBinding.dict

```
{
    "^D" = (
        "moveToBeginningOfLine:",
        "deleteToEndOfLine:",
    );
} 
```

我相信如果你只希望它适用于 Xcode，你可以命名文件`PBKeyBinding.dict`，但我自己没有尝试过。[您可以在此处](https://developer.apple.com/library/mac/documentation/cocoa/conceptual/eventoverview/TextDefaultsBindings/TextDefaultsBindings.html)和[此处](https://web.archive.org/web/20090826052401/http://www.erasetotheleft.com/post/mac-os-x-key-bindings)阅读有关此系统的更多信息。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-11-19T11:51:16.673

因为我并不总是在同一个 xcode 上工作，所以我不想安装脚本。

Xcode 使用一些 emacs 命令的子集。我使用这种方法来快速删除一行。^k (control-k) 从光标处删除到行尾。这样做两次也会删除回车并占用下一行。^a 将您带到行首。

因此，要从头开始删除完整的行，您可以使用 ^a^k^k。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-04-04T00:50:59.807

我一直在寻找解决方案，并尝试了 Ashley Clark 的解决方案，但事实证明，使用包含的名为 delete Line 的用户脚本有一个更简单的选项。

*   打开看起来像卷轴的“帮助”左侧的奇怪菜单。
*   选择编辑用户脚本...
*   单击键绑定选项卡
*   展开文本部分
*   双击“删除行”旁边的 ⌘ 列，然后键入您的热键。它可能会警告您从其他命令中窃取了它，但这很好。

完毕！如果您像我一样是 Eclipse 迷，您可以对 Move Line Up 和 Move Line Down 执行相同的操作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-10-31T08:12:46.327

```
<key>Custom Keyword Set</key>
<dict>
 <key>Delete Current Line In One Hit</key>
     <string>moveToEndOfLine:, deleteToBeginningOfLine:, deleteToEndOfParagraph:</string>
</dict> 
```

**我建议在您的文件IDETextKeyBindingSet.plist**中创建您的自定义字典。

所以：

*   关闭 Xcode；
*   打开终端；
*   sudo nano /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Resources/IDETextKeyBindingSet.plist
*   添加新的自定义部分，例如顶部的代码；
*   保存、退出和打开 Xcode；
*   [Xcode > 首选项 > 键绑定]
*   搜索“删除..”并创建新的快捷方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-06-17T11:27:50.700

对于 Xcode 9.0（beta），将自定义键字典插入 IDETextKeyBindingSet.plist 对我来说工作正常。如果 XCode 已经打开，则需要重新启动，下次启动后，您将在 KeyBindings 菜单下找到新的自定义快捷方式。

```
<key>Customized</key>
<dict>
    <key>Delete Rest Of Line</key>
    <string>deleteToEndOfLine:</string>
    <key>Delete Line</key>
    <string>moveToBeginningOfLine:, deleteToEndOfLine:</string>
    <key>Duplicate Current Line</key>
    <string>selectLine:, copy:, moveToEndOfLine:, insertNewline:, moveToBeginningOfLine:, paste:</string>
</dict> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-01T15:48:55.490

这对我有用（Xcode 4.4.1）：

与此处描述的相同步骤：[Xcode 重复行](https://stackoverflow.com/questions/10266170/xcode-4-duplicate-line)（Halley 的回答）

但不是：

selectLine:, copy:, moveToEndOfLine:, insertNewline:, paste:, deleteBackward:

采用：

selectLine:, moveToBeginningOfLine:, deleteToEndOfLine:

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-09T04:14:30.750

如果您在 Xcode 7.2 中的现代 Xcode（我曾经是）解决方案中遇到问题，请[通过 Velthune 的回答执行 Opena](https://stackoverflow.com/a/26670057/5760384)[在此处使用屏幕截图](https://stackoverflow.com/a/13049587/5760384)或文本形式提到的内容。由于我想要一个更直接的命令，我将命令简化为：

```
selectLine:, delete:, moveToBeginningOfLine: 
```

当然，在 Xcode 的 Preferences >> Key Bindings 中，你可以直接在 Key 栏下找到命令双击，然后给它自己的 Ctrl+Shift+D 绑定。

[这是我最终得到的截图](https://i.stack.imgur.com/KtRQU.png)

# math - 为什么程序不能被证明？

> ID：476959
> 
> 赞同：61
> 
> 时间：2009-01-25T00:32:13.637
> 
> 标签：math, theory, proof, axiom, formal-verification

为什么不能像数学陈述一样证明计算机程序？数学证明建立在其他证明的基础上，这些证明建立在更多证明和公理之上——我们认为这些真理是不言而喻的。

计算机程序似乎没有这样的结构。如果你写一个计算机程序，你怎么能把以前证明过的作品拿来用它们来证明你的程序的真实性？你不能，因为不存在。此外，编程的公理是什么？该领域的原子真理？

我对上述问题没有很好的答案。但似乎软件无法被证明，因为它是艺术而不是科学。如何证明毕加索？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-01-25T00:57:56.190

证明[是](http://en.wikipedia.org/wiki/Curry-Howard_correspondence)程序。

[程序的形式验证](http://en.wikipedia.org/wiki/Formal_verification)是一个*巨大*的研究领域。（例如，参见[卡内基梅隆大学的小组](http://www.cs.cmu.edu/%7Esvc/)。）

许多复杂的程序已经过验证；例如，查看这个[用 Haskell 编写的内核](http://trustworthy.systems/publications/papers/Klein_NEH_07.pdf)（已修复的 404 链接用于[seL4](https://scholar.google.com/citations?user=XV9ZVncAAAAJ)，另请参阅[移至位置](https://data61.csiro.au/en/Our-Research/Our-Work/Safety-and-Security/Secure-Systems-and-Platforms/seL4-kernel)和[项目网站](http://sel4.systems/)）。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-01-25T00:59:54.317

程序绝对*可以*被证明是正确的。糟糕的程序很难证明。为了做得更好，您必须改进程序并携手证明。

由于停机问题，您无法*自动化证明。*但是，您可以手动证明任意语句或语句序列的后置条件和前置条件。

您必须阅读 Dijsktra 的[A Discipline of Programming](https://rads.stackoverflow.com/amzn/click/com/013215871X)。

然后，您必须阅读 Gries 的《[编程科学》](https://rads.stackoverflow.com/amzn/click/com/0387964800)。

然后你就会知道如何证明程序是正确的。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-25T00:59:42.413

停机问题仅表明存在无法验证的程序。一个更有趣和更实际的问题是**可以**正式验证哪类程序。也许任何人关心的每个程序都可以（理论上）得到验证。 ~~在实践中，到目前为止，只有非常小的程序被证明是正确的。~~

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-01-25T01:01:18.587

对那些提出不完整性的人来说只是一个小小的评论——并非*所有*公理系统都是如此，只有*足够强大*的公理系统。

换句话说，哥德尔证明了一个足以描述自身的公理系统必然是不完整的。然而，这并不意味着它没有用，并且正如其他人所链接的那样，已经对程序证明进行了各种尝试。

双重问题（编写程序来检查证明）也很有趣。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-01-25T01:37:25.630

实际上，您可以编写可证明正确的程序。例如，微软创建了一个名为[Spec#](http://research.microsoft.com/en-us/projects/specsharp/)的 C# 语言扩展，其中包括一个自动定理证明器。对于 java，有[ESC/java](http://secure.ucd.ie/products/opensource/ESCJava2/)。我敢肯定还有更多的例子。

（**编辑**：显然 spec# 不再被开发，但[合约工具将成为 .NET 4.0 的一部分](http://blogs.msdn.com/bclteam/archive/2008/11/04/what-s-new-in-the-bcl-in-net-4-0-justin-van-patten.aspx)）

[我看到一些海报对暂停问题](http://en.wikipedia.org/wiki/Halting_problem)或[不完整性定理](http://en.wikipedia.org/wiki/G%C3%B6del%27s_incompleteness_theorems)挥手致意，这可能会阻止程序的自动验证。这当然不是真的；这些问题只是告诉我们有**可能编写无法证明正确或不正确的程序**。这并不妨碍我们构建**可**证明是正确的程序。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-25T00:58:53.117

如果你真的对这个话题感兴趣，让我先推荐 David Gries 的《The Science of Programming》，这是一本关于这个话题的经典入门著作。

实际上，在某种程度上证明程序是正确的是可能的。您可以编写前置条件和后置条件，然后证明给定一个满足前置条件的状态，执行后的结果状态将满足后置条件。

然而，它变得棘手的地方是循环。对于这些，您还需要找到一个循环不变量并显示正确的终止，您需要在每个循环后剩余的最大可能迭代次数上找到一个上限函数。您还必须能够证明，在循环的每次迭代之后，这至少会减少 1 个。

一旦你为一个程序准备了所有这些，证明是机械的。但不幸的是，没有办法自动导出循环的不变函数和绑定函数。对于具有小循环的琐碎情况，人类的直觉就足够了，但实际上，复杂的程序很快就会变得难以处理。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-25T01:37:26.020

首先，你为什么说“程序无法被证明”？

无论如何，您所说的“程序”是什么意思？

如果通过程序你的意思是算法你不知道克鲁斯卡尔的吗？迪杰斯特拉？MST？普里姆？二进制搜索？合并排序？DP？所有这些事物都有描述其行为的数学模型。

描述。数学没有解释事情的原因，它只是描绘了如何。我无法向你证明太阳明天会在东方升起，但我可以显示过去它在哪里做这件事的数据。

你说：“如果你写一个计算机程序，你怎么能把以前证明过的作品拿来用它们来证明你的程序的真实性？你不能，因为不存在”

等待？你不能？ [http://en.wikipedia.org/wiki/Algorithm#Algorithmic_analysis](http://en.wikipedia.org/wiki/Algorithm#Algorithmic_analysis)

我无法向您展示“真相”，就像我无法向您展示有关语言的“真相”一样。两者都是我们对世界的经验理解的代表。不在“真相”之上。抛开所有的胡言乱语，我可以在数学上向你证明，归并排序算法将以 O(nlogn) 性能对列表中的元素进行排序，Dijkstra 将找到加权图上的最短路径，或者欧几里得算法会发现你是最棒的两个数之间的公约数。在最后一种情况下，“我的程序中的真相”也许是我会找到两个数字之间的最大公约数，你不觉得吗？

通过递归方程，我可以向您描述您的斐波那契程序是如何工作的。

现在，计算机编程是一门艺术吗？我当然认为是。和数学一样。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-25T23:31:21.770

我不是来自数学背景，所以请原谅我的无知，但是“证明程序”是什么意思？你在证明什么？正确性？正确性是程序必须验证为“正确”的规范。但是这个规范是由人决定的，你如何验证这个规范是正确的？

在我看来，程序中存在错误是因为人类难以表达他们真正想要的东西。 [替代文字 http://www.processdevelopers.com/images/PM_Build_Swing.gif](http://www.processdevelopers.com/images/PM_Build_Swing.gif)

那你证明什么？注意力不集中导致的bug？

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-31T03:54:53.010

> 此外，编程的公理是什么？该领域的原子真理？

我已经完成了一门名为基于合同的编程的课程（课程主页：[http](http://www.daimi.au.dk/KBP2/) ://www.daimi.au.dk/KBP2/ ）。这是我可以从课程中推断出来的（以及我参加过的其他课程）

您必须正式（数学上）定义语言的语义。让我们考虑一种简单的编程语言；一个只具有全局变量、整数、整数数组、算术、if-then-else、while、赋值和无操作[你可以使用任何主流语言的一个子集作为这个的“实现”]。

执行状态将是对（变量名，变量值）的列表。将“{Q1} S1 {Q2}”读作“执行语句 S1 将您从执行状态 Q1 带到状态 Q2”。

一个公理将是`"if both {Q1} S1 {Q2} and {Q2} S2 {Q3}, then {Q1} S1; S2 {Q3}"`。也就是说，如果语句 S1 将您从状态 Q1 带到 Q2，并且语句 S2 将您从 Q2 带到 Q3，那么“S1；S2”（S1 后跟 S2）将您从状态 Q1 带到状态 Q3。

另一个公理是`"if {Q1 && e != 0} S1 {Q2} and {Q1 && e == 0} S2 {Q2}, then {Q1} if e then S1 else S2 {Q2}"`。

现在，进行一点改进：{} 中的 Qn 实际上是关于状态的陈述，而不是状态本身。

假设 M(out, A1, A2) 是一个合并两个排序数组并将结果存储在 out 中的语句，并且我在下一个示例中使用的所有单词都被正式表达（数学上）。然后`"{sorted(A1) && sorted(A2)} A := M(A1, A2) {sorted(A) && permutationOf(A, A1 concatened with A2)}"`是声称 M 正确地实现了合并算法。

可以尝试通过使用上述公理来证明这一点（可能需要其他一些公理。您可能需要一个循环）。

我希望这能说明证明程序正确的样子。相信我：即使是看似简单的算法，也需要*大量的工作来证明它们是正确的。*我知道，我读了很多尝试 ;-)

[如果你读到这个：*你的*交接很好，是所有其他的都让我头疼；-)]

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-29T21:41:04.387

他们当然可以，正如其他人所发布的那样。

证明一个非常小的子程序正确是一个很好的练习，恕我直言，每个与编程相关的学位课程的本科生都应该被***要求***做。它让您深入了解如何使您的代码清晰、易于审查和维护。

然而，在现实世界中，它的实际用途有限。

首先，就像程序有错误一样，数学证明也有。如何证明数学证明确实正确并且没有任何错误？你不能。举个反例，任何数量的已发表的数学证明都在其中发现了错误，有时甚至是几年后。

其次，如果没有“先验”对程序应该做什么的明确定义，您就无法证明程序是正确的。但是任何对程序应该做什么的明确定义都是程序。（虽然它可能是某种规范语言的程序，但你没有编译器。）因此，在你证明一个程序是正确的之前，你必须首先有另一个等价的程序并且事先知道是正确的。所以 QED 整个事情都是徒劳的。

我建议您参考 Brooks 的经典“ **No Silver Bullet** ”文章。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-25T00:49:32.073

在这方面有很多研究......正如其他人所说，程序语言中的结构很复杂，当尝试验证或证明任何给定的输入时，情况只会变得更糟。

然而，许多语言允许规范，关于哪些输入是可接受的（前置条件），并且还允许指定最终结果（后置条件）。

此类语言包括：B、Event B、Ada、fortran。

当然，有许多工具旨在帮助我们证明程序的某些属性。例如，为了证明死锁自由，可以通过 SPIN 处理他们的程序。

还有许多工具也可以帮助我们检测逻辑错误。这可以通过静态分析（goanna、satabs）或实际执行代码（gnu valgrind？）来完成。

但是，没有一种工具可以真正让人们证明整个程序，从开始（规范）、实施和部署。B 方法很接近，但它的实现检查非常弱。（它假设人类在将规范转化为实现方面是无懈可击的）。

* * *

附带说明一下，在使用 B 方法时，您会经常发现自己从较小的公理构建复杂的证明。（这同样适用于其他详尽的定理证明）。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-25T01:12:25.430

他们能。作为一名大学新生，我花了很多很多时间做程序正确性证明。

在宏观上它不实用的原因是编写程序的证明往往比编写程序要困难得多。此外，今天的程序员倾向于构建系统，而不是编写函数或程序。

在微观范围内，我有时会在心里为个别功能做这件事，并且倾向于组织我的代码以使它们易于验证。

有一篇关于航天飞机软件的著名文章。他们做证明，或类似的东西。这是非常昂贵和耗时的。这种级别的验证对他们来说可能是必要的，但对于任何类型的消费者或商业软件公司来说，使用当前技术，你的午餐会被竞争对手以 1% 的成本提供 99.9% 的解决方案吃掉。没有人愿意花 5000 美元购买稍微稳定一点的 MS Office。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-25T06:01:05.253

如果您正在寻找信心，证明程序的替代方法是测试它们。这更容易理解并且可以自动化。如上所述，它还允许在数学上不可能证明的程序类。

**最重要的是，没有任何证据可以替代通过验收测试：***

*   仅仅因为一个程序确实做到了它所说的，并不意味着它做了用户想要它做的事情。

    *   *除非*你能证明它所说的就是用户所说的他们想要的。

        *   然后你必须证明他们*真正想要*的是什么，因为作为用户，他们几乎肯定不知道他们想要什么。等等。 荒谬的归约。

*更不用说单元、覆盖率、功能、集成和所有其他类型的测试。

希望这对您的道路有所帮助。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-25T16:55:54.533

这里没有提到的是[B - Method](http://en.wikipedia.org/wiki/B-Method)，它是一个基于正式方法的系统。它被用来开发巴黎地铁的安全系统。有一些工具可用于支持 B 和 Event B 开发，尤其是[Rodin](http://sourceforge.net/projects/rodin-b-sharp/)。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-30T17:17:54.263

您不仅可以证明程序，还可以让您的计算机从证明中构建程序。请参阅[Coq](http://coq.inria.fr/)。因此，您甚至不必担心在您的实施过程中出现错误的可能性。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-25T00:45:32.020

[尽管有哥德尔定理](http://en.wikipedia.org/wiki/G%C3%B6del%27s_incompleteness_theorems)......这有什么意义？你想证明什么简单的“真理”？你想从这些真理中得到什么？虽然我可以吃这些话......实用性在哪里？

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-30T17:35:04.820

程序可以被证明。如果您使用诸如新泽西标准 ML (SML/NJ) 之类的语言编写它们，这将非常容易。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-04-27T08:56:37.673

你的陈述很广泛，所以它钓到了很多鱼。

底线是：某些程序绝对可以被证明是正确的。*不能*证明所有程序都是正确的。

请注意，这是一个简单的例子，它与过去破坏集合论的证明完全相同：编写一个可以确定自身是否正确的程序，如果它发现它*是*正确的，则给出错误的答案。

这就是哥德尔定理，简单明了。

但这不是问题，因为我们可以证明很多程序。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-07-29T11:53:23.720

让我们假设一种纯函数式语言（即 Haskell）。在这些语言中可以非常清楚地考虑副作用。

证明程序产生正确的结果需要您指定：

1.  数据类型和数学集之间的对应关系
2.  Haskell 函数和数学函数之间的对应关系
3.  一组公理，指定您可以从其他人构建哪些函数，以及数学方面的相应构造。

这组规范称为*指称语义*。它们允许您证明使用数学的程序的原因。

好消息是“程序的结构”（上面的第 3 点）和“数学集的结构”非常相似（流行语是*topos*或*笛卡尔封闭类别*），所以 1/ 你在数学方面所做的证明将很容易地转换为程序结构 2/ 您编写的程序很容易证明在数学上是正确的。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-25T00:50:33.243

阅读[停止问题](http://en.wikipedia.org/wiki/Halting_problem)（这是关于证明程序是否完成这样简单的事情的难度）。从根本上说，这个问题与哥德尔的不完备定理有关。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-25T00:51:32.757

程序的某些部分可以被证明。例如，如果编译成功，静态验证和保证类型安全的 C# 编译器。但我怀疑您问题的核心是证明程序执行正确。许多（我不敢说大多数）算法可以被证明是正确的，但是由于以下原因，可能无法静态地证明整个程序：

*   验证需要遍历所有可能的分支（调用、ifs 和中断），这在高级程序代码中具有超立方时间复杂度（因此它永远不会在合理的时间内完成）。
*   某些编程技术，无论是通过制作组件还是使用反射，都无法静态预测代码的执行（即，您不知道其他程序员将如何使用您的库，编译器很难预测消费者中的反射将如何调用功能。

而这些只是一些...

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-25T00:56:42.700

> 此外，编程的公理是什么？该领域的原子真理？

**操作码**是“原子真理”吗？比如看到...

```
mov ax,1 
```

... 程序员可能不会断言，除非出现硬件问题，否则在执行此语句后 CPU 的`ax`寄存器现在将包含`1`?

> 如果你写一个计算机程序，你怎么能把以前证明过的作品拿来用它们来证明你的程序的真实性？

那么“以前的工作”可能是新程序运行的运行时环境。

新程序可以被证明：除了形式证明之外，它可以通过“检查”和各种形式的“测试”（包括“验收测试”）来证明。

> 如何证明毕加索？

如果软件更像工业设计或工程而不是艺术，那么更好的问题可能是“你如何证明一座桥梁或一架飞机？”

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-01-25T00:57:14.400

如果程序有明确定义的目标和初始假设（忽略哥德尔......），它可以被证明。找到所有素数 x，对于 6<=x<=10，你的答案是 7，这是可以证明的。我写了一个[玩 NIM 的程序](http://www.astro.washington.edu/users/bastidas/codes/nim.py)（我写的第一个 Python 程序），理论上计算机总是在游戏进入计算机可以获胜的状态后获胜。我无法证明它是真的，但它是真的（在数学上通过数字二进制和证明）我相信除非我在代码中犯了错误。我是否犯了错误，不严重，有人可以告诉我这个程序是否可以击败？

有一些数学定理已经用计算机代码“证明”了，比如[四色定理](http://en.wikipedia.org/wiki/Four_color_theorem)。但是有人反对，因为就像你说的，你能证明这个程序吗？

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-01-25T16:01:38.213

证明程序正确只能相对于程序的规范进行；这是可能的，但昂贵/耗时

一些 CASE 系统产生的程序比其他系统更适合证明——但这又依赖于规范的形式语义......

...那么您如何证明规范正确？对！规格更多！

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-01-30T18:30:13.600

我读了一些关于这个，但有两个问题。

首先，你不能证明一些叫做正确性的抽象事物。如果设置正确，您可以证明两个形式系统是等价的。您可以证明一个程序实现了一组规范，并且通过或多或少并行构建证明和程序来做到这一点是最简单的。因此，规范必须足够详细，以提供一些可以证明的东西，**因此规范实际上是一个程序**。编写程序以满足目的的问题变成了编写程序的正式详细规范以满足目的的问题，这不一定是向前迈出的一步。

第二，程序复杂。正确性证明也是如此。如果您在编写程序时会犯错误，那么您肯定可以进行一次证明。Dijkstra 和 Gries 基本上告诉我，如果我是一个完美的数学家，我可以成为一个优秀的程序员。这里的价值在于证明和编程是两个有些不同的思维过程，至少根据我的经验，我犯了不同类型的错误。

以我的经验，证明程序并不是没有用的。当我尝试做一些我可以正式描述的事情时，证明实现正确可以消除很多难以发现的错误，主要是留下愚蠢的错误，我可以在测试中轻松发现这些错误。在必须生成极无错误代码的项目中，它可能是一个有用的辅助工具。它并不适合所有应用程序，当然也不是灵丹妙药。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-04-27T11:01:25.813

正如其他人指出的那样，（某些）程序确实可以得到证明。

然而，实践中的一个问题是，您首先需要一些您想要证明的*东西（即假设或定理）。*因此，要证明某个程序的某些内容，您首先需要正式描述它应该做什么（例如，前置条件和后置条件）。

换句话说，您需要程序的正式规范。但是即使是一个合理的（更不用说严格的正式的）规范已经是软件开发中最困难的事情之一了。因此，证明（现实世界）程序的*有趣之处通常非常困难。*

然而，有些事情可以（并且已经）更容易形式化（和证明）。如果您至少可以证明您的程序不会崩溃，那已经是:-)。

顺便说一句，一些编译器警告/错误本质上是关于程序的（简单）证明。例如，Java 编译器将证明您永远不会在代码中访问未初始化的变量（否则它会给您一个编译器错误）。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-05-07T07:31:01.193

我还没有阅读所有的答案，但我看到它的方式，证明程序是没有意义的，这就是为什么没有人这样做。

如果您有一个相对较小/中型的项目（例如，10K 行代码），那么证明可能也是 10k 行，如果不是更长的话。

想想看，如果程序可以有bug，那么证明也可以有“bug”。也许你需要一个证明来证明！

要考虑的另一件事是，程序非常正式和精确。你不能变得更严格和正式，因为程序代码必须由一台非常愚蠢的机器执行。

虽然证明将被人类阅读，但它们往往不如实际代码严格。

您唯一需要证明的是对特定数据结构进行操作的低级算法（例如快速排序、插入二叉树等）。

这些事情有些复杂，它们为什么起作用和/或它们是否会一直起作用并不是很明显。它们也是所有其他软件的基本构建块。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-11-07T14:57:22.733

大多数答案都集中在实践上，这没关系：在实践中，您并不关心正式的校对。但理论上是什么？

程序可以像数学陈述一样被证明。但不是你说的那个意思！在任何足够强大的框架中，都有无法证明的数学语句（和程序）！看[这里](http://en.wikipedia.org/wiki/G%C3%B6del%27s_incompleteness_theorems)

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2010-12-08T19:19:57.567

这里有这么多噪音，但无论如何我都会在风中大喊大叫......

“证明正确”在不同的语境中有不同的含义。在[正式系统中](http://en.wikipedia.org/wiki/Formal_system)，“证明正确”意味着一个公式可以从其他经过证明的（或公理化的）公式推导出来。编程中的“证明正确”只是显示代码等同于正式规范。但是你如何证明正式的规范是正确的？可悲的是，除了通过测试之外，没有办法证明规范没有错误或解决任何现实世界的问题。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2011-11-09T00:43:27.337

只是我的 2 美分，增加了已经存在的有趣的东西。

在所有无法证明的程序中，最常见的是那些执行 IO（与世界或用户进行一些不可预测的交互）的程序。即使是自动证明有时也会忘记“经过验证的”程序在某些物理硬件上运行，而不是模型描述的理想硬件。

另一方面，数学证明并不关心世界。数学中一个反复出现的问题是它是否描述了任何真实的东西。每当发明虚数或非欧几里得空间等新事物时，它就会被提出。然后这个问题就被遗忘了，因为这些新理论是很好的工具。就像一个好的程序一样，它可以正常工作。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2012-06-10T10:47:48.633

从不那么抽象的角度来看，证明某事是将不确定性领域减少到已证明的零集的问题。这是一厢情愿的想法，因为在现实世界中无法达到完美。

如果计算机程序的环境没有（或不能）被证明，则计算机程序可以在现实世界中证明是正确的并失败：

*   必须证明 OS 内核、驱动程序和所有用户模式库和并发执行的程序，包括它们的直接和间接短期和长期副作用，

*   硬件必须始终按预期运行（包括停电、洪水、地震、EMF 干扰等），

*   最终用户必须始终按预期行事（著名的因素“X”）。

自动纠错是在各种硬件组件（RAM、磁盘、控制器等）中实现的，但是仍然会发生硬件故障——在`provably correct`程序中产生级联错误和/或故障。

而且我什至不想对最终用户的创造力进行尾声……

因此，（正确）评级的程序`provably correct`并不意味着它`provably safe`在现实生活中。

这意味着，对于*定义研究*中考虑的集合（只能是现实世界的一个子集），该程序将按预期运行。

# c - 由初始化列表初始化的数组存储在哪里？

> ID：476961
> 
> 赞同：5
> 
> 时间：2009-01-25T00:34:17.300
> 
> 标签：c, memory

鉴于这段代码：

```
(void)someFunction(void) {
    int array[] = {1,2,3,4,5,6,7,8,9,10};
} 
```

数组的值存储在哪里？

*   堆？
*   堆？
*   连同那些字符串文字。（是不是叫高频堆？）
*   别的地方？

我问是因为我不确定这个问题：

[在objective-c中创建一个整数属性数组](https://stackoverflow.com/questions/476843/create-an-array-of-integers-property-in-objective-c)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-25T00:42:46.893

数组本身将在堆栈上。在函数的入口处会有一些代码将存储在全局/静态内存区域中某个未命名数组中的值复制到堆栈上的本地数组中。具有初始值的未命名全局/静态数组很可能与字符串文字位于相同的通用内存区域中。

但是请注意，标准都不需要这些 - 但它几乎是任何编译器将实现它的方式。一个足够聪明的编译器可能会注意到这些值只是递增的整数值，并且可能会生成一个循环来初始化本地数组，

（这个答案假设 C/C++ - 我不知道 Objective-C 是否会改变这一切）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T00:51:58.480

正如 Micheal 所说，初始化列表的值将存储在哪里取决于编译器和优化级别。例如，没有优化的 gcc 只会生成将常量移动到数组中适当位置的代码，即实际值将仅存储在代码本身中。如果您不编译为目标代码，您可以轻松检查会发生什么，而是让您的编译器输出汇编程序。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-11-05T18:23:59.477

如果有人读到这篇文章是为 C# 看的，答案就不同了。数组是引用类型，因此值存储在堆上并在堆栈上引用。

# ruby-on-rails - “RAILS_GEM_VERSION”设置到底有什么作用？

> ID：476962
> 
> 赞同：5
> 
> 时间：2009-01-25T00:35:19.467
> 
> 标签：ruby-on-rails, ruby, deployment, configuration

`RAILS_GEM_VERSION`设置的目的是什么`config/environment.rb`？它是否应该阻止您的应用程序在意外版本的 Rails 下运行？

我只是在我的笔记本电脑和生产环境中将 Rails 更新到最新版本。既然我这样做了，我可以注释掉`RAILS_GEM_VERSION`还是出于某种原因应该设置它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-25T00:45:27.060

由于您的系统上可以安装多个版本的 Rails（您可以使用 gem list rails 检查），因此您的应用程序需要知道它应该使用哪个版本。仅仅“让 Rails 更新到最新版本”并让应用程序使用最新版本并不是很聪明，因为新版本的 Rails 很容易破坏它（每个新版本都意味着对 API 进行一些更改）。但是，如果您在供应商文件夹中“冻结”您的应用程序所构建的 Rails 版本，则此常量无关紧要。顺便提一句。冻结 Rails 是一种很好的做法，因为您的应用程序将更加独立于环境。

# c - 在 C 中不使用 math.h 中的 sqrt() 的预定义平方根函数

> ID：476966
> 
> 赞同：-1
> 
> 时间：2009-01-25T00:39:16.807
> 
> 标签：c, windows, math

**作业问题：**

*   Cygwin GNU **GDB**
*   Cygwin GNU **GCC**

尝试从**A**的 2 次方和**B**的 2 次方的平方根来确定**斜边**C 的长度。

 ******示例**输入：

输入直角三角形两条边的长度：2.25 8.33

**回答：**

斜边的长度为：8.628523

*   **问题：**当我指定与上面相同的输入时，结果不**一样**- 输出为**19.84.9596**

完整**代码**如下：

```
float squareRoots(float *s)
{
    float cx;
    float nx;
    float e;

    cx = 1;
    nx = (cx +*s/cx)/2;
    e = nx - cx;
    cx = nx;

    if (e*e > 0.001)
    {
        nx = (cx +*s/cx)/2;
        return nx;
    } else {
        return nx;
    }
}

float hypotenuse(float *a, float *b)
{
    float c;
    //raise a to power of 2
    *a = (*a * *a);
    *b = (*b * *b);
    //add a and b
    float y = *a + *b;
    c = squareRoots(&y);

    return c;
}

int main()
{
    float x,y;

    printf("Enter the length of two sides of a right-angled triangle:");
    scanf("%f %f", &x, &y);
    float k=hypotenuse(&x,&y);

    printf("The length of the hypotenuse is: %f", k);

    exit(0);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-25T01:33:30.333

您（应该是？）使用的平方根算法称为[牛顿法](http://en.wikipedia.org/wiki/Newton%27s_method)。你的 if 语句应该是一个 while 循环。

代替

```
if (e*e > 0.001)
{
        nx = (cx +*s/cx)/2;
        return nx;
} else {
        return nx;
} 
```

使用 while 循环迭代地执行相同的操作，但包括重新计算 e。

我会给你工作代码，但你说这是作业。如果你不能让它工作，发布你的新代码，我很乐意帮助你解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-25T00:47:58.910

想要一个超级重复的平方根实现吗？从 Quake III 中查看[John Carmack 的魔方根](http://www.codemaestro.com/reviews/9)。

```
float Q_rsqrt( float number )
{
  long i;
  float x2, y;
  const float threehalfs = 1.5F;

  x2 = number * 0.5F;
  y  = number;
  i  = * ( long * ) &y;  // evil floating point bit level hacking
  i  = 0x5f3759df - ( i >> 1 ); // what the ****?
  y  = * ( float * ) &i;
  y  = y * ( threehalfs - ( x2 * y * y ) ); // 1st iteration
  // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, this can be removed

  #ifndef Q3_VM
  #ifdef __linux__
    assert( !isnan(y) ); // bk010122 - FPE?
  #endif
  #endif
  return y;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-25T00:46:32.627

我的答案是 8.628522469，即 8.628522。

# java - 使用来自 python 的 java 库

> ID：476968
> 
> 赞同：40
> 
> 时间：2009-01-25T00:41:22.293
> 
> 标签：java, python, jython

我有一个 python 应用程序和一个 java 应用程序。python 应用程序为 java 应用程序生成输入并在命令行上调用它。

我确信必须有一个更优雅的解决方案；就像使用 JNI 从 Java 调用 C 代码一样。

任何指针？（仅供参考，我是 Python 新手）

**澄清**（以一个很长的问题为代价：道歉） py 应用程序（我不拥有）以许多配置文件的形式接受用户输入。然后它通过插件机制解释这些和农场工作到许多（隐藏的）工具。我希望添加对旧版 Java 应用程序提供的功能的支持。

所以从java应用程序调用python应用程序没有意义，我不能在jython环境（在JVM上）运行py应用程序。

由于没有明显的机制，我认为简单的 CL 调用是最好的解决方案。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2010-09-25T10:51:57.410

很抱歉恢复线程，但没有接受的答案......

您也可以使用[Py4J](http://py4j.sourceforge.net/index.html)。头版上有一个示例和大量文档，但本质上，您只需从 Python 代码中调用 Java 方法，就好像它们是 Python 方法一样：

```
>>> from py4j.java_gateway import JavaGateway
>>> gateway = JavaGateway()                        # connect to the JVM
>>> java_object = gateway.jvm.mypackage.MyClass()  # invoke constructor
>>> other_object = java_object.doThat()
>>> other_object.doThis(1,'abc')
>>> gateway.jvm.java.lang.System.out.println('Hello World!') # call a static method 
```

与 Jython 不同，Py4J 在 Python VM 中运行，因此它始终与最新版本的 Python “保持同步”，并且您可以使用在 Jython 上运行不佳的库（例如 lxml）。通信是通过套接字而不是 JNI 完成的。

*免责声明：我是 Py4J 的作者*

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-25T00:46:46.043

看看[Jython](http://www.jython.org/)。它有点像 JNI，但是用 Python 代替 C，即你可以从 Java 调用 Python，反之亦然。目前尚不清楚您要做什么，或者为什么您当前的方法不是您想要的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-25T10:50:46.837

将您的 Java 代码包装在一个容器（Servlet / EJB）中。

因此，您不会在 vm-startup 中浪费时间，而是走上了更加面向服务的道路。

对于包装，您可以使用 jython（*只有在您熟悉 python 时才有意义*）

选择python和java可以使用的通信协议：

*   json（见 www.json.org）
*   rmi (Python: JPype)
*   休息
*   SOAP（只为勇敢者）

选择您或您的合作伙伴熟悉的东西！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-04T12:18:07.250

如果您真的想在 Python 进程中嵌入 Java 应用程序，请查看[JPype](http://jpype.sourceforge.net/)。它通过 JNI 提供对 Java 的访问。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-04T12:38:23.030

使用 swig 怎么样：[http](http://www.swig.org/Doc1.3/Java.html) ://www.swig.org/Doc1.3/Java.html ？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-04T12:54:28.190

试试 JCC [http://pypi.python.org/pypi/JCC/2.1](http://pypi.python.org/pypi/JCC/2.1)

JCC 是一个代码生成器，用于直接从 CPython 调用 Java。它支持 OS X、Linux、Solaris 和 Windows 上的 CPython 2.3+、多个 JRE（Sun JDK 1.4+、Apple JRE 1.4+ 和 OpenJDK 1.7）。它由开源应用程序基金会（OSAF，制作 Chandler 的人）制作，并在 Apache 风格的许可下发布。

从包装描述：

> JCC 是一个 C++ 代码生成器，用于生成通过 Java 的本机调用接口 (JNI) 从 CPython 调用 Java 类所需的胶水代码。
> 
> JCC 生成 C++ 包装类，这些类隐藏了 JNI 访问以及 Java 内存和对象引用管理的所有血腥细节。
> 
> JCC 生成 CPython 类型，使这些 C++ 类可以从 Python 解释器访问。JCC 试图通过检测迭代器和属性访问器来使这些 Python 类型成为 Pythonic。迭代器和映射也可以声明给 JCC。

# c# - 为什么我在 Google Calendar API 中收到 (401) 未经授权的错误

> ID：476979
> 
> 赞同：3
> 
> 时间：2009-01-25T00:47:36.617
> 
> 标签：c#, google-calendar-api, unauthorized

我一直在使用 Google Calendar API，但遇到了一些问题。当我在下面调用它来**删除日历事件**时，它在第一次传递时工作正常，通常是第二次传递。但是，在我第二次或第三次调用此方法时，我得到一个**(401) Unauthorized error**。它每次都使用相同的凭据。如果我得到异常，我可以**重置**catch 中的凭据，它工作正常。我宁愿不必这样做。有任何想法吗？

```
 CalendarService myService = new CalendarService("mycompany-myapp-1");
        myService.setUserCredentials("jo@username.com", "password");

        // set the query for the event
        EventQuery myQuery = new EventQuery(("http://www.google.com/calendar/feeds/jo@username.com/private/full"));
        myQuery.Query = "Cut the grass";
        myQuery.StartTime = DateTime.Now;
        myQuery.EndTime = DateTime.Now.AddDays(1);

        // find the event
        EventFeed myResultsFeed = null;

        try
        {
            // execute the query to find the event
            myResultsFeed = myService.Query(myQuery);                
        }
        catch (Exception ex)
        {
            // this is where i get the unauthorized exception
            // if i reset the credentials here it works fine

            myService.setUserCredentials("jo@username.com", "password"); 
            myResultsFeed = myService.Query(myQuery);
        }

        if (myResultsFeed != null && myResultsFeed.Entries.Count > 0)
        {
            AtomEntry firstMatchEntry = myResultsFeed.Entries[0];
            firstMatchEntry.Delete();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-25T09:48:15.857

我认为需要更多信息。最好的方法是使用[fiddler](http://www.fiddlertool.com/fiddler/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:17:31.623

您可以通过创建一个浏览器控件来解决此问题，该控件在加载时导航到 api 并且从不向用户显示它。唯一的解决方案是我发现 100% 解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-27T13:13:04.370

**[NODE JS]**我知道那是 8 年前的事了，但不知何故我遇到了这样的错误并从堆栈中得到了这个:) 我忘记将“auth”对象传递给请求。完整的架构是：

```
 interface Params$Resource$Events$Delete extends StandardParameters {
        /**
         * Auth client or API Key for the request
         */
        auth?: string | OAuth2Client | JWT | Compute | UserRefreshClient;
        /**
         * Calendar identifier. To retrieve calendar IDs call the calendarList.list
         * method. If you want to access the primary calendar of the currently
         * logged in user, use the "primary" keyword.
         */
        calendarId?: string;
        /**
         * Event identifier.
         */
        eventId?: string;
        /**
         * Deprecated. Please use sendUpdates instead.  Whether to send
         * notifications about the deletion of the event. Note that some emails
         * might still be sent even if you set the value to false. The default is
         * false.
         */
        sendNotifications?: boolean;
        /**
         * Guests who should receive notifications about the deletion of the event.
         */
        sendUpdates?: string;
    } 
```

也许在您的情况下，问题出在刷新/访问令牌上……我不确定。

# java - 最小的 Java SVG 引擎

> ID：476989
> 
> 赞同：21
> 
> 时间：2009-01-25T00:52:44.283
> 
> 标签：java, svg, batik

实际工作的最小的 Java SVG 引擎（最小/最小的 jars）是什么？如果您的答案是蜡染，那么最小的 dep 是多少。让它在一个简单的 Java 应用程序中工作的图表？

我查看了 Batik 站点上的依赖关系图，但它看起来像是典型的 Apache 混乱。有更好的选择吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-25T01:33:35.027

[SVG Salamander](http://svgsalamander.java.net/?six_charachters_limit)声称要小得多，感谢 Batik。很难不相信他们。它是否功能齐全，我不能说，但一位同事说得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-26T08:47:32.927

另一种选择是[JFreeSVG](http://www.jfree.org/jfreesvg/)，jar 文件只有 45k（它提供了一个`SVGGraphics2D`不仅小而且速度快的实现 - 请参阅[此博客文章](http://www.object-refinery.com/blog/blog-20140423.html)了解详细信息）。

# visual-studio - 我可以在 exe 中包含 dll（在 Visual Studio 中）吗？

> ID：476993
> 
> 赞同：12
> 
> 时间：2009-01-25T00:55:07.447
> 
> 标签：visual-studio, dll, include, release, exec

> **可能重复：**
> [.NET windows 应用程序，可以将其压缩为单个 .exe 吗？](https://stackoverflow.com/questions/126611/net-windows-application-can-it-be-compressed-into-a-single-exe)

要运行我需要的位于 Debug and Release 文件夹中的应用`AxInterop.WMPLib.dll`程序`Interop.WMPLib.dll`。有没有办法将这些 dll 包含到 exe 中，这样我的应用程序只能在一个文件中使用？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-25T00:59:18.310

只要您的 DLL 是 .NET 程序集，[ILMerge](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)就应该能够将您的 exe 及其所有依赖项组合到一个文件中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T14:45:28.667

您可以使用 boxedapp 或 thinstall 之类的工具...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-11-23T19:08:53.277

我还推荐boxedapp。这是一个很棒的应用程序！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-25T01:09:34.437

将它们作为嵌入包含在内。然后，您可以在运行时提取它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-25T04:45:43.063

是的，我遗漏了写出文件的代码......

```
FileStream so=new FileStream("c:\\\wherever\\\x.dll",FileMode.Create);

so.Write(buf,0,ssize);

so.Close(); 
```

不需要额外的实用程序。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-25T01:17:16.853

例如，将 x.dll 添加到项目并将其 Build Action 设置为 Embedded Resource。

提取：

```
 string AppPath=Assembly.GetExecutingAssembly().Location;
 Assembly ThisAssembly=Assembly.LoadFrom(AppPath);
 System.IO.Stream fs=ThisAssembly.GetManifestResourceStream("yourproectname.x.dll");
 int ssize=(int)fs.Length;
 byte [] buf=new byte[ssize];
 fs.Read(buf,0,ssize);
 fs.Close(); 
```*********