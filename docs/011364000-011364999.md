# StackOverflow 问答 11364000-11364999

# android - 扩展 hashmap + 可序列化问题

> ID：11364000
> 
> 赞同：2
> 
> 时间：2012-07-06T14:18:55.097
> 
> 标签：android, serialization, hashmap

我扩展了 hashmap（比如 MyClass）：

```
public class MyClass extends HashMap<String, String>
 {
   // something
 } 
```

现在，在一个活动中，我将此类的对象添加到附加对象中（我可以这样做，因为 HashMap 是可序列化的）：

活动一：

```
 MyClass myClass=new MyClass();
  ...
  Intent i = getIntent();
            i.putExtra("key", myClass);
            setResult(RESULT_OK, i);
            finish(); 
```

在活动 B 中（在 onActivityResult 中），我取回了值：

```
 Object o=data.getSerializableExtra("key"); 
```

我的问题是o不是MyClass，而是HashMap。我希望它是 MyClass，但每当我认为 o 是 MyClass 的实例时，我都会得到 ClassCastException：

```
 MyClass o=(MyClass) data.getSerializableExtra("key"); 
```

为什么它返回超类实例？

堆：

```
07-06 18:32:58.539: E/AndroidRuntime(25268): Caused by: java.lang.ClassCastException: java.util.HashMap
07-06 18:32:58.539: E/AndroidRuntime(25268):    at ...Search.onActivityResult(Search.java:158)
07-06 18:32:58.539: E/AndroidRuntime(25268):    at android.app.Activity.dispatchActivityResult(Activity.java:3890)
07-06 18:32:58.539: E/AndroidRuntime(25268):    at android.app.ActivityThread.deliverResults(ActivityThread.java:3511) 
```

# amazon-web-services - 如何使 ELB 将请求从单个客户端转发到多个节点？

> ID：11364001
> 
> 赞同：1
> 
> 时间：2012-07-06T14:19:01.143
> 
> 标签：amazon-web-services, amazon-elb

我目前在单个负载均衡器下的两个 EC2 节点上运行 REST API 应用程序。与来自多个 IP 的少量流量的标准负载平衡方案不同，我仅从几个 IP 获得大量流量。因此，我希望来自每个单独 IP 的请求分布在所有可用节点之间。

然而，即使关闭了会话粘性，情况似乎也并非如此。查看我的日志，几乎所有请求都发送到一台服务器，而我最小的客户端发送到辅助节点。这是有害的，因为对我的服务的请求可能会持续长达 30 秒，而失去该主节点将意味着不成比例的请求被杀死。

我如何指示我的 ELB 循环处理每个客户的单独请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:57:50.033

你不能。ELB 使用不可配置的循环算法。你可以做些什么来缓解（而不是解决）这个问题，就是向你的 ELB 添加额外的服务器和/或使你的 ELB 发起的健康检查请求更加频繁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T22:48:56.310

我在使用 Amazon ELB 时遇到过类似的问题，但对我来说，事实证明 HTTP 客户端使用了 Connection: keep-alive。换句话说，来自同一客户端的请求通过同一连接提供服务，因此它不会在服务器之间切换。我不知道您使用哪个服务器，但可能会关闭保持活动状态，强制客户端为每个请求建立新连接。对于具有大量数据的请求，这可能是一个很好的解决方案。如果您有大量带有小数据的请求，则可能会对性能产生负面影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T09:21:21.600

当您在不同的可用区中拥有两个实例时，可能会发生这种情况。

当一个 ELB 在单个可用区中处理多个实例时，它将在实例之间循环请求。

当两个实例位于两个不同的可用区时，ELB 的工作方式是创建两个服务器（elb 服务器），每个服务器都有自己的 IP，并通过 DNS 平衡负载。

当您的客户端向 DNS 询问您服务器的 IP 地址时，它会收到两个（或更多）响应。然后客户端选择一个 IP 并缓存它（操作系统通常会这样做）。除非您控制客户端，否则您对此无能为力。

当您的问题是两个实例位于不同的可用区时，解决方案可能是每个可用区中至少有两个实例。然后，一台 ELB 服务器将处理两台服务器之间的循环，并且只有一个 IP，因此当服务器发生故障时，它对客户端是透明的。

PS：ELB 创建更多具有唯一 IP 的服务器的另一种情况是，当您在单个可用区中有很多服务器时，单个 ELB 服务器无法处理所有负载并将其分配给连接的服务器。然后再次创建一个新服务器来连接额外的实例，并使用 DNS 和多个 IP 分配负载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T16:51:17.010

我明白你来自哪里。但是，我认为你应该从不同的角度来处理这个问题。您的问题似乎与负载不平衡这一事实没有特别关系。假设您确实解决了这个平衡问题。您仍然会丢失大量请求。我不知道您的客户如何连接到您的服务，因此我无法详细说明您如何解决问题，但您可能希望考虑改进代码以使其更健壮并计划连接到被丢弃。任何连接超过 30 秒的服务都不应该依赖连接不被丢弃。回到 TCP/UDP 套接字的时代，在构建失败方面做了大量工作，不知何故，这些工作在今天的 HTTP 世界中已经丢失了。

我想说的是，如果您编写客户用来连接的代码，构建代码以使其更加健壮并通过重试处理故障。开始执行重试后，您需要确保 API 调用是原子的，并在必要时使用事务。

最后，我会回答你原来的问题。亚马逊的 ELB 是循环的，即使来自同一台计算机/IP 地址。如果您的客户端始终连接到同一台服务器，则很可能是浏览器或缓存响应的代码。如果他们不直接从浏览器访问您的 REST API，大多数语言都允许您获取给定主机名的 ip 列表。这些 ip 将是负载均衡器的 ip，您可以将列表打乱，然后每次使用顶部条目。例如，您可以使用以下 PHP 代码将请求随机发送到不同的负载均衡器。

```
public function getHostByName($domain) {
    $ips = gethostbynamel($domain);
    shuffle($ips);
    return $ips[0];
} 
```

# perl - perl 中的 hmac sha-256

> ID：11364004
> 
> 赞同：10
> 
> 时间：2012-07-06T14:19:05.507
> 
> 标签：perl, hash, sha

这个 php 代码的 perl 等价物是什么？

`$hash = hash_hmac('sha256', $all , $secret);`

我尝试使用下面的代码但徒劳无功。价值观不同。

```
use Digest::SHA;
$sha = Digest::SHA->new('sha256');
$sha->add($secret);
$sha->add($all);
$digest = $sha->hexdigest; 
```

问候， 帕万

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-07-17T10:05:08.940

由于我的问题获得的浏览量超出了我的预期，因此我决定回答它以帮助其他有同样问题的人。我在 PHP 中找到了它的等价物。

```
use Digest::SHA qw(hmac_sha256_hex); 
$digest=hmac_sha256_hex($all, $secret); 
```

希望能帮助到你。

# java - 如何部分重新加载 ui:repeat？

> ID：11364006
> 
> 赞同：18
> 
> 时间：2012-07-06T14:19:10.323
> 
> 标签：java, jquery, jsf, jsf-2, primefaces

我们有一个基于 JBoss 7.1 和**JSF2**和 Primefaces 3.3 的 Web 应用程序。

在我们的一个页面上，有一个`ui:repeat`显示 10 个项目；然后用户可以单击某种“显示更多”按钮，并通过 ajax 显示另外 10 个项目。用户可以单击“显示更多”按钮，直到没有更多要显示的项目。注意：这不是分页，每次点击“显示更多”，显示的列表会变长。

实际上，当用户点击按钮时，服务器返回旧项和新项，JSF客户端每次都必须通过jQuery重建整个repeater。

我们希望找到更好、性能更高的解决方案。*旧项目在n-1*和*n*调用之间不会更改，因此如果服务器只能通过 ajax 返回 10 个新项目，效率会更高。

在 JSF2 中可能吗？JSF 似乎并不真正兼容这种递归渲染。唯一可能对我们有帮助的组件是 TreeNode 组件，但它似乎有点 hack :-/

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-14T16:15:11.913

在标准的 JSF API 中没有这样的东西。~~在 PrimeFaces 中也没有想到任何东西。~~对于 PrimeFaces，请参阅最后的更新

然而，[OmniFaces](http://omnifaces.org) [`<o:componentIdParam>`](http://showcase.omnifaces.org/components/componentIdParam)可能正是您正在寻找的。它允许您让 JSF 根据特定请求参数（可以是组件 ID 或客户端 ID）仅呈现组件树的子集。您基本上可以只使用 jQuery将起始索引作为请求参数[`$.get()`](http://api.jquery.com/jQuery.get/)重新加载，`<ui:repeat>`并使用 jQuery[`$.append()`](http://api.jquery.com/append/)将其附加到 HTML DOM。

这是一个完整的启动示例。风景：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:o="http://omnifaces.org/ui"
>
    <f:metadata>
        <o:componentIdParam componentIdName="componentId" />
    </f:metadata>
    <h:head>
        <title>Stack Overflow Question 11364006</title>
        <script src="http://code.jquery.com/jquery-latest.min.js"></script> <!-- Substitute with PrimeFaces' one, if necessary. -->
    </h:head>
    <h:body>
        <ul id="items">
            <ui:repeat id="itemsRepeater" value="#{bean.items}" var="item">
                <li>#{item}</li>
            </ui:repeat>
        </ul>
        <input type="button" id="showMore" value="Show more"/>
        <h:outputScript>
            $("#showMore").click(function() {
                $items = $("#items");
                var params = { start: $items.find("li").length, componentId: "itemsRepeater" };
                $.get(location, params, function(html) {
                    $items.append(html);
                });
            });
        </h:outputScript>   
    </h:body>
</html> 
```

支持bean：

```
@ManagedBean
@RequestScoped
public class Bean {

    private List<String> items;

    @ManagedProperty("#{param.start}")
    private int start;

    @PostConstruct
    public void init() {
        // Just a stub. Do your thing to fill the items.
        items = new ArrayList<String>();
        int size = start + 10;

        for (int i = start; i < size; i++) {
            items.add("item " + (i + 1));
        }
    }

    public void setStart(int start) {
        this.start = start;
    }

    public List<String> getItems() {
        return items;
    }

} 
```

* * *

**更新：可以在**[当前展示应用程序页面](http://showcase.omnifaces.org/components/componentIdParam)的“可扩展列表”示例中找到现场[演示`<o:componentIdParam>`](http://showcase.omnifaces.org/components/componentIdParam)。

**更新 2)**：PrimeFaces`p:datascroller`具有[“按需滚动”的延迟加载功能](https://www.primefaces.org/showcase/ui/data/datascroller/basic.xhtml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:39:34.177

对于这样的情况，我完全绕过 JSF 并使用带有 jQ​​uery AJAX 的 JAX-RS 服务。这种方法将帮助您构建比 JSF 提供的 AJAX 支持更好的应用程序。这是基本技术。

在 XHTML 页面中，只需为列表添加一个占位符：

```
<div id="item_list"></div>

<a href="#" onclick="loadNext();">Load more...</a> 
```

当页面加载时，发出 AJAX 请求以填充初始列表。这是示例代码。可能有错别字，但你明白了。

```
var nextStart = 0;

$(function() {
    loadNext();
});

function loadNext() {
    $.ajax({
        type: "GET",
        url: "api/items?start=" + nextStart,
        success: function(data) {
            appendToList(data);
            nextStart += data.length;
        }
    });
}

function appendToList(data) {
    //Iterate through data and add to DOM
    for (var i = 0; i < data.length; ++i) {
        $("#item_list").append($("<p>", {text: data.productName}));
    }
} 
```

# vba - 另存为失败的 Excel VBA

> ID：11364007
> 
> 赞同：3
> 
> 时间：2012-07-06T14:19:16.827
> 
> 标签：vba, excel

-**摘要**：我正在尝试编写自动保存当前日期名称的代码

-**问题**：当编译器到达保存的行时，错误提示“对象'_Workbook'的方法'SaveAs'失败”。其他一切都有效。为了参考，我已经展示了整个功能。

```
Function createRecord()

    Dim rowCount As Integer

    Dim theDate As Date

    theDate = Format(Now(), "MM-DD-YY")

    Sheets("New Data").Select
    Cells.Select
    Selection.Copy
    Sheets.Add After:=Sheets(Sheets.Count)
    Application.ActiveSheet.Name = "ChaseHistory"
    ActiveSheet.Paste
    rowCount = ActiveSheet.UsedRange.Rows.Count

    Sheets("Exceptions").Select
    'rowCount = ActiveSheet.UsedRange.Rows.Count
    Application.CutCopyMode = False
    ActiveSheet.UsedRange.Rows.Select
    Selection.Copy
    Sheets("ChaseHistory").Select
    ActiveSheet.Range("A" & rowCount + 2).Select
    ActiveSheet.Paste
    Range("A1").Select
    Cells.Select
    Selection.Copy

    ChDir "Z:\Customer_Service_Accounting\REPORTING & CONTROLS TEAM\Book And Balance_Katie\Chase Booking History"       'loads the crystal report

    Workbooks.Open Filename:= _
        "Z:\Customer_Service_Accounting\REPORTING & CONTROLS TEAM\Book And Balance_Katie\Chase Booking History\Do_Not_Delete.xlsx"

    Windows("Do_Not_Delete").Activate
    ActiveSheet.Paste

    Application.DisplayAlerts = False
                 '---------------This is the problem child--------------                                                                  'SAVING WORKBOOK
    ActiveWorkbook.SaveAs Filename:="Z:\Customer_Service_Accounting\REPORTING & CONTROLS TEAM\Book And Balance_Katie\Chase Booking History\" & CStr(theDate), FileFormat:= _
    xlNormal, Password:="", WriteResPassword:="", ReadOnlyRecommended:=False _
    , CreateBackup:=False

    Application.DisplayAlerts = True

End Function 
```

- 我在日期添加了转换为字符串的方法，因为我认为这可能会导致问题，但结果相同。如果您在这里发现任何问题，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-06T14:56:31.163

**问题：**因为在我的代码中我禁用了 excel 的提示，当我尝试保存时，我没有看到提示告诉我我试图以不正确的格式保存。

基本上总结起来，Excel 不喜欢我的文件名中有反斜杠（“/”）（我真的应该知道）

**修复：**我最终使用了这个语句：

```
ActiveWorkbook.SaveAs Filename:="Z:...\" & "Chase " & _
    Month(theDate) & "_" & Day(theDate) & "_" & Year(theDate) & ".xlsx" 
```

所以我在这里真正做的只是将月、日和年放在一个用下划线分隔的字符串中，以避免邪恶的反斜杠。

感谢您的帮助加菲！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-06T14:22:15.987

你有没有尝试过这样的事情？

```
ActiveWorkbook.SaveAs Filename:="Z:\Customer_Service_Accounting\REPORTING & CONTROLS TEAM\Book And Balance_Katie\Chase Booking History\" & Format(theDate, "mm.dd.yy"), FileFormat:= _
xlNormal, Password:="", WriteResPassword:="", ReadOnlyRecommended:=False _
, CreateBackup:=False 
```

突出显示：我更改`CStr(theDate)`为`Format(theDate, "mm.dd.yy") & ".xlsx"`，但如果需要，您可以使用其他格式。

解释：

`theDate`是类型`Date`（见：）`Dim theDate As Date`，所以当你使用 . 时返回的是完整的日期/时间格式字符串`CStr()`。这将导致如下结果：

```
Debug.Print CStr(Now()) 
7/6/2012 7:23:38 AM 
```

这可能会导致您的系统拒绝文件名中的无效字符。

# html - HTML中按钮的隐藏属性

> ID：11364020
> 
> 赞同：33
> 
> 时间：2012-07-06T14:20:13.007
> 
> 标签：html, button, hidden

我试图在单击一次按钮时显示三个按钮。在单击按钮之前，所有三个按钮都被隐藏。我设置了隐藏属性，并且我还在单击按钮时调用了一个函数。问题是当我加载页面时所有按钮都是可见的。在我添加 CSS 之前它运行良好。我不明白问题出在哪里。

这是我的代码：

```
 .buttons a, .buttons button{
    display:block;
    float:left;
    margin:0 7px 0 0;
    background-color:#f5f5f5;
    border:1px solid #dedede;
    border-top:1px solid #eee;
    border-left:1px solid #eee;

    font-family:"Lucida Grande", Tahoma, Arial, Verdana, sans-serif;
    font-size:12px;
    line-height:130%;
    text-decoration:none;
    font-weight:bold;
    color:#565656;
    cursor:pointer;
    padding:5px 10px 6px 7px; /* Links */
    }
    .buttons button{
    width:auto;
    overflow:visible;
    padding:4px 10px 3px 7px; /* IE6 */
    }
    .buttons button[type]{
    padding:5px 10px 5px 7px; /* Firefox */
    line-height:17px; /* Safari */
    }
    *:first-child+html button[type]{
        padding:4px 10px 3px 7px; /* IE7 */
    }
    .buttons button img, .buttons a img{
    margin:0 3px -3px 0 !important;
    padding:0;
    border:none;
    width:16px;
    height:16px;
    }

    /* STANDARD */

    button:hover, .buttons a:hover{
    background-color:#dff4ff;
    border:1px solid #c2e1ef;
    color:#336699;
    }
    .buttons a:active{
    background-color:#6299c5;
    border:1px solid #6299c5;
    color:#fff;
    }

    /* POSITIVE */

    button.positive, .buttons a.positive{
    color:#529214;
    }
    .buttons a.positive:hover, button.positive:hover{
    background-color:#E6EFC2;
    border:1px solid #C6D880;
    color:#529214;
    }
    .buttons a.positive:active{
    background-color:#529214;
    border:1px solid #529214;
    color:#fff;
    }

    /* NEGATIVE */

    .buttons a.negative, button.negative{
    color:#d12f19;
    }
    .buttons a.negative:hover, button.negative:hover{
    background:#fbe3e4;
    border:1px solid #fbc2c4;
    color:#d12f19;
    }
    .buttons a.negative:active{
    background-color:#d12f19;
    border:1px solid #d12f19;
    color:#fff;
    }

    /* REGULAR */

    button.regular, .buttons a.regular{
    color:#336699;
    }
    .buttons a.regular:hover, button.regular:hover{
    background-color:#dff4ff;
    border:1px solid #c2e1ef;
    color:#336699;
    }
    .buttons a.regular:active{
    background-color:#6299c5;
    border:1px solid #6299c5;
    color:#fff;
    }
```

```
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      <link rel="STYLESHEET" type="text/css" href="dba_style/buttons.css" />
      <title>Untitled Document</title> 

      <script type="text/javascript">
      function change(){
    document.getElementById("save").hidden = "";
    document.getElementById("change").hidden = "";
    document.getElementById("cancel").hidden = "";

      }
      </script>

    </head>

    <body>
      <form name="form1" method="post" action="">
      <div class="buttons">

          <button class="regular" name="edit" id="edit" onclick="change();">
              <img src="dba_images/textfield_key.png" alt=""/>
              Edit
          </button>

          <button type="submit" class="positive" name="save" id="save" hidden="hidden">
              <img src="dba_images/apply2.png" alt=""/>
              Save
          </button>

          <button class="regular" name="change" hidden="hidden" id="change">
              <img src="dba_images/textfield_key.png" alt=""/>
              change
          </button>

          <button class="negative" name="cancel" id="cancel" hidden="hidden">
              <img src="dba_images/cross.png" alt=""/>
              Cancel
          </button>
      </div>
      </form>
    </body>
 </html>
```

我可以进行哪些更改，以便在单击编辑时将`hidden`三个按钮的属性设置为`false`？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-07-06T14:40:08.130

如果您进行以下更改，它也可以在没有 jQuery 的情况下工作：

1.  添加`type="button"`到编辑按钮，以免触发表单的提交。

2.  将函数的名称从更改`change()`为其他任何名称。

3.  不要使用`hidden="hidden"`，使用 CSS 代替：`style="display: none;"`.

以下代码适用于我：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="STYLESHEET" type="text/css" href="dba_style/buttons.css" />
<title>Untitled Document</title>
</head>
<script type="text/javascript">
function do_change(){
document.getElementById("save").style.display = "block";
document.getElementById("change").style.display = "block";
document.getElementById("cancel").style.display = "block";
}
</script>
<body>
<form name="form1" method="post" action="">
<div class="buttons">

<button type="button" class="regular" name="edit" id="edit" onclick="do_change(); return false;">
    <img src="dba_images/textfield_key.png" alt=""/>
    Edit
</button>

<button type="submit" class="positive" name="save" id="save" style="display:none;">
    <img src="dba_images/apply2.png" alt=""/>
    Save
</button>

<button class="regular" name="change" id="change" style="display:none;">
    <img src="dba_images/textfield_key.png" alt=""/>
    change
</button>

    <button class="negative" name="cancel" id="cancel" style="display:none;">
        <img src="dba_images/cross.png" alt=""/>
        Cancel
    </button>
</div>
</form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-06T14:29:50.430

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
<script>

function showButtons () { $('#b1, #b2, #b3').show(); }

</script>
<style type="text/css">
#b1, #b2, #b3 {
display: none;
}

</style>
</head>
<body>

<a href="#" onclick="showButtons();">Show me the money!</a>

<input type="submit" id="b1" value="B1" />
<input type="submit" id="b2" value="B2"/>
<input type="submit" id="b3" value="B3" />

</body>
</html> 
```

# jquery - 在 jqgrid 中，如何在编辑单元格之前更改值？

> ID：11364023
> 
> 赞同：0
> 
> 时间：2012-07-06T14:20:28.440
> 
> 标签：jquery, jqgrid

我试图找出在 JQGrid 中是否有一种很好的方法可以在编辑单元格之前更改它的值。

我想要完成的是一个单元格包含一些数据和一些标记，所以值是沿着线

```
<div style="font-size:8px">10%</div><div style="font-size:10px">100</div> 
```

但是当用户点击我只想显示的数据时

```
10 
```

目前，当我编辑它时，我会看到整个标记和所有内容，我想在编辑事件之前通过一些快速解析来隐藏它。

当我尝试更改值时

```
beforeEditCell: function(rowid, cellname, value, iRow, iCol) 
```

和

```
setCell (rowid, colname, data, class, properties, forceup) 
```

该更改似乎不会影响打开的输入字段中的内容。我的论点是，在“beforeEditCell”被触发之前，为输入字段生成的值可能被放入一个变量中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:06:46.270

看看事件`formatCell`，jqGrid 文档说：

> 仅适用于可编辑的单元格；此事件允许在编辑前格式化单元格内容，并返回格式化后的值

我认为这是实现您想要的最佳方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-06T14:59:48.323

使用, unformat: function (cellvalue, options, rowObject) { return cellvalue; },

向自定义 unformat 函数传递以下参数： cellvalue - 是要取消格式化的值（纯文本）。options - 是一个包含以下元素选项的对象： { rowId: rid, colModel: cm} where rowId - 是行的 id colModel 是从 jqGrid 的 colModel 数组中获取的该列属性的对象 cellobject - 是一个 jQuery单元格对象。该对象可用于从单元格元素中获取不同的东西——例如 jQuery(cellobject).html() 可用于获取 html 内容而不是文本。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-06T14:55:05.050

我使用 jquery 来更改编辑单元格的值。

```
$("#cellid").val("10"); 
```

# php - 相同的 mySQL 插入查询从同一脚本中的两个不同位置运行，在不应该产生不同的结果时

> ID：11364028
> 
> 赞同：0
> 
> 时间：2012-07-06T14:20:41.673
> 
> 标签：php, mysql

如果您查看标记为：的代码`/*********`，您将看到相同的**插入**查询在下面的代码中出现了两次。第一个代码块（朝向顶部）按预期插入行，但是，它不是我需要的位置，我只是将它放在那里用于调试目的。第二个代码块是我需要从中运行插入查询的地方。当我尝试从那里运行插入查询时，它会插入一个空白行。

似乎变量一旦到达最里面的 if 语句就会失去它们的值，我无法给出一个合乎逻辑的解释来解释它为什么这样做。

我试图解决这个问题：

***添加`mysql_real_escape_string`到我存储的变量中

***从我的插入查询中删除了 AUTO_INCREMENT id 字段

***尝试从所有嵌套的 if 语句中插入字符串文字 - 效果很好，但是一旦我将这些字符串文字更改为我需要的变量，它就会插入一个空白行。

***在查询中添加或死亡（mysql_error（）），没有产生错误。

请提供建议，因为让我正常工作至关重要......

**注意：**我从来没有在同一个脚本中运行两个插入查询，我只是在下面的脚本中添加了相同的“插入”代码块两次，以使读者清楚我试图让它工作，以及脚本如何响应因此。

```
<?php

        session_start();
        //Create mysql connect variable
        $conn = mysql_connect('myhostedresource.com', 'user', 'password');

        //kill connection if error occurs
        if(!$conn){
            die('Error: Unable to connect.' . '<br>' . mysql_error());
        }

        //connect to mysql database
        mysql_select_db("stevenash", $conn);

        // PHP 4.1
        // read the post from PayPal system and add 'cmd'
        $req = 'cmd=_notify-validate';

        foreach ($_POST as $key => $value) {
            $value = urlencode(stripslashes($value));
            $req .= "&$key=$value";
        }

        // post back to PayPal system to validate
        $header .= "POST /cgi-bin/webscr HTTP/1.0\r\n";
        $header .= "Content-Type: application/x-www-form-urlencoded\r\n";
        $header .= "Content-Length: " . strlen($req) . "\r\n\r\n";
        $fp = fsockopen ('ssl://www.paypal.com', 443, $errno, $errstr, 30);

        // assign posted variables to local variables
        $item_name = $_POST['item_name'];
        $item_number = $_POST['item_number'];
        $payment_status = $_POST['payment_status'];
        $payment_amount = $_POST['mc_gross'];
        $payment_currency = $_POST['mc_currency'];
        $txn_id = $_POST['txn_id'];
        $receiver_email = $_POST['receiver_email'];
        $payer_email = $_POST['payer_email'];       

        $usr_email = mysql_real_escape_string($_SESSION['email']);
        $usr_compname = mysql_real_escape_string($_SESSION['compname']);
        $usr_city = mysql_real_escape_string($_SESSION['city']);
        $usr_state = mysql_real_escape_string($_SESSION['state']);
        $usr_phone = mysql_real_escape_string($_SESSION['phone']);
        $usr_password = mysql_real_escape_string($_SESSION['password']);
        $usr_first = mysql_real_escape_string($_SESSION['first']);
        $usr_last = mysql_real_escape_string($_SESSION['last']);

     //********************************************************                      

        $myString = "INSERT users (`email`, `compname`, `city`, `state`, `phone`, `password`, `first`, `last`) 
                                    VALUES('".$usr_email."','".$usr_compname."','".$usr_city."','".$usr_state."','".$usr_phone."','".$usr_password."','".$usr_first."','".$usr_last."')";
        echo $myString;     

        mysql_query($myString,$conn);

  //********************************************************

        if (!$fp) {
            // HTTP ERROR
        }else{
            fputs ($fp, $header . $req);
            while (!feof($fp)) {
                $res = fgets ($fp, 1024);
                if (strcmp ($res, "VERIFIED") == 0) {
                    // check the payment_status is Completed
                    if($payment_status == 'Completed'){
                        $txn_id_check = mysql_query("SELECT txn_id FROM log WHERE txn_id='$txn_id'");
                        //add user to database
                        if(mysql_num_rows($txn_id_check) != 1){ //payment has not been processed yet
                            //continue processing
                            if($receiver_email=='mat9@gmail.com'){
                                if($payment_amount=='1.00' && $payment_currency=='USD'){
                                    //add transaction id to db
                                    mysql_query("INSERT INTO log (`log_id`, `txn_id`, `email`) VALUES('','$txn_id','$payer_email')", $conn);    

                                 //********************************************************                      

                                    $myString = "INSERT users (`email`, `compname`, `city`, `state`, `phone`, `password`, `first`, `last`) 
                                                VALUES('".$usr_email."','".$usr_compname."','".$usr_city."','".$usr_state."','".$usr_phone."','".$usr_password."','".$usr_first."','".$usr_last."')";
                                    echo $myString;     

                                    mysql_query($myString,$conn);

                                 //********************************************************
                                    }
                                }
                            }
                        }
                        // check that txn_id has not been previously processed
                        // check that receiver_email is your Primary PayPal email
                        // check that payment_amount/payment_currency are correct
                        // process payment
                    }
                    else if (strcmp ($res, "INVALID") == 0) {
                        // log for manual investigation
                    }
                }
                fclose ($fp);
            }
        ?> 
```

# web-services - wso2 身份服务器与 esb 的集成

> ID：11364030
> 
> 赞同：1
> 
> 时间：2012-07-06T14:20:45.777
> 
> 标签：web-services, wso2, wso2esb, wso2is

我是 WSO2 的初学者。我在将 WSO2 身份服务器与 ESB 集成时面临一些挑战。我关注了“ **[http://wso2.org/library/articles/2010/10/using-xacml-fine-grained-authorization-wso2-platform/](http://wso2.org/library/articles/2010/10/using-xacml-fine-grained-authorization-wso2-platform/)** ”博客。在 ESB 中使用授权组件时，我遇到了一些与验证用户相关的错误。以下是我在控制台中遇到的错误：-

> [2012-07-06 19:23:42,312] 错误 - 未为权利调解员提供 EntitlementMediator 用户名 - 无法继续 [2012-07-06 19:23:42,312] 错误 - 评估策略组织时发生 EntitlementMediator 错误.apache.synapse.SynapseException：未为权利中介提供用户名 - 无法在 org.apache.synapse 的 org.wso2.carbon.identity.entitlement.mediator.EntitlementMediator.mediate(EntitlementMediator.java:149) 继续。 mediators.AbstractListMediator.mediate(AbstractListMediator.java:60) 在 org.apache.synapse.mediators.base.SequenceMediator.mediate(SequenceMediator.java:114) 在 org.apache.synapse.core.axis2.ProxyServiceMessageReceiver.receive(ProxyServiceMessageReceiver. java:154) 在 org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:181) 在 org.apache.axis2。transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:172) 在 org.apache.synapse.transport.nhttp.ServerWorker.processEntityEnclosingMethod(ServerWorker.java:409) 在 org.apache.synapse.transport.nhttp.ServerWorker.run( ServerWorker.java:261) 在 org.apache.axis2.transport.base.threads.NativeWorkerPool$1.run(NativeWorkerPool.java:173) 在 java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) 在 java.util.concurrent .ThreadPoolExecutor$Worker.run(Unknown Source) at java.lang.Thread.run(Unknown Source)apache.axis2.transport.base.threads.NativeWorkerPool$1.run(NativeWorkerPool.java:173) at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source ) 在 java.lang.Thread.run(Unknown Source)apache.axis2.transport.base.threads.NativeWorkerPool$1.run(NativeWorkerPool.java:173) at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source ) 在 java.lang.Thread.run(Unknown Source)

任何人都可以帮助我理解它。

提前致谢。查兰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T06:06:29.697

查看这篇文章[1]，了解如何确保安全。

[1] [http://wso2.org/library/articles/2011/06/securing-web-service-integration](http://wso2.org/library/articles/2011/06/securing-web-service-integration)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T15:15:24.247

这是因为对 ESB 代理服务的服务请求未使用基于用户名令牌的策略进行保护。请确保根据文章使用基于用户名令牌的安全方案保护代理，并且您的客户端正在将请求的 WS 安全标头中的用户名令牌凭据发送到代理服务。

# objective-c - iOS - 导航控制器不会从堆栈中删除视图控制器

> ID：11364031
> 
> 赞同：2
> 
> 时间：2012-07-06T14:20:49.850
> 
> 标签：objective-c, ios, stack, viewcontroller, navigationcontroller

在我的程序中，我在视图中创建了一个项目列表。当我单击特定项目时，我会打开另一个视图以查看与该项目相关的信息。

但是当我回到上一个视图时，导航控制器并没有从堆栈中删除视图，事实上，在我返回到上一个视图控制器之后，如果我点击另一个或相同的项目来显示信息，导航控制器视图是相同的数字加 1，当我尝试返回时，他首先加载相同的项目信息视图，然后加载项目列表。

例子：

查看项目列表：查看 A

查看信息：查看B

第 1 步：在视图 A 中加载项目

步骤 2：单击视图 A 中的项目 1 并将视图 B 推入堆栈

第 3 步：从 A 中弹出 B

第 4 步：单击视图 A 中的项目 2 并将视图 B 推入堆栈

在第 4 步，我的筹码是：A - B - B.... 为什么？

编辑：

这是第 2 步：

```
-(void) clickOnSpesa:(NSNotification*)notification
{
    NSDictionary *userInfo = notification.userInfo;
    Spesa *spesa = [userInfo objectForKey:@"notaSpesa"];

    //Cambio View
    NuovaSpesa *viewSpesa = [[NuovaSpesa alloc] initWithNibName:nil bundle:nil];
    NSLog(@"creo la view per visualizzare la spesa");
    [viewSpesa initWithSpesa:spesa];
    [self.navigationController pushViewController:viewSpesa animated:YES];
} 
```

第 3 步：

```
-(void) previousView:(id)sender
{
    [self.navigationController popViewControllerAnimated:YES];
} 
```

InitWithSpesa：

```
-(void)initWithSpesa:(Spesa *)spesa
{   
    //Info
    [GeneralManager showInvioTable];

    self.spesaFromGestione = spesa;

    //Setto il resto come non modificabile se la spesa non lo è
    bool isModificable = true;

    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    [formatter setDateFormat:@"dd/MM/yyyy"];
    NSString *stringDate = [formatter stringFromDate:spesa.creationDate];

    //Get delle NoteSpesa in tutte le date
    SDLDatabase *db = [[SDLDatabase alloc] initWithFile:dbPath];
    NSString *sql = [NSString stringWithFormat:@"SELECT * FROM invio WHERE data='%@'", stringDate];
    NSMutableArray *resultSpese = [db selectAllFrom:sql];
    [db close];

    if ([resultSpese count] > 0) {
        isModificable = false;   //Data già inviata e non può essere modificata
    }

    //Inserisco i valori nei relativi campi
    [btnCalendario setTitle:stringDate forState:UIControlStateNormal];
    [btnSpese setTitle:spesa.type.nome forState:UIControlStateNormal];
    [txtQuantita setText:[NSString stringWithFormat:@"%d", spesa.quant]];
    [txtCosto setText:[NSString stringWithFormat:@"%.2f", spesa.costo]];
    if (spesa.type.tipoSpesa == TIP_FIXED) {
        [txtCosto setEnabled:false];
        [self.txtCosto setAlpha:0.3];
    }
    [txtNote setText:spesa.note];

    //Foto
    NSArray *photos = [[GeneralManager sharedManager] loadImageForSpesa:spesa];

    //La salvo nel "porta" foto
    for (UIImage *image in photos) {
        [self.scrollerPhoto addPhoto:image];
    }

    if(isModificable){
        //Modificabile
        [btnSalva setTitle:@"Modifica" forState:UIControlStateNormal];
    }else{
        //Non modificabile
        [btnCalendario setEnabled:false];
        [btnSpese setEnabled:false];
        [txtQuantita setEnabled:false];
        [txtCosto setEnabled:false];
        [txtNote setEditable:false];
        [btnScattaFoto setEnabled:false];
        [btnSalva setHidden:true];
        [btnElimina setHidden:true];
    }
} 
```

# c# - 从表格2控制表格1中的计时器，C#

> ID：11364032
> 
> 赞同：1
> 
> 时间：2012-07-06T14:20:50.863
> 
> 标签：c#, timer, multiple-forms

表单中的标签显示计时器的计数。现在我想使用表格 2 停止、启动和重置它。我该怎么做。请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T14:26:22.843

表单只是类，Form 2 上的计时器是该类中的一个对象。

您可以将`Modifiers`计时器的属性更改为public，然后在Form 1中实例化Form 2，调用`Show()`Form 2的方法，然后访问您现在公开的计时器对象。

所以你有一个有 2 种形式的项目，如下所示：

![解决方案资源管理器](../Images/636b3b69d1dd08d491ea5ac0a4d1bb8f.png)

在 Form 1 中创建一个按钮，如下所示：

![形式一](../Images/fad55c64741c9a9dab57a1fe7d7468e8.png)

在 Form 2 上放置一个计时器对象并更改访问修饰符，如下所示：

![特性](../Images/0b0a387488e66ba5b8f1d0c1934f4989.png)

然后将以下代码放在表单一中的按钮下：

```
private void button1_Click(object sender, EventArgs e)
{
    Form2 f2 = new Form2();
    f2.Show();
    f2.timer1.Enabled = true;
} 
```

现在您可以启动表单 2 并从表单 1 访问表单 2 上计时器的所有属性。

这有帮助吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:36:42.773

如果计时器对象位于 Form1 中，则为其创建一个公共属性：

```
public Timer Form1Timer { get { return timer1; } } 
```

然后，您可以通过在 Form 2 中引用 Form 1 来访问此计时器。您可以通过将其传递给构造函数或在 Form2 上设置属性来执行此操作。引用 Form1 后，您可以简单地调用计时器上的方法：

```
Form1.Form1Timer.Start(); 
```

如果您不能将它的引用传递给 Form2，则始终可以从 Form1 中创建一个单例。

声明你的单例：

```
private static Form1 _singleton 
```

如果还没有初始化你的单例，并返回它：

```
 public static Form1 Singleton
 { 
    get { _singleton ?? (_singleton = new Form1()); } 
 } 
```

为获得最佳实践，请将您的 Form1 构造函数设为私有。如果 Form1 没有默认构造函数（无参数），这当然不起作用。

然后在 Form2 中：

```
Form1.Singleton.Form1Timer.Start(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-14T07:09:20.727

做这个

```
static Form1 _frmObj;
public static Form1 frmObj
{
     get { return _frmObj; }
     set { _frmObj = value; }
} 
```

## 表单加载时

```
private void Form1_Load(object sender, EventArgs e)
{
      frmObj= this;
} 
```

## 从另一个表单访问表单及其控件

```
Form1.frmObj.timer1.Stop(); 
```

# php - 通过 jquery 或 php 删除 json 中包含值的字符串

> ID：11364033
> 
> 赞同：0
> 
> 时间：2012-07-06T14:20:51.620
> 
> 标签：php, jquery, mysql, json

我有 json 字符串，它是由 server.php 生成的

```
[{"attr":{"id":"node_7","rel":"default"},"data":"doc.html","state":""},
 {"attr":{"id":"node_8","rel":"folder"},"data":"New node","state":"closed"},
 {"attr":{"id":"node_9","rel":"folder"},"data":"New node","state":""}] 
```

如何删除包含该值的完整字符串`rel=default`

这是我为 server.php 编写的代码。

```
require_once("config.php");
$jstree = new json_tree();

echo $jstree->{$_REQUEST["operation"]}($_REQUEST);
die(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:23:25.327

使用 PHP：

```
// convert json string to array
$json = json_decode($json_string);

// filter out items
$json = array_filter($json, function($item)
{
    return $item->attr->rel != "default";
});

// convert back to string
$json_string = json_encode($json); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:25:09.013

您可以使用 data.items.splice(X, Y); 删除一个元素；）

# ios - iOS 如何使用 beginBackgroundTaskWithExpirationHandler 执行任务

> ID：11364034
> 
> 赞同：1
> 
> 时间：2012-07-06T14:21:00.733
> 
> 标签：ios, multithreading, ios5, multitasking

我正在尝试为一个简单的测试应用程序做两件事。

我一直在尝试学习如何使用 beginBackgroundTaskWithExpirationHandler

我想在用户按下主页按钮时执行一个 backgroundTask（没什么花哨的）。9 分钟后，我想提醒用户时间即将到期（如果可能）并允许用户切换回应用程序以续订 10 分钟。

我不需要向后兼容 iOS 3 或 4。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T14:39:15.827

如果您希望代码在后台继续运行，则需要将其包装在后台任务中。完成后打电话也很重要`endBackgroundTask`- 否则应用程序将在分配的时间到期后被杀死

```
- (IBAction) buttonPressed: (id) sender

        [self beingBackgroundUpdateTask];

        // Do your long running background thing here

        [self endBackgroundUpdateTask];
    });
}
- (void) beingBackgroundUpdateTask
{
    self.backgroundUpdateTask = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^{
        [self endBackgroundUpdateTask];
    }];
}

- (void) endBackgroundUpdateTask
{
    [[UIApplication sharedApplication] endBackgroundTask: self.backgroundUpdateTask];
    self.backgroundUpdateTask = UIBackgroundTaskInvalid;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T14:34:17.797

将代码放在`applicationDidEnterBackground`你的函数中`UIApplicationDelegate`。您将需要设置`UILocalNotification`并安排它。您还应该禁用它，`applicationWillEnterForeground`这样它就不会触发用户在过期之前返回应用程序。

```
- (void)applicationDidEnterBackground:(UIApplication *)application
{
  UILocalNotification *timerNotification = [[UILocalNotification alloc] init];
  //set up notification with proper time and attributes
  [[UIApplication sharedApplication] scheduleLocalNotification:timerNotification];
}

- (void)applicationWillEnterForeground:(UIApplication *)application
{
  [[UIApplication sharedApplication] cancelAllLocalNotifications];
} 
```

我在那里提供的取消代码实际上会取消所有通知。如果您有多个通知并且只想取消一个特定的通知，则应在`userInfo`设置通知的属性时为其提供键/值。然后，当应用程序进入前台时，通过执行获取所有活动通知的列表

`NSArray *notifications = [[UIApplication sharedApplication] scheduledLocalNotifications];`

并遍历它们，检查`userInfo`直到你到达你想要的那个，然后取消那个

`[[UIApplication sharedApplication] cancelLocalNotification:whateverNotification];`

# java - 如何使 NetBeans Navigator 转到 Java 构造函数源

> ID：11364035
> 
> 赞同：0
> 
> 时间：2012-07-06T14:21:01.897
> 
> 标签：java, netbeans

我正在使用 Windows 7 和 NetBeans 7.1.1。

NetBeans Navigator 窗口将列出 Java 类中的所有方法，包括其构造函数：

![在此处输入图像描述](../Images/826caf146a00d765dd956e02ed3394e3.png)

如果我右键单击一个方法并选择“转到源”，IDE 会将编辑器窗口的光标跳转到该方法的源。除了这不适用于类构造函数本身。当我右键单击构造函数名称时，仍然会出现“转到源代码”菜单选项，但选择该项目不会执行任何操作。

如何从 NetBeans 导航器窗口跳转到 Java 类的构造函数源？

# ms-access - Acess 2007 一对多关系计数

> ID：11364037
> 
> 赞同：2
> 
> 时间：2012-07-06T14:21:09.853
> 
> 标签：ms-access, ms-access-2007, vba

我的设置：我有两个表：tblAuthors 和 tblBooks。tblAuthors 包括作者列表：Kurt Vonnegut、Frank Herbert、JK Rowling、John Nichols 等。tblBooks 包括书籍列表：Slaughter House Five、Cat's Cradle、Monkey House、Dune、Harry Potter、Milagro Beanfield War 等。

tblBooks 和 tblAuthors 之间存在一对多的关系；tblAuthors 中的作者用作此关系的主键。tblAuthors 有一个*Number of Books 列*，它告诉表的用户每个作者写了多少本书包含在表中。目前，用户（可悲的是我）必须手动输入这些信息，在每本书输入并给出作者后更新它。虽然这并不是特别困难，因为我可以简单地在 tblAuthors 中看到有多少书与作者有关​​，因为关系，但有时很难记住更新它（更不用说屁股上的巨大痛苦）。

**我希望*图书数量在*我添加更多图书时自动更新。**如果有代码请告诉我！！

我对 VBA 不是很熟悉，可以使用一种针对可能不了解代码所有方面的人的解释。

预先感谢您为我提供的任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T14:27:28.013

您可能想阅读[有关关系数据库设计](http://r937.com/relational.html)的信息 存储计算字段并不常见，因为可以轻松地从查询中获取信息。

```
SELECT AuthorID, 
       Count(BookID) 
FROM Books
GROUP BY AuthorID 
```

# jquery - jQuery Validate，在无效处理程序上提交

> ID：11364038
> 
> 赞同：0
> 
> 时间：2012-07-06T14:21:11.617
> 
> 标签：jquery, jquery-validate

在多页表单上，我使用 jQuery validate 来允许用户继续处理他们的表单，或者在不保存的情况下继续前进。

所以，我想从字面上弄清楚是否存在错误，显示一个对话框和一个是/否以允许它们继续。SubmitHandler 仅在正确时有效，在损坏时无效，我需要使用 invalidHandler。但是，当我尝试使用 jquery validate 解决递归问题时，它告诉我：

**`Uncaught TypeError: Object #<Object> has no method 'submit'`**

```
$('.form-submit-next').click(function() {
    $('#form').validate({ 
        errorPlacement: function(error, element) {},
        invalidHandler: function(form, validator) {
                $('#dialog').dialog({
                    resizable : false,
                    width : 350,
                    height : 200,
                    modal : true,
                    buttons : {
                        "Yes" : function() {
                            $(this).dialog("close");
                            form.submit(); //errors here
                        },
                        "No": function() {
                            $( this ).dialog( "close" );

                        }
                    }
                }); 
            }

    });
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:14:15.823

当您单击“是”按钮将绕过验证器时，您需要进行 DOM 提交：

```
buttons : {
   "Yes" : function() {
       $(this).dialog("close");
       $(this)[0].submit();
   } 
```

# javascript - 选项添加到在 iPhone 的列表框中不可见 我有一个 HTML 列表框，我正在使用 javascript 添加选项 - 在 PC 上的任何浏览器中都没有问题 - Mozilla、Chrome、IE、Opera、Safari。但是，在 iPhone 上执行时，添加的选项在列表框中不可见 - 仅显示 - （0 个项目），直到您点击列表框，然后您看到添加的选项，就像您点击常规“选择”项目一样，点击只有在那之后，该选项才可见。我希望我让自己足够清楚......功能如下：用户在文本框（tb）中填充

> ID：11364040
> 
> 赞同：2
> 
> 时间：2012-07-06T14:21:20.493
> 
> 标签：javascript, iphone, html, html-select

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:32:54.230

我已经成功地使用选项数组来做到这一点。因此，不要创建 HTML 节点，而是使用 JS API。另请注意，iOS 不支持多选框。

```
var opt = new Option(tb.value, tb.value, false, false);
lstbx.options.add(opt); 
```

# java - 为什么不能在构造函数中实例化该类的同一个对象？

> ID：11364043
> 
> 赞同：0
> 
> 时间：2012-07-06T14:21:33.903
> 
> 标签：java, constructor

```
public class Run{
 public static void main(String... args){
      A a1 = new A();
 }
}

class A{
  public A(){
    A a = new A();
  }
  //here as well A a = new A();
} 
```

为什么这会给出一个`java.lang.StackOverflowError`？这里有递归调用吗？它是如何发生的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:22:42.503

您在构造函数中调用构造函数——就是这样`new`做的，构造一个新对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T14:27:16.953

> 这里有递归调用吗？

是的

> 它是怎么发生的？

当 you 时`new A()`，它调用构造函数 for `A`，执行 a`new A()`调用构造函数，执行 a `new A()`... 等等。那就是递归。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T14:30:38.717

您可以调用，但这将是一个无限运行的递归调用。这就是为什么你得到`StackOverflowError`.

以下将完美运行：

```
public class Run{

 static int x = 1;
 public static void main(String... args){
      A a1 = new A();
 }
}

class A{
   public A(){
     if(x==1){
        A a = new A();
        x++;
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T14:36:55.260

您需要更改构造函数以实际创建`A`对象。假设`A`拥有一个整数值，仅此而已。在这种情况下，您的构造函数应如下所示：

```
class A{
  int number;
  public A(){
      number = 0;
  }
} 
```

您在代码中所做的实际上是在您自己的构造函数中创建一个新的对象实例。

因此，当您调用 时`new A()`，您正在调用构造函数，然后`new A()`在其主体内部调用。它最终会无限调用自己，这就是你的堆栈溢出的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-06T14:44:48.723

我认为那里有一个递归调用。为了创建一个 A，您必须在其中创建另一个 A。但是要在其中创建 A，您必须在该 A 中创建第三个 A。依此类推。如果您使用两个不同的构造函数或参数或其他东西，您应该能够解决这个问题：

```
class A {
    public A(boolean spawn){
        if (spawn) {
            A a = new A(false);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-06T14:23:51.843

问题是当你调用构造函数时，你创建了一个新对象（这意味着你再次调用构造函数，所以你创建了另一个对象，所以你再次调用构造函数......）

它是最好的无限递归，它与它是构造函数无关（实际上你可以从构造函数创建新对象）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-06T14:29:09.460

基本上，您的构造函数都不会退出 - 每个构造函数都会尝试`A`递归地实例化另一个类型的对象。

# git - 如何在 .gitconfig 文件中插入和检索自定义字段？

> ID：11364044
> 
> 赞同：4
> 
> 时间：2012-07-06T14:21:35.347
> 
> 标签：git

我有以下.gitconfig：

```
[user]
name = name
email = email@email.com
custom_field = AAA 
```

使用 git 的内置命令可以轻松获取姓名和电子邮件。

如何获取 custom_field 的值？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T14:36:40.207

您的命令失败，因为您在自定义字段的名称中添加了下划线。要将自定义字段添加到`.gitconfig`文件，请使用以下命令：

```
git config --global user.customfield <value> 
```

然后，您可以使用以下方法检索它：

```
git config --global user.customfield 
```

例如：

```
$ git config --global user.customfield test
$ git config --global user.customfield
test 
```

此外，请避免`_`在自定义字段名称中使用 '。Git 不解析它们：

```
$ git config user.custom_field test
error: invalid key: user.custom_field 
```

# python - 对包含列表的列表进行排序

> ID：11364045
> 
> 赞同：3
> 
> 时间：2012-07-06T14:21:38.683
> 
> 标签：python, list, sorting, dictionary

我有一种算法可以生成一个包含未知数量子列表的列表，每个子列表都有未知数量的字符串元素和一个浮点数。我需要根据这个浮动在主列表中排序这些子列表。此外，不会重新排列子列表中的字符串顺序。

我目前通过一大块代码（链接如下）运行它，它使用字典对其进行排序。如您所见，我收到了 KeyErrors。我以前没有使用过 dicts，所以我不知道从哪里开始。如果有更好的方法，那么我也对此持开放态度。[http://ideone.com/wr8UA](http://ideone.com/wr8UA)

花车不是连续的，我不确定使用我拥有的方法这有多大的意义。意思是，偶尔会跳过数字（在 Ideone 的示例列表中，它们是 1.0、2.0、4.0；跳过 3.0 以在运行时模拟这种情况）。它们也不在子列表中的任何特定位置，因此所有 for 循环都在搜索它们。

希望这很清楚，我之前尝试过问过它并得到了反对意见，而不是关于让人们感到困惑的问题。让我知道是否有问题。谢谢大家！

编辑：根据要求在正文中编写代码：

```
listed = [ ["1 NWZ", "1 RWZ", "2 NWZ", "2 RWZ", "1E HZ", "1W HZ", "1-2EHZ", 2.0, "2W HZ"],
["1 NWZ", "1W HZ", "3E FZ", "SNOK", "POK", 3.0, "1-2EHZ", "2E AK", "2W HZ"],
["1 BW", "1AW AS", "3E FZ", "1BWAK", "POK", "TESTK", "1-2EHZ", "2E AK", 1.0]] 

dictionary={}
for sub_list in listed:
    for value in sub_list:
        if isinstance(value,float):
            dictionary[str(value)]=sub_list
        else:
            pass
ordered_list=[]
    for i in range(1,len(listed)+1):
    if dictionary[str(i)]:
        ordered_list.append(dictionary[str(i)])

for sub_list in ordered_list:
    print sub_list 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-06T14:26:31.423

该[`sort`方法](http://docs.python.org/library/stdtypes.html#mutable-sequence-types)有一个方便的`key`关键字参数，让您指定一个要调用的函数来确定列表应该对哪些信息进行排序。

对列表进行排序就像编写一个返回每个子列表中包含的浮点值的函数一样简单：

```
def sortOnFloat(sublist):
    return [v for v in sublist if isinstance(v, float)] 
```

请注意，我只是返回`list`所有浮点值中的一个；比只退回一个要容易得多。即使子列表中有 0 个浮点值，这也会起作用。

像这样对您的列表进行排序：

```
listed.sort(key=sortOnFloat) 
```

我已经克隆了您的示例并使用上述方法对其进行了更新：http: [//ideone.com/u8ufK](http://ideone.com/u8ufK)

生成的输出：

```
['1 BW', '1AW AS', '3E FZ', '1BWAK', 'POK', 'TESTK', '1-2EHZ', '2E AK', 1.0]
['1 NWZ', '1 RWZ', '2 NWZ', '2 RWZ', '1E HZ', '1W HZ', '1-2EHZ', 2.0, '2W HZ']
['1 NWZ', '1W HZ', '3E FZ', 'SNOK', 'POK', 3.0, '1-2EHZ', '2E AK', '2W HZ'] 
```

请注意，该`.sort()`方法对列表进行就地排序。您也可以使用该[`sorted()`函数](http://docs.python.org/library/functions.html#sorted)生成一个已排序的新列表；它采用相同的论点：

```
orderedlist = sorted(listed, key=sortOnFloat) 
```

但请注意，就地排序总是更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:26:37.103

创建一个函数来提取要排序的键，然后调用[sorted](http://wiki.python.org/moin/HowTo/Sorting/)。

```
listed = [ ["1 NWZ", "1 RWZ", "2 NWZ", "2 RWZ", "1E HZ", "1W HZ", "1-2EHZ", 2.0, "2W HZ"],
["1 NWZ", "1W HZ", "3E FZ", "SNOK", "POK", 3.0, "1-2EHZ", "2E AK", "2W HZ"],
["1 BW", "1AW AS", "3E FZ", "1BWAK", "POK", "TESTK", "1-2EHZ", "2E AK", 1.0]] 

def get_key(l):
    return next(e for e in l if type(e) is float)

print sorted(listed, key=get_key) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T14:28:40.270

也许这个链接可以帮助你，它提供了在几乎每种语言中实现自定义排序的方法。

[使用自定义比较器进行排序](http://rosettacode.org/wiki/Sort_using_a_custom_comparator#Python)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T14:26:35.767

您会收到错误，因为列表中的数字是浮点数，但您使用整数查找键：

```
listed = [ ["1 NWZ", "1 RWZ", "2 NWZ", "2 RWZ", "1E HZ", "1W HZ", "1-2EHZ", 2.0, "2W HZ"],
["1 NWZ", "1W HZ", "3E FZ", "SNOK", "POK", 3.0, "1-2EHZ", "2E AK", "2W HZ"],
["1 BW", "1AW AS", "3E FZ", "1BWAK", "POK", "TESTK", "1-2EHZ", "2E AK", 1.0]]

dictionary={}
for sub_list in listed:
    for value in sub_list:
        if isinstance(value,float):  #### you look for floats
            dictionary[str(value)]=sub_list   ### the key is created as string
        else:
            pass
ordered_list=[]
for i in range(1,len(listed)+1):   ### this is a range of INTS!!!!
    if dictionary[str(i)]:
        ordered_list.append(dictionary[str(i)])  #### str(i) is '1', not '1.0' 

for sub_list in ordered_list:
    print sub_list 
```

我只能认为这不是好的代码。首先，不应该在同一个列表中混合字符串和数字。如果您创建该列表，我建议您使用字典，例如：

```
listitem = {'number': 2.0, 'strings': ['1 NHZ', '1 RWZ', 'TESTK']} 
```

希望这可以帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-06T14:34:52.750

```
>>> listed = [ ["1 NWZ", "1 RWZ", "2 NWZ", "2 RWZ", "1E HZ", "1W HZ", "1-2EHZ", 2.0, "2W HZ"],
["1 NWZ", "1W HZ", "3E FZ", "SNOK", "POK", 3.0, "1-2EHZ", "2E AK", "2W HZ"],
["1 BW", "1AW AS", "3E FZ", "1BWAK", "POK", "TESTK", "1-2EHZ", "2E AK", 1.0]]
>>> listed
[['1 NWZ', '1 RWZ', '2 NWZ', '2 RWZ', '1E HZ', '1W HZ', '1-2EHZ', 2.0, '2W HZ'], ['1 NWZ', '1W HZ', '3E FZ', 'SNOK', 'POK', 3.0, '1-2EHZ', '2E AK', '2W HZ'], ['1 BW', '1AW AS', '3E FZ', '1BWAK', 'POK', 'TESTK', '1-2EHZ', '2E AK', 1.0]]
>>> dictionary ={}
>>> for index,sub_list in enumerate(listed):
    for value in sub_list:
        if isinstance(value,float):
            dictionary[value]=index
        else:
            pass

>>> dictionary
{1.0: 2, 2.0: 0, 3.0: 1}
>>> it = sorted(dictionary.items())
>>> it
[(1.0, 2), (2.0, 0), (3.0, 1)]
>>> ordered_list = []
>>> for item in it:
    ordered_list.append(listed[item[1]])

>>> ordered_list
[['1 BW', '1AW AS', '3E FZ', '1BWAK', 'POK', 'TESTK', '1-2EHZ', '2E AK', 1.0], ['1 NWZ', '1 RWZ', '2 NWZ', '2 RWZ', '1E HZ', '1W HZ', '1-2EHZ', 2.0, '2W HZ'], ['1 NWZ', '1W HZ', '3E FZ', 'SNOK', 'POK', 3.0, '1-2EHZ', '2E AK', '2W HZ']]
>>> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-06T14:36:38.093

您的错误是因为您的代码中没有“1”元素。它实际上是“1.0”（因为它是一个浮点数），这样做会使代码工作：

```
for i in range(1,len(listed)+1):
    if dictionary[str(float(i))]:
        ordered_list.append(dictionary[str(float(i))]) 
```

然而，在我看来，这远不是一个做你想做的事情的好方法，许多人对替代方案给出了很好的建议。

# ios - 使用 NSDictionary 的线程安全崩溃？

> ID：11364048
> 
> 赞同：0
> 
> 时间：2012-07-06T14:21:43.507
> 
> 标签：ios, thread-safety, nsdictionary

我有跨多个线程多次访问和设置 NSDictionary 的代码，如下所示：

```
- (BOOL)flagForItem:(NSNumber*)itemID
{
    if(itemID) {
        return [[_itemFlagDict objectForKey:itemID] boolValue] 
    }
    return NO;
} 
```

和：

```
- (void)setFlagForItem:(NSNumber*)itemID
{
    if(itemID) {
        NSMutableDictionary *copy = [_itemFlagDict mutableCopy];
        [copy setObject:[NSNumber numberWithBool:YES] forKey:itemID];
        _itemFlagDict = [NSDictionary dictionaryWithDictionary:copy];
    }
} 
```

在 set 方法中，我最初有一个 NSMutableDictionary - 这已更改为您现在看到的模式，因为，Doh，NSMutableDictionary 不是线程安全的。我的理由是在副本中执行突变，然后重新分配`_itemFlagDict`以捕获更新。

但是，`EXC_BAD_ACCESS`访问.`_itemFlagDict``objectForKey:itemID`

我尝试的另一种方法是`@synchronized(_itemFlagDict)`在访问器和设置器方法上都使用。虽然这解决了问题，但此代码对性能很敏感，并且同步访问/分配会导致过多的性能下降。

所以我的问题是，我可以使用其他模式/方法来避免这种不良访问，同时不影响性能吗？如果优先级很重要，那么访问器方法的执行（不一定是铁定的准确性）是最重要的。

注意：我正在使用 iOS 4 及更高版本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T20:19:50.447

你试过读/写锁吗？您可以在 get 方法中有多个线程，在 set 方法中有一个 writer [https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/pthread.3.html](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/pthread.3.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-01T08:13:11.137

我也遇到了同样的问题，我目前的解决方案是使用原子操作来实现线程安全的字典。您可以查看它：[https ://github.com/bangquangvn/FastestThreadsafeDictionary-iOS](https://github.com/bangquangvn/FastestThreadsafeDictionary-iOS)

我认为这是最快的解决方案。

# javascript - 如何通过javascript代码显示谷歌地图并在设备上获取坐标？

> ID：11364051
> 
> 赞同：0
> 
> 时间：2012-07-06T14:21:57.043
> 
> 标签：javascript, google-maps, cordova, coordinates

我是在 android 中完成的，但现在我需要通过 phone-gap 构建应用程序，并且我需要在设备上加载地图并获取设备的当前位置坐标（纬度和经度）。

所以我现在需要有javascript代码，坦率地说，我现在对java脚本不太熟悉......任何代码/帮助。

这是我显示地图的代码

谢谢

```
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0; padding: 0 }
  #map_canvas { height: 100% }
</style>
<script type="text/javascript"
  src="http://maps.googleapis.com/maps/api/js?key*****************&sensor=true">
</script>
<script type="text/javascript">
  function initialize() {
    var myOptions = {
      center: new google.maps.LatLng(-34.397, 150.644),
      zoom: 8,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions);
  }
</script>
</head>
<body onload="initialize()">
<div id="map_canvas" style="width:100%; height:100%"></div>
</body>
</html> 
```

在“*”的地方，我有我的谷歌 api 密钥..

现在我需要获取坐标……</p>

修改并当前使用此代码从链接[http://docs.phonegap.com/en/1.0.0/phonegap_geolocation_geolocation.md.html](http://docs.phonegap.com/en/1.0.0/phonegap_geolocation_geolocation.md.html)但即便如此我收到此错误“KCLErrorDomain Error 0”

```
<!DOCTYPE html>
<html>
<head>
    <title>Device Properties Example</title>

    <script type="text/javascript" charset="utf-8" src="cordova-1.9.0.js"></script>
    <script type="text/javascript" charset="utf-8">

        document.addEventListener("deviceready", onDeviceReady, false);

        var watchID = null;

        function onDeviceReady() {

            var options = { frequency: 5000 };
            watchID = navigator.geolocation.watchPosition(onSuccess, onError, options);
        }

        function onSuccess(position) {
            var element = document.getElementById('geolocation');
            element.innerHTML = 'Latitude: '  + position.coords.latitude      + '<br />' +
            'Longitude: ' + position.coords.longitude     + '<br />' +
            '<hr />'      + element.innerHTML;
        }

        function onError(error) {
            alert('code: '    + error.code    + '\n' +
                  'message: ' + error.message + '\n');
        }

        </script>
</head>
<body>
    <p id="geolocation">locating coordinates...</p>
</body>
</html> 
```

我不知道如何解决这个错误……使用 xcode 4.0.1 进行 phonegap 应用程序开发并尝试在 4.3 模拟器上运行..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T16:33:20.410

这里引用了关于地理位置的 PhoneGap 文档 (http://docs.phonegap.com/en/1.0.0/phonegap_geolocation_geolocation.md.html)：

> 地理位置提供设备的位置信息，例如纬度和经度。位置信息的常见来源包括全球定位系统 (GPS) 和从网络信号（例如 IP 地址、RFID、WiFi 和蓝牙 MAC 地址以及 GSM/CDMA 小区 ID）推断的位置。不保证 API 返回设备的实际位置。
> 
> 此 API 基于 W3C 地理位置 API 规范。一些设备已经提供了这个规范的实现。对于这些设备，使用内置支持而不是用 PhoneGap 的实现替换它。对于不支持地理位置的设备，PhoneGap 的实现应该与 W3C 规范兼容。

所以基本上，您可以使用 HTML5 Geolocation API，而不必担心 PhoneGap 的任何差异。如果您想获得一次用户的位置，请使用`navigator.geolocation.getCurrentPosition()`，如果您想定期发送用户的位置，请使用`navigator.geolocation.watchPosition()`：

```
navigator.geolocation.watchPosition(locationSuccess, locationError, {timeout: 30000});

function locationSuccess(position)
{
    // this is your position as a LatLng object. use it however you need
    var latLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
}

function locationError(err)
{
    if (err.code == 1)
        alert("You must allow this website to use the Geolocation API to access your position.");
    else if (err.code == 3)
        alert("Unfortunately, your position request timed out.");
    else
        alert("Unfortunately, your position could not be determined.");
} 
```

# asp.net - 浏览器文件中捕获和识别的区别

> ID：11364052
> 
> 赞同：1
> 
> 时间：2012-07-06T14:22:12.130
> 
> 标签：asp.net, asp.net-mvc-3

我想为我的 ASP.net MVC 应用程序创建自己的浏览器文件。但是我不清楚浏览器文件的网关或浏览器元素中的“捕获”和“标识”元素的区别。两者都可以有一个 userAgent-element 定义正则表达式：

```
<identification>
    <userAgent match="iPad" />
</identification>
<capture>
    <userAgent match="iPad" />
</capture> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T16:03:51.517

**捕获**

定义有关使用哪些附加标头、userAgent 或功能元素来捕获有关浏览器的信息的信息。这在尝试检测 .NET Framework 2.0 发布时不可用的新浏览器时很有用。为了捕获值，浏览器定义可以在任何标识元素的匹配属性中包含正则表达式捕获。例如，IE.browser 文件中定义的以下 userAgent 元素从用户代理请求标头捕获屏幕高度（以像素为单位）。

浏览器定义可能还需要通过扫描不用于区分浏览器类的请求标头来捕获其他信息。例如，以下捕获元素捕获 OpenWave 蜂窝电话的软键数量。当您在基于 Windows Mobile 的智能手机上按下相应的硬件按钮时，软键会显示菜单和命令：

```
<capture>
    <header name="HTTP_X_UP_DEVCAP_NUMSOFTKEYS" 
            match="(?'softkeys'\d+)" />
</capture> 
```

捕获元素不包含任何属性。

捕获元素可以包含零个或多个以下子元素：

```
header

userAgent

capability 
```

**鉴别**

定义有关如何从传入请求中识别此浏览器的信息。

标识元素不包含任何属性。

标识元素可以包含以下一个或多个子元素：

```
header

userAgent

capability 
```

# perl - Image::Imlib2->load("filename") 说文件不存在，即使它存在

> ID：11364058
> 
> 赞同：1
> 
> 时间：2012-07-06T14:22:25.807
> 
> 标签：perl

```
use Image::Imlib2;
my $a = Image::Imlib2->load("/foo/file"); 
```

给我以下错误：

```
Runtime error: Image::Imlib2 load error: File does not exist at (eval 469) line 6. 
```

请注意，/foo/file 是 CIFS 挂载目录，这只发生在 CIFS 挂载目录上的文件中。另一个复杂情况是，这发生在 Debian Squeeze 上，而不是 Debian Lenny。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:22:27.600

解决方案是使用“noserverino”选项挂载 CIFS 目录。

Image::Imlib2 是 Imlib2 C 库的 Perl 包装器。问题是 CIFS 服务器可以返回大于 31^2 的 inode 整数值。这会使未使用 LFS（大文件支持）编译的程序引发 glibc EOVERFLOW 错误。使用 LFS 支持编译程序（即使用 -D_FILE_OFFSET_BITS=64）或使用“noserverino”挂载选项。但是您可能无法正确检测硬链接。

[http://linux.die.net/man/8/mount.cifs](http://linux.die.net/man/8/mount.cifs)

# php - 一个安全的动态 PHP 包括？

> ID：11364066
> 
> 赞同：-2
> 
> 时间：2012-07-06T14:22:51.457
> 
> 标签：php, include

如何创建一个动态的 PHP 包含，这是安全的？例如，我有一个 index.php 文件，其中包含 header.php 和 footer.php，然后使用

```
index.php?page=about 
```

如果可能的话，它需要是动态的，因此使用数组和大小写将非常耗时并且需要修改。

我还希望能够根据包含的页面更改网站的标题。

我目前有这个：

```
<?php
require_once 'includes/config.php';
//Set values for page  
$page_title = 'home page';
$current_page = 'home';

require_once 'includes/header.php';
?>

CONTENT

<?php
require_once 'includes/footer.php';
?> 
```

谢谢

这是包含我的页面的安全方式吗？

```
if( isset( $_GET[ 'page' ] ) )
 {
   if( strpos( $_GET[ 'page' ], "/" ) )
     {
      $dir = substr( str_replace( ’’, ”, $_GET[ 'page' ] ), 0, strpos( $_GET[ 'page' ], "/" ) ) . "/";

      $file = substr( strrchr( $_GET['page' ], "/" ), 1 );
      if( file_exists( $dir.$file.".php" ) )
        {
         include( $dir.$file.".php" );
      } else {
         include( "home.php" );
      }
   } else {
      if( file_exists( basename( $_GET[ 'page' ] ).".php" ) ) 
        {
         include( basename( $_GET[ 'page' ] ).".php");
      } else {
         include( "404.php" );
      }
   }
} else {
   include( "home.php" );
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T15:01:12.207

为了防止错误和未经授权的文件访问（安全）您的 Web 目录之外的页面或无效页面，您应该执行以下操作。

通过检查句点来验证 $_GET['page']。虽然句点在文件名中可能是有效的，但看起来您将从值构造文件名，并且句点可能表示突破尝试获取对根目录的访问权限。

从那里我将构建包含的文件路径，然后使用 file_exists 确保它在包含它之前存在。

至于页面的更改标题包括我会做这样的事情：

```
<?php
$page_title = 'Default Title';
$page_to_include = 'default';

if( strpos($_GET['page'], '.') !== false ){
  //throw/display error - could be a breakout attempt
}
if( !file_exists(sprintf('page_includes/%s.php', $_GET['page'])) ){
  //requested page does not exists, throw or display error
}else{
  $page_to_include = sprintf('page_includes/%s.php', $_GET['page']);
}

//do page validation here with file_exists
ob_start();
include $page_to_include;
$included_page = ob_get_clean(); //gets contents and cleans the buffer and closes it

require_once 'includes/header.php';
echo $included_page;
require_once 'includes/footer.php';
?> 
```

这样，页面首先被包含并存储在缓冲区而不是输出中。它允许您包含页面来修改 $page_title，然后修改后的 $page_title 可用于 header.php 脚本以在标签内输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:26:01.290

只是为了改标题？将此添加到您的 header.php

```
<title>
<?php
if(isset($_GET['page']) {
    echo $_GET['page'];
} else {
    echo 'My Site';
}
?>
</title> 
```

# php - 使用 .serialize() PHP 错误发布表单数据

> ID：11364068
> 
> 赞同：1
> 
> 时间：2012-07-06T14:22:58.250
> 
> 标签：php, jquery, ajax

我正在使用 jQuery 的 .serialize() 将包含一些复选框和其他输入的表单数据发布到 PHP 脚本。

post.js：

```
$(function(){
$("#button").click(function(){
    $.ajax({
        type: "POST",
            url: "post.php",
            data: $("form#input").serialize(),

    success: function(data){
        $.getJSON('post.php', function(data) {
                        $.each(data, function(key, val) {

                        })
        })
    }
    })
    })
}) 
```

post.php：

```
$tags = array();
foreach($_POST['checkboxes'] as $key => $value){
  $tags[] = "$value";
}
$json = array(
  array(
    "tags" => $tags,
  ),
);
echo json_encode($json); 
```

如果我将 getJSON 指向 post.php，我会在错误日志中收到一条 PHP 警告，上面写着“PHP 警告：为 foreach() 提供的参数无效”，这会导致输入表单中的数据无法正确传递（即 fwrite在 foreach 没有写任何东西之后）。如果我为 getJSON 引用另一个文件，比如 data.php，或者如果我根本不包含它，则帖子可以正常工作。为什么会这样？我可以只存储数据并制作第二个脚本来返回 JSON 数据，但在一个脚本中完成这一切会更容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:30:47.473

这是交易：

```
success: function(data){ 
```

在上面的部分中，您收到的数据是`json_encoded string containing key:value pairs of $tags`您定义的返回的数据。

```
$.getJSON('post.php', function(data) { 
```

现在，在您的 getJSON 请求中，您没有传递任何值，并且您的 foreach 语句希望您发布复选框的值，以便可以解析它们并制作标签。我不确定我是否理解您为什么要这样做，因为`success: function(data)`它将本机解析从服务器返回的 JSON 并为您准备好。

```
$.each(data, function(key, val) { 
```

如果您只是简单地丢失`$.getJSON`请求并使用 each 函数，您将遍历从服务器返回的标签。我相信这是您想要的预期功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T14:31:42.637

当未发布复选框时，您的代码会中断

```
$tags = array();
if( array_key_exists('checkboxes', $_POST) && is_array($_POST['checkboxes']) ) {
    $tags = array_values($_POST['checkboxes']);
}

$json = array(
  array(
    "tags" => $tags,
  ),
);
echo json_encode($json); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T14:32:08.450

你得到`Invalid argument supplied for foreach`是因为它期望一个`$_POST['checkboxes']`你没有在你的`$.getJSON`电话中发送的值。

`$.getJSON`发送*另一个*AJAX 调用，`GET`即获取 JSON 文件的请求。您已经向 发送​​了`POST`请求`post.php`，无需再发送呼叫。

添加`dataType: 'json'`到您的第一个调用中，将为您解析 JSON 响应。

```
$.ajax({
    type: "POST",
    url: "post.php",
    data: $("form#input").serialize(),
    dataType: 'json',
    success: function (data) {
        $.each(data, function (key, val) {
            // code here
        });
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T14:29:21.403

你不必调用“getJSON”，因为你已经有了你想要的。您需要的一切都在数据中。所以你的“成功”回调应该是这样的：

```
function(data){
    var jsonData = $.parseJSON(data);
    $.each(jsonData, function(key, val) {

    })
} 
```

# objective-c - 如何在Objective-C中检查输入是双精度还是字符串？

> ID：11364080
> 
> 赞同：1
> 
> 时间：2012-07-06T14:23:48.637
> 
> 标签：objective-c

你如何检查给定的输入是字符串还是双精度？我尝试这样做`[self.display.text doubleValue]`，如果这不是有效的双精度，它返回 0，但问题是 0 实际上是实际双精度的有效输入，因此程序不会知道它是默认错误回退还是实际有效输入。

你怎么解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:46:56.913

`-[NSFormatter getObjectValue:forString:range:error:]`做你想做的事。

更多细节[在这里](https://stackoverflow.com/a/170867/901059)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T14:48:16.740

使用`strtod`( [reference](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/strtod.3.html) ) 以“C”方式执行，因为它为您提供解析的最后一个字符：

```
NSString *input = @"123.456";
char *endptr;
double value = strtod([input UTF8String], &endptr);
if (*endptr != '\0')
{
    NSLog(@"input is a string");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T15:43:29.827

您可以使用正则表达式和 NSPredicate 来测试它是否是双精度值。

```
NSPredicate *predicate;
predicate = [NSPredicate predicateWithFormat:@"SELF MATCHES '^[-+]?[0-9]*\.?[0-9]+$'"];
BOOL result = [predicate evaluateWithObject:@"yourdoublevaluehere"]; 
```

您可能需要调整正则表达式，因为我在脑海中写下了它。

# c++ - gcov 在添加 -rdynamic 标志后停止生成 gcda 文件（通过 gdb 调用 __gcov_flush()）

> ID：11364090
> 
> 赞同：3
> 
> 时间：2012-07-06T14:24:03.693
> 
> 标签：c++, gdb, gcov

我在 C++ 中有一些服务器（从构建系统获取的命令）：

```
g++ -o obj/server.o -c -m64 -isystem/opt/boost/include -Wall -Werror -march=core2 -ftest-coverage -fprofile-arcs -DGCOV_ENABLED= -Iinclude -I/opt/hydraOST/lzopro/include -I/usr/include/libxml2 -Idaemon/include src/server.cpp

g++ -o bin/server.exe -rdynamic -ftest-coverage -fprofile-arcs -m64 -Wl,-rpath=\$ORIGIN -Wl,-rpath=/opt/hydraOST/lzopro/lib  obj/server.o (+ other libs) 
```

因为它是守护进程，我用信号停止它，但在`kill $PID`我使用*gdb*之前强制转储 gcov 数据：

```
gdb -p $PID -batch -x gcov/dumpGcovData 
```

其中*gcov/dumpGcovData*的内容：

```
call __gcov_flush()
thread apply all call __gcov_flush() 
```

我知道链接应该是这样，`-lgcov`但因为它是以这种方式工作的，所以我没有在构建系统中更改它。问题是在添加`-rdynamic`标志之后发生的（**没有该标志它可以正常工作**）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T03:42:58.377

> 我知道链接应该是 -lgcov

这是不正确的：gcc 将`-lgcov`根据您的标志自动添加；不需要明确`-lgcov`的。

> 在添加 -rdynamic 标志后出现问题（没有该标志，它可以正常工作）。

我无法想象`-rdynamic`与这个问题有什么关系。一个简单的测试用例表明它可以*以任何一种*方式工作，因此您声称“它停止工作并添加了`-rdynamic`”是错误的，或者正在进行一些更复杂的交互（我没有在我的简单测试中重现）。

你可能想从

1.  验证实际上重新链接`server.exe`没有`-rdynamic`作为*唯一*的更改使其再次工作。
2.  显示 和 的`g++ -o bin/server.exe ... -Wl,-y,__gcov_flush`输出`readelf -s bin/server.exe | grep __gcov_flush`。这是它的样子：

    ```
    g++ -ftest-coverage -fprofile-arcs cov.c -g -rdynamic -Wl,-y,__gcov_flush
    /usr/lib/gcc/x86_64-linux-gnu/4.4.3/libgcov.a(_gcov.o): definition of __gcov_flush

    readelf -s a.out | grep gcov_fl
    66: 00000000004023c0   131 FUNC    LOCAL  HIDDEN   14 __gcov_flush 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T10:09:16.203

添加`-Wl,-y,__gcov_flush`后打印出行（和标志`-rdynamic`无关紧要）：

```
/usr/lib/gcc/x86_64-redhat-linux/4.1.2/libgcov.a(_gcov.o): definition of __gcov_flush 
```

不幸的是，看起来`-rdynamic`标志不影响输出：

*与 -rdynamic*：

```
readelf -s server.exe | grep gcov_flush
  1203: 0000000000808370   107 FUNC    LOCAL  HIDDEN   12 __gcov_flush 
```

并且*没有 -rdynamic*：

```
readelf -s server.exe | grep gcov_flush
  1203: 0000000000808380   107 FUNC    LOCAL  HIDDEN   12 __gcov_flush 
```

无论如何，我有一个非常简单的解决方案（或者更确切地说是解决方法）：只有在它的构建不是 gcov 时才添加 -rdynamic：

```
if CONFIG == gcov:
    addFlags(["-ftest-coverage", "-fprofile-arcs"])
else:
    addFlags(["-rdynamic"]) 
```

所以，主要问题似乎**没有解决**，无论如何都有一些解决方法（对我有用，因为我宁愿不使用 gcov 配置进行调试 - 只是为了生成覆盖率报告）。无论如何，谢谢你的帮助！

# c++ - SDL 和 Visual Studio 2010 资源

> ID：11364095
> 
> 赞同：2
> 
> 时间：2012-07-06T14:24:21.023
> 
> 标签：c++, resources, sdl

我有一个简单的问题。我在我的 c++ 程序中使用 SDL 和 SDL_image，并且可以从单个 png 文件中加载图像。

```
SDL_Surface *dot = NULL;
dot = load_image("dot.png"); 
```

但是，如果我将 png 文件添加到资源中，我该如何加载它呢？所以我不想存储在 exe 旁边的 png 文件中。是否可以从资源中加载？

试过了

```
dot = load_image(MAKEINTRESOURCE(IDB_PNG1)); 
```

但它没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-21T16:34:45.180

完全可以将图像或其他内容从 Windows 资源加载到 SDL。为此，您需要获取原始数据并将其传递给适当的 RWOPS。

```
HMODULE hModule = GetModuleHandle(_T("myapp.exe"));

HRSRC hWhite = FindResource(hModule, MAKEINTRESOURCE(IDB_WHITE_PNG), _T("PNG"));            
unsigned int white_size = SizeofResource(hModule, hWhite);
HGLOBAL hgWhite = LoadResource(hModule, hWhite);
unsigned char* white_data = (unsigned char*)LockResource(hgWhite);

SDL_Surface* white = IMG_Load_RW(SDL_RWFromConstMem(white_data, white_size), 1); 
```

这假设您的 *.rc 文件中有类似的内容：

```
IDB_WHITE_PNG  PNG "White.png" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T13:31:07.567

根据`MAKEINTRESOURCE` [文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648029%28v=vs.85%29.aspx)：

> 返回值应仅传递给明确指示它们接受 MAKEINTRESOURCE 作为参数的函数。

您没有给出`load_image`（顺便说一句，请包括您在问题中使用的函数的内容，您会得到更好的答案......）但我敢打赌它没有使用它的参数来调用 Windows SDK 函数之一接受`MAKEINTRESOURCE`...据我所知，这些资源应该包含一些特定的 Windows UI 数据，如鼠标光标、图标等。用于 Windows 功能，而不是 SDL 等其他库，所以我并不感到惊讶不起作用。

# android - 通知栏可见性

> ID：11364097
> 
> 赞同：0
> 
> 时间：2012-07-06T14:24:23.803
> 
> 标签：android, android-notification-bar

我的应用程序正在运行横向模式，我在清单文件中设置了以下活动属性

```
android:theme="@android:style/Theme.Black.NoTitleBar.Fullscreen" 
```

当我的活动运行时，它肯定会隐藏通知栏。但是当假设我从我的应用程序启动浏览器活动并返回时，通知栏再次可见。我试图找到它的解决方案，但没有任何效果。我点击了以下链接，但徒劳无功。 [屏幕锁定和解锁后隐藏的通知栏重新出现](https://stackoverflow.com/questions/8443809/hidden-notification-bar-reappearing-after-screen-lock-and-unlock) 任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:35:25.770

我在我的 java 代码中处理这些事情

```
 getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                WindowManager.LayoutParams.FLAG_FULLSCREEN 
```

在 java 中处理这个问题的好处是你可以随时释放这些标志来摆脱全屏。我把它放在 setContent 之前，但我不记得它是否需要。

如果这不能保持全屏显示，您可以尝试将其放入 onResume() 中，我猜您是如何丢失它的。

# perl - 让 Devel::Cover 覆盖特定路径中的所有文件

> ID：11364100
> 
> 赞同：5
> 
> 时间：2012-07-06T14:24:40.033
> 
> 标签：perl, testing, devel-cover

我的任务是清理一些写得不好但测试数量惊人的遗留代码。其中一些测试在如下文件中运行代码：

```
fcgi/*.fcgi 
```

我非常希望将这些内容包含在我的报道报告中。事实上，我很想确保我可以在 、 和 中包含所有*内容*（无论扩展名如何）`lib/`，`fcgi/`而在*任何*其他目录中都不包含任何内容。`utils/`

 *这是我的许多尝试之一：

```
HARNESS_PERL_SWITCHES=-MDevel::Cover=+inc,fcgi,+inc,lib,+inc,util prove -rl t 
```

失败！

[我还尝试创建简单的 Build.PL 或 Makefile.PL 脚本](https://stackoverflow.com/questions/11212425/how-to-use-develcover-with-prove)，并在运行“cover -test”或“./Build testcover”等内容时不断收到“未定义测试”。

这是 Devel::Cover 0.88 和 perl 版本 5.12.2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T16:04:16.397

好吧，我举了你的例子，稍微摆弄了一下，它似乎对我来说用最小的 Makefile.PL 和覆盖测试工作得很好。请克隆这个：git://gist.github.com/3061026.git

自述文件包含在我的系统上发生的事情。

具体来说，在我的一个测试文件中，我添加了：

```
use 5.12.0;
use Test::More;

use lib 'lib';

use Foo;
require 'fcgi/foo.fcgi';   # <====== pull in an fcgi file

is craptastic(), 'This is craptastic',
    'We have run an fcgi/*fcgi test'; 
```*

# html - 浏览器如何确定要请求哪些对象？

> ID：11364102
> 
> 赞同：-1
> 
> 时间：2012-07-06T14:24:49.830
> 
> 标签：html, browser, tags, request

当浏览器接收到初始的 HTML 根页面时，它如何准确地确定应该请求哪些其他对象。是否有一个 HTML 标签列表，浏览器在检测到它们时总是会从服务器请求相关内容？

我意识到需要为此实现一个 HTML 解析器，但是我不确定所有重要的单个标签和属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:26:10.203

浏览器解析 HTML，并知道哪些元素（具有哪些属性）需要加载额外的资源。

即他们实现了一个 HTML 解析器。

# google-chrome - 如何防止用户放大桌面网络应用程序？

> ID：11364103
> 
> 赞同：5
> 
> 时间：2012-07-06T14:24:54.973
> 
> 标签：google-chrome, web-applications, safari, webkit, gesture

我正在尝试使用 HTML 5 技术来创建在桌面上的 Chrome 浏览器中运行的应用程序。我的挑战之一是似乎没有办法做相当于：

```
<meta name="viewport" content="width=device-height, user-scalable=no, maximum-scale=1, minimum-scale=1" /> 
```

在桌面上。我发现了一个针对铬的问题，但它似乎被忽略了。

要了解这个问题，请在 Chrome 中访问 maps.google.com 或在 Mac 上访问 Safari，然后做一个捏缩放手势。浏览器并没有像用户期望的那样放大地图，而是造成了巨大的无法使用的混乱。

鉴于谷歌地图和 Chrome 是由同一家公司开发的，这感觉像是一个相当绝望的事业。但这似乎是整个“Web 应用程序”概念中的一个非常根本的缺陷。如果浏览器甚至不允许您控制一些基本的东西，比如让您的虚拟视口与您的窗口大小相同，那么创建原生体验是不可能的。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-10T21:46:35.023

我面临同样的问题。我最近发现了这个：

```
document.addEventListener('touchmove', function(event){
    if(event.touches.length >=2) {
        event.stopPropagation(); 
        event.preventDefault(); 
    }
}); 
```

但如果用户行动得非常快，它仍然有效。这在信息亭设置中真的很烦人，用户在事故中进行捏拉缩放并且不知道发生了什么，所以信息亭只是坏了。如果我找到解决方案，我会继续发布

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T00:29:36.460

当前没有禁止用户放大其 Web 视图的“标准”。视口的元标记正是……一个元标记。w3 将元数据定义为：

“元数据内容是设置其余内容的表示或行为的内容，或者设置文档与其他文档的关系，或者传达其他“带外”信息的内容。”

并定义一个元标记如下：

“元元素代表了各种元数据，这些元数据不能用标题、基础、链接、样式和脚本元素来表达。”

元标记本质上是非规范性的，标准并没有真正规定它可以做什么或不能做什么，因为它取决于浏览器（或 Web 平台）来规定它使用什么元信息并最终忽略。视口元标记是专门为移动平台创建的 webkit 元标记。

据我从研究中得知，webkit（或 Chrome）不存在这样的当前等效标签，阻止用户查看 -> 缩放、按 ctrl（或命令）+/- 或捏在笔记本电脑触控板上做手势并相应地缩放。

* * *

## 回答 #3

> 赞同：-8
> 
> 时间：2013-11-23T20:42:02.627

很简单，使用小程序来防止缩放，java rulez。

# objective-c - 如何在 UIIMagePickerController 中设置自定义图像

> ID：11364104
> 
> 赞同：0
> 
> 时间：2012-07-06T14:24:54.987
> 
> 标签：objective-c, ios, uiimage, uiimagepickercontroller

我有 3 个选项的 UIActionSheet -

1.  拍照（从相机）
2.  从图书馆挑选
3.  编辑照片（如果用户有头像）

我使用 UIImagePickerController 并且前两个选项没有问题。用户选择照片，然后可以缩放/移动以裁剪一张。

**所以，我的问题是 - 如何使用当前的比例因子和框架将已保存的照片用于编辑（第三个选项）。** Fe，如果我选择“编辑照片”，我想获得与预览后选择的相同照片“状态”。

这就是本机“联系人”应用程序的工作原理！

![照片的预览](../Images/ec527483bc649d02d91553fc7ca49d6c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:28:16.297

您需要`UIImagePickerControllerEditedImage`在委托方法中访问该对象：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {
    UIImage *image = [info objectForKey:UIImagePickerControllerEditedImage];
    if (!image) image = [info objectForKey:UIImagePickerControllerOriginalImage];
    ....
} 
```

然后你可以在你自己的编辑视图控制器中使用这个图像。通讯录应用程序以这种方式工作，因为它将编辑后的图像写回 ，这`ALAsset`是一个破坏性的更改。对您应用程序中的用户执行此操作可能不是一个好主意，因此最好编写您自己的编辑图像控制器来处理编辑后的图像，而不是`UIImagePickerController`. [在 github 上](https://github.com/search?q=crop&repo=&langOverride=&start_value=1&type=Repositories&language=Objective-C)的搜索显示了大量可以帮助您在此处裁剪的开源存储库。

# php - 处理我的队列时“超出最大执行时间”

> ID：11364107
> 
> 赞同：-4
> 
> 时间：2012-07-06T14:25:07.263
> 
> 标签：php, mysql, queue

我使用 MySQL 和 PHP 创建了一个队列。PHP 脚本首先从数据库中检索所有要完成的任务，然后使用循环一一执行所有任务。但是由于任务很多，每个任务都需要很多时间，所以结果是“超出最大执行时间”的错误。

我怎样才能解决这个问题？请不要建议我编辑 php.ini。我在浏览器上对此进行了测试，但 PHP 脚本将使用 cron 调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:43:32.657

您可以在 php 代码的顶部设置这段代码：

```
ini_set('max_execution_time', 0); 
```

或者在同一文件夹中创建一个 .htaccess 文件，其中包含以下代码：

```
php_value max_execution_time 0 
```

# java - Android 绘图性能 - canvas.drawRect 与位图绘图

> ID：11364111
> 
> 赞同：0
> 
> 时间：2012-07-06T14:25:12.240
> 
> 标签：java, android, performance, drawing, android-canvas

我正在编写一个基于粒子的游戏，主要是通过绘制许多彩色形状来构建的。

**问题1）**

对于大多数敌方单位，我通过设置颜料然后在画布上绘制矩形来绘制 4 个分层矩形。

我想知道使用位图绘制还是使用画布绘图工具绘制更好？我可以轻松地制作我想要绘制的敌方单位的单一图像。

**问题2）**

对于我必须绘制到屏幕上的图像，我想知道我需要如何加载它们？

现在我有大量这样加载的 .png 图像：

`direction1 = BitmapFactory.decodeStream(assetMgr.open("direction1.png"));`

我读过 RGB565 是绘制到屏幕上的禁食图像类型。Microsoft Paint 有一些保存选项，但大多数程序只保存为位图，而不是一种位图。如果我要开始使用这种新格式，我会：

1.  制作新图像并使用相同的加载代码。
2.  使用相同的图像并添加类似`Bitmap bmp = Bitmap.createBitmap(width, height, Bitmap.Config.RGB_565);`从初始加载格式转换为 RGB565 格式的内容。
3.  制作新图像并更改我的加载代码。

谢谢你的帮助！非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-04T16:08:50.083

如果位图没有逐帧移动，您应该尝试减少 invalidate() 方法调用。仅当进行更改并应更新画布时才应重新绘制画布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:35:45.667

1.  没有任何。使用 OpenGL 总是更好，唯一的缺点是它需要更多的电池能量，因为它是硬件加速的。

2.  RGB565 意味着图像使用 16 位，所以这是您应该寻找的选项。不要转换任何东西，只需以您将使用的格式创建它们。

# performance - 在 F# 中返回字符串和代码优化

> ID：11364113
> 
> 赞同：2
> 
> 时间：2012-07-06T14:25:19.817
> 
> 标签：performance, f#, f#-interactive

如何修改下面的代码以返回“字符串”，以便返回的输出显示在我的 MVC 页面上，并且还希望`enteredChar`从用户那里接受。

有没有更好的方法来创建这个金字塔？

当前代码：

```
let enteredChar = 'F' // As Interactive window doesn't support to Read Input
let mylist = ['A'..enteredChar] 
let mylistlength = mylist |> List.length
let myfunc i x tlist1 =
    (for j = 0 to mylistlength-i-2 do printf "%c" ' ')
    let a1 = [for p in tlist1  do if p < x then yield p]
    for p in a1 do printf "%c" p
    printf "%c" x
    let a2 = List.rev a1
    for p in a2 do printf "%c" p
    printfn "%s" " "

mylist |> List.iteri(fun i x -> myfunc i x mylist) 
```

输出：

```
 A
    ABA
   ABCBA
  ABCDCBA
 ABCDEDCBA
ABCDEFEDCBA 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T15:51:55.360

一些小的优化可能是：

*   使用长字符串`StringBuilder`代替`printf`which 会很慢。
*   使用`Array`代替`List`since`Array`效果更好`String`。

这是一个生成金字塔字符串的版本，它与您的代码密切相关：

```
open System
open System.Text

let generateString c = 
    let sb = StringBuilder()             
    let generate i x arr =
        String.replicate (Array.length arr-i-1) " " |> sb.Append |> ignore
        let a1 = Array.filter (fun p -> p < x) arr
        String(a1) |> sb.Append |> ignore
        sb.Append x |> ignore
        String(Array.rev a1) |> sb.Append |> ignore
        sb.AppendLine " " |> ignore

    let arr = [|'A'..c|]               
    arr |> Array.iteri(fun i x -> generate i x arr)
    sb.ToString()

generateString 'F' |> printfn "%s" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T15:39:20.567

如果我理解您的问题（这可能属于[Code Review](https://codereview.stackexchange.com/)），这是重写您的函数的一种方法：

```
let showPyramid (output: TextWriter) lastChar =
  let chars = [|'A' .. lastChar|]

  let getRowChars n = 
    let rec loop acc i =
      [|
        if i < n then let c = chars.[i] in yield c; yield! loop (c::acc) (i+1)
        else yield! List.tail acc
      |]
    loop [] 0

  let n = chars.Length
  for r = 1 to n do 
    output.WriteLine("{0}{1}{0}", String(' ', n - r), String(getRowChars r)) 
```

例子

```
showPyramid Console.Out 'F' 
```

或者，输出到字符串

```
use output = new StringWriter()
showPyramid output 'F'
let pyramid = output.ToString() 
```

### 编辑

看到 Tomas 的回答后，我意识到我在你的问题中跳过了“返回字符串”。我更新了代码并添加了示例来展示你如何做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-06T15:46:14.527

作为 Daniel 解决方案的替代方案，您只需对代码逻辑进行最少的更改即可实现您想要的。`printf`您可以使用which`Printf.bprintf`将输出写入指定的`StringBuilder`. 然后您可以简单地从`StringBuilder`.

修改后的函数将如下所示。我添加了参数`str`并替换`printf`为`Printf.bprintf str`（并`printfn`与`bprintf`附加`\n`字符一起）：

```
let myfunc i x tlist1 str = 
    (for j = 0 to mylistlength-i-2 do Printf.bprintf str "%c" ' ') 
    let a1 = [for p in tlist1  do if p < x then yield p] 
    for p in a1 do Printf.bprintf str "%c" p 
    Printf.bprintf str "%c" x 
    let a2 = List.rev a1 
    for p in a2 do Printf.bprintf str "%c" p 
    Printf.bprintf str "%s\n" " " 
```

要调用该函数，您首先要创建`StringBuilder`它，然后`myfunc`在每次调用中将其传递给它。最后，您可以使用`ToString`方法获得结果：

```
let str = StringBuilder()
mylist |> List.iteri(fun i x -> myfunc i x mylist str) 
str.ToString() 
```

我认为 Daniel 的解决方案看起来更好，但这是将打印代码转换为字符串构建代码的最直接方法（几乎可以使用 Search & Replace 来完成）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-07T01:53:28.973

```
let pyramid (ch:char) = 
  let ar = [| 'A'..ch |]
  let len = ar.Length
  Array.mapi
    (fun i ch -> 
      let ar = ar.[0..i]
      String.replicate (len - i - 1) " " + new string(ar) + new string((Array.rev ar).[1..]))
    ar
  |> String.concat "\n" 

pyramid 'F' |> printfn "%s" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-07T14:27:32.680

这是另一种方法，似乎很好地展示了**功能组合**。我敢打赌这是这里答案中最短的解决方案。:)

```
let charsToString = Seq.map string >> String.concat String.Empty
let pyramid lastChar =
    let src = '-'::['A'..lastChar] |> List.toArray
    let len = Array.length src - 1

    fun row col -> row-abs(col-len+1)+1 |> max 0 |> Array.get src   // (1)
    >> Seq.init (len*2-1) >> charsToString                          // (2)
    |> Seq.init len                                                 // (3)

pyramid 'X' |> Seq.iter (printfn "%s") 
```

*   首先，我们生成一个不寻常的初始数据数组。它的元素`[0]`包含一个空格或任何你想要的分隔符；我更喜欢用破折号 ( `-`) 进行调试。
*   该`(1)`行创建了一个函数来计算要放置的字符。的结果`row-abs(col-len+1)+1`可以是*正数*（并且要放置一个字符）或*zeronegative*，并且应该有一个空格。注意没有`if` 声明：隐藏在`max`函数内部；
*   该`(2)`行构成一个`int -> string`用于生成单个行的函数；
*   该`(3)`行将上面的函数作为序列初始化器的参数传递。

这三行可以写成更详细的方式：

```
 let genCell row col = row-abs(col-len+1)+1 |> max 0 |> Array.get src 
    let genRow = genCell >> Seq.init (len*2-1) >> charsToString
    Seq.init len genRow 
```

由于函数组合，注意`genRow`不需要正式的参数：参数被绑定到`genCell`，返回单个参数的函数，正是`Seq.init`需要的。

# delphi - 移动上的浮点操作无效？

> ID：11364120
> 
> 赞同：1
> 
> 时间：2012-07-06T14:25:37.740
> 
> 标签：delphi, assembly

我遇到了一个以前从未见过的奇怪问题，在 Delphi 2010 中，有时当使用例程 CopyMemory（内部调用 Move）时，我得到一个 Invalid Float Point Operation 异常，当使用 Move 时可能发生这种情况？

我在汇编程序中有一个调试信息，我检查了 Move 的源代码，问题发生在 FILD 指令中，我发现 FILD 将整数值从内存转换为寄存器中的浮点数，它可能会触发该无效操作，但为什么那个会发生？我已经坚持了 2 天了

```
Assembler Information:
; System.Move (Line=0 - Offset=1)
;
00404E0C cmp eax, edx
00404E0E jz System.Move
00404E10 cmp ecx, +$20
00404E13 jnbe System.Move
00404E15 sub ecx, +$08
00404E18 jnle System.Move
00404E1A jmp dword ptr [System.Move+ecx*4]
00404E21 fild qword ptr [ecx+eax]
00404E24 fild qword ptr [eax] ; <-- EXCEPTION
00404E26 cmp ecx, +$08
00404E29 jle System.Move
00404E2B fild qword ptr [eax+$08]
00404E2E cmp ecx, +$10
00404E31 jle System.Move
00404E33 fild qword ptr [eax+$10]
00404E36 fistp qword ptr [edx+$10]
00404E39 fistp qword ptr [edx+$08]
00404E3C fistp qword ptr [edx]
00404E3E fistp qword ptr [ecx+edx]

Registers:
EAX: 0E3A4694 EDI: 0000000D
EBX: 00001B5C ESI: 0ECF7928
ECX: 00000005 ESP: 0612FC1C
EDX: 0E3A2B38 EIP: 00404E24 
```

什么可能导致该错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T16:05:12.957

我以前见过这个问题。问题是在进入 Move 方法之前，x87 寄存器的堆栈包含一些无效的浮点值，而不是为空。这是由于之前发生的异常导致 x87 堆栈这样离开。

Move 命令使用 x87 寄存器，因为它们允许在不依赖 SSE 指令的情况下快速移动数据，但它假定堆栈为空。

寻找解决方案：

*   在 Move 命令的开始处设置断点并使用 FPU 调试窗口来验证 FPU 堆栈是否确实被丢弃。
*   从这里开始：回溯在您的应用程序中，使用同一窗口导致此垃圾 FPU 堆栈的原因。这是你的问题的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:35:41.247

Seems similar to a problem I had before: [Memory corruption in System.Move due to changed 8087CW mode (png + stretchblt)](https://stackoverflow.com/questions/2584654/memory-corruption-in-system-move-due-to-changed-8087cw-mode-png-stretchblt)

My fix was to disable SSE/MMX stuff in FastMove.pas, so it did not (mis)use the FPU anymore (and not vulnerable to FPU corruption)

# iphone - 对 UI 对象所做的更改不会在 iPhone 模拟器中更新

> ID：11364121
> 
> 赞同：1
> 
> 时间：2012-07-06T14:25:39.383
> 
> 标签：iphone, objective-c, xcode

我是 Objective-c 和 iPhone 的新手，但过去做过很多 Java 编码。关于我通常最终能够找到答案的基本事情，但不是这个！

我想要更改标签的背景颜色，代码如下。无论我做什么，当我在 iPhone 模拟器上运行它时它都不会改变。那里有一些设置，我觉得我在问一个非常愚蠢的问题，但真的找不到答案。这是开发环境设置的问题吗？

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    NSLog(@"setting label to black color");
    self.colourLabel.backgroundColor = [UIColor blackColor];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:28:28.510

请记住，在 Objective-C 中向`nil`对象发送消息是可以的，所以问题可能`self.coulourLabel`还在`nil`那个时候。

你如何以及在哪里实例化它？你设置了`IBOutlet`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:36:14.287

为什么不制作一个 UILabel 类型的 IBOutlet，将其连接到界面构建器中的标签并执行以下操作：

> yourLabel.backgroundColor = [UIColor 不管颜色];

你设置`colorLabel`为属性了吗？因为您不需要...除非您有两个要相互通信的单独类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T10:24:23.657

只是想我会在问题的评论中留下一个强调@Dima 建议的答案 - 即，项目 > 清洁，然后是 iOS 模拟器 > 重置内容和设置。

我刚刚解决了在代码中创建的 UIButton 发生的类似问题，因此不可能是 IBOutlet 问题。当我在模拟器中运行时，我对代码所做的更改（甚至完全删除了属性）没有显示出来，即使在我的设备上它运行良好。我原以为清洁就足够了，但直到我做了重置内容和设置，它才开始像我预期的那样运行。

希望有人觉得这很有用...

# android - 我可以在 Android 中使用静态 TextToSpeech 吗？

> ID：11364123
> 
> 赞同：5
> 
> 时间：2012-07-06T14:25:41.413
> 
> 标签：android, text-to-speech

TextToSpeech 构造函数看起来像是被设计为由活动“拥有”的。我正在制作一个包含多个不同活动的应用程序，我不想为每个活动初始化一个新的 TextToSpeech 实例——我希望即使活动发生变化，语音也能顺利进行。

我的想法是让所有活动都访问一个静态 TextToSpeech 对象，由第一个活动初始化。

1.  有谁知道 TextToSpeech 实现是否是线程安全的？我猜不是，但可能有人知道。
2.  如果我使用默认 Activity 的上下文对其进行初始化，那么 TextToSpeech 实例会在 Activity 被销毁时停止工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T14:59:36.617

我从未尝试过，但我认为您可以将应用程序上下文作为构造函数中的参数传递，而不一定是 Activity。

但是注意[文档](http://developer.android.com/reference/android/speech/tts/TextToSpeech.html#speak%28java.lang.String,%20int,%20java.util.HashMap%3Cjava.lang.String,%20java.lang.String%3E%29)，我看到TTS引擎有自己的排队系统，所以你可以多次调用speak而不用担心线程计时。

关于你的问题，我不确定第二个，但正如我首先写的那样，我会尝试传递一个应用程序上下文，而不是活动上下文。

关于第一，嗯，我猜每个引擎一次只有一个实例。而且您通常只有一个引擎，但同样，如果引擎控制查询排队，请不要担心线程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T21:21:06.157

感谢那些告诉我传递 ApplicationContext 的人。原来这很容易……难的是 TextToSpeech 对象是否保证线程安全。

感谢您的回答告诉我*如何*使某些东西成为线程安全的/假设它是，但问题是关于对象是否已经是。我可能应该说，我可以实现线程安全，但我想知道我是否需要打扰。而且我不想在不确定的情况下假设线程安全。

我跑了以下，它似乎工作。因此，我假设 Android SDK TTS 是线程安全的，但找不到任何文档说明在所有设备上假设它是安全的，所以我将暂时包装我的 TTS 实例！

```
package com.example.testproject;

import java.util.Random;

import android.os.Bundle;
import android.app.Activity;
import android.speech.tts.TextToSpeech;
import android.speech.tts.TextToSpeech.OnInitListener;

public class TestActivity extends Activity implements OnInitListener {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        tts = new TextToSpeech(getApplicationContext(), this);
    }

    TextToSpeech tts = null;

    @Override
    public void onInit(int arg0) {
        for (int i = 0; i < 100; ++i) {
            class Irritate implements Runnable {
                Irritate(int iIn) {
                    i = iIn;
                }

                @Override
                public void run() {
                    Random r = new Random();
                    try {
                        Thread.sleep(r.nextInt(2000));
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }

                    tts.speak(Integer.toString(i), TextToSpeech.QUEUE_ADD, null);
                }

                int i;
            }

            Thread t = new Thread(new Irritate(i));

            t.start();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T14:31:05.897

我一直使用 TTS 作为我开始ForResult 的 Activity。我只是向它发射一个意图，然后等待它回来。如果我没记错的话，如果返回一个按置信度排序的答案数组。所以你如果你没有上下文，那么我不相信有另一种方式来调用它（至少使用这个模型）。不确定是否有可以获取的对象引用。

但是，如果有，请使用您的想法。然后您可以扩展 Application 并在其中保存对您的 TTS 的静态引用。这样，您的所有活动都可以看到它。我认为这是您正在寻找的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-22T19:56:55.773

以上内容有助于我解决此问题。就我而言，我也有一个片段，所以我做了以下事情：

从一个片段（从一个片段，你想说“getActivity().getApplicationContext()”而不仅仅是“getApplicationContext()”）：

```
public void onActivityResult(int requestCode, int resultCode, Intent data){
    if(requestCode == MY_DATA_CHECK_CODE){
        if (resultCode == TextToSpeech.Engine.CHECK_VOICE_DATA_PASS) {
            tts = new TextToSpeech(getActivity().getApplicationContext(), new TextToSpeech.OnInitListener() {
                @Override
                public void onInit(int status) {
                    if(status == TextToSpeech.SUCCESS){
                        result = tts.setLanguage(Locale.UK);
                    }
                }
            });
        } else {
            // missing data, install it
            Intent installIntent = new Intent();
            // The ACTION_INSTALL_TTS_DATA intent will take the user to Android Market, and will let the user initiate the download
            installIntent.setAction(TextToSpeech.Engine.ACTION_INSTALL_TTS_DATA);
            startActivity(installIntent);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-16T11:04:38.837

对于 GUI，TextToSpeech 不是线程安全的，因为从非 GUI 线程调用 TextToSpeech 侦听器方法。

如果您的侦听器方法与 GUI 交互，则必须包含代码以将 GUI 更改放入 GUI 线程的 Looper。

有很多关于如何将 GUI 命令包装在 Handler 中并将其发布到 GUI 线程的 looper 的示例。这是你要做什么的草图：

```
public class SpeechUtteranceListener extends UtteranceProgressListener {

    @Override
    public void onDone(String utteranceId) {
        Runnable guiCommand = new Runnable() {
            @Override
            public void run() {
                someButton.setEnabled(true);
                }
            }
        };
        runOnUiThread(asrStartCommand);
    }

    private void runOnUiThread(Runnable command){
        Looper.getMainLooper().post(command);
    }
} 
```

# java - Java EE RESTful Web Services Security w/HMAC 如何拦截请求？

> ID：11364124
> 
> 赞同：1
> 
> 时间：2012-07-06T14:25:42.723
> 
> 标签：java, web-services, rest, jakarta-ee, interceptor

我正在开发一个部署一些 RESTful Web 服务的应用程序，我想使用 HMACSHA512 签名方法，但不想在每个已发布的 Web 服务中实现它。

所以我正在寻找一种在请求到达 REST WS 之前拦截请求的方法，并有一个自定义类，该类基于 HttpHeaders/UriInfo/etc 和 HMAC 摘要等，将决定它是否有效并转发到 REST WS 或拒绝它。

我看到了一些关于 ResourceFactoryFilter 的东西，向 web.xml 添加过滤器等，但我迷路了..

任何有这方面知识的人都可以给我一些关于如何实现它的提示？特别是实现这一目标的最佳方式以及各部分如何交互。

我如何想象我想做的事情：客户端 <-> 拦截器 -> REST WS -> ...</p>

感谢您的时间。

PS：我想在没有像 Spring 这样的第三方框架的情况下实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T16:19:05.147

最简单的方法是编写一个 ServletFilter 类，您在 web.xml 中为您要检查的特定 URL 前缀配置该类。

该类将有一个`doFilter`方法，并在该方法中进行验证。如果成功，则通过调用继续处理`chain.doFilter()`；否则抛出异常。

# java - 单个 Apache 服务器可以同时处理 Tomcat 和 PHP 吗？

> ID：11364136
> 
> 赞同：9
> 
> 时间：2012-07-06T14:26:30.270
> 
> 标签：java, php, apache

我有一个要求，即在同一个 Apache 上运行具有 Java 应用程序和 PHP 应用程序的单个服务器。这可能吗？

这个问题可能很傻，但我对 Java 要求或安装过程一无所知。

我可以做这样的事情，让 java 应用程序在一个端口上运行，而 PHP 应用程序在另一个端口上运行，两者都在同一个 Apache 上？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-06T14:38:20.400

是的，你可以这么做。本质上，您必须在一个端口上运行 Apache (+ PHP) 服务器，而在另一个端口上运行 Tomcat 服务器。

*   您可以向外界公开第二个端口，并让您的 URL 使用`80`Apache / PHP 或（例如）`8080`Java 服务器的端口。这很简单，但您可能会发现上游防火墙会阻止远程 Web 浏览器连接到`80`.

*   您可以将 Apache 服务器配置为 Java 服务器的反向代理。因此，例如，Apache 服务器可能会识别出这`http://site.com/javaapp/foo.html`是针对 Java 服务器的，并将对该 URL 的请求中继到`http://localhost:8080/javaapp/foo.html`.

Apache 文档有一整章是关于使用 mod_proxy 配置正向和反向代理的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T14:34:48.307

是的。

Apache HTTPd 可以使用 ModProxy 或 ModAJP 委托给 Apache Tomcat，并且可以根据请求的域、路径或文件扩展名进行配置。您的 PHP 的 Apache HTTPd 配置将保持不变。

您需要将 Apache Tomcat 配置为*不在*端口 80 上侦听，然后配置您选择的 Apache HTTPd 代理解决方案以在不同的端口上与 Tomcat 通信。

这是更多信息的起点：[Apache + Tomcat：使用 mod_proxy 而不是 AJP](https://stackoverflow.com/questions/956361/apache-tomcat-using-mod-proxy-instead-of-ajp)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-06T14:35:52.127

> 一个单一的 apache 服务器可以同时处理 tomcat 和 php 吗？

是的，您需要同时安装 apache 和 tomcat，但是您可以配置 apache 以使用 AJP 协议将所有 JSP 请求重定向（对用户透明）到 tomcat。

在这里查看更多信息： [http ://www.datadisk.co.uk/html_docs/java_app/tomcat6/tomcat6_apache_server.htm](http://www.datadisk.co.uk/html_docs/java_app/tomcat6/tomcat6_apache_server.htm)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-06-14T21:49:07.193

这可以使用 Apache 反向代理，

我配置了一个 Apache 虚拟主机，它服务于一个 PHP 网站（Drupal）和一个 java（tomcat，用于业务逻辑），它们使用具有 2 个位置的反向代理存储在同一服务器中，这种配置的优点是它不会公开 Tomcat 在 URL 上使用的端口，出于安全原因，这对我来说是强制性的。

这就是我实现这一目标的方式：

```
<VirtualHost *:80>
ProxyPreserveHost       On
DocumentRoot            "/srv/www/htdocs/"
ErrorLog                /var/log/httpd/app_error_log.log
CustomLog               /var/log/httpd/app_log.log combined
ServerName              myapp.com

#Drupal PHP Content, stored at / as the main front end website.
<Location />
    ProxyPass http://localhost/
    ProxyPassReverse http://localhost
    Order allow,deny
    Allow from all
</Location>

#Tomcat/java content, secondary site used to process payments and business logic:
<Location /javaApp>
    ProxyPass http://localhost:8080/javaApp/
    ProxyPassReverse http://localhost:8080/javaApp/
    Order allow,deny
    Allow from all
</Location>

</VirtualHost> 
```

重启阿帕奇：

```
service httpd restart; 
```

测试您的反向代理：PHP/Drupal（在我的情况下，我使用的是 drupal，但可以是任何 PHP 代码）：

```
http://yourserverip/ or http://localhost/ 
```

爪哇：

```
http://yourserverip/javaApp or http://localhost/javaApp 
```

我希望有人能发现这很有用。我很难弄清楚这一点。:)

问候。

# jquery - 从单独的 php 文件加载表单时，将当前页面 URL 发送到弹出表单隐藏字段？

> ID：11364140
> 
> 赞同：0
> 
> 时间：2012-07-06T14:26:46.203
> 
> 标签：jquery

我在 WordPress 上使用 fancybox 从另一个模板文件加载表单。我需要的页面 URL 看起来像`http://domain.com/blog/#panier`

我的模板文件代码是

```
<?php require('../../../wp-blog-header.php');?>
<style>
#header, #footer{
    display:none;
}
</style>
<?php get_header(); ?>
<script>
    jQuery(document).ready(function ($) {
        jQuery('#header, #footer').css("display","none");
        });
</script>
<?php echo do_shortcode('[contact-form-7 id="330" title="Enquire Form"]'); ?>
<?php get_footer(); ?> 
```

我正在使用联系表格 7 并在模板文件中加载短代码。

我正在使用的另一个插件获取页面的当前 URL 并将其设置为隐藏字段，但是因为表单是从模板文件加载的，并且没有直接放置在页面上，所以隐藏字段的值是错误的

```
<div class="hidden" style="display:none;">
<input type="hidden" name="hidden-742" value="http://domain.com/blog/?p=29" class="wpcf7-hidden">
</div> 
```

单击链接打开表单时，如何获取页面的当前 URL。然后将该 URL 传递给表单隐藏字段并将其设置为值？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:07:38.533

抱歉耽搁了。

我们可以通过fancybox的函数访问完成fancybox加载的回调，`onComplete`此时我们就可以`window.location.href`把它放到输入字段中了。

[这是工作的jsFiddle](http://jsfiddle.net/WW9DA/)

**这是独立的 jQuery** ->

```
$('a').fancybox({
  'onComplete': function(){
     $('#popup input[name="name"]').val(window.location.href);
  }
}); 
```

# sql-server - 用户在 SQL Azure 数据库中查询已用大小需要哪些权限？

> ID：11364141
> 
> 赞同：2
> 
> 时间：2012-07-06T14:26:51.087
> 
> 标签：sql-server, azure, azure-sql-database

我正在尝试使用[此答案](https://stackoverflow.com/a/11329891/57428)中的代码查询 SQL Azure 数据库的消耗大小：

```
SELECT SUM(reserved_page_count)*8.0/1024 FROM sys.dm_db_partition_stats; 
```

该查询在数据库管理员下运行得很好，但不是在另一个用户下 - 我明白了

> 用户无权执行此操作。

当我尝试获得`GRANT` `SELECT`许可时，我收到此错误消息：

> 仅当当前数据库为主数据库时，才能授予对服务器范围目录视图或系统存储过程或扩展存储过程的权限。

如果我登录`master`并尝试到`GRANT`那里，我会收到以下消息：

> 在此版本的 SQL Server 中，无法更改系统存储过程、服务器范围目录视图和扩展存储过程的权限。

所以看起来除了数据库管理员之外的用户无法获得已用空间。

如何在数据库管理员以外的用户下查询 SQL Azure 数据库中的已用空间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T16:58:13.360

我似乎记得我们必须授予登录“查看数据库状态”和“查看定义”才能运行该查询。

# windows - 将 Windows 批处理文件变量设置为星期几

> ID：11364147
> 
> 赞同：21
> 
> 时间：2012-07-06T14:26:57.807
> 
> 标签：windows, scripting, batch-file

我有一个每天运行的 Windows 批处理文件。希望将数据记录到文件中并希望对其进行轮换（即最多具有最近 7 天的数据）。

查看命令`DATE`-`DELIMS`无法找出解决方案。

是否有一个简单的解决方案来创建一个包含星期几的文件名，即 0 表示星期一等。

还是我必须求助于一些更好的 shell 脚本。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-06T18:19:02.830

`%DATE%`不是你的朋友。因为`%DATE%`环境变量（和命令）使用完全且无限可定制的 Windows*短日期格式*`DATE`返回当前日期。一位用户可能会将系统配置为返回 07/06/2012，而另一位用户可能会选择 Fri060712。对于 BAT 程序员来说，使用是一场彻头彻尾的噩梦。*`%DATE%`*

 *有两种可能的方法来解决这个问题：

1.  您可能想通过将注册表值中的区域设置更改`HKCU\Control Panel\International\sShortDate`为您可识别的格式来临时更改短日期格式。然后访问`%DATE%`以您想要的格式获取日期；最后将格式恢复为原始用户格式。像这样的东西

    ```
    reg copy "HKCU\Control Panel\International" "HKCU\Control Panel\International-Temp" /f >nul
    reg add "HKCU\Control Panel\International" /v sShortDate /d "ddd" /f >nul
    set DOW=%DATE%
    reg copy "HKCU\Control Panel\International-Temp" "HKCU\Control Panel\International" /f >nul 
    ```

    但是这种方法有两个问题：

    *   它会篡改其本地特定目的的全局注册表值，因此它可能会干扰同时以短日期格式查询日期的其他进程或用户任务，如果同时运行，则包括其自身。

    *   它以本地语言返回一周中的三个字母天，在不同的系统或不同的用户中可能会有所不同。

2.  使用**WMIC Win32_LocalTime**，它以方便的方式返回日期，以便使用`FOR`命令直接解析它。

    ```
    FOR /F "skip=1" %%A IN ('WMIC Path Win32_LocalTime Get DayOfWeek' ) DO (
      set DOW=%%A
    ) 
    ```

    这是我推荐的方法。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-12-04T22:56:17.480

还有几种方法：

1\. **Robocopy**在 XP 中不可用，但可以使用 win 2003 资源工具包下载表格。也可能取决于本地化：

```
@echo off
setlocal 
for /f "skip=8 tokens=2,3,4,5,6,7,8 delims=: " %%D in ('robocopy /l * \ \ /ns /nc /ndl /nfl /np /njh /XF * /XD *') do (
 set "dow=%%D"
 set "month=%%E"
 set "day=%%F"
 set "HH=%%G"
 set "MM=%%H"
 set "SS=%%I"
 set "year=%%J"
)

echo Day of the week: %dow%
endlocal 
```

2\. **MAKECAB** - 适用于每台 Windows 机器（但会创建一个小临时文件）。[carlos提供的功能：](http://www.dostips.com/forum/viewtopic.php?f=3&t=5035)

```
@Echo Off

Call :GetDate.Init
Rem :GetDate.Init should be called one time in the code before call to :Getdate
Call :GetDate
Echo weekday:%weekday%

Goto :EOF

:GetDate.Init
Set /A "jan=1,feb=2,mar=3,apr=4,may=5,jun=6,jul=7,aug=8,sep=9,oct=10,nov=11,dec=12"
Set /A "mon=1,tue=2,wed=3,thu=4,fri=5,sat=6,sun=7"
(
Echo .Set InfHeader=""
Echo .Set InfSectionOrder=""
Echo .Set InfFooter="%%2"
Echo .Set InfFooter1=""
Echo .Set InfFooter2=""
Echo .Set InfFooter3=""
Echo .Set InfFooter4=""
Echo .Set Cabinet="OFF"
Echo .Set Compress="OFF"
Echo .Set DoNotCopyFiles="ON"
Echo .Set RptFileName="NUL"
) >"%Temp%\~foo.ddf"
Goto :Eof

:GetDate
Set "tf=%Temp%\~%random%"
Makecab /D InfFileName="%tf%" /F "%Temp%\~foo.ddf" >NUL
For /F "usebackq tokens=1-7 delims=: " %%a In ("%tf%") Do (
Set /A "year=%%g,month=%%b,day=1%%c-100,weekday=%%a"
Set /A "hour=1%%d-100,minute=1%%e-100,second=1%%f-100")
Del "%tf%" >NUL 2>&1
Goto :Eof 
```

3\. **W32TM** - 使用 Vista 中引入的命令开关，因此不适用于 windows 2003/XP：

```
@echo off
setlocal
call :w32dow day_ow
echo %day_ow%
pause
exit /b 0
endlocal
:w32dow [RrnVar]
setlocal

rem :: prints the day of the week
rem :: works on Vista and above

rem :: getting ansi date ( days passed from 1st jan 1601 ) , timer server hour and current hour
FOR /F "tokens=4,5 delims=:( " %%D in ('w32tm /stripchart /computer:localhost  /samples:1  /period:1 /dataonly /packetinfo^|find "Transmit Timestamp:" ') do (
 set "ANSI_DATE=%%D"
 set  "TIMESERVER_HOURS=%%E"
)

set  "LOCAL_HOURS=%TIME:~0,2%"
if "%TIMESERVER_HOURS:~0,1%0" EQU "00" set TIMESERVER_HOURS=%TIMESERVER_HOURS:~1,1%
if "%LOCAL_HOURS:~0,1%0" EQU "00" set LOCAL_HOURS=%LOCAL_HOURS:~1,1%
set /a OFFSET=TIMESERVER_HOURS-LOCAL_HOURS

rem :: day of the week will be the modulus of 7 of local ansi date +1
rem :: we need need +1 because Monday will be calculated as 0
rem ::  1st jan 1601 was Monday

rem :: if abs(offset)>12 we are in different days with the time server

IF %OFFSET%0 GTR 120 set /a DOW=(ANSI_DATE+1)%%7+1
IF %OFFSET%0 LSS -120 set /a DOW=(ANSI_DATE-1)%%7+1
IF %OFFSET%0 LEQ 120 IF %OFFSET%0 GEQ -120 set /a DOW=ANSI_DATE%%7+1

rem echo Day of the week: %DOW% 
endlocal & if "%~1" neq "" (set "%~1=%DOW%") else echo %DOW% 
```

4\. **.bat/jscript 混合**（必须另存为.bat）：

```
 @if (@x)==(@y) @end /***** jscript comment ******
 @echo off
 for /f  %%d in ('cscript //E:JScript //nologo "%~f0"') do echo %%d
 exit /b 0
 *****  end comment *********/
 WScript.Echo((new Date).getDay()); 
```

5\. **.bat/vbscript 混合** [（必须另存为.bat）](https://stackoverflow.com/questions/9074476/is-it-possible-to-embed-and-execute-vbscript-within-a-batch-file-without-using-a)

```
 :sub echo(str) :end sub
echo off
'>nul 2>&1|| copy /Y %windir%\System32\doskey.exe '.exe >nul

'& echo/ 
'& for /f %%w in ('cscript /nologo /E:vbscript %~dpfn0') do echo day of the week %%w
'& echo/
'& del /q "'.exe" >nul 2>&1
'& exit /b

WScript.Echo Weekday(Date)
WScript.Quit 
```

6.powershell可以从microsoft下载。win7及以上版本默认可用**：**

```
@echo off
setlocal
for /f %%d in ('"powershell (Get-Date).DayOfWeek.Value__"') do set dow=%%d

echo day of the week : %dow%
endlocal 
```

7\. **WMIC**已经用作答案，但只想有一个完整的参考。[并清除`<CR>`：](http://www.dostips.com/forum/viewtopic.php?f=3&t=4266)

```
@echo off
setlocal
for /f "delims=" %%a in ('wmic path win32_localtime get dayofweek /format:list ') do for /f "delims=" %%d in ("%%a") do set %%d

echo day of the week : %dayofweek%
endlocal 
```

9.**自编译jscript.net**（必须另存为`.bat`）：

```
@if (@X)==(@Y) @end /****** silent line that start jscript comment ******

@echo off
::::::::::::::::::::::::::::::::::::
:::       compile the script    ::::
::::::::::::::::::::::::::::::::::::
setlocal
if exist "%~n0.exe" goto :skip_compilation

set "frm=%SystemRoot%\Microsoft.NET\Framework\"
:: searching the latest installed .net framework
for /f "tokens=* delims=" %%v in ('dir /b /s /a:d /o:-n "%SystemRoot%\Microsoft.NET\Framework\v*"') do (
    if exist "%%v\jsc.exe" (
        rem :: the javascript.net compiler
        set "jsc=%%~dpsnfxv\jsc.exe"
        goto :break_loop
    )
)
echo jsc.exe not found && exit /b 0
:break_loop

call %jsc% /nologo /out:"%~n0.exe" "%~dpsfnx0"
::::::::::::::::::::::::::::::::::::
:::       end of compilation    ::::
::::::::::::::::::::::::::::::::::::
:skip_compilation

"%~n0.exe"

exit /b 0

****** end of jscript comment ******/
import System;
import System.IO;

var dt=DateTime.Now;
 Console.WriteLine(dt.DayOfWeek); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-07T01:34:29.347

```
@ECHO OFF
REM GET DAY OF WEEK VIA DATE TO JULIAN DAY NUMBER CONVERSION
REM ANTONIO PEREZ AYALA
REM GET MONTH, DAY, YEAR VALUES AND ELIMINATE LEFT ZEROS
FOR /F "TOKENS=1-3 DELIMS=/" %%A IN ("%DATE%") DO SET /A MM=10%%A %% 100, DD=10%%B %% 100, YY=%%C
REM CALCULATE JULIAN DAY NUMBER, THEN DAY OF WEEK
IF %MM% LSS 3 SET /A MM+=12, YY-=1
SET /A A=YY/100, B=A/4, C=2-A+B, E=36525*(YY+4716)/100, F=306*(MM+1)/10, JDN=C+DD+E+F-1524
SET /A DOW=(JDN+1)%%7 
```

DOW 为 0 表示周日，1 表示周一，以此类推。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-15T16:21:45.107

我认为我的第一个答案给出了正确的星期几作为 0 到 6 之间的数字。但是，由于您*没有*说明为什么这个答案没有给出您想要的结果，我只能猜测原因。

下面的批处理文件每天创建一个日志文件，名称中有一个数字，0=星期日，1=星期一等...程序假设`echo %date%`以 MM/DD/YYYY 格式显示日期；如果不是这种情况，只需更改`for`命令中 mm 和 dd 变量的位置。

```
@echo off
for /F "tokens=1-3 delims=/" %%a in ("%date%") do set /A mm=10%%a %% 100, dd=10%%b %% 100, yy=%%c
if %mm% lss 3 set /A mm+=12, yy-=1
set /A a=yy/100, b=a/4, c=2-a+b, e=36525*(yy+4716)/100, f=306*(mm+1)/10, dow=(c+dd+e+f-1523)%%7
echo Today log data > Day-%dow%.txt 
```

如果这不是您想要的，请指出问题，以便我解决。

**编辑**：以下版本获取独立于语言环境设置的日期部分：

```
@echo off
for /F "skip=1 tokens=2-4 delims=(-/)" %%A in ('date ^< NUL') do (
   for /F "tokens=1-3 delims=/" %%a in ("%date%") do (
      set %%A=%%a
      set %%B=%%b
      set %%C=%%c
   )
)
set /A mm=10%mm% %% 100, dd=10%dd% %% 100
if %mm% lss 3 set /A mm+=12, yy-=1
set /A a=yy/100, b=a/4, c=2-a+b, e=36525*(yy+4716)/100, f=306*(mm+1)/10, 

dow=(c+dd+e+f-1523)%%7
echo Today log data > Day-%dow%.txt 
```

**编辑**：下面的版本将星期几插入为 3 个字母的短名称：

```
@echo off
for /F "skip=1 tokens=2-4 delims=(-/)" %%A in ('date ^< NUL') do (
   for /F "tokens=1-3 delims=/" %%a in ("%date%") do (
      set %%A=%%a
      set %%B=%%b
      set %%C=%%c
   )
)
set /A mm=10%mm% %% 100, dd=10%dd% %% 100
if %mm% lss 3 set /A mm+=12, yy-=1
set /A a=yy/100, b=a/4, c=2-a+b, e=36525*(yy+4716)/100, f=306*(mm+1)/10, 

dow=(c+dd+e+f-1523)%%7 + 1
for /F "tokens=%dow%" %%a in ("Sun Mon Tue Wed Thu Fri Sat") do set dow=%%a
echo Today log data > Day-%dow%.txt 
```

问候，

安东尼奥

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-20T21:42:23.690

结果比我最初怀疑的要复杂得多，我想这就是让我感兴趣的地方，我搜索了每一个地方，并且给出的所有方法在 Windows 7 上都不起作用。

所以我有一个使用 Visual Basic 脚本的替代解决方案。

批处理创建并执行脚本（DayOfWeek.vbs），将脚本输出（星期一、星期二等）分配给一个变量（dow），然后检查该变量并为另一个变量（dpwnum）分配天数，然后是 VBS已删除希望对您有帮助：

```
@echo off

REM Create VBS that will get day of week in same directory as batch
echo wscript.echo WeekdayName(Weekday(Date))>>DayOfWeek.vbs

REM Cycle through output to get day of week i.e monday,tuesday etc
for /f "delims=" %%a in ('cscript /nologo DayOfWeek.vbs') do @set dow=%%a

REM delete vbs
del DayOfWeek.vbs

REM Used for testing outputs days name
echo %dow%

REM Case of the days name is important must have a capital letter at start
REM Check days name and assign value depending
IF %dow%==Monday set downum=0
IF %dow%==Tuesday set downum=1
IF %dow%==Wednesday set downum=2
IF %dow%==Thursday set downum=3
IF %dow%==Friday set downum=4
IF %dow%==Saturday set downum=5
IF %dow%==Sunday set downum=6

REM print the days number 0-mon,1-tue ... 6-sun
echo %downum%

REM set a file name using day of week number
set myfile=%downum%.bak

echo %myfile%

pause
exit 
```

编辑：

虽然我转向 VBS，但它可以纯批处理完成，我花了一段时间才让它工作并进行了大量搜索，但这似乎有效：

```
 @echo off
SETLOCAL enabledelayedexpansion
SET /a count=0
FOR /F "skip=1" %%D IN ('wmic path win32_localtime get dayofweek') DO (
    if "!count!" GTR "0" GOTO next
    set dow=%%D
    SET /a count+=1
)
:next
echo %dow%
pause 
```

对上述批次的唯一警告是，它的星期几是 1-7 而不是 0-6

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-03-06T04:36:56.653

这对我有用

```
FOR /F "tokens=3" %%a in ('robocopy ^|find "Started"') DO SET TODAY=%%a 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-02-06T18:32:14.763

我在美国。我可以在 Windows 7、Windows 2008 R2、Windows Server 2003、Windows XP 中运行此代码（所有操作系统都是最新的 Windows 更新和补丁）。所有都具有短日期设置，没有 ddd（或 dddd）（星期几）。

```
@echo off
for /f %%a in ('date /t') do set DAY=%%a
echo.
echo The Day Is: %DAY%
echo. 
```

如果今天是星期四，它将输出“The Day Is: Thu”。

这将返回我测试过的所有 4 个 Windows 版本的日期。而且只有一天。当我将我的短日期设置更改为“ddd，M/d/yyyy”时，我的输出会用逗号（例如，星期四）显示日期，这告诉我这段代码确实使用短日期格式。但也可能发生的是，如果短日期不包含星期几，它可能会查看我测试的所有 4 台机器上的长日期格式，格式中都有 dddd。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-05-13T16:36:55.450

这不是我的工作（好吧，我从示例中稍微修改了它），而且游戏已经很晚了，但这对我来说适用于 Server 2003；

```
@echo off  
set daysofweek=Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday  
for /F "skip=2 tokens=2-4 delims=," %%A in ('WMIC Path Win32_LocalTime Get DayOfWeek /Format:csv') do set daynumber=%%A  
for /F "tokens=%daynumber% delims=," %%B in ("%daysofweek%") do set day=%%B 
```

引用：[技术支持论坛](http://www.techsupportforum.com/forums/f128/solved-windows-7-batch-getting-day-of-week-moved-from-vista-7-a-565632.html#post3217395)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-03-08T21:49:03.903

首先 - 复制 CON SETUPDAY.001 SET WORKDAY=​​^Z （非常重要 - 没有 cr/lf）

```
DATE /T >SETUPDAY.002
COPY SETUPDAY.001+SETUPDAY.002 NEWDAY.BAT >nul
CALL NEWDAY.BAT

SET WEEKDAY=%WORKDAY:~0,3%
SET MDY=%WORKDAY:~4,10% 
```

在脚本中使用 %WEEKDAY%

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-07-06T14:38:42.813

**依赖于区域设置的版本：** 在某些环境中，以下将从日期中提取日期名称：

```
set dayname=%date:~0,3% 
```

它假定日期名称是`%date%`. 但是，根据机器设置，子字符串部分 ( `~0,3`) 需要更改。

像这样的语句将转储到具有三个字符的日期名称的文件中：

```
set logfile=%date:~0,3%.log
echo some stuff > %logfile% 
```

**独立于语言环境的版本：**如果您需要较少依赖当前机器的日期格式，另一种方法是编写一个打印星期几的小型应用程序。然后使用批处理文件中该程序的输出。例如，下面的 C 应用程序打印`dayN`其中 N=0..6。

```
#include <stdio.h>
#include <time.h>

int main( int argc, char* argv[] )
{
   time_t curtime;
   struct tm * tmval;

   time( &curtime );
   tmval = localtime( &curtime );
   // print dayN.  Or use a switch statement and print
   // the actual day name if you want
   printf( "day%d", tmval->tm_wday );
} 
```

如果上面的内容被编译并链接为`myday.exe`，那么您可以从批处理文件中使用它，如下所示：

```
for /f %%d in ('myday.exe') do set logfile=%%d.log
echo some stuff > %logfile% 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-07-04T15:54:01.790

我有这个解决方案适合我：

在 cmd 文件所在的同一目录中创建一个名为 dayOfWeek.vbs 的文件。

**dayOfWeek.vbs**包含一行：

```
wscript.stdout.write weekdayname(weekday(date)) 
```

或者，如果您想要天数而不是名称：

```
wscript.stdout.write weekday(date) 
```

cmd 文件将包含以下行：

```
For /F %%A In ('CScript dayOfWeek.vbs //NoLogo') Do Set dayName=%%A 
```

现在您可以使用变量**dayName**，例如：

```
robocopy c:\inetpub \\DCStorage1\Share1\WebServer\InetPub_%dayName% /S /XD history logs 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-10-24T02:47:12.483

关于这个话题的另一个旋转。下面的脚本显示当前周围的几天，带有星期几前缀。

核心是独立的 :dpack 例程，它将日期编码为一个值，其模 7 显示符合 ISO 8601 标准的星期几（Mon == 0）。还提供了 :dunpk ，它是反函数：

```
@echo off& setlocal enabledelayedexpansion
rem 10/23/2018 daydate.bat: Most recent version at paulhoule.com/daydate
rem Example of date manipulation within a .BAT file.
rem This is accomplished by first packing the date into a single number.
rem This demo .bat displays dates surrounding the current date, prefixed
rem with the day-of-week.

set days=0Mon1Tue2Wed3Thu4Fri5Sat6Sun
call :dgetl y m d
call :dpack p %y% %m% %d%
for /l %%o in (-3,1,3) do (
  set /a od=p+%%o
  call :dunpk y m d !od!
  set /a dow=od%%7
  for %%d in (!dow!) do set day=!days:*%%d=!& set day=!day:~,3!
  echo !day! !y! !m! !d!
)
exit /b

rem gets local date returning year month day as separate variables
rem in: %1 %2 %3=var names for returned year month day
:dgetl
setlocal& set "z="
for /f "skip=1" %%a in ('wmic os get localdatetime') do set z=!z!%%a
set /a y=%z:~0,4%, m=1%z:~4,2% %%100, d=1%z:~6,2% %%100
endlocal& set /a %1=%y%, %2=%m%, %3=%d%& exit /b

rem packs date (y,m,d) into count of days since 1/1/1 (0..n)
rem in: %1=return var name, %2= y (1..n), %3=m (1..12), %4=d (1..31)
rem out: set %1= days since 1/1/1 (modulo 7 is weekday, Mon= 0)
:dpack
setlocal enabledelayedexpansion
set mtb=xxx  0 31 59 90120151181212243273304334& set /a r=%3*3
set /a t=%2-(12-%3)/10, r=365*(%2-1)+%4+!mtb:~%r%,3!+t/4-(t/100-t/400)-1
endlocal& set %1=%r%& exit /b

rem inverse of date packer
rem in: %1 %2 %3=var names for returned year month day
rem %4= packed date (large decimal number, eg 736989)
:dunpk
setlocal& set /a y=%4+366, y+=y/146097*3+(y%%146097-60)/36524
set /a y+=y/1461*3+(y%%1461-60)/365, d=y%%366+1, y/=366
set e=31 60 91 121 152 182 213 244 274 305 335
set m=1& for %%x in (%e%) do if %d% gtr %%x set /a m+=1, d=%d%-%%x
endlocal& set /a %1=%y%, %2=%m%, %3=%d%& exit /b 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-12-01T21:09:39.850

```
Rem Remove the end comma and add /A to set for this line worked for me.
set /A a=yy/100, b=a/4, c=2-a+b, e=36525*(yy+4716)/100, f=306*(mm+1)/10 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-12-01T05:08:36.640

如果您可以将PC中的短日期格式更改为“ddd yyyy-MM-dd”（只有第一个参数“ddd”是强制性的），那么以下命令返回-

```
c:\>vol | date
The current date is: Mon 2014-12-01 
```

然后你可以写你的批处理文件 -

```
@echo off

vol | date | find /i "sun" > nul 
if not errorlevel 1 goto SUN

vol | date | find /i "mon" > nul 
if not errorlevel 1 goto MON

      # write block for other week days    

goto END

:SUN
set fname="sun"
goto BACKUP

:MON
set fname="mon"
goto BACKUP

      # write block for other week days

:BACKUP
echo %fname%

:END 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-01-18T22:52:16.680

正在寻找自己这样做，并看到有关空白行的投诉：

```
rem Make the win32_localtime output all one line, though some versions may contain blank lines as well.
rem So ignore blank lines and just pick up the number after the equal sign.
for /f "delims== tokens=2" %%a in ('wmic path win32_localtime get dayofweek /format:list') do (
    rem Increment the DOW as it is documented to be a zero-based index starting with Sunday.
    set /a DayOfWeekIndex=%%a+1
)
rem Also get name day of week. The DOW coming in is now a one-based index.
rem This is used to reference the "array" of week day names.
set DayOfWeekNames=Sun Mon Tue Wed Thu Fri Sat
for /f "tokens=%DayOfWeekIndex%" %%b in ("%DayOfWeekNames%") do (
    set DayOfWeekName=%%b
) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-02-12T07:21:45.980

我改进了 Aacini[答案](https://stackoverflow.com/a/11493557/8604593) 以使其回显一周中的全天名称

所以这是我的代码

```
@echo off
for /F "skip=1 tokens=2-4 delims=(-/)" %%A in ('date ^< NUL') do (
   for /F "tokens=1-3 delims=/" %%a in ("%date%") do (
      set %%A=%%a
      set %%B=%%b
      set %%C=%%c
   )
)
set /A mm=10%mm% %% 100, dd=10%dd% %% 100
if %mm% lss 3 set /A mm+=12, yy-=1
set /A a=yy/100, b=a/4, c=4-a+b, e=36525*(yy+4716)/100, f=306*(mm+1)/10,dow=(c+dd+e+f-1523)%%7 + 1
for /F "tokens=%dow%" %%a in ("Sunday Monday Tuesday Wednesday Thursday Friday Saturday ") do set dow=%%a
echo Today is %dow%>"Today is %dow%.txt"
echo Today is %dow%
Pause>Nul

REM Sun Mon Tue Wed Thu Fri Sat
REM Sunday Monday Tuesday Wednesday Thursday Friday Saturday 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2016-05-09T22:10:05.997

使用 MSHTA 和 javascript 的版本。将 %jsfunc% 更改为您要调用的任何 jscript 函数

```
@echo off
::Invoke a javascript function using mhta

set jsfunc=new Date().getDay()
set dialog="about:<script>resizeTo(0,0);new ActiveXObject('Scripting.FileSystemObject').
set dialog=%dialog%GetStandardStream(1).WriteLine(%jsfunc%);close();</script>"

for /f "tokens=* delims=" %%p in ('mshta.exe %dialog%') do set ndow=%%p

::get dow string from array of strings  
for /f "tokens=%ndow%"  %%d in ("Mon Tue Wed Thu Fri Sat Sun") do set dow=%%d 

echo dow is : %ndow%  %dow%
pause 
```*

# oracle-adf - 当 setup.exe 和支持的文件保存在 ADF 中的服务器中时，如何在客户端安装？

> ID：11364150
> 
> 赞同：0
> 
> 时间：2012-07-06T14:27:09.883
> 
> 标签：oracle-adf

我在 Jdev 11.1.1.5.0 中使用 Oracle ADF 开发了一个应用程序。我在 weblogic 服务器中部署了应用程序并且工作正常。

我在服务器中保留了一个 setup.exe 文件和支持的文件。现在我希望在页面加载时在客户端机器上完成安装。使用servlet，我们怎样才能做到这一点？

安装（setup.exe 文件的执行）应该在客户端机器上自动完成。

我应该遵循哪些步骤来完成此操作？

任何建议将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T09:29:16.887

您不能自动执行此操作。如果不更改策略，沙盒将无法在客户端执行任何操作。如果没有客户端的用户，则无法完成此更改。您可以做的是要求用户下载文件，然后在下载后执行 setup.exe。

但是，如果不知道 exe 在我的电脑上做什么，我个人不会这样做。Web 应用程序通常不需要安装在客户端 PC 上。

蒂莫

# javascript - Node.js 自动“需要”哪些模块？

> ID：11364151
> 
> 赞同：11
> 
> 时间：2012-07-06T14:27:13.550
> 
> 标签：javascript, node.js

快速的问题，但令人惊讶的是，我通过谷歌搜索找不到答案......当我使用`node`交互式解释器时，我可以输入基本上所有核心模块的名称并将它们作为对象输出到控制台上。 ..但是，我知道在运行 .js 文件时，默认情况下并非所有核心模块都包含在内。

谁能帮我解决这个问题？所有帮助表示赞赏。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-06T15:51:45.960

从 Node 0.8 开始，`repl.js` [定义了一个内置库列表，](https://github.com/joyent/node/blob/f210530f46e8ddbd9e7cc0d0c37778888c27f526/lib/repl.js#L72-75)当您在 REPL 上键入它们的名称时将[自动需要这些库：](https://github.com/joyent/node/blob/f210530f46e8ddbd9e7cc0d0c37778888c27f526/lib/repl.js#L225-236)

```
exports._builtinLibs = ['assert', 'buffer', 'child_process', 'cluster',
  'crypto', 'dgram', 'dns', 'events', 'fs', 'http', 'https', 'net',
  'os', 'path', 'punycode', 'querystring', 'readline', 'repl',
  'string_decoder', 'tls', 'tty', 'url', 'util', 'vm', 'zlib'];

...

if (exports._builtinLibs.indexOf(cmd) !== -1) {
  var lib = require(cmd);
  if (cmd in self.context && lib !== self.context[cmd]) {
    self.outputStream.write('A different "' + cmd +
                            '" already exists globally\n');
  } else {
    self.context._ = self.context[cmd] = lib;
    self.outputStream.write(self.writer(lib) + '\n');
  }
  self.displayPrompt();
  return;
} 
```

这是一个*专门*的功能`repl.js`，在编写您自己的 Node.js 程序时根本不起作用；在那里，你必须明确`require`你想使用的任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T14:37:14.317

您需要要求所有要在节点中使用的模块。Node.js 中只包含 javascript 规范（ECMA 规范）中包含的函数。

要访问核心库，您需要它们。例如，如果您需要访问创建服务器功能，您需要执行以下操作：

```
var http = require('http');

http.createServer(function(req, res) {
   console.log(req);
}).listen(3000); 
```

您也可以在交互式控制台中执行此操作。那就是将模块分配给一个变量，然后开始使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-05T10:04:54.263

目前有一个 npm 包包含 repl.js 文件，并以更友好的方式为您提供列表。

[内置模块](https://www.npmjs.com/package/builtin-modules)

我想在具有不同节点版本（nvm）的场景中快速获取该列表可能会很有趣，这些版本具有不同的核心模块（实际上发生在不同版本的 AngularJS 中）。

# php - 如何查询多种类型的对象（使用键值表）并将结果组合在一起作为一个完整的对象

> ID：11364152
> 
> 赞同：0
> 
> 时间：2012-07-06T14:27:14.053
> 
> 标签：php, mysql, sql

我希望我正确地问了这个问题。我有一个按 object_id 分组的对象表。它们存储为键/值。我认为这很简单，但我无法在任何地方找到解决方案。我正在尝试使用最有效的方法来查询此表以返回基于多个 meta_name 值的完整对象。这是表结构：

![数据库结构](../Images/45d57bb7732cd9e0c74c970a4ab888f5.png)

这是我到目前为止的代码，它非常适合查询一个值：

```
SELECT data2.object_id,data2.object, data2.meta_name, data2.value_string, data2.value_text FROM meta_data AS data1
LEFT JOIN meta_data AS data2 ON(data1.object_id = data2.object_id)
data1.object="domain"
AND data1.meta_name = "category"
AND data1.value_string = "programmer" 
```

这给了我以下结果。这对于单一分类法（类别程序员中的域）非常有用。

![结果](../Images/0555da850106227d97fca5b8ce020de3.png)

当我想使用类别程序员查询所有域并且颜色为红色并且可能还有其他 meta_name = value_strings 时，问题就出现了。除了从 PHP 进行多个查询之外，我找不到任何解决方案（出于明显的性能原因，我想避免这种情况）。

我需要指出，对象将即时创建，并且没有特定的模式（这是具有此结构的起点），因此我无法硬编码并假设有关对象的任何内容（对象可能具有更多元属性在任何给定时间从管理面板定义给他们）。

再次，我希望我问的这个问题是对的，因为过去 3 天我通过在线搜索找到了解决方案完全不走运。

非常感谢您提前对可以帮助我的 MySQL 专业人士！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:45:02.270

在这种情况下，解决方案通常会查询所有记录以避免多次查询，然后将数据对象*拼接*在一起以提供所需的格式。然后您可以在这些对象上开发简单`find()`的方法来进一步过滤结果（例如使用数组函数）

如果您对确切的实现感兴趣，我鼓励您查看 WordPress - 您注意到分类法。作为一个开源项目，您可以[查看他们的代码](https://github.com/WordPress/WordPress/)以了解如何完成此操作的示例。看看[Taxonomies API](https://github.com/WordPress/WordPress/blob/master/wp-includes/taxonomy.php)和[Meta API](https://github.com/WordPress/WordPress/blob/master/wp-includes/meta.php)。

# jsf-2 - Tomcat 7 EL 将方法识别为属性

> ID：11364157
> 
> 赞同：1
> 
> 时间：2012-07-06T14:27:29.033
> 
> 标签：jsf-2, el, tomcat7

我正在尝试使用 JSF 2.1.10 在 Tomcat 7.0.28 上运行现有应用程序

我有以下豆：

```
@Named
@Dependent
public class FormatterBean
{
   public String replaceNewLineWithBrTag(String s)   
   {
      return Formatter.replaceNewLineWithBrTag(s);
   }

   public String leftJustifyWithZeros(String string, Integer zeroTotal)
    {
        return Formatter.leftJustifyWithZeros(string, zeroTotal);
    }
} 
```

当我做这样的事情

```
<p:tooltip for="visualizar" value="#{formatterBean.replaceNewLineWithBrTag(adiantamento.observacao)}" /> 
```

我收到以下错误：

> /page/rdv/adiantamento.xhtml @87,117 value="#{formatterBean.replaceNewLineWithBrTag(adiantamento.observacao)}"：在类型 br.com.spdata.util.FormatterBean 上找不到属性“replaceNewLineWithBrTag”

一些细节：

1.  相同的代码在 Glassfish 3.1.2 上运行良好
2.  leftJustifyWithZeros 方法工作正常

有什么想法吗？

谢谢，菲利普

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:34:21.473

要检查的一件事是您是否`web.xml`被声明为使用 Servlet 3.0 规范，例如：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0" 
    xmlns="http://java.sun.com/xml/ns/javaee" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
>
... 
```

# php - 上传和调整图像大小时的PNG黑色背景

> ID：11364160
> 
> 赞同：7
> 
> 时间：2012-07-06T14:27:42.360
> 
> 标签：php, html, image, upload

你能帮我写一下我在php中的代码吗？

我不知道如何使我的图片透明。上传后它们有黑色背景。我这里有代码。（以及一些小帖子和内容的文字）

谢谢你。

```
<?php
function zmensi_obrazok($image_max_width, $image_max_height, $obrazok, $obrazok_tmp, $obrazok_size, $filename){

$postvars          = array(
"image"            => $obrazok,
"image_tmp"        => $obrazok_tmp,
"image_size"       => $obrazok_size,
"image_max_width"  => $image_max_width,
"image_max_height" => $image_max_height
);

$valid_exts = array("jpg","jpeg","png");
$ext = end(explode(".",strtolower($obrazok)));
if($postvars["image_size"] <= 1024000){

if(in_array($ext,$valid_exts)){

if($ext == "jpg" || $ext == "jpeg"){
$image = imagecreatefromjpeg($postvars["image_tmp"]);
}
else if($ext == "png"){
$image = imagecreatefrompng($postvars["image_tmp"]);
}

list($width,$height) = getimagesize($postvars["image_tmp"]);

$old_width      = imagesx($image);
$old_height     = imagesy($image);
$scale          = min($postvars["image_max_width"]/$old_width, $postvars["image_max_height"]/$old_height);
$new_width      = ceil($scale*$old_width);
$new_height     = ceil($scale*$old_height);

$tmp = imagecreatetruecolor($new_width,$new_height);

imagecopyresampled($tmp,$image,0,0,0,0,$new_width,$new_height,$width,$height);

imagejpeg($tmp,$filename,100);
return "";
imagedestroy($image);
imagedestroy($tmp);

}

}

}

?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T14:33:42.647

我认为这个链接会回答你的问题： [http ://www.php.net/manual/pl/function.imagecopyresampled.php#104028](http://www.php.net/manual/pl/function.imagecopyresampled.php#104028)

在您的代码中，答案将类似于：

```
// preserve transparency
  if($ext == "gif" or $ext == "png"){
    imagecolortransparent($tmp, imagecolorallocatealpha($tmp, 0, 0, 0, 127));
    imagealphablending($tmp, false);
    imagesavealpha($tmp, true);
  } 
```

在执行之前粘贴这个`imagecopyresampled`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-06T23:25:33.347

如果您确实想保存为 JPEG 而不是保存为 PNG，则可以在进行复制之前将目标图像的背景颜色更改为白色：

```
$tmp = imagecreatetruecolor($new_width,$new_height);
imagefilledrectangle($tmp, 0, 0, $new_width, $new_height, imagecolorallocate($tmp, 255, 255, 255));
imagecopyresampled($tmp,$image,0,0,0,0,$new_width,$new_height,$width,$height); 
```

然后你会得到一个没有任何透明度的 JPEG，但背景颜色将是白色而不是黑色。

# mysql - Mysql join和sum是加倍的结果

> ID：11364162
> 
> 赞同：7
> 
> 时间：2012-07-06T14:27:50.757
> 
> 标签：mysql, sql, join, group-by, aggregate-functions

我有一张收入表

```
title_id     revenue    cost
   1            10        5
   2            10        5
   3            10        5
   4            10        5
   1            20        6                    
   2            20        6
   3            20        6
   4            20        6 
```

当我执行这个查询

```
SELECT SUM(revenue),SUM(cost)
FROM revenue
GROUP BY revenue.title_id 
```

它产生结果

```
title_id     revenue    cost
   1            30        11
   2            30        11
   3            30        11
   4            30        11 
```

没关系，现在我想将总和结果与另一个具有这样结构的表结合起来

```
title_id     interest    
   1            10        
   2            10        
   3            10        
   4            10        
   1            20                            
   2            20        
   3            20        
   4            20 
```

当我用这样的聚合函数执行连接时

```
SELECT SUM(revenue),SUM(cost),SUM(interest)
FROM revenue
LEFT JOIN fund ON revenue.title_id = fund.title_id
GROUP BY revenue.title_id,fund.title_id 
```

它使结果翻倍

```
title_id     revenue    cost    interest
   1            60        22       60
   2            60        22       60
   3            60        22       60
   4            60        22       60 
```

我不明白为什么它会加倍，请帮助

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-06T14:34:31.323

它翻倍是因为您在基金和收入表中重复了标题。这会使匹配的记录数成倍增加。如果您删除聚合函数并查看原始数据，这很容易看出。[看这里](http://sqlfiddle.com/#!2/1e6aa/10)

解决这个问题的方法是创建聚合的内联视图并加入这些结果。

```
SELECT R.title_id, 
       R.revenue, 
       R.cost, 
       F.interest 
FROM   (SELECT title_id, 
               Sum(revenue) revenue, 
               Sum(cost)    cost 
        FROM   revenue 
        GROUP  BY revenue.title_id) r 
       LEFT JOIN (SELECT title_id, 
                         Sum(interest) interest 
                  FROM   fund 
                  GROUP  BY title_id) f 
              ON r.title_id = F.title_id 
```

输出

```
| TITLE_ID | REVENUE | COST | INTEREST |
----------------------------------------
|        1 |      30 |   11 |       30 |
|        2 |      30 |   11 |       30 |
|        3 |      30 |   11 |       30 |
|        4 |      30 |   11 |       30 | 
```

[演示](http://sqlfiddle.com/#!2/1e6aa/8)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T14:59:54.480

这样做的原因是您已经从第二个表中*加入*了第一个派生表，而没有对其进行分组。要解决此问题，请将第二个表 ( `fund`) 分组并使用 LEFT JOIN 将其与第一个派生表连接起来。

```
SELECT  b.title_id,
        b.TotalRevenue,
        b.TotalCost,
        d.TotalInterest
FROM 
(
    SELECT   a.title_id, 
             SUM(a.revenue) TotalRevenue, 
             SUM(a.cost) TotalCost
    FROM     revenue a
    GROUP BY a.title_id
) b LEFT JOIN
(
    SELECT   c.title_id, 
             SUM(a.interest) TotalInterest
    FROM     fund c
    GROUP BY c.title_id
) d ON b.title_id = d.title_id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T14:34:01.393

收入表中的每个 title_id 有两行。

# javascript - 如何在初始化函数中将原型函数添加到事件侦听器？

> ID：11364163
> 
> 赞同：6
> 
> 时间：2012-07-06T14:27:54.383
> 
> 标签：javascript, html, oop, prototype

我不确定如何准确地表达我的问题，所以让我举一个例子：

```
function foo() {
  window.addEventListener("keydown", function(event) {
        bar(event.keycode);
}

foo.prototype.bar = function (keycode) {
//code
} 
```

我尝试过使用`this.bar()`，但这导致使用`window`as `this`。有没有办法做到这一点，还是我必须手动调用另一个初始化方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T14:31:05.287

在通过之前绑定`this.bar`到。`this`

```
function foo() {
    window.addEventListener("keydown", this.bar.bind(this), false);
}

foo.prototype.bar = function (event) {
    console.log(event.keyCode);
} 
```

演示[http://jsfiddle.net/2tee4/](http://jsfiddle.net/2tee4/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-06T14:44:42.700

如果您没有[`Function.prototype.bind`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind)可用的*，并且您不愿意添加额外的功能，另一种解决方案`Function.prototype`是关闭对 的调用`this.bar`：

```
function foo() {
    var self;
    self = this;
    window.addEventListener('keydown', function (e) {
        self.bar(e);
    }, false);
}
foo.prototype.bar = function (e) {
    console.log(e.keyCode);
} 
```

[* 虽然你使用`addEventListener`without`attachEvent`让我相信这`Function.prototype.bind`是一个可以接受的选择]

* * *

此外，诸如jQuery 之类的库`jQuery`可能包含它们自己的形式。`bind`[`jQuery.proxy`](http://api.jquery.com/jquery.proxy)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-06T14:49:03.620

如果您的意图是为每个`foo`创建的侦听器添加一个新的侦听器，另一个选项是`foo`实现*EventListener*接口，并简单地传递`this`代替处理程序。

```
function Foo() {
    window.addEventListener("keydown", this, false);
}

Foo.prototype.bar = "foobar";

Foo.prototype.handleEvent = function(e) {
    console.log(e.type);   // "mousedown" (for example)
    console.log(this.bar); // "foobar"
};

new Foo(); 
```

请注意，这仅适用于`addEventListener()`.

***演示：http:*** [//jsfiddle.net/k93Pr/](http://jsfiddle.net/k93Pr/)

# twitter - 如何在没有标题的推特中发出 POST 请求

> ID：11364167
> 
> 赞同：0
> 
> 时间：2012-07-06T14:28:11.907
> 
> 标签：twitter, twitter-oauth

我想创建一个没有 Oauth 标头的 twitter POST 请求我的请求会像

```
curl --request 'POST' 'https://api.twitter.com/1/statuses/update.json?oauth_signature=IeeuNHBH4bLhwy8w42Z0qbpXvFI%3D&oauth_version=1.0&oauth_nonce=ec2397446398196ff26b1c17a23cfdb6&oauth_signature_method=HMAC-SHA1&oauth_consumer_key=gGrr4khdilkzano8gYxK4Q&oauth_token=146439820-n07FzSB78bDWEUzPPP9WZnwdnwW917FyJi1gwKWM&oauth_timestamp=1341388264'--data 'status=hello+world' 
```

请帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T22:58:06.427

你不能做你想做的事。

这些是“`GET`参数”。

尝试使用`-d`带有 CURL 的标志来发送`POST`正文参数。`--data`（它与您在其他地方使用的参数相同。）

# python - While循环不执行主要功能

> ID：11364168
> 
> 赞同：0
> 
> 时间：2012-07-06T14:28:15.367
> 
> 标签：python

我正在尝试编写一个 Python 脚本，该脚本使用属于我工作的公司的特定外部应用程序。在编程和脚本方面，我通常可以自己解决问题，但这次我真的迷路了！

我似乎无法弄清楚为什么 while 循环不能按预期运行。它没有给出任何对我没有帮助的错误。它似乎只是跳过了循环中心代码的重要部分，然后继续增加“计数”，就像它应该在之后一样！

```
f = open('C:/tmp/tmp1.txt', 'w')    #Create a tempory textfile
f.write("TEXTFILE\nTEXTFILE\nTEXTFILE\nTEXTFILE\nTEXTFILE\nTEXTFILE\n") #Put some simple text in there
f.close()   #Close the file

count = 0   #Insert the line number from the text file you want to begin with (first line starts with 0)
num_lines = sum(1 for line1 in open('C:/tmp/tmp1.txt')) #Get the number of lines from the textfile

f = open('C:/tmp/tmp2.txt', 'w')    #Create a new textfile
f.close()   #Close it

while (count < num_lines):  #Keep the loop within the starting line and total number of lines from the first text file
    with open('C:/tmp/tmp1.txt', 'r') as f: #Open the first textfile
        line2 = f.readlines()   #Read these lines for later input
        for line2[count] in f:  #For each line from chosen starting line until last line from first text file,...
            with open('C:/tmp/tmp2.txt', 'a') as g: #...with the second textfile open for appending strings,...
                g.write("hello\n")  #...write 'hello\n' each time while "count" < "num_lines"
    count = count + 1   #Increment the "count" 
```

我认为一切正常，直到：“for line2[count] in f:”

我正在处理的实际代码要复杂一些，而且我使用的应用程序并不完全是为了共享，所以我简化了代码以提供愚蠢的输出，而不是仅仅为了解决问题。

我不是在寻找替代代码，我只是在寻找循环不起作用的原因，以便我可以尝试自己修复它。

所有答案将不胜感激，并提前感谢大家！

科马克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:49:38.110

一些评论：

```
num_lines = sum(1 for line1 in open('C:/tmp/tmp1.txt')) 
```

为什么？有什么问题`len(open(filename, 'rb').readlines())`？

```
while (count < num_lines):
    ...
    count = count + 1 
```

这是不好的风格，你可以使用：

```
for i in range(num_lines):
    ... 
```

请注意，我将您的 index 命名`i`为普遍认可的名称，并且我使用`range`了一个`for`循环。

现在，就像我在评论中所说的那样，您的问题是这`f`是一个文件（即带有位置指针的字节流），并且您已经从中读取了所有行。因此，当您这样做时`for line2[count] in f:`，它会尝试将一行读入`line2[count]`（这有点奇怪，实际上，您几乎从不使用`for`带有列表成员作为索引的循环，但显然您可以这样做），看到没有要读取的行，并且从不执​​行循环内的内容。

无论如何，您想从给定的行号开始逐行读取文件？这是一个更好的方法：

```
from itertools import islice

start_line = 0 # change this
filename = "foobar" # also this

with open(filename, 'rb') as f:
    for line in islice(f, start_line, None):
        print(line) 
```

我意识到您不想要替代代码，但是您的代码确实是不必要的复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:48:16.613

您似乎弄错了“for line in f”循环的工作原理。它遍历一个文件并调用 readline，直到没有要读取的行。但是在你开始循环的那一刻，所有的行都已经被读取（通过 f.readlines()）并且文件的当前位置在末尾。你可以通过调用 f.seek(0) 来实现你想要的，但这似乎不是一个好的决定，因为你要再次读取文件并且 IO 很慢。相反，你想做这样的事情：

```
for line in line2[count:]: # iterate over lines read, starting with `count` line
    do_smth_with(line) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T14:41:59.027

如果您想遍历文件 f 中的行，我建议将您的“for”行替换为

```
for line in line2:
    # do something with "line"... 
```

您将这些线放在一个名为 line2 的数组中，因此请使用该数组！使用 line2[count] 作为循环变量对我来说没有意义。

# android - 如何知道 Android 智能手机的 MTU 大小

> ID：11364170
> 
> 赞同：9
> 
> 时间：2012-07-06T14:28:17.203
> 
> 标签：android, mtu

有什么命令可以知道 Android 的 MTU 大小吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T14:33:09.083

您应该使用[NetworkInterface](http://developer.android.com/reference/java/net/NetworkInterface.html)类来查询和获取网络接口，然后调用`getMTU()`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-07T10:22:05.383

今天翻看netcfg的代码，看到接口的配置在/sys/class/net..然后就想到了你！（我昨天读了你的问题）

如果您有 root 访问权限，请打开终端并运行

```
cat /sys/class/net/<interface>/mtu 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-06T16:38:14.697

**在没有 ROOTING**手机的情况下，您可以使用 Windows/Mac/Unix 系统中的 ping 命令。但是，对于不同的操作系统，-options 的语法`ping`非常不同。

## 对于 Windows

尝试这个：

```
ping /l 1473 /f 10.68.34.75 
```

> *`/l <Size>`— 指定发送的回显请求消息中数据字段的长度（以字节为单位）。默认值为 32。*
> 
> *`/f`— 指定发送回显请求消息时将 IP 标头中的不分段标志设置为 1（仅在 IPv4 上可用）。*

`-l`使用命令行选项调整有效负载。当您达到上限时，您将看到此消息并且您会发现 MTU 大小：

```
> The packet needs to be fragmented but DF set. 
```

更多详情：[https ://kb.netgear.com/19863/Ping-Test-to-determine-Optimal-MTU-Size-on-Router](https://kb.netgear.com/19863/Ping-Test-to-determine-Optimal-MTU-Size-on-Router)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-06-11T05:54:45.420

## 了解Android MTU大小的方法：

1.  从[终端](https://termux.com/)：`ifconfig $DEVICE | egrep addr\|MTU`
2.  通过[Android 调试桥（adb）](https://developer.android.com/studio/command-line/adb)：
    *   `adb shell netcfg | grep UP`找到所需的地址和
    *   `adb shell ip addr show rmnet0`如果是`rmnet0`或
    *   `adb shell cat /sys/class/net/rmnet0/mtu`如果出现`rmnet0`（如@patedit 所述）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-14T10:40:24.750

对于大多数网络访问，MTU 可以通过 MTU 发现来解决。您可以使用具有不同有效负载大小的 Ping 命令，并且不要分段来查找克莱斯勒值。祝你好运

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-06T14:30:36.470

1480，我相信，但你可以通过使用`ifconfig $DEVICE`有根设备来检查，并在那里检查 MTU。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-13T01:57:56.980

**在没有 ROOTING**手机的情况下，您可以使用 Windows/Mac/Unix 系统中的 ping 命令。但是，对于不同的操作系统，-options 的语法`ping`非常不同。

## 从大多数 Unix/Linux/Mac 系统（无需 ROOTING 手机）

您可以从手机共享互联网连接，然后从连接到您的 android-phone 的任何 PC 运行`ping`命令：

```
ping www.yahoo.com -s 1413 -M do 
```

> **人平**说：
> 
> *`-s <packetsize>`— 指定要发送的数据字节数。默认值为 56，当与 8 字节的 ICMP 报头数据组合时，它转换为 64 个 ICMP 数据字节。*
> 
> *`-M <pmtudisc_opt>`— 选择路径 MTU 发现策略。`<pmtudisc_option>`可以是`do`（禁止分片，甚至是本地分片），`want`（进行 PMTU 发现，当数据包大小较大时在本地分片）或`dont`（不设置**DF**标志）。*

使用命令行选项调整有效负载`-s`（例如：*1200、1300、1400、1500、1450、1425、1440、...*）。当你达到上限时，你会看到这样的消息，你会发现 MTU 大小：

```
> From 192.168.1.1 icmp_seq=1 Frag needed and DF set (mtu = 1500)
ping: local error: Message too long, mtu=1500 
```

[我的答案基于 Windows 的这个：[答案 #25165641](https://stackoverflow.com/a/25165641/1115187)]

# wpf - 垂直进度条 Wpf

> ID：11364179
> 
> 赞同：1
> 
> 时间：2012-07-06T14:28:58.703
> 
> 标签：wpf, xaml, progress-bar

我正在尝试在 WPF 中实现垂直进度条并且遇到了一些困难。我正在关注[垂直进度条模板 .net](https://stackoverflow.com/questions/5723950/vertical-progress-bar-template-net)中 Greg D 的回答，但它对我不起作用。我已经尝试过使用外部样式和内联，但没有运气。这很烦人，因为它似乎是一个相对简单的答案。

这是我的`XAML`；

```
<ProgressBar Name="VolumeMeter" Orientation="Vertical" Margin="4,30,0,0" 
Value="50" HorizontalAlignment="Left" VerticalAlignment="Top" Height="300" Width="10">
    <ProgressBar.Template>
    <ControlTemplate>

            <Border BorderBrush="Green" x:Name="Root" BorderThickness="1">
                <Grid Name="PART_Track" Background="Red">
                    <Rectangle Name="PART_Indicator" Fill="Blue"/>
                </Grid>
            </Border>

            <ControlTemplate.Triggers>
            <Trigger Property="Orientation" Value="Vertical">//Error Here

                <!-- Rotate the progressbar so the left edge is the bottom edge -->
                <Setter TargetName="Root" Property="LayoutTransform">
                    <Setter.Value>
                        <RotateTransform Angle="270" />
                    </Setter.Value>
                </Setter>

                <Setter TargetName="Root" Property="Width"
                Value="{Binding RelativeSource={RelativeSource TemplatedParent}, 
Path=Height}"/>
                <Setter TargetName="Root" Property="Height"
                Value="{Binding RelativeSource={RelativeSource TemplatedParent}, 
Path=Width}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    </ProgressBar.Template>
</ProgressBar> 
```

我得到的错误`<Trigger Property="Orientation" Value="Vertical">`在线，我得到了；

> 在“System.Windows.Controls.Control”类型上找不到模板属性“方向”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T14:30:05.927

设置. `TargetType`_`ControlTemplate`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:33:43.010

```
<ControlTemplate TargetType="ProgressBar"> 
```

或者

```
 <Trigger Property="ProgressBar.Orientation" Value="Vertical"> 
```

# objective-c - 如何使用参数从终端启动控制台应用程序？

> ID：11364180
> 
> 赞同：0
> 
> 时间：2012-07-06T14:29:00.210
> 
> 标签：objective-c, xcode

我在 Xcode 中有一个使用 Core Data 的控制台应用程序，应该从控制台获取一个参数。问题是它在没有打包到 .app 文件的情况下构建。所以我什至不能从终端启动它，甚至不能给它传递一个参数。也许我错过了一些项目设置，允许我这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:36:17.860

您应该在应用程序中运行实际程序，例如`./MyProgram.app/Contents/MacOS/MyProgram`，如果您位于包含 .app 的目录中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-01T06:27:46.023

```
open -a "./MyProgram.app/Contents/MacOS/MyProgram" --args myarg 
```

# php - 用 sql 检查两个表是否是唯一的 PHP

> ID：11364181
> 
> 赞同：0
> 
> 时间：2012-07-06T14:29:00.930
> 
> 标签：php, mysql, database, unique

如果两列是唯一的然后不再插入，我如何检查 MYSQL PHP，否则如果只有一列是唯一的然后插入，这甚至可以在 php 中执行吗？

编辑：

假设我有一张这样的桌子，

```
userId  |  codeId 
```

我发送这样的查询，

```
$query = $pdo->prepare('insert into table (userId, codeId) values (?,?)'); 
```

所以现在我想检查 userId 和 codeId 是否已经添加一次不要再次插入，如果只添加一个，则插入整个查询，

我希望它更多的理解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:31:22.847

为这些列设置一个唯一键，然后当您尝试插入时，mysql 查询将**失败。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T14:31:52.427

使用 REPLACE INTO 而不是 INSERT INTO ... ？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T14:51:23.367

执行以下代码（其中 TEXT_ID 和 TEXT_CATEGORY 是表的键）：

```
INSERT INTO 
    table_texts
SET 
    text_id = 174,
    text_category = "pam_texto"
ON DUPLICATE KEY UPDATE 
    text_id = 174,
    text_category = "pam_texto"; 
```

上面的代码尝试插入，但如果键重复，则在行上执行更新。

# matlab - 在matlab中绘制填充三角形的最简单方法

> ID：11364185
> 
> 赞同：1
> 
> 时间：2012-07-06T14:29:07.077
> 
> 标签：matlab, plot, geometry, fill

我有一组在 matlab 中使用的标准格式的三角形，即`3XN`索引列表和两个长度向量`N`，分别称为x`X`和`Y`y 坐标。我在 vector 中有一个与每个三角形相关的标量值`C`。我想绘制填充三角形，其中每个 tri 的颜色由 vector 确定`C`。我知道我可以使用`patch`，但这意味着我需要遍历所有 tris 并调用`patch`每一个，对吗？

有没有更好的办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T14:40:08.910

实际上，如果您查看[补丁的文档，](http://www.mathworks.com/help/techdoc/ref/patch.html)您会注意到它说

> 创建一个**或多个**填充多边形。

它还说

> 如果 X 和 Y 是 m×n 矩阵，MATLAB 将绘制 n 个具有 m 个顶点的多边形。
> C 确定补丁的颜色。

`patch`实际上可能*正是*您想要的。您只需要将`x`和`y`坐标放入`3xN`矩阵中。

# javascript - Backbone Marionette 和 RequireJS 模块

> ID：11364191
> 
> 赞同：16
> 
> 时间：2012-07-06T14:29:32.270
> 
> 标签：javascript, backbone.js, requirejs, marionette

我正在用 Marionette 开始一个大规模的 javascript 应用程序。Marionette 应用程序具有应用程序模块的概念，RequireJS 也用于将代码分解为模块，

目前我有这个作为我的应用程序的开始：

```
require([ "jquery", "underscore", "backbone", "marionette" ],
function ($, _, Backbone, Marionette) {
    $(function() {

        App = new Marionette.Application();
        App.addInitializer(function(options) {
            App.addRegions({
                mainArea: "#mainArea"
            });
        });

        App.on("start", function() {
            // done starting up, do stuff here
        });

        App.start();
    });
}); 
```

如果我想添加一个视图，我会在文件中执行以下操作吗？

```
require([ "jquery", "underscore", "backbone", "marionette" ],
function($, _, Backbone, Marionette) {

    App.module("FirstView", function(FirstView, App, Backbone, Marionette, $, _) {
        return Marionette.ItemView.extend({
            //define view stuff in here
         });
    });

}); 
```

我不确定如何让这段代码实际运行，非常感谢任何帮助

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-06T14:57:37.750

Marionette 的模块旨在成为 RequireJS（和其他）模块格式的简单替代方案。如 wiki 所述，我不建议将它们一起使用：

[https://github.com/marionettejs/backbone.marionette/wiki/AMD-Modules-vs-Marionette's-Modules](https://github.com/marionettejs/backbone.marionette/wiki/AMD-Modules-vs-Marionette's-Modules)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-19T09:38:35.613

恕我直言，我喜欢与上述观点不同“木偶的模块旨在成为 RequireJS（和其他）模块格式的简单替代方案。”

我喜欢用 C# 的程序集和命名空间概念来比较 Require.js 模块和 Marionette.js 模块。Marionette.js 的模块帮助我们根据功能对各种构建块的定义进行分组，而 Require.js 可用于加载/注入依赖项。

同样，这是我的观点/理解（基于与 David Sulc 在他的书“使用 RequireJS 和 Marionette 模块构建主干代码”中的讨论），这有助于我的实现。在某种程度上，我们可以将 Marionette.js 和 Require.js 一起使用，如下所述。

下面的示例是一个小型图书馆管理器应用程序（示例），可以在线找到 @ [https://github.com/srihari-sridharan/LibraryManagement](https://github.com/srihari-sridharan/LibraryManagement)。下面的代码（省略无关紧要的部分）创建应用程序对象并在初始化后呈现书籍列表。请在这里找到它 - [https://github.com/srihari-sridharan/LibraryManagement/blob/master/app/js/app.js](https://github.com/srihari-sridharan/LibraryManagement/blob/master/app/js/app.js)

```
define([
    'marionette',
    'modules/config/marionette/regions/dialog'], function (Marionette) {

    // Create the application object
    var LibraryManager = new Marionette.Application();

    // Add regions to the application object
    LibraryManager.addRegions({
        //Header
        headerRegion: "#header-region",
        //Main
        mainRegion: "#main-region",
        //Footer
        footerRegion: "footer-region",
        //Overlay Dialog
        dialogRegion: Marionette.Region.Dialog.extend({
            el:"#dialog-region"
        })
    });

    // Subscribe to Initialize After event.
    LibraryManager.on('initialize:after', function() {
        if(Backbone.history){
            require(['modules/books/booksModule', 'modules/about/aboutModule'], function (){
                Backbone.history.start();    
                if(LibraryManager.getCurrentRoute() === ''){
                    LibraryManager.trigger("books:list");
                }                    
            });
        }
    });

    // Return the application object.
    return LibraryManager;
}); 
```

接下来我们根据功能定义模块/子模块。这也将有一个特定于模块的路由器，并将连接控制器并处理路由。注意对控制器的 require 调用。此代码位于[https://github.com/srihari-sridharan/LibraryManagement/blob/master/app/js/modules/books/booksModule.js](https://github.com/srihari-sridharan/LibraryManagement/blob/master/app/js/modules/books/booksModule.js)

```
define(['app'], function (LibraryManager) {
    // Define a new module for Books - BooksModule
    LibraryManager.module('BooksModule', function (BooksModule, LibraryManager, Backbone, Marionette, $, _) {

        BooksModule.startWithParent = false;

        BooksModule.onStart = function () {
            console.log('Starting BooksModule.');
        };

        BooksModule.onStop = function () {
            console.log('Stopping BooksModule.');
        };

    });

    // Define a new module for a Router specific to BooksModule
    LibraryManager.module('Routers.BooksModule', function (BooksModuleRouter, LibraryManager, Backbone, Marionette, $, _) {

        BooksModuleRouter.Router = Marionette.AppRouter.extend({
            appRoutes: {
                'books': 'listBooks',
                'books(?filter:=criterion)': 'listBooks',
                'books/:id': 'showBook',
                'books/:id/edit': 'editBook'
            }
        });

        var executeAction = function (action, arg) {
            LibraryManager.startSubModule('BooksModule');
            action(arg);
            LibraryManager.execute('set:active:header', 'books');
        };

        var API = {
            // This is where we are using / referring to our controller
            listBooks: function (criterion) {
                require(['modules/books/list/listController'], function (ListController) {
                    executeAction(ListController.listBooks, criterion);
                });
            },

            showBook: function (id) {
                require(['modules/books/show/showController'], function (ShowController){
                    executeAction(ShowController.showBook, id);
                });
            },

            editBook: function (id) {
                require(['modules/books/edit/editController'], function (EditController) {
                    executeAction(EditController.editBook, id);
                });
            }

        };

        // Navigating routes.
        LibraryManager.on('books:list', function () {
            LibraryManager.navigate('books');
            API.listBooks();
        });

        LibraryManager.on('books:filter', function(criterion) {
            if(criterion){
                LibraryManager.navigate('books?filter=' + criterion);
            }
            else{
                LibraryManager.navigate('books');
            }
        });

        LibraryManager.on('book:show', function (id) {
            LibraryManager.navigate('books/' + id);
            API.showBook(id);
        });

        LibraryManager.on("book:edit", function(id){
            LibraryManager.navigate('books/' + id + '/edit');
            API.editBook(id);
        });

        LibraryManager.addInitializer(function () {
            new BooksModuleRouter.Router({
                controller: API
            });
        });
    });

    return LibraryManager.BooksModuleRouter;
}); 
```

最后，我们有了视图、模型和控制器的定义。这些定义将绑定到模块/子模块对象。

视图代码如下所示。查看 .extend() 方法。它们被分配给附加到 BooksModule.List.View 子模块的变量。[https://github.com/srihari-sridharan/LibraryManagement/blob/master/app/js/modules/books/list/listView.js](https://github.com/srihari-sridharan/LibraryManagement/blob/master/app/js/modules/books/list/listView.js)

```
define(['app',
        'tpl!modules/books/list/templates/layout.html',
        'tpl!modules/books/list/templates/panel.html',
        'tpl!modules/books/list/templates/none.html',
        'tpl!modules/books/list/templates/list.html',
        'tpl!modules/books/list/templates/listItem.html'], 
    function (LibraryManager, layoutTemplate, panelTemplate, noneTemplate, listTemplate, listItemTemplate) {

        LibraryManager.module('BooksModule.List.View', function(View, LibraryManager, Backbone, Marionette, $, _) {

            View.Layout = Marionette.Layout.extend({

                template: layoutTemplate,

                regions:{
                    panelRegion: '#panel-region',
                    booksRegion: '#books-region'
                }

            });

            View.Panel = Marionette.ItemView.extend({
                // More code here!
            });

            View.Book = Marionette.ItemView.extend({                
                // More code here!
            });

            var NoBooksView = Marionette.ItemView.extend({
                template: noneTemplate,
                tagName: "tr",
                className: "alert"
            });

            View.Books = Marionette.CompositeView.extend({
                // More code here!
            });
        });
    return LibraryManager.BooksModule.List.View; // Return the definition.
}); 
```

控制器代码如下所示。这是从 booksModule.js 中的代码调用的。控制器定义附加到 BooksModule.List 子模块。

```
define(['app', 'modules/books/list/listView'], function (LibraryManager, View) {

    LibraryManager.module('BooksModule.List', function (List, LibraryManager, Backbone, Marionette, $, _) {

        List.Controller = {

            listBooks: function (criterion) {

                require(['common/views', 'entities/book'], function (CommonViews) {

                    var loadingView = new CommonViews.Loading();
                    LibraryManager.mainRegion.show(loadingView);

                    var fetchingBooks = LibraryManager.request('book:entities');
                    var booksListLayout = new View.Layout();
                    var booksListPanel = new View.Panel();

                    require(['entities/common'], function (FilteredCollection) {

                        $.when(fetchingBooks).done(function (books) {
                            // More code here!
                            });

                            if(criterion){
                                filteredBooks.filter(criterion);
                                booksListPanel.once('show', function () {
                                    booksListPanel.triggerMethod("set:filter:criterion", criterion);
                                });
                            }

                            var booksListView = new View.Books({
                                collection: filteredBooks
                            });

                            booksListPanel.on('books:filter', function (filterCriterion) {
                                filteredBooks.filter(filterCriterion);
                                LibraryManager.trigger("books:filter", filterCriterion);
                            });

                            booksListLayout.on("show", function(){
                                booksListLayout.panelRegion.show(booksListPanel);
                                booksListLayout.booksRegion.show(booksListView);
                            });

                            booksListPanel.on('book:new', function () {

                                require(["modules/books/new/newView"], function (NewView) {
                                        // More code here!
                                    });

                                    LibraryManager.dialogRegion.show(view);
                                });
                            });

                            booksListView.on('itemview:book:show', function (childView, model) {
                                LibraryManager.trigger("book:show", model.get('id'));
                            });

                            booksListView.on('itemview:book:edit', function(childView, model) {
                                require(['modules/books/edit/editView'], function (EditView) {
                                    // More code here!
                                    LibraryManager.dialogRegion.show(view);
                                });
                            });

                            booksListView.on("itemview:book:delete", function (childView, model) {
                                model.destroy();
                            });

                            LibraryManager.mainRegion.show(booksListLayout);

                        });

                    });

                });

            }

        }

    });

    return LibraryManager.BooksModule.List.Controller; // Return the definition.
}); 
```

因此 require.js 模块和 marionette 模块可以共存。以下是优点。

*   更清晰的源代码组织和更清晰的关注点分离。
*   模块启动和停止方法提供初始化和清理对象的准备。
*   当您将功能和子功能建模为模块和子模块时，我们可以更精细地控制哪些驻留在内存中，哪些不应该驻留。
*   此外，模块定义可以拆分为多个文件。

请发表你的想法。谢谢阅读。

PS：基于上述观点，请在下面找到您的示例的更改：

```
require([ "jquery", "underscore", "backbone", "marionette" ],
function($, _, Backbone, Marionette) {
    App.module("FirstView", function(FirstView, App, Backbone, Marionette, $, _) {
        FirstView.View = Marionette.ItemView.extend({
            //define view stuff in here
        });

        return FirstView.View;
    });
}); 
```

# android - How to decide which item will be shown at first in the screen in android gallery?

> ID：11364206
> 
> 赞同：0
> 
> 时间：2012-07-06T14:30:20.203
> 
> 标签：android, gallery

I have a gallery that consist of small size of pictures and when I click any of them a gallery comes to screen with bigger images of those small pictures. And for example I clicked the 3\. picture of gallery, in the second screen I want to see the 3\. picture first but when I scroll it left or right I want to see other pictures. How can I do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:35:06.667

pass that selected `int` to next screen and then do this:

```
galleryView.setSelection(3); //3 or whatever you send your position from previous screen 
```

Remember do this, after setting the `Adapter` to `Gallery`.

# sql - 表架构最佳实践

> ID：11364207
> 
> 赞同：2
> 
> 时间：2012-07-06T14:30:21.857
> 
> 标签：sql, database-design

我有一张表，我在其中存储我拥有的工具的配置。它有一个 ConfigID，它只是一个身份字段、客户名称、应用程序名称，然后它有 18 个众所周知的字段（wellknownfield1、wellknownfield2、...、wellknownfield18），我知道根据另一个表值输入什么。

现在我的问题来了。我还需要自定义值。目前我有一个愚蠢的解决方案，有 customfieldname1、customfieldvalue1、...、customfieldname20、customfieldvalue20）。这些值具有我需要用管道分隔的所有随机值。我正在使用 SQL Server 数据库。有人有什么建议吗？如果有任何不清楚的地方，请发表评论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T14:38:56.230

严格来说，您不应该将一组值放在一列中。它违反了关系数据的第一范式。创建一个名为自定义数据（Config_ID、CUSTOM_NAME、CUSTOM_DATA_VALUE、CUSTOM_DATA_TYPE）的单独表并将自定义值存储在其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:35:59.743

使用另一个带有外键的表。将需要保存的所有 customfieldname 值保存在那里。使用 ConfigID 作为外键来引用具有额外自定义值的主表上的 ConfigID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-25T14:06:34.590

有一种标准的方法来布置数据库表以使其易于管理 - 称为规范化。标准化有不同的级别——第一范式、第二范式、第三范式……甚至更高（在我看来，高于第三范式有点深奥）。

这些定义的解释在这里：

[简单英语的规范化](https://stackoverflow.com/questions/2331838/normalization-in-plain-english)

[什么是数据库设计中的 1NF、2NF 和 3NF？](https://stackoverflow.com/questions/723998/can-someone-please-give-an-example-of-1nf-2nf-and-3nf-in-plain-english)

它可能看起来很抽象 - 但关键是要消除数据库中的任何歧义或重复，并防止进一步出现问题。

正如 srini.venigalla 指出的那样——你的表不符合第一范式的标准——每一行都应该有相同数量的数据，每个 DB 列一个。再一次，这似乎是一个抽象的规则——但它是为了防止现实世界的问题——比如，我如何解析这个列值？我怎么知道分隔符是什么？如果它没有足够的数据点怎么办？如果有额外的列怎么办，它们的名称是什么？如果您坚持每列一个值，所有这些问题都会消失。

第二范式和第三范式也是如此 - 它们不允许数据库中的重复值/冗余，这可以防止使数据库处于不一致状态的现实世界问题。

关于数据库规范化的程度存在争议/权衡 - 但让一切都符合第三范式似乎是初学者可以接受的经验法则。

（这是我在为我自己的非 1NF 和非 2NF 数据库模式编写代码变通办法后得出的结论）

# sql - TSQL 中的序列分组

> ID：11364209
> 
> 赞同：1
> 
> 时间：2012-07-06T14:30:34.597
> 
> 标签：sql, sql-server, tsql, grouping

我正在尝试按顺序对数据进行分组。假设我有下表：

```
| 1 | A |
| 1 | A |
| 1 | B |
| 1 | B |
| 1 | C |
| 1 | B | 
```

我需要 SQL 查询来输出以下内容：

```
| 1 | A | 1 |
| 1 | A | 1 |
| 1 | B | 2 |
| 1 | B | 2 |
| 1 | C | 3 |
| 1 | B | 4 | 
```

最后一列是在每个组中递增的组号。需要注意的重要一点是，第 3、4 和 5 行包含相同的数据，这些数据应分为 2 组而不是 1 组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-16T13:17:57.403

对于**MSSQL2008**：

假设您有一个 SampleStatuses 表：

```
Status  Date
A       2014-06-11
A       2014-06-14
B       2014-06-25
B       2014-07-01
A       2014-07-06
A       2014-07-19
B       2014-07-21
B       2014-08-13
C       2014-08-19 
```

你写了以下内容：

```
;with
cte as (
    select top 1 RowNumber, 1 as GroupNumber, [Status], [Date] from SampleStatuses order by RowNumber
    union all
    select c1.RowNumber,
        case when c2.Status <> c1.Status then c2.GroupNumber + 1 else c2.GroupNumber end as  GroupNumber, c1.[Status], c1.[Date] 
    from cte c2 join SampleStatuses c1 on c1.RowNumber = c2.RowNumber + 1       
)
select * from cte; 
```

你得到这个结果：

```
RowNumber   GroupNumber Status  Date
1           1           A       2014-06-11
2           1           A       2014-06-14
3           2           B       2014-06-25
4           2           B       2014-07-01
5           3           A       2014-07-06
6           3           A       2014-07-19
7           4           B       2014-07-21
8           4           B       2014-08-13
9           5           C       2014-08-19 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T14:52:10.793

这将为您提供列上的排名。但是，它不会给您 1,2,3。它会根据每个分组的数量为您提供 1、3、6 等

```
select 
a,
b,
rank() over (order by a,b)
 from
table1 
```

请参阅此 SQLFiddle 以更清楚地了解我的意思：[http ://sqlfiddle.com/#!3/0f201/2/0](http://sqlfiddle.com/#!3/0f201/2/0)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T15:07:34.910

你会做你想做的正常方式是dense_rank函数：

```
select key, val,
       dense_rank() over (order by key, val)
from t 
```

然而，这并没有解决分离最后一组的问题。

为了处理这个问题，我必须假设有一个“id”列。SQL 中的表没有排序，所以我需要排序。如果您使用的是 SQL Server 2012，那么您可以使用 lag() 函数来获取您需要的内容。使用滞后来查看键、val 对在连续行上是否相同：

```
with t1 as (
     select id, key, val,
            (case when key = lead(key, 1) over (order by id) and
                       val = lead(val, 1) over (order by id)
                  then 1
                  else 0
             end) as SameAsNext
     from t
    )
select id, key, val,
       sum(SameAsNext) over (order by id) as GroupNum
from t 
```

如果没有 SQL Server 2012（具有累积总和），您必须执行自联接来识别每个组的开头：

```
select t.*,
from t left outer join
     t tprev
     on t.id = t2.id + 1 and t.key = t2.key and t.val = t2.val
where t2.id is null 
```

有了这个，使用连接将组分配为最小 id：

```
select t.id, t.key, t.val,
       min(tgrp.id) as GroupId
from t left outer join
     (select t.*,
      from t left outer join
           t tprev
           on t.id = t2.id + 1 and t.key = t2.key and t.val = t2.val
      where t2.id is null
    ) tgrp
    on t.id >= tgrp.id 
```

如果您希望这些是连续数字，则将它们放在子查询中并使用dense_rank()。

# java - JTextPane 的缩进部分

> ID：11364218
> 
> 赞同：1
> 
> 时间：2012-07-06T14:31:14.383
> 
> 标签：java, swing, jtextpane, styleddocument

有没有办法使用 insertString 在 jtextpane 中缩进文本？我的问题类似于[JTextPane 缩进](https://stackoverflow.com/questions/7052061/jtextpane-indentation)，除了我更喜欢使用 insertString

# geometry - 通过点平滑曲线，仅使用水平、垂直线和固定半径弧

> ID：11364219
> 
> 赞同：2
> 
> 时间：2012-07-06T14:31:18.647
> 
> 标签：geometry, smoothing, graph-layout

给定一个有序的点列表，我想绘制一条穿过所有点的平滑曲线。曲线的每个部分可以是水平的、垂直的或具有给定半径 r 的弧（所有弧将具有相同的半径）。过渡应该是平滑的，即一个部分结尾的标题应该与下一部分开头的标题相同。任意两个连续输入点之间可以有任意数量的圆弧或直线段。

它有点像火车轨道，应该正交或沿着具有固定曲率的部分运行。

有没有好的算法来构造这样的曲线？（或者，在不可能有​​这样一条线的情况下，我想知道这一点。）

我研究了贝塞尔曲线，但这似乎有点过头了，我找不到一个很好的方法来执行我的约束。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:37:24.473

您在上面要求的内容对我来说意味着您寻求曲线跨点的切线连续性（类似于在结处具有切线连续性的样条曲线）。火车轨道类比至少传达了这一要求。鉴于直线和*固定*半径圆弧的严格限制，我相当肯定您将无法做到这一点。如果您需要这种平滑度，为什么不考虑对点进行样条插值呢？要了解为什么考虑下图：

![可能的数据点配置](../Images/dec11832c64b005a99eb48110e45f3de.png)

考虑用圆弧替换 B 和 C 之间的线段。您可以这样做以使连接连续，但要使其*切线*连续，您需要很大的运气，因为只有*一个*圆与线段 AB 相切连续，并且也接触点 C。在 C 处的切线与 CD 线的切线相匹配的圆是远程的。您的数据可能会像这样排列，但您不能依赖它。

如果我误解了您的问题，请告诉我，我会调整答案。

# javascript - iOS 的 UIWebView 使用的 JavaScript 引擎叫什么名字？

> ID：11364222
> 
> 赞同：2
> 
> 时间：2012-07-06T14:31:38.933
> 
> 标签：javascript, ios, google-chrome, uiwebview

我知道 UIWebView 使用 WebKit 作为 iOS 的 UIWebView 的渲染引擎。

iOS 的 UIWebView 使用的 JavaScript 引擎叫什么名字？Chrome 使用的一种，比移动 Safari 的 Nitro JavaScript 引擎慢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:30:12.403

它只是称为[JavaScriptCore](http://www.opensource.apple.com/release/ios-433/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-16T17:05:21.383

JavaScriptCore 是 Nitro。当你通过 UIWebView 使用它时，它比在 Safari 中慢，因为 JIT 编译被禁用。

# workflow-foundation-4 - 是否有最大数量的工作流实例，如果我点击它会发生什么？

> ID：11364230
> 
> 赞同：0
> 
> 时间：2012-07-06T14:32:05.890
> 
> 标签：workflow-foundation-4

基本细节：工作流版本 4，托管 IIS，安装了具有持久性和跟踪设置的 App Fabric。

让我们举这个例子。我有一个 X 机器的列表来处理。在最初的工作流程中，我自己对列表进行了一些验证，然后，在针对列表的 foreach 活动中，启动不同的工作流程以在机器上做一些实际工作。这个新的工作流程可能需要 10 分钟到 2 周的时间才能完成，具体取决于许多因素。

我的问题是，当初始列表是 200 或 2000 台机器并且我在服务器上启动这么多工作流实例时会发生什么？是否有允许运行的最大值？如果是这样，当达到这个最大值时，在列表中循环的原始工作流会发生什么？这是我应该处理这种情况的方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T06:25:45.367

工作流服务受与 WCF 相同的设置限制。这意味着将安排超出限制的其他工作流，但将保留在队列中，直到它们可以启动。

有关更多信息，请参阅以下链接：

*   [WF4 中的限制工作流服务](http://msmvps.com/blogs/theproblemsolver/archive/2010/11/17/throttling-workflow-services-in-wf4.aspx)
*   [问题：工作流服务在 464 消息后停止响应](https://stackoverflow.com/a/9272946/19676)

# sql - count(*) 来自 2 个具有相同列的表

> ID：11364235
> 
> 赞同：1
> 
> 时间：2012-07-06T14:32:10.903
> 
> 标签：sql, oracle

我手头有一个奇怪的问题，我确信我的 SQL 很糟糕。

问题如下：

我有 2 个表 table1 和 table2。这两个表都有相同的列集，即 ID 号、X 号、Y 号。这里 X 和 Y 的值为 0 或 1。

现在假设 ID 范围为 table1 中的 1-100，范围为 table2 中的 91-200：在 table1 中，X 具有所有 100 行的值，例如 1，而在同一个表中，Y 仅具有 90 行的值，例如 1。接下来的 10 个 Y 值（即 91-100）在表 2 中。

现在，为各种查询调用 count(*)，例如 X=1 和 Y=1、X=1 和 Y=0 等，我没有得到正确的值，因为 table2 中存在一些 Y 值。我正在查看 left Join 但不知何故我无法弄清楚这是否是正确的方法。

```
Table1
-------
Id X Y
1  1 1 
2  1 1 
3  1 1 
4  1 0 
5  1 0

Table2
-------
Id X Y
4  0 1
5  0 1
6  0 0
7  0 0
8  0 0
9  1 1 
```

所以如果我说 X=1 和 Y=1，我应该得到 5 作为计数（*）。

嗨贾斯汀，让我解释一下实际情况。考虑 3 个进程 p1、p2 和 p3，它们有一个缓存，其中 P1、P2 和 P3 只是 X、Y 和 Z 列。这个缓存的内容就是 ID。如果 p1 转储和 Id 1 我会说 X=1 对于 ID=1 等。这些进程中的每一个都将缓存转储到一个组中，例如 g1 和 g2。我创建了一个关于 g1 和 g2 的表。所以g1代表table1，g2代表table2。p1、p2 和 p3 中的每一个都有转储 100 个 ID 的限制。P1 可能在 g1(table1) 中转储 ID 1-100，其中 p2 在 g1(table1) 中仅转储 90，在 g2(table2) 中转储 10，类似地，p3 会说在 g1(table1) 中转储 95 并休息5 在 g2（表 2）中。然而，p1、p2 和 p3 中的每一个都转储了 100 个 id，但在不同的组中。现在，如果我想计数（*) 在理想情况下，当所有 P1、P2 和 P3 都在 g1 中转储缓存时，我会说从 P1=1 的 g1 中获取 max(id)，从 ​​P1=1 的 g1 中获取类似的 min(id)。我会写一个查询说“*从 g1 中选择 count()，其中 X=1 和 Y=1 和 Z=1，其中 ID 介于 g1 的 min(id) 和 g1 的 max(id) 之间。在理想情况下，它会有返回 100。但在当前情况下，它返回 90，这是不正确的。所以为了解决这个问题，我还必须考虑 g2(table2) 中存在的 ID。

我希望这回答了你的问题。

谢谢马夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T14:47:25.197

听起来您想在应用谓词之前`UNION`或将两个表放在一起。`UNION ALL`就像是

```
SELECT COUNT(*)
  FROM (SELECT id, x, y
          FROM table1
        UNION ALL
        SELECT id, x, y
          FROM table2)
 WHERE x = 1
   AND y = 1; 
```

`UNION ALL`将返回两个表中的每一行。 `UNION`将消除重复的行。

如果这不是您想要的，那么通过一个示例将非常有帮助，您可以在每个表中创建几行样本数据，并准确地向我们展示您想要的结果以及您如何获得该结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:22:24.210

```
SELECT COUNT(*)
FROM
(SELECT ID, MAX(X) X, MAX(Y) Y
FROM
(SELECT *
FROM TABLE1
UNION ALL
SELECT *
FROM TABLE2)
GROUP BY ID)
WHERE X = 1 AND Y = 1 
```

或者，如果您想使用高级 group by 子句

```
SELECT COUNT(*)
FROM
(SELECT *
FROM TABLE1
UNION ALL
SELECT *
FROM TABLE2)
HAVING MAX(X) = 1 AND MAX(Y) = 1
GROUP BY ID 
```

# objective-c - 尝试关闭 UIDocument 时防止崩溃

> ID：11364236
> 
> 赞同：1
> 
> 时间：2012-07-06T14:32:10.803
> 
> 标签：objective-c, ios, icloud, uidocument

我想知道如何在尝试关闭 UIDoc 两次时防止崩溃。我试图在我的代码中确保您（理论上）不能关闭 UIDocument 两次。但是，它有时仍然会发生，我不知道为什么。如果是这样，应用程序会崩溃：

```
2012-07-06 15:24:34.470 Meernotes[11620:707] ... doc state:Normal
2012-07-06 15:24:34.472 Meernotes[11620:707] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'closeWithCompletionHandler called while document is already closing'
*** First throw call stack:
(0x3720e88f 0x34f13259 0x3720e789 0x3720e7ab 0x312681d1 0xd19db 0x96f7f 0x9593f 0xacb8f 0x30f0cd23 0x37a7f933 0x371e2a33 0x371e2699 0x371e126f 0x371644a5 0x3716436d 0x33923439 0x30f10cd5 0x94fdd 0x94f78)
terminate called throwing an exception(lldb) 
```

我试图按如下方式防止崩溃，但它没有任何效果（即它仍然会崩溃）：

```
-(void)closeDoc {

    UIDocumentState state = _selectedDocument.documentState;

    NSMutableArray * states = [NSMutableArray array];
    if (state == 0) {
        [states addObject:@"Normal"];
    }
    if (state & UIDocumentStateClosed) {
        [states addObject:@"Closed"];
    }
    if (state & UIDocumentStateInConflict) {
        [states addObject:@"In conflict"];
    }
    if (state & UIDocumentStateSavingError) {
        [states addObject:@"Saving error"];
    }
    if (state & UIDocumentStateEditingDisabled) {
        [states addObject:@"Editing disabled"];
    }
    NSLog(@"... doc state: %@", [states componentsJoinedByString:@", "]);

    if (_selectedDocument.documentState & UIDocumentStateClosed) return;

    [_selectedDocument closeWithCompletionHandler:^(BOOL success) {

        NSLog(@"Closed document.");
        // Check status
        if (!success) {
            NSLog(@"Failed to close %@", _selectedDocument.fileURL);
        } else {
            _selectedDocument = nil;
        }

    }];             
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T14:42:04.853

好像`UIDocument`没有存储*关闭*状态，只有正常和关闭，所以你必须自己做。

将此添加到您的类变量中：

```
BOOL _documentClosing; 
```

`closeDoc`并在您的方法中添加它的用途：

```
-(void)closeDoc {

    if (_docClosing || (_selectedDocument.documentState & UIDocumentClosed) != 0)
        return;
    _docClosing = YES;

    [_selectedDocument closeWithCompletionHandler:^(BOOL success) {

        NSLog(@"Closed document.");
        // Check status
        if (!success) {
            NSLog(@"Failed to close %@", _selectedDocument.fileURL);
        } else {
            _selectedDocument = nil;
            _docClosing = NO;
        }

    }];             
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T23:06:08.163

知道每个 UIDocument 对象只能打开和关闭一次非常重要。在意识到这一点之前，我在使用 UIDocuments 时遇到了很多奇怪的问题，无论是在云中还是在本地文件中。当你关闭一个文档时，将它的指针设置为 nil，这样你就不能再次关闭它。如果您以后需要再次访问相同的文件，请使用相同的 fileURL 创建一个新的 UIDocument。

您在上面显示的错误消息是您尝试重新使用文档时出现的错误消息。

# unit-testing - CakePHP/Jenkins/Phing - 运行所有单元测试

> ID：11364237
> 
> 赞同：9
> 
> 时间：2012-07-06T14:32:15.357
> 
> 标签：unit-testing, cakephp, continuous-integration, jenkins, phing

我正在第一次尝试设置 Jenkins 以使用我的 CakePHP 项目构建和运行单元测试/代码覆盖率。到目前为止，我已经成功地让 Jenkins 从我的 BitBucket 存储库中自动获取和构建——这本身就是一个小小的胜利。

接下来我想要运行单元测试并填充代码覆盖率报告。

这是我的 build.xml，它在 Jenkins 中使用（仅）构建命令执行`phing -f $WORKSPACE/build.xml`

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="Consumer Love" default="phpunit">
    <target name="phpunit">
        <exec command="cake test app --coverage-clover logs/reports/clover.xml"></exec>
    </target>
</project> 
```

我认为问题在于，当您运行`cake test app`它时会询问您要运行哪些特定测试的提示，我一直无法找到一种方法来运行我的*所有*CakePHP 应用程序单元测试。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-09T16:35:27.140

解决方案是创建一个自定义的**CakePHP 测试套件**，它添加要测试的特定文件/目录，然后使用命令运行该套件`cake test app AllTests`。

例如，这是我的`Test/Case/AllTests.php`：

```
/*
 * Custom test suite to execute all tests
 */

class AllTestsTest extends PHPUnit_Framework_TestSuite {

    public static function suite() {

        $path = APP . 'Test' . DS . 'Case' . DS;

        $suite = new CakeTestSuite('All tests');
        $suite->addTestDirectory($path . 'Model' . DS);
        return $suite;

    }

} 
```

这个测试套件只是将`Models`目录添加到测试环境中，所以我所有的模型测试现在都可以执行了。如您所见，它可以扩展为运行更多/所有测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T01:42:42.227

试试`cake test app all`。我现在无法确认这会有所不同，但我已经从一个 phing 构建文件中提取了它，我正在和你做同样的事情，所以它应该很好。

# powershell - 从用户属性的选项卡成员中删除组

> ID：11364238
> 
> 赞同：0
> 
> 时间：2012-07-06T14:32:19.743
> 
> 标签：powershell, powershell-2.0

我是powershell的新手 下面的脚本我从选项卡的用户成员中删除了所有组，除了“域用户”这很多次都可以正常工作，没有任何问题

# 从用户中删除组

```
$list = Import-Csv c:\user\DN.csv
foreach ($entry in $list)
$UserDN = $entry.DistinguishedName
Get-ADGroup -LDAPFilter "(member=$UserDN)" | foreach-object {
if ($_.name -ne "Domain Users") {remove-adgroupmember -identity $_.name -member   $UserDN -Confirm:$False} 
```

但问题是，如果此脚本无法从选项卡的用户成员中删除任何组，它会在下面引发错误，但它不会显示从哪个用户 ID 无法删除成员资格，因为用户专有名称是从中导入的CSV 文件。

```
Remove-ADGroupMember : The specified account name is not a member of the group
At C:\User\removegroups.ps1:35 char:115
+ Get-ADGroup -LDAPFilter "(member=$UserDN)" | foreach-object {if ($_.name -ne "Domain    Users") {remove-adgroupmember <<
<<  -identity $_.name -member $UserDN -Confirm:$False}
    + CategoryInfo          : NotSpecified: (xyz:ADGroup) [Remove-ADGroupMember],     ADException
    + FullyQualifiedErrorId : The specified account name is not a member of the     group,Microsoft.ActiveDirectory.Management.Commands.RemoveADGroupMember 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T18:30:16.567

```
$list = Import-Csv c:\user\DN.csv
foreach ($entry in $list)
$UserDN = $entry.DistinguishedName
Get-ADGroup -LDAPFilter "(member=$UserDN)" | foreach-object {
if ($_.name -ne "Domain Users") {
try {
remove-adgroupmember -identity $_.name -member $UserDN -Confirm:$False} }
catch [ADexcption] {
write-output "Error Deleting User:" $_.name
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-10T13:29:11.840

```
Import-Csv DN.csv | foreach {
$user = Get-ADUser $_.username
$UserDN = $user.DistinguishedName
Get-ADGroup -LDAPFilter "(member=$UserDN)" | foreach-object {
    if ($_.name -ne "Domain Users") {
        try {
            remove-adgroupmember -identity $_.name -member $UserDN -Confirm:$False
        }
        catch [ADexcption] {
            write-output "Error Deleting User:" $_.name
        }
    }
}} 
```

# sql - 如何使用 SQL Server 比较软件版本？

> ID：11364242
> 
> 赞同：21
> 
> 时间：2012-07-06T14:32:30.467
> 
> 标签：sql, sql-server, tsql

在尝试比较软件版本 5.12 和 5.8 时，版本 5.12 较新，但从数学上讲，5.12 小于 5.8。我将如何比较这两个版本，以便新版本返回“Y”？

```
SELECT CASE WHEN 5.12 > 5.8 THEN 'Y' ELSE 'N' END 
```

**可能的解决方案**

1.  在 5.8 的小数点后添加一个 0，以便将 5.08 与 5.12 进行比较，但是这似乎需要一些代码。
2.  只需比较小数点后的值（即 12 > 8），但是当版本滚动到 6.0 时会失败。
3.  使用反向逻辑并假设如果 5.12 小于 5.8 则返回“Y”。我相信当版本滚动到 6.0 时这会失败。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-10-28T12:25:49.040

您可以`hierarchyid` 通过将 a`/`放在字符串的末尾和开头并转换它来使用您可以使用的

例如

`SELECT CASE WHEN cast('/5.12/' as hierarchyid) > cast('/5.8/' as hierarchyid) THEN 'Y' ELSE 'N' END`

那返回一个`Y`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-06T14:38:23.520

```
declare @v1 varchar(100) = '5.12'
declare @v2 varchar(100) = '5.8'

select 
    case 
    when CONVERT(int, LEFT(@v1, CHARINDEX('.', @v1)-1)) < CONVERT(int, LEFT(@v2, CHARINDEX('.', @v2)-1)) then 'v2 is newer'
    when CONVERT(int, LEFT(@v1, CHARINDEX('.', @v1)-1)) > CONVERT(int, LEFT(@v2, CHARINDEX('.', @v2)-1)) then 'v1 is newer'
    when CONVERT(int, substring(@v1, CHARINDEX('.', @v1)+1, LEN(@v1))) < CONVERT(int, substring(@v2, CHARINDEX('.', @v2)+1, LEN(@v1))) then 'v2 is newer'
    when CONVERT(int, substring(@v1, CHARINDEX('.', @v1)+1, LEN(@v1))) > CONVERT(int, substring(@v2, CHARINDEX('.', @v2)+1, LEN(@v1))) then 'v1 is newer'
    else 'same!'

    end 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-06T14:41:45.440

我建议创建一个 SQL CLR 函数：

```
public partial class UserDefinedFunctions
{
    [SqlFunction(Name = "CompareVersion")] 
    public static bool CompareVersion(SqlString x, SqlString y)
    {
        return Version.Parse(x) > Version.Parse(y);
    }
} 
```

笔记：

*   SqlString 具有[显式](http://msdn.microsoft.com/en-us/library/74t4w106.aspx)转换为字符串。
*   传递完整版本的字符串`a.b.c.d`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-10-04T22:37:10.457

这里有一个重复问题的非常好的解决方案： [如何比较包含版本号的 SQL 字符串，如 .NET System.Version 类？](https://stackoverflow.com/questions/13315756/how-to-compare-sql-strings-that-hold-version-numbers-like-net-system-version-cl)

玩了一会儿查询，我了解到当有 4 个或更多部分时，它无法比较最后一个部分（例如，如果版本号是 1.2.3.4，它将始终将最后一个视为 0） . 我已经解决了这个问题，并提出了另一个比较两个版本号的函数。

```
CREATE Function [dbo].[VersionNthPart](@version as nvarchar(max), @part as int) returns int as
Begin

Declare
    @ret as int = null,
    @start as int = 1,
    @end as int = 0,
    @partsFound as int = 0,
    @terminate as bit = 0

  if @version is not null
  Begin
    Set @ret = 0
    while @partsFound < @part
    Begin
      Set @end = charindex('.', @version, @start)
      If @end = 0 -- did not find the dot. Either it was last part or the part was missing.
      begin
        if @part - @partsFound > 1 -- also this isn't the last part so it must bail early.
        begin
            set @terminate = 1
        end
        Set @partsFound = @part
        SET @end = len(@version) + 1; -- get the full length so that it can grab the whole of the final part.
      end
      else
      begin
        SET @partsFound = @partsFound + 1
      end
      If @partsFound = @part and @terminate = 0
      begin
            Set @ret = Convert(int, substring(@version, @start, @end - @start))
      end
      Else
      begin
            Set @start = @end + 1
      end
    End
  End
  return @ret
End
GO

CREATE FUNCTION [dbo].[CompareVersionNumbers]
(
    @Source nvarchar(max),
    @Target nvarchar(max),
    @Parts int = 4
)
RETURNS INT
AS
BEGIN
/*
-1 : target has higher version number (later version)
0 : same
1 : source has higher version number (later version)
*/ 
    DECLARE @ReturnValue as int = 0;
    DECLARE @PartIndex as int = 1;
    DECLARE @SourcePartValue as int = 0;
    DECLARE @TargetPartValue as int = 0;
    WHILE (@PartIndex <= @Parts AND @ReturnValue = 0)
    BEGIN
        SET @SourcePartValue = [dbo].[VersionNthPart](@Source, @PartIndex);
        SET @TargetPartValue = [dbo].[VersionNthPart](@Target, @PartIndex);
        IF @SourcePartValue > @TargetPartValue
            SET @ReturnValue = 1
        ELSE IF @SourcePartValue < @TargetPartValue
            SET @ReturnValue = -1
        SET @PartIndex = @PartIndex + 1;
    END
    RETURN @ReturnValue
END 
```

用法/测试用例：

```
declare @Source as nvarchar(100) = '4.9.21.018'
declare @Target as nvarchar(100) = '4.9.21.180'
SELECT [dbo].[CompareVersionNumbers](@Source, @Target, DEFAULT) -- default version parts are 4

SET @Source = '1.0.4.1'
SET @Target = '1.0.1.8'
SELECT [dbo].[CompareVersionNumbers](@Source, @Target, 4) -- typing out # of version parts also works

SELECT [dbo].[CompareVersionNumbers](@Source, @Target, 2) -- comparing only 2 parts should be the same

SET @Target = '1.0.4.1.5'
SELECT [dbo].[CompareVersionNumbers](@Source, @Target, 4) -- only comparing up to parts 4 so they are the same
SELECT [dbo].[CompareVersionNumbers](@Source, @Target, 5) -- now comparing 5th part which should indicate that the target has higher version number 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-05-08T20:38:51.303

我在尝试根据[语义版本](http://semver.org/)过滤 SQL 行时遇到了这种情况。我的解决方案有点不同，因为我想存储带有语义版本号标记的配置行，然后选择与我们软件的运行版本兼容的行。

假设：

*   我的软件将包含一个包含当前版本号的配置设置
*   数据驱动的配置行将包含一个最小版本号
*   我需要能够选择 min <= current 的配置行。

例子：

*   1.0.0 版本应包括：1.0.0、1.0.0-*、1.0.0-beta.1
*   版本 1.0.0 应排除：1.0.1、1.1.0、2.0.0
*   版本 1.1.0-beta.2 应包括：1.0.0、1.0.1、1.1.0-beta.1、1.1.0-beta.2
*   版本 1.1.0-beta.2 应排除：1.1.0、1.1.1、1.2.0、2.0.0、1.1.1-beta.1

MSSQL UDF 是：

```
CREATE FUNCTION [dbo].[SemanticVersion] (
    @Version nvarchar(50)
)
RETURNS nvarchar(255)

AS
BEGIN

    DECLARE @hyphen int = CHARINDEX('-', @version)
    SET @Version = REPLACE(@Version, '*', ' ')
    DECLARE 
        @left nvarchar(50) = CASE @hyphen WHEN 0 THEN @version ELSE SUBSTRING(@version, 1, @hyphen-1) END,
        @right nvarchar(50) = CASE @hyphen WHEN 0 THEN NULL ELSE SUBSTRING(@version, @hyphen+1, 50) END,
        @normalized nvarchar(255) = '',
        @buffer int = 8

    WHILE CHARINDEX('.', @left) > 0 BEGIN
        SET @normalized = @normalized + CASE ISNUMERIC(LEFT(@left, CHARINDEX('.', @left)-1))
            WHEN 0 THEN LEFT(@left, CHARINDEX('.', @left)-1)
            WHEN 1 THEN REPLACE(STR(LEFT(@left, CHARINDEX('.', @left)-1), @buffer), SPACE(1), '0')
        END  + '.'
        SET @left = SUBSTRING(@left, CHARINDEX('.', @left)+1, 50)
    END
    SET @normalized = @normalized + CASE ISNUMERIC(@left)
        WHEN 0 THEN @left
        WHEN 1 THEN REPLACE(STR(@left, @buffer), SPACE(1), '0')
    END

    SET @normalized = @normalized + '-'
    IF (@right IS NOT NULL) BEGIN
        WHILE CHARINDEX('.', @right) > 0 BEGIN
            SET @normalized = @normalized + CASE ISNUMERIC(LEFT(@right, CHARINDEX('.', @right)-1))
                WHEN 0 THEN LEFT(@right, CHARINDEX('.', @right)-1)
                WHEN 1 THEN REPLACE(STR(LEFT(@right, CHARINDEX('.', @right)-1), @buffer), SPACE(1), '0')
            END  + '.'
            SET @right = SUBSTRING(@right, CHARINDEX('.', @right)+1, 50)
        END
        SET @normalized = @normalized + CASE ISNUMERIC(@right)
            WHEN 0 THEN @right
            WHEN 1 THEN REPLACE(STR(@right, @buffer), SPACE(1), '0')
        END
    END ELSE 
        SET @normalized = @normalized + 'zzzzzzzzzz'

    RETURN @normalized

END 
```

SQL 测试包括：

```
SELECT CASE WHEN dbo.SemanticVersion('1.0.0-alpha') < dbo.SemanticVersion('1.0.0-alpha.1') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.0.0-alpha.1') < dbo.SemanticVersion('1.0.0-alpha.beta') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.0.0-alpha.beta') < dbo.SemanticVersion('1.0.0-beta') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.0.0-beta') < dbo.SemanticVersion('1.0.0-beta.2') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.0.0-beta.2') < dbo.SemanticVersion('1.0.0-beta.11') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.0.0-beta.11') < dbo.SemanticVersion('1.0.0-rc.1') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.0.0-rc.1') < dbo.SemanticVersion('1.0.0') THEN 'Success' ELSE 'Failure' END

SELECT CASE WHEN dbo.SemanticVersion('1.0.0-*') <= dbo.SemanticVersion('1.0.0') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.0.*') <= dbo.SemanticVersion('1.0.0') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.*') <= dbo.SemanticVersion('1.0.0') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('*') <= dbo.SemanticVersion('1.0.0') THEN 'Success' ELSE 'Failure' END

SELECT CASE WHEN dbo.SemanticVersion('1.0.0-*') <= dbo.SemanticVersion('1.0.0') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.0.1-*') > dbo.SemanticVersion('1.0.0') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.0.1-*') <= dbo.SemanticVersion('1.0.1') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.1.*') > dbo.SemanticVersion('1.0.9') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.1.*') <= dbo.SemanticVersion('1.2.0') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.*') <= dbo.SemanticVersion('2.0.0') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('1.*') > dbo.SemanticVersion('0.9.9-beta-219') THEN 'Success' ELSE 'Failure' END
SELECT CASE WHEN dbo.SemanticVersion('*') <= dbo.SemanticVersion('0.0.1-alpha-1') THEN 'Success' ELSE 'Failure' END 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-07-06T14:36:12.993

分两步，先比较小数点左边，再比较右边。

* * *

可能的解决方案：

```
declare @v1 varchar(100) = '5.12'
declare @v2 varchar(100) = '5.8'

select case 
    when CONVERT(int, LEFT(@v1, CHARINDEX('.', @v1)-1)) < CONVERT(int, LEFT(@v2, CHARINDEX('.', @v2)-1)) then 'v2 is newer'
    when CONVERT(int, LEFT(@v1, CHARINDEX('.', @v1)-1)) > CONVERT(int, LEFT(@v2, CHARINDEX('.', @v2)-1)) then 'v1 is newer'
    when CONVERT(int, RIGHT(@v1, LEN(@v1) - CHARINDEX('.', @v1))) < CONVERT(int, RIGHT(@v2, LEN(@v2) - CHARINDEX('.', @v2))) then 'v2 is newer'
    when CONVERT(int, RIGHT(@v1, LEN(@v1) - CHARINDEX('.', @v1))) > CONVERT(int, RIGHT(@v2, LEN(@v2) - CHARINDEX('.', @v2))) then 'v1 is newer'
    else 'same!' end as 'Version Test' 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-07-06T14:41:28.170

不要将不是字符串的内容存储在字符串中。另一种方法是创建自己的数据类型（在 C# 中 - 允许一段时间），将版本存储为字节序列并实现适当的比较逻辑。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-07-06T14:50:24.427

正如 AF 所建议的，您可以比较 int 部分，然后是小数部分。除了给出的所有答案之外，还有另一种使用 parsename 的方法。您可以尝试这样的事情

```
 case when cast(@var as int)>cast(@var2 as int) then 'Y' 
 when cast(PARSENAME(@var,1) as int) > cast(PARSENAME(@var2,1) as int) THEN 'Y'

 Declare @var float
 Declare @var2 float
 set @var=5.14
 set @var2=5.8
 Select case when cast(@var as int)>cast(@var2 as int) then 'Y' 
 when cast(PARSENAME(@var,1) as int)> cast(PARSENAME(@var2,1) as int) THEN 'Y'
 else 'N' END 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-06T21:47:53.383

您在问题中没有这么说，但是[您](https://stackoverflow.com/questions/11364242/how-to-compare-software-versions-using-sql-server#comment14971850_11364385)在 Tomtom 的回答下的评论表明您将版本号存储为 [decimals][d]。我猜你有一张这样的桌子：

```
CREATE TABLE ReleaseHistory (
  VersionNumber DECIMAL(6,3) NOT NULL
);
GO

INSERT INTO ReleaseHistory (
  VersionNumber
)
VALUES
  (5.12),
  (5.8),
  (12.34),
  (3.14),
  (0.78),
  (1.0);
GO 
```

以下查询尝试按发布顺序对版本进行排名：

```
SELECT
  VersionNumber,
  RANK() OVER (ORDER BY VersionNumber) AS ReleaseOrder
FROM ReleaseHistory; 
```

它产生以下结果集：

```
VersionNumber                           ReleaseOrder
--------------------------------------- --------------------
0.780                                   1
1.000                                   2
3.140                                   3
5.120                                   4
5.800                                   5
12.340                                  6 
```

这不是我们所期望的。5.8 版本在 5.12 版本之前发布！

将版本号拆分为其主要和次要组件以正确排列版本号。一种方法是将十进制值转换为字符串并在句点上拆分。用于此的 T-SQL 语法很难看（该语言不是为字符串处理而设计的）：

```
WITH VersionStrings AS (
  SELECT CAST(VersionNumber AS VARCHAR(6)) AS VersionString
  FROM ReleaseHistory
),
VersionNumberComponents AS (
  SELECT
    CAST(SUBSTRING(VersionString, 1, CHARINDEX('.', VersionString) - 1) AS INT) AS MajorVersionNumber,
    CAST(SUBSTRING(VersionString, CHARINDEX('.', VersionString) + 1, LEN(VersionString) - CHARINDEX('.', VersionString)) AS INT) AS MinorVersionNumber
  FROM VersionStrings
)
SELECT
  CAST(MajorVersionNumber AS VARCHAR(3)) + '.' + CAST(MinorVersionNumber AS VARCHAR(3)) AS VersionString,
  RANK() OVER (ORDER BY MajorVersionNumber, MinorVersionNumber) AS ReleaseOrder
FROM VersionNumberComponents; 
```

但它提供了预期的结果：

```
VersionString ReleaseOrder
------------- --------------------
0.780         1
1.0           2
3.140         3
5.120         4
5.800         5
12.340        6 
```

正如[Tomtom 回答](https://stackoverflow.com/questions/11364242/how-to-compare-software-versions-using-sql-server#comment14972496_11364385)的那样，十进制不是存储版本号的好类型。最好将版本号存储在两个正整数列中，一个包含主要版本号，另一个包含次要版本号。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-02-24T08:40:38.030

这是基于 SeanW 的回答，但此解决方案允许以下格式 [major].[minor].[build]。它可能用于 SQL 2K 并且当光标不是一个选项时。

```
declare @v1 varchar(100) = '1.4.020'
declare @v2 varchar(100) = '1.4.003'

declare @v1_dot1_pos smallint   /*position - 1st version - 1st dot */
declare @v1_dot2_pos smallint   /*position - 1st version - 2nd dot */
declare @v2_dot1_pos smallint   /*position - 2nd version - 1st dot */
declare @v2_dot2_pos smallint   /*position - 2nd version - 2nd dot */

-------------------------------------------------
-- get the pos of the first and second dots
-------------------------------------------------
SELECT 
@v1_dot1_pos=CHARINDEX('.', @v1),
@v2_dot1_pos=CHARINDEX('.', @v2),
@v1_dot2_pos=charindex( '.', @v1, charindex( '.', @v1 ) + 1 ),
@v2_dot2_pos=charindex( '.', @v2, charindex( '.', @v2 ) + 1 )

-------------------------------------------------
-- break down the parts
-------------------------------------------------
DECLARE @v1_major int, @v2_major int
DECLARE @v1_minor int, @v2_minor int
DECLARE @v1_build int, @v2_build int 

SELECT 
    @v1_major = CONVERT(int,LEFT(@v1,@v1_dot1_pos-1)),
    @v1_minor = CONVERT(int,SUBSTRING(@v1,@v1_dot1_pos+1,(@v1_dot2_pos-@v1_dot1_pos)-1)),
    @v1_build = CONVERT(int,RIGHT(@v1,(LEN(@v1)-@v1_dot2_pos))),
    @v2_major = CONVERT(int,LEFT(@v2,@v2_dot1_pos-1)),
    @v2_minor = CONVERT(int,SUBSTRING(@v2,@v2_dot1_pos+1,(@v2_dot2_pos-@v2_dot1_pos)-1)),
    @v2_build = CONVERT(int,RIGHT(@v2,(LEN(@v2)-@v2_dot2_pos)))

-------------------------------------------------
-- return the difference
-------------------------------------------------
SELECT
    Case    
        WHEN @v1_major < @v2_major then 'v2 is newer'
        WHEN @v1_major > @v2_major then 'v1 is newer'
        WHEN @v1_minor < @v2_minor then 'v2 is newer'
        WHEN @v1_minor > @v2_minor then 'v1 is newer'
        WHEN @v1_build < @v2_build then 'v2 is newer'
        WHEN @v1_build > @v2_build then 'v1 is newer'
        ELSE '!Same'
    END 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-07-19T19:26:31.710

实施的解决方案：

```
CREATE FUNCTION [dbo].[version_compare]
(
    @v1 VARCHAR(5), @v2 VARCHAR(5)
)
RETURNS tinyint
AS
BEGIN
    DECLARE @v1_int tinyint, @v1_frc tinyint, 
            @v2_int tinyint, @v2_frc tinyint, 
            @ResultVar tinyint

    SET @ResultVar = 0

    SET @v1_int = CONVERT(tinyint, LEFT(@v1, CHARINDEX('.', @v1) - 1))
    SET @v1_frc = CONVERT(tinyint, RIGHT(@v1, LEN(@v1) - CHARINDEX('.', @v1)))
    SET @v2_int = CONVERT(tinyint, LEFT(@v2, CHARINDEX('.', @v2) - 1))
    SET @v2_frc = CONVERT(tinyint, RIGHT(@v2, LEN(@v2) - CHARINDEX('.', @v2)))

    SELECT @ResultVar = CASE
        WHEN @v2_int > @v1_int THEN 2
        WHEN @v1_int > @v2_int THEN 1
        WHEN @v2_frc > @v1_frc THEN 2
        WHEN @v1_frc > @v2_frc THEN 1
    ELSE 0 END

    -- Return the result of the function
    RETURN @ResultVar
END
GO 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-02-01T15:39:39.200

此递归查询会将任何 '.' 分隔的版本号转换为可比较的字符串，将每个元素左填充为 10 个字符，从而允许比较具有或不具有内部版本号的版本并适应非数字字符：

```
WITH cte (VersionNumber) AS (
  SELECT '1.23.456' UNION ALL
  SELECT '2.3'      UNION ALL
  SELECT '0.alpha-3'
  ),
  parsed (VersionNumber, Padded) AS (
  SELECT
    CAST(SUBSTRING(VersionNumber, CHARINDEX('.', VersionNumber) + 1, LEN(VersionNumber)) + '.' AS NVARCHAR(MAX)),
    CAST(RIGHT(REPLICATE('0', 10) + LEFT(VersionNumber, CHARINDEX('.', VersionNumber) - 1), 10) AS NVARCHAR(MAX))
  FROM cte
  UNION ALL
  SELECT
    SUBSTRING(VersionNumber, CHARINDEX('.', VersionNumber) + 1, LEN(VersionNumber)),
    Padded + RIGHT(REPLICATE('0', 10) + LEFT(VersionNumber, CHARINDEX('.', VersionNumber) - 1), 10)
  FROM parsed WHERE CHARINDEX('.', VersionNumber) > 0
  )
SELECT Padded
FROM parsed
WHERE VersionNumber = ''
ORDER BY Padded; 
```

* * *

```
Padded
------------------------------
0000000000000alpha-3
000000000100000000230000000456
00000000020000000003 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-07-01T22:37:20.027

这是我通过修改在 StackOverflow 上找到的一些代码并自己编写一些代码所做的。这是代码的第 1 版，所以请告诉我您的想法。使用示例和测试用例在代码注释中。

如果不使用 SQL 2016 或更高版本并且您无权访问 STRING_SPLIT，请首先创建此函数：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      <Author,,Name>
-- Create date: <Create Date,,>
-- Description: modified from https://stackoverflow.com/questions/10914576/t-sql-split-string/42000063#42000063
-- =============================================
CREATE FUNCTION [dbo].[SplitStringToRows]
(   
    @List VARCHAR(4000) 
    , @Delimiter VARCHAR(50)
)
RETURNS TABLE 
AS
RETURN 
(
    --For testing
    -- SELECT * FROM SplitStringToRows ('1.0.123','.')
    -- DECLARE @List VARCHAR(MAX) = '1.0.123', @Delimiter VARCHAR(50) = '.';

    WITH Casted AS
    (
        SELECT CAST(N'<x>' + REPLACE((SELECT REPLACE(@List,@Delimiter,N'§§Split$me$here§§') AS [*] FOR XML PATH('')),N'§§Split$me$here§§',N'</x><x>') + N'</x>' AS XML) AS SplitMe
    )
    SELECT ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS [Index]
    , x.value(N'.',N'nvarchar(max)') AS Part 
    FROM Casted
    CROSS APPLY SplitMe.nodes(N'/x') AS A(x)
) 
```

然后创建这个函数：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      Soenhay
-- Create date: 7/1/2017
-- Description: Returns -1 if VersionStringA is less than VersionStringB.
--              Returns 0 if VersionStringA equals VersionStringB.
--              Returns 1 if VersionSTringA is greater than VersionStringB.
-- =============================================
CREATE FUNCTION dbo.CompareVersionStrings
(   
    @VersionStringA VARCHAR(50)
    ,@VersionStringB VARCHAR(50)
)
RETURNS TABLE 
AS
RETURN 
(
    --CurrentVersion should be of the form:
    --major.minor[.build[.revision]] 
    --This is the same as the versioning system used in c#.
    --For applications the build and revision numbers will by dynamically set based on the current date and time of the build. 
    --Example: [assembly: AssemblyFileVersion("1.123.*")]//http://stackoverflow.com/questions/15505841/the-version-specified-for-the-file-version-is-not-in-the-normal-major-minor-b
    --Each component should be between 0 and 65534 ( UInt16.MaxValue - 1 )
    --Max version number would be 65534.65534.65534.65534

    --For Testing 
    -- SELECT * FROM dbo.CompareVersionStrings('', '')
    -- SELECT * FROM dbo.CompareVersionStrings('asdf.asdf', 'asdf.asdf') --returns 0
    -- SELECT * FROM dbo.CompareVersionStrings('asdf', 'fdas') --returns -1 
    -- SELECT * FROM dbo.CompareVersionStrings('zasdf', 'fdas') --returns 1 
    -- SELECT * FROM dbo.CompareVersionStrings('1.0.123.123', '1.1.123.123')  --Should return -1
    -- SELECT * FROM dbo.CompareVersionStrings('1.0.123.123', '1.0.123.123')  --Should return 0
    -- SELECT * FROM dbo.CompareVersionStrings('1.1.123.123', '1.0.123.123')  --Should return 1
    -- SELECT * FROM dbo.CompareVersionStrings('1.0.123.123', '1.0.124.123')  --Should return -1
    -- SELECT * FROM dbo.CompareVersionStrings('1.0.124.123', '1.0.123.123')  --Should return 1
    -- SELECT * FROM dbo.CompareVersionStrings('1.0.123.123', '1.0.123.124')  --Should return -1
    -- SELECT * FROM dbo.CompareVersionStrings('1.0.123.124', '1.0.123.123')  --Should return 1
    -- SELECT * FROM dbo.CompareVersionStrings('1.0', '1.1')  --Should return -1
    -- SELECT * FROM dbo.CompareVersionStrings('1.0', '1.0')  --Should return 0
    -- SELECT * FROM dbo.CompareVersionStrings('1.1', '1.0')  --Should return 1
    -- Declare @VersionStringA VARCHAR(50) = '' ,@VersionStringB VARCHAR(50) = '' ;
    -- Declare @VersionStringA VARCHAR(50) = '1.0.123.123' ,@VersionStringB VARCHAR(50) = '1.1.123.123' ;
    -- Declare @VersionStringA VARCHAR(50) = '1.1.123.123' ,@VersionStringB VARCHAR(50) = '1.1.123.123' ;
    -- Declare @VersionStringA VARCHAR(50) = '1.2.123.123' ,@VersionStringB VARCHAR(50) = '1.1.123.123' ;
    -- Declare @VersionStringA VARCHAR(50) = '1.1.123' ,@VersionStringB VARCHAR(50) = '1.1.123.123' ;
    -- Declare @VersionStringA VARCHAR(50) = '1.1.123.123' ,@VersionStringB VARCHAR(50) = '1.1.123' ;
    -- Declare @VersionStringA VARCHAR(50) = '1.1' ,@VersionStringB VARCHAR(50) = '1.1' ;
    -- Declare @VersionStringA VARCHAR(50) = '1.2' ,@VersionStringB VARCHAR(50) = '1.1' ;
    -- Declare @VersionStringA VARCHAR(50) = '1.1' ,@VersionStringB VARCHAR(50) = '1.2' ;

    WITH 
    Indexes AS
    (
        SELECT 1 AS [Index]
            , 'major' AS Name
        UNION
        SELECT 2
            , 'minor'
        UNION
        SELECT 3
            , 'build'
        UNION
        SELECT 4
            , 'revision'
    )
    , SplitA AS
    (
        SELECT * FROM dbo.SplitStringToRows(@VersionStringA, '.')
    )
    , SplitB AS
    (
        SELECT * FROM dbo.SplitStringToRows(@VersionStringB, '.')
    )
    SELECT
        CASE WHEN major = 0 THEN
                CASE WHEN minor = 0 THEN
                                    CASE WHEN build = 0 THEN
                                                        CASE WHEN revision = 0 THEN 0
                                                        ELSE revision END
                                        ELSE build END
                    ELSE minor END
            ELSE major END AS Compare
    FROM
    (
        SELECT 
             MAX(CASE WHEN [Index] = 1 THEN Compare ELSE NULL END) AS major
            ,MAX(CASE WHEN [Index] = 2 THEN Compare ELSE NULL END) AS minor
            ,MAX(CASE WHEN [Index] = 3 THEN Compare ELSE NULL END) AS build
            ,MAX(CASE WHEN [Index] = 4 THEN Compare ELSE NULL END) AS revision
        FROM(
            SELECT [Index], Name, 
                CASE WHEN A = B THEN 0
                    WHEN A < B THEN -1
                    WHEN A > B THEN 1
                    END AS Compare
            FROM
            (
                SELECT 
                     i.[Index]
                    ,i.Name
                    ,ISNULL(a.Part, 0) AS A
                    ,ISNULL(b.Part, 0) AS B
                FROM Indexes i
                    LEFT JOIN SplitA a
                ON  a.[Index] = i.[Index]
                    LEFT JOIN SplitB b
                ON  b.[Index] = i.[Index]
            ) q1
        ) q2
    ) q3

)
GO 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-11-11T14:48:13.187

我创建了（受 Eva Lacy 的启发（上图）），这个函数：

```
CREATE or alter function dbo.IsVersionNewerThan
(
    @Source nvarchar(max),
    @Target nvarchar(max)
)
RETURNS table
as 
/*
-1 : target has higher version number (later version)
0 : same
1 : source has higher version number (later version)

test harness:
; WITH tmp
AS
(
    SELECT '1.0.0.5' AS Version
    UNION ALL SELECT '0.0.0.0'
    UNION ALL SELECT '1.5.0.6'
    UNION ALL SELECT '2.0.0'
    UNION ALL SELECT '2.0.0.0'
    UNION ALL SELECT '2.0.1.1'
    UNION ALL SELECT '15.15.1323.22'
    UNION ALL SELECT '15.15.622.55'
)
SELECT tmp.version, isGreather from tmp
outer apply (select * from dbo.IsVersionNewerThan(tmp.Version, '2.0.0.0')) as IsG

*/ 
    return (
        select CASE 
            when cast('/' + @Source + '/' as hierarchyid) > cast('/' + @Target + '/' as hierarchyid) THEN 1 
            when @Source = @Target then 0
            else -1 
        end as IsGreather
    )
go 
```

测试脚本作为注释包含在内。**只要**您没有像“1.5.06.2”这样的版本（注意零），它就可以工作。
SQL Server 认为这个功能有`is_inlineable = 1`，这对性能来说是个好兆头。

然后我的 SQL 代码可以如下所示：

```
declare @version varchar(10) = '2.30.1.12'
set @version = '2.30.1.1'
if exists(select * from dbo.IsVersionNewerThan(@version,'2.30.1.12') where IsGreather >= 0)
BEGIN
    print 'yes'
end
else print 'no' 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-12-13T05:47:19.460

我会给你这个**最短**的答案。

```
with cte as (
    select  7.11 as ver
    union all
    select 7.6
)

select top 1 ver from cte
      order by parsename(ver, 2), parsename(cast(ver as float), 1) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-04-24T08:56:27.130

也许将内部版本号转换为一个值可以帮助理解构建版本之间的层次结构。

```
DECLARE @version VARCHAR(25), @dot1 AS TINYINT, @dot2 AS TINYINT, @dot3 AS TINYINT, @MaxPower AS TINYINT, @Value AS BIGINT
SELECT @version = CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR) --'14.0.1000.169' --'10.50.1600'
SELECT @dot1 = CHARINDEX('.', @version, 1)
SELECT @dot2 = CHARINDEX('.', @version, @dot1 + 1)
SELECT @dot3 = CHARINDEX('.', @version, @dot2 + 1)
SELECT @dot3 = CASE
    WHEN @dot3 = 0 THEN LEN(@version) + 1
    ELSE @dot3
END

SELECT @MaxPower = MAX(DotColumn) FROM (VALUES (@dot1-1), (@dot2-@dot1-1), (@dot3-@dot2-1)) AS DotTable(DotColumn)
SELECT @Value = POWER(10, @MaxPower)
--SELECT @version, @dot1, @dot2, @dot3, @MaxPower, @Value

SELECT 
--  @version AS [Build], 
    CAST(LEFT(@version, @dot1-1) AS INT) * POWER(@Value, 3) +
    CAST(SUBSTRING(@version, @dot1+1, @dot2-@dot1-1) AS INT) * POWER(@Value, 2) +
    CAST(SUBSTRING(@version, @dot2+1, @dot3-@dot2-1) AS INT) * @Value +
    CASE
        WHEN @dot3 = LEN(@version)+1 THEN CAST(0 AS INT)
        ELSE CAST(SUBSTRING(@version, @dot3+1, LEN(@version)-@dot3) AS INT)
    END AS [Value] 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-01-13T08:36:54.970

受@Sean 回答的启发，因为我需要它 4 个部分，所以我写了这个（它很容易模块化以获得更多，在代码末尾评论函数）：

```
CREATE OR REPLACE FUNCTION compareversions(v1 text,v2 text)
    RETURNS smallint
    LANGUAGE 'plpgsql'
    VOLATILE
    PARALLEL UNSAFE
    COST 100
AS $$
declare res int;
-- Set parts into variables (for now part 1 to 4 are used)
-- IMPORTANT: if you want to add part(s) think to add:
--   - Setting of part(s) to 0 in "Convert all empty or null parts to 0" below
--   - Proper tests in select/case below
-- IMPORTANT: do not use CAST here since it will lead to syntax error if a version or part is empty
-- v1
declare v1_1 text := split_part(v1, '.', 1);
declare v1_2 text := split_part(v1, '.', 2);
declare v1_3 text := split_part(v1, '.', 3);
declare v1_4 text := split_part(v1, '.', 4);
-- v2
declare v2_1 text := split_part(v2, '.', 1);
declare v2_2 text := split_part(v2, '.', 2);
declare v2_3 text := split_part(v2, '.', 3);
declare v2_4 text := split_part(v2, '.', 4);

begin
    -- Convert all empty or null parts to 0
    -- v1
    if v1_1 = '' or v1_1 is null then v1_1 = '0'; end if;
    if v1_2 = '' or v1_2 is null then v1_2 = '0'; end if;
    if v1_3 = '' or v1_3 is null then v1_3 = '0'; end if;
    if v1_4 = '' or v1_4 is null then v1_4 = '0'; end if;
    -- v2
    if v2_1 = '' or v2_1 is null then v2_1 = '0'; end if;
    if v2_2 = '' or v2_2 is null then v2_2 = '0'; end if;
    if v2_3 = '' or v2_3 is null then v2_3 = '0'; end if;
    if v2_4 = '' or v2_4 is null then v2_4 = '0'; end if;

    select
        case
        -------------
        -- Compare first part:
        --  - If v1_1 is inferior to v2_1 return -1 (v1 < v2),
        --  - If v1_1 is superior to v2_1 return 1 (v1 > v2).
        when CAST(v1_1 as int) < cast(v2_1 as int) then -1
        when CAST(v1_1 as int) > cast(v2_1 as int) then 1
        -------------

        -------------
        -- v1_1 is equal to v2_1, compare second part:
        --  - If v1_2 is inferior to v2_2 return -1 (v1 < v2),
        --  - If v1_2 is superior to v2_2 return 1 (v1 > v2).
        when CAST(v1_2 as int) < cast(v2_2 as int) then -1
        when CAST(v1_2 as int) > cast(v2_2 as int) then 1
        -------------

        -------------
        -- v1_1 is equal to v2_1 and v1_2 is equal to v2_2, compare third part:
        --  - If v1_3 is inferior to v2_3 return -1 (v1 < v2),
        --  - If v1_3 is superior to v2_3 return 1 (v1 > v2).
        when CAST(v1_3 as int) < cast(v2_3 as int) then -1
        when CAST(v1_3 as int) > cast(v2_3 as int) then 1
        -------------

        -------------
        -- Etc..., continuing with fourth part:
        when CAST(v1_4 as int) < cast(v2_4 as int) then -1
        when CAST(v1_4 as int) > cast(v2_4 as int) then 1
        -------------

        -- All parts are equals, meaning v1 == v2, return 0
        else 0
        end
        into res;

        return res;
end;
$$;
;

COMMENT ON FUNCTION compareversions(v1 text,v2 text)
    IS 'Function to compare 2 versions as strings, versions can have from 1 to 4 parts (e.g. "1", "2.3", "3.4.5", "5.6.78.9") but it is easy to add a part.
A version having less than 4 parts is considered having its last part(s) set to 0, i.e. "2.3" is considered as "2.3.0.0" so that comparing "1.2.3" to "1.2.3.0" returns "equal"). Indeed we consider first part is always major, second minor, etc ... whatever the number of part for any version.
Function returns:
    - -1 when v1 < v2
    - 1 when v1 > v2
    - 0 when v1 = v2
And, according to return value:
    - To compare if v1 < v2 check compareversions(v1, v2) == -1
    - To compare if v1 > v2 check compareversions(v1, v2) == 1
    - To compare if v1 == v2 check compareversions(v1, v2) == 0
    - To compare if v1 <= v2 check compareversions(v1, v2) <= 0
    - To compare if v1 >= v2 check compareversions(v1, v2) >= 0'
; 
```

有了这个，您还可以例如将版本“1.2”与“1.2.1”（将返回-1，v1 < v2）进行比较，因为“1.2”将被视为“1.2.0”，这不是通常的检查，但如果在一段时间内将数字添加到版本中，“1.2”实际上将被视为等于“1.2.0”。

而且它也可以很容易地为另一种版本格式进行调制，例如 XY-Z，v1_1 等......将是（未经测试，但你明白了）：

```
-- v1_1 = X
declare v1_1 text := split_part(v1, '.', 1);
-- tmp = Y-Z
declare tmp text := split_part(v1, '.', 2);
-- v1_2 = Y
declare v1_2 text := split_part(tmp, '-', 1);
-- v1_3 = Z
declare v1_3 text := split_part(tmp, '-', 2);
-- do the same for v2 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-12-20T11:33:27.203

@MartinSmith 答案最适合最多 5 位小数，但如果超过 5 位（这可能很少见）。这是我可以做的：

```
DECLARE @AppVersion1 VARCHAR(20) = '2.7.2.2.3.1'
DECLARE @AppVersion2 VARCHAR(20) = '2.7.2.2.4'

DECLARE @V1 AS INT = CASE WHEN LEN(@AppVersion1) < LEN(@AppVersion2) THEN CAST(REPLACE(@AppVersion2,'.','') AS INT) ELSE CAST(REPLACE(@AppVersion1,'.','') AS INT) END;
DECLARE @V2 AS INT = CASE WHEN LEN(@AppVersion1) < LEN(@AppVersion2) THEN CAST(REPLACE(@AppVersion1,'.','') AS INT) ELSE CAST(REPLACE(@AppVersion2,'.','') AS INT) END;

IF(LEN(@V2)< LEN(@V1))
    BEGIN
        SET @V2 = CAST( LTRIM(CAST(@V2 AS VARCHAR)) + ISNULL(REPLICATE('0',LEN(@V1)-LEN(@V2)),'') AS INT); 
    END;

SELECT CASE WHEN @V1 > @V2 THEN 'Y' ELSE 'N' END 
```

# php - 变量数组仅填充mysql表的最后一行

> ID：11364243
> 
> 赞同：1
> 
> 时间：2012-07-06T14:32:39.380
> 
> 标签：php

我正在回调 AnswerStatusID 和 AnswerResponse 的结果，需要将它们应用于变量以进行比较，以查看给出的答案是正确还是不正确以及答案的相应响应，我的问题是我的变量仅由表中的最后一行，而不是用所有数据填充它。

```
// Connect to the Database
require_once('mysqli_connect.php');

//create the query for the question
$q = "SELECT `Question` FROM tbl_Question WHERE QuestionID = 1";

//Create the query for the Answers
$q2 = "SELECT `Answer`,`AnswerStatusID`,`AnswerResponse` FROM tbl_Answer WHERE QuestionID = 1";

//Run the query
$r = mysqli_query($conn,$q);

//run the answer query
$r2 = mysqli_query($conn,$q2);

while($row = mysqli_fetch_array($r,MYSQLI_ASSOC)){
echo '<div id="Question1"><p>1) ' . $row['Question'] . '</div></p>';
}

while($row2 = mysqli_fetch_array($r2,MYSQLI_ASSOC)){
echo '<div id="Question1"><input name="q1" type="radio" value="'.$AnswerStatusID.'"/>' . $row2['Answer'] . '</div><br/>';

//Assign the AnswerStatusID to a var
$AnswerStatusID = $row2['AnswerStatusID'];

//Assign the AnswerResponse to a var
$AnswerResponse = $row2['AnswerResponse'];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:46:02.447

正如 Wiseguy 所暗示的，您似乎希望将 AnswerStatusID 和 AnswerResponse 作为数组。

这里有两步。首先将它们声明为数组。

```
$AnswerResponse = array();
$AnswerStatusID = array(); 
```

然后将值存储在每个值中

```
while($row2 = mysqli_fetch_array($r2,MYSQLI_ASSOC)){
    echo '<div id="Question1"><input name="q1" type="radio" value="'.$AnswerStatusID.'"/>' . $row2['Answer'] . '</div><br/>';

    //Assign the AnswerStatusID to a var
    $AnswerStatusID[] = $row2['AnswerStatusID'];

    //Assign the AnswerResponse to a var
    $AnswerResponse[] = $row2['AnswerResponse'];
} 
```

然后，您可以使用 var_dump(); 查看数组中的内容。

```
var_dump($AnswerResponse) 
```

或者

```
print_r($AnswerResponse) 
```

# actionscript-3 - 从 flex 4.1 迁移到 4.6 后字体看起来很奇怪

> ID：11364245
> 
> 赞同：1
> 
> 时间：2012-07-06T14:32:51.270
> 
> 标签：actionscript-3, apache-flex, fonts, flex4.6

我正在从 sdk 4.1 迁移到 4.6。现在字体看起来很奇怪。

**4.1**

![4.1](../Images/c78b82fcfe0c10a07df5b2bee12fca2c.png)

**4.6**

![4.6](../Images/ea44828618a45a2ffe3ff7a8375cf564.png)

您可以注意到，在 4.6 字体中看起来更流畅。字体声明：

```
@font-face {
    src: url("/assets/UNVR57X.TTF");
    fontFamily: myCFFFont;
    embedAsCFF: true;
    renderingMode: normal;
} 
```

我使用`s:Label`组件。

我都试过`renderingMode`了`true`和`false`。我怎样才能让它看起来像它在 4.1 中的样子？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T11:59:01.730

您要发布到 Flash Player 还是 AIR？

如果是 AIR，[这是在 AIR 中显示字体的一个错误](https://stackoverflow.com/questions/7242622/device-font-looks-different-in-flash-player-air)，也许是你的情况。

（此外，设置 cacheAsBitmap=true 会产生与您类似的效果）。

# c# - 我可以 Linq 查询到多个变量吗？

> ID：11364251
> 
> 赞同：3
> 
> 时间：2012-07-06T14:33:12.220
> 
> 标签：c#, sql, linq

我对 linq 有点陌生，我不确定我想要的是否可能。我基本上有一个名为 User 的类，其中包含一堆属性。我只想填写从查询中获得的名称和 ID 字段。我的查询为我提供了适当的结果，但我不确定如何将其输入用户。这是我得到的最接近的，但我意识到这是不正确的。

```
 IEnumerable<User> UserList;
 UserList = (from o in dbContext.application_user
             join p in dbContext.project on application_user.user_id = project.project_manager
             select o); 
```

这将返回 User_ID、Firstname 和 Lastname 的列表，但它不适合用户。我的用户类有多个变量，所以我想通过调用 3 个 int、string 和 string 类型的 IEnumerables 来接近它，如果我能以某种方式从一个查询中填充所有 3 个变量，然后设置 User = new User(name = x , id = x) 等。如

```
FNameList, LNameList, ID = *insert query here* 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-06T14:37:40.953

您可以`User`在 Linq 查询中构造对象：

```
IEnumerable<User> UserList;
UserList = (from o in dbContext.application_user
            join p in dbContext.project on application_user.user_id = project.project_manager
            select new User(o.FName, o.LName, o.ID)); 
```

这假设`User`有一个构造函数接受三个类似的参数，并且属性`o`是`FName`、`LName`和`ID`，但你明白了。该`select`子句可用于将结果转换为您需要的任何格式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:37:54.410

您可以`User`通过`Select`转换创建您的实例。

```
var userQuery = from o in dbContext.application_user
                join p in dbContext.project on application_user.user_id = project.project_manager
                select o;

IEnumerable<User> UserList = from o in userQuery.ToList()
                             select new User() {Name = o.Lastname, ID = o.user_ID}; 
```

我不知道你的`User`课是什么样子的，但你明白了。

# javascript - jQuery 随机图像推子

> ID：11364253
> 
> 赞同：0
> 
> 时间：2012-07-06T14:33:16.183
> 
> 标签：javascript, jquery

我有一个标题区域，它被划分为图像的块区域，这些图像绝对位于块内，并且都是不同的高度和宽度。

我有一个 URL /random-image?width=x&height=y&random=34234 生成随机图像以用于特定位置。

我希望这些图像随机淡出并更改为另一个随机图像，或者在单击时淡出。我已经让它工作了，除了“setTimeout”或“setInterval”只触发一次。我需要它处于无限循环中。

这是我的代码，任何想法：

```
jQuery(document).ready(function ($) {

$('#main-image img').live('click', function() {     
    var $image = $(this),
    width = $image.width(),
    height = $image.height(),
    random = Math.random();        

    $('<img src="/random-image?width='+width+'&height='+height+'&random='+random+'" />').hide().load(function() {
        $(this)
        .appendTo($image.parentsUntil('div.columns'))
        .fadeIn('slow', function() {
            $image.remove();
        });

    });        
});

$('#main-image img').each(function() {
    var $image = $(this),
    randVal = Math.round(5000 + Math.random()*(30000 - 5000)) ;

    setTimeout(function() {
        console.log($image.attr('src'));
        $image.trigger('click');
    },randVal);
});

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:52:26.717

您需要在淡入淡出结束时再次调用 setTimeout 函数。我能想到的最简单的方法是命名您正在使用的函数，然后从两个地方调用它，如下面的（完全未经测试的）版本：

```
jQuery(document).ready(function ($) {

var changeImage = function() {
    var $image = $(this),
    randVal = Math.round(5000 + Math.random()*(30000 - 5000)) ;

    setTimeout(function() {
        console.log($image.attr('src'));
        $image.trigger('click');
    },randVal);
};

$('#main-image img').live('click', function() {     
    var $image = $(this),
    width = $image.width(),
    height = $image.height(),
    random = Math.random();        

    $('<img src="/random-image?width='+width+'&height='+height+'&random='+random+'" />').hide().load(function() {
        var newImage = this;
        $(this)
        .appendTo($image.parentsUntil('div.columns'))
        .fadeIn('slow', function() {
            $image.remove();
            changeImage.call(newImage);
        });

    });        
});

$('#main-image img').each(changeImage);

}); 
```

# postgresql - 如何根据其他列的值和选择在 postgres 中创建列？

> ID：11364254
> 
> 赞同：14
> 
> 时间：2012-07-06T14:33:16.300
> 
> 标签：postgresql

我想在我的表中创建一个（或两个）新字段，它是其他字段的串联，这看起来相对简单。但是我用来帮助创建以下字段（和）的`case`语法或语法是什么？`if/when``GPA_TXT``newfield`

逻辑是：每个 GPA 应该是`#.#`，每个新字段应该是：

```
name & "-" & GPA_TXT & (
    case where GPA_TXT > 3.3
        set newfield = newfield & 'GradeA',
    case where GPA_TXT >2.7 and GPA_TXT < 3.3
        set newfield = newfield & "GradeB",
    etc...
) 
```

例如：

```
name         major     GPA(num) GPA_TXT   [newfield]
Bob          sci       2        02.0      Bob-sci-GradeC-02.0
Jane         chem      3.1      03.1      Jane-chem-GradeB-03.1
Charlie      phys      3.7      03.7      Charlie-phys-GradeA-03.7
Garfield     food      0        00.0      Garfield-food-GradeF-00.0 
```

所以我想我在这里有两个问题：

1.  如何创建 GPA TXT 字段。
2.  如何编写case语句根据其他字段的值计算一个字段。

如果有人可以将我链接到带有示例或解释的资源，我将不胜感激！我正在查看文档，但没有示例就无法到达任何地方。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-06T14:57:27.803

重要提示：我会根据您当前的表创建一个[视图并避免添加新列，因为它们会使您的架构非规范化。](http://www.postgresql.org/docs/current/interactive/sql-createview.html)[在这里](https://stackoverflow.com/a/724032/1154462)阅读更多。

此外，我将对所有标识符使用小写名称以避免引用。

*   要形成`GPA_TXT`字段，您可以使用[`to_char()`](http://www.postgresql.org/docs/current/interactive/functions-formatting.html)函数：（`to_char(gpa, 'FM09.0')`将`FM`避免结果字符串前面的空格）；
*   对于第二个字段，我会使用`GPA`而不是`GPA_TXT`用于数字比较。[您可以在docs](http://www.postgresql.org/docs/current/interactive/functions-conditional.html#FUNCTIONS-CASE)中查看有关`CASE`构造的更多信息，但该块可能是以下内容：

    ```
    CASE WHEN gpa >= 3.3 THEN 'A'
         WHEN gpa > 2.7 AND gpa < 3.3 THEN 'B'
         WHEN gpa > 0 THEN 'C'
         ELSE 'F' END 
    ```

*抱歉，我不知道每个 GPA 的成绩是如何分配的，请相应调整。*

视图的结果查询可能是（也在[SQL Fiddle](http://www.sqlfiddle.com/#!1/d54df/3)上）：

```
SELECT name,major,gpa,
       to_char(gpa, 'FM09.0') AS gpa_txt,
       name||'-'||major||'-Grade'||
  CASE WHEN gpa >= 3.3 THEN 'A'
       WHEN gpa > 2.7 AND gpa < 3.3 THEN 'B'
       WHEN gpa > 0 THEN 'C'
       ELSE 'F' END || '-' || to_char(gpa, 'FM09.0') AS adesc
  FROM atab; 
```

要构建一个视图，只需`CREATE VIEW aview AS`在此查询之前添加。

* * *

**编辑**

如果您仍然要添加列，则以下内容应该可以解决问题：

```
ALTER TABLE atab ADD gpa_txt text, ADD adesc text;
UPDATE atab SET
    gpa_txt = to_char(gpa, 'FM09.0'),
    adesc = name||'-'||major||'-Grade'||
      CASE WHEN gpa >= 3.3 THEN 'A'
           WHEN gpa > 2.7 AND gpa < 3.3 THEN 'B'
           WHEN gpa > 0 THEN 'C'
           ELSE 'F' END || '-' || to_char(gpa, 'FM09.0'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-07T14:21:26.070

我建议使用“生成”列，而不是冗余存储数据。它将占用更少的磁盘空间，这实际上可能比存储生成的值更快，并且肯定不会意外地与基础数据不同步。假设您喜欢@vyegorov 提供的格式，您可以创建这样的函数，使用表的记录类型（与表名匹配）作为输入：

```
CREATE FUNCTION adesc(rec atab)
  RETURNS text
  IMMUTABLE
  LANGUAGE SQL
AS $$
SELECT to_char($1.gpa, 'FM09.0') AS gpa_txt,
       $1.name||'-'||$1.major||'-Grade'||
  CASE WHEN $1.gpa >= 3.3 THEN 'A'
       WHEN $1.gpa > 2.7 AND $1.gpa < 3.3 THEN 'B'
       WHEN $1.gpa > 0 THEN 'C'
       ELSE 'F' END || '-' || to_char($1.gpa, 'FM09.0') AS adesc;
$$; 
```

您需要使用关系限定符（表名或别名）来引用它。当这样的引用没有通过查找实际列来解决时，PostgreSQL 将寻找一个将表的记录类型作为其唯一参数的函数。所以你可以做这样的事情：

```
SELECT name, major, gpa, atab.adesc
  FROM atab; 
```

这样一个“生成的列”可以在索引中用于快速搜索，如果那是你所追求的，就像`adesc(atab).*`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T15:27:40.987

这是从具有 3 列的表中返回值的查询：

```
select *
, to_char(gpa, '09.9') as gpa_text
, name || '-' || major || '-Grade' ||
case    when gpa between 3.5 and 4.0 then 'A'
    when gpa between 2.5 and 3.4 then 'B'
    when gpa between 1.5 and 2.4 then 'C'
    when gpa between 0.5 and 1.4 then 'D'
    else 'F' end
|| '-' || ltrim(to_char(gpa, '09.9')) as newfield
from students 
```

这是工作代码，这是 Bob 的新字段“Bob-sci-GradeC-02.0”

我强烈建议您在数据库中没有文本列来保存数值的副本。我不太清楚为什么我需要 ltrim，格式化的字符串会有一个前导空格似乎很奇怪。

# javascript - 如果选中了两个复选框，则条件在 jquery 中不起作用

> ID：11364257
> 
> 赞同：1
> 
> 时间：2012-07-06T14:33:20.803
> 
> 标签：javascript, jquery

我有两个广播组。我希望设置一个条件，如果选中 pRange (val=pRange) 并且 periodType 值为“一”、“二”或“三”，它会显示一个名为消息的 div。但我下面的 js 代码似乎不起作用。任何帮助深表感谢。

```
$("input[name$='periodType']").change(function() {
        var grpname = $(this).val();
        var pname = $("input:radio[name='mainPeriod']:checked").val();
        if (((grpname == "one") || (grpname == "two") || (grpname == "three")) && (pname=="pRange")) { 
                alert( pname + ' gname= ' + 'yes'); $('.message').show; 
        }
        else { 
                alert( pname + ' gname= ' + 'no'); 
        }
 }); 
```

第 1 组

```
<input type="radio" name="mainPeriod" id="pRange" val="pRange" />
<input type="radio" name="mainPeriod" id="pHour" val="pHour" />
<input type="radio" name="mainPeriod" id="pDay" val="pDay" />
<input type="radio" name="mainPeriod" id="pWeek" val="pWeek" />
<input type="radio" name="mainPeriod" id="pMonth" val="pMonth" /> 
```

第 2 组

```
<input type="radio" name="periodType" val="one" />
<input type="radio" name="periodType" val="two" />
<input type="radio" name="periodType" val="three" />
<input type="radio" name="periodType" val="four" />
<input type="radio" name="periodType" val="five" />

<div class="message" style="display:none;">Message</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:44:50.133

掀起了一个快速的小提琴[jsfiddle](http://jsfiddle.net/qjFuB/1/)

您的单选值写为 val="" 而不是 value="" 不知道这只是为了测试还是在您的实际代码中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:44:59.237

我检查了你的价值观的控制台

```
var grpname = $(this).val();
var pname = $("input:radio[name='mainPeriod']:checked").val(); 
```

两者都仅返回开/关，这会导致问题。你需要得到的是 .attr('val') 这样你就可以检查值

```
var grpname = $(this).attr('val');        
var pname = $("input:radio[name='mainPeriod']:checked").attr('val'); 
```

这是一个小提琴[http://jsfiddle.net/B9GyV/](http://jsfiddle.net/B9GyV/)

# bash - 命令在命令行中工作，但不是通过脚本

> ID：11364261
> 
> 赞同：0
> 
> 时间：2012-07-06T14:33:51.020
> 
> 标签：bash, shell, awk

```
cat test.txt
#this is comment
line 1
line 2
#this is comment at line 3
line4 
```

脚本：

```
result=`awk '/^#.*/ { print }' test.txt `

for x in $result
do
echo x
done 
```

预期输出：

```
#this is comment
#this is comment at line 3 
```

获取输出：

```
#this
is
comment
#this
is
comment
at
line
3 
```

但是当我执行这个命令时`awk '/^#.*/ { print }' test.txt`，我得到了预期的结果。我将其置于循环中，因为我需要一次捕获每个评论，而不是全部一起捕获。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:41:36.437

发生这种情况是因为`for x in $result`将遍历每个*单词*`$result`- 这就是要做的`for`事情。

试试这个：

```
echo "$result" | while read x; do
    echo "$x"
done 
```

`read`一次只取一条线，这就是你需要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:40:13.590

你的问题不是`awk`部分，而是`for`部分。当你这样做

```
for x in yes no maybe why not
do
   echo x
done 
```

你会得到

```
yes
no
maybe
why
not 
```

也就是说，`for`循环的列表自动以空格分隔。

我想，一种解决方法是将评论用引号括起来；然后`for`将每个引用的评论视为一个项目。legoscia 的修复（`read`在 while 循环中使用）对我来说似乎更好。

# perl - 打印间隔而不是时间戳

> ID：11364262
> 
> 赞同：0
> 
> 时间：2012-07-06T14:33:51.727
> 
> 标签：perl

以下代码以每 5 分钟为增量打印最高繁忙值。如何打印增量（例如 02:19:09 的 2:15）而不是时间戳？

```
my @maxima;  
    for my $record (@lastArray) {    
        my @fields = $record =~ /([^,\s]+)/g;   
        next unless @fields;    
        my @range = @fields[1..4];   
        $range[2] =~ s|(\d+):\d\d$|5*int($1/5)|e;   
        my $range = join ' ', @range;   
        my $value = $fields[5];    
        if (@maxima == 0 or $range ne $maxima[-1][0]) {     
            push @maxima, [$range, $value, $record];   
        }   
        else {     
            @{$maxima[-1]}[1,2] = ($value, $record) if $maxima[-1][1] > $value;   
        } 
    }  
    print $_->[2] for @maxima; 
```

电流输出：

```
 Mon,Jun,25,02:19:09,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,02:21:09,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,02:25:10,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,02:56:10,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,03:00:10,2012,999,1,1,0,0,0,0,0,0,0,0
Mon,Jun,25,03:08:10,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,03:10:10,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,03:24:11,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,03:37:11,2012,999,1,0,0,0,0,0,1,0,0,0
Mon,Jun,25,03:40:11,2012,999,1,0,1,0,0,0,0,1,0,0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T17:40:34.170

你需要提高你在指定问题方面的技能。您已经问了几个不同的问题来达到这一点，主要问题是您对问题的陈述不完整，或者它从一个问题变为下一个问题。

我仍然担心你总是把程序分成两半——输入的处理和输出的生成——我相信这两者可以结合在一起形成一个比你实现的更好、更可靠的解决方案方法。

这是我以前的答案之一的变体，可以满足我的要求。因为您只展示了程序的后半部分，所以我无法提供完整的解决方案。`@lastArray`此代码希望数据以与您已经使用的代码相同的方式呈现。

```
my @maxima;

for my $record (@lastArray) {    

    my @fields = split /,/, $record;
    next unless grep $_, @fields;    

    $fields[3] =~ s|(\d+):\d\d$|sprintf '%02d', 5*int($1/5)|e;
    $record = join ',', @fields;
    my $key = join ' ', @fields[1..4];
    my $value = $fields[5];

    if (@maxima == 0 or $key ne $maxima[-1][0]) {     
        push @maxima, [$key, $value, $record];   
    }   
    else {     
        @{$maxima[-1]}[1,2] = ($value, $record) if $maxima[-1][1] > $value;   
    } 
}  
print $_->[2] for @maxima; 
```

**输出**

```
Mon,Jun,25,02:15,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,02:20,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,02:25,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,02:55,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,03:00,2012,999,1,1,0,0,0,0,0,0,0,0
Mon,Jun,25,03:05,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,03:10,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,03:20,2012,999,1,0,1,0,0,0,0,1,0,0
Mon,Jun,25,03:35,2012,999,1,0,0,0,0,0,1,0,0,0
Mon,Jun,25,03:40,2012,999,1,0,1,0,0,0,0,1,0,0 
```

# java - 在java中解压缩在Visual Basic中压缩的字符串

> ID：11364263
> 
> 赞同：1
> 
> 时间：2012-07-06T14:33:51.393
> 
> 标签：java, vb.net, compression

我在尝试使用 DeflateStream 解压缩（在 Java 中）在 Visual Basic 中压缩的字符串时遇到问题。我做了一些研究，看到并尝试了很多使用 Inflater 和 InflaterOutputStream 在 Java 中解压缩的代码。找到的代码都没有成功。我浏览了很多网站，并在谷歌上搜索了很多方法。我可以说谷歌的前 3 页涉及 java、inflater/deflater 压缩、visual basic、deflaterStream 已经阅读，但没有成功。我想知道这件事是否可行（应该是因为我在这里找到了一种在 Java 和 C# 之间进行压缩/解压缩的方法：[http ://www.dreamincode.net/forums/topic/243808-compression-and-解压-java-and-c%23/](http://www.dreamincode.net/forums/topic/243808-compression-and-decompression-between-java-and-c%23/)) 我还想知道关于 Visual Basic DeflateStream 和 Java 模拟类 Inflater/Deflater 是否存在兼容性问题。如果有人有类似的问题，我也会非常感谢一些代码片段。

谢谢，米海

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:57:08.207

尝试在 Inflater 类中设置 nowrap 参数。

根据[文档](http://msdn.microsoft.com/en-us/library/system.io.compression.deflatestream%28v=vs.80%29.aspx)，.NET DeflateStream 生成原始的 deflate 格式，RFC 1951。我认为这就是您在 Visual Basic 中使用的格式。

此外，根据[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/zip/package-summary.html)，Java 的 Inflater 类对 zlib 格式 RFC 1950 进行解码。zlib 格式是包含 zlib 标头和尾标的原始 deflate 格式。通常，Inflater 类会在来自 .NET 的 DeflateStream 的原始 deflate 数据上失败。然而幸运的是，Inflater 类为构造函数提供了[nowrap 参数](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/zip/Inflater.html#Inflater%28boolean%29)（将设置为 true），这允许 Inflater 在没有 zlib 包装器的情况下解码原始 deflate 数据。

所以这应该有效。DeflateStream 产生的数据的前 20 个十六进制字节是多少？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T08:20:33.090

好的，所以我终于设法解决了这个问题。这是一个初学者错误，但我花了足够长的时间来解决它。问题的表现是，当我读取初始文件（已压缩和加密）时，我将文件的内容作为字符串保存在内存中，而不是直接将内容作为字节数组读取。当然，字符串编码不支持某些字节并且它们丢失了，这就是无法识别压缩格式的原因。Java 的 Inflater/Deflater 类与 vb.net 的 DeflateStream 类兼容！

非常感谢您的帮助和帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T15:32:17.373

根据我的阅读，java 的 deflate/inflate 使用 Zlib。VB用什么来膨胀？我没有用谷歌搜索这个，但一些参考资料似乎表明它使用 ZIP，没有 zlib。

您是否尝试过运行`file compressed_file`以确定它的压缩格式？

无论如何，您可能想尝试使用 apache commons 使用 ZIP 算法解压缩。

# c# - 每当使用异步时，ASP.Net MVC 4 控制器就会挂起

> ID：11364272
> 
> 赞同：9
> 
> 时间：2012-07-06T14:34:37.923
> 
> 标签：c#, asp.net-mvc, task-parallel-library, async-await

我正在使用带有 .Net 4.5 和 ASP MVC 4 RC 的 Visual Studio 2012 RC。每当我使用异步时，它都会挂起。控制器操作方法使用异步，但它本身不是异步控制器方法。

没有记录错误或抛出异常，但浏览器永远显示“Waiting for *www.myweb.local ”。*

```
// Simplest possible async
public class Waiter
{
    public async Task<int> GetValue()
    {
        await Task.Yield();
        return await Task.Factory.StartNew(() => 42);
    }
}

// simplest possible controller that uses the async
public class HomeController : Controller

    public ActionResult Index()
    {
        var waiter = new Waiter();
        var resultTask = waiter.GetValue();
        int result = resultTask.Result;

        // it never gets here 
        return View();
    }
} 
```

[我已经完成了这个答案](https://stackoverflow.com/a/10527055/5599)中提到的事情，但它仍然不起作用。IE。web.config 包含

```
<add key="aspnet:UseTaskFriendlySynchronizationContext" value="true"/> 
```

神奇的词`await Task.Yield();`在异步方法中。

.Net 框架版本是 4.5.50501。我在 IIS Express 和 IIS 6.0 上观察到了这种行为。

我尝试将“2012 年 7 月更新”应用到 VS2012，但这并没有解决它。

[这个答案表明](https://stackoverflow.com/a/9985803/5599)这可能是因为当我等待它时任务已经完成，但是如果是这种情况，这应该有效，但它不会：

```
public class Waiter
{
    public async Task<int> GetValue()
    {
        await Task.Yield();
        return await Task.Factory.StartNew(() => 
            {
                Thread.Sleep(1500);
                return 42;
            });
    }
} 
```

有几个人建议这样做`ConfigureAwait(false)`是必要的，但这段代码也不起作用：

```
 public async Task<int> GetValue()
    {
        var task = new Task<int>(() => 42);
        return await task.ConfigureAwait(false);
    } 
```

以下内容**适用**于剃刀视图引擎，但不适用于 spark。当然应该有办法让其他场景也能正常工作？不能在同步代码中使用异步任务吗？

```
public class Waiter
{
    public async Task<int> GetValue()
    {
        return await Task.Factory.StartNew(() => 42);
    }
}

public class HomeController : Controller
{
    public async Task<ActionResult> IndexAsync()
    {
        await Task.Yield();
        var waiter = new Waiter();
        int result = await waiter.GetValue();

        return View();
    }
} 
```

我知道这是不是发布的软件，但微软的 RC 通常相当稳定，所以我很惊讶它失败了，而且失败了无益的方式。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-06T20:10:53.880

你正在造成僵局，[就像这个问题一样](https://stackoverflow.com/questions/10343632/httpclient-getasync-never-returns-when-using-await-async/)。

James Manning 的建议是正确的，但您必须得到`await`的结果`ConfigureAwait`，如下所示：

```
public async Task<int> GetValue()
{
    var task = new Task<int> (() => 42);
    return await task.ConfigureAwait(false);
} 
```

一般来说，混合同步和异步代码是一个非常糟糕的主意，除非你真的知道你在做什么。使控制器动作异步会好得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:41:47.190

我已经在 beta 中进行了异步工作。我没有测试过，但我猜这是因为你的控制器方法不是异步的。将其更改为：

```
public async Task<ActionResult> IndexAsync()
{
    var waiter = new Waiter();
    int result = await waiter.GetValue();

    // it never gets here 
    return View();
} 
```

# jquery - 如何从 YouTube 视频中删除黑条

> ID：11364273
> 
> 赞同：2
> 
> 时间：2012-07-06T14:34:39.670
> 
> 标签：jquery, iphone, youtube-javascript-api

黑条出现在 YouTube 视频中，视频播放时看起来有点奇怪。我们可以从视频中删除那个黑色空间吗？我想删除该黑色空间并以我们为播放器大小选择的所需纵横比显示视频。现在我正在使用标准的谷歌 YT 播放器 API。

这有什么意义吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:36:57.890

[这就是您想要的——虽然您必须进行更多定制；它实现了您想要的功能](https://developers.google.com/youtube/youtube_player_demo)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:37:52.297

试试无铬播放器。

您可以在 javascript 中开发自己的控件 - 完全自定义。

# php - 无限重定向循环问题 htaccess

> ID：11364277
> 
> 赞同：1
> 
> 时间：2012-07-06T14:34:44.240
> 
> 标签：php, .htaccess, redirect

我正在尝试使用 htaccess 文件从一个 url 重定向到另一个。除了导致无限重定向循环的一个之外，我已经让它们全部工作了。我希望重定向的网址是：

[http://website.co.uk/author/](http://website.co.uk/author/)我想重定向到[http://website.co.uk/author/authorname](http://website.co.uk/author/authorname)

任何想法都会有所帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:41:16.210

听起来很像您的 .htaccess 重定向规则正在对您的域名进行模式匹配，因此当您重定向到`/jamescrawford`它时，它会匹配`www.pragencyone.co.uk/author/`并再次尝试重定向。

如果您试图捕获所有匹配的内容，`http://www.pragencyone.co.uk/author/.*`那么您需要排除`http://www.pragencyone.co.uk/author/jamescrawford`（以及可能使用的任何资产，如图像，如果它们位于同一目录中）与您正在使用的模式匹配。

您可以尝试发布您用于执行重定向的实际规则，但显然请确保不要发布任何来自您的 .htaccess 的任何会危及服务器安全的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:41:59.100

在你的 htaccess 文件中试试这个

```
 RewriteEngine On
 DirectoryIndex index.php
 AddDefaultCharset On
 Options +FollowSymLinks -Indexes

 RewriteRule ^author /author/jamescrawford [L]
 RewriteRule ^author/ /author/jamescrawford [L] 
```

# iphone - UIPanGestureRecognizer 和 2 个 UISwipeGestureRecognizers

> ID：11364283
> 
> 赞同：1
> 
> 时间：2012-07-06T14:34:55.813
> 
> 标签：iphone, objective-c, ios5

我有一个 UIPanGestureRecognizer 和 2 个 UISwipeGestureRecognizers 的视图（一个用于左侧，一个用于右侧）。

我遇到的问题是 UIPanGestureRecognizer 总是覆盖滑动。

我想要的是滑动应该覆盖平底锅......这可能吗，还是我需要找到不同的做事方式。

仅供参考 - 为了解释我为什么需要这个，我有一组要从牌组中抽出的牌。绘制的卡片会显示给用户（该卡片的艺术品）。现在，我需要向用户传递其他信息（卡名、详细信息等）。我基本上在 UIImageView 后面隐藏了一堆 UILabel，我更改了图像视图的 alpha 设置以显示文本。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T14:44:02.310

使用该`requireGestureRecognizerToFail:`方法确保一个识别器仅在另一个识别器失败后才被触发，因此在这种情况下：

```
[panGestureRecognizer requireGestureRecognizerToFail:swipeGestureRecognizer]; 
```

顺便说一句，您只需要 1 个滑动识别器，方向属性是一个位掩码，因此您可以将其设置为

```
swipeGestureRecognizer.direction = UISwipeGestureRecognizerDirectionLeft | UISwipeGestureRecognizerDirectionRight 
```

它会识别两个方向

# regex - SPARQL 正则表达式过滤器

> ID：11364285
> 
> 赞同：6
> 
> 时间：2012-07-06T14:35:02.757
> 
> 标签：regex, pattern-matching, rdf, sparql

我正在尝试使用正则表达式过滤器匹配 SPARQL 中的一个单词，但没有成功...：/我将查询发送到位于“http://dbtune.org/musicbrainz/sparql”的端点。好吧，以下查询有效：

```
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX mo: <http://purl.org/ontology/mo/>
SELECT ?artist ?name
WHERE {
    ?artist a mo:MusicArtist
    . ?artist foaf:name "Switchfoot"
    . ?artist foaf:name ?name
    . FILTER(regex(str(?name), "switchfoot", "i"))
} 
```

但是，如果我删除第 7 行 (. ?artist foaf:name "Switchfoot")，以下查询将不匹配：

```
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX mo: <http://purl.org/ontology/mo/>
SELECT ?artist ?name
WHERE {
    ?artist a mo:MusicArtist
    . ?artist foaf:name ?name
    . FILTER(regex(str(?name), "switchfoot", "i"))
} 
```

我不知道是我做错了什么还是端点的错误...

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-06T18:09:00.620

在您的第二个查询中，没有要索引的图形模式。查询处理器满足该查询的唯一方法是检索三重存储中*每个艺术家*的姓名，然后对每个艺术家应用正则表达式匹配。难怪您会遇到某种资源限制，无论是 CPU 时间还是运行时间。

如果您想做这样的自由文本搜索，我建议将数据集下载到本地端点，并使用自由文本索引，例如[LARQ](http://jena.apache.org/documentation/larq/index.html)。您的查询会更快，您的用户会感谢您！

# bash - Bash - 对变量的错误赋值

> ID：11364291
> 
> 赞同：3
> 
> 时间：2012-07-06T14:35:44.350
> 
> 标签：bash

我想做一个非常简单的脚本：只想在我的电脑上找到一个程序的最新版本，比如 svn。我想将结果加载到一个变量中，比如 mysvn

所以我制作了这个脚本：

```
 #!/bin/sh

mysvn="foobar"
best_ver=0
which -a svn | while read p
do
    version=$("$p" --version | grep 'version ' | grep -oE '[0-9.]+' | head -1)
    if [[ "$version" > "$best_ver" ]]
    then
        best_ver=$version
        mysvn="$p"
    fi
    echo $mysvn
done

echo $mysvn 
```

其实很简单……但是在XP下运行的rxvt（我的伪linux终端）版本2.7.10下不起作用：最终输出字符串是foobar。

有人知道我为什么会遇到这个问题吗？

过去几个月我一直在写一些脚本，这是我第一次遇到这种行为。

注意：我知道如何使它工作，只需进行一些更改（只需将主线放入 $() ）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:26:47.133

发生这种情况的原因是 while 循环是管道的一部分，并且（至少在 bash 中）管道中的任何 shell 命令总是在子 shell 中执行。当您在循环中设置 mysvn 时，它会在子shell中设置；当循环结束时，子shell 退出并且该值丢失。父 shell 的 mysvn 值永远不会改变。请参阅[BashFAQ #024](http://mywiki.wooledge.org/BashFAQ/024/)和[上一个问题](https://stackoverflow.com/questions/6255303/bash-piping-prevents-global-variable-assignment)。

bash 中的标准解决方案是使用进程替换而不是管道：

```
while
...
done < <(which -a svn) 
```

但请注意，这是一个仅限 bash 的功能，您*必须*将`#!/bin/bash`其用作 shebang 才能使其工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:54:07.627

在 Ubuntu 上：

```
:~$ which -a svn | while read p
> do
>   version=$("$p" --version | grep 'version ' | grep -oE '[0-9.]+' | head -1)
>   echo $version
> done
. 
```

所以，你的版本`.`不是很好。

我试过这个，我认为这就是你要找的：

```
:~$ which -a svn | while read p
> do
>   version=$("$p" --version | grep -oE '[0-9.]+' | head -1)
>   echo $version
> done
1.7.5 
```

# ruby-on-rails - Rails - 在选择中禁用选项（基于条件）

> ID：11364293
> 
> 赞同：3
> 
> 时间：2012-07-06T14:35:48.093
> 
> 标签：ruby-on-rails, select, helper

我有选择：

```
= f.select(:category_id, @categories, :html_options => {:class => 'select_box'}, {:disabled => true if category.id == 18}) 
```

上面这段代码显然会返回错误，但是如何根据 by 禁用选项`id`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T14:55:38.847

尚未对此进行测试，但在您的控制器中您不能这样做

```
@checkvar = @category.id == 18 ? true : false 
```

然后在视图中

```
f.select(:category_id, @categories, :html_options => {:class => 'select_box'}, {:disabled => @checkvar}) 
```

或者在模型中写一个函数来测试

```
def disable_select 
    if self.id == 18
        true
    else 
       false
    end
end 
```

然后在视图中

```
f.select(:category_id, @categories, :html_options => {:class => 'select_box'}, {:disabled => @category.disable_select}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-03T08:01:30.203

```
<%= f.select :status, STATUSES.map{|s| [s.titleize, s]}, { disabled: DISABLED_STATUSES.map{|s| [s.titleize, s]} %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-06T11:49:01.017

最近遇到了这个问题并使用了以下解决方案：

```
#view
= f.select(:category_id, @filtered_categories, :html_options => {:class => 'select_box'}

#controller
@filtered_categories = Category.all.select do |category|
  [logic here]
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-12T02:21:55.673

对于`select_tag`，我们可以这样做：

```
<%= select_tag "sample", options_for_select(
    [['A', 'a'], ['B', 'b'], ['C', 'c']]),
    {class: 'form-control', disabled: data.present? == false ? true : false}
%> 
```

# python - Python 的 .egg 格式是什么时候引入的？

> ID：11364295
> 
> 赞同：0
> 
> 时间：2012-07-06T14:35:58.343
> 
> 标签：python, setuptools

setuptools 的历史是什么？它的第一个版本支持该`.egg`格式是什么时候？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:43:09.943

我认为这是自[setuptools 0.6b1](http://pypi.python.org/pypi/setuptools/0.6b1)于 2006 年 5 月 12日发布以来。

从变更日志：

> 特色亮点：
> 
> * 创建`Python Eggs`_ -
> 单文件可导入分发格式

# hyperlink - 同步或链接打开的窗口？

> ID：11364297
> 
> 赞同：0
> 
> 时间：2012-07-06T14:36:06.530
> 
> 标签：hyperlink, synchronize

所以我想知道是否有办法同步或链接打开的窗口。例如，如果您有两个并排打开的 word 文档，如果您向上滚动其中一个，它将在另一个上滚动。我认为这很容易弄清楚，但我很难解决。甚至可能吗？任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:43:15.403

例如，在了解了如何从鼠标处理输入消息后，我有一种感觉，这不会是 Office 内置的东西。

我认为您可能可以通过编写一个小脚本来做到这一点，但我不相信会有切换此功能的选项。

# wpf - 如何更正我的设置，以便连接到 Web 服务

> ID：11364299
> 
> 赞同：1
> 
> 时间：2012-07-06T14:36:14.003
> 
> 标签：wpf, wcf, web-config

在 Visual Studio 2010 中，我正在尝试连接到我编写的 Web 服务。我正在尝试将 Web 服务项目包含在我的 WPF 解决方案中，以便我可以在必要时在本地进行调试，但是我也很乐意将 Web 服务发布到我的本地 IIS 并以这种方式连接到它。

这就是发生的事情。我在我的 WPF 解决方案中包含了 Web 服务项目，所以我有两个项目……WPF 和 WCF Web 服务。我尝试通过打开“添加服务引用”对话框并单击“发现”按钮来向我的 WPF 项目添加服务引用。在地址栏中，会出现这个 uri：

```
http://localhost:49185/MyAppSqlServerProvider.svc 
```

我在命名空间文本框中为服务命名，然后单击“确定”。然后，我收到以下错误：

System.InvalidOperationException：找不到与具有绑定 WSHttpBinding 的端点的方案 https 匹配的基地址。注册的基地址方案是 [http]。

这似乎是一个常见的错误。我发现了很多关于它以及如何解决它的帖子，但是我无法将这些解决方案应用于我的情况并让它们发挥作用。

这是我的 web.config 文件的相关部分

```
 <system.serviceModel>
<services>
  <service behaviorConfiguration="MyAppDataSync.MyAppSqlServerProviderBehavior"
    name="MyAppDataSync.MyAppSqlServerProvider">
    <endpoint address="" binding="wsHttpBinding" contract="MyAppDataSync.IMyAppSqlServerProvider" bindingConfiguration="wsHttpBindingConfiguration">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="http://localhost/MyAppSqlServerProvider/"/>
      </baseAddresses>
    </host>
  </service>
</services>
<behaviors>
  <serviceBehaviors>
    <behavior name="MyAppDataSync.MyAppSqlServerProviderBehavior">
      <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
      <serviceMetadata httpGetEnabled="true"/>
      <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
      <serviceDebug includeExceptionDetailInFaults="true"/>
    </behavior>
  </serviceBehaviors>
</behaviors>
<bindings>
  <wsHttpBinding>
    <binding name="wsHttpBindingConfiguration" maxReceivedMessageSize="10485760">
      <readerQuotas maxArrayLength="10485760" />
      <security mode="Transport">
        <transport clientCredentialType="None">
          <extendedProtectionPolicy policyEnforcement="Never" />
        </transport>
      </security>
    </binding>
  </wsHttpBinding>
</bindings>
<serviceHostingEnvironment multipleSiteBindingsEnabled="true" /> 
```

顺便说一句：我正在使用传输安全性，因为我需要为此服务使用会话。（例如：[ServiceContract（SessionMode = SessionMode.Required）]）

如果有人可以就我的设置中的错误向我提供建议，我将不胜感激。（为什么将“49185”端口号添加到本地主机地址？）

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:00:57.087

您需要更改您的基地址以指定“https”而不是“http”。

# php - Facebook getinfo 隶属关系只能检索大学？

> ID：11364303
> 
> 赞同：-1
> 
> 时间：2012-07-06T14:36:18.530
> 
> 标签：php, facebook-graph-api, facebook-fql

我试图使用 facebook 的 api 命令`users.getInfo`来检索用户（如果存在）的大学。这是我到目前为止所得到的。这是不正确的，但我相信我很接近：

```
$uid = $facebook->getUser();
$college = $facebook->api_client->users_getInfo($uid, user_education_history [type="college"); 
```

如需参考，请参阅此处：[https ://developers.facebook.com/docs/reference/api/user/](https://developers.facebook.com/docs/reference/api/user/)

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:26:42.320

您在这里使用了一些旧方法。这些`education_history`字段已被弃用，具有该`user.getInfo`方法的 RestAPI 也是如此。

一个更面向未来的方法是使用 FQL：

```
$fql = 'SELECT education FROM user WHERE uid = me()';
$ret_obj = $facebook->api(array(
               'method' => 'fql.query',
               'query' => $fql,
               ));
$schools = $ret_obj['data']['education'];
$colleges = array();
foreach ($schools as $s) {
   if ('College' == $s['type'])
      $colleges[] = $s['school']['name'];
} 
```

# c++ - 将排序范围插入关联容器的复杂性

> ID：11364320
> 
> 赞同：3
> 
> 时间：2012-07-06T14:37:15.203
> 
> 标签：c++, standards, complexity-theory, associative-array

该标准规定（23.4.4.2:5 等）如果范围已经排序，则从范围构造所有四个有序关联容器（ `map`、`multimap`、`set`、`multiset`）`[first, last)`应是线性的。`N = last - first`

然而，为了将范围（例如，相同类型的容器）合并到现有容器中，23.2.4:8 表 102 仅指定`insert`将范围`[i, j)`合并到容器中应具有复杂性`N log(a.size() + N)`where `N = distance(i, j)`。这似乎表明使用提示插入：

```
for (auto it = a.begin(); i != j; ++i)
    it = next(a.insert(it, *i)); 
```

可能比 更有效`a.insert(i, j)`，复杂性严格小于`N log(a.size() + N)`，具体取决于正确提示的比例（除了在 微不足道的情况下`N == 0`）；并且是*线性*的，因为每个提示都是正确的，如果`a`最初是空的。

这是标准的缺陷，还是有其他语言（或设施）涵盖这种情况？在实践中，实现是否优化了将有序关联容器合并到另一个容器中？

*感谢[https://stackoverflow.com/a/11362162/567292](https://stackoverflow.com/a/11362162/567292)启发了这个问题。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:46:15.307

我会假设在后一种情况下，该标准仅指定关联容器合并的最坏情况保证运行时性能，如果可能的话，让实现来寻找更快的性能捷径。请记住，与其他语言不同，C++ 规范正是如此——一个规范。没有“参考”实现。因此，一个人可以编写一个只满足某些性能标准的实现，或者一个人可以决定实现超过指定性能标准的特性。最后，尽管该规范旨在以某些算法的实现方式为您提供“至少”性能保证。

话虽如此，如果您总是对每个元素都使用提示，那么您在最坏情况下的性能实际上最终会比您在没有提示的情况下简单地插入慢两倍。所以总是使用提示不一定是灵丹妙药。

# android - Android：我的复选框“checkAll”不更新我的 ListView 的复选框项目

> ID：11364324
> 
> 赞同：-1
> 
> 时间：2012-07-06T14:37:32.720
> 
> 标签：android, listview, checkbox, unchecked

**我的情况：**一个带有按钮的活动、一个复选框 checkAll 和一个带有图像、名称、姓氏和复选框的自定义 ListView

**问题：**当我单击 checkAll 时，listView 不会更新 listView 中每个复选框的值（必须全部选中）。

这是我的带有 listView 的 MainActivity：

```
private final static int INFO_DIALOG = 1;
private ListView mList;
private CheckBox checkAll;
private Button buttonCreaPartita;
private Person[] people;
private int peopleSize;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.list_layout_select_friend);      

     mList= (ListView) findViewById(R.id.list);  //the listView 

     NewQAAdapterSelectFriends adapter= new NewQAAdapterSelectFriends(this); 
     //my adapter
     MainActivity.this.people = new Person[]{ //add person to my array of Person
            new Person(1,"Belen", "Rodriguez", R.drawable.belen,false),
            new Person(2,"Cameron", "Diaz", R.drawable.cameron,false),
            new Person(3,"Jessica", "Alba", R.drawable.alba,false),
            new Person(4,"Yolanthe", "Cabau", R.drawable.cabau,false), 
            new Person(5,"Belen", "Rodriguez", R.drawable.belen,false),
            new Person(6,"Cameron", "Diaz", R.drawable.cameron,false)
            };

     peopleSize=people.length;
     adapter.setData(people); //pass the array of person to my adapter
     mList.setAdapter(adapter);   //set the adpater   

    checkAll =(CheckBox)findViewById(R.id.checkBoxAll);//my CheckAll  checkbox
    checkAll.setChecked(false);//default value

    checkAll.setOnClickListener(new OnClickListener() { 
        @Override
        public void onClick(View v) {

            if((checkAll.isChecked())){

                for(int i=0;i<peopleSize;i++){
                    people[i].setCheck(true); 
                                   //update the new value on the array
                   ((BaseAdapter) mList.getAdapter()).notifyDataSetChanged() ; //i'll try to refresh the value of checkbox in the listview
                 }
            }

            else if(!(checkAll.isChecked())){
                for(int i=0;i<peopleSize;i++){                                                people[i].setCheck(false);
                                                ((BaseAdapter) mList.getAdapter()).notifyDataSetChanged() ;
                        }       
            }
        }
    });        
}

  buttonNext=(Button)findViewById(R.id.button);

    buttonNext.setOnClickListener(new OnClickListener() {
    //after user select the person on the list press buttonNext to go to next Activity
        @Override
        public void onClick(View arg0) {
            Person[] selectedFriends=new Person[peopleSize];
            int countSelected=0;
            for(int i=0;i<peopleSize;i++){
                if(people[i].isCheck()){            
                    selectedFriends[countSelected]=people[i];
                    countSelected++;
                }
            }
            Toast.makeText(getApplicationContext(), "Numero elemento:"+countSelected, Toast.LENGTH_SHORT).show();
            Intent intentMenu=new Intent(getApplicationContext(), MenuActivity.class);
            Toast.makeText(getApplicationContext(), "Partita Creata", Toast.LENGTH_LONG).show();
            startActivity(intentMenu);
        }
    }); 
```

这是我的带有 getView 函数（）的适配器：

```
 public class NewQAAdapterSelectFriends extends BaseAdapter {
private LayoutInflater mInflater;
private Person[] data;
boolean[] checkBoxState;
ViewHolder viewHolder;

public NewQAAdapterSelectFriends(Context context) { 
    mInflater = LayoutInflater.from(context);
}

public void setData(Person[] data) {
    this.data = data;
    checkBoxState=new boolean[data.length];
    for(int i=0;i<data.length;i++){
        checkBoxState[i]=data[i].isCheck();
    }
}

@Override
public int getCount() {
    return data.length;
}

@Override
public Object getItem(int item) {
    return data[item];
}

@Override
public long getItemId(int position) {
    return position;
}

@Override
public View getView(final int position, View convertView, ViewGroup parent) {
    if (convertView == null) {
        convertView = mInflater.inflate(R.layout.item_select_friends, null);
        viewHolder=new ViewHolder();

        viewHolder.nameText=(TextView) convertView.findViewById(R.id.personName);
        viewHolder.surnameText=(TextView) convertView.findViewById(R.id.personSurname);
        viewHolder.contactImage=(ImageView) convertView.findViewById(R.id.personImage);
        viewHolder.checkBox=(CheckBox)convertView.findViewById(R.id.checkBox);

        convertView.setTag(viewHolder);

    }
    else{
        viewHolder = (ViewHolder) convertView.getTag();
    }

    viewHolder.nameText.setText(data[position].getName());
    viewHolder.surnameText.setText(data[position].getSurname());
    viewHolder.contactImage.setImageResource(data[position].getPhotoRes());
    viewHolder.contactImage.setScaleType(ScaleType.FIT_XY);
    viewHolder.checkBox.setChecked(checkBoxState[position]);
    viewHolder.checkBox.setOnClickListener(new View.OnClickListener() {

           public void onClick(View v) {
               if(((CheckBox)v).isChecked()){
                   checkBoxState[position]=true;
                   data[position].setCheck(true);
               }else{
                   checkBoxState[position]=false;
                   data[position].setCheck(false);
               }
            }
        });
    viewHolder.checkBox.setChecked(checkBoxState[position]);
    return convertView;
}

static class ViewHolder {
    TextView nameText;
    TextView surnameText;
    ImageView contactImage;
    CheckBox checkBox;
    CheckBox checkAll;
}
} 
```

**有了日志，我确定当我单击 checkAll 我的所有项目都将它们的值更改为 true（选中），但这并没有显示在保持所有未选中状态的相对复选框上......**

感谢你的回答！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:48:15.600

我建议你像这样`Person []`通过你`Adapter`的构造函数：

```
public NewQAAdapterSelectFriends(Context context, Person[] p) { 
    mInflater = LayoutInflater.from(context);
    this.data = p; //set class level variable.
} 
```

从适配器中清除所有`boolean[] checkBoxState;`内容，因为您在 person 类 ie 中有状态引用`people.setCheck(true);`。所以不要像这样使用`checkBoxState`use `data[position].getCheck()`：

```
viewHolder.checkBox.setChecked(data[position].getCheck()); //to set check box state. 
```

也删除`setData(Person[] data)`方法，希望一切顺利。

# r - ggplot方面的单独排序

> ID：11364326
> 
> 赞同：8
> 
> 时间：2012-07-06T14:37:38.893
> 
> 标签：r, ggplot2

所以我有一个简单的例子——一个完全交叉的三处理三上下文实验，其中测量每个处理上下文对*的连续效果。*我想根据每种情况分别按效果订购每种治疗方法，但我坚持使用 ggplot 的刻面。

这是我的数据

```
df <- data.frame(treatment = rep(letters[1:3], times = 3),
                 context = rep(LETTERS[1:3], each = 3),
                 effect = runif(9,0,1)) 
```

如果我将处理和上下文合并为一个 9 分制的量表，我可以得到非常接近的结果，例如：

```
df$treat.con <- paste(df$treatment,df$context, sep = ".")
df$treat.con <- reorder(df$treat.con, -df$effect, )

ggplot(df, aes(x = treat.con, y = effect)) +
           geom_point() +
           facet_wrap(~context, 
                      scales="free_x",
                      ncol = 1) 
```

![非常接近我想要的](../Images/04e1744b9786291a283f98263390b769.png)

除了在每个方面实现单独排序之外，我创建的新 x 变量可能会产生误导，因为它没有证明我们在所有三种情况下都使用了相同的处理方式。

这是通过对潜在因素的一些操作来解决的，还是有针对这种情况的 ggplot 命令？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T15:16:21.633

分面并不是真正适合您想要做的事情的工具，因为它实际上是为*共享*尺度的情况而设计的。

单独制作每个图然后使用 gridExtra 包排列它们可能`grid.arrange`更有**意义**。（请注意，如果您不熟悉这些工具，以下代码可能看起来有点难以理解！）

```
#I use stringsAsFactors simply to ensure factors on
# my system.
df <- data.frame(treatment = rep(letters[1:3], times = 3),
                 context = rep(LETTERS[1:3], each = 3),
                 effect = runif(9,0,1),stringsAsFactors = TRUE)

require(gridExtra)
#One "master" plot (to rule them all)
p <- ggplot(df,aes(x = treatment,y = effect)) + 
        geom_point() + 
        facet_wrap(~context)

#Split data set into three pieces    
df_list <- split(df,df$context)
#...and reorder the treatment variable of each one
df_list <- lapply(df_list,function(x){x$treatment <- reorder(x$treatment,-x$effect); x})

#"Re-do" the plot p using each of our three smaller data sets
# This is the line that might be the most mysterious            
p_list <- lapply(df_list,function(dat,plot){plot %+% dat},plot = p)

#Finally, place all three plots on a single plot
do.call(grid.arrange,p_list) 
```

![在此处输入图像描述](../Images/c5d6a29de1c3b50f78aeca93d3082524.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-06T15:18:06.257

尝试：

```
ggplot(df, aes(x = treat.con, y = effect)) +
  geom_point() +
  facet_wrap(~context, scales="free_x", ncol = 1) +
  scale_x_discrete(labels=function(x) substr(x,1,1)) 
```

提供给`labels`参数的匿名函数对标签进行格式化。在旧版本的 ggplot2 中，您`formatter`为此使用了参数。如果您的治疗名称长度不同，则该`substr`方法可能效果不佳，但您可以使用`strsplit`，例如：

```
+ scale_x_discrete(labels=function(x) sapply(strsplit(x,"[.]"),"[",1)) 
```

# sql - 如何组合这两个表，以便我有一个同时显示州和邮政编码的表？

> ID：11364329
> 
> 赞同：0
> 
> 时间：2012-07-06T14:37:43.897
> 
> 标签：sql, sql-server, query-optimization

我有两个查询可以找到我们数据库中所有受访者的邮政编码和州。他们来了

对于邮政编码：

```
select top 100  S.ID as SurveyID, S.SID, S.SurveyNumber, S.ABCSurveyName, SE.RespondentID, Q.name as QuestionName, rp.Condition as ZipCode
from Surveys S 
    join Sessions SE 
        on S.id = SE.SurveyID 
    join RespondentProfiles rp
        on RP.RespondentID = SE.RespondentID
    join Questions Q 
        on Q.ID = rp.QuestionID
where q.name = 'ZIP'
        and S.ID = 13900
        and Q.LK_RecordStatusID = 1 
```

对于状态：

```
select VW.ID as SurveyID, VW.SID, SurveyNumber, ABCSurveyName, RespondentID, VW.Name as QuestionName, st.Code as State
from (
    select top 100 S.ID, S.SID, S.SurveyNumber, S.ABCSurveyName, SE.RespondentID, Q.name, rp.Condition 
    from Surveys S 
        join Sessions SE 
            on S.id = SE.SurveyID 
        join RespondentProfiles rp
            on RP.RespondentID = SE.RespondentID
        join Questions Q 
            on Q.ID = rp.QuestionID
    where S.ID = 13900
            and q.name = 'STATE'
            and Q.LK_RecordStatusID = 1

) VW
    join LK_States st
        on st.ID = vw.Condition 
```

这可行，但我想将它们全部放在一张表中，即邮政编码和州。

谢谢！

问题架构：

Column_name 类型 计算长度 Prec Scale Nullable

```
TrimTrailingBlanks  FixedLenNullInSource    Collation
ID  int no  4   10      0       no  (n/a)   (n/a)   NULL
SID nvarchar    no  128                 yes (n/a)   (n/a)   SQL_Latin1_General_CP1_CI_AS
Name    nvarchar    no  64                  yes (n/a)   (n/a)   SQL_Latin1_General_CP1_CI_AS
QuestionIdentifier  nvarchar    no  128                 yes (n/a)   (n/a)   SQL_Latin1_General_CP1_CI_AS
ParentID    int no  4   10      0       yes (n/a)   (n/a)   NULL
LK_QuestionTypeID   int no  4   10      0       yes (n/a)   (n/a)   NULL
LK_QuestionCategoryID   int no  4   10      0       yes (n/a)   (n/a)   NULL
LK_IndustryID   int no  4   10      0       yes (n/a)   (n/a)   NULL
OptionMask  nvarchar    no  512                 yes (n/a)   (n/a)   SQL_Latin1_General_CP1_CI_AS
MetaTags    ntext   no  16                  yes (n/a)   (n/a)   SQL_Latin1_General_CP1_CI_AS
Order   int no  4   10      0       yes (n/a)   (n/a)   NULL
Rows    int no  4   10      0       yes (n/a)   (n/a)   NULL
Columns int no  4   10      0       yes (n/a)   (n/a)   NULL
IsDisplay   bit no  1                   yes (n/a)   (n/a)   NULL
AnswerLifespan  int no  4   10      0       yes (n/a)   (n/a)   NULL
CreateUserID    int no  4   10      0       yes (n/a)   (n/a)   NULL
CreateDate  datetime    no  8                   yes (n/a)   (n/a)   NULL
UpdateUserID    int no  4   10      0       yes (n/a)   (n/a)   NULL
UpdateDate  datetime    no  8                   yes (n/a)   (n/a)   NULL
LK_RecordStatusID   bit no  1                   yes (n/a)   (n/a)   NULL
LK_QuestionClassID  int no  4   10      0       yes (n/a)   (n/a)   NULL
LK_QuestionVisibilityID int no  4   10      0       yes (n/a)   (n/a)   NULL
DisplayLK_QuestionTypeID    int no  4   10      0       yes (n/a)   (n/a)   NULL 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:46:02.047

在不完全了解您的结构的情况下，请尝试以下操作：

```
select top 100 
    S.ID, 
    S.SID, 
    S.SurveyNumber, 
    S.FEDSurveyName, 
    SE.RespondentID, 
    qState.name as QuestionName, 
    rp.Condition as ZipCode, 
    st.Code as State
from [Surveys] S
    inner join [Sessions] SE 
        on S.id = SE.SurveyID 
    inner join [RespondentProfiles] rp
        on RP.RespondentID = SE.RespondentID
    inner join [Questions] qState
        on qState.ID = rp.QuestionID
    inner join [Questions] qZip 
        on qZip.ID = rp.QuestionID
    inner join [LK_States] st
        on st.ID = rp.Condition
where 
    S.ID = 13900
    and qState.name = 'STATE'
    and qZip.name = 'ZIP'
    and qState.LK_RecordStatusID = 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T15:13:58.013

好吧，我没有花时间删除不必要的选定字段，但这是一个丑陋的查询，应该非常接近。本质上，您的“状态”查询无论如何都将大多数连接重新转换为子查询：

```
SELECT ... FROM
(SELECT ... FROM ... JOIN ... JOIN ... WHERE Q.Name = 'State') VW
JOIN LK_States ... 
```

我所做的只是添加一个额外的子查询以在顶层加入。我认为可能会有更有效的查询，但由于它是`SELECT TOP 100`，我不确定性能是否会成为问题。

```
SELECT ... FROM
(SELECT ... FROM ... JOIN ... JOIN ... WHERE Q.Name = 'State') VW
JOIN
(SELECT ... FROM ... JOIN ... JOIN ... WHERE Q.Name = 'Zip') VW2
ON VW2.SurveyID = VW.SurveyID
JOIN LK_States ... 
```

没有检查错误，但这是整个怪物：

```
select VW.SurveyID as SurveyID, VW.SID, VW.SurveyNumber, VW.FEDSurveyName, VW.RespondentID, VW.Name as QuestionName, st.Code as State, VW2.Condition as ZipCode
from (
    select top 100 S.ID as SurveyID, S.SID, S.SurveyNumber, S.FEDSurveyName, SE.RespondentID, Q.name, rp.Condition 
    from Surveys S 
        join Sessions SE 
            on S.id = SE.SurveyID 
        join RespondentProfiles rp
            on RP.RespondentID = SE.RespondentID
        join Questions Q 
            on Q.ID = rp.QuestionID
    where S.ID = 13900
            and q.name = 'STATE'
            and Q.LK_RecordStatusID = 1

    ) VW
    join (
    select top 100  S.ID as SurveyID, S.SID, S.SurveyNumber, S.FEDSurveyName, SE.RespondentID, Q.name, rp.Condition
    from Surveys S 
        join Sessions SE 
            on S.id = SE.SurveyID 
        join RespondentProfiles rp
            on RP.RespondentID = SE.RespondentID
        join Questions Q 
            on Q.ID = rp.QuestionID
    where q.name = 'ZIP'
            and S.ID = 13900
            and Q.LK_RecordStatusID = 1
    ) VW2
        on VW2.SurveyID = VW.SurveyID
    join LK_States st
        on st.ID = vw.Condition 
```

# visual-studio-2010 - 使用 Visual Studio 2010 遍历 Outlook 2010 中的收件箱项目

> ID：11364334
> 
> 赞同：2
> 
> 时间：2012-07-06T14:38:10.527
> 
> 标签：visual-studio-2010, outlook, add-in

我正在尝试为 Outlook 2010 编写一个加载项，它将遍历特定邮件文件夹中的所有项目并从那里自动填充 Excel 电子表格。目前，我什至无法访问默认收件箱。我正在从 Visual Studio 2010 Pro 编写加载项，并根据需要使用自动完成选项。我的问题是，每当我运行我的代码时，即使只是设置基本变量，它也会给我一个“找不到对象”错误并引发异常。我不知道出了什么问题，我将非常感谢任何帮助。

```
Imports Microsoft.Office.Interop

Public Class ThisAddIn

    Private Sub ThisAddIn_Startup() Handles Me.Startup
        Dim olApp As Outlook.Application
        Dim olNamespace As Outlook.NameSpace
        Dim olFolders As Object
        Dim olReadFolder As Outlook.Folder
        Dim readCollection As Microsoft.Office.Interop.Outlook.Items
        Dim currentMessage As Outlook.MailItem
        Dim exWorksheet As Excel.Worksheet

        olApp = New Outlook.Application
        olNamespace = olApp.GetNamespace("MAPI")
        'olFolders = olNamespace.Folders
        olReadFolder = olNamespace.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderInbox)     '<-- Add-in fails here

    End Sub

    Private Sub ThisAddIn_Shutdown() Handles Me.Shutdown

    End Sub

End Class 
```

# java - 我可以在 Java 对象中实现 Groovy 的 getProperty

> ID：11364335
> 
> 赞同：1
> 
> 时间：2012-07-06T14:38:10.080
> 
> 标签：java, groovy

我可以在 Java 对象中实现 Groovy 的 getProperty

我有一个混合的 Java/Groovy 项目，我正在尝试向我的 Java 对象添加一些“糖”以使 Groovy 端更干净。

是否可以`Object getProperty(String)`在 Java 类中实现并让 Groovy 在访问该实例的属性时看到它？

我有一个失败的测试用例如下：

```
// HasProperty.java
public class HasProperty {
    public Object getProperty(String name) {
        return "pie";
    }
}

// TestHasProperty.groovy
class HasPropertyTest {
    @org.junit.Test 
    public void testCanGetProperty() {
        def h = new HasProperty()
        assert h.name == "pie"
    }
} 
```

测试没有大张旗鼓地失败：

```
groovy.lang.MissingPropertyException: No such property: name for class: HasProperty
    at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.unwrap(ScriptBytecodeAdapter.java:50)
    at org.codehaus.groovy.runtime.callsite.GetEffectivePojoPropertySite.getProperty(GetEffectivePojoPropertySite.java:63)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callGetProperty(AbstractCallSite.java:227)
    at [...] 
```

这是 Groovy 1.8.6 和 Java 6。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T17:26:42.657

为了在不按照@tim_yates 的回答实现 GroovyObject 的情况下完成这项工作，您可以用一个非常简单的 groovy 对象包装该对象。例如：

```
class GroovyWrapper extends groovy.util.Proxy {
    def wrapped
    GroovyWrapper(obj) {
        wrapped = obj
        adaptee = obj
    }
    def getProperty(String name) {
        wrapped.getProperty()
    }
}

def h = new GroovyWrapper(new HasProperty())
assert h.name == "pie" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:47:25.193

我从未尝试过，但我相信如果你让你的 java 类[实现 GroovyObject](https://github.com/groovy/groovy-core/blob/GROOVY_1_8_X/src/main/groovy/lang/GroovyObject.java)或[扩展 GroovyObjectSupport](https://github.com/groovy/groovy-core/blob/GROOVY_1_8_X/src/main/groovy/lang/GroovyObjectSupport.java)，你应该能够向你的 Java 类添加一个 metaClass 和这种动态属性创建......

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-06T17:15:15.700

看看 Apache BeanUtils - [http://commons.apache.org/beanutils/](http://commons.apache.org/beanutils/)那里有一些非常有用的实用程序可以做这种事情。

# android - 在 GCMBaseIntentService 中显示吐司

> ID：11364336
> 
> 赞同：3
> 
> 时间：2012-07-06T14:38:15.760
> 
> 标签：android

我正在尝试实现推送通知客户端。我想在 onMessage(Context arg0, Intent arg1) 函数中显示祝酒词。

这是我的代码：

```
 public class GCMIntentService extends GCMBaseIntentService {
static Context c;
@SuppressWarnings("hiding")
private static final String TAG = "GCMIntentService";

public GCMIntentService() {
    super("717816998404");
    c = this.getBaseContext();
}

/**
 * Issues a notification to inform the user that server has sent a message.
 */

@Override
protected void onError(Context arg0, String arg1) {
    // TODO Auto-generated method stub

}

@Override
protected void onMessage(Context arg0, Intent arg1) {
    Log.d("GCM", "RECIEVED A MESSAGE");
    Log.d("GCM", "RECIEVED A MESSAGE");
    Log.d("GCM", "RECIEVED A MESSAGE");
    Log.d("GCM", "RECIEVED A MESSAGE");
    Log.d("GCM", "RECIEVED A MESSAGE");
    Log.d("GCM", "RECIEVED A MESSAGE");
    Log.d("GCM", "RECIEVED A MESSAGE");
    String str =arg1.getExtras().getString("PVAL");

    Log.i("PVAL",str);
    // I want to display a toast here

}

@Override
protected void onRegistered(Context arg0, String arg1) {
    // TODO Auto-generated method stub
    Log.i("TEST", arg1);
    Log.e("TEST", arg1);

}

@Override
protected void onUnregistered(Context arg0, String arg1) {
    // TODO Auto-generated method stub

} 
```

}

我想知道如何显示收到的消息我试图显示一个 toast 来检查消息。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-12T12:51:50.597

尝试这个：

```
Handler h = new Handler(Looper.getMainLooper());
       h.post(new Runnable(){

            public void run() {
                // TODO Auto-generated method stub
            Toast.makeText(arg0, arg1.getStringExtra("message"), Toast.LENGTH_LONG).show();
    }         
        }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T14:55:15.577

在 onMessage 方法中添加 toast 创建怎么样？像这样：

```
@Override
protected void onMessage(Context arg0, Intent arg1) {
   String str = arg1.getExtras().getString("PVAL");
   Toast.makeText(arg0, str, Toast.LENGTH_LONG).show();
} 
```

如果这不起作用，请按照 GCM 库中捆绑的 Demo 示例进行操作。演示示例在主活动中使用 BroadcastReceiver，接收器在 GCM 传入消息上显示对话消息。您可以改为将对话框显示更改为 toast 显示。

# android - 从任务管理器中杀死 android 应用程序会杀死应用程序启动的服务

> ID：11364342
> 
> 赞同：6
> 
> 时间：2012-07-06T14:38:40.003
> 
> 标签：android, android-activity, android-service

我的应用程序有一个启动两个服务但不绑定它们的活动。如果我选择返回按钮退出应用程序（我在任务管理器中看不到它），应用程序启动的两个服务都会继续运行。但是，如果我转到任务管理器并终止应用程序，这两个服务都会停止。我不确定这是否是预期行为，但我希望服务即使在应用程序退出后也能继续运行。请有任何想法。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-06T14:41:57.113

这是任务管理器的预期行为（并在 ManageApplication 中强制停止）。如果应用程序继续运行应用程序正在执行的后台工作，停止应用程序有什么好处？

您无法阻止用户在库存版本的 Android 操作系统上终止您的服务

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:42:10.400

[这是预期的行为。服务不在自己的进程中运行](http://developer.android.com/guide/components/services.html)。当您的应用程序被终止时，您的整个进程都会随之终止。

在我附加的文档中，向下一页有一个橙色块（不幸的是，我不认为我可以链接到它:-( ）简而言之，这将告诉您服务是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T15:13:34.253

我不知道！但是你应该试试[这个](https://stackoverflow.com/a/3856940/1436931)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-04T10:14:00.990

正如已经提到的，这是预期的行为。杀死启动服务的应用程序也应该杀死正在运行的服务。如果你想在应用程序被杀死时保持你的服务运行，你应该在一个单独的进程中启动服务，这可以通过在清单中的以下声明来实现：

```
<service
    android:name=".ServiceClassName"
    android:process=":yourappname_background" >
    ... 
```

参考：[https ://stackoverflow.com/a/15474347/1150795](https://stackoverflow.com/a/15474347/1150795)

请注意，通常应用程序不会被杀死，直到用户从任务/应用程序管理器中明确杀死它或系统由于资源有限、电池电量不足或类似原因而将其杀死。我不确定它是否是处理此类事情的典型用例，以及您是否真的需要关心它。

# jquery - 在foreach中使用jquery自动完成

> ID：11364344
> 
> 赞同：-2
> 
> 时间：2012-07-06T14:38:47.320
> 
> 标签：jquery, loops, autocomplete

我想在 foreach 循环中使用 jquery 自动完成功能。

使用 ids 时，只有第一行可以使用自动完成功能： [JSFiddle with IDs](http://jsfiddle.net/thebino/zBehW/2/)

第二种方法是使用类，但是会覆盖所有字段

我找到了第三个，它克隆了一些东西： [JSFiddle with clone](http://jsfiddle.net/thebino/5dzaK/1/)

如何更改第三个中的“描述”？或者有人有合适的 js/jquery 经验来解决我的问题？

我需要围绕线条的循环，因为线条是动态的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:11:43.877

为您的元素提供唯一的 id，并通过这些 id 选择元素。

[更新小提琴](http://jsfiddle.net/EA55T/1/)

# java - 密码的正则表达式

> ID：11364345
> 
> 赞同：1
> 
> 时间：2012-07-06T14:38:50.230
> 
> 标签：java, regex

我使用java和一个正则表达式。

我为密码验证制作了一个正则表达式：

```
String PASSWORD_PATTERN_ADVANCED = "^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[\\\\@#$¤£µ§%&<>,.!:?;~{-|`'_^¨éèçàù)=}()°\"\\]\\[²³*/+]).{8,20}$"; 
```

或没有额外的斜线：

```
^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[\\@#$¤£µ§%&<>,.!:?;~{-|`'_^¨éèçàù)=}()°"\]\[²³*/+]).{8,20}$ 
```

这意味着（我可能是错的）：至少一个数字/至少一个小写字母/至少一个大写字母/至少一个列出的特殊字符/最小总长度为 8，最大为 20...

做了一个测试用例生成成功和失败的密码......

成功 -> 好的，所有通过失败 -> 几乎可以...

唯一失败的密码：D 是其中有空格的密码，例如：

```
 iF\ !h6 2A3|Gm 
¨I O7 gZ2%L£k vd~39 
2< A Uw a7kEw6,6S^ 
cC2c5N#  
6L kIw~ Béj7]5 
ynRZ #44ç 
9A `sè53Laj A 
s²R[µ3  9UrR q8n 
```

我很困惑。

有什么想法让它起作用吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:49:53.837

我可能是错的，但如果你只是不想要空格，那么在你的前瞻中使用`[^\\s]`而不是。`.`

```
String PASSWORD_PATTERN_ADVANCED = 
         "^(?=[^\\s]*\\d)"
        + "(?=[^\\s]*[a-z])"
        + "(?=[^\\s]*[A-Z])"
        + "(?=[^\\s]*[\\\\@#$¤£µ§%&<>,.!:?;~{-|`'_^¨éèçàù)=}()°\"\\]\\[²³*/+])"
        + ".{8,20}$"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:17:27.603

正则表达式可能不是这里工作的正确工具。

正则表达式最适合匹配模式；您所描述的本身并不是真正的模式；它更像是一套规则。当然，您也许可以创建一些有用的正则表达式，但它是一段非常复杂且不透明的代码，使维护成为一项挑战。

像这样的方法可能更合适：

```
public boolean isValidPassword(String password) {
    boolean containsLowerCase;
    boolean containsUpperCase;
    boolean containsInvalid;
    boolean containsSpecialChar;
    boolean containsDigit;

    for(char c: password.toCharArray()) {
        containsLowerCase   ||= Character.isLowerCase(c);
        containsUpperCase   ||= Character.isUpperCase(c);
        containsDigit       ||= Character.isDigit(c); 
        containsSpecialChar ||= someMethodForDetectingIfItIsSpecial(c);

    }

    return  containsLowerCase &&
            containsUpperCase &&
            containsSpecialChar &&
            containsDigit &&
            !containsInvalid &&
            password.length >=8 && password.length <=20;

} 
```

您需要确定检测特殊字符（`specialCharArray.contains(c)`、正则表达式等）的最佳方法。

但是，这种方法会使添加新规则变得更加简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T14:46:13.567

您的任何条件都没有说明密码*中不能*包含的内容，只有*必须*的内容。您还需要一个条件来组合所有可能的有效字符并确保密码中的所有字符都在该列表中（即，`(\d|[a-z]|[A-Z]|@#$...){8,20}`作为最终条件）。或者是被拒绝的字符列表。

# xaml - WPF 树视图更新

> ID：11364347
> 
> 赞同：0
> 
> 时间：2012-07-06T14:38:52.100
> 
> 标签：xaml, binding, treeview, observablecollection

我必须在窗口中查看树视图。两个树视图都绑定到一个可观察的集合“ReportStructure”。

两个树视图都显示了可观察集合的树级分层结构。我使用一个树视图，T1。选择我想在第二个树视图 T2 中显示的节点。

第一个树视图在每个叶子上都有复选框，当我选中或取消选中叶子时，它会在 T2 中显示或隐藏。为了让我这样做，我必须像这样重新查询绑定的collectionview

```
 var IEquip = from eq in Report.Document.InspectionData.Equipments where eq.PartData.ReportIncluded = true
                     orderby eq.PartData.Order ascending
                     select eq;

        EquipmentView = CollectionViewSource.GetDefaultView(IEquip);
        EquipmentView.SortDescriptions.Add(
       new SortDescription("PartData.Order", ListSortDirection.Ascending)); 
```

上面的“ReportStructure”是 Report.Document.InspectionData.Equipments。

我的问题是，当我重新查询 T2 的数据上下文时，T1 中的所有节点都折叠了

我的 XAML 我已经明确设置了 updatesourcetrigger 但它仍然崩溃。

```
 <TreeView Grid.Row="5" IsEnabled="True" HorizontalContentAlignment="Stretch" Background="Transparent" BorderThickness="0"
    ItemsSource="{Binding ReportStructure, UpdateSourceTrigger=Explicit}"   HorizontalAlignment="Stretch"  /> 
```

克隆将是一个解决方案，但随后我失去了从 T1 中的信息更新 T2 而不传递克隆的可能性

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T18:16:21.430

我的理解是 TreeViewItem 不记得它是否在您执行重新查询时之前被扩展过？考虑将“IsExpanded”属性添加到“设备”类，然后将 TreeViewitem 的 IsExpanded 属性绑定到视图模型的属性。

# vba - 如何使用 VBA 从 Excel 数据集自动创建过滤列表？

> ID：11364354
> 
> 赞同：1
> 
> 时间：2012-07-06T14:39:35.687
> 
> 标签：vba, excel, excel-2007

我遇到了 Excel 2007 的问题，我找不到解决方案。我认为必须使用 VBA 来做到这一点，因为我对此非常缺乏经验。我在 Excel 中有一个包含 10 列的数据集（大约 1k 行）。在另一个选项卡/工作表中，我现在想显示按一列（国家代码）过滤的数据。它可以通过自动过滤来完成，但它应该更像一个报告，所以它必须看起来不错。

让我举例说明我的意思：

数据集

专栏 | 第 2 栏 | 第 3 栏

汉斯 | 德国 | 16

彼得 | 美国 | 29

玛丽亚 | 德国 | 30

达里安 | 美国 | 15

丽莎 | 德国 | 40

在另一个选项卡/工作表中，我现在想要一个基于此数据集的自动更新、格式化和过滤的列表，例如：

报告

*德国*

汉斯 | 16

玛丽亚 | 30

丽莎 | 40

*我们*

彼得 | 29

达里安 | 15

我希望你明白我的意思。如果我在我的数据集表中添加新的数据行，我希望报告能够自动更新（所以我不能只是自动筛选彼此下方的列表，因为所需的行数取决于数据点）。我认为使用 VBA 宏应该很容易做到这一点，但我不知道该怎么做......非常感谢帮助！

预先感谢！

*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T16:03:35.960

您是否尝试过结合动态命名范围的数据透视表？

鉴于上面的数据集设置在工作簿的 Sheet1 中，从 A1 开始，列名。请参阅以下解决方案。

1) 为您的数据集输入一个动态命名范围，如下所示。

![在此处输入图像描述](../Images/e62bbd0a310d485d6661bdb9a746822a.png)

这将确保添加到末尾或插入数据集中间的任何新数据都会被捕获并通过数据透视表刷新自动更新。

2) 将您的数据透视表基于命名范围。

![在此处输入图像描述](../Images/9ec635947a9b0f9068bc91ce8bd23926.png)

3）最后，设置您的数据透视表，如下所示。

![在此处输入图像描述](../Images/afd96a589b83b84c2484f9bf427c360e.png)

然后，您可以按照自己的喜好格式化数据透视表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T16:07:05.517

数据透视表可以执行您正在寻找的分组类型。使用您提供的数据，这是我从数据透视表中得到的：

![在此处输入图像描述](../Images/611d2af6ad246cd38295beaae2f784cc.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T16:07:36.880

我建议你看看数据透视表。它们可能有点复杂，但一旦你弄清楚它们是如何工作的，它们就会非常有用。

# algorithm - 对于我的数据集，我的模糊搜索方法会比使用 Lucene 更好吗？

> ID：11364355
> 
> 赞同：3
> 
> 时间：2012-07-06T14:39:35.667
> 
> 标签：algorithm, search, lucene, fuzzy-search, similarity

我想在我目前正在开发的网络应用程序中实现一个模糊搜索工具。后端是用 Java 编写的，碰巧这里大家推荐的搜索引擎[Lucene](http://lucene.apache.org/)也是用 Java 编写的。但是，出于以下几个原因，我回避使用它：

1.  我会觉得自己完成了一些事情。
2.  Lucene 有很多我认为自己没有使用的功能。我想尽量减少臃肿。
3.  据我了解，Lucene 的模糊搜索实现手动评估索引的每个术语的编辑距离。我觉得我想采取的方法（下文详述）会更有效。

要索引的数据可能是英语中的整组名词和代名词，所以你可以看到 Lucene 的模糊搜索方法让我感到厌烦。

我想要做的是采用基于 n-gram 的方法来解决这个问题：从数据库中读取和标记每个项目，并将它们保存到由给定 n-gram 及其位置命名的文件中的磁盘中。

例如：假设`n = 3`我的文件命名方案类似于：`[n-gram]_[location_of_n-gram_in_string].txt`.

该文件`bea_0.txt`将包含：

```
bear
beau
beacon
beautiful
beats by dre 
```

当我收到要搜索的术语时，我可以简单地将其标记为 n-gram，并使用它们及其相应的位置来读入相应的 n-gram 文件（如果存在）。然后，我可以对这组数据执行任何过滤操作（消除那些不在给定长度范围内的操作，执行编辑距离计算等），而不是对整个数据集执行此操作。

我的问题是……好吧，我想我有几个问题。

1.  Lucene 的模糊搜索是否有任何改进，我不知道这会使我的方法变得不必要？
2.  这是实现模糊搜索的好方法（考虑到我正在处理的数据集），还是我过于简化/遗漏了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T10:25:07.830

Lucene 3.x 模糊查询用于评估查询词与每个索引词之间的[Levenshtein](http://en.wikipedia.org/wiki/Levenshtein_distance)距离（蛮力方法）。鉴于这种方法效率相当低，Lucene 拼写检查器过去常常依赖类似于您所描述的内容：Lucene 将首先搜索与查询词具有相似 n-gram 的词，然后根据字符串距离对这些词进行评分（例如Levenshtein 或[Jaro-Winckler](http://en.wikipedia.org/wiki/Jaro%E2%80%93Winkler_distance)）。

然而，这在 Lucene 4.0 中发生了很大变化（[几天前已经发布了 ALPHA 预览版](http://search-lucene.com/m/TyoXHH3dKY)）：[FuzzyQuery 现在使用 Levenshtein 自动机来有效地与术语字典相交](http://blog.mikemccandless.com/2011/03/lucenes-fuzzyquery-is-100-times-faster.html)。这要快得多，以至于现在有一个新的[直接拼写检查器](https://builds.apache.org/job/Lucene-trunk/javadoc/suggest/org/apache/lucene/search/spell/DirectSpellChecker.html)，它不需要专用索引，并且可以直接将术语字典与自动机相交，类似于 FuzzyQuery。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T17:19:59.900

作为记录，当您处理英语语料库时，Lucene（或 Solr，但我想您可以在 vanilla lucene 中使用它们）有一些可能有用的语音分析器[（DoubleMetaphone、Metaphone、Soundex、RefinedSoundex、Caverphone）](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters/#solr.PhoneticFilterFactory)

Lucene 4.0 alpha 刚刚发布，现在很多东西更容易定制，所以你也可以在它的基础上创建一个定制的模糊搜索。

在任何情况下，Lucene 都有多年的性能改进，因此您几乎无法获得相同的性能。当然，对于您的情况，这可能已经足够了...

# c - 在安全方面使用 getenv

> ID：11364357
> 
> 赞同：0
> 
> 时间：2012-07-06T14:39:45.983
> 
> 标签：c

如果我`getenv()`用来禁用我的程序的某些验证（例如许可证检查），黑客是否能够轻松发现相关的环境变量（使用 strace 或其他？）

代码示例：

```
if (! getenv("my_secret_env_variable")) checkLicense(); 
```

（另一方面，如果我检查了特定文件的存在，黑客会立即使用 strace 看到它）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T15:11:04.297

让我补充现有的答案，让您对软件保护有更广泛的了解。

黑客不会只使用`strace`，他们会使用他们工具箱中的任何工具，但为了增加复杂性，也许只是*从*大多数情况下最简单的东西开始`strings`。我认识的大多数黑客天生就是懒惰的，因此会选择阻力最小的道路。（注意：我所说的*黑客*是指技术上非常熟练的人，*而不是破解者*——后者通常具有相同的技能组合，但具有不同的道德规范）。

一般来说，从逆向工程师的角度来看，几乎任何东西都可以“破解”或解决。问题是攻击者有多少时间和/或决心。考虑到一些学生可能只是为了搞笑而这样做，而一些“发布组”这样做是为了在他们的“场景”中成名。

让我们考虑一下硬件**加密狗**例如。大多数软件作者/公司认为他们在授权某些加密狗时会以某种方式神奇地“购买”安全性。但是，如果他们对系统的实施不小心，那么解决方法就像您的尝试一样简单。即使他们足够小心，通常仍然可以模拟加密狗，尽管提取加密狗上的信息需要一些技巧。一些加密狗（我不会对你隐瞒这个事实）因此是“智能的”，这意味着它们包含一个 CPU 甚至是一个成熟的嵌入式系统。如果软件产品的重要部分在加密狗上执行，并且所有进入加密狗的都是输入，而所有离开加密狗的都是输出，那么这就提供了很好的保护。但是，它在很大程度上同样会惹恼诚实的客户和攻击者。

或者让我们将**加密**作为另一个例子。许多开发人员似乎没有掌握公共密钥和密钥的概念，并认为将密钥“隐藏”在代码中会使其更安全。好吧，它没有。代码现在包含*算法和密钥*，这对攻击者来说有多方便？

大多数情况下的普遍问题是，一方面您信任用户（因为您向他们销售产品），但另一方面您不信任他们（因为您试图以某种方式保护您的软件）。当您以这种方式看待它时，您会发现它实际上是多么徒劳。大多数情况下，您会激怒诚实的客户，而只是稍微延迟攻击者（软件保护是二进制的：要么提供保护，要么不提供保护，即它已经被破解）。

相反，请考虑 IDA Pro 的制造商所走的道路。他们在用户获取所有二进制文件之前为其添加水印。然后，如果这些二进制文件被泄露，可以采取法律措施。即使不考虑采取法律措施，他们也可以羞辱（并且已经羞辱）那些公开泄露其产品的人。此外，如果您对泄漏负责，您将不会被出售任何软件升级，IDA 的制造商也不会与您的雇主开展业务。这是保护您的 IDA 副本安全的一个很大的动力。现在，我明白了，IDA 在某种程度上是一种利基产品，但该方法仍然有根本的不同，并且与保护软件的传统尝试没有相同的问题。

另一种选择当然是提供服务而不是软件。所以你可以给用户一个令牌，软件发送到你的服务器。然后，服务器基于解码令牌（我们假设它是加密消息）和检查有效性提供更新（或任何服务）。在这种情况下，用户只会收到令牌，而不会收到解密它的密钥，另一方面，您的服务器必须验证令牌。称其为产品密钥或其他任何名称，人们可以想象出几十种方式。关键是您不会同时陷入信任和不信任用户的矛盾中。您只会不信任用户，例如，如果她的令牌被滥用，您可以将其列入黑名单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:44:53.010

是的。在已编译的二进制文件中很容易发现任何硬编码的字符串。库调用也很容易看到。也可以将二进制文件中的字符串更改为其他内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-06T14:51:20.107

我们也可以`LD_PRELOAD`用`getenv`函数来显示参数receive

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-06T14:43:09.220

是的 - 容易。他们只是使用[字符串](http://unixhelp.ed.ac.uk/CGI/man-cgi?strings)来找出要尝试的内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-06T15:02:22.870

*黑客会立即用 strace 看到它*——也许你也应该看看`ltrace`？

虽然您可能无法隐藏变量名称，但为什么不要求一个值呢？特别是，您可以使用整数作为有效值 ( `atoi`)，因为它们在代码中更难发现，甚至是整数和单个字符的组合。但是请记住，环境块是内存中很容易找到的部分，尤其是在核心转储中。

# ios - 在 iPad 应用程序生成的 PDF 中嵌入自定义字体

> ID：11364359
> 
> 赞同：5
> 
> 时间：2012-07-06T14:39:51.530
> 
> 标签：ios, pdf, pdf-generation, embedded-fonts

**概述**

我正在使用自定义字体 Trade Gothic 的 iPad 应用程序中生成四页 PDF 文档。它正确嵌入到应用程序中，看起来很棒。

但是，该应用程序的一部分是通过电子邮件将 PDF 作为留下来的。此发送的文件将所有字体显示为默认 sans 类型，在一些系统上，我收到错误*无法找到或创建字体“RVYPRT+TradeGothicLTStd-Light”。某些字符可能无法正确显示或打印。*

我正在使用 UIKit 框架生成 PDF。这是使用相同过程的教程：http: [//www.ioslearner.com/generate-pdf-programmatically-iphoneipad/](http://www.ioslearner.com/generate-pdf-programmatically-iphoneipad/)

**我的问题**

如何将字体嵌入到 PDF 输出中，以便在发送后正确呈现为自定义字体而不是默认类型。

提前致谢！

**更新 1：**我发现了类似的未回答问题

[IOS在PDF中嵌入字体](https://stackoverflow.com/questions/8980388/ios-embed-font-in-pdf)

[iOS Quartz 在 pdf 中嵌入字体](https://stackoverflow.com/questions/9600085/ios-quartz-embed-font-in-pdf)

**更新 2：**有关字体的更多信息

字体[http://store1.adobe.com/cfusion/store/html/index.cfm?store=OLS-US&event=displayFont&code=TRDQ10003000](http://store1.adobe.com/cfusion/store/html/index.cfm?store=OLS-US&event=displayFont&code=TRDQ10003000)是一种 OpenType 字体，并且允许通过许可证嵌入。

此外，使用的默认字体是标准字体。

*如果 PDF 文件中缺少某些字体，Adobe Acrobat 和 Adob​​e Reader 将自动尝试使用这些程序中内置的多种主字体之一来模拟丢失的字体。这样，文档将不会完全按照设计者的要求呈现，但至少文本不会重排。用于此的 Multiple Master 字体是：**Adobe Serif MM**和**Adob​​e Sans MM***

来源： http: [//www.prepressure.com/pdf/basics/fonts](http://www.prepressure.com/pdf/basics/fonts)

**更新 3：** PDF 中引用了字体，但未嵌入

该应用程序似乎正在尝试嵌入字体，但它们没有被正确嵌入。这是 File -> Document Properties 下嵌入字体的屏幕截图：

![在此处输入图像描述](../Images/8c0857ac61d5534cfa1171cf5a0f61e5.png)

我看到的第一个问题是字体被列为 Type 1，而它实际上是 OpenType 字体。正如预期的那样，“实际字体”是 Sans MM（找不到嵌入字体时使用的字体。）

**更新 4：**在另一个 PDF（使用 Adob​​e，而不是 iPad 应用程序生成）中，所需的字体被嵌入为*子集*。我不确定，但这让我相信*应该*可以以编程方式做同样的事情。

![在此处输入图像描述](../Images/9e56941383b99bfc0acd5a5a7190054a.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T22:46:30.857

根据其许可，您正在使用且“看起来很棒”的字体*TradeGothic*不允许嵌入到 PDF（或其他）文档中。

*（为什么字体设计师会想要这样做超出了我的小脑袋。毕竟他们出售了将其用于文档的许可证，不是吗？——以及为什么 [正如我最近亲身经历的那样] 大公司会设计他们的企业形象围绕着一种这样的字体，但是“太便宜”并且只购买了不允许嵌入的字体许可证，因此迫使他们的员工向他们的客户发送糟糕的 PDF 只会让这个故事更加疯狂......）*

从您的第二次更新中可以看出，您已经发现了这一事实。

您似乎误解的是“文档属性”屏幕截图：

1.  OpenType 字体有不同的风格。有些使用（内部）TrueType 整形技术，有些使用 Type1/PostScript 方法。这就解释了为什么您看到它被声明为 Type1。
2.  不，该应用程序不会***“*** *尝试嵌入字体（但这样做不正确）”*。似乎很***尊重***字体文件中的*“不嵌入”标志，它设置了这个限制。*
3.  那些发出*“无法找到或创建字体 'RVYPRT+TradeGothicLTStd-Light' 的警告。某些字符可能无法正确显示或打印”*的 PDF 接收系统并没有错。他们简直...

    *   ...没有在本地安装该字体，或者
    *   ...没有可用的 Adob​​e Multiple Master 字体技术，或者
    *   ...不要使用 Adob​​e Reader 或 Acrobat（其中*包含*MM 内容）。

我的简单建议，多年来在我的客户面前重复了数百次：

1.  **始终在 PDF 中嵌入所有字体。**（除非你有充分的理由不这样做，并且知道后果。）
2.  **永远不要购买（或使用）不允许嵌入的字体。**（如果您不知道如何检查您当前的字体，请针对该问题获得一些专业建议。）

* * *

**更新：**

基本上，“嵌入标志”可以表示四个（重要的）不同级别的限制。（实际上，这个标志只适用于 TrueType 和 OpenTypes，而不适用于更老式的 PostScript Type1 字体。从技术上讲：这个标志的名称是*fsType*，它是一个*位掩码*，它包含在**OS/2** TrueType 和 OpenType 字体表....）

这些级别指定类型铸造厂允许在文档中嵌入字体的位置、时间和目的（不仅是 PDF，还包括 Word、OpenOffice 或任何其他文档类型：

1.  **不允许嵌入。**
    您可以在安装了字体的系统上创建一个电子文档，您可以对其进行编辑和查看。啊，您也可以打印它：Adobe PostScript 打印机驱动程序将在 PostScript 文件中包含打印所需的所有字体元素。但就是这样。
2.  **预览和仅打印嵌入。**
    文档嵌入了字体，并且可以使用原始字体查看文档（即使在文档接收系统上）。但是你不能用它做很多其他事情（例如没有文档编辑）。它使整个文档只读+打印。可以将内容复制并粘贴到另一个文档中，但它不会使用（甚至传输）受限字体。
3.  **可编辑嵌入。**
    可以编辑文档（在接收系统上）。但是，此操作的确切成功取决于是否嵌入了*完整*字体或*子集。*如果您的子集意外不包含“i”，则不能添加评论“白痴！” 到文件，你可能需要限制自己“傻瓜！”....
4.  **可安装嵌入。**
    这里没有限制。嵌入的字体甚至可以被提取并安装在接收系统上。*（曾经有一段时间，如果接收方计算机上的 Word 文档中没有任何嵌入文档的字体，Microsoft 会自动安装它。）*然而，这个选项没有实际意义：**没有**“常规”应用程序提供任何一种提取方法或安装嵌入式文档字体。

字体的“嵌入”标志可能表明还有两个（不太重要的）限制：

*   **不允许子集**（上述其他限制可能独立适用。）
*   **仅位图嵌入**（不能嵌入轮廓数据。）

Adobe 软件在许多情况下，当字体本身根本不包含**fsType**标志时，会将这种字体视为允许*仅打印 + 预览嵌入*的字体。

有关此主题的详细信息，请参阅[**有关“第三方开发人员的字体嵌入指南”的 Adob​​e 白皮书**](http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/FontPolicies.pdf)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T16:00:59.537

是否可以将嵌入的字体更改为允许嵌入的另一种字体？

# orchardcms - Orchard - 查询内容项中的自定义字段

> ID：11364367
> 
> 赞同：2
> 
> 时间：2012-07-06T14:40:13.567
> 
> 标签：orchardcms, custom-fields

我有一个带有自定义字段“NewsDate”（DateTimeField）和“Active”（BooleanField）的内容类型“News”

现在我需要通过 NewsDate 获得 3 个活跃的 atimes 订单描述

获取所有新闻，将它们设为 toList() 并从那里操作数据不是解决方案。

PS我需要做类似的事情：

```
 var items = contentManager
            .Query(Entities[PageType.Press])
            .OrderByDescending<CommonPartRecord, DateTime?>(record => record.PublishedUtc)
            .Slice(0, 3); 
```

但不是 PublishedUTC，而是使用我的自定义字段“NewsDate”并添加 Active == true，但是由于 Orchard 架构将自定义数据作为 XML 数据存储在单独的字段中，这是不可能的。

**更新：** 简而言之，我想从以下查询后面的代码生成：

```
DECLARE @temp as TABLE(id int, xmldata xml)
INSERT @temp VALUES(1,'<Data><News><NewsDate>07/14/2011 11:42:00</NewsDate><Link Title="" DisplayText="" Link="www.example.com" OpenInNewTab="True">www.example.com</Link></News></Data>')
INSERT @temp VALUES(2,'<Data><News><NewsDate>07/11/2011 12:11:00</NewsDate><Link Title="" DisplayText="" Link="www.example.com" OpenInNewTab="True">www.example.com</Link></News></Data>')
INSERT @temp VALUES(3,'<Data><News><NewsDate>02/21/2012 16:56:00</NewsDate><Link Title="" DisplayText="" Link="www.example.com" OpenInNewTab="True">www.example.com</Link><NewsLink></NewsLink></News></Data>')

SELECT  
 TOP 3 [id],
[xmldata].value('(Data/News/NewsDate)[1]', 'datetime') as NewsDate
FROM @temp
ORDER BY NewsDate DESC 
```

PS我查看了DynamicContentQueryTests的代码，但是所有示例都使用Part，在我的情况下，字段只是在ContentItem中：例如新闻内容类型包含NewsDate字段（日期时间字段）和一些部分

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T23:40:55.027

要获取直接附加到 Content Item 的字段的值，您需要首先查找与该项目同名的 Content Part，它是由 Orchard 创建的。因此，在您的情况下，在`Parts`每个新闻内容项的列表中，您会找到一个名为“NewsPart”的部分，在此`Fields`属性中将包含您的`NewsDate`和`Active`字段。

但是，就像您说的那样，Orchard 将字段值序列化为 XML 进行存储，以防止每次向内容类型添加/删除字段时都必须更改数据库结构。因此，不建议按字段查询和排序，因为每个 Content Item 都需要对所有序列化数据进行反序列化。如果您希望能够做到这一点，最好的方法是使用 Content Part Record 制作自己的 Content Part 并使用自己的表进行存储，那么您可以这样做：

`contentManager.Query<NewsPart, NewsPartRecord>()...`

...并查询/排序您喜欢的任何值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T05:40:00.177

从 1.4 开始，可以通过 Projector 和基础索引表以及 Content Manager 上的新 API 查询字段。实际上，您最简单的选择可能是创建一个投影。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T01:20:47.240

Bertrand is correct. Check this link : [http://www.davidhayden.me/blog/projector-module-in-orchard-cms](http://www.davidhayden.me/blog/projector-module-in-orchard-cms). You can implement your requirements easily with Projection Module. The link will tell you the steps to do that. If you don't want a widget, you can create a page with your query too. Once the module is enabled, you will see the option to create a Projection Page in the left hand side navigation.

![enter image description here](../Images/1276bb2cc922c70350c7e6cd2a8c5886.png)

EDIT :

Can't you simply parse the XML? You can query your content type 'News'. Something like -
`var contentItems = contentManager.Query<ContentPart>("News").Join<TitlePartRecord>().Join<AutoroutePartRecord>().Join<CommonPartRecord>().List();`

Once you have that, you can access the XML data by :

```
foreach (var item in contentItems)
  {
    var contentItem = (ContentItem)item.ContentItem;
    ContentItemVersionRecord contentItemRecord = contentItem.VersionRecord; 
    string data = contentItemRecord.Data; 
    //Call some function here to parse 'data' and store the object in the list. 
  } 
```

'data' has the information in XML format that you need. You can parse it and then store the objects in your list that you can order by your custom field.

# winforms - C++ CLI KeyDown::raise 错误 error C3767 候选函数不可访问

> ID：11364370
> 
> 赞同：0
> 
> 时间：2012-07-06T14:40:19.597
> 
> 标签：winforms, events, event-handling, compiler-errors, c++-cli

我有一个包含三个实体的场景：

*   具有一个方法存根的接口
*   继承自 `System::Windows::Forms::NativeWindow` 并实现接口的类
*   具有类类型的私有成员和接口类型的公共属性的包装类。此类还有一个“KeyDown”事件成员，该成员将从窗口类中调用/引发

这些是我正在使用的文件：

*INativeWindow.h*

```
#pragma  once
public interface class INativeWindow
{
    void Nothing();
}; 
```

*CLINativeWindow.h*

```
#pragma  once
ref class NWHolder;
public ref class CLINativeWindow : System::Windows::Forms::NativeWindow, INativeWindow
{
public:
    NWHolder^ Parent;
    virtual void  Nothing() sealed;
    void DoIt();
}; 
```

*CLINativeWindow.cpp*

```
#include "stdafx.h"
#include "CLINativeWindow.h"

void CLINativeWindow::Nothing()
{
    Console::Write("None");
}
void CLINativeWindow::DoIt()
{
    Parent->KeyDown(this, nullptr);
}; 
```

*NWHolder.h*

```
#pragma  once
#include "INativeWindow.h"
#include "CLINativeWindow.h"

public ref class NWHolder
{

internal:
    event System::Windows::Forms::KeyEventHandler^ KeyDown;
public:
    virtual property INativeWindow^ OwnNativeWindow
    {
        INativeWindow^ __clrcall get() sealed;
        void __clrcall set(INativeWindow^ value) sealed; 
    }

private:
    CLINativeWindow^ nativeWindow_;
}; 
```

*NWHolder.cpp*

```
#include "stdafx.h"
#include "NWHolder.h"

INativeWindow^ NWHolder::OwnNativeWindow::get()
{
    return nativeWindow_;
}

void NWHolder::OwnNativeWindow::set(INativeWindow^ value)
{
    nativeWindow_ = dynamic_cast<CLINativeWindow^>(value); 
} 
```

在**编译**时，我收到此错误： `Error 1 error C3767: 'NWHolder::KeyDown::raise': candidate function(s) not accessible ..\NativeWindows\CLINativeWindow.cpp 10`

有什么可以做的吗？我什至尝试过，`#pragma make_public(System::Windows::Forms::KeyEventHandler)`但失败了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T01:01:24.367

C++/CLI 事件的“raise”内部方法总是声明为受保护的。在 NWHolder 上添加一个名为“FireKeyDownEvent”的方法，并为其提供您喜欢的任何可访问性。

# linux - Wifi 不会在 BeagleBone 上熬夜

> ID：11364372
> 
> 赞同：6
> 
> 时间：2012-07-06T14:40:29.917
> 
> 标签：linux, networking, wifi, beagleboard

我在 BeagleBone 上运行 Ubuntu 11.10，并将 Edimax EW-7711UAn wifi 适配器插入 USB 端口。我已经配置了 /etc/network/interfaces 并且 wifi 工作正常，但是：

1.  wlan0 接口在启动设备时并不总是出现。它成功地出现了大约三分之一的尝试。

2.  界面有时会再次出现故障，尤其是在一段时间不使用时。

/etc/network/interfaces 文件包括：

```
auto wlan0
    iface wlan0 inet dhcp
    wpa-driver wext
    wpa-ssid "Bodoni"
    wpa-psk "<mypassword>" 
```

为了尝试解决第 1 点），我将以下内容放入 /etc/rc.local：

```
nohup sh -c "ifdown wlan0 && ifup wlan0" 
```

但这似乎并没有太大帮助。我猜第二个问题可能与电源管理有关，所以我可能会尝试在 /etc/rc.local 中将其关闭。

但是有人对我如何让 wifi 在启动时可靠地启动有任何想法吗？我正在运行没有以太网的无头 BeagleBone（它在机器人上），所以修复这个问题很重要！

仅供参考，我使用的是默认驱动程序 - lsmod 给出：

```
Module                  Size  Used by
aes_generic            27837  2 
arc4                    1111  2 
rt2800usb              12386  0 
rt2800lib              45146  1 rt2800usb
crc_ccitt               1457  1 rt2800lib
rt2x00usb              10595  1 rt2800usb
rt2x00lib              39077  3 rt2800usb,rt2800lib,rt2x00usb
mac80211              228509  3 rt2800lib,rt2x00usb,rt2x00lib
cfg80211              167722  2 rt2x00lib,mac80211
rfkill                 16703  1 cfg80211
binfmt_misc             6224  1 
spidev                  4620  0 
```

我希望不必编译新的驱动程序，因为我没有取得太大的成功！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T07:33:55.700

I've had a similar problem with my BeagleBones using another wifi adapter using the rt2800usb driver. Specifically I am using a DLINK DWA-125 (HW Rev A2) which is based on the rt3070 chip.

Same exact symptoms that you are reporting if I plug the DWA-125 directly into the USB port on the BeagleBone.

BUT if I plug the adapter into a USB extension cable and then plug the extension cable into the BeagleBone USB port, everything works fine. I have done 100s of hours of Cloud9 development using this setup and no problems with Wifi whatsoever.

I am running the Angstrom distro - and I find the same issue on all three of last BB releases (4/22\. 5/? and 6/18).

Length of USB extension cable doesn't seem to matter (at least between 1ft and 12ft - haven't tried anything below 1ft.)

I have 6 BeagleBones (4 ver A5 and 2 ver A6) - behavior is the same on all of these Beaglebones.

Also have 4 DWA-125 Rev A2 USB adapters - behavior is the same on all of these.

I have not experimented with other USB Wifi Adapters using the same or other chips/drivers. And I haven't spent the time to track down the root cause of this behavior - I have code to write!

But, give it a try in case your experience matches mine - its a quick and easy 'fix'.

---- Addendum:

I just tried an experiment with the Belkin N150 Micro USB Wifi Adapter - based on the rtl8192cu chip and the standard drivers that come with the 6/18 BeagleBone Angstrom distribution.

Got very similar behavior: The Wifi doesn't work at all when plugged directly into the USB port. But when plugged in via a 1ft USB extension cable, everything works fine.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-23T18:09:44.567

我有同样的问题。到目前为止我发现的最好的解释是[这个来自 Adafruit](https://learn.adafruit.com/downloads/pdf/setting-up-wifi-with-beaglebone-black.pdf)

主要想法是 Wifi 加密狗被位于 USB 插槽下方的 HDMI 适配器破坏。在这种情况下，您有两种解决方法：

1.  通过电缆将 Wifi-dongle 尽可能远离 USB 插槽
2.  如果您真的不需要，请禁用 HDMI 接口！

只有第二个选项帮助了我。

以下是步骤：

```
> mkdir /mnt/boot
> mount /dev/mmcblk0p1 /mnt/boot
> nano /mnt/boot/uEnv.txt

Remove the # in front of the cape_disable command

##Disable HDMI
cape_disable=capemgr.disable_partno=BB-BONELT-HDMI,BB-BONELT-HDMIN 
```

我希望它会帮助你们！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T13:46:49.660

我通过移除 USB ESD 尖峰保护 IC（U10、TPD4S012）解决了这个问题。它应该连接在 USB 连接器和 CPU 之间，但它放置在我的板上的 USB 连接器之后（版本 A4）。我不知道这是否在以后的修订中得到解决。

更新：在某些情况下这不会有太大帮助。检查[这个](https://groups.google.com/forum/?fromgroups=#!topic/beaglebone/UPERscSdoEk)线程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-07T00:03:05.570

一年中的大部分时间我都遇到了类似的问题，直到我用谷歌搜索了足够长的时间才能找到

wicd

在使用 wicd 进行设置后，我的 5 个 beaglebone 在我的家庭网络上的 wifi 加密狗上从后卧室到车库一直坚如磐石。/etc/network/interfaces 不是要走的路。我一定尝试了数百种配置，有些配置似乎可以持续一两天。我记得文档为接口提供了一个很好的默认值，非常准系统。如果需要，wicd 会运行您的请求者。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-09T15:37:08.637

我花了很长时间才在 BeagleBone 上获得可靠的 WiFi。最后，答案是使用 Atheros 加密狗，因为我在使用 RealTek 和 RALink 芯片组时运气不佳。NetGear WNA1100 在 Angstrom 和 Ubuntu 中对我来说都非常可靠。[在这里](https://groups.google.com/forum/?fromgroups=#!category-topic/beagleboard/software/9KCIs7yqsa8)查看我的帖子。

# c# - 元数据中的 CultureInfo - MVC ASP.NET - C#

> ID：11364373
> 
> 赞同：1
> 
> 时间：2012-07-06T14:40:34.517
> 
> 标签：c#, asp.net-mvc, label, metadata, cultureinfo

我需要在货币字段中设置与其他人不同的文化信息。

元数据：

```
 [Display(ResourceType = typeof(Expressions), Name = "PriceInEuro")]
    [DisplayFormat(DataFormatString = "{0:C}", ApplyFormatInEditMode = false)]
    [Required(ErrorMessageResourceType = typeof(Messages), ErrorMessageResourceName = "TheFieldXIsRequired")]
    public double PriceInEuro { get; set; } 
```

看法：

```
 <div>
       @Html.LabelFor(model => model.QuoteEntity.Price)
       <span class="display">@Html.DisplayFor(model => model.QuoteEntity.Price, System.Globalization.CultureInfo.CreateSpecificCulture("en-US"))        </span>
    </div> 
```

我的应用程序默认使用 CultureInfo US (en-US)，但此字段应以 REAL 格式 (pt-BR) 显示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:11:38.000

模型上的新属性怎么样？

```
public string PriceInReal
{
    get
    {
         CultureInfo cultureInfo = CultureInfo.GetCultureInfo("pt-BR");
         return String.Format(cultureInfo, "{0:C}", Price);
    }
} 
```

# mysql - CakePHP MySQL 视图

> ID：11364376
> 
> 赞同：1
> 
> 时间：2012-07-06T14:40:54.143
> 
> 标签：mysql, cakephp, views, cakephp-2.1

我们正在尝试分析帐户以构建我们想要与其他帐户进行比较的数据。为此，我们使用 Mysql 视图。我想知道如何使用 CakePHP

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T04:03:32.180

MySQL 中的视图很像一张表。因此，您可以通过使用查询调用它来获取视图中的数据：

```
$this->AnyModelName->query("SELECT * FROM my_view_1 WHERE 1"); 
```

您也可以尝试编写一个最初`$this->useTable`设置为 false 的模型。然后，如果您为此类定义自己的构造函数，则每次都可以使用不同的视图对其进行初始化。检查模型文档：[API](http://api20.cakephp.org/class/model) & [Book](http://book.cakephp.org/2.0/en/models.html)。

# html - asp.net 中的离线应用程序

> ID：11364377
> 
> 赞同：0
> 
> 时间：2012-07-06T14:40:56.250
> 
> 标签：html, caching, offline-caching, cache-manifest

我正在尝试创建一个具有离线功能的应用程序。我创建的清单文件如下所示 -

```
CACHE MANIFEST 
# version 1.0.0

CACHE:
/ShareBill.Web-Offline/
/ShareBill.Web-Offline/Groups
/ShareBill.Web-Offline/Content/Site.css
/ShareBill.Web-Offline/Content/jquery-ui.css
/ShareBill.Web-Offline/Scripts/ShareBill.js
/ShareBill.Web-Offline/Scripts/lib/jquery-1.7.2.min.js
/ShareBill.Web-Offline/Scripts/lib/jquery-ui.min.js
/ShareBill.Web-Offline/Scripts/TransactionsIndex.js
/ShareBill.Web-Offline/Content/Images/ajax-loader.gif
/ShareBill.Web-Offline/Content/Images/br_down_icon.png

NETWORK: 
/ShareBill.Web-Offline/Transactions/Filters 
```

我期望的是当我查看此 url /ShareBill.Web-Offline/Groups 时。我的浏览器不应向服务器发出任何请求，否则离线的全部目的将无效。

但正如我使用 fiddler 所观察到的那样，每次我刷新页面时，浏览器都会请求清单文件。我确保我在 Chrome 开发工具中看到了缓存的资源。

现在，当我关闭 IIS 并发出这样的请求时，我最终将 AppCache 状态设置为 OBSOLETE。然后在下一页刷新时，我得到 404 响应。我在实施方面遗漏了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:20:55.310

我将 Expires 标头应用于请求 Manifest 文件的请求。这有效:)

# google-app-engine - Ant构建成功，无法显示servlet

> ID：11364378
> 
> 赞同：-1
> 
> 时间：2012-07-06T14:41:03.333
> 
> 标签：google-app-engine, servlets, ant

我正在努力解决：

[http://developer.android.com/guide/google/gcm/demo.html#server-setup](http://developer.android.com/guide/google/gcm/demo.html#server-setup)

安装ant，下载appengine sdk，以管理员身份运行cmd，输入：

```
ant -Dsdk.dir=C:\appengine-java-sdk-1.7.0 -Dserver.host=10.0.19.185 
```

在示例目录。

我获得了构建成功，但仍然无法连接到该站点：

```
http://10.0.19.185:8080/home 
```

如教程中所述。

我哪里失败了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T10:28:20.033

您忘记键入 runserver 命令，尝试 ant -Dsdk.dir=C:\appengine-java-sdk-1.7.0 **runserver** -Dserver.host=10.0.19.185

# redirect - 在 netty 中处理 HTTP 302 临时移动请求

> ID：11364379
> 
> 赞同：4
> 
> 时间：2012-07-06T14:41:05.940
> 
> 标签：redirect, netty, http-status-code-302

我正在使用 netty http 客户端使用 netty 获取 url。但是，对于一些重定向到其他页面的 url，我无法使用我的客户端获取最终页面的内容。我想知道如何在我的响应处理程序中处理 302 重定向。

下面是我的响应处理程序的 messageReceived 函数中使用的代码。

```
@覆盖
公共无效消息接收（ChannelHandlerContext ctx，MessageEvent e）抛出异常{
        如果（！readingChunks）{
            HttpResponse 响应 = (HttpResponse) e.getMessage();

            System.out.println("状态：" + response.getStatus());
            System.out.println("版本：" + response.getProtocolVersion());
            System.out.println();

            if (!response.getHeaderNames().isEmpty()) {
                for（字符串名称：response.getHeaderNames()）{
                    for（字符串值：response.getHeaders（名称））{
                        System.out.println("标题：" + name + " = " + value);
                    }
                }
                System.out.println();
            }

            if (response.isChunked()) {
                阅读大块=真；
                System.out.println("分块内容 {");
            } 别的 {
                ChannelBuffer 内容 = response.getContent();
                如果（内容。可读（））{
                    System.out.println("内容{");
                    System.out.println(content.toString(CharsetUtil.UTF_8));
                    System.out.println("} 内容结束");
                }
            }
        } 别的 {
            HttpChunk 块 = (HttpChunk) e.getMessage();
            if (chunk.isLast()) {
                阅读大块=假；
                System.out.println("} 块内容结束");
            } 别的 {
                System.out.print(chunk.getContent().toString(CharsetUtil.UTF_8));
                System.out.flush();
            }
        }
    }

```

# c# - 解析CSV的正则表达式

> ID：11364380
> 
> 赞同：1
> 
> 时间：2012-07-06T14:41:10.277
> 
> 标签：c#, regex, expression

我正在尝试在 C# 中解析 CSV 文件。以逗号 (,) 分隔。我得到了它的工作：

```
[\t,](?=(?:[^\"]|\"[^\"]*\")*$) 
```

拆分此字符串：

```
2012-01-06,"Some text with, comma",,"300,00","143,52" 
```

给我：

```
2012-01-06
"Some text with, comma"

"300,00"
"143,52" 
```

但我不知道如何从输出中丢失“”，所以我得到了这个：

```
2012-01-06
Some text with, comma

300,00
143,52 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:52:42.880

你为什么要为此使用正则表达式？确保文件格式正确？

您可以使用`String.Replace()`

```
String s = "Some text with, comma";
s = s.Replace("\"", "");

// After matched
String line = 2012-01-06,"Some text with, comma",,"300,00","143,52";
String []fields = line.Split(',');
for (int i = 0; i < fields.Length; i++)
{
   // Call a function to remove quotes
   fields[i] = removeQuotes(fields[i]);
}

String removeQuotes(String s)
{
   return s.Replace("\"", "");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:55:03.050

如果您尝试解析 CSV 并使用 .NET，请不要使用正则表达式。使用为此目的创建的组件。请参阅[.Net 中的 CSV 文件导入](https://stackoverflow.com/questions/1898/csv-file-imports-in-net)问题。

我知道 CSV 规范看起来很简单，但相信我，如果你继续走这条路，你会感到心痛和毁灭。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-06T16:14:07.910

所以，像这样的东西。同样，我不会为此目的使用 RegEx，而是使用 YMMV。

```
var sp = Regex.Split(a, "[\t,](?=(?:[^\"]|\"[^\"]*\")*$)")
     .Select(s => Regex.Replace(s.Replace("\"\"","\""),"^\"|\"$","")).ToArray(); 
```

所以，这里的想法是，首先，你想用一个双引号替换双双引号。然后将该字符串馈送到第二个正则表达式，它只是删除字符串开头和结尾的双引号。

第一次替换的原因是因为这样的字符串：

```
var a = "1999,Chevy,\"Venture \"\"Extended Edition, Very Large\"\" Dude\",\"\",\"5000.00\""; 
```

所以，这会给你一个像这样的字符串：""Extended Edition""，并且需要将双引号更改为单引号。

# iphone - 动画数组加载缓慢。我怎样才能加快这个过程？

> ID：11364381
> 
> 赞同：2
> 
> 时间：2012-07-06T14:41:14.780
> 
> 标签：iphone, objective-c, xcode, animation

我们将大约 30 个完整的 320 x 480 图像加载到动画数组中。这些图像非常小，每张图像大约 5 - 7Kb。问题是当我们运行循环来填充图像数组时，它似乎会在填充该数组时暂停整个应用程序。有没有办法在一个单独的线程中加载这个带有图像的可变数组，或者让数组在不影响性能的情况下填充？谢谢

```
 NSMutableArray *totalAnimationImages  = [[NSMutableArray alloc] initWithCapacity:numOfImages];

for(int i = 1; i < numOfImages; i++) {
    [totalAnimationImages addObject:[UIImage imageNamed:
                                     [NSString stringWithFormat:@"%@%d.png", image, i]]];
}

annImage.animationImages = totalAnimationImages;
annImage.animationDuration = speed; //.4 second
annImage.animationRepeatCount = 1; //infinite loop

[annImage startAnimating]; //start the animation

[totalAnimationImages release]; 
```

在处理此问题时，并使用 shabzco 提供的线程建议，我提出了以下代码来处理循环，更改图像视图中的图像，似乎完全没有性能影响。这一次只保存一个图像，而不是 NSMutableArray 中的 30 个。正如 Richard J. Ross III 所说，一旦动画开始，它就会将所有图像“处理成内存中的位图格式”。这就是漫长的等待/滞后的来源。在下面的代码中，每次图像更新只发生一次，而不是启动动画时发生 30 次。我在建议的调度线程中使用带计时器的 while 循环来防止此计时器影响主线程，从而可能在动画期间产生不稳定的性能。请提供有关此解决方案的反馈！谢谢

更新：Shabzco 建议我将“ImageNamed”替换为“imageWithContentsOfFile”以避免由于 ImageNamed 可能在内存中缓存图像而导致的奇怪内存泄漏。这是在运行 xcode profiler 并观察“Real Memory”计数器后发现的。很明显，每次动画运行时，实际内存都会越来越多，直到最终应用程序崩溃。用“imageWithContentsOfFile”替换“ImageNamed”后，问题就消失了。我已经更新了下面的代码。

```
annImage.image = [UIImage imageNamed:@""];
[annImage setAlpha:1.0];
dispatch_queue_t concurrentQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
dispatch_async(concurrentQueue, ^{ 
    NSTimeInterval timeout = 1.00 / speed;   // Number of seconds before giving up
    NSTimeInterval idle = 1.00 / 8;     // Number of seconds to pause within loop
    BOOL timedOut = NO;
    NSDate *timeoutDate;
    for(int i = 1; i < numOfImages; i++) {
        timeoutDate = [[NSDate alloc] initWithTimeIntervalSinceNow:timeout];
        timedOut = NO;
        while (!timedOut)
        {
            NSDate *tick = [[NSDate alloc] initWithTimeIntervalSinceNow:idle];
            [[NSRunLoop currentRunLoop] runUntilDate:tick];
            timedOut = ([tick compare:timeoutDate] == NSOrderedDescending);
            [tick release];
        }
        dispatch_async(dispatch_get_main_queue(), ^{
            //annImage.image = [UIImage imageNamed:
            //                      [NSString stringWithFormat:@"%@%d.png", image, i]];
            NSString *filePath = [[NSBundle mainBundle] pathForResource:[NSString stringWithFormat:@"%@%d", image, i] ofType:@"png"];
            annImage.image = [UIImage imageWithContentsOfFile:filePath];
        });   
    }

    dispatch_async(dispatch_get_main_queue(), ^{
        [UIView beginAnimations:nil context:nil];
        [UIView setAnimationDuration: 0.3];
        [annImage setAlpha:0.0];
        [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];
        [UIView commitAnimations];

    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:08:11.613

这将使您的 for 循环发生在不同的线程中，并在所有内容加载后开始动画。

```
@autoreleasepool {
        NSMutableArray *totalAnimationImages  = [[NSMutableArray alloc] initWithCapacity:numOfImages];
        dispatch_queue_t concurrentQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
        dispatch_async(concurrentQueue, ^{   
            for(int i = 1; i < numOfImages; i++) {
                [totalAnimationImages addObject:[UIImage imageNamed:
                                                 [NSString stringWithFormat:@"%@%d.png", image, i]]];
            }
            annImage.animationImages = totalAnimationImages;
            annImage.animationDuration = speed; //.4 second
            annImage.animationRepeatCount = 1; //infinite loop
            [annImage startAnimating]; //start the animation
            dispatch_async(dispatch_get_main_queue(), ^{

                [totalAnimationImages release];

            });
        });
} 
```

# d3.js - 更改 d3.js 地理地图大小

> ID：11364383
> 
> 赞同：2
> 
> 时间：2012-07-06T14:41:20.150
> 
> 标签：d3.js

我只是想让[这张地图](http://bl.ocks.org/3012590)更大一点！

我尝试更改 SVG 大小，以及 G 元素大小...

地理平移和缩放功能只是上下移动地图。

有任何想法吗？

多谢

佩雷

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:55:48.173

您需要更改投影的比例因子（在您的示例中为 11000）。请参阅[文档](https://github.com/mbostock/d3/wiki/Geo-Projections)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-30T18:37:36.800

另一个要考虑的选项是在 svg 标记中使用“preserveAspectRatio”和“viewBox”属性（如果您的地图使用一个）：

svg id="mapsvg" preserveAspectRatio="xMidYMid meet" viewBox="0 0 500 200"

通过提高或降低 viewbox 数字，您可以缩小或放大地图。

# jsf - PrimeFaces ：如何在刷新之间保存树状态？

> ID：11364387
> 
> 赞同：1
> 
> 时间：2012-07-06T14:41:35.327
> 
> 标签：jsf, tree, primefaces

我正在使用 PrimeFaces JSF 库，并且我有一棵树，其中每个节点都是一个复选框：

```
<p:tree selectionMode="checkbox"...> 
```

这棵树代表一些文件，它每 5 秒动态刷新（轮询）一次，因为可以添加或删除文件/节点：

```
<p:poll interval="5" update="treeId"... /> 
```

用户可以通过树节点复选框选择文件。选定的节点保存在 TreeNode 数组中：

```
<p:tree selection="#{BackingBean.selectedNodes}"...> 
```

其中 selectedNodes 定义为：

```
private TreeNode[] selectedNodes; 
```

问题是：由于树不断刷新（每 5 秒），我失去了树状态！用户选中的内容再次变为未选中。

如何在 5 秒刷新之间保持树状态的记忆？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T17:10:52.990

**如果您使用的是 JSF 2：**

制作你的支持豆`@ViewScoped`：

```
@ManagedBean
@ViewScoped
public class BackingBean {
    ...
} 
```

**如果您使用的是 JSF 1.2：**

使用来自 Richfaces 的组件[a4j:keepAlive ：](http://docs.jboss.org/richfaces/latest_3_3_X/en/devguide/html/a4j_keepAlive.html)

```
<a4j:keepAlive bean="BackingBean" /> 
```

您还可以选择使用[Tomahawk 的 saveState](http://myfaces.apache.org/tomahawk-project/tomahawk/tagdoc/t_saveState.html)（使用适合您项目的 Tomahawk 版本），仅将 selectedNodes 放在视图中：

```
<t:saveState value="#{BackingBean.selectedNodes}" /> 
```

只需将 Tomahawk 及其依赖项放在 中`WEB-INF/lib`，在您的 web.xml 中注册过滤器并在您的`.xhtml`页面上注册名称空间，您就可以开始了。

# javascript - 页面加载时显示图片

> ID：11364396
> 
> 赞同：0
> 
> 时间：2012-07-06T14:41:51.770
> 
> 标签：javascript, jquery, html, css

我正在使用 jquery mobile 开发移动应用程序。现在，我正在尝试在页面加载时加载图像。我想隐藏默认页面加载图像和消息，而我想加载外部图像。此外，每当页面加载图像时，我也想隐藏背景（页面内容）。

帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:55:13.267

我会看看 spin.js [http://fgnass.github.com/spin.js/](http://fgnass.github.com/spin.js/)

在页面加载时运行微调器，然后

```
.spin(false) 
```

阻止它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:57:07.973

使用这种方法。

```
$.mobile.loading( 'show', {
    text: 'foo',
    textVisible: true,
    theme: 'z',
    html: ""
}) 
```

这里有更多描述[jquery mobile](http://jquerymobile.com/test/docs/pages/loader.html)

# python - Django 并使用处理程序从查询字符串中获取信息

> ID：11364404
> 
> 赞同：1
> 
> 时间：2012-07-06T14:42:23.567
> 
> 标签：python, django, google-app-engine, google-cloud-datastore

我对从显示的列表中处理记录的最佳方式有点迷失了。我允许用户单击一个链接，该链接将在我的 template.html 中按以下方式在查询字符串中包含记录 ID：

```
<a href="/edit_record?id={{company.key.id}}">Edit</a> 
```

我的处理程序中有：

```
application = webapp.WSGIApplication([
  ('/', DisplayMaphandler),
  ('/companyadd', AddCompanyHandler),
  ('/validatecompanies', Validationhandler),
  ('/addcompanycategories', AddCompanyCategoriesHandler),
  ('/editcompany', EditCompanyHandler),
  ('/edit_record', EditRecordHandler),
], debug=True) 
```

我希望得到 id，但是这段代码显然是错误的，根本不起作用：

```
class EditRecordHandler(webapp.RequestHandler):    
    def get(request):
        myid = request.GET.get('id', '')
        self.response.out.write(myid) 
```

我应该如何从这门课上获得 id。另外我在urlconf上看到了一些东西，我需要用这样的东西。我知道单击链接时会触发此类，但希望找到使用 RequestHandler 而不是 def 函数使其工作的最聪明的方法。我得到的错误是：

```
AttributeError: 'EditRecordHandler' object has no attribute 'GET' 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:56:51.773

更改`EditRecordHandler` `get`方法如下：

```
class EditRecordHandler(webapp.RequestHandler):    
    def get(self):
        myid = self.request.get('id')
        self.response.out.write(myid) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:19:05.047

请自由编辑..

**在 urls.py 中：**

```
urlpatterns = patterns('',
    (r'^/edit_record/', EditRecordHandler),
) 
```

**使用 request.method == 'GET'**而你忘记了 (self,request)：

```
class EditRecordHandler():    
    def get(self,request):
        if request.method == 'GET':
            myid = self.request.get('id') 
```

# regex - Lua 模式括号和 0 或 1 次出现

> ID：11364405
> 
> 赞同：7
> 
> 时间：2012-07-06T14:42:29.433
> 
> 标签：regex, lua, lua-patterns

我正在尝试将字符串与模式匹配，但有一件事我还没有弄清楚。在正则表达式中，我会这样做：

```
Strings:
en
eng
engl
engli
englis
english

Pattern:
^en(g(l(i(s(h?)?)?)?)?)?$ 
```

我希望所有字符串都匹配。在 Lua 模式匹配中，我无法让它工作。

即使是这样一个更简单的例子也行不通：

```
Strings:
fly
flying

Pattern:
^fly(ing)?$ 
```

有人知道怎么做这个吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-06T14:53:00.180

您不能使用 Lua 的量词`?`、`*`和使匹配组成为可选（`+`或重复它们） `-`。

在 pattern`(%d+)?`中，问号“失去”了它的特殊含义，并且将简单地匹配文字`?`，正如您通过执行以下代码行所看到的：

```
text = "a?"
first_match = text:match("((%w+)?)")
print(first_match) 
```

这将打印：

```
a? 
```

AFAIK，你可以在 Lua 中最接近的是使用模式：

```
^eng?l?i?s?h?$ 
```

其中（当然）也匹配字符串，如`"enh"`, `"enls"`, ...。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T14:54:10.450

在 Lua 中，括号仅用于捕获。他们不创造原子。

最接近您想要的模式的是：

```
'^flyi?n?g?$'
'^en?g?l?i?s?h?$' 
```

如果您需要正则表达式引擎的全部功能，可以使用 Lua 常用引擎的绑定。还有 LPeg，一个用于创建[PEGs](http://en.wikipedia.org/wiki/Parsing_expression_grammar)的库，它带有一个正则表达式引擎作为示例（不确定它有多强大）。

# networking - 从远程访问本地主机上的站点

> ID：11364406
> 
> 赞同：11
> 
> 时间：2012-07-06T14:42:36.030
> 
> 标签：networking, server, localhost

我用来在我的本地主机上开发我的项目，在 ubuntu 机器上的 apache 上。有时我需要向我的客户展示进度。是否可以从远程机器访问本地主机？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2016-11-08T01:39:16.143

您可以使用为本地服务提供隧道的服务，例如 localtunnel、pagekite 或[ngrok](https://ngrok.com/)。这些服务简化了远程演示、移动测试的设置，有些还提供请求检查。

我发现 ngrok 很有用，因为它提供了一个 https 地址，这是测试网络摄像头访问等内容所必需的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-06T15:20:56.907

此答案中使用的术语：

*   主机 = 带有站点的机器
*   客户端 = 您尝试从中访问主机的机器

如果主机和客户端在同一个网络，你可以通过输入从客户端访问主机

`http://(hostname or ip address)`

在您客户的浏览器中。如果站点未在端口 80（用于 http）或端口 443（用于 https）上运行，请按原样添加帖子（此示例适用于您的服务器在 8080 上，这是一个常见的备用端口）：

`http://(hostname or ip address):8080`

如果主机和客户端不在同一个网络上，并且您需要从客户端通过 Internet 访问以查看主机，则您需要使您的主机在 Internet 上可供客户端访问。

如果您不确定自己在做什么，这对您的信息安全可能是*极其危险的，我建议您获得一个便宜的托管帐户（可以在 1:1 托管等地方以每月 10 美元的价格获得它们）。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-10-22T22:15:06.700

有很多方法可以做到这一点——区别在于安全性、配置的简单性和解决方案的成本。

下面我输入一些方法和一些分析

1.  端口转发（使用动态 DNS 和 SSL 加密）

这需要路由器配置（将您的路由器公共端口转发到 loclhoat 端口），但这需要您拥有固定的 IP 地址。如果您的 ip 地址不固定（在大多数情况下），您需要使用动态 DNS 服务才能使用域名而不是 ip 地址（有很多可用的免费服务）。在这里，我们仍然有安全问题未解决。为了解决安全问题，即设置 ssl 证书，我们可以使用 Let's Encrypt 服务（[https://letsencrypt.org/](https://letsencrypt.org/)）来获取免费证书，但是我们应该配置本地服务器以使用证书或者我们应该设置反向代理（在大多数情况下 nginx或 apache）并配置代理以使用证书。

结论 -**如果我们想要安全连接，很难设置**（可以**免费**完成）

2.  VPN

对于这种情况，我们应该使用 VPN 服务。我们应该将我们的本地机器连接到 VPN，然后在另一端我们应该将我们的客户端机器连接到 VPN，这将允许我们通过本地 IP 地址访问 localhost。我们可以设置自己的 VPN 服务器，但这需要知识才能正确完成。

结论 –**简单、付费、安全、糟糕的用户体验**（每次需要连接到 localhost 时都连接到 VPN）

3.  隧道

对于这种情况，我们可以使用免费的隧道服务（即[https://tunnelin.com/](https://tunnelin.com/)）。该过程非常简单，即注册用户，将您的设备连接到服务（通过在设备上运行一行命令），使用 Web 界面打开/关闭到设备的安全隧道。

结论——**免费、安全、简单**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T14:51:27.010

是的，如果您有公共和静态 IP。通常，ISP 在会话期间提供静态 ip（即，直到您断开连接并再次连接）

# performance - 创建散列数组显示性能缓慢，如何改进？

> ID：11364407
> 
> 赞同：1
> 
> 时间：2012-07-06T14:42:38.767
> 
> 标签：performance, perl

通过 Devel::NYTProf 运行我的脚本显示以下代码部分占用了绝大多数运行时间。该函数创建一个更易于使用的散列，并将该散列推入一个数组。我想知道如何在不花这么长时间的情况下做到这一点。

来自Devel::NYTProf：

```
# Statements | Time on line | Calls | Time in sub
21092   16.4s   21092   273s     push( @events, { create_events_hash($1, $2, $j, @eventHash) } );
# spent 273s making 21092 calls to Parser::create_events_hash, avg 12.9ms/call

# ...                   

# spent 273s (268+4.95) within Parser::create_events_hash which was called 21092 times, 
    avg 12.9ms/call: # 21092 times (268s+4.95s) by 
    Parser::findNewMessages at line 86, avg 12.9ms/call  
# Statements | Time on line 

sub create_events_hash {
    21092   159s            my ( $dateIndex, $msgIDIndex, $eventHashIndex, @eventHash ) = @_;                       

    21092   81.8ms          my %holder;
    21092   137ms           $holder{ID} = $eventHashIndex;
    21092   190ms           $holder{msgDate} = $dateIndex;
    21092   243ms           $holder{ReceivedAt} = $eventHash[$eventHashIndex]{ReceivedAt};
    21092   181ms           $holder{msgID} = $msgIDIndex;
    21092   193ms           $holder{FromHost} = $eventHash[$eventHashIndex]{FromHost};
    21092   187ms           $holder{Priority} = $eventHash[$eventHashIndex]{Priority};

    21092   97.6s           return %holder;
                    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T14:50:21.227

对于初学者，我会发送@eventhash 作为参考。

```
push(@events, {create_events_hash($1, $2, $j, \@eventHash)}); 
```

这种方式更有效，因为它不会复制数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:32:42.780

可能是您无法真正从一堆赋值语句中挤出太多时间。

您可能需要检查您的算法，为什么要调用 sub 21k 次？

您已经有一个哈希数组。也许您正在以一种非常低效的方式进行迭代。

另外，您将散列传递给函数，而不是散列引用。因此，请尝试按照@Hameed 的建议传入引用，并尝试将引用也传出，看看会发生什么。

将引用传递出去可能对你的代码影响最小，然后你就可以看到传递 refs vs objects 对运行时有什么样的影响。但我同意 Hameed 的观点 - 您传入的大数组将花费更多时间复制到堆栈上，然后是您返回的小散列。

# android - 如何指定SQlite数据库android的位置？

> ID：11364408
> 
> 赞同：1
> 
> 时间：2012-07-06T14:42:41.367
> 
> 标签：android, sqlite

当我创建一个 SQlite 数据库时，我在我的 android 项目的资源中找不到它，所以我想将它定位在我的硬盘中，以及如何继续打开它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:47:39.960

您`can't`直接将数据库保存到`harddisk`但是您可以在 sdcard 中创建数据库

然后将该数据库从 sdcard 复制到您的硬盘。

然后您可以使用[SQLite 数据库浏览器访问该数据库](http://sourceforge.net/projects/sqlitebrowser/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T09:40:57.107

您必须从数据库中进行一些选择才能查看所有记录 [，这](http://www.tutomobile.fr/comment-utiliser-sqlite-sous-android-tutoriel-android-n%C2%B019/19/10/2010/)是一个可以帮助您的教程

# php - PHP IF Else 函数不工作

> ID：11364415
> 
> 赞同：0
> 
> 时间：2012-07-06T14:43:06.717
> 
> 标签：php, if-statement

我有一个问题，我无法得到我的代码的结果。当我尝试调试代码时。我在我的代码中使用 IF 语句。

很简单，例如：如果 kelas(基于 user_id 登录) = 1，则将其重定向到 kelas1.php，如果 kelas = 2，则重定向到 kelas 2，否则没有 kelas。

这是我的代码：

```
<?php
session_start();

if(!isset($_SESSION['user_id'])) {      
    header('Location: form_login_siswa.html');
}
$user_id = $_SESSION['user_id'];
include ("config.php");
$query = "SELECT kelas FROM t_siswa WHERE user_id = '$user_id'";
$hasil = mysql_query($query);

while ($data = mysql_fetch_array($hasil)) {
    $kelas = $data['kelas'];

    if($kelas = 1) {
        include ("kelas1.php");
    }
    if($kelas = 2) {
        include ("kelas2.php");
    } else {
        echo "Tidak ada kelas";
    }
}
?> 
```

任何人，请帮助解决问题。感谢您的帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T14:46:03.423

您缺少一个`else`并且也没有使用正确的运算符进行比较。

此外，切换比较，以使第一个值始终是有效值。

```
if(1 == $kelas)
{
    include ("kelas1.php");
}
else if(2 == $kelas)
{
    include ("kelas2.php");
}
else
{
    echo "Tidak ada kelas";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:45:35.110

```
$kelas = 1 
```

是赋值

```
$kelas == 1 
```

是比较

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T14:45:51.833

```
if($kelas = 1) 
```

应该

```
if($kelas == 1) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-06T14:46:58.447

尝试使用 == 而不是 = 。“=”是一个赋值运算符，表达式获取右操作数的值。

```
if($kelas == 1)
{
    include ("kelas1.php");
}
if($kelas == 2)
{
    include ("kelas2.php");
}
else
{
    echo "Tidak ada kelas";
} 
```

此外，该语句将始终`echo "Tidak ada kelas";`if `($kelas == 1)`。这是故意的吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-06T14:45:46.117

在您的 if 语句中使用`==`用于测试比较而不是`=`用于分配的单个

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-06T14:51:03.910

看一下[elsif 结构](http://php.net/manual/en/control-structures.elseif.php)。

```
while ($data = mysql_fetch_array($hasil)) {
  $kelas = $data['kelas'];

  if($kelas == 1) {
    include ("kelas1.php");
  } elseif($kelas == 2) {
    include ("kelas2.php");
  } else {
    echo "Tidak ada kelas";
  }
} 
```

或[开关结构](http://www.php.net/manual/en/control-structures.switch.php)：

```
while ($data = mysql_fetch_array($hasil)) {
  switch($data['kelas']){
    case 1:
      include ("kelas1.php");
      break;
    case 2:
      include ("kelas2.php");
      break;
    default:
    echo "Tidak ada kelas";
  }
} 
```

# php - Ajaxplorer - 删除由 Ajaxplorer 提供支持

> ID：11364419
> 
> 赞同：-3
> 
> 时间：2012-07-06T14:43:10.477
> 
> 标签：php, file-manager, pydio

我正在使用[Ajaxplorer](http://ajaxplorer.info) 4.0.4 版本。我想删除“由 Ajaxplorer 提供支持，由 charles 编写”等。

我怎样才能删除它并设置我的自定义消息，\我愿意为此付费。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T15:56:12.280

从技术上讲：搜索字符串的源代码，将其删除。

但是，**请不要这样做！** 开发人员在 AGPL 许可证下发布了这个，请参阅[http://ajaxplorer.info/community/faq/](http://ajaxplorer.info/community/faq/)

> **我可以在我的网站上自由使用 AjaXplorer，即使我是一家公司**
> 
> 只要您不深入修改 AjaXplorer（不考虑诸如主题或小调整之类的修改），并且只要您留下指向源代码的链接（即到本网站，除非您想托管源代码在您自己的网站上）在用户界面上（这是 AGPL 对 GPL 的特殊性），是的，您可以。例如，如果您更改启动画面的徽标（使用 gui.ajax 插件选项）并提及 « Powered by AjaXplorer »，这将是可以的。如果您想删除此引用，您应该联系我们。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-06T15:46:14.317

将整个代码库加载到 IDE 中，在整个内容中搜索字符串“Powered by Ajaxplorer ,written by charles”，然后将其替换为您想要的任何内容。

# android - 显示额外元素的 Jquery 移动页面转换

> ID：11364425
> 
> 赞同：0
> 
> 时间：2012-07-06T14:43:23.973
> 
> 标签：android, ios, mobile, jquery-mobile

[http://kzoomarketing.com/hapman/#main](http://kzoomarketing.com/hapman/#main)

这是我一直在开发的应用程序的链接。问题是页面转换在几页的页脚中显示了一个无样式的菜单。

我终其一生都无法弄清楚代码的来源。

如果有人可以查看源代码并帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T08:27:32.353

在线，您的代码中的 1363 ..

```
<div id="reloadBtn" width="100%"><img style="margin-left:49%; margin-top: 1%;
   cursor: pointer;" "id="reloadSavedFlowcharts" src="images/blue/reload_24x28.png" 
   onClick="synchFlowcharts()"></div> 
```

**您在id=****`"`**之前添加了错误的附加信息。

 **正确一：

```
<div id="reloadBtn" width="100%"><img style="margin-left:49%; margin-top: 1%;
   cursor: pointer;" id="reloadSavedFlowcharts" src="images/blue/reload_24x28.png" 
   onClick="synchFlowcharts()"></div> 
```**

# asp.net-mvc-3 - MVC3“全局变量”

> ID：11364432
> 
> 赞同：0
> 
> 时间：2012-07-06T14:43:46.780
> 
> 标签：asp.net-mvc-3

我正在创建一个带有 Windows 身份验证的 MVC Intranet 应用程序。被访问的数据是特定年份的，所以我需要一种方法来设置全局变量，无论是会话还是其他，必须在执行任何查询之前设置。

我无法找到强制用户登录的方法，因为他们已经通过 Windows 登录凭据获得授权，因此使用属性强制登录似乎有问题。

我发现用户可以导航到任何特定页面并尝试提取数据并在没有定义年份的情况下造成一些破坏。

如果尚未设置年份变量，我想做的是强制用户进入年份选择页面以选择他们希望访问的年份。

我检查了相关问题，但它们似乎没有为我当前的难题提供答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:50:12.043

您可以编写一个自定义 ActionFilter，将其放在所有控制器上（当然，不能放在必须选择年份的操作上）。如果没有选择年份，您将重定向到可以选择年份的控制器/操作。

```
public class CheckYearAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        if(<YEAR IS NOT SET>)//redirect
        {
            filterContext.Result = new RedirectToRouteResult(
                new RouteValueDictionary {{ "Controller", "YourController" },
                                      { "Action", "YourAction" } });
        }

        base.OnActionExecuting(filterContext);
    }
} 
```

# wpf - WPF 多个 DataTriggers 绑定到同一个源

> ID：11364433
> 
> 赞同：0
> 
> 时间：2012-07-06T14:43:54.853
> 
> 标签：wpf, storyboard, datatrigger

我终于找到了我的故事板数据触发器问题。出现此问题是因为我有 2 个 DataTriggers 绑定到相同的 viewmodel 属性：

```
 <Grid Panel.ZIndex="95" Height="234" HorizontalAlignment="Left" Margin="0,85,0,0" Name="grid1" VerticalAlignment="Top" Width="64" Background="#FF454540" Opacity="1">
        <Grid.Style>
            <Style TargetType="{x:Type Grid}">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding SearchMenuState}" Value="{x:Static local:SideMenuState.Shown}">
                        <DataTrigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ThicknessAnimation Duration="0:0:.1" Storyboard.TargetProperty="Margin" To="69,85,0,0" />
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                    </DataTrigger>

                    <DataTrigger Binding="{Binding SearchMenuState}" Value="{x:Static local:SideMenuState.Hidden}">
                        <DataTrigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ThicknessAnimation Duration="0:0:.1" Storyboard.TargetProperty="Margin" To="0,85,0,0" />
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                    </DataTrigger>

                </Style.Triggers>
            </Style> 
```

当我注释掉第二个 DataTrigger 时，第一个起作用了。为什么会这样，我该如何纠正它以使两者都起作用？

# delphi - Delphi 7：在控制台应用程序中处理事件（TidIRC）

> ID：11364434
> 
> 赞同：2
> 
> 时间：2012-07-06T14:43:55.613
> 
> 标签：delphi, events, delphi-7, console-application, indy

我正在尝试基于 Indy 的 IRC 组件 (TIdIRC) 制作控制台应用程序，但我遇到了事件问题。这是我的代码：

```
program Project1;

{$APPTYPE CONSOLE}

uses
  SysUtils,
  Classes,
  Math,
  IdBaseComponent,
  IdComponent,
  IdTCPConnection,
  IdTCPClient,
  IdIRC;

type
  TEvents = class
  public
    procedure Raw(Sender: TObject; AUser: TIdIRCUser; ACommand, AContent: String; var Suppress: Boolean);
  end;

const
  IrcServ = 'gr.irc.gr';
  IrcPort = 6667;
  IrcChan = '#lalala';

var
  Irc: TidIRC;
  Event: TEvents;
  uName, rName: string;

function Log(s: string): string;
var now: TDateTime;
begin
  now := Time;
  result := FormatDateTime('[hh:nn:ss] ', now) + s;
end;

procedure TEvents.Raw(Sender: TObject; AUser: TIdIRCUser; ACommand, AContent: String; var Suppress: Boolean);
begin
  Log(AUser.Nick+' '+ACommand+' '+AContent);
end;

begin
  Event := TEvents.Create;
  Irc := TidIRC.Create(nil);
  Irc.OnRaw := Event.Raw;
  Randomize;
  Write('Nickname: ');
  ReadLn(uName);
  rName := 'IDM' + IntToStr(RandomRange(1000, 9999)) + uName;
  with Irc do begin
    AltNick := 'IDM' + IntToStr(RandomRange(1000, 9999)) + uName;
    Nick := rName;
    Username := rName;
    RealName := 'I.D.M.';
    Host := IrcHost;
    Port := IrcPort;
    //MaxLineAction := maException;  <-- [ERROR] Undeclared identifier: 'maException'
    ReadTimeout := 0;
    UserMode := [];
    Connect();
    Join(IrcChan);
  end;
  ReadLn;

end. 
```

到目前为止，我已经尝试了我能想到的一切，但是，虽然应用程序连接成功，但它不会返回任何原始消息......我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T16:30:25.333

`TdIRC`使用内部工作线程接收数据。`OnRaw`当该线程正在解析数据时触发该事件。该线程用于`TThread.Synchronize()`执行该解析。由于您的主线程没有活动的 VCL 消息循环，因此您可以`Synchronize()`手动抽取队列。连接后，在连接到 IRC 时从单元循环调用`CheckSynchronize()`函数，例如：`Classes`

```
begin 
  ...
  Connect; 
  try
    Join(IrcChan); 
    do
      CheckSynchronize;
      Sleep(10);
    until SomeCondition;
  finally
    Disconnect;
  end;
  ...  
end. 
```

`WakeMainThread`为了更好地衡量，您可以为单元中的事件分配一个处理程序以`Classes`帮助控制何时`CheckSynchronize()`应该调用，因此主线程可以在 IRC 连接空闲时进入睡眠状态，例如：

```
program Project1;     

{$APPTYPE CONSOLE}     

uses     
  SysUtils,     
  Classes,     
  Math,     
  IdBaseComponent,     
  IdComponent,     
  IdTCPConnection,     
  IdTCPClient,     
  IdIRC;     

type     
  TEvents = class     
  private
    FSyncEvent: TEvent;
  public     
    constructor Create;
    destructor Destroy; override;
    procedure Raw(Sender: TObject; AUser: TIdIRCUser; ACommand, AContent: String; var Suppress: Boolean);     
    procedure Wake(Sender: TObject);
    procedure CheckSync;
  end;     

function Log(s: string): string;      
begin      
  result := FormatDateTime('[hh:nn:ss] ', Time) + s;      
end;      

constructor TEvents.Create;
begin
  inherited;
  FSyncEvent := TEvent.Create(nil, False, False, '');
end;

destructor TEvents.Destroy;
begin
  FSyncEvent.Free;
  inherited;
end;

procedure TEvents.Raw(Sender: TObject; AUser: TIdIRCUser; ACommand, AContent: String; var Suppress: Boolean);      
begin      
  Log(AUser.Nick+' '+ACommand+' '+AContent);      
end;      

procedure TEvents.Wake(Sender: TObject);
begin
  FSyncEvent.SetEvent;
end;

procedure TEvents.CheckSync;
begin
  FSyncEvent.WaitFor(Infinite);
  CheckSynchronize;
end;

const     
  IrcServ = 'gr.irc.gr';     
  IrcPort = 6667;     
  IrcChan = '#lalala';     

var      
  Irc: TidIRC;      
  Event: TEvents;      
  uName, rName: string;      

begin
  Event := TEvents.Create;       
  try
    WakeMainThread := Event.Wake;
    Irc := TIdIRC.Create(nil);       
    try
      Irc.OnRaw := Event.Raw;       
      Randomize;       
      Write('Nickname: ');       
      ReadLn(uName);       
      rName := 'IDM' + IntToStr(RandomRange(1000, 9999)) + uName;       
      with Irc do begin       
        AltNick := 'IDM' + IntToStr(RandomRange(1000, 9999)) + uName;
        Nick := rName;       
        Username := rName;       
        RealName := 'I.D.M.';       
        Host := IrcHost;       
        Port := IrcPort;       
        //MaxLineAction := maException;  <-- [ERROR] Undeclared identifier: 'maException'       
        ReadTimeout := 0;       
        UserMode := [];       
        Connect;       
        try
          Join(IrcChan);       
          do
            Event.CheckSync;
          until SomeCondition;
        finally
          Disconnect;
        end;
      end;       
    finally
      Irc.Free;
    end;
  finally
    Event.Free;
  end;
end. 
```

# c# - 如何导出dll函数？

> ID：11364437
> 
> 赞同：3
> 
> 时间：2012-07-06T14:43:57.577
> 
> 标签：c#

我在 c# 中制作了一个 dll，但我需要导出函数。

有没有办法在 c# 或其他做同样事情的想法中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T14:46:31.817

通过向 C# 程序集 (DLL) 添加程序集引用，任何[`public`](http://msdn.microsoft.com/en-us/library/yzh058ae%28v=vs.110%29.aspx)类及其`public`成员都将可见。

因此，如果在您的程序集中，您有：

```
public class Helper
{
     public static Foo() { } //Visible.
     private static Bar() { } //Not Visible.
     internal static FooBar() { } //Not Visible.
     protected static Wibble() { } //Visible when created a class derived from Helper.
}

private class HiddenHelper //Not Visible
{
     public static Foo() { } //Not Visible.
     private static Bar() { } //Not Visible.
     //etc. Not Visible
} 
```

任何不公开的内容都将被隐藏。

* * *

除非这要被.Net 之外的东西调用。然后你将不得不[使用 COM](http://msdn.microsoft.com/en-us/library/aa645738%28v=VS.71%29.aspx)。

# vb.net - 如何复制包含与目录相同的字符串的文件？

> ID：11364441
> 
> 赞同：0
> 
> 时间：2012-07-06T14:44:09.040
> 
> 标签：vb.net, visual-studio-2010

我目前有这些目录：

```
C:\testfolder\100
C:\testfolder\101
C:\testfolder\102 
```

我在同一个目录中有这些文件：

```
C:\testfolder\file-100.txt
C:\testfolder\file-101.txt
C:\testfolder\file-102.txt 
```

我在 VB 中尝试做的是将文本文件移动`file-100.txt`到`100`目录中。文本文件也一样`file-101.txt`，将其移至其相关文件夹`101`。

我的问题是如何编写一个循环，以便我的程序匹配我的文本文件名字符串的一部分并将其移动到匹配的文件夹名称？一次移动一个文件效率不高，因为我有数百个目录和文件可以应用它。

编辑：

我对VB有点熟悉。我在这个逻辑部分遇到了麻烦，我想不出一种方法来编写一个循环，以便它可以为我传输文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:01:54.253

如果没有错误检查，这将是移动这些文件的简单例程。它基于您的文件名是一致的：

```
Private Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
  Dim homePath As String = "c:\testfolder"

  Dim files() As String = Directory.GetFiles(homePath, "*.txt")
  For Each f As String In files
    Dim fileName As String = Path.GetFileName(f)

    Dim destPath As String = Path.GetFileNameWithoutExtension(fileName)
    destPath = destPath.Split("-")(1)
    destPath = Path.Combine(homePath, destPath)

    Dim destFile As String = Path.Combine(destPath, fileName)

    File.Move(f, destFile)
  Next
End Sub 
```

这只是获取目录中的文本文件列表，解析文件名以仅获取数字值（100、101 等），然后重建新路径。它假设目录也存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:08:30.857

您可以使用正则表达式来查找匹配的模式

```
 Dim dir As String = "C:\testfolder\"
    Dim fileList() As String = {"C:\testfolder\file-100.txt", _
                                "C:\testfolder\file-101.txt", _
                                "C:\testfolder\file-102.txt"}

    Dim pattern As New Regex(Replace(dir, "\", "\\") & "file-([0-9]+)[.]txt")

    For Each value As String In fileList
        Dim match As Match = pattern.Match(value)
        If match.Success Then
            MsgBox("move from " & dir & " to " & dir & match.Groups(1).Value)
        End If
    Next 
```

确保您有导入正则表达式。

```
Imports System.Text.RegularExpressions 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T15:09:45.117

```
Private Sub organizeFiles(ByVal folderPath As String)
    For Each filePath As String In Directory.GetFiles(folderPath, "*.txt")
        Dim destinationFilePath As String = getDestinationFilePath(filePath)
        If destinationFilePath IsNot Nothing Then
            File.Move(filePath, destinationFilePath)
        End If
    Next
End Sub

Private Function getDestinationFilePath(ByVal filePath As String) As String
    Const fileNamePrefix As String = "file-"
    Dim fileName As String = Path.GetFileName(filePath)
    Dim fileNameWithoutExtension As String = Path.GetFileNameWithoutExtension(filePath)
    If Not fileNameWithoutExtension.StartsWith(fileNamePrefix) Then
        Return Nothing
    End If
    Dim folderName As String = fileNameWithoutExtension.Substring(fileNamePrefix.Length)
    Dim fileFolderPath As String = Path.GetDirectoryName(filePath)
    Dim destinationFolderPath As String = Path.Combine(fileFolderPath, folderName)
    Dim destinationFilePath As String = Path.Combine(destinationFolderPath, fileName)
    Return destinationFilePath
End Function 
```

# actionscript-3 - 如何使用 actionscript 更改部分单词的颜色？

> ID：11364442
> 
> 赞同：1
> 
> 时间：2012-07-06T14:44:14.493
> 
> 标签：actionscript-3, flash-cs5, string-formatting

我正在进行一项练习，孩子们必须将文本字段拖到正确的框中。文本字段包含我从 xml 加载的单词。当他们将文本字段放入正确的框中时，**我想更改 textfield 中部分文本的颜色**。这总是必须是一个特定的字母/字母组合。

例如：他们必须学习**e**和**ee**之间的区别。如果他们在正确的框中放置一个带有单词“十”的文本字段，我希望“t”和“n”保持黑色，而“e”需要变成蓝色。但是如果他们把单词“tween”放在正确的框中，字母“ee”需要变成蓝色。

我一直在玩弄设置字符串一部分的 textFormat ，但我似乎无法让它工作。这也很困难，因为两个选项（e 和 ee）的字符数不同。但我没有得到任何地方。

tldr; **我想更改文本字段中部分文本的颜色**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:57:21.360

怎么样 ：

```
//setup a textformat
var textFormat:TextFormat = new TextFormat();

var startIndex:int = someString.indexOf("e");

textField.setTextFormat(textFormat,startIndex,startIndex+1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T09:35:50.527

我得出的结论是更改单词部分颜色的最佳方法是使用 Stylesheet 类。我从 Stackoverflow 上的某人那里获取了下面的片段，但我忘记了它是谁。对不起，不管你是谁。

```
var style:StyleSheet = new StyleSheet();
var styleObj:Object = new Object();

styleObj.fontSize = "bold";
styleObj.color = "#FF0000";

style.setStyle(".red",styleObj);

var tf:TextField = new TextField(); 

tf.styleSheet = style;
tf.htmlText = "fox is <span class='red'>red</span>";

addChild(tf); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T14:46:35.507

要更改字符串中间某些字符的颜色，请使用 html： [http ://cartoonsmartblog.wordpress.com/2009/08/28/coloring-html-text-in-flash-actionscript-3-quick-code-笔记/](http://cartoonsmartblog.wordpress.com/2009/08/28/coloring-html-text-in-flash-actionscript-3-quick-code-note/)

（顺便说一句，只需使用单引号和双引号而不是 \u0022 丑陋）

# c# - (&(objectCategory=user)(|(CN=)(sAMAccountName=))) 搜索过滤器无效

> ID：11364444
> 
> 赞同：0
> 
> 时间：2012-07-06T14:44:16.910
> 
> 标签：c#, asp.net, active-directory

> (&(objectCategory=user)(|(CN=)(sAMAccountName=))) 搜索过滤器无效。

有人可以告诉我在什么情况下会出现此错误？

我正在尝试通过 Visual Studio 发布我的 Web 应用程序。我在本地主机上运行良好，但发布后出现此错误。

```
 public static string[] ldapUserQuery(string userName, string[] desiredProps)
    {
        //  Establishes path for query. In this case sap.corp
        string queryPath = "LDAP://DC=SAP,DC=CORP";

        //  Used to establish desiredProps from within the function, but now it can be passed in.
        //  This was kept in here as an example of what the desiredProps should look like when
        //  passing it in.
        //
        //  Desired pros are the LDAP attributes to be returned.
        /*
            string[] desiredProps = new string[]
            {
                //"givenName",    //  first name
                //"sn",           //  last name
                //"mail"          //  email
            };
        */

        //  establishes the proper length of the array to be returned.
        string[] returnVal = new string[desiredProps.Length];

        //  Creates objects for performing the Query.
        DirectoryEntry dirEntry = new DirectoryEntry();
        DirectorySearcher dirSearcher = new DirectorySearcher();
        SearchResult result;

        //  dirEntry is used for establishing the connection for the query
        dirEntry.Path = queryPath;
        dirEntry.AuthenticationType = AuthenticationTypes.Secure;

        //  dirSearcher is the query itself.
        dirSearcher.SearchRoot = dirEntry;
        dirSearcher.Filter = string.Format("(&(objectCategory=user)(|(CN={0})(sAMAccountName={0})))", userName);

        //  executes the query.
        result = dirSearcher.FindOne();

        //  handle the result of the query.
        if (result != null)
        {
            //  if the query was successful, then dig through the returned information
            //  and set found objects that match the desiredProps to the returnVal object.
            for (int i = 0; i < desiredProps.Length; i++)
            {
                //  if the desiredProps has a bad attribute name, just give it the placeholder
                //  and move along.
                if (result.Properties[desiredProps[i]] != null)
                {
                    returnVal[i] = result.GetDirectoryEntry().Properties[desiredProps[i]].Value.ToString();
                }
                //else
                //{
                //    returnVal[i] = GlobalVars.placeHolder;
                //}
            }
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T15:19:00.157

`(&(objectCategory=user)(|(CN=)(sAMAccountName=)))`无效，因为它不知道您要比较的`CN`属性和属性。`sAMAccountName`

`(&(objectCategory=user)(|(CN=something)(sAMAccountName=someName)))`已验证。用对你有意义的东西替换*something*和*someName*。

# reporting-services - RDCL 报告中列组之间的分页符

> ID：11364448
> 
> 赞同：3
> 
> 时间：2012-07-06T14:44:32.683
> 
> 标签：reporting-services, rdlc

我有列组的表矩阵。如果更改组值，我希望表格长度在新页面上中断。我的桌子的例子；

```
 GROUP COLUMN 1       |    GROUP  COLUMN 2
        |mounth1 | month2 | month3  |  mounth4 | month5 | month6   
  TEXT1 |
  ............................................................
  TEXT1 |
  ............................................................ 
```

有人可以帮助我吗？

编辑： ![在此处输入图像描述](../Images/8669d2f75371f153694941d0a7fca4a4.png) 我上传了报告的图片。这是一个非常简单的矩阵表。我想在“Periodo”列更改值后分页。感谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:48:50.263

在您的设计中，在组列的组属性中，您可以在“分页符”选项中设置“组的每个实例之间”选项

![在此处输入图像描述](../Images/c180948b72d4edb0e82efe7f0227b6fa.png)

# javascript - 未触发文件更改事件

> ID：11364449
> 
> 赞同：0
> 
> 时间：2012-07-06T14:44:38.200
> 
> 标签：javascript

我有一个多文件输入，我正在使用一些 javascript 来处理它的更改事件。问题是，如果我选择一个文件，然后选择另一个同名文件，那么更改甚至不会被触发。

还有其他我可以使用的事件吗？我唯一的另一个想法（看到您无法使用 JavaScript 清除文件输入值）是从它们 DOM 中删除元素并在提交表单后创建一个新元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:03:30.857

如果你使用 JQuery 来绑定它

```
$('#yourIdOfInputFile').bind('change',function() { 
    //here goes your code
}); 
```

然后它被触发 - 总是！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-17T01:43:03.797

这发生在 IE 和 Crome，而不是 Firefox。当文件相同时，更改事件不会触发。我建议您在每次文件更改时创建一个新输入。由于此解决方法只需将 替换为`input`新的空输入，因此第二次选择文件时，无论文件是什么，`change`都会触发事件。

[http://browser.colla.me/show/file_input_triggers_no_change_event_if_file_names_are_the_same](http://browser.colla.me/show/file_input_triggers_no_change_event_if_file_names_are_the_same)

# c# - 在 ASP.NET MVC3 中显示 json 数据？

> ID：11364460
> 
> 赞同：0
> 
> 时间：2012-07-06T14:45:10.980
> 
> 标签：c#, asp.net, asp.net-mvc, json, facebook-graph-api

我正在开发 facebook 应用程序，我在其中获取用户的朋友详细信息

```
dynamic result = client.Get("me/friends"); //it gives friend's data for id, name 
```

它提供数据

```
{
  "data": [
    {
      "name": "Steven", 
      "id": "57564897"
    }, 
    {
      "name": "Andy", 
      "id": "8487581"
    }
} 
```

现在我想解析这些数据并存储它。这样我就可以按我的方式使用它。

我试图使用**JSON.NET**解析它并将数据显示为

```
var model = JsonConvert.DeserializeObject<FriendDetail>(result.data); 
```

在课堂里 ：

```
public class FriendDetail
    {
        public string id { get; set; }
        public string name { get; set; }

        public FriendDetail(string i, string n)
        {
            id = i;
            name = n;
        }
    } 
```

现在这样我就可以将视图传递为“ `return View(model)`”

但它给了我错误：`The best overloaded method match for 'Newtonsoft.Json.JsonConvert.DeserializeObject<FBApp.Models.FBFriendDetail>(string)' has some invalid arguments`

为什么会发生此错误？

请帮我解析这个json数据。

还有没有更好的方法来**解析和存储**json 数据，然后在视图中显示？

请帮忙

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T14:50:05.037

您正在尝试将`FriendDetail`对象列表反序列化为单个`FriendDetail`对象。尝试以下操作：

```
var jObject = JObject.Parse(result.ToString());
var model = JsonConvert.DeserializeObject<List<FriendDetail>>(jObject["data"].ToString()); 
```

**编辑**

这就是我测试它的方式：

```
var result = 
    @"{
        ""data"": [
        {
            ""name"": ""Steven"", 
            ""id"": ""57564897""
        }, 
        {
            ""name"": ""Andy"", 
            ""id"": ""8487581""
        }]
    }";

var jObject = JObject.Parse(result.ToString());
var model = JsonConvert.DeserializeObject<List<FriendDetail>>(jObject["data"].ToString()); 
```

# jquery - jQuery 在覆盖 div 上显示一个 div

> ID：11364462
> 
> 赞同：1
> 
> 时间：2012-07-06T14:45:13.987
> 
> 标签：jquery, css, overlay, z-index

我们正在尝试创建一种“就地编辑”形式。我正在使用 jQuery 向页面添加一个覆盖 div，并且 z-index 设置为 1000。我在页面上有 4 个 div，它们的 z-index 设置高于此值，但它们没有显示在覆盖上。最终，我会将 div 编码为隐藏，直到单击编辑按钮为止，但现在它们都显示出来了。

我试图避免使用模态脚本，因为我们希望这些 div 显示在适当的位置，而不是在窗口的中心。

这是一个jsfiddle示例：

[http://jsfiddle.net/richcoy/28n5J/](http://jsfiddle.net/richcoy/28n5J/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T14:47:34.300

*`z-index`仅适用于定位元素。*这意味着，您必须设置`position`除 default 以外的其他选项`static`，因此请选择以下选项之一：

*   `relative`（如果您希望它保持原位，建议使用）
*   `absolute`
*   `fixed`

**好读：**

*   [Z-Index CSS 属性：全面了解^(SmashingMagazine)](http://coding.smashingmagazine.com/2009/09/15/the-z-index-css-property-a-comprehensive-look/)

*   [理解 CSS z-index ^(MDN)](https://developer.mozilla.org/en/CSS/Understanding_z-index)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:47:06.537

添加到 4 个 div 的 css 中：

```
position: relative; 
```

# java - 使用 EGit 签出给定的修订版本

> ID：11364465
> 
> 赞同：0
> 
> 时间：2012-07-06T14:45:20.743
> 
> 标签：java, eclipse, git, egit

是否可以在给定的修订状态下下载项目，就像在 Subversion 中一样，使用 Egit？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:33:05.533

使用命令行 git，您只需执行`git checkout a487ec83whatever`. 我想 EGit 也允许您进行结帐并指定特定的修订版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:48:11.057

是的。在 EGit 中，您可以选择“提交”或“标签”，然后选择“结帐”。

# internet-explorer-9 - Sahi 自动测试文本字段空白和文件上传不起作用

> ID：11364468
> 
> 赞同：1
> 
> 时间：2012-07-06T14:45:42.413
> 
> 标签：internet-explorer-9, orbeon, sahi

我正在试用 Sahi 进行测试自动化。我正在尝试完成使用 Orbeon 表单构建的表单。我在 Windows 7 上使用 IE9。

基本上我完成了一个表格（其中包含提交所需的不同阶段的选项卡和链接）。它还包括附加一个或多个文件。

测试完成，Firefox 和 Chrome 工作正常，除了文件上传，即使它们没有生成错误，文件实际上也没有上传。

在 IE9 上运行相同的测试会产生脚本错误。因此，我使用 IE9 创建了一个特定的测试。这运行时不会产生任何错误，但所有文本输入字段和下拉字段在检查时最终都是空白的。此外，文件不会上传。

关于可能是什么问题的任何想法？

提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T14:46:12.500

请与 Sahi Pro 联系，它有针对浏览器问题的最新修复程序，包括您报告的问题。

问候， 纳拉扬

# c# - 日期时间向上和向下舍入

> ID：11364481
> 
> 赞同：15
> 
> 时间：2012-07-06T14:46:13.783
> 
> 标签：c#, .net, datetime, rounding

我一直在寻找一种适当的舍入机制，但我发现的任何东西似乎都不是我所需要的。

我需要分别四舍五入，并且我还需要考虑已经四舍五入的情况。

我需要进行以下舍入

```
5:00 -> RoundDown() -> 5:00
5:04 -> RoundDown() -> 5:00
5:09 -> RoundDown() -> 5:00
5:10 -> RoundDown() -> 5:10

4:00 -> RoundUp() -> 4:00
4:50 -> RoundUp() -> 4:50
4:51 -> RoundUp() -> 5:00
4:56 -> RoundUp() -> 5:00 
```

基本上我需要将它 RoundUp() 或 RoundDown() 明确地精确到最近的 10 分钟，但如果它已经是 10 分钟的倍数，它也应该保持不变。另外我想截断任何几秒钟，以使其对舍入过程没有影响

4:50:45 -> 4:50:00 -> RoundUp() -> 4:50

有没有人有任何方便的代码来完成这个。

我在某处找到了这段代码，但它舍入 5:00 -> RoundUp() -> 5:10 而不是保持原样，因为它已经是 10 的倍数并且不需要舍入。我也不确定秒会如何影响它

```
public static DateTime RoundDateTime(this DateTime dt, int minutes, RoundingDirection direction)
{
    TimeSpan t;
    switch (direction)
    {
        case RoundingDirection.Up:
            t = (dt.Subtract(DateTime.MinValue)).Add(new TimeSpan(0, minutes, 0)); break;
        case RoundingDirection.Down:
            t = (dt.Subtract(DateTime.MinValue)); break;
        default:
            t = (dt.Subtract(DateTime.MinValue)).Add(new TimeSpan(0, minutes / 2, 0)); break;
    }
    return DateTime.MinValue.Add(new TimeSpan(0,
           (((int)t.TotalMinutes) / minutes) * minutes, 0));
} 
```

希望有人可以编辑该方法以使其对我有用。谢谢

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-09-13T22:48:17.263

这将让您根据给定的任何间隔进行舍入。

```
public static class DateTimeExtensions
{
  public static DateTime Floor(this DateTime dateTime, TimeSpan interval)
  {
    return dateTime.AddTicks(-(dateTime.Ticks % interval.Ticks));
  }

  public static DateTime Ceiling(this DateTime dateTime, TimeSpan interval)
  {
    var overflow = dateTime.Ticks % interval.Ticks;

    return overflow == 0 ? dateTime : dateTime.AddTicks(interval.Ticks - overflow);
  }

  public static DateTime Round(this DateTime dateTime, TimeSpan interval)
  {
    var halfIntervalTicks = (interval.Ticks + 1) >> 1;

    return dateTime.AddTicks(halfIntervalTicks - ((dateTime.Ticks + halfIntervalTicks) % interval.Ticks));
  }
} 
```

为了处理截断秒数，我只需从日期时间中减去秒数和毫秒数，然后再将它们发送到舍入函数中。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-06T14:56:44.330

怎么样：

```
case RoundingDirection.Up:
    t = dt.AddMinutes((60 - dt.Minute) % 10);
case RoundingDirection.Down:
    t = dt.AddMinutes(-dt.Minute % 10); 
```

演示：http: [//ideone.com/AlB7Q](http://ideone.com/AlB7Q)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-13T19:20:40.550

这是截断（向下舍入）的快速方法

```
var now = DateTime.Now;
var nowTicks = now.Ticks;

//removing the nanoseconds, miliseconds, and seconds from the nowTicks
var lastMinute = new DateTime(nowTicks - (nowTicks % (1000*1000*10*60))); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-04T22:31:25.203

此函数将向上或向下舍入到最接近的间隔（分钟）。

```
 private static DateTime NormalizeReadingInterval(DateTime originalTime, int interval)
    {
        if (originalTime.Minute % interval == 0) return originalTime;
        var epochTime = new DateTime(1900, 1, 1);
        var minutes = (originalTime - epochTime).TotalMinutes;
        var numIntervals = minutes / interval;
        var roundedNumIntervals = Math.Round(numIntervals, 0);
        return epochTime.AddMinutes(roundedNumIntervals * interval);
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-05T11:08:46.157

另一种避免使用类型算术的方法`long`。

使用整数除法，其中 a & b 是正整数：

```
a/b             // rounding down 
(a+b-1)/b       // rounding up 
((2*a)+b)/(2*b) // rounding to the nearest (0.5 up) 
```

四舍五入：

```
public static DateTime UpToNearestXmin( DateTime dt, int block )
{
   int a = dt.Minute;
   int b = block;

   int mins = block * (( a + b - 1 ) / b );

   return new DateTime( dt.Year, dt.Month, dt.Day, dt.Hour, 0, 0 ).AddMinutes( mins );
} 
```

要向下舍入或最接近，请根据需要更改分钟计算。

分钟是四舍五入的。秒和毫秒归零，这是预期的行为。

# php - 使用 PHP 将 CSV 文件转换为 XML

> ID：11364483
> 
> 赞同：1
> 
> 时间：2012-07-06T14:46:19.277
> 
> 标签：php, xml, csv, xmlwriter

我已经研究了一个答案，主要是借助这个问题[Convert Tab delimited text file to XML](https://stackoverflow.com/questions/6141572/convert-tab-delimited-text-file-to-xml)中的答案，拼凑以下脚本以逐行读取 CSV 文件，然后将结果转换为 XML 文件。

CSV 文件以这种方式包含三个或更多单元格的行：

约翰·多伊 john_doe@email.com 06/07/2012 01:45

在交互式 PHP shell 中运行时，以下脚本会忽略文件的第一行，并在第一个 xml 标记内每次从两行中吐出所有内容：

```
<?php
error_reporting(E_ALL | E_STRICT);
ini_set('display_errors', true);
ini_set('auto_detect_line_endings', true);
$xmlWriter = new XMLWriter();
$xmlWriter->openUri('/path/to/destination.xml');
$xmlWriter->setIndent(true);
$xmlWriter->startDocument('1.0', 'UTF-8');
$xmlWriter->startElement('root');

$tsvFile = new SplFileObject('/path/to/destination.csv');
$tsvFile->setFlags(SplFileObject::READ_CSV);
$tsvFile->setCsvControl("\t");
foreach ($tsvFile as $line => $row) {
if($line > 0 && $line !== ' ') {
    $xmlWriter->startElement('item');
            $xmlWriter->writeElement('name', $row[0]); 
            $xmlWriter->writeElement('email', $row[1]);
            $xmlWriter->writeElement('date', $row[2]);
            $xmlWriter->endElement();
    }
}

$xmlWriter->endElement();
$xmlWriter->endDocument(); ?> 
```

为了解决这个问题，我在这里尝试了解决方案：[tab-delimited string to XML with PHP](https://stackoverflow.com/questions/7423800/tab-delimited-string-to-xml-with-php)

以下是修改后的脚本：

```
<?php
error_reporting(E_ALL | E_STRICT);
ini_set('display_errors', true);
ini_set('auto_detect_line_endings', true);
$xmlWriter = new XMLWriter();
$xmlWriter->openUri('/path/to/destination.xml');
$xmlWriter->setIndent(true);
$xmlWriter->startDocument('1.0', 'UTF-8');
$xmlWriter->startElement('root');

$tsvFile = new SplFileObject('/path/to/destination.csv');
$tsvFile->setFlags(SplFileObject::READ_CSV);
$tsvFile->setCsvControl("\t");

$lines = explode("\n", $tsvFile);
$tsvData = array();
foreach ($lines as $line ) {
    if($line > 0 ) {
        $tsvData[] = str_getcsv($line, "\t");
        $tsvData[] = str_getcsv($line, "\t");
        foreach ($tsvData as $row) {
        $xmlWriter->writeElement('name', $row[0]); 
        $xmlWriter->writeElement('email', $row[1]);
            $xmlWriter->writeElement('date', $row[2]);
        $xmlWriter->endElement();
         }
    }
}

$xmlWriter->endElement();
$xmlWriter->endDocument();?> 
```

该脚本创建了 xml 文件，但不幸的是在其中没有产生任何输出。

有人可以通过指出我哪里出错来帮助我吗？我不是这方面的专家，但我会努力学习。

非常感激您的帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:51:36.130

在您拥有的脚本中的任何地方`"\t"`，您都在指定一个制表符（因为您已经为 TSV 文件修改了某些内容）。如果您尝试转换 CSV 文件（逗号分隔列表），作为第一步，请尝试将所有实例替换`"\t"`为`","`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:41:45.230

你似乎在努力工作。

XML（归根结底）可以表示为文本文件。

虽然不只是创建一个字符串或文件。

读入 CSV，拆分列。使用适当的标签将 CSV 作为 XML 写入该字符串。然后将该文件或字符串加载到 DOM 对象中。

# xml - 基于 xml 内容的 XSD 限制

> ID：11364485
> 
> 赞同：0
> 
> 时间：2012-07-06T14:46:23.300
> 
> 标签：xml, xsd

我是 XSD / XMl 的新手，正在尝试为我使用的项目中使用的 xml 文件创建模板。该架构将由 Visual Studio 中的几个同事使用，我的主要目标是具有错误检查和自动完成功能。

但是，我希望在 XSD 上具有我的 xml 模板的一项功能，但我不知道这是否可能。我认为不是，但我只是想确定一下。

基本上，xml 看起来像这样：

```
<root>
    <parameters>
        <parameter name="@param1"/>
        <parameter name="@param2"/>
        <parameter name="@param3"/>
    </parameters>

    <test>
        <parameter_value parameter_name="@param1" value="whatever"/>
        <parameter_value parameter_name="@param2" value="whatever"/>
    </text>

</root> 
```

这个想法是，首先用户“定义”参数，然后他在特定测试中为它们分配值。我的问题是天气与否我可以对“parameter_name”属性定义一个限制，以便只能输入此特定 xml 中声明的参数。这可能吗？

最好的问候卡洛斯乔丹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:13:39.600

是的，您可以在 XSD 1.0 中执行此操作。通常是这样的：

```
<xs:element name="root">
  <...>
  <xs:key name="paramName">
    <xs:selection xpath="parameters/parameter"/>
    <xs:field xpath="@name"/>
  </xs:key>
  <xs:keyref refer="paramName">
    <xs:selection xpath="text/parameter_value"/>
    <xs:field xpath="@parameter_name"/>
  </xs:keyref>
</xs:element> 
```

这是凭记忆编写的，因此请准备好在您最喜欢的 XSD 教科书中查找正确的语法。

# iphone - 将 xml 字符串转换为 NSMutableArray

> ID：11364487
> 
> 赞同：0
> 
> 时间：2012-07-06T14:46:31.167
> 
> 标签：iphone, xcode

```
NSString *xml=@"<string>aaaa</string><string>bbbb</string><string>ccccc</string>"; 
```

我想在 NSMutableArray 中存储每个元素的文本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:19:47.493

要么你使用 xml 解析器，这是最好的选择。
我建议你使用[TBXML](http://www.tbxml.co.uk/TBXML/TBXML_Free.html)，[它的性能比其他的要好](http://www.raywenderlich.com/553/how-to-chose-the-best-xml-parser-for-your-iphone-project)

或者

尝试这个。`mtbArray`你们都需要吗

```
NSString *xml=@"<string>aaaa</string><string>bbbb</string><string>ccccc</string>";
xml = [xml stringByReplacingOccurrencesOfString:@"</string>" withString:@""];
NSArray *array = [xml componentsSeparatedByString:@"<string>"];
NSMutableArray *mtbArray = [array mutableCopy];
if ([mtbArray count]) {
    [mtbArray removeObjectAtIndex:0];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T04:19:58.127

为此，您可以更好地使用[NSXMLParser](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)。希望这对您有所帮助。

# xml - 有人知道 Chrome 的“唯一名称”吗？

> ID：11364489
> 
> 赞同：0
> 
> 时间：2012-07-06T14:46:32.247
> 
> 标签：xml, google-chrome, scroll, zooming

我正在尝试用我的微软人体工学键盘 7000 上的滚动替换缩放功能。由于 intellitype 的 command.xml 没有列出 chrome，并且我已经更改了与缩放相关的所有其他属性，但无济于事。我只想手动添加它，但我不确定唯一名称是什么。这是我为 Internet Explorer 提供的内容。

```
 <Application UniqueName="IEFrame7" AppName="Internet Explorer 7.0 and 8.0">
        <C308 Type="5" KeySeq="ctrl o" />
        <C310 Type="5" KeySeq="ctrl p" />
        <C311 Type="5" KeySeq="alt p | a" />
        <C315 Type="5" KeySeq="ctrl f" />
        <C401 Type="0" />
        <C100 Type="1" wParam="0x0a121" />
        <C101 Type="1" wParam="0x0a122" />
        <C102 Type="1" wParam="0x0a220" />
        <C106 Type="2" lParam="0x07" />
        <C104 Type="2" lParam="0x05" />
        <C105 Type="2" lParam="0x06" />
        <C319 Type="6" Activator="ScrollUp" /> 
        <C320 Type="6" Activator="ScrollDown" /> 
        <C309 Type="6" Activator="IE7Close" />
        <C307 Type="6" Activator="IE7New" />
    </Application> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:08:05.333

根据rephrase.net 上的[这篇文章](http://rephrase.net/days/08/intellitype-xml)（搜索“UniqueName” [）](http://rephrase.net/)：

> UniqueName 是重要的一个，它是指传递给相关[Windows API](http://msdn.microsoft.com/en-us/library/ms633586%28VS.85%29.aspx)函数的窗口类名。如果您想进行特定于应用程序的定制，可以使用第三方软件（例如[The Customiser](http://www.searchlores.org/tools.htm)）从任何活动窗口中获取类名。如果不是，则特殊的 UniqueName 值“StandardSupport”适用于所有窗口类。

谷歌搜索“chrome wndclass”（来自 API 文档）出现[http://www.experts-exchange.com/Programming/Languages/Pascal/Delphi/Q_27417954.html](http://www.experts-exchange.com/Programming/Languages/Pascal/Delphi/Q_27417954.html)（向下滚动！）具有以下可能值：

```
Chrome_WidgetWin_0
Chrome_OmniboxView
Chrome_AutocompleteEditView 
```

而[将一个窗口窃取到 CreateWindow 窗口中会创建一个“冻结”窗口？](https://stackoverflow.com/questions/10988233/stealing-a-window-into-a-createwindow-window-creates-a-frozen-window)建议

```
Chrome_WidgetWin_1 
```

我想这些都是可能受到影响的不同窗口。也许一个是网页的主窗口？否则，您可以尝试使用链接的定制程序之一（我不清楚使用哪个）。

PS 或者您可以对所有内容使用“StandardSupport”。

# c# - 框架在 Watin 中不起作用

> ID：11364491
> 
> 赞同：0
> 
> 时间：2012-07-06T14:46:43.307
> 
> 标签：c#, .net, watin, frames

我已阅读帖子，指出框架的使用在 2.1 中中断。我已经阅读了您如何在 watin 代码中找到“iframe”并将其更改为“frame”。我已经重新编译，当我在我的项目中使用我的新 dll 时，它给了我一个错误，说我有错误的 .net 版本。我需要使用 .net 3.5 中的框架。我坦率地承认，我没有足够的经验来解决这个问题。是否有人可以编译带有此更改的 3.5 版本的 watin 核心，或者我可以付钱给有经验的人上我的机器并帮助我正确地将更改编译为“框架”。

谢谢各位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T07:05:01.597

转到项目的属性，应用程序设置 -> 目标框架并将其更改为 .NET 框架 3.5

# git - 从 Perforce 迁移到 git 需要充分的理由 - 非常好的理由

> ID：11364492
> 
> 赞同：1
> 
> 时间：2012-07-06T14:46:48.683
> 
> 标签：git, perforce

我在一家公司工作，在美国和欧洲都有开发团队。每个设施目前都使用 Perforce，我们正计划联合构建新系统。作为一个分布式团队，我很希望我们转向 git 或 Mercurial，但我的同事们很谨慎。他们喜欢 Perforce，看不到迁移到 DVCS 的任何好处。

必须承认我正在努力想出令人信服的充分理由。两个设施之间的快速线路意味着我们可以使用中央 Perforce 存储库，或者为每个设施克隆一个。

出现的一个担忧是不会有一个主存储库：开发人员永远不会知道他刚刚签出的代码是否是最新的——假设其他人正在更新同一个文件？

是的，我是一个 git/Mercurial 菜鸟。任何人都可以用难以反驳的理由帮助我吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T15:23:08.327

如果你不知道任何切换的理由，你为什么要切换？

虽然人们可以为您提供他们喜欢 perforce 缺乏的 git 功能 - “本地存储库意味着更快的历史！”，“我不能没有 git bisect”，“perforce 没有存储，因此很难签入离散单元！”.. . 没有人能告诉你 git 比 perforce 对你的公司有什么好处。

所以问问自己这个问题：“我的部门需要 perforce 缺乏的什么？” 和“如果没有 perforce 强制执行的一些限制，我们可以做得更好吗？”。一旦你回答了这些问题，看看 git 是否可以提供帮助。在提出真正的问题结束时，“难以反驳的理由”将掌握在您手中，并适用于您的实际同事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T16:00:14.503

您的问题似乎与 git/mercurial 无关，而是集中式与分布式 VCS：

1.  分布式 VCS - 专业人士
    *   源的多个副本；如果服务器出现故障，则可以从多个工作站获得代码
    *   本地副本意味着更新往往更小，网络密集度更低
2.  分布式 VCS - 缺点
    *   同步更改；如果您的签入率很高并且多个员工在同一模块上工作，您需要有一个*非常*清晰的推送/拉取/合并协议
3.  集中式 VCS - 专业人士
    *   代码的一个地方 - 您知道哪个存储库是或应该是规范的
4.  集中式 VCS - 缺点
    *   代码的一个地方-服务器不可用意味着开发人员无法长时间分支/版本而没有问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T18:38:24.920

要回答这个问题，“谁能想到从集中式 VCS 转移到分布式 VCS 的任何场景是明智的？” 我可以：

*   您的开发团队非常松散耦合。他们有独立的时间表、管理、标准等。他们是如此独立，以至于 CVCS 对他们来说只是官僚主义的繁文缛节。
*   他们所做的开发不受审计或合规标准的约束。没有关于谁在什么时候做了什么的中央记录对您的公司来说不是问题。

# javascript - 在 Internet Explorer Mobile 6 中播放声音

> ID：11364496
> 
> 赞同：3
> 
> 时间：2012-07-06T14:47:00.220
> 
> 标签：javascript, asp.net, internet-explorer, windows-phone

我们有一个针对 Internet Mobile Explorer 6 的 Web 应用程序。当用户输入不正确的...“输入”时，我们需要播放声音。知道 ie mobile 6 支持什么以及如何实现这一点吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T22:08:52.123

我知道这个问题有点老了，但我认为它仍然值得回答。这就是我让它工作的方式。如果您只针对 IE6 Mobile，您可以在 head 标签中添加如下内容：

```
<bgsound id="bgSoundId" loop="0" volume="100" /> 
```

然后有一个像这样的 JavaScript 函数：

```
function playSound() {
    document.getElementById("bgSoundId").src = "path/to/file.wav";
} 
```

因此，您只需从验证逻辑中调用该函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:24:10.183

试用`<bgsound>`（尽可能多地支持浏览器`<embed>`）`<audio>`

```
<audio src="sound.url" type="mime/type">
  <embed src="sound.url" type="mime/type">
    <bgsound src="sound.url">
    </bgsound>
  </embed>
</audio> 
```

但是据我所知， `embed`&`bgsound`没有通用的方法来从 javascript 开始播放。

# android - 带有 Eclipse 的 Android - InflateException on FrameLayout 错误

> ID：11364500
> 
> 赞同：0
> 
> 时间：2012-07-06T14:47:13.660
> 
> 标签：android, android-layout, android-framelayout, android-inflate

我刚刚在 Eclipse 中构建了一个新的 Android 项目，到目前为止，我只有一个包含一个活动的包（来自 Eclipse 的自动生成代码），我所做的只是在 main.xml 布局文件中添加两个按钮。

当我尝试调试应用程序时，模拟器崩溃并且我收到错误“Binary XML file line #31: Error inflating class android.widget.FrameLayout”。

我什至没有使用 FrameLayout！

这是布局文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:background="#99CCFF">

<Button
    android:id="@+id/btn1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="New" />

<Button
    android:id="@+id/btn2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Save" />

</LinearLayout> 
```

这是主要的 Activity 文件（同样，这只是 Eclipse 在您创建新项目时生成的默认代码）：

```
package com.myapp.main;

import android.app.Activity;
import android.os.Bundle;

public class MyApp extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
}
} 
```

只是为了它，这也是清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.myapp.main"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="8" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name="com.myapp.main.MyApp"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

</manifest> 
```

据我所知，这是 99% 的自动生成的代码，我看不出为什么我什至不使用 FrameLayout 时会在“FrameLayout”上得到 InflateException。

所以很迷茫...

这是我在 LogCat 中得到的：

```
FATAL EXCEPTION: main
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.myapp.main/com.myapp.main.MyApp}: android.view.InflateException: Binary XML file line #31: Error inflating class android.widget.FrameLayout
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1736)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1752)
at android.app.ActivityThread.access$1500(ActivityThread.java:123)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:993)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:126)
at android.app.ActivityThread.main(ActivityThread.java:3997)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:491)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
at dalvik.system.NativeStart.main(Native Method)
Caused by: android.view.InflateException: Binary XML file line #31: Error inflating class android.widget.FrameLayout
at android.view.LayoutInflater.createView(LayoutInflater.java:596)
at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
at android.view.LayoutInflater.onCreateView(LayoutInflater.java:644)
at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:669)
at android.view.LayoutInflater.rInflate(LayoutInflater.java:724)
at android.view.LayoutInflater.inflate(LayoutInflater.java:479)
at android.view.LayoutInflater.inflate(LayoutInflater.java:391)
at android.view.LayoutInflater.inflate(LayoutInflater.java:347)
at com.android.internal.policy.impl.PhoneWindow.generateLayout(PhoneWindow.java:2456)
at com.android.internal.policy.impl.PhoneWindow.installDecor(PhoneWindow.java:2516)
at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:220)
at android.app.Activity.setContentView(Activity.java:1777)
at com.myapp.main.MyApp.onCreate(MyApp.java:20)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1048)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1700) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:01:09.053

我也无法查看您的代码有什么问题。您能否复制并粘贴应用程序崩溃时获得的整个堆栈跟踪？我认为这可能会让我们对正在发生的事情有更多的了解。

您可以在 Eclipse 中从 Logcat 获取堆栈跟踪，也可以打开终端并输入“adb logcat”

# ios - iOS：在某些设备上多次调用 MPMusicPlayerControllerPlaybackStateDidChangeNotification

> ID：11364503
> 
> 赞同：4
> 
> 时间：2012-07-06T14:47:31.273
> 
> 标签：ios, ipad, mpmediaplayercontroller

我有一个播放音乐的应用程序。

我正在使用以下代码来收听 MPMusicPlayerController 的播放状态更改以更新 UI。更准确地说，我在播放和暂停之间切换播放按钮的外观。

```
NSNotificationCenter *notificationCenter = [NSNotificationCenter defaultCenter];

[notificationCenter addObserver: self
                       selector: @selector (handle_NowPlayingItemChanged:)
                           name: MPMusicPlayerControllerNowPlayingItemDidChangeNotification
                         object: self.musicPlayer];

[notificationCenter addObserver: self
                       selector: @selector (handle_PlaybackStateChanged:)
                           name: MPMusicPlayerControllerPlaybackStateDidChangeNotification
                         object: self.musicPlayer];

[self.musicPlayer beginGeneratingPlaybackNotifications]; 
```

这在**iPod Touch (iOS 5)**和**iPhone 3GS (iOS 5)**上效果很好。每次播放状态更改时，我都会收到以下回调：

```
[JBMediaPlayer handle_PlaybackStateChanged:] :: playbackState: 1 
```

其中 1 表示`MPMusicPlaybackStatePlaying`。

但是，如果我在**iPad 1 (iOS 5)**、**iPad 2 (iOS 5)**或**iPad 3 (iOS 6)**上运行相同的程序，我会得到以下序列，而不仅仅是一个回调：

```
-[JBMediaPlayer handle_PlaybackStateChanged:] :: playbackState: 1
-[JBMediaPlayer handle_PlaybackStateChanged:] :: playbackState: 2
-[JBMediaPlayer handle_PlaybackStateChanged:] :: playbackState: 1
-[JBMediaPlayer handle_PlaybackStateChanged:] :: playbackState: 2 
```

其中 2 表示`MPMusicPlaybackStatePaused`并导致我的应用程序在 UI 中显示错误的状态，因为实际上正在播放歌曲。

有趣的是，有时顺序是

```
-[JBMediaPlayer handle_PlaybackStateChanged:] :: playbackState: 1
-[JBMediaPlayer handle_PlaybackStateChanged:] :: playbackState: 2
-[JBMediaPlayer handle_PlaybackStateChanged:] :: playbackState: 1
-[JBMediaPlayer handle_PlaybackStateChanged:] :: playbackState: 2
-[JBMediaPlayer handle_PlaybackStateChanged:] :: playbackState: 1 
```

最终以 1 正确结束`MPMusicPlaybackStatePlaying`，但是回调被调用 5 次并具有交替值仍然没有意义。

关于如何解决这个问题的任何想法或建议我还能测试什么来缩小问题范围？

* * *

由于到目前为止我还没有在这里收到答案，因此我还将问题交叉发布到**Apple 开发者论坛**：[https ://devforums.apple.com/thread/158426](https://devforums.apple.com/thread/158426)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T20:41:00.513

我认为这是这里报告的相同错误：

[在 ios 5 中的 MP 音乐播放器控制器中出现错误的播放状态](https://stackoverflow.com/questions/10118726/getting-wrong-playback-state-in-mp-music-player-controller-in-ios-5)

我针对该问题中的错误发布了解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-20T17:26:09.017

您可以使用 currentPlaybackRate 属性检查实际播放状态。MPMusicPlaybackStatePaused 必须匹配速率 0.0。下面显示了一个如何实现的示例...

```
- (void)musicPlayerControllerPlaybackStateDidChangeNotification:(NSNotification *)notification {
    float playbackRate = [((MPMusicPlayerController *)notification.object) currentPlaybackRate];
    MPMusicPlaybackState playbackState = (MPMusicPlaybackState)[notification.userInfo[@"MPMusicPlayerControllerPlaybackStateKey"] integerValue];
    switch (playbackState) {
        case MPMusicPlaybackStatePaused:
            if (playbackRate <= .0f) {
                self.playbackState = playbackState;
            }
            break;
        default:
            self.playbackState = playbackState;
            break;
    }
} 
```

因此可以切断错误的暂停通知。

# php - PHP 短 if 行为

> ID：11364505
> 
> 赞同：1
> 
> 时间：2012-07-06T14:47:35.700
> 
> 标签：php, if-statement, short

> **可能重复：**
> [我如何理解嵌套的？：PHP 中的运算符？](https://stackoverflow.com/questions/11265173/how-can-i-understand-nested-operators-in-php)

为什么会这样：

```
 $object->customer->phone =
          ! empty( $object->customer->address->phone_fixed ) ?
                    $object->customer->address->phone_fixed :
          ! empty( $object->customer->address->phone_mobile ) ?
                    $object->customer->address->phone_mobile :
          ! empty( $object->customer->address->phone_business ) ?
                    $object->customer->address->phone_business : ''; 
```

返回`$object->customer->address->phone_business`，即使`$object->customer->address->phone_fixed`已设置且不为空？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T14:52:32.553

它与三元运算符的结合性有关。我*至少*会在您的代码中添加括号；但老实说......在一个单一的声明中不止一个三元是现代的失礼。[有趣的链接](http://www.phpsadness.com/sad/30)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-06T14:51:12.283

要么你的数据不是你想的那样（调试才能看到），要么你的逻辑是错误的。

虽然这个*简短的 if*（[三元运算符](http://davidwalsh.name/php-shorthand-if-else-ternary-operators)）非常适合*简单*的内联赋值，但为了清楚起见，我鼓励您将其重构为`if`/`else`块。

我想一旦这样做，您的问题就会变得清晰。进而证明编写干净代码的意义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T14:50:53.970

这些变量很可能不包含您认为它们所做的事情，请使用 var_dump 并进行一些调试。

我什至不知道你可以使用简短的行为来做 elseif。如果我是你，我会重写那段代码以使其更具可读性/可靠/可预测等。

在我看来，简单地写几个 if 看起来会更好，任何阅读代码的人都会立即理解它。

// 抱歉没有回答这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-06T14:59:50.860

这就是为什么对这种复杂的赋值使用三元运算符不是一个好主意的原因。每当我嵌套三元运算时，我总是将每个运算括在括号中以确保。

我建议使用多个`if/else`or`switch`语句。

```
if (!empty($object->customer->address->phone_fixed)
    $object->customer->phone = $object->customer->address->phone_fixed;
elseif (!empty($object->customer->address->phone_mobile)
    $object->customer->phone = $object->customer->address->phone_mobile;
elseif (!empty($object->customer->address->phone_business)
    $object->customer->phone = $object->customer->address->phone_business; 
```

# jsf-2 - 复合组件内的自定义 EL 功能不起作用

> ID：11364513
> 
> 赞同：1
> 
> 时间：2012-07-06T14:48:04.733
> 
> 标签：jsf-2, facelets, taglib, composite-component

尝试不同的方法来解决我在[这里](http://goo.gl/EF9X8 "这里")提到的问题，我创建了一个 facelets taglib 来使用一些格式化函数。

它适用于普通页面，但对于复合组件，该功能不会执行并且不会引发错误。

标记库文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<facelet-taglib 
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facelettaglibrary_2_0.xsd"
    version="2.0">
    <namespace>http://www.spdata.com.br/jsf</namespace>

   <composite-library-name>spd</composite-library-name>

    <function>
        <function-name>leftJustifyWithZeros</function-name>
        <function-class>
            br.com.spdata.util.Formatter
        </function-class>
        <function-signature>
            String leftJustifyWithZeros(java.lang.String, java.lang.Integer)
        </function-signature>
    </function>

    <function>
        <function-name>replaceNewLineWithBrTag</function-name>
        <function-class>
            br.com.spdata.util.Formatter
        </function-class>
        <function-signature>
            String replaceNewLineWithBrTag(java.lang.String)
        </function-signature>
    </function>    
</facelet-taglib> 
```

复合组件：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:p="http://primefaces.org/ui"    
      xmlns:cc="http://java.sun.com/jsf/composite"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:spd="http://www.spdata.com.br/jsf"
>

   <cc:interface>
      <cc:attribute name="value" required="true" />
   </cc:interface>

   <cc:implementation>
      <h:outputText 
         id="#{cc.attrs.id == null ? 'visualizar' : cc.attrs.id}"
         value="Visualizar"
         rendered="#{cc.attrs.value != null and not empty cc.attrs.value}"
         />   
      <p:tooltip 
         value="#{spd:replaceNewLineWithBrTag(cc.attrs.value)}" 
         for="#{cc.attrs.id == null ? 'visualizar' : cc.attrs.id}" 
         />   
   </cc:implementation>
</html> 
```

我错过了什么？

谢谢，菲利普

# android - Android、内核还是平台下的驱动是谁提供的？

> ID：11364518
> 
> 赞同：3
> 
> 时间：2012-07-06T14:48:19.047
> 
> 标签：android, driver

我正在构建我的第一个 Android 映像，我注意到编译新内核与使用 vanilla linux 内核所做的非常相似，所以没问题。

由于一个完整的Android解决方案由两部分组成，内核+所谓的“平台”，我即将构建平台并编译代码，问题是我注意到我必须为某些属性设置一些值就像蓝牙的一样，蓝牙需要这个值才能被识别并简单地工作，我的问题是：我在设置什么？Android下驱动相关的架构是什么？

我也无法理解这一点，因为大多数商用手机都有一个不支持模块的内核，所以如果不能从内核之外的地方动态加载驱动程序，这东西是如何工作的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:05:09.280

完整的 Android OS 由三部分组成。1）官方AOSP源代码。2) 设备特定的内核。3) 特定设备的专有二进制文件（摄像头、传感器等硬件的驱动程序）。

1) 官方 AoSP 源代码，您可以使用 repo sync 访问链接[Start Here下载](http://source.android.com/source/initializing.html)

2) 设备特定内核您从设备制造商处获得。他们将提供内核的二进制映像。

3) 设备特定的二进制文件您必须通过将设备连接到您的 PC 来从设备中提取它。您可以通过 google 搜索您的设备配置。您可以在 github.com 上找到各种设备配置，例如[lenovo ideapad a1](https://github.com/gmarkall/android_device_ideapad_a1/tree/ics)的设备配置 您会找到提取-files.sh 文件。运行此文件以获取您的驱动程序。这是从设备中提取专有二进制文件的 linux shell 脚本。

我希望这有帮助。谢谢你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T14:59:27.480

[这篇文章](https://unix.stackexchange.com/questions/25463/does-android-really-use-the-same-kernel-as-linux)有很多关于 Android 的好信息。Android 中的 Linux 内核使用由内核加载和维护的驱动程序。您还可以使用内核模块：[Building kernel module for Android](https://stackoverflow.com/questions/10041452/building-kernel-module-for-android)

在 Android 下加载驱动程序：

您将需要一个开发环境设置来为 Android 设备进行交叉编译，然后将源代码编译为模块并从命令行将其加载到内核中：

```
insmod <module> 
```

如果您没有收到错误，则它已加载。

# xcode - 我的应用程序将不再在 Snow Leopard 下运行，在 Lion 下运行良好

> ID：11364521
> 
> 赞同：1
> 
> 时间：2012-07-06T14:48:30.977
> 
> 标签：xcode, osx-lion, osx-snow-leopard, xcode4.3

我的应用程序将不再在 Snow Leopard 下运行，即使它最初是为 Snow Leopard 编写的。它在我在 Lion 下的开发机器上运行良好。但是当我在我的 Snow Leopard Mac Mini 上测试它时，应用程序启动了，但没有出现窗口。去文件，新窗口什么都不做。我的分解目标设置为 10.6。我做了什么让我的应用失去雪豹兼容性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:53:26.830

我怀疑您已将 XIB 文件添加到项目中并且没有关闭*自动布局*并将部署目标设置为 10.6 在 IB 中...

# javascript - 在 JavaScript 中控制设置

> ID：11364523
> 
> 赞同：1
> 
> 时间：2012-07-06T14:48:49.000
> 
> 标签：javascript, rest, configuration, web-config

我有一个主要基于 JavaScript 的网站。它使用 REST 服务。我在 JavaScript 页面中硬编码了 REST 服务 URL。URL 将从 PROD 更改为 testing。每次我将此站点部署到不同的环境时，我都需要去更新 .JS 文件。管理这些的最佳方法是什么？有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:53:06.483

可以获取加载 JS 的当前页面的 URL `location.href`。使用它和一些字符串操作，您可以动态创建这些 RESTful URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T14:52:28.670

我通常将这些地址和其他部署敏感值隔离到一个单独的脚本块中，该脚本块由服务器在运行时生成。

示例：（此处为 ASP.NET MVC，但可以是任何语言/框架）

```
<script type="text/javascript">
    var pageOptions =
    {
        "detailsDataUrl": '@Url.Action("LoadDetail", "Contact")',
        "applicationBase": '@Url.Content("~")'
    };
</script> 
```

您可以交替使用仅具有此类数据的一个文件的多个版本，并且部署过程的一部分是部署环境的版本。

更新：K. Scott Allen 发表了一篇非常好的文章，介绍了将数据从服务器代码传递到 javascript 代码的不同选项，这只是其中的一个示例。你可以在[这里](http://odetocode.com/Blogs/scott/archive/2012/08/28/giving-data-to-javascript.aspx)阅读。他特别提到了一个名为[NGON](https://github.com/brooklynDev/NGon)的库，它形式化了上述模式并添加了一些方便的花里胡哨。我已将它添加到几个项目中，并发现它非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T14:54:53.227

每个人的做法都有所不同，但通常这是使用构建系统完成的。在构建期间，执行构建的服务器上有一个环境变量，其值类似于“prod”或“qa”或“dev”。构建 Web 应用程序组件时，一个步骤涉及将您放入文件中的标记替换为适合环境的值。

请注意，如果您对 restful 端点使用相对路径，则不需要这样做。只有在需要更改主机/协议/端口信息时才需要这样做。这太糟糕了。可能更好地了解您正在测试哪个环境并使用 /etc/hosts 将标准 url 映射到特定于环境的 URL。例如，如果您的应用使用

`www.myapp.com`

您可以设置一个将该 url 映射到`qa.myapp.com:80`. 您将使用脚本来管理更改主机文件以适应您想要的任何环境。

# java - 可移动的 JPanel 或类似 JPanel 的小部件

> ID：11364525
> 
> 赞同：2
> 
> 时间：2012-07-06T14:48:54.860
> 
> 标签：java, swing, widget, jpanel

我正在寻找一个外部 API（或内部），它使我能够制作可移动的 JPanel 或像 JPanel 这样的小部件。我的意思是，例如，单击 JPanel 并将其移动到框架中的所需位置。这在Java中可能吗？我已经看到[了这个](https://stackoverflow.com/questions/5353528/is-there-any-widget-in-dojo-similar-to-jpanel-in-java)，但我认为这不是我想要的。

感谢您花时间回答我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:14:44.017

[如何使用内部框架](http://docs.oracle.com/javase/tutorial/uiswing/components/internalframe.html)应该会给你一些想法。它内置在 Swing 中。

# sql-server - SQL Server 2008 报告服务引发错误

> ID：11364527
> 
> 赞同：0
> 
> 时间：2012-07-06T14:48:56.443
> 
> 标签：sql-server

我收到以下错误（以前工作正常）

**报告处理过程中发生错误。(rsProcessingAborted) 共享数据集“CombinedStatsPerClient”的执行失败。(rsDataSetExecutionError) 无法创建与数据源“共享数据集的数据源”的连接。(rsErrorOpeningConnection) 有关此错误的详细信息，请导航到本地服务器计算机上的报表服务器，或启用远程错误**

可能是什么问题，连接..或

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T09:28:54.357

问题出在已排序的数据库连接字符串上

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-06T14:52:26.013

从阅读错误：

无法创建与数据源“共享数据集的数据源”的连接。

听起来您的连接或您为报告设置的连接有问题。

# ruby-on-rails - 主动脚手架安全性：如何在列表操作中显示列值？

> ID：11364530
> 
> 赞同：1
> 
> 时间：2012-07-06T14:48:59.920
> 
> 标签：ruby-on-rails, activescaffold

启用安全性的活动脚手架显示空列。

我已启用所有操作并且运行良好，但在列表操作中，记录列是空的，操作也不是。

# python - 为什么切片和范围上限是排他的？

> ID：11364533
> 
> 赞同：57
> 
> 时间：2012-07-06T14:49:36.270
> 
> 标签：python, language-design, slice

免责声明：我不是在问*and*的上界`stop`参数是否是独占的或*如何*使用这些函数。`slice()``range()`

 *对`range`and`slice`函数的调用以及切片表示法`[start:stop]`都引用整数集。

```
range([start], stop[, step])
slice([start], stop[, step]) 
```

在所有这些中，`stop`整数被排除在外。

**我想知道*为什么*语言是这样设计的。**

是等于0还是省略`stop`时等于表示的整数集合中的元素个数？`start`

是否有：

```
for i in range(start, stop): 
```

看起来像下面的 C 代码？

```
for (i = start ; i < stop; i++) { 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-07-06T14:59:44.627

[文档](http://docs.python.org/release/3.1.4/tutorial/introduction.html)暗示这有一些有用的属性：

```
word[:2]    # The first two characters
word[2:]    # Everything except the first two characters 
```

> 这是一个有用的切片操作不变量：`s[:i] + s[i:]`equals `s`。
> 
> 对于非负索引，如果两个索引都在范围内，则切片的长度是索引的差。例如， 的长度`word[1:3]`为`2`。

我认为我们可以假设范围函数的行为相同以保持一致性。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-01-31T13:59:43.537

以下是一些 Google+ 用户的[意见：](https://plus.google.com/115212051037621986145/posts/YTUxbXYZyfi)

> [...] 我被半开音程的优雅所左右。尤其是当两个切片相邻时，第一个切片的结束索引是第二个切片的开始索引的不变量实在是太漂亮了，不容忽视。例如，假设您在索引 i 和 j 处将字符串分成三个部分——这些部分将是 a[:i]、a[i:j] 和 a[j:]。

Google+ 已关闭，因此链接不再可用。剧透警报：那是 Guido van Rossum。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2018-05-07T08:09:23.303

## 优雅 VS 明显

老实说，我认为 Python 中的切片方式非常违反直觉，它实际上是在用更多的大脑处理来交换所谓的*优雅*，这就是为什么你可以看到[这篇 StackOverflow 文章](https://stackoverflow.com/questions/509211/understanding-pythons-slice-notation)有超过 2Ks 的赞成票，我想是因为很多人一开始并不理解。

举个例子，下面的代码已经让很多 Python 新手头疼了。

```
x = [1,2,3,4]
print(x[0:1])
# Output is [1] 
```

不仅难以处理，而且难以正确解释，例如上面代码的解释是*取第零个元素直到第一个元素之前的元素*。

现在看看使用上限包容性的 Ruby。

```
x = [1,2,3,4]
puts x[0..1]
# Output is [1,2] 
```

坦率地说，我真的认为 Ruby 的切片方式对大脑更好。

当然，当您根据索引将列表拆分为 2 部分时，*独占上限*方法会产生更好看的代码。

```
# Python
x = [1,2,3,4]
pivot = 2
print(x[:pivot]) # [1,2]
print(x[pivot:]) # [3,4] 
```

现在让我们看看包容性*上限方法*

```
# Ruby
x = [1,2,3,4]
pivot = 2
puts x[0..(pivot-1)] # [1,2]
puts x[pivot..-1] # [3,4] 
```

显然，代码不那么优雅，但这里没有太多的大脑处理要做。

## 结论

归根结底，这真的是优雅 VS 明显的问题，Python 的设计者更喜欢优雅而不是明显。为什么？因为[Python 的禅宗](https://www.python.org/dev/peps/pep-0020/)说*Beautiful 比丑陋好*。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-07-06T18:04:41.747

然而，这个问题有点晚了，这试图回答你问题的***为什么***- 部分：

部分原因是因为我们在寻址内存时使用从零开始的索引/偏移量。

最简单的例子是数组。将“6 个项目的数组”视为存储 6 个数据项的位置。如果这个数组的起始位置在内存地址 100，那么数据，比如 6 个字符 'apple\0'，存储如下：

```
memory/
array      contains
location   data
 100   ->   'a'
 101   ->   'p'
 102   ->   'p'
 103   ->   'l'
 104   ->   'e'
 105   ->   '\0' 
```

所以对于 6 个项目，我们的索引从 100 到 105。地址是使用***base + offset***生成的，所以第一个项目在*基本内存位置*100 + *offset* 0（即 100 + 0），第二个在 100 + 1，第三个在 100 + 2, ...，直到 100 + 5 是最后一个位置。

`for`这是我们使用基于零的索引并导致语言结构（例如C 中的循环）的主要原因：

```
for (int i = 0; i < LIMIT; i++) 
```

或在 Python 中：

```
for i in range(LIMIT): 
```

当您使用像 C 这样的语言进行编程时，您可以更直接地处理指针，或者更直接地处理汇编，这种 base+offset 方案变得更加明显。

由于上述原因，许多语言结构会自动使用从*start*到*length-1 的*范围。

您可能会发现这篇关于 Wikipedia 上[基于零的编号](http://en.wikipedia.org/wiki/Zero-based_numbering)的文章很有趣，还有[来自 Software Engineering SE 的这个问题](https://softwareengineering.stackexchange.com/questions/110804/why-are-zero-based-arrays-the-norm)。

*示例*：

例如，在 C 中，如果你有一个数组`ar`并且你给它下标，因为`ar[3]`这实际上等同于获取数组的（基）地址`ar`并将其添加`3`到它 =>`*(ar+3)`这可能导致像这样的代码打印数组的内容，显示简单基数+偏移量方法：

```
for(i = 0; i < 5; i++)
   printf("%c\n", *(ar + i)); 
```

真的相当于

```
for(i = 0; i < 5; i++)
   printf("%c\n", ar[i]); 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-01-24T21:42:34.930

这是独占上限是一种更明智的方法的另一个原因：

假设您希望编写一个函数，将一些变换应用于列表中的项目子序列。如果间隔按照您的建议使用包含上限，您可能会天真地尝试将其写为：

```
def apply_range_bad(lst, transform, start, end):
     """Applies a transform on the elements of a list in the range [start, end]"""
     left = lst[0 : start-1]
     middle = lst[start : end]
     right = lst[end+1 :]
     return left + [transform(i) for i in middle] + right 
```

乍一看，这似乎是直截了当和正确的，但不幸的是，它是微妙的错误。

如果出现以下情况会发生什么：

*   `start == 0`
*   `end == 0`
*   `end < 0`

? 一般来说，您可能应该考虑更多的边界情况。谁愿意浪费时间考虑所有这些？（这些问题的出现是因为通过使用包容性的下限和上限，*没有固有的方式来表示空区间*。）

相反，通过使用上界互斥的模型，将列表分成单独的切片更简单、更优雅，因此*更不容易出错*：

```
def apply_range_good(lst, transform, start, end):
     """Applies a transform on the elements of a list in the range [start, end)"""
     left = lst[0:start]
     middle = lst[start:end]
     right = lst[end:]
     return left + [transform(i) for i in middle] + right 
```

（请注意，`apply_range_good`它不会转换`lst[end]`；它也将其`end`视为独占上界。试图使其使用包容性上界仍然会遇到我前面提到的一些问题。寓意是包容性上界通常很麻烦。 )

（主要改编自我的[一篇关于另一种脚本语言的包容性上限的旧帖子](http://forum.doom9.org/showthread.php?t=58358)。）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-02-25T12:05:02.120

这种上限排除极大地提高了代码理解。我希望它涉及其他语言。*

# c# - 在字符串集合中搜索

> ID：11364535
> 
> 赞同：2
> 
> 时间：2012-07-06T14:49:46.190
> 
> 标签：c#, linq, search, collections

我有这种格式的字符串： `"a = 23, b = 432, f = 321, gfs = 413, d = 42, k = 4242, t = 4314, (...etc...)"`- 大约 30 个元素

我需要有可能在许多字符串中相应地搜索 4 个元素，例如：a、b、d、k。

例如口头查询：`give me all string where a = 3, b, = 2, d = 31, k = 1`

我应该使用什么样的收藏？想要我应该创建什么样的课程？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:55:02.757

如果您知道您的值是唯一的，我将构建一个哈希表，其中等号的左侧是您的键，右侧是您的值。这将帮助您避免任何可能更改的字符串形式，例如额外的空格等。

这是一些代码示例

```
static void Main(string[] args)
{
    string str = "a = 23, b = 432, f = 321, gfs = 413, d = 42, k = 4242, t = 4314";
    Dictionary<string,string> dictionary = ConstructDictionary(str);
    // Now you can find what you want in your dictionary
}

private static Dictionary<string,string> ConstructDictionary(string str)
{
    string[] pairs = str.Split(new char[] { ',' }, StringSplitOptions.RemoveEmptyEntries); // this will give you all the pairs X = Y
    Dictionary<string, string> dictionary = new Dictionary<string, string>();
    foreach (string pair in pairs)
    {
        string[] keyValue = pair.Split(new char[] { '=' }, StringSplitOptions.RemoveEmptyEntries); // this will create an array of size 2 where 
        array[0] = key and array[1] = value;
        string key = keyValue[0].Trim();
        string value = keyValue[1].Trim();
        if (!dictionary.ContainsKey(key))
        {
            dictionary.Add(key, value);
        }
    }
    return dictionary;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:02:18.583

这是使用辅助功能的一种方法：

```
private static bool HasAll(string s, string[] keys, int[] vals) {
    if (keys.Length != vals.Length) throw new ArgumentException("vals");
    var tt = s.Split(new[] {' ', ',', '='});
    for(var i = 0 ; i != keys.Length ; i++) {
        var pos = Array.IndexOf(tt, keys[i]));
        if (pos < 0 || pos == vals.Length-1 || !tt[i+1].Equals(vals[i].ToString())) {
            return false;
        }
    }
    return true;
} 
```

现在您可以使用 LINQ 来获取如下项目：

```
var keys = new[] {"a", "b", "d", "k"};
var vals = new[] {3, 2, 31, 1};
var res = data.Where(str => HasAll(str, keys, vals)).ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T15:43:21.120

如果我正确理解了问题，应该这样做

1）创建一个字典，其中键是完整的字符串，值是字符串的分割片段

2）检查条件与碎片的交集。交叉点大小与标准大小相同，我们有一个匹配项。

```
[TestMethod]
public void FindValuesInStrings() {

  var strings = new[] {
     "a = 23, b = 432, f = 321, gfs = 11, d = 42, k = 4242, t = 4314",   //A
     "a = 12, b = 123, f = 456, gfs = 11, d = 42, k = 4242, t = 4314",   //B
     "a = 11, b = 456, f = 789, gfs = 413, d = 42, k = 4242, t = 4314",  //C
     "a = 23, b = 789, f = 12,  gfs = 13, d = 42, k = 4242, t = 4314",   //D
  };

   var dict = new Dictionary<string, IEnumerable<string>>();
   foreach (var str in strings) {
      dict.Add(str, str.Split(',').Select(s => s.Trim()));
   }

   // finds the two entries where a = 23 (A & D)
   var criteria = new[] { "a = 23" };
   var found = dict.Where(entry => 
       entry.Value.Intersect(criteria).Count() == criteria.Count()).Select(entry => entry.Key);

   Assert.AreEqual(2, found.Count());

   // finds the single entry where a = 23 and gfs = 11 (A)
   criteria = new[] { "a = 23", "gfs = 11" };
   found = dict.Where(entry => 
        entry.Value.Intersect(criteria).Count() == criteria.Count()).Select(entry => entry.Key);

   Assert.AreEqual(1, found.Count());

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T15:07:43.750

类似这个查询的东西会起作用，但我建议将您的值放入与字符串不同的数据结构中。可能是带有元素名称的结构，以便您可以查找多个值。

```
string s1 = "a = 32, b = 432, f = 321, gfs = 43, d = 42, k = 4, t = 44";
string s2 = "a = 23, b = 432, f = 321, gfs = 413, d = 42, k = 4242, t = 4314";
string s3 = "a = 23, b = 21, f = 321, gfs = 413, d = 42, k = 4242, t = 4314";
var array = new string[] { s1, s2, s3 };

var result = array.Where(s => s.Contains("f = 321") && s.Contains("b = 432")); 
```

# android - Android：TabHost.addHost(...) 应用程序在 tabHost.addTab 处崩溃

> ID：11364536
> 
> 赞同：0
> 
> 时间：2012-07-06T14:49:51.123
> 
> 标签：android, android-tabhost

我正在尝试在我的 android 2.3.3 中添加一个选项卡主机。这是我在布局目录下的 tab.xml 代码：

```
<?xml version="1.0" encoding="utf-8"?>
<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:id="@android:id/tabhost">

<LinearLayout 
    android:id="@+id/LinearLayout01"
    android:orientation="vertical" 
    android:layout_height="fill_parent"
    android:layout_width="fill_parent">

    <TabWidget 
        android:id="@android:id/tabs"
        android:layout_height="wrap_content" 
        android:layout_width="fill_parent"
        android:layout_marginBottom="5dip">
    </TabWidget>

    <FrameLayout 
        android:id="@android:id/tabcontent"
        android:layout_height="fill_parent" 
        android:layout_width="fill_parent"
        android:background="#000000">
    </FrameLayout>
</LinearLayout> 
```

这是我的 TabActivity 类

```
package com.tabtest.tab
import android.app.AlertDialog;
import android.app.TabActivity;
import android.app.AlertDialog.Builder;
import android.content.Context;
import android.content.Intent;
import android.graphics.Color;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.net.NetworkInfo.State;
import android.os.Bundle;
import android.widget.TabHost;
import android.widget.TextView;
import android.widget.TabHost.OnTabChangeListener;
import android.widget.TabHost.TabSpec;

public class MyTabActivity extends TabActivity implements OnTabChangeListener {
TabHost tabHost;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.tab);

    if(isOnline()){
        /* TabHost will have Tabs */
        tabHost = getTabHost();
        tabHost.setOnTabChangedListener(this);

        /* tid1 is firstTabSpec Id. Its used to access outside. */
        TabSpec firstTabSpec = tabHost.newTabSpec("tid1");

        /* TabSpec setIndicator() is used to set name for the tab. */
        /* TabSpec setContent() is used to set content for a particular tab. */
        firstTabSpec.setIndicator("1st tab", getResources().getDrawable(R.drawable.tabicon));

        firstTabSpec.setContent(new Intent(this, NextActivity.class));

        /* Add tabSpec to the TabHost to display. */
        tabHost.addTab(firstTabSpec);

        for(int i=0; i<tabHost.getTabWidget().getChildCount(); i++)
        {
            tabHost.getTabWidget().getChildAt(i).setBackgroundColor(Color.parseColor("#0066a4"));
            TextView tv = (TextView) tabHost.getTabWidget().getChildAt(i).findViewById(android.R.id.title);
            tv.setTextColor(Color.WHITE);
        }

        tabHost.getTabWidget().setCurrentTab(0);
        tabHost.getTabWidget().getChildAt(0).setBackgroundColor(Color.parseColor("#0780c9"));
        TextView tv = (TextView) tabHost.getTabWidget().getChildAt(0).findViewById(android.R.id.title);
        tv.setTextColor(Color.BLACK);
    }
    else
    {
        Builder builder = new AlertDialog.Builder(this);
        builder.setTitle("Internet Connectivity");
        builder.setMessage("Sorry, no active internet connection found. Please connect to internet.");
        builder.setPositiveButton("OK", null);
        builder.show();
    }
}

public void onTabChanged(String tabId) {
    for(int i=0;i<tabHost.getTabWidget().getChildCount();i++)
    {
        tabHost.getTabWidget().getChildAt(i).setBackgroundColor(Color.parseColor("#0066a4"));
        TextView tv = (TextView) tabHost.getTabWidget().getChildAt(i).findViewById(android.R.id.title);
        tv.setTextColor(Color.WHITE);
    } 

    tabHost.getTabWidget().getChildAt(tabHost.getCurrentTab()).setBackgroundColor(Color.parseColor("#0780c9"));
    TextView tv = (TextView) tabHost.getTabWidget().getChildAt(tabHost.getCurrentTab()).findViewById(android.R.id.title);
    tv.setTextColor(Color.BLACK);
}

public boolean isOnline() {
    ConnectivityManager conMan = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
    //mobile
    State mobile = conMan.getNetworkInfo(0).getState();
    //wifi
    State wifi = conMan.getNetworkInfo(1).getState();
    if (mobile == NetworkInfo.State.CONNECTED || mobile == NetworkInfo.State.CONNECTING || wifi == NetworkInfo.State.CONNECTED || wifi == NetworkInfo.State.CONNECTING) {
        return true;
    } else {
        return false;
    }

}
} 
```

此应用程序崩溃“应用程序 TabTest（进程 com.tabtest.tab）已意外停止。请重试。”。我调试了代码，它在

```
tabHost.addTab(firstTabSpec); 
```

可能的原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:07:36.027

您的选项卡代码看起来不错，我的猜测是尝试获取视图`NextActicvity`时出现错误。`TabHost`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T06:45:10.787

我也有同样的问题，当我在 Log 中看到错误是由于 null 返回：

```
TextView tv = (TextView) tabHost.getTabWidget().getChildAt(i).findViewById(android.R.id.title); 
```

然后你使用这个 null`TextView`来分配颜色，所以它会给你 nullpointer 异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-29T23:55:34.513

我之前也遇到过同样的问题……所以在网上调试和搜索之后。我了解到我忘记将它们包含在我的 manifest.xml 中

如何包括它们：

在应用程序标签内。

```
 <activity android:name="NextActivity"></activity> 
```

# c# - 在列表中调用删除 .ForEach 只删除交替项目？

> ID：11364538
> 
> 赞同：0
> 
> 时间：2012-07-06T14:49:59.480
> 
> 标签：c#, .net, list, foreach, lambda

我有一个对象列表，我想删除所有满足条件的对象。这是我的代码：

```
var listCurrentBuzzCompaigns = _buzzService.GetAllActiveCompaigns().ToList();

listCurrentBuzzCompaigns.ForEach(x => {
    if (x.MayaMembership.MayaProfile.MayaProfileId == profile_id)
        listCurrentBuzzCompaigns.Remove(x);
}); 
```

但是一个活动被删除了，下一个没有，下一个是，下一个不是。代码有什么问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-06T14:54:16.200

您在迭代列表时正在修改列表，这不好。请改用以下[`List<T>.RemoveAll`](http://msdn.microsoft.com/en-us/library/wdka673a.aspx)方法：

```
listCurrentBuzzCompaigns.RemoveAll(x => x.MayaMembership.MayaProfile.MayaProfileId == profile_id); 
```

通常，当您使用`foreach`关键字遍历 a时，如果枚举器检测到列表已被修改，`List<T>`它将抛出 an 。`InvalidOperationException`此行为旨在完全防止您遇到的那种错误。不幸的是，该`List<T>.ForEach`方法在内部不使用枚举器，因此不会抛出异常来警告您可能存在的错误。`foreach`和之间的这种不一致`ForEach`对我来说似乎是一个设计缺陷。

**更新：**正如 AlanT 所指出的，另一种技术是*在*调用`ToList`. 这是如何做到的：

```
var listCurrentBuzzCompaigns = _buzzService.GetAllActiveCompaigns()
    .Where(x.MayaMembership.MayaProfile.MayaProfileId != profile_id)
    .ToList(); 
```

请注意，我通过更改`==`为来反转条件`!=`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:59:37.897

在显示的代码段中，您最好在获取活动时使用 where() 子句来过滤活动，而不是在检索到活动后尝试将其删除。

例如

```
[TestMethod]
public void TestMethod1() {

   var campaigns = new List<Campaign>(){
       new Campaign {ProfileId = "Jan"},
       new Campaign {ProfileId = "Jan"},
       new Campaign {ProfileId = "Feb"},
       new Campaign {ProfileId = "Mar"},
       new Campaign {ProfileId = "Jan"},
       new Campaign {ProfileId = "Jan"},
   };

   var notJanCampaigns = campaigns.Where(c => c.ProfileId != "Jan");

   Assert.AreEqual(2, notJanCampaigns.Count());

}

class Campaign {
    public string ProfileId { get; set; }
} 
```

在您的代码中，您将过滤

```
x.MayaMembership.MayaProfile.MayaProfileId != profile_id 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-06T15:00:38.613

如果您想在迭代集合时从集合中删除元素，请像这样向后迭代它：

```
List<Smurf> smurfs = GetSomeSmurfs();
for (in i = smurfs.Count - 1; i >= 0; i--)
{
   Smurf smurfToRemove = smurfs[i];
   if(conditionToRemoveSmurf)
   {
      //Do whatever you need with that smurf before removing it. 
      //(Dispose(), give to azrael, whatever)
      smurfs.Remove(smurfToRemove);
   }
} 
```

实现这一点的相应扩展方法留给读者练习；）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-06T14:55:18.810

不要从你正在迭代的序列中删除东西！

所以，改为：

```
var x = listCurrentBuzzCompaigns.Where(x => x.MayaMemberShip.MayaProfile.PayaProfileId == profile_id).Single();
listCurrentBuzzCompaigns.Remove(x); 
```

# c++ - C++ 代码风格 - 创建对象的最佳场所

> ID：11364539
> 
> 赞同：3
> 
> 时间：2012-07-06T14:50:03.063
> 
> 标签：c++, performance, coding-style, readability

前几天我和朋友正在讨论哪种代码风格更好。

案例一：

```
int function()
{
    largeobject a;
    //do some stuff without a
    //do some stuff with a
} 
```

案例B：

```
int function()
{
    //do some stuff without a
    largeobject a;
    //do some stuff with a
} 
```

那么哪个代码在速度和可读性方面更好。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-06T14:53:47.310

您应该尽可能在本地声明对象的变量/实例。因此，在这种情况下，B 将是最佳选择。

考虑一下，如果您在函数体的顶部声明它，其他阅读您的代码的人可能想知道您实际使用该对象的位置。因此，通过将声明放在您实际使用的位置附近将使其更易于阅读。

情况 A 和 B 之间不应该有任何巨大的性能差异。

有一些特殊情况，例如分配大块内存或线程池。在这些情况下，由于可能会消耗时间和资源，您可能需要找到一个更好的地方来分配它们。

如果您是编程新手，您可能需要考虑阅读 Scott Meyers 的书《[Effective C++](http://www.amazon.ca/Effective-Specific-Improve-Programs-Designs/dp/0321334876/ref=sr_1_1?ie=UTF8&qid=1341587097&sr=8-1) 》 。第 26 条谈到它：尽可能推迟变量定义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:55:08.767

您应该使用案例 B。不需要在需要之前创建对象。

此外，您的编译器不会解释`largeobject a();`为使用默认构造函数创建对象，而是解释为**函数声明**。这被称为“最令人烦恼的解析”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T15:06:20.530

情况 B 最好。这种情况在 S.Mcconnell book - Complete Code 中有解释。你错了：

> 那么哪个代码在速度和可读性方面更好。

由于其他原因，案例 B 更好。

# asp.net - 将数据绑定到会话变量？

> ID：11364544
> 
> 赞同：0
> 
> 时间：2012-07-06T14:50:08.640
> 
> 标签：asp.net, c#-4.0, data-binding, session-variables

我有一个 CustomerID 被检索并设置为全局变量。

我需要的是在同一页面上使用该客户 ID（后面的代码）并将其用作 SqlDataSource 查询的参数。

然后我想将查询结果（客户邮政编码）存储到会话变量中。所有这些都需要在同一个点击事件中发生。

如何将数据绑定到 Session 变量。我不想先将它绑定到控件。我只想将数据（邮政编码）直接存储到 Session Var 中。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:53:39.200

Session["DataName"] = code 是否应该让项目不起作用？

# android - 如何在 mupdf 中生成 cmap_cns.h？

> ID：11364549
> 
> 赞同：1
> 
> 时间：2012-07-06T14:50:34.600
> 
> 标签：android, android-ndk, mupdf

我正在从 NDK 编译 MUPDF。我已经在“android”文件夹下创建了“生成”文件夹，但它的内部文件预计会自动生成，但没有生成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T01:33:34.350

好吧，我明白了。我想在创建文件夹`make`之后和执行之前执行我应该执行的操作`generated``ndk-build`

# mysql - MySql - 如果表存在则只更新一些行 - 不希望抛出错误

> ID：11364550
> 
> 赞同：1
> 
> 时间：2012-07-06T14:50:35.457
> 
> 标签：mysql, if-statement, exists

我想运行更新查询。

查询将针对多个数据库运行 - 并非每个数据库都有该表。

如果表不存在，我不希望尝试更新。我不想抛出任何错误——我只想忽略更新。

有任何想法吗？

编辑：为了清楚起见-查询是在自动部署中执行的-不可能进行人工交互。

EDIT2：说明更新是否应该运行的逻辑需要在 MySql 查询本身中。这不是通过命令提示符或批处理或托管代码运行的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:14:44.000

要在本机 MySQL 中执行此操作（如在 mysql 脚本中），您可以使用存储过程。

这适用于一次性管理类型功能，您不希望将其作为应用程序的一部分。（再说一次，如果这是应用程序的一部分，您将拥有条件逻辑来控制是否执行 UPDATE，或者如果表不存在则捕获并处理异常。）

下面是一个存储过程的示例，它使用 a`CONTINUE HANDLER`来捕获错误 1146（表不存在）并将其吞下，因此不会向调用者返回任何错误。

* * *

```
DELIMITER //
DROP PROCEDURE IF EXISTS `table_doesnt_exist_handler`//
CREATE DEFINER=`root`@`%` PROCEDURE `table_doesnt_exist_handler`()
BEGIN
  DECLARE table_doesnt_exist BOOLEAN;
  DECLARE CONTINUE HANDLER FOR 1146 SET table_doesnt_exist = TRUE;

  UPDATE table_doesnt_exist SET foo = 1 WHERE foo = 1;

END//
CALL `table_doesnt_exist_handler`()//
DROP PROCEDURE IF EXISTS `table_doesnt_exist_handler`//
DELIMITER ; 
```

* * *

另一种选择是测试表是否存在，并有条件地运行该语句。同样，在原生 MySQL 中，这需要在存储过程中完成。

```
DELIMITER //
DROP PROCEDURE IF EXISTS `table_doesnt_exist_approach_2`//
CREATE DEFINER=`root`@`%` PROCEDURE `table_doesnt_exist_approach_2`()
BEGIN
  SELECT @table_exists := COUNT(1) AS table_exists
    FROM information_schema.tables
   WHERE table_schema = DATABASE() 
     AND table_name = 'table_doesnt_exist';
  IF  @table_exists > 0 THEN
    UPDATE table_doesnt_exist SET foo = 2 WHERE foo = 1;
  END IF;
END//

CALL `table_doesnt_exist_approach_2`()//
DROP PROCEDURE IF EXISTS `table_doesnt_exist_approach_2`//
DELIMITER ; 
```

* * *

我的偏好是与`CONTINUE HANDLER`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:55:30.963

您可以对表名进行描述，如果结果为空，则不要运行更新。您可以在一个简短的脚本中执行此操作，尽管我不确定您使用的是什么语言。如果您在这里严格查看数据库，您也可以在存储过程中管理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T14:58:42.793

您可以先运行查询以查看该表是否存在，然后运行实际查询。

前任：

```
table_exists_query = Select count(*) from INFORMATION_SCHEMA.tables where table_name='xxxx'; 
```

if(run_query(table_exists_query)==1) 运行实际查询

# c++ - 线程池对英特尔线程构建块有用吗？

> ID：11364551
> 
> 赞同：2
> 
> 时间：2012-07-06T14:50:41.613
> 
> 标签：c++, multithreading, parallel-processing, tbb

我有一个用于 pthreads 的线程池，现在我正在研究使用英特尔® 线程构建模块 (TBB) 我想知道是否有任何意义保留我的线程池并使其与 TBB 一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:02:18.447

我想简短的回答是否定的。

# android - 长时间闲置后重新启动 Android 活动 -> NullPointerException

> ID：11364552
> 
> 赞同：1
> 
> 时间：2012-07-06T14:50:53.407
> 
> 标签：android, nullpointerexception, oncreate

在某些活动中，我的 onCreate 方法中出现 NullPointerException。很难调试，因为它只有在长时间闲置之后才会发生。

这可能是因为活动已经结束并且垃圾收集器已经销毁了一些共享对象，但我不确定。

我应该怎么做才能以适当的方式处理？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T14:58:39.977

活动在闲置一段时间后不会“结束”，并且它们不会被垃圾收集器回收。发生的事情是操作系统杀死了你的整个进程。然后，当用户返回活动时，操作系统重新创建进程并**仅重新创建活动堆栈上的顶部活动**。因此，如果您有任何可能由其他活动设置的静态（类）变量，那么所有这些东西都早已不复存在。

将代码发布在您的`onCreate()`并指出 NullPointerException 发生的位置（查看您的 logcat）。

# java - Memcached + Spring 缓存

> ID：11364554
> 
> 赞同：2
> 
> 时间：2012-07-06T14:50:55.843
> 
> 标签：java, spring, caching, memcached, spymemcached

我正在尝试使用 Memcached 设置 Spring 3.1 缓存解决方案。我已经成功地合并了 ehcache（Spring 已经内置了对此的支持）。但是，我遇到了 memcached 的问题。我提前为长度道歉（它主要是样板代码）......

我正在使用 Java 配置，所以我注释了我的控制器配置以启用缓存，如下所示。

```
@Configuration  @EnableWebMvc  @EnableCaching 
@ComponentScan("com.ehcache.reference.web")
public class ControllerConfig extends WebMvcConfigurerAdapter {
   //Bean to create ViewResolver and add the Resource handler
} 
```

这设置了三个控制器，允许对 Stock 元素进行基本的 CRUD 操作。业务对象如下所示：

```
public class Stock implements Serializable {
  private String name;
  private double cost; //This isn't a real app, don't care about correctness of value
  //Getters, Setters contructors, etc... left out just a standard POJO 
```

}

我正在使用 MyBatis，所以我为 Stock 对象创建了一个 Mapper。然后将映射器注入到我的 DAO 中，然后将 DAO 注入到服务中。工作缓存（在两种实现中）发生在“服务”层中。下面是使用注入的 DAO 的服务层：

```
public class TradingServiceImpl implements TradingService {

  @Autowired
  private final StockDao stockDao;

  public TradingServiceImpl(final StockDao stockDao) {
    this.stockDao = stockDao;
  }

  @Override
  public void addNewStock(final Stock stock) {
    stockDao.save(stock);
  }

  @Override
  @Cacheable(value = "stockCache")
  public Stock getStock(final String stockName) {
    return stockDao.findByName(stockName);
  }

  @Override
  public List<Stock> getAll() {
    return stockDao.findAll();
  }

  @Override
  @CacheEvict(value = "stockCache", key = "#stock.name")
  public void removeStock(final Stock stock) {
    stockDao.delete(stock);
  }

  @Override
  @CacheEvict(value = "stockCache", key = "#stock.name")
  public void updateStock(final Stock stock) {
    stockDao.update(stock);
  }
} 
```

这是示例控制器，它应该缓存显示所有股票的结果（当从数据库中添加、更新或删除股票时，此缓存将被完全清除）：

```
@Controller
public class ListAllStocksController {

  @Autowired
  private TradingService tradingService;

  @Cacheable("viewCache")
  @RequestMapping(value = "listStocks.html", method = RequestMethod.GET)
  public ModelAndView displayAllStocks() {
    //The SerializableModelAndView extends Spring's ModelAndView and implements Serializable due to spymemcached not being able to add a non-serializable object to the cache
    final ModelAndView mav = new SerializableModelAndView("listStocks");
    mav.addObject("stocks", tradingService.getAll());
    return mav;
  }

  @CacheEvict(value = "viewCache", allEntries = true)
  @RequestMapping(value = "editStock.html", method = RequestMethod.POST, params = "submit=Edit")
  public ModelAndView editStock(final Stock stock, final BindingResult result) {
    final ModelAndView mav = new ModelAndView("redirect:listStocks.html");
    tradingService.updateStock(stock);
    return mav;
  }

  @CacheEvict(value = "viewCache", allEntries = true)
  @RequestMapping(value = "listStocks.html", method = RequestMethod.POST, params = "submit=Delete")
  public ModelAndView deleteStockAction(@RequestParam("name") final String name) {
    final ModelAndView mav = new ModelAndView("redirect:listStocks.html");
    tradingService.removeStock(stock);
    return mav;
  }

} 
```

这是我的小缓存管理器：

```
public class MemCacheManager extends AbstractCacheManager {
  private final Collection<MemCache> internalCaches;

  public MemCacheManager(final Collection<MemCache> internalCaches) {
    this.internalCaches = internalCaches;
  }

  @Override
  protected Collection<? extends Cache> loadCaches() {
    Assert.notNull(internalCaches, "A collection caches is required and cannot be empty");
    return internalCaches;
  }
} 
```

这是我的 MemCache 类的样子：

```
public class MemCache implements Cache {

  private MemcachedClient cache;
  private final String name;
  private static final Logger LOGGER = Logger.getLogger(MemCache.class);

  public MemCache(final String name, final int port) throws URISyntaxException {
    this.name = name;
    try {
      cache = new MemcachedClient(AddrUtil.getAddresses("localhost:" + port));
      final SerializingTranscoder stc = (SerializingTranscoder) cache.getTranscoder();
      stc.setCompressionThreshold(600000);
    } catch (final IOException e) { //Let it attempt to reconnect }
  }

  @Override
  public String getName() {
    return name;
  }

  @Override
  public Object getNativeCache() {
    return cache;
  }

  @Override
  public ValueWrapper get(final Object key) {
    Object value = null;
    try {
      value = cache.get(key.toString());
    } catch (final Exception e) {
      LOGGER.warn(e);
    }
    if (value == null) {
      return null;
    }
    return new SimpleValueWrapper(value);
  }

  @Override
  public void put(final Object key, final Object value) {
    cache.set(key.toString(), 7 * 24 * 3600, value);
    Assert.assertNotNull(get(key)); //This fails on the viewCache
  }

  @Override
  public void evict(final Object key) {
    this.cache.delete(key.toString());
  }

  @Override
  public void clear() {
    cache.flush();
  }
} 
```

我已经用 CouchBase 和常规 memcached 尝试过这个。下面的设置显示 memcached 仅自行启动。

```
@Configuration @EnableCaching @Profile("memcached")
public class MemCacheConfiguration implements CachingConfigurer {

  @Override @Bean
  public CacheManager cacheManager() {
    CacheManager cacheManager;
    try {
      cacheManager = new MemCacheManager(internalCaches());
      return cacheManager;
    } catch (final URISyntaxException e) {
      throw new RuntimeException(e);
    }
  }

  @Bean
  public Collection<MemCache> internalCaches() throws URISyntaxException {
    final Collection<MemCache> caches = new ArrayList<MemCache>();
    // caches.add(new MemCache("stockCache", 11212));
    caches.add(new MemCache("viewCache", 11211));
    return caches;
  }

  @Override
  public KeyGenerator keyGenerator() {
    return new DefaultKeyGenerator();
  }

} 
```

在上面的示例中，我们将简单地使用 memcached。这是我第一次启动应用程序并点击列表控制器时看到的日志记录：

```
58513 [qtp1656205248-16] TRACE org.springframework.cache.interceptor.CacheInterceptor  - Computed cache key 0 for operation CacheableOperation[public org.springframework.web.servlet.ModelAndView com.ehcache.reference.web.ListAllStocksController.displayAllStocks()] caches=[viewCache] | condition='' | key='0'
58519 [qtp1656205248-16] WARN  com.memcache.MemCache  - Retrieved: null from the cache 'viewCache' at <0> key of type <java.lang.Integer>
58519 [qtp1656205248-16] ERROR com.memcache.MemCache  - Returning null
58520 [qtp1656205248-16] DEBUG org.mybatis.spring.SqlSessionUtils  - Creating a new SqlSession
58520 [qtp1656205248-16] DEBUG org.mybatis.spring.SqlSessionUtils  - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@640f434f] was not registered for synchronization because synchronization is not active
58520 [qtp1656205248-16] DEBUG org.mybatis.spring.transaction.SpringManagedTransaction  - JDBC Connection [org.hsqldb.jdbc.JDBCConnection@260c2adb] will not be managed by Spring
58521 [qtp1656205248-16] DEBUG com.ehcache.reference.dao.StockMapper.findAll  - ooo Using Connection [org.hsqldb.jdbc.JDBCConnection@260c2adb]
58521 [qtp1656205248-16] DEBUG com.ehcache.reference.dao.StockMapper.findAll  - ==>  Preparing: SELECT * from STOCK
58521 [qtp1656205248-16] DEBUG com.ehcache.reference.dao.StockMapper.findAll  - ==> Parameters:
58521 [qtp1656205248-16] DEBUG org.mybatis.spring.SqlSessionUtils  - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@640f434f]
58521 [qtp1656205248-16] WARN  com.memcache.MemCache  - Setting: ModelAndView: reference to view with name 'listStocks'; model is {stocks=[]} into the cache 'viewCache' at <0> key of type <java.lang.Integer>
58527 [qtp1656205248-16] WARN  com.memcache.MemCache  - Retrieved: ModelAndView: materialized View is [null]; model is null from the cache 'viewCache' at <0> key of type <java.lang.Integer> 
```

这一切看起来都是正确的，这是一个全新的发布，缓存中应该没有任何内容。我现在将一个股票添加到缓存中：

```
263036 [qtp1656205248-14] DEBUG org.mybatis.spring.SqlSessionUtils  - Creating a new SqlSession
263036 [qtp1656205248-14] DEBUG org.mybatis.spring.SqlSessionUtils  - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d20b8d5] was not registered for synchronization because synchronization is not active
263038 [qtp1656205248-14] DEBUG org.mybatis.spring.transaction.SpringManagedTransaction  - JDBC Connection [org.hsqldb.jdbc.JDBCConnection@40b5f9bb] will not be managed by Spring
263038 [qtp1656205248-14] DEBUG com.ehcache.reference.dao.StockMapper.save  - ooo Using Connection [org.hsqldb.jdbc.JDBCConnection@40b5f9bb]
263038 [qtp1656205248-14] DEBUG com.ehcache.reference.dao.StockMapper.save  - ==>  Preparing: INSERT INTO STOCK (name, cost) VALUES (?, ?)
263039 [qtp1656205248-14] DEBUG com.ehcache.reference.dao.StockMapper.save  - ==> Parameters: A(String), 1.0(Double)
263039 [qtp1656205248-14] DEBUG org.mybatis.spring.SqlSessionUtils  - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d20b8d5]
263039 [qtp1656205248-14] TRACE org.springframework.cache.interceptor.CacheInterceptor  - Invalidating cache key 0 for operation CacheEvictOperation[public org.springframework.web.servlet.ModelAndView com.ehcache.reference.web.AddStockController.addNewStock(com.ehcache.reference.business.Stock,org.springframework.validation.BindingResult)] caches=[viewCache] | condition='' | key='0',false,false on method public org.springframework.web.servlet.ModelAndView com.ehcache.reference.web.AddStockController.addNewStock(com.ehcache.reference.business.Stock,org.springframework.validation.BindingResult)
263039 [qtp1656205248-14] WARN  com.memcache.MemCache  - Evicting value at <0> in cache 'viewCache'
263049 [qtp1656205248-18] TRACE org.springframework.cache.interceptor.CacheInterceptor  - Computed cache key 0 for operation CacheableOperation[public org.springframework.web.servlet.ModelAndView com.ehcache.reference.web.ListAllStocksController.displayAllStocks()] caches=[viewCache] | condition='' | key='0'
263051 [qtp1656205248-18] WARN  com.memcache.MemCache  - Retrieved: null from the cache 'viewCache' at <0> key of type <java.lang.Integer>
263051 [qtp1656205248-18] ERROR com.memcache.MemCache  - Returning null
263051 [qtp1656205248-18] DEBUG org.mybatis.spring.SqlSessionUtils  - Creating a new SqlSession
263051 [qtp1656205248-18] DEBUG org.mybatis.spring.SqlSessionUtils  - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7050d0a7] was not registered for synchronization because synchronization is not active
263051 [qtp1656205248-18] DEBUG org.mybatis.spring.transaction.SpringManagedTransaction  - JDBC Connection [org.hsqldb.jdbc.JDBCConnection@49b2bd8c] will not be managed by Spring
263051 [qtp1656205248-18] DEBUG com.ehcache.reference.dao.StockMapper.findAll  - ooo Using Connection [org.hsqldb.jdbc.JDBCConnection@49b2bd8c]
263051 [qtp1656205248-18] DEBUG com.ehcache.reference.dao.StockMapper.findAll  - ==>  Preparing: SELECT * from STOCK
263052 [qtp1656205248-18] DEBUG com.ehcache.reference.dao.StockMapper.findAll  - ==> Parameters:
263053 [qtp1656205248-18] DEBUG org.mybatis.spring.SqlSessionUtils  - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7050d0a7]
263053 [qtp1656205248-18] WARN  com.memcache.MemCache  - Setting: ModelAndView: reference to view with name 'listStocks'; model is {stocks=[Stock Name: <A>      Current Cost <1.0>]} into the cache 'viewCache' at <0> key of type <java.lang.Integer>
263055 [qtp1656205248-18] WARN  com.memcache.MemCache  - Retrieved: ModelAndView: materialized View is [null]; model is null from the cache 'viewCache' at <0> key of type <java.lang.Integer> 
```

减去最后一行，这一切看起来都是正确的。这是 memcached --vv 的输出：

```
<156 get 0               ##Initial listing of all
>156 END                 
<156 set 0 1 604800 79   ##Cache initial result on startup
>156 STORED
<156 get 0
>156 sending key 0
>156 END
<156 delete 0            ##Invalidation when stock added
>156 DELETED
<156 get 0               ##Add redirects to the get page
>156 END
<156 set 0 1 604800 79   ##Store the new value
>156 STORED
<156 get 0
>156 sending key 0       ##Refresh the page
>156 END 
```

这里有趣的是，当我向系统添加股票时，我被重定向到 displayAllStocks 方法。它最初是正确的，但是如果我刷新页面，我会收到原始版本（显示没有库存的版本）。我被困在这里，并且不确定此时可能导致此问题的原因。如果我以任何方式使缓存无效，则重定向可以正常工作。在随后的刷新中，我检索了似乎是放入的第一个值（已被删除）

这是配置问题吗？memcache 或 spymemcached 中的限制/错误，还是我的 MemCache 代码中的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T17:05:07.327

在 TradingServiceImpl 中，getStock 方法总是从缓存中返回相同的对象，而与股票名称无关。您应该将其更改为：

```
 @Override
  @Cacheable(value = "stockCache", key="#stockName")
  public Stock getStock(final String stockName) {
    return stockDao.findByName(stockName);
  } 
```

你在哪里驱逐viewCache？我在您的代码中没有看到它。

如果您想在 Spring 3.1 缓存抽象上使用 memcached，您可以使用 Simple-Spring-Memcached（当前快照版本 - 您需要从源代码构建它）。[在这里](http://code.google.com/p/simple-spring-memcached/issues/detail?id=3&colspec=Stars%20ID%20Type%20Status%20Priority%20Milestone%20Owner%20Summary)您可以找到如何使用 SSM 将 memcached 与 Spring Cache 集成的示例配置。
示例项目：使用此集成[的 spring-cache-integration-test](http://code.google.com/p/simple-spring-memcached/source/browse/#svn%2Ftrunk%2Fspring-cache-integration-test)在 SSM svn 中可用。

更新：带有 Spring Cache 集成的[简单 Spring Memcached](http://code.google.com/p/simple-spring-memcached/) 3.0.0 已经可用。

# eclipse - 为什么 WTP 插件将一个 Maven 依赖项部署为文件夹而不是 jar？

> ID：11364556
> 
> 赞同：11
> 
> 时间：2012-07-06T14:51:08.220
> 
> 标签：eclipse, maven, maven-2, eclipse-wtp

我对 Maven 和 Eclipse WTP 有一个非常奇怪的问题。我有一个多模块项目，我们称之为`project`. 它由两个模块`project-base`和`project-web`. 我启用了工作区分辨率（它可以与其他几个非常相似的 Maven 项目一起正常工作）。

`project-base`是的依赖项`project-web`，通常部署为 jar 文件。但是几天来，它一直被部署为我本地 Tomcat 中的类文件夹，如您在此处看到的： ![依赖项部署为文件夹，而不是 jar](../Images/0e0024ba374edffe7d120cd3a7453960.png)

因此，我的 Tomcat 无法识别其中的任何类文件，因为它希望它们是 jar，而不是文件夹。`-tests`后缀来自需要在我的 web 项目中进行基础测试。我不认为这是问题所在。

`project-web`从工作区解析三个依赖项。其中两个已正确部署为 jar，但第三个未正确部署。

`project-base`的 pom.xml 如下所示：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <artifactId>project</artifactId>
        <groupId>com.company.project</groupId>
        <version>4.0.0</version>
    </parent>
    <artifactId>project-base</artifactId>
    <name>projectBase</name>
    <packaging>jar</packaging>

    <properties>
        <project.build.sourceEncoding>windows-1251</project.build.sourceEncoding>
    </properties>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-jar-plugin</artifactId>
                <version>2.3.2</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>jar</goal>
                            <goal>test-jar</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-site-plugin</artifactId>
                <version>3.0</version>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-project-info-reports-plugin</artifactId>
                <version>2.4</version>
            </plugin>
        </plugins>
    </build>
</project> 
```

`project-base`定义的依赖`project-web`项如下所示：

```
<dependency>
    <groupId>com.company.project</groupId>
    <artifactId>project-base</artifactId>
    <version>${project.version}</version>
</dependency>

<dependency>
    <groupId>com.company.project</groupId>
    <artifactId>project-base</artifactId>
    <version>${project.version}</version>
    <type>test-jar</type>
    <scope>test</scope>
</dependency> 
```

我不知道为什么以这种奇怪的方式部署一个依赖项，我不知道如何解决这个问题。我清理了项目，tomcat，重新部署了 web 项目，清除了我的整个 Maven 存储库，从 VCS 中检查了整个项目，没有任何帮助。

什么可能导致 Eclipse WTP 将此依赖项部署为文件夹而不是 jar 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-28T09:03:50.770

我通过删除“部署程序集”项目设置页面中的依赖项并将其添加回来解决了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T14:17:25.907

我只是有同样的问题。将 m2e 升级到 1.2 版修复了它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-10T09:07:06.757

如果该文件夹是一个展开的 JAR（所以它就像一个 JAR 文件，但显示为一个文件夹，而不是存档），在我的情况下，这是一个服务器连接器问题。

尽管我使用 JBoss 而不是 Tomcat，但这可能对其他解决此问题的人有所帮助。

如果您在 Eclipse 上安装了最新的 JBoss 工具，您可以在服务器视图中双击服务器以打开设置。

在**部署**选项卡上，您可以为每个项目选择**Zip Module Yes/No。**当我为我的实用程序 jar 文件选择 YES 时，JBoss 然后将依赖项部署为普通 JAR 文件而不是文件夹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-05T10:01:12.153

我最终解决了我的问题：我在项目的属性部分*部署程序集中*`project-base`遇到了问题。正如 Eclipse 所提到的，我无法保存它，当前页面确实包含错误。

然后我查看了设置文件`.settings/org.eclipse.wst.common.component`。它完全是空的（我不知道为什么）。然后我添加了以下块：

```
<?xml version="1.0" encoding="UTF-8"?>
<project-modules id="moduleCoreId" project-version="1.5.0">
    <wb-module deploy-name="project-base">
        <wb-resource deploy-path="/" source-path="/src/main/java"/>
        <wb-resource deploy-path="/" source-path="/src/main/resources"/>
    </wb-module>
</project-modules> 
```

在此之后，设置页面可再次访问，并且 JAR 已正确组装。工作区分辨率也确实有效。

# jquery - 使用导航菜单状态使用 jQuery 将文本从打开切换到关闭

> ID：11364558
> 
> 赞同：0
> 
> 时间：2012-07-06T14:51:18.827
> 
> 标签：jquery, navigation, toggle

我已经为我想到的菜单制作了一个 jQuery 切换。我想知道如何使 html 箭头具体说明导航状态是什么，即在导航隐藏时指向下方，在打开菜单时指向上方。

我对 jQuery 的了解是非常基础的，这是我不太了解的东西。

**HTML 代码：**

```
<div class="wrap">
  <nav class="site-nav">
    <ul>
      <li>Item 1</li>
      <li>Item 2</li>
      <li>Item 3</li>
      <li>Item 4</li>
    </ul>
  </nav>

  <div class="site-nav-wrap">
    <div class="site-nav-toggle">
      &#x2193; menu &#x2191;
    </div>
  </div>

  <header>
    <h1>Header title</h1>
  </header>

  <article>
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed fringilla vulputate lectus nec interdum. Praesent dapibus consectetur ante, vel pellentesque metus dapibus sed. Morbi urna tortor, mattis ornare interdum vitae, vehicula eget odio. In mi erat, pulvinar eu convallis non, aliquet eu neque.</p>
  </article>
</div> 
```

**CSS 代码：**

```
.wrap {
  margin: auto;
  width: 320px;
}
.site-nav {
  background: rgb(66,66,66);
  border-bottom: 2px solid rgb(55,55,55);
  border-bottom-right-radius: 5px;
  border-bottom-left-radius: 5px;
  display: block;
  float: left;
  margin: 0;
  padding: 0 10px 10px 10px;
  width: 100%;
}
.site-nav-wrap {
  height: 75px;
  float: left;
  overflow: hidden;
  width: 100%;
}
.site-nav-toggle {
  background-color: rgb(200,200,200);
  border-bottom-right-radius: 150px;
  border-bottom-left-radius: 150px;
  color: rgb(3,3,3);
  clear: both;
  cursor: pointer;
  display: block;
  height: 75px;
  line-height: 75px;
  margin: -20px auto 40px auto;
  text-align: center;
  transition: color .5s ease;
  width: 150px;
}
.site-nav-toggle:hover {
  background-color: rgb(3,3,3);
  color: rgb(200,200,200);
  transition: color .5s ease;
}
li { 
  margin-top: 10px;
} 
```

**Javascript代码：**

```
$(document).ready(function() {

  //Menu Open Seasame Action    
  $('.site-nav-toggle').click(function() {
      $('.site-nav').slideToggle();
  });

  //Hide site-nav content.    
  $(".site-nav").hide();
}); 
```

这个例子可以在这个jsFiddle上看到：http: [//jsfiddle.net/FsmhB/14/](http://jsfiddle.net/FsmhB/14/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:57:27.297

我将箭头包裹在跨度中并默认隐藏向上箭头。当点击事件发生时，跨度切换隐藏/显示；

HTML

```
<div class="site-nav-wrap">
    <div class="site-nav-toggle">
        menu  <span>&#x2193;</span><span style="display: none;">&#x2191;</span>
    </div>
</div> 
```

jQuery

```
$('.site-nav-toggle').click(function() {
    $('.site-nav').slideToggle();
    $(this).find('span:hidden').show().siblings().hide();
}); 
```

小提琴：http: [//jsfiddle.net/iambriansreed/FsmhB/21/](http://jsfiddle.net/iambriansreed/FsmhB/21/)

# android - 列表视图值导致错误

> ID：11364560
> 
> 赞同：0
> 
> 时间：2012-07-06T14:51:21.533
> 
> 标签：android, database

我在一个活动中有一个数据库，我想在另一个活动中打开，在这个活动中我也希望创建一个列表视图：

我的代码如下

```
messagedb=context.openOrCreateDatabase("message",0, null);
                    messagedb.execSQL(
                            "CREATE TABLE IF NOT EXISTS tab( " +
            " _id INTEGER PRIMARY KEY AUTOINCREMENT ," +
            " nickname varchar,sender INT(13),body varchar)");

                    messagedb.execSQL("INSERT INTO tab VALUES('"+nickname+"','"+sender+"','"+sb+"')");
                    messagedb.close();
                    mydb.close(); 
```

当我插入值时，它说您的数据库有 4 列，但您输入了 3 列值......我怎样才能从表中自动添加 _id......

我的 listView 活动如下

```
public class ListView extends ListActivity {

SQLiteDatabase messagedb;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.my_list);

    messagedb=ListView.this.openOrCreateDatabase("message",0, null);
    messagedb.execSQL(
            "CREATE TABLE IF NOT EXISTS tab(" +
            " _id INTEGER PRIMARY KEY AUTOINCREMENT," +
            " nickname varchar,sender INT(13),body varchar)");

    Cursor cur = messagedb.rawQuery("select _id, nickname, body from tab", null);
    String[] from = new String[] { "nickname", "body" };
    int[] to = new int[] { R.id.sender_entry, R.id.body_entry};

    SimpleCursorAdapter mAdapter = new SimpleCursorAdapter(this, R.layout.my_list_entry, cur, from, to);

    this.setListAdapter(mAdapter);

    cur.close();

    messagedb.close();

}

protected void onListItemClick(android.widget.ListView l, View v, int position, long id) {
    // TODO Auto-generated method stub
    super.onListItemClick(l, v, position, id);

    String nickName = ((TextView) v.findViewById(R.id.sender_entry)).getText().toString();

    String body = ((TextView) v.findViewById(R.id.body_entry)).getText().toString();

    Intent intent = new Intent(ListView.this,MessageViewPage.class);
    Bundle b = new Bundle();

    b.putString("nick", nickName);
    b.putString("body", body);

    intent.putExtras(b);

    startActivity(intent);

    finish();

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:11:29.903

这个：

```
" _id INTEGER PRIMARY KEY ," 
```

如果您希望数据库自动为您处理主键，则应该是这样：

```
" _id INTEGER PRIMARY KEY AUTOINCREMENT," 
```

否则，您需要在插入时手动添加“_id”。

使用`autoincrement`是迄今为止更容易的解决方案。

然后，如果您想要记录中的所有数据，只需执行以下操作：

```
Cursor cur = messagedb.rawQuery("select * from tab", null); 
```

如果您只想要特定的位，只需调用它们（但请记住，在使用大多数 Android 小部件时，您**必须**在`_id`光标中，即使您不显示它）。因此，如果您只想要昵称，您的查询可能如下所示：

```
Cursor cur = messagedb.rawQuery("select _id, nickname from tab", null); 
```

您还应该只有在一个地方创建表的代码。把它放在两个地方是很糟糕的。看起来现在发生的事情是您更改了一个但没有更改另一个，并且您未更改的那个首先被调用，在没有更改的情况下创建表，然后当第二个被调用时，表 alre4ady 存在所以它不不要做出改变。至少您需要将两个表创建语句更改为相同。更好的解决方案是摆脱其中之一。

您还应该使用 ContentValues 进行插入...

```
ContentValues initialValues = new ContentValues();
initialValues.put("nickname", nickname);
initialValues.put("sender", sender);
initialValues.put("body", sb);
messagedb.insertWithOnConflict(tab, null, initialValues, SQLiteDatabase.CONFLICT_IGNORE); 
```

哦，如果您在列表仍处于活动状态时关闭光标，您将遇到问题。摆脱`cur.close()`呼叫，而是`startManagingCursor(cur);`在获得光标后一切正常。这样系统将为您管理光标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:14:29.783

尝试将您的 ID 设置为自动增量：
ID 整数主键自动增量
我还建议使用 ContentValues 使用方法 sqlDB.insert(table, nullColumnHack, values) 将值插入 DB。它更容易，更不容易出错。

# ckeditor - 如何防止CKEDITOR在设计器内拖动图像

> ID：11364563
> 
> 赞同：1
> 
> 时间：2012-07-06T14:51:28.297
> 
> 标签：ckeditor

无论如何我可以防止在设计时拖放CKEditor内部的图像吗？

# facebook - Facebook 插件 ie8 和 ie7 SEC7111：HTTPS 安全性受到 https://www.facebook.com/plugins/comments.php 的威胁

> ID：11364564
> 
> 赞同：1
> 
> 时间：2012-07-06T14:51:31.760
> 
> 标签：facebook, internet-explorer-8, internet-explorer-7, facebook-comments

有没有人得到这个错误：

SEC7111：HTTPS 安全性受到[https://www.facebook.com/plugins/comments.php的威胁](https://www.facebook.com/plugins/comments.php)

在 IE8 和 IE7 中实现 Facebook 评论插件时：

```
<html lang="en"  xmlns:fb="http://ogp.me/ns/fb#">
...
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {

    //helps fix ie securrity errors
    FB._https = true;

    FB.init({
      appId      : '408511102504009', // App ID
      channelUrl : '//mv.uat.venda.com/page/channel.html', // Channel File
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });

    // Additional initialization code here
  };

  // Load the SDK Asynchronously
  (function(d){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all.js";
     ref.parentNode.insertBefore(js, ref);
   }(document));
</script>

<fb:comments href="http://mv.uat.venda.com/denim/test-outfit/invt/7999999999996/" num_posts="3" width="395"></fb:comments> 
```

# opencl - 向量的原子

> ID：11364567
> 
> 赞同：0
> 
> 时间：2012-07-06T14:51:50.137
> 
> 标签：opencl, atomic

我有一些`atomic_cmpxchg`需要类似操作的 OpenCL 代码，但是 for `int4`(or `long2`) 而不是`int`or `long`。经过几次尝试，我没有设法创建它，谷歌搜索对我没有任何用处。我的代码现在看起来像这样：

```
int4 atomicCAS(__global int4 *place, int4 new_val)
{
    int4 old = *place;
    if (atomic_cmpxchg((int*)place, 0, new_val.x) == 0)
    {
        *place = new_val;
    }
    return old;
} 
```

它检查该位置是否包含零向量并使用有关数据的一些附加知识：在非零`int4`向量中，所有分量均非零。

但是，这段代码不起作用，我无法让它工作：似乎没有办法将 int4* 转换为 int*，它指向向量的第一个（或任何其他）分量。

**升级版：**

而且，当然，我也对执行此操作的一般方法感兴趣，而无需对数据有这样的了解。

**UPD2：**

首次发布的代码不是原子的。更正版本（它有效，使用第一个答案）：

```
typedef union
{
    int4 m_int4;
    int m_ints[4];
} int4ints;

int4 atomicCAS(__global int4ints *p, int4 new_val)
{
    int4 old;

    if (atomic_cmpxchg(&p->m_ints[0], 0, new_val.x) == 0)
    {
        p->m_int4 = new_val;
        old = 0;
    } else
    {
        old = p->m_int4;
    }
    return old;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T03:47:50.923

您可以使用联合来代替强制转换，例如：

```
 typedef struct
{
        union
        {
                int4 m_vecInt;
                int m_ints[4];
         }
} MyIntCastingType;

int4 atomicCAS(__global MyIntCastingType *place, int4 new_val)
{
    int4 old = place->m_vecInt;
    if (atomic_cmpxchg(&place->m_ints[0], 0, new_val.x) == 0)
    {
        place->m_vecInt = new_val;
    }
} 
```

# python - 从管理员删除任何记录时出现Django DatabaseError？

> ID：11364568
> 
> 赞同：0
> 
> 时间：2012-07-06T14:51:56.580
> 
> 标签：python, django, django-models, django-admin

我在这里问了一个关于 manytomanyfield 的问题，我解决了这个问题，但现在提出了一个新问题，

```
DatabaseError at /admin/myapp/photo/8/delete/

relation "woek_gallery_photos" does not exist
LINE 1: DELETE FROM "woek_gallery_photos" WHERE "photo_id" IN ... 
```

我知道为什么会出现这个问题，但我不知道该怎么做。我有一个与 Group 模型和 Gallery 模型有关的照片模型。当我从图库中添加图像时效果很好，但删除它时，会引发 Group 没有任何关系的问题...

```
class Gallery(models.Model):
    ....
    photos = models.ManyToManyField('Photo', related_name='galleries', 
             verbose_name=_('Gallery'),
                                    null=True, blank=True)

class Group(models.Model):
    ...
    photos = models.ManyToManyField('Photo', related_name='galleries', 
             verbose_name=_('Group'),
                                    null=True, blank=True, 
                                    through='through=GroupPhotos')

class Photo(models.Model):
    image = models.ImageField(verbose_name = "Browse", 
                              upload_to=myPath) 
```

感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T15:06:49.393

`Photo`该错误意味着和之间的关系的连接表`Gallery`丢失或从未创建过。如果您还没有这样做，请运行：

```
python manage.py syncdb 
```

如果这仍然不起作用，请手动创建表。你可以运行：

```
python manage.py sqlall yourapp 
```

获得正确的 SQL 来使用。查找它创建`woek_gallery_photos`并复制该位的行。然后运行：

```
python manage.py dbshell 
```

并将其粘贴到提示符处。点击进入，你应该很高兴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:07:18.460

`relation "woek_gallery_photos" does not exist`表示表“woek_gallery_photos”不存在。您是否在创建 Photo 模型后忘记运行 syncdb？

# sql - 在存储过程中获取参数后设置参数

> ID：11364569
> 
> 赞同：0
> 
> 时间：2012-07-06T14:51:59.883
> 
> 标签：sql, stored-procedures

现在我在将文件上传到服务器时有一个上传字段。前缀被保存，以便以后可以获取它以进行检索。为此，我需要将表单的 ID 附加到前缀。我希望能够这样做：

```
 @filePrefix = SCOPE_IDENTITY() + @filePrefix; 
```

但是我不太确定这是否可行，因为尚未创建记录。如果有的话，我可以调用一个更新函数来获取 ID，然后在创建后将其注入行中。为了加快速度，我不想在服务器上执行此操作，而是在数据库上执行此操作。

无论方法是什么，我仍然想知道是否可以使用上述方法（至少供将来参考？）所以如果我们将其替换为

```
 @filePrefix = 5 + @filePrefix; 
```

那可能吗？SQL 似乎不太喜欢当前的语法......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:07:30.027

虽然您可以使用[IDENT_CURRENT](http://msdn.microsoft.com/en-us/library/ms175098.aspx)来尝试预测该值，但我建议您不要这样做。

如果你想设置变量试试这个：

```
SET @filePrefix = 5 + @filePrefix 
```

我对你的说法有点困惑 你`To speed things up, I don't want to do this on the server but rather do this on the database.` 这是什么意思？

# perl - 在 Perl 中解析 XML 文档

> ID：11364570
> 
> 赞同：1
> 
> 时间：2012-07-06T14:52:07.917
> 
> 标签：perl, xml-parsing

我有一个按以下方式排列的奇怪 XML 文档

```
<a>
   <b>
     <c c1="blah" c2="blah">
        <d d1="blah0" d2="blah1" d3="blah2" d4="blah3" d5="blah4" />
        <d d1="blah5" d2="blah6" d3="blah7" d4="blah8" d5="blah9" />
        <d d1="blah10" d2="blah11" d3="blah12" d4="blah13" d5="blah14" />
     </c>
     <c c1="blahc" c2="blah">
        <d d1="blah0" d2="blah1" d3="blah2" d4="blah3" d5="blah4" />
        <d d1="blah5" d2="blah6" d3="blah7" d4="blah8" d5="blah9" />
        <d d1="blah10" d2="blah11" d3="blah12" d4="blah13" d5="blah14" />
     </c>
    ...
  <b>
    ....
  </b>
  <e/>
</a> 
```

我想为所有节点中的所有节点提取`d2`,`d4`的值。`d5``c``b`

我尝试使用[`XML::Simple`](https://metacpan.org/module/XML%3a%3aSimple)并在数组引用方面遇到了很多困难。我尝试使用[`XML::DOM`](https://metacpan.org/module/XML%3a%3aDOM)，但考虑到我的 XML 文件大小为 500MB，这似乎不是一个好的选择。请提出一个好的方法，因为我是 Perl 的新手

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:25:38.327

您的问题有点令人困惑，您想要元素的属性`d`，而不是元素的属性`c`。或者，无论下面的元素`c`是什么，您都想要属性的值。

无论如何，特别是如果文件很大，这看起来很适合[`XML::Twig`](https://metacpan.org/module/XML%3a%3aTwig)：

```
#!/usr/bin/perl

use strict;
use warnings;

use XML::Twig;

XML::Twig->new( twig_handlers => { 'b/c/*' => \&get_atts })
         ->parse( \*DATA); # replace by parsefile( 'my.xml') 

sub get_atts
  { my( $t, $elt)= @_;
    foreach my $att ( qw( d2 d4 d5))
      { print "$att: ", $elt->att( $att), " "; }
    print "\n";
    $t->purge; # this frees the memory so you keep at most 1 d element 
  }

__DATA__
<a>
   <b>
     <c c1="blah" c2="blah">
        <d d1="blah0" d2="blah1" d3="blah2" d4="blah3" d5="blah4" />
        <d d1="blah5" d2="blah6" d3="blah7" d4="blah8" d5="blah9" />
        <d d1="blah10" d2="blah11" d3="blah12" d4="blah13" d5="blah14" />
     </c>
     <c c1="blahc" c2="blah">
        <d d1="blah0" d2="blah1" d3="blah2" d4="blah3" d5="blah4" />
        <d d1="blah5" d2="blah6" d3="blah7" d4="blah8" d5="blah9" />
        <d d1="blah10" d2="blah11" d3="blah12" d4="blah13" d5="blah14" />
     </c>
  </b>
  <b>
  </b>
  <e/>
</a> 
```

如果属性总是在`d`元素中，用 替换`'b/c/*'`，`'b/c/d'`这样效率更高。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T17:02:57.930

CPAN 中有许多 XML 模块可以帮助您解决此问题，但在这种情况下，我的钱是在 上[`XML::XPath`](https://metacpan.org/module/XML%3a%3aXPath)，它允许您简洁地描述您想要从 XML 中提取的数据。

该程序使用您的样本数据并提供我认为您想要的输出（尽管严格来说没有任何节点的`d="xx"`属性）。`<c>`

```
use strict;
use warnings;

use feature 'say';

use XML::XPath;

my $xml = XML::XPath->new(ioref => \*DATA);

for my $cnode ($xml->find('//b/c/d')->get_nodelist) {
  for ($cnode->find('@d2|@d4|@d5')->get_nodelist) {
    print $_->getData, "\n";
  }
}

__DATA__
<a>
   <b>
     <c c1="blah" c2="blah">
        <d d1="blah0" d2="blah1" d3="blah2" d4="blah3" d5="blah4" />
        <d d1="blah5" d2="blah6" d3="blah7" d4="blah8" d5="blah9" />
        <d d1="blah10" d2="blah11" d3="blah12" d4="blah13" d5="blah14" />
     </c>
     <c c1="blahc" c2="blah">
        <d d1="blah0" d2="blah1" d3="blah2" d4="blah3" d5="blah4" />
        <d d1="blah5" d2="blah6" d3="blah7" d4="blah8" d5="blah9" />
        <d d1="blah10" d2="blah11" d3="blah12" d4="blah13" d5="blah14" />
     </c>
    ...
  </b>
  <e/>
</a> 
```

**输出**

```
blah1
blah3
blah4
blah6
blah8
blah9
blah11
blah13
blah14
blah1
blah3
blah4
blah6
blah8
blah9
blah11
blah13
blah14 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T15:42:20.767

使用[xsh](http://p3rl.org/XML%3a%3aXSH2)：

```
for a/b/c/d ls (@d2 | @d4 | @d5); 
```

**更新：（**对于 mirod）：使用 Perl 中的 XML::XSH2 不太优雅，但仍然可以工作 -

```
#!/usr/bin/perl
use strict;
use warnings;

use XML::XSH2;

xsh q{
    open 1.xml ;
    for /a/b/c/d {
        for my $attr in (@d2 | @d4 | @d5) {
            perl { push @ar, $attr }
        }
    }
};

printf "%s:%s\n", $_->name, $_->value for @XML::XSH2::Map::ar; 
```

或者，让 Perl 为您编写 xsh 代码：

```
#!/usr/bin/perl
use warnings;
use strict;

use XML::XSH2;

xsh 'open 1.xml';
xsh '$attributes = (' . join('|', map 'a/b/c/@d' . $_, 1, 2, 4) . ')';
for (@$XML::XSH2::Map::attributes) {
    print $_->name, '=', $_->value, "\n";
} 
```

# powershell - PowerShell 中的命令重定向运算符

> ID：11364576
> 
> 赞同：1
> 
> 时间：2012-07-06T14:52:20.467
> 
> 标签：powershell

我想了解如何将 PowerShell 中某些程序的输出重定向到文件。在 cmd 我曾经这样做：

```
some.exe > test.in 
```

在这样的 PowerShell 中：

```
.\some.exe > test.in 
```

但是这段代码不起作用：

```
for($i = 0; $i -le 5; $i++)
{
  & '.\some.exe > test.in'
} 
```

那么，你能告诉我，我应该怎么做才能让它发挥作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:06:42.837

这是一个有效的例子

```
for($i = 0; $i -le 5; $i++)
{
    nslookup.exe www.google.com | findstr "Addresses:" >> test.in
} 
```

# javascript - Google Chrome - 在不需要时提供翻译

> ID：11364577
> 
> 赞同：2
> 
> 时间：2012-07-06T14:52:21.567
> 
> 标签：javascript, html, css, google-chrome, browser

所以我写了一个页面，但一直提示将页面翻译成英文（来自印度尼西亚语）。已经是英文的了，不知道怎么回事。我四处搜索并尝试了一堆修复程序，但似乎没有一个有效。

我在脑海中包含了这些东西：

```
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta charset="UTF-8" />
    <meta name="google" value="notranslate" />
    <meta http-equiv="Content-Language" content="en" />
    <meta name="viewport" content="width=1000" />  
    .
    .
    . 
```

为了抵消翻译的东西。不幸的是，这不起作用。有谁知道可能导致这种行为的原因？我真的希望我们可以使用 CSS 隐藏翻译栏，但可惜的是，谷歌很聪明，改变了结构，所以它不是页面中的 div……任何帮助都会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T14:55:34.670

它是“内容”，而不是“价值”：

```
<meta name="google" content="notranslate" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T16:06:50.300

如果您可以控制服务器响应，则可以发送`Content-Language`Chrome 将接受的响应标头。例如：

我想你说你正在使用 JSP：

```
response.setHeader("Content-Language, "en"); 
```

这是 ASP.Net 的：

```
Response.AddHeader("Content-Language", "en"); 
```

ETC...

# objective-c - 如何从 iOS 中的磁场属性中获取度数？

> ID：11364589
> 
> 赞同：1
> 
> 时间：2012-07-06T14:53:16.263
> 
> 标签：objective-c, ios, class, magnetometer, degrees

来自 Apple 的文档：

```
@property(readonly, nonatomic) CMMagneticField magneticField 
```

*返回由磁力计测量的磁场。（只读）*

*此属性的值是设备观察到的总磁场，它等于地球的地磁场加上从设备本身及其周围环境引入的偏置。*

```
@property(readonly, nonatomic) CMCalibratedMagneticField magneticField 
```

*此属性返回的 CMCalibratedMagneticField 为您提供了设备附近的总磁场，没有设备偏差。与 CMMagnetometer 类的磁场属性不同，这些值反映了地球磁场加上周围磁场，减去设备偏置。*

如果我想获得设备与北方的度数偏差，我需要使用两者中的哪一个？也就是说，iPhone 上的数字罗盘将根据设备面向的位置（例如 90、180、193 等）显示的值

我知道以上都没有以整数格式返回度数。文档不清楚它们到底返回了什么.. 我认为是 MicroTeslas ..

但是，如果他们*确实*返回了一个 MicroTesla 值，我该如何将此值转换为表示度数的整数？我是否必须将该 MicroTesla 值乘以某个常数或类似性质的东西？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-08T13:40:08.603

作为旁注，如果您想获得当前位置的磁偏角，您可以简单地从真实航向中减去磁航向。该数字对于将磁罗盘方位转换为真北方位很有用。

```
CLLocationDirection magneticDeclination = newHeading.trueHeading - newHeading.magneticHeading; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T14:57:23.860

您需要测量`heading`您从中获得的设备`CLLocationManager`。以下是您开始获取标题更新的方式（首先导入核心位置框架）-

```
if([CLLocationManager headingAvailable]) //check if device has magnetometer
    [locationManager startUpdatingHeading]; 
```

在此之后，您将在此代表中获得更新-

```
- (void)locationManager:(CLLocationManager*)manager 
       didUpdateHeading:(CLHeading*)newHeading
{
    // If the accuracy is valid, process the event.
    if (newHeading.headingAccuracy > 0)
        CLLocationDirection theHeading = newHeading.magneticHeading;

    return;
} 
```

so`CLLocationDirection`表示相对于真北以度为单位测量的方向。

方向值以度为单位测量，从正北开始，并围绕罗盘顺时针继续。因此，北为 0 度，东为 90 度，南为 180 度，依此类推。负值表示方向无效。

希望他的帮助...

**更新：**请查看这些链接 - CLLocationManager 和 iPhone和iPhone 3.0[中的航向度](https://stackoverflow.com/questions/2043685/cllocationmanager-and-degrees-of-heading-in-iphone)[指南针：如何获取航向？](https://stackoverflow.com/questions/1043740/iphone-3-0-compass-how-to-get-a-heading)和[苹果参考](http://developer.apple.com/library/mac/#documentation/CoreLocation/Reference/CoreLocationDataTypesRef/Reference/reference.html)。

# xsd - JAXB 和 Spring OXM 的问题

> ID：11364590
> 
> 赞同：1
> 
> 时间：2012-07-06T14:53:21.080
> 
> 标签：xsd, jaxb2, unmarshalling, spring-oxm

我正在尝试解组一个基本的 XML 文档，如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<personnes xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="personnes.xsd">
  <personne>
    <prenom>toto</prenom>
    <nom>dupont</nom>
  </personne>
  <personne>
    <prenom>titi</prenom>
    <nom>durand</nom>
  </personne>
  <personne>
    <prenom>tata</prenom>
    <nom>lanvin</nom>
  </personne>
</personnes> 
```

对应的 XSD 在这里：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="personnes">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="personne" maxOccurs="unbounded">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="prenom" type="xs:string" />
                            <xs:element name="nom" type="xs:string" />
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

我系统地得到一个 UnmarshallingFailureException：

```
Caused by: org.springframework.oxm.UnmarshallingFailureException: JAXB unmarshalling exception; nested exception is javax.xml.bind.UnmarshalException
 - with linked exception:
[org.xml.sax.SAXParseException: cvc-elt.1: Cannot find the declaration of element 'personne'.]
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.convertJaxbException(Jaxb2Marshaller.java:664)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshal(Jaxb2Marshaller.java:585)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshal(Jaxb2Marshaller.java:568)
    at org.springframework.batch.item.xml.StaxEventItemReader.doRead(StaxEventItemReader.java:227)
    at org.springframework.batch.item.support.AbstractItemCountingItemStreamItemReader.read(AbstractItemCountingItemStreamItemReader.java:85)
    at org.springframework.batch.core.step.item.SimpleChunkProvider.doRead(SimpleChunkProvider.java:90)
    at org.springframework.batch.core.step.item.FaultTolerantChunkProvider.read(FaultTolerantChunkProvider.java:87)
    ... 56 more
Caused by: javax.xml.bind.UnmarshalException
 - with linked exception:
[org.xml.sax.SAXParseException: cvc-elt.1: Cannot find the declaration of element 'personne'.]
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.handleStreamException(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(Unknown Source)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshalStaxSource(Jaxb2Marshaller.java:597)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshal(Jaxb2Marshaller.java:578)
    ... 61 more
Caused by: org.xml.sax.SAXParseException: cvc-elt.1: Cannot find the declaration of element 'personne'.
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.handleStartElement(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.startElement(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.validation.ValidatorHandlerImpl.startElement(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.ValidatingUnmarshaller.startElement(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.InterningXmlVisitor.startElement(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.StAXEventConnector.handleStartElement(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.StAXEventConnector.bridge(Unknown Source)
    ... 65 more 
```

对于您的信息，我使用 Spring OXM。

我强烈怀疑这与我的 XSD 架构和可能的命名空间有关......

有人可以帮忙吗？

**编辑：这是相关的 Spring 配置：**

```
<bean id="personneItemReader" class="org.springframework.batch.item.xml.StaxEventItemReader">
        <property name="resource" value="classpath:personnes.xml" />
        <property name="fragmentRootElementName" value="personne" />
        <property name="unmarshaller" ref="jaxb2Marshaller" />
    </bean>

    <bean id="jaxb2Marshaller" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
        <property name="classesToBeBound">
            <list>
                <value>com.docapost.batch.xml.Personnes</value>
            </list>
        </property>
        <property name="schema" value="classpath:personnes.xsd" />
    </bean> 
```

编辑 2：如果我注释掉模式验证，则异常跟踪：

```
Caused by: org.springframework.oxm.UnmarshallingFailureException: JAXB unmarshalling exception; nested exception is javax.xml.bind.UnmarshalException
 - with linked exception:
[javax.xml.bind.UnmarshalException: unexpected element (uri:"", local:"personne"). Expected elements are <{}personnes>]
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.convertJaxbException(Jaxb2Marshaller.java:664)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshal(Jaxb2Marshaller.java:585)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshal(Jaxb2Marshaller.java:568)
    at org.springframework.batch.item.xml.StaxEventItemReader.doRead(StaxEventItemReader.java:227)
    at org.springframework.batch.item.support.AbstractItemCountingItemStreamItemReader.read(AbstractItemCountingItemStreamItemReader.java:85)
    at org.springframework.batch.core.step.item.SimpleChunkProvider.doRead(SimpleChunkProvider.java:90)
    at org.springframework.batch.core.step.item.FaultTolerantChunkProvider.read(FaultTolerantChunkProvider.java:87)
    ... 56 more
Caused by: javax.xml.bind.UnmarshalException
 - with linked exception:
[javax.xml.bind.UnmarshalException: unexpected element (uri:"", local:"personne"). Expected elements are <{}personnes>]
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.handleStreamException(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(Unknown Source)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshalStaxSource(Jaxb2Marshaller.java:597)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshal(Jaxb2Marshaller.java:578)
    ... 61 more
Caused by: javax.xml.bind.UnmarshalException: unexpected element (uri:"", local:"personne"). Expected elements are <{}personnes>
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallingContext.handleEvent(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.Loader.reportError(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.Loader.reportError(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.Loader.reportUnexpectedChildElement(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallingContext$DefaultRootLoader.childElement(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallingContext._startElement(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallingContext.startElement(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.InterningXmlVisitor.startElement(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.StAXEventConnector.handleStartElement(Unknown Source)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.StAXEventConnector.bridge(Unknown Source)
    ... 65 more
Caused by: javax.xml.bind.UnmarshalException: unexpected element (uri:"", local:"personne"). Expected elements are <{}personnes>
    ... 75 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:53:31.830

`personne`元素和类似乎没有链接`Personne`。如果您生成了模型，您可以尝试更改配置以使用上下文路径吗？

```
<bean id="personneItemReader" class="org.springframework.batch.item.xml.StaxEventItemReader">
    <property name="resource" value="classpath:personnes.xml" />
    <property name="fragmentRootElementName" value="personnes" />
    <property name="unmarshaller" ref="jaxb2Marshaller" />
</bean>

<bean id="jaxb2Marshaller" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
    <property name="contextPath" value="ocom.docapost.batch.xml"/>
</bean> 
```

# css - 设置静态车身宽度是个好主意吗？

> ID：11364593
> 
> 赞同：2
> 
> 时间：2012-07-06T14:53:28.620
> 
> 标签：css, width

我想知道你是否可以在body标签上放一个宽度？

例如：

```
body {
background: url(bg.png);
width: 1200px;
} 
```

那是糟糕的css，会导致问题吗？我只是想知道以供将来参考

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T14:55:41.580

绝对最好在正文中使用 div。它更灵活，也更有意义。

请参阅下面的示例，您可以实现与 div 相同的操作。

```
<body>
<div style="width:100%; height: 100%">
<div style="background: url(bg.png); width: 1200px;">
Does the same thing as the other thing, but is way more flexible. 
</div>
</div>
</body> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T14:57:51.647

这样做会使您的设计在您所针对的设备之外的设备上一文不值。你**不能**假设每个人都在一个 1200 像素宽度的屏幕上工作。

尤其是现在随着平板电脑、智能手机的兴起，恕我直言，不要这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-28T23:36:08.297

@nicholas 指出了一个很好的使用模式，将宽度放在身体内的 div 上，而不是放在身体本身上。这是良好做法的另一个原因（除了响应问题）是一些浏览器插件，如 Moz SEO 工具栏，将样式添加到 body 标签。

如果你在body上设置了一个固定的宽度，它可能会变成100%，使你的固定站点变成一个破碎的流体站点。

# android - 移动我的应用程序窗口？

> ID：11364594
> 
> 赞同：0
> 
> 时间：2012-07-06T14:53:29.857
> 
> 标签：android, window, move

我们有一个 android 应用程序，然后将宽度和高度设置为`wrap_content`.

我的 XML 代码是`main.xml`

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical" >
    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/ic_launcher"
        android:contentDescription="Move" />
</LinearLayout> 
```

我的活动代码是`MoveApplicationActivity.java`

```
package com.move;
import android.app.Activity;
import android.os.Bundle;
public class MoveApplicationActivity extends Activity 
{
    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
} 
```

我的`MoveApplication Manifest.xml`代码是

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.move"
    android:versionCode="1"
    android:versionName="1.0" >
    <uses-sdk android:minSdkVersion="15" />
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".MoveApplicationActivity"
            android:label="@string/app_name"
            android:theme="@android:style/Theme.DeviceDefault.Dialog.NoActionBar">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                    <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

请制定我的示例代码，不要忘记将此粗线添加到`Manifest.xml`.

**android:theme="@android:style/Theme.DeviceDefault.Dialog.NoActionBar"**

我不知道，如何移动应用程序窗口。请以编程方式指导我。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T17:31:52.603

你不能通过正常的方式做到这一点。

一个活动将覆盖整个屏幕，您无法更改它。

您可以尝试做的是创建一个具有透明主题的活动。然后你可以创建一个具有一定宽度和高度的 DialogFragment。

这将使您的应用在实际占据整个屏幕时看起来具有一定的大小。

我认为您无法控制 DialogFragment 位置的 X、Y 坐标。

# c# - 调试列表 .Count 抛出 ArgumentException

> ID：11364595
> 
> 赞同：2
> 
> 时间：2012-07-06T14:53:39.153
> 
> 标签：c#, .net, visual-studio, visual-studio-debugging

我有外部课程`Item`，如果我做：

```
List<Item> items = new List<Item>(); 
```

在调试期间将鼠标悬停在其上显示

> “items.Count”引发了“System.ArgumentException” int {System.ArgumentException} 类型的异常

我不能分享这个类的全部代码，但可能是什么原因。我反编译了类，我看到有 GetHashCode 和 Equals 方法被覆盖。这可能是一个原因吗？

**编辑**：

在调试中，行后

```
List<Item> items = new List<Item>(); 
```

使用即时窗口并在那里写 items.Count 我得到：

```
'items.Count' threw an exception of type 'System.ArgumentException'
base {System.SystemException}: {"Cannot find the method on the object instance."}
Message: "Cannot find the method on the object instance."
ParamName: null 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:11:18.647

快速查看 ILSpy 或 Reflector 显示`List<T>.Count`不可能引发该异常。

```
/// <summary>Gets the number of elements actually contained in the
///   <see cref="T:System.Collections.Generic.List`1" />.</summary>
/// <returns>The number of elements actually contained in the
///   <see cref="T:System.Collections.Generic.List`1" />.</returns>
public int Count
{
    get { return this._size; }
} 
```

鉴于您在调试期间收到此消息，我相信您有导致此异常的第 3 方控件或插件。尝试清理/重建、重新添加 3rd 方引用和/或[在安全模式下运行 Visual Studio](http://msdn.microsoft.com/en-us/library/ms241278%28v=vs.100%29.aspx)。

# sql - 无法将 tomcat 连接到 MSSQL 2008 R2

> ID：11364601
> 
> 赞同：0
> 
> 时间：2012-07-06T14:53:47.417
> 
> 标签：sql, jakarta-ee, tomcat

我正在尝试将我的 tomcat 服务器连接到 MS SQL 2008 R2 服务器。网络连接不是这里的问题。

我可以在一个简单的 java 应用程序中成功连接，但是当我尝试通过 tomcat7 连接时（在我的 Windows 7 工作站以及我的 Ubuntu 12.04 服务器上尝试过。

我能够在两个 tomcat 服务器上运行示例 servlet。

我的代码：

```
 public class DBConnector{`
 private java.sql.Connection  con = null;`
 private final String url = "jdbc:sqlserver://my.domain.com:";` 
```

//端口号、凭证等。这些都在标准的 java 应用程序中工作。

```
public DBConnector(){}

private String getConnectionUrl(){
    return url+ portNumber +";databaseName="+databaseName+";selectMethod="+selectMethod+";";
}

private java.sql.Connection getConnection(){
     try{
          Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver"); 
          con = java.sql.DriverManager.getConnection(getConnectionUrl(),userName,password);
          if(con!=null) System.out.println(getConnectionUrl());
     }catch(Exception e){
          e.printStackTrace();
          System.out.println("Error Trace in getConnection() : " + e.getMessage());

    }
     return con;
 }

    public void queryDB(){

    try{
        System.out.println("Connecting...");
         con= this.getConnection();
         if(con!=null){
             System.out.println("NotNull");

            java.sql.Statement statement = con.createStatement();
            String query="Select * from CAFE";            
            java.sql.ResultSet rs = null;
            System.out.println("made rs");
            rs = statement.executeQuery(query);
            System.out.println("Established what it is");
            java.sql.ResultSetMetaData rsmd = rs.getMetaData();
            System.out.println("Getting MetaData");`
 //Omitted the rest. 
```

它在 tomcat 中停止响应： rs = statement.executeQuery(query); 因为在控制台上，我从来没有看到“Established what it is”。

我正在为 Java 6 使用正确的 mssql 驱动程序版本。

我对此很陌生，所以很可能在这里犯了一个明显的错误。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T04:46:20.643

解决它。降级为：

# java版本

java版本“1.6.0_24”

现在工作正常。通过搜索引擎来到这里的人；参考这个： [Driver.getConnection hangs using SQLServer driver and Java 1.6.0_29](https://stackoverflow.com/questions/7841411/driver-getconnection-hangs-using-sqlserver-driver-and-java-1-6-0-29)

# c++ - 如何在运行时生成串行对象？

> ID：11364604
> 
> 赞同：-2
> 
> 时间：2012-07-06T14:54:02.307
> 
> 标签：c++, object, runtime, creation

让我用一个例子来解释最好。

假设您有可用于二叉树的节点类。您从包含整数的未知长度文件中获得数据，您只想将节点放在二叉树中。

如何在运行时创建一个具有不同名称（或内存地址）的节点对象来保存每个整数值。例如，在运行时，您必须创建一个名为 node_1 的对象来保存第一个整数并将其设为根，然后创建一个名为 node_2 的对象将其作为子节点添加到根中，然后使用 node_3 来保存第三个整数，依此类推...

如果我要使用**while 循环**并执行**node temp* = new node** ; 这会解决问题并使用不同的内存地址创建尽可能多的对象，并且我将每个内存地址保存在**向量**类型中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:09:47.867

备查。是的，new 确实会创建具有不同内存地址的新对象（因此不会覆盖旧对象）。

这是示例。[http://ideone.com/SbHd0](http://ideone.com/SbHd0)

# javascript - 将 javascript 部分重构为功能的过程或工具

> ID：11364605
> 
> 赞同：0
> 
> 时间：2012-07-06T14:54:03.023
> 
> 标签：javascript, refactoring

有时，我发现自己使用同一组语句，我想将这些语句转换为函数。是否有方法、步骤、程序或工具可以帮助我/帮助我这样做？

当我在 VS2008 中使用 C# 进行开发时，我会简单地突出显示一组语句，并告诉 VS 自动将它们转换为方法。

同样，如果没有工具，则可以使用程序。

**更新**

无需发布代码。这是基于我开发和重构 JS 代码的经验，我在其中发现了一组重复的代码，但我对更改代码持谨慎态度，因为我可能会破坏代码。

当您想用变量替换一组常用表达式时，搜索和替换很有用，例如替换`$(this)`为`$this`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T14:59:40.360

PHPStorm 有一个“重构方法”功能（OSX 上的 CMD-ALT-M），它可以做到这一点。

# c - Linux：识别内存中的页面

> ID：11364613
> 
> 赞同：6
> 
> 时间：2012-07-06T14:54:31.767
> 
> 标签：c, linux

我想知道一个大文件的哪一部分缓存在内存中。我正在使用来自[fincore](http://net.doit.wisc.edu/~plonka/fincore/)的一些代码，它的工作方式是：文件被 mmaped，然后 fincore 循环遍历地址空间并使用 mincore 检查页面，但由于文件大小（几个 TB），它非常长（几分钟） ）。

有没有办法在使用过的 RAM 页面上循环？它会快得多，但这意味着我应该从某个地方获取已使用页面的列表......但是我找不到一个方便的系统调用来允许它。

代码如下：

```
#include <errno.h> 
#include <fcntl.h> 
#include <stdio.h> 
#include <stdlib.h> 
#include <string.h> 
#include <sys/stat.h> 
#include <sys/types.h> 
#include <unistd.h> 
/* } */

#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>
#include <sys/mman.h>
#include <sys/sysinfo.h>

void
fincore(char *filename) {
   int fd;
   struct stat st;

   struct sysinfo info;
   if (sysinfo(& info)) {
    perror("sysinfo");
    return;
   }

   void *pa = (char *)0;
   char *vec = (char *)0;
   size_t pageSize = getpagesize();
   register size_t pageIndex;

   fd = open(filename, 0);
   if (0 > fd) {
      perror("open");
      return;
   }

   if (0 != fstat(fd, &st)) {
      perror("fstat");
      close(fd);
      return;
   }

   pa = mmap((void *)0, st.st_size, PROT_NONE, MAP_SHARED, fd, 0);
   if (MAP_FAILED == pa) {
      perror("mmap");
      close(fd);
      return;
   }

   /* vec = calloc(1, 1+st.st_size/pageSize); */
   /* 2.2 sec for 8 TB */
   vec = calloc(1, (st.st_size+pageSize-1)/pageSize);
   if ((void *)0 == vec) {
      perror("calloc");
      close(fd);
      return;
   }

    /* 48 sec for 8 TB */
   if (0 != mincore(pa, st.st_size, vec)) {
      fprintf(stderr, "mincore(%p, %lu, %p): %s\n",
              pa, (unsigned long)st.st_size, vec, strerror(errno));
      free(vec);
      close(fd);
      return;
   }

   /* handle the results */
   /* 2m45s for 8 TB */
   for (pageIndex = 0; pageIndex <= st.st_size/pageSize; pageIndex++) {
      if (vec[pageIndex]&1) {
         printf("%zd\n", pageIndex);
      }
   }

   free(vec);
   vec = (char *)0;

   munmap(pa, st.st_size);
   close(fd);

   return;
}

int main(int argc, char *argv[]) {
    fincore(argv[1]);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T17:48:37.010

对于所有或几乎所有页面确实在 RAM 中的悲观情况，表示列表所需的信息量远高于位图 - 每个条目至少 64 位对 1 位。如果有这样的 API，当查询它关于你的 20 亿页时，你必须准备在回复中获得 16 GB 的数据。此外，处理列表等可变长度结构比处理固定长度数组更复杂，因此库函数，尤其是低级系统函数，往往会避免麻烦。

我也不太确定实现（在这种情况下操作系统如何与 TLB 和 Co 交互），但很可能是（即使大小差异除外）填充位图可以比创建列表更快，因为从中提取信息的操作系统和硬件级结构。

如果您不关心非常精细的粒度，可以查看`/proc/<PID>/smaps`. 对于每个映射区域，它会显示一些统计信息，包括加载到内存中的数量（`Rss`字段）。如果出于调试的目的，您使用单独的`mmap()`调用映射文件的某些区域（除了用于执行实际任务的主映射之外），您可能会获得单独的条目`smaps`，从而看到这些区域的单独统计信息。几乎可以肯定，在不杀死系统的情况下，您无法进行数十亿次映射，但如果文件结构良好，那么仅针对几十个精心选择的区域进行单独统计可能会帮助您找到所需的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:02:41.733

被谁缓存？

考虑启动后文件位于磁盘上。它的任何部分都不在内存中。

现在打开文件并执行随机读取。

文件系统（例如内核）将被缓存。

C 标准库将被缓存。

内核将缓存在内核模式内存中，C 标准库在用户模式内存中。

如果您可以发出查询，也可能是在查询之后立即 - 在它返回给您之前 - 从缓存中删除有问题的缓存数据。

# jquery - 骨干模型保存上没有“获取”方法

> ID：11364615
> 
> 赞同：2
> 
> 时间：2012-07-06T14:54:41.943
> 
> 标签：jquery, backbone.js, requirejs

我将主干用于相当复杂的形式。我有许多嵌套模型，并且一直在计算父模型中的其他变量，如下所示：

```
// INSIDE PARENT MODEL

computedValue: function () {
    var value = this.get('childModel').get('childModelProperty');
    return value;
} 
```

这似乎可以很好地保持我的 UI 同步，但只要我打电话

```
.save() 
```

在父模型上，我得到：

```
Uncaught TypeError: Object #<Object> has no method 'get' 
```

似乎子模型暂时停止响应。

我做错了什么吗？

编辑：堆栈跟踪是：

```
Uncaught TypeError: Object #<Object> has no method 'get' publish.js:90
Backbone.Model.extend.neutralDivisionComputer publish.js:90
Backbone.Model.extend.setNeutralComputed publish.js:39
Backbone.Events.trigger backbone.js:163
_.extend.change backbone.js:473
_.extend.set backbone.js:314
_.extend.save.options.success backbone.js:385
f.Callbacks.o jquery.min.js:2
f.Callbacks.p.fireWith jquery.min.js:2
w jquery.min.js:4
f.support.ajax.f.ajaxTransport.send.d 
```

编辑＃2以回应以下评论：

我仍然没有得到一些基本的东西。我替换了一些对 this.get('childModel')['childModelProperty'] 的引用，现在我得到了类似'无法读取未定义的属性 childModelProperty。

我还没有从服务器中提取任何东西，父模型只是像这样创建的

```
define(['jquery', 'underscore', 'backbone', 'models/childmodel'],    function($, _, Backbone, ChildModel) {
var ParentModel = Backbone.Model.extend({
defaults: {
   childModel : new ChildModel()
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T19:04:59.850

`defaults`仅在创建模型时使用。调用 save 后，它将调用`set`它将用一个简单的 javascript 对象覆盖 childModel。在我看来，您有几个选择：

1) 使用[Backbone.Relational](https://github.com/PaulUithol/Backbone-relational/)

2）在每个父模型中覆盖`set`以更新现有的子模型（或创建它），如下所示：

```
children:{
    childModel: ChildModel
}
set: function (key, value, options) {
                var attrs;
                if (_.isObject(key) || key == null) {
                    attrs = key;
                    options = value;
                } else {
                    attrs = {};
                    attrs[key] = value;
                }

                _.each(this.children, function (childType, name) {
                    if (!attrs.hasOwnProperty(name))
                        return;

                    //assume the child is just a model--not a collection
                    var newValue = attrs[name];
                    delete attrs[name];
                    var isModel = this[name] && this[name].set;
                    if (isModel && newValue) {
                        this[name].set(newValue, options);
                    }
                    else if (newValue) {
                        this[name] = new childType(newValue);
                    }
                    else {
                        delete this[name];
                    }

                    this.trigger('change:' + name);

                }, this);

                return Backbone.Model.prototype.set.call(this, attrs, options);             

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:13:16.517

有时您的 childModel 不包含 Backbone.Model，就像您被分配了其他类型的对象一样。

为避免错误，请执行此操作（并且在您的控制台中，您将获得有关错误 childModel 值的有用信息）：

```
computedValue: function () {
    var value;
    if( this.get('childModel') instanceof Backbone.Model ){
        value = this.get('childModel').get('childModelProperty');
    }else{
        console.log('This is weird, childModel is not a Backbone.Model', this.get('childModel') );
    }
    return value;
} 
```

# java - 动态矩阵生成器类

> ID：11364621
> 
> 赞同：0
> 
> 时间：2012-07-06T14:54:54.767
> 
> 标签：java, android, algorithm, dynamic, matrix

我需要一个动态矩阵生成器类，它将返回一个`int[4][4]`矩阵，**值应该在 1 到 16 之间，**并且**不会有重复值。**

矩阵解决方案将是这样的：

![在此处输入图像描述](../Images/de04c7246273fbf2b1e2abef16829b3d.png) 或者![在此处输入图像描述](../Images/bb511a35cacbf8ad6655bf720c97c434.png)

如果您仔细观察矩阵图像，您会发现**每个矩阵在矩阵值的位置都有特定的逻辑/模式**。模式是什么并不重要，但保持模式很重要（**这***意味着应该有任何类型的模式*）。目前我正在使用静态代码，例如：

```
// for the second image    
int temp4[][] = { { 1, 2, 3, 4 }, { 12, 13, 14, 5 },
                        { 11, 16, 15, 6 }, { 10, 9, 8, 7 } }; 
```

目前我有 3/4 的静态模式，但是静态实现这个是一种不好的方法，所以它应该是动态的，因为我需要随机模式运行时。

所以我的问题是：*是否有可能做出这样的解决方案？代码是什么？？*如果您知道与此相关的链接，请发布它或发布原始代码。

提前致谢。

* * *

**更新**

**这个问题的模式**是什么意思？

如果您仔细遵循第一个矩阵，您会发现数字就像第一行：1,2,3,4 然后第二行：5,6,7,8 等等..

对于第二个矩阵，它的第一行是 1,2,3,4 然后它下降为 5,6,7 然后返回为 8,9,10 依此类推。

另一种模式可能是这样的第一列：1,2,3,4 然后第二列：5,6,7,8 所以矩阵看起来像：

1 5 9 13

2 6 10 14

3 7 11 15

4 8 12 16 .. 等等

因此我需要一个矩阵生成器，它将返回`int[4][4]`从 1 到 16 的非重复值，并且值应该按顺序排列。另一种模式可能是：

![在此处输入图像描述](../Images/e046fdc1d4cbb60af2b3f86ffbcbfbac.png)和![在此处输入图像描述](../Images/07dc212fd243130cde7de745d4375b8a.png)

上面2个的模式是这样的：

![在此处输入图像描述](../Images/2ae83a892e0993bd65e63a2a0f94c498.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:58:09.603

根据您的更新，我将为每个模式创建一个策略。在每个模式中，您可以选择起点、方向以及升序或降序（如果允许）

一旦你有了一组模式，你可以随机选择一个并将其随机化，或者生成所有可能的模式并随机选择一个。

* * *

您可以使用 Collections.shuffle() 以随机顺序生成非重复值

然后，您可以测试您的矩阵，看看它是否有足够的模式或是否可以接受。如果没有，请重复，直到你这样做。

# .net - 使用 msbuild 和大型解决方案防止所有复制操作

> ID：11364626
> 
> 赞同：4
> 
> 时间：2012-07-06T14:55:09.747
> 
> 标签：.net, msbuild

我将立即承认对 msbuild 完全不熟悉，并希望我不是在问一个愚蠢的问题。

我们有一个大型 .NET 解决方案，其中包含大约 316 个项目。在构建过程中，将 DLL 从一个文件夹复制到下一个文件夹似乎占用了大量的构建时间（我假设，这样它们就可以用于解析引用？）。有没有办法指示 MSBuild 将每个项目的输出文件放入*一个*文件夹以避免需要这样做？看起来这将是一件明智的事情，因为最终我们将最终结果从最终输出文件夹中复制出来，而所有其他中间 DLL 都被浪费了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T18:34:10.760

可以通过覆盖`OutDir`属性来实现。例如：

```
msbuild your.sln /p:Configuration=Release;OutDir="C:\SomeFolder\Release" /m 
```

此外，您可以[禁用 CopyLocal 设置](https://stackoverflow.com/q/1682096/147211)以加快构建过程的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T02:26:23.157

请参阅[obj 和 bin 文件夹（由 Visual Studio 创建）的用途是什么？](https://stackoverflow.com/questions/5308491/what-are-the-obj-and-bin-folders-created-by-visual-studio-used-for)

确保它实际上是需要时间的副本。**使用/verbosity:diag**运行 msbuild 命令（或使用**/flp:Filename=<myfile>;Verbosity=diag**写入文件）。在文件末尾，您将看到每个步骤所用的时间。

您可以尝试使用**/m**选项并行化构建。默认情况下，msbuild 在 1 个线程上运行，并且有 316 个项目，我可以想象这可能会很慢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T11:42:11.010

构建 316 个项目是一次构建很多项目。您可以考虑将您的项目分解为分离依赖项的逻辑解决方案。

还可以通过将 max CPU count 属性设置为更高的值来并行构建项目来加快速度。

> BuildInParallel 是 MSBuild 任务的可选布尔参数。当 BuildInParallel 设置为 true（其默认值）时，会生成多个工作进程以同时构建尽可能多的项目。要使其正常工作，/maxcpucount 开关必须设置为大于 1 的值，并且系统必须至少是双核或具有两个或更多处理器。
> 
> 下面是一个示例，取自 microsoft.common.targets，关于如何设置 BuildInParallel 参数。/maxcpucount:number 指定构建中涉及的工作进程数。例如：C:\Windows\WinFX\v3.5>msbuild.exe *.proj /maxcpucount:3。此示例指示 MSBuild 使用三个 MSBuild.exe 进程进行构建，从而允许并行构建三个项目。/m 也是可以接受的。

# recursion - 计算子句的调用次数

> ID：11364634
> 
> 赞同：13
> 
> 时间：2012-07-06T14:55:35.440
> 
> 标签：recursion, count, prolog, clause

我有一个如下的子句：

```
lock_open:-
        条件组合（X），
        等于（X，[8,6,5,3,6,9]），！，
        打印（X）。

```

此子句成功。`equal(X,[8,6,5,3,6,9])`但我想知道 conditional_combination() 在变为 true之前被调用了多少次。该程序是通过遵循一些规则来生成一个排列。我需要生成多少排列才能获得像 865369 这样的特定值。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-09T17:41:47.227

您真正想要的是稍微不同的东西：您想要计算目标的答案数量（到目前为止）。

以下谓词`call_nth(Goal_0, Nth)`成功，`call(Goal_0)`但有一个附加参数，表明找到的答案是第 n 个答案。此定义高度特定于 SWI 或 YAP。不要在**你**的一般程序中使用类似的东西`nb_setarg/3`，而是将它们用于封装良好的情况，就像这个一样。即使在这两个系统中，这些构造的确切含义也没有针对一般情况很好地定义。[这是 SICStus 的定义](http://www.complang.tuwien.ac.at/ulrich/sicstus-prolog/call_nth.pl)。

```
call_nth(Goal_0, C) :-
   State = count(0,_), % 注意额外的参数，它仍然是一个变量
   目标_0，
   arg（1，状态，C1），
   C2 是 C1+1，
   nb_setarg（1，状态，C2），
   C = C2。

```

Eclipse 提供了一个更健壮的抽象：

```
call_nth(Goal_0, Nth) :-
   shelf_create(counter(0), CounterRef),
   call(Goal_0),
   shelf_inc(CounterRef, 1),
   shelf_get(CounterRef, 1, Nth). 
```

```
?- call_nth((1,5,I),Nth)。
我 = 第 N, 第 N = 1 ;
我 = 第 N，第 N = 2；
我 = 第 N，第 N = 3；
我=第N次，第N次= 4；
我 = 第 N 个，第 N 个 = 5。

```

所以简单地把它包起来：

```
lock_open :-
   call_nth(conditional_combination(X), Nth),
   X = [8,6,5,3,6,9]，
   ！，
   ……

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-06T17:30:11.943

如果您使用的是 SWI prolog，您可以使用`nb_getval/2`并`nb_setval/2`实现您想要的：

```
lock_open:- 
  nb_setval(ctr, 0),  % Initialize counter
  conditional_combination(X), 
  nb_inc(ctr),  % Increment Counter
  equal(X,[8,6,5,3,6,9]),
  % Here you can access counter value with nb_getval(ctr, Value)
  !, 
  print(X).

nb_inc(Key):-
  nb_getval(Key, Old),
  succ(Old, New),
  nb_setval(Key, New). 
```

其他 prologs 有其他方法可以做同样的事情，在你的 prolog 实现中寻找全局变量。在此代码段中，我使用该术语`ctr`来保存当前目标计数器。您可以使用程序中未使用的任何术语。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-05T16:43:38.803

在开发“微型”模块时，我最近发明了枢轴。它们受到线程/管道模式的启发来传递数据。枢轴是最大长度为 1 的有界队列，pivot_put/1 也是给定术语的副本。但是出于性能原因，它们不使用同步并且是非阻塞的。

到目前为止，它们与 nb_setarg/3 非常相似，只是它们不破坏 Prolog 术语，而是更新 Java 数据结构。因此，它们比非逻辑项操作更安全一些。他们也不需要一些 call_cleanup/3，因为它们是 Java 垃圾收集的。

就目前而言，它们比 nb_setarg/3 更相似，而不是使用一些显式分配和释放结构。例如，SICStus Prolog 的解决方案可能是：

```
call_nth(Goal_0, Nth) :-
   new(unsigned_32, Counter),
   call_cleanup(call_nth1(Goal_0, Counter, Nth),
           dispose(Counter)).

call_nth1(Goal_0, Counter, Nth) :-
   call(Goal_0),
   get_contents(Counter, contents, Count0),
   Count1 is Count0+1,
   put_contents(Counter, contents, Count1),
   Nth = Count1. 
```

使用数据透视表，甚至没有 32 位的限制，我们可以直接这样做：

```
call_nth(G, C) :-
   pivot_new(P),
   pivot_put(P, 0),
   call(G),
   pivot_take(P, M),
   N is M+1,
   pivot_put(P, N),
   C = N. 
```

# datatable - Wicket 数据表页脚

> ID：11364638
> 
> 赞同：1
> 
> 时间：2012-07-06T14:55:44.533
> 
> 标签：datatable, sum, wicket, footer

我想在数据表中添加页脚。它会做一些统计工作，比如“sum”。谁能告诉我如何做到这一点？如果你给我看一些例子，那就太好了。谢谢！

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-03T15:59:20.243

这是一个例子。在此示例中，我们将创建带有发票表格的页面。每行一张发票。表格底部将是工具栏，其中将显示所有发票的总和。

**Invoice.java**（代表一张发票的对象）

```
public class Invoice implements Serializable {

    private String description;
    private int sum;

    public Invoice() {}

    public Invoice(String description, int sum) {
        this.description = description;
        this.sum = sum;
    }

    // setters and getters
} 
```

**InvoiceDataProvider.java**（表的数据提供者）

```
public class InvoiceDataProvider implements IDataProvider {

    private List<Invoice> invoices;

    public InvoiceDataProvider(IModel<Double> sumModel) {
        invoices = new ArrayList<Invoice>();
        invoices.add(new Invoice("for rent", 550));
        invoices.add(new Invoice("for phone", 25));
        invoices.add(new Invoice("for insurance", 10));

        // reset sumModel
        sumModel.setObject(0.0);
        // count the sum of invoices
        for (Invoice invoice : invoices) {
            sumModel.setObject(sumModel.getObject() + invoice.getSum());
        }
    }

    @Override
    public void detach() {
    }

    @Override
    public Iterator iterator(long first, long count) {
        return invoices.iterator();
    }

    @Override
    public IModel model(final Object object) {
        return new AbstractReadOnlyModel<Invoice>() {
            @Override
            public Invoice getObject() {
                return (Invoice) object;
            }
        };
    }

    @Override
    public long size() {
        return invoices.size();
    }
} 
```

在数据提供者中，我们将数据显示在表格（发票列表）中。然后我们计算列表中发票的总和并将结果添加到模型中。

**InvoicesToolbar.java**（表格的工具栏。这里将显示发票的总和）

```
public class InvoicesToolbar extends AbstractToolbar {

    private IModel<Double> sumModel;

    public InvoicesToolbar(DataTable table, IModel sumModel) {
        super(table);

        this.sumModel = sumModel;

        add(new Label("sumText", Model.of("total sum")));
        add(new Label("sumNumber", sumModel));
    }
} 
```

我们保存 sumModel 并创建两个标签。标签“sumText”将显示文本“总和”，标签“sumNumber”将显示存储在模型（sumModel）中的值。

**InvoicesToolbar.html**（工具栏是面板，因此应创建适当的 html 文件）

```
<?xml version="1.0" encoding="UTF-8" ?>

<wicket:panel xmlns:wicket="http://wicket.apache.org">
    <tr>
        <td><span wicket:id="sumText"></span></td>
        <td><span wicket:id="sumNumber"></span></td>
    </tr>
</wicket:panel> 
```

我们创建一个包含两个单元格的表格行（表格将有两列）并添加带有 wicket id 的 html 元素以在那里呈现一些文本。

**DataTablePage.java**（带有表格的网页）

```
public class DataTablePage extends WebPage {

    public DataTablePage() {
        List<IColumn> columns = new ArrayList<IColumn>();
        columns.add(new PropertyColumn(Model.of("description"), "description"));
        columns.add(new PropertyColumn(Model.of("sum"), "sum"));

        IModel<Double> sumModel = new Model<Double>(0.0);

        DataTable table = new DataTable("table", columns, new InvoiceDataProvider(sumModel), 10);
        table.addTopToolbar(new HeadersToolbar(table, null));
        table.addBottomToolbar(new InvoicesToolbar(table, sumModel));
        add(table);
    }
} 
```

我们创建列列表（PropertyColumn - 值将是对象的属性）。我们创建模型（sumModel）。在此模型中，最近将存储发票的总金额。我们创建表。在此表（顶部）中，我们添加了标题工具栏（列的标题），并且（在底部）我们添加了 InvoiceToolbar。

**DataTablePage.html**（网页的 Html 标记）

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Table</title>
    </head>
    <body>
        <table wicket:id="table"></table>
    </body>
</html> 
```

* * *

在 wicket-core 依赖之上，我们还需要 wicket-extensions 依赖。该代码使用 wicket 6.18.0 进行了测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T15:03:40.907

当填充数据表时，例如使用 ListView，您应该增加一个整数模型，该模型稍后将在标签中使用。

```

     模型 sumModel = new Model(0);
        列表视图 = 新列表视图（...）{
            ...填充（列表项）{
                int N = // 你需要的任何值
                sumModel.setObject(sumModel.getObject() + N);
            }
        }
        添加（列表视图）；
        // ...
        标签 sumFooter = new Label("footer", sumModel);
        添加（总和页脚）；

```

PS：我没有测试过这个。

**编辑** 您还应该检查 CountLabel 组件

（[http://opensource.55minutes.com/apidocs/fiftyfive-wicket-all/4.0-SNAPSHOT/fiftyfive/wicket/basic/CountLabel.html](http://opensource.55minutes.com/apidocs/fiftyfive-wicket-all/4.0-SNAPSHOT/fiftyfive/wicket/basic/CountLabel.html)）

# ios - 拦截 didAddSubview

> ID：11364646
> 
> 赞同：1
> 
> 时间：2012-07-06T14:56:30.370
> 
> 标签：ios, uiview, uiviewcontroller, overriding, subclass

我希望这是一个简单的问题。我需要拦截`didAddSubview`，但我需要子类化`UIView`以覆盖该方法吗？

`UIView`我要覆盖的是'`UIViewController`属性`view`，所以我只想知道如何使用它。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T18:00:18.947

来自 Apple[`UIView`](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)文档（参见*Methods to Override*）：

> 当子类化 UIView 时，您应该重写的方法很少，并且您可以根据需要重写许多方法。因为 UIView 是一个高度可配置的类，所以也有许多方法可以实现复杂的视图行为，而无需覆盖自定义方法，这些将在“子类化的替代方案”部分中讨论。**同时，以下列表包括您可能考虑在 UIView 子类中覆盖的方法**：
> 
> *   ...
> *   `didAddSubview:`, `willRemoveSubview:`- 根据需要实现这些方法来跟踪子视图的添加和删除。
> *   ...

因此，创建您的`UIView`子类并覆盖该方法。然后，对您说`UIViewController`，`view`它将是您子类化的那个。要实现这一点，有几种方法：

*   由 Xib
*   实现`loadView`方法并将`view`属性设置为您的自定义视图
*   重新定义`view`财产`viewDidLoad`

希望有帮助。

# ruby-on-rails - 如何在工厂中保存局部变量

> ID：11364649
> 
> 赞同：13
> 
> 时间：2012-07-06T14:56:42.797
> 
> 标签：ruby-on-rails, factory-bot

我有这个例子

```
FactoryGirl.define do
  @site = FactoryGirl.create(:my_site)
  factory :user do
    email               { Faker::Internet.email }
    first_name          { Faker::Name.first_name }
    last_name           { Faker::Name.last_name }
    password            { 'TarXlrOPfaokNOzls2U8' }
    active_directory    { '0' }
    companies           { [FactoryGirl.create(:company, site: @site)] }
    sites               { [@site] }
  end
end 
```

有没有办法通过让或其他东西来实现这一点......

```
FactoryGirl.define do
  factory :user do
    email               { Faker::Internet.email }
    first_name          { Faker::Name.first_name }
    last_name           { Faker::Name.last_name }
    password            { 'TarXlrOPfaokNOzls2U8' }
    active_directory    { '0' }
    companies           { [FactoryGirl.create(:company, site: FactoryGirl.create(:my_site))] }
    sites               { [FactoryGirl.create(:my_site)] }

  end
end 
```

这有效，但它创建了两个 my_site 这是一个 Site 对象，但我需要它们相同......关于如何实现这一点的任何想法

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-06T15:07:35.997

可能最简单的是使用局部变量：

```
FactoryGirl.define do
  site = FactoryGirl.create(:my_site)

  factory :user do
    email               { Faker::Internet.email }
    first_name          { Faker::Name.first_name }
    last_name           { Faker::Name.last_name }
    password            { 'TarXlrOPfaokNOzls2U8' }
    active_directory    { '0' }
    companies           { [FactoryGirl.create(:company, site: site)] }
    sites               { [site] }
  end
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-04-20T14:41:31.757

我终于想出了一个好方法来做到这一点。这个问题已经很老了，但我想我会发布一个答案，以防其他人遇到这个问题。

您可以使用`before(:create)`回调（或者`before(:build)`如果那是您的用例）来设置`sites`集合，然后将网站集合的第一个元素分配给公司集合中新创建的公司。

可以在[此处](https://robots.thoughtbot.com/aint-no-calla-back-girl)找到有关 FactoryBot 回调的更多信息。

只是让读者知道，我不推荐使用新的`FactoryBot`类名`FactoryGirl`。

```
FactoryBot.define do
  factory :user do
    email               { Faker::Internet.email }
    first_name          { Faker::Name.first_name }
    last_name           { Faker::Name.last_name }
    password            { 'TarXlrOPfaokNOzls2U8' }
    active_directory    { '0' }

    before(:create) do |user|
      user.sites << FactoryBot.create(:my_site)
      user.companies << FactoryBot.create(:company, site: user.sites.first)
    end
  end
end 
```

# xcode - 数组的可控随机数

> ID：11364650
> 
> 赞同：1
> 
> 时间：2012-07-06T14:56:43.517
> 
> 标签：xcode, random, nsmutablearray

我有 10 个数字（使用 NSMutableArray）随机显示在 10 个不同的标签中。但我需要知道哪个号码对应哪个标签。这些是答案标签，我应该用问题检查它们是否是正确答案。但我应该每次都知道哪个答案在哪里。我怎样才能做到这一点？

任何人都可以帮忙吗？

```
for (int y=1; y<11; y++) {

NSString *name = [NSString stringWithFormat:@"cevapLabel%d", y];  
UILabel *label = [self valueForKey:name];

if (number ==1) {
    labelQ.text = [NSString stringWithFormat:@"%ix1=", [[arr objectAtIndex:(random()%9)+1] intValue]];

    myMutableArray = [[NSMutableArray alloc] initWithObjects:@"1",@"2",@"3",@"4",@"5",@"6",@"7",@"8",@"9",@"10", nil];

    srandom(time(NULL));
    NSUInteger count1 = [myMutableArray count];
    for (NSUInteger i = 0; i < count1; ++i) {
        int nElements = count1 - i;
        int n = (random() % nElements) + i;
        [myMutableArray exchangeObjectAtIndex: i withObjectAtIndex:n];
    } 
```

label.text = [NSString stringWithFormat:@"%i", [[myMutableArray objectAtIndex:y-1] intValue]]; } }

它会持续 10 个其他概率

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:01:50.860

NSView 和 UIView 对象（我无法从你那里得知你是为 OS X 还是为 iPhone / iPad 编写）都有一个标签属性。

您可以简单地将 NSMutableArray element[n] 后面的数据应用于标签的文本，将“n”值应用于标签的标签！！！

例子：

```
myLabel.text = [NSString stringWithFormat:@"%d", [myMutableArray objectAtIndex:n]];
myLabel.tag  = n; 
```

# c# - 线程完成后更改页面控件值？

> ID：11364652
> 
> 赞同：0
> 
> 时间：2012-07-06T14:56:46.157
> 
> 标签：c#, asp.net, multithreading

> **可能重复：**
> [asp.net 使用多线程更新 UI](https://stackoverflow.com/questions/857999/asp-net-update-ui-using-multi-thread)

我开始了一个线程在后台处理。我想在完成过程后更改页面上的标签。

但我的价值没有改变。

我的样本：

```
 protected void Page_Load(object sender, EventArgs e)
    {
         new Thread(() => ActionStart()) { IsBackground = true }.Start();
    }
    bool _shouldStop = false;

    public void ActionStart()
    {
        while (!_shouldStop)
        {
            // ....

            requestStop();
        }

        //thread finished
        ChangeValue();

    }
    private void ChangeValue()
    {
        lab.Text = "Changed";
    }

    private void requestStop()
    {
      _shouldStop = true;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:06:15.483

恐怕在线程上运行此代码对您没有帮助，因为考虑到页面生命周期，您无法确保线程在为时已晚之前完成。通常，最后一次更改控件值的机会是它的`PreRender`事件，但这取决于它是如何开发的。

但是，如果您需要并行处理，您仍然可以使用 a `Parallel.Foreach`，例如，在页面事件`PageLoad`中利用并行性而不是异步（`Parallel.Foreach`仅在所有线程完成时返回）。

# c - 声明结构变量时是否需要 struct 关键字？

> ID：11364653
> 
> 赞同：2
> 
> 时间：2012-07-06T14:56:48.463
> 
> 标签：c, structure, declaration

我从书中了解到，要声明一个结构变量，必须有一个前置`struct`关键字，但是如果`struct`在我的 Bloodshed\DevC++ 编译器变量中没有前面的关键字，则可以声明没有任何错误，如下所示，

```
struct stype
{
       int ival;
       float fval;
       double dval;
}; 
```

主要是，

```
stype s;
s.ival=10;s.dval=23.23;s.fval=233.23;
printf("%d %f %lf\n",s.ival,s.fval,s.dval); 
```

这可以正确打印应该打印的内容。在变量声明中使用这个关键字后面是否有任何修改`struct`？为什么这段代码有效？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T14:58:26.483

在 C 中它是强制性的（或者您可以使用 typedef）。在 C++ 中不是。

# html - 两列不适合带有垂直滚动条的容器

> ID：11364656
> 
> 赞同：-1
> 
> 时间：2012-07-06T14:56:55.300
> 
> 标签：html, css, two-column-layout

我有一个两列布局，它在调整以摆脱身体上的双滚动条时停止工作。现在我在包装上有一个滚动条，这是我想要的，但内容不知何故与滚动条的宽度重叠。

```
html, body {
  margin:0;
  padding:0;
  font: 12px Geneva, Verdana, sans-serif;
  color: #1e1f21;
  vertical-align: top;
  height: 100%
}

body {
  background: #fff url(../esimages/cubes.png) no-repeat left bottom fixed;
}

#wrap {
  background: #f5f5f5;
  margin: 0 auto;
  width: 960px;
  height: 100%;
}

#logo {
  height: 75px;
  width: 100%;
  background: #1e1f21;
  padding: 10px 0px 5px 0px;
}

#header {
  height: 30px;
  width: 100%;
  background: #1e1f21;
  margin:0px;
  padding: 0px;
}

#container {
  overflow: hidden;
  height: auto;
  background: #f5f5f5;
  width: 100%;
  margin: 0px;
  padding: 0px;
  text-align: left;
}

#content1 {
  min-height: 100%;
  background: #f5f5f5;
  padding: 20px 20px 20px 40px;
  margin: 0
}

#content2 {
  float: right;
  width: 290px;
  min-height: 100%;
  background: #f5f5f5;
  padding: 20px 0px 20px 10px;
  margin: 0
}

#footer {
  clear: both;
  padding: 10px;
  background: #1e1f21;
  text-align: center;
  line-height: 200%;
  font-size: 10px;
} 
```

两个内容框不能按应有的方式并排放入容器中。我已经尝试为 content1 使用不同的缩小固定宽度，但它根本没有区别，并且列宽无论如何都保持不变。我把头发扯掉了，因为这不合逻辑！

```
<body>
  <div id="wrap">
    <div id="logo"></div>
    <div id="header"></div>
    <div id="container">
      <div id="content2">
        <div class="box0">
          <ul>
            <li></li>
          </ul>
        </div>
      </div>
      <div id="content1">
        <p></p>
      </div>
    </div> 

<div id="footer" align="center"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T16:59:08.843

你需要放一个宽度和`float: left`。`content1`还要记住，总宽度 + 填充不能超过容器的宽度。

此外，你在`margin: 0`for之后缺少一个分号`content1`

# android - 通过 tcp ip 在按钮内发送文本

> ID：11364658
> 
> 赞同：-1
> 
> 时间：2012-07-06T14:57:04.127
> 
> 标签：android, eclipse, button, text, tcp

我想向服务器发送一些文本。我想要的是按钮内的文本。我的意思是按钮包含要发送到服务器的文本

**这是我的活动.java**

```
textout = (TextView)findViewById(R.id.textout);
    Button buttonOK = (Button)findViewById(R.id.button1);
    Button buttonYES = (Button)findViewById(R.id.button2);

    buttonOK.setOnClickListener(buttonSendOnClickListener);
}
    Button.OnClickListener buttonSendOnClickListener = new Button.OnClickListener(){
        @SuppressWarnings("null")
        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            Socket socket = null;
            DataOutputStream dataOutputStream = null;
            DataInputStream dataInputStream = null;

            OutputStream out = null;
            try {
                socket = new Socket("192.168.43.15", 8888);
                dataOutputStream = new DataOutputStream(socket.getOutputStream());
                dataInputStream = new DataInputStream(socket.getInputStream());
                OutputStream out1 = socket.getOutputStream();      

                TextView textout = null;
                textout.setText(dataInputStream.readUTF());             
                textout.setText("OKAY"); 
```

和

**这是我的 server.java**

```
public static void main(String[] args){
  ServerSocket serverSocket = null;
  Socket socket = null;
  DataInputStream dataInputStream = null;
  DataOutputStream dataOutputStream = null;
 try {
   serverSocket = new ServerSocket(8888);
   System.out.println("Listening :8888");
  } catch (IOException e) {
   // TODO Auto-generated catch block
   e.printStackTrace();
  }

  while(true){
   try {
    socket = serverSocket.accept();
    dataInputStream = new DataInputStream(socket.getInputStream());
    dataOutputStream = new DataOutputStream(socket.getOutputStream());
    System.out.println("ip: " + socket.getInetAddress());
    System.out.println("message: " + dataInputStream.readUTF());
    dataOutputStream.writeUTF("Hello!"); 
```

现在，当我单击“确定”按钮时出现问题，文本不会显示在我的服务器中。但是客户端和服务器之间的连接已经建立。突然我的应用程序强制关闭。

这是logcat显示

```
07-06 22:06:54.880: I/dalvikvm(590): threadid=3: reacting to signal 3
07-06 22:06:54.936: I/dalvikvm(590): Wrote stack traces to '/data/anr/traces.txt' 
```

这是我的服务器节目

```
java.io.EOFException
at java.io.DataInputStream.readUnsignedShort(Unknown Source)
at java.io.DataInputStream.readUTF(Unknown Source)
at java.io.DataInputStream.readUTF(Unknown Source)
at MyServer.main(MyServer.java:31) 
```

我应该怎么做才能使文本显示在我的服务器中。请帮我。多谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:59:51.827

你永远不会真正发送文本。我 `doas.write(text.getBytes())`先试试...

# c# - 允许实体在更新视图中存在两次

> ID：11364661
> 
> 赞同：0
> 
> 时间：2012-07-06T14:57:18.807
> 
> 标签：c#, asp.net-mvc-3, razor, entity

编辑模型时，下拉列表中存在实体“ProgramType”。如果用户在现有集合中没有看到他们需要的内容，他们需要能够在同一编辑屏幕上向该集合添加新条目。

从本质上讲，我似乎需要同一个实体在同一个编辑视图中存在两次。如果为下拉菜单选择了特定值，则文本字段会执行 jQuery“显示”以允许他们添加新数据。

```
 <div class="editor-label">
            @Html.LabelFor(model => model.ProgramTypeId, "Program Type")
        </div>
        <div class="editor-field">
            @Html.DropDownList("ProgramTypeId", "- Select a Program Type - ")
            @Html.ValidationMessageFor(model => model.ProgramTypeId)
        </div>

//this div is hidden via jQuery unless needed

        <div class="editor-label hiddenDiv">
            @Html.Label("New Program Type Title:")
        </div>
        <div class="editor-field hiddenDiv">
            @Html.EditorFor(model => model.ProgramType.ProgramType)
            @Html.ValidationMessageFor(model => model.ProgramType.ProgramType)
        </div>
//
        <div class="editor-label">
            @Html.LabelFor(model => model.ProgramYear)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.ProgramYear)
            @Html.ValidationMessageFor(model => model.ProgramYear)
        </div> 
```

实现这一目标的最佳方法是什么？我真的很想只使用表单集合，但这似乎是“糟糕的做法”。

```
public class SurveyProgramModel
    {

        [Key]
        public int ProgramId { get; set; }

        [DisplayName("Year")]
        public int ProgramYear { get; set; }

        [DisplayName("Status")]
        public int ProgramStatusId { get; set; }

        [DisplayName("Program Title")]
        public string ProgramTitle { get; set; }

        public int ProgramTypeId { get; set; }

        [DisplayName("Program Type")]
        public virtual SurveyProgramTypeModel ProgramType { get; set; }

        [DisplayName("Status")]
        public virtual ProgramStatusModel ProgramStatusModel { get; set; }

        public virtual ICollection<SurveyResponseModel> SurveyResponseModels { get; set; }

    }

public class SurveyProgramTypeModel
    {

        [Key]
        public int ProgramTypeId { get; set; }

        [DisplayName("Program Type")]
        public string ProgramType { get; set; }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:51:51.470

一种方法是修改您的视图模型以包含例如

```
public IEnumerable<SelectListItem> ProgramTypes { get; set; }
public int SelectedProgramType { get; set; }
public string NewProgramType { get; set; } 
```

在您的控制器操作中，使用持久层中的可能值列表填充 ProgramTypes，以及“添加新...”的额外值。

在您看来，您可以将下拉列表呈现为

```
@Html.DropDownListFor(m => m.SelectedProgramType, Model.ProgramTypes) 
```

然后添加一些 jQuery 来显示和隐藏`<div>`基于所选值的 a。在这个`<div>`添加里面

```
@Html.EditorFor(m => m.NewProgramType) 
```

并在您的`[HttpPost]`操作方法中添加逻辑以确定它们是否正在添加新值，然后将新值保存到您的持久层。

# node.js - 使用 Flatiron 的节点 REST API？

> ID：11364678
> 
> 赞同：1
> 
> 时间：2012-07-06T14:58:13.660
> 
> 标签：node.js, flatiron.js

faltiron 的[restful](https://github.com/flatiron/restful)和[node-restify](https://github.com/mcavage/node-restify/)有区别吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T16:31:31.277

restful 获取使用 resourceful 创建的[资源](https://github.com/flatiron/resourceful)并自动为它们生成 RESTful 路由（类似于 Rails 的方式）。

node-restify 是一个用于生成您自己的 RESTful API 的库；它不会为您自动生成路线。

# typo3 - 在 TYPO3 的页面之间移动新闻

> ID：11364682
> 
> 赞同：0
> 
> 时间：2012-07-06T14:58:24.497
> 
> 标签：typo3, tt-news

在 TYPO3 版本 4.7.2 中，我尝试更改分配特定新闻的页面，但没有成功。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T16:59:56.770

使用`List`模块打开您拥有新闻记录的页面，并确保`Extended view`选中底部的复选框。

之后，您会为每个条目找到一个剪刀图标，单击它，然后选择目标页面/文件夹并找到`Paste`图标（带有绿色向下箭头的白色页面）

如果您需要复制/移动更多记录，还请检查`Show clipboard`- 并选择剪贴板 #1 - #3

# wcf - 带有单例 COBOL VM 的 WCF Web 服务

> ID：11364696
> 
> 赞同：0
> 
> 时间：2012-07-06T14:59:00.053
> 
> 标签：wcf, service, concurrency, virtual-machine

我有一个 WCF Web 服务，它在 web.config 中没有并发配置，所以我相信它作为 persession 默认运行。在服务中，它使用 COBOL 虚拟机来执行从 COBOL Vision 文件中提取数据的代码。根据 COBOL VM 的开发人员，它是一个单例。

当不止一个人同时访问该服务时，我会定期遇到 Web 服务崩溃。我相信正在发生的事情是，当一个进程正在执行时，另一个单独的进程大约同时出现。第一个过程结束并通过正常的关闭程序关闭虚拟机。第二个进程仍在执行并尝试读取/写入数据，但 VM 已关闭并崩溃。在 Web 服务的构造函数中，创建了一个 VM 的实例，当一系列方法完成后，该服务被清理并关闭了 VM。

我一直在阅读 WCF Web 服务中的单例并发，并认为我可能需要改用这个。通过这种方式，我可以打开 COBOL VM 并使其永远保持活动状态，并消除我在方法中关闭 VM 的代码。我需要在请求之间共享的唯一数据是 COBOL VM 的状态。

我正在考虑的替代方法是创建一个服务器进程来管理打开 VM 并使其保持活动状态，并允许 Web 服务通过该进程发出读/写请求。

这听起来像正确的道路吗？我基本上是在寻找一种方法来让虚拟机在 WCF Web 服务情况下保持活力，并继续针对它执行代码。COBOL VM 系统向我发回关于读/写的锁定信息，我可以使用这些信息来处理重试或等待。

谢谢，马丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T12:22:15.617

Web 服务现在标记为：

```
[ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Single)] 
```

据我了解，这一次只允许一个线程通过 Web 服务运行。其他请求排队，直到第一个完成。这是一个适用于我的情况的快速修复，因为我的 Web 服务不需要高并发性。一次进来的请求永远不会超过几个。

# ios - iOS 用户启动指南

> ID：11364709
> 
> 赞同：0
> 
> 时间：2012-07-06T14:59:41.920
> 
> 标签：ios, user-interface, user-interaction

我想知道是否有一种方法可以让用户对应用程序进行一次小型导览，其中的小弹出窗口正好位于 UI 元素上方，指示它将做什么，而不是使用 iOS 拥有的标准弹出窗口。如果一个图标用于发布状态，则其顶部应该有一个小弹出窗口，告诉我们它用于发布状态，并且可以在游戏中关闭一个标准，以将玩家介绍给他们的 UI。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:12:22.540

GitHub 上有一个开源库，您可能会感兴趣：

[https://github.com/chrismiles/CMPopTipView](https://github.com/chrismiles/CMPopTipView)

编辑：这是另一个： [https ://github.com/Inferis/ViewDeck/](https://github.com/Inferis/ViewDeck/)

# java - JAVA将一个数组拆分为3个数组

> ID：11364710
> 
> 赞同：-1
> 
> 时间：2012-07-06T14:59:44.840
> 
> 标签：java, arrays

我一直在尝试将一个数组拆分为三个不同的数组。

```
 Player[] arr = Bukkit.getOnlinePlayers();

        int arrl1 = (int) Math.floor(arr.length /3);
        int arrl3 = (int) Math.ceil(arr.length /3);
        int arrl2 = arr.length - (arrl3);

        Player[] arr1 = Arrays.copyOfRange(arr, 0, arrl1);
        Player[] arr2 = Arrays.copyOfRange(arr, arrl1, arrl2);
        Player[] arr3 = Arrays.copyOfRange(arr, arrl2, arrl3);

        int players = arrl1;
        Player[] Array = arr1; 
```

我不知道发生了什么，我不断收到与一个数组（arr1，arr2，arr3）相关的各种错误，但没有收到播放器数组（arr）的正确部分。

假设我有 5 名球员在阵列中，我想把前 2 名球员放在第一个阵列中，把最后 2 个球员放在中间，然后把重命名的第三个放在中间。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:06:58.650

您的最后一个数组副本是问题所在 - 如果您检查错误消息，您将了解原因。你可能的意思是：

```
Player[] arr3 = Arrays.copyOfRange(arr, arrl2, arr.length); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:04:35.087

尝试将三个数组中每个数组的长度值打印到控制台。您可能有重叠和/或缺少一两个元素。打印出这些子数组的长度，看看你的错误在哪里！

# android - overridePendingTransition 不起作用

> ID：11364714
> 
> 赞同：5
> 
> 时间：2012-07-06T14:59:52.293
> 
> 标签：android, animation, transition

已经发现已经有人问了同样的问题，但解决方案对我不起作用。

我看没有动画。

这样称呼它：

```
Intent intent = new Intent(this, MyActivity.class);
startActivity(intent);
overridePendingTransition(R.anim.fadein, R.anim.fadeout); 
```

fadein.xml 和 fadeout.xml 在 anim 文件夹中：

淡入淡出.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android" >

    <alpha
        android:duration="1000"
        android:fromAlpha="0.0"
        android:interpolator="@android:anim/accelerate_interpolator"
        android:toAlpha="1.0" />
</set> 
```

淡出.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android">

  <alpha
      android:duration="1000"
      android:fromAlpha="1.0"
      android:interpolator="@android:anim/accelerate_interpolator"
      android:toAlpha="0.0" />

</set> 
```

使用分钟。API 7：

显现：

```
<uses-sdk android:minSdkVersion="7"/> 
```

API 7 也在我的 project.properties 文件中：

```
target=android-7 
```

我究竟做错了什么？

PD 使用插值器删除行不会改变任何内容。

已经看过/尝试过：

[overridePendingTransition 不起作用](https://stackoverflow.com/questions/11364714/overridependingtransition-doesnt-work)

[使用 FLAG_ACTIVITY_REORDER_TO_FRONT 时 overridePendingTransition 不起作用](https://stackoverflow.com/questions/4633543/overridependingtransition-does-not-work-when-flag-activity-reorder-to-front-is-u)

[在 Android 中从以前的 Activity 淡入 Activity](https://stackoverflow.com/questions/9150054/fade-in-activity-from-previous-activity-in-android)

[在 Android 中从以前的 Activity 淡入 Activity](https://stackoverflow.com/questions/9150054/fade-in-activity-from-previous-activity-in-android)

[Android 中的活动转换](https://stackoverflow.com/questions/3389501/activity-transition-in-android)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-09T09:04:42.257

问题是该设备，至少在三星 Galaxy 的情况下，必须启用动画才能使其工作。这可以在设置菜单中完成。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-03-13T17:51:26.523

您需要确保您没有在设备中使用**Settings > Developer Options**将其关闭：

![在此处输入图像描述](../Images/840c82def750d7c3fc03b19c40026ede.png)

你应该打开**过渡动画比例**。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-02T07:30:16.393

正如您在某些三星设备（可能是其他设备）中所说的那样，设置->显示->动画中的“所有动画”选项被选中，而不是默认的“某些动画”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-26T21:23:11.053

您可能会遇到的问题，因为动画不起作用，这是因为您当前的活动与您打算进行的下一个活动不同。相反，为了制作动画，他会破坏当前的活动，因此动画不会显示，请确保您的两个活动的方向相同。

# algorithm - 布尔可满足性 - 算法

> ID：11364716
> 
> 赞同：6
> 
> 时间：2012-07-06T14:59:53.970
> 
> 标签：algorithm, satisfiability

我有一个布尔公式：**(x_{1} or x_{2}) and (x_{3} or x_{4}) and ..... and (x_{2r-1} or x_{2r})** ,其中**x_{i}**属于集合：**{p_{1}, p_{2}, ... p_{99} , ~p_{1}, ~p_{2}, ... ~p_{99} }**我必须确定给定公式的某些**x_{i}值是否为真。**

我知道它通常在计算上很困难。但是有什么非常快速的方法可以解决这个特殊问题吗？到目前为止，我已经尝试过回溯——即在递归中，我为每个可能的变量替换了每个可能的值（0 或 1，所以不是很多），并且每个尚未获得值的变量都是微不足道的。在深入递归之前，我会检查公式（即使不是每个变量都有值），如果它是假的，我不会更深入。但它太慢了。有任何想法吗？我将非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T15:03:16.763

如果每个 OR 子句只有两个变量，那么您就有[2-SAT](http://en.wikipedia.org/wiki/2-satisfiability)，它具有线性时间解决方案。

# c# - C# 和 WCF 参考问题

> ID：11364718
> 
> 赞同：0
> 
> 时间：2012-07-06T14:59:56.180
> 
> 标签：c#, wcf

搞混了，我敢肯定这是一个愚蠢的。解决方案：

项目 1.**公司。** Linea.cs：只是具有不同构造函数的**Linea**类，现在就是这样。

项目 2\. **Bandeja。** Class.cs：在这里，我编写了使用**Linea**时需要的所有方法。（getLinea() 是我将在下面的示例中向您展示的那个）

项目 3\. **WCFWebService。** 调用 C# 方法的 WCF 服务。

参考。

从班德哈到康帕尼亚。

从 WCFWebService 到 Compania。

从 WCFWebService 到 Bandeja。

我在构建时遇到的唯一一个错误来自服务。

**服务等级**

```
namespace WCFWebService
{
    [DataContract]
    public class WSBandeja : IWSBandeja
    {
        public Compania.Linea getLinea()
        {
            Compania.Linea linea = new Compania.Linea();
            return linea.

        }

    }
} 
```

当我输入 return.linea。我在 Project Bandeja 的 class.cs 中找不到方法 getLinea()，只有参数。

任何建议都是最受欢迎的，因为我是 C# 和 WebServices 的新手。谢谢。

**编辑。公司项目 - Linea.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Compania
{
    public class Linea
    {
        public string ani { get; set; }
        public int teleprom { get; set; }
        public string actividad { get; set; }
        public DateTime fechaIngreso { get; set; }
        public string reclamo { get; set; }
        public string producto { get; set; }
        public string observacion { get; set; }
        public int tipoActividad { get; set; }
        public string tipoAveria { get; set; }
        public int reiteros { get; set; }
        public int call { get; set; }
        public bool trabajado { get; set; }
    }
} 
```

**Bandeja 项目 - Class.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data.SqlClient;
using System.Configuration;
using System.Data;
using System.Web;

namespace Bandeja
{
    public class Bandeja
    {
        public static string getNewConnection()
        {
            return ConfigurationManager.ConnectionStrings["BO"].ConnectionString;
        }

        public Compania.Linea getLinea()
        {
            var cLinea = new Compania.Linea();
            string connectionString = getNewConnection();
            SqlConnection conn = new SqlConnection(connectionString);
            using(conn)
            { 
                string variable = "GESTIONAR MANUALMENTE";
                var command = new SqlCommand("Bandeja_test");
                command.Connection = conn; 
                command.CommandType = CommandType.StoredProcedure;
                command.Parameters.Add(new SqlParameter("@linea", variable));
                conn.Open();
                SqlDataReader newReader = command.ExecuteReader();

                while (newReader.Read())
                {
                    cLinea = new Compania.Linea();
                    cLinea.ani = newReader["Línea"].ToString();
                    cLinea.fechaIngreso = Convert.ToDateTime(newReader["Fecha Ingreso"]);
                    cLinea.producto = newReader["Producto"].ToString();
                    cLinea.observacion = newReader["Observación"].ToString();
                }
            }

            return cLinea;
        }

    }

} 
```

**Web 服务接口。**

```
namespace WCFWebService
{
    [ServiceContract]
    public interface IWSBandeja
    {
        [OperationContract]
        Compania.Linea getLinea();

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T16:03:06.580

看起来您正在实例化错误的类。尝试这个。

```
[DataContract]
    public class WSBandeja : IWSBandeja
    {
        public Compania.Linea getLinea()
        {
            Bandeja.Bandeja bandeja = new Bandeja.Bandeja();
            return bandeja.getLinea();
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:55:34.123

尝试

```
[ServiceContract]
    public class WSBandeja : IWSBandeja
    {
        [OperationContract]
        public Compania.Linea getLinea()
        {
            Compania.Linea linea = new Compania.Linea();
            return linea.
        }
    } 
```

然后为复杂类型定义一个 [DataContract]

```
namespace Compania
{
[DataContract]
public class Linea
{

    [DataMember]
    //whatever properties you have
} 
```

有关DataContracts 和复杂类型的更多信息，请参阅[此页面](http://msdn.microsoft.com/en-us/library/ms733127.aspx)

# c# - 递归树创建

> ID：11364719
> 
> 赞同：5
> 
> 时间：2012-07-06T15:00:03.437
> 
> 标签：c#, recursion

我`Node`在 C# 中有一个具有以下属性的类：

```
public class Node
{
   public int Id {get;set;}
   public int? ParentId {get;set;}
   public string Label {get;set;}
} 
```

我有一个`TreeView`控件，它提供以下方法来创建新节点：

```
MyTreeView.CreateNode(key, label);
parent.Nodes.CreateNode(key, label); 
```

如果我想添加一个新的子节点，我需要使用第二种方法，否则使用第一种。两者都返回一个类型的对象`TreeNode`。

考虑到根节点有，你将如何在 C# 中创建一个递归函数来填充树视图`ParentId = null`？

这是我到目前为止所做的：

```
// create a list of root nodes
var roots = myList.Where(x => x.ParentId == null);
// send the roots to a recursive func
foreach(var root in roots)
{
   AddNode(null,root,myList);
} 
```

这是我的递归函数：

```
private void AddNode(Node parent, Node current, IList<Node> items)
{
   TreeNode treenode = null;
   if(parent == null)
   {
      treenode = mytree.CreateNode(current.Id.ToString(), current.Label);
   }else{
      var parentnode = mytree.GetNode(parent.Id.ToString());
      treenode = parentnode.Nodes.CreateNode(current.Id.ToString(), current.Label);
   }
   // call the recursion for the children
   var children = items.Where(x => x.ParentId == current.Id);
   foreach(var child in children)
   {
      AddNode(current, child, items);
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:14:28.620

如果您的树视图控件派生自 System.Windows.Forms.TreeView 您可以替换

```
MyTreeView.CreateNode(key, label);
parent.Nodes.CreateNode(key, label); 
```

和

```
MyTreeView.Nodes.Add(key, label);
parent.Nodes.Add(key, label); 
```

所以调用总是转到 TreeNodeCollection 类型的节点集合。现在，您可以使用 Nodes 集合作为参数，而不是您的 Node 对象。

```
var roots = myList.Where(x => x.ParentId == null);
foreach (var root in roots)
{
    AddNode(mytree.Nodes, root, myList);
}

private void AddNode(TreeNodeCollection nodes, Node current, IList<Node> items)
{
    TreeNode treenode = nodes.Add(current.Id.ToString(), current.Label);

    var children = items.Where(x => x.ParentId == current.Id);
    foreach (var child in children)
    {
        AddNode(treenode.Nodes, child, items);
    }
} 
```

这有两个好处：

1.  您不需要每次都查找父级。
2.  您只有一个电话 (TreeNodeCollection.Add)。

但是，如果您无法在每个根的 AddNode 调用中访问 TreeView.Nodes 集合，则必须在 AddNode 方法的顶部检查该集合。

```
var roots = myList.Where(x => x.ParentId == null);
foreach (var root in roots)
{
    AddNode(null, root, myList);
}

private void AddNode(TreeNodeCollection nodes, Node current, IList<Node> items)
{
    if (nodes == null)
    {
        nodes = myTree.Nodes;
    }

    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T12:29:34.130

试试这个代码：

```
var lookup = myList.ToLookup(n => n.ParentId.ToString());

Action<IEnumerable<TreeNode>> addChildren = null;
addChildren = tns =>
{
    var query =
        from tn in tns
        from cn in lookup[tn.Name]
        select tn.Nodes.CreateNode(cn.Id.ToString(), cn.Label);
    var nodes = query.ToArray();
    if (nodes.Length > 0)
    {
        addChildren(nodes);
    }
};

addChildren(
    lookup[null]
        .Select(n =>
            MyTreeView.CreateNode(n.Id.ToString(), n.Label))); 
```

我无法完全测试它，因此您可能需要更改一些代码才能使其正常工作，但它应该相当接近。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-23T05:06:33.310

我可能会做这样的事情......

```
public class Node
{
    public int Id { get; set; }
    public int? ParentId { get; set; }
    public string Label { get; set; }

    public Node(int? parentId, int id, string label)
    {
        ParentId = parentId;
        Id = id;
        Label = label;
    }
}

public class TreeNode : List<TreeNode>
{
    public string Key { get; set; }
    public string Label { get; set; }

    public IEnumerable<TreeNode> Descendants
    {
        get
        {
            yield return this;

            foreach (var child in this)
            {
                foreach (var descendant in child.Descendants)
                {
                    yield return descendant;
                }

            }
        }
    }

    public TreeNode(string key, string label)
    {
        Key = key;
        Label = label;
    }

    public void CreateNode(int id, string label)
    {
        Add(new TreeNode(id.ToString(), label));
    }
}

public class Tree
{
    private TreeNode _root = new TreeNode(null, null);

    public Tree(IEnumerable<Node> nodes)
    {
        nodes.ToList().ForEach(node => CreateNode(node.ParentId, node.Id, node.Label));
    }

    public void CreateNode(int? parentId, int id, string label)
    {
        if (parentId == null)
        {
            _root.CreateNode(id, label);
        }
        else
        {
            _root.Descendants.First(x => x.Key == parentId.ToString()).CreateNode(id, label);
        }
    }

    public IEnumerable<TreeNode> Descendants => _root.Descendants;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-01-20T06:43:10.473

试试这个代码：

```
Node{
     Id, Label, List<Tree> Children
}

Tree GetTree(id){
     var node=new Node();

     node.Id=id;
     node.Children=new List<Node>();

     List<Node> children = db.Nodes.Where(x => x.ParentId==id);

     foreach(child in children){
           var childTree=GetTree(child.Id);
           node.Children.Add(childTree);
     }

     return node;
} 
```

# bash - 在没有输入的情况下运行 bash 脚本

> ID：11364722
> 
> 赞同：11
> 
> 时间：2012-07-06T15:00:31.210
> 
> 标签：bash, shell, unix

我编写了一个 bash 脚本，它安装了许多软件包，但是对于每个连续的软件包安装，我都会使用以下消息进行升级：

```
After this operation, 1,006 kB of additional disk space will be used.  
Do you want to continue [Y/n]? 
```

有没有办法将默认值设置为 Y，因此不需要用户输入？我的脚本预计将在夜间运行而无需任何干预

提前致谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-06T15:08:39.483

想到了两种方法。第一个（也是更好的选择）是使用包管理器中的选项。例如：

```
apt-get install -y [YOUR_PACKAGE] 
```

如果您使用`apt`（`apt-get install --help`在此处输入更多帮助）。

第二个更像是一个快速的'n-dirty ...在之后使用管道`yes`：

```
yes | apt-get install [YOUR_PACKAGE] 
```

这总是给我带来微笑：p

后一个选项也对所有其他问题回答“是”，这可能很方便（错误等）但可能有风险（这就是这些问题首先存在的原因！）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-06T15:01:49.143

我认为该消息看起来像您正在使用 apt-get。

在这种情况下，您可以使用标志`--assume-yes`或更短的: `-y`，它应该自动对该问题回答“是”而不提示用户

# antlr - antlr 有没有办法生成访问者代码（通用访问者）

> ID：11364723
> 
> 赞同：1
> 
> 时间：2012-07-06T15:00:32.427
> 
> 标签：antlr, antlr3

我们希望 CommonTree 有一个 visit(OurVisitor visitor) 方法，但 CommonTree 不是生成的类。

现在，我们有这个代码

```
 ANTLRStringStream stream = new ANTLRStringStream(sql);
    NoSqlLexer lexer = new NoSqlLexer(stream);
    CommonTokenStream tokenStream = new CommonTokenStream(lexer);
    NoSqlParser parser = new NoSqlParser(tokenStream);  
    CommonTree tree = (CommonTree) parser.statement().getTree(); 
```

我总是可以外部化遍历树，但在这种情况下调用 tree.visit(myVisitor) 并让它为树中的每个节点调用 OurVisitor.visitNode(Node node) 会很好。有没有办法做到这一点？

另外，我期待一棵树，如果我有 expr = exprType1 | exprtType2 | exprType3*，我会有一棵树

```
ExprType1 exp1 = expr.getExprType1();
ExprType2 exp2 = expr.getExprType2();
List<ExprType3> exp3List = expr.getExprType3() 
```

但 CommonTree 并非如此。有没有办法做到这一点？

谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T18:19:38.183

是的，您可以让 ANTLR 生成您自己的 AST 类（必须扩展 ANTLR 的`Tree`类！），您可以在其中添加自定义方法。

请参阅[此](https://theantlrguy.atlassian.net/wiki/display/ANTLR3/Tree+construction)ANTLR Wiki 文章，尤其是段落[Using custom AST node types](https://theantlrguy.atlassian.net/wiki/display/ANTLR3/Tree+construction#Treeconstruction-UsingcustomASTnodetypes)。

ANTLR 的下一个主要版本，[版本 4](http://www.antlr.org/)，将具有自动 AST 构造，使其易于遍历/迭代。

# html - 仅在 -webkit 中定义宽度并更改 -webkit-appearance

> ID：11364724
> 
> 赞同：1
> 
> 时间：2012-07-06T15:00:37.810
> 
> 标签：html, select, css

如何仅为 -webkit 设置宽度样式？无论我做什么，我所有的选择框都大约宽 16 像素。Border-box 的效果为零，这真的很烦人。我什至尝试编造供应商前缀，希望违背常识，它会像-webkit-width 一样工作。当然，结果并不好。

另外，如何仅使用 -webkit-appearance: none 获得箭头？不得不与圆角作斗争非常烦人，并且默认情况下 webkit 会为您提供额外的样式。是唯一理智的浏览器FF吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:07:00.753

因此，对于宽度，我只是在输入此内容后立即想到了解决方案。

```
@media only screen and (-webkit-min-device-pixel-ratio:0) { 
    select { width: 25%; }
} 
```

这仅针对 -webkit 浏览器，我应该已经知道了。

那么对于箭...

# r - 一个图表上的多条线：在每条线的末尾添加一个文本首字母缩写词（“图例”）（ggplot2）

> ID：11364729
> 
> 赞同：2
> 
> 时间：2012-07-06T15:01:00.023
> 
> 标签：r, graph, ggplot2

我生成了以下图表：

[http://i47.tinypic.com/s3dd0m.png](http://i47.tinypic.com/s3dd0m.png)

我有相当多的长数据（可以在这里下载：[http](http://www.sendspace.com/file/lfd31r) ://www.sendspace.com/file/lfd31r ），数据如下：

```
head(data)
  -10:130  variable        value

1     -10 Utilities  0.001680609
2      -9 Utilities  0.004652453
3      -8 Utilities -0.002441692
4      -7 Utilities -0.018639594
5      -6 Utilities -0.007587632
6      -5 Utilities  0.004526066 
```

我用来生成此图形的代码：

```
ggplot(data=data,
       aes(x=-10:130, y=value, colour=variable)) +
    geom_line() 
```

我想要看起来像下图的东西：

[i46.tinypic.com/2cmvfrq.png](http://i46.tinypic.com/2cmvfrq.png)

图例消失了，但类别的首字母缩略词显示在每行的末尾，颜色与行本身相同。这将是必要的，因为有太多的线条和颜色让读者无法理解是什么。一旦你们的天才帮助我弄清楚如何解决这个问题，我将制作一个 4 面板图（使用 facet_grid），每个面板有 10 行。

谢谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T16:26:22.193

要删除图例，您可以使用

```
+ opts(legend.position = 'none') 
```

要将文本添加到绘图中，您可以使用

```
+ annotate("text",x=XPOSITION,y=YPOSITION,label="TEXTFORPLOT",size=3.5) 
```

快速解决您的问题的肮脏尝试

```
library(ggplot2)
## Read in the data from your link. You will have to change this.
dat <- read.csv("~/Downloads/demo.csv")
head(dat)
## Get the y values - turns out they are all 130
label_summary <- aggregate(dat[,2], list(dat$variable), max)
## A quick method to reduce the names, by grabbing the first 3 characters
label_names <- substr(label_summary[,1],1,3)
## get the x values of each variable
label_x <- label_summary[,2]
# A method to get the last y value of each variable
label_y <- sapply(1:length(label_x), function(i) dat[with(dat, dat[, 2]==label_x[i]&dat[, 3]==label_summary[i,1]),"value"])
# Make the plot without legend and text
p <- ggplot(data=dat,aes(x=-10:130, y=value, colour=variable)) + geom_line() + opts(legend.position = 'none')
p 
# Use an sapply function to add the labels one by one to the. This is needed because the label option within the annotate function only allow one label.
p + sapply(1:length(label_x), function(i) annotate("text",x=label_x[i]+10,y=label_y[i],label=label_names[i],size=3.5)) 
```

# mfc - MFC MDI - “遇到不正确的论点”

> ID：11364735
> 
> 赞同：1
> 
> 时间：2012-07-06T15:01:29.897
> 
> 标签：mfc, mdi

我已将 VLC 播放器嵌入到 MFC MDI 应用程序中。每当我关闭包含嵌入式 VLC 播放器的子框架时，都会弹出一个带有以下消息的消息框“遇到不正确的参数”。如果我在弹出此消息框后关闭应用程序。它没有关闭。该应用程序进入后台，然后我必须转到任务管理器并终止该应用程序。这仅在发布版本中发生。我在调试版本中从未遇到过这个错误。请让我知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-09-03T20:04:21.517

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T06:50:06.440

对不起，我解决了这个问题。我在我的应用程序中围绕 libmysql 编写了包装类。问题是由于我的包装类中发生了一些内存泄漏。

# html - 无法在我的 HTML/CSS 中找到令人讨厌的内容空白的原因？

> ID：11364737
> 
> 赞同：1
> 
> 时间：2012-07-06T15:01:44.063
> 
> 标签：html, css, layout

我对 CSS / HTML 很陌生，找不到[这个](http://i.imgur.com/wYWh9.jpg "这")小虫子的原因。我希望它消失，以便横幅和导航栏相互接触。任何帮助是极大的赞赏！！

这是该网站的代码。我取出了一些不相关的代码。

```
 <!DOCTYPE html>
<html>

<!-- *****CSS CODE START*****-->
<style type="text/css">

#container
{
    margin: 0 auto;
    width: 900px;
    background: #fff;

}

#header
{
    margin-top: 0px;
}

#header h1 { margin: 0; }

#navigation
{
    float: left;
    width: 900px;
    background: #333;
}

#navigation ul
{
    margin: 0;
    padding: 0;
}

#navigation ul li
{
    list-style-type: none;
    display: inline;
}

#navigation li a
{
    display: block;
    float: left;
    padding: 5px 10px;
    color: #fff;
    text-decoration: none;
    border-right: 1px solid #fff;
}

#navigation li a:hover { background: #383; }

#content-container
{
    float: left;
    width: 900px;
    background: #fff url(/wp-content/uploads/layout-two-fixed-background.gif) repeat-y 100% 0;
}

#content
{
    clear: left;
    float: left;
    width: 619px;
    height: 720px;
    padding: 10px 0;
    margin: 0 0 0 0px;
    display: inline;
    overflow: auto;
}

#content h2 { margin: 0; color: #003D5D; padding:10px; }

#contentBody
{
    padding:10px;
    font-size:22px;
}

#aside
{
    float: right;
    width: 280px;
    padding: 20px 0;
    margin: 0 0px 0 0;
    display: inline;
    background: #cccccc;
    height: 700px;
    border-left: 1px solid #333 ;
}

#aside h3 { margin: 0 20px; color: #003D5D; font-family: Times New Roman; }

#asideText { margin: 0 20px; font-family: Times New Roman;}

#footer
{
    clear: both;
    background: #ccc;
    text-align: right;
    padding: 5px;
    height: 1%;
    border-top: 1px solid #333 ;
}

</style>
<!-- *****CSS CODE END***** -->

<!-- *****HTML CODE START***** -->
<body>

<div id="container">
    <div id="header">

            <img src = file:///Users/jduffy/Desktop/projectSite/banner1.jpg>
            </img>

    </div>
    <div id="navigation">
        <ul>
            <li><a href="file:///Users/jduffy/Desktop/projectSite/home">Home</a></li>
            <li><a href="file:///Users/jduffy/Desktop/projectSite/theProject">The Project</a></li>
            <li><a href="file:///Users/jduffy/Desktop/projectSite/Pictures">Pictures</a></li>
            <li><a href="file:///Users/jduffy/Desktop/projectSite/Contact">Contact us</a></li>
        </ul>
    </div>
    <div id="content-container">
        <div id="content">
            <h2>
                Page heading
            </h2>
            <div id="contentBody">
            <p>
                home pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome page                home pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome page
                home pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome pagehome page

            </p>
            <p>
                test2
            </p>
            <p>
                test3
            </p>
            </div>
        </div>
        <div id="aside">
            <div id="asideHeading">
                <h3>
                Aside Heading
                </h3>
            </div>
            <div id="asideText">
            <p>
            test5
            </p>
            </div>
        </div>
        <div id="footer">

            <text id="footerDate">0</text>

        </div>
    </div>
</div>
</body>
<!-- *****HTML CODE END***** -->

</html> 

<!-- *****JavaScript CODE START***** -->
<script type="text/javascript">

/*date*/
var today = new Date();
document.getElementById("footerDate").innerHTML = today;

</script>
<!-- *****JavaScript CODE END***** --> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:12:14.667

只需添加

```
#header img {
    float:left; 
} 
```

到你的 CSS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T15:19:50.380

`display: block`在您的标题 img 上使用。

更多信息：[HTML5 中的 canvas/video/audio 元素下方有 4px 的间隙](https://stackoverflow.com/questions/8600393/there-is-a-4px-gap-below-canvas-video-audio-elements-in-html5)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T15:21:13.453

ShogunArts.de 的回答——

```
#header img {
    float:left; 
} 
```

基本桥的答案 -

```
#header { margin-bottom: -5px; } 
```

Guillaume86 的回答——

```
#header img {
    display:block; 
} 
```

一切都很完美！多谢你们。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-06T15:14:32.843

这是无效的 HTML：

```
 <img src = file:///Users/jduffy/Desktop/projectSite/banner1.jpg>
            </img> 
```

应该：

```
<img src="file:///Users/jduffy/Desktop/projectSite/banner1.jpg"/> 
```

虽然根据标记的版本/类型可能不需要引号，**但图像标签始终是自闭合的**。

每当您遇到奇怪的布局错误时，请使用经过验证的 HTML 开始您的故障排除：

[http://validator.w3.org/](http://validator.w3.org/)

# python - 如何将 NumPy 数组转换为 MatPlotLib 颜色图？

> ID：11364745
> 
> 赞同：6
> 
> 时间：2012-07-06T15:02:12.667
> 
> 标签：python, matplotlib

我正在尝试创建 4 种不同颜色的颜色图。我有一个 NumPy 数组，该数组中有 4 个值：0、.25、.75 和 1。如何制作 MatPlotLib 图，例如，0 为绿色，0.25 为蓝色，0.75 为黄色，红色代表1？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-19T17:00:53.900

我建议使用此函数将 Nx3 numpy 数组转换为颜色图

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import colors

#-----------------------------------------
def array2cmap(X):
    N = X.shape[0]

    r = np.linspace(0., 1., N+1)
    r = np.sort(np.concatenate((r, r)))[1:-1]

    rd = np.concatenate([[X[i, 0], X[i, 0]] for i in xrange(N)])
    gr = np.concatenate([[X[i, 1], X[i, 1]] for i in xrange(N)])
    bl = np.concatenate([[X[i, 2], X[i, 2]] for i in xrange(N)])

    rd = tuple([(r[i], rd[i], rd[i]) for i in xrange(2 * N)])
    gr = tuple([(r[i], gr[i], gr[i]) for i in xrange(2 * N)])
    bl = tuple([(r[i], bl[i], bl[i]) for i in xrange(2 * N)])

    cdict = {'red': rd, 'green': gr, 'blue': bl}
    return colors.LinearSegmentedColormap('my_colormap', cdict, N)
#-----------------------------------------
if __name__ == "__main__":

    #define the colormar
    X = np.array([[0., 1., 0.],  #green
                  [0., 0., 1.],  #blue
                  [1., 1., 0.],  #yellow
                  [1., 0., 0.]]) #red
    mycmap = array2cmap(X)

    values = np.random.rand(10, 10)
    plt.gca().pcolormesh(values, cmap=mycmap)

    cb = plt.cm.ScalarMappable(norm=None, cmap=mycmap)
    cb.set_array(values)
    cb.set_clim((0., 1.))
    plt.gcf().colorbar(cb)
    plt.show() 
```

将产生： ![在此处输入图像描述](../Images/ded90443becb3410acda356b9b41aeeb.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-19T09:14:24.627

user2660966 的回答让我走上了正轨，但实际上你可以让事情变得简单得多。这就是我最终的结果：

```
import numpy as np
from matplotlib import colors

def array2cmpa(X):
    # Assuming array is Nx3, where x3 gives RGB values
    # Append 1's for the alpha channel, to make X Nx4
    X = np.c_[X,ones(len(X))]

    return colors.LinearSegmentedColormap.from_list('my_colormap', X) 
```

如果您尝试构建非连续颜色图，行为可能会有点奇怪，但大多数地图都是连续的，所以这对我来说从来都不是问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T15:07:52.533

尝试`ListedColormap`使用`BoundaryNorm`. 有关示例，请参见[http://matplotlib.sourceforge.net/examples/api/colorbar_only.html 。](http://matplotlib.sourceforge.net/examples/api/colorbar_only.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T15:10:40.760

有几种不同的方法可以做到这一点。这是我过去使用过的一个：

```
 def color(value, data):
    c=colorsys.hsv_to_rgb(value / data.max() / (1.1), 1, 1)

    return c[::-1] 
```

如果您传递一个值数组，并且数据指向它，它应该根据与传递的数组的最大值相关的等级返回从蓝色到红色的颜色。

另请参阅此处的示例代码： [http ://www.scipy.org/Cookbook/Matplotlib/ColormapTransformations](http://www.scipy.org/Cookbook/Matplotlib/ColormapTransformations)

# asp.net-mvc - 无法让 Ajax 在 ASP.NET MVC Razor 中工作

> ID：11364746
> 
> 赞同：2
> 
> 时间：2012-07-06T15:02:15.827
> 
> 标签：asp.net-mvc, asp.net-ajax, asp.net-mvc-4

好的，所以我花了一整天的时间试图弄清楚这一点——但我做不到！这是我的问题。

我正在使用 ASP.NET MVC 4 和 Razor。我的目标是做一些 BASIC Ajax。我想要做的就是在我的页面上有一个 div，它通过 Ajax 链接更新 - 以证明 Ajax 正在工作。

我认为这个问题与我需要使 Ajax 工作的脚本文件有关。默认情况下，我什至没有脚本目录——所以我创建了一个，然后找到了 MicrosoftAjax.js、MicrosoftMvcAjax.js 和 jquery.unobtrusive-ajax.min.js——并在头部中添加了对 _Layout.cshtml 的引用

这是我所拥有的：

在我的 _Layout.cshtml 中，我脑子里有以下内容

```
<script type="text/javascript" src="../../Scripts/MicrosoftAjax.js"></script>
<script type="text/javascript" src="../../Scripts/MicrosoftMvcAjax.js"></script>
<script type="text/javascript" src="../../Scripts/MicrosoftMvcValidation.js"></script>
<script type="text/javascript" src="../../Scripts/jquery.unobtrusive-ajax.min.js">/script>` 
```

在我的 HomeController.cs 我有：

```
 [HttpGet]
    public string GetStatus()
    {
        return DateTime.Now.ToLongTimeString();
    } 
```

在我的 About.cshtml 文件中，我有以下内容：

```
 @Ajax.ActionLink("Ajax Test", "GetStatus", new AjaxOptions{UpdateTargetId="testtarget", HttpMethod = "Get"})`enter code here`
< div id="testtarget">Test Div</div> 
```

当我编译应用程序时，我可以看到“Ajax Test”链接和“Test Div”文本。

当我单击“Ajax 测试”时，我被重定向到 Home/GetStatus 并将当前时间打印到空白页上。

这显然不是我所期望的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-09T09:48:16.757

对于查看这篇文章以寻求答案的人，我还要补充一点：确保您已正确配置您的 web.config 以允许不显眼的库工作

```
<appSettings>
<add key="UnobtrusiveJavaScriptEnabled" value="true" />
</appSettings>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:23:36.743

嗯，我刚刚想通了-

在 MVC2 之后不再使用 MicrosoftAjax javascript 文件，而是只需将 jquery 和 jqueyr.unobtrusive-ajax.min 添加到您的头上，然后完全相同的代码就可以工作了 :)

# objective-c - iOS - 增加部分卷曲点击区域以关闭模式

> ID：11364754
> 
> 赞同：2
> 
> 时间：2012-07-06T15:02:43.683
> 
> 标签：objective-c, ios, partial-views, modalviewcontroller

有没有办法做到这一点？就像点击屏幕的任何部分都会消除部分模态卷曲。我想到了一个隐形按钮，但这仍然不能覆盖整个卷曲区域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T03:32:58.220

将手势识别器添加到您的主视图`viewDidLoad`

```
UITapGestureRecognizer *tapRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self
                                                                                action:@selector(getDismissed)];

UISwipeGestureRecognizer *swipeRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self 
                                                                                action:@selector(getDismissed)];
swipeRecognizer.direction = UISwipeGestureRecognizerDirectionDown;
tapRecognizer.numberOfTapsRequired = 1;
tapRecognizer.numberOfTouchesRequired = 1;
tapRecognizer.delegate = self;
[self.view addGestureRecognizer:tapRecognizer];
[self.view addGestureRecognizer:swipeRecognizer];

-(void)getDismissed
{
    // call dismissViewControllerAnimated:completion: by the presenting view controller
    // you can use delegation or direct call using presentingViewController property
} 
```

然后排除您不想触发解雇

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch
{
    // touching objects of type UIControl will not dismiss the view controller
    return ![touch.view isKindOfClass:[UIControl class]];
} 
```

# php - 没有这样的文件或目录 (opendir) PHP

> ID：11364755
> 
> 赞同：1
> 
> 时间：2012-07-06T15:02:45.867
> 
> 标签：php, opendir, readdir

我的`opendir`功能有问题。

```
if ($handle = opendir($dir)) {
    echo "Directory handle: $handle\n";
    echo "Entries:\n";

    while (false !== ($entry = readdir($handle))) {
        echo "$entry\n";
    }

    closedir($handle);
} 
```

我检查了我的文件夹是否存在并且确实存在。我将权限更改为**777**。可能是什么问题呢？

例如：`images/car/Volvo_S40_4dr_sedan/`

不工作。问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:15:35.903

看来您正在使用相对路径。如果是这样，请确保您正确构建了相对于脚本当前工作目录的路径。

要排除故障，请分配绝对路径`$dir`，例如。`$dir = "/var/www/myproject/images/car/Volvo_S40_4dr_sedan/"`. 如果它有效，那么问题的原因是相对路径的错误引用。

我建议您坚持使用绝对路径，除非您有充分的理由使用相对路径。

# php - PayPal Express Checkout 无法正常工作 CRE 已加载

> ID：11364756
> 
> 赞同：1
> 
> 时间：2012-07-06T15:02:49.493
> 
> 标签：php, mysql, oscommerce

CRE 加载 PCI B2B v6.4.1 它现在带有 Pay Pal Express Checkout 问题，当我使用这种付款方式时，它没有发送任何订单信息，当我完成交易时，它会将我重定向回没有记录订单和购物车的网站保持不变任何想法可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T17:44:51.217

您是否联系过 Loaded 支持？

我们正在跟踪同时启用贝宝和其他支付模块的问题。尝试仅启用贝宝，看看问题是否仍然存在。

补丁 6.5.1 也即将发布，以解决这个问题和其他问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T18:21:02.777

可能应该有一些标志/开关/设置来在生产模式下切换它。目前它可能处于某种测试模式。

# shell - 检查后台进程的返回状态

> ID：11364758
> 
> 赞同：0
> 
> 时间：2012-07-06T15:02:51.660
> 
> 标签：shell, background

我需要将几个文件复制到远程服务器。

```
for database in `mysql -Bse"show databases" | grep '^us' `
do

time scp $database.gz gs://tbl_name/ &

done 
```

我使用**&**在后台推送进程，以便脚本可以继续处理下一个文件。问题是由于网络问题，10 个文件中有 1 个无法传输。但我无法检查返回码，因此不知道哪些文件失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:23:35.097

您可以等待特定进程并从中获取状态：

```
cmd &
pid=$!
cmd2 &
pid2=$!
wait $pid || echo cmd failed >&2
wait $pid2 || echo cmd2 failed >&2 
```

# java - 如何编译支持旧版 Java 的 .java？

> ID：11364761
> 
> 赞同：41
> 
> 时间：2012-07-06T15:02:58.503
> 
> 标签：java, compilation, cross-platform

我想将我的 .java（几个）编译成一个`.jar`至少`Java 1.6`与更新版本、最好`Java 1.5`是更新版本的 Java 兼容的版本。（我有`Java 1.7.0_5`）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-06T15:11:22.893

是的，您可以在编译时设置编译器的版本。并将你的java代码编译成旧版本的java。

来自 Oracle 文章： [http ://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/javac.html](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/javac.html)

**交叉编译示例**

这里我们使用 javac 编译将在 1.4 VM 上运行的代码。

```
% javac -target 1.4 -bootclasspath jdk1.4.2/lib/classes.zip \
             -extdirs "" OldCode.java 
```

您可能还需要以下参数来设置表示代码的版本。

```
-source release 
```

- 指定接受的源代码版本。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-11-02T17:41:58.610

从 JDK 9 开始，javac 支持交叉编译的新选项

```
javac --release N ... 
```

这相当于

```
javac -source N -target N –bootclasspath rtN.jar 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-06T15:05:51.127

您可以使用`javac -target 1.5 <source files>`.

如果您使用构建系统、Eclipse 或其他一些 IDE 来构建 jar，请指定哪个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-21T18:04:03.940

您可以指定编译器的目标版本低于构建 java 版本（所有答案基本上都这么说），但您不应该：它非常混乱，因为它只有在您还为实际目标版本提供类库时才有效。如果你这样做，你最好只使用这个旧的 Java 版本来编译。更清洁，更少的设置。对于 Java 9，选项更好一些，但您仍然需要一个旧的 JDK 来存放 rt.jar。

您可以做的是在您的 ide 和开发周期中使用`-target`/`-bootclasspath`技巧来获得更快的编译器和更好的警告，但是 IT 和发布版本应该使用目标版本来完成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-06T15:06:36.500

您可以使用最新版本的 JDK 并将源级别设置为 1.5 - 只要您不使用 1.5 之后引入的类/方法，您应该可以使用 JVM 1.5 及更高版本的所有版本：

-源 1.5

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-26T08:21:26.930

以下命令将使用 java 版本 1.8 编译所有 java 类，因为默认情况下，您的代码由您拥有的最新版本编译。

```
javac -source 1.8 -target 1.8  *.java 
```

# java - 如何修改我的 eclipse.ini 设置来构建大型 java 项目？

> ID：11364764
> 
> 赞同：2
> 
> 时间：2012-07-06T15:03:11.950
> 
> 标签：java, eclipse, memory

我正在使用基于 Eclipse 的 IBM WebSphere Integration Developer (WID)。我们在其中构建了一个大型 Web 系统，所有项目都在流中。它很重。每次我尝试构建所有项目时 - 这需要很长时间，最终 Eclipse 会耗尽内存。

这些是我的设置：

```
-startup
plugins\org.eclipse.equinox.launcher_1.0.101.R34x_v20081125.jar
-install
D:\IBM\WID7
--launcher.library
plugins\org.eclipse.equinox.launcher.win32.win32.x86_1.0.101.R34x_v20080731
--launcher.XXMaxPermSize
256m
-vm
jdk\jre\bin\j9vm\jvm.dll
-vmargs
-Xquickstart
-Xms768m
-Xss4m
-Xmaxf0.1
-Xminf0.05
-Xmx1300m
-Xmnx64m
-Xgcpolicy:gencon
-Xscmx96m
-Xshareclasses:name=IBMSDP_%u
-XX:MaxPermSize=448M
-XX:+UseParallelGC
-XX:+AggressiveHeap
-Dorg.eclipse.jdt.core.javamodelcache.ratio=0.0625
-Dosgi.requiredJavaVersion=1.5
-Dosgi.bundlefile.limit=100 
```

我能做些什么来真正让 Eclipse 构建所有这些项目？它会进行垃圾收集，但最终即使使用 GC，它也会用完所有东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T16:56:58.440

假设 j9 JVM 像 Oracle JVM 一样工作，上面的设置将您的最大堆空间设置为 1300 MB。如果您的系统有足够的可用 RAM 来支持更大的堆，您可以尝试增加该数量。

要编辑的行是`-Xmx1300m`

还要考虑一件事：您确定您的内存错误是因为堆空间用完吗？请记住，该`-Xmx`设置仅影响堆空间，但 JVM 也会将内存用于其他目的。

# c# - 如何使用正则表达式在一串数字的末尾返回多个数字

> ID：11364772
> 
> 赞同：1
> 
> 时间：2012-07-06T15:03:51.327
> 
> 标签：c#, regex

我有一串长度可能不同的数字，我只想返回最后 4 位数字。我会使用积极的回顾吗？并使用**$**锚定到？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T15:06:02.530

使用这个正则表达式`\d{4}$`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:54:10.110

如果您的字符串可以是任意长度并且您想要匹配具有 0 到 3 个字符的情况，您应该使用：

```
\d?\d?\d?\d?$ 
```

或者，如果正则表达式引擎理解它：

```
\d{0-4}$ 
```

# c# - 发送对变量的引用而不是它的值

> ID：11364773
> 
> 赞同：3
> 
> 时间：2012-07-06T15:03:56.107
> 
> 标签：c#, variables, reference

我有一个执行很长任务的函数，我想偶尔通过状态更新来更新其他地方的变量。（如果有更好的方法可以做到这一点，那也很好）我正在编写一个库，并且可能会一次调用该代码多次，因此在存储该变量的同一个类中创建另一个变量不是一个选项。这是我的代码可能的样子：

```
public static bool Count(int Progress, int CountToWhat) {
    for (int i = 0; i < CountToWhat; i++) {
        Progress = CountToWhat / i; // This is how I'd like to update the value, but obviously this is wrong
        Console.WriteLine(i.ToString());
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T15:09:20.433

这不是向呼叫者提供更新的好方法。

最好在类库中定义一个或多个事件（如`OnError`、`OnProgress`等）。例如，`OnProgress`当您想通知某个操作的进度时，您可以提出：

```
for (int i = 0; i < CountToWhat; i++) {
  OnProgress(CountToWhat / i);
  Console.WriteLine(i.ToString());
} 
```

这是一种更好的方法，尤其是在从工作线程通知时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T15:07:25.457

将签名更改为：

```
public static bool Count(ref int Progress, int CountToWhat) 
```

当你调用它时，在你作为第一个参数传入的变量之前使用 ref 关键字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-06T15:06:52.527

您可以使用

```
int Progress = 0;
public static bool Count(ref int Progress, int CountToWhat)
{
  ....
} 
```

或者

```
int Progress; //without init
public static bool Count(out int Progress, int CountToWhat)
{
  ....
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-06T15:13:35.100

更好的方法可能是传递一个`Action<int>`委托来报告进度：

```
public static bool Count(int CountToWhat, Action<int> reportProgress) 
{
    for (int i = 0; i < CountToWhat; i++) 
    {
        var progress = CountToWhat / i; 
        reportProgress(progress);
        Console.WriteLine(i.ToString());
    }
} 
```

那么你会像这样使用它：

```
Count(100, p => currentProgress = p); 
```

您还可以使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)类来运行您的长时间运行的任务，并利用它的[ProgressChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.progresschanged.aspx)事件。

# .net - 解耦 WMI 提供程序 - 从 wmic 工作，但不是应用程序

> ID：11364775
> 
> 赞同：2
> 
> 时间：2012-07-06T15:03:58.437
> 
> 标签：.net, wmi

我在 .NET 4 中编写了一个解耦的 WMI 提供程序，它工作得很好。我最近向它添加了一个类，无论出于何种原因，它总是会在我的 .NET 应用程序查询它时引发 ManagementException 并带有“不支持”的模糊消息。但是我可以使用 wmic 很好地查询类。

该类遵循与提供程序中的其他类类似的模式，这些类在本地从应用程序查询时工作得很好。我无法解释为什么我可以从 wmic 而不是我的应用程序中查询它。请帮忙！

编辑：我尝试从一个新的控制台应用程序查询这个 WMI 类并得到了同样的异常。WMI 跟踪没有给我任何有价值的信息，只是启动了 WMI 查询，然后操作在两秒钟后停止。

这是该类的代码：

```
[ManagementEntity]
public sealed class BootOrder
{        
    [ManagementKey]
    public int Order { get; private set; }

    [ManagementProbe]
    public string DeviceName { get; private set; }

    [ManagementProbe]
    public string Status { get; private set; }

    [ManagementEnumerator]
    public static IEnumerable GetBootOrder()
    {            
        if (WmiUtility.SystemType.Contains("DELL"))
        {
            return GetDellBootOrder();
        }
        else
        {
            // TODO: add code for getting HP values
            throw new NotImplementedException();
        }
    }

    private static IEnumerable GetDellBootOrder()
    {
        foreach (ManagementObject mo in WmiUtility.ExecuteWmiQuery(@"root\DellOMCI", "select BootDeviceName, BootOrder, Status from Dell_BootDeviceSequence"))
        {
            using (mo)
            {
                yield return new BootOrder
                {
                    DeviceName = Convert.ToString(mo["BootDeviceName"]),
                    Order = Convert.ToInt32(mo["BootOrder"]),
                    Status = Convert.ToString(mo["Status"])
                };
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T11:45:34.570

**Face palm**所以问题是属性的名称是“Order”。我猜这是 WQL 中的保留字。我将属性的名称更改为“BootOrder”，它工作得很好。

# jquery - 使用变量作为表选择器访问 .each tr 的正确语法

> ID：11364776
> 
> 赞同：1
> 
> 时间：2012-07-06T15:04:00.727
> 
> 标签：jquery, datatables

只是学习 jquery 的世界，我所有的谷歌搜索都给出了这样的例子：

```
$('#example thead tr').each( function () {} 
```

如果我有一个变量而不是“#example”，你如何做同样的循环？这就是我要完成的工作，但在任何地方都找不到任何示例来解释如何使用带有变量的方法。

```
var rows = oTable.$("tbody tr)"); // skip the header row
rows.each(function(index) {
    console.info("Got here");
    oTable.insertBefore(  nCloneTd.cloneNode( true ), this.childNodes[0] );
} ); 
```

上面的代码运行没有错误，但 console.log 永远不会出现。

下面是初始化表变量的内容：

```
function initTable ()
{
    var myTable = $('#example').dataTable( {
        "bJQueryUI": true,
        "sPaginationType": "full_numbers",
        "bProcessing": true,
        "bStateSave": false,
        "sAjaxSource": 'example_arrays.txt',
        "bRetrieve": true
    } );
    return myTable;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T15:17:25.653

试试这样：

```
 $.each( oTable.$("tr"), function(index){
     console.info("Got here");
     oTable.insertBefore(  nCloneTd.cloneNode( true ), this.childNodes[0] );
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:11:49.920

删除代码中的 ")" 括号和 oTable 并检查 $("tbody tr)"); . 试试这个代码

```
 var rows = $("tbody tr"); // skip the header row
 rows.each(function(index) {
   console.info("Got here");
   oTable.insertBefore(  nCloneTd.cloneNode( true ), this.childNodes[0] );
  } ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T15:12:03.093

确保您的行变量不为空。另外，为什么要从选择器中删除 #example ？

# php - Symfony 2 的自定义路由

> ID：11364778
> 
> 赞同：1
> 
> 时间：2012-07-06T15:04:05.960
> 
> 标签：php, symfony

我有一些相当复杂的路由规则，只能通过自定义代码实现，而不是默认路由器。

路由器还必须考虑域名。

是否有可能（以及如何）定义我自己的路由器类，它有一个接受 a`Request`并返回包/控制器名称的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T05:16:30.353

要实现您的要求，您无需完全重新定义路由器

您可以简单地编写自己的实现[UrlMatcherInterface](http://api.symfony.com/2.0/Symfony/Component/Routing/Matcher/UrlMatcherInterface.html)的类。如果您还希望能够生成与您的方案匹配的 URL，则必须创建另一个覆盖[UrlGeneratorInterface](http://api.symfony.com/2.0/Symfony/Component/Routing/Generator/UrlGeneratorInterface.html)的类。

为了考虑域名，您需要使用 RequestContext，它被传递给它们的构造函数（它没有很好的文档记录，但请查看[Router](https://github.com/symfony/Routing/blob/v2.1.0-BETA1/Router.php) ::get{Matcher,Generator} 了解详细信息）。

一旦你的类准备好了，你可以简单地通过覆盖你的包中的参数“router.options.generator_class”和“router.options.matcher_class”将它们注入到路由器中。

* * *

**但是**，它可能不是您想要的最佳方法 - 像这样覆盖路由器的部分需要非常小心才能保留所有缓存。

您可能要考虑使用 Symfony2 的普通路由器，但根据请求的域是不同的路由文件。如果您将 Web 服务器配置为设置变量或根据域名执行不同的前端控制器，则可以轻松完成此操作。

使用该信息，您可以为每个请求加载不同的“环境”，不同环境之间的唯一区别是它们使用不同的路由文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T01:13:31.887

在学习了 Matthias Noback 的教程之后，我对我的 CRUD 路由构建器做了一些修改。

[在routing/crud/acompetencies.yml](https://github.com/epsi/AlumniBook-SF2/blob/1004aea21a44e6ed8b664570e6d6cf4816fcd586/src/Iluni/BookBundle/Resources/config/routing/crud/acompetencies.yml)中可以看到使用 CrudLoader 之前和之后

[正如您在这个CrudLoader](https://github.com/epsi/AlumniBook-SF2/blob/1004aea21a44e6ed8b664570e6d6cf4816fcd586/src/Iluni/BookBundle/Library/Routing/CrudLoader.php)类中看到的那样，这只是一种解决方法或资源滥用。

我不知道这是正确的做法还是坏的做法。它似乎运作良好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:55:46.317

参考具有自定义路由[类](https://github.com/sonata-project/SonataAdminBundle/blob/a48db227d85586bb2ef68efc1550369d01701a78/Route/RouteCollection.php)类的奏鸣曲管理包

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-08T23:47:13.267

symfony 2.5 需要自定义匹配器的参数：router.options.matcher_base_class 和实现 Symfony\Component\Routing\Matcher\RequestMatcherInterface 的类

# python - 是否有可以填充本机 Windows 表单字段的 python 模块？

> ID：11364779
> 
> 赞同：3
> 
> 时间：2012-07-06T15:04:06.723
> 
> 标签：python, windows, native

我想知道任何可以帮助我在本机 Windows 应用程序 IDE 中输入表单数据的 Python 模块。

例如，受密码保护的 USB 具有输入密码的应用程序。我想通过运行应用程序并用密码填写表单来自动化这个过程。

提前致谢

roo7break

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T15:09:27.280

[pywinauto](http://code.google.com/p/pywinauto/)库可用于 Python 中的 Windows GUI 自动化。

# jquery - 删除父 div 中的第一个 div 会导致所有内部 div 也被删除

> ID：11364781
> 
> 赞同：2
> 
> 时间：2012-07-06T15:04:09.333
> 
> 标签：jquery

我有这个代码

```
<div id="main" style="background:#aaaaaa;float:left;height:160px;margin:5px;position:relative;display:block;width:630px;">
        <div id="1" class="item" style="background:#ffaacc;float:left;width:200px;height:150px;margin:5px;position:absolute;left:0px;top:0px;">
        </div>
        <div id="2" class="item" style="background:#aaccff;float:left;width:200px;height:150px;margin:5px;position:absolute;left:210px;top:0px;">
        </div>
        <div id="3" class="item" style="background:#ffccaa;float:left;width:200px;height:150px;margin:5px;position:absolute;left:420px;top:0px;">
        </div>
</div> 
```

我想在一些动画之后删除#main 中的第一个 div

我写了jQuery

```
$('#leftbutton').click(function() {
            $('#main').append('<div id='+ i++ +' class="item" style="background:#ffccaa;float:left;width:200px;height:150px;margin:5px;position:absolute;left:630px;top:0px;z-index:1"></div>');
            $('.item').animate({
                "left": "-=210px"
            }, 200, function(){
                $('#main div:first-child').remove();
            });
        });
}); 
```

但它也会删除所有其他 div。我只想删除第一个 div，我该怎么做

示例[http://jsfiddle.net/Ks6K6/2/](http://jsfiddle.net/Ks6K6/2/)

**编辑**

我需要保存第一个元素的引用，然后为所有 div 制作动画，然后通过引用删除第一个 div

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T15:15:10.770

我认为您遇到的问题是您正在对**所有**子元素进行动画处理，并且对于每个动画，您都传递了一个回调，该回调在完成时执行删除第一个元素。您实际上是在`x`多次“删除第一个元素”，其中`x`是动画元素的数量。

所以第一个元素动画完成，删除第一个孩子。第二个元素动画完成，它还删除了第一个孩子（之前是第二个孩子），等等。

我会在调用之前存储对要删除的特定元素的引用`.animate()`，然后使用该变量执行删除。

```
$('#leftbutton').click(function() {
    $('#main').append('<div id=' + i+++' class="item" style="background:#ffccaa;float:left;width:200px;height:150px;margin:5px;position:absolute;left:630px;top:0px;z-index:1"></div>');
    var $firstElement = $('#main div:first');
    $('.item').animate({
        "left": "-=210px"
    }, 200, function() {
       $firstElement.remove();
    });
}); 
```

[破碎的演示](http://jsfiddle.net/y9D9W/1/)

[固定演示](http://jsfiddle.net/y9D9W/2/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T15:07:02.487

尝试

```
$('div#main div').first().remove(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T15:08:19.053

您想使用[first](http://api.jquery.com/first-selector/)而不是[first-child](http://api.jquery.com/first-child-selector/)。first 仅获取第一个匹配项，first-child 获取任何匹配元素。

```
$('#leftbutton').click(
   function() { 
       $('#main').append(''); 
       $('.item').animate({ "left": "-=210px" }, 200, function(){ $('.item:first').remove(); 
       }); 
  }); 
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T15:07:55.153

尝试使用第一个选择器而不是第一个孩子，请参阅[http://api.jquery.com/first-selector/](http://api.jquery.com/first-selector/)

```
$('#main div:first').remove(); 
```

更新：

好的，您是否尝试过像这样删除：

```
$('.item').animate({
            "left": "-=210px"
        }, 200, function(){
            $(this).remove();
        }) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-06T15:11:48.037

尝试这个

```
 $("#main div").eq(0).remove(); 
```

[**演示**](http://jsfiddle.net/Ajinkya_Parakh/tmnUC/1/)

# css - 多个框阴影不渲染

> ID：11364782
> 
> 赞同：2
> 
> 时间：2012-07-06T15:04:13.700
> 
> 标签：css

我正在尝试使用 CSS3 和 box-shadow 为文本输入提供投影和内阴影，您可以在此处查看我的代码，

```
.text {
        width:388px;
        line-height:37px; 
        height:37px; 
        box-shadow:inset 0px 4px 4px rgba(193, 209, 230, 0.58), 0px 2px 2px, rgba(255, 255, 255, 0.75);
        border-radius:10px; 
        background:#cdd6e6; 
        border:0 none; 
} 
```

[​​​http://jsfiddle.net/3CBrm/](http://jsfiddle.net/3CBrm/)

但是我的盒子阴影规则只是被忽略了，我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T15:09:43.033

你似乎有一个额外的`,`：

```
...rgba(193, 209, 230, 0.58), 0px 2px 2px, rgba(255, 255, 255, 0.75);
                                         ^ 
```

在此修复后，您的阴影似乎在那里，但它与背景颜色过于相似。

[jsFiddle 演示](http://jsfiddle.net/3CBrm/3/)

# java - Java 下拉列表

> ID：11364783
> 
> 赞同：0
> 
> 时间：2012-07-06T15:04:22.697
> 
> 标签：java, swing, awt

我在java中有一个带有3个选项的下拉菜单，旁边是一个运行按钮。我在 java 中使用 eclipse 并使用 apache wicket 和 html 在 web 浏览器中运行程序。我的问题是，如果我从下拉列表中选择打印数据并单击运行按钮，它应该在控制台中打印打印成功。我尝试了各种方法及其编译，但只是没有根据 system.out.println 语句向我显示它应该执行的消息。

```
Button b = new Button("Ausführen");
b.addActionListener(new ActionListener() {

  public void actionPerformed(ActionEvent e) {
    if(role.getValue().equals("Print Data")) {
      System.out.println("Printing successfull!");
    }
  }

});

form.add(b); 
```

任何想法为什么？

# java - 无法解析 java 类 JSP

> ID：11364784
> 
> 赞同：0
> 
> 时间：2012-07-06T15:04:28.740
> 
> 标签：java, jsp

在 jsp 文件中的第 21 行出现错误：/Test.jsp UserNameCheck 无法解析

以上是我收到的错误。我正在使用的 .jsp 文件是：

```
<%@page import="webtest.*"%>
<%@page import="java.sql.*" %>
<%@page import="java.io.*" %>
<%@page import="java.util.*"%>
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>

<%  
String username = request.getParameter("username");
    String password = request.getParameter("password");%>
<h1>Hey <%=UserNameCheck.CheckLogin(username,password)%></h1>
</body>
</html> 
```

并且类代码是

```
package webtest;
public class UserNameCheck{
    public static String CheckLogin(String X,String Y){
    return X;
}
} 
```

我很确定我现在正在忽略一些非常愚蠢的事情。或者我采取的方法是不可能的。
在过去的 3 或 4 周内，我为我的公司参加了 Java 速成课程。我的学习非常混乱，所以不要假设任何事情。

我知道的。用户名和密码变量给出准确的结果。如果我将代码更改为

```
<h1> hey <%=username%></h1> 
```

我收到我想要的。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-06T16:43:48.357

您可以改用 JSP 声明：

```
 <%! 
      String CheckLogin(String X,String Y){
         return X;
      }
  %> 
```

然后调用这个方法：

```
<h1>Hey <%= CheckLogin(username,password) %></h1> 
```

# function - 在单独的页面上调用 Mysqli 函数

> ID：11364787
> 
> 赞同：0
> 
> 时间：2012-07-06T15:04:37.553
> 
> 标签：function, mysqli

我正在尝试制作一个功能页面，该页面将使用 mysqli 打开和关闭数据库，但它不起作用。这是可能的还是我每次都必须打开和关闭它？这是来自functions.php页面的代码：

```
 function opendb(){
    $mysqli = new mysqli();
    $mysqli->connect($host, $user, $pw, $db);
}

function closedb(){
    $mysqli->close();
}

function rundb($query){
    $result = $mysqli->query($query);
    return $result;
} 
```

现在，opendb() 函数在调用时工作，但 closedb() 函数返回以下错误：致命错误：调用非对象上的成员函数 close()

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T02:45:09.457

我只需要将 opendb 和 closedb 操作包含到 rundb 函数中。一旦我这样做了，它就完美地工作了。

# objective-c - 增加速度

> ID：11364789
> 
> 赞同：0
> 
> 时间：2012-07-06T15:04:38.190
> 
> 标签：objective-c, ios, xcode

大家好，我正在制作一个应用程序，你是一个蓝球，必须在不让红球碰到你的情况下移动，我想知道我该怎么做才能让速度每秒增加一次，我有这样的事情：

```
- (void)viewDidLoad {
[super viewDidLoad];

//(X Speed, Y Speed)
pos = CGPointMake(13.0,8.0);
pos2 = CGPointMake(10.0,9.0);

}

- (IBAction)restart:(id)sender {

     [restartbutton setHidden:YES];
     [menubutton setHidden:YES];
     randomMain = [NSTimer scheduledTimerWithTimeInterval:(0.03) target:self selector:@selector(onTimer) userInfo:nil repeats:YES];

}

- (IBAction)start:(id)sender {    
     [startbutton setHidden:YES];
     [restartbutton setHidden:YES];
     [menubutton setHidden:YES];
     randomMain = [NSTimer scheduledTimerWithTimeInterval:(0.03) target:self selector:@selector(onTimer) userInfo:nil repeats:YES];

}

- (IBAction)menu:(id)sender {

     [self.navigationController popViewControllerAnimated:YES];

}

- (void)onTimer {

    [self checkCollision];

    enemy.center = CGPointMake(enemy.center.x+pos.x, enemy.center.y+pos.y);
    enemy2.center = CGPointMake(enemy2.center.x+pos2.x, enemy2.center.y+pos2.y);

    if (enemy.center.x > 320 || enemy.center.x < 0) 
        pos.x = -pos.x;
    if (enemy.center.y > 480 || enemy.center.y < 0) 
        pos.y = -pos.y;
    if (enemy2.center.x > 320 || enemy2.center.x < 0) 
        pos2.x = -pos2.x;
    if (enemy2.center.y > 480 || enemy2.center.y < 0) 
        pos2.y = -pos2.y;

}

- (void)checkCollision {

    if (CGRectIntersectsRect(player.frame, enemy.frame)) {

        [randomMain invalidate];
        [startbutton setHidden:YES];
        [restartbutton setHidden:NO];
        [menubutton setHidden:NO];

        CGRect frame = [player frame];
        frame.origin.x = 135.0f;
        frame.origin.y = 205.0f;
        [player setFrame:frame];

        CGRect frame2 = [enemy frame];
        frame2.origin.x = 135.0f;
        frame2.origin.y = 20.0f;
        [enemy setFrame:frame2];

        CGRect frame3 = [enemy2 frame];
        frame3.origin.x = 135.0f;
        frame3.origin.y = 390.0f;
        [enemy2 setFrame:frame3];

        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"You Lost!" 
                                                        message:[NSString stringWithFormat:@"Better Luck Next Time"]     
                                                       delegate:nil 
                                              cancelButtonTitle:@"Cancel" 
                                              otherButtonTitles:nil];
    [alert show];

    }
}

 - (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {

    UITouch *myTouch = [[event allTouches] anyObject];
    player.center = [myTouch locationInView:self.view];

}

 - (void)viewDidUnload
 {
     [super viewDidUnload];
     // Release any retained subviews of the main view.
 }

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T17:13:53.760

您给我们的唯一不断被调用的方法似乎是 onTimer。你为什么不设置一个非常小的加速度常数，比如 0.01。然后，创建一个名为加速的方法并放入代码中，效果如下：

```
pos = CGPointMake(pos.x + ACC_CONSTANT, pos.y + ACC_CONSTANT);
pos2 = CGPointMake(pos2.x + ACC_CONSTANT, pos.y + ACC_CONSTANT); 
```

[self checkCollision]后调用加速；

然后使用 Acceleration 常数进行调整，直到获得所需的结果。

如果您希望它是一个仅每秒增加的阶跃函数，您将需要使用 NSTimer iVar，这也很容易。只需使用此 init 函数以一秒的时间间隔实例化它

```
scheduledTimerWithTimeInterval:target:selector:userInfo:repeats: 
```

然后调用@selector(accelerate) 作为目标选择器。

# c++ - 实例化模板函数时出现奇怪的错误

> ID：11364790
> 
> 赞同：0
> 
> 时间：2012-07-06T15:04:50.087
> 
> 标签：c++, templates

我有以下模板功能：

```
template <std::size_t first, std::size_t last, typename T>
bool in_range(T& in)
{
    for(auto i = in.begin(); i!=in.end(); ++i)
        if(*i<first || *i>last)
            return false;
    return true;
} 
```

但是当我尝试这样使用它时：

```
std::vector<int> test;
test.push_back(1);
test.push_back(5);
test.push_back(6);

std::cout<<in_range<4,7>(test); 
```

我收到这个奇怪的错误：

```
main.cpp: In instantiation of 'bool in_range(T&) [with long long unsigned int first = 4ull; long long unsigned int last = 7ull; T = std::vector<int>]':
main.cpp:31:34:   required from here 
```

我究竟做错了什么？

编辑：完整的构建日志： http: [//pastebin.com/Cwemq2Hk](http://pastebin.com/Cwemq2Hk)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:14:03.780

如果我在启用 C++11 支持的情况下构建它，那么它就会编译。[这是一个演示](http://ideone.com/e4Qjh)。

在 C++11 之前，`auto`它有不同的含义，因此`auto i = ...`是无效的——它声明了一个没有类型的变量。

我猜你正在使用 GCC；根据版本，您需要指定`-std=c++0x`或`-std=c++11`作为命令行选项。

# database - Umbraco Azure 网站提供 502

> ID：11364791
> 
> 赞同：0
> 
> 时间：2012-07-06T15:04:52.747
> 
> 标签：database, azure, umbraco, webmatrix

当我将我的 Umbraco 站点发布到 Azure 时，经常会导致在查看远程站点时返回 502 页面。在阅读了一些论坛帖子并遵循建议后，我认为问题出在数据库上。当我删除它并从本地重新安装时，它很好，如果我尝试覆盖正在运行的站点，它经常会导致问题，如果我停止网络服务器，它有时会导致问题。这很不一致。

此外，传输文件的唯一可靠方法是 Webmatrix，因为 FTP 不会显示文件，Git 也不做任何事情。

有没有人知道更新数据库（.sdf 文件）的完整证明方法而没有太多麻烦？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:43:47.763

umbraco 进程有时会挂在 sdf 文件上。但是，您可以做的一件事是使站点脱机并在发布过程中重新启动应用程序池。不幸的是，这将意味着网站在发布期间会停机，并且您还需要执行几次传递。

解决此问题的步骤：

1.  将名为 app_offline.htm 的文件添加到站点的根目录。这将防止人们在更新站点时 ping 站点并导致 Umbraco 获取数据库。
2.  对您的 web.config 进行更改（不确定是否有必要，但这会强制您的应用程序池重新启动……这会强制它释放您的 sdf 文件）
3.  发布一切
4.  从您的站点中删除 app_offline.htm

# c# - 需要两根手指来启动拖放事件

> ID：11364793
> 
> 赞同：0
> 
> 时间：2012-07-06T15:05:02.277
> 
> 标签：c#, wpf, pixelsense

我正在尝试创建一个涉及多个 SurfaceListBox 元素和子数据项的 MS Surface 2.0 应用程序。这里的关键交互是以拖放方式沿列表框拖动数据项（我知道这已被大量记录，我一直在阅读）。

我一直在使用[此处提供](http://msdn.microsoft.com/en-us/library/ff727837.aspx)的 MSDN 文章来回答一些关于整个拖放事件如何在 Surface 中发生的问题，但我肯定还在学习。他们提到的一件事是，可能需要两次触摸来启动拖放事件，以便仍然可以使用一根手指来滚动列表框。但是，我似乎无法让该代码正常工作。

```
 //The following 15 lines are provided for background.
        FrameworkElement findSource = e.OriginalSource as FrameworkElement;
        SurfaceListBoxItem draggedElement = null;

        // Find the touched SurfaceListBoxItem object.
        while (draggedElement == null && findSource != null)
        {
            if ((draggedElement = findSource as SurfaceListBoxItem) == null)
            {
                findSource = VisualTreeHelper.GetParent(findSource) as FrameworkElement;

                btnEditProj.Visibility = System.Windows.Visibility.Visible;
                btnDeleteProj.Visibility = System.Windows.Visibility.Visible;
            }

        }

        //THIS IS THE PART IN QUESTION.
        if (draggedElement == null || draggedElement.TouchesCapturedWithin.Count == 0)
        {
        return;
        } 
```

我可以看到第一部分检查该元素是否仍未被标识为 SurfaceListBoxItem，第二部分检查它是否在同一启动中被触摸过（然后需要两个手指），但它抛出一个错误，说明它首先不能有那种带有方法组和整数的运算符，并且在将其更改为单个等号 (=) 后，告诉我我不能使用 || 在布尔值和方法组之间。

一般来说，我还是 C# 的新手，所以我假设我在这里缺少某种简单的语法或逻辑元素，或者如果 MS 如何实现 TouchesCapturedWithin 从 SDK 1.0 更改为 2.0（或者我可以'不要将代码转置到正确的部分），但如果有人能把我引向正确的方向，我会很感激的。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T14:02:28.183

我想我已经解决了我的问题。

就像我说的，我还在学习，所以我犹豫着质疑自己对所写内容的怀疑。但是，此示例中使用的“计数”是一种方法（这让我在代码中感到失望，因为智能感知告诉我使用小于和大于 (<>) 符号，所以我认为这不是一种方法.) 但是，在尝试用括号括起来的那一行时：

```
 if (draggedElement == null || draggedElement.TouchesCapturedWithin.Count() == 0) 
        { 
        return; 
        } 
```

我发现它实际上正确地跟踪了一根和两根手指。

我猜 MSDN 改变了 Surface 1.0 和 2.0 之间实现 TouchesCapturedWithin.Count() 方法的方式？或者那里的人只是没有测试那部分代码......

# zend-framework - zend 框架保存并执行 POST 请求

> ID：11364796
> 
> 赞同：1
> 
> 时间：2012-07-06T15:05:14.983
> 
> 标签：zend-framework

您好，我有一个网站，如果登录会话超时，我会像这样保存请求

```
 Abc::saveThisUrl($this->getRequest());

 public static function saveThisUrl($url) {
        $lastPg = new Zend_Session_Namespace('history');
        $lastPg->url = $url;
    } 
```

然后成功登录后我想执行它

```
public static function getSavedUrl() {
        $lastPg = new Zend_Session_Namespace('history');
        if(!empty($lastPg->url)) {
            $path = $lastPg->url;
            $lastPg->unsetAll();
            return $path;
        }

        return ''; // Go back to index/index by default;
    } 
```

所以在我的**AbcController.php**

```
public loginAction()
{
...//login succesfull
//i tried
$request = Abc::getSavedUrl(); /* @var $request Zend_Controller_Request_Abstract */
$this->setRequest($request);

$this->dispatch($request);
//or 
$this->run($request->getRequestUri());

//also tried
$front = Zend_Controller_Front::getInstance();
                    $front->setRequest($request);
                    return $front->dispatch($request);
} 
```

两者都没有工作。我也需要能够执行**POST 查询**，互联网上的许多解决方案只关心 URL

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:35:41.457

您可以获取并保存您的模块、控制器、操作和参数而不是 url，然后在您的`loginAction`：

```
$this->_helper->redirector($action, $controller, $module, array("param1" => $p1,
                                                                "param2" => $p2)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T16:04:45.150

我发现了如何

```
$front = Zend_Controller_Front::getInstance();
$front->dispatch($request);

$this->getResponse()->clearBody();//otherwise it sends two time the same output
return;
//or die() instead of last 2 lines 
```

然后这个

```
/**
 * Get url from the session, to redirect after successfull login
 */
public static function getSavedUrl() {
    $lastPg = new Zend_Session_Namespace('history');
    if(!empty($lastPg->request)) {
        $path = $lastPg->request;

        /* $GLOBALS = $lastPg->GLOBALS;
        $_SERVER = $lastPg->_SERVER; */
        $_GET = $lastPg->_GET;
        $_POST = $lastPg->_POST;
        $_FILES = $lastPg->_FILES;
        $_REQUEST = $lastPg->_REQUEST;

        $lastPg->unsetAll();
        return $path;
    }

    return ''; // Go back to index/index by default;
}

/**
* Save url to the session, to redirect after successfull login
*/
public static function saveThisUrl($request) {
    $lastPg = new Zend_Session_Namespace('history');
    $lastPg->unsetAll();
    $lastPg->request = $request;

    /* $lastPg->GLOBALS = $GLOBALS;
    $lastPg->_SERVER = $_SERVER; */
    $lastPg->_GET = $_GET;
    $lastPg->_POST = $_POST;
    $lastPg->_FILES = $_FILES;
    $lastPg->_REQUEST = $_REQUEST;

} 
```

# objective-c - 如何将对象处理成 NSMutableArray

> ID：11364802
> 
> 赞同：-2
> 
> 时间：2012-07-06T15:05:33.337
> 
> 标签：objective-c, ios, nsmutablearray, nsobject

我有一个这样的对象：

```
@interface object : NSObject
{    
    NSString *_observation;    
    NSInteger _id;    
    NSString *_date;
    NSString *_device;  
    double _latitude;
    double _longitude; 
} 
```

如您所见，它具有一些属性。然后我创建一个`NSMutableArray`充满了上面那个对象的对象，比如

```
array[object, object ,object, ....] 
```

我想问的是如何将特定对象的特定属性处理到数组中？例如，如何将第一个对象 id 属性处理到 obj-c 中的数组中？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T15:30:24.323

如果我正确理解了这个问题，那么一旦将对象的实例变量放在`NSMutableArray`.

如果问题那么简单，这就是您的解决方案：

```
NSInteger *currID = [array objectAtIndex:x].id; 
```

此外，您可以使用快速枚举来遍历整个数组来访问每个元素的变量。

```
NSInteger *currID;
for (NSObject *currentObject in array) {
    currID = currentObject.id;
    //proccess ID
} 
```

这假设您已经在 .h 文件中`@property`进行了`id`这样的设置：

```
@property (nonatomic) BOOL latitude;
@property (nonatomic) BOOL longitude;
@property (nonatomic, copy) NSString *observation;    
@property (nonatomic) NSInteger id;    
@property (nonatomic, copy) NSString *date;
@property (nonatomic, copy) NSString *device; 
```

当然在 .m 中：

```
@synthesize latitude;
@synthesize longitude;
@synthesize observation;
@synthesize id;
@synthesize date;
@synthesize device; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:49:53.153

[`NSArray`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html)文档是你的朋友。

无论如何，要访问对象数组，您可以`- (id)objectAtIndex:(NSUInteger)index`使用`NSArray`.

**Seva Alekseyev**所说的是，你的班级必须以不同的方式组织。例如：

```
//.h
@interface MyCustomObject : NSObject
{
    // you dont need to declare variables, the compiler will do it for you
}

@property (nonatomic, copy) NSString* objObservation;
@property (nonatomic, assign) NSInteger objId;
@property (nonatomic, copy) NSString* objDate;
@property (nonatomic, copy) NSString* objDevice;
@property (nonatomic, assign) double objLatitude;
@property (nonatomic, assign) double objLongitude;

@end

//.m
@implementation MyCustomObject

@synthesize objId;
@synthesize objDate;
@synthesize objDevice;
@synthesize objLatitude;
@synthesize objLongitude;
@synthesize objObservation;

- (void)dealloc
{
    /* uncomment if you don't use ARC
    [objDate release];
    [objDevice release];
    [objObservation release];

    [super dealloc];
     */
}

@end 
```

像这样使用你的课程（你需要`#import "MyCustomObject.h"`）

```
// populate your object
MyCustomObject* myObj = [[MyCustomObject alloc] init];
myObj.objDate = @"yourDate";
myObj.objDevice = @"yourDevice";
myObj.objId = 1;
myObj.objLatitude = 22.0;
myObj.objLongitude = 23.87;
myObj.objObservation = @"yourObservation";

// insert it into your array (here only for test purposes but you could create an instance variable for store it)
NSArray* myArray = [NSArray arrayWithObjects:myObj, nil];

// if you don't use ARC
[myObj release];

// grab the object from the array
MyCustomObject * currentObj = [myArray objectAtIndex:0];
// see its values, for example
NSLog(@"%@", [currentObj objDevice]); 
```

现在我要添加一些注释。

*   当您使用类时，使用大写字母（例如`MyClass`而不是）调用它们`myclass`，变量改为以小写字母开头，例如`myVariable`
*   如果您的数组可以在不同时间填充，则需要一个[`NSMutableArray`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html). A`NSArray`一经创建就无法更改。`NSMutableArray`相反是动态的，您可以向其中添加或删除对象
*   当你处理对象时，你应该用属性包装你的变量（在这种情况下你不需要变量，因为编译器会为它们提供`@synthesize`指令）。这允许您不破坏对象封装
*   如果你愿意，你可以考虑为你的对象提供一个初始化器

当你写问题时，试着在它周围加上一些背景，并试着解释你做了什么以及你想要实现什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T15:29:42.803

为了访问数组中对象的成员，您需要获取指向该对象的指针。IE：

```
object *firstObject = [array objectAtIndex:0];
firstObject.id = 0;
object *secondObject = [array objectAtIndex:1;
... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T15:47:19.187

任何一个

```
[[array objectAtIndex:0] id] 
```

或者

```
[array objectAtIndex:0].id 
```

假设数据成员周围的属性`_id`被调用`id`。这是一个属性 getter 调用，而不是直接的 ivar 访问。

`NSArray`不能也不能用它们的 a[i] 索引符号来模拟 C 数组。这不是 C++，其中 [] 运算符可以重新定义。在上面的行中，括号表示 ObjC 方法调用（AKA “消息传递”），而不是数组索引。

# git - .gitignore 不起作用还是我误解了它？

> ID：11364803
> 
> 赞同：0
> 
> 时间：2012-07-06T15:05:33.867
> 
> 标签：git

我对 git 很陌生。我的工作文件夹中有一个 .gitignore 。

```
*.jpg
*.gif
*.png
system/*
*/Zend/*
.idea/*.* 
```

好吧，我做到了`git init`，然后`git add *`。在此它工作正常并忽略了上述文件。但是当我进行一些更改时，运行相同的命令会将忽略的文件放入暂存区。我使用的原因`git add *`是因为我处理许多文件并且添加每个文件将是一个矫枉过正。

**更新**：这是我`git add *`第二次运行时的消息..

```
#new file:   application/vendors/Zend/XmlRpc/Value/String.php
#new file:   application/vendors/Zend/XmlRpc/Value/Struct.php
... 
```

清单太长了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T15:29:01.097

根据[this question](https://stackoverflow.com/q/8527597/422353)中的信息：

> 模式中的通配符与路径名中的 / 不匹配

因此，我认为`Zend`目录的规则不正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:12:56.450

`git add *`如果您有`.gitignore`. 请参阅此[SO 问题和答案](https://stackoverflow.com/questions/2588024/how-do-i-git-add-with-wildcards-when-ignored-files-are-present)。我不知道为什么它不抱怨。

尝试使用`git add .`，因为那是你真正想要的。[与此SO Q&A](https://stackoverflow.com/questions/6612630/git-add-all-ignoring-files-in-gitignore)类似的问题。

# genetic-programming - 线性遗传规划内含子检测算法

> ID：11364804
> 
> 赞同：0
> 
> 时间：2012-07-06T15:05:45.710
> 
> 标签：genetic-programming

有人可以指出一种用于从 lgp 个体中去除内含子的特定算法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T16:53:27.767

至于去除内含子，我会看这篇论文：[医学数据挖掘中的线性遗传规划和神经网络的比较](http://www.cpdee.ufmg.br/~joao/CE/ArtigosProgGen/NnGPcomparison.pdf)。

虽然本文的重点可能不感兴趣，但在第 II-B 部分（我认为是第 20-21 页）。作者讨论了我认为非常好的简单内含子检测算法。

这是一篇相当古老的论文，因此搜索引用该论文的论文以寻找可以帮助您的其他方法可能是值得的。

我特别推荐一种更高级的方法，即本文中描述的算法：

“线性 GP 中的冗余、规范变换及其开发：图像特征合成演示”（Evolvable Machines 2011）

要获得第二篇论文，只需在 Google 中输入标题，第一个链接应该是 Springer 付费墙链接，但是如果您单击 Quick-View，您应该可以从 Google Cache 中获取论文没有问题。（如果你不能做到，请告诉我，我会帮助你）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-29T01:43:43.350

我已经实现了一个具有此功能的遗传编程开源项目。请看一下我的线性遗传编程的java实现：

[https://github.com/chen0040/java-genetic-programming](https://github.com/chen0040/java-genetic-programming)

为了在评估期间提高线性程序的性能，该库包含“线性遗传编程”一书第 3 章中描述的内含子去除过程的实现。该实现可以在它的 Program.markStructuralIntrons() 中找到

[https://github.com/chen0040/java-genetic-programming/blob/master/src/main/java/com/github/chen0040/gp/lgp/program/Program.java](https://github.com/chen0040/java-genetic-programming/blob/master/src/main/java/com/github/chen0040/gp/lgp/program/Program.java)

markStructuralIntrons() 的原理很简单，下面是从书中引用的：

> 资料来源：Brameier, M 2004 线性遗传规划（论文）

**算法 3.1（结构内含子的检测）**

1.  让设置 R_eff 始终包含在当前程序位置有效的所有寄存器。R_eff := { r | r 是输出寄存器}。从最后一条程序指令开始并向后移动。
2.  在程序中标记下一个前面的操作：目标寄存器 r_dest element-of R_eff。如果没有找到这样的指令，则转到 5。
3.  如果操作直接跟随一个分支或一系列分支，那么也标记这些指令。否则从 R_eff 中删除 r_dest 。
4.  如果尚未包含，则将新标记指令的每个源（操作数）寄存器 r_op 插入 R_eff 中。转到 2。
5.  停止。所有未标记的指令都是内含子。

下面是用 Java 实现的 Program.markStructuralIntrons() 的过程：

```
public void markStructuralIntrons(LGP manager) {

    int instruction_count=instructions.size();
    for (int i = instruction_count - 1; i >= 0; i--) {
        instructions.get(i).setStructuralIntron(true);
    }

    Set<Integer> Reff = new HashSet<>();
    int io_register_count = manager.getRegisterCount();
    for (int i = 0; i < io_register_count; ++i) {
        Reff.add(i);
    }

    Instruction current_instruction = null;
    Instruction prev_instruction = null;  // prev_instruction is the last visited instruction from bottom up of the program 

    for (int i = instruction_count - 1; i >= 0; i--) {
        prev_instruction = current_instruction;
        current_instruction = instructions.get(i);
        // prev_instruction is not an structural intron and the current_instruction
        // is a conditional construct then, the current_instruction is not structural intron either
        // this directly follows from Step 3 of Algorithm 3.1
        if (current_instruction.getOperator().isConditionalConstruct() && prev_instruction != null) {
            if (!prev_instruction.isStructuralIntron()) {
                current_instruction.setStructuralIntron(false);
            }
        } else {
            if (Reff.contains(current_instruction.getTargetOperand().getIndex())) {
                current_instruction.setStructuralIntron(false);
               Reff.remove(current_instruction.getTargetOperand().getIndex());
                if (!current_instruction.getOperand1().isConstant()) {
                    Reff.add(current_instruction.getOperand1().getIndex());
                }
                if (!current_instruction.getOperand2().isConstant()) {
                   Reff.add(current_instruction.getOperand2().getIndex());
                }
            }
        }
    }
} 
```

# java - 将文件拆分为四个部分

> ID：11364805
> 
> 赞同：3
> 
> 时间：2012-07-06T15:05:48.650
> 
> 标签：java

我想将一个文件（假设是一个 mp3）分成四个部分。我已经尝试过这段代码。但只有 File1.mp3 工作正常。我不能玩别人。我在这里做错了什么？

```
try     {

        FileInputStream in=new FileInputStream(f);
        long i=f.length();
        long j=i/4;

        FileOutputStream f0=new FileOutputStream("File1.mp3");
        FileOutputStream f1=new FileOutputStream("File2.mp3");
        FileOutputStream f2=new FileOutputStream("File3.mp3");
        FileOutputStream f3=new FileOutputStream("File4.mp3");

        for(long k=0;k<j;k++){
            f0.write(in.read());
        }
        f0.close();
        for(long l=0;l<j;l++){
            f1.write(in.read());
        }
        f1.close();
        for(long m=0;m<j;m++){
            f2.write(in.read());  
        }
        f2.close();
        for(long n=0;n<j;n++){
            f3.write(in.read());
        }
        f3.close();

        in.close();
    }
    catch (IOException e)
    {

    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-06T15:11:17.843

您不能像这样拆分结构化文件：[MP3 文件在文件开头有一个标题，](http://en.wikipedia.org/wiki/MP3#File_structure)用于描述文件其余部分的内容。拆分文件时，您只会在第一部分获得标题。

至于切割非结构化文件，比如文本，你的代码应该会好得多，只要你不介意你的句子在单词中间分裂。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-06T15:11:06.347

MP3 文件的开头或结尾都有标题，这意味着您不能仅根据文件大小对文件进行分块。当您拆分主文件时，您需要一个能够读取这些标题并将它们复制到每个部分的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T15:12:07.953

看起来 mp3 帧是相互依赖的，不能只是剪切。请参阅[此](http://mpgedit.org/mpgedit/mpeg_format/MP3Format.html)格式说明。具体来说：

> 由于没有文件头，您可以剪切 MPEG 文件的任何部分并正确播放（这应该在帧边界上完成，但大多数应用程序会处理不正确的头）。但是，对于第三层，这不是 100% 正确的。由于 MPEG Layer III 文件中的内部数据组织，帧通常是相互依赖的，不能像那样被切断。

我的猜测是你已经设法在依赖于早期帧的地方进行拆分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T15:18:35.213

查看[http://mpgedit.org/mpgedit/mpeg_format/MP3Format.html](http://mpgedit.org/mpgedit/mpeg_format/MP3Format.html)一个 MP3 文件的单个帧是 32 位长，这意味着您需要读取/写入字节组。目前您正在以 1 个字节为一组写入，这意味着您正在对帧进行分段（例如，帧的一个字节在 File1 中，其他 3 个字节在 file2 中，弄乱了正在读取您的 mp3 文件的任何程序，它期望 byte1 ）。

但是，我建议不要编写自己的 mp3 文件流，而是使用内置的

`javax.sound.sampled.AudioInputStream`和`javax.sound.sampled.AudioOutputStream`

# d3.js - D3.js 过渡

> ID：11364809
> 
> 赞同：20
> 
> 时间：2012-07-06T15:05:59.280
> 
> 标签：d3.js, bar-chart, transitions

我正在尝试使用 d3.js 创建一个动画条形图。[我希望条形像这个示例http://nvd3.com/ghpages/multiBar.html](http://nvd3.com/ghpages/multiBar.html)一样一一出现。我能够创建类似的行为，但是运动从条形的高度开始，将条形构建到 x 轴，但是我希望运动从 x 轴开始并像示例一样到达条形的高度.

我的代码的简化版本：http: [//jsfiddle.net/gorkem/ECRMd/](http://jsfiddle.net/gorkem/ECRMd/)

任何帮助将非常感激

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-07-06T16:02:27.113

因为坐标系的原点来自左上角，所以“y”值锚定在每个条的顶部。如果 'y' 值是固定的，而 'height' 增加了，看起来条形会向下生长。为了使条形图从底部开始增长，您需要同时转换“y”和“高度”。

这应该是你要找的，我只改变了两行。

```
chart.selectAll("rect")
 .data(data)
 .enter().append("rect")
 .attr("x", function(d, i) { return x(i) - .5; })
 .attr("y", function(d) { return h - .5; })                  //new----
 .attr("width", w)
 .transition().delay(function (d,i){ return i * 300;})
 .duration(300)
 .attr("height", function(d) { return y(d.value); })
 .attr("y", function(d) { return h - y(d.value) - .5; });    //new----- 
```

我在图表底部开始了'y'值（h - 0.5）。然后在过渡时，以相同的速率增加“高度”（y（d.value））并减少“y”（h - y（d.value））。这具有将条的底部固定到轴的效果。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-11T11:15:32.653

请记住，x 比例与您期望的相反（必须从底部向上构建条形图（其中底部 = svg 高度）。在输入时使用过渡动画条形图。

我认为你正在努力实现的一个例子可以在这里找到：http: [//bl.ocks.org/jamesleesaunders/f32a8817f7724b17b7f1](http://bl.ocks.org/jamesleesaunders/f32a8817f7724b17b7f1)

一切顺利，

吉姆

# java - 隐藏 System.out.println 直到管理员登录

> ID：11364813
> 
> 赞同：0
> 
> 时间：2012-07-06T15:06:03.860
> 
> 标签：java

所以我是 Java 世界的初学者，我知道一些语法并且可以制作简单的程序，但仅此而已。所以我有一个完成 90% 的任务。它的书店选项注册 - 登录 - 查看书籍 - 查看购买历史。我已经完成了这些，但我坚持的是行政能力。

我们被问到的是，如果有人使用管理员用户名登录，那么菜单中的另外 2 个选项应该会变得可见。所以就目前而言，它几乎是这样的。

1.  登记
2.  登入
3.  查看书籍
4.  查看历史
5.  退出

在用户输入用户名后的登录方法中，我想执行 If(username!="admin") "Continue as a normal user" 否则显示带有 2 个新菜单的原始菜单，如下所示

1.  登记
2.  登出
3.  查看书籍
4.  查看历史
5.  管理员用户
6.  管理图书
7.  结尾

所以我的问题是如何隐藏这两个选项或在管理员登录时显示它们。

现在我不希望任何人为我这样做，但任何类型的指导都会很棒。

提前致谢。

布兰登

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T15:09:55.320

类似的东西

```
if(username.equals("admin")) {
    System.out.println("option 6");
    System.out.println("option 7");
} 
```

本质上，您正在检查某人是否是管理员，如果他们是，那么您给他们额外的选项。尽管当您实际获得用户输入时，您必须确保他们没有输入管理选项之一。仅仅因为菜单不显示它并不意味着您不必检查它。

# python - 无法在 Scrapy 中定义自定义下载器中间件

> ID：11364815
> 
> 赞同：8
> 
> 时间：2012-07-06T15:06:05.957
> 
> 标签：python, scrapy

我正在尝试在 Scrapy 中设置自定义下载器中间件类。我怀疑我错过了一些明显的东西，但我已经阅读了几次文档并没有找到解决方案。我对本来应该是一项极其简单的任务感到有些沮丧，因此希望有人能够为我提供一些见解。

我已将以下行添加到我的 settings.py 文件中。

```
DOWNLOADER_MIDDLEWARES = { 'myproject.middlewares.TestDownloader': 400 } 
```

添加该行并运行项目后，我收到有关模块中间件不存在的错误。经过一番研究，我发现你需要在文件夹中添加一个`__init__.py`文件才能`middlewares`让 Python 识别它。我这样做了，现在出现以下错误：

```
NameError: Module 'myproject.middlewares' doesn't define any object named 'TestDownloader' 
```

没有编译 TestDownloader.py 文件，而项目中的所有其他 *.py 文件都在编译。如果我正确理解我的 Python 阅读，这意味着它没有被导入任何地方，但我找不到任何额外的 Scrapy 设置来更改以使其工作。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-06T18:37:32.797

```
DOWNLOADER_MIDDLEWARES = { 'myproject.middlewares.TestDownloader': 400 } 
```

为此，请在文件夹`middlewares.py`内创建文件`myproject`，并在该文件中放置名为`TestDownloader`.

或者在里面有`middlewares`文件夹`__init__.py`，你可以把你的下载器中间件类`TestDownloader`放在里面`__init__.py`——这也应该工作。

# c# - 如何从 ac# 项目中调用另一个进程？

> ID：11364818
> 
> 赞同：2
> 
> 时间：2012-07-06T15:06:19.670
> 
> 标签：c#, wpf, serial-port

是否可以从主程序调用某个进程（或 exe），向其发送一些参数，完成一些处理并返回结果？如果可能的话，最好的方法是什么？

我有一个用于管理工厂的 wpf 应用程序。此应用程序用于不同的工厂。唯一的区别是磨机中用于称重的串行端口通信不同。目前称重部分已编程到应用程序中。但这很难维护，因为我必须有不同版本的项目取决于地磅。所以我想要这样：我有主项目的单一版本。主项目调用另一个进程（或 exe）并发送一些参数。此 exe 进行称重并发送回权重。![在此处输入图像描述](../Images/0d8b63034f136789865a8d63774f573f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T07:37:42.927

如果您只有另一个 exe 文件，那么您可以使用（取自[http://www.dotnetperls.com/process-start](http://www.dotnetperls.com/process-start)） 运行它

```
ProcessStartInfo startInfo = new ProcessStartInfo();
startInfo.CreateNoWindow = false;
startInfo.UseShellExecute = false;
startInfo.FileName = "dcm2jpg.exe";
startInfo.WindowStyle = ProcessWindowStyle.Hidden;
startInfo.Arguments = "-f j -o \"" + ex1 + "\" -z 1.0 -s y " + ex2;

try
{
        // Start the process with the info we specified.
        // Call WaitForExit and then the using statement will close.
        using (Process exeProcess = Process.Start(startInfo))
        {
           exeProcess.WaitForExit();
        }   
}
catch
{
    // Log error.
} 
```

# python - 在 matplotlab pcolor 中设置颜色

> ID：11364821
> 
> 赞同：2
> 
> 时间：2012-07-06T15:06:21.023
> 
> 标签：python, plot, matplotlib

我想使用 matplotlib 在 python 中绘制类似于以下第二个图像的内容： ![在此处输入图像描述](../Images/cc0a0c5defd3582378b777c07fe38766.png)

这背后的代码在[这里](http://matplotlib.sourceforge.net/examples/pylab_examples/pcolor_small.html)：

```
#!/usr/bin/env python

from pylab import *

Z = rand(6,10)

subplot(2,1,1)
c = pcolor(Z)
title('default: no edges')

subplot(2,1,2)
c = pcolor(Z, edgecolors='k', linewidths=4)
title('thick edges')

show() 
```

现在，我有一个布尔值列表，我只想为每个值绘制一个**灰色**矩形，为每个值`True`绘制一个**红色**`False`矩形。

说我只有这个：

```
a = array([True,False],[False,False]) 
```

我应该将 [0,1] 中的什么值分配给 True 和 False？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T19:16:11.483

一种简单的方法是制作自定义颜色图。在您的情况下，您可以制作一个只有 2 个值的[颜色图。](http://matplotlib.sourceforge.net/api/colors_api.html#matplotlib.colors.ListedColormap)

```
from pylab import *
import matplotlib.colors

figure(figsize=(3,9))
Z = rand(6,10)

subplot(3,1,1)
c = pcolor(Z)
title('default: no edges')

subplot(3,1,2)
c = pcolor(Z, edgecolors='k', linewidths=4)
title('thick edges')
# use Z values greater than 0.5 as an example
Zbool = Z > 0.5

subplot(3,1,3)
cmap = matplotlib.colors.ListedColormap(['red','grey'])
c = pcolor(Zbool, edgecolors='k', linewidths=4, cmap=cmap)
title('thick boolean edges gray')

show() 
```

![颜色图示例](../Images/359c6f47ccfbb73c9f090bbe68b8cae5.png)

# java - leveldbjni IO 错误 LOCK: 没有这样的文件或目录

> ID：11364823
> 
> 赞同：3
> 
> 时间：2012-07-06T15:06:28.103
> 
> 标签：java, redhat, leveldb

我们正在尝试在 redhat 机器上使用 leveldbjni。它在 ubuntu 上完美运行。但是在redhat上它给出了以下错误：

org.fusesource.leveldbjni.internal.NativeDB$DBException：IO 错误：<文件位置>/LOCK：没有这样的文件或目录

我们尝试在 redhat 上创建 leveldb C++ 库（使用[https://github.com/fusesource/leveldbjni](https://github.com/fusesource/leveldbjni)上的说明），但仍然遇到同样的问题。

# windows - 来自文本文件 powershell 的有意义的数据

> ID：11364825
> 
> 赞同：0
> 
> 时间：2012-07-06T15:06:36.677
> 
> 标签：windows, powershell

我有一个如下所示的文本文件，尝试通过替换、使用通配符来获取有意义的数据，但并不完全正确。

```
 computer  - server1
 Volume 1         System Rese  NTFS  junk data
 Volume 2     C                NTFS  junk data 
 Volume 3         R5T1_ABCDEF  NTFS    junk data
   H:\R5X1_ABCDEF99XY2_APP01_ABCD_LH\
 Volume 4     H   R5T1_ABCDEF  NTFS       junk data
 Volume 5         R5T1_ABCDEF  NTFS   junk data
   H:\R5X1_ABCDEF99XY2_DBE01_EFGH_LH\
 Volume 10         R6T3_ABCDEF  NTFS  junk data
   H:\R6X3_ABCDEF99XY2_QRS_IJKL_LH\
 Volume 7         R5T2_ABCDEF  NTFS   junk data
   H:\R5X2_ABCDEF99XY2_QWE__MNOP_LH\
 Volume 8         R5T1_ABCDEF  NTFS   junk data
   H:\R5X1_ABCDEF99XY2_BTE___0DF8_LH\
 computer  - server2
 Volume 1         System Rese  NTFS  junk data
 Volume 2     C                NTFS  junk data 
 Volume 3         R5T1_ABCDEF  NTFS    junk data
   H:\R5X1_ABCDEF88XY2_APP01_ABCD_LH\
 Volume 4     H   R5T1_ABCDEF  NTFS       junk data
 Volume 5         R5T1_ABCDEF  NTFS   junk data
   H:\R5X1_ABCDEF88XY2_DBE01_EFGH_LH\
 Volume 10         R6T3_ABCDEF  NTFS  junk data
   H:\R6X3_ABCDEF88XY2_QRS_IJKL_LH\
 Volume 7         R5T2_ABCDEF  NTFS   junk data
   H:\R5X2_ABCDEF88XY2_QWE__MNOP_LH\
 Volume 8         R5T1_ABCDEF  NTFS   junk data
   H:\R5X1_ABCDEF88XY2_BTE___0DF8_LH\ 
```

这是我正在寻找的输出：1）获取旁边带有字母的那些卷（如第 2,4 卷）。2）获取旁边没有字母的那些卷，它下面的线不是卷线（如卷3、5、6）。3）删除那些没有字母或下方没有非卷线的卷（如卷1）。

最终，输出如下所示：

```
computer1 Volume 2  C
computer1 Volume 3  H:\R5X1_ABCDEF99XY2_APP01_ABCD_LH\
computer1 Volume 4  H
computer1 Volume 5  H:\R5X1_ABCDEF99XY2_DBE01_EFGH_LH\
computer1 Volume 10 H:\R6X3_ABCDEF99XY2_QRS_IJKL_LH\
computer2 Volume 2  C
computer2 Volume 3  H:\R5X1_ABCDEF88XY2_APP01_ABCD_LH\
computer2 Volume 2  H
computer2 Volume 3  H:\R5X1_ABCDEF88XY2_DBE01_EFGH_LH\
computer2 Volume 4  H:\R6X3_ABCDEF88XY2_QRS_IJKL_LH\
computer2 Volume 10 H:\R6X3_ABCDEF88XY2_QRS_IJKL_LH\ 
```

**从评论编辑**示例代码：

我有点卡在需要使用的条件上：

```
$FileListArray2 = @()
Foreach($file in Get-Content $FilesName | Where-Object {$_ -notmatch "(junk1)|(junk2)"}) { 
    if($file -match "(Volume)") { } 
    $FileListArray2 += ,@($file2) 
} 
$FileListArray2 
```

请注意，在这里我将条件留空，我为此尝试了一些东西，但它并没有按照我想要的方式工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:06:18.877

这应该这样做：

**更新：**

```
$inputstring = @'
 computer  - server1
 Volume 1         System Rese  NTFS  junk data
 Volume 2     C                NTFS  junk data 
 Volume 3         R5T1_ABCDEF  NTFS    junk data
   H:\R5X1_ABCDEF99XY2_APP01_ABCD_LH\
 Volume 4     H   R5T1_ABCDEF  NTFS       junk data
 Volume 5         R5T1_ABCDEF  NTFS   junk data
   H:\R5X1_ABCDEF99XY2_DBE01_EFGH_LH\
 Volume 10         R6T3_ABCDEF  NTFS  junk data
   H:\R6X3_ABCDEF99XY2_QRS_IJKL_LH\
 Volume 7         R5T2_ABCDEF  NTFS   junk data
   H:\R5X2_ABCDEF99XY2_QWE__MNOP_LH\
 Volume 8         R5T1_ABCDEF  NTFS   junk data
   H:\R5X1_ABCDEF99XY2_BTE___0DF8_LH\
 computer  - server2
 Volume 1         System Rese  NTFS  junk data
 Volume 2     C                NTFS  junk data 
 Volume 3         R5T1_ABCDEF  NTFS    junk data
   H:\R5X1_ABCDEF88XY2_APP01_ABCD_LH\
 Volume 4     H   R5T1_ABCDEF  NTFS       junk data
 Volume 5         R5T1_ABCDEF  NTFS   junk data
   H:\R5X1_ABCDEF88XY2_DBE01_EFGH_LH\
 Volume 10         R6T3_ABCDEF  NTFS  junk data
   H:\R6X3_ABCDEF88XY2_QRS_IJKL_LH\
 Volume 7         R5T2_ABCDEF  NTFS   junk data
   H:\R5X2_ABCDEF88XY2_QWE__MNOP_LH\
 Volume 8         R5T1_ABCDEF  NTFS   junk data
   H:\R5X1_ABCDEF88XY2_BTE___0DF8_LH\
'@

# Split the input into an array of strings
$lines = $inputstring -split '[\r\n]'

# Setup patterns to match against
$pattern1 = "(Volume \d+)\s+(\w)\s+"
$pattern2 = "(Volume \d+)\s+"
$pattern3 = "\s+(\w:\\.*)"
$pattern4 = "^ computer  - (\S+)$"

# Store the current computer that is being viewed
$currentcomputer = "UNKNOWN"

# Loop through each line
for($i = 0; $i -lt $lines.count; $i++)
{
    # Start off assuming the current line produces no output
    $output = ""

    # Look for volumes with drive letters
    if($lines[$i] -match $pattern1)
    {
        $output = $matches[1] + " " + $matches[2]
    }
    # Look for volumes without drive letters
    elseif($lines[$i] -match $pattern2)
    {
        $volume = $matches[1]

        # Consider the next line to see if it has a path
        if($lines[$i + 1] -match $pattern3)
        {
            $output = $volume + " " + $matches[1]

            # If the next line had a path then we handled it and need to skip it
            $i++
        }
    }
    elseif($lines[$i] -match $pattern4)
    {
        $currentcomputer = $matches[1]
    }

    # Write out any output that was produced
    if($output -ne "")
    {
        $currentcomputer + " " + $output
    }
} 
```

# backbone.js - 使用 Backbone.history 返回而不触发路由功能

> ID：11364837
> 
> 赞同：6
> 
> 时间：2012-07-06T15:07:04.120
> 
> 标签：backbone.js

我有一个模式弹出窗口，打开时会更改 URL。当用户关闭弹出窗口时，我想返回上一个 URL，但我不想触发与该 URL 关联的路由，因为这将重新加载我的集合并呈现视图等。有没有办法在`window.history.back()`不触发的情况下调用路线，还是有与此等效的骨干网？

我能想到的唯一解决方案是保存以前的路线，然后当模式关闭时调用

```
Backbone.history.navigate(route, {trigger: false, replace: true}); 
```

但这似乎是解决一个简单问题的复杂方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T07:36:59.890

在路由器中存储历史听起来对我来说是一个很好的解决方案，我想不出更好的方法来解决这个问题。

一个很好的解决方案在这里： [使用 Backbone.js 将 url 静默更改为以前的](https://stackoverflow.com/questions/8416074/silently-change-url-to-previous-using-backbone-js)

我会做一个小的调整，所以它看起来像这样：

```
class MyRouter extends Backbone.Router

  initialize: (options) ->
    @on "all", @storeRoute
    @history = []

  storeRoute: ->
    @history.push Backbone.history.fragment

  previous: ->
    if @history.length > 1
      @navigate @history[@history.length-2], false
    else
      @navigate '', true 
```

然后你可以调用 MyRouter.previous()，如果你是通过直接请求来的，它会将你带到你的根目录。

我希望它是路由器的默认功能，至少它可以保留 5 个最后的路由。

# jquery - 如果body有这个类，则将此内容放在#mydiv中，否则将其他内容放在#mydiv中

> ID：11364841
> 
> 赞同：6
> 
> 时间：2012-07-06T15:07:28.447
> 
> 标签：jquery, class

JS初学者在这里。

我需要有关脚本的帮助，以根据页面正文标记是否具有“主页”类将不同的内容放置在 div 中。

我正在尝试使用 .hasClass 和 .html 来实现这一点。似乎它应该非常简单，但我无法弄清楚。缺乏正确的语法知识？不正确的声明？我不知道，希望有人能指出我正确的方向！

```
 if ($("body").hasClass("home") == true) {
            ("#mobilemenu").html("<a href="#">HOME</a>");
    }
    else {
            ("#mobilemenu").html("<a href="#">NOT HOME</a>");
    } 
```

JSFiddle（目前什么都不做）在这里：http: [//jsfiddle.net/aqyN4/](http://jsfiddle.net/aqyN4/)

非常欢迎链接到其他 JSFiddles 或具有类似功能的问题！

谢谢，

阿里

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-06T15:09:20.743

`$`你之前忘记了`("#mobilemenu")`：

```
if ($("body").hasClass("home")) {
    $("#mobilemenu").html("<a href='#'>Alle Kategorien- HOME</a>");
}
else {
    $("#mobilemenu").html("<a href='#'>NOT HOME</a>");
}​ 
```

**演示**：http: [//jsfiddle.net/aqyN4/4/](http://jsfiddle.net/aqyN4/4/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T15:09:50.823

hasClass 已经测试了一个真值，你不需要做比较。

此外，这些`("#mobilemenu")`标签没有`$`附加 jQuery。这使它成为一个未声明的函数。另外...除非您对其进行转义或使用撇号，否则您不能使用它打开语句`"`并使用它来封装字符串。请参阅下面的工作代码。

```
if ($("body").hasClass("home")) {
  $("#mobilemenu").html("<a href='#'>HOME</a>");
}
else{
  $("#mobilemenu").html("<a href='#'>NOT HOME</a>");
} 
```

# regex - 如何删除除粗体、斜体、下划线和换行之外的所有 html 标签？

> ID：11364848
> 
> 赞同：0
> 
> 时间：2012-07-06T15:07:47.120
> 
> 标签：regex

我对正则表达式不太擅长，所以我正在为此寻求帮助。

我想知道什么是删除所有 html 标签的正则表达式，但以下内容除外。

1.  大胆的
2.  斜体
3.  强调
4.  新队

多谢你们。希望你能帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-12T09:34:53.123

我不确定为什么其他答案认为您需要解析 HTML。您只需要替换一些模式而不是其他模式。因此，您使用回调函数进行正则表达式替换...

```
var keep = {
    b: true,
    i: true,
    u: true,
    br: true
};

html.replace(/<\/?([a-z]+) ?[^>]*>/g, function(wholeMatch, tagName)
{
    if (keep[tagName]) {
        return wholeMatch;
    }

    return '';
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:14:59.883

用空字符串替换正则表达式`<[]>.*?</[]>` 并收集到`[]`所有包含标签中，例如`<[mas]>.*?</[mas]>`捕获`<m>anything</m>` `<a>anything</a>` `<s>anything</s>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T15:16:29.290

[除此之外](https://stackoverflow.com/a/1732454/1046610)的笑话，不要尝试使用正则表达式解析 HTML，使用 HTML 解析器。它会让你的生活变得轻松。

谷歌一些东西或在这里搜索关于“HTML解析器”+您选择的语言。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-07-31T14:33:26.610

*   您可以先使用正则表达式将 Bold 、 Italic 、 Underline Tags 替换为 Temp 字符串
*   然后将所有html标签替换为纯文本
*   将临时字符串替换回粗体、斜体、下划线标记

下面是带有详细代码的链接。

[http://techierocks.com/2018/07/remove-html-tags-css-styling-except-bold-italic-underline-new-line.html](http://techierocks.com/2018/07/remove-html-tags-css-styling-except-bold-italic-underline-new-line.html)

# web-services - Web服务中的WSDL Soap异常

> ID：11364850
> 
> 赞同：0
> 
> 时间：2012-07-06T15:07:51.057
> 
> 标签：web-services, soap, wsdl

有谁知道这个错误是什么意思？我读过它可能是PHP版本问题。也可能是由于权限？或者说..像防火墙？

```
SoapFault Object ( [message:protected] => SOAP-ERROR: Parsing Schema: can't import schema from 
'http://www.w3.org/2005/05/xmlmime' [string:Exception:private] => [code:protected] => 0 [file:
protected] => /person/ok/my_library/Zend/Soap/aplace.php [line:protected] => 51 [trace
:Exception:private] => Array ( [0] => Array ( [file] => /person/ok/my_library/Zend/Soap/Client
/aplace.php [line] => 51 [function] => SoapClient [class] => SoapClient [type] => -> [args] => 
Array ( [0] => http://myWSDL:7001/web/10/Intw?WSDL [1] => Array ( [encoding]
 => UTF-8 [soap_version] => 2 [trace] => 1 ) ) ) [1] => Array ( [file] => /person/ok/my_library/
 Zend/Soap/Client.php [line] => 1024 [function] => __construct [class] => Zend_Soap_Client_aplace
 [type] => -> [args] => Array ( [0] => Array ( [0] => Zend_Soap_Client Object ( [_encoding:protected] 
 => UTF-8 [_classmap:protected] => [_faultExceptions:protected] => Array ( ) [_soapVersion:protected] 
 => 2 [_uri:protected] => [_location:protected] => [_style:protected] => [_use:protected] => 
 [_login:protected] => [_password:protected] => [_proxy_host:protected] => [_proxy_port:protected] 
 => [_proxy_login:protected] => [_proxy_password:protected] => [_local_cert:protected] => 
 [_passphrase:protected] => [_compression:protected] => [_connection_timeout:protected] => 
 [_stream_context:protected] => [_features:protected] => [_cache_wsdl:protected] => 
 [_user_agent:protected] => [_wsdl:protected] => http://myWSDL:7001/web/101/Intw?WSDL 
 [_soapClient:protected] => [_lastMethod:protected] => [_soapInputHeaders:protected] => Array ( ) 
 [_permanentSoapInputHeaders:protected] => Array ( ) [_soapOutputHeaders:protected] => Array ( ) ) 
 [1] => _doRequest ) [1] => http://myWSDL:7001/web/101/Intw?WSDL [2] => 
 Array ( [encoding] => UTF-8 [soap_version] => 2 [trace] => 1 ) ) ) [2] => 
 Array ( [file] => /my_library/place.php [line] => 
 1180 [function] => _initSoapClientObject [class] => Zend_Soap_Client 
 [type] => -> [args] => Array ( ) ) [3] => Array ( [file] => /my_library/place.php 
 [line] => 1104 [function] => getSoapClient [class] => Zend_Soap_Client [type] => -> [args] => Array ( ) ) [4] => 
 Array ( [file] => /some/path/to/my/file.php [line] => 
 149 [function] => __call [class] => Zend_Soap_Client [type] => -> [args] => Array ( [0] => command [1] => 
 Array ( [0] => Array ( [arg0] => Array ( [Username] => myUsername:) [Password] => 
 myPassword:) [InputField] => Summary [ItemId] => 9999999 ) ) ) ) ) [5] => 
 Array ( [file] => /some/path/to/my/file.php 
 [line] => 149 [function] => command [class] => Zend_Soap_Client [type] => -> [args] => 
 Array ( [0] => Array ( [arg0] => Array ( [Username] => myUsername:) [Password] => myPassword:) [InputField] => 
 Summary [ItemId] => 9999999 ) ) ) ) [6] => Array ( [file] => /some/path/to/my/file.php 
 [line] => 256 [function] => getPickFieldValue [class] => Code_Tracker_PriNvcProcessController [type] => -> [args] => 
 Array ( [0] => Dev Task Component ) ) [7] => Array ( [file] => /person/ok/my_library/Zend/Controller/Action.php [line] => 513 [function] => 
 mksFormAction [class] => Code_Tracker_PriNvcProcessController [type] => -> [args] => Array ( ) ) [8] => 
 Array ( [file] => /some/other/path/to/another/file.php [line] => 289 [function] => 
 dispatch [class] => Zend_Controller_Action [type] => -> [args] => Array ( [0] => mksFormAction ) ) [9] => 
 Array ( [file] => /person/ok/my_library/Zend/Controller/Front.php [line] => 954 [function] => dispatch [class] => 
 Zend_Controller_Dispatcher_Standard [type] => -> [args] => Array ( [0] => Zend_Controller_Request_Http Object ( [_paramSources:protected] => 
 Array ( [0] => _GET [1] => _POST ) [_requestUri:protected] => /yet/another/path/to/a/js/form?code_id=706 [_baseUrl:protected] => 
 [_basePath:protected] => [_pathInfo:protected] => /yet/another/path/to/a/js/form [_params:protected] => Array ( [module] => 
 code_tracker [controller] => pri-nvc-process [action] => mks-form ) [_rawBody:protected] => [_aliases:protected] => Array ( ) 
 [_dispatched:protected] => 1 [_module:protected] => code_tracker [_moduleKey:protected] => module [_controller:protected] => 
 pri-nvc-process [_controllerKey:protected] => controller [_action:protected] => mks-form [_actionKey:protected] => action ) [1] => 
 Zend_Controller_Response_Http Object ( [_body:protected] => Array ( ) [_exceptions:protected] => Array ( ) [_headers:protected] => Array ( ) 
 [_headersRaw:protected] => Array ( ) [_httpResponseCode:protected] => 200 [_isRedirect:protected] => [_renderExceptions:protected] => 
 [headersSentThrowsException] => 1 ) ) ) [10] => Array ( [file] => /again/another/path/to/initialize.php [line] => 67 [function] => 
 dispatch [class] => Zend_Controller_Front [type] => -> [args] => Array ( ) ) [11] => Array ( [file] => /again/another/path/to/initialize.php 
 [line] => 43 [function] => dispatch [class] => application_Init [type] => :: [args] => Array ( ) ) [12] => Array ( [file] => 
 /again/another/path/to/initialize.php [line] => 55 [function] => init [class] => application_Init [type] => :: [args] => 
 Array ( ) ) [13] => Array ( [file] => /another/path/but/to/html/index.php [line] => 20 [function] => start [class] => 
 application_Init [type] => :: [args] => Array ( ) ) ) [previous:Exception:private] => [faultstring] => SOAP-ERROR: 
 Parsing Schema: can't import schema from 'http://www.w3.org/2005/05/xmlmime' [faultcode] => WSDL ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T17:11:04.527

可能仍然存在代理（阻止从您的应用程序访问模式），但您的浏览器可能已经为它进行了预配置。

在您的 php 应用程序中，可以打印为该模式位置返回的 HTTP 代码的日志输出吗？以前没有使用过 PHP，但可能使用过 HttpClient - 像这样：[http ://scripts.incutio.com/httpclient/examples.php](http://scripts.incutio.com/httpclient/examples.php)

# php - 如何在不使用 curl 选项的情况下在 PHP 中查看 url 状态代码？

> ID：11364859
> 
> 赞同：1
> 
> 时间：2012-07-06T15:08:23.283
> 
> 标签：php, sitemap

我想为我的站点创建站点地图。所以在创建站点地图之前，我想知道每个 url 的状态码。我使用 curl 选项来扣除状态码。我的网站中有 400 多个网址。如果我使用 curl，它需要很长时间。

只有我想允许包含状态代码 200 的 url。

您能否请任何人告诉我任何其他选项来扣除每个网址的状态码。

我使用了下面的 curl 代码。

```
$ch = curl_init($url);
curl_setopt($ch, CURLOPT_POST, 1);  
curl_setopt($ch, CURLOPT_POSTFIELDS, $urlparam);  
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 0); 
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);  
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);  
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt($ch, CURLOPT_TIMEOUT, 240);  

curl_exec($ch);
$curlcode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
echo $curlcode; 
```

[参考链接](https://stackoverflow.com/questions/427203/how-can-i-determine-if-a-url-redirects-in-php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:14:15.337

几个月前我遇到了同样的问题。我发现使用此代码示例访问我自己的页面状态代码要快得多：

```
<?php
//
// Checking the status of a web page - funmin.com
//

$server="www.YOUR_WEBSITE.com";
function sockAccess($page)
{
   $errno = "";
   $errstr = "";
   $fp = 0;
   global $server;
   $fp = fsockopen($server, 80, $errno, $errstr, 30);

   if ($fp===0)
   {
      die("Error $errstr ($errno)");
   }
   $out = "GET /$page HTTP/1.1\r\n";
   $out .= "Host: $server\r\n";
   $out .= "Connection: Close\r\n\r\n";

   fwrite($fp,$out);
   $content = fgets($fp);
   $code = trim(substr($content,9,4));
   fclose($fp);
   return intval($code);
}
?> 
```

更多文档可以在这里找到：[http ://www.forums.hscripts.com/viewtopic.php?f=11&t=4217](http://www.forums.hscripts.com/viewtopic.php?f=11&t=4217)

# python - 如何创建一个大字典而不是一堆小字典

> ID：11364868
> 
> 赞同：0
> 
> 时间：2012-07-06T15:08:56.157
> 
> 标签：python, pointers, dictionary, nested-loops

我有一个问题。解决方案可能是直截了当的，但我没有看到它。下面的代码返回一堆单独的字典，而不是一个大字典。然后我遍历这些小字典以提取值。问题是我宁愿通过一个大字典而不是一堆小字典来排序。“objFunctions.getAttributes”返回一个字典。“objFunctions.getRelationships”返回一个指针。

这是输出： {1:value} {2:value} {3:value}

这就是我想要的：{1:value,2:value,3:value}

```
for object in objList:
   relationship = objFunctions.getRelationships(object)
   for relPtr in relationships:
      uglyDict = objFunctions.getAttributes(relPtr) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T15:11:43.397

使用[`.update()`方法](http://docs.python.org/library/stdtypes.html#dict.update)来合并dicts：

```
attributes = {}
for object in objList:
    relationship = objFunctions.getRelationships(object)
    for relPtr in relationships:
        attributes.update(objFunctions.getAttributes(relPtr)) 
```

请注意，如果一个键在不同的调用中重复，则最后`.getAttributes`存储的值`attributes`将是该键返回的最后一个值。

如果您不介意将您的值存储为列表；您必须手动将您的 dicts 与一个一个附加到 defaultdict 的值合并：

```
from collections import defaultdict

attributes = defaultdict(list)
for object in objList:
    relationship = objFunctions.getRelationships(object)
    for relPtr in relationships:
        for key, value in objFunctions.getAttributes(relPtr):
            attributes[key].append(value) 
```

现在，您的`attributes`dict 将包含每个键的列表，并将各种值收集在一起。您也可以使用 set，使用`defaultdict(set)`and`attributes[key].add(value)`代替。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:32:11.617

```
>>> from collections import defaultdict
>>> x = defaultdict(list)
>>> y = defaultdict(list)
>>> x[1].append("value1")
>>> x[2].append("value2")
>>> y[1].append("value3")
>>> y[2].append("value4")
>>> for k in y:
...     x[k].extend(y[k])
...
>>> print x
defaultdict(<type 'list'>, {1: ['value1', 'value3'], 2: ['value2', 'value4']}) 
```

# php - 分页的mysql结果

> ID：11364869
> 
> 赞同：0
> 
> 时间：2012-07-06T15:08:58.883
> 
> 标签：php, mysql, pagination

查询是：

```
SELECT * FROM `news` ORDER BY `id` LIMIT ($curr_page * 5), ( ($curr_page * 5) + 5 ) 
```

从哪里`$curr_page`获取值的 php 变量`$_GET['page']`

我想进行分页（每页有 5 个新闻），但我不知道为什么 mysql 会返回额外的值。

在第一页上，结果正常：$curr_page = 0

查询将是：

```
SELECT * FROM `news` ORDER BY `id` LIMIT 0, 5 
```

但是在第二页上，查询的结果是添加了额外的新闻，10 条而不是 5 条。

第二页的查询：

```
SELECT * FROM `news` ORDER BY `id` LIMIT 5, 10 
```

怎么了？为什么结果有 10 个值而不是 5 个？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:12:14.767

LIMIT 语句的语法是：

> 限制 [START_ROW]，[COUNT]

所以，你的代码应该是：

```
SELECT * FROM `news` ORDER BY `id` LIMIT ($curr_page * 5), 5 
```

想补充，不知道你的表的结构：通常“新闻”是按发布日期而不是 id 排序的。如果您的表中有一个发布日期字段，它会生成一个比 id 更合适的排序列，这对用户来说毫无意义。假设 id 是自动递增的，您输入文章的顺序可能并不总是反映正式的发布日期。

**文档**

*   MySQL 的 SELECT 语法 - [http://dev.mysql.com/doc/refman/5.0/en/select.html](http://dev.mysql.com/doc/refman/5.0/en/select.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:11:56.560

看这个例子，第一个参数是要开始的行，第二个是要显示的结果数

```
mysql> select * From t1 limit 0,5;
+----------+------------+--------------+---------------------+
| actor_id | first_name | last_name    | last_update         |
+----------+------------+--------------+---------------------+
|        1 | PENELOPE   | GUINESS      | 2006-02-15 04:34:33 |
|        2 | NICK       | WAHLBERG     | 2006-02-15 04:34:33 |
|        3 | ED         | CHASE        | 2006-02-15 04:34:33 |
|        4 | JENNIFER   | DAVIS        | 2006-02-15 04:34:33 |
|        5 | JOHNNY     | LOLLOBRIGIDA | 2006-02-15 04:34:33 |
+----------+------------+--------------+---------------------+
5 rows in set (0.00 sec)

mysql> select * From t1 limit 5,5;
+----------+------------+-----------+---------------------+
| actor_id | first_name | last_name | last_update         |
+----------+------------+-----------+---------------------+
|        6 | BETTE      | NICHOLSON | 2006-02-15 04:34:33 |
|        7 | GRACE      | MOSTEL    | 2006-02-15 04:34:33 |
|        8 | MATTHEW    | JOHANSSON | 2006-02-15 04:34:33 |
|        9 | JOE        | SWANK     | 2006-02-15 04:34:33 |
|       10 | CHRISTIAN  | GABLE     | 2006-02-15 04:34:33 |
+----------+------------+-----------+---------------------+
5 rows in set (0.00 sec)

mysql> select * From t1 limit 10,5;
+----------+------------+-----------+---------------------+
| actor_id | first_name | last_name | last_update         |
+----------+------------+-----------+---------------------+
|       11 | ZERO       | CAGE      | 2006-02-15 04:34:33 |
|       12 | KARL       | BERRY     | 2006-02-15 04:34:33 |
|       13 | UMA        | WOOD      | 2006-02-15 04:34:33 |
|       14 | VIVIEN     | BERGEN    | 2006-02-15 04:34:33 |
|       15 | CUBA       | OLIVIER   | 2006-02-15 04:34:33 |
+----------+------------+-----------+---------------------+
5 rows in set (0.00 sec) 
```

在你的情况下，第二个参数是静态的，第一个参数`($curr_page * 5)`

# ios - 在 MPMoviePlayerViewController 中恢复视频

> ID：11364872
> 
> 赞同：0
> 
> 时间：2012-07-06T15:09:14.660
> 
> 标签：ios, xcode, mpmovieplayercontroller, mpmovieplayer

我可以使用 MPMoviePlayerViewController 播放视频文件，一切正常。但是如果我按下主页按钮，现在打开应用程序，视频将从超级视图中删除。我知道如何获取通知。你能告诉我如何恢复相同的视频吗？

```
NSString* filePath = [[NSBundle mainBundle] pathForResource:@"adv" ofType:@"mp4"];
NSURL*  url = [NSURL fileURLWithPath:filePath];

_moviePlayer = [[MPMoviePlayerViewController alloc] initWithContentURL:url];
[_moviePlayer.view setFrame:self.view.bounds];
[self.view addSubview:_moviePlayer.view]; 
```

我正在使用上面的代码播放视频。如果我按下 Home Button ，然后回到应用程序，视频就消失了。我只能看到加载中..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T15:35:49.920

`[_moviePlayer play]`当应用程序再次激活时，您应该能够通过调用来重新开始播放。

您可以从 AppDelegate 的方法回调`applicationDidBecomeActive`，或者执行以下操作：

```
[[NSNotificationCenter defaultCenter] addObserverForName:UIApplicationDidBecomeActiveNotification object:[UIApplication sharedApplication] queue:[NSOperationQueue mainQueue] usingBlock:^(NSNotification *note) {
  [_moviePlayer play];
}]; 
```

为通知添加观察者（不要忘记稍后将其删除）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:27:31.977

注册 MPMoviePlayerPlaybackStateDidChangeNotification 通知并检查 _moviePlayer.movi​​ePlayer 属性上的 endPlaybackTime 值

然后在下次显示播放器时将 initialPlaybackTime 设置为上一个结束值

# c - cufft 一维复数到复数变换

> ID：11364873
> 
> 赞同：1
> 
> 时间：2012-07-06T15:09:19.083
> 
> 标签：c, cuda, fft

我正在尝试使用 cufft 库为 fft 1d 转换编写一个简单的代码。

[我以 cufft 库教程（链接](http://developer.download.nvidia.com/compute/DevZone/docs/html/CUDALibraries/doc/CUFFT_Library.pdf)）上的代码为例，但转换前和逆变换后的数据不一样。为什么 ？

这是输出：

```
[1DCUFFT] starting...

[1DCUFFT] is starting...
Transforming signal cufftExecC2C
Transforming signal back cufftExecC2C
first : 0.840188 0.000000  after 2.020520 -2.465333
first : 0.394383 0.000000  after 2.690347 -2.105700
first : 0.783099 0.000000  after 3.155561 -1.491952
first : 0.798440 0.000000  after 3.309971 -0.761629
first : 0.911647 0.000000  after 3.139909 -0.092953
first : 0.197551 0.000000  after 2.734147 0.355526
first : 0.335223 0.000000  after 2.256154 0.501509
first : 0.768230 0.000000  after 1.887422 0.369626
first : 0.277775 0.000000  after 1.762471 0.083391
first : 0.553970 0.000000  after 1.920150 -0.179526
first : 0.477397 0.000000  after 2.289955 -0.252255
first : 0.628871 0.000000  after 2.718623 -0.039409
first : 0.364784 0.000000  after 3.026649 0.449287
first : 0.513401 0.000000  after 3.072947 1.104457
first : 0.952230 0.000000  after 2.803322 1.758350
first : 0.916195 0.000000  after 2.265463 2.245056 
```

这是我的源代码，教程示例建议将数据集大小的输出划分为具有相同的值。

```
// includes, system
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <math.h>

// includes, project
#include <cufft.h>
#include <cutil_inline.h>
#include <shrQATest.h>
void runTest(int argc, char** argv);

// The filter size is assumed to be a number smaller than the signal size
#define SIGNAL_SIZE        16

////////////////////////////////////////////////////////////////////////////////
// Program main
////////////////////////////////////////////////////////////////////////////////
int main(int argc, char** argv) 
{
    runTest(argc, argv);
}

////////////////////////////////////////////////////////////////////////////////
//! Run a simple test for CUDA
////////////////////////////////////////////////////////////////////////////////
void runTest(int argc, char** argv) 
{

    printf("[1DCUFFT] is starting...\n");

    if( cutCheckCmdLineFlag(argc, (const char**)argv, "device") )
        cutilDeviceInit(argc, argv);
    else
        cudaSetDevice( cutGetMaxGflopsDeviceId() );
    cufftComplex* h_signal=(cufftComplex*)malloc(sizeof(cufftComplex) * SIGNAL_SIZE);
    // Allocate host memory for the signal
    //Complex* h_signal = (Complex*)malloc(sizeof(Complex) * SIGNAL_SIZE);
    // Initalize the memory for the signal
    for (unsigned int i = 0; i < SIGNAL_SIZE; ++i) {
        h_signal[i].x = rand() / (float)RAND_MAX;
        h_signal[i].y = 0;
    }

    int mem_size = sizeof(cufftComplex) * SIGNAL_SIZE;

    // Allocate device memory for signal
    cufftComplex* d_signal;
    cutilSafeCall(cudaMalloc((void**)&d_signal, mem_size));

    // Copy host memory to device
    cutilSafeCall(cudaMemcpy(d_signal, h_signal, mem_size,
                              cudaMemcpyHostToDevice));

    // CUFFT plan
    cufftHandle plan;
    cufftSafeCall(cufftPlan1d(&plan, mem_size, CUFFT_C2C, 1));

    // Transform signal 
    printf("Transforming signal cufftExecC2C\n");
    cufftSafeCall(cufftExecC2C(plan, (cufftComplex *)d_signal, (cufftComplex *)d_signal, CUFFT_FORWARD));

    // Transform signal back
    printf("Transforming signal back cufftExecC2C\n");
    cufftSafeCall(cufftExecC2C(plan, (cufftComplex *)d_signal, (cufftComplex *)d_signal, CUFFT_INVERSE));

    // Copy device memory to host
    cufftComplex* h_inverse_signal = (cufftComplex*)malloc(sizeof(cufftComplex) * SIGNAL_SIZE);;
    cutilSafeCall(cudaMemcpy(h_inverse_signal, d_signal, mem_size,
                              cudaMemcpyDeviceToHost));

    for(int i=0;i< SIGNAL_SIZE;i++){
        h_inverse_signal[i].x= h_inverse_signal[i].x/(float)SIGNAL_SIZE;
        h_inverse_signal[i].y= h_inverse_signal[i].y/(float)SIGNAL_SIZE;

        printf("first : %f %f  after %f %f \n",h_signal[i].x,h_signal[i].y,h_inverse_signal[i].x,h_inverse_signal[i].y);
    }  

    //Destroy CUFFT context
    cufftSafeCall(cufftDestroy(plan));

    // cleanup memory
    free(h_signal);

    free(h_inverse_signal);
    cutilSafeCall(cudaFree(d_signal));
    cutilDeviceReset();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T15:31:08.513

你需要改变：

```
cufftSafeCall(cufftPlan1d(&plan, mem_size, CUFFT_C2C, 1)); 
```

到：

```
cufftSafeCall(cufftPlan1d(&plan, SIGNAL_SIZE, CUFFT_C2C, 1)); 
```

（`cufftPlan1d`需要数据点的数量，而不是内存大小（以字节为单位！）

# python - 使用 Google App Engine 将图像/视频上传到 Google 云存储

> ID：11364878
> 
> 赞同：5
> 
> 时间：2012-07-06T15:09:29.437
> 
> 标签：python, google-app-engine, google-cloud-storage

我已经阅读了[使用谷歌应用引擎将图像发送到谷歌云存储](https://stackoverflow.com/questions/9237747/sending-images-to-google-cloud-storage-using-google-app-engine)的问题。

但是，答案中的代码将文件首先上传到 Blobstore，因此文件不能超过 32MB。

如何将大文件直接上传到 Google Cloud Storage？

我查看了官方文档[Upload Objects](https://developers.google.com/storage/docs/json_api/v1/how-tos/upload)，但我仍然不知道如何编写表单来发布大文件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-06T22:32:44.603

从 1.7.0 开始很容易

```
upload_url = blobstore.create_upload_url('/upload_handler', gs_bucket_name='my_bucket') 
```

将直接上传到 Google Storage 并返回指向 Cloud Storage 中上传的 blob 密钥。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T09:22:04.790

upload_url = blobstore.create_upload_url('/upload', gs_bucket_name='mybucketname')

确实使用 blob 密钥上传到云存储，但它仍将上传的文件也放入 blobstore。

# python - Linux 和 Python：自动检测 Arduino 串口

> ID：11364879
> 
> 赞同：4
> 
> 时间：2012-07-06T15:09:31.493
> 
> 标签：python, macos, serial-port, arduino

我在使用 Mac/Linux 在 Python 中自动检测我的 Arduino 串行端口时遇到问题。

我知道一个有效的 shell 命令来查找端口；因为 Arduino 串口几乎总是以 开头`tty.usbmodem`，所以您可以找到`ls /dev | grep tty.usbmodem`应该返回类似`tty.usbmodem262141`.

但是，我对如何从我的 Python 代码中调用这个 shell 命令感到困惑。我试过这个：

```
p = "/dev/" + str(subprocess.Popen('ls /dev | grep tty.usbmodem', shell=True).stdout) 
```

哪个应该`p`成为`/dev/tty.usbmodem262141`.

但是，此刻我得到`/dev/None`.

* * *

如何修改我的 shell 脚本调用以返回正确的字符串？我尝试使用[几个命令来调用 shell 脚本](https://stackoverflow.com/questions/89228/how-to-call-external-command-in-python)，但都没有奏效。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T15:16:35.247

首先，如果您使用的是 shell，则可以使用 glob ( `*`)，因此您的命令将变为`ls /dev/tty.usbmodem*`.

接下来，您甚至不必调用 shell 命令即可在 Python 中使用 glob！

考虑以下代码：

```
import glob

print(glob.glob("/dev/tty.usbmodem*")) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T04:14:35.500

我写这篇文章是为了找出 arduino 在 osx 10.7.x 上插入了什么开发：享受。

```
#!/usr/bin/env bash

# script name: findtty.sh
# author: Jerry Davis
#
# this little script determines what usb tty was just plugged in
# on osx especially, there is no utility that just displays what the usb
# ports are connected to each device.
#
# I named this script findtty.sh
# if run interactively, then it prompts you to connect the cable and either press enter or   it will timeout after 10 secs.
# if you set up an alias to have it run non-interactively, then it will just sleep for 10 secs.
# either way, this script gives you 10 seconds to plug in your device

# if run non interactively, a variable named MCPUTTY will be exported, this would be an advantage.
# it WAS an advantage to me, otherwise this would have been a 4 line script. :)
#
# to set up an alias to run non-interactively, do this:
#   osx: $ alias findtty='source findtty.sh',
#   or linux: $ alias findtty='. findtty.sh' (although source might still work)

\ls -1 /dev/tty* > before.tty.list

if [ -z "$PS1" ]; then
    read -s -n1 -t 10 -p "Connect cable, press Enter: " keypress
    echo
else
    sleep 10
fi

\ls -1 /dev/tty* > after.tty.list

ftty=$(diff before.tty.list after.tty.list 2> /dev/null | grep '>' | sed 's/> //')
echo $ftty
rm -f before.tty.list after.tty.list
export MCPUTTY=$ftty                     # this will have no effect if running interactively 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T20:31:54.187

我已经使用此代码自动检测 linux 上的串行端口。它基于我在 MAVLINK 项目中找到的一些代码。

```
import fnmatch
import serial

def auto_detect_serial_unix(preferred_list=['*']):
    '''try to auto-detect serial ports on win32'''
    import glob
    glist = glob.glob('/dev/ttyUSB*') + glob.glob('/dev/ttyACM*')
    ret = []

    # try preferred ones first
    for d in glist:
        for preferred in preferred_list:
            if fnmatch.fnmatch(d, preferred):
                ret.append(d)
    if len(ret) > 0:
        return ret
    # now the rest
    for d in glist:
        ret.append(d)
    return ret

def main():
    available_ports = auto_detect_serial_unix()
    port = serial.Serial(available_ports[0], 115200,timeout=1)
    return 0

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T00:25:41.640

如果您想要一个纯 shell 解决方案，另一种解决方法是使用 'ls' 和 awk 的组合，我发现这对于各种利基应用程序都很方便。

首先插入你的 Arduino 并确保它在你这样做时显示出来

```
ls /dev/tty*

crw-rw---- 1 root dialout 166, 0 2012-10-16 18:37 /dev/ttyACM0 
```

我的 Arduino Uno 显示为 ttyACM*，因此我将命令修改为更具选择性，然后将输出通过管道传输到 awk，它可以很容易地打印空格分隔的字段。

```
ls /dev/ttyACM* | awk {'print $9'}

/dev/ttyACM0 
```

您仍然需要对最终输出做一些事情，例如将其导出以在 shell 中使用或发送到文件以供以后阅读。

# teamcity - 如果文件在 TFS/TeamCity 中包含 TODO，是否可以拒绝签入？

> ID：11364881
> 
> 赞同：0
> 
> 时间：2012-07-06T15:09:37.923
> 
> 标签：teamcity, todo

如果使用 TFS/TeamCity 签入包含 TODO（或某些字符串）的文件，是否可以拒绝签入文件或中断构建？

它需要忽略任何已经包含 TODO 的文件，并且只有在文件被更改然后签入时才会中断构建/拒绝签入。

当开发人员对包含 TODO 的文件进行更改时，这可用于强制处理现有的 TODO。

这可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:16:00.290

一种方法是使用自定义外汇警察规则。

1.  [创建自定义 FX Cop 规则](http://www.thescarms.com/dotnet/FxCop1.aspx)以在您的代码中查找 TODO。
2.  找到时在所有当前项目中启用此规则作为“错误”。
3.  构建解决方案。
4.  选择规则生成的所有代码分析警告并将它们添加到 GlobalSuppression.cs 文件中。
5.  签入上述更改。

现在，如果有人添加新的 TODO，他们将不得不禁止 FX Cop 规则才能构建代码 - 除非他们将其添加为禁止。

# c# - 解析 DataGridView - C#

> ID：11364883
> 
> 赞同：0
> 
> 时间：2012-07-06T15:09:40.837
> 
> 标签：c#, parsing, datagridview

我正在尝试用 C# 编写一个应用程序，它将分析两个不同的数据集并尝试找到它们之间的匹配项。我的问题是，对我来说，浏览数据行并从中提取数据的最佳方式是什么？

我需要提取具有多列的整行数据，并分析它们的相似之处。

最好的方法是将行放入字符串并解析它吗？

编辑：这是我用来将数据放入 DataGridView 的代码，它来自 excel 电子表格：

```
try
                {
                    OleDbConnectionStringBuilder connStringBuilder = new OleDbConnectionStringBuilder();
                    connStringBuilder.DataSource = file;
                    connStringBuilder.Provider = "Microsoft.Jet.OLEDB.4.0";
                    connStringBuilder.Add("Extended Properties", "Excel 8.0;HDR=NO;IMEX1");

                    DbProviderFactory factory = DbProviderFactories.GetFactory("System.Data.OleDb");

                    DbDataAdapter adapter = factory.CreateDataAdapter();

                    DbCommand selectCommand = factory.CreateCommand();
                    selectCommand.CommandText = "SELECT * FROM [All Carpets to Excel$]";

                    DbConnection connection = factory.CreateConnection();
                    connection.ConnectionString = connStringBuilder.ConnectionString;

                    selectCommand.Connection = connection;

                    adapter.SelectCommand = selectCommand;

                    data = new DataSet();

                    adapter.Fill(data);

                    dataGridView1.DataSource = data.Tables[0].DefaultView;

                }
                catch (IOException)
                {

                } 
```

我还没有尝试任何代码来分析和比较，但我首先需要知道访问数据和格式化数据的最佳方式是什么。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:39:31.487

我喜欢使用 List 对象，并使用 LINQ 来运行比较和运行查询。这是一个获取 DataSet（您的示例中的“数据”属性）并从中获取 DataTable 的示例。然后我遍历行和列并填充一个列表。最后一行只是对新列表使用 LINQ 查询的示例。

```
DataSet grid = new DataSet();
            DataTable table = grid.Tables[0];

            List<string> tableData = new List<string>();
            foreach (DataRow row in table.Rows)
            {
                for (int i = 0; i < table.Columns.Count; i++)
                {
                    tableData.Add(row[i].ToString());
                }
            }

            tableData.Where(x => x == "TestValue"); 
```

如果对此有任何疑问，请告诉我。

# vba - 文本到列正在获取对象'_global'的“方法'范围'失败”

> ID：11364892
> 
> 赞同：0
> 
> 时间：2012-07-06T15:09:52.063
> 
> 标签：vba, excel

我使用“文本到列”向导获取宏代码并将其放入我的代码中。但它并没有在一致的基础上工作。

我得到“对象'_global'的方法'范围'失败”（有时）我查了一下，并应用了解决方案，要么什么都没有改变（它在几次执行后出错）

当前试图更好地指定它的尝试给我留下了

```
With Shipping
.ActiveSheet.Columns(letter & ":" & letter).TextToColumns Destination:=Range(letter & "1"), DataType:=xlDelimited, _
    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _
    Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _
    :=Array(Array(1, 1), Array(2, 9), Array(3, 9), Array(4, 9)), TrailingMinusNumbers:= _
    True
End With 
```

我不知道它是否要我为前半部分或目的地指定更好，我找不到解决方案。

我该如何进行这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T17:10:28.723

而不是使用（例如）`.ActiveSheet.Columns("A:A")`为什么不使用更简单的形式`.ActiveSheet.Columns(1)`？

并在 Destination 参数之前添加一个句`Range`点，否则该范围将默认为活动工作表。

# java - JavaFX 2 多跨单元表，如 MS Excel

> ID：11364896
> 
> 赞同：0
> 
> 时间：2012-07-06T15:10:06.953
> 
> 标签：java, javafx-2

我希望有人能够帮助解决我的问题。我需要像 MS Excel 这样快速滚动的表格。我使用 JavaFX 2，找不到任何示例或解决方案。Swing 上有几个示例，但我确实需要 JavaFX 2。我已经测试过 TableView、GridPane，但它们在处理大量数据时运行速度非常慢。

```
 package test

    import javafx.stage.Stage
    import javafx.scene.{Group, Scene}
    import javafx.scene.control.cell.PropertyValueFactory
    import javafx.collections.{FXCollections}
    import javafx.application.Application
    import javafx.util.Callback
    import javafx.scene.control._
    import javafx.scene.layout.{GridPane}

   class TableTest extends Application {

  override def start(stage: Stage) = {

    val root = new Group
    val scene = new Scene(root, 1000, 700)
    val table = new TableView[Data]

    table.setPrefWidth(1000)
    table.setPrefHeight(700)

    val data = FXCollections.observableArrayList[Data]

    for(i <- 0 until 100) data.add(new Data)

    for(j <- 0 until 100) table.getColumns().add(createTextColumn(j.toString))

    table.setItems(data)

    root.getChildren().add(table)
    stage.setTitle("Table View Test JavaFX & Scala")
    stage.setWidth(1024)
    stage.setHeight(768)
    stage.setScene(scene)
    stage.show

  }

  def createTextColumn(index:String):TableColumn[Data, AnyRef] = {

    val activeCol = new TableColumn[Data, AnyRef](index)

    activeCol.setPrefWidth(128)

    activeCol.setCellValueFactory(new PropertyValueFactory[Data, AnyRef]("text"))

    val call = new Callback[TableColumn[Data, AnyRef], TableCell[Data, AnyRef]] {
      override def call(p1: TableColumn[Data, AnyRef]) : TableCell[Data, AnyRef] = {
        new TableCell[Data, AnyRef] {

          val grid = new GridPane
          val label = new Label
          grid.add(label, 0, 0)
          setGraphic(grid)

          override def updateItem(value: AnyRef, empty: Boolean) = {
            val row = getTableRow
            if (row != null && value != null) {
              label.setText(value.toString)
            }
          }
        }
      }
    }

    activeCol.setCellFactory(call)

    return activeCol
  }

}

package test

import javafx.beans.property.{SimpleLongProperty, SimpleStringProperty}

class Data {
  val text = new SimpleStringProperty("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean sit amet velit leo, in sodales lorem. Donec vel nisl tellus sed. ")
  def textProperty = text
  def getText : String = text.get
  def setText(value: String) = text.set(value)
} 
```

我用只有一个字符串（128 字节）的 Data 类测试了这段代码。但实际上应该比现在更多。所以，问题是：我可以使用 JavaFX 2 获得具有相同功能的 MS Excel 表吗？PS：我也用纯Java测试了这段代码，但得到了相同的结果:(

# iphone - 如何在 cocos2d 中获得粒子效果来跟随我的精灵？

> ID：11364901
> 
> 赞同：2
> 
> 时间：2012-07-06T15:10:29.337
> 
> 标签：iphone, ios5, cocos2d-iphone, sprite

我想要雪粒子效果跟随我的精灵，我尝试了一些方法，但最终发生的只是雪将保持静止而不是跟随。我做了这个教程（一找到它就会发布），它展示了它是如何用火来做的，但根本没有成功。任何教程或建议将不胜感激。我相信我必须在片段部分添加某种代码，其中显示在屏幕外创建敌人。

```
 [self schedule:@selector(gameLogicboss:) interval:180 ];        
      [self schedule:@selector(updateboss:)];                

 -(void)addTarget1 {

     Boss *target1 = nil;    

     if ((arc4random() % 2) == 0) {{
      target1 = [WeakAndFastBoss boss];
   }}  else {
     target1 = [WeakAndFastBoss boss];
      }                      

       // Determine where to spawn the target along the Y axis
      CGSize winSize = [[CCDirector sharedDirector] winSize];
     int minY = target1.contentSize.height/2;
    int maxY = winSize.height - target1.contentSize.height/2;
    int rangeY = maxY - minY;
    int actualY = (arc4random() % rangeY) + minY;

  // Create the target slightly off-screen along the right edge,
      // and along a random position along the Y axis as calculated above
    target1.position = ccp(winSize.width + (target1.contentSize.width/2), actualY);
     [self addChild:target1 ];

       // Determine speed of the target

       int minDuration = target1.minMoveDuration;
       int maxDuration = target1.maxMoveDuration;
         int rangeDuration = maxDuration - minDuration;
          int actualDuration = (arc4random() % rangeDuration) + minDuration;

           // Create the actions
                                                                                                 id actionMove = [CCMoveTo actionWithDuration:actualDuration      position:ccp(-target1.contentSize.width/2, actualY)];

  id actionMoveDone = [CCCallFuncN actionWithTarget:self 
                                     selector:@selector(spriteMoveFinished:)];
 [target1 runAction:[CCSequence actions:actionMove, actionMoveDone, nil]];
  target1.tag = 1;
     [_targets addObject:target1];   
       }

 -(void)gameLogicboss:(ccTime)dt {
 [self addTarget1];
   iterations_++;
       }

                - (void)updateboss:(ccTime)dt {
        CGRect projectileRect = CGRectMake(projectile.position.x -                  (projectile.contentSize.width/2), projectile.position.y - (projectile.contentSize.height/2),                           projectile.contentSize.width,                                   projectile.contentSize.height);

BOOL bossHit = FALSE;
NSMutableArray *targetsToDelete = [[NSMutableArray alloc] init];
for (CCSprite *target1 in _targets) {
    CGRect target1Rect = CGRectMake(target1.position.x - (target1.contentSize.width/2),                                        target1.position.y - (target1.contentSize.height/2),                                        target1.contentSize.width,                                  target1.contentSize.height);

    if (CGRectIntersectsRect(projectileRect, target1Rect)) {

        //[targetsToDelete addObject:target];   
        bossHit = TRUE;
        Boss *boss = (Boss *)target1;
        boss.hp--;
        if (boss.hp <= 0) {
            _score ++;
            [targetsToDelete addObject:target1];
        }
        break;

    }                       
}

for (CCSprite *target in targetsToDelete) {
    [_targets removeObject:target];
    [self removeChild:target cleanup:YES];                                  
    _projectilesDestroyed++;
    if (_projectilesDestroyed > 2) {

          } 
         }

if (bossHit) {
    //[projectilesToDelete addObject:projectile];
    [[SimpleAudioEngine sharedEngine] playEffect:@"explosion.caf"];
}
[targetsToDelete release];
 }

     -(void)spriteMoveFinishedboss:(id)sender {
       CCSprite *sprite = (CCSprite *)sender;
      [self removeChild:sprite cleanup:YES];
       GameOverScene *gameOverScene = [GameOverScene node];
         [gameOverScene.layer.label setString:@"You Lose"];
       [[CCDirector sharedDirector] replaceScene:gameOverScene];    

      if (sprite.tag == 1) { // target
[_targets removeObject:sprite];
      } else if (sprite.tag == 2) { // projectile
[_projectiles removeObject:sprite];
     }
     } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-13T05:24:26.563

I Have found this, at CCParticleSystem.h

```
/** @typedef tCCPositionType
 possible types of particle positions
 */
typedef enum {
    /** Living particles are attached to the world and are unaffected by emitter repositioning. */
    kCCPositionTypeFree,

```
/** Living particles are attached to the world but will follow the emitter repositioning.
 Use case: Attach an emitter to an sprite, and you want that the emitter follows the sprite.
 */
kCCPositionTypeRelative,

/** Living particles are attached to the emitter and are translated along with it. */
kCCPositionTypeGrouped, 
```

 `you should set it like 

myparticleSystem.positionType=kCCPositionTypeGrouped;` 
```

 `Hope it helps.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-22T05:09:07.430

您不需要使用精灵更新粒子发射器的位置。您可以将粒子系统作为孩子添加到精灵。粒子系统确实需要这样输入：

```
 CCParticleSystem * booster = [CCParticleSystem particleWithFile:@"boosterParticles.plist"];
    //customize your particles' options

    //assuming you have a sprite defined as _motherShip
    [_motherShip addChild:booster];

    /*
     * now that the particles are the _motherShip's child, you must remember 
     * to set the position relative to the mothership's origin...
     */
    particles.position = ccp(15,0); 
```

...所以现在每当 _motherShip.position 发生变化时，助推器就会随之而来。它甚至会随船旋转。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T10:33:15.847

非常简单的逻辑，无需进入代码：

我生成一个精灵并给它一个位置（x，y）。对于每个精灵，我还生成一个 CCParticleSystem，为其提供所需的粒子类型、生成速率等。CCParticleSystem 位置现在设置为与精灵相同的 (x,y) 位置，并且它应该更新为精灵的 ( x,y) 位置已更新。

随着精灵和 CCParticleSystem 的移动，这个位置 (x, y) 会在您的调度方法中按照间隔步骤时间不断地随机更新。

希望这是有道理的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-27T23:49:59.657

您是否尝试利用更新方法更新您的粒子位置？

我在我的一个游戏中做了类似以下几行的事情，它的工作方式和我想的一样

```
    -（无效）更新：（CCTime）增量{

        _sprite.position = CGPointMake(newXPosition, newYPosition);

        _fire.position = CGPointMake(_sprite.position.x, _sprite.position.y);

    }

```

我希望它有帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-10T11:46:39.823

我这样做

```
vehicleParticleSystem = [CCParticleSystemQuad particleWithFile:@"vehicleParticle.plist"];
vehicleParticleSystem.position = ccp(_ship.position.x - _ship.contentSize.width/3, _ship.position.y - _ship.contentSize.height/3);
if (UI_USER_INTERFACE_IDIOM() != UIUserInterfaceIdiomPad) {
    vehicleParticleSystem.scale = 0.5;
}
[self addChild:vehicleParticleSystem z:-1]; 
```

并以此更新其位置

```
- (void) updateParticleSystem:(ccTime)dt {
vehicleParticleSystem.position = ccp(_ship.position.x - _ship.contentSize.width/3, _ship.position.y - _ship.contentSize.height/3);
} 
```

在`-(void) update:(ccTime)dt`方法中调用。

船由用户通过手柄移动。

希望这可以帮助。粒子的位置稍微在车辆后面以获得引擎效果。`

# c# - 将服务器控件添加到没有表单的页面

> ID：11364902
> 
> 赞同：0
> 
> 时间：2012-07-06T15:10:35.183
> 
> 标签：c#, asp.net, ajax

我有一个具有以下结构的页面

```
<form runat="server"><placeholder></placeholder></form> 
```

我有一个添加到占位符的控制调用“feed”。添加的控件包含多个称为“产品”的其他控件。

我使用 ajax 将产品动态加载到提要中。

问题是，产品控件中的标记包含需要带有 runat=server 的表单标记的服务器端按钮。否则页面将无法编译。

一旦我将必要的表单标签添加到“产品”控件，该页面就可以正常编译。这并不令人满意，因为我不希望页面上同时出现多个表单标签。

有没有办法解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:15:12.887

您可以添加一个`<form runat=server>`包含所有服务器控件的单个控件，也可以不使用服务器控件（普通 html 标记）。

或者，使用更灵活的框架，如 MVC，让您完全控制您的标记。

# css - 使用 CSS3 创建这个形状

> ID：11364911
> 
> 赞同：4
> 
> 时间：2012-07-06T15:11:22.593
> 
> 标签：css, css-shapes

我想只使用 css 创建这个形状。我很确定这是可以做到的。但是我在涉及渐变时遇到了麻烦。

这个形状里面会包含一些文字。建议的 html 标记是：

```
<div class="container">
    ... more html contents...
</div> 
```

![要创建的形状](../Images/52fb3f455e1c69b2c51d5940d091c676.png)

一个[jsFiddle](http://jsfiddle.net/)将不胜感激。
提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-06T15:29:30.660

试试这个，[http://jsfiddle.net/HshfF/1/](http://jsfiddle.net/HshfF/1/)

**CSS：（来自**[此评论](https://stackoverflow.com/questions/11364911/create-this-shape-using-css3?rq=1#comment14973839_11365210)中的小提琴）

```
.main {
    background: -moz-linear-gradient(top, #ffffff 0%, #e8e8e8 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#e8e8e8)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #ffffff 0%,#e8e8e8 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #ffffff 0%,#e8e8e8 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, #ffffff 0%,#e8e8e8 100%); /* IE10+ */
    background: linear-gradient(to bottom, #ffffff 0%,#e8e8e8 100%); /* W3C */
    position: relative;
    width: 150px;
    height: 100px;
    margin: 10px;
    border: 1px solid #d0d0d0;
    border-radius: 10px;
    padding: 20px;
}

.main:before {
    content: '';
    display: block;
    top: -1px;
    right: -1px;
    width: 20px;
    height: 20px;
    background: -moz-linear-gradient(top, #ffffff 0%, #e8e8e8 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#e8e8e8)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #ffffff 0%,#e8e8e8 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #ffffff 0%,#e8e8e8 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, #ffffff 0%,#e8e8e8 100%); /* IE10+ */
    background: linear-gradient(to bottom, #ffffff 0%,#e8e8e8 100%); /* W3C */
    position: absolute;
    border-radius: 0 0 0 5px;
    border-left: 1px solid #d0d0d0;
    border-bottom: 1px solid #d0d0d0;
}

.main:after {
    content: '';
    display: block;
    position: absolute;
    top: -1px;
    right: -1px;
    border-top: 20px solid #fff; 
    border-left: 20px solid transparent;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T15:16:25.247

请学习 CSS3，试试 Nicholas Gallagher 教程，他有一些最好的 css3 教程：你正在寻找的一个[http://nicolasgallagher.com/pure-css-folded-corner-effect/demo/](http://nicolasgallagher.com/pure-css-folded-corner-effect/demo/)

你寻找的阴影和颜色我认为你需要自己做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T15:46:20.893

几乎有这个：http: [//jsfiddle.net/Grezzo/52zG7/](http://jsfiddle.net/Grezzo/52zG7/)

你只需要一个 div （感谢伪元素），但我还没有“切入”角落。

# visual-studio-2010 - 实例化 ProjectTemplates 时项目引用未链接

> ID：11364917
> 
> 赞同：1
> 
> 时间：2012-07-06T15:11:39.217
> 
> 标签：visual-studio-2010, visual-studio

我正在尝试创建一个包含一个解决方案和两个项目的 Visual Studio 项目模板。第一个项目 ProjectA 需要对第二个项目 ProjectB 的引用。我发现我需要将标签添加到 ProjectA 的 ProjectTemplate.csproj 中。但是，它添加了引用，但没有将其链接起来。换句话说，它上面有黄色标志，就像缺少参考一样。我假设我的路径是正确的，因为故意不正确的路径引用根本不会出现。任何帮助将不胜感激。

# arrays - 查找每个值最后出现的索引

> ID：11364920
> 
> 赞同：3
> 
> 时间：2012-07-06T15:11:44.340
> 
> 标签：arrays, matlab, vector

我有一个这样的向量：

```
>> v = [1 1 1 2 2 3 4 4 4 4 4 5 5]'

v =

     1
     1
     1
     2
     2
     3
     4
     4
     4
     4
     4
     5
     5 
```

向量已排序。每个值可以有任意数量。我需要找到每个值最后出现的索引。在这种情况下，它会返回这个：

```
answer =

     3    % index of the last occurence of "1"
     5    % index of the last occurence of "2"
     6    % index of the last occurence of "3"
    11    % index of the last occurence of "4"
    13    % index of the last occurence of "5" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T16:16:28.460

感谢@trumpetlicks，答案是`unique`。

```
>> v = [1 1 1 2 2 3 4 4 4 4 4 5 5 6]'

v =

     1
     1
     1
     2
     2
     3
     4
     4
     4
     4
     4
     5
     5
     6

>> [~, answer] = unique(v)

answer =

     3
     5
     6
    11
    13
    14 
```

[编辑] 在 MCR 的更新版本（R2013 ？）中， 的行为发生`unique`了变化。要获得相同的结果，您必须使用`unique(v, 'legacy');`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-06T18:20:10.303

```
v = [1 1 1 2 2 3 4 4 4 4 4 5 5];
find(v==1,1,'last')
 % returns ans = 3
find(v==2,1,'last')
 % returns ans = 5 
```

1 给出了你想要返回的出现次数，`'first'`或者`'last'`可以指定

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T15:18:32.457

尝试这个

```
[find(diff(v')) length(v)] 
```

你应该能够自己弄清楚。

# xbox360 - ICommand 不会触发

> ID：11364927
> 
> 赞同：0
> 
> 时间：2012-07-06T15:12:06.650
> 
> 标签：xbox360, icommand

除非我将 DataContext 字段移动到 Button 的 DataTemplate (contlisttemplate) 中，否则我的 ICommand 不会触发。我在样式资源中设置了图像，只要将 DataContext 字段移动到 DataTemplate 中，这些图像就会消失。图像和 ICommand 都应该使用相同的 DataContext，所以我不确定它为什么不起作用。

下面是我的代码片段。

```
DataContext="{Binding LongListViewModel, Source={StaticResource viewModelLocator}}" 
```

* * *

```
<i:Interaction.Behaviors>
    <GamePad:XboxBehavior StartFocusControlName="continuousList1" IsTopLevelViewForFocus="True"/>
</i:Interaction.Behaviors>

<UserControl.Resources>
    <DataTemplate x:Key="contlisttemplate" >
        <Button  
            Command="{Binding Gotodetailpage}"
            Style="{StaticResource custherotile}">
        </Button> 
    </DataTemplate>
</UserControl.Resources>

<Grid x:Name="LayoutRoot">
    <Grid.ColumnDefinitions>
        <ColumnDefinition/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition/>
    </Grid.RowDefinitions>

    <xbox:ContinuousList 
        HorizontalAlignment="Left" 
        Name="continuousList1" 
        VerticalAlignment="Top"                      
        ItemTemplate="{StaticResource contlisttemplate}"
        ItemsSource="{Binding LongListItems}" Height="316" Width="1280"
        Grid.Row="1"
        >

        <i:Interaction.Behaviors>
            <GamePad:XboxBehavior IsContinuousListVuiEnabled="True" HasFocusRetention="True"/>
        </i:Interaction.Behaviors>

    </xbox:ContinuousList> 
```

* * *

```
public class LongListViewModel : ViewModelBase<LongListViewModel>
{
    private readonly IDialogService dialogService;
    public Navigateto compass = new Navigateto();

    public LongListViewModel()
    {
        LongListItems = new ObservableCollection<object>();
        dictionaryListwithkey = new Dictionary<string, object>();
        Gotodetailpage = new RelayCommand(PerformGotoDetailPage);
    }

    public LongListViewModel(IDialogService dialogService)
        : this()
    {
        this.dialogService = dialogService;
    }

    public Program getherovideo
    {
        get { return (Program)LongListItems[0]; }
        set
        {
            //SetProperty(ref currentVideo, value,x => x.CurrentVideo);
        }
    }

    public ObservableCollection<object> LongListItems
    {
        get;
        set;
    }

    public Dictionary<string, object> dictionaryListwithkey
    {
        get;
        set;
    }

    public ICommand Gotodetailpage { get; private set; }

    private void PerformGotoDetailPage()
    {
       // Console.WriteLine("List item clicked");
        compass.goToDetailsPageWithPath("89");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T16:25:56.927

万一有人想知道答案是什么。根据 Aaron Hill ATG ：

这看起来像是一个范围问题。外部 DataContext 是您的 LongListViewModel 类，其中包含所需的 ICommand，但容器的 ItemsSource 设置为视图模型公开的 LongListItems 集合。这意味着 DataTemplate 的有效 DataContext 是集合的单个成员，而不是整个视图模型。

覆盖 DataTemplate 的 DataContext 将使您指向视图模型并访问 ICommand，但这也意味着您丢失了 LongListItems 集合的各个元素中存在的任何数据。这可能就是为什么图像在这种情况下不再起作用的原因。

由于集合中的每个项目都有自己的按钮，因此将 ICommand 属性公开在单个项目而不是视图模型上可能是有意义的。

# wix - 为什么我的驾照没有显示？

> ID：11364935
> 
> 赞同：12
> 
> 时间：2012-07-06T15:12:27.493
> 
> 标签：wix, rtf

在我的`<Product>`我有：

```
<WixVariable Id="WixUILicenseRtf" Value="LICENSE.rtf" /> 
```

`LICENSE.rtf`存在，并且是一个 rtf 文件（我尝试使用几个不同的程序保存，以防其中一个出现问题）。

该文件包含文本（完整的许可证！），并且文本的格式合理。

那么，为什么我的安装程序的许可证字段是空白的？

![在此处输入图像描述](../Images/1dede0feb1ea6f2b77065cf9b7c01bcf.png)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-06T15:33:44.107

事实证明，您基本上*必须*使用写字板生成您的 rtf，或者制作一个完美的副本。由于我的脚本是由脚本生成的，因此我调整了脚本以将写字板标题插入到 rtf 文件中，这修复了它。

# java - java服务器和一个客户端之间的多个连接

> ID：11364938
> 
> 赞同：-2
> 
> 时间：2012-07-06T15:12:41.057
> 
> 标签：java, networking

我正在尝试像 Skype-in​​stant messager 一样制作，我的想法是拥有一台服务器来处理客户端的多个连接。我现在拥有的是朋友列表等，但现在我想为服务器和客户端创建线程来处理对话。问题是每次对话我都需要在服务器和一个客户端之间建立多个连接（我认为）。但我不认为这是可能的。是否有人有另一种方法可以做到这一点，或者可能有一种方法可以在服务器和客户端之间建立多个连接？

谢谢你的协助

PS：英语不是我的主要语言，所以请原谅我的语法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T16:03:19.653

我认为最好的方法是您始终从每个客户端到服务器建立一个 tcp 连接，这样如果您的客户端位于防火墙或路由器后面，则无论如何都可以建立连接。

然后你需要定义一个带有控制消息的协议，比如“create new conversation with ...”。服务器可以为每个新会话生成一个 guid，然后客户端可以通过一个连接始终接收和发送带有会话 id 的消息。

**更新：**

回答最初的问题：是的，您可以在客户端和服务器之间建立多个连接。每个连接都应该打开从客户端到服务器的端口，一旦建立，每个连接都会有不同的端口。您可以创建一个线程来处理每个连接，或者让线程使用非阻塞调用来处理所有连接。

# css - 当我有一个字段集时，div 高度不会扩大

> ID：11364940
> 
> 赞同：1
> 
> 时间：2012-07-06T15:12:50.340
> 
> 标签：css, html, height, fieldset

我有一个扩展至其内容高度的 div。如果我只放段落（

) 或里面的表，但是当我放置一个字段集时，它不会扩展到它的高度。

我用 jsfiddle 做了一个例子[http://jsfiddle.net/33hgK/4/](http://jsfiddle.net/33hgK/4/)。还有其他人有这个问题吗？

我很感激我收到的任何答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:14:51.530

删除浮动：左；来自字段集#infofields

[http://jsfiddle.net/33hgK/5/](http://jsfiddle.net/33hgK/5/)

# r - 根据条件计算数据框中的值

> ID：11364941
> 
> 赞同：0
> 
> 时间：2012-07-06T15:12:52.570
> 
> 标签：r

我一直在四处寻找，我无法弄清楚如何总结我的数据框中的数据（受某些范围的影响）。我知道在应用 daaply/taaply 或 table 的某种组合时可以做到这一点，但我无法得到我期望的确切结果。

基本上我想把这个：

```
part_no val1 val2 val3
2 1 2 3 45.3
2 1 3 4 -12.3
3 1 3 4 99.3
3 1 5 2 -3.2
3 1 4 3 -55.3 
```

进入这个：

```
part_no val3_between0_50 val3_bw50_100 val3_bw-50_0 val3_bw-100_-50
2 1 0 0 1 0
3 0 1 0 1 1 
```

这是虚拟数据，我有更多的行，但想法是一样的。我只想计算满足特定条件的参与者的值的数量。

如果有人可以逐步解释它，我将不胜感激。我看到很多不同的小帖子，但没有一个能做到这一点，我的尝试只让我成功了一半。比如使用`table`等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T17:24:24.767

下一个更好的解决方案（不需要下面使用的额外行，尽管如果您想将重命名代码移动到此矩阵结果，您可以）：

```
xtabs(~part_no +cut(val4, breaks=c(-100, -50, 0, 50, 100) ), dat=dat)
 #-------------
       cut(val4, breaks = c(-100, -50, 0, 50, 100))
part_no (-100,-50] (-50,0] (0,50] (50,100]
      2          0       1      1        0
      3          1       1      0        1 
```

* * *

第一次尝试： .... n 到一个稍微不同的问题，很容易适应你的情况。我遇到的困难是我的解决方案要求 part_no 以 1 开头。我想你可以稍后分配行标签。或者将“part_no”作为一个因子并使用它的数值模式值。

```
 dat <- read.table(text="part_no val1 val2 val3 val4
 1 1 2 3 -32
 2 1 2 3 45.3
 2 1 3 4 -12.3
 3 1 3 4 99.3
 3 1 5 2 -3.2
 3 1 4 3 -55.3
 ", head=T)

levs= 4; recs <- matrix( c(unique(dat$part_no), 
                           rep(0, levs*length(unique(dat$part_no))) ), 
                        nrow=length(unique(dat$part_no)) )
 recs[ cbind( dat$part_no, 
              1+ findInterval(dat$val4, c(-100, -50, 0, 50, 100) ) )] <- 1
 recs
#------------------------------------
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    0    1    0    0
[2,]    2    0    1    1    0
[3,]    3    1    1    0    1
#------------------------------------
 colnames(recs) <- c(names(dat)[1] , 
                     paste("val_btwn", 
                            c(-100, -50, 0, 50, 100)[1:4], 
                            c(-100, -50, 0, 50, 100)[2:5], 
                            sep="_") )
 recs
#------------------------------------
     part_no val_btwn_-100_-50 val_btwn_-50_0 val_btwn_0_50 val_btwn_50_100
[1,]       1                 0              1             0               0
[2,]       2                 0              1             1               0
[3,]       3                 1              1             0               1 
```

现在我认为我可能会使用`cut`下`xtabs`一次。事实上它工作得很好，我要把它贴在上面。

# java - 从 Java 客户端到 Grails Web 应用程序的可恢复上传？

> ID：11364942
> 
> 赞同：0
> 
> 时间：2012-07-06T15:12:54.717
> 
> 标签：java, grails, upload, inputstream, resume-upload

经过近 2 个工作日的谷歌搜索并尝试了我在整个网络上找到的几种不同的可能性，我在这里提出这个问题，希望我最终能得到答案。

## 首先，这**就是我想要做**的：

我正在开发一个客户端和一个服务器应用程序，目的是在单个服务器上的多个客户端之间交换大量*大文件。*客户端使用纯**Java** (JDK 1.6) 开发，而 Web 应用程序使用**Grails** (2.0.0) 完成。

由于客户端的目的是允许用户交换大量大文件（通常每个大约 2GB），我必须以某种方式实现它，以便上传**可恢复**，即用户能够停止和恢复上传随时。

### 这**是我**到目前为止所做的：

我实际上设法做我想做的事情并将大文件流式传输到服务器，同时仍然能够使用原始套接字暂停和恢复上传。我会向服务器发送一个常规请求（使用 Apache 的 HttpClient 库），让服务器向我发送一个可供我免费使用的端口，然后在服务器上打开一个 ServerSocket 并从客户端连接到该特定套接字。

### 这是**问题所在**：

实际上，这至少存在两个问题：

1.  我自己打开这些端口，所以我必须自己管理打开和使用的端口。这是相当容易出错的。
2.  我实际上绕过了 Grails 管理大量（并发）连接的能力。

## 最后，这**是我现在应该做的事情和问题**：

由于我上面提到的问题是不可接受的，我现在应该使用 Java 的 URLConnection/HttpURLConnection 类，同时仍然坚持使用 Grails。

连接到服务器并发送简单的请求完全没有问题，一切正常。当我尝试使用流（客户端中的连接的 OutputStream 和服务器中的请求的 InputStream）时，问题就开始了。打开客户端的 OutputStream 并向其写入数据非常简单。但是从请求的 InputStream 中读取对我来说似乎是不可能的，因为它看起来**总是空的。**

## 示例代码

**这是服务器端**（Groovy 控制器）的示例：

```
def test() {
    InputStream inStream = request.inputStream

    if(inStream != null) {
        int read = 0;
        byte[] buffer = new byte[4096];
        long total = 0;

        println "Start reading"

        while((read = inStream.read(buffer)) != -1) {
            println "Read " + read + " bytes from input stream buffer"      //<-- this is NEVER called
        }       

        println "Reading finished"
        println "Read a total of " + total + " bytes"   // <-- 'total' will always be 0 (zero)
    } else {
        println "Input Stream is null"      // <-- This is NEVER called
    }
} 
```

这是我在**客户端**（Java 类）所做的：

```
public void connect() {
    final URL url = new URL("myserveraddress");
    final byte[] message = "someMessage".getBytes();        // Any byte[] - will be a file one day
    HttpURLConnection connection = url.openConnection();
    connection.setRequestMethod("GET");                     // other methods - same result

    // Write message 
    DataOutputStream out = new DataOutputStream(connection.getOutputStream());
    out.writeBytes(message);
    out.flush();
    out.close();

    // Actually connect
    connection.connect();                                   // is this placed correctly?

    // Get response
    BufferedReader in = new BufferedReader(new InputStreamReader(connection.getInputStream()));

    String line = null;
    while((line = in.readLine()) != null) {
        System.out.println(line);                   // Prints the whole server response as expected
    }

    in.close();
} 
```

正如我所提到的，问题在于它`request.inputStream`总是产生一个空的 InputStream，所以我永远无法从中读取任何内容（当然）。但这正是我想要做的（所以我可以流式传输要上传到服务器的文件，从 InputStream 中读取并将其保存到文件中），这相当令人失望。

我尝试了**不同的 HTTP 方法**，**不同的数据负载**，还一遍遍地重新排列代码，但似乎无法解决问题。

## 我希望找到什么

当然，我希望找到解决我的问题的方法。任何东西都会受到高度赞赏：提示、代码片段、库建议等等。也许我什至都错了，需要朝着完全不同的方向前进。

那么，如何在不手动打开服务器端端口的情况下实现从 Java 客户端到 Grails Web 应用程序的相当大（二进制）文件的可恢复文件上传？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:36:31.987

HTTP GET 方法具有用于范围检索的特殊标头：[http](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35) ://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35大多数下载者使用它从服务器进行可恢复下载。

据我了解，没有将此标头用于 POST/PUT 请求的标准做法，但这取决于您，对吗？您可以制作非常标准的 Grails 控制器，它将接受标准的 http 上传，标头如`Range: bytes=500-999`. 控制器应该将这 500 个从客户端上传的字节放入文件中，从位置 500 开始

在这种情况下，您不需要打开任何套接字，并制定自己的协议等。

PS 500 字节只是一个示例，可能您使用的是更大的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-19T13:09:39.287

**客户端Java编程：**

```
 public class NonFormFileUploader {
    static final String UPLOAD_URL= "http://localhost:8080/v2/mobileApp/fileUploadForEOL";

    static final int BUFFER_SIZE = 4096;

    public static void main(String[] args) throws IOException {
        // takes file path from first program's argument
        String filePath = "G:/study/GettingStartedwithGrailsFinalInfoQ.pdf";
        File uploadFile = new File(filePath);

        System.out.println("File to upload: " + filePath);

        // creates a HTTP connection
        URL url = new URL(UPLOAD_URL);
        HttpURLConnection httpConn = (HttpURLConnection) url.openConnection();
        httpConn.setDoOutput(true);
        httpConn.setRequestMethod("POST");
        // sets file name as a HTTP header
        httpConn.setRequestProperty("fileName", uploadFile.getName());

        // opens output stream of the HTTP connection for writing data
        OutputStream outputStream = httpConn.getOutputStream();

        // Opens input stream of the file for reading data
        FileInputStream inputStream = new FileInputStream(uploadFile);

        byte[] buffer = new byte[BUFFER_SIZE];
        int bytesRead = -1;

        while ((bytesRead = inputStream.read(buffer)) != -1) {
            System.out.println("bytesRead:"+bytesRead);
            outputStream.write(buffer, 0, bytesRead);
            outputStream.flush();
        }

        System.out.println("Data was written.");
        outputStream.flush();
        outputStream.close();
        inputStream.close();

        int responseCode = httpConn.getResponseCode();
        if (responseCode == HttpURLConnection.HTTP_OK) {
            // reads server's response
            BufferedReader reader = new BufferedReader(new InputStreamReader(
                    httpConn.getInputStream()));
            String response = reader.readLine();
            System.out.println("Server's response: " + response);
        } else {
            System.out.println("Server returned non-OK code: " + responseCode);
        }
    }
 } 
```

**服务器端 Grails 程序：**

*控制器内部：*

```
def fileUploadForEOL(){
    def result
    try{
        result = mobileAppService.fileUploadForEOL(request);
    }catch(Exception e){
        log.error "Exception in fileUploadForEOL service",e
    }
    render result as JSON
} 
```

*服务类内部：*

```
 def fileUploadForEOL(request){
    def status = false;
    int code = 500
    def map = [:]
    try{
    String fileName = request.getHeader("fileName");
    File saveFile = new File(SAVE_DIR + fileName);

    System.out.println("===== Begin headers =====");
    Enumeration<String> names = request.getHeaderNames();
    while (names.hasMoreElements()) {
        String headerName = names.nextElement();
        System.out.println(headerName + " = " + request.getHeader(headerName));        
    }
    System.out.println("===== End headers =====\n");

    // opens input stream of the request for reading data
    InputStream inputStream = request.getInputStream();

    // opens an output stream for writing file
    FileOutputStream outputStream = new FileOutputStream(saveFile);

    byte[] buffer = new byte[BUFFER_SIZE];
    int bytesRead = inputStream.read(buffer);

    long count =  bytesRead

    while(bytesRead != -1) {
        outputStream.write(buffer, 0, bytesRead);
      bytesRead = inputStream.read(buffer);
      count += bytesRead
    }
     println "count:"+count
    System.out.println("Data received.");
    outputStream.close();
    inputStream.close();

    System.out.println("File written to: " + saveFile.getAbsolutePath());

    code = 200

    }catch(Exception e){
        mLogger.log(java.util.logging.Level.SEVERE,"Exception in fileUploadForEOL",e);
    }finally{
        map <<["code":code]
    }
    return map
} 
```

我已经尝试使用上面的代码，它对我有用（仅适用于文件大小 3 到 4MB，但对于小文件，一些字节的代码丢失或什至没有出现，但在请求标头内容长度即将到来，不知道为什么会发生.)

# java - Java - 在同一连接上执行 http 请求 POST 和 GET

> ID：11364946
> 
> 赞同：0
> 
> 时间：2012-07-06T15:13:30.693
> 
> 标签：java, httpurlconnection, http-request

我有一些我正在努力实现的目标。

我在 localhost 的 8080 端口上运行了一个 Web 应用程序。

我有一个在 localhost:9005 上运行的 HTTP 服务器。

我有一个将信息传递给 servlet java 类的 JSP 表单，该类又使用数据字符串向 HTTP 服务器 localhost:9010 上的 URL 执行 HTTP 发布。

我需要做的是将 POST 和 GET 作为同一连接的一部分执行。我让它们作为两个单独的呼叫工作，但不在同一个连接上。它必须是相同的连接，当我发布数据时，HTTP 服务器获取此数据，处理它并将唯一数据输出到此 URL。因此，GET 需要与他 POST 属于同一连接的一部分。

有人可以帮忙吗？

这是我的流程请求 java 代码：

```
 import java.net.HttpURLConnection;
    import java.net.MalformedURLException;
    import java.net.URL;
    import java.net.URLEncoder;
    import java.io.BufferedReader;
    import java.io.InputStreamReader;
    import java.io.IOException;
    import java.io.OutputStreamWriter;
    import java.io.UnsupportedEncodingException;
    import javax.servlet.*;
    import javax.servlet.http.*;

    import java.util.List; 
    import java.util.Map.Entry; 

    public class ProcessRequest {

        public void sendRequestToGateway() throws Throwable{

            String message = URLEncoder.encode("OP1387927", "UTF-8");    

            try {           
                URL url = new URL("http://localhost:9005/json");            
                HttpURLConnection connection = (HttpURLConnection) url.openConnection();            
                connection.setDoOutput(true);            
                connection.setRequestMethod("POST");            
                OutputStreamWriter writer = new OutputStreamWriter(connection.getOutputStream());           
                writer.write("operator=" + message);       
                writer.close();   

                System.out.println("connection.getResponseCode() : " + connection.getResponseCode());
                System.out.println("connection.getResponseMessage()" + connection.getResponseMessage());

                if (connection.getResponseCode() == HttpURLConnection.HTTP_OK) { 

                    receiveMessageFromGateway();

                } else {                
                    // Server returned HTTP error code.            
                }   

                //receiveMessageFromGateway();

            } catch (MalformedURLException e) {            
                // ...        
            } catch (IOException e) {           
                    // ...        
            }
        }

        public void receiveMessageFromGateway()  throws Throwable { 

            HttpURLConnection client = null; 
            OutputStreamWriter wr = null; 
            BufferedReader rd = null; 
            StringBuilder sb = null; 
            String line = null; 

            try { 

              URL url = new URL("http://localhost:9005/json"); 
              client = (HttpURLConnection) url.openConnection(); 
              client.setRequestMethod("GET"); 
              client.setDoOutput(true); 
              client.setReadTimeout(10000); 

              client.connect(); 
              System.out.println(" *** headers ***"); 
              for (Entry<String, List<String>> headernew : client.getHeaderFields().entrySet()) { 
                System.out.println(headernew.getKey() + "=" + headernew.getValue()); 
              } 

              System.out.println(" \n\n*** Body ***"); 
              rd = new BufferedReader(new InputStreamReader(client.getInputStream())); 
              sb = new StringBuilder(); 

              while ((line = rd.readLine()) != null) { 
                sb.append(line + '\n'); 
              } 

              System.out.println("body=" + sb.toString()); 

            } finally { 
              client.disconnect(); 
              rd = null; 
              sb = null; 
              wr = null; 
            } 
         }  

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T15:18:22.880

为什么不直接返回原始 POST 的结果？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:17:47.367

通常，您无法使用`HttpUrlConnection`. 您也许可以将您的连接投射到特定的实现类并对其进行干扰，但这是一种非常不稳定的做法。

考虑到要求，Apache HttpClient 可能是更好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-14T14:10:11.723

您可以为此使用 Apache HTTP 客户端。它非常简单。

如果您使用的是 maven，只需将以下行添加到您的 POM 文件中：

```
<dependency>
    <groupId>org.apache.httpcomponents</groupId>
    <artifactId>httpclient</artifactId>
    <version>4.3.3</version>
</dependency> 
```

在这个例子中，我提交了一个 POST 请求，然后是一个 GET 请求。

看一看：

```
public static String get(String p_url) throws IOException
{       

        CloseableHttpClient httpclient = HttpClients.createDefault();

        // First request: POST
        HttpPost httpPost = new HttpPost("http://the-api-url.com/Login/Auth&token=12345"));
        CloseableHttpResponse response_post = httpclient.execute(httpPost);                 
        System.out.println(response_post.getStatusLine());          
        HttpEntity entity_post = response_post.getEntity();         
        System.out.println(EntityUtils.toString(entity_post));

        // Second request: GET
        HttpGet httpGet = new HttpGet(p_url);
        CloseableHttpResponse response_get = httpclient.execute(httpGet);  
        System.out.println(response_get.getStatusLine());           
        HttpEntity entity_get = response_get.getEntity();           
        System.out.println(EntityUtils.toString(entity_get));

        response_post.close();
        response_get.close();           
        return EntityUtils.toString(entity_get);             
    } 
```

# html - 带有标签的链接？

> ID：11364950
> 
> 赞同：-3
> 
> 时间：2012-07-06T15:13:34.890
> 
> 标签：html

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:17:59.510

“data-description”属性是根据定义，没有任何通用语义含义（任何以“data-”开头的属性）。某些 JavaScript 库可能会使用它来添加工具提示，但唯一的内置浏览器工具提示是您的示例未使用的“标题”属性（并且不支持 HTML，仅支持文本）。您需要使用一些库，例如[http://docs.jquery.com/Plugins/Tooltip](http://docs.jquery.com/Plugins/Tooltip)

# data-binding - 将 xml 模式的实例加载到 BRE 中以作为事实引用

> ID：11364952
> 
> 赞同：1
> 
> 时间：2012-07-06T15:13:45.143
> 
> 标签：data-binding, xsd, loading, rule-engine, nxbre

所以我一直在研究很多规则引擎软件，我想做的一件事要么真的很不方便，要么我只是不理解文档（很可能）。

基本上，我希望规则引擎可以访问 xml 模式的实例，或者作为事实库、规则库（不太可能），或者至少作为某种对象，可以将其值替换为规则中的变量合理比较的基础。我专门研究 NxBRE，但我没有嫁给任何一个 BRE，所以如果你用不同的软件实现了这一点，我也愿意接受。

我的问题是，你认为这可能吗？我看过的大部分内容都表明我必须以引擎使用的任何规则/事实格式加载信息（经常吹嘘如何从任何 uri 加载这些信息，这与我无关），但是是否有软件可以将始终基于唯一模式的 xml 文件转换为引擎读取格式的一系列相应事实？如果我不清楚我在问什么，我可以试着澄清一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T07:30:30.843

*（[来自SF.net的交叉发布](https://sourceforge.net/projects/nxbre/forums/forum/339175/topic/5410953/index/page/1)）*

要从自定义 XML 文档加载 Flow Engine 的上下文对象，唯一的选择是自己加载 XML，并在加载规则文件 (xBRE) 后以编程方式将对象一一添加到上下文中。

使用推理引擎，您有更多选择：

*   从您的主应用程序中一一添加事实，
*   创建一个在您的应用程序和 NxBRE 之间的边界处执行相同操作的活页夹，
*   XSLT 将您的自定义 XML 转换为 RuleML 事实，并在加载规则库后将这些事实加载到引擎中。

# javascript - 如何在移动屏幕上居中“获取数据”

> ID：11364959
> 
> 赞同：1
> 
> 时间：2012-07-06T15:14:15.010
> 
> 标签：javascript, html, mobile, mobile-safari

在为许多浏览器、移动和桌面开发网站时，我注意到以下 CSS 可以很好地使加载 div 居中。

```
img.loading1 {
    position:absolute;
    left:50%;
    margin-left:-16px;
    top:50%;
    margin-top:-16px;
    z-index:10
}
.loading2 {
    color:#006BB2;
    position:absolute;
    left:50%;
    margin-left:0px;
    top:40%;
    z-index:5
}
.loading3 {
    position:absolute;
    width:100%;
    height:100%;
    left:0;
    top:0;
    background-color:lightgrey;
    opacity:0.85
} 
```

```
<div id="container" style="position:relative">
    ...content ommitted...
    <div id="loading" style="display:none">
        <div class="loading3"></div>
        <img class="loading1" src="images/loader-ajax.gif" width="32" height="32">
        <span class="loading2" id="getting">Getting your request...</span>
    </div>
    ...content ommitted... 
```

div 的显示设置为“阻止”，3 个项目居中。

但是，在移动屏幕上，虽然水平是正确的，但垂直位置可能会在屏幕外，具体取决于“包含”div 的高度。

是否可以使用 Javascript 找到屏幕的中心并定位图像并跨越那里？

**编辑 1：**加载 div 的高度是否必须设置为屏幕高度才能正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T17:46:05.903

**相关资料：**

每个绝对定位的元素都是相对于容器定位的。默认容器是 body 标签。

如果未指定尺寸，则具有绝对位置的元素将收缩到其内容的大小。在 JavaScript 中计算大小时，返回的值是当前大小的任何值，具体取决于它包含的内容。除非将宽度或高度明确设置为 100%，否则该元素的大小不会与其父元素相同。

**不使用 jQuery：**

获取容器元素的 x 和 y 位置（相对于视口），视口的宽度和高度，以及元素的宽度和高度。

将 设置为`top`视口高度的一半，减去容器 y 位置，再减去元素高度的一半。将 设置为`left`视口宽度的一半，减去容器 x 位置，再减去元素宽度的一半。

```
// Center an absolutely-positioned element in the viewport.
function centerElementInViewport(el, container) {

    // Default parameters
    if ((typeof container == 'undefined') || (container === null))
        // By default, use the body tag as the relative container.
        container = document.body;

    // Get the container position relative to the viewport.
    var pos = container.getBoundingClientRect();

    // Center the element
    var left = ((window.innerWidth >> 1) - pos.left) - (el.offsetWidth >> 1);
    var top = ((window.innerHeight >> 1) - pos.top) - (el.offsetHeight >> 1);
    el.style.left = left + 'px';
    el.style.top = top + 'px';
} 
```

这是一个[jsfiddle 演示](http://jsfiddle.net/Matt_Coughlin/R8JGT/6/)。如果在 jsfiddle 中运行它有问题，试试这个[独立的演示](http://www.forestpath.org/test/misc/center-in-viewport.html)。

在 IE7/8/9、Firefox、Chrome、Safari 和 Safari Mobile (iOS) 中对其进行了测试。到目前为止，唯一导致问题的是绝对定位的元素是否有边距（此功能目前不支持）。

尚未在响应式设计中进行测试。

**注意：**注意不要在页面首次加载时调用此函数。如果浏览器被滚动或缩放然后重新加载，页面可能还没有被重新滚动或缩放回原来的位置，结果位置将不正确。在调用该函数之前设置一个 100 毫秒的计时器似乎有效（允许浏览器有时间重新滚动和重新缩放页面）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T15:25:00.950

在我的经验中，这很难用 html/css

我发现最简单的方法是使用 Javascripts innerHeight 属性

代码可能如下所示：

```
if (window.innerHeight) {
  var loadingHeight = document.getElementById('loading').offsetHeight;
  document.getElementById('loading').style.top = (((window.innerHeight/2)-loadingHeight) + "px");
} 
```

您可以使用相同的方法设置水平位置，但将 height、offsetHeight 和 window.innerHeight 方法替换为各自的宽度选项，它们都在网络上有很好的记录

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T15:42:51.760

[`position: fixed`](http://davidwalsh.name/css-fixed-position)与修复`width`&一起使用`height`。

# highcharts - 意外的 Highcharts 结果

> ID：11364961
> 
> 赞同：1
> 
> 时间：2012-07-06T15:14:18.067
> 
> 标签：highcharts

我正在使用示例中所示的 highcharts，但由于某种原因，它完全不喜欢我的数据。我看到结果的唯一一次是当我缩小到全部然后它只显示一个点。关于我做错了什么的任何线索将不胜感激。

我如何获取我的数据：

```
$jsResult = array();
$arResults = $wpdb->get_results("SELECT tsDay, nPrice FROM sometable", ARRAY_A);

    foreach($arResults as $key => $val){

        //$val['nPrice'] = floatval($val['nPrice']);

        //$jsResult[$key][0] = ($val['tsDay']*1000);
        //$jsResult[$key][1] = intval($val['nPrice']);

        //$strDate = date("Y/m/d", $val['tsDay']);
        //$strDate = explode('/', $strDate);

        $jsResult[$val['tsDay']] = '['.($val['tsDay']*1000).', '.$val['nPrice'].']';
    }

    $jsResult = "[\n".implode(",\n", $jsResult)."\n]";
    ?> 
```

图表：

```
$(document).ready(function() {

    var data = <?php echo $jsResult; ?>;

    // create the chart
    window.chart = new Highcharts.StockChart({
        chart : {
            renderTo : 'graph',
            zoomType: 'x'
        },

        navigator : {
            series : {
                data : data
            }
        },

        rangeSelector : {
            selected : 5 // All
        },

        tooltip: {
            xDateFormat: '%Y-%m-%d %H:%M:%S'
        },

        xAxis : {
            ordinal: true
        },

        series : [{
            //type: 'candlestick',
            name : 'data',
            data : data,
            dataGrouping : {
                enabled : false
            },
            marker: {
                enabled: true,
                radius: 2
            }
        }]
    }); 
```

来自 Highcharts 的样本数据绘制得很好：

```
[1121212800000,38.35],
[1121299200000,40.75],
[1121385600000,41.55],
[1121644800000,41.49],
[1121731200000,43.19],
[1121817600000,43.63],
[1121904000000,43.29],
[1121990400000,44.00],
[1122249600000,43.81],
[1122336000000,43.63],
[1122422400000,43.99],
[1122508800000,43.80],
[1122595200000,42.65], 
```

我的数据样本：

```
[1339736400000,1627.25],
[1339650000000,1613.50],
[1339563600000,1619.50],
[1339477200000,1603.50],
[1339390800000,1584.00],
[1339131600000,1576.50],
[1339045200000,1606.00],
[1338958800000,1635.00],
[1338526800000,1606.00],
[1338440400000,1558.00],
[1338354000000,1540.00],
[1338267600000,1579.50],
[1337922000000,1569.50], 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:49:20.330

这是您的图表有什么问题，您的数组会随着时间从 6 月 15 日开始，然后是 14 ,13 等等

如果你使用`reverse()`你会得到一个看起来像这样的数组

```
 var data = [ [1337922000000,1569.50], [1338267600000,1579.50] ,
                 [1338354000000,1540.00],[1338440400000,1558.00],
                 [1338526800000,1606.00],
                 [1338958800000,1635.00],[1339045200000,1606.00],
                 [1339131600000,1576.50],[1339390800000,1584.00],
                 [1339477200000,1603.50],[1339563600000,1619.50],] 
```

这将使您的图表正常工作这是一个有效的[jsFiddle](http://jsfiddle.net/minagabriel/6drnq/)

# android - FragmentActivity 变成另一个 FragmentActivity

> ID：11364962
> 
> 赞同：0
> 
> 时间：2012-07-06T15:14:27.620
> 
> 标签：android, android-fragments, android-ui

我需要一些帮助来解决我的问题。

我想把一个FragmentActivity放到另一个FragmentActivity中，也就是我项目的MainActivity。有可能的？

我的想法是，我想将带有 TabHost 的选项卡放入 MainActivity 中的 LinearLayout 或 FrameLayout 中，因此我考虑了插入将成为 FragmentActivity 的选项卡的可能性。

你可以帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:18:14.767

片段可以工作吗？为什么需要 FragmentActivity？

# javascript - 从页面中删除标签

> ID：11364970
> 
> 赞同：-1
> 
> 时间：2012-07-06T15:14:41.143
> 
> 标签：javascript

这是树图第三层的功能

```
 for (i=0;i<arr3.getNumberOfRows();i++){
            var rows3= [arr3.getValue(i,0)+'\n  Ticker: '+arr3.getValue(i,1)+'< br >'+'Instrument Desscription: '
            +arr3.getValue(i,4)+'<br>'+'Number Of Trades: '+arr3.getValue(i,6)+'< br > P&L: $'+arr3.getValue(i,7),
            arr3.getValue(i,3)+' '+arr3.getValue(i,8),arr3.getValue(i,6)-1+1,arr3.getValue(i,7)-1+1]

            layer2rows.push(rows3);

            }
            return layer2rows;
            } 
```

这是谷歌树图代码的一部分。我有三层。我想在行中显示中断，当我将鼠标悬停在节点上时，我不希望信息显示在一行上。这段代码实际上解决了这个问题，即当我将鼠标悬停在我想要的工具提示中的行中有中断但现在这些中断标记出现在节点头上时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:18:20.070

尝试...

```
rows3.replace('<br>',''); 
```

或使用 jQuery：

```
$('br').each(function(){

    $(this).remove();

}); 
```

# c# - Marshal.StructureToPtr InvalidCastException

> ID：11364973
> 
> 赞同：0
> 
> 时间：2012-07-06T15:14:45.080
> 
> 标签：c#

尝试将结构设置为指针时出现非常奇怪的错误......抛出了无效的强制转换异常，我完全不知道为什么。该函数要求提供 3 个参数、一个对象、IntPtr 和一个布尔标志。我正在设置的所有这些......甚至明确地将它们转换为这样没有区别。对象是一个结构，Intptr 是一个指针并且有数据，标志只是设置为假。

以前有没有人在这种情况下收到过这个 invalidcastexception ？

**编辑**

```
internal class FrameTransport
{
    #region Fields
    internal SharedMemoryChannel controlChannel;
    internal ControlChannelStruct controlStruct;
    internal SharedMemoryChannel frameChannel1;
    internal SharedMemoryChannel frameChannel2;
    internal byte[] bitmapData;
    internal int bitmapDataSize;
    internal uint sharedInfoSize;
    internal bool haveFrame;
    internal int height;
    internal int width;
    #endregion

    #region Structures
    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    internal struct FrameChannelStruct
    {
        public Int32 bufid;
        public Int32 size;
        public Int32 width;
        public Int32 height;
        public Int32 bitsperpixel;
        public Int32 fourcc;
        public Int32 orientation;
        public Int64 clientpointer;
    };

    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    internal struct ControlChannelStruct
    {
        public Int32 bufferstates;
        public FrameChannelStruct buffer1;
        public FrameChannelStruct buffer2;
        public BufferType buftype;
        public Int32 configuration;
        public Int32 fourcccount;
        public Int32 fourcc01;
        public Int32 fourcc02;
        public Int32 fourcc03;
        public Int32 fourcc04;
        public Int32 fourcc05;
        public Int32 fourcc06;
        public Int32 fourcc07;
        public Int32 fourcc08;
        public Int32 fourcc09;
        public Int32 fourcc10;
    };
    #endregion

    #region Constructors
    /// <summary>
    /// Constructor.
    /// </summary>
    public FrameTransport()
    {
        sharedInfoSize = (uint)Marshal.SizeOf((Type)typeof(ControlChannelStruct));
        haveFrame = false;
        bitmapData = null;
        bitmapDataSize = 0;
        frameChannel1 = null;
        frameChannel2 = null;

        controlStruct = new ControlChannelStruct();
        controlStruct.bufferstates = 1;
        controlStruct.buffer1.bufid = -1;
        controlStruct.buffer2.bufid = -1;
        controlStruct.buffer1.clientpointer = 1;
        controlStruct.buffer2.clientpointer = 2;
        controlStruct.fourcccount = 0;
        controlStruct.buftype = BufferType.WINBUFFERS;

        controlChannel = new SharedMemoryChannel();
        bool success = controlChannel.CreateMapping(sharedInfoSize);

        if (!success)
        {
            throw new Exception("Unable to create memory mapping for video frame transport.");
        }

        controlChannel.OpenMapping(controlChannel.key);
        int error = Win32.GetLastError();

        if (error != 0)
        {
            throw new Exception("Unable to map memory for video frame transport.");
        }
    }
    #endregion

    #region Internal Members
    /// <summary>
    /// Send the control data.
    /// </summary>
    internal void SendControlData()
    {
        Marshal.StructureToPtr(controlStruct, controlChannel.data, false);
    }

    /// <summary>
    /// Get the control data.
    /// </summary>
    internal void GetControlData()
    {
        controlStruct.bufferstates = -1;
        controlStruct = (ControlChannelStruct)Marshal.PtrToStructure(controlChannel.data, typeof(ControlChannelStruct));
    }

    /// <summary>
    /// Communicate supported pixel formats to the runtime.
    /// </summary>
    /// <param name="count"></param>
    /// <param name="fourCcs"></param>
    internal void SetPreferences(int count, Int32[] fourCcs)
    {
        if (fourCcs.Length != 1)
        {
            throw new Exception("For now im assuming only one fourcc here.");
        }

        controlStruct.fourcccount = count;
        controlStruct.fourcc01 = fourCcs[0];
        controlStruct.fourcc02 = 0;
        controlStruct.fourcc03 = 0;
        controlStruct.fourcc04 = 0;
        controlStruct.fourcc05 = 0;
        controlStruct.fourcc06 = 0;
        controlStruct.fourcc07 = 0;
        controlStruct.fourcc08 = 0;
        controlStruct.fourcc09 = 0;
        controlStruct.fourcc10 = 0;

        SendControlData();
    }

    /// <summary>
    /// Get the buffer states.
    /// </summary>
    /// <returns></returns>
    internal int GetBufStates()
    {
        GetControlData();

        return controlStruct.bufferstates;
    }

    /// <summary>
    /// Return the channel's key.
    /// </summary>
    /// <returns></returns>
    internal uint Key()
    {
        return (uint)controlChannel.key;
    }

    /// <summary>
    /// Check if a new frame is available.
    /// </summary>
    /// <returns></returns>
    internal bool IsNewFrameAvailable()
    {
        GetControlData();
        int bufferState = (controlStruct.bufferstates & 0x3);

        if ((bufferState != 0x00) & (bufferState != 0x3))
        {
            return false;
        }

        return true;
    }

    /// <summary>
    /// Get the frame.
    /// </summary>
    /// <returns></returns>
    internal bool GetFrame()
    {
        int bufferState = (controlStruct.bufferstates & 0x03);

        if (!haveFrame & bufferState == 0x01) 
        { 
            return false; 
        }

        if (!haveFrame)
        {
            haveFrame = true;
        }

        if (bufferState == 0x00)
        {
            controlStruct.bufferstates |= 0x02;
        }

        if (bufferState == 0x03)
        {
            controlStruct.bufferstates &= ~0x02;
        }

        bufferState = (controlStruct.bufferstates & 0x03);

        FrameChannelStruct buffer;
        SharedMemoryChannel channel;

        if (bufferState == 0x1)
        {
            buffer = controlStruct.buffer1;
            channel = frameChannel1;
        }
        else if (bufferState == 0x2)
        {
            buffer = controlStruct.buffer2;
            channel = frameChannel2;
        }
        else
        {
            throw new Exception("Error: unexpected video control buffer state.");
        }

        if (channel == null)
        {
            channel = new SharedMemoryChannel();
            bool success = channel.OpenMapping(buffer.bufid);

            if (!success)
            {
                throw new Exception("Unable to map frame bitmap channel.");
            }
        };

        if (channel != null)
        {
            if (channel.key != buffer.bufid)
            {
                return false;
            };
        };

        width = buffer.width;
        height = buffer.height;
        int bytesPerPixel = buffer.bitsperpixel >> 3;
        int newFrameSize = width * height * bytesPerPixel;

        if (newFrameSize != bitmapDataSize)
        {
            bitmapData = null;
            bitmapDataSize = newFrameSize;
            bitmapData = new byte[bitmapDataSize];
        }

        Marshal.Copy(channel.data, bitmapData, 0, bitmapDataSize);

        if (bufferState == 0x1)
        {
            controlStruct.buffer1 = buffer;
            frameChannel1 = channel;
        }
        else if (bufferState == 0x2)
        {
            controlStruct.buffer2 = buffer;
            frameChannel2 = channel;
        }

        SendControlData();

        return true;
    }
    #endregion
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:50:05.057

结构内的 BufferType 必须是枚举，因为保存枚举值的自定义 Type 是缺陷。

# java - Toxgene 无法读取 XML 文件

> ID：11364974
> 
> 赞同：0
> 
> 时间：2012-07-06T15:14:48.527
> 
> 标签：java, xml, sax

当我使用模板文件执行命令时，我在执行 TOXGENE 工具以生成 XML 文件时遇到了一个问题

```
C:\toxgene3.2\samples\catalog>toxgene catalog.tsl
template parsing Done!
Generating 200 elements in author_list: Done!
Reading List genre_lists from ./input/genres.xml"
****Error can not parse files ./input/genres.xml
org.apache.xerces.parsers.SAXParser 
```

解决此错误的任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T15:38:46.110

我遇到了这个问题，这是由于**Xerces-J**的最后一个版本中的 jar 文件不是 ToXgene 所期望的。尝试更改`bin/toxgene`脚本，以便`$XERCES_HOME/xerces.jar`在`CLASSPATH`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-30T16:51:23.773

就是这样，苏丹塔说的，但我也发现了一个错误。如果您使用的是 Windows，则需要编辑 bin/toxgene.bat 文件的第 21 行（设置 TG_CP= ...）。您需要在“%”字符之前删除“$”。

顺便说一句，有人知道我在哪里可以下载 XBench [1] 生成器或 ToXgene 旧版本？

[1] [https://cs.uwaterloo.ca/~tozsu/ddbms/projects/xbench/index.html](https://cs.uwaterloo.ca/~tozsu/ddbms/projects/xbench/index.html)

祝你好运！

# javascript - 使用数组检查一系列 javascript 按钮

> ID：11364976
> 
> 赞同：3
> 
> 时间：2012-07-06T15:14:52.880
> 
> 标签：javascript, jquery, string, jquery-selectors

我正在尝试检查一系列按钮以查看它们是否已被选中以生成查询字符串。据我所知，逻辑看起来像这样：

```
if ($("input[name='ovr']")[0].checked)
{
...
} 
```

这行得通，但是由于我不想使用一系列 if 语句来生成字符串（因为以后可能会添加更多按钮，效率低下等），所以我生成了一个表示与按钮关联的名称的数组（我打印了数组；它肯定包含正确的名称）。但是，当我循环遍历数组中的每个名称时，控制台提示“输入”是一个无法识别的表达式。这是循环：

```
 for (i = 0; i < myList.length; i = i + 1) {
        if ($("/"input[name='" + myList[i] + "']/"")[0].checked) {
            string += myList[i] + "=" + myList[i] + "&";
        }
    } 
```

string 是一个变量，如果按钮检查应该返回 true，则将正确的签名（？）附加到自身上。myList 是包含名称的数组。

不幸的是，我对这一切都不熟悉，真的不知道从哪里开始。我确实尝试用谷歌搜索答案（这里真的是新手），但我什至不太确定要搜索什么。我还弄乱了输入表达式的措辞，使用了不同的转义字符等，但无济于事。HTML 和大部分 javascript 都不是我的（它是我的主管的），所以我很迷茫。您可以提供的任何建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:17:57.213

像这样的东西会起作用（我真的不明白你为什么要添加那些反斜杠，所以我只向你展示正确的方式）：

```
for (i = 0; i < myList.length; i = i + 1) {
    if ($("input[name='" + myList[i] + "']")[0].checked) {
        string += myList[i] + "=" + myList[i] + "&";
    }
} 
```

**注意：**如果您正在生成查询字符串，请不要忘记使用[`encodeURIComponent()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURIComponent)!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:33:38.573

像这样的东西？

```
var query = "?";
$('input:checked').each(function(index) {
    query += this.name + "=" + this.value + "&";
}); 
```

您可以修改选择器以仅获取您需要的复选框。

# forms - 使用 GET 变量自动将所选内容添加到下拉菜单

> ID：11364977
> 
> 赞同：0
> 
> 时间：2012-07-06T15:14:58.800
> 
> 标签：forms, drop-down-menu, symfony1, get, symfony-1.4

我在表单中使用验证码。当用户向验证码提交无效答案时，页面会重新加载并使用用户数据重新填充字段。我的问题是，是否有更好（或更简单）的方法来检查选择了哪个下拉值。

这就是我现在所拥有的：

**php**

```
<?php
    $state = $sf_params->get('state'); 
?> 
```

**html**

```
<span>State </span>
    <select size="1" name="state">
            <option value="" selected="selected"></option>
            <option value="AL" <?php if ($state == "AL") { echo "selected = 'selected'"; } ?>>Alabama</option>
            <option value="AK" <?php if ($state == "AK") { echo "selected = 'selected'"; } ?>>Alaska</option>
            <option value="AZ" <?php if ($state == "AZ") { echo "selected = 'selected'"; } ?>>Arizona</option>
            <option value="AR" <?php if ($state == "AR") { echo "selected = 'selected'"; } ?>>Arkansas</option> 
```

是否有另一种解决方案来获取 GET 变量，然后解析选项，寻找匹配的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:38:26.450

好吧，自己构建表单并不是一个好习惯。通常你应该使用来自 sfForm 类等的小部件。

但是，如果你真的想构建这种东西，你应该从 sf1.0 中带回一个帮助你构建表单标签的好帮手。在您的情况下，该功能[`options_for_select`](http://trac.symfony-project.org/browser/branches/1.0/lib/helper/FormHelper.php#L22)和[`select_tag`](http://trac.symfony-project.org/browser/branches/1.0/lib/helper/FormHelper.php#L140)可能有用：

*   `options_for_select`：

    > `<option>`根据可选的`$options`数组变量返回一组格式化的标签。

*   `select_tag`：

    > 返回一个`<select>`标签，可选地由`<option>`标签组成。

`options_for_select`作为第二个参数，你想要的选定值。

因此，只需创建一个名为的文件`lib/helper/FormHelper.php`并将这两个函数放入其中。不要忘记在您的视图中加载帮助程序：

```
<?php use_helper('Form') ?> 
```

并使用`options_for_select`&`select_tag`来构建您的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T17:21:39.957

首先将选择的值移动到控制器中的数组中，例如

```
$states = array('AL' => 'Alabama', ... ); 
```

然后您可以使用提到的 Helper j0k 或步行：
通过在控制器中分配变量。

```
$this->states = $states; 
```

在模板中：

```
<?php foreach ($states as $key => $value): ?>
<option value="<?php echo $key ?>" <?php if ($state == $value) { echo "selected = 'selected'"; } ?>><?php echo $value ?></option>
<?php endforeach; ?> 
```

但我也建议使用 Helper。

# asp.net - 使用 MsSqlProvider.ExecProcedure 的存储过程和方法中的正确语法？

> ID：11364979
> 
> 赞同：0
> 
> 时间：2012-07-06T15:10:49.090
> 
> 标签：asp.net, sql-server

我对 ASP.net 和存储过程有疑问

我在 SQL Server 中的过程：

```
ALTER PROCEDURE [dbo].[top1000]
            @Published datetime output,
            @Title nvarchar(100) output,
            @Url nvarchar(1000) output,
            @Count INT output

AS 
SET @Published = (SELECT TOP 1000  dbo.vst_download_files.dfl_date_public FROM dbo.vst_download_files
    ORDER BY dbo.vst_download_files.dfl_download_count DESC )
SET @Title = (SELECT TOP 1000  dbo.vst_download_files.dfl_name FROM dbo.vst_download_files
    ORDER BY dbo.vst_download_files.dfl_download_count DESC) 
SET @Url = (SELECT TOP 1000  dbo.vst_download_files.dfl_source_url FROM dbo.vst_download_files
    ORDER BY dbo.vst_download_files.dfl_download_count DESC) 
SET @Count = (SELECT TOP 1000  dbo.vst_download_files.dfl_download_count FROM dbo.vst_download_files
    ORDER BY dbo.vst_download_files.dfl_download_count DESC) 
```

还有我在网站项目中的程序

```
public static void Top1000()
{
        List<DownloadFile> List = new List<DownloadFile>();
        SqlDataReader dbReader;

        SqlParameter published = new SqlParameter("@Published", SqlDbType.DateTime2);
        published.Direction = ParameterDirection.Output;
        SqlParameter title = new SqlParameter("@Title", SqlDbType.NVarChar);
        title.Direction = ParameterDirection.Output;
        SqlParameter url = new SqlParameter("@Url", SqlDbType.NVarChar);
        url.Direction = ParameterDirection.Output;
        SqlParameter count = new SqlParameter("@Count", SqlDbType.Int);
        count.Direction = ParameterDirection.Output;
        SqlParameter[] parm = {published, title, count};

        dbReader = MsSqlProvider.ExecProcedure("top1000", parm);

        try
        {
            while (dbReader.Read())
            {
                DownloadFile df = new DownloadFile();
                //df.AddDate = dbReader["dfl_date_public"];
                df.Name = dbReader["dlf_name"].ToString();
                df.SourceUrl = dbReader["dlf_source_url"].ToString();
                df.DownloadCount = Convert.ToInt32(dbReader["dlf_download_count"]);
                List.Add(df);
            }

            XmlDocument top1000Xml = new XmlDocument();
            XmlNode XMLNode = top1000Xml.CreateElement("products");

            foreach (DownloadFile df in List)
            {
                XmlNode productNode = top1000Xml.CreateElement("product");

                XmlNode publishedNode = top1000Xml.CreateElement("published");
                publishedNode.InnerText = "data dodania";
                XMLNode.AppendChild(publishedNode);

                XmlNode titleNode = top1000Xml.CreateElement("title");
                titleNode.InnerText = df.Name;
                XMLNode.AppendChild(titleNode);
            }

            top1000Xml.AppendChild(XMLNode);
            top1000Xml.Save("\\pages\\test.xml");
        }
        catch
        {
        }
        finally
        {
            dbReader.Close();
        }
    } 
```

如果我做到了，`MsSqlProvider.ExecProcedure("top1000", parm);`我得到了

> String[1]：属性 Size 的大小为 0 无效。

我应该在哪里寻找解决方案？程序还是方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:57:20.230

您需要为 url 和 Title 指定长度属性

```
SqlParameter title = new SqlParameter("@Title", SqlDbType.NVarChar); 
title.Size=1000

SqlParameter url = new SqlParameter("@Url", SqlDbType.NVarChar); 
url.Size=1000 
```

您可以更改查询，而不是使用输出参数，如下所示

```
ALTER PRocedure [dbo].[top1000]
As
Begin 
Select top 1000 dfl_date_public ,dfl_name,dfl_source_url,
dfl_download_count from dbo.vst_download_files
order  by dbo.vst_download_files.dfl_download_count DESC 
```

然后使用执行阅读器

```
SqlCommand command =
        new SqlCommand("top1000", connection);
command.CommandType=CommandType.StoredProcedure
 SqlDataReader reader = command.ExecuteReader();
 // Iterate through reader as u did and add it to the collection 
```

使用 xelement 构建 XML

```
 foreach (DownloadFile df in List) 
        {
   XElement products=
new XElement("Products",
    new XElement("product",
        new XElement("published", "data dodania"),
        new XElement("title", df.Name) 
                 );
         } 
```

# cakephp - cakephp 无法使用 paginate 对 afterfind 虚拟字段进行排序

> ID：11364981
> 
> 赞同：1
> 
> 时间：2012-07-06T15:15:11.290
> 
> 标签：cakephp, cakephp-1.3, cakephp-model

我有一个查询，我正在通过分页运行。此查询包含一个模型（“PaymentException”），该模型具有一个 afterfind 方法，该方法附加上一个“ExceptionWorkflowLog”的副本，并将其称为“LastWorkflowLog”。

传递给分页的查询：

```
 $this->paginate = array(
        'fields' => array(
            'PaymentException.*', 'Procedure.id', 'Procedure.cpt',
            'Procedure.expected_amount', 'Procedure.allowed_amount', 'Procedure.difference_amount',
            'Claim.id', 'Claim.number', 'Payer.abbr'
        ),
        'limit' => 50,
        'joins' => array(
            array(
                'table' => 'procedures',
                'alias' => 'Procedure',
                'conditions' => array('Procedure.id = PaymentException.procedure_id')
            ),
            array(
                'table' => 'claims',
                'alias' => 'Claim',
                'conditions' => array('Claim.id = Procedure.claim_id')
            ),
            array(
                'table' => 'payers',
                'alias' => 'Payer',
                'conditions' => array('Payer.id = Procedure.payer_id')
            ),
            array(
                'table' => 'groups',
                'alias' => 'Groups',
                'conditions' => array('Groups.id = Claim.group_id')
            )
        ),
        'conditions' => $conditions,
        'contain' => array('ExceptionWorkflowLog')
    ); 
```

结果数组（来自结合了“PaymentException”、“ExceptionWorkflowLog”和“LastWorkflowLog”的查询）如下所示：

```
0 =>
  'PaymentException' => 数组（字段和值），
  'ExceptionWorkflowLog' => 数组（异常工作流日志），
  'LastWorkflowLog' => 数组（最后索引的 ExceptionWorkflowLog 的字段和值）
1 => ...

```

ExceptionWorkflowLog 通过 PaymentException.id 映射到 PaymentException。这是多对一的关系（因此是 ExceptionWorkflowLog 下的结果数组）。

我想使用分页对最后索引的 ExceptionWorkflowLog 或 LastWorkflowLog 上的“更新”字段进行排序。

有没有办法用分页来做到这一点？目前，如果我将表标题设置为指向“LastWorkflowLog.updated”，则查询返回 false，因为查询不知道“LastWorkflowLog”是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T07:40:16.430

由于这有几百个视图，我想我会回来发布我所做的。CakePHP 对连接的处理非常糟糕。我重写了查询以不使用连接，而是使用包含。这似乎解决了它。我觉得脏。

# plugins - 服务器端 Fetchxml 返回不同的结果

> ID：11364982
> 
> 赞同：2
> 
> 时间：2012-07-06T15:15:11.920
> 
> 标签：plugins, dynamics-crm-2011, fetchxml

我们的一个程序允许用户通过选择一个视图然后点击功能区按钮来批量插入相关记录。保存表单，设置标志，然后插件完成其工作。

我们使用带有视图选择器的子网格来让用户动态选择或创建自己的视图。选择视图后，将显示结果数（提供 lte 5k）。

当插件运行相同的 fetchxml 服务器端（检索用户查询或保存查询，然后检索 + FetchExpression）时，结果会发生变化。我们不仅得到不同数量的记录，而且一些记录也不同。

我们得出结论，这个问题与时区有关。一些过滤器包括“on-or-after”运算符以及日期值。例子：

```
<filter type="and">
  <condition attribute="modifiedon" operator="on-or-after" value="2011-01-01" />
  <condition attribute="modifiedon" operator="on-or-before" value="2011-12-31" />
</filter> 
```

该插件以管理员身份运行。更改插件用户没有效果 - 就好像在使用 FetchExpression 从 CRM 中提取记录时不考虑当前用户时区一样。

如何确保 fetchxml 表达式在客户端和服务器端返回相同的结果？

可能相关：[MSDN 线程](http://social.microsoft.com/Forums/en/crmdevelopment/thread/0f0e4e97-c97a-4bc9-af4a-a5f729ca30f2)。

谢谢你的时间。

编辑：按照 Daryl 的建议，我运行了 SQL 跟踪。结果令人费解。客户端查询的日期正确偏移（从 CRM 运行，即高级查找） - 这意味着使用用户的时区设置正确翻译了 fetchxml。对于服务器端的相同查询，这不会发生；输出 SQL 包含“原样”的日期过滤器，没有时区偏移。我假设无论查询执行上下文的来源如何，都会发生相同的翻译。

编辑 2：隐藏代码区域中的标志（我最后的调试手段）阻止插件在运行用户的上下文中实例化服务。现在一切运行良好。感谢大家的时间和帮助，非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T18:09:16.037

处理日期时，请始终记住转换为 UTC，因为 CRM 就是这样将它们存储在数据库中的。

本地 CRM 高级查找将查看当前用户的时区，并在执行 SQL 查询之前将他们输入高级查找的任何时间转换为 UTC。您的插件控件将需要做同样的事情。这些是在将条件放入 Fetch Xml/Linq 表达式/查询表达式之前需要执行的步骤。

1.  通过他们的 SystemUserId 获取用户的 UserSetting.TimeZoneCode。
2.  从步骤 1 中查找 TimeZoneCode 的 TimeZoneDefinition.StandardName
3.  调用 TimeZoneInfo.FindSystemTimeZoneById() 从第 2 步传入标准名称（您可以将第 1 步和第 2 步组合到一个查询中，但我更喜欢使用第 1 步的输入缓存第 3 步的结果以稍微提高性能。即. 使用以 TimeZoneCode 作为键， TimeZoneInfo 作为值的字典）
4.  使用此函数获取您将在插件查询中使用的时间的 UTC 值：

* * *

```
public static DateTime ConvertTimeToUTC(DateTime time, TimeZoneInfo timeZone)
{
    if (time.Kind != DateTimeKind.Unspecified)
    {
        // If the DateTime is created with a specific time zone(ie DateTime.Now), getting the offset will
        // blow chow if it isn't the correct time zone:
        // The UTC Offset of the local dateTime parameter does not match the offset argument.
        //Parameter name: offset

        // This quick check will recreate the serverLocal time as unspecified

        time = new DateTime(
            time.Year,
            time.Month,
            time.Day,
            time.Hour,
            time.Minute,
            time.Second,
            time.Millisecond);

    }
    var offest = new DateTimeOffset(time, timeZone.GetUtcOffset(time));
    return offest.UtcDateTime;
} 
```

# java - tinyMCE 不仅替换了整个表单 textarea

> ID：11364985
> 
> 赞同：0
> 
> 时间：2012-07-06T15:15:26.400
> 
> 标签：java, web-applications, tinymce, tiles, freemarker

我正在用 tinyMCE 编辑器构建一个 webapp（使用 java、spring、freemarker 和 tiles）。

我已将所有文件添加到类路径中，一切都在正确的位置，tinyMCE 编辑器几乎正确加载...

我的表单中有几个字段，文本输入，选项，按钮，标签等......但是当我运行此表单时会出现问题。tinyMCE 替换整个表单，而不仅仅是 textarea 并将该表单放入自身内部 - 进入 tinyMCE 编辑器区域。

我正在关注此处的基本安装[http://www.tinymce.com/wiki.php/Installation](http://www.tinymce.com/wiki.php/Installation) 我的代码与此处几乎相同，形式上包含更多元素。

有什么解决办法吗？这是标准行为吗？

如果重要的话，我会在 FF 13.0.1 上运行它...

我在 form.ftl 文件中的初始化代码是：

```
<#import "../spring.ftl" as spring>
<#assign form=JspTaglibs["http://www.springframework.org/tags/form"]>

<html>
<head>
    <script type="text/javascript" src="/resources/tinymce/tiny_mce.js"></script>
    <script type="text/javascript">
        tinyMCE.init({
            height : "480",
            mode : "textareas"
        });
    </script>
</head>
<body>
    <div id="content">
        <@form.form>
            <input type="text" id="title"/><br>
            <input type="text" id="author"/><br>
            <textarea id="content"></textarea><br>
            <button type="submit"/> <button type="reset"/>
        </@form.form>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T07:31:52.277

行

我找到了解决方案。问题是我有两个具有相同**id="content"**的元素，有

```
<div id="content">...</div> 
```

和

```
<textarea id="content"></textarea> 
```

当我将其更改为唯一时，它解决了问题。

# jquery - 带有匹配媒体的 jQuery 媒体查询

> ID：11364986
> 
> 赞同：2
> 
> 时间：2012-07-06T15:15:27.497
> 
> 标签：jquery, jquery-animate, media-queries

我正在尝试根据屏幕分辨率更改我的 jQuery 代码。我正在为主要内容区域制作动画，并想在不同的屏幕尺寸上更改它的宽度。

经过大量在线搜索后，我发现了一些可能有用的东西，但我无法让它工作。这是需要更改的代码片段。它被称为 Match Media，类似于 CSS3 媒体查询，仅适用于 JavaScript。

```
 var mq = window.matchMedia( "(max-width: 320px)" );
         if (mq.matches) {
           menuLink.click(function(){
            innerContent.css("display", "none");
            contentWrapper.stop().animate(
                    {width: '40em'},
                    {duration:1200,easing: 'easeOutBack'}
            );
            closeButton.stop().delay(800).animate({opacity:'1'},600,'easeInSine');
            $("#fadeBg").fadeIn();
         });
          } 
```

我在这里想要的主要事情是当满足最大宽度标准以将 contentWrapper 动画化为 40 em 时。但似乎什么都没有发生。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T15:22:06.303

你准备好文件了吗？

```
$( function(){
  ...
  var mq = window.matchMedia( "(max-width: 320px)" );

} ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-08T17:16:04.717

当我向它添加一个监听器时，它对我有用。

```
 var mq = window.matchMedia( "(max-width: 320px)" );
  mq.addListener(function(){
    if (mq.matches) {
      ...
    }
  }); 
```

全部包裹在 $(function(){...}); 因为我在匹配时使用了 jQuery 动画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-14T02:57:47.543

这个会起作用的。

```
 $(function () {

//1) create a function 
        var handleMatchMedia = function(md) {
            if (md.matches) {
               // your code
            } else {
               // your code
            }
        }
        var mq = window.matchMedia("(max-width: 768px)");

 // 2) call the function
        handleMatchMedia(mq);

//3) call the addListener function  
        mq.addListener(handleMatchMedia);
      }); 
```

PS addListener 函数可以在 Typescript 中找到，因此请确保您下载了 Typescript 。

还阅读了这篇文章：

[http://blog.astaz3l.com/2013/11/27/matchmedia/](http://blog.astaz3l.com/2013/11/27/matchmedia/)

# objective-c - NSMutableArray：添加和提取结构

> ID：11364987
> 
> 赞同：2
> 
> 时间：2012-07-06T15:15:35.093
> 
> 标签：objective-c, struct, nsmutablearray, nsvalue

我正在尝试将一些数据存储在`NSMutableArray`. 这是我的结构：

```
typedef struct{
    int time;
    char name[15];
}person; 
```

这是添加一个人的代码：

```
person h1;
h1.time = 108000;
strcpy(h1.name, "Anonymous");
[highscore insertObject:[NSValue value:&h1 withObjCType:@encode(person)] atIndex:0]; 
```

所以，我尝试以这种方式提取：

```
NSValue * value = [highscore objectAtIndex:0];
person p;
[value getValue:&p];
NSLog(@"%d", p.time); 
```

问题是最终的日志没有显示 108000！
怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T17:01:01.147

您的代码看起来正确（并且对我有用），所以我推断您没有初始化`highscore`. 因此，当您向它发送`insertObject:atIndex:`消息时，什么也没有发生。然后，当您将`objectAtIndex:`方法发送给它时，您将得到 nil 。当你发送`getValue:`到 nil`NSValue *value`时，它什么也不做，所以你`person p`的内存被随机堆栈垃圾填满，这就是你`NSLog`不打印 108000 的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T16:24:04.120

正如我最初的评论中所说，很少有理由用纯 c 结构做这种事情。而是使用真正的类对象：

如果你不熟悉下面的语法，你可能想看看这些关于 ObjC 2.0 的快速教程以及阅读 Apple 的文档：

*   [Objective-C 2.0 快速教程](http://theocacao.com/document.page/510)
*   [Objective-C 2.0 快速教程：第二部分](http://theocacao.com/document.page/516/)

人物类：

```
// "Person.h":
@interface Person : NSObject {}

@property (readwrite, strong, nonatomic) NSString *name;
@property (readwrite, assign, nonatomic) NSUInteger time; 

@end

// "Person.m":
@implementation Person

@synthesize name = _name; // creates -(NSString *)name and -(void)setName:(NSString *)name
@synthesize time = _time; // creates -(NSUInteger)time and -(void)setTime:(NSUInteger)time

@end 
```

类用途：

```
#import "Person.h"

//Store in highscore:

Person *person = [[Person alloc] init];
person.time = 108000; // equivalent to: [person setTime:108000];
person.name = @"Anonymous"; // equivalent to: [person setName:@"Anonymous"];
[highscore insertObject:person atIndex:0];

//Retreive from highscore:

Person *person = [highscore objectAtIndex:0]; // or in modern ObjC: highscore[0];
NSLog(@"%@: %lu", person.name, person.time);
// Result: "Anonymous: 108000" 
```

* * *

为了简化调试，您可能还需要`Person`实现该`description`方法：

```
- (NSString *)description {
    return [NSString stringWithFormat:@"<%@ %p name:\"%@\" time:%lu>", [self class], self, self.name, self.time];
} 
```

这将允许您为日志记录执行此操作：

```
NSLog(@"%@", person);
// Result: "<Person 0x123456789 name:"Anonymous" time:108000> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T16:16:55.643

将 Person 重新实现为 Objective-C 对象并获得以下好处：

人.h：

```
@interface Person : NSObject
{
    int _time;
    NSString *_name;
}

@property (assign, nonatomic) int time;
@property (retain, nonatomic) NSString *name;

@end 
```

人.m：

```
#import "Person.h"

@interface Person
@synthesize time = _time;
@synthesize name = _name;

- (id)init
{
    self = [super init];
    if (self != nil)
    {
        // Add init here
    }
    return self;
}

- (void)dealloc
{
    self.name = nil;
    [super dealloc];
}

@end 
```

# r - R：合并同一数据表中的行，连接某些列

> ID：11364992
> 
> 赞同：11
> 
> 时间：2012-07-06T15:15:57.603
> 
> 标签：r, merge, concatenation

我在 R 中有我的数据表。我想合并具有相同 的行`customerID`，然后连接其他合并列的元素。

我想从这个出发：

```
 title  author customerID
1 title1 author1          1
2 title2 author2          2
3 title3 author3          1 
```

对此：

```
 title           author Group.1
1 title1, title3 author1, author3       1
2         title2          author2       2 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-06T17:06:21.783

该`aggregate`功能应该可以帮助您找到解决方案：

```
dat = data.frame(title = c("title1", "title2", "title3"),
                 author = c("author1", "author2", "author3"),
                 customerID = c(1, 2, 1))
aggregate(dat[-3], by=list(dat$customerID), c)
#   Group.1 title author
# 1       1  1, 3   1, 3
# 2       2     2      2 
```

或者，只要确保`stringsAsFactors = FALSE`在创建数据框时添加，就可以了。如果您的数据已经被考虑在内，您可以使用类似`dat[c(1, 2)] = apply(dat[-3], 2, as.character)`先将它们转换为字符的方法，然后：

```
aggregate(dat[-3], by=list(dat$customerID), c)
#   Group.1          title           author
# 1       1 title1, title3 author1, author3
# 2       2         title2          author2 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T16:56:42.100

也许不是最好的解决方案，但很容易理解：

```
df <- data.frame(author=LETTERS[1:5], title=LETTERS[1:5], id=c(1, 2, 1, 2, 3), stringsAsFactors=FALSE)

uniqueIds <- unique(df$id)

mergedDf <- df[1:length(uniqueIds),]

for (i in seq(along=uniqueIds)) {
    mergedDf[i, "id"] <- uniqueIds[i]
    mergedDf[i, "author"] <- paste(df[df$id == uniqueIds[i], "author"], collapse=",")
    mergedDf[i, "title"] <- paste(df[df$id == uniqueIds[i], "title"], collapse=",")
}

mergedDf
#  author title id
#1    A,C   A,C  1
#2    B,D   B,D  2
#3      E     E  3 
```

# javascript - Javascript 中的 parseInt() 给出奇怪的结果

> ID：11364994
> 
> 赞同：0
> 
> 时间：2012-07-06T15:16:00.210
> 
> 标签：javascript, parseint

> **可能重复：**
> [JavaScript：为什么 parseInt(1/0, 19) 返回 18？](https://stackoverflow.com/questions/11340673/javascript-why-does-parseint1-0-19-return-18)

为什么 parseInt(1/0, 19) 在 Javascript 中计算为 18？我理解 19 不是一个允许的基数，但仍然有人能说出这里的情况如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:20:34.260

啊，快速的 javascript 安慰导致了答案：

```
> 1/0
Infinity
> parseInt("Infinity", 19)
18 
```

`parseInt`似乎将第一个参数转换为字符串，例如：

```
> parseInt(11, 2)
3 
```

所以，它正在转换字符串“Infinity”，它解释了一切。

# c# - c#浮点for循环，意外结果

> ID：11364996
> 
> 赞同：-1
> 
> 时间：2012-07-06T15:16:02.107
> 
> 标签：c#, for-loop, floating-point

谁能向我解释为什么这个程序：

```
for(float i = -1; i < 1; i += .1F)
    Console.WriteLine(i); 
```

输出这个：

-1

-0.9

-0.8

-0.6999999

-0.5999999

-0.4999999

-0.3999999

-0.2999999

-0.1999999

-0.99999993

7.450581E-08

0.1000001

0.2000001

0.3000001

0.4000001

0.5000001

0.6000001

0.7000001

0.8000001

0.9000002

舍入误差从何而来？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T15:17:57.883

浮点数不正确，它们总是近似值，因为它们必须四舍五入！！
它们在二进制表示中是精确的。
每个 CPU 或 pc 都可能导致不同的结果。
看看[维基百科页面](http://en.wikipedia.org/wiki/Floating_point)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T15:24:47.997

我敢肯定这个问题以前一定是以某种形式提出过的，但我无法在任何地方快速找到它。:)

答案归结为浮点数的表示方式。您可以[通过维基百科了解技术细节，](http://en.wikipedia.org/wiki/Floating_point)但简单地说，十进制数不一定具有精确的浮点表示......

浮点数（无论如何都像双精度和浮点数一样以 2 为基数的浮点数）的工作方式 [0] 是通过将 1/2 的幂相加得到你想要的。所以 0.5 只是 1/2。0.75 是 1/2+1/4 等等。

问题来了，如果没有越来越小的 2 幂的无休止流，你永远无法在这个二进制系统中表示 0.1，因此计算机能做的最好的事情就是存储一个非常接近但不完全是 0.1 的数字。

通常你不会注意到这些差异，但它们就在那里，有时你可以让它们表现出来。有很多方法可以处理这些问题，而您使用哪一种在很大程度上取决于您实际使用它做什么。

*[0] 以稍微接近的方式*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-06T15:20:14.937

最大的问题是`0.1`不能用二进制表示，就像`1 / 3`或`1 / 7`不能用十进制表示一样。因此，由于计算机必须在某些时候中断，它会累积一个舍入误差。

尝试`0.1 + 0.7 == 0.8`用几乎任何编程语言做，结果你会得到错误的。

在 C# 中为了解决这个问题，使用`decimal`类型来获得更好的精度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-06T15:28:54.880

这将解释关于浮点的一切：http: [//docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-06T15:19:17.083

舍入误差来自浮点不是精确数据类型（转换为十进制时），它是近似值，注意在[C# 参考](http://msdn.microsoft.com/en-us/library/b1e65aza.aspx)中浮点被指定为具有 7 位小数精度。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-06T15:19:29.297

它是任何浮点变量的基础。原因很复杂，但如果你用谷歌搜索的话，会有很多信息。

尝试使用 Decimal 代替。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-06T15:22:54.413

正如其他海报所暗示的那样，问题源于浮点数是精确十进制表示的假设。它们不是——它们是数字的精确***二进制***（base-2）表示。您遇到的问题是您不能总是以十进制格式表示精确的二进制数 - 就像您不能以十进制格式表示 1/3 (.33333333...)。在某些时候，必须进行舍入。

在您的示例中，当您表示 .1F 时会发生舍入（因为这不是一个可以用 base-2 精确表示的值）。

# objective-c - 从 iOS 库中挑选音乐并发送/保存

> ID：11364997
> 
> 赞同：8
> 
> 时间：2012-07-06T15:16:21.113
> 
> 标签：objective-c, ios, mpmediaitem, mpmediapickercontroller

我对音乐文件有疑问。

我想从 iPhone/iTouch/iPad 的音乐库中选择 1 个/多个音乐文件并保存在我的文档文件夹中或将其发送到服务器。

我大致浏览了[MPMediaPickerController](http://developer.apple.com/library/IOs/#documentation/MediaPlayer/Reference/MPMediaPickerController_ClassReference/Reference/Reference.html)和[AddMusic(Sample Code)](http://developer.apple.com/library/IOs/#samplecode/AddMusic/Introduction/Intro.html#//apple_ref/doc/uid/DTS40008845)。但是，我只能获得选择歌曲和播放的详细信息。

是否可以保存那些我也可以用来发送到服务器***的选定歌曲？***

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-02-07T08:00:29.177

**是的，有可能。**

我想它会帮助你

```
// Have to add this framework

//CoreMedia.framework
//AudioToolbox.framework
//CoreAudio.framework
//MediaPlayer.framework
//AVFoundation.framework

//in UploadAudioViewController.h file

#import <UIKit/UIKit.h>
#import <CoreAudio/CoreAudioTypes.h>
#import <AudioToolbox/AudioToolbox.h>
#import <MediaPlayer/MediaPlayer.h>
#import <AVFoundation/AVFoundation.h>
#import <CoreMedia/CoreMedia.h>

@interface UploadAudioViewController : UIViewController<UIActionSheetDelegate,UINavigationControllerDelegate,UIImagePickerControllerDelegate,MPMediaPickerControllerDelegate,AVAudioRecorderDelegate, AVAudioPlayerDelegate,AVAudioSessionDelegate>{

    MPMediaItem *song;
    NSURL *exportURL;
}

@property (nonatomic, retain) NSData *audioData;

// in UploadAudioViewController.m file

#import "UploadAudioViewController.h"
//#import < AudioToolbox/AudioToolbox.h>

@interface UploadAudioViewController ()

@end

@implementation UploadAudioViewController

@synthesize musicPlayer,audioData;

-(id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{

    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;

}

-(void)viewDidLoad
{

    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    self.title = @"Upload Audio";
    self.musicPlayer = [MPMusicPlayerController iPodMusicPlayer];
    self.audioData=nil;

}

#pragma mark Browse Audio from Device

-(void)PickAudioForIndex_iPhone
{

    if ([[[UIDevice currentDevice] model] isEqualToString:@"iPhone Simulator"]) {
        //device is simulator
        UIAlertView *alert1;
        alert1 = [[UIAlertView alloc] initWithTitle:@"Alert" message:@"There is no Audio file in the Device" delegate:self cancelButtonTitle:nil otherButtonTitles:@"Ok",nil];
        alert1.tag=2;
        [alert1 show];
        //[alert1 release],alert1=nil;
    }else{

        MPMediaPickerController *mediaPicker = [[MPMediaPickerController alloc] initWithMediaTypes:MPMediaTypeMusic];
        mediaPicker.delegate = self;
        mediaPicker.allowsPickingMultipleItems = NO; // this is the default
        [self presentViewController:mediaPicker animated:YES completion:nil];

    }

}

#pragma mark Media picker delegate methods

-(void)mediaPicker:(MPMediaPickerController *)mediaPicker didPickMediaItems:(MPMediaItemCollection *)mediaItemCollection {

    // We need to dismiss the picker
    [self dismissViewControllerAnimated:YES completion:nil];

    // Assign the selected item(s) to the music player and start playback.
    if ([mediaItemCollection count] < 1) {
        return;
    }
    song = [[mediaItemCollection items] objectAtIndex:0];
    [self handleExportTapped];

}

-(void)mediaPickerDidCancel:(MPMediaPickerController *)mediaPicker {

    // User did not select anything
    // We need to dismiss the picker

    [self dismissViewControllerAnimated:YES completion:nil ];
}

-(void)handleExportTapped{

    // get the special URL
    if (! song) {
        return;
    }

    //[self startLoaderWithLabel:@"Preparing for upload..."];

    NSURL *assetURL = [song valueForProperty:MPMediaItemPropertyAssetURL];
    AVURLAsset *songAsset = [AVURLAsset URLAssetWithURL:assetURL options:nil];

    NSLog (@"Core Audio %@ directly open library URL %@",
           coreAudioCanOpenURL (assetURL) ? @"can" : @"cannot",
           assetURL);

    NSLog (@"compatible presets for songAsset: %@",
           [AVAssetExportSession exportPresetsCompatibleWithAsset:songAsset]);

    /* approach 1: export just the song itself
     */
    AVAssetExportSession *exporter = [[AVAssetExportSession alloc]
                                      initWithAsset: songAsset
                                      presetName: AVAssetExportPresetAppleM4A];
    NSLog (@"created exporter. supportedFileTypes: %@", exporter.supportedFileTypes);
    exporter.outputFileType = @"com.apple.m4a-audio";
    NSString *exportFile = [myDocumentsDirectory() stringByAppendingPathComponent: @"exported.m4a"];
    // end of approach 1

    // set up export (hang on to exportURL so convert to PCM can find it)
    myDeleteFile(exportFile);
    //[exportURL release];
    exportURL = [NSURL fileURLWithPath:exportFile];
    exporter.outputURL = exportURL;

    // do the export
    [exporter exportAsynchronouslyWithCompletionHandler:^{
        int exportStatus = exporter.status;
        switch (exportStatus) {
            case AVAssetExportSessionStatusFailed: {
                // log error to text view
                NSError *exportError = exporter.error;
                NSLog (@"AVAssetExportSessionStatusFailed: %@", exportError);
                //errorView.text = exportError ? [exportError description] : @"Unknown failure";
                //errorView.hidden = NO;
                //[self stopLoader];
                //[self showAlertWithMessage:@"There ia an error!"];
                break;
            }
            case AVAssetExportSessionStatusCompleted: {
                NSLog (@"AVAssetExportSessionStatusCompleted");
                //fileNameLabel.text = [exporter.outputURL lastPathComponent];
                // set up AVPlayer
                //[self setUpAVPlayerForURL: exporter.outputURL];
                ///////////////// get audio data from url

                //[self stopLoader];
                //[self showAlertWithMessage:@"There ia an error!"];

                NSURL *audioUrl = exportURL;
                NSLog(@"Audio Url=%@",audioUrl);
                self.audioData = [NSData dataWithContentsOfURL:audioUrl];

                break;
            }
            case AVAssetExportSessionStatusUnknown: {
                NSLog (@"AVAssetExportSessionStatusUnknown");
                //[self stopLoader];
                //[self showAlertWithMessage:@"There ia an error!"];
                break;
            }
            case AVAssetExportSessionStatusExporting: {
                NSLog (@"AVAssetExportSessionStatusExporting");
                //[self stopLoader];
                //[self showAlertWithMessage:@"There ia an error!"];
                break;
            }
            case AVAssetExportSessionStatusCancelled: {
                NSLog (@"AVAssetExportSessionStatusCancelled");
                //[self stopLoader];
                //[self showAlertWithMessage:@"There ia an error!"];
                break;
            }
            case AVAssetExportSessionStatusWaiting: {
                NSLog (@"AVAssetExportSessionStatusWaiting");
                //[self stopLoader];
                //[self showAlertWithMessage:@"There ia an error!"];
                break;
            }
            default: {
                NSLog (@"didn't get export status");
                //[self stopLoader];
                //[self showAlertWithMessage:@"There ia an error!"];
                break;
            }
        }
    }];

}

#pragma mark conveniences

NSString* myDocumentsDirectory(){

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    return [paths objectAtIndex:0];;

}

void myDeleteFile (NSString* path){

    if ([[NSFileManager defaultManager] fileExistsAtPath:path]) {
        NSError *deleteErr = nil;
        [[NSFileManager defaultManager] removeItemAtPath:path error:&deleteErr];
        if (deleteErr) {
            NSLog (@"Can't delete %@: %@", path, deleteErr);
        }
    }

}

// generic error handler from upcoming "Core Audio" book (thanks, Kevin!)
// if result is nonzero, prints error message and exits program.

static void CheckResult(OSStatus result, const char *operation)
{

    if (result == noErr) return;

    char errorString[20];
    // see if it appears to be a 4-char-code
    *(UInt32 *)(errorString + 1) = CFSwapInt32HostToBig(result);
    if (isprint(errorString[1]) && isprint(errorString[2]) && isprint(errorString[3]) && isprint(errorString[4])) {
        errorString[0] = errorString[5] = '\'';
        errorString[6] = '\0';
    } else
        // no, format it as an integer
        sprintf(errorString, "%d", (int)result);

    fprintf(stderr, "Error: %s (%s)\n", operation, errorString);

    exit(1);

}

#pragma mark core audio test

BOOL coreAudioCanOpenURL (NSURL* url){

    OSStatus openErr = noErr;
    AudioFileID audioFile = NULL;
    openErr = AudioFileOpenURL((__bridge CFURLRef) url,
                               kAudioFileReadPermission ,
                               0,
                               &audioFile);
    if (audioFile) {
        AudioFileClose (audioFile);
    }
    return openErr ? NO : YES;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T15:39:38.473

> 是否可以保存那些选定的歌曲，我也可以用来发送到服务器？

不可以，您只能播放 iTunes 资料库中的歌曲。
原始音频文件无法访问，可能是由于版权保护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-23T09:04:32.257

我已经尝试并成功导出了 ipod 库歌曲。请在下面找到我的代码：

```
extension AudioPostViewController: MPMediaPickerControllerDelegate {

func mediaPicker(mediaPicker: MPMediaPickerController, didPickMediaItems mediaItemCollection: MPMediaItemCollection) {
    dismissViewControllerAnimated(true, completion: {
        print("You selected \(mediaItemCollection)")

        let item: MPMediaItem = mediaItemCollection.items[0]
        let pathURL: NSURL? = item.valueForProperty(MPMediaItemPropertyAssetURL) as? NSURL
        if pathURL == nil {
            Alert.showPopupWithMessage("Unable to read DRM protected file.")
            return
        }

        let title = item.valueForProperty(MPMediaItemPropertyTitle) as? String ?? "Now Playing..."
        print("\(pathURL), title : \(title) ")

        // get file extension andmime type
        let str = pathURL!.absoluteString
        let str2 = str.stringByReplacingOccurrencesOfString("ipod-library://item/item", withString: "")
        let arr = str2.componentsSeparatedByString("?")
        var mimeType = arr[0]
        mimeType = mimeType.stringByReplacingOccurrencesOfString(".", withString: "")

        // Export the ipod library as .m4a file to local directory for remote upload
        let exportSession = AVAssetExportSession(asset: AVAsset(URL: pathURL!), presetName: AVAssetExportPresetAppleM4A)
        exportSession?.shouldOptimizeForNetworkUse = true
        exportSession?.outputFileType = AVFileTypeAppleM4A
        FilePath.removeAudioFile() // Remove file if it exists
        let fileUrl = FilePath.testFilePathURL()
        exportSession?.outputURL = fileUrl
        exportSession?.exportAsynchronouslyWithCompletionHandler({ () -> Void in

            if exportSession!.status == AVAssetExportSessionStatus.Completed  {
                dispatch_async(dispatch_get_main_queue(), {

                    // Prepare audio to play
                    self.audioTitle = title
                    self.audioPath = fileUrl
                    self.mimeType = "audio/m4a"
                    self.audioFileName = "audio.m4a"

                    UIView.animateWithDuration(0.45, animations: {
                        if Platform.DeviceType.iPhone4 {
                            self.libraryBottomSpacing.constant = 5
                            self.view.layoutIfNeeded()

                        } else {
                            self.libraryBottomSpacing.constant = 25
                            self.view.layoutIfNeeded()

                        }
                        }, completion: {
                            (v: Bool) in
                            self.loadJukeBox(self.audioPath!, title: title)
                    })
                })

            } else {
                dispatch_async(dispatch_get_main_queue(), {
                    Alert.showPopupWithMessage("Unable to read file as its DRM protected.")
                  })

            }

        })

        })

}

func mediaPickerDidCancel(mediaPicker: MPMediaPickerController) {
    dismissViewControllerAnimated(true, completion: nil)
} 
} 
```