# StackOverflow 问答 000089000-000089999

# language-agnostic - 可分发软件的版权和合理使用

> ID：89005
> 
> 赞同：5
> 
> 时间：2008-09-18T00:45:55.697
> 
> 标签：language-agnostic

一段可商业发行的软件在多长的文本和/或音频片段的长度下通过了合理使用的门槛并侵犯了所包含作品的版权？归属是否可以免除开发者的侵权？一个例子是在启动屏幕上使用的小说引用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T00:50:09.603

不幸的是，没有简单的答案。确定什么是合理使用涉及一个非常主观和依赖事实的[四点测试](http://en.wikipedia.org/wiki/Fair_use#Fair_use_under_United_States_law)。除非您最终出庭并由法官裁决，否则您永远不会真正确定是否允许边界使用。

这四个因素是：

1.  使用的目的和性质，包括这种使用是商业性质的还是用于非营利教育目的；
2.  受版权保护作品的性质；
3.  与整个受版权保护的作品有关的部分的数量和实质；和
4.  使用对受版权保护作品的潜在市场或价值的影响。

根据先前的先例（可能与大多数人认为的通俗语言含义相对应，也可能不对应），这些中的每一个都具有特定的法律含义。如果您正在做任何可能导致您被起诉的事情，请咨询律师。

软件更加复杂，因为并非所有代码一开始都具有版权。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T04:09:00.547

另外，请记住，各国的法律各不相同，而且由于大多数软件都通过网络分布在世界任何地方……嗯，这是一个非常令人头疼的问题。不幸的是，诉讼的威胁对有趣的创新工作产生了寒蝉效应。

# language-agnostic - 获得 EULA 和其他软件法律术语的地方？

> ID：89043
> 
> 赞同：15
> 
> 时间：2008-09-18T00:53:42.823
> 
> 标签：language-agnostic

我很好奇是否有人有为小型软件企业获取必要法律文件（用户协议、隐私政策、免责声明等）的经验。例如，如果您只是想拥有一家软件“公司”来销售您编写的一些软件，那么对于这样的小规模产品是否有便宜的解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T01:05:00.487

在[Micro-ISV: From Vision to Reality](https://rads.stackoverflow.com/amzn/click/com/1590596013)中，Bob 建议[使用 MegaDox.com](http://www.megadox.com/index.php/search/?for=Software+Licence++)和[Soft14.com](http://www.soft14.com/upload/software_000039.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T00:58:15.700

文具店将出售标准样板合同。对于软件特定的东西，大多数公司只是复制大公司的东西并更改名称！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T01:14:30.090

如果您打算保持小规模，其他人在其他答案中的建议可能很好，但如果您的意图是增长，特别是如果您可能想让其他人在业务上投资，那么投资律师是有意义的，有软件经验的人。如果您可以与有兴趣与您长期合作的人建立关系并且不会增加这些基本文件的费用，则不必花费很多。

顺便说一句，无论你走哪条路，阅读文档并确保它们适合你实际做的事情都是有意义的。如果您发布样板隐私政策，说您对客户数据执行 x、y 和 z，但实际上您执行的是 a、b 和 c，那么您制造的潜在法律问题比您解决的要多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T17:24:37.243

我正在为一个众筹项目试水，以开发用户友好的 EULA。EULA 本身将像开源一样开发。如果用户遇到这些“开放的” EULA 之一，那么用户同意它会感觉更好，因为

1.  它已经过公开流程的审查，并且
2.  您可能会一遍又一遍地遇到相同的 EULA，因此您不必每次都阅读它。

[https://sites.google.com/a/x2xroads.com/nutshell/open-eula](https://sites.google.com/a/x2xroads.com/nutshell/open-eula)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-21T08:37:35.007

我最近一直在寻找与 OP 相同的信息，并找到了一本很棒的书，其中包括软件公司的标准协议，您可以按原样使用或在律师的帮助下修改。

```
IT/数字法律伴侣：软件综合业务指南，
互联网和知识产权法包括合同和网络表格

作者：Gene K. Landy；艾米·J·马斯特罗巴蒂斯塔
出版商: Syngress
打印 ISBN-10：1-59749-256-6
打印 ISBN-13：978-1-59749-256-0

```

它还包括解释在合同、隐私和知识产权方面您需要为软件业务的不同方面考虑的问题的部分。

# javascript - 排队等待一段时间后执行的动作（不是效果）。

> ID：89051
> 
> 赞同：4
> 
> 时间：2008-09-18T00:55:27.093
> 
> 标签：javascript, jquery

我想知道的是，是否有一种很好的方法可以让 jQuery 函数在一段时间后执行。这不会暂停其他函数的执行，只会暂停链中后续函数的执行。也许我设想的一个例子可以说明：

```
$('#alert')
    .show()
    .wait(5000)    // <-- this bit
    .hide()
; 
```

我知道可以通过使用超时来实现，但这似乎是一种混乱的方式，尤其是与上面的示例相比（如果它是真实的）。

那么，这样的东西是否已经内置到 jQuery 中，如果没有，模拟它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T01:02:23.460

你不能这样做，而且你可能不想这样做。虽然它看起来确实很漂亮，但 Javascript 中没有任何机制可以让您做到这一点，而无需在“等待”中循环直到时间过去。您当然可以这样做，但您可能会严重降低浏览器的性能，并且如果您的超时时间超过几秒钟，浏览器将向用户显示您的 javascript 似乎被卡住的警告。

正确的方法是使用超时：

```
var el = $('#alert');
el.show()
setTimeout(function() { el.hide() }, 5000); 
```

您的另一个选择是扩展 jquery 实质上为您想要延迟的操作添加效果：

```
jQuery.fn.extend({
    delayedHide: function(time) {
        var self = this;
        setTimeout(function() { self.hide(); }, time);
    }
});

$('#alert')
    .show()
    .delayedHide(5000)
; 
```

您还可以使用类似于 setTimeout 的方法扩展 jquery：

```
jQuery.fn.extend({
    delayThis: function(fn, time, args) {
        var self = this;
        setTimeout(function() { jQuery.fn[fn].apply(self, args); }, time);
    }
});

$('#alert')
    .show()
    .delayThis('hide', 5000)
; 
```

或使用 args 调用在数组中传递参数：

```
$('#alert')
    .show()
    .delayThis('css', 5000, [ 'display', 'none' ])
; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T03:38:54.283

[jQuery FxQueues 插件可以满足](http://web.archive.org/web/20111025005225/http://plugins.jquery.com:80/project/fxqueues)您的需要：

```
$('#element').fadeOut({
    speed: 'fast',
    preDelay: 5000
}); 
```

# c - 你如何阅读 C 声明？

> ID：89056
> 
> 赞同：45
> 
> 时间：2008-09-18T00:57:42.470
> 
> 标签：c, typedef, cdecl

我听说过一些方法，但没有一个能成功。就我个人而言，我尽量避免使用 C 中的复杂类型，并尝试将它们分解为组件 typedef。

我现在面临维护一些来自所谓的“三星级程序员”的遗留代码，而且我很难阅读一些 ***code[][]。

您如何阅读复杂的 C 声明？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-18T01:07:15.647

本文解释了一个相对简单的 7 条规则，如果您发现自己想要或需要手动阅读任何 C 声明，它们将让您阅读：[http ://www.ericgiguere.com/articles/reading-c-declarations.html](http://www.ericgiguere.com/articles/reading-c-declarations.html)

> 1.  找到标识符。这是你的起点。在一张纸上，写下“将标识符声明为”。
> 2.  向右看。如果那里什么都没有，或者有一个右括号“)”，则转到第 4 步。
> 3.  您现在位于数组（左括号）或函数（左括号）描述符上。可能有一系列这些，以不匹配的右括号或声明符的结尾（分号或“=”用于初始化）结束。对于每个这样的描述符，从左到右阅读：
>     
>     
>     *   如果一个空数组“[]”，写“数组”
>     *   如果一个数组有大小，写“数组大小”
>     *   如果是函数“()”，则写为“函数返回”
>     
>     停在不匹配的括号或声明符的末尾，以先到者为准。
>     
>     
> 4.  回到起始位置，向左看。如果那里什么都没有，或者有一个左括号“（”，请转到第 6 步。
> 5.  您现在位于指针描述符“*”上。左边可能有一系列这些，以不匹配的左括号“（”或声明符的开头结尾。从右到左读取，对于每个指针描述符写入“指针”。在不匹配的括号处停止或声明符的开始，以先到者为准。
> 6.  此时，您有一个带括号的表达式或完整的声明符。如果您有一个带括号的表达式，请将其视为您的新起点并返回到步骤 2。
> 7.  写下类型说明符。停止。

如果您对工具没问题，那么我建议您使用该程序`cdecl`： http: [//gd.tuwien.ac.at/linuxcommand.org/man_pages/cdecl1.html](http://gd.tuwien.ac.at/linuxcommand.org/man_pages/cdecl1.html)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-09-18T07:14:11.333

我通常使用有时被称为“右手顺时针规则”的东西。它是这样的：

*   从标识符开始。
*   走到它的右边。
*   然后顺时针移动，来到左侧。
*   顺时针移动并来到右侧。
*   只要声明没有被完全解析，就这样做。

还有一个额外的元规则需要注意：

*   如果有括号，请在搬出前完成每一级括号。

在这里，“去”和“移动”某处意味着阅读那里的符号。规则是：

*   `*`- 指向的指针
*   `()`- 函数返回
*   `(int, int)`- 函数接受两个整数并返回
*   `int`, `char`, 等等 - `int`, `char`, 等等
*   `[]`- 数组
*   `[10]`- 十个数组
*   等等

因此，例如，`int* (*xyz[10])(int*, char)`读作：

> xyz 是一个
> 
> 十个数组
> 
> 指向的指针
> 
> 函数采用 int* 和 char 并返回
> 
> 一个整数*

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-18T01:02:04.613

一个字：[cdecl](http://cdecl.org/)

妈的，被打了15秒！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T01:03:19.323

Cdecl（和 c++decl）是一个用于编码和解码 C（或 C++）类型声明的程序。

[http://gd.tuwien.ac.at/linuxcommand.org/man_pages/cdecl1.html](http://gd.tuwien.ac.at/linuxcommand.org/man_pages/cdecl1.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T01:01:49.357

回到我做 C 的时候，我使用了一个名为“cdecl”的程序。它似乎在 Ubuntu Linux 中的 cutils 或 cdecl 包中，并且可能在其他地方可用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T06:41:51.503

cdecl 提供了一个命令行界面，让我们试一试：

```
cdecl> explain int ***c[][]
declare c as array of array of pointer to pointer to pointer to int 
```

另一个例子

```
explain int (*IMP)(ID,SEL) 
declare IMP as pointer to function (ID, SEL) returning int 
```

然而，在“C Deep Secrets”一书中有一整章，名为“Unscrambling declarations in C.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-12-05T07:11:02.760

刚刚在“ [C语言的发展](http://cm.bell-labs.com/cm/cs/who/dmr/chist.html)”中看到了一个启发性的部分：

> 对于这种组合类型的每个对象，已经有一种方法可以提及底层对象：索引数组、调用函数、在指针上使用间接运算符。类比推理导致名称的声明语法反映了名称通常出现的表达式语法。因此，
> 
> `int i, *pi, **ppi;`
> 
> 声明一个整数，一个整数指针，一个指向整数指针的指针。这些声明的语法反映了 i、*pi 和 **ppi 在表达式中使用时都会产生 int 类型的观察结果。相似地，
> 
> `int f(), *f(), (*f)();`
> 
> 声明一个返回整数的函数，一个返回指向整数的指针的函数，一个指向返回整数的函数的指针；
> 
> `int *api[10], (*pai)[10];`
> 
> 声明一个指向整数的指针数组和一个指向整数数组的指针。在所有这些情况下，变量的声明类似于它在表达式中的用法，其类型是在声明开头指定的类型。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-27T04:15:13.930

还有一个非常漂亮[的基于 Web 的 cdecl 版本。](http://cdecl.org/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-20T03:48:36.060

自动化解决方案是 cdecl。

通常，您以使用它的方式声明变量。例如，您取消引用指针 p，如下所示：

```
字符 c = * p

```

你以类似的方式声明它：

```
字符 * p;

```

毛茸茸的函数指针也是如此。让我们将 f 声明为旧的“指向函数的指针，返回指向 int 的指针”，以及一个外部声明，只是为了好玩。它是一个指向函数的指针，所以我们从：

```
外部 * f();

```

它返回一个指向 int 的指针，所以前面的某个地方有

```
外部 int * * f(); // XXX 还没有

```

现在哪个是正确的关联性？我不记得了，所以用一些括号。

```
extern (int *)(* f)();

```

以您使用它的方式声明它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T01:04:35.590

常见的可读性问题包括[函数指针](http://www.newty.de/fpt/fpt.html)和[数组](http://home.netcom.com/~tjensen/ptr/ch2x.htm)实际上是指针这一事实，以及[多维数组实际上是一维数组（实际上是指针）。](http://irc.essex.ac.uk/www.iota-six.co.uk/c/f2_multidimensional_arrays.asp)希望对一些人有所帮助。

无论如何，只要您确实理解了声明，也许您可​​以找到一种简化它们的方法，以使它们对下一个人来说更具可读性。

# vxworks - 如果您在 vxWorks 中被抢占，您的时间片会怎样？

> ID：89071
> 
> 赞同：2
> 
> 时间：2008-09-18T01:01:30.217
> 
> 标签：vxworks

如果您在 Vxworks 中启用了循环，并且您的任务被更高优先级的任务抢占，剩余的时间片会发生什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T01:11:53.530

您的任务将恢复执行并完成剩余的时间片。

请注意，您将在一个时间滴答中发生一些抖动，因为时间切片的粒度为 1 个时钟滴答。

例如：
您使用 10 个时钟滴答时间片启用循环。一个时钟节拍是 10 毫秒。您期望每个时间片有 100 毫秒。
您在 5 毫秒（第一个刻度的中间）被抢占。您应该再运行 95 毫秒，但 VxWorks 认为您还有 10 个滴答。

如果任务在 11 毫秒内恢复 CPU，您将多执行 99 毫秒。
如果任务在 19 毫秒内恢复 CPU，您将多执行 91 毫秒。

每次您被抢占时，您的任务可能会在绝对时间内执行 +/- 1 个滴答。

# sharepoint - 什么是 Microsoft SharePoint？

> ID：89101
> 
> 赞同：94
> 
> 时间：2008-09-18T01:07:39.530
> 
> 标签：sharepoint

我听说许多公司都在使用 Microsoft SharePoint。有人可以简单地告诉我什么是 SharePoint 以及它为什么受欢迎吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-09-18T01:19:36.927

## 什么是 SharePoint？

最新版本的 Microsoft SharePoint 软件实际上是两种不同的产品：

1.  **Windows SharePoint Services**是 Windows Server 的免费下载。在称为 WSS v3 的最新版本中，协作网站模板包括基本的博客和 wiki 服务以及用于图像库、文档库、联系人列表、日历、任务等的列表模板。
2.  **Microsoft Office SharePoint Server 2007**或简称 MOSS 建立在 Windows SharePoint Services 之上。作为 Office Server 产品平台的成员，它利用 Microsoft Office 客户端软件在 Web 上提供内容。与 Word、PowerPoint、Excel、Access 和 InfoPath 的集成通过熟悉的内容创建工具提供丰富的 Web 内容。

## 为什么这么受欢迎

**文件共享** SharePoint 最初变得流行是因为它是一种在 Web 上共享文档的简单方法。许多在 2003 版本中采用 SharePoint 的组织都利用了将文档上传到文档库并与他人共享这些文档的能力。
**公司外联网** 这种基于 Web 的共享的一个很好的例子是公司外联网，其中用户并非都在一个位置或身份验证域中。使用基于表单的身份验证，可以为跨越物理和公司边界的人员创建帐户。通过允许围绕任务而不是公司实体共享文档的地方，SharePoint 超越了公共文件共享。
**内容管理** 还有很多其他的内容管理系统，但 MOSS 合并了以前称为 Microsoft 内容管理系统的功能，它本身通常比单独的 MOSS 成本更高。
**搜索**搜索在 SharePoint 2007 技术中得到了极大改进。与之前的 2003 版本不同，搜索结果经过安全调整、相关且高效。SharePoint 2003 产品中的错误搜索导致对产品的很多不满。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-09-18T01:23:14.563

> 什么是共享点

Sharepoint 实际上是两种不同的技术：Windows Sharepoint Services (WSS) 和 Microsoft Office Sharepoint Server (MOSS)。WSS 是免费的，它随 Windows Server 2003 一起提供。MOSS 不是免费的。

WSS 为在线管理文档和项目提供了许多开箱即用的功能。它管理“文档库”中的文档。这些是具有权限和不同文档视图的文件夹。项目、任务、问题或任何表格数据都在列表中进行管理。列表类似于文档库。他们也有权限和视图。它还提供了一些简单的搜索。

MOSS 提供了更好的搜索（至少应该如此）。它还具有更多的发布功能（WSS 没有）。您可以更好地控制页面布局。它更适用于 Internet 风格的网站，而 WSS 更适用于 Intranet 网站。

> 为什么它很受欢迎？

WSS 之所以受欢迎，部分是因为它是免费的，部分是因为它开箱即用。您可以使用 WSS 解决许多常见的办公请求。诸如问题跟踪器、项目管理和文档管理之类的东西在 WSS 中是微不足道的。也就是说，它是一个多面手——擅长许多，一无是处。

MOSS 可能不太受欢迎，因为它不是免费的，并且使用了一年，我认为它没有 WSS 那么多价值。搜索不是那么好。它在创建公司目录方面做得很好。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-09-18T20:10:17.753

从 v.1 开始，我一直在使用 SharePoint，我可以告诉您，SharePoint 是：

*   文件管理服务器
*   网页内容管理服务器
*   门户解决方案
*   搜索引擎
*   基于列表的存储库
*   合作网站
*   替换文件共享
*   等等等等……

...但如果我必须用一句话总结 SharePoint 是什么，我会说：

> **Sharepoint 是微软的网络操作系统。**

这才是它成功的真正秘诀。许多人将 Web OS 想象成[这样](http://delicious.com/popular/webos)。Web 操作系统并不是看起来像桌面操作系统的东西。Web OS 应该是一个**WEB PLATFORM**，可以在其中构建各种应用程序并且用户可以与之协作。

将 SharePoint 视为 2.0 时代的 Windows 版本 :-)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-19T21:56:18.387

到目前为止非常好，但我会尽力添加一些东西。:)

SharePoint 不仅仅是两种技术。它是 Microsoft 将一组产品和技术汇集到一个具有 2 种风格的巨大产品中。这两种风格是 Windows SharePoint Services (WSS) 和 Microsoft Office SharePoint Server (MOSS)。MOSS 确实以标准和企业形式出现。

[SharePoint 中使用的一些技术：Windows Workflow Foundation、ASP.NET、Web 部件、XML（包括 XPath、XSLT 等）、SQL、Web 服务 - 仅举几例我能想到的）

无论您选择哪种版本，SharePoint 都允许基于 Web 的功能，以允许用户创建、组织、分发和维护信息。因此，SharePoint 网站最常见的用途是 Intranet 和项目/团队网站。

SharePoint 作为应用程序平台还具有不可思议的可能性。仅查看 Web 部件和工作流部分，您就可以开始意识到潜力。例如，可以使用 SharePoint Designer 快速开发组织内授权流程的自动化，而无需任何代码。（仅供参考：更复杂的工作流需要 Visual Studio，但可以使用 SharePoint Designer 的点击功能设计许多简单的工作流）

虽然 MOSS 仅在 WSS 上进行了扩展，但它确实添加了大量对业务非常重要和有用的功能。MOSS 中提供的而不是 WSS 中提供的一些更重要的功能是：记录管理、文档保留和审核策略、基于浏览器的表单（在客户端计算机上未安装 InfoPath 的 InfoPath 表单）以及一些商业智能功能。令人惊讶的是，我们也看到了对 MOSS 的社交网络功能的兴趣。（[易于阅读的 MOSS 没有的 WSS 中没有的功能列表](http://blogs.adatis.co.uk/blogs/martynbullerwell/archive/2007/10/30/the-difference-between-moss-2007-and-wss-3-0.aspx)）

为什么使用 SharePoint？不久前，我正在对这个确切的主题进行一些研究，我发现一项研究引用了 5 个主要好处：

1.  易于获取信息
2.  简化内部沟通
3.  提高最终用户的生产力
4.  优化的文档管理实践
5.  节省 IT 时间

抱歉，如果这变得有点漫无边际。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-09-19T13:30:01.100

以前的答案描述了共享点是什么，但没有很好地描述它为什么受欢迎。是的，它为您提供了开箱即用的所有整洁的文档管理内容。是的，它与 Office 紧密集成。

OOB 功能占整个故事的 1/10。Sharepoint 公开了一个全面的 .Net 对象模型，可让您根据自己的喜好自定义事物。人们正在使用 MOSS 2007 编写*令人惊奇的*事情。使用对象模型，您可以通过代码构建和自定义站点，以响应外部事件。您可以编写使用内部（共享点）和外部数据的自定义“Web 部件”（托管在特殊页面上的控件）。

查看[Sharepoint 博客](http://www.sharepointblogs.com/)，看看人们在用它做什么。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-18T01:09:00.260

这是一个合作网站。团队中的所有成员都可以更新单个日历并将共享文档上传到单个存储库。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-17T04:12:01.753

SharePoint 是我考虑利用[自杀摊位](http://en.wikipedia.org/wiki/Suicide_booth)的原因。

说真的，其余的答案都是正确的。WSS 3.0 和 MOSS 2007 之间的差异通常会让人们感到困惑（例如，“当 WSS 免费时，为什么要为 MOSS 付费？”）。SharePoint 是一个非常复杂和丰富的产品，它集成到其他 Microsoft 应用程序中，例如 Project Server 2007 和 Team Foundation Server。

你为什么要关心它？这取决于。经验丰富的 SharePoint 开发人员和管理员有很多机会。如果您决定投入大量精力来学习它，它很快就会成为您职业生涯的唯一焦点。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-18T01:34:37.267

我认为在这种情况下[维基百科](http://en.wikipedia.org/wiki/Windows_SharePoint_Services)是正确的

> Windows SharePoint Services (WSS) 是 Microsoft SharePoint 的基本部分，通过 Web 门户提供协作和文档管理功能，为共享文档提供集中存储库，以及基于浏览器的管理和管理。它允许创建文档库，这些文档库是可以共享以进行协作编辑的文件集合。SharePoint 为库中的文档提供访问控制和修订控制。

简而言之，Sharepoint 是关于企业管理和协作功能的。贵公司有 Windows 2003 服务器吗？干得好。WSS 3.0 在这里启动并运行。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-18T01:14:00.217

Microsoft Office Sharepoint Server (MOSS) 是两个先前产品 Microsoft SharePoint 和 Microsoft 内容管理系统的组合。

它具有大量开箱即用的功能，这些功能对于任何单个系统都是非常理想的，包括托管具有可自定义元数据的文件。为最终用户启用的页面和文件发布、出色的搜索……不胜枚举。

从本质上讲，它旨在增强和组织整个企业的协作活动，利用组织现有的 Office 应用程序来创建企业系统。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-04-21T18:14:39.093

Sharepoint，MS OFFICE 代理，大约在 2003 年...

请记住，当您通过电子邮件将该单词文档的副本发送给整个公司时，这就是 sharepoint 的用途，但显然您错过了介绍性的 gomeeting 培训课程。

# winapi - 诊断 Win32 程序中的死锁

> ID：89112
> 
> 赞同：5
> 
> 时间：2008-09-18T01:10:32.393
> 
> 标签：winapi, windbg, deadlock, production

调试由于 Win32 生产过程中的死锁而导致的明显挂起的步骤和技术是什么。我听说 WinDbg 可以用于此目的，但您能否提供有关如何实现此目的的明确提示？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T01:15:25.300

这篇[文章](http://blogs.msdn.com/carloc/archive/2007/10/08/ok-now-how-do-i-capture-my-dump.aspx)应该让您开始使用各种选项..检查标记为调试的帖子..

[关于调试死锁](http://www.debuginfo.com/articles/easywindbg.html#debugdeadlocks)的另一篇有用的文章..

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T01:22:58.480

如果您可以访问源代码和内存转储（或实时调试会话），那么调试真正的死锁实际上很容易。

您所做的就是查看线程，并找到正在等待某种共享资源的线程（例如挂起等待`WaitForSingleObject`）。一般来说，从那里找出两个或多个线程相互锁定的问题，然后您只需要找出哪个线程破坏了锁定层次结构。

如果您无法轻松确定哪些线程被锁定，请使用本文中显示的方法[来](http://www.debuginfo.com/articles/easywindbg.html#debugdeadlocks)跟踪每个线程的锁链。当您进入循环时，循环中的线程就是死锁的线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T12:00:35.423

如果你很懒，你可以安装 Application Verifier，然后添加你的模块并从基本测试中选择“锁”。然后您可以在任何调试器下运行您的应用程序。
如果发生临界区死锁，您可以立即找到原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T01:14:33.913

您使用的是什么语言/IDE？

在 .Net 中，您可以查看应用程序的线程：Debug->Windows->Threads 或 Ctrl+Alt+H

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-18T01:15:39.760

调试死锁可能很棘手。我通常会进行某种日志记录并查看日志停止的位置。我使用 OutputDebugString() 记录到文件或调试控制台。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-18T01:23:11.147

最好的办法是从添加日志语句开始。一般来说，我只建议围绕死锁的共享资源，但通常添加它们可能会指向您未预料到的情况或代码区域。广为人知的 stackoverflow.com 数据库问题实际上是 log4net！stackoverflow 团队从未怀疑过 log4net，只有通过检查日志（讽刺地）才表明了这一点。我最初会放弃任何复杂的工具，例如 WinDgb，因为恕我直言，使用它们不是很直观。

# windows - 当 DocumentRoot 指向两个不同的驱动器时，Apache 给了我 403 Access Forbidden

> ID：89118
> 
> 赞同：55
> 
> 时间：2008-09-18T01:12:08.037
> 
> 标签：windows, apache, virtualhost, http-status-code-403

尝试在文档根位于与 apache 所在驱动器不同的驱动器上的虚拟主机下打开页面时，我收到 403 访问被禁止。我使用 apachefriends 版本安装。这是我的 httpd-vhosts.conf 文件：

```
 NameVirtualHost 127.0.0.1

<VirtualHost 127.0.0.1>
  ServerName foo.localhost
  DocumentRoot "C:/xampp/htdocs/foo/public"
</VirtualHost>

<VirtualHost 127.0.0.1>
  ServerName bar.localhost
  DocumentRoot "F:/bar/public"
</VirtualHost> 
```

在我的浏览器中打开 bar.localhost 时，Apache 给了我 403 Access Forbidden。我尝试设置许多不同的访问权限，甚至是每个人的全部权限，但我尝试过的没有任何帮助。

编辑：谢谢！以供将来参考，在其中添加“选项索引”以显示目录索引。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-09-22T15:41:00.733

你不需要

```
Options Indexes FollowSymLinks MultiViews Includes ExecCGI
AllowOverride All
Order Allow,Deny
Allow from all
Require all granted 
```

你唯一需要的是...

```
Require all granted 
```

...在目录部分内。

参见 Apache 2.4 升级端：

[http://httpd.apache.org/docs/2.4/upgrading.html](http://httpd.apache.org/docs/2.4/upgrading.html)

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-09-18T12:00:28.867

在某个地方，您需要告诉 Apache 允许人们查看该目录的内容。

```
<Directory "F:/bar/public">
    Order Allow,Deny
    Allow from All
    # Any other directory-specific stuff
</Directory> 
```

[更多信息](http://httpd.apache.org/docs/2.1/mod/core.html#directory)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2012-09-20T19:36:56.107

对于**Apache 2.4.2** ：当我尝试从我的 iPhone 在 WiFi 上访问我的 Windows 7 桌面上的 WAMP 时，我得到了*403: Forbidden 。*在一个[博客上](http://dabase.com/blog/AH01630:_client_denied_by_server_configuration/)，我找到了解决方案 -在*<Directory>*部分的*Allow all*之后添加**Require all grant 。**这就是我的*<Directory>*部分在 <VirtualHost> 中的样子

 ***```
<Directory "C:/wamp/www">
    Options Indexes FollowSymLinks MultiViews Includes ExecCGI
    AllowOverride All
    Order Allow,Deny
    Allow from all
    Require all granted
</Directory> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-05T15:32:37.677

我已经通过从以下代码中删除它来修复它

**C:\wamp\bin\apache\apache2.4.9\conf\extra\httpd-vhosts.conf**文件

```
<VirtualHost *:80>
    ServerAdmin webmaster@dummy-host.example.com
    DocumentRoot "c:/Apache24/docs/dummy-host.example.com"
    ServerName dummy-host.example.com
    ServerAlias www.dummy-host.example.com
    ErrorLog "logs/dummy-host.example.com-error.log"
    CustomLog "logs/dummy-host.example.com-access.log" common
 </VirtualHost>

<VirtualHost *:80>
    ServerAdmin webmaster@dummy-host2.example.com
    DocumentRoot "c:/Apache24/docs/dummy-host2.example.com"
    ServerName dummy-host2.example.com
    ErrorLog "logs/dummy-host2.example.com-error.log"
    CustomLog "logs/dummy-host2.example.com-access.log" common
</VirtualHost> 
```

并添加

```
<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    DocumentRoot "c:/wamp/www"
    ServerName localhost
    ErrorLog "logs/localhost-error.log"
    CustomLog "logs/localhost-access.log" common
</VirtualHost> 
```

它的作用就像魅力一样

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-24T16:16:23.447

解决了 403：访问 localhost 时被禁止。使用端口 80,443,3308（后者用于处理与 MySQL 服务器安装的冲突） Windows 10、XAMPP 7.4.1、Apache 2.4.x 我的 Web 文件位于单独的文件夹中。

httpd.conf - 查找这些行并将其设置在您的文件所在的位置，我的是 web 文件夹。

```
DocumentRoot "C:/web"
<Directory "C:/web"> 
```

更改了这 2 行。

```
<VirtualHost *:80>
 ServerAdmin webmaster@localhost.com
 DocumentRoot "C:/web/project1"
 ServerName project1.localhost
 <Directory "C:/web/project1">
  Order allow,deny
  allow from all
 </Directory>
</VirtualHost> 
```

对此

```
<VirtualHost *:80>
 ServerAdmin webmaster@localhost.com
 DocumentRoot "C:/web/project1"
 ServerName project1.localhost
 <Directory "C:/web/project1">
  Require all granted
 </Directory>
</VirtualHost> 
```

在主机文件 C:\Windows\System32\drivers\etc\hosts 文件中添加您的详细信息

```
127.0.0.1 localhost
127.0.0.1 project1.localhost 
```

停止启动 XAMPP，然后单击 Apache admin（或 localhost），现在会显示精彩的 XAMPP 仪表板！并在 project1.localhost 访问您的项目

# c# - C#：为什么设置 PropertyValues 有 0 个项目？

> ID：89149
> 
> 赞同：4
> 
> 时间：2008-09-18T01:18:45.073
> 
> 标签：c#, visual-studio, visual-studio-2005

假设设置文件中有 5 个项目（`MySetting1`to `MySetting5`），为什么`PropertyValues`有 0 个项目，而 Properties 有正确的数字？

```
Console.WriteLine( Properties.Settings.Default.PropertyValues.Count); // Displays 0
Console.WriteLine( Properties.Settings.Default.Properties.Count);     // Displays 5 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T01:27:19.187

看来 PropertyValues 是指已设置的 PropertyValues 的数量。如果您调用 Save()，您指定的默认值不会被视为已设置并且不会存储到用户配置中。

```
Console.WriteLine(Settings.Default.PropertyValues.Count.ToString());
Console.ReadLine();
Settings.Default.Setting = "abc";
Console.WriteLine(Settings.Default.PropertyValues.Count.ToString());
Console.ReadLine(); 
```

产生以下输出：

0

1

# architecture - 使用短路评估的好处

> ID：89154
> 
> 赞同：10
> 
> 时间：2008-09-18T01:19:51.420
> 
> 标签：architecture, pipeline

```
boolean a = false, b = true;
if ( a && b ) { ... }; 
```

在大多数语言中，`b`不会被评估，因为`a`它是假的，所以`a && b`不可能是真的。我的问题是，就架构而言，短路不会更慢吗？在管道中，您是否只是在等待获得 a 的结果以确定是否应评估 b 时停止？做嵌套ifs会更好吗？这甚至有帮助吗？

另外，有谁知道短路评估通常被称为什么？这个问题是在我发现我的编程朋友从未听说过短路评估并表示它不常见，在许多语言中都没有，并且在管道中效率低下之后出现的。最后一个我不确定，所以请教各位！

好的，我想一个不同的例子来解释我的朋友可能来自哪里。他认为，由于并行评估如下语句：

```
(a) if ( ( a != null ) && ( a.equals(b) ) ) { ... } 
```

将使系统崩溃，没有短路的架构（因此不允许上述语句）在处理如下语句时会更快：

```
(b) if ( ( a == 4 ) && ( b == 5 ) ) 
```

因为如果它不能并行执行 (a)，它就不能并行执行 (b)。在这种情况下，允许短路的语言比不允许短路的语言慢。

我不知道这是不是真的。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T01:24:48.553

短路评估以与 if 语句相同的方式翻译成汇编语言的分支（分支基本上是 goto），这意味着它不会比 if 语句慢。

分支通常不会使流水线停止，但处理器会猜测分支是否被采用，如果处理器错误，它将不得不刷新所有发生的事情，因为它从流水线中做出了错误的猜测。

短路评估也是它最常见的名称，并且在大多数语言中都以某种形式出现。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-18T01:55:13.143

短路布尔表达式完全等同于某些嵌套的 if 集合，因此与它一样有效。

如果 b 没有副作用，它仍然可以与 a 并行执行（对于“并行”的任何值，包括流水线）。

如果 b 具有在分支预测失败时 CPU 架构无法取消的副作用，那么是的，这可能需要延迟，如果始终评估双方，则不会存在延迟。因此，如果您确实发现短路运算符会在您的代码中造成性能瓶颈，则值得关注，但不值得担心。

但是短路用于控制流，以节省不必要的工作。这在我使用过的语言中很常见，例如 Perl 成语：

```
open($filename) or die("couldn't open file"); 
```

贝壳成语：

```
do_something || echo "that failed" 
```

或 C/C++/Java/etc 成语：

```
if ((obj != 0) && (obj->ready)) { do_something; } // not -> in Java of course. 
```

在所有这些情况下，您都需要短路，以便仅在 LHS 指示应该这样做时才评估 RHS。在这种情况下，将性能与错误的替代代码进行比较是没有意义的！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T01:25:43.543

老实说，我不会担心它。测试布尔值*真的很快*。只有当第二个表达式有副作用时，短路才会变得有趣/有用：

```
if ( ConfirmAction() && DestroyAllData() )
   Reboot(); 
```

...或取决于第一个测试：

```
if ( myDodgyVar != null && myDodgyVar.IsActive() )
   DoSomethingWith(myDodgyVar); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-21T19:00:09.167

**支持短路的语言：**

Ada、Eiffel、ALGOL 68、C1、C++、C#、Java、R、Erlang、标准 ML、Javascript、MATLAB、Lisp、Lua、Scheme、OCaml、Haskell、Pascal、Perl、Ruby、PHP、Python、Smalltalk、Visual Basic 。网

取自[短路评估](http://en.wikipedia.org/wiki/Short-circuit_evaluation)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T01:36:56.887

VB.Net 有不同的语法，具体取决于您是否希望它短路。由于遗留原因，默认行为是不短路。语法如下

非短路

```
IF A And B THEN
    ...
END IF 
```

短路

```
IF A AndAlso B THEN
    ...
END IF 
```

如果要短路 OR 语句，可以使用 Or / OrElse。在以下情况下这真的很好

```
If MyObj IsNot Nothing AndAlso MyObj.Value < SomeValue Then
    ....
End If 
```

就我个人而言，虽然我知道短路可以加快速度，但这绝对不是仅仅看代码就能明显看出的。我可以看到一个没有经验的开发人员对这种行为感到困惑。根据优化级别的编译器标志，它甚至看起来可能会发生或不会发生。我喜欢 VB 对您实际想要完成的行为的详细说明。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T01:27:23.257

首先，你的朋友错了。短路评估（又名最小评估）在大多数语言中都可用，并且比并行语言的嵌套 if 更好（在这种情况下，返回的第一个条件将导致执行继续）

在任何情况下，即使在直接的非并行语言中，我也看不到嵌套 if 会更快，因为执行会阻塞，直到评估第一个条件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T01:23:54.547

如果没有停顿，嵌套怎么可能？实际上，如果 a 和 b 都是变量而不是具有副作用的表达式，它们可以由一个好的编译器并行加载。除了增加行数之外，使用更多 if 没有任何好处。真的，这将是最糟糕的第二次猜测编译器。

这称为短路评估。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T01:25:44.823

我使用的一个有用的短路是这样的：

```
if (a != null && a.equals(somevalue)) {
    ... do something.
} 
```

在我看来，这是非常可读的，并且功能非常好。一般来说，我尽量避免过多的嵌套，因为它会导致丑陋的代码。

我的所有意见。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T01:25:51.030

大多数语言都会对布尔表达式进行短路评估。我一直听说它被称为短路评估。

问题中的示例是一个非常简单的示例，并没有真正提供太多的性能优势。当表达式计算复杂时，性能优势就会出现。

作为一个很好的例子，想象一个游戏程序具有以下内容：

```
if (someObject.isActive() && someOtherObject.isActive() && CollisionDetection.collides(someObject, someOtherObject) {
  doSomething();
} 
```

在这种情况下，碰撞检测比主动检查要昂贵得多。如果系统中有很多不活动的对象，将会有显着的性能提升。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T01:29:03.143

短路或最小评估只是嵌套 if 的语法糖。假设它效率低下或导致停顿是过早优化的一种情况。在这一点上，大多数编译器都足够智能，可以正确解释和优化这些语句。使用这些语句可以大大减少嵌套，从而提高代码的可读性，这应该是你的首要目标。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T01:34:51.773

关于短路是否有效，流水线不太可能对性能产生太大影响。在可能产生影响的情况下，只要这些测试没有副作用，就没有什么可以阻止编译器并行测试多个条件。此外，现代 CPU 有多种机制可用于提高分支代码的流水线性能。

嵌套的 if 将具有与短路 && 相同的效果。

“短路评估”是它最常见的名称，您的朋友认为它不常见是错误的；这很常见。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T01:24:35.230

根据上下文，它也可以称为“守卫”。

而且我几乎在我工作过的每一种语言中都看到了它——接近十几种。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T01:26:11.373

我对流水线一无所知，但短路评估是许多语言的共同特征（这也是我所知道的名称）。在 C 中，&& 和其他运算符定义一个[序列点](http://en.wikipedia.org/wiki/Sequence_point)，就像 ; 运算符确实如此，所以我看不出短路评估比仅使用多个语句效率低多少。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T01:28:10.230

我只听说它是短路。在管道中，下一个操作是否取决于 if 语句的结果？如果是这种情况，这将更加优化，因此它不必每次都测试两个值。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T01:31:10.330

单个线程是连续的，所以如果你有两个 if，当然第一个会在第二个之前被评估，所以我看不出有什么区别。我使用条件与运算符（这就是 && 被称为 afaik）比嵌套 if 更多。如果我想检查可能需要一段时间才能评估的东西，我先做简单的测试，然后在条件 and 之后做更难的测试。

```
a = obj.somethingQuickToTest() && obj.somethingSlowToTest();
```

似乎没有什么不同

```
a = false;
if(obj.somethingQuickToTest())
   a = obj.somethingSlowToTest();
```

# asp.net - Gridview编辑上的自动完成文本框

> ID：89156
> 
> 赞同：2
> 
> 时间：2008-09-18T01:20:34.133
> 
> 标签：asp.net, ajax, gridview, autocomplete

如何在 ASP.Net Gridview 上实现自动完成功能？谁能指出我要去哪里实现这一目标？如果需要的话，我愿意使用非.Net ajax 控件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T15:17:43.933

您将需要使用 AJAX 框架（我经常推荐使用[JQuery](http://www.jquery.com/)），该框架将提供显示下拉框的功能。然后，您将需要创建一个单独的页面（或 Web 服务）以返回所有可能的值以显示在自动完成下拉菜单中。

为了节省性能，我建议仅在用户输入 2 或 3 个字母后才启动自动完成功能。然后这些可以通过 JavaScript 传递给支持的 to proivde 值以显示在下拉列表中。

后端可以使用简单的 CSV、JSON、XML Web 服务等与 JavaScript 通信。有关示例，请参见[http://www.pengoworks.com/workshop/jquery/autocomplete.htm](http://www.pengoworks.com/workshop/jquery/autocomplete.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-29T18:31:56.593

Scriptaculous 有一个很好的自动完成组件。它建立在prototype.js 之上。

我用它来显示带有格式化文本和图像等的自动完成列表。从这个意义上说，我认为它比 ASP.NET AJAX 实现更灵活。

文档[http://wiki.github.com/madrobby/scriptaculous/ajax-autocompleter](http://wiki.github.com/madrobby/scriptaculous/ajax-autocompleter)

下载[http://script.aculo.us/downloads](http://script.aculo.us/downloads)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T03:15:39.643

AJAX 控件工具包提供[自动完成功能](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx)，但需要 Web 服务才能工作。如果没有可以使用的 asmx，您总是可以编写自己的 asmx。

否则，有各种各样的 JS 和 jQuery 示例： [http ://www.javascript-examples.com/autocomplete-demo/](http://www.javascript-examples.com/autocomplete-demo/)

# python - 在Python中，从列表中删除重复项以使所有元素都是唯一的*同时保留顺序*的最快算法是什么？

> ID：89178
> 
> 赞同：45
> 
> 时间：2008-09-18T01:25:21.860
> 
> 标签：python, algorithm, list

例如：

```
>>> x = [1, 1, 2, 'a', 'a', 3]
>>> unique(x)
[1, 2, 'a', 3] 
```

假设列表元素是可散列的。

**澄清：**结果应保留列表中的第一个重复项。例如，[1, 2, 3, 2, 3, 1] 变为 [1, 2, 3]。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-18T01:41:18.170

```
def unique(items):
    found = set()
    keep = []

    for item in items:
        if item not in found:
            found.add(item)
            keep.append(item)

    return keep

print unique([1, 1, 2, 'a', 'a', 3]) 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-18T05:14:19.750

使用：

```
lst = [8, 8, 9, 9, 7, 15, 15, 2, 20, 13, 2, 24, 6, 11, 7, 12, 4, 10, 18, 13, 23, 11, 3, 11, 12, 10, 4, 5, 4, 22, 6, 3, 19, 14, 21, 11, 1, 5, 14, 8, 0, 1, 16, 5, 10, 13, 17, 1, 16, 17, 12, 6, 10, 0, 3, 9, 9, 3, 7, 7, 6, 6, 7, 5, 14, 18, 12, 19, 2, 8, 9, 0, 8, 4, 5] 
```

并使用 timeit 模块：

```
$ python -m timeit -s 'import uniquetest' 'uniquetest.etchasketch(uniquetest.lst)' 
```

等等其他各种功能（我以他们的海报命名），我有以下结果（在我的第一代英特尔 MacBook Pro 上）：

```
Allen:                  14.6 µs per loop [1]
Terhorst:               26.6 µs per loop
Tarle:                  44.7 µs per loop
ctcherry:               44.8 µs per loop
Etchasketch 1 (short):  64.6 µs per loop
Schinckel:              65.0 µs per loop
Etchasketch 2:          71.6 µs per loop
Little:                 89.4 µs per loop
Tyler:                 179.0 µs per loop 
```

[1] 请注意，Allen 修改了列表 - 我相信这已经扭曲了时间，因为该`timeit`模块运行代码 100000 次，其中 99999 次与无重复列表一起运行。

* * *

**总结**：使用集合的直接实现胜过令人困惑的单行代码:-)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-11-12T00:04:22.647

**更新**：[在 Python3.7+ 上](https://stackoverflow.com/a/39835527/4279)：

```
>>> list(dict.fromkeys('abracadabra'))
['a', 'b', 'r', 'c', 'd'] 
```

* * *

^(旧答案：)

这是迄今为止最快的解决方案（对于以下输入）：

```
def del_dups(seq):
    seen = {}
    pos = 0
    for item in seq:
        if item not in seen:
            seen[item] = True
            seq[pos] = item
            pos += 1
    del seq[pos:]

lst = [8, 8, 9, 9, 7, 15, 15, 2, 20, 13, 2, 24, 6, 11, 7, 12, 4, 10, 18, 
       13, 23, 11, 3, 11, 12, 10, 4, 5, 4, 22, 6, 3, 19, 14, 21, 11, 1, 
       5, 14, 8, 0, 1, 16, 5, 10, 13, 17, 1, 16, 17, 12, 6, 10, 0, 3, 9, 
       9, 3, 7, 7, 6, 6, 7, 5, 14, 18, 12, 19, 2, 8, 9, 0, 8, 4, 5]
del_dups(lst)
print(lst)
# -> [8, 9, 7, 15, 2, 20, 13, 24, 6, 11, 12, 4, 10, 18, 23, 3, 5, 22, 19, 14, 
#     21, 1, 0, 16, 17] 
```

字典查找比 Python 3 中的集合稍快。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-09-18T01:33:44.333

最快的取决于您的列表中有多少百分比是重复的。如果它几乎都是重复的，只有很少的独特项目，那么创建一个新列表可能会更快。如果它主要是独特的项目，从原始列表（或副本）中删除它们会更快。

这是一个用于修改列表的方法：

```
def unique(items):
  seen = set()
  for i in xrange(len(items)-1, -1, -1):
    it = items[i]
    if it in seen:
      del items[i]
    else:
      seen.add(it) 
```

在索引上向后迭代可确保删除项目不会影响迭代。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-18T10:17:44.777

这是我发现的最快的就地方法（假设有很大一部分重复）：

```
def unique(l):
    s = set(); n = 0
    for x in l:
        if x not in s: s.add(x); l[n] = x; n += 1
    del l[n:] 
```

这比它所基于的 Allen 的实现快 10%（与 timeit.repeat 计时，由 psyco 编译的 JIT）。它保留任何重复的第一个实例。

repton-infinity：如果你能确认我的时间安排，我会很感兴趣。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-27T15:54:03.440

基于生成器的强制性变体：

```
def unique(seq):
  seen = set()
  for x in seq:
    if x not in seen:
      seen.add(x)
      yield x 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-10-21T01:10:05.853

这可能是最简单的方法：

```
list(OrderedDict.fromkeys(iterable)) 
```

从 Python 3.5 开始，OrderedDict 现在是用 C 实现的，所以这是现在最短、最干净、最快的。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-18T01:30:50.410

取自[http://www.peterbe.com/plog/uniqifiers-benchmark](http://www.peterbe.com/plog/uniqifiers-benchmark)

```
def f5(seq, idfun=None):  
    # order preserving 
    if idfun is None: 
        def idfun(x): return x 
    seen = {} 
    result = [] 
    for item in seq: 
        marker = idfun(item) 
        # in old Python versions: 
        # if seen.has_key(marker) 
        # but in new ones: 
        if marker in seen: continue 
        seen[marker] = 1 
        result.append(item) 
    return result 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-18T01:59:05.833

单线：

```
new_list = reduce(lambda x,y: x+[y][:1-int(y in x)], my_list, []) 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-04-09T13:11:48.107

为此的就地单线：

```
>>> x = [1, 1, 2, 'a', 'a', 3]
>>> [ item for pos,item in enumerate(x) if x.index(item)==pos ]
[1, 2, 'a', 3] 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2013-12-26T15:38:50.320

这是最快的一个，比较了这个[冗长讨论](http://www.peterbe.com/plog/uniqifiers-benchmark)中的所有内容和这里给出的其他答案，参考这个[基准](http://www.peterbe.com/plog/uniqifiers-benchmark/uniqifiers_benchmark.py)。它比讨论中最快的函数快了 25% `f8`，. 感谢大卫柯比的想法。

```
def uniquify(seq):
    seen = set()
    seen_add = seen.add
    return [x for x in seq if x not in seen and not seen_add(x)] 
```

一些时间比较：

```
$ python uniqifiers_benchmark.py 
* f8_original 3.76
* uniquify 3.0
* terhorst 5.44
* terhorst_localref 4.08
* del_dups 4.76 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-09-18T01:43:03.703

你实际上可以在 Python 中做一些非常酷的事情来解决这个问题。您可以创建一个列表推导式，该列表推导式将在构建时引用自身。如下：

```
 # remove duplicates...
   def unique(my_list):
       return [x for x in my_list if x not in locals()['_[1]'].__self__] 
```

编辑：**我删除了“自我”，它适用于 Mac OS X、Python 2.5.1。**

_[1] 是 Python 对新列表的“秘密”引用。当然，上述内容有点混乱，但您可以根据需要调整它以满足您的需求。例如，您实际上可以编写一个返回对推导的引用的函数；它看起来更像：

```
return [x for x in my_list if x not in this_list()] 
```

* * *

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-18T02:06:40.700

重复项是否必须首先出现在列表中？就查找元素而言，没有任何开销，但在添加元素时会有更多开销（尽管开销应该是 O(1) ）。

```
>>> x  = []
>>> y = set()
>>> def add_to_x(val):
...     if val not in y:
...             x.append(val)
...             y.add(val)
...     print x
...     print y
... 
>>> add_to_x(1)
[1]
set([1])
>>> add_to_x(1)
[1]
set([1])
>>> add_to_x(1)
[1]
set([1])
>>> 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-12-29T17:11:51.973

删除重复项并保留顺序：

这是一个快速的 2-liner，它利用了列表理解和字典的内置功能。

```
x = [1, 1, 2, 'a', 'a', 3]

tmpUniq = {} # temp variable used below 
results = [tmpUniq.setdefault(i,i) for i in x if i not in tmpUniq]

print results
[1, 2, 'a', 3] 
```

dict.setdefaults() 函数返回值并将其直接添加到列表理解中的临时字典中。使用内置函数和 dict 的哈希值将有助于最大限度地提高流程效率。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-18T13:23:05.673

这里有一些很棒的、有效的解决方案。但是，对于那些不关心绝对最有效的`O(n)`解决方案的人，我会选择简单的单线`O(n^2*log(n))`解决方案：

```
def unique(xs):
    return sorted(set(xs), key=lambda x: xs.index(x)) 
```

或更有效的两线`O(n*log(n))`解决方案：

```
def unique(xs):
    positions = dict((e,pos) for pos,e in reversed(list(enumerate(xs))))
    return sorted(set(xs), key=lambda x: positions[x]) 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-18T04:07:21.347

python中的has_key是O(1)。从哈希中插入和检索也是 O(1)。循环遍历 n 个项目两次，所以 O(n)。

```
def unique(list):
  s = {}
  output = []
  for x in list:
    count = 1
    if(s.has_key(x)):
      count = s[x] + 1

    s[x] = count
  for x in list:
    count = s[x]
    if(count > 0):
      s[x] = 0
      output.append(x)
  return output 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-18T01:35:33.130

O(n) 如果 dict 是哈希，O(nlogn) 如果 dict 是树，并且简单，固定。感谢马修的建议。抱歉，我不知道基础类型。

```
def unique(x):    
  output = []
  y = {}
  for item in x:
    y[item] = ""

  for item in x:
    if item in y:
      output.append(item)

  return output 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2011-10-21T01:07:11.860

以下是*itertools*文档中的两个配方：

```
def unique_everseen(iterable, key=None):
    "List unique elements, preserving order. Remember all elements ever seen."
    # unique_everseen('AAAABBBCCDAABBB') --> A B C D
    # unique_everseen('ABBCcAD', str.lower) --> A B C D
    seen = set()
    seen_add = seen.add
    if key is None:
        for element in ifilterfalse(seen.__contains__, iterable):
            seen_add(element)
            yield element
    else:
        for element in iterable:
            k = key(element)
            if k not in seen:
                seen_add(k)
                yield element

def unique_justseen(iterable, key=None):
    "List unique elements, preserving order. Remember only the element just seen."
    # unique_justseen('AAAABBBCCDAABBB') --> A B C D A B
    # unique_justseen('ABBCcAD', str.lower) --> A B C A D
    return imap(next, imap(itemgetter(1), groupby(iterable, key))) 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-18T01:29:06.903

我没有使用 python 的经验，但是一种算法是对列表进行排序，然后删除重复项（通过与列表中的先前项目进行比较），最后通过与旧列表进行比较来找到新列表中的位置。

更长的答案：[http ://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/52560](http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/52560)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-18T01:32:47.457

```
>>> def unique(list):
...   y = []
...   for x in list:
...     if x not in y:
...       y.append(x)
...   return y 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-19T09:42:20.657

如果您在 Terhost 的回答中从对 set() 的调用中取出空列表，您会获得一点速度提升。

将：found = set([]) 更改
为：found = set()

但是，您根本不需要该集合。

```
def unique(items):
    keep = []

    for item in items:
        if item not in keep:
            keep.append(item)

    return keep 
```

使用 timeit 我得到了这些结果：

有 set([]) -- 4.97210427363
有 set() -- 4.65712377445
没有设置 -- 3.44865284975

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2014-09-21T11:26:53.927

```
x = [] # Your list  of items that includes Duplicates

# Assuming that your list contains items of only immutable data types

dict_x = {} 

dict_x = {item : item for i, item in enumerate(x) if item not in dict_x.keys()}
# Average t.c. = O(n)* O(1) ; furthermore the dict comphrehension and generator like behaviour of enumerate adds a certain efficiency and pythonic feel to it.

x = dict_x.keys() # if you want your output in list format 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2008-09-18T01:54:40.027

```
>>> x=[1,1,2,'a','a',3]
>>> y = [ _x for _x in x if not _x in locals()['_[1]'] ]
>>> y
[1, 2, 'a', 3] 
```

“locals()['_[1]']”是正在创建的列表的“秘密名称”。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2008-09-18T08:51:32.660

I don't know if this one is fast or not, but at least it is simple.

Simply, convert it first to a set and then again to a list

```
def unique(container):
  return list(set(container)) 
```

* * *

## 回答 #25

> 赞同：-2
> 
> 时间：2008-09-18T01:29:11.820

我没有做任何测试，但一种可能的算法可能是创建第二个列表，并遍历第一个列表。如果项目不在第二个列表中，请将其添加到第二个列表中。

```
x = [1, 1, 2, 'a', 'a', 3]
y = []
for each in x:
    if each not in y:
        y.append(each) 
```

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2008-09-18T05:08:13.367

一通。

```
a = [1,1,'a','b','c','c']

new_list = []
prev = None

while 1:
    try:
        i = a.pop(0)
        if i != prev:
            new_list.append(i)
        prev = i
    except IndexError:
        break 
```

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2008-11-11T00:32:18.847

```
a=[1,2,3,4,5,7,7,8,8,9,9,3,45]

def unique(l):

    ids={}
    for item in l:
        if not ids.has_key(item):
            ids[item]=item
    return  ids.keys()
print a

print unique(a) 
```

插入元素将花费 theta(n) 检索元素是否退出将花费恒定时间测试所有项目也将花费 theta(n)，因此我们可以看到此解决方案将采用 theta(n)。请记住，python 中的字典是由哈希表实现的。

# cvs - CVS 签出到目录

> ID：89181
> 
> 赞同：17
> 
> 时间：2008-09-18T01:25:50.173
> 
> 标签：cvs, vcs-checkout, tortoisecvs

如何从 CVS 中签出特定目录并省略指向该目录的树？

前任。

我想结帐到这个目录 C:/WebHost/MyWebApp/www

我的 CVS 项目目录结构是 MyWebApp/Trunk/www

如何省略 Trunk 和 MyWebApp 目录？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-18T01:44:10.143

使用 cvs `-d/cvsroot checkout -d directory project/path/directory`。`-d`如果您使用环境设置根目录，则可以省略第一个。这称为“缩短路径”，可以通过`-N`选项 to避免`checkout`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T01:51:54.713

CVS 通过文件`.CVS`夹中的文件“绑定”到存储库。每个文件夹都是单独“绑定”的。

这意味着您可以检查完整的内容（或者如果您已经拥有完整的内容），然后将`www`目录剪切/粘贴到其他地方，它将保持链接到正确的 CVS 位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T01:32:22.653

[糟糕，删除了一些错误的废话。] 是的，co -d www 就是你想要的。

您还可以在存储库中设置模块，这样您就可以只签出 www，就好像它是顶级目录一样，但是您必须为每个这样的目录都这样做。

# html - 获取 Flex 应用在网页上的位置？

> ID：89188
> 
> 赞同：0
> 
> 时间：2008-09-18T01:27:19.560
> 
> 标签：html, apache-flex

是否可以在 HTML 页面中获取 Flex 应用程序的 x,y 坐标？我知道您可以使用 ExternalInterface.ObjecID 来获取“Internet Explorer 中对象标记的 id 属性，或 Netscape 中嵌入标记的名称属性”，但我似乎无法通过该步骤。似乎应该有可能获得该嵌入对象的句柄。有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T11:21:17.323

我认为最简单的做法是在 HTML 页面上包含某种 JavaScript 库，比如 jQuery，并使用它的函数来确定 DOM 节点的位置和大小。我或多或少会这样做：

```
var jsCode : String = "function( id ) { return $('#' + id).offset(); }";

var offset : Object = ExternalInterface.call(jsCode, ExternalObject.objectID);

trace(offset.left, offset.top); 
```

请注意，这是 ActionScript 代码，但它通过`ExternalInterface`. 它使用 jQuery，特别是它的`offset`方法，它返回 DOM 节点的左和上偏移量。

`offset`如果您查看了该方法的实现方式并包含该代码来代替对 jQuery 的调用，那么您可以不使用jQuery。这样您就不需要在 HTML 中加载 jQuery，Flex 应用程序将是独立的。我建议使用像 jQuery 这样的库的原因是浏览器做这些事情的方式不同。我不确定计算偏移量是否因浏览器而异，但不受浏览器差异的影响并没有什么坏处。

我的示例中的 JavaScript 是一个匿名函数，因此 embed/object 标记的 ID 可以作为参数传递给它`ExternalInterface.call`，但如果需要，您可以只使用字符串连接：

```
var jsCode : String = "$('#' +" + ExternalInterface.objectID + ").offset()";

var offset : Object = ExternalInterface.call(jsCode); 
```

那也可以，我只是认为第一个版本更优雅。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T01:49:27.760

如果您只是想以外部用户的身份测量它在页面内的位置，那么我唯一想到的就是一个名为 MeasureIt 的 Firefox 扩展，我偶尔会用它来测量网页上的各种情况。

您是否尝试从嵌入页面本身以编程方式执行此操作，如果是，则使用哪种语言？

# sql - LINQ-to-SQL 是否支持可组合查询？

> ID：89193
> 
> 赞同：5
> 
> 时间：2008-09-18T01:28:06.360
> 
> 标签：sql, linq, linq-to-sql, code-reuse

作为一个非 C# 精明的程序员，我很好奇 LINQ 查询的评估语义，如下所示：

```
var people = from p in Person
             where p.age < 18
             select p

var otherPeople = from p in people
                  where p.firstName equals "Daniel"
                  select p 
```

假设这`Person`是一个定义`age`and`firstName`字段的 ADO 实体，从数据库的角度来看，这会做什么？具体来说，是否`people`会运行查询以生成内存中的结构，然后由`otherPeople`查询查询？或者`otherPeople`只是从查询中提取数据`people`然后生成一个新的数据库对等查询？那么，如果我遍历这两个查询，会执行多少条 SQL 语句？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T01:34:46.627

它们是可组合的。这是可能的，因为 LINQ 查询实际上是表达式（代码即数据），LINQ 提供程序（如 LINQ-to-SQL）可以评估并生成相应的 SQL。

因为 LINQ 查询是延迟评估的（例如，在您迭代元素之前不会执行），所以您显示的代码实际上不会触及数据库。直到您迭代 otherPeople 或人员才会生成并执行 SQL。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T04:22:04.570

```
var people = from p in Person
             where p.age < 18
             select p 
```

转换为：

```
SELECT [t0].[PersonId], [t0].[Age], [t0].[FirstName]
FROM [dbo].[Person] AS [t0]
WHERE [t0].[Age] < @p0 
```

@p0 作为 18 发送的位置

```
var otherPeople = from p in people
                  where p.firstName equals "Daniel"
                  select p 
```

转换为：

```
SELECT [t0].[PersonId], [t0].[Age], [t0].[FirstName]
FROM [dbo].[Person] AS [t0]
WHERE [t0].[FirstName] = @p0 
```

@p0 以“丹尼尔”的身份发送

```
var morePeople = from p1 in people
                 from p2 in otherPeople
                 where p1.PersonId == p2.PersonId
                 select p1; 
```

转换为：

```
SELECT [t0].[PersonId], [t0].[Age], [t0].[FirstName]
FROM [dbo].[Person] AS [t0], [dbo].[Person] AS [t1]
WHERE ([t0].[PersonId] = [t1].[PersonId]) AND ([t0].[Age] < @p0) AND ([t1].[FirstName] = @p1) 
```

其中@p0 是 18，@p1 是“丹尼尔”

如有疑问，请在 IQueryable 上调用 ToString() 或将 TextWriter 提供给 DataContext 的 Log 属性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T01:35:16.233

是的，生成的查询是组合的。它包括完整的 where 子句。打开 SQL 分析并尝试自己查看。

Linq 通过表达式树做到这一点。第一个 linq 语句产生一个表达式树；它不执行查询。第二个 linq 语句建立在第一个创建的表达式树的基础上。该语句仅在您枚举结果集合时执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T01:33:11.700

`people`并`otherPeople`包含类型的对象`IQueryable<Person>`。

如果您分别对两者进行迭代，它将运行两个查询。如果您只迭代`otherPeople`，它将运行预期的查询，带有两个 where 子句。

如果您`.ToList()`继续`people`并使用`List<Person>`第二个查询中的返回值而不是人员，它将变为 LINQ-to-Objects 并且不执行任何 SQL。

这种行为称为延迟执行。这意味着在需要之前不会进行任何查询。在执行之前，它们只是被操纵以形成最终查询的表达式树。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T01:33:54.630

当您尝试访问最终结果时，将执行这两个查询。您可以尝试查看从 DataContext 对象属性生成的原始 SQL。

# c# - Convert.ToDecimal(string) 和 Decimal.Parse(string) 之间的区别

> ID：89203
> 
> 赞同：38
> 
> 时间：2008-09-18T01:31:07.803
> 
> 标签：c#, .net

`Convert.ToDecimal(string)`在 C# 中和之间有什么区别`Decimal.Parse(string)`？

在什么情况下你会使用其中一种？

它对性能有什么影响？

在两者之间进行选择时，我还应该考虑哪些其他因素？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-09-18T05:26:23.510

要记住一个重要的区别：

`Convert.ToDecimal``0`如果给定一个`null`字符串，将返回。

`decimal.Parse``ArgumentNullException`如果您要解析的字符串是`null`.

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-09-18T01:33:18.063

来自[bytes.com](http://bytes.com/forum/thread266344.html)：

> Convert 类旨在转换各种类型，因此您可以将更多类型转换为 Decimal，而不是使用只能处理 String 的 Decimal.Parse。另一方面，Decimal.Parse 允许您指定 NumberStyle。
> 
> 十进制和十进制是别名并且是相等的。
> 
> 对于 Convert.ToDecimal(string)，内部调用 Decimal.Parse。
> 
> Morten Wennevik [C# MVP]

由于 Decimal.Parse 由 Convert.ToDecimal 在内部调用，因此如果您有***极端***的性能要求，您可能希望坚持使用 Decimal.Parse，它将保存一个堆栈帧。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-18T01:37:03.720

您可能没有想到的一个因素是`Decimal.TryParse`方法。如果它们无法将字符串转换为正确的十进制格式，则两者都`Convert.ToDecimal`抛出异常。`Parse`TryParse 方法为您提供了一个很好的输入验证模式。

```
decimal result;
if (decimal.TryParse("5.0", out result))
   ; // you have a valid decimal to do as you please, no exception.
else
   ; // uh-oh.  error message time! 
```

这种模式对于错误检查用户输入来说非常棒。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T01:35:39.213

与原始主题相关的一个常见建议 -`TryParse()`如果您不确定输入字符串参数将是正确的数字格式表示，请立即使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-25T08:59:56.760

`Convert.ToDecimal(string)`和之间的主要区别`Decimal.Parse(string)` 是转换处理`Null`而另一个抛出异常

注意：它不会处理空字符串。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-13T21:33:57.967

Convert.ToDecimal 显然并不总是返回 0。在我的 linq 语句中

```
var query = from c in dc.DataContext.vw_WebOrders
select new CisStoreData()
{
       Discount = Convert.ToDecimal(c.Discount)
}; 
```

从小数转换后折扣仍然为空？那是空的。但是，在 Linq 语句之外，对于相同的转换，我确实得到了 0。令人沮丧和烦人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-14T16:55:52.263

知道 Convert.ToDecimal 在大多数情况下是要走的路，因为它处理 NULL，但是，它不能很好地处理空字符串。因此，以下功能可能会有所帮助：

```
'object should be a string or a number
Function ConvertStringToDecimal(ByVal ValueToConvertToDecimal As Object) As Decimal
    If String.IsNullOrEmpty(ValueToConvertToDecimal.ToString) = False Then
        Return Convert.ToDecimal(ValueToConvertToDecimal)
    Else
        Return Convert.ToDecimal(0)
    End If
End Function 
```

# architecture - 函数式编程架构

> ID：89212
> 
> 赞同：40
> 
> 时间：2008-09-18T01:33:11.997
> 
> 标签：architecture, functional-programming

我熟悉面向对象的体系结构，包括使用设计模式和类图进行可视化，并且我知道面向服务的体系结构及其合同和协议绑定，但是**对于用函数式编程语言？**

我知道 FP 已用于大中型项目。保罗格雷厄姆写了雅虎的第一个化身！存储在 Common Lisp 中。一些 lisp 开发系统很复杂。用函数式语言编写的人工智能和金融系统可以变得相当大。它们都至少有某种固有的架构，不过，我想知道它们是否有任何共同点？

基于表达式评估的架构是什么样的？FP 架构是否更具可组合性？

**更新：** Kyle 提醒我[SICP](http://mitpress.mit.edu/sicp/)是这个主题的一个很好的资源。

**更新 2：**我找到了一篇关于这个主题的好帖子： *[函数式编程如何影响你的代码结构？](http://lorgonblog.spaces.live.com/Blog/cns!701679AD17B6D310!511.entry)*

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-18T23:49:52.937

使用函数式语言的项目“架构”中的共同点是，它们往往被分成代数层，而不是传统系统架构意义上的子系统。

有关此类项目的优秀示例，请查看[XMonad](http://xmonad.org/)、[Yi](http://www.haskell.org/haskellwiki/Yi)和[HappS](http://happs.org/)。如果您检查它们的结构，您会发现它们由单子结构层组成，中间有一些组合胶。

另请[参阅 The Scala Experiment](http://www.cs.princeton.edu/~dpw/popl/06/odersky.pdf)论文，该论文概述了一种体系结构，其中系统由抽象其依赖关系的组件组成。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-11-07T04:16:20.633

我目前正在编写“函数式编程中的设计和架构”一书。它描述了纯 FP 世界中存在的许多设计模式和方法（主要语言是 Haskell），但不仅限于此。本书教你如何从零开始构建具有纯状态和非纯状态、多线程、网络、数据库、GUI 的大型应用程序，如何将其分层并获得简单性。它还展示了如何对领域和语言进行建模、如何组织和描述应用程序的架构、如何对其进行测试等等。

主题列表包括：

*   使用图表进行架构建模的方法；
*   需求分析;
*   嵌入式 DSL 领域建模；
*   外部DSL设计和实现；
*   单子作为具有效果的子系统；
*   自由单子作为功能接口；
*   带箭头的 eDSL；
*   使用 Free monadic eDSL 进行控制反转；
*   软件事务内存；
*   镜片；
*   状态、读取器、写入器、RWS、ST 单子；
*   不纯状态：IORef、MVar、STM；
*   多线程和并发域建模；
*   图形用户界面；
*   UML、SOLID、GRASP等主流技术和方法的适用性；
*   与不纯子系统的交互。

这本书基于我正在研究的 Haskell 项目，尤其是 SCADA 应用程序[Andromeda](https://github.com/graninas/Andromeda)。本书的代码可[在此处](https://github.com/graninas/Functional-Design-and-Architecture)获得。虽然这本书正在开发中（它将在 2017 年完成），我可以建议您在[此处](https://docs.google.com/document/d/1Gypzxp13aMpzD7o5XAmgy5zRrchQKrEbJArm6hDmwqk/edit#heading=h.zgk3nhua391m)（Rus）熟悉我的文章“FP 中的设计和架构”。

**更新**

我在网上分享了我的书（前 5 章）。[见 Reddit 上的帖子](https://www.reddit.com/r/haskell/comments/6ck72h/functional_design_and_architecture/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T01:46:50.917

在函数式语言中你会发现最大的共同点是使用函数来存储数据。这有点像在没有对象的对象上使用访问器函数。相反，该函数是在可以访问所需数据的环境中创建的。现在这个函数可以在任何地方传递和使用，并且仍然保留使用数据的能力。

这是一个非常简单的例子。这不是纯粹的功能，因为它确实改变了状态，但它很常见：

```
(define (make-counter)
  (let ((count 0))
    (lambda ()
      (set! count (+ count 1))
      count)))

(define x (make-counter))

(x) returns 1

(x) returns 2

...etc... 
```

所以我们有一个函数，make-counter，它返回另一个函数，里面有计数器的状态。我们可以调用那个新创建的计数器并观察里面的变化。

这就是功能程序的结构。你有将函数作为参数的函数，你有返回隐藏状态函数的函数，等等。这一切都比你自己管理内存要干净得多。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T13:48:01.713

我打印出来并查看了[Ocaml 中的设计模式](http://people.csail.mit.edu/dnj/teaching/6898/projects/vicente-wagner.pdf)，它们使用模块和仿函数（和对象）来重新创建我们习惯的正常设计模式。这很有趣，但我认为他们*过多*地使用对象来真正看到函数式语言的好处。FP 是非常可组合的，这是它的本质的一部分。我想我的简短回答是使用*modules*和*functors*。

我当前的项目非常大，我们通过文件分隔每个模块——ocaml 中的隐式。我也一直在寻找一个综合资源，它可能对项目产生的真正成功的设计有一些不同的观点或想法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T01:50:10.847

我曾参与过一些相当大的功能性项目。他们通常分为两个阵营（至少是我用过的阵营）：

*   极高的可扩展性/可靠性/并发性。事务模型可以非常紧密地构建到语言中。并发 ML 就是一个很好的例子，使用它的项目在并发正确性方面很难出错。
*   解析/修改框架。这些框架所基于的许多设计模式都非常容易用函数式语言来制定/构建/修改。访问者模式就是一个很好的例子。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-24T08:10:33.137

希望不要太切题，但对于浏览这个问题的答案的任何人来说可能很有趣的是Peter Norvig[的动态编程中的设计模式演示文稿。](http://norvig.com/design-patterns/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T20:15:58.507

我认为这可能会有所帮助；

> 一些模式消失了——也就是说，它们被语言特性直接支持，一些模式更简单或有不同的侧重点，还有一些本质上没有变化。

[AIM-2002-005] Gregory T. Sullivan，[可执行设计模式的高级编程语言特性“通过反射获得更好的模式](http://dspace.mit.edu/handle/1721.1/6686)

2002 年 3 月 22 日

> 设计模式一书 [GOF95] 介绍了 24 种经过时间考验的模式，这些模式始终出现在精心设计的软件系统中。每个模式都附有对模式解决的设计问题的描述，以及示例实现代码和设计注意事项。本文探讨了当使用动态、高阶、面向对象的编程语言解决类似问题时，通常被称为“Gang of Four”或“GOF”一书中的模式如何出现。一些模式消失了——也就是说，它们被语言特性直接支持，一些模式更简单或有不同的侧重点，还有一些本质上没有变化。

# .net - 在 .NET 中使用 .qr2 报告？

> ID：89221
> 
> 赞同：3
> 
> 时间：2008-09-18T01:34:02.617
> 
> 标签：.net, reporting, quickreports

我们使用的 ERP 有一堆 QuickReport 格式 (.qr2) 的报告。从我可以搜索的内容来看，Quickreports 有一个 Delphi 接口，但没有 .NET 接口。

任何人都知道是否有（最好是免费/OSS）解决方案可以将 .qr2 报告转换为我可以在 C# 中使用的东西？还是直接阅读这些报告的组件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T13:24:23.720

[Delphi 2005 和 Delphi 2006 支持 .NET 版本的 QuickReports](http://www.qusoft.com/delphilegacy.html)。但是，您必须获得（非免费）“专业”版本的 QuickReports 才能获得 .NET 支持。它不包含在“标准”版本中。Delphi 2005 和 Delphi 2006 都支持 C#，但我从未尝试过 QuickReports 的 .NET 版本，无论是 Delphi for .NET 还是 C#。我不能告诉你它的效果如何。

此外，Qsoft[计划发布他们工具的 C# 版本](http://www.qusoft.com/Roadmap.html)，尽管它似乎落后于计划。

# visual-studio - 是否有转换 .vim 颜色定义文件以在 VS.NET 2008 中使用的工具

> ID：89226
> 
> 赞同：2
> 
> 时间：2008-09-18T01:35:14.440
> 
> 标签：visual-studio, vim, syntax-highlighting

如果您访问以下网站：

[http://www.cs.cmu.edu/~maverick/VimColorSchemeTest/index-c.html](http://www.cs.cmu.edu/~maverick/VimColorSchemeTest/index-c.html)

它有一堆用于 VI 的示例颜色主题。

有谁知道可以获取这些文件并将它们转换为 .vssettings 文件以在 Visual Studio 中使用的工具？

如果没有，那么一些关于格式的好文档怎么样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T01:52:46.707

这是一个可能有帮助的 Visual Studio 主题生成器。

[http://frickinsweet.com/tools/Theme.mvc.aspx](http://frickinsweet.com/tools/Theme.mvc.aspx)

# python - 如何执行程序或调用系统命令？

> ID：89228
> 
> 赞同：5622
> 
> 时间：2008-09-18T01:35:30.273
> 
> 标签：python, shell, terminal, subprocess, command

如何从 Python 脚本中调用外部命令（就像我在 Unix shell 或 Windows 命令提示符下输入的一样）？

* * *

## 回答 #1

> 赞同：5374
> 
> 时间：2008-09-18T01:39:35.257

使用[`subprocess`](https://docs.python.org/library/subprocess.html)标准库中的模块：

```
import subprocess
subprocess.run(["ls", "-l"]) 
```

[`subprocess.run`](https://docs.python.org/library/subprocess.html#subprocess.run)over的优点[`os.system`](https://docs.python.org/library/os.html#os.system)是更灵活（你可以获得[`stdout`](https://docs.python.org/library/subprocess.html#subprocess.CompletedProcess.stdout), [`stderr`](https://docs.python.org/library/subprocess.html#subprocess.CompletedProcess.stderr), [“真正的”状态码](https://docs.python.org/library/subprocess.html#subprocess.CompletedProcess.returncode), 更好的[错误处理](https://docs.python.org/library/subprocess.html#subprocess.CalledProcessError)等等...）。

甚至推荐使用[的文档`os.system`](https://docs.python.org/library/os.html#os.system)`subprocess`：

> 该`subprocess`模块提供了更强大的工具来生成新进程并检索其结果；使用该模块优于使用此功能。有关一些有用的秘诀，请参阅文档中的[用子流程模块替换旧功能](https://docs.python.org/library/subprocess.html#subprocess-replacements)部分。[`subprocess`](https://docs.python.org/library/subprocess.html)

在 Python 3.4 及更早版本上，使用`subprocess.call`代替`.run`：

```
subprocess.call(["ls", "-l"]) 
```

* * *

## 回答 #2

> 赞同：3275
> 
> 时间：2008-09-18T13:11:46.980

调用外部程序的方法总结，包括它们的优缺点：

1.  [`os.system`](https://docs.python.org/3/library/os.html#os.system)将命令和参数传递给系统的 shell。这很好，因为您实际上可以以这种方式一次运行多个命令并设置管道和输入/输出重定向。例如：

    ```
    os.system("some_command < input_file | another_command > output_file") 
    ```

    然而，虽然这很方便，但您必须手动处理 shell 字符的转义，例如空格等。另一方面，这也允许您运行只是 shell 命令而不是实际外部程序的命令。

2.  [`os.popen`](https://docs.python.org/3/library/os.html#os.popen)`os.system`除了它给你一个类似文件的对象，你可以使用它来访问该进程的标准输入/输出之外，它将做同样的事情。popen 还有 3 个其他变体，它们对 i/o 的处理都略有不同。如果您将所有内容都作为字符串传递，那么您的命令将传递给 shell；如果您将它们作为列表传递，那么您无需担心转义任何内容。例子：

    ```
    print(os.popen("ls -l").read()) 
    ```

3.  [`subprocess.Popen`](https://docs.python.org/3/library/subprocess.html#subprocess.Popen). 这旨在替代`os.popen`，但由于如此全面，它的缺点是稍微复杂一些。例如，你会说：

    ```
    print subprocess.Popen("echo Hello World", shell=True, stdout=subprocess.PIPE).stdout.read() 
    ```

    代替

    ```
    print os.popen("echo Hello World").read() 
    ```

    但是很高兴在一个统一的类中拥有所有选项，而不是 4 个不同的 popen 函数。请参阅[文档](https://docs.python.org/3/library/subprocess.html#popen-constructor)。

4.  [`subprocess.call`](https://docs.python.org/3/library/subprocess.html#subprocess.call). 这基本上就像`Popen`类一样，接受所有相同的参数，但它只是等到命令完成并为您提供返回码。例如：

    ```
    return_code = subprocess.call("echo Hello World", shell=True) 
    ```

5.  [`subprocess.run`](https://docs.python.org/3/library/subprocess.html#subprocess.run). 仅限 Python 3.5+。与上面类似，但更灵活，并[`CompletedProcess`](https://docs.python.org/3/library/subprocess.html#subprocess.CompletedProcess)在命令执行完成时返回一个对象。

6.  `os.fork`, `os.exec`,`os.spawn`与它们的 C 语言对应物相似，但我不建议直接使用它们。

该`subprocess`模块可能应该是您使用的。

最后，请注意，对于将最终命令作为字符串传递给 shell 的所有方法，您有责任将其转义。如果您传递的字符串的任何部分都不能完全信任，则会**产生严重的安全隐患。**例如，如果用户正在输入字符串的某些/任何部分。如果您不确定，请仅将这些方法与常量一起使用。为了给您暗示含义，请考虑以下代码：

```
print subprocess.Popen("echo %s " % user_input, stdout=PIPE).stdout.read() 
```

并想象用户输入了一些“ `my mama didnt love me && rm -rf /`”，这可能会擦除整个文件系统。

* * *

## 回答 #3

> 赞同：413
> 
> 时间：2008-09-18T18:20:46.160

典型实现：

```
import subprocess

p = subprocess.Popen('ls', shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
for line in p.stdout.readlines():
    print line,
retval = p.wait() 
```

`stdout`您可以自由地对管道中的数据做任何您想做的事情。事实上，您可以简单地省略这些参数（`stdout=`和`stderr=`），它的行为就像`os.system()`.

* * *

## 回答 #4

> 赞同：265
> 
> 时间：2010-02-12T10:15:34.027

关于将子进程与调用进程分离的一些提示（在后台启动子进程）。

假设您想从 CGI 脚本开始一个长任务。也就是说，子进程的寿命应该比 CGI 脚本执行进程长。

子流程模块文档中的经典示例是：

```
import subprocess
import sys

# Some code here

pid = subprocess.Popen([sys.executable, "longtask.py"]) # Call subprocess

# Some more code here 
```

这里的想法是，您不想在“调用子进程”行中等待，直到 longtask.py 完成。但尚不清楚示例中的“这里有更多代码”行之后会发生什么。

我的目标平台是 FreeBSD，但开发是在 Windows 上，所以我首先在 Windows 上遇到了问题。

在 Windows (Windows XP) 上，父进程在 longtask.py 完成其工作之前不会完成。这不是您在 CGI 脚本中想要的。该问题并非特定于 Python；在 PHP 社区中，问题是一样的。

解决方案是将 DETACHED_PROCESS[进程创建标志](https://msdn.microsoft.com/en-us/library/windows/desktop/ms684863(v=vs.85).aspx)传递给 Windows API 中的底层 CreateProcess 函数。如果你碰巧安装了pywin32，你可以从win32process模块​​导入flag，否则你应该自己定义：

```
DETACHED_PROCESS = 0x00000008

pid = subprocess.Popen([sys.executable, "longtask.py"],
                       creationflags=DETACHED_PROCESS).pid 
```

/* *UPD 2015.10.27* @eryksun 在下面的评论中指出，语义正确的标志是 CREATE_NEW_CONSOLE (0x00000010) */

在 FreeBSD 上，我们还有另一个问题：当父进程结束时，它也结束了子进程。这也不是您想要的 CGI 脚本。一些实验表明问题似乎在于共享 sys.stdout。工作解决方案如下：

```
pid = subprocess.Popen([sys.executable, "longtask.py"], stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE) 
```

我没有检查过其他平台上的代码，也不知道在 FreeBSD 上出现这种行为的原因。如果有人知道，请分享您的想法。谷歌搜索在 Python 中启动后台进程还没有任何启示。

* * *

## 回答 #5

> 赞同：193
> 
> 时间：2008-09-18T01:37:24.717

```
import os
os.system("your command") 
```

请注意，这是危险的，因为该命令没有被清除。我把它留给你去谷歌搜索'os'和'sys'模块的相关文档。有很多函数（exec* 和 spawn*）可以做类似的事情。

* * *

## 回答 #6

> 赞同：168
> 
> 时间：2008-09-18T01:42:30.540

我建议使用[subprocess](http://docs.python.org/library/subprocess.html)模块而不是 os.system ，因为它会为您进行 shell 转义，因此更安全。

```
subprocess.call(['ping', 'localhost']) 
```

* * *

## 回答 #7

> 赞同：163
> 
> 时间：2008-09-18T01:37:49.613

```
import os
cmd = 'ls -al'
os.system(cmd) 
```

如果要返回命令的结果，可以使用[`os.popen`](https://docs.python.org/2/library/os.html#os.popen). 但是，自 2.6 版起已弃用此功能，转而支持[subprocess module](https://docs.python.org/2/library/subprocess.html#module-subprocess)，其他答案已很好地涵盖了该功能。

* * *

## 回答 #8

> 赞同：125
> 
> 时间：2016-10-29T14:02:50.753

有许多不同的库允许您使用 Python 调用外部命令。对于每个库，我都给出了描述并展示了调用外部命令的示例。我用作示例的命令是`ls -l`（列出所有文件）。如果您想了解有关我列出的任何库的更多信息，并链接了每个库的文档。

### 来源

*   子进程：[https ://docs.python.org/3.5/library/subprocess.html](https://docs.python.org/3.5/library/subprocess.html)
*   shlex：[https ://docs.python.org/3/library/shlex.html](https://docs.python.org/3/library/shlex.html)
*   操作系统：[https ://docs.python.org/3.5/library/os.html](https://docs.python.org/3.5/library/os.html)
*   sh：[https ://amoffat.github.io/sh/](https://amoffat.github.io/sh/)
*   铅：[https ://plumbum.readthedocs.io/en/latest/](https://plumbum.readthedocs.io/en/latest/)
*   pexpect：[https ://pexpect.readthedocs.io/en/stable/](https://pexpect.readthedocs.io/en/stable/)
*   面料： http: [//www.fabfile.org/](http://www.fabfile.org/)
*   特使：[https ://github.com/kennethreitz/envoy](https://github.com/kennethreitz/envoy)
*   命令：[https ://docs.python.org/2/library/commands.html](https://docs.python.org/2/library/commands.html)

### 这些都是图书馆

希望这将帮助您决定使用哪个库:)

### *子进程*

子进程允许您调用外部命令并将它们连接到它们的输入/输出/错误管道（stdin、stdout 和 stderr）。子进程是运行命令的默认选择，但有时其他模块更好。

```
subprocess.run(["ls", "-l"]) # Run command
subprocess.run(["ls", "-l"], stdout=subprocess.PIPE) # This will run the command and return any output
subprocess.run(shlex.split("ls -l")) # You can also use the shlex library to split the command 
```

### *操作系统*

os 用于“操作系统相关功能”。也可以用`os.system`and调用外部命令`os.popen`（注意：还有一个subprocess.popen）。os 将始终运行 shell，对于不需要或不知道如何使用`subprocess.run`.

```
os.system("ls -l") # Run command
os.popen("ls -l").read() # This will run the command and return any output 
```

### *嘘*

sh 是一个子进程接口，可让您像调用函数一样调用程序。如果您想多次运行命令，这很有用。

```
sh.ls("-l") # Run command normally
ls_cmd = sh.Command("ls") # Save command as a variable
ls_cmd() # Run command as if it were a function 
```

### *铅*

plumbum 是一个用于“类似脚本”的 Python 程序的库。您可以调用类似函数的程序，如`sh`. 如果您想在没有外壳的情况下运行管道，Plumbum 很有用。

```
ls_cmd = plumbum.local("ls -l") # Get command
ls_cmd() # Run command 
```

### *期待*

pexpect 允许您生成子应用程序、控制它们并在它们的输出中查找模式。对于需要 Unix 上的 tty 的命令，这是子进程的更好替代方案。

```
pexpect.run("ls -l") # Run command as normal
child = pexpect.spawn('scp foo user@example.com:.') # Spawns child application
child.expect('Password:') # When this is the output
child.sendline('mypassword') 
```

### *织物*

fabric 是一个 Python 2.5 和 2.7 库。它允许您执行本地和远程 shell 命令。Fabric 是在安全外壳 (SSH) 中运行命令的简单替代方案

```
fabric.operations.local('ls -l') # Run command as normal
fabric.operations.local('ls -l', capture = True) # Run command and receive output 
```

### *使者*

envoy 被称为“人类的子进程”。它用作`subprocess`模块周围的便利包装器。

```
r = envoy.run("ls -l") # Run command
r.std_out # Get output 
```

### *命令*

`commands`包含 的包装函数`os.popen`，但它已从 Python 3 中删除，因为`subprocess`它是一个更好的选择。

* * *

## 回答 #9

> 赞同：85
> 
> 时间：2013-04-11T17:17:53.443

### 使用标准库

使用[子进程模块](https://docs.python.org/3/library/subprocess.html#subprocess.run)（Python 3）：

```
import subprocess
subprocess.run(['ls', '-l']) 
```

这是推荐的标准方式。然而，更复杂的任务（管道、输出、输入等）的构建和编写可能会很乏味。

*关于 Python 版本的注意事项：如果您仍在使用 Python 2，则[subprocess.call](https://docs.python.org/2/library/subprocess.html#subprocess.call)以类似的方式工作。*

*专业提示：[shlex.split](https://docs.python.org/2/library/shlex.html#shlex.split)可以帮助您解析、 和其他函数的命令`run`，以防您不希望（或者您不能！）以列表的形式提供它们：`call``subprocess`*

```
import shlex
import subprocess
subprocess.run(shlex.split('ls -l')) 
```

### 有外部依赖

如果您不介意外部依赖项，请使用[plumbum](https://pypi.python.org/pypi/plumbum)：

```
from plumbum.cmd import ifconfig
print(ifconfig['wlan0']()) 
```

这是最好的`subprocess`包装。它是跨平台的，即它适用于 Windows 和类 Unix 系统。通过安装`pip install plumbum`。

另一个流行的库是[sh](https://pypi.python.org/pypi/sh)：

```
from sh import ifconfig
print(ifconfig('wlan0')) 
```

然而，`sh`放弃了对 Windows 的支持，所以它不像以前那么棒了。通过安装`pip install sh`。

* * *

## 回答 #10

> 赞同：83
> 
> 时间：2012-03-13T00:12:54.427

我总是用`fabric`这样的东西：

```
from fabric.operations import local
result = local('ls', capture=True)
print "Content:/n%s" % (result, ) 
```

但这似乎是一个很好的工具：[`sh`（Python subprocess interface）](https://github.com/amoffat/sh)。

看一个例子：

```
from sh import vgdisplay
print vgdisplay()
print vgdisplay('-v')
print vgdisplay(v=True) 
```

* * *

## 回答 #11

> 赞同：81
> 
> 时间：2010-10-07T07:09:04.150

检查“pexpect”Python 库。

它允许对外部程序/命令，甚至 ssh、ftp、telnet 等进行交互式控制。您可以输入如下内容：

```
child = pexpect.spawn('ftp 192.168.0.24')

child.expect('(?i)name .*: ')

child.sendline('anonymous')

child.expect('(?i)password') 
```

* * *

## 回答 #12

> 赞同：79
> 
> 时间：2011-04-28T20:29:29.967

如果您需要正在调用的命令的输出，则可以使用[subprocess.check_output](https://docs.python.org/3.6/library/subprocess.html#subprocess.check_output) (Python 2.7+)。

```
>>> subprocess.check_output(["ls", "-l", "/dev/null"])
'crw-rw-rw- 1 root root 1, 3 Oct 18  2007 /dev/null\n' 
```

还要注意[shell](https://docs.python.org/3.6/library/subprocess.html#frequently-used-arguments)参数。

> 如果 shell 是`True`，指定的命令将通过 shell 执行。如果您将 Python 主要用于它在大多数系统 shell 上提供的增强控制流，并且仍然希望方便地访问其他 shell 功能，例如 shell 管道、文件名通配符、环境变量扩展和 ~ 到用户家的扩展，这将很有用目录。但是，请注意 Python 本身提供了许多类似 shell 的功能的实现（特别是 、、`glob`、`fnmatch`、`os.walk()`和）。`os.path.expandvars()``os.path.expanduser()``shutil`

* * *

## 回答 #13

> 赞同：66
> 
> 时间：2012-11-15T17:13:22.540

# 更新：

`subprocess.run`如果您的代码不需要保持与早期 Python 版本的兼容性，则从[Python 3.5 开始](https://docs.python.org/3.6/whatsnew/3.5.html#whatsnew-subprocess)推荐使用此方法。它更加一致，并提供与 Envoy 类似的易用性。（尽管管道并不那么简单。请参阅[这个问题了解如何](https://stackoverflow.com/questions/7389662/link-several-popen-commands-with-pipes)。）

[以下是文档](https://docs.python.org/3.6/library/subprocess.html#subprocess.run)中的一些示例。

运行一个进程：

```
>>> subprocess.run(["ls", "-l"])  # Doesn't capture output
CompletedProcess(args=['ls', '-l'], returncode=0) 
```

运行失败引发：

```
>>> subprocess.run("exit 1", shell=True, check=True)
Traceback (most recent call last):
  ...
subprocess.CalledProcessError: Command 'exit 1' returned non-zero exit status 1 
```

捕获输出：

```
>>> subprocess.run(["ls", "-l", "/dev/null"], stdout=subprocess.PIPE)
CompletedProcess(args=['ls', '-l', '/dev/null'], returncode=0,
stdout=b'crw-rw-rw- 1 root root 1, 3 Jan 23 16:23 /dev/null\n') 
```

# 原答案：

我建议尝试[Envoy](https://github.com/kennethreitz/envoy)。它是子进程的包装器，反过来[旨在替换](http://docs.python.org/2/library/subprocess.html)旧的模块和功能。Envoy 是人类的子进程。

[README](https://github.com/kennethreitz/envoy#readme)中的示例用法：

```
>>> r = envoy.run('git config', data='data to pipe in', timeout=2)

>>> r.status_code
129
>>> r.std_out
'usage: git config [options]'
>>> r.std_err
'' 
```

也管周围的东西：

```
>>> r = envoy.run('uptime | pbcopy')

>>> r.command
'pbcopy'
>>> r.status_code
0

>>> r.history
[<Response 'uptime'>] 
```

* * *

## 回答 #14

> 赞同：64
> 
> 时间：2012-10-28T05:14:01.820

这就是我运行命令的方式。这段代码有你需要的一切

```
from subprocess import Popen, PIPE
cmd = "ls -l ~/"
p = Popen(cmd , shell=True, stdout=PIPE, stderr=PIPE)
out, err = p.communicate()
print "Return code: ", p.returncode
print out.rstrip(), err.rstrip() 
```

* * *

## 回答 #15

> 赞同：54
> 
> 时间：2017-10-18T16:37:52.680

> ## 如何从 Python 执行程序或调用系统命令

简单， use `subprocess.run`，它返回一个`CompletedProcess`对象：

```
>>> from subprocess import run
>>> from shlex import split
>>> completed_process = run(split('python --version'))
Python 3.8.8
>>> completed_process
CompletedProcess(args=['python', '--version'], returncode=0) 
```

(`run`想要一个词法解析的 shell 参数列表 - 这是你在 shell 中键入的内容，用空格分隔，但不是空格被引用的地方，所以使用一个专门的函数 ,`split`来拆分你要输入的内容贝壳）

### 为什么？

从 Python 3.5 开始，文档推荐[subprocess.run](https://docs.python.org/3/library/subprocess.html#subprocess.run)：

> 调用子流程的推荐方法是对它可以处理的所有用例使用 run() 函数。对于更高级的用例，可以直接使用底层的 Popen 接口。

这是最简单的用法示例 - 它完全按照要求进行：

```
>>> from subprocess import run
>>> from shlex import split
>>> completed_process = run(split('python --version'))
Python 3.8.8
>>> completed_process
CompletedProcess(args=['python', '--version'], returncode=0) 
```

`run`等待命令成功完成，然后返回一个`CompletedProcess`对象。它可能会引发`TimeoutExpired`（如果你给它一个`timeout=`论点）或`CalledProcessError`（如果它失败并且你通过`check=True`）。

正如您可能从上面的示例中推断的那样，默认情况下，stdout 和 stderr 都会通过管道传输到您自己的 stdout 和 stderr。

我们可以检查返回的对象并查看给出的命令和返回码：

```
>>> completed_process.args
['python', '--version']
>>> completed_process.returncode
0 
```

### 捕获输出

如果要捕获输出，可以传递`subprocess.PIPE`给相应的`stderr`or `stdout`：

```
>>> from subprocess import PIPE
>>> completed_process = run(shlex.split('python --version'), stdout=PIPE, stderr=PIPE)
>>> completed_process.stdout
b'Python 3.8.8\n'
>>> completed_process.stderr
b'' 
```

并且这些各自的属性返回字节。

## 传递命令列表

人们可能很容易从手动提供命令字符串（如问题所暗示的那样）转向提供以编程方式构建的字符串。**不要以编程方式构建字符串。**这是一个潜在的安全问题。最好假设您不信任输入。

```
>>> import textwrap
>>> args = ['python', textwrap.__file__]
>>> cp = run(args, stdout=subprocess.PIPE)
>>> cp.stdout
b'Hello there.\n  This is indented.\n' 
```

请注意，仅`args`应按位置传递。

## 完整签名

这是源代码中的实际签名，如下所示`help(run)`：

> ```
> def run(*popenargs, input=None, timeout=None, check=False, **kwargs): 
> ```

和`popenargs`被`kwargs`赋予`Popen`构造函数。`input`可以是字节串（或 unicode，如果指定编码或`universal_newlines=True`），将通过管道传送到子进程的标准输入。

该文档描述`timeout=`并`check=True`比我更好：

> 超时参数被传递给 Popen.communicate()。如果超时，子进程将被杀死并等待。TimeoutExpired 异常将在子进程终止后重新引发。
> 
> 如果检查为真，并且进程以非零退出代码退出，则会引发 CalledProcessError 异常。该异常的属性包含参数、退出代码以及标准输出和标准错误（如果它们被捕获）。

这个例子`check=True`比我想出的要好：

> ```
> >>> subprocess.run("exit 1", shell=True, check=True)
> Traceback (most recent call last):
>   ...
> subprocess.CalledProcessError: Command 'exit 1' returned non-zero exit status 1 
> ```

### 扩展签名

这是文档中给出的扩展签名：

> ```
> subprocess.run(args, *, stdin=None, input=None, stdout=None, stderr=None, 
> shell=False, cwd=None, timeout=None, check=False, encoding=None, 
> errors=None) 
> ```

请注意，这表明只有 args 列表应按位置传递。因此，将剩余的参数作为关键字参数传递。

### 波本

什么时候`Popen`改用？我很难仅根据论点找到用例。但是，直接使用`Popen`将允许您访问其方法，包括`poll`'send_signal'、'terminate' 和 'wait'。

这是[source](https://github.com/python/cpython/blob/master/Lib/subprocess.py#L752)`Popen`中给出的签名。我认为这是对信息的最精确封装（而不是）：`help(Popen)`

```
 def __init__(self, args, bufsize=-1, executable=None,
             stdin=None, stdout=None, stderr=None,
             preexec_fn=None, close_fds=True,
             shell=False, cwd=None, env=None, universal_newlines=None,
             startupinfo=None, creationflags=0,
             restore_signals=True, start_new_session=False,
             pass_fds=(), *, user=None, group=None, extra_groups=None,
             encoding=None, errors=None, text=None, umask=-1, pipesize=-1): 
```

但更多信息[是`Popen`文档](https://docs.python.org/3/library/subprocess.html#popen-constructor)：

> ```
> subprocess.Popen(args, bufsize=-1, executable=None, stdin=None, stdout=None, 
> stderr=None, preexec_fn=None, close_fds=True, shell=False, cwd=None,
> env=None, universal_newlines=None, startupinfo=None, creationflags=0, 
> restore_signals=True, start_new_session=False, pass_fds=(), *, group=None, 
> extra_groups=None, user=None, umask=-1, encoding=None, errors=None, 
> text=None) 
> ```
> 
> 在新进程中执行子程序。在 POSIX 上，该类使用类似 os.execvp() 的行为来执行子程序。在 Windows 上，该类使用 Windows CreateProcess() 函数。Popen 的论点如下。

理解其余文档`Popen`将留给读者作为练习。

* * *

## 回答 #16

> 赞同：53
> 
> 时间：2008-09-18T01:43:30.940

使用*[子进程](https://docs.python.org/2/library/subprocess.html)*。

...或者对于一个非常简单的命令：

```
import os
os.system('cat testfile') 
```

* * *

## 回答 #17

> 赞同：42
> 
> 时间：2008-09-18T01:53:27.767

`os.system`还可以，但有点过时了。它也不是很安全。相反，尝试`subprocess`. `subprocess`不直接调用 sh，因此比`os.system`.

[在此处](https://docs.python.org/library/subprocess.html)获取更多信息。

* * *

## 回答 #18

> 赞同：39
> 
> 时间：2014-10-10T17:41:13.153

还有[铅球](http://plumbum.readthedocs.org/en/latest/)

```
>>> from plumbum import local
>>> ls = local["ls"]
>>> ls
LocalCommand(<LocalPath /bin/ls>)
>>> ls()
u'build.py\ndist\ndocs\nLICENSE\nplumbum\nREADME.rst\nsetup.py\ntests\ntodo.txt\n'
>>> notepad = local["c:\\windows\\notepad.exe"]
>>> notepad()                                   # Notepad window pops up
u''                                             # Notepad window is closed by user, command returns 
```

* * *

## 回答 #19

> 赞同：38
> 
> 时间：2020-10-13T19:20:51.310

*从**2018 年 6 月 27 日发布的 Python 3.7.0 ( [https://docs.python.org/3/whatsnew/3.7.html](https://docs.python.org/3/whatsnew/3.7.html) )**开始，您可以以最强大但同样简单的方式实现您想要的结果。该答案旨在以简短的方式向您展示各种选项的基本摘要。有关深入的答案，请参阅其他答案。*

* * *

# TL;2021 年博士

的最大优点`os.system(...)`是它的简单性。`subprocess`更好并且仍然易于使用，尤其是从**Python 3.5**开始。

```
import subprocess
subprocess.run("ls -a", shell=True) 
```

***注意：***这是您问题的确切答案 - 运行命令

> 像在贝壳里

* * *

### 首选方式

如果可能，删除 shell 开销并直接运行命令（需要列表）。

```
import subprocess
subprocess.run(["help"])
subprocess.run(["ls", "-a"]) 
```

在列表中传递程序参数。**不要`\"`为包含空格的参数包含 -escaping。**

* * *

# 高级用例

## 检查输出

以下代码不言自明：

```
import subprocess
result = subprocess.run(["ls", "-a"], capture_output=True, text=True)
if "stackoverflow-logo.png" in result.stdout:
    print("You're a fan!")
else:
    print("You're not a fan?") 
```

`result.stdout`**是除错误外**的所有正常程序输出。阅读`result.stderr`以获取它们。

`capture_output=True`- 打开捕获。否则`result.stderr`会`result.stdout`是`None`. 可从*Python 3.7*获得。

`text=True`*- 在Python 3.7*中添加了一个便利参数，它将接收到的二进制数据转换为您可以轻松使用的 Python 字符串。

## 检查返回码

做

```
if result.returncode == 127: print("The program failed for some weird reason")
elif result.returncode == 0: print("The program succeeded")
else: print("The program failed unexpectedly") 
```

如果只想检查程序是否成功（returncode == 0），否则抛出异常，有一个更方便的函数：

```
result.check_returncode() 
```

但它是 Python，所以有一个更方便的参数`check`可以自动为你做同样的事情：

```
result = subprocess.run(..., check=True) 
```

## 标准错误应该在标准输出里面

您可能希望在标准输出中包含所有程序输出，甚至是错误。为此，运行

```
result = subprocess.run(..., stderr=subprocess.STDOUT) 
```

`result.stderr`然后将是`None`并且`result.stdout`将包含一切。

## 使用带有参数字符串的 shell=False

`shell=False`需要一个参数**列表**。但是，您可以使用 shlex 自行拆分参数字符串。

```
import subprocess
import shlex
subprocess.run(shlex.split("ls -a")) 
```

就是这样。

# 常见问题

当您遇到这个问题时，您刚开始使用 Python 的机会很高。让我们看看一些常见的问题。

> FileNotFoundError：[Errno 2] 没有这样的文件或目录：'ls -a'：'ls -a'

*您正在运行一个没有`shell=True`. 使用 list ( `["ls", "-a"]`) 或 set `shell=True`。*

> 类型错误：[...] NoneType [...]

*检查您是否已设置`capture_output=True`.*

> TypeError：需要一个类似字节的对象，而不是 [...]

*你总是从你的程序中收到字节结果。如果您想像普通字符串一样使用它，请设置`text=True`.*

> subprocess.CalledProcessError：命令“[...]”返回非零退出状态 1。

*您的命令未成功运行。您可以禁用返回码检查或检查您的实际程序的有效性。*

> TypeError: **init** () got an unexpected keyword argument [...]

*您可能使用的是早于 3.7.0 的 Python 版本；将其更新为可用的最新版本。否则，此 Stack Overflow 帖子中还有其他答案，向您展示了较旧的替代解决方案。*

* * *

## 回答 #20

> 赞同：32
> 
> 时间：2015-06-29T11:34:22.260

采用：

```
import os

cmd = 'ls -al'

os.system(cmd) 
```

**os - 该模块提供了一种使用操作系统相关功能的可移植方式。**

对于更多`os`功能，[这里](https://docs.python.org/2/library/os.html)是文档。

* * *

## 回答 #21

> 赞同：32
> 
> 时间：2018-04-30T13:47:17.770

可以这么简单：

```
import os
cmd = "your command"
os.system(cmd) 
```

* * *

## 回答 #22

> 赞同：26
> 
> 时间：2010-01-08T21:11:30.640

这里还有一个之前没有提到的区别。

`subprocess.Popen`将 <command> 作为子进程执行。就我而言，我需要执行需要与另一个程序 <b> 通信的文件 <a>。

我尝试了子进程，执行成功。但是 <b> 无法与 <a> 通信。当我从终端运行两者时，一切正常。

还有一个：（注意：kwrite 的行为与其他应用程序不同。如果您使用 Firefox 尝试以下操作，结果将不一样。）

如果您尝试`os.system("kwrite")`，程序流程将冻结，直到用户关闭 kwrite。为了克服这一点，我尝试了`os.system(konsole -e kwrite)`。这次程序继续流动，但是kwrite变成了控制台的子进程。

任何运行 kwrite 的人都不是子进程（即在系统监视器中，它必须出现在树的最左边）。

* * *

## 回答 #23

> 赞同：26
> 
> 时间：2012-06-11T22:28:35.423

`os.system`不允许您存储结果，因此如果您想将结果存储在某个列表或其他内容中，则`subprocess.call`可以使用。

* * *

## 回答 #24

> 赞同：25
> 
> 时间：2011-01-18T19:21:44.547

`subprocess.check_call`如果您不想测试返回值，这很方便。它对任何错误都抛出异常。

* * *

## 回答 #25

> 赞同：25
> 
> 时间：2014-04-30T14:37:04.533

我倾向于将[subprocess 与 shlex](https://docs.python.org/2/library/shlex.html)[一起](https://docs.python.org/2/library/subprocess.html)使用（处理引用字符串的转义）：

```
>>> import subprocess, shlex
>>> command = 'ls -l "/your/path/with spaces/"'
>>> call_params = shlex.split(command)
>>> print call_params
["ls", "-l", "/your/path/with spaces/"]
>>> subprocess.call(call_params) 
```

* * *

## 回答 #26

> 赞同：21
> 
> 时间：2014-05-01T20:49:01.967

我为此编写了一个库*[shell.py](https://github.com/houqp/shell.py)*。

它现在基本上是 popen 和 shlex 的包装器。它还支持管道命令，因此您可以在 Python 中更轻松地链接命令。因此，您可以执行以下操作：

```
ex('echo hello shell.py') | "awk '{print $2}'" 
```

* * *

## 回答 #27

> 赞同：19
> 
> 时间：2016-06-17T09:14:24.743

在 Windows 中，您可以通过调用导入模块并`subprocess`运行外部命令`subprocess.Popen()`，如下所示：`subprocess.Popen().communicate()``subprocess.Popen().wait()`

```
# Python script to run a command line
import subprocess

def execute(cmd):
    """
        Purpose  : To execute a command and return exit status
        Argument : cmd - command to execute
        Return   : exit_code
    """
    process = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    (result, error) = process.communicate()

    rc = process.wait()

    if rc != 0:
        print "Error: failed to execute command:", cmd
        print error
    return result
# def

command = "tasklist | grep python"
print "This process detail: \n", execute(command) 
```

输出：

```
This process detail:
python.exe                     604 RDP-Tcp#0                  4      5,660 K 
```

* * *

## 回答 #28

> 赞同：19
> 
> 时间：2016-11-27T00:15:34.280

在 Linux 下，如果您想调用将独立执行的外部命令（将在 Python 脚本终止后继续运行），您可以使用简单的队列作为[任务假脱机程序](http://vicerveza.homeunix.net/%7Eviric/soft/ts/)或[at](https://linux.die.net/man/1/at)命令。

带有任务后台处理程序的示例：

```
import os
os.system('ts <your-command>') 
```

关于任务后台处理程序 ( `ts`) 的注意事项：

1.  您可以使用以下方式设置要运行的并发进程数（“插槽”）：

    `ts -S <number-of-slots>`

2.  安装`ts`不需要管理员权限。您可以使用简单的从源代码下载并编译它`make`，将其添加到您的路径中，您就完成了。

* * *

## 回答 #29

> 赞同：19
> 
> 时间：2018-09-14T22:20:09.267

**[Invoke](http://www.pyinvoke.org/)**是一个 Python（2.7 和 3.4+）任务执行工具和库。它为运行 shell 命令提供了一个干净的高级 API：

```
>>> from invoke import run
>>> cmd = "pip install -r requirements.txt"
>>> result = run(cmd, hide=True, warn=True)
>>> print(result.ok)
True
>>> print(result.stdout.splitlines()[-1])
Successfully installed invocations-0.13.0 pep8-1.5.7 spec-1.3.1 
```

* * *

## 回答 #30

> 赞同：18
> 
> 时间：2012-07-16T15:16:24.527

您可以使用 Popen，然后您可以检查程序的状态：

```
from subprocess import Popen

proc = Popen(['ls', '-l'])
if proc.poll() is None:
    proc.kill() 
```

查看[subprocess.Popen](http://docs.python.org/library/subprocess.html#popen-objects)。

* * *

## 回答 #31

> 赞同：17
> 
> 时间：2014-08-24T21:46:12.373

一个简单的方法是使用[os 模块](https://docs.python.org/2/library/os.html)：

```
import os
os.system('ls') 
```

或者，您也可以使用 subprocess 模块：

```
import subprocess
subprocess.check_call('ls') 
```

如果您希望将结果存储在变量中，请尝试：

```
import subprocess
r = subprocess.check_output('ls') 
```

* * *

## 回答 #32

> 赞同：17
> 
> 时间：2016-07-20T09:50:01.300

从[OpenStack](https://en.wikipedia.org/wiki/OpenStack) [Neutron](https://en.wikipedia.org/wiki/OpenStack#Networking_(Neutron))获取网络 ID ：

```
#!/usr/bin/python
import os
netid = "nova net-list | awk '/ External / { print $2 }'"
temp = os.popen(netid).read()  /* Here temp also contains new line (\n) */
networkId = temp.rstrip()
print(networkId) 
```

**nova 网表的**输出

 **```
+--------------------------------------+------------+------+
| ID                                   | Label      | CIDR |
+--------------------------------------+------------+------+
| 431c9014-5b5d-4b51-a357-66020ffbb123 | test1      | None |
| 27a74fcd-37c0-4789-9414-9531b7e3f126 | External   | None |
| 5a2712e9-70dc-4b0e-9281-17e02f4684c9 | management | None |
| 7aa697f5-0e60-4c15-b4cc-9cb659698512 | Internal   | None |
+--------------------------------------+------------+------+ 
```

打印输出**（networkId）**

```
27a74fcd-37c0-4789-9414-9531b7e3f126 
```

* * *

## 回答 #33

> 赞同：16
> 
> 时间：2012-07-25T06:51:50.050

运行任何命令并返回结果的最简单方法：

```
from commands import getstatusoutput

try:
    return getstatusoutput("ls -ltr")
except Exception, e:
    return None 
```

* * *

## 回答 #34

> 赞同：14
> 
> 时间：2019-11-28T13:40:49.433

***大多数情况：***

**在大多数情况下，您只需要这样的一小段代码**：

```
import subprocess
import shlex

source = "test.txt"
destination = "test_copy.txt"

base = "cp {source} {destination}'"
cmd = base.format(source=source, destination=destination)
subprocess.check_call(shlex.split(cmd)) 
```

**它干净简单**。

> `subprocess.check_call`使用参数运行命令并等待命令完成。
> 
> `shlex.split`使用类似 shell 的语法拆分字符串 cmd

***其他情况：***

如果这对某些特定命令不起作用，则很可能是[**命令行解释器**](https://en.wikipedia.org/wiki/List_of_command-line_interpreters)有问题。操作系统选择了默认的，它不适合您的程序类型，或者在系统可执行路径上找不到合适的。[](https://en.wikipedia.org/wiki/List_of_command-line_interpreters)

 ****例子：**

在 Unix 系统上使用重定向运算符

```
input_1 = "input_1.txt"
input_2 = "input_2.txt"
output = "merged.txt"
base_command = "/bin/bash -c 'cat {input} >> {output}'"

base_command.format(input_1, output=output)
subprocess.check_call(shlex.split(base_command))

base_command.format(input_2, output=output)
subprocess.check_call(shlex.split(base_command)) 
```

> 正如[Python 之禅中](https://www.python.org/dev/peps/pep-0020/)所说：**显式优于隐式**

因此，如果使用 Python >=3.6 函数，它看起来像这样：

```
import subprocess
import shlex

def run_command(cmd_interpreter: str, command: str) -> None:
    base_command = f"{cmd_interpreter} -c '{command}'"
    subprocess.check_call(shlex.split(base_command) 
```

* * *

## 回答 #35

> 赞同：13
> 
> 时间：2018-03-23T02:30:43.750

通常，我将以下函数用于外部命令，这对于**长时间运行的进程**特别方便。以下方法*在运行时***跟踪进程输出** 并返回输出，如果进程失败则**引发异常。**

 ***如果该过程是在 process 上使用**poll() 方法**完成的，它就会出现。

```
import subprocess,sys

def exec_long_running_proc(command, args):
    cmd = "{} {}".format(command, " ".join(str(arg) if ' ' not in arg else arg.replace(' ','\ ') for arg in args))
    print(cmd)
    process = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)

    # Poll process for new output until finished
    while True:
        nextline = process.stdout.readline().decode('UTF-8')
        if nextline == '' and process.poll() is not None:
            break
        sys.stdout.write(nextline)
        sys.stdout.flush()

    output = process.communicate()[0]
    exitCode = process.returncode

    if (exitCode == 0):
        return output
    else:
        raise Exception(command, exitCode, output) 
```

**你可以像这样调用它：**

```
exec_long_running_proc(command = "hive", args=["-f", hql_path]) 
```

* * *

## 回答 #36

> 赞同：12
> 
> 时间：2015-10-14T07:12:51.030

这是我的两分钱：在我看来，这是处理外部命令时的最佳实践......

这些是执行方法的返回值...

```
pass, stdout, stderr = execute(["ls","-la"],"/home/user/desktop") 
```

这是执行方法...

```
def execute(cmdArray,workingDir):

    stdout = ''
    stderr = ''

    try:
        try:
            process = subprocess.Popen(cmdArray,cwd=workingDir, stdout=subprocess.PIPE, stderr=subprocess.PIPE, bufsize=1)
        except OSError:
            return [False, '', 'ERROR : command(' + ' '.join(cmdArray) + ') could not get executed!']

        for line in iter(process.stdout.readline, b''):

            try:
                echoLine = line.decode("utf-8")
            except:
                echoLine = str(line)

            stdout += echoLine

        for line in iter(process.stderr.readline, b''):

            try:
                echoLine = line.decode("utf-8")
            except:
                echoLine = str(line)

            stderr += echoLine

    except (KeyboardInterrupt,SystemExit) as err:
        return [False,'',str(err)]

    process.stdout.close()

    returnCode = process.wait()
    if returnCode != 0 or stderr != '':
        return [False, stdout, stderr]
    else:
        return [True, stdout, stderr] 
```

* * *

## 回答 #37

> 赞同：11
> 
> 时间：2013-06-19T23:18:34.813

只是为了增加讨论，如果您包括使用 Python 控制台，则可以从[IPython](http://en.wikipedia.org/wiki/IPython)调用外部命令。在 IPython 提示符下，您可以通过添加前缀 '!' 来调用 shell 命令。您还可以将 Python 代码与 shell 结合起来，并将 shell 脚本的输出分配给 Python 变量。

例如：

```
In [9]: mylist = !ls

In [10]: mylist
Out[10]:
['file1',
 'file2',
 'file3',] 
```

* * *

## 回答 #38

> 赞同：11
> 
> 时间：2018-10-30T11:40:43.637

我写了一个小库来帮助这个用例：

[https://pypi.org/project/citizenshell/](https://pypi.org/project/citizenshell/)

它可以安装使用

```
pip install citizenshell 
```

然后按如下方式使用：

```
from citizenshell import sh
assert sh("echo Hello World") == "Hello World" 
```

您可以将标准输出与标准错误分开并提取退出代码，如下所示：

```
result = sh(">&2 echo error && echo output && exit 13")
assert result.stdout() == ["output"]
assert result.stderr() == ["error"]
assert result.exit_code() == 13 
```

很酷的是，在开始处理输出之前，您不必等待底层 shell 退出：

```
for line in sh("for i in 1 2 3 4; do echo -n 'It is '; date +%H:%M:%S; sleep 1; done", wait=False)
    print ">>>", line + "!" 
```

由于 wait=False 将打印可用的行

```
>>> It is 14:24:52!
>>> It is 14:24:53!
>>> It is 14:24:54!
>>> It is 14:24:55! 
```

更多示例可以在[https://github.com/meuter/citizenshell找到](https://github.com/meuter/citizenshell)

* * *

## 回答 #39

> 赞同：10
> 
> 时间：2018-04-04T06:57:44.277

**在 Python 中调用外部命令**

调用外部命令的一种简单方法是使用`os.system(...)`. 这个函数返回命令的退出值。但缺点是我们不会得到标准输出和标准错误。

```
ret = os.system('some_cmd.sh')
if ret != 0 :
    print 'some_cmd.sh execution returned failure' 
```

**在后台调用 Python 中的外部命令**

`subprocess.Popen`为运行外部命令而不是使用`os.system`. 我们可以在后台启动一个命令并等待它完成。之后我们可以得到标准输出和标准错误。

```
proc = subprocess.Popen(["./some_cmd.sh"], stdout=subprocess.PIPE)
print 'waiting for ' + str(proc.pid)
proc.wait()
print 'some_cmd.sh execution finished'
(out, err) = proc.communicate()
print 'some_cmd.sh output : ' + out 
```

**在后台调用 Python 中长时间运行的外部命令并在一段时间后停止**

我们甚至可以在后台启动一个长时间运行的进程，`subprocess.Popen`并在其任务完成后的某个时间将其终止。

```
proc = subprocess.Popen(["./some_long_run_cmd.sh"], stdout=subprocess.PIPE)
# Do something else
# Now some_long_run_cmd.sh exeuction is no longer needed, so kill it
os.system('kill -15 ' + str(proc.pid))
print 'Output : ' proc.communicate()[0] 
```

* * *

## 回答 #40

> 赞同：9
> 
> 时间：2013-04-17T14:10:06.270

在 Python 中运行外部命令有很多不同的方法，它们都有自己的优点和缺点。

我和我的同事一直在编写 Python 系统管理工具，所以我们需要运行很多外部命令，有时你希望它们阻塞或异步运行、超时、每秒更新等。

也有不同的方式来处理返回码和错误，你可能想要解析输出，并提供新的输入（以一种[期望](http://en.wikipedia.org/wiki/Expect)的风格）。或者您将需要重定向[标准输入](https://en.wikipedia.org/wiki/Standard_streams#Standard_input_(stdin))、[标准输出](https://en.wikipedia.org/wiki/Standard_streams#Standard_output_.28stdout.29)和[标准错误](https://en.wikipedia.org/wiki/Standard_streams#Standard_error_(stderr))以在不同的 tty 中运行（例如，当使用[GNU Screen](https://en.wikipedia.org/wiki/GNU_Screen)时）。

因此，您可能必须围绕外部命令编写很多包装器。所以这是我们编写的一个 Python 模块，它几乎可以处理您想要的任何东西，如果没有，它非常灵活，因此您可以轻松扩展它：

[https://github.com/hpcugent/vsc-base/blob/master/lib/vsc/utils/run.py](https://github.com/hpcugent/vsc-base/blob/master/lib/vsc/utils/run.py)

它不能独立工作，需要我们的一些其他工具，并且多年来获得了许多专门的功能，因此它可能不是您的直接替代品，但它可以为您提供很多关于用于运行命令的 Python 内部如何工作以及如何处理某些情况的想法。

* * *

## 回答 #41

> 赞同：9
> 
> 时间：2014-04-12T11:58:23.700

使用[subprocess.call](https://docs.python.org/2/library/subprocess.html)：

```
from subprocess import call

# Using list
call(["echo", "Hello", "world"])

# Single string argument varies across platforms so better split it
call("echo Hello world".split(" ")) 
```

* * *

## 回答 #42

> 赞同：9
> 
> 时间：2016-06-24T11:29:00.270

采用：

```
import subprocess

p = subprocess.Popen("df -h", shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE).communicate()[0]
print p.split("\n") 
```

它提供了很好的输出，更易于使用：

```
['Filesystem      Size  Used Avail Use% Mounted on',
 '/dev/sda6        32G   21G   11G  67% /',
 'none            4.0K     0  4.0K   0% /sys/fs/cgroup',
 'udev            1.9G  4.0K  1.9G   1% /dev',
 'tmpfs           387M  1.4M  386M   1% /run',
 'none            5.0M     0  5.0M   0% /run/lock',
 'none            1.9G   58M  1.9G   3% /run/shm',
 'none            100M   32K  100M   1% /run/user',
 '/dev/sda5       340G  222G  100G  69% /home',
 ''] 
```

* * *

## 回答 #43

> 赞同：9
> 
> 时间：2018-01-31T17:42:38.623

例如（在 Linux 中）：

```
import subprocess
subprocess.run('mkdir test.dir', shell=True) 
```

这将在当前目录中创建 test.dir。请注意，这也有效：

```
import subprocess
subprocess.call('mkdir test.dir', shell=True) 
```

使用 os.system 的等效代码是：

```
import os
os.system('mkdir test.dir') 
```

最佳实践是使用 subprocess 而不是 os，.run 优于 .call。您需要了解的有关子流程的所有信息都[在这里](https://docs.python.org/3.5/library/subprocess.html)。另外，请注意，所有 Python 文档都可以从[此处](https://docs.python.org/3/download.html)下载。我下载了打包为 .zip 的 PDF。我提到这一点是因为在 tutorial.pdf（第 81 页）中有一个很好的 os 模块概述。此外，它是 Python 编码人员的权威资源。

* * *

## 回答 #44

> 赞同：9
> 
> 时间：2019-01-29T05:11:40.887

对于`subprocess`在 Python 3.5+ 中使用，以下在 Linux 上为我做了诀窍：

```
import subprocess

# subprocess.run() returns a completed process object that can be inspected
c = subprocess.run(["ls", "-ltrh"], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
print(c.stdout.decode('utf-8')) 
```

如[文档中所述](https://docs.python.org/3/library/subprocess.html#subprocess.CompletedProcess)，`PIPE`值是字节序列，为了正确显示它们，应该考虑解码。对于更高版本的 Python，`text=True`并被`encoding='utf-8'`添加到[`subprocess.run()`](https://docs.python.org/3.6/library/subprocess.html#subprocess.run).

上述代码的输出是：

```
total 113M
-rwxr-xr-x  1 farzad farzad  307 Jan 15  2018 vpnscript
-rwxrwxr-x  1 farzad farzad  204 Jan 15  2018 ex
drwxrwxr-x  4 farzad farzad 4.0K Jan 22  2018 scripts
.... # Some other lines 
```

* * *

## 回答 #45

> 赞同：8
> 
> 时间：2014-03-14T02:59:05.007

经过一些研究，我有以下代码对我来说效果很好。它基本上实时打印标准输出和标准错误。

```
stdout_result = 1
stderr_result = 1

def stdout_thread(pipe):
    global stdout_result
    while True:
        out = pipe.stdout.read(1)
        stdout_result = pipe.poll()
        if out == '' and stdout_result is not None:
            break

        if out != '':
            sys.stdout.write(out)
            sys.stdout.flush()

def stderr_thread(pipe):
    global stderr_result
    while True:
        err = pipe.stderr.read(1)
        stderr_result = pipe.poll()
        if err == '' and stderr_result is not None:
            break

        if err != '':
            sys.stdout.write(err)
            sys.stdout.flush()

def exec_command(command, cwd=None):
    if cwd is not None:
        print '[' + ' '.join(command) + '] in ' + cwd
    else:
        print '[' + ' '.join(command) + ']'

    p = subprocess.Popen(
        command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, cwd=cwd
    )

    out_thread = threading.Thread(name='stdout_thread', target=stdout_thread, args=(p,))
    err_thread = threading.Thread(name='stderr_thread', target=stderr_thread, args=(p,))

    err_thread.start()
    out_thread.start()

    out_thread.join()
    err_thread.join()

    return stdout_result + stderr_result 
```

* * *

## 回答 #46

> 赞同：8
> 
> 时间：2016-10-11T02:26:49.373

这是调用外部命令并返回或打印命令的输出：

Python子进程[check_output](https://docs.python.org/2/library/subprocess.html)适用于

> 使用参数运行命令并将其输出作为字节字符串返回。

```
import subprocess
proc = subprocess.check_output('ipconfig /all')
print proc 
```

* * *

## 回答 #47

> 赞同：8
> 
> 时间：2018-05-08T20:49:55.577

如果您需要从 Python 笔记本（如[Jupyter](https://en.wikipedia.org/wiki/IPython#Project_Jupyter)、Zeppelin、Databricks 或 Google Cloud Datalab）调用 shell 命令，您只需使用`!`前缀即可。

例如，

```
!ls -ilF 
```

* * *

## 回答 #48

> 赞同：8
> 
> 时间：2019-08-28T16:56:20.483

如果您正在编写 Python shell 脚本并在系统上安装了[IPython](http://en.wikipedia.org/wiki/IPython)，则可以使用 bang 前缀在 IPython 中运行 shell 命令：

```
!ls
filelist = !ls 
```

* * *

## 回答 #49

> 赞同：6
> 
> 时间：2016-03-17T10:48:32.030

对于 Python 3.5+，建议您使用[subprocess 模块中的 run 函数](https://docs.python.org/3.5/library/subprocess.html#subprocess.run)。这将返回一个`CompletedProcess`对象，您可以从中轻松获取输出和返回代码。

```
from subprocess import PIPE, run

command = ['echo', 'hello']
result = run(command, stdout=PIPE, stderr=PIPE, universal_newlines=True)
print(result.returncode, result.stdout, result.stderr) 
```

* * *

## 回答 #50

> 赞同：5
> 
> 时间：2013-04-18T17:39:50.123

2015 年更新：Python 3.5 添加了[subprocess.run](https://docs.python.org/3/library/subprocess.html#subprocess.run)，它比 subprocess.Popen 更易于使用。我建议这样做。

```
>>> subprocess.run(["ls", "-l"])  # doesn't capture output
CompletedProcess(args=['ls', '-l'], returncode=0)

>>> subprocess.run("exit 1", shell=True, check=True)
Traceback (most recent call last):
  ...
subprocess.CalledProcessError: Command 'exit 1' returned non-zero exit status 1

>>> subprocess.run(["ls", "-l", "/dev/null"], capture_output=True)
CompletedProcess(args=['ls', '-l', '/dev/null'], returncode=0,
stdout=b'crw-rw-rw- 1 root root 1, 3 Jan 23 16:23 /dev/null\n', stderr=b'') 
```

* * *

## 回答 #51

> 赞同：5
> 
> 时间：2019-10-09T05:35:21.340

```
import subprocess

p = subprocess.run(["ls", "-ltr"], capture_output=True)
print(p.stdout.decode(), p.stderr.decode()) 
```

**[在线尝试](https://code.labstack.com/GIzH7jnS)**

* * *

## 回答 #52

> 赞同：4
> 
> 时间：2015-07-24T19:12:21.037

使用 Python 模块的`Popen`功能`subprocess`是运行 Linux 命令的最简单方法。在那里，该`Popen.communicate()`函数将为您提供命令输出。例如

```
import subprocess

..
process = subprocess.Popen(..)   # Pass command and arguments to the function
stdout, stderr = process.communicate()   # Get command output and error
.. 
```

* * *

## 回答 #53

> 赞同：4
> 
> 时间：2016-09-12T09:44:09.617

调用命令的方法有很多种。

*   例如：

如果`and.exe`需要两个参数。在 cmd 我们可以调用`sample.exe`use this: `and.exe 2 3`它会显示`5`在屏幕上。

如果我们使用 Python 脚本调用`and.exe`，我们应该这样做......

1.  `os.system(cmd,...)`

    *   `os.system(("and.exe" + " " + "2" + " " + "3"))`
2.  `os.popen(cmd,...)`

    *   `os.popen(("and.exe" + " " + "2" + " " + "3"))`
3.  `subprocess.Popen(cmd,...)`
    *   `subprocess.Popen(("and.exe" + " " + "2" + " " + "3"))`

太难了，所以我们可以用空格加入cmd：

```
import os
cmd = " ".join(exename,parameters)
os.popen(cmd) 
```

* * *

## 回答 #54

> 赞同：4
> 
> 时间：2019-11-26T11:39:48.007

`os.popen()`是执行命令的最简单和最安全的方法。您可以执行在命令行上运行的任何命令。此外，您还可以使用以下命令捕获命令的输出`os.popen().read()`

你可以这样做：

```
import os
output = os.popen('Your Command Here').read()
print (output) 
```

列出当前目录中所有文件的示例：

```
import os
output = os.popen('ls').read()
print (output)
# Outputs list of files in the directory 
```

* * *

## 回答 #55

> 赞同：3
> 
> 时间：2016-04-28T11:18:22.523

我会推荐以下方法“运行”，它将帮助我们获取[标准输出](https://en.wikipedia.org/wiki/Standard_streams#Standard_output_.28stdout.29)、[标准错误](https://en.wikipedia.org/wiki/Standard_streams#Standard_error_(stderr))和退出状态作为字典；它的调用者可以通过'run'方法读取字典返回以了解进程的实际状态。

```
 def run (cmd):
       print "+ DEBUG exec({0})".format(cmd)
       p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, universal_newlines=True, shell=True)
       (out, err) = p.communicate()
       ret        = p.wait()
       out        = filter(None, out.split('\n'))
       err        = filter(None, err.split('\n'))
       ret        = True if ret == 0 else False
       return dict({'output': out, 'error': err, 'status': ret})
  #end 
```

* * *

## 回答 #56

> 赞同：3
> 
> 时间：2019-03-31T12:21:50.947

如果你**没有**在命令中使用用户输入，你可以使用这个：

```
from os import getcwd
from subprocess import check_output
from shlex import quote

def sh(command):
    return check_output(quote(command), shell=True, cwd=getcwd(), universal_newlines=True).strip() 
```

并将其用作

```
branch = sh('git rev-parse --abbrev-ref HEAD') 
```

`shell=True`将生成一个外壳，因此您可以使用管道和此类外壳的东西`sh('ps aux | grep python')`。这对于运行硬编码命令和处理其输出非常方便。`universal_lines=True`确保输出以字符串而不是二进制形式返回。

`cwd=getcwd()`将确保命令在与解释器相同的工作目录下运行。这便于 Git 命令像上面的 Git 分支名称示例一样工作。

一些食谱

*   以兆字节为单位的可用内存：`sh('free -m').split('\n')[1].split()[1]`
*   可用空间/百分比`sh('df -m /').split('\n')[1].split()[4][0:-1]`
*   CPU负载`sum(map(float, sh('ps -ef -o pcpu').split('\n')[1:])`

但这对于用户输入是不安全的，来自文档：

> 安全注意事项
> 
> 与其他一些 popen 函数不同，此实现永远不会隐式调用系统 shell。这意味着所有字符，包括 shell 元字符，都可以安全地传递给子进程。如果通过 shell=True 显式调用 shell，则应用程序有责任确保正确引用所有空格和元字符以避免 shell 注入漏洞。
> 
> 当使用 shell=True 时，shlex.quote() 函数可用于正确转义字符串中的空格和 shell 元字符，这些字符串将用于构造 shell 命令。

即使使用`shlex.quote()`. 在 shell 命令上使用用户输入时，最好保持一点偏执。一种选择是使用硬编码命令来获取一些通用输出并通过用户输入进行过滤。无论如何，使用`shell=False`将确保仅执行您要执行的确切进程，否则您会收到`No such file or directory`错误。

也有一些性能影响`shell=True`，从我的测试来看，它似乎比`shell=False`（默认）慢 20%。

```
In [50]: timeit("check_output('ls -l'.split(), universal_newlines=True)", number=1000, globals=globals())
Out[50]: 2.6801227919995654

In [51]: timeit("check_output('ls -l', universal_newlines=True, shell=True)", number=1000, globals=globals())
Out[51]: 3.243950183999914 
```

* * *

## 回答 #57

> 赞同：3
> 
> 时间：2019-10-03T04:19:48.177

Python 3.5+

```
import subprocess

p = subprocess.run(["ls", "-ltr"], capture_output=True)
print(p.stdout.decode(), p.stderr.decode()) 
```

[**在线尝试**](https://code.labstack.com/GIzH7jnS)

* * *

## 回答 #58

> 赞同：3
> 
> 时间：2020-02-27T05:57:29.637

有多种方法可以从 Python*调用*外部*命令。*有一些功能和模块具有很好的辅助功能，可以使它变得非常容易。但其中最推荐的是`subprocess`模块。

```
import subprocess as s
s.call(["command.exe", "..."]) 
```

调用函数将启动外部进程，传递一些命令行参数并等待它完成。完成后，您继续执行。*call*函数中的参数通过列表传递。列表中的第一个参数通常是可执行文件形式的命令，列表中的后续参数是您想要传递的任何内容。

如果您之前在 windows 的命令行中调用过进程，您会意识到您经常需要引用参数。你需要在它周围加上引号。如果有空格，则有反斜杠，并且有一些复杂的规则，但是您可以通过使用模块在 Python 中避免很多这样的情况，`subprocess`因为它是一个列表，并且每个项目都被认为是不同的，并且 python 可以正确引用你。

最后，在列表之后，有许多可选参数，其中之一是 shell，如果您将 shell 设置为 true，那么您的命令将像在命令提示符下键入一样运行。

```
s.call(["command.exe", "..."], shell=True) 
```

这使您可以访问管道等功能，可以重定向到文件，可以在一件事中调用多个命令。

还有一件事，如果您的脚本依赖于成功的过程，那么您想要检查结果，并且可以使用 check call helper 函数检查结果。

```
s.check_call(...) 
```

它与调用函数完全相同，它采用相同的参数，采用相同的列表，您可以传入任何额外的参数，但它会等待函数完成。如果函数的退出代码不是零，它将通过 python 脚本中的异常。

最后，如果您想要更严格的控制`Popen`构造函数，它也来自`subprocess`模块。它也采用与 incall 和 check_call 函数相同的参数，但它返回一个表示正在运行的进程的对象。

```
p=s.Popen("...") 
```

它不会等待正在运行的进程完成，也不会立即抛出任何异常，但它会给你一个对象，让你做一些事情，比如等待它完成，让你与之通信，你可以重定向标准输入，标准输出，如果你想在其他地方显示输出等等。

* * *

## 回答 #59

> 赞同：2
> 
> 时间：2017-10-24T23:30:20.633

我编写了一个包装器来处理错误并重定向输出和其他内容。

```
import shlex
import psutil
import subprocess

def call_cmd(cmd, stdout=sys.stdout, quiet=False, shell=False, raise_exceptions=True, use_shlex=True, timeout=None):
    """Exec command by command line like 'ln -ls "/var/log"'
    """
    if not quiet:
        print("Run %s", str(cmd))
    if use_shlex and isinstance(cmd, (str, unicode)):
        cmd = shlex.split(cmd)
    if timeout is None:
        process = subprocess.Popen(cmd, stdout=stdout, stderr=sys.stderr, shell=shell)
        retcode = process.wait()
    else:
        process = subprocess.Popen(cmd, stdout=stdout, stderr=sys.stderr, shell=shell)
        p = psutil.Process(process.pid)
        finish, alive = psutil.wait_procs([p], timeout)
        if len(alive) > 0:
            ps = p.children()
            ps.insert(0, p)
            print('waiting for timeout again due to child process check')
            finish, alive = psutil.wait_procs(ps, 0)
        if len(alive) > 0:
            print('process {} will be killed'.format([p.pid for p in alive]))
            for p in alive:
                p.kill()
            if raise_exceptions:
                print('External program timeout at {} {}'.format(timeout, cmd))
                raise CalledProcessTimeout(1, cmd)
        retcode = process.wait()
    if retcode and raise_exceptions:
        print("External program failed %s", str(cmd))
        raise subprocess.CalledProcessError(retcode, cmd) 
```

你可以这样称呼它：

```
cmd = 'ln -ls "/var/log"'
stdout = 'out.txt'
call_cmd(cmd, stdout) 
```

* * *

## 回答 #60

> 赞同：1
> 
> 时间：2019-07-01T20:46:19.407

[Sultan](https://github.com/aeroxis/sultan)是一个用于此目的的最新包。它提供了一些关于管理用户权限和添加有用的错误消息的细节。

```
from sultan.api import Sultan

with Sultan.load(sudo=True, hostname="myserver.com") as sultan:
  sultan.yum("install -y tree").run() 
```

* * *

## 回答 #61

> 赞同：1
> 
> 时间：2021-09-01T10:34:36.640

***您可以使用子进程***模块中的***Popen***运行任何命令。

 **```
from subprocess import Popen 
```

首先，使用您要运行的所有参数创建命令对象。例如，在下面的代码片段中，gunicom 命令对象已由所有参数组成：

```
cmd = (
        "gunicorn "
        "-c gunicorn_conf.py "
        "-w {workers} "
        "--timeout {timeout} "
        "-b {address}:{port} "
        "--limit-request-line 0 "
        "--limit-request-field_size 0 "
        "--log-level debug "
        "--max-requests {max_requests} "
        "manage:app").format(**locals()) 
```

然后这个命令对象与***Popen***一起使用来实例化一个进程：

```
process = Popen(cmd, shell=True) 
```

这个过程也可以根据任何信号终止，使用下面的代码行：

```
Popen.terminate(process) 
```

您可以等到上述命令执行完成：

```
process.wait() 
```

* * *

## 回答 #62

> 赞同：0
> 
> 时间：2022-01-20T15:58:14.867

## 2022年的答案。

这里有很多答案，但没有一个能满足我的所有需求。

*   我需要运行命令并捕获**输出**和**退出代码**。
*   我需要使执行的程序**超时并在达到超时时****强制**它退出，并**杀死它的所有子进程**。
*   我需要它在**winXP+**，**cygwin**和**linux**中工作。在 python 2 和 3 中。

所以我创建了这个：

```
def _run(command, timeout_s=False, shell=False):
    ### run a process, capture the output and wait for it to finish. if timeout is specified then Kill the subprocess and its childrens when the timeout is reached (if parent did not detach)
    ## usage: _run(arg1, arg2, arg3)
        # arg1: command+args. always pass a string, the function will split it when needed
        # arg2: (optional) timeout in seconds before force killing  
        # arg3: (optional) shell usage. default shell=False
    ## return: a list containing: exit code, output, and if timeout was reached or not

    # - tested on python 2 and 3 in windows xp, 7, cygwin and linux. 
    # - preexec_fn=os.setsid (py2) is equivalent to start_new_session (py3) (works in linux only), in windows and cygwin we use TASKKILL
    # - we use stderr=subprocess.STDOUT to merge stderr and stdout
    import sys, subprocess, os, signal, shlex, time

    def _runPY3(command, timeout_s=None, shell=False):
        # py3.3+ coz : timeout was added to communicate() in py3.3.
        new_session=False
        if sys.platform.startswith('linux'): new_session=True
        p = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, start_new_session=new_session, shell=shell)

        try:
            out = p.communicate(timeout=timeout_s)[0].decode('utf-8')
            is_timeout_reached = False
        except subprocess.TimeoutExpired:
            print('Timeout reached: Killing the whole process group...')
            killAll(p.pid)
            out = p.communicate()[0].decode('utf-8')
            is_timeout_reached = True
        return p.returncode, out, is_timeout_reached

    def _runPY2(command, timeout_s=0, shell=False):
        preexec=None
        if sys.platform.startswith('linux'): preexec=os.setsid
        p = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, preexec_fn=preexec, shell=shell)

        start_time = time.time()
        is_timeout_reached = False
        while timeout_s and p.poll() == None:
            if time.time()-start_time >= timeout_s:
                print('Timeout reached: Killing the whole process group...')
                killAll(p.pid)
                is_timeout_reached = True
                break
            time.sleep(1)
        out = p.communicate()[0].decode('utf-8')
        return p.returncode, out, is_timeout_reached

    def killAll(ParentPid):
        if sys.platform.startswith('linux'):
            os.killpg(os.getpgid(ParentPid), signal.SIGTERM)
        elif sys.platform.startswith('cygwin'):
            # subprocess.Popen(shlex.split('bash -c "TASKKILL /F /PID $(</proc/{pid}/winpid) /T"'.format(pid=ParentPid)))
            winpid=int(open("/proc/{pid}/winpid".format(pid=ParentPid)).read())
            subprocess.Popen(['TASKKILL', '/F', '/PID', str(winpid), '/T'])
        elif sys.platform.startswith('win32'):
            subprocess.Popen(['TASKKILL', '/F', '/PID', str(ParentPid), '/T'])

    # - in windows we never need to split the command, but in cygwin and linux we need to split if shell=False (default), shlex will split the command for us
    if shell==False and (sys.platform.startswith('cygwin') or sys.platform.startswith('linux')):
        command=shlex.split(command)

    if sys.version_info >= (3, 3): # py3.3+
        if timeout_s==False:
            returnCode, output, is_timeout_reached = _runPY3(command, timeout_s=None, shell=shell)
        else:
            returnCode, output, is_timeout_reached = _runPY3(command, timeout_s=timeout_s, shell=shell)
    else:  # py2 up to 3.2
        if timeout_s==False:
            returnCode, output, is_timeout_reached = _runPY2(command, timeout_s=0, shell=shell)
        else:
            returnCode, output, is_timeout_reached = _runPY2(command, timeout_s=timeout_s, shell=shell)

    return returnCode, output, is_timeout_reached 
```

然后像这样使用它：始终将命令作为一个字符串传递（这更容易），您不需要拆分它，该函数会在需要时拆分它。

如果您的命令在您的 shell 中工作，它将与此功能一起工作，所以首先在您的 shell 中测试您的命令 cmd/bash

所以我们可以在超时的情况下使用它

```
a=_run('cmd /c echo 11111 & echo 22222 & calc',3)
for i in a[1].splitlines(): print(i) 
```

或没有超时：

```
b=_run('cmd /c echo 11111 & echo 22222 & calc') 
```

更多示例：

```
b=_run('''wmic nic where 'NetConnectionID="Local Area Connection"' get NetConnectionStatus /value''')
print(b)

c=_run('cmd /C netsh interface ip show address "Local Area Connection"')
print(c)

d=_run('printf "<%s>\n" "{foo}"')
print(d) 
```

您也可以指定 shell=True 但在大多数情况下使用此功能是无用的，我更喜欢选择我自己想要的 shell，但如果你也需要它，这里是：

```
# windows
e=_run('echo 11111 & echo 22222 & calc',3, shell=True)
print(e)
# cygwin/linux:
f=_run('printf "<%s>\n" "{foo}"', shell=True)
print(f) 
```

* * *

**为什么我没有使用更简单的新方法`subprocess.run()`？**

*   因为它在 python 中受支持，但在**winxp**`3.7+`中最后支持的 python 版本是.**`3.4`**
***   并且因为这个函数的超时参数在windows中是没有用的，所以它不会杀死执行命令的子进程。*   如果使用`capture_output`+ `timeout`arg，如果有子进程仍在运行，它将挂起。它仍然在 Windows 中被破坏，[问题](https://bugs.python.org/issue32795)[31447](https://bugs.python.org/issue31447)仍然存在。**

 *** * *

## 回答 #63

> 赞同：-2
> 
> 时间：2020-04-19T16:01:21.957

我将它用于 Python 3.6+：

```
import subprocess
def execute(cmd):
    """
        Purpose  : To execute a command and return exit status
        Argument : cmd - command to execute
        Return   : result, exit_code
    """
    process = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    (result, error) = process.communicate()
    rc = process.wait()
    if rc != 0:
        print ("Error: failed to execute command: ", cmd)
        print (error.rstrip().decode("utf-8"))
    return result.rstrip().decode("utf-8"), serror.rstrip().decode("utf-8")
# def 
```

# windows - 如何隐藏完整的音量？

> ID：89233
> 
> 赞同：2
> 
> 时间：2008-09-18T01:36:43.860
> 
> 标签：windows, windows-server-2003, sysadmin

在多用户环境中使用 Windows Server 2003（通过远程桌面，将其用作应用程序服务器），如何以一种不会出现在任何其他用户桌面上的方式挂载（最好是加密的）卷？

尝试和失败的方法：

*   调整用户权限 - 已安装卷的显示无法更改。

*   最佳加密/真加密。它们都为本地管理员显示卷

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T01:47:36.500

您将很难为您的确切问题找到解决方案。驱动器安装点不存储在用户级别（afaik）。您可以使用一些不能保证安全的解决方法：

1.  根据组策略隐藏对某些驱动器号的访问。不是很安全，很容易解决。
2.  不要安装单独的卷：使用 NTFS 加密并简单地设置某些文件夹的安全权限。

是否有任何特殊原因必须是整个驱动器？如果您试图避免让本地管理员拥有本地驱动器的权限，那么除非您使用第三方可能会失败的可怕解决方案，否则您将非常不走运。您可以使用组策略进行陪审以禁止本地管理员访问，但这会很困难且容易出错。

如果您的目标是拥有其他用户无法访问的单独文件夹（或卷），请将文件存储在远程服务器上。这样应用服务器上的本地管理员就不能随意访问其他人的文件夹。（除非他们具有域管理员或企业管理员权限）您可以设置一个大型网络驱动器并在其上拥有不同的用户文件夹，每个文件夹都使用 NTFS/其他解决方案进行加密，并且只有该单个用户的读/写权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T01:41:15.283

注册表中有一个用于隐藏映射驱动器的键。

如果您想停止出现在“我的电脑”中的任何驱动器组合

在注册表中添加“NoDrives”的二进制值

> “HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer”

这是所有值的表格（请注意，您可以将值相加以隐藏多个驱动器，该值也是二进制类型但必须以十六进制输入，因此如果您将几个驱动器相加，请准备好进行一点十六进制数学运算. ) :

```
A 1 00 00 00
B 2 00 00 00
C 4 00 00 00
D 8 00 00 00
E 16 00 00 00
F 32 00 00 00
G 64 00 00 00
H 128 00 00 00
I 00 1 00 00
J 00 2 00 00
K 00 4 00 00
L 00 8 00 00
M 00 16 00 00
N 00 32 00 00
O 00 64 00 00
P 00 128 00 00
Q 00 00 1 00
R 00 00 2 00
S 00 00 4 00
T 00 00 8 00
U 00 00 16 00
V 00 00 32 00
W 00 00 64 00
X 00 00 128 00
Y 00 00 00 1
Z 00 00 00 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T01:50:43.950

即使驱动器号被隐藏——除非您更改文件系统本身的 ACL，否则卷仍然可以访问——为什么这如此令人不快？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T01:57:00.567

NTFS 支持在目录中安装卷。

示例 - 而不是将外部驱动器安装为`D:`，您可以将其安装在`C:\mountedVolumes\externalHardDrive`

然后，您可以使用父文件夹 ( `mountedVolumes`) 上的 ACL 来防止您以外的用户访问它。如果他们无法进入文件夹，他们就无法进入驱动器，或者看到它在那里。它只是看起来像一个他们无法打开的文件夹。

注意：这假设您具有管理权限（至少在您第一次设置时），而其他人没有（因此他们不能只是拥有所有权`mountedVolumes`并进入驱动器）

# c# - 您如何管理大型应用程序的 .NET app.config 文件？

> ID：89245
> 
> 赞同：21
> 
> 时间：2008-09-18T01:40:40.247
> 
> 标签：c#, .net, configuration

假设一个大型复合应用程序构建在几个封装在它们自己的程序集中的基础组件上：（数据库读取、协议处理程序等）。对于某些部署，这可能包括 20 多个程序集。这些程序集中的每一个都具有设置或配置信息。我们的团队倾向于喜欢 VS 设置编辑器（以及它生成的易于使用的代码！），应用程序与用户的区别满足了我们的大部分需求。

但....

将许多配置部分复制并粘贴到我们应用程序的 .xml 中是非常乏味的。此外，对于跨应用程序往往具有相似配置的共享组件，这意味着我们需要在多个 .config 文件中维护重复的设置。

微软的 EntLib 使用外部工具来生成怪物 .config 文件解决了这个问题，但这也让人感觉很笨拙。

您使用哪些技术来管理包含来自多个共享程序集的部分的大型 .NET .config 文件？某种包含机制？自定义配置阅读器？

跟进：

Will 的[答案](https://stackoverflow.com/questions/89245/how-do-you-manage-net-appconfig-files-for-large-applications#89618)正是我所得到的，并且对于平面键/值对部分看起来很优雅。有没有办法将此方法与[自定义配置部分](https://stackoverflow.com/questions/89245/how-do-you-manage-net-appconfig-files-for-large-applications#89618)结合起来？

还感谢有关为不同构建目标管理不同 .configs 的建议。这也很有用。

戴夫

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-18T01:43:15.903

您使用一个指向其他配置文件的主配置文件。 [这是如何执行此操作的示例。](http://blog.andreloker.de/post/2008/06/Keep-your-config-clean-with-external-config-files.aspx)

* * *

如果链接失效，您要做的是为特定配置部分指定[configSource 。](http://msdn.microsoft.com/en-us/library/system.configuration.sectioninformation.configsource.aspx)这允许您在单独的文件中定义该特定部分。

```
<pages configSource="pages.config"/> 
```

这意味着在包含整个`<pages />`节点树的同一目录中有一个名为“pages.config”的文件。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-18T04:46:40.410

我首选的方法是使用 MSBuild，如果您右键单击一个项目并单击“卸载”，则会弹出一个新的菜单选项，上面写着“编辑”。选择它，它将打开项目文件以便您可以编辑它，向下滚动直到找到一个名为“AfterBuild”的注释掉的部分。

然后，您可以添加如下内容：

```
<Target Name="AfterBuild">
    <Delete Files="$(TargetDir)$(TargetFileName).config" />
    <Copy SourceFiles="$(ProjectDir)$(Configuration).config" DestinationFiles="$(TargetDir)$(TargetFileName).config" />
</Target> 
```

这将使用名为 [Release|Debug]app.exe.config 的应用程序配置替换应用程序配置。因此，您可以根据项目的构建方式维护单独的配置。

但是一个快速而肮脏的选择（如果您不想使用 msbuild）是只维护单独的配置文件，然后定义要包含的配置文件，如下所示：

```
<appSettings configSource="Config\appSettingsDebug.config"/>
<roleManager configSource="Config\roleManagerDebug.config"/> 
```

如果你正在做一个 asp.net 应用程序，微软提供了一个很棒的实用程序，叫做“Web 部署项目”，它可以让你轻松管理所有这些，[点击这里](http://www.microsoft.com/downloads/details.aspx?familyid=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T02:57:52.603

管理大量配置的一种好方法是创建自定义配置部分。[Phil Haack 在这篇文章中通过 3 个简单的步骤自定义配置部分](http://haacked.com/archive/2007/03/12/custom-configuration-sections-in-3-easy-steps.aspx)很好地讨论了这一点

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T07:19:48.637

为每个部署/测试环境设置构建配置，并根据每个构建配置使用单独的配置文件。

ScottGu 有[一篇](http://weblogs.asp.net/scottgu/archive/2007/09/21/tip-trick-automating-dev-qa-staging-and-production-web-config-settings-with-vs-2005.aspx)关于这个的好帖子，效果很好。我们唯一的怪癖是我们需要确保在每次构建之前从 TFS 签出配置文件 (web.config) 以进行编辑，以便可以复制它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T02:36:26.993

我们创建了一个类似于 ConfigurationManager 的 AssemblySettingsConfig 类，但会为每个单独的程序集加载一个 .config。所以应用程序有一个 .config，它引用的任何 DLL 都有自己的 .config 文件。到目前为止效果很好。

# sql - 用复杂的sql命名excel中的列

> ID：89246
> 
> 赞同：0
> 
> 时间：2008-09-18T01:40:43.240
> 
> 标签：sql, excel

我正在尝试使用 get external 运行此 SQL。

它可以工作，但是当我尝试重命名子查询或任何相关内容时，它会删除它。

我试过了`as`，`as`名字在里面`''`，`as`然后名字在里面`""`，和空格一样。这样做的正确方法是什么？

相关SQL：

```
SELECT list_name, app_name, 
    (SELECT fname  + ' ' + lname  
     FROM dbo.d_agent_define map 
     WHERE map.agent_id = tac.agent_id) as agent_login, 
   input, CONVERT(varchar,DATEADD(ss,TAC_BEG_tstamp,'01/01/1970'))
FROM dbo.maps_report_list list 
JOIN dbo.report_tac_agent tac ON (tac.list_id = list.list_id)
WHERE input = 'SYS_ERR' 
   AND app_name = 'CHARLOTT'
   AND convert(VARCHAR,DATEADD(ss,day_tstamp,'01/01/1970'),101) = '09/10/2008'
   AND list_name LIKE 'NRBAD%'
ORDER BY agent_login,CONVERT(VARCHAR,DATEADD(ss,TAC_BEG_tstamp,'01/01/1970')) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T01:55:13.223

您可以摆脱`dbo.d_agent_define`子查询，只需将连接添加到代理定义表。

这段代码会起作用吗？

```
select list_name, app_name, 
map.fname + ' ' + map.lname as agent_login, 
input, 
convert(varchar,dateadd(ss,TAC_BEG_tstamp,'01/01/1970')) as tac_seconds
from dbo.maps_report_list list 
join dbo.report_tac_agent tac 
on (tac.list_id = list.list_id) 
join dbo.d_agent_define map
on (map.agent_id = tac.agent_id)
where input = 'SYS_ERR' 
and app_name = 'CHARLOTT' 
and convert(varchar,dateadd(ss,day_tstamp,'01/01/1970'),101) = '09/10/2008' 
and list_name LIKE 'NRBAD%' 
order by agent_login,convert(varchar,dateadd(ss,TAC_BEG_tstamp,'01/01/1970')) 
```

请注意，我命名了您的 dateadd 列，因为它没有名称。我还试图保持你如何加入的惯例。我会对此查询做一些不同的事情以使其更具可读性，但我只专注于摆脱子查询问题。

我没有这样做，但我建议您使用从中获取它们的表来限定所有列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T02:23:36.180

要删除 SELECT 语句中的子查询，我建议如下：

```
SELECT list_name, app_name, map.fname + ' ' + map.lname as agent_login, input, convert(varchar,dateadd(ss, TAC_BEG_tstamp, '01/01/1970))
FROM dbo.maps_report_list inner join
  (dbo.report_tac_agent as tac inner join dbo.d_agent_define as map ON (tac.agent_id=map.agent_id)) ON list.list_id = tac.list_id
WHERE input = 'SYS_ERR' and app_name = 'CHARLOTT' and convert(varchar,dateadd(ss,day_tstamp,'01/01/1970'),101) = '09/10/2008' 
    and list_name LIKE 'NRBAD%' order by agent_login,convert(varchar,dateadd(ss,TAC_BEG_tstamp,'01/01/1970')) 
```

我首先使用括号来创建 dbo.report_tac_agent 和 dbo.d_agent_define 之间的内部连接。现在这是一组连接数据。然后将这些表的组合加入到您的列表中，我假设这里是驱动表。如果我了解您要对子选择做什么，这应该对您有用。

正如另一张海报所说，您应该在列上使用表名（例如 map.fname），它只是让事情变得容易理解。我没有在我的示例中，因为我注意到 100% 确定哪些列与哪些表一起使用。请让我知道这是否不适合您以及它返回的数据是如何错误的。这将使在需要时更容易解决。

# perl - Perl：CGI 和 DBI 模块的变量范围问题

> ID：89257
> 
> 赞同：3
> 
> 时间：2008-09-18T01:42:44.610
> 
> 标签：perl, module, variables, scope, cgi

我遇到了以前从未遇到过的变量范围问题。我正在使用 Perl 的 CGI 模块和对 DBI 的 do() 方法的调用。这是代码结构，简化了一点：

```
use DBI;
use CGI qw(:cgi-lib);
&ReadParse;
my $dbh = DBI->connect(...............);
my $test = $in{test};
$dbh->do(qq{INSERT INTO events VALUES (?,?,?)},undef,$in{test},"$in{test}",$test); 
```

#1 占位符变量评估为好像它未初始化。其他两个占位符变量有效。

**问题：为什么 %in 散列在 do() 的上下文中不可用，除非我将它用双引号（#2 占位符）括起来或将值重新分配给新变量（#3 占位符）？**

我认为这与 CGI 模块的 ReadParse() 函数如何将范围分配给 %in 散列有关，但我不太了解 Perl 范围，无法理解为什么 %in 在顶层可用，但不能在我的内部使用（） 陈述。

如果有人确实了解范围界定问题，是否有更好的方法来处理它？将所有 %in 引用用双引号括起来似乎有点混乱。为每个查询参数创建新变量是不现实的。

为了清楚起见，我的问题是关于变量范围的问题。我意识到 ReadParse() 不是使用 CGI 获取查询参数的推荐方法。

我正在使用 Perl 5.8.8、CGI 3.20 和 DBI 1.52。提前感谢任何阅读本文的人。

@Pi 和 @Bob，感谢您的建议。预先声明 %in 的范围没有效果（我总是使用严格的）。结果与之前相同：在 db 中，col1 为空，而 cols 2 和 3 设置为预期值。

作为参考，这里是 ReadParse 函数（见下文）。它是 CGI.pm 的一部分的标准函数。根据我的理解，我并不是为了设置范围而初始化 %in 哈希（除了满足严格之外），因为在我看来该函数可以处理：

```
sub ReadParse {
    local(*in);
    if (@_) {
      *in = $_[0];
    } else {
    my $pkg = caller();
      *in=*{"${pkg}::in"};
    }
    tie(%in,CGI);
    return scalar(keys %in);
} 
```

我想我的问题是在 do() 的上下文中获取 %in 哈希的最佳方法是什么？再次感谢！我希望这是为我的原始问题提供附加信息的正确方法。

@Dan：我听说过 &ReadParse 语法。我通常会使用 CGI::ReadParse() 但在这种情况下，我认为最好坚持[CGI.pm 文档的](http://search.cpan.org/src/LDS/CGI.pm-3.42/cgi-lib_porting.html)确切方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T02:19:09.327

它实际上看起来不像您在使用它，如文档中所述： [https ://metacpan.org/pod/CGI#COMPATIBILITY-WITH-CGI-LIB.PL](https://metacpan.org/pod/CGI#COMPATIBILITY-WITH-CGI-LIB.PL)

如果你必须使用它，那么 CGI::ReadParse(); 似乎更明智且不那么粗暴的语法。虽然我看不出它在这种情况下有什么不同，但它是一个绑定变量，所以谁知道它在做什么；）

您不能使用更常见的 $cgi->param('foo') 语法是否有特殊原因？它更干净一点，并且以一种更可预测的方式弄脏了你的命名空间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T01:48:10.370

`use strict;`. 总是。

尝试声明

```
our %in; 
```

看看是否有帮助。否则，`strict`可能会产生更有用的错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T02:54:38.790

我不知道出了什么问题，但我可以告诉你一些不是的事情：

*   这不是范围界定问题。如果是，那么没有一个实例`$in{test}`将起作用。
*   这不是古老的`&`调用语法。（这不是“正确的”，但在这种情况下它是无害的。）

`ReadParse`是一段讨厌的代码。它修改符号表以在调用包中创建全局变量 %in。更糟糕的是它是一个绑定变量，因此访问它可以（理论上）做任何事情。查看 CGI.pm 的源代码，该`FETCH`方法只是调用该`params()`方法来获取数据。我不知道为什么 fetch`$dbh->do()`不起作用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T01:54:44.283

首先，这不在 do 的上下文/范围内。它仍然是在 main 或 global 的上下文中。在以某种与 perl 中的子例程或不同“类”相关的方式输入 {} 之前，您不会离开上下文。在 () 括号内，您不会离开范围。

你给我们的样本是一个未初始化的哈希，正如 Pi 所建议的，使用 strict 肯定会阻止那些发生。

您能给我们一个更具代表性的代码示例吗？您在哪里设置 %IN 以及如何设置？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T02:07:27.157

那里的东西很坏。Perl 的作用域相对简单，除非你在做一些愚蠢的事情，否则你不太可能偶然发现任何奇怪的东西。正如建议的那样，打开严格的编译指示（以及警告。事实上，无论如何你都应该同时使用）。

如果无法看到 %in 是如何定义的，就很难判断发生了什么（这与那个看起来很讨厌的 ReadParse 调用有关吗？你为什么要用前导 & 来调用它，顺便说一句？那个语法被认为是死的走了很长时间）。我建议发布更多代码，这样我们就可以看到发生了什么......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T03:19:11.350

您使用的是什么版本的 DBI？从[DBI 变更日志](http://search.cpan.org/~timb/DBI-1.607/Changes)来看，1.00 之前的版本似乎不支持属性参数。我怀疑“未初始化”`$in{test}`实际上`undef`是您传递给`$dbh->do()`.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T09:35:59.543

从您给出的示例中，这*不是*范围问题，或者任何参数都不起作用。

看起来 DBI（或 DBD，不确定在哪里使用绑定参数）不尊重领带魔术。解决方法是对传递给它的内容进行字符串化或复制，就像第二个和第三个参数一样。

使用 SQLite 和 DBI 1.53 进行的简单测试表明它工作正常：

```
$ perl -MDBI -we'sub TIEHASH { bless {} } sub FETCH { "42" } tie %x, "main" or die; my $dbh = DBI->connect("dbi:SQLite:dbname=dbfile","",""); $dbh->do("create table foo (bar char(80))"); $dbh->do("insert into foo values (?)", undef, $x{foo}); print "got: " . $dbh->selectrow_array("select bar from foo") . "\n"; $dbh->do("drop table foo")'
got: 42 
```

愿意分享您使用的数据库吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-24T18:31:57.780

根据 DBI 文档：目前，绑定绑定变量不起作用。

DBI 在引擎盖下非常复杂，不幸的是，为了提高效率，DBI 经历了一些导致您的问题的过程。我同意其他所有说要摆脱丑陋的旧 cgi-lib 样式代码的人的观点。在没有好的框架（去 Catalyst）的情况下做 CGI 已经够令人不快的了，更不用说已经过时了十年的东西了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T02:49:55.180

好的，试试这个：

```
使用 CGI；
我的％；
CGI::ReadParse(\%in);

```

这可能会有所帮助，因为它实际上使用了您已声明的变量，因此可以控制范围（另外它会让您`use strict`没有其他可能使水变得混乱的肮脏）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T04:00:50.533

由于这开始看起来像一个`tie()`问题，请尝试以下实验。将其保存为 foo.pl 并运行为`perl foo.pl "x=1"`

```
use CGI;

CGI::ReadParse();
p($in{x}, "$in{x}");

sub p { my @a = @_; print "@a\n" } 
```

它应该打印`1 1`。如果没有，我们已经找到了罪魁祸首。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T08:23:52.300

我刚刚从[http://www.carcomplaints.com/test/test.pl.txt](http://www.carcomplaints.com/test/test.pl.txt)尝试了您的测试代码，它可以立即在我的计算机上运行，​​没有问题。我得到了预期的三个值。我没有将它作为 CGI 运行，而是使用：

```
...
use CGI qw/-debug/;
... 
```

我在控制台（）上写了一个变量`test=test`，你的脚本插入没有问题。

但是，如果您忽略它， tt 将插入一个空字符串和两个 NULL。这是因为您将值插入到字符串中。这将生成一个字符串，`$in{test}`其值为`undef`当前。`undef`字符串化为一个空字符串，这是插入数据库的内容。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-09-18T02:21:36.700

试试这个

%in = ReadParse();

但我对此表示怀疑。您是否正在尝试获取查询参数或其他内容？

# garbage-collection - 如何在没有 gc 的情况下实现闭包？

> ID：89266
> 
> 赞同：13
> 
> 时间：2008-09-18T01:43:48.053
> 
> 标签：garbage-collection, code-generation, language-design

我正在设计一种语言。首先，我想决定生成什么代码。该语言将具有类似于 javascript 的词法闭包和基于原型的继承。但我不是 gc 的粉丝，并尽量避免。那么问题来了：有没有一种优雅的方式来实现闭包，而无需在堆上分配堆栈帧并将其留给垃圾收集器？

我的第一个想法：

1.  使用引用计数和垃圾收集周期（我不太喜欢这个）
2.  使用意大利面条堆栈（看起来非常低效）
3.  将闭包的形成限制在某些上下文中，这样我就可以摆脱返回地址堆栈和本地堆栈。

我不会使用高级语言或遵循任何调用约定，所以我可以随心所欲地粉碎堆栈。

（编辑：我知道引用计数是垃圾收集的一种形式，但我在其更常见的含义中使用 gc）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-18T02:00:22.540

如果您可以通过不使用 GC 来解释您试图避免的事情，这将是一个更好的问题。我相信您知道，大多数提供词法闭包的语言都将它们分配在堆上，并允许它们在创建它们的激活记录中保留对变量绑定的引用。

我知道该方法的唯一替代方法是`gcc`嵌套函数的用途：为函数创建一个蹦床并将其分配到堆栈上。但正如 gcc 手册所说：

> 如果您在包含函数退出后尝试通过其地址调用嵌套函数，那么一切都会崩溃。如果您在包含范围级别退出后尝试调用它，并且如果它引用了一些不再在范围内的变量，那么您可能很幸运，但冒险并不明智。但是，如果嵌套函数没有引用超出范围的任何内容，那么您应该是安全的。

简短的版本是，您有三个主要选择：

*   在堆栈上分配闭包，并且在包含函数退出后不允许使用它们。
*   在堆上分配闭包，并使用某种垃圾收集。
*   做原创研究，可能从 ML、Cyclone 等所拥有的区域开始。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-26T03:14:59.280

I understand that I'm very late, but I stumbled upon this question by accident.

I believe that full support of closures indeed requires GC, but in some special cases stack allocation is safe. Determining these special cases requires some escape analysis. I suggest that you take a look at the [BitC language papers](http://www.bitc-lang.org/docs/), such as [*Closure Implementation in BitC*](http://www.bitc-lang.org/docs/bitc/closures.html#3.1). (Although I doubt whether the papers reflect the current plans.) The designers of BitC had the same problem you do. They decided to implement a special non-collecting mode for the compiler, which denies all closures that might escape. If turned on, it will restrict the language significantly. However, the feature is not implemented yet.

I'd advise you to use a collector - it's the most elegant way. You should also consider that a well-built garbage collector allocates memory faster than malloc does. The BitC folks really do value performance and they still think that GC is fine even for the most parts of their operating system, Coyotos. You can migitate the downsides by simple means:

*   create only a minimal amount of garbage
*   let the programmer control the collector
*   optimize stack/heap use by escape analysis
*   use an incremental or concurrent collector
*   if somehow possible, divide the heap like Erlang does

Many fear garbage collectors because of their experiences with Java. Java has a fantastic collector, but applications written in Java have performance problems because of the sheer amount of garbage generated. In addition, a bloated runtime and fancy JIT compilation is not really a good idea for desktop applications because of the longer startup and response times.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-15T14:43:48.037

[该线程](http://groups.google.com/group/comp.lang.functional/browse_thread/thread/905b55291982e1f8)可能会有所帮助，尽管此处的某些答案已经反映了那里的答案。

一张海报提出了一个很好的观点：

> 似乎您希望“在没有真正垃圾收集的情况下”对闭包进行垃圾收集。请注意，闭包可用于实现 cons 单元。所以你的问题似乎是关于“没有真正的垃圾收集”的垃圾收集——有丰富的相关文献。将问题限制为闭包并没有真正改变它。

所以答案是：**不**，没有优雅的闭包方式，也没有真正的 GC。您可以做的最好的事情是一些黑客攻击将您的闭包限制为特定类型的闭包。如果您有适当的 GC，所有这些都是不必要的。

所以，我的问题反映了这里的其他一些问题——你为什么不想实现 GC？一个简单的标记+扫描或停止+复制大约需要 2-300 行 (Scheme) 代码，并且在编程工作方面并没有那么糟糕。在使您的程序变慢方面：

1.  您可以实现更复杂的 GC，它具有更好的性能。
2.  想想你的语言中的所有内存泄漏程序都不会受到影响。
3.  使用可用的 GC 进行编码是一件幸事。（想想 C#、Java、Python、Perl 等……与 C++ 或 C）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-11T10:06:24.360

> 使用引用计数和垃圾收集周期（我不太喜欢这个）

可以设计你的语言，使之没有循环：如果你只能制造新的对象而不改变旧的对象，如果制造一个对象不能制造一个循环，那么循环就不会出现。Erlang 本质上就是这样工作的，尽管在实践中它确实使用了 GC。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T02:08:14.813

C++ 0x 规范定义了没有垃圾收集的 lambda。简而言之，在 lambda 闭包包含不再有效的引用的情况下，规范允许非确定性行为。例如（伪语法）：

```
(int)=>int create_lambda(int a)
{
    return { (int x) => x + a }
}

create_lambda(5)(4)    // undefined result 
```

此示例中的 lambda 指的`a`是在堆栈上分配的变量 ( )。但是，该堆栈帧已被弹出，并且在函数返回后*不一定可用。*在这种情况下，它可能会工作并`9`作为结果返回（假设编译器语义健全），但没有办法保证它。

如果您要避免垃圾收集，那么我假设您还允许显式堆与堆栈分配和（可能）指针。如果是这种情况，那么您可以像 C++ 那样做，并假设使用您的语言的开发人员足够聪明，可以使用 lambdas 发现问题情况并显式复制到堆中（就像您返回一个在其中合成的值一样）一个函数）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T02:04:56.397

如果您有精确复制 GC 的机制，您可以最初在堆栈上分配并复制到堆并更新指针，如果您在退出时发现指向此堆栈帧的指针已转义。这样，只有当您确实捕获了包含此堆栈帧的闭包时，您才需要付费。这是否有帮助或有害取决于您使用闭包的频率以及它们捕获的数量。

您也可以研究 C++0x 的方法 ( [N1968](http://www.research.att.com/~bs/N1968-lambda-expressions.pdf) )，尽管正如人们对 C++ 所期望的那样，它包括依靠程序员指定要复制的内容和引用的内容，如果您弄错了，您只会获得无效访问。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-15T14:17:30.277

您可以假设所有闭包最终都将被调用一次。现在，当调用闭包时，您可以在闭包返回时进行清理。

你打算如何处理返回的对象？它们必须在某个时候进行清理，这与闭包的问题完全相同。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-18T02:05:42.370

或者根本不做GC。在某些情况下，最好忘记内存泄漏，并在完成后让进程清理它。

根据您对 GC 的疑虑，您可能会害怕定期 GC 扫描。在这种情况下，您可以在项目超出范围或指针更改时执行选择性 GC。我不确定这会有多贵。

@艾伦

如果在包含函数退出时不能使用闭包，那么闭包有什么用？据我了解，这就是闭包的全部意义所在。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-07-17T19:41:37.387

> 那么问题来了：有没有一种优雅的方式来实现闭包，而无需在堆上分配堆栈帧并将其留给垃圾收集器？

GC 是一般情况下的唯一解决方案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-06-01T18:44:04.460

迟到总比不到好？

您可能会发现这很有趣：[差异执行](https://stackoverflow.com/questions/371898/how-does-differential-execution-work)。

这是一种鲜为人知的控制结构，它的主要用途是对用户界面进行编程，包括在使用时可以动态更改的用户界面。它是模型-视图-控制器范式的重要替代方案。

我提到它是因为有人可能认为这样的代码会严重依赖闭包和垃圾收集，但控制结构的副作用是它消除了这两者，至少在 UI 代码中是这样。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-21T13:39:31.193

创建多个堆栈？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-15T14:34:14.297

我读过机器学习的最后一个版本只很少使用 GC

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-11-02T08:51:27.113

我想如果这个过程很短，这意味着它不能使用太多的内存，那么 GC 是不必要的。这种情况类似于担心堆栈溢出。不要嵌套太深，也不能溢出；不要运行太久，你不需要GC。清理变成了简单地回收您预先分配的大区域的问题。即使是较长的进程也可以分成更小的进程，这些进程预先分配了自己的堆。例如，这适用于事件处理程序。如果您正在编写编译器，它就不能很好地工作；在这种情况下，GC 肯定不会有太大的障碍。

# c++ - Best C++ IDE or Editor for Windows

> ID：89275
> 
> 赞同：74
> 
> 时间：2008-09-18T01:46:47.033
> 
> 标签：c++, windows, ide, editor

What is the best C++ IDE or editor for using on Windows? I use Notepad++, but am missing IntelliSense from Visual Studio.

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2008-09-18T01:47:27.703

Um, that's because Visual Studio is the best IDE. Come back to the darkside.

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-09-18T01:48:21.087

I've found the latest release of NetBeans, which includes C/C++ support, to be excellent.

[http://www.netbeans.org/features/cpp/index.html](http://www.netbeans.org/features/cpp/index.html)

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-09-18T07:21:42.767

I personally like Visual Studio combined with a third party add-in such as Visual Assist ([http://www.wholetomato.com/](http://www.wholetomato.com/)). I've tried a few of the others and always ended up back with Visual Studio. Plus, Visual Studio is a widely used product in development industries, so having experience using it can only be a plus.

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2008-09-18T02:03:34.857

The [Eclipse CDT](http://www.eclipse.org/cdt/) works well for me. It supports MinGW and Cygwin as targets. It also integrates well with CVS and Subversion.

The latest build, Ganymede, is available [here](http://www.eclipse.org/downloads/download.php?file=/tools/cdt/releases/ganymede/dist/cdt-master-5.0.0.zip).

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-09-18T01:58:14.777

There are the free "Express" versions of Visual Studio. Given that you like Visual Studio and that the "Express" editions are free, there is no reason to use any other editor.

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-09-18T02:00:07.360

I vote for Visual Studio, but it seems that C++ is treated like second class citizen (not the compiler and stuff but IDE support) compared to .NET languages like C#, but hopefully MS will do something about it by the next version of Visual Studio (new standard is coming and they promised that 10 should be new 6).

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-09-18T07:42:51.560

VIsual studio is by far the best IDE but you can also take a look at [Code::Blocks](http://www.codeblocks.org/)

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-09-18T02:07:51.803

I prefer to use [Microsoft Visual C++](http://www.microsoft.com/Express/) express on windows. Though the 2008 ide is fine, the 2005 express has better support for many of the open projects which you might want to participate in. It's a pain to compile Firefox or a half life 2 mod on 2008\. Also as a general tip when looking for software, I like to search wikipedia for "comparison of " In this case you would search [comparison of Integrated Development Environments](http://en.wikipedia.org/wiki/Comparison_of_integrated_development_environments).

Hope that was helpful.

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2009-05-24T14:48:21.777

If you are interested in doing Qt development, then Qt Creator works fine and is free.

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2008-09-18T05:30:59.227

I think the debugger in Visual Studio (Express) is the killer thing that prevents me from using another IDE.

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2009-05-24T14:46:10.627

Visual Studio + Visual Assist X ([http://www.wholetomato.com/](http://www.wholetomato.com/))

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-09-18T02:06:04.553

There are some features in an IDE that are so transformative that you don't know how you lived without them. Integrated help was one. IntelliSense-like functionality was another. VS 6.0's Debug and Continue was absolutely killer. Visual Studio kicked butt for quite a while. Not bad, given the awful NeXTstep rip-off it all started as. (Or is it that memories of NeXTstep has faded until VS seems okay?)

Sure, there are much better EDITORS that VS, but as a complete package for Win32 development nothing seems to come close.

There are free Express editions now, but they seem pretty crippled.

I am quite enjoying Eclipse under Linux (and derivatives of it on Windows used in some FPGA vendor toolchains). I -really- don't like the lack of integrated MSDN-style help, though.

I think it's basically down to those two choices.

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-09-18T02:07:49.400

The [Zeus](http://www.zeusedit.com) editor has support for C/C++ and it also has a form of intellisensing.

It does its intellisensing using the tags information produced by **ctags**:

[alt text http://www.zeusedit.com/images/_lookmain.jpg](http://www.zeusedit.com/images/_lookmain.jpg)

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2008-09-22T15:09:14.580

Emacs. Xemacs works fine under Windows. For using it as an IDE, I recommend running it under Cygwin.

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2009-05-24T13:56:34.533

Visual studio is the most up to date and probably "best" free ide. Dev C++ is a little dated, and mingw doesn't compile most of boost, (except regex). Most of the other compilers are dated and fading, like mars and borland. But you can use whatever you like!

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-06-05T22:11:18.117

One that hasn't been mentioned is [CodeLite](http://codelite.org/Main/ReadMore), a powerful open-source, cross platform IDE. It has code completion amongst other features.

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2009-06-05T22:26:32.517

I will quote myself from this question: [https://stackoverflow.com/questions/780837/what-is-a-good-linux-ide-for-code-completion/917854#917854](https://stackoverflow.com/questions/780837/what-is-a-good-linux-ide-for-code-completion/917854#917854)

> Someone already said this before me, but QtCreator is really good for Qt4 development.
> 
> Not only it has a really good code completion support. It also knows a little more about the code and what to complete then I thought I needed. For example it knows about slots/signals. This means that connecting slots/signals via code is much easier then before.
> 
> The code editing is really nice. I remember that when refactoring code, (a few variables starting with underscore) it remembered the cursor position between lines and this made the refactoring much easier. The code indentation is smart enough to not get in my way (KDevelop was configurable, but QtCreator learns how I code. At least it feels like it does).
> 
> Then there are the cool key combinations. Most of the functionality of the IDE can be accessed using shortcuts. The "control+k" thingie is a nice thing, which some command line users would like, but I am more GUI oriented. I don't use it.
> 
> What I really like, is the split window command. Yes, KDevelop3 does it, but not as nice as QtCreator. My favorite is control+e,3 which I use to display the header and implementations of my classes. Once again, the navigation here is the best I have seen (control+e,o).
> 
> It also has a nice SCM integration. I usually use SVN, and quite frankly it's not as good as I need: no shortcut to diff the project, no diff to commit the whole project, no option to commit several files.
> 
> I also don't like the "total integration of external tools". I still like the external QtAssistant - control+tab is easier to read large articles. But.... when you define a QString s, and 3 lines bellow you want to read the interface of QString, you put your cursor on "s" and press F1 - the assistant comes as a sidebar with QString's documentation. A huge advantage.
> 
> Want to follow a definition? F2 to the help. F4? Changes header/implementation (yes, eclipse does this better...).
> 
> The debugger is good. It's not as good as VisualStudio but ... it has support for Qt4 internals (you can see the value of QString and QList!).
> 
> I can continue... but IMHO you will need to give it a second and third try. It really is a good product. Not as flexible as Eclipse (hi ryansstack), but it's a really small, fast and young project. I stopped developing QDevelop because I really found what I was looking for.
> 
> ps: yes, I mean stopped developing QDevelop. I was in the development team.

My response is for Qt4 development only. Be warned.

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2008-09-18T02:00:56.047

SlickEdit is very cool, and does support something like intellisense. At my current company I now use Visual Studio, and I've mostly gotten used to it - but there are still some SlickEdit features I miss.

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2008-09-18T04:56:39.870

As a complete all-in one package, Visual Studio 2008 is the best IDE for C++ development with Windows

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2009-05-24T14:13:51.723

Visual studio is great, but there are few tricks you can enhance it with. SonicFileFinder is one - helps you to search source files by partial match. You can map solution-tree to Alt+1, partial filename search to alt+2, and properties-window to alt+3\. These are the three most used windows.

Another great tool that is ofter misunderstood is ctrl+shift+F shortcut for searching file contents. People dont use because it's so slow, but my advice is - deal with it. Searching the whole solution (or even all files in project folder) is only slow the first time you use it. Consequitive searches are as fast as jump-to-definition-feature.

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2009-05-24T14:35:05.300

I've tried SlickEdit, Notepad++, emacs, jEdit and Visual Studio. VS wins hands-down for Best Windows IDE.

jEdit is probably the best GUI cross-platform editor/almost-IDE, and emacs is probably the best terminal cross-platform editor/almost-IDE. The advantage with using these is that when you jump to a Mac or Linux box, you know how they work.

I tried Eclipse, but it ran like a no-legged dog it was so slow, so I didn't use it much. Maybe tech is better now, but eh.

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2009-06-05T22:17:52.003

With Intellisense, code folding, edit and continue, and a whole host of other features, Visual Studio is certainly the best IDE. However, for simple code editing, I often use UltraEdit. It has some great features not found in Visual Studio. One surprisingly useful feature is being able to select a column in the editor. You can find and replace within the column (useful for tabs vs. spaces wars...) delete the column, etc...

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2011-01-11T22:25:16.510

How about CodeBlocks, i find it so fine with me, especially the new 10.05 version.

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2008-09-18T07:49:30.093

I would recommend [C++Builder](http://www.codegear.com/products/cppbuilder), from Embarcadero, for C++ work and there is also a [free version](http://www.turboexplorer.com/) available. If you prefer Visual Studio, download one of free [express editions](http://www.microsoft.com/express/).

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2009-06-05T22:22:16.283

Here's another vote for Visual Studio. The debugger and Intellisense are definitely it's hallmarks. While other IDE's offer code-completion, I've often found them to be somewhat sluggish in this area for some reason (sluggish being a reference to the speed at which code-completion occurs and offers selections).

Other than VS, NetBeans is a good polished IDE and is updated on a very regular cycle.

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2009-06-15T18:23:51.263

I think it's largely a matter of taste, but I would recommend begginers to stick to a pure editor (vi, emacs...) instead of a full fledged IDE so they can figure out the whole toolchain that modern IDEs hide.

Just for the record, my weapon of choice is Emacs.

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2009-10-11T06:58:14.150

personally i dont like microsoft......I hate to admit that visual studio is the best IDE i ever use.....Netbeans is gud but drasticaly slow....other free IDEs are useless.. so people try to stick with VS....

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2009-12-08T18:41:27.247

M$ VS2008 is a better IDE for this.

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2010-09-28T07:44:08.583

The question says specifically IDE so I am guessing thats what you want. In that case, the main options are Visual Studio and Eclipse CDT as stated above. Of those, I personally prefer Eclipse. However, don't necessarily limit yourself to an IDE. I prefer to use vim as my editor and WinDbg as my debugger. For compilation, your project will probably dictate this. I currently use NMAke on the command line.

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2011-02-25T04:33:37.483

Use Visual Studio 2010\. You can get the full version free with [DreamSpark](http://dreamspark.com)

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2008-09-18T01:55:47.947

vi or gvim if you don't like terminals.

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2009-05-24T14:42:28.967

Personally, I have found [Bloodshed's Dev-C++](http://www.bloodshed.net/devcpp.html) to be very good. However, I do not recall an update in a very long time. I have, because of this, switched over to NetBeans for everything.

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2009-06-28T17:03:28.637

notepad++ or codeblocks for large projects

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2010-01-14T16:09:09.723

I think the anwser to this question depends on following question: Do you want to develop cross-platform applications ?
If the anwser to this question is a clear YES, than you should start right away with some IDE that support cross-platform compilers like gcc/mingw.

Personally ive tried CodeBlocks and QtCreator beside VS... If developing cross-platform software using Qt, surely QtCreator is the best choice. Since QtCreator is still a quite new IDE, it still has some bugs... for example it's "intelli-sense" doesnt support namespace aliaces yet.. but i think it will evolve pretty fast, to a very good and complete IDE.
Codeblocks is a quite "small" IDE, but has everything an IDE needs. Still its "Intelli-Sense" (especially when dealing with meta-programming stuff like boost), and debugger is less powerful than VS's.

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2010-04-14T19:40:07.427

QT and NetBeans are the best cpp IDE's that I've ever used.

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2010-04-14T19:58:55.673

My favorite IDE was good old `msdev.exe`, a.k.a., Microsoft Development Studio, a.k.a., Microsoft Visual C++ 6\. It was the last version of Visual C++ that didn't require me to get new hardware just to run it.

However, the compiler wasn't standard-compliant. Not even remotely.

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2010-06-04T19:00:56.430

Visual Studio BUT...

Go get ReSharper plugin from [http://www.jetbrains.com/resharper/index.html](http://www.jetbrains.com/resharper/index.html). I'm a Java developer who uses IntelliJ and ReSharper gives a lot of the IntelliJ functionality to Visual Studio.

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2010-09-04T17:21:43.673

It looks like you did not mention Ultimate++ iDE. It is quite fast. It is not perfect as Visual Studio but it has several useful features such as function list, it shows which function you are in,searches, multiple releases, package system, a gui designer a faster container library. Code completion...

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2010-09-28T08:08:03.410

I'm a bit surprised because nobody has mentioned Codeblocks: [http://codeblocks.org](http://codeblocks.org) I think it is probably one of the best IDE's for C++. It is specially useful if you do multiplatform programming, since it is available for Linux, Mac and Windows, and it uses the same project files for all versions. It works perfectly with mingw, allowing you to even perform cross-compiling. It also directly supports wxWidgets visual development.

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2010-12-27T12:07:10.970

c++ IDE for MSWindows 1-Visual Studio 2-CodeBlocks ([nighitly build](http://forums.codeblocks.org/index.php/board,20.0.html)) others (devcpp, netbeans, eclips,...) just sucks, dont waste your time

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2008-09-18T01:58:42.810

I have used Netbeans for java, and it works great. Not sure how it works with C++, though.

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2008-09-18T04:45:23.313

[Dev-C++](http://www.bloodshed.net/devcpp.html) is a complete stand alone debugger compiler and linker, and also offers "IntelliSense". If you want to break away from VS (that also includes VS express) i suggest using this tool.

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2011-09-29T19:52:41.800

[Ultimate++](http://www.ultimatepp.org/) if you want to program for both Linux and C++ also you have the choice to choose your compiler.

* * *

## 回答 #44

> 赞同：-1
> 
> 时间：2010-07-19T12:38:05.523

Dev C++ is also a nice IDE. It's not so user friendly, but it's usefull.

# asp.net - 什么是修剪 ASP.NET 网站的 GUI 的好方法？

> ID：89285
> 
> 赞同：1
> 
> 时间：2008-09-18T01:49:05.170
> 
> 标签：asp.net, security, user-interface

我一直在通过在该控件的 onload 事件中执行以下操作来修剪我们网站的 UI：

```
btnDelete.isVisible = user.IsInRole("can delete"); 
```

这变得非常乏味，因为有太多的控件需要反复检查。一旦我完成所有工作，设计师就会要求更改 UI，然后重新开始。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T01:51:25.277

一个简单的建议是根据访问权限将控件分组到面板中

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T01:54:07.610

我之前做过的事情是创建每个 ASP.NET 页面继承的自定义页面类（实际上，我对每个项目都执行此部分）。

此页面类包含 IsAdmin 属性。

然后，我将可能在模式之间可见或不可见的常用控件子类化为自定义控件，并添加代码以检查 Pages IsAdmin 属性。

所有这一切可能需要一个小时的工作，但如果您使用这些控件构建页面，它们会自动管理它们的模式。

另一个有趣的省时技巧是如果您需要将页面翻入和翻出只读模式。我向主基类添加了一个属性，然后添加了一个自定义控件，该控件在一种模式下呈现文本框，在另一种模式下呈现标签。

同样，在组件上花一点时间，但是您可以在 2 行代码中创建页面的只读版本......非常值得。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T01:59:57.767

您可能以错误的方式思考这种情况。与其考虑个人控制，不如从业务角色和他们有能力做的事情来考虑。这伴随着将控件分组到访问权限的面板中。例如，也许只有经理有删除和做其他事情的能力，而你有一个你检查的经理的角色。这样，如果有更改，您可以将用户移动到不同的角色。业务规则不应发生剧烈变化。随着新职位获得更多责任，总会有调整，但以这种方式思考应该可以最大限度地减少要进行的更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T02:00:17.610

一个快速而肮脏的选择是使用 asp:loginview 控件，它可以连接到用户角色。

不像 Jonathan 建议的自定义页面类选项那样优雅，如果它们遍布整个页面，可能会对性能产生一点影响。

# oracle - 两阶段提交/共享事务

> ID：89320
> 
> 赞同：4
> 
> 时间：2008-09-18T01:56:28.180
> 
> 标签：oracle

场景是这样的

我们有两个应用程序 A 和 B，它们都在单独的数据库（Oracle 9i）事务中运行

应用程序 A - 将一些数据插入数据库，然后调用应用程序 B 应用程序 B - 将一些数据插入数据库，与 A 的数据相关（通过外键）。将“ID”返回给应用程序 A 应用程序 A - 使用 ID 插入更多数据，包括来自 B 的 ID

现在，因为这些是单独的事务，但都依赖于彼此事务的数据，所以我们需要在对每个应用程序的调用之间提交。如果出现任何问题，这当然会使回滚变得非常困难。

您将如何解决这个问题，同时对代码进行最少的重构。这种情况肯定是 SOA 世界的普遍问题吗？

- - - 更新 - - - -

我在 Oracle 9i 中找不到任何东西，但是 Oracle 11g 提供了[DBMS_XA](http://www.morganslibrary.org/reference/dbms_xa.html)，这正是我所追求的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T02:20:26.593

你有三个选择：

1.  重新设计应用程序，以便您没有两个不同的进程（都具有数据库连接）写入数据库并将其整合到单个应用程序中。

2.  创建处理 A 和 B 的所有数据库事务的应用程序 C。

3.  滚动您自己的两阶段提交。应用程序 C 充当协调器。C 向 A 和 B 发出信号，询问他们是否准备好提交。A 和 B 进行处理，并以“就绪”或“失败”回复响应 C（请注意，如果一个进程挂起或死亡，C 应该有一个超时以避免无限等待）。如果双方都准备好回复，则 C 告诉他们提交。否则它会发送一个回滚信号。

请注意，如果应用程序 A 依赖于应用程序 B 的外键（您没有说明，因此这可能不是问题），您可能会遇到选项 3 的问题。Oracle 的读取一致性可能会阻止这种情况发生，因为应用程序 A 的事务将在应用程序 B 之前开始。只是一个警告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T07:28:48.320

几点建议：

*   使用[补偿交易](http://en.wikipedia.org/wiki/Compensating_transaction)。基本上，您可以撤消之前执行的事务。困难的部分是弄清楚要回滚哪些事务。

*   使用指示它只是临时的标志将应用程序 A 和 B 的数据提交到数据库。然后，在一切检查正常后，修改标志以指示数据是最终的。在夜间，运行批处理作业以清除尚未完成的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T02:30:02.640

您可以将应用程序 A 中的数据插入“临时”区域，以便应用程序 B 可以插入 A 和 B，而不会在任何一个应用程序中进行太多更改。它不是特别优雅，但它可能会奏效。

在另一种情况下，您可以向您的数据添加一个“确认”标志字段，该字段在整个过程成功运行后更新。如果在某一时刻失败，则可能更容易追踪您需要回滚的记录（实际上是删除）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T03:56:36.270

我喜欢这两种解决方案，所以我暂时避免发布这个。但是您也可以对主表进行更新，事先将受影响行的状态保存在某个缓存中。

这可以与两层相结合（Zathrus 提出的交通警察系统）——因为对于 neonski 使用“画板”表格或表格的解决方案来说，确实不需要它。这样做的缺点是您必须让您的过程/逻辑从工作区或主表中的工作区查询主表 - 或者可能将您的标志存储在主表中并在您提交数据时将其设置回主表。

我们团队的一位女士正在使用永久性工作台为我们的实时系统设计类似的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T03:44:28.623

```
App_A =={0}=>               database # App_A stores information for App_B
App_A ------> App_B                  # App_A starts App_B
              App_B <={0}== database # App_B retrieves the information
              App_B =={1}=> database # App_B stores more informaion
App_A <={2}== App_B                  # App_B returns 'ID' to App_A
App_A ={2,3}>               database # App_A stores 'ID' and additional data 
```

是我自己还是看起来应用程序 B 本质上只是 A 的子程序。我的意思是应用程序 B 在 A 询问之前什么都不做，而应用程序 A 在 B 返回 ID 之前什么也不做。这意味着将它们放在不同的应用程序甚至单独的线程中几乎没有意义。

# git - 如何在 Git 中恢复丢失的存储？

> ID：89332
> 
> 赞同：2142
> 
> 时间：2008-09-18T01:59:06.160
> 
> 标签：git, recovery, git-stash

我经常使用`git stash`and`git stash pop`来保存和恢复工作树中的更改。昨天我在我的工作树中进行了一些更改，我已经隐藏并弹出了这些更改，然后我对我的工作树进行了更多更改。我想回去查看昨天隐藏的更改，但`git stash pop`似乎删除了对相关提交的所有引用。

我知道如果我使用`git stash`然后*.git/refs/stash 包含*用于创建存储的提交的引用。并且*.git/logs/refs/stash 包含*整个存储。但是那些参考文献都没有了`git stash pop`。我知道提交仍在我的存储库中的某个地方，但我不知道它是什么。

有没有一种简单的方法可以恢复昨天的存储提交参考？

请注意，今天这对我来说并不重要，因为我每天都有备份，并且可以返回到昨天的工作树来获取我的更改。我问是因为必须有更简单的方法！

* * *

## 回答 #1

> 赞同：3433
> 
> 时间：2008-09-18T11:38:25.550

一旦您知道您删除的存储提交的哈希值，您就可以将其应用为存储：

```
git stash apply $stash_hash 
```

或者，您可以为它创建一个单独的分支

```
git branch recovered $stash_hash 
```

之后，您可以使用所有常规工具做任何您想做的事情。完成后，只需将树枝吹走。

# 查找哈希

如果您刚刚弹出它并且终端仍然打开，您仍然会[在屏幕上](https://stackoverflow.com/questions/89332/recover-dropped-stash-in-git/7844566#7844566)[打印散列值`git stash pop`](https://stackoverflow.com/questions/89332/recover-dropped-stash-in-git/7844566#7844566)（谢谢，Dolda）。

否则，您可以在 Linux、Unix 或 Windows 的 Git Bash 上使用它：

```
git fsck --no-reflog | awk '/dangling commit/ {print $3}' 
```

...或使用适用于 Windows 的 Powershell：

```
git fsck --no-reflog | select-string 'dangling commit' | foreach { $_.ToString().Split(" ")[2] } 
```

这将在提交图的提示处向您显示不再从任何分支或标签引用的所有提交——每个丢失的提交，包括您曾经创建的每个存储提交，都将在该图中的某个位置。

找到您想要的存储提交的最简单方法可能是将该列表传递给`gitk`：

```
gitk --all $( git fsck --no-reflog | awk '/dangling commit/ {print $3}' ) 
```

...或者如果使用 Windows 的 Powershell，请参阅[emragins 的答案。](https://stackoverflow.com/questions/89332#34666995)

这将启动一个存储库浏览器，向您显示存储库*中的每一次提交*，无论它是否可访问。

如果您更喜欢控制台上的漂亮图形而不是单独的 GUI 应用程序，则可以将其替换`gitk`为类似的东西。`git log --graph --oneline --decorate`

要发现 stash 提交，请查找以下形式的提交消息：

        在某个分支上的 WIP ：*commithash**一些旧的提交消息*

*注意*：如果您在提供消息时没有提供消息，则提交消息只会采用这种形式（以“WIP on”开头）`git stash`。

* * *

## 回答 #2

> 赞同：770
> 
> 时间：2011-10-21T03:13:24.043

如果您没有关闭终端，只需查看输出`git stash pop`，您将获得已放置存储的对象 ID。它通常看起来像这样：

```
$ git stash pop
[...]
Dropped refs/stash@{0} (2ca03e22256be97f9e40f08e6d6773c7d41dbfd1) 
```

（请注意，这`git stash drop`也会产生相同的行。）

要取回该存储，只需运行`git branch tmp 2cae03e`，您将获得它作为一个分支。要将其转换为存储，请运行：

```
git stash apply tmp
git stash 
```

将它作为一个分支还可以让您自由地操作它；例如，挑选它或合并它。

* * *

## 回答 #3

> 赞同：291
> 
> 时间：2009-03-03T20:28:51.603

只是想在已接受的解决方案中提及此添加。我第一次尝试这种方法时并不是很明显（也许应该是这样），但是要从哈希值应用存储，只需使用“git stash apply”：

```
$ git stash apply ad38abbf76e26c803b27a6079348192d32f52219 
```

当我刚接触 git 时，我并不清楚，我正在尝试“git show”、“git apply”、“patch”等的不同组合。

* * *

## 回答 #4

> 赞同：166
> 
> 时间：2011-05-04T06:42:36.980

要获取仍在您的存储库中但不再可访问的存储列表：

```
git fsck --unreachable | grep commit | cut -d" " -f3 | xargs git log --merges --no-walk --grep=WIP 
```

* * *

如果您为您的存储区指定了标题，请将`-grep=WIP`命令末尾的“WIP”替换为您的消息的一部分，例如`-grep=Tesselation`。

该命令正在搜索“WIP”，因为存储的默认提交消息采用以下形式`WIP on mybranch: [previous-commit-hash] Message of the previous commit.`

* * *

## 回答 #5

> 赞同：89
> 
> 时间：2008-09-18T02:10:13.467

我刚刚构建了一个命令来帮助我找到丢失的存储提交：

```
for ref in `find .git/objects | sed -e 's#.git/objects/##' | grep / | tr -d /`; do if [ `git cat-file -t $ref` = "commit" ]; then git show --summary $ref; fi; done | less 
```

这会列出 .git/objects 树中的所有对象，找到属于 commit 类型的对象，然后显示每个对象的摘要。从这一点开始，只需查看提交以找到合适的“WIP on work：6a9bb2”（“work”是我的分支，619bb2 是最近的提交）。

我注意到如果我使用“git stash apply”而不是“git stash pop”我不会遇到这个问题，如果我使用“git stash save *message* ”那么提交可能更容易找到。

更新：有了 Nathan 的想法，这变得更短：

```
for ref in `git fsck --unreachable | grep commit | cut -d' ' -f3`; do git show --summary $ref; done | less 
```

* * *

## 回答 #6

> 赞同：66
> 
> 时间：2016-01-07T23:22:05.920

使用 gitk 的 Windows PowerShell 等效项：

`gitk --all $(git fsck --no-reflog | Select-String "(dangling commit )(.*)" | %{ $_.Line.Split(' ')[2] })`

可能有一种更有效的方法可以在一个管道中执行此操作，但这可以完成工作。

* * *

## 回答 #7

> 赞同：51
> 
> 时间：2008-09-18T02:08:15.390

`git fsck --unreachable | grep commit`应该显示 sha1，尽管它返回的列表可能非常大。`git show <sha1>`将显示它是否是您想要的提交。

`git cherry-pick -m 1 <sha1>`将提交合并到当前分支。

* * *

## 回答 #8

> 赞同：44
> 
> 时间：2011-06-23T14:20:51.370

如果要重新存储丢失的存储，则需要先找到丢失的存储的哈希。

正如亚里士多德 Pagaltzis 建议的那样，`git fsck`应该可以帮助您。

就我个人而言，我使用我的`log-all`别名来显示每个提交（可恢复的提交），以便更好地了解情况：

```
git log --graph --decorate --pretty=oneline --abbrev-commit --all $(git fsck --no-reflogs | grep commit | cut -d' ' -f3) 
```

如果您只查找“WIP on”消息，则可以进行更快的搜索。

一旦你知道你的 sha1，你只需改变你的 stash reflog 来添加旧的 stash ：

```
git update-ref refs/stash ed6721d 
```

你可能更喜欢有一个关联的消息，所以`-m`

```
git update-ref -m "$(git log -1 --pretty=format:'%s' ed6721d)" refs/stash ed6721d 
```

你甚至会想用它作为别名：

```
restash = !git update-ref -m $(git log -1 --pretty=format:'%s' $1) refs/stash $1 
```

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2013-01-07T20:17:34.283

我喜欢亚里士多德的方法，但不喜欢使用 GITK……因为我习惯于从命令行使用 GIT。

相反，我采用了悬空提交并将代码输出到 DIFF 文件以在我的代码编辑器中查看。

```
git show $( git fsck --no-reflog | awk '/dangling commit/ {print $3}' ) > ~/stash_recovery.diff 
```

现在您可以将生成的 diff/txt 文件（位于您的主文件夹中）加载到您的 txt 编辑器中，并查看实际代码和生成的 SHA。

然后只需使用

```
git stash apply ad38abbf76e26c803b27a6079348192d32f52219 
```

* * *

## 回答 #10

> 赞同：23
> 
> 时间：2018-03-07T11:31:52.277

您可以通过在终端中编写此命令来列出所有无法访问的提交 -

```
git fsck --unreachable 
```

检查无法访问的提交哈希 -

```
git show hash 
```

如果您找到隐藏的物品，最后申请 -

```
git stash apply hash 
```

* * *

## 回答 #11

> 赞同：21
> 
> 时间：2019-08-26T08:14:31.040

我最喜欢的是这个单行：

```
git log --oneline  $( git fsck --no-reflogs | awk '/dangling commit/ {print $3}' ) 
```

[这与此答案](https://stackoverflow.com/a/6455586/2311167)的想法基本相同，但要短得多。当然，您仍然可以添加`--graph`以获得树状显示。

在列表中找到提交后，使用

```
git stash apply THE_COMMIT_HASH_FOUND 
```

对我来说， using`--no-reflogs`确实揭示了丢失的存储条目，但`--unreachable`（在许多其他答案中发现）没有。

当你在 Windows 下时，在 git bash 上运行它。

致谢：上述命令的详细信息取自[https://gist.github.com/joseluisq/7f0f1402f05c45bac10814a9e38f81bf](https://gist.github.com/joseluisq/7f0f1402f05c45bac10814a9e38f81bf)

* * *

## 回答 #12

> 赞同：18
> 
> 时间：2016-06-09T13:19:05.383

在带有 git v2.6.4 的 OSX 中，我只是意外地运行了 git stash drop，然后我通过以下步骤找到了它

如果您知道存储的名称，请使用：

`$ git fsck --unreachable | grep commit | cut -c 20- | xargs git show | grep -B 6 -A 2 <name of the stash>`

否则，您将通过以下方式手动从结果中找到 ID：

`$ git fsck --unreachable | grep commit | cut -c 20- | xargs git show`

然后，当您找到提交 ID 时，只需点击 git stash apply {commit-id}

希望这可以快速帮助某人

* * *

## 回答 #13

> 赞同：16
> 
> 时间：2016-05-26T10:38:18.757

为什么人们会问这个问题？因为他们还不知道或不了解 reflog。

这个问题的大多数答案都给出了带有选项的长命令，几乎没人会记得。因此，人们提出这个问题并复制粘贴他们认为需要的任何内容，然后几乎立即忘记它。

我建议有这个问题的每个人只检查 reflog (git reflog)，仅此而已。一旦你看到所有提交的列表，就有一百种方法可以找出你正在寻找的提交，并从中挑选或创建一个分支。在此过程中，您将了解 reflog 和各种基本 git 命令的有用选项。

* * *

## 回答 #14

> 赞同：16
> 
> 时间：2017-02-22T09:05:08.060

我无法在一个简单的命令窗口（在我的情况下为 Windows 7）中获得在 Windows 上工作的任何答案。`awk`，`grep`并且`Select-string`不被识别为命令。所以我尝试了一种不同的方法：

*   首轮：`git fsck --unreachable | findstr "commit"`
*   将输出复制到记事本
*   将“无法访问的提交”替换为`start cmd /k git show`

看起来像这样：

`start cmd /k git show 8506d235f935b92df65d58e7d75e9441220537a4 start cmd /k git show 44078733e1b36962571019126243782421fcd8ae start cmd /k git show ec09069ec893db4ec1901f94eefc8dc606b1dbf1 start cmd /k git show d00aab9198e8b81d052d90720165e48b287c302e`

*   另存为 .bat 文件并运行它
*   该脚本将打开一堆命令窗口，显示每个提交
*   如果你找到了你要找的，运行：`git stash apply (your hash)`

可能不是最好的解决方案，但对我有用

* * *

## 回答 #15

> 赞同：14
> 
> 时间：2013-01-04T12:32:19.047

当您没有可用的 gitk 或没有 X 用于输出时，我想向已接受的解决方案添加另一种完成所有更改的好方法。

```
git fsck --no-reflog | awk '/dangling commit/ {print $3}' > tmp_commits

for h in `cat tmp_commits`; do git show $h | less; done 
```

然后你会得到一个又一个显示这些哈希的所有差异。按“q”进入下一个差异。

* * *

## 回答 #16

> 赞同：13
> 
> 时间：2020-07-30T11:25:29.307

您可以通过 2 个简单的步骤实现此目的

1.  列出丢失的存储 -> 为所有存储都被丢弃的项目运行此命令：

    > git fsck --unreachable | grep 提交 | 剪切-d''-f3 | xargs git log --merges --no-walk

2.  将丢失的存储发送回它的来源 --> 让我们使用第二个存储的提交哈希：

    > git update-ref refs/stash 4b3fc45c94caadcc87d783064624585c194f4be8 -m "我恢复的存储"

* * *

## 回答 #17

> 赞同：12
> 
> 时间：2016-05-17T04:33:50.830

亚里士多德接受的答案将显示所有可访问的提交，包括非隐藏式提交。滤除噪音：

```
git fsck --no-reflog | \
awk '/dangling commit/ {print $3}' | \
xargs git log --no-walk --format="%H" \
  --grep="WIP on" --min-parents=3 --max-parents=3 
```

这将仅包括具有恰好 3 个父提交（存储将具有）并且其消息包含“WIP on”的提交。

请记住，如果您使用消息（例如`git stash save "My newly created stash"`）保存了您的存储，这将覆盖默认的“WIP on...”消息。

您可以显示有关每个提交的更多信息，例如显示提交消息，或将其传递给`git stash show`：

```
git fsck --no-reflog | \
awk '/dangling commit/ {print $3}' | \
xargs git log --no-walk --format="%H" \
  --grep="WIP on" --min-parents=3 --max-parents=3 | \
xargs -n1 -I '{}' bash -c "\
  git log -1 --format=medium --color=always '{}'; echo; \
  git stash show --color=always '{}'; echo; echo" | \
less -R 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2015-08-26T02:18:20.407

通过使用以下步骤恢复它：

1.  识别已删除的存储哈希码：

    gitk --all $( git fsck --no-reflog | awk '/dangling commit/ {print $3}' )

2.  樱桃挑选藏匿处：

    git 樱桃挑选 -m 1 $stash_hash_code

3.  使用以下方法解决冲突（如果有）：

    git 合并工具

此外，如果您使用 gerrit，您可能会遇到提交消息的问题。请在遵循下一个替代方案之前存储您的更改：

1.  使用硬重置到先前的提交，然后重新提交此更改。
2.  您还可以存储更改、变基和重新提交。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2021-02-17T20:07:08.043

要在终端中查看提交，只过滤我们关心的提交，我们可以使用：

```
git log --oneline --all --grep="^WIP on .*: [a-f0-9]\+" --grep="^On [^ ]*:" --grep="^index on [^ ]*:" $( env LANG=C git fsck --no-reflog | awk '/dangling commit/ {print $3}' ) 
```

这是基于亚里士多德 Pagaltzis 的回答。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2013-11-07T15:00:19.517

我来这里寻找的是如何真正取回藏匿处，不管我检查了什么。特别是，我存储了一些东西，然后检查了一个旧版本，然后弹出它，但是存储在那个较早的时间点是一个空操作，所以存储消失了；我不能只是`git stash`把它推回堆栈。这对我有用：

```
$ git checkout somethingOld
$ git stash pop
...
nothing added to commit but untracked files present (use "git add" to track)
Dropped refs/stash@{0} (27f6bd8ba3c4a34f134e12fe69bf69c192f71179)
$ git checkout 27f6bd8ba3c
$ git reset HEAD^    # Make the working tree differ from the parent.
$ git stash # Put the stash back in the stack.
Saved working directory and index state WIP on (no branch): c2be516 Some message.
HEAD is now at c2be516 Some message.
$ git checkout somethingOld # Now we are back where we were. 
```

回想起来，我应该一直在使用`git stash apply`not `git stash pop`。我正在做一个`bisect`小补丁，我想在每`bisect`一步都应用它。现在我正在这样做：

```
$ git reset --hard; git bisect good; git stash apply
$ # Run tests
$ git reset --hard; git bisect bad; git stash apply
etc. 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2021-05-25T12:59:03.133

```
git fsck --unreachable | grep commit | cut -d" " -f3 | xargs git log --merges --no-walk --grep=WIP 
```

试试这个

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2022-01-27T00:14:50.980

这对我（2022 年）有用，可以从 Windows 环境中恢复我在 git 中意外删除的存储。

这些步骤概述了如何恢复任何已删除的 git 存储或分支（假设它没有被垃圾收集永久删除）。

1.  导航到您的项目所在的目录。

2.  输入命令：`git fsck --no-reflogs | find "dangling commit"` [![在此处输入图像描述](https://i.stack.imgur.com/2IuLf.jpg)](https://i.stack.imgur.com/2IuLf.jpg)

3.  将出现悬空提交的哈希列表。这些将包括已删除的分支和存储。从复制并粘贴列表末尾附近的哈希开始，以找到您的存储或分支。例如，使用以下命令：`git log -1 [hash]`

4.  如果相应的哈希与您要恢复的哈希匹配，请使用以下命令恢复它“ `git stash apply [hash]`

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-09-09T11:58:34.113

您可以逐步按照以下流程进行操作：

1- 使用下面列出所有无法访问的提交 git fsck --unreachable

2-通过 git show hash 显示无法访问的提交哈希

3-复制所有日志，你可以看到日志，无法访问的blob，提交，树。

4-应用具有提交哈希的日志的 git stash git stash apply [替换哈希]

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2022-03-02T19:10:52.867

知道大概的文件名和它的位置，并且能够找到丢弃的存储文件 grepping 悬空提交的路径

```
for i in $(git fsck --no-reflogs | awk '/dangling commit/ {print $3}'); do
  if git log -5 --name-only -u $i | grep -q "<path-to-files>/.*<partial-file-name>.*"; then
    echo "found something in commit $i";
  fi;
done 
```

# java - 是否可以使用 Java JDBC 在 varchar 字段中存储和检索布尔值？

> ID：89350
> 
> 赞同：3
> 
> 时间：2008-09-18T02:01:09.370
> 
> 标签：java, jdbc, types, resultset

快速提问：我的客户有这样一种情况，他的数据库带有 varchar 字段，并且相应的 jdbc 代码正在存储/检索布尔值。

我猜布尔值 false 和 true 将被转换为“0”和“1”，但我想对此进行确认（我在网上找不到精确的行为规范，可能取决于每个驱动程序, 在这种情况下是 Oracle）。

我知道我可以自己进行实验，但我想在 stackoverflow.com 上尝试一下！

感谢您的回答，

埃里克。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T02:31:53.133

我同意语义高度特定于数据库的答案，这就是为什么我认为重要的答案是你*不应该这样*做。JDBC 驱动程序或类似的更改可能会导致隐式行为中断。

相反，如果使用原始 JDBC，让代码获取布尔值并将其转换为适当的字符串（'true' 或 'false' 是显而易见的选择），然后将此值设置为 VARCHAR 列。在从 VARCHAR 列读取时，执行相反的操作，抛出或处理 String 不是预期的布尔值之一的异常情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T03:38:36.330

感谢您的所有回答，

经过一些实验，我看到 Oracle 确实使用值 0 和 1 将`boolean`值存储在`varchar2`列中，而 JDBC 代码中没有任何映射。

也就是说，如果我能提供一些背景信息，我们将解决这种情况，即事情会“偶然”发生。我只是想知道，与此同时，应用程序是否会崩溃。

而且，正如我所说，我想看看 stackoverflow 社区从一开始就收听了 Joel/Jeff 播客后的效果！

确实有效！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T02:39:34.660

它适用于 MySQL，该表为 false 和 1 为 true。

输出：

```
123 => true
456 => false 
```

源代码：

```
package com.lurz.jdbc;
import java.sql.*;
// Test using Varchar for Boolean
public class BoolTest {
   public static void main(String[] args) throws ClassNotFoundException, SQLException {
      Class.forName("com.mysql.jdbc.Driver");
      Connection conn = DriverManager.getConnection("jdbc:mysql://localhost/booltest", "booltest", "booltest");
      conn.prepareStatement("create table booltest (id bigint, truefalse varchar(10));").execute();
      PreparedStatement stmt = conn.prepareStatement("insert into booltest (id, truefalse) values (?, ?);");
      stmt.setLong(1, (long)123);
      stmt.setBoolean(2, true);
      stmt.execute();
      stmt.setLong(1, (long)456);
      stmt.setBoolean(2, false);
      stmt.execute();
      ResultSet rs = conn.createStatement().executeQuery("select id, truefalse from booltest");
      while (rs.next()) {
         System.out.println(rs.getLong(1)+ " => " + rs.getBoolean(2));
      }  
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T02:13:27.063

不幸的是，`BOOLEAN`语义是高度特定于数据库的。我*猜测*Oracle 驱动程序会将布尔值转换为`VARCHAR`字段为 " `true`" 和 " `false`"，而不是`0`and `1`，但您应该自己验证这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T20:26:50.437

可以使用 VARCHAR(2) 在 Oracle 中表示 Java 布尔值。但是，我建议不要这样做，并建议您改用 NUMBER(1)。如果布尔列上有一个索引并且您在 WHERE 子句中使用它，Oracle 将对其应用 to_number 数字函数以将“0”转换为 0 或将“1”转换为 1。该函数的应用会否定使用该列上的索引，将导致您进行全表扫描。

# workflow - Windows 工作流程

> ID：89353
> 
> 赞同：3
> 
> 时间：2008-09-18T02:02:10.927
> 
> 标签：workflow, workflow-foundation

任何人都可以解释什么是 Windows 工作流程以及我们如何在工作组织中使用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T02:23:21.923

Windows Workflow Foundation 是一个引人入胜的概念。它允许您使用类似流程图的概念和普通代码的组合来创建功能强大的应用程序（或只是其中的一部分）。

其更深层次的价值可能不会立即显现出来。假设您正在构建一个大型电子商务网站。随着时间的推移，您的履行等流程的工作流程将发生根本性变化。代码最终将变成一堆可怕的想法，这些想法被硬塞在旧想法之上。您将被迫处理大量文档，并且最终将变得难以维护。

因此，工作流最终是关于创建高度可维护的代码，并认为代码*会*发生变化。当您查看它时，您正在查看流程图。双击一个节点，它会将您带到一个代码编辑器，您可以在其中编写一些业务逻辑。

当然，这比这要复杂得多。

我现在桌子上有一本书。我正在尝试确定 .NET 实现是否已准备好迎接黄金时段，或者它是否仍然太新和太复杂——而且它比我预期的要复杂得多*。*

在这一点上，我认为这个想法有可能改变游戏规则......我们将看看当前一代是否真的可用！微软并没有那么努力地推动它的事实可能说明了这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T02:06:41.463

WF 是一个用于创建工作流的框架。它由一种工作流（状态机或顺序）组成，托管不同的“活动”和控制应用程序流如何从一个活动传输到另一个活动的逻辑。

您可以使用它来描述业务流程，从 ASP.NET 应用程序中的页面流到提交休假请求所需的步骤。

[这是一篇关于 WF 的精彩文章。](http://msdn.microsoft.com/en-us/library/cc768563.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T02:06:05.210

[工作流方式：了解 Windows Workflow Foundation](http://msdn.microsoft.com/en-us/library/dd851337.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-27T05:26:10.560

Windows Workflow Foundation 将开发部分的核心概念呈现在您面前。因此，它变得有点复杂，但却是一种非常强大的工作和创建构建方式。**使用类似流程图的概念进行开发**的基本理念使其非常直观，无需像以前以传统编程方式完成的代码一样，跟踪完整代码变得非常容易。使用工作流还有其他不同的功能，例如并行运行执行、活动的**拖放**设施、使用**内置活动**以及我们可以**编写自己的自定义活动**，我们可以在任何其他项目中的任何地方使用这些活动。

# sql-server - 如何使用 SSIS 导入可变记录长度的 CSV 文件？

> ID：89372
> 
> 赞同：4
> 
> 时间：2008-09-18T02:06:32.057
> 
> 标签：sql-server, sql-server-2005, ssis, csv, import

有没有人能够通过 SSIS 将可变记录长度文本文件 (CSV) 导入 SQL Server？

我一次又一次地尝试使用 SSIS 将 CSV 文件放入 SQL Server 表中，其中输入文件具有不同的记录长度。对于这个问题，两个不同的记录长度是 63 和 326 字节。所有记录长度都将导入到同一个 326 字节宽度表中。

有超过 100 万条记录可供导入。
我无法控制导入文件的创建。
我必须使用 SSIS。
我已向 MS 确认这已被报告为错误。我尝试了几种解决方法。大多数都是我尝试编写自定义代码来拦截记录的地方，但我似乎无法让它按我的意愿工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T14:47:51.213

我遇到了类似的问题，并使用了自定义代码（脚本任务）和数据流选项卡下的脚本组件。

我有一个平面文件源输入脚本组件。在里面，我使用代码来操作传入的数据并将其修复到目的地。

我的问题是提供商使用“000000”作为没有可用的日期，而另一个列有填充/修剪问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T08:57:58.273

导入此文件应该没有问题。只需确保在创建平面文件连接管理器时，选择**分隔**格式，然后将 SSIS 列长度设置为最大文件列长度，以便它可以容纳任何数据。

看起来您使用的是固定宽度格式，这对于 CSV 文件不正确（因为您有可变长度列），或者您可能错误地设置了列分隔符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T17:56:53.273

同样的问题。就我而言，目标 CSV 文件的页眉和页脚记录的格式与文件正文完全不同；页眉/页脚用于验证文件处理的完整性（日期/时间、记录计数、总金额 - 任何其他名称的“校验和”......）。这是来自“大型机”环境的文件的常见格式，虽然我还没有开始使用它，但我希望必须使用脚本来去除页眉/页脚，将其余部分保存为新文件，处理新文件文件，然后进行验证。不能完全期望 MS 开箱即用（但它肯定会很好，不是吗？）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-15T13:48:19.880

您可以使用 C# 编写脚本任务来遍历每一行并用适当数量的逗号填充以填充数据。当然，这假设所有数据都与正确的列对齐。

即，当您阅读每条记录时，您可以“计算”逗号的数量。然后，只需将 X 个逗号附加到记录的末尾，直到它具有正确数量的逗号。

Excel 存在一个问题，导致在转换为 CSV 时会创建此类文件。

如果您可以“手动”执行此操作，解决此问题的最佳方法是在 Excel 中打开文件，在记录的“末尾”创建一列，并用`1`s 或其他字符一直填充它。

讨厌，但可以是一个快速的解决方案。

如果您没有能力执行此操作，则可以通过上述方式以编程方式执行相同的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T03:46:43.657

为什么不能将其作为测试文件导入并将列分隔符设置为“，”并将行分隔符设置为 CRLF？

# ruby-on-rails - 将 Merb 用于 Facebook 应用程序

> ID：89387
> 
> 赞同：0
> 
> 时间：2008-09-18T02:08:15.080
> 
> 标签：ruby-on-rails, facebook, merb

由于 Rails（目前）还不是多线程的，因此对于 Facebook 应用程序来说，线程 Web 框架似乎是一个更好的选择。（原因是因为每个 Rails 进程一次只能处理一个请求，而 facebook 操作往往很慢，因为您的应用程序和 facebook 之间有很多网络通信）

有人用 Merb 写过 Facebook 应用吗？是否有将 Facebooker（Rails 的 Facebook 插件）移植到 Merb 的端口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T09:08:49.997

我们在我们的一个项目（[Rock the Vote](http://www.rockthevote.com/)）中使用了 merb_facebooker，并且效果很好。测试 Facebook 应用程序非常烦人，因为您无法控制中间件，因此请注意您对 FB API 的期望，并确保您在开发阶段的早期尽可能多地验证它们（不要尝试所有的我们需要在早期使用 fbML 做的事情带来了一些麻烦）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T07:29:22.280

看哪，**[merb_facebooker](http://github.com/vanpelt/merb_facebooker/tree/master)**。

此外，如果你想直接使用 Facebooker（比如桌面应用程序），只需安装 gem：

```
gem install facebooker 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T02:20:08.980

你看过[史达琳](http://rubyforge.org/projects/starling/)吗？它是 twitter 用来处理他们的消息的服务器。它是一个持久队列服务器，允许您将作业委派给工作人员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T03:19:07.123

您可以在 Apache 上运行乘客，它将根据需要启动任意数量的 Rails 实例，直至达到一定的限制（我认为默认值为 30）。它还会根据需要杀死它们，因此如果您没有像 5 分钟前那样获得更多的点击量，它会将系统资源释放回系统。

[在http://modrails.com](http://modrails.com)了解有关乘客的更多信息

# c++ - 帮助合并向量的算法

> ID：89402
> 
> 赞同：4
> 
> 时间：2008-09-18T02:12:57.097
> 
> 标签：c++, algorithm, optimization, graphics, vector

我需要一个非常快速的算法来完成以下任务。我已经实现了几种完成它的算法，但是它们对于我需要的性能来说都太慢了。它应该足够快，以至于算法可以在现代 CPU 上每秒至少运行 100,000 次。它将在 C++ 中实现。

我正在使用跨度/范围，这是一种在一条线上具有起点和终点坐标的结构。

我有两个跨度向量（动态数组），我需要合并它们。一个向量是 src，另一个是 dst。向量按跨度起始坐标排序，跨度在一个向量内不重叠。

src 向量中的 span 必须与 dst 向量中的 span 合并，这样得到的向量仍然是排序的并且没有重叠。IE。如果在合并期间检测到重叠，则将两个跨度合并为一个。（合并两个跨度只是改变结构中的坐标的问题。）

现在，还有一个问题，src 向量中的跨度必须在合并期间“加宽”。这意味着将在 src 中每个跨度的开始坐标添加一个常量，并将另一个（更大的）常量添加到结束坐标。这意味着在 src 跨度扩大后，它们可能会重叠。

* * *

到目前为止，我得出的结论是它不能完全就地完成，需要某种临时存储。我认为它应该在线性时间超过 src 和 dst 总和的元素数量。

任何临时存储都可能在算法的多次运行之间共享。

我尝试过的两种太慢的主要方法是：

1.  将 src 的所有元素附加到 dst，在附加之前扩展每个元素。然后运行就地排序。最后，使用“读”和“写”指针遍历结果向量，读指针在写指针之前运行，在进行时合并跨度。当所有元素都被合并（读指针到达末尾） dst 被截断。

2.  创建一个临时工作向量。通过重复从 src 或 dst 中选择下一个元素并合并到工作向量中来进行如上所述的简单合并。完成后，将工作向量复制到 dst 并替换它。

第一种方法的问题是排序是 O((m+n)*log(m+n)) 而不是 O(m+n) 并且有一些开销。这也意味着 dst 向量必须增长得比它真正需要的大得多。

第二个主要问题是大量复制并再次分配/释放内存。

如果您认为需要，可以更改用于存储/管理跨度/向量的数据结构。

更新：忘了说数据集有多大。最常见的情况是任一向量中有 4 到 30 个元素，并且 dst 为空或 src 和 dst 中的跨度之间存在大量重叠。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T02:26:16.877

我们知道绝对最佳情况的运行时间是 O(m+n)，这是因为您至少必须扫描所有数据才能合并列表。鉴于此，您的第二种方法应该为您提供这种类型的行为。

你有没有分析过你的第二种方法来找出瓶颈是什么？很有可能，根据您所谈论的数据量，实际上不可能在指定的时间内做您想做的事情。验证这一点的一种方法是做一些简单的事情，比如在一个循环中总结每个向量中跨度的所有开始和结束值，然后计算时间。基本上，您在这里为向量中的每个元素做最少的工作。这将为您提供可以预期获得的最佳性能的基准。

除此之外，您可以避免使用 stl swap 方法逐个元素地复制向量，并且可以将临时向量预分配到一定大小，以避免在合并元素时触发数组的扩展。

您可能会考虑在您的系统中使用 2 个向量，并且每当您需要进行合并时，您会合并到未使用的向量中，然后交换（这类似于图形中使用的双缓冲）。这样您就不必在每次进行合并时重新分配向量。

但是，您最好先进行分析并找出瓶颈所在。如果与实际合并过程相比分配最小，那么您需要弄清楚如何使其更快。

一些可能的额外加速可能来自直接访问向量原始数据，这避免了每次访问数据时的边界检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T04:01:33.450

我会始终保持我的跨度向量排序。这使得实现算法变得更加容易——并且可以在线性时间内完成。

好的，所以我会根据以下内容对跨度进行排序：

*   跨度最小值按递增顺序
*   然后按降序跨越最大值

您需要创建一个函数来执行此操作。

然后我会使用 std::set_union 来合并向量（你可以在继续之前合并多个）。

然后对于具有相同最小值的每组连续跨度，您保留第一个并删除其余的（它们是第一个跨度的子跨度）。

然后你需要合并你的跨度。这现在应该是相当可行的，并且在线性时间内是可行的。

好的，现在的诀窍就在这里。不要尝试就地执行此操作。使用一个或多个临时向量（并提前预留足够的空间）。然后在最后，调用 std::vector::swap 将结果放入您选择的输入向量中。

我希望这足以让你继续前进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T02:42:44.747

1 是正确的 - 完整排序比合并两个排序列表要慢。

所以你正在考虑调整 2（或全新的东西）。

如果将数据结构更改为双向链表，则可以将它们合并到恒定的工作空间中。

为列表节点使用固定大小的堆分配器，既可以减少每个节点的内存使用，又可以提高节点在内存中靠近的机会，从而减少页面未命中。

您也许可以在线或在您最喜欢的算法书中找到代码来优化链表合并。您需要对其进行自定义，以便在列表合并的同时进行跨度合并。

要优化合并，首先请注意，对于来自同一侧但没有来自另一侧的值的每次运行，您可以一次将整个运行插入到 dst 列表中，而不是依次插入每个节点。并且您可以在正常的列表操作中每次插入保存一次写入，方法是让末尾“悬空”，知道您稍后会对其进行修补。并且如果您不在应用程序的其他任何地方进行删除，则该列表可以是单链接的，这意味着每个节点一次写入。

至于 10 微秒的运行时间 - 取决于 n 和 m ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T02:54:28.837

如果您最近的实现仍然不够快，您可能最终不得不寻找替代方法。

你用这个函数的输出做什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T02:17:52.263

没有重复分配的第二种方法怎么样 - 换句话说，分配你的临时向量一次，不再分配它？或者，如果输入向量足够小（但不是恒定大小），只需使用 alloca 而不是 malloc。

此外，就速度而言，您可能希望确保您的代码使用 CMOV 进行排序，因为如果代码实际上是为合并排序的每个迭代进行分支：

```
if(src1[x] < src2[x])
    dst[x] = src1[x];
else
    dst[x] = src2[x]; 
```

分支预测将有 50% 的时间失败，这将对性能产生巨大影响。有条件的移动可能会做得更好，因此请确保编译器正在这样做，如果没有，请尝试诱使它这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T02:22:54.340

您在方法 1 中提到的排序可以减少到线性时间（从您描述的对数线性），因为两个输入列表已经排序。只需执行合并排序的合并步骤。通过输入跨度向量的适当表示（例如单链表），这可以就地完成。

[http://en.wikipedia.org/wiki/Merge_sort](http://en.wikipedia.org/wiki/Merge_sort)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T02:25:38.157

我认为不可能有严格的线性解决方案，因为在最坏的情况下，扩大 src 向量跨度可能会导致它们全部重叠（取决于您添加的常数的大小）

问题可能出在实现上，而不是算法上；我建议为您之前的解决方案分析代码，以查看时间花在了哪里

推理：

对于像运行在 3.2GHz 的 Intel Core 2 Extreme QX9770 这样的真正“现代”CPU，可以预期大约 59,455 MIPS

对于 100,000 个向量，您必须在 594,550 个指令中处理每个向量。这是很多指令。

参考：[维基百科 MIPS](http://en.wikipedia.org/wiki/Million_instructions_per_second#Million_instructions_per_second)

另外，请注意，向 src 向量 spans 添加一个常数不会对它们进行解排序，因此您可以独立地对 src 向量 spans 进行归一化，然后将它们与 dst 向量 spans 合并；这应该会减少原始算法的工作量

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T03:15:16.010

我为这个算法编写了一个新的容器类，根据需要量身定制。这也让我有机会围绕我的程序调整其他代码，同时提高了一点速度。

这比使用 STL 向量的旧实现要快得多，但在其他方面基本相同。但是虽然它更快，但它仍然不够快......不幸的是。

分析不再揭示真正的瓶颈是什么。MSVC 分析器似乎有时会将“责任”归咎于错误的调用（假设相同的运行分配了大不相同的运行时间），并且大多数调用被合并成一个大裂缝。

查看生成的代码的反汇编表明生成的代码中有大量的跳转，我认为这可能是现在缓慢的主要原因。

```
class SpanBuffer {
private:
    int *data;
    size_t allocated_size;
    size_t count;

    inline void EnsureSpace()
    {
        if (count == allocated_size)
            Reserve(count*2);
    }

public:
    struct Span {
        int start, end;
    };

public:
    SpanBuffer()
        : data(0)
        , allocated_size(24)
        , count(0)
    {
        data = new int[allocated_size];
    }

    SpanBuffer(const SpanBuffer &src)
        : data(0)
        , allocated_size(src.allocated_size)
        , count(src.count)
    {
        data = new int[allocated_size];
        memcpy(data, src.data, sizeof(int)*count);
    }

    ~SpanBuffer()
    {
        delete [] data;
    }

    inline void AddIntersection(int x)
    {
        EnsureSpace();
        data[count++] = x;
    }

    inline void AddSpan(int s, int e)
    {
        assert((count & 1) == 0);
        assert(s >= 0);
        assert(e >= 0);
        EnsureSpace();
        data[count] = s;
        data[count+1] = e;
        count += 2;
    }

    inline void Clear()
    {
        count = 0;
    }

    inline size_t GetCount() const
    {
        return count;
    }

    inline int GetIntersection(size_t i) const
    {
        return data[i];
    }

    inline const Span * GetSpanIteratorBegin() const
    {
        assert((count & 1) == 0);
        return reinterpret_cast<const Span *>(data);
    }

    inline Span * GetSpanIteratorBegin()
    {
        assert((count & 1) == 0);
        return reinterpret_cast<Span *>(data);
    }

    inline const Span * GetSpanIteratorEnd() const
    {
        assert((count & 1) == 0);
        return reinterpret_cast<const Span *>(data+count);
    }

    inline Span * GetSpanIteratorEnd()
    {
        assert((count & 1) == 0);
        return reinterpret_cast<Span *>(data+count);
    }

    inline void MergeOrAddSpan(int s, int e)
    {
        assert((count & 1) == 0);
        assert(s >= 0);
        assert(e >= 0);

        if (count == 0)
        {
            AddSpan(s, e);
            return;
        }

        int *lastspan = data + count-2;

        if (s > lastspan[1])
        {
            AddSpan(s, e);
        }
        else
        {
            if (s < lastspan[0])
                lastspan[0] = s;
            if (e > lastspan[1])
                lastspan[1] = e;
        }
    }

    inline void Reserve(size_t minsize)
    {
        if (minsize <= allocated_size)
            return;

        int *newdata = new int[minsize];

        memcpy(newdata, data, sizeof(int)*count);

        delete [] data;
        data = newdata;

        allocated_size = minsize;
    }

    inline void SortIntersections()
    {
        assert((count & 1) == 0);
        std::sort(data, data+count, std::less<int>());
        assert((count & 1) == 0);
    }

    inline void Swap(SpanBuffer &other)
    {
        std::swap(data, other.data);
        std::swap(allocated_size, other.allocated_size);
        std::swap(count, other.count);
    }
};

struct ShapeWidener {
    // How much to widen in the X direction
    int widen_by;
    // Half of width difference of src and dst (width of the border being produced)
    int xofs;

    // Temporary storage for OverlayScanline, so it doesn't need to reallocate for each call
    SpanBuffer buffer;

    inline void OverlayScanline(const SpanBuffer &src, SpanBuffer &dst);

    ShapeWidener(int _xofs) : xofs(_xofs) { }
};

inline void ShapeWidener::OverlayScanline(const SpanBuffer &src, SpanBuffer &dst)
{
    if (src.GetCount() == 0) return;
    if (src.GetCount() + dst.GetCount() == 0) return;

    assert((src.GetCount() & 1) == 0);
    assert((dst.GetCount() & 1) == 0);

    assert(buffer.GetCount() == 0);

    dst.Swap(buffer);

    const int widen_s = xofs - widen_by;
    const int widen_e = xofs + widen_by;

    size_t resta = src.GetCount()/2;
    size_t restb = buffer.GetCount()/2;
    const SpanBuffer::Span *spa = src.GetSpanIteratorBegin();
    const SpanBuffer::Span *spb = buffer.GetSpanIteratorBegin();

    while (resta > 0 || restb > 0)
    {
        if (restb == 0)
        {
            dst.MergeOrAddSpan(spa->start+widen_s, spa->end+widen_e);
            --resta, ++spa;
        }
        else if (resta == 0)
        {
            dst.MergeOrAddSpan(spb->start, spb->end);
            --restb, ++spb;
        }
        else if (spa->start < spb->start)
        {
            dst.MergeOrAddSpan(spa->start+widen_s, spa->end+widen_e);
            --resta, ++spa;
        }
        else
        {
            dst.MergeOrAddSpan(spb->start, spb->end);
            --restb, ++spb;
        }
    }

    buffer.Clear();
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T16:38:42.723

你的目标系统是什么？是多核的吗？如果是这样你可以考虑多线程这个算法

# asp.net - 在 .css 文件中引用应用程序相对虚拟路径

> ID：89418
> 
> 赞同：25
> 
> 时间：2008-09-18T02:17:06.260
> 
> 标签：asp.net, css, background-image, dynamic-css

假设我的应用程序根目录下有一个“图像”文件夹目录。如何从 .css 文件中使用 ASP.NET 应用程序相对路径引用此目录中的图像。

例子：

在开发中，**~/Images/Test.gif**的路径可能会解析为**/MyApp/Images/Test.gif**，而在生产中，它可能会解析为**/Images/Test.gif**（取决于应用程序的虚拟目录） . 显然，我希望避免在环境之间修改 .css 文件。

我知道您可以使用 Page.ResolveClientUrl 在渲染时动态地将 url 注入控件的 Style 集合中。我想避免这样做。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-14T09:21:33.680

不幸的是，Firefox 在这里有一个愚蠢的错误......路径是相对于页面的路径，而不是相对于 CSS 文件的位置。这意味着如果您在树中的不同位置有页面（例如在根目录中有 Default.aspx，在 View 文件夹中有 Information.aspx），则无法获得有效的相对路径。（IE 将正确解析相对于 CSS 文件位置的路径。）

我唯一能找到的是关于[http://www.west-wind.com/weblog/posts/269.aspx](http://www.west-wind.com/weblog/posts/269.aspx)的评论，但老实说，我还没有成功。如果我这样做，我将编辑此评论：

> 回复：理解 ASP.Net 路径，Russ Brooks 2006 年 2 月 25 日上午 8:43
> 
> 没有人完全回答 Brant 关于 CSS 文件本身内部图像路径的问题。我已经得到了答案。问题是，“我们如何在 CSS 文件中使用应用程序相关的图像路径？” 我也一直对这个问题感到沮丧，所以我花了最后 3 个小时来制定解决方案。
> 
> 解决方案是通过 ASPX 页面处理程序运行您的 CSS 文件，然后在每个路径中使用少量服务器端代码来输出根应用程序路径。准备好？
> 
> 1.  添加到 web.config：

```
 <compilation debug="true">
 <!-- Run CSS files through the ASPX handler so we can write code in them. -->
 <buildProviders>
 <add extension=".css" type="System.Web.Compilation.PageBuildProvider" />
 </buildProviders>
 </compilation>

 <httpHandlers>
 <add path="*.css" verb="GET" type="System.Web.UI.PageHandlerFactory" validate="true" />
 </httpHandlers> 
```

> 2.  在 CSS 中，只要存在路径，就使用 Request.ApplicationPath 属性，如下所示：
>     
>     
>     
>     #content { 背景： url(<%= Request.ApplicationPath %>/images/bg_content.gif) 重复-y; }
>     
>     
> 3.  .NET 默认使用 MIME 类型“text/html”提供 ASPX 页面，因此，您的新服务器端 CSS 页面使用此 MIME 类型提供，这会导致非 IE 浏览器无法正确读取 CSS 文件。我们需要将其覆盖为“text/css”。只需将此行添加为 CSS 文件的第一行：
>     
>     
>     
>     ```
>     <%@ ContentType="text/css" %> 
>     ```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T02:19:24.333

如果你不知道你可以这样做......

如果你在 CSS 中给出资源的相对路径，它是相对于 CSS 文件的，而不是包含 CSS 的文件。

```
background-image: url(../images/test.gif); 
```

所以这可能对你有用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-11-30T23:55:37.287

让您的生活更轻松，只需将 CSS 中使用的图像`/css/`放在`/css/style.css`. 然后，当您引用图像时，请使用相对路径（例如`url(images/image.jpg)`）。

我仍然将用 a 显示的图像保存`<img>`在`/images/`文件夹中。例如照片是内容，它们不是网站皮肤/主题的一部分。因此，它们不属于该`/css/`文件夹。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-01-25T14:42:51.003

将您的动态 CSS 放在 .ascx 文件中的用户控件中，然后您不需要通过 asp.net 页面处理器运行所有 css 文件。

```
<%@ Control %>
<style type="text/css>
div.content
{
background-image:(url(<%= Page.ResolveUrl("~/images/image.png") %>);
}
</style> 
```

但解决`~`问题的最简单方法是根本不使用 a `~`。在 Visual Studio 的解决方案资源管理器中，右键单击您的应用程序，选择属性窗口并将虚拟路径更改为`/`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-06-22T15:45:52.137

Marcel Popescu 的解决方案是在 css 文件中使用 Request.ApplicationPath。

永远不要使用 Request.ApplicationPath - 它是邪恶的！根据路径返回不同的结果！

请改用以下内容。

```
background-image: url(<%= Page.ResolveUrl("~/images/bg_content.gif") %>); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-23T03:07:08.093

在 Windows 7、IIS 7.5 上：

您不仅需要执行 Marcel Popescu 提到的步骤。

您还需要在 IIS 7.5 处理程序映射中添加处理程序映射。这样 IIS 就知道 *.css 必须与 System.Web.UI.PageHandlerFactory 一起使用

仅在 web.config 文件中设置内容是不够的。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-09-18T02:19:44.927

在 .css 文件中，您可以使用相对路径；所以在你的例子中，假设你把你的 css 文件放在 ~/Styles/mystyles.css 中。您可以使用 url(../Images/Test.gif) 作为示例。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2010-05-13T02:05:27.763

我很难为内容容器显示背景图像，并且尝试了许多与此处发布的其他解决方案类似的解决方案。我已经在 CSS 文件中设置了相对路径，将其设置为我希望背景显示的 aspx 页面上的样式 - 没有任何效果。我尝试了 Marcel Popescu 的解决方案，但仍然没有用。

在结合了 Marcel 的解决方案和反复试验后，我确实最终让它工作了。我将代码插入到 web.config 中，将 text/css 行插入到我的 CSS 文件中，但我完全删除了 CSS 文件中的背景属性，并将其设置为我想要背景的 aspx 页面中内容容器上的样式展示。

这确实意味着对于我想要显示背景的每个或任何其他页面，我都需要设置样式背景属性，但它工作得很好。

# java - 在 Hibernate 中绕过 GeneratedValue

> ID：89439
> 
> 赞同：11
> 
> 时间：2008-09-18T02:20:17.890
> 
> 标签：java, hibernate, jboss

是否可以在 Hibernate 中绕过`@GeneratedValue`ID，我们有一种情况，大多数时候我们希望使用 设置 ID `GeneratedValue`，但在某些情况下希望手动设置 ID。

这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T03:23:16.990

我知道您可以在 JPA 规范中执行此操作，因此您应该能够在 Hibernate 中执行此操作（使用 JPA+ 注释）。

如果您只是填写您正在创建的新持久模型的 ID 字段，那么当您将该模型“合并”到 EntityManager 中时，它将使用您设置的 ID。

不过，这确实有影响。您刚刚用完了该 ID，但 GeneratedValue 注释指定的序列不知道这一点。除非您指定的未指定 ID 小于当前序列值，否则一旦序列赶上您刚刚使用的值，您就会遇到问题。

所以，也许我可以看到您可能希望用户能够在哪里指定 ID，但是您需要捕获将来可能出现的异常（重复 ID）。

# visual-studio - 如何让我的 Visual Studio 测试套件 Web 测试迭代我的数据源？

> ID：89441
> 
> 赞同：2
> 
> 时间：2008-09-18T02:20:26.140
> 
> 标签：visual-studio, testing, automated-tests, load-testing

我将 Visual Studio Web 测试很好地附加到数据源，但我需要能够迭代数据源中的每个条目。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T02:47:28.230

诀窍是选择“运行测试（开始前暂停）”

然后当测试打开时，单击“编辑运行设置”的小链接

将打开一个对话框，允许您选择“每个数据源行运行一次”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T02:30:44.370

这篇[文章](http://www.codeguru.com/csharp/.net/net_general/visualstudionetadd-ins/article.php/c12645__2/)似乎在讨论与您正在谈论的内容非常相似的事情。祝你好运。奥拉

**编辑：**从链接的文章中，您的 DataSource 通过属性暴露给您的测试。

```
[DataSource("System.Data.SqlClient",
    "Data Source=VSTS;Initial Catalog=ContactManagerWebTest;
    Integrated Security=True", "ValidContactInfo",
    DataAccessMethod.Sequential), TestMethod()] 
```

您可以链接到其他几个数据源，例如 CSV，甚至 TFS 中测试用例的参数。一定要包括`DataAccessMethod.Sequential`. 如果表中有多个由 指示的行`DataSourceAttribute`，则每次测试运行都将`TestContext.DataRow`指向测试的当前行/迭代。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-04T13:48:08.857

从解决方案资源管理器中打开 Local.testsettings 文件，然后转到 Web 测试 -> 选择“现在每个数据源运行一次”选项。就是这样。

# aix - 免费或开源的 IBM 3151 或 aixterm 仿真器？

> ID：89444
> 
> 赞同：1
> 
> 时间：2008-09-18T02:20:55.283
> 
> 标签：aix, terminal-emulator

有谁知道任何可以模拟 IBM 3151 终端或 HFT 终端（aixterm）的免费或开源终端仿真器？

我们有一些离岸承包商需要访问我们的一些需要 3151 或 hft 仿真的系统，但在将 Hummingbird HostExplorer 的许可证转移到印度时遇到问题。就此而言，如果我们可以节省美国蜂鸟许可证，那也是有益的。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-18T03:08:50.050

我怀疑你会找到这种终端类型的开源或免费模拟器。尽管 IBM 为开源社区做出了贡献，但他们也对保护自己的知识产权非常感兴趣。蜂鸟许可证当然很贵。当我在 IBM 工作时，我们遇到了这个问题！

也就是说，我从来不需要特定的终端类型来访问 AIX 系统，因为我们使用的是 OpenSSH（随 AIX 5L 提供）。您是否有某些原因无法向您的承包商提供对这些系统的 SSH 访问？

# vbscript - CScript/WScript 防止错误被阻塞

> ID：89465
> 
> 赞同：6
> 
> 时间：2008-09-18T02:26:07.687
> 
> 标签：vbscript, automation, wsh

目前，当出现脚本错误时，WScript 会弹出消息框。这些脚本由其他进程调用，并在服务器上运行，因此没有人可以关闭错误框。

我想要的是将错误消息转储到 STDOUT，并执行以返回调用进程。作为一个 MSGBox 弹出只是挂起整个事情。

想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T08:15:00.010

这就是你应该如何运行脚本批处理作业：

```
cscript //b scriptname.vbs 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T03:41:30.643

不要使用 WScript；使用 CScript。在 Windows 命令提示符下，键入以下内容以显示帮助。

```
cscript //?
```

我建议如下：

```
cscript //H:CScript
```

这将使 CScript 成为您的默认脚本解释器。CScript 根据需要将消息打印到控制台（即标准输出）。（它不使用对话框窗口。）您可能还想尝试 //B 开关，但我不知道是否必须按脚本运行。如果它是像 //H 开关那样持久的一次性开关，那么这可能对您有用；如果没有，您可能需要修改所有远程程序以包含它。根据您提供的信息，我认为只需更改默认解释器（//H）就可以满足您的需求。

您还需要添加某种错误处理以防止脚本因错误而终止。在 Visual Basic Sc​​ripting Edition 中，如果您只想忽略错误，最简单的做法是将以下内容添加到脚本顶部。

```
On Error Resume Next
```

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/53f3k80h(VS.85).aspx](http://msdn.microsoft.com/en-us/library/53f3k80h(VS.85).aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T19:38:33.760

使用`WScript.Echo`而不是`MsgBox`. `Cscript`并且还使用而不是运行脚本`Wscript`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T02:34:43.300

你还没有说明你使用的是什么语言。如果您使用的是 VBScript，您可以使用[On Error...](http://publib.boulder.ibm.com/infocenter/cqhelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearquest.apiref.doc/c_vbscript_err_hndlng.htm)语句编写错误处理程序。如果您使用的是 JScript，则可以使用[try {} catch (x) {}](http://www.w3schools.com/js/js_try_catch.asp)块。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T03:22:49.533

不要这样做：

> vbscript：在错误恢复下一个
> 
> 英语：“当你遇到错误时，忽略它并继续前进”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-01T07:21:36.123

我建议你把你的脚本代码放在一个 Sub - 例如`DoWork`- 并编写你的脚本，例如：

```
On Error Resume Next

DoWork

If Err.Number <> 0 Then

    If "CSCRIPT.EXE" = UCase( Right( WScript.Fullname, 11 ) ) Then
        WScript.StdErr.Write Err.Number & ": " & Err.Description
    Else
        WScript.Echo Err.Number & ": " & Err.Description
    End If
    WScript.Quit 1
End If

Private Sub DoWork

    ... your code ...

End Sub 
```

这样，当您使用 运行脚本`cscript //b`并且它失败时，您将收到一条错误消息输出到 stderr 并且调用者将收到一个非零错误级别。

# .net - 如何禁止整个公司访问我的网站？

> ID：89480
> 
> 赞同：2
> 
> 时间：2008-09-18T02:28:21.800
> 
> 标签：.net, php, apache

由于我不会详细说明的原因，我希望禁止整个公司访问我的网站。使用 gethostbyaddr() 检查 php 中的远程主机名是可行的，但这会大大减慢页面加载速度。大型组织（例如 hp.com 或 microsoft.com）通常具有 IP 地址块。无论如何我得到了完整的列表，还是我坚持缓慢的反向 DNS 查找？如果是这样，我可以加快速度吗？

编辑：好的，现在我知道我可以使用 .htaccess 文件来禁止一个范围。现在，我如何才能确定给定组织的范围应该是多少？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T02:30:56.880

.htaccess 怎么样：

```
Deny from x.x.x.x 
```

如果你需要拒绝一个范围说：192.168.0.x 那么你会使用

```
Deny from 192.168.0 
```

这同样适用于主机名：

```
Deny from sub.domain.tld 
```

或者如果你想要一个 PHP 解决方案

```
$ips = array('1.1.1.1', '2.2.2.2', '3.3.3.3');
if(in_array($_SERVER['REMOTE_ADDR'])){die();} 
```

有关 htaccess 方法的更多信息，请参阅[此](http://httpd.apache.org/docs/1.3/mod/mod_access.html)页面。

现在要确定范围会很困难，大多数公司（除非他们是大公司）都会像你我一样拥有动态 IP。
这是我之前不得不处理的一个问题，最好的办法是禁止主机名或整个范围，例如，如果它们在 192.168.0.123 上，则禁止 192.168.0.123，不幸的是你会得到一些无辜的人用任何一种方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T02:38:04.383

如果您正在练习安全的虚拟主机，那么您有防火墙。用它。

大公司有 IP 地址块，但即使是小公司也很少更改其 IP。因此，有一种简单的方法可以在不降低性能的情况下做到这一点：

每个月都会对您日志中的所有 IP 进行反向查找，然后将该公司使用的所有 IP 在您的防火墙中设置为拒绝。

过一会儿你就会开始看他们是否有动态地址。如果他们这样做，那么您可能必须为每次连接尝试进行反向查找，但除非他们是一家小公司，否则您不必担心。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T02:37:12.217

继续使用`gethostbyaddr()`，但后面有缓存。您应该只需要为每个 IP 地址解决一次，这样就不会成为重大的性能问题。如果您愿意，可以从您的服务器日志中准备好缓存，这样返回的用户甚至不会遇到一次性减速。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T03:02:32.843

如果您这样做的目的是让公司的人员访问您的网站有点不便，请遵循上述建议。但是您将无法完全确保您阻止了所有访问，因为它们可能总是通过代理。如果其他公众可以访问它，您将不得不担心archive.org、搜索引擎缓存等。

可能不是您正在寻找的答案，但它是准确的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T02:30:56.647

如果您使用的是 apache，请查看 .htaccess：[.htaccess 教程](http://httpd.apache.org/docs/1.3/howto/htaccess.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T02:38:44.973

[首先在whois.net](http://www.whois.net)上搜索公司。如果您知道它们只是一个域，请进行 whois 查询。否则，按关键字搜索他们拥有的域。

您可以通过 whois 查询找出分配给公司的主要 IP 范围，然后相应地构建您的拒绝规则。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T03:02:07.023

我知道[WikiScanner](http://wikiscanner.virgil.gr/)可以让您搜索公司或其他组织，然后列出属于它们的 IP 地址范围。举个例子，这是[属于 Google 的所有 IP 地址](http://wikiscanner.virgil.gr/name2ip.php?orgname=Google)，至少根据 WikiScanner 是这样。

根据[HowStuffWorks](http://computer.howstuffworks.com/wikipedia-scanner1.htm)的说法，他们使用了一种叫做“IP2Location”的东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T02:32:04.630

您可以访问实际的服务器配置吗？如果是这样，取决于服务器，您可以在配置中执行此操作。

有关一些可能有用的信息，请参阅[此线程。](http://www.webmasterworld.com/forum92/3546.htm)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T02:44:12.713

[http://en.wikipedia.org/wiki/Rwhois](http://en.wikipedia.org/wiki/Rwhois) 远程登录 rwhois.arin.net 4321

这曾经奏效。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T03:52:10.650

负载不应该放在网络服务器上，你应该把它放在防火墙上。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T05:44:18.680

请注意，使用上述技术永远不可能完全禁止特定公司访问您的网站。他们仍然可以使用代理服务器或在家中查看您的网站。

如果您绝对想控制谁有权访问，您应该只允许经过身份验证和授权的用户访问您的站点。

# git - 为什么每个分支的 git stash 不是唯一的？

> ID：89487
> 
> 赞同：83
> 
> 时间：2008-09-18T02:29:32.873
> 
> 标签：git, git-stash

我想它允许将更改从一个分支移动到下一个分支，但这就是樱桃采摘的目的，如果您没有提交更改，也许您不应该移动它们？

我有时在错误的分支上应用了错误的存储，这让我想知道这个问题。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2008-09-18T11:26:17.093

如前所述，如果你想要一个“每个分支的存储”，你真的想要一个从现有分支分叉的新分支。

此外，除了已经提到的事实，即 stash 允许您拉入正在处理的分支中，它还允许您在提交所有内容之前*切换分支。*这对于通常意义上的挑选工作非常有用，而不是对挑选*工作副本*有用。

F.ex.，在处理功能分支时，我经常会注意到代码中与该分支无关的小错误或外观杂质。好吧，我只是马上解决这些问题。到了提交的时候，我会选择性地提交相关的更改，而不是修复和修饰。相反，我存储了这些，这允许我切换到我的小修复分支，然后我可以在其中应用存储并分别提交每个小修复。（根据有问题的更改，我还将再次存储其中一些，以切换到不同的功能分支，我将在其中应用*这些*。）

这使我可以在工作时深入编程模式，而不必担心代码的正确库管理。然后，当我休息一下时，我可以回去仔细地将我的更改分类到所有合适的架子上。

如果存储不是全局的，那么这种类型的工作流将很难做到。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-07-09T04:27:06.027

从 Git 1.6 开始，您现在可以使用

```
git stash branch name_of_new_branch 
```

Git 将为您创建新分支，并检查一下！有关详细信息，请参阅

*   [git书](http://git-scm.com/book/en/Git-Tools-Stashing#Creating-a-Branch-from-a-Stash)

*   `info git-stash`并搜索 option= `branch`。

我猜你可以移动藏匿处使用

```
git stash branch <branch | new_branch> [<stash>] 
```

并查看您的存储列表，请使用

```
git stash list 
```

[参考](http://www.kernel.org/pub/software/scm/git/docs/git-stash.html)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-09-18T02:49:44.167

如果您想要一个从分支运行的“存储”，请执行以下操作以将您的更改存储在当前分支的新分支上。

```
git checkout -b new_stash
git commit -a -m "stashed changes" 
```

撤消存储

```
git reset HEAD^
git branch -d new_stash 
```

git stash 特别有用，因为您可以将更改拉入脏树中，即，如果您有出色的编辑并想做

```
git pull 
```

你不能，你可以存储你的更改，拉然后应用存储

```
git stash
git pull
git stash apply
git stash clear 
```

希望这有帮助！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-12T20:44:25.337

git-stash 对我来说最有用的是将尚未签入的更改移至与当前签出的分支不同的分支。

例如 - 我经常发现自己在错误修复分支上进行简单的更改；只是发现我正在进行的更改比我最初猜测的要复杂。Git-stash 是将这组更改移动到不同分支的最简单方法。

# c++ - 比较 std::tr1::function<> 对象

> ID：89488
> 
> 赞同：5
> 
> 时间：2008-09-18T02:29:50.223
> 
> 标签：c++, function, tr1

我一直在尝试使用 tr1 函数模板在 C++ 中实现类似 C# 的事件系统，该函数模板用于存储处理事件的函数。

我创建了一个向量，以便可以将多个侦听器附加到此事件，即：

```
vector< function<void (int)> >  listenerList; 
```

我希望能够从列表中删除一个处理程序以停止侦听器接收事件。

那么，如何在此列表中找到与给定侦听器对应的条目？我可以测试列表中的“函数”对象是否引用特定函数吗？

谢谢！

编辑：在研究了 boost::signal 方法后，似乎它可能是使用令牌系统实现的，正如你们中的一些人所建议的那样。[这是有关此的一些信息](http://www.boost.org/doc/libs/1_36_0/doc/html/signals/tutorial.html)。观察者在附加到事件时会保留一个“连接”对象，如果需要，此连接对象用于断开连接。所以看起来无论你是使用Boost还是使用tr1滚动你自己的，基本原理都是一样的。即它会有点笨拙:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T06:25:59.030

我不知道您是否被锁定在标准 C++ 和 tr1 中，但如果没有，如果您只使用 boost::signal 和 boost::bind 之类的东西来解决您的问题，似乎可以完全避免您的问题原始问题 - 创建一个事件系统 - 而不是尝试自己推出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T04:46:25.480

好吧，你让我工作。困难的部分是尝试匹配 C# 事件的确切使用模式。如果你跳过它，有更简单的方法来做你所要求的。（我的同事 Jason 在所有地方都使用了一个 Notifier 对象。）不管怎样，这里有一些令人难以置信的无聊代码，它可以满足您的需求。不幸的是，它不允许您将参数从 Subject 传递给 Observer。为此，您需要添加更多智能。

```
#include "stdafx.h"
#include <iostream>
#include <string>
#include <list>
#include <algorithm>
#include <boost/tr1/functional.hpp>
#include <boost/tr1/memory.hpp>

using namespace std;
using namespace std::tr1;

template <typename T>
class ObserverHandle
{
public:
    typedef boost::function<void (T*)> const UnderlyingFunction;

    ObserverHandle(UnderlyingFunction underlying)
        : _underlying(new UnderlyingFunction(underlying))
    {
    }

    void operator()(T* data) const
    {
        (*_underlying)(data);
    }

    bool operator==(ObserverHandle<T> const& other) const
    {
        return (other._underlying == _underlying);
    }

private:
    shared_ptr<UnderlyingFunction> const _underlying;
};

class BaseDelegate
{
public:
    virtual bool operator==(BaseDelegate const& other)
    {
        return false;
    }

    virtual void operator() () const = 0;
};

template <typename T>
class Delegate : public BaseDelegate
{
public:
    Delegate(T* observer, ObserverHandle<T> handle)
        : _observer(observer),
        _handle(handle)
    {
    }

    virtual bool operator==(BaseDelegate const& other)
    {
        BaseDelegate const * otherPtr = &other;
        Delegate<T> const * otherDT = dynamic_cast<Delegate<T> const *>(otherPtr);
        return ((otherDT) &&
            (otherDT->_observer == _observer) &&
            (otherDT->_handle == _handle));
    }

    virtual void operator() () const
    {
        _handle(_observer);
    }

private:
    T* _observer;
    ObserverHandle<T> _handle;
};

class Event
{
public:
    template <typename T>
    void add(T* observer, ObserverHandle<T> handle)
    {
        _observers.push_back(shared_ptr<BaseDelegate>(new Delegate<T>(observer, handle)));
    }

    template <typename T>
    void remove(T* observer, ObserverHandle<T> handle)
    {
        // I should be able to come up with a bind2nd(equals(dereference(_1))) kind of thing, but I can't figure it out now
        Observers::iterator it = find_if(_observers.begin(), _observers.end(), Compare(Delegate<T>(observer, handle)));
        if (it != _observers.end())
        {
            _observers.erase(it);
        }
    }

    void operator()() const
    {
        for (Observers::const_iterator it = _observers.begin();
            it != _observers.end();
            ++it)
        {
            (*(*it))();
        }
    }

private:
    typedef list<shared_ptr<BaseDelegate>> Observers;
    Observers _observers;

    class Compare
    {
    public:
        Compare(BaseDelegate const& other)
            : _other(other)
        {
        }

        bool operator() (shared_ptr<BaseDelegate> const& other) const
        {
            return (*other) == _other;
        }

    private:
        BaseDelegate const& _other;
    };
};

// Example usage:

class SubjectA
{
public:
    Event event;

    void do_event()
    {
        cout << "doing event" << endl;
        event();
        cout << "done" << endl;
    }
};

class ObserverA
{
public:
    void test(SubjectA& subject)
    {
        subject.do_event();
        cout << endl;

        subject.event.add(this, _observe);
        subject.do_event();
        subject.event.remove(this, _observe);
        cout << endl;

        subject.do_event();
        cout << endl;

        subject.event.add(this, _observe);
        subject.event.add(this, _observe);
        subject.do_event();
        subject.event.remove(this, _observe);
        subject.do_event();
        subject.event.remove(this, _observe);
        cout << endl;

    }

    void observe()
    {
        cout << "..observed!" << endl;
    }

private:
    static ObserverHandle<ObserverA> _observe;
};

// Here's the trick: make a static object for each method you might want to turn into a Delegate
ObserverHandle<ObserverA> ObserverA::_observe(boost::bind(&ObserverA::observe, _1));

int _tmain(int argc, _TCHAR* argv[])
{
    SubjectA sa;
    ObserverA oa;
    oa.test(sa);

    return 0;
} 
```

这是输出：

> 做完 事件
> 
> 做事件
> ..观察到！
> 完毕
> 
> 做完 事件
> 
> 做事件
> ..观察到！
> ..观察到的！
> 做完
> 事件
> ..观察到！
> 完毕

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T02:42:03.033

[boost 函数文档中的常见问题解答 #1](http://www.boost.org/doc/libs/1_36_0/doc/html/function/faq.html)似乎解决了您的问题 - 简单的答案是“否”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T02:47:04.003

该[提案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2002/n1402.html)（第 IIIb. 节）指出，它们在任何方面都不可比较。如果您向它们附加一些额外的信息，您可以轻松识别每个回调。例如，如果您只是定义一个包装函数指针的结构，则可以删除它们（假设您插入的结构相同）。您还可以向结构中添加一些字段（例如客户端可以保留的自动生成的 guid）并与之进行比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-31T16:05:52.433

我遇到了类似的问题并找到了解决方案。我使用了一些 C++0x 特性，但只是为了方便，它们不是必不可少的部分。看看这里：
>[消息系统：回调可以是任何东西](https://stackoverflow.com/questions/6884041/messaging-system-callbacks-can-be-anything/6890543#6890543)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T02:53:42.723

如果您只存储函数指针（而不是与所需签名匹配的其他函子），这很容易（参见下面的代码）。但总的来说，就像其他海报所说的那样，答案是否定的。在这种情况下，您可能希望将仿函数作为值存储在哈希中，其中键是用户在添加和删除时提供的东西。

下面的代码演示了如何获取要调用的函子/指针对象。要使用它，您必须知道要提取的对象的确切类型（即，`typeid`您指定的类型必须与`typeid`包含的仿函数/指针的类型匹配）。

```
#include <cstdio>
#include <functional>

using std::printf;
using std::tr1::function;

int main(int, char**);
static function<int (int, char**)> main_func(&main);

int
main(int argc, char** argv)
{
    printf("%p == %p\n", *main_func.target<int (*)(int, char**)>(), &main);
    return 0;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T03:16:24.383

关于什么

```
map<key-type, function<void (int)> > listeners; 
```

# ruby-on-rails - 在 Rails 中重命名控制器并清除生成的内容

> ID：89489
> 
> 赞同：12
> 
> 时间：2008-09-18T02:29:55.713
> 
> 标签：ruby-on-rails, ruby

我正在关注有关 restful_authentication 插件的 railscast。

他建议运行命令：

脚本/生成经过身份验证的用户会话

我做了什么，一切都“很好”，但随后会话不起作用。再次检查该站点，他提到了一个命名标准并列出了更新的代码，其中指出：

脚本/生成经过身份验证的用户会话

随着会议的多元化。

所以现在我有一个带有 SessionController 的 session_controller.rb，但我猜根据命名标准，它正在寻找 SessionsController，导致代码失败并出现错误“SessionsController#create 中的 NameError”

我看到了问题，这很明显，但我不知道的是，如何在不重新生成内容的情况下解决这个问题？有没有办法逆转生成过程以清除生成的所有更改？

我尝试使用 e SessionsController 类将文件重命名为 session_controller，但失败了。

在写这篇文章时，我解决了自己的问题。我必须将路由文件中的会话重命名为 map.resource 并将视图目录从会话重命名为会话，并将 html.erb 文件中的 session_path 更新为 session_path。

所以我解决了我的问题，但我关于删除生成内容的答案仍然存在。是否可以取消生成内容？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-18T08:29:12.137

实际上，`script/destroy`适用于任何生成器 - 生成器通过读取有关要创建的文件的各种脚本来工作；`script/destroy`只需反向读取该脚本并删除所有创建的文件，只要您为其提供与传递给`script/generate`.

总结一下：`script/destroy authenticated user session`将为您删除所有生成的文件，之后您可以`script/generate user sessions`毫无问题地运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T04:34:33.277

我从未尝试过`script/destroy`，但如果您要恢复刚刚所做的更改，那么 generate 命令应该会为您提供添加的文件和所做更改的列表。如果您使用某种版本控制系统，运行 status/diff 也可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T02:38:24.553

你可以在 subversion 中回滚到上一个版本，然后重新开始，对吗？对？:-)

rails 有`script/destroy`“未生成”的东西，但我怀疑它只适用于 rails 附带的东西，而不适用于 restful 身份验证插件。

我会说你最好的选择是在文件中查找（或者`grep -R`如果你没有使用 IDE） - 找到所有引用你的旧 SessionController 并更改它

# math - LaTeX 中的年金或角度操作符号

> ID：89490
> 
> 赞同：5
> 
> 时间：2008-09-18T02:30:01.190
> 
> 标签：math, latex, symbols, angle

如何在 LaTeX 中设置*角度*或*年金运算的符号？*具体来说，这是精算*a*角*s* = (1-v ^s )/i。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T03:52:54.280

我查看了[Life's Contingency's Package](http://maths.dur.ac.uk/stats/courses/AMII/am.html)、各种精算前哨[论坛](http://www.actuarialoutpost.com/actuarial_discussion_forum/showthread.php?t=113896) [主题](http://www.actuarialoutpost.com/actuarial_discussion_forum/showthread.php?p=2200212)和 LaTeX 的[综合符号列表](ftp://tug.ctan.org/pub/tex-archive/info/symbols/comprehensive/symbols-letter.pdf)，并将最好的组合到以下宏中：

```
\DeclareRobustCommand{\lcroof}[1]{
  \hbox{\vtop{\vbox{%
      \hrule\kern 1pt\hbox{%
        $\scriptstyle #1$%
        \kern 1pt}}\kern1pt}%
    \vrule\kern1pt}}
\DeclareRobustCommand{\angle}[1]{
  _{\lcroof{#1}}} 
```

然后，您可以通过键入此宏来解决问题的示例

```
 $a\angle{s}$ 
```

如果您需要全套精算符号，您应该使用[Life's Contingency's Package](http://maths.dur.ac.uk/stats/courses/AMII/am.html) `lifecon`。使用`lifecon`，您可以通过键入

```
 $a_{\lcroof{s}}$ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T02:40:11.883

有关 LaTeX 符号的*完整*列表，请参阅[综合 LaTeX 符号列表](http://www.ctan.org/tex-archive/info/symbols/comprehensive/symbols-a4.pdf)。值得打印出来并放在枕头下。第 95 页有一些代码可以做你想做的事。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-04-26T20:19:07.813

我对精算符号和下标/上标有同样的问题，所以我做了一个包来让我的生活更轻松并帮助其他人。

另外，我添加了一些快捷方式来节省时间。

项目[页面](https://vigou3.gitlab.io/actuarialsymbol/)和[CTAN](https://ctan.org/pkg/actuarialsymbol)。

您所需要的只是精算符号包。

在代码的开头你必须写

```
\usepackage{actuarialsymbol} 
```

对于下标/上标

```
\actsymb['subscripLeft']['superscriptL']{<middle>}{'subscriptR'}{'superscriptR'} 
```

输出示例：

[![在此处输入图像描述](https://i.stack.imgur.com/tzB0V.jpg)](https://i.stack.imgur.com/tzB0V.jpg)

[![在此处输入图像描述](https://i.stack.imgur.com/G1iCS.png)](https://i.stack.imgur.com/G1iCS.png)

精算符号的快捷方式示例： [![在此处输入图像描述](https://i.stack.imgur.com/zLTCU.jpg)](https://i.stack.imgur.com/zLTCU.jpg)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-28T22:01:17.137

我一直在为我的一位教授排版，结果我需要一些帮助来生成年金符号的累积值。

[我在这里](https://tex.stackexchange.com/questions/383754/negation-like-symbol-with-text-numbers-underneath)的 tex stack exchange 上问了这个问题

[Heiko Oberdiek](https://tex.stackexchange.com/users/16967/heiko-oberdiek)产生的结果是

```
\documentclass{article}
\usepackage{siunitx}

\makeatletter
\newcommand*{\NegationLike}[1]{%
  \mathop{%
    \mathpalette\@NegationLike{#1}%
  }%
  % A little space is added automatically,
  % if a math ord atom follows.
}
\newdimen\BarLineWidth
\newcommand*{\@NegationLike}[2]{%
  % #1: math style
  % #2: argument
  \vbox{%
    % The rule thickness of \overline or \underline
    % is available in the font dimen register 8
    % of the math family 3 of the current size.
    \BarLineWidth=%
      \the\fontdimen8%
      \ifx\displaystyle#1\textfont
      \else\ifx\textstyle#1\textfont
      \else\ifx\scriptstyle#1\scriptfont
      \else\scriptscriptfont
      \fi\fi\fi
      3\relax
    % The rule at the top
    \hrule height\BarLineWidth
    % Move the box with the vertical line
    % as height as the top of the upper line
    % to get a better corner. 
```

其中产生： [年金累计值](https://i.stack.imgur.com/JWUKW.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T02:40:01.260

\annu
可以在这里找到一个很好的乳胶符号列表[http://www.ctan.org/tex-archive/info/symbols/comprehensive/symbols-a4.pdf](http://www.ctan.org/tex-archive/info/symbols/comprehensive/symbols-a4.pdf)

# php - 在与 Rails 应用程序相同的域上运行 Wordpress 的最佳方式是什么？

> ID：89504
> 
> 赞同：16
> 
> 时间：2008-09-18T02:33:14.177
> 
> 标签：php, ruby-on-rails, apache, wordpress, nginx

我有一个标准的 Rails 应用程序，在[http://mydomain](http://mydomain)上运行 Nginx 和 Mongrel 。我需要在[http://mydomain.com/blog](http://mydomain.com/blog)上运行一个 Wordpress 博客。我的偏好是将博客托管在 Apache 中，在同一台服务器或单独的机器上运行，但我不希望用户在 URL 中看到不同的服务器。这可能吗？如果没有，您会建议什么来实现目标？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T02:39:20.403

实际上，由于您使用的是 Nginx，因此您的状态已经很好，不需要 Apache。

[您可以通过 fastcgi 运行 PHP（在 Nginx wiki 中](http://wiki.codemongers.com/NginxFcgiExample)有如何执行此操作的示例），并在您的 Nginx 配置中使用 URL 匹配模式将一些 URL 定向到 Rails，将其他 URL 定向到 PHP。

这是一个通过 PHP fastcgi 运行 WordPress 博客的 Nginx 配置示例（请注意，我还放入了与 WordPress .htaccess 等效的 Nginx，因此您还将拥有已经使用此配置的精美 URL）：

```
server {
    listen       example.com:80;
    server_name  example.com;
    charset      utf-8;
    error_log    /www/example.com/log/error.log;
    access_log   /www/example.com/log/access.log  main;
    root         /www/example.com/htdocs;

    include /www/etc/nginx/fastcgi.conf;
    fastcgi_index index.php;

    # Send *.php to PHP FastCGI on :9001
    location ~ \.php$ {
        fastcgi_pass 127.0.0.1:9001;
    }

    # You could put another "location" section here to match some URLs and send
    # them to Rails. Or do it the opposite way and have "/blog/*" go to PHP
    # first and then everything else go to Rails. Whatever regexes you feel like
    # putting into "location" sections!

    location / {
        index index.html index.php;
        # URLs that don't exist go to WordPress /index.php PHP FastCGI
        if (!-e $request_filename) {
            rewrite ^.* /index.php break;
            fastcgi_pass 127.0.0.1:9001;
        }

    }
} 
```

这是我在上述配置中包含的 fastcgi.conf 文件（我将它放在一个单独的文件中，因此我的所有虚拟主机配置文件都可以将它包含在正确的位置，但您不必这样做）：

```
# joelhardi fastcgi.conf, see http://wiki.codemongers.com/NginxFcgiExample for source
fastcgi_param  GATEWAY_INTERFACE  CGI/1.1;
fastcgi_param  SERVER_SOFTWARE    nginx;

fastcgi_param  QUERY_STRING       $query_string;
fastcgi_param  REQUEST_METHOD     $request_method;
fastcgi_param  CONTENT_TYPE       $content_type;
fastcgi_param  CONTENT_LENGTH     $content_length;

fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;
fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;
fastcgi_param  REQUEST_URI        $request_uri;
fastcgi_param  DOCUMENT_URI       $document_uri;
fastcgi_param  DOCUMENT_ROOT      $document_root;
fastcgi_param  SERVER_PROTOCOL    $server_protocol;

fastcgi_param  REMOTE_ADDR        $remote_addr;
fastcgi_param  REMOTE_PORT        $remote_port;
fastcgi_param  SERVER_ADDR        $server_addr;
fastcgi_param  SERVER_PORT        $server_port;
fastcgi_param  SERVER_NAME        $server_name;

# PHP only, required if PHP was built with --enable-force-cgi-redirect
#fastcgi_param  REDIRECT_STATUS    200; 
```

我也碰巧做了 Nginx wiki 建议的事情，并使用来自 Lighttpd 的 spawn-fcgi 作为我的 CGI-spawner（Lighttpd 是一个非常快速的编译器，没有奇怪的依赖项，所以安装起来既快速又容易），但你也可以为此使用一个简短的 shell/Perl 脚本。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T08:19:15.110

我认为 joelhardi 的解决方案优于以下解决方案。但是，在我自己的应用程序中，我喜欢将博客保存在与 Rails 站点不同的 VPS 上（内存分离问题）。为了让用户看到相同的 URL，您使用通常用于代理到 mongrel 集群的相同代理技巧，除了您代理到另一个盒子上的端口 80（或其他）。十分简单。对用户来说，它就像你代理到 mongrel 一样透明——他们只“看到”NGINX 在你的域的端口 80 上响应。

```
upstream myBlogVPS {
        server 127.0.0.2:80;  #fix me to point to your blog VPS
}

 server {
    listen       80;

    #You'll have plenty of things for Rails compatibility here

    #Make sure you don't accidentally step on this with the Rails config!

    location /blog {
        proxy_pass         http://myBlogVPS;
        proxy_redirect     off;

        proxy_set_header   Host             $host;
        proxy_set_header   X-Real-IP        $remote_addr;
        proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
    } 
```

顺便说一句，您可以使用这个技巧让 Rails 与您想要的任何服务器技术一起使用。直接代理到适当的服务器/端口，NGINX 会将其隐藏起来，不让外界看到。此外，由于 URL 都指向同一个域，因此您可以无缝集成基于 PHP 的博客、基于 Python 的跟踪系统和 Rails 应用程序——只要您正确编写 URL。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T11:52:14.613

上面的答案很好地解决了您的问题。

另一种 FCGI 是使用 php-fpm。文档有点稀疏，但效果很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T04:29:08.727

如果您在 EC2 / AWS 环境中， Nginx 现在[提供了执行此操作的脚本。](http://nginx.org/en/docs/howto_setup_development_environment_on_ec2.html)

它可能很容易适应您的情况。这很方便。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T02:34:50.787

在我看来，像重写操纵器之类的东西会做你想做的事。对不起，我没有更多的细节——只是大声思考:)

# ruby-on-rails - 如何对所有请求实施重定向（在某些条件下）？

> ID：89543
> 
> 赞同：4
> 
> 时间：2008-09-18T02:42:09.053
> 
> 标签：ruby-on-rails, ruby, redirect

我想进行一些设置，以便如果我的应用程序中的帐户被禁用，我希望所有请求都被重定向到“禁用”消息。

我已经在我的 ApplicationController 中进行了设置：

```
class ApplicationController < ActionController::Base
  before_filter :check_account

  def check_account
    redirect_to :controller => "main", :action => "disabled" and return if !$account.active?
  end
end 
```

当然，这并不完全有效，因为如果帐户未处于活动状态，它会进入无限循环。我希望使用类似的东西：

```
redirect_to :controller => "main", :action => "disabled" and return if !$account.active? && @controller.controller_name != "main" && @controller.action_name != "disabled" 
```

但我注意到在 Rails v2.1（我正在使用的）中，@controller 现在是控制器，这在 ApplicationController 中似乎不起作用。

实现这样的事情的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T03:02:39.613

你有几个选择。

如果您的操作方法“禁用”在应用程序范围内是唯一命名的，您可以在 before_filter 调用中添加一个异常，如下所示：

```
before_filter :check_account, :except => :disabled 
```

如果您想专门检查过滤器中的控制器和操作，您应该注意此代码已经是控制器对象的一部分。您可以将其称为“自我”，如下所示：

```
 def check_account
    return if self.controller_name == "main" && self.action_name == "disabled"

    redirect_to :controller => "main", :action => "disabled" and return if !$account.active?
  end 
```

最后，如果您愿意，可以从 MainController.rb 中覆盖过滤器方法：

```
 def check_account
    return if action_name == "disabled"
    super
  end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T04:56:33.380

您也可以将 a`skip_before_filter`用于您不想应用过滤器的一个控制器/方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T19:07:47.967

首先摆脱那个全局变量 $account 怎么样？通过使用全局变量，您基本上是在为一些严重的错误做好准备。只需使用实例变量而不是 @ 或者更好的是在 ApplicationController 上创建一个名为 current_account 的方法，该方法访问 @current_account 实例变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T03:01:21.800

如果没有太多覆盖，那么只需将 if 放在重定向过滤器中

if action != disabled redirect() end

# c# - App_Code 文件夹问题

> ID：89570
> 
> 赞同：29
> 
> 时间：2008-09-18T02:49:01.347
> 
> 标签：c#, asp.net, visual-studio, app-code

因此，我正在设计的新网站上的 App_Code 文件夹存在一个非常奇怪的问题。

我在 App_Code 文件夹的命名空间中有一个基本类。当我设置命名空间并从类中创建一个对象时，IDE 中的一切工作正常。它会在悬停时显示类摘要，当您单击“转到定义”时，它会转到类文件。它在本地也可以正常工作。

但是，当我将网站加载到我的服务器上时，我在访问该页面时收到此错误消息：

第 10 行：使用 System.Web.UI.WebControls；
第 11 行：使用 System.Web.UI.WebControls.WebParts；
**第 12 行：使用 xxxx.xxxx**

**编译器错误消息：** CS0246：找不到类型或命名空间名称“xxxxxx”（您是否缺少 using 指令或程序集引用？）

我知道类文件在那里。有人知道发生了什么吗？

编辑：

约翰，是的，它是一个 2.0 站点。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2010-11-11T21:16:12.153

您的类未编译的问题，您只需转到 App_Code 文件夹中任何类的属性并将其“构建操作”属性从“内容”更改为“编译”即可解决此问题

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-18T03:23:16.520

如果您的应用程序是 Web 应用程序项目而不是网站项目，则代码文件不应位于 App_Code 文件夹中（我知道这是愚蠢的设计）。创建一个名为 code 或其他东西的新文件夹并将它们放在那里。

当我将一堆旧的 .Net 网站升级为应用程序项目时，它给我带来了各种各样的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-29T19:26:12.440

这只是发生在我身上，解决方案是 App_Code（和 App_Data）没有放在服务器的根目录中，而是放在包含其他所有内容的子文件夹中。必须在根！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T03:53:21.847

每当在引用的程序集或代码文件中发生编译时错误时，我注意到 IDE 解析器和编译器之间有时会出现不匹配。在这种情况下，IDE 将正确识别类型并为它们提供完全支持，但由于编译器无法创建引用的对象，它会抱怨引用的对象不存在。

现在我不想指责任何人——这只是一个猜测——但你可能应该确保你引用的代码文件中没有任何错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-04T21:53:49.813

根据您发布站点的方式，它不会在 App_Code 中查找，而是在包含该类的 Bin 文件夹中查找 DLL。您是如何将您的网站传输到服务器的？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-27T15:59:08.090

对于后面的那些......我遇到了同样的问题，但这是因为我在 App_Code 中命名了一个类“HTML”。花了很长时间才弄清楚这只是名称冲突，因为编译器在告诉我问题所在方面没有多大帮助。

# vxworks - 如果在 vxWorks 中禁用抢占，时间片会怎样？

> ID：89575
> 
> 赞同：1
> 
> 时间：2008-09-18T02:50:22.200
> 
> 标签：vxworks

如果您在 VxWorks 中启用了循环调度，并且您使用 taskLock() 禁用抢占，那么当您的时间片到期时会发生什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T02:51:41.213

当通过 taskLock 禁用抢占时，时间片计数器不会增加。在重新启用抢占之前，您的时间片永远不会过期。

# sql-server - 如何在 SQL Management Studio 中指定不同的端口号？

> ID：89576
> 
> 赞同：455
> 
> 时间：2008-09-18T02:50:41.887
> 
> 标签：sql-server, sql-server-2005, ssms

我正在尝试连接到不在端口 1433 上的 Microsoft SQL 2005 服务器。使用 SQL Management Studio 连接到服务器时，如何指示不同的端口号？

* * *

## 回答 #1

> 赞同：911
> 
> 时间：2008-09-18T02:51:29.360

`127.0.0.1,6283`

ip和端口之间加逗号

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2008-09-18T03:11:16.113

如果您要连接到命名实例并且在连接时 UDP 不可用，那么您可能还需要指定协议。

例子：`tcp:192.168.1.21\SQL2K5,1443`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-18T03:09:58.237

另一种方法是在 Config Manager 中设置别名。然后，当您想要连接时，只需键入该别名即可。当您必须在多个端口和/或多个协议上管理多个服务器/实例和/或服务器时，这使得它变得更加容易并且更可取。给他们起友好的名字，让他们更容易记住。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T02:54:44.763

您将需要 SQL Server 配置管理器。转到 Sql Native Client Configuration，选择 Client Protocols，右键单击 TCP/IP 并在此处设置默认端口。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-13T18:00:54.837

使用客户端管理器会影响所有连接或设置客户端机器特定的别名。

使用上面的逗号：这也可以在 app.config 中使用

如果您和服务器之间也有防火墙，则可能需要它......

* * *

## 回答 #6

> 赞同：-7
> 
> 时间：2013-11-13T10:54:45.643

在带有服务器执行命令的 Windows 平台上：

```
netstat -a -b 
```

查找`sql server`进程并找到端口 fe 49198

或者更容易。连接 dbvisualizer，运行`netstat -a -b`find dbvis.exe 进程并获取端口。

# ajax - 在服务器端处理 Ajax (XHR) 调用期间，您能否可靠地设置或删除 cookie？

> ID：89579
> 
> 赞同：7
> 
> 时间：2008-09-18T02:50:56.350
> 
> 标签：ajax, xmlhttprequest, cookies, server-side, dwr

我自己对此进行了一些测试（确切地说是在 DWR 框架 Ajax 请求处理程序的服务器端处理期间），看来您可以成功操作 cookie，但这与我在 Ajax 最佳实践和浏览器如何解释来自 XmlHttpRequest 的响应。注意我已经测试过：

*   IE 6 和 7
*   火狐 2 和 3
*   苹果浏览器

并且在所有情况下，浏览器都正确解释了在 Ajax 请求处理期间对 HttpServletResponse 对象的标准 cookie 操作，但我想知道将 cookie 操作推送到客户端是否是最佳实践，或者这个（更清洁的）服务器侧面 cookie 处理是可以信任的。

我欢迎特定于 DWR 框架和一般 Ajax 的答案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T03:00:35.750

XMLHttpRequest 始终使用 Web 浏览器的连接框架。这是 AJAX 程序正常工作的要求，因为如果 XHR 对象无法访问浏览器的 cookie 池，用户将被注销。

理论上，Web 浏览器可以在不使用浏览器连接框架的情况下简单地共享会话 cookie，但是（据我所知）这在实践中从未发生过。甚至 Flash 插件也使用 Web 浏览器的连接。

因此最终结果是通过 AJAX 操作 cookie 是安全的。请**记住**，AJAX 调用可能永远不会发生。它们不是保证事件，所以不要指望它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T08:08:58.803

在 DWR 的上下文中，它可能不是“安全的”。

通过阅读[DWR 网站](http://directwebremoting.org/dwr/server/javaapi.html)，它说：

> 将 HTTP 请求和响应视为只读非常重要。虽然 HTTP 标头可以通过 OK，但某些浏览器很有可能会忽略它们。

我认为这意味着设置 cookie 或请求属性是禁止的。
话虽如此，我有设置请求属性的代码（我在阅读该页面之前编写的代码）并且它似乎工作正常（除了删除我在上面的评论中提到的 cookie）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-18T02:56:56.693

在客户端操作 cookie 与“最佳实践”相反。而且它也不应该是必要的。HttpOnly cookie 并不是无缘无故引入的。

# c++ - 在调试器下运行时，AssignProcessToJobObject 失败并出现“拒绝访问”错误

> ID：89588
> 
> 赞同：20
> 
> 时间：2008-09-18T02:52:31.557
> 
> 标签：c++, c, winapi, createprocess

你这样做`AssignProcessToJobObject`了，它会因“拒绝访问”而失败，但只有在你在调试器中运行时才会失败。为什么是这样？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-18T02:52:38.640

这让我困惑了大约 30 分钟。

首先，您可能需要在您的应用程序中嵌入一个 UAC 清单（[如此处建议](https://stackoverflow.com/questions/53208/how-do-i-automatically-destroy-child-processes-in-windows#53214)）。像这样的东西：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
  <assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <!-- Identify the application security requirements. -->
    <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
      <security>
        <requestedPrivileges>
          <requestedExecutionLevel
            level="asInvoker"
            uiAccess="false"/>
        </requestedPrivileges>
      </security>
    </trustInfo>
  </assembly> 
```

其次（这是我坚持的一点），当您在调试器下运行应用程序时，它会在作业对象中创建您的进程。在您将其分配给您的工作之前，您的子进程需要能够脱离哪个。所以（duh），您需要 `CREATE_BREAKAWAY_FROM_JOB`在标志中指定`CreateProcess`）。

如果您没有在调试器下运行，或者您的父进程正在工作，则不会发生这种情况。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-02-08T20:32:03.730

这似乎经常咬我，虽然很好，但 1800INFORMATION 的帖子似乎没有包含许多似乎有帮助的原因和修复，所以似乎值得发布我看到这种情况发生的原因的摘要。

1.  在尝试自己解决此问题时，请注意，从 CMD.EXE、资源管理器和 Visual Studio 运行时，可能会出于不同原因出现此问题。尝试从各个位置运行失败的可执行文件有助于确定问题的原因。尽管 VS 和 Explorer.exe 失败，但您的应用程序可能只能从 CMD.EXE 中找到
2.  就我而言，在 Win7 下，我似乎需要取消注释 app.manifest 文件中指示 Win7 兼容性的“supportedOS”元素。这似乎解决了从资源管理器运行时的问题。要添加清单，请右键单击项目，点击添加，然后找到“应用程序清单文件”。
3.  为了让 Visual Studio 2010 正常工作，我似乎需要阻止它使用程序兼容性助手，Tom Minka 在这里分享了两种方法：[https](https://stackoverflow.com/a/4232259/86375) ://stackoverflow.com/a/4232259/86375 ，注意，我必须重新启动 VS2010 以接受他建议的更改。

# gcc - 调试选项 -g 如何更改二进制可执行文件？

> ID：89603
> 
> 赞同：81
> 
> 时间：2008-09-18T02:55:41.347
> 
> 标签：gcc, gdb, debugging

编写 C/C++ 代码时，为了调试二进制可执行文件，必须在编译器/链接器上启用调试选项。对于 GCC，选项是 -g。启用调试选项后，对二进制可执行文件有何影响？允许调试器正常工作的文件中存储了哪些附加数据？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-09-18T02:57:56.847

-g 告诉编译器将符号表信息存储在可执行文件中。除其他外，这包括：

*   符号名称
*   符号的类型信息
*   符号来自的文件和行号

调试器使用此信息为符号输出有意义的名称，并将指令与源代码中的特定行相关联。

对于某些编译器，提供 -g 将禁用某些优化。例如，icc 使用 -g 将默认优化级别设置为 -O0，除非您明确指定 -O[123]。此外，即使您确实提供了 -O[123]，阻止堆栈跟踪的优化仍将被禁用（例如，从堆栈帧中剥离帧指针。这对性能只有很小的影响）。

对于某些编译器，-g 将禁用可能混淆符号来源的优化（指令重新排序、循环展开、内联等）。如果您想通过优化进行调试，可以使用 -g3 和 gcc 来解决其中的一些问题。将包含有关可能已内联的宏、扩展和函数的额外调试信息。这可以允许调试器和性能工具将优化的代码映射到原始源，但这是最好的努力。一些优化确实破坏了代码。

有关更多信息，请查看[DWARF](http://en.wikipedia.org/wiki/DWARF)，这是最初设计用于与 ELF（Linux 和其他操作系统的二进制格式）一起使用的调试格式。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-18T03:00:41.897

将符号表添加到将函数/变量名称映射到数据位置的可执行文件中，以便调试器可以报告有意义的信息，而不仅仅是指针。这不会影响程序的速度，您可以使用“strip”命令删除符号表。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T03:12:16.733

除了调试和符号信息
Google DWARF（ELF 上的一个开发者笑话）

默认情况下，启用调试时，大多数编译器优化都会关闭。
因此，代码是源代码到机器代码的纯粹翻译，而不是许多应用于发布二进制文件的高度专业化转换的结果。

但最重要的区别（在我看来）
Debug 构建中的 Memory 通常初始化为一些编译器特定的值以方便调试。在发布版本中，除非应用程序代码明确这样做，否则不会初始化内存。

查看您的编译器文档以获取更多信息：
但 DevStudio 的一个示例是：

> *   0xCDCDCDCD 在堆中分配，但未初始化
> *   0xDDDDDDDD 释放堆内存。
> *   0xFDFDFDFD "NoMansLand" 栅栏自动放置在堆内存的边界。永远不应该被覆盖。如果您确实覆盖了一个，那么您可能会离开数组的末尾。
> *   0xCCCCCCCC 在堆栈上分配，但未初始化

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-18T03:10:55.427

-g 在可执行文件中添加调试信息，例如变量名、函数名和行号。这允许调试器（例如 gdb）逐行执行代码、设置断点并检查变量的值。由于这些附加信息，使用 -g 会增加可执行文件的大小。

此外，gcc 允许将 -g 与 -O 标志一起使用，从而开启优化。调试优化的可执行文件可能非常棘手，因为变量可能会被优化掉，或者指令可能会以不同的顺序执行。通常，在使用 -g 时关闭优化是个好主意，即使它会导致代码慢得多。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T03:08:24.577

出于兴趣，您可以打开十六进制编辑器并查看使用`-g`和不使用生成的可执行文件。您可以看到添加的符号和内容。它也可能会更改程序集 ( `-S`)，但我不确定。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T03:02:50.890

[这个问题](https://stackoverflow.com/questions/69250/why-does-a-cc-program-often-have-optimization-turned-off-in-debug-mode#69313)有一些重叠，涵盖了另一方的问题。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-18T03:23:21.607

一些操作系统（如[z/OS](http://en.wikipedia.org/wiki/Z/OS)）会生成一个包含调试符号的“边文件”。这有助于避免使用额外信息使可执行文件膨胀。

# sql-server - 在 sql server 2005 中，如何更改表的“模式”而不丢失任何数据？

> ID：89606
> 
> 赞同：75
> 
> 时间：2008-09-18T02:56:06.773
> 
> 标签：sql-server, database

我有一个进入“db_owner”模式的表，我需要它在“dbo”模式中。

是否有脚本或命令可以运行来切换它？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-09-18T03:01:29.240

在 SQL Server Management Studio 中：

1.  右键单击表格并选择修改（现在称为“设计”）

2.  在属性面板上选择正确的拥有模式。

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2008-09-18T03:01:01.223

```
ALTER SCHEMA [NewSchema] TRANSFER [OldSchema].[Table1] 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-02-01T08:03:38.290

按此选择显示全部`TABLE_SCHEMA`：

```
SELECT TABLE_SCHEMA, TABLE_NAME 
FROM INFORMATION_SCHEMA.TABLES 
```

您可以使用此查询将所有表的所有架构更改为 dbo 表架构：

```
DECLARE cursore CURSOR FOR 

SELECT TABLE_SCHEMA, TABLE_NAME 
FROM INFORMATION_SCHEMA.TABLES 
WHERE TABLE_SCHEMA <> 'dbo' 

DECLARE @schema sysname, 
 @tab sysname, 
 @sql varchar(500) 

OPEN cursore     
FETCH NEXT FROM cursore INTO @schema, @tab 

WHILE @@FETCH_STATUS = 0     
BEGIN 
 SET @sql = 'ALTER SCHEMA dbo TRANSFER ' + @schema + '.' + @tab     
 PRINT @sql     
 FETCH NEXT FROM cursore INTO @schema, @tab     
END 

CLOSE cursore     
DEALLOCATE cursore 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-18T03:06:38.637

简单的答案

```
sp_changeobjectowner [ @objname = ] 'object' , [ @newowner = ] 'owner' 
```

您不需要停止与数据库的所有连接，这可以即时完成。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-05-08T16:43:36.697

对sAeid 的出色回答**略有改进......**

我添加了一个 exec 来让这段代码自动执行，并在顶部添加了一个联合，以便我可以更改两个表和存储过程的架构：

```
DECLARE cursore CURSOR FOR 

select specific_schema as 'schema', specific_name AS 'name'
FROM INFORMATION_SCHEMA.routines
WHERE specific_schema <> 'dbo' 

UNION ALL

SELECT TABLE_SCHEMA AS 'schema', TABLE_NAME AS 'name'
FROM INFORMATION_SCHEMA.TABLES 
WHERE TABLE_SCHEMA <> 'dbo' 

DECLARE @schema sysname, 
 @tab sysname, 
 @sql varchar(500) 

OPEN cursore     
FETCH NEXT FROM cursore INTO @schema, @tab 

WHILE @@FETCH_STATUS = 0     
BEGIN 
 SET @sql = 'ALTER SCHEMA dbo TRANSFER [' + @schema + '].[' + @tab +']'    
 PRINT @sql   
 exec (@sql)  
 FETCH NEXT FROM cursore INTO @schema, @tab     
END 

CLOSE cursore     
DEALLOCATE cursore 
```

我也不得不恢复一个 dbdump，发现架构不是 dbo - 我花了几个小时试图让 Sql Server 管理工作室或 Visual Studio 数据传输来改变目标架构......我最终只是针对恢复的模式运行这个在新服务器上转储以按照我想要的方式获取内容。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-18T03:59:54.640

当我使用 SQL Management Studio 时，我没有得到“修改”选项，只有“设计”或“编辑”。如果您有 Visual Studio（我检查过 VS.NET 2003、2005 和 2008），您可以使用服务器资源管理器来更改架构。右键单击表并选择“设计表”（2008）或“打开表定义”（2003、2005）。突出显示完整的“列名”列。然后，您可以右键单击并选择“属性页”或“属性”(2008)。从属性表中，您应该看到“所有者”（2003 和 2005）或“架构”（2008）以及可能架构的下拉列表。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-08T20:03:56.040

我将它用于一堆表需要位于不同模式中的情况，在这种情况下是 dbo 模式。

```
declare @sql varchar(8000)
;

select
  @sql = coalesce( @sql, ';', '') + 'alter schema dbo transfer [' + s.name + '].[' + t.name + '];'
from 
  sys.tables t
  inner join
  sys.schemas s on t.[schema_id] = s.[schema_id]
where 
  s.name <> 'dbo'
;

exec( @sql )
; 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-09-18T03:04:48.797

您需要首先停止与数据库的所有连接，通过运行命令更改“db_owner”表的所有权

```
sp_MSforeachtable @command1="sp_changeobjectowner ""?"",'dbo'" 
```

在哪里 ？是表名。

# c - 什么是特权指令？

> ID：89607
> 
> 赞同：28
> 
> 时间：2008-09-18T02:56:25.713
> 
> 标签：c, winapi, debugging, odbc

我添加了一些可以干净编译的代码，并且刚刚收到此 Windows 错误：

```
---------------------------
(MonTel Administrator) 2.12.7: MtAdmin.exe - Application Error
---------------------------
The exception Privileged instruction.

 (0xc0000096) occurred in the application at location 0x00486752. 
```

我即将开始寻找错误，我期待它是我所做的一些愚蠢的事情，它恰好产生了这个消息。代码编译干净，没有错误或警告。EXE 文件的大小已增长到 1,454,132 字节，并包含指向 的链接`ODCS.lib`，但它是 Win32 API 的纯 C 语言，带有 DEBUG（在 Windows 2000 上的 P4 上运行）。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-09-18T03:23:03.027

为了回答这个问题，特权指令是处理器操作码（汇编指令），只能在“主管”（或 Ring-0）模式下执行。这些类型的指令往往用于从 Windows 内核访问 I/O 设备和受保护的数据结构。

常规程序以“用户模式”（Ring-3）执行，不允许直接访问 I/O 设备等...

正如其他人所提到的，原因可能是堆栈损坏或函数指针调用混乱。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-18T03:03:46.973

当使用指向无效数据的函数指针时，通常会发生这种事情。如果您的代码破坏了返回堆栈，也可能发生这种情况。有时很难追踪这类错误，因为它们通常难以重现。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-18T03:04:22.340

特权指令是仅允许在 Ring-0（即内核模式）中执行的 IA-32 指令。如果你在用户空间中遇到这个问题，你要么有一个非常旧的 EXE，要么是一个损坏的二进制文件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-18T03:54:30.173

正如我所怀疑的那样，我这样做很愚蠢。我想我解决这个问题的速度快了两倍，因为上面消息中的评论中有一些线索。感谢那些人，尤其是那些指出应用程序早期覆盖堆栈的人。实际上，我在这里发现了几个答案比我标记为回答问题的帖子更有用，因为他们提示并排队我看哪里，尽管我认为它最好地总结了答案。

事实证明，我刚刚添加了一个按钮，该按钮超过了包含一些工具栏按钮信息（位于堆栈上）的数组的最大大小。我忘记了

```
#define MAX_NUM_TOOBAR_BUTTONS (24)

```

甚至存在！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T03:04:03.557

我能想到的第一个可能性是，您可能正在使用本地数组，并且它位于函数声明的顶部附近。您的边界检查变得疯狂并覆盖了返回地址，它指向了一些只允许内核执行的指令。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T03:01:57.603

我在 2000 年使用 Visual c++ 6.0 看到了这一点。

调试 C++ 库在异常处理程序中调用了物理 I/O 指令。如果我没记错的话，它会将状态转储到曾经用于 DMA 基址寄存器的 I/O 端口，我假设微软的某个人正在使用它作为调试器卡。

查找可能导致诊断代码运行的潜在错误情况。

我正在调试，回溯并阅读反汇编。在处理时这是一个异常 `std::string`，可能是索引结束。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T03:10:28.860

错误位置 0x00486752 对我来说似乎真的很小，在可执行代码通常存在的位置之前。我同意丹尼尔，这对我来说似乎是一个疯狂的指针。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-11-02T12:32:25.357

The CPU of most processors manufactured in the last 15 years have some special instructions which are very powerful. These privileged instructions are kept for operating system kernel applications and are not able to be used by user written programs.

This restricts the damage that a user-written program can inflict upon the system and cuts down the number of times that the system actually crashes.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-12-12T19:18:54.273

When executing in kernel mode, the operating system has unrestricted access to both the kernel and the user program's memory.

The load instructions for the base and limit registers are privileged instructions.

# bash - 在 bash 脚本中，如何清理用户输入？

> ID：89609
> 
> 赞同：47
> 
> 时间：2008-09-18T02:56:27.897
> 
> 标签：bash, shell, user-input, sanitization

我正在寻找获取简单输入的最佳方法：

```
echo -n "Enter a string here: "
read -e STRING 
```

并通过删除非字母数字字符、小写（大写）和用下划线替换空格来清理它。

顺序重要吗？是`tr`最好/唯一的方法吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-09-18T17:04:57.623

正如 dj_segfault 指出的那样，shell 可以为您完成大部分工作。不过，看起来你必须依靠外部的东西来小写字符串。为此，您有很多选择，例如上面的 perl one-liners 等，但我认为 tr 可能是最简单的。

```
# first, strip underscores
CLEAN=${STRING//_/}
# next, replace spaces with underscores
CLEAN=${CLEAN// /_}
# now, clean out anything that's not alphanumeric or an underscore
CLEAN=${CLEAN//[^a-zA-Z0-9_]/}
# finally, lowercase with TR
CLEAN=`echo -n $CLEAN | tr A-Z a-z` 
```

这里的顺序有些重要。我们想去掉下划线，加上用下划线替换空格，所以我们必须确保先去掉下划线。通过等待将东西传递给 tr 直到最后，我们知道我们只有字母数字和下划线，并且我们可以确定我们没有空格，所以我们不必担心 shell 解释特殊字符。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-09-18T04:18:28.277

Bash 可以自己完成这一切，非常感谢。如果您查看手册页的**Parameter Expansion**部分，您会看到 bash 具有内置替换、子字符串、修剪、rtrim 等。

要消除所有非字母数字字符，请执行

```
CLEANSTRING=${STRING//[^a-zA-Z0-9]/} 
```

**这就是**奥卡姆的剃刀。无需启动另一个进程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-01-26T14:43:28.480

对于**Bash >= 4.0**：

```
CLEAN="${STRING//_/}" && \
CLEAN="${CLEAN// /_}" && \
CLEAN="${CLEAN//[^a-zA-Z0-9]/}" && \
CLEAN="${CLEAN,,}" 
```

这对于使用 docker/podman 以编程方式创建容器名称特别有用。但是，在这种情况下，您还需要删除下划线：

```
# Sanitize $STRING for a container name
CLEAN="${STRING//[^a-zA-Z0-9]/}" && \
CLEAN="${CLEAN,,}" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T03:06:00.197

又快又脏：

`STRING=`echo 'dit /ZOU/ een test123' | perl -pe's/ /*/g;tr/[A-Z]/[a-z]/;s/[^a-zA-Z0-9*]//g'``

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T03:36:45.083

你可以通过 perl 运行它。

```
export CLEANSTRING=$(perl -e 'print join( q//, map { s/\\s+/_/g; lc } split /[^\\s\\w]+/, \$ENV{STRING} )') 
```

我在这里使用的是 ksh 样式的 subshel​​l，我不完全确定它在 bash 中是否有效。

这就是 shell 的好处，你可以使用 perl、awk、sed、grep....

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T03:01:50.333

经过一番环顾后，似乎`tr`确实是最简单的方法：

```
export CLEANSTRING="`echo -n "${STRING}" | tr -cd '[:alnum:] [:space:]' | tr '[:space:]' '-'  | tr '[:upper:]' '[:lower:]'`" 
```

[我猜是奥卡姆剃刀](http://en.wikipedia.org/wiki/Occam's_Razor)。

# java - 有人为pojos做测试用例吗？

> ID：89620
> 
> 赞同：4
> 
> 时间：2008-09-18T02:58:02.463
> 
> 标签：java, unit-testing

有必要吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T03:07:57.667

我为除了简单的 getter 和 setter 之外的所有内容编写显式测试。

如果 getter 或 setter 只包含一个 return blah；或 this.blah = blah; 我认为没有太大的价值。大多数时候这些都是生成的，我觉得把测试放在一起的时间可以更好地花在其他地方。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T06:24:13.280

我认为这个问题在术语方面有点混乱。POJO（普通旧 Java 对象）是指不受对特定应用程序服务器或第三方库的依赖关系的 Java 对象。使用良好的 IOC（控制反转）框架，如 Spring，允许您将所有类编写为 POJO，以便您可以独立测试它们，而无需在测试中启动应用程序服务器。

Java bean 是一个简单的 Java 类，包含私有属性和公共 getBlah() 和 setBlah() 访问器方法，仅此而已。Java bean 本质上是 POJO。

因此，如果问题是“我应该测试我的 POJO（包含业务逻辑）吗？” 答案是肯定的。

如果问题是，“我应该测试我的 Java bean（它们是没有行为的简单值对象）吗？” 答案可能不是。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T04:05:04.237

说“当然”很容易。但是，原因如下：在真正的软件中，您有一层又一层的组件。很容易说你在堆栈底部的小pojo太小而不会出现真正的错误，但是当你在软件中遇到意想不到的结果时，你把所有涉及的没有经过彻底测试的代码加起来，你最终会和一大堆Jenga嫌疑人。

但是，如果您在构建更高级别的功能之前测试您的较低级别的例程，那么当出现问题时，您就知道该去哪里寻找（也就是说，在对较低级别的例程重新运行测试以使肯定有些东西没有改变）。

还要记住，为你的 pojo 编写测试应该相对容易，因为模块提供的功能越少，要测试的就越少。

我同意不测试 getter 和 setter。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T03:06:09.167

如果您的 PoJos 包含对您的业务很重要的逻辑，那么是的，当然要测试它们。

如果他们不这样做，那就不要打扰。有时离开一个没有测试的类很重要，因为它让你以后可以自由地重构它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T13:56:26.360

所以，正如这里的其他人所提到的，是的，你需要测试它们。但是，如果您通过 TDD 出于设计需要创建它们，您会发现一旦运行代码覆盖工具，这些 POJO（或我们 .net 窥视的 POCO）实际上会被覆盖。那是因为 TDD 只允许您编写/重构由某些单元测试驱动的代码。

这就是 TDD 比单元测试更好的原因，恕我直言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T03:47:03.937

除了 getter 和 setter，我会这样做。你必须在某处画线。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T05:18:37.960

通常，POJO 在某些上下文中进行测试。如果您想执行一些必须正确测试的逻辑（最好在开始该逻辑实现之前）。至于 getter 和 setter；通常不需要测试它们，因为覆盖率是通过测试逻辑获得的:-) 尝试检查一些覆盖率报告工具，如 Cobertura 、Clover 或尝试 Emma 并查看需要测试的内容。我真的很喜欢 Clover 报告显示代码中最危险的威胁。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-21T07:12:31.287

好吧，人们似乎忽略了另一个维度。

是的，当您想到 POJO 时，任何人都会想到具有相应 getter 和 setter 的属性。但是，除此之外，借助重写的 equals() 和 hashCode() 方法，POJO 还可以在 Collections 中做出同样的贡献。:) 在这种情况下，我的 POJO 应该接受一个体面的测试！:)

您应该使用不同的可能值测试不同的时间，并确保 equals() 和 hashCode() 组合不提供重复值！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T03:51:22.430

当然，如果它们包含“关键任务”代码，您将需要对其进行测试。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T02:58:42.337

Pojos 仍然可能包含逻辑错误。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T02:59:13.630

如果没有经过测试，它有一个错误！;)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T02:59:56.187

当然是需要的。所有必须工作的代码都必须经过测试。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T03:00:04.610

当然，你还会在什么上做测试用例？

我喜欢做[测试驱动开发](http://en.wikipedia.org/wiki/Test-driven_development)，它主要是关于测试你的 pojos（嗯，实际上是关于设计你的 pojos）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T03:00:46.777

通常。如果您的模型无法按预期工作，那么您将在路上遇到很多麻烦......

从好的方面来说，测试它们要容易得多。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-03-04T08:44:59.153

出于以下原因，即使对于“普通”的 getter 和 setter，您也需要这样做：

*   代码覆盖率——如果你使用 cc 工具，那么你会想要增加你的覆盖率
*   在未来的某个时候，有人可能会决定在你的 getter 或 setter 中加入一些逻辑，然后你的测试可能会失败，让开发人员调整测试（提高意识）

不过，如果有一个工具可以自动生成这些测试，那就太好了……

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-09-18T07:20:41.380

不，我不测试 POJO，因为：

1.- 如果 POJO 包含业务逻辑，我会从 POJO 中提取它，当然，我会对其进行测试。但是那个测试已经在 POJO 之外了。

2.- 如果 POJO 不包含它，即简单/getters/setters 方法，我会在构建时或运行时 ( [CGLIB](http://cglib.sourceforge.net/) ) 动态生成它。所以我测试我的代码生成器，但不是我的 POJO。

# ruby - 你如何将参数传递给define_method？

> ID：89650
> 
> 赞同：162
> 
> 时间：2008-09-18T03:03:13.730
> 
> 标签：ruby, metaprogramming

我想将参数传递给使用 define_method 定义的方法，我该怎么做？

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2008-09-18T03:06:02.257

您传递给 define_method 的块可以包含一些参数。这就是您定义的方法接受参数的方式。当您定义一个方法时，您实际上只是给块起绰号并在类中保留对它的引用。参数随块一起提供。所以：

```
define_method(:say_hi) { |other| puts "Hi, " + other } 
```

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2012-06-19T09:48:50.123

...如果你想要可选参数

```
 class Bar
   define_method(:foo) do |arg=nil|                  
     arg                                                                                          
   end   
 end

 a = Bar.new
 a.foo
 #=> nil
 a.foo 1
 # => 1 
```

...尽可能多的参数

```
 class Bar
   define_method(:foo) do |*arg|                  
     arg                                                                                          
   end   
 end

 a = Bar.new
 a.foo
 #=> []
 a.foo 1
 # => [1]
 a.foo 1, 2 , 'AAA'
 # => [1, 2, 'AAA'] 
```

...的组合

```
 class Bar
   define_method(:foo) do |bubla,*arg|
     p bubla                  
     p arg                                                                                          
   end   
 end

 a = Bar.new
 a.foo
 #=> wrong number of arguments (0 for 1)
 a.foo 1
 # 1
 # []

 a.foo 1, 2 ,3 ,4
 # 1
 # [2,3,4] 
```

... 他们都是

```
 class Bar
   define_method(:foo) do |variable1, variable2,*arg, &block|  
     p  variable1     
     p  variable2
     p  arg
     p  block.inspect                                                                              
   end   
 end
 a = Bar.new      
 a.foo :one, 'two', :three, 4, 5 do
   'six'
 end 
```

**更新**

Ruby 2.0 引入了双 splat `**`（两颗星）（[我引用](https://stackoverflow.com/questions/18289152/what-does-a-double-splat-operator-do)）：

> Ruby 2.0 引入了关键字参数，** 的作用类似于 *，但用于关键字参数。它返回一个带有键/值对的哈希。

...当然你也可以在定义方法中使用它:)

```
 class Bar 
   define_method(:foo) do |variable1, variable2,*arg,**options, &block|
     p  variable1
     p  variable2
     p  arg
     p  options
     p  block.inspect
   end 
 end 
 a = Bar.new
 a.foo :one, 'two', :three, 4, 5, ruby: 'is awesome', foo: :bar do
   'six'
 end
# :one
# "two"
# [:three, 4, 5]
# {:ruby=>"is awesome", :foo=>:bar} 
```

命名属性示例：

```
 class Bar
   define_method(:foo) do |variable1, color: 'blue', **other_options, &block|
     p  variable1
     p  color
     p  other_options
     p  block.inspect
   end
 end
 a = Bar.new
 a.foo :one, color: 'red', ruby: 'is awesome', foo: :bar do
   'six'
 end
# :one
# "red"
# {:ruby=>"is awesome", :foo=>:bar} 
```

我试图用关键字参数、splat 和 double splat 合二为一地创建示例：

```
 define_method(:foo) do |variable1, variable2,*arg, i_will_not: 'work', **options, &block|
    # ... 
```

或者

```
 define_method(:foo) do |variable1, variable2, i_will_not: 'work', *arg, **options, &block|
    # ... 
```

...但这不起作用，看起来有一个限制。当您考虑它是有道理的，因为 splat 运算符是“捕获所有剩余的参数”，而双 splat 是“捕获所有剩余的关键字参数”，因此混合它们会破坏预期的逻辑。（我没有任何参考来证明这一点！）

**2018 年 8 月更新：**

摘要文章：[https ://blog.eq8.eu/til/metaprogramming-ruby-examples.html](https://blog.eq8.eu/til/metaprogramming-ruby-examples.html)

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2008-09-20T21:02:34.263

除了 Kevin Conner 的回答：块参数不支持与方法参数相同的语义。您不能定义默认参数或块参数。

这仅在 Ruby 1.9 中通过支持完整方法参数语义的新替代“stabby lambda”语法得到修复。

例子：

```
# Works
def meth(default = :foo, *splat, &block) puts 'Bar'; end

# Doesn't work
define_method :meth { |default = :foo, *splat, &block| puts 'Bar' }

# This works in Ruby 1.9 (modulo typos, I don't actually have it installed)
define_method :meth, ->(default = :foo, *splat, &block) { puts 'Bar' } 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-05-03T13:50:10.250

使用 2.2，您现在可以使用关键字参数： [https ://robots.thoughtbot.com/ruby-2-keyword-arguments](https://robots.thoughtbot.com/ruby-2-keyword-arguments)

```
define_method(:method) do |refresh: false|
  ..........
end 
```

# windows - 插入后批准 USB 设备

> ID：89663
> 
> 赞同：4
> 
> 时间：2008-09-18T03:06:19.730
> 
> 标签：windows, usb, virus, kiosk

在 Windows 上，是否有任何方法可以在插入后以编程方式批准 USB 设备，如果它是某种类型（比如可移动驱动器）允许使用，否则不允许？也不允许运行驱动程序，只允许以批准的方式使用设备？

IE 我们希望允许插入 USB 驱动器，但不必担心会安装病毒。

**编辑**对不起，我对这个问题的发布不是很清楚。是的，这是 Windows，但我不担心自动运行的程序，这当然是关闭的。用户将无法访问任何可执行文件，只能从驱动器中读取数据。除了我们允许的用户界面（这是一个信息亭），他们将无法访问任何用户界面。我关心的是运行和安装软件的设备驱动程序（ala U3，以及插入 USB 驱动器时自行安装的其他 USB 软件）。有很多病毒可以通过将 USB 驱动器插入系统来运行。我们已将组策略限制在我们可以做到的水平，但我无法找到一种方法来不允许安装驱动程序而不创建预安装的 USB 驱动器的基本白名单，并且没有其他方法可以工作（即.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T03:13:28.480

（由于您担心病毒，我假设我们正在谈论 Windows。）

像这样限制用户是没有意义的。确保用户没有管理员权限。并安装最新的病毒扫描程序。

理由：如果您甚至不允许读取文件，那么无论如何允许 USB 驱动器都是无用的。因此，您将允许从 USB 驱动器读取文件。但是随后有人可以通过将病毒复制到本地硬盘驱动器并从那里运行来安装病毒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T03:20:31.020

此外，在 Windows 上，禁用 USB 驱动器上的自动播放/自动运行。

使用组策略： http: [//www.howtogeek.com/howto/windows/disable-autoplay-of-audio-cds-and-usb-drives/](http://www.howtogeek.com/howto/windows/disable-autoplay-of-audio-cds-and-usb-drives/)

TweakUI 实用程序中还有一些选项：http: [//www.microsoft.com/windowsxp/Downloads/powertoys/Xppowertoys.mspx](http://www.microsoft.com/windowsxp/Downloads/powertoys/Xppowertoys.mspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T13:35:26.427

如果它是您自己的信息亭应用程序，请确保您的信息亭已分配驱动器号 AZ。要访问 USB 驱动器，您需要格式为 \??\Volume{GUID}\Filename 的路径。但是通过将其置于正常文件系统之外，您可以安全地抵御大多数攻击。

你永远不会完全安全。正如 Raymond Chen 所指出的，如果你不赞成分叉，它并没有多大帮助。（物理）损害已经造成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T03:13:17.263

不可以。您可以使用 GPO 限制对可移动媒体的访问，但您无法指定可移动媒体上允许哪些类型的文件，或者它们是否可以执行。

编辑：支持托马斯。比我更好的答案。

# drupal - 如何删除 CCK 生成的 Drupal 内容类型中的默认标题和正文字段？

> ID：89672
> 
> 赞同：7
> 
> 时间：2008-09-18T03:09:47.833
> 
> 标签：drupal, cck

当您使用 Content Creation Kit 在 Drupal 中创建新的内容类型时，您会自动在生成的表单中获得 Title 和 Body 字段。有没有办法删除它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T05:51:42.077

如果您不是开发人员（或者您想缩短开发过程），另一种可能的解决方案是利用 auto_nodetitle 模块。自动节点标题将让您创建生成节点标题的规则。这些可以是编程规则、被替换的标记或只是静态文本。如果没有别的，值得一看。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T05:08:52.210

要删除正文编辑类型，请展开“提交表单设置”并将正文字段标签留空。对于标题，您可以将其重命名为另一个文本字段。如果您真的不需要任何文本字段，您可以创建一个自定义模块，例如称为 foo，并创建函数 foo_form_alter()，它在 $form['type'][' 时将 $form['title'] 替换为[#value](http://api.drupal.org/api/file/developer/topics/forms_api_reference.html/6#value) #value'] 是您的节点类型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-06-17T22:23:20.860

无需安装任何东西：
编辑内容类型时，按“编辑”
（在编辑|管理字段|显示字段菜单上）
点击提交表单设置

在正文字段标签上：
将其留空，它将删除正文字段。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-28T20:08:46.430

> 如果您不是开发人员（或者您想缩短开发过程），另一种可能的解决方案是利用 auto_nodetitle 模块。自动节点标题将让您创建生成节点标题的规则。这些可以是编程规则、被替换的标记或只是静态文本。如果没有别的，值得一看。

并添加到**[威廉奥康纳的](https://stackoverflow.com/questions/89672/how-do-you-remove-the-default-title-and-body-fields-in-a-cck-generated-drupal-con/90373#90373)**解决方案......

不幸的是，该模块的文档记录很差。在我看来，它只有在你使用 PHP 时才真正有效。勾选“Evaluate PHP in Pattern”并在“Pattern for the title”字段中输入如下内容：

```
<?php echo $node->field_staff_email[0]['email']; ?> 
```

或者：

```
<?php echo $node->field_staff_name[0]['value'] . '-' . gmdate('YmdHis'); ?> 
```

...我有一个内部名称为“field_staff_email”的字段，并且正在使用 CCK 电子邮件模块——因此使用了“电子邮件”类型。或者，我有一个内部名称为“field_staff_name”的字段，它只是一个普通的文本字段——因此使用了“值”类型。最后的 gmdate() 调用是为了确保唯一性，因为您可能有两个或多个工作人员命名相同的事物。

我发现这一切的方法是首先尝试：

```
<?php print_r($node); ?> 
```

...这当然给出了疯狂的结果，但至少我能够解析输出并弄清楚如何在这里正确使用 $node 对象。

请注意，如果您使用这些 PHP 例程中的任何一个，那么您最终会在 Drupal Admin 中的内容列表中显示与您编写 PHP 代码完全相同的条目。这就是我不单独使用 gmdate() 的原因，因为这样可能很难找到我的记录进行编辑。

另请注意，您可能能够在 gmdate() 上使用 Base-36 转换来减少输出的大小，因为 gmdate('YmdHis') 相当长。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-26T18:45:15.833

最初的答案都很好。正如标题部分的另一个想法......如何为 cck 节点类型创建自定义模板文件。您将 node.tpl.php 复制到 node-TYPE.tpl.php，然后编辑新文件并删除呈现标题的位置。（不要忘记清除缓存）。

这样做意味着每个节点仍然有一个标题，因此对于内容管理，您不会留下空白标题或类似的东西。

！

# mysql - 如何使用 Oracle SQL Developer 连接到 MySQL 数据库？

> ID：89696
> 
> 赞同：61
> 
> 时间：2008-09-18T03:16:48.470
> 
> 标签：mysql, oracle, oracle-sqldeveloper

我已经安装了 Oracle SQL Developer，并且能够连接和查询 Oracle 数据库。

使用 Help -> Check for Updates 我能够安装 Oracle MySQL Browser 扩展，但没有 MySQL 数据库的连接选项。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2008-09-18T03:20:10.693

在工具 > 首选项 > 数据库下，有一个必须设置的第三方 JDBC 驱动程序路径。设置驱动程序路径后，“新建连接”对话框中应出现单独的“MySQL”选项卡。

注意：这与可从 MySQL 网站下载 JAR 的 jdbc 连接器相同。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2014-03-04T10:49:07.430

事实上，你应该两者都做：

* * *

1.  添加驱动程序

    *   下载驱动[https://maven.atlassian.com/content/groups/public/mysql/mysql-connector-java/5.1.29/](https://maven.atlassian.com/content/groups/public/mysql/mysql-connector-java/5.1.29/)
    *   要添加此驱动程序：
    *   在 Oracle SQL 开发人员 > 工具 > 首选项... > 数据库 > 第三方 JDBC 驱动程序 > 添加条目...
    *   选择之前下载的mysql连接器jar文件。
2.  添加 Oracle SQL 开发者连接器

    *   在 Oracle SQL Developer > 帮助 > 检查更新 > 下一步
    *   检查全部 > 下一步
    *   过滤“mysql”
    *   检查全部 > 完成
3.  下次添加连接时，**MySQL**新选项卡可用！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-01-24T04:04:31.963

这是另一个非常详细的演练，它也向您展示了整个过程，包括在安装 JDBC 驱动程序后在连接对话框中输入的值：[http ://rpbouman.blogspot.com/2007/01/oracle-sql-developer-11 -supports-mysql.html](http://rpbouman.blogspot.com/2007/01/oracle-sql-developer-11-supports-mysql.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-23T18:25:17.523

我对 Windows 客户端和 linux/mysql 服务器的体验：

当sqldev用在windows客户端，mysql安装在linux服务器的意思时，sqldev网络访问mysql。

假设 mysql 已经启动并运行，并且要访问的数据库已启动并正常运行：

• 确保sqldev 的版本（32 或64）。如果是 64 并且为了避免处理路径访问，请将有效的 64 版本的 msvcr100.dll 复制到目录 ~\sqldeveloper\jdev\bin 中。

一种。在记事本中打开文件 msvcr100.dll 并搜索第一次出现的“PE”

```
 i. “PE  d” it is 64.

ii. “PE  L” it is 32. 
```

湾。注意：如果 sqldev 为 64，msvcr100.dll 为 32，应用程序在启动时会卡住。

• 为使sqldev 与mysql 一起工作，需要JDBC jar 驱动程序。从 mysql 网站下载。

一种。驱动程序名称 = mysql-connector-java-xxxx

湾。将其复制到与您的 sqldeveloper 目录相关的某个位置。

C。在菜单 sqldev Tools/Preferences/Database/Third Party JDBC Driver 中设置（添加条目）

• 在 Linux/mysql 服务器更改文件 /etc/mysql/mysql.conf.d/mysqld.cnf 中查找

绑定地址 = 127.0.0.1（这个 linux 本地主机）

并更改为

bind-address = xxx.xxx.xxx.xxx（如果 DNS 已启动，则此 linux 服务器真实 IP 或机器名称）

• 进入 linux mysql 并授予所需的访问权限，例如

# mysql -u root -p

全部授予*。*到 root@'yourWindowsClientComputerName' 由 'mysqlPasswd' 识别；

刷新特权；

重启 mysql - sudo /etc/init.d/mysql restart

• 启动 sqldev 并创建新连接

一种。用户 = 根

湾。pass = (你的mysql pass)

C。选择 MySql 选项卡

```
 i.   Hostname = the linux IP hostname

 ii.  Port     = 3306 (default for mysql)

 iii. Choose Database = (from pull down the mysql database you want to use)

 iv.  save and connect 
```

这就是我所要做的。

谢谢，

啤酒

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-12T21:14:29.417

尽管@BrianHart 的回答是正确的，但如果您从远程主机连接，您还需要允许远程主机连接到 MySQL/MariaDB 数据库。

我的文章描述了在 Oracle SQL Developer 中连接到 MySQL/MariaDB 数据库的完整说明：

[https://alvinbunk.wordpress.com/2017/06/29/using-oracle-sql-developer-to-connect-to-mysqlmariadb-databases/](https://alvinbunk.wordpress.com/2017/06/29/using-oracle-sql-developer-to-connect-to-mysqlmariadb-databases/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-27T23:57:56.553

您可能还会发现以下相关内容：

[Oracle SQL Developer 与 Microsoft SQL Server 的连接](https://stackoverflow.com/questions/23797585/oracle-sql-developer-connection-to-microsoft-sql-server/26598722#26598722)

在我的情况下，我必须将其`ntlmauth.dll`放在 sql-developer 应用程序目录本身（即 sql-developer\jdk\jre\bin）中。为什么这个位置在系统 jre/bin 我不知道。但它奏效了。

# concurrency - 并发 Prime 生成器

> ID：89705
> 
> 赞同：6
> 
> 时间：2008-09-18T03:19:20.837
> 
> 标签：concurrency, erlang, primes

我正在通过 projecteuler.net 上的问题来学习如何在 Erlang 中编程，而我最难的是创建一个可以在不到一分钟的时间内创建所有低于 200 万的素数的素数生成器。使用顺序样式，我已经编写了三种类型的生成器，包括 Eratosthenes 的筛子，它们都没有表现得足够好。

我认为并发 Sieve 会很好用，但我收到 bad_arity 消息，我不知道为什么。关于我为什么遇到问题或如何正确编码的任何建议？

这是我的代码，注释掉的部分是我试图使事情并发的地方：

```
-模块（主服务器）。
-编译（export_all）。

开始（）->
    注册（素数，产卵（乐趣（）->循环（）结束））。

is_prime(N) -> rpc({is_prime,N})。

RPC（请求）->
    素数！{self(), 请求},
    收到
        {素数，响应} ->
            回复
    结尾。

循环（）->
    收到
        {来自，{is_prime，N}} ->
            如果
                N 从！{素数，假};
                N =:= 2 -> 从！{素数，真}；
                N rem 2 =:= 0 -> 从！{素数，假};
                真->
                    值 = is_not_prime(N),
                    Val = not(lists:member(true, Values)),
                    从 ！{素数，瓦尔}
            结尾，
            环形（）
    结尾。

for(N,N,_,F) -> [F(N)];
for(I,N,S,F) 当 I + S [F(I)|for(I+S, N, S, F)];
for(I,N,S,F) 当 I + S =:= N -> [F(I)|for(I+S, N, S, F)];
当 I + S > N -> [F(I)] 时，for(I,N,S,F)。

get_list(I, 限制) ->
    如果
        一世
            [我*A || 一种
            []
    结尾。

is_not_prime(N) ->
    对于(3, N, 2,
        乐趣（一）->
            列表 = get_list(I,trunc(N/I)),
            列表：成员（N，列表：展平（列表））
        结尾
        ）。

    %%L = for(1,N, fun() -> spawn(fun(I) -> wait(I,N) end) end),
    %%SeedList = [A || 一种  
    %% 列表：foreach(fun(X) ->
    %% 密码！{in_list, X}
    %% 结束，种子列表）
    %% 结束，L)。

%%等待(I,N) ->
%% 列表 = [I*A || 一个列表：成员（X，列表）
％％ 结尾。

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-03-06T07:40:50.307

我使用 Go 和 channels 编写了一个 Eratosthenesque 并发初筛。

这是代码：http: [//github.com/aht/gosieve](http://github.com/aht/gosieve)

我在这里写了一篇博客：http: [//blog.onideas.ws/eratosthenes.go](http://blog.onideas.ws/eratosthenes.go)

该程序可以在大约 10 秒内筛选出前一百万个素数（所有素数最多为 15,485,863）。筛子是并发的，但算法主要是同步的：goroutines（“actors”——如果你喜欢的话）之间需要太多的同步点，因此它们不能并行自由地漫游。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-22T08:54:14.920

'badarity' 错误意味着你试图用错误数量的参数调用'fun'。在这种情况下...

%%L = for(1,N, fun() -> spawn(fun(I) -> wait(I,N) end) end),

for/3 函数期望 arity 1 的乐趣，而 spawn/1 函数期望 arity 0 的乐趣。试试这个：

```
L = for(1, N, fun(I) -> spawn(fun() -> wait(I, N) end) end), 
```

传递给 spawn 的 fun 继承了其环境所需的部分（即 I），因此无需显式传递它。

虽然计算素数总是很有趣，但请记住，这不是 Erlang 旨在解决的问题。Erlang 是为大规模 actor 风格的并发而设计的。它很可能在所有数据并行计算的例子上表现相当糟糕。在许多情况下，[例如 ML 中的顺序解决方案](http://home.mindspring.com/~eric_rollins/erlangAnt.html)将非常快，以至于任何数量的内核都不足以让 Erlang 赶上，例如[F# 和 .NET 任务并行库](http://undirectedgrad.blogspot.com/2007/12/f-and-task-parallel-library.html)对于这些类型肯定是更好的工具的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T16:37:34.427

要考虑的另一种选择是使用概率素数生成。在乔的书（“主服务器”）中有一个使用米勒拉宾的例子，我认为......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T14:35:50.040

[您可以在此处](http://caylespandon.blogspot.com/2009/01/in-euler-problem-10-we-are-asked-to.html)找到四种不同的 Erlang 实现来查找素数（其中两种基于埃拉托色尼筛法）。此链接还包含比较 4 种解决方案性能的图表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T04:32:26.027

埃拉托色尼筛法相当容易实现，但是——正如您所发现的——不是最有效的。你试过阿特金筛子吗？

[阿特金筛@维基百科](http://en.wikipedia.org/wiki/Sieve_of_Atkin)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T07:45:41.010

素数并行算法：[http ://www.cs.cmu.edu/~scandal/cacm/node8.html](http://www.cs.cmu.edu/~scandal/cacm/node8.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-27T19:30:30.950

两个快速的单进程 erlang 素数生成器；sprimes 在 ~2.7 秒内生成 2m 以下的所有素数，fprimes 在我的计算机上生成 ~3 秒（具有 2.4 GHz Core 2 Duo 的 Macbook）。两者都基于 Eratosthenes 筛法，但由于 Erlang 最适用于列表而不是数组，因此两者都保留未消除的素数列表，检查当前头部的可分性并保留已验证素数的累加器。两者都还实现了一个主轮来对列表进行初始缩减。

```
-module(primes).
-export([sprimes/1, wheel/3, fprimes/1, filter/2]).    

sieve([H|T], M) when H=< M -> [H|sieve([X || X<- T, X rem H /= 0], M)];
sieve(L, _) -> L.
sprimes(N) -> [2,3,5,7|sieve(wheel(11, [2,4,2,4,6,2,6,4,2,4,6,6,2,6,4,2,6,4,6,8,4,2,4,2,4,8,6,4,6,2,4,6,2,6,6,4,2,4,6,2,6,4,2,4,2,10,2,10], N), math:sqrt(N))].

wheel([X|Xs], _Js, M) when X > M ->
    lists:reverse(Xs);
wheel([X|Xs], [J|Js], M) ->
    wheel([X+J,X|Xs], lazy:next(Js), M);
wheel(S, Js, M) ->
    wheel([S], lazy:lazy(Js), M).

fprimes(N) ->
    fprimes(wheel(11, [2,4,2,4,6,2,6,4,2,4,6,6,2,6,4,2,6,4,6,8,4,2,4,2,4,8,6,4,6,2,4,6,2,6,6,4,2,4,6,2,6,4,2,4,2,10,2,10], N), [7,5,3,2], N).
fprimes([H|T], A, Max) when H*H =< Max ->
    fprimes(filter(H, T), [H|A], Max);
fprimes(L, A, _Max) -> lists:append(lists:reverse(A), L).

filter(N, L) ->
    filter(N, N*N, L, []).
filter(N, N2, [X|Xs], A) when X < N2 ->
    filter(N, N2, Xs, [X|A]);
filter(N, _N2, L, A) ->
    filter(N, L, A).
filter(N, [X|Xs], A) when X rem N /= 0 ->
    filter(N, Xs, [X|A]);
filter(N, [_X|Xs], A) ->
    filter(N, Xs, A);
filter(_N, [], A) ->
    lists:reverse(A). 
```

lazy:lazy/1 和lazy:next/1 指的是伪惰性无限列表的简单实现：

```
lazy(L) ->
    repeat(L).

repeat(L) -> L++[fun() -> L end].

next([F]) -> F()++[F];
next(L) -> L. 
```

筛子生成素数并不是并发的好地方（但它可以使用并行性来检查可分性，尽管操作不够复杂，无法证明我迄今为止编写的所有并行过滤器的额外开销是合理的）。

`

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-18T03:24:38.063

我喜欢欧拉计划。

关于素数发生器，我是埃拉托色尼筛法的忠实粉丝。

对于 2,000,000 以下的数字，您可以尝试一个简单的 isPrime 检查实现。我不知道你会如何在 erlang 中做到这一点，但逻辑很简单。

```
For Each NUMBER in LIST_OF_PRIMES
     If TEST_VALUE % NUMBER == 0
          Then FALSE
END
TRUE

if isPrime == TRUE add TEST_VALUE to your LIST_OF_PRIMES

iterate starting at 14 or so with a preset list of your beginning primes. 
```

c# 在不到 1 分钟的时间内运行了一个这样的列表 2,000,000

**编辑：** *附带说明，Eratosthenes 的筛子可以轻松实现并快速运行，但是当您开始进入庞大的列表时会变得笨拙。最简单的实现，使用布尔数组和 int 值运行得非常快。问题是您开始遇到值大小以及数组长度的限制。-- 切换到字符串或位数组实现会有所帮助，但您仍然面临以较大值遍历列表的挑战。*

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-18T03:24:39.670

欧拉计划问题（我会说前 50 个问题中的大多数问题，如果不是更多的话）主要是关于蛮力的，在选择界限时需要一点独创性。

记住要测试任何 N 是否为素数（通过蛮力），您只需要查看它是否可被任何素数整除，直到 floor(sqrt(N)) + 1，而不是 N/2。

祝你好运

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-11T14:40:50.343

这是vb版本

```
 'Sieve of Eratosthenes 
'http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes 
'1\. Create a contiguous list of numbers from two to some highest number n. 
'2\. Strike out from the list all multiples of two (4, 6, 8 etc.). 
'3\. The list's next number that has not been struck out is a prime number. 
'4\. Strike out from the list all multiples of the number you identified in the previous step. 
'5\. Repeat steps 3 and 4 until you reach a number that is greater than the square root of n (the highest number in the list). 
'6\. All the remaining numbers in the list are prime. 
Private Function Sieve_of_Eratosthenes(ByVal MaxNum As Integer) As List(Of Integer)
    'tested to MaxNum = 10,000,000 - on 1.8Ghz Laptop it took 1.4 seconds
    Dim thePrimes As New List(Of Integer)
    Dim toNum As Integer = MaxNum, stpw As New Stopwatch
    If toNum > 1 Then 'the first prime is 2
        stpw.Start()
        thePrimes.Capacity = toNum 'size the list
        Dim idx As Integer
        Dim stopAT As Integer = CInt(Math.Sqrt(toNum) + 1)
        '1\. Create a contiguous list of numbers from two to some highest number n.
        '2\. Strike out from the list all multiples of 2, 3, 5\. 
        For idx = 0 To toNum
            If idx > 5 Then
                If idx Mod 2 <> 0 _
                AndAlso idx Mod 3 <> 0 _
                AndAlso idx Mod 5 <> 0 Then thePrimes.Add(idx) Else thePrimes.Add(-1)
            Else
                thePrimes.Add(idx)
            End If
        Next
        'mark 0,1 and 4 as non-prime
        thePrimes(0) = -1
        thePrimes(1) = -1
        thePrimes(4) = -1
        Dim aPrime, startAT As Integer
        idx = 7 'starting at 7 check for primes and multiples 
        Do
            '3\. The list's next number that has not been struck out is a prime number. 
            '4\. Strike out from the list all multiples of the number you identified in the previous step. 
            '5\. Repeat steps 3 and 4 until you reach a number that is greater than the square root of n (the highest number in the list). 
            If thePrimes(idx) <> -1 Then ' if equal to -1 the number is not a prime
                'not equal to -1 the number is a prime
                aPrime = thePrimes(idx)
                'get rid of multiples 
                startAT = aPrime * aPrime
                For mltpl As Integer = startAT To thePrimes.Count - 1 Step aPrime
                    If thePrimes(mltpl) <> -1 Then thePrimes(mltpl) = -1
                Next
            End If
            idx += 2 'increment index 
        Loop While idx < stopAT
        '6\. All the remaining numbers in the list are prime. 
        thePrimes = thePrimes.FindAll(Function(i As Integer) i <> -1)
        stpw.Stop()
        Debug.WriteLine(stpw.ElapsedMilliseconds)
    End If
    Return thePrimes
End Function 
```

# delphi - 如何从 tWebModule 中检索资源

> ID：89708
> 
> 赞同：2
> 
> 时间：2008-09-18T03:20:14.983
> 
> 标签：delphi

我正在尝试使用 WebBroker 技术提取作为资源嵌入到我的 ISAPI dll 中的 gif 图像。该资源已使用以下 RC 代码添加到 DLL：

```
LOGO_GIF RCDATA logo.gif 
```

使用资源浏览器我验证它在 DLL 中正确。

使用以下代码总是会引发异常，“找不到资源”（使用 Delphi 2009）

```
var
  rc : tResourceStream;
begin
  rc := tResourceStream.Create(hInstance,'LOGO_GIF','RCDATA');
end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T06:26:00.980

RCDATA 是一个[预定义的](http://msdn.microsoft.com/en-us/library/aa381039(VS.85).aspx)资源类型，其整数 ID 为 RT_RCDATA（在类型单元中声明）。

尝试以这种方式访问​​它：

```
rc := tResourceStream.Create(hInstance,'LOGO_GIF', MakeIntResource(RT_RCDATA)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T05:16:33.893

如果我没记错的话，您实际上是在处理 Web 服务器的实例，而不是 dll。我不记得解决方法，但这就是为什么它不起作用的解释。希望其他人可以以此为基础。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T07:37:02.120

使用您自己的任意资源类型，例如 GIF：

```
LOGO_GIF GIF logo.gif 
```

然后使用

```
rc := tResourceStream.Create(hInstance,'LOGO_GIF','GIF'); 
```

或简单地使用

```
rc := tResourceStream.Create(hInstance,'LOGO_GIF', RT_RCDATA); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-22T10:05:20.957

> 或简单地使用
> 
> rc := tResourceStream.Create(hInstance,'LOGO_GIF', **RT__RCDATA** );

这。奇迹般有效。

这里的 D2009 也有同样的问题，但试图从 DLL 中取出 TStringsList。

谢谢。

# vxworks - 我可以在 VxWorks 中显示所有系统对象（信号量、队列...）的列表吗？

> ID：89740
> 
> 赞同：2
> 
> 时间：2008-09-18T03:27:30.817
> 
> 标签：vxworks

我想知道在我的 vxWorks 6.x 系统中哪些信号量、消息队列等处于活动状态。我可以通过调试器访问这些信息，但我想从 shell 访问它。

有办法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T03:32:07.187

VxWorks 6.x 提供了一个名为 classShow() 的函数，它将列出特定类的所有对象（例如信号量、消息队列、任务……）。以下调用将为您提供给定类的对象列表：

```
 classShow(objClassIdGet(classId), 1) 

The classId types are:
  1  windSemClass,       /* Wind native semaphore */
  2  windSemPxClass,     /* POSIX semaphore */
  3  windMsgQClass,      /* Wind native message queue */
  4  windMqPxClass,      /* POSIX message queue */
  5  windRtpClass,       /* real time process */
  6  windTaskClass,      /* task */
  7  windWdClass,        /* watchdog */
  8  windFdClass,        /* file descriptor */
  9  windPgPoolClass,    /* page pool */
  10 windPgMgrClass,     /* page manager */
  11 windGrpClass,       /* group */
  12 windVmContextClass, /* virtual memory context */
  13 windTrgClass,       /* trigger */
  14 windMemPartClass,   /* memory partition */
  15 windI2oClass,       /* I2O */
  16 windDmsClass,       /* device management system */
  17 windSetClass,       /* Set */
  18 windIsrClass,       /* ISR object */
  19 windTimerClass,     /* Timer services */
  20 windSdClass,        /* Shared data region */
  21 windPxTraceClass,   /* POSIX trace */ 
```

# svn - 我可以在 Tortoise SVN 中查看当前签出的修订号吗？

> ID：89741
> 
> 赞同：78
> 
> 时间：2008-09-18T03:27:50.613
> 
> 标签：svn, version-control, tortoisesvn

我想知道当前签出的文件或目录的修订号是什么。有没有办法在 Windows 上的 TortoiseSVN 中做到这一点？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2008-09-18T03:43:40.420

在 Windows 资源管理器中右键单击工作目录，然后选择“Properties”（不是 TortoiseSVN->Properties）。您将看到“属性”对话框，其中有一个名为“Subversion”的选项卡。单击它，您将看到版本号和其他信息。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-18T03:44:17.673

不是在乌龟中，而是在命令行中。

```
svn info 
```

将返回您签出的版本。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2016-02-27T11:18:02.130

*TortoiseSVN -> Show log* :**粗体**线标记了工作副本中的当前版本。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-18T03:30:20.060

如果您使用的是 XP，请将您的资源管理器窗口更改为详细信息视图。导航到 SVN 控制的文件夹，然后转到查看 > 选择详细信息并选择状态/rev/etc 的 SVN 列。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T03:39:23.270

谢谢约翰，这非常有用，但不显示项目根文件夹的修订。

现在您已经为我指明了正确的方向，我发现我可以右键单击该文件夹，选择属性，然后会出现一个包含修订号的 TortoiseSVN 选项卡。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-10T08:01:32.487

在“将资源管理器窗口更改为详细信息视图。导航到 SVN 控制的文件夹，然后转到查看 > 选择详细信息并选择状态/rev/等的 SVN 列。”

您必须更改 Windows 注册表设置，添加此 DWORD 值

HKCU\Software\TortoiseSVN\ColumnsEveryWhere

并将其设置为 1，如 TortoiseSVN 文档中所述。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T03:40:56.963

[不错的](https://stackoverflow.com/questions/89741/can-i-see-the-currently-checked-out-revision-number-in-tortoise-svn#89754)约翰·希恩。我总是右键单击根文件夹并选择 tortoise-svn | 查看日志 。

# linux - Unix Proc 目录

> ID：89745
> 
> 赞同：5
> 
> 时间：2008-09-18T03:28:51.500
> 
> 标签：linux, unix, procfs

我正在尝试查找包含当前用户 ID 的虚拟文件。有人告诉我可以在 proc 目录中找到它，但不太确定是哪个文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T03:41:03.047

您实际上想要`/proc/self/status`，它将为您提供有关当前执行进程的信息。

这是一个例子：

```
$ cat /proc/self/status
Name:   cat
State:  R (running)
Tgid:   17618
Pid:    17618
PPid:   3083
TracerPid:      0
Uid:    500 500 500 500
Gid:    500 500 500 500
FDSize: 32
Groups: 10 488 500 
VmPeak:     4792 kB
VmSize:     4792 kB
VmLck:         0 kB
VmHWM:       432 kB
VmRSS:       432 kB
VmData:      156 kB
VmStk:        84 kB
VmExe:        32 kB
VmLib:      1532 kB
VmPTE:        24 kB
Threads:    1
SigQ:   0/32268
SigPnd: 0000000000000000
ShdPnd: 0000000000000000
SigBlk: 0000000000000000
SigIgn: 0000000000000000
SigCgt: 0000000000000000
CapInh: 0000000000000000
CapPrm: 0000000000000000
CapEff: 0000000000000000
Cpus_allowed:   00000003
Mems_allowed:   1
voluntary_ctxt_switches:    0
nonvoluntary_ctxt_switches: 3 
```

您可能想查看 Uid 和 Gid 行上的第一个数字。您可以通过查看来查找哪些 uid 数字映射到了哪个用户名`/etc/passwd`，或者调用相关函数以将 uid 映射到您使用的任何语言的用户名。

理想情况下，您只需调用系统调用`getuid()`来查找此信息，通过查看来做会`/proc/`适得其反。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T03:32:52.410

为什么不直接使用“ `id -u`”？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T03:32:28.403

我不确定是否可以在`/proc`. 您可以尝试使用`getuid()`函数或`$USER`环境变量。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T03:38:20.573

据我所知，`/proc`它是特定于 Linux 的，而不是一般的 UNIX。如果您真的只想要当前的 UID，请使用`getuid()`or`geteuid()`函数。

如果你知道你只会在 Linux 上，你可以探索下的层次结构`/proc/self/*`，它包含有关当前进程的各种信息。请记住，这`/proc`是“神奇的”，它是内核服务的虚拟文件系统，内容是在您请求它时动态生成的。因此它可以返回特定于当前进程的信息。

例如，试试这个命令：`cat /proc/self/status`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T03:36:06.927

最有可能的是，您要么想要检查`$USER`环境变量。其他选项包括`getuid`and `id -u`，但搜索`/proc`肯定不是最好的操作方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T03:40:06.137

在（至少在 Linux 上）你会发现这样一行：`/proc/*process_id*/status`

```
用户ID：1000 1000 1000 1000
```

这会告诉您进程正在其帐户下运行的用户的 uid。

但是，要找出当前进程的进程id，你需要一个系统调用，然后你也可以`getuid`直接调用来获取uid。

编辑：啊，`/proc/self/status`……每天都在学习新东西！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T14:40:39.950

您正在寻找的东西可能在环境变量中。检查环境变量时，您需要注意使用的 shell。bash 使用“UID”，而 tcsh 使用“uid”，`*nix`以防万一。我还发现 tcsh 设置了“gid”，但我无法在 bash 中找到匹配的变量。

# sql - ms 访问中的层次结构记录集

> ID：89752
> 
> 赞同：1
> 
> 时间：2008-09-18T03:29:49.500
> 
> 标签：sql, ms-access

如何通过**select**语句在 ms 访问中获取**层次结构记录集？**

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T03:34:43.373

DAO 不支持分层记录集。您也许可以在访问中使用 ADO，但我不确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T03:39:04.173

ADO 2.0 支持 MSDataShape - 一个 OLEDB 提供程序。

[在http://microsoft.apress.com/asptodayarchive/72268/data-shaping-with-ado-part-1](http://microsoft.apress.com/asptodayarchive/72268/data-shaping-with-ado-part-1)查看数据整形

# c++ - 将 SIP 库移植到 PSP 的帮助

> ID：89767
> 
> 赞同：2
> 
> 时间：2008-09-18T03:33:58.600
> 
> 标签：c++, porting, sip, playstation-portable, pspsdk

我目前正在尝试将 SIP 堆栈库 (pjSIP) 移植到 PSP 控制台（使用 PSPSDK 工具链），但我在生成文件时遇到了太多麻烦（进行适当的更改并解决链接问题）。

有没有人知道好的文本、书籍或其他东西可以对移植库有所了解？

该项目提供的唯一关于移植的文档似乎过于专注于主要操作系统。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T04:44:51.800

查看移植到 PSP 的其他库。在库的 linux 版本和 PSP 版本之间进行差异应该会告诉你。

此外，尝试了解 PSP 与 POSIX 的兼容性如何，这将告诉您移植库的工作量有多大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T20:01:50.047

PSP 不是 UNIX 且不兼容 POSIX，但是开源工具链由 gcc 4.3、bintutils 1.16.1 和 newlib 1.16 组成。

大多数 C 库已经存在并且可以编译您的大部分代码。仅通过使用以下参数调用配置脚本即可移植许多库：

```
LDFLAGS="-L$(psp-config --pspsdk-path)/lib -lc -lpspuser" ./configure --host psp --prefix=$(pwd)/../target/psp 
```

但是，您可能需要修补您的 configure 和 configure.ac 脚本以了解主机 mips allegrex（PSP cpu），为此您可以搜索 mips*- *-*）行并将其克隆到 allegrex，例如：

```
mips*-*-*)
    noconfigdirs="$noconfigdirs target-libgloss"
    ;;
mipsallegrex*-*-*)
    noconfigdirs="$noconfigdirs target-libgloss"
    ;; 
```

然后你运行 make 命令并希望 newlib 有你需要的一切，如果没有，那么你只需要创建你缺少的函数的替代品。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T03:51:48.357

移植是非常特定于平台的，所以我认为您不会找到很多关于该主题的一般文献。

在我的脑海中，你可能会遇到一些事情：

*   字节序
*   字长
*   可用的图书馆
*   编译器差异
*   链接器差异（您已经看过那个）
*   外围硬件差异
*   ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T18:07:14.087

我做了一些更多的研究，并在 ps2dev 论坛上找到了这篇文章：

> PSP 不是 Unix 系统，并且 pspsdk 不兼容 POSIX。它在某些地方很接近，但你不能指望只使用在 POSIX 系统上编译良好的任何代码并让它工作。例如：
> 
> *   pspsdk 使用newlib，它缺少一些glibc 的特性和头文件。
> *   libc 默认没有链接，所以典型的 autoconf 测试将无法构建
> *   autoconf 对 PSP 一无所知
> *   需要定义 PSP_MODULE_INFO 并在可执行文件上运行 psp-fixup-imports，否则它将无法运行
> 
> 您应该查看所有其他已移植的库和程序（在 psp 和 pspware 存储库中）。例如，所有 SDL 库都使用 autoconf。

我认为这为我正在寻找的内容提供了更多细节，并且还展示了@[Jonathan Arkell] 的观点，即查看已经移植的库。

感谢您的回复。

# sql-server - 生产数据库的夜间可导入或附加副本

> ID：89777
> 
> 赞同：1
> 
> 时间：2008-09-18T03:35:57.350
> 
> 标签：sql-server, snapshot

我们希望能够在夜间制作生产数据库的副本/备份/快照，以便我们可以将其导入开发环境。

我们不想将日志传送到开发环境，因为它需要我们可以随时重置为生产数据库的最后一个副本。

我们需要能够清除某些只会使副本膨胀的日志记录和/或其他无用或繁重的表。

与 sql server 发布向导相比，我们更喜欢附加/分离方法，因为附加比导入快得多。

我应该提到我们只有 SQL Server Standard，因此某些功能将不可用。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T03:38:17.797

[MSDN](http://msdn.microsoft.com/en-us/library/ms187858.aspx)

我会说在 SQL 代理作业中使用这些过程（使用 master.xp_cmdshell 执行复制）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T03:43:44.023

您可能希望将大型表放在它们自己的分区上，并让该分区属于不同的文件组。您将备份然后备份和恢复主文件组。

您可能还想考虑进行增量备份。比如说，每个周末进行一次完整备份，每晚进行一次增量备份。我没有做过文件组备份，所以我不知道这些是否可以很好地协同工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T03:45:27.543

我猜你已经在定期备份你的生产数据库了？如果不是，请停止阅读此回复并立即进行设置。

我建议您编写一个自动运行的脚本，比如每天一次，它：

1.  删除当前的测试数据库。
2.  将您当前的生产备份恢复到您的测试环境。

您可以编写一个简单的脚本来执行此操作并使用 isql.exe 命令行工具执行它。

# visual-studio - 如何停止 Visual Studio 调试器在作业对象中启动我的进程？

> ID：89791
> 
> 赞同：16
> 
> 时间：2008-09-18T03:38:39.790
> 
> 标签：visual-studio, visual-studio-2005, debugging

当我从 Visual Studio 开始我的流程时，它总是在作业对象中创建。我想知道如何关闭这种行为。有任何想法吗？

我希望它是在要调试的作业对象中创建的。我想将我的程序放在不同的作业对象中。

这不是托管过程。我说的是[Job Object](http://msdn.microsoft.com/en-us/library/ms684161(VS.85).aspx)。这是一个非托管 C++ 应用程序。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-11-20T10:25:41.767

当`devenv.exe`或`VSLauncher.exe`以兼容模式运行时会发生这种情况。[程序兼容性助手](http://msdn.microsoft.com/en-us/library/bb756937.aspx)(PCA)将作业对象附加到 Visual Studio 进程，并且每个子进程都继承它。检查作业名称（由 Process Explorer 报告）是否以**PCA**开头。如果是这样，可以按照链接中的说明禁用 PCA。

`Run`您可以使用-> `gpedit.msc`-> `Administrative Templates\Windows Components\Application Compatibility`-> `Turn off Program Compatibility Assistant`->全局禁用 PCA `Enable`。

您可以通过添加注册表项来禁用特定可执行文件的 PCA。对于 Windows 7，相应的注册表项是`HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility Assistant`. 在 regedit 中，右键单击该键，选择`New`-> `Multi-String Value`，将其命名为`ExecutablesToExclude`。将值设置为 and 的完整路径`denenv.exe`，`VSLauncher.exe`在单独的行中且不带引号。对我来说，这些是：

```
C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\devenv.exe
C:\Program Files (x86)\Common Files\microsoft shared\MSEnv\VSLauncher.exe 
```

在 Windows 7 上，一个相关的问题是，您在 Visual Studio 中构建并从资源管理器（不是 Visual Studio 或命令行）运行的可执行文件可能会在兼容模式下运行，并再次获得围绕它们的作业对象。[为防止这种情况，您的可执行文件需要使用新的应用程序清单兼容性部分](http://msdn.microsoft.com/en-us/library/dd371711(VS.85).aspx)声明与 Windows 7 的兼容性的清单。该链接提供了一个 Windows 7 兼容清单的示例。Visual Studio 2010 提供的默认清单不包括此兼容性部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T14:32:06.150

我不知道有任何方法可以控制 VS.NET 为调试而生成的进程的这一方面。但是有一个解决方法，它适用于 VS.NET 不能或不能以您想要的确切方式启动您的进程的任何情况：

启动您的进程（可能使用作为构建后事件的一部分运行的包装 EXE），然后使用工具/附加到进程附加到新启动的进程。如果您作为启动代码的一部分闯入调试器，则甚至不需要这样做（您也可以调试启动问题......）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T14:51:08.410

我无法重现您所看到的内容。我在 VS 2005 和 VS 2008 中都创建了一个非托管 C++ 应用程序，并且在 VS 中启动该进程时，将该进程关联到一个新的作业对象没有问题。

你确定调试器正在这样做吗？

# javascript - YUI Loader Utility 可靠吗？

> ID：89796
> 
> 赞同：3
> 
> 时间：2008-09-18T03:40:01.473
> 
> 标签：javascript, yui

我一直在使用 YUI 组件并想开始使用加载器实用程序来指定我在页面上的依赖项。根据您的经验，YUI 加载器实用程序是在网页中加载 Javascript 依赖项的可靠方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T04:26:08.540

是的，YUI Loader 在所有 A 级浏览器上都是可靠的。查看 Yahoo! 浏览器列表 考虑 A 级，请查看[分级浏览器支持图表](http://developer.yahoo.com/yui/articles/gbs/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T03:49:01.717

一般是的。什么都不会出错，如果确实如此，雅虎肯定会立即解决问题！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-03T18:49:24.973

我经常使用装载机。这是管理依赖项和构建库的好方法。

我遇到了3个问题：

1.  调试 - 很难调试。是模块加载器定义中的错误还是模块（脚本文件）中的错误？
2.  您必须添加自己的“subscibeOnce”函数来添加任何“加载的模块”处理程序。这会在模块加载/插入页面后取消订阅您的处理程序。否则，如果您在页面生命周期的后期插入更多模块 - 它们每次都会调用。
3.  它可以找出的依赖项是有限度的。在 requires:[] （在模块定义中）内排序似乎很重要。我已经看到它试图通过这个列表工作失败。

我使用的是这样的：

```
var TheBase = function(oConfig){
var thisBase = this;
var EVENTS = {
    ON_SCRIPTS_LOADED : "onScriptsLoaded"
    , ON_SCRIPTS_PROGRESS : "onScriptsProgress"
}
for(var eventName in EVENTS){
    thisBase.createEvent(EVENTS[eventName]);    
}
var _loader = new YAHOO.util.YUILoader({
    base: oConfig.yuiBasePath
    ,onSuccess:function(o){
        thisBase.fireEvent(EVENTS.ON_SCRIPTS_LOADED);
    }
    ,onProgress:function(o){
        thisBase.fireEvent(EVENTS.ON_SCRIPTS_PROGRESS,o.name);
    }
})
//optional
    thisBase.loader = _loader; 
```

}

```
TheBase.prototype = {
subscribeOnce : function(eventName, fnc, context, args){
    var that = this;
    var handler = function hander(){
        fnc.apply(context, arguments);
        that.unsubscribe(eventName, handler);
    }
    this.subscribe(eventName, handler, args, false);
} 
```

}

//使用事件提供者增强

```
YAHOO.lang.augment(TheBase, YAHOO.util.EventProvider); 
```

# php - 你如何在 PHP 中找到 2 个字符串之间的区别？

> ID：89799
> 
> 赞同：4
> 
> 时间：2008-09-18T03:40:47.510
> 
> 标签：php, string, comparison

我有 2 个要比较的字符串，并返回第二个字符串中不同字符的位置。

例如，如果我有

1.  `"The brown fox jumps over the lazy dog"`
2.  `"The quick brown fox jumped over the lazy dog"`

我希望它突出“快速”和“编辑”。在 PHP 中解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T03:48:09.690

这可能会奏效：

[PHP 内联差异](http://software.zuavra.net/inline-diff/)

[Text_Diff](http://pear.php.net/package/Text_Diff)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T03:44:16.173

您正在寻找的算法是“最长公共子串问题”。从那里很容易确定差异。参见维基百科：

[http://en.wikipedia.org/wiki/Diff#Algorithm](http://en.wikipedia.org/wiki/Diff#Algorithm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T03:46:34.670

除非你更清楚地定义你的问题，否则这会让你头疼！假设 str1 是“Amanda and Amy”，而 str2 是“Amanda and Amylase Amy”。

您的功能是返回“lase Amy”还是“Amylase”？

正确定义您的问题是解决问题的第一步！

# sql - 如何在 SQL 中引用自定义字段

> ID：89820
> 
> 赞同：5
> 
> 时间：2008-09-18T03:44:33.910
> 
> 标签：sql, sql-server

我正在使用 mssql，但在使用子查询时遇到了问题。真正的查询是相当复杂的，但它的结构与此相同：

```
select 
  customerName, 
  customerId,
  (
    select count(*) 
    from Purchases 
    where Purchases.customerId=customerData.customerId
  ) as numberTransactions
from customerData 
```

我想要做的是按交易数量对表格进行排序，但是当我使用

```
order by numberTransactions 
```

它告诉我没有这样的领域。是否有可能做到这一点？我应该使用某种特殊关键字，例如`this`, 还是`self`?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T03:46:59.803

使用字段编号，在这种情况下：

```
order by 3 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-18T03:49:45.910

有时您必须与 SQL 的语法（预期的子句范围）搏斗

```
SELECT *
FROM
(
select
  customerName,
  customerId,
  (
    select count(*)
    from Purchases
    where Purchases.customerId=customerData.customerId
  ) as numberTransactions
from customerData
) as sub
order by sub.numberTransactions 
```

此外，使用 JOIN 的解决方案是正确的。查看查询计划，SQL Server 应该为两种解决方案提供相同的计划。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T03:47:15.467

做一个内连接。它更容易且更具可读性。

```
select 
customerName,
customerID,
count(*) as numberTransactions
from
    customerdata c inner join purchases p on c.customerID = p.customerID
group by customerName,customerID
order by numberTransactions
```

`编辑：嘿内森，

您意识到您可以将整个表作为子表进行内部连接吗？

```
Select T.*, T2.*
From T inner join 
(select 
customerName,
customerID,
count(*) as numberTransactions
from
    customerdata c inner join purchases p on c.customerID = p.customerID
group by customerName,customerID
) T2 on T.CustomerID = T2.CustomerID
order by T2.numberTransactions 
```

或者，如果这不好，您可以使用临时表（#T1 等）构建查询

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T04:52:27.243

***有更好的方法来获得你的结果，但只是从你的示例查询中，这将适用于 SQL2000 或更好。***

如果您将别名包装在单个刻度**“numberTransactions”**中，然后调用**ORDER BY 'numberTransactions'**

```
select
  customerName, 
  customerId,
  (
    select count(*) 
    from Purchases 
    where Purchases.customerId=customerData.customerId
  ) as 'numberTransactions'
from customerData
ORDER BY 'numberTransactions' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T03:48:03.047

`GROUP BY`使用and a可以实现相同的`JOIN`目的，并且您将摆脱子查询。这也可能更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T03:48:34.590

我认为您可以在 SQL2005 中执行此操作，但不能在 SQL2000 中执行此操作。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T03:47:37.650

你需要复制你的逻辑。SQL Server 对您已命名但不属于 FROM 语句中的数据集的列不是很聪明。

所以使用

```
select 
  customerName, 
  customerId,
  (
    select count(*) 
    from Purchases p
    where p.customerId = c.customerId
  ) as numberTransactions
from customerData c
order by (select count(*) from purchases p where p.customerID = c.customerid) 
```

此外，使用别名，它们使您的代码更易于阅读和维护。;)

# java - What are the best Java example sites?

> ID：89859
> 
> 赞同：2
> 
> 时间：2008-09-18T03:55:33.370
> 
> 标签：java

What are the best Java example sites? I'm looking for places that you go when you have a specific question and you want a little Java code snippet to solve it with.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T04:24:34.970

[java2s](http://www.java2s.com/) is the best according to me. because - 1) Like mrlinx said "almost always has a sample on common stuff" 2) Stuffs are nicely organized by category, so, you can easily find out what you are looking for. 3) You can find codes for latest version of JDK

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T04:00:35.747

I like Java Almanac (now renamed www.exampledepot.com/). It has great examples and very pertinent questions, but it only goes through java 1.4, so unfortunately it's pretty out of date. It has good coverage of simple questions like "Quintessential Regular Expression Search and Replace Program" and "Reading Text from a File". Also covers some more complicated topics.

Another site I like is javapractices.com. This one answers questions at a little higher level than Java Almanac, for example "Modernize old code" or "Know the core libraries".

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T03:58:58.340

The Java Developer's Almanac: [http://www.exampledepot.com/](http://www.exampledepot.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T03:57:43.927

I like [DZone Snippets](http://snippets.dzone.com/tag/java) from ![DZone](https://i.stack.imgur.com/IDNzd.png)

It is a public source code repository.

You can build up your personal collection of code snippets, and categorize them with tags / keywords.

(just add **[another suggestion](https://stackoverflow.com/questions/89859/what-are-the-best-java-examples-sites#90280)**)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T05:27:50.620

Wait a minute...
By re-reading your question... I think **this site** (i.e. [stackoverflow](http://stackoverflow.com)) is the very best place for what you are asking for!

You can publish a problematic java snippet and receive answer.
Case in point : [What is the syntax for mod in java](https://stackoverflow.com/questions/90238/whats-the-syntax-for-mod-in-java)

I have to leave you now: I need to check my profile.
I might have just received my first "brown-nose" badge ;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T19:04:15.297

A place I get a lot of samples / answer to questions is the forums of the sun java web site itself. If the answer isn't there, usually users will point you in the right direction.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-15T01:55:38.840

I like [http://jexamples.com](http://jexamples.com) . This has real working code indexed from open source projects. The site also incorporates ratings so the best examples are shown.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-17T12:18:14.573

I think the good site for examples as well as some tutorials is **[Java Jazzle](http://k2java.blogspot.com)** or [k2java.blogspot.com](http://k2java.blogspot.com)

# vxworks - 如何指定 RTP 在 VxWorks 中可以使用的最大堆数量？

> ID：89866
> 
> 赞同：2
> 
> 时间：2008-09-18T03:57:44.830
> 
> 标签：vxworks

我们正在 VxWorks 6.x 中创建一个实时进程，我们希望限制可以分配给堆的内存量。我们如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T04:05:21.693

通过 rtpSpawn() 创建 RTP 时，您可以指定一个环境变量来控制堆的行为方式。
有3个环境变量：

```
HEAP_INITIAL_SIZE - 最初分配多少堆（默认为 64K）  
HEAP_MAX_SIZE - 要分配的最大堆（默认为无限制）
HEAP_INCR_SIZE - 添加到 RTP 堆时的内存增量（默认为 1 个虚拟页面）

以下代码展示了如何使用环境变量：
 char * envp[] = {"HEAP_INITIAL_SIZE=0x20000", "HEAP_MAX_SIZE=0x100000", NULL);
   rtpSpawn ("myrtp.vxe", NULL, envp, 100, 0x10000, 0, 0); 

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T04:11:08.043

这可以通过使用 HEAP_MAX_SIZE 环境变量来完成。如果设置了它，它会限制堆超过该大小的能力。但是，它不限制初始堆大小。

[见第 31 页](http://www.slac.stanford.edu/grp/cd/soft/vxworks/doc/6.6/vxworks_application_api_reference_6.6.pdf)

# date - 日期组件操作

> ID：89873
> 
> 赞同：3
> 
> 时间：2008-09-18T03:59:03.800
> 
> 标签：date, datetime, excel, vba

是否可以在 VBA中操作a的组件，例如`year`、 ？我想要一个函数，给定一天、一个月和一年，返回相应的日期。`month``day``date`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T04:02:27.503

```
DateSerial(YEAR, MONTH, DAY) 
```

将是您正在寻找的。

`DateSerial(2008, 8, 19)`返回`8/19/2008`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T04:02:01.203

VBA 中有几个日期函数 - 检查这个[站点](http://www.classanytime.com/mis333k/sjdatetime.html)

日期序列（年、月、日）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T04:02:50.060

你想要[DateSerial](http://msdn.microsoft.com/en-us/library/bbx05d0c(VS.80).aspx)：

```
Dim someDate As Date = DateSerial(year, month, day) 
```

# .net - 你如何获得所有已安装字体的列表？

> ID：89886
> 
> 赞同：6
> 
> 时间：2008-09-18T04:01:14.917
> 
> 标签：.net, fonts

特别是在 .NET 中，但我将其保持打开状态。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T04:02:14.353

MSDN：

[枚举已安装的字体](http://msdn.microsoft.com/en-us/library/0yf5t4e8(VS.71).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T04:02:20.220

[http://msdn.microsoft.com/en-us/library/0yf5t4e8.aspx](http://msdn.microsoft.com/en-us/library/0yf5t4e8.aspx)

这应该会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T04:05:36.483

我相信您正在寻找的是 InstalledFontCollection。（需要 .net 的一段代码与这里的任何东西相关的可能性有多大！令人难以置信！）

# java - Java中的Iterator接口有什么好处？

> ID：89891
> 
> 赞同：36
> 
> 时间：2008-09-18T04:01:53.840
> 
> 标签：java, oop, collections, interface, iterator

我刚刚了解了 Java 集合框架如何在链表中实现数据结构。据我了解，`Iterators`这是一种遍历数据结构（例如列表）中的项目的方法。为什么要使用这个接口？为什么是方法`hasNext()`，`next()`而`remove()`不是直接编码到数据结构实现本身？

来自 Java 网站：[链接文本](http://java.sun.com/javase/6/docs/api/)

> 公共接口迭代器<E>
> 
> 集合上的迭代器。Iterator 在 Java 集合框架中取代了 Enumeration。迭代器在两个方面不同于枚举：
> 
> *   迭代器允许调用者在具有明确定义的语义的迭代期间从底层集合中删除元素。
> *   方法名称已得到改进。
> 
> 此接口是 Java 集合框架的成员。

我尝试谷歌搜索，似乎无法找到明确的答案。有人能解释一下 Sun 选择使用它们的原因吗？是因为更好的设计吗？提高安全性？好的OO实践？

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-18T05:06:50.500

> 为什么要使用这个接口？

`Collection`因为它支持允许客户端程序员迭代任何类型的集合的基本操作（注意：在`Object`某种意义上不一定是 a ）。

> 为什么方法......不直接编码到数据结构实现本身？

他们是，他们只是被标记为私人，所以你不能接触到他们并与他们混为一谈。进一步来说：

*   您可以实现或子类化 an `Iterator`，使其执行标准对象不执行的操作，而无需更改其迭代的实际对象。
*   可以遍历的对象不需要让它们的接口被遍历方法弄得一团糟，尤其是任何高度专业化的方法。
*   您可以分`Iterators`发给您希望的任意数量的客户，并且每个客户都可以在自己的时间以自己的速度穿越。
*   特别是 java.util 包中的Java`Iterators`如果在您仍然有输出的情况下修改了支持它们的存储，则会引发异常`Iterator`。此异常让您知道`Iterator`现在可能正在返回无效对象。

对于简单的程序，这似乎都不值得。不过，使它们有用的那种复杂性很快就会出现在你身上。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T05:22:18.950

你问：“为什么方法 hasNext()、next() 和 remove() 不直接编码到数据结构实现本身？”。

Java Collections 框架选择将 Iterator 接口定义为集合本身的外部化。通常，由于每个 Java 集合都实现了该`Iterable`接口，因此 Java 程序将调用`iterator`以创建自己的迭代器，以便可以在循环中使用它。正如其他人所指出的，Java 5 允许我们使用 for-each 循环直接使用迭代器。

将迭代器外部化到它的集合允许客户端控制如何迭代一个集合。我能想到的一个有用的用例是当一个人有一个无限的集合，例如要索引的 Internet 上的所有网页。

在经典的 GoF 书中，内部迭代器和外部迭代器之间的对比非常清晰。

> 一个基本问题是决定哪一方控制迭代，迭代器或使用迭代器的客户端。当客户端控制迭代时，迭代器称为外部迭代器，当迭代器控制它时，迭代器称为内部迭代器。使用外部迭代器的客户端必须推进遍历并从迭代器显式请求下一个元素。相反，客户端将一个操作交给内部迭代器执行，而迭代器将该操作应用于每个元素......
> 
> 外部迭代器比内部迭代器更灵活。例如，用外部迭代器比较两个集合的相等性很容易，但使用内部迭代器实际上是不可能的……但另一方面，内部迭代器更易于使用，因为它们为您定义了迭代逻辑。

有关内部迭代器如何工作的示例，请参阅 Ruby 的`Enumerable`API，它具有内部迭代方法，例如`each`. 在 Ruby 中，想法是将代码块（即闭包）传递给内部迭代器，以便集合可以处理自己的迭代。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-18T09:33:25.133

将集合与指针分开很重要。迭代器指向集合中的特定位置，因此不是集合的组成部分。这样，例如，您可以在同一个集合上使用多个迭代器。

这种分离的缺点是迭代器不知道对其迭代的集合所做的更改。所以你不能改变集合的结构并期望迭代器在没有“抱怨”的情况下继续它的工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T04:39:34.763

使用该`Iterator`接口允许任何实现其方法的类充当迭代器。Java 中接口的概念在某种程度上具有合同义务，即`implements`在接口的类中提供某些功能，以接口所需的方式进行操作。由于必须满足合同义务才能成为有效的类，因此其他类看到该类`implements`的接口并因此放心知道该类将具有那些某些功能。

在这个例子中，类将声明它是接口，而不是在类本身中实现方法（ `hasNext(), next(), remove()`），所以其他人知道可以用作迭代器。反过来，该类将实现接口中的方法（例如），因此它可以像迭代器一样工作。`LinkedList``LinkedList``implements``Iterator``LinkedList``LinkedList``Iterator``hasNext()`

换句话说，实现一个接口是一个面向对象的编程概念，让其他人知道某个类具有它所声称的样子。

这个概念是通过具有必须由实现接口的类实现的方法来实施的。这确保了其他想要使用实现`Iterator`接口的类的类确实具有迭代器应该具有的方法，例如`hasNext()`.

另外需要注意的是，由于 Java 没有多重继承，所以可以使用接口来模拟该特性。通过实现多个接口，可以拥有一个作为子类的类来继承某些特性，同时也可以通过实现一个接口来“继承”另一个的特性。一个例子是，如果我想要一个`LinkedList`被调用的类的子类，`ReversibleLinkedList`它可以以相反的顺序迭代，我可以创建一个被调用的接口`ReverseIterator`并强制它提供一个`previous()`方法。由于`LinkedList`已经实现`Iterator`，新的可逆列表将同时实现`Iterator`和`ReverseIterator`接口。

您可以从[什么是接口？](http://java.sun.com/docs/books/tutorial/java/concepts/interface.html "什么是接口？")摘自 Sun 的 Java 教程。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T05:32:46.413

可以同时使用一个交互器的多个实例。将它们作为基础数据的本地游标来处理。

顺便说一句：偏爱接口而不是具体实现会松散耦合

寻找迭代器设计模式，在这里：[http ://en.wikipedia.org/wiki/Iterator](http://en.wikipedia.org/wiki/Iterator)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T04:12:46.887

因为您可能正在迭代不是数据结构的东西。假设我有一个从服务器提取结果的联网应用程序。我可以返回围绕这些结果的 Iterator 包装器，并通过任何接受 Iterator 对象的标准代码将**它们流式传输。**

将其视为良好 MVC 设计的关键部分。数据必须以某种方式从模型（即数据结构）到视图。使用迭代器作为中间人确保模型的实现永远不会暴露。您可以将 LinkedList 保存在内存中，从解密算法中提取信息，或者包装 JDBC 调用。它对视图根本不重要，因为视图只关心 Iterator 接口。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T04:10:12.040

一篇有趣的论文讨论了使用迭代器的利弊：

[http://www.sei.cmu.edu/pacc/CBSE5/Sridhar-cbse5-final.pdf](http://www.sei.cmu.edu/pacc/CBSE5/Sridhar-cbse5-final.pdf)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T04:11:49.993

我认为这只是很好的 OO 实践。您可以拥有处理各种迭代器的代码，甚至让您有机会创建自己的数据结构或只是实现迭代器接口的泛型类。您不必担心它背后的实现方式。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T04:14:15.633

只是 M2C，如果您不知道的话：您可以避免在[for-each](http://java.sun.com/j2se/1.5.0/docs/guide/language/foreach.html)循环就足够的情况下直接使用迭代器接口。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T05:21:39.340

最终，因为 Iterator 捕获了适用于大量数据结构的控制抽象。如果您对类别理论 fu 有所了解，那么您可能会对这篇论文大吃一惊：[迭代器模式的本质](http://web.comlab.ox.ac.uk/oucl/work/jeremy.gibbons/publications/iterator.pdf)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T04:06:59.117

好吧，似乎第一个要点允许多线程（或单线程，如果你搞砸了）应用程序不需要锁定集合以防止并发冲突。例如，在 .NET 中，您不能同时枚举和修改集合（或列表或任何 IEnumerable），而无需锁定或继承 IEnumerable 和覆盖方法（我们会遇到异常）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T04:12:41.690

迭代器只是添加了一种遍历项目集合的常用方法。一个不错的功能是 i.remove() ，您可以在其中从您正在迭代的列表中删除元素。如果您只是尝试正常从列表中删除项目，它会产生奇怪的效果或抛出和异常。

接口就像实现它的所有事物的合同。您基本上是在说.. 任何实现迭代器的东西都保证具有这些行为相同的方法。如果您只关心代码中处理的所有迭代器类型，您也可以使用它来传递迭代器类型。（您可能不在乎它是什么类型的列表..您只想传递一个迭代器）您可以将所有这些方法独立地放在集合中，但您不能保证它们的行为相同，或者它们甚至具有相同的名称和签名。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T04:23:16.563

迭代器是 Java 中可用的众多设计模式之一。设计模式可以被认为是方便的构建块、样式、代码/结构的使用。

要阅读有关迭代器设计模式的更多信息，请查看该网站，其中讨论了迭代器以及许多其他设计模式。这是 Iterator 网站上的一个片段：http: [//www.patterndepot.com/put/8/Behavioral.html](http://www.patterndepot.com/put/8/Behavioral.html)

> 迭代器是最简单和最常用的设计模式之一。迭代器模式允许您使用标准接口在数据列表或数据集合中移动，而无需了解该数据的内部表示的详细信息。此外，您还可以定义执行某些特殊处理并仅返回数据集合的指定元素的特殊迭代器。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T04:34:31.700

迭代器可用于任何类型的集合。它们允许您针对项目集合定义算法，而不管底层实现如何。这意味着您可以处理 List、Set、String、File、Array 等。

十年后，您可以将您的 List 实现更改为更好的实现，并且算法仍然可以无缝地运行它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T05:21:04.523

当您在 Java 中处理集合时，迭代器很有用。

使用**[For-Each](http://java.sun.com/j2se/1.5.0/docs/guide/language/foreach.html)**循环 (Java1.5) 对集合或数组或列表进行迭代。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-10-21T03:51:19.007

java.util.Iterator 接口用于 Java 集合框架中，以允许修改集合，同时仍对其进行迭代。如果您只想干净地迭代整个集合，请改用 for-each，但 Iterators 的一个优点是您可以获得的功能：可选的 remove() 操作，对于 List Iterator 接口甚至更好，它提供了 add () 和 set() 操作。这两个接口都允许您迭代集合并同时在结构上更改它。在使用 for-each 遍历集合时尝试修改集合会抛出 ConcurrentModificationException，通常是因为集合被意外修改！

看看 ArrayList 类

它内部有 2 个私有类（内部类），称为 Itr 和 ListItr

它们分别实现了 Iterator 和 ListIterator 接口

public class ArrayList..... { //封闭类

```
 private class Itr implements Iterator<E> {

        public E next() {
            return ArrayList.this.get(index++); //rough, not exact
        }

        //we have to use ArrayList.this.get() so the compiler will
        //know that we are referring to the methods in the 
        //enclosing ArrayList class

        public void remove() {
            ArrayList.this.remove(prevIndex);
        }

        //checks for...co mod of the list
        final void checkForComodification() {  //ListItr gets this method as well
             if (ArrayList.this.modCount != expectedModCount) { 
                 throw new ConcurrentModificationException();
             }
        }
  }

  private class ListItr extends Itr implements ListIterator<E> {
         //methods inherted....
        public void add(E e) {
            ArrayList.this.add(cursor, e);
        }

        public void set(E e) {
            ArrayList.this.set(cursor, e);
        }
  } 
```

}

当您调用方法 iterator() 和 listIterator() 时，它们返回私有类 Itr 或 ListItr 的新实例，并且由于这些内部类“在”封闭的 ArrayList 类中，它们可以自由修改 ArrayList 而不会触发 ConcurrentModificationException , 除非您通过 ArrayList 类的 set() add() 或 remove() 方法同时（同时）更改列表。

# c# - 找出（upcast）实例是否没有实现特定接口的最佳方法

> ID：89897
> 
> 赞同：1
> 
> 时间：2008-09-18T04:02:20.610
> 
> 标签：c#, .net, interface

也许这样做的需要是一种“设计气味”，但考虑到另一个问题，我想知道实现与此**相反**的最干净的方法是什么：

```
foreach(ISomethingable somethingableClass in collectionOfRelatedObjects)
{
  somethingableClass.DoSomething();
} 
```

即如何获取/遍历所有*未*实现特定接口的对象？

大概你需要从向上转换到最高级别开始：

```
foreach(ParentType parentType in collectionOfRelatedObjects)
{
  // TODO: iterate through everything which *doesn't* implement ISomethingable 
} 
```

通过解决 TODO 来回答：以最干净/最简单和/或最有效的方式

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T04:11:22.240

像这样的东西？

```
foreach (ParentType parentType in collectionOfRelatedObjects) {
    if (!(parentType is ISomethingable)) {
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T04:22:34.117

可能最好一路改进变量名：

```
foreach (object obj in collectionOfRelatedObjects)
{
    if (obj is ISomethingable) continue;

    //do something to/with the not-ISomethingable
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T06:16:43.763

这应该可以解决问题：

```
collectionOfRelatedObjects.Where(o => !(o is ISomethingable)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T04:23:44.317

JD OConal 是执行此操作的最佳方法，但作为旁注，您可以使用 as 关键字来强制转换对象，如果它不是该类型，它将返回 null。

所以像：

```
foreach (ParentType parentType in collectionOfRelatedObjects) {
    var obj = (parentType as ISomethingable);
    if (obj == null)  {
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T09:44:03.460

在 LINQ 扩展方法 OfType<>() 的帮助下，您可以编写：

```
using System.Linq;

...

foreach(ISomethingable s in collection.OfType<ISomethingable>())
{
  s.DoSomething();
} 
```

# ruby-on-rails - has_one :through 是如何工作的？

> ID：89908
> 
> 赞同：5
> 
> 时间：2008-09-18T04:04:19.653
> 
> 标签：ruby-on-rails, ruby, activerecord

我有三个模型：

```
class ReleaseItem < ActiveRecord::Base
  has_many :pack_release_items
  has_one :pack, :through => :pack_release_items
end

class Pack < ActiveRecord::Base
  has_many :pack_release_items
  has_many :release_items, :through=>:pack_release_items
end

class PackReleaseItem < ActiveRecord::Base
  belongs_to :pack
  belongs_to :release_item
end 
```

问题是，在执行过程中，如果我将一个包添加到 release_item 它不知道该包是一个包。例如：

```
Loading development environment (Rails 2.1.0)
>> item = ReleaseItem.new(:filename=>'MAESTRO.TXT')
=> #<ReleaseItem id: nil, filename: "MAESTRO.TXT", created_by: nil, title: nil, sauce_author: nil, sauce_group: nil, sauce_comment: nil, filedate: nil, filesize: nil, created_at: nil, updated_at: nil, content: nil>
>> pack = Pack.new(:filename=>'legion01.zip', :year=>1998)
=> #<Pack id: nil, filename: "legion01.zip", created_by: nil, filesize: nil, items: nil, year: 1998, month: nil, filedate: nil, created_at: nil, updated_at: nil>
>> item.pack = pack
=> #<Pack id: nil, filename: "legion01.zip", created_by: nil, filesize: nil, items: nil, year: 1998, month: nil, filedate: nil, created_at: nil, updated_at: nil>
>> item.pack.filename
NoMethodError: undefined method `filename' for #<Class:0x2196318>
    from /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.1.0/lib/active_record/base.rb:1667:in `method_missing_without_paginate'
    from /usr/local/lib/ruby/gems/1.8/gems/mislav-will_paginate-2.3.3/lib/will_paginate/finder.rb:164:in `method_missing'
    from /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.1.0/lib/active_record/associations/association_collection.rb:285:in `send'
    from /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.1.0/lib/active_record/associations/association_collection.rb:285:in `method_missing_without_paginate'
    from /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.1.0/lib/active_record/base.rb:1852:in `with_scope'
    from /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.1.0/lib/active_record/associations/association_proxy.rb:168:in `send'
    from /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.1.0/lib/active_record/associations/association_proxy.rb:168:in `with_scope'
    from /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.1.0/lib/active_record/associations/association_collection.rb:281:in `method_missing_without_paginate'
    from /usr/local/lib/ruby/gems/1.8/gems/mislav-will_paginate-2.3.3/lib/will_paginate/finder.rb:164:in `method_missing'
    from (irb):5
>> 
```

看来我应该可以访问 item.pack，但它不知道该包是一个包项目。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T04:25:41.847

看来您对 has_one :through 的使用是正确的。您看到的问题与保存对象有关。为了使关联起作用，被引用的对象需要有一个 id 来填充`model_id`对象的字段。在这种情况下，需要填写`PackReleaseItems`一个`pack_id`和一个字段才能使关联正常工作。`release_item_id`在通过关联访问对象之前尝试保存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T04:36:38.107

您的问题在于您如何将 和 关联`ReleaseItem`起来`Pack`。

`has_many :through`并且`has_one :through`两者都通过一个也充当连接表的对象工作，在这种情况下`PackReleaseItem`。由于这不仅仅是一个连接表（如果是，您应该只使用`has_many`without `:through`），正确创建关联需要创建连接对象，如下所示：

```
>> item.pack_release_items.create :pack => pack 
```

您对`item.pack = pack`调用所做的只是将内存中的对象关联起来。当你再去查找它时，它看起来是 " `through`" the `pack_release_items`，它是空的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T04:53:59.283

您想要保存或创建（而不是新建）项目和包装。否则，数据库没有为关联分配 id。

# python - 如何验证字符串是否仅包含字母、数字、下划线和破折号？

> ID：89909
> 
> 赞同：94
> 
> 时间：2008-09-18T04:04:58.170
> 
> 标签：python, regex, string

如果我遍历字符串中的所有字符，我知道如何做到这一点，但我正在寻找一种更优雅的方法。

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2008-09-18T04:08:19.550

正则表达式只需很少的代码就可以解决问题：

```
import re

...

if re.match("^[A-Za-z0-9_-]*$", my_little_string):
    # do something here 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-18T12:19:48.103

[编辑] 还有一个尚未提及的解决方案，在大多数情况下，它似乎优于迄今为止给出的其他解决方案。

使用 string.translate 替换字符串中的所有有效字符，看看是否还有剩余的无效字符。这非常快，因为它使用底层的 C 函数来完成工作，只涉及很少的 python 字节码。

显然，性能并不是一切——当不在性能关键代码路径中时，寻求最易读的解决方案可能是最好的方法，但只是为了看看解决方案如何叠加，这里是迄今为止提出的所有方法的性能比较。check_trans 是使用 string.translate 方法的那个。

测试代码：

```
import string, re, timeit

pat = re.compile('[\w-]*$')
pat_inv = re.compile ('[^\w-]')
allowed_chars=string.ascii_letters + string.digits + '_-'
allowed_set = set(allowed_chars)
trans_table = string.maketrans('','')

def check_set_diff(s):
    return not set(s) - allowed_set

def check_set_all(s):
    return all(x in allowed_set for x in s)

def check_set_subset(s):
    return set(s).issubset(allowed_set)

def check_re_match(s):
    return pat.match(s)

def check_re_inverse(s): # Search for non-matching character.
    return not pat_inv.search(s)

def check_trans(s):
    return not s.translate(trans_table,allowed_chars)

test_long_almost_valid='a_very_long_string_that_is_mostly_valid_except_for_last_char'*99 + '!'
test_long_valid='a_very_long_string_that_is_completely_valid_' * 99
test_short_valid='short_valid_string'
test_short_invalid='/$%$%&'
test_long_invalid='/$%$%&' * 99
test_empty=''

def main():
    funcs = sorted(f for f in globals() if f.startswith('check_'))
    tests = sorted(f for f in globals() if f.startswith('test_'))
    for test in tests:
        print "Test %-15s (length = %d):" % (test, len(globals()[test]))
        for func in funcs:
            print "  %-20s : %.3f" % (func, 
                   timeit.Timer('%s(%s)' % (func, test), 'from __main__ import pat,allowed_set,%s' % ','.join(funcs+tests)).timeit(10000))
        print

if __name__=='__main__': main() 
```

我的系统上的结果是：

```
Test test_empty      (length = 0):
  check_re_inverse     : 0.042
  check_re_match       : 0.030
  check_set_all        : 0.027
  check_set_diff       : 0.029
  check_set_subset     : 0.029
  check_trans          : 0.014

Test test_long_almost_valid (length = 5941):
  check_re_inverse     : 2.690
  check_re_match       : 3.037
  check_set_all        : 18.860
  check_set_diff       : 2.905
  check_set_subset     : 2.903
  check_trans          : 0.182

Test test_long_invalid (length = 594):
  check_re_inverse     : 0.017
  check_re_match       : 0.015
  check_set_all        : 0.044
  check_set_diff       : 0.311
  check_set_subset     : 0.308
  check_trans          : 0.034

Test test_long_valid (length = 4356):
  check_re_inverse     : 1.890
  check_re_match       : 1.010
  check_set_all        : 14.411
  check_set_diff       : 2.101
  check_set_subset     : 2.333
  check_trans          : 0.140

Test test_short_invalid (length = 6):
  check_re_inverse     : 0.017
  check_re_match       : 0.019
  check_set_all        : 0.044
  check_set_diff       : 0.032
  check_set_subset     : 0.037
  check_trans          : 0.015

Test test_short_valid (length = 18):
  check_re_inverse     : 0.125
  check_re_match       : 0.066
  check_set_all        : 0.104
  check_set_diff       : 0.051
  check_set_subset     : 0.046
  check_trans          : 0.017 
```

在大多数情况下，翻译方法似乎是最好的，对于长有效字符串来说尤其如此，但被 test_long_invalid 中的正则表达式击败（大概是因为正则表达式可以立即退出，但翻译总是必须扫描整个字符串）。设置方法通常是最差的，仅针对空字符串情况击败正则表达式。

使用 all(x in allowed_set for x in s) 如果提早退出，效果会很好，但如果必须遍历每个字符，则可能会很糟糕。isSubSet 和 set 的差异是可比较的，并且无论数据如何，都始终与字符串的长度成正比。

匹配所有有效字符和搜索无效字符的正则表达式方法之间存在类似的差异。在检查长但完全有效的字符串时，匹配性能稍好一些，但对于靠近字符串末尾的无效字符则更糟。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-09-18T04:18:40.337

有多种方法可以实现这一目标，有些方法比其他方法更清晰。对于我的每个示例，“True”表示传递的字符串是有效的，“False”表示它包含无效字符。

首先，有一种天真的方法：

```
import string
allowed = string.letters + string.digits + '_' + '-'

def check_naive(mystring):
    return all(c in allowed for c in mystring) 
```

然后是使用正则表达式，你可以用 re.match() 来做到这一点。请注意，“-”必须位于 [] 的末尾，否则它将用作“范围”分隔符。另请注意 $ 表示“字符串结尾”。此问题中提到的其他答案使用特殊字符类'\w'，我总是更喜欢使用 [] 使用明确的字符类范围，因为它更容易理解而无需查找快速参考指南，并且更容易特殊 -案子。

```
import re
CHECK_RE = re.compile('[a-zA-Z0-9_-]+$')
def check_re(mystring):
    return CHECK_RE.match(mystring) 
```

另一个解决方案指出，您可以使用正则表达式进行反向匹配，我现在已将其包含在此处。请注意， [^...] 反转字符类，因为使用了 ^：

```
CHECK_INV_RE = re.compile('[^a-zA-Z0-9_-]')
def check_inv_re(mystring):
   return not CHECK_INV_RE.search(mystring) 
```

你也可以用'set'对象做一些棘手的事情。看看这个例子，它从原始字符串中删除了所有允许的字符，给我们留下了一个集合，其中包含 a) 什么都没有，或者 b) 字符串中的违规字符：

```
def check_set(mystring):
    return not set(mystring) - set(allowed) 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-09-18T10:49:54.920

如果不是破折号和下划线，最简单的解决方案是

```
my_little_string.isalnum() 
```

（Python 库参考的第[3.6.1节）](https://docs.python.org/3/library/stdtypes.html#str.isalnum)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T10:47:49.917

作为使用正则表达式的替代方法，您可以在 Sets 中执行此操作：

```
from sets import Set

allowed_chars = Set('0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-')

if Set(my_little_sting).issubset(allowed_chars):
    # your action
    print True 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T04:12:00.273

```
 pat = re.compile ('[^\w-]')

 def onlyallowed(s):
    return not pat.search (s) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-01-22T11:05:45.503

正则表达式可以非常灵活。

```
import re;
re.fullmatch("^[\w-]+$", target_string) # fullmatch looks also workable for python 3.4 
```

`\w`： 仅有的`[a-zA-Z0-9_]`

因此，您需要添加`-`char 来对齐连字符 char。

`+`: 匹配前一个字符的一个或多个重复。我猜你不接受空白输入。但是，如果您这样做，请更改为`*`.

`^`: 匹配字符串的开头。

`$`: 匹配字符串的结尾。

您需要这两个特殊字符，因为您需要避免以下情况。像这里这样不需要的字符`&`可能会出现在匹配的模式之间。

`&&&PATTERN&&PATTERN`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-11-14T06:04:42.593

好吧，您可以寻求正则表达式的帮助，这里很棒:)

代码：

```
import re

string = 'adsfg34wrtwe4r2_()' #your string that needs to be matched.
regex = r'^[\w\d_()]*$' # you can also add a space in regex if u want to allow it in the string  
if re.match(regex,string):
    print 'yes'
else: 
    print 'false' 
```

输出：

```
yes 
```

希望这可以帮助 ：）

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-18T04:12:12.660

您始终可以使用列表推导并检查所有结果，这将比使用正则表达式占用更少的资源：`all([c in string.letters + string.digits + ["_", "-"] for c in mystring])`

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-11-30T16:50:13.597

这是基于 Jerub 的“天真方法”（天真是他的话，不是我的话！）：

```
import string
ALLOWED = frozenset(string.ascii_letters + string.digits + '_' + '-')

def check(mystring):
    return all(c in ALLOWED for c in mystring) 
```

如果`ALLOWED`是一个字符串，那么我认为`c in ALLOWED`将涉及迭代字符串中的每个字符，直到找到匹配项或到达末尾。引用 Joel Spolsky 的话，这有点像[Shlemiel the Painter 算法](http://www.joelonsoftware.com/articles/fog0000000319.html)。

但是测试集合中的存在应该更有效，或者至少更少依赖于允许的字符数。当然，这种方法在我的机器上要快一点。很明显，我认为它在大多数情况下表现得足够好（在我的慢机器上，我可以在几分之一秒内验证数以万计的短字符串）。我喜欢。

**实际上**，在我的机器上，正则表达式的运行速度要快几倍，而且就像这样简单（可以说更简单）。所以这可能是最好的前进方式。

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2008-09-18T04:06:30.113

使用正则表达式，看看它是否匹配！

```
([a-z][A-Z][0-9]\_\-)* 
```

# deployment - 我应该在什么时间构建生产？

> ID：89920
> 
> 赞同：0
> 
> 时间：2008-09-18T04:08:56.753
> 
> 标签：deployment, timing

我的用户 24/7 全天候使用该网站。是否有构建时间的模因？

国际观众，东部时间的单一服务器集群，但在早上被国际客户击中。

1个数据库，几个Web服务器，所以如果没有数据库，简单，无论何时。

但是当网站必须关闭时，作为程序员，你什么时候会看到 SO 关闭 15 分钟最不生气。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T04:11:04.783

如果从用户的角度来看确实没有好时机，那么我建议您的团队有最多时间从任何与构建相关的灾难中恢复时进行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T04:13:15.217

这是我所做的，对我来说效果很好：

1.  获取网站流量分析工具，该工具将绘制每小时用户负载图
2.  选择图表中的低点进行更新

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T04:24:38.993

如果你很小，那么是的，找出你的最低使用时间是什么时候，然后去做（对我们个人而言，通常在太平洋标准时间凌晨 1 点至凌晨 3 点左右是最低的下降......但它当然永远不会下降到 0）。一旦您开始拥有更大的用户群，如果您希望人们认真对待您，您将需要设计您的应用程序，以便您可以在不停机的情况下进行升级。这并不简单，它通常涉及拥有多个服务器。

我花了很长时间试图让我们的应用程序达到这一点，到目前为止我想出的最好的方法是几个小时同时运行旧版本和新版本。切换时登录的用户会一直使用旧版本，直到退出。下次他们进来时，他们会进入新版本。切换后进入的任何用户都会被直接发送到新版本。它仍然不是万无一失的，但它非常好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T04:11:31.023

它是一个什么样的应用程序？我使用的大多数网站都倾向于在凌晨 2 点或 3 点左右更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T04:10:34.597

使用第二个站点，并根据需要进行热插拔。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T04:12:22.923

热插拔的问题是，数据库仍然是共享的，并且重大更改也会导致停机。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T04:12:33.703

我想你得问问你的客户。

无论如何，还有凌晨。如果您谈论的是本地可用的网站，我认为用户不会介意他们在时区凌晨 2 点收到“维护中”通知。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T04:13:52.500

取决于您所在的位置：东海岸凌晨 4 点/西海岸凌晨 1 点通常是最轻的时间。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T04:20:59.910

选择几次您想要执行的操作，并将它们作为决策者类型的选择。无论您做什么，在部署时都设置一个“进行日常维护”页面。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T04:21:01.063

*   检查最少使用时间
*   克隆/复制/更新最新的生产代码到另一个目录
*   如果存在要完成的任何数据库迁移，请执行任何需要且与旧代码库不冲突的操作
*   在最少使用时，移动符号链接以指向最新代码

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T04:28:36.520

First use an analysis tool to try and determine your typically "light" traffic times. Depending on the site and your location in the world in comparison to most of your users, it could be 4am, it could be 1pm, who knows. Then, once you have a good timeframe nailed down, make sure to have your deployment process as automated as possible, so that it happens quickly to minimize the downtime of your site.

# c# - 实体框架 - 您能否将导入的存储过程的结果类型映射到自定义实体类型？

> ID：89950
> 
> 赞同：1
> 
> 时间：2008-09-18T04:13:16.510
> 
> 标签：c#, linq-to-sql, entity-framework, orm

我已经在一个单独的 dll 中有一个实体模型，其中包含我需要使用的各种对象。我真的不想使用 EF 设计器创建或复制实体。相反，我想对其进行配置，以便当我调用存储过程时，它将某些列映射到特定属性。

我知道您可以使用 LinqToSql 中的自定义 DataContext 做一些非常接近此的事情。问题是您不能将列分配给复杂的属性类型。例如：我可能会返回一个包含用户地址的列。我想将用户的地址详细信息存储在作为用户对象属性的地址对象中。所以，列 S​​TREET 应该映射到 User.Address.Street。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T13:31:30.163

这里有几个选项。

1.  您可以创建一个“复杂类型”并将其映射到过程结果。但是，您必须在 EDMX 中执行此操作；设计师不支持。阅读[这篇文章](http://msdn.microsoft.com/en-us/library/bb738472.aspx)了解详情。请注意，复杂类型*本身*不是实体类型，因此这可能符合您的需求，也可能不符合您的需求。[但是您可以找到使用 "Address"](http://msdn.microsoft.com/en-us/library/cc716733.aspx)的存储过程的示例。

2.  您可以将过程的可见性更改为私有，然后在任何手动编写的部分类文件中为它编写一个公共接口，该文件执行您想要的映射。或者只是重载程序。

# oop - 依赖注入和循环引用

> ID：89959
> 
> 赞同：3
> 
> 时间：2008-09-18T04:14:43.450
> 
> 标签：oop, tdd

我刚开始进行 DI 和单元测试，遇到了一个障碍，我相信这对于那些更有经验的开发人员来说是不费吹灰之力的：

我有一个名为 MessageManager 的类，它接收数据并将其保存到数据库中。在同一个程序集（Visual Studio 中的项目）中，我创建了一个存储库接口，其中包含访问数据库所需的所有方法。该接口的具体实现在一个名为 DataAccess 的单独程序集中。

因此 DataAccess 需要对 MessageManager 的项目引用才能了解存储库接口。而MessageManager 需要对DataAccess 的项目引用，以便MessageManager 的客户端可以注入repository 接口的具体实现。这当然是不允许的

我可以将接口移动到数据访问程序集中，但我相信存储库接口应该与使用它的客户端位于同一个程序集中

那么我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T04:21:06.867

您应该将您的界面与任一程序集分开。将接口与消费者或实现者放在一起违背了拥有接口的目的。

接口的目的是允许您注入实现该接口的任何对象，无论它是否与您的 DataAccess 对象所属的程序集相同。另一方面，您需要允许 MessageManager 使用该接口，而无需使用任何具体的实现。

把你的接口放到另一个项目中，问题就解决了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T04:20:18.617

您只有两个选择：添加一个程序集来保存接口或将接口移动到 DataAccess 程序集中。即使您正在开发一种体系结构，其中 DataAccess 类有一天可能会被存储库接口的另一个实现者（甚至在另一个程序集中）替换，也没有理由将其从 DataAccess 程序集中排除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T04:18:50.617

我认为您应该将存储库接口移至 DataAccess 程序集。这样 DataAccess 就不再需要引用 MessageManager 了。

然而，这仍然很难说，因为我对你的架构几乎一无所知......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T04:22:06.443

通常，您可以通过使用 setter 注入而不是构造函数注入来解决循环引用问题。

在伪代码中：

```
Foo f = new Foo();
Bar b = new Bar();
f.setBar(b);
b.setFoo(f); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T05:32:53.013

您是否使用了控制反转容器？如果是这样，答案很简单。

## 程序集 A 包含：

*   消息管理器
*   存储库
*   ContainerA（添加 MessageManager）

## 程序集 B 包含（和参考的程序集 A）：

*   存储库实现 IRepository
*   ContainerB 扩展 ContainerA（添加存储库）

程序集 C（或 B）将启动应用程序/询问 MessageManager 的容器，该容器将知道如何解析 MessageManager*和*IRepository。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T20:32:52.100

[依赖倒置](http://en.wikipedia.org/wiki/Dependency_inversion_principle)正在发挥作用：

*高级模块不应依赖于低级模块。两者都应该依赖于抽象。抽象不应依赖于细节。细节应该取决于抽象。*

DatAccess 程序集中的类所依赖的抽象需要位于与 DataAccess 类和该抽象的具体实现 (MessageManager) 分开的程序集中。

是的，这是更多的组件。就我个人而言，这对我来说没什么大不了的。我认为额外的组件没有很大的缺点。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T04:34:46.723

您可以保留当前拥有的结构（没有从 MessageManager 到导致问题的 DataAccess 的依赖关系），然后使用该类`MessageManager`动态加载运行时所需的具体实现。`System.Reflection.Assembly`

# .net - 如何使用 IComparable 之类的东西自然地对 DataView 进行排序

> ID：89987
> 
> 赞同：4
> 
> 时间：2008-09-18T04:22:47.830
> 
> 标签：.net, asp.net, dataview, icomparable

我的 DataView 表现得很有趣，它按字母顺序对事物进行排序，我需要它对事物进行数字排序。我已经在整个网络上查找了这个，并发现了许多关于如何使用 ICompare 对其进行排序的想法，但没有什么真正可靠的。

所以我的问题是

1.  如何在 DataView 上实现 ICompare（在此处查找代码）。
2.  如何正确地从一列充满实际字符串的字符串和一列充满数字（带逗号）的列中破译。

我需要代码来帮助我解决这个问题。我或多或少迷失了 ICompare 的想法以及如何在不同的场景中实现，所以一个好的解释会很好。

另外，请不要给我链接。我正在寻找关于这个的可靠答案。

我使用的一些代码。

```
 DataView dataView = (DataView)Session["kingdomData"];
    dataView.Sort = e.SortExpression + " " + ConvertSortDirectionToSql(e.SortDirection);
    gvAllData.DataSource = dataView;
    gvAllData.DataBind();

    private string ConvertSortDirectionToSql(SortDirection sortDirection)
{
    string newSortDirection = String.Empty;
    if (Session["SortDirection"] == null)
    {
        switch (sortDirection)
        {
            case SortDirection.Ascending:
                newSortDirection = "ASC";
                break;
            case SortDirection.Descending:
                newSortDirection = "DESC";
                break;
        }
    }
    else
    {
        newSortDirection = Session["SortDirection"].ToString();
        switch (newSortDirection)
        {
            case "ASC":
                newSortDirection = "DESC";
                break;
            case "DESC":
                newSortDirection = "ASC";
                break;
        }
    }
    Session["SortDirection"] = newSortDirection;
    return newSortDirection;
} 
```

* * *

对于该场景，我动态构建了一个数据表并将其推入一个数据视图中，在该数据视图中我将数据视图放入一个网格视图中，同时还记得将数据视图放入一个会话对象中以实现排序功能。

当用户调用 gridview 对列进行排序时，我会调用 session 对象中的 dataview 并构建 dataview 排序表达式，如下所示：

```
dataview.sort = e.sortexpression + " " + e.Sortdirection; 
```

或类似的规定。所以通常出现的结果适用于所有真实字符串，例如

车; 家; 斯科特; 扎克之类的……

但是，当我对带有逗号分隔值的数字字段执行相同操作时，它会出现类似

900; 800; 700; 600; 200; 120; 1,200；12,340；1,000,000;

明白了吗？它只是将项目排序为 alpha 排序而不是自然排序。我想让我的 Dataview 自然正确地对数字列进行排序

120; 200; 600; 700; 800; 900; 1,200；12,340；1,000,000;

让我知道你能做些什么来帮助我。
PS我浏览了无数关于如何做到这一点的文章，他们都说要塞入一个列表/数组并这样做，但是有没有更有效的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T06:26:48.687

对于第一个问题 - IIRC，您无法使用比较器对 DataView 进行排序。如果您只需要对字段进行数字排序，则必须确保列类型是数字而不是字符串。一些代码将有助于阐明这一点。

对于第二个问题，您也不能直接在 DataView 中执行此操作。如果您确实需要根据列中数据的某些处理对记录进行排序，那么我将复制数组中的数据并在数组上使用 IComparer：

```
DataView dv = new DataView(dt);
ArrayList lst = new ArrayList();
lst.AddRange(dv.Table.Rows);
lst.Sort(new MyComparer());
foreach (DataRow dr in lst)
    Debug.WriteLine(dr[0]); 
```

比较器是这样的：

```
 class MyComparer : IComparer
    {
        public int Compare(object x, object y)
        {
            DataRow rx = x as DataRow;
            DataRow ry = y as DataRow;
            string datax = (string)rx[colName];
            string datay = (string)ry[colName];
            // Process datax and datay here then compare them (ASC)
            return datax.CompareTo(datay);
        }
    } 
```

这会增加内存消耗，因此您需要考虑是否有更好的方法来预处理表中的数据，以便您可以直接按列对 DataView 进行排序。

PS colName 是您有兴趣排序的列的名称。用实际代码替换注释以从列中提取排序信息。您还可以使用此方法从更多列中提取排序信息。只需使用这样的东西：

```
int cmp = colAx.CompareTo(colAy);
if (cmp != 0)
    return cmp;
cmp = colBy.CompareTo(colBx);
return cmp; 
```

这将比较 colA 值的升序，然后 colB 值的降序（不是第二个比较首先有*y*，然后是*x*）

**编辑**：好的，我错误地解释了逗号分隔值这个术语。从您的示例中，我认为您实际上是指带有千位分隔符的数字（1,000,000 = 一百万）。如果您在数据库中存储这样的数字，那么一定是您使用的是文本字段，这应该是您的排序顺序是字母数字的原因。

基于这个假设，我建议将该列的类型更改为数字，将普通数字保留在内部并仅在显示它们时格式化它们（使用千位分隔符）。这样排序应该直接在 DataView 中工作，您不必复制数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-28T23:41:03.210

这很丑陋，但是：

```
 DataView dv = GetDataViewSomewhere();

        //Naturally sort by COLUMN_TO_SORT_ON
        try
        {
            List<string> rowList = new List<string>();
            foreach (DataRowView drv in dv)
                rowList.Add((string)drv["COLUMN_TO_SORT_ON"]);
            rowList.Sort(new NaturalComparer());
            Dictionary<string, int> sortValueHash = new Dictionary<string, int>();
            for (int i = 0; i < rowList.Count; i++)
                sortValueHash.Add(rowList[i], i);                                    

            dv.Table.Columns.Add("NATURAL_SORT_ORDER", typeof(int));
            foreach (DataRowView drv in dv)
                drv["NATURAL_SORT_ORDER"] = sortValueHash[(string)drv["COLUMN_TO_SORT_ON"]];
            dv.Sort = "NATURAL_SORT_ORDER";                
        }
        catch (Exception)
        {                
            DEBUG_TRACE("Could not naturally sort");
            dv.Sort = "COLUMN_TO_SORT_ON";
        } 
```

`NaturalComparer`这[堂课](http://www.codeproject.com/KB/string/NaturalSortComparer.aspx)在哪里。

# scripting - 是否有一个 curl/wget 选项可以防止在 http 错误的情况下保存文件？

> ID：89989
> 
> 赞同：25
> 
> 时间：2008-09-18T04:23:11.463
> 
> 标签：scripting, curl, wget

我想在脚本中下载很多 url，但我不想保存导致 HTTP 错误的那些。

据我从手册页中可以看出，既不提供`curl`也不`wget`提供此类功能。有人知道另一个下载者吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-18T04:26:38.147

我认为`-f`可以选择`curl`做你想做的事：

> `-f`,`--fail`
> 
> （HTTP）在服务器错误时静默失败（根本没有输出）。这样做主要是为了更好地使脚本等更好地处理失败的尝试。在正常情况下，当 HTTP 服务器无法传递文档时，它会返回一个 HTML 文档来说明这一点（通常还描述了原因等等）。此标志将阻止 curl 输出并返回错误 22。 [...]

但是，如果响应实际上是 301 或 302 重定向，则仍会保存，即使其目的地会导致错误：

```
$ curl -fO http://google.com/aoeu
$ cat aoeu
<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
<TITLE>301 Moved</TITLE></HEAD><BODY>
<H1>301 Moved</H1>
The document has moved
<A HREF="http://www.google.com/aoeu">here</A>.
</BODY></HTML> 
```

要跟随重定向到死胡同，还可以提供以下`-L`选项：

> `-L`,`--location`
> 
> (HTTP/HTTPS) 如果服务器报告请求的页面已移动到不同的位置（用 Location: 标头和 3XX 响应代码指示），此选项将使 curl 在新位置重做请求。[...]

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-02-24T15:19:01.897

我刚刚为此目的设置了一个班轮：

（仅适用于单个文件，可能对其他人有用）

```
A=$$; ( wget -q "http://foo.com/pipo.txt" -O $A.d && mv $A.d pipo.txt ) || (rm $A.d; echo "Removing temp file") 
```

这将尝试从远程主机下载文件。如果出现错误，则不会保留该文件。在所有其他情况下，它会被保留并重命名。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-30T15:21:57.753

古老的线程..降落在这里寻找解决方案...最终编写了一些shell代码来做到这一点。

```
if [ `curl -s -w "%{http_code}" --compress -o /tmp/something \
      http://example.com/my/url/` = "200" ]; then 
  echo "yay"; cp /tmp/something /path/to/destination/filename
fi 
```

这会将输出下载到 tmp 文件，并仅在状态为 200 时创建/覆盖输出文件。我的用例略有不同..在我的情况下，输出需要 > 10 秒才能生成......而且我不想要目的地文件在这段时间内保持空白。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-11T19:05:33.547

我有一个解决方法要提议，它确实会下载文件，但如果它的大小为 0，它也会将其删除（如果发生 404，则会发生这种情况）。

```
wget -O <filename> <url/to/file>
if [[ (du <filename> | cut -f 1) == 0 ]]; then
    rm <filename>;
fi; 
```

它适用于 zsh，但您可以将其调整为适用于其他 shell。

`-O`但是，如果您提供选项，它只会将其保存在首位

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-02T07:11:23.913

**注意：**我知道这是一个较老的问题，但我相信我已经为那些使用的人找到了`wget`比上述任何答案提供的更好的解决方案。

```
wget -q $URL 2>/dev/null 
```

当且仅当 HTTP 状态码在 200 范围内（Ok）时，才会将目标文件保存到本地目录。

此外，如果您想在遇到错误时打印错误，您可以检查[wget 退出代码](https://www.gnu.org/software/wget/manual/html_node/Exit-Status.html)中的非零值，如下所示：

```
wget -q $URL 2>/dev/null
if [ $? != 0]; then
    echo "There was an error!"
fi 
```

我希望这对那些面临与我相同的问题的人有所帮助。

**更新：** 我只是将它放入我自己的项目的更具脚本能力的形式中，并认为我会分享：

```
function dl {
    pushd . > /dev/null
    cd $(dirname $1)
    wget -q $BASE_URL/$1 2> /dev/null
    if [ $? != 0 ]; then
        echo ">> ERROR could not download file \"$1\"" 1>&2
        exit 1
    fi
    popd > /dev/null
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-19T13:59:16.113

作为替代方案，您可以创建一个时间旋转文件：

```
wget http://example.net/myfile.json -O myfile.json.tmp -t 3 -q && mv list.json.tmp list.json 
```

前面的命令将始终下载文件“myfile.json.tmp”，但只有当 wget 退出状态等于 0 时，文件才会旋转为“myfile.json”。

此解决方案将防止在[发生网络故障时](https://www.gnu.org/software/wget/manual/html_node/Exit-Status.html)覆盖最终文件。

这种方法的优点是，如果出现问题，您可以检查临时文件并查看返回的错误消息。

“-t”参数会尝试多次下载文件以防出错。

“-q”是安静模式，与 cron 一起使用很重要，因为 cron 将报告 wget 的任何输出。

“-O”是输出文件的路径和名称。

请记住，对于 Cron 计划，始终为所有文件提供完整路径非常重要，在这种情况下，对于它自身的“wget”程序也是如此。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2011-11-21T21:20:54.710

您可以下载文件而不使用`"-O -"`选项保存为

```
wget -O - http://jagor.srce.hr/ 
```

[您可以在http://www.gnu.org/software/wget/manual/wget.html#Advanced-Usage](http://www.gnu.org/software/wget/manual/wget.html#Advanced-Usage)获得更多信息

# visual-studio-2008 - 如何编译不需要外部清单文件的 DLL？

> ID：89994
> 
> 赞同：1
> 
> 时间：2008-09-18T04:24:24.033
> 
> 标签：visual-studio-2008

我想在 Visual Studio 2008 下编译一个依赖于 msvcr90.dll 作为私有程序集的 DLL（基本上我会将此 DLL 转储到与我的应用程序相同的目录中），而不需要外部清单文件。

我按照[http://msdn.microsoft.com/en-us/library/ms235291.aspx](http://msdn.microsoft.com/en-us/library/ms235291.aspx) 部分**“将 Visual C++ 库 DLL 部署为私有程序集”**中概述的步骤操作，而不是使用外部清单文件（即 Microsoft.VC90\. CRT.manifest) 我想以某种方式将它嵌入到 DLL 中。

如果我将 Microsoft.VC90.CRT.manifest 嵌入到 msvcr90.dll 或加载它的 DLL 中，并删除外部清单文件，则 LoadLibrary() 失败。

问题是当您将清单嵌入到 DLL 中时，它实际上嵌入了以下内容：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1"
manifestVersion="1.0">
  <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
    <security>
      <requestedPrivileges>
        <requestedExecutionLevel level="asInvoker" uiAccess="false">
      </requestedPrivileges>
    </security>
  </trustInfo>
  <dependency>
    <dependentAssembly>
      <assemblyIdentity type="win32" name="Microsoft.VC90.DebugCRT" version="9.0.21022.8" processorArchitecture="x86" publicKeyToken="1fc8b3b9a1e18e3b">
    </dependentAssembly>
  </dependency>
</assembly>
```

如果清单文件丢失，我认为 <dependentAssembly> 行是导致它死亡的原因。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T06:36:22.720

将以下内容添加到预处理器定义中：

```
_CRT_NOFORCE_MANIFEST 
````****************