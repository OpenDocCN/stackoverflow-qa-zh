# StackOverflow 问答 10660000-10660999

# extjs - IE 错误与 rallyGrid

> ID：10660000
> 
> 赞同：3
> 
> 时间：2012-05-18T21:31:27.320
> 
> 标签：extjs, rally

使用拉力赛自定义网格的 SDK2.0 应用程序出现错误：

它只会在 IE（当前）中出错，如果我在本地运行它不会出错，只有当我将它安装在 Rally 中并运行它时。

我不知道是 Rally 问题还是 EXTJS 问题。

SCRIPT5007：无法获取属性“modelField”的值：对象为 null 或未定义 sdk.js，第 4 行字符 1276692

失败的代码：

```
if(e.modelField&&e.modelField.hidden) 
```

围绕该错误的上下文：

```
{xtype:"rallytextfield",allowBlank:false,removeNameAttribute:true}}},PortfolioItem:function(){return{hidden:true}},AttributeType:function(b){return a.apply(Rally.ui.grid.FieldColumnFactory.defaultRenderer(b),{sortable:false})}})})();(function(){var a=window.Ext4||window.Ext;var b=function(g,e){var d=g.text;var c=e.text;if(d>c){return 1}if(d<c){return -1}return 0};a.define("Rally.ui.grid.ColumnBuilder",{requires:["Ext.Array","Ext.util.Format","Rally.ui.grid.FieldColumnFactory"],constructor:function(){this.defaultColumns=[];this.autoAddAllModelFieldsAsColumns=true},withDefaultColumns:function(c){if(a.isArray(c)){this.defaultColumns=this.defaultColumns.concat(c)}return this},withSortableColumns:function(c){this.sortable=c;return this},shouldAutoAddAllModelFieldsAsColumns:function(c){this.autoAddAllModelFieldsAsColumns=c;return this},build:function(d){var e=a.Array.map(this.defaultColumns,function(g){if(a.isString(g)){return Rally.ui.grid.FieldColumnFactory.getColumnConfigFromField(d.getField(g),this.sortable)}return g},this);if(this.autoAddAllModelFieldsAsColumns){var c=this._buildModelColumns(d,this.defaultColumns,e);e=e.concat(c)}this._removeHiddenColumns(e);return this._stripTagsFromColumnText(e)},_removeHiddenColumns:function(d){for(var c=d.length-1;c>0;c--){var e=d[c];if(e.modelField&&e.modelField.hidden){a.Array.erase(d,c,1)}}} 
```

不确定我可以提供哪些其他指导来帮助找到此问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T23:51:06.230

代码有点大，所以在发布之前我开始做一些分而治之的工作，我在代码中找到了原因，尽管可能不是根本原因：

在我的 columnCfgs 添加拉力网格时，我在最后一个条目上有一个尾随的“，”。

真正令人讨厌的是这在本地的所有浏览器中都有效，但仅在 IE 上在 Rally 上失败并出现一个超级模糊的错误，所以它真的很难追下去......甚至我的 JavaScript 语法荧光笔也没有警告我......

我怀疑这实际上是 Rally 或 EXT-JS 代码中的一个问题，其中 IE 真的很挑剔......

# sql - 使用 SQL 比较两个字符串

> ID：10660003
> 
> 赞同：0
> 
> 时间：2012-05-18T21:31:45.940
> 
> 标签：sql, ms-access, ms-access-2010

我有以下命令，在使用 OleDb 连接到 Access 2010 数据库的 C# WinForms 应用程序中使用：

```
oc_payslips = new OleDbCommand("SELECT <fields> FROM Payslips WHERE LicenseID = \"" + IDs[cb_Employees.SelectedIndex] + "\" AND DateOfPayment >= \"" + startDate + "\" AND DateOfPayment <= \"" + endDate + "\"", DB_Connection.con); 
```

这行不通。我最好的猜测是我无法使用 SQL 比较两个字符串。

这个想法是获取在两个日期之间具有日期的记录，所有这些记录都具有“dd/MM/yyyy”格式。日期作为字符串存储在数据库中。

我在互联网上找不到这个问题的答案，所以这是我的问题：

**有没有办法使用 SQL 比较两个字符串并确定哪个是字母顺序？**

PS：我知道我可以先获取所有日期，比较它们，然后搜索具有正确日期的 ID，但我的问题与在单个 SQL 查询中执行此操作有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:09:53.220

你有几个问题

*   您应该使用参数化命令而不是使用字符串连接。

*   您在 SQL 中使用双引号而不是单引号作为字符串分隔符。

*   您正在将日期作为字符串进行比较。如果表字段的类型为`Date/Time`，则必须使用日期文字（如果您坚持使用字符串连接）。如果日期存储为格式为“dd/MM/yyyy”的字符串，则比较将不起作用。

*   与`LicenseID`. 如果是数字类型，`LicenseID = 123`则不比较`LicenseID = "123"`。

如果您使用参数化查询，最后三个问题会自动消失。

请参阅：[如何：](http://msdn.microsoft.com/en-us/library/bb738521.aspx)在 MSDN 上执行参数化查询。

* * *

```
oc_payslips = new OleDbCommand(
    @"SELECT <fields> FROM Payslips
      WHERE LicenseID = @lid AND
      DateOfPayment >= @start AND DateOfPayment <= @end", DB_Connection.con); 

oc_payslips.Parameters.AddWithValue("@lid", IDs[cb_Employees.SelectedIndex]);
oc_payslips.Parameters.AddWithValue("@start", startDate);
oc_payslips.Parameters.AddWithValue("@end", endDate);
... 
```

* * *

将日期作为字符串存储在数据库中是一个坏主意。如果您想比较存储为字符串的日期，则仅当字符串格式为“yyyy/MM/dd”时才有效，正如 Vlad Schnakovszki 在他的评论中指出的那样。但是，您可以尝试使用

```
"... CDate(DateOfPayment) BETWEEN @start AND @end" 
```

并确保您传递 type 的参数`DateTime`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T21:37:06.087

[http://www.tutorialspoint.com/sql/sql-string-functions.htm#function_strcmp](http://www.tutorialspoint.com/sql/sql-string-functions.htm#function_strcmp)

afaik if it returns -1 than the first string would be before the second using english alphabet

# c# - EF Code First - 来自数据库的对象为空

> ID：10660008
> 
> 赞同：2
> 
> 时间：2012-05-18T21:32:49.573
> 
> 标签：c#, asp.net-mvc-3, entity-framework, ef-code-first, fluent-interface

尝试使用 EF Code First 将对象从数据库中取出时遇到一些问题。我使用的程序是 Visual Studio 2010，项目类型是 ASP.NET MVC3 项目。

现在，问题是关联对象始终为空，尽管 FK 在数据库中已正确配置。

具体场景：一个用户有一个团队（可选），一个团队有它的用户（Users.Count 可以为零）。现在，当使用某个用户登录 webapp 时，应该可以显示该团队中的其他用户。问题是登录用户的 Team 对象为空。我找到了在用户中使用外键（int？teamId）并使用此外键分配适当团队的解决方法。但是，我的问题应该在不使用这种方法的情况下得到解决。我的代码：

```
public class Team
    {
    [Key]
    public int Id { get; set; }
    [MaxLength(100)]
    public string Name { get; set; }
    public virtual ICollection<User> UsersInTeam { get; set; }

    public Team()
    {
        UsersInTeam = new List<User>();
    }

    public void AddUser(User user)
    {
        if(UsersInTeam.Contains(user))
            throw new ArgumentException(String.Format("Cannot add {0} to {1} because the user is already assigned to that team", user.Name, Name));

        user.Team = this;
        UsersInTeam.Add(user);
    }

 public class User
 {
    public int Id { get; set; }
    [Required, MaxLength(100)]
    public string Email { get; set; }
    [Required, MaxLength(100)]
    public string Password { get; set; }
    [Required, MaxLength(100)]
    public string Name { get; set; }
    [Required, MaxLength(100)]
    public string FirstName { get; set; }
    public string Mobile { get; set; }
    public bool IsAdminstrator { get; set; }
    public virtual Team Team { get; set; }

    public User()
    {
        Team = new Team();
    }
} 
```

现在进行映射：

```
modelBuilder.Entity<Team>().HasMany(t => t.UsersInTeam).WithOptional(u => u.Team).Map(m => m.MapKey("TeamId")).WillCascadeOnDelete(false);
modelBuilder.Entity<User>().HasOptional(u => u.Team).WithMany(u => u.UsersInTeam).Map(m => m.MapKey("TeamId")).WillCascadeOnDelete(false); 
```

所以登录后，我有一个用户对象，其中包含来自数据库的所有正确属性，除了 user.Team 为空。在数据库中，用户表应该有一个外键列 TeamId，并且用户有相应的 teamId，但 Team 始终为空。

如果有人可以看一下，我将不胜感激，因为由于这个问题，我感到非常沮丧。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:25:52.990

使用`.Include`你正在做*急切的加载*。您还可以在查询后执行此操作来进行*显式加载*：

```
var User = context.Users.Find(id); // Load the User.
context.Entry(User)
    .Reference(u => u.Team)
    .Load(); 
```

您还可以：

```
var Team = context.Teams.Find(id);
context.Entry(Team)
    .Collection(t => t.Users)
    .Load(); 
```

相关条目已加载！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:08:31.890

在您的查询中包括团队

```
Users.Include(e => e.Team) 
```

# content-management-system - 通用 CMS 系统 - 它存在吗？

> ID：10660010
> 
> 赞同：1
> 
> 时间：2012-05-18T21:33:00.970
> 
> 标签：content-management-system, builder

我正在寻找以下内容...有人可以指出该领域目前存在的任何内容吗？尽量不重新发明轮子。

基本上是一个 CMS 系统，我可以通过界面设置表单类型。

基本上说这种类型的数据有一个名为“名称”的文本字段、一个名为“开始日期”的日期字段和一个名为“所有者”的电子邮件字段。这一起是一个名为“项目”的节点类型

然后数据输入人员可以去填写多个项目，并可能将它们保存到不同的类别中。

然后我可以将结果导出为 XML 或 JSON。

那是愿望清单……这样的东西存在吗？还是我必须重新编程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T08:02:51.127

您当然可以看一下开源[Hippo CMS](http://www.onehippo.org) - 它允许您几乎按照您所描述的方式创建自己的内容类型（免责声明：我是该公司的 CTO）。

Hippo CMS 中的“文档类型”既是类型定义（哪些节点去哪里，它们被称为什么，它们是什么类型），也是输入内容的表单。表单由不同的编辑字段组成，有日期、字符串、HTML 字段等可用的字段。如果您需要一种非常特定的字段，那么您可以创建自己的字段并将其作为插件添加到安装中。

Hippo 基于 Java 内容存储库规范 (JCR)，它以分层结构处理节点。如果您正在寻找 Java 解决方案 - 那么这可能就是您所需要的。但是从您所写的内容来看，我认为您甚至不需要深入研究 Java 内部结构。您可以使用控制台 Web 界面中的 XML 导出来获取内容，或者添加一个 REST API，将内容公开为 XML 或 JSON。为此，您需要更深入一点。有关这方面的更多信息，请访问社区网站。

随意尝试在线[演示安装](http://www.onehippo.com/try)。在您作为“管理员”用户之一登录后，导航到“浏览”透视图并打开“配置”手风琴（它一直在屏幕底部，就在“分类法”的正上方）。您可以在此处使用文档类型。

# android - 在phonegap，html5中加载外部页面时显示“正在加载”文本/图标

> ID：10660012
> 
> 赞同：1
> 
> 时间：2012-05-18T21:33:12.453
> 
> 标签：android, html, jquery-mobile, cordova, same-origin-policy

在 phonegap-android 应用程序中，我想在应用程序中打开一个外部链接。

为此，我使用了一个插件[childBrowser](https://github.com/phonegap/phonegap-plugins/tree/master/Android)，它工作正常。

但是外部链接需要时间来加载，我想***显示等待/加载消息。***

我还尝试通过ajax-call打开外部链接，用响应页面更新div。直到没有收到响应，我才显示*加载消息*，但这种方法的问题是页面丢失了它的样式和其他结构。

我想这是因为我将整个外部页面放在 div 标记内，它不能像浏览器那样呈现整个页面。

代码片段看起来像 -

```
<script type="text/javascript">
function loadPage(url) {
var xmlhttp = new XMLHttpRequest();

// Callback function when XMLHttpRequest is ready
xmlhttp.onreadystatechange=function(){
    if (xmlhttp.readyState === 4){
        if (xmlhttp.status === 200) {
            document.getElementById('container').innerHTML = xmlhttp.responseText;
        }
    }
};
xmlhttp.open("GET", url , true);
xmlhttp.send();
}
</script> 
```

我怎样才能做到这一点，我可以覆盖 childBrowser 吗？

还

如果我想在应用程序的 Web 视图中打开页面，那么我如何才能为 Web 视图实现相同的功能。

**编辑**：*根据[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，不能使用 xhr 请求调用外部域。好的明白了。我在浏览器中检查并得到了预期的错误：“XMLHttpRequest 无法加载”*

***但是，它如何在移动设备中显示/打开 url？***

当然，该页面功能不全，这是我最初的问题。

我会将其作为一个单独的问题发布，但它与我原来的问题有关

谢谢。

任何提示/建议都会很棒。

# xml - CDATA 的替代品

> ID：10660023
> 
> 赞同：0
> 
> 时间：2012-05-18T21:34:38.317
> 
> 标签：xml, xsd, dtd, cdata

我有一个大型 XML 文件，其中每个节点都需要一个 CDATA 标记。

```
<root>
    <a>
        <id>my_id</id>
        <tr><![CDATA[This is the data]]></tr>
    </a>
    <b>
        ...
    </b>
</root> 
```

如何避免在每个节点中放置 CDATA？**DTD**或**Schema**是否为此提供了方法？

此要求的原因来自用于本地化目的的内部框架。所有包含消息的标签都将被 CDATA，因为它们通常包含特殊字符。我编写的 XML 仅用于演示目的，并不代表我处理的实际数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:38:11.757

`CDATA`与节点的内容有关，而模式信息与文档的结构有关。它们并不是特别相关。

查看您的文档，不需要该`CDATA`元素存在。它仅用于在内容中有尖括号和其他特殊字符时简化内容的解析/写入。

需要实际的`CDATA`语法来指示一个`CDATA`部分，因为它的意图是支持否则会被解释为 XML 的字符。完整的语法可以消除什么是内容和什么是标签的歧义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T19:25:00.220

> 如何避免在每个节点中放置 CDATA？DTD 或 Schema 是否为此提供了方法？

不... DTD 或 Schema 对您的问题没有帮助。

> 此要求的原因来自内部框架

嗯......当然，解析文档的 XML 解析器知道该部分是否是 CDATA 部分。这也在 DOM 中通过区分[接口 CDATASection](http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-667469212)和[接口 Text](http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1312295772)来表示。因此，对于编写 XML 解析器的人来说，强制使用 CDATA 部分而不只是纯文本部分是非常容易的。在 99.9% 的情况下，这完全是愚蠢的，你不应该检查它。但另一方面，我在生活中看到了很多愚蠢的事情，如果您的内部框架这样做并强制 CDATA 部分的存在，我一点也不感到惊讶。

如果是这种情况（试一试），那么您必须编写 CDATA 部分并对此感到满意。如果您对此不满意，您可以编写一个脚本来转换您的 XML 添加这些 CDATA 部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T21:24:52.820

> 所有包含消息的标签都将被 CDATA，因为它们通常包含特殊字符

如果您的真正目标是在 XML 文档中表示特殊字符，那么问题不在于这些字符的**解析**，而在于它们的**编码**。

数据中心

```
<![CDATA[ your data ]]> 
```

主要处理（XML）文档的某些内容不必解析这一事实，否则可能会发现一些错误。例如：

```
 <a>
            <id>my_id</id>
            <tr>& content a </tr>
            <tr> < content b < </tr>
   </a> 
```

随着文档被解析，它的内容（即带有标签的文本）也被解析。两种内容

> & 内容

和

> <内容b <

由于字符“&”和“<”，将被视为解析错误。为了避免它，您不希望解析某些内容。这就是您在标签中声明的原因，以便告诉解析器不要解析它们。

DTD 和 XSD 都是关于为您的 XML 文档定义一个结构，并且没有明确地提供一种对您的字符进行编码的方法（只有 XSD 这样做，而是针对二进制数据元素类型）。它们帮助您定义将使用您的 XML 文档的元素类型（String、Int、Double 等），但将编码问题留给您。

这显然是一个*编码问题*，而不是解析问题。

# solr - 文档索引和解析的好工具？

> ID：10660024
> 
> 赞同：0
> 
> 时间：2012-05-18T21:34:45.417
> 
> 标签：solr, lucene, indexing, full-text-search, documents

我想知道什么是用于索引文档（pdf、xml、web 文档）等的好工具。我希望能够索引它们、解析它们并适当地返回结果。

我尝试了 solr/lucene，但我一定错过了一些东西，因为我发现它不够有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:36:42.197

Solr 是您想要的...... ElasticSearch 是一种选择。

# uiview - Setting a view alpha

> ID：10660025
> 
> 赞同：0
> 
> 时间：2012-05-18T21:34:50.630
> 
> 标签：uiview, uiimageview, alpha

I have view1 which is an `UIImageView` and I also have view2 which is a subview of view1 and is a `UIImageView` too.

I want to move view2 around and I would like it to have alpha=0 where view1 (his superview) has `alpha!=1`, is that possible? how can I do that?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T18:48:36.343

可以通过不同的方式移动/拖动 view2。

使用 UItouch 代理来做这件事.. touchesBegan, touchesMoved,touchesEnded,touchesCancelled 等等..

您可以通过 2 种不同的方式进行操作。

1.创建一个继承自 UiView 的子类，命名为 view2 并实现上述触摸委托并创建其 obj 并添加为 view1 的子视图。然后您可以在 view2 中发生触摸时使触摸委托工作。

在 touchesBegan,touchesMoved 代表中，为拖动操作进行编码。

2.在主视图touchesBegan，touchesMoved委托中，检查触摸点是否与view2框架相交。如果是，请执行 view2 拖动的代码

对于拖放，请参阅以下链接

[拖动uiview-uiviews之间](https://stackoverflow.com/questions/3842447/drag-uiview-between-uiviews)

[如何拖放图像](http://iphoneapplicationdevelopers.blogspot.in/2011/03/iphone-how-to-drag-and-drop-images-in.html)

[MoveMe：苹果开发者](http://developer.apple.com/library/ios/#samplecode/MoveMe/introduction/Intro.html)

对于 setAlpha，您可以根据您的条件使用 UIView 方法 yourUiView.setAlpha = 1.0 或 yourUiView.setAlpha = 0.0

# tridion - 在模板生成器中将 SiteEdit 与页面模板一起使用时出现异常

> ID：10660026
> 
> 赞同：1
> 
> 时间：2012-05-18T21:34:56.907
> 
> 标签：tridion

我正在尝试在我们的 Tridion 2011 SP1 上启用 SiteEdit。

我已经安装并配置了 SiteEdit。

我尝试按照以下步骤通过模板生成器为页面添加 SiteEdit，并得到以下异常。

1.  创建了一个包含两个组件的页面
2.  在页面模板中，我在 Dreamweaver 模板下方添加了“启用 SiteEdit 2009”TBB
3.  在参数架构字段的参数 TargetTypeURI 中添加了目标类型 URI。
4.  执行时抛出以下异常。

> 调试已在进程“TcmTemplateDebugHost”中启动，ID 为 2464 无效的项目类型。需要页面模板、组件模板或模板构建块。在 Tridion.ContentManager.Templating.Engine.GetTemplate(TcmUri templateURI) 在 Tridion.ContentManager.Templating.Assembly.CSharpSourceCodeMediator.RunTemplate(Engine engine, Package package, String templateUri, String className) 在 Tridion.Templating.CSharpTemplate.CSharpSourceTemplate.Transform(在 Tridion.ContentManager.Templating.Assembly.CSharpSourceCodeMediator.Transform（引擎引擎，模板模板，包包）在 Tridion.ContentManager.Templating.Engine.ExecuteTemplate（模板模板，包包）在 Tridion.ContentManager 的引擎 __engine，包 __package）。 Templating.Engine.InvokeTemplate(封装包，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-19T00:43:13.460

[此处](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SiteEdit_2009_SP3/task_InstSETBB85D8DE69746A49BDBD57742DB2FF46FC)记录了安装模板构建块的步骤。看起来您在上传程序集时的第 2 步或安装时的第 7 步中犯了一个错误`Enable SiteEdit 2009.tbbcs`。

## 为启用 SiteEdit 2009 创建 C# 片段

在这 7 步中，您必须将此代码粘贴到新的 C# TBB 中：

```
<%RunTemplate Template="tcm:0-0-0"
        Class="Tridion.ContentManager.Templating.Templates.EnableSiteEdit"%> 
```

然后将`Template`属性的值更改为与您在步骤 2 中创建的程序集的 TCM URI 匹配。所以它看起来像：

```
<%RunTemplate Template="tcm:1-479-2048"
        Class="Tridion.ContentManager.Templating.Templates.EnableSiteEdit"%> 
```

前两个数字（上面的 1 和 479）在您的系统上很可能会有所不同。但最后一个数字将始终是 2048。看起来您可能弄错了 URI，并且它以`-2464`.

将您的程序集 TBB 的 TCM URI 与属性中的 TCM URI 仔细检查`Template`并确保它们匹配。

## Upload the Assembly

If you find yourself stuck figuring out `TcmUploadAssembly`, you can also choose to create upload the DLL into Tridion from the web GUI. Simply create a new TBB, set the language to Assembly and choose `Load from disk`.

# c# - 如何将日期时间插入时间（0）字段

> ID：10660027
> 
> 赞同：2
> 
> 时间：2012-05-18T21:34:59.190
> 
> 标签：c#, sql, sql-server, sql-server-2008

我正在做一个批量插入：

```
// Get the data into the DataTable
//dtData = GetData(...);

// Create an object of SqlBulkCopy
SqlBulkCopy objSBC = new SqlBulkCopy(connection);
// Specify the destination table
objSBC.BulkCopyTimeout = 0;
objSBC.BatchSize = 10000;
objSBC.DestinationTableName = "QuickLabDump";
// Write the data to the SQL Server

objSBC.WriteToServer(QuickLabDump); 
```

我插入的数据表如下所示：

```
QuickLabDump = new DataTable();

QuickLabDump.Columns.Add("Time Collected", typeof(TimeSpan));
QuickLabDump.Columns.Add("Time Entered", typeof(TimeSpan));
QuickLabDump.Columns.Add("Time Completed", typeof(TimeSpan));
QuickLabDump.Columns.Add("Test Time", typeof(TimeSpan));

QuickLabDump.Columns.Add("Date Collected", typeof(DateTime));
QuickLabDump.Columns.Add("Date Entered", typeof(DateTime));
QuickLabDump.Columns.Add("Date Completed", typeof(DateTime));
QuickLabDump.Columns.Add("Test Date", typeof(DateTime));
...... 
```

当我从 c#（上面的代码）运行批量插入时，我收到以下错误：

```
The given value of type DateTime from the data source cannot be converted to type time of the specified target column. 
```

我认为问题在于我正在插入`typeof(DateTime)`一个 sql server 2008 表`time(0)`

这是我插入的数据示例：

```
6:50:00 AM
6:50:00 AM
6:50:00 AM
10:36:00 AM
4:45:00 PM
7:39:00 PM 
```

**问题：如何正确定义数据表列，以便将上述时间值插入`time(0)`列中？**

以下是数据库表中 time(0) 字段中已存在的值：

```
14:57:00
14:58:00
14:58:00
14:57:00
10:49:00
13:31:00
14:02:00
14:13:00
14:20:00
14:56:00
15:00:00 
```

这就是我将数据添加到`DataTable`：

```
 public DataTable dt;
        public ReadFileIntoDataTable(string inputfile)
        {
            using (GenericParserAdapter parser = new GenericParserAdapter())
            {
                parser.SetDataSource(inputfile);

                char[] delimiters = new char[] { ',' };
                parser.ColumnDelimiter = delimiters[0];
                parser.FirstRowHasHeader = true;
                //parser.SkipDataRows = 10;
                parser.MaxBufferSize = 4096;
                //parser.MaxRows = 500;
                parser.TextQualifier = '\"';

                dt = parser.GetDataTable();   

            } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T21:52:27.443

使用`TimeSpan`而不是`DateTime`. 您可以`TimeSpan` *从*`DateTime`using中获得a [`DateTime.TimeOfDay`](http://msdn.microsoft.com/en-us/library/system.datetime.timeofday.aspx)。

有关更多类型映射信息，请参阅[MSDN 上的 SQL Server 数据类型映射页面。](http://msdn.microsoft.com/en-us/library/cc716729.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T04:02:33.103

我在我的数据表和 sql server 表之间创建了明确的列映射：

```
objSBC.ColumnMappings.Add(new SqlBulkCopyColumnMapping("datatable column name","sql server column name")); 
```

对于所有列......这就是诀窍！

# rdf - 如何编写有效匹配字符串文字同时忽略大小写的 SPARQL 查询

> ID：10660030
> 
> 赞同：16
> 
> 时间：2012-05-18T21:35:36.257
> 
> 标签：rdf, sparql, jena, arq, tdb

我正在使用 Jena ARQ 针对从 Jena TDB 读取的大型本体编写 SPARQL 查询，以便根据 rdfs 标签查找与概念关联的类型：

```
SELECT DISTINCT ?type WHERE {
 ?x <http://www.w3.org/2000/01/rdf-schema#label> "aspirin" .
 ?x <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?type .
} 
```

这工作得很好，实际上非常快（<1 秒）。不幸的是，对于某些术语，我需要以不区分大小写的方式执行此查询。例如，因为标签`"Tylenol"`在本体中，但不是`"tylenol"`，所以以下查询为空：

```
SELECT DISTINCT ?type WHERE {
 ?x <http://www.w3.org/2000/01/rdf-schema#label> "tylenol" .
 ?x <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?type .
} 
```

我可以使用 FILTER 语法编写此查询的不区分大小写版本，如下所示：

```
SELECT DISTINCT ?type WHERE {
 ?x <http://www.w3.org/2000/01/rdf-schema#label> ?term .
 ?x <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?type .
 FILTER ( regex (str(?term), "tylenol", "i") )
} 
```

但是现在查询需要一分钟才能完成！有没有办法以更有效的方式编写不区分大小写的查询？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-19T00:35:33.123

在您可以在 SPARQL 中使用的所有可能的字符串运算符中，`regex`可能是最昂贵的一个。如果您避免`regex`使用`UCASE`or`LCASE`在测试的两侧代替，您的查询可能会运行得更快。就像是：

```
SELECT DISTINCT ?type WHERE {
 ?x <http://www.w3.org/2000/01/rdf-schema#label> ?term .
 ?x <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?type .
 FILTER (lcase(str(?term)) = "tylenol")
} 
```

这可能会更快，但通常不要期望任何三重存储的文本搜索性能都很好。三重存储非常擅长图匹配，但不太擅长字符串匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T20:44:37.203

使用 FILTER 查询的查询运行速度较慢的原因是 ?term 未绑定，它需要扫描 PSO 或 POS 索引以查找所有带有 rdfs:label 谓词的语句并根据正则表达式过滤它们。当它绑定到具体资源（在您的第一个示例中）时，它可以使用 OPS 或 POS 索引仅扫描具有 rdfs:label 谓词和指定对象资源的语句，这将具有低得多的基数。

此类文本搜索问题的常见解决方案是使用外部文本索引。在这种情况下，Jena 提供了一个名为[LARQ](http://jena.apache.org/documentation/larq/ "LARQ")的自由文本索引，它使用 Lucene 执行搜索并将结果与​​查询的其余部分连接起来。

# vba - 如何修剪或拆分 VBA 字中的变量名

> ID：10660043
> 
> 赞同：1
> 
> 时间：2012-05-18T21:37:00.560
> 
> 标签：vba, trim, ms-word

我有一个这样的变量：

```
var = "word1 (should be replaced by word1)" 
```

我需要自己获取 word1，有时它可能是一个词，但它后面总是有 (*)。有什么方法可以删除 () 符号之间的文本，然后删除 ()，然后删除最后一个单词后的任何空格？

不确定有什么方法可以解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:39:36.707

像这样？

```
Sub Sample()
    Dim sVar As String
    Dim MyAr() As String

    sVar = "word1 (should be replaced by word1)"

    MyAr = Split(sVar, "(")

    Debug.Print MyAr(0)
End Sub 
```

**编辑**

上面的代码可以进一步缩短

```
Sub Sample()
    Dim sVar As String
    sVar = "word1 (should be replaced by word1)"
    Debug.Print Split(sVar, "(")(0)
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T21:40:36.210

最简单的是：

```
var = Trim(Mid(var, 1, InStr(var, "(") - 1)) 
```

`InStr`返回“（”的第一次出现的索引。我减去 1 以折扣“（”所持有的位置。

`Mid`将字符串从位置 1 的第一个字符剪切到`InStr`.

然后`Trim`删除尾随空格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T21:49:09.957

我会使用 SPLIT 功能。

```
arrayVar2 = split(var, "(" ) 
```

您现在将拥有一个包含 2 个元素的数组。

拆分第二个元素

```
arrayVar3 = split( arrayVar2[1], ")" ) 
```

然后加入：

```
out = arrayVar2[0] & arrayVar3[1] 
```

只要字符串中只有一组括号，这将起作用。

另一种方法是使用正则表达式库，但这是一个更长的答案。它不会那么有效，但如果需要处理更复杂的字符串会更好。

* * *

更新：我比可能要求的问题更进一步。我的解决方案确保括号中的文本被删除 - 括号中的文本之后的任何文本也被保留。

# git - 具有不同位置文件夹的 git 存储库

> ID：10660048
> 
> 赞同：1
> 
> 时间：2012-05-18T21:37:36.990
> 
> 标签：git

所以我有一个包含三个文件夹的 git 存储库。这对我的本地 Web 服务器来说很好。但是，在实时服务器上，其中两个文件夹需要在 webroot 后面，其中一个需要*在*webroot 中。我想在服务器上使用 git repo 以便于推/拉，但文件夹需要放在不同的地方。

有人对此有解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:59:21.660

你基本上有两个选择。您可以设置网络服务器，以便您想要的一个目录位于 webroot 中（通过符号链接并允许遵循符号链接，或通过适当地设置文档根目录）或让一些外部进程复制它们。

对于后者，你可以有一个简单的复制 cron 作业，或者一个稍微复杂的 git commit 钩子来完成复制。如果你使用类似的东西`rsync`，你只会复制实际上已经改变的东西。您当然可以进一步采用这种方法，并拥有一个完整的持续集成系统，该系统在运行测试后将文件复制到正确的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T21:59:06.670

因为每个 Git 存储库都需要是数据的完整副本，所以您需要构建存储库，以便在将其克隆到磁盘上时，文件夹从一开始就位于正确的位置。

如果您想要更大的灵活性（例如部分/深度签出），那么 Subversion 实际上更适合。

我还赞同 topek 的建议，以确保您的开发/测试设置与生产相匹配。

# asp.net - implementing ASP strategy in ASP.NET

> ID：10660050
> 
> 赞同：0
> 
> 时间：2012-05-18T21:37:39.447
> 
> 标签：asp.net

I've built several database driven web sites with ASP and I'm trying to migrate the basic functionality to an ASP.NET architecture.

I want to have each link in my navigation tree correspond to a different function that will step a user through various requests and provide sequential database driven responses and possible follow-up questions. I typically do this in ASP by using the query string to execute different parts of the code in an SSI file. Each link in my navigation tree basically calls a different SSI file.

In ASP.NET I think I have a pretty good handle on web form basics, data binding, site navigation tools and master pages, but I'm having trouble with the overall design picture.

Do I want to have each link redirecting the user to different pages? My understanding is that ASP.NET is much better at maintaining state information and so I shouldn't have to rely on the query string to keep passing values to an SSI file to do sequential parts of each task.

Should I be using BLL and DAL to do this and/or stored procedures and managed code? Or could I do this sort of thing more simply with ASP.NET web pages, as opposed to web forms?

Feedback that would include a reference article and/or web example would be greatly appreciated. Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:44:06.590

您不一定要放弃整个思维方式并采用 ASP.NET Web 窗体。

自 2001 年 ASP.NET Web 表单问世以来，我一直在使用它制作网站。但我认为 ASP.NET MVC 对您来说会更容易过渡。我的意思是，有些事情在 MVC 中比在 Web 窗体中更难。但总的来说，MVC 将促进更多的网络友好实践，这是我现在更喜欢的。

例如，Web 窗体中的回发和视图状态的整个想法无疑使很多事情变得更容易。但他们也有伤害 SEO 和破坏后退按钮的问题。MVC 不依赖任何这些，并且通过处理表单帖子、重定向和 URL 的方式更容易改进用户体验。

不久前我写了一篇比较 MVC 与 Web 表单的文章... [http://swortham.blogspot.com/2009/10/when-to-use-aspnet-web-forms-and-when.html](http://swortham.blogspot.com/2009/10/when-to-use-aspnet-web-forms-and-when.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T21:44:13.600

根据我所看到的，您似乎已经在多个 ASP 页面上进行了向导式导航，并且您希望在 ASP.NET（WebForms 而非 MVC）站点中进行向导式导航。

*如果我对此有误解，我很乐意删除此答案。*

我建议使用[Wizard 控件](http://msdn.microsoft.com/en-us/magazine/cc163894.aspx)（[到处都有视频演示](http://www.bing.com/videos/search?q=asp.net%20Wizard%20control&FORM=HDRSC3)），它将在一页中提供这样的界面，从而降低了很多复杂性。无需跨页面跟踪变量 - 全部在一个页面中，因此始终可以访问。

向导页面确实往往有很多代码和标记，但要权衡的是所有向导功能都在一个节奏中，而不是分散在文件中，而且每一步发生的事情本质上是显而易见的。使用多文件方法，维护开发人员需要跟踪哪个页面发布到哪个页面，并花更多时间了解设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T19:40:46.623

关于 MVC vs Web Forms 的文章非常有趣，尽管在看了一些培训视频后，我觉得编码与 ASP 有很大不同。（我也看到的大多数示例都涉及 C#，尽管我看到一些使用 VB，这是首选，因为我已经在短时间内学习了很多新东西。）另外，我想知道 MVC 是否会让我使用验证工具，这在该项目的不同方面非常必要，该项目涉及几种不同且相当长的表格。鉴于我已经投入了大量时间来学习 ASP.NET，我想知道我是否应该多走一英里（或两英里）并学习如何创建业务对象 (BLL) 和数据层 (DAL ）。

# c# - draw a simple line graph using C# console application project

> ID：10660053
> 
> 赞同：-2
> 
> 时间：2012-05-18T21:37:47.443
> 
> 标签：c#, .net, charts

I wanted to know whether a X,Y graph can be plotted from C#'s console application? If so, can anyone please help me out. I am very very new to C# and I am trying to work on a tool which can useful for my group. I want to build a line graph with the following options: 1\. from an excel file containing X and Y values with headers 2\. random numbers with random headers

and save the chart as either a Bitmap/jpeg file.

I'd really be thankful to whosoever tries and guides me in the right direction and helps me out.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:46:00.567

这个怎么样？[http://www.codeproject.com/Articles/6708/Creating-Line-Chart-For-WebForms-Using-C](http://www.codeproject.com/Articles/6708/Creating-Line-Chart-For-WebForms-Using-C)

要从 excel 文件中获取 x 和 y，只需将其设置为具有 streamreader 和 openfiledialog 并过滤掉“，”或其他任何内容，然后 x 和 y 都将位于 [0] 之类的数组中,[1] 然后只使用 [0] 作为 x 和 [1] 作为 y。

# javascript - 是否可以在元素上找到委托事件？

> ID：10660055
> 
> 赞同：0
> 
> 时间：2012-05-18T21:37:50.587
> 
> 标签：javascript, jquery, delegates

通过 将处理程序放置到元素`$.on()`时，当您只有目标时，有没有办法找到委托事件？

前任：

`$('body').on('click', '#myLink', function(){ doStuff() });`

...

`$('#myLink').eventsFromOn();`

我知道这看起来很奇怪，因为如果事件有委托事件数据，它就不再是真正的委托事件，但值得一问......

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T21:52:32.527

如果您正在寻找处理程序数据，如果您足够努力，您似乎可以找到带有未记录信息的信息。在未记录的`events`数据对象上，您有键`type`、`handler`和 - 重要的是 - `selector`。因此，如果您从 开始`#mylink`，您可以查看`events`其祖先中每个级别的数据，为您想要的事件寻找匹配项，其中`$("#mylink").is(selector)`为真。

例如，使用此 HTML：

```
<body>
  <div id="mylink">click me</div>
</body> 
```

如果我执行

```
$("body").on("click", "#mylink", function() {
    // Anything
}); 
```

然后这样做：

```
var level = $("#mylink");
while (level[0]) {
  console.dir(level.data('events'));
    level = level.parent();
} 
```

我明白了：

```
不明确的
  没有属性
目的
  点击：数组[1]
    0：对象
        数据：未定义
        指导：1
        处理程序：函数（）{
        命名空间：“”
        origType: "点击"
        快速：数组[4]
        选择器：“#mylink”
        类型：“点击”
        __proto__: 对象
        委托数：1
        长度：1
        __proto__: 数组[0]
        __proto__: 对象
不明确的
  没有属性
```

如您所见，`click`hander 就`body`在那里，与`selector`element 匹配`#mylink`。

# emacs - 如何在 emacs 中绑定 C-=？

> ID：10660060
> 
> 赞同：6
> 
> 时间：2012-05-18T21:38:16.590
> 
> 标签：emacs, key-bindings

我的文件中的这个 s 表达式`.emacs`不会产生所需的结果：

```
(define-key global-map (kbd "C-=") 'djhaskin987-untab-to-tab-stop) 
```

为什么我不能将命令绑定到`Ctrl`+ `=`？

**编辑**澄清：

我正在使用Debian`emacs23-nox`的标准版本`urxvt-256colors`，除了我已经用它`--disable-iso405776`（或类似的东西）重新编译它，这样`Ctrl`+`Shift`就不会做奇怪的“插入字符”的事情。我不知道这是否会影响任何事情。例如，`C-M-i`发送`M-TAB`，我不明白。

**编辑二**：

我很抱歉没有说清楚。该函数`djhaskin987-untab-to-tab-stop`中有行`(interactive)`。这部分有效。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-10-24T15:38:13.217

[接受的答案与第一条评论中](http://community.dur.ac.uk/p.j.heslin/Software/Emacs/Download/xterm-extras.el.txt)的链接相结合，足以开始一个完整的解决方案。步骤是：

1.  使您的终端输出密钥的转义码
2.  让 Emacs 将转义码识别为标准按键
3.  在模式映射中绑定按键

第一个非常依赖终端和/或操作系统。

第一条评论中的链接显示了 X Window System 的一些示例。键名在`/usr/X11R6/include/X11/keysymdef.h`（或 try `locate keysymdef.h`）中可用，前缀为`XK_`（出于我们的目的，应将其删除）。我读到符号名称优于键文字。

我目前没有运行 X，但我认为在你的情况下它应该是这样的：

```
XTerm.VT100.Translations: #override \
Ctrl ~Meta ~Shift  <Key> equal:         string(0x1b) string("[emacs-C-=")\n 
```

第一个字符串是转义，第二个是您选择的。

在 iTerm 中，您可以使用`Preferences->Keys`并选择. 例如，我有：`Send Escape Sequence``Action`

[![iTerm 键映射](../Images/97c936a4adf585c82d5ba6451df2847a.png)](https://i.stack.imgur.com/TW34v.png)

Emacs Wiki[列出了](https://www.emacswiki.org/emacs/ConsoleKeys)其他终端的一些配置方法。

现在您可以教 Emacs 将其识别为`C-=`. 首先`define-key`进入`input-decode-map`. 我有几个辅助功能：

```
(defun my/global-map-and-set-key (key command &optional prefix suffix)
   "`my/map-key' KEY then `global-set-key' KEY with COMMAND.
 PREFIX or SUFFIX can wrap the key when passing to `global-set-key'."
   (my/map-key key)
   (global-set-key (kbd (concat prefix key suffix)) command))

 (defun my/map-key (key)
   "Map KEY from escape sequence \"\e[emacs-KEY\."
   (define-key function-key-map (concat "\e[emacs-" key) (kbd key))) 
```

那么：

```
(my/global-map-and-set-key "C-=" 'some-function-to-bind-to) 
```

某些键（当前：[`()\|;'`"#.,`](https://www.gnu.org/software/emacs/manual/html_node/elisp/Basic-Char-Syntax.html#Basic-Char-Syntax)）将需要在字符串中转义，例如`C-\.`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-20T02:09:43.170

在终端中，`TAB`用与 相同的字节序列表示`C-i`。并且通常终端对 没有特殊的字节序列`C-=`，所以它只会发送一个`=`. Emacs 对此无能为力。但是你可以教你的终端模拟器发送一些你选择的特殊字节序列（检查你的终端模拟器的文档），之后你可以教 Emacs 将它识别为`C-=`（使用类似的东西`(define-key input-decode-map "...thebytes..." [?\C-=])`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T23:46:24.517

问题是您在终端中使用 emacs。终端不允许“C-=”。在图形 emacs 中尝试您的功能，它将起作用。您将不得不为终端找到另一个键绑定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-10-12T10:15:33.833

您可以使用默认的 ascii 代码映射 C-=：`^[[61;5u`. 然后你可以使用以下方法在 Emacs 中绑定它：

```
(global-set-key (kbd "C-=") 'djhaskin987-untab-to-tab-stop)) 
```

或者让[use-package](https://github.com/jwiegley/use-package)来做，例如：

```
(use-package expand-region
  :ensure t
  :bind (("C-=" . er/expand-region))) 
```

我要感谢 Sam Brightman，感谢他出色的解决方案。这是一种非常干净，虽然笨拙的方法，适用于任何无法通过普通 ascii 代码发送的密钥。很长一段时间以来，我一直想让 C-TAB 在 iterm2 中工作。我可以通过删除 C-TAB/CS-TAB 的内置首选项键并使用他的方法来做到这一点。使用以下内容，我可以通过 ssh 连接到远程 Linux 机器并快速切换项目中的大量打开缓冲区，就像桌面编辑器一样。 [![在此处输入图像描述](../Images/ec4b687e1273b7f8307c0af7fd8bc5d0.png)](https://i.stack.imgur.com/XVuPV.png)

```
(use-package nswbuff
  :defer 1
  :after (projectile)
  :commands (nswbuff-switch-to-previous-buffer
             nswbuff-switch-to-next-buffer)
  :config
  (progn
    (my/global-map-and-set-key "C-TAB" 'nswbuff-switch-to-previous-buffer)
    (my/global-map-and-set-key "C-S-TAB" 'nswbuff-switch-to-next-buffer))
  :init
  (setq nswbuff-display-intermediate-buffers t
        nswbuff-exclude-buffer-regexps '("^ "
                                         "^\*.*\*"
                                         "\*Treemacs.*\*"
                                         "^magit.*:.+")
        nswbuff-include-buffer-regexps '("^*Org Src")
        nswbuff-start-with-current-centered t
        nswbuff-buffer-list-function '(lambda ()
                                        (interactive)
                                        (if (projectile-project-p)
                                            (nswbuff-projectile-buffer-list)
                                          (buffer-list))))) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T21:49:00.727

您要绑定的功能必须是交互式的。尝试：

```
(define-key global-map (kbd "C-=") 
    (lambda () (interactive) (djhaskin987-untab-to-tab-stop))) 
```

# oop - OOP - 处理配置类的设计模式

> ID：10660061
> 
> 赞同：2
> 
> 时间：2012-05-18T21:38:22.710
> 
> 标签：oop, design-patterns

是否有任何直接处理配置类的设计模式。也就是说，类只是配置设置的容器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T21:40:32.720

我通常倾向于使用常量进行全局设置。并非所有东西都必须是一个类。

有些人会告诉你这里适合单例模式，但我认为不同。单身人士是邪恶的。**[在程序员上看到这个问题](https://softwareengineering.stackexchange.com/questions/40373/so-singletons-are-bad-then-what)**

# django - 为什么切换到 Apache 会破坏我的 Django 应用程序中的所有静态文件？

> ID：10660062
> 
> 赞同：0
> 
> 时间：2012-05-18T21:38:35.380
> 
> 标签：django, apache, django-staticfiles

我正在从 Django 开发服务器切换到 Apache 进行生产。为此，我安装了modwsgi，并在apache2.conf中指定了以下内容。

```
# Run my django application.
WSGIScriptAlias / /home/david/registration/registration/wsgi.py
WSGIPythonPath /home/david/registration

<Directory /home/david/registration/registration>
<Files wsgi.py>
Order deny,allow
Allow from all
</Files>
</Directory> 
```

当我重新启动 Apache 时，我发现我的应用程序在我的浏览器中加载，但 CSS 或图像都没有。

以前，我一直用`staticfiles`它来管理我的静态文件。我有这些设置。

```
# Absolute path to the directory static files should be collected to.
# Don't put anything in this directory yourself; store your static files
# in apps' "static/" subdirectories and in STATICFILES_DIRS.
# Example: "/home/media/media.lawrence.com/static/"
STATIC_ROOT = '/home/david/static/'

# URL prefix for static files.
# Example: "http://media.lawrence.com/static/"
STATIC_URL = '/static/' 
```

静态文件过去可以工作，但现在不行了。为什么切换到 Apache 会阻止我的静态文件加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:52:38.253

使用 apache2 和 wsgi 和 django 的最佳选择是在 /etc/apache2/sites-enabled/mynewsite.apache 中使用一个新文件（扩展名无关紧要）

该文件必须如下所示：

```
NameVirtualHost *:80
<VirtualHost *:80>
    ServerAdmin diego@diegue.us
    ServerName yourproject.com.co
    Alias /admin/media/ /path/to/your/admin/media/
    Alias /media/ /path/to/your/media/
    Alias /static/ /path/to/your/static/collected/files/

    <Directory /path/to/your/admin/media/>
        Order deny,allow
        Allow from all
    </Directory>

    <Directory /path/to/your/media/>
        Order deny,allow
        Allow from all
    </Directory>

    <Directory /path/to/your/static/collected/files/>
        Order deny,allow
        Allow from all
    </Directory>

    WSGIScriptReloading On
    WSGIDaemonProcess yourproject python-path=/path/of/packages/for/python # (this is because I use virtualenvwrapper)
    WSGIProcessGroup yourproject
    WSGIApplicationGroup yourproject
    WSGIPassAuthorization On

    WSGIScriptAlias / /path/to/your/yourproject.wsgi
    ErrorLog /var/log/apache2/yourproject-error.log

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel debug

    CustomLog /var/log/apache2/yourproject-access.log combined

</VirtualHost> 
```

您需要告诉 apache 为您的 django 应用程序提供服务，但您还需要告诉它 Apache 为文件提供服务。

# file-upload - ASP File Extension Split

> ID：10660063
> 
> 赞同：1
> 
> 时间：2012-05-18T21:38:45.977
> 
> 标签：file-upload, asp-classic

I have the following code:

```
Public Sub Save(path)
    Dim streamFile, fileItem, filePath, allowedExtensions
    allowedExtensions = ".jpg, .gif, .png, .zip, .7z, .exe, .bmp, .pdf, .doc, .docx"

    if Right(path, 1) <> "\" then path = path & "\" '"

    if not uploadedYet then Upload

    For Each fileItem In UploadedFiles.Items        
        Dim MyArray, extension

        MyArray = Split(fileItem, ".")
        extension = MyArray(UBound(MyArray)-1)

        '' # var extension = UCase(right(fileItem.FileName,5,);

        if(allowedExtensions.Contains(extension)) then  
            filePath = path & fileItem.FileName
            Set streamFile = Server.CreateObject("ADODB.Stream")
            streamFile.Type = adTypeBinary
            streamFile.Open
            StreamRequest.Position=fileItem.Start
            StreamRequest.CopyTo streamFile, fileItem.Length
            streamFile.SaveToFile filePath, adSaveCreateOverWrite
            streamFile.close
            Set streamFile = Nothing
            fileItem.Path = filePath
        end if
     Next
End Sub 
```

I cannot seem to get this line correct:

```
MyArray = Split(fileItem, ".") 
```

The browser is telling me:

> Microsoft VBScript runtime error '800a01b6'
> 
> Object doesn't support this property or method
> 
> /up/freeaspupload.asp, line 90

Everywhere I look up, it shows this is how you do it.

Anyone have any ideas what I am doing wrong or a way around this?

I just want to only allow certain extensions to be uploaded.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T01:47:39.467

在 VBScript 中，原始类型没有内置方法。所以，**allowedExtensions**不能有`Contains`方法。我认为这就是发生错误的原因。线条`MyArray = Split(fileItem, ".")`正确清晰。

> ~~if(allowedExtensions.Contains(extension)) 那么~~

您可以使用[InStr](http://msdn.microsoft.com/en-us/library/wybb344c%28v=vs.84%29.aspx)在另一个词中搜索一个词。

```
'For case insensitive search
If InStr(1, BeingSearched, SearchedFor, vbTextCompare) Then
    'Contains
End If 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T12:18:26.053

好吧，Kul-Tigin 发现了您的代码的另一个问题，一旦您解决了这个问题实际上涉及的拆分问题，您就会崩溃。我怀疑您的 Split 函数失败的原因是它应该如下所示：

```
 MyArray = Split(fileItem.FileName, ".") 
```

请注意，您可能应该传递对象`FileName`属性的值。`fileItem`似乎`fileItem`没有指定默认属性。

# php - Linking search results to specified pages

> ID：10660064
> 
> 赞同：1
> 
> 时间：2012-05-18T21:38:47.997
> 
> 标签：php, hyperlink

For my project I created a search engine to search some books from the database. I also made a bookpage where you can find the whole information of the book and were you can react. But now I'm having trouble with linking the two with each other. In my code you can see the code that I am using to show the information in the search page but the title has to be a LINK to his specified bookpage. How can I fix it? Now I can only see the specified bookpage with f.e. book.php?bid=1 (book id = 1).

```
if ($numrows > 0) {
    while ($row = mysql_fetch_assoc($query)) {
        $id = $row['book_id'];
        $title = $row['book_title'];
        $author = $row['book_author'];
        $description = $row['book_description'];
        $keywords = $row['book_keywords'];
        $cover = $row['book_cover']; 
        $year = $row['book_year'];
        $feedback_search = "Results found for \"<b>$k</b>\"";
        $feedback_search = "<h1>$cover $title <span>($year)</span></h1><h2><h2><b>Author:</b> $author</h1> <br/> <p>$description</p></h2><hr /> ";
        echo $feedback_search;

    }
} 
else {

    $feedback_search = "<h1>No results found for \"<b>$k</b>\"</h1>";
    echo $feedback_search;

}

// disconnect db
mysql_close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T21:52:42.307

您可以使用[*锚标记*](http://htmldog.com/reference/htmltags/a/)( `<a>`) 在 html 代码中创建链接：

```
$feedback_search = "<h1>$cover <a href='book.php?bid=$id'>$title</a>... 
```

基本上，嵌入标签并将`href`属性设置为书籍信息页面。我还嵌入了`$id`上面的值，所以它知道要显示哪个书的 ID。

另请注意，对于引号内的引号，我使用了单引号 ( `'`) 而不是双引号。另一种解决方案是转义内部引号`<a href=\"...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T21:53:57.707

If I understand correctly, just add an anchor around the title, which links to `book.php` with the book's ID passed to it, e.g:

```
 $feedback_search = "<h1>$cover <a href=\"book.php/?bid=$id\">$title</a> <span>($year)</span></h1><h2><h2><b>Author:</b> $author</h1> <br/> <p>$description</p></h2><hr /> "; 
```

# javascript - jQuery：调用一个函数两次

> ID：10660066
> 
> 赞同：2
> 
> 时间：2012-05-18T21:39:19.313
> 
> 标签：javascript, jquery

我试图运行一个函数两次。页面加载时一次，然后单击时再次。不知道我做错了什么。这是我的代码：

```
$('div').each(function truncate() {
    $(this).addClass('closed').children().slice(0,2).show().find('.truncate').show();
});

$('.truncate').click(function() {

    if ($(this).parent().hasClass('closed')) {
        $(this).parent().removeClass('closed').addClass('open').children().show();
    }

    else if ($(this).parent().hasClass('open')) {
        $(this).parent().removeClass('open').addClass('closed');
        $('div').truncate();
        $(this).show();
    }

}); 
```

问题出在第 13 行，我`truncate();`第二次调用该函数。知道为什么它不起作用吗？

**在此处编辑**jsFiddle：http: [//jsfiddle.net/g6PLu/](http://jsfiddle.net/g6PLu/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T21:41:42.693

那是一个命名的函数文字。

该名称仅在函数范围内可见。
因此，`truncate`在处理程序之外不存在。

相反，创建一个普通函数并将其传递给`each()`：

```
function truncate() { ...}

$('div').each(truncate); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T21:48:45.380

你得到什么错误信息？

您应该创建函数，然后根据要求调用它

定义函数

```
function truncate(){
  $('div').each(function(){

  });
} 
```

然后调用函数

```
truncate(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T23:13:36.290

另一种方法是建立并触发自定义事件：

```
$('div').on('truncate', function() {
    $(this).......;
}).trigger('truncate'); 
```

然后，在您需要相同操作的其他地方，再次触发该事件。

截断所有 div ：

```
$('div').trigger('truncate'); 
```

同样，您可以只截断一个特定的 div ：

```
$('div#myDiv').trigger('truncate'); 
```

唯一的先决条件是已经附加了自定义事件处理程序，所以......

```
$('p').trigger('truncate'); 
```

不会做任何事情，因为尚未为`p`元素建立截断处理程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T17:33:26.610

我知道已经有一个公认的答案，但我认为最好的解决方案是插件[http://jsfiddle.net/g6PLu/13/](http://jsfiddle.net/g6PLu/13/)它似乎符合 OP 想要的精神（能够调用`$('div').truncate`）。并使代码更简洁

```
(function($) {
    $.fn.truncate = function() {
        this.addClass('closed').children(":not('.truncate')").hide().slice(0,2).show();
    };
    $.fn.untruncate = function() {
        this.removeClass('closed').children().show();
    };                
})(jQuery);

$('div').truncate();

$('.truncate').click(function() {
  var $parent = $(this).parent();
  if ($parent.hasClass('closed')) {
    $parent.untruncate();
  } else {
    $parent.truncate();
  }
}); 
```

# mysql - Adding a result column with conditions from other table

> ID：10660071
> 
> 赞同：0
> 
> 时间：2012-05-18T21:39:40.067
> 
> 标签：mysql, select

I'm selecting everything from my `players` table, then I want to check if player `id` or player `name` is set in other table with an condition.

I got two tables - `players` and `shop`.

`shop` has the following columns: `uid`, `dateline`, `from`, `done`.

As I said, I'm selecting everything from `players` table, now I want to add additional column to the result called `was_shopping` and it will be the `1` when `players`.`id` or `players`.`name` is somewhere in the `shop` and where `shop`.`dateline` is higher than my variable given.

Just to be sure you understood everything correctly it should goes like this (its not a query, its just a word-example on how it should works in query):

```
SELECT *
FROM players
WHERE (players.id OR players.name)
IN (
    SELECT `uid` AND `from`
    FROM `shop`
    WHERE `dateline` >= xxxxx
   ) 
```

And if `players`.`id` or `players`.`name` will be inside of the `shop`.`uid` OR `shop`.`from` with `dateline >= xxxxx` it should add another column to the result: `was_shopping` - `1` OR `0` (if was found in `shop` table then 1, and 0 in case if not found).

Please post a comment if you don't understand a word.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T21:44:29.007

```
Select p.*, case when s.uid is null then 0 else 1 end as was_shopping
From players as p
left join shop as s
where s.uid = p.id and s.dateline > = xxxxx 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T22:13:51.920

根据您的描述，我相信这将返回正确的结果。注意我使用 10 的值进行日期选择：

```
select p.*, case when s.uid is null then 0 else case when dateline>10 then 1 else 0 end end as was_shopping 
from players p
left join shops s
on p.id = s.uid or p.name like concat('%',`from`,'%')
where s.uid is not null 
```

# qt4 - QWidget.setContentsMargins() 似乎无效：为什么会这样？

> ID：10660072
> 
> 赞同：11
> 
> 时间：2012-05-18T21:40:02.467
> 
> 标签：qt4, pyqt4

**情况：**
我正在研究以这种方式构建的 Qt4 应用程序（如果父小部件在此问题中很重要）：

```
QApplication
   |_ QMainwindow
         |_ QScrollArea (central widget)
               |_ QFrame (child of scroll area)
                     |_ QFrame
                     |      |_ QLabel
                     |            |_ QPixmap
                     |_ QFrame
                     |      |_ QLabel
                     |            |_ QPixmap
                     |_ QFrame
                           |_ ect... 
```

**目标：**
我希望子 QFrames 和它们的 QLabels 之间没有边距，并且在 QLabels 和它们的 QPixmap 之间没有边距。

**方法：**
我已请求使用 QFrame.setContentsMargins(0, 0, 0, 0) 及其布局的 QBoxLayout.setSpacing(0) 减少子 QFrame 的边距。QLabel 和它的 QPixmap 之间的零边距似乎是自然发生的。

**问题：**
尽管如此，QFrame 中的边距仍然出现：我已经能够通过将样式表应用于各种小部件来测试这种情况。

我能做些什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-18T22:14:00.453

[Qt论坛上提供的答案](http://qt-project.org/forums/viewthread/17341/)：

应在小部件及其*布局*上设置边距的内容。因此：

```
QWidget *w = new QWidget();
w->setContentsMargins(0, 0, 0, 0);
w->layout()->setContentsMargins(0, 0, 0, 0); 
```

# android - Spinner 的侦听器将默认/显示选项检测为 ItemSelected？

> ID：10660076
> 
> 赞同：1
> 
> 时间：2012-05-18T21:40:20.887
> 
> 标签：android, spinner, listener

我有一个意图启动的活动，页面上有许多微调器。[我刚刚按照本](http://developer.android.com/resources/tutorials/views/hello-spinner.html)指南设置了微调器的 ItemSelected 侦听器。问题是，每个 Spinner 中的第一个项目基本上是“请选择”，所以它不是一个空白框：所以我的 ItemSelected 侦听器检测到请选择在微调器中的事实，并且似乎假设它被选中而不是加载默认。理想情况下，我希望听众只检测到何时做出了实际选择。忽略默认选择的最佳方法是什么？

以下是相关代码：

```
 ageSpinner = (Spinner) findViewById(R.id.ageSpinner);
    ageAdapter = ArrayAdapter.createFromResource
    (this, R.array.ageArray, android.R.layout.simple_spinner_item);
    ageAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    ageSpinner.setAdapter(ageAdapter);
    ageSpinner.setOnItemSelectedListener(new MyOnItemSelectedListener());

public class MyOnItemSelectedListener implements OnItemSelectedListener {

    public void onItemSelected(AdapterView<?> parent,
        View view, int pos, long id) {
      Toast.makeText(parent.getContext(), "The planet is " +
          parent.getItemAtPosition(pos).toString(), Toast.LENGTH_LONG).show();
    }

    public void onNothingSelected(AdapterView parent) {
      // Do nothing.
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T02:43:43.467

问题是选择是在第一个布局阶段完成的。所以第一次计算你的布局时，`Spinner`raises `onItemSelected`。它很烦人，但它的工作方式。您可以尝试几种不同的方法，但鉴于您已经有*Please Select Something*项目，您能做的最好的事情就是在所选项目为 0 时忽略该事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:09:10.110

将布尔值设置为 false，在 onItemSelected 中对其进行检查，如果为 false，则将其设置为 true，并且不执行任何其他操作。下次，当它是真的时，照常做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-19T02:35:06.973

这里有很多可能的方法。例如，您可以覆盖`Spinner`使用反射的正常行为，或者简单地切换到`Button`模仿 a `Spinner`，单击它会弹出一个`AlertDialog`.

但是，其他解决方案可以更容易实施。Barak 命名了一个，而另一种方法是简单地检查 中的选定位置`Spinner`，假设“请选择”将始终是第一项（因此，在 position 处`0`）并且您没有对这些项目进行任何排序。

我相信您会找到适合您的问题的一种可能性，但也许您还可以详细说明为什么它的问题`onItemSelected(...)`会因初始选择而被解雇？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-15T18:26:32.540

*OP的解决方案。*

```
public class MyOnItemSelectedListener implements OnItemSelectedListener {

    public void onItemSelected(AdapterView<?> parent,
        View view, int pos, long id) {
        if (pos != 0) {
        //this if makes sure it ignores 0, which is 
            //Please Select in the drop down    
      Toast.makeText(parent.getContext(), parent.getTag().toString() +
          parent.getItemAtPosition(pos).toString(), Toast.LENGTH_LONG).show();
        }
    }

    public void onNothingSelected(AdapterView parent) {
      // Do nothing.
    }
} 
```

# git - 转换为 git 时保留 svn 复制历史记录

> ID：10660081
> 
> 赞同：7
> 
> 时间：2012-05-18T21:40:39.117
> 
> 标签：git, git-svn

我正在尝试将 SVN 存储库转换为多个 git 存储库。到目前为止，我一直在使用`git svn clone svn_repo_project_path`SVN 中的每个项目。我注意到 git 似乎没有遵循 svn 复制操作，因此生成的历史比我预期的要简短得多。假设我的 SVN 存储库看起来像这样：

*根*

*   一个
*   b
*   C
*   父项目
    *   b
    *   C

`b`作为重组工作的一部分，项目`c`最近被复制`parent-proj`，目的是最终将它们从根目录下的旧位置删除。当我这样做时`git svn clone http://svnhost/parent-proj`，生成的 git repo 丢失了所有源自迁移之前和迁移之前的历史`/b`记录`/c`。

这是 git-svn 的限制，还是有什么方法可以让这段历史出现在我的仓库中？[从我有限的研究来看，使用 git-svn 重命名的 SVN repo 的完整历史中](https://stackoverflow.com/questions/6514611/getting-complete-history-of-an-svn-repo-thats-been-renamed-using-git-svn)`filter-branch`描述的命令似乎可以工作，尽管在我的情况下，有多个父母可能会使事情复杂化。可以先克隆整个回购然后从中分离出新的回购（使用过滤器分支？）是更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-18T01:53:27.407

`b`如果`c`您`git svn clone http://svnhost/parent-proj`. _ `git svn`将您提供的基本路径解释为您有兴趣摄取 SVN 提交的最浅点，从而使 Git 提交相同。由于历史提交在这条路径下`b`和`c`之外，`git svn`不会镜像它们，所以你不会有那个历史。

查看该`git svn init --no-minimize-url`选项的文档：

> 当跟踪多个目录（使用 --stdlayout、--branches 或 --tags 选项）时，git svn 将尝试连接到 Subversion 存储库的根目录（或允许的最高级别）。如果整个项目在存储库中移动，此默认设置允许更好地跟踪历史记录，但可能会导致存在读取访问限制的存储库出现问题。传递 --no-minimize-url 将允许 git svn 按原样接受 URL，而无需尝试连接到更高级别的目录。当只跟踪一个 URL/分支时，此选项默认关闭（它不会有什么好处）。

由于您的`clone`命令没有指定多个分支（可能是因为您有一个复杂的、多项目或非标准布局），`git svn`因此只需克隆涉及该路径和向下的提交。Shadow Creeper 在评论中使用了`-s`or`--stdlayout`选项，这可以解释为什么为他们保留了一些历史。

如果这是一次性转换（从 SVN 到 Git 的单向移动），那么您可能应该克隆整个存储库，那么您可以在 Git 中移动东西以使其看起来像您想要的那样，包括建立历史分支和标签。如果运行的动机`filter-branch`是节省存储库空间，请确保这实际上会为您节省一些东西，并且值得费心。Git 在存储方面非常高效。

最后要注意的是对 Git 克隆中历史搜索的期望。使用 查找文件的历史记录`git log -C --follow <file-path>`，Git 通常会很好地定位并为您提供包含重命名和副本的历史记录。不要期望目录也一样，例如`parent-proj/b`. Git 跟踪 blob（文件）、树（blob）、提交和父提交，但不像 SVN 那样处理目录或目录副本。

# jquery - jQuery。用动画改变 div 宽度不起作用

> ID：10660082
> 
> 赞同：1
> 
> 时间：2012-05-18T21:40:41.837
> 
> 标签：jquery, html, css, jquery-animate

大家好，我有变量（widthPercent），我在其中存储百分比，例如：67.33%

当我尝试使用 jquery 动画更改宽度时，它不起作用：

```
$(this).animate({
        width: widthPercent,
    }, 2500);
}); 
```

但是用css改变宽度效果很好：

```
$(this).css('width', widthPercent); 
```

有谁知道我的问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T21:49:07.530

也许你需要引用 widthPercent

这对我有用

```
$(document).ready(
                function(){
                    var widthPercent = "35%";
                    $("#btn").click(
                    function(){

                        $(this).animate({
                            width: widthPercent,
                        }, 2500);
                    });
                }
            ); 
```

问题应该在您的 widthPercent 定义中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T21:48:31.637

[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

```
var widthPercent = "35%";

$(this).animate({
        width: "'"+widthPercent+"'"   // YOU ALSO HAD AN EXTRA COMMA HERE MEANING IT WAS EXPECTING ANOTHER ARGUMENT -- extra quotes may or may not be necessary depending on what your actual variable looks like
    }, 2500);
}); 
```

[http://jsfiddle.net/A2bdQ/5/](http://jsfiddle.net/A2bdQ/5/)

在使用 % 符号时也一定要使用引号，否则它可能会被视为内联 mod 操作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T21:52:20.260

你是这个意思吗：

jQuery：

```
$('#foo').click(function(){
    var widthPercent = '66%';
    $(this).animate({
        'width': widthPercent,
    }, 2500);
}); 
```

CSS：

```
#foo{
   width:300px;
   background:#ff0000;
   height:100px;   
} 
```

[JSF](http://jsfiddle.net/A2bdQ/)中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T22:04:07.273

您需要在宽度值中添加一个 '%' 字符，如下所示：

```
$(this).css('width', widthPercent + '%') 
```

这是一个说明它的[jsfiddle 。](http://jsfiddle.net/gene/n28Vc/)

# mysql - 同时查询MySQL和MSSQL数据库

> ID：10660083
> 
> 赞同：1
> 
> 时间：2012-05-18T21:40:49.467
> 
> 标签：mysql, sql, sql-server

我正在从 MSSQL 数据库（“A”）获取数据，并使用在 MSSQL 数据库中创建的日期插入 MySQL 数据库（“B”）。我用简单的逻辑来做这件事，但必须有一种更快、更有效的方法来做这件事。以下是涉及的逻辑顺序：

1.  为 MSSQL DB 创建一个连接，为 MySQL DB 创建一个连接。

2.  从 A 中获取满足提供的日期范围标准的所有数据。

3.  检查获得的哪些数据在 B 中不存在。

4.  将这些新数据插入 B。

可以想象，步骤 2 基本上是一个循环，它可以轻松地最大化服务器上​​的时间限制，我觉得必须有一种方法可以更快地执行此操作，并且在进行第一次查询时。谁能指出我实现这一目标的正确方向？您可以对两个数据库进行“一个”连接并执行以下操作吗？

```
SELECT * FROM A.some_table_in_A.some_column WHERE 
   "it doesn't exist in" B.some_table_in_B.some_column 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T21:59:37.110

[链接服务器](http://msdn.microsoft.com/en-us/library/ff772782.aspx)可能适合这个

> 链接服务器允许访问针对 OLE DB 数据源的分布式异构查询。创建链接服务器后，可以针对该服务器运行分布式查询，并且查询可以连接来自多个数据源的表。如果将链接服务器定义为 SQL Server 的实例，则可以执行远程存储过程。

也看看[这个 HOWTO](http://www.packtpub.com/article/mysql-linked-server-on-sql-server-2008)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T23:01:30.723

如果 MySQL 数据库定义了主键，那么至少可以跳过第 3 步（“检查获得的哪些数据不存在于 B 中”）。使用[`INSERT IGNORE INTO...`](http://dev.mysql.com/doc/refman/5.5/en/insert.html)它，它将尝试插入所有记录，默默地跳过已经存在具有主键的记录的记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T21:47:52.057

如果我正确理解您的问题，那么您只是想将 MSSQL DB 中的内容移到 MySQL DB 中。我还假设您使用某种过滤条件来进行迁移。如果这是正确的，您可以尝试使用 MSSQL 中的存储过程，它可以通过分布式查询来查询 MySQL 数据库。然后，您可以使用该存储过程在数据库端执行循环或检查，前端服务器只需要建立一个连接。

# html - 为什么 CSS3 PIE 在 CSS 文件中使用绝对路径时不能在子页面上工作？

> ID：10660084
> 
> 赞同：1
> 
> 时间：2012-05-18T21:40:50.310
> 
> 标签：html, css, css3pie

我有以下课程：

```
a.greenbutton, input.greenbutton  {
    /*background: url("../image/button.png") repeat-x scroll left top transparent;*/
    behavior: url("/css3pie/PIE.php");
    -webkit-border-radius: 7px;
    -moz-border-radius: 7px;
    border-radius: 7px 7px 7px 7px; 
    cursor: pointer;
    display: inline-block;
    line-height: 11px;
    padding: 6px 12px;
    text-decoration: none;
    background-color: green;
    color: white;
    position:relative;
    z-index: 0;     
} 
```

PIE.php 文件位于`/root/css3pie/`

你可以看看这里：

[http://trashtalk.dk/](http://trashtalk.dk/)

并查看差异：

[http://trashtalk.dk/Apple/iPhone](http://trashtalk.dk/Apple/iPhone)

您甚至可以从以下位置下载文件：

[http://trashtalk.dk/css3pie/PIE.php](http://trashtalk.dk/css3pie/PIE.php)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T02:13:10.133

您没有使用绝对路径，而是使用相对路径。要回答您的问题，我需要知道您的 css 文件所在的位置（相对于您的根文件夹）。

因为...如果它是 root/styles/ 或其他什么，那么您的饼图规则需要在 /csspie 内容之前添加两个点“..”。

换句话说，而不是：

```
behavior: url("/css3pie/PIE.php"); 
```

你需要：

```
behavior: url("../css3pie/PIE.php"); 
```

但这只是猜测工作，我需要首先知道您的 css 文件/文件夹的位置。

好的，参考这个页面：

[http://css3pie.com/documentation/known-issues/](http://css3pie.com/documentation/known-issues/)

> 行为 URL
> 
> IE 将行为属性的 URL 解释为相对于源 HTML 文档，而不是像其他所有 CSS 属性一样相对于 CSS 文件。这使得调用 PIE 行为不方便，因为 URL 必须是：
> 
> 绝对来自域根——这使得 CSS 不容易在目录之间移动——或者，相对于 HTML 文档——这使得 CSS 不容易在不同的 HTML 文件之间重用。PIE 解释的 CSS 属性中的 URL
> 
> PIE 不解析 CSS 样式表（这样做会非常慢）；它让 IE 处理解析、选择器查询、级联等，然后简单地向它询问结果属性值。这意味着当 PIE 获取属性值时，它不知道该值源自的上下文。
> 
> 因此，对于包含 URL 值的属性（例如 border-image 或 -pie-background），PIE 无法相对于它们出现的 CSS 文件解析这些 URL。而是相对于 JavaScript 执行上下文（即源 HTML 文档的位置）解析它们。

干杯
_

更新：

确保您有条不紊地尝试了所有这些：

1.  行为： url("../css3pie/PIE.php");
2.  行为：url("/../css3pie/PIE.php");
3.  **行为：url（“http://trashtalk.dk/css3pie/PIE.php”）；**

UHMMM ...你的css中的css3 pie规则在哪里？我看不到它，你知道，像 -pie-background 之类的东西。

# c++ - RNG 和全局变量避免

> ID：10660092
> 
> 赞同：3
> 
> 时间：2012-05-18T21:41:46.457
> 
> 标签：c++, oop, global-variables

我想知道这个。我听说全局变量很糟糕，它们会损害代码的可维护性、可用性、可重用性等。但在这种情况下，我还能做什么呢？也就是说，我有一个“伪随机数生成器”（PRNG），众所周知，它们涉及一个内部状态，每次生成新的随机数时都会发生变化。但这似乎是一种需要全球化的东西！或者是 RNG 类的“静态”成员，但这*本质上是一个全局的！*全局变量很**糟糕**！

那么，我能做些什么呢？显而易见的是有这样的东西（真的被剥离了）：

```
class RNG {
      private:
          StateType state;              // this is the thing one may be tempted
                                        // to make "static", which ruins the
                                        // whole idea
      public:
          RNG();                        // constructor seeds the RNG
          ~RNG();
          int generateRandomInt();
}; 
```

但是我们需要播种好，如果我们要在每次需要某个函数或类中的随机数时创建一个实例。使用时钟可能不起作用，因为如果创建的两个“RNG”类型的实例太靠近会怎样？然后他们得到相同的种子并产生相同的随机序列。坏的。

我们还可以创建一个主 RNG 对象并用指针传递它（而不是使其成为全局对象，这会使我们回到第 1 格），以便需要随机数的类获得指向其中的 RNG 对象的指针。但后来我遇到了一个问题，涉及将这些对象保存/加载到磁盘/从磁盘加载——我们不能只为每个实例“保存 RNG”，因为我们只有一个 RNG 对象。相反，我们必须将 RNG 传递给加载例程，这可能会为这些例程提供与其他不使用 RNG 的对象不同的参数列表。如果我们想为我们可以加载/保存的所有内容使用一个通用的“可保存”基类，这将是一个问题。那么该怎么办？消除常见的“可保存”基础，只采用关于如何制作加载/保存例程的约定（但不是 本身就没有那么糟糕吗？哦！）？

避免全局变量的可维护性问题但又不会遇到这些新问题的最佳解决方案是什么？

或者实际上可以在这里使用全局变量，毕竟“rand()”内置函数就是这样工作的？但后来我听到我脑海里的那个小东西在说“但是……但是但是但是，全局变量很糟糕！糟糕！” 从我所读到的，似乎有相当充分的理由认为它们不好。但似乎避免它们会产生新的困难，比如这个。例如，避免全局变量似乎比避免“goto”更难。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T21:53:15.493

你的不情愿是有道理的。例如，您可能想要替换另一个生成器进行测试，它会生成一个包含一些边缘情况的确定性序列。

[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)是避免全局变量的一种流行方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:03:41.307

随机数生成器是更适合全局的事物之一。你可以把它想象成：

-A RandomNumberFactory，一种使用全局工厂的设计模式，它为您构建随机数。工厂在语义上当然是恒定的（在 C++ 中，如果这对您意味着什么，您可以在内部使用关键字“可变”。）

- 一个全局常量（全局常量没问题，对吗？），它使您可以只读访问全局常量 randomNumber。randomNumber 恰好是不确定的，但它是恒定的，因为当然没有应用程序会写入它。

-此外，可能发生的最坏情况是什么？在多线程应用程序中，您的 RNG 会产生不确定的行为吗？喘气。正如@Mark Ransom 上面指出的那样，是的，这实际上是一个缺点，因为它使测试变得更加困难。如果这对您来说是一个问题，您可能会考虑一种将其写出来的设计模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:06:04.623

有时使用全局变量是有意义的。没有人可以断然地说你的代码不应该有任何全局变量，句号。

您*需要*了解全局变量可能引起的问题。如果您的应用程序的逻辑需要全局变量并且可以从多线程环境中调用它，那么*这本身并没有什么问题*，但是您必须小心使用锁定、互斥锁和/或原子读/写以确保正确的行为。

# ruby-on-rails - 如何使用 RSpec 登录用户

> ID：10660098
> 
> 赞同：3
> 
> 时间：2012-05-18T21:42:12.150
> 
> 标签：ruby-on-rails, ruby, rspec

我正在尝试在过滤器之前编写一个 RSpec 以登录用户。我有一个产品控制器。为了查看产品，用户必须登录。我在 spec/support/utilities 中添加了一个登录方法，如下所示：

```
def login(user)
  post login_path, email: user.email, password: "password"
end 
```

然后我在我的 spec/controllers/products 测试中调用了 before 过滤器中的方法：

```
before :each do
  user = FactoryGirl.create(:user)
  login(user)
end 
```

当我运行测试时，我收到以下错误：

```
The action '/login' could not be found for ProductsController 
```

我有一条路线，`/login`而且我的用户身份验证很简单——就像[Railscasts #250 Authentication from Scratch](http://railscasts.com/episodes/250-authentication-from-scratch)一样。我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T23:38:27.323

如果这是一个控制器规范，那么问题是在单元测试控制器时路由不可用。重点是隔离测试，也就是没有路由

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:39:10.357

登录正在调用没有登录方法的 ProductsController。正如其他人告诉您的那样，当您测试另一个控制器时，我不会调用一个控制器。因此，我认为您应该以其他方式登录。例如：

```
def login(user)
  session[:user_id] = user.id
end 
```

# mysql - MYSQL 在大数据上明显变慢 - 第三方应用程序

> ID：10660099
> 
> 赞同：2
> 
> 时间：2012-05-18T21:42:26.340
> 
> 标签：mysql, indexing, distinct, sugarcrm

联系人中的记录数：245847 团队中的记录数 团队：348

```
 mysql> explain SELECT distinct contacts.id FROM contacts INNER JOIN 
team_sets_teams tst ON tst.team_set_id = contacts.team_set_id where
 ( contacts.phone_work LIKE '%487%1864%' or contacts.phone_mobile LIKE
'%487%1864%' or  contacts.phone_other LIKE '%487%1864%' or
contacts.phone_home LIKE '%487%1864%'  )  ORDER BY
contacts.last_name LIMIT 0,11 \G;

           id: 1
  select_type: SIMPLE
        table: contacts
         type: ALL
possible_keys: team_set_id
          key: NULL
      key_len: NULL
          ref: NULL
         rows: 245628
        Extra: Using where; Using temporary; Using filesort
*************************** 2\. row ***************************
           id: 1
  select_type: SIMPLE
        table: tst
         type: ref
possible_keys: idx_ud_set_id
          key: idx_ud_set_id
      key_len: 109
          ref: db.contacts.team_set_id
         rows: 2
        Extra: Using where; Using index; Distinct
2 rows in set (0.00 sec) 
```

现在没有区别：

```
 mysql> explain SELECT distinct contacts.id FROM contacts INNER JOIN 
team_sets_teams tst ON tst.team_set_id = contacts.team_set_id where
 ( contacts.phone_work LIKE '%487%1864%' or contacts.phone_mobile LIKE
'%487%1864%' or  contacts.phone_other LIKE '%487%1864%' or
contacts.phone_home LIKE '%487%1864%'  )  ORDER BY
contacts.last_name LIMIT 0,11 \G;

           id: 1
  select_type: SIMPLE
        table: contacts
         type: index
possible_keys: team_set_id
          key: last_name
      key_len: 303
          ref: NULL
         rows: 2
        Extra: Using where
*************************** 2\. row ***************************
           id: 1
  select_type: SIMPLE
        table: tst
         type: ref
possible_keys: idx_ud_set_id
          key: idx_ud_set_id
      key_len: 109
          ref: karma.contacts.team_set_id
         rows: 2
        Extra: Using where; Using index
2 rows in set (0.00 sec) 
```

您将使用哪些字段作为索引。查询无法更改，因为它是第三方应用程序：

**团队套装**

```
mysql> show fields from team_sets_teams;
+---------------+------------+------+-----+---------+-------+
| Field         | Type       | Null | Key | Default | Extra |
+---------------+------------+------+-----+---------+-------+
| id            | char(36)   | NO   | PRI |         |       |
| team_set_id   | char(36)   | YES  | MUL | NULL    |       |
| team_id       | char(36)   | YES  | MUL | NULL    |       |
| date_modified | datetime   | YES  |     | NULL    |       |
| deleted       | tinyint(1) | YES  | MUL | 0       |       |
+---------------+------------+------+-----+---------+-------+
5 rows in set (0.00 sec) 
```

**联系人**

```
mysql> show fields from contacts;
+----------------------------+--------------+------+-----+---------+-------+
| Field                      | Type         | Null | Key | Default | Extra |
+----------------------------+--------------+------+-----+---------+-------+
| id                         | char(36)     | NO   | PRI | NULL    |       |
| date_entered               | datetime     | YES  | MUL | NULL    |       |
| date_modified              | datetime     | YES  | MUL | NULL    |       |
| modified_user_id           | char(36)     | YES  | MUL | NULL    |       |
| created_by                 | char(36)     | YES  | MUL | NULL    |       |
| description                | text         | YES  |     | NULL    |       |
| deleted                    | tinyint(1)   | YES  |     | 0       |       |
| assigned_user_id           | char(36)     | YES  | MUL | NULL    |       |
| team_id                    | char(36)     | YES  | MUL | NULL    |       |
| team_set_id                | char(36)     | YES  | MUL | NULL    |       |
| salutation                 | varchar(100) | YES  |     | NULL    |       |
| first_name                 | varchar(100) | YES  | MUL | NULL    |       |
| last_name                  | varchar(100) | YES  | MUL | NULL    |       |
| title                      | varchar(100) | YES  |     | NULL    |       |
| department                 | varchar(255) | YES  |     | NULL    |       |
| do_not_call                | tinyint(1)   | YES  |     | 0       |       |
| phone_home                 | varchar(100) | YES  | MUL | NULL    |       |
| phone_mobile               | varchar(100) | YES  | MUL | NULL    |       |
| phone_work                 | varchar(100) | YES  | MUL | NULL    |       |
| phone_other                | varchar(100) | YES  | MUL | NULL    |       |
| phone_fax                  | varchar(100) | YES  | MUL | NULL    |       |
| assistant                  | varchar(75)  | YES  | MUL | NULL    |       |
+----------------------------+--------------+------+-----+---------+-------+ 
```

# bash - 使用 sed 为 Mac 交换 Windows 位置

> ID：10660105
> 
> 赞同：1
> 
> 时间：2012-05-18T21:42:49.000
> 
> 标签：bash, service, sed, finder, automator

我正在为自动化服务编写一个 bash 脚本，该脚本将获取 Windows 目录位置并将其更改为 Mac 并打开一个查找器窗口。它正在工作，除非它击中带有空格的文件夹。我已经将它们删除，但它不适用于仍然有空格的任何东西。我一定犯了某种语法错误。

```
sed -e 's:\\\\fmg_cifs1\\Dept_Shares:/Volumes/Dept_Shares:' -e 's: :\ :g' -e 's:\\:/:g' | pbcopy
TAG=$(pbpaste)
cd $TAG; open . 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:04:44.560

几乎可以肯定，这就是您必须更改的全部内容：

```
cd "$TAG" 
```

报价解决一切！

你需要使用`pbcopy`and`pbpaste`和一个变量吗？

```
cd "$(sed -e 's:\\\\fmg_cifs1\\Dept_Shares:/Volumes/Dept_Shares:' -e 's: :\ :g' -e 's:\\:/:g')" 
```

正如乔纳森所指出的，有些`sed`命令是不必要的。当然，需要喂一些东西给`sed`. 这可能就是您所需要的：

```
cd "$(echo "$dir" | sed -e 's:\\\\fmg_cifs1\\Dept_Shares:/Volumes/Dept_Shares:')" 
```

# validation - Cakephp自定义验证在textarea中返回

> ID：10660106
> 
> 赞同：0
> 
> 时间：2012-05-18T21:43:04.530
> 
> 标签：validation, cakephp, cakephp-1.3

我想对 textarea 使用自定义验证，因为会有斯洛伐克口音但是当我输入新行时会抛出一个错误。请告知如何验证输入按钮？谢谢你

```
var $validate = array('text'=>array('custom'=>array(
    'rule' => array('custom', '/^[a-zA-Z0-9cšltžýáíéúóäônd".:,´()CŠLTŽÝÁÍÉÚÓND ]*$/i'),
    'message' => 'Zadávajte prosím len čísla alebo písmená')
        )
    ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T06:51:04.653

您需要一个自定义验证规则，我建议将其外部化为模型函数。此外，您的内联验证对我来说似乎有点崩溃。

所以你可以做什么：

```
var $validate = array(
    'text' => array(
        'rule' => 'myNewCustomRule',
        'message' => 'Zadávajte prosím len čísla alebo písmená'
    )); 
```

以及模型中的功能：

```
 function myNewCustomRule($custom) {
     //You may need to add here because the $data array is passed using the form field name as the key, you will have to extract the value to make the function generic
     //array_shift($custom);
     return preg_match('/^[a-zA-Z0-9cšltžýáíéúóäônd".:,´()CŠLTŽÝÁÍÉÚÓND ]*$/i', $custom);
 } 
```

# java - 在 Android 中以编程方式添加视图

> ID：10660111
> 
> 赞同：1
> 
> 时间：2012-05-18T21:44:03.040
> 
> 标签：java, android, xml, layout

是否可以将视图添加到与 OnCreate() 中 setContentView() 中调用的布局不同的布局？

我正在尝试使用 Zylincs ViewPager（可在[http://www.zylinc.com/blog-reader/items/viewpager-page-indicator.html](http://www.zylinc.com/blog-reader/items/viewpager-page-indicator.html)找到）并且我已经完成了该部分的设置并且工作得很好。

这给我留下了 4 种布局。1是main.xml，其他三个分别是main_pg0.xml、main_pg1.xml、main_pg3.xml

这三个页面是每个“页面”的内容是 main.xml 包含页面查看器的地方。

在 onCreate 中使用 setContentView(main.xml)。

我现在想做的是能够以编程方式将 textViews 添加到某些页面。

我现在拥有的是：

```
LayoutInflater factory = getLayoutInflater();

View layout = factory.inflate(R.layout.main_pg0, null);
View linearLayout = layout.findViewById(R.id.linearLayout);

TextView valueTV = new TextView(this);
valueTV.setText("hallo hallo");
valueTV.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.WRAP_CONTENT));

((LinearLayout) linearLayout).addView(valueTV); 
```

这是我所能得到的，它根本没有添加文本视图。

***- - 编辑 - -***

希望能澄清一下我正在尝试做的事情 这是我的代码

**主.java**

```
public class Main extends FragmentActivity implements PageInfoProvider {
  public GlobalVars globalVars;

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    globalVars = (GlobalVars) getApplicationContext();

    MyPagerAdapter adapter = new MyPagerAdapter();
    ViewPager myPager = (ViewPager) findViewById(R.id.viewpager);
    myPager.setAdapter(adapter);
    myPager.setCurrentItem(0);

    ViewPagerIndicator indicator = (ViewPagerIndicator) findViewById(R.id.indicator);
    myPager.setOnPageChangeListener(indicator);

    indicator.init(0, adapter.getCount(), this);

    Resources res = getResources();
    Drawable prev = res.getDrawable(R.drawable.indicator_prev_arrow);
    Drawable next = res.getDrawable(R.drawable.indicator_next_arrow);

    indicator.setArrows(prev, next);
  }

  private class MyPagerAdapter extends PagerAdapter {

    public int getCount() {
      return 3;
    }

    public Object instantiateItem(View collection, int position) {

      LayoutInflater inflater = (LayoutInflater) collection.getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);

      int resId = 0;
      switch (position) {
      case 0:
        resId = R.layout.main_pg0;
        LoadVehicles();
        break;
      case 1:
        resId = R.layout.main_pg1;
        break;
      case 2:
        resId = R.layout.main_pg2;
        break;
      }

      View view = inflater.inflate(resId, null);
      ((ViewPager) collection).addView(view, 0);

      return view;
    }

    @Override
    public void destroyItem(View arg0, int arg1, Object arg2) {
      ((ViewPager) arg0).removeView((View) arg2);

    }

    @Override
    public void finishUpdate(View arg0) {
      // TODO Auto-generated method stub
    }

    @Override
    public boolean isViewFromObject(View arg0, Object arg1) {
      return arg0 == ((View) arg1);
    }

    @Override
    public void restoreState(Parcelable arg0, ClassLoader arg1) {
      // TODO Auto-generated method stub

    }

    @Override
    public Parcelable saveState() {
      // TODO Auto-generated method stub
      return null;
    }

    @Override
    public void startUpdate(View arg0) {
      // TODO Auto-generated method stub

    }

  }

  public String getTitle(int position) {
    String title = "--Untitled--";
    switch (position) {
    case 0:
      title = "Page 0";
      break;
    case 1:
      title = "Page 1";
      break;
    case 2:
      title = "Page 2";
      break;
    }
    return title;
  }
} 
```

**主要的.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:orientation="vertical" >
  <com.zylinc.view.ViewPagerIndicator
    android:id="@+id/indicator"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="#EAEAEA"
    android:paddingBottom="8dp"
    android:paddingLeft="5dp"
    android:paddingRight="5dp"
    android:paddingTop="8dp" />
  <RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="#ffeaeaea" >
    <View
      android:layout_width="fill_parent"
      android:layout_height="1dp"
      android:layout_alignBottom="@+id/current"
      android:background="#C5C5C5" />
    <ImageView
      android:id="@+id/current"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:layout_alignParentTop="true"
      android:layout_centerInParent="true"
      android:src="@drawable/indicator_current" />
  </RelativeLayout>
  <android.support.v4.view.ViewPager
    android:id="@+android:id/viewpager"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" />
</LinearLayout> 
```

**main_pg0.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:background="#FFFFFF"
  android:orientation="vertical"
  android:id="@+id/linearLayout" >
  <TextView
      android:layout_width="fill_parent"
      android:layout_height="wrap_content"
      android:layout_marginLeft="5dp"
      android:text="main_pg0.xml"
      android:textColor="#0C0C0C"
      android:textSize="18sp" />

</LinearLayout> 
```

我试图做的是仅以编程方式将文本视图添加到 main_pg0.xml，而单独留下其他 2 个页面

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T09:14:12.437

您必须在主视图中添加视图，这是膨胀的布局。所以只需添加一行。

```
LayoutInflater factory = getLayoutInflater();

View layout = factory.inflate(R.layout.main_pg0, null);
View linearLayout = layout.findViewById(R.id.linearLayout);

TextView valueTV = new TextView(this);
valueTV.setText("hallo hallo");
valueTV.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.WRAP_CONTENT));

((LinearLayout) linearLayout).addView(valueTV);
layout.addView(linearLayout); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-19T19:55:38.123

您没有明确提到您是否将 s 提供给`Fragment`s `ViewPager`，但由于您正在使用 Zylinc 实现，我假设您是。事实上，我将使用提供的示例代码向您展示这个想法。

理解如何实现你所追求的关键是要让 s 中的页面是 s`ViewPager`形式的自包含单元`Fragment`。它们是可重用的，有自己的生命周期，并且可以处理自己的布局。因此，如果您想对页面布局进行运行时修改，您需要在`Fragment`构成这些页面的 (s) 中执行此操作。

下面的方法可以在示例代码的`ItemFragment`类中找到。我只是将`TextView`您自己的代码片段添加到其中。出于演示目的，我确实隐藏了`ListView`用于填充`date_fragment.xml`布局文件中所有空间的那个。

```
@Override public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    View v = inflater.inflate(R.layout.date_fragment, container, false);
    View tv = v.findViewById(R.id.text);
    ((TextView)tv).setText(readableDateFormat.format(date));

    // changes below
    TextView valueTV = new TextView(getActivity());
    valueTV.setText("hallo hallo");
    valueTV.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT));
    ((ViewGroup)v).addView(valueTV);

    return v;
} 
```

这将在页面中的日期正下方为您提供“哈洛哈洛”文本（您是荷兰人？;)）：

![代码片段的结果](../Images/1711e34b474f43832703e7e2410737ba.png)

顺便说一句，您可能需要考虑切换到 Jake 的[`ViewPagerIndicator`](http://viewpagerindicator.com/). 虽然我没有仔细研究过你目前使用的那个，但 Jake 对我来说似乎更灵活，使用起来更干净。当然取决于你。

* * *

**编辑：**好的，所以您实际上并没有在 中使用片段`ViewPager`，而是将其提供给布局。这很好，尽管当页面变得更复杂时可能会变得更难管理。无论如何，在运行时更改页面布局的关键仍然是在您构建/膨胀它时执行它。使用片段时，这将在覆盖的方法中，如上所示。但是，在您的情况下，您需要直接在`instantiateItem(...)`.

我实际上并没有在 IDE 中输入这个，所以请注意和小的语法错误。

```
public Object instantiateItem(View collection, int position) {

    LayoutInflater inflater = (LayoutInflater) collection.getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    View view = null;
    switch (position) {
    case 0:
        view = inflater.inflate(R.layout.main_pg0, null);
        TextView valueTV = new TextView(getActivity());
        valueTV.setText("hallo hallo");
        valueTV.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT));
        ((ViewGroup)view).addView(valueTV);
        break;
    case 1:
        view = inflater.inflate(R.layout.main_pg1, null);
        // or perhaps better for readability: build the layout in a different method, passing in the root
        buildSecondPageLayout(view);
        break;
    case 2:
        view = inflater.inflate(R.layout.main_pg2, null);
        buildThirdPageLayout(view);
        break;
    }

    return view;
} 
```

# javascript - 悬停时显示图像标题

> ID：10660120
> 
> 赞同：1
> 
> 时间：2012-05-18T21:44:47.153
> 
> 标签：javascript, html, caption

我正在尝试使用 javascript 仅在图像悬停时显示图像的标题，并在没有图像悬停时显示默认标题。

```
<ul class="logos">
    <li class="image-1"></li>
    <li class="image-2"></li> 
    <li class="image-3"></li> 
    <li class="image-4"></li> 
    <li class="image-5"></li>  
</ul>

<div class="captions">
    <p>Default caption</p>
    <p>This is a caption for the first logo</p>
    <p>This is a caption for the second logo</p>
    <p>This is a caption for the third logo</p>
    <p>This is a caption for the fourth logo</p>
    <p>This is a caption for the fifth logo</p>
</ul> 
```

关于如何使用 javascript 实现这种效果的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T21:49:24.663

有一种更好的方式来构建您的页面：

```
<script language="javascript" type="text/javascript">

    // sets the caption for the clicked img
    function caption(img){
       // finds the element with an id="caption"
       var ctrl = document.getElementById("caption");

       // sets the text of the element = the alt property of the img
       alert(img.alt);
       ctrl.innerText = img.alt;

       // sets the css display property = block (shows the element)
       ctrl.style.display = "block";

       // hides the defaultCaption element
       document.getElementById("defaultCaption").style.display = "none";
    }

    // shows the defaultCaption and hides the caption div
    function clearCaption() {
       document.getElementById("defaultCaption").style.display = "block";
       document.getElementById("caption").style.display = "none";
    }
 </script>

<ul class="logos">
    <!--
       alt : an alternative text description for an image
       onmouseover : event handler that fires as the mouse moves over image
       onmouseout : event handler that fires as the mouse moves off the image
    -->
    <li><img class="image-1" alt="caption text" onmouseover="caption(this)" onmouseout="clearCaption()"/></li>
    <li><img class="image-2" alt="caption text" onmouseover="caption(this)" onmouseout="clearCaption()"/></li>
    <li><img class="image-3" alt="caption text" onmouseover="caption(this)" onmouseout="clearCaption()"/></li>
    <li><img class="image-4" alt="caption text" onmouseover="caption(this)" onmouseout="clearCaption()"/></li>
    <li><img class="image-5" alt="caption text" onmouseover="caption(this)" onmouseout="clearCaption()"/></li>
</ul>

<div id="caption" style="display:none"></div>
<div id="defaultCaption">default caption text</div> 
```

更新：没有发现图像标签格式错误？- 我已将其重写为图像列表。

如果您想要 li 元素，则更`alt`改为`title`（在元素和代码中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:23:36.640

你甚至不需要 JavaScript。您可以通过 CSS 实现它。

在 jsFiddle 上查看它的实际效果：http: [//jsfiddle.net/phusick/n6wTr/](http://jsfiddle.net/phusick/n6wTr/)

标记：

```
<div class="container">
    <ul class="logos">
        <li class="image i1">
            <p class="caption">1st caption</p>
        </li>
        <li class="image i2">
            <p class="caption">2nd caption</p>        
        </li> 
        <li class="image i3">
            <p class="caption">3rd caption</p>                
        </li> 
    </ul>
</div> 
```

CSS：

```
div.container {
    position: relative;
    padding-top: 2em;
}

li.image p.caption {
    position: absolute;
    top: 0;
    left: 0;
    display: none;
}

li.image:hover p.caption {
    display: block;
}​ 
```

# javascript - 实例化事物的节点模块？

> ID：10660122
> 
> 赞同：1
> 
> 时间：2012-05-18T21:44:53.237
> 
> 标签：javascript, node.js, variables

我可以构建一个导出实例化变量的模块吗？

模块：

```
var module1 = require('module1')
var Module2 = require('module2')

module1.dosomething(variables)
exports.module1 = module1

//or

module2 = new Modle2(variables)
module2.dosomething(variables)
exports.module2 = module2 
```

我可以在许多其他文件中需要上面的模块并将导出用作实例化变量，还是每次我需要它们时都会重新实例化它们，而不是在需要它们的文件之间共享。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T21:58:51.677

您的示例令人困惑，因为您在多个上下文中使用 module1，既作为模块，又作为另一个模块中的变量，以及该模块的导出属性。

将模块视为闭包，将导出视为返回值。很可能您想导出一个函数/工厂函数并在每次想要使用导出创建新实例时调用它，其他任何东西都将被共享，因为它只是返回对象。

***模块1***

```
module.exports.var1 = function(opts) {
    // do stuff
    return variables;
};

module.exports.var2 = new Blah(); // single instance 
```

***其他模块***

```
var var1 = require('module1').var1({ opt1: 'foo' }); // New instance every time
var var2 = require('module1').var2; // Same var instance even if you include in another module 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:08:17.430

你甚至可以做这样的事情真的很烦人。大多数 npm 模块让您创建实例化版本以避免这种愚蠢。

```
// file.js
var m1 = require('./m1');
m1.awesome = false;
console.log("I am awesome", m1.awesome);

// file2.js
var m1 = require('./m1');
console.log("I am awesome", m1.awesome);

// both.js
require('./file');
require('./file2');

// m1.js
exports.awesome = true; 
```

现在运行这个：

```
node file1.js
I am awesome false

node file2.js
I am awesome true

node both.js
I am awesome false
I am awesome false 
```

# spring - 自动接线未按预期工作

> ID：10660124
> 
> 赞同：0
> 
> 时间：2012-05-18T21:45:27.750
> 
> 标签：spring, autowired

我正在使用 Spring Roo 并希望访问 Controller 类中的一个 bean，该类在 applicationContext.xml 中具有以下配置：

```
<bean class="com.reservation.jobs.Configuration" id="jobsConfiguration" autowire="byType">
 <property name="skipWeeks" value="4" />
</bean> 
```

配置类本身是：

```
package com.reservation.jobs;

public class Configuration {
 private int skipWeeks;

 public void setSkipWeeks(int value) {
  System.out.println("SkipWeeks set auf: " + value);
  this.skipWeeks = value;
 }
 public int getSkipWeeks() {
  return this.skipWeeks;
 }
} 
```

在我的控制器中，我认为一个简单的 Autowired 注释应该可以完成这项工作

```
public class SomeController extends Controller {
 @Autowired
 private com.reservation.jobs.Configuration config;

} 
```

在启动期间，Spring 在 setSkipWeeks 方法中打印消息。不幸的是，每当我在控制器中调用 config.getSkipWeeks() 时，它都会返回 0。

我必须使用 ApplicationContext 实例的 getBean 方法还是有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T21:51:57.830

`autowire="byType"`是多余的。它表明`Configuration`该类的字段应该是自动装配的，并且您只有一个原语。所以删除该属性。

除此之外，`config.getSkipWeeks()`必须返回`4`，除非：

*   您正在使用不同的实例（由您制作`new`）
*   您在某处调用了值为 0 的 setter

# iphone - 如何共享 GPS 位置 iOS

> ID：10660127
> 
> 赞同：1
> 
> 时间：2012-05-18T21:45:39.050
> 
> 标签：iphone, geolocation, share

我见过一些应用程序提供通过电子邮件或短信共享位置的功能。我已经进行了大量搜索，但没有找到太多关于此的内容。是不是因为所有共享的都是经度、纬度信息（因此非常简单）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T06:00:35.513

为此，您必须在核心位置的帮助下获取用户的当前位置，并借助该纬度经度，您可以通过 facebook、gmail 或任何社交媒体与其他用户共享谷歌地图链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T21:49:33.900

您需要获取位置信息并使用传输媒介（电子邮件、TCP/IP、HTTP）将其发送到远程站点。没有**自动**共享的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-29T07:25:36.167

您需要使用 CLLocationManager 订阅位置更新。它们每秒都在异步发生。您可以控制精度和其他一些参数。一旦你得到它，你需要通过你的服务或诸如 Urban Airship 之类的东西将通知推送到另一台设备。我像这样构建我的应用程序[https://itunes.apple.com/us/app/citrus-location/id777381230?ls=1&mt=8](https://itunes.apple.com/us/app/citrus-location/id777381230?ls=1&mt=8)。

以下是来自 Apple 的更多信息：[https ://developer.apple.com/library/ios/documentation/userexperience/Conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html](https://developer.apple.com/library/ios/documentation/userexperience/Conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html)

# ios - 当有多个 APN 堆叠时，如何获取 APN 的有效负载？

> ID：10660128
> 
> 赞同：2
> 
> 时间：2012-05-18T21:45:59.443
> 
> 标签：ios

考虑这种情况：

1.  应用程序当前不在前台，但它在后台处于未挂起状态（appDidEnterbackground：被调用）
2.  设备收到应用程序的 3 个 APN，用户将警报样式设置为“警报”
3.  用户单击显示通知警报的最顶部（第 4 个警报）上的启动
4.  didReceiveRemoteNotification: 被调用并且应用程序可以获得该特定通知的有效负载
5.  该应用程序现在位于前台，并在其顶部显示警报对话框（对于其他 3 个通知）
6.  用户在通知警报（第三个警报）上单击启动 - 没有任何反应
7.  用户再次单击通知警报上的午餐（第二个警报） - 仍然没有任何反应
8.  用户在最后一个通知警报（这是设备收到的第一个通知警报）上单击启动 - applicationDidBecomeActive: 被调用。

所以我的问题是应用程序如何获取第一个、第二个和第三个通知的有效负载？

我可以 100% 重现这个，我注意到 didReceiveRemoteNotification: 被调用以获取设备收到的最后一个通知，而 applicationDidBecomeActive 被调用为第一个，中间没有任何事情发生。

即，如果向设备发送 7 个通知，则 didReceiveRemoteNotification: 将在第 7 个被调用，然后当用户单击第 6、5、4、3 和 2 个警报对话框的启动时，什么都不会发生，然后当他们单击启动最后一个对话框（这是收到的第一个通知），然后调用 applicationDidBecomeActive:。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T13:27:13.727

你不能得到这个有效载荷。您可能还认为，APN 没有保证交付，因此无论如何您都必须从服务器获取信息。推送数据用于向用户展示您的应用的特定视图等内容。在应用程序的逻辑部分，推送应该只触发服务器数据的强制更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T22:51:46.927

我同意其他答案。将其存储在服务器上并从那里读取的最佳方式。

只需再引用一个非常相似的问题/答案：

[在后台处理 APNS 远程通知](https://stackoverflow.com/questions/7599704/handle-apns-remote-notifications-while-in-background)

# nginx - php-fpm 和 pcntl_fork

> ID：10660130
> 
> 赞同：2
> 
> 时间：2012-05-18T21:46:21.667
> 
> 标签：nginx, php

我正在使用 php-fpm 和 pcntl_fork 发出一个严重的问题。

两者都工作得很好，但是当它们在一起时，我会“松散”网络浏览器的标准输出。这意味着 fork 可以工作，但标准输出（客户端浏览器）对于每个人（所有子级和父级）都完全丢失了。

在 fpm 之外（例如在命令行中），fork 按预期工作（所有子项都打印到终端输出）。

有人做了什么工作还是 php-fpm 的一般问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:28:26.903

好的，我终于找到了好方法...

我使用的代码（可以在很多地方找到）使用`exit(0)`子进程上的函数来终止它。但是在 php-fpm 这也会杀死主进程......这就是为什么它在第一次子调用后没有输出......

这是解决方案（在`pcntl_fork`用户评论中找到）：

```
register_shutdown_function(create_function(
    '$pars', 'ob_end_clean(); posix_kill(getmypid(), SIGKILL);'
), array()); 
```

这将在脚本末尾按预期杀死任何僵尸，而不会杀死主进程

# html - 粘性标题覆盖锚文本

> ID：10660132
> 
> 赞同：7
> 
> 时间：2012-05-18T21:46:31.183
> 
> 标签：html, css

我有一个浮动在页面其余部分的粘性标题。当我链接到页面锚点时，当然是滚动，因此锚点位于页面顶部。但是，当这种情况发生时，标题会覆盖下面的文本。

有没有办法解决这个问题？我不能只是将锚点向下移动，因为页面上有很多锚点，并且每个锚点后面的文本数量都不同。我的第一个想法是以某种方式滚动到锚点上方的某个高度。

谢谢，大卫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T22:00:56.043

:target 伪元素可能是您正在寻找的。使用 :target 您可以处理用#-mark 指出的元素。[在此处](http://css-tricks.com/on-target/)阅读有关它的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-25T16:47:38.420

我遇到了同样的问题，最终制定了这样的规则：

```
A.named:target {
    display: inline-block;
    height: 120px;
    margin-top: -120px;
} 
```

然后，我将“命名”类应用于我希望浏览器滚动到的任何锚标记。这在浏览器顶部和包含锚点的元素底部之间增加了 120 像素的空间 - 大约 80 像素用于标题，另外 40 像素用于补偿我链接到的 H2 标题的高度......并且，负边距抵消了正边距，它不会影响我页面的外观。

希望这可以帮助！

# reporting-services - 在 SSRS 中分组但不互斥？

> ID：10660137
> 
> 赞同：0
> 
> 时间：2012-05-18T21:47:15.147
> 
> 标签：reporting-services, ssrs-2008

我有一个像这样的tablix

两个参数 - 开始日期和结束日期

```
Customer   Emp Hires    Emp Terminations
 XYZ        12          2 
```

进行分组的最佳方法是什么，特别是列分组？我目前在行组中按客户分组，然后在租用字段中，我正在做一个`sum(iif(hire_date between begin and end date,1,0))`. 终止字段相同，但使用员工的终止日期。（本质上是`sum(case when then 1 else 0 end)`SQL 中的

现在，由于他们可能会运行一整个月，因此员工可能会同时出现在两个列中（在同一个月内被雇用和被任命）。我正在做的是最好的方式还是有更正确/更有效的方式？如果我正在做的是 SSRS 中的最佳方式，那么似乎我应该在 SQL 中进行旋转（如果可能）而不是整体性能更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T11:21:40.843

如果您使用的是 SQL Server，我建议仅通过传递日期参数在 SQL 查询中执行此分组，因为 SQL 处理速度比 SSRS 快。

这是我提高报告性能的个人经验。

# c++ - 在 XCode 中获得有用的 STL 调试

> ID：10660140
> 
> 赞同：5
> 
> 时间：2012-05-18T21:47:42.320
> 
> 标签：c++, xcode, debugging

我正在使用 XCode 进行一些 iOS 开发，默认情况下，用于查看 STL 的监视窗口几乎毫无价值。在 Visual Studio 中，我可以编辑 autoexp.dat 文件以使 STL 查看更有用，有没有办法在 XCode 中做类似的事情？如果可能的话，我也想用 XCode for Boost 库做同样的处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T23:43:56.483

看起来 Apple 终于决定给予 C++ 一些关注。从 XCode 4.5 调试开始，监视窗口将得到极大改进，应该能够轻松显示 STL 类型。Apple 正在弃用 GCC 支持，只有通过使用 LLVM4 才能获得新的调试功能以及 C++11 支持。

在撰写本文时，此 XCode 4.5 处于 Beta 版，只有注册的 Apple 开发人员才能访问。这是 XCode 下载页面的链接，其中包含 XCode 4.5 的链接，仅供注册开发人员使用。[https://developer.apple.com/xcode/](https://developer.apple.com/xcode/)

# python - 如何在pylab中的nans上插入线？

> ID：10660144
> 
> 赞同：1
> 
> 时间：2012-05-18T21:48:28.903
> 
> 标签：python, plot, matplotlib

Pylab 在数据中有 nan 的地方插入换行符。我怎样才能得到连续的线条。我认为 matlab 会自动执行此操作。

例子：

```
x = linspace(0,1,10)
y = rand(10,2)
y[5:8,1] = nan
plot(x,y,'.-') 
```

我想要`y[:,1]`插值，但不是`y[:,0]`因为没有缺失点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:57:43.420

选择没有的行`nan`

```
from pylab import isnan
boolind = ~isnan(y).any(1) 
```

然后做

```
plot(x[boolind], y[boolind]) 
```

如果你想要一个线性插值的值来代替它`nan`，你只需记录它的位置`nan`并使用相邻点进行插值，但我认为出于绘图目的，简单地消除`nan`数据点就足够了——代码将为你进行线性插值反正。

顺便说一句：大概你`y = rand((10, 50))`应该是`y = rand(10, 50)`，虽然我不确定你为什么要针对一维绘制二维数组。

**编辑**

`y`对于您的特定问题，您可以简单地分别绘制两列

```
from pylab import *
x = linspace(0,1,10)
y = rand(10,2)
y[5:8,1] = nan
boolind = ~isnan(y)
plot(x[boolind[:,0]],y[boolind[:,0], 0],'.-')
plot(x[boolind[:,1]],y[boolind[:,1], 1],'.-')
show() 
```

![在此处输入图像描述](../Images/19400e83c2e6738341372b8bd8a7fbf4.png)

# ruby-on-rails-3 - Rails 的 scheme.rb 可以自动重新创建脚手架吗？

> ID：10660145
> 
> 赞同：1
> 
> 时间：2012-05-18T21:48:29.370
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2

使用`schema.rb`，我认为我们实际上可以将旧的 Rails 3.0 项目转换为 Rails 3.2.3 项目，使用此`schema.rb`文件重建数据库。

但是如果我之前在 3.0 项目中只是使用脚手架创建了所有 RESTful 资源，那么这个新的 Rails 3.2.3 项目是否也需要再次生成脚手架？如果是这样的话，用起来不是没用`scheme.rb`吗？因为无论如何我们都会一路创建所有迁移文件并执行 rake，我们可以一路生成额外的创建索引迁移。

或者，还有更好的方法？比如旧的脚手架和旧的数据库表和索引可以自动重新创建？可以使用或丢弃旧数据库，因此从头开始重新启动 sqlite 数据库是一个更简洁的选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:20:27.797

您是否有理由要废弃现有项目/数据库来构建新项目/数据库？通常很容易更新 Gemfile 中的 rails 版本，运行 bundle install，然后修复任何损坏的东西（如果你使用默认的脚手架，这不会太多）。现有的数据库可以与 3.0 或 3.2 以及所有旧的脚手架文件一起正常工作。

您应该查看[此 railscast](http://railscasts.com/episodes/282-upgrading-to-rails-3-1)以了解如何从 rails 3.0 升级到 3.1，以便了解升级的基础知识。从 3.1 升级到 3.2 更加容易。

要回答您最初的问题，没有直接的方法可以使用 schema.rb 重新生成脚手架。脚手架只是在您开始构建模型/控制器时帮助您的起点，重新创建它们通常没有意义，因为无论如何您通常最终都会对它们进行大量修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T20:40:43.480

您可以使用这个“反向脚手架”脚本：

> [https://github.com/ahe/reverse_scaffold](https://github.com/ahe/reverse_scaffold)

它将在您的 app/views 文件夹中生成所需的 html.erbb 文件。

它在自述文件页面上得到了很好的解释。

而且，它已针对 Rails 3.2 进行了更新

# view - 测试：如何测试包含所需数据的视图

> ID：10660149
> 
> 赞同：4
> 
> 时间：2012-05-18T21:48:47.607
> 
> 标签：view, tdd, integration-testing, bdd

假设厨师可以制作食谱，副厨师长可以制作必须由主厨批准的食谱。

您想测试一下，当主厨查看她的主页时，她会看到她自己创建的食谱。您还想测试她是否看到有等待她批准的食谱。

我可以想到两种方法来做到这一点：

1.  测试视图是否包含某些字词，例如“您的食谱”和“正在等待您批准的食谱”
2.  向您正在使用的 html 元素添加不必要的属性，以便您可以检查具有“id=recipe_1”或“data-for-the-sake-of-testing=1”的元素

我非常不喜欢这两种方法。

### 为什么方法＃1很烂

1.  令人难以置信的脆弱测试。每次您想对副本进行小幅更新时，测试都会中断。
2.  i18n? 这种方法将如何发挥作用？

可能还有更多的原因，但这两个是相当大的。

### 为什么方法＃2很烂

仅仅为了测试而有多余的标记是多么烦人！用户不应该为了测试而增加下载大小。

* * *

对此有什么好的方法？我很想听听任何替代方案，无论您使用哪种语言。我主要使用 Ruby、Test::Unit、Minitest、RSpec 和 Cucumber（尽管我的 Cuke 技能已经过时），但如果其他语言/框架弄清楚了，我也很想看看他们在做什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T08:28:51.547

使用页面范例。

尽可能以人性化的方式表达这些步骤，尽可能在能力级别（高级），并使用具体示例。例如，如果我使用 Cucumber，我可能会说：

> 鉴于副厨师长创建了青蛙派的食谱
> 当厨师寻找要批准
> 的食谱时，青蛙派的食谱应该在列表中。

在这些步骤的代码中，实例化或找到您要查找的特定页面，其中该页面是表示页面功能的对象。然后，该页面可以包含用户可以对该页面执行的*所有*操作 - 查找食谱、批准食谱、移动到另一个页面等。

这样，如果您需要更改步骤的底层代码，您只需在一个地方更改它，特定页面的所有更改都会一起进行。因为您已经根据您要交付的功能来表述该场景，所以该场景不太可能需要进行太多更改（除非您发现您的业务需要与您所交付的功能不同的功能）。

这对于基于窗口的应用程序也很有效，每个小部件或模块都是一个特定的页面。

有额外的 id 只是为了测试也很好。有时设计师也喜欢使用它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-26T14:12:53.140

我看到至少两个选项：

1.  避免通过 UI 测试业务逻辑。编写返回纯数据结构的“服务”或“用例控制器”对象。换句话说，你为你的系统构建了一个 API。您的单元测试通过 API 访问系统。您的 UI 通过相同的 API 访问系统，但是视图中应该几乎没有逻辑。请参阅[http://www.confreaks.com/videos/759-rubymidwest2011-keynote-architecture-the-lost-years](http://www.confreaks.com/videos/759-rubymidwest2011-keynote-architecture-the-lost-years)或[http://www.cleancoders.com/codecast/clean-code-episode-7/show](http://www.cleancoders.com/codecast/clean-code-episode-7/show)。

2.  使用“[页面对象](http://code.google.com/p/selenium/wiki/PageObjects)”模式。编写一个对象，读取您的应用程序生成的 HTML 代码，对其进行解析，并通过 getter 提供有趣的数据。这将为您的*测试创造奇迹*代码清晰。你的反对意见可能是你仍然有问题#2。事实上，我不认为这真的是一个问题。如果您使用结构化 HTML 标记，那么提取您需要的信息应该相当容易。如果您将 ID 附加到页面的关键元素会容易得多；在您的示例中，我将有一个 id="my-recipes" 的 div 和另一个 id="to-be-approved" 的 div。这应该足够了；使用 xpath 或 css 选择器应该很容易找到其他任何东西。为什么你觉得这令人反感？这些 ID 可能对其他用途有用，例如使用不显眼的 JavaScript 附加行为或使用 CSS 样式表附加样式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T06:43:57.223

我个人尽量不测试视图。我的意思是生成的标记，因为这些测试看起来非常脆弱。

相反，我专注于“数据提供者”方面，如果 MVC Web 框架是控制器。一旦控制器被单元测试覆盖，检查控制器准备了什么类型的数据，你就非常安全了。您创建的视图很容易测试，只需运行应用程序并查看它看起来是否正常。

尽管如此，还是有一些视图测试的方法。第一个是基于 Selenium Driver 的“端到端”测试模拟。它运行浏览器并初始化对您的应用程序的请求。测试正在检查输出 HTML。测试登录到“已知”版本，这意味着测试知道当前本地化是EN，例如。

您应该基本上结合使用 HTML 标记值（“Recipies”）的方法，否则使用 HTML 元素 id 或类。我不会为测试添加任何额外的标记。

您可以尝试的另一种方法是批准测试。我相信有一个 Ruby 驱动程序 - [http://approvaltests.sourceforge.net/](http://approvaltests.sourceforge.net/)。获得批准后，您可以渲染视图并将 HTML 保存为黄金母版。如果 View 已更改，测试将失败。它比 Selenium 测试更容易实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-19T10:37:13.657

与＃2一起生活，也许使用简短的评论（没有i18n问题并且对最终用户不可见）：

```
<!-- APPROVAL --> 
```

[simpletest](http://simpletest.org/en/mock_objects_tutorial.html)的文档对此有很好的理解：

> 下一个机会，看看电路板，也许是你现在正在看的计算机的主板。在大多数电路板上，您会发现奇怪的空孔，或者没有任何连接的焊点，或者可能是没有明显功能的引脚或插座。其中一些可能用于扩展和变化，但其余大部分将用于测试。

如果少量多余的标记使您的产品更可测试和更可靠，那就忍受它吧！

# javascript - TypeError：无法调用 null 的方法“getContext”（匿名函数）

> ID：10660150
> 
> 赞同：6
> 
> 时间：2012-05-18T21:48:59.250
> 
> 标签：javascript, canvas, typeerror

我是这方面的初学者，之前还没有真正做过任何 JavaScript，所以我希望你能帮助我。我制作了一个画布，让用户可以使用单选按钮选择形状和颜色，然后将其绘制到画布上。我还添加了一个复选框，可以选择为所选颜色添加渐变。这是程序： http: [//people.dsv.su.se/~caak1743/Canvas/canvas.html](http://people.dsv.su.se/~caak1743/Canvas/canvas.html)

现在我不想让形状可以在画布区域周围拖放。而且我发现了一个我认为可以更改以在我的程序上工作的代码，但我不断收到：TypeError: Cannot call method 'getContext' of null init (anonymous function) for the line：

```
 var ctx = canvas.getContext("2d"); 
```

而且我不知道出了什么问题或如何解决它。我试过寻找有类似问题的类似程序，但没有找到任何我可以在这里应用的东西。这是我试图与我合并的代码：

```
 function init() {
    var canvas = document.getElementById("myCanvas");
    var ctx = canvas.getContext("2d");
    return setInterval(draw, 10);
    }

    function draw() {
    clear();
    ctx.fillStyle = "#FAF7F8";
    rectangle(0,0,WIDTH,HEIGHT);
    ctx.fillStyle = "#444444";
    rectangle();
    }

    function myMove(e){
    if (dragok){
    x = e.pageX - canvas.offsetLeft;
    y = e.pageY - canvas.offsetTop;
    }
    }

    function myDown(e){
    if (e.pageX < x + 15 + canvas.offsetLeft && e.pageX > x - 15 +
    canvas.offsetLeft && e.pageY < y + 15 + canvas.offsetTop &&
    e.pageY > y -15 + canvas.offsetTop){
    x = e.pageX - canvas.offsetLeft;
    y = e.pageY - canvas.offsetTop;
    dragok = true;
    canvas.onmousemove = myMove;
    }
    }

    function myUp(){
    dragok = false;
    canvas.onmousemove = null;
    }

    init();
    canvas.onmousedown = myDown;
    canvas.onmouseup = myUp; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-15T13:18:43.370

只需将其更正为以下内容：

```
<script type="text/javascript">
window.onLoad=function(){ init();};
  function init() {
    var canvas = document.getElementById("myCanvas");
    var ctx = canvas.getContext("2d");
    return setInterval(draw, 10);
  }

  function draw() {
    clear();
    ctx.fillStyle = "#FAF7F8";
    rectangle(0,0,WIDTH,HEIGHT);
    ctx.fillStyle = "#444444";
    rectangle();
  }

  function myMove(e) {
    if (dragok) {
      x = e.pageX - canvas.offsetLeft;
      y = e.pageY - canvas.offsetTop;
    }
  }

  function myDown(e) {
    if (e.pageX < x + 15 + canvas.offsetLeft && e.pageX > x - 15 +
        canvas.offsetLeft && e.pageY < y + 15 + canvas.offsetTop &&
        e.pageY > y -15 + canvas.offsetTop) {
      x = e.pageX - canvas.offsetLeft;
      y = e.pageY - canvas.offsetTop;
      dragok = true;
      canvas.onmousemove = myMove;
    }
  }

  function myUp() {
    dragok = false;
    canvas.onmousemove = null;
  }

  init();
  canvas.onmousedown = myDown;
  canvas.onmouseup = myUp;
</script> 
```

这应该有效。问题是画布元素需要准备好运行脚本。由于`<script>`in`<head>`部分在加载之前运行，`<canvas>`因此会出现错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-21T12:23:54.583

我找到了两个解决方案。首先是将jquery添加到您的页面，然后无需使用in-html js，只需将整个js代码包装到

`$(document).ready(function() { *Your code here* });`

是什么让代码在 html 准备好之后运行，或者只是简单地交换头部和主体，不需要使用 in-html js *（它比 js 更早地执行 html）*。这些应该有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-03T07:54:23.907

您只需要这样做即可摆脱错误。只需在脚本之前添加画布并始终将脚本放在末尾。

```
<body>
<canvas id="ca"></canvas>

<script type="text/javascript">

    var ca = document.getElementById("ca");
    var co = ca.getContext("2d");

// whatever your code    
</script>
</body> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-28T10:17:23.417

确保您的脚本在您的画布元素***之后。***

# cocoa - 现代 Cocoa 应用程序中的错误处理

> ID：10660152
> 
> 赞同：1
> 
> 时间：2012-05-18T21:49:03.187
> 
> 标签：cocoa, exception, error-handling

我是一名计算机科学专业的学生，​​我即将完成。我们现在必须用我们选择的语言编写一个完整的应用程序。我们选择了 Objective-C，因为我们都是 Mac 人。

为了让我们的教授开心，必须做一些事情:-) 一项任务是：

选择一种方法来处理应用程序中的错误。确保正确处理所有可能发生的错误！

从我们的课程一开始，我们就一直在学习 Java。所以我们知道 Java 开发人员的大部分错误处理都是用异常处理的。

我在网上阅读了很多资源和文档。我还阅读了 Aaron Hillegass 的书“Mac OS X 的 Cocoa 编程”。我（几乎）从未在 Cocoa 编程的上下文中读过任何关于异常的内容。

我想知道的是你们如何在 Objective-C 代码中实现错误处理？我当然以某种方式处理了我的错误，直到现在，但它背后没有任何概念。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T21:59:24.810

在 Objective C 中，异常旨在用于通常指示程序员错误的致命错误。Cocoa 框架中的常规错误处理通常通过传递 NSError 对象来处理。可能出现错误的方法接受 NSErrors 作为参数。如果发生错误，他们将填写传递给他们的错误。然后调用代码负责检查错误并采取适当的行动。

如需进一步阅读，请参阅： [https ://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ErrorHandlingCocoa/ErrorObjectsDomains/ErrorObjectsDomains.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ErrorHandlingCocoa/ErrorObjectsDomains/ErrorObjectsDomains.html)

# android - 如何在 Android 上具有特定时隙的一日日历视图中显示日历事件？

> ID：10660157
> 
> 赞同：2
> 
> 时间：2012-05-18T21:49:21.233
> 
> 标签：android, android-listview, android-calendar

我一直在环顾四周，并试图弄清楚这是怎么可能的，但没有这样的运气。我如何准确地将事件排列在列表视图中的正确位置，以便将一天内的事件排在几分钟，而不是仅仅间隔 30 分钟？

任何人都可以指导我查看此示例代码，因为我没有运气找到它，或者只是解释这如何可能。我也不妨问一下，但是`MonthDisplayHelper`类是显示日历的唯一帮手吗？我只是好奇是否还有另一个。我非常感谢任何人花时间回答这个问题。

我所说的间隔是什么意思，

> 3:00 3:30 4:00 等

这里有一个视觉表示：![在此处输入图像描述](../Images/4059e5ab52a4741fd41449f51e5d495c.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T10:25:00.913

首先，您必须使用由 textview 填充的网格视图创建日视图。创建布局后，您可以轻松找到每一行的位置。您可以使用网格视图的时间和位置轻松放置和获取事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T11:51:50.920

我正在浏览[IOSHED](http://code.google.com/r/peppingmarkus-ioshed/)应用程序。它有一个名为**schedule**的模块 ，与您的要求相同。

看看[这个](http://code.google.com/r/peppingmarkus-ioshed/source/browse/android/res/layout/fragment_schedule.xml?r=becd6bc6c4d19a716efb92175e887bfaa9626553)布局。最终结果为

![在此处输入图像描述](../Images/c85feb6e8bc27702bf8368afc4652778.png)

希望能帮助到你。

# vba - VBA查找和替换但不包括实例之前的单词

> ID：10660161
> 
> 赞同：0
> 
> 时间：2012-05-18T21:49:40.857
> 
> 标签：vba, ms-word, replace

假设我想使用 VBA Word 来查找/替换。我想找到用“页面（标题需要加粗”）替换单词“页面”，但我只想在前面的单词不是“继续下一个”时这样做

我试图找到这个词，然后使用键盘命令来 ctrl+shift+向左箭头，如果那些 =“继续下一步”什么都不做，否则用“页面”替换“页面”（标题需要加粗）。

```
 Sub SpellingSuggestionPage()

Dim wrd As Range
Dim srchText As String, avdText As String, replWord As String
Dim ar() As String
Dim ignoreWord As Boolean

srchText = "page"
avdText = "next"
replWord = "page (title needs bolded)"

ar = Split(avdText, " ")

For Each wrd In ActiveDocument.Words

    ignoreWord = False

    If wrd = srchText Then

        If wrd.Previous(Unit:=wdWord, Count:=1).Text = avdText Or wrd.Previous(Unit:=wdWord, Count:=1).Bold Then
              ignoreWord = True
        End If

        If ignoreWord = False Then
            wrd.Text = replWord
        End If

    End If
Next
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:03:18.210

如果我理解正确，我认为这可能会做到：

```
If InStr(value, "page") > 0 And InStr(value, "continued on next") = 0 Then
    value = Replace(value, "page", "page (title needs bolded)")
End If 
```

这就是说：如果值在任何地方都包含“页面”并且在任何地方都不包含“继续下一个”，则将“页面”替换为“页面（标题需要加粗）”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T13:35:20.027

像这样？

```
Option Explicit

Sub Sample()
    Dim wrd As Range
    Dim srchText As String, avdText As String, replWord As String
    Dim ar() As String
    Dim ignoreWord As Boolean

    srchText = "page"
    avdText = "continued on next"
    replWord = "page (title needs bolded)"

    ar = Split(avdText, " ")

    For Each wrd In ActiveDocument.Words
        ignoreWord = False

        If wrd = srchText Then
            If Trim(wrd.Previous(Unit:=wdWord, Count:=1).Text) = Trim(ar(2)) Then
                If Trim(wrd.Previous(Unit:=wdWord, Count:=2).Text) = Trim(ar(1)) Then
                    If Trim(wrd.Previous(Unit:=wdWord, Count:=3).Text) = Trim(ar(0)) Then
                        ignoreWord = True
                    End If
                End If
            End If

            If ignoreWord = False Then
                wrd.Text = replWord
            End If
        End If
    Next
End Sub 
```

# java - 使用列表/表中的 json 创建树

> ID：10660167
> 
> 赞同：3
> 
> 时间：2012-05-18T21:50:55.803
> 
> 标签：java, json, tree

假设在这种情况下我有这样的表/列表 n=3，但 n 可以是无限的。

```
groupid       answerid1     answerid2     answerid(n)
1              3            6             8 
1              3            6             9 
1              4            7               
2              5 
```

我想使用java创建一个像这样的父/子树json输出。（我一直在使用GSON）

```
 {
        data: [
            {
                groupid: 1,
                children: [
                    {
                        answerid1: 1,
                        children: [
                            {
                                answerid2:3,
                                children: [
                                           {
                                    answerid3:6,
                                                  children: [
                                                              {answerid4: 8},
                                  {answerid4: 9} 
                                                             ]
                                              } 

                            }, {
                                 answerid2: 4,
                                 children: [
                                          {answerid3:7} 
                                   ]
                                 }
                                ]         
                    }, 

               {
                 groupid1: 2,
                 children: [
                       { answerid2: 5}
                        ]
                }

               ]      
        } 
```

这样做的代码/步骤是什么。我查看了很多标签，但大多数人都在打印输出，而不是递归地为 GSON 构建一个 hashmap/ArrayList 来解析并写入 API。另外一点，每个 id 都有与之关联的其他数据，这些数据必须包含在 json 输出中。例如，而不是 {groupid:1} 需要这个 {groupid:1, text=toyota}。

非常感谢任何帮助，因为我来自 SAS 背景，所以我对 java 还很陌生。

我得到这样的数据（只是一个列表矩阵）丰田，天然气，紧凑型，卡罗拉

*   丰田、汽油、紧凑型、凯美瑞*   丰田、混合动力、紧凑型、普锐斯*   本田, 汽油, 紧凑型, 思域*   如果需要，我可以将数据重新格式化为两个表

    parentId parText answerId

    *   1 丰田 1*   1 丰田 2*   1 丰田 3*   2 本田 4*   answerId 级别 answerTextid answerText

    *   1 1 1 气体*   1 2 2 紧凑型*   1 3 3 卡罗拉*   2 1 1 气体*   2 2 2 紧凑型*   2 3 4 凯美瑞*   …</p>

    然后我需要把它做成一棵树（嵌套输出像 JSON 显示父/子 - 就像你正在创建一个文件系统目录一样）

    我想做的另一件事是每辆车都有里程作为变量（{answerid3：4，text = Corolla，mileage = 38}。但如果我遍历树，给分支的平均里程。就像说在丰田、Gas、Compact 分公司，行驶里程为 avg（凯美瑞、卡罗拉）

    输出有点偏，我正在寻找这样的东西。如果没有孩子则没有孩子数组列表，并且属性是一个对象的一部分（哈希图）

    ```
    {"data":[{"id":1,"children":
        [{"id": 2,"children":
            [{"id": 3 ,"children":
                [{"id": 4,"name":"Prius"}],"name":"Compact"}],"name":"Hybrid"},
        {"id":5,"children":
            [{"id":3,"children":
                [{"id":7,"MPG":38, "name":"Corolla"},
                 {"id":8,"MPG":28,"name":"Camry"}],"name":"Compact"}],"name":"Gas"}],"name":"Toyota"},
    {"id":9, "children":
        [{"id":10,"children":
            [{"id":3 ,"children":
                [{"id":11 ,"name":"Civic"}],"name":"Compact"}],"name":"Gas"}],"name":"Honda"}]} 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:25:56.467

您应该按照您需要的结构创建类来为您的数据建模。您基本上是想从一些基于行的数据中构建一个层次结构，这很像一个 XML 文档，这可能是一个合适的解决方案。但是你让我着迷了，所以我玩弄了我以前的东西并想出了这个：

```
public class Test { 

    public static void main(String[] args) 
    {
        // hierarchical data in a flattened list
        String[][] data = {
                {"Toyota", "Gas", "Compact", "Corolla"},
                {"Toyota", "Gas", "Compact", "Camry"},
                {"Toyota", "Hybrid", "Compact", "Prius"},
                {"Honda", "Gas", "Compact", "Civic"}
        };

        TreeManager treeManager = new TreeManager();

        for(String[] row : data)
        {
            // build the path to our items in the tree
            List<String> path = new ArrayList<String>();
            for(String item : row)
            {
                // add this item to our path
                path.add(item);
                // will add it unless an Item with this name already exists at this path
                treeManager.addData(treeManager, path);
            }
        }

        treeManager.getData(data[0]).putValue("MPG", 38);
        treeManager.getData(data[1]).putValue("MPG", 28);

        Gson gson = new Gson();

        System.out.println(gson.toJson(treeManager));
    }

    /**
     * This base class provides the hierarchical property of
     * an object that contains a Map of child objects of the same type.
     * It also has a field - Name
     *
     */
    public static abstract class TreeItem implements Iterable<TreeItem>{

        private Map<String, TreeItem> children;     
        private String name;

        public TreeItem() {
            children = new HashMap<String, TreeItem>();
        }

        public String getName() {
            return name;
        }

        public void setName(String name) {
            this.name = name;
        }

        public void addChild(String key, TreeItem data) 
        {           
            children.put(key, data);
        }

        public TreeItem getChild(String key) 
        {           
            return children.get(key);
        }

        public boolean hasChild(String key) 
        {           
            return children.containsKey(key);
        }

        @Override
        public Iterator<TreeItem> iterator() {          
            return children.values().iterator();
        }           
    }

    /**
     * This is our special case, root node. It is a TreeItem in itself
     * but contains methods for building and retrieving items from our tree
     *
     */
    public static class TreeManager extends TreeItem
    {       
        /**
         * Will add an Item to the tree at the specified path with the value
         * equal to the last item in the path, unless that Item already exists 
         */
        public void addData(List<String> path)
        {
            addData(this, path);
        }

        private void addData(TreeItem parent, List<String> path)
        {
            // if we're at the end of the path - create a node
            String data = path.get(0);
            if(path.size() == 1)
            {
                // unless there is already a node with this name
                if(!parent.hasChild(data))
                {
                    Group group = new Group();
                    group.setName(data);
                    parent.addChild(data, group);
                }
            }
            else
            {
                // pass the tail of this path down to the next level in the hierarchy
                addData(parent.getChild(data), path.subList(1, path.size()));
            }
        }

        public Group getData(String[] path)
        {
            return (Group) getData(this, Arrays.asList(path));
        }

        public Group getData(List<String> path)
        {
            return (Group) getData(this, path);
        }

        private TreeItem getData(TreeItem parent, List<String> path)
        {
            if(parent == null || path.size() == 0)
            {
                throw new IllegalArgumentException("Invalid path specified in getData, remainder: " 
                        + Arrays.toString(path.toArray()));
            }
            String data = path.get(0);
            if(path.size() == 1)
            {
                return parent.getChild(data);
            }
            else
            {
                // pass the tail of this path down to the next level in the hierarchy
                return getData(parent.getChild(data), path.subList(1, path.size()));
            }
        }
    }

    public static class Group extends TreeItem {

        private Map<String, Object> properties;

        public Object getValue(Object key) {
            return properties.get(key);
        }

        public Object putValue(String key, Object value) {
            return properties.put(key, value);
        }

        public Group () {
            super();
            properties = new HashMap<String, Object>();
        }       
    }
} 
```

我认为这满足了您迄今为止提到的大多数要求，尽管我没有将 MPG 值的平均值作为读者的练习（我只有这么多时间......）。这个解决方案非常通用 - 您可能需要更具体的子类来更好地描述您的数据模型（如制造商、类型、模型），因为您将能够从它们身上挂起更多有用的方法（如计算子字段的平均值objects) ，并且您不必将属性作为`Object`s 的集合来处理，但是您会得到更复杂的代码来从列表中初始化数据结构。注意 - 这不是生产就绪代码，我只是提供了它作为示例，说明您可以如何使用 Java 对数据进行建模。

如果您不仅是 Java 新手，而且是[面向对象编程](http://en.wikipedia.org/wiki/Object-oriented_programming)的新手，那么您应该阅读该主题。我在这里写的代码并不完美，我已经看到了可以改进的方法。学习编写高质量的面向对象代码需要时间和实践。阅读[设计模式](http://en.wikipedia.org/wiki/Software_design_pattern)和[代码气味](http://en.wikipedia.org/wiki/Code_smell)。

# c# - 将 C# 引擎转换为 C++ 以提高速度

> ID：10660168
> 
> 赞同：-5
> 
> 时间：2012-05-18T21:51:00.493
> 
> 标签：c#, c++, dll, pinvoke

所以这就是现在的情况：我有一个 C# GUI 项目和一个 C# 引擎项目在同一个解决方案中。GUI 允许与用户交互，一些高级别的东西等。引擎的功能是与另一个第三方应用程序通信。Engine 具有连接到第三方应用程序的套接字，也具有将消息转换为对象、将其发送到第三方应用程序、侦听第三方应用程序的响应并做出相应反应的方法。引擎和第三方应用程序之间要通信的数据被打包到对象中。C# 引擎的问题是它太慢了。所以这个想法是将引擎转换为非托管 C++ 以提高速度。这是我的攻击计划：

1.  手动将整个 C# 引擎翻译成 C++（这已经相当令人生畏，因为 C# 引擎包含线程和哈希表）
2.  使用以下内容替代 C++ 中的构造函数、访问器和修改器：

    ```
    void* CreateInstance()
    {
        MyClass* p = new MyClass();
        return p;
    }

    void ReleaseInstance(void* pInstance)
    {
        MyClass* p = (MyClass*)pInstance;
        delete p;
    }

    int GetData(void* pInstance)
    {
        MyClass* p = (MyClass*)pInstance;
        return p->GetData();
    }

    void SetData(void* pInstance, value)
    {
        MyClass* p = (MyClass*)pInstance;
        p->SetData(value);
    } 
    ```

    （我不能在 C++ 中使用真正的类的原因是因为你不能在 C# 中实例化 C++ 对象）

3.  然后构建一个 C++ 非托管 DLL，在 C# GUI 项目（[DllImport 等]）中使用 P/Invoke 来访问所有 C++ 方法，并使用它来替换 C# 引擎。对象将使用方法进行模拟，并在 C# GUI 和 C++ 引擎之间来回传递。

在我开始这项耗时的任务之前，是否有任何 C# 代码无法翻译成 C++，然后通过这种方法重新导入 C# GUI？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:09:42.457

不会有任何 C# 代码不可能翻译成 C++。不过，您可能想查看 .NET 中是否有任何您将使用的 C++ 库未涵盖的库函数。确保您不会被任何需要重新发明的轮子卡住。

也就是说，在我的实践经验中，真实世界的 C++ 代码并不自然地比真实世界的 C# 代码快。确实，C++ 程序员有更多可用的技巧可以让他们获得更好的性能，但达到这一点所涉及的努力通常是相当艰巨的。考虑一下著名的[Rico Mariani 和 Raymond Chen 之间的竞争](http://blogs.msdn.com/b/ricom/archive/2005/05/10/416151.aspx)案例。Chen 的最终版本比 Rico 的优势最终归结为 .NET 运行时需要引导自身的时间。对于长时间运行的进程来说，这是可以忽略不计的一点开销。

因此，我强烈建议您尝试花一些时间使用性能分析器，首先了解 C# 代码为何缓慢，以及您可以采取哪些措施来加快速度。很可能通过走这条路线，您只需花费很少的精力就可以让代码运行得足够快，以满足您的需求。令人惊讶的是，仅选择更好的数据结构就能让人印象深刻。

# c++ - 签署到未签署的铸件

> ID：10660171
> 
> 赞同：3
> 
> 时间：2012-05-18T21:51:39.667
> 
> 标签：c++, types, unsigned, signed

看看这段代码：

```
void main ()
{
int i = -1;
unsigned u = 1;

cout << u + i;
} 
```

添加了 u（无符号）和 i（有符号），因此 i 必须转换为无符号类型，因此应将其解释为 ( (2 ^ 32) - 1 )，并且表达式应从：-1 + 1 更改为( (2 ^ 32) - 1 ) + 1 但是当我运行代码时结果为 0 为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T21:56:18.247

`-1`在unsigned 可以容纳的**最大可能**`UINT_MAX`数的无符号表示中 ( )。

由于 的属性，将 1 添加到此环绕`unsigned`，因此等于 0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T21:58:01.973

（无符号）-1 是 0xFFFFFFFF。1 + 0xFFFFFFFF = 0x100000000 溢出 int，结果为 0。

# php - PHP MySQL 数组 SELECT、FROM、WHERE

> ID：10660176
> 
> 赞同：1
> 
> 时间：2012-05-18T21:52:30.967
> 
> 标签：php, mysql, arrays

我正在尝试获取一个系统，其中数组数据被更改以匹配其在另一个 MySQL 表上的条目的 ID。我从 PHP 脚本上的复选框中得到这个。

这是代码

```
$insertSQL2 = "INSERT INTO test (Testing) VALUES SELECT Course_id FROM courses WHERE Code IN ";
foreach ($_POST['CheckboxGroup1'] as $Q){
    $Q = mysql_real_escape_string($Q);
    $insertSQL2.= "('$Q'), ";
} 
$insertSQL2 = rtrim($insertSQL2, ", "); 
```

我可以在需要时获得原始数据输出。例如，当四个复选框被选中时，它们将被放置在表格中的单独行中（我需要）。但是，当我尝试更改它以匹配代码时（当复选框 = 表中的代码时，放置 id 而不是代码）我收到以下错误。

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL      
server version for the right syntax to use near 'SELECT Course_id FROM courses WHERE 
Code IN ('CNMD'), ('EEM')' at line 1 
```

有没有人有任何可能的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:03:23.750

`INSERT`语句可以使用`VALUES`or`SELECT`语法。不是都。

你可能想要第二个：

```
INSERT INTO test (Testing) 
  SELECT Course_id 
  FROM courses 
  WHERE Code IN ('CNMD', 'EEM') ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T21:54:48.393

You have to make your SQL sentence look like:

```
SELECT Course_id FROM courses WHERE Code IN ('CNMD', 'EEM') 
```

So you PHP code would need to be something like:

```
$insertSQL2 = "INSERT INTO test (Testing) VALUES SELECT Course_id FROM courses WHERE Code IN (";
foreach ($_POST['CheckboxGroup1'] as $Q) {
    $Q = mysql_real_escape_string($Q);
    $insertSQL2.= "'$Q', ";
} 
$insertSQL2 = rtrim($insertSQL2, ", ");
$insertSQL2 .= ")"; 
```

# html - CSS last-child 选择器不起作用

> ID：10660180
> 
> 赞同：5
> 
> 时间：2012-05-18T21:52:52.810
> 
> 标签：html, css, less, css-selectors

我正在尝试将样式应用于`<p>`div 中的最后一个。我想这样做而不添加新的类（或 ID）。

我试过使用 last-child 选择器，但它不起作用。

我什至尝试`p:last-child {font-style: italic;}`为我的所有 CSS 文档声明，但这似乎没有任何效果。

这是我的 HTML：

```
<div class="new-section">
  <div class="collection-container">
    <div class="container">
      <div class="row">
        <div class="title span16">
          <h1>The Title</h1>
        </div>          
        <div class="span8">
          <p>Some text.</p>
          <p>This collection includes video, audio and essays.</p>
          <p>Visit now</p>
          <div class="arrow-right"></div>
        </div>
      </div>
    </div>
  </div>
</div> 
```

这是我的 LESS CSS：

```
.collection-container {
  height: 200px;
  position: relative;
  background-color: @gray;
  .container {
    padding-top: @r-margin;
    .title {
      margin-bottom: @xs-margin;
    }
    .span8 p:last-child {
      font-style: italic;
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-03-06T23:39:03.983

看起来这将是一个合适的使用位置，在其父元素`:last-of-type`中选择最后一个：`p`

```
.span8 p:last-of-type {
  font-style: italic;
} 
```

[示范](http://jsfiddle.net/hubfiddle/TVYnA/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T22:40:12.743

这是我删除冗余代码后的一个工作示例，向您展示它是如何工作的[http://jsfiddle.net/RDpcM/1/](http://jsfiddle.net/RDpcM/1/)

格式化代码并尝试分解尝试调试时重要的位始终是一个好主意**。**很容易弄错右括号，而且都是梨形的。

```
<div class="span8">

    <p>Some text.</p>
    <p>This collection includes video, audio and essays.</p>
    <p>Visit now</p>

</div>

div p:last-child    {
     font-style: italic;
    border:solid 1px blue;

 }
​ 
```

**[编辑-使用 JQuery]**

如果您在 div.span8 中有其他元素并且不知道前面的元素数量，您可以引入一些 jquery 来实现所需的效果。

这是另一个小提琴：http: [//jsfiddle.net/VPbv2/](http://jsfiddle.net/VPbv2/)

或者这将作为一个独立的示例供您试用。JQuery`mySelected`在文档加载时动态设置类。

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<style type="text/css">
.mySelected  {
    font-style: italic;
    border:solid 1px blue;
 }
</style>
<script type="text/javascript">
$(document).ready(function() {
    $("div.span8 > p:last").addClass("mySelected");
});
</script>
</head>
<body>
    <div class="span8">
        <p>Some text.</p>
        <p>This collection includes video, audio and essays.</p>
        <p>Visit now</p>
        <div>xxx</div>
    </div>
</body>
</html> 
```

**[编辑-非 JQuery]**

您指出，当您拥有此代码时，原始答案将不起作用

```
<div class="span8">
    <p>Some text.</p>
    <p>This collection includes video, audio and essays.</p>
    <p>Visit now</p>

    <div> another non-P tag that will mess up the p:last-child selector</div>

</div> 
```

所以你必须确保你的标签没有任何其他兄弟姐妹，方法`<p>`是将它们包装在像这样的额外 div 中

```
<div class="span8">
    <div class="only-for-p">
        <p>Some text.</p>
        <p>This collection includes video, audio and essays.</p>
        <p>Visit now</p>
    </div>

    <div> this non-P tag no longer messes with the p:last-child selector</div>

</div> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-18T21:56:13.737

我认为你的语法是错误的。应该...

```
.span8   p:last-child {font-style: italic;} 
```

你错过了期间..

此外，如果您不担心使用 CSS3，您可以这样做...

```
.span8   p:nth-child(3) { } 
```

这对于获取那些中间元素很有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-02-03T06:12:43.240

在您的情况下，您需要使用**p:last**或**p:last-of-type**选择器，因为 div.span8 的最后一个孩子是 div.arrow-right 而不是 p

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T22:01:17.483

```
div.span8 p:last-child { font-style:italic; } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-23T07:34:49.443

您的 css 无法正常工作，因为 p 标签不是 span8 的最后一个孩子。如果你改变 `.span8 p:last-child {font-style: italic;}` 它 `.span8 p:nth-last-child(2) {font-style: italic;}`会工作

# c++ - Method for checking duplicate values in binary search tree results in unresolved external

> ID：10660187
> 
> 赞同：1
> 
> 时间：2012-05-18T21:53:22.090
> 
> 标签：c++

When I add a Retreive() method to my BST implementation I get a "unresolved external" compiler error.![Compile Error](../Images/845e1b7d83eaa762d337a3ea680e5289.png)

The Retrieve() member function checks to see whether the value entered by the user exists in the BST, and if it does sets found = false.

```
//Header File
using namespace std;

struct PersonRec
{
    char name[20];
    int bribe;
    PersonRec* leftLink;
    PersonRec* rightLink;
};

class CTree
{

private:
    PersonRec *tree;
    bool IsEmpty();
    void AddItem( PersonRec*&, PersonRec*);
    void DisplayTree(PersonRec*);
    void Retrieve(PersonRec*, PersonRec*,bool&);

public:
    CTree();
    //~CTree();
    void Add();
    void View();

};

//Implementation File
#include <iostream>
#include <string>

using namespace std;

#include "ctree.h"

CTree::CTree()
{
    tree = NULL;
}

//PersonList::~MyTree()
//{
//
//}

bool CTree::IsEmpty()
{
    if(tree == NULL) 
    {
        return true;
    }
    else
    {
        return false;
    }
}

void CTree::Add()
{
    PersonRec* newPerson = new PersonRec();
    cout << "Enter the person's name: ";
    std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
    cin.getline(newPerson->name, 20);
    cout << "Enter the person's contribution: ";
    cin >> newPerson->bribe;
    bool found = false;

    newPerson->leftLink = NULL;
    newPerson->rightLink = NULL;

    Retrieve(tree, newPerson, found);
     if (found)
         cout << "Bribe allready entered\n";
     else
         AddItem(tree, newPerson);
}

void CTree::View()
{
    if (IsEmpty())
    {
        cout<<"The list is empy";
    }
    else
    {
        DisplayTree(tree);

    }

};

void CTree::AddItem( PersonRec*& ptr, PersonRec* newPer )
{
        if (ptr == NULL)
        {
            ptr = newPer;
        }
        else if ( newPer->bribe < ptr->bribe)
            AddItem(ptr->leftLink, newPer); 
        else
            AddItem(ptr->rightLink, newPer); 
}
void CTree::DisplayTree(PersonRec* ptr)
{
    if (ptr == NULL)
                    return;
    DisplayTree(ptr->rightLink);
    cout<<ptr->name<<" "<<"$"<<ptr->bribe <<endl;
    DisplayTree(ptr->leftLink); 
}
void Retrieve(PersonRec*& ptr, PersonRec* newPer, bool& found)
{
    {
        if (ptr == NULL)
        {
            found = false; // item is not found.
        }
        else if ( newPer->bribe < ptr->bribe)
        {
            Retrieve(ptr->leftLink, newPer, found);
        }
             // Search left subtree.
        else if (newPer->bribe > ptr->bribe)
        {
            Retrieve(ptr->rightLink, newPer, found);// Search right subtree.
        }   
        else
        {
            //newPer.bribe = ptr->info; // item is found.
            found = true;
        }
    }
}
//Driver File
#include <iostream>

using namespace std;
#include <cstdlib>
#include "ctree.h"

int displayMenu (void);
void processChoice(int, CTree&);

int main (void)
{
int num;
CTree ct;
do 
{
num = displayMenu();
if (num != 3)
processChoice(num, ct);
} while (num != 3);
return 0;
}

int displayMenu (void)
{
int choice;
cout << "\nMenu\n";
cout << "==============================\n\n";
cout << "1\. Add student to waiting list\n";
cout << "2\. View waiting list\n";
cout << "3\. Exit program\n\n";
cout << "Please enter choice: ";
cin >> choice;
return choice;
}

void processChoice(int choice, CTree& myTree)
{
   switch (choice)
   {
      case 1: myTree.Add (); break;
      case 2: myTree.View (); break;
   } 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T21:55:15.503

You don't qualify the definition with the class name:

```
void Retrieve(PersonRec*& ptr, PersonRec* newPer, bool& found) 
```

should be

```
void CTree::Retrieve(PersonRec* ptr, PersonRec* newPer, bool& found) 
```

# jquery - Get a textbox id inside a div in jquery

> ID：10660189
> 
> 赞同：2
> 
> 时间：2012-05-18T21:53:37.653
> 
> 标签：jquery

I need your help to find textbox id inside a div based on div's css class name in jquery.

```
<div class="FH_element FH_text required" id="FH_0_first_name">
    <label for="FHE_0_first_name">First*<small></small></label>
    <div>
        <input type="text" title="" name="first_name" value="" tabindex="3" id="FHE_0_first_name">
    </div>
</div> 
```

In the above code i need to find the textbox id(FHE_0_first_name) using div's class name(required)..in jquery.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T21:56:14.757

使用非常具体的选择器：

```
var textboxId = $('div.FH_element.FH_text.required')
    .find('input[type="text"]')[0]
    .id; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T21:55:54.833

```
jQuery('.required input').attr('id') 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-18T23:48:09.190

这应该有帮助

```
var textBoxId = $('.required').find('input[type=text]').attr('id'); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-18T21:57:09.033

尝试这个：

```
$('.required').find('input').attr('id') 
```

# mysql - Seed a data pair to rails app

> ID：10660192
> 
> 赞同：1
> 
> 时间：2012-05-18T21:54:07.433
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-3, activerecord

Im attempting to seed a :name, :date pair to a table in my rails app (via seed.rd)... Not quite sure how to do this.. My attempt below:

```
[[ "New Years Day", 2013/01/01 ][ "Easter", 2013/03/31]].each do |holiday|
  Holiday.create!({:name, :date => holiday})
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:09:52.283

选项1：

```
[{ :name => "New Years Day", :date => "2013/01/01" },{ :name => "Easter", :date => "2013/03/31"}].each do |holiday|
  Holiday.create!(holiday)
end 
```

选项 2：

```
[[ "New Years Day", "2013/01/01" ],[ "Easter", "2013/03/31"]].each do |holiday|
  Holiday.create!({:name => holiday[0], :date => holiday[1]})
end 
```

选项 3（实际上不是一个好选项，因为当您超出名称和日期时它会变得很脏）：

```
{ "New Years Day" => "2013/01/01" , "Easter" => "2013/03/31"}.each do |holiday|
  Holiday.create!({:name => holiday.first, :date => holiday.second})
end 
```

# jquery - determining if a div is a parent

> ID：10660196
> 
> 赞同：1
> 
> 时间：2012-05-18T21:54:36.077
> 
> 标签：jquery

Suppose I have this HTML structure:

```
<div id="Ancestor">
 <div>
   <div>
     ....
       <div class="DeepChild"></div>
...
<div id="NotAncestor">
 <div>
   <div>
     ....
       <div class="DeepChild"></div> 
```

I want to know, when I click on a DeepChild div if it's a descendant of Ancestor.

Something like this:

```
$('.DeepChild').click(function () {
   if (whichcondition?? === true) { IsFromAncestor = true; }
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T21:56:10.120

```
$(this).parents("#Ancestor").length > 0 
```

如果您的父母身份类是静态的并且不会随着时间的推移而移动，您可能只想将侦听器附加到嵌套在其中的 div 和祖先：

```
$("#Ancestor .deepchild").click(... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T06:43:14.827

这是一个老问题，已经有一个公认的答案，但我认为最好的选择还没有给出：

~~$(this).parents("#Ancestor").length > 0~~对于复杂的 DOM 结构可能会**非常慢。**

```
if ($('#Ancestor').find(this).length)
    //I'm under the  #Ancestor. 
```

[**jsperf**](http://jsperf.com/parents-vs-id-with-id/edit)显示我的方式**快三倍**！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T21:57:03.523

这样的事情怎么样

```
$(this).parents("#Ancestor").length > 0 
```

# c++ - 是否可以检查程序输出重定向到文件的控制台的宽度？

> ID：10660198
> 
> 赞同：2
> 
> 时间：2012-05-18T21:54:53.897
> 
> 标签：c++, windows, console, width

`GetConsoleScreenBufferInfo()`当程序输出重定向到另一个命令或文件时，使用标准输出初始化时返回错误。

无论程序输出是否写在控制台上，有没有办法获得程序运行的控制台的句柄并获得它的宽度？

也许`GetConsoleWindow()`这里有帮助，但我不知道如何使用它产生的句柄来获取宽度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T23:54:02.917

你的问题意义不大。如果输出被重定向，那么您的控制台窗口宽度根本无关紧要。只有显示重定向输出的程序的控制台（如果有）很重要。您无法猜测记事本的窗口大小。

但是，您可以获得控制台的句柄，您需要使用 CreateFile()：

```
HANDLE hConsole = CreateFile(L"CONOUT$", 
    GENERIC_READ | GENERIC_WRITE,
    0, 0, OPEN_EXISTING, 0, 0);
CONSOLE_SCREEN_BUFFER_INFO info = {0};
BOOL ok = GetConsoleScreenBufferInfo(hConsole, &info);
printf("OK = %d, %d x %d\n", ok, 
    info.srWindow.Right - info.srWindow.Left + 1, 
    info.srWindow.Bottom - info.srWindow.Top + 1); 
```

重定向文件中的输出：

> 确定 = 1, 80 x 25

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T22:00:21.233

看看[`GetConsoleScreenBufferInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683171%28v=vs.85%29.aspx)，特别是`srWindow`成员[`CONSOLE_SCREEN_BUFFER`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682093%28v=vs.85%29.aspx)。

# mysql - Security Exception on asp .NET framework 4 using MySql, trust level: Medium

> ID：10660199
> 
> 赞同：1
> 
> 时间：2012-05-18T21:55:09.917
> 
> 标签：mysql, asp.net-mvc-3

Im using VS 2010 MVC3, I set up the web.config to connect to my remote database. When I debug its runs ok, registers, logs in fine. But when I upload it to the host i get this error:

> Security Exception Description: The application attempted to perform an operation not allowed by the security policy. To grant this application the required permission please contact your system administrator or change the application's trust level in the configuration file.
> 
> Exception Details: System.Security.SecurityException: Request for the permission of type 'System.Security.Permissions.SecurityPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.
> 
> Source Error:
> 
> An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.
> 
> Stack Trace:
> 
> [SecurityException: Request for the permission of type 'System.Security.Permissions.SecurityPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.]
> MySql.Data.MySqlClient.MySqlConnectionStringBuilder.CreatePermissionSet() +0 MySql.Data.MySqlClient.MySqlConnectionStringBuilder.DemandPermissions() +38 MySql.Data.MySqlClient.MySqlConnection.PermissionDemand() +94 MySql.Data.MySqlClient.MySqlConnection.Open() +196
> MySql.Web.Common.SchemaManager.GetSchemaVersion(String connectionString) +65
> MySql.Web.Common.SchemaManager.CheckSchema(String connectionString, NameValueCollection config) +39
> MySql.Web.Security.MySQLRoleProvider.Initialize(String name, NameValueCollection config) +462
> System.Web.Configuration.ProvidersHelper.InstantiateProvider(ProviderSettings providerSettings, Type providerType) +419

Im using MySQL Connector Net 6.5.4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-19T14:01:35.387

这是很多人遇到的常见问题。那是因为您以完全信任级别构建您的网站。这允许您通过 IIS 完成几乎所有操作。但是很多托管公司只允许中等信任级别。所以您需要重新编码必要的中信任级别下的项目的一部分。

打开 ;

> C:\Windows\Microsoft.NET\Framework\v4.0.30319\Config

文件夹并打开 webconfig 文件，并更改行；

```
<trust level="Full" originUrl="" /> 
```

至

```
<trust level="Medium" originUrl="" /> 
```

老实说，我对进一步的步骤和您的程序集没有深入的了解。所以我可以提供很多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-22T16:06:52.847

我的朋友也有同样的问题。他管理它在 MySql 连接字符串中添加以下设置：

```
includesecurityasserts=true 
```

# rabbitmq - 如何为 django-celery 设置后端。我设置了 CELERY_RESULT_BACKEND，但无法识别

> ID：10660202
> 
> 赞同：6
> 
> 时间：2012-05-18T21:55:50.290
> 
> 标签：rabbitmq, celery, django-celery

我在 celeryconfig.py 中设置了 CELERY_RESULT_BACKEND = "amqp" 但我得到：

```
>>> from tasks import add
>>> result = add.delay(3,5)
>>> result.ready()

Traceback (most recent call last):
  File "<console>", line 1, in <module>
  File "/djangoprojects/venv/local/lib/python2.7/site-packages/celery/result.py", line 105, in ready
    return self.state in self.backend.READY_STATES
  File "/djangoprojects/venv/local/lib/python2.7/site-packages/celery/result.py", line 184, in state
    return self.backend.get_status(self.task_id)
  File "/djangoprojects/venv/local/lib/python2.7/site-packages/celery/backends/base.py", line 414, in _is_disabled
    raise NotImplementedError("No result backend configured.  "
NotImplementedError: No result backend configured.  Please see the documentation for more information. 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-26T14:24:29.933

我刚刚经历了这个，所以我可以对此有所了解。有人可能会认为，对于所有说明其中一些内容的优秀文档来说，这会更加明显。

我假设你已经启动并运行了 RabbitMQ（它需要运行），并且你已经安装了[dj-celery](https://github.com/ask/django-celery)。

一旦你有了它，那么你需要做的就是在你的 setting.py 文件中包含这一行。

```
BROKER_URL = "amqp://guest:guest@localhost:5672//" 
```

然后你需要运行 syncdb 并使用以下命令启动这个东西：

```
python manage.py celeryd -E -B --loglevel=info 
```

`-E`您希望捕获事件的状态以及`-B`您希望 celerybeats 运行的状态。前者使您可以在管理窗口中实际看到某些内容，而后者使您可以安排时间。最后，您需要确保您确实要捕获事件和状态。所以在另一个终端运行这个：

```
./manage.py celerycam 
```

最后，您可以看到文档中提供的工作示例.. -- 再次假设您创建了所说的 tasks.py。

```
>>> result = add.delay(4, 4)
>>> result.ready() # returns True if the task has finished processing.
False
>>> result.result # task is not ready, so no return value yet.
None
>>> result.get()   # Waits until the task is done and returns the retval.
8
>>> result.result # direct access to result, doesn't re-raise errors.
8
>>> result.successful() # returns True if the task didn't end in failure.
True 
```

此外，您还可以在管理面板中查看您的状态。

![Django 任务管理器](../Images/fc9ba390eb315845db34db92689fe142.png)

我希望这有帮助！！我会再添加一件对我有帮助的事情。 *观察 RabbitMQ 日志文件是关键，因为它帮助我确定 django-celery 实际上是在与 RabbitMQ 对话。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T04:53:15.293

你在运行 django celery 吗？

如果是这样，您需要在 django（或任何技术术语）的上下文中启动一个 python shell。

类型：

```
python manage.py shell 
```

并从该外壳尝试您的命令

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-26T15:50:47.943

HI 尝试了一切工作 celery v3.1.25 与 Django 1.8 版本没有任何效果。最后下面的行帮助了我，感觉很开心

```
app = Celery('documents',backend="celery.backends.amqp:AMQPBackend")
Setting backend="celery.backends.amqp:AMQPBackend"  fixed my error. 
```

# asp.net-mvc-3 - 通过淘汰赛和 ajax 更新下拉列表

> ID：10660206
> 
> 赞同：0
> 
> 时间：2012-05-18T21:56:12.113
> 
> 标签：asp.net-mvc-3, jquery, knockout.js

我正在尝试使用敲除和通过 ajax 调用检索的数据来更新下拉列表。通过单击刷新链接触发 ajax 调用。首次呈现页面时，下拉列表已成功填充。但是，单击刷新会导致清除下拉列表，而不是重新填充新数据。

html:

```
<select data-bind="options: pages, optionsText: 'Name', optionsCaption: 'Select a page...'"></select> 
<a id="refreshpage">Refresh</a> 
```

脚本：

```
var initialData = "[{"Id":"231271443653720","Name":"Car2"},{"Id":"439319486078105","Name":"Electronics1.2"},{"Id":"115147185289433","Name":"Product"},{"Id":"145033098963549","Name":"Product2"}]";
var viewModel = {
    pages : ko.mapping.fromJS(initialData)
};

ko.applyBindings(viewModel);

$('#refreshpage').click(function() {
    $.ajax({
        url: "@Url.Action("GetPageList", "FbWizard")",
        type: "GET",
        dataType: "json",
        contentType: "application/json charset=utf-8",
        processData: false,
        success: function(data) {
            if (data.Success) {
                ko.mapping.updateFromJS(data.Data);
            } else {
                displayErrors(form, data.Errors);
            }
        }
    });
}); 
```

来自ajax调用的数据：

```
{
  "Success": true,
  "Data": "[{"Id":"231271443653720","Name":"Car2"},{"Id":"439319486078105","Name":"Electronics1.2"},{"Id":"115147185289433","Name":"Product"},{"Id":"145033098963549","Name":"Product2"}]"
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:40:14.397

您遇到的问题是您没有告诉映射插件要定位什么。假设如何知道您传递的数据应该映射到页面集合。

这是您的代码的简化版本，它告诉映射什么目标。

顺便说一句，initialData 和 ajax 结果是相同的，所以如果它起作用了，你就不会注意到变化。

[http://jsfiddle.net/madcapnmckay/gkLgZ/](http://jsfiddle.net/madcapnmckay/gkLgZ/)

```
var initialData = [{"Id":"231271443653720","Name":"Car2"},{"Id":"439319486078105","Name":"Electronics1.2"},{"Id":"115147185289433","Name":"Product"},{"Id":"145033098963549","Name":"Product2"}];

var json = [{"Id":"231271443653720","Name":"Car2"},{"Id":"439319486078105","Name":"Electronics1.2"},{"Id":"115147185289433","Name":"Product"}];

var viewModel = function() {
    var self = this;

    this.pages = ko.mapping.fromJS(initialData);

    this.refresh = function () {
         ko.mapping.fromJS(json, self.pages);
    };
};

ko.applyBindings(new viewModel()); 
```

我删除了 jquery 点击绑定。是否有任何理由需要使用 jquery click 绑定而不是 Knockout 绑定？如果可能，不建议将两者混合使用，它会稀释 KO 擅长执行的关注点分离。

希望这可以帮助。

# c++ - 混合托管/非托管 C++？

> ID：10660214
> 
> 赞同：3
> 
> 时间：2012-05-18T21:56:54.943
> 
> 标签：c++, c++-cli

我有一个用标准 C++ 编写的库。我还有一个用 C# 编写的 .Net windows 窗体应用程序，它利用了非托管库。

我知道我可以只使用 pinvoke，但我的 C++ 完全是面向对象的，我真的不想搞乱编组等。

有没有一种方法可以让我创建一个新的托管 C++ dll 项目，复制并粘贴我的头文件和代码文件，然后编译它并访问所有类？

或者我是否必须在托管 C++ 中创建一些 ref 类并将其连接到我的非托管类？我只是希望这尽可能简单。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T23:18:03.993

即使在 C++/CLI 中，您仍然需要编写特定的 .NET 包装器，它们只是看起来不同。因此，您能否将其放入 C++/CLI 项目并重新编译并按原样使用它的答案是否定的。您仍然必须对数据进行编组（在这种情况下，您也可以使用 p/Invoke），或者您可以创建句柄并使用固定内存来使您的结构可用于托管代码。

我已经通过两种方式做到了这一点：我用 CUDA C 编写了一个 GPU 库，并使用 p/Invoke 从 F# 调用它，我用 C++ 编写了一个视频处理库并编写了一个瘦 C++/CLI 包装器，然后将其用于.NET 应用程序。我认为 CLI 包装器更痛苦，但对于实时视频，我需要更少的延迟（更少的复制内存）。对于 GPU 项目，我更关心吞吐量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T22:02:56.870

您可能想要在 C++/CLI 中编写包装类。只要您返回句柄而不是指针、枚举器而不是集合等，这样做相当简单。

# c++ - automake 在 C++ 文件的幻 C 版本上停止

> ID：10660216
> 
> 赞同：0
> 
> 时间：2012-05-18T21:56:58.920
> 
> 标签：c++, c, automake

我正在尝试将部分 libemf 添加到 Inkscape。在子目录“libEMF”中可以找到 libemf.cpp、libemf.h 和一些其他包含文件（所有 *.h）。在 makefile.am 和 makefile.in 中添加了类似于另一个类似目录（libavoid）的行，并做了：

```
./configure  (no problems) 
make
cd . && /bin/bash /usr/local/src/inkscape_dev1/inkscape/missing --run automake-1.11 --foreign 
src/Makefile.am: object `libEMF/libemf.$(OBJEXT)' created by `libEMF/libemf.cpp' and `libEMF/libemf.c' make: *** [Makefile.in]
Error 1 
```

这台计算机上的任何地方都没有 libemf.c。那么为什么makefile认为那个目录中有一个？？？谷歌针对该消息出现了很多情况，其中两个目录中有相同名称的文件，但这里应该没有冲突。请注意，尽管 configure.ac 确实具有 C++ 和 C 的标志，因为该项目构建的某些部分使用每种语言（主要是 C++）。版本：

```
automake 1.11.3
autoconf 2.68
ubuntu 12.04 LTS (32 bit) 
```

谢谢。

# c - C大调布莱克曼-哈里斯

> ID：10660218
> 
> 赞同：4
> 
> 时间：2012-05-18T21:57:02.030
> 
> 标签：c, math

我正在尝试复制此处看到的功能：[http ://en.wikipedia.org/wiki/Window_function#Blackman.E2.80.93Harris_window](http://en.wikipedia.org/wiki/Window_function#Blackman.E2.80.93Harris_window)

但我根本无法理解价值。这是我当前的代码：

```
double blackman_harris(int n, int N){
double a0, a1, a2, a3, seg1, seg2, seg3, w_n;
a0 = 0.35875;
a1 = 0.48829;
a2 = 0.14128;
a3 = 0.01168;

seg1 = a1 * (double) cos((double)(2*M_PI*n)/(double) (N - 1));
seg2 = a2 * (double) cos((double)(4*M_PI*n)/(double) (N - 1));
seg3 = a3 * (double) cos((double)(6*M_PI*n)/(double) (N - 1));

w_n = a0 - seg1 + seg2 - seg3;

return w_n;
} 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T07:39:59.043

将窗口定义为一个整体功能。

```
bool VecBuildBlackmanHarrisWindow( float* pOut, unsigned int num )
{
    const float a0      = 0.35875f;
    const float a1      = 0.48829f;
    const float a2      = 0.14128f;
    const float a3      = 0.01168f;

    unsigned int idx    = 0;
    while( idx < num )
    {
        pOut[idx]   = a0 - (a1 * cosf( (2.0f * M_PI * idx) / (num - 1) )) + (a2 * cosf( (4.0f * M_PI * idx) / (num - 1) )) - (a3 * cosf( (6.0f * M_PI * idx) / (num - 1) ));
        idx++;
    }
    return true;
} 
```

然后，您可以按如下方式定义窗口函数：

```
std::vector< float > window( 1024 );
VecBuildBlackmanHarrisWindow( &window.front(), window.size() ); 
```

这意味着您可以提前预先计算窗口函数。

在这一点上，我很抱歉我错误地引导了你。对不起。我检查了我的代码，您通过将所有窗口样本值平均在一起然后除以 2 来计算值（实际上将它们全部相加并除以 N/2）。

```
float fTotal    = 1.0f;
auto iter   = window.begin();
while( iter != window.end() )
{
    fTotal  += *iter;
    iter++;
}

fTotal  /= 1024.0f;
fTotal  /= 2.0f; 
```

这给了我 0.17969f 的值

（如果你使用更大的窗口，这个值会改变，因此我给你的值会稍微低​​一些）。

为混乱道歉

# ruby-on-rails - Aptana 插件 调试 rails 项目

> ID：10660223
> 
> 赞同：0
> 
> 时间：2012-05-18T21:57:17.530
> 
> 标签：ruby-on-rails, eclipse, aptana, aptana3

我正在尝试使用 aptana studio 3 插件调试 Rails 项目

我已经运行了命令

```
gem install ruby-debug-ide 
```

当我选择项目上下文菜单的调试服务器时，我得到：

```
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require': /usr/local/rvm/gems/ruby-1.9.3-p194@miGemSet/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.so: undefined symbol: ruby_current_thread - /usr/local/rvm/gems/ruby-1.9.3-p194@miGemSet/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.so (LoadError)
    from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'
    from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@miGemSet/gems/ruby-debug-base19-0.11.25/lib/ruby-debug-base.rb:1:in `<top (required)>'
    from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'
    from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'
    from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@miGemSet/gems/ruby-debug-ide-0.4.17.beta9/lib/ruby-debug-ide.rb:5:in `<top (required)>'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@miGemSet/gems/ruby-debug-ide-0.4.17.beta9/bin/rdebug-ide:17:in `require_relative'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@miGemSet/gems/ruby-debug-ide-0.4.17.beta9/bin/rdebug-ide:17:in `<top (required)>'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@miGemSet/bin/rdebug-ide:19:in `load'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@miGemSet/bin/rdebug-ide:19:in `<main>' 
```

顺便说一句，我的操作系统是 Fedora 16

你们有谁知道那是什么意思吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T10:05:44.690

我在 Ubuntu 12.04 上遇到了同样的问题，做了两件事：

1-发送电子邮件寻求帮助。2- 安装 RubyMine

在这两个结果上，问题是缺少一些宝石。

linecache19 (0.5.13 来自[http://rubyforge.org/frs/?group_id=8883&release_id=46302](http://rubyforge.org/frs/?group_id=8883&release_id=46302) ) ruby​​-debug-base19x (gem install ruby​​-debug-base19x --pre) ruby​​-debug-ide (gem install ruby​​-调试-ide--pre)

感谢 Denis Usahkov 的帮助：D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T02:58:44.237

我从上面的链接 (http://rubyforge.org/frs/?group_id=8883&release_id=46302) 下载了 gem，然后我做了以下事情：

```
rvm fetch 1.9.3
gem install ~/Downloads/linecache19-0.5.13.gem
gem install ~/Downloads/ruby-debug-base19-0.11.26.gem -- --with-ruby-include=/home/bruno.medeiros/.rvm/src/ruby-1.9.3-p194/ 
```

服务器正常启动，但 Aptana 尚未在断点处停止。

# asp.net-mvc-3 - 任务/线程的 Ninject Scope 问题

> ID：10660224
> 
> 赞同：8
> 
> 时间：2012-05-18T21:57:17.887
> 
> 标签：asp.net-mvc-3, entity-framework-4, ninject, task-parallel-library, unit-of-work

我有一个 MVC3 项目，它使用 Ninject、实体框架和带有服务层的工作单元模式。

我的 AsyncService 类具有启动后台任务的功能，例如，将用户添加到用户存储库。我当前的问题是，在我收到 DbContext 已被处理的错误之前，该任务只能正确运行几秒钟。我用 Ninject 的 InRequestScope() 注入的数据库上下文似乎正在被处理，因为 InRequestScope() 将它与 HttpContext 联系起来。

我已经阅读过 InThreadScope()，但是我不确定如何在我的 MVC 项目中正确实现它。

我的问题是：在我的任务中使用 Ninject 的正确方法是什么？

```
public class AsyncService
{
    private CancellationTokenSource cancellationTokenSource;
    private IUnitOfWork _uow;
    public AsyncService(IUnitOfWork uow)
    {
        _uow = uow;
    }
    public void AsyncStartActivity(Activity activity)
    {
    ...snip...
        this.cancellationTokenSource = new CancellationTokenSource();
        var cancellationToken = this.cancellationTokenSource.Token;
        var task = Task.Factory.StartNew(() =>
            {
                foreach (var user in activity.UserList)
                {
                    this._uow.UserRepository.Add(new User() {UserID = user});
                }
                this._uow.Save();
            }, cancellationToken);
     ...snip...
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-19T23:13:26.463

`InRequestScope`'d 对象`Dispose`在请求结束时是 d ，因此在这种情况下不能使用它。`InThreadScope`也不适合，因为这会将 UoW 重用于多个任务。

但是，您可以做的是`AsyncService`使用 NamedScope 扩展将您声明为所有对象的范围对象。

见[http://www.planetgeek.ch/2010/12/08/how-to-use-the-additional-ninject-scopes-of-namedscope/](http://www.planetgeek.ch/2010/12/08/how-to-use-the-additional-ninject-scopes-of-namedscope/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T13:40:52.863

这是我过去使用 ChildKernel 插件使用的一个混乱的解决方案（我认为命名范围会更干净）。基本上我创建了一个子内核，并将与 UoW 相关的所有内容都作为子内核中的单例。然后我为每个任务创建一个新的子内核，处理 UoW，并提交或回滚。

`IAsyncTask`是一个有 1 个方法的接口，`Execute()`

```
private Task void ExecuteTask<T>() where T:IAsyncTask
{

        var task = Task.Factory.StartNew(() =>
                                             {
            var taskKernel = _kernel.Get<ChildKernel>();
            var uow = taskKernel.Get<IUnitOfWork>();
            var asyncTask = taskKernel.Get<T>();

            try
            {
                uow.Begin();
                asyncTask.Execute();
                uow.Commit();
            }
            catch (Exception ex)
            {
                uow.Rollback();
                //log it, whatever else you want to do
            }
            finally
            {
                uow.Dispose();
                taskKernel.Dispose();
            }
      });
      return task;
} 
```

# django - 为什么发送请求上下文可以让我访问我的 Django 模板中的设置？

> ID：10660225
> 
> 赞同：1
> 
> 时间：2012-05-18T21:57:18.817
> 
> 标签：django

在我看来，如果我指定

```
def myView(request):
    return render_to_response('myTemplate.html', {'user': request.user,}, 
        context_instance=RequestContext(request)) 
```

然后我可以访问诸如`STATIC_URL`myTemplate.html 中的设置。

但是，如果我指定

```
def myView(request):
        return render_to_response('myTemplate.html', {'user': request.user,}) 
```

然后我无法访问`STATIC_URL`. 在后一种情况下，`{{ STATIC_URL }}`只会在呈现的页面中产生一个空字符串。在前一种情况下，`{{ STATIC_URL }}`为静态 URL ("/static/") 生成正确的字符串。

为什么我需要发送请求上下文来访问`STATIC_URL`模板中的设置？

我在 Apache 2 上运行 Django 1.4。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:10:09.613

阅读[文档](https://docs.djangoproject.com/en/1.4/ref/templates/api/#subclassing-context-requestcontext)以获得更好的答案。但有一个简短的答案：

这是因为 DRY（不要重复自己），想一想：如果您需要通过所有视图在所有模板中设置相同的变量怎么办？： context_processors，是以更有序的方式将变量添加到模板的方法。

我引用：

> Django 带有一个特殊的 Context 类，django.template.RequestContext，它的行为与普通的 django.template.Context 略有不同。第一个区别是它将 HttpRequest 作为其第一个参数。例如：

```
c = RequestContext(request, {
    'foo': 'bar',
}) 
```

> 第二个区别是它会根据您的 TEMPLATE_CONTEXT_PROCESSORS 设置自动使用一些变量填充上下文。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:30:13.487

要访问`STATIC_URL`设置，您需要发送请求上下文，因为默认情况下，`RequestContext`实例会自动填充一些变量，相应的`TEMPLATE_CONTEXT_PROCESSORS`设置也默认为：

```
(...
"django.core.context_processors.static",
...) 
```

关于`django.core.context_processors.static`上下文处理器，文档指出：

> 如果 TEMPLATE_CONTEXT_PROCESSORS 包含此处理器，则每个 RequestContext 都将包含一个变量 STATIC_URL，提供 STATIC_URL 设置的值。

相反，您不指定`context_instance=RequestContext(request)`零件。考虑这个签名：

```
render_to_response(template_name[, dictionary][, context_instance][, mimetype]) 
```

在这种情况下，使用了一个基本`Context`实例，并且（出于这个原因）只有给定的`dictionary`项目被注入到模板中。该字典可能包含也可能不包含 的值`settings.STATIC_URL`。

注意：正如另一个答案中所指出的，从 Django 1.3 开始，您可以直接使用`render`快捷方式而不是`render_to_response()`使用`context_instance`参数。

官方文档参考：

*   [render_to_response](https://docs.djangoproject.com/en/dev/topics/http/shortcuts/#render-to-response)
*   [子类化上下文：RequestContext](https://docs.djangoproject.com/en/dev/ref/templates/api/#subclassing-context-requestcontext)
*   [django.core.context_processors.static](https://docs.djangoproject.com/en/dev/ref/settings/#std%3asetting-TEMPLATE_CONTEXT_PROCESSORS)
*   [渲染快捷方式](https://docs.djangoproject.com/en/dev/topics/http/shortcuts/#render)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:30:18.603

由于您使用的是 1.4，因此请使用较新的[render()](https://docs.djangoproject.com/en/dev/topics/http/shortcuts/#render)快捷方式。然后你可以这样做：

```
def myView(request):
        return render(request, 'myTemplate.html', {'user': request.user,}) 
```

# java - Android：清理 AsyncTask

> ID：10660226
> 
> 赞同：1
> 
> 时间：2012-05-18T21:57:34.220
> 
> 标签：java, android

随着时间的推移，我的应用程序使用了很多 AsyncTask，我在调试器中注意到它们并没有消失，即使它们完成后它们仍然显示为活动线程。任务完成后有没有办法告诉垃圾收集器杀死它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:44:43.713

编辑：Lenik 在下面指出，我原来的答案不是取消 AsyncTask 的正确 android 方式。

AsyncTask 有一个完整而优雅的取消系统。`cancel(true)`当您准备取消时，调用您的任务的方法。如果您正在运行内部循环，请使用`isCancelled()`来检查状态，并在返回时适当地退出循环`true`。这具有在调用并完成`onCancelled(Object)`后在 UI 线程上调用您的方法的额外好处。然后将对您的任务的引用设置为空。`cancel(boolean)``doInBackground(Object[])`

谢谢列尼克！如果您发布答案，我将删除此答案，以便您获得信用。

# mysql - 从 mysql 表中删除超过 100,000 行 - 服务器崩溃

> ID：10660229
> 
> 赞同：3
> 
> 时间：2012-05-18T21:57:48.780
> 
> 标签：mysql

当我尝试从 mysql 表中删除超过 100,000 行时，我有一个问题，服务器冻结并且不再可以访问其网站！

我等了2个小时，然后重新启动服务器并恢复了帐户。

我使用了以下查询：

```
DELETE FROM `pligg_links` WHERE `link_id` > 10000 
```

-

```
SELECT* FROM `pligg_links` WHERE `link_id` > 10000 
```

完美运行

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:10:40.087

您可以删除较小集合中的行。一次删除 1000 行的快速脚本应该可以帮助您完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:39:30.807

对于大型数据集，“删除”可能非常昂贵。

我建议使用分区。

这在 PostgreSQL 和 MySQL 中可能略有不同，但在 PostgreSQL 中，您可以创建许多表，这些表是较大表的“分区”或在一个分区上。查询和诸如此类的东西可以在更大的表上运行。如果分区正确，这可以大大提高查询速度。此外，您可以通过简单地删除分区来删除它。这发生得非常非常快，因为它在某种程度上相当于删除一个表。

表分区的文档可以在这里找到：

[http://www.postgresql.org/docs/8.3/static/ddl-partitioning.html](http://www.postgresql.org/docs/8.3/static/ddl-partitioning.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:10:40.287

确保您在 link_id 列上有一个索引。并尝试一次删除像 10.000 这样的块。从表中删除是非常昂贵的操作。

# filter - 从 buttonclick 事件中过滤记录

> ID：10660230
> 
> 赞同：-1
> 
> 时间：2012-05-18T21:57:53.190
> 
> 标签：filter

我到处寻找答案，但是因为我对编程很陌生，所以我并没有真正掌握用于描述该过程的技术语言。我可能已经看到了答案，但没有将其识别为答案。

基本上我有一个显示在网格中的数据库。我有一个姓名字段（教师姓名），我想在他们记录的教师姓名字段中找到所有具有该姓名的记录。换句话说，我想找到所有被X老师教过的人。

我正在使用 TDBEdit 来显示教师姓名字段。我想做的是使用按钮单击来根据 DBEdit 中显示的文本过滤所有记录。

我现在可以使用过滤器对话框搜索所有字段。我不想在此搜索中执行对话，我不知道从哪里开始。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T08:00:46.460

好的，这就是我想出的：

```
procedure TForm1.btnSearchClick(Sender: TObject);
begin
tblTest.Filter:='Teacher='+QuotedSTR(Edit1.Text);
tblTest.Filtered:=True;
end; 
```

然后刷新表格我使用了另一个按钮点击事件：

```
procedure TForm1.btnRestoreClick(Sender: TObject);
begin
tblTest.Filtered:=False;
end; 
```

有没有更好的方法来实现这一点？

# ruby-on-rails - 从 CSV 导入记录并同时写入同一个 CSV？

> ID：10660231
> 
> 赞同：0
> 
> 时间：2012-05-18T21:57:54.163
> 
> 标签：ruby-on-rails, ruby, csv

我需要能够将 CSV 中每一行的两列与我自己的数据库进行比较。

例如，一行如下所示：

```
Headers => "Zipcode", "HouseNumber"
Row 1   => "5435 ZX", "43" 
```

首先，我需要根据邮政编码和门牌号在我自己的数据库中找到一家公司，如果返回 true，那么我需要导入该行中的其余列。我知道如何解决这个问题。

但是，我还需要能够跟踪导入的行，因为我需要将总记录分成小块，所以我需要在导入后的每一行中添加一个额外的字段。

总结一下：

在以下循环中导入后，如何向每一行添加一个额外的字段（“导入”）：

```
CSV.foreach('reviews.csv', :headers => true) do |row|
   Review.create(row.to_hash)
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:46:18.587

如果您能`Review`找到`Company`. 您必须对其进行清理以将其与`companies`表的正确属性名称匹配。

```
CSV.foreach('reviews.csv', :headers => true) do |row|
   Review.create(row.to_hash) if Company.where("Zipcode = ? and HouseNumber = ?", 
       row.Zipcode, row.HouseNumber)
end 
```

要添加其他列，请添加到以下内容：

```
CSV.foreach('reviews.csv', :headers => true) do |row|
   if company = Company.where("Zipcode = ? and HouseNumber = ?", 
       row.Zipcode, row.HouseNumber)
   row[:imported] = true
   Review.create(row.to_hash) 
end 
```

这假定该`imported`列存在于您的表中。

我认为我们可能需要更多信息才能为您提供更完整的答案，但这里的想法应该让您接近。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T01:32:25.400

似乎最简单的做法是将“导入”状态保持在单独的哈希中，如下所示：

```
imported = {}
CSV.read('reviews.csv').each_with_index do |row, line|
  if <your condition> && !imported[line]
    # create model
    imported[line] = true
  end
end 
```

然后只保留那个散列，直到你需要读取下一个块，然后重新运行。该`&& !imported[line]`位将阻止读取一行两次。

如果这不是您想要的，您需要稍微澄清一下您的问题。:-)

# java - Android 绘图应用程序崩溃

> ID：10660234
> 
> 赞同：2
> 
> 时间：2012-05-18T21:58:08.443
> 
> 标签：java, android, surfaceview

我正在制作一个绘图应用程序，当我按下时，应用程序随机崩溃。我不知道如何解决它，也不知道从哪里开始。我不知道是名单还是时机，还是别的什么。这是我的代码：

```
package com.orangewhales.paint.views;

import java.util.ArrayList;
import java.util.List;

import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.Path;
import android.graphics.Paint.Style;
import android.util.AttributeSet;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceHolder.Callback;
import android.view.SurfaceView;

public class PaintView extends SurfaceView implements Callback {

boolean run = true;
Thread tUpdate;
public List<PaintPath> paths = new ArrayList<PaintPath>();

public Paint stroke = new Paint();

@Override
public void draw(Canvas canvas) {
    // TODO Auto-generated method stub
    super.draw(canvas);

    canvas.drawRGB(255, 255, 255);

    for (PaintPath path : paths) {
        canvas.drawPath(path.path, path.paint);
    }
}

@Override
public boolean onTouchEvent(MotionEvent event) {
    // TODO Auto-generated method stub
    switch(event.getAction()) {
    case MotionEvent.ACTION_DOWN:
        Path current = new Path();
        current.moveTo(event.getX(), event.getY());
        paths.add(new PaintPath(current, stroke));
        break;

    case MotionEvent.ACTION_MOVE:
        PaintPath path = paths.get(paths.size() - 1);
        path.path.lineTo(event.getX(), event.getY());
        break;
    }

    return true;
}

public PaintView(Context context, AttributeSet attrs) {
    super(context, attrs);

    stroke.setStyle(Style.STROKE);
    stroke.setColor(Color.BLACK);
    stroke.setStrokeWidth(10);

    tUpdate = new Thread() {

        public void run() {
            while (run) {
                Canvas c = getHolder().lockCanvas();
                draw(c);
                getHolder().unlockCanvasAndPost(c);

                update();

                try {
                    sleep(10);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        }

    };

    getHolder().addCallback(this);
}

public void update() {
    // TODO Auto-generated method stub

}

@Override
public void surfaceChanged(SurfaceHolder holder, int format, int width,
        int height) {
    // TODO Auto-generated method stub

}

@Override
public void surfaceCreated(SurfaceHolder holder) {
    // TODO Auto-generated method stub
    tUpdate.start();
}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    // TODO Auto-generated method stub
    run = false;

    try {
        tUpdate.join();
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:36:38.793

我有一段时间没有碰过我的 Android SDK。所以我要从一个问题开始。

您说当按下 GUI 时应用程序会随机崩溃。在函数 onTouchEvent 中，哪个动作先发生，ACTION_DOWN 还是 ACTION_MOVE？我希望它定义明确，但我们不能假设。

我发现函数“PaintPath path = paths.get(paths.size() - 1)”中的代码很可疑，因为 path.size 在开始时可以为 0。

我认为密切监视 onTouchEvent 函数是个好主意，可以使用调试器。如果您一无所有，请记录消息。

解决随机间歇性问题是工作的一部分。从中学习并玩得开心。

# javascript - 输入字段的默认值“密码”，显示吗？

> ID：10660237
> 
> 赞同：3
> 
> 时间：2012-05-18T21:58:32.930
> 
> 标签：javascript, input

我正在使用此 js 显示默认密码，当用户单击它时，它会自动清除默认值，如果用户取消选择而不输入任何默认值，则会重新出现。

我将它用于我的所有领域，但显然对于密码来说它更棘手！:)

你会怎么做？

```
<input
    type="password"
    onblur="this.value=!this.value?'Password':this.value;"
    onfocus="this.select()"
    onclick="if (this.value=='Password'){this.value='';}"
    name="pwd"
    id="user_pass"
    class="input"
    value="Password"
    size="20"
    tabindex="20" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:04:05.737

你想好了`<input placeholder='Password' type='password'/>`吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T22:03:44.887

这是您的解决方案：http: [//jsfiddle.net/cgP5K/1/](http://jsfiddle.net/cgP5K/1/)

```
<input
  type="text"
  onblur="this.value=!this.value?'Password':this.value;"
  onfocus="this.select()"
  onclick="if (this.value=='Password'){this.value=''; this.type='password'}"
  name="pwd"
  id="user_pass"
  class="input"
  value="Password"
  size="20"
  tabindex="20" />​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:03:48.730

试试这个 - [http://roshanbh.com.np/examples/text-in-password/](http://roshanbh.com.np/examples/text-in-password/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T22:07:32.327

您需要创建一个纯文本输入作为占位符。此代码将为您执行此操作，而不会将任何变量暴露给全局范围：

```
​&lt;input id="pass-placeholder" type="text"​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ value="Password" />
<script type="text/javascript">
(function(){
    var pass_holder_el = document.getElementById('pass-placeholder');
    var pass_el = document.createElement('input');
    pass_el.type = 'password';

    pass_el.onblur = function(){
        if(!this.value)
            this.parentNode.replaceChild(pass_holder_el, this);
    }

    pass_holder_el.onfocus = function(){
        this.parentNode.replaceChild(pass_el, this);
        pass_el.focus();    
    }
})();
</script>​ 
```

[**JSFiddle**](http://jsfiddle.net/7RTyF/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-06T07:15:48.630

请使用以下解决方案，

```
<input name="password" class="input"value="Password" size="20"
  tabindex="20"  onclick="if(this.value==defaultValue){this.value=''; this.type='password'} else if(this.value==''){this.value=defaultValue; this.type='text'} " onblur="if(this.value==''){this.value=defaultValue; this.type='text'}"/> 
```

因为第一个解决方案效果很好，但是如果您清空密码字段，它将不会转换为其默认值，即文本。所以尝试上述解决方案。

# video-encoding - 如何编码/解码 MVC（多视图视频编码）视频？

> ID：10660238
> 
> 赞同：0
> 
> 时间：2012-05-18T21:58:43.470
> 
> 标签：video-encoding, codec, decoding

我一直在玩 3d 视频，听说 MVC 编解码器是一种更好的 3d 视频编码方式。我找到了诺基亚的 MVC 软件 (http://research.nokia.com/page/4988)，但它在尝试对我的视频编码一段时间后挂起。有谁知道该特定编解码器的任何其他替代方案或任何资源？

谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-31T02:22:37.507

您可以将 JVT 的编码器 JMVC 用于研究目的。它不是那么有效。软件手册在这里： http: [//mvclab.googlecode.com/files/SoftwareManual.doc](http://mvclab.googlecode.com/files/SoftwareManual.doc)

要下载此软件，您必须安装 CVS 客户端，例如 WinCVS。之后，您可以输入如下 CVS 访问参数，或者您可以在命令行 CVS 客户端中输入这两个命令

*   身份验证：pserver
*   主机地址：garcon.ient.rwth-aachen.de
*   路径：/cvs/jvt
*   用户名：jvtuser
*   密码：jvt.Amd.2
*   模块名称：jmvc

    ```
    cvs –d :pserver:jvtuser:jvt.Amd.2@garcon.ient.rwth-aachen.de:/cvs/jvt login
    cvs –d :pserver:jvtuser@garcon.ient.rwth-aachen.de:/cvs/jvt checkout jmvc 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T15:05:57.127

Intel Media SDK 支持 MVC 编码： http: [//software.intel.com/en-us/vcsource/tools/media-sdk](http://software.intel.com/en-us/vcsource/tools/media-sdk)

# javascript - 从选择标签中获取选定的值

> ID：10660241
> 
> 赞同：1
> 
> 时间：2012-05-18T21:59:05.427
> 
> 标签：javascript

当我从选项中选择一个值并单击一个按钮时，我想使用 javascript 获取所选值。我究竟做错了什么？我的值始终为 1。

```
 <select id="aand_select">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
    </select> 
```

// javascript代码

```
var e = document.getElementById("aand_select");
var quantity= e.options[e.selectedIndex].value; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:12:46.637

这显然会做

```
var e = document.getElementById("aand_select");
e.addEventListener('change', function(){
  var quantity= e.options[e.selectedIndex].value;
  console.log(quantity);
},false);​​​​​​​​​​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:10:02.970

确保您在适当的时间调用 javascript。例如，如果您仅在页面加载时调用它，则该值永远不会改变。确保您是从 onClick() 或其他事件调用它。

# python - 为什么我要在重组文本中编写文档测试？

> ID：10660246
> 
> 赞同：0
> 
> 时间：2012-05-18T21:59:38.867
> 
> 标签：python, restructuredtext, doctest

另一种问这个问题的方法：如果我用 reST 编写文档测试，我可以将它用于 Sphinx 或其他自动文档工作吗？

背景：我不知道如何使用 Sphinx，也没有太多的 reST 经验，所以我想知道是否可以在除 Sphinx 之外的其他地方使用 reST 编写的文档测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T10:14:41.950

> 为什么我要在重组文本中编写文档测试？

您并没有真正“以重组文本”编写测试。交互式示例是测试用例，与周围标记的外观无关；它可以是 reST，也可以是 Markdown 或 LaTeX 之类的其他东西。

reST 已被采用作为 Python 文档的[“官方”标记语言](http://docs.python.org/devguide/documenting.html)，但您没有义务使用它。

> 那么为什么 doctest 文档中 doctest.testfile() 的简单用法示例然后作为 reST 文件给出？

Doctest 是一种通过检查文档中嵌入的交互式示例的正确性来测试代码的方法，因此[解释 doctest 模块的示例](http://docs.python.org/dev/library/doctest.html#simple-usage-checking-examples-in-a-text-file)还包括 reST 标记是有意义的。

您可以在仅包含交互式输入/输出示例且不包含其他内容的文本文件上运行 doctest。这些示例可以用作轻量级单元测试，但它们本身不太适合作为文档。

> 我想知道我是否可以在除 Sphinx 之外的其他地方使用 reST 编写的文档测试？

即使您不使用 Sphinx 作为文档，拥有可测试的代码示例也会很有用。

如果您正在寻找了解 reST 的替代文档工具，请查看 docutils（Sphinx 是基于它的，顺便说一句）及其[前端工具](http://docutils.sourceforge.net/docs/user/tools.html)，例如 rst2html.py。

另一个可能感兴趣的工具是[rst2pdf](http://code.google.com/p/rst2pdf/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-25T16:23:36.193

向您的文档添加 doctest 有助于确保您的文档中的代码实际按预期工作。因此，您正在测试您的文档。对于一般的代码测试，根本不推荐使用 doctests。

# jquery - 如何使用jquery选中和取消选中全选复选框

> ID：10660247
> 
> 赞同：0
> 
> 时间：2012-05-18T21:59:41.643
> 
> 标签：jquery, jquery-selectors, checkbox

我有一个用于选择所有其他复选框的全选复选框的切换事件，但全选复选框不会选中并取消选中如何解决此问题，代码如下：

```
$('#selectAllCheck').toggle(function () {
            $('input:checkbox').attr('checked', 'checked');
            }, function () {
                $('input:checkbox').removeAttr('checked');
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:10:21.707

这是你想要的吗？

[http://jsfiddle.net/vjxHs/](http://jsfiddle.net/vjxHs/)

```
$('#selectAllCheck').click(function () {  
    if ($(this).attr('checked')=='checked')
    {        
        $('input:checkbox').attr('checked', 'checked');
    } else {
        $('input:checkbox').removeAttr('checked');
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T22:12:06.247

```
$('#selectAllCheck').click(function() {
   var status = $(this).attr('checked');
    if( ! status) {
        status = false;
    }
   $('input:checkbox').attr('checked',status);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:12:33.820

嗯，它应该与您的切换事件有关，我使用悬停并且您的代码正常工作

```
 $('#selectAllCheck').hover(
                    function () {
                        $('input:checkbox').attr('checked', 'checked');
                    }, 
                    function () {
                        $('input:checkbox').removeAttr('checked');
                    }
                ); 
```

几乎相同的代码..除了悬停

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T22:12:57.590

使用这个
**Javascript：**

```
<script type='text/javascript'>//<![CDATA[
    $(window).load(function () {
        var $checkboxes = $('input[type=checkbox]');
        $('#selectAllCheck').toggle(function () {
            $checkboxes.attr('checked', 'checked');
            return false;

        }, function () {
            $checkboxes.removeAttr('checked');
            return false;
        });
    });//]]>  

</script> 
```

# c# - 自动 mdb 到 sql server

> ID：10660249
> 
> 赞同：2
> 
> 时间：2012-05-18T22:00:28.773
> 
> 标签：c#, entity-framework, ms-access, dataset

我意识到您可以使用 upsize 向导来正常转换它，但由于这是一个服务器端进程，我们每天都从第三方获取 mdb 文件，我必须能够在不接触的情况下摄取这些文件建筑学。

目前，我将着手手动编写（呃），我通过数据源读取访问数据库，并通过批量插入或实体框架将其打入 sql server。我真的希望有更好的方法来做到这一点。我愿意接受很多创造性的方法，因为有很多表格和大量数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:12:01.893

我想到了许多方法，它们确实都涉及自定义编程，但应该相对简单且易于实现。

1.  从另一个 Access DB，以编程方式（即，使用 VBA）打开源 DB。在源数据库中创建与 SQL 后端的链接表。将数据从源数据库复制到链接表（使用`insert dest select * from source`）。
2.  使用`OPENDATASET`或`OPENROWSOURCE`与 SQL Server 直接连接到 Access DB 并复制数据。您可以再次使用`insert dest select * from source`来复制数据，或`select * into dest from source`从源数据创建新表。这涉及调整 sql server 上的一些系统设置，因为默认情况下它没有启用，但是一些谷歌搜索应该让你开始。
3.  在 .NET 程序中，使用`SqlBulkCopy`（用于自动化的 .NET 类`bcp`）从 Access 数据库上传数据。只需直接使用 ADO.Net 处理数据，因为没有理由仅仅为了将数据从一个源迁移到另一个源而构建整个 EF 层。

我在各种项目中使用了上述所有三种方法的变体，但是对于移动大量表，我发现选项 #2 相对有效。如果您的表名每天都是动态的，它将涉及一些动态 SQL 代码，但如果它们是静态的，您应该只需要编写一次逻辑并使用一个参数来读取文件名。

# php - 表中具有可用时间的时间段（不是表中的时间段）

> ID：10660250
> 
> 赞同：-1
> 
> 时间：2012-05-18T22:00:40.223
> 
> 标签：php, sql

PHP/MySQL 选择

我有一张桌子，上面有特定日期的会议室可用时间。Temp_Res 获取正在进行预订时的时间戳（以锁定这些行）。如果要预订的会议时间为 2 小时，我想获得所有可能的时间段。

日 时 Temp_Res
22 8 0000-00-00 00:00:00
22 9 0000-00-00 00:00:00
22 10 0000-00-00 00:00:00
22 11 2012-05-18 22:02： 00
22 12 2012-05-18 22:02:00
22 13 2012-05-18 22:02:00
22 14 0000-00-00 00:00:00
22 15 0000-00-00 00:00:00
22 16 0000-00-00 00:00:00
22 17 0000-00-00 00:00:00

因此，如果需要的时间槽是 2 小时，则只有 8、9、14、15、16 小时是输出。（然后我会使用小时并添加 2 来获得插槽：8-10、9-11、14-16、15-17 和 16-18）
如果时间段是 3 小时，则只有 8、14、15 小时会是输出和插槽：8-11、14-17、15-18....等
为了能够在 SELECT 中执行此操作（如果可能），必须有一种方法可以查看表中的其他行以确定是否应包括特定行。

## 1\. 是否可以查看其他行并使用带有 WHERE （或类似）的 SELECT 来执行此操作？

## 2\. 如果可能的话，请你引导我走向正确的方向吗？

## 3\. 其他解决方案/想法（以下除外）也非常感谢！

否则我必须通过以下方式解决它：
a）创建一个额外的时隙表
b）有一个额外的列来说明该特定行的最大时隙，见下文。

日时槽 Temp_Res
22 8 3 0000-00-00 00:00:00
22 9 2 0000-00-00 00:00:00
22 10 1 0000-00-00 00:00:00
22 11 0 2012-05- 18 22:02:00
22 12 0 2012-05-18 22:02:00
22 13 0 2012-05-18 22:02:00
22 14 4 0000-00-00 00:00:00
22 15 3 0000- 00-00 00:00:00
22 16 2 0000-00-00 00:00:00
22 17 1 0000-00-00 00:00:00

SELECT Day, Hour FROM table
WHERE Slot>=2 AND Temp_Res<"2012-05-18 22:00:00"
GROUP BY Day, Hour

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T22:20:49.077

我建议使用开始时间和会议长度来计算结束时间，这相当于“需要空闲才能进行此预订的最后一小时”。然后，您可以使用内部联接仅选择开始时间，其中每小时到结束时间也未预订。对于四个小时的会议，您的查询可能如下所示：

```
SELECT start.day, start.hour from table as start 
INNER JOIN table as hour1
    ON ((hour1.hour = start.hour + 1) AND (hour1.TempRes = '0000-00-00 00:00:00'))
INNER JOIN table as hour2
    ON ((hour2.hour = start.hour + 2) AND (hour2.TempRes = '0000-00-00 00:00:00'))
INNER JOIN table as hour3
    ON ((hour2.hour = start.hour + 3) AND (hour3.TempRes = '0000-00-00 00:00:00'))
WHERE table.TempRes = '0000-00-00 00:00:00' 
```

您可以在 PHP 中使用循环将所需数量的内部连接子句添加到查询文本中（并且因为您使用的是您自己计算的变量，所以您不必担心注入）。它将永远是（会议持续时间 - 1）。

如果有人试图安排一个将在午夜进行的会议，这将不返回任何开放时间，但如果这是不希望的，您可以轻松编写逻辑来适当地增加 day 变量。

# php - 在 PHP 上传时检查病毒的选项有哪些？

> ID：10660260
> 
> 赞同：20
> 
> 时间：2012-05-18T22:02:15.933
> 
> 标签：php, file-upload, antivirus, virus

我正在寻找如何通过 PHP 检查上传的文件是否有病毒。存在哪些选项，每个选项的优缺点等。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-18T22:09:30.237

[ClamAV](http://clamav.net)是一种免费的防病毒软件，通常用于服务器应用程序。

[php-clamav](http://sourceforge.net/projects/php-clamav/)是将 ClamAV 绑定到 PHP 的扩展。你可以查看他们的[文档](http://php-clamav.sourceforge.net/)。

我找到了[关于如何使用 clamav 作为 Zend 框架验证器的教程，](http://phpmaster.com/zf-clamav/)其中已经包含有关如何验证上传文件的说明。本教程还应该帮助您在其他框架或体系结构上使用它。

您还可以通过其命令行界面调用 clamav，使用`clamscan`. 这需要安装 clamav 而不是 PHP 扩展。在 PHP 端，您可以`shell_exec('clamscan myuploadedfile.zip');`解析输出。以 结尾的行`OK`是安全文件，以 结尾的行`FOUND`是恶意文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-18T22:09:16.180

您可以使用 VirusTotal.com，他们有一个 API，您可以使用它来上传文件，他们将使用多个病毒扫描程序对其进行扫描。

[https://www.virustotal.com/](https://www.virustotal.com/)

（不幸的是，他们的网站目前正在维护中，但我希望它很快就会恢复）

# c# - 数据库中的日期时间值

> ID：10660261
> 
> 赞同：1
> 
> 时间：2012-05-18T22:02:39.460
> 
> 标签：c#, sql-server

我将日期时间更新为数据库。现在是 2012 年 5 月 2 日。但是，当我想将该数据库中的这个值显示到文本框中时，它会显示：05/02/2012。

请帮我解决这个问题。我想在文本框中显示它的值，就像格式已更新：2010 年 5 月 2 日

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:07:33.690

如果您将数据作为`DateTime`对象，则可以使用其`ToString(string)`重载格式字符串“d/M/yyyy”或此处描述的任何其他格式来格式化其输出：http: [//msdn.microsoft.com/en-us /图书馆/8kb3ddd4.aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:09:06.370

```
SELECT CAST(DATEPART(MM,GETDATE()) AS VARCHAR(2))+'/'
+CAST(DATEPART(DD,GETDATE()) AS VARCHAR(2))+'/'
+CAST(DATEPART(YYYY,GETDATE()) AS VARCHAR(4)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-03T21:05:52.367

试试这个 ：

```
Textbox1.Text=datevalue.ToString("MM/dd/yyyy"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T22:06:30.940

试试这个`ToString("d/M/yyyy")`给出所需的格式。

如果您可以向我展示您的代码，那么我可以为您提供更多帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T22:15:37.417

您可以`ToString("MM/dd/yyyy")`在分配值时使用。
如果您的文本框是`Textbox1`并且您的日期值存储在`DateTime`对象**datevalue**中，那么您应该这样做。

`Textbox1.Text=datevalue.ToString("MM/dd/yyyy");`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-18T22:16:57.017

当您将此数据作为日期时间类型存储到 sql server 中时，原始格式将丢失。但是，如果您想显示不带 0 的数据，那么您可以为您的文本框执行此操作。

mytextbox.Text = dt.Month.ToString().TrimStart('0') + "/" + dt.Day.ToString().TrimStart('0') + "/" + dt.Year.ToString()

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-18T22:17:59.227

在到达您的应用程序之前使用复杂的查询处理数据或预先格式化数据通常是不好的做法，因为您会失去结果的灵活性。

来自 SQL 的数据被正确格式化为通用 DateTime 标记 - 允许应用程序对其进行按摩以用于显示目的，正如@Chris-Sinclair 通过示例链接所建议的那样。

如果使用 WPF，最好的方法是允许 UI 元素按照它认为合适的方式格式化文本，这样类实例的内容保持不变。它仍然是一个 DateTime 对象，因此您可以在不丢失全部价值的情况下进行 DateTime“数学”或其他操作。

这是一个来自[Elegantcode.com](http://elegantcode.com/2009/04/07/wpf-stringformat-in-xaml-with-the-stringformat-attribute/)的示例，其中 WPF UI 元素决定了它的格式：

```
<TextBlock Text="{Binding Date, StringFormat={}{0:MM/dd/yyyy hh:mm tt}}" /> 
```

为了您的特定目的，正确的行将显示为

```
<TextBlock Text="{Binding Date, StringFormat={}{0:M/d/yyyy hh:mm tt}}" /> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-31T20:19:24.437

为此，最好的方法是将日期时间作为字符串保存到数据库中。然后在检索字符串后，我可以将其转换为日期时间。它将显示正确的格式。

# web-services - 从 Web 应用程序向服务器发送位置更新

> ID：10660262
> 
> 赞同：0
> 
> 时间：2012-05-18T22:02:41.150
> 
> 标签：web-services, html

我编写了一个 Web 应用程序，其中包含几个 JSP 页面和在 Tomcat 服务器上运行的 Java servlet。该应用程序需要能够每 x 秒向其中一个 Servlet 发送位置更新。我找到了 html5 watchPosition(sucess_callback, error_callback) 函数来从网页获取位置更新。我在想.. 一旦我从这个函数获得更新.. 我将把代码放在回调函数中以将更新发送到 Servlet。但是将 watchPosition 函数添加到应用程序中的每个 JSP 页面似乎很麻烦。无论用户在应用程序中查看什么网页，向服务器发送定期 GPS 更新的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T20:07:59.947

我不确定您是否可以创建任何在用户加载另一个网页时继续发送位置数据的代码。网络是一个无状态的东西，当用户打开另一个页面时，会执行其他代码。我怀疑 JSP 是发送到手机时生成 HTML 的代码库。我的想法是将位置发送功能添加为 Javascript 中的 AJAX 请求。如果您的 web 应用程序基于页面之间的许多链接并且完全加载，那么实现 Ajax 以将新内容加载到页面中也是一个想法。

# asp.net-mvc-3 - Html ActionLink 方法有时包含 ID

> ID：10660264
> 
> 赞同：1
> 
> 时间：2012-05-18T22:02:47.453
> 
> 标签：asp.net-mvc-3

我的控制器上有两种方法

Function FollowUp(id As String) As ActionResult 和 Function Details(id As String) As ActionResult

当我写 <%:Html.ActionLink("FollowUp", "FollowUp")%> 生成的链接不包括 id （我得到 /Project/FollowUp）

但是当我写 <%:Html.ActionLink("Details", "Details")%> 生成的链接确实包含 id （我得到 /Project/Details/25）

谁能解释为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T01:32:39.070

如果您为带有参数的路由创建链接，如果您当前的路由数据包含该变量，那么相同的值将包含在您的 URL 中。例如：如果您只有标准路由：

```
routes.MapRoute(
     null,
     "{controller}/{action}/{id}", // URL with parameters
     new { controller = "Home", action = "Index", id = UrlParameter.Optional }
); 
```

并且当前位于/home/index/25，那么如果您创建一个新链接`@Html.ActionLink("test","testing")`，那么它将包括当前id：/home/testing/25。我可以通过两种方式认为此默认 ID 不会显示：

1) 您有不同的“FollowUp”路由，不包含 {id} 参数。

```
routes.MapRoute(
     null,
     "Project/FollowUp",
     new { controller = "Project", action = "FollowUp" }
); 
```

2) 您正在一个页面上创建“FollowUp”链接，该页面当前没有包含在路由中的 id。（比如 home/index 而不是 home/index/25）

# python - Python程序变成标准程序集？

> ID：10660266
> 
> 赞同：11
> 
> 时间：2012-05-18T22:02:58.460
> 
> 标签：python, assembly

是否可以将 Python 程序转换为[IEEE-694](http://standards.ieee.org/findstds/standard/694-1985.html)等微处理器标准汇编语言？汇编语法接近[这个](https://stackoverflow.com/questions/2874731/program-on-assembly) 或另一个：[http ://www.ethicalhacker.net/content/view/152/2/](http://www.ethicalhacker.net/content/view/152/2/)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-18T22:14:13.877

[将 python 编译为 C](https://stackoverflow.com/q/2525518/102937)，然后使用您选择的 C 编译器将其编译为汇编。

或者，使用[PyPy](http://pypy.org/)，将 LLVM 指定为目标，并使用[LLVM 静态编译器](http://llvm.org/docs/CommandGuide/llc.html)为您的目标架构生成汇编语言。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-18T23:19:40.560

与 C、FORTRAN、COBOL 等不同。支持 lambda 演算或自动内存管理的语言不能直接编译为汇编。然而，解释器可以在微码或引导程序中提供，以弥合差距并允许“编译”Python、LISP 等（某些操作，如垃圾收集，仍然在打包到编译的二进制文件。）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-18T22:20:03.240

由于 Python 是一种动态类型语言，因此只有在汇编程序使用 Python 的运行时环境/库来动态获取对象时，这才有可能。

所以只有一些开销才有可能。

[但是PyPy](http://pypy.org/)项目中有 RPython 。它是 Python 语言的一个受限子集（它不再是动态类型的，并且缺少 Python 标准库中的大多数模块）。RPython 程序可以翻译成机器代码（AFAIK 它生成 C 代码作为中间代码）。

Python 本身为其虚拟机生成中间代码。如果您想查看此代码，请使用 Python 标准库中的[dis](http://docs.python.org/library/dis.html)模块。这会生成 Python 函数的类似程序集的表示。请记住，“真正的”微处理器将无法使用它，并且结果可能会随着您使用的 Python 版本而改变。

# bash - Mac OS X Lion 10.7 中的终端应用程序卡住了？

> ID：10660268
> 
> 赞同：0
> 
> 时间：2012-05-18T22:03:11.553
> 
> 标签：bash, scripting, terminal

几天前，我尝试创建一个 shell 脚本，它可以打开我下载文件夹中的所有种子文件。我不确定我是否正确写入了 sh 文件，从那时起我收到了以下消息：

```
Last login: Fri May 18 22:54:28 on ttys000
LSOpenURLsWithRole() failed for the application /Users/Alex/Downloads/(Demonoid.me)-Adobe_Master_Collection_CS5_(OS_X)__12302562.8934.torrent
with error -10810 for the files
/Users/Alex/Downloads/Coda_1_6_2_[_Plist]_[Serial]_O-Demonoid.me-O_12302562.8934.torrent,
/Users/Alex/Downloads/Coda_1_7_3_[k'd]-((Demonoid.me))_12302562.8934.torrent,
/Users/Alex/Downloads/[kat.ph]grid.systems.in.graphic.design.josef.muller.brockmann.torrent,
and /Users/Alex/Downloads/[kat.ph]pixie.lott.cry.me.out.mp3.housezz.torrent.
job done
/bin/bash: line 8: end: command not found 
```

[处理完成]

我不能在终端做任何事情。我不知道该怎么办。关于它的任何见解？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T23:01:05.203

*   打开一个终端并让它挂起。
*   打开终端首选项菜单（Command-逗号）。
*   在“启动”选项卡中，记住您当前的 shell 设置。
*   选择 Bash 或 Sh 以外的 shell（例如`/bin/tcsh`，这是一种绝望的措施，而且只是暂时的）。
*   关闭锁定的终端。
*   打开一个新终端（Command-N）。
*   那应该给你一个命令提示符。
*   在该窗口中，编辑您的`.profile`或`.bashrc`添加 Torrent 行的任何内容。
*   删除 Torrent 相关的行。
*   返回终端首选项。
*   将外壳重置为`/bin/bash`.
*   尝试再次打开终端窗口。

在尝试再次添加 Torrent 时，请编写一个 shell 脚本。调试它。仅当您确定它正确、稳定、可靠并且不会锁定您的终端时，才将其放入您的个人资料中。然后用已经打开的终端进行测试——打开一个新的终端进行测试。然后你仍然有一个解锁的终端，你可以解决问题。

如果您有图形 Vim（Gvim 或 MacVim），您可以启动它然后编辑您的`.profile`，而无需调整终端首选项。

# drupal - 允许用户向 Drupal 中的节点动态添加字段和值

> ID：10660271
> 
> 赞同：0
> 
> 时间：2012-05-18T22:03:21.017
> 
> 标签：drupal, cck, drupal-taxonomy

我试图想出一种方法，让用户只使用给定内容所需的字段来填充表单。

例如，我有一个名为“研究项目”的内容类型，我想为每个内容添加一系列测量值。

例如。项目 1：水样

测量：收集的加仑水 - 20 gal

收集时的环境温度 - 75 华氏度

水中发现 PPM 铅 - 2 ppm

测量标准将提前输入系统，他们将从下拉列表中选择它。我想表单的 UI 看起来像这样：

从下拉列表中选择测量 > 字段以输入值 + 链接以添加无限的新测量和值行

测量值因项目而异，其中有很多，并且总是添加新的测量值，因此将每个潜在的测量值添加为自己的 CCK 字段是不切实际的。还有太多不同类型的项目，无法使每个项目的内容类型实用。所以基本上我正在寻找构建表单和动态填充结果的能力。我该怎么做呢？我可以将我的测量值作为分类术语输入，但是我如何为每个值分配和存储一个值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:30:28.250

有两个功能

field_create_field() 可以自己创建字段 a。

field_create_instance() - 将字段绑定到包。[这篇文章的](https://drupal.stackexchange.com/questions/7142/assign-fields-programatically-to-custom-node-defined-by-custom-module)例子：

```
$field = array(
    'field_name' => 'field_' . $vocabulary->machine_name, 
    'type' => 'taxonomy_term_reference',
    'cardinality' => FIELD_CARDINALITY_UNLIMITED, 
    'settings' => array(
      'allowed_values' => array(
        array(
          'vocabulary' => $vocabulary->machine_name, 
          'parent' => 0,
        ),
      ),
    ),
  );
  field_create_field($field);

  $instance = array(
    'field_name' => 'field_' . $vocabulary->machine_name, 
    'entity_type' => 'node', 
    'label' => 'Tags', 
    'bundle' => 'article', 
    'description' => $vocabulary->help, 
    'widget' => array(
      'type' => 'taxonomy_autocomplete', 
      'weight' => -4,
    ), 
    'display' => array(
      'default' => array(
        'type' => 'taxonomy_term_reference_link', 
        'weight' => 10,
      ), 
      'teaser' => array(
        'type' => 'taxonomy_term_reference_link', 
        'weight' => 10,
      ),
    ),
  );
  field_create_instance($instance); 
```

# java - 自定义注释 JSF

> ID：10660273
> 
> 赞同：2
> 
> 时间：2012-05-18T22:03:29.010
> 
> 标签：java, jsf, jsf-2, annotations, jaas

我想制作一个自定义注释来检查我的 JSF Web 应用程序的某些功能的安全性。对于安全性，我将 Tomcat 安全性与 JaaS 结合使用，因此我没有应用程序管理的安全性可供使用。

真正想要做的是在 Spring Security (@Secured("role")) 等 Backing Bean 中为我的方法添加注释。我的安全系统已实现，因此每个功能都是一个角色，您可以动态创建“用户角色”，这些角色存储在数据库中，当有人登录该“用户角色”中的所有（功能）角色时，将在 tomcat 安全性中设置作为角色。

所以现在我有这段代码来检查我的用户是否可以访问该功能：

```
 public static void checkSecurity(final String function) {
    final FacesContext facesContext = FacesContext.getCurrentInstance();
    try {
        if (facesContext.getExternalContext().getRemoteUser() == null) {
            facesContext.getExternalContext().redirect("login.xhtml");
            return;
        }
        if (!facesContext.getExternalContext().isUserInRole(function)) {
            facesContext.getExternalContext().redirect("restricted.xhtml");
            return;
        }
    } catch (final Exception ex /* Mandatory "IOException e" will be caught + all other exceptions. */) {
        facesContext.getExternalContext().setResponseStatus(403); // HTTP Status 403: Forbidden. Can also throw 401.
        facesContext.responseComplete();
    }
} 
```

现在我必须调用这个 SecurityUtil.checkSecurity("name_of_function"); 在每一种方法中。但我想要一个像@CustomSecurity("function_name_role") 这样的注释。

```
 @Target(ElementType.METHOD)
   @Retention(RetentionPolicy.RUNTIME)
   public @interface CustomSecurity {
     // Single Element called value.
      String value();
   } 
```

当一个方法有这个注解时， checkSecurity 函数必须自动执行。所以我必须在某一点上扫描这个注释，或者做一些动作监听器。JSF 应该对此有一些选择，但我在这方面找到的所有论坛都没有真正的帮助。

有人有一些想法吗？

**编辑：** 我试过[这个博客](http://cameotutorials.blogspot.com/2010/03/beginning-java-ee-6-tutorial-part-3.html)它可以工作，但只适用于组件的操作（当你没有角色时，组件不会呈现）。那么当人们试图侵入 JSF 结构时，这是多么安全。我宁愿让它在每种方法上运行。

```
 public class SecurityActionListener extends ActionListenerImpl implements ActionListener {

    private static final Logger LOGGER = FacesLogger.APPLICATION.getLogger();

    @SuppressWarnings("unused")
    @Override
    public void processAction(final ActionEvent event) {

        final FacesContext context = FacesContext.getCurrentInstance();
        final Application application = context.getApplication();
        final ConfigurableNavigationHandler navHandler = (ConfigurableNavigationHandler) application.getNavigationHandler();

        // Action stuff
        final UIComponent source = event.getComponent();
        final ActionSource actionSource = (ActionSource) source;
        MethodBinding binding;

        binding = actionSource.getAction();
        final String expr = binding.getExpressionString();
        if (!expr.startsWith("#")) {
            super.processAction(event);
            return;
        }

        final int idx = expr.indexOf('.');
        final String target = expr.substring(0, idx).substring(2);
        final String t = expr.substring(idx + 1);
        final String method = t.substring(0, (t.length() - 1));

        final MethodExpression expression = new MethodExpressionMethodBindingAdapter(binding);
        final ELContext elContext = context.getELContext();
        final ExpressionFactory factory = context.getApplication().getExpressionFactory();

        final ValueExpression ve = factory.createValueExpression(elContext, "#{" + target + '}', Object.class);
        final Object result = ve.getValue(elContext);

        // Check if the target method is a secured method
        // and check security accordingly
        final Method[] methods = result.getClass().getMethods();
        for (final Method meth : methods) {
            if (meth.getName().equals(method)) {
                if (meth.isAnnotationPresent(CustomSecurity.class)) {
                    final CustomSecurity securityAnnotation = meth.getAnnotation(CustomSecurity.class);
                    System.out.println("Function to check security on: " + securityAnnotation.value()); // TODO TO LOG
                    SecurityUtil.checkSecurity(securityAnnotation.value());
                } else {
                    super.processAction(event);
                }
                break;
            }
        }
    }

} 
```

这在 faces-config.xml 中： `<action-listener> com.nielsr.randompackagebecauseofnda.SecurityActionListener </action-listener>`

[这个博客](https://blogs.oracle.com/enterprisetechtips/entry/improving_jsf_security_configuration_with)也可能是一个答案，但我不知道它如何与我的 JaaS Tomcat 安全性一起工作，因为安全性位于一个单独的项目中，作为独立 JAR 部署在 tomcat lib 文件夹中。

但我实际上不知道我必须保护我的 Beans。因为我已将 Web.xml 中 1 页上的所有功能（又名角色见上文）配置为安全约束。并且仅当您必须对该组件具有权限或“function_role”时，我才会在页面上呈现组件。那么这是否足够安全？或者，如果有人有权使用页面上的功能，他是否可以自己渲染组件并入侵我的网站？

我对 JSF 并不熟悉，知道这一点，Controller 和 View 之间的那个额外的 JSF 抽象层发生了什么？（我更像是一名 Spring MVC 开发人员，但由于要求我必须使用 JSF，但很高兴扩大我的知识。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T11:25:14.833

您可以使用“扫描您的注释”

```
http://code.google.com/p/reflections/ 
```

问候

# android - 我如何知道主屏幕是否清晰？

> ID：10660275
> 
> 赞同：3
> 
> 时间：2012-05-18T22:03:44.390
> 
> 标签：android

我有一项在 Android 上运行的服务，我需要知道是否有任何应用程序处于焦点位置，或者“桌面”（主屏幕）是否处于焦点位置。我不知道这是否是指代手机主屏幕的正确词。我怎么知道这是焦点还是其他应用程序？

在服务内部，我有这段代码来获取正在运行的任务：

```
ActivityManager am = (ActivityManager) this.getSystemService(ACTIVITY_SERVICE);
// get the info from the currently running task
List<ActivityManager.RunningTaskInfo> taskInfo = am.getRunningTasks(1);
ComponentName componentInfo = taskInfo.get(0).topActivity; 
```

我怎么知道`componentInfo`这是否是桌面？在模拟器上，componentInfo.getPackageName() 返回`com.android.launcher`，但在 Galaxy S1 中（我只在这款手机中测试过）返回别的东西。

还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-08-28T18:52:09.963

```
ActivityManager am = (ActivityManager) getSystemService(ACTIVITY_SERVICE);
List< ActivityManager.RunningTaskInfo > taskInfo = am.getRunningTasks(1);
ComponentName currentTask = taskInfo.get(0).topActivity;

final Intent mainIntent = new Intent(Intent.ACTION_MAIN, null);
mainIntent.addCategory(Intent.CATEGORY_HOME);
mPackageManager = getPackageManager();

List<ResolveInfo> appList = mPackageManager.queryIntentActivities(mainIntent, 0);
for(int i = 0; i < appList.size(); i++) {
    ResolveInfo apl = appList.get(i);
    if(currentTask.getPackageName().equals(apl.activityInfo.packageName)) {
        Log.e(TAG, "ONHOMESCREEN");
    }
} 
```

在 AndroidManifest.xml 你需要权限

```
<uses-permission android:name="android.permission.GET_TASKS"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-09T11:20:14.420

试试这个功能，

```
 public boolean isUserIsOnHomeScreen()
{
    ActivityManager manager = 
            (ActivityManager) this.getSystemService(ACTIVITY_SERVICE);
    List<RunningAppProcessInfo> processes = manager.getRunningAppProcesses();
    for (RunningAppProcessInfo process : processes)
    {
        if(process.pkgList[0].equalsIgnoreCase("com.android.launcher"))
        {
            return true;
        }
        else
        {
            return false;
        }

    }
    return false;

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-19T14:19:40.010

如果您想在“主屏幕处于焦点”时获得控制，请实现主屏幕。

# python - 如何使用 os.walk 和 fnmatch 改进搜索

> ID：10660284
> 
> 赞同：4
> 
> 时间：2012-05-18T22:04:21.533
> 
> 标签：python, image, search, os.walk

我正在使用`os.walk`和`fnmatch`过滤器来搜索电脑硬盘中的所有图像文件。这工作得很好，但非常慢，因为搜索 +-70000 张图像大约需要 9 分钟。

关于优化此代码以更快运行的任何想法？还有其他建议吗？

顺便说一句，我正在使用 python 2.7.2。

```
import fnmatch
import os

images = ['*.jpg', '*.jpeg', '*.png', '*.tif', '*.tiff']
matches = []

for root, dirnames, filenames in os.walk("C:\\"):
    for extension in images:
        for filename in fnmatch.filter(filenames, extension):
            matches.append(os.path.join(root, filename)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T22:55:02.257

我不是那些总是求助于`re`锤子来解决所有问题的正则表达式疯子之一，但这实际上在我的测试中比你的 fnmatch 版本快两倍多：

```
import os
import re

matches = []

img_re = re.compile(r'.+\.(jpg|png|jpeg|tif|tiff)$', re.IGNORECASE)

for root, dirnames, filenames in os.walk(r"C:\windows"):
    matches.extend(os.path.join(root, name) for name in filenames if img_re.match(name)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T22:20:19.410

Python 对我来说看起来很不错。

你可以尝试

```
for root, dirnames, filenames in os.walk("C:\\"):
    for extension in extensions:
        matches.extend(os.path.join(root, filename) for filename 
                       in fnmatch.filter(filenames, extension)) 
```

如果这没有影响（我想不会），我相信您的硬盘已成为该过程的瓶颈（请记住，磁盘 == 慢，您正在迭代并列出系统中每个目录的文件） .

如果硬盘*是*瓶颈，那么多个`dir /s ...`语句的结果绝对不应该比 Python 解决方案快得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T23:05:40.280

```
import os
extns = ('.jpg', '.jpeg', '.png', '.tif', '.tiff')
matches = []
for root, dirnames, fns in os.walk("C:\\"):
    matches.extend(
        os.path.join(root, fn) for fn in fns if fn.lower().endswith(extns)
        ) 
```

# ruby-on-rails-3 - Rails 3按自累计数排序范围

> ID：10660285
> 
> 赞同：2
> 
> 时间：2012-05-18T22:04:22.867
> 
> 标签：ruby-on-rails-3, count, scope, sql-order-by

所以我有一个锦标赛的结果表，其中同一个玩家可能会发生多场比赛。

所以一些样本数据可能是：

结果

```
Player_ID | Match_ID|Win|Elapsed_Time|etc..
1         |    1    |T  | 1:00       |etc..
2         |    1    |F  | 1:00       |etc..
1         |    2    |T  | 3:00       |etc..
3         |    2    |F  | 3:00       |etc.. 
```

我想准备一个范围，它将计算为每个玩家设置为 True 的 Win 字段，并按该计数字段分组。

所以伪代码就像......

范围 :most_wins, :all, :order_by => "Count(Player Wins)"

这甚至可能还是我应该重新考虑我的数据库结构？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:56:43.497

首先也是最重要的：[命名作用域已死](http://www.railway.at/2010/03/09/named-scopes-are-dead/)

我建议您执行以下操作：

```
class Players < ActiveRecord::Base
  ....
  def self.with_win_count
    #inner join if you want to filter out those who doesn't have any match, otherwise is should be left outer 
    joins("inner join (select Player_ID, count(Match_ID) as win_count from Results where Win = true group by Player_ID) t on (t.Player_ID = Player.ID)")
  end
end

#somewhere in controller you would do
best_players = Player.with_win_count.where("win_count > ?", [10]).order("win_count DESC") 
```

如果您希望它出现在结果表中：

```
class Results < ActiveRecord::Base
  ....
  def self.with_win_count
    joins("inner join (select Player_ID, count(Match_ID) as win_count from Results where Win = true group by Player_ID) t on (t.Player_ID = Results.Player_ID)")
  end
end 
```

这会起作用，但我觉得它有点难看。

如果您想要嵌套查询中的条件计数，简单的方法是：

```
class Players < ActiveRecord::Base
  ....
  def self.with_match_count(conditions)
    #inner join if you want to filter out those who doesn't have any match, otherwise is should be left outer 
    joins("inner join (select Player_ID, count(Match_ID) as match_count from Results where #{conditions} group by Player_ID) t on (t.Player_ID = Player.ID)")
  end
end
some_players = Player.with_match_count("Win = true").where("match_count > ?", [10]).order("match_count DESC") 
```

**！！！**`conditions`请注意，如果参数将直接由用户输入构建，则很容易发生 SQL 注入。

# java - 带有冒号的 Apache HttpClient HttpGet url

> ID：10660286
> 
> 赞同：1
> 
> 时间：2012-05-18T22:04:30.180
> 
> 标签：java, httpclient, url-encoding, apache-httpclient-4.x

我试图在我的一个参数中发出一个带有冒号的 get，但它失败了，`unknownHostException`这是我的代码：

```
String id = "{\"ID\":\"John Doe\"}";
String encodedID = URLEncoder.encode(id, "UTF-8").replace("+", "%20");
endpoint="https://127.0.0.1/getResourceNameToUse?id=" + encodedID;
HttpResponse response = new HttpResponse();
HttpGet httpget = new HttpGet(endpoint);
response = httpclient.execute(httpget, new RESTResponseHandler()); 
```

我收到以下错误：

> java.net.UnknownHostException: 127.0.0.1/getResourceNameToUse?id={"ID"

所以看起来冒号正在破坏获取请求。有没有办法来解决这个问题？为什么编码它不能解决问题？我的编码 id 如下所示：

```

%7B%22ID%22%3A%22约翰%20Doe%22%7D

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T10:03:36.330

当我运行您的代码的近似值时，您生成的 URL 是：

```
https://127.0.0.0/getResourceNameToUse?id=%7B%22ID%22%3A%22John%20Doe%22%7D 
```

据我所知，这是一个绝对有效的 URL。我没有看到任何`:`会混淆`HttpClient`. 让我们看一下异常：

```
java.net.UnknownHostException: 127.0.0.0/getResourceNameToUse?id={"ID" 
```

在我看来，有些东西*没有*使用您的编码 URL，因为它显示的`{"ID`是`%7B%22ID%22`. 您帖子中的代码是否可能与您正在运行的代码不*完全相同*？

我还注意到你要去 IP `127.0.0.0`。`127.0.0.1`您想连接到本地主机的任何机会？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T20:46:25.370

我能够通过对冒号进行基本上双 url 编码来修复它：

```
String id = "{\"ID\":\"John Doe\"}";
id = id.replace(":","%3A");
String encodedID = URLEncoder.encode(id, "UTF-8").replace("+", "%20");
endpoint="https://127.0.0.1/getResourceNameToUse?id=" + encodedID;
HttpResponse response = new HttpResponse();
HttpGet httpget = new HttpGet(endpoint);
response = httpclient.execute(httpget, new RESTResponseHandler()); 
```

# java - 在运行时突出显示 WebDriver 中的元素

> ID：10660291
> 
> 赞同：22
> 
> 时间：2012-05-18T22:05:00.143
> 
> 标签：java, selenium, webdriver

有人可以帮忙吗！

在 WebDriver 中执行测试期间，如何突出显示以下课程中的所有 Web 元素？使用 Selenium RC，它非常简单，但使用 WebDriver 我正在苦苦挣扎。

如果有人能提供一些我可以尝试的代码，我将不胜感激，以及该代码在哪里适合下面的类 - 抱歉，我的 Java 技能不是那么好。

```
package hisScripts;
import java.util.concurrent.TimeUnit;
import org.testng.annotations.*;
import org.testng.Assert;
import static org.testng.Assert.fail;
import org.openqa.selenium.*;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.ie.InternetExplorerDriver;
import org.openqa.selenium.interactions.Actions;

public class R_LHAS_Only_Account_Verification extends HIS_Login_Logout{
    public WebDriver driver;
    public String baseUrl;
    public int exeMonth;
    private StringBuffer verificationErrors = new StringBuffer();

    @BeforeClass
    @Parameters ({"browser1", "url", "executionMonth"})
    public void setUp(String browser1, String url, int executionMonth) throws Exception {
        exeMonth = executionMonth;
        baseUrl = url;

        if (browser1.equals("FF")) {
            driver = new FirefoxDriver();
        } else if (browser1.equals("IE")){
            driver = new InternetExplorerDriver();
        }       
        driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);    
    }       

    @Test
    public void R_LHAS_Reports() throws Exception {
        R_LHAS_Only_Login(baseUrl, driver);
        Assert.assertEquals("Kingston upon Thames (RB)", driver.findElement(By.xpath("//html/body/div[9]/div/div[3]/div/div/div")).getText());
        Assert.assertEquals("Average price", driver.findElement(By.xpath("//table[@id='tableId']/tbody/tr/td")).getText());
        Assert.assertEquals("% price change", driver.findElement(By.xpath("//table[@id='tableId']/tbody/tr[2]/td")).getText());
        Assert.assertEquals("Lower quartile price", driver.findElement(By.xpath("//table[@id='tableId']/tbody/tr[3]/td")).getText());
        Assert.assertEquals("Time to sell (weeks)", driver.findElement(By.xpath("//table[@id='tableId']/tbody/tr[4]/td")).getText());
        Assert.assertEquals("% asking price achieved", driver.findElement(By.xpath("//table[@id='tableId']/tbody/tr[5]/td")).getText());
        Assert.assertEquals("House price to earnings ratio", driver.findElement(By.xpath("//table[@id='tableId']/tbody/tr[6]/td")).getText());
        Assert.assertEquals("Cost of buying outright - LQ 2 bed £pw", driver.findElement(By.xpath("//table[@id='tableId']/tbody/tr[7]/td")).getText());
        Assert.assertEquals("Private rent 2 bed £pw", driver.findElement(By.xpath("//table[@id='tableId']/tbody/tr[8]/td")).getText());
        Assert.assertEquals("80% private rent 2 bed £pw", driver.findElement(By.xpath("//table[@id='tableId']/tbody/tr[9]/td")).getText());
        Assert.assertEquals("Social rent 2 bed £pw", driver.findElement(By.xpath("//table[@id='tableId']/tbody/tr[10]/td")).getText());                 
        R_LHAS_Only_Logout(baseUrl,driver);
    }

    @AfterClass(alwaysRun=true)
    public void tearDown() throws Exception {
        driver.quit();
        String verificationErrorString = verificationErrors.toString();
        if (! "".equals(verificationErrorString)) {
            fail(verificationErrorString);
        }
    }   
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-18T22:58:31.460

[`WebDriver`](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebDriver.html)（从 v2.21.0 开始）没有办法做到这一点。您可以尝试用[`findElement(By)`](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebDriver.html#findElement%28org.openqa.selenium.By%29)一种调整过的方法替换通常的方法，该方法使用 JavaScript 突出显示找到的元素：

```
// Draws a red border around the found element. Does not set it back anyhow.
public WebElement findElement(By by) {
    WebElement elem = driver.findElement(by);
    // draw a border around the found element
    if (driver instanceof JavascriptExecutor) {
        ((JavascriptExecutor)driver).executeScript("arguments[0].style.border='3px solid red'", elem);
    }
    return elem;
} 
```

既然你明白了，有一个改进的版本可以在`border`找到并突出显示新元素时恢复最后一个元素的原始元素：

```
// assuming JS is enabled
private JavascriptExecutor js = (JavascriptExecutor)driver;
private WebElement lastElem = null;
private String lastBorder = null;

private static final String SCRIPT_GET_ELEMENT_BORDER;
private static final String SCRIPT_UNHIGHLIGHT_ELEMENT;

void highlightElement(WebElement elem) {
    unhighlightLast();

    // remember the new element
    lastElem = elem;
    lastBorder = (String)(js.executeScript(SCRIPT_GET_ELEMENT_BORDER, elem));
}

void unhighlightLast() {
    if (lastElem != null) {
        try {
            // if there already is a highlighted element, unhighlight it
            js.executeScript(SCRIPT_UNHIGHLIGHT_ELEMENT, lastElem, lastBorder);
        } catch (StaleElementReferenceException ignored) {
            // the page got reloaded, the element isn't there
        } finally {
            // element either restored or wasn't valid, nullify in both cases
            lastElem = null;
        }
    }
} 
```

还有剧本！我使用[`FileUtils.readFileToString()`](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#readFileToString%28java.io.File%29).

SCRIPT_GET_ELEMENT_BORDER（[取自该站点的 IE 友好版本](http://www.quirksmode.org/dom/getstyles.html)），如果它通过更改背景颜色（例如，仅底部边框）来突出显示，则会更短。但这是最好的一个:)。

```
/*
 * Returns all border properties of the specified element as String,
 * in order of "width style color" delimited by ';' (semicolon) in the form of:
 * 
 * "2px inset #000000;2px inset #000000;2px inset #000000;2px inset #000000"
 * "medium none #ccc;medium none #ccc;1px solid #e5e5e5;medium none #ccc"
 * etc.
 */
var elem = arguments[0]; 
if (elem.currentStyle) {
    // Branch for IE 6,7,8\. No idea how this works on IE9, but the script
    // should take care of it.
    var style = elem.currentStyle;
    var border = style['borderTopWidth']
            + ' ' + style['borderTopStyle']
            + ' ' + style['borderTopColor']
            + ';' + style['borderRightWidth']
            + ' ' + style['borderRightStyle']
            + ' ' + style['borderRightColor']
            + ';' + style['borderBottomWidth']
            + ' ' + style['borderBottomStyle']
            + ' ' + style['borderBottomColor']
            + ';' + style['borderLeftWidth']
            + ' ' + style['borderLeftStyle']
            + ' ' + style['borderLeftColor'];
} else if (window.getComputedStyle) {
    // Branch for FF, Chrome, Opera
    var style = document.defaultView.getComputedStyle(elem);
    var border = style.getPropertyValue('border-top-width')
            + ' ' + style.getPropertyValue('border-top-style')
            + ' ' + style.getPropertyValue('border-top-color')
            + ';' + style.getPropertyValue('border-right-width')
            + ' ' + style.getPropertyValue('border-right-style')
            + ' ' + style.getPropertyValue('border-right-color')
            + ';' + style.getPropertyValue('border-bottom-width')
            + ' ' + style.getPropertyValue('border-bottom-style')
            + ' ' + style.getPropertyValue('border-bottom-color')
            + ';' + style.getPropertyValue('border-left-width')
            + ' ' + style.getPropertyValue('border-left-style')
            + ' ' + style.getPropertyValue('border-left-color');
}
// highlight the element
elem.style.border = '2px solid red';
return border; 
```

SCRIPT_UNHIGHLIGHT_ELEMENT

```
var elem = arguments[0];
var borders = arguments[1].split(';');
elem.style.borderTop = borders[0];
elem.style.borderRight = borders[1];
elem.style.borderBottom = borders[2];
elem.style.borderLeft = borders[3]; 
```

欢迎任何问题、注释、请求和改进！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-06T10:53:08.057

在 webdriver中为高亮元素**HighlightElement**
创建一个类

 **`HighlightElement.java`

```
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.WebElement;

import com.project.setup.WebDriverManager;

public class HighlightElement {

    public static void highlightElement(WebElement element) {
        for (int i = 0; i <2; i++) {
            JavascriptExecutor js = (JavascriptExecutor) WebDriverManager.driver;
            js.executeScript("arguments[0].setAttribute('style', arguments[1]);", element, "color: yellow; border: 2px solid yellow;");
            js.executeScript("arguments[0].setAttribute('style', arguments[1]);", element, "");
            }
        }
} 
```

* * *

您可以使用

`HighlightElement.highlightElement(driver.findElement(By.xpath("blaah blaah"));)`

在您的测试中 使用 xpath“ **blaah blaah ”突出显示 WebElement。**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-08-25T12:03:43.523

**JavaScript：** *查找[元素](https://developer.mozilla.org/en/docs/Introduction_to_using_XPath_in_JavaScript)的[Xpath](https://stackoverflow.com/questions/18510576/find-an-element-by-text-and-get-xpath-selenium-webdriver-junit/32201731#32201731)并在其周围绘制边框，*

*使用 styleObj。[setProperty](https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleDeclaration) (CSS propertyName, CSS propertyValue, priority) 方法。* `element_node.style.setProperty ("background-color", "green", null);`

*在此站点上测试 js 代码：[https ://developer.chrome.com/devtools/docs/console](https://developer.chrome.com/devtools/docs/console)*

```
var xpath = '//html/body/div/main/article/nav';
if (document.evaluate){
var element_node = document.evaluate(xpath, window.document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null ).singleNodeValue;
element_node.style.setProperty ('border', '3px solid green', 'important');

alert('Working Fine in this browser version');
}else{
alert('document.evaluate is Not supported by Internet Explorer');
} 
```

**硒**

```
public static void drawBorder(WebDriver driver, String xpath){
        WebElement element_node = driver.findElement(By.xpath(xpath));
        JavascriptExecutor jse = (JavascriptExecutor) driver;
        jse.executeScript("arguments[0].style.border='3px solid red'", element_node);
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T05:41:37.650

我使用以下代码在我的 webdriver java 代码中使用 javascript 执行器突出显示：

//我在函数“flash”下面调用

```
 public static void flash(WebElement element, WebDriver driver) {
        JavascriptExecutor js = ((JavascriptExecutor) driver);
        String bgcolor  = element.getCssValue("backgroundColor");
        for (int i = 0; i <  3; i++) {
            changeColor("rgb(0,200,0)", element, js);
            changeColor(bgcolor, element, js);
        }
    }
    public static void changeColor(String color, WebElement element,  JavascriptExecutor js) {
        js.executeScript("arguments[0].style.backgroundColor = '"+color+"'",  element);

        try {
            Thread.sleep(20);
        }  catch (InterruptedException e) {
        }
     } 
```

希望有帮助:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-11-10T13:05:38.480

这里是在 selenium 中突出显示元素的代码： 首先创建一个类：

```
package com.demo.misc.function;

import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;

public class Miscellaneous 
{
    public static void highLight(WebElement element, WebDriver driver)
    {
        for (int i = 0; i <2; i++) 
        {
            try {
                JavascriptExecutor js = (JavascriptExecutor) driver;
                js.executeScript("arguments[0].setAttribute('style', arguments[1]);", element, "color: black; border: 4px solid red;");
                Thread.sleep(500);
                js.executeScript("arguments[0].setAttribute('style', arguments[1]);", element, "");
                Thread.sleep(500);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }

    }

} 
```

然后你可以通过以下方式调用它：

```
driver.get(baseUrl);
            Thread.sleep(2000);
            WebElement lnkREGISTER = driver.findElement(By.linkText("REGISTER"));
            Miscellaneous.highLight(lnkREGISTER, driver);
            lnkREGISTER.click(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-18T22:53:31.063

我不知道在 WebDriver 中有任何方法可以做到这一点，但看起来 Selenium WebDriver 中存在一个类，它应该可以让您访问大部分（如果不是全部）RC API。我不知道如何使用 WebDriver 实际执行此操作。

[WebDriverBackedSelenium](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebDriverBackedSelenium.html)类看起来包含您习惯的大部分 RC api，包括[getEval](http://selenium.googlecode.com/svn/trunk/docs/api/java/com/thoughtworks/selenium/DefaultSelenium.html#getEval%28java.lang.String%29)

要创建 type 的对象`WebDriverBackedSelenium`，只需传入您已经使用的驱动程序以及测试站点的基本 URL

```
WebDriverBackedSelenium wdbs = new WebDriverBackedSelenium(driver, "http://www.google.com"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-05T11:34:14.660

我使用 ExtentReport 作为报告工具，并且在失败的测试步骤中将图像添加为 base64 格式，这样我就可以在输出报告中的文本之后立即显示它们。当我截取屏幕截图并想要突出显示元素以便在屏幕截图中更明显时，我使用以下方法突出显示 -> 屏幕截图 -> 取消突出显示。

```
private void highlightElement(WebElement elemToHighlight) {
    if (_driver instanceof JavascriptExecutor) {
        ((JavascriptExecutor) _driver).executeScript("arguments[0].style.border='3px solid red'", elem);
    }
}

public String addScreenshotToHTML(WebElement... elmsToHighlight) {
    String result;
    List<String> initStyle = new ArrayList<>();
    if (elmsToHighlight.length > 0) {
        for (WebElement elem : elmsToHighlight) {
            initStyle.add(elem.getCssValue("border"));
            highlightElement(elem);
        }
    }
    String screenshot = ((TakesScreenshot) _driver).getScreenshotAs(OutputType.BASE64);
    // NOTE: add the <img> tag content between the <a> tags with the Base64 image
    // <a href='" + filePath + "' target='_blank'></a>
    result = "<img onclick='(function(){var image=new Image();image.src=\"data:image/png;base64," + screenshot
            + "\";var w=window.open(\"\");w.document.write(image.outerHTML);})()' style='width:400px; cursor:pointer;' src='data:image/png;base64,"
            + screenshot + "'>";
    if (elmsToHighlight.length > 0) {
        for (WebElement elem : elmsToHighlight) {
            jsExec().executeScript("arguments[0].style.border='" + initStyle.get(0) + "'", elem);
            initStyle.remove(0);
        }
    }
    return result;
} 
```

希望有帮助

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-05T15:56:36.757

这对我有用。改进了之前在此线程上提交的代码。

```
public static WebDriver HighlightElement(WebDriver driver, WebElement element){ 
    if (driver instanceof JavascriptExecutor) {
        ((JavascriptExecutor)driver).executeScript("arguments[0].style.border='3px solid red'", element);
    }
    return driver;
}
public static WebDriver UnhighlightElement(WebDriver driver, WebElement element){   
    if (driver instanceof JavascriptExecutor) {    
        ((JavascriptExecutor)driver).executeScript("arguments[0].style.border=''", element);
    }
    return driver;  
} 
```

调用这两个函数一次突出显示，一次取消突出显示

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-01T14:57:34.923

要突出显示元素，您可以使用以下命令：

```
JavascriptExecutor js =(JavascriptExecutor)driver;
js.executeScript("arguments[0].style.border='5px dotted yellow'", element); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-08-03T12:49:20.013

```
public class JavaExecutor {

public static void highlighElement(WebDriver driver,WebElement element)
{
    JavascriptExecutor js=(JavascriptExecutor)driver; 
    js.executeScript("arguments[0].setAttribute('style', 'background: yellow; border: 2px solid red;');", element);

    try 
    {
    Thread.sleep(1000);
    } 
    catch (InterruptedException e) {

    System.out.println(e.getMessage());
    } 

    js.executeScript("arguments[0].setAttribute('style','border: solid 2px white');", element); 

    }
} 
```**

# redirect - 在 tcl 中自动重定向到上一页

> ID：10660292
> 
> 赞同：0
> 
> 时间：2012-05-18T22:05:01.940
> 
> 标签：redirect, tcl

tcl中是否有类似于php中标头的标头重定向功能？

基本上当我登陆一个新页面时，我想做一些错误检查，它失败了我想自动将它重定向到上一页（上一页，我的意思是浏览器后退按钮指向的任何地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T01:09:18.797

tcllib 的[ncgi 包](http://tcllib.sourceforge.net/doc/ncgi.html)有一个重定向过程。

# java - 我有什么方法可以优化这个java代码吗？

> ID：10660298
> 
> 赞同：0
> 
> 时间：2012-05-18T22:06:02.193
> 
> 标签：java, optimization, image-processing

此代码应在文件夹中查找图像，并将图像组合成 6000x6000 图像。它正在工作，但它真的很慢。我可以实现的任何优化？

```
File in = new File(args[1]);
            File out = new File(args[2]);
    in.mkdirs();
    out.mkdirs();
    if(out.exists())
    {
        out.delete();
    }
    if(!in.isDirectory())
    {
        Main.printUsage();
    }

    BufferedImage bout = new BufferedImage(6032, 6032, BufferedImage.TYPE_INT_ARGB);
    Graphics2D g = bout.createGraphics();
    int count = 0;
    long starttime = System.currentTimeMillis();
    for(int i=0; i<=376; i++)
    {
        for(int k=0; k<=376; k++)
        {
            File cu = new File(in, (i-188)+"-"+(k-188)+".png");
            if(cu.exists())
            {
                count++;
                try {
                    g.drawImage(ImageIO.read(cu), 16*i, 16*k, null);
                } catch (IOException e) {
                    e.printStackTrace();
                }
                Runtime.getRuntime().;
            }
        }
    }
    System.out.println("Processed "+count+" chunks in "+((System.currentTimeMillis()-starttime)/1000F)+" seconds");

    g.dispose();
    try {
        ImageIO.write(bout, "png", out);
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:25:23.253

延迟可能在文件系统中，打开所有这些文件。在一个目录中有这么多文件，即使只是目录中的查找时间也很重要。

如果是这种情况，就不会有软件解决方案。尝试将文件放在闪存驱动器上，看看是否有帮助，即使只是作为测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T00:13:50.683

大小为 6032*6032 的图像和 2 个嵌套循环，每个大小为 376 绘制近 3600 万像素至少 2 次并循环 141000 次

不要忘记阅读文件...

我建议您尝试使用 2 个线程组合成对的图像

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T23:28:04.283

我不知道您的应用程序，但您可以保存新创建的图像并在生成新图像之前检查它是否是最新的。或者，保存更多信息并仅更新更改的部分。

但是，如果每次加载程序时一切都发生了变化，那么瓶颈显然是 I/O 延迟。没有钱购买 SSD 或 raidsystem，您将无法通过它；）

# shell - 如何在 gnuplot 中绘制一组 csv 文件？

> ID：10660301
> 
> 赞同：1
> 
> 时间：2012-05-18T22:06:11.563
> 
> 标签：shell, unix, gnuplot

我有一组具有相同 2 列格式的 csv 文件。我想生成与每个文件对应的单独的 xy 散点图，但样式相同。唯一应该改变的是输入和输出文件名。怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-19T18:38:06.497

andyras 发布的解决方案是完全可行的。但是，在这些情况下，“HERE”文件通常更好，因为它避免了产生额外的进程，而且你不会遇到混合单引号和双引号的问题......

```
for file in $(echo *.dat); do
    gnuplot <<EOF
    set terminal post enh
    set output "output_${file}.ps"
    set datafile separator ','  #csv file
    plot "$file" u 1:2
EOF
done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T23:11:28.490

您可以创建一个包装 bash 脚本并将其保存为`plot.sh`：

```
#!/bin/bash

echo "set terminal postscript enhanced
set output 'output_$1.eps'

plot '$1' 
```

假设您的数据文件都具有`.dat`扩展名。你可以通过调用来使用它

```
for datfile in $(ls *dat) ; do ./plot.sh $datfile ; done 
```

在 bash 的命令行中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T22:43:34.010

首先，创建一个包含所有样式信息的文本文件，例如`gplot_prefix.txt`. 然后，我假设您有一些与您要绘制的所有文件匹配的模式，例如`*.dat`. 然后，制作一个 zsh 脚本，如下所示：

```
foreach arg in $@
    filename=${arg}_plotfile.pl
    cp gplot_prefix.txt ${filename}
    echo set output ${arg}.png >>${filename}
    echo plot \"${arg}\" u 1:2 >>${filename}
    gnuplot ${filename}
    rm ${filename} 
```

（这可能有错误；我的 zsh 现在无法正常工作）并将其称为

```
./plotscript.zsh *.dat 
```

# python - 无法满足 python2.6 的 Build-Depends 依赖项，因为包 libffi4-dev 没有候选版本

> ID：10660304
> 
> 赞同：0
> 
> 时间：2012-05-18T22:06:21.117
> 
> 标签：python

尝试使用 sudo apt-get build-dep python2.6 安装 python 的依赖项 出现以下错误 无法满足 Python2.6 的 Build-Depends 依赖项，因为软件包 libffi4-dev 没有候选版本

**更新：-** 所有依赖项都已成功安装，除了 _ssl。我尝试安装 openssl 但即使在 _ssl 依赖项未删除之后

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:27:09.387

看看这个[http://christophermahan.com/hacking/2009/python2.6-on-debian-stable.html](http://christophermahan.com/hacking/2009/python2.6-on-debian-stable.html)

我大约在 3 年前经历过这个。我也很喜欢依赖。

我搜索了“apt-get install libffi4-dev”并没有走远。

请参阅[http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=513289](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=513289)那里有一个“apt-get install libffi5-dev”

# android - Android：针对不同屏幕密度的背景图像大小的建议？

> ID：10660306
> 
> 赞同：1
> 
> 时间：2012-05-18T22:06:40.503
> 
> 标签：android, screen, background-image, gimp

不同密度 ldpi、mdpi、hdpi、xhdpi、xxhdpi 的背景图像的正确尺寸是多少？

我有透明背景图片 (.png)，并希望尽可能减小图片大小。（与 .apk 大小无关，但与功能较弱的设备上的内存问题有关）

我假设，第一件事是确保图像的尺寸正确，这样它们就不需要缩放。但是，我不知道密度与某些屏幕分辨率（如果有的话）有何关系。

还有哪些其他选项可用于减小图像大小。我正在使用 GIMP 创建背景图像。我应该在 GIMP 中使用哪些设置？

有什么建议吗？

编辑：具有 800 x 480 像素屏幕的设备是否应该使用 800 x 480 像素的背景图像？Android 不必对其进行缩放，但另一方面，图像需要大量内存？

什么是最好的分辨率？

我怎么知道哪些设备有哪些屏幕尺寸？

即 SGS GT-I9000 有 800 x 480，但它是一个 ldpi 设备（只有 233 dpi）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T00:16:32.233

我知道的唯一解决方案是使用 9-patch。当然，它会限制您使用的背景的性质，但在大多数情况下它可以解决问题。

[http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch](http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch)

# java - 是否可以在 Java 和 Android 中为 jpg 添加透明度

> ID：10660308
> 
> 赞同：0
> 
> 时间：2012-05-18T22:06:41.847
> 
> 标签：java, android

我想将一些图像加载到云端，但我想在有人查看照片并保存图像时添加一些保护；由于透明度，他们将看不到任何东西。

代码对于 Java 和 Android 是否通用？我想先用 Java 做原型。

我发现了一些组合两个文件的代码。一个文件是我的主文件，另一个是透明文件。组合文件没有透明覆盖。

我需要使用图像绘制订单吗？ [http://www.developer.nokia.com/document/Java_Developers_Library_v2/GUID-D3E35E6F-0C45-48ED-B09D-F716E14C1C02/javax/microedition/amms/control/imageeffect/OverlayControl.html](http://www.developer.nokia.com/document/Java_Developers_Library_v2/GUID-D3E35E6F-0C45-48ED-B09D-F716E14C1C02/javax/microedition/amms/control/imageeffect/OverlayControl.html)

```
 BufferedImage image = ImageIO.read(new File("rose.jpg"));
    BufferedImage overlay = ImageIO.read(new File("myimg1.gif"));

    // create the new image, canvas size is the max. of both image sizes
    int w = Math.max(image.getWidth(), overlay.getWidth());
    int h = Math.max(image.getHeight(), overlay.getHeight());
    BufferedImage combined = new BufferedImage(w, h, BufferedImage.TYPE_INT_ARGB);

    // paint both images, preserving the alpha channels
    Graphics g = combined.getGraphics();
    g.drawImage(image, 0, 0, null);
    g.drawImage(overlay, 0, 0, null);

    // Save as new image
    ImageIO.write(combined, "PNG", new File("combined.png")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:10:53.437

这行不通。如果他们可以看到图像，他们可以以一种或另一种方式复制它。一个需要考虑的解决方案是免费提供带水印的缩略图，然后只提供全分辨率图像并收费。但是，一旦付款，他们仍然可以复制全分辨率图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T23:54:17.837

您实际上可以将跨图像作为原始图像的叠加层，以防止下载，我认为这通常是由服务器端完成的，也就是您的云我从一些网站知道他们使用某种叠加层，例如您的并且浏览器看不到下图所以不能下载。

我实际上不明白你是如何实现这一点的——图像是在浏览器中打开的？

虽然只是一个狂野，你也可以像拼图一样将图像切割成碎片设备将它连接在一起不会有问题，但是当你下载时，你将只下载“一块拼图”：-P

# ios - 适用于 iOS 的 ExternalAcessory 框架：将 iphone 用作 USB 设备

> ID：10660314
> 
> 赞同：1
> 
> 时间：2012-05-18T22:07:06.367
> 
> 标签：ios, ios5, external-accessory

我正在研究 iOS sdk 以获取 ExternalAccessory 框架的示例，以使用 iphone/ipad 作为 USB 设备，可以插入 PC 或 Mac 并作为外部设备（如 midi 控制器或其他设备）

我要创建的应用程序需要通过 USB 或蓝牙连接到 iphone 主机（PC 或 Mac），并向主机提供功能。我该如何实施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:14:31.100

您可能会更轻松地通过 WiFi 连接。您需要加入不易进入的 Apple Made for iPhone 计划，才能使用蓝牙或扩展坞连接器与外围设备通信。WiFi的使用没有这样的限制。此外，您还会在网络上找到更多有用的通过 WiFi 连接的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T22:34:35.893

CoreMIDI 是用于模拟 MIDI 设备的适当 API，可以使用 Apple 相机连接套件通过 USB 实现。

# apache-poi - 如何获取 Apache POI Powerpoint 代码？

> ID：10660316
> 
> 赞同：0
> 
> 时间：2012-05-18T22:07:26.477
> 
> 标签：apache-poi

我不确定如何实际下载用于 Powerpoint 的 Apache POI 暂存器代码？

以下页面说要下载暂存器 jar，但那在哪里？我没有在下载页面上看到它。

[http://poi.apache.org/slideshow/index.html](http://poi.apache.org/slideshow/index.html)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T21:44:18.553

这很容易！首先，访问[Apache POI 下载页面](http://poi.apache.org/download.html)。接下来，以 Zip 或 Tar.Gz 的形式下载二进制发行版（取决于在您的系统上最适合的版本）。解压它，您将拥有所有 POI jar 及其依赖项。最后，查看[组件页面](http://poi.apache.org/overview.html#components)以检查每个 jar 的依赖项。

# ruby-on-rails - rails 3.1.3 has_many/belongs_to 夹具不相等？

> ID：10660321
> 
> 赞同：1
> 
> 时间：2012-05-18T22:07:39.033
> 
> 标签：ruby-on-rails

假设有两个模型：

```
class Foo < ActiveRecord::Base
  has_many :bars
end

class Bar < ActiveRecord::Base
  belongs_to :foo
end 
```

及其相关的固定装置：

foos.yml：

```
one:
  ... 
```

bar.yml：

```
one:
  foo: one

two:
  foo: one 
```

然后是一个测试用例：

```
test "fixtures equal?" do
  foo = foos(:one)
  assert_equal foo, foo.bars.first.foo
end 
```

在单元测试框架和功能测试框架中，这个测试对我来说都失败了。我得到的失败看起来像：

```
1) Failure:
test_fixtures_equal?(FooUnitTest) [test/unit/foo_test.rb:53]:
<#<Foo id: 980190962, created_at: "2012-05-18 21:47:27", updated_at: "2012-05-18 21:47:27">>
with id <70029939109360> expected to be equal? to
<#<Foo id: 980190962, created_at: "2012-05-18 21:47:27", updated_at: "2012-05-18 21:47:27">>
with id <70029939309000>. 
```

我究竟做错了什么？如何让前向和后向指针指向相同的对象？这对我来说尤其重要，因为我试图同时修改两个对象并验证更改，但是 bar.foo 链接没有看到“父” foo 对象的更改，因此我的验证在测试期间失败。

唉，在搜索了几个小时后，我尝试了许多不同的方法，但我无法弄清楚这一点。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:05:05.087

简短回答：
1.（似乎）夹具不理解“参考”，它只知道“列名”。2\. 分配`id`in 夹具有时不是一个坏主意

所以，改变你的装置如下：

```
# foos.yml
one: 
  id: 1

# bars.yml
one:
  id: 1       # always assign the id
  foo_id: 1   # don't use:  foo: one 
```

如果您不喜欢夹具，或者您的对象关联很复杂，请切换到“FactoryGirl”（[https://github.com/thoughtbot/factory_girl](https://github.com/thoughtbot/factory_girl)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T14:48:30.537

简短版本：activerecord 没有身份映射。

长版：当您在 2 个地方加载相同的数据库行时，您最终会得到 2 个单独的对象。与 == 比较时，它们是相同的（因为活动记录因此定义为仅比较 id 列），但在使用`equal?`. （`assert_equal`虽然使用 == 我上次使用测试/单元）。

在特定情况下，您`bar.foos.first.bar`可以在关联上指定`inverse_of`选项告诉 Rails 2 个关联彼此相反。

# java - 如果我想要更快的相机预览 FPS，我是否必须使用 NDK？

> ID：10660323
> 
> 赞同：0
> 
> 时间：2012-05-18T22:08:10.897
> 
> 标签：java, android, sdk, camera

我正在尝试提高预览帧速率，但我的手机不支持 setPreviewFrameRate。使用 setPreviewCallbackWithBuffer 并且没有额外处理的情况下，我可以获得的最大值约为 17 fps，我认为大多数人都会同意这有点糟糕。我是否遗漏了 Android Java SDK 中的某些内容，或者我是否需要了解 NDK 才能以 30 fps 的速度处理数据？（我应该指出，相机可以以这种速度捕捉和保存文件——显然它不能以这种速度预览）。

使用 NDK 有什么我应该知道的缺点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T00:13:55.060

我一直处于这种情况，并且在 NDK 中从相机读取速度更快。但是，我将手机植根并直接从帧缓冲区读取，它可能不是您正在开发的同一部手机，所以 YMMV。

# excel - 使用 Cube Functions 获取过滤后的维度

> ID：10660327
> 
> 赞同：1
> 
> 时间：2012-05-18T22:08:38.940
> 
> 标签：excel, excel-formula, excel-2010, cube, powerpivot

如何从多维数据集函数中获取过滤维度列表

说我有一个地址的维度表：

```
1234  Any Street  Detroit  MI 48229
55588 187th St E  Seattle  WA 98888
4     Blossum Ave Wescotte AL 66554 
```

我怎样才能获得带有特定 zip 的街道地址的 CUBERANKEDMEMBER 列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T10:42:52.740

你可以使用

```
=cubeset("powerpivot", "nonempty([City].[Zip].children, [Measure].[Count of City])", "set") 
```

然后使用

```
=Cuberankmember("powerpivot", set, 1)
=Cuberankmember("powerpivot", set, 2)
.... 
```

where`set`是第一个公式所在的单元格的名称。

# php - 我的 php 代码被浏览器注释掉了

> ID：10660328
> 
> 赞同：1
> 
> 时间：2012-05-18T22:08:40.983
> 
> 标签：php

> **可能重复：**
> [PHP：代码变成了 HTML <!- 评论？-->](https://stackoverflow.com/questions/9368841/php-code-gets-turned-into-html-comments)

我有一些非常非常简单的 php 代码。

```
<html>
    <head>
        <title>Something</title>
    </head>
    <body>
        <h2>Something</h2>

        <?php
            $val = $_POST['a'];
            echo 'Value: ' . $val . '<br />;
        ?>
    </body>
</html> 
```

当我在我制作的表单中按下提交按钮时，浏览器会像这样注释掉 php 代码：

```
<!--?php
     //the stuff i do above
?--> 
```

有谁知道这是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:13:29.617

您在使用 CMS 吗？当您将其插入模板而不使用特殊模块时，这看起来像 Joomla 对 PHP 代码的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T22:10:45.433

PHP 是一种服务器端语言。它在服务器上进行评估，评估结果替换代码本身。

这是设计使然，如果每个页面的 PHP 源代码都包含在 HTML 注释中，那就太糟糕了（例如，您可以看到数据库密码等）。

您无法从客户端（即 HTML 源代码）看到 PHP。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T22:10:16.180

是的，您在`'`echo 语句的末尾缺少一个结束语。

# c# - 将标签保留在 TabControl .NET 之上

> ID：10660329
> 
> 赞同：1
> 
> 时间：2012-05-18T22:08:50.737
> 
> 标签：c#, .net, tabcontrol, z-order

我有一个标签，当我从一个标签切换到另一个标签时，我需要将它放在我的 TabControl 之上。我曾尝试在选项卡控件的 SelectedIndexChanged 事件中调用标签的 BrintToFront 方法，但这没有效果。我也只是尝试在设计视图中右键单击我的标签并选择“置于前面”，但同样没有效果。

但是，当我切换到第二个选项卡时，它落在 TabControl 后面，当我回到第一个选项卡时，它又在前面。

我将标签本身放在 Form 而不是 TabControl 上。

我在 C# 中工作。任何想法将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T22:15:10.363

您应该确保您的标签不在特定选项卡内。要验证这一点，您需要查看“文档大纲”内的嵌套 (ctl+alt+T)

如果是我推荐；将其拖动到选项卡控件之外（您也可以使用文档大纲）。然后'把它带到前面'。然后使用箭头键或位置属性将其移回原位。

# r - readRDS（文件）中的错误：未知的输入格式

> ID：10660330
> 
> 赞同：1
> 
> 时间：2012-05-18T22:09:03.777
> 
> 标签：r, crash

我正在尝试在我的 Rprofile.site 文件中安装自定义包。我想在站点文件中安装软件包，因为我必须在多个用户的计算机上安装这些软件包。但是，每当我启动 R 时，我都会收到以下错误。

```
Error in readRDS(file) : unknown input format 
```

我在 Rprofile.site 文件的末尾添加了以下代码。

```
if(length(grep("customPackage", installed.packages()))==0) {
    install.packages("customPackage", repos=NULL, type="source")
} 
```

该错误也会不断重复，直到我停止 R 会话。如果我从站点文件中删除该代码并直接在 R 会话中安装包，尽管它工作正常。

我想在站点文件中执行此操作的唯一原因是因为我将继续添加更多需要安装在每个用户的机器上的自定义包，我宁愿只从站点文件中调用它，而不是让每个用户安装每个自定义包一次.

我尝试搜索错误并得到了各种关于删除 .Rhistory 文件（我尝试过，但没有奏效）或安装最新版本的 R 的答案（我在 R-2.15.0 上，即最新版本，所以这也无济于事）。我想知道是否有任何其他解决方案来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-05-16T08:28:20.067

我有同样的错误。简单地关闭 RStudio，然后重新打开它并再次尝试对我有用。请注意，通过 RStudio 菜单或 via 重新启动 R 会话`rs.restartR()` *不起作用*- 只有关闭和重新打开 RStudio 才有效。不知道为什么。

# sql - 将 SQuirrel 3.2.1 中的存储过程与用于 DB2 数据库的 JDBC 驱动程序一起使用时

> ID：10660352
> 
> 赞同：1
> 
> 时间：2012-05-18T22:11:00.250
> 
> 标签：sql, stored-procedures, db2, squirrel-sql

我花了很多时间试图从存储过程中检索数据，这是代码

```
 CREATE PROCEDURE aprocedure(
             IN idin CHAR,
             OUT returnvalue CHAR)
              AS:
                SET returnvalue= 
                   (SELECT something
                   FROM sometable 
                   WHERE id=idin) 
```

我可以毫无问题地创建它，但是当我尝试这样调用它时：

```
 call someprocedure('theid', ?) 
```

错误-313不断弹出，我做了功课并检查了网络，IBM论坛根本没有帮助，我找不到任何文档，规范或任何使这一点更清楚的东西，SQL错误代码-313也表示数字过程中的参数数量与您调用它时使用的参数数量不匹配。所以，经过太多研究，我开始认为带有 JDBC 驱动程序和/或 SQuirreL 的 DB2 在返回 OUT 值时有问题，（我还安装了一个 DB2 CTL 客户端，创建了一个本地数据库，创建了一个表，创建了过程，我调用了，一切运行良好）所以我将代码更改为此（使用结果集而不是 OUT）：

```
 CREATE PROCEDURE someprocedure(IN idin CHAR (22))
     DYNAMIC RESULT SETS 1
     P1: BEGIN
      DECLARE cursor1 CURSOR WITH RETURN FOR
      SELECT something FROM sometable WHERE id=idin;
      OPEN cursor1;
      END P1 
```

aaaaaaaaaaa 什么都没有，SQuirreL 在尝试创建它时给了我一些错误代码，所以......我在 Aqua Data Studio 4.7 中输入了相同的代码，并且工作起来就像一个魅力，我从 Aqua Data 中调用这个过程是这样的：

```
 call someprocedure('theid'); 
```

它返回了应该返回的内容，我用 SQuirreL 尝试了同样的句子......它也有效！

我确信我的 sintaxys 一直都是正确的，即使是 OUT 类型的返回，所以，我的问题，最后是这个。

SQuirreL 在将输入传递给 JDBC 之前会检查您输入的输入吗？另外我在哪里可以找到 DB2 究竟是如何改变 SQL 代码的？因为我们都知道所有 DBM 都会稍微改变 SQL，但是 MySQL 有很好的文档……老实说，我在 DB2 上找不到任何好的文档，我也在谈论“纯”SQL，因为在 DB2 中你可以在 C 中输入存储过程，Java等...

# c# - 在方法返回上使用隐式类型语法

> ID：10660353
> 
> 赞同：3
> 
> 时间：2012-05-18T22:11:08.190
> 
> 标签：c#, types, methods, implicit, return-type

不完全确定如何为这个问题命名，所以我希望这个标题有效。

问题是，我可以在方法调用中使用类似于隐式类型语法的东西吗？例如，这是我所指的隐式类型语法：

```
var x = new Y(){Foo = "Bar", Id = 1}; 
```

我想做这样的事情：

```
var x = myInstance.CreateItem(){Foo = "Bar", Id = 1}; 
```

C# 中有什么东西支持这样的东西吗？我不想这样做：

```
x.Foo = "Bar";
x.Id = 1;
... 
```

请注意 CreateItem 返回一个动态类型。无法修改 CreateItem 方法及其类。

我会接受类似于 VB 中的 With 语句的东西。

提前致谢。

更新：尝试 Mark Brackett 的解决方案产生了以下代码：

```
TaskItem item = outlook.CreateItem(OlItemType.olTaskItem)._((Action<dynamic>)(i => 
            {
                i.Subject = "New Task";
                i.StartDate = DateTime.Now;
                i.DueDate = DateTime.Now.AddDays(1);
                i.ReminderSet = false;
                i.Categories = "@Work";
                i.Sensitivity = OlSensitivity.olPrivate;
                i.Display = true;

            })); 
```

...

```
public static class Extension
{
    public static T _<T>(this T o, System.Action<dynamic> initialize) where T : class
    {
        initialize(o);
        return o;
    }

} 
```

现在唯一的问题是扩展方法似乎没有绑定到 System._ *ComObject 因为我得到这个错误：System.* _ComObject' 不包含 '_' 的定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:19:15.893

它被称为[“对象初始化器”](http://msdn.microsoft.com/en-us/library/bb384062.aspx)，不——它不能用于返回值（或者实际上，除了使用`new`语句之外的任何时候）。

语法方面，我能想到的最接近的方法是使用`Action`委托（这需要更改`Builder`）：

```
MyItem CreateItem(Action<MyItem> afterCreate) {
   var i = new MyItem();
   if (afterCreate != null) afterCreate(i);
   return i;
}

var x = Builder.CreateItem(i => { i.Foo = "Bar"; i.Id = 1; }); 
```

如果您对常用函数的短方法名称有一种 JavaScript 的感觉，并且无法更改`Builder`，我想扩展方法也可以工作：

```
public static T _<T>(this T o, Action<T> initialize) where T : class {
    initialize(o);
    return o;
}

var x = Builder.CreateItem()._(i => { i.Foo = "Bar"; i.Id = 1; }); 
```

> 这是给你的一个转折点。CreateItem() 返回一个动态类型

与我的评论相反，`dynamic`确实需要一些更改。您需要强制转换为，`object`否则 lambda 会抱怨，然后您需要指定`dynamic`as`T`否则将被推断为`object`. `Action<dynamic>`或者，使用类型参数创建您的扩展方法。

```
object CreateItem() {
    return (object)Builder.CreateItem();
}

public static dynamic __(this object o, Action<dynamic> initialize) {
    initialize(o);
    return o;
}

var x = CreateItem().__(i => { i.Foo = "Bar"; i.Id = 1; }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:35:38.577

您可以对工厂方法使用命名参数：

```
public static Y Builder.CreateItem(string foo = "", int bar = 0)
{
    return new Y() {Foo = foo, Bar = bar};
}

// called like so:
var x = Builder.CreateItem(Foo: "Bar", Id: 1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:16:19.420

您可以在类的构造函数中指定“公共属性”，但不能使用方法执行此操作

因为

*   此规则仅适用于方法无法实现的成员属性

*   您不能在方法中的字段中提供公共修饰符，因此根本不可能

当你这样做

```
var a = new MyClass{Foo="",Id=""}; 
```

您正在定义此构造函数 MyClass() 的类的属性

你不能用静态或实例方法做到这一点

# ios - 发布图片不显示在墙上

> ID：10660356
> 
> 赞同：1
> 
> 时间：2012-05-18T22:11:46.557
> 
> 标签：ios, facebook-graph-api, facebook-ios-sdk

我正在使用 Facebook IOS 库。我正在尝试将图像发布到用户的墙上。我可以将图像上传到应用程序相册，但我无法让它显示在用户的墙上。

应用程序被授予 publish_stream 权限：

```
[self.facebook authorize: [NSArray arrayWithObject: @"publish_stream"]]; 
```

该图像使用以下代码发布：

```
NSMutableDictionary * params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                   UIImagePNGRepresentation(_image), @"source", 
                                   message, @"message", nil];

[self.facebook requestWithGraphPath: @"me/photos"
                          andParams: params
                      andHttpMethod: @"POST"
                        andDelegate: self]; 
```

这很好用 - 图片最终出现在 Facebook 上的应用相册中 - 现在我如何让这张图片显示在用户的墙上？

谢谢

格雷格

# c# - 如何在客户端和服务器端设置jsonp

> ID：10660359
> 
> 赞同：2
> 
> 时间：2012-05-18T22:11:54.353
> 
> 标签：c#, php, .net, json, jsonp

我对使用 jsonp 时的回调函数感到非常困惑

这是我的 json 格式的 js 文件 [http://asla.dev.1over0.com/Guide/js/testjson.js](http://asla.dev.1over0.com/Guide/js/testjson.js)

本质上就是这个json

```
{"x": 10, "y":15} 
```

这是我将要检索的数据 这是我的网站 客户想要从跨域 [http://www.waveofcolor.com/faq.php](http://www.waveofcolor.com/faq.php)的 js 文件中获取数据 以便我检索js 文件中的数据 我必须在脚本标签中包含 js 文件 [http://asla.dev.1over0.com/Guide/js/testjson.js](http://asla.dev.1over0.com/Guide/js/testjson.js)并声明一个函数来告诉页面如何处理这些数据这是代码

```
function func(json){
alert(json.x) 
}
<script type="text/javascript" src="http://asla.dev.1over0.com/Guide/js/testjson.js"></script> 
```

我想这是我感到困惑的部分；到目前为止，我已经读到您几乎只需将查询字符串添加到您在脚本标记中调用的 js 文件的末尾

```
<script type="text/javascript" src="http://asla.dev.1over0.com/Guide/js/testjson.js"></script> 
```

现在将是

```
<script type="text/javascript" src="http://asla.dev.1over0.com/Guide/js/testjson.js?jsonp=func"></script> 
```

我的问题是…… jsonp 怎么知道调用 func 函数？这需要在后端设置吗？如果是这样，如何使用 PHP 或 .NET 4.0 Framework 进行设置。如果我硬编码并像这样在 js 文件中调用 func 函数，我可以让 jsonp 工作

```
func({ "x": 10, "y": 15}); 
```

但是在 js 文件中调用实际的函数是没有意义的，对吧？

一如既往地感谢任何输入

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:18:30.757

是的，你是对的。真正的 JSONP 需要后端支持。通常，您返回的 JSON 也是动态的。如果不是（每个人只共享一大块数据），硬编码函数名称（选择一个比 更好的名称`func`）是粗略但有效的。

如果您想要实际的 JSONP，有多种方法可以在后端进行。请参阅这个简单的[PHP 示例](https://stackoverflow.com/questions/6809053/simple-jquery-php-and-jsonp-example)和[这个](https://stackoverflow.com/questions/758879/asp-net-mvc-returning-jsonp)关于 ASP.NET MVC 上 JSONP 的问题

# javascript - 命令单击不会打开新选项卡，但中键单击会

> ID：10660360
> 
> 赞同：25
> 
> 时间：2012-05-18T22:11:59.413
> 
> 标签：javascript, jquery, mouse, singlepage, sammy.js

在我的网站上，这是一个使用 Sammy.js 和 jQuery 的单页 JS 网站，当我用鼠标中键单击链接时，该链接会在新选项卡中打开。但是当我在 Mac 上单击命令时，它不会。这在 Firefox 和 Chrome 中都会发生，所以我认为它必须以某种方式符合规范。

这发生在 Macbook Air 上（所以触控板 + 命令按钮）。大多数站点都可以正常工作，命令单击与普通的中键单击相同。

自己尝试一下：[https](https://circleci.com) ://circleci.com 。在“关于”、“主页”和“联系人”之间单击命令，您应该会遇到问题 - 它们不会在新标签中打开。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-30T01:40:22.563

~~在这里推测，但稍后会从 Mac 上确认。~~这已被确认可以在 Mac 上运行。

Win ctrl+click 或 Mac command+click 被“正常”点击监听器拾取，就像使用任何其他修饰键（alt+click、shift+click 等）的点击一样。

这尤其令人困惑，因为*在 Mac 上*按 ctrl+click会被解释为在 OS 级别上的右键单击。另一方面，Command-click*不*被解释为中键单击，而是浏览器首选项。

假设您没有专门依赖于修改点击的站点内功能，那么从点击侦听器中排除此类事件是合适的，而是允许它们冒泡以由浏览器本地处理。鉴于[有人在类似情况下](http://groups.google.com/group/mootools-users/browse_thread/thread/c09106ef2d8f6a83/f7600acffd78e30a)的经验，您应该能够将以下内容添加到单击处理程序（可能是 Billiand 指出的库级别的委托）：

```
if (e.metaKey || e.ctrlKey) return; 
```

当在处理程序的开头添加`e`引用当前点击事件时，这应该绕过任何以下`e.preventDefault();`

## 更新：

它确实有效！在[这个相当简约的小提琴](http://jsfiddle.net/ovfiddle/cqbBj/)中，我能够识别何时单击命令或单击控件，以避免执行其余的单击处理程序，其中包括 ajax 获取内容和`e.preventDefault();`. 这允许在 Mac 上“按预期”处理命令单击，即在新选项卡中打开链接。

考虑到这一发现，[这些行](https://github.com/quirkey/sammy/blob/master/lib/sammy.js#L274)现在应该阅读

```
if (e.isDefaultPrevented() || e.metaKey || e.ctrlKey) {
    return;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-20T03:43:56.277

这里有一些有趣的见解： [https ://groups.google.com/forum/#!msg/mozilla.dev.usability/H1qLTur4EFc/gXH007CAPk8J](https://groups.google.com/forum/#!msg/mozilla.dev.usability/H1qLTur4EFc/gXH007CAPk8J)

显然，您使用的 JS 可以`preventDefault()`cmd+click，而中键不受影响。查阅您的 JS/Site 框架的文档。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-25T09:38:59.300

这是来自 sammy.js 的相关代码：

```
// bind to link clicks that have routes
$('a').live('click.history-' + this.app.eventNamespace(), function(e) {
    if (e.isDefaultPrevented()) {
        return;
    }
    var full_path = lp.fullPath(this);
    if (this.hostname == window.location.hostname && app.lookupRoute('get', full_path)) {
        e.preventDefault();
        proxy.setLocation(full_path);
        return false;
    }
}); 
```

总结：如果有人点击了一个链接，用 sammy.js 的行为覆盖标准的链接行为，即将当前页面更改为显示目标页面的内容，而没有实际的页面加载。根据 dakdad 的链接，单击事件会捕获命令单击（与中键单击不同），并且可以被覆盖。

对于解决方法，您可以删除 sammy.js 的事件处理程序（使用`$('a').die('click.history-' + _sammy_event_namespace_);`）并将其替换为检查命令单击并避免覆盖它们的修改版本。

# java - Java注解-如何在处理器中获取属性和类

> ID：10660363
> 
> 赞同：6
> 
> 时间：2012-05-18T22:12:12.190
> 
> 标签：java, annotations

对于以下自定义 Java 注解

```
@CustomAnnotation(clazz=SomeClass.class)
public class MyApplicationCode
{ 
   ... 
} 
```

我基本上希望能够在编译时同时获取 MyApplicationCode 的 Class 对象和 clazz 参数，以确认一些编码约定的一致性（另一个故事）。***基本上我希望能够访问注释处理器中的 MyApplicationCode.class 和 Someclass.class 代码。***我快到了，但我错过了一些东西。我有

```
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.SOURCE)
public @interface CustomAnnotation
{
   public Class clazz();
} 
```

然后我有处理器：

```
public class CustomAnnotationProcessor extends AbstractProcessor
{
    private ProcessingEnvironment processingEnvironment;

    @Override
    public synchronized void init(ProcessingEnvironment processingEnvironment)
    {
        this.processingEnvironment = processingEnvironment;
    }

    @Override
    public boolean process(Set<? extends TypeElement> annotations, RoundEnvironment environment)    
    {
        Set<? extends Element> elements = environment.getElementsAnnotatedWith(ActionCommand.class);

        for(Element e : elements)
        {
            Annotation annotation = e.getAnnotation(CustomAnnotation.class);
            Class clazz = ((CustomAnnotation)annotation).clazz();        

            // How do I get the actual CustomAnnotation clazz?
            // When I try to do clazz.getName() I get the following ERROR:
            // Attempt to access Class object for TypeMirror SomeClass

            // Also, how do I get the Class object for the class that has the annotation within it?
            // In other words, how do I get MyApplicationCode.class?
        }
    }
} 
```

所以我在 process 方法中尝试做的是从下面的原始代码中获取 SomeClass.class 和 MyApplication.class 在编译时进行一些自定义验证。我似乎无法终生弄清楚如何获得这两个值......

```
@CustomAnnotation(clazz=SomeClass.class)
public class MyApplicationCode 
```

**更新：**以下帖子有更多细节，而且更接近。但问题是你最终仍然得到一个 TypeMirror 对象，从中提取类对象，它没有解释：[http ://blog.retep.org/2009/02/13/getting-class-values -来自注释处理器中的注释/](http://blog.retep.org/2009/02/13/getting-class-values-from-annotations-in-an-annotationprocessor/)

**Update2：**您可以通过执行获取 MyApplication.class

```
String classname = ((TypeElement)e).getQualifiedName().toString(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T14:49:04.173

我打算为您指明博客[http://blog.retep.org/2009/02/13/getting-class-values-from-annotations-in-an-annotationprocessor/](http://blog.retep.org/2009/02/13/getting-class-values-from-annotations-in-an-annotationprocessor/)的方向，但看起来像您已经找到那个了。

我看到你想出了如何访问 MyApplication 元素，所以我不会介绍它......

您看到的异常实际上包含其中的注释属性的类型。因此，您可以在捕获异常时引用注释 clazz 值：

```
public class CustomAnnotationProcessor extends AbstractProcessor
{
    private ProcessingEnvironment processingEnvironment;

    @Override
    public synchronized void init(ProcessingEnvironment processingEnvironment)
    {
        this.processingEnvironment = processingEnvironment;
    }

    @Override
    public boolean process(Set<? extends TypeElement> annotations, RoundEnvironment environment)    
    {
        Set<? extends Element> elements = environment.getElementsAnnotatedWith(ActionCommand.class);

        for(Element e : elements)
        {
            CustomAnnotation annotation = e.getAnnotation(CustomAnnotation.class);    

            TypeMirror clazzType = null;
            try {
                annotation.clazz();
            } catch (MirroredTypeException mte) {
                clazzType = mte.getTypeMirror();
            }

            System.out.println(clazzType); // should print out SomeClass

        }
    }
} 
```

是的，这是一个完全破解的解决方案，我不确定为什么 API 开发人员决定使用注释处理器功能朝这个方向发展。但是，我已经看到很多人（包括[我自己](https://github.com/johncarl81/transfuse/blob/master/transfuse/src/main/java/org/androidtransfuse/util/TypeMirrorUtil.java)）实现了这一点，并且提到的文章也描述了这种技术。这似乎是目前可以接受的解决方案。

在“获取”MyApplicationCode 和 SomeClass 的类值方面，如果它们是正在编译的类，您将无法这样做。但是，您可以使用 Element 和 TypeMirror 表示对您的类执行一些高级验证（方法、字段、类名称、存在的注释等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T09:47:38.060

在阅读了这个[相关的 SO question](https://stackoverflow.com/questions/2727710/how-do-you-use-java-1-6-annotation-processing-to-perform-compile-time-weaving)之后，我发现了这个[关于 Java Annotation Processing Tool (APT) 的优秀页面](http://www.javalobby.org/java/forums/t17876)。这是从 2005 年开始的，所以现在可能不是最好的方法。

> APT [...] 是 Java 的注解处理工具。更具体地说，APT 允许您插入代码以在代码编译发生时处理源文件中的注释 - 在此过程中，您可以发出注释、警告和错误。

*   Oracle 文档中有关[Java 6 中 APT 的](http://docs.oracle.com/javase/6/docs/technotes/guides/apt/index.html)更多信息。
*   Oracle 某人关于 APT 的[有趣博文。](https://blogs.oracle.com/darcy/entry/properties_via_annotation_processing)
*   APT 的另一个[用法示例](http://javasign.blogspot.com/2009/08/annotation-checking-at-compile-time.html)——这次是从 2009 年开始。

这仅适用于 Oracle 的 JDK。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-18T23:01:17.590

现在是编译时间。我认为编译器甚至还没有完成源代码的编译。您从 AnnotatedElement 实例中检索此类信息，该实例将为您提供已注释类型的相关信息，但不提供其运行时属性，因为相关类文件尚未由虚拟机加载，因此尚不可用。并且编译器甚至不能保证在 ja​​va 的虚拟机下运行，因此不强制要求能够加载类文件。它的要求只是能够生成任何特定虚拟机都可以读取的字节码。

因此，请检查镜像 Api，有关您已注释的类/方法/字段的任何相关信息，请检查表示该实例的 AnnotatedElement。

顺便说一句：这只是我推理出来的信息，所以它可能不是真正的事实。

# php - 如何使用mysql快速更改带有php的文件夹中的图像名称？

> ID：10660364
> 
> 赞同：1
> 
> 时间：2012-05-18T22:12:16.293
> 
> 标签：php, mysql, image

我有一个图像文件夹，其中有近 200 张图像。我的图像名称是：

```
101.png
102.png
103.png
(it continues until 300.png) 
```

这些图像是我的书在 mysql 数据库中的图像。例如;

```
id | book_name
101| aaaaa
102| bbbbb 
```

所以，我想将我的图像名称更改为书名。也就是说，“aaaa”书的图片名称将是 aaaa.png 而不是 101.png。有什么快速的方法可以做到这一点吗？谢谢....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:28:22.893

这是一个简单的例子：

```
$db = new PDO('mysql:host=myhost;dbname=mydb', 'myuser', 'mypass');
$books = $db->query('SELECT * FROM books');
$images_folder = '/var/bookimages/';

foreach ($books as $book) {
    $old_image_file = realpath($images_folder.$book['id'].'.jpg');
    if ($old_image_file) {
        $clean_book_name = filter_var($book['book_name'], FILTER_SANITIZE_ENCODED);
        $new_image_file = realpath($images_folder).$clean_book_name.'.jpg';
        rename($old_image_file, $new_image_file);
    }
} 
```

*   [PDO](http://php.net/pdo)处理与数据库的交互。这是在 PHP 上连接到数据库的首选方式。
*   `rename()`仅当源名称和目标名称是同一磁盘中的文件时，该功能才有效。就您而言，这应该可以正常工作。
*   我在数据库上使用了一个非常简单的查询。通常，您需要限制它并指定所需的列。
*   我`filter_var`用来检查数据库中的名称是否有效。这是一种安全措施。如果数据库的文件名包含“../”，则该文件不会做坏事。这是必要的，因为`rename()`也可以移动文件并且有人可能会利用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:26:12.753

这是一个概念证明。它应该让你开始。

```
$books = array('100' => 'grapes of wrath', '101' => 'where the red fern grows');

echo '<pre>'; print_r($books); echo '</pre>';

foreach($books AS $key => $value){
    $current_image = $key.'.jpg';
    $new_image = $value.'.jpg';
    echo $current_image.' & '.str_replace(" ", "_",$new_image).'<br />';
    //rename($current_image, $new_image);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:29:02.293

将图像名称更改为书籍名称是一种不好的做法。如果你的名字有特殊符号怎么办？名字太长怎么办？

使用 ID 是更简单和通用的解决方案。

# objective-c - 更新 Xcode 项目设置后无法运行项目

> ID：10660365
> 
> 赞同：0
> 
> 时间：2012-05-18T22:12:18.167
> 
> 标签：objective-c, ios, xcode

最近我按照 Xcode 的建议更新了我的项目设置。我只是按下一个按钮，他们做了“一切”。但是现在当我尝试在我的设备上运行我的应用程序时，它在加载栏上冻结在大约 75%，然后 15 秒后它说“构建成功”但没有在我的设备上运行，一切都停止了，好像我按下了停止按钮。我没有收到任何错误，但收到以下警告。它在模拟器上工作得很好。

作为记录，我已经查过了，每个人都说要添加“armv6 或 armv7”，我已经完成了。我正在运行部署目标 iOS 3.0+

如果有人可以帮助我，将不胜感激。谢谢！

**编辑** 当我在仪器中运行泄漏时在我的设备上工作......但不会没有仪器

[![Xcode 警告](../Images/cb73143af22ed720b892080a127c26bf.png)](https://i.stack.imgur.com/WGpff.png)

[![项目设置](../Images/d231e562ecf148b5ae66d1dc5a273101.png)](https://i.stack.imgur.com/nE9Ll.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:55:48.123

好吧，我在这里不能说太多，但如果一切都失败了，我会尝试制作一个新项目并将该项目的内容复制到新项目中。这可以解决在构建设置等中可能出现的一些潜在问题。

# design-patterns - 为什么会有两种不同的模式：抽象工厂和工厂方法

> ID：10660374
> 
> 赞同：1
> 
> 时间：2012-05-18T22:13:12.370
> 
> 标签：design-patterns

据我了解：

抽象工厂模式提供了创建一系列对象的接口，而工厂方法提供了创建一个对象的接口。

如果这只是这些模式之间的区别，为什么要单独考虑它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T22:21:27.677

回顾这两种模式的定义告诉我们

*   工厂方法用于定义创建**对象**的接口，但让**子类**决定实例化哪个类。工厂方法让一个类将实例化推迟到子类。”

*   抽象工厂用于提供一个接口，用于创建相关或依赖**对象的****系列**，而无需指定它们的具体类。

 **所以你说的是对的。工厂方法关注创建（通常）一个对象，而抽象工厂关注几个相关的对象。

但这还不是全部。如果你看一下我在每个意图中加粗的第二个词，你会发现还有另一个区别，就每个模式的工作机制而言。

*   工厂方法使用 SUBCLASSES 和继承将实例化委托给具体实现。这意味着要创建新产品，您必须继承“创建者”类并覆盖工厂方法。反过来，这个工厂方法返回所需的产品。

*   另一方面，抽象工厂使用 OBJECT 组合（即工厂）进行委托。您必须在“产品”类中更改代码，而不是在创建者类中。具体来说，在产品类中，您定义了几个相关的产品（比如说产品的成分），每个产品都可以使用工厂 OBJECT 创建（组成在产品类中，并在运行时传递）。在这种情况下，创建者类仅创建抽象产品并将产品将使用的工厂传递给该产品。

然而，为了让事情有点混乱，抽象工厂中的中央抽象工厂通常实现工厂方法。这个中心工厂通常为所有的成分定义一系列的工厂方法，并将每种成分的创建委托给具体工厂。

希望能帮助到你。请记住，许多设计模式非常相似，实际上它们是相关的，例如，看看装饰器模式和适配器模式。大多数时候，两种设计模式之间的区别在于它们各自的意图。顺便说一句，我真正喜欢的一本关于设计模式的好书是[Head First Design Pattern](http://shop.oreilly.com/product/9780596007126.do)。还有一个类似的问题贴[在这里](https://stackoverflow.com/questions/4209791/design-patterns-abstract-factory-vs-factory-method)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T22:15:14.047

工厂方法是固定的——你不能在运行时改变它。

抽象工厂允许您创建具有不同工厂的对象，可以在运行时根据某些条件进行选择。

```
Button button = WinButtonFactory.create(); //will always be a "windows button"
Button button = buttonFactory.create(); 
```

像这样的 2 日可以是`WinButtonFactory extends ButtonFactory`或`MacOSXButtonFactory extends ButtonFactory`。您可以根据当前的操作系统传递一个或另一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:31:16.050

抽象工厂模式意味着拥有工厂工厂（具体实现）。**

# cakephp - 在控制器中使用 belongsTo 和 hasMany [CakePHP]

> ID：10660375
> 
> 赞同：0
> 
> 时间：2012-05-18T22:13:16.053
> 
> 标签：cakephp, controller, rewrite, categories

我是 CakePHP 的初学者，

我想知道我如何在控制器的操作中做到这一点：

```
$this->Image->Category->findAllByRewrite($category_rewrite); 
```

我想获取该类别的所有图像..

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:24:42.803

我可能不能 100% 确定您在问什么，但是如果您在 ImagesController 中添加它，那么您就在正确的轨道上。我认为您不需要像您所指示的那样链接 Category 模型。

你会做这样的事情：

```
$category_id = $value;

$images = $this->Image->find('all', array('conditions' => array('Image.category_id' => $category_id))); 
```

通过更多澄清，我可以更改此响应。

# javascript - jQuery：函数未执行

> ID：10660377
> 
> 赞同：0
> 
> 时间：2012-05-18T22:13:17.753
> 
> 标签：javascript, jquery, html, css

我试图执行一个函数两次，但我不知道我做错了什么。JSFiddle在这里：http: [//jsfiddle.net/g6PLu/3/](http://jsfiddle.net/g6PLu/3/)

**Javascript**

```
function truncate() {
    $(this).addClass('closed').children().slice(0,2).show().find('.truncate').show();
}

$('div').each(truncate);

$('.truncate').click(function() {

if ($(this).parent().hasClass('closed')) {
    $(this).parent().removeClass('closed').addClass('open').children().show();
}

else if ($(this).parent().hasClass('open')) {
    $(this).parent().removeClass('open').addClass('closed');
    $('div').each(truncate);
    $(this).show();
}

}); 
```

问题出在第 15 行，这是我`$('div').each(truncate);`第二次打电话的地方。由于某种原因，它似乎没有执行。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:30:15.787

我认为您使一项简单的任务过于复杂。我会利用类来显示/隐藏 CSS 的东西（你正在添加类但不使用它们！）。

看看这个更简单的版本：

**相关CSS**

```
.closed p { display: none; }
.closed p:nth-child(2) { display: block; } 
```

**JS**

```
$('div').addClass('closed');
$('.truncate').click(function() {
    $(this).closest('div').toggleClass('closed');
}); 
```

[http://jsfiddle.net/g6PLu/9/](http://jsfiddle.net/g6PLu/9/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:23:17.810

当您调用显示时，这就是为什么您需要调用隐藏或删除该样式部分的`<p>`更改`<p style="display: block; ">`

这是预期的行为吗？

```
else if ($(this).parent().hasClass('open')) {
    $(this).parent().removeClass('open').addClass('closed').children().hide();
    $('div').each(truncate);
    $(this).show();
} 
```

# javascript - 等待在主干中实例化对象

> ID：10660380
> 
> 赞同：0
> 
> 时间：2012-05-18T22:13:39.147
> 
> 标签：javascript, backbone.js

我很难弄清楚如何最好地做到这一点。我有一个模型，它在其初始化方法中实例化了一些集合。实例化该模型后，我需要立即在其中一个集合中获取模型，但当时我尝试获取该模型似乎不可用，因此我最终得到了“未定义”。这就是我所拥有的：

```
var App = Backbone.Model.extend({
    initialize: function() {
        this.users = new Users();
    }
});
app = new App();
someUser = app.users.get("someuserID"); // -> undefined 
```

但如果我这样做：

```
var App = Backbone.Model.extend({
    initialize: function() {
        this.users = new Users();
    }
});
app = new App();
setTimeout(function(){
    someUser = app.users.get("someuserID"); // -> user instance
},3000); 
```

我尝试将 a 添加`this.trigger("loaded")`到 App 初始化方法，然后监听该事件，但该事件没有触发。像这样：

```
var App = Backbone.Model.extend({
    initialize: function() {
        this.users = new Users();
        this.trigger("loaded");
    }
});
app = new App();
app.on("trigger",function(){ // -> never actually triggers
    someUser = app.users.get("someuserID");
}); 
```

有任何想法吗？

请注意，用户集合正在从一个 RESTful API 中正确获取用户。

谢谢，

路易斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:28:47.003

[根据Backbone 文档](http://backbonejs.org/#Collection-fetch)，当集合完成时`.fetch`，它将触发一个`reset`事件。您没有在此处包含您的课程，但假设它只是一个 Collection 而不是一个包装器，您将执行以下操作：`Users`

```
var App = Backbone.Model.extend({
    initialize: function() {
        this.users = new Users();
    }
});
app = new App();
app.users.on('reset',function() { var someUser = app.users.get("someuserID"); }); 
```

# crystal-reports - Crystal Reports 嵌入图像大小

> ID：10660383
> 
> 赞同：1
> 
> 时间：2012-05-18T22:13:55.920
> 
> 标签：crystal-reports, crystal-reports-10

我无法调整使用 Crystal Reports 10 设计器嵌入的图像[(EMF)的大小。](http://en.wikipedia.org/wiki/Windows_Metafile)我正在使用“插入”菜单并选择图片将图片作为 OLE 对象导入。

我有 2 个工作站可以访问多个报告。每个工作站都以不同的大小导入图像。

我可以在 Workstation 1 上正确导入和调整大小，但在 Workstation 2 上调整图像大小会使图像太小。

对此的任何建议或见解将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T20:12:57.467

我个人对[GDI](http://en.wikipedia.org/wiki/Graphics_Device_Interface)有一些奇怪的问题，我会检查两台机器上的 Windows 高优先级更新和自定义更新。您可能需要应用以下[GDI+ 更新](http://www.microsoft.com/en-us/download/details.aspx?id=18909)。

另一个问题是您在每台计算机上安装了哪个版本的 Crystal Reports 10 Service Pack。我希望这会有所帮助。

# eclipse - Mac OSX 10.7 上 Eclipse 中的 Java FX

> ID：10660384
> 
> 赞同：5
> 
> 时间：2012-05-18T22:13:57.277
> 
> 标签：eclipse, macos, javafx

由于我在 Mac OSX 10.7 上使用 java 开发工具包 1.7.0_04 从 Eclipse 编译 JavaFX 代码时遇到问题，我只想与感兴趣的人分享我的中间解决方案：

问题：

*   在eclipse中选择oracle发布的新jdk作为新jre/jdk时，jfxrt.jar等.jar文件无法识别。

*   jdk 安装在被识别为包的 /Library/Java/JavaVirtualMachines/1.7.0.jdk 中。

*   以后添加路径 /Library/Java/JavaVirtualMachines/1.7.0.jdk/Contents/Home/jre/lib/jfxrt.jar 是不可能的，因为eclipse的文件打开对话框不允许导航到包的内部

解决方案：创建一个从包外部到包内部的符号链接，然后按照文件打开对话框中的链接进行操作。

只需转到终端并执行以下操作：

[0-/库/Java/JavaVirtualMachines]:sudo ln -s 1.7.0.jdk/Contents/1.7.0.jdk_Contents

这将使用超级用户权限 (sudo) 创建符号链接 1.7.0.jdk_Contents。

通过这种 JavaFx 代码的编译和执行，可以正常工作并且符合预期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-24T16:57:02.360

不需要做之前所说的一切，只需使用 Finder 对话框的一个完全未知的行为：拖放。您可以使用以下命令从控制台打开 Finder 窗口：

```
open /Library/Java/JavaVirtualMachines/jdk1.7.0_25.jdk/Contents/Home/jre/lib 
```

所以你会看到 jfxrt.jar 和其他 .jar 文件。将此文件拖到 Eclipse 的 Add external jar 对话框窗口...等等！依赖关系满足！不需要链接！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T00:25:54.503

e(fx)clipse 不支持 jdk1.7.0_u4 中的初始 JavaFX 2.1 版本。该[支持线程](https://groups.google.com/forum/?fromgroups#!topic/efxclipse/JMiJKBjqxeo)表明插件的维护者知道不兼容问题正在向插件存储库推送补丁以修复该问题，同时建议使用 JavaFX 2.2 预览版本。

# iphone - 无法使用 AVFoundation 播放视频

> ID：10660386
> 
> 赞同：1
> 
> 时间：2012-05-18T22:14:01.293
> 
> 标签：iphone, ios, ipad, avfoundation, avplayer

我正在尝试创建一个显示视频文件的 AVPlayer。

这是我到目前为止的代码：

```
- (IBAction) player {
       NSURL* m = [[NSBundle mainBundle] URLForResource:@"Cache" withExtension:@"mov"];
       AVURLAsset* asset = [AVURLAsset URLAssetWithURL:m options:nil];
       AVPlayerItem* item = [AVPlayerItem playerItemWithAsset:asset];
       AVPlayer* p = [AVPlayer playerWithPlayerItem:item];
       self.player = p;
       AVPlayerLayer* lay = [AVPlayerLayer playerLayerWithPlayer:p];
       lay.frame = CGRectMake(10, 76, 303, 265);
       [self.view.layer addSublayer:lay];
       [p play];
} 
```

我已经链接到`AVFoundation.framework`并且`CoreMedia.framework`我已经导入了`<AVFoundation/AVFoundation.h>`.

首先，我收到一个错误，上面写着`property 'player' not found on object of type 'ViewController*`（对于 line `self.player = p;`）。我需要做什么才能让它运行？

此外，在修复错误后，此代码是否可以正常显示视频？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:26:14.870

您的 viewController 显然不包含这样的实例变量。

要解决这个问题，请将以下内容添加到您的 viewController 头文件 (.h) 中：

```
@property (nonatomic, strong) AVPlayer *player; 
```

然后将以下内容添加到您的 viewController 实现文件 (.m) 中：

```
@synthesize player; 
```

第一步将确保您的 viewController 对象实际上拥有一个名为 player 的实例变量。第二步将创建一个匹配的 setter 和 getter。

# c# - ASP.Net Webservice 中的 JQUery 自动完成

> ID：10660389
> 
> 赞同：1
> 
> 时间：2012-05-18T22:14:23.633
> 
> 标签：c#, jquery, asp.net, jquery-autocomplete

这让我发疯，我只是不断收到“错误”消息。我有这个使用 AJAX Toolkit 的自动完成功能，但我想尝试 JQuery，我对 JQuery 的经验很少。这是Web服务代码：

```
 [WebService(Namespace = "http://tempuri.org/")]
  [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
  // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
  [System.Web.Script.Services.ScriptService]
 public class WebService : System.Web.Services.WebService {

public WebService () {

    //Uncomment the following line if using designed components 
    //InitializeComponent(); 
}

[WebMethod]
public static string GetNames(string prefixText, int count)
{
    Trie ArtistTrie = new Trie();
    if (HttpContext.Current.Cache["CustomersTrie"] == null)
    {          
        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["connstring"].ConnectionString);
        SqlCommand comm = new SqlCommand();
        comm.CommandText = "SELECT * FROM TopArtists ORDER BY name ASC";
        SqlDataAdapter da = new SqlDataAdapter();
        DataTable dt = new DataTable();            
        da.SelectCommand = comm;
        comm.Connection = conn;
        conn.Open();
        da.Fill(dt);
        conn.Close();
        Trie newtrie = new Trie();
        foreach (DataRow dr in dt.Rows)
        {
            // topartists.Add(dr[0].ToString());
            newtrie.Add(dr[0].ToString());
        }
        HttpContext.Current.Cache["CustomersTrie"] = newtrie;
    }
     ArtistTrie = (Trie)HttpContext.Current.Cache["CustomersTrie"];

     List<string> list = ArtistTrie.GetCompletionList(prefixText, 10);
     List<Band> list1 = new List<Band>();
     foreach (string a in list)
     {
         Band newband = new Band();
         newband.Name = a;
         list1.Add(newband);
     }
     string json = JsonConvert.SerializeObject(list1, Formatting.Indented);
     return json;

} 
```

这是jQuery代码：

```
 <script type="text/javascript">
      $(document).ready(function () {
        $(function () {
           $("#tb1").autocomplete({

        source: function (request, response) {
            $.ajax({
                url: "WebService.asmx/GetNames",
                data: request.term ,
                dataType: "json",
                type: "POST",
                contentType: "application/json; charset=utf-8",

                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert(textStatus);
                }
            });
        },
        minLength: 2
         });
        });
      }) 
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:39:26.653

一方面，您的 jQuery 代码有错误，包括末尾缺少分号和包装自动完成功能的不必要函数，请尝试：

```
<script type="text/javascript">
    $(document).ready(function() {
        $("#tb1").autocomplete({
            source: function(request, response) {
                $.ajax({
                    url: "WebService.asmx/GetNames",
                    data: request.term,
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    error: function(XMLHttpRequest, textStatus, errorThrown) {
                        alert(textStatus);
                    }
                });
            },
            minLength: 2
        });
    }); 
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T02:07:43.247

对于 ajax 部分，返回需要在数组中，字符串 []

示例代码，

```
 [WebMethod]
    public string[] area(string prefixText)
    {
        List<string> listString = new List<string>();
        using (SqlConnection con = new SqlConnection("Initial Catalog=EMS;Server=S-CEMSDB01;User ID=sa;Password=sqltest"))
        {

            SqlCommand cm = new SqlCommand("select distinct eqp_location from EQUIPMENT where eqp_location like '" + prefixText + "%' order by eqp_location", con);
            con.Open();
            SqlDataReader dr = cm.ExecuteReader();
            if (dr.HasRows)
            {
                while (dr.Read())
                {
                    listString.Add((dr["eqp_location"].ToString()));

                    //c.FullName, serializer.Serialize(c))
                }
            }
            dr.Close();
            dr.Dispose();
            con.Close();
        }
        string[] str = listString.ToArray();
        return str;

    } 
```

# java - 方法中arraylist的arraylist

> ID：10660393
> 
> 赞同：3
> 
> 时间：2012-05-18T22:14:44.897
> 
> 标签：java, android, arraylist

尝试让包含数组列表的数组列表在我的程序中工作时遇到问题，我收到一个奇怪的警告说：将@SuppressWarnings“null”添加到 processArray()，无论我是否添加这个我的程序崩溃，有什么明显的我在这里做错了吗？任何帮助都会大有帮助，谢谢。

```
 private ArrayList<ArrayList<String>> processArray(ResponseList<Status> responses){

      ArrayList<ArrayList<String>> mainArray = null;
      ArrayList<String> innerArrays = null;

      for (Status response: responses ){
          String name, status, imgUrl, time;

          name = response.getUser().getName();
          status = response.getText();
          imgUrl = response.getUser().getProfileImageURL().toString();
          time = response.getCreatedAt().toString();

          ArrayList<String> rtLinks = checkLinks(response.getText());

          if(rtLinks != null){

              for (String tLink: rtLinks){

                  innerArrays.add(name);
                  innerArrays.add(status);
                  innerArrays.add(imgUrl);
                  innerArrays.add(time);
                  innerArrays.add(tLink);

                  mainArray.add(innerArrays);

              }

          }

      }
    return mainArray; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T22:19:54.053

你从来没有真正初始化这些数组列表中的任何一个。

你要

```
ArrayList<ArrayList<String>> mainArray = new ArrayList<ArrayList<String>>(); // or new ArrayList<>() in java 7 
```

并*在内部 for 循环内*：

```
ArrayList<String> innerArrays = new ArrayList<String>(); // or new ArrayList<>() in java 7 
```

此外，永远不要压制警告“只是为了让代码工作”。仅当您确切知道它们出现的原因以及您选择忽略它们的确切原因时才压制它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T22:26:17.770

您的程序可能由于`NullPointerException`. 当您尝试访问其值为的变量时会发生这种情况`null`（称为*取消引用空指针*）。在访问这两个`ArrayList`s 中的任何一个之前，您需要对其进行初始化。尝试将两行更改为：

```
 ArrayList<ArrayList<String>> mainArray = new ArrayList<ArrayList<String>>();
  ArrayList<String> innerArrays = new ArrayList<String>(); 
```

这应该可以解决您的直接问题。

但是，我不确定您为什么要使用`innerArrays`列表。我会将最后一点重构为：

```
for (String tLink: rtLinks){
    ArrayList<String> tempList = new ArrayList<String>();
    tempList.add(name);
    tempList.add(status);
    tempList.add(imgUrl);
    tempList.add(time);
    tempList.add(tLink);
    mainArray.add(tempList);
} 
```

并删除`innerArrays`变量。这样，范围更有限，代码运行更符合逻辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T22:23:52.583

您正在尝试将 innerArrays 变量添加到您的主 ArrayList 中，但您在方法的开头已将您的主 ArrayList 声明为 null。将主 ArrayList 初始化为字符串的 ArrayLists 的新 ArrayList，您的代码应该可以工作。

# python - Libtorrent 通过 python 绑定进行日志记录，可能吗？

> ID：10660394
> 
> 赞同：0
> 
> 时间：2012-05-18T22:14:49.207
> 
> 标签：python, bittorrent, dht, libtorrent

我注意到 Rasterbar/Libtorrent 页面提到了“详细记录 DHT 协议流量”的可能性

[http://www.rasterbar.com/products/libtorrent/building.html](http://www.rasterbar.com/products/libtorrent/building.html)

有谁知道它是否可能与 python 绑定有关？

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:26:46.350

从我在 C++ 源代码中读到的内容来看，使用 dht 日志记录进行编译只会使库日志记录到一个文件 (dht.log) 中，而且在此之上似乎没有任何 API。

现在，您可能需要查看位于 libtorrent 源代码分发根目录的 parse_dht_log.py 文件 - 根据您想要执行的操作，这可能会让您开始解析该日志文件。

希望这可以帮助。

# ruby - 如何在 Rspec 中使用 yield self

> ID：10660398
> 
> 赞同：0
> 
> 时间：2012-05-18T22:15:24.150
> 
> 标签：ruby, rspec, yield

这是对如何在 Rspec 中创建辅助方法的描述，取自 Rspec 书（第 149 页）。此示例假定有一个名为“set_status”的方法，该方法在创建“Thing”对象时触发。

两组代码都创建了一个新的“Thing”对象，设置状态，然后执行“fancy_stuff”。第一组代码对我来说非常清楚。它触发的“it”语句之一，然后使用选项调用“create_thing”方法。创建一个新的“Thing”对象，并使用“options”属性作为参数调用“set_status”方法。

第二组代码类似。触发“it”语句之一，然后调用“given_thing_with”方法，同时将“:status”哈希分配作为参数传递。在“given_thing_with”方法中，“yield”被触发，以“Thing.new”作为参数。这是我遇到麻烦的地方。当我尝试运行此代码时，我收到“block given to yield”错误。我知道，yield 传递的任何属性都将从调用“given_thing_with”方法的“it”语句返回到管括号中的“事物”。我可以得到新的

我不明白为什么在'yield'命令之后没有在'given_thing_with'方法中调用代码块。换句话说，我无法在该块中编写代码来运行。

在此先感谢您的帮助。

这个问题的其余部分直接引用自 Rspec 书：

```
describe Thing do
  def create_thing(options)
    thing = Thing.new
    thing.set_status(options[:status])
    thing
  end

  it "should do something when ok" do
    thing = create_thing(:status => 'ok')
    thing.do_fancy_stuff(1, true, :move => 'left', :obstacles => nil)
    ...
  end

  it "should do something else when not so good" do
    thing = create_thing(:status => 'not so good')
    thing.do_fancy_stuff(1, true, :move => 'left', :obstacles => nil)
    ...
  end
end 
```

您可以应用的一个习惯用法来进一步清理它是从对象中的初始化程序中产生 self 。假设 Thing 的 initialize() 方法执行此操作并且 set_status() 也执行此操作，您可以这样编写前面的内容：

```
describe Thing do
  def given_thing_with(options)
    yield Thing.new do |thing| 
      thing.set_status(options[:status])
    end
  end

  it "should do something when ok" do
    given_thing_with(:status => 'ok') do |thing|
      thing.do_fancy_stuff(1, true, :move => 'left', :obstacles => nil)
      ... 
    end
  end

  it "should do something else when not so good" do
    given_thing_with(:status => 'not so good') do |thing|
      thing.do_fancy_stuff(1, true, :move => 'left', :obstacles => nil)
      ... 
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T02:08:39.930

书中的示例有点混乱，因为`Thing`没有显示 的​​实现。要完成这项工作，您需要这样编写`Thing`：

```
class Thing
  def initialize
    yield self
  end
end 
```

当`given_thing_with`被调用时，它会产生一个 new `Thing`，它会在构造时产生自己。这意味着当执行内部代码块（包含 的代码块`thing.set_status`）时，它将引用新建的`Thing`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T12:16:54.210

**书中的代码有两个问题。**

***1\. 设置初始化器以产生自身***

当 Thing 对象被创建时，它需要一个初始化器并且需要 yield 本身。

```
class Thing
  def initialize
    yield self
  end
end 
```

但是，仅此一项仍然会导致错误，至少在我的系统上是 Ruby 1.9.3。具体来说，错误是“给产量（SyntaxError）的块”。这没有多大意义，因为这是我们希望它做的事情。不管怎样，这就是我得到的错误。

***2.修复'block given to yield'错误***

这并不那么明显，并且与 Ruby 或 'yield' 语句有关，但是使用*本书中所写的 'do...end'*创建一个块，如下所示会导致错误。

```
yield Thing.new do |thing| 
  thing.set_status(options[:status])
end 
```

修复此错误很简单，只需使用大括号“{...}”创建块，如下所示。

```
yield Thing.new { |thing| 
  thing.set_status(options[:status])
} 
```

这对于多行 Ruby 代码来说不是很好的形式，但它可以工作。

***额外的。一系列收益如何设置“事物”对象的参数***

问题已经解决，但这解释了它是如何工作的。

*   “调用者块”使用参数调用“given_thing_with”方法
*   该方法向“调用者块”返回一个新的“事物”和一个块（我将其称为“屈服块”）
*   要执行“yield block”，Thing 类需要初始化和 'yield self'，否则 'set_status' 方法将永远不会运行，因为该块将被忽略
*   新的“事物”已经在“调用者块”中并且已经设置了它的状态，现在执行了相关的方法

# django - Django TemplateDoesNotExist 异常

> ID：10660406
> 
> 赞同：0
> 
> 时间：2012-05-18T22:16:21.513
> 
> 标签：django, templates, exception

我试图使用 django-endless-pagination [twitter pagination](http://django-endless-pagination.readthedocs.org/en/latest/twitter_pagination.html)，但是 Django 正在抛出异常，我在调试它时遇到了麻烦。

创建这些模板后：

search_results.html：

```
<h2>Entries:</h2>
{% include page_template %} 
```

结果.html：

```
{% for object in objects %}
    {# your code to show the entry #}
{% endfor %} 
```

我将它们添加到我的项目模板目录中。然后我创建这个视图：

```
def search(request):
    if 'q' in request.GET:  #Need to add input variable to html code
        q = request.GET['q']
        if q:
            stuff = Stuff.objects.filter(name__icontains=q)
            template = "search_results.html"
            page_template = "results.html"
            if request.is_ajax():
                template = page_template
            return render_to_response(template, locals())
    return render_to_response('search_page.html') 
```

当我转到结果网址时，我得到： **异常类型：** TemplateDoesNotExist

**异常位置：** /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/template/loader.py in find_template，第 138 行

**模板加载器事后分析**

Django 尝试按以下顺序加载这些模板： Using loader django.template.loaders.filesystem.Loader: /Users/some_account/Dropbox/code/project/project/html (File exists) /Users/some_account/Dropbox/code/project /project/course_database/templates（文件存在）使用加载程序 django.template.loaders.app_directories.Loader：/Users/some_account/Dropbox/code/project/project/course_database/templates（文件存在）/Library/Python/2.7/site -packages/endless_pagination/templates（文件存在）/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/contrib/auth/templates（文件存在）/Library/Frameworks/Python .framework/Versions/2.7/lib/python2.7/site-packages/django/contrib/admin/templates（文件存在）/Library/Frameworks/Python.framework/Versions/2.7/lib/python2。7/site-packages/django/contrib/admindocs/templates（文件存在）

模板加载期间的错误位于包含以下内容的行：`{% include page_template %}`

为什么我会得到这个异常，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:45:37.053

在您的 search_results.html 页面中，您有`{% include page_template %}`，并且我假设您正在使用 locals() 将其传递到模板中。你能把它输出到模板上来验证它`page_template`的值是什么吗？代替`{{ page_template }}`以`{% include page_template %}`验证它正在获取正确的 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-29T20:13:31.927

我是新手`Django`，我将安装的应用程序方向放在“模板区域”中并收到此错误。

仔细检查为什么将路由放入模板中，
模板和已安装的应用程序列表都以 开头`djang.something`，但它们是不同的。

# c# - 虚拟鼠标点击 c#

> ID：10660410
> 
> 赞同：1
> 
> 时间：2012-05-18T22:16:38.647
> 
> 标签：c#

我有一个多线程应用程序，需要能够同时执行多个鼠标单击。

我有一个`IntPtr intptr`需要向其发送鼠标点击的进程。我试图在网上找到这些信息，并且有一些我尝试过的例子。但我没有让他们中的任何一个工作。

据我了解，解决我的问题的正确方法是使用该功能 `SendMessage(IntPtr hWnd, int Msg, IntPtr wParam, IntPtr lParam);`

hWnd 是进程的 IntPtr。Msg 是想要的操作，我想要左键单击，`int WM_LBUTTONDBLCLK = 0x0203;` IntPtr wParam 对这个问题没有兴趣（据我了解）并且单击的坐标在 lParam 中。我构造 lParam 像，

```
Int32 word = MakeLParam(x, y);

private int MakeLParam(int LoWord, int HiWord)
     {
         return ((HiWord << 16) | (LoWord & 0xffff));
     } 
```

但正如你可能理解的那样，我无法让它工作。我的第一个问题是，坐标是在这个过程的窗口内还是绝对屏幕坐标？我的第二个问题，我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:54:44.613

我最近试图在 C# 中模拟鼠标点击，我写了这个小助手类来做到这一点：

```
public static class SimInput
{
    [DllImport("user32.dll")]
    static extern void mouse_event(uint dwFlags, uint dx, uint dy, uint dwData, UIntPtr dwExtraInfo);

    [Flags]
    public enum MouseEventFlags : uint
    {
        Move = 0x0001,
        LeftDown = 0x0002,
        LeftUp = 0x0004,
        RightDown = 0x0008,
        RightUp = 0x0010,
        MiddleDown = 0x0020,
        MiddleUp = 0x0040,
        Absolute = 0x8000
    }

    public static void MouseEvent(MouseEventFlags e, uint x, uint y)
    {
        mouse_event((uint)e, x, y, 0, UIntPtr.Zero);
    }

    public static void LeftClick(Point p)
    {
        LeftClick((double)p.X, (double)p.Y);
    }

    public static void LeftClick(double x, double y)
    {
        var scr = Screen.PrimaryScreen.Bounds;
        MouseEvent(MouseEventFlags.LeftDown | MouseEventFlags.LeftUp | MouseEventFlags.Move | MouseEventFlags.Absolute,
            (uint)Math.Round(x / scr.Width * 65535),
            (uint)Math.Round(y / scr.Height * 65535));
    }

    public static void LeftClick(int x, int y)
    {
        LeftClick((double)x, (double)y);
    }
} 
```

坐标是 65535 的一小部分，这有点奇怪，但是这个类会为你处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T22:24:41.257

我不是 100% 确定我了解您要完成的工作。但是，如果您想模拟鼠标输入，那么我建议您使用[SendInput](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646310%28v=vs.85%29.aspx) API。

您可以提供要插入到输入流中的输入数组。

另请参阅：[PInvoke 参考](http://www.pinvoke.net/default.aspx/user32.sendinput)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:42:33.667

我不明白为什么有人想同时发送多个鼠标点击。如果是为了测试你的 GUI，那就是错误的测试。没有人可以在同一时间空间内多次物理点击某物。

但是回到你的问题，使用 SendMessage 不会帮助你，因为它基本上是一个阻塞调用。即使您尝试使用 PostMessage，您也无法完成同时点击，因为消息队列是从 UI 线程中抽取的，并且消息会弹出并按顺序处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T22:49:19.440

我使用此代码单击[句柄中的左按钮](https://stackoverflow.com/questions/902967/what-is-a-windows-handle)

```
public static void MouseLeftClick(Point p, int handle = 0)
{
    //build coordinates
    int coordinates = p.X | (p.Y << 16);
    //send left button down
    SendMessage(handle, 0x201, 0x1, coordinates);
    //send left button up
    SendMessage(handle, 0x202, 0x1, coordinates);
} 
```

如果您在调用时未设置句柄 - 然后它将点击发送到桌面，因此坐标应该是整个屏幕，如果您要设置句柄，那么消息将被发送到句柄的窗口，您应该为窗口设置坐标。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-03T21:53:01.817

只使用 VirtualMouse 怎么样？我在 C# 中使用它，效果很好。

```
 public partial class Form1 : Form
    {
        private VirtualMouse vm = new VirtualMouse();
        public Form1()
        {
            InitializeComponent();
        }
        private void MouseClickHere(Point myPoint)
        {
            vm.ClickIt(myPoint, 150);
        }
        private void Clicker()
        {
             MouseClickHere(new Point(250,350));
        }
    } 
```

# python - 游标和连接对象的区别

> ID：10660411
> 
> 赞同：39
> 
> 时间：2012-05-18T22:16:45.660
> 
> 标签：python, python-db-api

我对为什么 python 需要光标对象感到困惑。我知道 jdbc 并且那里的数据库连接非常直观，但是在 python 中我对游标对象感到困惑。我也怀疑 cursor.close() 和 connection.close() 函数在资源释放方面有什么区别。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-18T22:37:36.197

游标范式并非特定于 Python，而是[数据库本身](http://en.wikipedia.org/wiki/Cursor_%28databases%29)中的一种常见数据结构。

根据底层实现，可能会生成多个共享同一个数据库连接的游标。关闭游标应该释放与查询关联的资源，包括从未从数据库中获取（或已获取但未使用）的任何结果，但不会消除与数据库本身的连接，因此您将能够在同一数据库上获取新游标无需再次验证。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-18T22:58:16.297

正如其他人提到的，a`Connection()`是到数据库的网络连接，它唯一真正的用途是返回游标。 [指定 DBApi 2.0 的PEP-249](http://www.python.org/dev/peps/pep-0249/)没有明确定义连接或游标到底是什么，也没有明确定义`close()`每个方法必须做什么；只有 `*<module>*.connect()` 必须返回 的实例 `*<module>*.Connection` ， `*<module>*.Connection.cursor()` 必须返回 的实例 `*<module>*.Cursor` ，并且 `*<module>*.Cursor.execute()` 应该调用提供的语句并返回结果行。特别是，它没有定义 a `*<module>*.Connection.execute()` ，尽管特定的实现可以自由地将它们实现为扩展。

但是，依赖这些扩展可能是不明智的，因为这意味着您不会拥有可移植的代码。DBApi 提出了这个两级要求，因为在某些数据库上，在没有中间对象的情况下执行连接可能很困难。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-18T22:33:35.403

Connection 对象是您与数据库的连接，当您一起完成与数据库的对话时关闭它。游标对象是查询结果集的迭代器。完成该结果集后关闭它们。

# facebook-like - 为什么不出现类似fb的按钮？

> ID：10660414
> 
> 赞同：7
> 
> 时间：2012-05-18T22:16:58.883
> 
> 标签：facebook-like

我很沮丧，因为我花了几个小时在这上面 - SO 上还有其他线程，但没有一个能解决我的问题！

我只是想在我的网站 www.posti.sh 上实现类似 fb 的按钮 - 我想知道为什么它不起作用？

这是我使用的代码，根据[https://developers.facebook.com/docs/reference/plugins/like/](https://developers.facebook.com/docs/reference/plugins/like/)分步教程：

```
<div id="fb-root"></div> (directly after the opening body tag) 
```

和

```
<div class="fb-like" data-href="http://www.posti.sh" data-send="true" data-width="450" data-show-faces="true"></div> 
```

我希望它在哪里。

我还在头部添加了相应的元标记。

有人知道为什么它不起作用吗？

谢谢！！

丹尼斯

更新 1

我使用了 fb 调试工具[https://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)，它只说 og 图像不够大 - 我想这应该不是问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T22:28:07.170

看起来 HTML5 Like Button 代码中的第 1 步缺少实际添加[Javascript SDK](https://developers.facebook.com/docs/reference/javascript/)的部分。代码应该是：

```
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : 'YOUR_APP_ID', // App ID
      channelUrl : '//WWW.YOUR_DOMAIN.COM/channel.html', // Channel File
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });

    // Additional initialization code here
  };

  // Load the SDK Asynchronously
  (function(d){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all.js";
     ref.parentNode.insertBefore(js, ref);
   }(document));
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T07:27:58.147

刚才我解决了类似的问题。显示了类似 FB 的按钮，但不起作用。

在我的页面`<div id="fb-root"></div>`中是`div`带有`position: relative;`css-attribute 的。删除后`position: relative;`它再次工作。

# mysql - 过滤多租户 MySQL 数据库的最佳方法是什么？

> ID：10660418
> 
> 赞同：2
> 
> 时间：2012-05-18T22:17:34.303
> 
> 标签：mysql, multi-tenant

在 MySQL 中，我有一个具有一个模式的数据库。在 Microsoft Sql Server 中，建议使用“租户视图过滤器”，因此在 Microsoft Sql Server 中，这正是我所需要的。

```
CREATE VIEW TenantEmployees AS 
SELECT * FROM Employees WHERE TenantID = SUSER_SID() 
```

在 MySQL 中完成相同任务的最佳方法是什么？如果性能良好，等效于“租户视图过滤器”将起作用。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T00:36:16.303

您建议的查询（我可以在[MSDN](http://msdn.microsoft.com/en-us/library/aa479086.aspx#mlttntda_tvf)中找到）之后有文本，可以准确解释它的假设是什么。特别是，它提到它假设表中行的“所有者”是在根据您为其分区的用户的 SID 填充`Employees`的字段中指定的。`TenantID`

这意味着您可以复制相同的想法，无论您决定以何种方式实现数据，只要您已明确定义数据分区并确切知道如何将其与您正在为其创建视图的表相关联。

特别是，如果您将系统配置为每个分区使用自己的凭据访问数据库，您可以使用 MySQL 的`CURRENT_USER`or`USER`结构作为定义分区的 ID，并且创建视图的查询将与建议的基本相同在 MSDN 中替换`SUSER_ID`为`CURRENT_USER`.

但是，如果您使用同一用户从所有分区进行访问，那么建议的方法在任一数据库服务器上都无关紧要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-17T10:29:55.453

由于您需要使用您的`tenantId`值来执行过滤，因此表值用户定义函数将是理想的，因为视图通常不接受参数。不幸的是，与许多其他数据库产品不同，[MySQL 不支持表值函数](https://stackoverflow.com/questions/12163666/mysql-function-to-return-a-table)。但是，有一些[声称可以模拟参数化视图的 MySQL hack](https://stackoverflow.com/questions/2281890/can-i-create-view-with-parameter-in-mysql)。这些可能对你有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-23T17:01:34.877

这在 MySQL 中有点棘手，但可以做到：

```
CREATE OR REPLACE VIEW {viewName}
    AS
        SELECT {fieldListWithoutTenantID}
        FROM {tableName}
        WHERE (id_tenant = SUBSTRING_INDEX(USER( ),'@',1)) 
```

我写了一篇完整的博客文章，讲述了我如何在一个周末将单租户 MySQL 应用程序转换为多租户，并且只进行了最小的更改。 [https://opensource.io/it/mysql-multi-tenant/](https://opensource.io/it/mysql-multi-tenant/)

# python - 如何引用当前打开的对话框？

> ID：10660421
> 
> 赞同：0
> 
> 时间：2012-05-18T22:18:13.610
> 
> 标签：python, pyqt

我正在使用 Eric4 和 PyQt4 创建一个应用程序。

我有两个对话框，一个作为线程运行，另一个是带有标签的标准对话框，我想将其更改为图像。

每次主窗口线程运行时，我希望它将对话框中显示的当前图像更改为新图像。一切正常，除了每次线程运行时它都会创建一个包含新图像的新对话框 - 我希望它更改当前打开的对话框中的图像。

带有内部图像的对话框：

```
class SubWindow(QDialog, Ui_subWindow):
    def __init__(self, parent = None):
        QDialog.__init__(self, parent)
        self.setupUi(self)
        self.show()

    def main(self, img):
        pic = self.imgView
        pic.setPixmap(QtGui.QPixmap(os.getcwd() + img)) 
```

更改图像的线程：

```
class MainWindow(QDialog, Ui_MainWindow,  threading.Thread):
    def __init__(self, parent = None):
        threading.Thread.__init__(self)
        QDialog.__init__(self, parent)
        self.setupUi(self)
        self.show()
        #some code here which does some stuff then calls changeImg()

    def changeImg(self):
        img = SubWindow()
        img.main(img) 
```

我没有包括我所有的代码，只有相关的位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:53:03.293

看起来问题是`SubWindow`每次您希望更改图像时都在创建一个新图像。我建议在函数中创建`SubWindow`作为属性：`MainWindow``MainWindiw.__init__`

```
class MainWindow(QDialog, Ui_MainWindow,  threading.Thread):

    def __init__(self, parent = None):
        threading.Thread.__init__(self)
        QDialog.__init__(self, parent)
        self.setupUi(self)
        self.show()
        self.img = SubWindow() # Create SubWindow once here

    def changeImg(self):
        self.img.main(self.img) # Only change the image, no new SubWindow 
```

# asp.net - asp.net 更新窗格不会触发事件

> ID：10660432
> 
> 赞同：0
> 
> 时间：2012-05-18T22:20:38.737
> 
> 标签：asp.net, ajax, vb.net, visual-studio-2010

我正在尝试在我的网页上实现更新面板。当我添加这个时，一切正常：

```
<script runat="server">
    Protected Sub Button2_Click(ByVal sender As Object, ByVal e As System.EventArgs)
        Me.Label2.Text = Date.Now.ToString
    End Sub
</script>

<asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
<ContentTemplate>
    <fieldset>
        <asp:Label ID="label1" runat="server" Text="Label"></asp:Label>
        <asp:Button ID="Button1" runat="server" Text="Button" onclick="Button1_Click" />
        <asp:Label ID="Label2" runat="server" Text="Label"></asp:Label>
        <asp:Button ID="Button2" runat="server" Text="Button" />
    </fieldset>
</ContentTemplate>  
</asp:UpdatePanel>

  <asp:TextBox ID="TextBox1" runat="server" Height="289px" TextMode="MultiLine" 
                        Width="663px" ReadOnly="True"></asp:TextBox> 
```

当我尝试对应用程序的 on_load 事件做一些事情时，问题就来了。在后面的代码中，我尝试这样做：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) _
        Handles Me.Load

    If Not IsPostBack Then
    ....a function that produces a very long xml string
        Me.TextBox1.Text ="<f"
    End If
End Sub 
```

这将导致事件不发生。如果我`"<"`从字符串中更改，一切都很好。为什么`"<"`我的琴弦里不能有？这很重要，因为我不允许我在文本框中放置一个 xml 字符串。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:49:13.640

尝试使用`&lt<`而不是`<`

# mysql - 无法使用 rails 连接到远程 mysql 数据库

> ID：10660434
> 
> 赞同：1
> 
> 时间：2012-05-18T22:20:56.127
> 
> 标签：mysql, ruby-on-rails, ruby, database, remote-access

我无法使用 mysql2 gem 连接到远程 mysql 数据库。

我收到此错误：

```
Host 'my_ip' is not allowed to connect to this MySQL server 
```

我的 db.yml 说：

```
remote_development:
  adapter: mysql2
  reconnect: false
  host: host_ip
  encoding: utf8
  database: host_db
  pool: 5
  username: root
  password: 
```

当我尝试通过我的 sql 或 telnet 连接时，我完全没有问题。我已经两次和三次检查了我的 yml 中的数据，但无法通过这个。任何的想法？

顺便说一句，我正在使用 Rails 3.2.3、Ruby 1.9.3，并尝试了 mysql2 v 0.2.18 和 0.3.11 ...请帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:04:24.677

我解决了这个，很简单...

我刚刚为具有特定权限的数据库创建了一个新用户和密码，而不是使用 root :)

应该从一开始就尝试这个。我认为这是正确的做法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:58:52.737

这似乎是一条 MySQL 错误消息。我认为问题可能出在您使用的用户帐户上。设置时应该用`'username'@'%'`格式设置。百分号表示所有 IP 地址。然后，您应该`flush privileges`在服务器上使该帐户可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T05:10:10.173

发展：

适配器：mysql2

编码：utf8

重新连接：假

数据库：mystore_development

游泳池：5

用户名：root

密码：密码

主机：本地主机

试试这个肯定会奏效...

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-29T12:49:44.160

改变你的`host:localhost`，然后再试一次，它会起作用

# python - 创建长多行字符串的 Pythonic 方法

> ID：10660435
> 
> 赞同：1704
> 
> 时间：2012-05-18T22:21:09.633
> 
> 标签：python, string, multiline, multilinestring

我有一个很长的查询。我想在 Python 中将它分成几行。在 JavaScript 中做到这一点的一种方法是使用几个句子并将它们与一个`+`运算符连接起来（我知道，也许这不是最有效的方法，但我并不真正关心这个阶段的性能，只是代码可读性） . 例子：

```
var long_string = 'some text not important. just garbage to' +
                  'illustrate my example'; 
```

我尝试在 Python 中做类似的事情，但没有奏效，所以我习惯于`\`拆分长字符串。但是，我不确定这是否是唯一/最好/pythonicest 的方法。看起来很尴尬。实际代码：

```
query = 'SELECT action.descr as "action", '\
    'role.id as role_id,'\
    'role.descr as role'\
    'FROM '\
    'public.role_action_def,'\
    'public.role,'\
    'public.record_def, '\
    'public.action'\
    'WHERE role.id = role_action_def.role_id AND'\
    'record_def.id = role_action_def.def_id AND'\
    'action.id = role_action_def.action_id AND'\
    'role_action_def.account_id = ' + account_id + ' AND'\
    'record_def.account_id=' + account_id + ' AND'\
    'def_id=' + def_id 
```

* * *

## 回答 #1

> 赞同：2850
> 
> 时间：2012-05-18T22:22:54.710

你说的是多行字符串吗？很简单，使用三引号来开始和结束它们。

```
s = """ this is a very
        long string if I had the
        energy to type more and more ...""" 
```

您也可以使用单引号（其中 3 个当然在开始和结束处）并将生成的字符串`s`与任何其他字符串一样对待。

**注意**：就像任何字符串一样，开始和结束引号之间的任何内容都会成为字符串的一部分，所以这个例子有一个前导空格（正如@root45 指出的那样）。该字符串还将包含空格和换行符。

IE，：

```
' this is a very\n        long string if I had the\n        energy to type more and more ...' 
```

最后，还可以像这样在 Python 中构造长行：

```
 s = ("this is a very"
      "long string too"
      "for sure ..."
     ) 
```

这将**不**包括任何额外的空格或换行符（这是一个故意的示例，显示了跳过空格将导致什么效果）：

```
'this is a verylong string toofor sure ...' 
```

不需要逗号，只需将要连接的字符串放在一对括号中，并确保考虑任何需要的空格和换行符。

* * *

## 回答 #2

> 赞同：260
> 
> 时间：2012-05-18T22:26:35.373

如果您不想要多行字符串，而只是有一个长的单行字符串，则可以使用括号。只要确保在字符串段之间不包含逗号（那么它将是一个元组）。

```
query = ('SELECT   action.descr as "action", '
         'role.id as role_id,'
         'role.descr as role'
         ' FROM '
         'public.role_action_def,'
         'public.role,'
         'public.record_def, '
         'public.action'
         ' WHERE role.id = role_action_def.role_id AND'
         ' record_def.id = role_action_def.def_id AND'
         ' action.id = role_action_def.action_id AND'
         ' role_action_def.account_id = '+account_id+' AND'
         ' record_def.account_id='+account_id+' AND'
         ' def_id='+def_id) 
```

在您正在构建的 SQL 语句中，多行字符串也可以。但是，如果多行字符串包含的额外空格会成为问题，那么这将是实现您想要的一个好方法。

如评论中所述，**以这种方式连接 SQL 查询是等待发生的 SQL 注入安全风险**，因此请使用数据库的参数化查询功能来防止这种情况。但是，我将按原样保留答案，因为它直接回答了所提出的问题。

* * *

## 回答 #3

> 赞同：170
> 
> 时间：2014-06-20T16:16:55.663

断线`\`对我有用。这是一个例子：

```
longStr = "This is a very long string " \
        "that I wrote to help somebody " \
        "who had a question about " \
        "writing long strings in Python" 
```

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2013-01-04T10:39:29.597

我发现自己对这个很满意：

```
string = """This is a
very long string,
containing commas,
that I split up
for readability""".replace('\n',' ') 
```

* * *

## 回答 #5

> 赞同：57
> 
> 时间：2014-06-19T07:06:24.120

我发现在构建长字符串时，您通常会执行构建 SQL 查询之类的操作，在这种情况下这是最好的：

```
query = ' '.join((  # Note double parentheses. join() takes an iterable
    "SELECT foo",
    "FROM bar",
    "WHERE baz",
)) 
```

Levon的[建议](https://stackoverflow.com/questions/10660435/pythonic-way-to-create-a-long-multi-line-string/10660443#10660443)很好，但可能容易出错：

```
query = (
    "SELECT foo"
    "FROM bar"
    "WHERE baz"
)

query == "SELECT fooFROM barWHERE baz"  # Probably not what you want 
```

* * *

## 回答 #6

> 赞同：48
> 
> 时间：2018-06-07T16:58:29.713

这种方法使用：

*   使用三引号字符串几乎没有内部标点符号
*   `inspect`使用模块去除局部缩进
*   `account_id`对和`def_id`变量使用 Python 3.6 格式化字符串插值 ('f') 。

这种方式在我看来是最 Pythonic 的。

```
import inspect

query = inspect.cleandoc(f'''
    SELECT action.descr as "action",
    role.id as role_id,
    role.descr as role
    FROM
    public.role_action_def,
    public.role,
    public.record_def,
    public.action
    WHERE role.id = role_action_def.role_id AND
    record_def.id = role_action_def.def_id AND
    action.id = role_action_def.action_id AND
    role_action_def.account_id = {account_id} AND
    record_def.account_id={account_id} AND
    def_id={def_id}'''
) 
```

* * *

## 回答 #7

> 赞同：41
> 
> 时间：2015-10-06T22:33:07.997

您还可以在使用 """ 表示法时包含变量：

```
foo = '1234'

long_string = """fosdl a sdlfklaskdf as
as df ajsdfj asdfa sld
a sdf alsdfl alsdfl """ +  foo + """ aks
asdkfkasdk fak""" 
```

更好的方法是使用命名参数和 .format()：

```
body = """
<html>
<head>
</head>
<body>
    <p>Lorem ipsum.</p>
    <dl>
        <dt>Asdf:</dt>     <dd><a href="{link}">{name}</a></dd>
    </dl>
    </body>
</html>
""".format(
    link='http://www.asdf.com',
    name='Asdf',
)

print(body) 
```

* * *

## 回答 #8

> 赞同：29
> 
> 时间：2017-04-25T18:47:47.443

在 Python >= 3.6 中，您可以使用[格式化字符串文字（f 字符串）](https://docs.python.org/3.6/reference/lexical_analysis.html#f-strings)

```
query= f'''SELECT   action.descr as "action"
    role.id as role_id,
    role.descr as role
    FROM
    public.role_action_def,
    public.role,
    public.record_def,
    public.action
    WHERE role.id = role_action_def.role_id AND
    record_def.id = role_action_def.def_id AND
    action.id = role_action_def.action_id AND
    role_action_def.account_id = {account_id} AND
    record_def.account_id = {account_id} AND
    def_id = {def_id}''' 
```

* * *

## 回答 #9

> 赞同：22
> 
> 时间：2016-05-12T12:05:08.100

例如：

```
sql = ("select field1, field2, field3, field4 "
       "from table "
       "where condition1={} "
       "and condition2={}").format(1, 2)

Output: 'select field1, field2, field3, field4 from table
         where condition1=1 and condition2=2' 
```

如果条件的值应该是一个字符串，你可以这样做：

```
sql = ("select field1, field2, field3, field4 "
       "from table "
       "where condition1='{0}' "
       "and condition2='{1}'").format('2016-10-12', '2017-10-12')

Output: "select field1, field2, field3, field4 from table where
         condition1='2016-10-12' and condition2='2017-10-12'" 
```

* * *

## 回答 #10

> 赞同：20
> 
> 时间：2018-07-05T06:55:59.737

我发现[这里](https://amir.rachum.com/blog/2018/06/23/python-multiline-idioms/)[`textwrap.dedent`](https://docs.python.org/2/library/textwrap.html)描述的最适合长字符串：

```
def create_snippet():
    code_snippet = textwrap.dedent("""\
        int main(int argc, char* argv[]) {
            return 0;
        }
    """)
    do_something(code_snippet) 
```

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2019-05-06T23:13:44.613

其他人已经提到了括号方法，但我想用括号添加它，允许内联注释。

### 评论每个片段：

```
nursery_rhyme = (
    'Mary had a little lamb,'          # Comments are great!
    'its fleece was white as snow.'
    'And everywhere that Mary went,'
    'her sheep would surely go.'       # What a pesky sheep.
) 
```

### 继续后不允许评论：

使用反斜杠续行符 ( `\`) 时，不允许使用注释。你会收到一个`SyntaxError: unexpected character after line continuation character`错误。

```
nursery_rhyme = 'Mary had a little lamb,' \  # These comments
    'its fleece was white as snow.'       \  # are invalid!
    'And everywhere that Mary went,'      \
    'her sheep would surely go.'
# => SyntaxError: unexpected character after line continuation character 
```

### 对正则表达式字符串的更好评论：

基于来自[https://docs.python.org/3/library/re.html#re.VERBOSE](https://docs.python.org/3/library/re.html#re.VERBOSE)的示例，

```
a = re.compile(
    r'\d+'  # the integral part
    r'\.'   # the decimal point
    r'\d*'  # some fractional digits
) 
```

```
# Using VERBOSE flag, IDE usually can't syntax highight the string comment.
a = re.compile(r"""\d +  # the integral part
                   \.    # the decimal point
                   \d *  # some fractional digits""", re.X) 
```

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2020-04-08T14:41:49.880

作为在 Python 中处理长字符串的一般方法，您可以使用三引号，`split`并且`join`：

```
_str = ' '.join('''Lorem ipsum dolor sit amet, consectetur adipiscing
        elit, sed do eiusmod tempor incididunt ut labore et dolore
        magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation
        ullamco laboris nisi ut aliquip ex ea commodo.'''.split()) 
```

输出：

```
'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo.' 
```

关于 OP 关于 SQL 查询的问题，下面的答案忽略了这种构建 SQL 查询的方法的正确性，只关注以可读和美观的方式构建长字符串，而不需要额外的导入。它也忽略了这带来的计算负载。

使用三引号，我们构建了一个长且可读的字符串，然后我们将其分解为一个列表，`split()`从而去除空白，然后将其与`' '.join()`. `format()`最后我们使用命令插入变量：

```
account_id = 123
def_id = 321

_str = '''
    SELECT action.descr AS "action", role.id AS role_id, role.descr AS role
    FROM public.role_action_def, public.role, public.record_def, public.action
    WHERE role.id = role_action_def.role_id
    AND record_def.id = role_action_def.def_id
    AND' action.id = role_action_def.action_id
    AND role_action_def.account_id = {}
    AND record_def.account_id = {}
    AND def_id = {}
    '''

query = ' '.join(_str.split()).format(account_id, account_id, def_id) 
```

产生：

```
SELECT action.descr AS "action", role.id AS role_id, role.descr AS role FROM public.role_action_def, public.role, public.record_def, public.action WHERE role.id = role_action_def.role_id AND record_def.id = role_action_def.def_id AND action.id = role_action_def.action_id AND role_action_def.account_id = 123 AND record_def.account_id=123 AND def_id=321 
```

这种方法不符合[PEP 8](https://pep8.org/)，但我发现它有时很有用。

请注意，原始字符串中的大括号由 format() 函数使用。

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2017-11-14T19:16:44.270

我个人认为以下是在 Python 中编写原始 SQL 查询的最佳（简单、安全和 Pythonic）方法，尤其是在使用[Python 的 sqlite3 模块](https://docs.python.org/3/library/sqlite3.html)时：

```
query = '''
    SELECT
        action.descr as action,
        role.id as role_id,
        role.descr as role
    FROM
        public.role_action_def,
        public.role,
        public.record_def,
        public.action
    WHERE
        role.id = role_action_def.role_id
        AND record_def.id = role_action_def.def_id
        AND action.id = role_action_def.action_id
        AND role_action_def.account_id = ?
        AND record_def.account_id = ?
        AND def_id = ?
'''
vars = (account_id, account_id, def_id)   # a tuple of query variables
cursor.execute(query, vars)   # using Python's sqlite3 module 
```

### 优点

*   简洁的代码（Pythonic！）
*   **远离 SQL 注入**
*   与 Python 2 和 Python 3 兼容（毕竟它是 Pythonic）
*   不需要字符串连接
*   无需确保每行最右边的字符是空格

### 缺点

*   由于查询中的变量被`?`占位符替换，当查询中有很多变量时，跟踪`?`哪个 Python 变量将被哪个变量替换可能会变得有点困难。

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2019-08-12T16:05:49.720

**tl;dr：使用`"""\`and`"""`来包装字符串**，如

```
string = """\
This is a long string
spanning multiple lines.
""" 
```

来自[官方 Python 文档](https://docs.python.org/3.7/tutorial/introduction.html#strings)：

> 字符串文字可以跨越多行。一种方法是使用三引号："""...""" 或 '''...'''。行尾自动包含在字符串中，但可以通过在行尾添加 \ 来防止这种情况。下面的例子：

```
print("""\
Usage: thingy [OPTIONS]
     -h                        Display this usage message
     -H hostname               Hostname to connect to
""") 
```

> 产生以下输出（请注意，不包括初始换行符）：

```
Usage: thingy [OPTIONS]
     -h                        Display this usage message
     -H hostname               Hostname to connect to 
```

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2021-10-12T07:44:01.633

添加到@Levon的答案....

**1\. 像这样创建一个多行字符串：**

```
paragraph = """this is a very
        long string if I had the
        energy to type more and more ..."""

print(paragraph) 
```

输出：

```
'this is a very\n        long string if I had the\n        energy to type more and more ...' 
```

该字符串将包含换行符和空格。所以删除它们。

**2.使用正则表达式删除多余的空格**

```
paragraph = re.sub('\s+', ' ', paragraph)
print(paragraph) 
```

输出：

```
'this is a very long string if I had the energy to type more and more ...' 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2018-06-21T17:36:05.487

我通常使用这样的东西：

```
text = '''
    This string was typed to be a demo
    on how could we write a multi-line
    text in Python.
''' 
```

如果要删除每行中烦人的空格，可以执行以下操作：

```
text = '\n'.join(line.lstrip() for line in text.splitlines()) 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2012-05-18T22:25:30.547

您的实际代码不应该工作；您在“行”末尾缺少空格（例如，`role.descr as roleFROM...`）。

多行字符串有三引号：

```
string = """line
  line2
  line3""" 
```

它将包含换行符和额外的空格，但对于 SQL 来说这不是问题。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2022-01-05T17:51:43.390

嗯。

I know it's been a long time since this question got posted. But I just found the style I would like to use to assign long and multiline strings to variables in my projects. This takes a bit of extra runtime, but still preserves the beauty of the code, even if the variable I am assigning my string to is heavily indented.

```
 # Suppose the following code is heavily indented
    line3header = "Third"
    variable = fr"""

First line.
Second line.
{line3header} line.
{{}} line.
...
The last line.

    """
    variable = variable.strip()
    variable = variable.format("Fourth")
    variable += "\n" 
```

There it goes.

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2019-06-19T19:17:46.423

尝试这样的事情。就像这种格式一样，它会返回一条连续的线，就像您已成功查询此属性一样：

```
"message": f'You have successfully inquired about '
           f'{enquiring_property.title} Property owned by '
           f'{enquiring_property.client}' 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2020-11-18T02:48:22.790

**结合以下想法：**

[Levon](https://stackoverflow.com/a/10660443/14658777)或[Jesse](https://stackoverflow.com/a/10660477/14658777)、[Faheel](https://stackoverflow.com/a/47293614/14658777)和[ddrscott](https://stackoverflow.com/a/56013473/14658777)

使用我的格式建议，您可以将查询编写为：

```
query = ('SELECT'
             ' action.descr as "action"'
             ',role.id as role_id'
             ',role.descr as role'
         ' FROM'
             ' public.role_action_def'
             ',public.role'
             ',public.record_def'
             ',public.action'
         ' WHERE'
             ' role.id = role_action_def.role_id'
             ' AND'
             ' record_def.id = role_action_def.def_id'
             ' AND'
             ' action.id = role_action_def.action_id'
             ' AND'
             ' role_action_def.account_id = ?' # account_id
             ' AND'
             ' record_def.account_id = ?'      # account_id
             ' AND'
             ' def_id = ?'                     # def_id
         )

 vars = (account_id, account_id, def_id)     # A tuple of the query variables
 cursor.execute(query, vars)                 # Using Python's sqlite3 module 
```

或者像：

```
vars = []
query = ('SELECT'
             ' action.descr as "action"'
             ',role.id as role_id'
             ',role.descr as role'
         ' FROM'
             ' public.role_action_def'
             ',public.role'
             ',public.record_def'
             ',public.action'
         ' WHERE'
             ' role.id = role_action_def.role_id'
             ' AND'
             ' record_def.id = role_action_def.def_id'
             ' AND'
             ' action.id = role_action_def.action_id'
             ' AND'
             ' role_action_def.account_id = '
                 vars.append(account_id) or '?'
             ' AND'
             ' record_def.account_id = '
                 vars.append(account_id) or '?'
             ' AND'
             ' def_id = '
                 vars.append(def_id) or '?'
         )

 cursor.execute(query, tuple(vars))  # Using Python's sqlite3 module 
```

与 'IN' 和 'vars.extend(options) 或 n_options(len(options))' 一起使用可能会很有趣，其中：

```
def n_options(count):
    return '(' + ','.join(count*'?') + ')' 
```

或者根据[darkfeline](https://stackoverflow.com/a/24300699/14658777)的提示，您可能仍然会在使用前导空格和分隔符以及命名占位符时出错：

```
SPACE_SEP = ' '
COMMA_SEP = ', '
AND_SEP   = ' AND '

query = SPACE_SEP.join((
    'SELECT',
        COMMA_SEP.join((
        'action.descr as "action"',
        'role.id as role_id',
        'role.descr as role',
        )),
    'FROM',
        COMMA_SEP.join((
        'public.role_action_def',
        'public.role',
        'public.record_def',
        'public.action',
        )),
    'WHERE',
        AND_SEP.join((
        'role.id = role_action_def.role_id',
        'record_def.id = role_action_def.def_id',
        'action.id = role_action_def.action_id',
        'role_action_def.account_id = :account_id',
        'record_def.account_id = :account_id',
        'def_id = :def_id',
        )),
    ))

vars = {'account_id':account_id,'def_id':def_id}  # A dictionary of the query variables
cursor.execute(query, vars)                       # Using Python's sqlite3 module 
```

请参阅[Cursor.execute-function 的文档](https://docs.python.org/3.7/library/sqlite3.html#sqlite3.Cursor.execute)。

“这是 [最 Pythonic] 的方式！” - ...

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2021-10-14T09:23:29.090

我知道这是一个相当古老的问题，但与此同时 Python 发生了变化，我没有看到这个答案，所以我们开始吧。

另一种方法是使用 \ 剪切当前行并移动到另一行：

```
print("This line will \
get carried over to\
 the new line.\
Notice how this\
word will be together because \
of no space around it") 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2012-05-21T22:25:13.500

您还可以将 SQL 语句放在单独的文件中`action.sql`，然后将其加载到 .py 文件中：

```
with open('action.sql') as f:
   query = f.read() 
```

因此 SQL 语句将与 Python 代码分离。如果 SQL 语句中有参数需要从 Python 中填充，您可以使用字符串格式（如 %s 或 {field}）。

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2016-09-19T13:32:22.417

当代码（例如，变量）被缩进并且输出字符串应该是单行（没有换行符）时，我认为另一个选项更具可读性：

```
def some_method():

    long_string = """
A presumptuous long string
which looks a bit nicer
in a text editor when
written over multiple lines
""".strip('\n').replace('\n', ' ')

    return long_string 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2017-04-12T03:00:00.600

“À la” *Scala*方式（但我认为这是 OP 要求的最 Pythonic 方式）：

```
description = """
            | The intention of this module is to provide a method to
            | pass meta information in markdown_ header files for
            | using it in jinja_ templates.
            |
            | Also, to provide a method to use markdown files as jinja
            | templates. Maybe you prefer to see the code than
            | to install it.""".replace('\n            | \n','\n').replace('            | ',' ') 
```

如果您希望最终 str 没有跳转线，只需将其放在`\n`第二个替换的第一个参数的开头：

```
.replace('\n            | ',' ')`. 
```

注意：“...模板”之间的白线。并且 "Also, ..." 之后需要一个空格`|`。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2019-08-12T16:09:05.900

来自[官方 Python 文档](https://docs.python.org/3.7/tutorial/introduction.html#strings)：

> 字符串文字可以跨越多行。一种方法是使用三引号："""...""" 或 '''...'''。行尾自动包含在字符串中，但可以通过在行尾添加 \ 来防止这种情况。下面的例子：

```
print("""\
Usage: thingy [OPTIONS]
     -h                        Display this usage message
     -H hostname               Hostname to connect to
""") 
```

> 产生以下输出（请注意，不包括初始换行符）：

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2015-04-09T00:39:22.633

我使用递归函数来构建复杂的 SQL 查询。这种技术通常可用于构建大字符串，同时保持代码的可读性。

```
# Utility function to recursively resolve SQL statements.
# CAUTION: Use this function carefully, Pass correct SQL parameters {},
# TODO: This should never happen but check for infinite loops
def resolveSQL(sql_seed, sqlparams):
    sql = sql_seed % (sqlparams)
    if sql == sql_seed:
        return ' '.join([x.strip() for x in sql.split()])
    else:
        return resolveSQL(sql, sqlparams) 
```

PS：如果需要，请查看很棒的*[python-sqlparse](http://sqlparse.readthedocs.org/en/latest/api/#sqlparse.format)*库以漂亮地打印 SQL 查询。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-06-01T12:58:19.057

我喜欢这种方法，因为它优先阅读。在我们有长字符串的情况下，没有办法！根据您所处的缩进级别，每行仍限制为 80 个字符...嗯...无需多说

在我看来，Python 风格指南仍然很模糊。我采用了[Eero Aaltonen 方法](https://stackoverflow.com/questions/10660435/pythonic-way-to-create-a-long-multi-line-string/14155520#14155520)，因为它优先考虑阅读和常识。我知道风格指南应该帮助我们，而不是让我们的生活一团糟。

```
class ClassName():
    def method_name():
        if condition_0:
            if condition_1:
                if condition_2:
                    some_variable_0 =\
"""
some_js_func_call(
    undefined,
    {
        'some_attr_0': 'value_0',
        'some_attr_1': 'value_1',
        'some_attr_2': '""" + some_variable_1 + """'
    },
    undefined,
    undefined,
    true
)
""" 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-01-03T14:44:46.493

为了在字典中定义一个长字符串， **保留换行符但省略空格**，我最终将字符串定义为一个常量，如下所示：

```
LONG_STRING = \
"""
This is a long sting
that contains newlines.
The newlines are important.
"""

my_dict = {
   'foo': 'bar',
   'string': LONG_STRING
} 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2022-01-02T07:03:48.417

**创建字符串**

Python 字符串是通过将字符串的内容分配给写在双引号或单引号内的变量来创建的

```
Str1 ="Ramesh"  

Str2 ='Mahesh'

print(Str1) #Ramesh

print(Str2) #Mahesh 
```

**索引字符串**

使用索引方法提取字符串（字符）的内容很有帮助，其中 python 字符串索引从索引零开始（Python 字符串索引为零）

```
Example of extracting string using positive string indexing :

Str1 = "Ramesh"

Str1[0] = "R"

Str1[1] = "a"

Str1[2] = "m"

Str1[3] = "e"

Str1[4] = "s"

Str1[5] = "h" 
```

使用负字符串索引提取字符串的示例：

```
Str1 = "Ramesh"

Str1[-6] = "R"

Str1[-5] = "a"

Str1[-4] = "m"

Str1[-3] = "e"

Str1[-2] = "s"

Str1[-1] = "h" 
```

`print(Str1[0]) #'R'`

`print(Str1[0:]) #'Ramesh'`

`print(Str1[2:]) #'mesh'`

`print(Str1[:6]) #'Ramesh'`

`print(Str1[-1:]) #'Ramesh'`

**创建长多行字符串的 Pythonic 方法**

```
"""Creating Python Comments. Python provides a single option to create a comment, using the pound sign, sometimes called the hash symbol
Python Multiline Comments with Consecutive Single-Line Comments
Python Multiline Comments with Multiline Strings
""" 
```

* * *

## 回答 #30

> 赞同：-11
> 
> 时间：2018-09-28T10:56:50.700

通常，我将`list`and`join`用于多行注释/字符串。

```
lines = list()
lines.append('SELECT action.enter code here descr as "action", ')
lines.append('role.id as role_id,')
lines.append('role.descr as role')
lines.append('FROM ')
lines.append('public.role_action_def,')
lines.append('public.role,')
lines.append('public.record_def, ')
lines.append('public.action')
query = " ".join(lines) 
```

您可以使用任何字符串来连接所有这些列表元素，例如 ' `\n`'（换行符）或 ' `,`'（逗号）或 ' '（空格）。

# java - 如何将新的 JFrame 附加到已经制作的框架上？

> ID：10660436
> 
> 赞同：0
> 
> 时间：2012-05-18T22:21:15.737
> 
> 标签：java, swing, jframe, layout-manager

如何将框架连接到现有框架？

下面的代码是appletframe 的代码。我想要做的是添加其他代码，用于将框架连接到 AppletFrame 的底部，这样当我拖动 AppletFrame 时，我们也一起拖动框架代码。基本上，我希望将框架代码与 appletFrame 附加在一起，以便两个框架都在一起。

## 小程序框架

```
 appletFrame = new JFrame(Settings.serverName);
            Loader.webclient = false;
            appletFrame.setLayout(new BorderLayout());
            appletFrame.setDefaultCloseOperation(3);
            appletPanel.setLayout(new BorderLayout());
            appletFrame.setIconImage(Toolkit.getDefaultToolkit().getImage(this.getClass().getResource("/resources/icon.png")));
            appletPanel.add(this);
            appletPanel.setPreferredSize(new Dimension(767, 537));
            appletFrame.getContentPane().add(appletPanel, "Center");
            appletFrame.pack();
            appletFrame.setLocationRelativeTo(null);
            appletFrame.setVisible(true);
    JMenuBar jmenubar = new JMenuBar();
            appletFrame.setJMenuBar(jmenubar);
            Layout = new FlowLayout();
            ImageIcon keyboard = new ImageIcon(Toolkit.getDefaultToolkit().getImage(this.getClass().getResource("/resources/keyboard.png")));
            ImageIcon wrench = new ImageIcon(Toolkit.getDefaultToolkit().getImage(this.getClass().getResource("/resources/wrench.png")));
            Button1 = new JButton("Vote");
            Button2 = new JButton("Item List");
            Button3 = new JButton("Screenshot");
            Button4 = new JButton(wrench);
            Button5 = new JButton(keyboard);
            Button4.setBorder(null);
            Button4.setBorderPainted(false);
            Button4.setContentAreaFilled(false);
            Button5.setBorder(null);
            Button5.setBorderPainted(false);
            Button5.setContentAreaFilled(false);
            jmenubar.setLayout(Layout);
            jmenubar.add(Button1);
            jmenubar.add(Button2);
            jmenubar.add(Button3);
            jmenubar.add(Button4);
            jmenubar.add(Button5);
            Button1.addActionListener(this);
            Button2.addActionListener(this);
            Button3.addActionListener(this);
            Button4.addActionListener(this);
            Button5.addActionListener(this);
            Button1.setText("Vote");
            Button2.setText("Item List");
            Button3.setText("Screenshot"); 
```

我希望它与 AppletFrame 连接的框架。我希望将它附加到 appletFrame 的底部，但我不知道该怎么做。

```
JFrame frame = new JFrame(); 
        frame.setSize(775,121); 
        frame.setResizable(false); 
        JTextArea textArea = new JTextArea("TEST"); 
        textArea.setSize(400,400);          
        textArea.setLineWrap(true);     
        textArea.setEditable(false);    
        textArea.setVisible(true);     
        JScrollPane scroll = new JScrollPane (textArea);    
        scroll.setVerticalScrollBarPolicy   (JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);          
        scroll.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS);     
        frame.add(scroll);    
        frame.setVisible(true);     
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T23:08:13.423

正如我在第一条评论中提到的那样，这个 GUI 最好合并到一个顶级容器中。

这是一个 SSCCE ¹（在我的第二条评论中提到），它显示了基本思想，虽然现在我对所需的效果有了更好的了解，但`JSplitPane`似乎不太合适。在这里，我只是将 GUI 元素组合到相同的布局中。

![测试GUI](../Images/90e03de20cf0e942938af6ad5e1a7c98.png)

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

class TestGUI extends JPanel {

    TestGUI() {
        JFrame appletFrame = new JFrame("Settings.serverName");
        appletFrame.setLayout(new BorderLayout());
        appletFrame.setDefaultCloseOperation(3);

        JPanel appletPanel = new JPanel(new BorderLayout());

        appletPanel.add(this);
        appletPanel.setPreferredSize(new Dimension(767, 537));
        appletFrame.getContentPane().add(appletPanel, BorderLayout.CENTER);

        // Don't use a menu-bar as a tool-bar!
        JToolBar jmenubar = new JToolBar();
        appletPanel.add(jmenubar, BorderLayout.PAGE_START);
        JButton Button1 = new JButton("Vote");
        JButton Button2 = new JButton("Item List");
        JButton Button3 = new JButton("Screenshot");
        JButton Button4 = new JButton("wrench");
        JButton Button5 = new JButton("keyboard");
        Button4.setBorder(null);
        Button4.setBorderPainted(false);
        Button4.setContentAreaFilled(false);
        Button5.setBorder(null);
        Button5.setBorderPainted(false);
        Button5.setContentAreaFilled(false);
        jmenubar.setLayout(new FlowLayout());
        jmenubar.add(Button1);
        jmenubar.add(Button2);
        jmenubar.add(Button3);
        jmenubar.add(Button4);
        jmenubar.add(Button5);

        JTextArea textArea = new JTextArea("TEST", 4, 65 );
        textArea.setLineWrap(true);
        textArea.setEditable(false);
        textArea.setVisible(true);
        JScrollPane scroll = new JScrollPane (
            textArea,
            JScrollPane.VERTICAL_SCROLLBAR_ALWAYS,
            JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS);
        appletPanel.add(scroll, BorderLayout.PAGE_END);

        appletFrame.pack();
        appletFrame.setLocationByPlatform(true);
        appletFrame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater( new Runnable() {
            public void run() {
                new TestGUI();
            }
        });
    }
} 
```

1.  是的，如果我有一个 SSCCE 开始，这会更早到来。;)

# java - 服务器集群的缓存方法

> ID：10660437
> 
> 赞同：1
> 
> 时间：2012-05-18T22:21:18.957
> 
> 标签：java, caching, jboss, memcached, distributed-caching

我在 JBoss AS 5.1 集群上部署了一个 Java 应用程序，它需要缓存大量（> 3 GB）数据。现在服务器集群只有 2 个节点（独立的机器）。以下是具体要求：

*   **两个节点都不应要求将数据加载到缓存中（即，应该有复制或缓存应该驻留在单独的服务器上）***   数据不应过期。

    *上述两个要求对于应用程序都非常重要。如果在提出建议时牢记这两点，我将不胜感激。* 我还应该添加第三个要求：

    *   使用方便

    该应用程序最初使用 Hashmap。我尝试用 JBoss Cache 3.2.1 替换 hashmap，因为它的复制和线程安全特性。但我对 JBoss Cache 的性能并不满意。此外，当我在缓存中加载数据时，几乎完全使用了 8 Gig 的 RAM（其中大部分由缓存条目使用）。

    我想听听那些自己处理过这种缓存场景的人的经验。提前感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T17:04:08.123

您可以尝试使用 GigaSpaces XAP 数据网格是一个复制缓存。它的性能非常高。

[http://www.gigaspaces.com/datagrid](http://www.gigaspaces.com/datagrid)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-12T13:45:28.643

如果您想要一个提供 Java HashMap 接口并且可以轻松支持千兆字节缓存数据且不会过期的缓存，请查看 Oracle Coherence。这将使用 Coherence “分布式缓存”选项（这是默认配置）。有关详细信息，请参阅：[http ://coherence.oracle.com/](http://coherence.oracle.com/)

*   松紧带。只需添加节点。自动发现。自动负载平衡。没有数据丢失。没有中断。每次添加一个节点，您都会获得更多的数据容量和更高的吞吐量。
*   同时使用 RAM 和闪存。透明地。每个 Coherence 节点轻松处理 10 甚至 100 千兆字节（例如，每个物理服务器高达 1 TB 或更多）。
*   自动高可用性 (HA)。杀死一个进程，没有数据丢失。杀死一个服务器，没有数据丢失。
*   数据中心持续可用性 (CA)。杀死一个数据中心，没有数据丢失。

*为了全面披露，我在 Oracle 工作。这篇文章中表达的观点和观点是我自己的，并不一定反映我雇主的观点或观点。*

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-19T00:10:41.630

我之前已经“解决”了这个问题（工作代码，无法显示）......但是，我可以告诉你这么多：

*   对于大容量，HashMaps 的开销会使用大量内存。
*   您可以通过使用数组的智能使用替换 java.util.* 类来节省大量内存。
*   每次分配内存时，您还必须在 GC 中扫描/收集该内存，因此节省内存也可以提高性能。

尽可能使用数组....

编辑：显然 Hash Maps 的概念已被遗忘.... HashMap 的 Java 实现是否让人们相信它是唯一的方法？一组结构化的数组，具有哈希函数和二进制排序......所有基本结构...... [http://en.wikipedia.org/wiki/Hash_table](http://en.wikipedia.org/wiki/Hash_table)

一个要添加键的数组。用于存储值的并行数组，以及用于快速查找键数组的基于 int 的哈希表...

计算机科学 - 也许是第二年 ;-)

再次编辑：我曾经在这里的 JDOM 项目中描述过核心概念：[https ://github.com/hunterhacker/jdom/blob/master/core/src/java/org/jdom2/StringBin.java](https://github.com/hunterhacker/jdom/blob/master/core/src/java/org/jdom2/StringBin.java)

# android - 将视图的标签与整数进行比较

> ID：10660438
> 
> 赞同：7
> 
> 时间：2012-05-18T22:21:21.960
> 
> 标签：android, tags, integer, compare

我正在尝试将整数数组与我唯一制作的图像视图的标签进行比较。

使用这条线：

```
if(grid[i][j] == buttons[k].getTag()){ 
```

我知道我在正确的轨道上，但我不知道我是否需要投射它或使用一种方法。我知道这是一个简单的问题，但任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-19T15:15:41.850

标签是一个对象，所以放一个`Integer`：

```
/*
 * UseValueOf
 * ----------
 * Priority: 4 / 10
 * Severity: Warning
 * Category: Performance
 * 
 * You should not call the constructor for wrapper classes directly, such as`new
 * Integer(42)`. Instead, call the valueOf factory method, such as
 * Integer.valueOf(42). This will typically use less memory because common
 * integers such as 0 and 1 will share a single instance.
 */
//MyView.setTag(new Integer(42));
MyView.setTag(Integer.valueOf(42)); 
```

然后像这样检索值：

```
int tagValue = (Integer)MyView.getTag(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-19T07:17:54.117

您必须将 button[k].getTag() 转换为整数。

做这个：

```
if(grid[i][j] == Integer.parseInt(buttons[k].getTag().toString())){ 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-18T22:35:18.840

我认为你的标签是一个字符串而不是一个整数。

如果是这种情况，请将您的整数转换为字符串（）并检查它是否等于（）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-14T09:48:36.627

您传入一个整数并获取一个索引变量。这是代码片段

```
int Index = Integer.parseInt(v.getTag().toString());
System.out.println(Index); 
```

# objective-c - Objective-C：无法将原语放入 NSDictionary 并成功检索它们

> ID：10660439
> 
> 赞同：0
> 
> 时间：2012-05-18T22:21:40.853
> 
> 标签：objective-c, nsdictionary, nsnumber, primitive

我知道我不能直接把它们放进去，但我必须把它们转换成一个`NSNumber`，例如。我将它们转换为`NSNumber`s，然后将它们放入字典中。我立即记录我正在填充的键，它们是空白的。

这是一个例子：

```
- (NSDictionary*) dictionaryFromWrestler
{
    /* 
     * Used ot create a dictionary from the instance of the wrestler
     * Can be used to send and receive wrestlers through notification center
     */
    NSDictionary* dictionary;

    NSNumber* _score = [NSNumber numberWithInt:score];

    dictionary = [NSDictionary dictionaryWithObjectsAndKeys:firstName, @"firstName", lastName, @"lastName", fullName, @"fullName", shortName, @"shortName", team, @"team", seed, @"seed", actualWeight, @"actualWeight", dob, @"dob", club, @"club", hometown, @"hometown", state, @"state", grade, @"grade", extraField, @"extraField",  phone, @"phone", address, @"address", zip, @"zip", record, @"record", gradeAbbr, @"gradeAbbr", twid, @"twid", teamId, @"teamId", position, @"position", _score, @"score", [NSNumber numberWithInt:teamScore], @"teamScore", [NSNumber numberWithInt:period1Score], @"period1Score", [NSNumber numberWithInt:period2Score], "@period2Score", [NSNumber numberWithInt:periods], @"periods", [NSNumber numberWithBool:hasRidingTime], @"hasRidingTime", nil];

NSLog(@"dictionaryFromWrestler Score: %@", lastName);
NSLog(@"dictionaryFromWrestler Score: %i", score);
NSLog(@"dictionaryFromWrestler Score: %@", _score);
NSLog(@"dictionaryFromWrestler Score: %d", [[dictionary objectForKey:@"score"] intValue]);
NSLog(@"dictionaryFromWrestler Score: %@", [dictionary valueForKey:@"score"]);
NSLog(@"dictionaryFromWrestler Score: %@", [dictionary valueForKey:@"lastName"]);

    return dictionary;
} 
```

我的日志如下所示：

```
2012-05-18 17:46:53.117 Wrestling Tools[31509:403] dictionaryFromWrestler Score: Brown
2012-05-18 17:46:53.117 Wrestling Tools[31509:403] dictionaryFromWrestler Score: 2
2012-05-18 17:46:53.117 Wrestling Tools[31509:403] dictionaryFromWrestler Score: 2
2012-05-18 17:46:53.117 Wrestling Tools[31509:403] dictionaryFromWrestler Score: (null)
2012-05-18 17:46:53.117 Wrestling Tools[31509:403] dictionaryFromWrestler Score: (null)
2012-05-18 17:46:53.117 Wrestling Tools[31509:403] dictionaryFromWrestler Score: Brown 
```

如您所见，原语失败了，但对象工作。有没有搞错？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T22:26:03.630

"%@" 是对象的格式说明符，但您得到的是数字的 intValue。您想要`NSLog(@"dictionaryFromWrestler Score: %d", [[dictionary objectForKey:@"score"] intValue])`或`NSLog(@"dictionaryFromWrestler Score: %@", [dictionary objectForKey:@"score"])`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-19T13:36:47.577

该方法在遇到值`-[NSDictionary dictionaryWithObjectsAndKeys:]`时停止处理其参数列表。`nil`这不仅仅意味着`nil`你写的文字；它是计算结果为的任何参数`nil`（因为，当然，该方法无法区分）。

`_score`因此，在 , 之前的looong 列表中的某个值肯定会`nil`过早地截断列表。因此，字典确实没有关键的“分数”。

# regex - 不贪婪的正则表达式

> ID：10660442
> 
> 赞同：6
> 
> 时间：2012-05-18T22:22:03.210
> 
> 标签：regex

我指的是正则表达式备忘单。它说

`{3,5}`方法`3,4,and 5`

`{3,5}?`表示`3,4,5`不贪心 +

说明什么`ungreedy +`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-18T22:25:57.740

限定符`{3,5}?`意味着它将首先尝试匹配 3 个匹配项，然后查看表达式的其余部分是否匹配。如果表达式的其余部分失败，它将回溯并尝试 4，最后是 5。

贪婪的版本`{3,5}`会以相反的顺序尝试匹配——最长的在前。

请注意，贪婪不会影响字符串是否匹配。它只影响引擎执行搜索的顺序，如果有捕获组，则影响捕获的内容。

这是一个演示差异的示例。想象一下你有字符串`aaaaabc`。

*   `(a{3,5})(\w*)`将捕获`aaaaa`和`bc`。[（红字）](http://rubular.com/r/dPXPRdZnos)
*   `(a{3,5}?)(\w*)`将捕获`aaa`和`aabc`。[（红字）](http://rubular.com/r/lFrahwxpjX)

# c# - WCF 客户端使用 WS-Security 调用 java web 服务

> ID：10660444
> 
> 赞同：1
> 
> 时间：2012-05-18T22:22:57.577
> 
> 标签：c#, .net, wcf

**日志输出**

```
25/05/2012 2:08:57 PM org.jcp.xml.dsig.internal.dom.DOMXMLSignature validate
FINE: Reference[#uuid-26810b23-330b-49c0-af30-59c2a8211341-1] is valid: true
25/05/2012 2:08:57 PM org.jcp.xml.dsig.internal.dom.DOMReference dereference
FINE: URIDereferencer class name: org.jcp.xml.dsig.internal.dom.DOMURIDereferencer
25/05/2012 2:08:57 PM org.jcp.xml.dsig.internal.dom.DOMReference dereference
FINE: Data class name: org.jcp.xml.dsig.internal.dom.ApacheNodeSetData
25/05/2012 2:08:57 PM org.jcp.xml.dsig.internal.dom.ApacheCanonicalizer transform
FINE: Created transform for algorithm: http://www.w3.org/2001/10/xml-exc-c14n#
25/05/2012 2:08:57 PM org.jcp.xml.dsig.internal.dom.ApacheCanonicalizer transform
FINE: ApacheData = true
25/05/2012 2:08:57 PM org.jcp.xml.dsig.internal.dom.DOMReference validate
FINE: Expected digest: q9/MlLVrhvl21tGGmxuBVh1V4Mc=
25/05/2012 2:08:57 PM org.jcp.xml.dsig.internal.dom.DOMReference validate
FINE: Actual digest: bFCOsfjajqOmn3mWNcMw+HRtyPM=
25/05/2012 2:08:57 PM org.jcp.xml.dsig.internal.dom.DOMXMLSignature validate
**FINE: Reference[#e23c17af-c76f-4aaf-bc28-33c5261a253d] is valid: false
25/05/2012 2:08:57 PM org.jcp.xml.dsig.internal.dom.DOMXMLSignature validate
FINE: Couldn't validate the References**
org.apache.ws.security.WSSecurityException: The signature or decryption was invalid
at org.apache.ws.security.processor.SignatureProcessor.verifyXMLSignature(SignatureProcessor.java:393)
at org.apache.ws.security.processor.SignatureProcessor.handleToken(SignatureProcessor.java:188)
at org.apache.ws.security.WSSecurityEngine.processSecurityHeader(WSSecurityEngine.java:396)
at org.apache.ws.security.WSSecurityEngine.processSecurityHeader(WSSecurityEngine.java:304)
at org.apache.ws.security.WSSecurityEngine.processSecurityHeader(WSSecurityEngine.java:249)
at org.apache.ws.security.WSSecurityEngine.processSecurityHeader(WSSecurityEngine.java:203)
at au.gov.mca.uhi.security.dsig.XWSSDigitalSignatureProcessorTest.testVerifyWithWSS4J(XWSSDigitalSignatureProcessorTest.java:355)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:611)
at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:44)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:180)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:41)
at org.junit.runners.ParentRunner$1.evaluate(ParentRunner.java:173)
at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)
at org.junit.runners.ParentRunner.run(ParentRunner.java:220)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:45)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196) 
```

**SOAP 安全令牌**

> ```
>  <o:Security s:mustUnderstand="1"
>             xmlns:o="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
>   <u:Timestamp u:Id="uuid-26810b23-330b-49c0-af30-59c2a8211341-1">
>     <u:Created>2012-05-25T03:58:21.289Z</u:Created>
>     <u:Expires>2012-05-25T04:03:21.289Z</u:Expires>
>   </u:Timestamp>
>   <o:BinarySecurityToken u:Id="uuid-bf155ac7-0ca3-459f-acb5-d8acf3a882d4-2"
>                          ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3">MIIF1zCCBL+gAwIBAgIDBHONMA0GCSqGSIb3DQEBBQUAMH8xCzAJBgNVBAYTAkFVMQwwCgYDVQQKEwNHT1YxGzAZBgNVBAsTEk1lZGljYXJlIEF1c3RyYWxpYTFFMEMGA1UEAxM8VGVzdCBNZWRpY2FyZSBBdXN0cmFsaWEgT3JnYW5pc2F0aW9uIENlcnRpZmljYXRpb24gQXV0aG9yaXR5MB4XDTExMDkyMDA2MzkwMFoXDTE2MDgxNDA1NDMwOFowgZExCzAJBgNVBAYTAkFVMQwwCgYDVQQIEwNBQ1QxFDASBgNVBAcTC1RVR0dFUkFOT05HMRowGAYDVQQKExFUZXN0IExvY2F0aW9uIDAyNzEaMBgGA1UECxMRVGVzdCBMb2NhdGlvbiAwMjcxJjAkBgNVBAMTHVRlc3QgTG9jYXRpb24gMDI3IDo1NjU3MDUwMDkxMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzEdwMFSGslbPo9jTWar8g1pEf+Y3/ppErJUyr92JYqWlIxIU2iHpsx/xKi8wiPgn6ZDrWmULqXaI7xTwjBlaYvBuz7CJ3rfXXk74Fx4VnoGBqxnMiE4ineaxEcOsaL6C/BJnrSEwVJ8PWt1nMguQcmfJhsOV9FWCcGz7FpL4tGkXIa4TG1IEOxgyYPYUH0glcUzAaBd+PGOw9PRts/cW7NugQ7BRP7Q3tNO/T9c2E+2TDaDGUAAhtBHZp1YNTGHSUaBk9LtRWBFt7l/V5amd992tyNci4sy0woyYqcHSbdNBYJGEjs5ZoQUtnLqR37hjHxvp+FBAvh/VKSg36RzQ/wIDAQABo4ICRzCCAkMwDAYDVR0TAQH/BAIwADAwBgNVHREEKTAngSV0ZXN0LmxvY2F0aW9uMDI3QGh1bWFuc2VydmljZXMuZ292LmF1ME8GCCsGAQUFBwEBBEMwQTA/BggrBgEFBQcwAYYzaHR0cDovL29jc3AuY2VydGlmaWNhdGVzLWF1c3RyYWxpYS5jb20uYXUvbWFvY2EucGt4MIIBIQYDVR0gBIIBGDCCARQwggEQBgoqJNL+gHcBBgECMIIBADCBywYIKwYBBQUHAgIwgb4agbtDZXJ0aWZpY2F0ZXMgaXNzdWVkIHVuZGVyIHRoaXMgQ1AgbXVzdCBvbmx5IGJlIHJlbGllZCBvbiBieSBlbnRpdGllcyB3aXRoaW4gdGhlIENvbW11bml0eSBvZiBJbnRlcmVzdCwgdW5sZXNzIG90aGVyd2lzZSBhZ3JlZWQsIGFuZCBub3QgZm9yIHB1cnBvc2VzIG90aGVyIHRoYW4gdGhvc2UgcGVybWl0dGVkIGJ5IHRoaXMgQ1AuMDAGCCsGAQUFBwIBFiRodHRwOi8vd3d3Lm1lZGljYXJlYXVzdHJhbGlhLmdvdi5hdS8wGQYJKiSjkJUXAc4ZBAwWCjU2NTcwNTAwOTEwDgYDVR0PAQH/BAQDAgeAMBMGA1UdIwQMMAqACEB3qFEIQ4yzMDgGA1UdHwQxMC8wLaAroCmGJ2h0dHA6Ly9tYS10ZXN0LXBraS9NQU9DQUNSTHMvbGF0ZXN0LmNybDARBgNVHQ4ECgQIQ8IlQG3+PcIwDQYJKoZIhvcNAQEFBQADggEBAJW0OQRaUmXt0hiov8xHLFrlwOWdkWHFL/9/zmZlFuBNhpZPgYcXpLjC1S3cA5btWAFwMYMBa8igWsvjhFyjjKYhxMlYgnJzKQx2sc6pUXuId2qhGhikWmgzT+Wdy6soP8FKJPLSwBlkTUVq8ep+yIfBx3tYfnK79n/+FX1bz52/nFZmnpZwkEhTB8f9y/GuyzO/pt0F9bel4txZPj36XIHF0k/9SuzpLzwkmAy+89tWu0L4+0J8CLkgfiGprPKW6HByJZWmZyAqs9UIOy2FXnL/CdozZKXnxmEIgTCkcPgSs0olm/A/Wfv4wdsPrNWMmqGL73AoSfM2wgHmQ9k4mPU=</o:BinarySecurityToken>
>   <wsse:UsernameToken wsu:Id="e23c17af-c76f-4aaf-bc28-33c5261a253d"
>                       xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"
>                       xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
>     <wsse:Username>user1</wsse:Username>
>     <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest">icnriCyW09WOpQABOeQqFEiqxwY=</wsse:Password>
>     <wsse:Nonce EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">wbwf0IRtQBA6fsrmpQd8fA==</wsse:Nonce>
>     <wsu:Created>2012-05-25T13:58:21Z</wsu:Created>
>   </wsse:UsernameToken>
>   <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
>     <SignedInfo>
>       <CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
>       <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
>       <Reference URI="#_1">
>         <Transforms>
>           <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
>         </Transforms>
>         <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
>         <DigestValue>8Po0d4s3JJB1Xh4vdB6+7M/ivoA=</DigestValue>
>       </Reference>
>       <Reference URI="#_2">
>         <Transforms>
>           <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
>         </Transforms>
>         <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
>         <DigestValue>Azl0elmnUzxTSLUuwfWf6DLT8h8=</DigestValue>
>       </Reference>
>       <Reference URI="#_3">
>         <Transforms>
>           <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
>         </Transforms>
>         <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
>         <DigestValue>h1iD7HzEK+uslbPRHjwN2zt7zhc=</DigestValue>
>       </Reference>
>       <Reference URI="#_4">
>         <Transforms>
>           <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
>         </Transforms>
>         <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
>         <DigestValue>WZ3YS9m3NBoROTnEKUEJ/bNmMDw=</DigestValue>
>       </Reference>
>       <Reference URI="#_5">
>         <Transforms>
>           <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
>         </Transforms>
>         <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
>         <DigestValue>k69pykploFPkXhw5ogDHcjcJUI0=</DigestValue>
>       </Reference>
>       <Reference URI="#_6">
>         <Transforms>
>           <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
>         </Transforms>
>         <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
>         <DigestValue>TSr1cnqSoYmoEIURjA5OZB/iyS0=</DigestValue>
>       </Reference>
>       <Reference URI="#uuid-26810b23-330b-49c0-af30-59c2a8211341-1">
>         <Transforms>
>           <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
>         </Transforms>
>         <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
>         <DigestValue>wSsjhUgRFAN3by438s7ZvGSSgCw=</DigestValue>
>       </Reference>
>       <Reference URI="#e23c17af-c76f-4aaf-bc28-33c5261a253d">
>         <Transforms>
>           <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
>         </Transforms>
>         <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
>         <DigestValue>q9/MlLVrhvl21tGGmxuBVh1V4Mc=</DigestValue>
>       </Reference>
>     </SignedInfo>
>     <SignatureValue>t/piYSnEwCIzqMxC0LQs9fxUla2BKA0GkMI4oLLqZdkthCo9LNvxJP8Luf1d91CEETZ5B4FsQI7QtcA+qHya78K5s+mzn8/2zhEGzAYxkaLeDCUvrad10Mlqssh5AhLbxonZ4/7mDs1v5+s7EVqM0tjpc0tHK0vmroNz0qnAxjCZqEEYpK3/uJ4iwO86khk5pQwqArrwUAqV26/8sXi6c5CfoZcGaVzjIKSAuc+ybV0O42c5OECMe+9G5ZJAkRkw+korLSKgeslLZa18+g/x7WMeUmbo9wiPLuT5kdvIkGRpPN22CQYeSblTFly26J5LIaPdZFSBIAOT3bYs6G4bxA==</SignatureValue>
>     <KeyInfo>
>       <o:SecurityTokenReference>
>         <o:Reference URI="#uuid-bf155ac7-0ca3-459f-acb5-d8acf3a882d4-2"/>
>       </o:SecurityTokenReference>
>     </KeyInfo>
>   </Signature>
> </o:Security>
>     <SignatureValue>t/piYSnEwCIzqMxC0LQs9fxUla2BKA0GkMI4oLLqZdkthCo9LNvxJP8Luf1d91CEETZ5B4FsQI7QtcA+qHya78K5s+mzn8/2zhEGzAYxkaLeDCUvrad10Mlqssh5AhLbxonZ4/7mDs1v5+s7EVqM0tjpc0tHK0vmroNz0qnAxjCZqEEYpK3/uJ4iwO86khk5pQwqArrwUAqV26/8sXi6c5CfoZcGaVzjIKSAuc+ybV0O42c5OECMe+9G5ZJAkRkw+korLSKgeslLZa18+g/x7WMeUmbo9wiPLuT5kdvIkGRpPN22CQYeSblTFly26J5LIaPdZFSBIAOT3bYs6G4bxA==</SignatureValue>
>     <KeyInfo>
>       <o:SecurityTokenReference>
>         <o:Reference URI="#uuid-bf155ac7-0ca3-459f-acb5-d8acf3a882d4-2"/>
>       </o:SecurityTokenReference>
>     </KeyInfo>
>   </Signature>
> </o:Security> 
> ```

我已经尝试了几乎所有我可以使用检查器和编码器来做到这一点但到目前为止没有运气，任何帮助将不胜感激。请

**当前代码：**

```
 AsymmetricSecurityBindingElement securityBindingElement = new AsymmetricSecurityBindingElement();
        securityBindingElement.EndpointSupportingTokenParameters.Signed.Add(new UsernameTokenParameters());
        X509SecurityTokenParameters initiator
                = new X509SecurityTokenParameters(X509KeyIdentifierClauseType.IssuerSerial,
                                                                                    SecurityTokenInclusionMode.AlwaysToRecipient);
        initiator.RequireDerivedKeys = false;
        initiator.ReferenceStyle = SecurityTokenReferenceStyle.Internal;

        securityBindingElement.InitiatorTokenParameters = initiator;
        X509SecurityTokenParameters recipient
                = new X509SecurityTokenParameters(X509KeyIdentifierClauseType.IssuerSerial,
                                                                                    SecurityTokenInclusionMode.AlwaysToInitiator);
        recipient.RequireDerivedKeys = false;
        securityBindingElement.RecipientTokenParameters = initiator;
        securityBindingElement.SetKeyDerivation(false);
        securityBindingElement.IncludeTimestamp = true;
        securityBindingElement.DefaultAlgorithmSuite = SecurityAlgorithmSuite.Basic128;
        securityBindingElement.MessageSecurityVersion = MessageSecurityVersion
                                .WSSecurity11WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10;
        X509SecurityTokenParameters tokenParameters = new X509SecurityTokenParameters();
        tokenParameters.InclusionMode = SecurityTokenInclusionMode.AlwaysToRecipient;
        tokenParameters.RequireDerivedKeys = false;
        securityBindingElement.MessageProtectionOrder = MessageProtectionOrder.SignBeforeEncrypt;

        HttpTransportBindingElement httpBindingElement = new HttpTransportBindingElement();

        CustomBinding binding = new CustomBinding();
        binding.Elements.Add(securityBindingElement);
        binding.Elements.Add(new TextMessageEncodingBindingElement(MessageVersion.Soap12WSAddressing10, Encoding.UTF8));
        //binding.Elements.Add(new CustomEncoderBindingElement());
        binding.Elements.Add(httpBindingElement);
        EndpointAddress serviceAddress = new EndpointAddress(new Uri("http://xya.com"),
                                                                                                                 EndpointIdentity.CreateDnsIdentity(
                                                                                                                    "Test Location 027 :5657050091"),
                                                                                                                 new AddressHeaderCollection());
        ChannelFactory<DhsUserAuthUploadHposDvaStatementsPortTypeChannel> channelFactory =
            new ChannelFactory<DhsUserAuthUploadHposDvaStatementsPortTypeChannel>(binding, serviceAddress);
        UsernameClientCredentials credentials = new UsernameClientCredentials(new UsernameInfo("user1", "user1"));
        credentials.ServiceCertificate.Authentication.CertificateValidationMode = X509CertificateValidationMode.PeerTrust;
        credentials.ClientCertificate.SetCertificate(StoreLocation.CurrentUser, StoreName.My, X509FindType.FindByThumbprint,
                                                                                                 "6c1a76f952028e092cea367d40d6cf5833d9d3a3");
        credentials.ServiceCertificate.SetDefaultCertificate(StoreLocation.CurrentUser, StoreName.TrustedPeople,
                                                                                                                 X509FindType.FindByThumbprint,
                                                                                                                 "6c1a76f952028e092cea367d40d6cf5833d9d3a3");
        channelFactory.Endpoint.Behaviors.Remove(typeof(ClientCredentials));
        channelFactory.Endpoint.Behaviors.Add(credentials);
        var client = channelFactory.CreateChannel();
        client.upload(); 
```

我已经尝试了几乎所有我可以使用检查器和编码器来做到这一点但到目前为止没有运气，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T12:16:37.267

这里的挑战是您需要一个带有消息摘要 + 已创建 + 随机数的用户名令牌，并且您需要它签名。如果您有任何方法可以取消其中一项要求，那将会更容易。否则这是一个方向，它将需要一些工作。

1.  看看[这个项目](http://blogs.msdn.com/b/aszego/archive/2010/06/24/usernametoken-profile-vs-wcf.aspx)。您的朋友可以帮助您以请求的格式创建用户名令牌。

2.  为了创建安全绑定元素使用

    SecurityBindingElement.CreateMutualCertificateBindingElement()

    然后像上面那样添加用户名令牌（一个表单项#1）。

    请注意，您将需要 sepcify 服务证书。您可能没有或不需要一个，因此只需在服务凭证属性中提供任何虚拟证书，它甚至可以与客户端证书相同。

3.  如果您还没有这样做，请使用以下命令装饰您的合同（reference.cs？）：

    [ServiceContract(ProtectionLevel = ProtectionLevel.Sign)]

    因为（从部分肥皂信封看来）你只使用签名而不是加密。

# jquery - 如何在电子邮件用户名的第一个和最后一个字符中禁止特殊字符

> ID：10660452
> 
> 赞同：0
> 
> 时间：2012-05-18T22:23:53.933
> 
> 标签：jquery, regex, validation, character

我有一个我正在尝试对其进行验证的表单。要求规定电子邮件用户名中允许使用下划线和连字符，但不允许使用特殊字符（包括连字符和下划线）作为电子邮件用户名的前导和/或尾随字符。

这会在表单验证中使用正则表达式来完成吗？还是会在单独的 jquery 函数中完成？如果将特殊字符用作电子邮件用户名的第一个或最后一个字符，我会尝试触发错误。

这是我的电子邮件字段验证码：

```
email: function(value, element) {
        // contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/
        return this.optional(element) || /^((([a-z]|\d|[\-\_]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[\-\_]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(value);
    }, 
```

这是注册表单验证的代码：

```
if (form == 'registration') {
    var validation_rules = {
        rules: {
            password_confirm: {
                equalTo: "#password"
            },
            email: {

            },
            email_confirm: {
                equalTo: "#email"
            },
            dd_reg_month: "required"
        },
        groups: {
            birthday: "dd_reg_month dd_reg_year"
        },
        errorPlacement: function(error, element) {
            if (element.attr("name") == "dd_reg_month" || element.attr("name") == "dd_reg_year") $("#reg_birthday").append(error);
            else error.insertAfter(element);
        },
        validClass: "success",
        success: "success",
        focusInvalid: false,
        invalidHandler: function(form, validator) {
            var errors = validator.numberOfInvalids();
            var ipAddress =/^\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\]$/;
                if (errors) {
                    var message = errors == 1 ? 'Please correct the error below' : 'Please correct the ' + errors + ' errors below.';
                    $("div.error_info").html(message);
                    $("div.error_info").show();

                } else {
                    $("div.error_info").hide();
                    $('form input.success').css('border-color', 'green');
                }
        },
        ignore: ".ignore"

    };
} 
```

任何帮助，甚至是关于如何处理前导和尾随字符的线索，都会非常棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T22:12:35.470

感谢您的贡献！我发现了一些可以解决问题的正则表达式 - 这个网站真的很有帮助：[http ://regexlib.com/DisplayPatterns.aspx](http://regexlib.com/DisplayPatterns.aspx)

我使用的模式是这样的，由 Rob Eberhardt 发布：

```
^([0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*@([0-9a-zA-Z][-\w]*[0-9a-zA-Z]\.)+[a-zA-Z]{2,9})$ 
```

想我会分享，以防有人遇到同样的问题。如果您需要通过电子邮件验证做其他事情，请查看 regex 库，它有很多很棒的模式。我是正则表达式的新手，直到今天才听说过。:-)

再次感谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T01:28:08.003

我不知道 jquery，但如果正则表达式是 .NET 可能只是插入几个前瞻和后瞻断言可能会解决问题。

这是展开的。只需查看它们的添加位置并将它们插入到您的正则表达式中。
如果效果很好，如果没有，值得一试。

```
/
  ^
    (

(?![_-])

      (
         (
            [a-z]
          | \d
          | [\-\_]
          | [\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]
         )+
         (
           \.
           (
              [a-z]
            | \d
            | [\-\_]
            | [\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]
           )+
         )*

(?<![_-])

      )

    |

      (
        (\x22)                                           "

(?![\x01-\x20\x7f]*[_-])

        (
           (
              (
                 (\x20|\x09)*
                 (\x0d\x0a)
              )?
              (\x20|\x09)+
           )?
           (
              (
                 [\x01-\x08\x0b\x0c\x0e-\x1f\x7f]
               | \x21       
               | [\x23-\x5b]
               | [\x5d-\x7e]
               | [\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]
              )
            |
              (
                 \\
                 (
                    [\x01-\x09\x0b\x0c\x0d-\x7f]
                  | [\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]
                 )
              )
           )
        )*
        (
           (
              (\x20|\x09)*
              (\x0d\x0a)
           )?
           (\x20|\x09)+
        )?

(?<![_-][\x01-\x20\x7f]*)

        (\x22)                                           "
      )
    )

    @

    ((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:46:28.517

如果特殊要求应该触发与常规无效电子邮件相同的错误，您可以将其放入验证功能中。

它可能包含在电子邮件验证正则表达式中，但我不打算深入研究改变它。在验证电子邮件后，我下面的代码将附加一个额外的正则表达式，以测试您的特殊情况。

```
email: function(value, element) {
    // contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/
    var valid = this.optional(element) || /^((([a-z]|\d|[\-\_]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[\-\_]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(value);
    return valid && /^[a-z].*[a-z]@.+/i.test(value);
}, 
```

# javascript - 对来自多个数组的公共值进行分组

> ID：10660457
> 
> 赞同：1
> 
> 时间：2012-05-18T22:24:35.303
> 
> 标签：javascript, jquery

我在 javascript 中有多个具有相同数量元素的数组。我想找到共同的值并将它们组合成单独的数组，如下所示（使用 javascript 和 jquery）......

```
[1,2,3,4]
[1,2,3,5]
[1,2,3,6]
[1,2,4,3] 
```

我想要以下结果：

1 / 2 / 3 / 4,5,6
1 / 2 / 4 / 3

这应该导致如上所述的两组单独的组合。下面是不正确的：

1 / 2 / 3,4 / 3,4,5,6

因为不存在 [1,2,4,5] 和 [1,2,4,6] 的数组。

这是我的代码

```
<input type="checkbox" class="cb4" value="1,2,3,4" />
<input type="checkbox" class="cb4" value="1,2,3,5" />
<input type="checkbox" class="cb4" value="1,2,3,6" />
<input type="checkbox" class="cb4" value="1,2,4,3" />

for (i = 0; i < 4; i++) {
    combos[i] = [];
}
$('input.cb4:checked').each(function(){
    var nums = this.value.split(',');
    for (i = 0; i < nums.length; i++) {
        if ($.inArray(nums[i], combos[i]) == -1) {
            combos[i].push( nums[i] );
        }
    }
});

var bets = '';
for (i = 0; i < combos.length; i++) {
    combos[i].sort(function(a,b) {return a-b});
    bets += combos[i] + ' / ';
} 
```

字符串 bets 的值为：“1 / 2 / 3,4 / 3,4,5,6”。同样，这是不正确的，因为没有 1、2、4、5 或 1、2、4、6 的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T00:10:46.910

我建议您将输入数组排序为一对多的树结构，即 {1,[{2,[{3,[4,5,6]},{4,[3]}]}

无论您选择“按原样”使用此结构还是将其转换为字符串，它都包含您想要的信息。

使用基本原型，例如：

```
oneToMany = function(a, b) {
  branch = a;
  leaves = new Array();
  for each x in b {
    leaves.push(x).;
  }
} 
```

然后嵌套它，直到你有我描述的结构。

当我用一部糟糕的智能手机回答这个问题时，我为句法错误道歉。如果您对此发表评论，我会为您提供一个更好的示例。无论如何，我希望你明白我的意思。

# .htaccess - 在 htaccess 中重写 url 不太确定该怎么做

> ID：10660461
> 
> 赞同：1
> 
> 时间：2012-05-18T22:24:49.930
> 
> 标签：.htaccess, generics, url-rewriting

嘿伙计们，我正在尝试转换看起来像这样的网址

example.com/sometype/author-name/sort-date 或 example.com/sometype/author-name/sort-date/something-value/

只需要一个通用的解决方案。

我对此很陌生，并且在正则表达式方面有点弱。所以我能写的是这个来识别

某种类型/作者姓名/排序日期/

或者

某种类型/作者姓名/排序日期/某物值/

/([a-zA-Z0-9]+)/ ([a-zA-Z0-9]+)-([a-zA-Z0-9]+)

我想把它改写成这种格式

example.come?data={"par1":"sometype","author":"name","sort":"date","something":"vale"}

或者

example.come?data={"par1":"sometype","author":"name","sort":"date"}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:43:09.080

首先了解您所要求的对于 mod_rewrite 来说是非常不寻常且极其棘手的。它不仅需要基于递归的代码，而且该代码的可读性也不是很好。

使用该注意事项启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

## If the request is for a valid directory
RewriteCond %{REQUEST_FILENAME} -d [OR]
## If the request is for a valid file
RewriteCond %{REQUEST_FILENAME} -f [OR]
## If the request is for a valid link
RewriteCond %{REQUEST_FILENAME} -l
## don't do anything
RewriteRule ^ - [L]

RewriteRule ^([^/]+)/([^/]+)(.*?)/?$ $1\",\"$2$3 [L]

RewriteRule ^([^-]+)-([^,]+)(.*)$ $1\":\"$2$3 [L]

RewriteCond %{QUERY_STRING} ^$
RewriteRule ^(.*)$ /?data={\"part1\":\"$1\"} [L] 
```

# regex - 匹配字母后跟特定数字范围

> ID：10660462
> 
> 赞同：0
> 
> 时间：2012-05-18T22:25:18.637
> 
> 标签：regex

我正在编写一个正则表达式，其中字符串可以是 2-3 个字符。第一个字符必须是 A 和 H（大写字母）之间的字母。这个字符后面必须跟一个 1 到 12 之间的数字。我写了

```
[A-H]{1}[1-12]{1,2} 
```

当我键入时这很好，但当我键入`A12`时不行`A6`

请建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:29:13.527

您不能指定这样的数字范围，因为它是作为字符之间的范围实现的，因此`[1-12]`等效于`[12]`，它只匹配 a`1`或 a `2`。相反，请尝试以下操作：

```
[A-H](?:1[012]|[1-9]) 
```

这是一个解释：

```
[A-H]        # one letter from A to H
(?:          # start non-capturing group
   1[012]      # 1 followed by 0, 1, or 2 (10, 11, 12)
   |           # OR
   [1-9]       # one digit from 1 to 9
)            # end non-capturing group 
```

请注意，原始正则表达式中的`{1}`after`[A-H]`是不必要的，`[A-H]{1}`并且`[A-H]`是等效的。

您可能需要考虑向正则表达式添加锚点，否则您还会在字符串上获得部分匹配，例如`A20`. 如果您尝试匹配整个字符串，那么您应该使用以下内容：

```
\A[A-H](?:1[012]|[1-9])\z 
```

如果它在较大的文本中，您可以使用单词边界：

```
\b[A-H](?:1[012]|[1-9])\b 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:30:38.563

干得好：

```
^[A-H]([1-9]|1[0-2])$ 
```

您问题中的 {1} 不需要。

正则表达式用 ^ 和 $ 锚定，这意味着它可以是您行中唯一的东西。例如，它与 A60 不匹配

# javascript - 图像未显示在画布元素上

> ID：10660464
> 
> 赞同：0
> 
> 时间：2012-05-18T22:25:23.977
> 
> 标签：javascript, image, html, canvas, html5-canvas

所以，我一直在尝试用我的游戏引擎制作一个滚动射击游戏的例子，但我遇到了一些奇怪的事情。我尝试绘制的某个图像没有显示出来。它显示在 Chrome 的资源中，因此不是路径问题。我尝试显示的所有其他图像也显示出来。如果有人可以帮助我，将不胜感激。=)

参考链接：

[http://pandamochi.x10.bz/scrollingshooter.html](http://pandamochi.x10.bz/scrollingshooter.html)

绘图代码：

```
ctx.save();
        if (this.sprite != ""){
            ctx.translate(Math.round(this.x-ds_view.x), Math.round(this.y-ds_view.y));
            ctx.scale(this.scaleX,this.scaleY);
            ctx.rotate(this.rotateZ);
            ctx.translate(-this.width/2,-this.height/2);
            ctx.drawImage(this.sprite, this.width*this.sprite_index, 0, this.width, this.height, 0, 0, this.width, this.height);
        }
        ctx.restore(); 
```

我用来设置的代码：

```
enemy.setSprite("images/ship.png",1,4,10); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T04:16:18.370

**编辑**

所以，是的，我离题了。

```
ctx.drawImage(this.sprite, this.width*this.sprite_index, 0, this.width, this.height); 
```

翻译导致您的问题。我改变了上面的线，实际上可以看到船的图纸。这不是最完整的答案，但希望它能让你走上正轨。

**[现场演示](http://jsfiddle.net/loktar/Hq3vP/)**

# php - 如何过滤 XML

> ID：10660466
> 
> 赞同：0
> 
> 时间：2012-05-18T22:25:33.317
> 
> 标签：php, xml, dom

我正在寻找过滤此 xml[在此处输入链接描述](http://xml.weather.com/weather/local/FRXX0076?cc=%2aunit=m&hbhf=6&ut=C)过滤 xml 的最佳方法是：-运行所有 xml 并影响变量中的值-之后我们用此变量重写此 xml

还有其他方法吗？对于这种方法，我使用了这样的 dom：

```
 $flux= new DOMDocument();
if ($flux->load('http://xml.weather.com/weather/local/FRXX0076?unit=m&hbhf=6&ut=C'))  
{$loc=$flux->getElementsByTagName('t');
  foreach($loc as $lo)
    echo $lo->firstChild->nodeValue . "<br />";
} 
```

在这段代码中我试图显示`<t>`但有 2 个应答器`<t>`，`<hour>`因此我有两个值`<t>`而不是第一个孩子`<hour>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T00:29:42.897

简短的回答：

```
$flux= new DOMDocument();
if ($flux->load('http://xml.weather.com/weather/local/FRXX0076?unit=m&hbhf=6&ut=C'))  
{
    $xpath = new DomXPath($flux);

    $elements = $xpath->query("*/hour/t[1]");

    if (!is_null($elements)) {
      foreach ($elements as $element)
      {
        echo "<br/>[". $element->nodeName. "]";

        $nodes = $element->childNodes;
        foreach ($nodes as $node)
        {
          echo $node->nodeValue. "\n";
        }
      }
    }
} 
```

我想你应该知道从这一点开始:)

更高级的版本将是对所有小时元素（“*/小时”）发出 XPath 查询，然后在 foreach 中为每个小时元素在此元素上下文中发出另一个 xpath 查询（`$xpath->query("*/t[1]", $hourElement);`）。这样，您还可以访问小时对象，例如可以显示这个小时。

**更新**

更简单的 foreach 版本：

```
if (!is_null($elements)) {
    foreach ($elements as $element)
    {
        echo "<br/>".$element->nodeValue;
    }
} 
```

# php - CakePHP - 从同一模型中的另一个函数调用模型函数

> ID：10660480
> 
> 赞同：4
> 
> 时间：2012-05-18T22:26:54.237
> 
> 标签：php, cakephp, model

我有一个 CakePHP 模型，其中有一些功能运行良好。现在我正在尝试编写一个新函数，它使用我已经编写的一些函数。似乎应该很容易，但我无法弄清楚语法。我如何调用我已经在我的新函数中编写的这些函数？

例子：

```
<?php
public function getHostFromURL($url) {
    return parse_url( $http.$url, PHP_URL_HOST );
}
public function getInfoFromURL($url) {
    $host = getHostFromURL($url);
    return $host;
} 
```

结果：

> 致命错误：在第 151 行的 /var/www/cake/app/Model/Mark.php 中调用未定义函数 getHostFromURL()

我也尝试过类似的东西：

```
<?php
public function getHostFromURL($url) {
    return parse_url( $http.$url, PHP_URL_HOST );
}
public function getInfoFromURL($url) {
    $host = this->Mark->getHostFromURL($url);
    return $host;
} 
```

但是得到了同样的结果。

显然我的函数比这复杂得多（否则我只会重用它们）但这是一个很好的例子。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T22:30:12.803

如果该功能在同一个控制器中，您可以使用

`$this->functionName`句法。

您在下面有错误的语法：

```
public function getInfoFromURL($url) {
    $host = this->Mark->getHostFromURL($url);
    return $host;
} 
```

应该：

```
public function getInfoFromURL($url) {
        $host = $this->getHostFromURL($url);
        return $host;
    } 
```

如果 getFromHostUrl 方法在当前类中。 [http://php.net/manual/en/language.oop5.php](http://php.net/manual/en/language.oop5.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T22:30:44.690

您只需要调用其他函数，例如：

```
$host = $this->getHostFromURL($url); 
```

# php - 页面停止显示

> ID：10660481
> 
> 赞同：1
> 
> 时间：2012-05-18T22:26:59.697
> 
> 标签：php, html, xhtml

我正在尝试为我的网站编写一个基本的消息传递系统。我已经设置了发送和接收，但由于某种原因，在收件箱中，html 只是停止显示。它显示在页面的一半，然后由于某种原因停止。如果我输入，甚至不会显示基本的 html

你好

它不会出现。我很困惑，因为这从来没有发生过。

```
 </table> 
<p>Hello</p><!--THIS WILL DISPLAY-->
<?php
///////////End take away///////////////////////
// SQL to gather their entire PM list
include_once ('../../mysql_server/connect_to_mysql.php');
$sql = mysql_query("SELECT * FROM messaging WHERE to_id='$my_id' AND    recipientDelete='0' ORDER BY id DESC LIMIT 100");

while($row = mysql_fetch_array($sql)){ 

$date = strftime("%b %d, %Y",strtotime($row['time_sent']));
if($row['opened'] == "0"){
        $textWeight = 'msgDefault';
} else {
        $textWeight = 'msgRead';
}
$fr_id = $row['from_id'];    
// SQL - Collect username for sender inside loop
$ret = mysql_query("SELECT * FROM myMembers WHERE id='$fr_id' LIMIT 1");
while($raw = mysql_fetch_array($ret)){ $Sid = $raw['id']; $Sname = $raw['firstname']; }

?> 
<p>Hello</p><!--THIS WON'T DISPLAY-->
    <table width="96%" border="0" align="center" cellpadding="4"> 
```

任何帮助表示赞赏..

编辑：

第一个 while 循环确实关闭，就在表格之后。第一个 while 循环之外的所有内容都会显示，但是，while 循环内的所有内容都不会显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:32:43.483

不知道这是否只是一个剪切和粘贴错误，但您的第一个 while 循环看起来并没有关闭。尝试关闭它，看看它从那里去哪里。

```
while($row = mysql_fetch_array($sql)){ //needs closing 
```

编辑：您是否尝试过查看您的 sql 是否抛出任何错误：

```
// Check result
// This shows the actual query sent to MySQL, and the error. Useful for debugging.
if (!$sql) {
    $message  = 'Invalid query: ' . mysql_error() . "\n";
    $message .= 'Whole query: ' . $query;
    die($message);
} 
```

这个 PHP[链接](http://php.net/manual/en/function.mysql-query.php)可能很有用。

# c++ - 需要帮助从字符串中获取字符？

> ID：10660482
> 
> 赞同：1
> 
> 时间：2012-05-18T22:27:28.253
> 
> 标签：c++, string

我目前正在上 Intro C++ 课程，并且正在学习字符串和它们的成员函数。我有这样的问题：

假设 name 是一个被赋值的 string 类型变量。编写一个表达式，其值为包含 name 值的第一个字符的字符串。因此，如果 name 的值为“Smith”，则表达式的值为“S”。

或者

假设 name 是一个被赋值的 string 类型变量。编写一个表达式，其值为包含 name 值的最后一个字符的字符串。因此，如果 name 的值为“Smith”，则表达式的值为“h”。

或者

假设 word 是一个被赋值的字符串类型变量。编写一个表达式，其值为由 word 值的最后三个字符组成的字符串。因此，如果 word 的值是“最大”，则表达式的值将是“est”。

我知道诸如 name[0] 和 name[name.length() - 1] 之类的东西，但我不知道如何在一个表达式中将它们转换为字符串。我一直在寻找可以帮助我做到这一点的成员函数表或列表，但我被困住了。任何指示或帮助都会很棒。:D

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T22:32:29.780

看一下 substr 方法。

[http://www.cplusplus.com/reference/string/string/substr/](http://www.cplusplus.com/reference/string/string/substr/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T22:55:15.627

我会使用子字符串：

```
//assume that the string in question is held in a variable with the name str
string s1 = str.substr(0,1);
string s2 = str.substr(str.length() - 2, 1);
string s3 = str.substr(str.length() = 4, 3); 
```

希望这会有所帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:31:55.740

有很多方法可以做到这一点。例如， an`std::string`也是`char`. 因此，您可以从一个空字符串开始，并`char`在其上附加一个。

# java - Android 应用程序中令人费解的 java.lang.NullPointerException

> ID：10660486
> 
> 赞同：0
> 
> 时间：2012-05-18T22:28:13.753
> 
> 标签：java, android, mobile

我目前正在开发一个 Android 应用程序，几乎每次使用它时，都会出现错误。大多数时候它不会使应用程序崩溃，但我看到这个错误仍然令人沮丧。我以为我做了检查，但我可能是错的。谢谢您的帮助！相关代码如下。（这是相关的，因为`if`语句外的行正在抛出`NullPointerException`.）

```
 Activity activity;     

 if(activity == null)
 {
   activity = new Activity();
 }

 Intent intent = new Intent(activity, Service.class); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:34:26.073

您通常不会以这种方式实例化 Activity 类。请在此处查看有关 Android Activity 类的文档：

[http://developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T22:34:47.563

您应该发布更多周围的代码，但您的问题是创建新`Intent`的需要有效的`Context`. `Intent`通常，您在`Activity`（或`Service`或）类中创建一个，`BroadcastReceiver`因此您可以执行以下操作：

```
Intent intent = new Intent(this, Service.class); 
```

有时您会在其他地方创建它并将其传递给 valid `Context`，但您几乎不应该`Activity`通过直接调用构造函数来创建 an 。要使其有用，还需要进行许多其他初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T23:16:11.950

正如 postet 之前的那样，对于一个活动来说，除了调用构造函数之外，还有更多的事情要启动。可能您在 Intent 构造函数的深处得到一个空指针异常，它试图获取一些通常提供的活动信息。

如果你真的想创建一个服务，这里有一个启动服务的链接，但你应该真正阅读整篇文章，可能还有更多的活动生命周期资源。

[http://developer.android.com/guide/topics/fundamentals/services.html#StartingAService](http://developer.android.com/guide/topics/fundamentals/services.html#StartingAService)

# javascript - 一页上有多个颜色选择器，带有指向输入框的链接

> ID：10660495
> 
> 赞同：1
> 
> 时间：2012-05-18T22:29:13.410
> 
> 标签：javascript, jquery, html, color-picker

我正在使用[jQuery ColorPicker 插件](http://www.eyecon.ro/colorpicker/#about)，我想在一个页面上多次使用它，并且每个颜色选择器框都必须连接到一个输入字段。

我有以下 HTML 代码

```
<div class="r" style="position: relative; height: 50px;">
  <div class="color-picker2">
    <div></div>
    <input type="text" name="idesign-menu-level-0[color]" id="colorpickerField" class="color-picker-input" value="" />
  </div>
  </div>

  <div style="clear:both"></div>

    <div class="r" style="position: relative;">
  <div class="color-picker2">
    <div></div>
    <input type="text" name="idesign-menu-level-0[color]" id="color" class="color-picker-input" value="" />
  </div>
  </div> 
```

我有以下 jQuery 代码

```
(function($) {
    $('.color-picker2').each(function(o) {
        var _this = this;
        $(this).ColorPicker({
                livePreview: true,
                color: '#0000ff',
                onShow: function (colpkr) {
                    $(colpkr).fadeIn(500);
                    return false;
                },
                onHide: function (colpkr) {
                    $(colpkr).fadeOut(500);
                    return false;
                },
                onChange: function (hsb, hex, rgb) {

                }
            });
    });
}) (jQuery) 
```

我有 onChange 操作的代码，但我不知道如何将此更改链接到相关的输入字段。如果可能的话，如果十六进制代码也输入到输入字段中，我希望 ColorPicker 的颜色也会发生变化。

我确信有一种方法可以将这两者联系起来，但我只是不知道如何！

提前致谢

卡尔

没关系，现在只是用下面的 jQuery 代码弄清楚了

```
(function($) {
    $('.color-picker2').each(function(o) {
        var colorPicker = $(this);
        var colorPickerInput = $(this).children('input');
        $(this).ColorPicker({
                livePreview: true,
                color: '#0000ff',
                onShow: function (colpkr) {
                    $(colpkr).fadeIn(500);
                    return false;
                },
                onHide: function (colpkr) {
                    $(colpkr).fadeOut(500);
                    return false;
                },
                onChange: function (hsb, hex, rgb) {
                    $(colorPickerInput).val('#' + hex);
                }
            });
    });
}) (jQuery) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-19T20:43:02.407

答案是

```
(function($) {
    $('.color-picker2').each(function(o) {
        var colorPicker = $(this);
        var colorPickerInput = $(this).children('input');
        $(this).ColorPicker({
                livePreview: true,
                color: '#0000ff',
                onShow: function (colpkr) {
                    $(colpkr).fadeIn(500);
                    return false;
                },
                onHide: function (colpkr) {
                    $(colpkr).fadeOut(500);
                    return false;
                },
                onChange: function (hsb, hex, rgb) {
                    $(colorPickerInput).val('#' + hex);
                }
            });
    });
}) (jQuery) 
```

# cassandra - 如何使用 pycassa 打印 superCF

> ID：10660499
> 
> 赞同：0
> 
> 时间：2012-05-18T22:29:43.867
> 
> 标签：cassandra, pycassa

以下代码失败（ValueError: too many values to unpack , under pycassaShell）
有什么方法可以漂亮地打印超列吗？

```
cf = pycassa.ColumnFamily(pool, 'Super1')
res = cf.get_range()
for key, col in res:
    print '\n\n', key, ':'
    for k, c in col:
        print k, '=>', c 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T07:43:30.367

像这样

```
cf = pycassa.ColumnFamily(pool, 'Super1')
res = cf.get_range()
for key, col in res:
    print '\n\n', key, ':'
    for i in col.keys():
        print i, '=>', col[i] 
```

# jquery - 在特定时间后隐藏图像

> ID：10660500
> 
> 赞同：1
> 
> 时间：2012-05-18T22:30:07.620
> 
> 标签：jquery, jquery-ui

我有一个图像，我需要在显示特定时间间隔后隐藏图像。我为此编写了以下代码。

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Untitled Document</title>
<script src="./1_files/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
$('div').delay(2000).show(0);
$('hide').delay(3000).hide(0);​
});
</script>
</head>

<body>
<img id="hide" src="9.png" width="29" height="39">
</body>
</html> 
```

图像没有隐藏。它不断显示。任何想法为什么？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T22:38:00.160

在 jQuery 1.7 中，通过这个小的更正/更改对我来说效果很好：

```
$("#hide").delay(3000).hide(1);​ 
```

我所做的两个更改是：

1.  通过添加 # 来修复您的选择器
2.  添加一个次要时间值`.hide(1)`，将其转换为与`.delay()`.

你可以在这里看到它的工作：http: [//jsfiddle.net/jfriend00/NGW8p/](http://jsfiddle.net/jfriend00/NGW8p/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T22:36:50.550

这应该是问题

[http://api.jquery.com/delay/](http://api.jquery.com/delay/)

“在 1.4 版本中添加到 jQuery，.delay() 方法允许我们延迟队列中跟随它的函数的执行。它可以与标准效果队列或自定义队列一起使用。只有队列中的后续事件被延迟；例如，这不会延迟不使用效果队列的 .show() 或 .hide() 的无参数形式。”

# c# - 具有延迟加载的实体框架和构造函数注入

> ID：10660502
> 
> 赞同：2
> 
> 时间：2012-05-18T22:30:13.167
> 
> 标签：c#, entity-framework, dependency-injection, inversion-of-control

有没有办法使用实体框架和延迟加载来实现依赖注入？

当您连接到 时，我知道方法`ObjectStateManagerChanged`，但我想改用构造函数注入，并使我的模型实体不知道任何 IOC 容器。（假设我已经分离了 BLL 和 DAL，并希望让我的 BLL 尽可能减少外部依赖）。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T14:50:40.350

完全避免在您的实体中使用依赖注入。例如，看看[这个 SO question](https://stackoverflow.com/questions/4835046/why-not-use-an-ioc-container-to-resolve-dependencies-for-entities-business-objec)。

尝试使用[命令/处理程序模式](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=91)来编写业务操作。通过定义一个通用接口，您可以通过实现一个简单的装饰器来获得很好的可扩展性和实现安全检查的能力。

为了防止 UI 开发人员访问他们不应该访问的数据，编写一个（或多个）装饰器来包装命令处理程序（和[查询处理程序](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=92)）并防止从业务层返回具有延迟加载能力的实体。而是返回[DTO](https://en.wikipedia.org/wiki/Data_transfer_object)。这样业务层就可以完全控制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T08:39:09.623

您不能将构造函数注入与 EF 一起使用。从数据库记录中具体化实体时，EF 始终使用默认构造函数。在这种情况下，您唯一的选择是使用实体中的`ObjectMaterialized`事件`ObjectContext`和使用属性来传递初始化数据。

您应该按照@Steven 的评论来实现您需要的逻辑。

# php - 按日期对回复和新线程进行排序

> ID：10660506
> 
> 赞同：1
> 
> 时间：2012-05-18T22:30:21.430
> 
> 标签：php, mysql, sql, sorting

我希望我的董事会按照新线程显示在顶部的顺序对线程进行排序，直到创建另一个新线程或在另一个线程中做出回复。如果发生这种情况，线程将从 1 下降到 2，依此类推。

但是我现在使用的代码只是这样做：如果创建了一个新线程，它将显示在底部，但如果您做出回复，它将转到顶部。因此，需要修复的只是让它显示在顶部创建的最新线程。

```
 SELECT b.id, b.name, b.subject, b.maintext, b.ip, b.date, b.img, b.replycount, MAX(r.date)
FROM 
    board b
    LEFT JOIN reply r ON r.id = b.id

GROUP BY b.id, b.date
ORDER BY GREATEST(b.date, MAX(r.date)) DESC
LIMIT 50; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:43:24.663

`greatest`如果任何参数为 null => 我建议使用合并，如果您关心新线程和新回复，但不关心原始线程的更新，则将[返回 null ：](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_greatest)

```
order by coalesce(MAX(r.date), b.date) 
```

* * *

如果您也关心更新（所以 b.date 可以大于 max(r.date)）：

```
order by greatest(b.date, coalesce(MAX(r.date), b.date)) 
```

# java - Java中的最终二维数组

> ID：10660507
> 
> 赞同：-2
> 
> 时间：2012-05-18T22:30:28.563
> 
> 标签：java, multidimensional-array, final

如果我在 Java 方法中初始化一个数组，例如：

```
final double[][] myArray = new double[r][c]; 
```

我可以在以后的方法中这样做吗？

```
myArray[0] = new double[c]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:36:23.843

是的你可以。有关数组的更多信息[http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T22:51:45.497

我将为您提供一个示例：

```
public class Main {
    public static void main(String[] args) {
        final int[] finalArray = new int[5];
        finalArray[0] = 10;
        System.out.println(finalArray[0]);
        finalArray[0] = 9001;
        System.out.println(finalArray[0]);
        finalArray = new int[5] //compile error!!!
    }
} 
```

这是因为`final`修饰符会说对数组的引用（指针）不能改变，但数组的元素（可能有另一个指针）可以毫无问题地改变。

编辑：

二维数组的另一个例子：

```
public class Main {
    public static void main(String[] args) {
        final int[][] array2d = new int[5][];
        for(int i = 0; i < array2d.length;i++) {
            array2d[i] = new int[6];
        }
        //the size of the rows can change with no problem.
        array2d[0] = new int[8];
    }
} 
```

# java - 将字母转换为数字 2

> ID：10660510
> 
> 赞同：0
> 
> 时间：2012-05-18T22:30:39.590
> 
> 标签：java

请参阅[将字母转换为数字](https://stackoverflow.com/questions/10644420/converting-letters-to-numbers)

在文件`test.in.rtf`中，我输入了“abcd”。但是，当我运行程序时，我`??? ??????????? ???????? plus maybe a few more`进入`test.out.rtf`. 为什么是这样？我错过了什么吗？

```
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.StringTokenizer;

public class Test {

    public static void main(String[] args) throws IOException  {

        BufferedReader f = new BufferedReader(new FileReader("test.in.rtf"));

        PrintWriter out = new PrintWriter(new BufferedWriter(new FileWriter("test.out.rtf")));

        StringTokenizer st = new StringTokenizer(f.readLine());

        StringBuilder sb = new StringBuilder();

        for (char c : st.nextToken().toCharArray()) {
            sb.append((char)(c - 'a' + 1));
        }

        out.println(sb);                           // output result
        out.close();                                  // close the output file
        System.exit(0);
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:36:21.080

我很确定你想要

```
sb.append(Integer.toString(c - 'a' + 1)); 
```

或者干脆

```
sb.append( c - 'a' + 1 ); 
```

它隐含地做同样的事情，因为表达式`c - 'a' + 1`被隐式转换为 an，`int`因为 Java通过首先将所有内容转换为s 来执行所有非`long`整数数学运算（涉及`char`s、`byte`s、`short`s 和/或s 的任何事情） 。`int``int`

您将整数结果转换为 a 的内容`char`，这将由其 ASCII 值为该数字（黑白 1 和 26）的字符表示，这是不可读的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:42:33.080

您正在尝试编写 char 值 1、2、3 和 4（'a'-'a' + 1 = 1 等等），它们都是“不可写的”，因此是“？”。为什么你得到 7 而不是 4？我不知道 - 可能是语言环境问题，或者其中 3 个只是写成两个“？”。

# neo4j - 参数化 Cypher 查询在 Neography 中不起作用

> ID：10660516
> 
> 赞同：2
> 
> 时间：2012-05-18T22:31:14.457
> 
> 标签：neo4j, neography

尝试使用 Neography v0.0.23 执行参数化 Cypher 查询。

即使非参数化版本有效：

```
Neo.execute_query("开始 n=node(3) 返回 n")
 => {“数据”=>[[{....

```

参数化版本不起作用：

```
Neo.execute_query("开始 n=node(id) 返回 n", {:id => 3})
 => 无

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T07:13:55.007

尝试使用“start n=node({id}) return n”和大括号中的参数名称。

# ruby-on-rails-3 - 在两个视图之间随机化 Rails 根路径？

> ID：10660518
> 
> 赞同：0
> 
> 时间：2012-05-18T22:31:32.987
> 
> 标签：ruby-on-rails-3, rails-routing

有没有办法可以在根路径的视图之间随机切换？

```
root :to => 'pages#blue' or root :to => 'pages#red' 
```

感谢您对此提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:55:09.000

您可以将 lambda 作为 的值传递`:to`，因此理论上您可以随机返回两个不同的响应。交换渲染的布局/视图可能是一个更好的主意。

**编辑**

```
root to: lambda {|env| [ 302, {'Location'=> your_randomizing_code_here }, [] ]} 
```

你可以这样做，或者在你的控制器中做一些非常类似的事情：

```
class YourRootController < ActionController::Base
  def index
    render some_method_that_returns_your_view_paths_randomly
  end
end 
```

# html - HTML5画布drawImage使用点？

> ID：10660521
> 
> 赞同：2
> 
> 时间：2012-05-18T22:31:48.857
> 
> 标签：html, canvas, html5-canvas

我需要使用 4 个点绘制图像。我将这 4 个点存储在一个数组中，这些位置会发生变化。现在我需要绘制一个反映这些位置的图像。context.drawImage 只接受 1 个位置。

应该是这样的，4个位置：

```
x,y----------x,y
 |            |
 |            |
 |            |
 |            |
 |            |
x,y----------x,y 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-06-15T20:21:56.403

# Quad Warping 是您所需要的，没有复杂的 3D

您要求将矩形图像渲染为可能的非矩形四边形。

正确的做法是计算变换矩阵，无需渲染真实的 3D 内容。这是通过计算单应矩阵来完成的。为此，您需要了解变换矩阵并实现一些代码来解决一些方程。

这个过程很好理解，需要原始的四个坐标和目标的四个点你有，所以你只需要一个计算变换矩阵的过程。这个矩阵基本上是通过 Gauss-Jordan 消元法计算出来的。

[检查](http://forum.openframeworks.cc/t/quad-warping-homography-without-opencv/3121/15)矩阵求解器和一般程序。一旦你理解了转换，它就变得微不足道了。还要[检查这个以了解什么是单应性](https://math.stackexchange.com/questions/494238/how-to-compute-homography-matrix-h-from-corresponding-points-2d-2d-planar-homog)。这里[解释了它是如何计算的](https://math.stackexchange.com/questions/296794/finding-the-transform-matrix-from-4-projected-points-with-javascript)，带有 javascript 和 CSS 的示例。

## 演示

[这是一个很棒的演示](http://franklinta.com/2014/09/08/computing-css-matrix3d-transforms/)，带有源代码和解释。 ![Javascript 中的四边形扭曲](../Images/0e3d6627c498d10ef26d89d0f3c263ea.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-19T07:14:06.083

您正在寻找的是用 3D 渲染语言绘制四边形。

您通常将您的形状拆分为 2 个三角形（面）并使用纹理填充单独绘制它们。

这是该问题的（复杂）解决方案：[https](https://github.com/mrdoob/three.js/blob/master/src/renderers/CanvasRenderer.js#L838) ://github.com/mrdoob/three.js/blob/master/src/renderers/CanvasRenderer.js#L838 Three.js 3D引擎使用2D`<canvas>`作为渲染引擎。

由于事情不是那么简单，我建议您使用 Three.js 或类似的包装器，它提供了对纹理面部操作的高级抽象。查看其他 Three.js 2D`<canvas>`示例，您就会了解它的工作原理：

[http://mrdoob.github.com/three.js/](http://mrdoob.github.com/three.js/)

# c++ - 使用 GCC 4.7.0 构建 Boost 1.49.0 时出错

> ID：10660524
> 
> 赞同：14
> 
> 时间：2012-05-18T22:32:09.280
> 
> 标签：c++, boost, mingw

我正在尝试使用 GCC 4.7.0 (MinGW) 构建 Boost 1.49.0。我不断收到以下错误消息数十次：

> c:\tools\mingw\bin../lib/gcc/i686-pc-mingw32/4.7.0/../../../../include/c++/4.7.0/cmath:1096:11 : 错误: '::hypot' 尚未声明

第 1096 行`cmath`包含

```
using ::hypot; 
```

`cmath`包括`math.h`将`hypot`函数声明为

```
extern double __cdecl hypot (double, double); /* in libmoldname.a */ 
```

在这两个文件中，上面引用的几行之后的几行是`hypotl`函数的相同语句（除了类型是`long double`而不是`double`），并且看起来很高兴。

任何想法为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2015-06-17T02:08:52.967

@Praetorian 的回答正确地识别了问题。另一方面，Python 标头在技术上意味着排在任何其他标头之前。此外，有时接受的解决方案在构建系统中不起作用或不方便，因此我想出了一个替代解决方案。将以下标志添加到对 g++ 的调用中：

```
-D_hypot=hypot 
```

这使得 Python 头文件中的有害宏成为空操作，并且编译错误消失了。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-25T18:44:52.707

Found the answer in [this forum post](http://boost.2283326.n4.nabble.com/Boost-Python-Compile-Error-s-GCC-via-MinGW-w64-tp3165793p3166757.html). It seems that *pyconfig.h* has the following lines:

```
#if defined(__GNUC__) && defined(_WIN32)
// ...
#define hypot _hypot
// ...
#endif /* GNUC */ 
```

but *cmath* included with MinGW expects the function to be named `hypot` and not `_hypot`, which causes the compilation errors.

The fix was to include the following to my bjam command line's *cxxflags* option

```
bjam ... cxxflags="-include cmath " 
```

This indicates that g++ should include the *cmath* header at the beginning of every source file.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-22T21:34:47.120

据我所知，在使用 MingW 编译、使用 -std=c++0xx 并在 cmath 之前包含 Python.h 时会发生这种情况。并注意 cmath 包含在相当多的其他头文件中......请注意，问题不是特定于 Boost 的。复杂的事实是，在我的标准 MingW - Visual Studio 交叉编译设置中，Visual Studio 2010 需要在调试模式下在许多其他标准包含文件之前包含 Python.h。解决方案是首先包含 cmath，然后是 Python.h，因此您会得到如下代码：

```
#include <cmath>
#include <Python.h>
#include < other standard headers > 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-04-20T07:12:08.267

@Praetorian 正确识别了该问题。

在我的情况下，它只出现在一个文件中。所以我只是添加

`#define _hypot hypot`前`#include <Python.h>`

和作品。

希望这能有所启发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-19T05:59:02.217

尝试查看预处理单元。我猜你会发现类似“#undef hypot”的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-15T19:41:38.213

当我在链接器中添加以下路径时，我可以在代码块中解决此错误

```
C:\Python36-32\libs 
```

并将两个库放在链接库上：**libpython36.a**和**python36.lib**。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-03-27T18:48:29.483

添加这一行

```
#define _hypot hypot 
```

在您的`Python.h`文件的第一个，它存储在您的 python 安装目录中。某处像`C:\Python27\include`。

# wcf - 将 WCF 引用添加到工作流项目

> ID：10660526
> 
> 赞同：1
> 
> 时间：2012-05-18T22:32:18.080
> 
> 标签：wcf, workflow-foundation-4

我正在构建一个使用 WCF 服务的工作流.. 但在工作流项目中我没有添加对 WCF 服务的直接引用，而是添加了对具有此服务引用的项目的引用，但现在设计师没有打开，它给了我以下异常错误：

System.Xaml.XamlObjectWriterException：'调用与指定绑定约束匹配的'OrderingSystemWorkFlow.RegisterOrderBill'类型的构造函数引发异常。行号“25”和行位置“34”。---> System.InvalidOperationException：在 ServiceModel 客户端配置部分中找不到引用合同“ServiceReference1.IService1”的默认端点元素。这可能是因为没有为您的应用程序找到配置文件，或者因为在客户端元素中找不到与此合同匹配的端点元素。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T22:36:18.860

为什么不将直接服务引用添加到您的 WF 项目？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:17:38.600

当您在活动库中添加 wcf 服务的服务引用时，它会变成活动并可以拖放到工作流上。当您添加服务引用时，还会添加一个配置文件，复制配置文件的内容，基本上具有客户端和绑定配置部分。

请参考此链接。 [http://blogs.msdn.com/b/endpoint/archive/2010/12/08/how-to-consume-a-wcf-service-from-a-wf4-workflow.aspx](http://blogs.msdn.com/b/endpoint/archive/2010/12/08/how-to-consume-a-wcf-service-from-a-wf4-workflow.aspx)。

# html - Mailto 链接在 Hotmail 中不起作用

> ID：10660529
> 
> 赞同：6
> 
> 时间：2012-05-18T22:32:35.560
> 
> 标签：html, email, mailto, hotmail

因此，我有一个 html 电子邮件，我正在为我的公司创建一个电子邮件活动，我们将很快为我们代表的组织发送电子邮件。它包含 2 个主要链接，一个用于向我们代表的组织中的人员发送电子邮件，另一个用于访问该组织站点上的登录页面。登陆页面链接工作正常，从 Hotmail 查看电子邮件时，mailto: 链接不工作。它适用于 Hotmail 以外的其他客户端，包括 Gmail 和 Outlook。

这不是因为我正在测试的计算机没有安装电子邮件客户端。它已安装 Outlook 2010 并注册为 mailto 应用程序。当在其他站点（不是 hotmail）上单击 mailto 链接时，它们工作得很好……outlook 会启动一个新的消息窗口，并填写主题和电子邮件。当我们在 Hotmail 上进行测试时，它在状态栏中显示了 mailto 链接，但是当您单击该链接时没有任何动作。就好像链接根本不是链接。

这是我们尝试使用的链接：（出于隐私考虑，稍作编辑）

```
<div class="button"><a href="mailto:contact@email.org?subject=Resident Requesting More Info">Email a Resident Advisor</a></div> 
```

这被放置在一个 html 表格单元格中。它应用了一些基本的 CSS 样式（全部嵌入在 html 电子邮件本身中）。按钮类只是为了使链接在电子邮件中脱颖而出......给它一个红色边框并加粗链接。

更清楚地说：

作品：

Gmail - IE9、Chrome、Firefox

展望 - 工作。

不工作：

Hotmail - 尝试所有浏览器

该电子邮件是使用 CampaignMonitor 的预览功能发送的（由我们的 QA 人员处理，我无法访问它，因为我对公司相当陌生）。

我只需要找到一种方法来完成这项工作。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T22:43:14.897

本周早些时候，我和另外两个程序员花了 2 天时间处理这个问题。我手头没有相关链接，但总而言之，这是一个已知问题，目前尚未解决。

mailto：链接在任何情况下都不会在Hotmail中工作，它们被删除或其他东西。

我们最终添加了副本，指示收件人发送电子邮件至 foo@mail.com，而不是单击链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T17:30:26.800

[这是我在http://windowsxp.mvps.org/hmposturl.htm](http://windowsxp.mvps.org/hmposturl.htm)找到的一个可能的解决方案，我为我的目的进行了修改。它只需要向您的 Hotmail 收件人发送带有自定义链接的独特创意，但它似乎对我有用。这是我使用的 href 字符串：

[http://www.hotmail.msn.com/secure/start?action=compose&to=email@domain.com&subject=](http://www.hotmail.msn.com/secure/start?action=compose&to=email@domain.com&subject=My)我的主题行&body=电子邮件正文

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-30T15:49:38.863

这是大多数基于 webmail 的系统的常见问题。mailto：不调用它们。Google mailto hotmail，您会找到适用于 Windows 和特定浏览器的答案。我认为这将为您设置

[http://email.about.com/od/windowslivehotmailtips/qt/How_to_Make_Windows_Live_Hotmail_Your_Default_Email_Program.htm](http://email.about.com/od/windowslivehotmailtips/qt/How_to_Make_Windows_Live_Hotmail_Your_Default_Email_Program.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-10T08:00:29.930

只需添加 target='_blank'...使用 'a' html 标签作为...

```
<a href='mailto:Your MAILTO ID' target='_blank'>SOME Support</a> 
```

这适用于 hotmail 客户端，但它会另外启动新的浏览器实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T08:30:27.553

已知问题，我可以确认，不是仅在 Hotmail 网络邮件上工作，其余的工作正常，我们在这里遇到了同样的问题，我们放弃了尝试。

如果您真的想要唯一的方法是使用 JavaScript，onClick 会更改窗口位置，但这会引入一个新的依赖项：JavaScript。

# java - 2d手游开发：OpenGL ES 2.0还是cocos2d-x？

> ID：10660532
> 
> 赞同：3
> 
> 时间：2012-05-18T22:32:52.143
> 
> 标签：java, android, c++, ios, opengl-es

我打算为手机制作一款游戏。我的目标平台是 iOS 和 Android。我希望能够在 windows 和/或 linux 上进行测试。除了一般的游戏开发经验之外，我对此有点过头了，所有技术对我来说都是相当新的。我做了相当多的研究并得出结论，游戏应该用/移植到 C++ 中，以确保我的大部分引擎都可以轻松移植到多个设备上。

我更喜欢的另一件事是最初用 java 编写游戏并移植到 C++，因为那是我最舒服的地方，并且会以最快的速度完成它。

现在我面临选择是使用 cocos2d-x 等游戏引擎，还是从头编写引擎并使用 OpenGL ES 2.0 进行渲染的问题。最初我认为使用 cocos2d-x 会更好，因为我对 OpenGL 没有很多经验。然而，我使用 cocos2d-x 的问题是，因为我想最初用 java 编写游戏，所以我将很难移植引擎以符合 cocos2d-x（或者我必须学习关于 cocos2d-x 引擎的所有内容，然后编写我的引擎来模仿 cocos2d-x 引擎.. 似乎是多余的）。

经过进一步考虑，我认为使用 OpenGL 编写自己的引擎实际上是更好的选择。我可以使用 PowerVR SDK 和 JOGL 来模拟 GLES 环境。这看起来也不错，因为我可以让 GL 在碰撞检测和转换方面为我完成大部分工作。我唯一的问题是，由于游戏也将支持多人游戏，因此 GL 碰撞检测等基本上没有实际意义，因为无论如何我都必须在服务器端进行碰撞检查以防止游戏被轻易入侵. 当然对于单人游戏来说这种方法是可行的。

显然这个决定是主观的，取决于我个人的喜好，尽管我希望给一些更有经验的人提供足够的背景来发表他们的意见。

话虽如此，我的问题是：考虑到这些参数 - 对我来说，使用 cocos2d-x 并遭受从头开始用 C++ 构建游戏的头部创伤会更好，还是最初编写自己的引擎会更好在java中并通过它的OpenGL方面挣扎？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T15:07:06.377

我决定使用 cocos2d-x 在 c++ 中从头开始编写它。它并没有我预期的那么糟糕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T22:50:59.700

从头开始构建自己的引擎将是一项太多的工作，并且会吸引大量的错误进入。在我看来，久经考验的引擎是更好的选择。移植会容易得多，因为您将拥有一个工作游戏。
我目前正在使用[Marmalade](http://www.madewithmarmalade.com)引擎，我对它的性能非常满意。它使您可以直接访问 OpenGL 库，尽管我从未尝试过。你也应该试一试，虽然它不是免费的，但 90 天的评估许可证是免费的，可以免费查看。

# ruby - Rspec 集合误区

> ID：10660533
> 
> 赞同：0
> 
> 时间：2012-05-18T22:32:55.987
> 
> 标签：ruby, rspec

为什么这个测试在必须通过时返回“TypeError：nil 不是符号”？它来自一本书。

```
describe "The string" do 
 it "should have 11 simbols" do
  "this string".should have(11)
 end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:41:43.520

这是书中的一个错误。该行应该是：

```
"this string".should have(11).symbols 
```

# asp.net - 尝试从 asp.net web api 返回数据

> ID：10660535
> 
> 赞同：0
> 
> 时间：2012-05-18T22:32:58.743
> 
> 标签：asp.net, asp.net-web-api

我正在尝试将 web api 添加到现有的 asp.net ASPX 站点。

我想要的只是它返回（以 JSON 或 XML 格式）我的查询结果 - 但是我收到错误：无法将“System.Data.DataTable”类型的对象转换为“System.Collections.Generic.IEnumerable”类型1 [系统.Web.UI.WebControls.Table]'。

...在代码的最后部分。

我在 API 控制器中的代码是：

```
Imports System.Web.Http
Imports System.Web
Imports System.Data
Imports System.Data.SqlClient

Public Class ValuesController
Inherits ApiController

' GET /api/<controller>
Public Function GetValues() As IEnumerable(Of Table)

    Dim con As New SqlConnection("Data Source=.\SQLEXPRESS;Initial Catalog=inv;Integrated Security=True")
    Dim cmd As SqlCommand = New SqlCommand("select * from customers", con)
    cmd.CommandType = CommandType.Text
    Dim adapter As SqlDataAdapter = New SqlDataAdapter(cmd)
    Dim dt As New DataTable
    Using con
        Try
            con.Open()
            adapter.Fill(dt)
            'Check if any rows were returned
            If dt.Rows.Count = 0 Then
                'If no rows, return nothing
                Return Nothing
            Else
                'Return the filled datatable
                Return dt
            End If
        Catch ex As Exception
            con.Close()
            Throw ex
        Finally
            con.Close()
        End Try
    End Using

    Return New String() {"value1", "value2"}
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T21:51:13.493

我认为答案只是将函数的签名更改为 As EnumerableRowCollection。当您获取 DataTable 对象并使用 AsEnumerable() 方法时，它会以 EnumerableRowCollection 的形式返回数据行集合，尽管将其编写为 EnumerableRowCollection 就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T17:46:27.260

查看异常消息，它说它无法将 DataRow 集合转换为 System.Web.UI.WebControls.Table 的 IEnumerable。

问题是你的函数的签名。

```
Public Function GetValues() As IEnumerable(Of Table) 
```

它应该是这样的

```
Public Function GetValues() As IEnumerable(Of DataTable) 
```

# php - 如何解决特定子域上的冲突会话 cookie？

> ID：10660539
> 
> 赞同：0
> 
> 时间：2012-05-18T22:33:56.090
> 
> 标签：php, session, cookies, yii

首先，我们使用 Yii 框架来创建我们的站点，它正在处理 cookie 的创建。

我们有一个包含许多子域的站点，因此主站点的会话 cookieParams 为“.sitename.com”。

像这样的东西：

*   www.sitename.com
*   a.sitename.com
*   b.sitename.com
*   admin.sitename.com

我们有`www`、`a`和`b`共享同一个会话 cookie，这很好用。

但是，我们有一个特殊的管理子域，它具有不同的用户系统和登录机制，因此我们有一个单独的会话 cookieParam “admin.sitename.com”。

问题是，如果有人从主站点获取会话 cookie，登录管理站点将失败，因为主站点的“.sitename.com”cookie 似乎具有优先权。删除主站点的 cookie 可以暂时解决问题，直到浏览器再次访问主站点。

有什么办法可以解决这个问题，还是有更好的方法来设置 cookie 域？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T03:10:58.010

最简单的解决方案是使用不同的会话名称。在普通的 php 中，你在 session_start() 之前调用 session_name()。我对 Yii 框架不是很熟悉，但是 CHttpSession 类似乎是 php 函数的一个薄包装器，它有一个 setSessionName() 方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T02:59:03.037

在 ispecting 如何`yii`使用他们的工具完成此操作后，`gii`我在我的工具中设置了以下内容`config.php`并使其正常工作。

```
<?php 

$config = array(
    ...
    'components'=>array(
        ...
        'user'=>array(
            // enable cookie-based authentication
            'allowAutoLogin'=>true,
            'class' => 'WebUser',
            // Create a custom key prefix for the user cookie
            'stateKeyPrefix'=>'customkey',
        ),
        ...
        'session' => array (
            // Provide a custom name for the session id to differentiate it 
            // from the default PHPSESSID
            // Cannot use dots in the session id :(
            'sessionName' => 'custom_session_id',
            // Keep session stored in db for use accross load balancer
            'class' => 'system.web.CDbHttpSession',
            'connectionID' => 'db',
        ),
        ...
    ),
); 
```

# django - django - 在中间件而不是视图中测试 is_authenticated()

> ID：10660544
> 
> 赞同：2
> 
> 时间：2012-05-18T22:34:40.560
> 
> 标签：django

我的大多数视图都需要登录。有没有办法指定所有视图或视图子集必须让用户 is_authenticated() = True 才能继续。如果没有，用户会被重定向到登录页面吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:38:36.140

[https://docs.djangoproject.com/en/1.4/topics/auth/#the-login-required-decorator](https://docs.djangoproject.com/en/1.4/topics/auth/#the-login-required-decorator)

```
from django.contrib.auth.decorators import login_required

@login_required
def my_view(request):
    ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T23:10:52.223

如果你愿意，你必须遵守一些规则，

*   `request.user`设置为 on `AuthenticationMiddleware`，因此在此之前放置您的自定义中间件将失败。
*   您只能使用`process_view`在调用视图之前执行的方法

但是，不知何故；您必须制作一种类似于**login free views**的列表，但这不太可能，因为每次创建新视图时检查列表可能会有问题。另一方面，`login_required`装饰器就是这样工作的，它更容易使用......所以在做这样的事情之前你必须三思而后行，并考虑你是否 **真的**需要这样的东西。

这是[自定义中间件的文档](https://docs.djangoproject.com/en/1.4/topics/http/middleware/)，这里是[django 默认中间件类](https://docs.djangoproject.com/en/1.4/ref/middleware/)，这很重要，因为中间件类的顺序非常重要。

# powershell - PowerShell 中使用 WMI 的简单逻辑语句

> ID：10660552
> 
> 赞同：2
> 
> 时间：2012-05-18T22:35:41.050
> 
> 标签：powershell, powershell-2.0

在 PowerShell 中，我输入以下语句：

```
$var = Get-WmiObject win32_product | select-object name

if ($var.name -like 'adobe') {write-host '123'} 
```

该变量可以很好地存储已安装产品的列表；但是，我的`if`then 不会捕获任何东西。在执行时，我没有得到任何输出或错误。如果我使用诸如[Get-Process 之](http://technet.microsoft.com/en-us/library/hh849832.aspx)类的东西，但不适用于[Get-WmiObject](https://technet.microsoft.com/en-us/library/hh849824.aspx) ，则此方法有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T04:52:10.263

该`-like`运算符是通配符模式匹配运算符。它返回与您提供的表达式匹配的内容。用作`*`通配符。所以你会使用：

```
if ($var.name -like '*adobe*') {write-host '123'} 
```

**更新**- 像这样访问集合上的 name 属性仅在 PowerShell v3 中对我有用。对于 PowerShell v2，我认为您需要做一些不同的事情。我建议创建一个字符串数组而不是像这样的 PsCustomObjects 集合（`-ExpandProperty`参数起作用）：

```
$var = get-wmiobject win32_product | ? {$_.Name} | select-object -Expand name 
```

然后在不使用 name 属性的情况下执行 if 语句：

```
if ($var -like '*adobe*') {write-host '123'} 
```

如果您在名称中安装了带有 adobe 的东西，它将执行 IF 块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T12:32:05.223

另一个答案是最好让 WMI 在服务器上进行过滤，这样您的网络流量就会减少。这是一个带有 WMI 过滤器的示例：

```
Get-WmiObject win32_Product -Filter "name like '%adobe%'" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:45:55.117

我从来没有意识到有一个类似的比较运算符？在那种情况下，我通常使用 .Contains("value looking for") 。

但是，刚刚注意到这里有一个 -contains 运算符。

[掌握 PowerShell，第 7 章条件](http://powershell.com/cs/blogs/ebook/archive/2009/03/08/chapter-7-conditions.aspx)

啊，如果你得到一个以上的结果，你需要遍历它们：

```
$var | foreach-object { if ( $_.name -contains 'adobe' ) { write-host '123' } } 
```

可能是这样的吗？

$var 是结果列表，它没有属性“名称”，但列表中的每个项目都应该。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-19T05:10:10.470

要添加到@Zach 的答案，就像您所说的那样：

```
$var.name -like 'adobe' 
```

只有当他的名字完全等于“abobe”时才会匹配。

例如

```
PS C:\> 'adobe' -like 'adobe'
True
PS C:\> 'Adobe Air' -like 'adobe'
False 
```

但是， -like 旨在与通配符一起使用：

```
PS C:\> 'Adobe Air' -like '*adobe*'
True 
```

所以你可以做

```
$var | foreach{ if ( $_.name -like '*adobe*' ) { write-host '123' } } 
```

或者，在更 POSH 风格中，使用 where-object

```
$var | where-object{ $_.name -like '*adobe*' } |  write-host '123' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-19T09:38:49.900

`$var.name`仅在`$var`包含单个对象（标量，单例）时有效。当`$var`持有一个项目集合时，PowerShell 会尝试为您获取集合本身的 Name 属性。

集合/数组没有 Name 属性，你什么也得不到。也就是说，`$var.Name`将在 PowerShell v3 中工作。

要与 Name 属性进行比较，您需要遍历所有对象并且：

```
if ($var.name -like 'adobe') {write-host '123'} 
```

如果您提取了所有值（`$var`包含字符串列表），那么您可以这样做：

```
$var = get-wmiobject win32_product | select-object -expand name

if ($var -like 'adobe') {write-host '123'} 
```

# javascript - jQuery - 在其他 UI 更改完成后进行 UI 更改

> ID：10660557
> 
> 赞同：1
> 
> 时间：2012-05-18T22:36:12.180
> 
> 标签：javascript, jquery

`$("#login").toggle("drop", {direction: "left"});`在完全完成之后我将如何执行......做`$("#register").toggle("drop", {direction: "right"});`。因为`DIVS`它们不是浮动的，同时它们在它们之间相互堆叠`drop`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:40:20.767

[JQuery 切换](http://api.jquery.com/toggle/)可以采用作为回调的第二个参数，将第二个 UI 更改放入该回调中。

```
$(document).ready(function(){

    $('#switch-to-login').live("click",function(){

        $("#login").toggle("drop", {direction: "left"}, function() {
           $("#register").toggle("drop", {direction: "right"});
        });

        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T22:39:42.660

使用回调：

```
$("#login").toggle("drop", {direction: "left"}, function(){
        $("#register").toggle("drop", {direction: "right"});
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T22:51:16.707

像这样的东西：http: [//jsfiddle.net/FzsZS/](http://jsfiddle.net/FzsZS/)

我在 iPad 上，所以我不得不重做所有代码等。对此感到抱歉。

# facebook - Facebook 应用程序中的应用程序域是什么？

> ID：10660568
> 
> 赞同：3
> 
> 时间：2012-05-18T22:37:32.100
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph

Facebook 应用程序中的应用程序域用于什么？

有人[在 Facebook 应用程序中的应用程序域是什么？](https://stackoverflow.com/questions/8574344/what-is-app-domain-in-facebook-apps)但我并没有真正明白。

我想做的是从移动应用程序“发布操作”。要发布的对象必须存储在单独的网页中。并且单独页面的域应该包含在应用程序域中。

应用域是否也适用于移动应用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:45:29.213

那么 AppDomain 只是意味着您的应用程序的服务器端文件的位置。您的应用程序只能在该域中使用。Facebook 需要数据来解决跨域和安全问题。

除非您打算对网站使用 FB 身份验证，否则您不需要填写 App Domain 输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T19:47:35.893

I encountered the same issue for my mobile app. To fix it, I set the App Domain to my domain. But that wasn't enough because I then got the error:

> Error You have specified an App Domains but have not specified a Site URL or a Mobile Web URL puurbuy.com must be derived from your Site URL or your Mobile Web URL.

So I had to go one step further and enable "Website with Facebook Login" setting the URL to my homepage, even though I do not have a Facebook login on my website. A terrible work around in my opinion, but it worked.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-18T17:35:05.480

因为没有使用沙盒模式： 1\. 必须在 appdetails 页面上建立一个类别 2\. 必须使用 Facebook 登录设置网站 3\. 然后可以设置应用程序域

现在调试会毫无错误地提取正确的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-02T08:38:53.863

App 域与您的应用程序或 Web 域无关，这基本上是一个 App Store 地址。只需在 App Domains 中写下这一行。

```
apps.apple.com 
```

这对我有用。

# jquery - 将行从一个表添加到另一个表的 Jquery 问题

> ID：10660572
> 
> 赞同：0
> 
> 时间：2012-05-18T22:37:52.243
> 
> 标签：jquery, append, tablerow

我有 2 个表，我想根据使用复选框选择的行将行从一个表添加到另一个表，它将行从一个表添加到另一个表，但它不是根据行添加，而是基于单元格，这是什么我正在使用：当单击按钮时，它会遍历所有已检查的行并删除第一个单元格，即复选框并将包裹在一行中的单元格的其余部分添加到下一个表中，我假设它会将生成的单元格包装到该行，但事实并非如此，因为当我选择多行时，它会直接附加到最后一行最后一个单元格的末尾。

```
$("#btnAddStories").click(function () {
            $checkedStories = $("#dnn_TopStories_grdTopStoriesSearch input[type=checkbox]:checked");
            $.each($checkedStories, function (index, item) {
                $row = $(this).closest("tr").clone().find("td:not('.firstCell')").remove();
                $('#tblTopstories tbody').append($row);
            });
        }); 
```

![在此处输入图像描述](../Images/535ec2044082c2bc2e412152f3a6fcfd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:43:01.923

完全改变答案，因为我之前的答案实际上并没有回答你的问题！

问题是，当您设置时`$row`，您只是调用该行中的单元格，当您执行`.find()`

为了使其正常工作，您需要将附加更改为：

```
$('#tblTopstories tbody').append($('<tr/>', {html: $row}); 
```

它的作用是创建 a`<tr></tr>`并将 html 内容设置为`$row`

为了您的代码清晰起见，我会将名称更改为`$row`，`$cells`但这只是个人喜好。

此外，单击元素时会出现潜在问题`#btnAddStories`，因此我会将其更改`.click()`为`.on('click')`并在开头添加一个`.off('click')`以防止重击。（有时事件会在您第一次点击时触发一次，在您的第二次点击时触发两次，等等，`.off()`在分配事件之前调用会阻止事件处理程序被多次应用，[这通常是在函数内部分配事件处理程序时]）

```
$("#btnAddStories").off('click').on('click', function(){
  ...
}) 
```

# javascript - 使用 Paper.js、Meteor 和 MongoDB 存储和检索路径

> ID：10660574
> 
> 赞同：0
> 
> 时间：2012-05-18T22:37:58.743
> 
> 标签：javascript, mongodb, meteor

我正在使用新的 Meteor.js 应用程序平台和 paper.js 构建一个简单的绘图应用程序。我希望用户能够绘制路径，然后将它们“实时”自动保存到 Mongo。具体来说，当用户停止拖动鼠标时。这些路径应立即出现在其他客户端屏幕上；无论如何，Meteor 中的标准 OP。

我使用 .toSource 将 paper.js 路径存储为未压缩的字符串，这很好，因为系统只为一个用户（我）构建，但是当对象再次加载时，paper.js 无法识别它们。

我确信有一种“正确”的方法可以做到这一点。我基本上只需要一个将已创建的路径对象添加到当前 paper.js 项目的命令。

帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T23:17:36.473

您需要[观察处理程序](http://docs.meteor.com/#observe)。您将为添加/更改/删除的事件定义函数，这些函数将相应地修改绘图。如果您对观察方法感到困惑，请将我指向您的代码，我会为您提供帮助。

# c++ - 从 C++ 中的 CSV 文件中读取特定元素

> ID：10660577
> 
> 赞同：0
> 
> 时间：2012-05-18T22:38:04.853
> 
> 标签：c++, csv, file-read

我正在尝试创建一个参考程序，我认为该程序将使用 Excel 电子表格来保存仅供阅读的信息。我希望用户能够从选项列表中选择一个主题，并将相应单元格中的信息反馈给他们。该程序是用 C++ 编写的。我的问题是，如何从我的程序中访问电子表格中的特定单元格？我对其进行了一些研究，并且发现我想将我的文件保存为 csv 并使用 fscanf 来读取内容，但是我不知道如何做这部分。我用谷歌搜索并找到了这个线程：

[http://www.daniweb.com/software-development/cpp/threads/204808/parsing-a-csv-file-separated-by-semicolons](http://www.daniweb.com/software-development/cpp/threads/204808/parsing-a-csv-file-separated-by-semicolons)

但我认为它会读取 CSV 中的所有数据？无论如何，据我所知。我只想提取特定元素。那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:39:52.693

如果您只需要特定元素，您仍然必须解析文件的所有内容，直到您到达这些元素。您不必存储不需要的值，但确实需要解析它们以在文件中前进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T23:07:50.790

你是从 Excel 调用程序吗？如果你是，一点点 VBA 会有很长的路要走。您始终只能导出准备好供 C++ 程序读取的感兴趣的单元格。

否则，其他答案都是正确的。但是，您不需要一次将整个文件加载到内存中。您可以使用 std::fstream 打开文件并读取文件的每一行，解析每一行所需的信息。

# c# - 如何在 URL 重定向中获取调用 URL

> ID：10660579
> 
> 赞同：-2
> 
> 时间：2012-05-18T22:39:01.910
> 
> 标签：c#, asp.net, url-rewriting, asp.net-3.5

我在 ASP.net 中使用 URL 重定向，就像这个页面

```
http://xyz:6477/BoxOffice/Events/353454 
```

重定向到 >>>

```
http://xyz:6477/BoxOffice/Events.aspx?EventId=353454 
```

我想在事件页面的页面加载上获取 URL

```
http://xyz:6477/BoxOffice/Events/353454 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-05-18T23:09:47.687

利用

```
//To get referrer
//in C#
Uri MyUrl = Request.UrlReferrer; 

//in vb
Dim MyUrl As Uri = Request.UrlReferrer 

//To get current
//in C#

Uri currrenturl = Request.Url;
//in vb
Dim currentUrl As Uri = Request.Url 
```

如果您使用的是路由，请使用

```
 //c#
    string ref = Request.UrlReferrer.LocalPath; 
```

# android - 是否可以对用户取消 Android 通知做出反应？

> ID：10660582
> 
> 赞同：1
> 
> 时间：2012-05-18T22:39:28.370
> 
> 标签：android, notifications

我有一个后台服务在 Android 的状态栏中设置通知。后台服务正在做一些工作，但需要在用户**点击或取消**通知时停止。

如果用户在创建通知时通过向通知传递意图来**单击**通知，我可以停止服务。

如果用户**取消**通知，是否可以做出反应？或者如果所有通知都被取消？如果是这样，怎么做？

注意：我将取消定义为通过向右滑动来删除通知，或者单击`x`右上角的以删除所有通知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:41:20.523

查看`deleteIntent`以下内容`Notification`：

> 当用户使用“清除所有通知”按钮删除状态条目时执行的意图。

# cocoa - 更新数组控制器上的谓词

> ID：10660586
> 
> 赞同：0
> 
> 时间：2012-05-18T22:39:51.027
> 
> 标签：cocoa, cocoa-bindings, nssearchfield

我有一个数组控制器，我已经绑定了一个实体，排序描述符和谓词。如果我在应用程序运行时更改谓词格式，它可以工作，所以绑定工作。

我的问题是当我想更改谓词 f.ex 时。使用用户输入的搜索词或某些字符串，没有任何反应，但是当我向核心数据数据库添加记录时，表格视图会更新。

所以我的问题是，我如何告诉数组控制器谓词已经改变并且它应该更新自己。这是我输入搜索词时运行的代码，它也可以正常工作，并且我可以正确获取所有 NSLogs 输出。只是我的 tableview 没有更新自己。

```
- (IBAction)didChangeSearch:(id)sender {
    if (sender == searchField) {
        NSString *searchterm = [sender stringValue];
        if (searchterm.length > 1) {
            predicate = [NSPredicate predicateWithFormat:@"name contains [c]%@", @"m"];
            NSLog(@"Putting predicate to the job : %@", searchterm);

        } else {
            predicate = nil;
            NSLog(@"There is nolonger any predicate");
        }
    }
    NSLog(@"I just got %@", [sender stringValue]);
} 
```

一开始我想说，我对绑定非常陌生，直到今晚才使用它们，对它们有很好的感觉，并且喜欢它，为我节省了很多代码，我终于理解了它（最多1天能够）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T01:21:13.163

您应该使用 self.predicate = ..... 这将确保发送正确的 KVO 通知，这将使您的 tableview 立即更新（这假定“谓词”是一个属性并绑定到您的数组控制器的过滤谓词捆绑）。

# ios - 核心数据实体的方法继承（一个父）

> ID：10660588
> 
> 赞同：0
> 
> 时间：2012-05-18T22:40:08.387
> 
> 标签：ios, core-data, inheritance, methods

我有 3 个实体，其中一个是另外两个的父级。我为它们中的每一个创建了 NSManagedObject 子类。我知道如何从父类继承属性，但我需要继承一个方法。现在我只有 1 个视图控制器，所以我真的不知道如何只用一个 VC 进行方法继承，或者我可以吗？所有 3 个实体都有一个同名的方法。感谢您提供任何可能的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:11:26.993

只需在父类中声明一个方法，并在子类中覆盖它：

```
@interface BaseClass : NSManagedObject
- (void)doSomething;
@end

@interface InheritedClass : BaseClass
- (void)doSomething;
@end

@implementation InheritedClass
- (void)doSomething {
    [super doSomething];
    ....
}
@end 
```

# ruby-on-rails - 部署到 Heroku 的意外字符“#”

> ID：10660594
> 
> 赞同：3
> 
> 时间：2012-05-18T22:40:29.703
> 
> 标签：ruby-on-rails, ruby, heroku

我一直试图让我的应用程序在 heroku 上运行。我可以在本地运行并且运行良好，但是当我部署到 heroku 时出现以下错误：

```
2012-05-18T21:26:18+00:00 app[web.1]:   (in /app/app/assets/javascripts/application.js.erb)):
2012-05-18T21:26:18+00:00 app[web.1]:     8:   <%= render 'layouts/shim'%>
2012-05-18T21:26:18+00:00 app[web.1]: ActionView::Template::Error (Unexpected character '#'
2012-05-18T21:26:18+00:00 app[web.1]:     4:   <title><%= full_title(yield(:title))%></title>
2012-05-18T21:26:18+00:00 app[web.1]: 
2012-05-18T21:26:18+00:00 app[web.1]:     5:   <%= stylesheet_link_tag    "application", :media => "all" %>
2012-05-18T21:26:18+00:00 app[web.1]:     7:   <%= csrf_meta_tags %>
2012-05-18T21:26:18+00:00 app[web.1]:     3: <head>
2012-05-18T21:26:18+00:00 app[web.1]:     6:   <%= javascript_include_tag "application" %>
2012-05-18T21:26:18+00:00 app[web.1]:   app/views/layouts/application.html.erb:6:in `_app_views_layouts_application_html_erb___39687462904242755_48413880'
2012-05-18T21:26:18+00:00 app[web.1]: 
2012-05-18T21:26:18+00:00 app[web.1]: 
 9: </head> 
```

最初我认为这是一个咖啡脚本问题。但我已经摆脱了任何 .coffee 文件，只是为了看看它是否会起作用。还是一样的结果

这是我的 application.js 文件：

```
//= require jquery
//= require jquery_ujs
//= require jquery-ui
//= require_tree .

$(document).ready(function()
 {  

    function setCountdownTimer(element, year, month, day) {
        var date = new Date(year, month, day);
        $(element).countdown({until: date});
    }

    $('#hashtag_id').live('change', function() {
      $('#user_comments').empty();
      $.ajax({ url: '/headlines/update_comments/',
        data: {hashtag: this.value, id: $('#headline_tag').data('id')},
        success: function(data) {
            $('#user_comments').html(data);
          }
      })
    });

}); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-29T06:51:06.847

您是否将任何咖啡脚本文件更改为仅 js 文件，并将评论留在顶部：

```
# Place all the behaviors and hooks related to the matching controller here.
# All this logic will automatically be available in application.js.
# You can use CoffeeScript in this file: http://jashkenas.github.com/coffee-script/ 
```

如果有，请删除这些评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T12:37:23.230

安装 Devise 时，此错误通常与另一个资产管道错误同时发生。在调查此处所述的解决方案之前， [rails 3.1.0 ActionView::Template::Error（application.css 未预编译）](https://stackoverflow.com/questions/7275636/rails-3-1-0-actionviewtemplateerrror-application-css-isnt-precompiled) 首先尝试 Snowangel 的建议以节省时间。

# android - Android：纵向模式下的相机预览方向

> ID：10660598
> 
> 赞同：17
> 
> 时间：2012-05-18T22:41:14.563
> 
> 标签：android, camera, rotation, orientation, portrait

我使用相机仅显示预览（不拍照或录制视频）。

该应用程序始终处于纵向模式（禁用横向模式）。相机预览总是逆时针旋转 90 度，我无法更改它（无论是使用`setDisplayOrientation`还是使用`p.set("orientation", "portrait" )`and `p.set("rotation", 90) )`.

预览总是像这样旋转还是取决于设备？如果在纵向模式下总是这样，我可以在之后旋转图像。

或者有没有办法正确设置相机？我已经阅读了很多关于此的主题，但没有任何答案对我有用（Galaxy s2，Android v2.3）

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-19T04:17:10.690

强制纵向：

设置`android:screenOrientation="portrait"`您的`AndroidManifest.xml`并在调用`camera.setDisplayOrientation(90);`之前调用`camera.startPreview();`

我没有在 GS2 上测试过，但它适用于我测试过的每部手机。

注意：setDisplayOrientation 是在[API 级别 8中添加的](http://developer.android.com/reference/android/hardware/Camera.html#setDisplayOrientation%28int%29)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-01-20T13:08:24.980

*我只为肖像模式编写了应用程序。*

```
camera.setDisplayOrientation(90); 
```

将使相机旋转到 90 度，这可能导致 android 中某些设备的方向不合适为了获得所有 android 设备的正确预览，请使用以下代码，该代码在开发人员站点中被引用。

下面你必须发送你的活动，cameraId = back 是 0 并且 Front camera 是 1

```
public static void setCameraDisplayOrientation(Activity activity, int cameraId, android.hardware.Camera camera) {
    android.hardware.Camera.CameraInfo info = new android.hardware.Camera.CameraInfo();
    android.hardware.Camera.getCameraInfo(cameraId, info);
    int rotation = activity.getWindowManager().getDefaultDisplay().getRotation();
    int degrees = 0;
    switch (rotation) {
        case Surface.ROTATION_0:
            degrees = 0;
            break;
        case Surface.ROTATION_90:
            degrees = 90;
            break;
        case Surface.ROTATION_180:
            degrees = 180;
            break;
        case Surface.ROTATION_270:
            degrees = 270;
            break;
    }

   int result;
    //int currentapiVersion = android.os.Build.VERSION.SDK_INT;
        // do something for phones running an SDK before lollipop
        if (info.facing == Camera.CameraInfo.CAMERA_FACING_FRONT) {
            result = (info.orientation + degrees) % 360;
            result = (360 - result) % 360; // compensate the mirror
        } else { // back-facing
            result = (info.orientation - degrees + 360) % 360;
        }

    camera.setDisplayOrientation(result);
} 
```

这是为相机设置 setDisplayOrientation 的方法，它适用于所有 Android 设备。

# c# - 如何使用 .NET 读取 Excel 文件 (.xls) 的二进制数据？

> ID：10660599
> 
> 赞同：1
> 
> 时间：2012-05-18T22:41:16.763
> 
> 标签：c#, excel, binary, byte, xls

不，ADO.NET 不会解决我的问题，因为我正在使用的 excel 文件不包含表格形式的信息。也就是说，没有什么可查询的，而且表的名称和表的数量会有所不同。

本质上，我的工作是搜索 excel 文档中的每个单元格，并根据其他一些数据对其进行验证。

现在我只有一个代表 .xls 文件内容的 byte[] 数组。转换为字符串是没有意义的，因为它只是二进制数据。

如果我使用 COM 互操作并在后台运行 Excel，是否可以将二进制数据以 byte[] 数组形式注入它，或者我是否必须将文件保存到磁盘，然后自动打开它并扫描每一行？

没有更简单的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T23:41:38.957

**如何使用 .NET 读取 excel 文件 (.xls) 的二进制数据**
有多种方法，excel 文件格式已更改了几次，因此本机读取文件是一项艰巨的工作，并且取决于版本，通常不推荐. 对于读取表格数据，大多数人选择 ADO.NET，但正如您所暗示的，如果您需要任何格式化或发现，那么 MS 会推荐 COM Interop。

**如果我使用 COM 互操作并在后台运行 Excel，是否可以将二进制数据以 byte[] 数组形式注入它**

excel COM 对象模型[确实允许您将数据批量设置](https://stackoverflow.com/questions/536636/write-array-to-excel-range)为 Range 对象，您使用 2 维对象数组 (object[,]) 设置它

**还是我必须将文件保存到磁盘，然后自动打开它并扫描每一行？**

不，您可以与“进程外”COM 服务器 (Excel) 进行交互，而无需先保存，您可以在内存中设置数据、对其进行格式化等。

**没有更简单的方法吗？**
是的，查看[Spreadsheet Gear](http://www.spreadsheetgear.com/)他们的对象模型几乎与 com 模型相同，但是您根本不需要 Excel，它处理大数据的速度也快了一个数量级。它并不便宜（我上次检查时为 1000 美元），但比编码工作节省更多。（我不以任何方式隶属于电子表格设备）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T23:19:29.937

您可以使用[NPOI](http://npoi.codeplex.com/)打开和读取您的 XLS 文件，您基本上会想要遍历您的表格/行/列以查找数据。我通常使用 NPOI 来读取和写入 XLS 表单，这些表单包含整个工作表中随机单元格中的数据。

# ruby-on-rails-3 - 在 Rails 3.2.3 中，可以在命令行上创建添加索引的迁移吗？

> ID：10660603
> 
> 赞同：0
> 
> 时间：2012-05-18T22:41:41.797
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2

将我们在 bash 中键入的所有行放在脚本中创建整个初始项目可能会很方便，对于所有脚手架创建、rake db:migrate 甚至 git 命令，这样如果我们需要创建Rails 4 或 5 下的相同项目，这将非常简单。

但是对于将索引添加到表列的迁移文件，有没有办法在命令行上指定它或以某种方式在命令行上自动执行它？否则，我们将需要输入用于创建迁移文件的命令，然后手动手动编辑该文件——如果所有内容都可以放入脚本中，那会很简洁。

（或者如果可以在脚手架行中指定索引，那可能会更好）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:50:07.333

生成模型的迁移时，`index`在常规索引和`uniq`唯一索引的字段名称之后使用。

例子：

```
$rails g resource Widget name:index part_number:uniq 
```

仅生成迁移时，您可能可以做类似的事情

# php - 无法删除使用 PHP 创建的目录或文件（又名权限地狱）

> ID：10660605
> 
> 赞同：5
> 
> 时间：2012-05-18T22:41:52.387
> 
> 标签：php, permissions

这是独家新闻：我需要能够使用 PHP 脚本创建文件夹，并将图像文件上传到这些文件夹。这是我的代码：

**创建目录：**

```
mkdir('[path]/images/foldername'); 
```

**上传图片：**

```
if ($_FILES["file"]["error"] > 0 || $_FILES["file"]["type"] != "image/jpeg") // file must be valid and .jpg
{
    echo "Error: " . $_FILES["file"]["error"] . "<br />";
}
else
{
    echo "Upload: " . $_FILES["file"]["name"] . "<br />";
    echo "Type: " . $_FILES["file"]["type"] . "<br />";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
    echo "Stored in: " . $_FILES["file"]["tmp_name"] . '<br />';

    if(file_exists($path ."/" . $_FILES["file"]["name"]))
    {
        echo $_FILES["file"]["name"] . " already exists. ";
    }
    else
    {
        move_uploaded_file($_FILES["file"]["tmp_name"], $path ."/" . $_FILES["file"]["name"]);
        echo "Stored in: " . $path ."/" . $_FILES["file"]["name"];
    }
} 
```

FTP 编辑器给出这些错误：

```
[L] DELE 20.jpg
[L] 550 Could not delete imagename.jpg: Permission denied 
```

然后

```
[L] RMD foldername
[L] 550 Can't remove directory: Directory not empty 
```

我尝试在我的 FTP 编辑器中更改权限，但收到此错误：

[L] SITE CHMOD 777 [path]/foldername [L] 550 无法更改 [path]/foldername 上的权限：不允许操作
我尝试使用 SSH 和 Putty 删除文件，但这也不起作用。

请帮我！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T22:43:59.907

移动上传的文件后，尝试执行以下操作：

```
@chmod($path ."/" . $_FILES["file"]["name"], 0777); 
```

或者其他的东西。您可能希望将权限更改为更好的权限。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T22:48:29.847

看起来您的 PHP 安装以不同于 FTP 会话的用户身份运行。因此，您的 php 上传脚本可以创建您的 ftp 用户无法触及的文件；-)。

基本上有三种方法来处理这个问题：

1.  编写一个删除要删除的文件的 php 脚本。为此使用 unlink()。谷歌也会给你一些递归实现。
2.  更改文件的权限（使用 chmod。小心，您很容易使不应该有这种可能性的人或进程可以访问文件。不要在生产环境中这样做）
3.  确保您的 ftp 用户和您的 php 用户相同。您需要在目标机器上成为 root，或者您需要机器上的友好管理员来进行相应的设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T22:46:00.207

您可以更改运行 FTP 服务器的用户帐户以使用与您的 PHP 脚本相同的用户（可能是 www-data 或 httpd）

# c# - 复选框和页面重新加载

> ID：10660610
> 
> 赞同：2
> 
> 时间：2012-05-18T22:42:53.940
> 
> 标签：c#, asp.net, checkbox

我有一个asp.net CheckBox，现在我想在选中或取消选中后重新加载页面，并使用CheckBox.Checked 信息来选择gridview 的sql 查询。我在 Page_Load 方法中放了这样的代码：

```
if (CheckBox1.Checked)
{
    query = "select ...";
} 
```

但什么也没有发生。我也设置了 AutoPostBack。尝试使用事件。不知道这个系统是如何工作的：/

编辑：复选框工作正常，但问题出在不同的地方。单击复选框后，在 Page_Load 方法中，我将使用我的查询来设置 SqlDataSource。看起来页面已重新加载，但 gridview 未刷新。当我单击gridview 的列mame （排序此列），gridview 被新的sql 查询刷新。所以我需要考虑单击复选框后如何刷新网格视图。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T22:47:23.837

您似乎没有`IsPostBack`在页面加载事件中使用属性。如果您不使用它，您`CheckBox`将在每次页面加载时重置

试试这个方法

```
 protected void Page_Load(object sender, EventArgs e)
    {

        if (!IsPostBack)
        {
            // Here do your stuff.
        }
    } 
```

# c# - 替代在带有 while 循环的方法中等待

> ID：10660611
> 
> 赞同：-2
> 
> 时间：2012-05-18T22:42:57.037
> 
> 标签：c#

我正在编写一个程序，它可能每秒运行 50 次或更多次（必要）

该方法需要遵循这个模型：

*   创建布尔值。
*   等到值改变。
*   继续方法。

很简单，我知道，但我不想使用`while`循环，因为它占用的 CPU 比它应该多 3% 左右，而且我想，如果我需要它再等待值改变，那可能需要占用我所有的 CPU 周期，这是我不想要的。此外，每次我以每秒 50 次执行该方法时创建一个新线程是一个可怕的想法。

那么我能做什么呢？如果我需要提供任何其他类型的信息，请随时询问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T02:16:11.530

根据方法的性质，您可以将方法的其余部分放入事件处理程序中，然后将更改其值的地方首先放入 ValueChanged 类型的事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T22:51:37.907

有`ManualResetEvent`什么用吗？不确定它如何与您的系统一起使用，但可能需要研究一下。

# php - DynamoDB 与 PHP，update_item 错误

> ID：10660621
> 
> 赞同：3
> 
> 时间：2012-05-18T22:44:00.867
> 
> 标签：php, amazon-web-services, amazon-dynamodb

我正在尝试使用 PHP SDK 更新我的 DynamoDB 表中的表。这是错误：

com.amazon.coral.service#SerializationException 在不期望的地方找到列表的开始

我猜我的数组格式有问题。我正在使用此[文档](http://docs.amazonwebservices.com/AWSSDKforPHP/latest/#m=AmazonDynamoDB/update_item)作为参考。

**我要发送的数组：**

```
array(3) {
  ["TableName"]=>
  string(7) "teacher"
  ["Key"]=>
  array(1) {
    ["HashKeyElement"]=>
    array(1) {
      ["S"]=>
      string(36) "97770A6A-EF06-AF4A-3E30-87DAC0237F6D"
    }
  }
  ["AttributeUpdates"]=>
  array(1) {
    [0]=>
    array(2) {
      ["population"]=>
      array(1) {
        ["Action"]=>
        string(3) "ADD"
      }
      ["Value"]=>
      array(1) {
        ["SS"]=>
        array(1) {
          [0]=>
          string(36) "97770A6A-EF06-AF4A-3E30-87DAC0237F6D"
        }
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T08:01:43.323

AttributeUpdates 中的“人口”被错误地放置在数组中。它应该是元素的键，而不是元素本身。“Value”和“Action”都是数组元素的一部分：结构应该是：

```
array(3) {
  ["TableName"]=>
  string(7) "teacher"
  ["Key"]=>
  array(1) {
    ["HashKeyElement"]=>
    array(1) {
      ["S"]=>
      string(36) "97770A6A-EF06-AF4A-3E30-87DAC0237F6D"
    }
  }
  ["AttributeUpdates"]=>
  array(1) {
    ["population"]=>
    array(1) {
      ["Value"]=>
      array(2) {
        ["SS"]=>
        array(1) {
          [0]=>
          string(36) "97770A6A-EF06-AF4A-3E30-87DAC0237F6D"
        }
        ["Action"]=>
        string(3) "ADD"
      }
    }
  }
} 
```

来源：

```
$updateOptions = array(
  'TableName'    => 'teacher',
  'Key'          => array(
      'HashKeyElement'  => array('S' => '97770A6A-EF06-AF4A-3E30-87DAC0237F6D'),
  ),
  'AttributeUpdates' => array(
      'population'    => array('Value' => array('SS' => array('97770A6A-EF06-AF4A-3E30-87DAC0237F6D'), 'Action' => 'ADD')),
  )
); 
```

# html - CSS 和 HTML 向 RoR 的过渡使 sprite 变为黑框

> ID：10660622
> 
> 赞同：0
> 
> 时间：2012-05-18T22:44:06.770
> 
> 标签：html, ruby-on-rails, css, ruby

我让这个网站在 ruby​​ on rails 之外工作，然后我将以下代码移动到 rails，当我将鼠标放在它们上方时，它会使悬停图像变黑。

```
 // Place all the styles related to the home controller here.
// They will automatically be included in application.css.
// You can use Sass (SCSS) here: http://sass-lang.com/
 html {
    height: 80%;
   width:90%
}

p {font-size:25px;
font-family: Helvetica,Arial,sans-serif;
}
body
{
background-image:url('Loons-bkg.jpg');
    width: 100%;
    padding:0;
    height: 100%;
}

#logo{
    width: 100%;
    height: 190px;
    background:url('Loons-Title.png');
     background-position:center top ;
    background-size:contain;
    background-repeat:no-repeat;
    }

div.wrapper{
    position:relative;
    width: 80%;
    height: 100%;
    margin-left: 10% ;

    }
#blog{
    position:absolute;
    border-style:solid;
    border-width:2px;
    width:60%;
    padding: 30px;
    min-height:92% ;
    background: rgb(255, 250, 250); /* Fall-back for browsers that don't support rgba */
    background: rgba(255, 250, 250, .5);
    left:20%;
    }

#navbar {
    height: 65px;
    width: 700px;
    list-style:none;
    padding: 0;
    margin:0 auto;
    overflow: hidden;
    }

#navbar li {
    float: left;
    background-image: url(image_path('Loons-menu-sprite.png'));
}
#navbar a {
    display: block;
    padding-top: 66px;
    text-decoration: none;

}
#nav-bio { width: 79px;

}
#nav-bio:hover {
    width: 79px;
    background-position: 0px -66px;
}
#nav-music { width: 137px;

    background-position: -79px 0px;}
#nav-music:hover {
    width: 137px;
    background-position: -79px -66px;
}
#nav-video {
    width: 121px;
    background-position: -216px 0px;
 }
#nav-video:hover {
    width: 121px;
    background-position: -216px -66px;
}
#nav-press {
    width: 140px;
    background-position: -337px 0px;
 }
 #nav-press:hover {
    width: 140px;
    background-position: -337px -66px;
}
#nav-shows {
    width: 129px;
    background-position: -477px 0px;
}
#nav-shows:hover {
    width: 129px;
    background-position: -477px -66px;
}
#nav-shop {
    width: 94px;
    background-position: -606px 0px;
 }
 #nav-shop:hover {
    width: 94px;
    background-position: -606px -66px;
}

#social-media {
    position:absolute;
    height: 97px;
    width: 700px;
    list-style:none;
    padding: 0;
    margin:0 auto;
    overflow: hidden;
    }
#social-media li {
    float: left;
 background-image: url(Social-Media-Sprite.png);

}

#social-media a{
    display: block;
    padding-top: 70px;
    text-decoration: none;
    text-indent:-9999px;
    }

#facebook { width: 103px;}
#facebook:hover {
    width: 103px;
    background-position: 0px -90px;}
  #bandcamp {
    width: 114px;
    background-position: -103px 0px;}
#bandcamp:hover {
    width: 114px;
    background-position: -108px -90px;
        }
#rc {
    width: 103px;
    background-position: -217px 0px;}
#rc:hover {
        width: 103px;
        background-position: -217px -90px;
        }
#social{
 position:absolute;
 bottom: 12%;
 right: 12%;

} 
```

这是应用程序视图

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <title>Loons</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
</head>
<body>
<div id = 'logo'></div>
<ul id="navbar">
        <li id="nav-bio"><a href="#">Bio</a></li>
        <li id="nav-music"><a href="#">Music</a></li>
        <li id="nav-video"><a href="#">Video</a></li>
        <li id="nav-press"><a href="#">Press</a></li>
        <li id="nav-shows"><a href="#">Shows</a></li>
        <li id="nav-shop"><a href="#">Shop</a></li>
</ul>
<div class = 'wrapper'>
    <div id = 'blog'>
<%= yield %>

                              <iframe width="600" height="500" src="http://www.youtube.com/embed/MQ24QnrPKwo" frameborder="0" allowfullscreen></iframe>

       </div>
     <div id ="social">
              <ul id="social-media">
           <li id="facebook"><a href="https://www.facebook.com/pages/Loons/157520584337783?v=info">b</a></li>
           <li id="bandcamp"><a href="http://loonsmusic.bandcamp.com/">b</a></li>
           <li id="rc"><a href="#">b</a></li>
       </ul>
       </div>
   </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T19:53:33.413

如果您使用了，`rails scaffold --no-stylesheets`您将避免将来不得不删除脚手架.css。

# c# - AutoMapper 从源嵌套集合映射到另一个集合

> ID：10660623
> 
> 赞同：12
> 
> 时间：2012-05-18T22:44:10.367
> 
> 标签：c#, model-view-controller, nested, viewmodel, automapper

编辑：标题不正确，我正在尝试从源列表映射到嵌套模型的源列表。

我在尝试将列表映射到嵌套模型中列出的另一个列表时遇到问题。种类和非扁平化。问题是我不知道如何进行映射。

这是我在映射失败后的设置：

```
public class DestinationModel
{
    public DestinationNestedViewModel sestinationNestedViewModel { get; set; }
}

public class DestinationNestedViewModel
{
    public List<ItemModel> NestedList { get; set; }
}

public class SourceModel
{
    public List<Item> SourceList { get; set; }
} 
```

其中 Item 和 ItemModel 已经在它们之间定义了映射

我不能这样...

```
Mapper.CreateMap<SourceModel, DestinationModel>()
.ForMember(d => d.DestinationNestedViewModel.NestedList,
    opt => opt.MapFrom(src => src.SourceList)) 
```

错误：

表达式 'd => d.DestinationNestedViewModel.NestedList' 必须解析为顶级成员。参数名称：lambdaExpression

然后我尝试了这样的事情：

```
.ForMember(d => d.DestinationNestedViewModel, 
 o => o.MapFrom(t => new DestinationNestedViewModel { NestedList = t.SourceList })) 
```

问题是 **NestedList = t.SourceList**。它们各自包含不同的元素，分别是**ItemModel**和**Item**。所以，他们需要被映射。

我如何映射这个？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-19T12:40:02.090

我想你想要这样的东西：

```
Mapper.CreateMap<Item, ItemModel>();

/* Create a mapping from Source to Destination, but map the nested property from 
   the source itself */
Mapper.CreateMap<SourceModel, DestinationModel>()
    .ForMember(dest => dest.DestinationNestedViewModel, opt => opt.MapFrom(src => src));

/* Then also create a mapping from Source to DestinationNestedViewModel: */
Mapper.CreateMap<SourceModel, DestinationNestedViewModel>()
    .ForMember(dest => dest.NestedList, opt => opt.MapFrom(src => src.SourceList)); 
```

那么你所要做的就是在and`Mapper.Map`之间调用：`Source``Destination`

```
Mapper.Map<SourceModel, DestinationModel>(source); 
```

# javascript - iPad safari mobile：如何使一帧捏合缩放而另一帧保持未缩放

> ID：10660624
> 
> 赞同：2
> 
> 时间：2012-05-18T22:44:18.570
> 
> 标签：javascript, jquery, mobile-safari

我的问题很简单：`<hr/>`当用户平移或缩放页面的主要内容时，我需要一个标题（不是）保持“停靠”在 iPad 移动 safari 浏览器视口的顶部。我搜索了互联网，只发现了一些笨拙的 js 框架。

iScroll 框架声称有这种能力，但是从他们的演示中可以看出，用户体验很差：[http](http://cubiq.org/dropbox/iscroll4/examples/zoom/) ://cubiq.org/dropbox/iscroll4/examples/zoom/ （跳跃，经常一次挂几秒钟， ETC。）

由于本机缩放/平移功能非常好，我认为最好的解决方案是制作一个框架集，其中一个可以使用元标记进行用户缩放，而另一个不可缩放。像这样：

`<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes|no" />`

不幸的是，这没有奏效。我担心这种方式可能无法做到......

有人在苹果论坛上问过同样的问题，当然他们没有回答： [https ://discussions.apple.com/thread/3774841?start=0&tstart=0](https://discussions.apple.com/thread/3774841?start=0&tstart=0)

* * *

我愿意接受有关如何完成此行为的任何建议。

假设框架集方法是不可能的：我不希望包含笨重的 js 框架。（虽然我已经在使用 jQuery 和 jQuery UI）我真的只需要根据视口方向、滚动位置和缩放级别调整 div 的大小和重新定位。

# selenium - Selenium 2 + Selenium Grid2 最简单的设置是什么？

> ID：10660626
> 
> 赞同：1
> 
> 时间：2012-05-18T22:44:29.023
> 
> 标签：selenium, selenium-webdriver, qa, selenium-grid

我已经浏览了一堆文档，但我的脑袋还在游泳。我正在尝试设置 Selenium 2 和 Selenium Grid2。我可以编写测试并在本地运行它们就好了，但这是我需要解决的要求。

1.  能够在本地机器上编写测试并将它们发送到某个地方进行远程测试。
2.  跨多个浏览器并行运行测试（Windows 是唯一要求）。

我可以为遥控器使用额外的机器，我应该如何开始？除了 Selenium 2 和 Selenium grid2 我还需要什么其他元素？我错过了什么应该盯着我的脸吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T00:18:15.567

如果您只想像在本地机器上一样运行测试，但是远程

*   您只需更改代码即可使用 RemoteWebDriver。这将在远程机器上执行测试。

如果你想在 selenium 网格中并行运行多个测试

*   您应该使用可以并行执行多个方法的框架（testNG 和 JUnit 是最流行的）。您可以在 testng 站点 (http://testng.org) 中找到有关 testNG selenium 集成的详细信息

对于上述两种配置，您都必须设置网格环境。既然你说你有两台机器，一台可以充当集线器，另一台可以充当RC。如果它有足够的计算能力，你也可以在同一台机器上启动一个 RC 和集线器。

如果你想在 google chrome 浏览器中运行你的测试，你应该在 RC 机器中有 chromedriver.exe。你应该在 RC 机器中有 chromedriver 路径。

根据我的经验，并行测试执行中最难的部分是找出如何并行触发多个测试。您应该并行触发所有这些测试，并将所有这些测试指向同一个集线器。如果你能做到这一点，硒网格将负责执行部分。[您可以在此处](http://seleniumgrid.wordpress.com/)找到更多详细信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T06:25:55.147

我喜欢将[Grid](http://code.google.com/p/selenium/wiki/Grid2)与 RemoteWebDriver 结合使用。但我使用[Maven/Surefire](http://maven.apache.org/plugins/maven-surefire-plugin/examples/junit.html)并行运行测试。此设置运行良好且流畅。

# unicode - 为什么在 vala 中将 unichar 转换为字符串时会收到编译警告？

> ID：10660627
> 
> 赞同：1
> 
> 时间：2012-05-18T22:44:29.583
> 
> 标签：unicode, utf-8, vala

这是一个演示该问题的简短程序：

```
void main(string[] args)
{
    unichar c = 'a';
    string str_from_to_string = c.to_string(); // Warning
    stdout.printf("Converted by unichar.to_string: \"%s\"\n", str_from_to_string);
} 
```

这也会导致相同的警告：

```
void main(string[] args)
{
    unichar c = 'a';
    string str_from_template = @"$c"; // Warning
    stdout.printf("Converted by string template: \"%s\"\n", str_from_template);
} 
```

这是我得到的警告：

```
/home/mpiroc/Desktop/unicode_to_string/unicode_to_string.vala.c: In function ‘g_unichar_to_string’:
/home/mpiroc/Desktop/unicode_to_string/unicode_to_string.vala.c:26:2: warning: passing argument 2 of ‘g_unichar_to_utf8’ discards ‘const’ qualifier from pointer target type [enabled by default]
/usr/include/glib-2.0/glib/gunicode.h:684:11: note: expected ‘gchar *’ but argument is of type ‘const gchar *’ 
```

这是警告中提到的生成的c代码：

```
 18 static gchar* g_unichar_to_string (gunichar self) {
 19     gchar* result = NULL;
 20     gchar* _tmp0_ = NULL;
 21     gchar* str;
 22     const gchar* _tmp1_;
 23     _tmp0_ = g_new0 (gchar, 7);
 24     str = (gchar*) _tmp0_;
 25     _tmp1_ = str;
 26     g_unichar_to_utf8 (self, _tmp1_);
 27     result = str;
 28     return result;
 29 } 
```

好像`_tmp_`可能不应该被标记`const`，但这是由 生成的`valac`，不是我直接写的。难道我做错了什么？或者这是一个错误`valac`？代码按预期运行，但我尽量避免警告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T00:51:06.340

Vala 编译器不生成临时变量`const`。您可以放心地忽略有关`const`-ness 的警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T06:25:05.753

[添加 --disable-warnings 命令行选项](http://mail.gnome.org/archives/commits-list/2009-September/msg09183.html)

IIRC Vala 编译器也可以使用 --disable-warnigs 命令行选项。

编辑：

[gcc 命令行选项](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html)

抱歉，valac 是转译器，所以一旦 valac --ccode 输出，然后需要运行 gcc 或其他编译器。

```
$ valac --ccode unicode_to_string.vala
$ gcc -o unicode_to_string -w unicode_to_string.c `pkg-config --libs --cflags gobject-2.0` 
```

# c - 如何在 MacRuby 中创建 C 指针？

> ID：10660630
> 
> 赞同：3
> 
> 时间：2012-05-18T22:44:44.057
> 
> 标签：c, macruby, scripting-bridge

我正在使用具有结构的 MacRuby 中的 C 框架

```
int CPhidget_getSerialNumber(CPhidgetHandle phid,int * serialNumber) 
```

[您可以在此处](http://www.phidgets.com/documentation/web/cdoc/group__phidcommon.html#gaa2ef0db106382a29692a0f1341b70fd)查看完整文档（如果您有兴趣）。

在 MacRuby 中，我尝试了以下方法：

```
i = CPhidget_getSerialNumber(@encoder, nil) 
```

上面给我一个号码，但不是序列号。

```
CPhidget_getSerialNumber(@encoder, i) 
```

这给了我一个错误说明：预期的指针实例，得到了“0”（Fixnum）（TypeError）（这并不让我感到惊讶）。

所以我的主要问题是：MacRuby 中是否有一个 C 指针的等价物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T00:47:05.060

MacRuby 有一个 Pointer 类，它可以代表 C 指针。因此，您可以执行以下操作：

```
i = Pointer.new(:int)
CPhidget_getSerialNumber(@encoder, i) 
```

然后，要从指针中提取结果（即取消引用它），您可以使用 Ruby 的数组访问语法：

```
i[0] #=> value from CPhidget_getSerialNumber 
```

# solr - 有没有办法在使用 Solr 同义词时更多地提升原始术语？

> ID：10660632
> 
> 赞同：11
> 
> 时间：2012-05-18T22:44:59.377
> 
> 标签：solr, tokenize, synonym, solr-schema

例如，我在 index_synonyms.txt 中有同义词笔记本电脑、上网本、笔记本

当用户搜索上网本时，我想增加原始文本，然后通过同义词扩展？有没有办法在 SynonymFilterFactory 中指定这个？例如使用原始术语两次，所以他的 TF 会更大

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-19T05:25:03.380

据我所知，现有的 SynonymFilterFactory 无法做到这一点。但是以下是您可以用来获得此行为的技巧。

假设您的字段名为`title`. 创建另一个字段，该字段是此字段的副本，例如`title_synonyms`. 现在确保 SynonymFilterFactory 仅用作分析器`title_synonyms`（您可以通过对两个字段使用不同的字段类型来做到这一点 - 比如说`text`和`text_synonyms`）。在这两个字段中进行搜索，但对`title`比给予更高的提升`title_synonyms`。

以下是示例字段类型定义：

```
 <fieldType name="text" class="solr.TextField">
        <analyzer type="index">
            <tokenizer class="solr.WhitespaceTokenizerFactory"/>
            <filter class="solr.LowerCaseFilterFactory"/>
            <filter class="solr.EnglishPorterFilterFactory" protected="protwords.txt"/>
            <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
        </analyzer>
        <analyzer type="query">
            <tokenizer class="solr.WhitespaceTokenizerFactory"/>
            <filter class="solr.LowerCaseFilterFactory"/>
            <filter class="solr.EnglishPorterFilterFactory" protected="protwords.txt"/>
            <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
        </analyzer>
    </fieldType>

    <fieldType name="text_synonyms" class="solr.TextField">
        <analyzer type="index">
            <tokenizer class="solr.WhitespaceTokenizerFactory"/>
            <filter class="solr.SynonymFilterFactory" synonyms="synonyms_index.txt" ignoreCase="true" expand="true"/>
            <filter class="solr.LowerCaseFilterFactory"/>
            <filter class="solr.EnglishPorterFilterFactory" protected="protwords.txt"/>
            <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
        </analyzer>
        <analyzer type="query">
            <tokenizer class="solr.WhitespaceTokenizerFactory"/>
            <filter class="solr.SynonymFilterFactory" synonyms="synonyms_query.txt" ignoreCase="true" expand="true"/>
            <filter class="solr.LowerCaseFilterFactory"/>
            <filter class="solr.EnglishPorterFilterFactory" protected="protwords.txt"/>
            <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
        </analyzer>
    </fieldType> 
```

以下是示例字段定义：

```
 <field name="title" type="text" stored="false"
           required="true" multiValued="true"/>
    <field name="title_synonyms" type="text_synonyms" stored="false"
           required="true" multiValued="true"/> 
```

将`title`字段复制到`title_synonyms`：

```
<copyField source="title" dest="title_synonyms"/> 
```

如果您正在使用`dismax`，则可以对这些字段进行不同的提升，如下所示：

```
 <str name="qf">title^10 title_synonyms^1</str> 
```

# php - PHP 警告、通知和错误

> ID：10660633
> 
> 赞同：0
> 
> 时间：2012-05-18T22:45:01.250
> 
> 标签：php, oop, class, json

嘿伙计们，我现在正在处理三件事，我正在努力解决，希望你能提供帮助。我的代码中有错误、警告和通知，我想修补它，希望您能帮助我，错误如下。

有奇妙的错误

```
PHP Warning:  Invalid argument supplied for foreach() in php/libraries/RotateLatestAssets.class.php on line 35
PHP Notice:   Undefined variable: config in php/libraries/RotateLatestAssets.class.php on line 18
PHP Notice:   Undefined variable: json in php/libraries/RotateLatestAssets.class.php on line 31
PHP Notice:   Undefined variable: json in php/libraries/RotateLatestAssets.class.php on line 32 
```

然后我在我的代码中注释掉了一个非常奇怪的问题......我在想侏儒，但谁知道......

这是课程

```
<?php

class RotateLatestAssets
{
    protected   $config;

    public function __construct()
    {
        $this->config = $config;
    }

    //********************************************************************************
    //* Public Methods
    //********************************************************************************

    public function getAssets()
    {

        $this->json = self::jsonDecode($this->config, true);

        define('latest',    __DIR__ . $json['paths']['latest']);
        define('dist',      __DIR__ . $json['paths']['dist']);

        foreach($this->json['files'] as $fileName => $fileVersion)
        {
            $cacheName = implode("-$fileVersion.", explode('.',$fileName) );
            if(!file_exists(dist . $cacheName))
            {
                try {
                    copy(latest . $cacheName, dist . $fileName);
                } catch(Exception $e) {
                    echo 'Copy Exception: ',  $e->getMessage(), "\n";
                }
            }
        }

    }

    //********************************************************************************
    //* Static Methods
    //********************************************************************************

    /**
    * Returns a json decoded object or array
    *
    * @param    string  $json
    * @param    bool    $toAssoc
    * @return   object|array Depending on the parameter supplied
    */

    private static function jsonDecode($json, $toAssoc = true)
    {

        /** 
         * Based on known JSON_DECODE() errors
         * 0 = JSON_ERROR_NONE
         * 1 = JSON_ERROR_DEPTH
         * 2 = JSON_ERROR_STATE_MISMATCH
         * 3 = JSON_ERROR_CTRL_CHAR
         * 4 = JSON_ERROR_SYNTAX
         * 5 = JSON_ERROR_UTF8
         */

        $result = json_decode($json, $toAssoc);

        /*  Will produce this sometimes out of the blue after a few refreshes?

            PHP Fatal error:  Uncaught exception 'Exception' with message 
            'JSON Error:  - Syntax error, malformed JSON' in php/libraries/RotateLatestAssets.class.php:99

            Stack trace:
            #0 php/libraries/RotateLatestAssets.class.php(28): RotateLatestAssets::jsonDecode(NULL, true)
            #1 php/libraries/RotateLatestAssets.class.php(119): RotateLatestAssets->getAssets()
            #2 {main}
              thrown in php/libraries/RotateLatestAssets.class.php on line 99
        */

        switch(json_last_error())
        {
            case JSON_ERROR_DEPTH:
                $error =  ' - Maximum stack depth exceeded';
                break;
            case JSON_ERROR_STATE_MISMATCH:
                $error = ' - Invalid or malformed JSON encoding';
                break;
            case JSON_ERROR_CTRL_CHAR:
                $error = ' - Unexpected control character found';
                break;
            case JSON_ERROR_SYNTAX:
                $error = ' - Syntax error, malformed JSON';
                break;
            case JSON_ERROR_UTF8:
                $error = ' - Syntax error, malformed UTF-8 characters';
                break;
            case JSON_ERROR_NONE:
            default:
                $error = ''; 
        }

        if (!empty($error)) throw new Exception('JSON Error: '.$error);
        return $result; 
    }

    /**
    * Returns bool value for state of array recieved dev:(true) live:(false)
    *
    * @param    array   $array
    * @return   bool
    */

    private static function checkMode($array)
    {
        if(!is_array($array)) throw new Exception("Wrong Type Passed. Expecting (array), received (".gettype($array).")");
        return ($array['dev'] == 'true') ? true : false;
    }
}

$instance = new RotateLatestAssets($_SERVER['DOCUMENT_ROOT'].'build/config.json');
$instance->getAssets();

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T22:47:40.297

在您的构造函数中，您有：

```
$this->config = $config; 
```

然而，该`$config`变量从未被创建，因此它没有任何价值。

你在`getAssets()`. 您使用`$json`，但它从未被定义。

无效参数错误是因为您本质上做`foreach(null`的是错误的，您只能迭代一个数组。

# java - 在java中将内容从一个excel工作簿复制到另一个

> ID：10660635
> 
> 赞同：1
> 
> 时间：2012-05-18T22:45:17.347
> 
> 标签：java, excel, apache-poi

我想将一个 excel 工作簿的内容复制到另一个 excel 工作簿。POI API 没有相应的方法。有什么方法可以做同样的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T19:48:07.523

有没有一种具体的方法？不是我知道的

但是，您是否想将该工作簿的信息添加到已经存在的工作簿中？还是您只想要@Luiggi 建议的该工作簿的副本？

要将工作簿的内容复制到已经存在的工作簿中，我将遍历工作簿，遍历工作表，然后循环循环以将单元格值放入地图或列表中（取决于您拥有什么以及您拥有什么）重新获取），然后遍历该映射或列表并将这些单元格写入现有工作簿。

# php - MySQL PHP id 从表到另一个

> ID：10660639
> 
> 赞同：1
> 
> 时间：2012-05-18T22:45:33.213
> 
> 标签：php, mysql

我已经构建了一个从复选框获取信息的数组。这工作正常，但是我需要第二个输入，其中第二个表的 id 放置在数组数据旁边。例如，当用户向我的 php 表单输入数据时，它会在一个表上生成一个 id，而我的复选框则保存到第二个。我希望当用户选择复选框时，将 id 放在此处。我遇到的问题是我不知道将这些数据放在哪里。

```
$insertSQL2 = "INSERT INTO Project_course (Proj_id Cour_id) SELECT Course_id FROM courses WHERE 
Code IN (";
foreach ($_POST['CheckboxGroup1'] as $Q){
$Q = mysql_real_escape_string($Q);
$insertSQL2.= "'$Q', ";
 } 
 $insertSQL2 = rtrim($insertSQL2, ", ");
$insertSQL2 .= ")"; 
```

Proj_id 是 id 需要去的地方，而 Cour_id 是保存复选框的地方。除此之外，它需要同时发生，因为 mysql 表中的关系意味着一列不能为空。

我知道这很啰嗦，所以任何帮助都将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T23:35:26.013

如果我正确理解您的问题，表格首先保存项目数据，然后 - 一些与该项目相关的课程数据。

顺便说一句 - 我建议的第一件事是让纯 mysql_* 函数支持 PDO。但这是题外话。

无论如何 - 首先你可能会运行类似的东西

```
$sql = "INSERT INTO project (col1, col2) VALUES (blah1, blah2)";
mysql_query($sql) 
```

然后你可以简单地通过调用来检查新的项目 ID

```
$projectID =  mysql_insert_id(); 
```

然后像

```
foreach ($_POST['CheckboxGroup1'] as $key => $val)
{
    $_POST['CheckboxGroup1'][$key] =  mysql_real_escape_string($val);
}
$sql = "INSERT INTO project_course(project_id, course_id) SELECT ".$projectID.", course_id FROM courses WHERE code IN (".implode(", ", $_POST['CheckboxGroup1']).")"; 
```

更新 - 如果您的项目表中已经有一个项目，您可以通过多种方式获取项目 ID。例如通过使用`SELECT project_id FROM project ORDER BY project_id DESC LIMIT 1`.

# javascript - 通过ajax函数调用验证

> ID：10660643
> 
> 赞同：0
> 
> 时间：2012-05-18T22:45:48.003
> 
> 标签：javascript, ajax, forms, validation

我有两个我想一起工作的 javascript。我有一个通过 ajax 提交的表单和一个表单验证脚本，如果验证失败，我想一起工作以防止 ajax 表单提交。

这是ajax表单提交脚本：

```
<script type="text/javascript">
$(document).ready(function(){$(".sendName").click(function(){
var jsuser=$("#jsuser").val();
var jemail=$("#jemail").val();
var jusid=$("#jusid").val();
$.post("recomend.php",{jsuser:jsuser,jusid:jusid,jemail:jemail},function(data){$("#loadName")
.html(data)
.effect('bounce', { times: 5, distance: 30 }, 300);
  });
 });
});
$('#start').click(function() {
  $('#effect').toggle('fast', function() {
   });
});
</script> 
```

此代码完美运行，并提交了表单。

我也有部分工作的验证代码。如果输入的信息不正确，错误消息会显示在字段旁边，但仍可以提交表单。

在普通表单上，验证码是这样调用的：

```
<form method="post" action="formprocess.php" name="form1" id="form1" onsubmit="return validate(this)"> 
```

所以，我需要知道如何做相当于：

```
onsubmit="return validate(this)" 
```

在ajax提交代码中，如果有错误不提交表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:50:51.730

```
$(".sendName").click(function(){
  if (!validate(this.form)) return;
  // rest of your function, including AJAX call
}); 
```

*该`.form`属性适用于所有表单元素（HTMLSelectElement、HTMLOptionElement、HTMLInputElement、HTMLTextAreaElement、HTMLButtonElement、HTMLLabelElement、HTMLFieldSetElement、HTMLLegendElement、HTMLObjectElement 和 HTMLIsIndexElement）。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:51:38.427

你为什么不做以下事情？

```
<script type="text/javascript">

$(document).ready(function(){$(".sendName").click(function(){

var jsuser=$("#jsuser").val();
var jemail=$("#jemail").val();
var jusid=$("#jusid").val();
if(validate(jsuser, jemail, jusid)){
$.post("recomend.php",{jsuser:jsuser,jusid:jusid,jemail:jemail},function(data){$("#loadName")
.html(data)
.effect('bounce', { times: 5, distance: 30 }, 300);
  });
 });
});
$('#start').click(function() {
  $('#effect').toggle('fast', function() {
   });
});
}
</script> 
```

`validate`你的验证在哪里

# ruby-on-rails - 用于 nil 的 Rails 范围测试

> ID：10660646
> 
> 赞同：7
> 
> 时间：2012-05-18T22:46:18.393
> 
> 标签：ruby-on-rails

我有一张费用表。它有一列 invoice_id。

我想要 2 个范围 - 一个用于计费费用，一个用于不计费。我想我可以测试一下 invoice_id 是否为零。

```
scope :notbilled, where(:invoice_id == nil)
scope :billed, where(:invoice_id != nil) 
```

但是，这是行不通的。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-18T22:49:14.263

对于第一个，您需要使用哈希语法：

```
scope :notbilled, where(:invoice_id => nil) 
```

第二个要求您使用原始 sql：

```
scope :billed, where('invoice_id is not null') 
```

您也可以跳到第二个 arel 来避免编写原始 sql，但这是一个高级主题，最终会比原始 sql 可读性差。

使用直接相等是行不通的，因为这些表达式会立即计算，并且由于不涉及变量而被转换为布尔等价物，因此它们将被解释为

```
scope :notbilled, where(false)
scope :billed, where(true) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-13T05:17:24.770

**从 Rails 4 开始更新答案：**

```
scope :notbilled, where(invoice_id: nil)
scope :billed, where.not(invoice_id: nil) 
```

这是 ActiveRecord 4 中添加的新功能。

文档：[http](http://edgeguides.rubyonrails.org/active_record_querying.html) ://edgeguides.rubyonrails.org/active_record_querying.html （搜索“NOT Conditions”，当前为第 2.4 节）

# search - 客户端的 JqGrid 搜索

> ID：10660657
> 
> 赞同：0
> 
> 时间：2012-05-18T22:48:06.230
> 
> 标签：search, jqgrid

有没有办法在服务器响应json数据后在客户端进行搜索？仅具有 html/jscript 和类型为 local 的数组的 jqGrid 搜索示例在客户端执行数据搜索，但是当在服务器中部署了相同的 jqgrid 时，使用 json 返回服务器的 jqgrid 提示/请求。我想更深入地了解这种行为！

最好不管！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T23:08:45.270

如果我正确理解您的要求，您只需添加`loadonce: true`到 jqGrid 参数列表中。在第一次用服务器数据填充网格之后，它将跟随`datatype`从`'json'`或`'xml'`到更改。`'local'`因此，您可以调用[filterToolbar](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3atoolbar_searching#calling_convention)使用工具栏搜索使用[navGrid](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3anavigator)添加用于[高级搜索](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aadvanced_searching)的按钮。任何类型的搜索都将在*本地*实施。

# linux - Shell-Script：Cronjob 与用户权限

> ID：10660658
> 
> 赞同：0
> 
> 时间：2012-05-18T22:48:09.740
> 
> 标签：linux, cron, cygwin, crontab

可能是一个简单的问题，但我很困惑：

当我手动运行以下脚本时，它工作正常。虽然我没有以用户 git 的身份运行此脚本，但作为用户 XI 能够使用应用于 git 用户主目录的 ls 和 du 命令。如果我尝试在 cronjob 中运行这个脚本，这两个命令不会被定期调用，不知道为什么。cmd 文件的第一次“extern”调用在这两种情况下都能完美运行，并产生常规输出。

我注意到的是：我只能以用户 X 的身份使用 ./runbackup.sh 运行脚本，并且它存储在用户主目录中。

Cron 以用户 X 的权限运行。

令人困惑...：/ ...有什么想法吗？

脚本：**runbackup.sh：**

```
#!/bin/bash

/cygdrive/e/xp-batches/backup.cmd > info.log
echo "### CURRENT HOMEDIR ###" >> info.log
ls -gh --block-size=K /home/git >> info.log
echo "### SIZE ###" >> info.log
du -hs /home/git >> info.log
email -s "Backup Status" dum@dio.com < info.log 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:52:34.977

最好不要对 cron 为您提供的环境做任何假设。使用完整路径：

/bin/ls -gh --block-size=K /home/git >> info.log

而不仅仅是“ls”。

哦，也许也可以使用绝对路径而不是 info.log。

# iphone - 回收单元格时的 UITableView 单元格布局

> ID：10660663
> 
> 赞同：0
> 
> 时间：2012-05-18T22:49:13.153
> 
> 标签：iphone, objective-c, ios, ipad, uitableview

所以我实现了一个具有各种不同高度的单元格。问题是，有时当单元格加载时，它的高度不正确，我必须基本上向下滚动直到单元格不可见，然后再次向上滚动，所以它会重新布局并具有正确的高度. 我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:59:30.647

首先给出一些代码会有所帮助。

1）如果你只有几个设定的高度。比如 3 个不同的 cell 高度，那么你可以创建 3 个不同的 cell 标识符，这样重复使用的 cell 是错误的高度。

2) 如果您的单元格是动态高度，请确保在重用单元格时正确设置其属性。例如，如果您使用 in cell == nil 设置 height 属性。您只是在创建新单元格时设置它。

```
if(cell == nil)
{
    // Create new cell
}

// Set cell height. 
```

你也试过使用

```
– tableView:heightForRowAtIndexPath: 
```

# pyqt - pyqt 将颜色设置为 QMenuBar

> ID：10660667
> 
> 赞同：0
> 
> 时间：2012-05-18T22:49:22.353
> 
> 标签：pyqt

我正在尝试将颜色更改为我的菜单栏，但它似乎不起作用。不知道我做错了什么。

```
self.menuBar = QtGui.QMenuBar()
self.menuBar.setStyleSheet("color: rgb(255, 255, 255);") 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:45:43.263

如果您在 OSX 上，这将无效，因为它使用系统菜单。

对于其他平台，您可能需要在项目子控件上设置它：

```
self.menuBar.setStyleSheet("QMenuBar::item { color: rgb(255, 255, 255); }") 
```

# c# - 如何索引 RavenDB 中的嵌套日期

> ID：10660670
> 
> 赞同：3
> 
> 时间：2012-05-18T22:50:07.023
> 
> 标签：c#, ravendb

我可能在这里完全看错了树，但是......我有一个 RavenDB，其中存储了很多 RavenPerson 类型的对象。

每个 RavenPerson 都有一个邮件机构列表，每个邮件机构都有一个关联的日期。

```
{
  "Bodies": [
    {
      "RenewalRunDate": "2011-11-30T00:00:00.0000000+00:00",
      "BodyText": "A bunch of text"
    }
  ]
} 
```

我想取一个给定的日期并获取此人的 ID 和相关正文的列表。

所以...

```
 public class MailingsByDate : AbstractIndexCreationTask<RavenPerson, PersonMailingModel>
    {
        public MailingsByDate()
        {
            Map = people =>
                  people.SelectMany(person => person.Bodies,
                                    (person, body) =>
                                    new PersonMailingModel
                                        {
                                            MembershipNumber = person.MembershipNumber,
                                            MailingBody = body.BodyText,
                                            MailingDate = body.RenewalRunDate
                                        });
        }
    } 
```

但是当我打电话给这个时

```
 var mailings = DocumentSession.Query<PersonMailingModel, MvcApplication.MailingsByDate>()
                                      .Where(pmm => pmm.MailingDate == date.Value); 
```

我得到一个例外

> 无法将“IntegraRenewalMailLibrary.RavenPerson”类型的对象转换为“RenewalLogs.Models.PersonMailingModel”类型。

提前致谢！

* * *

更新：如下更改对索引的调用并不能解决异常

```
 var mailings = DocumentSession.Query<PersonMailingModel, MvcApplication.MailingsByDate>()
                                      .Where(pmm => pmm.MailingDate == date.Value)
                                      .As<PersonMailingModel>()
                                      .ToList(); 
```

* * *

更新到更新：我在这里创建了一个带有示例测试用例的视觉工作室解决方案：[https ://github.com/pauldambra/IndexExploration](https://github.com/pauldambra/IndexExploration)

使用版本 1.0.888

我绝对没有完全了解索引中发生的事情，所以我猜这是我要么没有做对，要么试图做错事......

* * *

Ayende 向我指出了 twitter 上的解决方案，即使用 SelectMany 调用索引并将其替换为使用 linq 查询表单的调用

```
 public class RecipientsByDate : AbstractIndexCreationTask<Person, PersonMailing>
    {
        public RecipientsByDate()
        {
            Map = people => from person in people
                            from body in person.Bodies
                            select new PersonMailing
                                       {
                                           MembershipNumber = person.MembershipNumber,
                                           MailingBody = body.BodyText,
                                           MailingDate = body.MailingDate
                                       };

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T02:04:43.583

在此调用结束时调用 As()

# android - 为什么 SurfaceView 在 Android 中不显示 3gp 视频

> ID：10660673
> 
> 赞同：2
> 
> 时间：2012-05-18T22:50:32.400
> 
> 标签：android, video, media, surfaceview

我正在使用以下示例代码播放 3gp 视频。在 android 2.3 上 .. 但只有音频正在播放，但视频没有出现。问题是什么 ？

```
package pit.opensource.video;

import android.app.Activity;
import android.content.Context;
import android.graphics.PixelFormat;
import android.media.AudioManager;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.widget.Button;
import android.widget.SeekBar;

public class L2VideoExampleActivity extends Activity implements SurfaceHolder.Callback{

    MediaPlayer mediaPlayer;
    SurfaceView surfaceView;
    SurfaceHolder surfaceHolder;
    boolean pausing = false;

    AudioManager audioManager;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        audioManager = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
        int maxVolume = audioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
        int curVolume = audioManager.getStreamVolume(AudioManager.STREAM_MUSIC);
        SeekBar volControl = (SeekBar)findViewById(R.id.volbar);
        volControl.setMax(maxVolume);
        volControl.setProgress(curVolume);
        volControl.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener() {

            @Override
            public void onStopTrackingTouch(SeekBar arg0) {
                // TODO Auto-generated method stub

            }

            @Override
            public void onStartTrackingTouch(SeekBar arg0) {
                // TODO Auto-generated method stub

            }

            @Override
            public void onProgressChanged(SeekBar arg0, int arg1, boolean arg2) {
                // TODO Auto-generated method stub
                audioManager.setStreamVolume(AudioManager.STREAM_MUSIC, arg1, 0);
            }
        });

        Button buttonPlayVideo = (Button)findViewById(R.id.playvideoplayer);
        Button buttonPauseVideo = (Button)findViewById(R.id.pausevideoplayer);

        getWindow().setFormat(PixelFormat.UNKNOWN);
        surfaceView = (SurfaceView)findViewById(R.id.surfaceview);
        surfaceHolder = surfaceView.getHolder();
        surfaceHolder.addCallback(this);
        surfaceHolder.setFixedSize(176, 144);
        surfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
        mediaPlayer = new MediaPlayer();

        buttonPlayVideo.setOnClickListener(new Button.OnClickListener(){

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                pausing = false;

                if(mediaPlayer.isPlaying()){
                    mediaPlayer.reset();
                }

                mediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
                mediaPlayer.setDisplay(surfaceHolder);

                try {
                //  mediaPlayer.setDataSource(stringPath);
                //  mediaPlayer.prepare();
                    mediaPlayer = MediaPlayer.create(getApplicationContext(), R.raw.samplevideo);

                } catch (IllegalArgumentException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IllegalStateException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                mediaPlayer.start();

            }});

        buttonPauseVideo.setOnClickListener(new Button.OnClickListener(){

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                if(pausing){
                    pausing = false;
                    mediaPlayer.start();
                }
                else{
                    pausing = true;
                    mediaPlayer.pause();
                }
            }});

    }

    @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int width,
            int height) {
        // TODO Auto-generated method stub

    }

    @Override
    public void surfaceCreated(SurfaceHolder holder) {
        // TODO Auto-generated method stub

    }

    @Override
    public void surfaceDestroyed(SurfaceHolder holder) {
        // TODO Auto-generated method stub

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-18T08:22:06.630

我认为您必须在surfaceview 中播放视频。您现在在oncreate 中播放视频，并且可能尚未创建surfaceview。使用这样的东西`surfaceCreated`

```
 @Override
    public void surfaceCreated(SurfaceHolder holder) 
    {

             if(ArrayManager.array_for_playing != null)
        if(SDcard.icurrentIndex != -1)
          playVideo(SDcard.icurrentIndex);
    } 
```

这是 playVideo 方法

```
 private void playVideo(Integer Media) 
    {

        try {

            mPlayer.reset();
            mPlayer.setDataSource(ArrayManager.array_for_playing.get(SDcard.icurrentIndex).getPath());

          mPlayer.setDisplay(holder);                
            songProgressBar.setProgress(0);
            songProgressBar.setMax(100);
            mPlayer.prepare();
            mPlayer.start();
            btnPlay.setBackgroundResource(R.drawable.img_btn_pause);

            // Updating progress bar
            updateProgressBar();

        } 
        catch (Exception e) 
        {
            Log.e("video player", "error: " + e.getMessage(), e);
        }
    } 
```

并在 IniatializeUi 方法中

```
 private void InitializeUI()
     {
            mPreview = (SurfaceView) findViewById(R.id.surface_view);
            holder = mPreview.getHolder();
            holder.addCallback(this);
            holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
      } 
```

并在活动的顶部：

```
 private SurfaceView mPreview;
    private SurfaceHolder holder; 
```

我希望这对用户有所帮助。

# haskell - 数据值依赖、更新和记忆

> ID：10660677
> 
> 赞同：1
> 
> 时间：2012-05-18T22:50:45.113
> 
> 标签：haskell

很抱歉这个问题描述太抽象了：它是为了我的工作，出于商业机密的原因，我不能给出现实世界的问题，只是一个抽象。

我有一个接收包含键值对的消息的应用程序。键来自一组定义的关键字，每个关键字都有一个固定的数据类型。因此，如果“Foo”是整数，“Bar”是日期，您可能会收到如下消息：

```
Foo: 234
Bar: 24 September 2011 
```

消息中可能包含任何键子集。键的数量相当大（几十个）。但现在让我们坚持使用 Foo 和 Bar。

显然有这样的记录对应的消息：

```
data MyRecord {
   foo :: Maybe Integer
   bar :: Maybe UTCTime
   -- ... and so on for several dozen fields.
} 
```

该记录使用“可能”类型，因为该字段可能尚未收到。

我还有许多需要从当前值（如果存在）计算的派生值。例如我想拥有

```
baz :: MyRecord -> Maybe String
baz r = do -- Maybe monad
   f <- foo r
   b <- bar r
   return $ show f ++ " " ++ show b 
```

其中一些功能很慢，所以我不想不必要地重复它们。我可以为每条新消息重新计算 baz 并以原始结构记录它，但如果一条消息保持 foo 和 bar 字段不变，那么这就是浪费 CPU 时间。相反，我可以在每次需要时重新计算 baz ，但是如果自上次以来基础参数没有改变，那又会浪费 CPU 时间。

我想要的是某种智能记忆或基于推送的重新计算，仅在参数发生变化时重新计算 baz。我可以通过注意到 baz 仅依赖于 foo 和 bar 来手动检测到这一点，因此仅根据更改这些值的消息重新计算它，但对于容易出错的复杂函数。

另一个问题是，其中一些函数可能有多种策略。例如，您可能有一个可以使用“mplus”从 Foo 或 Bar 计算的值。

有谁知道现有的解决方案？如果没有，我应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T23:35:40.973

我假设您有一个“状态”记录，并且这些消息都涉及更新它以及设置它。所以如果`Foo`是`12`，以后可能是`23`，因此 的输出`baz`会改变。如果不是这种情况，那么答案将变得非常微不足道。

让我们从 baz 的“核心”开始——一个不在记录上的函数，而是你想要的值。

```
baz :: Int -> Int -> String 
```

现在让我们转换它：

```
data Cached a b = Cached (Maybe (a,b)) (a -> b)
getCached :: Eq a => Cached a b -> a -> (b,Cached a b)
getCached c@(Cached (Just (arg,res)) f) x | x == arg = (res,c)
getCached (Cached _ f) x = let ans = f x in (ans,Cached (Just (x,ans) f)

bazC :: Cached (Int,Int) String
bazC = Cached Nothing (uncurry baz) 
```

现在，每当您使用普通函数时，您都可以使用缓存转换函数，将生成的缓存转换函数替换回您的记录中。这本质上是一个大小为 1 的手动备忘录。

对于您描述的基本情况，这应该没问题。

一个涉及动态依赖关系图的更高级、更通用的解决方案被称为“增量计算”，但我看到的研究论文比严肃的生产实现还要多。您可以先看看这些，然后按照参考路径前进：

1.  [http://www.carlssonia.org/ogi/Adaptive/](http://www.carlssonia.org/ogi/Adaptive/)
2.  [http://www.andres-loeh.de/Incrementalization/paper_final.pdf](http://www.andres-loeh.de/Incrementalization/paper_final.pdf)

增量计算实际上也与函数式反应式编程非常相关，所以你可以看看 conal 的论文，或者玩一下 Heinrich Apfelmus 的反应式香蕉库：[http ://www.haskell.org/haskellwiki/Reactive-banana](http://www.haskell.org/haskellwiki/Reactive-banana)

在命令式语言中，看看 python 中的格子：http: [//pypi.python.org/pypi/Trellis](http://pypi.python.org/pypi/Trellis)或 lisp 中的单元格：http: [//common-lisp.net/project/cells/](http://common-lisp.net/project/cells/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T00:02:45.470

> 我想要的是某种智能记忆或基于推送的重新计算，仅在参数发生变化时重新计算 baz。

在我看来，您想要一个不可变的变量，但允许从“尚未计算”到“已计算”的一次性突变。好吧，你很幸运：这正是惰性评估给你的！因此，我提出的解决方案非常简单：只需为您要计算的每项内容添加字段即可。这是一个这样的例子，我们正在做的 CPU 密集型任务正在破坏一些加密方案：

```
data Foo = Foo
    { ciphertext :: String
    , plaintext :: String
    }

-- a smart constructor for Foo's
foo c = Foo { ciphertext = c, plaintext = crack c } 
```

这里的重点是要求`foo`有这样的费用：

1.  如果你从不要求`plaintext`结果，它很便宜。
2.  在第一次调用 时`plaintext`，CPU 搅动了很长时间。
3.  在随后调用 时`plaintext`，将立即返回先前计算的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T23:22:04.440

您可以构建一个与您需要执行的计算相对应的有状态图。当新值出现时，您将它们推送到图表中并重新计算，更新图表直到达到输出。（或者您可以将值存储在输入中并按需重新计算。）这是一个非常有状态的解决方案，但它确实有效。

您是否正在根据实时输入的利率等创建市场数据，例如收益率曲线？

# wordpress - Wordpress - 我如何显示子页面，但不显示这些子页面的父页面？

> ID：10660679
> 
> 赞同：0
> 
> 时间：2012-05-18T22:50:53.633
> 
> 标签：wordpress

我正在使用最新版本的 Wordpress 3.3.2。我有几个页面设置，它们有几个子页面。父页面充当网站的类别或主要部分。

这是我的基本结构：

```
Parent_Page
 - Subpage_1
   -- Child_of_1
   -- Child_of_1
   -- Child_of_1
 - Subpage_2
   -- Child of_2 
```

等等......所以我想做的只是“子”页面而不是子页面或父页面。

这将为我提供所有主要部分中所有页面的列表。

目前我正在使用 get_pages，但它似乎有点错误。当我排除几个页面时，它开始带走子页面以及父页面。

```
 $storeparent = 18;
 $shopargs = array(
'depth'        => -1,
'child_of' => $storeparent,
'title_li'     => __(''),
'sort_column'  => 'menu_order',
'post_status'  => 'publish',
'link_before'  => '',
'link_after'   => '',
'echo' => 1,
'exclude' => '149,151'
 ); 
```

在我排除页面的地方，我可以添加一些并且它可以工作，但是一旦我点击某个页面 ID，它也会开始删除子页面。有点令人困惑，因为我没有告诉它删除子页面。

我现在排除的页面是与“Parent_Page”处于同一级别的页面。

我是否必须按数字顺序订购要排除的页面？

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T03:14:12.777

尝试将深度更改为 2。

[http://codex.wordpress.org/Function_Reference/wp_list_pages](http://codex.wordpress.org/Function_Reference/wp_list_pages)

# c# - VS2010 性能分析：如何识别工作线程？（CurrentThread.Name 产生异常）

> ID：10660680
> 
> 赞同：2
> 
> 时间：2012-05-18T22:50:58.770
> 
> 标签：c#, multithreading, visual-studio-2010, visual-studio-debugging, performance-testing

如何识别负责跨核心上下文切换的线程，以及保持同步的线程？

（PS：我是 Visual Studio 的这一部分的新手……边学习边学习，感谢提示！）

![在此处输入图像描述](../Images/a55f0b34e32d7b89a4677225bea7e702.png)

花费最多时间同步的线程的各种堆栈跟踪，我不知道为什么：

**线程 12384**

```
 Category = Synchronization Delay = 650947.5375 ms
 ntoskrnl.exe!SwapContext_PatchXRstor ntoskrnl.exe!KiSwapContext
 ntoskrnl.exe!KiCommitThreadWait ntoskrnl.exe!KeWaitForSingleObject
 ntoskrnl.exe!NtWaitForSingleObject ntoskrnl.exe!KiSystemServiceCopyEnd 
```

**线程 8792**

```
 Category = Synchronization API = WaitForMultipleObjects
 Delay = 8993.9801 ms Unblocked by thread 3052; click 'Unblocking
 Stack' for details. kernel32.dll!_WaitForMultipleObjects@16
 clr.dll!WKS::WaitForFinalizerEvent
 clr.dll!WKS::GCHeap::FinalizerThreadWorker
 clr.dll!Thread::DoExtraWorkForFinalizer
 clr.dll!Thread::ShouldChangeAbortToUnload
 clr.dll!Thread::ShouldChangeAbortToUnload
 clr.dll!ManagedThreadBase_NoADTransition
 clr.dll!ManagedThreadBase::FinalizerBase
 clr.dll!WKS::GCHeap::FinalizerThreadStart
 clr.dll!Thread::intermediateThreadProc
 kernel32.dll!@BaseThreadInitThunk@12 ntdll.dll!___RtlUserThreadStart@8
 ntdll.dll!__RtlUserThreadStart@8

 The Unblocking stack for the above is

 Thread 8792 was unblocked by thread 3052 The unblocking call stack
 follows: ntoskrnl.exe! ?? ?? ::FNODOBFM::`string'
 ntoskrnl.exe!NtSetEvent ntoskrnl.exe!KiSystemServiceCopyEnd
 wow64cpu.dll!CpupSyscallStub wow64cpu.dll!Thunk0Arg
 wow64.dll!RunCpuSimulation wow64.dll!Wow64LdrpInitialize ntdll.dll! ??
 ?? ::FNODOBFM::`string' ntdll.dll!LdrInitializeThunk
 ntdll.dll!_ZwSetEvent@8 kernelbase.dll!_SetEvent@4
 clr.dll!CLREvent::Set clr.dll!WKS::gc_heap::try_allocate_more_space
 clr.dll!WKS::gc_heap::allocate_more_space clr.dll!WKS::GCHeap::Alloc
 clr.dll!Alloc clr.dll!FastAllocatePrimitiveArray clr.dll!JIT_NewArr1
 mscorlib.ni.dll![mscorlib.dll] mscorlib.ni.dll![mscorlib.dll]
 mscorlib.ni.dll![mscorlib.dll] mscorlib.ni.dll![mscorlib.dll]
 !0x206b89 system.core.ni.dll![<Unknown>]
 system.core.ni.dll![<Unknown>] system.core.ni.dll![<Unknown>] 
```

![在此处输入图像描述](../Images/5d25f43a9468d8cb70f0f08da913dc62.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T17:13:52.780

没有完全回答您的确切问题，但我发现解决这些问题的最快方法是获取进程转储然后打开 windbg。

确定哪些线程正在阻塞的快速命令是 !syncblk，因此类似下面的内容应该有助于识别正在阻塞的方法调用

> .load C:\Windows\Microsoft.NET\Framework64\v2.0.50727\sos
> 
> 。链
> 
> !syncblk

# bash - 启动服务器后未返回 Cygwin bash 提示

> ID：10660682
> 
> 赞同：0
> 
> 时间：2012-05-18T22:51:09.097
> 
> 标签：bash, cygwin

当我使用 ant 命令启动服务器时，不会返回 bash 提示符。仅当我按 Ctrl+Z 或从另一个 cygwin shell 停止服务器时，提示才可用。我正在使用 cygwin 1.7.13-1

cygwin.batch 设置了以下环境变量

```
bash --login -i
set SHELLOPTS=igncr
set CYGWIN=nodoswarning 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T01:31:01.577

请参阅[与 Cygwin 相关的文档](http://ant.apache.org/manual/running.html#cygwin)以及下面关于[将 Ant 作为后台进程运行](http://ant.apache.org/manual/running.html#background)的部分。

大概是这样的：

```
ant </dev/null & 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T03:26:45.370

安装 1.7.15-1 版本修复了问题

# javascript - 三.js WebGLRenderer()

> ID：10660688
> 
> 赞同：0
> 
> 时间：2012-05-18T22:51:42.680
> 
> 标签：javascript, three.js

嗨，我正在将一个画布 DOMelement 传递给我对 WebGLRenderer() 的调用，如下所示：

```
var jqc = $('#myCanvas'); //get canvas with jQuery;
var par = {canvas:jqc.get()}; //create parameter object with canvas DOMElement in it
var renderer = new THREE.WebGLRenderer(par); //create new WebGLRenderer using myCanvas
//program fails in constructor 
```

有什么我想念的吗？

我已经尝试了上述方法，但没有为构造函数提供任何参数，并且代码工作正常，只是在使用 par 对象尝试让它使用我已经在页面上拥有的画布时，它会中断。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:01:03.177

[`.get`](http://api.jquery.com/get/)返回一个数组，即使它只包含一个元素。尝试：

```
var par = { canvas: jqc.get(0) }; 
```

# javascript - 将动态创建的表单元素添加到 jquery.validate？

> ID：10660691
> 
> 赞同：2
> 
> 时间：2012-05-18T22:52:32.263
> 
> 标签：javascript, jquery, jquery-plugins

我的问题似乎与[动态元素的 javascript 验证](https://stackoverflow.com/questions/2184769/javascript-validation-for-dynamic-element)相同，但是那里提供的答案似乎对我不起作用。我正在使用 query.validate 插件，它适用于我的大部分表单。但是，我有一个按钮可以向包含多个输入元素的表中添加一行。我用来添加表单输入元素的代码如下：

```
var table=document.getElementById('flightlegs');
var rowCount=table.rows.length-1;
var row=table.insertRow(rowCount);
...
var cell4=row.insertCell(3);
var element4=document.createElement("input");
element4.type="text";
element4.size="3";
element4.setAttribute("required", "required");
element4.maxlength="3";
element4.name="legto";
element4.id="legto"+rowCount;
cell4.appendChild(element4);
$('#legto'+rowCount).rules('add', {required:true});
...(more of the same for other cells)... 
```

好的，所以这可能不是最好的方法（我是 javascript 新手），但它确实根据需要添加了输入字段。但是，当点击提交时，这些新字段不包含在验证中。我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T15:30:37.760

jquery.validate “只选择**每个名称的第一个元素，**并且只选择那些指定了规则的元素”（查看插件的源代码，该函数`elements`在第 450 行周围定义）。

在您的情况下，每个新添加的表单元素都有 name `legto`，这将导致 jquery.validate 仅选择具有该名称的**第一个**表单元素并丢弃其余的表单验证。

这是解决此问题的方法

```
element4.name="legto"+rowCount; 
```

# java - 在 View 类中保存 sharedPreferences

> ID：10660692
> 
> 赞同：1
> 
> 时间：2012-05-18T22:52:34.207
> 
> 标签：java, android, view, save, sharedpreferences

我需要保存一些信息，我过去使用的是共享首选项...

```
SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
SharedPreferences.Editor editor = settings.edit();
editor.putString("Data", (Data));
editor.commit(); 
```

所以我会做这样的事情来保存数据，但是对于这个项目，我正在使用类的`public class Tab3 extends View implements OnTouchListener`类型，我不确定这是否是为什么这不起作用但它不是我不能使用共享首选项 onTouch 我`getSharedPreferences`说“方法 getSharedPreferences(String, int) 未定义 Tab3 类型“我需要做什么才能以某种方式保存这些数据，以便稍后在我的应用程序中使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T23:02:46.293

您需要一个上下文来访问共享首选项。最好的方法是创建`MyApplication`为`Application`类的后代，在那里实例化 `preferences`并在应用程序的其余部分中使用它们`MyApplication.preferences`：

```
public class MyApplication extends Application {
    public static SharedPreferences preferences;

    @Override
    public void onCreate() {
        super.onCreate();

        preferences = getSharedPreferences( getPackageName() + "_preferences", MODE_PRIVATE); 
```

例如，如果您需要在其他地方访问您的首选项，您可以调用它来读取首选项：

```
String str = MyApplication.preferences.getString( KEY, DEFAULT ); 
```

或者您可以调用它来将某些内容保存到首选项中：

```
MyApplication.preferences.edit().putString( KEY, VALUE ).commit(); 
```

`commit()`（添加或更改首选项后不要忘记调用！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T23:08:25.163

我会按照列尼克所说的去做，但不要让它们成为静态的，而是懒惰地初始化它们。

```
public class MyApplication extends Application {
    public SharedPreferences preferences;

    public SharedPreferences getSharedPrefs(){
         if(preferences == null){
              preferences = getSharedPreferences( getPackageName() + "_preferences", MODE_PRIVATE);
         }
         return preferences;
    } 
```

那么在你看来：

```
 MyApplication app = (MyApplication) getContext().getApplicationContext();
 SharedPreferences settings = app.getSharedPrefs(); 
```

正如 eric 所说，这个 Application 类需要在你的清单中声明：

```
<application android:name=".MyApplication" 
       android:icon="@drawable/icon" 
       android:label="@string/app_name"> 
```

参考：

[获取应用程序上下文（）](http://developer.android.com/reference/android/content/Context.html#getApplicationContext%28%29)

[Android 全局变量](https://stackoverflow.com/a/3338739/413127)

* * *

*编辑*

（根据您的评论）问题是您实际上并没有保存任何数据，这一行没有意义，您实际上并没有保存变量：

```
 editor.putString("Data", (Data)); 
```

以下是上述使用的示例：

```
MyApplication app = (MyApplication) getContext().getApplicationContext();
SharedPreferences settings = app.getSharedPrefs();
String str = settings.getString("YourKey", null); 
```

并将某些内容保存到首选项中：

```
settings.edit().putString("YourKey", "valueToSave").commit(); 
```

在自定义视图中使用的更具体示例是：

```
public class MyView extends View {

   SharedPreferences settings;

     // Other constructors that you may use also need the init() method

     public MyView(Context context){
         super(context);
         init();
     }

      private void init(){
         MyApplication app = (MyApplication) getContext().getApplicationContext();
         settings = app.getSharedPrefs();
      }

      private void someMethod(){ // or onTouch() etc
          settings.edit().putString("YourKey", "valueToSave").commit(); //Save your data
      }

      private void someOtherMethod(){
          String str = settings.getString("YourKey", null); //Retrieve your data
      }

} 
```

# java - 如何在 Java 中为 PNG 设置每平方英寸点数 (DPI)？

> ID：10660695
> 
> 赞同：0
> 
> 时间：2012-05-18T22:52:53.070
> 
> 标签：java, iterator, png, stack-overflow, dpi

让我从我没有代码开始，我不知道我应该做什么。显然，信息存储在 .png 文件的元数据中。我认为这应该不难做到，但事实证明这是一个挑战。

唯一看起来有点有用的是堆栈溢出的以下帖子。

[如何在图像中设置 DPI 信息？](https://stackoverflow.com/questions/321736/how-to-set-dpi-information-in-an-image)

但是，我尝试使用提供的代码和提供的网站来做这些事情，但一无所获。

当我尝试使用迭代器时，如下所示，iw.hasNext() 和 iw.next() 都出现错误。

错误是：

*   对于 HTMLDocument.Iterator 类型，方法 hasNext() 未定义
*   类型不匹配：无法从 void 转换为 ImageWriter

    for (Iterator iw = (Iterator) ImageIO.getImageWritersByFormatName(formatName); iw.hasNext;) { ImageWriter writer = iw.next();

**我的问题是，我从哪里开始，我需要寻找什么？有没有你知道的或者你自己做过的例子？**

* * *

附注我关于“如何在图像中设置 DPI 信息？”的问题。帖子是这个...

1.  为什么当我像他一样使用迭代器时，会出现错误？
2.  “INCH_2_CM”应该是什么意思/是？

我更改他的代码的方式如下...

* * *

```
 for (Iterator iw = (Iterator) ImageIO.getImageWritersByFormatName(formatName); iw.hasNext();) {
       ImageWriter writer = iw.next();
       ImageWriteParam writeParam = writer.getDefaultWriteParam();
       ImageTypeSpecifier typeSpecifier = ImageTypeSpecifier.createFromBufferedImageType(BufferedImage.TYPE_INT_RGB);
       IIOMetadata metadata = writer.getDefaultImageMetadata(typeSpecifier, writeParam);
       if (metadata.isReadOnly() || !metadata.isStandardMetadataFormatSupported()) {
          continue;
       }

       setDPI(metadata);

       final ImageOutputStream stream = ImageIO.createImageOutputStream(output);
       try {
          writer.setOutput(stream);
          writer.write(metadata, new IIOImage(gridImage, null, metadata), writeParam);
       } finally {
          stream.close();
       }
       break;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T23:40:02.733

您的代码在类`javax.swing.text.html.HTMLDocument.Iterator`和`java.util.Iterator`. 他的代码使用后者，但您的代码似乎使用的是前者。使用完全限定的类型，或者弄清楚如何修改您的导入。

# ruby - 如何在 Ruby 中将参数传递给 class << self？

> ID：10660696
> 
> 赞同：1
> 
> 时间：2012-05-18T22:52:57.970
> 
> 标签：ruby, class, self

你如何`class << self`在 Ruby 中传递参数？我在下面有一个正在使用的片段，我正在尝试使用 RMagick 生成图片。

```
#!/usr/bin/env ruby
%w[ rubygems RMagick ].each{|l| require l  }
%w[ Magick ].each{|i| require i }

module ImgGen
  class << self
    def start
      stripes = ImageList.new
      puts "hi"
    end

  end
end

WIDTH=650
HEIGHT=40
FILENAME="output.png"
FONT="winvga1.ttf"
ImgGen.start(WIDTH, HEIGHT, FILENAME, FONT) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T22:56:42.010

参数不会传递给`class << self`，而是传递给方法：

```
module ImgGen
  class << self
    def start(width, height, filename, font)
      stripes = ImageList.new
      puts "hi"
    end
  end
end 
```

[如果它](https://stackoverflow.com/questions/2505067/class-self-idiom-in-ruby)让您感到困惑，您可以阅读[详细说明`class << self`](https://stackoverflow.com/questions/2505067/class-self-idiom-in-ruby)，但简而言之：它打开了类的单例类，因此您可以向它添加方法。

# windows-phone-7 - 你好，因为你可以用c#打开键盘wp7

> ID：10660705
> 
> 赞同：0
> 
> 时间：2012-05-18T22:54:49.143
> 
> 标签：windows-phone-7

> **可能重复：**
> [以编程方式在 WP7 上显示软输入面板 (SIP)](https://stackoverflow.com/questions/3939389/display-soft-input-panel-sip-on-wp7-programmatically)

我正在做一个必须显示键盘的应用程序，并且无法在 c# 中发现执行此功能的事件。我会对你有很大帮助的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T06:29:09.593

您可以将焦点设置为 TextBox，键盘将显示：

```
TextBox1.Focus(); 
```

# jquery - 使用 jquery 增加 css 值

> ID：10660711
> 
> 赞同：2
> 
> 时间：2012-05-18T22:55:22.740
> 
> 标签：jquery, css

如何使用 jquery 增加 css 值？

我想增加诸如顶部和左侧之类的值，这是我尝试过但不起作用的方法：

```
var left = 5;
$(.object).css("left" + 5); 
```

问题是我需要这个值是一个整数而不是像“5px”这样的字符串。我需要 5 以便我可以用数值表达式更改它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T22:58:24.237

来自[.css() 文档](http://api.jquery.com/css/)：

> 从 jQuery 1.6 开始，.css() 接受类似于 .animate() 的相对值。相对值是一个以 += 或 -= 开头的字符串，用于增加或减少当前值。例如，如果一个元素的 padding-left 为 10px，.css( "padding-left", "+=15" ) 将导致总 padding-left 为 25px。

因此，您可以使用 js 变量向左递增：

```
var left = 5;
$(object).css('left', '+=' + left); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T22:59:21.100

洋基是对的：

```
var left = parseInt($(object).css("left")); 

$(object).css('left', left+5); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-18T22:58:02.857

```
var left = 5;

$(object).css('left', left+=5); 
```

# javascript - Twitter Bootstrap 轮播不滑动

> ID：10660718
> 
> 赞同：23
> 
> 时间：2012-05-18T22:56:42.747
> 
> 标签：javascript, image, twitter-bootstrap, slideshow, carousel

我遇到了一个有趣的问题。我很确定答案很简单，但我就是想不通，所以我想我寻求帮助。

基本上，我的旋转木马不会滑动。它只是切换图像。我什至尝试将引导站点中的确切 HTML 复制到我自己的页面中，但它仍然没有滑动。在 application.js 中，初始化也是没有参数的。

```
// carousel demo
$('#myCarousel').carousel() 
```

我注意到单击 pref/next 按钮时，next 和 prev 类被添加到每个项目中，但它似乎并没有对我做同样的事情。我调试时也没有发现任何问题。

我错过了什么？我在最新的 Chrome 和 Safari 中都对此进行了测试。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-07-14T14:01:28.020

您还必须添加`bootstrap-transition`滑动才能工作，如下所示：

```
<script src="twitter-bootstrap-v2/docs/assets/js/bootstrap-transition.js"></script> 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-05-29T22:36:12.020

我遇到了同样的问题，但是使用 bootstrap v2.0.3（其中捆绑了转换），最终将幻灯片类添加到轮播 div

```
<div id="myCarousel" class="carousel slide"> 
```

那么你只需调用：

```
$('#myCarousel').carousel(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-04T06:03:55.913

我想你需要

```
$('#myCarousel').carousel('cycle'); 
```

另请参阅： [如何使 Bootstrap js 轮播在页面加载后自动循环？](https://stackoverflow.com/questions/9750816/how-can-i-make-the-boostrap-js-carousel-automatically-cycle-as-soon-as-the-page)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T23:42:40.790

这是一个工作示例。这可能是您遗漏的小事。 [http://jsfiddle.net/chapmanc/Vza6F/1/](http://jsfiddle.net/chapmanc/Vza6F/1/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-30T06:56:30.820

你只是把那个JavaScript放在一个`<script>`标签里吗？

```
<script>
    $('.carousel').carousel({
        interval: 1000
    })​;
</script> 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2014-06-06T05:38:26.117

检查您包含的 css 文件。除了 bootstrap.min.css 之外，尝试添加 bootstrap.css 文件。它对我有用。

# c# - HttpResponseMessage 和 HttpResponseException 有什么区别

> ID：10660721
> 
> 赞同：58
> 
> 时间：2012-05-18T22:56:51.273
> 
> 标签：c#, asp.net-web-api

我试图理解两者并编写示例代码：

```
 public HttpResponseMessage Get()
 {
     var response = ControllerContext.Request
                         .CreateResponse(HttpStatusCode.BadRequest, "abc");

     throw new HttpResponseException(response);
 } 
```

和：

```
 public HttpResponseMessage Get()
 {
     return ControllerContext.Request
                        .CreateResponse(HttpStatusCode.BadRequest, "abc");
 } 
```

从小提琴，我真的没有看到它们之间有什么区别，那么使用的目的是`HttpResponseException`什么？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-05-24T09:18:00.877

两者的主要区别在于这一点。该异常对于立即停止处理并退出很有用。例如假设我有以下代码

```
public class CustomerController : ApiController {
  private ICustomerContext repo;

  public CustomerController(ICustomerContext repo) {
    this.repo = repo;
  }

  public Customer Get(int id) {
    var customer = repo.Customers.SingleOrDefault(c=>c.CustomerID == id);
    if (customer == null) {
      throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));
    }
    return customer;
  }
} 
```

如果此代码运行并且我传递了一个不存在的 id，它将立即停止处理并返回状态代码 404。

相反，如果我返回 HttpResponseMessage，请求将愉快地继续其其余处理并返回 404。主要区别在于是否结束请求。

正如 Darrel 所说，在某些情况下我希望继续处理（如找到客户时）而在其他情况下我不想继续处理时，异常很有用。

您可能想要使用类似 HttpResponseMessage 的地方是在 Http POST 中返回状态代码 201 并设置位置标头。在这种情况下，我确实希望继续处理。这将与此代码有关。*

```
public class CustomerController : ApiController {
  private ICustomerContext repo;

  public CustomerController(ICustomerContext repo) {
    this.repo = repo;
  }

  public HttpResponseMessage Post(Customer customer) {
    repo.Add(customer);
    repo.SaveChanges();
    var response = Request.CreateResponse(HttpStatusCode.Created, customer);
    response.Headers.Location = new Uri(Request.RequestUri, string.format("customer/{0}", customer.id));
    return response;
  }
} 
```

*注意：如果您使用的是 beta 位，您将创建一个新的 HttpResponseMessage。我正在使用后面的位，但是这要求您使用请求之外的 CreateResponse 扩展方法。

上面，我正在创建一个响应，它将状态代码设置为 201，传入客户，然后设置位置标头。

然后返回响应并继续处理请求。

希望这可以帮助

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-05-19T03:41:37.387

当您的控制器操作签名看起来像时，HttpResponseException 很有用

```
 Foo Get(int id) 
```

在这种情况下，您不能轻易返回 400 之类的状态码。

请注意，这`HttpResponseMessage<T>`将在 Web API 的下一个版本中消失。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-06-07T14:52:35.957

假设您想对响应进行单元测试，那么总是返回 HttpResponseMessage 是否有意义？我不是特别喜欢从 ApiController 返回直接类型的想法，因为它不遵循典型的开发模式。

在获取客户的非 Web API 类中，您可能会返回 null，而您的调用代码会检查 null 响应：

```
public Customer GetCustomer(int id)
{
    return db.Customers.Find(id);
} 
```

但是在 Web API 中，你不会返回 null，你必须返回一些东西，即使那个东西是在你抛出 HttpResponseException 之后创建的。在这种情况下，为了简化测试，为什么不总是返回一个 HttpResponseMessage，并把它作为你的签名呢？

```
public HttpResponseMessage GetCustomer(int id)
{
    var customer = db.Customers.Find(id);
    if (customer == null)
    {
        return Request.CreateResponse(HttpStatusCode.NotFound);
    }

    return Request.CreateResponse(HttpStatusCode.OK, customer);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-19T03:27:25.030

`HttpResponseException`源自`Exception`并嵌入`HttpResponseMessage`. 因为它派生自它在场景中`Exception`可能很有用。`try``catch`

返回的默认状态码`HttpResponseException`是`HttpStatusCode.InternalServerError`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-20T20:12:33.260

正如原始问题所述，返回的响应没有真正的区别。

HttpResponseException 的真正目的是允许子方法创建和“抛出”它们自己的 HttpResponseMessages，这些 HttpResponseMessages 流回调用堆栈并返回给客户端。

```
public class CustomerController : ApiController {
  private ICustomerContext repo;
  public CustomerController(ICustomerContext repo) {
    this.repo = repo;
  }

  public HttpResponseMessage Get(int id) {

    Customer customer = getCustomer(id);

    return Request.CreateResponse(customer);
  }

  private Customer getCustomer(int id){
    .....do some work
    .....we have a problem so throw exception
    throw new HttpResponseException(Request.CreateResponse(HttpStatusCode.BadRequest, "Id out of range");
    return repo.Customers.SingleOrDefault(c=>c.CustomerID == id)
} 
```

原谅任何错误，即时编写的代码。抛出的 HttpResponseException 通过动作调用堆栈冒泡，不会被正常的异常处理程序捕获并返回其 HttpResponseMessage 就像动作方法本身一样。

# java - Android - 在适配器中处理侦听器

> ID：10660724
> 
> 赞同：1
> 
> 时间：2012-05-18T22:57:39.787
> 
> 标签：java, android, listview

我有一些由自定义适配器（ArrayAdapter 和 CursorAdapter）驱动的 ListView。在适配器的 getView() 和 bindView() 函数中，我在 ListView 中创建了一行并将侦听器设置为该行中的特定 UI 元素。

目前，当 ListView 行被发送到 Recycler 时，侦听器仍然处于连接状态，因此永远不会释放内存。我没有看到处理该行时的回调，这将使我有机会在该行被回收之前分离侦听器。

如何管理 ListView 行中的侦听器？我只有 getView()/bindView() 将侦听器添加到行，但没有删除它们。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:02:24.990

Android OS 会`ListView`为您执行行视图的回收。当用户滚动列表时，视图会即时生成，当它们离开视图时会被销毁。每当其他应用程序需要更多内存并且您的某些对象没有被使用时，Android OS 就会破坏视图，这是一种垃圾收集。

至于您关于删除的问题`listeners`，它们会自动删除，因为它们指向的对象不再存在并且它们也被标记为垃圾对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:35:17.197

在玩了一些之后，我决定使用 ViewHolder 模式，并且在其中我有一个跟踪侦听器的变量。当提供回收视图（如果适用）时，我拉出监听器（它*仍然*存在）并确保将其取消注册为监听器，然后再创建一个新的监听器并在其位置注册它。这可能不会抓住每个听众，但我可以接受一些 ListView 行被卡在内存中。

# asp.net-mvc-3 - ASP.NET MVC 3 分页列表。仅 LINQ to Entities 中的排序输入支持“跳过”方法。

> ID：10660726
> 
> 赞同：1
> 
> 时间：2012-05-18T22:57:46.997
> 
> 标签：asp.net-mvc-3, razor

为什么它在`return View(contacts.ToPagedList(pageNumber, pageSize));`语句中给出错误 Index 方法中的错误： `The method 'Skip' is only supported for sorted input in LINQ to Entities. The method 'OrderBy' must be called before the method 'Skip'.`

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Entity;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using PhoneBook.Models;
using PagedList;

namespace PhoneBook.Controllers
{ 
public class ContactsController : Controller
{
    private PhoneDBContext db = new PhoneDBContext();

    //
    // GET: /Contacts/

    public ViewResult Index(string searchString, string sortOrder, Contact model, string currentFilter, int? page)
    {
        ViewBag.CurrentSort = sortOrder;

        ViewBag.FNameSortParm = sortOrder == "FName asc"? "FName desc" : "FName asc";
        ViewBag.DateSortParm = sortOrder == "Date asc" ? "Date desc" : "Date asc";
        ViewBag.LNameSortParm = sortOrder == "LName asc" ? "LName desc" : "LName asc";
        ViewBag.CompSortParm = sortOrder == "Company asc" ? "Company desc" : "Company asc";
        ViewBag.MobSortParm = sortOrder == "Mob asc" ? "Mob desc" : "Mob asc";
        ViewBag.TelSortParm = sortOrder == "Tel asc" ? "Tel desc" : "Tel asc";

        if (Request.HttpMethod == "GET") { searchString = currentFilter; }
        else {page = 1;}
        ViewBag.CurrentFilter = searchString;
        var contacts = from m in db.Contacts
                       select m;

        switch (sortOrder)
        {
            case "FName desc":
                contacts = contacts.OrderByDescending(s => s.FirstName);
                break;
            case "FName asc":
                contacts = contacts.OrderBy(s => s.FirstName);
                break;
            case "LName desc":
                contacts = contacts.OrderByDescending(s => s.LastName);
                break;
            case "LName asc":
                contacts = contacts.OrderBy(s => s.LastName);
                break;
            case "Company desc":
                contacts = contacts.OrderByDescending(s => s.Company);
                break;
            case "Company asc":
                contacts = contacts.OrderBy(s => s.Company);
                break;
            case "Date desc":
                contacts = contacts.OrderByDescending(s => s.DateAdded);
                break;
            case "Date asc":
                contacts = contacts.OrderBy(s => s.DateAdded);
                break;
            case "Mob desc":
                contacts = contacts.OrderByDescending(s => s.MobileNumber);
                break;
            case "Mob asc":
                contacts = contacts.OrderBy(s => s.MobileNumber);
                break;
            case "Tel desc":
                contacts = contacts.OrderByDescending(s => s.TelephoneNumber);
                break;
            case "Tel asc":
                contacts = contacts.OrderBy(s => s.TelephoneNumber);
                break;
        }

        if (!String.IsNullOrEmpty(searchString))
        {
            contacts = contacts.Where(s => s.LastName.ToUpper().Contains(searchString)||s.FirstName.ToUpper().Contains(searchString)||s.Company.ToUpper().Contains(searchString));
        }

        int pageSize = 3;
        int pageNumber = (page ?? 1);

       return View(contacts.ToPagedList(pageNumber, pageSize));
    }

    //
    // GET: /Contacts/Details/5

    public ViewResult Details(int id)
    {
        Contact contact = db.Contacts.Find(id);
        return View(contact);
    }

    //
    // GET: /Contacts/Create

    public ActionResult Create()
    {
        return View();
    } 

    //
    // POST: /Contacts/Create

    [HttpPost]
    public ActionResult Create(Contact contact)
    {
        if (ModelState.IsValid)
        {
            db.Contacts.Add(contact);
            contact.DateAdded = DateTime.Now;
            db.SaveChanges();
            return RedirectToAction("Index");  
        }

        return View(contact);
    }

    //
    // GET: /Contacts/Edit/5

    public ActionResult Edit(int id=0)
    {

        Contact contact = db.Contacts.Find(id);

        if (contact == null)    { return HttpNotFound(); } // returns blank page if id is not valid
        return View(contact);
    }

    //
    // POST: /Contacts/Edit/5

    [HttpPost]
    public ActionResult Edit(Contact contact)
    {
        if (ModelState.IsValid)
        {

            db.Entry(contact).State = EntityState.Modified;
            contact.DateAdded = DateTime.Now;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(contact);
    }

    //
    // GET: /Contacts/Delete/5

    public ActionResult Delete(int id)
    {
        Contact contact = db.Contacts.Find(id);
        if (contact == null) { return HttpNotFound(); }
        return View(contact);
    }

    //
    // POST: /Contacts/Delete/5

    [HttpPost, ActionName("Delete")]
    public ActionResult DeleteConfirmed(int id)
    {            
        Contact contact = db.Contacts.Find(id);
        if (contact == null) { return HttpNotFound(); }
        db.Contacts.Remove(contact);
        db.SaveChanges();
        return RedirectToAction("Index");
    }

    public ActionResult SearchIndex(string searchString)
    {
        var contacts = from m in db.Contacts
                     select m;

        if (!String.IsNullOrEmpty(searchString))
        {
            contacts = contacts.Where(s => s.LastName.Contains(searchString));
        }

        return View(contacts);
    }

    protected override void Dispose(bool disposing)
    {
        db.Dispose();
        base.Dispose(disposing);
    }

}
} 
```

下面是 Index.cshtml 代码：

```
@model PagedList.IPagedList<PhoneBook.Models.Contact>
@{
    ViewBag.Title = "Phone Book";
}

<p>

     @using (Html.BeginForm()){   
         <p> Search: @Html.TextBox("SearchString", ViewBag.CurrentFilter as string) 
         <input type="submit" value="Go" /></p>
        }
</p>

<p>
    @Html.ActionLink("Create New", "Create")
</p>

<table>
    <tr>
        <th>
             @Html.ActionLink("First Name", "Index", new { sortOrder=ViewBag.FNameSortParm, currentFilter=ViewBag.CurrentFilter })
        </th>
        <th>
             @Html.ActionLink("Last Name", "Index", new { sortOrder = ViewBag.LNameSortParm, currentFilter = ViewBag.CurrentFilter })
        </th>
        <th>
            @Html.ActionLink("Mobile Num", "Index", new { sortOrder = ViewBag.MobSortParm, currentFilter = ViewBag.CurrentFilter })
        </th>
        <th>
            @Html.ActionLink("Tel Num", "Index", new { sortOrder = ViewBag.TelSortParm, currentFilter = ViewBag.CurrentFilter })
        </th>
        <th>
             @Html.ActionLink("Company", "Index", new { sortOrder = ViewBag.CompSortParm, currentFilter = ViewBag.CurrentFilter })
        </th>
        <th>
           @Html.ActionLink("Date Added/Updated", "Index", new { sortOrder = ViewBag.DateSortParm, currentFilter = ViewBag.CurrentFilter })
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.FirstName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.LastName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.MobileNumber)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.TelephoneNumber)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Company)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.DateAdded)
        </td>
        <td>
            @Html.ActionLink("Details", "Details", new { id=item.ID })
            @Html.ActionLink("Edit", "Edit", new { id=item.ID }) 
            @Html.ActionLink("Delete", "Delete", new { id=item.ID })
        </td>
    </tr>
}

</table>

<div>
    Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber)
    of @Model.PageCount

    @if (Model.HasPreviousPage)
    {
        @Html.ActionLink("<<", "Index", new { page = 1, sortOrder = ViewBag.CurrentSort, currentFilter=ViewBag.CurrentFilter  })
        @Html.Raw(" ");
        @Html.ActionLink("< Prev", "Index", new { page = Model.PageNumber - 1, sortOrder = ViewBag.CurrentSort, currentFilter=ViewBag.CurrentFilter  })
    }
    else
    {
        @:<<
        @Html.Raw(" ");
        @:< Prev
    }

    @if (Model.HasNextPage)
    {
        @Html.ActionLink("Next >", "Index", new { page = Model.PageNumber + 1, sortOrder = ViewBag.CurrentSort, currentFilter=ViewBag.CurrentFilter  })
        @Html.Raw(" ");
        @Html.ActionLink(">>", "Index", new { page = Model.PageCount, sortOrder = ViewBag.CurrentSort, currentFilter=ViewBag.CurrentFilter  })
    }
    else
    {
        @:Next >
        @Html.Raw(" ")
        @:>>
    }
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T23:00:50.483

尝试以下三个更改。

1.  将此代码放在switch 语句*之前：*

    ```
    if (!String.IsNullOrEmpty(searchString))
    {
        contacts = contacts.Where(s => s.LastName.ToUpper().Contains(searchString)||s.FirstName.ToUpper().Contains(searchString)||s.Company.ToUpper().Contains(searchString));
    } 
    ```

2.  在你的 switch 语句中添加一个`default`case，并让它抛出。

    ```
    switch (sortOrder) {
        case ...:
            ...
        default:
            throw new ArgumentException("Bad sort order specified", "sortOrder");
    } 
    ```

3.  使用类型`IOrderedQueryable<T>`。

    ```
    IOrderedQueryable<T> orderedContacts;
    switch (sortOrder)
    {
        case "FName desc":
            orderedContacts = contacts.OrderByDescending(s => s.FirstName);
            break;
        ...
    }

    ...

    return View(orderedContacts.ToPagedList(pageNumber, pageSize)); 
    ```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2015-04-20T21:11:31.817

```
return View(orderedContacts.ToList().ToPagedList(pageNumber, pageSize)); 
```

# visual-studio - Sql Server CE 外键显示为主键

> ID：10660732
> 
> 赞同：0
> 
> 时间：2012-05-18T22:58:23.827
> 
> 标签：visual-studio, sql-server-ce, foreign-key-relationship, sql-server-ce-4

至少，在我看来是这样的。我正在使用 Sql Server CE 4.0 和 Visual Studio 2010。这是我第一次使用 Sql Server CE。

例如，我有两张桌子。一种称为模板：

```
TemplateID (int, primary key, identity)
TemplateName (nvarchar) 
```

另一个称为产品：

```
ProductID (int, primary key, identity)
TemplateID (int, foreign key relationship with Templates)
ProductName (nvarchar) 
```

创建这些表后，我尝试在 Products 的 TemplateID 字段和 Templates 的 TemplateID 字段的表之间建立外键关系。

建立关系后，当我查看服务器资源管理器中的 Products 表时，我看到 TemplateID 已被标记为 Products 中的主键。这不应该是该表中的主键！

这仅仅是 CE 表的一些奇怪的表示形式——意味着外键是其他表中的主键？看起来不是这样，因为单击 Products 表中的 TemplateID 列，并在 Properties 窗口中展开 Identity 标记，显示“表”是 Products，而不是 Templates。

如果有人能阐明这种陌生感，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T20:49:20.427

一些测试确认外键不包含在主键中，尽管在 Visual Studio 中显示。

因此，显然这只是在 Visual Studio Server Explorer 中显示表字段的一种笨拙、令人困惑的方式。

是的。我已经想念管理工作室了...

# javascript - 单击一项，在其他项中添加和删除类

> ID：10660737
> 
> 赞同：2
> 
> 时间：2012-05-18T22:58:43.003
> 
> 标签：javascript, jquery, addclass, removeclass

我有以下 HTML：

```
<ul>
   <li class="one"><a href="#">one</a></li>
   <li class="two"><a href="#">two</a></li>
   <li class="three"><a href="#">three</a></li>
</ul>

<div class="one">
   Here's div one
</div>

<div class="two">
   Here's div two
</div>

<div class="three">
   Here's div three
</div>

<div class="one">
   Here's another div one, just for kicks
</div> 
```

这就是我想要做的：当你点击 li class="one" 时，我想为 class="one" 的所有 div 添加一个“活动”类。然后，当您单击 li class="two" 时，它会从第一个 div 中删除“活动”并将其放在 div class="two" 上。我已经尝试了几种不同的方法，但是我很难想出一种有效的方法来为所有的 lis 和 div 做这件事（最终会有 10 个）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:00:44.983

```
$('ul a').on('click',function(){
  $('.active').removeClass('active');
  $('div.'+$(this).text()).addClass('active');  
}); 
```

## 演示：http: [//jsfiddle.net/9RLa9/](http://jsfiddle.net/9RLa9/)

或者，如果您想使用父类而不是链接的文本来触发您的更改：

```
$('ul li').on('click',function(){
  $('.active').removeClass('active');
  $('div.'+$(this).attr('class')).addClass('active');  
}); 
```

# ruby-on-rails - 将 _header.html.erb 添加到静态 html 页面

> ID：10660743
> 
> 赞同：0
> 
> 时间：2012-05-18T22:59:23.487
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我有一个 _header.html.erb 文件，其中包含徽标和其他文本字段。
如何将其添加到静态 html 页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:11:31.017

您可以使用高压 gem 为您的静态内容添加更多红宝石：[https ://github.com/thoughtbot/high_voltage](https://github.com/thoughtbot/high_voltage)

# database - 水晶报表无法登录

> ID：10660746
> 
> 赞同：0
> 
> 时间：2012-05-18T22:59:35.517
> 
> 标签：database, login, crystal-reports-2008

我制作了一个水晶报表，如果我将它与我用来创建它的相同数据库信息一起使用，它就可以工作。但是当我在另一个环境中使用该报告时（例如，从开发到测试）它不起作用。错误是“登录失败”。

没有意义的是我给 DB 参数提供了： SetDatabaseLogon() 函数。但是当我在互联网上进行研究时，似乎有时我应该遍历报告的所有表格并为每个表格设置此信息。所以，我不明白 SetDatabaseLogon() 信息的作用。

开发数据库和测试数据库来自同一个提供者，它只更改 SQL Server 名称（即使用户和密码相同）。

我很感激在这个问题上的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T07:24:21.660

如果您的报告包含任何子报告，那么您必须遍历主报告中的所有子报告并设置 SetDatabaseLogon() 信息

# javascript - 是否可以在同一个文件中访问其他模块导出功能？

> ID：10660747
> 
> 赞同：15
> 
> 时间：2012-05-18T22:59:45.250
> 
> 标签：javascript, node.js

我在同一个文件中有两个函数，都从外部访问。其中一个函数由第二个函数调用。

```
module.exports.functionOne = function(param) {
    console.log('hello'+param);
};

module.exports.functionTwo = function() {
    var name = 'Foo';
    functionOne(name);
}; 
```

当它被执行时，对 functionOne 的调用被标记为未定义。

引用它的正确方法是什么？

我发现一种可行的模式是引用文件本身。

```
var me = require('./thisfile.js');
me.functionOne(name); 
```

...但感觉必须有更好的方法。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-18T23:26:57.753

简直了`module.exports.functionOne()`。

如果这太麻烦，只需执行以下操作：

```
function fnOne() {
    console.log("One!");
}

module.exports.fnOne = fnOne; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-19T12:54:52.950

```
var me = require(module.filename);
me.functionOne(name); 
```

或者只使用导出对象本身

```
module.exports.functionOne(name); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T23:35:49.570

我想我一直在考虑 require 相当于 include、import 等。如果有另一种解决方法，看看它可能会很有趣。我仍然用节点湿透了耳朵。

[James Herdmans](http://jherdman.github.com/) [了解 Node.js 的“require”](http://jherdman.github.com/2010-04-05/understanding-nodejs-require.html)帖子在帮助代码组织方面确实帮助了我。它绝对值得一看！

```
// ./models/customer.js
Customer = function(name) {
  var self = this;
  self.name = name;

};

// ./controllers/customercontroller.js
require("../models/customer");

CustomerController = function() {
  var self = this;

  var _customers = [
   new Customer("Sid"),
   new Customer("Nancy")
  ];
  self.get() {
   return _customers;
  }
}; 
```

# java - 使用 Hibernate 注释为其他列分配相同的值

> ID：10660748
> 
> 赞同：1
> 
> 时间：2012-05-18T22:59:45.890
> 
> 标签：java, hibernate, annotations

基本上，我只需要将 EMPLOYEE_ID 字段的相同值分配给 EMPLOYEE 表的其他列（PROFILE_EMPLOYEE_NAME_ID 和 PROFILE_EMPLOYEE_STATUS_ID）。

详情如下：

注释类

```
 @SequenceGenerator(name="generator", sequenceName="EMPLOYEE_ID_SEQ")
    @Id
    @GeneratedValue(strategy=SEQUENCE, generator="generator")
    @Column(name="EMPLOYEE_ID", unique=true, nullable=false)
    private int employeeId;

    @Column(name="PROFILE_EMPLOYEE_NAME_ID", unique=true, nullable=false)
    private int profileEmployeeNameId;

    @Column(name="PROFILE_EMPLOYEE_STATUS_ID", unique=true, nullable=false)
    private int profileEmployeeStatusId;

    @OneToMany(cascade = ALL, fetch = EAGER, orphanRemoval = true)
    @JoinColumn(name = "SHORT_ID")
    @Where(clause = "ELEMENT_TYPE_CD like 'EMPLOYEE_%'")
    private Set<Profile> profile; 
```

DDL

```
 EMPLOYEE
      EMPLOYEE_ID (Primary key)
      PROFILE_EMPLOYEE_NAME_ID
      PROFILE_EMPLOYEE_STATUS_ID

    PROFILE TABLE 
      PROFILE_ID (Primary key)
      ELEMENT_TYPE_CD (Possible values are: EMPLOYEE_NAME, EMPLOYEE_STATUS)
      SHORT_ID
      DESCRIPTION 
```

PROFILE 表通过 SHORT_ID = EMPLOYEE_ID 与 Employee 表连接。

我知道 PROFILE_EMPLOYEE_NAME_ID 和 PROFILE_EMPLOYEE_STATUS_ID 是多余的，但这就是 DBA 的设计方式。或者也许我还没有看到这个设计的目的。

有没有办法使用注释来做到这一点？否则，最好的解决方案是什么？

# android - 无法在未调用 looper.prepare 异常的线程内创建处理程序

> ID：10660750
> 
> 赞同：0
> 
> 时间：2012-05-18T22:59:54.077
> 
> 标签：android, json, apache, android-asynctask

首先，让我解释一下，我很清楚这个例外意味着什么，如果你要回答，请仔细阅读这个问题。

我知道当您尝试在网络线程上进行 UI 工作时会出现异常。我正在使用 AsyncTask，但我正在执行任何 UI 操作。

这是抛出错误的 AsyncTask 代码的片段注意 aps 和 adm 是提前声明的，它在 Extracter 初始化中抛出了异常：

```
 do{
            try{

                HttpPost request = new HttpPost(params[0]);
                request.setHeader("Accept", "application/json");
                request.setHeader("Content-type", "application/json");
                aps.setLastSent(lastSent);
                StringEntity filterEntity = new StringEntity(aps.TempParameter()); //Remember this TempParameter is temporary function
                request.setEntity(filterEntity);
                response = httpClient.execute(request);
                StatusLine statusLine = response.getStatusLine();
                if(statusLine.getStatusCode() == HttpStatus.SC_OK){
                    Extracter extracter = new Extracter(response);
                    lastSent = extracter.extractLastSent();
                    adm.addDictionary(extracter.extractDictionary());
                }
            } catch (ClientProtocolException e) {
                //TODO Handle problems..
                builder.append("Client protocol exception");
            } catch (IOException e) {
                //TODO Handle problems..
                builder.append(e.toString());
            }
        }while(lastSent != "done");

            return adm.getAlarmObjectList(); 
```

线

```
 Extracter extracter = new Extracter(response); 
```

是抛出异常的地方。下面是 Extracter 类的代码：

```
 public class Extracter extends AlarmLoopTestActivity {

private JSONObject jo;
private JSONArray ja;

public Extracter(HttpResponse response){
    StringBuilder builder = new StringBuilder();
    HttpEntity entity = response.getEntity();
    try {
        InputStream content = entity.getContent();
        BufferedReader reader = new BufferedReader(new InputStreamReader(content));
        String line;
        while((line = reader.readLine())!= null){
            builder.append(line);
        }
    } catch (IllegalStateException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    String json = builder.toString();
    try {
        jo = (JSONObject) new JSONTokener(json).nextValue();
        ja = jo.getJSONArray("effectNamesDict");
    } catch (JSONException e) {
        jo = null;
        e.printStackTrace();
    }

} 
```

我假设 printStackTrace 不被视为 UI 事件。除此之外，我很茫然。我需要对此有新的认识。如果我需要进一步详细说明，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:17:43.813

您`Extracter`正在扩展一个`AlarmLoopTestActivity`名称为“这是一个 android Activity”的类，因此它可能有一些 UI 交互方法！

# php - 如何理解 Wordpress 自定义函数？

> ID：10660754
> 
> 赞同：1
> 
> 时间：2012-05-18T23:00:22.870
> 
> 标签：php, javascript, wordpress

我正在使用自定义主题，并且有一行说`<?php sg_header_js() ?>`. 我的假设是查看 Wordpress 的函数文件夹以获得更好的想法。当我查看 functions>function.php 内部时，这是我看到的代码：

```
<?php

//Textdomain
define('SG_TDN', 'felis');

//Add features or post thumbnail sizes here
function sg_user_theme_setup()
{
    /* Add theme-supported features. */
    /* add_theme_support(''); */

    /* Add images sizes */
    /* Please use 'cm_' prefix to name */
    /* add_image_size('cm_myimage', 100, 100, true); */
}

//Theme Setup
require_once TEMPLATEPATH . '/functions/init.php'; 
```

我应该在哪里查找 javascript 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:21:06.593

您可以通过以下方式找到此信息：

*   它们可能被硬编码为`header.php`您的主题。
*   通常它们包含在`js, scripts, lib`类似的文件夹中
*   查看挂钩到 " `wp_head`" 方法的函数。
*   从浏览器中查看编译后的源代码，看看哪些 js 文件包含在标签中，或者某些脚本可能包含在 body 中。搜索`.js?`或`.js"`字符串的来源。
*   如果主题使用脚本压缩，那么您会看到一个名为“compressed.js”之类的脚本文件。寻找创建它的函数或插件，它可能会告诉你一些事情。

# c - 整体推广

> ID：10660758
> 
> 赞同：6
> 
> 时间：2012-05-18T23:00:40.230
> 
> 标签：c, integer-promotion

关于整数提升，有符号整数何时不能代表原始类型的所有值？

来自文本 K&R，C 编程语言，第 2 版。页。174

> **A.6.1 积分促销**
> 
> 一个字符、一个短整数或一个整数位域，无论是否有符号，或枚举类型的对象，都可以在可以使用整数的表达式中使用。**如果一个 int 可以表示原始类型的所有值，则将该值转换为 int；否则，该值将转换为 unsigned int**。这个过程称为积分提升。

此代码显示了我的系统的类型限制：

```
#include <stdio.h>
#include <limits.h>

int main(void)
{

    printf("CHAR_MAX: %i\n", CHAR_MAX);     
    printf("UCHAR_MAX: %i\n", UCHAR_MAX);

    printf("SHORT_MAX: %i\n", SHRT_MAX);        
    printf("USHORT_MAX: %i\n", USHRT_MAX);

    printf("INT_MAX: %i\n", INT_MAX);       
    printf("UINT_MAX: %u\n", UINT_MAX);

    return 0;
} 
```

结果是：

```
CHAR_MAX: 127
UCHAR_MAX: 255
SHORT_MAX: 32767
USHORT_MAX: 65535
INT_MAX: 2147483647
UINT_MAX: 4294967295 
```

有符号的 int 类型比任何其他类型都大，那么它什么时候会回落到 UINT_MAX 呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T23:04:07.090

例如， a 可能与 a`short int`大小相同`int`，因此`unsigned short int`无法将 a 提升为 a `int`。您的编译器并非如此。

# android - Android 中的 GLES20.glLinkProgram() 调用不返回

> ID：10660759
> 
> 赞同：0
> 
> 时间：2012-05-18T23:00:42.487
> 
> 标签：android, opengl-es-2.0

我有一个 LinkedQueue 存储对 GLES20 类中任何内容的调用。加载后，我向 GLSurfaceView 发送 requestRender() 调用，并在 onDrawFrame() 中处理队列并调用实际的 GLES20 方法。

然而，当我调用 GLES20.glLinkProgram() 时，该函数永远不会返回。我在 logcat 中没有任何东西，没有例外，没有杀死线程什么都没有。它就在那里。

在 glLinkProgram() 不返回的情况下有什么想法，我可以做些什么来调试这种情况？令人沮丧的是我无法进入内部部分，因为它是原生的，我试图避免下载整个 android 源代码并研究它......

# javascript - 了解上次更改 MongoDB 文档的最佳方式是什么？

> ID：10660761
> 
> 赞同：0
> 
> 时间：2012-05-18T23:00:47.417
> 
> 标签：javascript, node.js, mongodb, database

每次与它互动时我都需要`lastActivity: new Date()` `@set`添加它还是有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T08:26:55.637

MongoDB 目前没有内置功能来设置最后更新日期，所以你必须自己做。我可能（取决于语言）继承 MongoCollection 类来添加一个薄包装器来自己做。

# css - 自定义 soundcloud 播放器（最小）字体颜色保持黑色

> ID：10660764
> 
> 赞同：0
> 
> 时间：2012-05-18T23:00:51.583
> 
> 标签：css, fonts, soundcloud

再次，从 github 移动，很抱歉交叉发布。

我已经调整了最小播放器，并且无法更改曲目标题的字体颜色。所有其他字体属性都会更改，但字体颜色始终保持黑色：

```
.sc-player {
font-family: Century Gothic, sans-serif;
color: grey;
font-size: 12px;
line-height: 1.6em;
font-weight: none;
text-transform: lowercase;
} 
```

如何更改颜色属性？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T08:10:29.793

`.sc-player ol li a { color:grey; }`应该适合你或只是`.sc-player a { color:grey; }`

# javascript - 在spring mvc中加载JS文件

> ID：10660772
> 
> 赞同：0
> 
> 时间：2012-05-18T23:01:36.420
> 
> 标签：javascript, spring, spring-mvc

> 如果我可以在 spring mvc 中加载 javascript 和 css 文件，有什么办法，这样每当有人查看网页的源代码时它就无法读取？

我想在不缩小的情况下做到这一点。

我还寻找了其他选项，例如＆不知道要用户使用哪个选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T23:46:05.603

不。嗯，不是真的。

您不能将 js 和 css 添加到 DOM 并使其工作而不在 DOM 中。您可以动态加载它们，但它们仍将在任何浏览器的 DOM 检查器中可见，但对于您的磨房用户右键单击并查看源代码的运行将不可见。

# r - ggplot 图例斜线

> ID：10660775
> 
> 赞同：21
> 
> 时间：2012-05-18T23:01:42.460
> 
> 标签：r, ggplot2

过去这一定惹恼了某人，所以如果这是重复的，请原谅，我会删除它。使用时跨越图例的斜线`geom_bar`可能很烦人。例如：

```
x  <- c("a","b")
y  <- c(1,2)
df <- as.data.frame(cbind(x,y))
a  <- ggplot(df,aes(x=x,y=y,fill=x))
a + geom_bar(colour="black") + scale_fill_manual(values=c("white", "black")) 
```

![在此处输入图像描述](../Images/5d7c34b58a237dabff25ace6f5f5c11a.png)

当我使用彩色条时，我会使用这项工作，首先绘制没有颜色的条，例如

```
a + geom_bar() + geom_bar(colour="black",show_guide=FALSE) +
 scale_fill_manual(values=c("white", "black")) 
```

然而，当填充为白色时，这会在图例中留下一个令人不满意的空白框，没有边框。例如

![在此处输入图像描述](../Images/84348a697b9a69e197ca3a61d403e952.png)

我过去使用图形软件手动修复了这个问题，但现在我认为这必须有足够多的人在这里提问。我们可以`ggplot`只用黑色轮廓而不用斜线绘制图例吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T23:23:06.317

这，

```
 a + geom_bar() + geom_bar(colour="black",show_guide=FALSE) +
 scale_fill_manual(values=c("white", "black")) + 
 opts(legend.key = theme_rect(fill = 'black')) 
```

给了我这个， ![在此处输入图像描述](../Images/0b2b472d19a518e5a07d679145301d67.png) 感谢[这个网站](https://github.com/hadley/ggplot2/wiki/Legend-Attributes)。

阿洛斯，您使用`colour`而不是得到相同的结果`fill`（可能有人认为一个更好）。

```
a + geom_bar() + geom_bar(colour="black",show_guide=FALSE) + 
scale_fill_manual(values=c("white", "black")) + 
opts(legend.key = theme_rect(colour = 'black')) 
```

**重要说明**：在现代版本的 ggplot2`opts`已被弃用并替换为`theme`，并`theme_rect`已替换为`element_rect`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T23:10:27.523

不，这就是它的轮廓。如果您使用灰色而不是白色（使用您的技巧），它会更容易区分。您还可以为图例添加背景颜色以使其更易于区分并保持白色。有关更多详细信息，请参见本页底部：

[http://wiki.stdout.org/rcookbook/Graphs/Legends%20(ggplot2)/](http://wiki.stdout.org/rcookbook/Graphs/Legends%20(ggplot2)/)

我希望有一种不那么骇人听闻的方式来做到这一点。

# shell - 按扩展属性值跟踪文件

> ID：10660777
> 
> 赞同：0
> 
> 时间：2012-05-18T23:01:43.690
> 
> 标签：shell, command-line, terminal, command, command-prompt

所以我正在尝试制作一个引用其他文件的脚本。即使文件移动，我也希望能够跟踪文件。所以我在想，如果我可以为文件分配一个唯一值，那么我可以通过搜索我分配给它的唯一值来找到文件的位置。

有一个更好的方法吗？

基本上我希望能够从它作为扩展属性的值中找到一个文件。但我不知道这是否可能。

任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:08:36.110

您可以使用 inode 编号（用 显示`ls -i /some/file`），每个文件都是唯一的，并且在文件更改或移动时不会更改，除非您将文件移动到不同的分区。如果您不需要跟踪多个分区上的文件，那么这将是一个非常简单的解决方案。

要按 inode 编号查找文件，您可以使用`find -inum <inode number>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-05T13:04:43.357

如果你需要跨文件系统移动文件，你可以使用命令[setfattr](http://linux.die.net/man/1/setfattr)来设置文件的扩展属性，注意：你的内核必须能够做到这一点。没有一次性的命令来查找文件，但您可以创建一个简单的脚本来通过您的唯一键搜索文件。为你的文件设置一个类似于*user.unique*的键和你喜欢的字符串值，例如：*n1234*

```
setfattr -n user.unique -v n1234 yourfile 
```

要检索值，您可以使用命令 getfattr

```
getfattr -n user.unique yourfile 
```

或获取所有扩展文件属性：

```
getfattr -d yourfile 
```

要测试您的内核是否能够处理文件系统类型的扩展属性：

```
zcat /proc/config.gz | grep FS_XATTR 
```

要编写一个简单的脚本来使用扩展属性进行搜索，您可以参考这个[Hack](http://eduunix.ccut.edu.cn/index2/html/linux/OReilly.Linux.Server.Hacks.Volume.Two.Dec.2005/0596100825/morelnxsvrhks-CHP-5-SECT-10.html#morelnxsvrhks-CHP-5-SECT-10.5)；在同一页面上，您可以阅读有关扩展属性的更多信息。

# jquery - Mac Chrome 上的 colorbox ajax 示例在关闭时闪烁

> ID：10660778
> 
> 赞同：0
> 
> 时间：2012-05-18T23:01:51.787
> 
> 标签：jquery, colorbox

我正在查看 Chrome 中的 colorBox 示例（Mac，MB Pro 上的 19.0.1084.46） [http://www.jacklmoore.com/colorbox/example1/](http://www.jacklmoore.com/colorbox/example1/)

Flash / 视频（Ajax/嵌入式） Flash / 视频（Iframe/直接链接到 YouTube）

有时，当我关闭模式时，它会消失，但随后又闪回并消失。这只是一瞬间，并且只发生在 Chrome 中。我还看到这些样本的叠加层有些闪烁。还有人看到这个吗？任何修复的想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T21:29:51.463

我知道这是一篇旧帖子，但我今天也在为同样的闪烁问题而苦苦挣扎。这对我有帮助：使用`onCleanup`回调隐藏模态窗口内容（它发生在模态关闭之前）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:12:26.880

对我来说，它似乎工作得很好。在我关闭它后，我没有看到模态在 chrome 中出现和消失。

我的 chrome 版本 19.0.1084.52

# c# - C# Windows Phone Mango - 无效的跨线程访问？解析 XML

> ID：10660779
> 
> 赞同：0
> 
> 时间：2012-05-18T23:01:54.030
> 
> 标签：c#, xml, windows-phone-7, url, error-handling

我有以下代码似乎引发了“无效的跨线程访问”。我似乎无法弄清楚为什么。我正在从 URL 加载远程 xml 文件，但是，在解析该 XML 时，我总是收到此错误。有什么建议么？

```
using (StreamReader streamReader = new StreamReader(response.GetResponseStream()))
        {
            string xml = streamReader.ReadToEnd();

            using (XmlReader reader = XmlReader.Create(new StringReader(xml)))
            {

                    reader.ReadToFollowing("channel");
                    reader.MoveToFirstAttribute();

                    reader.ReadToFollowing("title");
                    output.AppendLine("Title: " + reader.ReadElementContentAsString());

                    reader.ReadToFollowing("description");
                    output.AppendLine("Desc: " + reader.ReadElementContentAsString());

                    textBox1.Text = output.ToString(); //Invalid cross-thread access.
            }

        } 
```

我尝试解析的 XML 如下所示，我只是在尝试解析点点滴滴，因为我继续学习如何使用 c# 解析不同类型的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"xmlns:dc="http://purl.org   /dc/elements/1.1/" xmlns:slash="http://purl.org/rss/1.0  /modules/slash/">
  <channel>
<title>Server &amp; Site News</title>
<description>A place for the Admin and Moderators to post the latest news on both the server and site.</description>
<pubDate>Fri, 18 May 2012 22:45:08 +0000</pubDate>
<lastBuildDate>Fri, 18 May 2012 22:45:08 +0000</lastBuildDate>
<generator>Forums</generator>
<link>http://removedurl.com/forums/server-site-news.23/</link>
<atom:link rel="self" type="application/rss+xml" href="http://removedurl.com/forums/server-site-news.23/index.rss"/>
<item>
  <title>Example Title</title>
  <pubDate>Mon, 14 May 2012 17:39:45 +0000</pubDate>
  <link>http://removedurl.com/threads/back-fully-working.11013/</link>
  <guid>http://removedurl.com/threadsback-fully-working.11013/</guid>
  <author>Admin</author>
  <dc:creator>Admin</dc:creator>
  <slash:comments>14</slash:comments>
</item>
</channel> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T23:09:50.163

textBox1.Text = output.ToString(); //无效的跨线程访问。

你得到这个是因为你在 IO 线程上进行操作时正在调用 UI 线程。尝试分离这些操作或调用`invoke`UI 线程。

尝试将您的代码更改为这样的内容。

```
Dispatcher.BeginInvoke( () => { //your ui update code } ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T23:16:09.487

从 Mayank 添加更多细节：

```
Dispatcher.BeginInvoke( () => {
  textBox1.Text = output.ToString()
} ); 
```

您必须将对 UI 对象的调用编组回 UI 线程。除了主线程之外，没有任何东西可以修改任何其他线程上的 UI 元素。

# jquery - 特别选择从开始到一个的所有表格行

> ID：10660780
> 
> 赞同：2
> 
> 时间：2012-05-18T23:02:14.810
> 
> 标签：jquery

我正在尝试使用包含在表格中的日历来做一些事情。基本上，每一天都是一个表格单元格。今天的单元格有一个特殊的类，称为... `.today`（非常原始）。

我想要这样，当用户单击一个日单元格时，它会发生一些事情。为了可用性起见，我想在那些日子里添加一个类，以便鼠标光标变为链接样式。

我一直在努力做到最好，但到目前为止还没有运气。

因此，例如，这是 5 月的前三周，今天的班级名为：

```
<table class="calendar">
    <tbody>
        <tr class="week0">
            <td class="day">30</td>
            <td class="day">1</td>
            <td class="day">2</td>
            <td class="day">3</td>
            <td class="day">4</td>
            <td class="day">5</td>
            <td class="day">6</td>                                                                  
        </tr>
        <tr class="week1">
            <td class="day">7</td>
            <td class="day">8</td>
            <td class="day">9</td>
            <td class="day">10</td>
            <td class="day">11</td>
            <td class="day">12</td>
            <td class="day">13</td>                                                                 
        </tr>
        <tr class="week2">
            <td class="day">14</td>
            <td class="day">15</td>
            <td class="day">16</td>
            <td class="day">17</td>
            <td class="day">18</td>
            <td class="day today">19</td>
            <td class="day">20</td>                                                                 
        </tr>               
    </tbody>
</table> 
```

我想选择从 30（天）到 19 的 tds。

采取的方法：

*   选择所有日期，然后尝试查找今天单元格的索引。失败，因为 jQuery 选择不是数组而是对象。
*   一旦达到使用`$.each`和使用标志。`today`这行得通，但听起来对性能真的很糟糕[？]

有没有我想念的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:20:35.537

获取`.today`所有`td`元素中的索引并根据该索引进行选择：

```
// Get the index of td.today among all td's
var tIndex = $(".today").index("td") + 1;

// Select all td's below (and including) .today
$("td:lt(" + tIndex + ")").css("background-color", "red");​ 
```

演示：http: [//jsfiddle.net/UNXve/](http://jsfiddle.net/UNXve/)

# git - 颠覆到 Git：克隆创建分支？

> ID：10660781
> 
> 赞同：2
> 
> 时间：2012-05-18T23:02:15.677
> 
> 标签：git, svn, clone, git-svn

我正在将一个大型（> 6500 次提交）Subversion 存储库转换为 Git 存储库，并且遇到了一些问题，希望有人能提供帮助。这是我所在的位置：

我创建了远程存储库的本地 Subversion 存储库备份。我正在使用以下方法将该存储库转换为 Git：

```
git svn clone svn://localhost/svn gitrepo –no-metadata -A authors-transform.txt -t tags -b branches -T trunk 
```

这确实创建了一个 Git 存储库，但是当它这样做时，它会创建一些看起来像提交编号的附加分支。我绝对不打算让那些人在那里。从克隆中清理一点后，我的“.git/refs/heads/”文件夹如下所示：

```
branch1
branch1@6701
branch1@6736
branch2
branch3
branch4
master
trunk 
```

git svn clone 有什么理由这样做吗？这些提交中是否有一些东西可能会创建一个全新的分支？

另外，在我将这个新创建的 Git 存储库推送到 GitHub 之前，我是否应该同时拥有一个 master 和一个 trunk 分支？我不确定 Git / GitHub 到底要寻找什么。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T01:03:36.307

如果我没记错的话， refs/remotes/XXX@rev 分支是为删除的分支创建的。假设它们没有被创建。然后 refs/remotes/XXX 分支不存在到（因为它在 SVN 中被删除了）。然后 Git 提交对应的已删除 SVN 分支无法从任何 Git 分支访问，因此可以作为垃圾收集。如果您看到 refs/remotes/XXX 和 refs/remotes/XXX@rev 都存在，这可能意味着分支已被替换。但不幸的是，据我所知，git-svn 会为分支替换创建合并提交，从历史翻译的角度来看，这是绝对错误的。

相反，对于 SVN->Git 迁移，请查看另外两个项目。第一个是[SubGit](http://subgit.com)，如果您可以访问您的 SVN 服务器，则推荐使用它。它将替换作为替换处理，合并作为合并；但也会翻译忽略、svn:eol 风格的属性（对应的 .gitattributes 值）、标签等。

如果您无权访问 SVN 服务器，另一种选择是[SmartGit 。](http://www.syntevo.com/index.html)它还提供了合理的翻译（合并到合并，忽略到忽略），还可以将 svn:externals 转换为显示为模块的 .gitsvnextmodules 文件。

# php - 地板功能不起作用

> ID：10660787
> 
> 赞同：0
> 
> 时间：2012-05-18T23:03:44.610
> 
> 标签：php, floor

鉴于以下鳕鱼：

```
 $number = 1050.55;
 var_dump($number - floor($number)); 
```

为什么上面的代码会返回以下结果？

```
float(0.54999999999995) 
```

在这种情况下，我想要一个像 0.55 这样的固定值。你能帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T23:13:34.057

浮点运算不精确，余数错误很常见。如果您知道，您想要的精度是多少（例如，点后的两位数），您可以对结果使用 round() 函数。在这种情况下，这将是：

```
$number = 1050.55;
var_dump(round($number - floor($number), 2)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T23:35:08.050

对于大多数浮点数，二进制只能近似表示正确的数字。规则是在一系列计算中最后执行 floor()、ceil() 或 fmod()。至少在你使用它们之后才做整数数学。如果您将 int 转换为浮点数，就像在您的代码中一样，那么 floor() 不会像您期望的那样表现。

打印浮点数时使用 printf()。它的转换例程通常做得更好，并在截断浮点数时为您提供您期望的答案。

编辑：或者，更准确地说， printf() 在决定截断位置时处理数字的十进制字符表示，因此您不会得到任何奇怪的、未指定的二进制/十进制转换伪影。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T23:09:52.383

看到[这个问题](https://stackoverflow.com/questions/9902968/why-does-math-round0-49999999999999994-return-1/9903075#9903075)。虽然那是关于 java 并且你问的是 PHP，但数学是一样的。

# php - 从具有不同列数的两个表中选择 *

> ID：10660788
> 
> 赞同：5
> 
> 时间：2012-05-18T23:03:53.303
> 
> 标签：php, mysql, sql, mysql-error-1222

如何从两个不同的表中选择不同的列，例如：

```
SELECT username, email FROM `table1` 
UNION
 SELECT * FROM `table2` WHERE username = 'user1'; 
```

我收到一个错误`"#1222 - The used SELECT statements have a different number of columns"`。据我了解 UNION 将不起作用，

有没有办法做到这一点，因为我需要不相等数量的列和行**，并且**两个表中没有相互/相似的条目（即 user1 未列在 table1 中）？

这不能在一个查询中完成吗？

谢谢你！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T23:06:54.627

您可以`fake`使用别名丢失列 - 例如

```
 SELECT username, email, '' as name FROM `table1` 
 UNION
 SELECT username, email, name FROM `table2` 
 WHERE username = 'user1'; 
```

其中名称在表 2 中，但不在表 1 中

除非您将 UNIONS 与 JOINS 混淆：

```
SELECT table1.*, table2.* FROM
table1 INNER JOIN table2
ON table1.username = table2.username 
```

这将合并两个表，因此您将所有列都放在同一行上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T23:06:33.593

如果两个表中没有相互或相似的条目，则它们应该是两个不同的选择语句。

```
SELECT username, email FROM `table1`;

SELECT * FROM `table2` WHERE username = 'user1'; 
```

你这样做的动机是什么？

中的条目是否`table2`与 相关`table1`？会`join`更合适吗？

```
SELECT t1.username, t1.email, t2.*
FROM table1 t1
    JOIN table2 t2 ON t1.username = t2.username
WHERE t1.username = 'user1'; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-18T23:07:07.777

在列较少的表中，尝试

```
SELECT *, 0 as col1, 0 as col2, ... 
```

等以使它们具有相同的列数。

# css - 无法居中跨度元素

> ID：10660789
> 
> 赞同：0
> 
> 时间：2012-05-18T23:03:59.460
> 
> 标签：css, knockout.js, html

我的网页顶部有三个项目。我希望它们位于左侧、中间和右侧。然而，中间的那个是个混蛋（部分是因为它是在游戏后期创建的）。我已经尝试了自动保证金技巧，但没有运气。我已经尝试过相对定位，但不能让它完全居中（它会利用它的邻居）。在下面的完整代码中，你可以让“showInMiddle”居中吗？您需要单击该项目的登录按钮才能显示。理想情况下，如果页面太窄，项目会换行但仍保持对齐（而不是在彼此顶部或全部在左侧绘制）。

```
<!DOCTYPE html>
<html>
<head>
    <title>This is dumb</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://knockoutjs.com/js/knockout-2.1.0.js"></script>
</head>
<body style="font-family: 'Segoe UI'; margin: 5px 20px;">

<header style="width: 100%">

<h4 id="showOnLeft" style="font-size: 1.1em; display: inline;">I'm the title</h4>

<span id="showInMiddle" data-bind="visible: LoggedIn">
    I'm supposed to be in the middle with my two buttons.
    <button>B1</button>
    <button>B2</button>
</span>

<div id="showOnRight" style="display: inline; float: right">
    <form id="someLoginForm" style="display: inline;" data-bind="visible: !LoggedIn(), submit: login" action="" method="post">
        <input type="text" placeholder="Username" />
        <input type="password" placeholder="Password" />
        <input type="submit" value="Login" />
    </form>
    <form id="someLogoutForm" style="display: inline;" data-bind="visible: LoggedIn(), submit: logout" action="" method="post">
        <span>Howdy</span>
        <input type="submit" value="Logout" />
    </form>
</div>

<nav><hr/></nav>

</header>

<script type="text/javascript">

    function LoginViewModel() {
        var self = this;
        self.LoggedIn = ko.observable(false);
        self.login = function (formElement) { self.LoggedIn(true); };
        self.logout = function (formElement) { self.LoggedIn(false); };
    }

    ko.applyBindings(new LoginViewModel());

</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:18:06.920

您不能将跨度居中，因为它是默认情况下不知道其宽度的内联元素。

您可以像这样简单地将 span 替换为 div（观看内联 CSS）：

```
<div id="showInMiddle" data-bind="visible: LoggedIn" style="text-align:center ">
I'm supposed to be in the middle with my two buttons.
<button>B1</button>
<button>B2</button>
</div> 
```

这很快——我要回家了。尝试调整登录表单的宽度。你需要注意的是，floatdiv 的总数永远不能超过容器的总数，否则会出错。

```
<!DOCTYPE html>
<html>
    <head>
        <title>
            This is dumb
        </title>
        <style>
        #container {
            width:900px; 
            margin: auto 0; 
            overflow: auto;           

        }        
        .floatdiv {
            float:left;

            margin:0;                        

        }

        </style>        

    </head>  

    <body style="font-family: 'Segoe UI'; margin: 5px 20px;">
    <div id="container">

            <div class="floatdiv" style="font-size: 1.1em; width:200px">
                I'm the title                                                                
            </div>
            <div class="floatdiv" id="showInMiddle" data-bind="visible: LoggedIn" style="text-align:center; width:300px ">

                <button>
                    B1
                </button>
                <button>
                    B2
                </button>             
            </div>
            <div class="floatdiv" id="showOnRight" style="width:300px; float:right; text-align:right">
                <form id="someLoginForm" style="" data-bind="visible: !LoggedIn(), submit: login" action="" method="post">
                    <input type="text" placeholder="Username" />
                    <input type="password" placeholder="Password" />
                    <input type="submit" value="Login" />
                </form>
                <form id="someLogoutForm" style="" data-bind="visible: LoggedIn(), submit: logout" action="" method="post">
                    <span>
                        Howdy
                    </span>
                    <input type="submit" value="Logout" />
                </form>
            </div>

        </header>
  </div>        

    </body>

</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T00:35:37.690

最后，当您使用桌子时，它可以完美地工作。谁知道？

```
<!DOCTYPE html>
<html>
<head>
    <title>This is dumb</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://knockoutjs.com/js/knockout-2.1.0.js"></script>

    <style type="text/css">
        table, tr, td, h4, div { margin: 0px; padding: 0px; }
    </style>
</head>
<body style="font-family: 'Segoe UI'; margin: 5px 20px;">

<header style="width: 100%">

<table style="width: 100%; border-width: 0px;">
<tr>
<td><h4 id="showOnLeft" style="font-size: 1.1em;">I'm the title</h4></td>
<td>
<div id="showInMiddle" data-bind="visible: LoggedIn" style="text-align: center;">
    I'm supposed to be in the middle with my two buttons.
    <button>B1</button>
    <button>B2</button>
</div>
</td>
<td>
<div id="showOnRight" style="text-align: right;">
    <form id="someLoginForm" style="display: inline;" data-bind="visible: !LoggedIn(), submit: login" action="" method="post">
        <input type="text" placeholder="Username" />
        <input type="password" placeholder="Password" />
        <input type="submit" value="Login" />
    </form>
    <form id="someLogoutForm" style="display: inline;" data-bind="visible: LoggedIn(), submit: logout" action="" method="post">
        <span>Howdy</span>
        <input type="submit" value="Logout" />
    </form>
</div>
</td>
</tr>
</table>

<nav><hr/></nav>

</header>

<script type="text/javascript">

    function LoginViewModel() {
        var self = this;
        self.LoggedIn = ko.observable(false);
        self.login = function (formElement) { self.LoggedIn(true); };
        self.logout = function (formElement) { self.LoggedIn(false); };
    }

    ko.applyBindings(new LoginViewModel());

</script>

</body>
</html> 
```

# akka - Akka Actor 创建问题

> ID：10660794
> 
> 赞同：0
> 
> 时间：2012-05-18T23:04:42.223
> 
> 标签：akka

我正在尝试创建一个可以远程和本地访问的演员。下面创建的演员抛出异常。任何想法？

`val myLocalActor2 = system.actorOf(Props[ActorNodes], name = "akka://JtsSystem@127.0.0.1:2552/MyOwnRef")`

这是以编程方式创建本地和远程参与者的最佳和唯一方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T11:18:13.557

actorOf 中的“名称”只是一个路径段。这将识别新创建的演员。有关详细信息，请参见此处：http: [//doc.akka.io/docs/akka/2.0.1/general/addressing.html](http://doc.akka.io/docs/akka/2.0.1/general/addressing.html)

此外，拥有本地和远程的东西没有意义，但我认为你的意思是它应该是本地的并且可以从某个远程节点访问？如果是这样，只需使用actorOf创建它，其他节点可以使用“actorFor”查找它：

```
val remoteActor = system.actorFor("akka://CalculatorApplication@127.0.0.1:2552/user/simpleCalculator") 
```

在此处阅读更多信息：http: [//doc.akka.io/docs/akka/2.0.1/scala/remoting.html](http://doc.akka.io/docs/akka/2.0.1/scala/remoting.html)

一般来说，请阅读文档，我们已经投入了很多时间，当人们不阅读它时感觉很浪费。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T12:31:57.500

让它工作（除了全局注册表）：

```
case class ActorMsg(val msg: String)

sealed class ActorNodes extends Actor {
  override def receive = {
    case ActorMsg(msg) => println("Actor Msg " + msg)
    case _ => println("Everything else")
  }
}

object JtsListener extends App {
  val sys = "JtsSystem"
  val system = ActorSystem(sys)
//  println("System: " + system.settings)

  val myLocalActor1 = system.actorOf(Props[ActorNodes], "MyLocalRef")
  println("MyLocalActor 1: " + myLocalActor1 + " has path " + myLocalActor1.path)
  myLocalActor1 ! new ActorMsg("Hello")

  val myLocalActor2 = system.actorFor("akka://"+sys+"@127.0.0.1:2552/user/MyLocalRef");
  println("MyLocalActor 2: " + myLocalActor2 + " has path " + myLocalActor2.path)
  myLocalActor2 ! new ActorMsg("Hello Again")
} 
```

使用 application.conf （我正在考虑在 ActorSystem 上以编程方式执行此操作

谢谢。

下一步将是广播该信息，以便所有服务都知道每个参与者的位置......可能使用那里概述的想法：

[http://blog.vasilrem.com/even-simpler-scalability-with-akka-through-re](http://blog.vasilrem.com/even-simpler-scalability-with-akka-through-re)

# java - 应用架构：请求处理

> ID：10660797
> 
> 赞同：1
> 
> 时间：2012-05-18T23:05:07.230
> 
> 标签：java, multithreading, jakarta-ee, servlets, architecture

我有以下问题：

我正在编写一个带有 servlet 和 JSP 的 Web 应用程序，它应该查询一个单独的服务。但是查询需要很长时间——大约 30 秒。

我的应用程序的结构很简单——Filter->Controller->jsp。我在想，如果在过滤器中我将请求发送到一个单独的线程中进行处理，而控制器继续执行其工作。我应该怎么做才能使查询过程和控制器处理同时进行？+ 我需要每 5 分钟更新一次查询（以便用户获得相关信息）。这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T19:36:31.360

当 Web 应用程序启动时，使用 ServletContextListener 启动线程。

线程应该将数据写入 ServletContext（例如通过 setAttribute()）。

ServletContextListener 应该在应用程序停止时终止线程。

Servlet 应该根据需要从 ServletContext 读取数据。

# java - Java“无法从元素类型对象转换为字符串”

> ID：10660800
> 
> 赞同：1
> 
> 时间：2012-05-18T23:05:36.713
> 
> 标签：java

```
/*     */   public static void printJoinChat(Player player) {
/*  41 */     FileConfiguration kitConfig = YamlConfiguration.loadConfiguration(new File(plugin.getDataFolder(), "kit.yml"));
/*  42 */     List kitname = kitConfig.getStringList("KITS");
/*     */ 
/*  44 */     String vipkit = "";
/*  45 */     String norkit = "";
/*  46 */     for (String name : kitname) {
/*  47 */       ConfigurationSection kit = kitConfig.getConfigurationSection(name.toLowerCase());
/*  48 */       if (kit.getBoolean("VIP")) {
/*  49 */         if (vipkit == "")
/*  50 */           vipkit = name;
/*     */         else {
/*  52 */           vipkit = vipkit + ", " + name;
/*     */         }
/*     */       }
/*  55 */       else if (norkit == "")
/*  56 */         norkit = name;
/*     */       else {
/*  58 */         norkit = norkit + ", " + name;
/*     */       }
/*     */ 
/*     */     } 
```

此代码在第 46 行返回错误“类型不匹配：无法从元素类型 Object 转换为 String”。为什么会出现此错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T23:06:54.763

改成这样：

```
 List<String> kitname = kitConfig.getStringList("KITS"); 
```

确保该方法返回 a`List<String>`而不仅仅是 a `List`。

# objective-c - 协议定义中的编译器错误“预期类型”

> ID：10660803
> 
> 赞同：1
> 
> 时间：2012-05-18T23:05:49.027
> 
> 标签：objective-c, compiler-errors, protocols

我有两个定义协议的文件，用于实现观察者模式，并且我从其中一个文件中收到编译器错误。

```
// ObserverDelegate.h
#import <Foundation/Foundation.h>

@protocol ObserverDelegate <NSObject>
@required
@end

// ObservableDelegate.h
#import <Foundation/Foundation.h>
#import "ObserverDelegate.h"
@protocol ObservableDelegate <NSObject>
@required
-(void) addObserver: (ObservableDelegate*) observer; // ERROR ON THIS LINE WHEN COMPILE
@end 
```

我只有 .h 文件`ObserverDelegate`和`ObservableDelegate`，没有对应的 .m 文件。

错误在 ObserveableDelegate.h 中显示“预期类型”`-(void) addObserver: (ObservableDelegate*) observer;`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T23:12:08.473

`ObservableDelegate`不是类型，它是协议的名称。您不能将其用作方法参数的类型。如果你想要求方法的参数符合那个协议，你可以这样表达：

```
- (void)addObserver: (id<ObservableDelegate>)observer; 
```

这表示该方法采用`id`符合`ObservableDelegate`. 您可以使用比`id`您想要的更具体的类型，并且您知道，例如，委托也应该始终是`UIViewController`子类。

# javascript - JQuery显示/隐藏不工作IE7

> ID：10660805
> 
> 赞同：1
> 
> 时间：2012-05-18T23:06:06.093
> 
> 标签：javascript, jquery, html, css, internet-explorer-7

显示/隐藏在 IE7 中不起作用。在其他浏览器中工作正常。请帮帮我。难道我做错了什么？

```
<div id="secondary_nav" class="box">                    
    <ul>    
        <li><a href="">test</a></li>
        <ul class="sub-menu" style="height: 336px; display: none;">
            <li><a href="">test</a></li>            
        </ul>
    </ul>                
</div>

 <script type="text/javascript">
$(document).ready(function() {
    $("#secondary_nav ul li").hover(function() {
            $(this).next(".sub-menu").show();
            $(this).next(".sub-menu").hover(function() {
                    $(this).show();
                }, function() {$(this).hide();}
            );
        },function() {$(this).next(".sub-menu").hide();}
    );
});
 </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:13:21.437

您首先需要修复您的标记。子菜单与`li`代表它的链接相同：

```
<div id="secondary_nav" class="box">                    
  <ul>    
    <li>
      <a href="">test</a>
      <ul class="sub-menu" style="height: 336px; display: none;">
        <li><a href="">test</a></li>            
      </ul>
    </li>
  </ul>                
</div> 
```

`$.hover()`接下来，您在第一个悬停状态下执行附加嵌套悬停的位置存在一些问题。让我们也清理一下：

```
$(function(){
  $("#secondary_nav > ul > li").hover(
    function(){ $(".sub-menu", this).show(); },
    function(){ $(".sub-menu", this).hide(); }
  );
}); 
```

小提琴：http: [//jsfiddle.net/4KFac/](http://jsfiddle.net/4KFac/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T23:18:06.107

它对我来说很好[http://jsfiddle.net/Ln8ep/1/](http://jsfiddle.net/Ln8ep/1/)
尝试使用`$(document).ready(function() {`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T23:10:34.510

HTML 代码已损坏。您不能将`ul`标签直接放在另一个`ul`标签内。

# apache - 如果直接从 url 打开，则使用 htaccess 拒绝访问 js 文件

> ID：10660807
> 
> 赞同：0
> 
> 时间：2012-05-18T23:06:16.253
> 
> 标签：apache, .htaccess

我是 htaccess 的菜鸟，所以我需要一些帮助！我想拒绝访问一个 js 文件，如果它是从 url 栏前打开的（当我在地址栏中键入[http://mysite.com/js/jquery.js](http://mysite.com/js/jquery.js)时 - 我得到一个 403）但是当网站是由浏览器渲染，正常下载到浏览器。

目前我正在尝试这个

```
 <Files ~ "(.js|.css)">
    Order allow,deny
    deny from all
    </Files> 
```

但这会阻止浏览器使用 css 和 js，所以我想制定一种规则来让浏览器而不是任何人直接来自 url。在这种情况下可以使用引用者或主机或类似的东西吗？

（注意：我不想阻止客户查看 js 代码，因为他们无论如何都可以这样做，但我有我的理由）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T23:12:54.293

这与防止图像盗链相同。请参阅[http://altlab.com/htaccess_tutorial.html](http://altlab.com/htaccess_tutorial.html)。

IE：

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^http://(.+\.)?mysite\.com/ [NC]
RewriteRule .*\.(js|css)$ - [F] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T23:21:53.023

在您的 index.php 中设置一个 Cookie 值，该值指示您的 js.php 文件（将您的 js 代码存储在 php 文件中并将其回显到浏览器）如果在您的主页上发出请求。如果未设置 cookie，则发送 404，否则回显 js 代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-21T13:36:48.417

Reddit 帖子[https://stackoverflow.com/a/10660862/4766489](https://stackoverflow.com/a/10660862/4766489) 正确答案：

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^http(s)?://(.+\.)?mysite\.com/ [NC]
RewriteRule .*\.(js|css)$ - [NC,F,L] 
```

# jquery - 单击蓝色时突出显示文本框

> ID：10660810
> 
> 赞同：0
> 
> 时间：2012-05-18T23:06:45.437
> 
> 标签：jquery, html, css

好的，所以当您单击文本机器人登录时，某些网站（如 twitter 等）会突出显示为蓝色。我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T23:19:30.333

好吧，如果是 twitter，你可以看看 bootstrap.css 代码。我认为以下 css 可以解决问题（从 bootstrap.css 中取出）：

```
input:focus, textarea:focus {
  border-color: rgba(82, 168, 236, 0.8);
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(82, 168, 236, 0.6);
  -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(82, 168, 236, 0.6);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(82, 168, 236, 0.6);
  outline: 0;
  outline: thin dotted \9;
  /* IE6-9 */

} 
```

参考：

*   [http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T23:21:06.567

来自 Twitter 的相关 CSS

```
textarea {
    border: 1px solid #ccc;
    border-radius: 4px;
    outline: none;
}

textarea:focus {
    border-color: #56B4EF;
    box-shadow: inset 0 1px 3px rgba(0,0,0,.05),0 0 8px rgba(82,168,236,.6);
    -webkit-box-shadow: inset 0 1px 3px rgba(0,0,0,.05),0 0 8px rgba(82,168,236,.6);
}​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T01:06:58.737

检查这个[jsfiddle](http://jsfiddle.net/ah26/K9bKD/1/)。您可以通过替换 #56B4EF 来更改颜色

```
 input:focus {
 outline: none;
 box-shadow: 0px 0px 7px #56B4EF;
 border-color: #56B4EF; 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-18T23:18:21.413

将 CSS 应用于文本框，例如`border-color:blue;`on`click`或`focus`event。

# c++ - 布尔表达式习语中的这个字符串文字是什么？

> ID：10660816
> 
> 赞同：12
> 
> 时间：2012-05-18T23:07:10.583
> 
> 标签：c++, c

我的一位同事正在查看我们继承的一个代码库，发现以下行：

`ATLASSERT( rtaddress == m_lRTAddress && "Creation settings should match FIFO" );`

我们不明白字符串文字的用途是什么；不仅仅是评论吗？我看到它的方式，如果`rtaddress`不等于，`m_lRTAddress`那么由于短路，字符串将永远不会被评估。如果`rtaddress`DOES 相等`m_lRTAddress`，则将评估字符串文字，但为布尔表达式评估的字符串文字将始终返回`true`; 那有什么意义呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T23:11:54.473

我认为如果断言失败，您可以看到添加断言的原因。

# linux - 更高效地使用apache？

> ID：10660819
> 
> 赞同：0
> 
> 时间：2012-05-18T23:07:55.870
> 
> 标签：linux, apache

我有一个在 ec2 上运行的 django 应用程序。这是一个微型实例，我看到 62% 的内存被一个用户为零的应用程序消耗。这对我来说似乎很高，所以我做了：

```
$ ps aux|grep apache
root      9318  0.0  1.4 204924  9052 ?        Ss   23:01   0:00 /usr/sbin/apache2 -k start
ubuntu    9323  0.1  4.7 234824 28588 ?        S    23:01   0:00 /usr/sbin/apache2 -k start
ubuntu    9324  0.1  4.7 235176 28780 ?        S    23:01   0:00 /usr/sbin/apache2 -k start
ubuntu    9325  0.1  4.8 235536 29088 ?        S    23:01   0:00 /usr/sbin/apache2 -k start
ubuntu    9326  0.1  4.7 234808 28564 ?        S    23:01   0:00 /usr/sbin/apache2 -k start
ubuntu    9327  0.1  4.7 234952 28620 ?        S    23:01   0:00 /usr/sbin/apache2 -k start
ubuntu    9328  0.1  4.7 235136 28892 ?        S    23:01   0:00 /usr/sbin/apache2 -k start
ubuntu    9329  0.1  4.6 234856 28140 ?        S    23:01   0:00 /usr/sbin/apache2 -k start
ubuntu    9330  0.1  4.8 235480 29356 ?        S    23:01   0:00 /usr/sbin/apache2 -k start 
```

为什么这里有这么多流程？所有这些过程在做什么？有没有办法让这更有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:20:44.403

这可能取决于您使用的 Apache 工作程序，但 Apache 很可能会为每个传入连接使用单独的进程。为了快速处理传入的连接，它保持一个连接处理程序池打开，这就是为什么有这么多进程的原因。

内存使用水平将是因为，无论用户数量如何，Apache 都必须将所有/大部分应用程序、Django、Python 和您正在使用的任何第三方应用程序保留在内存中，以便能够有效地为站点提供服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T15:36:43.850

对于您的情况，这是由于您的配置引起的。尝试在您的配置中使用 StartServers、MinSpareServers 和 MaxSpareServers 来调整它。有关调整的更多信息和选项，请参见[此处](http://linuxstuffs.wordpress.com/apache-optimization/)

此外，如果您运行“免费”命令，您可能会看到大部分 62% 的内存被缓存为缓冲区，以便 apache 准备好更快地服务。**如果您需要它，它将分配给您的应用程序，并且缓冲区将被删除**。

# javascript - 我应该如何删除这些 基于时间的元素？

> ID：10660820
> 
> 赞同：1
> 
> 时间：2012-05-18T23:08:01.363
> 
> 标签：javascript, jquery

我`<li>`在页面加载上有 5 个元素。

`<li>`每隔几秒随机添加其他元素。我需要删除`<li>`页面上超过一分钟的元素。

我正在考虑有一个属性，称为`data-created-at`存储添加时间的属性。然后有一个循环函数（通过 js，在同一页面中）检查`<li>`要删除的元素。

如果以上是一个合理的方法。`data-created-at`我应该以毫秒为单位存储时间吗？

好主意？还是有更好的方法来解决这个问题？+1 对于提供代码片段及其描述的任何人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T23:13:24.643

我不确定这是否是一个更好的选择，但是您不能`setTimeout`在创建元素后一分钟就使用它们来设置有计划的破坏吗？

有人要求详细说明，所以我会尽力而为。这将有点伪代码。

```
new_guy = $("<li>Some wonderful text</li>");
insert(new_guy);
setTimeout(function() { delete(new_guy); }, 60000); 
```

你已经定义了一个 function`insert`和一个 function `delete`，其中 insert 将你的 new 实际插入`<li>`到你的 HTML 中，并`delete`在 60 秒后被调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T23:09:49.920

上面是一个很好的方法，尤其是在属性中使用与计算机上本地时间相匹配的时间戳。（不要让服务器添加属性，让 JavaScript 这样做以便它具有可比性。）

你的“循环”功能应该是这样的：

```
setInterval(function(){
  var staleTime = (new Date).getTime() - 60*1000;
  $('li[data-created-at]').find(function(){
    return $(this).data('created-at')*1 < staleTime;
  }).detach();
},1000); // check every 1 second 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T23:11:19.193

好吧，jQuery在设置时`.data`不使用`data-`属性，但我会完全按照您的描述进行操作：

```
setInterval(function() {
    $('li').each(function() {
        var $this = $(this);

        if(new Date().getTime() - $this.data('created-at') >= 60000) {
            // It's been a minute
            $this.remove();
        }
    });
}, 1000); 
```

当然，如果你有一个现有的`setInterval`/`setTimeout`循环，把它放在那里。

# matlab - 在灰度图像 MATLAB 上绘制掩码

> ID：10660824
> 
> 赞同：2
> 
> 时间：2012-05-18T23:08:23.630
> 
> 标签：matlab, plot, grayscale

我正在运行一种算法来使用形态学操作分割图像的一部分。我最终得到一个代表分割结果的二维二值图像。也就是面具。我的问题是如何在其上绘制原始图像和彩色蒙版覆盖。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T23:27:12.040

您可以使用[`imoverlay`](http://www.mathworks.com/matlabcentral/fileexchange/10502-image-overlay)Steve Eddins 编写的。

此外，您可以查看他的这些博客文章：

*   [使用透明度的图像可视化](http://blogs.mathworks.com/steve/2008/08/20/image-visualization-using-transparency/)
*   [使用透明度的图像叠加](http://blogs.mathworks.com/steve/2009/02/18/image-overlay-using-transparency/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-19T03:34:56.077

使用`imoverlay`很好，我自己这样做，但我经常想要一个透明的复合材料。将它放在一个数组中很方便，因为它使保存图像更容易一些。

```
alpha = repmat(0.35 * mask,[1 1 3]);
labels = label2rgb(bwlabel(mask));
im3 = repmat(im,[1 1 3]); %# Assuming image is grayscale
overlay = ( (1-alpha) .* im3 ) + ( alpha .* labels );
imshow(overlay); %# Or imwrite, etc. 
```

# curl - 从 S3 下载文件并使用 cURL 重定向

> ID：10660827
> 
> 赞同：1
> 
> 时间：2012-05-18T23:08:31.597
> 
> 标签：curl, amazon-s3

我正在尝试以编程方式从 S3 上的安全存储桶下载 zip 文件，一旦下载发送到浏览器，我希望显示收据页面。

但我不断收到各种输出到浏览器的疯狂字符：

```
$url = "https://s3.amazonaws.com/{$bucket}/{$resource}?{$authentication_params}";

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 0);
curl_setopt($ch, CURLOPT_TIMEOUT, 30);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('response-content-type: application/zip', 'response-content-disposition: attachment', 'Expect: 100-continue'));
$response = curl_exec($ch);
curl_close($ch); 
```

如果我`$url`在 firefox 的地址栏中输入，下载就可以了。如何下载文件然后继续到我的收据页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:27:07.343

您需要指定带有扩展名的目标文件名才能正确下载 zip 文件。
因此，例如，如果您想下载位于 www.url.com/myzip.zip 的 zip 文件，您需要提供带有目标文件名的 -o 参数。

-o 告诉 curl 将下载的内容保存到文件中，如果没有此参数，curl 将仅显示文件内容，在您的情况下为二进制文件。
例子： `curl -o dave.zip https://www.url.com/myzip.zip`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:54:14.290

我最终只是简单地颠倒了我的流程顺序并为此使用了元刷新标头。

# jquery - 工具提示淡入淡出又好又慢

> ID：10660832
> 
> 赞同：2
> 
> 时间：2012-05-18T23:09:14.827
> 
> 标签：jquery, css, image, tooltip

我为网站创建了一个小工具提示，但我想让 fadeIn 和 fadeOut 非常平滑..

我有这个，并且希望对我应该如何做的任何帮助以及对我将来应该如何构建它的方式进行一些解释，所以我知道，（jQuery的新手！）

```
<script>
  $(function() {
      $("#logo img[title]").tooltip();
    });
</script> 
```

那么我如何让这个淡入淡出，我尝试了很多替代品，但我知道我把东西放在了错误的地方，对你们中的一些人来说可能是一件容易的事！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:58:13.087

如果您正在谈论 jQuery 的[Tooltip](http://docs.jquery.com/Plugins/Tooltip)插件，您可能希望它设置淡入淡出：

```
$("#logo img[title]").tooltip({ fade: 250 }); 
```

# unix - 从计数文件中获取概率

> ID：10660835
> 
> 赞同：2
> 
> 时间：2012-05-18T23:09:32.533
> 
> 标签：unix, math, awk, terminal

我有一堆文件看起来像这样

```
 54 apples
  7 oranges
  1 bananas 
```

我想得到每一个的概率。也就是说，我想要以下内容：

```
 0.87 apples
 0.11 oranges
 0.02 bananas 
```

我可以轻松地为每个文件单独计算总和

```
awk '{sum += $1} END {print sum}' input.txt 
```

但我想知道如何计算概率。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T23:25:49.500

除非您想两次运行该文件，否则您需要将所有行存储在内存中。

```
awk '{sum += $1; line[NR,1] = $1; line[NR,2] = $2} END{for(i=0; i<NR; i++) print line[i,1]/sum, line[i,2]}' file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T09:55:10.593

可能会更改顺序

```
awk '{n[$2]=$1} END {for (fruit in n) printf("%.2d %s\n", n[fruit]/NR, fruit)}' file 
```

或保留订单

```
awk -v lines="$(wc -l < file)" '{$1 = sprintf("%.2d", $1/lines}; print' file 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-19T01:30:45.960

这是规范`awk`的，不会将文件存储在内存中：

`awk 'FNR==NR { sum += $1; next; } { printf "%.2f %s\n", $1/sum, $2 }' input.txt{,}`

高温高压

# scala - scalaz 中有 >> monad 运算符吗？

> ID：10660836
> 
> 赞同：3
> 
> 时间：2012-05-18T23:09:33.367
> 
> 标签：scala, functional-programming, scalaz

如果没有 Haskell 的 >> (monad replace?) 运算符，我可以在 scalaz 中执行此操作：

```
val m3 = for {
  _ <- m1
  r <- m2
} yield r 
```

Scalaz（6）中有这样的运算符吗？到这里后，是否有任何辅助操作，例如展平/连接等？这些在哪里定义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T23:58:56.380

有`>>=|`别名`>|>`并`*|`在[scalaz/MA.scala](https://github.com/scalaz/scalaz/blob/master/core/src/main/scala/scalaz/MA.scala)中定义。

# java - 制作文本命令，例如为文本着色

> ID：10660847
> 
> 赞同：1
> 
> 时间：2012-05-18T23:11:10.007
> 
> 标签：java, swing, user-interface, text, jtextarea

我想创建一种可以分析 a 的方法，`String`并且每当`/r`找到文本命令（例如，将文本变为红色）时，不会显示文本命令并将其应用于命令后面的文本。

例如，一个字符串：

```
"Hello /rworl/bd" 
```

输出如下：

```
"Hello world" 
```

但`"Hello worl"`将是红色文本，最终`d`将是蓝色。我知道如何更改文本颜色，使其变为粗体等。

在命令后选择文本的好方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T02:10:00.340

我找不到在 JTextArea 上使用多种字体的好方法，但在这里它使用标签和 html。当你输入的字母会是黑色的。如果您按“/”，它将等待文本字符来决定颜色。如果然后按“r”，则以下字母的字体将设置为红色，“b”为蓝色。

```
public class TextColour implements KeyListener {
    JLabel label;
    String red = "<font color='FF0000'>";
    String blue = "<font color='0000FF'>";
    String text = "";
    boolean colour = false;

    public static void main(String[] args) {
        new TextColour();

    }

    public TextColour() {
        JFrame frame = new JFrame();
        JTextArea area = new JTextArea();

        area.addKeyListener(this);
        label = new JLabel();

        frame.setPreferredSize(new Dimension(400, 100));
        frame.getContentPane().add(area);
        frame.getContentPane().add(label);

        frame.pack();
        frame.setVisible(true);
    }

    @Override
    public void keyPressed(KeyEvent key) {
        char letter = key.getKeyChar();
        if (colour) {
            if (letter == 'r') {
                text += red;
            } else if (letter == 'b') {
                text += blue;
            }
            colour = false;
        } else if (letter == '/') {
            colour = true;
        } else {
            text += key.getKeyChar();
        }
        label.setText("<html>" + text + "</html>");
    }

    @Override
    public void keyReleased(KeyEvent arg0) {
    }

    @Override
    public void keyTyped(KeyEvent arg0) {
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T04:52:45.403

`JTextArea`是纯文本的组件。可以设置一种字体、样式和大小，以及一种前景色和背景色。对于格式化的**不可编辑**文本，`JLabel`请按照@Glitch 的建议使用 a。对于**可编辑**的文本，请使用`JEditorPane`或之类的组件`JTextPane`。

请参阅教程的[如何使用编辑器窗格和文本窗格](http://docs.oracle.com/javase/tutorial/uiswing/components/editorpane.html)部分：更多详细信息、工作代码..和可爱的屏幕截图。:)

![在此处输入图像描述](../Images/834c1ab70fa7d80031c96fb5a99c0562.png)

# ios - 如何检查捆绑包中是否还有另一个 uiimage（同名）？

> ID：10660850
> 
> 赞同：0
> 
> 时间：2012-05-18T23:11:19.333
> 
> 标签：ios, uiimage, bundle

问题在标题中，我如何检查捆绑包中是否有另一个同名的图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T23:02:05.073

据我所知，没有办法在您的文档文件夹中检查具有相同名称的重复图像。所以我决定只为添加到 doc 文件夹中的图像创建一个管理器类，并以这种方式跟踪所有内容。

# ruby-on-rails-3 - 使用 rabl 和集合，无法添加额外的子节点

> ID：10660852
> 
> 赞同：5
> 
> 时间：2012-05-18T23:11:24.347
> 
> 标签：ruby-on-rails-3, json, rabl

我有一系列想在我的 json 响应中显示的文章。我还想导出一个关于所询问的 json 请求类型的节点。

# index.json.rabl

```
collection @articles => :headlines
extends 'articles/show' 
```

# 显示.json.rabl

```
object @article
attributes :foo 
```

所以去articles.json给了我：

```
 {"headlines":[{"foo":thing1},{"foo":thing2}]} 
```

我想做的是得到这样的结果：

```
{"rss":{"name":"articles","woot":"what?"},
{"headlines":[{"foo":thing1},{"foo":thing2}]} 
```

我尝试将 node(:rss) { "yadda yadda" } 放在 index.json.rabl 文件中，但这只会将 node :rss 添加到每篇文章中。

我尝试使用

```
 glue @article do
    node(:rss) { "yadda yadda" }
 end 
```

在索引和显示文件中，都没有像我希望的那样工作。

我已经尝试了很多其他的东西，但在这一点上我现在只是猜测。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T21:18:10.007

啊……我想通了。我决定不使用“collection @articles”

# index.json.rabl

```
object false
node(:rss) { partial('articles/rss.json.rabl', :object => @feedName) }

node :headlines do
  partial(@jsonView, :object => @articles)
end 
```

# gcc - 编译 MPC-0.8.1

> ID：10660856
> 
> 赞同：2
> 
> 时间：2012-05-18T23:11:51.493
> 
> 标签：gcc, installation, libtool, mpc

按照此处发布的说明：http://stackoverflow.com/questions/9450394/how-to-install-gcc-from-scratch-with-gmp-mpfr-mpc-elf

我安装了 GMP、MPFR 和 ELF 就好了，但是在安装 MPC 时

```
./configure --disable-shared --enable-static --prefix=/apps/name/gcc  --with-gmp=/apps/name/gcc --with-mpfr=/apps/name/gcc
make 
```

我收到以下错误：

```
/bin/sh ../libtool --tag=CC   --mode=link gcc -std=gnu99  -O2 -pedantic -m64 -mtune=k8 -version-info 2:0:0 -L/apps/name/gcc/lib -L/apps/name/gcc/lib  -o libmpc.la -rpath /apps/name/gcc/lib abs.lo acos.lo acosh.lo add.lo add_fr.lo add_ui.lo arg.lo asin.lo asinh.lo atan.lo atanh.lo clear.lo cmp.lo cmp_si_si.lo conj.lo cos.lo cosh.lo div_2exp.lo div.lo div_fr.lo div_ui.lo exp.lo fr_div.lo fr_sub.lo get_prec2.lo get_prec.lo get_str.lo get_version.lo imag.lo init2.lo init3.lo inp_str.lo log.lo mem.lo mul_2exp.lo mul.lo mul_fr.lo mul_i.lo mul_si.lo mul_ui.lo neg.lo norm.lo out_str.lo pow.lo pow_fr.lo pow_ld.lo pow_d.lo pow_si.lo pow_ui.lo pow_z.lo proj.lo real.lo urandom.lo set.lo set_prec.lo set_str.lo set_x.lo set_x_x.lo sin.lo sinh.lo sqr.lo sqrt.lo strtoc.lo sub.lo sub_fr.lo sub_ui.lo swap.lo tan.lo tanh.lo uceil_log2.lo ui_div.lo ui_ui_sub.lo  -lmpfr -lgmp 
libtool: link: warning: library `/apps/name/gcc/lib/libgmp.la' was moved.
libtool: link: ar cru .libs/libmpc.a  abs.o acos.o acosh.o add.o add_fr.o add_ui.o arg.o asin.o asinh.o atan.o atanh.o clear.o cmp.o cmp_si_si.o conj.o cos.o cosh.o div_2exp.o div.o div_fr.o div_ui.o exp.o fr_div.o fr_sub.o get_prec2.o get_prec.o get_str.o get_version.o imag.o init2.o init3.o inp_str.o log.o mem.o mul_2exp.o mul.o mul_fr.o mul_i.o mul_si.o mul_ui.o neg.o norm.o out_str.o pow.o pow_fr.o pow_ld.o pow_d.o pow_si.o pow_ui.o pow_z.o proj.o real.o urandom.o set.o set_prec.o set_str.o set_x.o set_x_x.o sin.o sinh.o sqr.o sqrt.o strtoc.o sub.o sub_fr.o sub_ui.o swap.o tan.o tanh.o uceil_log2.o ui_div.o ui_ui_sub.o
libtool: link: ranlib .libs/libmpc.a
/bin/sed: can't read /usr/local/lib/libgmp.la: No such file or directory
libtool: link: `/usr/local/lib/libgmp.la' is not a valid libtool archive
make[2]: *** [libmpc.la] Error 1
make[2]: Leaving directory `/apps/name/mpc-0.8.1/src'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/apps/name/mpc-0.8.1'
make: *** [all] Error 2 
```

任何想法如何解决它？它似乎在错误的目录中查找。

编辑：按照 Jon 链接的说明进行操作后，3 小时后出错

```
virtual memory exhausted: Cannot allocate memory 
```

make[5]: *** [gnu/java/nio/charset.lo] 错误 1 ​​make[5]: 离开目录`/apps/ddechev/gcc47/x86_64-unknown-linux-gnu/32/libjava' make[4]: *** [all-recursive] Error 1 make[4]: Leaving directory`/apps/ddechev/gcc47/x86_64-unknown-linux-gnu/32/libjava' make[3]: *** [multi-do] 错误 1 ​​make[3]: 离开目录`/apps/ddechev/gcc47/x86_64-unknown-linux-gnu/libjava' make[2]: *** [all-multi] Error 2 make[2]: Leaving directory`/apps/ddechev/gcc47/x86_64-unknown-linux-gnu/libjava' make[1]: *** [all-target-libjava] 错误 2 make[1 ]: 离开目录

知道为什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-19T04:35:17.913

您遵循的说明不是很好。有关构建 GCC 的最简单方法，请参见[http://gcc.gnu.org/wiki/InstallingGCC](http://gcc.gnu.org/wiki/InstallingGCC)。

# javascript - 固定浮动横幅在 IE6 中不起作用

> ID：10660860
> 
> 赞同：0
> 
> 时间：2012-05-18T23:12:19.273
> 
> 标签：javascript, jquery, internet-explorer-6, css-float

我正在尝试在 IE6 -> [Demo中使用这个固定的浮动横幅脚本](http://static.jqueryfordesigners.com/demo/fixedfloat.html)

根据开发商的[解释](http://jqueryfordesigners.com/fixed-floating-elements/)：

“警告：IE6

由于我们使用 position:fixed 来解决这个效果，IE6 不支持这个 CSS 属性。我并不是说 IE6 没关系，但我建议这种效果不是能够与网站正常交互的要求，所以如果 IE6 用户没有看到这个额外的效果，我是没关系。正如我在截屏视频中解释的那样，您需要自己决定，检查您网站的人口统计信息，是否是个人项目等。”

这可以在 IE6 中采用这种效果吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T23:25:54.957

`position:absolute;`在 IE6 中，您可以使用`position:fixed;`.

它需要一些额外的包装形式的标记`<div>`，但如果你支持 IE6，无论如何你都会习惯做这样的事情。

有关说明，请参见此处：[http ://ryanfait.com/resources/fixed-positioning-in-internet-explorer/](http://ryanfait.com/resources/fixed-positioning-in-internet-explorer/)

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T23:16:26.823

看看[Modernizr](http://modernizr.com/) - 这是针对旧浏览器的基于 javascript 的 css 大修。

您可以尝试一个[css hack ：](http://ryanfait.com/position-fixed-ie6/)

```
* html .commentWrapper {
     position: absolute;
   } 
```

# recursion - d 递归语言并发

> ID：10660868
> 
> 赞同：1
> 
> 时间：2012-05-18T23:13:25.357
> 
> 标签：recursion, concurrency, d, phobos

我一直在尝试使用 d 语言的参与者模型来实现阶乘函数。我的目标是使用创建actor来单独计算每个部分e产生一个新的actor来制作下一个。我只是D的初学者，所以我只是在学习如何使用该语言。我的目标是将阶乘实施扩展到更多。这只是一个测试。

这是我的问题：我正在尝试使用递归来实现阶乘；事实函数将为行中的下一个数字创建一个新的事实线程，除非它已达到基本条件。

我的代码：

```
void fact(Tid tid)
{

        int fact = 1;
        receive
        (
        (int i)
        {
            if(i == 0)
            {
                writeln("End of recursion");
            }
            else
            {
                fact *= i;
                send(thisTid, i-1);
            }
        }
    );
    send(tid, fact);
}

void main()
{

        auto tid = spawn(&fact, thisTid);
        int x = 3;
        send(tid, x);
        auto fact = receiveOnly!(int);
        writeln(fact);
} 
```

我什至不知道这是否可能，无论如何它都行不通。如果我尝试添加一个 spwn 实际上函数，它会返回以下错误：

```
src/main.d(62): Error: template std.concurrency.spawn does not match any function template declaration
/usr/include/x86_64-linux-gnu/dmd/phobos/std/concurrency.d(399): Error: template std.concurrency.spawn(T...) cannot deduce template function from argument types !()(int*,Tid)
src/main.d(63): Error: template std.concurrency.send does not match any function template declaration
/usr/include/x86_64-linux-gnu/dmd/phobos/std/concurrency.d(463): Error: template std.concurrency.send(T...) cannot deduce template function from argument types !()(_error_,int) 
```

那么，有可能做我想做的事吗？如何？如果没有，有没有计划让这样的事情成为可能？

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T04:34:37.753

我可能在这里偏离了基础，但从该错误消息来看，在我看来 dmd 没有使用`fact`您认为它正在使用的`spawn`. 你有几个名为 的整数`fact`，虽然在这个例子中（显然减少了，因为它不是 400 行），但它们都不会冲突，但在完整的代码中，我的猜测是其中之一（因为`&fact`会是`int*`if`fact`是 an `int`）。

尝试将函数重命名为阶乘或类似的，并`spawn`在适当的地方更改调用。确保不要更改整数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-19T11:56:51.340

对我来说很好。您使用的是什么 DMD 版本？如果您还没有升级到 2.059，也许可以尝试升级。

（注意：我说它的*工作原理*是编译和运行。它没有给出写答案，因为在它返回之前`fact`只有`receive`一个数字，所以它只返回三个。你需要`receive`在循环中使用）

```
admin@poita ~% cat test.d
import std.stdio;
import std.concurrency;

void fact(Tid tid)
{
    int fact = 1;
    receive
    (
        (int i)
        {
            if(i == 0)
            {
                writeln("End of recursion");
            }
            else
            {
                fact *= i;
                send(thisTid, i-1);
            }
        }
    );
    send(tid, fact);
}

void main()
{
    auto tid = spawn(&fact, thisTid);
    int x = 3;
    send(tid, x);
    auto fact = receiveOnly!(int);
    writeln(fact);
}

admin@poita ~% dmd test.d
admin@poita ~% ./test
3
admin@poita ~% 
```

# java - 如何在控制台和文件上进行 Java 日志记录？

> ID：10660872
> 
> 赞同：0
> 
> 时间：2012-05-18T23:13:41.490
> 
> 标签：java, logging

```
public class MyUtil {

    public static boolean showLogging;
    public static boolean saveLogging;

public static void log(Object s) {
        if (showLogging) {
            // show logging on console
        }
        if (saveLogging) {
            // save logging to file and append logging old file when it is created
        }
}
} 
```

这是我目前的想法。我听说过 log4j，但它对我来说太复杂了。

所以我只想要一些简单的东西，可以在控制台上打印日志，并根据用户配置将其写入文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:31:42.567

使用日志框架，例如 JDK 中的那个，并将其配置为同时记录到这两个地方。他们为您解决这些问题。

由于像 log4j 这样的框架的流行，大多数人都对其进行标准化并使用相同的日志框架，所以所有的东西都放在同一个地方。（即，他们使用已经在使用 log4j 的第三方库）。

以下是您可能想要阅读的内容，以了解这些框架的工作方式（大多数都是相似的）： http: [//logging.apache.org/log4j/1.2/manual.html](http://logging.apache.org/log4j/1.2/manual.html)

在本文档中向下滚动一点以查看一些实际示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T10:24:56.817

使用 log4j

首先定义 log4j.xml，它定义了控制台和文件 appender，如下所示：

```
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
<log4j:configuration xmlns:log4j='http://jakarta.apache.org/log4j/'>
    <appender name="CA" class="org.apache.log4j.ConsoleAppender">
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%-4r [%t] %-5p %c %x - %m%n" />
        </layout>
    </appender>
    <appender name="Daily" class="org.apache.log4j.DailyRollingFileAppender">
        <param name="File" value="logs/sample.log" />
        <param name="DatePattern" value="'.'yyyy-MM-dd-HH-mm" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d [%t] - %m%n%n%n" />
        </layout>
    </appender>
    <root>
        <appender-ref ref="CA" />
        <appender-ref ref="Daily" />
    </root>
</log4j:configuration> 
```

将此 xml 文件放在类路径中......同时将 log4j 保留在类路径中

示例代码是：

包 com.vanilla.helloworld；

导入 org.apache.log4j.*；

```
public class HelloWorld 
{
    static final Logger logger = Logger.getLogger(HelloWorld.class);

    public static void main(String[] args) throws InterruptedException
    {

        logger.info("I am going to log to file as well as console");

    }

} 
```

# c# - Outlook OpenSharedItem 丢失用户属性

> ID：10660874
> 
> 赞同：1
> 
> 时间：2012-05-18T23:14:23.677
> 
> 标签：c#, outlook, outlook-addin

我正在尝试在用户属性中存储一些数据，然后将邮件写入 .msg 文件，然后（*稍后*）重新加载 .msg 文件以读取用户属性。

问题是：重新加载文件后，我不再拥有任何用户属性。

我正在使用 Outlook 2010 32 位

这是一段显示行为的代码：

```
Outlook.MailItem originalItem = ((MailItemWrapper)this.Item)._item;

var path = System.IO.Path.GetTempFileName() + ".msg";
var propName = "ActionId123456789";

// Set a user property "ActionId" with value "test"
var ps = originalItem.UserProperties;
var p = ps.Find(propName);
if (p == null)
    p = ps.Add(propName, Outlook.OlUserPropertyType.olText, Type.Missing);
p.Value = "test";

// Save to a temp file
originalItem.Save(); // --> I also tried without this line
originalItem.SaveAs(path);

// Chech the the property is correctly set
p = originalItem.UserProperties[propName];
if (p != null)
    Console.WriteLine(p.Value); // ---> Show 'test'

// Open the temp file
Outlook.MailItem newItem = AddinModule.CurrentInstance.OutlookApp.Session.OpenSharedItem(path) as Outlook.MailItem;

// Check that the property still exists
p = newItem.UserProperties[propName];
if (p != null)
    Console.WriteLine(p.Value); // ---> Not executed: p is NULL ! 
```

有人知道该怎么做吗？

除了使用`OpenSharedItem`，我还尝试使用打开邮件`Process.Start`，但在这种情况下，用户属性也是 null ...

顺便说一句，这段代码是一个测试样本，所以它不能`dispose`正确地引用所有 COM 引用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T14:04:13.117

[这篇论坛帖子](http://www.office-outlook.com/outlook-forum/index.php/t/124880/)准确地描述了您的问题 -**用户属性没有保留在 MSG 中**。我也经历了同样的行为，[微软早在 2007 年就改变了](http://support.microsoft.com/kb/907985)这种行为。

作为一种解决方法，我只是使用一个[隐藏的 Outlook 文件夹](https://stackoverflow.com/a/10175091/175679)来存储我`MailItem`的用户属性，而不是将其导出到磁盘并重新导入。

如果您无法使用此解决方法，您可能需要[使用 EWS 将其存储在共享邮箱中](https://stackoverflow.com/a/6751511/175679)并以这种方式访问​​用户属性，而不是将 MSG 导出到磁盘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T08:17:53.680

好的，我找到了一个似乎可行的解决方案。为此，我需要使用第 3 方：[Redemption](http://www.dimastr.com/redemption)。

解决方案是使用自定义 MAPI 属性，而不是 UserProperties 集合。在下面的代码中，“this._item”引用了获取/设置属性所需的 Outlook.MailItem 对象

为此，您需要一个 Guid，对于您的加载项始终相同

```
private const string customPropId = "{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}"; 
```

设置属性

```
public void SetCustomProperty(string propertyName, string propertyValue)
{
    var sfe = new SafeMailItem() { Item = this._item };
    var propId = sfe.GetIDsFromNames(customPropId, propertyName);
    sfe.set_Fields(propId, propertyValue);
} 
```

要获得财产：

```
public string GetCustomProperty(string propertyName)
{
    var sfe = new SafeMailItem() { Item = this._item };
    var propId = sfe.GetIDsFromNames(customPropId, propertyName);

    var value = sfe.get_Fields(propId);
    if (value != null)
        return value.ToString();

    return null;
} 
```

就是这样

**警告**：我尚未在实际情况下测试此代码，它仅适用于与我的问题中发布的测试用例相同的测试用例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-11T21:17:27.560

如果您使用的是 C++ 或 Delphi，您可以使用[OpenIMsgOnIStg](http://msdn.microsoft.com/en-us/library/office/cc815715(v=office.15).aspx)方法并直接打开 MSG 文件。

您还可以使用[Redemption](http://www.dimastr.com/redemption)及其[RDOSession](http://www.dimastr.com/redemption/rdosession.htm) .GetMessageFromMsgFile - 它直接打开 MSG 文件并允许您读取其所有用户属性。

# java - 真实世界算法 - 测量输入值的唯一性

> ID：10660875
> 
> 赞同：-1
> 
> 时间：2012-05-18T23:14:49.033
> 
> 标签：java, algorithm, machine-learning, data-mining, entropy

我有一个键值对列表。对于每个键，我想看看值的唯一性。例如，对于特定的键 k1，所有值可能都相同。（最好的情况）。对于键 k2，一半的值是一种类型，另一半是不同的。. . 同样，对于键 kx，没有一个值匹配（最坏情况）。

我想根据上述内容为这些键中的每一个赋予等级（或百分比，等等）并进行最终排序，以便我可以过滤掉具有许多不同值的那些（假设高于预定义的阈值等级或百分比）。

我不知何故认为这与我在数据挖掘课程中学到的一些概念有些相关，但无法有效回忆。

谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-19T10:00:25.497

[在来自http://en.wikipedia.org/wiki/Association_rule_learning](http://en.wikipedia.org/wiki/Association_rule_learning)的数据挖掘术语中，您可以将索引视为预测值的一种方式，在这种情况下，您可能对置信度感兴趣 - 最常见值的百分比对于那个索引。您还可以查看两个随机选择的值相同的概率，这将是值频率的平方和，或者[http://en.wikipedia.org/wiki/Shannon_entropy](http://en.wikipedia.org/wiki/Shannon_entropy) - 这将有类似的性质，但涉及取对数。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-19T10:08:34.057

您也许可以为此使用一些[信息论](http://en.wikipedia.org/wiki/Information_theory)。

对于每个键，您可以计算值的[熵](http://en.wikipedia.org/wiki/Information_theory#Entropy)。熵越高，键的值越多样化。您可以使用它来对键进行排名。

以下文章讨论了一些相关主题：[计算数据挖掘的熵](http://onlamp.com/pub/a/php/2005/01/06/entropy.html)。

# php - PHP/XML 错误

> ID：10660880
> 
> 赞同：0
> 
> 时间：2012-05-18T23:16:21.093
> 
> 标签：php, xml

> **可能重复：**
> [使用 PHP 将 HTML 代码添加到 XML 文件](https://stackoverflow.com/questions/10663814/add-html-codes-to-xml-file-using-php)

我有一个 xml 文件（scores.xml），我使用 php 代码向它添加新标签...

我有一个名为 Header 的标签，其中包含一些 html 代码

```
<![CDATA[<tr><td colspan='7' id='headertd'>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<img border='0' src='images/euro.png' />
&nbsp;&nbsp;&nbsp;&nbsp;
UEFA Euro 2012 Qualifications</td></tr>]]> 
```

当我以 pgp 脚本的形式编写此代码并提交除标头标记外的所有 XML 文件时，一切正常......我在 php 脚本中遇到错误，并且代码在 xml 标记中是这样的：

```
&lt;![CDATA[&lt;tr&gt;&lt;td colspan='7' id='headertd'&gt;&#13;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#13;
&lt;img border='0' src='images/euro.png' /&gt;&#13;
&nbsp;&nbsp;&nbsp;&nbsp;&#13;
UEFA Euro 2012 Qualifications&lt;/td&gt;&lt;/tr&gt;]]&gt; 
```

所以这让我的xml得到了wong信息......无论如何我可以解决这个问题吗？并避免这些代码的转换？

那是我的 php 代码：

```
<?php
if (isset($_POST['submitted'])) {//If the user submitted the form, then add to the XML file
    //Load the scores XML file
    $scores = new DOMDocument();
    $scores -> load('../scores.xml');

    //Get the <Games> tag
    $games = $scores -> getElementsByTagName('Games');

    //Create the new <Game> tag (Could probably be done better by first placing everything in an array or something)
    $newGame = $scores -> createElement("Game");
    $newGame -> appendChild($scores -> createElement("Header", $_POST['header']));
    $newGame -> appendChild($scores -> createElement("Row", $_POST['row']));
    $newGame -> appendChild($scores -> createElement("Date", $_POST['date']));
    $newGame -> appendChild($scores -> createElement("Time", $_POST['time']));
    $newGame -> appendChild($scores -> createElement("HomeTeam", $_POST['hometeam']));
    $newGame -> appendChild($scores -> createElement("Score", $_POST['score']));
    $newGame -> appendChild($scores -> createElement("AwayTeam", $_POST['awayteam']));
    $newGame -> appendChild($scores -> createElement("Other", $_POST['other']));
    $newGame -> appendChild($scores -> createElement("InfoID", $_POST['infoid']));
    $newGame -> appendChild($scores -> createElement("InfoData", $_POST['infodata']));

    //Add the new <Game> tag under the <Games> tag
    $games -> item(0) -> appendChild($newGame);

    //Save again
    $scores -> save('../scores.xml');

    echo "New game added.";
}
?> 
```

这个 php 连接到一个看起来像这样的表单：

```
<form id="form1" method="post" action="">
<table id="table2">

<tr><td>Header:</td> <td><textarea style=" color:#000;" name="header" cols="73" rows="6" > </textarea></td></tr>

<tr><td>Row:</td> <td><input id='textfield' type="text" size="70" name="row" value='A or B' onfocus="inputFocus(this)" onblur="inputBlur(this)"></td></tr>

<tr><td>Date:</td> <td><input id='textfield' type="text" size="70" name="date" value='Date and time of the match' onfocus="inputFocus(this)" onblur="inputBlur(this)"></td></tr>

<tr><td>Time:</td> <td><input id='textfield' type="text" size="70" name="time" value='Current time' onfocus="inputFocus(this)" onblur="inputBlur(this)"></td></tr>

<tr><td>HomeTeam:</td> <td><input id='textfield' type="text" size="70" name="hometeam" value='Home Team' onfocus="inputFocus(this)" onblur="inputBlur(this)"></td></tr>

<tr><td>Score:</td> <td><input id='textfield' type="text" size="70" name="score" value='Score' onfocus="inputFocus(this)" onblur="inputBlur(this)"></td><td>"3 - 2"</td></tr>

<tr><td>AwayTeam:</td> <td><input id='textfield' type="text" size="70" name="awayteam" value='Away Team' onfocus="inputFocus(this)" onblur="inputBlur(this)"></td></tr>

<tr><td>Other:</td> <td><input id='textfield' type="text" size="70" name="other" value='Additional Info' onfocus="inputFocus(this)" onblur="inputBlur(this)"></td></tr>

<tr><td>InfoID:</td> <td><input id='textfield' type="text" size="70" name="infoid" value='The ID of the Popup' onfocus="inputFocus(this)" onblur="inputBlur(this)" ></td><td></td></tr>

<tr><td>InfoData:</td> <td><textarea id='textfield' value='Data of the Popup' onfocus="inputFocus(this)" onblur="inputBlur(this)" name="infodata" cols="73" rows="6"></textarea></td><td>

<tr><td> </td><td><input type="submit" name="submitted" name="Add new row"></td><td> <td></td> 

</table>

 <style>
 BODY {font-family:"Trebuchet MS", Arial, Helvetica, sans-serif; color:#333; font-size:11px;}
 #textfield {color:#888;}
 #table2 td, tr { padding-right:10px;}
 </style> 
```

# php - 请求uri php：获取第一级

> ID：10660883
> 
> 赞同：8
> 
> 时间：2012-05-18T23:16:41.367
> 
> 标签：php

如果我有一个网址，例如**`www.example.com/test/example/product.html`**

我怎么才能得到测试部分（所以顶级）

我知道你会使用`$_SERVER['REQUEST_URI']`，也许`substr`或者`trim`

但是我不确定如何做到这一点，谢谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-18T23:23:53.787

用 将字符串拆分为一个数组`explode`，然后取出您需要的部分。

```
$whatINeed = explode('/', $_SERVER['REQUEST_URI']);
$whatINeed = $whatINeed[1]; 
```

如果你使用 PHP 5.4，你可以做`$whatINeed = explode('/', $_SERVER['REQUEST_URI'])[1];`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T23:41:22.840

```
<?php
$url = 'http://username:password@hostname.foo.bar/test/example/product.html?arg=value#anchor';

print_r(parse_url($url));

$urlArray = parse_url($url);

/* Output:

Array
(
    [scheme] => http
    [host] => hostname
    [user] => username
    [pass] => password
    [path] => /test/example/product.html
    [query] => arg=value
    [fragment] => anchor
)

*/

echo dirname($urlArray[path]);

/* Output:

/test    

*/ 
```

# php - 表单 GET 删除当前 URI

> ID：10660891
> 
> 赞同：1
> 
> 时间：2012-05-18T23:17:48.647
> 
> 标签：php, html

我有一个当前的 URI，它以（示例）的形式过滤我的搜索结果

```
search.php?gallery=205&view=listings 
```

这个查询产生了一些结果，所以我也有分页和额外的过滤器产生（示例）

```
search.php?sortByType=mostWatched&page=1 
```

我也有表格

```
<form name="frmFilterResults" id="frmFilterResults" method="get" action="<?php echo($_SERVER['REQUEST_URI']); ?>"> 
```

我有一个问题，如果我有上面的第一个 URI，然后单击表单过滤器（提交）按钮，则 URI 被第二个替换，而实际上我需要加入 2，所以如果我在第一个 URI 上然后单击表单过滤器（提交）或我得到类似的分页

```
search.php?gallery=205&view=listings&sortByType=mostWatched&page=1 
```

我使用 POST 类型完成了所有这些工作，但因为我需要能够使用浏览器后退按钮，所以我想将其更改为 GET。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:19:52.230

使用将保留 GET 变量的隐藏输入，并在提交表单时再次发送它们。

例子：

```
<input type="hidden" id="gallery" value"<?php if (isset($_GET['gallery'])) echo $_GET['gallery'] ?>" /> 
```

在这种情况下，下次您提交表单时，*画廊*将在 URL 中传递。

# php - 需要制作日历

> ID：10660899
> 
> 赞同：0
> 
> 时间：2012-05-18T23:18:21.367
> 
> 标签：php, foreach, while-loop

当我们使用 if 语句时，我们的循环有问题，它只显示我们的一个标题，而不是所有标题

这是我们的代码：

```
$sqldayshours = mysqli_query($link, "SELECT *  FROM event;") or die("Kon de comments niet ophalen");
$event_time = mysqli_fetch_assoc($sqldayshours);

$title =  $event_time['event_title'];
    $day = $event_time['event_date_day'];
    $uur = $event_time['event_date_hour'];
    $ide = $event_time['event_id'];
    $idsql="day".$day."uur".$uur;

for($rij=8;$rij<19;$rij++)
    {
        echo " < tr > ";
                    for($i=0;$i<8;$i++)
            {
                    $id = "day".$i."uur".$rij;
                    echo " < td id=\"$id\" name=\"$id\" class=\"events\">";
                    if($i==0){
              echo $rij.":00 ";
                  }else{ 
                                    if($idsql == $id ){ 
                                   echo $title; 
                               }
                }
        echo "< /td >";
                }`

        echo "< /tr >";

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T10:06:09.617

```
<?php

    $sqldayshours = mysqli_query($link, "SELECT *  FROM event;") or die("Kon de comments niet ophalen");
   while($event_time = mysqli_fetch_array($sqldayshours) ) {
        for($rij=8;$rij<19;$rij++)
    {
        echo " < tr > ";
                    for($i=0;$i<8;$i++)
            {
                    $id = "day".$i."uur".$rij;
                    echo " < td id=\"$id\" name=\"$id\" class=\"events\">";
                    if($i==0){
              echo $rij.":00 ";
                  }else{ 
                                    if($idsql == $id ){ 
                                   echo $event_time['title']; 
                               }
                }
        echo "< /td >";
                }`

        echo "< /tr >";

    }
   }

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T00:44:52.750

不知道这是否是您要查找的内容，但您可以使用以下方法遍历所有结果：

```
<?php

   while($event_time = mysqli_fetch_array($sqldayshours) ) {

       echo $event_time['title']; // or whatever you need to do.

   }

   //or alternatively

   while($event_time = mysqli_fetch_array($sqldayshours) ) {

       $results[] = $event_time;

   }

    print_r($results); 
```

这使您可以循环遍历结果并使用它们做您想做的事情。

第二个将结果推送到一个数组，然后您可以在其中使用 while 循环之外的值或您想做的任何事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-19T12:33:02.727

```
<?php

$sqldayshours = mysqli_query($link, "SELECT *  FROM event;") or die("Kon de comments niet ophalen");

//loop all 18hours of one day
for($hour=8;$hour<19;$hour++)
{
    echo "<tr>";

    //loop all 7days
    for($day=0;$day<8;$day++)
    {
        //save the current time in the loop
        $current_time = "day".$day."uur".$hour;

        //loop all the events in the query and check for a valid one
        while($one_event = $sqldayshours->fetch_array())
        {
            $title = $one_event['event_title'];
            $day2= $one_event['event_date_day'];
            $hour2= $one_event['event_date_hour'];
            $id2 = $one_event['event_id'];
            $idsql = "day".$day2."uur".$hour2;

            echo "<td id='$current_time' name='$current_time' class='events'>";

            if($day == 0)
            {
                echo $hour.":00";
                echo "< /td >";
            }
            else if($current_time == $idsql)
            {
                echo $title;
                echo "< /td >";
            }
            else
            {
                echo "< /td >";
            }
        }

    echo "<tr>";

    }
}

?> 
```

我已经扭转了循环。这可能会对服务器造成更高的负载，但是对于您生成的每一行，他都会检查它们是否是数据库中的有效条目，如果不是，他会继续。希望我说得通。我没有测试过，只是写下我的想法。但你可能会从中找到灵感或其他东西。

我也试过按照你的逻辑...

马杰德克。

# ios - ios - 生成从 CoreData 填充的 PDF

> ID：10660901
> 
> 赞同：3
> 
> 时间：2012-05-18T23:18:41.410
> 
> 标签：ios, pdf, core-data, printing

我有一个带有 Core Data 的应用程序，我想将其内容传输到 PDF 文件，以便最终用户可以打印并邮寄。

1.  我需要采取哪些步骤？像我需要转换还是可以直接转换？

2.  我想设置 PDF 文件的布局，所以我不确定这是否会影响问题 1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T23:26:05.413

输出到 PDF 并不是特别棘手 - 一般来说，它并不比编写传统视图更难。

UIKit 提供了一个高级 API，记录[在这里](http://developer.apple.com/library/ios/#documentation/2DDrawing/Conceptual/DrawingPrintingiOS/GeneratingPDF/GeneratingPDF.html#//apple_ref/doc/uid/TP40010156-CH10-SW3)。

另一种方法是渲染到 CoreGraphics PDF 上下文。您还可以搜索它的各种实现。

# javascript - 如何在javascript函数中将url作为参数传递？

> ID：10660902
> 
> 赞同：-3
> 
> 时间：2012-05-18T23:18:41.970
> 
> 标签：javascript, url, parameters

我需要调用一个 javascript 函数并在其中传递一个长 url。由于某些特殊字符，这会产生未转义的错误。我不能使用转义字符，因为 url 是动态选择的并传递给函数。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T23:27:22.683

看到这个[线程](https://stackoverflow.com/questions/332872/how-to-encode-a-url-in-javascript)。如果 URL 是在运行时生成的，则无关紧要。在将其传递给其他函数之前，您可以调用一个函数对其进行编码吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-07T13:26:23.527

我需要读取一个 URL GET 变量并根据 url 参数完成一个操作。我到处寻找解决方案，并在 Snipplr 上发现了这段小代码。它基本上是读取当前页面的 url，对 URL 执行一些正则表达式，然后将 url 参数保存在一个关联数组中，我们可以轻松访问它。例如，如果我们有以下 url，底部有 javascript。

[http://papermashup.com/index.php?id=123&page=home](http://papermashup.com/index.php?id=123&page=home)

获取参数 id 和 page 我们需要做的就是调用它：

```
var first = getUrlVars()["id"];
var second = getUrlVars()["page"];

alert(first);
alert(second);

function getUrlVars() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        vars[key] = value;
    });
    return vars;
} 
```

# css - 悬停 CSS 的问题

> ID：10660903
> 
> 赞同：0
> 
> 时间：2012-05-18T23:19:04.413
> 
> 标签：css, hover, hide, element, show

当我将鼠标悬停在另一个上时，我想显示一个 img，但什么也没发生。关于我可以做些什么来更改代码的任何建议

```
**HTML**
 <div id="container-collection">

   <img class="clothes1" src="Images/smallest/JPEG/IMG_3148.jpg">

   <img class="closeup1" src="Images/Smaller/bigger ones/JPEG/IMG_3148_1.jpg">

 </div>

**CSS**

img.closeup1{
    display: none;
}

img.closeup1:hover clothes1 {
    display: block;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:22:40.920

正如@minitech 所说，您需要将受控元素选择器与`:hover`所有者正确组合。

我会去做这样的事情：

**HTML**

```
<div id="container-collection">
    <div class="clothes1-wrap">
        <img class="clothes1" src="Images/smallest/JPEG/IMG_3148.jpg">
        <img class="closeup1" src="Images/Smaller/bigger ones/JPEG/IMG_3148_1.jpg">
    </div>
</div> 
```

**CSS**

```
.closeup1 {
    display: none;
}

.clothes1-wrap:hover .closeup1 {
    display: block;
} 
```

对我来说，这看起来更干净一些，而且你可以在 s 之间添加元素`img`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T23:23:02.900

1.  您缺少`.`选择课程的方法。应该是`.clothes1`。
2.  你缺少一个组合器；`.clothes1`不是 的后代`.closeup1`。然而，不幸的是，还没有“前一个兄弟”的组合子。在 CSS4 中，会有，但不是现在。

如果打乱顺序没问题（你可以用一些花哨的 CSS 来纠正位置变化），你可以这样做：

```
<div id="container-collection">

    <img class="closeup1" src="Images/Smaller/bigger ones/JPEG/IMG_3148_1.jpg">

    <img class="clothes1" src="Images/smallest/JPEG/IMG_3148.jpg">

</div> 
```

```
img.clothes1 {
    display: none;
}

img.closeup1:hover + .clothes1 {
    display: block;
} 
```

# c# - 通过 COM 从 Ruby 调用 C# .dll

> ID：10660904
> 
> 赞同：2
> 
> 时间：2012-05-18T23:19:14.610
> 
> 标签：c#, ruby-on-rails, ruby, dll, win32ole

我试图在我的 Ruby 代码中从 C# 调用一些方法。首先，我在 Visual Studio 2008 中创建了一个 .dll。我在构建时注册了 COM 互操作。

为了测试这个新过程，我在 C# 中创建了一个简单的小 DivideTwo 方法——

```
 public double DivideTwo(double a, double b)
    {
        return a / b;
    } 
```

在 Ruby 中，我执行以下操作：

```
require 'win32ole'
test=WIN32OLE.new('DllAttempt.CsharpDll')
x=test.DivideTwo(5,5)
puts x
#x=1 
```

我很兴奋，因为我认为我已经让它工作了！我决定通过以下方法从 C# 中返回一个哈希：

```
 public Hashtable Hashtbl(string a,int b)
    {
        Hashtable bbDataHash = new Hashtable();
        bbDataHash.Add(a, b);
        return (Hashtable)bbDataHash;
    } 
```

在 Ruby 中，我执行以下操作：

```
require 'win32ole'
test=WIN32OLE.new('DllAttempt.CsharpDll')
x=test.Hashtbl("key",1)
puts x
#x=#<WIN32OLE:0x283f3f4> 
```

如您所见，我得到了一个 COM 对象。我无法从对象中得到任何东西。x.each {block} 给我一个“无法获取 IEnum 接口”错误。有趣的是，如果我从 C# 返回一个数组， .each 将作用于该对象。

我是否以正确的方式去做这件事？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:50:33.773

虽然`HashTable`是 ComVisible，但它不会通过 COM 编组神奇地从 C# 集合转换为 Ruby 集合。

我不知道任何 Ruby，所以我不能给你一个例子，但你可能需要调用`HashTable.GetEnumerator`并使用它[`IEnumVARIANT`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221053%28v=vs.85%29.aspx)返回的来遍历你`HashTable`的 Ruby。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T01:42:47.293

尝试阅读[http://msdn.microsoft.com/en-us/library/ee817653.aspx](http://msdn.microsoft.com/en-us/library/ee817653.aspx)

您必须点击链接才能找到提供托管到 COM 数据类型转换的页面

# android - 安卓聊天应用开发

> ID：10660914
> 
> 赞同：10
> 
> 时间：2012-05-18T23:20:35.537
> 
> 标签：android, sockets, chat

我想为 Android 创建一个聊天应用程序，我想知道最好的方法。我的第一个选择是在电话和服务器之间使用套接字连接，以便服务器可以向电话发送任何新消息。

第二种选择是使用 C2DM。

像what's up这样的聊天应用程序是如何使用socket或使用C2DM实现的？

有没有比上面更好的方法来创建这样的应用程序？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-03-25T17:07:59.790

C2DM（现在称为 GCM）不是构建聊天应用程序的好选择。当应用程序在前台时创建与服务器的套接字连接，当应用程序在后台时使用 GCM 进行推送通知。您将不得不托管自己的服务器，但我建议不要重新发明轮子并使用 Applozic ( [https://www.applozic.com](https://www.applozic.com) ) 聊天 sdk 之类的东西，它会在一小时内为您提供 whatsapp 等功能以及更多功能.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-19T00:09:40.787

[asmack](http://code.google.com/p/asmack/)和[OpenFire](http://www.igniterealtime.org/projects/openfire/)是最简单的方法。无需重新发明轮子。

但是，如果您确实想要 RTW，则在应用程序处于前台时打开一个套接字，并在不是时使用 C2DM。BTW C2DM 是一个可以使用的 PITN，因此请考虑使用 Urban Airship 之类的服务。

# java - LWJGL 慢渲染

> ID：10660920
> 
> 赞同：1
> 
> 时间：2012-05-18T23:21:21.620
> 
> 标签：java, performance, screen, render, lwjgl

我制作了一个简单的 LWJGL 程序，它在其中进行显示并将文本呈现到屏幕上。我用 Slick-util btw 渲染文本。

所以我的问题是为什么在加载之前需要几秒钟的黑屏（或任何清晰的颜色）。有没有办法来解决这个问题？我可以隐藏显示直到它全部呈现吗？嗯，这些是我的问题。这是我的代码：

```
package com.survivalpixel.kopis;

import static org.lwjgl.opengl.GL11.GL_MODELVIEW;
import static org.lwjgl.opengl.GL11.GL_PROJECTION;
import static org.lwjgl.opengl.GL11.GL_TEXTURE_2D;
import static org.lwjgl.opengl.GL11.glEnable;
import static org.lwjgl.opengl.GL11.glMatrixMode;
import static org.lwjgl.opengl.GL11.*;
import static org.lwjgl.opengl.GL11.glPopMatrix;
import static org.lwjgl.opengl.GL11.glPushMatrix;

import java.awt.Font; 

import org.lwjgl.LWJGLException;
import org.lwjgl.opengl.Display;
import org.lwjgl.opengl.DisplayMode;
import org.lwjgl.opengl.GL11;
import org.newdawn.slick.TrueTypeFont;
public class Menu {
private int WIDTH = 1080,HEIGHT = 720;
Font font;
TrueTypeFont gamefont;
public static void main(String args[]){
    new Menu();
}
public Menu(){
    try {
        Display.setDisplayMode(new DisplayMode(WIDTH,HEIGHT));
        Display.setResizable(false);
        Display.setTitle("Kopis V.01");
        Display.create();
    } catch (LWJGLException e) {

    }

    initGL();
    init();

    while(!Display.isCloseRequested()){
        glPopMatrix();

        glClear(GL11.GL_COLOR_BUFFER_BIT);

        drawString("This is a test",100,100);

        Display.update();
        Display.sync(100);
        glPushMatrix();
    }
    Display.destroy();
    System.exit(0);
}
private void initGL() {
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0, 1080, 720, 0, -1, 1);
    glMatrixMode(GL_MODELVIEW);
    glClearColor(0, 0, 0, 0);
    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

}
private void init() {

    font = new Font("times new roman", Font.BOLD,12);
    gamefont = new TrueTypeFont(font, false);

}
public void drawString(String s,int x, int y){
    gamefont.drawString(x, y, s);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T21:02:49.830

正如班塔尔所说，`glPushMatrix/glPopMatrix`顺序错误。您的示例中甚至不需要它们，因此您可以安全地删除它们。

关于字体，现在看来 UnicodeFont 是正确的：

```
textFont = new UnicodeFont(new Font("Times New Roman", Font.PLAIN, 18));
textFont.addAsciiGlyphs();
textFont.getEffects().add(new ColorEffect(java.awt.Color.WHITE));
textFont.loadGlyphs(); 
```

我也试过你的代码，没有任何优化，尽管矩阵顺序问题它运行正确。是的，有一个小的初始化时间。但是这里很短，大约一秒钟。您的硬件通常很旧，或者您的图形驱动程序可能不好。

# jquery - 如何使用 jQuery 选择提交按钮

> ID：10660921
> 
> 赞同：1
> 
> 时间：2012-05-18T23:21:51.440
> 
> 标签：jquery, jquery-ui, jsp

我在 jsp 中使用 jQuery 1.6.4，并且我有一个函数可以过滤掉更改事件中的选择元素，效果很好。我还想在同一功能中过滤掉保存按钮。

由于按钮不止一个，因此似乎很难确定按钮的位置，因此我选择了一个类来区分它们。这是我到目前为止所拥有的：

```
$(function(){
        $(':input:not("select")').change(function(){
            $(':input:submit:not(".saveButton")'){
                // Do something here.
            }
        }); ... 
```

这是按钮。这是 Struts2 标签：

```
<td>
    <s:submit action="<actionName>"  cssClass="saveButton" value="Save" />
</td>                   
<td>
    <s:submit  action="<anotherActionName>" value="Cancel" />
</td> 
```

但是当我运行它时，它根本无法使用额外的输入。我不确定这是正确的语法还是最好的方法？对此有什么想法吗？

根据以下答案，这就是我发现的有效方法：

```
$(function(){

$(':input:not("select")').change(function(){
            if($(':submit:not(".saveButton")')) { ... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T23:23:33.030

```
 $(function(){
    $(':input:not("select")').change(function(){
        $('.cancelButton').change(function(){
            // Do something here.
        });
    }); 
```

更新：你把生活弄得太复杂了，如果只有两个，只需选择取消按钮。

# entity-framework - 如何使用实体框架 (EF) 4.1 Code First 将一个类的多个属性绑定到另一个类以与 Upshot.js 一起使用？

> ID：10660932
> 
> 赞同：1
> 
> 时间：2012-05-18T23:23:11.963
> 
> 标签：entity-framework, ef-code-first, knockout.js, knockout-2.0, upshot

我有一个场景，我需要使用 Entity Framework 4.1 Code-First 将一个类的两个属性绑定到另一个类。（作为参考，Upshot.js 正在使用此模型以在使用 Knockout.js 2.1 的单页应用程序中使用）

通常，我会执行以下操作：

```
 public class Person
    {
        [Key]
        public int PersonId { get; set; }

        public string FirstName { get; set; }
        public string LastName { get; set; }

        public Address HomeAddress { get; set; }
        public Address OfficeAddress { get; set; } 
    }

    public class Address
    {
        [Key]
        public int AddressId { get; set; }

        public string StreetAddress { get; set; }
        public string City { get; set; }
        public string State { get; set; }
        public string ZipCode { get; set; }
    } 
```

这允许 HomeAddress 和 OfficeAddress 都引用 Address 类的实例。

*请注意，这不是我的真实数据模型。它仅用于说明目的。在现实生活中，我可能会使用 ICollection。不幸的是，对于这种特殊情况是不可行的，我确实需要维护从一个类到另一个类的多个引用。*

In this particular scenario, it is also possible for a person to exist *without* any addresses defined. It is also possible for addresses to exist *without* a person. (As mentioned, this data model is just an example.)

While this compiles correctly, and I can even create and save data, upshot complains bitterly when it attempted to use this model.

It gives an (inner) exception like the following:

```
{"Unable to retrieve association information for association 'KnockoutTest.Models.Person_HomeAddress'. Only models that include foreign key information are supported. See Entity Framework documentation for details on creating models that include foreign key information."} 
```

So... I attempted to set the Foreign Key information on the DbContext class like

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<Person>()
    .HasOptional(m => m.HomeAddress);

    modelBuilder.Entity<Person>()
    .HasOptional(m => m.OfficeAddress);
} 
```

No joy! This still gave me the same exception.

I am not sure how to set up the foreign key association so that multiple properties on one class can reference another class--at least not in a way that upshot will be pleased and stop complaining for a while.

What am I doing wrong, and how do I fix it?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T11:55:38.610

您只需在模型类中引入标量外键属性：

```
public class Person
{
    [Key]
    public int PersonId { get; set; }

    public string FirstName { get; set; }
    public string LastName { get; set; }

    [ForeignKey("HomeAddress")]
    public int? HomeAddressId { get; set; }
    public Address HomeAddress { get; set; }

    [ForeignKey("OfficeAddress")]
    public int? OfficeAddressId { get; set; } 
    public Address OfficeAddress { get; set; } 
} 
```

这些属性必须是可空的 ( `int?`)，因为您的关系是*可选*的（人可以在没有地址的情况下存在）。

# delphi - 如何使用 7z 和 Delphi 打包文件并显示完成百分比？

> ID：10660933
> 
> 赞同：3
> 
> 时间：2012-05-18T23:23:13.620
> 
> 标签：delphi, command-line, process, pipe

当我从命令行运行它时：

```
7z a 1.zip J:\test.mp4 
```

我可以看到完成了多少百分比。当我尝试使用 CreateProcess 和 CreatePipe 从 Delphi 运行它时，在文件被打包之前我什么也没得到。然后它显示了 7zip 的最终输出。

我的代码如下所示：

```
Stream:= THandleStream.Create(hRead);
try
  if not CreateProcess(nil, PChar(Cmd), nil, nil, 
                       True, 0, nil, nil, StartupInfo, 
                       ProcessInformation) then
    RaiseLastOSError;
  repeat
    if not GetExitCodeProcess(ProcessInformation.hProcess, ExitCode) then
      RaiseLastOSError;

    while Stream.Position < Stream.Size do 
    begin
      Stream.Read(C, 1);

      if (C = #13) then 
      begin
        Memo1.Lines.Add(S);
        S := '';
        Application.ProcessMessages;
      end
      else if C <> #10 then 
      begin
        S := S+C;
      end;
    end;
  until ExitCode <> Still_Active;
finally
  Stream.Free;
end; 
```

我不想只创建一个 ZIP 存档——我知道在 Delphi 中有更好的方法来做到这一点。我想与控制台应用程序交互。许多控制台应用程序的输出可以使用我发布的代码进行处理，但是使用 7zip 会失败——这就是我在这里询问 7zip 的原因。7zip 有什么特别之处以至于它的输出无法正确捕获？如何从像 7zip 这样的应用程序中捕获输出？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-19T06:54:43.170

你可以看看[progdigy制作的插件](https://web.archive.org/web/20121108044021/http://www.progdigy.com/?page_id=13)

进度条

```
 function ProgressCallback(sender: Pointer; total: boolean; value: int64): HRESULT; stdcall;
 begin
   if total then
     Mainform.ProgressBar.Max := value else
     Mainform.ProgressBar.Position := value;
   Result := S_OK;
 end;

 procedure TMainForm.ExtractClick(Sender: TObject);
 begin
   with CreateInArchive(CLSID_CFormatZip) do
   begin
     OpenFile('c:\test.zip');
     SetProgressCallback(nil, ProgressCallback);
     ...
   end;
 end; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-07-20T14:43:24.617

# 命令：

1.  归档包含内容的文件夹。
    *   7z.exe "Data\UpdateList.zip" "UpdateList*"
2.  仅存档文件夹的内容。
    *   7z.exe "Data\UpdateList.zip" ".\UpdateList*"

# WinApi：

1.  CreateProcessWithComLine_Wait(30000, L"C:\MyExcample\", NULL, L"7z.exe a \"Data\UpdateList.zip\" \".\UpdateList*\" ");

```
 DWORD static CreateProcessWithComLine_Wait(const DWORD dwWait, const PWCHAR szFolderPath, const PWCHAR szFilePath, const PWCHAR szComLine)
    {
    DWORD result    = 0;
    // ----
    STARTUPINFO si;
    ZeroMemory( & si, sizeof(si));
    // ----
    PROCESS_INFORMATION pi;
    ZeroMemory( & pi, sizeof(pi));
    // ----
    si.cb                   = sizeof(si);
    si.wShowWindow          = SW_HIDE;
    // ----
    DWORD dwErrorCode = 0;
    // ----
    int iRes    = CreateProcess(szFilePath, szComLine, NULL, NULL, FALSE,
    NORMAL_PRIORITY_CLASS, NULL, szFolderPath, &si, &pi);
    if ( iRes != 0 )
    {
    WaitForSingleObject(pi.hProcess, dwWait);
    // ----
    CloseHandle(pi.hThread);
    CloseHandle(pi.hProcess);
    }
    else
    {
    dwErrorCode = GetLastError();
    result = dwErrorCode;
    }
    // ----
    return result;
    } 

```

# objective-c - setImage 动画 - NSImageView

> ID：10660934
> 
> 赞同：0
> 
> 时间：2012-05-18T23:23:27.687
> 
> 标签：objective-c, macos, cocoa, core-animation

我正在尝试`setImage:`使用`NSImageView`动画（Mac App）：

```
[[_image animator] setImage:[NSImage imageNamed:@"image.png"]]; 
```

但是图像只是在改变（没有任何影响）。我试图让它褪色。

知道如何`NSImageView`在 Mac App 中淡化两个吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T23:51:47.180

我认为此链接可能会帮助您使用 NSImageView 进行转换和动画：

[http://developer.apple.com/library/mac/samplecode/ImageTransition/ImageTransition.zip](http://developer.apple.com/library/mac/samplecode/ImageTransition/ImageTransition.zip)

希望这可以帮助

# c# - 您如何按从最少到最多的非零元素的顺序遍历排列？

> ID：10660938
> 
> 赞同：4
> 
> 时间：2012-05-18T23:24:19.300
> 
> 标签：c#, .net, permutation, combinations

我正在尝试编写一个 C# 函数，给定一个参数，例如`new int[] { 2, 3, 2 }`为每个元素指定上限 + 1，将返回以下内容（通过`IEnumberable<int[]>`）：

```
0 0 0
0 0 1
0 1 0
0 2 0
1 0 0
0 1 1
0 2 1
1 0 1
1 1 0
1 2 0
1 1 1
1 2 1 
```

请注意，顺序很重要：所有具有 0 个非零元素的排列，然后是所有具有 1 个非零元素的排列，等等。在这些组之一中，顺序无关紧要。

我意识到这些在技术上可能不是排列，但这是我所知道的最接近的术语。我也意识到一种方法是以某种顺序返回所有排列，然后根据计算有多少非零元素的函数对它们进行排序，但我希望有更优雅和高效的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:53:53.930

如果此代码存在语法错误（无法测试），我深表歉意，但希望您能理解。

```
IEnumerable<int[]> Permutations(int[] upperBounds) {
    int[] c = new int[upperBounds.Length] {};

    while(true) {
        int i = c.Length - 1;

        while(i >= 0 && c[i] == upperBounds[i]) {
            c[i] = 0;
            i--;
        }

        if(i == -1) break;

        c[i]++;

        yield return (int[]) c.Clone();
    }
} 
```

如果您使用回调并保持相同的数组引用，它会变得更好，但您要求一个`IEnumerable`. 如果`Clone`可以不使用，请务必使用它 - 它会更有效率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:57:26.513

我想要一个不先计算所有内容然后排序的答案，同时仍然只通过最少的时间处理事情。这就是我所拥有的。请注意，从外部修改`int[]`可能会搞砸结果（或者，可能会返回 a `new int[]`）。

第一个方法告诉辅助方法它想要输出多少个 0。助手然后计算结果，如果它不能填充足够的 0 或者如果它遍历所有数据则停止。

```
static IEnumerable<int[]> Permutation(int[] bounds)
{
  for(int num0s = bounds.Length; num0s >= 0; --num0s)
  {
    foreach(int[] ret in PermHelper(num0s, 0, bounds, new int[bounds.Length]))
      yield return ret;
  }
}

static IEnumerable<int[]> PermHelper(int num0s, int index, int[] bounds, int[] result)
{
  //Last index.
  if(index == bounds.Length - 1)
  {
    if(num0s > 0)
    {
      result[index] = 0;
      yield return result;
    }
    else
    {
      for(int i = 1; i < bounds[index]; ++i)
      {
        result[index] = i;
        yield return result;
      }
    }
  }
  //Others.
  else
  {
    //still need more 0s.
    if(num0s > 0)
    {
      result[index] = 0;
      foreach(int[] perm in PermHelper(num0s - 1, index + 1, bounds, result))
        yield return perm;
    }
    //Make sure there are enough 0s left if this one isn't a 0.
    if(num0s < bounds.Length - index)
    {
      for(int i = 1; i < bounds[index]; ++i)
      {
        result[index] = i;
        foreach(int[] perm in PermHelper(num0s, index + 1, bounds, result))
          yield return perm;
      }
    }
  }
} 
```

# android - Android 4/ICS 上下文菜单未显示

> ID：10660939
> 
> 赞同：2
> 
> 时间：2012-05-18T23:24:34.537
> 
> 标签：android, contextmenu, android-4.0-ice-cream-sandwich

我查看了有关此主题的其他线程，但没有一个有帮助。我正在使用适当的 minSdkVersion，我的菜单 xml 显示设置正确，我的清单正在调用 Them.Holo.Light，以及所有其他“通常被忽视”的问题（无论如何，我从其他线程中知道）。

我正在使用带有最新 SDK 的 Eclipse，并遵循 Android 开发 wiki 中的基本教程。Eclipse 没有显示任何错误。

如您所见，我引用的是 main.xml 和 main_activity.xml。main.xml 显示应用加载时的默认视图，这是一个简单的标题栏和两匹小马的图片。这个想法是，用户可以使用上下文菜单在小马图片和 Lionel Richie 的图片之间进行切换（嘿，这是一个测试应用程序）。

我试过在模拟器、Xoom 平板电脑和手机上运行它，但没有成功。

代码：

```
/***** Contents of testIceCreamS Manifest *****/

<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="test.icecreams"
    android:versionCode="1"
    android:versionName="1.0" >

<uses-sdk android:minSdkVersion="4"
    android:targetSdkVersion="11" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".TestIceCreamSActivity"
            android:theme="@android:style/Theme.Holo.Light"
            android:label="@string/app_name" 
            android:uiOptions="splitActionBarWhenNarrow" >

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest>

/***** Contents of TestIceCreamSActivity.java *****/

package test.icecreams;

import android.app.Activity;
import android.os.Bundle;
import test.icecreams.R;

public class TestIceCreamSActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
}

/***** Contents of ActionBarUsage.java *****/

import test.icecreams.R;
import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.widget.ImageView;
import android.widget.LinearLayout;
public class ActionBarUsage extends Activity {

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.main_activity, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    LinearLayout bkgr = (LinearLayout)findViewById(R.id.LinearLayout1);
    ImageView image = (ImageView)findViewById(R.id.imageView1);

    switch (item.getItemId()) {
    case R.id.buttonone:
            image.setImageResource(R.drawable.ponies);
            return true;
    case R.id.buttontwo:
            image.setImageResource(R.drawable.hello);
            return true;
    case R.id.buttonthree:
            bkgr.setBackgroundResource(R.color.backgroundwhite);
            return true;
    case R.id.buttonfour:
            bkgr.setBackgroundResource(R.color.background);
            return true;
    case R.id.buttonfive:
            //The alert code goes here!
            return true;
    default :
        return super.onOptionsItemSelected(item);
    }
}
}

/***** Contents of main_activity.xml: *****/

<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@+id/buttonone"
    android:title="@string/showimage1"
    android:icon="@drawable/helloicon"
    android:showAsAction="ifRoom|withText"/>
    <item android:id="@+id/buttontwo"
          android:title="@string/showimage2" 
          android:icon="@drawable/poniesicon" 
          android:showAsAction="ifRoom|withText"/>
    <item android:id="@+id/buttonthree" 
          android:title="@string/showwhite" 
          android:showAsAction="ifRoom|withText"/>
    <item android:id="@+id/buttonfour" 
          android:title="@string/showblack" 
          android:showAsAction="ifRoom|withText"/>
    <item android:id="@+id/buttonfive"
          android:title="@string/showalert" 
          android:showAsAction="ifRoom|withText"/>
</menu>

/***** Contents of main.xml: *****/
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/LinearLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#00000000"
    android:orientation="vertical" >

<TextView
    android:id="@+id/hellotext"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:debuggable="true"
    android:text="@string/hello" />

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:contentDescription="@string/cd"
    android:src="@drawable/ponies" />

</LinearLayout> 
```

我也有 strings.xml 的内容，但我认为它可能是所有这些中最不重要的。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T13:54:49.437

事实上，我知道您想创建一个在 ICS 上运行的应用程序，其布局为*main.xml*和一个上下文菜单，如 *main_activity.xml*。您不必创建两个活动，只需启动将在应用程序中启动的主要活动。

请尝试在同一个文件 TestIceCreamSActivity.java 中制作所有活动：

```
package test.icecreams;

import test.icecreams.R;
import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.widget.ImageView;
import android.widget.LinearLayout;

public class TestIceCreamSActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.main_activity, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        LinearLayout bkgr = (LinearLayout)findViewById(R.id.LinearLayout1);
        ImageView image = (ImageView)findViewById(R.id.imageView1);

        switch (item.getItemId()) {
        case R.id.buttonone:
                image.setImageResource(R.drawable.ponies);
                return true;
        case R.id.buttontwo:
                image.setImageResource(R.drawable.hello);
                return true;
        case R.id.buttonthree:
                bkgr.setBackgroundResource(R.color.backgroundwhite);
                return true;
        case R.id.buttonfour:
                bkgr.setBackgroundResource(R.color.background);
                return true;
        case R.id.buttonfive:
                //The alert code goes here!
                return true;
        default :
            return super.onOptionsItemSelected(item);
        }
    }
} 
```

还请在清单中将您的目标 SDK 版本更改为 14 级（ICS 4.0 -> 4.0.2）或 15（4.0.3）：

```
<uses-sdk android:minSdkVersion="4"
          android:targetSdkVersion="15" /> 
```

# sql - 在对其执行操作之前检查表是否存在？

> ID：10660941
> 
> 赞同：4
> 
> 时间：2012-05-18T23:25:23.047
> 
> 标签：sql, sql-server, tsql

在寻找这个问题的答案时，我[在 StackOverflow 上找到了这篇受欢迎的帖子](https://stackoverflow.com/questions/167576/sql-server-check-if-table-exists)。不幸的是，它并不完全有效。问题是这样的：

有没有办法在执行修改（例如）*之前*`INSERT`检查表（或另一个对象）是否存在？前面提到的帖子暗示了这一点：

```
IF (EXISTS (SELECT * 
                 FROM INFORMATION_SCHEMA.TABLES 
                 WHERE TABLE_SCHEMA = 'dbo' 
                 AND  TABLE_NAME = 'questionableTable'))
BEGIN
    INSERT INTO dbo.questionableTable VALUES ('success!');
END 
```

错误：`Invalid object name 'dbo.questionableTable'.`

问题在于 SQL Server 在解析`INSERT`语句时失败，说明该语句`dbo.questionableTable`不存在。之前的`INFORMATION_SCHEMA`检查似乎不影响它。

**有没有办法编写这种查询？**对于 SQL Server，尤其如此。但我也希望看到其他数据库系统的类似操作，如果存在这样的事情的话。

这个问题背后的动机是因为我们有多个数据库，其中包含彼此表的子集。我想要的是有一个可以应用于所有数据库的脚本，并且只修改那里存在的表（并且在执行时不会出错）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T23:43:30.383

通过函数使用*动态*SQL ：[`EXEC()`](http://msdn.microsoft.com/en-us/library/ms188332.aspx)

```
IF (EXISTS (SELECT * 
            FROM INFORMATION_SCHEMA.TABLES 
            WHERE TABLE_SCHEMA = 'dbo' 
            AND TABLE_NAME = 'questionableTable'))
BEGIN
    EXEC('INSERT INTO dbo.questionableTable VALUES (''success!'')');
END 
```

该`EXEC()`函数将字符串作为 SQL 执行，但作为一个字符串，它在*执行*之前不会被评估，因此字符串中提到的表在编译时不需要存在。这允许在创建表*之前定义存储过程。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T23:42:20.530

我在本地服务器上对此进行了测试，它似乎可以工作：

```
if exists (select * from dbname.sys.tables where name='tablename')
begin
select * from dbname.dbo.tablename
end 
```

# c# - 有些键盘比其他键盘更健谈吗？

> ID：10660945
> 
> 赞同：7
> 
> 时间：2012-05-18T23:25:56.267
> 
> 标签：c#, winforms, arrow-keys, beep, keyeventargs

首席开发人员说，当他使用我的应用程序时，当他通过方向箭头键在 TableLayoutPanel 上的 TextBox 之间移动时，他的键盘会发出哔哔声。

但是，我没有听到这样的听觉活动。

这是我的代码：

```
// Had to intercept Up and Down arrows from Windows
private void textBoxPlatypi_PreviewKeyDown(object sender, PreviewKeyDownEventArgs e) {
    TextBox tb = (TextBox)sender;

    if (e.KeyCode.Equals(Keys.Up)) {
        SetFocusOneRowUp(tb.Name);
        return;
    }
    if (e.KeyCode.Equals(Keys.Down)) {
        SetFocusOneRowDown(tb.Name);
        return;
    }
}

private void textBoxPlatypi_KeyDown(object sender, KeyEventArgs e) {
    TextBox tb = (TextBox)sender;

    if (e.KeyCode.Equals(Keys.Left)) {
        SetFocusOneColumnBack(tb.Name);
        e.Handled = true;
        return;
    }
    if (e.KeyCode.Equals(Keys.Right)) {
        SetFocusOneColumnForward(tb.Name);
        e.Handled = true;
        return;
    }
} 
```

..他认为我可能需要“e.Handled”，但这在 PreviewKeyDown 事件中不可用。

有没有办法抑制哔哔声（这显然只发生在某些键盘或特定设置上（他使用的是 Windows7，我还在 XP 上））？

## 更新

我现在有这个代码：

```
private void textBoxPlatypus1_PreviewKeyDown(object sender, PreviewKeyDownEventArgs e) {
    switch (e.KeyCode) {
        case Keys.Down:
        case Keys.Up:
            e.IsInputKey = true;
            break;
    }
}

private void textBoxPlatypus1_KeyDown(object sender, KeyEventArgs e) {
    TextBox tb = (TextBox)sender;

    if (e.KeyCode.Equals(Keys.Up)) {
        SetFocusOneRowUp(tb.Name);
        e.Handled = true;
        return;
    }
    if (e.KeyCode.Equals(Keys.Down)) {
        SetFocusOneRowDown(tb.Name);
        e.Handled = true;
        return;
    }

    if (e.KeyCode.Equals(Keys.Left)) {
        SetFocusOneColumnBack(tb.Name);
        e.Handled = true;
        return;
    }
    if (e.KeyCode.Equals(Keys.Right)) {
        SetFocusOneColumnForward(tb.Name);
        e.Handled = true;
        return;
    }
} 
```

...但他仍然听到哔哔声（我没有）。

他在阿拉斯加并使用 Windows 7；我在加利福尼亚并使用 XP。我不知道是否存在某种组合/不匹配问题......

## 再次更新

我知道这可能会让一些人感到震惊，但阿拉斯加/加利福尼亚的断线与此无关。我现在也听到哔哔声，而且不是来自箭头键。当在 TextBox 中输入一个值，然后，如果该文本框已经有一个字符，焦点将移至下一个文本框并在那里输入值（这是我的代码导致这种情况发生）。但是恼人的哔哔声似乎是随机的——我还没有弄清楚哔哔声的模式（有时会，有时不会）......有没有人遇到过类似的事情，或者，更好的是，知道如何抑制蜂鸣声？我所做的只是按下键盘上方的“1”或“2”键。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-19T00:16:52.937

[PreviewKeyDownEvent](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.previewkeydown.aspx)中无法像正常的 KeyDown 事件那样处理/抑制 KeyEvent。文档建议将 PreviewKeyDownEventArgs.IsInputKey 属性设置为 true 以处理 KeyDown 事件中通常不可用的按键。

在上面的链接中，他们以按钮为例：

> 某些按键（例如 TAB、RETURN、ESC 和箭头键）通常会被某些控件忽略，因为它们不被视为输入按键...通过处理 Button 的 PreviewKeyDown 事件并将 IsInputKey 属性设置为 true，您可以在按下箭头键时引发 KeyDown 事件。但是，如果您处理箭头键，焦点将不再移动到上一个或下一个控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T23:57:58.077

试试[这个](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.suppresskeypress.aspx)：

```
 e.SuppressKeyPress = true; 
```

# ivy - 让 Ivy 识别 ant#ant 和 ant#org.apache.ant 是冲突的

> ID：10660949
> 
> 赞同：0
> 
> 时间：2012-05-18T23:26:13.647
> 
> 标签：ivy

我的构建中有 ant-1.7.0.jar 和 ant-1.6.2.jar，这是破坏性测试。查看 ivy:report，似乎 1.6.2 被解析为 ant#ant，而 1.7 被解析为 ant#org.apache.ant。

那么如何配置 Ivy 将 ant 和 org.apache.ant 视为同一个组织呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T01:31:15.390

你不能，但你可以创建一个全局[排除](http://ant.apache.org/ivy/history/latest-milestone/ivyfile/exclude.html)：

```
<ivy-module version="2.0">
    ..
    ..    
    <dependencies>
        ..
        ..
        <!-- Global exclusions -->
        <exclude org="ant" module="ant"/>
    </dependencies>

</ivy-module> 
```

# git - Git rebase 编辑和一些分支

> ID：10660952
> 
> 赞同：1
> 
> 时间：2012-05-18T23:26:42.040
> 
> 标签：git, git-rebase

我有这样的事情：

```
 /-E-F - branch1
A-B-C - master
     \-X - branch2 
```

在我重新定位到 B 并在 master 分支上对其进行更改后，我得到了这样的结果：

```
 /-E-F - branch 
A-B-C
 \   \-X - branch2
  \-B*-C* - master 
```

之后，我尝试在“分支”上以相同的方式 B 进行变基和编辑，我得到了这样的结果：

```
 /B**-C**-E-F - branch 
A-B-C
 \   \-X - branch2
  \-B*-C* - master 
```

我的意图是为所有分支编辑 B 并获得如下内容：

```
 /-E-F - branch1
A-B*-C - master
      \-X - branch2 
```

我该如何解决？

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T07:33:46.297

假设您可以回到起始图（使用 reflog 查看提交恢复），似乎更容易进行更改以掌握并将其（使用 --no-ff）合并到分支 1 和分支 2：

```
$ git checkout C
# make modifications
$ git commit
$ git checkout branch1
$ git merge --no-ff master
$ git checkout branch2
$ git merge --no-ff master

      /-E-F-G - branch1
     /     /
A-B-C-----D - master
     \     \  
      \-X---Y - branch2 
```

除此以外：

```
 /-E-F - branch1
A-B-C - master
     \-X - branch2

$ git checkout B
# make your modifications
$ git commit

     /-E-F - branch1
A-B-C - master
   \ \-X - branch2
    \-B*

$ git rebase --onto B* B branch1

     /-E-F
A-B-C - master
   \ \-X - branch2
    \-B*-C*-E*-F* - branch1

$ git rebase --onto C* master branch2

     /-E-F
A-B-C - master
   \ \-X
    \-B*-C*-E*-F* - branch1
          \-X* - branch2

$ git checkout master
$ git reset --hard C*

     /-E-F
A-B-C
   \ \-X 
    \      /-E*-F* - branch1
     \-B*-C* - master
           \-X* - branch2 
```

# json - JSON分层对象以减少重复数据

> ID：10660953
> 
> 赞同：0
> 
> 时间：2012-05-18T23:26:45.003
> 
> 标签：json, data-structures

我正在使用 .json 文件来保存应用程序的字体/文本信息。现在我添加了不同的语言，我需要能够为某些字体指定不同的大小，因为该语言中单词的大小不同，例如德语单词往往比英语长，所以我可能想要更小的字体。

我的问题是我的 .json 文件中会有大量重复数据，因为每种语言的大多数字体都将保持不变。这是我想以某种方式减少的重复数据的示例，我只是不知道如何格式化我的 .json 文件来这样做（请注意，我已经删除了很多细节，这样会更容易阅读）：

```
"styles":
{
    "en":
    {
        "main_title" :
        {
            "font" : "font://verdana-bold.ttf",
    "size" : 25,
        },
        "heading" :
        {
            "font" : "font://verdana-bold.ttf",
    "size" : 18,
        },
    },
    "de":
    {
        "main_title" :
        {
            "font" : "font://verdana-bold.ttf",
    "size" : 25,
        },
        "heading" :
        {
            "font" : "font://verdana-bold.ttf",
    "size" : 16,
        },
    },
    "fr":
    {
        "main_title" :
        {
            "font" : "font://verdana-bold.ttf",
    "size" : 25,
        },
        "heading" :
        {
            "font" : "font://verdana-bold.ttf",
    "size" : 18,
        },
    }
} 
```

请注意，在上面的示例中，我使用了三种语言，并且所有语言都使用相同的字体信息，除了 deutsche 使用较小的“标题”字体。我想做的是这样的：

```
"styles":
{
    "en", "de", "fr":
    {
        "main_title" :
        {
            "font" : "font://verdana-bold.ttf",
    "size" : 25,
        },
        "heading" :
        {
            "font" : "font://verdana-bold.ttf",
    "size" : 18,
        },
    },
    "de":
    {

        "heading" :
        {
            "font" : "font://verdana-bold.ttf",
    "size" : 16,
        },
    },
} 
```

在此示例中，我让所有三种语言都使用相同的信息，但能够在德意志语言字体中定义一个更改。显然，我的第二个示例无法正确阅读，因为它的语法不正确，但希望这能理解我想要实现的目标。JSON中是否有任何语法可以让我做这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:33:33.570

我不相信 JSON 会这样做，但是您可以拥有一个“默认”对象，该数据的消费者可以查看其他语言对象中缺少的任何值：

```
"styles": {
    "default": {
        "main_title" : {
            "font" : "font://verdana-bold.ttf",
            "size" : 25,
        },
        "heading" : {
            "font" : "font://verdana-bold.ttf",
            "size" : 18,
        },
    },
    "de": {
        "heading" : {
            "size" : 16,
        }
    }
} 
```

如果您需要指定允许的语言，只需将其添加为对象的另一个属性：

```
"styles": {
    "languages": ["en", "de", "fr"],
    ...
} 
```

# java - 计数循环

> ID：10660955
> 
> 赞同：-1
> 
> 时间：2012-05-18T23:27:03.977
> 
> 标签：java, loops, if-statement

我有一个巨大的动画循环来控制视频游戏的程序。我有这个 if 语句，它被执行了好几次，因为一旦它是真的，它就会因为循环而继续执行。我需要这个语句只执行一次。我知道解决它的一种方法是将整数变量作为计数器，但我想知道是否还有其他方法可以解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T23:31:40.843

你说只要*它*是*真的*，它就会继续被执行。当您不想再`if`执行此语句时，请 make *it* `false`，如果您不能这样做，则设置某种`boolean`标志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T23:34:05.733

您可以使用[continue](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html)。在伪代码中

```
set flag = false
for(var1 == var2)
  ...//do whatever you do in loop
  if(flag)
    continue
  if(var3 == var4)
    set flag = true
  ...//do whatever in if statment
end for loop 
```

或者

```
set flag = false
for(var1 == var2)
  ...//do whatever you do in loop
  if(var3 == var4 AND !flag)
    set flag = true
  ...//do whatever in if statment
end for loop 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T23:35:32.690

这是因为它是一个昂贵的 if 语句吗？您可以尝试添加短路逻辑：

```
for(...)
{
     if(flag == false && ...)
     {
          flag = true;
     }
} 
```

如果您担心进行比较的性能......您可以将其分成两个循环。一个用于条件为假时，第二个用于条件为真时。

我想一些编译器优化可能已经解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T23:40:50.297

使 if 语句检查特定数字，例如

```
for(i=0;i<10000;i++) {
    if(i==345) {
        // do something...
    }
} 
```

# java - Spring中的异步文件上传

> ID：10660961
> 
> 赞同：11
> 
> 时间：2012-05-18T23:27:41.030
> 
> 标签：java, spring-mvc, file-upload, asynchronous, apache-commons-fileupload

这就是我正在做的事情。我想通过 Ajax 将多部分文件上传到我的 Spring Web 应用程序。当服务器收到 POST 请求时，它会在数据库中创建一个票号。然后它启动一个处理实际文件上传的线程。然后服务器返回票号。

我正在使用 CommonsMultipartResolver 来处理请求，并且我已将 resolveLazily 标志设置为 true，以便不会立即解析 Multipart。

所以这是我所拥有的

```
@Controller
public class myController{

    @RequestMapping(value = "/upload", method = RequestMethod.POST)
    @ResponseStatus(value = HttpStatus.OK)
    @ResponseBody
    public String upload(MultipartHttpServletRequest request, String fileName){

        String ticket = dao.createUploadTicket(fileName);
        Runnable run = new Runnable(){

            @Override
            public void run(){

                dao.writeUpdate(ticket, "Getting data from request");
                final MultipartFile file = request.getFile("theFile");
                dao.writeUpdate(ticket, "Multipart file processed");
                try {
                   dao.writeUpdate(ticket, "Saving file to disk");
                   file.transferTo(new File("/myDirectory"));
                   dao.writeUpdate(ticket, "File saved to disk");
                }
                catch(Exception e){
                   dao.writeUpdate(ticket, "File upload failed with the exception " + e.toString());
                }
            }
        };
        Thread t = new Thread(run);
        t.start();
        return ticket;
    }
} 
```

所以这里的重点是票号可以用来获取进度更新。假设正在上传一个大文件。使文件上传 POST（在本例中为 Ajax 请求）的客户端可以异步执行此操作并取回票号。客户端可以使用该票号来确定文件上传的阶段并在另一个页面中显示信息。

另一种用途是，我可以有一个 HTML 页面，它向服务器请求所有票号，然后显示服务器上发生的所有文件上传的“实时”视图。

我无法让它工作，因为一旦控制器返回，Spring 就会在 CommonsMultipartResolver 中调用 cleanupMultipart()。由于 resolveLazily 标志设置为 false，所以当 cleanupMultipart() 被调用时，它将开始解析和初始化多部分文件。这会导致调用“request.getFile("theFile");”之间的竞争条件。在 runnable 和 cleanupMultipart() 调用中最终导致异常。

有人有想法么？我是否通过想要进行后端异步文件处理来打破某种 HTTP 合同。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T05:53:24.960

HTTP 请求已经在自己的线程中执行，客户端可以并行、异步地发出少量请求。所以你不需要开始一个新线程。只需像往常一样在主线程中保存/处理文件。只需在客户端进行“*异步文件上传”即可。*

此外，您应该仅在处理完输入后发送 http 响应。我的意思是您无法读取输入标头、做出 http 响应并继续从浏览器读取数据。使用输入 -> 处理它 -> 发送输出，HTTP 1/1.1 协议是如何工作的。

如果您需要发送票号来上传，您可以在实际上传之前创建它，使用两步上传，例如：

*   Ajax GET 请求获取票号
*   POST 文件内容和票号（从上一步收到）
*   + ajax GET 获取票证的当前状态，稍后随时异步

# erlang - 为什么 EUnit 将 .beam 文件编译成 .eunit/ebin？

> ID：10660962
> 
> 赞同：1
> 
> 时间：2012-05-18T23:28:02.227
> 
> 标签：erlang, erlang-otp, eunit, erlang-ports

*免责声明：这个问题的作者主要有 Erlang/OTP 的理论知识。*

我有一个小型 OTP 应用程序，它`myapp/ebin`通过`open_port()`. 当我运行应用程序本身时，一切顺利，可执行文件的端口已成功打开。

但是当我尝试为应用程序运行单元测试时，依赖于`open_port()`失败的单元测试，因为当开始时`EUnit`应用程序启动时，尝试在`myapp/.eunit/ebin`.

如何在不更改应用程序本身代码的情况下更改该行为？如何使用与运行应用程序本身相同的当前目录运行 EUnit 测试？（我的意思是更改提供可执行文件路径的代码只是为了能够运行 EUnit 并不是一个好主意）。

编辑：我遵循了 Erlang[邮件列表](http://lists.basho.com/pipermail/rebar_lists.basho.com/2011-January/000473.html)中的建议，但是`code:priv_dir(myapp_name)`返回`{error, bad_name}`。

编辑：我可以看到`.eunit/`包含`modulename.beam`文件并且`ebin/`包含`modulename.beam`文件和`modulename_tests.beam`文件。现在我完全迷失了。当我运行时`make test`，`rebar`运行`eunit`命令，该命令调用目录中的每个`modulename_tests.beam`文件，该文件`ebin/`调用目录中的相应`modulename.beam`文件`.eunit/`（`filename:absname("")`清楚地表明`modulename.beam`文件是`.eunit/`在测试期间执行的）。为什么会这样？为什么我们需要`modulename.beam`从目录运行文件`.eunit/`而不是`ebin/`?

为什么我们实际上需要在`myapp/ebin`和中有相同的 .beam 文件`myapp/.eunit/ebin`？

PS我已经阅读了[官方文档](http://ww.erlang.org/doc/apps/eunit/chapter.html#Unit_testing)并没有找到解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T22:02:23.943

EUnit 本身不会这样做 - .eunit 目录是 Rebar 使用的约定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T00:37:50.857

使用`erlang`启动脚本“.erlang”，它可以解决你的问题。

在 .erlang 文件中，用于`code:add_pathz/N`添加必要的路径。

在阅读`couchdb`源代码之前，有一个如何使用`priv`目录的示例。也许解决方案对您有帮助。`open_port`它用函数包装`start_port`，并在函数中设置目录`start_port`。

在文件中`couch_os_daemon.erl`

```
start_port(Command) ->
    PrivDir = couch_util:priv_dir(),
    Spawnkiller = filename:join(PrivDir, "couchspawnkillable"),
    Port = open_port({spawn, Spawnkiller ++ " " ++ Command}, ?PORT_OPTIONS),
    {ok, Port}.

stop_port(#daemon{port=Port, kill=undefined}=D) ->
    ?LOG_ERROR("Stopping daemon without a kill command: ~p", [D#daemon.name]),
    catch port_close(Port);
stop_port(#daemon{port=Port}=D) ->
    ?LOG_DEBUG("Stopping daemon: ~p", [D#daemon.name]),
    os:cmd(D#daemon.kill),
    catch port_close(Port). 
```

在文件 couch_util.erl

```
priv_dir() ->
    case code:priv_dir(couch) of
        {error, bad_name} ->
            % small hack, in dev mode "app" is couchdb. Fixing requires
            % renaming src/couch to src/couch. Not really worth the hassle.
            % -Damien
            code:priv_dir(couchdb);
        Dir -> Dir
    end.

start_driver(LibDir) ->
    case erl_ddll:load_driver(LibDir, "couch_icu_driver") of
    ok ->
        ok;
    {error, already_loaded} ->
        ok = erl_ddll:reload_driver(LibDir, "couch_icu_driver");
    {error, Error} ->
        exit(erl_ddll:format_error(Error))
    end. 
```

你可以 grep `priv`，可以找到很多例子。

# zend-framework - 在多个模块中使用的模型。它应该位于哪里？

> ID：10660967
> 
> 赞同：0
> 
> 时间：2012-05-18T23:29:07.657
> 
> 标签：zend-framework

我正在开发一个 ZF1 + Doctrine2 应用程序，它有两个模块：默认是一个默认的标准网站和提供 REST 接口的“休息”。很明显，两个模块使用相同的模型，因为它们共享许多常见的数据库操作。我的架构的目标是避免从控制器调用 Doctrine EM 方法，在其之上创建抽象层（某种 API）以实现解耦和代码一致性（我个人不喜欢有时调用模型，有时在控制器中构建查询但我可能错了）。

我很想将模型放在库中（/library//Users/Users.php 等），但不确定库是否适合在这里，因为模型应该放在应用程序文件夹中，它们不扩展任何 ZF 类。但是库是整个应用程序之间共享的，这让我考虑了它。

我想出的其他选择是将它放在 application/modules/default/models 中，但如果我这样做，它在逻辑上与其他模块分开，尽管这些模型是全局的。

在这种情况下哪种解决方案更好，或者还有其他我没有提到的正确方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T13:07:06.407

我尝试为跨项目的东西保留我的库文件夹，这是我放入的库的一种供应商文件夹，可以直接使用或在我自己的类中扩展（根据需要添加 autoloadernamespaces 条目）。

在多模块应用程序中，我在应用程序级别保留跨模块的东西——比如公共模型、映射器、视图帮助程序和将被所有模块使用的部分脚本——用 appnamespace 命名（`Application_`或`My_`类似的东西） ）。然后，我推送所有模块——包括默认模块！- 进入`modules`文件夹。模块特定的东西——比如控制器、表单、视图——然后用模块名称命名。就像是：

```
/application
    /configs
        application.ini
    /layouts
    /models # app-level!
    /modules
        /admin
            /controllers
            /forms
            /models
            /views
                /helpers
                /scripts
        /front
            /controllers
            /forms
            /models
            /views
                /helpers
                /scripts
    /views  # app-level!
        /helpers
        /scripts    
/data
    /cache
/library
    /App
    /Zend
/public
    index.php
    /assets
        /css
        /img
        /js
/scripts 
```

通常，模块引导类 - 扩展`Zend_Application_Module_Boostrap`- 注册正确的资源自动加载器映射，使对象实例化变得轻而易举。

注意：由于我更喜欢​​我的控制器使用它们所在的模块命名空间，因此我需要在前端控制器上设置一个参数以让他意识到这一点：

```
resources.frontController.params.prefixDefaultModule = true 
```

tl：博士：

*   跨项目类驻留在`library`并使用它们自己的 lib 命名空间。
*   应用级别的跨模块类驻留在应用级别并使用应用命名空间
*   模块级类驻留在模块文件夹中并使用模块命名空间

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T08:40:44.773

ZF 1.x 并不是真正的模块化，我认为 ZF 1.x 中的模块有点用词不当。在我看来，它们更像是域库。话虽如此，我这样看待代码分离（纯粹的观点）。

*   我希望在我放入库中的另一个项目中重用或可重用的任何代码。例如。查看助手、动作助手、抽象模型类、基础模型、插件等...

*   任何特定于应用程序的代码，将在我放在应用程序级目录中的应用程序中普遍使用。这是具体的数据映射器、DbTable 模型（我不使用 Doctrine）、表单和布局之类的东西……

*   任何专门属于模块（域）并且不会或不能在我放在模块级目录中的其他任何地方使用的代码。这包括特殊视图和动作助手之类的东西，一种形式，主要是我放置域（实体）模型的地方。

为了说明这一点，我将提供一个示例（省略个人命名空间）：

我的应用程序中有一个名为*music的模块，该模块有一个名为**'music'*的数据库表。
所以这些是我可能必须在我的模块中使用这个 Db 表的文件。

```
//The DbTable model
application
    /models
        /DbTable
            /Music.php //extends Zend_Db_Table_Abstract 
```

要使用该 DbTable 模型，我构建了一个使用 2 个文件的映射器

```
//Base mapper class
library
    /Application
        /Model
            /Mapper.php
//The concrete mapper
application
    /modules
        /models
            /MusicMapper.php //extends Namespace_Application_Model_Mapper 
```

并且要使用该映射器，我将拥有一个由 2 个文件组成的域模型，一个基本实体类和一个具体实体类。

```
//Base entity class
library
    /Application
        /Model
            /Entity.php

//and the concrete entity class
application
    /modules
        /models
            /Music.php //extends Namespace_Application_Model_Entity 
```

我觉得以这种方式组织我的文件和类可以使代码尽可能干燥，而不会过于混乱和分散。

我希望这有帮助。

# wordpress - 将单个目录重定向到 HTTPS

> ID：10660968
> 
> 赞同：0
> 
> 时间：2012-05-18T23:29:12.663
> 
> 标签：wordpress, .htaccess, mod-rewrite

1.  我想将目录`/api/`及其之后的所有内容重定向到 HTTPS。如果访问者尝试使用 HTTPS 访问某些内容，则其他所有内容都必须重定向到 HTTP。

2.  我希望 WordPress`/api/`从当前的 mod 重写中忽略目录（以及它之后的所有内容）。

这是我当前的标准 WordPress .htaccess：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T02:11:34.223

您是否尝试过添加：

```
RewriteCond %{REQUEST_URI} YourFolderName 
RewriteRule ^(.*)$ https://www.example.com/YourFolderName /$1 [R,L] 
```

（从[这里](http://www.besthostratings.com/articles/force-ssl-htaccess.html)获取更多信息）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T02:23:19.787

尝试这个：

```
 RewriteEngine On
    RewriteCond %{REQUEST_URI} ^/api/ [NC]
    RewriteRule .* https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

# ios - 我的 iPhone 用户所在位置的参考磁场是多少？

> ID：10660973
> 
> 赞同：0
> 
> 时间：2012-05-18T23:29:40.077
> 
> 标签：ios, iphone, field, magnetometer

有人告诉我，Apple 将 World Magnetic Model 移植到他们的 iOS 中。该模型本身来自国家地球物理数据中心，在他们的网站上，您可以输入您的坐标以获得该点地球磁场强度的值（以及其他值）。我可以在 iOS 中执行此操作，还是需要移植 NGDC 模型才能获得此参考值？

请注意，我正在寻找磁场强度，而不是方向或偏角，并且我不希望用户的磁力计读数。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:38:01.520

[我不认为苹果真的把它放到了 iOS 中，只有一个名为World Magnetic Model](http://itunes.apple.com/us/app/world-magnetic-model/id349519296?mt=8)的第三方应用程序。因此，如果您想使用数据，您可能需要 NGDC 模型。由于这在 C 中也可用，因此您无需进行太多移植。Objective-C 是 C 的超集，因此 C 代码可以在 iOS 中正常运行。您只需要处理进出的数据...

# asp.net - 实体框架，在 webform 应用程序中使用上下文

> ID：10660974
> 
> 赞同：0
> 
> 时间：2012-05-18T23:29:42.413
> 
> 标签：asp.net, entity-framework-4, webforms, objectcontext

关于实体框架以及如何使用对象上下文的相当简单的问题。

在一个 asp.net webform 应用程序中，我在一个数据类中实现了大多数数据获取器，并试图确定它是否更好（在一般意义上更好）为整个类提供一个私有上下文或在每个类中声明一个上下文方法。

示例 1：

```
public class Data
{
     private MyEntity context = new MyEntity();
     public Customer GetCustomer()
     {
        return context.Customer.Single();
     }

     public Order GetOrder()
     {
        return context.Order.Single();
     }
} 
```

或示例 2：

```
public class Data
{
     public Customer GetCustomer()
     {
        using (MyEntity ctx = new MyEntity()) 
        {
           return context.Customer.Single();
        }
     }

     public Order GetOrder()
     {
        using (MyEntity ctx = new MyEntity()) 
        {
           return context.Order.Single();
        }
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T00:16:28.150

我个人非常喜欢在整个回帖中使用共享上下文，但是这些场景都没有真正实现这一点。我个人的偏好是使用 ninject 之类的依赖注入容器来管理 EF 上下文的生命周期。这意味着您可以使整个回发成为事务性的。

在实施方面，我会选择以下内容：

```
public class Data
{
    private MyContext _context;
    public Data(MyContext context)
    {
       _context = context;
    }

     public Customer GetCustomer()
     {
        return _context.Customer.Single();
     }

     public Order GetOrder()
     {
        return _context.Order.Single();
     }
} 
```

具有类似于以下内容的绑定：

```
Bind<MyContext>().ToSelf().InRequestScope(); 
```

# java - Android - OpenGL - 模拟器与实际设备

> ID：10660975
> 
> 赞同：3
> 
> 时间：2012-05-18T23:30:11.527
> 
> 标签：java, android, opengl-es, rendering, textures

我正在编写一个使用 opengles 的游戏。我已经创建了我的渲染器类，并在模拟器上运行了我的游戏示例，但是没有一个纹理显示在实际设备上。我已经阅读了最常见的原因，即纹理需要为 2 倍，但是我尝试绘制一个正方形 (128x128)，并在其上映射了相同大小的纹理，这仅在模拟器上显示。除此之外，我的实际游戏将使用矩形，所以我不确定如何将正方形的纹理映射到矩形。这是我目前的代码（游戏是 2d，所以我使用的是正交模式）：编辑：我已经更新了我的代码，它现在可以正确绑定纹理并使用大小为 128x128 的纹理，但仍然只能在模拟器上看到纹理。

```
 public void onSurfaceCreated(GL10 gl, EGLConfig config)
{
    byteBuffer = ByteBuffer.allocateDirect(shape.length * 4);
    byteBuffer.order(ByteOrder.nativeOrder());
    vertexBuffer = byteBuffer.asFloatBuffer();
    vertexBuffer.put(cardshape);
    vertexBuffer.position(0);

    byteBuffer = ByteBuffer.allocateDirect(shape.length * 4);
    byteBuffer.order(ByteOrder.nativeOrder());
    textureBuffer = byteBuffer.asFloatBuffer();
    textureBuffer.put(textureshape);
    textureBuffer.position(0);

    // Set the background color to black ( rgba ).
    gl.glClearColor(0.0f, 0.0f, 0.0f, 0.5f);
    // Enable Smooth Shading, default not really needed.
    gl.glShadeModel(GL10.GL_SMOOTH);
    // Depth buffer setup.
    gl.glClearDepthf(1.0f);
    // Enables depth testing.
    gl.glEnable(GL10.GL_DEPTH_TEST);
    // The type of depth testing to do.
    gl.glDepthFunc(GL10.GL_LEQUAL);
    // Really nice perspective calculations.
    gl.glHint(GL10.GL_PERSPECTIVE_CORRECTION_HINT, GL10.GL_NICEST);

    gl.glEnable(GL10.GL_TEXTURE_2D);
    loadGLTexture(gl);
}

public void onDrawFrame(GL10 gl) {
    gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);
    gl.glDisable(GL10.GL_DEPTH_TEST);
    gl.glMatrixMode(GL10.GL_PROJECTION); // Select Projection
    gl.glPushMatrix(); // Push The Matrix
    gl.glLoadIdentity(); // Reset The Matrix
    gl.glOrthof(0f, 480f, 0f, 800f, -1f, 1f);
    gl.glMatrixMode(GL10.GL_MODELVIEW); // Select Modelview Matrix
    gl.glPushMatrix(); // Push The Matrix
    gl.glLoadIdentity(); // Reset The Matrix

    gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
    gl.glEnableClientState(GL10.GL_TEXTURE_COORD_ARRAY);

    gl.glLoadIdentity();
    gl.glTranslatef(card.x, card.y, 0.0f);
    gl.glBindTexture(GL10.GL_TEXTURE_2D, card.texture[0]); //activates texture to be used now
    gl.glVertexPointer(2, GL10.GL_FLOAT, 0, vertexBuffer);
    gl.glTexCoordPointer(2, GL10.GL_FLOAT, 0, textureBuffer);
    gl.glDrawArrays(GL10.GL_TRIANGLE_STRIP, 0, 4);

    gl.glDisableClientState(GL10.GL_VERTEX_ARRAY);
    gl.glDisableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
}

public void onSurfaceChanged(GL10 gl, int width, int height) {
    // Sets the current view port to the new size.
    gl.glViewport(0, 0, width, height);
    // Select the projection matrix
    gl.glMatrixMode(GL10.GL_PROJECTION);
    // Reset the projection matrix
    gl.glLoadIdentity();
    // Calculate the aspect ratio of the window
    GLU.gluPerspective(gl, 45.0f, (float) width / (float) height, 0.1f,
            100.0f);
    // Select the modelview matrix
    gl.glMatrixMode(GL10.GL_MODELVIEW);
    // Reset the modelview matrix
    gl.glLoadIdentity();
}

public int[] texture = new int[1];

public void loadGLTexture(GL10 gl) {
    // loading texture
    Bitmap bitmap;
        bitmap = BitmapFactory.decodeResource(context.getResources(), R.drawable.image);
        // generate one texture pointer
        gl.glGenTextures(0, texture, 0); //adds texture id to texture array
        // ...and bind it to our array
        gl.glBindTexture(GL10.GL_TEXTURE_2D, texture[0]); //activates texture to be used now
        // create nearest filtered texture
        gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MIN_FILTER, GL10.GL_NEAREST);
        gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MAG_FILTER, GL10.GL_LINEAR);
        // Use Android GLUtils to specify a two-dimensional texture image from our bitmap
        GLUtils.texImage2D(GL10.GL_TEXTURE_2D, 0, bitmap, 0);
        // Clean up
        bitmap.recycle();
} 
```

有什么我做错了吗？还是我没有做过的事情？它在模拟器中工作得非常好，所以我只能假设它是 2 问题的力量，但就像我说的那样，我尝试在正方形上使用 128x128 纹理但它没有显示..任何帮助将不胜感激..

编辑：我还尝试将 minsdkversion 设置为 3，通过输入流 bitmap = BitmapFactory.decodeStream(is) 加载位图，将 BitmapFactory.Options.inScaled 设置为 false，将图像放在 nodpi 文件夹中，然后在原始文件夹..还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T04:08:16.900

我实际上正在寻找类似问题的解决方案。不过，我想我可能会为您提供一个临时解决方案。

问题似乎是在模拟器上正交视图被翻转。为了解决这个问题，在我的应用程序中，我们在首选项中添加了一个选项，如果没有绘制，则可以手动翻转视图。这是处理此问题的代码段：

```
if (!flipped)
{
    glOrthof(0, screenWidth, screenHeight, 0, -1, 1); //--Device
}
else
{
    glOrthof(0, screenWidth, 0, -screenHeight, -1, 1); //--Emulator
} 
```

希望这可以帮助！如果有人有更通用的解决方案，我很高兴听到它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T00:34:43.520

我没有看你的代码，但我以前一直在这条路上。在 OpenGL 中开发是一件非常痛苦的事情。如果您没有义务使用 OpenGL，请使用图形引擎。[Unity](http://unity3d.com/unity/download/)很棒，而且它是免费的。您的游戏也可以在 Android、iOS 或其他平台上运行。仔细研究你的选择。祝你好运..

# model-view-controller - Backbone JS 概念化：我正在重构一个菜单应用程序以使用 Backbone.js：我应该使用哪些视图/模型？

> ID：10660976
> 
> 赞同：0
> 
> 时间：2012-05-18T23:30:20.673
> 
> 标签：model-view-controller, backbone.js

我正在带头重构学校午餐菜单应用程序以使用backbone.js，而不仅仅是服务器渲染的html和jquery：[http](http://tinyurl.com/74nlsu5) ://tinyurl.com/74nlsu5 。我以前从未做过前端 MVC，而且我无法从概念上弄清楚视图/模型/集合是什么。

有人可以看看该网站并推荐一些模型/视图/集合吗？像这样概念化一个完整的菜单站点比简单的 TODO 或我见过的许多示例要复杂一些，因此非常感谢 kickstart 以确保我从正确的角度开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T04:58:19.207

在我的回答中提供使用 Backbone制作**FULL Site**的答案真的很难。因此，我会为您提供这些提示，查看适用于您网站的内容并根据您的喜好对其进行修改。（我认为您现在将花费更多时间在 SO 上询问 Backbone 问题）

### 提示 #1

请设计师放置站点[示例1](http://37signals.com/svn/posts/2952-lessons-learned-from-implementing-highrises-custom-fields-feature)和[示例2的故事板](http://37signals.com/svn/posts/2431-basecamp-home-page-redesign)

### 提示 #2

从storyboard中画出Grid的把各个功能模块作为MVC组件的[例子](http://www.sencha.com/learn/architecting-your-app-in-ext-js-4-part-1)

### 提示 #3

将您的模型、集合细化为可消耗和可维护的数量。然后再细化一些。根据我的经验，我开发的页面从来没有超过 3 个模型和两个集合。

### 提示 #4

重用，重用，再重用。服务器资源和数据库调用成本很高（除非通过缓存、索引和智能编程智能地实现）。选择客户端 localStorage 缓存使用脚本如[Kizzy](https://github.com/ded/Kizzy)，使用相同的模型显示不同的视图

### 提示 #5

所有客户想要的是解决他们的问题。不要通过他们的哲学。用户体验设计并不重要，我遇到的网站看起来非常简单，而且在工作上真的很棒。（我没有时间看你花哨的叮当香蕉[意味着所有花哨的动画，闪亮的按钮]，但其他开发者会这样做）

### 提示 #6

与单个模型坐在一起，查看和收集完成它。尝试使用您认为客户会做什么（不是您，甚至不是您的经理）的 UI，您的意图是找到怪癖。我注意到，每次我点击注册时，时事通讯的注册都会附加验证消息

### 提示 #7

永远不要假设从服务器发送的 html 中存在任何视图。视图应该是**自包含的**

还有什么要我回答的，我会在这里添加：）

# c++ - 如何加粗上下文菜单项？

> ID：10660978
> 
> 赞同：3
> 
> 时间：2012-05-18T23:30:32.930
> 
> 标签：c++, c, windows

我想将托盘图标的上下文菜单中的第一项设为粗体。这应该很容易，但我在任何地方都找不到答案。有人可以指出我正确的方向吗？这是我用来呈现项目的代码：

```
void MenuItemWin::CreateNative(
    LPMENUITEMINFO itemInfo, HMENU nativeParentMenu, bool registerNative)
{
    ZeroMemory(itemInfo, sizeof(MENUITEMINFO)); 
    itemInfo->cbSize = sizeof(MENUITEMINFO);
    itemInfo->wID = ++UIWin::nextItemId;
    itemInfo->dwItemData = (ULONG_PTR) this;
    itemInfo->fMask = MIIM_ID | MIIM_FTYPE | MIIM_DATA;

    HMENU nativeSubmenu = 0;
    if (this->IsSeparator())
    {
        itemInfo->fType = MFT_SEPARATOR;
    }
    else
    {
        itemInfo->fMask = itemInfo->fMask | MIIM_STRING | MIIM_SUBMENU | MIIM_STATE;
        itemInfo->fType = MFT_STRING;
        itemInfo->fState = this->IsEnabled() ? MFS_ENABLED : MFS_DISABLED;
        itemInfo->dwTypeData = (LPWSTR) this->wideOldLabel.c_str();

        AutoPtr<MenuWin> wsubmenu = this->submenu.cast<MenuWin>();
        if (!wsubmenu.isNull())
            nativeSubmenu = wsubmenu->CreateNative(registerNative);

        itemInfo->hSubMenu = nativeSubmenu;

        if (this->IsCheck())
        {
            itemInfo->fState |= this->GetState() ? MFS_CHECKED : MFS_UNCHECKED;
        }
        else if (!this->iconPath.empty())
        {
            HBITMAP bitmap = UIWin::LoadImageAsBitmap(iconPath,
                GetSystemMetrics(SM_CXSMICON), GetSystemMetrics(SM_CYSMICON));
            if (bitmap)
            {
                itemInfo->fMask = itemInfo->fMask | MIIM_BITMAP;
                itemInfo->hbmpItem = bitmap;
            }
            else
            {
                std::string error = Win32Utils::QuickFormatMessage(GetLastError());
                Logger::Get("UI.MenuItem")->Error("Could not load icon (%s): %s",
                    iconPath.c_str(), error.c_str());
            }
        }
    }

    if (registerNative)
    {
        NativeItemBits* bits = new NativeItemBits;
        bits->id = itemInfo->wID;
        bits->parentMenu = nativeParentMenu;
        bits->submenu = nativeSubmenu;
        this->nativeItems.push_back(bits);
    }
} 
```

# django-testing - 在 tests.py 中测试失败，但在 python shell 中成功

> ID：10660982
> 
> 赞同：0
> 
> 时间：2012-05-18T23:31:15.173
> 
> 标签：django-testing

我是 python 和 django 的新手，我不知道我在这里做错了什么。

我有一个站点对象：

```
class Site (models.Model):
    domain = models.CharField(max_length=30)
    support_status = models.CharField(max_length=20, choices= SITE_SUPPORTED_STATUS, blank=False)
    requests = models.IntegerField()
    objects = SiteManager()
    def __unicode__(self):
        return u'%s %s' % (self.domain, self.support_status) 
```

还有一个 SiteManager 对象

```
class SiteManager(models.Manager):
    def supported_site_counts(self):
        i = self.filter(support_status__iexact="SUPPORTED").count()
        return i 
```

从控制台，方法“supported_site_counts()”工作得很好

```
>>(InteractiveConsole)
>>> from bookmark.models import Site, SiteManager
>>> Site.objects.supported_site_counts()
>>>>2012-05-18 18:09:20,027 DEBUG (0.001) SELECT COUNT(*) FROM "bookmark_site" WHERE
>>>>"bookmark_site"."support_status" LIKE SUPPORTED ESCAPE '\' ; args=(u'SUPPORTED',)
>>>>2012-05-18 18:09:20,028 DEBUG Got 1 supported site
>>>>1 
```

但是当从测试用例调用它时，计数返回为 0

```
class SiteManagerTest(unittest.TestCase):
    def test_supported_site_counts(self):
        self.x = False
        self.count = Site.objects.supported_site_counts()
        logging.debug(self.count) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:38:03.270

这可能是因为测试将建立一个与您的开发数据库分开的数据库来运行测试。您需要以编程方式或使用[夹具](https://docs.djangoproject.com/en/dev/topics/testing/?from=olddocs#django.test.TestCase.fixtures)将测试数据放入测试数据库。

# java - 需要在 Java 中获取开始菜单路径

> ID：10660987
> 
> 赞同：3
> 
> 时间：2012-05-18T23:32:36.437
> 
> 标签：java, windows-7, installation, windows-xp, admin

使用java，我想要一些可以让我获得路径的代码：1）当前用户的开始菜单2）所有用户的开始菜单

我需要 WinXP 和 Win7 的答案。所以希望有一个通用的答案可以让我两者兼得。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T05:40:36.043

您别无选择，只能编写一个 DLL 并调用本机 Windows API：

*   [`SHGetFolderPath`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762181%28v=vs.85%29.aspx)`(NULL, CSIDL_PROGRAMS, NULL, SHGFP_TYPE_CURRENT, &szPathBuffer)`
*   `SHGetFolderPath(NULL, CSIDL_COMMON_PROGRAMS, NULL, SHGFP_TYPE_CURRENT, &szPathBuffer)`

如果您确实需要开始菜单的根目录，请使用`CSIDL_STARTMENU`和`CSIDL_COMMON_STARTMENU`。
已知文件夹的完整列表：[CSIDL](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762494%28v=vs.85%29.aspx)。

如果您面向 Windows Vista 及更高版本，请使用[`SHGetKnownFolderPath`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762188%28v=vs.85%29.aspx)function 而不是`SHGetFolderPath`.

您可以使用[JNA 库](https://github.com/twall/jna#java-native-access-jna)来调用本机 Windows API，而无需自己编写本机代码，而是纯 Java 代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-19T16:06:25.210

好的，我想出了一个解决方案，但也许其他人有一个更优雅的解决方案。

我打算做一些类似“Runtime.getRuntime().exec(command);”的事情 并且该命令将是一个“reg query”来查询以下注册表项：

当前用户可以通过以下方式引用：**HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Start Menu**

所有用户都可以通过以下方式引用：**HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Common Start Menu**

这些对于 Win7 和 WinXP 都是一样的。如果其他人知道更好的解决方案，我也很乐意看看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-16T16:05:46.317

在我的程序中，我使用了一个简单的`System.getProperty("user.home") + "/Start Menu/Programs"`这给了我用户的开始菜单文件夹。

它适用于 Windows 7 和 Windows 10。我尝试了这个，因为为了获得用户的桌面，我所要做的就是调用`System.getProperty("user.home") + "/Desktop"`. 所以我认为它也可能适用于“开始”菜单，并且似乎运行良好。我可以像使用桌面一样删除文件并将其写入开始菜单。这是否是做这样的事情的正确方法，我不知道。但我只是分享对我有用的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-28T11:29:55.627

另一种选择是从 vbs API 管理开始菜单项。

我为此做了一个[Java Wrapper](https://github.com/andresoviedo/java-utilities/tree/master/build)。

```
// Install Start Menu
WindowsUtils.installStartMenuItem(WindowsUtils.SPECIALFOLDER_Programs,"my_start_menu", "explorer.exe", "http://www.google.es","Acceso directo a google");

// Uninstall Start Menu
WindowsUtils.uninstallStartMenuItem(WindowsUtils.SPECIALFOLDER_Programs, "my_start_menu"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-24T10:02:25.113

我最近发现了这个

```
public class VBSUtils {

  public static String SF_ALLUSERSDESKTOP    = "AllUsersDesktop";
  public static String SF_ALLUSERSSTARTMENU  = "AllUsersStartMenu";
  public static String SF_ALLUSERSPROGRAMS   = "AllUsersPrograms";
  public static String SF_ALLUSERSSTARTUP    = "AllUsersStartup";
  public static String SF_DESKTOP            = "Desktop";
  public static String SF_FAVORITES          = "Favorites";
  public static String SF_MYDOCUMENT         = "MyDocuments";
  public static String SF_PROGRAMS           = "Programs";
  public static String SF_RECENT             = "Recent";
  public static String SF_SENDTO             = "SendTo";
  public static String SF_STARTMENU          = "StartMenu";

  private VBSUtils() {  }

  public static String getSpecialFolder(String folder) {
    String result = "";
    try {
        File file = File.createTempFile("realhowto",".vbs");
        file.deleteOnExit();
        FileWriter fw = new java.io.FileWriter(file);

        String vbs = "Set WshShell = WScript.CreateObject(\"WScript.Shell\")\n"
                     + "wscript.echo WshShell.SpecialFolders(\"" + folder + "\")\n"
                     + "Set WSHShell = Nothing\n";

        fw.write(vbs);
        fw.close();
        Process p = Runtime.getRuntime().exec("cscript //NoLogo " + file.getPath());
        BufferedReader input =
            new BufferedReader
              (new InputStreamReader(p.getInputStream()));
        result = input.readLine();
        input.close();
    }
    catch(Exception e){
        e.printStackTrace();
    }
    return result;
  }

      public static void main(String[] args){
          System.out.println(VBSUtils.getSpecialFolder(VBSUtils.SF_ALLUSERSSTARTMENU));
        System.out.println(VBSUtils.getSpecialFolder(VBSUtils.SF_ALLUSERSDESKTOP));
        System.out.println(VBSUtils.getSpecialFolder(VBSUtils.SF_DESKTOP));
        System.out.println(VBSUtils.getSpecialFolder(VBSUtils.SF_PROGRAMS));
        //System.out.println(VBSUtils.getSpecialFolder(VBSUtils.SF_STARTUP));
      }
    } 
```

# c# - linux上的C#服务器可伸缩性问题

> ID：10660990
> 
> 赞同：12
> 
> 时间：2012-05-18T23:33:21.607
> 
> 标签：c#, performance, mono, scalability, server-side

我有一个在 Visual Studio 2010 和 Mono Develop 2.8 上开发的 C# 服务器。NET 框架 4.0

看起来这个服务器在 Windows 上的表现比在 Linux 上好得多（在可扩展性方面）。我使用 Apache 的 ab 工具在原生 Windows（12 个物理内核）、8 核和 12 核 Windows 和 Ubuntu 虚拟机上测试了服务器可扩展性。

Windows 响应时间几乎是平坦的。当并发级别接近/超过核心数量时，它开始回升。

由于某种原因，Linux 响应时间要差得多。从并发级别 5 开始，它们几乎呈线性增长。8 核和 12 核 Linux VM 的行为也类似。

**所以我的问题是：为什么它在 linux 上表现更差？（我该如何解决这个问题？）。**

请查看随附的图表，它显示了完成 75% 请求的平均时间与请求并发的函数关系（范围栏设置为 50% 和 100%）。 ![作为请求并发的函数，完成 75% 请求的时间](../Images/8c480c8e1c67a337cb7876b06f2d57bf.png)

我有一种感觉，这可能是由于 mono 的垃圾收集器。我尝试使用 GC 设置，但没有成功。**有什么建议吗？**

一些额外的背景信息：服务器基于一个 HTTP 侦听器，该侦听器可以快速解析请求并将它们排队到线程池中。线程池负责用一些密集的数学来回复这些请求（在大约 10 秒内计算出答案）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T23:47:35.777

您需要首先找出问题所在。首先使用[HeapShot](http://www.mono-project.com/HeapShot)监控您的内存使用情况。如果不是内存，请分析您的代码以查明耗时的方法。

这个页面，[性能提示：编写性能更好的 .NET 和 Mono 应用程序](http://www.mono-project.com/Performance_Tips)，包含一些有用的信息，包括使用 mono 分析器。

过多的字符串操作和装箱通常是无法很好扩展的代码的“隐藏”罪魁祸首。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T02:27:56.590

我不相信这是因为GC。AFAIK GC 副作用应该或多或少均匀地分布在线程中。

我的盲目猜测是：您可以通过使用 ThreadPool.SetMinThreads/SetMaxThreads API 来修复它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T02:13:10.410

试试 sgen 垃圾收集器（为此，推荐使用 Mono 2.11.x）。查看 mono 手册页以获取更多详细信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T02:51:59.607

我强烈建议您对代码进行一些关于各个方法运行时间的配置文件。您很可能会看到一些锁定或类似的多线程问题，而这些问题并没有被 mono 完美处理。CPU 和 RAM 的使用也会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-29T04:11:16.233

我相信这可能与我们追踪的涉及线程池和新线程的启动行为的问题相同，以及 setMinThreads 的单声道实现中的错误。请参阅我在该线程上的答案以获取更多信息：[https ://stackoverflow.com/a/12371795/1663096](https://stackoverflow.com/a/12371795/1663096)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-21T02:31:27.190

如果你的代码抛出了很多异常，那么 mono 比 .NET 快 10 倍

# actionscript-3 - 将百分比转换为小数

> ID：10660991
> 
> 赞同：0
> 
> 时间：2012-05-18T23:33:26.473
> 
> 标签：actionscript-3

单击按钮后，我正在尝试将百分比转换为小数。我有一个用于用户输入的输入文本字段，另一个在它下面，这是一个动态文本字段，仅在单击按钮后显示结果。

我有两门课：主课和我的数学实用课。我的问题是我不知道如何从主类中的 util 类调用该函数以使其正常工作。

我无法让这最后一部分工作。这是我的代码：

```
public class Main extends Sprite
{
    private var pResult:TextField;
    private var pResult2:TextField;

    public function Main()
    {
        super();

        // calling all the functions below

        // adding my graphics to the display
        var baseDBase = new PDBase();
        this.addChild(base);
        base.x = -70;
        base.y = 30;

        //changing the font format
        var format:TextFormat = new TextFormat();//adding the object
        format.size = 14;//font sizing
        format.align = TextFormatAlign.LEFT;//font align

        //result text field
        pResult = new TextField();//adding the object
        this.addChild(pResult);//displaying the object
        pResult.border = true;//setting the border
        pResult.borderColor = 0x30FF00;//setting border color
        pResult.textColor = 0x000000;//setting the font color
        pResult.x = 28;//position left or right
        pResult.y = 70;//position up or down
        pResult.width = 142;// changing width
        pResult.height = 20;// changing height
        pResult.type = TextFieldType.INPUT;//making sure the text area is for input
        pResult.defaultTextFormat = format;//sets text format to defult
        pResult.maxChars = 32;//text limit of characters
        pResult.restrict = "0-9.";//fonts used only

        pResult2 = new TextField();//adding the object
        this.addChild(pResult2);//displaying the object
        pResult2.border = true;//setting the border
        pResult2.borderColor = 0x30FF00;//setting border color
        pResult2.textColor = 0x000000;//setting the font color
        pResult2.x = 28;//position left or right
        pResult2.y = 96;//position up or down
        pResult2.width = 142;// changing width
        pResult2.height = 20;// changing height
        pResult2.type = TextFieldType.DYNAMIC;//making sure the text area is for input
        pResult2.defaultTextFormat = format;//sets text format to defult
        pResult2.maxChars = 32;//text limit of characters
        pResult2.restrict = "0-9.";//fonts used only

        var button:Button = new Button("Calculate");
        this.addChild(button);
        button.x = 10;
        button.y = 130;
        button.addEventListener(MouseEvent.CLICK, btn_EventListener);
    }

    private function btn_EventListener(e:MouseEvent):void
    {
        MathUtil.percentToDecimal(percent)
        this.pResult2.text = percent;
    }
}

public class MathUtil
{

    public function MathUtil()
    {
    }

    public static function percentToDecimal(percentValue:Number):Number
    {
        var percent:Number = percentValue * 100;
        var roundedDecimal:Number = Math.round(percent);
        var percentResult:String = roundedDecimal;
        return percentResult;
    }
} 
```

我也收到此错误：

> 1067：将 Number 类型的值隐式强制转换为不相关的 String 类型。在 var percentResult:String = roundedDecimal;

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:53:53.483

```
this.pResult2.text = String(MathUtil.percentToDecimal(percent)); 
```

请注意，您的函数返回一个值，因此如果您这样做，返回的值将分配给文本字段。"String()" 将返回的数字转换为字符串。

编辑：啊，在这里你可以使用铸造：

```
var percentResult:String = String(roundedDecimal); 
```

# python - 如何在 Django 外部设置 ModelForm 中的字段？

> ID：10660994
> 
> 赞同：1
> 
> 时间：2012-05-18T23:33:38.120
> 
> 标签：python, django-forms, django-views

我当前的设置`views.py`如下所示

```
def order_detail(request, pk):
    order = Order.objects.get(pk=pk)

    # Define the can_something variables here.

    include_fields = []

    if can_edit_work_type:
        include_fields.append('work_type')
    if can_edit_vendor:
        include_fields.append('vendor')
    if can_edit_note:
        include_fields.append('note')

    class OrderDetailForm(forms.ModelForm):
        class Meta:
            model = Order
            fields = tuple(include_fields)

    form = OrderDetailForm(instance=order, data=request.POST)

    return render(request, 'doors/order/detail.html', {'order': order, 'form': form}) 
```

显然，我认为最好的做法是定义`OrderDetailForm`inside`forms.py`而不是`views.py`. 那么我如何移动`OrderDetailForm`到`forms.py`仍然通过`include_fields`？

我尝试过这样的事情，但没有奏效

`views.py`

```
def order_detail(request, pk):
    order = Order.objects.get(pk=pk)

    # Define the can_something variables here.

    include_fields = []

    if can_edit_work_type:
        include_fields.append('work_type')
    if can_edit_vendor:
        include_fields.append('vendor')
    if can_edit_note:
        include_fields.append('note')

    form = OrderDetailForm(instance=order, data=request.POST, include_fields=include_fields)

    return render(request, 'doors/order/detail.html', {'order': order, 'form': form}) 
```

`forms.py`

```
class OrderDetailForm(forms.ModelForm):
    class Meta:
        model = Order

    def __init__(self, include_fields, *args, **kwargs):
        super(OrderDetailForm, self).__init__(*args, **kwargs)

        self.Meta.fields = tuple(include_fields) 
```

但这没有用；它包括模型上的所有字段。我假设问题出在面向对象上。

欢迎任何提示或建议。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:44:31.990

查看 Django 代码，您可能想尝试使用`self._meta.fields = tuple(include_fields)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T03:59:23.883

您必须在初始化程序中进行修改`self.fields`，删除序列中未找到的映射中的键。

# objective-c - Mac App 上的“锁定”屏幕

> ID：10660996
> 
> 赞同：4
> 
> 时间：2012-05-18T23:33:39.713
> 
> 标签：objective-c, macos, lockscreen

在 Mac OS X 中，我需要调用什么 API 才能在整个屏幕以及菜单栏和停靠栏上放置一个窗口？此外，是否可以有效地将屏幕“锁定”到这个位置，禁用任务控制、启动板等？

我在 App Delegate 的实现文件中尝试了以下代码：

```
- (void)awakeFromNib {
    @try {
        NSApplicationPresentationOptions options = NSApplicationPresentationDisableForceQuit + NSApplicationPresentationDisableHideApplication + NSApplicationPresentationDisableProcessSwitching + NSApplicationPresentationHideDock + NSApplicationPresentationHideMenuBar + NSApplicationPresentationFullScreen;
        [NSApp setPresentationOptions:options];
        NSLog(@"Set presentation options"); 

    }
    @catch (NSException *exception) {
        NSLog(@"Error. Invalid options");
    }

} 
```

NSLog 读取“设置演示选项”，但没有其他任何反应。有小费吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-19T11:30:51.600

这基本上将涉及与“信息亭模式”相同的事情。请参阅[Apple 的 Kiosk 模式编程主题](https://developer.apple.com/library/mac/#technotes/KioskMode/Introduction/Introduction.html)。

您基本上使用`-[NSApplication setPresentationOptions:]`or`-[NSView enterFullScreenMode:withOptions:]`包含键的选项字典，该键`NSFullScreenModeApplicationPresentationOptions`的值是包含与该方法采用`NSNumber`的相同类型的表示选项值。`NSApplication`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-03T14:31:54.180

在 Xcode 中，创建一个新的 Cocoa 应用程序，并将下面的代码粘贴到`AppDelegate.m`.

```
- (void)awakeFromNib
{
    // Lock app in full screen mode for 10 seconds.
    NSApplicationPresentationOptions presentationOptions = (NSApplicationPresentationHideDock |
                                                            NSApplicationPresentationHideMenuBar |
                                                            NSApplicationPresentationDisableAppleMenu |
                                                            NSApplicationPresentationDisableProcessSwitching |
                                                            NSApplicationPresentationDisableForceQuit |
                                                            NSApplicationPresentationDisableSessionTermination |
                                                            NSApplicationPresentationDisableHideApplication);
    NSDictionary *fullScreenOptions = @{NSFullScreenModeApplicationPresentationOptions: @(presentationOptions)};
    [_window.contentView enterFullScreenMode:[NSScreen mainScreen] withOptions:fullScreenOptions];
    [_window.contentView performSelector:@selector(exitFullScreenModeWithOptions:) withObject:nil afterDelay:10.0];
} 
```

您仍然可以使用 退出应用程序`⌘Q`。为防止这种情况，您可以删除退出菜单项的等效键。

![Xcode 界面生成器：菜单项](../Images/0877d0a6f39ca9f9550654e191bd9c37.png)

或者，您可以[子类化`NSApplication`并重写`-sendEvent:`](https://stackoverflow.com/a/3176930/242933)以不执行任何操作，从而忽略发送到您的应用程序的所有事件（键盘、鼠标等）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T04:45:39.057

这些选项是 |'d 一起使用按位 OR：

`NSApplicationPresentationOptions options = NSApplicationPresentationDisableForceQuit | NSApplicationPresentationDisableHideApplication | NSApplicationPresentationDisableProcessSwitching | NSApplicationPresentationHideDock | NSApplicationPresentationHideMenuBar | NSApplicationPresentationFullScreen; [NSApp setPresentationOptions:options];`

# sublimetext2 - Sublime Text 2：无法创建指向 subl 的符号链接，说“bin/subl：没有这样的文件或目录”

> ID：10660999
> 
> 赞同：41
> 
> 时间：2012-05-18T23:34:43.237
> 
> 标签：sublimetext2

我已经下载并安装了 Sublime text 2。我按照这里的说明进行操作：但我被困在这部分：

*第一个任务是创建一个到 subl 的符号链接。假设您已将 Sublime Text 2 放在 Applications 文件夹中，并且您的路径中有 ~/bin 目录，您可以运行：*

ln -s "/Applications/Sublime Text " ~/bin/subl

但是，当我这样做时，它告诉我 /Users/User/bin/subl：没有这样的文件或目录。

我应该怎么办？

谢谢！

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-10-18T19:45:54.993

我建议将其添加到您当地的垃圾箱：

```
ln -s "/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl" /usr/local/bin/subl 
```

编辑：在运行此命令之前确保您的本地 bin 目录存在：

```
mkdir /usr/local/bin 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-09-02T17:49:34.813

我将我的符号链接添加到 /usr/local/bin，对于 Sublime Text 3，我的设置如下：

```
ln -s "/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl" /usr/local/bin/subl 
```

然后您可以使用以下命令打开当前目录列表：

```
subl . 
```

如果您发现 subl 缩写像我认识的某些人那样令人讨厌，请将其更改为“sublime”

```
ln -s "/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl" /usr/local/bin/sublime 
```

并使用以下方法调用它：

```
sublime . 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-12-05T20:17:03.310

或者，您可以运行以下命令：

```
sudo ln -s "/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl" /bin/subl 
```

注意：上面的代码片段将符号链接放在`/bin/subl`而不是`~/bin/subl`.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-05-19T20:58:13.560

**并且您的路径中有一个 ~/bin 目录**

首先，您需要该目录才能使`ln`命令正常工作，最终，它需要在您的路径中才能执行您尝试执行的任何操作。

制作目录：

`mkdir ~/bin`

将其添加到您的执行路径比较棘手，但有大量可用资源。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-02-08T00:29:45.007

按照上面西蒙的例子，对于 Sublime Text 3，这对我有用：

```
ln -s "/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl" /usr/local/bin/subl 
```

请注意，在 /usr/local/bin 中安装（在 Mac OS Sierra 10.12.6 上）需要 sudo。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-08-01T10:44:19.667

## 信息

*   **操作系统：Mac OSX High Sierra 10.13.6 (17G65)**
*   **崇高版本：版本 3.1.1 Build 3176**

我从[SublimeText](https://www.sublimetext.com/docs/3/osx_command_line.html)网站上接受了命令

## 出错了

```
ln -s "/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl" ~/bin/subl
ln: /Users/jkirchoff/bin/subl: No such file or directory 
```

## 做了一些检查

只是为了确保路径存在。

> 注意：`"`' 允许路径中的空间。

```
ln -s "/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl"
ln: ./subl: File exists 
```

## 此页面的比较注释

@NotSimon 在此页面上写了什么，然后 Ran：

```
ln -s "/usr/local/bin/subl"
ln: ./subl: File exists 
```

然后跟着其余的。

## 对我有用的完整系列：

> ln -s "/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl" /usr/local/bin/subl

## 成功

现在我可以`subl`在终端中作为命令运行了！

此命令在 SublimeText 中将目录作为“项目”打开。

```
subl ~/Desktop 
```

## 可选的

> 我遵循了[SublimeText](https://www.sublimetext.com/docs/3/osx_command_line.html)的建议并将其添加到我的 `~/.bash_profile`.

该命令在没有它的情况下也可以工作，只需遵循指南即可。

> `echo "export EDITOR='subl -w'" >> ~/.bash_profile`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-05-12T04:09:03.547

只需`~`从`~/bin/subl`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-17T01:26:23.397

如果您使用的是 mac 终端，只需在命令中的任何位置将“Sublime Text 2.app”替换为“Sublime\ Text\ 2.app/”即可。

那应该这样做。