# StackOverflow 问答 11730000-11730999

# java - 通过 NDK 回调在 Android 中创建消息对话框

> ID：11730001
> 
> 赞同：2
> 
> 时间：2012-07-30T21:36:15.817
> 
> 标签：java, android, opengl-es, dialog, android-ndk

我有一个 android 应用程序，在其中我在 Java 端设置了 OpenGL 上下文，并从 NDK/C++ 端发送绘图。这一切似乎运作良好。

我希望 C++ 端能够弹出一个对话框。我实现了一个 java`MakeADialog`函数，它通过我的 Java 端接收函数从 C 端很好地触发，`env->CallVoidMethod(javaClass, javaMethod);`如下所示：

```
public static void MakeADialog() {  
     Log.w("title", "MakeADialog fired!");
} 
```

这是一个单独的类（不是`Activity`or `Runnable`）。以上工作正常，我可以看到我的 MakeADialg 日志消息。但是，当我尝试创建一个实际的对话框时，我会遇到很多崩溃。我可以说，当我从 C 端调用 Java 端时，我并没有对正在运行的“线程”进行操作。当我尝试创建新线程/对话框时，似乎遇到了麻烦。

我在这里尝试了很多关于创建 Runnable、Thread 等的建议——但它们似乎总是给我可怕的“无法在未调用 Looper.prepare() 的线程内创建处理程序”或父级视图为空。这些方法中的大多数都围绕将 Activity 和 Context 指针存储为静态并在我处于 MakeADialog 回调时通过 get 函数检索它们。

`AlertDialog alertDialog = new AlertDialog.Builder(MyApp.GetMyContext()).create();`GetMyContext() 函数只返回`this`我在应用程序启动期间存储的主活动创建线程的指针。

有没有人弹出从他们的 NDK 端启动的对话框，或者可以向我指出一些相关文档，这些文档将帮助我了解如何从 NDK 回调创建新对话框？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-03-10T05:12:28.210

也许我们可以使用[gist](https://gist.github.com/SaschaWillems/34fa0f1b4f0fe7805640fba7ed80ab2d)中的示例来创建模态对话框。我怀疑你是从一个工作线程调用它的，所以“他们似乎总是给我一个可怕的‘无法在没有调用的线程内创建处理程序`Looper.prepare()`’或者视图的父级为空。” （另请参阅[无法在未调用 Looper.prepare() 的线程内创建处理程序](https://stackoverflow.com/questions/3875184/cant-create-handler-inside-thread-that-has-not-called-looper-prepare)）。

关键代码基于官方示例[Native Activity](https://github.com/android/ndk-samples/blob/master/native-activity/app/src/main/cpp/main.cpp)和[gist 代码](https://gist.github.com/SaschaWillems/34fa0f1b4f0fe7805640fba7ed80ab2d)：

1.  在 Java 方面，

```
package ss.fang.brickgo;

import android.app.AlertDialog;
import android.app.Dialog;
import android.app.NativeActivity;
import android.content.DialogInterface;
import android.content.pm.ApplicationInfo;
import android.graphics.Color;
import android.graphics.drawable.ColorDrawable;
import android.os.Bundle;
import android.os.Looper;
import android.util.Log;
import android.view.Window;
import android.view.WindowManager;

import java.util.concurrent.Semaphore;
import java.util.concurrent.atomic.AtomicInteger;

public class GameActivity extends NativeActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    /**
     * This function will be called from C++ by name and signature (Ljava/lang/String;Z)I)
     *
     * @param message the message text to show
     * @param model   if true, it will block the current thread, otherwise, it acts like a modeless dialog.
     * @return return id of the button that was clicked for a model dialog, otherwise, 0.
     * @see #showAlertCallback
     * @see <a href="https://stackoverflow.com/questions/11730001/create-a-message-dialog-in-android-via-ndk-callback/60611870#60611870">
     * Create a message dialog in Android via NDK callback</a>
     * @see <a href="https://stackoverflow.com/questions/6120567/android-how-to-get-a-modal-dialog-or-similar-modal-behavior">
     * Android: How to get a modal dialog or similar modal behavior?</a>
     */
    public int showAlert(final String message, boolean model) {
        //https://stackoverflow.com/questions/11411022/how-to-check-if-current-thread-is-not-main-thread
        if (Looper.myLooper() == Looper.getMainLooper() && model) {
            // Current Thread is UI Thread. Looper.getMainLooper().isCurrentThread()
            //android.os.NetworkOnMainThreadException
            throw new RuntimeException("Can't create a model dialog inside Main thread");
        }
        ApplicationInfo applicationInfo = getApplicationInfo();
        final CharSequence appName = getPackageManager().getApplicationLabel(applicationInfo);
        // Use a semaphore to create a modal dialog. Also, it's holden by the dialog's listener.
        final Semaphore semaphore = model ? new Semaphore(0, true) : null;
        // The button that was clicked (ex. BUTTON_POSITIVE) or the position of the item clicked
        final AtomicInteger buttonId = new AtomicInteger();
        this.runOnUiThread(new Runnable() {
            public void run() {
                AlertDialog.Builder builder = new AlertDialog.Builder(GameActivity.this, AlertDialog.THEME_HOLO_DARK);
                builder.setTitle(appName);
                builder.setMessage(message);
                DialogInterface.OnClickListener listener = new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int id) {
                        buttonId.set(id);
                        if (null != semaphore)
                            semaphore.release();
                        else
                            showAlertCallback(id);
                        if (DialogInterface.BUTTON_POSITIVE == id) {
                            GameActivity.this.finish();
                        }
                    }
                };
                builder.setNegativeButton(android.R.string.cancel, listener);
                builder.setPositiveButton(android.R.string.ok, listener);
                builder.setCancelable(false);
                AlertDialog dialog = builder.create();
                dialog.show();
            }
        });
        if (null != semaphore)
            try {
                semaphore.acquire();
            } catch (InterruptedException e) {
                Log.v("GameActivity", "ignored", e);
            }
        return buttonId.get();
    }

    /**
     * The callback for showAlert when it acts like a modeless dialog
     *
     * @param id the button that was clicked
     */
    public native void showAlertCallback(int id);

    /**
     * @see <a href="https://stackoverflow.com/questions/13822842/dialogfragment-with-clear-background-not-dimmed">
     * DialogFragment with clear background (not dimmed)</a>
     */
    protected void showDialog() {
        Dialog dialog = new Dialog(this);
        dialog.getWindow().requestFeature(Window.FEATURE_NO_TITLE);
        dialog.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
        // layout to display
        dialog.setContentView(R.layout.dialog_layout);

        // set color transpartent
        dialog.getWindow().setBackgroundDrawable(new ColorDrawable(Color.TRANSPARENT));

        dialog.show();
    }
} 
```

2.  在本机 (C++11) 方面，

```
/** @param onClickListener MUST be NULL because the model dialog is not implemented. */
typedef void *(OnClickListener)(int id);

jint showAlert(struct android_app *state, const char *message, bool model = false);

/** Process the next input event. */
static int32_t engine_handle_input(struct android_app *app, AInputEvent *event) {
    auto *engine = (struct engine *) app->userData;
    auto type = AInputEvent_getType(event);
    if (AINPUT_EVENT_TYPE_MOTION == type) {
        engine->animating = 1;
        engine->state.x = AMotionEvent_getX(event, 0);
        engine->state.y = AMotionEvent_getY(event, 0);
        return 1;
    } else if (AINPUT_EVENT_TYPE_KEY == type) {
        auto action = AKeyEvent_getAction(event);
        if (AKEY_EVENT_ACTION_DOWN == action && AKEYCODE_BACK == AKeyEvent_getKeyCode(event)) {
            //https://stackoverflow.com/questions/15913080/crash-when-closing-soft-keyboard-while-using-native-activity
            // skip predispatch (all it does is send to the IME)
            //if (!AInputQueue_preDispatchEvent(app->inputQueue, event))
            //int32_t handled = 0;
            //if (app->onInputEvent != NULL) handled = app->onInputEvent(app, event);
            //AInputQueue_finishEvent(app->inputQueue, event, handled);
            LOGI("Before showAlert in modal behavior, it blocks until the dialog dismisses.");
            showAlert(app, "Go Back?", true);
            LOGI("After showAlert in modal behavior, the dialog should have been dismissed.");
            return 1;
        }
    }
    return 0; //not handled
}

/** @return the id of the button clicked if model is true, or 0 */
jint showAlert(struct android_app *state, const char *message, bool model /* = false */) {
    JNIEnv *jni = NULL;
    state->activity->vm->AttachCurrentThread(&jni, NULL);

    jclass clazz = jni->GetObjectClass(state->activity->clazz);

    // Get the ID of the method we want to call
    // This must match the name and signature from the Java side Signature has to match java
    // implementation (second string hints a java string parameter)
    jmethodID methodID = jni->GetMethodID(clazz, "showAlert", "(Ljava/lang/String;Z)I");

    // Strings passed to the function need to be converted to a java string object
    jstring jmessage = jni->NewStringUTF(message);

    jint result = jni->CallIntMethod(state->activity->clazz, methodID, jmessage, model);

    // Remember to clean up passed values
    jni->DeleteLocalRef(jmessage);

    state->activity->vm->DetachCurrentThread();

    return result;
}

extern "C"
JNIEXPORT void JNICALL
Java_ss_fang_brickgo_GameActivity_showAlertCallback(JNIEnv *env, jobject thiz, jint id) {
    LOGI("showAlertCallback %d", id);
} 
```

# ruby-on-rails - 无法查看表中的所有记录

> ID：11730002
> 
> 赞同：-1
> 
> 时间：2012-07-30T21:36:17.083
> 
> 标签：ruby-on-rails

我创建了一个只有姓名、电子邮件和密码的用户模型。我用 100 个用户填充了 sqllite 数据库，并且在执行 User.all 时，我可以在 rails 控制台上看到这 100 个用户。

但是，在我的应用程序中我看不到它。无法理解的问题请指教。代码：

路由.rb

```
match '/users', to:'users#index' 
```

users_controller.rb

```
def index
    @users = User.all
  end 
```

用户\index.html.rb

```
 <%
     if(@users)
     @users.each do |user| %>
      <li>
        <%= gravatar_for user, size: 52 %>
        <%= link_to user.name, user %>
      </li>
  <% end
  end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T04:05:19.737

我找不到确切的问题，但从 ruby​​onrails.org 上的教程中再次重做相同的步骤

# wpf - 组合框绑定到数组失败

> ID：11730004
> 
> 赞同：0
> 
> 时间：2012-07-30T21:36:33.217
> 
> 标签：wpf, binding, combobox, arraylist

我很抱歉问这个问题，但我真的是 WPF 的新手，我搜索了几个小时试图找出这个问题的问题所在。

给定以下代码：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        List<Data> _Buffer = new List<Data>();
        for (int i = 0; i < 50; i++)
        {
            _Buffer.Add(new Data(i, i.ToString()));
        }

        //Also tried:
        //comboBox1.DataContext = _Buffer.ToArray();
        comboBox1.ItemsSource = _Buffer.ToArray();
        comboBox1.SelectedValuePath = "Val";
        comboBox1.DisplayMemberPath = "ValName";
        comboBox1.UpdateLayout();
        comboBox1.SelectionChanged += new SelectionChangedEventHandler(comboBox1_SelectionChanged);
    }

    void comboBox1_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        MessageBox.Show(((Data)e.AddedItems[0]).ValName);
    }

    struct Data
    {
        public Data(int Val, string ValName)
        {
            this.Val = Val;
            this.ValName = ValName;
        }
        public readonly int Val;
        public readonly string ValName;
    }
} 
```

我猜想将一个简单的数组绑定到一个组合是非常容易的，实际上它是，除了一个小问题，它在组合列表中没有显示任何内容。

XAML：

```
<ComboBox Height="23" HorizontalAlignment="Left" Margin="109,82,0,0" Name="comboBox1" VerticalAlignment="Top" Width="120" ItemsSource="{Binding}" /> 
```

正确的方法是如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:25:52.783

Because `SelectedValuePath` and `DisplayMemberPath` are paths for the item binding you have to make `Val` and `ValName` a property:

```
public int Val { get; private set; }
public string ValName { get; private set; } 
```

# php - PHP多请求/Jplayer

> ID：11730006
> 
> 赞同：1
> 
> 时间：2012-07-30T21:36:41.540
> 
> 标签：php, http, jplayer

当我在平板电脑上使用 jPlayer 插件时遇到了一些问题：有一个持续不断的“进度”事件，该事件无休止地提高。我还注意到我的服务器有几个请求，其中一些正在等待处理，一些 206（部分内容）。然后我试着像这样直接下载我的音频文件：[http](http://www.mysite.com/uploads/audio.wav) ://www.mysite.com/uploads/audio.wav ，我看到了 3 个请求：

1.  取消
2.  待办的
3.  206

我认为这不是正常行为，我不应该只收到一个 200 OK 请求吗？

好吧，主要问题是平板电脑上的持续进度事件会导致一些问题。不过，我的笔记本电脑上没有这样的东西。

# regex - 同时greping两个正则表达式

> ID：11730013
> 
> 赞同：0
> 
> 时间：2012-07-30T21:37:05.817
> 
> 标签：regex, scripting, grep

如何使用 grep 同时搜索两个正则表达式。说，我正在寻找“我的名字是”和“我的银行账户”这样的文本：

```
My name is Mike. I'm 16 years old.
I have no clue how to solve my grep problem,but
if I manage to solve it, then I'll transfer 
you some money from my bank account. 
```

我想 grep 返回：

我的名字是我的银行账户

是否可以只用一个 grep 调用来完成它，或者我应该编写一个脚本来为我做这件事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T21:38:45.243

管道。 `grep expr1 file | grep expr2`

对于或 -`egrep '(expr1|expr2)' file`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T21:44:54.747

我不太确定你在追求什么。您给出的结果似乎与 grep 可以/将会做的任何事情都不相符。特别是，grep 是面向行的，因此如果它在一行中找到匹配项，它会将整行包含在输出中。假设这是您真正想要的，您可以`or`将两种模式放在一起：

```
grep ("My name is" | "my bank account") 
```

鉴于上面的输入，这应该产生：

```
My name is Mike. I'm 16 years old.
you some money from my bank account. 
```

或者，由于您的模式中没有包含任何元字符，您可以使用 fgrep（或 grep -F）并将您的模式放在一个文件中，每行一个。对于两种模式，这可能没有太大的区别，但是如果你想查找很多模式，它可能会快很多（它使用 Aho-Corasick 字符串搜索来一次搜索所有模式而不是一次搜索一个）。

`my name is`另一种可能性是您正在寻找包含和的单行`my bank account`。这就是@djechlin 的回答。从上面的输入来看，这不会产生*任何*输出，所以我怀疑这是你想要的，但如果是的话，他的回答是相当合理的。另一种选择是像`("My name is.*my bank account" | "my bank account.*My name is")`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T23:13:15.123

如果您不关心尾随换行符，只需使用`grep`：

```
< file.txt grep -o "My name is\|my bank account" | tr '\n' ' ' 
```

如果您更喜欢尾随换行符，请使用`awk`：

```
awk -v RS="My name is|my bank account" 'RT != "" { printf "%s ", RT } END { printf "\n" }' file.txt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T21:47:59.853

是的。有可能的。我用过sed。你可以用任何你想要的替换 S1 和 S2

```
sed '/S1/{ s:.*:S1:;H};/S2/{ s:.*:S2:;H};${x;s:\n: :g;p};d' 
```

Sed 比 grep 复杂得多，在这种情况下，我用它来模拟您希望的 grep 行为。

# salesforce - 如何在 Salesforce 中实现一组 FieldSet

> ID：11730015
> 
> 赞同：0
> 
> 时间：2012-07-30T21:37:12.640
> 
> 标签：salesforce

我有一个创建零件订单的自定义对象（零件订单）。每个行项目有 3 个字段（零件类型、数量和零件编号），对于每个零件订单，最多可以有 10 个行项目。我似乎找不到实现这一点的好方法。我想一种方法是创建 30 个单独的字段，但我不禁觉得必须有更好的方法。我可以将 3 个字段放入一个字段集中，但有没有办法将一个字段集数组放入页面上？如果有任何其他建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:59:01.177

如果您提到“FieldSets”，您可以通过如下循环在 VisualForce 中输出它们：

```
<apex:repeat value="{!$ObjectType.Object__c.FieldSets.FieldSet1}" var="f">
<apex:outputField value="{!currentObject[f]}" />
<apex:inputField value="{!currentObject[f]}" required="{!f.required}" />
</apex:repeat>

<apex:repeat value="{!$ObjectType.Object__c.FieldSets.FieldSet2}" var="f">
<apex:outputField value="{!currentObject[f]}" />
<apex:inputField value="{!currentObject[f]}" required="{!f.required}" />
</apex:repeat>

<apex:repeat value="{!$ObjectType.Object__c.FieldSets.FieldSet2}" var="f">
<apex:outputField value="{!currentObject[f]}" />
<apex:inputField value="{!currentObject[f]}" required="{!f.required}" />
</apex:repeat> 
```

`FieldSet1..n`与页面的当前对象类型关联的字段集的名称在哪里，`Object__c`可以是任何标准或自定义 sObject

您可以混合和匹配“渲染”而不是“渲染”的任何子集，具体取决于`recordtype`创建该对象的任何其他标准。

但是，关于创建第二个对象的评论可能更简洁，请记住跨多个对象关系的报告有点困难。

*如果您使用标准 VF 页面，我可能会建议使用多种记录类型，每种类型都有自己的页面布局*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:01:05.953

由于一个零件订单可能有许多行项目，您应该创建一个零件订单行项目对象，它是零件订单的子对象（就像 Opportunity 和 OpportunityLineItem 一样）。

要了解如何创建多编辑页面以便人们可以轻松地一次添加/编辑多个行项目，您应该查看文档中出色的[visualforce 列表控制器示例](http://www.salesforce.com/us/developer/docs/pages/index_Left.htm#CSHID=pages_controller_sosc_edit_data.htm%7CStartTopic=Content/pages_controller_sosc_edit_data.htm%7CSkinName=webhelp)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T03:07:36.423

正如 grigriforce 所说，您需要一个 Line Item 自定义对象来表示订单与所订购商品之间的关系。这种对象称为自定义联结对象。使用自定义联结对象比使用 10 个查找字段更具可扩展性；如果你明年需要 20 条线路怎么办？您可以很快用完查找字段。

当前的 force.com 工作簿将引导您完全创建这种仓库应用程序。Line Item 对象在教程 2 第 2 步中进行了说明。[http://www.salesforce.com/us/developer/docs/workbook/index.htm](http://www.salesforce.com/us/developer/docs/workbook/index.htm)

# jsf - @ManagedBean 在页面加载时没有被调用

> ID：11730016
> 
> 赞同：1
> 
> 时间：2012-07-30T21:37:14.807
> 
> 标签：jsf, managed-bean

我对 Java 和 JSF 有点陌生，但这里有：

在eclipse中，新建一个JSF项目：

我已经配置了 hibernate/jpa 等。Eclipse 可以与 Postgres 数据库通信并从实体创建表。

我已经声明了一个名为 BlogPost 的实体和一个 BlogPostController（BlogPost 实体的托管逻辑）。

index.xhtml 文件扩展了一个名为 base.xhtml 的模板，该模板定义了几个区域。我正在尝试使用 ui:repeat 和 h:dataTable 从 index.xhtml 中引用托管 bean 方法，但即使数据库中有博客文章条目，也**没有出现任何内容。**

我也没有在日志中收到**任何错误。**有人请帮忙，如果缺少某些东西，我很乐意提供更多信息。

```
package org.nps2.blog.beans;

import java.util.List;

import org.jboss.logging.Logger;
import org.nps2.blog.controllers.BlogPostController;
import org.nps2.blog.models.*;

import javax.annotation.ManagedBean;
import javax.inject.Inject;

@ManagedBean
public class Homepage {
@SuppressWarnings("unused")
private List<BlogPost> blogposts;
private List<User> users;

private static final Logger log = Logger.getLogger(Homepage.class.getName());

public void setUsers(List<User> users) {
    this.users = users;
}

@Inject
private BlogPostController c;

public List<User> getUsers() {
    log.info("HELLO THERE");
    return (users);
}

public List<BlogPost> getBlogposts() {
    log.info("HELLO THERE");
    return (c.getAll());
}

public void setBlogposts(List<BlogPost> blogposts) {
    this.blogposts = blogposts;
}
} 
```

**索引.xhtml**

```
 <h:dataTable value="#{homepage.blogpost}" var="c"
            styleClass="order-table"
            headerClass="order-table-header"
            rowClasses="order-table-odd-row,order-table-even-row"
        >

        <h:column>
            <f:facet name="header">
                Customer ID!
            </f:facet>
                #{c.id}
        </h:column>

        <h:column>
            <f:facet name="header">
                Name
            </f:facet>
                #{c.first_name}
        </h:column>

        <h:column>
            <f:facet name="header">
                Last name
            </f:facet>
                #{c.last_name}
        </h:column>

        <h:column>
            <f:facet name="header">
                Username
            </f:facet>
                #{c.username}
        </h:column>

    </h:dataTable> 
```

**web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">
<display-name>Blog</display-name>
<welcome-file-list>
<welcome-file>index.jsp</welcome-file>
</welcome-file-list>
<servlet>
<servlet-name>Faces Servlet</servlet-name>
<servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
<load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
<servlet-name>Faces Servlet</servlet-name>
<url-pattern>*.jsf</url-pattern>
</servlet-mapping>
<context-param>
<description>State saving method: 'client' or 'server' (=default). See JSF Specification 2.5.2</description>
<param-name>javax.faces.STATE_SAVING_METHOD</param-name>
<param-value>client</param-value>
</context-param>
<context-param>
<param-name>javax.servlet.jsp.jstl.fmt.localizationContext</param-name>
<param-value>resources.application</param-value>
</context-param>
<context-param>
<param-name>javax.faces.PROJECT_STAGE</param-name>
<param-value>Development</param-value>
</context-param>
</web-app> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T10:05:39.110

当我发现 Eclipse 导入了错误的 ManagedBean 声明时解决了这个问题。

Eclipse自动导入：javax.annotation.ManagedBean 我改成：javax.faces.bean.ManagedBean

这样一切正常，我的 bean 方法被调用了。

# java - 检查具有相同对象列表的对象列表

> ID：11730017
> 
> 赞同：1
> 
> 时间：2012-07-30T21:37:17.360
> 
> 标签：java, android, collision-detection, libgdx

我在检查具有相同对象的列表中的对象时遇到问题。我有一个对象列表，其中包含不同类型的对象，例如子弹、敌人和随机背景对象。现在我想检查一些物体是否相互碰撞，比如子弹与敌人。问题是，当我将相同的 for 循环放入具有相同对象的 for 循环中时，我没有得到我所期望的行为......有人知道更好的方法来处理这个问题吗？

左图显示子弹不再移动，右图显示当我移除循环内的循环时的情况。

[https://www.dropbox.com/s/92tnxizxdneqgz3/ss1.png](https://www.dropbox.com/s/92tnxizxdneqgz3/ss1.png)

编辑：从脚本中读取不同的字符串，我的目标是最大的灵活性。这也是我不希望每种类型的对象有不同集合的原因。当我这样做时，碰撞正在起作用。

```
for (Object o : objects) {

    if (o.behavior.equals("aggressive")) {
        o.aggressive(ship.x, ship.y, ship.z);
    }

    if (o.behavior.equals("missile")) {
        o.missile();

        if (o.type.equals("bullet_player")) {
            for (Object n : objects) {
                             //doesn't matter what i put here
            }
        }
    }
} 
```

**解决方案：**

我让它工作了，问题似乎在于将一个数组列表的 for 循环嵌套在另一个数组列表中。我最后做的是：我克隆了arraylist，用原始对象列表检查克隆列表，我检查对象是否相同，如果不是，我做碰撞检查。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T21:59:17.300

标准方法是这样的，它将比较每个配对一次：

```
for(int i=0; i<objects.size(); i++)
    for(int j=i+1; j<objects.size(); j++)
        //.... compare objects[i] and objects[j] for collision etc 
```

随着您的游戏世界变得越来越复杂，请考虑将对象放置在[空间索引](http://en.wikipedia.org/wiki/Spatial_database#Spatial_index)中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:02:13.887

嵌套循环应该不是问题。下面的例子，我有一些迭代器在同一个集合上运行，按预期工作：

```
public static void main(String a[]) {
    List<String> strings = Arrays.asList("a", "b", "c");
    for (String s: strings) {
        for (String t:strings) {
            System.out.println(s + "/" + t);
        }
    }
} 
```

在我看来，问题出在您的碰撞检测中。您可能有误报（在未发生碰撞的情况下检测到碰撞）

# django-models - Django：多个表的单一模型

> ID：11730018
> 
> 赞同：1
> 
> 时间：2012-07-30T21:37:25.550
> 
> 标签：django-models

我有一个主表格幻灯片，然后是一个特定于站点的表格，该表格捕获了该站点的一些额外详细信息。Site1_幻灯片

在一个网络应用程序（特定于一个网站）中，我想要一个单一的模型，即幻灯片，它结合了上面的 2 个表格。目前我有下面的代码，但我认为这是不正确的。我不能做 s = Slideshow.objects.get(slideshowId=1) 之类的事情，因为 Slideshows 只有属性 featurecategory 和 slideshow。那么我怎样才能拥有一个名为 Slideshow 的模型，它由这 2 个表组成，但看起来像是一个单独的 db 表。

```
class SlideshowAbstract(models.Model):
    slideshowid = models.IntegerField(primary_key=True, db_column=u'SlideshowId') # Field name made lowercase.
    headline = models.TextField(db_column=u'Headline') # Field name made lowercase.
    class Meta:
        db_table = u'Slideshow'

class Slideshow(models.Model):
    slideshow = models.OneToOneField(SlideshowAbstract, primary_key=True,db_column=u'SlideshowId')
    def __unicode__(self):
        return self.slideshow.headline
    class Meta:
        db_table = u'Site1_Slideshow' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T20:33:56.590

认为我找到了解决方案。在 Site1_Slideshow 上，您需要添加一列供 django 使用，我认为它始终与主键值相同。它的名称是 SlideshowAbstract_ptr_id 添加后，您可以将 Slideshow 模型更改为

```
class Slideshow(SlideshowAbstract):
   featureCategory = models.ForeignKey(Featurecategory,db_column=u'FeatureCategoryId')
def __unicode__(self):
    return self.headline
class Meta:
    db_table = u'Site1_Slideshow' 
```

如果你没有做“模型优先”并且已经有了模式，那么可行但不是最好的。能够覆盖 _ptr_id 列的名称会很好。

我确实尝试将以下内容添加到幻灯片中，看看我是否可以将此 ptr col 映射到主键 slideshowabstract_ptr_id = models.IntegerField(primary_key=True, db_column=u'SlideshowId')

但没有雪茄。我也没有测试过插入，但是 ...objects.all() 有效

# c++ - cvQueryFrame() 返回灰色帧

> ID：11730019
> 
> 赞同：0
> 
> 时间：2012-07-30T21:37:31.103
> 
> 标签：c++, opencv, video-capture

cvQueryFrame() 返回灰色帧，除非我在`cvQueryFrame(capture)`. 该程序只需要打断点一次，然后我从相机中获得正确的帧。我尝试过延迟、虚拟帧、两者的组合，但如果没有那个断点，它似乎就无法工作。

```
cvNamedWindow("video", CV_WINDOW_AUTOSIZE);
CvCapture *capture  = cvCaptureFromCAM(1);
if (capture == NULL)
{
    return -1;
}

Mat frame;
for(int i = 0;i<10;i++)
{
    frame = cvQueryFrame(capture);
}

while(1)
{
    try
    {
    frame = cvQueryFrame(capture);
    imshow("video", frame);
    char c = cvWaitKey(1);
    if(c == 33)
        break;
    }

    catch(Exception e)
    {
        break;
    }
}
cvReleaseCapture( &capture);
cvDestroyWindow( "video" );

return 0; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T10:13:50.513

您可以尝试将您的 cvWaitKey 值设置为 5 或 10？相机需要时间来传送下一帧并绘制前一帧。使用 waitKey 可以让 openCV 有时间将图像绘制到屏幕上。您现在可能正在正确抓取帧，但您无法正确显示它们。

# vba - 在不同版本的 Excel 中计算单元格时的值不正确

> ID：11730025
> 
> 赞同：5
> 
> 时间：2012-07-30T21:37:59.810
> 
> 标签：vba, excel, excel-2003, excel-2010

我看到一些 SO 用户在尝试使用 ; 的某些变体时遇到了问题`Cells.Count`。VBA 代码在某些情况下会引发溢出错误。

作为参考，请参阅[对此答案](https://stackoverflow.com/a/11698727/698590)的评论：

> 我认为这会起作用，但我得到一个“溢出”错误，它指向代码“If Master.Cells.SpecialCells(xlCellTypeVisible).Count > 0 Then”——它似乎没有过滤任何特别的东西– 用户 1556069

这个[答案](https://stackoverflow.com/a/11690898/698590)：

> 这是 onyl 工作（和 Cells.Count 没有工作），因为后者使用了一个整数，16 位，最大值 65,536 并且整个电子表格返回了一个更大的数字？– 快速代码
> 
> * * *
> 
> 我假设在幕后某处 VBA 试图将单元格计数强制为小整数（16 位）或长整数（32 位）。Excel 2007 工作表的单元格计数会溢出这两种数据类型。不幸的是，我现在无法隔离它，因为我手边没有 Excel 2007 的副本，并且实际上无法重现您的错误。– mwolfe02

为了理解这一点，我尝试复制自己并在尝试分配`Cells.Count`为整数时出现溢出。这是有道理的，因为该值对于 Integer 数据类型来说太大了。

在 Excel 2003 和 2010 中使用下面的代码，当我尝试分配为 Long 或 Variant 时，我得到了一个数字结果。

```
Option Explicit

Sub testInteger()
    Dim i As Integer
    i = Cells.Count 'Overflow
    Debug.Print i 'Doesn't get this far...
End Sub

Sub testLong()
    Dim l As Long
    l = Cells.Count
    Debug.Print l 'Prints 16777216 in both versions
End Sub

Sub testVariant()
    Dim v As Variant
    v = Cells.Count
    Debug.Print v 'Prints 16777216 in both versions
End Sub 
```

正如您在我的评论中看到的那样，该`Cells.Count`值是`16777216`（对于 2003 年是正确的），但*对于两个版本*都是相同的，这对我来说没有意义。从上述链接的答案之一中引用[mwolfe02 ：](https://stackoverflow.com/users/154439/mwolfe02)

> Excel 2007 工作表有 1,048,576 行和 16,384 列，总共 17,179,869,184 个单元格。

这告诉我 2010 年印刷的价值至少应该是（我相信它应该真的是一样的）`17,179,869,184`。

**那么为什么这个数字不能正确打印/为什么在 2010 年返回 2003 的值？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-30T23:54:28.980

在计算如此大的数字时，请使用`.Countlarge`属性。

例如

```
Sub CellsCount()
    Dim l As Double
    l = ActiveSheet.Cells.CountLarge
    Debug.Print l
End Sub 
```

也永远不要使用`Cells.Count`或`Cells.CountLarge`不指定工作表对象。这是为了确保我们不会在兼容模式下得到不正确的计数/错误。同样永远不要使用`Rows.Count`. 始终使用`ws.Rows.Count`. 这是人们在尝试查找 excel 中的最后一行时最常犯的错误。例如

这

```
lRow = ws.Range("A" & Rows.Count).End(xlUp).Row 
```

和

```
lRow = ws.Range("A" & ws.Rows.Count).End(xlUp).Row 
```

可能不会总是给你相同的结果。

我还建议进一步阅读[此](http://excelusergroup.org/forums/p/314/837.aspx)内容。

# c# - 读取 Excel 单元格并设置行颜色

> ID：11730027
> 
> 赞同：2
> 
> 时间：2012-07-30T21:38:18.597
> 
> 标签：c#, excel, com, interop

我正在使用 Com Interop 和 C#。我必须遍历一个 Excel 文件，在每一行中查找某些值（总是在第 2 列中）。对于某些值，我需要将行的背景颜色设置为红色。

我遇到了麻烦：

1.  读取第 i 行的单元格 [i][2] 中的值，然后
2.  设置该行的背景颜色。

基本上我正在寻找这样的东西（这是我在谷歌搜索后能找到的最好的东西）：

```
// ws is the worksheet
for (int i = 1; i <= ws.Rows.Count; i++)
{
    Range range = ws.Cells[i][2];
    int count = Convert.ToInt32(range.Value2.ToString());
    if (count >= 3)
    {
        Range chronic = ws.UsedRange.Rows[i];
        chronic.EntireRow.Cells.Interior.Color = 0xFF0000;
    }
} 
```

当然，这是行不通的。我无法通过阅读牢房的第一个障碍。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:20:31.493

尝试这个。该代码*假定*第 2 列单元格中的值是一个数字。

```
using Excel = Microsoft.Office.Interop.Excel;
using System.Reflection;

Missing noValue = Missing.Value;
Excel.Range conditionalCell;
foreach (Excel.Range usedRange in ws.UsedRange.Rows)
{
    conditionalCell = usedRange.Cells[noValue, 2] as Excel.Range;
    if (Convert.ToInt32(conditionalCell.Value2) >= 3)
    {
        usedRange.Cells.Interior.Color = Excel.XlRgbColor.rgbRed;
    }
} 
```

# android - Android：当键盘出现时使布局可滚动

> ID：11730044
> 
> 赞同：2
> 
> 时间：2012-07-30T21:39:42.243
> 
> 标签：android, android-layout

[这是对这个问题](https://stackoverflow.com/questions/11725552/android-scrollview-stretches-background-image)的跟进。

在这个问题上花了几天时间，似乎无法得到我想要的。我需要非常简单的是，当键盘在触摸编辑文本字段后弹出时，整个视图可以滚动：

![在此处输入图像描述](../Images/f14887f1266921f7eab20f07c564df7f.png)

请注意，此视图不可滚动，也不必如此。

所以当用户点击edittext字段（比如第一个）时，它看起来像这样：

![在此处输入图像描述](../Images/8c909ecac3dc021ca779059327c92bb4.png)

如果他/她选择，可以滚动视图以不再以它在此处的样子结束：

![在此处输入图像描述](../Images/cab6a485f02e3b112ed99eb8e23a1df3.png)

我已经尝试了所有我能想到的滚动视图组合，但它所做的只是拉伸我的背景图像。我确信有一个简单的解决方案，但我就是找不到。我真的很感谢任何可以解决这个问题的人。顺便说一下，这是布局的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/background"
    android:orientation="vertical"
    android:paddingLeft="60dp"
    android:paddingTop="53dp" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="text1"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/editText1"
        android:layout_width="173dp"
        android:layout_height="wrap_content"
        android:layout_below="@id/textView1"
        android:layout_marginTop="3dp"
        android:inputType="numberDecimal" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/editText1"
        android:layout_marginTop="3dp"
        android:text="text2"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/editText2"
        android:layout_width="173dp"
        android:layout_height="wrap_content"
        android:layout_below="@id/textView2"
        android:layout_marginTop="3dp"
        android:inputType="numberDecimal" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/editText2"
        android:layout_marginTop="3dp"
        android:text="text3"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/editText3"
        android:layout_width="173dp"
        android:layout_height="wrap_content"
        android:layout_below="@id/textView3"
        android:layout_marginTop="3dp"
        android:inputType="numberDecimal" />

    <Button
        android:id="@+id/button1"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/editText3"
        android:layout_marginTop="3dp"
        android:text="text4" />

    <ImageView
        android:id="@+id/gearImage3"
        android:layout_width="35dp"
        android:layout_height="35dp"
        android:layout_alignLeft="@+id/button1"
        android:layout_below="@id/button1"
        android:layout_marginTop="70dp"
        android:clickable="true"
        android:contentDescription="@string/gearDescription_string"
        android:src="@drawable/gear" />

</RelativeLayout> 
```

请注意，后两张图片不是来自真实的应用程序（photoshoped 以显示我需要的东西），但第一张来自我的应用程序。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T21:45:53.343

ScrollView 只滚动到有数据的地方。因此，只需添加一个 ScrollView 就可以解决您的问题。将此添加到 xml 的开头：

```
 <ScrollView
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:id="@+id/ScrollView"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     android:orientation="vertical" > 
```

然后显然将其添加到底部，在其他所有内容之后：

```
 </ScrollView> 
```

我在我的应用程序中使用它，当键盘显示时，我仍然可以滚动到页面底部。如果屏幕截图 1 中显示的字段不超过一个普通电话页面，则无论如何它都不会滚动。它只会在您打开键盘时滚动，因为它无法看到整个屏幕。

希望这可以帮助！

# eclipse - 中断导致空指针异常的代码行

> ID：11730046
> 
> 赞同：1
> 
> 时间：2012-07-30T21:39:51.073
> 
> 标签：eclipse

我对 Java 和 EClipse 非常陌生，并且正在运行 JUnit 测试。当我运行测试时，它失败并抛出 Java.lang.NullPointer 异常......但它没有显示代码中发生这种情况的位置。在 Visual Studio 中，当发生此类异常时，它会跳转到导致异常的确切代码行。我应该在 Eclipse 中设置什么或任何设置才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T21:42:22.180

确保您在调试器中运行它，而不仅仅是“运行”。此外，在调试器中，您可以添加[“异常断点”](http://help.eclipse.org/juno/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/views/breakpoints/ref-addexception_viewaction.htm)。或者，只需查看异常的堆栈跟踪 - 这应该会告诉你哪里出了问题......

# php - 使用常量（）时的PHP致命错误

> ID：11730047
> 
> 赞同：3
> 
> 时间：2012-07-30T21:39:55.860
> 
> 标签：php, constants

constant() 的手动条目说，如果未定义常量，则函数应返回 NULL。然而，在下面的代码中，它给出了一个致命错误。

```
$constant = get_class($this) . '::' . $name;
$value = constant($constant); 
```

如果 $name 有效，则一切正常。但是，如果不是，我会收到一个致命错误“未定义的类常量......”手册说它也应该引发 E_WARNING 错误，但我在日志文件中没有看到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T21:48:32.170

您的 PHP 设置*可能*被设置为将所有错误视为致命错误。如果是这种情况，在尝试检索常量之前检查常量是否存在将是一个修复：

```
$constant = get_class($this) . '::' . $name;
$value = defined($constant) ? constant($constant) : null; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T21:51:17.763

只需确保首先[定义](http://php.net/defined)常量，然后抛出异常（或继续您遵循的任何流程）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-23T15:20:03.960

PHP 8 也会发生此错误。
请参阅[向后不兼容的更改](https://www.php.net/manual/en/migration80.incompatible.php)

> 许多警告已转换为错误异常：
> 
> *   试图访问未定义的非限定常量。以前，不合格的常量访问会导致警告并被解释为字符串。

# objective-c - UIPicker [__NSCFConstantString _isResizable] 出错：？

> ID：11730051
> 
> 赞同：1
> 
> 时间：2012-07-30T21:40:09.417
> 
> 标签：objective-c, ios, xcode, uipickerview

UI 选择器让我再次陷入困境，我仍在使用 UI 选择器学习，所以不确定我是否在这里做错了什么。

试图从行 UIPicker 显示图像。

错误：

`*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFConstantString _isResizable]: unrecognized selector sent to instance 0x70fc' *** First throw call stack:`

继承人的代码：

```
#import "Imagepick.h"

@interface Imagepick ()

@end

@implementation Imagepick
 @synthesize select;
@synthesize imageview;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    // Custom initialization
}
return self;
}

- (void)viewDidLoad
{

   ////arrays & objects
   arrStatus = [[NSArray alloc] initWithObjects:@"pic1",@"pic2",nil];

}
-(NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView
{
//One column
return 1;
}

-(NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:   (NSInteger)component
 {

return arrStatus.count;

 }

-(NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row    forComponent:(NSInteger)component
 {

  return [arrStatus objectAtIndex:row];

 }
 - (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component

{

 [imageview setImage:[arrStatus objectAtIndex:row]]; UIImage *pic1 = [[UIImage alloc]  initWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"appstorelogo" ofType:@"png"]];

  [imageview setImage:[arrStatus objectAtIndex:row]]; UIImage *pic2 = [[UIImage alloc] initWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"applogo" ofType:@"png"]];

 }

 - (void)viewDidUnload
{
[self setImageview:nil];
[self select:nil];
[super viewDidUnload];
// Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

@end 
```

***未使用的变量警告`pic1`&`pic2`如果相关？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-30T21:56:41.773

你的问题是 [imageview setImage:[arrStatus objectAtIndex:row]]; 您正在尝试使用字符串设置图像。

您也没有使用 pic1 和 pic2。

您可能想要做的是将图像名称设置为数组，如：

```
arrStatus = [[NSArray alloc] initWithObjects:@"appstorelogo",@"applogo",nil]; 
```

然后将图像设置为

```
- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
    UIImage *img = [[UIImage alloc]  initWithContentsOfFile:[[NSBundle mainBundle] pathForResource:[arrStatus objectAtIndex:row] ofType:@"png"]];

    [imageview setImage:img]; 
} 
```

# wolfram-mathematica - 内存中的备份文件说明

> ID：11730055
> 
> 赞同：4
> 
> 时间：2012-07-30T21:40:19.060
> 
> 标签：wolfram-mathematica

在另一个线程[The best way to build a function with memory](https://stackoverflow.com/questions/5287817/the-best-way-to-construct-a-function-with-memory/5291299#5291299)中，描述了如何在文件中返回一个函数：

```
$runningLogFile = "/some/directory/runningLog.txt";
flog[x_, y_] := flog[x, y] = f[x, y] /.
v_ :> (PutAppend[Unevaluated[flog[x, y] = v;], $runningLogFile]; v) 
```

我觉得我了解这里的大部分成分，但不了解它是如何工作的。有人可以告诉我这是如何评估的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T03:56:29.070

让我们一步一步来评估`flog[1, 2]`...

**鞭打[1, 2]**

当计算此表达式时，Mathematica 将替换问题中给出的定义中的`1`for`x`和`2`for 。这产生了我们游览的下一步：`y``flog`

**flog[1, 2] = f[1, 2] /。v_ :> (PutAppend[未评估[flog[1, 2] = v;], $runningLogFile]; v)**

请注意，这里的赋值`flog[1, 2] = ...`, 是其`flog`自身定义的一部分。

`/.`是一个中缀运算符，它是[ReplaceAll](http://reference.wolfram.com/mathematica/ref/ReplaceAll.html)函数的替代表示。 `ReplaceAll`将对第一个参数的值应用替换规则。保持这个想法 - 我们会回到它。第一个论点是`flog[1, 2] = f[1, 2]`。此表达式将评估`f[1, 2]`然后将结果分配给`flog[1, 2]`. 为了便于讨论，我们假设`f[1, 2]`返回`345`。因此，一个新的定义将被添加到`flog`，即`flog[1, 2] = 345`。赋值后，我们可以检查 的定义`flog`：

![鞭打定义](../Images/61cae55eb1235b2d9ff25de808a447b4.png)

观察 where`flog`最初只有一个定义，但现在它有两个 - 新添加`flog[1, 2]`的定义缓存了该调用的结果。这通常被称为“记忆”。

`flog[1, 2] = 345`可能会有为 建立新定义的副作用，`flog`但是，就像 Mathematica 中的每个表达式一样，它也产生一个值。经过一番折腾后，该值`345`将成为`ReplaceAll`.

to 的第二个参数`ReplaceAll`是运算符的调用，是[RuleDelayed](http://reference.wolfram.com/mathematica/ref/RuleDelayed.html)函数`:>`的中缀表达式。为了将这篇文章保持在可管理的大小，我们将简单地注意到规则在这种情况下对自身进行评估。

所以，现在我们有一个涉及`/.`评估的表达式......

**345 /。v_ :> (PutAppend[未评估[flog[1, 2] = v;], $runningLogFile]; v**

替换表达式将其第一个参数 ( `345`) 与替换规则 ( `v_`) 的模式组件相匹配。 `v_`匹配`345`（或与此相关的任何其他内容）并给出`345`名称`v`以用于替换。 `ReplaceAll`然后替换规则右侧`345`的每个出现。`v`结果是要评估的下一个表达式...

**(PutAppend[未评估[flog[1, 2] = 345;], $runningLogFile]; 345)**

这里我们有两个用分号分隔的表达式。顺便说一下，`;`是一个扩展为[CompoundExpression](http://reference.wolfram.com/mathematica/ref/CompoundExpression.html)的中缀运算符。第一个表达式涉及[PutAppend](http://reference.wolfram.com/mathematica/ref/PutAppend.html)，它将其第一个参数的值写入名为第二个参数值的文件。但是请注意，第一个参数包含在[Unevaluated](http://reference.wolfram.com/mathematica/ref/Unevaluated.html)中。这会抑制对第一个参数的评估，以便将其完全按原样写入文件：`flog[1, 2] = 345;`. 如果当前 Mathematica 会话结束，书面表达式可以读入未来的 Mathematica 会话，以重新建立记忆的结果`flog[1, 2]`。

`CompoundExpression`丢弃除最后一个以外的所有参数的值。在这里，最后一个参数是`345`。由于我们已经到了表达式的结尾，这将是原始调用的最终返回值。也就是说，`flog[1, 2]`返回`345`——尽管正如我们所见，有一些副作用将这个结果保存到内存和磁盘中以供将来参考。

**未来的呼吁`flog[1, 2]`**

现在如果`flog[1, 2]`再次调用，Mathematica 将找到新定义`flog[1, 2] = 345`。 `345`将直接退回，没有我们上面讨论的任何并发症。特别是，它甚至不会`f[1, 2]`再次调用。当然，这就是这个例子的全部动机。假设`f`计算起来非常昂贵，证明所有这些体操都是为了尽量减少计算发生的次数。

# vb.net - 在 VB.Net 中将数字从 DB 转换为小数

> ID：11730056
> 
> 赞同：0
> 
> 时间：2012-07-30T21:40:20.353
> 
> 标签：vb.net, number-formatting

在表格中保存的金额没有小数点。

```
1 = 0.01, 10 = 0.10, 100 = 1.00, 1000 = 10.00. 
```

我想在 vb.net 中正常显示如何将其转换为常规十进制格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T21:44:23.593

如果该值作为字符串存储在数据库中，则将其解析为一个数字：

```
Dim n as Integer = Int32.Parse(theString) 
```

然后只需将数字转换为浮点数，然后除以 100：

```
Dim d as Double = Convert.ToDouble(n) / 100.0 
```

由于`/`运算符总是在 VB 中进行浮点除法，您可以让它进行隐式转换：

```
Dim d as Dobule = n / 100.0 
```

# firebug - Firebug 捕获所有异常

> ID：11730063
> 
> 赞同：0
> 
> 时间：2012-07-30T21:41:01.590
> 
> 标签：firebug

更新firebug后，它的行为一直很奇怪。出于某种原因，Firebug 会在任何有异常的地方中断。我在 SharePoint 中工作，我得到了很多休息，就像折磨一样。

有没有办法避免这种情况？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T20:25:47.503

打开`Console`选项卡，在顶部选项卡下方有第二行，从“暂停”按钮开始。如果它在闪烁，则表示“Break on all errors”处于活动状态。单击它以禁用。

# c# - 将纯字符串转换为 XML 格式

> ID：11730064
> 
> 赞同：0
> 
> 时间：2012-07-30T21:41:03.410
> 
> 标签：c#, xml-serialization

如果我收到一个只是数字列表的字符串（例如*1,2,3,5*），是否可以像这样将其转换为 XML 格式？

```
<foo>
  <id>1</id>
  <id>2</id>
  <id>3</id>
</foo> 
```

到目前为止，我计划使用类似的东西

```
string s = "example";
XmlDocument xm = new XmlDocument();
xm.LoadXml(string.Format("<foo>{0}</foo>", s)); 
```

但是我不确定我应该如何拆分字符串，以便我只得到数字*而不*使用明显的`Split()`，这是我的经理不希望我做的事情（否则我会跳过整个 XML 格式）。

基本上，有没有办法让我“轻松”将该字符串序列化为 XML 格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T21:43:31.590

您可以使用 XDocument.Parse(string) 方法

您可以构建 xml 字符串，然后将其传递给方法

[http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.parse.aspx](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.parse.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T21:46:25.427

利用`LINQtoXML`

```
string items="1,4,6,3";
XElement elm = new XElement("foo");
foreach(var  item in items.Split(','))
{
    elm.Add(new XElement("id",item));
} 
```

现在`ele`将拥有您正在寻找的 XML

# asp.net - 会话超时不起作用 ASP.NET 4

> ID：11730068
> 
> 赞同：0
> 
> 时间：2012-07-30T21:41:24.410
> 
> 标签：asp.net, forms, session, authentication

我们很难让会话超时在 ASP.NET 4 中工作。我们将超时设置为 720 分钟（12 小时）。我们正在使用表单身份验证。无论我将超时设置为什么，超时都会在大约 20 分钟后发生。我确定我们配置了错误，但我不确定是什么。我在网上查看了几个修复程序（标题等），但似乎没有任何工作。这是我们的配置文件：

```
<authentication mode="Forms">
     <forms loginUrl="~/Login.aspx" name="CAFormsAuth" timeout="720" slidingExpiration="true" defaultUrl="Default.aspx" /> </authentication> <authorization>    <!--<allow users="*"/>-->   <deny users="?" /> </authorization> 
```

这是我们的登录代码：

```
try
        {
            string adLogin = txtUserName.Text;

            bool isValid = false;
            //Validate User against AD First...
            //----------------------------------
            try
            {
                isValid = AuthenticateUser(cboDomains.Text, adLogin, txtPassword.Text);
            }
            catch (Exception ex)
            {
                //Should read "Invalid Username or Password"...
                //lblError.Text = ex.Message;
                lblError.Text = "Invalid User Name or Password.";
                return;                   
            }

            //Now, See if the user exists in the database.
            //---------------------------------------------
            db_users user = null;
            try
            {
                user = usrHelp.GetUserByADUserName(cboDomains.Text + @"\" + adLogin);

                if (user == null)
                {
                    lblError.Text = "User " + adLogin + " does not exist in the database.";
                    return;
                }
            }
            catch (Exception ex)
            {
                ErrorLoggingHelper.LogToSource(Globals.ApplicationName, ex.ToString(), System.Diagnostics.EventLogEntryType.Error);

                lblError.Text = "User " + adLogin + " does not exist in the database.";
                return;
            }

            if (isValid)
            {
                if (chkRemember.Checked)
                {
                    SetCookies();
                }
                else
                {
                    RemoveCookie();
                }
            }
            else
            {
                lblError.Text = "Password is not valid";
                Telerik.Web.UI.RadAjaxManager.GetCurrent(this.Page).ResponseScripts.Add(String.Format("SetFocus('{0}')", txtPassword.ClientID));
                return;
            }

            Session[Globals.LoggedInUserName] = txtUserName.Text;
            Session[Globals.LoggedInUserId] = user.user_id;
            Session["CurrentUser"] = user;

            FormsAuthentication.RedirectFromLoginPage(txtUserName.Text, false);

        }
        catch (Exception ex)
        {
           //deleted error logging code here...
            lblError.Text = "Error authenticating user. Please contact the administrator.";
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T21:46:45.990

您的 IIS 在应用程序池级别中有一个高级设置。在“进程模式”下有一个“空闲超时”设置，默认设置为 20 分钟。你应该可以在那里改变它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T21:44:09.670

尝试在 web.config 中设置会话超时，如下所示：

```
<configuration>
  <system.web>
    <sessionState mode="InProc" timeout="720" />
  </system.web>
</configuration> 
```

# javascript - Ruby on rails -- $.ajax 不起作用

> ID：11730069
> 
> 赞同：0
> 
> 时间：2012-07-30T21:41:35.490
> 
> 标签：javascript, jquery, ruby-on-rails, ajax

我知道这段代码工作正常，但是当我把这段代码放在我的（ruby on rails）项目上时它不起作用。

```
 <script type="text/javascript">
     $.ajax({
          type: "POST",
          url: "http://www.mywebsite.com",
          data: { name: "John", location: "Boston" }
          }).done(function( msg ) {
          alert( "Data Saved: " + msg );
      });
    </script> 
```

但是当我将**$.ajax()**替换为**$.get()时它会起作用**

```
$.get("/users/20.json", function(data)
      {
      }).done(function( msg ) {
          alert( "Data Saved: " + msg );
       }); 
```

有人知道为什么我的（ruby on rails）项目 $.ajax 不起作用但 $.get() 工作正常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T21:54:22.233

解决方案是添加：

```
dataType: "script" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T21:55:27.100

您的路由是否将处理限制为 GET 请求？这将解释基于“POST”的查询（您的第一个示例）不起作用，而基于“GET”的查询则可以。

有关此信息，请参阅[http](http://guides.rubyonrails.org/routing.html) ://guides.rubyonrails.org/routing.html ...

您可以尝试将 $.ajax 函数中的“类型”选项更改为如下所示：

```
 <script type="text/javascript">
 $.ajax({
      type: "GET",
      url: "http://www.mywebsite.com",
      data: { name: "John", location: "Boston" }
      }).done(function( msg ) {
      alert( "Data Saved: " + msg );
  });
</script> 
```

**编辑：**哎呀，看到你在我打字的时候解决了这个问题。:)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-30T21:46:44.653

我认为您正在为此使用 jQuery。尝试用最新版本替换您的 jQuery。

# xml - 如何在 XML Schema 中定义自闭合 XML 元素

> ID：11730072
> 
> 赞同：5
> 
> 时间：2012-07-30T21:41:41.117
> 
> 标签：xml, xsd

我要定义的元素：

```
<feature_ref id="0"/> 
```

我在 XSD 文件中放入的代码：

```
<xs:attribute name="id" type="xs:integer"/>    
<xs:element name="feature_ref" type="xs:string">
   <xs:complexType>
    <xs:attribute ref="id"/>
  </xs:complexType>
</xs:element> 
```

有没有办法可以在我的 XSD 中指定这个元素应该是自动关闭的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-30T22:00:32.767

自闭合元素是相同值的语法糖。出于同样的原因，您无法控制属性的顺序或属性之间的空格，XSD 无法定义自闭合。

换句话说：

```
<feature_ref id="0"/> 
```

完全一样

```
<feature_ref id="0"></feature_ref> 
```

请参阅 W3 规范：[http ://www.w3.org/TR/REC-xml/#sec-starttags](http://www.w3.org/TR/REC-xml/#sec-starttags)

# sql - 总计值与 SSRS 中的前 N 个过滤值不匹配

> ID：11730073
> 
> 赞同：3
> 
> 时间：2012-07-30T21:41:54.973
> 
> 标签：sql, sql-server-2008-r2, reporting-services, bids

我有一份报告服务的报告。在此报告中，我显示了前 N 个值。但我的总计显示所有值的总和。

现在我得到这样的东西。这里 N = 2

```
 +-------+------+-------------+
| Area   |ID   |  Count      |
+-------+------+-------------+
| - A   |      |   4         | 
|       |  a1  |   1         | 
|       |  b1  |   1         | 
|       |  c1  |   1         | 
|       |  d1  |   1         | 
|       |      |             |
| - B   |      |   3         | 
|       |  a2  |   1         | 
|       |  b2  |   1         | 
|       |  c2  |   1         |  
|       |      |             | 
|Grand  |      |  10         | 
|Total  |      |             | 
+-------+------+-------------+ 
```

正确的总计应该是 7 而不是 10。A 和 B 是切换项目（您可以扩展和收缩）

如何使用前 N 个过滤器显示正确的总计？

我还想在报告中使用过滤器，而不是在 SQL 查询中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T14:42:24.380

您应该在数据集上使用过滤器。过滤报表对象本身只会关闭项目（例如行）的可见性。项目/行本身仍将是组的一部分，并将用于计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T14:51:32.530

我找到了解决我的问题的方法。正如 Ido 所说，我在数据集上工作。我正在使用分析立方体。所以在这个多维数据集中，我创建了一个命名集计算。

在这组中，我使用了 TopCount() 函数。它根据您的选择过滤掉前 N 个值，其中 N 可以是整数。

所以在这种情况下，最终的命名集是：-

```
TopCount([Dim Area].[Area].[Area], 2, ([Measures].[Count])) 
```

这将为您提供前 N 个过滤值的总计。

# regex - Solr - 从关键字中获取上一个/下一个 X 数量的单词

> ID：11730074
> 
> 赞同：2
> 
> 时间：2012-07-30T21:42:03.953
> 
> 标签：regex, search, solr

有没有办法查询关键字并获取前x个单词和下一个x个单词？

例子

（搜索“测试”）

Aa bb cc dd ee ff gg hh ii jj kk ll 测试 mm nn oo pp qq rr ss tt...</p>

x 是 5 的地方会返回

“hh ii jj kk ll 测试 mm nn oo pp qq rr ss”</p>

突出显示“测试”。

或者

（搜索“测试”和/或“垃圾邮件”）

Aa bb cc dd ee ff gg hh ii jj kk ll Test mm nn Spam oo pp qq rr ss tt...</p>

x 是 5 的地方会返回

“hh ii jj kk ll 测试 mm nn 垃圾邮件 oo pp qq rr ss tt”</p>

突出显示“测试”和“垃圾邮件”。

任何帮助将非常感激。我一直在研究正则表达式，但我对此一无所知。这是我一直在使用的资源。另外，我的包含 $,。和其他随机标点符号（尝试通过句子进行隔离）。让我们假设空格分开。

[http://lucidworks.lucidimagination.com/display/solr/Highlighting#Highlighting-UsingBoundaryScannerswiththeFastVectorHighlighter](http://lucidworks.lucidimagination.com/display/solr/Highlighting#Highlighting-UsingBoundaryScannerswiththeFastVectorHighlighter)

[http://wiki.apache.org/solr/HighlightingParameters/](http://wiki.apache.org/solr/HighlightingParameters/)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T21:52:54.487

使用突出显示工具 - 它会为您提供匹配文档的片段，其中搜索词为斜体（在 HTML 中）。然后，您可以锁定这些标记 ( `<em>`)，然后逐个字符地前后移动，直到累积五个空格字符。

# ipad - 在做其他事情时使用 iPad 摄像头检测运动

> ID：11730078
> 
> 赞同：1
> 
> 时间：2012-07-30T21:42:26.733
> 
> 标签：ipad, video

我必须循环播放视频，直到我用 iPad 的前置摄像头检测到一些运动（活动）。

视频不需要录制或稍后播放，我也不必在 iPad 上显示当前视频。

目前他们必须点击屏幕来停止视频，但客户想要一个“酷”的视频检测。我对面部检测不感兴趣，只对运动感兴趣。

有一些关于它的例子吗？

谢谢，

## 编辑

好吧，目前我发现的唯一解决方法是检测亮度......只需制作每一帧（或 n 帧）的图像并检查图像的亮度，检查另一帧中的另一个图像并再次检查，如果方差够了，有些东西变了:-)

只需找到一个好的阈值方差并准备好...

当然，我更喜欢更强大的解决方法......

# nosql - 在 DynamoDB 中为每个组选择前 N 条记录

> ID：11730079
> 
> 赞同：1
> 
> 时间：2012-07-30T21:42:29.010
> 
> 标签：每组最大 n, nosql, greatest-n-per-group, amazon-dynamodb

与 MySQL 相比，NoSQL，尤其是 DynamoDB，是否更适合执行[每组最大 n](/questions/tagged/greatest-n-per-group "显示标记为“每组最大数”的问题")类型的查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T15:09:00.737

DynamoDB 仅支持 2 个索引，并且只能在这些索引上进行高效查询。

1.  散列键
2.  范围键（*可选*）

使用 DynamoDB 在随机“行”中查找最大值根本**不是**一个好主意。查询随机行意味着**扫描**整个数据集，这将花费你很多钱。

尽管如此，如果您的数据被正确建模，**查询**方法可用于查找**给定 hash_key 的最大 range_key**

以下是如何进行：

*   设置 has_key
*   不为 range_key 设置过滤器
*   将结果计数限制为 1
*   向后扫描索引

# exchangewebservices - 是否可以获取本地 Outlook 邮箱并将其同步以进行交换？

> ID：11730080
> 
> 赞同：0
> 
> 时间：2012-07-30T21:42:31.670
> 
> 标签：exchangewebservices, exchange-server-2007, outlook-2003

好的，所以我正在为企业擦拭一些计算机。业务正在解散，但用户仍然需要他们的电子邮件。我以该用户身份登录以检查他们的电子邮件，我只看到 1 个收件箱文件夹，我注意到收件箱中只有几封电子邮件，例如 1 或 2 封。过了一会儿，我会刷新页面，这些电子邮件会消失。

他们的电子邮件在 Exchange 2007 服务器上运行，并且使用的是 Outlook 2003。

在物理机上，他们的 Outlook 有几个文件夹和数千封电子邮件。我的假设是，出于某种我不知道的原因，它没有将本地文件夹同步到 Exchange。

如何强制 Outlook 告诉 Exchange 接收所有这些文件夹和电子邮件？还是我需要以某种方式将该邮箱导入 Exchange？请记住，在您的回答中，这些电子邮件也需要进行交换，因为它似乎会自动将它们从 Exchange 中删除。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T15:00:51.623

这个问题的答案其实很简单。这是完整的场景。用户有一个个人文件夹邮箱设置，它正在提取他们的 Exchange 帐户并将其同步到该个人文件夹。同时，用户在其个人文件夹设置下方也有其实际的 Exchange 帐户设置。

这很奇怪，因为 Exchange 帐户只同步到他们的个人文件夹设置，我不太确定这是怎么发生的。无论如何，我的解决方案是右键单击每个文件夹和“移动到...”，然后我选择了实际 Exchange 帐户的收件箱。

然后，我能够通过 Exchange Web 界面登录，并看到电子邮件以及文件夹结构都显示在那里。

# ruby-on-rails-3 - 定义的路线没有路线匹配错误

> ID：11730081
> 
> 赞同：0
> 
> 时间：2012-07-30T21:42:34.000
> 
> 标签：ruby-on-rails-3, forms, routes

我在使用 Rails 时遇到问题，我收到以下错误：

```
No route matches {:action=>"publish", :controller=>"businesses"} 
```

违规代码：

```
<div id="searchDatesDiv" style="margin: 0 auto;">
  <%= form_tag(publish_business_path, :method => :post) do %>
    <%= submit_tag("Publish") %>
  <% end %>
</div> 
```

路线.rb：

```
resources :businesses do
  member do
    post 'publish'
  end
end 
```

耙路线：

```
 registration     GET    /registrations/:id(.:format)         registrations#show
    publish_business POST   /businesses/:id/publish(.:format)    businesses#publish
          businesses GET    /businesses(.:format)                businesses#index
                     POST   /businesses(.:format)                businesses#create 
```

我可以看到 rake 路由中定义的路径。为什么我会收到此错误？该表单也是一种 POST 方法。任何帮助都会很棒！我试过查看关于 SO 的类似问题，但没有找到适合我的问题:(。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T21:44:03.693

您的业​​务发布路径需要一个您未提供的 id 参数。因此将业务对象传递给路径助手：

```
<%= form_tag(publish_business_path(@business), :method => :post) do %> 
```

# multithreading - 使用 MSTEST 和 Selenium 在并行 Web 测试中中止线程

> ID：11730082
> 
> 赞同：3
> 
> 时间：2012-07-30T21:42:37.767
> 
> 标签：multithreading, selenium, automated-tests, mstest, selenium-grid

我在最后一英里让这个工作。

通过更改 Local.testsettings 中的 parallelTestCount 设置，我在我的测试项目中同时运行了多个测试：

```
 <Execution parallelTestCount="5">
    <TestTypeSpecific />
    <AgentRule name="Execution Agents">
    </AgentRule>
  </Execution> 
```

我安装了修补程序 KB2619410 来解决 VS 中的并行测试问题。

在`UnitTesting.AssemblyInitialize()`我启动 Selenium 服务器集线器和节点。我在`UnitTesting.AssemblyCleanup()`.

```
java -jar C:\...\selenium-server-standalone-2.25.0.jar -role hub
java -jar C:\...\selenium-server-standalone-2.25.0.jar -role node -hub http://localhost:4444/grid/register -browser browserName=chrome,maxInstances=5,platform=WINDOWS 
```

我产生了 5 个线程来创建`RemoteWebDriver`实例并登录到我的网站

```
 Dim desiredCapabilities As Remote.DesiredCapabilities = Remote.DesiredCapabilities.Chrome()
    Dim size As String = "--window-size={0},{1}"
    size = String.Format(size, browserWidth, browserHeight)
    Dim position As String = "--window-position={0},{1}"
    position = String.Format(position, browserWidth * index, 0)
    desiredCapabilities.SetCapability("chrome.switches", {size, position})
    driver = New Remote.RemoteWebDriver(New System.Uri("http://localhost:4444/wd/hub"), desiredCapabilities)
    ...
    ...code to use driver to log into web site 
```

我加入线程，以便在它们全部登录之前不会开始测试。我创建了一个 DriverPoolManger 类来将可用的 Web 驱动程序分配给等待测试。每当我检查驱动程序是否可用或更改其状态时，我都会使用 ReaderWriterLock：

```
 _readerWriterLock.AcquireWriterLock(Threading.Timeout.Infinite)
    _locks(index) = False
    _readerWriterLock.ReleaseWriterLock() 
```

此时，它并行运行了一段时间的测试，然后失败了：

```
Type is not resolved for member 'OpenQA.Selenium.WebDriverException,WebDriver, Version=2.16.0.0, Culture=neutral, PublicKeyToken=1c2bd1631853048f'. 
```

经过一番研究，解决方案是将它正在寻找的 dll 复制到一个名为“C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\UnitTestAssemblies”的新文件夹中，然后将 QTAgent32.exe.config 更新为在 privatePath 中列出：

```
<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
  <probing privatePath="PrivateAssemblies;PublicAssemblies;DataCollectors;DataCollectors\x64;PrivateAssemblies\DataCollectors;PrivateAssemblies\DataCollectors\x64;UnitTestAssemblies;"/>
</assemblyBinding> 
```

现在，测试运行了一段时间，然后我的`UnitTesting.AssemblyCleanup()`proc 意外运行并杀死了所有浏览器和 Selenium 服务器。VSTTExecution 记录以下错误：

```
(QTAgent32.exe, PID 8444, Thread 15) Unit Test Adapter threw exception: System.Threading.ThreadAbortException: Thread was being aborted.
   at Microsoft.VisualStudio.TestTools.TestTypes.Unit.UnitTestExecuter.RunTestMethod()
   at Microsoft.VisualStudio.TestTools.TestTypes.Unit.UnitTestExecuter.ExecuteTest()
   at Microsoft.VisualStudio.TestTools.TestTypes.Unit.UnitTestExecuter.Execute(UnitTestResult result)
   at Microsoft.VisualStudio.TestTools.TestTypes.Unit.UnitTestRunner.ExecuteSingleTest(UnitTestExecuter executer, UnitTestElement test, ITestContext testContext, UnitTestAdapterContext userContext, Boolean isLoadTest)
   at Microsoft.VisualStudio.TestTools.TestTypes.Unit.UnitTestRunner.Run(UnitTestElement test, ITestContext testContext, Boolean isLoadTest, Boolean useMultipleCpus) 
```

我将在没有驱动程序池的情况下尝试它，但这意味着启动一个新驱动程序并为每次测试登录。我在多线程方面没有大量经验，而且 VS 中的并行测试似乎存在很多问题。我的驱动程序池会导致这种情况吗？

**更新：** 我删除了我的驱动程序池，但这个问题仍然存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T23:13:20.240

我几乎放弃了，但这是解决方案：

mstest /noisolation

这完全消除了 qtagent32.exe，从那以后我就再也没有遇到过问题。

# java - 基于应用安装顺序的 Android 自定义权限失败

> ID：11730085
> 
> 赞同：13
> 
> 时间：2012-07-30T21:42:41.117
> 
> 标签：java, android, android-intent, android-manifest, android-permissions

我在 Google Play 上的应用出现问题。我有一个使用自定义权限的免费应用程序。此权限允许访问付费应用程序。这些付费应用程序充当“钥匙”并解锁免费应用程序中的功能。基本上，免费应用程序将尝试启动其中一个付费应用程序的意图。付费应用程序会做一些事情并返回说免费应用程序是否应该解锁功能。

根据应用程序安装的顺序出现问题。如果先安装免费应用程序然后安装付费应用程序，则免费应用程序无法启动意图。返回权限拒绝。如果先安装付费应用然后安装免费应用，免费应用可以启动意图没有问题。重新启动设备和/或强制停止应用程序并不能解决问题。我附上了相关代码。有些东西告诉我我做错了什么。

*   免费应用清单（相关代码）：

    ```
    ...
    <uses-permission android:name="com.company.license.PERMISSION" />
    ... 
    ```

*   用于检查意图的免费应用代码（相关代码）：

    ```
    Intent KeyApp = new Intent("com.company.license.action.AUTH_1");
    KeyApp.putExtra("com.company.license.challenge", 1);

    //If free app is installed first, an exception is thrown for not having the proper permission. If paid app is installed first, no exception is thrown
    try {
        startActivityForResult(KeyApp, COMMING_FROM_KEYAPP);
    } catch (Exception e) {
        cancelStartUp();
    } 
    ```

*   付费应用清单（相关代码）：

    ```
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
        package="com.company.installer.1"
    ...
    <permission
        android:name="com.company.license.PERMISSION"
        android:icon="@drawable/icon"
        android:label="@string/app_name"
        android:protectionLevel="normal" >
    </permission>

    <application
        android:icon="@drawable/icon"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.NoDisplay" >

        <activity
            android:name="com.company.license.auth"
            android:configChanges="keyboardHidden|orientation"
            android:exported="true"
            android:permission="com.company.license.PERMISSION"
            android:theme="@style/Theme.Transparent" >
            <intent-filter>
                <action android:name="com.company.license.action.AUTH_1" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>

        <activity
            android:name="com.company.installer.redirect"
            android:configChanges="keyboardHidden|orientation"
            android:exported="true"
            android:theme="@style/Theme.Transparent" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

    </manifest> 
    ```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-30T21:46:01.627

在两个应用程序中放置相同的`<permission>`元素。此外，由于这特定于您的两个应用程序，我会使用`android:protectionLevel="signature"`而不是`normal`- 这意味着用户将永远不需要批准权限，其他任何人都无法请求权限。并且，此配方将允许以任一顺序安装。

**更新**：但是请注意，[由于 Android 的“第一个获胜”方法，使用自定义权限会带来潜在的漏洞](https://github.com/commonsguy/cwac-security/blob/master/PERMS.md)。

**更新 #2**：[从 Android 5.0 开始不再支持](http://commonsware.com/blog/2014/08/04/custom-permission-vulnerability-l-developer-preview.html)此功能，因为两个应用程序不能同时具有相同的`<permission>`元素，除非它们由相同的签名密钥签名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-13T16:17:24.873

我能够解决@CommonsWare 在他的更新#2 中提到的问题。只需**在将首先安装的应用程序中声明权限即可。**

说明：我有应用 A 和应用 B，使用不同的签名进行签名。应用 A 需要使用应用 B 登录，但应用 A 先安装并确保用户安装应用 B。

因为应用 B 似乎是（登录）服务，所以我在应用 B 中声明了自定义权限。应用 B 具有其他应用可以使用的（意图）服务，只要他们使用该权限并且在我们的白名单中。所以应用 B 声明了服务和权限。

但是因为应用程序 A 是在应用程序 BI 发现之前安装的，所以我需要将权限也添加到应用程序 A。否则应用程序 A 在安装应用程序 B 后似乎没有权限。我最好的猜测是，这是因为权限的东西是在安装时完成。而且由于应用 A 没有声明权限，所以在安装时什么也没发生。但是随后安装了具有权限的应用程序 B，但应用程序 A 仍然没有收到此权限。

但后来我在 Android 5 上进行了测试，并遇到了他们独特的权限更改。所以我测试了一些流程和权限声明，并提出了一个可行的解决方案：在首先安装的应用程序中声明自定义权限！当然，这仅在您知道要先安装哪个应用程序时才有效。但在我的情况下，应用程序 A 依赖于应用程序 B 并且应用程序 A 安装应用程序 B，这就是解决方案:)

# java - 在数组中查找重复项并在临时数组中返回重复项

> ID：11730090
> 
> 赞同：0
> 
> 时间：2012-07-30T21:42:52.290
> 
> 标签：java, arrays, duplicates

> **可能的重复：**
> [Java 数组，查找重复](https://stackoverflow.com/questions/3951547/java-array-finding-duplicates)

```
arr=[3,4,1,2,1,5,2] 
```

如何在此数组中找到重复项，然后在数组中返回重复项？

在这种情况下，结果应该是`result [1,2]`

我正在用 Java 编程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T21:59:11.583

我建议采取以下步骤：

1) 创建一个`HashSeta`. 将`HashSet`包含您已阅读的整数。

2) 遍历整个数组 [0 ... size - 1]。`index`使用变量跟踪您所在的索引。

3）在每次迭代中，做一个`HashSet.contains(arr[index])`操作。如果是真的，那就是重复的。将此整数保存在某处。添加`arr[index]`到集合中。

4) 返回`HashSet`结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T10:32:12.253

使用嵌套的 for 循环。取第一个元素并将其与所有数组进行比较。然后使用 if/else 逻辑将重复的数组发送到新数组。

我没有给出代码块，因为它被标记为作业。

# c# - 如果选择了网格行，如何更改按钮上的文本

> ID：11730093
> 
> 赞同：0
> 
> 时间：2012-07-30T21:43:01.183
> 
> 标签：c#, wpf

我在列表视图中创建了网格视图。在任何行上选择我想更新在列表视图之外创建的按钮上的文本。

提前致谢和问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T21:56:24.523

尝试这样的事情：

Xaml 文件：

```
<Window x:Class="GVButton.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="30" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Button Content="{Binding ElementName=listView, Path=SelectedItem.Name}" />

        <ListView Background="Transparent" BorderThickness="0" Name="listView" Grid.Row="1">
            <ListView.ItemContainerStyle>
                <Style TargetType="{x:Type ListViewItem}">
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="VerticalContentAlignment" Value="Stretch"/>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.View>
                <GridView x:Name="grid">
                    <GridViewColumn Width="150" Header="ID" DisplayMemberBinding="{Binding ID}" />
                    <GridViewColumn Width="150" Header="Name" DisplayMemberBinding="{Binding Name}" />
                </GridView>
            </ListView.View>
        </ListView>
    </Grid>
</Window> 
```

代码隐藏文件：

```
using System.Collections.Generic;
using System.Windows;
using System.Windows.Documents;

namespace GVButton
{   
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            List<Foo> _source = new List<Foo>();
            for (int i = 0; i < 10; i++)
            {
                _source.Add(new Foo { ID = i, Name = "name_" + i });
            }

            listView.ItemsSource = _source;
        }
    }

    public class Foo
    {
        public int ID { get; set; }
        public string Name { get; set; }
    }
} 
```

# javascript - 提交前执行函数

> ID：11730099
> 
> 赞同：1
> 
> 时间：2012-07-30T21:43:37.080
> 
> 标签：javascript, onsubmit

在提交之前但在输入所有文本之后如何在 PHP 表单上执行 JavaScript 函数？

假设我想让所有的文本都变成大写或其他东西.. 在 PHP 接管之前会执行 onsubmit 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T21:57:52.630

是的，`onSubmit`事件将在 PHP 之前。[这](http://jsfiddle.net/ffwKK/)是 jQuery 的 jsFiddle 示例。当然，您可以使用本机事件处理程序或任何您喜欢的。我使用它，因为它更快:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T22:31:24.230

这是一个使用 onSubmit 处理程序的非 jQuery [jsfiddle 版本](http://jsfiddle.net/jwehrman/hRWmg/)。

# mysql - MySQL事件在一段时间后停止工作

> ID：11730104
> 
> 赞同：1
> 
> 时间：2012-07-30T21:44:03.867
> 
> 标签：mysql, events

我有一些游戏使用 MySQL 事件每隔几分钟更新一次用户的健康和其他属性。我遇到了一个问题，最终事件不再运行，事件中的 SQL 没有被执行。

我不确定如何修复它，所以我尝试重新启动 MySQL 并修复了一段时间。我将 MySQL 设置为每晚在 cron 中重新启动，但这不是一个很好的解决方案。有时 MySQL 无法重新启动并挂起。

编辑：我的数据库中使用事件的所有表都是 InnoDB。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-16T18:29:57.980

可能是您的事件未完成并持有许多锁。最终，额外的工作将“堆积”起来，每个都试图获取锁但似乎没有做任何工作。如果您使用的是 MyISAM 表，则尤其如此，因为它们具有表级锁定，而不是行级锁定。

考虑配置 pt-stalk（Percona Toolkit 的一部分）来捕获“show processlist”和其他重要细节的常规快照。然后，您可以追踪事情何时“停止工作”并追溯问题开始的时间。

要防止作业“堆积”，请使用 GET_LOCK 函数：

```
SELECT GET_LOCK('THIS_IS_A_NAMED_LOCK', 0) INTO @got_lock;
IF @got_lock = 1 THEN
  select 'do something here';
  SELECT RELEASE_LOCK('THIS_IS_A_NAMED_LOCK') INTO @discard;
END IF; 
```

如果您使用 InnoDB，请确保在事件中发出 START TRANSACTION 和 COMMIT 命令，以确保您不会创建长时间运行的事务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-29T01:21:01.467

最近由于这个问题，我最终将我的 iOS 游戏下线。我不知道如何实现贾斯汀斯旺哈特的答案。如果有人有兴趣，我可以提供我的 php/mysql 代码，看看你是否可以解决这个问题。让我知道。andy.triboletti@gmail.com

# python - 在 python 中访问全局模块

> ID：11730106
> 
> 赞同：0
> 
> 时间：2012-07-30T21:44:05.380
> 
> 标签：python, import, module

如果这是一个基本问题，我深表歉意，但我似乎无法在这里或谷歌上找到答案。基本上我正在尝试创建一个单一的配置模块，该模块可用于在 python 应用程序中导入的所有其他模块。当然，如果我`import config`在每个文件中都有它，但我想根据应用程序运行的环境使我的配置动态化，并且我不想将逻辑复制到每个文件中。

这是一个例子：

应用程序.py：

```
import config
import submodule

# do other stuff 
```

子模块.py：

```
print config.some_config_variable 
```

但是python当然会抱怨`config`没有定义。

我确实找到了一些关于全局变量的东西，但这似乎也不起作用。这是我尝试过的：

**编辑**我更改了它以表明我希望导入的实际配置是动态的。但是，我目前确实有一个用于测试的静态配置模型，只是为了弄清楚如何全局导入，然后担心该逻辑

应用程序.py

```
# logic here that defines some_dynamic_config
global config
config = __import__(some_dynamic_config)
import submodule 
```

子模块.py

```
print config.some_config_variable 
```

但是配置仍然没有定义。

我知道我可以创建一个 config.py 并放置逻辑来设置变量，但我不喜欢这样。我更喜欢配置文件只是配置而不包含一堆逻辑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T22:20:29.957

你必须把你的逻辑放在某个地方。您`config.py`可能是一个模块，它决定要加载哪些配置文件，如下所示：

```
#config.py

import sys

from common_config import *

if sys.platform == 'darwin':
    from mac_config import *
elif sys.platform == 'win32':
    from win32_config import *
else:
    from linux_config import * 
```

使用这种方法，您可以将通用设置放在 common_settings.py 中，并将特定于平台的设置放在各自的文件中。由于特定于平台的设置是在 common_settings 之后导入的，因此您还可以通过在特定于平台的文件中再次定义来覆盖 common_settings 中的任何内容。

这是 Django 设置文件中使用的一种常见模式，并且在那里工作得很好。

如果需要，您还可以用块包装每个`import`调用。`try... except ImportError:`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T21:47:34.693

模块是共享的，因此每个模块都可以`import config`毫无问题。

config.py 本身可以有逻辑来设置它的全局变量。举个例子：

配置文件：

```
import sys
if sys.platform == "win32":
    temp = "c:\\temp"
else:
    temp = "/tmp" 
```

现在在任何模块中导入配置以使用它：

```
import config
print "Using tmp dir: %s" % config.temp 
```

如果你有一个你知道将在其他任何事情之前初始化的模块，你可以创建一个空的 config.py，然后在外部设置它：

```
import config
config.temp = "c:\\temp" 
```

但是您需要先运行此代码，然后再使用它。空模块可以用作单例。

# c++ - 如何在 Android NDK 中使用 c++0x 线程？

> ID：11730111
> 
> 赞同：6
> 
> 时间：2012-07-30T21:44:15.653
> 
> 标签：c++, c++11, android-ndk, pthreads

我正在尝试使用以下命令编译这个简单的程序`android-ndk-r8b`：
**jni/hello_jni.cpp**

```
#include <iostream>
#include <thread>

void hello()
{
    std::cout << "Hi i'm a thread!!!" << std::endl;
}

int main()
{
    std::thread th(hello);
    th.join();
    return 0;
} 
```

**jni/应用程序.mk**

```
APP_OPTIM := release
APP_MODULES := hello_thread
APP_STL := gnustl_static 
```

**jni/Android.mk**

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)

LOCAL_CPPFLAGS   += -std=c++0x -frtti

LOCAL_MODULE     := hello_thread
LOCAL_LDLIBS     := -L$(SYSROOT)/usr/lib -pthread
LOCAL_SRC_FILES  := hello_thread.cpp

include $(BUILD_EXECUTABLE) 
```

**ndk-build**向我返回一个错误，认为“线程”不是“标准”的成员。我发出**ndk-build -n**来获取编译命令并在我的 shell 中单独发出它：

```
/home/evigier/android-ndk-r8b/toolchains/arm-linux-androideabi-4.6/prebuilt/linux-x86/bin/arm-linux-androideabi-g++ -MMD -MP -MF /home/evigier/eclipse_workspace/hello_thread/obj/local/armeabi/objs/hello_thread/hello_thread.o.d -fpic -ffunction-sections -funwind-tables -fstack-protector -D__ARM_ARCH_5__ -D__ARM_ARCH_5T__ -D__ARM_ARCH_5E__ -D__ARM_ARCH_5TE__  -march=armv5te -mtune=xscale -msoft-float -fno-exceptions -fno-rtti -mthumb -Os -fomit-frame-pointer -fno-strict-aliasing -finline-limit=64 -I/home/evigier/android-ndk-r8b/sources/cxx-stl/gnu-libstdc++/4.6/include -I/home/evigier/android-ndk-r8b/sources/cxx-stl/gnu-libstdc++/4.6/libs/armeabi/include -I/home/evigier/eclipse_workspace/hello_thread/jni -DANDROID  -Wa,--noexecstack -std=c++0x -frtti  -O2 -DNDEBUG -g   -I/home/evigier/android-ndk-r8b/platforms/android-14/arch-arm/usr/include -c  /home/evigier/eclipse_workspace/hello_thread/jni/hello_thread.cpp -o /home/evigier/eclipse_workspace/hello_thread/obj/local/armeabi/objs/hello_thread/hello_thread.o 
Compile++ thumb  : hello_thread <= hello_thread.cpp
In file included from /home/evigier/android-ndk-r8b/platforms/android-14/arch-arm/usr/include/stdio.h:55:0,
                 from /home/evigier/android-ndk-r8b/platforms/android-14/arch-arm/usr/include/wchar.h:33,
                 from /home/evigier/android-ndk-r8b/sources/cxx-stl/gnu-libstdc++/4.6/include/cwchar:46,
                 from /home/evigier/android-ndk-r8b/sources/cxx-stl/gnu-libstdc++/4.6/include/bits/postypes.h:42,
                 from /home/evigier/android-ndk-r8b/sources/cxx-stl/gnu-libstdc++/4.6/include/iosfwd:42,
                 from /home/evigier/android-ndk-r8b/sources/cxx-stl/gnu-libstdc++/4.6/include/ios:39,
                 from /home/evigier/android-ndk-r8b/sources/cxx-stl/gnu-libstdc++/4.6/include/ostream:40,
                 from /home/evigier/android-ndk-r8b/sources/cxx-stl/gnu-libstdc++/4.6/include/iostream:40,
                 from jni/hello_thread.cpp:4:
/home/evigier/android-ndk-r8b/platforms/android-14/arch-arm/usr/include/sys/types.h:124:9: error: 'uint64_t' does not name a type
/home/evigier/eclipse_workspace/hello_thread/jni/hello_thread.cpp: In function 'int main()':
/home/evigier/eclipse_workspace/hello_thread/jni/hello_thread.cpp:14:5: error: 'thread' is not a member of 'std'
/home/evigier/eclipse_workspace/hello_thread/jni/hello_thread.cpp:14:17: error: expected ';' before 'th'
/home/evigier/eclipse_workspace/hello_thread/jni/hello_thread.cpp:15:5: error: 'th' was not declared in this scope 
```

我阅读了很多关于 POSIX 线程和 C++ 线程的线程/问题，但仍然找不到我的答案。我的文件`arm-linux-androideabi/include/c++/4.6/thread`仅定义：`class thread``std`

```
#if defined(_GLIBCXX_HAS_GTHREADS) && defined(_GLIBCXX_USE_C99_STDINT_TR1) 
```

它们似乎没有在我的 sdk (c++config.h) 中定义。但是我怎么可能安全地打开它们呢？我是否需要编译自己的工具链才能使用（非 p）线程？我的主机是：

```
Linux evigier-ThinkPad-X220 3.0.0-17-generic #30-Ubuntu SMP Thu Mar 8 20:45:39 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-31T07:56:09.570

Android NDK r8b 附带 gcc 4.6，不包含任何 C++11 线程的实现。您必须提供自己的实现，并可能构建自己的独立 gcc 工具链。

检查这些页面以获取 gcc 中的 C++11 支持：

1.  [http://gcc.gnu.org/projects/cxx0x.html](http://gcc.gnu.org/projects/cxx0x.html)
2.  [http://gcc.gnu.org/onlinedocs/libstdc++/manual/status.html#status.iso.200x](http://gcc.gnu.org/onlinedocs/libstdc++/manual/status.html#status.iso.200x)

POSIX 线程是一个完全不同的故事，您可以在 Android NDK 中使用它们。您将至少需要`pthread_create()`,`pthread_detach()`并`pthread_join()`调用来执行此操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-27T17:52:33.767

在这里更新是因为这是我的 std::this_thread 问题的最佳结果：

最新的 r8e NDK 版本（2013 年 3 月）中改进了线程支持。确保您使用的是最新的 NDK 和工具链，您的问题可能会很容易解决。

编辑：修订更改被简单地列为“在 GCC/MIPS 工具链中启用线程支持”。至少它增加了对 std::this_thread::sleep_for 的支持。如果其他人知道有关新支持范围的更详细文档，请链接它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T21:36:51.550

STL 线程库的灵感来自该`boost`库，您可以为 android OS 编译它。因此，编译`Boost.Thread`以获得替代但类似的实现。

# java - 按名称有效访问字段

> ID：11730112
> 
> 赞同：2
> 
> 时间：2012-07-30T21:44:23.190
> 
> 标签：java, performance, optimization

关于我要实现的目标的一点背景：

我正在解析 JSON（超过 15GB），我必须将其存储在内存中，因此不欢迎任何包装器和额外数据，由于其中使用的框架和接口，我必须提供按名称访问字段的功能。通过用 Enum 替换一些 String，用 int 替换 Integer，用 double 替换 Double 等。我能够减少大约 90% 的内存占用（与 Jackson 相比）。

我希望在运行时通过它们的名称有效地访问 Java 中的字段。我知道反射，但就我而言，它的性能根本无法接受，所以我不想使用它。

如果它使问题更容易解决，我不会太在意设置字段值。我在编译时也知道支持字段的名称。

由于盒装对象的内存占用，我不想将所有内容存储在地图`Map<String,Object>`中，但我不介意以盒装形式返回它们。

我确信其他人也遇到过这个问题，我对任何聪明的解决方案都很感兴趣——比大量的 if ... else ... 语句更聪明。

假设要实现的接口是：

```
public interface Accessor {
    Object get(String fieldName);
} 
```

get 返回的`Object`可以是任何类型，包括枚举。一个天真的实现是：

```
public class TestObject implements Accessor {

    public enum MyEnum {ONE, TWO, THREE};

    private final MyEnum myEnum;
    private final int myInt;
    private final double myDouble;
    private final String myString;

    public TestObject(MyEnum myEnum, int myInt, double myDouble, String myString) {
        this.myEnum = myEnum;
        this.myInt = myInt;
        this.myDouble = myDouble;
        this.myString = myString;
    }

    @Override
    public Object get(String fieldName) {
        if ("myEnum".equals(fieldName)) {
            return myEnum;
        } else if ("myInt".equals(fieldName)) {
            return myInt;
        } else if ("myDouble".equals(fieldName)) {
            return myDouble;
        } else if ("myString".equals(fieldName)) {
            return myString;
        } else {
            throw new UnsupportedOperationException(); // Or could simply return null
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T22:51:49.193

您想要的是从 a`fieldName`到值的映射，其类型由`fieldName`. 您预先知道一组字段名称，因此这是一个理想的任务`Enum`。

如果您不喜欢将每个字段硬编码为枚举的想法，那么变体将是每个类型的枚举（MY_FIELD1 变为 MY_ENUM），并具有从 fieldName 到此 EnumType 的映射。

在下面的代码中，我对 fieldName 和 TestObject 之间的关系进行了假设。具体来说，看起来 TestObject 正在呈现各种类型的相同值（肯定是合理的），而不是每个字段名称的单独值？

所以，到代码：

* * *

改写：

```
@Override
public Object get(String fieldName) {
    MyField field = MyField.mapNameToField(fieldName);
    if (field == null)
        throw new UnsupportedOperationException(); // Or could simply return null
    return field.getValue(this);
} 
```

给定（类似）：

```
enum MyField {
  MY_FIELD1("myField1") {
      public Object getValue(TestObject obj) { return obj.myEnum; }
  },
  MY_FIELD2("myField2") {
      public Object getValue(TestObject obj) { return obj.myInt; }
  },
  ...
  ;

  public abstract Object getValue(TestObject obj);
  public String getName() { return name; }

  public static MyField mapNameToField(String name) { return map.get(name); }

  static {
      map = new HashMap<String,MyField>();
      for(MyField value: values()) {
          map.put(value.getName(), value);
      }
  }

  private MyField(String fieldName) { name = fieldName; }

  private String name;
  private static Map<String, MyField> map;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:24:37.787

我从来没有使用过这个，但看起来很有希望：

[http://labs.carrotsearch.com/download/hppc/0.4.1/api/](http://labs.carrotsearch.com/download/hppc/0.4.1/api/)

“高性能原始集合 (HPPC) 库为所有 Java 原始类型（字节、整数等）提供典型的数据结构（列表、堆栈、映射）模板生成，以节省内存并提高性能。”

特别是， Object{Type}OpenHashMap 类可能是您正在寻找的：

1.  ObjectByteOpenHashMap
2.  ObjectCharOpenHashMap
3.  ObjectDoubleOpenHashMap
4.  ObjectFloatOpenHashMap
5.  ObjectIntOpenHashMap
6.  ObjectLongOpenHashMap
7.  ObjectShortOpenHashMap

我想您会将所有这 7 个定义为字段（或您喜欢的任何子集），并且您将依次探测每个字段以查看该类型的原始值是否存在键。例如，

```
if (byteMap.containsKey(key)) {
  return byteMap.lget(); // last value saved in a call to containsKey()
} else if (charMap.containsKey(key)) {
  return charMap.lget();
} else if {
  // and so on... 
} 
```

请注意，他们有自己特殊的[lget()](http://labs.carrotsearch.com/download/hppc/0.4.1/api/com/carrotsearch/hppc/ObjectByteOpenHashMap.html#lget%28%29)方法调用来优化 containsKey() / get() 使用模式，这种模式在地图中非常典型。

# .htaccess - 用问号替换 & 号

> ID：11730114
> 
> 赞同：0
> 
> 时间：2012-07-30T21:44:35.297
> 
> 标签：.htaccess

出于某种原因，控制器正在查询 http 服务器，其中 & 在中间插入了 ?。如果我用 ? 它工作正常。有人可以写一个 htaccess 代码来代替吗？在最后的“/login.php&redirect =**“到某事行”login.php? 重定向****** "*

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:33:58.853

把它放在你的 htaccess 文件中适当的地方

```
RewriteRule ^(.*)&(.*)$ /$1?$2 [L,QSA,R=301] 
```*

# php - 表达式引擎/截断 - 删除 a 中的任何内容 标签

> ID：11730121
> 
> 赞同：0
> 
> 时间：2012-07-30T21:45:04.593
> 
> 标签：php, expressionengine, truncate, pre, truncation

我正在使用表达式引擎字段来使用`<pre>`元素和`[code]`标记发布代码示例，但我也将此字段用作摘录。在摘录中，我想删除这些前置元素中的任何内容（或以某种方式停止，一旦它到达`<pre>`元素。有人知道该怎么做吗？这是我的摘录代码：

```
<p class="excerpt">{exp:trunchtml chars="300"}{code_content}{/exp:trunchtml}</p> 
```

这是一个包含代码的示例条目：

```
</p>Blah blah blah Lorem Ipsum</p> <pre>[code]camera.position.set(0,20,35); [/code]</pre> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:16:56.863

这是一个非常具体的需求，我知道没有现有的插件可以做到这一点。您的两个选择是：

创建一个专门的摘录字段（在制作更好的摘录和保持数据结构化方面确实是最好的）。

或者，[编写自己的插件](http://expressionengine.com/user_guide/development/plugins.html)（真的不是很困难），它将获取您传递的内容，然后对其执行一些`preg_replace()`操作以消除您的`<pre>` 元素及其所有内容，返回清理后的结果。

所以它看起来像这样：

```
<p class="excerpt">
    {exp:trunchtml chars="300"}
        {exp:my_plugin:replace_pre}{code_content}{/exp:my_plugin:replace_pre}
    {/exp:trunchtml}
</p> 
```

这一点 PHP 会在你的插件中为你做魔法：

```
$content = $this->EE->TMPL->tagdata;
preg_replace('/<pre[^>]*>.*?<\/pre>/i', '', $content);
return $content; 
```

# php - 如何检查IP是否在数据库中

> ID：11730127
> 
> 赞同：3
> 
> 时间：2012-07-30T21:45:31.930
> 
> 标签：php, sql

如何检查一个ip是否在数据库中？

我正在创建一个小投票系统，现在人们可以投票不止一次。

所以我把他们的IP放在数据库中，如果它已经在数据库中，不希望它允许投票。我使用以下方法获取数据库中的 ip：

```
$check = mysql_query("SELECT `ip` FROM `voted`") or die(mysql_error()); 
```

我只是不知道如何检查那个人投票的ip是否已经输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T21:47:18.420

我假设您已经有办法获取 IP 地址（因为您要将它们插入数据库）。所以这是一个 WHERE 子句来验证的问题：

```
$check = mysql_query("SELECT `ip` FROM `voted` WHERE `ip` = '$theIP'")... 
```

然后检查你是否得到任何结果。如果你这样做，那么拒绝投票。

但是请注意，完全基于 IP 地址进行验证会给您带来很多误报。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T21:48:22.183

看一下`WHERE`MySQL中的子句：

[http://www.tizag.com/mysqlTutorial/mysqlwhere.php](http://www.tizag.com/mysqlTutorial/mysqlwhere.php)

```
$ip = mysql_real_escape_string([the IP address]);
$q = mysql_query("SELECT `ip` FROM `voted` WHERE `ip`= '$ip'");
if(mysql_num_rows($q) > 0){
    // They already are in the database
} 
```

记住*——清理你的输入*。就个人而言，我会使用参数和绑定，但如果你要使用普通的 MySQL，那么只需使用转义函数。但请记住，这些`mysql_`功能已被弃用，因此我会尽可能避免使用它们。（见[PDO](http://php.net/manual/en/book.pdo.php)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T21:50:47.113

我应该使用类似的东西：

```
SELECT count(*) INTO counter from `voted` WHERE ip = '0.0.0.0' 
```

在您的 php 代码中，您将检查计数器是否大于 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T22:26:00.523

如果您要坚持使用 mysql_* ，那么像[Andrew M](https://stackoverflow.com/a/11730165/881551)建议的那样可以正常工作。就像他和其他人建议的那样，如果您刚刚开始学习 PHP，请考虑使用 PDO 路线（如下）

**MySQL**

```
<?php
if (!$qry = mysql_query("SELECT COUNT(*) AS `daCount` FROM `voted` WHERE `ip` = '".mysql_escape_string($_SERVER['REMOTE_ADDR'])."'")) {
    die('Whamm PoW! Oops, we made a boo boo!');
}

list($check) = mysql_fetch_row($qry);
if ($check > 0) {
    echo 'Thanks but you already voted!';
}
else {
    echo 'Please make your vote: Yes or No?';
} 
```

**PDO**

```
<?php
try { // to connect to database
    $db = new PDO('mysql:host=localhost;dbname=testdb;charset=UTF-8', 'username', 'password', array(
        PDO::ATTR_EMULATE_PREPARES => false,
        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION
    ));
} catch (PDOException $e) {
    die('Bazinga! Oops, we made a boo boo!');
}

try { // to execute query and stuff
    $stmt = $db->prepare('SELECT `ip` FROM `voted` WHERE `ip`=?');
    $stmt->execute(array($_SERVER['REMOTE_ADDR']));
    $row_count = $stmt->rowCount();
    if ($row_count > 0) {
        echo 'Thanks but you already voted!';
    }
    else {
        echo 'Please make your vote: Yes or No?';
    }

} catch(PDOException $e) {
    die('Kaboom! Oops, we made a boo boo!');
} 
```

# facebook - Facebook 对 Beso.com 的刮削如此之大，以至于严重影响了网站性能；我们如何让 FB 限制它的爬行？

> ID：11730132
> 
> 赞同：0
> 
> 时间：2012-07-30T21:45:56.283
> 
> 标签：facebook, screen-scraping, bots, web-crawler

我们的网站 Beso.com 每月有 3MM 的 UV，已开始每天多次受到 Facebook 的爬虫/抓取工具的攻击，导致我们网站的性能严重下降。我们最近实施了 Open Graph，并鼓励在我们的网站上进行大量的分享和点赞，以及 Facebook Connect。

我知道 FB 需要访问我们的网站来抓取信息，但我们迫切需要他们来降低抓取速度，否则我们将被迫完全阻止它。这不是我们希望采用的解决方案。

这个网站上是否有任何来自 FB 的人可以将我们与合适的团队成员联系起来，或者来自已建立网站的任何人之前曾与这个​​问题作过斗争？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:09:35.173

Facebook 每天抓取一次打开的图形对象。我可以想到一个网站被过度抓取的两个可能原因......

1) 你有一个应用程序来实现打开图形操作。创建该应用程序的程序员不小心将**scrape** *可选参数*永久设置为**true**。见这里： [https ://developers.facebook.com/docs/opengraph/actions/](https://developers.facebook.com/docs/opengraph/actions/)

2) 一个页面——应该是**一个**打开的图形对象——有多个 URL，这样 Facebook 就会一遍又一遍地重新抓取相同的材料。

# coding-style - 变量命名约定 - var1、var2 还是 firstVar、secondVar？

> ID：11730137
> 
> 赞同：3
> 
> 时间：2012-07-30T21:46:23.140
> 
> 标签：coding-style, naming-conventions

如果您有 2 个来自相同类型的变量发挥相似的作用，例如 2 个数组的合并函数： IntArray merge(IntArray array1,IntArray array2);

您认为命名变量的最佳（最易读、最不容易出错）方式是什么？**var1,var2**还是**firstVar,secondVar**？或者也许是不同的方式？如果你表达你的意见，我很高兴听到背后的理性，特别是关于哪个更不容易出错。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T09:04:32.453

对于 C/C++，我认为以下是首选：

```
IntArray merge(IntArray a, IntArray b); 
```

因为它简单、简短并且避免在变量名中使用整数。

或“运算符形式”：

```
IntArray merge(IntArray lhs, IntArray rhs); 
```

（用于*左侧*和*右侧*）

（一样：

```
IntArray operator+(IntArray lhs, IntArray rhs); 
```

)

“数字”变体和 camelCase 更像 ECMAScript 而不是 C。但它主要是由简单地使用 C/C++ 并使用类似命名的人创建的“标准”（参见[C++ 标准库](http://cplusplus.com/reference/std/functional/plus/)中的 plus 模板作为示例）。

但是你不能得到它背后的太多理由，因为这只是一个品味问题。只要变量同样重要（即`merge(a, b) == merge(b, a)`），这就是它们从实现代码中引用的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T08:40:24.777

函数的参数应该始终讨论它们是谁以及它们应该用于什么。如果两个数组之间没有区别（例如，作为源和目标），也许你应该考虑传递一个数组列表（命名为 arraysToMerge 或类似的东西）。变量的名称必须始终解释变量的用途。因为代码是（或至少应该是）我们真正的文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T10:16:22.353

为清楚起见，我使用变量的用途作为名称而不是数字。它立即告诉我变量计数是有限的。例如：

```
function predicate(int subject, int object)

function merge_array(array firstArray, array secondArray) 
```

使用`(array1, array2)`听起来对我来说是错误的，因为似乎有 array3，array4，......虽然我们知道变量/参数计数是固定的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-12T16:02:53.190

在你的情况下，我会使用一些类似于 and 的`var`东西`anotherVar`。
如：

```
IntArray merge(IntArray array, IntArray anotherArray); 
```

变量和参数应该是不言自明的。我认为这种情况描述得更清楚。

# java - Oracle DBMS_SQL.EXECUTE 函数的 TO_DATE 问题

> ID：11730144
> 
> 赞同：0
> 
> 时间：2012-07-30T21:46:55.933
> 
> 标签：java, sql, oracle, function, stored-procedures

我正在尝试使用 DBMS_SQL.EXECUTE 函数调用 Oracle 存储过程。我将 PL/SQL 块作为输入参数传递给使用 DBMS_SQL.EXECUTE 函数调用 DB 过程的函数。该过程有一个字符串参数，我使用 TO_DATE 函数以字符串格式传递当前日期。有关我用来调用该过程的语法，请参见下文。调用该过程时，传递的日期将作为 DATE 数据类型保存在数据库中。我面临的问题是日期的时间部分被截断，时间变为上午 12:00，而与传递给函数的时间无关。有人可以让我知道我做错了什么吗？

用于调用函数的 SQL 块：

```
plsql_block =BEGIN P_USER_TIME(to_date('21-JUL-2012 03:30:30','DD-MON-YYYY HH24:MI:SS')); Return; End; 
```

调用过程的函数的 SQL 语法：

```
ret_int := DBMS_SQL.OPEN_CURSOR;

DBMS_SQL.PARSE(ret_int,plsql_block,DBMS_SQL.NATIVE);

ret_int_execute := DBMS_SQL.EXECUTE(ln_dbms_cur); 
```

PFB oracle 代码块

我正在使用一个函数，该函数将日期作为 varchar 输入，然后 n 将其传递给另一个过程。我可以看到在某些情况下没有插入与日期相关的过去时间。请在我的功能下方找到

```
iv_plsql4 :='10-08-2012 07:30:30';
ln_dbms_cur := DBMS_SQL.OPEN_CURSOR;
iv_plsql2 := BEGIN PKG_PRADEEP.P_INSERTDATE(to_date(iv_plsql4,'DD-MM-YYYY HH24:MI:SS'));

DBMS_OUTPUT.put_line(iv_plsql);
DBMS_SQL.PARSE(ln_dbms_cur,iv_plsql,DBMS_SQL.NATIVE);
ln_cur_execute := DBMS_SQL.EXECUTE(ln_dbms_cur);
This code inserts the date in to the database but the time comes as 12:00 A.M. 
```

但是如果我更改下面给出的字符串 iv_plsql2 ，则日期将与 TIME 字段一起插入。

```
iv_plsql2 := BEGIN PKG_PRADEEP.P_INSERTDATE(to_date('10-AUG-2012 07:30:30','DD-MM-YYYY HH24:MI:SS')); 
```

有人可以解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T08:30:29.630

There seems to be a contradiction in what you've said, but the flow isn't very clear. You have a procedure (`P_USER_TIME`?) which is called from a function (unnamed). Your procedure (and it would be helpful to at least see how that's declared) takes a string argument, but you are passing it a `date`, not a `varchar2` value. Since we don't have your actual procedure, let's make one up:

```
create or replace procedure p_user_time(p_time varchar2) is
    l_time date;
begin
    dbms_output.put_line('Parameter p_time: ' || p_time);
    l_time := to_date(p_time, 'DD-MON-YYYY HH24:MI:SS');
    dbms_output.put_line('Converted l_time: ' ||
        to_char(l_time, 'DD-MON-YYYY HH24:MI:SS'));
end;
/ 
```

If I call that with the string you're passing as `plsql_block` I get:

```
alter session set nls_date_format = 'DD-MON-YYYY';
set serveroutput on

exec P_USER_TIME(to_date('21-JUL-2012 03:30:30','DD-MON-YYYY HH24:MI:SS'));

Session altered.

Parameter p_time: 21-JUL-2012
Converted l_time: 21-JUL-2012 00:00:00

PL/SQL procedure successfully completed. 
```

So the time portion is lost. You're converting a string representing the date into a `date` object, and when it's passed to the procedure it's being implicitly converted back to a string using your default NLS_DATE_FORMAT mask, which I've guessed is probably `DD-MON-YYYY`; so this is equivalent to doing:

```
exec P_USER_TIME(to_char(to_date('21-JUL-2012 03:30:30','DD-MON-YYYY HH24:MI:SS'))); 
```

Doing `to_char(to_date(...))` looks redundant, but because you have an explicit data mask one way and an implicit one the other, it's probably not doing what you expect.

Assuming the `P_USER_TIME` procedure is expecting the date/time *string* in the specific format you're passing, you should just pass the string, not try to convert it yourself:

```
exec P_USER_TIME('21-JUL-2012 03:30:30');

Parameter p_time: 21-JUL-2012 03:30:30
Converted l_time: 21-JUL-2012 03:30:30

PL/SQL procedure successfully completed. 
```

You also have a function that's calling the procedure dynamically. Again, let's make one up:

```
create or replace function f_foo return number is
    ln_dbms_cur number;
    ret_int number;
    plsql_block varchar2(256);
begin
     plsql_block := 'BEGIN P_USER_TIME(to_date(''21-JUL-2012 03:30:30'',''DD-MON-YYYY HH24:MI:SS'')); END;';

     ln_dbms_cur := DBMS_SQL.OPEN_CURSOR;
     DBMS_SQL.PARSE(ln_dbms_cur, plsql_block, DBMS_SQL.NATIVE);
     ret_int := DBMS_SQL.EXECUTE(ln_dbms_cur);
     DBMS_SQL.CLOSE_CURSOR(ln_dbms_cur);
     return ret_int;
end;
/

var rc number;

exec :rc := f_foo;

Parameter p_time: 21-JUL-2012
Converted l_time: 21-JUL-2012 00:00:00

PL/SQL procedure successfully completed. 
```

So the same thing happens. If the construction of `plsql_block` is simplified to:

```
 plsql_block := 'BEGIN P_USER_TIME(''21-JUL-2012 03:30:30''); END;'; 
```

then you get:

```
Parameter p_time: 21-JUL-2012 03:30:30
Converted l_time: 21-JUL-2012 03:30:30

PL/SQL procedure successfully completed. 
```

* * *

Reading the question again, it may actually be a much simpler underlying problem. You said '... string argument to which I pass the current date in string format using the to_date function'. If that's interpreted literally, it suggests you might just be using `to_date` when you should have `to_char`; if you really want the current time that would make the line in the function something like:

```
 plsql_block := 'BEGIN P_USER_TIME(to_char(sysdate, ''DD-MON-YYYY HH24:MI:SS'')); END;'; 
```

Or using the direct call to the procedure:

```
exec P_USER_TIME(to_char(sysdate, 'DD-MON-YYYY HH24:MI:SS'));

Parameter p_time: 31-JUL-2012 09:38:43
Converted l_time: 31-JUL-2012 09:38:43

PL/SQL procedure successfully completed. 
```

* * *

**Edited to look at the Java code posted as a comment**

Your function now seems to take two arguments, one of which is the block you want to execute; and return a cursor. I'm going to guess (again) that the cursor is returning what's been inserted, so I've changed my dummy procedure to insert the date/time into a table, and my function to retrieve that. This would be a lot easier if you posted a complete set of code that demonstrates the problems you're seeing, of course.

```
create or replace procedure p_user_time(p_time varchar2) is
    l_time date;
begin
    dbms_output.put_line('Parameter p_time: ' || p_time);
    l_time := to_date(p_time, 'DD-MON-YYYY HH24:MI:SS');
    dbms_output.put_line('Converted l_time: ' ||
        to_char(l_time, 'DD-MON-YYYY HH24:MI:SS'));
    insert into cooldude values(l_time);
end;
/

create or replace function f_foo(pNumber number, p_plsql_block in varchar2)
return sys_refcursor is
    ln_dbms_cur number;
    ret_int number;
    plsql_block varchar2(256);
    rc sys_refcursor;
begin    
     ln_dbms_cur := DBMS_SQL.OPEN_CURSOR;
     DBMS_SQL.PARSE(ln_dbms_cur, p_plsql_block, DBMS_SQL.NATIVE);
     ret_int := DBMS_SQL.EXECUTE(ln_dbms_cur);
     DBMS_SQL.CLOSE_CURSOR(ln_dbms_cur);

     open rc for select * from cooldude;
     return rc;
end;
/ 
```

I can still call that from SQL*Plus with no problems. And I can have a Java program execute it:

```
import java.sql.*;
import java.text.*;
import oracle.jdbc.*;
import oracle.jdbc.pool.OracleDataSource;

public class Cooldude
{

    public static void main(String args[]) throws SQLException 
    {
        String plSqlBlk = "BEGIN P_USER_TIME(to_char(sysdate, 'DD-MON-YYYY HH24:MI:SS')); END;";
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");

        Connection conn;
        OracleDataSource ds = new OracleDataSource();
        ds.setURL("jdbc:oracle:thin:scott/oracle@127.0.0.1:1521:orcl");
        conn = ds.getConnection();

        CallableStatement cstmt = null;
        ResultSet rs = null;
        String output = "";
        System.out.println("******calling SP *******");
        cstmt = conn.prepareCall("{? = call f_foo(?,?)}");
        cstmt.setFetchSize(10000);
        cstmt.registerOutParameter(1, OracleTypes.CURSOR);
        cstmt.setInt(2, 204149885);
        cstmt.setString(3, plSqlBlk);
        cstmt.executeQuery();

        rs = (ResultSet) cstmt.getObject(1);
        while (rs.next())
        {
            Timestamp ts = rs.getTimestamp(1);
            System.out.println(sdf.format(ts));
        }

        if ( conn != null )
        {
            try { conn.close(); } catch ( Exception ex ) {}
            conn = null;
        }
    }
}

javac Cooldude.java && java Cooldude

******calling SP *******
2012-08-11 09:45:07
2012-08-11 09:46:04
2012-08-11 09:54:33 
```

Which seems to be fine; this has the output from three calls to the Java program.

You haven't said quite why you think the time is being truncated in your Java code. I'll go even further out on a limb... are you basing that on the display from your Java showing it as `00:00:00`; and if so, are you using `rs.getDate()` instead of `rs.getTimestamp`? `java.sql.Date` doesn't have a time portion, unlike `java.util.Date`. (See [this question](https://stackoverflow.com/q/3266530/266304) for example).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:15:12.163

我对此的第一个立场是 STP`P_USER_TIME()`正在截断时间戳。但是，如果您确定它可能没有这样做，您可以尝试-

```
DECLARE
   ret_int INTEGER;
   plsql_block  VARCHAR2(1000);
BEGIN
   plsql_block :='BEGIN P_USER_TIME(to_timestamp(''21-JUL-2012 03:30:30'',''DD-MON-YYYY HH24:MI:SS'')); END;';
   ret_int := DBMS_SQL.OPEN_CURSOR;
   DBMS_SQL.PARSE(ret_int,plsql_block,DBMS_SQL.NATIVE);
   ret_int_execute := DBMS_SQL.EXECUTE(ret_int);
   DBMS_SQL.CLOSE_CURSOR(ret_int);
EXCEPTION
WHEN OTHERS THEN
   DBMS_SQL.CLOSE_CURSOR(ret_int);
END; 
```

注意 - 有许多与 ODBC 驱动程序相关的日期时间相关错误。例如 - 错误 11864041 - 时间戳变量从 ODBC 传递为 VARCHAR 导致值损坏（[Oracle 支持](http://support.oracle.com)）

# android - Android 不会做我的 else 声明

> ID：11730146
> 
> 赞同：1
> 
> 时间：2012-07-30T21:47:00.597
> 
> 标签：android, string, if-statement, arraylist

有人能告诉我为什么这个简单的代码行不通吗？在第一个活动中，我让用户选择一个将数组列表发送到下一个活动的选项。它不会执行 else 语句并强制关闭。多谢你们！

```
String[] quotes;

ArrayList<String> Dark = new ArrayList<String>();
ArrayList<String> Light = new ArrayList<String>(); 
```

这是代码

```
if (Dark.isEmpty()){

    Light = i.getStringArrayListExtra("light");
    quotes = Light.toArray(new String[Light.size()]);
} else {

    Dark = i.getStringArrayListExtra("dark");
    quotes = Dark.toArray(new String[Dark.size()]); 
}; 
```

这是我发送它的方式

```
 public void dark (View d){
    dark.add("Even 0 is a number, just leave him alone!");
    dark.add("Love is noting but a bad spell, cast onto your soul, never to be released into the wild...");
    dark.add("The end is near please do not make the same mistakes.");
    dark.add( "Jenna i love you, youre my little beandip, dive you!");
    dark.add( "cute hate but dont rate im no skate");
    dark.add("You will never live if you live a lie");
    Intent intent = new Intent(choose.this,Startme.class);
    intent.putStringArrayListExtra("dark",dark);
    startActivity(intent);
 }

public void light (View l) {
    light.add("Good ideas will come if you share your love");
    light.add("enter a world with no doubt, join god");
    light.add("come on, can you live a life");
    light.add( "where love is so is hate lol not");
    light.add( "watch me now!! go with me and join the lord");
    light.add("never be afrade of the darkness");

    Intent intent = new Intent(choose.this,Startme.class);
    intent.putStringArrayListExtra("light",light);
    startActivity(intent);
} 
```

日志

```
07-30 17:41:33.457: E/AndroidRuntime(15638): FATAL EXCEPTION: main
07-30 17:41:33.457: E/AndroidRuntime(15638): java.lang.RuntimeException: Unable to start activity ComponentInfo{me.me.quote/me.me.quote.Startme}: java.lang.NullPointerException
07-30 17:41:33.457: E/AndroidRuntime(15638):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1696)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1716)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at android.app.ActivityThread.access$1500(ActivityThread.java:124)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:968)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at android.os.Handler.dispatchMessage(Handler.java:99)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at android.os.Looper.loop(Looper.java:130)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at android.app.ActivityThread.main(ActivityThread.java:3806)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at java.lang.reflect.Method.invokeNative(Native Method)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at java.lang.reflect.Method.invoke(Method.java:507)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at dalvik.system.NativeStart.main(Native Method)
07-30 17:41:33.457: E/AndroidRuntime(15638): Caused by: java.lang.NullPointerException
07-30 17:41:33.457: E/AndroidRuntime(15638):    at me.me.quote.Startme.onCreate(Startme.java:164)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
07-30 17:41:33.457: E/AndroidRuntime(15638):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1660)
07-30 17:41:33.457: E/AndroidRuntime(15638):    ... 11 more 
```

这是完整的代码：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    this.setContentView(R.layout.startquotes);

    Intent i = getIntent(); 

    if (Dark.isEmpty()){

        Light = i.getStringArrayListExtra("light");
        quotes = Light.toArray(new String[Light.size()]);
    } else {

        Dark = i.getStringArrayListExtra("dark");
        quotes = Dark.toArray(new String[Dark.size()]); 
    }

    Button clouds = (Button) findViewById(R.id.Change);
    TranslateAnimation cloud2 = new TranslateAnimation(0, 0, +200, 0);
    clouds.startAnimation(cloud2);
    cloud2.setDuration(1000);

    Button clouds3 = (Button) findViewById(R.id.nxt);
    TranslateAnimation cloud3 = new TranslateAnimation(+200, 0, 0, 0);
    clouds3.startAnimation(cloud3);
    cloud3.setDuration(1000);

    Button clouds4 = (Button) findViewById(R.id.back);
    TranslateAnimation cloud4 = new TranslateAnimation(-200, 0, 0, 0);
    clouds4.startAnimation(cloud4);
    cloud4.setDuration(1000);

    AdView adview = (AdView)findViewById(R.id.adView);
    AdRequest re = new AdRequest();
    re.setTesting(true);
    adview.loadAd(re);

    String ser = SerializeObject.ReadSettings(Startme.this, "myobject.dat");
    if (ser != null && !ser.equalsIgnoreCase("")) {
        Object obj = SerializeObject.stringToObject(ser);
        // Then cast it to your object and 
        if (obj instanceof ArrayList) {
            // Do something
            give = (ArrayList<String>)obj;
        }
    }

    TextView Dark=(TextView)findViewById(R.id.Quote); 

    Typeface face=Typeface.createFromAsset(getAssets(), "fonts/font1.ttf"); 
    Dark.setTypeface(face); 

    num = gen.nextInt(5);
    TextView text = (TextView) findViewById(R.id.Quote);
    text.setText( quotes[num]);

    TextView number = (TextView) findViewById(R.id.Qn);
    number.setText("#"+num);

    TextView Q=(TextView)findViewById(R.id.Qn); 
    Typeface tf=Typeface.createFromAsset(getAssets(), "fonts/titlefont.ttf"); 
    Q.setTypeface(tf); 

    }
} 
```

第 164 行

```
 if (Dark.isEmpty()){

        Light = i.getStringArrayListExtra("light");
----------> quotes = Light.toArray(new String[Light.size()]);
    } else { 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:44:51.217

它永远不会执行您的 else 语句，因为您的 Dark 数组列表将始终为空。你在你的活动中像那样初始化它，你从来没有从你的意图中读取它。您可能想先阅读两者，然后根据一个的“空”来决定执行 i​​f 或 else。您将在下面看到原因。

`getStringArrayListExtra(key)`如果您给它的键不存在，该函数将默认返回 null，这意味着您的意图中从来没有添加键“light”的额外内容。这表明您的`light()`函数没有被调用。

我建议检查您的课程，其中包括`light()`and `dark()`。

# c++ - 包含 boost/thread.cpp 时的编译错误

> ID：11730150
> 
> 赞同：1
> 
> 时间：2012-07-30T21:47:13.577
> 
> 标签：c++, multithreading, boost, boost-asio, boost-thread

我有以下代码使用 Boost ASIO 来设置 TCP 客户端。这是我改编自 Boost doc's [chat example](http://www.boost.org/doc/libs/1_50_0/doc/html/boost_asio/example/chat/chat_client.cpp)的代码。

```
class AsioCommunicationService {
AsioCommunicationService::AsioCommunicationService(
        boost::asio::io_service& io_service,
        tcp::resolver::iterator endpoint_iterator)
    : io_service_(io_service),
      socket_(io_service)
{
    tcp::endpoint endpoint = *endpoint_iterator;
    socket_.async_connect(endpoint,
    boost::bind(&AsioCommunicationService::handle_connect, this,
    boost::asio::placeholders::error, ++endpoint_iterator));
}

void AsioCommunicationService::handle_connect(const boost::system::error_code& error,
        tcp::resolver::iterator endpoint_iterator)
{
    if (!error)
    {
      boost::asio::async_read(socket_,
          boost::asio::buffer(read_msg_.data(), LampMessage::header_length),
          boost::bind(&AsioCommunicationService::handle_read_header, this,
          boost::asio::placeholders::error));
    }
}
}

class Connection
{
    //init io_service, query, resolve, iterator here
    boost::asio::io_service io_service;
    boost::asio::ip::tcp::resolver resolver(io_service);
    boost::asio::ip::tcp::resolver::query query(host, service);
    boost::asio::ip::tcp::resolver::iterator endpoint_iterator =
  resolver.resolve(query);

    m_session = std::shared_ptr<AsioCommunicationService>(
            new AsioCommunicationService(io_service, iterator));

    //start new thread for io_service.run --> GOT AN ERROR when include boost/thread.hpp
    boost::thread t(boost::bind(&boost::asio::io_service::run, &io_service));

    //this synchronous command would work, but it's blocking the program. I don't want that.
    //io_service.run();
} 
```

当然，我需要包含 boost/thread 才能在 Connection 类中对变量 t 进行声明。但是当我这样做时，我得到了这个错误

```
#include <boost/thread.hpp>
//ERROR: In function ‘boost::thread&& boost::move(boost::thread&&)’:
///usr/include/boost/thread/detail/thread.hpp:349:16: error: invalid initialization of reference of type ‘boost::thread&&’ from expression of type ‘boost::thread’
//In file included from /usr/include/boost/thread/detail/thread_heap_alloc.hpp:17:0,
//             from /usr/include/boost/thread/detail/thread.hpp:13,
//             from /usr/include/boost/thread/thread.hpp:22,
//             from /usr/include/boost/thread.hpp:13,
//             from /home/son/dev/logistics/src/frameworks/networkService/NetworkConnection.cpp:13:
///usr/include/boost/thread/pthread/thread_heap_alloc.hpp: In function ‘T* boost::detail::heap_new(A1&&) [with T = boost::detail::thread_data<void (*)()>, A1 = void (*&)()]’:
///usr/include/boost/thread/detail/thread.hpp:130:95:   instantiated from here
///usr/include/boost/thread/pthread/thread_heap_alloc.hpp:24:47: error: cannot bind ‘void (*)()’ lvalue to ‘void (*&&)()’
///usr/include/boost/thread/detail/thread.hpp:43:13: error:   initializing argument 1 of ‘boost::detail::thread_data<F>::thread_data(F&&) [with F = void (*)()]’ 
```

如果我删除对 boost/thread.hpp 的包含，它会编译并工作，并通过对 io_service.run(); 的简单调用将声明替换为 t；我想知道这个编译错误是否与 boost 版本有关。如果有任何帮助，我正在使用 Boost ASIO 1.42、Ubuntu 11.04 和 Eclipse。先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T11:11:30.597

我编写了一个包含单个包含指令的文件：

```
#include <boost/thread.hpp> 
```

*   `g++-4.5.4 -std=c++0x -I /usr/include/boost-1_42 -c`给出了你提到的错误。
*   `g++-4.6.3 -std=c++0x -I /usr/include/boost-1_42 -c`相同
*   `g++-4.7.1 -std=c++0x -I /usr/include/boost-1_42 -c`给出了更多的错误
*   `g++-4.7.1 -std=c++0x -I /usr/include/boost-1_49 -c`没有一个错误
*   `g++-4.6.3`并且`g++-4.5.4`使用 boost 1.49 也可以正常工作

所以我真的建议你为此使用更新版本的 boost。您不必在系统范围内安装它，而是可以为单个用户安装它。所以你不依赖于 ubuntu 包。

要手动安装 boost，我建议您遵循[Getting Started on Unix Variants](http://www.boost.org/doc/libs/1_50_0/more/getting_started/unix-variants.html)指南：

1.  解压[`boost_1_50_0.tar.bz2`](http://sourceforge.net/projects/boost/files/boost/1.50.0/)到某个临时源目录并`cd`进入该目录
2.  使用[构建和安装](http://www.boost.org/doc/libs/1_50_0/more/getting_started/unix-variants.html#easy-build-and-install)`./bootstrap.sh --prefix=${HOME}/boost_1_50 && ./b2 install`
3.  [编译](http://www.boost.org/doc/libs/1_50_0/more/getting_started/unix-variants.html#build-a-simple-program-using-boost)您的应用程序`-I ${HOME}/boost_1_50`以获取正确的标头
4.  [链接](http://www.boost.org/doc/libs/1_50_0/more/getting_started/unix-variants.html#link-your-program-to-a-boost-library)应用程序`${HOME}/boost_1_50/lib/libboost_thread.a`时作为参数包含

使用静态`libboost_thread.a`而不是动态`libbtoost_thread.so`将确保您不必担心定位库来启动您的应用程序。您需要的来自 boost 的所有内容都将包含在您的主二进制文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T09:00:50.483

按照 C++11 标准的@MvG 的推理路线，我做了一些研究。看来这是Ubuntu Natty提供的gcc和boost之间[的协调问题](https://bugs.launchpad.net/ubuntu/+source/boost1.42/+bug/776860)，分别使用-std=c++0x和libboost1.42。

没有解决方案，但我使用了这个解决方法：`# define BOOST_HAS_RVALUE_REFS`在 /usr/include/boost/config/compiler/gcc.hpp 中注释如下。

```
#if (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ > 2)) && defined(__GXX_EXPERIMENTAL_CXX0X__)
// C++0x features are only enabled when -std=c++0x or -std=gnu++0x are
// passed on the command line, which in turn defines
// __GXX_EXPERIMENTAL_CXX0X__.
# define BOOST_HAS_DECLTYPE
//# define BOOST_HAS_RVALUE_REFS
# define BOOST_HAS_STATIC_ASSERT
# define BOOST_HAS_VARIADIC_TMPL
#else 
```

我的代码现在像魔术一样编译:) 谢谢@MvC。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T09:57:35.587

经过大量探索，按照@MvG 的建议，我通过执行以下操作成功编译并链接了我的简单程序：

*   手动构建和安装 boost 1.50（使用 MvG 建议）
*   使用以下 2 个 make 文件编译和链接源代码（1 个用于静态链接，1 个用于动态链接）。

动态的：

```
default: test

test.o: test.cpp
    g++-4.5 -std=c++0x -I /home/son/boost_1_50/include/ -c test.cpp 

test: test.o        
    g++-4.5 -std=c++0x -L /home/son/boost_1_50/lib/ test.o -lboost_thread -lboost_system -lboost_chrono -pthread -o test

run: test
    LD_LIBRARY_PATH=/home/son/boost_1_50/lib/ ./test 
```

静止的：

```
default: test

test.o: test.cpp
    g++-4.5 -std=c++0x -I /home/son/boost_1_50/include/ -c test.cpp 

test: test.o
    g++-4.5 -std=c++0x -L /home/son/boost_1_50/lib/ test.o -static -lboost_thread -lboost_system -lboost_chrono -pthread -o test

run: test
    ./test 
```

test.cpp 文件如下。

```
#include <boost/thread.hpp>
#include <stdio.h>

int main()
{
    printf("boost thread tested by son\n");
    boost::thread t;
    return 0;
} 
```

就是这样。我在用 CMake 编译它时遇到了困难，但这是另一个问题。

# python - POST 之后，奇怪的重定向到 iana.org

> ID：11730152
> 
> 赞同：0
> 
> 时间：2012-07-30T21:47:18.547
> 
> 标签：python, django, django-templates, django-voting

我正在使用 django-voting：[https](https://github.com/brosner/django-voting/tree/master/voting) ://github.com/brosner/django-voting/tree/master/voting 在我的帖子之后，我被重定向到这里：[http ://www.iana.org/domains/示例/#c40](http://www.iana.org/domains/example/#c40)

```
<form method="POST" action="/comments/{{ comment.id }}/up/vote/">
     {% csrf_token %}
     <button type="submit">Thumbs Up!</button>
</form> 
```

投票已创建，我可以在管理员中看到它。

在我的应用程序中没有这种重定向。我也无法在 django-voting 中找到这行代码，它会有这个重定向。其他人有没有遇到过这种情况，如果有，你是怎么解决的？

我只想在投票后重定向到同一页面。所以我试着`<input type="hidden" name="next" value="{{ event.get_absolute_url }}" />`认为它可能会覆盖。但这似乎不起作用。建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-30T21:54:33.973

我猜你在你的逻辑中的某个地方重定向到`"example.com"`. example.com 归 IANA 所有，并重定向到[http://www.iana.org/domains/example/](http://www.iana.org/domains/example/)。

此外，网址末尾的“#c40”让我认为 Django 正试图重定向回带有`c40`锚点的某个页面，可能是为了让您刚刚投票的内容可见。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T20:10:37.207

您在使用站点框架吗？（您的管理员中有站点模型吗？）如果有，这可能是由于站点模型的实例具有默认域名“example.org”。

Furthermore, there may be a fixture that reloads 'example.org' into the Sites each time you do something with the database, such as a migration with South, for example.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T21:54:59.547

当您点击[RFC 2606](https://www.rfc-editor.org/rfc/rfc2606)中列出的示例域之一时，就会发生该重定向。

您的代码中有某处正在推送到 example.com 或另一个示例域。

# sql-server - SSRS 过滤器参数

> ID：11730157
> 
> 赞同：1
> 
> 时间：2012-07-30T21:47:49.357
> 
> 标签：sql-server, ssrs-2008, reporting, reporting-services

我在 ssrs 报告中有“国家”过滤器下拉列表。这包含所有国家，它是一个多选下拉列表。如果用户选择“全部”，则报告会将所有以逗号分隔的国家/地区名称发送到存储过程，我可以在其中查询以显示数据。在存储过程中，我拆分值并比较数据。到目前为止没有任何问题。现在我想要的是，如果用户选择“全部”，我不需要将所有逗号分隔值传递给 SP，而是传递 null。因此，在我的 sp 中，我不必拆分或加入表格。问题是识别用户是否在报告条件中选择了“全部”复选框。有没有办法找到这个是否选择了“全部”？

这个国家是动态的，所以我没有一个查找值来计算所有国家。参数！Country.Count == 10 -- 我不能这样做，因为我不知道 10。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:18:44.380

您可以创建一个单独的数据集，在其中计算国家的数量。

```
Select count(countryName) as cntCountry from yourTable 
```

现在您可以将此字段 cntCountry 与 Parameters!Country.Count 进行比较

```
Fields!cntCountry.Value==Parameters!Country.Count 
```

或者您可以在传递数据集的地方使用[CountRows](http://msdn.microsoft.com/en-us/library/ms156330%28v=sql.90%29.aspx)函数

```
Parameters!Country.Count=CountRows(dataset1) 
```

编辑：如果上述一个不起作用

```
 Parameters!Country.Count=CountRows() 
```

为什么不在数据集中创建一个字段来存储行数。在创建数据集时，只需在 sql 查询中获取 row_number，然后将此值与 `Parameters!Country.Count`

# ruby-on-rails - rails 3 将 view_context 发送到 Prawn

> ID：11730162
> 
> 赞同：0
> 
> 时间：2012-07-30T21:48:07.430
> 
> 标签：ruby-on-rails, ruby-on-rails-3, prawn

我正在尝试 Prawn 生成 pdf，遵循[这个 RailsCasts](http://railscasts.com/episodes/153-pdfs-with-prawn-revised?view=asciicast)

如果我尝试下一个代码，它工作正常：

```
pdf = OrderPdf.new(@order) 
```

但是，如果添加“view_context”

```
pdf = OrderPdf.new(@order, view_context) 
```

我收到此错误：“xxxController#index 中的 SyntaxError”语法错误，意外 ','，期待 ')'

我尝试放入我的控制器`helper_method :view_context`，但错误仍然存​​在。

环境：rails 3.2.5

我的控制器：

```
 def show

@liquidacion = Liquidacion.find(params[:id])

respond_to do |format|
  format.html # show.html.erb
  format.json { render json: @liquidacion }
  format.pdf do
    pdf = LiquidacionPdf.new (@liquidacion, view_context)
    send_data pdf.render, filename: "liquidacion_#{@liquidacion.anio.to_s()+''+@liquidacion.mes.to_s().rjust(2,'0')+''+@liquidacion.numeroliquidacion.to_s()}", type: "application/pdf", disposition: "inline"
  end
end 
end 
```

还有我的班级PDF：

```
class LiquidacionPdf < Prawn::Document
def initialize(liquidacion, view)
    super(top_margin: 20, :page_layout => :landscape)
    @liquidacion = liquidacion
            @view = view
    numero_liqui
    nombre_usuario
    lineas_liqui
    total_liquidacion
    firmas
end 
```

我怎么写这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:46:27.643

您的初始化方法应该接受两个参数。我猜你仍然只有一个。

将您的初始化方法更改为以下

```
 def initialize(order, view)
   super(top_margin: 70)
   @order = order
   @view = view 
   order_number
   line_items
 end 
```

编辑

去掉括号或空格

```
respond_to do |format|
 format.html # show.html.erb
 format.json { render json: @liquidacion }
 format.pdf do
 pdf = LiquidacionPdf.new @liquidacion, view_context 
```

# html - 两张背景图片，一张从另一张开始

> ID：11730164
> 
> 赞同：2
> 
> 时间：2012-07-30T21:48:20.780
> 
> 标签：html, css

我有以下代码，并希望实现类似于下面演示的大纲。一个图像显示在 div 的顶部，当用户垂直滚动时，另一个图像会重复显示。

但是，我想在 stayontop.png 垂直结束的位置准确显示 repeat.png。我怎样才能做到这一点？我尝试了不同的`background-position:center top, center bottom;`变化，但没有运气。

**编辑：**因为背景图像的高度处于`auto`模式 ( `background-size:100% auto, 100% auto !important;`) 任何基于静态高度参考的解决方案，例如`background-position:center 50px;`不幸的是在一个 div 宽度中工作正常，但在用户调整 div 大小时失败。（实际上当另一个用户访问该网站时，使用不同分辨率的手机。）有没有动态设置它？

!-+-+-+-+-+-+-

留在顶部.png

!-+-+-+-+-+-+-

重拍.png

!-+-+-+-+-+-+-

重拍.png

!-+-+-+-+-+-+-

重拍.png

!-+-+-+-+-+-+-

......

```
.hede{
    background: url("css/images/stayontop.png"), url("css/images/repeat.png");
    background-repeat:no-repeat, repeat-y;
    background-position:center top, center bottom;
    background-attachment: scroll, scroll;
    background-size:100% auto, 100% auto !important;
    min-height:100%;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:11:00.677

除了、 和之外`top`，背景位置属性还接受长度值。因此，只需以像素为单位指定 stayontop.png 结束的位置：`center``bottom`

```
background-position: center 200px; 
```

每当调整窗口大小时，使用 JavaScript 设置背景位置：

[http://jsfiddle.net/gilly3/rKD8M/](http://jsfiddle.net/gilly3/rKD8M/)

```
onresize = resetBackgrounds;
function resetBackgrounds() {
    var els = document.querySelectorAll(".hede");
    for (var i = 0; i < els.length; i++) {
        var h = els[i].clientWidth * aspectRatio;  // must define aspectRatio
        els[i].style.backgroundPosition = "center top, center " + h + "px";
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:08:50.120

上面的答案可能是最好的解决方案，但只是提出另一个快速的想法。 [http://jsfiddle.net/wigster/8FMB7/1/](http://jsfiddle.net/wigster/8FMB7/1/) 我不会以这种形式使用它，但你明白了，通过将 2 个背景放置在顶部和底部，它将创建所需的分割。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T22:09:35.360

为了浏览器兼容性，我会按以下顺序尝试：

```
 .hede{
        background: url("css/images/repeat.png");
        background-repeat:repeat-y;
        background-position:center top;
        background-size:100% auto;
        min-height:100%;
        margin-top: 20px; // assumed height of stayontop.png
    }
    .hede:before {
        content: url("css/images/stayontop.png");
        height: 20px; 
        margin-top: -20px;
    } 
```

您可能需要稍微调整一下代码，但应该可以...

**编辑：** 将 :before css 更改为此可能会解决调整大小的问题：

```
.hede:before {
  content: url("css/images/stayontop.png");
  height: 20px;
  display: block;
  margin: -20px auto 0; 
} 
```

不完全确定，但值得一试......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-30T21:58:46.910

我认为您只需要确保保持顶部图像的高度与重复图像的高度相同（或高度的 2 倍、3 倍、4 倍）并且都与顶部对齐。

您还需要确保访问您站点的浏览器支持多个背景图像。

对于跨浏览器合规性，您最好使用两个 HTML 元素。

# oracle - 休眠更新时间戳

> ID：11730168
> 
> 赞同：0
> 
> 时间：2012-07-30T21:48:32.087
> 
> 标签：oracle, nhibernate

有没有办法做到“UPDATE Item SET start_date = CURRENT_TIMESTAMP”？在 Nhibernate 中不使用 hql/sql。

我试图避免使用 hql/sql，因为我的其余代码符合标准。我想做类似的事情：

```
var item = session.get<Item>(id)
item.start_date = current_timestamp 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T21:51:36.260

有两种方法，sql是正确的一种。

要么你会

1.  加载所有实体、更改、更新和提交，或
2.  编写sql查询，让dbms处理大部分工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:19:54.860

> 我试图避免使用 hql/sql，因为我的其余代码符合标准

这不是一个有效的论点。Criteria 是用于关系搜索的 API，不支持批量更新。

不同的任务，不同的API。

在这种情况下，您可以使用 HQL 或 SQL，因为语法是相同的。我推荐前者，因为您将使用实体/属性名称而不是表/列名称。

# grails - Grails 中的运行时脚本评估 - 最佳实践

> ID：11730171
> 
> 赞同：1
> 
> 时间：2012-07-30T21:48:36.330
> 
> 标签：grails, groovy, groovyshell

在我们的应用程序中，系统正在发送大量电子邮件。对于所有具有不同上下文变量填充动态数据的用户，这些电子邮件的格式相同。

我们现在正在计划一项功能，允许管理员编辑和自定义这些模板。因此，计划是使用 groovy shell 在运行时评估模板，例如

```
Binding binding = new Binding();
binding.setVariable("model", [var1: "First Name", var2: "Last Name"])
GroovyShell shell = new GroovyShell(binding);

Object email = shell.evaluate('return "<html><title>Test Shell</title><body>${model.var1} ${model.var2}</body></html>";'); 
```

这似乎对我们很有效。我的问题是：

1.  GroovyShell 是首选引擎还是 Rhino 或其他更好？
2.  是否有任何性能问题或内存问题需要注意？我们可以优化的任何低悬的果实，即外壳或绑定可以重复使用
3.  上面代码中最大的瓶颈是什么？那个工程？评价？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:30:23.303

我会推荐使用 GroovyPagesTemplateEngine 之类的东西，因为它不仅仅是 Groovy eval，而且你也可以使用所有 grails taglib 的优点。我将 GroovyPagesTemplateEngine 和 SimpleTemplateEngine 用于您的确切场景。

SimpleTemplateEngine 稍微快一些，所以如果我不需要比简单绑定更多的东西，我会使用它。当我需要处理逻辑和控制结构时，我使用 GroovyPagesTemplateEngine。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T16:53:40.697

对于 grails，请改用页面渲染 api。[http://grails.org/doc/2.0.x/guide/introduction.html#whatsNew](http://grails.org/doc/2.0.x/guide/introduction.html#whatsNew)

# android - Android：如何将垂直线性布局中的两个按钮设置为相同的宽度？

> ID：11730173
> 
> 赞同：0
> 
> 时间：2012-07-30T21:48:48.043
> 
> 标签：android, android-layout

在我的 Android 应用程序中，我想创建一个对话框窗口，其中包含顶部的图像、中间的一些信息文本和下面的两个按钮。这两个按钮位于垂直方向的线性布局中。两者应具有相同的宽度。

我已经设法创建了一个与描述类似的布局，但是，带有较长文本的按钮变得比另一个更宽。在附图中，下面的按钮比上面的按钮宽一点，如红色虚线所示。

![有问题的布局](../Images/46671b346d424963fec804aa22786bc2.png)

我用于此内部线性布局的布局如下所示：

```
<LinearLayout
    android:orientation="vertical" 
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">

    <Button 
        android:id="@+id/close_dialog_button_ok" 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" 
        android:text="@string/upload_dialog_ok"
        android:layout_marginLeft="10dip"
        android:layout_marginRight="10dip"
        android:layout_marginTop="10dip" />        

    <Button 
        android:id="@+id/close_dialog_button_cancel" 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" 
        android:text="@string/upload_dialog_cancel"
        android:layout_marginRight="10dip"
        android:layout_marginTop="10dip"
        android:layout_marginBottom="5dip" />        

</LinearLayout> 
```

有什么想法我在这里做错了吗？
在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T21:52:55.567

你忘了设置`android:layout_marginLeft="10dip"`第二个按钮

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T21:53:06.253

如果您希望它们相同，则必须将 'android:layout_width="fill_parent"' 更改为 '200dp' 之类的东西。由于里面的文字更长，该应用程序会使其中一个更长。所以尝试将这两个按钮设置为：

```
 android:layout_width="200dp" 
```

然后它们将是相同的，并且由于使用“dps”，在所有屏幕尺寸上仍应保持正确的比例。

# jquery - egor khmele 的 jQuery UI Slider 插件左右手柄颜色不同

> ID：11730174
> 
> 赞同：0
> 
> 时间：2012-07-30T21:48:49.980
> 
> 标签：jquery, plugins, slider

我正在使用这里的 jQuery 插件：

[http://egorkhmelev.github.com/jslider/](http://egorkhmelev.github.com/jslider/)

如何让左右处理不同的颜色？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T21:52:12.403

这些句柄/指针的图形（或精灵）包含在名为 `jslider.plastic.png`. 这是它的外观：[http ://egorkhmelev.github.com/jslider/img/jslider.plastic.png](http://egorkhmelev.github.com/jslider/img/jslider.plastic.png)

如果您创建一个基于`jslider.plastic.png`但将所有内容设为红色的新图像，并将该图像命名为“jslider.plastic.red.png”，则您可以修改应用于右侧句柄的 CSS 类，如下所示：

```
.pointer-to
{
  url(../img/jslider.plastic.red.png); 
} 
```

现在您将有一个蓝色的左手柄和一个红色的右手柄。

-

另一种选择是`jslider.plastic.png`使用红色版本的手柄扩展精灵图像。只需将它们添加到现有蓝色手柄的右侧（您会看到两个版本，它们分别代表未按下和按下状态）。然后你需要改变你的 .pointer-to 的 css 看起来像这样：

```
.pointer-to
{
     background-position: -40px -40px; // x, y
} 
```

您可能必须使用 x 坐标才能使其与图像对齐。这样，您将减少浏览器需要请求的精灵图像的数量。如果您知道您总是会请求并一起使用它们，那么合并这些精灵图像是一件好事。

# android - android模拟器eclipse退出应用程序，

> ID：11730180
> 
> 赞同：1
> 
> 时间：2012-07-30T21:49:13.410
> 
> 标签：android, textview, integer, android-edittext

更新*我已经删除了女性、男性按钮并按照建议添加了一个复选框，但现在它又崩溃了*。没有语法错误。为什么会崩溃？？？请帮忙。

这是代码：我的代码有几个问题，如果您能帮助我，我将不胜感激...

我有一个 USMC 初始强度测试计算器，它没有显示任何语法错误。问题是当我在edittext中输入所有值后，当我单击计算时它会崩溃。所以我意识到，这与我希望通过其中一种方法计算的分数显示在 textView 中有关，所以我必须将 textView 转换为 Integer 对吗？而且我还想根据计算的内容在不同的文本视图中显示通过或失败的文本，该方法返回一个字符串。如何显示返回的字符串和返回的整数并将其显示在文本视图上？

这是我所拥有的：

```
 package siuc.cs.rosie;

    import android.app.Activity;
    import android.os.Bundle;
    import android.view.View;
    import android.widget.Button;
    import android.widget.EditText;
    import android.widget.TextView;

public class USMCISTActivity extends Activity {
    /** Called when the activity is first created. */

    enum gender{male, female}
    private EditText pullUpArm;
    private EditText crunches;
    private EditText runMins;
    private EditText runSecs;
    private TextView factor1;
    private TextView txtscore;
    private TextView result;
    Button calculate, male, female, about;
    int tempScore;
    String tempResult;
    maleIst m;
    femaleIst f;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        m = new maleIst();
        f = new femaleIst();

        pullUpArm=(EditText) findViewById(R.id.editText1);

        crunches=(EditText) findViewById(R.id.editText2);

        runMins=(EditText) findViewById(R.id.editText4); 

        runSecs=(EditText) findViewById(R.id.editText3);

        factor1=(TextView) findViewById(R.id.textView4); 
        calculate=(Button) findViewById(R.id.button1);
        male=(Button) findViewById(R.id.button2);
        female=(Button) findViewById(R.id.button3);

        txtscore=(TextView) findViewById(R.id.textView7);

        result=(TextView) findViewById(R.id.textView8);
    }

    public void calculateScore(View v)
    {
        int armPull = Integer.parseInt(pullUpArm.getText().toString());
        int crunchesNum = Integer.parseInt(crunches.getText().toString());
        int runmins = Integer.parseInt(runMins.getText().toString());
        int runsec = Integer.parseInt(runSecs.getText().toString());
        //String resultTxt=result;
        String myresult=result.getText().toString();
        int score = Integer.parseInt(txtscore.getText().toString());//this is what is making the program crash 

        if (male.isPressed())
         {
            m.pullUp = armPull;
            m.crunchM = crunchesNum;
            m.minutes = runmins;
            m.seconds = runsec;
            score = m.mIstScore();//Something to do with (score) is what is making it crash
            myresult= m.MistState();
         }
        else if (female.isPressed())
         {
            f.arm = armPull;
            m.crunchM = crunchesNum;
            m.minutes = runmins;
            m.seconds = runsec;
            //score = f.fIstScore();
            myresult = f.FistState();
         }

        result.setText(myresult);
        result.setVisibility(1);
        //txtscore.setText(Integer.toString(score));
        txtscore.setVisibility(1);

        //result.setText(myresult);//is this right? I cannot get the result pass or fail to show

    }

    public void femaleClick(View v)
    {
        factor1.setText("Arm Hang");
    }

    public void maleClick(View v)
    {
        factor1.setText("Pull-Ups");
    }
} 
```

这是日志：

> 07-30 22:00:16.826: W/KeyCharacterMap(266): id 0 没有键盘
> 
> 07-30 22:00:16.826：W/KeyCharacterMap(266)：使用默认键盘映射：/system/usr/keychars/qwerty.kcm.bin
> 
> 07-30 22:00:22.006: D/AndroidRuntime(266): 关闭虚拟机
> 
> 07-30 22:00:22.006: W/dalvikvm(266): threadid=1: 线程退出未捕获异常 (group=0x4001d800)
> 
> 07-30 22:00:22.037：E/AndroidRuntime(266)：致命异常：主要
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): java.lang.IllegalStateException: 无法执行活动的方法
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 android.view.View$1.onClick(View.java:2072)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 android.view.View.performClick(View.java:2408)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 android.view.View$PerformClick.run(View.java:8816)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 android.os.Handler.handleCallback(Handler.java:587)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 android.os.Handler.dispatchMessage(Handler.java:92)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 android.os.Looper.loop(Looper.java:123)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 android.app.ActivityThread.main(ActivityThread.java:4627)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 java.lang.reflect.Method.invokeNative(Native Method)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 java.lang.reflect.Method.invoke(Method.java:521)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): at dalvik.system.NativeStart.main(Native Method)
> 
> 07-30 22:00:22.037：E/AndroidRuntime(266)：由：java.lang.reflect.InvocationTargetException 引起
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 siuc.cs.rosie.USMCISTActivity.calculateScore(USMCISTActivity.java:61)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 java.lang.reflect.Method.invokeNative(Native Method)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 java.lang.reflect.Method.invoke(Method.java:521)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 android.view.View$1.onClick(View.java:2067)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): ... 11 更多
> 
> 07-30 22:00:22.037：E/AndroidRuntime(266)：原因：java.lang.NumberFormatException：无法将“”解析为整数
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 java.lang.Integer.parseInt(Integer.java:412)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): 在 java.lang.Integer.parseInt(Integer.java:382)
> 
> 07-30 22:00:22.037: E/AndroidRuntime(266): ... 还有 15 个

这是其余的课程：

男班：

```
package siuc.cs.rosie;

public class maleIst{
    int minutes;
    int seconds;
    int pullUp;
    int pullUpScore;
    boolean pullUpState;
    int crunchM;
    int crunchScore;
    boolean crunchState;
    int s=73;
    int high=809;
    int low=800;
    int run;
    int mrunScore;
    boolean done=false;
    boolean mrunState;
    String str=new String ();

    public int getPullUp()
    {
        return pullUp;
    }
    public void setPullUp(int pullUp)
    {
        this.pullUp = pullUp;
    }
    public int getcrunchM()
    {
        return crunchM;
    }
    public void setcrunchM(int crunchM)
    {
        this.crunchM = crunchM;
    }
    public int calculatePullUp()
    {
        if (pullUp<3)
        {
            pullUpScore=0;
            pullUpState=false;
        }
        else if (pullUp>20)
        {
            pullUpScore=100;
            pullUpState=true;
        }
        else if (pullUp>=3 && pullUp<=19)
        {
            pullUpScore=pullUp*5;
            pullUpState=true;
        }

        return pullUpScore;
    }

    public boolean PullUpState()
    {
        return pullUpState;
    }

    public int calculateCrunch()
    {
        if (crunchM<44)
        {
            crunchScore=0;
            crunchState=false;
        }
        else if (crunchM>=44 && crunchM<=100)
        {
            crunchScore=crunchM;
            crunchState=true;
        }
        else if (crunchM>100)
        {
            crunchScore=100;
            crunchState=true;
        }
        return crunchScore;
    }
    public boolean CrunchState()
    {
        return crunchState;
    }
    public int calculateMRun()
    {
        int run=seconds+(minutes*60);
        while (!done)
        {
            if (run<=540)
            {
                mrunScore=100;
                done=true;
                mrunState=true;
            }
            else if (run>810)
            {
                mrunScore=0;
                done=true;
                mrunState=false;
            }
            else if (run>540 && run<550)
            {
                mrunScore=99;
                done=true;
                mrunState=true;
            }
            else if (run>=801 && run<=810)
            {
                mrunScore=73;
                done=true;
                mrunState=true;
            }
            else if (low<=run && run<=high)
            {
                mrunScore=s;
                done=true;
                mrunState=true;
            }
            else
            {
                s++;
                high-=10;
                low-=10;
                mrunState=true;

            }   
        }
        return mrunScore;
    }
    public boolean MRunState()
    {
        return mrunState;
    }
    public String MistState()
    {

         if (PullUpState()==true && CrunchState()==true && MRunState()==true)
                 str="Pass";
         else
                 str="Fail";

        return str;
    }
    public int mIstScore()
    {
        int finalScore=pullUpScore+crunchScore+mrunScore;
        return finalScore;
}} 
```

女班：

```
package siuc.cs.rosie;

public class femaleIst  {
    int run;
    int armScore;
    boolean armState;
    int arm;
    int crunchF;
    int crunchScore;
    boolean crunchState;
    boolean frunState;
    int s=72;
    int high=889;
    int low=880;
    int frunScore;
    boolean done=false;
    String str=new String ();
    int minutes;
    int seconds;

    public int getArmHang()
    {
        return arm;
    }
    public void setarmHang(int arm)
    {
        this.arm = arm;
    }
    public int getcrunchF()
    {
        return crunchF;
    }
    public void setcrunchF(int crunchF)
    {
        this.crunchF = crunchF;
    }

    public int calculateHang()
    {
        if(arm<12)
        {
            armScore=0;
            armState=false;
        }
        else if (12<=arm && arm<=40)
        {
            armScore=arm;
            armState=true;
        }
        else if (40<arm && arm<=69)
        {
            int temp=arm-40;
            armScore=40+(temp*2);
            armState=true;
        }
        else if (arm>=70)
        {
            armScore=100;
            armState=true;
        }
        return armScore;
    }

    public boolean hangState()
    {
        return armState;
    }
    public int calculateCrunch()
    {
        if (crunchF<44)
        {
            crunchScore=0;
            crunchState=false;
        }
        else if (crunchF>=44 && crunchF<=100)
        {
            crunchScore=crunchF;
            crunchState=true;
        }
        else if (crunchF>100)
        {
            crunchScore=100;
            crunchState=true;
        }
        return crunchScore;
    }
    public boolean CrunchState()
    {
        return crunchState;
    }

    public int calculatefRun()
    {
        int run=seconds+(minutes*60);
        while (!done)
        {
            if (run<=630)
            {
                frunScore=100;
                done=true;
                frunState=true;
            }
            else if (run>900)
            {
                frunScore=0;
                done=true;
                frunState=false;
            }
            else if (run>630 && run<640)
            {
                frunScore=99;
                done=true;
                frunState=true;
            }
            else if (run>=890 && run<=900)
            {
                frunScore=72;
                done=true;
                frunState=true;
            }
            else if (low<=run && run<=high)
            {
                frunScore=s;
                done=true;
                frunState=true;
            }
            else
            {
                s++;
                high-=10;
                low-=10;
                frunState=true;

            }

        }
        return frunScore;
    }

    public boolean FRunState()
    {
        return frunState;
    }
    public String FistState()
    {
        if (hangState()==true && CrunchState()==true && FRunState()==true)
            str="Pass";
        else
            str="Fail";

        return str;
    }

    public int fIstScore()
    {
        int finalScore=armScore+crunchScore+frunScore;
        return finalScore;
    }
   } 
```

****更新代码*****主要活动* ***

我删除（从其他“帮助”类扩展 Activity）

```
public class USMCISTActivity extends Activity {
    /** Called when the activity is first created. */

    private EditText pullUpArm;
    private EditText crunches;
    private EditText runMins;
    private EditText runSecs;
    private TextView factor1;
    private TextView txtscore;
    private TextView result;
    Button calculate, male, female, about;
    int tempScore;
    String tempResult;
    maleIst m;
    femaleIst f;
    final CheckBox checkBox=(CheckBox) findViewById(R.id.checkBox1);
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        m = new maleIst();
        f = new femaleIst();

        pullUpArm=(EditText) findViewById(R.id.editText1);

        crunches=(EditText) findViewById(R.id.editText2);

        runMins=(EditText) findViewById(R.id.editText4); 

        runSecs=(EditText) findViewById(R.id.editText3);

        factor1=(TextView) findViewById(R.id.textView4); 
        calculate=(Button) findViewById(R.id.button1);

        //final CheckBox checkBox=(CheckBox) findViewById(R.id.checkBox1);
        txtscore=(TextView) findViewById(R.id.textView7);

        result=(TextView) findViewById(R.id.textView8);
    }

    public void calculateScore(View v)
    {   
        int armPull = Integer.parseInt(pullUpArm.getText().toString());
        int crunchesNum = Integer.parseInt(crunches.getText().toString());
        int runmins = Integer.parseInt(runMins.getText().toString());
        int runsec = Integer.parseInt(runSecs.getText().toString());
        String myresult="NA";
        int score=0;
        //checkBox.setChecked(false);
        //String resultTxt=result;
        //String myresult=result.getText().toString();
        //int score = Integer.parseInt(txtscore.getText().toString());

        if (checkBox.isChecked())
        {
            f.arm = armPull;
            m.crunchM = crunchesNum;
            m.minutes = runmins;
            m.seconds = runsec;
            score = f.fIstScore();
            myresult = f.FistState();

        }
        else 
        {
            m.pullUp = armPull;
            m.crunchM = crunchesNum;
            m.minutes = runmins;
            m.seconds = runsec;
            score = m.mIstScore();
            myresult= m.MistState();
        }

        result.setText(myresult);
        result.setVisibility(1);
        txtscore.setText(Integer.toString(score));
        txtscore.setVisibility(1);

        //result.setText(myresult);//is this right? I cannot get the result pass or fail to show

    }

    public void femaleClick(View v)
    {
        factor1.setText("Arm Hang");
    }

}

HERE IS MY XML LAYOUT:

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/background" >

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="22dp"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:text="@string/enterScores"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textColor="@color/text_color"
        android:textSize="25dp" />

    <TextView
        android:id="@+id/textView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:text="@string/run1"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textColor="@color/text_color" />

    <TextView
        android:id="@+id/textView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/textView6"
        android:layout_alignParentLeft="true"
        android:layout_marginBottom="22dp"
        android:text="@string/Crunches"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textColor="@color/text_color" />

    <TextView
        android:id="@+id/textView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/textView5"
        android:layout_alignParentLeft="true"
        android:layout_marginBottom="22dp"
        android:text="@string/pullUps"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textColor="@color/text_color" />

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/textView4"
        android:layout_alignBottom="@+id/textView4"
        android:layout_alignParentRight="true"
        android:ems="10"
        android:inputType="number" />

    <EditText
        android:id="@+id/editText2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/textView5"
        android:layout_alignBottom="@+id/textView5"
        android:layout_alignLeft="@+id/editText1"
        android:ems="10"
        android:inputType="number" >

        <requestFocus />
    </EditText>

    <EditText
        android:id="@+id/editText3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/textView6"
        android:layout_alignBottom="@+id/textView6"
        android:layout_alignParentRight="true"
        android:ems="10"
        android:inputType="number"
        android:text="@string/seconds1" />

    <EditText
        android:id="@+id/editText4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/textView6"
        android:layout_alignBottom="@+id/textView6"
        android:layout_alignLeft="@+id/editText2"
        android:ems="10"
        android:inputType="number"
        android:text="@string/minutes1" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/editText3"
        android:layout_marginTop="19dp"
        android:onClick="calculateScore"
        android:text="@string/calculate" />

    <CheckBox
        android:id="@+id/checkBox1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/textView3"
        android:onClick="femaleClick"
        android:text="@string/gender1" />

    <ImageView
        android:id="@+id/ega"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/button1"
        android:layout_toRightOf="@+id/button1"
        android:scaleType="fitCenter"
        android:src="@drawable/egablack" />

    <TextView
        android:id="@+id/textView7"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/button1"
        android:layout_toLeftOf="@+id/editText3"
        android:text="@string/score1"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <TextView
        android:id="@+id/textView8"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView7"
        android:layout_marginTop="23dp"
        android:layout_toLeftOf="@+id/editText3"
        android:text="@string/testState"
        android:textAppearance="?android:attr/textAppearanceLarge" />

</RelativeLayout>

AND FINALLY AN UPDATED LOGCAT:

07-30 21:35:44.952: D/AndroidRuntime(274): Shutting down VM

07-30 21:35:44.952: W/dalvikvm(274): threadid=1: thread exiting with uncaught exception (group=0x4001d800)

07-30 21:35:45.013: E/AndroidRuntime(274): FATAL EXCEPTION: main

07-30 21:35:45.013: E/AndroidRuntime(274): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{siuc.cs.rosie/siuc.cs.rosie.USMCISTActivity}: java.lang.NullPointerException

07-30 21:35:45.013: E/AndroidRuntime(274):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2585)
07-30 21:35:45.013: E/AndroidRuntime(274):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
07-30 21:35:45.013: E/AndroidRuntime(274):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
07-30 21:35:45.013: E/AndroidRuntime(274):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
07-30 21:35:45.013: E/AndroidRuntime(274):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-30 21:35:45.013: E/AndroidRuntime(274):  at android.os.Looper.loop(Looper.java:123)
07-30 21:35:45.013: E/AndroidRuntime(274):  at android.app.ActivityThread.main(ActivityThread.java:4627)
07-30 21:35:45.013: E/AndroidRuntime(274):  at java.lang.reflect.Method.invokeNative(Native Method)
07-30 21:35:45.013: E/AndroidRuntime(274):  at java.lang.reflect.Method.invoke(Method.java:521)
07-30 21:35:45.013: E/AndroidRuntime(274):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-30 21:35:45.013: E/AndroidRuntime(274):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-30 21:35:45.013: E/AndroidRuntime(274):  at dalvik.system.NativeStart.main(Native Method)

07-30 21:35:45.013: E/AndroidRuntime(274): Caused by: java.lang.NullPointerException
07-30 21:35:45.013: E/AndroidRuntime(274):  at android.app.Activity.findViewById(Activity.java:1637)
07-30 21:35:45.013: E/AndroidRuntime(274):  at siuc.cs.rosie.USMCISTActivity.<init>(USMCISTActivity.java:27)
07-30 21:35:45.013: E/AndroidRuntime(274):  at java.lang.Class.newInstanceImpl(Native Method)
07-30 21:35:45.013: E/AndroidRuntime(274):  at java.lang.Class.newInstance(Class.java:1429)
07-30 21:35:45.013: E/AndroidRuntime(274):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
07-30 21:35:45.013: E/AndroidRuntime(274):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2577)
07-30 21:35:45.013: E/AndroidRuntime(274):  ... 11 more
07-30 21:35:47.923: I/Process(274): Sending signal. PID: 274 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:27:31.450

```
m = new maleIst();
f = new femaleIst(); 
```

你不能也绝不能尝试这样做。

扩展的类`Activity`永远不能使用`new`. An`Activity`是一个特例类，只能由操作系统使用`startActivity(...)`或其他`startXXX`方法创建。

An`Activity`永远不应该公开任何方法或成员变量以供任何其他应用程序组件使用 - Android 根本无法以这种方式工作。

请阅读[应用程序基础](http://developer.android.com/guide/components/fundamentals.html)和[活动](http://developer.android.com/reference/android/app/Activity.html)文档。

**编辑：**首先，`extends Activity`从您的`maleIst`和`femaleIst`类定义中删除。它们显然是帮助类，不提供`Activity`功能，即它们不用作 UI 组件。

其次，使您的应用程序崩溃的异常是由这一行引起的......

```
int score = Integer.parseInt(txtscore.getText().toString()); 
```

...但是您永远不会为`txtscore`小部件设置任何文本。在我看来，您要么需要完全删除这一行，要么将其移到代码的后面。

老实说，我真的不确定您的代码在做什么，但看起来您遇到了流程问题，即您的操作顺序错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:16:35.030

```
07-30 22:00:22.037: E/AndroidRuntime(266): Caused by: java.lang.NumberFormatException: unable to parse '' as integer 
```

错误的上述部分暗示您在代码中的某处试图将空字符串转换为数字。我希望它在您`MistState`或`FistState`代码中的某个地方。你能把那个贴出来吗？

- 编辑

查看您的额外代码，当字段未完成时，似乎引发了异常。您正在尝试将空字符串转换为整数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T23:10:58.587

从堆栈跟踪来看，该视图的代码似乎失败了

```
int score = Integer.parseInt(txtscore.getText().toString()); 
```

问题可能是您的 TextView 上没有设置任何文本，因此**getText()**返回一个空字符串。这将导致整数转换失败，并出现无效数字格式异常。

话虽如此，您不需要在该步骤将字符串转换为 int 。由于您已经可以访问需要设置的 TextView，因此您只需对其调用**setText(...)**方法。

更改这些行

```
String myresult=result.getText().toString();
int score = Integer.parseInt(txtscore.getText().toString());//this is what is making the program crash 
```

对此

```
String myresult = "NA"; // Default text to display
int score = 0; // Default score value 
```

这基本上会让你摆脱程序崩溃的问题。

现在没有显示分数或结果（通过/失败）的原因是因为您试图使用 Button.isPressed() 方法来检查它是男性还是女性。

```
if(male.isPressed()) {
......
} else if(female.isPressed()) {
......
} 
```

由于您单击“计算”按钮来获取分数，因此其他按钮都不会处于按下状态。我相信您在这里需要的是某种复选框或无线电控件，可以从男性或女性中进行选择。也许一份清单可以完成这项工作。

只是为了检查您的计算是否有效，请更改`if(male.isPressed())`为`if(true)`. 这将始终返回男性的分数。你也可以对女班做同样的事情。

此外，如上述帖子中所述，您的子类不需要扩展`Activity`该类。这当然是基于您提供的代码。

# linux - linux模块编译错过的文件夹asm

> ID：11730181
> 
> 赞同：6
> 
> 时间：2012-07-30T21:49:17.293
> 
> 标签：linux, module, header, kernel

我正在尝试编译驱动程序。我的内核版本是 3.2.0-27-generic。

我留下的只包括我需要的：

```
#include <linux/init.h>
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/proc_fs.h>
#include <linux/pci.h>
#include <linux/delay.h>
#include <linux/dmi.h> 
```

找到这些标题。但是当我尝试编译时，我收到错误，即找不到 asm/cache.h 文件。当我挖dipper时，我发现没有“asm”这样的文件夹，而是asm-generic，它包含必需的标题。

它是带有标题的文件夹结构： ![](../Images/a98ee1467b0325df83272be1c8d0f9ba.png) 为什么要重命名？因此，我无法编译其他驱动程序。如果我将“asm-geneic”重命名为“asm”，它将导致其他丢失的标题。这里有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T22:17:54.810

*asm/cache.h*依赖于架构，不同的架构有不同的 asm 目录

```
arch/powerpc/include/asm/
arch/x86/include/asm/
arch/arm/include/asm
[...] 
```

您无法将*include/asm-generic*重命名为*include/asm*，因为您的问题是您无法访问架构*asm*文件夹。尝试检查您的 .config 文件或手动设置*ARCH*变量。

# json - fullcalendar 通过 Json 获取事件

> ID：11730185
> 
> 赞同：0
> 
> 时间：2012-07-30T21:50:01.097
> 
> 标签：json, fullcalendar

我的 fullCalendar 对象中的事件没有显示有问题。

我有这个 JavaScript

```
 $('#calendar').fullCalendar({
    header: {
        left: 'prev,next today',
        center: 'title',
        right: 'month,agendaWeek,agendaDay'
    },
    editable: true,
    eventSources: ["api/apiCalendar"],
    loading: function (bool) {
        if (bool) $('#loading').show();
        else $('#loading').hide();

    }
}); 
```

我使用 asp.net mvc 4, web api 来获取 JSON

```
 public HttpResponseMessage Get(string start, string end)
    {
        calEvent e = new calEvent();
        e.id = 1;
        e.allDay = true;
        e.end = DateTime.Now;
        e.start = DateTime.Now.AddHours(-2);
        e.title = "Test";

        string json = JsonConvert.SerializeObject(e);

       return new HttpResponseMessage()
        {
            Content = new StringContent(json, System.Text.Encoding.UTF8, "application/json")
        };
    } 
```

此方法返回： {"title":"Test","allDay":true,"start":"2012-07-30T21:45:00.8461321+02:00","end":"2012-07-30T23: 45:00.8461321+02:00","url":null,"id":1}

当我尝试直接在事件上设置此 JSON 字符串时，如下所示：

```
$('#calendar')......
events: [{"title":"Test","allDay":true,"start":"2012-07-30T21:45:00.8461321+02:00","end":"2012-07-30T23:45:00.8461321+02:00","url":null,"id":1}], 
```

事件渲染良好。

但是当试图从 web 方法中获取时，什么都没有显示。调试时没有错误或任何看起来有问题的东西。

我使用插件的最新版本。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-31T07:55:00.947

经过更多研究，解决方案在这里[FullCalendar - JSON 源不起作用，但直接使用 JSON 数据可以](https://stackoverflow.com/questions/9637166/fullcalendar-json-source-doesnt-work-but-using-the-json-data-directly-does?rq=1)

正如这篇文章中指出的，这与 asp.net 的问题相同

# apache - 尝试对 var/www/html 使用符号链接

> ID：11730186
> 
> 赞同：8
> 
> 时间：2012-07-30T21:50:02.457
> 
> 标签：apache, amazon-ec2

这就是我要完成的工作：`var/www/html`在 home ( `~`) 文件夹中创建指向目录的符号链接。我试图在 home ( `~`) 中符号链接到的目录是一个 git 存储库，如果这有什么不同的话。我在这个目录中有一个 index.html 文件。

我使用以下命令在 Amazon EC2 实例上创建了指向 var/www/html 的符号链接：`ln -s ~/dirIWant/ html`但是当我尝试访问我的网页时，这会导致以下错误：`403 Forbidden "You don't have permission to access / on this server."`我正在使用 apache。

有没有其他人试图做类似的事情并让它发挥作用？

目前，当我访问我的网站 www.blah.com 时，它会显示此 403 错误。我尝试使用更改权限，`sudo chown -h apache:apache`但似乎没有帮助。你还有其他建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-30T22:15:40.513

这是因为 apache 作为*apache*用户运行，并且`/var/www/html`在 Amazon Linux AMI 中归 root 所有。您可以按照 Frank 的建议更改所有权/权限，或使用**userdirs**。

在我看来，您希望可以从您的主目录 ( `~`) 方便地访问网络服务器的文件夹。我想在我的 EC2 上使用类似的东西，并决定使用*每用户 Web 目录*（[mod_userdir](http://httpd.apache.org/docs/2.2/howto/public_html.html)）。

此功能允许您将部分 HTTP 服务器空间保留在用户拥有的目录中。每个用户都有自己的目录，默认位于`/home/username/public_html`. 该目录中的页面、脚本和其他文件可以通过附加`/~username`到您的域来访问互联网。此外，您可以将 httpd.conf 中该文件夹的名称从更改为其他名称`public_html`，例如`gitRepo`. 在这种情况下，如果你有一个`index.html`文件`/home/ec2-user/gitRepo/index.html`，它可以通过 ec2-user 被公众访问`http://ec2-hostname.aws.amazon.com/~ec2-user/index.html`并归 ec2-user 所有，这便于从用户级别编辑文件。

要在 EC2 上进行设置（假设您要使用的文件夹名称为“gitRepo”），请使用`nano /etc/httpd/conf/httpd.conf`打开 Apache 配置文件并向下滚动，直到看到`<IfModule mod_userdir.c>`. 然后将此部分更改为如下所示：

```
<IfModule mod_userdir.c>
    #
    # UserDir is disabled by default since it can confirm the presence
    # of a username on the system (depending on home directory
    # permissions).
    #
    UserDir enabled all

    #
    # To enable requests to /~user/ to serve the user's public_html
    # directory, remove the "UserDir disabled" line above, and uncomment
    # the following line instead:
    #
    UserDir gitRepo

</IfModule> 
```

之后您应该一切顺利，但请确保权限设置正确：

```
chmod 711 /home/ec2-user
chmod 755 /home/ec2-user/gitRepo
chown -R ec2-user /home/ec2-user/gitRepo 
```

最后像这样重新加载网络服务器：

```
sudo service httpd reload 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-31T10:24:52.713

```
here how to link file into other directory example with apache2 config file 

**user of symbolic**
## if file available then first remove it 
$ sudo rm -rf /etc/apache2/sites-enabled/000-default.conf 
## sudo lm -s  /path of source /path of destination 
$ sudo ln -s /etc/apache2/sites-available/000-default.conf /etc/apache2/sites-enabled/
$ sudo systemctl restart apache2
$ sudo systemctl status apache2

[![enter image description here][1]][1]

  [1]: https://i.stack.imgur.com/pRSoq.png 
```

# core-plot - 如何标记 Core-Plot 条形图的每个条形的底？

> ID：11730189
> 
> 赞同：0
> 
> 时间：2012-07-30T21:50:13.190
> 
> 标签：core-plot

1) 如何在条形图的每个条形的底部放置一个文本描述符？例如，6 个月的条形图，每个条形图的底部都有其关联的月份名称。

2) 如何调整条形图条之间的间距？

我指的是以下[链接](https://stackoverflow.com/questions/11509809/labeling-in-barplot)中回答的内容，该链接提供了演示，但没有文档。所以基本上，我已经完成了一半......但希望有一些文档作为新手跟进。

问候，里克。

# iphone - 如何根据行内容制作可更改的表格高度大小？

> ID：11730190
> 
> 赞同：0
> 
> 时间：2012-07-30T21:50:15.367
> 
> 标签：iphone, ios, xcode

我希望行高基于内容高度......所以每个行高的大小都可以根据内容进行调整。

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    return tableView.contentSize.height;
} 
```

这是我到目前为止所拥有的，但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:27:50.183

基本上，您需要获取单元格的内容，然后根据它确定单元格的大小。例如，您可能有

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];
    NSString *string = cell.textLabel.text;
    CGSize textSize = [string sizeWithFont:[UIFont fontWithName:@"Helvetica" size:15] constrainedToSize:CGSizeMake(240, 5000)];
    return textSize.height + 40;
} 
```

上面的内容是获取单元格中的文本，计算所需的高度（如果它是 240px 宽并使用 Helvetica 15pt），然后相应地更改单元格的高度。你仍然需要`cell.textLabel`在你的`cellForRowAtIndexPath`方法中调整你的框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T06:02:41.737

```
Try this code for exmaple and also refer this http://www.icodeblog.com/2010/11/18/making-smarter-table-view-cells/  

 #define FONT_SIZE 14.0f
    #define CELL_CONTENT_WIDTH 125.0f
    #define CELL_CONTENT_MARGIN 10.0f
    - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
       // static NSString *CellIdentifier = @"Cell";
        NSString *CellIdentifier = [NSString stringWithFormat:@"%d", indexPath.row] ;
        UILabel *lblTitle = nil;
        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
        if (cell == nil) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
            cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
            cell.selectionStyle = UITableViewCellSelectionStyleNone;

            lblTitle =[[UILabel alloc]initWithFrame:CGRectMake(5, 15, 110, 44)];
            lblTitle.backgroundColor = [UIColor clearColor];
            lblTitle.textColor = [UIColor whiteColor];
            lblTitle.font = [UIFont systemFontOfSize:11.0];
            lblTitle.tag = 1;
            lblTitle.numberOfLines = 0;

            UILabel *lblType =[[UILabel alloc]initWithFrame:CGRectMake(125, 0, 75, 44)];
            lblType.backgroundColor = [UIColor clearColor];
            lblType.textColor = [UIColor whiteColor];
            lblType.font = [UIFont systemFontOfSize:11.0];
            lblType.tag = 2;

            UILabel *lblDate =[[UILabel alloc]initWithFrame:CGRectMake(200, 0, 60, 44)];
            lblDate.backgroundColor = [UIColor clearColor];
            lblDate.textColor = [UIColor whiteColor];
            lblDate.font = [UIFont systemFontOfSize:11.0];
            lblDate.tag = 3;

            UILabel *lblTime =[[UILabel alloc]initWithFrame:CGRectMake(265, 0, 50, 44)];
            lblTime.backgroundColor = [UIColor clearColor];
            lblTime.textColor = [UIColor whiteColor];
            lblTime.font = [UIFont systemFontOfSize:11.0];
            lblTime.tag = 4;

            [tableView beginUpdates];
            [tableView endUpdates]; 
            [cell.contentView addSubview:lblTitle];
            [cell.contentView addSubview:lblType];
            [cell.contentView addSubview:lblDate];
            [cell.contentView addSubview:lblTime];

        }

    //    lblTitle = (UILabel *) [cell.contentView viewWithTag:1];
    //    lblTitle.text =[[itemsData objectAtIndex:indexPath.row] objectForKey:@"title"];
    //    NSString *strTitle =[NSString stringWithFormat:@"%@,%@,%@",[[itemsData objectAtIndex:indexPath.row] objectForKey:@"address"],[[itemsData objectAtIndex:indexPath.row] objectForKey:@"title"],[[itemsData objectAtIndex:indexPath.row] objectForKey:@"zipcode"]];

    //    lblTitle.text = [NSString stringWithFormat:@"%@,%@,%@",[[itemsData objectAtIndex:indexPath.row] objectForKey:@"address"],[[itemsData objectAtIndex:indexPath.row] objectForKey:@"title"],[[itemsData objectAtIndex:indexPath.row] objectForKey:@"zipcode"]];

        NSString *text = [NSString stringWithFormat:@"%@,%@,%@",[[itemsData objectAtIndex:indexPath.row] objectForKey:@"address"],[[itemsData objectAtIndex:indexPath.row] objectForKey:@"title"],[[itemsData objectAtIndex:indexPath.row] objectForKey:@"zipcode"]];

        CGSize constraint = CGSizeMake(CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), 20000.0f);

        CGSize size = [text sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:UILineBreakModeCharacterWrap];

        if (!lblTitle)
            lblTitle = (UILabel*)[cell viewWithTag:1];

        [lblTitle setText:text];
        [lblTitle setFrame:CGRectMake(CELL_CONTENT_MARGIN, CELL_CONTENT_MARGIN, CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), MAX(size.height, 44.0f))];

        UILabel *lblType = (UILabel *) [cell.contentView viewWithTag:2];
        lblType.text =[[itemsData objectAtIndex:indexPath.row] objectForKey:@"type"];

        UILabel *lblDate = (UILabel *) [cell.contentView viewWithTag:3];
        lblDate.text =[[itemsData objectAtIndex:indexPath.row] objectForKey:@"date"];

        UILabel *lblTime = (UILabel *) [cell.contentView viewWithTag:4];
        lblTime.text =[[itemsData objectAtIndex:indexPath.row] objectForKey:@"time"];

        return cell;
    }
    -(float)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        NSString *text = [NSString stringWithFormat:@"%@,%@,%@",[[itemsData objectAtIndex:indexPath.row] objectForKey:@"address"],[[itemsData objectAtIndex:indexPath.row] objectForKey:@"title"],[[itemsData objectAtIndex:indexPath.row] objectForKey:@"zipcode"]];

        CGSize constraint = CGSizeMake(CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), 20000.0f);

        CGSize size = [text sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:UILineBreakModeCharacterWrap];

        CGFloat height = MAX(size.height, 44.0f);

        return height + (CELL_CONTENT_MARGIN * 2);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T22:00:09.430

是的，因为这个方法被调用的时候，单元格的内容视图的框架是CGRectZero。您最好将自定义属性分配给单元格并将其返回。

# c# - 小数的不同位整数内的显着性能差异

> ID：11730193
> 
> 赞同：1
> 
> 时间：2012-07-30T21:50:26.033
> 
> 标签：c#, performance, variables, integer

我将第一次使用非常少量的非常小的数字（因为每个 int 将在 1 到 10 之间，并且一次有 100 个这样的变量），我想知道是否有任何显着的性能使用 16 位整数与 32 位的区别。我的大多数用户将使用 64 位处理器，但有些用户将使用 32 位。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T21:52:59.303

**中央处理器**

使用单个数字时，使用更紧凑的表示*可能*会略有改进。那是，

```
ushort a;
ushort b;

// @mikez pointed a & b are  promoted to int when added
// C# spec, 7.3.6.2 Binary numeric promotions
ushort result = (ushort)(a + b); 
```

*可能*比

```
ulong a;
ulong b;

ulong result = a + b; 
```

*取决于*你的算法。原因是当单个数字较小时，更多的数据可以放入 CPU 缓存中，最终需要从 RAM 传输到 CPU 的数据更少。

另一方面，由于读/写数据未与 64 位地址边界对齐，它可能会*稍微慢一些。*

这两个因素相互影响。衡量您的用例，从 CPU 的角度了解您的情况是好是坏。

**在内存中**

使用 a`List<ushort>`而不是 a`List<ulong>`将节省 75% 的内存成本。 *如果*这阻止了交换，它将使您的应用程序受益。

**在磁盘上**

如果您正在保存到数据库，并且如果您的工作集太大而无法容纳数据库引擎可用的 RAM，则使用较小的大小可能会对性能产生巨大影响，因为更多的记录适合较少的磁盘扇区，从而减少了磁盘寻道时间（假设没有 SSD）并增加每单位时间内可以通过 IO 通道传输的数据点数量。

**警告**

请注意，只有与计算机的处理能力相比，数量确实很大时，所有这些才有**意义***。*如果您有足够的 RAM 将所有数据保存在内存中，则不会交换。如果您的数据库服务器和/或存储控制器缓存可以将您的工作集保存在内存中，那么磁盘存储大小的考虑将无关紧要。

 ****底线**

如果您对要处理的值的范围有误，那么使用较小的数据类型只会对您造成伤害，并且您突然需要更大的数据类型来保存所有值。

快速制作关键算法的原型。使用 ushort、uint、ulong 的各种选择执行一些测量。

如果您的“100 个变量”每个都只包含一个数字（而不是一个包含大量数字的列表），那么这些都不重要。只有当您开始对您的计算机施加压力时（可能在 10 到 100 的数百万或更多数据点，具体取决于您在做什么），这些优化才会对您的用户真正重要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-30T21:52:25.850

如有疑问，请测量。但除了内存消耗差异之外，我怀疑你会看到任何东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-30T22:04:14.827

总的来说，这里的答案很好，但是在 .NET 平台上有一个特定的考虑：CIL 中没有 8 位或 16 位算术运算。

这意味着出于算术的目的，所有 8 位和 16 位值都被隐式转换为 32 位。

[ECMA 规范 - 第 3 部分 (CIL)](http://jilc.sourceforge.net/ecma_p3_cil.shtml) - 第 1.6 节隐式参数强制**

# mysql - 在插入语句分析之前，插入触发器不设置值

> ID：11730196
> 
> 赞同：0
> 
> 时间：2012-07-30T21:50:31.823
> 
> 标签：mysql, triggers, enums, insert

我有一个要在将行插入表之前运行的触发器：

```
CREATE TABLE IF NOT EXISTS `test`.`t1`(
  `idt1` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `myType` ENUM('A','B','C') NOT NULL DEFAULT 'A',
  PRIMARY KEY (`idt1`) )
ENGINE = InnoDB;

delimiter $$
CREATE TRIGGER mtCheck BEFORE INSERT ON t1
FOR EACH ROW
BEGIN
    set @action = NEW.myType;
IF (NEW.myType NOT LIKE 'B') THEN
            SET New.myType = 'C';
    END IF;
    set @action2 = NEW.myType;
END $$
delimiter ; 
```

如果我运行下面的代码，因为 'A' 是 EMUN 的有效值，@action 是 'A' 而 @action2 是 'C'：

```
set @action = 'no action';
set @action2 = 'no action';
select @action, @action2;
start transaction;
insert into t1(idt1, myType) values (1, 'A');
select @action, @action2;
select * from t1;
rollback;
select * from t1;
select @action, @action2; 
```

如果我更改以下示例之一的插入语句，我会收到以下错误：

```
insert into t1(idt1, myType) values (1, 'F'); 
```

> -> 错误 1265 (01000)：第 1 行的列“myType”的数据被截断

```
insert into t1(idt1, myType) values (1, null); 
```

> -> 错误 1048 (23000)：列 'myType' 不能为空

触发器不应该将新值强制输入 NEW.myType 字段并且插入语句继续使用正确的值吗？在这种情况下，两个示例都应在表 t1 的 myType 字段中输入值“C”。

它与我的 sql_mode 有什么关系吗？

```
SELECT @@GLOBAL.sql_mode; 
```

> -> STRICT_TRANS_TABLES，NO_AUTO_CREATE_USER，NO_ENGINE_SUBSTITUTION

```
SELECT @@SESSION.sql_mode; 
```

> -> STRICT_TRANS_TABLES，NO_AUTO_CREATE_USER，NO_ENGINE_SUBSTITUTION

我应该把它改成`STRICT_ALL_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION`?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:04:02.280

我相信我发现了我的错误。

为在事务中插入/更新原始表行而创建的临时表与原始表具有相同的限制。

如果此分析准确，则意味着在我插入/更新表行之前，数据库管理系统将验证正在插入/更新的值并返回上述错误，因为我没有提供有效数据。

在建立与数据库的连接之前，我必须将验证留给应用程序。

# php - PHP post_max_size 本地值被 Plesk / IIS 上的主值覆盖？

> ID：11730198
> 
> 赞同：4
> 
> 时间：2012-07-30T21:50:41.263
> 
> 标签：php, iis, plesk

通过 PHP（通过 Drupal，虽然这不是问题）上传大文件时，我遇到了一个奇怪的问题。

基本上，由于达到 post_max_size 限制，我的文件上传失败，即使本地指令设置为 96M，文件为 25M。

我已确保其他所有内容都是正确的，包括`max_input_time`、`max_upload_filesize`和 IIS FastCGI 空闲时间。所有这些都很大，不是问题。

我正在`post_max_size`通过 Plesk 覆盖该指令，它（我相信）将更改存储在注册表值中。在域上运行 phpinfo() 会显示所有指令的正确本地和主值...96M 本地，12M 主。

很奇怪的是，当我把`post_max_size`php.ini中的master从12M改成96M（并确保修改已经生效）后，**就正常工作了！**将主值更改回 12M（并保持本地值 96M）会立即导致上传再次失败。

这是PHP中的错误，还是我做错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T15:32:10.810

事实证明，在 Windows 上，您只能设置`PHP_INI_USER`按目录标记的 ini 指令。不幸的是，`upload_max_filesize`两者`post_max_size`都是`PHP_INI_PERDIR`。[来自http://php.net/manual/en/configuration.changes.php](http://php.net/manual/en/configuration.changes.php)的 PHP 文档

> 该目录的设置对于从此目录或其任何子目录运行的任何脚本都是活动的。键下的值应具有 PHP 配置指令的名称和字符串值。值中的 PHP 常量不会被解析。**但是，只有 PHP_INI_USER 中可更改的配置值可以这样设置，PHP_INI_PERDIR 值不能。**

因此，即使 Plesk 有一个界面来更改这些指令，并且即使`phpinfo()`接受了它们，*它们也不会改变实际的最大上传大小。*Plesk 不应允许您在 Windows 上更改这些内容，`phpinfo()`也不应报告更改，但您能做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T21:55:14.183

检查 php.ini 中 PHP 的 post_max_size 和 upload_max_filesize 以及是否有任何覆盖（例如本地 php.ini 或 .htaccess）

编辑：应该注意的是，不能依赖 phpinfo() 来确定在请求期间（也就是文件上传时）是否有任何覆盖可用，因为它将在响应期间进行处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T16:02:04.670

我在 Plesk 中遇到过类似的问题。您是否在 Plesk 中编辑过任何模板？我知道当它运行它的 cron 作业时，如果您没有通过 Plesk 进行某些配置编辑，您可能会丢失它们。

但是你的 .htaccess 文件呢？您还可以在此处设置这些限制，并且根据您的 Plesk 配置，这可能是进行这些更改的更好位置。

# java - java - 将 JSONObject 发布到 Restful Web 服务时出现 400

> ID：11730199
> 
> 赞同：2
> 
> 时间：2012-07-30T21:50:42.420
> 
> 标签：java, json, web-services, rest, http-status-code-400

我正在尝试为我的宁静 Web 服务实现发布功能。但是，每当我尝试使用我的发布客户端发布数据时，服务器总是返回 400 错误请求异常。

下面是我的帖子客户端：

```
public static HttpResponse post(String url, JSONObject data) throws IOException {
    HttpClient client = new DefaultHttpClient();
    StringEntity json = new StringEntity(data.toString());
    json.setContentType("application/json");
    HttpPost post = new HttpPost(url);
    post.addHeader("Content-Type", "application/json");
    post.setEntity(json);
    return client.execute(post);
} 
```

下面是我的服务器端方法的方法标头：

```
@POST
@Consumes("application/json")
@Produces("text/plain")
@Path("/add")
public String addApp(@PathParam("device") String device, JSONObject json) { 
```

每当我运行程序时，我都会从我的 post 方法中获得以下 HttpResponse：

```
HTTP/1.1 400 Bad Request [Server: nginx, Date: Mon, 30 Jul 2012 21:48:12 GMT, Content-Type: text/plain, Transfer-Encoding: chunked, Connection: keep-alive, Keep-Alive: timeout=5, X-Powered-By: Servlet/3.0 JSP/2.2 (GlassFish Server Open Source Edition 3.1 Java/Sun Microsystems Inc./1.6)] 
```

这个问题的一些可能原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T03:34:31.317

您在服务器签名中指定了 PathParam 参数，但在 @Path 注释中没有相应的条目。如果您已经将设备字符串添加到 URL，我无法从您的客户端签名中判断，但我相信您想要这样的东西：

```
@POST
@Consumes("application/json")
@Produces("text/plain")
@Path("/add/{device}")
public String addApp(@PathParam("device") String device, JSONObject json) { 
```

这是关键部分：

```
@Path("/add/{device}") 
```

有了这个 Jersey 就知道在哪里寻找应该填充到设备中的字符串。

# java - 如何阻止swing应用程序的所有窗口并在它们之上显示JDialog？

> ID：11730202
> 
> 赞同：3
> 
> 时间：2012-07-30T21:50:46.220
> 
> 标签：java, swing, jframe, jdialog, joptionpane

我有写为 JFrame 的应用程序。我有一些对话窗口。

main_window[JFrame] -> edit_user[JDialog] -> change_pass[JDialog]

层次结构看起来像上面这样。我也有监控互联网连接的进程（线程）。

我想做的是在连接断开时 **在所有打开的窗口（我的应用程序）的顶部显示 JDialog。****我还需要阻止我的应用程序窗口。**

我不想使用 setAlwaysOnTop() ，因为这会将 i 置于所有打开的应用程序之上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-30T21:53:16.750

[Java 教程：如何在对话框中使用模态](http://docs.oracle.com/javase/tutorial/uiswing/misc/modality.html)。

> **模态对话框**- 一个对话框，它阻止输入到应用程序中的一些其他顶级窗口，但以对话框作为其所有者创建的窗口除外。模态对话框捕获窗口焦点直到它关闭，通常是响应按钮按下。

# ruby-on-rails - 在不使用外部 gem 的情况下将文件上传到 db Rails 3

> ID：11730212
> 
> 赞同：3
> 
> 时间：2012-07-30T21:51:59.840
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, file-upload

我有一个任务，我需要在 Rails 3.2 中上传一个文件（.txt），而不使用任何外部 gem 来做腿部工作（恐怕不可协商）该文件还需要保存到数据库中。我有以下代码，但是当我尝试使用表单上传/创建新附件时，它会返回错误；

```
No route matches [POST] "/attachments/create" 
```

看起来没有使用模型中的 upload_file 调用创建操作，但我不确定如何纠正它。如果有人能指出我正确的方向，将不胜感激。

所以我的代码如下；

附件控制器.rb

```
class AttachmentsController < ApplicationController

 def show
   @attachment = Attachment.find(params[:id])
   end_data @attachment.data, :filename => @attachment.filename, :type =>  @attachment.content_type
 end

 def create      
   return if params[:attachment].blank?

   @attachment = Attachment.new
   @attachment.uploaded_file = params[:attachment]

   if @attachment.save
      flash[:notice] = "Thank you for your submission..."
      redirect_to root_path
   else
      flash[:error] = "There was a problem submitting your attachment."
      render "new"
     end
   end
  end 
```

附件.rb

```
class Attachment < ActiveRecord::Base

 def uploaded_file=(incoming_file)
   self.filename = incoming_file.original_filename
   self.content_type = incoming_file.content_type
   self.data = incoming_file.read
 end

 def filename=(new_filename)
   write_attributes("filename", sanitize_filename(new_filename))
 end

 private

 def santize_filename(filename)
   just_filename = File.basename(filename)
   just_filename.gsub(/[^\w\.\-]/, '_')
  end
 end 
```

意见/附件/new.html.erb

```
<%= form_tag('create', multipart: true) do %>
  <%= file_field_tag 'attachment' %>
  <%= submit_tag "upload", class: 'btn btn-primary' %>
<% end %> 
```

路线.rb

```
 resources :attachments 
```

耙路线

```
 attachments GET    /attachments(.:format)          attachments#index
                POST   /attachments(.:format)          attachments#create
 new_attachment GET    /attachments/new(.:format)      attachments#new
edit_attachment GET    /attachments/:id/edit(.:format) attachments#edit
     attachment GET    /attachments/:id(.:format)      attachments#show
                PUT    /attachments/:id(.:format)      attachments#update
                DELETE /attachments/:id(.:format)      attachments#destroy
           root        /                               static_pages#home 
```

还有堆栈信息

2012-07-30 22:21:57 +0100 开始为 127.0.0.1 发布 POST "/attachments/create"

```
ActionController::RoutingError (No route matches [POST] "/attachments/create"):
actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.3) lib/rails/engine.rb:479:in `call'
railties (3.2.3) lib/rails/application.rb:220:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
/Users/garyrogers/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
/Users/garyrogers/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
/Users/garyrogers/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

不知道从这里去哪里。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-31T03:40:07.937

而不是这样写：

```
<%= form_tag('create', multipart: true) do %> 
```

尝试：

```
<%= form_tag({:controller => 'attachment', :action => 'create'}, :multipart => true) do %> 
```

你可以从这里找到很多很好的例子：http: [//guides.rubyonrails.org/form_helpers.html](http://guides.rubyonrails.org/form_helpers.html)

此外，您可能想要更改此行：

```
<%= submit_tag "upload", class: 'btn btn-primary' %> 
```

到：

```
<%= submit_tag "upload", :class => 'btn btn-primary' %> 
```

希望能帮助到你

**更新（截至 22/10/2013）：** 最初的答案是我刚开始学习 Rails 时写的（旧版 ruby​​ 1.8.7）。`:class => "btn"`并且`class: "btn"`是相同的，实际上后者在 ruby​​ 1.9 及更高版本中更受青睐。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:33:15.053

你跑了`rake routes`吗？像这样的资源的宁静路线可能只是一个 POST`'/attachments'` 看看[http://guides.rubyonrails.org/routing.html#crud-verbs-and-actions](http://guides.rubyonrails.org/routing.html#crud-verbs-and-actions)

# javascript - 自动刷新 dgrid 内容

> ID：11730215
> 
> 赞同：3
> 
> 时间：2012-07-30T21:52:24.047
> 
> 标签：javascript, dojo, dgrid

我正在使用 dgrid`OnDemandGrid`显示来自 Dojo`JsonRest`商店的数据。这很好用，但我希望网格自动显示更改的数据。实施基于推送的方法，服务器告诉所有客户端哪些数据已更改，因此我正在寻找基于客户端的解决方案。使用 dgrid`refresh()`没有用，因为这会导致闪烁并重置整个网格。

到目前为止，我最好的猜测是定期从第二个存储实例中获取所有数据，将其与实时存储实例进行比较，并使用`Observable`存储包装器通知网格任何更改的数据。

有没有更好、更优雅的解决方案？如果没有，我该如何做到最好？

**编辑：**这种方法的问题是知道网格中当前显示了哪些行。我的应用程序处理大量数据，因此在两个 dojo 商店中同步整个集合并不是一个好主意。有没有办法告诉网格中当前显示了哪些行？理想情况下，网格会定期为当前显示的行重新请求数据。不可能这么难吧？

**编辑2：**到目前为止，我最好的方法是“破解”`Observable`商店，跟踪所有对`observe`. 然后我会定期重新执行观察到的查询并将更改合并到实时存储中。问题是 dgrid 让太多的观察者保持开放状态，使其无法顺利工作。它关闭了其中一些，所以我的代码没有错误，我设置`farOffRemoval`为 500（也尝试过越来越低）。

到目前为止，这是我的代码：[https ://gist.github.com/3225927](https://gist.github.com/3225927)

它还没有完成，但它显示了足够的调试信息来显示问题所在。由于可能没有人愿意设置它并且 jsfiddle 上没有 dgrid，我可以告诉你，在 1000 个条目网格中滚动后，大约有 10-15 个观察者和observerStats.abs（至少观察到的所有行的计数一次）约为750。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T09:04:48.120

您可以使用一些您只需定期刷新（关闭/销毁）的 CacheStore

[http://dojotoolkit.org/reference-guide/1.7/dojo/store/Cache.html](http://dojotoolkit.org/reference-guide/1.7/dojo/store/Cache.html)

所以基本上，你清理 CacheStore，然后重做你的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T10:20:32.563

经过几个小时的思考，我找到了一个更好的解决问题的方法：我创建了一个缓存存储，它最初以*所有*数据库记录为种子（因此，如果您实际上有数百万条记录，这可能无法扩展）。这个缓存存储被包装在一个 Observable 存储中，并通过轮询服务器的更改来更新（使用带有 Redis 后端的普通 HTTP，没有什么像 WebSockets 或 Comet 这样的花哨的东西）。

代码：[https ://gist.github.com/anonymous/5003727](https://gist.github.com/anonymous/5003727)

# c# - C#多线程无重复

> ID：11730236
> 
> 赞同：2
> 
> 时间：2012-07-30T21:53:39.500
> 
> 标签：c#, multithreading, duplicates

这是我的代码：

```
 Thread _th1, _th2, _th3, _th4;
int _i;

    void thMethod()
    {
        while(_i < 100){
            Thread.Sleep((new Random()).Next(1,500));
            Application.DoEvents();
            Console.WriteLine(_i);
            _i++;
        }
    }

    private void button4_Click(object sender, EventArgs e)
    {
        _th1 = new Thread(new ThreadStart(thMethod));
        _th1.Start();
        _th2 = new Thread(new ThreadStart(thMethod));
        _th2.Start();
        _th3 = new Thread(new ThreadStart(thMethod));
        _th3.Start();
        _th4 = new Thread(new ThreadStart(thMethod));
        _th4.Start();
    } 
```

我想要做的是，使用多线程从 0 到 99 执行 Console.WriteLine，并且延迟是随机的。

但是，我的代码打印重复的数字

好吧，这就是结果。

0 1 2 2 4 5 6 7 8 9 10 10 12 13 14 14 16 16 18 19 20 20 22 22 24 24 26 26 28 28 30 31 32 33 34 35 36 36 38 39 40 40 42 42 4 4 4 4 4 64 6 50 52 68 70 70 72 74 74 74 76 76 78 78 80 80 82 82 80 90 98 98 98 100 101 102

如您所见，打印了重复的数字，甚至没有停止在 99。

那么...如何更正此代码以使其正常运行？

====================== 我必须改变吗..

```
 void thMethod()
    {
        while(_i < 100){
            Thread.Sleep((new Random()).Next(1,500));
            Application.DoEvents();
            Interlocked.Increment(ref _i);
            Console.WriteLine(_i);
        }
    } 
```

这？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T22:11:55.080

尽管您应该按照`Interlocked.Increment`其他帖子所述使用。这不是您遇到的确切问题。

您的数字超过 100 的原因是因为您增加值的行出现在睡眠之后。这会导致线程进入循环，但当它们写出值时，该值已经更改为 100 以上。

例如 t1、t2 和 t3 进入循环并等待 500ms，i 为 99。然后 t4 退出并将其递增到 100，现在 t1 将打印 100，t2 将打印 101，t3 将打印 102。

Interlocked.Increment 实际上不会解决问题，因为 Thread.Sleep 在实际写出值时仍会导致不一致。

要解决这个问题，您需要使用[线程锁](http://msdn.microsoft.com/en-us/library/c5kehkcz.aspx) 声明一个要锁定的变量，因为您不能锁定 _i 因为它不是引用类型：

```
object obj = new object();

void thMethod()
{
    while (_i < 100)
    {
        lock (obj)
        {
            Console.WriteLine(_i);
            _i++;
        }
        Thread.Sleep((new Random()).Next(1, 500));
    }
} 
```

这样您就不会得到重复项，并且该值将停止在 99。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T21:56:12.363

您需要以线程安全的方式调用`Interlocked.Increment`增量`i`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T21:58:37.163

在多线程程序中，具有多个写入者的共享资源需要某种同步机制。

发生的情况是多个线程正在访问该变量以进行打印，然后其中一个线程有机会增加它，也就是`race condition`.

要解决这个问题，您需要在关键部分增加变量：

```
 void thMethod()
    {
        while (_i < 100)
        {
            Thread.Sleep((new Random()).Next(1, 500));
            Application.DoEvents();
            lock(this)
            {
                Console.WriteLine(_i);
                _i++;
            }
        }
    } 
```

现在这不会停止在 100，所以另一个修复将是：

```
 while (_i < 100)
        {
            Thread.Sleep((new Random()).Next(1, 500));
            Application.DoEvents();
            lock(this)
            {
                if (_i >= 100) break;
                Console.WriteLine(_i);
                _i++;
            }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T21:59:05.190

变量 _i 必​​须在 thMethod 中声明，而不是在全局级别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-31T16:24:23.347

除了使用未探索的 Monitor 之外，还有两个选项

*   [互锁比较交换](http://msdn.microsoft.com/en-us/library/801kt583.aspx)
*   [并行类](http://msdn.microsoft.com/en-us/library/system.threading.tasks.parallel)

如果您只是使用其中一种 Interlocked 方法递增一个整数类型，则可以提供最佳性能。由于您还使用此变量来表示完成`Interlocked.CompareExchange`是很自然的。该技术用于无锁和无等待解决方案。

```
while (_i < 100)
{
    Thread.Sleep((new Random()).Next(1, 500));
    int initI;
    int modifiedI;
    bool valueUpdated = false;
    do
    {
        initI = _i;
        modifiedI = initI + 1;

        if (modifiedI > 100)
            break;

        valueUpdated =  (initI == Interlocked.CompareExchange(
                ref _i, modifiedI, initI) );

        if (valueUpdated)
            Console.WriteLine(modifiedI);

    } while (!valueUpdated)  ;

} 
```

如果您为了简单起见，还可以使用 Parallel Class

```
Parallel.For(0, 100, i =>
    {
        Thread.Sleep((new Random()).Next(1, 500));
        _i++;
        Console.WriteLine("{0} | {1}" ,Thread.CurrentThread.ManagedThreadId, _i );
    }
); 
```

出于演示目的，我添加了 ManagedThreadId 的输出，以便您可以看到多个线程正在使用中。

您应该注意，您失去了对创建的线程数的直接控制，而是可以通过设置[MaxDegreeOfParallelism](http://msdn.microsoft.com/en-us/library/system.threading.tasks.paralleloptions.maxdegreeofparallelism.aspx)的 ParallelOption 来传递，这确实会影响线程数。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-10-24T18:06:14.210

我用联锁解决了这个问题。这是一个 vb.net 控制台应用程序，但很容易理解。每个线程都有其唯一的计数器，显然输出序列是无序的

* * *

模块模块1

Dim count As Integer = 0

```
Sub Main()
    For i = 1 To 10
        Dim th As New Thread(AddressOf ThreadedIncrement)
        th.Start()
    Next
    Console.ReadLine()
End Sub

Sub ThreadedIncrement()
    Dim r As New Random

    For i = 1 To 10
        Thread.SpinWait(r.Next(1000, 1000000))
        Dim ncount As Integer = Interlocked.Add(count, 1)
        Console.WriteLine(ncount.ToString)
    Next
End Sub 
```

端模块

* * *

# objective-c - iOS Twitter 集成测试

> ID：11730239
> 
> 赞同：2
> 
> 时间：2012-07-30T21:54:05.063
> 
> 标签：objective-c, ios, twitter

在我的 iOS 应用程序中添加 twitter 集成时，是否有合适的方法来测试发送推文？我的意思是，我是否应该仅出于测试目的创建一个虚拟 Twitter 帐户？或者有没有一种方法可以测试 Tweet 的能力，而不会用无用的测试推文填充 twitter。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:07:12.660

没有必要，因为您正在使用应用内推特。当您在模拟器中运行它时，它会显示一个错误弹出窗口，但在 iphone 中它会询问帐户，这意味着它正在工作。

如果您使用照片共享、位置共享等功能，唯一的问题是。但实际上您只需要检查代码。我建议此页面使用代码：http: [//mobile.tutsplus.com/tutorials/iphone/ios-5-and-the-twitter-framework-first-steps/](http://mobile.tutsplus.com/tutorials/iphone/ios-5-and-the-twitter-framework-first-steps/)

还有另一个更高级的 twitter 教程。希望能帮助到你..

# maven - 第谷没有 p2

> ID：11730244
> 
> 赞同：2
> 
> 时间：2012-07-30T21:54:35.483
> 
> 标签：maven, tycho

是否可以在不使用 p2 下载依赖项或发布生成的工件的情况下使用 Tycho？

我已经有一个包含所有依赖项的 Maven 存储库，我不想为了编译这些 osgi 项目而拥有一个带有重复工件的 p2 存储库。我还想在同一个 maven 存储库中发布生成的工件，以便我可以拥有一个真正的集中式存储库，而不是 maven 存储库和 p2 存储库

所以基本上，我想从我的构建中删除对 p2 的需求。

我知道一个选择是使用 POM-first 工具而不是 tycho，但问题是项目已经使用 PDE 开发，所以这似乎不是一个选项

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T12:08:35.160

Tycho 可以很容易地在 Maven 存储库中使用 OSGi 包：只需在 pom.xml 中通过其 GAV 指定对包的依赖项并设置`pomDependencies=consider`选项（请参阅此[文档](http://wiki.eclipse.org/Tycho/Target_Platform#POM_Dependencies)）。Tycho 然后将这些工件用于所有构建步骤：依赖解析、编译、RCP 组装等。

棘手的部分`pomDependency=consider`是传递依赖：对于 Tycho 构建的任何工件，它要求工件的所有传递依赖都可以针对目标平台解决。使用`pomDependency=consider`，Tycho 将 GAV 工件及其所有可传递的 Maven 依赖项添加到目标平台，但前提是工件是 OSGi 包（因此“考虑”）。如果 Maven 依赖项之一不是 OSGi 包，则该库将不在目标平台中，因此 Tycho 的依赖项解析（在 OSGi 空间中）可能会失败。

您问题的第二部分是关于通过 Maven 存储库分发 Tycho 工件。可以将 Tycho 工件部署到 Maven 存储库，但这些工件在 Maven 世界中并不是特别有用。这是因为 Tycho 的工件通常在其 POM 中没有依赖关系。因此，要使用来自 Maven 构建的 Tycho 工件（或类似地通过`pomDependency=consider`），您需要在使用项目的 POM 时手动列出 Tycho 工件的所有依赖项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T10:35:27.497

可以[告诉 Tycho 使用 POM 依赖项](http://wiki.eclipse.org/Tycho/Target_Platform#.22POM_dependencies_consider.22)。据我所知，唯一的“陷阱”是，如果您希望使用 eclipse-repository 打包类型构建 RCP 应用程序，这些仍然需要位于 p2 存储库中。

# c# - 基于数据库中的值重定向 - ASP.NET MVC

> ID：11730249
> 
> 赞同：0
> 
> 时间：2012-07-30T21:54:52.480
> 
> 标签：c#, asp.net-mvc, redirect, sql-server-ce

我的网站将只有 1 个注册用户，她会告诉访问者她的男朋友在哪里。如果他在城里，我想将访客重定向`InTown`到`HomeController`. 相应的视图将具有绿色背景，并且缺少让您知道他在哪里的按钮等。

所以这个用户可以登录并编辑我唯一的数据库条目——这些东西已经在工作了。但是我无法`HomeController`从数据库中读取并检查`InTown`ID 为“1”的项目的值（真或假）。请你帮助我好吗？

我在这里并没有太多要展示的东西，我只有两个模型中的类可以让我与 SqlServerCE 交互（我正在使用实体框架），以及最基本的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:19:31.677

如果您使用的是实体框架，您不能只使用 where 子句，例如：`db.Caglas.Where(c => c.ID == 1).SingleOrDefault();`

这只是一个简单的 LINQ 语句

# html - 贝宝 html 表单不起作用

> ID：11730252
> 
> 赞同：0
> 
> 时间：2012-07-30T21:54:59.947
> 
> 标签：html, forms, paypal

我尝试为网上商店创建一个自动填写的贝宝表格：

```
<form action="https://www.paypal.com/cgi-bin/webscr" class="input-form" method="post" enctype="application/x-www-form-urlencoded; charset=utf-8">
    <input type="hidden" value="utf-8" name="charset">
    <input type="hidden" value="_s-xclick" name="cmd">
    <input type="hidden" value="{somehash}" name="hosted_button_id">
    <input type="hidden" value="17" name="item_number">
    <input type="hidden" value="kosár és szállítás" name="item_name">
    <input type="hidden" value="9990" name="amount">
    <input type="hidden" value="HUF" name="currency_code">
    <input type="hidden" value="1" name="upload">
    <input type="hidden" value="1" name="no_shipping">
    <input type="hidden" value="http://www.mydomain.loc/" name="return">
    <input type="image" border="0" alt="PayPal - The safer, easier way to pay online!" name="submit" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynowCC_LG.gif" class="button submit-button image-button">
    <img width="1" height="1" border="0" alt="" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif">
</form> 
```

{somehash} 给了我贝宝帐户所有者（我从来没有帐户）。我的问题，提交后我得到这样的东西： [screenshot](http://i.stack.imgur.com/LlVbx.jpg) 它只包含项目名称......

```
<div id="miniCartContent" class="body clearfix" style="height: 1083px;">
    <div class="" id="miniCart">
    <h3>Your order summary</h3>
    <div class="small head wrap">
        Descriptions
        <span class="amount">Amount</span>
    </div>
    <ol class="small wrap items ">
        <li class="seller1">
            <ul>
            <li class="itmdet" id="multiitem1">
                <ul class="item1">
                    <li class="dark">
                        <span class="name">
                            <a id="showname0" title="" href="#name0" class="autoTooltip">
                                kosár és szállítás
                                <span class="accessAid">kosár és szállítás</span>
                            </a>
                        </span>
                        <span class="secondary noamt amount">0</span>
                    </li>
                    <li class="secondary qty">
                        <p class="group">
                            <label for="item_price"><span class="labelText">Item price: </span></label>
                            <span class="field">
                                <input type="text" value="" name="amount" id="item_price" size="6" maxlength="15">
                            </span>
                        </p>
                    </li>
                    <li class="secondary">
                        Quantity: 1
                    </li>
                    <li>
                        <div class="action">
                            <span class="buttonAsLink">
                                <input type="submit" onclick="PAYPAL.Checkout.Slider.showPanelMsg('cartMsg')" class="action updateSubmit" name="update.x" id="updateTotals0" value="Update">
                            </span>
                        </div>
                    </li>
                </ul>
                <ul></ul>
            </li>
        </ul>
    </li>
</ol>
<div class="wrap items totals item1">
    <ul>
        <li class="small heavy">
            Item total <span class="amount">0</span>
        </li>
    </ul>
</div> 
```

我不知道该怎么做，我阅读了十几个教程，但没有成功：S 知道吗？

**编辑：**

从开发服务器、localhost 进行测试（但我认为这不算数）...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T10:55:17.803

改为 And 而不是`<input type="hidden" value="_s-xclick" name="cmd">`,使用`<input type="hidden" value="_xclick" name="cmd">``<input type="hidden" value="{somehash}" name="hosted_button_id">``<input type="hidden" value="{somehash}" name="business">`

`_s-xclick`用于安全和/或所谓的“托管”按钮，其中按钮的详细信息存储在某人的 PayPal 帐户中。
要使用 PayPal 网站支付标准（您正在使用的产品）指定资金收款人，您需要使用该`business`参数。

# maps - 使用 fitBounds 在一张谷歌地图中将多个标记居中，但是当只有一个标记时，放大太多且无法更改

> ID：11730255
> 
> 赞同：0
> 
> 时间：2012-07-30T21:55:15.280
> 
> 标签：maps, zooming, center, markers, bounds

我需要显示带有许多标记的地图，并且我想相应地自动调整地图的大小。

因为我已经在这个站点中找到了解决方案，所以我添加了这些行

> bounds.extend(myLatlng); map.fitBounds(边界);

这里是完整的代码

```
<script type="text/javascript">

    var map;
    var coords = new Object();
    var markersArray = [];
    coords.lat = -15.788;
    coords.lng = -47.900;
    var bounds = new google.maps.LatLngBounds();

    function plotPoint(srcLat,srcLon,color,num,idCat,cep,message)
    {
        var pinColor = color;
        var pinImage = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|" + pinColor,
            new google.maps.Size(21, 34),
            new google.maps.Point(0,0),
            new google.maps.Point(10, 34));
        var pinShadow = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_shadow",
            new google.maps.Size(40, 37),
            new google.maps.Point(0, 0),
            new google.maps.Point(12, 35));

            var myLatlng = new google.maps.LatLng(srcLat, srcLon);            
            var marker = new google.maps.Marker({
                  position: myLatlng, 
                  map: map, 
                  icon: pinImage,
                  shadow: pinShadow
              });
            boxText = document.createElement("div");
            var myOptions = {               
                content: boxText,
                disableAutoPan: false,
                maxWidth: 0,
                pixelOffset: new google.maps.Size(-70, -7),
                zIndex: null,
                boxStyle: {
                    opacity: 0.85,
                    width: "140px"
                },

                closeBoxURL: "",
                infoBoxClearance: new google.maps.Size(1, 1),
                isHidden: false,
                pane: "floatPane",
                enableEventPropagation: false
            };
            boxText.style.cssText = "border: 1px solid black; margin-top: 8px; background:#333; color:#FFF; font-family:Arial; font-size:12px; padding: 5px; border-radius:6px; -webkit-border-radius:6px; -moz-border-radius:6px;text-align: center;";
            boxText.innerHTML = message;

            var ib = new InfoBox(myOptions);
              google.maps.event.addListener(marker, 'mouseover', function() {
                ib.open(map,marker);
                ib.show();
              });
              google.maps.event.addListener(marker, 'mouseout', function() {
                ib.hide();
              });

             google.maps.event.addListener(marker, 'click', function() {
                window.location = "browse.php?id="+idCat+"&cep="+cep;});

            bounds.extend(myLatlng);
            map.fitBounds(bounds);
                    map.setZoom(12);

    }
    function initialize() 
    {      

        var latlng = new google.maps.LatLng(coords.lat, coords.lng);
        var myOptions = {
          zoom: 12,
          center: latlng,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById("map_div"),  myOptions);     

    }   

</script> 
```

当有多个标记时，此代码可以完美运行，但是当只有一个时，放大设置为最大值。我尝试使用**setzoom**方法，但它似乎没有做任何事情。

有人可以告诉我我做错了什么吗？

提前非常感谢。何塞

[更新：在使用 fitBounds() 和 Google Maps API V3 后](https://stackoverflow.com/questions/4523023/using-setzoom-after-using-fitbounds-with-google-maps-api-v3)按照此处的说明解决 使用 setZoom()

我添加的代码

```
zoomChangeBoundsListener = 
            google.maps.event.addListenerOnce(map, 'bounds_changed', function(event) {
                if (num_markers = 1){
                    this.setZoom(12);
                }
            });
        setTimeout(function(){google.maps.event.removeListener(zoomChangeBoundsListener)}, 2000); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T13:13:46.353

执行 fitbounds 函数后尝试缩小：

```
bounds.extend(myLatlng); 
map.fitBounds(bounds);
map.setZoom(map.getZoom() - 2) //or - 1, or a fixed number, depending on how close or far out you want it zoomed in 
```

# c# - 排序的集合

> ID：11730262
> 
> 赞同：0
> 
> 时间：2012-07-30T21:55:33.600
> 
> 标签：c#, collections

我试图了解诸如 SortedList 和 SortedDictionary 之类的 C# 排序集合。我有两个主要的精神障碍，我找不到任何地方可以清楚地解释它们。我知道这些集合有一种默认的方式来保持自己的排序，您也可以指定这一点。

我想我的问题很简单；这是怎么做到的？我找不到任何简单的例子来说明如何写这些东西。

例如，我想要一个集合来存储从 float 到 int 的键值对，我希望能够通过查询集合的最低浮点值来获取 int。换句话说，我想获得具有最低关联浮点键的 int 。我是否认为集合已排序这一事实使得做这种事情更有效率？这是否也意味着我可以抓取集合中的第一个元素，例如：collection[0]？它会是最低的吗？（如果我这样排序的话）

对不起，这个问题不是更简洁，我只是不知道从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:06:12.707

SortedDictionary 没有给你一个整数索引器，也没有一个“获取最小键”功能；SortedList 可以。但是，如果您乱序插入数据，SortedList 的效率就会非常低。您应该先订购它，然后再构建列表。

如果 SortedDictionary 中缺少的唯一功能是“获取最小键”，那么您可以使用`First`or `FirstOrDefault`linq 方法，因为枚举器按键顺序返回键值对。如果您需要其他类似的功能（例如“获取最大键”），并且还需要更有效地插入和删除随机分布的值，您可能应该自己实现公开这些功能的二叉树（SortedDictionary 是） .

要实现`IComparer<T>`，请创建一个新类：

```
public class FloatComparer : IComparer<float>
{
    public int Compare(float a, float b)
    {
        //your logic goes here; return -1 if a should be considered smaller or 1 if b should be considered smaller
    }
} 
```

然后以通常的方式将其传递给排序集合的构造函数：

```
var collection = new SortedDictionary<float>(new IComparer<float>()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:05:48.813

[SortedDictionary](http://msdn.microsoft.com/en-us/library/f7fta44c)是一棵平衡树，而SortedList[只是](http://msdn.microsoft.com/en-us/library/ms132319)一块连续的内存块，恰好包含有序元素。在这两种情况下，我们都需要定义“小于”的含义，以便树可以组织其节点并且排序列表可以对其元素进行排序：

*   如果您将一个实现[IComparer](http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx)的对象传递给这些容器的构造函数，那么就可以使用它。只要它是严格的弱排序，它就可以正常工作。例如，通过提供“大于”比较器很容易对容器进行反向排序。
*   否则，将使用[默认比较器](http://msdn.microsoft.com/en-us/library/azhsac5f.aspx)。

在您的情况下（`float`关键在哪里），默认比较器将做正确的事情并将元素从最低值到最高值排序。获取第一个元素将是有效的，并且第一个元素也恰好是最低值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T21:57:29.117

阅读树和堆等数据结构。从红黑树开始。我想这就是经典的例子。谷歌和维基百科有帮助。

基本上，您插入的内容具有某种定义，可以将其比较为更大、等于、小于。在插入时，对元素进行比较和排序。因此，当您搜索第一个或最后一个时，您会知道它们是最小的还是最大的。例如，您还可以有效地检查结构中是否存在等于 4 的整数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-27T06:15:43.730

这很简单。

假设您有一个名为 series 的排序字典，它将一个双精度数组与一个日期相关联。

public SortedDictionary series = new SortedDictionary();

你已经用数据加载了它。

您可以按如下方式获取第一项（按排序顺序排列的第一项）：

```
 var firstItem = series.First();

  firstItem.Key is the first date.

  firstItem.Value is the array of doubles associated with the first date 
```

快乐编程！

# javascript - JavaScript 随机函数会返回 0 还是 1？

> ID：11730263
> 
> 赞同：10
> 
> 时间：2012-07-30T21:55:49.270
> 
> 标签：javascript

JavaScript 可以`Math.random()`准确地返回 0 或 1 吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-30T21:57:26.497

来自 ECMAScript 规范：

> 返回一个带正号的数值，大于或等于 0 但小于 1，随机或伪随机选择，在该范围内近似均匀分布，使用依赖于实现的算法或策略。此函数不接受任何参数。

资料来源：[http ://ecma-international.org/ecma-262/5.1/#sec-15.8.2.14](http://ecma-international.org/ecma-262/5.1/#sec-15.8.2.14)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-30T21:58:52.987

是和否，按此顺序。

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/random](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/random)

> 返回范围内的浮点伪随机数，`[0, 1)`即从 0（包括）到但不包括 1（不包括），然后您可以将其缩放到所需的范围。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-30T21:59:13.447

它不会返回 1

> 返回 [0, 1) 范围内的浮点伪随机数，即从 0（包括）到但不包括 1（不包括），然后您可以将其缩放到所需的范围。

请参阅：[https ://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/random](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/random)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-30T21:58:19.480

对 0 是，对 1 不是。

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/random](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/random)

> 返回 [0, 1) 范围内的浮点伪随机数，即从 0（包括）到但不包括 1（不包括），然后您可以将其缩放到所需的范围。

# c - valgrind理解堆汇总中分配的字节数增加？

> ID：11730265
> 
> 赞同：3
> 
> 时间：2012-07-30T21:55:54.143
> 
> 标签：c, valgrind

我一直在研究调试分叉 TCP 服务器中的内存使用情况。我认为我做得很好，我似乎无法在“堆摘要”中找到有关“分配的字节数”的信息。我的服务器运行时间越长，这个数字似乎就在不断增加：

```
==27526== 
==27526== HEAP SUMMARY:
==27526==     in use at exit: 0 bytes in 0 blocks
==27526==   total heap usage: 113 allocs, 113 frees, 283,043 bytes allocated
==27526== 
==27526== All heap blocks were freed -- no leaks are possible
==27526== 
==27526== For counts of detected and suppressed errors, rerun with: -v
==27526== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2)
==27528== 
==27528== HEAP SUMMARY:
==27528==     in use at exit: 0 bytes in 0 blocks
==27528==   total heap usage: 120 allocs, 120 frees, 300,808 bytes allocated
==27528== 
==27528== All heap blocks were freed -- no leaks are possible
==27528== 
==27528== For counts of detected and suppressed errors, rerun with: -v
==27528== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2)
==27537== 
==27537== HEAP SUMMARY:
==27537==     in use at exit: 0 bytes in 0 blocks
==27537==   total heap usage: 127 allocs, 127 frees, 318,573 bytes allocated
==27537== 
==27537== All heap blocks were freed -- no leaks are possible
==27537== 
==27537== For counts of detected and suppressed errors, rerun with: -v
==27537== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2) 
```

尽管 Valgrind 报告 allocs 和 free 是相等的，并且不可能发生泄漏，但我不相信分配的字节会增加。

所以：如果分配的字节数不断增加，这是否意味着即使 Valgrind 报告不可能发生泄漏，我也必须从堆中的某个地方解除分配？

谢谢！

编辑：随着 Gordon Bailey 的回答和其他提示，我仍然有点厌倦。写了这个小应用程序：

```
/* client.c */
#include <stdio.h>

void child_func(int childnum);

int main(int argc, char *argv[])
{
int nchildren = 1;
int pid;
int x;
if (argc > 1)
{
    nchildren = atoi(argv[1]);
}

for (x = 0; x < nchildren; x++)
{
    if ((pid = fork()) == 0)
    {
        child_func(x + 1);
        exit(0);
    }
}
wait(NULL);
return 0;
}

void child_func(int childnum)
{

int i;
for (i = 0; i < 1000; i++) {
            free(malloc(1));
    }
    sleep(1);
} 
```

当我运行这个 Valgrind 输出是：

```
==28245== HEAP SUMMARY:
==28245==     in use at exit: 0 bytes in 0 blocks
==28245==   total heap usage: 1,000 allocs, 1,000 frees, 1,000 bytes allocated
==28245== 
==28245== All heap blocks were freed -- no leaks are possible
==28245== 
==28245== For counts of detected and suppressed errors, rerun with: -v
==28245== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2)
==28246== HEAP SUMMARY:
==28246==     in use at exit: 0 bytes in 0 blocks
==28246==   total heap usage: 1,000 allocs, 1,000 frees, 1,000 bytes allocated
==28246== 
==28246== All heap blocks were freed -- no leaks are possible 
```

所以看起来堆上的所有内存都被清除了，并且与我的应用程序的输出肯定不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T22:07:07.360

Valgrind`bytes allocated`是您在进程运行时分配的总字节数。

如果你编译并运行这个奇怪的小测试程序：

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
   int i;

   for(i = 0; i < 1000; ++i){
      free(malloc(1));
   }

   return 0;
} 
```

Valgrind 的输出是：

```
==2651== Memcheck, a memory error detector
==2651== Copyright (C) 2002-2010, and GNU GPL'd, by Julian Seward et al.
==2651== Using Valgrind-3.6.0.SVN-Debian and LibVEX; rerun with -h for copyright info
==2651== Command: ./test_prog
==2651==
==2651==
==2651== HEAP SUMMARY:
==2651==     in use at exit: 0 bytes in 0 blocks
==2651==   total heap usage: 1,000 allocs, 1,000 frees, 1,000 bytes allocated
==2651==
==2651== All heap blocks were freed -- no leaks are possible
==2651==
==2651== For counts of detected and suppressed errors, rerun with: -v
==2651== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 13 from 8) 
```

现在看来真正的问题是子进程如何影响这一点。

（编辑以确认我的想法）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:28:44.270

我认为问题在于，当我运行应用程序时，释放和分配的数量会增加每个循环。这导致分配的字节数变得更大，因为每次分配实际分配更多内存，因为有更多实际分配。

不知道为什么会这样，但它一定是我的错误代码，应该是另一个问题。

谢谢您的帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T22:04:32.547

它只是所有 malloc（和类似）调用的大小总和。如果你已经释放了它，valgrind 说你有，那就没问题了。即你的进程 27526 做了 113 次分配，总共 283,043 个字节，

如果您的服务器继续分配内存，该数字会上升，调用 free() 不会减少该数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T23:16:17.450

正如 Godron 所说，valgrind 输出当前进程中的所有内存分配：

```
toc@UnixServer:~$ valgrind --leak-check=full ./pb_valgrind
==11411== Memcheck, a memory error detector
==11411== Copyright (C) 2002-2010, and GNU GPL'd, by Julian Seward et al.
==11411== Using Valgrind-3.6.1-Debian and LibVEX; rerun with -h for copyright info
==11411== Command: ./pb_valgrind
==11411== 
==11414== 
==11414== HEAP SUMMARY:
==11414==     in use at exit: 0 bytes in 0 blocks
==11414==   total heap usage: 1,000 allocs, 1,000 frees, 1,000 bytes allocated
==11414== 
==11414== All heap blocks were freed -- no leaks are possible
==11414== 
==11414== For counts of detected and suppressed errors, rerun with: -v
==11414== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 11 from 6)
==11411== 
==11411== HEAP SUMMARY:
==11411==     in use at exit: 0 bytes in 0 blocks
==11411==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated
==11411== 
==11411== All heap blocks were freed -- no leaks are possible
==11411== 
==11411== For counts of detected and suppressed errors, rerun with: -v
==11411== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 11 from 6) 
```

在您的程序中，您执行 1000 个大小为 1 字节的 malloc，然后执行 1000 个空闲，这解释了输出。

问候。

# php - 在页面导航上保持 div 打开

> ID：11730268
> 
> 赞同：-5
> 
> 时间：2012-07-30T21:56:10.530
> 
> 标签：php, javascript, ajax, jquery

我下载了一个类似 facebook 的聊天应用程序，我对其进行了编辑以适合我的网站，但是在导航其他页面时保持聊天会话打开时遇到问题.. 感谢所有最初尝试提供帮助的人，一些建议的 AJAX 请求..我用这段代码试了一下

```
<script type="text/javascript">
function loadXMLDoc()
{
  var xmlhttp;
    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
       xmlhttp=new XMLHttpRequest();
    }
    else
    {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
       {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
          {
             document.getElementById("site-body-content").innerHTML=xmlhttp.responseText;
          }
       }
      xmlhttp.open("GET","index.php",true);
  xmlhttp.send(); 
```

}

每次创建链接时，我都必须重新编写此函数，更改 xmlhttp.open("GET", "pagename", true) 中的名称和页面；我现在要做的是节省为创建的每个页面重新编写函数的压力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:00:10.920

没有“div 窗口”之类的东西。

Facebook 通过更新栏中的 url 来做到这一点，但通过 AJAX 请求请求新的页面信息，有效地避免了被认为是正常导航的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:04:14.597

假设您对 JavaScript 是什么以及它与 php 之间的区别有基本的了解，尤其是因为您创建了诸如聊天之类的东西。我不得不提醒您 JavaScript 是一种客户端脚本语言。所以它在页面加载后渲染，操作 DOM 元素，并且你拥有页面的任何东西都完成了渲染。因此，您可能需要创建一些依赖 Cookie 的逻辑？或使用 AJAX 将基于 PHP 的会话设置为每个容器 ID，以便在页面加载时重新打开或在页面加载时保持最小化，在页面加载时加载每个元素的关联数据等等。

然而，帮助你几乎是不可能的，因为实际上有数百种方法可以处理这种类型的事情。没有您在 Stack 上为我们所有人提供代码以帮助您更好地评估您的问题，我们无法提供太多帮助。

一开始的聊天脚本很难理清，我在堆栈上的经验是，如果问题听起来像是为我做的，而不是看看我有什么，我该如何解决这个问题，大多数人并不热衷于提供帮助，或改进这一点，或做得更好。

# android - AWD 键盘的设置

> ID：11730270
> 
> 赞同：2
> 
> 时间：2012-07-30T21:56:18.140
> 
> 标签：android, keyboard

![在此处输入图像描述](../Images/2e1c088e4b939ad6c39aae78809ecd8f.png)当我在我的计算机上为美式英语设置的 AWD 管理器（我使用 233 和 api 10）中创建一个模拟器时，它默认为日文 IME 键盘（我认为这是个糟糕的选择）。因此，当我尝试运行一个简单的文本字段应用程序时，例如...

我得到了外国键盘。如何将其更改为美国英语？如果我去模拟器中的设置并选择美国英语它没有效果。它只是保持日语输入法。谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:33:25.070

长按一个文本输入字段（例如 Google 搜索中的那个），直到出现一个弹出菜单。

在那里，按“输入法”并选择您要使用的输入法。

# java - 如何使用 ICU4J 库

> ID：11730271
> 
> 赞同：9
> 
> 时间：2012-07-30T21:56:22.810
> 
> 标签：java, unicode, icu

当我在网站上搜索如何`RTL`正确显示文本时，我发现[了这篇](https://stackoverflow.com/questions/10154961/looking-for-a-method-for-flipping-bidi-hebrew-text-so-it-would-be-displayed-co/10481243#10481243)关于[ICU](http://site.icu-project.org/download/49#TOC-ICU4J-Download)库的帖子，实际上我以前没有任何关于如何使用它的经验。而且几乎没有明确的在线资源。

这里的任何人都有使用它的经验吗？或者至少告诉我我必须搜索什么才能得到我想要的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:42:19.430

嗨 Adham 我在 ICU4J 方面几乎没有经验 我正在尝试阅读 LTR 阿拉伯文本并将其转换为 RTL 文本 我将数字从英语更改为阿拉伯数字并将对齐设置为 RTL 这是一个简单的代码，可以完成我希望的工作我的小经验帮助了你这是ICU4J 网站上的[演示](http://icu-project.org/icu4jdemos.html)

```
 PdfReader reader = new PdfReader(INPUTFILE);

        String txt=PdfTextExtractor.getTextFromPage(reader, 1);

        BiDiClass bidiClass = new BiDiClass();

        String arabicNumber = bidiClass.englishToArabicNumber(txt);

        String out=bidiClass.makeLineLogicalOrder(arabicNumber, true);

        System.out.println(out); 
```

这是 BiDiClass

```
import com.ibm.icu.text.Bidi;
 import com.ibm.icu.text.Normalizer;

//Editor : Ibraheem Osama Mohamed

/**
 * This class is an implementation the the ICU4J class. TextNormalize
 * will call this only if the ICU4J library exists in the classpath.
 * @author <a href="mailto:carrier@digital-evidence.org">Brian Carrier</a>
 * @version $Revision: 1.0 $
 */
public class BiDiClass {

    private static final String REPLACE_CHARS = "0123456789.";
    private Bidi bidi;

    private StringBuilder sb = new StringBuilder();

    /**
     * Constructor.
     */
    public BiDiClass()
    {
        bidi = new Bidi();

        /* We do not use bidi.setInverse() because that uses
         * Bidi.REORDER_INVERSE_NUMBERS_AS_L, which caused problems
         * in some test files. For example, a file had a line of:
         * 0 1 / ARABIC
         * and the 0 and 1 were reversed in the end result. 
         * REORDER_INVERSE_LIKE_DIRECT is the inverse Bidi mode
         * that more closely reflects the Unicode spec.
         */
        bidi.setReorderingMode(Bidi.REORDER_INVERSE_LIKE_DIRECT);
    }

   /**
     * Takes a line of text in presentation order and converts it to logical order.
     * @see TextNormalize.makeLineLogicalOrder(String, boolean)    
     * 
     * @param str String to convert
     * @param isRtlDominant RTL (right-to-left) will be the dominant text direction
     * @return The converted string
     */
    public String makeLineLogicalOrder(String str, boolean isRtlDominant)
    {   
        bidi.setPara(str, isRtlDominant?Bidi.RTL:Bidi.LTR, null);

        /* Set the mirror flag so that parentheses and other mirror symbols
         * are properly reversed, when needed.  With this removed, lines
         * such as (CBA) in the PDF file will come out like )ABC( in logical
         * order.
         */
        return bidi.writeReordered(Bidi.DO_MIRRORING);
    }

  //algorithm to change form English number to Arabic number
    public String englishToArabicNumber(String string){

        char[] ch=string.toCharArray();

        for (char c : ch) {
             if (REPLACE_CHARS.contains(String.valueOf(c))) {

                   c = (char) ('\u0660' - '0' + c);

             }
             sb.append(c);
          }

        return sb.toString();
    }

    /**
     * Normalize presentation forms of characters to the separate parts.
     * @see TextNormalize.normalizePres(String)
     *
     * @param str String to normalize
     * @return Normalized form
     */
    public String normalizePres(String str)
    {
        StringBuilder builder = null;
        int p = 0;
        int q = 0;
        int strLength = str.length();
        for (; q < strLength; q++) /* >>>*/
        {
            // We only normalize if the codepoint is in a given range.
            // Otherwise, NFKC converts too many things that would cause
            // confusion. For example, it converts the micro symbol in
            // extended Latin to the value in the Greek script. We normalize
            // the Unicode Alphabetic and Arabic A&B Presentation forms.
            char c = str.charAt(q);
            if ((0xFB00 <= c && c <= 0xFDFF) || (0xFE70 <= c && c <= 0xFEFF))/* >>>*/
            {
                if (builder == null) {
                    builder = new StringBuilder(strLength * 2);
                }
                builder.append(str.substring(p, q));
                // Some fonts map U+FDF2 differently than the Unicode spec.
                // They add an extra U+0627 character to compensate.
                // This removes the extra character for those fonts.
                if(c == 0xFDF2 && q > 0 && (str.charAt(q-1) == 0x0627 ||     str.charAt(q-1) == 0xFE8D))
                {
                    builder.append("\u0644\u0644\u0647");
                }
                else
                {
                    // Trim because some decompositions have an extra space,
                    // such as U+FC5E
                    builder.append(
                            Normalizer.normalize(c, Normalizer.NFKC).trim());
                }
                p = q + 1;
            }
        }
        if (builder == null) {
            return str;
        } else {
            builder.append(str.substring(p, q));
            return builder.toString();
        }
    }

    /**
     * Decomposes Diacritic characters to their combining forms.
     *
     * @param str String to be Normalized
     * @return A Normalized String
     */     
    public String normalizeDiac(String str)
    {
        StringBuilder retStr = new StringBuilder();
        int strLength = str.length();
        for (int i = 0; i < strLength; i++) /* >>>*/
        {
            char c = str.charAt(i);
            if(Character.getType(c) == Character.NON_SPACING_MARK
                    || Character.getType(c) == Character.MODIFIER_SYMBOL
                    || Character.getType(c) == Character.MODIFIER_LETTER)
            {
                /*
                 * Trim because some decompositions have an extra space, such as
                 * U+00B4
                 */
                retStr.append(Normalizer.normalize(c, Normalizer.NFKC).trim());
            }
            else
            {
                retStr.append(str.charAt(i));
            }
        }
        return retStr.toString();
    }

      } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-10T09:51:49.747

Android N 现在提供**[ICU4J Android 框架 API](http://developer.android.com/preview/features/icu4j-framework.html)**

Android N 通过 android.icu 包而不是 com.ibm.icu 公开了 ICU4J API 的子集。Android 框架可能出于各种原因选择不公开 ICU4J API

以下是一些需要注意的重要事项：

1.  ICU4J Android 框架 API 不包括所有 ICU4J API。
2.  NDK 开发者应该知道不支持 Android ICU4C。
3.  Android 框架中的 API 不会取代 Android 对[资源本地化](http://developer.android.com/guide/topics/resources/localization.html)的支持。

# python - Python如何读取复杂的列表？

> ID：11730273
> 
> 赞同：-3
> 
> 时间：2012-07-30T21:56:36.877
> 
> 标签：python, python-2.7

我有一个看起来像这样的 .txt：

```
"uc007ayl.1"  "ENSMUSG00000041439"

"uc009mkn.1"  "ENSMUSG00000031708" 
```

等等

我的代码是：

```
f = open("my dir"/"file name.txt", 'r')
r = f.readlines() 
```

我打印读取它显示如下内容：

```
'uc007ayl.1\tENSMUSG00000041439\ruc009mkn.1\tENSMUSG00000031708\ruc009mkn.1\tENSMUSG00000035491\ruc007aft.1\tENSMUSG00000025907\r etc.' 
```

我使用以下代码检查了列表长度：

```
listlength = len(r) 
```

它返回的长度为 1，而我的文件中应该有 3000 行。问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:05:24.177

我通常使用 python 3，但我想我可以帮助您：查看您的代码及其结果，`readlines`似乎只是返回文件中的所有数据。我会执行以下操作（假设文件内容是 string `fc`）：

```
tlist=fc.split("\n")
dat=[]
for(s in tlist):
    dat.append(s.split("\")) 
```

我会使用列表表达式，但老实说，我不知道它们是否适用于 2.7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:06:42.333

假设您希望每一行都是一个单独的列表项：

```
with open(r"filename.txt", "r") as f:
    mylist = [line for line in f] 
```

假设您希望每个“名称”都是一个单独的列表项：

```
with open(r"filename.txt", "r") as f:
    mylist = [name for name in line.split("\t") for line in f] 
```

**[编辑]**

根据正在打印的内容，也许试试这个？

```
with open(r"filename.txt", "r") as f:
    mylist = f.read().split("\r") 
```

看起来文件中的每一行都由`\r`字符描绘，这有点不寻常。在这种情况下，我会尝试按该字符手动拆分文件并查看是否有效。

# javascript - 以更好的方式从数组生成 html

> ID：11730274
> 
> 赞同：0
> 
> 时间：2012-07-30T21:56:38.877
> 
> 标签：javascript, jquery, html

假设我有一组 Customer 结构，我需要从中生成 HTML。

目前我做这样的事情：

```
jQuery.each(customers, function(index, item) {
     html =+ "<tr custID='" + item.ID + "'><td>" + item.Name + "</td><td>" + item.City + "</td></tr>";  
}); 
```

这里的问题是我手动添加了 custID 属性。我相信最酷的方法是使用 jQuery 的 Data 函数。

但是在这种情况下我将如何使用它呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:08:00.433

优雅的方法不是像文本一样附加这些 html 标签，而是使用创建元素

```
document.createElement("tr"); 
```

您可以修改其属性，然后将其附加到 html 文件中。

在这里阅读更多：

[jQuery document.createElement 等效？](https://stackoverflow.com/questions/268490/jquery-document-createelement-equivalent)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:01:51.107

只需在属性前面加上`data-`：

```
jQuery.each(customers, function(index, item) {
  html += "<tr data-custID='" + item.ID + "'><td>" + item.Name + "</td><td>" + item.City + "</td></tr>";  
}); 
```

现在您可以使用 jQuery 中的方法访问数据。

（我将不存在的`=+`运算符更改为`+=`。猜猜这只是问题中的一个错字。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T22:04:09.020

您可以使用数据网格，我认为它比手动创建表格要酷得多。但在你的情况下，你必须使用 append() 函数。

这是很好的例子：http: [//jquery-howto.blogspot.com/2009/02/add-table-row-using-jquery-and.html](http://jquery-howto.blogspot.com/2009/02/add-table-row-using-jquery-and.html) http://api.jquery.com/append/

# java - java泛型扩展和列表

> ID：11730277
> 
> 赞同：0
> 
> 时间：2012-07-30T21:57:00.190
> 
> 标签：java, generics

我正在尝试在实用程序上正确获取方法签名，以便摆脱一些未经检查的类型转换。到目前为止，我有：

```
public interface Animal {
public long getNumberLegs();
public int getWeight();
}

public class Cat implements Animal {
public long getNumberLegs() { return 4; }
public int getWeight() { return 10; }
}

public class Tuple<X, Y> {
public final X x;
public final Y y;

public Tuple(X x, Y y) {
    this.x = x;
    this.y = y;
}
}

public class AnimalUtils {
public static Tuple<List<? extends Animal>, Long> getAnimalsWithTotalWeightUnder100(List<? extends Animal> beans) {
    int totalWeight = 0;
    List<Animal> resultSet = new ArrayList<Animal>();
    //...returns a sublist of Animals that weight less than 100 and return the weight of all animals together.
        return new Tuple<List<? extends Animal>, Long>(resultSet, totalWeight);     
}
} 
```

现在我尝试拨打电话：

```
Collection animals = // contains a list of cats
Tuple<List<? extends Animal>, Long> result = AnimalUtils.getAnimalsWithTotalWeightUnder100(animals);
Collection<Cat> cats = result.x;  //unchecked cast…how can i get rid of this? 
```

这个想法是我可以通过传入适当的动物列表来重用这个实用方法来检查狗、老鼠等。我尝试对 getAnimalsWithTotalWeightUnder100() 方法的签名进行各种更改，但似乎无法使语法正确，因此我可以传入特定类型的动物并让它返回相同的动物而不会出现类型安全问题。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T21:59:19.527

如果有记忆，您需要使方法本身通用，如下所示：

```
public <T extends Animal> static Tuple<List<T>, Long> getAnimalsWithTotalWeightUnder100(List<T> beans) { 
```

# perl - 如何比较perl中的文件名

> ID：11730284
> 
> 赞同：1
> 
> 时间：2012-07-30T21:57:45.687
> 
> 标签：perl

我有一个表格中的文件名列表`integer_Name.txt`。我想返回具有最高整数值的文件名。除了字符串比较之外，还有什么方法可以在 perl 中完成？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T22:09:18.450

这通常称为*自然排序*。有实现它的模块：[Sort::Naturally](http://search.cpan.org/perldoc?Sort%3a%3aNaturally)

要获得最高价值 - 您可以排序并获取最后一个元素：

```
use strict; use warnings;
use Sort::Naturally;

my @names = (...);
my $name_with_biggest_number = (nsort(@names))[-1]; 
```

**更新 - 手动排序**

使用[map/sort/map 成语](http://en.wikipedia.org/wiki/Schwartzian_transform)。但仅当文件名中有单个数字时才有效：

```
use strict; use warnings;

my @names = (...);
my @sorted_names = 
    map { $_->[0] }
    sort { $b->[1] <=> $a->[1] } ## descending order
    map { [ $_, m/(\d+)/ ] }     ## extracting first number
    @names;
my $name_with_biggest_number = $sorted_names[0]; 
```

**更新 - 没有排序**

根据输入数据，避免使用`sort`. 因此，您可以显式编码搜索最大数量：

```
sub name_with_largest_number {
        my (@names) = @_;

        my $max_number = undef;
        my $name_with_max_number = undef;
        for my $name (@names) {
                my ($number) = ($name =~ m/(\d+)/);
                if (defined $number) {
                        if (! defined $max_number || $number > $max_number) {
                                $max_number = $number;
                                $name_with_max_number = $name;
                        }
                }
        }
        return $name_with_max_number;
}

print name_with_largest_number(...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:21:00.583

**编辑：**这是一个不需要昂贵排序的替代方案。感谢@tchrist 指出这种方法有多愚蠢。

```
use strict; use warnings;
use Data::Dumper;

my @list = qw(
332_Name.txt
999_Name.txt
125_Name.txt
9_Name.txt
0066_Name.txt
);

my %mapping;
my $highest = 0;
foreach(map { m/(\d+)/; $mapping{$1} = $_; $1 } @list) {
  $highest = $_ if $_ > $highest;
}
print $mapping{$highest}; 
```

# regex - sed 用 C++ 注释替换（单行）C 注释

> ID：11730287
> 
> 赞同：5
> 
> 时间：2012-07-30T21:57:54.360
> 
> 标签：regex, sed

如何使用 sed 将源文件中的所有 C 样式注释替换为 C++ 样式。

所有这些：

```
int main() {
  /* some comments */
  ... 
```

到：

```
int main() {
  // some comments
  ... 
```

所有注释都是单行的，并且在这样的代码之间没有任何注释：

```
int f(int x /*x-coordinate*/ ); 
```

所以我尝试了这个：

```
 sed -i 's/ \/\* .*  \*\ / \/\/* /g' src.c 
```

但它使文件保持不变。 [这篇](https://stackoverflow.com/questions/542006/replace-c-style-comments-by-c-style-comments)文章很相似，但我试图理解 sed 的表达式语法。自从 ”。” 匹配任何字符，“*”匹配零个或多个某些模式。我假设“。*”匹配任意数量的任意字符。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-30T22:05:49.930

```
sed -i 's:\(.*\)/[*]\(.*\)[*]/:\1 // \2:' FILE 
```

这将像这样转换每一行：

```
aaa  /* test */ 
```

变成这样的一行：

```
aaa  // test 
```

如果您在同一行上有更多注释，则可以应用这个更复杂的解析器，它将一行转换为：

```
aaa /* c1 */ bbb /* c2 */ ccc 
```

进入

```
aaa  bbb ccc // c1 c2 
```

* * *

```
sed -i ':r s:\(.*\)/[*]\(.*\)[*]/\(.*\):\1\3 //\2:;tr;s://\(.*\)//\(.*\)://\2\1:;tr' FILE 
```

更复杂的情况是当您在一行的字符串中包含注释时，例如 in `call("/*string*/")`。这是一个脚本`c-comments.sed`，用来解决这个问题：

```
s:\(["][^"]*["]\):\n\1\n:g
s:/[*]:\n&:g
s:[*]/:&\n:g
:r
s:["]\([^\n]*\)\n\([^"]*\)":"\1\2":g
tr
:x
s:\(.*\)\n/[*]\([^\n]*\)[*]/\n\(.*\)$:\1\3 // \2:
s:\(.*\)\n\(.*\)//\(.*\)//\(.*\):\1\n\2 //\4\3:
tx
s:\n::g 
```

将此脚本保存到文件 c-comments.sed 中，并像这样调用它：

```
sed -i -f c-comments.sed FILE 
```

# android - android - 以编程方式打开/关闭 ShapeDrawable (RectShape) 的闪烁/翻转动画/效果

> ID：11730304
> 
> 赞同：1
> 
> 时间：2012-07-30T21:59:27.307
> 
> 标签：android, draw, shapedrawable

下面是绘制矩形所需的代码。如果不使用一些 Runnables 让它闪烁，怎么可能呢？有没有办法做到这一点？或者也许我应该放一个闪烁的背景gif？

```
ShapeDrawable ohMyShape = new ShapeDrawable(new RectShape());
ohMyShape.getPaint().setColor(Color.RED);
ohMyShape.getPaint().setStyle(Style.STROKE);
ohMyShape.setBounds(x, y, x+l, y+h);
ohMyShape.draw(canvas); 
```

我的意思是

```
ohMyShape.getPain().setAnimation(Animation.BLINK); 
```

真的会消除痛苦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T01:03:06.693

到目前为止，看起来最简单的方法是使用 2 张图像并将它们绘制在屏幕上。这些图像中的一个应该是闪烁的 gif，另一个是不闪烁的版本。

感谢所有参与此独白的人。

# ios - 应用内购买仍然出现“无法连接到 iTunes”

> ID：11730314
> 
> 赞同：0
> 
> 时间：2012-07-30T22:00:35.473
> 
> 标签：ios, in-app-purchase, sandbox

SKPaymentQueue.h 中的注释似乎表明“用户将被要求进行身份验证”，如果它是一个 restoreCompletedTransactions。它不表示 addPayment 的身份验证。那么，在购买过程中应该在什么时候弹出登录窗口？我在使用“恢复”过程时登录，但在尝试购买时不断收到可怕的“无法连接”错误。没有弹出验证。

当我调用“addPayment”时究竟会发生什么？

当我执行 addPayment 时，我几乎立即在支付队列中收到了无法连接错误的交易。

产品正确，bundleID正确，做过6个测试用户，擦手机，试过不登陆，登陆。

还尝试了其他“无法连接”问题中的所有技巧。

我错过了这个领域的问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T19:21:36.677

我在 iTunes 连接中使用了错误区域的产品 ID。

# javascript - 识别此 JavaScript 脚本是自定义的还是来自 jQuery 库

> ID：11730318
> 
> 赞同：0
> 
> 时间：2012-07-30T22:00:51.243
> 
> 标签：javascript, jquery

我一直在尝试调试一个站点，但无法弄清楚它正在使用的脚本。

该网站是[http://heydays.no/](http://heydays.no/)

我对剧本很感兴趣`top-bar-view.min.js`。我知道该脚本使用 jQuery，但它是来自 jQuery 库还是网站的创建者从头开始创建的？

如果它来自图书馆，我在哪里可以看到一个例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:05:29.347

他们是从零开始的。并进行了轻度混淆（删除空格和其他）以最小化代码长度。

与 jQuery 关联的模板和其他文件应包含文件中的名称。

# objective-c - iOS 应用使用 GData 将视频上传到 youtube 并使用 JSON 框架导致重复错误

> ID：11730319
> 
> 赞同：0
> 
> 时间：2012-07-30T22:01:12.420
> 
> 标签：objective-c, ios, json, video, youtube

我可以使用我的 iPhone 应用程序中的 GData 框架将视频上传到 YouTube。但在我的项目中，我还需要有 JSON 框架。当我集成它们时，应用程序崩溃，错误是：

> /Users/jack/Downloads/1Desktop/backup 07:18 (F1)/libGDataTouchStaticLib.a(SBJSON.o) 和 /Users/jack/Library/Developer/Xcode/DerivedData/PostUno-eijnopqdpkkdasbjknrcikkmxpqh/Build/Intermediates 中的重复符号 _SBJSONErrorDomain /PostUno.build/Debug-iphonesimulator/PostUno.build/Objects-normal/i386/SBJsonBase.o 用于架构 i386
> 
> clang：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）

当我删除`-ObjC`并`-all_load`链接器标记时，错误消失但应用程序无法将视频上传到 youtube。

有没有人成功实施 GData 将视频上传到 YouTube 并在同一个 iphone 应用程序中使用 JSON 框架？谁能给我一些建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:17:16.217

您是否尝试过仅删除 JSON 框架依赖项？看起来 GData 已经为此提供了一个实现。如果目标文件与您使用的标头不匹配，您可能会遇到问题，因此在这种情况下，最好 GData 版本标头是公开的。

如果这对您没有帮助，也许您可​​以自己从源代码编译 GData，确保使用您的应用程序使用的 JSON 库版本？

拥有两个版本的库将不起作用，因为符号名称会发生​​冲突。

# c++ - 开始 DirectX 11 游戏编程错误

> ID：11730323
> 
> 赞同：1
> 
> 时间：2012-07-30T22:01:32.390
> 
> 标签：c++, visual-studio, compiler-errors

这是它在第 33 页给我的代码：

```
#include<Windows.h>

int WINAPI wWinMain(HINSTANCE hInstance, HINSTANCE prevInstance,
       LPWSTR cmdLine, int cmdShow)
{
    UNREFERENCED_PARAMETER( prevInstance );
    UNREFERENCED_PARAMETER( cmdLine );
    WNDCLASSEX wndClass = { 0 };
    wndClass.cbSize = sizeof( WNDCLASSEX ) ;
    wndClass.style = CS_HREDRAW | CS_VREDRAW;
    wndClass.lpfnWndProc = WndProc;
    wndClass.hInstance = hInstance;
    wndClass.hCursor = LoadCursor( NULL, IDC_ARROW );
    wndClass.hbrBackground = ( HBRUSH )( COLOR_WINDOW + 1 );
    wndClass.lpszMenuName = NULL;
    wndClass.lpszClassName = "DX11BookWindowClass";
    if( !RegisterClassEx( &wndClass ) )
    return -1;
    RECT rc = { 0, 0, 640, 480 };
    AdjustWindowRect( &rc, WS_OVERLAPPEDWINDOW, FALSE );
    HWND hwnd = CreateWindowA( "DX11BookWindowClass", "Blank Win32 Window",
    WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, CW_USEDEFAULT, rc.right - rc.
    left,
    rc.bottom - rc.top, NULL, NULL, hInstance, NULL );
    if( !hwnd )
    return -1;
    ShowWindow( hwnd, cmdShow );

    return 0;
} 
```

这段代码给了我2个错误-

> 1>----- 构建开始：项目：BlankWindow，配置：Debug Win32 ------ 1> main.cpp 1>c:\coding\c++\visual c++\directx\blankwindow\blankwindow\main. cpp(10): 错误 C2065: 'WndProc' : 未声明的标识符 1>c:\coding\c++\visual c++\directx\blankwindow\blankwindow\main.cpp(15): 错误 C2440: '=' : 无法从 ' 转换const char [20]' to 'LPCWSTR' 1> 指向的类型不相关；转换需要 reinterpret_cast、C 样式转换或函数样式转换 ========== 构建：0 成功，1 失败，0 最新，0 跳过 ==========

基本上

> “WndProc”：未声明的标识符和“=”：无法从“const char [20]”转换为“LPCWSTR”

这段代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:34:27.107

Here is a basic working program of your code:

```
#include<Windows.h>

LRESULT CALLBACK WndProc(HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    switch (message)
            {
                    case WM_CLOSE:
                            DestroyWindow(hwnd);
                            break;
                    case WM_DESTROY:
                            PostQuitMessage(0);
                            break;
                    default:
                            return DefWindowProc(hwnd,
                                                 message,
                                                 wParam,
                                                 lParam);
            }
    return 0;
}

int WINAPI wWinMain(HINSTANCE hInstance, HINSTANCE prevInstance,
       LPSTR cmdLine, int cmdShow)
{
    UNREFERENCED_PARAMETER( prevInstance );
    UNREFERENCED_PARAMETER( cmdLine );
    WNDCLASSEX wndClass = { 0 };
    wndClass.cbSize = sizeof( WNDCLASSEX ) ;
    wndClass.style = CS_HREDRAW | CS_VREDRAW;
    wndClass.lpfnWndProc = WndProc;
    wndClass.hInstance = hInstance;
    wndClass.hCursor = LoadCursor( NULL, IDC_ARROW );
    wndClass.hbrBackground = ( HBRUSH )( COLOR_WINDOW + 1 );
    wndClass.lpszMenuName = NULL;
    wndClass.lpszClassName = "DX11BookWindowClass";
    if( !RegisterClassEx( &wndClass ) )
    return -1;
    RECT rc = { 0, 0, 640, 480 };
    AdjustWindowRect( &rc, WS_OVERLAPPEDWINDOW, FALSE );
    HWND hwnd = CreateWindowA( L"DX11BookWindowClass", L"Blank Win32 Window",
    WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, CW_USEDEFAULT, rc.right - rc.
    left,
    rc.bottom - rc.top, NULL, NULL, hInstance, NULL );
    if( !hwnd )
    return -1;
    ShowWindow( hwnd, cmdShow );
    MSG msg;
    while (GetMessage (&msg, 0, 0, 0))
            {
                TranslateMessage (&msg);
                DispatchMessage (&msg);
            }
    return msg.wParam;
} 
```

Points:

1.  I added a `WndProc` which handles all messages sent to your program.

2.  I added a [message loop](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644928%28v=vs.85%29.aspx) to your program. Otherwise, the window would close right away.

3.  I added the `L` prefix as suggested by the_mandrill in the other answer.

This is pretty much your "Hello World" of WinAPI programming. However, I strongly suggest you learn the WinAPI first before jumping into DirectX programming.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:18:14.453

问题是该项目正在构建为[Unicode](http://en.wikipedia.org/wiki/Unicode)，但您的代码是非 Unicode。换句话说，Windows API 调用需要宽（即 16 位）字符串，但您的代码使用 8 位字符串（'char'）。 `LPCWSTR`表示*指向常量宽字符串的长指针*。所以函数调用需要一个恒定的宽字符串，但您传递的是一个 8 位字符串。你有两个选择：

*   更改项目以使用非 Unicode 库（属性 -> 常规 -> 字符集 = '使用多字节'）
*   修复您的代码以使其成为 Unicode。在这种情况下，通过更改字符串，它会抱怨将它们变成宽字符串。您可以通过在它们前面加上前缀来做到这一点`L`，例如`L"DX11BookWindowClass"`

# iphone - 以特定方向推送视图控制器

> ID：11730326
> 
> 赞同：1
> 
> 时间：2012-07-30T22:01:44.220
> 
> 标签：iphone, ios, uiviewcontroller, uinavigationcontroller, uideviceorientation

当设备旋转到横向模式时，主`UIViewController`( **A** ) 会显示另一个`UIViewController`( **B )。****因此，在A**上将设备旋转到横向时会以模态方式呈现**B并在****B**上旋转回纵向时会关闭**B**并返回到**A**。

在**B**上，我想将另一个`UIViewController`（**C**）推入**A**的堆栈中。**C** 只能纵向显示。我知道这与 HIG 背道而驰，因为在转换之间应始终保持方向。

所以我希望能够在**B**上执行以下操作：

*   解雇**乙**
*   **将C**推送到**A的堆栈（因此从****C**弹出回到**A**）
*   切换回纵向，以便**C**以纵向显示

* * *

如果您有 Pay With Square 应用程序，您会看到他们通过淡入**C**（旋转应用程序以显示地图并选择注释）解决了这个问题，但他们没有将其添加到当前堆栈，只允许关闭它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:29:27.953

您可以像往常一样推送视图控制器，然后在 viewDidAppear 中使用[该](https://stackoverflow.com/questions/4330979/how-to-set-device-ui-orientation-programmatically)线程中的一些代码来旋转视图。

# javascript - 如何使 div 的高度变化以适应其中包含的其他 div？

> ID：11730333
> 
> 赞同：0
> 
> 时间：2012-07-30T22:02:15.877
> 
> 标签：javascript, css, html

我有一个主要的 div “内容”。其中是另一个 div“项目列表”，其中有几个缩略图大小的 div，我将其用作图像精灵来链接到其他页面。但是，当我添加很多缩略图 div 时，“内容”div 似乎不想让它的高度变大。

这是一个测试页面，供您查看我正在使用的内容：[http ://willryan.us/test/content/design.html](http://willryan.us/test/content/design.html)

如果您将鼠标悬停在前几个缩略图上，您会看到蓝色叠加层（到目前为止只有少数有悬停，它只是一个副本）。我正在尝试通过图像精灵在所有缩略图上获取此信息。所以我用一个 div 包装了每个图像。

但是一旦“内容”div 达到四行缩略图，它就不会变大。如果您转到照片页面，您可以看到内容 div 的行为正确（当其中有更多图像时会变得更高）。

我假设问题在于设计页面上较小的 div，因为我没有将 div 用于照片页面上的缩略图。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:05:12.257

在#content 上设置溢出：自动，这应该可以解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T00:37:52.570

您可以将 div 末尾的段落样式设置为 clear: both; 或者您可以在 div 的末尾添加一个，并在您的样式表中设置 .clear{ clear: both;}

[http://jsfiddle.net/rsoneill21/4YuhU/1/](http://jsfiddle.net/rsoneill21/4YuhU/1/)

# php - .htaccess 是否允许使用自主机？

> ID：11730334
> 
> 赞同：1
> 
> 时间：2012-07-30T22:02:24.300
> 
> 标签：php, .htaccess

当有人访问 example.pdf 时，他们会被重定向到 viewer.php。viewer.php 应该能够访问 pdf 文件。但是，.htaccess 文件会导致 viewer.php 文件由于重定向而无法访问 pdf 并陷入循环。

有没有办法将以下逻辑添加到.htaccess：

if(host = myserver)
     不重定向 pdf
否则
     将 pdf 重定向到 viewer.php

谢谢

这是我的 htacces 文件。

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^(.+)\.pdf$  web/viewer.php?pdf=$1 [L,NC,QSA]
AddType application/octet-stream .pdf 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:10:03.520

编辑：我查看了库源，并不是您的服务器向 PDF 发出请求，不幸的是，javascript 将成为客户端请求，因此这不会像我想的那么容易希望！（即您不能只检查 127.0.0.1，因为它将是用户的 IP 地址）。

我不确定它会如何正常工作，但一种选择可能是更新所有 PDF 文件，在文件扩展名中添加一个额外的字符（所以不是 .pdf，而是 .pdfs 或类似的）。然后您可以更新您的 RewriteRule 在 $1 之后添加一个“s”，如下所示：

```
RewriteRule ^(.+)\.pdf$  web/viewer.php?pdf=$1s [L,NC,QSA] 
```

这是假设 pdf.js 脚本能够呈现没有扩展名 .pdf 的文件。

* * *

尝试这样的事情：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -f
RewriteCond %{REMOTE_ADDR} !^127.0.0.1$
RewriteRule ^(.+)\.pdf$  web/viewer.php?pdf=$1 [L,NC,QSA]
AddType application/octet-stream .pdf 
```

# algorithm - 返回第 k 个最大元素 [ 优于 O(n) ]

> ID：11730336
> 
> 赞同：1
> 
> 时间：2012-07-30T22:02:37.500
> 
> 标签：algorithm, language-agnostic

我有一个流（我不知道它的长度，理论上可能是无穷大）。

我一一阅读流的元素。

每次从流中读取一个元素时，我都希望能够返回`k`迄今为止读取的最大元素。

（理想情况下，对我来说，这将是 python 和/或 lisp/scheme 中的代码）。

K 在开始时读取，K 可以是 NUMBER（第 3、4 个），也可以是 PROCENT（到目前为止读取的元素总数的 K %）。如果K=1/2，表示每次都提取中值元素……比如读取第N个元素后，必须返回第N/2个最大元素

示例 K=1/2：

```
3 -> 3
3,4 -> 3
3,4,2 -> 3
3,4,2,1 -> 2
etc. 
```

我认为这个例子足以澄清这个问题。我需要尽可能少的时间来提取第 K 个元素。（这假设在 O(1) 中读取流，然后插入读取的值，然后提取第 K 个元素）。

我想要任何比 O(n) 更好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:20:18.120

我会使用一个包含第 k 个最大元素的堆（或者在百分比的情况下使用包含所有元素的二叉搜索树）。这给了你 O(Log(k)) （或 O(Log(n)) 在百分比的情况下）。

第k个案例：

*   如果新元素小于堆的最小值，则第 k 个最大的是堆的最小值。
*   否则用新元素替换堆的最小值并堆化，第k个最大的是堆的新最小值。

案例百分比：在二叉搜索树中插入新元素，在这样的树中，很容易找到第k个元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T02:14:11.717

因此，由于您需要第 k 个元素并且在运行算法之前已知 k，因此首先观察您需要存储最多 k 个元素，k 个最小元素。当您阅读新元素时，您需要在某些数据结构中插入元素，以保持其属性并有机会快速检索答案。1）您可以使用最多具有 k 个元素的最大堆。将元素插入到堆中（log（k）），然后如果您有超过 k 个元素（准确地说是 k+1），您需要 extract_max O(log(k)) 来提取和重建，答案将在堆顶访问 O(1)。因此，每次需要 log(k) 来获得第 k 个元素，所有元素的总数 - n * log(k)。

2）如果使用百分比，元素的位置将根据处理的元素数量动态计算，这里您可以使用订单统计树，[http](http://en.wikipedia.org/wiki/Order_statistic_tree) ://en.wikipedia.org/wiki/Order_statistic_tree具有相同的日志（数量元素）插入和日志（元素数量）查找。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T22:07:45.913

如果您保留到目前为止看到的*k个最大元素的排序列表，则始终可以返回列表中的最小元素。*插入列表是*O(k)*并且得到最小的是*O(1)*。由于列表的大小不取决于*n ，因此它在**n*方面是恒定的。

编辑 2：正如我在下面的评论中所说，我认为跳过列表可能是该列表的最佳选择。如果我没记错的话，它的插入时间为*O(log k)*，删除最小元素的时间为*O(1) ，空间为 O* *(k log k)*（相对于链表的*O(k) ）。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T23:40:55.787

堆是体面的。O(1) 查找最小值，O(logn) 删除。

对于这类问题，平均而言，Treap 非常快（很好的常数）。它们允许在 O(logn) 时间内访问（或删除）最小或最大值。 [http://stromberg.dnsalias.org/~strombrg/treap/](http://stromberg.dnsalias.org/~strombrg/treap/) 那里有一个“巢”模块（最好），就是为了这种事情。

红黑树的速度并不快，但它们的性能成本分布相当平稳，因此您不会像使用 treap 那样获得快-快-快-慢-快-快-快-慢。相反，它更像是中等-中等-中等-中等。

在这里尝试“手指树”可能会很有趣。据称，手指树给出了 O(1) 查找树中最小和最大值的方法。我不确定删除。

# javascript - IE 9 在初始加载时忽略 keydown 事件

> ID：11730337
> 
> 赞同：0
> 
> 时间：2012-07-30T22:02:49.223
> 
> 标签：javascript

我看到一种奇怪的行为，希望有人可以解释这一点。

我有 keypress 事件捕获屏幕上按下的任何键。如果点击“P”，则展开一个在输入字段上执行 focus() 和 select() 的部分。

该字段有一个只允许数字字符的 keydown() 事件。

因此，当我在主屏幕上并点击“P”时，该部分会按应有的方式展开，但该字段现在有一个“P”。 ***这只发生在 IE9 中。***

奇怪的是，keydown() 事件必须在 'P' 被放在那里之后启动，因为如果我尝试在该字段中输入 'P'，我是不允许的。

有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:08:56.117

也许你可以`keypress`改变`keyup`？我认为这是 IE 冒泡或传播错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:07:16.277

找出问题所在，我没有在按键事件上返回 false，一旦我这样做了，就没有更多的输入被发送到输入。

# c# - Backgroundworker ProgressChanged 在工作人员完成后执行

> ID：11730338
> 
> 赞同：0
> 
> 时间：2012-07-30T22:02:55.377
> 
> 标签：c#, winforms, backgroundworker, multithreading

我创建了一个表单，每当我调用一个耗时的例程时，它就会弹出并显示一个进度条。`UpdateProgress`我通过该方法提供了我日常工作的进度。

我正在使用后台工作人员来允许用户移动表单并在此表单更新时继续开展业务。但是，表单会一直锁定，直到例程完成，然后快速将进度条增加到 100% 并退出（应该如此）。imo，进度条应该与对该`UpdateProgress`方法的调用进度一起更新。

我在这里做错了什么？

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Threading;

namespace myNameSpace
{
    public partial class ProgressIndicator : Form
    {
        int progressPercentage;

        public ProgressIndicator()
        {
            InitializeComponent();
        }

        void progressUpdater_ProgressChanged(object sender, ProgressChangedEventArgs e)
        {
            // update the UI with appropriate fields
            progressBar.Value = e.ProgressPercentage;
            labelCommunicating.Text = "In progress: " + e.ProgressPercentage + "% complete";
        }

        void progressUpdater_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            this.Close();
        }

        void progressUpdater_DoWork(object sender, DoWorkEventArgs e)
        {
            BackgroundWorker worker = sender as BackgroundWorker;

            while (true)
            {
                if (progressPercentage >= 100)
                {
                    break;
                }

                worker.ReportProgress(progressPercentage);

                Thread.Sleep(100);
            }
        }

        public void UpdateProgress(int progressPercentage)
        {
            this.progressPercentage = progressPercentage;
        }

        private void ProgressIndicator_Load(object sender, EventArgs e)
        {
            BackgroundWorker progressUpdater = new BackgroundWorker();
            progressUpdater.WorkerReportsProgress = true;
            progressUpdater.WorkerSupportsCancellation = true;
            progressUpdater.DoWork += new DoWorkEventHandler(progressUpdater_DoWork);
            progressUpdater.RunWorkerCompleted += new RunWorkerCompletedEventHandler(progressUpdater_RunWorkerCompleted);
            progressUpdater.ProgressChanged += new ProgressChangedEventHandler(progressUpdater_ProgressChanged);

            progressUpdater.RunWorkerAsync();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:11:44.220

这听起来像是一个牵强的解决方案，我认为您的问题在于`while loop`. 但是，更好的方法可能是通过使用例如简单地更新您的`ProgressBar`而不阻塞 UI`Invoke();`

```
Invoke(new myUpdate(updateProgress), pval);//call invoke whenever you need to update the progress bar assuming pval is an integer with the value to update with. This could be in a thread for instance.

//declare this as a class level delegate
private delegate void myUpdate(int progress);

//method to update progress bar
private void updateProgress(int progress)
{
    progressBar.Value = progress;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:42:10.190

您可以以这种方式创建流程，这样您就不需要将调用包装在 Invoke 方法周围。

```
//delegate method
private delegate void updateProgressDelegate(int progress);

//actual method
private void updateProgress(int progress)
{
    if(this.InvokeRequired)
    {
        this.Invoke(new updateProgressDelegate(updateProgress), progress);
    }
    else
    {
        progressBar.value = progress;
    }
} 
```

# java - 将字符串定义为 Null 或空字符串更好

> ID：11730339
> 
> 赞同：3
> 
> 时间：2012-07-30T22:03:03.987
> 
> 标签：java

我来自 C#.net 背景，每当我有一个字符串时，我都会声明它，因为`String.Empty` 现在我正在查看一位同事的 Java 代码，他用这样的方法声明了他的字符串：

```
String myStr = null; 
```

我不喜欢它，更糟糕的是，他在“IF”块中为这些字符串分配值，在该块中它可能符合条件，也可能不符合条件，然后在方法结束时`myStr.length()`对它们调用 a 。

所以我的问题是Java中的首选方式是什么？您认为将它们定义为更好还是`String.Empty`保留它们`null`并`null`在调用它们之前进行检查`.length()`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T22:31:26.603

一般来说，使用`null`值是一个坏主意，尤其是当它们从一个方法返回或传递给另一个方法时。使用[Null Object 模式](http://en.wikipedia.org/wiki/Null_Object_pattern)更好，在字符串的情况下，Null Object 是一个空字符串。通过始终避免空值，获得 NullPointerException 的概率会变得更小，并且代码变得更具可读性（这将在[Clean Code](https://rads.stackoverflow.com/amzn/click/com/0132350882)第 7 章第 110-112 页中详细讨论）。

在 Java`String s = ""`中不分配任何内存，因为 JVM 将保留字符串文字，因此甚至没有性能差异（即使有，也将是过早的优化）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-30T23:04:11.923

他们都有自己的用途。空字符串是带内的，即可以出现在输入中，因此它们不能用作标记。Null*仅用*作哨兵。如果你要附加到它，你当然应该用 "" 来初始化它。如果您要立即重新分配它，则根本不需要提供任何值，您可能应该将声明与重新分配结合起来。我看到的太多了：

```
String s = new String();
s = "some string"; 
```

这一切都告诉我，有人不懂这种语言。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-30T22:24:48.730

认为两者都适用于不同的场景，将其分配为 null 会更好（节省内存且不易出错），前提是您稍后设置一些字符串，否则您将获得空指针异常。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-30T22:09:25.470

空字符串通常表明您应该`StringBuilder`在追加时使用 a （这是一种常见情况）。引用“`null`更好”，因为它使用更少的内存，并且与检查字符串是否为空相比，检查字符串是否为空更快。我建议不要使用空字符串，而不是将它们声明为 null，尽管您仍然应该在使用它之前检查 null 引用，除非您 100% 确定它会在某个阶段被分配一个值。

# haskell - Haskell 列表理解中的非详尽模式

> ID：11730342
> 
> 赞同：5
> 
> 时间：2012-07-30T22:03:17.867
> 
> 标签：haskell, list-comprehension

> **可能重复：**
> [当模式匹配失败时，为什么 Haskell 列表推导不会导致错误？](https://stackoverflow.com/questions/649274/why-dont-haskell-list-comprehensions-cause-an-error-when-pattern-match-fails)

今天看到如下代码：

```
Prelude> [a | Just a <- [Just 10, Nothing, Just 20]]
[10, 20] 
```

有用。但我认为上面的列表理解只是...的语法糖

```
[Just 10, Nothing, Just 20] >>= (\(Just x) -> return x) 
```

...为此，Haskell 在遇到 时`Nothing`会发出错误`*** Exception: Non-exhaustive patterns in lambda`。

所以我的问题是：什么`[a | Just a <- [Just 10, Nothing, Just 20]]`翻译成（就一元代码而言）使它忽略`Nothing`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:55:46.243

我认为[另一个问题](https://stackoverflow.com/questions/649274/why-dont-haskell-list-comprehensions-cause-an-error-when-pattern-match-fails)的最佳答案实际上是引用“编译器魔术”的答案。您正在匹配模式`Just x`，并且根据[Haskell 2010 报告](http://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-420003.11)，行为被指定为

> .. 如果匹配失败，则简单地跳过列表中的该元素。

因此，我认为实现可以随意执行此操作（即，脱糖不一定是唯一的）。

# c# - 如何在图像按钮中将背景图像设置为无或其他默认值？

> ID：11730343
> 
> 赞同：1
> 
> 时间：2012-07-30T22:03:20.317
> 
> 标签：c#, winforms, button

我正在构建[这个问题](https://stackoverflow.com/q/4796021/869912)并创建一个简单的 ImageButton 类，该类表示一个仅包含图像的按钮。我实施了（至少我相信我做到了）[这个答案](https://stackoverflow.com/a/4796070/869912)中的建议，但我仍然得到这个代码的异常：

```
public class ImageButton : Button
{
    // Overrides the property
    public override Image BackgroundImage
    {
        get { return base.BackgroundImage; }
        set
        {
            base.BackgroundImage = value;
            if (value != null) this.Size = value.Size;
        }
    }

    // Shadows the property (note the -new- keyword)
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
    public new Size Size
    {
        get
        {
            return base.Size;
        }
        set
        {
            base.Size = value;
        }
    }

    public ImageButton()
    {
        this.BackgroundImage = base.BackgroundImage;
        this.BackgroundImageChanged += new EventHandler(ImageButton_BackgroundImageChanged);
    }

    void ImageButton_BackgroundImageChanged(object sender, EventArgs e)
    {
        this.Size = this.BackgroundImage.Size;
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        e.Graphics.DrawImage(BackgroundImage, 0, 0); // <-- Error occurs here
    }

    protected override void OnPaintBackground(PaintEventArgs e)
    {
        // Do nothing
    }
} 
```

当我尝试将此控件添加到设计器时，我得到

> 控件 ImageButton 在设计器中引发了未处理的异常并已被禁用。
> 
> 例外：值不能为空。参数名称：图像
> 
> 堆栈跟踪：ImageButton.cs:line48 中的 ImageButton.OnPaint(PaintEventArgs e)

第 48 行是这一行：

```
e.Graphics.DrawImage(BackgroundImage, 0, 0); 
```

我意识到抛出此错误是因为`BackgroundImage`未设置为值，但我不确定如何在代码中执行此操作。在实际应用中，这个类永远不会添加到设计器中，而是以编程方式添加。我该如何解决这个异常？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T22:34:05.473

```
 this.BackgroundImage = base.BackgroundImage; 
```

是的，当然，保证例外。您希望有人在构造函数运行*之前设置了 BackgroundImage 属性。*这是不可能的，构造函数在控件上的任何属性可以设置之前运行。

接下来出错的是 Paint 事件也将在设计器中引发。在您将控件放在表单上后立即发生这种情况。那是一个 Kaboom，用户和您的代码都没有给 BackgroundImage 属性赋值。所以只需修复方法：

```
protected override void OnPaint(PaintEventArgs e)
{
    if (BackgroundImage != null) e.Graphics.DrawImage(BackgroundImage, 0, 0);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-27T14:00:50.433

要删除背景图像，只需编写：

```
this.BackgroundImage = null; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-30T22:10:46.173

我不知道 C#，但我的猜测是在某处存储一个透明的 1x1px 图像并将其分配给 init。这样，就会有图像，但什么也看不到。

或者您可以尝试在第 48 行附近添加一些检查，如下所示：

```
if(BackgroundImage!=null){
    e.Graphics.DrawImage(BackGroundImage,0,0);
} 
```

也许添加这样的东西：

```
else{ //No background image
    //Draw some dummy/placeholder
} 
```

另一种方法是将`DrawImage`调用封装在一个`try{}`块中并捕获结果表达式。如果是空块，您应该能够安全地使用`catch{}`它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T22:11:08.310

如果没有设置图像时不绘制怎么办，在函数开头也调用base。

```
base.OnPaint(e); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-30T22:24:02.223

您的实现中有很多冗余代码：试试这个修订版......

```
public class ImageButton : Button
    {
        public ImageButton()
        {
            this.SetStyle(ControlStyles.AllPaintingInWmPaint, true);
            this.SetStyle(ControlStyles.UserPaint, true);
        }

        protected override void OnPaint(PaintEventArgs pevent)
        {
            //base.OnPaint(pevent); <-- NO LONGER NEEDED (WE DO NOT WANT THE SYSTEM TO PAINT THE BUTTON);
            if (this.BackgroundImage != null)
            {
                pevent.Graphics.DrawImage(this.BackgroundImage, 0, 0);
            }
            else
            {
                //Just fill in black (for example)
                pevent.Graphics.FillRectangle(new SolidBrush(Color.Black), this.ClientRectangle);
            }
        }

        protected override void OnPaintBackground(PaintEventArgs pevent)
        {
            base.OnPaintBackground(pevent);
            pevent.Graphics.FillRectangle(new SolidBrush(this.BackColor), this.ClientRectangle);
        }

        public override Image BackgroundImage
        {
            get
            {
                return base.BackgroundImage;
            }
            set
            {
                base.BackgroundImage = value;
                this.Size = base.BackgroundImage.Size;
                this.Refresh();
            }
        }
    } 
```

# ssh - 未通过 ssh 找到捆绑包

> ID：11730346
> 
> 赞同：6
> 
> 时间：2012-07-30T22:03:41.503
> 
> 标签：ssh, bundler

如果我以部署用户身份 ssh 进入我的 VPS 并运行，`bundle -v`我会得到`Bundler version 1.1.5`预期的结果。

如果我跑`ssh deployment@123.123.123.123 bundle -v`，我会看到`bash: bundle: command not found`

为什么不显示 bundle 通过 ssh 运行命令？

**更多信息**

```
$ cat ~/.bashrc

# ~/.bashrc: executed by bash(1) for non-login shells.
# see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)
# for examples

if [ -d "${RBENV_ROOT}" ]; then
  export PATH="${RBENV_ROOT}/bin:${PATH}"
  eval "$(rbenv init -)"
fi

# If not running interactively, don't do anything
[ -z "$PS1" ] && return 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:35:09.940

当你运行时：

```
ssh deployment@123.123.123.123 
```

您在远程主机上获得了一个登录 shell，这意味着您的 shell 将运行 (...for bash...)`.bash_profile`或`.profile`等效的以及您的 per-shell 初始化文件。

当你运行时：

```
ssh deployment@123.123.123.123 some_command 
```

这不会启动登录 shell，因此它只运行每个 shell 的初始化文件（例如，`.bashrc`）。

您描述的问题通常意味着您需要`.profile`文件中的某些内容（通常是环境变量设置）才能使一切正常工作。

# python - Python中的3D归一化互相关

> ID：11730348
> 
> 赞同：0
> 
> 时间：2012-07-30T22:04:05.217
> 
> 标签：python, 3d, correlation

我目前正在使用从 Python 调用的 OpenCV 的 MatchTemplate 函数进行 2D 模板匹配。我希望将我的代码扩展到 3D，但找不到任何现有的 3D 互相关程序。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:59:34.397

您的意思是您当前正在图像中的某处寻找已知对象，并且您目前只能处理正在仿射变换的对象（在 2D 平面上移动），但您希望能够以透视的方式处理它变身了？

您可以尝试使用 SURF 或 SIFT 算法在您的参考和未知图像中查找特征：

```
def GetSurfPoints(image, mask)
    surfDetector = cv2.FeatureDetector_create("SURF")
    surfExtractor = cv2.DescriptorExtractor_create("SURF")
    keyPoints = surfDetector.detect(image, mask)
    keyPoints, descriptions = surfExtractor.compute(image, keyPoints)
    return keyPoints, descriptions 
```

然后使用 FLANN 查找匹配点（这是来自 cv2 样本之一）：

```
def MatchFlann(desc1, desc2, r_threshold = 0.6):
    FLANN_INDEX_KDTREE = 1  # bug: flann enums are missing
    flann_params = dict(algorithm = FLANN_INDEX_KDTREE, trees = 4)
    flann = cv2.flann_Index(desc2, flann_params)
    idx2, dist = flann.knnSearch(desc1, 2, params = {}) # bug: need to provide empty dict
    mask = dist[:,0] / dist[:,1] < r_threshold
    idx1 = numpy.arange(len(desc1))
    matches = numpy.int32( zip(idx1, idx2[:,0]) )
    return matches[mask] 
```

现在，如果您愿意，可以使用 FindHomography 来找到对齐两个图像的转换：

```
referencePoints = numpy.array([keyPoints[match[0]].pt for match in matches])
newPoints = numpy.array([keyPoints[match[1]].pt for match in matches])
transformMatrix, mask = cv2.findHomography(newPoints, referencePoints, method = cv2.cv.CV_LMEDS) 
```

然后，您可以使用 WarpPerspective 和该矩阵来对齐图像。或者您可以使用之前找到的匹配点集做其他事情。

# java - 使班级决赛的情况？

> ID：11730352
> 
> 赞同：12
> 
> 时间：2012-07-30T22:04:15.607
> 
> 标签：java

是否有关于何时进行期末考试的一般指导方针？

我以为是如果您不希望人们扩展您的课程，但这似乎有点……天真？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-30T22:12:10.600

将类设为 final 只会阻止它被扩展，正如您所注意到的。你为什么想这么做？

*   一个典型的用例是保证不变性。如果您设计了一个不可变类但没有使其成为最终类，则可以以可变方式对其进行扩展。这反过来又会导致子类破坏类不变量或产生并发问题。

*   您也可以简单地将一个类标记为 final 以记录它不是为扩展而设计的事实。例如，请参见 Effective Java #17：“Design and document for inheritance or else to prevent it”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-30T22:21:53.693

理想情况下，您已经阅读了 Josh Bloch 并设计了您的类以实现完美的继承。但是，在实践中，我（恕我直言）对班级决赛的回答是

*您是否信任（或希望）其他人扩展它？*

如果它是一个超级关键类`String`或一些与安全相关的类，是的，一定要让它成为最终的。

如果您正在做真正花哨的东西并且课程很难正确扩展，请*考虑*将其定为最终版本，具体取决于您希望使用该课程的人具备的技能。还取决于这是一个通用库还是某些公司/项目特定代码，以及它是用于带有 Squirrel 视频的网站还是心脏起搏器 - 即，一个糟糕的子类会破坏多严重？

如果您没有做任何花哨的事情，请不要将其定为最终版本而惹恼用户。我经常诅咒Java制作像`Double`final这样的类。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-30T22:16:01.880

众所周知，继承破坏了封装。Allan Snyder 在他的论文[《面向对象编程语言中的封装和继承》中](http://dl.acm.org/citation.cfm?id=28702)展示了您必须谨慎对待继承。

Josua Bloch 在他的《[Effective Java](http://java.sun.com/docs/books/effective/) 》一书中建议您设计和记录要继承的类，否则就禁止它，这正是 Snyder 已经知道的问题。

如果在某些时候您不确定将来如何扩展您的课程，或者如果您不打算实际扩展它们，那么您最好将它们定为最终版本。您可以随时打开它们以进行扩展，但相反（尤其是如果您正在构建一个开放系统）可能是痛苦的真正原因，如果不是不可能的话，取决于具体情况。

Mikhajlov 和 Sekerinski 在他们的论文[A Study of the Fragile Base Class 中的研究](http://www.cas.mcmaster.ca/~emil/Publications_files/MikhajlovSekerinski98FragileBaseClassProblem.pdf)展示了在不正确地使用继承时可能会遇到的一系列问题，这可能会让您更广泛地了解为什么这很重要。

# java - Java repaint() 在浏览器中不起作用

> ID：11730353
> 
> 赞同：1
> 
> 时间：2012-07-30T22:04:23.753
> 
> 标签：java, paint, repaint

我用 Java 制作了一个游戏，当我在 Eclipse 中运行它时没有任何问题。一切看起来都很棒，并且有效地完成了（至少在我想出其他事情之前）。所以我一直试图把它放在我的网站上，但是每当我在浏览器中运行游戏时，我只会得到一个白屏，尽管检查 Java 控制台没有显示任何错误。我已经设法将问题缩小到屏幕的绘画。我有一个计时器，它运行游戏并让事情发生。最后，它调用 repaint() 方法。在 Eclipse 中，这工作正常，但在浏览器中，什么也没有发生。

这是相关代码（所有这些都在名为 FinalProject 的主类中）：

```
public class FinalProject extends JApplet implements ActionListener,
                          KeyListener, MouseListener, MouseMotionListener {
    public void init(){
        //...initialize program

        System.out.println("game started");
    }

    /**
     * A method called every so often by a timer to control the game world.
     * Mainly calls other functions to control objects directly, but this 
     * is used as the only timer, which also calls repaint() at it's end.
     */
    private void runGame(){
        //...Run game and do important stuff

        //This Draws The Screen
        System.out.println("about to paint");
        repaint();
    }

    public void paint(Graphics g){
        System.out.println("painting");

        //...paint screen
    }

    public void update(Graphics gr){
        System.out.println("updating");
        paint(gr);
    }
} 
```

runGame() 由计时器调用。在 Eclipse 中的输出是：
游戏开始
绘画
绘画
即将绘画
绘画
即将绘画
绘画
即将绘画
绘画
...

在浏览器中执行此操作时（直接在我的机器上脱机运行。所有浏览器也有同样的问题），控制台显示：
...（加载内容）
游戏已启动
基本：Applet 已初始化
基本：启动小程序
基本：已完成性能汇总
基本：小程序可见
基本：小程序启动
基本：告诉客户小程序开始
即将绘画
即将绘画
即将绘画
...

我不知道此时还能尝试什么。尽管我很努力，但我仍然不完全理解 repaint() 的作用，我所知道的是它最终调用了 update() 和 paint()。除了浏览器中似乎没有发生这种情况。我正在使用带有 Java 版本 7 Update 5 的 Windows 7 64x。在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T03:54:20.197

原来，问题在于删除菜单栏。不久前我发现了一些代码，它可以从程序中删除菜单栏，它可以正常工作。但是，它似乎阻止了它在放置在浏览器中时重新绘制。我不知道为什么重绘会因为删除菜单栏而中断，但显然确实如此。

我使用的代码（在 init() 中）：

```
Frame[] frames = Frame.getFrames();
for (Frame frame : frames){
    frame.setMenuBar(null);
    frame.pack();
} 
```

这段代码确实根据需要删除了菜单栏，但在程序上线时也会爆炸。删除这个解决了这个问题。幸运的是，菜单栏无论如何都不会在线显示，因此删除这段代码并不会造成太大损失。

# c++ - 为什么 Visual C++ 不对最琐碎的代码执行返回值优化？

> ID：11730354
> 
> 赞同：14
> 
> 时间：2012-07-30T22:04:31.580
> 
> 标签：c++, visual-c++, return-value-optimization

Visual C++ 不执行返回值优化吗？

```
#include <cstdio>
struct Foo { ~Foo() { printf("Destructing...\n"); } };
Foo foo() { return Foo(); }
int main() { foo(); } 
```

我编译并运行它：

```
cl /O2 test.cpp
test.exe 
```

它打印：

> 破坏……
> 破坏……

为什么它不执行 RVO？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-30T22:18:53.347

当我用这个测试时：

```
#include <iostream>
struct Foo { 
    Foo(Foo const &r) { std::cout << "Copying...\n"; }
    ~Foo() { std::cout << "Destructing...\n"; }
    Foo() {}
};

Foo foo() { return Foo(); }

int main() { Foo f = foo(); } 
```

...我得到的输出是：

```
Destructing... 
```

没有调用复制构造函数，只有一个析构函数。

# vb.net - 使用 SPI_SETSCREENSAVESECURE 不会为 Windows 屏幕保护程序启用密码保护

> ID：11730359
> 
> 赞同：1
> 
> 时间：2012-07-30T22:05:02.320
> 
> 标签：vb.net, winapi, windows-7, windows-screensaver

当我运行以下代码行时，我的屏幕保护程序的密码保护未启用。我还检查了用于控制密码保护的注册表项，它也没有被切换。

```
 If SystemParametersInfo(SPI_SETSCREENSAVESECURE, 1, nullVar, SPIF_SENDWININICHANGE) = 0 Then
        Throw New WindowsDotHException(ErrorToString(Err.LastDllError()) & " (Error number " & Err.LastDllError & ")")
    End If 
```

语境：

WindosDotHException 是我处理来自 SystemParametersInfo 的错误代码的方法。

```
 ' Signatures for unmanaged calls
<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Function SystemParametersInfo(uAction As Integer, uParam As Integer, ByRef lpvParam As Integer, flags As Integer) As Boolean
End Function

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Function SystemParametersInfo(uAction As Integer, uParam As Integer, ByRef lpvParam As Boolean, flags As Integer) As Boolean
End Function

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Function PostMessage(hWnd As IntPtr, wMsg As Integer, wParam As Integer, lParam As Integer) As Integer
End Function

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Function OpenDesktop(hDesktop As String, Flags As Integer, Inherit As Boolean, DesiredAccess As UInteger) As IntPtr
End Function

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Function CloseDesktop(hDesktop As IntPtr) As Boolean
End Function

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Function EnumDesktopWindows(hDesktop As IntPtr, callback As EnumDesktopWindowsProc, lParam As IntPtr) As Boolean
End Function

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Function IsWindowVisible(hWnd As IntPtr) As Boolean
End Function

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Public Shared Function GetForegroundWindow() As IntPtr
End Function

' Callbacks
Private Delegate Function EnumDesktopWindowsProc(hDesktop As IntPtr, lParam As IntPtr) As Boolean

' Constants
Private Const SPI_GETSCREENSAVERACTIVE As Integer = 16
Private Const SPI_SETSCREENSAVERACTIVE As Integer = 17
Private Const SPI_GETSCREENSAVERTIMEOUT As Integer = 14
Private Const SPI_SETSCREENSAVERTIMEOUT As Integer = 15
Private Const SPI_GETSCREENSAVERRUNNING As Integer = 114
Private Const SPIF_SENDWININICHANGE As Integer = 2
Private Const SPI_SETSCREENSAVESECURE As Integer = 119

Private Const DESKTOP_WRITEOBJECTS As UInteger = &H80
Private Const DESKTOP_READOBJECTS As UInteger = &H1
Private Const WM_CLOSE As Integer = 16 
```

操作系统：Windows 7 32位版本

语言：VB.Net

我尝试过的事情：

*   重新启动计算机
*   运行代码后注销并重新登录

如何在 Windows 7 中启用密码保护？

# opengl - 如何反转具有偶数个顶点的三角形条带？

> ID：11730366
> 
> 赞同：0
> 
> 时间：2012-07-30T22:05:34.857
> 
> 标签：opengl, 3d, directx

我知道用奇数个顶点来反转三角形条的方向，我可以反转顶点；ABCDE 成为 EDCBA。

但是，这似乎不适用于顶点数为偶数的三角形带。

我已经尝试了一些我在网上阅读过的技术，但是，它们似乎都不起作用。

我曾尝试将 ABCDEF 转换为 BADCFE，但是，当它渲染时，我最终会在网格中出现奇怪的故障。

我还读过只翻转 B 和 C 应该可以工作，但渲染仍然不会翻转后续三角形的方向。

是否可以仅通过更改条带的索引来反转具有偶数个顶点的三角形条带的方向？

此时我只能访问顶点的二进制索引列表，因此我无法添加退化三角形，或者以其他方式更改列表中的索引数量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T01:00:18.197

您不能更改任意长度的三角形带的缠绕顺序。您只能更改奇数条带的缠绕顺序。不是不改变条带本身。

考虑这个地带：

![三角带](../Images/e3ddf9f45150e14f7e1d62c2f3e7940a.png)

如果你切换中间顶点对的顺序（我的原始算法，我删除了），你得到的三角形（使用当前数字）是：

(0, 2, 1), (2, 1, 4), (1, 4, 3), ...

注意第二个三角形：2、1、4。这是一个*完全不同的三角形*；它实际上不是在这个地带。1、4、3 也不是。

这*似乎*有效，因为它覆盖了相同的*区域*。但它实际上不起作用，因为它正在绘制一组不同的三角形。值会以不同的方式进行插值，结果会是错误的。也许没有*明显*错误，但仍然是错误的。

没有算法可以采用任意三角形带并反转其缠绕顺序。就其性质而言，三角形条带受其缠绕顺序的约束，您不能在所有情况下都将其反转。

这就是为什么 API 有办法简单地反转预期的缠绕顺序。你提到：

> 我的项目涉及破解 Mario Kart Wii 的课程文件

为什么不使用它们的绕组将它们的三角形条带变成三角形*列表*而不是绘制条带。这样，您可以更轻松地更改数据中的绕组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-18T03:00:31.000

在条带上添加一个退化三角形，然后将其反转。

# jquery - 内容挂在封闭的手风琴外面

> ID：11730367
> 
> 赞同：0
> 
> 时间：2012-07-30T22:05:39.730
> 
> 标签：jquery, jquery-ui-accordion

我正在使用手风琴 (http://jqueryui.com/demos/accordion/#default)。有 3 个手风琴可以在点击时打开和关闭。3 个手风琴中的每一个内部都有两个浮动 div。前两个手风琴看起来不错，但第三个不行。关闭时，它的一个内部浮动 div 挂在第三个手风琴的外面和下方。当单击并打开该手风琴标题时，浮动的 div 会在手风琴内弹回并看起来很好。其他人有这个问题吗？提前感谢您的任何提示！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:15:31.083

您是否正在[清除](http://css-tricks.com/snippets/css/clear-fix/)每个手风琴面板内的浮动？

# asp.net-mvc-3 - 找不到控制器/操作

> ID：11730368
> 
> 赞同：0
> 
> 时间：2012-07-30T22:05:40.290
> 
> 标签：asp.net-mvc-3

我有我的行动可用。多人在此应用程序上工作，并且有可能同时单击按钮。有时我会遇到以下异常，我该如何解决？

**例外**

```
System.Web.HttpException: A public action method 'CorrectAsIsControl' was not found on controller 'Intranet.Site.Areas.OngoingProjects.Controllers.PaperSurveyEmailCleanUpController'.
Generated: Mon, 30 Jul 2012 21:38:49 GMT

System.Web.HttpException (0x80004005): A public action method 'CorrectAsIsControl' was not found on controller 'Intranet.Site.Areas.OngoingProjects.Controllers.PaperSurveyEmailCleanUpController'.
   at System.Web.Mvc.Controller.HandleUnknownAction(String actionName)
   at System.Web.Mvc.AsyncController.<>c__DisplayClass19.<BeginExecuteCore>b__15()
   at System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass1.<MakeVoidDelegate>b__0()
   at System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _)
   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   at System.Web.Mvc.AsyncController.EndExecuteCore(IAsyncResult asyncResult)
   at System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar)
   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   at System.Web.Mvc.AsyncController.EndExecute(IAsyncResult asyncResult)
   at System.Web.Mvc.AsyncController.System.Web.Mvc.Async.IAsyncController.EndExecute(IAsyncResult asyncResult)
   at System.Web.Mvc.MvcHandler.<>c__DisplayClass6.<>c__DisplayClassb.<BeginProcessRequest>b__4(IAsyncResult asyncResult)
   at System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar)
   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   at System.Web.Mvc.MvcHandler.<>c__DisplayClasse.<EndProcessRequest>b__d()
   at System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f)
   at System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action)
   at System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult)
   at System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result)
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

**行动：**

```
[HttpPost]
        [NoCaching]
        public ActionResult CorrectAsIsControl()

[HttpPost]
        [NoCaching]
        public ActionResult UnreadableControl() 
```

**无缓存过滤器**

```
public partial class NoCaching : ActionFilterAttribute
    {
        #region OVERRIDES

        public override void OnResultExecuting(ResultExecutingContext filterContext)
        {
            filterContext.HttpContext.Response.Cache.SetExpires(DateTime.UtcNow.AddDays(-1));
            filterContext.HttpContext.Response.Cache.SetValidUntilExpires(false);
            filterContext.HttpContext.Response.Cache.SetRevalidation(HttpCacheRevalidation.AllCaches);
            filterContext.HttpContext.Response.Cache.SetCacheability(HttpCacheability.NoCache);
            filterContext.HttpContext.Response.Cache.SetNoStore();

            base.OnResultExecuting(filterContext);
        }

        #endregion
    } 
```

**阿贾克斯邮报**

```
_performStaticActions: function ($click) {
        var id = $click.attr("rel");
        var link = $click.attr("href");
        if (id == "")
            jMessageError("Unable to find Id, operation aborted!", $click, false, true);
        else if (link == "")
            jMessageError("Unable to find action link, operation aborted!", $click, false, true);
        else {
            jMessage("Processing request...", $click, true, false);

            //link = link + "?badEmailId=" + id;
            $.ajax({
                cache: false,
                url: link,
                type: Ajax.MethodType.POST,
                data: { badEmailId: id},
                error: function (xhr, ajaxOptions, thrownError) {
                    jMessageError(xhr.responseText, $click, false, true);
                },
                success: function (result) {
                    if (result.IsError) {
                        jMessageError(result.Message, $click, false, true);
                    } else {
                        jMessageOK(result.Message + "<br><br>Picking new item...", $click, false, false);
                        setTimeout('PaperSurveyBadEmailCleanUp._pickNewItem()', 3000);
                    }
                }
            });
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T03:39:22.207

Phil Haack 有一篇很棒的文章，他在其中描述了一个工具“Route Debugger”的使用，这在像你这样的场景中很有用这里是链接[http://haacked.com/archive/2012/07/25/finding-bad -controllers.aspx](http://haacked.com/archive/2012/07/25/finding-bad-controllers.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T20:41:40.157

我已经在 ajax 发布操作上删除了 NoCaching 属性，它似乎有效。自昨天以来，我没有收到任何错误。现在我需要重新考虑 NoCaching 属性。

# python - Python JSON 调用

> ID：11730371
> 
> 赞同：1
> 
> 时间：2012-07-30T22:06:00.177
> 
> 标签：python, python-3.x

我最近开始接触 Python，想知道您是否可以发布一些关于如何编码 JSON 字符串、将其作为 HTTP 请求发送到 URL 并解析响应的代码。

这是我一直在玩的一些代码：

```
import os
import json

if os.name == 'nt':
    def clear_console():
        subprocess.call("cls", shell=True)
        return
else:
    def clear_console():
        subprocess.call("clear", shell=True)
        return

def login_call(username, password):

choice = 0

while int(choice) not in range(1,2):
    clear_console()
    print ('')
    print ('  Json Calls - Menu')
    choice = input('''
  1\. Login.

  Enter Option: ''')

print ('')

choice = int(choice)

if choice == 1:

    login_call(username, password) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T22:09:56.317

前几天我写了一个答案来为 github api 做这样的事情。在这里查看我的[答案。](https://stackoverflow.com/a/11621206/741316)

本质上，代码归结为：

```
import urllib2
import json

data = {"text": "Hello world github/linguist#1 **cool**, and #1!"}
json_data = json.dumps(data)

req = urllib2.Request("https://api.github.com/markdown")
result = urllib2.urlopen(req, json_data)

print '\n'.join(result.readlines()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:09:45.633

您需要的模块是`httplib`或`http.client`，具体取决于您的 Python 版本，以及`json`. 在 JSON 中，simple`loads`和`dumps`函数应该为您轻松编码和解码 JSON。

# java - 了解 DatabaseMetaData 的方法

> ID：11730372
> 
> 赞同：1
> 
> 时间：2012-07-30T22:06:04.030
> 
> 标签：java, mysql, jdbc, metadata

我正在使用 MySql、JDBC、Java 来编写我的代码。我无法理解 API 中的某些术语是什么意思。它阻止我做下面的工作 - 制作检查特定数据库是否存在的代码，然后检查该数据库中是否存在特定表数据库，然后检查该表中的特定列。

每个表描述都有以下列：

```
TABLE_CAT String => table catalog (may be null)
TABLE_SCHEM String => table schema (may be null)
TABLE_NAME String => table name
TABLE_TYPE String => table type. Typical types are "TABLE", "VIEW", "SYSTEM     TABLE",     "GLOBAL TEMPORARY", "LOCAL TEMPORARY", "ALIAS", "SYNONYM".
REMARKS String => explanatory comment on the table
TYPE_CAT String => the types catalog (may be null)
TYPE_SCHEM String => the types schema (may be null)
TYPE_NAME String => type name (may be null)
SELF_REFERENCING_COL_NAME String => name of the designated "identifier" column of a typed table (may be null)
REF_GENERATION String => specifies how values in SELF_REFERENCING_COL_NAME are  created.      
Values are "SYSTEM", "USER", "DERIVED". (may be null) 
```

什么是表目录，什么是表模式，SELF_REFERENCING_COL_NAME 等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T03:48:07.243

就[DatabaseMetadata的](http://docs.oracle.com/javase/7/docs/api/java/sql/DatabaseMetaData.html)[Connector/J](http://dev.mysql.com/doc/refman/5.6/en/connector-j.html)实现而言，返回数据库名称（如在[CREATE DATABASE](http://dev.mysql.com/doc/refman/5.6/en/create-database.html)中）；是和不返回。`TABLE_CAT``TABLE_SCHEM``null``SELF_REFERENCING_COL_NAME`

这是特定于数据库和驱动程序的。例如，Oracle [ojdbc 驱动程序](http://www.oracle.com/technetwork/database/features/jdbc/index-091264.html)将返回`null`for`TABLE_CAT`和对象所有者为`TABLE_SCHEM`.

* * *

对于您的特定任务（MySQL + 连接器/J）：

1.  要检查特定数据库是否存在 →`getCatalogs()`用于获取 a `ResultSet`，迭代其行并检索`TABLE_CAT`列，您的数据库应匹配其值之一。
2.  要检查数据库是否包含特定表→`getTables(databaseName, null, tableName, new String[]{"TABLE"})`应该返回一个非空的`ResultSet`。
3.  要检查表是否包含特定列→`getColumns(databaseName, null, tableName, columnName)`应该返回一个非空的`ResultSet`。

# c# - 字节数组到位图图像

> ID：11730373
> 
> 赞同：8
> 
> 时间：2012-07-30T22:06:04.027
> 
> 标签：c#, arrays, bitmap, byte

我制作了这段代码来接收图像并将其转换为位图图像，但它不起作用。

这是代码：

```
public void ReceiveImage()
{
    NetworkStream stream = new NetworkStream(socket);
    byte[] data = new byte[4];
    stream.read(data,0,data.length,0)
    int size = BitConverter.ToInt32(data,0);
    data = new byte[size];
    stream.read(data,0,data.length)
    MemoryStream imagestream = new MemoryStream(data);
    Bitmap bmp = new Bitmap(imagestream);
    picturebox1.Image = bmp;
} 
```

它可以：

```
Bitmap bmp = new Bitmap(imagestream); 
```

并给我这个错误：

> 参数无效

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-30T12:55:52.747

这是另一种方法

```
int w= 100;
int h = 200;
int ch = 3; //number of channels (ie. assuming 24 bit RGB in this case)

byte[] imageData    = new byte[w*h*ch]; //you image data here
Bitmap bitmap       = new Bitmap(w,h,PixelFormat.Format24bppRgb);
BitmapData bmData   = bitmap.LockBits(new System.Drawing.Rectangle(0, 0, bitmap.Width, bitmap.Height), ImageLockMode.ReadWrite, bitmap.PixelFormat);
IntPtr pNative      = bmData.Scan0;
Marshal.Copy(imageData,0,pNative,w*h*ch);
bitmap.UnlockBits(bmData); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:21:27.947

您可能没有收到足够的字节，`stream.read(data,0,data.length)`因为`Read`不能确保它会读取`data.length`字节。您必须检查它的返回值并继续读取直到读取`data.Length`字节。

请参阅：[Stream.Read 方法](http://msdn.microsoft.com/en-us/library/system.io.stream.read.aspx)的返回值

```
int read = 0;
while (read != data.Length)
{
    read += stream.Read(data, read, data.Length - read);
} 
```

PS：我假设`length`s 和`read`s 是拼写错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T22:20:59.230

我假设你有一张桌子，想从数据库中接收图片。

```
int cout = ds.Tables["TableName"].Rows.Count;
                if (cout > 0)
                {
                    if (ds.Tables["TableName"].Rows[cout - 1]["Image"] != DBNull.Value)
                    {
                        var data = (byte[])(ds.Tables["TableName"].Rows[cout - 1]["Image"]);
                        var stream = new MemoryStream(data);
                        pictureBox1.Image = Image.FromStream(stream);
                    }
                    else
                    {
                        pictureBox1.Image = null;
                    }
                } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-30T22:20:46.233

尝试这个：

```
int size = BitConverter.ToInt32(data.Reverse().ToArray(),0); 
```

# java - 这个JPA“缓存hashCode”模式有什么问题吗？

> ID：11730379
> 
> 赞同：3
> 
> 时间：2012-07-30T22:06:54.423
> 
> 标签：java, hibernate, jpa, persistence

我在`#hibernate`IRC 上，有人与我分享了以下（部分）模式

```
@Entity
public MyEntity() {

  ... primary key, object properties, getters/setters go here ...    

  @Column(nullable=false)
  private int hashCode;

  public MyEntity() {
     hashCode += id;
  }

  private final Set<String> tags = Sets.newHashSet();

  public void addTag(String tag) {
     if(tags.add(tag)) {
         hashCode += tag.hashCode();
     }
  }

  public void removeTag(String tag) {
     if(tags.remove(tag) {
        hashCode -= tag.hashCode();
     }
  }

  public void hashCode() {
    return hashCode;
  }

  ... http://www.artima.com/lejava/articles/equality.html style equals ...
} 
```

可以将其称为“分段更新的缓存 hashCode”。（这绝对**不是**一些评论者认为的“业务密钥”模式。“业务密钥”模式需要一个具有唯一性约束的列，例如用于相等性测试的用户名）。

在 JPA/Hibernate 中使用时，这意味着can 具有与[JBoss Equals 和 HashCode 文章](https://community.jboss.org/wiki/EqualsAndHashCode)`@Entity`中的“eq/hC with buisness [sic] key”类似的优势，但其行为方式与开发人员期望的任何普通 Javabean 对象的行为方式相同（即不必像数据库行一样考虑对象）：在持久化到数据库之前；在获取模式之后；并随时在 a或模式中使用fetch 。`Transaction``EAGER``LAZY``Transaction``EXTENDED`

但是，确保`hashCode`始终正确更新可能是一个真正的挑战。

**这里有没有人对这种模式有任何经验，你能分享你对它的发现（积极的和消极的）吗？**我对 Gotchas 非常感兴趣，但我对那些声称某些东西“不好”的评论完全不感兴趣，而没有关于它为什么不好的可靠论据。

请注意，我知道[The JPA hashCode() / equals() dilemma](https://stackoverflow.com/questions/5031614)，但我不相信该模式实际上已包含在该讨论中。

最初建议使用此模式作为`Collection`在 s 中加载嵌套 s时避免问题的一种方法`@Entity`，例如在[带有 EAGER @ElementCollection 的 find() 上的 Hibernate LazyInitializationException](https://stackoverflow.com/questions/11604370)中遇到的问题。

更新：一些评论者对现有方法充满热情。为免生疑问，我只是对这种新模式的优点感兴趣。供您参考，也请您不要再说您认为应该如何实现 equals/hashCode，请注意，我已经为我`@Entity`的 s 使用了以下模式好几年了：

```
@Id
private UUID id = UUID.randomUUID();

@Override
public boolean equals(Object obj) {
    if (this == obj)
        return true;
    if (!(obj instanceof MY_CLASS) || id == null)
        return false;
    MY_CLASS other = (MY_CLASS) obj;
    return id.equals(other.id);
}

@Override
public int hashCode() {
    Preconditions.checkNotNull(id, "id must be set before @Entity.hashCode can be called");
    return id.hashCode();
} 
```

而且我最近才尝试了一些新方法，看看我是否真的需要像这样的单独方法

```
public boolean hasSameProperties(Note other) {
    Preconditions.checkNotNull(other);
    if (this == other)
        return true;
    return Objects.equal(source, other.source)
            && Objects.equal(title, other.title)
            && Objects.equal(tags, other.tags)
            && Objects.equal(contents, other.contents);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:23:55.603

此业务密钥不是唯一的，因此对于 equals() 来说似乎是一个糟糕的选择。

业务密钥 1002 已添加标签 500 和标签 -502，业务密钥 995 已添加标签 3 和标签 2？这些对象真的是平等的吗？

对于您的特定实体所服务的任何目的而言，32 位数字的冲突风险相对较低可能是可以容忍的，但是将某些东西称为“模式”，人们希望它实际上是正确的，而不仅仅是对于给定的任意不可能失败数据大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T08:05:03.817

我已经编写、重写和删除了两三个长答案，解释了为什么我认为这是一个坏主意，但最终，所有这些都是对什么是对象身份的基本解释，我相信你明白这一点。

我对这种模式的回应是它不能解决任何需要解决的问题。

所谓的“hashCode/equals 问题”的解决方案非常简单。在创建实体时为它们提供一个标识符。坚持下去。`equals`以它为基础`hashCode`。不要*依赖*数据库或持久层在插入时创建的标识符。这是一个[非常古老的原则](http://onjava.com/pub/a/onjava/2006/09/13/dont-let-hibernate-steal-your-identity.html)。

顺便说一句，对于实体来说，基于可变字段或基于可变字段是*不对*的。这不是平等对实体起作用的方式。实体不仅仅是一袋状态，它们是某种状态恰好附加到的身份。平等和哈希码必须基于身份，而不是状态。`equals``hashCode`

# singleton - 对于带参数的构造函数，goog.addSingletonGetter() 是否有变体？

> ID：11730384
> 
> 赞同：2
> 
> 时间：2012-07-30T22:07:16.733
> 
> 标签：singleton, google-closure, google-closure-library

我想使用`goog.addSingletonGetter()`（[http://closure-library.googlecode.com/svn/!svn/bc/4/trunk/closure/goog/docs/closure_goog_testing_singleton.js.source.html#line56](http://closure-library.googlecode.com/svn/!svn/bc/4/trunk/closure/goog/docs/closure_goog_testing_singleton.js.source.html#line56)）将`getInstance()`方法添加到具有接受参数的构造函数的类：

```
Foo = function(x, y) {...}; 
```

有没有办法让我指定`goog.addSingletonGetter(Foo, arg1, arg2)`？然后调用`Foo.getInstance()`将懒惰地返回实例化的 Foo 对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:01:05.793

结束语：第 70 页***[的权威指南](https://rads.stackoverflow.com/amzn/click/com/1449381871)***`goog.addSingletonGetter()`定义如下：

> 对于具有**零参数**的构造函数的类，`goog.addSingletonGetter()` 将静态方法添加到其名为的构造函数中，该方法在`getInstance()`调用时返回该对象的相同实例。一般来说，如果存在的话，应该使用它来代替构造函数。

一种方法是在第 143 页***[JavaScript 模式](https://rads.stackoverflow.com/amzn/click/com/0596806752)***中介绍的静态属性设计模式中的***实例之后***创建一个单例，并添加一个静态函数。`getInstance()`

```
/**
 * @param {string=} opt_x
 * @param {string=} opt_y
 * @constructor
 */
Foo = function(opt_x, opt_y) {

  if(Foo.instance_) {
    return Foo.instance_;
  }

  /**
   * @type {string}
   * @private
   */
  this.x_ = goog.isDefAndNotNull(opt_x) ? opt_x : 'default_X';

  /**
   * @type {string}
   * @private
   */
  this.y_ = goog.isDefAndNotNull(opt_y) ? opt_y : 'default_Y';

  Foo.instance_ = this;
};

/**
 * Get the singleton instance of Foo.
 * @param {string=} opt_x
 * @param {string=} opt_y
 */
Foo.getInstance = function(opt_x, opt_y) {
  if (Foo.instance_) {
    return Foo.instance_;
  }
  return new Foo(opt_x, opt_y);
}; 
```

使用这种模式的好处是，它可以防止您在有人编写时意外构造多个实例：

```
var foo = new Foo();

... 
// thousands of lines later
var snafoo = new Foo(); // Returns the singleton instance. 
```

# javascript - 如何在主导航中以不同的方式设置当前页面的样式？

> ID：11730385
> 
> 赞同：1
> 
> 时间：2012-07-30T22:07:24.543
> 
> 标签：javascript, html, css

假设我有一个带有导航栏的基本网站，其中包含一些链接。当我在一个页面上（比如使用条款）时，我希望导航栏中的“使用条款”链接突出显示。当我切换到不同的页面时，我希望突出显示该页面的链接（即我切换到隐私页面，然后在导航栏中突出显示“隐私”）。

有谁知道用 HTML/CSS/JS 做到这一点的简单方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T22:11:54.157

一种不使用 javascript 或 php 等的简单方法是在每个页面上的 body 标记中添加不同的类。

```
<body class="nav-1-on"> 
```

然后在你的css文件中：

```
body.nav-1-on a.nav-1, body.nav-2-on a.nav-2  { color:red ) 
```

因此，无论您拥有多少导航项目，您都需要 XXX 类，并且如图所示，您也可以在每个导航项目上放置一个类。

有道理？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-30T22:14:59.907

更新（大脑衰退，选择器错误）。对于 CSS3 浏览器，您可以轻松地定位页面名称本身：

```
a[href*=pageNameImOn.htm] {color: red;} 
```

此处将`*=`匹配其中包含的所有 href 路径`pageNameImOn.htm`，这将匹配：

```
<a href="/my/path/to/file/pageNameImOn.htm">
<a href="/pageNameImOn.htm">
<a href="/pageNameImOn.htm#interalJumpLink"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T22:09:37.053

对于想要为不同颜色的链接，可以手动设置样式

`<a style="color:red">My link is red</a>`

可能更好的方法是定义一个颜色为红色的类

`<style> .visited { color:red } </style>`

然后是实际的链接

`<a class="visited">My red link</a>`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-30T22:16:22.050

这个解决方案使用[jQuery](http://jquery.com/)，jQuery 只是一个为 javascript 编译的代码库，提供易于使用的代码片段和功能。

这绝对是实现您所追求的最简单的方法，尽管它是“客户端”，因此该类将由用户机器添加，而不是由服务器添加然后发送给用户。但是对于较小的站点，它应该就足够了。

发生了什么：此代码找到您的导航，在这里它正在寻找`li`of `.nav`，因此将 (' `.nav li`') 替换为您调用的菜单类，因此可能：`('.mymenu li')`。然后它会查看菜单链接是否与当前页面匹配，如果匹配，则向 li 添加一个类。所以还需要创建一个类`.active`，比如：`.active{background-color:blue;}`

希望这可以帮助！

```
<script type="text/javascript" charset="utf-8">
$(document).ready(function() {
  jQuery('.nav li').each(function() {
  var href = jQuery(this).find('a').attr('href');
  if (href === window.location.pathname) {
  jQuery(this).addClass('active');
}
});
});  
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-30T22:18:30.053

就是图个好玩儿。没有任何后端代码或 Javascript 的唯一解决方案`Single page`怎么样：`CSS3`

```
<ul>
     <li><a id="home" href="#home">Home</a></li>
     <li><a id="terms" href="#terms">Terms of use</a></li>
</ul> 
```

CSS

```
 li a { color: black; }     
 #home:target { color: red; }     
 #terms:target { color: red; } 
```

CSS 中的`:target`选择器将匹配与当前井号标签匹配的 ID 选择器。这里有更多信息：[http ://reference.sitepoint.com/css/pseudoclass-target](http://reference.sitepoint.com/css/pseudoclass-target)

对 Firefox、Safari、Opera 和 Chrome 的支持非常好。

对 IE9 和 IE10 的不完全支持：

> IE 不会对 Back 和 Forward 按钮做出反应：该元素根本不会应用或删除伪类。[http://www.quirksmode.org/css/contents.html](http://www.quirksmode.org/css/contents.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-31T01:39:26.793

在你的 body 上设置一个不同的 id 来识别页面。

```
<body id="terms-of-use"> 
```

一个示例导航：

```
<nav>
 <a class="home" href="#">Home</a>
 <a class="terms-of-use" href="#">Terms</a>
</nav> 
```

然后在你的CSS中：

```
nav a {
  // default style
  background: blue;
}

#terms-of-use a.terms-of-use {
 // if the id of body is terms-of-use then the link with the class .terms-of-use...
 background: red;
} 
```

# linux - std::exception(const char*) 非标准构造函数的替代方案

> ID：11730386
> 
> 赞同：12
> 
> 时间：2012-07-30T22:07:34.823
> 
> 标签：linux, visual-c++, g++, porting

我的 Visual C++ 代码使用接受字符串的 std::exception 构造函数，我正在尝试将代码移植到 Linux / G++。我应该使用什么异常类？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-30T22:10:31.590

Microsoft Visual C++ 的`std::exception(const char*)`构造函数是非标准的。虽然在 C++ 标准库中，std::exception 有一个`const char* what() const`方法，但它没有提供指定字符串的方法，除非通过覆盖。

您应该重写代码以使用`std::runtime_error`或使用其他类之一`<stdexcept>`作为替代方案。捕获 std::exception 的现有代码当然不需要更改，因为 std::runtime_error 是从它派生的。

# mysql - 找出两个表的差异

> ID：11730387
> 
> 赞同：0
> 
> 时间：2012-07-30T22:07:36.220
> 
> 标签：mysql, sql, join

我在数据库中有两个大表。它们都包含一个名为“名称”的列。我的目标是找到包含在一个数据库中但不在另一个数据库中的名称的行。

我猜会有一个join语句和一个where，但我不知道如何同时使用这两个语句来创建一个成功的查询。

建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T22:10:13.607

```
 SELECT * FROM TABLE_A WHERE NAME NOT IN 
   ( SELECT NAME FROM TABLE_B ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:34:58.137

EXISTS 可能比 IN 快，请参阅[SQL 中 EXISTS 和 IN 的区别？](https://stackoverflow.com/questions/24929/difference-between-exists-and-in-in-sql).

您可以像这样使用 EXISTS。了解这两种方法很有用，因为它们并不完全相等。您可以将 EXISTS 量词交换为[SOME、ALL 或 ANY](http://www.postgresql.org/docs/9.1/static/functions-subquery.html#FUNCTIONS-SUBQUERY-ANY-SOME)。我想你可以弄清楚会发生什么:)

```
select * from a1 where not exists(select 1 from a2 where name=a1.name); 
```

请注意，它们不是 100% 相等的！SQL具有[三值逻辑](http://weblogs.sqlteam.com/mladenp/archive/2007/05/18/60210.aspx)！

# c# - 该类型中不存在类型名称水晶报表

> ID：11730389
> 
> 赞同：0
> 
> 时间：2012-07-30T22:07:51.103
> 
> 标签：c#, winforms, c#-4.0, crystal-reports

此行未编译

```
this.CrystalReport11 = new ExpenseReport.CrystalReport1(); 
```

我在 Visual Studio 2010 上，在向我的应用程序添加水晶报告时遇到了这个问题。我已将框架从 .net 4 客户端配置文件更改为仅 .net 4，并添加了这一行

```
<startup useLegacyV2RuntimeActivationPolicy="true" > 
```

到 app.config 但仍然有问题。当我从头开始创建新应用程序时，不会发生这种情况。

任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T01:50:40.330

我也在 SAP 论坛上发布了这个，他们也无法提供解决方案。我发现解决此问题的唯一方法是重建应用程序并从一开始就将其更改为完整的 dotnet 4 框架。似乎在应用程序上工作并稍后从客户端配置文件切换是导致问题的原因。

解决方案：如果您打算使用水晶报表，请在启动应用程序之前更改您的框架！

# ios - 可可触摸保存播放列表

> ID：11730395
> 
> 赞同：2
> 
> 时间：2012-07-30T22:08:12.860
> 
> 标签：ios, cocoa-touch, audio-player

在 cocoa touch 4.x 中它可以创建或编辑音乐播放列表到 iphone/ipad 的默认/捆绑音乐应用程序中吗？如果是，代码将如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-02-20T17:03:08.240

最后，我找到了适用于 iOS 9.3 及更高版本的解决方案。您可以使用 MPMediaLibrary 来实现这一点。

```
// Setup your playlist metadata
__auto_type metadata = [[MPMediaPlaylistCreationMetadata alloc] initWithName:@"Playlist Name"];
metadata.authorDisplayName = @"My app name";
metadata.descriptionText = @"Playlist description";

// Save it to get the same playlist next time
NSUUID *uuid = [NSUUID UUID];

// Items to add to your playlist
NSArray<MPMediaItem *> *mediaItems = self.items;

// Get or create your playlist in Apple Music
[[MPMediaLibrary defaultMediaLibrary] getPlaylistWithUUID:uuid creationMetadata:metadata completionHandler:^(MPMediaPlaylist * _Nullable playlist, NSError * _Nullable error) {
    // Handle the error
    NSLog(@"Got error — %@", error);

    // You can add items to your playlist
    [playlist addMediaItems:mediaItems completionHandler:^(NSError * _Nullable addError) {
        // Handle the error
        NSLog(@"finished! error — %@", addError);
    }];
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:17:12.847

您可以通过创建s来访问 iPod 库（ [iPod 库访问编程指南）中的信息。](http://developer.apple.com/library/ios/#documentation/Audio/Conceptual/iPodLibraryAccess_Guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008765)`MPMediaQuery`这将允许您检索播放列表（使用`MPMediaPickerControllerDelegate`），但我认为您无法创建播放列表，因为您只能获得只读访问权限（以及播放）。

# mysql - 离开加入同一个表但具有不同的值？

> ID：11730398
> 
> 赞同：0
> 
> 时间：2012-07-30T22:08:21.400
> 
> 标签：mysql

**Table_A**有**entity_id**

**Table_B**有一个相关的**entity_id**，**attribute_id** = 1

**Table_B**有一个相关的**entity_id**，**attribute_id** = 2

```
 SELECT Table_B.value
    FROM  Table_A
    LEFT JOIN Table_B
    ON Table_A.entity_id = Table_B.entity_id
    WHERE Table_A.date =  '2012-7-30 00:00:00'
    AND Table_B.attribute_id = 1 
```

我想将attribute_id = 1 和attribute_id = 2 放入一个查询中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:16:08.697

您可以再次加入 Table_B 并使用 AS 给它一个新名称（别名）。

```
SELECT Table_B.value, Table_B2.value
FROM  Table_A
LEFT JOIN Table_B
ON Table_A.entity_id = Table_B.entity_id
LEFT JOIN Table_B AS Table_B2
ON Table_A.entity_id = Table_B2.entity_id
WHERE Table_A.date =  '2012-7-30 00:00:00'
AND Table_B.attribute_id = 1
AND Table_B2.attribute_id = 2 
```

您还可以移动属性标准以使其更清楚您的目标：

```
SELECT Table_B.value, Table_B2.value
FROM  Table_A
LEFT JOIN Table_B
ON Table_A.entity_id = Table_B.entity_id AND Table_B.attribute_id = 1
LEFT JOIN Table_B AS Table_B2
ON Table_A.entity_id = Table_B2.entity_id AND Table_B2.attribute_id = 2
WHERE Table_A.date =  '2012-7-30 00:00:00' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T03:23:34.870

好吧，您可以通过两种简单的方法简单地做到这一点

```
select 
    t1.entity_id,
    t2.attribute
from t1
left join t2 on t2.entity_id = t1.entity_id; 
```

或者

```
select 
    t1.entity_id,
    group_concat(t2.attribute) as Attr
from t1
left join t2 on t2.entity_id = t1.entity_id
group by t1.entity_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T04:20:42.113

如果您想同时获得attribute_id = 1 和2，为什么不使用OR 作为条件呢？

```
SELECT Table_B.value
FROM  Table_A
LEFT JOIN Table_B
ON Table_A.entity_id = Table_B.entity_id
WHERE Table_A.date =  '2012-7-30 00:00:00'
AND (Table_B.attribute_id = 1 OR Table_B.attribute_id = 2) 
```

# c# - 用正则表达式中的任何内容替换所有命名的捕获组

> ID：11730400
> 
> 赞同：0
> 
> 时间：2012-07-30T22:08:27.790
> 
> 标签：c#, regex, replace

**假设我有这个主题：**

```
////////File description////////
Name: SomeFile.cs
Size: 234
Description: Foo
Date: 08.14.2012
/////////////////////////////// 
```

**我怎样才能使那个主题变成：**

```
////////File description////////
Name: 
Size: 
Description: 
Date:
/////////////////////////////// 
```

* * *

**现在我执行以下操作：**

```
var pattern = 
@"(/+File description/+
Name: )(?<name>.+)(
Size: )(?<size>.+)(
Description: )(?<des>.+)(
Date: )(?<date>.+)(
/+)";

// subject = fist code at top of this questoin

var temp = Regex.Replace(subject,pattern,"$1$2$3$4$5"); 
```

**图案很乱**

* * *

* * *

## 现在我的问题是：

**我想要这样的模式：**

```
/+File description/+
Name: (?<name>.+)
Size: (?<size>.+)
Description: (?<des>.+)
Date: (?<date>.+)
/+ 
```

**我想知道是否可以替换组`name`，`size`. 等一无所有**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:16:51.193

您可以简单地用空描述重写文件，除非您在同一个文件中有多个主题。

您可以通过以下方式做到这一点：

```
string text = "/////////////File description/////////////\nName:\nSize:\nDescription:\nDate:\n//////////////////////////";
System.IO.File.WriteAllText(@"X:\Path\to\your\file.whatever", text); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:55:31.970

这可能比您想要的更复杂，但您可以尝试使用 MatchEvaluator。MatchEvaluator 计算每个匹配项的替换字符串。而且 MatchEvaluator 可以访问“Match”对象，所以它可以做一些有趣的事情，只受你的想象力的限制......

```
 var pattern =
@"/+File description/+ 
Name: (?<name>.+) 
Size: (?<size>.+) 
Description: (?<des>.+) 
Date: (?<date>.+) 
/+";
        var temp = Regex.Replace(data, pattern, new MatchEvaluator(eval));
        Console.WriteLine("{0}", temp);
    //...
    string eval(Match mx)
    {
        Stack<Group> stk = new Stack<Group>();
        for(int i=1; i<mx.Groups.Count; ++i)
            stk.Push(mx.Groups[i]);

        string result = mx.Groups[0].Value;
        int offt = mx.Index;
        while(stk.Count > 0)
        {
            var g = stk.Pop();
            int index = g.Index - offt;
            result = result.Substring(0,index) + result.Substring(index+g.Length);
        }
        return result;
    } 
```

使用 MatchEvaluator 的另一种方法看起来像这样（并且应该适用于您的模式或我的模式）。

```
 string eval2(Match mx)
    {
        string data = mx.Value;
        data = Regex.Replace(data, "Name: .+", "Name: ");
        data = Regex.Replace(data, "Size: .+", "Size: ");
        data = Regex.Replace(data, "Description: .+", "Description: ");
        data = Regex.Replace(data, "Date: .+", "Date: ");
        return data;
    } 
```

这是有效的，因为您要在匹配中替换。即，您的外部匹配缩小了搜索范围，而您的个人替代品没有机会替换错误的东西。如果您使用这种方法，您的外部模式会更简单，因为不需要组。

# java - 需要使用 sudo 用户执行脚本文件 - 从 teamcity 运行

> ID：11730401
> 
> 赞同：2
> 
> 时间：2012-07-30T22:08:28.367
> 
> 标签：java, ant, exec, teamcity, sudo

我需要使用另一个 ant 脚本“build.xml”在 Linux 平台“runme.sh”（可以作为 sudo 用户执行）中执行一个脚本。现在我已经从 teamcity 执行了这个 build.xml。

我有所有的代码，但是在使用来自团队城市的 build.xml 中的 sudo 调用“runme.sh”时遇到了麻烦。

在 build.xml 我有类似的代码

```
 <exec dir="${installdir}" executable="/bin/sh">
        <arg line="-c 'sudo ./runme.sh'"/>
        <redirector inputstring="sudopassword"/>        
    </exec> 
```

在团队城市中，我收到错误为“ [exec] sudo：抱歉，您必须有一个 tty 才能运行 sudo”。

有人可以帮我解决这个错误吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:16:45.330

`requiretty`您的机器已启用该选项的 sudo 设置。您可以禁用此选项，但它会造成安全漏洞；一个更好的解决方案是`su --session-command`改用。有关更详细的说明，请参阅[此链接。](http://maymay.net/blog/2010/03/17/how-to-work-around-sorry-you-must-have-a-tty-to-run-sudo-without-sacrificing-security/)

# php - 在 Onepage Checkout 中编辑运输方式

> ID：11730403
> 
> 赞同：3
> 
> 时间：2012-07-30T22:08:47.333
> 
> 标签：php, magento, checkout, magento-1.6

我正在编辑结帐并想修改运输方式的显示。我遇到了 call block `$this->getChildHtml('available')`，但没有找到对应 phtml 的文件。

我还在购物车中保存了一个会话变量。这个变量在整个购买过程中都可用吗？在什么时候会话变量与购物车“清理”相关？

观察：CE 1.6.1.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T00:43:13.983

可用的运输方式块在[checkout.xml](https://github.com/LokeyCoding/magento-mirror/blob/1.6.1.0/app/design/frontend/base/default/layout/checkout.xml#L327)布局文件中声明 - 使用的模板是`checkout/onepage/shipping_method/available.phtml`.

成功签出后（或者如果会话超时），会话在[Mage_Checkout_OnepageController::successAction()](https://github.com/LokeyCoding/magento-mirror/blob/1.6.1.0/app/code/core/Mage/Checkout/controllers/OnepageController.php#L227)中被清除。

# typo3 - TYPO3：在 Kickstarter 上创建一个新的注册类型并将其与 tt_news 一起使用

> ID：11730405
> 
> 赞同：0
> 
> 时间：2012-07-30T22:08:52.287
> 
> 标签：typo3, tt-news

所以我在TYPO3上有这个挑战。tt_news 中的每个条目都必须有一个带有图像和视频的幻灯片。所有图像旁边还有一个导航。视频当然必须有一个小的“海报”图像。

我想不出任何方法可以用 tt_news 原生地做到这一点，所以我认为最好的方法是制作一个新的记录类型，比如“幻灯片项目”，您可以在其中上传带有海报图像的图像或视频，然后扩展 tt_news带有一个组合框，您可以在其中将要添加的项目添加到该 tt_news 条目的滑块中。

我的问题是：如何创建新的记录类型？我在 Kickstarter 上上下看了看，但我还没有找到办法。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T07:11:20.890

要在后端创建新记录类型，您只需使用 Kickstarter 创建一个新表。这将自动添加一个带有您创建的表名称的新记录类型，您可以在 SysFolder（或其他页面，如果这样配置）下创建它

# jquery - jquery动态读取div字段并更新

> ID：11730415
> 
> 赞同：1
> 
> 时间：2012-07-30T22:09:30.237
> 
> 标签：jquery, html

如果我有 2 个字段输入并且 #pricein 字段输入是用另一个脚本动态填充的数字。

```
<form>
    How much do you want to spend 
    <input type="text" readonly="readonly" id="pricein"/>
    <br /> 
    This is how much you will spend
    <input type="text" readonly="readonly" id="priceout"/> 
</form> 
```

如何让 jquery 在该数字更改时读取该数字并将其显示在#priceout 字段中？触发它的 onclick 或按键将不起作用，因为它会在没有任何操作的情况下更改。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:12:54.947

你可以使用 jQuery 的 change() 吗？ [http://api.jquery.com/change/](http://api.jquery.com/change/)

```
 $(function(){
       $("#pricein").change(function() {
          $("#priceout").val($(this).val());
       })
    }) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:14:24.860

由于您`#pricein`是动态创建的，因此您需要[**`.on()`**](http://api.jquery.com/on)委托事件绑定，如下所示：

```
 $("form").on("keyup", "#pricein", function() {
    $("#priceout").val( this.value ); // OR $(this).val()
 }); 
```

实时事件委托的语法`.on()`是：

```
$(StaticParent).on( eventName, target, handlerFunction ) 
```

其中，`StaticParent`是任何非动态且`target`元素的父级的选择器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T22:39:44.897

对于以编程方式更改的值，您无法通过事件检测到它。相反，与其他脚本的代码集成。如果它不受您的直接控制，请在其他脚本应该运行时运行您的代码。例如，点击某个元素。如果这是不可能的，并且另一个脚本确实不可预测，作为最后的手段，您可以使用计时器。

```
(function (){
    var lastValue = $("#pricein").val();
    setInterval(function() {
        if ($("#pricein").val() != lastValue)
            lastValue = $("#pricein").val();
            valueChanged();
        }
    }, 500);
})(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T22:37:00.503

您可以访问初始脚本吗？如果是这样，您是否可以像这样触发 keyup 操作：

[http://jsfiddle.net/WRMyX/1/](http://jsfiddle.net/WRMyX/1/) （谢谢，gilly3）

# python - django urlpatterns 的相对前缀？

> ID：11730421
> 
> 赞同：2
> 
> 时间：2012-07-30T22:09:49.757
> 
> 标签：python, django, url, url-pattern

我试着做类似的事情

```
urlpatterns = patterns('.persons.views',

) 
```

在我的 urls.py 文件中，目录看起来像

```
main folder
\profile
    \person
        urls.py <- this is the file
    urls.py 
```

但我收到错误“相对导入需要'包'参数”

我可以做'profiles.persons.view'作为前缀，但我想尝试做一个相对前缀，比如相对导入。我该如何解决这个问题，以使相对前缀有效？我正在使用 django 1.4 和 python 2.7。

# ruby-on-rails - 安装 ruby debug19。编译器无法生成可执行文件

> ID：11730422
> 
> 赞同：2
> 
> 时间：2012-07-30T22:09:51.040
> 
> 标签：ruby-on-rails, ruby

我正在尝试安装 ruby​​ debug 19，以便可以运行 spork。尽管这非常令人沮丧，但我遇到了错误。我用谷歌搜索了一段时间无济于事。我正在运行 1.9.3-p194。

这是错误消息：

构建原生扩展。这可能需要一段时间... 错误：安装 ruby​​-debug19 时出错：错误：无法构建 gem 原生扩展。

```
 /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb
checking for rb_method_entry_t.body in method.h... *** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
--with-opt-dir
--with-opt-include
--without-opt-include=${opt-dir}/include
--with-opt-lib
--without-opt-lib=${opt-dir}/lib
--with-make-prog
--without-make-prog
--srcdir=.
--curdir
--ruby=/Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/bin/ruby
--with-ruby-dir
--without-ruby-dir
--with-ruby-include
--without-ruby-include=${ruby-dir}/include
--with-ruby-lib
--without-ruby-lib=${ruby-dir}/lib
/Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)
You have to install development tools first.
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `block in try_compile'
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:443:in `with_werror'
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `try_compile'
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1002:in `block in have_struct_member'
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'
from /Users/jasonvdm/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1001:in `have_struct_member'
from extconf.rb:10:in `block in <main>'
from /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/ruby_core_source-0.1.5/lib/ruby_core_source.rb:18:in `call'
from /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/ruby_core_source-0.1.5/lib/ruby_core_source.rb:18:in `create_makefile_with_core'
from extconf.rb:24:in `<main>' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T20:47:43.927

我遇到了类似的问题，但是在安装`nokogiri`gem 时，我用以下方法解决了它：

```
cd /usr/bin
sudo ln -s llvm-gcc-4.2 gcc-4.2 
```

请参阅[OS X lion 升级后捆绑更新和安装失败 - Rails 3](https://stackoverflow.com/questions/6935146/bundle-update-install-fail-after-os-x-lion-upgrade-rails-3#comment17543337_6935489)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T06:14:57.860

请改用调试器 gem。ruby-debug19 从不支持 ruby​​1.9.3

# exception-handling - AllegroServe 异常处理

> ID：11730424
> 
> 赞同：4
> 
> 时间：2012-07-30T22:09:57.900
> 
> 标签：exception-handling, lisp, common-lisp, allegro-cl

将无效主机作为参数传递给函数[do-http-request](http://www.franz.com/support/documentation/current/doc/aserve/aserve.html#f-do-http-request)时，如何避免出现错误。
有什么方法可以像 Java 的异常处理机制那样捕获错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T04:07:07.477

当然，CL 有一个非常好的条件系统。一个简单的选择是包装对`do-http-request`in的调用，如果在包装的代码中发出错误条件信号[`ignore-errors`](http://www.lispworks.com/documentation/HyperSpec/Body/m_ignore.htm)，它将返回`nil`（并将条件作为第二个值）。之后你就可以检查`nil`了。

如果你想要一些更像 Java 中的异常处理的东西，只需使用[`handler-case`](http://www.lispworks.com/documentation/HyperSpec/Body/m_hand_1.htm)并添加一个适当的错误子句（我没有安装 AllegroServe，但我想你会`socket-error`因为提供错误的 URL 而得到一个 - 如果我读错了，只需更改该部分）：

```
(handler-case
    (do-http-request …)
  (socket-error ()
    …)) 
```

如果您需要`finally`类似功能，请使用[`unwind-protect`](http://www.lispworks.com/documentation/HyperSpec/Body/s_unwind.htm)：

```
(unwind-protect
     (handler-case
         (do-http-request …)
       (socket-error (condition) ; bind the signalled condition
         …)                      ; code to run when a socket-error was signalled
       (:no-error (value)        ; bind the returned value
         …))                     ; code to run when no condition was signalled
  …)                             ; cleanup code (finally) 
```

您甚至可以变得更花哨，例如[`handler-bind`](http://www.lispworks.com/documentation/HyperSpec/Body/m_handle.htm)，通过调用堆栈下方某处的重新启动来向上处理条件堆栈，而无需展开它。例如，如果`do-http-request`提供了重新启动以使用另一个 URL 重试，您可以通过使用新 URL 调用该重新启动来重试来处理您的错误情况。我只是为了完整起见而提到这一点——这对你的用例来说太过分了，但是能够轻松地恢复（可能是昂贵的）计算可能是一个相当方便的功能。

# android - OnGestureListener onDown 方法永远不会被调用

> ID：11730425
> 
> 赞同：1
> 
> 时间：2012-07-30T22:09:59.770
> 
> 标签：android, gesture

我的`onScroll`和被`onTouchEvent`调用，但不是`onDown`方法。事实上，当我登录时，我`distaceX`会注销其中的`onDown`几个，而第一个总是相对于我结束最后一个滚动的位置。

```
 @Override 
 public boolean onTouchEvent(MotionEvent me){ 
   this.detector.onTouchEvent(me);

  return super.onTouchEvent(me); 
 }

 @Override
 public boolean onDown(MotionEvent e) {
       Log.d("---onDown---",".");
   return false;

 }

 @Override
 public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX,
   float distanceY) {
  Log.d("---onScroll---", "" + distanceX);
  return false;
 } 
```

任何想法为什么`onDown`不被调用？

编辑：

我将我的更改`onTouchEvent`为以下块，并且只有 ACTION_MOVE 被记录。

```
 float gestureDistance = 0;
 @Override 
 public boolean onTouchEvent(MotionEvent me){ 
     switch (me.getAction() & MotionEvent.ACTION_MASK) {
        case MotionEvent.ACTION_DOWN:               
            Log.d("actionDown", "gestureDistance:" + gestureDistance);
            break;
        case MotionEvent.ACTION_UP:
            Log.d("actionUp", "gestureDistance:" + gestureDistance);
            break;
        case MotionEvent.ACTION_MOVE:
            Log.d("actionMove", "gestureDistance:" + gestureDistance);
            break;
        default:
            Log.d("action default", "default");
            break;
    } 
```

编辑：我认为问题在于我的视图是 WebView。我可以阻止 webview 窃取我的事件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:57:13.953

将此添加到我`onCreate`的解决方案中。

```
 webView.setOnTouchListener(new View.OnTouchListener() {

        public boolean onTouch(View v, MotionEvent event) {
           detector.onTouchEvent(event);
            return true;
        }
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:40:21.710

你为什么不做类似的事情：

```
@Override
public boolean onTouchEvent(MotionEvent event) {        

    switch (event.getAction() & MotionEvent.ACTION_MASK) {
        case MotionEvent.ACTION_DOWN:               
            //Do something on action down.
        case MotionEvent.ACTION_UP:
            //Do something on action up.
            break;
        case MotionEvent.ACTION_MOVE:
            //Do something when moving.
            break;
    }   

    return true;
} 
```

希望这可以帮助。

# actionscript-3 - 来自动态文本字段的 AS3 函数调用

> ID：11730441
> 
> 赞同：2
> 
> 时间：2012-07-30T22:11:39.837
> 
> 标签：actionscript-3, flash

我正在尝试从动态文本字段调用 as3 函数。

我试过这个：

```
function showPopupWindow(){
    trace("it works");
}

var texts="Hello world. <a href='#' onclick='showPopupWindow()'><u>This is a function call</u></a>";

text_txt.htmlText = texts; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T23:55:05.007

您必须使用该`TextEvent.LINK`事件。首先，您需要创建一个链接，该链接指向 Flash 可以通过添加`event:`到名称前面来识别的 URL。例如，您可能有这样一段文字：

```
textField.htmlText = "<a href='event:playMovie'>Play.</a><br />" + 
                     "<a href='event:stopMovie'>Stop.</a>"; 
```

然后，您需要为该事件添加一个侦听器。您可以使用该`TextEvent::text`属性来确定单击了哪个链接。使用上面的代码，这是一个示例处理程序：

```
textField.addEventListener(TextEvent.LINK, handleLink);

function handleLink(evt:TextEvent):void {
    switch (evt.text) {
        case "playMovie":
            play();
            break;
        case "stopMovie":
            stop();
            break;
    }
} 
```

# arrays - 如何将单列电子邮件从 html textarea 获取到数组中

> ID：11730445
> 
> 赞同：0
> 
> 时间：2012-07-30T22:11:51.783
> 
> 标签：arrays, perl

我想我可以自己做，但我需要一些帮助。

我需要将本地乐队邮件列表中的电子邮件地址列表粘贴到 textarea 中，并在我的 Perl 脚本中处理它们。

电子邮件都在一个列中；由换行符分隔：

```
email1@email.com
email2@email.com
email3@email.com
email4@email.com
email5@email.com 
```

我显然想摆脱任何空白：

```
$emailgoodintheory =~ s/\s//ig; 
```

我正在通过基本验证运行它们：

```
if (Email::Valid->address($emailgoodintheory)) { #yada 
```

我尝试了各种方法将列表放入数组中。

```
my $toarray = CGI::param('toarray');
my @toarraya = split /\r?\n/, $toarray;
foreach my $address(@toarraya) {
    print qq~ $address[$arrcnt]<br /> ~:
    $arrcnt++;
} 
```

以上只是为了测试我是否成功。我不需要打印它们。它只是循环，获取时间表 .txt 文件并向每个成员发送乐队时间表。所有其他东西都有效，但我无法将 textarea 放入数组中！

所以，如你所见，我很迷茫。

谢谢老师，我可以再上一堂简单的课吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:06:56.767

您似乎对 Perl 有点陌生，所以我将彻底解释为什么您的代码不好以及如何改进它：

### 1 命名约定：

我看到这似乎是符号代码，但`$emailgoodintheory`比`$emailGoodInTheory`or可读性差得多`$email_good_in_theory`。选择任何方案并坚持下去，只是不要全部小写。

我想它`$emailgoodintheory`拥有一个电子邮件地址。然后应用正则表达式`s/\s//g`或音译`tr/\s//`就足够了；空格字符不区分大小写。

使用模块来验证地址是一个非常好的主意。:-)

### 2 Perl 数据类型

Perl 有三种 man 类型的变量：

*标量*可以保存字符串、数字或引用。它们由`$`印记表示。

*数组*可以保存有序的标量序列。它们由`@`印记表示。

*哈希*可以保存一组无序的标量。有些人倾向于将它们称为字典。所有键和值都必须是标量。哈希由`%`印记表示。

关于*上下文*的一句话：从哈希/数组中获取值/元素时，您必须将印记更改为您想要的数据类型。通常，我们只恢复一个值（它总是一个标量），所以你写`$array[$i]`or `$hash{$key}`。这不遵循任何参考，所以

```
 my $arrayref = [1, 2, 3];
 my @array = ($arrayref);
 print @array[0]; 
```

不会打印`123`，但`ARRAY(0xABCDEF)`会给你一个警告。

### Perl 中的 3 个循环：

你的循环语法很奇怪！您可以使用 C 风格的循环：

```
for (my $i = 0; $i < @array; $i++) 
```

where`@array`给出了数组的长度，因为我们有一个*标量 context*。您还可以给出`$i`数组中所有可能索引的范围：

```
for my $i (0 .. $#array) 
```

where`..`是范围运算符（在*列表上下文中*）并`$#array`给出我们数组的最高可用索引。我们还可以使用*foreach*循环：

```
foreach my $element (@array) 
```

请注意，在 Perl 中，关键字`for`and`foreach`是可以互换的。

### 4 你的循环做什么：

```
foreach my $address(@toarraya) {
   print qq~ $address[$arrcnt]<br /> ~:
   $arrcnt++;
} 
```

在这里，您将 的每个元素`@toarraya`放入 scalar`$address`中。然后您尝试将其用作数组（错误！）并从中获取索引`$arrcnt`。这不起作用；我希望你的程序`die`d。

您可以使用上面给出的每种循环类型（您不需要手动计数），但标准`foreach`循环最适合您：

```
foreach my $address (@toarraya){
   print "$address<br/>\n";
} 
```

关于引用语法的注释：虽然`qq~ quoted ~`绝对合法，但这是我今天看到的最模糊的代码。标准引号`"`就足够了，使用 时`qq`，请尝试使用某种括号 ( `({[<|`) 作为分隔符。

### 5 完整代码：

我假设你想写这个：

```
my @addressList = split /\r?\n/, CGI::param('toarray');

foreach my $address (@addressList) {

   # eliminate white spaces
   $address =~ s/\s//g;

   # Test for validity
   unless (Email::Valid->address($address)) {
      # complain, die, you decide
      # I recommend:
      print "<strong>Invalid address »$address«</strong><br/>";
      next;
   }

   print "$address<br/>\n";
   # send that email
} 
```

永远不要忘记`use strict; use warnings;`和可能`use utf8`。

# objective-c - 如何在objective-c中使用自定义单元格

> ID：11730451
> 
> 赞同：0
> 
> 时间：2012-07-30T22:12:23.920
> 
> 标签：objective-c, ios, xcode, uitableview

我想在 uiTableView 的一行中创建 4 个单元格“按钮或图片”，如下图所示：

但我不知道该怎么做：

你能帮帮我吗！提前致谢！

这是我的代码：

```
- (void)viewDidLoad
{
[super viewDidLoad];
NSMutableArray *keys = [[NSMutableArray alloc] init];
NSMutableDictionary *contents = [[NSMutableDictionary alloc] init];

NSString *monKey = @"Monday";
NSString *tueKey = @"Tuesday";
NSString *wedKey = @"Wednday";
NSString *thuKey = @"Thusday";
NSString *friKey = @"Friday";
NSString *satKey = @"Satuarday";
NSString *sunKey = @"Sunnday";

[contents setObject:[NSArray arrayWithObjects:@"Work Time", @"Absence", nil] forKey:monKey];
[contents setObject:[NSArray arrayWithObjects:@"Compensation", @"Work Time", @"Absence", nil] forKey:wedKey];
[contents setObject:[NSArray arrayWithObjects:@"Compensation", @"Work Time", nil] forKey:tueKey];
[contents setObject:[NSArray arrayWithObjects:@"Compensation", @"Work Time", nil] forKey:thuKey];
[contents setObject:[NSArray arrayWithObjects:@"Compensation", @"Work Time", nil] forKey:friKey];
[contents setObject:[NSArray arrayWithObjects:@"Compensation", @"Work Time", nil] forKey:satKey];
[contents setObject:[NSArray arrayWithObjects:@"Compensation", @"Work Time", nil] forKey:sunKey];

[keys addObject:tueKey];
[keys addObject:monKey];
[keys addObject:wedKey];
[keys addObject:thuKey];
[keys addObject:friKey];
[keys addObject:satKey];
[keys addObject:sunKey];

[self setSectionKeys:keys];
[self setSectionContents:contents];

self.navigationItem.leftBarButtonItem = self.editButtonItem;
UIBarButtonItem *rightButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAdd  
target:self action:@selector(addNewItem)];
self.navigationItem.rightBarButtonItem = rightButton;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

NSString *key = [[self sectionKeys] objectAtIndex:[indexPath section]];
NSArray *contents = [[self sectionContents] objectForKey:key];
NSString *contentForThisRow = [contents objectAtIndex:[indexPath row]];

static NSString *CellIdentifier = @"CellIdentifier";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil)
{
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault 
reuseIdentifier:CellIdentifier];
}

[[cell textLabel] setText:contentForThisRow];    
int column = 4;
for (int i=0; i<column; i++) {

    UIImageView *aBackgroundImageView = [[UIImageView alloc]initWithFrame:CGRectMake(32+184*i,10, 167,215)];
    aBackgroundImageView.tag = (column*indexPath.row)+i;
    [cell.contentView addSubview:aBackgroundImageView];
 //   [aBackgroundImageView release];
}
return cell;

}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {

if(section == 0)
    return @"Monday";
else if(section == 1){
    return @"Tuesday";
}else if(section == 2){
    return @"Wednesday";
} else if(section == 3){
    return @"Thuesday";
} else if(section == 4){
    return @"Friday";
} else if(section == 5){
    return @"Saturday";
}else
    return @"Sunday";

} 
```

**编辑 1**

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
cell = [[UITableViewCell alloc] initWithFrame:CGRectZero]; 
}
cell.selectionStyle = UITableViewCellSelectionStyleNone;

int column = 4;
for (int i=0; i<column; i++) {

UIImageView *aBackgroundImageView = [[UIImageView alloc]initWithFrame:CGRectMake(32+184*i,10, 167,215)];
aBackgroundImageView.tag = (column*indexPath.row)+i;
[cell.contentView addSubview:aBackgroundImageView];

}
  return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:58:57.050

如果不需要用户交互，可以将它们添加到 UIView（每个都是带有适当框架的子视图），并使容器查看单元格的背景视图。

您可以将视图直接添加到单元格的 contentView 并获得用户交互，但您必须小心，因为如果有附件视图等，该区域会被修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T06:45:45.417

您可以在 Xcode 中设计一个带有 4 个按钮的自定义单元格并将它们映射到 tableview

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T08:12:46.870

在界面构建器中设计自定义单元格并布置 4 个按钮（因为您需要用户交互）会更容易。这是一个很好的[教程](http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1)，可以帮助您入门。为每个按钮指定一个标签号，以便您知道稍后点击了哪个按钮。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-01T13:56:12.527

想在 uiTableView 的一行中创建 4 个单元格“按钮或图片”，如下图所示：

但我不知道该怎么做：

首先，您需要创建一个名为 MyCell 的 Objective-c 类。MyCell 将是 UITableViewCell 的子类（这非常重要）在您的 MyCell.h 中，

> ```
>  @interface MyCell : UITableViewCell 
> ```
> 
> > ```
> > @property (nonatomic, weak) IBOutlet UIButton *firstButton;
> > @property (nonatomic, weak) IBOutlet UIButton *secondButton; 
> > @property (nonatomic, weak) IBOutlet UIButton *thirdButton;  
> > @property (nonatomic, weak) IBOutlet UIButton *fourthButton;
> >   @end 
> > ```

然后在您的 MyCell.m 中，合成所有这些按钮。

在您想要使用自定义单元格的表格视图中，您需要修改 cellForRowAtIndexPath 方法。**用您的自定义 MyCell 替换您的 UITableViewCell**。并且不要忘记将“MyCell.h”导入您正在使用的表格视图中。

> ```
>  - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
>         static NSString *CellIdentifier = @"Cell";
>         MyCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
> 
> if(!cell)
> {
>     cell = [[MyCell alloc]initWithStyle:UITableViewCellStyleDefault 
> ```
> 
> 重用标识符：细胞标识符]；}
> 
> ```
> [cell.firstButton setTintColor:[UIColor redColor];
> [cell.secondButton setTintColor:[UIColor redColor];
> // and so on.. til you set all your four buttons.
> 
> return cell; } 
> ```

从那里，您的表格视图应该显示您的自定义单元格。

# python - 中断在循环python之外

> ID：11730452
> 
> 赞同：-1
> 
> 时间：2012-07-30T22:12:29.193
> 
> 标签：python, loops, if-statement, break

```
while True:
    x = raw_input()
    if x =="personal information": 
         print' Edward , Height: 5,10 , EYES: brown , STATE: IL TOWN:  , SS:'
    elif x =="journal":
         name_of_file = raw_input("What is the name of the file: ")
         completeName = "C:\\python\\" + name_of_file + ".txt"
         file1 = open(completeName , "w")
         toFile = raw_input("Write what you want into the field")
         file1.write(toFile)
         file1.close()
else:
 break 
```

脚本不断给我一个错误，说break在循环之外是缩进错误吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T22:14:12.700

是的，看你的帖子。您的`else`可能意味着要使用`if`语句的缩进级别。

`else`语句的`while`语句做完全不同的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:19:20.613

不，这不是识别错误。您通常会“跳出”循环。while 语句中的 else 部分不是循环结构。如果你这样做，你会发现同样的错误

```
In [12]: if True:
   ....:    break

SyntaxError: 'break' outside loop 
```

# google-drive-api - 使用 Google Drive API v2 澄清 maxResults 和 nextPageToken

> ID：11730454
> 
> 赞同：13
> 
> 时间：2012-07-30T22:12:34.283
> 
> 标签：google-drive-api

我只是想澄清一下 Google Drive API 的 Files: list 功能：

[https://developers.google.com/drive/v2/reference/files/list](https://developers.google.com/drive/v2/reference/files/list)

maxResults 可以指定的最大值是多少？我假设这个值计算下一页结果的结果数？

此外， nextPageToken 是否只是查询字符串的一部分，需要与 nextLink 一起传递以获取下一页结果？

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-01T21:08:14.143

查询参数可`maxResults`用于限制（或增加）列表请求中返回的项目数。我们的服务器设置了默认值和硬限制。不幸的是，我们通常不会记录这些数字，因为它们很容易更改，并建议开发人员在结果集合中查找`nextPageToken`和/或`nextLink`以了解是否所有项目都已退回。

该`nextPageToken`属性将用作`pageToken`列表请求的查询参数。如果您使用`nextLink`结果集合中的 ，则不需要指定`pageToken`查询参数，因为它应该已经包含在内。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-07T19:06:29.517

根据此页面，maxResults 不能大于 1000：[https ://developers.google.com/drive/v2/reference/files/list](https://developers.google.com/drive/v2/reference/files/list)

# delphi - 将 OpenGL 库添加到 Delphi xe2

> ID：11730455
> 
> 赞同：2
> 
> 时间：2012-07-30T22:12:37.337
> 
> 标签：delphi, opengl, delphi-xe2

我想使用 Delphi 学习 OpenGL 但从未向 Delphi 添加库，甚至确定这是否是您需要做的？任何人都提供了一些关于如何将openGL添加到delphi的步骤，以便我可以在使用部分中调用它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T22:52:08.940

您需要一个用于声明所需类型和函数的 dll 的包装器`OpenGL`，然后从您的 Delphi 代码中调用这些函数。VCL 在 中包含一个有限的（和通用的）包装器`OpenGL.pas`，但有更好的可用。

Delphi 的流行包装器之一是开源[GLScene](http://sourceforge.net/projects/glscene/)，它包括演示和包装器单元。它还包括您在表单上放置的可视化组件，就像任何其他 Delphi 组件一样。上面的链接是针对 SourceForge 项目的；[GLScene 网站](http://glscene.sourceforge.net/wikka/HomePage)有更多信息，包括文档和常见问题解答。

# ruby - 使用 MiniMagick 编写带有标题方法的字符串

> ID：11730459
> 
> 赞同：4
> 
> 时间：2012-07-30T22:13:11.583
> 
> 标签：ruby, imagemagick, minimagick

我正在尝试在图像上写一个字符串。目前我正在使用 MiniMagick，我可以调整两个图像的大小并重叠，但是当我尝试使用标题编写多行字符串时，最终图像没有任何反应，它仍然和以前一样。

这是我当前的代码：

```
image = MiniMagick::Image.open('template.jpg')
image.combine_options do |c|
  c.background '#0008'
  c.fill '#666'
  c.gravity 'center'
  c.size '100x50'
  c.caption "Lets write some big string here... zzzzz I hope this work =)"
end
image.write('final.jpg') 
```

我的参考资料： [http ://www.imagemagick.org/Usage/annotating/](http://www.imagemagick.org/Usage/annotating/)

[ImageMagick 多行文本和背景图像](https://stackoverflow.com/questions/10353401/imagemagick-multiline-text-and-background-image)

[http://www.imagemagick.org/www/command-line-options.html#caption](http://www.imagemagick.org/www/command-line-options.html#caption)

谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T02:12:01.760

我结束了使用系统调用来解决这个问题，这里是代码：

```
Subexec.run "convert -background '#fff0' \\
  -fill '#003300' \\
  -gravity west \\
  -size 560x180 \\
  -pointsize 19 \\
  -font \'#{font_path}\' \\
  caption:\"#{caption}\" \\
  #{photo_path} \\
  +swap \\
  -gravity NorthWest \\
  -geometry +333+113 \\
  -composite #{photo_path}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-14T05:41:21.873

You need to use Convert with MiniMagick. And caption is great because it will wrap and adjust according to the size, as long as you don't put in `pointsize`. The syntax is a little tricky though because there aren't many Rails examples out there.

```
file = Paperclip::Tempfile.new(["processed", ".jpg"])

MiniMagick::Tool::Convert.new do |img|
  img.background '#0008'
  img.fill '#666'
  img.gravity 'center'
  img.size '100x50'
  img << "caption: Lets write some big string here... zzzzz I hope this work =)"
  img << file.path
 end

model.picture = file
model.save
file.unlink 
```

Note: You have to add file path last

# visual-c++ - 从 LIBCMTD.lib 引用的未解析的外部符号 __Atomic_fetch_add_4

> ID：11730461
> 
> 赞同：1
> 
> 时间：2012-07-30T22:13:27.170
> 
> 标签：visual-c++, visual-studio-2012, msvcrt

我刚刚安装了 VS2012 beta，并升级了我的 VS2010 项目，它似乎可以编译，但是在链接时，我收到以下错误：

> 1>LIBCMTD.lib(excptptr.obj)：错误 LNK2019：未解析的外部符号 __Atomic_fetch_add_4 在函数“unsigned long __cdecl std::_Inc_atomic_counter_explicit(unsigned long &,enum std::memory_order)”(?_Inc_atomic_counter_explicit@std@@YAKAAKW4memory_order@ 1@@Z) 1>LIBCMTD.lib(excptptr.obj) : 错误 LNK2019: 函数“unsigned long __cdecl std::_Dec_atomic_counter_explicit(unsigned long &,enum std::memory_order)”中引用的未解析的外部符号 __Atomic_fetch_sub_4 (?_Dec_atomic_counter_explicit@ std@@YAKAAKW4memory_order@1@@Z)

谷歌没有提及这些错误消息，这令人惊讶。看起来`__Atomic_fetch_add_4`应该是 fetchadd4 操作码的内在属性，但它不是（据我所知），正确的内在属性是`_InterlockedIncrement`.

我不知道是什么原因造成的。有趣的是，它来自`excptptr.obj`，我在这个项目中禁用了 C++ 异常。启用它们没有任何区别。

编辑：我在谷歌搜索时注意到这个符号似乎只被 GNU 代码引用。也许 MS 已经为 VS2012 更新了 STL，并引入了一些尚未被捕获的 GNU 参考代码；需要更改以使用 MS 内在函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T13:51:57.280

我的一个项目在 VS2010 中编译时遇到了类似的问题，在 VS2012 中编译时出现未解决的外部符号 __Atomic_fetch_add_4 错误。我不知道为什么会这样，但是在“干净的解决方案”和“重建所有”之后，问题就消失了。我怀疑那里有旧的 obj 文件导致问题。

# javascript - 我可以将 json 输入转换为 jquery 中的对象列表吗？

> ID：11730463
> 
> 赞同：0
> 
> 时间：2012-07-30T22:13:58.343
> 
> 标签：javascript, jquery

我是 jQuery 新手，只是为了好玩。我有一些[代码](https://github.com/balancemedia/Timeline)想尝试修改以满足我的需要，但当前的 js 文件正在从谷歌电子表格中获取其数据，然后将每个项目作为对象返回。我不使用 json 将数据从我的服务器传递到 jQuery，所以我想知道如何将 json 转换为对象。

目前的做法是（桌面是他们从谷歌文档获取数据的 js 程序的名称）：

```
Tabletop.init({
    key: timelineConfig.key,
    callback: setupTimeline,
    wanted: [timelineConfig.sheetName],
    postProcess: function(el){
        //alert(el['photourl']);
        el['timestamp'] = Date.parse(el['date']);
        el['display_date'] = el['displaydate'];
        el['read_more_url'] = el['readmoreurl'];
        el['photo_url'] = el['photourl'];
    }
}); 
```

我在整个文件中添加了警报，我认为这是获取数据并将其传递的区域。我正在考虑尝试用我的 json 中的对象替换他们对象中的项目，看看它是否改变了任何东西，但我不确定。通常我通过 json、hashmaps 和列表传递单个项目，不确定它如何与对象一起使用或如何访问对象（我只是调用我为请求创建的 url，`$("#user-history").load("/cooltimeline/{{ user.id }}");`）。但是，如果我想将 json 数据转换为对象，我应该从哪里开始呢？

如果有帮助，这是我正在尝试做的[演示（但通过使用 json 数据）。](http://builtbybalance.com/github-timeline/)

ps 我真的在寻找如何完成我正在尝试做的事情的逻辑，也许还有一些我错过的想法，所以我可以用谷歌搜索它们并学习。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:18:46.187

使用使用功能`JSON.parse(json)`:) 或`jQuery.parseJSON(json)`

```
var json = '{"a":2}';
var object = JSON.parse(json);

alert(object.a); 
```

您应该看到带有消息的警报：`2`

* * *

我真的不知道我是否理解您的评论，但也许您只想这样做：

```
 postProcess: function(el){ //here el is JSON string
        el = JSON.parse(el); // now el is an object
        el.timestamp = Date.parse(el.date);
        el.display_date = el.displaydate;
        el.read_more_url = el.readmoreurl;
        el.photo_url = el.photourl;

        return el;

    } 
```

顺便提一句。您不需要在没有标准名称的已知属性名称上使用方括号：

```
el['timestamp'] === el.timestamp 
```

如果你粘贴你的 JSON 会更容易

# c++ - 动态加载库的未定义符号“typeinfo”

> ID：11730465
> 
> 赞同：7
> 
> 时间：2012-07-30T22:14:02.287
> 
> 标签：c++

我正在尝试在 Linux 上使用 gcc 4.6 构建一个共享库，该库是动态加载的。正如网络上的许多文章以及之前的问题中所述，我在库中提供了 c 风格的工厂方法来创建和销毁对象。代码 - 以最小形式 - 如下所示：

基地.h：

```
class base {
public:
  base();
  virtual ~base();
  virtual int value() = 0;
}; 
```

基础.cpp：

```
#include "base.h"
base::base() {}
base::~base() {} 
```

主.cpp：

```
#include "base.h"
#include <dlfcn.h>
#include <iostream>

int main() {
  void* handle = dlopen("liblib.so", RTLD_NOW);
  if(handle == NULL) std::cout << dlerror() << std::endl;

  // dlsym, ...
} 
```

lib.cpp：

```
class derived : public base {
public:
  derived() {}
  virtual ~derived() {}
  virtual int value() { return 42; }
};

extern "C" derived* create_object() {
  return new derived();
} 
```

它编译得很好：

```
g++ -shared -fPIC lib.cpp -o liblib.so
g++ base.cpp main.cpp -ldl -o app 
```

但是在运行时它会因为缺少 typeinfo 符号而崩溃

```
liblib.so: undefined symbol: _ZTI4base 
```

在我在这里找到的之前的问题中，这个错误通常是由于缺少一些“= 0;” 或缺少虚函数的定义。然而，在上面的例子中，base::value 是纯虚函数，析构函数有一个定义。奇怪的是，nm 报告了应用程序中定义的 _ZTI4base：

```
$ nm app | grep _ZTI4base
0000000000601050 V _ZTI4base 
```

那么为什么链接器不使用这个定义呢？

到目前为止，我发现让代码正常工作的唯一方法是在头文件中实现构造函数和析构函数。然而，在这样做之后，base 的相应符号在 liblib.so 中由 nm 报告，并且完全从 app 中消失，这可能意味着它们的定义被编译到库中而不是 app 中，这不是我想要实现的。有没有人知道如何在不这样做的情况下使上述工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:22:46.500

链接程序时需要该[`-rdynamic`](http://gcc.gnu.org/onlinedocs/gcc-4.7.1/gcc/Link-Options.html#index-rdynamic-1008)选项，以导出其符号并使它们可用于加载`dlopen()`.

# ant - Jenkins：具有多个颠覆模块的单一作业

> ID：11730466
> 
> 赞同：3
> 
> 时间：2012-07-30T22:14:04.353
> 
> 标签：ant, continuous-integration, jenkins

我正在将 Jenkins 用于一个项目，并想知道以下是否可行。我有四个独立的 SVN 模块，它们作为工作的一部分被检出。每个 SVN 模块都添加到一个单独的目录中。根据 SCM 轮询期间更新的模块，我只想构建某些目录。

使用 Cruise Control，我能够为每个更新的模块设置一个变量，并将这些变量传递给 ant 构建脚本以控制构建。

有没有人做过类似的事情或有任何想法？

谢谢，肖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-08T18:46:48.653

这个问题相当复杂。您正在接触 CI 构建服务器的太多不同部分以及其中的一些任务。

基本上......在 Jenkins 中为工作/项目提供控制构建本身行为的信息并不是最好的方法，但如果你别无选择，那么你别无选择。

构建本身应该足够不可知，它应该包含使构建能够在 CI 和 Workstation 中成功的所有参数（例如，来自 cmd.exe）。

> 根据 SCM 轮询期间更新的模块，我只想构建某些目录。

所以基本上你想要 Maven 构建系统，它提供基于模型/模块的条件构建，而不是像 Ant 那样构建一个单独的项目。

> 使用 Cruise Control，我能够为每个更新的模块设置一个变量，并将这些变量传递给 ant 构建脚本以控制构建。

在这里，您希望拥有某种类似的构建触发功能。这里没有更详细的需求解释，我只能建议查看 Pramatreized Build Trigger 插件，它允许通过您设置的参数触发构建。

> 有没有人做过类似的事情或有任何想法？

最后，在这里你还可以查看这个插件：[https ://wiki.jenkins-ci.org/display/JENKINS/Conditional+BuildStep+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Conditional+BuildStep+Plugin)

总之，Jenkins 提供了一些开箱即用的功能，因此如果您使用 Ant，您可以轻松使用环境变量并开始构建您需要的行为。通常在花费一些时间思考如何在没有大量 Jenkins 插件帮助的情况下做某事之后，它会以某种方式让你真正理解，你想要实现的关键是什么。

希望我有所帮助。队友的欢呼声。

# css - 是否可以设置文本输入的样式以填充其父项的宽度？

> ID：11730468
> 
> 赞同：23
> 
> 时间：2012-07-30T22:14:12.980
> 
> 标签：css, width, textinput

这个问题我已经有好几年了，我之前也看到过类似的问题，但没有一个解决了这样一个事实，即在设置`width: 100%`元素时 - 填充、边距和边框会*增加*宽度。

* * *

看看这个[Fiddle](http://jsfiddle.net/qfUre/6/)。

最上面的白色文本框是一个标准文本框，其宽度设置为`100%`. 如您所见，由于边距、填充和边框设置，它溢出了它的父级。

绿色文本框的样式类似于 div，使用`position: absolute`. 这在 webkit 浏览器中就像一个梦想，但在其他任何地方都没有。

红色的 div 是控件 - 我希望输入的行为**就像那样**。

* * *

有没有什么技巧可以让我的文本输入就像所有现代浏览器中的红色 div 一样，换句话说，适合父级的填充？请编辑我的小提琴或创建您自己的小提琴以配合您的答案。谢谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-07-30T22:21:39.027

你可以：

```
input#classic
{
    width: 100%;
    padding: 5px;
    margin: 0;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -o-box-sizing: border-box;
    -ms-box-sizing: border-box;
    box-sizing: border-box;        
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/qfUre/17/)。

注意我删除了`margin`, 因为那会导致溢出，并设置`box-sizing`来确定元素的宽度，*包括*边框和填充的宽度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T22:30:36.997

`calc`用于补偿边距和`box-sizing`填充

```
input#classic
{
    padding: 5px;
    margin: 5px;
    width: -webkit-calc(100% - 10px);
    width: -moz-calc(100% - 10px);
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -o-box-sizing: border-box;
    -ms-box-sizing: border-box;
    box-sizing: border-box;
} 
```

[小提琴](http://jsfiddle.net/mowglisanu/qfUre/31/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T06:24:51.573

`display:table-cell`用属性试试

```
 display:table;
  display:table-cell; 
```

可以帮助你吗

请检查此链接

[样式输入元素以填充其容器的剩余宽度](https://stackoverflow.com/questions/773517/style-input-element-to-fill-remaining-width-of-its-container)

# c++ - CPLEX C++ 通过变量名获取变量的索引

> ID：11730472
> 
> 赞同：0
> 
> 时间：2012-07-30T22:14:33.403
> 
> 标签：c++, cplex

在 CPLEX 优化器中是否可以使用 c++ api 通过变量名获取变量的索引？我找不到任何合适的方法来做到这一点。请帮忙。

我有 [IloNumVarArray vars;] 变量来按名称存储变量。

vars[i].getName(); // 给出索引 i 处的变量名

有没有像 vars.getIndex(name) 这样的方法，可以给出变量的索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T14:13:23.510

如果您使用的是可调用库 C++ API，则有查找列索引的函数，给定列名：

> int CPXgetcolindex(CPXCENVptr env, CPXCLPptr lp, const char * lname_str, int * index_p)

看：

[http://pic.dhe.ibm.com/infocenter/cosinfoc/v12r4/index.jsp?topic=%2Filog.odms.cplex.help%2Frefcallablelibrary%2Fhtml%2Ffunctions%2FCPXaddmipstarts.html](http://pic.dhe.ibm.com/infocenter/cosinfoc/v12r4/index.jsp?topic=/ilog.odms.cplex.help/refcallablelibrary/html/functions/CPXaddmipstarts.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:34:06.937

CPLEX 中没有类似的东西。

您始终可以迭代数组并比较名称以取回您的变量。如果您需要更好的性能，您可以使用地图。

# events - UISlider TouchUpInside 不在滑块末端触发

> ID：11730474
> 
> 赞同：1
> 
> 时间：2012-07-30T22:14:48.643
> 
> 标签：events, action, uislider

我的滑块在 ValueChanged 中设置了一个标志，然后在 TouchUpInside 中将其重置。但是，当我触摸手柄并将其一直滑动到滑块的末尾时，TouchUpInside 事件不会被触发（因此我的标志不会被重置）。

当我将手柄滑到滑块的末端时，是否需要处理另一个 UISlider 动作？我尝试了 TouchCancel，以为当我的手指移过滑块的末端时它可能会被取消，但这不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:06:18.843

为了解决这个问题，我需要使用 TouchUpOutside 动作/事件。

# iphone - 使用 span 缩放到用户位置

> ID：11730477
> 
> 赞同：1
> 
> 时间：2012-07-30T22:15:06.077
> 
> 标签：iphone, ios, zooming, cllocationmanager, html

这是我现在的代码。我收到来自位置管理器的回调，但它不想缩放到该位置。

```
#import "MapViewController.h"

@interface MapViewController ()

@property (nonatomic, strong) CLLocationManager *locationManager;

@end

@implementation MapViewController

@synthesize mapView = _mapView;
@synthesize mPlacemark = _mPlacemark;
@synthesize location = _location;
@synthesize mStoreLocationButton = _mStoreLocationButton;
@synthesize locationManager = _locationManager;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
if (self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil]) {
    // Custom initialization
}
return self;
 }

- (void)viewDidLoad {

[super viewDidLoad];
mapView=[[MKMapView alloc] initWithFrame:self.view.frame];
//mapView.showsUserLocation=TRUE;
mapView.delegate=self;
[self.view insertSubview:mapView atIndex:0];

NSLog(@"locationServicesEnabled: %@", [CLLocationManager locationServicesEnabled] ? @"YES":@"NO");
if ([self locationManager] == nil) {
    CLLocationManager *newLocationManager = [[CLLocationManager alloc] init];
    [newLocationManager setDesiredAccuracy:kCLLocationAccuracyBest];
    [newLocationManager setDistanceFilter:kCLDistanceFilterNone];
    [self setLocationManager:newLocationManager];
}

[[self locationManager] setDelegate:self];
[[self locationManager] startUpdatingLocation];
NSLog(@"Started updating Location");

}

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {

NSLog(@"Did update to location");
mStoreLocationButton.hidden=FALSE;
location=newLocation.coordinate;

MKCoordinateRegion region;
region.center=location;
MKCoordinateSpan span;
span.latitudeDelta=0.01;
span.longitudeDelta=0.01;
region.span=span;

[mapView setRegion:region animated:TRUE];

 } 
```

如果需要，我可以发布头文件。主要是我只关心缩放。我只是不明白为什么它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:27:38.557

您的代码`- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation`似乎是正确的。

换行试试

```
[self.view insertSubview:mapView atIndex:0]; 
```

至：

```
[self.view addSubview:mapView]; 
```

可能`MKMapView`因为它在您的视图中的显示方式而没有重绘本身。

# java - 适用于 PC 和平板电脑的 Browsergame - 依赖哪个插件？

> ID：11730478
> 
> 赞同：0
> 
> 时间：2012-07-30T22:15:08.533
> 
> 标签：java, silverlight, plugins, unity3d

我是一个致力于创建免费教育化学**浏览器**游戏的学生项目的一部分，但我们无法决定使用哪个插件（Flash、Java、Unity...）。

游戏将包含 2d 图形和短片场景，主要是拖放游戏。

我们希望它（插件）在未来几年内得到支持，并与大多数（如果不是全部）PC 和平板电脑兼容 - 所以 Flash 已经不可能了。

我们是糟糕的程序员，但我们有一些资金，所以我们会将实际的编程外包出去，这意味着我们能否找到能够使用插件的人也很重要。

**那么您会根据我们的需要推荐哪个插件呢？**优点和缺点都非常受欢迎。

另外请告诉我是否遗漏了一些相关点！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:20:22.543

我认为最好的选择是完全避免使用插件。

如您所知，Apple iPad 和 iPhone 不支持 flash，但它们也不支持任何其他插件。

*大多数（但不是全部）Android 平板电脑和手机（包括 Android 4.0*）都支持 Flash 。但 Adob​​e（flash 插件的制造商）已**停止使用**它，并表示**不会为***4.0 以上*的 Android 版本提供它。

即使在 Android 4.0 上，已安装并正在使用 Chrome 浏览器而不是默认浏览器的用户也将无法查看 flash，因为即使 Android 4.0 操作系统可能有 flash 插件，安装在 Android 4.0 上的 Chrome 浏览器也有不是为使用它而设计的。

Android 应用程序是用 Java 编写的，但 Android Web 浏览器实际上并不包含用于运行 Java 小程序的插件。无论操作系统或浏览器如何，插件基本上都被全面淘汰。

最佳策略：

*   覆盖最广泛的用户
*   无论他们使用何种类型的 PC、平板电脑或浏览器
*   从长远来看，这不会导致游戏不被浏览器支持

是使用网络标准设计您的应用程序。

如今，HTML 5 Canvas、CSS、JavaScript 和其他技术已经标准化以支持所有 Web 浏览器，允许在浏览器内实现复杂的动画/图形，支持拖放，并支持播放视频，而无需使用任何插件一点也不。您可以将开发外包给了解这些技术的团队。

`<video>`由于您也在查看视频，请注意，尽管围绕HTML 5 中的标签（允许在没有插件的情况下播放视频的功能）中的标签一直存在争议。基本上已经同意所有浏览器都允许在没有插件的情况下播放视频，但是标签应该支持的视频的实际格式被排除在标准之外（由于分歧），因此尚未决定。

正在讨论的候选视频格式包括[WebM/VP8](http://blog.chromium.org/2011/01/html-video-codec-support-in-chrome.html)、[H.264/MPEG-4 AVC](http://en.wikipedia.org/wiki/H.264/MPEG-4_AVC)和[Theora](http://en.wikipedia.org/wiki/Theora)。

解决这个问题的方法是，HTML 5`<video>`标记允许您列出视频的*多个来源*（即服务器上的多个文件，所有文件都用于相同的视频，但格式不同）。因此，如果您以最常见的格式保存视频，浏览器就可以选择它支持的最佳格式。

因此，关于 HTML 5 视频格式的争论不会（太多）影响您的游戏设计，只是可能会让您头疼需要以多种格式保存视频。如果您这样做，那么您的游戏将在所有主要浏览器中具有广泛的兼容性。

# resolution - CSS 媒体查询是否在本地工作？

> ID：11730481
> 
> 赞同：1
> 
> 时间：2012-07-30T22:15:19.400
> 
> 标签：resolution, media-queries, css

我正在寻找我的答案[@CSS 媒体查询](http://www.w3.org/TR/css3-mediaqueries/)但找不到它所以我想我会在这里问。

CSS媒体查询可以离线/本地使用吗？我正在构建一个网页，它全部在共享网络驱动器上，我正在尝试根据分辨率设置不同的样式表，我想使用 CSS 媒体查询`min-width`，但它们似乎不起作用，我想知道是不是因为我的网站没有直播？（类似于 favicon 无法在本地工作，仅在托管站点上）。

一个例子是：

```
 <style type="text/css">
        @media all and (min-width: 1024px) {
            background-image: url(images/bigbg.jpeg);
        }
        body {
            width: 1000px;
            background-image:url('images/test.PNG');
            background-repeat:repeat;
            overflow-x:scroll;
        }
    </style> 
```

有什么建议么？非常感激 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T22:18:39.840

应该在本地工作，但您需要定义发生了什么变化。尝试：

原来的：

```
@media all and (min-width: 1024px) {
        body {background-image: url(images/bigbg.jpeg);}
} 
```

更好的是：

```
@media all and (min-width:1024px){
        body{background:url(images/bigbg.jpg)}
} 
```

# javascript - HTML 客户端可移植文件生成 - 无需外部资源或服务器调用

> ID：11730487
> 
> 赞同：4
> 
> 时间：2012-07-30T22:16:06.637
> 
> 标签：javascript, html, uri, client-side, file-generation

我有以下情况：

我在公司内部服务器上设置了一系列 Cron 作业来运行旨在检查数据完整性的各种 PHP 脚本。每个 PHP 脚本都会查询公司数据库，将返回的查询数据格式化为包含一个或多个`<tables>`. 根据我的经验，大多数 PHP 脚本生成的 HTML 文件只有几个表格，但是有一些 PHP 脚本可以创建大约 30 个表格的 HTML 文件。之所以选择 HTML 文件作为这些扫描的分发格式，是因为 HTML 可以轻松地在浏览器窗口中一次查看多个表。

我想为客户端添加将 HTML 文件中的表格下载为 CSV 文件的功能。我预计客户在怀疑基于表数据的数据完整性问题时会使用此功能。对于他们来说，能够获取有问题的表格，将数据导出到 CSV 文件，然后进一步研究，这将是理想的选择。

*因为是否需要将数据导出为 CSV 格式由客户自行决定，无法预测哪些表将受到审查，并且间歇性使用我不想为每个表创建 CSV 文件。*

通常创建 CSV 文件不会太难，使用 JavaScript/jQuery 执行 DOM 遍历并利用服务器调用或 flash 库将 CSV 文件数据生成字符串以方便下载过程；但我有一个限制条件：HTML 文件必须是“可移植的”。

我希望客户能够获取他们的 HTML 文件并对公司内部网之外的数据进行预分析。此外，这些 HTML 文件很可能会被归档，因此出于上述两个原因，将导出功能“自包含”在 HTML 文件中是一个非常理想的功能。

从 HTML 文件生成 CSV 文件的“可移植”约束意味着：

1.  我无法拨打服务器电话。这意味着**所有**文件生成都必须在客户端完成。

2.  我希望附加到电子邮件的单个 HTML 文件包含生成 CSV 文件的所有资源。这意味着我不能使用 jQuery 或 flash 库来生成文件。

我知道，出于明显的安全原因，任何浏览器都不支持使用 JavaScript 将文件写入磁盘。我不想在用户不知情的情况下创建文件；我想在内存中使用 JavaScript 生成文件，然后提示用户从内存中“下载”文件。

我已经研究过将 CSV 文件生成为 URI，但是根据我的研究和测试，这种方法存在一些问题：

*   IE 不支持文件的 URI（[请参阅此处](http://msdn.microsoft.com/en-us/library/cc848897%28v=vs.85%29.aspx "看这里")）

*   FireFox 中的 URI 使用随机文件名和 .part 文件保存文件

尽管让我很痛苦，但我可以接受 IE<=v9 不会为文件创建 URI 的事实。我想创建一个半跨浏览器解决方案，其中 Chrome、Firefox 和 Safari 在 JavaScript DOM 遍历编译数据后创建一个 URI 来下载 CSV 文件。

**我的示例表：**

```
<table>
    <thead class="resulttitle">
        <tr>
            <th style="text-align:center;" colspan="3">
            NameOfTheTable</th>
        </tr>
    </thead>
    <tbody>
        <tr class="resultheader">
            <td>VEN_PK</td>
            <td>VEN_CompanyName</td>
            <td>VEN_Order</td>
        </tr>
        <tr>
            <td class='resultfield'>1</td>
            <td class='resultfield'>Brander Ranch</td>
            <td class='resultfield'>Beef</td>
        </tr>
        <tr>
            <td class='resultfield'>2</td>
            <td class='resultfield'>Super Tree Produce</td>
            <td class='resultfield'>Apples</td>
        </tr>
        <tr>
            <td class='resultfield'>3</td>
            <td class='resultfield'>John's Distilery</td>
            <td class='resultfield'>Beer</td>
        </tr>
    </tbody>
    <tfoot>
        <tr>
          <td colspan="3" style="text-align:right;">
          <button onclick="doSomething(this);">Export to CSV File</button></td>
        </tr>
    </tfoot>
</table> 
```

**我的示例 JavaScript：**

```
<script type="text/javascript">
  function doSomething(inButton) {

    /* locate elements */
    var table = inButton.parentNode.parentNode.parentNode.parentNode;
    var name  = table.rows[0].cells[0].textContent;
    var tbody = table.tBodies[0];

    /* create CSV String through DOM traversal */
    var rows  = tbody.rows;
    var csvStr = "";
    for (var i=0; i < rows.length; i++) {
      for (var j=0; j < rows[i].cells.length; j++) {
        csvStr += rows[i].cells[j].textContent +",";
      }
      csvStr += "\n";
    }

    /* temporary proof DOM traversal was successful */
    alert("Table Name:\t" + name + "\nCSV String:\n" + csvStr);

    /* Create URI Here!
     * (code I am missing)
     */

    /* Approach #1 : Auto-Download From Browser
     * Attempts to redirect the browser to the URI
     * and have the browser download the data as a file
     *
     * Approach does downloads CSV data but:
     * In FireFox downloads as randomCharacers.part instead of name.csv
     * In Chrome downloads without prompting the user and without correct file name
     * In Safari opens the files in browser (textfile)
     */
    /* Approach #1 Code:
       var hrefData = "data:text/csv;charset=US-ASCII," + encodeURIComponent(csvStr);
       document.location.href = hrefData;
     */

    /* Approach #2 : Right-Click Save As Link...
     * Attempts to remove "Download Button"
     * and replace the it with an anchor tag <a>
     * that the user can use to download the data
     *
     * Approach sort of works better:
     * When clicking on the link:
     * In FireFox downloads as randomCharacers.part instead of name.csv
     * In Chrome downloads without prompting the user (uses correct name) 
     * In Safari opens the files in browser (textfile)
     * 
     * When right-click "Save As" on the link:
     * In FireFox prompts the user with filename: randomCharacers.part 
     * In Chrome  prompts the user with filename: "download"
     * In Safari  prompts the user with filename: "Unknown"
     */
    /* Approach #2 Code:
       var hrefData = "data:text/csv;charset=US-ASCII," + encodeURIComponent(csvStr);
       var fileLink = document.createElement("a");
       fileLink.href = hrefData;
       fileLink.type  = "text/csv";
       fileLink.innerHTML = "CSV Download Link";
       fileLink.setAttribute("download",name+".csv"); // for Chrome
       parentTD = inButton.parentNode;
       parentTD.appendChild(fileLink);
       parentTD.removeChild(inButton);
     */
  }
</script> 
```

我正在寻找可以将上述示例表下载为 CSV 文件的示例解决方案：

*   使用 URI
*   使用 a`<button>`或 a`<a>`
*   代码按照现代版本的 FireFox、Safari 和 Chrome 中的描述工作
*   **与**（1.**或**2.）：

    1.  *   提示用户保存文件
        *   用户不需要“右键单击另存为”
    2.  *   自动将文件保存到默认浏览器保存目录
        *   默认文件名是带有 .csv 文件扩展名的表的名称

我添加了一个`<script>`带有 DOM 遍历功能的标签`doSomething()`。我需要的真正帮助是将 URI 格式化为函数中我想要的内容`doSomething()`。方法#2（见我的代码）似乎最有希望。

我愿意接受我想要的功能是不可能实现仅使用 HTML 和 JavaScript 如果声明提供证明; 例如浏览器文档、DOM 标准、JavaScript/ECMAscript 文档或证明不可能的逻辑反例。

话虽如此，我认为解决方案可能来自具有更深背景/更多 URI 经验的人，即使解决方案有点 hack。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:04:47.090

只要您不介意在 IE 方面只支持 IE10+，请使用[FileSaver.js](https://github.com/eligrey/FileSaver.js)。您可以生成 CSV 并将其附加到 Blob，然后附加到 Blob `saveAs()`。您将只能在支持的浏览器`<a download>`（如 Chrome）中保留已保存文件的文件名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T22:34:41.357

您在评论中声明您“不应该*创建*单独的 HTML 和 CSV 文件”，但在这种情况下，您的基本需求是以两种格式提供数据 - 生成数据的两个副本并不是不合理的限制。再说一遍，你所要求的是**不可行的。**

我能想象到的最接近您的问题的解决方案是将 CSV 数据打包到 HTML 文件中（通过显示：无 div 或类似的），并在加载时使用 JavaScript 将其动态填充到 HTML 表中。如果您有大型记录集，这会很慢，但是添加一个按钮来显示和选择 CSV 文本进行复制粘贴会很简单。不优雅？是的，对不起。HTML 不是交换格式是有原因的。

话虽如此，您可以将表格数据打包在 PDF 中，并将 CSV 作为附件包含在其中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-14T16:38:40.797

> 我希望附加到电子邮件的单个 HTML 文件包含生成 CSV 文件的所有资源。这意味着我不能使用 jQuery

这是一个错误的说法。如果您想在没有服务器调用的情况下在单个 HTML 文件中使用 jQuery 功能，只需将缩小的 jQuery 库复制/粘贴到 HTML 本身。它将使每个 HTML 文件变大 32K，这并不可怕，除非您一次发送数百封电子邮件。

因此，如果您熟悉 jQuery 并且乐于使用它来重构页面上的数据，请随意使用它。我建议您自动创建的 HTML 将数据保存在 javascript 数组中，并在页面加载时创建表。然后，如果用户单击 CSV 选项，它可以清除并重构它。

```
var data = {
  title: 'NameOfTable',
  headers: ['VEN_PK', 'VEN_CompanyName', 'VEN_Order'],
  data: [
    ['1', 'Brander Ranch' 'Beef'],
    ['2', 'Super Tree Produce' 'Apples'],
    ['3', 'John\'s Distilery' 'Beer']
  ] 
}
$(document).ready(function() {
  var html = '<table>';
  html += '<thead>';
  html += '<tr><th style="text-align:center;" colspan="' + data.headers.length +'">' + data.title + '</th></tr>';
  html += '</thead><tbody>';
  html += '<tr class="resultheader">';
  for (i in data.headers) {
    html += '<td>'+data.headers[i]+'</td>';
  }
  html += '</tr>';
  for (i in data.data) {
    var row = data.data[i];
    html += '<tr>';
    for (j in row) {
      html += '<td class="resultfield">'+row[j]+'</td>';
    }
    html += '</tr>';
  }
  html += '</table>';
  $('#container').html(html);
});

function showCSV() {
   var csv = '';
   for (i in data.headers) {
     csv += data.headers[i] + ',';
   }
   csv += "\n";
   for (i in data.data) {
     var row = data.data[i];
     for (j in row) {
       csv += row[j] + ',';
     }
     csv += "\n";
   }
   $('#container').html(csv);
} 
```

# actionscript-3 - 比较 Flex 中的文本文件

> ID：11730491
> 
> 赞同：2
> 
> 时间：2012-07-30T22:16:24.517
> 
> 标签：actionscript-3, apache-flex

是否有实用程序或第三方库来比较 flex 中的两个文本文件。假设我已经使用“FileReference”加载了两个不同的文本文件，现在我想比较这两个文件的内容。类似于 SVN diff，我想找出每一行的编辑/添加/删除的内容。

我已经浏览过这个线程[[有没有办法通过 Flex 比较文本文件？](https://stackoverflow.com/questions/5871455/is-there-a-way-to-compare-text-files-through-flex)] 但这里没有回答。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T21:13:58.953

我很确定此链接将引导您找到解决方案。可能需要进行一些调整才能使用您的功能列表，但它应该可以让您完成 90% 的工作。

[Flash 的 diff/patch 解决方案：用于比较 as3 中的文本版本的概念证明 Monte Carlo 算法](http://blog.controul.com/2009/05/diff-patch-for-flash-as3/)

我刚刚在 Google 中搜索了“as3 文件差异”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T21:51:14.023

我认为还没有人。

鉴于 as3 和 js 之间的相似之处，这两个库之一的端口应该是直截了当的

[http://code.google.com/p/google-diff-match-patch/source/browse/trunk/javascript/diff_match_patch_uncompressed.js](http://code.google.com/p/google-diff-match-patch/source/browse/trunk/javascript/diff_match_patch_uncompressed.js)

[http://ejohn.org/projects/javascript-diff-algorithm/](http://ejohn.org/projects/javascript-diff-algorithm/)

# php - 用于发布到墙上的 Facebook API 和带有权限检查的无限循环问题

> ID：11730492
> 
> 赞同：0
> 
> 时间：2012-07-30T22:16:29.570
> 
> 标签：php, facebook-graph-api

无法弄清楚为什么它在我的网站和 facebook 之间不断向前循环运行，从不终止最后一步（即将状态发布到墙上）。

```
require 'facebook.php';

//Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
  'appId'  => 'XXXXXXXXXXX',
  'secret' => 'XXXXXXXXXXXXXXXXXXXXX',
 ));

$user = $facebook->getUser(); 
```

根据用户是否登录，我们可能拥有也可能不拥有这些数据。

如果我们在这里有一个 $user id，这意味着我们知道该用户已登录 Facebook，但我们不知道访问令牌是否有效。如果用户退出 Facebook，则访问令牌无效。

```
if ($user) {
  try {
   // Proceed knowing you have a logged in user who's authenticated.
  $user_profile = $facebook->api('/me');
 } catch (FacebookApiException $e) {
   error_log($e);
   $user = null;
 }
}

if ($user) {
 $logoutUrl = $facebook->getLogoutUrl();
} else {
$loginUrl = $facebook->getLoginUrl();
} 
```

所以这是我发现的两种不同解决方案的非常肮脏的混搭。如果我在单独的文档上执行权限，然后在没有 if 语句的情况下加载下一部分，它实际上没有问题。所以我知道我已正确连接到 Facebook....

```
if ($user): 

if(array_key_exists('publish_stream', $permissions['data'][0]) ) {
            // Permission is granted!
            // Do the related task
            $post_id = $facebook->api('/me/feed', 'post', array('message'=>'Testing testing 123!'));
    echo "<br><br><br><h1> POSTED STATUS TO WALL!</h1>";

       } else {
            // We don't have the permission
            // Alert the user or ask for the permission!
           echo "Click Below to Enter!";
           header( "Location: " . $facebook->getLoginUrl(array("scope" => "publish_stream")) );
       } 
```

这里的问题是它一遍又一遍地运行发布流权限（标题转发并超时，重定向太多），并且永远不会抓住 if 语句来实际发布到墙上？我只是看不出我在这里做错了什么。非常感谢任何帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:21:46.827

您缺少的关键线是

```
$permissions = $facebook->api("/me/permissions"); 
```

这会从 facebook 获取当前用户的权限，您需要在 array_key_exists 之前使用它。

# actionscript-3 - 带图像的 Flex DataGrid - 图像未完全显示

> ID：11730494
> 
> 赞同：0
> 
> 时间：2012-07-30T22:16:39.477
> 
> 标签：actionscript-3, apache-flex, datagrid

这是我的问题。我在 mx:DataGrid 列中有一个 mx:Image。如果我没有专门设置图像的宽度和高度，当图像加载到网格中时，只会显示图像的一部分。

娱乐步骤：

1.  创建新的 Flex 项目（桌面）
2.  将项目配置为使用 Halo 主题。
3.  在各自的位置添加以下代码 *注意：确保分配了 windowedApplication 的*creationComplete*事件。还可能需要对任何导入语句等进行一些调整。抱歉。*

4.  这是我遇到的问题的一个简单示例。启动程序时，您将看到图像的一部分。当您单击**重新绑定**时，将出现完整的图像。

我试图让完整的图像显示在第一个绑定上，而不是第二个*而*不是在 MXML 中设置尺寸。在没有发生某种用户交互的情况下，我无法通过 ActionScript 成功显示完整图像。

```
<fx:Script>
    <![CDATA[
        import mx.collections.ArrayCollection;

        protected function windowedapplication1_creationCompleteHandler(event:FlexEvent):void
        {
            BindData();
        }

        private function BindData():void
        {
            var objOrderItem:Object = new Object();
            var items:ArrayCollection = new ArrayCollection(new Array(objOrderItem));
            dgMain.dataProvider = new ArrayCollection(items.source);
        }   
    ]]>
</fx:Script>
<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>

<mx:VBox width="100%">
    <mx:Button label="Rebind" click="BindData()" />

    <mx:DataGrid id="dgMain" resizableColumns="false" draggableColumns="false"
                 sortableColumns="false" rowCount="1">
        <mx:columns>
            <mx:DataGridColumn headerText="Thumb" sortable="false" width="60">
                <mx:itemRenderer>
                    <fx:Component>
                        <mx:HBox horizontalGap="0" verticalScrollPolicy="off" horizontalScrollPolicy="off" width="100%">
                            <mx:Image source="https://encrypted-tbn1.google.com/images?q=tbn:ANd9GcTTuc9n_oweh-dv4LUljzh0Lxzn1AvZchODUoSAeGePaDwPqUuw"
                                      width="60" maintainAspectRatio="true" />  
                        </mx:HBox>
                    </fx:Component>
                </mx:itemRenderer>
            </mx:DataGridColumn>                
        </mx:columns>
    </mx:DataGrid>
    <mx:Label text="Text After Grid" />
</mx:VBox> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:56:48.963

只是一个猜测，因为这对我之前使用 DataGrids 有效，您是否尝试过在数据网格上调用 invalidateList()。刚刚检查该方法设置了 itemsSizeChanged 标志，然后在它所说的标志的定义处调用 invalidateDisplayList ：

> ```
> /**
>  *  A flag that indicates that the size of the renderers may have changed.
>  *  The component usually responds by re-applying the data items to all of
>  *  the renderers on the next <code>updateDisplayList()</code> call.
>  *  There is an assumption that re-applying the items will invalidate the
>  *  item renderers and cause them to re-measure.
>  */ 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:19:07.713

**问题解决了**

大家好，我可以通过调整我的数据绑定到的 DataGrid 的行高来解决我的问题，方法是检查行高以查看它是否小于图像的高度。我是这样做的：

我为图像的完整事件附加了一个侦听器。侦听器然后触发一个函数来检查 DataGrid 的 rowHeight 以查看它是否小于图像内容的高度。如果是，它将 rowHeight 更新为图像内容的高度。

我只是没有成功使用这里建议的任何方法，以及我尝试使用的任何其他方法。

**下面的完整代码示例：**

*请记住，这是一个快速、简单的修复实现。更精细的实现，我在项目中使用的 IE 也同样有效。*

```
<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
                       xmlns:s="library://ns.adobe.com/flex/spark" 
                       xmlns:mx="library://ns.adobe.com/flex/mx"
                       creationComplete="windowedapplication1_creationCompleteHandler(event)">
    <fx:Script>
        <![CDATA[
            import controls.Photo.PhotoComponentForDataGrid;

            import flash.utils.setTimeout;

            import mx.collections.ArrayCollection;
            import mx.controls.Image;
            import mx.events.FlexEvent;

            protected function windowedapplication1_creationCompleteHandler(event:FlexEvent):void
            {
                BindData();
            }

            public function doImageDownloaded(imgLoaded:Image):void
            {   
                if (dgMain.rowHeight < imgLoaded.content.height)
                {
                    dgMain.rowHeight = imgLoaded.content.height;
                }
            }

            private function BindData():void
            {
                var objOrderItem:Object = new Object();
                objOrderItem.photoUrl = "http://c10008669.r69.cf2.rackcdn.com/9770258a-6ac1-4db5-956a-ada08beb7ae5/SK-000713/001/thumb_350/gallery.jpg";

                var items:ArrayCollection = new ArrayCollection(new Array(objOrderItem));
                dgMain.dataProvider = new ArrayCollection(items.source);
            }   
        ]]>
    </fx:Script>
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>

    <mx:VBox width="100%">
        <mx:HBox>
            <mx:Button label="Rebind" click="BindData()" />
        </mx:HBox>

        <!-- Items for Distribution Order -->
        <mx:DataGrid id="dgMain" resizableColumns="false" draggableColumns="false"
                     sortableColumns="false" rowCount="1" variableRowHeight="true">
            <mx:columns>
                <mx:DataGridColumn headerText="Thumb" sortable="false" width="60">
                    <mx:itemRenderer>
                        <fx:Component>
                            <mx:HBox horizontalGap="0" verticalScrollPolicy="off" horizontalScrollPolicy="off" width="100%">

                                <fx:Script>
                                    <![CDATA[
                                        protected function image1_completeHandler(event:Event):void
                                        {
                                            outerDocument.doImageDownloaded(imgThumb);
                                        }
                                    ]]>
                                </fx:Script>

                                <mx:Image id="imgThumb" source="https://encrypted-tbn1.google.com/images?q=tbn:ANd9GcTTuc9n_oweh-dv4LUljzh0Lxzn1AvZchODUoSAeGePaDwPqUuw"
                                          complete="image1_completeHandler(event)"/>    
                            </mx:HBox>
                        </fx:Component>
                    </mx:itemRenderer>
                </mx:DataGridColumn>
            </mx:columns>
        </mx:DataGrid>
        <mx:Label text="Text After Grid" />
    </mx:VBox>
</s:WindowedApplication> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T20:06:15.610

尝试使用 setTimeout 函数，延迟时间可能为 100，而不是 callLater()。在 callLater() 失败的某些情况下对我有用。

# c# - 使用数据注释检查特定值

> ID：11730497
> 
> 赞同：2
> 
> 时间：2012-07-30T22:16:50.367
> 
> 标签：c#, jquery, asp.net, asp.net-mvc-3

我的数据模型中有以下属性：

```
[Required]
[DataType(DataType.Text)]
[Display(Name = "First Name")]
public string FirstName { get; set; }

[Required]
[DataType(DataType.Text)]
[Display(Name = "Last Name")]
public string LastName { get; set; } 
```

我的文本框目前有一个占位符，因此当他们专注于文本框时，占位符将在文本框中消失，如果他们没有在文本框中输入任何内容，则文本框 val ( `$(textbox).val()`) 等于“名字”或“姓”，我如何检查这个，以便在我的验证中返回一个错误，如果`FirstName`或`LastName`等于“名字”和“姓氏”，“请填写名字/姓氏”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-30T22:35:34.857

您应该编写自己的 ValidationAttribute 并将其用于您的属性

简单示例：

```
public sealed class PlaceHolderAttribute:ValidationAttribute
{
    private readonly string _placeholderValue;

    public override bool IsValid(object value)
    {
        var stringValue = value.ToString();
        if (stringValue == _placeholderValue)
        {
            ErrorMessage = string.Format("Please fill out {0}", _placeholderValue);
            return false;
        }
        return true;
    }

    public PlaceHolderAttribute(string placeholderValue)
    {
        _placeholderValue = placeholderValue;
    }
} 
```

像这样在您的财产上使用它：

```
[Required]
[DataType(DataType.Text)]
[Display(Name = "First Name")]
[PlaceHolder("First Name")]
public string FirstName { get; set; } 
```

# desire2learn - 上传到 Desire2Learn 中的储物柜

> ID：11730504
> 
> 赞同：0
> 
> 时间：2012-07-30T22:17:29.807
> 
> 标签：desire2learn

我在将文件上传到 D2L 的 API 中的储物柜时遇到问题。发送数据如下。

对此，我收到 404 错误。我尝试过使用“test2.jpg”和图像/jpeg 的内容类型，我也尝试过使用纯文本代替二进制并使用 text/plain 作为内容类型。

任何意见将是有益的

谢谢。

```
POST /d2l/api/le/1.0/locker/myLocker/test?<auth Keys> HTTP/1.1  
User-Agent: PECL::HTTP/1.6.1-dev (PHP/5.2.6)  
Host: <server>
Accept: */*  
Content-Type: multipart/mixed; boundary=BOUND  
Content-Length: 252  

--BOUND  
Content-Type: application/json  

{"Description":"test2.tst", "IsPublic":false}  
--BOUND  
Content-Disposition: form-data; name=""; filename="test2.tst"  
Content-Type: application/x-octetstream  

<base64_encoded string>
--BOUND-- 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:29:54.733

解决方案是确保标题使用 \r\n 而不是仅 \n 来分隔部分。

# expressionengine - 表达式引擎中有什么方法可以模拟 Wordpress 的简码功能？

> ID：11730506
> 
> 赞同：1
> 
> 时间：2012-07-30T22:17:39.727
> 
> 标签：expressionengine

我对 Expression Engine 比较陌生，在学习它的过程中，我发现一些 WordPress 已经丢失了一段时间的东西。对我来说重要的是短代码，因为我将使用它们来允许 CMS 用户将更复杂的内容与他们的其他内容放在一起。

除了即将推出的私人测试版插件外，我在 EE 中没有看到任何真正的等价物。

作为初始测试，我试图通过在内容字段中使用分隔字符串（例如#foo#）来伪造简码，然后使用正则表达式将它们拉出并将它们传递给可以从 EE 数据库中检索内容的函数。

这让我想到了第二个问题，即在查看 EE 的 API 文档时，似乎没有一种简单的方法可以以编程方式检索通道条目（考虑类似于 WP 的内置 get_posts 函数）。

所以我的问题是：

a) 可以这样做吗？b) 如果是这样，我的处理方法是否合理？还是我的方法中缺少一些愚蠢的明显东西？

重申一下，我在这里的主要目标是有一些方法允许管理内容的人在他们的内容中放置一个代码，这些代码将被频道内容替换。

感谢您给我的任何建议或帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T20:40:18.553

这是您正在寻找的功能的一个简单示例。

1) 从安装[Low Replace](http://gotolow.com/addons/low-replace)开始。

2) 创建两个名为 gv_hello 和 gv_goodbye 的全局变量，其值分别为“Hello”和“Goodbye”。

3）将此文本放入条目的正文中：

[问好]

很高兴见到你。

[说再见]

4) 将其放入您的模板中，将 Low Replace 标签包裹在您的正文字段周围。

{exp:low_replace find="[say_hello]|[say_goodbye]" replace="{gv_hello}|{gv_goodbye}" multiple="yes" } {body} {/exp:low_replace}

5）它应该将其输出到您的浏览器中：

> 你好
> 
> 很高兴见到你。
> 
> 再见

显然，这是一个非常简单的例子。您可以将完整的 HTML 放入全局变量中。例如，我们使用它来渲染复杂的交互式图形，该图形不可编辑，但任何编辑器都可以轻松地将其拖放到页面中。

不幸的是，由于解析顺序问题，EE 标签在全局变量中不起作用。如果您在短代码输出中需要 EE 标记，则需要使用[低变量](http://gotolow.com/addons/low-variables)插件而不是全局变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T17:35:29.143

继续评论：

你有你想要支持/包含的那种短代码的例子吗？因为我怀疑从文本字段或所见即所得字段控制页面布局是否可行。

如果您希望编辑者能够调整布局或显示/隐藏页面上的额外部分，让他们访问频道中的一些额外字段，（imo）更易于管理和面向未来。例如，一些选择字段、关系（或播放）字段或矩阵，让他们选择在页面上包含/排除哪些部分，或者从另一个通道中提取内容的哪个条目。

正如评论中所说：我完全理解你是否想用来自另一个领域的图像或数据替换一些#foo#标签（参见其他答案：nsm-transplant、low_replace）。但是，让编辑器访问短代码并从中挑选出来，就像编写模板引擎来为 ee-template-engine 生成 ee-template 代码一样。

我认为，使用一些自定义字段让编辑选择要嵌入的部分更易于管理。

话虽如此，您可以制作一个插件来解析 textareas 内容中的短代码，然后进行大量编程，以从您想要支持的其他模块中获取数据。对于频道条目，您可以通过objectiveHTML 从频道数据库中构建。[https://github.com/objectivehtml/Channel-Data](https://github.com/objectivehtml/Channel-Data)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-27T13:13:19.947

还有一个名为 Shortcode 的插件，您可以在 [Devot-ee](http://devot-ee.com/add-ons/shortcode)找到 该页面的引用：

> 简码旨在允许作者和编辑更动态地使用内容，允许将可重用的内容位甚至整个功能注入 EE 的任何领域

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T22:26:11.587

我听到了，我也想念 WP 的简码——尽管它们如此容易工作的原因是`the_content()`. EE 的极大灵活性带来了更少的一揽子解决方案。

我建议看看[NSM Transplant](http://ee-garage.com/nsm-transplant)。它应该适合你。

# iphone - 自定义 inputView 在模态演示期间未正确设置动画

> ID：11730508
> 
> 赞同：0
> 
> 时间：2012-07-30T22:17:51.473
> 
> 标签：iphone, modalviewcontroller, uiviewanimation, presentmodalviewcontroller, inputview

我首先以模态方式展示一个 viewController，使用默认动画，其中视图从下到上显示。在 viewWillAppear 中，我将第一响应者提供给具有自定义键盘作为其 inputView 的文本字段。当视图为模态演示设置动画时，此自定义键盘会立即出现，并且视图的其余部分在其后面从下到上进行动画处理。当我使用默认键盘时，它会正确地与视图的其余部分一起制作动画。

如何在主视图动画时让自定义键盘视图动画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:28:57.353

尝试让您`UITextField`成为内部的第一响应者，`viewDidAppear`而不是`viewWillAppear`.

# google-fusion-tables - fusion-tables 卡片视图的自定义布局

> ID：11730511
> 
> 赞同：1
> 
> 时间：2012-07-30T22:17:59.697
> 
> 标签：google-fusion-tables

请帮忙：

我正在尝试在表格卡片显示的“自定义布局”选项中使用自定义内联 css 显示。当我保存自定义 css 时，它会显示在卡片显示中，但是当我重新加载页面时，它会恢复为标准显示（只有前 10 列没有格式化）

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T00:35:43.773

这是我们现在正在处理的一个错误。它应该很快修复。带来不便敬请谅解！

# javascript - Javascript：检测 Internet Explorer 是否发送混合 http on https 页面消息

> ID：11730514
> 
> 赞同：0
> 
> 时间：2012-07-30T22:18:16.543
> 
> 标签：javascript

我别无选择，只能使用 http 资源在 https 页面上传递内容。

我想检测 Internet Explorer 是否显示了“混合 http/https”消息/提示，因此我可以显示一条消息以通知用户此内容不会在 https 页面上显示不接受 http 内容。

寻找一个功能来检测。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:22:48.973

通常，是否出现应该只取决于 IE 的版本以及是否实际混合内容。
因此，理论上，您可以检测它是否是执行此操作的 IE 版本，然后在请求用户必须接受它才能使站点正常工作之前显示一条消息。

# xml - Adobe Air 3.3 或 AS3：用于搜索 xml 的动态变量

> ID：11730518
> 
> 赞同：1
> 
> 时间：2012-07-30T22:18:34.283
> 
> 标签：xml, actionscript-3, air, flash-cs5

我正在使用 Flash CS6 - Adob​​e AIR 3.3：我不想在我的 XML 中准确输入我想搜索的内容，而是想使用一个可以更改的动态变量来搜索不同的类别和日期。以下是我想使用的代码：

```
var someCategory:String = new String("food");
var someDay:String = new String("monday");

var locationsLoader:URLLoader = new URLLoader();
locationsLoader.load(new URLRequest("http://www.myfile.xml"));
locationsLoader.addEventListener(Event.COMPLETE, init);

//load xml

function init(e:Event):void
{
theXML = new XML(e.target.data);
theXML.ignoreWhitespace = true;
e.currentTarget.close();

for(var i:int = 0; i < theXML.someCategory.length(); i++) 
{
if(theXML.someCategory[i].somdDay != "un")
{
//do soemthing
}
} 
```

此代码目前仅在我在“for”和“if”循环中实际键入“food”和“monday”时才有效。有什么建议么？

XML将是...

```
<xml>
<food>
<monday>yes</monday>
</food>
<food>
<monday>yes 2</monday>
</food>
<food>
<monday>un</monday>
</food>

</xml> 
```

这是目前有效的：

```
var someCategory:String = new String("food");
var someDay:String = new String("monday");

var locationsLoader:URLLoader = new URLLoader();
locationsLoader.load(new URLRequest("http://www.myfile.xml"));
locationsLoader.addEventListener(Event.COMPLETE, init);

//load xml

function init(e:Event):void
{
theXML = new XML(e.target.data);
theXML.ignoreWhitespace = true;
e.currentTarget.close();

for(var i:int = 0; i < theXML.food.length(); i++) 
{
if(theXML.food[i].monday != "un")
{
//do soemthing
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:39:42.610

I would use a conditional statement and use a `for each` loop instead of a `for` loop:

```
var cat:String = new String("food");
var day:String = new String("monday");

for each (var node:XML in theXML[cat].(child(day) != 'un')) {
    trace(node[day]);
} 
```

The `theXML[cat].(child(day) != 'un')` part means

> (loop) for each children of **theXML** with node name **[cat]** having child node with node name **[day]** the value of which is not 'un'.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:04:17.087

复制您的代码并逐步更改每个部分，并且我所做的每次更改似乎都得到了相同的结果，所以我相信下面的内容是正确的。

```
package
{
    import flash.display.Sprite;

    public class TestAS3Project extends Sprite
    {
        public var theXML:XML = new XML(<xml>
                <food>
                    <monday>yes</monday>
                </food>
                <food>
                    <monday>yes 2</monday>
                </food>
                <food>
                    <monday>un</monday>
                </food>

            </xml>);
        public function TestAS3Project()
        {
            init();
        }
        private function init():void
        {

            var someCategory:String = new String("food");
            var someDay:String = new String("monday");

            theXML.ignoreWhitespace = true;

            for(var i:int = 0; i < theXML[someCategory].length(); i++) 
            {
                if(theXML[someCategory][i][someDay] != "un")
                {
                    //do soemthing
                    trace(theXML[someCategory][i][someDay]);
                }
            }
        }
    }
} 
```

# c++ - OpenCV 作为网络服务

> ID：11730522
> 
> 赞同：0
> 
> 时间：2012-07-30T22:18:49.803
> 
> 标签：c++, web-services, opencv, face-recognition

我正在研究使用本地二进制模式直方图的面部识别，遇到了 OpenCV。在 OpenCV 中，局部二进制模式直方图具有比较直方图“compareHist”的功能。如何在 Web 服务器上执行此功能？是否可以在 Web 服务器上运行 OpenCV？（我正在考虑自己编写整个函数，但是它基于多个自定义创建的类，而且相当麻烦——我应该使用什么语言？——这将是我最后的手段）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T21:12:16.977

OpenCV 带有[cv::FaceRecognizer](http://docs.opencv.org/trunk/modules/contrib/doc/facerec/index.html)，其中包括 Eigenfaces、Fisherfaces 和**Local Binary Patterns Histograms**。它带有非常详细的文档，请参阅：

*   [http://docs.opencv.org/trunk/modules/contrib/doc/facerec/index.html](http://docs.opencv.org/trunk/modules/contrib/doc/facerec/index.html)

无需自己实现。如果你想用另一种语言来做这件事，那么你可以很容易地在 OpenCV 的 contrib 模块中查找实现。我相信你可以在那里得到一些印象。

至于网络服务器。如果你有一个真正的服务器，那么你肯定可以把 OpenCV 放在那里并与之交互。如果您想快速完成某些事情，请查看用于 cv::FaceRecognizer 的 OpenCV Python 绑定。昨天我在 OpenCV QA 页面上发了一个帖子：

*   [http://answers.opencv.org/question/253/broken-python-bindings-with/?answer=255#post-id-255](http://answers.opencv.org/question/253/broken-python-bindings-with/?answer=255#post-id-255)

但是，由于我这边的错误，它有点复杂。官方 OpenCV 2.4.2 版本中有一个错误，因此要使 Python 绑定正常工作，您需要主干版本。请注意，源代码现在由 git 托管，因此您可以通过以下方式获取它：

`git clone git://code.opencv.org/opencv.git`

例如。然后，如果您在 Linux 中，您可以按照本教程了解如何安装 OpenCV：

*   [http://docs.opencv.org/trunk/doc/tutorials/introduction/linux_install/linux_install.html](http://docs.opencv.org/trunk/doc/tutorials/introduction/linux_install/linux_install.html)

或者如果您在 Windows 中，则：

*   [http://docs.opencv.org/trunk/doc/tutorials/introduction/windows_install/windows_install.html](http://docs.opencv.org/trunk/doc/tutorials/introduction/windows_install/windows_install.html)

可能有帮助。确保您已安装`python-dev`并`python-numpy`安装，以便编译 Python 绑定。如果您在 Windows 中，只需安装 Python2.7 和 NumPy (http://www.numpy.org)。

您可能也对我*的 Python 人脸识别指南*感兴趣，该指南位于：

*   [https://github.com/bytefish/facerecognition_guide](https://github.com/bytefish/facerecognition_guide)

这显示了两种算法的真正轻量级实现。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2015-03-18T23:32:42.067

免责声明我是创始人。

Algorithmia 通过我们的 API 将 OpenCV 作为服务提供。

[http://algorithmia.com/users/opencv](http://algorithmia.com/users/opencv)

# c# - Textbox.Text 输入未绑定到属性

> ID：11730525
> 
> 赞同：0
> 
> 时间：2012-07-30T22:19:02.177
> 
> 标签：c#, wpf, data-binding, textbox

我创建了一个对象，并希望通过 OneWayToSource 模式显式绑定到该对象的属性。但是，此绑定根本不起作用。当程序初始化时，它在文本框周围也有一个红色边框，当我只希望在单击按钮后验证输入时。我最后的努力是将源嵌入到元素本身，但没有这样的运气。这是我所拥有的：

```
<StackPanel.Resources>
    <my:HoursWorked x:Key="hwViewSource" /> 
</StackPanel.Resources>

<TextBox Style="{StaticResource textBoundStyle}" Name="adminTimeTxtBox">
    <Binding Source="{StaticResource hwViewSource}" Path="Hours" UpdateSourceTrigger="PropertyChanged" Mode="OneWayToSource">
        <Binding.ValidationRules>
            <my:NumberValidationRule ErrorMessage="Please enter a number in hours." />
        </Binding.ValidationRules>
    </Binding>
</TextBox> 
```

HoursWorked 对象如下所示：

```
//I have omitted a lot of things so it's more readable
public class HoursWorked : INotifyPropertyChanged
{

    private double hours;

    public HoursWorked()
    {
        hours = 0;
    }

    public double Hours
    {
        get { return hours; }
        set 
        {
            if (Hours != value)
            {
                hours = value;
                OnPropertyChanged("Hours");
            }
        }
    }

    #region Databinding
    public event PropertyChangedEventHandler PropertyChanged;
    private void OnPropertyChanged(String info)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(info));
        }
    }
    #endregion
} 
```

初始化窗口后，这是我拥有的代码部分：

```
public partial class Blah : Window
{
     private HoursWorked newLog;

public Blah()
{
    InitializeComponent();
    newLog = new HoursWorked();
    adminTimeTxtBox.DataContext = newLog;
}

private void addAdBtn_Click(object sender, RoutedEventArgs e)
{
    AddHours();

}

private void AddHours()
{
    if (emp.UserType.Name == "Admin")
    {
        if(!ValidateElement.HasError(adminTimeTxtBox))
        {
                item.TimeLog.Add(newLog);
                UpdateTotals();
                adminTimeTxtBox.Clear();
        }
         }

    }
} 
```

最后 ValidateElement 看起来像这样：

```
public static class ValidateElement
{
    public static bool HasError(DependencyObject node)
    {
        bool result = false;
        if (node is TextBox)
        {
            TextBox item = node as TextBox;
            BindingExpression be = item.GetBindingExpression(TextBox.TextProperty);
            be.UpdateSource();
        }
        if (Validation.GetHasError(node))
        {
            // If the dependency object is invalid, and it can receive the focus,
            // set the focus
            if (node is IInputElement) Keyboard.Focus((IInputElement)node);
            result = true;
        }

        return result;

    }
} 
```

它可以正确验证，但是每次我检查属性是否更新时，它都没有。我真的需要帮助，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:30:26.977

您有 2 个 HoursWorked 类的实例。

一个是通过这个标签在资源中创建的，`<my:HoursWorked x:Key="hwViewSource" />`然后你在你的窗口中创建一个 newLog = new HoursWorked(); 并将其设置到 adminTimeTxtBox 的 DataContext 中......因此您绑定到的那个（资源之一）与您正在更新的那个（Window 内的那个）不同。

您可以将绑定更改为

`<Binding Source="{Binding}"`……

然后不需要资源中定义的那个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:37:39.150

`TextBox.Text`属性是字符串类型，你的`Hours`属性是双倍的。

您必须创建一个[`ValueConverter`](http://msdn.microsoft.com/en-us/library/ms613620)或辅助属性来将字符串解析为双精度，反之亦然。

# ruby-on-rails - Rails Web 服务器没有启动（但在我断电之前它已经启动了）

> ID：11730526
> 
> 赞同：1
> 
> 时间：2012-07-30T22:19:05.110
> 
> 标签：ruby-on-rails, webrick

我遇到了一个奇怪的问题，我的 Rails Web 服务器（webrick）无法启动。一切正常，但后来我的 Mac（OS 10.8）因缺乏电源而进入睡眠状态。（我对windows比较熟悉，所以我不确定它是睡眠还是休眠或者技术状态是什么，但基本上电池太低了。）

我将其插入并再次打开了 mac，但现在`rails s`给了我以下输出：

```
rails s
  exists  
  exists  app/controllers
  exists  app/helpers
  exists  app/models
  exists  app/views/layouts
  exists  config/environments
  exists  config/initializers
  exists  config/locales
  exists  db
  exists  doc
  exists  lib
  exists  lib/tasks
  exists  log
  exists  public/images
  exists  public/javascripts
  exists  public/stylesheets
  exists  script/performance
  exists  test/fixtures
  exists  test/functional
  exists  test/integration
  exists  test/performance
  exists  test/unit
  exists  vendor
  exists  vendor/plugins
  exists  tmp/sessions
  exists  tmp/sockets
  exists  tmp/cache
  exists  tmp/pids
identical  Rakefile
identical  README
identical  app/controllers/application_controller.rb
identical  app/helpers/application_helper.rb
identical  config/database.yml
identical  config/routes.rb
identical  config/locales/en.yml
identical  db/seeds.rb
identical  config/initializers/backtrace_silencers.rb
identical  config/initializers/inflections.rb
identical  config/initializers/mime_types.rb
identical  config/initializers/new_rails_defaults.rb
overwrite config/initializers/session_store.rb? (enter "h" for help) [Ynaqdh] q
aborting app 
```

我查看了[在启动 rails webrick 服务器时报告错误](https://stackoverflow.com/questions/4367710/reporting-errors-in-launching-rails-webrick-server)的线程，并且[rails 脚本/服务器没有启动服务器](https://stackoverflow.com/questions/3949855/rails-script-server-doesnt-start-the-server)，但这似乎是一个不同的问题，因为我之前已经安装并工作了所有东西。

再次，它运行良好，直到我的电池电量不足并关闭电源。

我还尝试过创建一个全新的 rails 项目，但最初只是`rails dummy`创建了一个虚拟项目。当我`rails s`在项目中运行并选择 diff 选项时，我得到以下输出：

```
overwrite config/initializers/session_store.rb? (enter "h" for help) [Ynaqdh] d
--- s/config/initializers/session_store.rb  2012-07-30 19:36:06.000000000 -0400
+++ s/config/initializers/session_store.rb20120730-26164-2nbrgz-0   2012-07-30 19:36:28.000000000 -0400
@@ -6,7 +6,7 @@
 # no regular words or you'll be exposed to dictionary attacks.
 ActionController::Base.session = {
   :key         => '_s_session',
-  :secret      => '0de919861d30e11a894d96d395ec2340fd40d88309035bea3033bbf2a6f3c3e0b3a42afa9ec208533547e025be363c19439d79b22ed5b04709442e9d50dcf985'
+  :secret      => '2609e7c27f761383e77cda8b7a7dead04ffa6ad47ce3bd540f946a1fcdfe9dec9a87cc71880e50db9f94d68afe5c4bce9efb621024a9ce69a7af22b44a266a43'
 }

 # Use the database for sessions instead of the cookie-based default, 
```

提前感谢您的帮助。我迷路了。

# android - 获取以编程方式创建的微调器的位置

> ID：11730531
> 
> 赞同：1
> 
> 时间：2012-07-30T22:19:30.380
> 
> 标签：android, eclipse, spinner, programmatically-created

用户在 中输入一个数字`EditText`，然后应用程序以编程方式创建那么多微调器。当用户单击 UI 底部的“保存”按钮时，我无法获取这些微调器的位置以保存它们。

当我尝试通过以下方式获取位置时：`mArraySpinner.add(spinner.getSelectedItemPosition());`如下所示，我在数组中有几个空位置，就像侦听器在创建时触发，然后它只会将最后一个微调器位置保存在数组的最后一个元素中。

这是我创建微调器的代码：

```
for(int i = 1; i <= numStockTanks; i++) {
        TableRow tR = new TableRow(this);
        // creates the textView
        tV1 = new TextView(this);
        tV1.setText("Stock Tank #" + i + " size: ");

        // add spinner to row
        spinner = new Spinner(this);
        ArrayAdapter<CharSequence> adapterStockTankSize = ArrayAdapter.createFromResource(
                this, R.array.StockTankSize, android.R.layout.simple_spinner_item);
        adapterStockTankSize.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinner.setAdapter(adapterStockTankSize);
        spinner.setTag(i + 600);
        spinner.setOnItemSelectedListener(new OnItemSelectedListener() {
            public void onNothingSelected(AdapterView<?> parent) {}
            public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {
                mArraySpinner.add(spinner.getSelectedItemPosition());
            }
        });

        // add the TextView and the editText to the new TableRow
        tR.addView(tV1);
        tR.addView(spinner);

        // add the TableRow to the TableLayout
        tL.addView(tR,new TableLayout.LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));    
    } // end for statement 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:25:41.937

您`spinner`每次都在重新分配变量，但该`onItemSelected`方法正在使用此变量。您需要每次重新声明此微调器变量，以便该方法正在寻找一个唯一的`Spinner`对象。

更改`spinner = new Spinner(this);`为`final Spinner spinner = new Spinner(this);`，并删除`spinner`您已经拥有的任何声明。

# jquery - jQuery幻灯片滚动重叠问题

> ID：11730533
> 
> 赞同：0
> 
> 时间：2012-07-30T22:19:49.397
> 
> 标签：jquery, html, css, overlapping

我正在为我的乐队设计 EPK，但遇到了一些问题。在我的屏幕上，每个浏览器的比例都很棒。但是在我的贝斯手电脑上，元素是重叠的。我想知道是否有人可以帮助我找出原因？

这是网站： http: [//www.indefinitedyad.com/epk.html](http://www.indefinitedyad.com/epk.html)

这是一个带有代码的jsFiddle：http: [//jsfiddle.net/mkk9F/](http://jsfiddle.net/mkk9F/)

以下是它在她屏幕上的显示方式：http: [//img.photobucket.com/albums/v410/justice4all_quiet/Screenshot2012-07-29at22149PM.png](http://img.photobucket.com/albums/v410/justice4all_quiet/Screenshot2012-07-29at22149PM.png)

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:38:45.647

这里的问题是你`<ul id="menu">`有`position: absolute;`. 这使得按钮粘在框架上，而不是随窗口缩放。但是，您`<div class="container">`不会这样做。因此，包含图片等的 div 将随着您使窗口更小/更大而缩放。但按钮不会。

这个问题非常容易重现。**使您的浏览器窗口更小**。这是修复您的 html 设置的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:39:48.033

据我所知，这实际上是一个 CSS 问题，这是因为您的 .content 宽度设置为 90%。如果您调整浏览器的大小或使用更高分辨率的显示器，它看起来还不错。如果您想要设置大小（1080px 在我的浏览器上效果很好），您需要将内容划分设置为定义的宽度，或者查看网格系统，例如可以在[此处](http://cssgrid.net/)找到的 1140px 网格，它适用于移动设备和屏幕调整大小.

希望这可以帮助！

# matlab - Matlab：具有预定义总体的 K 均值聚类

> ID：11730536
> 
> 赞同：0
> 
> 时间：2012-07-30T22:20:04.267
> 
> 标签：matlab, statistics, machine-learning, k-means

我试图区分两个人群。每个总体都是一个 NxM 矩阵，其中 N 固定在两者之间，M 长度可变（N=每次运行的列特定属性，M=运行次数）。我已经研究过 PCA 和 K-means 来区分两者，但我对最佳实践感到好奇。

据我所知，在 K-means 中，没有初始“校准”来选择集群，以便区分已知的双峰群体。它只是将距离最小化并将数据分配给任意数量的人口。我想告诉聚类算法，我想要两个群体分开的最佳拟合。然后我可以使用我从未来数据集的初始聚类中获得的拟合。任何帮助、示例代码或阅读材料将不胜感激。

-R

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:05:41.163

这真的取决于数据。但只是为了让您知道 K-means 确实会陷入局部最小值，所以如果您想使用它，请尝试从不同的随机起点运行它。PCA 也可能很有用，但与任何其他光谱聚类方法一样，您对聚类过程的控制要少得多。我建议您使用具有多个随机起点的 k-means 对数据进行聚类，并且 c 它是如何工作的，然后您可以使用 K-NN 预测和*学习*每个新样本（我不知道它是否对您的情况有用） .

检查[惰性学习](http://en.wikipedia.org/wiki/Lazy_learning)器和[K-NN](http://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm)进行预测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T03:33:23.853

K-means 和 PCA 通常用于*无监督学习*问题，即您拥有单批数据并希望找到一些更简单的方法来描述它的问题。原则上，您可以对您的数据运行 K-means（K=2），然后评估您的两类数据与该算法找到的数据集群的匹配程度（注意：您可能需要多次启动） .

听起来你有一个*监督学习*问题：你有一个训练数据集，它已经被划分为两个类。在这种情况下，k-最近邻（如@amas 所述）可能是最类似于 k-means 的方法；然而，支持向量机也可能是一种有吸引力的方法。

我经常参考Trevor Hastie（作者）、Robert Tibshirani（作者）、Jerome Friedman（作者）*的 The Elements of Statistical Learning: Data Mining, Inference, and Prediction, Second Edition（Springer Series in Statistics* ）。

# correlation - 第一和第三变量之间的相关性

> ID：11730537
> 
> 赞同：1
> 
> 时间：2012-07-30T22:20:19.087
> 
> 标签：correlation, pearson

假设我们有 x 和 y as之间的`corr(x,y)`相关性以及 y 和 z as 之间的相关性`corr(y,z)`。关于 x 和 z ie 之间的相关性可以说什么`corr(x,z)`？

感谢您的阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:32:45.237

我觉得你不能说太多。

相关函数甚至不是传递函数 - 换句话说，如果两者`corr(x,y) > 0`和`corr(y,z) > 0`，你不能说 if `corr(x,z) > 0`，`= 0`or `< 0`，除非这两个相关性特别高（）...`corr(x,y)`^(`2`)`+ corr(y,z)`^(`2`)`) > 1`

例如看这篇文章：`ftp://163.25.117.117/gyliao/TODylan/Is%20the%20Property%20of%20Being%20Positively%20Correlated%20Transitive.pdf`

（由于某种原因，我无法插入可点击的链接）

# domain-driven-design - 对两个并行聚合、实体、值对象层次结构进行建模

> ID：11730540
> 
> 赞同：0
> 
> 时间：2012-07-30T22:20:36.700
> 
> 标签：domain-driven-design, entity, value-objects

我正在为以下域设计而苦苦挣扎，据我了解，这些域设计似乎不符合 DDD 的概念。

一方面，我有 Device->Sensor->Measurement 层次结构，建模为聚合，以 Device 作为根，Sensor 作为实体，Measurement 作为 VO。到目前为止，一切都很好。

现在，每个设备都有一个类型，传感器也是如此。同时测量值是指被测量的变量（例如温度）。这是事情破裂的地方。

我最初将类型建模为值对象，但类型有限，许多设备和传感器共享相同的类型。

然后我决定将它们建模为一个聚合，遵循与设备聚合类似的结构：DeviceType->SensorType->Variable。但是，这不起作用，因为传感器可能会引用 SensorType 和 Measurement to Variable，从而打破了仅允许从另一个聚合内部引用聚合根的规则。此外，可能会发生不止一个 DeviceType 包含相同类型的传感器（例如电池电量传感器），并且不止一个 Sensor 测量相同的变量（例如电池电量水平）。

这导致我将每个实体（DeviceType、SensorType、Variable）作为独立的实体，每个实体都有自己的（退化的）。

我的具体问题是：我是否正确解释了聚合、实体、VO 的概念，或者只有根是反模式的这种贫血聚合？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T05:13:11.837

建模没有硬性规定，你应该做最适合你用例的事情。话虽如此，聚合主要用于维护一组实体的不变量。我在 DeviceType、SensorType 和 Variable 之间看不到任何此类约束，因此我看不出有任何理由将它们放入聚合中。将它们保持为独立的实体（甚至是值对象）应该没问题。

# c# - 在文本框聚焦事件的部分视图中清除表数据

> ID：11730549
> 
> 赞同：0
> 
> 时间：2012-07-30T22:21:30.520
> 
> 标签：c#, javascript, jquery, html, partial-views

我有一个部分视图（动态），其中一列中有一个选择列表。我使用 Jquery 根据在文本框中输入的内容来填充此列表。

每当用户更改该文本框中的输入时，我都想清除表中的数据。因此，我尝试了以下选项：

```
 $("#StudentTable tr>td").detach(); 
        $("#StudentTable tr>td").remove(); 
        $("#StudentTable tr>td").empty(); 
```

但我收到一个错误：

```
'get(...).options' is null or not an object 
```

在这条线上：

```
$("#TeachingAssistant").get(0).options.length = 0; 
```

这里，“#TeachingAssistant”是局部视图中的选择列表“id”。

```
 <td>
            <select name="TeachingAssistant" id="TeachingAssistant"></select>
        </td> 
```

我想它正在删除我的选择列表，因此没有识别它。我应该如何处理这个？还有其他方法可以清除表数据吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T12:18:38.260

```
$("#StudentTable tr td").html(''); 
```

会清空你桌子上的每一个 td，但是如果你在任何 td 内容中绑定了任何事件，你可能会遇到一些问题！

要清除选择选项，您可以使用它：

```
$("#TeachingAssistant option").remove(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T12:44:00.840

尝试以下 jquery 代码（1.0 版）删除表 '#StudentTable' 中的 html：

```
$("#StudentTable").html(""); 
```

或者

```
$("#StudentTable").empty(); 
```

作为参考，您可以访问链接：[jQuery - html()](http://api.jquery.com/html/)

要从下拉列表中获取选定的值，请使用以下代码：

```
$("#TeachingAssistant").val(); 
```

清算：

```
$("#TeachingAssistant").val(""); 
```

作为参考，您可以访问链接：[jQuery - Get value](http://api.jquery.com/val/)

# python - 列表字典中的 Python 最小长度/最大值

> ID：11730552
> 
> 赞同：-2
> 
> 时间：2012-07-30T22:21:51.067
> 
> 标签：python, list, dictionary, max, min

由于要求更改，不得不重新编写问题。

我有一本字典，如下所示：

```
d = {'a': [4, 2], 'b': [3, 4], 'c': [4, 3], 'd': [4, 3], 'e': [4], 'f': [4], 'g': [4]} 
```

我想获取与字典 d 中最小长度相关联的键，以及具有最大值的键。

在这种情况下，长度最小的键（此字典中列表的最小长度）应返回

```
'e, 'f', 'g' 
```

那些具有最大值（每个列表中的整数之和）的应该返回

```
'b' 'c' 
```

我试过了

```
min_value = min(dict.itervalues())
min_keys = [k for k in d if dict[k] == min_value] 
```

但这并没有给我想要的结果。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-30T22:33:36.973

```
def get_smallest_length(x):
    return [k for k in x.keys() if len(x.get(k))==min([len(n) for n in x.values()])]

def get_largest_sum(x):
    return [k for k in x.keys() if sum(x.get(k))==max([sum(n) for n in x.values()])]

x = {'a': [4, 2], 'c': [4, 3], 'b': [3, 4], 'e': [4], 'd': [4, 3], 'g': [4], 'f': [4]}

print get_smallest_length(x)
print get_largest_sum(x) 
```

回报：

```
['e', 'g', 'f']
['c', 'b', 'd'] 
```

# c# - 如何从 C# 中的列表中获取网卡值？

> ID：11730558
> 
> 赞同：0
> 
> 时间：2012-07-30T22:22:27.483
> 
> 标签：c#, listbox, nic

我是 C# 新手，我到处搜索，没有找到任何解决方案。

```
private void kryptonButton5_Click(object sender, EventArgs e)
    {
        adapters();
        MessageBox.Show(listBox1.Text);//How to get selected card name only ?
    }

    private void adapters()
    {
        foreach (NetworkInterface net_card in NetworkInterface.GetAllNetworkInterfaces())
        {
           listBox1.Items.Add(net_card.Name + "  " + net_card.Description + "  " + net_card.Id);
        }
    } 
```

**我怎样才能只获得选定的卡名？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:30:04.383

你可以试试这个：

```
 var selectedValues = listBox1.SelectedItem.ToString().Split('  ');

    if (selectedValues.Length == 3)
    {
       var cardName = selectedValues[0];
       MessageBox.Show(cardName);
    } 
```

希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:26:22.980

每当您在 .NET 框架中遇到不熟悉的对象时，请花几分钟时间阅读文档。您可以通过将插入符号放在类型名称上并按 F1 来快速完成此操作。

阅读类型描述，然后阅读该类型每个成员的名称和简要描述。框架文档中的大多数对象还提供了如何使用它们的示例代码。

这是[ListBox 类](http://msdn.microsoft.com/en-us/library/t1f8aedx)。

# php - 我在代码中做错了什么？我正在调用 jquery/json 来调用数据库中的数据

> ID：11730561
> 
> 赞同：0
> 
> 时间：2012-07-30T22:22:40.923
> 
> 标签：php, mysql, json

我已经粘贴了 index.php 和 jsonPhp.php 的代码。我是 JSON 新手并使用 ajax 学习 json。在这里，我正在尝试使用 json 从服务器获取数据。当我单击链接服务器数据时，来自服务器的数据必须在不使用 jQuery/json 重新加载页面的情况下出现。我已经编写了代码，但我没有让它工作。请帮忙。谢谢。

```
<head>
    <title>JSON WITH PHP</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"
    type="text/javascript"></script>
    <script type="text/javascript">
        < ![CDATA[
        $(function () {
            $('#click').click(function () {
                $.post('jsonPhp.php', function (data) {
                    //$("#content").html(data)+'<br>';
                    var pushedData = jQuery.parseJSON(data);
                    var htmlData = "";
                    //loop through using jQuery
                    $.each(pushedData, function (i, field) {
                        htmlData = htmlData + '-' + field.id + ',' + field.place + ',' + field.description + '<br>';
                    });
                    $('#content').html(htmlData);
                });
            });
        });]] >
    </script>
</head>

<body>Click on the link below to get the data from the Server Dynamicallly!
    <br
    />
    <a href="#" id="click">Server Data</a>
    <div id="content"></div>
</body> 
```

```
<?php

    $db = mysql_connect("localhost","root","")or die(mysql_error());

    mysql_select_db("places",$db) or die(mysql_error());

    if(isset($_POST['place']))
        $place=$_POST['place'];
    if(isset($_POST['description']))
        $description=$_POST['description'];

     $myrows = array();

     $result = mysql_query("SELECT * FROM search");

     while( $row = mysql_fetch_assoc($result) ) {
         $myrows[] = $row;
     }

    echo json_encode($myrows);

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:28:19.853

您的 jQuery 帖子没有发布必要的项目。

请小心使用此代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:28:21.543

尝试指定使用 POST 请求发送的参数，结果如下：

```
$.post('jsonPhp.php', { place:'myplace', /* other params */ }, function (data) { ... 
```

# objective-c - removeFromSuperview 的 EXC_BAD_ACCESS - 使用 ARC

> ID：11730565
> 
> 赞同：0
> 
> 时间：2012-07-30T22:22:50.090
> 
> 标签：objective-c, ios, uiviewcontroller

在我的一个 ViewControllers (ViewController A) 中，我有以下代码：

```
AlertViewController *aViewController = [[AlertViewController alloc] initWithNibName:@"AlertViewController" bundle:nil];
[self.view addSubview:[aViewController view]];
[self.view bringSubviewToFront:[aViewController view]]; 
```

在 AlertViewController 中，我有一个按钮，当用户单击它时，我有：

```
[self.view removeFromSuperview]; 
```

每当我单击按钮时，结果都是 EXC_BAD_ACCESS。我无法弄清楚问题所在。如果该信息有帮助，我的项目正在使用 ARC，并且 ViewController A 是导航控制器堆栈的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:31:47.593

这里的问题是 UIView 不拥有它的 UIViewController。在第一个代码块中，您通过将 UIView 添加到子视图来保留它，但让 UIViewController 消失。UIViewController 中的 UIView 是特殊的，你不能让这种情况发生。

确保创建 UIView 的 UIViewController 与视图一样长。

# opencv - 英特尔 AVCSR -（唇读以增强语音识别）

> ID：11730566
> 
> 赞同：0
> 
> 时间：2012-07-30T22:22:57.497
> 
> 标签：opencv, voice-recognition

我有兴趣使用支持唇读的库来增强音频/语音识别。我发现英特尔的 AVCSR（与 OpenCV 库捆绑在一起）将是一个值得考虑的有趣选项。是否有任何其他库可用于实现相同的目标（唇读以增强语音识别）？

我也无法找到下载这个库的来源。我已经尝试过 SourceForge (http://sourceforge.net/projects/opencvlibrary/) 的 OpenCV 包，但它似乎没有 AVCSR 包/文件。已经使用过类似工具的人能否将我指向可以找到这些源文件的地方（在 OpenCV 中或其他地方）？

谢谢你。

# java - Spring MVC 中的数据绑定错误处理

> ID：11730567
> 
> 赞同：4
> 
> 时间：2012-07-30T22:23:00.587
> 
> 标签：java, spring, jakarta-ee, spring-mvc, spring-webflow

我对 Spring MVC 中的数据绑定有疑问。

我有一个控制器，它接受 @RequestBody 形式的 JSON 请求。我有所有的 JSR 303 验证，它就像一个魅力。

*   JSON 请求

    ```
    public class TestJSONRequest {

        @Size(min=10,message="{invalid.demo.size}")
        String demo;

        int code;
    } 
    ```

*   控制器

    ```
    @Controller
    @RequestMapping("/test")
    public class TestController {

        public void testEntry(@RequestBody TestJSONRequest jsonRequest,ModelMap map)

          Set<ConstraintViolation<TestJSONRequest>> violationList = validator.val(jsonRequest);
          ....
          ....
          TestJSONResponse response = // Do complex Logic.
          modelMap.addattribute("TestJSONResponse",response);
        }
    } 
    ```

但是一旦传入的 JSON 数据绑定到 Request 对象，JSR 303 验证就会启动。

如果我发送输入 JSON 请求`ab`的**代码**字段，绑定本身就会失败。

我该如何处理？

我想捕捉那些数据绑定错误并在我的控制器中进行某种通用错误处理。

你能帮我解决这个问题吗？

PS - 我使用的是 Spring 3.0.3

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T23:40:02.923

According to the current [Spring documentation (V3.1)](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-ann-requestbody) :

*Unlike @ModelAttribute parameters, for which a BindingResult can be used to examine the errors, @RequestBody validation errors always result in a MethodArgumentNotValidException being raised. The exception is handled in the DefaultHandlerExceptionResolver, which sends a 400 error back to the client.*

Now you can to tell Spring that you'd like to handle this, by creating a new method, as follows:

```
@ExceptionHandler(MethodArgumentNotValidException.class)
public String handleValidation(MethodArgumentNotValidException e, ModelMap map) {
    List<ObjectError> errors = e.getBindingResult() .getAllErrors();
    // your code here...
    return "path/to/your/view";
} 
```

Finally, have a read of the Spring docs wrt `@ExceptionHandler`. There's most likely some useful information there.

# c# - 如何将滑块放在视频画笔上

> ID：11730568
> 
> 赞同：0
> 
> 时间：2012-07-30T22:23:06.563
> 
> 标签：c#, windows-phone-7, xaml

我正在尝试创建一个滑块控件，它将确定我的 MainPage 中的视频画笔的 scaletransform，并且想知道是否有可能以某种方式将此滑块放在视频画笔的顶部（我想全屏显示）？目前我正在为我的布局使用一个网格，其中一个视频画笔占据了整个屏幕，除了屏幕底部的两个按钮，但我想可能使用一个画布并以一种可以考虑当前的方式放置这个滑块和未来的 Windows Phone 设备的屏幕尺寸。我不确定如何在不为滑块设置恒定尺寸的情况下准确完成此操作。例如，滑块可以在纵向模式下水平放置在屏幕底部附近，并且在左侧和右侧之间有 50 像素的空间。有人可以协助如何做到这一点吗？

编辑

在 videobrush 上放置一个子元素可以工作，尽管我想放置多个滑块，这会产生错误。我还想在每个滑块的上方和下方添加信息，因此我选择了一个堆栈面板来执行此操作（但只允许一个堆栈面板作为子元素？）。

```
<Border x:Name="videoRectangle" Grid.Row="0" Grid.ColumnSpan="2" >
            <Border.Background>
                <VideoBrush  x:Name="viewfinderBrush">
                    <VideoBrush.RelativeTransform>
                        <CompositeTransform x:Name="viewfinderBrushTransform" CenterX=".5" CenterY=".5" Rotation="90" />
                    </VideoBrush.RelativeTransform>
                </VideoBrush>
            </Border.Background>

            <!--<StackPanel VerticalAlignment="Top">
                <TextBlock x:Name="resolutionValueTextBlock" HorizontalAlignment="Center" Text="{Binding Value, ElementName=resolutionSlider}"/>
                <Slider x:Name="resolutionSlider" HorizontalAlignment="Stretch" Margin="50,5,50,5"/>
                <TextBlock x:Name="resolutionTextBlock" HorizontalAlignment="Center" Text="resolution"/>
            </StackPanel>-->

            <StackPanel VerticalAlignment="Bottom">
                <TextBlock x:Name="zoomNumberTextBlock" HorizontalAlignment="Center" Text="{Binding Value, ElementName=zoomSlider}"/>
                <Slider x:Name="zoomSlider" HorizontalAlignment="Stretch" Margin="50,5,50,5"/>
                <TextBlock x:Name="zoomTextBlock" HorizontalAlignment="Center" Text="zoom"/>
            </StackPanel>

</Border> 
```

如果可能的话，我希望两个堆栈面板都可用，但如果不是，我想我只能使用底部的一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T08:53:56.943

留在网格中：

```
<Grid>
    <Rectangle>
        <Rectangle.Fill>
            <VideoBrush ... />
        </Rectangle.Fill>
    </Rectangle>
    <Slider HorizontalAlignment="Stretch"
            VerticalAlignment="Bottom"
            Margin="50,5,50,5"/>
</Grid> 
```

# asp.net-mvc-4 - 事件处理程序中的图像调整器 User.Identity

> ID：11730569
> 
> 赞同：2
> 
> 时间：2012-07-30T22:23:17.750
> 
> 标签：asp.net-mvc-4, imageresizer

为图像访问限制添加了 AuthorizeImage 事件处理程序。当我尝试检查用户名和身份验证状态时注意到以下内容：

下面不会导致异常，但似乎会破坏它。无论是否经过身份验证，都会显示未找到图像的默认图标。测试了 this.User = 相同的结果。HttpContext.Current.User = 相同的结果

```
Config.Current.Pipeline.AuthorizeImage += delegate(IHttpModule sender, HttpContext context, IUrlAuthorizationEventArgs e)
{
    if (context.User.Identity.IsAuthenticated) { context.Response.Redirect("http://db2.stb00.s-msn.com/i/AF/263B63C5E656379CEE93E7A8692EC7.gif"); }    
}; 
```

以下工作正常（this.User 和 HttpCONtext.Current.User 也是如此）

```
Config.Current.Pipeline.AuthorizeImage += delegate(IHttpModule sender, HttpContext context, IUrlAuthorizationEventArgs e)
{
    context.Response.Redirect("http://db2.stb00.s-msn.com/i/AF/263B63C5E656379CEE93E7A8692EC7.gif"); 
}; 
```

这总是重定向

```
Config.Current.Pipeline.AuthorizeImage += delegate(IHttpModule sender, HttpContext context, IUrlAuthorizationEventArgs e)
{
    if (context.User == null)
        context.Response.Redirect("http://db2.stb00.s-msn.com/i/AF/263B63C5E656379CEE93E7A8692EC7.gif");
}; 
```

我开始在 Application_Start 中进行测试，但实际上也尝试了 Application_PostAuthenticateRequest。虽然结果哪里一样。我通过自定义代码进行身份验证，但使用标准格式验证来设置 cookie。[Authorize] 在应用程序中工作正常。对这里可能出了什么问题有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T12:04:13.230

您的服务器配置为仅针对某些请求扩展名（例如 .aspx、.ashx 等）运行 FormsAuthenticationModule。有两种方法可以解决此问题。

1.  在（对于集成模式）中删除并重新添加 FormsAuthenticationModule `<system.webServer> <modules>`，删除 precondition="managedHandler" 属性：
2.  启用 RAMMFAR (runAllManagedModulesForAllRequests)

这篇文章包含有关实现 #1 和 #2 的更多详细信息：

[如何在 IIS 7.5 上使用 ASP.NET 表单身份验证保护静态文件？](https://stackoverflow.com/questions/2903292/how-do-i-protect-static-files-with-asp-net-form-auhentication-on-iis-7-5)

# c - 如何从 json 字符串中获取值？

> ID：11730571
> 
> 赞同：0
> 
> 时间：2012-07-30T22:23:24.860
> 
> 标签：c, json

假设我有一个字符串，其中包含：

```
{"ticker":{"high":8.976,"low":8.843,"avg":8.9095,"vol":2096.78,"last":8.845,"buy":8.946,"sell":8.843,"server_time":1343686701}} 
```

我将如何获取这些数字并将它们放入一个单独的变量中？

例如 ：

```
int high = 8.976
int low = 8.843
/* and so on */ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T22:25:30.743

很多方法。

“sscanf”是一种选择。

标准字符串函数“strstr()”、“atof()”等是另一个。

我建议找到一个好的 JSON 解析库。例如：

*   [http://www.digip.org/jansson/](http://www.digip.org/jansson/)

# spring - 在整个应用程序中注入一个 bean 以在控制器中使用

> ID：11730572
> 
> 赞同：1
> 
> 时间：2012-07-30T22:23:25.527
> 
> 标签：spring, servlets, dependency-injection, controller

我正在使用 spring mvc 3.1.x 和 jets3t。我有一个 DataAccessObject 实例化为 Singleton bean..

我设法通过扩展 applicationcontextloader 类并将其添加到 web.xml 来使其工作

**编辑：**

我改变了我的方法，我尝试了注入和自动连接，但它不适合我的需要。我所做的是实现 ApplicationContextAware 并将其设置为 bean，在我使用它的代码中如下：

```
ApplicationContext ctx = BannerApplicationContext.getApplicationContext();
BannerGenericDAO bdao = (BannerGenericDAO) ctx.getBean("dao"); 
```

我是 Spring 和一般 servlet 世界的新手。问题是：

1.  这样做的最佳方法是什么？这被认为是“最佳实践”吗？
2.  您如何注入一个对象，同时保留自动装配未提供的其他方法字段？
3.  如何让一个对象在整个应用程序中使用？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:34:05.127

You could use annotations in your controller.

```
@Controller
public class MyController{

  @Autowired  // or @Inject, which is more JEEish (JSR330).
  private SomeDao daoService;

} 
```

Given "SomeDao" is the type of your singleton DAO, of course.

# javascript - JavaScript if 语句的更简洁的方式

> ID：11730573
> 
> 赞同：0
> 
> 时间：2012-07-30T22:23:26.953
> 
> 标签：javascript, if-statement

好吧，我知道这是一团糟。这就是我在这里发布它的原因。我希望你能理解我试图创造的逻辑。有没有更好的方法来实现这一点？

```
else if (((!(lc(this).getByIndex(i).dim2.Shirts)) && ('Nike' in lc(this).getByIndex(i).dim3)) 
    || (('Nike' in lc(this).getByIndex(i).dim3) && ('Shirts' in lc(this).getByIndex(i).dim2))) 
```

这里基本上有两个陈述：如果 Shirts AND Nike 存在或 Nike 但根本没有类别，我希望这个陈述证明是正确的。希望这会有所帮助，但我会将其移至代码审查，但会等待一个可靠的答案，以便有人获得信任:) ...感谢您的提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:11:24.527

根据 GitaarLAB 的回答，这个怎么样？

```
...
else {
    var x      = lc(this).getByIndex(i),
        y      = x.dim2.Shirts,
        nike   = 'Nike'   in x.dim3,
        shirts = 'Shirts' in x.dim2;

    if (!y && nike || nike && shirts) { ... }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T22:36:11.637

你可以这样做：

```
else {
  //comparisons
  var a=yadayadayada,
      b=blablabla,
      c=1024,
      d=document.getElementById('something').value;
      //and so on
  if( a===b || c<=d ){ //that should keep your if-clause a lot more readable!!
    //actions
  }
} 
```

希望这可以帮助！

**更新**（在 TS 更新之后）：现在我们对您的数据有了更多了解，您会问：“*如果 Shirts AND Nike 存在或 Nike 但根本没有类别，*则为真”，那么这就是您想要的：

```
else {
  var b='Nike', //brand
      c='Shirts', //category
      d=lc(this).getByIndex(i),
     d2=d.dim2,
     d3=d.dim3;
  if( ((b in d2) && d2[c]) || (b in d2) ){ 
    //actions
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T23:12:47.890

既然你有“耐克……等等”。在这两个语句中，您都可以将其缩小为：

```
else if ( ('Nike' in lc(this).getByIndex(i).dim3)
  && (!lc(this).getByIndex(i).dim2.Shirts || ('Shirts' in lc(this).getByIndex(i).dim2)) ) 
```

# objective-c - 向子视图添加视图会使我的应用程序崩溃

> ID：11730576
> 
> 赞同：0
> 
> 时间：2012-07-30T22:23:55.470
> 
> 标签：objective-c, uiview, crash, subview

当我添加子视图时，它会使我的应用程序崩溃。下面是发生的情况： View 确实加载调用了另一个类中的方法，然后该类调用了原始类中的 sortDataIntoSubs。然后尝试添加一个子视图，但它崩溃了，因为我相信它会循环导致对象超出数组范围问题的代码。我应该怎么办？

```
 - (void)viewDidLoad
{
searchText = [searchText uppercaseString];
self.title = searchText;
Download_Data *dwnLD = [[Download_Data alloc]init];
NSDate *finishDate = [NSDate date];
NSDate *startDate = [NSDate date];
NSDateComponents *dayComponent = [[[NSDateComponents alloc] init] autorelease];
dayComponent.day = -1;
NSCalendar *theCalendar = [NSCalendar currentCalendar];
startDate = [theCalendar dateByAddingComponents:dayComponent toDate:finishDate options:0];
[dwnLD downloadCSVFile:searchText startDate:startDate finishDate:finishDate key:1];
[super viewDidLoad];
}

-(void) sortDataIntoSubs:(NSMutableArray *) arrMTemp
{
NSMutableArray *arrDate = [[NSMutableArray alloc] init];
NSMutableArray *arrOpen = [[NSMutableArray alloc] init];
NSMutableArray *arrHigh = [[NSMutableArray alloc] init];
NSMutableArray *arrLow = [[NSMutableArray alloc] init];
NSMutableArray *arrClose = [[NSMutableArray alloc] init];
NSMutableArray *arrVolume = [[NSMutableArray alloc] init];
NSMutableArray *arrAdjClose = [[NSMutableArray alloc] init];
//Add every 7th object to the arrDate array.

[self setUpView];
}

-(void)setUpView
{

CGRect screenBound = [[UIScreen mainScreen] bounds];
UISegmentedControl *segMeg = [[UISegmentedControl alloc]init];
segMeg.center = CGPointMake(screenBound.size.width / 2,screenBound.size.height / 2);
segMeg.segmentedControlStyle = UISegmentedControlStylePlain;
NSArray *arrSegMeg = [NSArray arrayWithObjects:@"1w",@"2w",@"8w",@"16w",@"25w", nil];
[segMeg initWithItems:arrSegMeg];
[self.view addSubview:segMeg]; //This crashes

} 
```

视图由导航控制器处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:06:59.133

您正在初始化 segMeg 两次。尝试像这样重新排列它，看看它是否有帮助：

```
CGRect screenBound = [[UIScreen mainScreen] bounds];
NSArray *arrSegMeg = [NSArray arrayWithObjects:@"1w",@"2w",@"8w",@"16w",@"25w", nil];
UISegmentedControl *segMeg = [[UISegmentedControl alloc] initWithItems:arrSegMeg];
segMeg.center = CGPointMake(screenBound.size.width / 2,screenBound.size.height / 2);
segMeg.segmentedControlStyle = UISegmentedControlStylePlain;
[self.view addSubview:segMeg]; 
```

# php - 我需要一个关于如何让我的插入代码在 php 和 mysql 中工作的提示

> ID：11730578
> 
> 赞同：1
> 
> 时间：2012-07-30T22:24:09.700
> 
> 标签：php, javascript, mysql, ajax

我在更新和将数据插入数据库时​​遇到问题。我已经调试了大部分程序，所以我确定问题出在用于更新的代码行和用于插入数据的代码行。我很困惑，因为它们是使用相同代码的其他函数，并且我在每个函数中使用的所有变量都是在函数中本地声明的，所以我知道它们没有冲突。顶部的代码是打开与数据库和php的通信线路的所有数据库代码。该代码有效，我已经在其他程序中对其进行了测试。我仍然可以使用 SELECT 代码从数据库中提取数据，并且我已经检查并仔细检查了名称是否与表匹配。此代码是一些 ajax 代码的一部分，因此它会实时更新，但我使用 javascript 的帖子将数据很好地传输到 php 文件。所以我不知道我做错了什么，或者服务器是否有问题。如果有人有任何想法，请告诉我。此外，此代码的目的是让用户可以喜欢、收藏并给他们在我的网站上查看的内容打 5 星评分。

这是代码：

```
<?php include "base.php";?>
</head>
<?php
$rateMe = mysql_query("SELECT * FROM rating WHERE Username = '".$_SESSION['Username']."' AND Title = '".$_POST['myTitle']."'");
if(mysql_num_rows($rateMe) == 0)
{
    $registerquery = mysql_query("INSERT INTO rating (Username, Author, Star, Like, Favorite, Title) VALUES('".$_SESSION['Username']."','".$_POST['myAuthor']."','".$_POST['myrating']."','".$_POST['myLike']."', '".$_POST['myFavorite']."', '".$_POST['myTitle']."')");
}else
{
    $makeUpdate = mysql_query("UPDATE rating SET Star = '".$_POST['myrating']."' WHERE Username = '".$_SESSION['Username']."' AND Title = '".$_POST['myTitle']."'");
}
?> 
```

这是我要插入数据的表

表：评级

用户名 varchar(255)

作者 varchar(255)

星浮

像 varchar(255)

最喜欢的 varchar(255)

标题 varchar(255)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:43:12.313

这是您的插入查询在打印时可能的样子

```
INSERT INTO rating (Username, Author, Star, Like, Favorite, Title) VALUES('John','Jim','xx','xx', 'xx', 'xx') 
```

insert 语句中的`like`关键字可能会抛出如下错误

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取正确的语法以使用接近 'like) 值（'John'

检查您的更新是否有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:51:22.450

正如 Markus 所暗示的，您的代码极易受到 SQL 注入攻击。此外，PHP 手册强烈建议使用[mysqli](http://www.php.net/manual/en/mysqli.overview.php)扩展，而不是 mysql 扩展。

我建议您花点时间阅读[这篇](http://us3.php.net/manual/en/pdo.prepared-statements.php)关于 PDO、准备好的语句以及将数据插入/更新到模型中的正确方法的文章。

# python - 蟒蛇瓶饼干不断变化

> ID：11730580
> 
> 赞同：3
> 
> 时间：2012-07-30T22:24:14.777
> 
> 标签：python, cookies, setcookie, bottle

下面是我在瓶中设置和读取 cookie 的代码。

```
if request.get_cookie('mycookiename'):
        cookie_id = request.get_cookie('mycookiename')
    else:
        cookie_id=str(uuid4())
        response.set_cookie('mycookiename', cookie_id , max_age=31556952*2, domain='%s' % (cookie_domain)) 
```

当我去firefox和firebug时，我可以看到cookie已设置。但是，当我刷新页面时，我得到了一个新的 cookie。每个请求都是一个新的 cookie id。

那么，我该如何解决呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T15:14:17.013

此代码有效。如果您尚未定义 cookie，则使用 uuid4 设置新值 cookie。

在您的代码中，我猜您的“其他”条件很糟糕。

```
# -*- coding: utf-8 -*-
#!/usr/bin/env python
from uuid import uuid4
import bottle

@bottle.route('/cookie')
    def cookie():
        cookie_id = bottle.request.get_cookie('mycookiename', str(uuid4()))
        bottle.response.set_cookie('mycookiename', cookie_id)
        return 'hello cookie'

if __name__ == '__main__':
    bottle.run(host='localhost', port=8080) 
```

# javascript - Rally App SDK 2.0：在 rallymultiobjectpicker 重新过滤器商店中由托管侦听器调用 validate()

> ID：11730581
> 
> 赞同：1
> 
> 时间：2012-07-30T22:24:32.473
> 
> 标签：javascript, extjs, extjs4, rally

我一直在查看 rallymultiobjectpicker 的源代码，更具体地说，是 initEvents 函数中的这一行：

```
this.mon(this.inputEl, 'keyup', this.validate, this); 
```

它调用属于对象实例的验证函数。但是，经过进一步检查，我没有看到任何代码会触发重新过滤商店的行为，从而加载/附加外部值，这就是我目前看到的。

这是验证功能的来源（[http://bit.ly/MXH6CB](http://bit.ly/MXH6CB)）：

```
validate : function() {
    var me = this,
        isValid = me.isValid();
    if (isValid !== me.wasValid) {
        me.wasValid = isValid;
        me.fireEvent('validitychange', me, isValid);
    }
    return isValid;
} 
```

注意：对于它的价值，remoteGroup、remoteSort 和 remoteFilter 都设置为 false。

**编辑**：确实，触发行为的不是验证函数，而是对 AutoFilterable 类的 initFiltering 函数调用初始化按键侦听器，对文本输入进行过滤。

```
_onStoreLoad: function() {
    this.removePlaceholderText();
    this.groupRecords();
    this.initFiltering();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T18:11:49.067

过滤由[AutoFilterable](https://rallytest1.rallydev.com/apps/2.0p3/doc/#!/api/Rally.ui.picker.AutoFilterable)类处理，该类是 SDK 中的私有类。验证调用不会触发过滤。

# php - PHP 到 Powershell CSV 参数

> ID：11730582
> 
> 赞同：1
> 
> 时间：2012-07-30T22:24:40.393
> 
> 标签：php, arrays, powershell, csv, parameters

我正在尝试编写一个使用复选框供用户选择的 php 脚本。一旦用户选择了他们的复选框，我的 php 脚本就会将它们（或应该）更改为 CSV 文件。然后从我的本地计算机上的 powershell 脚本加载该文件，然后用于执行命令。

我遇到的问题分为两部分，我似乎找不到确切的答案。第一个问题是创建的 csv 文件在一行中。下面的函数从复选框的输入设置 csv 文件，但是它输出一个我不知道如何使用的单行 csv 文件。

```
function array_2_csv($array) {
$csv = array();
foreach ($array as $item) {
if (is_array($item)) {
    $csv[] = array_2_csv($item);
} else {
    $csv[] = $item;
}
}
return implode(',', $csv);
}

$fh = fopen("plugin.csv","w");
                fwrite($fh,$csv_data);
                fclose($fh); 
```

我相信的第二个问题来自我的 powershell 脚本。我已经在我的 csv 文件上强制添加了一个标题，但是我的开关似乎不起作用。我想切换查看数组，然后根据用户在我的 php 文件中选择的内容执行（在本例中为下载）一些代码。

```
$selectedPlugin = Import-Csv "plugin.csv" -Header @("Plugin") 
switch($selectedPlugin.Plugin)
{ namefromCheckbox1 //code
 namefromCheckbox2 //code
} 
```

只需将 id 设置为开关即可下载用户之前通过复选框选择的所有文件。

类似于[如何将 php 数组传递给本地 powershell 脚本](https://stackoverflow.com/questions/11349199/how-to-pass-php-array-to-local-powershell-script)

编辑：回答我自己的问题，就像下面提到的，我的 csv 在一行中返回。这是由

```
$newCSV = explode(",",$csv_data); 
```

然后稍后

```
foreach($newCSV as $item) {
fwrite($fh,$item.PHP_EOL); 
```

}

# mysql - 更新mysql最大值

> ID：11730584
> 
> 赞同：3
> 
> 时间：2012-07-30T22:24:43.660
> 
> 标签：mysql, max

我的数据库中有一个字段，我不想超过 100。我可以在查询中添加一些内容以确保它没有吗？

我通常最终会这样做：

```
UPDATE table SET field = field + $x
UPDATE table SET field = 100 WHERE field > 100 
```

这样的事情存在吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T22:28:16.990

```
UPDATE table 
  SET field = CASE WHEN field + $x <= 100
                     THEN field + $x
                     ELSE 100
              END ; 
```

或者：

```
UPDATE table 
  SET field = LEAST(field + $x, 100) ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:36:48.593

触发器呢？就像是

```
CREATE TRIGGER tg_limit BEFORE UPDATE ON tbl
    FOR EACH ROW
    BEGIN
        IF NEW.fld > 100 THEN
            SET NEW.fld = 100;
        END IF;
    END 
```

# iphone - Storyboard - 在 Storyboard 的第一个视图上呈现模态视图控制器

> ID：11730588
> 
> 赞同：1
> 
> 时间：2012-07-30T22:25:01.890
> 
> 标签：iphone, uitabbarcontroller, storyboard, modalviewcontroller, uistoryboardsegue

使用故事板，我创建了一个带有 5 个选项卡的选项卡栏应用程序，每个选项卡都包含一个 UINavigation 控制器。
当推送通知到达时，AppDelegate 通过呈现 UIAlertView 来处理它，让用户选择查看通知或取消通知。
如果他们选择查看它，我想展示一个带有任何新更新内容的模态视图控制器（基本上只是一些简单的文本。）
但是我如何在情节提要生成的视图上呈现一个模态视图控制器呢？故事板不加载任何 NIB 文件，那么如何将另一个 NIB 推送到不存在的 NIB 上？这甚至可以做到吗？
我尝试使用 segues - 但我的应用程序中没有任何 segues 视图，当我尝试创建一个时`performSegueWithIdentifier`- 崩溃！
坦率地说，在这一点上，我很乐意导航到已经位于我的一个导航控制器中的现有视图之一 - 并取消整个 Modal 的事情 - 但同样，我该怎么`push`做`present`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T02:41:13.610

嗯。我认为创建一个新的视图控制器，然后以模态方式呈现它。我可能错了——我以前从未使用过 Nibs。

```
UIViewController *viewController = [[UIViewController alloc]init];
[[NSBundle mainBundle] loadNibNamed:@"myViewNib" owner:self options:nil];
viewController.view = self.myViewFromNib;
[self presentModalViewController:viewController animated:YES]; 
```

在你.h; 不要忘记合成和所有这些。

```
@property (nonatomic, retain) IBOutlet UIView *myViewFromNib; 
```

我不确定它是否适用于 NIB，但我可以通过这种方式从情节提要中展示一个新的 VC。

# javascript - 非线性滚动

> ID：11730596
> 
> 赞同：6
> 
> 时间：2012-07-30T22:25:22.130
> 
> 标签：javascript, jquery, dom

滚动`s`就像是线性的：

```
s(x) = x             with x among [0, ∞] 
```

![在此处输入图像描述](../Images/0fe93acea8800d765b3c85a8876fc15d.png)

我想应用[一个更花哨的功能](http://jqueryui.com/demos/effect/easing.html)，比如`x^2`：

![在此处输入图像描述](../Images/eaf6cf57d33e07eca4d5f6da90ba51c5.png)

但我真的不知道这是否可能以及如何...

我想知道你对此的想法。

编辑

例如：是否可以**在**滚动时更改[`scrollTop`](https://developer.mozilla.org/en/DOM/element.scrollTop)值？

 **干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:46:08.893

解决问题的高级方法：

1.  捕获滚动​​事件，跟踪您获得最后一个事件的时间
2.  根据到最后一个事件的时间计算实际速度*vA*

    ```
    vA(dT):
        // if we last scrolled a long time ago, pretend it was MinTime
        // MinTime is the dT which, when scrolled
        // at or less than, behaves linearly

        if (dT > MinTime) dT = MinTime
        vA = MinTime / dT 
    ```

3.  设计一些转换以在*vA*上执行以获得所需的速度*vD*：

    ```
    vD(vA):
        // quadratic relationship
        vD = vA * vA 
    ```

4.  计算“滚动因子” *fS ，即**vD*与*vA*的比率：

    ```
    fS(vD, vA):
        // this step can be merged with the previous one
        fS = vD / vA 
    ```

5.  使用*fS*和*dSi*计算增量滚动*dS*，即初始滚动大小（1 个滚动事件的滚动价值）

     **```
    dS(fS):
        dS = fS * dSi 
    ```** 
***   滚动那么多

    ```
    Scroll(dS) 
    ```** 

 **如果每个 MinTime 滚动少于一次或更慢，您将获得典型的线性行为。如果您尝试更快地滚动，您将按照实际滚动速度进行二次滚动。

我不知道如何使用 javascript 实际执行此操作，但我希望它提供了一个开始的地方。

有没有我可以使用的滚动单位？我的术语看起来很有趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:52:21.820

这应该有助于捕获鼠标滚轮“速度”：

```
$(document).on('DOMMouseScroll mousewheel', wheel);

function wheel (event) {

  var delta = 0;

  if (event.originalEvent.wheelDelta) {
    delta = event.originalEvent.wheelDelta/120;
  } else if (event.originalEvent.detail) {
    delta = -event.originalEvent.detail/3;
  }

  if (delta) {
    handle(delta, event.currentTarget);
  }

  if (event.preventDefault) {
    event.preventDefault();
  }

  event.returnValue = false;
}

function handle (delta, target) {

   // scrollYourPageDynamiclyWithDelta(delta*delta);
   // manipulate of scrollTop here ;)

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T22:58:15.900

所以这更具概念性，但我认为使用其他人提到的功能来检测滚动速度，这可能会有所帮助。

逻辑：

1.  禁用在 div 上滚动的默认值。
2.  添加第二个 div，它只使用 @Tamlyn 的代码检测鼠标滚轮速度。也许你可以把这个 div 放在你的工作 div 后面，或者以某种方式将它包裹在你的内容周围或里面。我现在试着把它放在一边。
3.  接下来，根据第二个 div 的输入滚动 div。使用您的自定义滚动功能来更改滚动速度和滚动方向。这里可能会有一些“细节时刻的魔鬼”。****

# php - 如何在同一个 php 页面上使用 php imagecreate 代码？

> ID：11730598
> 
> 赞同：0
> 
> 时间：2012-07-30T22:25:30.367
> 
> 标签：php, php-gd

基本上，我正在创建一个非常简单的单页 .php 模板，我可以轻松地将其用于多个站点。我不想拖累额外的文件等。我知道 imagecreate 功能并且知道如何实现它。但是，到目前为止，我所看到的一切都涉及创建一个 img.php 文件，然后在要显示图像的页面上调用它。就我而言，我想消除 img.php 页面以及一些如何直接在我希望 php 创建图像的地方包含代码。

例如：

```
<?php
$my_img = imagecreate( 200, 80 );
$background = imagecolorallocate( $my_img, 0, 0, 255 );
$text_colour = imagecolorallocate( $my_img, 255, 255, 0 );
$line_colour = imagecolorallocate( $my_img, 128, 255, 0 );
imagestring( $my_img, 4, 30, 25, "thesitewizard.com",
  $text_colour );
imagesetthickness ( $my_img, 5 );
imageline( $my_img, 30, 45, 165, 45, $line_colour );

header( "Content-type: image/png" );
imagepng( $my_img );
imagecolordeallocate( $line_color );
imagecolordeallocate( $text_color );
imagecolordeallocate( $background );
imagedestroy( $my_img );
?> 
```

我需要将此代码保存到文件中。我们称之为：myimage.php。然后为了让 php 创建图像，我需要将此代码放在我希望显示图像的页面上：

```
<img src="myimpage.php" alt="Image created by a PHP script" width="200" height="80"> 
```

我不妨扔进真实的图像文件，因为这否定了我想要实现的目标。所以我的问题是：如何使用 imagecreate 而无需创建第二个 php 页面来调用？

我需要将这段代码放在同一页面上的原因是因为我想将一些变量传递给它。

```
<h2><a href="./" title="<?php echo $title; ?>"><?php echo $title; ?></a></h2>
THIS IS HERE THE IMAGE GOES (THe IMAGE IS A BASIC BOX THAT DISPLAYS THE CONTENTS OF $IMAGE) 
```

基本上，我希望图像显示 $title 的内容。所以如果代码是从另一个页面中提取的，我不能这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:32:08.080

您可以使用[Data URI 方案](http://en.wikipedia.org/wiki/Data_URI_scheme)在页面中创建图像并将其内嵌在同一页面中：

```
<img src="data:image/png;base64,*base_64_data_from_imagecreate*" alt="Image"> 
```

要捕获输出，您必须执行以下操作：

```
ob_start();
imagepng($my_img);
$imagedata = ob_get_contents();
ob_end_clean();

$imagedata = base64_encode($imagedata);

echo '<img src="data:image/png;base64,' . $imagedata . '" alt="Image" />'; 
```

希望这就是您正在寻找和帮助的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-04T15:08:06.653

请记住，虽然您可以使用 Data URI 方案将图像数据保存在 html 中，但这不一定是一个聪明的主意，因为浏览器将无法缓存图片，但每次调用站点时都必须重新下载。

浏览器通常只下载一次图像，然后只向服务器发送一个“小”请求，检查他们的图像缓存是否仍然是最新的。因此，如果您的图像小于此类请求的 http 开销，那就没问题了。否则我不会推荐它。

# jquery - jquery：无法让 parents() 上的 appendTo 工作，可能不理解 parents() 方法？

> ID：11730600
> 
> 赞同：0
> 
> 时间：2012-07-30T22:25:55.513
> 
> 标签：jquery, prepend, parents, ancestry

以下代码块不起作用：

```
$("<span class=\"ideacount\">").prependTo(chapter.parents(".chapter")).each( function(index) {
    $(this).html((parseInt($(this).text() || 0)+1)+"");
}); 
```

其中“章节”是一个节点，在这种情况下，该节点在“章节”类的其他元素中嵌套了 5 个元素。

虽然这段代码的行为符合预期，但不是我想要的（它也添加到树结构的所有其他分支，而不仅仅是“章节”的祖先）：

```
$("<span class=\"ideacount\">").prependTo(".chapter").each( function(index) {
    $(this).html((parseInt($(this).text() || 0)+1)+"");
}); 
```

编辑：详细说明：

Chapter.parents().length

是 10（5 节课的跨度，5 里）

Chapter.parents(".chapter").length 为 0！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:31:55.967

尝试最亲近的人而不是父母。

```
$("<span class=\"ideacount\">").prependTo(chapter.closest(".chapter")).each( function(index) {
    $(this).html((parseInt($(this).text() || 0)+1)+"");
}); 
```

# powershell - 运行 Powershell ISE 脚本后如何使对象持久存在

> ID：11730604
> 
> 赞同：3
> 
> 时间：2012-07-30T22:26:10.110
> 
> 标签：powershell

这是我的脚本：

```
Add-Type -Path C:\MyClassLibrary\HidClassLib.dll

$hidDevice = New-Object HidClassLib.CAN_USBPort("test")
$hidDevice.openPort() 
```

当我从 PowerShell ISE 中的命令行运行此脚本时，它会正常运行并将 HidClassLib.dll 添加到我的路径中。

但是，$hidDevice 变量不会持续存在，在我可以使用它之前，我必须重新输入这两行。有什么办法可以让 $hidDevice 在运行脚本后持续存在？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T02:12:33.587

你的意思是它不会在会话之间持续存在？在这种情况下，请将其添加到您的 PowerShell 配置文件中！

这是一篇关于如何做到这一点的精彩文章：

[http://msdn.microsoft.com/en-us/library/windows/desktop/bb613488(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb613488(v=vs.85).aspx)

只需将行添加到适用的配置文件，它就会在每次打开 shell 时运行。

# android - Android 平板电脑/新设备上按钮状态的最佳实践

> ID：11730606
> 
> 赞同：0
> 
> 时间：2012-07-30T22:26:14.300
> 
> 标签：android, android-button

Android SDK 建议围绕 Normal、Disabled、Focussed、Focussed + Pressed 和 Focussed + Disabled 等开发按钮状态（如果在自定义背景上）。

我观察到，主要是安卓平板电脑和现代手机，他们都放弃了轨迹球，没有人真正支持他们。所以在那种情况下，专注和相关的状态永远不会变得可见。

是否有必要包括所有这些州？或者，我可以通过当前避开这些图形来智能地节省一些 APK 文件大小。

请发送您的想法..谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:26:14.300

我自己输入我的观点。到目前为止，我已经包括了所有状态，因为我认为从标准的角度来看它是最好的，并且我想到了一种情况，当用户真正遇到必须显示集中样式的状态时。我想象用户连接了外部硬件（如蓝牙键盘）并且它以某种方式使他们能够使用箭头键移动到这些按钮的情况。

请也围绕这个观点发表你的想法

# protobuf-net - protobuf-net 反序列化在集合上失败

> ID：11730610
> 
> 赞同：1
> 
> 时间：2012-07-30T22:26:25.347
> 
> 标签：protobuf-net

下面是在运行 protobuf-net 版本 2.0.0.480 的 WCF 环境中工作和不工作的类定义。

知道处理代码使用实际类型填充响应列表，在本例中为 SomeClassRow。

更奇怪的是，对于糟糕的 SomeResponse 版本，WCF 有时有效，有时无效。

这就是我使用 IDataRow 接口的原因。这让我的响应列表可以保存任何类型的行。

所以问题是，当列表是用强类型与接口 (IDataRow) 定义时，为什么 protobuf 无法反序列化？

```
Thanks,
Ninos

[ProtoContract]
[ProtoInclude(101, typeof(BaseClassInfo))]
public interface IDataRow
{
}

[ProtoContract]
[ProtoInclude(101, typeof(SomeClassRow))]
public class BaseClassInfo : IDataRow
{
   [ProtoMember(1)]
   public int SomeId { get; set; }
   ...
}

// This version of the class won't work because it defines the collection with the
// strongly type name i.e. List<Some
[ProtoContract]
public class SomeResponse
{
   [ProtoMember(1)]
   public List<SomeClassRow> Rows { get; set; }

   ...
}

// SomeClassRow is in turn an IDataRow.
[ProtoContract]
public class SomeClassRow : BaseClassInfo
{
   [ProtoMember(1)]
   public string Name { get; set; }

   [ProtoMember(2)]
   public int Value { get; set; }

   ...  
}

// But, if the response is defined as follows then the WCF deserializes correcty and ALWAYS.
[ProtoContract]
public class SomeResponse
{
   [ProtoMember(1)]
   public List<IDataRow> Rows { get; set; }

   ...
} 
```

# python - 将行复制/写入到另一个文件中，并对该行进行微小更改

> ID：11730611
> 
> 赞同：0
> 
> 时间：2012-07-30T22:26:34.267
> 
> 标签：python, string, concatenation

我正在尝试将文本写入新文件，而不会将“位置 12”的文本更改为“位置”+ newPosition +“位于 12”。

这可能吗？

我尝试写到行尾，但它写成一个新行而不是在最后连接

我的“线路”是>Q952U6 | 在第 12 位 | 开始= 519，结束= 541 | 描述：E530K | LUSC Z52178 M2536nse_231ation T20A-18-3409 Q952U6 E530K

```
 with open(filename) as f:
        with open(fileoutput,'w') as fOut:

            for line, line2 in itertools.izip_longest(f, f, fillvalue=''):
                tokenizer=int(line.split()[4])
                newPosition = get_new_indexs(tokenizer, str(line2))
                fOut.write(line+' | new position ='+str(newPosition)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:16:09.410

当您遍历文件时，每一行都将在末尾包含换行符。你必须把它从末端剥离。你可以这样做：

```
for line in file:
    line = line.rstrip('\n') 
```

或者，在您的具体情况下，您可以这样做：

```
fOut.write(line.rstrip('\n') + ' | new position =' + str(newPosition)) 
```

# android - 软键盘输入

> ID：11730612
> 
> 赞同：0
> 
> 时间：2012-07-30T22:26:41.270
> 
> 标签：android, android-edittext, android-softkeyboard

我的软键盘输入有问题。我有一个`EditText`字段，我需要用户输入美元金额。自然，我`android:inputType="number"`在`main.xml`for 中指定了`EditText`。但是即使键盘上有键，用户也无法输入小数点。换句话说，用户只能输入整数而不能输入十进制数。我希望我的用户能够输入十进制数字，我应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:30:37.377

改用这个：

```
android:inputType="numberDecimal" 
```

这使您还可以输入小数点，例如货币和百分比，为您提供所需的内容。

希望这可以帮助！

# c# - WCF 服务缺少 xml 注释的编译器警告

> ID：11730615
> 
> 赞同：4
> 
> 时间：2012-07-30T22:27:26.677
> 
> 标签：c#, visual-studio-2010, documentation

我在 VS 2010 中有一个 C# 项目，它有 WCF 服务引用，我们收到很多关于 XML 文档的警告。我可以为reference.cs 文件添加#pragma disable warning 1591，但想要一个通用的解决方案

我遇到了[http://lvquoc.blogspot.com/2010/11/disable-xml-comment-warning-in-workflow.html](http://lvquoc.blogspot.com/2010/11/disable-xml-comment-warning-in-workflow.html)，其中 Quoc 巧妙地解释了如何做到这一点 WF 生成的代码所以想知道我们是否可以做到在这种情况下类似，但无法获得 WCF 的构建目标。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-06T20:09:09.213

我最近也遇到了这个。当您生成服务参考时，请确保它被标记为内部而不是公共。

验证将不再适用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-30T22:55:20.430

您可以通过在“抑制警告”中输入 1591 在项目属性的构建选项卡中抑制它们。

# ms-access - Access 2007 中对复合主键的引用

> ID：11730619
> 
> 赞同：4
> 
> 时间：2012-07-30T22:27:38.120
> 
> 标签：ms-access, foreign-keys, ms-access-2007, foreign-key-relationship, composite-primary-key

我环顾四周，发现了一些类似的问题，但它们是针对 SQL Server 的。

这是我创建的一个小型数据库，只是为了向您展示我想要建模的关系。基本上它很简单，每年有 12 个时期，一个时期-年的实例不能出现两次（时期 9 年 2012 年不能出现超过一次）。

![Access复合键数据库结构](../Images/5b66bf1ed3d954cea1978667a1b51e27.png)

所以我认为最好的建模方法是有一个表格周期，其中只有一个字段的值从 1 到 12，表格年份遵循相同的逻辑（2011，2012 ......），因为它是 N- to-N 关系我创建了 period_by_year 表，该表将它们连接起来以供 rpt_maintenance_kpi 使用。现在棘手的部分是，为了使每个组合都是唯一的，我将 period_no 和 year_no 都设置为复合主键。在我看来，这很好地解决了这个问题，但是我被困在如何从 rpt_maintenance_kpi（或任何其他表）中引用这个复合主键。我尝试进行两次连接，但这似乎不起作用（创建第二个 rpt_maintenance_kpi 表，我相信这不会做我想做的事）。

那么如何处理复合主键的外键呢？

提前谢谢了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T09:32:09.247

使用维护创建年份或期间关系，然后双击关系行以编辑关系或将第二部分（相应的年份或期间）拖动到维护并在询问您是否要编辑关系时选择是。您现在可以添加第二行，如下所示：

![与两个字段的关系](../Images/2235578a4c2893d2ed4d16889a64c710.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-18T05:49:56.283

复合键当然很有帮助并且可以解决您的问题，但是如果您真的想避免复合键连接，另一种完成您需要的替代方法是稍微重新设计您的表结构。由于总是根据月份和年份组合来寻找最终报告，因此拥有 MthYear 维度（或表格）会有所帮助。以下可以是该表中的条目 - 采用 yymm 格式：

1301 1302 1303……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………… 1312

您可以在同一个表中以更具描述性的形式具有更多属性，例如第二个字段可以是 Jan-13、Feb-13....等。

MthYear 字段可以是您的主要字段，可以连接到报表维护表中的 MthYear。如果您需要在查询或报告中使用通配符，这不仅可以避免使用复合主键，还可以帮助您仅过滤年份或月份。希望这对你有帮助......Arvind

# android - 如何不显示电子邮件正文？

> ID：11730621
> 
> 赞同：1
> 
> 时间：2012-07-30T22:27:51.787
> 
> 标签：android, email

我正在开发一个 android 应用程序，我想发送一封电子邮件。

下面的代码工作正常，但我需要特别的一件事……</p>

此代码在用户选择电子邮件应用程序选项后，将打开显示电子邮件正文的所选客户端，让他点击发送。

问题是我想在电子邮件正文中发送密码。因此，任何人都可以单击重新发送按钮，无需发送即可轻松查看密码。

我想发送一封电子邮件而不显示正文，或者只是发送而不显示电子邮件应用程序选项……（我已经保存了目标电子邮件）。

有谁知道怎么做？

```
final Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);

emailIntent.setType("message/rfc822");
emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, new String[] { mailRecover });
emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, subject);
emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, text);

App.this.startActivity(Intent.createChooser(emailIntent, getApplicationContext().getString(R.string.send_password_recover))); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:33:53.150

> 有谁知道怎么做？

编写您自己的电子邮件客户端，可能使用 Android 的 JavaMail 端口。

当您使用 时`ACTION_SEND`，您是在要求其他人的应用代表您的应用发送内容。但是，您不能强制其他应用程序执行任何操作，例如不向用户显示电子邮件正文。

# android - 如何检测我的用户第一次下载了我的 Android 应用程序的哪个版本？

> ID：11730622
> 
> 赞同：0
> 
> 时间：2012-07-30T22:27:51.677
> 
> 标签：android, android-version

我意识到将来可以通过使用某种包含应用程序版本并且仅在第一次运行时设置的 SharedPreferences 值来解决这个问题。但是，我正在考虑将广告添加到我的一个应用程序中，并且我不想在不为他们提供更多价值的情况下用广告轰炸现有用户。

因此，我想知道是否有某种先天属性可以让我检测到这一点，或者对于这个版本来说是否为时已晚，因为我需要事先实现它。不幸的是，该应用程序非常简单，所以目前我什至没有使用任何偏好。谢谢！

*（我考虑过在 AndroidEnthusiasts 上问这个问题，但我认为这确实是一个 SDK 问题，开发人员能够更好地回答）*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:35:26.800

不，您无法检测到以前下载或最初下载的 APK 的应用版本。您只能检测当前应用的应用版本。

我能想到的解决这个问题的唯一方法是实现一个你拥有的更新`SharedPreferences`，它设置了类似`"has_downloaded" = true`. 一旦*所有*用户都更新了，你更新，停止设置`"has_downloaded"`变量，然后检查它。如果是`true`，则它是您的初始用户之一，否则，展示广告。

但是，如果您拥有庞大的用户群，这远非可行的解决方案。我仍然有用户使用 2 个月以上的版本。此外，如果他们必须重新安装（或者如果他们清除应用程序数据），这些数据将会丢失。

如果您的应用程序之前一直在保存数据，您可以检查此数据是否存在，并且在所有未来版本中，将其保存为不同的名称。但是，您仍然会遇到这种方法的重新安装问题。

# forms - 如何使用 lxml 操作复选框

> ID：11730623
> 
> 赞同：0
> 
> 时间：2012-07-30T22:27:54.173
> 
> 标签：forms, python-3.x, lxml

我在[这里](http://lxml.de/lxmlhtml.html)遵循了 lxml 文档，但仍然无法检查复选框。我对 python 和 lxml 很陌生，但这似乎是一个非常简单的任务。

下面的代码没有出现任何错误，并且我通过运行确认输入名称是正确的：

```
print(page.forms[1].inputs.keys()) 
```

我尝试使用以下变体来使代码正常工作，但均无济于事：

```
page.forms[1].inputs['LH_TitleDesc'].value = "1"
page.forms[1].inputs['LH_TitleDesc'].value = "0"
page.forms[1].inputs['LH_TitleDesc'].checked = True
page.forms[1].inputs['LH_TitleDesc'].checked = "TRUE" 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T01:02:03.100

我只是通过使用 firebug 对其进行了更多修改，并注意到默认情况下复选框未选中并且值设置为 1。因此这是解决问题的代码（注意缺少引号！

```
page.forms[1].inputs['LH_TitleDesc'].value = 0 
```

# php - 从 Facebook 身份验证重定向中删除参数

> ID：11730631
> 
> 赞同：1
> 
> 时间：2012-07-30T22:28:43.237
> 
> 标签：php, facebook

我使用 PHP SDK 并按照示例进行操作。[https://github.com/facebook/php-sdk](https://github.com/facebook/php-sdk)

当我使用 Facebook 登录并授予访问权限时，该页面将重定向到我当前的页面，但 url 包含`state`and `code`。如何避免显示这些参数？

代码如下：

```
"oauth.php":
<?php
require 'sdk/facebook.php';

$facebook = new Facebook(array(XXX,XXX));
$user = $facebook->getUser();
if ($user) {
  try {
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}

if ($user) {
  $logoutUrl = $facebook->getLogoutUrl();
} else {
  $loginUrl = $facebook->getLoginUrl($params);
}
?>

+++++++++++++++++++
"index.php":

<?php include 'oauth.php'; ?>
<!DOCTYPE html>
<html>
<head></head>
<body>
  <div>
  <?php if ($user): ?>
    <img src="https://graph.facebook.com/<?php echo $user; ?>/picture">
  <?php else: ?>
    <a href="<?php echo $loginUrl; ?>">Login with Facebook</a>
  <?php endif ?>
  </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:44:50.703

尝试在代码末尾添加标题（身份验证后）

```
 header('Location:'.$currentPage); 
```

# android - 一个 ListView 在两个布局中使用，第二个布局不更新

> ID：11730632
> 
> 赞同：0
> 
> 时间：2012-07-30T22:28:43.260
> 
> 标签：android, listview, layout, user-interface, adapter

我有一个主要活动，它使用`FrameLayout`屏幕分为左侧导航和右侧内容面板。左侧面板用于导航以将不同的布局加载到右侧面板（称为`contentLayout`）中，右侧面板可以将多个布局粘合在一起。我`ListView`在左侧导航面板中有一个`onItemClickListener`s。在他们单独的`onItemClick`方法中，我使用`contentLayout.removeAllViews()`然后膨胀他们的布局，如下所示：

```
private final OnItemClickListener redListener = new OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        contentLayout.removeAllViews();
        if (myFirstClassLayout == null) {
            myFirstClassLayout = FirstClassLayout.getLayout(
                                layoutInflater, 
                                MyActivity.this, 
                                resources, 
                                new ArrayList<String>(),
                                new ArrayList<Desc>()
                            );
        }
        CommonClass.updateListeners();
        if (FirstClassLayout != null) contentLayout.addView(myFirstClassLayout);
    }
};

private final OnItemClickListener blueListener = new OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        contentLayout.removeAllViews();
        if (mySecondClassLayout== null) {
            mySecondClassLayout = SecondClassLayout.getLayout(
                                layoutInflater, 
                                MyActivity.this, 
                                resources, 
                                new ArrayList<String>(),
                                textList,
                                new ArrayList<Desc>(),
                                hash
                            );
        }
        CommonClass.updateListeners();
        if (SecondClassLayout != null) contentLayout.addView(mySecondClassLayout);
    }
}; 
```

在`FirstClassLayout`and中，我对`SecondClassLayout`a 进行膨胀，`ThirdClassLayout`其中包含一个使用. 这是一个样式视图，这意味着它在每个列表项的右侧显示一个类似单选按钮的图标。`ListView``commonListView``ArrayAdapter<String>``ListView``listChoiceIndicatorSingle`

当应用程序启动时，右侧的内容面板是空的。如果我触发`redListener`或`blueListener`，它将`commonListView`在右侧内容面板中显示 ，并且未选择任何列表项。如果我先触发红色，然后触发蓝色，然后在 中进行选择`commonListView`，则更改会反映回`FirstClassLayout`很棒！但是，当我继续从该 FirstClassLayout 中选择其他内容`commonListView`，然后触发`blueListener`转到 时`SecondClassLayout`，`commonListView`中的`SecondClassLayout`不反映我刚刚所做的选择。相反，它卡在我上次在`SecondClassLayout`.

如果我以相反的顺序执行测试，就会发生这种情况，因此根据我最后触发的侦听器，最后一个侦听器和布局将对两个布局具有适当的 UI 同步控制。我第一个触发的似乎只能控制自己。我需要两个听众能够`ListView`在任何给定时间在两个布局上显示完全相同的选定项目。

从最后一个布局到第一个布局的同步`commonListView`是通过`CommonClass.updateListeners()`它实现的：

```
 adapter.clear();
 for (String title: statusSet) adapter.add(title);
 adapter.notifyDataSetChanged();
 commonListView.setItemChecked(positionOfItemChecked, true);
 Log.i(TAG, "position checked = " + positionOfItemChecked);
 adapter.notifyDataSetChanged(); 
```

由于这从上次触发的布局到第一次触发，我认为这一定与 UI 刷新问题有关，但我到处搜索了一个好的解决方案并尝试了所有建议。该`Log.i`语句在触发的第一个或最后一个布局中正确打印出来`LogCat`，所以我知道它正确地命中了代码。我只是不明白为什么第一个无法控制最后一个。我试过了：

```
 commonListView.invalidate();
 ((BaseAdapter) commonListView.getAdapter()).notifyDataSetChanged(); 
```

和`AsyncTask`其他几个，但似乎没有什么可以刷新第一个布局以使其与第二个布局匹配。有没有人遇到过这样的问题？有谁知道如何解决或解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T05:37:18.860

添加视图后查看 contentLayout.requestLayout() 是否可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T19:45:19.597

我弄清楚是什么导致第二个占据了第一个。我继承了很多这段代码，所以我对所有部分都不熟悉。涉及其他几件。我终于找到了原作者使用实现自定义侦听器的自定义 AdapterWrapper 的代码部分。ThirdClassLayout 仅通过检查静态 ArrayAdapter 是否为空来创建一个新的 ArrayAdapter 和一个新的 AdapterWrapper。删除此检查允许为两种布局创建新的适配器对象。创建了自己的侦听器后，两种布局现在都会响应。

# iphone - 使用滑动导航视图

> ID：11730635
> 
> 赞同：0
> 
> 时间：2012-07-30T22:29:04.093
> 
> 标签：iphone, ios, xcode, xcode4, ios4

我正在制作一个带有左右手势控制的天气应用程序。这意味着用户可以通过在屏幕上向左/向右滑动来查看多个城市的天气。查看我想模仿其行为的示例应用程序的屏幕截图。

![在此处输入图像描述](../Images/64dfc529381c587bf09df1400154651e.png)

![在此处输入图像描述](../Images/a90c1a8c0baf4bc69a3080a6716bfb65.png)

我有两个问题。

1.  他们到底是如何在第二个屏幕截图中显示两个视图之间的转换的？我试图在 Xcode 中复制相同的行为 - 故事板。我创建了两个视图控制器，一个带有红色背景，另一个带有绿色。我将滑动手势识别器拖放到红色的手势识别器上，并使用 Modal 将手势与视图控制器相关联。但我看到的只有默认转换是水平/垂直翻转、交叉溶解、部分卷曲。与他们正在发生的事情完全不同。那么他们是怎么做到的呢？更改为 Push 没有任何作用。

2.  如果我使用情节提要，那么我将限制用户可以输入的城市。这意味着如果我有两个视图控制器，那么视图控制器 1 将显示城市 1 的天气，视图控制器 2 将显示城市 2 的天气。基本上，滑动仅限于我定义的控制器数量。（每个城市一个）。有没有办法让这个动态？用户可以拥有 N 个城市和 N 个滑动次数。与每部 iPhone 内置的天气应用程序类似的行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:34:30.007

如果您让用户输入他们自己的城市，您应该只创建一个`UIViewController`处理单个城市的城市。然后你只需要创建一个`UIScrollView`启用分页的（[这里有一个教程](http://cocoawithlove.com/2009/01/multiple-virtual-pages-in-uiscrollview.html)），然后像 Solar 一样隐藏页面滚动指示器。创建您的几个实例`UIViewController`并将它们的视图添加到您的`UIScrollView`.

日光在控制器的视图中淡出，该控制器变得可见，同时淡出正在隐藏的控制器。这是使用`UIScrollViewDelegate`允许您知道何时拖动滚动视图的方法完成的。

# c++ - 使用 TryCatch 时 v8 hello world 中的分段错误

> ID：11730638
> 
> 赞同：0
> 
> 时间：2012-07-30T22:29:28.157
> 
> 标签：c++, v8

我正在尝试在我的 C++ 应用程序中使用 v8。我被困在 helloworld 本身！

[https://developers.google.com/v8/get_started](https://developers.google.com/v8/get_started)上的 helloworld工作得很好。现在我试图在代码中捕获异常/错误。所以我使用了 TryCatch trycatch;。

```
int main(int argc, char *argv[]) {
    HandleScope handle_scope;
    Persistent<Context> context = Context::New();
    Context::Scope context_scope(context);
    TryCatch trycatch; /* TO CATCH EXCETIONS/ERRORS */
    Handle<String> source = String::New("xyz();");
    Handle<Script> script = Script::Compile(source);
    Handle<Value> result = script->Run();
    if (result.IsEmpty()) {
        fprintf(stderr, "Exception: %s\n",
                *String::AsciiValue(trycatch.Exception()));
        return -1;
    }
    String::AsciiValue ascii(result);
    printf("%s\n", *ascii);
    context.Dispose();

    return 0;
} 
```

异常被很好地捕获，但程序没有正确终止。它会产生分段错误。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T08:06:20.320

原来是一件愚蠢的事情。我早就安装了 libv8-dev 并忘记了它。现在我从源代码安装了 V8。所以我的系统上有两个版本的 V8。我卸载了 libv8-dev，问题已经解决。

# php - 在 php 中扩展动态表单验证的建议

> ID：11730642
> 
> 赞同：1
> 
> 时间：2012-07-30T22:29:59.830
> 
> 标签：php, forms, validation

我有一个表单，（在前一页上）用户可以选择他们想要包含多少项目。提交第二个页面后，它会通过一个[验证脚本](http://codepad.viper-7.com/0dyKws)运行，该脚本接受需求、字段名称以及在验证中发生错误时返回的消息。

```
if($numFieldSelectedearlier > 0) {
    for($z=1; $z<=$numFieldSelectedearlier; $z++) {
        $rules[] = "required,name,Name for item {$z} is required.";
    }
} 
```

在我的 html 表单中，该字段如下所示：

```
<form name="someForm" action="" method="post">

<?php if ($numFieldSelectedearlier > 0) {
    for($y=1; $y <= $numFieldSelectedearlier; $y++) { ?>        
    <input type="text" name="name[]" id="name<?php echo $y; ?>" />
<?php }
} ?>
.... 
```

我遇到的问题是，当前构建的脚本是为了处理单个元素（一个名为“名称”的字段等）。php验证器获取所有POST元素并将它们分解为字段以进行验证，我正在努力弄清楚如何修改验证脚本本身（我有点犹豫，因为它会改变整体结构验证器检查元素名称本身是否是一个数组然后循环）或者我可能没有考虑一种更简单的方法来处理实际的 $rules 创建部分。

注意：似乎我唯一关心的是 a 字段是必需的，但我想基本上通过与任何其他字段相同的验证选项（必需、仅数字、电子邮件等）传递阵列项目，所以我不想要复制理论上已经存在的代码。

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:35:24.407

既然你已经在两边都做了一个循环，为什么不直接使用 , 等名称`name1`并将`name2`你的规则链接到这些字段呢？

在 HTML 方面，您将更改`name`：

```
<input type="text" name="name<?php echo $y; ?>" ... /> 
```

在规则创建方面，您将绑定到这些字段名称：

```
if($numFieldSelectedearlier > 0) {
    for($z=1; $z<=$numFieldSelectedearlier; $z++) {
        $rules[] = "required,name{$z},Name for item {$z} is required.";
    }
} 
```

# google-drive-api - Google Drive SDK“短期”下载 URL 存在多长时间？

> ID：11730648
> 
> 赞同：3
> 
> 时间：2012-07-30T22:30:34.417
> 
> 标签：google-drive-api

downloadUrl 的参考说明该链接存在的时间很短。这个大概多长时间？分钟、小时、天？

[https://developers.google.com/drive/v2/reference/files#downloadUrl](https://developers.google.com/drive/v2/reference/files#downloadUrl)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T23:28:57.297

我不会依赖这个 URL 超过几分钟或几小时，但实际上它目前稳定了一天左右。这可能会发生变化，因此最好在下载前直接获取 URL。

`downloadURL`编辑：这和之间的区别在于`webContentLink`使用`webContentLink`来自用户浏览器cookie的授权，`downloadURL`需要授权的API请求（使用OAuth 2.0）。

# vba - Excel - VBA 对象不支持此属性或方法 - 粘贴 - Excel

> ID：11730651
> 
> 赞同：0
> 
> 时间：2012-07-30T22:30:40.600
> 
> 标签：vba, excel

给我带来麻烦的行是 ""Sheets(CStr(WS_M.Cells(n, START_C))).Cells(n, START_C).Paste""

这应该在第 3 列中找到选项卡名称，然后转到该选项卡并将选项卡名称粘贴到该选项卡中。

```
 Const START_C = 3
    Const MAX_TRAN = 1000
    Const START_R = 2
    Const MASTER = "MASTER"

    Sub MOVEDATACORRECTLY()

    Dim WS_M As Worksheet
    Dim thisWB As Workbook
    Set thisWB = ActiveWorkbook
    Set WS_M = Worksheets(MASTER)

    For M = START_R To (START_R + MAX_TRAN)
        If WS_M.Cells(M, (START_C + 1)) = "" Then Exit For

    Next M

    M = M - 1

    For n = START_R To M
       WS_M.Cells(n, START_C).Copy
       Sheets(CStr(WS_M.Cells(n, START_C))).Cells(n, START_C).Paste      

    Next n

    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T05:33:32.250

对于在 Excel 中复制一系列单元格，使用`Copy`方法会使`VBA`程序更容易崩溃/或给出不可预测的结果。

假设在您的过程中复制数据`system clipboard`并且用户试图`store some other to system clipboard!`

并非总是如此，但是从用户那里可能会发生这种错误。

所以我总是喜欢使用更好的方法，比如`Swaping the range on the fly`. 这是一个小演示：

```
Public Sub Sample_Copy_without_Clipboard()
    Dim dRange As Range, iRange As Range
    Set iRange = Range("A1:B3")
    Set dRange = Range("D1:E3")
    dRange.Value = iRange.Value
End Sub 
```

## 注意：此方法仅适用于未格式化的文本数据。如果没有，请使用[Tim](https://stackoverflow.com/users/478884/tim-williams)的建议或[DanM](https://stackoverflow.com/users/129164/danm)的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:40:13.063

试试这个：

```
For n = START_R To M
       WS_M.Cells(n, START_C).Copy
       Sheets(CStr(WS_M.Cells(n, START_C))).Cells(n, START_C).Select
       ActiveSheet.Paste
Next n 
```

如果查看Excel对象的[文档](http://msdn.microsoft.com/en-us/library/office/bb225606%28v=office.12%29.aspx)，它不在成员列表中。然而，有。我还没有尝试过，但这也可能有效。`Range``Paste``PasteSpecial`

# c# - c#使用模拟时用户名或密码错误

> ID：11730652
> 
> 赞同：0
> 
> 时间：2012-07-30T22:30:50.583
> 
> 标签：c#, impersonation, credentials

我想要做的是允许不在域访问中的机器通过模拟域凭据运行注册表检查工具......它适用于我域上的任何机器，但域外的任何人都会得到错误的用户名和密码错误，即使他们使用的是域管理员帐户。相同的凭据，只有一台机器在域上，而另一台不在。这是我调用模拟的代码...（下面的模拟代码）

```
private void button1_Click(object sender, EventArgs e)
    {
         //Variables for Authentication
        string userName;
        userName = txtUser.Text;
        string password;
        password = txtPass.Text;
        string domain;
        domain = txtDomain.Text;

        //Start Authentication
        using ( new Impersonator( userName, domain, password ) )
        {
        //Clears last run result
        txtResult.Clear();
        //Begin Error Handling
        try
        {
            //Variable for remote machine field
            string remotemachine;
            remotemachine = txtComputer.Text;
            // hourglass cursor
            Cursor.Current = Cursors.WaitCursor;

            //Begin Code to check Registry
            RegistryKey hive = RegistryKey.OpenRemoteBaseKey(RegistryHive.LocalMachine, remotemachine, RegistryView.Registry64);
            var key = hive.OpenSubKey(@"SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\LogonUI");
            if (key == null)
            {
            }
            object oVal = key.GetValue("LastLoggedOnUser"); if (null != oVal)
            {
            txtResult.Text = oVal.ToString();
            //End Registry Check
            //Return Cursor
            Cursor.Current = Cursors.Default;

            }
        }
        catch (System.IO.IOException)
        {
            MessageBox.Show("You entered an invalid PC or the firewall is blocking you (Remote Registry Service must be running on remote host and the following ports must be open: TCP 445)", "Error", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
        }
        catch (System.NullReferenceException)
        {
            MessageBox.Show("This is not a Windows 7 Device", "Error", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
        }
        catch (System.UnauthorizedAccessException)
        {
            MessageBox.Show("Unauthorized Access, run app as Domain Admin or Machine is not on your Domain", "Error", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
        }
        catch (System.Security.SecurityException)
        {
            MessageBox.Show("Unauthorized Access, run app as Domain Admin or Machine is not on your Domain", "Error", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
        }
        catch (System.Exception excep)
        {
            MessageBox.Show(excep.GetType().ToString());
        }
        } 
```

这是模拟文件..

```
namespace Tools 
```

{

```
using System;
using System.Security.Principal;
using System.Runtime.InteropServices;
using System.ComponentModel;

public class Impersonator :
    IDisposable
{
    #region Public methods.
    // ------------------------------------------------------------------

    public Impersonator(
        string userName,
        string domainName,
        string password )
    {
        ImpersonateValidUser( userName, domainName, password );
    }

    // ------------------------------------------------------------------
    #endregion

    #region IDisposable member.
    // ------------------------------------------------------------------

    public void Dispose()
    {
        UndoImpersonation();
    }

    // ------------------------------------------------------------------
    #endregion

    #region P/Invoke.
    // ------------------------------------------------------------------

    [DllImport("advapi32.dll", SetLastError=true)]
    private static extern int LogonUser(
        string lpszUserName,
        string lpszDomain,
        string lpszPassword,
        int dwLogonType,
        int dwLogonProvider,
        ref IntPtr phToken);

    [DllImport("advapi32.dll", CharSet=CharSet.Auto, SetLastError=true)]
    private static extern int DuplicateToken(
        IntPtr hToken,
        int impersonationLevel,
        ref IntPtr hNewToken);

    [DllImport("advapi32.dll", CharSet=CharSet.Auto, SetLastError=true)]
    private static extern bool RevertToSelf();

    [DllImport("kernel32.dll", CharSet=CharSet.Auto)]
    private static extern  bool CloseHandle(
        IntPtr handle);

    private const int LOGON32_LOGON_INTERACTIVE = 2;
    private const int LOGON32_PROVIDER_DEFAULT = 0;

    // ------------------------------------------------------------------
    #endregion

    #region Private member.
    // ------------------------------------------------------------------

    /// <summary>
    /// Does the actual impersonation.
    /// </summary>
    /// <param name="userName">The name of the user to act as.</param>
    /// <param name="domainName">The domain name of the user to act as.</param>
    /// <param name="password">The password of the user to act as.</param>
    private void ImpersonateValidUser(
        string userName, 
        string domain, 
        string password )
    {
        WindowsIdentity tempWindowsIdentity = null;
        IntPtr token = IntPtr.Zero;
        IntPtr tokenDuplicate = IntPtr.Zero;

        try
        {
            if ( RevertToSelf() )
            {
                if ( LogonUser(
                    userName, 
                    domain, 
                    password, 
                    LOGON32_LOGON_INTERACTIVE,
                    LOGON32_PROVIDER_DEFAULT, 
                    ref token ) != 0 )
                {
                    if ( DuplicateToken( token, 2, ref tokenDuplicate ) != 0 )
                    {
                        tempWindowsIdentity = new WindowsIdentity( tokenDuplicate );
                        impersonationContext = tempWindowsIdentity.Impersonate();
                    }
                    else
                    {
                        throw new Win32Exception( Marshal.GetLastWin32Error() );
                    }
                }
                else
                {
                    throw new Win32Exception( Marshal.GetLastWin32Error() );
                }
            }
            else
            {
                throw new Win32Exception( Marshal.GetLastWin32Error() );
            }
        }
        finally
        {
            if ( token!= IntPtr.Zero )
            {
                CloseHandle( token );
            }
            if ( tokenDuplicate!=IntPtr.Zero )
            {
                CloseHandle( tokenDuplicate );
            }
        }
    }

    /// <summary>
    /// Reverts the impersonation.
    /// </summary>
    private void UndoImpersonation()
    {
        if ( impersonationContext!=null )
        {
            impersonationContext.Undo();
        }   
    }

    private WindowsImpersonationContext impersonationContext = null; 
```

# html5boilerplate - H5BP 构建脚本问题

> ID：11730654
> 
> 赞同：2
> 
> 时间：2012-07-30T22:30:55.653
> 
> 标签：html5boilerplate, build-script

每次我尝试使用 HTML5 Build Script 时都会出现以下错误：

```
-js.main.concat:
     [echo] Concatenating Main JS scripts based on index.html...
   [concat] /Volumes/[...]/intermediate/java.lang.NullPointerException does not exist.
   [concat] /Volumes/[...]/intermediate/at does not exist.
   [concat] /Volumes/[...]/intermediate/ScriptsToConcat.handleStartTag(ScriptsToConcat.java:38) does not exist.
   [concat] /Volumes/[...]/intermediate/at does not exist.
   [concat] /Volumes/[...]/intermediate/javax.swing.text.html.parser.DocumentParser.handleStartTag(DocumentParser.java:143) does not exist.
   [concat] /Volumes/[...]/intermediate/at does not exist.
   [concat] /Volumes/[...]/intermediate/javax.swing.text.html.parser.Parser.startTag(Parser.java:421) does not exist.
   [concat] /Volumes/[...]/intermediate/at does not exist.
   [concat] /Volumes/[...]/intermediate/javax.swing.text.html.parser.Parser.parseTag(Parser.java:1943) does not exist.
   [concat] /Volumes/[...]/intermediate/at does not exist.
   [concat] /Volumes/[...]/intermediate/javax.swing.text.html.parser.Parser.parseContent(Parser.java:2061) does not exist.
   [concat] /Volumes/[...]/intermediate/at does not exist.
   [concat] /Volumes/[...]/intermediate/javax.swing.text.html.parser.Parser.parse(Parser.java:2228) does not exist.
   [concat] /Volumes/[...]/intermediate/at does not exist.
   [concat] /Volumes/[...]/intermediate/javax.swing.text.html.parser.DocumentParser.parse(DocumentParser.java:105) does not exist.
   [concat] /Volumes/[...]/intermediate/at does not exist.
   [concat] /Volumes/[...]/intermediate/javax.swing.text.html.parser.ParserDelegator.parse(ParserDelegator.java:84) does not exist.
   [concat] /Volumes/[...]/intermediate/at does not exist.
   [concat] /Volumes/[...]/intermediate/ScriptsToConcat.main(ScriptsToConcat.java:50) does not exist. 
```

（“[...]”是为了不显示我的客户的名字，路线还可以）

我正在使用最新的 h5bp 构建脚本并运行“ant build”

我在 html 中有以下内容：

```
 <!-- scripts concatenated and minified via build script -->
  <script  src="js/plugins.js"></script>
  <!-- end scripts--> 
```

在“js”文件夹中，我有一个 12k plugins.js 和一个空白的 scripts.js（以防万一我离开它）

我正在使用带有最新 Java 的 Mac OS 10.6.8。default.properties 具有所有默认值。我试着改变

```
tool.yuicompressor          = yuicompressor-2.4.7.jar 
```

至

```
tool.yuicompressor          = closure-compiler-v1346.jar 
```

但同样的事情一直在发生。一个新的 safasg.js 文件在 /publish/js/ 中，但它是空白的（实际上是 2 行 os 空格）

我不知道如何解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T04:59:29.877

在这条线上：

```
<!-- end scripts--> 
```

's' 和 '-->' 部分之间应该有一个空格：

```
<!-- end scripts --> 
```

# objective-c - 如何通过 xib 指定自定义视图初始化所需的属性？

> ID：11730655
> 
> 赞同：0
> 
> 时间：2012-07-30T22:30:57.090
> 
> 标签：objective-c, xcode, uiview

我正在创建 UIView 的自定义子类。我目前正在基于[Objective C 进行初始化 - 自定义视图并实现 init 方法？](https://stackoverflow.com/questions/7226239/objective-c-custom-view-and-implementing-init-method)，因此无论是从代码加载还是从 xib 加载，都会完成一些初始化。

我现在遇到的问题是我正在添加一个“必需”属性（为了讨论，我们将其称为 reqProp） - 如果没有设置此属性，视图将无法呈现，并且必须在任何其他特定于的功能之前设置它可以使用我的视图子类。

因此，我认为强制执行此要求的自然位置是提供一个新的 init 函数，因此我不必担心在我的其余代码中没有设置它 - 例如

```
initWithFrame:(CGRect)frame forReqProp:(NSString *)reqProp; 
```

但是，**我不确定在通过 initWithCoder 进行初始化时如何强制执行相同的要求**。

我能想到的最接近的是要求在用户定义的运行时属性中指定此属性（就在需要在界面生成器中定义自定义类名称的位置），但在这种情况下，不清楚何时/是否应该“吹up”，因为没有指定属性。

我能想到的唯一其他选择就是有非常明确的文档，说明这个必需的属性必须是在使用视图之前设置的第一件事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T02:30:18.403

我现在不在我的支持 XCode 的计算机上，所以我无法对此进行测试，但是如何从 initWithCoder 方法中呈现一个工作表，这将需要用户在方法完成之前输入 reqProp 的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T00:11:21.000

如果问题可以通过要求它是使用视图之前设置的第一个属性来解决，那么初始化就*不需要*它。这里的建议将是很好的文档。

但是，通过一些重构可能会更好地解决潜在问题，因此它不需要是第一个属性集。在这种情况下，一个非常基本的重构可能涉及存储其他属性的字典，并且仅在设置所需属性后“真正”设置它们（并对渲染产生影响）。

例如：

```
- (void) setOptionalProperty1:(id)prop
{
    [propMap setObject:prop forKey:@"property1"];
    if (self.requiredProperty) {
        _optionalProperty1 = prop;
    }
}

- (void) setOptionalProperty2:(id)prop
{
    [propMap setObject:prop forKey:@"property2"];
    if (self.requiredProperty) {
        _optionalProperty2 = prop;
    }
}

- (void) setRequiredProperty:(id)requiredProp
{
    _requiredProperty = requiredProp;
    // now iterate over propMap and set those properties properly
} 
```

它不一定是最好的重构，而是一个通用的简单示例，它应该完成工作并保持底层限制（必须首先设置必需的属性）完整，而不会对使用该类的开发人员强制要求。

# php - Require_Once 给 PHP 除法零错误

> ID：11730658
> 
> 赞同：0
> 
> 时间：2012-07-30T22:31:08.083
> 
> 标签：php, zend-framework

我试图通过使用以下方法在 index.php 中需要一个配置文件：

```
require_once __DIR__/application/common/config/Config.php; 
```

但是，PHP 错误记录状态除以零。完整路径是 /var/www/application/common/config/Config.php

如何确保这条路径在我的 require_once 语句中正确表示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:32:23.527

您需要在 PHP 中为字符串使用引号...

```
require_once __DIR__ . '/application/common/config/Config.php'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T22:32:45.803

发生这种情况是因为 PHP 中的一系列设计错误。

*   PHP 将它不知道的每个符号转换为字符串，除了它有一个前导大写字符，这将是一个常量。
*   未定义的常量是`NULL`
*   当您尝试对字符串进行任何数学运算时，它会被转换为整数。
    *   `"123"`将是 123
    *   `"123 abc"`也将是 123
    *   `"abc"`将为0。
*   当您尝试对 进行任何数学运算时`NULL`，它会转换为`0`

那么会发生什么，PHP 计算`"yourdirectory"/0/0/0/0`，这是除以零。（*哎哟！* [我是不是已经告诉过你 PHP 是一门坏掉的语言了？](http://me.veekun.com/blog/2012/04/09/php-a-fractal-of-bad-design/)）

只需将字符串放在引号中。

```
require_once __DIR__."/application/common/config/Config.php"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-30T22:32:54.243

```
require_once __DIR__ . '/application/common/config/Config.php'; 
```

那应该有效吗？这 ”。” 连接字符串。基本上是“ **dir** ”（加）“其他值”。并且其他值需要用引号引起来，否则它将把“/”作为基本的数学运算符，从而在语句的其余部分尝试将所有内容除以 0。

(require_once **DIR** /0/0/0/0;) 你不能除以 0 ;)

# c# - c# while循环进入条件中的逻辑错误

> ID：11730659
> 
> 赞同：-4
> 
> 时间：2012-07-30T22:31:17.323
> 
> 标签：c#, syntax

我有一些奇怪的逻辑问题。

```
x=false; 
```

这个*不起作用*：

```
while (R2.TS("a") && R2.TL("b") && (s=R2.SL().Trim()).Length > 0) 
{
    x=true;
} 
```

结果：x=false；

这个*确实*有效：

```
while (R2.TS("a") && R2.TL("b")) 
{
    if((s=R2.SL().Trim()).Length > 0) 
    {
        x=true;
    }
} 
```

结果：x=true；

此外，也许知道这些函数只有在以正确的顺序执行时才会返回 true，例如 R2.TS("a") 然后 R2.TL("b") 然后 ((s=R2.SL().Trim ()).长度 > 0)。

输入是相同的，但这里肯定有问题。有任何想法吗 ？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T22:41:45.907

是的，循环做了两个不同的事情。

我认为您的意思是逻辑错误，而不是语法错误。语法错误意味着它不会编译。逻辑错误意味着它不符合您的预期。

`R2.SL()`如果表达式为假，第一个将终止。至少在第一轮，`(s=R2.SL().Trim()).Length > 0`一定是假的，所以循环 1 终止并且`x`永远不会设置为真。这是您在两个循环之间获得差异的唯一方法，所有其他条件都相同。

在循环 2 中，中间值 for`R2.SL()`不是问题，只要其他循环条件保持为真。当`(s=R2.SL().Trim()).Length > 0`评估为真时，`x`将被设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:39:43.757

使用调试器卢克。我们试图弄清楚为什么这不能给你想要的结果是没有意义的。你最好在一些帮助下解决这个问题。单击第一行并按 F9。它应该变成红色。运行你的程序，它会停在这一行。然后，您可以将鼠标悬停在不同的变量上以查看哪些变量具有哪些值。然后按 F11 继续执行您的程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T22:38:24.373

在第一种情况下，R2 必须遵守三个条件，即 R2.TS("a") AND R2.TL("b") AND (s=R2.SL().Trim()).Length > 0) , 在你进入循环并返回 x 的值之前

在第二种情况下，您只有 R2 必须遵守的两个条件，即 R2.TS("a") AND R2.TL("b") 进入循环后，您在 x 值之前有一个新条件回来。

它们可能都有效，但在第一种情况下，您不提供符合循环要求的数据。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-30T22:35:22.163

它可以与 && 和 || 连接 操作。它们被缩短了。这意味着，操作会持续查看`false`，直到条件中第一次出现。

由于缩短了操作，您会得到 2 个不同的周期，它们具有不同的逻辑。使用 2 循环类型。它更正确。

# java - Java - 用整数和字符串解析文本文件

> ID：11730663
> 
> 赞同：0
> 
> 时间：2012-07-30T22:31:36.667
> 
> 标签：java

我有一个包含以下内容的文本文件（分隔符是一个空格）：

```
1231 2134 143 wqfdfv -89 rwq f 8 qer q2
sl;akfj salfj 3 sl 123 
```

我的目标是分别读取整数和字符串。一旦我知道如何解析它们，我将创建另一个输出文件来保存它们（但我的问题只是知道如何解析这个文本文件）。

我尝试使用 Scanner，但无法超越第一个 inetger：

```
Scanner s = new Scanner (new File ("a.txt")).useDelimiter("");
while (s.hasNext()){
System.out.print(s.nextInt());} 
```

输出是

```
1231 
```

我怎样才能从这两行中获取其他整数？

我想要的输出是：

```
1231 
2134 
143
-89
8
3 
123 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T22:39:31.317

从文件中读取数据时，全部读取为字符串类型。然后通过使用解析它来测试它是否是数字`Integer.parseInt()`。如果它抛出异常，那么它是一个字符串，否则它是一个数字。

```
while (s.hasNext()) {
    String str = s.next();
    try { 
        b = Integer.parseInt(str); 
    } catch (NumberFormatException e) { // only catch specific exception
        // its a string, do what you need to do with it here
        continue;
    }
    // its a number
 } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-30T22:43:05.367

分隔符应该是其他东西，例如至少一个空格或多个

```
Scanner s = new Scanner (new File ("a.txt")).useDelimiter("\\s+");
while (s.hasNext()) {
    if (s.hasNextInt()) { // check if next token is an int
        System.out.print(s.nextInt()); // display the found integer
    } else {
        s.next(); // else read the next token
    }
} 
```

我不得不承认，在这个简单的案例中，gotuskar 的解决方案是更好的解决方案。

# java - 在java中优化套接字编程的最佳方法？

> ID：11730664
> 
> 赞同：-2
> 
> 时间：2012-07-30T22:31:37.940
> 
> 标签：java, sockets, network-programming

我尝试编写一个关于多客户端 - 服务器套接字编程的大学研究项目的一部分。我的代码工作得很好，所以我给出了验证结果，但问题是我们小组的评估员说我的代码没有很好的速度数据传输连接。如果您在我的代码中发现导致此问题的问题，我将不胜感激。

服务器部分：

```
 import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.OutputStream;
import j

ava.io.PrintStream;
import java.net.InetAddress;
import java.net.ServerSocket;
import java.net.Socket;
import java.net.SocketAddress;
import java.net.UnknownHostException;
import java.util.ArrayList;

/**
 * 
 */

/**
 * @author Sina
 *
 */
public class BoxServer {

    ServerSocket serversocket;
    static ThreadHandler t[]=new ThreadHandler[100];
    static int size=0;
    static ArrayList<Message> messagebox=new ArrayList<Message>();
    public static void main(String[] args) {

        ServerSocket serverSocket = null;
        try {
            serverSocket = new ServerSocket(79);
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
        while(true)
        {

        try{

                //InetAddress inetadress=InetAddress.getLocalHost();
                //System.out.println(inetadress);
                //System.out.println(inetadress.getHostName());
                //System.out.println(inetadress.getHostAddress());
                Socket socket=serverSocket.accept();
                if(socket==null)
                {
                    System.out.println("null");
                }
                t[size]=new ThreadHandler(socket,"username");
                size++;
                t[size-1].start();

        }
        catch(UnknownHostException e){
            System.out.println("salam s");
         System.out.println(e.getMessage());
        }
        catch (IOException e) {
            System.out.println("bye s");
            System.out.println(e.getMessage());
        }

        }

    }

}

class ThreadHandler extends Thread{

    private String socname;
    Socket mySocket;
    ObjectInputStream inp;
    ObjectOutputStream outp;
    public ThreadHandler(Socket s,String socketName)
    {
        this.mySocket=s;
        this.socname=socketName;

    }
    public void run()
    {
        try {
            inp=new ObjectInputStream(mySocket.getInputStream());
            outp=new ObjectOutputStream(mySocket.getOutputStream());
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }

        while(true)
        {
        System.out.println("thread run");
        System.out.println(mySocket.getLocalPort());
        System.out.println(mySocket.getLocalAddress());

        try {
        //  System.out.println("my socket:"+mySocket.getOutputStream());
            System.out.println(mySocket.isConnected());
            System.out.println(inp.available());
            System.out.println("inp = "+inp);
            System.out.println("reeead "+ inp.readObject());
            Message mess=(Message)inp.readObject();
            System.out.println("dsd");
            System.out.println("mess: "+mess);
            BoxServer.messagebox.add(mess);
            if(mess.getReceiver().equals("system-use:code=1"))
            {
                System.out.println(mess.getSender()+" wants to see his/her Inbox");
            }
            //mySocket.close();
        } catch (Exception e) {
            // TODO Auto-generated catch block
            System.out.println("bug dar thread");
            e.printStackTrace();

        }

         }

    }
} 
```

客户部分

```
 import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.OutputStream;
import java.net.Socket;
import java.net.UnknownHostException;
import java.util.Scanner;
import java.util.TimerTask;
import java.util.concurrent.ScheduledExecutorService;

import javax.swing.Timer;

public class Main {

    /**
     * @param args
     */

    static Socket socket=new Socket();
    public static void main(String[] args) {

        System.out.println("newuser(n) or login(l)");
        Scanner scanner=new Scanner(System.in);
        String typeOfOperation=scanner.nextLine();
        if(typeOfOperation.equals("n"))
        {

        }
        else
        if(typeOfOperation.equals("l"))
        {

            try {
                socket = new Socket("127.0.0.1",79);
                final ObjectOutputStream out = new ObjectOutputStream(socket.getOutputStream());
                ObjectInputStream in=new ObjectInputStream(socket.getInputStream());

                while(true)
                {

                Thread timer=new Thread()
                {
                    public void run()
                    {
                        while(true)
                        {
                            Message temp=new Message();
                            temp.setReceiver("system-use:code=1");
                            temp.setSender("username");

                            try {
                                out.writeObject(temp);
                                sleep(5000);
                            } catch (IOException e) {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                            }
                            catch (InterruptedException e) {
                                // TODO: handle exception
                                e.printStackTrace();
                            }

                        }
                    }
                };
                timer.start();
                String username=scanner.nextLine();
                String to=scanner.nextLine();
                String body=scanner.nextLine();
                Message all=new Message();
                all.setText(body);
                all.setReceiver(to);
                all.setSender(username);

                System.out.println("you connected to system");
                System.out.println(socket);

                System.out.println("now should write");
                out.writeObject(all);
                System.out.println("ghable threAD");

                }
            //  socket.close();

            } catch (UnknownHostException e) {
                // TODO Auto-generated catch block
                System.out.println("salaam c");
                System.out.println(e.getMessage());
            } catch (IOException e) {
                // TODO Auto-generated catch block
                System.out.println("bye c");
                System.out.println(e.getMessage());
            }

        }
        else
        {
            System.out.println("bad operation. try again!");
        }

    }

} 
```

消息类（我认为只有实体不重要！）：

```
import java.io.Serializable;

public class Message implements Serializable{
    String sender;
    String receiver;
    String text;
    boolean delivered=false;
    public void delived()
    {
        this.delivered=true;
    }
    private String tostringOfClass;

    public void setReceiver(String receiver) {
        this.receiver = receiver;
    }
    public void setSender(String sender) {
        this.sender = sender;
    }
    public void setText(String text) {
        this.text = text;
    }
    public String getReceiver() {
        return receiver;
    }
    public String getSender() {
        return sender;
    }
    public String getText() {
        return text;
    }

    public String toString()
    {
        tostringOfClass="sender : "+sender+" \n"+"receiver : "+receiver+" \n"+"message: "+text;

        return tostringOfClass;
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T22:45:42.517

您的评估员错过了更重要的事情：它不起作用。您在服务器中的每个循环中调用 readObject() 两次，但您对第一个结果所做的只是使用 System.out.println() 将其打印出来。因此，您的代码缺少每个奇怪的对象。

您无能为力来提高速度。他可能希望您在 ObjectOutputStream 和套接字之间插入一个 BufferedOutputStream，对于 BufferedInputStream 也是如此。然而，对象流已经运行了它们自己的缓冲区，所以这可能是浪费时间。他可能还希望您使用大型套接字发送和接收缓冲区，如果您已经了解了这些：请参阅 Socket.setXXXBufferSize()。将它们设置为至少 32k。他也可能是反序列化的，但对于这个应用程序，我认为它没有太大的不同。这是一个交互式应用程序，消息很小，因此网络上的速度基本无关紧要。你只能打字这么快。

当用户键入告诉程序停止的任何内容时，您还应该在客户端中关闭，并且在服务器中，您必须在 IOException 之前捕获 EOFException，并在收到它时关闭套接字并跳出读取循环。

打印出 Socket.isConnected() 也不会产生有用的信息。套接字始终连接在您打印它的点。此方法不是对*连接的健康检查，*它只告诉您*Socket*的状态。不是一回事。

在我看来，您的评估员似乎专注于完全错误的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:39:54.747

我不确定您要花多少时间优化您的 Socket 代码，但 ZMQ [http://www.zeromq.org/](http://www.zeromq.org/)在消除延迟和优化带宽使用方面有很大帮助。

但是，在更简单的注释中。尽量不要使用 ObjectOutputStream 它们是上面的一层。立即使用 DataInputStream 和 DataOutputStream（也许还有 BufferedInputStream）对我来说已经有一段时间了，所以我生疏了。但是由于您正在发送字符串，因此您不需要随之进行对象序列化。

您说，您的时间也浪费在数据传输上。但请考虑不要在每个连接上创建新线程并使用线程池。

和萨拉姆。

# nhibernate - Fluent NHibernate Syscache2 缓存过期

> ID：11730671
> 
> 赞同：3
> 
> 时间：2012-07-30T22:32:11.490
> 
> 标签：nhibernate, caching, fluent-nhibernate, syscache2

我一直在研究使用 fluent 和 syscache2 的 WCF 服务。关于我目前的困境，我几乎阅读了所有关于 SO 的文章；我没有运气。

我正在尝试为我的二级缓存设置过期时间。我设置的任何值似乎都被忽略了，默认值 5 分钟用于使缓存过期。

流畅的配置：

注意： contextClass 只是一个描述符类，保存传递给配置的值。

```
var cfg = Fluently.Configure()
                .Database(
                    MsSqlConfiguration.MsSql2008                        
                    .ConnectionString(c => c.Is(connectionString))
                    .ShowSql()
                    )
                .Diagnostics(d => d.Enable())                                                             
                .Cache(c => c                                 
                            .UseQueryCache()          
                            .ProviderClass(typeof(NHibernate.Caches.SysCache2.SysCacheProvider).AssemblyQualifiedName))                    
                .Mappings(m => m
                    .FluentMappings
                    .AddFromAssembly(assembly)) 
                .ExposeConfiguration(x =>
                {
                    x.SetProperty(NHibernate.Cfg.Environment.CurrentSessionContextClass, contextClass.Id);
                    x.SetProperty(NHibernate.Cfg.Environment.PrepareSql, contextClass.PrepareSql); //set prepare_sql true/false
                    x.SetProperty(NHibernate.Cfg.Environment.CacheDefaultExpiration, contextClass.ExpireL2Cache); //set default expiration in seconds
                }); 
```

我还将 app.config 文件设置如下：

```
<configSections>
  <section name="syscache" type="NHibernate.Caches.SysCache2.SysCacheSection, NHibernate.Caches.SysCache2"/>
</configSections>

<syscache>
  <cache expiration="600" priority="5" />
</syscache> 
```

app.config 有一个变体，它有一个使用区域的 syscache 部分，但也不起作用。

有人对想法有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T12:41:27.680

我一直使用这个没有问题：

```
.ExposeConfiguration (cfg => {
    cfg.Properties.Add ("expiration", "900");
}) 
```

不确定 Properties.Add 的行为是否与您正在使用的 SetProperty 调用有任何不同。

似乎如果您使用的是较新版本的 NHibernate，您也可以依靠 NHibernate.Cfg 命名空间中的新扩展方法（这将替换您的整个 .Cache 流利调用）

```
.ExposeConfiguration (cfg => {
    cfg.SessionFactory().Caching.Through<SysCacheProvider>().WithDefaultExpiration(900);
}) 
```

做一些阅读我发现[了这个](http://zvolkov.com/clog/2009/10/16?s=Memcached+for+NHibernate+configuration+attributes)：

> cache.default_expiration 或 expire (Int32)：因为 NH Contrib 2.1 cache.default_expiration 是新的设置名称，应该使用它而不是 expire 来指定缓存项必须失效的秒数。默认值为 300 秒。仍然支持旧名称以实现向后兼容性。

所以属性名称可能不是你的问题（现在想知道我使用的“过期”键是否也可能特定于 memcache 提供程序，尽管它似乎适用于 syscache）。

# perl - $self 可以传递给 XML::Twig 处理程序吗？

> ID：11730674
> 
> 赞同：1
> 
> 时间：2012-07-30T22:32:29.477
> 
> 标签：perl, moose, xml-twig

我正在尝试解析根据类方法中给出的命令返回的不同 XML ......但我认为我在这里有点深入。

我希望能够使用其他方法并从 XML::Twig 处理程序中访问实例的属性。

这是我在 Moose 对象中定义的一个实例方法，用于使用 XML::Twig 获取和解析 XML：

```
sub get_xmls {
    my $self   = shift;
    my $sehost = shift;
    my $symm   = shift;

    $self->log->info("Getting XMLs for $sehost - $symm");

    my %SYMMAPI_CALLS = (
            "Config"   => {
                'command'    => "symcfg list -sid ${symm} -v",
                'handlers'   => {
                                 'SymCLI_ML/Symmetrix' => $self->can('process_symm_info')
                            },
                'dbtable'    => "inv_emc_array"
            },
            "Pools"  => {
                'command'    => "symcfg -sid ${symm} list -pool -thin",
                'handlers'   => {
                                  'DevicePool' => $self->can('process_symm_pool')
                            },
                'dbtable'    => "inv_emc_pool"
                     }
                );

    foreach my $key (sort(keys %SYMMAPI_CALLS)) {

            my $xmldir   = $self->xmlDir;
            my $table    = $SYMMAPI_CALLS{$key}{'tbl'};
            my $handlers = $SYMMAPI_CALLS{$key}{'handlers'};
            my $command  = $SYMMAPI_CALLS{$key}{'command'};
            my $xmlfile  = qq(${xmldir}/${sehost}/${key}_${symm}.xml);

            $self->log->info("\t$key");

            if(!-d qq(${xmldir}/${sehost})) {
                mkdir(qq(${xmldir}/${sehost}))
                    or $self->log->logdie("Cant make dir ${xmldir}/${sehost}: $!");
            }

            $self->_save_symxml($command, $xmlfile);

            $self->twig(new XML::Twig( twig_handlers => $handlers ));

            $self->log->info("Parsing $xmlfile...");

            $self->twig->parsefile($xmlfile);

            $self->log->info("\t\t...finished.");
            die "Only running the first config case for now...";
    }
} 
```

以及其中一个处理程序的定义（在我弄清楚如何正确执行此操作时，现在并没有真正做任何事情：

```
sub process_symm_info {
    my ($twig, $symminfo) = @_;

    print Dumper($symminfo);

} 
```

这工作得很好，但我想要的是该`process_symm_info`方法可以访问 $self 以及 $self 带来的所有方法和属性。那可能吗？我做这一切都错了吗？由于我可以指定 XML 的特定部分，因此能够在处理程序中使用该数据执行其他操作会很好。

这是我第一次尝试 Perl Moose（如果你还不知道的话）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T22:34:16.253

目前，您有

```
handlers => {
    DevicePool => $self->can('process_symm_pool'),
}, 
```

将其更改为

```
handlers => {
    DevicePool => sub { $self->process_symm_pool(@_) },
}, 
```

该变量`$self`将被匿名子捕获。这就是以下工作的原因：

```
sub make {
    my ($s) = @_;
    return sub { return $s };
}

my $x = make("Hello, ");
my $y = make("World!\n");
print $x->(), $y->();  # Hello, World! 
```

闭包的世界，即:)

# java - GWT - 如何在 ScrollPanel 中居中内容

> ID：11730675
> 
> 赞同：3
> 
> 时间：2012-07-30T22:32:29.110
> 
> 标签：java, gwt, vertical-alignment, centering, alignment

我在 ScrollPanel 中有一个 FormPanel。ScrollPanel 位于 DockLayoutPanel 的中心部分。我想将 ScrollPanel 内的 FormPanel 垂直和水平居中。我尝试了几种方法来做到这一点，但没有成功。

我已经厌倦了在滚动面板内放置一个verticalPanel/horizo​​ntalPanel，并用它来包装formPanel。我将滚动面板和水平面板都设置为 100% 的宽度和高度。但是，滚动面板会根据 DockLayoutPanel 中心部分的大小自动调整大小，而水平面板的大小始终等于其子窗体面板的大小。所以我不能将formpanel放在horizo​​ntalPanel内部，因为它们的高度和宽度是相同的。我尝试使水平面板的大小始终与滚动面板相同，但我不知道如何做到这一点。将水平面板的大小设置为 100% 不起作用。

所以我的问题是：

1.如何在滚动面板中居中。如果您知道如何实现这一点，我不介意使用 css 方法。

2.在我上面的例子中，是否可以让horizo​​ntalPanel 的大小始终与其父容器相同 - 滚动面板。如果可能的话，我的第一个问题就解决了。

![在此处输入图像描述](../Images/20cfeb7850c41b445f325c83e13428f6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-31T06:54:00.660

我必须在水平滚动面板中居中图像。有时我只有一个图像，有时有一个图像列表要居中显示。我已经固定了 GWT 图像对象的大小和滚动面板的宽度。

我计算了滚动位置以使所有项目居中，并使用设置滚动位置（位置可以是 -ve 或 +ve 值）。

当用户滚动项目时，我会尊重用户的决定并相应地滚动它们。但是，如果用户滚动到最右端，我会确保重新调整滚动位置以滚动回边界并且不超过边界。

当页面被滚动面板刷新时，项目会自动居中。

简而言之，您需要以编程方式将项目居中，默认情况下，滚动面板会将项目保持在一侧（左侧和顶部）。

# php - 从 QueryUI 可拖动设置表单值

> ID：11730680
> 
> 赞同：1
> 
> 时间：2012-07-30T22:32:56.843
> 
> 标签：php, jquery, forms, jquery-ui

当多个可拖动对象被拖放到表单上时，我正在尝试设置表单值。一旦所有的可拖动对象都被删除，我想按下 PHP 代码的提交来对表单值进行一些处理。

我就是无法获取 drop 事件来设置表单值？？？？

这是JqueryUI的东西..

```
$(function() {
$( ".player" ).draggable({ revert: "invalid" });

$( ".position" ).droppable({
    activeClass: "ui-state-hover",
    hoverClass: "ui-state-active",
    accept:".player",

    drop: function( event, ui ) {
        var playerid = ui.draggable.attr("id");
        var target = $(this).attr("id");

        alert(playerid); //this works - got the right draggable id
        alert(target); //this works - got the right droppable id

                       //!!!! THIS DOESN'T SET IT!!!!!
        $('#resultform').attr('#target','playerid');
    }
});

}); 
```

这是HTML

```
<div id="result_space">
            <div id="player_list" class="player_list">
            <p>This is the player space </p>
             <div id="pos_1" class="player">
                        <p>Player 1</p>
             </div>
             <div id="pos_2" class="player">
                        <p>Player 2 </p>
             </div>
 </div>

 <div id="pitch">
       <form id="resultform" name="resultform" action="results_submit.php" method="post">
 <table background="../_images/5_results/pitch_v2.jpg" width="560" border="1px">
   <tr height="30"> <td colspan="4" align="center" style="color: #FFFF00; font-size: 24px;">stowupland falcons fc</td></tr>

   <tr height="80" valign="bottom"><td colspan="4" align="center"><div class="position" id="goalie"> <input type="text" name="goalie" id="goalie" value="Player 1" /></div></td></tr>
    <tr height="110" align="center" valign="middle">
      <td width="25%"><div id="defence1"><input class="position" type="text" name="r_def_1" id="r_def_1" value="player 2" /></div></td>
      <td width="25%"><div class="position" id="defence2"><input type="hidden" name="r_def_2" id="r_def_2" value="player 3" /></div></td>
</table>

    <input name="submit" type="submit" id="submit" value="Submit" />

  </form>
 </div>
 </div> 
```

例如，我想将玩家 1 (pos_1) 拖到防御 1 并使表单值 r_def_1 = pos_1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:22:31.847

我做了一些调整来让它工作：

我更新了 HTML 以使`td`s 可放置。这似乎工作得更好一点。我也适当地改变了 s的`colspan`属性。`td`

**更新的 HTML：**

```
<div id="result_space">
    <div id="player_list" class="player_list">
        <p>This is the player space </p>
        <div id="pos_1" class="player">
            <p>Player 1</p>
        </div>
        <div id="pos_2" class="player">
            <p>Player 2 </p>
        </div>
    </div>
    <div id="pitch">
        <form id="resultform" name="resultform" action="results_submit.php" method="post">
            <table background="../_images/5_results/pitch_v2.jpg" width="560" border="1px">
                <tbody>
                    <tr height="30">
                        <td colspan="2" align="center" style="color: #FFFF00; font-size: 24px;" class="">stowupland falcons fc</td>
                    </tr>
                    <tr height="80" valign="bottom">
                        <td colspan="2" align="center" class="position">
                            <div class="" id="goalie"> 
                                <input type="hidden" name="goalie" id="goalie" value="Player 1" />
                            </div>
                        </td>
                    </tr>
                    <tr height="110" align="center" valign="middle">
                        <td class="position">
                            <div id="defence1">
                                <input class="" type="hidden" name="r_def_1" id="r_def_1" value="player 2" />
                            </div>
                        </td>
                        <td class="position">
                            <div class="" id="defence2">
                                <input type="hidden" name="r_def_2" id="r_def_2" value="player 3" />
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <input name="submit" type="submit" id="submit" value="Submit" />
        </form>
    </div>
</div> 
```

**JavaScript：**

```
$(function() {
    $(".player").draggable({
        revert: "invalid"
    });

    $(".position").droppable({
        activeClass: "ui-state-hover",
        hoverClass: "ui-state-active",
        accept: ".player",

        drop: function(event, ui) {
            var playerid = ui.draggable.attr("id");

            $("input", this).val(playerid);
        }
    });
});​ 
```

关键是这一行：

```
$("input", this).val(playerid); 
```

它找到`input`了 droppable 的内部`td`。

**CSS（可拖动它对限制`width`可拖动项目很有用）**：

​<code>.player { 宽度：75px; }​</code>

**示例：http:** [//jsfiddle.net/z8pWN/](http://jsfiddle.net/z8pWN/)

# jquery - 删除后刷新数据表

> ID：11730681
> 
> 赞同：0
> 
> 时间：2012-07-30T22:33:05.683
> 
> 标签：jquery, jquery-plugins, datatables, jeditable

我有以下代码，我想在删除记录后刷新数据表。目前我必须手动刷新浏览器......我该怎么办？

```
<script type="text/javascript" charset="utf-8">
    $(document).ready(function () {
    var oTable = $('#example').dataTable({
        "bProcessing": false,
        "bServerSide": true,
        "sAjaxSource": "server_processing.php",
        "aoColumns": [{
            "bVisible": true
        }, {}, {}, {}, {}]
    }).makeEditable({
        sUpdateURL: function (value, settings) {
            console.log(value, settings);
            oTable.fnDraw();

            return (value); //Simulation of server-side response using a callback function
        },
        sDeleteURL: "DeleteData.php",
        "aoColumns": [{
            cssclass: 'required'
        }, {
            indicator: 'Saving platforms...',
            tooltip: 'Click to edit platforms',
            type: 'textarea',
            submit: 'Save changes'
        }, {
            indicator: 'Saving Engine Version...',
            tooltip: 'Click to select engine version',
            loadtext: 'loading...',
            type: 'select',
            onblur: 'cancel',
            submit: 'Ok',
            loadurl: 'EngineVersionList.php',
            loadtype: 'GET'
        }, {
            indicator: 'Saving CSS Grade...',
            tooltip: 'Click to select CSS Grade',
            loadtext: 'loading...',
            type: 'select',
            onblur: 'submit',
            data: "{'':'Please select...', 'A':'A','B':'B','C':'C'}"
        }]
    });
});
        </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:48:40.127

可以做任何事情，从从脚本级别自动重新加载页面，到运行将获取新数据并重新填充表的 AJAX 脚本。仅操作表本身并删除行，如果您当前将其从后端的数据库或数据集中删除，那么它不会在下一次加载时再次显示在前端，而只是删除整个暂时在视觉上排就足够了。但是还有其他策略要做。这一切都取决于后端的内容，您当前如何为您的桌子提供食物等。

# javascript - JS 正则表达式替换数字

> ID：11730688
> 
> 赞同：10
> 
> 时间：2012-07-30T22:33:41.827
> 
> 标签：javascript, regex

尝试使用 JS .replace 用字符串替换整数来了解一些正则表达式。

例如，字符串可以是：

```
var string = 'image[testing][hello][0][welcome]'; 
```

我想用另一个值替换“0”。我最初使用这个：

```
string.replace( /\[\d\]/g, '[newvalue]'); 
```

但是当我们开始替换两位数或更多（12、200、3204，你明白我的意思）时，它就会停止正常工作。不知道如何让它按照我想要的方式运行。

提前致谢。非常感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-30T22:37:18.860

您需要指定多个数字：

```
string.replace( /\[\d+\]/g, '[newvalue]'); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/6AMwJ/)

（注意这个demo使用jQuery来遍历节点，不过只是为了方便，与正则表达式无关，只是演示了它的功能。）

我认为您的原件不起作用的原因是因为`\d`只匹配一个数字，而`+`运算符/字符一次或多次指定前面的（在本例中为数字）字符。

参考：

*   [Mozilla 开发者网络上的 JavaScript 正则表达式](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-30T22:37:03.627

使用以下内容：

`string.replace( /\[\d+\]/g, '[newvalue]');`

这应该匹配括号中的所有数字。

# php - 小时.分钟和小时.分钟之间的差异

> ID：11730693
> 
> 赞同：-4
> 
> 时间：2012-07-30T22:33:59.373
> 
> 标签：php, math

我有以下语法：

194 小时 45 分钟

```
$time[0] = 194.45; 
```

45小时12分钟

```
$time[1] = 45.12; 
```

那么如何在没有解决方案的情况下获得 $time[0] 和 $time[1] 之间的差异

```
xxx hours and >60 minutes (xx.>60) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:48:25.160

`.45`用于存储几乎没有意义`45 minutes`。为什么不使用 2 个变量，一个代表小时，一个代表分钟？

为什么要限制条件句的使用？你最终会得到这样的丑陋代码：

```
 $time[0] - $time[1] - 
 0.40 * ( floor($time[0]) - floor($time[1]) - floor($time[0]-$time[1]) ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T23:08:34.613

```
$mins = array();
$hours = array();
foreach( $time as $k => $v) {
    $mins[$k] = round( $v - floor( $v), 2);
    $hours[$k] = floor( $v - $mins[$k]);
}

$diff = round( $hours[0] - $hours[1] + ($mins[0] - $mins[1]), 2); 
```

这[输出](http://viper-7.com/2CfPWS)：

```
array(2) { [0]=> float(0.45) [1]=> float(0.12) } // <-- Mins
array(2) { [0]=> float(194) [1]=> float(45) }    // <-- Hours
float(149.33)                                    // <-- Difference 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T23:33:21.763

```
$md = ((int)$time[0]-(int)$time[1])+(5/3*(($time[0]-(int)$time[0])-($time[1]-(int)$time[1])));
$diff = (int)$md.'.'.str_pad((int)(substr(strrchr($md,'.'),1))*3/5,2,0,STR_PAD_RIGHT); 
```

给`$time`定的问题定义，`$diff`将结束于：`149.33`

# c# - 用于重复比较的谓词表达式函数

> ID：11730694
> 
> 赞同：3
> 
> 时间：2012-07-30T22:34:00.303
> 
> 标签：c#, expression, predicatebuilder

我有一个谓词处理程序，可以测试近 200 个案例，每个测试都涉及五种可能的比较。我想简化这段代码，但在如何用语法表达这一点时遇到了困难。

```
public static Expression<Func<OADataConsolidated, bool>> Match(DOTSearchFilter filters)
{
    var predicate = (filters.OrFilters.Count > 0) ? PredicateBuilder.False<OADataConsolidated>() : PredicateBuilder.True<OADataConsolidated>();

    foreach (DOTFilter f in filters.AndFilters)
    {
        int value = -1;
        int.TryParse(f.TextValue, out value);
        switch (f.Type)
        {
            case DOTFilter.FilterType.SCO:
                switch (f.IdValue)
                {
                    case 4: // GED: Reasoning
                        switch (f.Comp)
                        {
                            case DOTFilter.Comparitor.LessThan:
                                predicate = predicate.And(p => p.ajblGEDR_Mean < value);
                                break;
                            case DOTFilter.Comparitor.EqualOrLess:
                                predicate = predicate.And(p => p.ajblGEDR_Mean <= value);
                                break;
                            case DOTFilter.Comparitor.EqualTo:
                                predicate = predicate.And(p => p.ajblGEDR_Mean == value);
                                break;
                            case DOTFilter.Comparitor.EqualOrGreater:
                                predicate = predicate.And(p => p.ajblGEDR_Mean >= value);
                                break;
                            case DOTFilter.Comparitor.GreaterThan:
                                predicate = predicate.And(p => p.ajblGEDR_Mean > value);
                                break;
                        }
                        break;
                    case 5: // GED: Mathematics
                        switch (f.Comp)
                        {
                            case DOTFilter.Comparitor.LessThan:
                                predicate = predicate.And(p => p.ajblGEDM < value);
                                break;
                            case DOTFilter.Comparitor.EqualOrLess:
                                predicate = predicate.And(p => p.ajblGEDM <= value);
                                break;
                            case DOTFilter.Comparitor.EqualTo:
                                predicate = predicate.And(p => p.ajblGEDM == value);
                                break;
                            case DOTFilter.Comparitor.EqualOrGreater:
                                predicate = predicate.And(p => p.ajblGEDM >= value);
                                break;
                            case DOTFilter.Comparitor.GreaterThan:
                                predicate = predicate.And(p => p.ajblGEDM > value);
                                break;
                        }
                        break; 
```

上面的 switch 语句被重复了近 200 次，唯一不同的是每次检查的字段名称。我想尽可能减少这段代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:49:13.110

您可以像这样动态构建表达式：

```
string propertyName = GetPropertyName(f);
ExpressionType comp = GetComparisonType(f);
ParameterExpression p = Expression.Parameter(typeof(OADataConsolidated));
Expression<Func<OADataConsolidated, bool>> expr =
    Expression.Lambda<Func<OADataConsolidated, bool>>(
        Expression.MakeBinary(
            comp,
            Expression.Property(p, propertyName),
            Expression.Constant((double)value)),
        p);

predicate = predicate.And(expr);

...

static string GetPropertyName(DOTFilter filter)
{
    switch(filter.IdValue)
    {
        case 4: // GED: Reasoning
            propertyName = "ajblGEDR_Mean";
            break;
        case 5: // GED: Mathematics
            propertyName = "ajblGEDM";
            break;
        ...
        default:
            throw new ArgumentException("Unknown Id value");
    }
}

static ExpressionType GetComparisonType(DOTFilter filter)
{
    switch (filter.Comp)
    {
        case DOTFilter.Comparitor.LessThan:
            return ExpressionType.LessThan;
        case DOTFilter.Comparitor.EqualOrLess:
            return ExpressionType.LessThanOrEqual;
        case DOTFilter.Comparitor.EqualTo:
            return ExpressionType.Equal;
        case DOTFilter.Comparitor.EqualOrGreater:
            return ExpressionType.GreaterThanOrEqual;
        case DOTFilter.Comparitor.GreaterThan:
            return ExpressionType.GreaterThan;
        default:
            throw new ArgumentException("Unknown Comp value");
    }
} 
```

开关仍然存在，但不会重复。

# ios - UILabel 不能成为第一响应者并在 UITableView 中显示 inputView

> ID：11730697
> 
> 赞同：4
> 
> 时间：2012-07-30T22:34:09.937
> 
> 标签：ios, objective-c, uilabel

我试图创建一个 UILabel 的子类，调用`EditableLabel`并实现`canBecomeFirstResponder`, `isUserInteractionEnabled`，这两个方法都 return `YES`，同时，我覆盖了它们`inputView`并使`inputAccessoryView`它们可写。

我的问题是，当我点击标签时，inputView 无法显示在屏幕上。有人知道如何实现 UILabel 视图的子类并让 inputView 显示出来吗？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:51:01.477

为什么不只使用 a`UITextField`并将其设置`borderStyle`为`UITextBorderStyleNone`？

# javascript - 为什么需要 jquery 的 .data() 方法

> ID：11730699
> 
> 赞同：1
> 
> 时间：2012-07-30T22:34:20.703
> 
> 标签：javascript, jquery

在下面 `getElementsByTagName("p")[0]`和`getElementById("demo")`访问相同的元素。

以下两项工作，所以我无法弄清楚为什么甚至需要 jquery 数据函数。第二个不能移植到所有浏览器。

```
$(document.getElementsByTagName("p")[0]).data("funcZ", function() {console.log("ZZZZZ")})

$(document.getElementById("demo")).data("funcZ")() 
```

* * *

```
document.getElementsByTagName("p")[0].funcX = function() {console.log("XXXXX")}

document.getElementById("demo").funcX() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T22:40:24.177

根据 jQuery 网站：

> jQuery.data() 方法允许我们将任何类型的数据附加到 DOM 元素上，这种方式对循环引用是安全的，因此不会出现内存泄漏。jQuery 确保在通过 jQuery 方法删除 DOM 元素以及用户离开页面时删除数据。

有可能通过将随机字段附加到 DOM 元素，当 DOM 元素消失时，这些字段仍保留在内存中。看起来 jQuery 为您处理了这些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:50:49.023

该`$.data()`方法非常适合隐藏数据，而不是将其附加到数据属性。它可以通过键/值轻松访问，非常适合在创建插件或其他任何内容时存储状态信息。

# java - 嵌套 For 循环 - 用数组对象分隔字符串元素

> ID：11730701
> 
> 赞同：2
> 
> 时间：2012-07-30T22:34:42.753
> 
> 标签：java, arrays, if-statement, for-loop

我有一个简单的问题，但它最近让我发疯。我正在制作一个化学程序（更具体地说是 Android 应用程序），并且我有一种方法可以分离用户输入的元素。例如，如果有人在哪里输入“FeZnKPb”，它将被分成“Fe”、“Zn”、“K”和“Pb”。

为此，我使用了一些嵌套循环和变量来控制它。我在 Chem[] 数组中定义了所有元素。然后将分离的元素存储在一个名为 savedChem[] 的数组中。它基本上只是遍历所有元素常量（Chem[]），如果与输入匹配，则将这些元素的名称和公式复制到 savedChem[] 中。

这是我的代码：

```
public void separateElements(String Input)
{
    boolean found = false;
    int start = 0;
    int end = 2;
    int length = Input.length();

    while(length >= end)
    {
        for(int x = 0; x < numChemicals; x++)
        {
            if((end + 0) > length)
            {
                end += 5;
                break;
            }
            if(Input.substring(start, end).equals(Chem[x].getFormula()))
            {
                savedChem[numSaved].setName(Chem[x].getName());
                savedChem[numSaved].setFormula(Chem[x].getFormula());
                numSaved++;
                start += 2;
                end += 2;
                found = true;
            }
            else
            {
                found = false;
            }
        }
        if(!found)
        {
            start += 2;
            end += 2;
        }
    }
} 
```

我的问题是它仅适用于 2 字符元素，例如“Fe”或“Zn”。我希望它也能识别像“K”这样的其他人。另一个问题是它有时会跳过一些其他元素。例如，如果我输入“FeZnHg”，它会将它们分成“Fe”、“Zn”和“Hg”。但是，如果我以不同的顺序输入它们，例如“ZnFeHg”，由于某种原因，它只会检测到“Zn”和“Hg”，而不是“Fe”。

我还有什么其他方法可以解决这个问题以使其正常工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T22:45:32.333

鉴于元素总是一个大写字符和一个或两个小写字符（只有在一些非常短暂的元素的情况下才两个），您可以使用带有一些前瞻的正则表达式将您的输入拆分为短字符串。

您可以使用 split 方法和一些前瞻将字符串拆分为元素字符串。考虑到纳撒尼尔福特的评论：

```
public enum ChemicalElement {
    F, Fe, Zn, K, Pb, Umm, //and so on...
}

public List<ChemicalElement> separateElements(String input) {
    String[] inputParts = input.split("(?=[A-Z]{1,1}[a-z]{0,2})");

    List<ChemicalElement> elementList = new LinkedList<ChemicalElement>();
    for (int i = 1; i < inputParts.length; i++) {
        String inputPart = inputParts[i];

        // note: throws IllegalArgumentException for unknown elements
        ChemicalElement element = ChemicalElement.valueOf(inputPart);
        if (null != element) {
            elementList.add(element);
        }

    }
    return elementList;
} 
```

所以像这样的测试输入：

```
String input = "FeZnKPbUmmK";
List<ChemicalElement> elements = this.separateElements(input); 
```

将为您提供以下列表：

[Fe、Zn、K、Pb、Umm、K]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:41:47.867

1.  与其预先定义 end ，不如做 end `start + length of chemical name being tested`。所以你会比较此外，`Chem[x].getFormula().equals(Input.substring(start, start + Chem[x].getFormula().length()))` 你会前进`start`。`Chem[x].getFormula().length()`我认为您还需要验证`start + Chem[x].getFormula().length()`是否小于总长度，否则您将获得 String Index out of bounds 异常。
2.  当您找到化学名称匹配时，您需要`break`从内部循环中检查化学名称，否则您会继续与后来的名称进行比较，并可能以`found=false`. 因此，您的底部`if`语句错误地前进了两个字符。例如，如果`Fe`在`Zn`您的列表中出现，则在找到`Fe`之后将不会找到`Zn`并会跳过它。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-30T22:54:03.787

这是我的谦虚建议...对于您的程序的未来，我想在您有多个 O 原子的情况下它也会更好...如果无论如何都需要...我会做什么...我会创建一个所谓的 2d 矩阵（使用更多内存但计算能力更少）26x26，其中每个索引对应一个字母......所以我们知道元素符号是唯一的，最多 2 个字母（我不确定那些实验性的......抱歉：D）...然后您将一一扫描字符串...假设您遇到 F 和 e..这会自动建议二维矩阵的索引...因此您将查看该索引内部...如果它是满的（通过某种标志），那么你会将 Fe 添加到你的总列表中......但是让我们说在 F 之后你看到了一个 K......然后当你查看矩阵时，你会看到它是空的，你会得出结论是氟...无论如何，正如我所说的更多的内存空间更少的计算......你的选择

# c# - 提取嵌入在 PDF 中的图像的大小

> ID：11730709
> 
> 赞同：1
> 
> 时间：2012-07-30T22:35:27.557
> 
> 标签：c#, image, pdf, itextsharp

我在 PDF 文件中嵌入了一张图片。我能够提取图像的分辨率。但是，如果我使用 iTextsharp 裁剪 PDF，并且在此过程中裁剪了部分图像。新图像继续具有相同的分辨率。分辨率是指宽度 x 高度形式的尺寸。裁剪后的图像应该具有较小的尺寸。如果可能的话，如何以英寸为单位提取图像的大小，以便将原始图像与裁剪的 pdf 区分开来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:24:48.037

PDF 中的嵌入图像永远不会被“裁剪”，因为“裁剪掉”的部分永远消失了。它们只是在这些部分被隐藏或掩盖的意义上被裁剪。

如果 PDF 中的图像数据显示`/Height 216`，`/Width 288`那么这是以**像素**为单位的大小（不是英寸或任何其他长度单位）。然后“分辨率”是次要的：

*   如果 PDF 环境要求将此图像渲染到 3x4 英寸的正方形上，则此时其分辨率为 72x72 dpi。

*   如果 PDF 环境要求将此图像渲染到 1.5x2 英寸的正方形上，则此时其分辨率为 144x144 dpi。

然而，很可能图像只是部分可见（“裁剪”），可能是因为它的一半渲染超出了页面边框......

# http - 监听系统事件以检测 http 请求

> ID：11730710
> 
> 赞同：1
> 
> 时间：2012-07-30T22:35:28.757
> 
> 标签：http, events, unix, daemon

我想写一个 unix 守护进程来记录我的 http 请求。

我决定这样做是因为我想：

*   学习一些关于 HTTP 协议、线程（或分支）、unix 等的知识。
*   对我的互联网活动进行一些统计。

从理论的角度来看，我看到了一些我需要完成的子任务：

*   启动应该监听系统事件的主线程（或进程）。
*   捕获 http-requests 事件。（例如，我需要找到一些方法来区分 http-request 事件和其他系统事件）
*   创建一个新线程（或进程）将捕获的 http-request 写入数据库。（我不确定，但我想为 IO 任务创建一个新线程（或进程）以避免中断主线程或进程是一个不错的主意）。

我不是要求完整的解决方案或类似的东西，我只是想获得一些参考/建议，从哪里可以开始实现我的目标以及哪种仪器更适合这种任务。

# html - 无论如何要获得具有位置的div：绝对在具有位置的div之外：相对？

> ID：11730720
> 
> 赞同：2
> 
> 时间：2012-07-30T22:36:38.203
> 
> 标签：html, css

我有这样的结构：

```
<div class="a">
  <div class="b">
    <div>
      <div class="c">
      </div>
    </div>
  </div>
</div> 
```

CSS：

```
.a { position:relative; }
.b { position:absolute; } 
```

我知道定义 top 和 left/right 属性将绝对 div 定位到其具有 position:relative 的父级或浏览器窗口（如果这样的父级不存在）。我面临的问题是，我无法更改 .a 和 .b 的 CSS。而且我需要 .c 位于 .a 之上并稍微脱离它。所以 .a 没有滚动条。

一些 ASCII 艺术来说明，我猜 :)

我有：

```
-------------------
|   .a           |^|
|                | |<-- Scroll bar
|   ------       | |
|   | .c |       |*|
------------------- 
```

我需要：

```
--------------------
|   .a             |
|                  |<-- No scroll bar
|   ------         |
|   | .c |         |
----|    | ---------
    |    |
    ------ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-30T22:51:02.483

此解决方案将堆叠所有项目，并且`<div class="c">`将伸出其父容器：

### CSS

```
<style>

    .a {
        position:relative;
        width:200px;
        height:200px;
        border:1px solid red;
        background:#eee;
    }

    .b {
        position:absolute;
        top:20px;
        left:20px;
        width:200px;
        height:200px;
        border:1px solid blue;
        background:#ccc;
    }

    .c {
        position:absolute;
        bottom:-50px;
        left:20px;
        width:100px;
        height:100px;
        border:1px solid orange;
        background:#aaa;
    }

</style> 
```

### HTML

```
<div class="a">
    <div class="b">
        <div>
            CONTENT
            <div class="c"></div>
        </div>
    </div>
</div> 
```

**请注意**，这仅在父容器具有`overflow:visible`. 我猜当其中一位父母有`overflow:hidden|scroll`你无法解决这个问题时。

# python - 基于文本的 rpg 索引超出范围错误

> ID：11730721
> 
> 赞同：1
> 
> 时间：2012-07-30T22:36:40.243
> 
> 标签：python

我正在尝试制作一个简单的基于文本的游戏。

```
while True:
    choice = raw_input('>>: ')
    aa = choice.split()

    if aa[0] == 'examine':
        if aa[1] == 'key':
            print "It's a key alright."
        else:
            print "I can't examine that!"
    else:
        print "I don't know how to do that." 
```

当我输入除“检查键”以外的其他内容时，列表索引不断超出范围。我知道为什么会这样，但我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:40:59.527

索引前检查长度。

```
if len(aa) > 1: 
```

# python - 麻烦给一副牌赋予价值

> ID：11730723
> 
> 赞同：1
> 
> 时间：2012-07-30T22:36:57.290
> 
> 标签：python

（编号为 2-10 的牌的值应分别为 2-10。J、Q 和 K 应为 10，A 应为 1 或 11，具体取决于手牌的值）。

我如何分配这些值？此外，游戏需要进行 3 轮。我这样做的方式只有一轮。如何让游戏进行三遍，同时跟踪玩家的赢/输？

有人可以解释一下我如何以简单的方式做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:05:27.777

这是一个完整的实现给你

看看hand.score

```
import random

class Card:
    def __init__(self,rank,suite):        
        self.rank = rank
        self.suite = suite
    def Rank(self):
        return "Ace Two Three Four Five Six Seven Eight Nine Ten Jack Queen King".split()[self.rank]
    def Suite(self):
        return "Hearts Spades Clubs Diamonds".split()[self.suite]
    def __str__(self):
        #print "Get Self:",type(self)
        #print "Dir:",dir(self)
        #return "OF"
        return self.Rank()+" of "+ self.Suite()

class Hand:
    def __init__(self):
        self.cards = []
    def Score(self):
        aces_ct = 0
        score = 0
        for c in self.cards:
            if c.rank == 0:
                aces_ct += 1
                score += 11
            if 0 < c.rank < 9:
                score += c.rank+1
            else:
                score += 10
        while score > 21 and aces_ct > 0:
            score -= 10
            aces_ct -= 1
        return score
    def add(self,card):
        self.cards.append(card)
    def Show(self,show_only=None):
        if not show_only:
            for k in self.cards:
                print "%s"%k
        else:
            if isinstance(show_only,int):
                print "%s"%self.cards[show_only]
            elif isinstance(show_only,(list,tuple)):
                for idx in show_only:
                    print "%s"%self.cards[idx]

class deck:
    def __init__(self):
        self.cards = []
        for i in range(4):
            for j in range(13):
                self.cards.append(Card(j,i))
        random.shuffle(self.cards)
    def shuffle(self):
        random.shuffle(self.cards)
    def pop(self):
        return self.cards.pop()

if __name__ == "__main__":
    d = deck()
    player_hand = Hand()
    dealer_hand = Hand()
    player_hand.add(d.pop())
    dealer_hand.add(d.pop())
    player_hand.add(d.pop())
    dealer_hand.add(d.pop())
    print "Player Score :",player_hand.Score()
    player_hand.Show()
    print "\n\nDealer Score :",dealer_hand.Score()
    dealer_hand.Show() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:52:02.560

您可以将汽车表示为元组：一个表示西装的字符和一个表示值的数字。我还将向元组添加第三个值，它的二十一点值（例如，国王和王后都算作 10）。

```
card = ('D', 11, 10)  # card is queen of diamonds 
```

您还可以创建自己的类来表示卡片。

```
class Card(object):
    def __init__(self, suit, number):
        self.suit = suit
        self.number = number
        self.value = (number if 2 <= number <= 9 else 10) 
```

当然，您必须对 ace 的值进行特殊处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T22:56:24.313

您可能应该动态计算总数。此外，您需要某种方式来存储每个玩家的钱。现在，没有办法知道钱的分配，因为你只有一个总数。

# java - JAVA DOM xml 属性

> ID：11730726
> 
> 赞同：0
> 
> 时间：2012-07-30T22:37:09.150
> 
> 标签：java, xml, dom

我在这里处理一个问题，获取尺寸计算价格。我只需要加上属性价格，但我无法弄清楚如何走得更远。我试过做一个嵌套的for循环，但没有成功。

```
<?xml version= "1.0" encoding= "UTF-8" standalone="yes" ?>

<PizzaParlor>
    <Order>
        <Pizza Size="large">
            <Vegetarian>
                <Mushroom Price="1.99">
                </Mushroom>
            </Vegetarian>

        </Pizza>
        <Pizza Size="small">
            <Vegetarian>
                <Spinach Price="1.45">
                </Spinach>
            </Vegetarian>

        </Pizza>
        <Pizza Size="medium">
            <Vegetarian>
                <Pineapple Price="1.79">
                </Pineapple>
            </Vegetarian>

        </Pizza>
        <Pizza Size="small">
            <Vegetarian>
                <Mushroom Price="1.99">
                </Mushroom>
            </Vegetarian>

        </Pizza>
        <Pizza Size="large">
            <Vegetarian>
                <Mushroom Price="1.99">
                </Mushroom>
            </Vegetarian>
        </Pizza>
            <Pizza Size="large">
            <non-vegetarian>
                <Anchovies Price="1.99">
                </Anchovies>
            </non-vegetarian>

        </Pizza>
        <Pizza Size="small">
            <non-vegetarian>
                <Ham Price="1.45">
                </Ham>
            </non-vegetarian>

        </Pizza>
        <Pizza Size="medium">
            <non-vegetarian>
                <Anchovies Price="1.79">
                </Anchovies>
            </non-vegetarian>

        </Pizza>
        <Pizza Size="small">
            <non-vegetarian>
                <Pepperoni Price="2.49">
                </Pepperoni>
            </non-vegetarian>

        </Pizza>
        <Pizza Size="large">
            <non-vegetarian >
                <Chicken Price="2.99">
                </Chicken>
            </non-vegetarian >
        </Pizza>
    </Order>
</PizzaParlor> 
```

我的java程序有这个：

```
package pizza;

import java.io.*;
import javax.xml.parsers.*;
import org.w3c.dom.*;
import org.xml.sax.*;

public class Pizza
{
    public static void main (String [] args)
        throws
        IOException,
        ParserConfigurationException,
        SAXException
        {
            File CFile = new File ("pizzaparlor.xml");
            DocumentBuilderFactory factory =
                DocumentBuilderFactory.newInstance ();
            factory.setIgnoringComments (true);
            factory.setIgnoringElementContentWhitespace (true);
            factory.setValidating (true);
            DocumentBuilder builder = factory.newDocumentBuilder ();
            Document document = builder.parse (CFile);
            Element root = document.getDocumentElement ();

            Node orderNode = root.getFirstChild();
            Node Pizza = orderNode.getFirstChild();

            int countofPizzas = 0;

            for(int i = 0 ; Pizza!=null; i ++){

                countofPizzas ++;
                Pizza = Pizza.getNextSibling();

            }
            System.out.println(countofPizzas); 

            double price = 0.0;

            NodeList Orders = root.getFirstChild().getChildNodes();

            for (int i = 0; i < Orders.getLength() ; i++)
            {
                Element pizzaSize = (Element) Orders.item(i);
                String pSize = pizzaSize.getAttribute("Size");

                if (pSize.equalsIgnoreCase("Large"))
                    price = 10.0;
                if (pSize.equalsIgnoreCase("Medium"))
                    price = 7.0;
                if (pSize.equalsIgnoreCase("Small"))
                    price = 5.0;

                System.out.println("Pizza " + i + " " + pSize + " " + price);

            }
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:16:00.167

如果您只对 Pizza 节点感兴趣，可以使用 getElementsByTagName() 方法返回它们。

```
import java.io.*;
import javax.xml.parsers.*;
import org.w3c.dom.*;
import org.xml.sax.*;

public class Pizza
{
    public static void main (String [] args)
        throws
        IOException,
        ParserConfigurationException,
        SAXException
        {
            File CFile = new File ("pizzaparlor.xml");
            DocumentBuilderFactory factory =
                DocumentBuilderFactory.newInstance ();
            factory.setIgnoringComments (true);
            factory.setIgnoringElementContentWhitespace (true);
            factory.setValidating (false);
            DocumentBuilder builder = factory.newDocumentBuilder ();
            Document document = builder.parse (CFile);

            NodeList pizzas = document.getElementsByTagName("Pizza");

            for (int i = 0; i < pizzas.getLength() ; i++)
            {
                Element pizzaSize = (Element) pizzas.item(i);
                String pSize = pizzaSize.getAttribute("Size");

                if (pSize.equalsIgnoreCase("Large"))
                    price = 10.0;
                if (pSize.equalsIgnoreCase("Medium"))
                    price = 7.0;
                if (pSize.equalsIgnoreCase("Small"))
                    price = 5.0;

                System.out.println("Pizza " + i + " " + pSize + " " + price);
            }

        }
} 
```

# linux - 没有中央存储库的 Git 是一个很好的工作流程吗？

> ID：11730729
> 
> 赞同：0
> 
> 时间：2012-07-30T22:37:17.953
> 
> 标签：linux, git

我们正在一个 3 人团队中开展一个项目。我们还没有一台单独的机器来设置 Git 中央服务器，所以我们必须在没有它的情况下相处。我们将在几天内拥有这台机器，所以我将当前的工作流程更像是一个实验。所以现在我们这样做：

1）每个成员都在他的计算机上创建一个 git 存储库，就像这样：

```
 git init 
```

2）每个成员都让他的存储库被其他人读取，如下所示：

在 .git 目录中：

```
touch git-daemon-export-ok 
```

接着：

```
git daemon & 
```

3）每个成员将他的存储库地址发送给其他成员，每个成员都像这样导入它：

```
git remote add aa git://xxx.xxx.xxx.xxx/home/username/code 
```

现在，当初始设置完成后，我们的工作流程如下所示：

我们签出到本地存储库上的 dev 分支来完成这项工作。完成后，我们将其他成员的主分支拉入我们的存储库：

```
git pull --rebase aa master
git pull --rebase ab master
... 
```

最后，如有必要，我们会从我们的 dev 分支中压缩提交，并将它们与我们的本地 master 合并。从现在开始，其他成员将能够将这些提交从我们的计算机下载到他们的主人中。

你怎么看待这件事？

#

我应该补充一点，这正在公司中发生，我们不允许在这里使用 Github 或类似的东西。我们的软件将是开源的，但我们必须遵守严格的安全政策。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:50:14.160

我相信如果团队自律，应该不会有任何问题，但一定要把这当作一个临时解决方案，因为如果团队增加，避免问题会更加困难。顺便说一句，也许考虑一下 github 私有存储库。他们的工作就像一个魅力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T22:51:27.880

对我来说似乎是一个复杂的解决方案。那么为什么不暂时使用托管服务，并在它到达时转移到您自己的 Git 服务器上呢？

显然，GitHub 是这里房间里的 800 磅大猩猩，但我个人以专业身份使用 BitBucket，因为与 GitHub 不同，它提供免费的私有存储库（但仅限于五个用户）。

# r - 尝试在 R 中绘制 ols 对象时出错

> ID：11730734
> 
> 赞同：2
> 
> 时间：2012-07-30T22:37:41.083
> 
> 标签：r, plot, rms

我目前在尝试使用 R 中的 ols() 绘制线性回归时遇到问题。

我的代码是：

```
library(languageR)
library(rms)

english.dd = datadist(english)

options(datadist = "english.dd")

english.ols = ols(RTlexdec  ~ WrittenFrequency + LengthInLetters, english)

plot(english.ols)

## Error en match.arg(type) : 
##   'arg' should be one of “ordinary”, “score”, “dfbeta”, “dfbetas”, “dffit”,  “dffits”, “hat”, “hscore”

## Calls: plot ... weighted.residuals -> residuals -> residuals.ols -> match.arg 
```

我不知道如何解决这个问题，我一直在网上寻找解决方案，但我找不到任何解决方案。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:54:08.600

当我跑

```
plot(Predict(english.ols)) 
```

我得到： ![在此处输入图像描述](../Images/67d573f82f989edd7e1747b7a1e271ac.png)

其他例子还有很多`?plot.Predict`

# jqgrid - jqGrid 在 MVC 4.0 中不显示行

> ID：11730735
> 
> 赞同：0
> 
> 时间：2012-07-30T22:37:43.383
> 
> 标签：jqgrid, asp.net-mvc-4

我试过了，我终于放弃了试图弄清楚为什么我的 jqGrid 不显示数据。

让我一步一步尝试：以下是脚本中包含的内容...

```
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
<link href="../../Content/themes/redmond/jquery-ui-1.8.2.custom.css" rel="stylesheet" type="text/css" />
<link href="../../Content/themes/redmond/ui.jqgrid.css" rel="stylesheet" type="text/css" />
<link href="../../Content/themes/base/jquery.ui.button.css" rel="stylesheet" type="text/css" />

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js" type="text/javascript"></script>

<script src="../../Scripts/grid.locale-en.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.jqGrid.min.js" type="text/javascript"></script> 
```

JSON 返回：

```
{
"total": 1,
"page": 1,
"records": 1,
"rows": [
    {
        "id": "0001",
        "cell": [
            "0001",
            "XXXXX",
            "XXXX",
            "XXX",
            "XXX",
            "XXXXX",
            "XXXX",
            "7/27/2012 1:46:22 PM",
            "XXXXX",
            "7/30/2012 3:48:25 PM"
        ]
    }
] 
```

}

jqGrid代码如下：

```
jQuery(function ($) {
    jQuery('#tblManageApplication').jqGrid({
        url: '/AdminView/ManageApplicationsJQGridData',
        datatype: 'json',
        loadError: function (xhr, status, error) { alert(status + " " + error); }, 
        mtype: 'GET', 
        colNames: ['Application ID', 'Application Name', 'Application Description', 'Country Code', 'Country Name', 'Source Indicator Code', 'Insert User ID', 'Insert User Timestamp', 'Update User ID', 'Update User Timestamp'],
        colModel: [
                    { name: 'ApplicationID', jsonmap: 'cell.ApplicationID', width: 150 },
                    { name: 'ApplicationName', jsonmap: 'cell.ApplicationName', width: 200 },
                    { name: 'ApplicationDescription', jsonmap: 'cell.ApplicationDescription', width: 250 },
                    { name: 'CountryCode', jsonmap: 'cell.CountryCode', width: 100 },
                    { name: 'CountryName', jsonmap: 'cell.CountryName', width: 100 },
                    { name: 'SourceIndicatorCode', jsonmap: 'cell.SourceIndicatorCode', width: 100 },
                    { name: 'InsertUserID', jsonmap: 'cell.InsertUserID', width: 100 },
                    { name: 'InsertUserTimestamp', jsonmap: 'cell.InsertUserTimestamp', width: 100, formatter: 'date', formatoptions: { newformat: 'd-m-Y' }, datefmt: 'd-m-Y' },
                    { name: 'UpdateUserID', jsonmap: 'cell.UpdateUserID', width: 100 },
                    { name: 'UpdateUserTimestamp', jsonmap: 'cell.UpdateUserTimestamp', width: 175, formatter: 'date', formatoptions: {newformat: 'd-m-Y'}, datefmt: 'd-m-Y' }
                  ],
        pager: jQuery('#pager'),
        sortName: 'ApplicationID',
        rowNum: 10,
        jsonReader: { repeatitems: false },
        rowList: [10, 20, 50],
        sortorder: 'desc',
        height: 300,
        width: 1200,
        caption: 'Manage Applications',
        onCellSelect: function (rowid, index, contents, event) {
            alert('onCellSelect: ' + index + ' : ' + contents);
        },
        success: function (data, textStatus) {
            if (textStatus == 'success') {
                alert('Successful');
            }
        },
        error: function (data, textStatus) {
            alert('An error has occurred');
        }
    });
}); 
```

想添加相应的HTML供您参考：

```
<table id="tblManageApplication"></table>
<div id="pager"></div> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T02:32:57.083

首先，您能否确认您从控制器发送的数据和 colModal 名称按字母顺序相同？

第二次检查你的 json 阅读器

检查这个链接

[http://www.ok-soft-gmbh.com/jqGrid/ipInfo.htm](http://www.ok-soft-gmbh.com/jqGrid/ipInfo.htm) 我认为您需要在这里指定一些东西，例如 id 和记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T10:20:04.243

您的代码中的主要错误是`jsonReader: { repeatitems: false }`选项的使用，并且`jsonmap`在您根本不需要的情况下。您以标准格式生成数据。因此，您必须删除选项才能填充网格。

此外，我建议您将数据格式更改为[ISO 8601](http://de.wikipedia.org/wiki/ISO_8601)格式（您可以`DateTime`在服务器代码上使用“o”格式）或至少定义正确`srcformat`：

```
formatoptions: {srcformat: 'm/d/Y g:i:s A', newformat: 'd-m-Y'} 
```

[该演示](http://www.ok-soft-gmbh.com/jqGrid/AbhisheikDeo.htm)演示了我上面描述的更改有效。

# javascript - javascript数组可以是数字的还是关联的？

> ID：11730736
> 
> 赞同：1
> 
> 时间：2012-07-30T22:37:45.363
> 
> 标签：javascript

> **可能重复：**
> [javascript数组关联和索引？](https://stackoverflow.com/questions/1076658/javascript-array-associative-and-indexed)

我正在从一个函数返回一个数组，我想知道我是否也可以同时拥有字符串关联和数字关联。

前任：

```
array[0] = green;
array[1] = blue;
array['what'] = colors; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:51:53.363

数组只是具有特殊长度属性和一些方便的继承方法的对象。由于数组是对象，因此它们的属性名称是字符串，但是数组方法会访问数字的（'0'、'1'、'2' 等），而非数字的（例如长度）则不会。此外，许多数组方法是通用的，可以应用于任何具有合适属性（即数字长度属性和一些数字属性名称）的对象。

请注意，要被视为索引，属性名称必须满足[索引名称的规则，](http://es5.github.com/#x15.4)因此：

```
var x = [];
x['00'] = '00';  // length = zero as '00' is not an index
x['0']  = '0';   // length = 1 as '0' is an index 
```

通常认为在普通对象可以使用数组的情况下使用数组是不好的形式，尽管这样做没有任何后果，除非你弄乱了*长度*属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:41:14.980

在某种程度上是的，因为它是某种类型的对象。但是使用它们是错误的 :) 使用对象（`{}`）作为命名（字符串）索引，使用数组（`[]`）作为数字索引。

# backbone.js - 绑定时触发的主干事件

> ID：11730738
> 
> 赞同：2
> 
> 时间：2012-07-30T22:37:50.450
> 
> 标签：backbone.js, backbone-events, backbone-views

我需要将点击事件绑定到一定数量的特殊 div，应该绑定哪些 div 仅在运行时知道，所以我想简单地为所有这些特殊 div 设置一个类并将它们绑定到“事件”中，然后单击其中一个这些 div 会触发所有 div 触发然后我尝试在事件中使用变量，但这些变量仅在运行时知道，所以事实证明它们在绑定事件时未定义现在我使用 jQuery 在运行时绑定 Backbone 内的事件，但是每当我初始化视图时，事件就会立即触发

```
var RoomNumber = Backbone.View.extend({
    el: $('#roomColumn' + this.roomNumber),
    initialize: function () {
        _.bindAll(this, 'render');
        this.user = this.options.user;
        this.roomNumber = this.options.roomNumber;
        this.render();
        //$('#roomNumber'+this.roomNumber).on('click', this.enterBooking());
    },
    render: function () {
        $(this.el).append("<div class = 'roomNumber' id  = 'roomNumber" + this.roomNumber + "'>" + this.roomNumber + "</div>");
    },
    enterBooking: function () {
        var slideForm = new SlideForm({
            user: this.user,
            roomNumber: this.roomNumber,
            state: 'book',
            singleSchedule: new Schedule()
        });
    }
}); 
```

有人会解释为什么会发生这些吗？以及如何将事件绑定到动态生成的 div？

（我知道我可能不应该使用这样的主干视图......但这是要求的一部分）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T18:58:16.503

您的代码有两个问题：

1.  回答您的观点，绑定时会触发事件，因为您在绑定时调用事件处理程序。

    `$('#roomNumber'+this.roomNumber).on('click', this.enterBooking());`
    应该
    `$('#roomNumber'+this.roomNumber).on('click', this.enterBooking);`
    注意函数调用大括号。

2.  你设置 el 的方式是错误的

    `el: $('#roomColumn' + this.roomNumber),`
    在主干中，`el`视图的属性在`initialize`方法被调用之前被设置。这意味着主干将尝试寻找`$('#roomColumnundefined')`不期望的元素。相反，您可以将`el`元素作为选项传递给视图

    ```
     var roomNumber = 3;
        var view = new RoomNumber({
            roomNumber:roomNumber,
            el:$('#roomColumn' + roomNumber)
        }); 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T02:26:17.003

```
......
//Pseudo code
render: function () {
    $(this.el).append("<div class = 'roomNumber' id  = 'roomNumber" + this.roomNumber + "'>" + this.roomNumber + "</div>");

    //you can dynamic set up events like this:
    this.events["click #roomNumber"+this.roomNumber] = "enterBooking";
    this.delegateEvents(this.events);

},
...... 
```

# ios - 防止使用反编译器 IDA 从 iOS 应用程序中检索变量值

> ID：11730739
> 
> 赞同：1
> 
> 时间：2012-07-30T22:37:55.060
> 
> 标签：ios, xcode, jailbreak, decompiler

我读过一些问答，说可以从应用程序的可执行文件中检索变量值。我了解到应用程序是使用 Apple 证书加密的。我的理解是应用程序只有在运行并将代码放入内存时才会被解密。

我想知道是否有人可以检索解密的应用程序以在未越狱的 iPhone 上滥用。或者在越狱的手机上呢？

有什么办法可以预防吗？

如果可以的话，在应用程序中存储硬编码的加密密钥等秘密值不是可靠的方法。我对吗？

# android - Android 4.0 选项卡式活动布局

> ID：11730740
> 
> 赞同：1
> 
> 时间：2012-07-30T22:37:57.260
> 
> 标签：android, android-actionbar, tabactivity

我的应用程序中有 2-3 个活动，它们都在内存池中共享数据。我希望能够在这些活动之间轻松切换，同时保持它们同时运行。另外，我正在为 Android 4.0 开发。我想使用`TabActivity`，但它已被弃用并替换为`ActionBar`，我已经尝试过，但我认为这不是我想要的。我想要大标签，类似于在股票 Android 音乐应用程序中找到的经典“艺术家/播放列表/所有”标签，或者像下面屏幕截图底部的标签栏。有谁知道创建这些选项卡的库或一种`ActionBar`更可定制的方法？或者正在使用`TabActivity`一个非常好的解决方案，即使是在 ICS 设备上？

![在此处输入图像描述](../Images/4e3dea1b21a33fa9bcf5a52cd5849a93.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:43:22.357

实际上，ActionBar 是您正在寻找的。

您应该将您的活动转换为片段。假设它们不是太复杂，这应该不难。那里有很多例子。您需要一个 Activity，最好是一个 Activity`FragmentActivity`来保存所有这些。

这应该有助于：

[http://arvid-g.de/12/android-4-actionbar-with-tabs-example](http://arvid-g.de/12/android-4-actionbar-with-tabs-example)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T22:48:43.620

这有几个子问题，我将尝试解决所有问题：

- 为了使用顶部选项卡，您需要使用 ActionBar。

- 如果您要按照音乐应用程序的样式进行操作，您可以在视图之间横向滑动，并且当前视图的标签始终位于前面和中间......为此，您要使用的类称为[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)

您可以通过在 eclipse 中创建一个新的 Activity 并通过向导来查看所有这些方法。在“导航类型”下，您可以选择“标签”、“标签 + 滑动”、“滑动视图 + 标题条”。创建这些活动中的任何一个以查看其外观，然后查看代码以了解其实现方式以及如何对其进行自定义。

-不鼓励沿底部导航- 请参阅[Android 设计指南](http://developer.android.com/design/patterns/pure-android.html)，指定“不要使用底部标签栏”部分

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T00:19:58.683

您现在可能已经找到了答案，但我想我会分享另一种方法，您可以使用图像和 xml 创建类似标签栏的内容：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent"        
    android:orientation="vertical"
    android:id="@+id/main">

    <LinearLayout 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"        
        android:orientation="horizontal"
        android:background="@drawable/tabackground"
        android:layout_alignParentBottom="true"
        android:id="@+id/llBottom">

        <ImageButton 
            android:src="@drawable/icon2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="#00000000"
            />

        <ImageButton 
            android:src="@drawable/icon3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="#00000000"
            />

        <ImageButton 
            android:src="@drawable/icon4"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="#00000000"
            />

        <ImageButton 
            android:src="@drawable/icon5"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="#00000000"
            />        

    </LinearLayout>

    <ImageView         
        android:layout_height="24dp"
        android:layout_width="fill_parent"
        android:layout_alignTop="@+id/llBottom"       
        android:background="#10ffffff"/>

    <ImageView         
        android:layout_height="1dp"
        android:layout_width="fill_parent"
        android:layout_alignTop="@+id/llBottom"       
        android:background="#30ffffff"/>

</RelativeLayout> 
```

![在此处输入图像描述](../Images/a1ce91d5c9aff6385937394ae619bead.png)

并不完美，但有一些创造力和改变一些价值观，它看起来会非常好。

希望它在某种程度上有所帮助。

# php - Google Drive PHP API V2 列出时无结果

> ID：11730742
> 
> 赞同：2
> 
> 时间：2012-07-30T22:38:11.690
> 
> 标签：php, google-drive-api

我正在为 joomla 创建一个模块，其中列出了给定文件夹的内容。该模块作为服务工作，因此不需要 OAuth。我被困住了，因为我提出的每个请求都有相同的答案，没有项目。所以我想知道我是否以错误的方式创建客户端/服务，或者我可能以错误的方式注册了应用程序。这是代码：

```
// this class is where I have all the IDs from the google console
require_once(dirname(__FILE__) . '/gdrive/config.php');
require_once(dirname(__FILE__) . '/gdrive/gd-v2-php/apiClient.php');
require_once(dirname(__FILE__) . '/gdrive/gd-v2-php/contrib/apiDriveService.php');

$client = new apiClient();
$key    = file_get_contents(Config::KEY_FILE);
$client->setClientId(Config::CLIENT_ID);

$client->setUseObjects(true);
$client->setAssertionCredentials(new apiAssertionCredentials(
    Config::SERVICE_ACCOUNT_NAME,
    array('https://www.googleapis.com/auth/drive'), $key)
);

$service = new apiDriveService($client);

try {
    $parameters = array();
    $parameters['maxResults'] = $maxResults;

    $files = $service->files->listFiles($parameters);

    $items = $files->getItems();
    var_dump($items);
    $pageToken = $files->getNextPageToken();
} catch (apiServiceException $e) {
    print "Error code :" . $e->getCode() . "\n";
    // Error message is formatted as "Error calling <REQUEST METHOD> <REQUEST URL>: (<CODE>) <MESSAGE OR REASON>".
    print "Error message: " . $e->getMessage() . "\n";    
} catch (apiException $e) {
    // Other error.
    print "An error occurred: (" . $e->getCode() . ") " . $e->getMessage() . "\n";
} catch (Exception $e) {
    print "Cannot retrieve the files";
    print($e->getMessage());
} 
```

很抱歉问了这样一个菜鸟问题，但这让我发疯了谢谢

**PS**只是为了记录，我遵循了这个[google-api-php-client/wiki/OAuth2#Service_Accounts](https://code.google.com/p/google-api-php-client/wiki/OAuth2#Service_Accounts)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T09:43:31.333

在再次查看文档后，我发现 Google Drive**不支持**服务帐户。我不知道这是否会改变，但是根据我的要求（我需要在网络上显示最终用户使用桌面应用程序上传到文件夹（公共）的内容）我想我不能使用谷歌驱动器作为一个有效的解决方案。

我找到了一个解决方案，但我不太喜欢，因为我应该永远刷新令牌[Google Drive SDK 服务帐户错误](https://stackoverflow.com/questions/10426632/google-drive-sdk-service-account-error-the-authenticated-user-has-not-installed)

# ios - ios - 更改坐标后按钮没有响应单击

> ID：11730745
> 
> 赞同：4
> 
> 时间：2012-07-30T22:38:29.413
> 
> 标签：ios, ios5

我在 .h 文件中有一个这样配置的按钮：

```
- (IBAction)addBusiness:(id)sender;
@property (weak, nonatomic) IBOutlet UIButton *planBusinessButton; 
```

然后我在我的 .m 文件中执行此操作：

```
- (IBAction)addBusiness:(id)sender 
{
    NSLog(@"Plan business clicked 1");
}

- (IBAction)planBusinessButton:(id)sender 
{
    NSLog(@"Plan business clicked 1");
} 
```

但在我的 onLoad 我做这样的事情：

```
CGPoint pt = planBusinessButton.center;
    pt.y -= 275;
    planBusinessButton.center = pt; 
```

问题是当我单击按钮时，按钮单击未在 IBAction 中触发。

按钮位置的更改是否会影响按钮未被点击的原因？

为什么按钮单击不会在 IBAction 中触发？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T22:46:45.153

编辑：移动按钮不应影响它的动作触发，除非它已移出视图或位于会拦截点击的其他视图下方。

如果点击没有触发按钮，请检查：

*   IB 连接正确连接
*   方法存在于适当的位置
*   为用户交互启用按钮

尽量避免在 viewDidLoad 方法中进行任何视图修改，因为视图还没有准备好......相反，尝试在 viewDidAppear 方法中设置按钮中心。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-30T22:47:31.450

可能。手势识别器可能正在处理按钮移动到的位置中的事件，或者可能有另一个视图在新位置阻塞了按钮，您需要将按钮放在前面。此外，如果您希望事件触发它，则应将其放入 viewDidAppear 或 IBAction 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T22:48:59.810

确保您的 planBusinessButton.frame 不在其 super.frame 之外。eg:如果按钮的框架是这样的(0,-200,100,200)，当按钮添加到它的超级视图时它不会处理点击事件。

# jquery - 在 pushState 后按下返回时如何重新加载页面？

> ID：11730746
> 
> 赞同：8
> 
> 时间：2012-07-30T22:38:37.843
> 
> 标签：jquery, ajax, pushstate

我目前使用 Code Igniter 来获得漂亮的 URL，并且我有这个系统，它基本上使用 ajax 来让你搜索健身房。

我在加载健身房列表后使用推送状态，如下所示：

example.com/list/search_key/pagination-page/sort-by/filters~seperated~by~that

其中 search_key 是他们想要搜索健身房的地区的城市、州或社区，过滤器是单独的复选框。

会发生什么，我使用 .ajax 通过 post 发送搜索键和每个单独的复选框值（1 或 0），然后代码点火器使用 POST 数据和 PHP，生成一个像上面这样的 url。ajax 成功推送将 URL 声明为 PHP 生成的 URL。

问题是，如果您使用说分页转到第 2 页，并且您想转到第 1 页，那么您自然会使用浏览器的后退按钮。问题是，它仅将 URL 地址栏支持到当前地址之前的 url，它实际上并没有更改页面内容。我需要它来使用旧的（以前的）url 重新加载页面，或者刷新，或者其他什么。

我什至可以使用 ajax 使用 URL 数据重新提交表单，但我不知道如何执行此操作。

我已经尝试了一些东西，但没有任何效果。几乎我已经在谷歌的第一页上尝试了所有东西，一切看起来都很有希望，但实际上没有任何效果。

如果 pushstate url 更改为以前的 url，是否有刷新页面？

PS 以下是我尝试过的一些关键事情：

```
<script type="text/javascript">
$(window).unload(function(e){
   e.preventDefault();
   alert("Back was pressed!");
});
// If this wouldve worked, it wouldve atleast alerted me that.

// The code off this URL: http://www.mrc-productivity.com/techblog/?p=1235

// Some of the codes off this URL: http://forum.jquery.com/topic/howto-force-page-reload-refresh-of-previous-page-when-back-button-is-pressed

// A few others.
</script> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-30T22:59:42.703

由于您正在从 ajax 成功方法推送状态，因此您可以使用该`window.onpopstate`方法检测后退按钮。

请注意，仅调用 history.pushState() 或 history.replaceState() 不会触发 popstate 事件。popstate 事件仅通过执行浏览器操作来触发，例如单击后退按钮（或在 JavaScript 中调用 history.back()）。

```
var stateObj = { foo: "bar" };
history.pushState(stateObj, "page 2", "bar.html");

window.onpopstate = function(event) {
    if(event && event.state) {
        // event.state.foo
    }
} 
```

# objective-c - Clang 错误：重复符号

> ID：11730750
> 
> 赞同：0
> 
> 时间：2012-07-30T22:39:13.190
> 
> 标签：objective-c, ios, xcode, clang

编译时出现此错误

> ld：重复符号 _OBJC_METACLASS_$_ScaleTypeDisclosureSection 在 .../Build/Intermediates/A.build/Debug-iphonesimulator/A.build/Objects-normal/i386/ScaleEditorViewController-DDFF198930F36D54.o 和 .../Build/Intermediates/A。 build/Debug-iphonesimulator/A.build/Objects-normal/i386/ScaleEditorViewController-DDFF198930F36D54.o 用于架构 i386

这看起来很奇怪，因为链接器似乎正在尝试将文件与其自身链接。我已经搜索了我的整台计算机，并且只有 1 个 .h 和一个 .m 具有该名称的文件。我已经多次清理了我的项目。我已经尝试将 ScaleTypeDisclosureSection 类完全从我的应用程序中剥离出来，在这种情况下，它只会给我一个重复的符号错误，用于 ScaleEditorViewController 文件中的不同对象！我也检查了双重进口。我迷路了！

澄清一下，ScaleEditorViewController.h 和 ScaleEditorViewController.m 文件中定义了一些类。一个是视图控制器，其他的是小助手类。即使我把除主要课程之外的所有课程都拿出来，我仍然会出错。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:08:06.727

此问题现已修复。我不确定为什么。我认为这可能与我导入文件（到 Xcode）并将它们的目标设置为我的测试目标而不是我的主要目标有关。删除所有文件引用，然后将所有文件拖回我的项目解决了这个问题。

# spring-security - 将 securityContext 保存到 SecurityContextRepository 时出现异常

> ID：11730758
> 
> 赞同：1
> 
> 时间：2012-07-30T22:39:55.610
> 
> 标签：spring-security, jersey, security

开始使用 Spring Security 保护我的一些 resful 服务器资源。我的客户对请求使用 ajax (jquery ajax)，我首先实现了登录功能。

我的 Jersey web 图层包括以下内容：

```
@Path("/login")
@Component
public class LoginResourceProvider extends ServiceResourceProvider {

    /*--- Static ---*/

    private final static ILogger logger = LogManager.getLogger(LoginResourceProvider.class);

    /*--- Members ---*/

    @Inject
    @Qualifier("authenticationManager")
    protected AuthenticationManager authenticationManager;

    @Inject
    protected SecurityContextRepository repository;

    @Inject
    protected RememberMeServices rememberMeServices;

    /*--- Constructors ---*/

    public LoginResourceProvider() {
    super("Login");
    }

    /*--- Public Methods ---*/

    @GET
    public void login() {
    }

    /**
     * A user login attempt
     * 
     * @param username
     *            The user name
     * @param password
     *            The password of the given user name
     * @param request
     * @param response
     * @return A JSON string, indicating if the login is successful
     */
    @POST
    @Produces(MediaType.APPLICATION_JSON)
    public String performLogin(@QueryParam("j_username") String username, @QueryParam("j_password") String password,
        @Context HttpServletRequest request, @Context HttpServletResponse response) {

    // Create a token
    UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(username, password);
    SecurityContext securityContext = SecurityContextHolder.getContext();

    try {
        // Attempting to authenticate the user
        Authentication auth = authenticationManager.authenticate(token);

        // Updating the SecurityContext, which represents the user's
        // secured, authenticated session
        securityContext.setAuthentication(auth);

        // If the user authenticates successfully then the authentication
        // storing the security context in the HttpSession between requests
        repository.saveContext(securityContext, request, response);

        // object is passed to the remember-me service
        rememberMeServices.loginSuccess(request, response, auth);

        // Successfully authenticated
        return "{\"status\": true}";

        // Bad Credentials
    } catch (BadCredentialsException ex) {
        return "{\"status\": false, \"error\": \"Bad Credentials\"}";
    }
    }
} 
```

我的 security-context.xml 现在非常基础，足以测试我的登录过程：

```
<http use-expressions="true">
    <form-login />
    <remember-me />
    <intercept-url pattern="/**" access="permitAll" />
    <intercept-url pattern="/secured/**" access="isAuthenticated()" />
</http>

<authentication-manager alias="authenticationManager">
    <authentication-provider>
        <user-service>
            <user name="bob" password="bobspassword" authorities="ROLE_USER" />
        </user-service>
    </authentication-provider>
</authentication-manager> 
```

我有两个问题：

1.  这是一个好习惯吗？我的意思是，我在那里找不到很多用于 ajax 样式请求的“非自动”登录。

2.  尝试将安全上下文保存到 SecurityContextRepository 时出现异常，在这一行中：

    repository.saveContext(securityContext, request, response);

当我尝试使用 bob 作为用户名和 bobspassword 密码登录时，身份验证进行得很顺利，但是在调试此特定行时，我跳到 ClassCastException 并显示以下消息：

```
$Proxy31 cannot be cast to org.springframework.security.web.context.SaveContextOnUpdateOrErrorResponseWrapper 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T08:46:07.603

好的，我想我明白了。

根据[Spring 文档](http://www.scribd.com/doc/37188125/Spring-Security)，身份验证是使用以下步骤完成的：

1.  获取用户名和密码并组合成一个 UsernamePasswordAuthenticationToken 的实例（Authentication 接口的一个实例，我们之前看到过）。
2.  令牌被传递给 AuthenticationManager 的一个实例进行验证。
3.  AuthenticationManager 在身份验证成功时返回一个完全填充的身份验证实例。
4.  安全上下文是通过调用 SecurityContextHolder.getContext().setAuthentication(...) 建立的，传入返回的身份验证对象。

除了上述步骤之外，我还尝试通过将 SecurityContext 保存到 SecurityContextRepository 来将其存储在请求之间。在请求之间存储 SecurityContext 的责任应该落到 SecurityContextPersistenceFilter 身上，它又会调用这个操作，所以我不需要手动去做，我想我应该只坚持上面的 4 个步骤。

更新：我想我尝试自己实现 Spring-Security 已经为我实现的东西。我不建议采用这种方法，Spring-Security 提供了一种更简单的做法。

# c++ - 纹理 Opengl 地形？

> ID：11730759
> 
> 赞同：3
> 
> 时间：2012-07-30T22:40:03.967
> 
> 标签：c++, opengl, textures, terrain

在 OpenGL 中对由四边形制作的地形进行纹理处理的最佳方法是什么？我想要为我的地形拥有大约 30 种不同的纹理（每种地形类型 1 种纹理，因此有 30 种地形类型），并且希望在任意两个地形之间进行平滑过渡。

我在网上做了一些浏览，发现有很多不同的方法，包括 3d 纹理、Alpha 通道、混合和使用着色器。但是，其中哪一个是最有效的并且可以处理我想要使用的纹理数量？例如：[这个流行的答案](https://stackoverflow.com/questions/1110844/multiple-texture-images-blended-together-onto-3d-ground)描述了如何使用一些技术，但由于混合图只有 4 个属性（RGBA），所以只能支持 4 个纹理。

我还应该注意，我对着色器一无所知，因此不需要着色器的技术会更好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T02:38:28.473

由于您链接到描述[纹理飞溅](http://en.wikipedia.org/wiki/Texture%5Fsplatting)的答案，并且它的问题提到了游戏 Oblivion，因此我可以提供一些额外的见解。

使用 RGBA 混合贴图的基本纹理喷溅仅支持每个地形四边形四个纹理，但您可以为不同的四边形使用不同的纹理集。Oblivion 将其地形划分为每边 32 个网格点（192 英尺）的正方形（称为“单元”），每个单元定义自己的一组四个地形纹理。所以你不能在一个小区域内有很多纹理多样性，但你可以很容易地在更大的区域内改变你的纹理。如果您愿意，可以为较小的区域（甚至是单个四边形）定义纹理集，但会占用更多内存。

如果你真的需要一个四边形中超过四个纹理，你可以使用多个混合贴图。对于每增加一个，您只需进行另一次纹理查找以获得另外四个混合因子，并在前一个混合图的结果之上再混合四个纹理。您可以根据需要扩展到任意数量的纹理，但同样会以内存为代价。

纹理喷溅可能很难与高度图上的[LOD](https://en.wikipedia.org/wiki/Level_of_detail)技术结合使用，因为当单个低细节地形四边形代表一组高细节四边形时，您必须为大四边形的不同区域采样几个不同的混合贴图。Oblivion 通过仅对全细节地形使用纹理飞溅来回避该问题；以较低分辨率渲染的远距离单元使用编辑器生成的预先计算的纹理，它会提前进行喷溅和缩小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T02:58:45.133

纹理喷溅的一种替代方法是使用剪[贴图](http://www.cs.virginia.edu/~gfx/Courses/2002/BigData/papers/Texturing/Clipmap.pdf)来渲染“[巨型纹理](https://en.wikipedia.org/wiki/MegaTexture)”。使用这种方法，您将拥有一个代表整个地形的大型纹理，并且您可以通过加载它的不同部分来避免填满 RAM，而只需根据查看者的当前位置渲染它实际需要的细节。（无法完整查看地形的远处部分，因此无需完整加载它们。）

这种方法的优点是它的艺术自由度：您可以在纹理中的任何位置放置精细的细节，而无需考虑顶点网格。缺点是实现起来相当复杂，整个clipmap必须存储在*某个地方*，可能是磁盘上的一个大文件，以便您可以根据需要将其中的一部分加载到RAM中。

# android - 以编程方式创建视频列表

> ID：11730762
> 
> 赞同：0
> 
> 时间：2012-07-30T22:40:23.120
> 
> 标签：android, vimeo

我正在尝试创建用户可以查看的视频列表。这需要是动态的，因为列表将根据添加到我从中提取视频的数据库中的新条目进行更新。

对于我的项目，我通过 vimeo 的简单 API 访问视频列表。我用来显示所有信息的当前方法是通过从 StringBuilder 对象 htmlString 获取其信息的 webview 对象。

我的视图 XML 如下：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<WebView
    android:id="@+id/videoMenu"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true" />

</RelativeLayout> 
```

我用来动态构建列表的代码片段如下。它返回到一个函数“onPostExecute(String result)”，该函数显示带有从 for 循环创建的 html 的 webview。

```
 for (VideoDataParser.Entry video : videos)
    {
        htmlString.append("<p>");
        htmlString.append("<a href=\"" + video.url + "\">");
        htmlString.append("<img align=\"left\" src=\"" + video.thumbnail_url + "\">");
        htmlString.append(video.title + "<br>");
        htmlString.append(video.description);
        htmlString.append("</p>");

    }
    return htmlString.toString(); 
```

我现在遇到的主要问题是图像没有加载。我想那是因为它需要另一个 HTTP 请求来获取图像。还有其他方法可以解决这个问题吗？

另外，我觉得这种创建菜单的方法可能不是最好的。当用户单击链接时，控制流会超出我的活动，并转到将播放视频的 Web 浏览器。我希望活动转到我自己的视频播放器，而不是在单击我的选项之一时使用互联网。很可能有更好的方法来做到这一点，但我不确定。

任何输入都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:54:50.403

如果您使用 WebView 创建播放列表，那么我建议您在 WebView 中使用 JavaScript 接口，以便您可以在活动和 WebView 之间发送信息，因此当用户单击缩略图时，您可以向活动发送“id”用户点击的缩略图。

尖端：

**要添加界面，您可以这样做**

```
WebView web = new WebView();
web.addJavascriptInterface(new classWhereTheMethodsAre(), "nameOfTheInterface"); 
```

**从 HTML 内部调用方法**

```
nameOfTheInterface.nameOfTheMethod(Parameters); 
```

我希望这些提示可以帮助您，如果您还有其他问题，请在此处发布，我会尝试解决它或者给您一个片段。

**更新：**

如果您的图像来自“互联网”（HTTP 或类似的东西），那么您可以像往常一样将 URL 放入 HTML 代码中，或者您可以将它们下载到 SD 卡（使用您的 asynctask 类）然后让一个听众在图像完全下载时通知您，以便您可以[“延迟加载”](http://calendar.perfplanet.com/2010/html-lazy-load/)将图像“插入”到 HTML 页面的代码部分。可以使用链接中提供的代码来实现延迟加载，并调用它，您可以执行`YourWebView.loadUrl("javascript:functionThatCallsTheLazyLoad(Parameters)")`

我希望此更新可以帮助您解决问题。

# qt - 如何操作指向 TableView 模型的指针？

> ID：11730764
> 
> 赞同：0
> 
> 时间：2012-07-30T22:40:28.210
> 
> 标签：qt, qtableview, qabstractitemmodel, qstandarditemmodel

当需要操作 TableView 的模型时，有必要使用 function 获取该模型`tableView->model()`。但是，这会返回一个指向 a 的指针`QAbstractItem`，并且它是指向 a 的必要指针`QAbstractModel`。

所以...我使用动态转换进行转换，如下所示：

```
QStandardItemModel* model = dynamic_cast <QStandardItemModel*>
                                   (mWidgets->tableView->model()); 
```

但是，这个指针返回 NULL，我不知道为什么。

是否需要一些初始化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T17:27:48.230

`QTableView::model()`返回你给它的任何模型`QTableView::setModel()`，在你给它一个之前它没有一个。

# javascript - 隐藏 Div 的父级

> ID：11730765
> 
> 赞同：3
> 
> 时间：2012-07-30T22:40:30.027
> 
> 标签：javascript, parent

我只是想隐藏父 div `comments_section`。

```
<div class="content content_green">
    <div id="comments_section"></div>
</div> 
```

我试过这个：

```
document.getElementById("comments_section").parentNode.style.display = "none" 
```

这有效，但在 IE 9 中给了我这个错误：

> 无法获取属性“parentNode”的值：对象为空或未定义。

我对 JavaScript 很陌生，所以我不确定如何修复这个错误，或者它是否是正确的方法。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:42:35.843

您没有关闭子 div。IE 很容易出错，并且会屈服于你。

```
<div class="content content_green">
       <div id="comments_section"></div>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T22:43:09.710

好吧，你标记了这个 jQuery，所以我将提供“jQuery 方式”：

```
jQuery('#comments_section').parent().hide(); 
```

编辑：@bobek 首先给出了您的问题发生的原因。他是对的。我应该注意，使用 jQuery，您仍然会遇到问题但没有错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T22:43:48.453

为此使用 jQuery：

```
$("#comments_section").parent().hide() 
```

或者，您可以以正确的方式执行此操作：

```
$("div.content.content_green").hide() 
```

目前您不使用 jquery。访问[jQuery 文档](http://docs.jquery.com/Main_Page)

# ruby-on-rails - 在 rails 中添加新对象的位置 - 它们应该放在模型文件夹中吗？

> ID：11730769
> 
> 赞同：1
> 
> 时间：2012-07-30T22:41:44.513
> 
> 标签：ruby-on-rails, oop, controller

我来自 Java 背景，并且非常习惯于将代码包装到对象中。

我正在开发我的第一个 Rails 应用程序；在编写控制器时，我想包装一段代码，以适应来自视图的输入并将其修改为后端接受的格式。

我不确定将这些对象放在哪里。我创建的这个“适配器”对象应该进入模型吗？（我试着把它放在那里，但我无法使用“require”找到对文件的引用。）

谢谢！

**编辑**

例如，假设我的输入是字符串格式的日期：“31st July”-> 我的控制器将是：

```
def create
  adaptor = Adaptor.new
  date = adaptor.to_date(params[:date])
  ...
end 
```

适配器在哪里？如果这个对象是“通用”代码，我的模型可以使用它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:49:20.860

这可能是一个辅助对象，然后应该进入辅助文件夹。这也可能是模型的一部分。您应该阅读一些关于“**胖模型，瘦控制器**”策略的内容。

一个快速的谷歌提出了这些：

[devinterface.com](http://blog.devinterface.com/2010/06/rails-best-practices-1-fat-model-skinny-controller/)

[goodcoresoft.com](http://blog.goodcoresoft.com/rails-best-practice-fat-model-skinny-controller/)

# matlab - 如何从 4D matlab 矩阵中删除元素

> ID：11730773
> 
> 赞同：0
> 
> 时间：2012-07-30T22:41:56.090
> 
> 标签：matlab, matrix

嗨，我有以下 4D 矩阵

```
for idx_number_panels = 1:length(number_panels) % range of PV panel units examined

for number_turbines = 0:2 % range of wind turbine units examined

    for number_batteries = 1:10 % range of battery units examined

        for h=2:25 %# hours

            for d = 1:number_of_days %# which day

                n = h + 24*(d-1);
                % hourly_deficit_1(...,..., h, d)= Demand(n)-(PV_supply(n)... %

                hourly_total_RES(idx_number_panels,number_turbines + 1,number_batteries, h,d) 
```

我想从上面的 4D 矩阵中每 24 行删除整行，从而调整矩阵的大小。这是否可能以及如何完成，因为文档似乎没有帮助

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:13:06.320

1.  制作要保留的所有行索引的向量
2.  仅索引那些 hourly_total_RES 行并分配回 hourly_total_RES。

    垃圾idx = 1:24:idx_number_panels；

    keepidx = setdiff（1：idx_number_panels，trashidx）；

    hourly_total_RES = hourly_total_RES(keepidx,:,:,:);

而且我不知道为什么上面没有格式化为代码....

# arrays - Postgres不在数组中

> ID：11730777
> 
> 赞同：125
> 
> 时间：2012-07-30T22:42:10.627
> 
> 标签：arrays, postgresql

我正在使用 Postgres 的本机数组类型，并尝试查找 ID 不在数组收件人 ID 中的记录。

我可以找到他们在哪里：

```
SELECT COUNT(*) FROM messages WHERE (3 = ANY (recipient_ids)) 
```

但这不起作用：

```
SELECT COUNT(*) FROM messages WHERE (3 != ANY (recipient_ids))
SELECT COUNT(*) FROM messages WHERE (3  = NOT ANY (recipient_ids)) 
```

测试这种情况的正确方法是什么？

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2012-07-30T22:44:14.540

```
SELECT COUNT(*) FROM "messages" WHERE NOT (3 = ANY (recipient_ids)) 
```

你总是可以`WHERE (condition)`否定`WHERE NOT (condition)`

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-07-30T22:51:32.803

你可以把它转过来说“3 不等于所有的 ID”：

```
where 3 != all (recipient_ids) 
```

来自[精美手册](http://www.postgresql.org/docs/current/interactive/functions-comparisons.html#AEN17438)：

> **9.21.4。全部（数组）**
> 
> ```
> expression operator ALL (array expression) 
> ```
> 
> 右边是一个带括号的表达式，它必须产生一个数组值。***使用给定的operator***计算左侧表达式并与数组的每个元素进行比较，这必须产生一个布尔结果。`ALL`如果所有比较结果为真（包括数组元素为零的情况），则结果为“真”。如果发现任何错误结果，则结果为“错误”。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2018-05-03T15:14:05.567

### 增加`ALL/ANY`答案

我更喜欢所有使用`all`或`any`实现结果的解决方案，欣赏附加说明（例如关于**NULL** s）。作为另一种扩展，这里有一种考虑这些运算符的方法。

您可以将它们视为*短路运算符*：

*   `all(array)`遍历数组中的所有值，使用提供的运算符将每个值与参考值进行比较。一旦比较产生`false`，该过程以假结束，否则为真。（类似于短路逻辑`and`。）
*   `any(array)`遍历数组中的所有值，使用提供的运算符将每个值与参考值进行比较。一旦比较产生`true`，该过程以真结束，否则以假结束。（类似于短路逻辑`or`。）

这就是为什么`3 <> any('{1,2,3}')`不产生预期结果的原因：该过程将 3 与 1 进行比较以判断不等式，结果为真，并立即返回真。数组中不同于 3 的单个值足以使整个条件为真。最后一个数组位置的 3 是概率。没用过。

`3 <> all('{1,2,3}')`另一方面，确保*所有*值不等于 3。它将运行所有产生 true 的比较，直到产生 false 的元素（在本例中为最后一个），以返回 false 作为整体结果。这就是OP想要的。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2018-03-01T02:21:50.887

## 谨防空值

两者`ALL`：

```
(some_value != ALL(some_array)) 
```

并且`ANY`：

```
NOT (some_value = ANY(some_array)) 
```

只要`some_array`不为空就可以工作。如果数组可能为空，那么您必须使用 coalesce() 来处理它，例如

```
(some_value != ALL(coalesce(some_array, array[]::int[]))) 
```

或者

```
NOT (some_value = ANY(coalesce(some_array, array[]::int[]))) 
```

从[文档](https://www.postgresql.org/docs/current/static/functions-comparisons.html#id-1.5.8.28.16)：

> 如果数组表达式产生一个空数组，则 ANY 的结果将为空
> 
> 如果数组表达式产生一个空数组，则 ALL 的结果将为空

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2017-04-12T22:13:38.250

更新：

从 postgres 9.3 开始，

您也可以`NOT`与`@>` [(contains operator)](https://www.postgresql.org/docs/9.3/static/functions-range.html)一起使用来实现这一点。

IE。

`SELECT COUNT(*) FROM "messages" WHERE NOT recipient_ids @> ARRAY[3];`

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-07-30T22:44:50.827

`not (3 = any(recipient_ids))`?

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-06-20T14:56:23.037

请注意，ANY/ALL 运算符不适用于数组索引。如果考虑索引：

```
SELECT COUNT(*) FROM "messages" WHERE 3 && recipient_ids 
```

和否定：

```
SELECT COUNT(*) FROM "messages" WHERE NOT (3 && recipient_ids) 
```

然后可以像这样创建索引：

```
CREATE INDEX recipient_ids_idx on tableName USING GIN(recipient_ids) 
```

# javascript - 在 wordpress 中向自定义 php 模板添加滑块的问题

> ID：11730782
> 
> 赞同：1
> 
> 时间：2012-07-30T22:42:52.160
> 
> 标签：javascript, jquery, html, css

尝试使用 php 模板将滑块添加到简单的自定义登录页面。这是我正在使用的代码：

```
 <?php
        /* Template Name: Custom Home Page */
        get_header();
    ?>

<?php get_header(); ?>
<div id="main_wrapper">  
        <div id="featured_area"> 
<div id="feature_slider">  
        <ul>  
        <li><a href="#"><img src="<?php bloginfo('template_directory'); ?>/images/slider-1.jpg" alt="First Slide" /></a></li>  
        <li><a href="#"><img src="<?php bloginfo('template_directory'); ?>/images/slider-2.jpg" alt="Second Slide" /></a></li>  
        <li><a href="#"><img src="<?php bloginfo('template_directory'); ?>/images/slider-3.jpg" alt="Third Slide" /></a></li>  
        <li><a href="#"><img src="<?php bloginfo('template_directory'); ?>/images/slider-4.jpg" alt="Fourth Slide" /></a></li>  
        </ul>  
    </div>  

        </div>  
        <div id="column_wrapper">  
            <div class="column">  
  <?php if (function_exists('dynamic_sidebar') && dynamic_sidebar('left_column')) : else : ?>  
        <p><strong>Widget Ready</strong></p>  
        <p>This left_column is widget ready! Add one in the admin panel.</p>  
    <?php endif; ?>     
            </div>  
            <div class="column">  
     <?php if (function_exists('dynamic_sidebar') && dynamic_sidebar('center_column')) : else : ?>  
        <p><strong>Widget Ready</strong></p>  
        <p>This center_column is widget ready! Add one in the admin panel.</p>  
    <?php endif; ?>     
            </div>  
            <div class="column">  
   <?php if (function_exists('dynamic_sidebar') && dynamic_sidebar('right_column')) : else : ?>  
        <p><strong>Widget Ready</strong></p>  
        <p>This right_column is widget ready! Add one in the admin panel.</p>  
    <?php endif; ?>       
            </div>  
        </div>  
    </div>  
<?php get_footer(); ?> 
```

滑块正在滑动，仅显示 alt 标签...您自己看看：http://onlinebettingguide.org/custom/ 您能给我的任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:48:47.667

滑块有效，代码有效，但图像不存在。

[http://onlinebettingguide.org/wp-content/themes/sportedge-parent/images/slider-1.jpg](http://onlinebettingguide.org/wp-content/themes/sportedge-parent/images/slider-1.jpg)等返回 404 错误。

服务器上的图像在数字前有一个空格，而不是连字符。这将解决你：

```
 <li><a href="#"><img src="<?php bloginfo('template_directory'); ?>/images/slider 1.jpg" alt="First Slide" /></a></li>  
    <li><a href="#"><img src="<?php bloginfo('template_directory'); ?>/images/slider 2.jpg" alt="Second Slide" /></a></li>  
    <li><a href="#"><img src="<?php bloginfo('template_directory'); ?>/images/slider 3.jpg" alt="Third Slide" /></a></li>  
    <li><a href="#"><img src="<?php bloginfo('template_directory'); ?>/images/slider 4.jpg" alt="Fourth Slide" /></a></li> 
```

# maven - 为什么以及何时创建多模块 Maven 项目？

> ID：11730791
> 
> 赞同：14
> 
> 时间：2012-07-30T22:44:46.990
> 
> 标签：maven, project-organization, multi-module

我有一个关于 Maven 的多模块项目的一般性问题。何时何地去争取它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T07:37:10.957

@Esko Luontola 的答案

> 将项目拆分为多个模块很有用，例如，如果需要单独部署模块，..

可能会被误解。如果您有将单独部署的模块，则恰恰相反。在这种情况下，您永远不应该创建多模块构建。这应该通过简单的独立 Maven 项目来完成。

多模块构建的想法是，如果您有像 ear 项目一样属于一起的模块，该项目通常由客户端、服务器、ejb、war 等几个其他模块组成。这通常通过多模块构建来处理，这意味着所有模块具有相同的版本号，但可以由其他模块单独访问和使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-01T06:27:50.003

这个问题似乎更多地是关于软件的。Maven 只是其中一种方式。

[我将引用Jez Humble 的“持续交付”中](http://martinfowler.com/snips/201006021426.html)的几行

> 什么是组件？这是软件中一个可怕的超载术语，因此我们将尝试尽可能清楚地说明我们的意思。当我们谈论组件时，我们指的是应用程序中相当大规模的代码结构，具有定义良好的 API，可能会被替换为另一个实现。基于组件的软件系统的区别在于代码库被分成离散的部分，这些部分通过与其他组件的定义良好、有限的交互来提供行为。基于组件的系统的对立面是一个单体系统，在负责不同任务的元素之间没有明确的边界或关注点分离。单片系统通常具有较差的封装性，
> 
> ...
> 
> 采用基于组件的设计通常被描述为鼓励重用和良好的架构属性，例如松散耦合。这是事实，但它还有另一个重要的好处：它是大型开发团队协作的最有效方式之一。
> 
> ...
> 
> 许多项目都可以使用单个版本控制存储库和简单的部署管道。然而，许多项目已经演变成无法维护的代码泥潭，因为没有人决定在成本低廉的情况下创建离散组件。小项目变成大项目的点是流动的，会偷偷摸摸地找你。
> 
> ...
> 
> 最后，值得注意的是康威定律，它指出“设计系统的组织. . . 受限于生产复制这些组织的通信结构的设计。”4 因此，例如，开发人员仅通过电子邮件进行通信的开源项目往往是非常模块化的，接口很少。由一个小型的、位于同一地点的团队开发的产品往往是紧密耦合的，而不是模块化的。小心你如何建立你的开发团队——它会影响你的应用程序的架构。

我发现这最后的陈述是如此清晰和准确，令人惊讶。我强烈推荐那本书！:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T23:05:40.097

将项目拆分为多个模块很有用，例如，如果模块需要单独部署，或者在库的情况下，项目的某些使用者只需要类的子集，或者库的开发人员想要明确区分在什么是公共 API 和什么是私有实现之间。对于大型项目，它可能会使代码更容易保持有序，即使代码在技术上可能都在同一个模块中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-31T18:57:35.020

还有一些我会推荐使用多模块 maven 项目的用例：

1.  您的模块共享相同的依赖项，在这种情况下，您将在主 pom 中指定所有依赖项，并且所有模块都可以享受它。（无需为每个模块指定相同的依赖项。）

2.  如果您需要同时对多个项目执行操作。（我个人使用它），我从我的所有项目中创建一个包，并将其发送给客户，因此我使用主 pom 构建它们，并使用其他 maven 插件将它们打包为 zip 文件。

# excel - 需要帮助创建公式来检查单元格的值，然后从单独的工作表中复制正确的值

> ID：11730797
> 
> 赞同：1
> 
> 时间：2012-07-30T22:45:33.280
> 
> 标签：excel, excel-formula

我正在尝试创建一个公式来检查单元格中的值是否具有正确或不正确的字符串。如果单元格中`incorrect`的值是另一个工作表中的值，则应将其复制到当前工作表中。下面是一个示例工作表。

工作表 1

```
Col A Col B Col C Col D
-------------------------------------------
A 1 正确
B 2 正确
C 1 不正确

```

工作表 2

```
Col A Col B Col C
----------------------
 A 1 正确
 B 2 正确
 C 3 正确

```

使用 D 列第一行和第二行上方的示例工作表应该为空，因为 C 列中的相应单元格具有正确的值，但在 D 列的第三行中，应将 B 列工作表 2 中的值 3 复制到单元格中因为 C 列的第三行的值不正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T02:47:22.380

我假设正在测试工作表 1 第 2 列中的数据，因为它是手动输入的。否则，一个公式每次都可以提供正确的答案。

因为没有太多细节，我把它看成是某种类型的测试表，测试在工作表 1 上，答案在工作表 2 上。

我在 C 列和 D 列中都使用了 VLOOKUP。在 C 列中，我使用的公式是：

```
=IF(VLOOKUP(Sheet1!$A2,Sheet2!$A$1:$B$3,2,FALSE)=$B2,"Correct","Incorrect") 
```

这会在 C 列中为您提供正确或不正确的值。如果需要，我们可以再次使用相同的 VLOOKUP 在 D 列中返回正确答案。

```
=IF($C2="Incorrect",VLOOKUP(Sheet1!$A2,Sheet2!$A$1:$B$3,2,FALSE),"") 
```

执行一次 vlookup 会更有效，将该值保存在不同的列中，然后指向 C 或 D 列中的该列。然后，您可以隐藏该列并锁定工作表以隐藏该值，如果那是忧虑。但是，我使用了您的示例输出而没有附加列。

我附上了工作示例的屏幕截图。希望这是正确的轨道 - 如果不发表评论，我们可以解决。

![工作示例的屏幕截图](../Images/137abc6dbd509f0cec6f5bfa21852281.png)

# php - 是否可以在同一页面上使用两个 Facebook 应用程序，或者将它们合并为一个？

> ID：11730801
> 
> 赞同：1
> 
> 时间：2012-07-30T22:46:23.243
> 
> 标签：php, javascript, facebook, facebook-opengraph

**更新：通过从第一个应用程序导出 facebook 评论并将它们作为 wordpress 评论导入来修复，遗憾的是还无法将它们导入新的 facebook 评论。**

曾几何时，我们公司做出了一个糟糕的决定，即使用一个 Facebook 应用程序作为我们博客上的评论插件，并使用一个单独的应用程序来处理向 OpenGraph 发布的内容。现在我们正在尝试设置我们的博客以在人们阅读我们的内容并遇到我们不能在同一页面上使用两个不同的 Facebook 应用程序的问题时发布“阅读”操作。所以我的问题是双重的：

1.  有没有办法合并我们的两个应用程序，这样我们就不必丢失博客上的所有评论来使用 OpenGraph，或者丢​​失我们记录的 OpenGraph 操作并保留我们的评论。

2.  有什么方法我还没有找到连接到同一页面上的两个单独的 Facebook 应用程序

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:53:33.743

您总是可以将一个合并到另一个中，但是您可能必须重新构建一些东西，以使一个功能与另一个在另一个当前正在做的事情之上一起工作。您可以构建第 3 个应用程序，它是 2 的一个端口，因此您可以让前 2 个运行，而您在第 3 次重建时启动第 3 个，并在准备好时关闭其他 2 个。

但是，将一个与另一个连接起来是不可能的，就好像内存服务于 facebook 应用程序是沙盒的，并且无法通过 facebook 与另一个通信。他们可以使用相同的服务器、相同的数据库等，并且可以从他们所在服务器的服务器级别在后端相互操作。

但归根结底，它归结为你在做什么，它们目前的工作方式以及所有其他方面。没有简单的答案，没有什么比将一组文件放在另一组文件上并希望它有效的了。

您要么坚持他们的现状，要么在某种程度上重建以不幸地将它们聚集在一起

# memory-management - 将托管数据转换并保留在内存中一段时间

> ID：11730803
> 
> 赞同：0
> 
> 时间：2012-07-30T22:46:43.127
> 
> 标签：memory-management, c++-cli, managed, unmanaged-memory

我正在围绕 C++ 项目编写 C++/cli 包装器，以便可以从 C# 调用它。C#端调用一个cli方法[say Put(String^ key, String^ value)]数百万次传递一大组key/value托管数据，然后再调用[say Commit()]询问C++对象对数据做一些事情。我需要能够将所有数据保留在内存中，直到最后一次调用 - 所以我使用 std::vector 并尝试将所有托管字符串转换为非托管 std::string 并将它们保存在我的 cli 中的向量中代码。

我的问题是——在这种情况下转换托管数据的最佳方法是什么？固定托管数据以保持非托管指针有效似乎是个坏主意，因为数据不会立即使用（如果固定在函数调用后立即超出范围，这也将不起作用 - 这会导致访问失效）。另一种选择是通过 malloc 分配一个“足够大”的缓冲区并继续向其中添加数据——如果这样更好，那么：(1) 是 pin-ptr 后跟一个 memcpy （一旦 Put 方法，固定将超出范围返回）转换/复制单个 String^ 数据的最佳方式？（2）由于我不知道maloc的总大小，从初始malloc扩展内存的最佳方法是什么？对于这种情况，我将不胜感激任何指向一个好的设计解决方案的指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:20:58.717

如果您需要在使用之前将数据排队，我可能会使用托管容器来做到这一点。您将两个字符串称为“键”和“值”，键是唯一的吗？如果是这样，请使用托管的`Dictionary<String^, String^>`. 如果不是，请使用 a `List<KeyValuePair<String^, String^>>`，并在调用 Commit() 时将所有转换为非托管字符串。

当调用 Commit() 时，您可以执行一个大 malloc 来保存所有单独的字符串，或者您可以使用许多单独的 malloc（或其他分配方法）单独转换每个字符串。只要您在所有情况下都正确释放内存，任何一个都应该可以正常工作。

# groovy - 无法弄清楚这个时髦的闭包是如何工作的

> ID：11730805
> 
> 赞同：0
> 
> 时间：2012-07-30T22:46:50.670
> 
> 标签：groovy

我是 groovy 的新手，正在阅读一个测试用例，我发现以下内容：

```
def temp = {
        def temp = new HashMap()
        temp.clear()
        temp.set('A', '1')
        temp.set('B', '2')
        temp
    } 
```

我想知道 temp 变量在定义结束时将保持什么值，因为它在测试用例中使用

```
assert Blah.blah(temp()) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:58:51.893

它应该类似于地图`[ A:1, B:2 ]`。

您的断言行调用`temp()`返回该映射，然后将其传递给`Blah.blah`方法

您可以将整个闭包重写为：

```
def temp = { -> [ A:1, B:2 ] as HashMap } 
```

如果 LinkedHashMap 可以，您甚至可以省略这`as HashMap`一点

# opencv - 人脸识别——局部二值模式直方图比较

> ID：11730806
> 
> 赞同：1
> 
> 时间：2012-07-30T22:46:59.390
> 
> 标签：opencv, computer-vision, histogram, face-recognition

我有两个图像，我将它们转换为灰度并找出它们的本地二进制模式。我如何比较直方图以查看它们是否匹配？公式是什么？（还有什么是卡方？ - 在研究时遇到它）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T15:24:57.750

关于卡方：[维基百科页面](http://en.wikipedia.org/wiki/Chi-squared_distribution)非常好，非常彻底。

您将使用“拟合优度的[卡方检验”来比较分布。](http://en.wikipedia.org/wiki/Chi-squared_test)直方图是“颜色分布”，因此此测试适用于您的问题。

您要用于两个分布的一个是[Pearson's chi-squared test](http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test)。

# javascript - 将 JSON 字符串解析为 HTML5 代码的更快方法

> ID：11730809
> 
> 赞同：1
> 
> 时间：2012-07-30T22:47:23.320
> 
> 标签：javascript, jquery, json, html

首先，这段代码确实有效，当它处理一些项目时，它的工作速度非常快。但是，当它解析的 JSON 有 50 多个项目时，在手机上进行测试时可能会占用大量资源。

任何人都可以建议我可以在 JAVAScript 或 JQUERY 世界中看到的特性或功能吗？

理想情况下，我认为如果我不能加快速度，我希望能够 a）在检索时拆分 JSON，并能够有一个“更多”按钮来加载接下来的 25 个条目，或者...... b）仅在需要在屏幕上显示时才解析每个条目。

我很感激你的想法。

TIA

编辑只是添加我可以做这个服务器端（资源有限）或限制条目（再次服务器端）我试图下载以供离线使用手机（或浏览器）上的数据和处理....

```
function showResultjsonp() {
    var retrieveddodlocaldata = localStorage.getItem(jsonpservice);
    var json_parsed = $.parseJSON(retrieveddodlocaldata);

    for (var d = 0; d < json_parsed.svccurrentaiot_jsonp.length; d++) {
        var parseddata = json_parsed.svccurrentaiot_jsonp[d];

        $('#eventlist')
            .append($('<div data-role="collapsible" data-collapsed="true">')
            .html('<h3><img alt="' + parseddata.dataitem.1 + '" src="images/icons/' + parseddata.dataitem.2 + '.gif">  ' + parseddata.dataitem.2 + '</h3><p>' + parseddata.dataitem.9 + '</p>Event ' + parseddata.dataitem.4 + ' ' + unittype + '<br/>Retricted ' + parseddata.dataitem.5 + '<br/>Impact ' + parseddata.dataitem.6 + '<br/>Delay <br/>Lat / Long ' + parseddata.dataitem.7 + ' / ' + parseddata.dataitem.7 + '<br/>Valid to  ' + parseddata.dataitem.8 + '</div>'));
    }

    $('div[data-role=collapsible]').collapsible();
}; 
```

解决方案感谢此页面和[http://twitter.github.com/hogan.js/上的贡献](http://twitter.github.com/hogan.js/)

```
 function showResultjsonp() {
 var retrieveddodlocaldata = localStorage.getItem(jsonpservice);
 var json_parsed = $.parseJSON(retrieveddodlocaldata);
 var datatemplate = Hogan.compile('<div data-role="collapsible" data-collapsed="true"><h3><img alt="{{item}}" src="images/trafficicons/{{item}}.gif"></div>');
 // store for all rendered items
 var result = "";
 for (var d = 0; d < json_parsed.svccurrentaiot_jsonp.length; d++) {
    var parseddata = json_parsed.svccurrentaiot_jsonp[d];
   //result += render(parseddata);
result += datatemplate.render({"item" : parseddata.dataitem.item});
console.log(result);    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:57:13.593

jQuery 处理数量不多的 DOM 元素的成本很高。我强烈建议您使用一些将模板文本编译成 javascript 函数的模板引擎。您可以通过 twitter使用**[hogan 。](http://twitter.github.com/hogan.js/)****[它将一个mustache](http://mustache.github.com/)**模板编译成一个 javascript 函数，您可以根据需要多次重复使用该函数。

这是一个简单的例子：

```
var template = "<div><span>{{some-value-from-template}}</span> </div>"; 
```

然后你编译：

```
var templ = hogan.compile(template); 
```

然后使用它：

```
var result = templ.render({"some-value-from-template": "hello world"});
$(result).appendTo("#someElementInTheDom"); 
```

Mustache 有一个非常简单和优雅的模板符号。

小胡子： http: [//mustache.github.com/](http://mustache.github.com/)

霍根：http: [//twitter.github.com/hogan.js/](http://twitter.github.com/hogan.js/)

**编辑：**

就像 jared 和 felix 在评论中所说的那样。您必须改进其他方面才能获得您想要的性能。

```
// create template
var template = "<div>....</div>";
// compile
var templ = hogan.compile(template);
// store for all rendered items
var result = "";

for (...)
   result += templ.render(currentJsonParsedElement);
}

// and then, insert all items at once in the DOM
$("#eventlist").append(result); 
```

实际上 mustache 可以为您执行*for*循环。查看 mustache 文档了解详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:10:06.047

除了**templates**，您可能还想研究使用 a[**`DocumentFragment`**](http://ejohn.org/blog/dom-documentfragments/)来插入 HTML 节点。您可以创建一个片段，在不接触 DOM 的情况下向其中添加多个元素，然后在一次操作中将它们插入在一起，而不是将它们一个一个地放入 DOM 中（这很“昂贵”）。这个例子来自 Google 的页面[Speeding up JavaScript: Working with the DOM](https://developers.google.com/speed/articles/javascript-dom)：

```
function addAnchors(element) {
  var anchor, fragment = document.createDocumentFragment();
  for (var i = 0; i < 10; i ++) {
    anchor = document.createElement('a');
    anchor.innerHTML = 'test';
    fragment.appendChild(anchor);
  }
  element.appendChild(fragment);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T10:36:31.253

解决方案感谢此页面和[http://twitter.github.com/hogan.js/上的贡献](http://twitter.github.com/hogan.js/)

```
function showResultjsonp() {
 var retrieveddodlocaldata = localStorage.getItem(jsonpservice);
 var json_parsed = $.parseJSON(retrieveddodlocaldata);
 var datatemplate = Hogan.compile('<div data-role="collapsible" data-collapsed="true"><h3><img alt="{{item}}" src="images/trafficicons/{{item}}.gif"></div>');
 // store for all rendered items
 var result = "";
 for (var d = 0; d < json_parsed.svccurrentaiot_jsonp.length; d++) {
    var parseddata = json_parsed.svccurrentaiot_jsonp[d];
   //result += render(parseddata);
result += datatemplate.render({"item" : parseddata.dataitem.item});
console.log(result);    
} 
```

# c++ - 编译时不能包含 Sparkle 框架

> ID：11730813
> 
> 赞同：5
> 
> 时间：2012-07-30T22:47:43.370
> 
> 标签：c++, qt, gcc, g++, sparkle

我目前正在构建一个基于 Qt C++ 框架的项目，该框架利用 Sparkle 框架进行更新。我遇到的问题是我的整个应用程序构建得很好，除非我包含 Sparkle 框架。

Sparkle.framework 目录位于 /Library/Frameworks 目录中。

在我的 .pro 文件中，我有：

```
QMAKE_LFLAGS += -F /Library/Frameworks
LIBS += -framework Sparkle 
```

在我的 SparkleUpdater 类中，我有以下标题：

```
#include <Sparkle/Sparkle.h>
#include "SparkleUpdater.h" 
```

当我将鼠标悬停在 Qt Creator 中的包含上时，我会收到关于 sparkle 框架路径的通知，其中包含： /Library/Frameworks/Sparkle.framework/Headers/Sparkle.h 这是正确的位置，实际上是 Sparkle .framework 存在于我的机器上。

然而，当我构建我的项目时，我从编译器中得到以下信息：

```
SparkleUpdater.mm:2:29: error: Sparkle/Sparkle.h: No such file or directory
SparkleUpdater.mm:10: error: ISO C++ forbids declaration of 'SUUpdater' with no type
SparkleUpdater.mm:10: error: expected ';' before '*' token
SparkleUpdater.mm: In constructor 'SparkleUpdaterPrivate::SparkleUpdaterPrivate()':
SparkleUpdater.mm:9: error: class 'SparkleUpdaterPrivate' does not have any field named      'updater'
SparkleUpdater.mm: In constructor 'SparkleUpdater::SparkleUpdater(const QString&, bool)':
SparkleUpdater.mm:17: error: 'class SparkleUpdaterPrivate' has no member named 'updater'
SparkleUpdater.mm:17: error: 'SUUpdater' was not declared in this scope
SparkleUpdater.mm:18: error: 'class SparkleUpdaterPrivate' has no member named 'updater'
SparkleUpdater.mm:22: error: 'class SparkleUpdaterPrivate' has no member named 'updater'
SparkleUpdater.mm:24: error: 'class SparkleUpdaterPrivate' has no member named 'updater'
SparkleUpdater.mm: In destructor 'virtual SparkleUpdater::~SparkleUpdater()':
SparkleUpdater.mm:30: error: 'class SparkleUpdaterPrivate' has no member named 'updater'
SparkleUpdater.mm: In member function 'virtual void        SparkleUpdater::checkForUpdates(bool)':
SparkleUpdater.mm:40: error: 'class SparkleUpdaterPrivate' has no member named 'updater'
SparkleUpdater.mm:41: error: 'class SparkleUpdaterPrivate' has no member named 'updater'
SparkleUpdater.mm:45: error: 'class SparkleUpdaterPrivate' has no member named 'updater'
make[1]: *** [SparkleUpdater.o] Error 1 
```

我已经尝试在我的机器上移除和替换 Sparkle 框架。我尝试过明确地包含 Headers 文件夹：

```
INCLUDEPATH += -F /Library/Frameworks 
```

和

```
INCLUDEPATH += -F /Library/Frameworks/Sparkle.framework/Versions/A 
```

而且无济于事。我仍然从编译器得到相同的消息。

谁能帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-06-22T09:24:15.130

I recently had issues with Sparkle integration in Qt. After following some posts that didn't help, I was able to figure out what I needed to do to get things working.

So after this I decided to write a quick walk-through for getting the client side of the framework up and running. You can find my post at: [http://www.discoversdk.com/knowledge-base/using-sparkle-in-qt](http://www.discoversdk.com/knowledge-base/using-sparkle-in-qt)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T12:37:08.293

那应该这样做：

`cd /Library/Frameworks/Sparkle.framework/Headers`

`ln -s ../Headers Sparkle`

# android - 如何制作实现 Clickable 的自定义 RelativeLayout？

> ID：11730814
> 
> 赞同：1
> 
> 时间：2012-07-30T22:47:53.523
> 
> 标签：android, android-layout, android-listview

我正在关注本教程，因为它正是我所需要的：

[http://www.marvinlabs.com/2010/10/custom-listview-ability-check-items/](http://www.marvinlabs.com/2010/10/custom-listview-ability-check-items/)

不幸的是，他们的网站已关闭，所以我使用的是缓存版本：

[http://webcache.googleusercontent.com/search?q=cache:pXvzFq7UR-sJ:www.marvinlabs.com/2010/10/custom-listview-ability-check-items/+&cd=1&hl=en&ct=clnk&gl=us](http://webcache.googleusercontent.com/search?q=cache:pXvzFq7UR-sJ:www.marvinlabs.com/2010/10/custom-listview-ability-check-items/+&cd=1&hl=en&ct=clnk&gl=us)

我已完成`RelativeLayout`为我的项目行创建自定义的步骤。我在代码中遇到了一些错误，我不知道如何修复它们。例如，在这些行上：

```
for (Checkable c : checkableViews) {
    // Pass the information to all the child Checkable widgets
    c.setChecked(isChecked);
} 
```

我收到此错误：

```
Type mismatch: cannot convert from element type Object to Checkable 
```

以前没用过`Checkable`，不知道效果如何。

有人可以帮助实现这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:08:31.090

您可以将对象转换为 Checkable 对象：

```
for (int i = 0; i < checkableViews.size(); i++) {
    Checkable c = (Checkable) checkableViews.get(i);
    // Pass the information to all the child Checkable widgets
    c.setChecked(isChecked);
} 
```

或者更好的是，您可以在声明列表时提供存储在列表中的对象类型，例如：

```
List<Checkable> checkableList;
checkableList = new ArrayList<Checkable>(); 
```

然后你的原始`for`循环应该可以正常工作。

# ios - setContentOffset：动画：如果动画 = NO，则不会做任何事情

> ID：11730815
> 
> 赞同：3
> 
> 时间：2012-07-30T22:48:13.813
> 
> 标签：ios, ipad, uiscrollview

我正在尝试滚动到在 webView 中查看的 PDF 的最后查看位置。卸载 PDF 时，会保存 webView 的 scrollView 的 y 偏移量。然后，当重新打开 PDF 时，我想跳到他们离开的地方。

当动画设置为 YES 时，下面的代码工作正常，但是当它设置为 NO 时，没有任何反应

```
 float scrollPos = [[settingsData objectForKey:kSettingsScrollPosition]floatValue];
    NSLog(@"scrolling to %f",scrollPos);
    [webView.scrollView setContentOffset:CGPointMake(0, scrollPos) animated:NO];
    NSLog(@"ContentOffset:%@",NSStringFromCGPoint(webView.scrollView.contentOffset)); 
```

这输出：

**滚动到 5432.000000**

**公司：{0, 5432}**

但是 PDF 仍然显示首页

我在这里查看了类似问题的答案，但他们没有解决这个问题。

谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T16:55:13.187

在组件完成 PDF 的呈现`contentOffset`之前，您不能触摸。`UIWebView`它之所以有效，是`setContentOffset: animated:YES`因为动画强制渲染。

如果`contentOffset`在渲染开始后设置为至少 0.3s（根据我的测试），则完全没有问题。

例如，如果您在您的文件中加载 PDF，`viewDidLoad`您`UIViewController`可以`performSelector:withObject:afterDelay:`在`viewDidAppear:`延迟`contentOffset`设置中使用。

要在设置之前隐藏 PDF `contentOffset`，您可以将其 alpha 设置为 0.01（除非渲染不会开始，否则不要将其设置为 0）并在设置后将其设置回 1 `contentOffset`。

```
@interface ViewController : UIViewController
{
    UIWebView *w;
}

@property (nonatomic, retain) IBOutlet UIWebView *w;

@end

@implementation ViewController

@synthesize w;

- (void)viewDidLoad
{
    [super viewDidLoad];
    NSURL *u = [[NSBundle mainBundle] URLForResource:@"test" withExtension:@"pdf"];
    [w loadRequest:[NSURLRequest requestWithURL:u]];
    w.alpha = 0.01f;
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
    [self performSelector:@selector(adjust) withObject:nil afterDelay:0.5f];
}

- (void)adjust
{
    float scrollPos = 800;
    NSLog(@"scrolling to %f",scrollPos);
    [w.scrollView setContentOffset:CGPointMake(0, scrollPos) animated:NO];
    NSLog(@"ContentOffset:%@", NSStringFromCGPoint(w.scrollView.contentOffset));
    w.alpha = 1;
}

@end 
```

# excel - VBA Excel中的Mod

> ID：11730822
> 
> 赞同：1
> 
> 时间：2012-07-30T22:48:56.207
> 
> 标签：excel, vba

我遇到了一些问题`Mod`。

我的错误说不兼容

```
Sub test()    
For a = 1 To 5    
Dim cellValuekm As String    
cellValuekm = Range("C1").Offset(a, 0)    
If Mid(cellValuekm, 9, 1) Mod 2 = 0 Then
    Range("G1").Offset(a, 0) = "Kvinna"
Else
    Range("G1").Offset(a, 0) = "Man"
End If    
Next a    
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:53:24.270

Mid 返回一个字符串，将字符串格式化为 int/long/double/float 等......

```
Mid(cellValuekm, 9, 1) Mod 2 = 0 

Sub test()

    For a = 1 To 5
        Dim cellValuekm As String
        cellValuekm = Range("C1").Offset(a, 0)
        If Len(cellValuekm) < 10 Then
            MsgBox "String is less then 10 digits"
        End If            
        If CInt(Mid(cellValuekm, 9, 1)) Mod 2 = 0 Then
            Range("G1").Offset(a, 0) = "Kvinna"
        Else
            Range("G1").Offset(a, 0) = "Man"
        End If
    Next a
End Sub 
```

# excel - VBA，Excel：可以将 .OnAction 值设置为 ThisWorkbook 中的 Public Sub

> ID：11730824
> 
> 赞同：1
> 
> 时间：2012-07-30T22:49:06.393
> 
> 标签：excel, vba, menu, module, controls

VBA天才：

*问题 1：* 是否可以将菜单选项的**.OnAction**值设置为**ThisWorkbook**中的 Public Sub或必须 sub 在**模块**中？

这有效： ViewTextFile() 是**模块中的公共子**

```
.Controls(strMenuItem).OnAction = "'ViewTextFile """ & strMenuItem & """'" 
```

我想将 sub 移动到**ThisWorkbook**，所以值变成这样：

```
.Controls(strMenuItem).OnAction = "'" & ThisWorkbook.Name & "!ViewTextFile """ & strMenuItem & """'" 
```

*问题 2：* 如果 #1 的答案是肯定的，那么在 .OnAction 命令中获取对“ThisWorkbook”的引用的语法是什么？

请注意，参数**strMenuItem**必须包含在值中（如“ViewTextFile my_file.txt”）。我已经尝试了上述的许多变体，但没有成功。

谢谢VBA天才！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:40:55.857

```
.Controls(strMenuItem).OnAction = _
            "'ThisWorkbook.ViewTextFile """ & strMenuItem  & """'" 
```

# java - 我无法在我的 OSGI Bundle 中加载 HelpGUI

> ID：11730826
> 
> 赞同：1
> 
> 时间：2012-07-30T22:49:13.590
> 
> 标签：java, resources, stream, osgi, bundle

这应该很简单。HelpGUI 是一个非常简单的库：[HelpGUI](http://helpgui.sourceforge.net/)

在一个不使用任何 OSGI 框架的测试应用程序中，我可以毫无问题地加载包含在这个小库中的演示。当我尝试在我的 OSGI 包中执行此操作时，我无法打开 InputStream。这一定是因为我没有正确地将资源包含到我的包中，但我不确定如何。我能够构造一个 URL 对象并获得文件的正确路径。我的 /docs/help/ 文件夹与我的包中的 src 文件夹处于同一级别，我不应该只调用：

```
MainFrame mainFrame = new MainFrame("/docs/help/", "plastic"); 
```

并让它工作？为什么 OSGI 让这变得如此困难？有人可以尝试下载库并让演示在 OSGI 包中弹出帮助窗口吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T03:48:06.217

我已经尝试过了，并没有遇到任何并发症，我制作了一个带有 OSGi 版本和非 OSGi 版本的 git repo，并且都运行良好：

[https://github.com/flyaruu/demo-helpgui](https://github.com/flyaruu/demo-helpgui)

它们都有一个 Eclipse 启动文件，您可以从运行菜单运行它们。

我需要做的唯一棘手的事情是必须添加这个开关：--launcher.secondThread 但这只是 MacOS 上的 Eclipse SWT/Swing 问题，我不知道你使用什么平台。

此外，可能很棘手，Eclipse 不会强制您将依赖项添加到 javax.* 包，这是您真正应该做的，否则独立的 OSGi 框架不会加载包，即使 Eclipse 本身也会加载。

您可以使用 PDE 导出 (Export -> Bundles and Fragments) 导出包，我还在 git repo 中包含了它 (helpgui-osgi_1.0.0.201207310536.jar)。例如，您可以将包含的捆绑包放入 Felix 的“捆绑包”文件夹中。

不能让它变得更容易;-)

# clojure - clojure 和 ^:dynamic

> ID：11730828
> 
> 赞同：28
> 
> 时间：2012-07-30T22:49:37.120
> 
> 标签：clojure, dynamic-scope

我试图理解动态变量和绑定函数，所以我尝试了这个（clojure 1.3）：

```
user=> (defn f [] 
           (def ^:dynamic x 5) 
           (defn g [] (println x)) 
           (defn h [] (binding [x 3] (g))) 
           (h))
#'user/f
user=> (f)     
5
nil 
```

很困惑，我尝试了这个更简单的代码：

```
user=> (def ^:dynamic y 5)
#'user/y
user=> (defn g [] (println y))
#'user/g
user=> (defn h [] (binding [y 3] (g)))
#'user/h
user=> (h)
3
nil 
```

两段代码有什么区别？为什么第二个例子有效，而第一个无效？

提示：我刚刚意识到以下工作（仍然不完全理解为什么）：

```
user=> (def ^:dynamic y 5)
#'user/y
user=> (defn f [] (defn g [] (println y)) (defn h [] (binding [y 3] (g))) (h))
#'user/f
user=> (f)
3
nil
user=> 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-31T02:12:58.043

当我在 Clojure 1.4 中运行你的第一个示例时，我得到 3 结果（如你所料）......你用新的 REPL 试过了吗？

`^:dynamic`是对 Clojure 编译器的一条指令，指示符号（用 定义`def`）旨在动态反弹（用`binding`）。

例子：

```
(def foo 1)
(binding [foo 2] foo)
=> IllegalStateException Can't dynamically bind non-dynamic var: ...

(def ^:dynamic bar 10)
(binding [bar 20] bar)    ;; dynamically bind bar within the scope of the binding
=> 20
bar                       ;; check underlying value of bar (outside the binding)
=> 10 
```

请注意，`binding`在调用线程内具有动态范围 - 在绑定内调用的任何函数都将看到`bar`(20) 的修改值，但任何其他线程仍将看到未更改的根值 10。

最后，您可能会发现一些有用的风格点：

*   通常认为将函数放在函数内是个坏主意，`def`因为`defn`它们会影响封闭的命名空间。在你应该使用的函数`(let [foo bar] ...)`中。
*   当您发现自己想要使用`binding`时，您通常应该考虑是否可以使用高阶函数来实现相同的结果。`binding`在某些情况下很有用，但通常不是传递参数的好方法 - 从长远来看，函数组合通常更好。这样做的原因是`binding`创建了执行函数所需的隐式上下文，这可能难以测试/调试。

# php - 创建自定义映射以在 Vim 中搜索函数定义

> ID：11730829
> 
> 赞同：2
> 
> 时间：2012-07-30T22:49:44.340
> 
> 标签：php, vim

假设我正在编写一些 PHP 代码，并且我想出了一个我知道它在这个文件中定义的函数调用。我想创建一个映射，以便它自动查找`'function <WORD_UNDER_CURSOR>'`.

我设法通过使用来做到这一点`nmap <Leader>8 /function <C-r><C-w><CR>`，但问题是我的搜索换行已关闭（我想要那样），所以有一半的时间我最终会遇到到达屏幕错误的结尾并且不得不按下`N`自己向上看. 我试图`Nn`在映射 ( `nmap <Leader>8 /function <C-r><C-w><CR>Nn`) 的末尾附加一个，但它不起作用。我不知道为什么！事实上，我放在后面的任何东西`<CR>`似乎都没有任何效果。

你们能给我一些建议和解释吗？我发现有关 Vim 映射的文档真的很难找到你要找的东西。例如，我仍然不知道是什么`<C-r><C-w>`！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:11:07.037

向前搜索你使用`/`和向后搜索你使用`?`. 因此，只需`?`在现有地图中使用 . 而不是`/`.

`<C-r><C-w>`是 的 emacs 表示法`^R^W`。我不知道 emacs 表示法在 vi 实现中做了什么，但它确实存在。`:help ^R^W`虽然有效。它只是在光标下插入单词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T05:40:05.850

Vim 可以原生地做到这一点，`gd`这意味着“去定义”，顺便说一句，这不仅限于函数。见`:help gd`。

* * *

该`<C-r><C-w>`符号在 Vim 的文档中随处可见，在谈论 vim 时或多或少是编写组合的标准方式。Emacs 的标准符号是`C-r C-w`，没有`<>`.

键入`:help`以获取有关使用文档的快速提示以及`:help key-notation`有关键/组合问题和...键符号的更多详细信息。

在你的情况下，`:help ctrl-r_ctrl-w`或者`:help <c-r>_<c-w>`（注意下划线）会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T17:42:27.343

这是一个基于`:grep`它的映射应该做你想要的（更多信息请参见[这里](http://vim.wikia.com/wiki/VimTip1543)）：

```
map <buffer> <F3> :grep 'function.*<C-r><C-w>' %<CR><CR> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T21:15:26.040

我从上面的所有答案和评论以及帮助文件中收集了信息，并编译了这个答案，因为没有人直接回答。我找到了两个解决方案：

1-我们可以复制`yiw`光标下的单词，然后复制`gg`到文件的顶部。最后我们搜索“`function <C-r>"`这意味着，来自寄存器的函数空间内容”（最后一拉）。副作用：如果什么也没找到，你现在在文件的顶部，弄乱了寄存器。：-/

```
nmap <Leader>8 yiwgg /function <C-r>"<CR> 
```

2-我的个人创作，这是对问题中原始命令的更正：

```
nmap <Leader>8 /function <C-r><C-w><CR> Nn 
```

不起作用，因为 / 命令引发了“未找到错误”，从而中止了其余的映射。所以我们可以找到一种方法来忽略错误（我寻找但找不到），或者使用：

```
:nmap <Leader>8 :call search('function <C-r><C-w>','w')<CR> 
```

注意'w'标志，这意味着环绕！寻找`:help search`。

* * *

附加功能：

3- 完美世界 right_way_to_do_it：`gD`如果您的文件是有组织的或 ctags 则使用。

出于好奇，我`<Leader>8`之所以使用 * 是因为 8 的顶部。:)

# iphone - 为什么我没有用这个简单的代码读取任何磁场值？

> ID：11730831
> 
> 赞同：2
> 
> 时间：2012-07-30T22:49:57.657
> 
> 标签：iphone, objective-c, ios, magnetometer

**游戏.m**

```
#import "Game.h"
#import "CoreMotion.h"

@implementation Game

- (id) init 
{
    self = [super init];

    self.stopButtonPressed = NO;

    return self;
}
-(void) play
{
     CMMotionManager *motionManager;
     motionManager = [[CMMotionManager alloc] init];
     motionManager.deviceMotionUpdateInterval = 1.f/10.f;
     [motionManager startDeviceMotionUpdatesToQueue:[NSOperationQueue currentQueue]
                                        withHandler:^(CMDeviceMotion *motion, NSError *error)
                                        {
                                          NSLog(@"--------------> %i %i", motionManager.deviceMotionActive , motionManager.deviceMotionAvailable);

                                          NSLog(@"Degrees : %F",atan(motion.magneticField.field.y/fabs(motion.magneticField.field.x)) * 180.0 / M_PI);
                                        }
     ];
} 
```

**我的视图控制器.m**

```
#import "MyViewController.h"
#import "Game.h"

@interface MyViewController()
{
    Game *game;
}
@end

@implementation MyViewController

-(void) viewDidLoad
{
    game = [[Game alloc] init];
}

- (IBAction)playPressed:(UIButton *)sender 
{
    // using a separate thread
    //[game performSelectorInBackground:@selector(play) withObject:nil];

    // not using a separate thread
    [game play] ;
}

- (IBAction)stopPressed:(UIButton *)sender 
{
    game.stopButtonPressed = YES;
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T21:29:35.500

你需要坚持住`CMMotionManager`。所以为它创建一个实例变量。例如：

### 游戏.m

```
#import "Game.h"
#import "CoreMotion.h"

@interface Game ()
@property (nonatomic, strong) CMMotionManager *motionManager;
@end

@implementation Game

@synthesize motionManager = _motionManager;

- (id) init 
{
    self = [super init];

    self.stopButtonPressed = NO;

    return self;
}
-(void) play
{
     self.motionManager = [[CMMotionManager alloc] init];
     self.motionManager.deviceMotionUpdateInterval = 1.f/10.f;
     [self.motionManager startDeviceMotionUpdatesToQueue:[NSOperationQueue currentQueue]
                                             withHandler:^(CMDeviceMotion *motion, NSError *error)
                                             {
         NSLog(@"--------------> %i %i", self.motionManager.deviceMotionActive , self.motionManager.deviceMotionAvailable);
         NSLog(@"Degrees : %F",atan(motion.magneticField.field.y/fabs(motion.magneticField.field.x)) * 180.0 / M_PI);
                                             }
     ];
} 
```

问题是`CMMotionManager`您正在创建的您在`play`方法结束时被释放，因为没有任何东西保留它。因此，处理程序永远不会因为您的运动管理器离开而被回调。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T00:31:16.640

调用该方法后，磁场值不立即可用`startDeviceMotionUpdates`。您需要稍后尝试检索该值（即使用 a`NSTimer`并检查更新。

尽管这应该可行，但这不是一个好习惯。如果您只需要磁场值，您应该查看文档`CMMotionManager`并使用[startMagnetometerUpdatesToQueue:withHandler:](http://developer.apple.com/library/ios/documentation/CoreMotion/Reference/CMMotionManager_Class/Reference/Reference.html#//apple_ref/occ/instm/CMMotionManager/startMagnetometerUpdatesToQueue%3awithHandler%3a)方法，如下所示：

```
[motionManager startMagnetometerUpdatesToQueue:[NSOperationQueue currentQueue] withHandler:^(CMMagnetometerData *magnetometerData, NSError *error) {
  CMMagneticField field = magnetometerData.magneticField;
  NSLog(@"x: %f  y:%f  z:%f", field.x, field.y, field.z);
}]; 
```

干杯，安卡

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T12:28:18.707

顺便说一句，一种可能性是您正在运行的设备甚至可能没有磁力计。请参阅[磁力计-for-compass-on-ipod-touch-4g](https://stackoverflow.com/questions/10247167/magnetometer-for-compass-on-ipod-touch-4g) 我指向[带有磁力计的苹果设备](https://stackoverflow.com/questions/4227272/apple-devices-with-magnetometer)

# mysql - mysql选择当前时间旁边的记录

> ID：11730832
> 
> 赞同：4
> 
> 时间：2012-07-30T22:49:58.047
> 
> 标签：mysql, time, dayofweek

这是一个食品服务系统......我有一个名为 detalle_regimen_paciente 的表，它存储饮食，周一至周日的早餐（周一为 1 份，周日为 7 份，智利式），也有特定的服务时间。

```
+---+---------+-----------+--------------+---+
|id | name    |hora_carga |hora_servicio |day|
+---+---------+-----------+--------------+---+
|1  |breakfast|08:00      |09:00         |1  |
+---+---------+-----------+--------------+---+
|2  |lunch    |10:00      |13:00         |1  |
+---+---------+-----------+--------------+---+
|3  |breakfast|08:00      |09:00         |2  |
+---+---------+-----------+--------------+---+
|2  |lunch    |10:00      |13:00         |2  |
+---+---------+-----------+--------------+---+ 
```

所以我在查询中苦苦挣扎了大约两天（数据库中的内容比这更多......一些 n:m 关系是一个消费表，我可以从中获得一名员工的总消费量），我发现问题是我找不到使用当前日期和当前时间仅选择周一 08:00 的餐点（即记录 id #1）的方法...

所以在星期一的 07:58 它应该只返回 ID 为 1 的记录，因为它是下一顿服务，也是为员工收取的下一顿饭。

```
+---+---------+-------------+---+
|1  |breakfast|08:00        |1  |
+---+---------+-------------+---+ 
```

这是到目前为止的sql，但它似乎只是过滤了一天......

```
select detalle_regimen_paciente.hora_carga
from
detalle_regimen_paciente
where
detalle_regimen_paciente.hora_servicio > CURTIME() AND
detalle_regimen_paciente.hora_carga > CURTIME()
AND
detalle_regimen_paciente.dia = (select DAYOFWEEK(CURDATE())-1) 
```

也许我只是在问错或误用时间功能。

请在这里帮忙。

提前谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:30:41.990

如果您的查询将结果限制为两者

*   当天和
*   仍然存在于未来的时代

那么你可以使用最近的这些

```
SELECT … FROM … WHERE …
ORDER BY hora_servicio ASC
LIMIT 1 
```

这只是按小时对结果行进行排序并选择其中的第一行。在一天的最后一餐之后，您必须等到午夜，此查询才会返回非空结果。您可能最好使用联合来解决这个问题：

```
(SELECT 0 AS tomorrow, … FROM …
 WHERE dia = ((DAYOFWEEK(CURDATE()) + 5) MOD 7) + 1
   AND hora_servicio > CURTIME()
)
UNION ALL
(SELECT 1 AS tomorrow, … FROM …
 WHERE dia = DAYOFWEEK(CURDATE()) -- this really is the next day
)
ORDER BY tomorrow, hora_servicio
LIMIT 1 
```

您的代码可能还需要这个工作日计算。下面是它的工作原理：

```
 Su Mo Tu We Th Fr Sa
  DAYOFWEEK(CURDATE())                   1  2  3  4  5  6  7
 (DAYOFWEEK(CURDATE()) + 5)              6  7  8  9 10 11 12
((DAYOFWEEK(CURDATE()) + 5) MOD 7)       6  0  1  2  3  4  5
((DAYOFWEEK(CURDATE()) + 5) MOD 7) + 1   7  1  2  3  4  5  6 
```

您的版本将计算 0 而不是 7 星期天。您可以在没有任何魔法的情况下使用 MySQL`DAYOFWEEK`来引用*第二天*的事实可能看起来有点令人困惑，所以它当然值得评论。

作为替代`dia = ((DAYOFWEEK(CURDATE()) + 5) MOD 7) + 1`你可以写`dia MOD 7 = DAYOFWEEK(CURDATE()) - 1`，因为这将使用从零开始的数字双方。但是，结果可能效率较低，因为数据库必须计算左侧的值，这会破坏索引和类似的优化。所以我宁愿把所有的计算都放在右手边。

感谢@ypercube 让我想到了第二天。

如果您想考虑超过一天的未来（我希望您不必为太多人这样做），那么您可以执行以下操作：

```
SELECT dia, hora_servicio
FROM detalle_regimen_paciente
WHERE dia <> ((DAYOFWEEK(CURDATE()) + 5) MOD 7) + 1
   OR hora_servicio > CURTIME()
ORDER BY (dia - DAYOFWEEK(CURDATE()) + 1) MOD 7 ASC,
         hora_servicio ASC
LIMIT 1 
```

这里的想法是，第一`ORDER BY`项计算未来的天数：这个值将是当天的 0，明天的 1，后天的 2，依此类推。对于当天的餐点，我们只吃当前时间之后的餐点。对于其他所有日子，任何时间都可以。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T23:01:07.210

```
SELECT 
    *                          --- select the columns you need (hora_carga ?)
FROM
  ( SELECT *  
    FROM detalle_regimen_paciente   
    WHERE  hora_servicio > CURTIME()     
         AND
           dia = DAYOFWEEK(CURDATE())-1
       OR 
         dia > DAYOFWEEK(CURDATE())-1
    ORDER BY dia, hora_servicio
      LIMIT 1
  ) AS a
UNION ALL
SELECT *
FROM
  ( SELECT *     
    FROM detalle_regimen_paciente   
    ORDER BY dia, hora_servicio
      LIMIT 1
  ) AS b
ORDER BY dia DESC, hora_servicio DESC
  LIMIT 1
; 
```

# python - Python 2.7：“有什么产出了吗？”

> ID：11730833
> 
> 赞同：1
> 
> 时间：2012-07-30T22:50:10.610
> 
> 标签：python, generator, yield

在生成器函数中，我怎样才能知道它是否已经产生了任何东西？

```
def my_generator(stuff):
    # complex logic that interprets stuff and may or may not yield anything

    # I only want to yield this if nothing has been yielded yet.
    yield 'Nothing could be done with the input.' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-30T22:51:30.780

您需要自己保留一个标志，或在顶部重构代码。如果事情太复杂，听起来你的函数可能做的太多了。

此外，如果这是您的信息，听起来您可能想要一个例外。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-19T07:48:55.567

跟踪自己的一种简单方法是将复杂的逻辑包装到内部生成器中。

这样做的好处是，它不需要对复杂的逻辑进行任何更改。

```
def my_generator(stuff):
    def inner_generator():
        # complex logic that interprets stuff and may or may not yield anything
        if stuff:
            yield 11 * stuff

    # I only want to yield this if nothing has been yielded yet.
    have_yielded = False
    for x in inner_generator():
        have_yielded = True
        yield x

    if not have_yielded:
        yield 'Nothing could be done with the input.' 
```

测试#1：

```
print(list(my_generator(1))) 
```

=>

```
[11] 
```

测试#2：

```
print(list(my_generator(None))) 
```

=>

```
['Nothing could be done with the input.'] 
```

* * *

**- - 替代 - -**

更复杂的代码，那可能是过早的优化。避免**重复**将 have_yielded 设置为 True。仅当您的生成器从不产生“无”作为其第一个值时才有效：

```
 ...
    # I only want to yield this if nothing has been yielded yet.
    have_yielded = False
    g = inner_generator()
    x = next(g, None)
    if x is not None:
        yield x
        have_yielded = True
    for x in g:
        yield x

    if not have_yielded:
        yield 'Nothing could be done with the input.' 
```

# javascript - JavaScript：无法从子窗口访问父全局变量

> ID：11730836
> 
> 赞同：1
> 
> 时间：2012-07-30T22:50:21.873
> 
> 标签：javascript

因此，我生成了一个新窗口并附加了这些脚本：

```
 var newwindow2=window.open('','name','height=200,width=150,menubar=yes');
  var tmp = newwindow2.document;
  tmp.write('<html><head><title></title>');
  tmp.write('<link rel="stylesheet" href="css/app-style2.css">');
  tmp.write('</head><body></body><div id="myapp"></div>');

  var headtag = tmp.getElementsByTagName('head')[0];
  var fileref=document.createElement("script");
  fileref.setAttribute("type", "text/javascript");
  fileref.setAttribute("language", "JavaScript");
  fileref.setAttribute("src", "js/test.js");
  headtag.appendChild(fileref); 
```

在 test.js 中，它也附加到开瓶器上。我有一个名为联系人的全局对象数组。如果我添加一个 onload 函数来查看窗格的加载方式，我会看到数组数量很好。

```
 fileref.onload = function() {

 alert(contacts.length);
 }; 
```

我尝试访问窗格并获得“null”。

```
function getObj(contactID){

  for (var i=1;i<= contacts.length;i++) {
      if (contactID == contacts[i].id)
      return contacts[i];     
  }
  return null;
} 
```

知道我要去哪里错了吗？顺便说一句：这是演示软件，只需要在 FF 上工作（如果可能的话 chrome）

# python - 验证码

> ID：11730849
> 
> 赞同：0
> 
> 时间：2012-07-30T22:51:52.620
> 
> 标签：python, validation

我正在尝试验证字符串的有效性，以确保它是我可以传递给终端的合法命令。如果字符串通过测试，我返回 True。否则，我返回 False 和一条错误消息。

我的代码非常难看，有很多嵌套的 if 语句 - 我该如何改进它？

```
task = task.split()
if len(task) > 1: 
    if task[0] == 'svn':
        if task[1] in ALLOWED:
            if len(task[2:]) == ALLOWED[task[1]]:
                return True, task, None
            else:
                return False, "Incorrect number of arguments."
        else:
            return False, "Not a legal command."    
    else:
        return False, "Not a subversion command."
else:
    return False, "Invalid input" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T22:57:16.573

而不是肯定检查和嵌套 if 语句：

```
if a:
    if b:
        if c:
            foo()
        else:
            # error 3
     else:
         # error 2
else:
    # error 1 
```

除非一切正常，否则您可以反转逻辑并退出：

```
if not a:
    # raise an exception

if not b:
    # raise an exception

if not c:
    # raise an exception

# If we get here, everything is OK.
foo() 
```

这样可以更容易地查看哪个错误消息与哪个条件匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T23:00:30.253

以下是如何针对您的案例具体实施 Mark Byer 的答案的示例：

```
task = task.split()
if len(task) < 2:
    return False, "Invalid input"
if task[0] != 'svn':
    return False, "Not a subversion command."
if task[1] not in ALLOWED:
    return False, "Not a legal command."    
if len(task[2:]) != ALLOWED[task[1]]:
    return False, "Incorrect number of arguments."  
return True, task, None 
```

# c++ - 模板部分特化防止从派生类初始化

> ID：11730854
> 
> 赞同：0
> 
> 时间：2012-07-30T22:52:14.930
> 
> 标签：c++, templates, derived-class, partial-specialization, constructor-chaining

我从具有部分专业化的模板继承，并且不能从派生的 ctor 调用模板 ctor。

当下面代码中的部分特化被注释掉时，它编译时不会出现任何错误或警告。

```
#include <iostream>
typedef enum {supertype, subtype} selector;

template< typename T, selector s>
class Tmpl {
protected:
    T* root;
public:
    Tmpl( T* t = 0 ) {
        root = t;
    }
    T listHead( ) {
        std::cout << "template listHead() called" << std::endl;
    }
};

class Descriptor {
public:
    Descriptor( const char * s ) {
        std::cout << "Descriptor " << s << std::endl;
    }
};

// partial specialization - if uncommented, errors 
// are reported at the supertypesIterator ctor below.
/*
template<selector s>
class Tmpl<Descriptor, s> {
public:
    Descriptor listHead( ) {
        switch( s ){
            case supertype:
                return Descriptor("Supertypes");
            case subtype:
                return Descriptor("Subtypes");
        }
    }
};
*/

class supertypesIterator : public Tmpl<Descriptor, supertype> {
public:
    supertypesIterator( Descriptor* t = 0 ):Tmpl<Descriptor, supertype>(t) {}
};

main() {
    supertypesIterator s;
    s.listHead();
} 
```

如果我取消注释专业化，我会收到以下错误：

$`g++ trouble.cc`

```
trouble.cc: In constructor ‘supertypesIterator::supertypesIterator(Descriptor*)’:
trouble.cc:43:74: error: no matching function for call to ‘Tmpl<Descriptor, (selector)0u>::Tmpl(Descriptor*&)’
trouble.cc:43:74: note: candidates are:
trouble.cc:27:7: note: Tmpl<Descriptor, (selector)0u>::Tmpl()
trouble.cc:27:7: note:   candidate expects 0 arguments, 1 provided
trouble.cc:27:7: note: Tmpl<Descriptor, (selector)0u>::Tmpl(const Tmpl<Descriptor, (selector)0u>&)
trouble.cc:27:7: note:   no known conversion for argument 1 from ‘Descriptor*’ to ‘const Tmpl<Descriptor, (selector)0u>&’ 
```

我需要做什么才能从`supertypesIterator`ctor 中初始化基类？

我正在使用 g++ version `4.7.1`，尽管我还需要它才能跨平台工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:57:37.023

您必须在您的专业化中实现缺少的构造函数。否则，构造函数`supertypesIterator`会尝试调用`Tmpl`不存在的构造函数。

```
template<selector s>
class Tmpl<Descriptor, s> {
    Descriptor* root;
public:
    Tmpl( Descriptor* t = 0 ) {
        root = t;
    }
    Descriptor listHead( ) {
        switch( s ){
            case supertype:
                return Descriptor("Supertypes");
            case subtype:
                return Descriptor("Subtypes");
        }
    }
}; 
```

# devexpress - 使用 ContentURL 属性的 Aspxpopupcontorl -> 是否可以通过服务器端按钮单击事件关闭窗口？

> ID：11730855
> 
> 赞同：0
> 
> 时间：2012-07-30T22:52:15.693
> 
> 标签：devexpress

有没有人让这个工作？

在过去的几年里，我对此进行了多次研究，但从未找到解决此问题的方法。我被要求今天再次发生这种情况。

contentURL 属性基本上允许您创建另一个整个页面以用作弹出控件。

我在此页面中有一个按钮，需要执行服务器端逻辑（保存数据），然后我希望它自动关闭窗口。

[http://demos.devexpress.com/ASPxperienceDemos/PopupControl/ContentUrl.aspx](http://demos.devexpress.com/ASPxperienceDemos/PopupControl/ContentUrl.aspx)

如果您不知道这是什么，上面有演示链接。

任何想法将不胜感激我似乎总是很难在他们的网站上找到信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T06:46:18.283

您可以使用[AspxCallback](http://demos.devexpress.com/ASPxperienceDemos/Callback/Example.aspx)控件。

您需要关闭`AutoPostback`. 当用户按下按钮时，使用`AspxCallback`调用服务器端代码，如果服务器端代码成功完成，它应该返回一个状态，您可以检查该状态，如果保存成功则关闭窗口。如果您返回的状态表明保存不成功，那么您可以向您的用户显示一条消息并允许他们重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:01:13.270

```
protected void Button_Click(object  sender,  EventArgs e)
{
  string script = string.Format("<script type=\"text/javascript\"> HidePopUp(); </script>");
    ClientScript.RegisterStartupScript(Type.GetType("System.String"), "key", script);
} 
```

c# 上面 jscript 下面

```
function HidePopUp() {
            var p = window.parent;
            var popup = p.window["testPopup"];
            popup.Hide();            
 } 
```

终于在他们的网站上找到了一些东西。只需确保将 testPopup 替换为弹出控件的客户端名称即可。

# php - 如果索引匹配计数，php foreach 返回一个额外的空行

> ID：11730857
> 
> 赞同：1
> 
> 时间：2012-07-30T22:52:24.930
> 
> 标签：php, foreach

如果“if”条件与索引计数匹配，我的 foreach 会在输出中返回一个额外的空元素。

这是我的代码

```
<ul id="toplevel" class="menu">
  <?php 
  foreach($categories as $category){
    $parenturl = 'some url'.$category->category_id;
    $parentname = $category->category_name;
  ?>
    <li>
      <?php echo link($parenturl, $parentname); ?>
      <?php if($category->childs) : ?>
      <ul>
        <li>
         <?php echo link($parenturl, $parentname); ?>
          <ul>
          <?php
          $i=0;
          foreach($category->childs as $child){
            $i++;
            $childurl = 'some url'.$child->category_id;
            $childname = $child->category_name;
          ?>
          <li><?php echo link($childurl, $childname); ?></li>
          <?php
          if($i % 10 == 0) :
          ?>
           </ul></li><li><?php echo link($parenturl, $parentname); ?><ul>
          <?php
          endif;
          }
          ?>
          </ul>
        </li>
      </ul>
      <?php endif; ?>
    </li>
  <?php
  }
  ?>
  </ul> 
```

因此，如果 $child 正好有 10 个项目，那么这将输出 11，我不知道为什么。

输出如下所示：

```
<ul id="toplevel" class="menu">
<li>
  <a>Main Category</a>            
  <ul>
    <li>
     <a>Main Category</a>          
     <ul>
        <li><a>Sub 1</a></li>
        <li><a>Sub 2</a></li>
        <li><a>Sub 3</a></li>
        <li><a>Sub 4</a></li>
        <li><a>Sub 5</a></li>
        <li><a>Sub 6</a></li>
        <li><a>Sub 7</a></li>
        <li><a>Sub 8</a></li>
        <li><a>Sub 9</a></li>
        <li><a>Sub 10</a></li>
      </ul>
    </li>
    <li>
    <a>Main Category</a>
    <ul> </ul>
    </li>
  </ul>
</li>
</ul> 
```

我一直在玩计数，但每次当 $child 与数字集匹配时，它都会再输出一个。但是，如果 $child 的项目数少于或多于计数，则它可以正常工作。

*HTML 看起来像这样，因为我使用的是 Design Chemical 的 jQuery Verical Megamenu 并且需要这种布局*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:05:36.340

考虑这个代码片段：

```
 <?php
      $i=0;
      foreach($category->childs as $child){
        $i++;
        $childurl = 'some url'.$child->category_id;
        $childname = $child->category_name;
      ?> 
```

变量 $i 在 foreach 循环之前定义。在 foreach 循环中，$i 在每次迭代时递增 on。在 foreach 循环之后，变量 $i 的值将等于 foreach 循环迭代的次数。由于 foreach 循环的迭代次数等于 $child 中元素的数量，因此 $i 也等于 $child 中循环“关注”的当前元素。

现在考虑下面的代码片段：

```
 <?php
      if($i % 10 == 0) :
      ?>
       </ul></li><li><?php echo link($parenturl, $parentname); ?><ul>
      <?php
      endif;
      }
      ?> 
```

这里的 if 语句检查 $i 以查看它是否可以被 10 整除。它使用模运算符 ( % ) 执行此操作，该运算符返回左数除以右数时的余数。如果 $i 可以被 10 整除，则布尔语句为真，脚本将内容添加到“endif”语句中。

这就是为什么当 $child 有 10 个元素时您的代码会创建一个额外的行的原因。当 $child 有 20、30 或任意数量的可被 10 整除的元素时，它还会创建一个额外的行。

现在，您的代码会在十的倍数上生成一个额外的标签，以容纳下一组十个元素。但是，无论数组中在十的倍数之后是否有添加元素，代码都会以十的倍数生成此标记。这意味着如果数组正好是十个元素的倍数，您会收到一个“空白/空”标签。

考虑这个修复：

```
<ul id="toplevel" class="menu">
  <?php 
  foreach($categories as $category){
    $parenturl = 'some url'.$category->category_id;
    $parentname = $category->category_name;
  ?>
    <li>
      <?php echo link($parenturl, $parentname); ?>
      <?php if($category->childs) : ?>
      <ul>
        <li>
         <?php echo link($parenturl, $parentname); ?>
          <ul>
          <?php
          $i=0;
          foreach($category->childs as $child){
            $i++;
            $childurl = 'some url'.$child->category_id;
            $childname = $child->category_name;
          ?>
          <li><?php echo link($childurl, $childname); ?></li>
          <?php
          if($i % 10 == 0 && $i < count($category->childs) ) :
          ?>
           </ul></li><li><?php echo link($parenturl, $parentname); ?><ul>
          <?php 
          endif;
          }
          ?> 
          </ul>
        </li>
      </ul>
      <?php endif; ?>
    </li>
  <?php
  }
  ?>
  </ul> 
```

我变了：

```
if($i % 10 == 0) 
```

至：

```
if($i % 10 == 0 && $i < count($category->childs) ) 
```

编辑：澄清问题后修改答案。上面更改的条件语句现在将检查以确保在创建新标签之前还有其他元素。

# ruby-on-rails - heroku 上的多个站点：关于数据库管理的建议？

> ID：11730858
> 
> 赞同：1
> 
> 时间：2012-07-30T22:53:09.777
> 
> 标签：ruby-on-rails, ruby, postgresql, heroku

我正在使用 rails 开发一个站点并将其部署到 heroku。它最终会有相当多的数据，目前 beta/demo 的行数不到 30 万行，这超出了 heroku 上免费开发级别的限制。

我正在为站点的生产部署购买基本级别，但我们有第二个部署，我们在开发功能等时用于测试部署。这些数据应该与生产数据不同，这样用户就可以随意弄乱它，但它不会不要污染生产/测试用户。

我们有第三个部署，我们的营销人员希望将其用作演示，它也应该是一组独特的数据。

有人对如何管理这个有任何建议吗？如果可以避免的话，我们宁愿不必为 3 个数据库付费——登台和演示站点不会面向公众或不会产生收入。他们也根本看不到太多流量（很少）。我喜欢在 heroku 上拥有该站点，因为我们想确保我们的部署在使用它们进行生产之前没有出现特定于 heroku 的问题......

感谢您的考虑。

最大限度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T03:43:56.857

如果您考虑一下，您的暂存环境不必有 300K+ 行数据。只是一些种子数据，你应该很高兴。因此，不需要购买基本层 - 开发层应该绰绰有余。

# php - 使用 php 加速 xml 解析

> ID：11730860
> 
> 赞同：4
> 
> 时间：2012-07-30T22:53:17.653
> 
> 标签：php, parsing, xmldom

您好我有一个包含大约 12,000 条记录的 xml 文件。我编写了代码，它工作正常，只需要一段时间来解析 xml 文件并返回内容。有什么方法可以加快这个过程吗？

我的代码：

```
<?php 
$dom = new DOMDocument(); 
$dom->load('comics.xml'); 
foreach ($dom->getElementsByTagName('record') as $entry) 
{   
$title = $entry->getElementsByTagName('title')->item(0)->textContent;   
echo $title;   

} 
?> 
```

XML 文件（其中只有 1 个演示无法链接所有内容，哈哈）：

```
<?xml version='1.0' encoding='utf-8'?>
<calibredb>
  <record>
    <id>1</id>
    <uuid>991639a0-7cf6-4a34-a863-4aab8ac2921d</uuid>
    <publisher>Marvel Comics</publisher>
    <size>6109716</size>
    <title sort="Iron Man v1 101">Iron Man v1 101</title>
    <authors sort="Unknown">
      <author>Unknown</author>
    </authors>
    <timestamp>2012-04-15T18:49:22-07:00</timestamp>
    <pubdate>2012-04-15T18:49:22-07:00</pubdate>
    <cover>M:/Comics/Unknown/Iron Man v1 101 (1)/cover.jpg</cover>
    <formats>
      <format>M:/Comics/Unknown/Iron Man v1 101 (1)/Iron Man v1 101 - Unknown.zip</format>
    </formats>
  </record>
  </calibredb> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:15:42.233

**DOM**方法适用于小型数据集，因为所有 XML 结构都被解析并放入内存中。

在您的情况下，您应该在解析大型 XML 文件时使用**SAX**方法，因为 XML 文件是逐行读取的，而不是一次读取所有内容。

谷歌有一些例子：[https ://www.google.lv/search?q=php+SAX+XML](https://www.google.lv/search?q=php+SAX+XML)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T23:02:09.890

答案很大程度上取决于数据。一些可能的解决方案是将数据移动到像 MySQL 这样的关系数据库中，或者将数据规范化为像 CSV 这样更易于解析、占用空间更少并且可以逐行读取的格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T23:13:34.450

我对 PHP 实现并不特别熟悉，但是在使用 Xerces 的 C++ 中使用以下方法时，我已经看到您的方案的性能得到了巨大的改进。

与其按名称请求所有元素并等待返回整个 NodeList，我发现只获取根节点下的第一个子节点然后获取 NextSibling 节点要快得多。将每个兄弟节点用作新节点，您将不断获得 NextSibling，直到没有剩余节点为止。

希望这可以在 PHP 中提供类似于在 C++ 中所做的性能改进。

# python - 选项不会打印

> ID：11730861
> 
> 赞同：1
> 
> 时间：2012-07-30T22:53:22.840
> 
> 标签：python, printing, if-statement

```
while True:

    x = raw_input()
    if x =="personal information": 
         print' Edward , Height: 5,10 , EYES: brown , STATE: IL TOWN:  , SS:'
    elif x =="journal":
       print'would you like  you open a journal or create a new one? open or create'
if x =='createfile':
           name_of_file = raw_input("What is the name of the file: ")
           completeName = "C:\\python\\" + name_of_file + ".txt"
           file1 = open(completeName , "w")
           toFile = raw_input("Write what you want into the field")
           file1.write(toFile)
           file1.close()
elif x =='openfile':
       print'what file would you like to open'
       y = raw_input()
       read = open(y , 'r')
       name = read.readline()
       print (name) 
```

options 不会打印除个人信息外没有输出。我重新粘贴了代码

# c# - 从 C# 应用程序引用 Z3

> ID：11730866
> 
> 赞同：0
> 
> 时间：2012-07-30T22:54:23.227
> 
> 标签：c#, z3

我正在尝试在 C# 中运行此 Z3 代码，但有很多错误，例如：

*   需要 Z3V3 参考
*   在 z3.MkSort("U") 它说 z3 不存在
*   术语参考 需要参考

我运行 Z3 并将其包含在我的程序文件中，那么这段代码如何工作，是否需要任何 .NET 引用？

```
class Program
{
    static void Main(string[] args)
    {
        {
            Console.WriteLine("prove_example1");
            mk_context();
            /* create uninterpreted type. */
            Sort U = z3.MkSort("U");
            /* declare function g */
            FuncDecl g = z3.MkFuncDecl("g", U, U);
            /* create x and y */
            Term x = z3.MkConst("x", U);
            Term y = z3.MkConst("y", U);
            /* create g(x), g(y) */
            Term gx = mk_unary_app(g, x);
            Term gy = mk_unary_app(g, y);
            /* assert x = y */
            Term eq = z3.MkEq(x, y);
            z3.AssertCnstr(eq);
            /* prove g(x) = g(y) */
            Term f = z3.MkEq(gx, gy);
            Console.WriteLine("prove: x = y implies g(x) = g(y)");
            prove(f);
            /* create g(g(x)) */
            Term ggx = mk_unary_app(g, gx);
           /* disprove g(g(x)) = g(y) */
            f = z3.MkEq(ggx, gy);
            Console.WriteLine("disprove: x = y implies g(g(x)) = g(y)");
            prove(f);
           /* Print the model using the custom model printer */
            z3.AssertCnstr(z3.MkNot(f));
            check2(LBool.True);
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:34:19.427

您似乎从旧的 Z3 C# API 示例中复制了此代码片段。原始示例有一个字段`Context z3;`. 它还有几个辅助方法：`mk_context`、`prove`、`mk_unary_app`等。如果不复制这些附加方法，您将无法编译您的示例。此外，此示例使用旧的 C# API。Z3 4.0 有一个新的 C# API。它更容易使用。我建议您切换到 Z3 4.0（如果您还没有使用它）。Z3 4.0 发行版有一个名为`examples\dotnet`. 该目录包含一个名为 的大示例，以及一个用于构建/编译它`Program.cs`的批处理文件。`build.bat`此示例演示如何使用 Z3 C# API。以下链接包含 Z3 C# API 的参考手册：[http://research.microsoft.com/en-us/um/redmond/projects/z3/class_microsoft_1_1_z3_1_1_context.html](http://research.microsoft.com/en-us/um/redmond/projects/z3/class_microsoft_1_1_z3_1_1_context.html)

# javascript - 如何创建范围内的动态、基于实例的对象文字

> ID：11730867
> 
> 赞同：1
> 
> 时间：2012-07-30T22:54:27.587
> 
> 标签：javascript

在没有通过谷歌和帖子的帮助之后，这是我的猜测：

```
var MC = {};
MC.o_p = function ( type ) {
    return {
        model  :  type,
        result :  'continue',
        page   :  {},
        args   :  {},
        server :  {},
        hash   :  localStorage.hash
    }
}; 
```

我这样称呼

```
var obj1 = MC.o_p( 'MUserTry' ); 
```

这里的对象 o_p 是 MC 的“范围”。您可以通过上面的调用创建多个实例。字符串 MUserTry 作为变量类型传入并设置为对象属性模型。

这行得通吗？目前我正在从反复试验中休息一下，但我需要的是能够创建具有多个实例的某种形式的对象文字。

**有关的**

[如何从本地范围创建全局的、基于实例的对象？](https://stackoverflow.com/questions/11729973/how-to-create-global-instance-based-objects-from-local-scope)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:03:22.683

您无法确定结果对象的范围。属性是对象的`o_p`成员，但函数返回的对象不是。

对象字面量只是`{ ... }`用于创建对象的语法，因此您要做的是创建一个对象，而不是对象字面量。（创建对象文字可以通过将对象文字的代码放入字符串中并执行该字符串来完成。）

您在滥用构造函数，但它会起作用。将创建一个对象，并调用函数对其进行初始化，然后该对象将被丢弃并由函数返回的对象替换。

只需删除`new`关键字，以便您进行常规函数调用，它将返回对象。

# python - 发送大量文本

> ID：11730868
> 
> 赞同：0
> 
> 时间：2012-07-30T22:54:36.900
> 
> 标签：python, cookies, html-parsing

所以，这是我的程序。它的作用是在我所在的论坛上出现新的 pm 时向我发送一条短信。问题是它不只发送一个，而是发送数百个。

我该如何解决？我假设一个`break`声明，但我不知道如何措辞。

```
import urllib2
from twilio.rest import TwilioRestClient
webp=urllib2.urlopen("http://hackforums.net").read()
words = urllib2.urlopen("http://hackforums.net").read()

word = 'titled'
while True:
    for word in words:
        if word in words:
            ACCOUNT_SID = "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXx"
            AUTH_TOKEN = "XXXXXXXXXXXXXXXXXXXXXXXXXXXx"

            client = TwilioRestClient(ACCOUNT_SID, AUTH_TOKEN)

            message = client.sms.messages.create(to="XXXto", from_="XXXfrom",
                body="You have a new PM") 
```

然后我正在使用：

```
import os
import time

while True:
    os.system("python newway.py")

print 'done' 
```

打开它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:01:38.913

假设顶部的代码块是`newway.py`，您无法检查内容是否是新的，并且您调用它的方式只是一遍又一遍地运行它。

您需要实现某种跟踪状态的方法（我建议使用文件），并跟踪某些内容是否是新的，并且仅在有新内容时发送消息。

# symfony - 自定义单表单字段类型忽略 Symfony 2 中的验证？

> ID：11730869
> 
> 赞同：2
> 
> 时间：2012-07-30T22:55:11.110
> 
> 标签：symfony, symfony-forms

我有一个继承自`textarea`type 的可重用（此处为简化）自定义字段类型。默认情况下，内容不能为空，所以我指定`validation_constraint`为默认选项：

```
namespace Acme\HelloBundle\Form\Type;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Validator\Constraints\NotBlank;

class SmsContentType extends AbstractType
{

    public function getDefaultOptions(array $options)
    {
        return $options + array(
            'label'                 => 'Testo *',
            'validation_constraint' => new NotBlank()
        );
    }

    public function getParent(array $options) { return 'textarea'; }

    public function getName() { return 'sms_content'; }

} 
```

但是将内容留空不会显示任何错误。不在场本身附近，也不像使用`form_errors(form)`.

我哪里错了？哦，我在另一个表单中使用这个自定义类型：

```
class UserType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('sms_birthday_template', new SmsContentType(), array(
                'label' => 'SMS compleanno',
            ))
        ;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T16:47:00.187

这是 Symfony 2.0 的限制。那里的“validation_constraint”选项仅适用于根表单。

在 Symfony 2.1 中，“validation_constraint”被重命名为“constraints”，并且完全符合您的要求：

```
public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver->setDefaults(array(
        'label'       => 'Testo *',
        'constraints' => new NotBlank()
    ));
} 
```

# winapi - 是否可以将 BackgroundWorker 线程用于 VC++ Win32 项目？

> ID：11730871
> 
> 赞同：0
> 
> 时间：2012-07-30T22:55:19.573
> 
> 标签：winapi, user-interface

首先，我将解释我到底想在这里做什么。我有一个对话框，我在其中显示一个框架。使用此对话框中的菜单，我打开另一个对话框，其中显示了第一个对话框中的宏网格块信息。所以要显示第二个对话框，我正在使用函数： DialogBox(hInst, MAKEINTRESOURCE(IDD_DIALOG1), NULL, DialogProc); 但这会将程序的执行转移到新对话框中，除非我关闭新对话框，否则我无法在第一个对话框中处理更多消息。

有人可以告诉我解决这个问题的方法吗？？？它与模态对话框与非模态对话框相同吗？

有人建议我为此目的使用 BackgroundWorker 线程。但是当我尝试研究它时，我在很多地方读到它不适用于 win32 编程。相反，在一些论坛中，我读到了出于相同目的使用 PostMessage 函数。有人可以帮我决定处理这个问题的最佳方法是什么吗？如果有人能详细解释一下，我将不胜感激。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T07:05:19.440

不，该[`BackgroundWorker`组件](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)适用于 .NET 项目，不适用于 Win32 应用程序。它旨在在后台线程上运行*非 GUI操作。*您仍然应该将所有 GUI 操作限制在单个线程中，即使在 .NET 应用程序中也是如此。

但就像你说的，这里的问题是你正在创建一个模式对话框，它会阻止用户与程序中的任何其他内容进行交互，直到该对话框关闭。该[`DialogBox`函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645452.aspx)总是创建一个模态对话框。

如果您想要一个无模式对话框，请改为调用该[`CreateDialog`函数。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645434.aspx)无模式对话框在关闭之前不会阻止执行。您可以通过此功能重复使用与`DialogBox`.

# django-nose - Django-nose 在测试运行期间不创建仅测试模型

> ID：11730874
> 
> 赞同：8
> 
> 时间：2012-07-30T22:55:34.940
> 
> 标签：django-nose

我安装了 django-nose 1.0 作为 Django 1.3.1 项目的测试运行程序。我正在遵循[pypi 页面上](http://pypi.python.org/pypi/django-nose)有关仅测试模型的说明。

这是我的 settings.py testrunner 配置：

`TEST_RUNNER = 'django_nose.NoseTestSuiteRunner'`

我已经使用这个 testrunner 运行了几个月的测试没有问题。现在我正在尝试测试一个抽象类，并且我正在使用仅测试模型，但是我编写的特定测试会引发错误。

根据文档，我只需要将测试类包含在测试期间导入的文件之一中。我将测试放在“测试”文件夹中，并分解为几个较小的测试文件。这是我的测试/model_tests.py（模型和应用程序出于工作原因故意重命名）：

```
from django.tests import TestCase
from myapp.models import AbstractFoo

class Foo(AbstractFoo):
    pass

class TestFoo(TestCase):
    def setUp(self):
        self.foo = Foo.objects.create(name="Tester", 
                                      description="This is a test", ...)
    ... [tests follow] 
```

我在 setUp 的第一行收到一个错误：

```
DatabaseError: relation "tests_foo" does not exist
LINE 1: INSERT INTO "tests_foo" ("name", "description", "display... 
```

如果我在测试中设置一个断点并检查数据库，则表“tests_foo”（或任何名称中带有“foo”的表）不存在。

关于为什么只测试模型没有加载的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-07T19:44:58.803

是的，似乎这仍然是一个问题。用 django==1.6 和 django-nose==1.3 看到它

一种解决方法是将所有模型放入`__init__.py`您的`tests/`文件夹中

GitHub 上的相关问题：[django-nose/issues/77](https://github.com/django-nose/django-nose/issues/77)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-30T15:50:15.473

您需要在测试数据库中创建模型，为此您需要手动生成迁移或在数据库中创建表。您可以检查我对第二个变体的实现[https://github.com/erm0l0v/django-fake-model](https://github.com/erm0l0v/django-fake-model)

此代码应该按您的预期工作：

```
from django.tests import TestCase
from myapp.models import AbstractFoo

from django_fake_model import models as f

class Foo(f.FakeModel, AbstractFoo):
    pass

@Foo.fake_me
class TestFoo(TestCase):
    def setUp(self):
        self.foo = Foo.objects.create(name="Tester", 
                                      description="This is a test", ...)
    ... [tests follow] 
```

# regex - Visual DataFlex Reg Exp

> ID：11730877
> 
> 赞同：2
> 
> 时间：2012-07-30T22:55:52.873
> 
> 标签：regex, dataflex

我正在尝试在我的简单应用程序中实现一个非常基本的正则表达式。有人可以给我一个例子吗？

我使用 obj-c、php 和 javascript 进行开发，所以通常 exp 类似于

myExp = /模式/

如何在 DataFlex 中做到这一点？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T17:33:09.360

您可以使用数据访问论坛中提供的包，或者只使用其他开发人员使用的 VB DLL（也在附加线程中讨论）：

[文本比较功能 - generalTextCompare.txt](http://support.dataaccess.com/Forums/showthread.php?1064-Text-compare-function-generalTextCompare.txt-%280-1%29&p=192911&highlight=regular%20expressions#post192911)

# javascript - 复制右键单击灯箱操作，例如在 github.com 上

> ID：11730879
> 
> 赞同：1
> 
> 时间：2012-07-30T22:56:00.907
> 
> 标签：javascript, ajax, colorbox, right-click

我正在尝试复制右键单击徽标以激活灯箱的操作（使用[Colorbox 的](http://www.jacklmoore.com/colorbox)内联功能）

这适用于正常的左键单击：

```
<h1 class="logo d1"><a href="#inline_content" class="inline"><?php bloginfo('name'); ?></a></h1> 
```

我想做的是：

```
 <h1 class="logo d1"><a href="<?php get_home_url(); ?>" class="inline"><?php bloginfo('name'); ?></a></h1> 
```

右键单击（可能）将href更改为#inline_content？

我对javascript有点陌生，也许我走错了路？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T14:45:00.650

如果您将 { open: true } 添加到 colorbox 语句，它似乎工作:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:57:57.850

您使用键码 3 进行右键单击。（这当然是使用 jQuery）

```
$('.logo').mousedown(function(e) {
    if (e.which === 3) {
        //alert('right clicked!');
        $(".inline").colorbox({ inline:true, width:"50%" }); 
    }
}); 
```

# c# - 没有 aspx 的自定义 DropDownList 多个项目

> ID：11730881
> 
> 赞同：0
> 
> 时间：2012-07-30T22:56:22.140
> 
> 标签：c#, telerik, custom-controls, radcombobox

我有一个`DropDownList`基于 Telerik的自定义控件`RadComoBox`。我目前正在尝试让这个自定义控件模拟另一个`RadComboBox`我在另一个页面上的另一个页面，该页面能够`RadComboBox`使用以下 aspx 在下拉列表中显示 UserFullName, (Company)：

```
 <telerik:RadComboBox ID="rcbUsers" runat="server" Width="250px" DropDownWidth="300px" OnSelectedIndexChanged="rcbUsers_SelectedIndexChanged"
                                         HighlightTemplatedItems="true" AutoPostBack="true" Height="400px">
                        <HeaderTemplate>
                            <div>
                                Full Name (Company)
                            </div>
                        </HeaderTemplate>
                        <ItemTemplate>
                            <div>
                                <b><%# DataBinder.Eval(Container.DataItem, "FullNameLastFirst") %></b>&nbsp;
                                (<%# DataBinder.Eval(Container.DataItem, "Company") %>)
                            </div>
                        </ItemTemplate>
                    </telerik:RadComboBox> 
```

无论如何，我是否可以在 C# 代码中为我的自定义控件模仿这个？除了标签之外，我不需要任何 aspx 是一个要求：

`<cc1:UserListBox ID="rcbUserTrained" runat="server" OnPreRender="rcbUserTrained_PreRender"/>`

这可以在自定义控件的数据绑定或呈现中执行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:05:57.027

I solved this awhile ago, basically I created a new class called `UserListBoxColumns` that inherits `ITemplate`. I defined my column structure there and bound the data and built it into my custom `radcombobox` by overrideing the `CreateChildControls()` method where I assigned the appropriate header/itemtemplate/footer into the comobox:

```
rcbUserList.HeaderTemplate = new UserListBoxColumns(ListItemType.Header);
rcbUserList.ItemTemplate = new UserListBoxColumns(ListItemType.Item);
rcbUserList.FooterTemplate = new UserListBoxColumns(ListItemType.Footer); 
```

If you're interested email me and I can provide more details.

# recent-file-list - MS 应用程序“最近的文件”概述中的强大功能

> ID：11730888
> 
> 赞同：1
> 
> 时间：2012-07-30T22:57:20.430
> 
> 标签：recent-file-list

我一直在 MS Paint（MS Paintbrush 的继任者）中查看图像文件“ *SomeName.bmp ”。*然后，在关闭 Paint 会话后，我在它背后通过 Cygwin 命令更改了文件名

```
mv SomeName.bmp SomeName2012.bmp 
```

然后从 Windows 7 开始按钮，通过右键单击“画图”应用程序，我得到了它的“最近文件”列表。它仍然显示旧文件名“ *SomeName.bmp* ”。我点击打开那个，它自动找到了正确的文件“ *SomeName2012.bmp* ”来打开！

列表中的所有 MS VisualStudio 开发人员都可以使用这种智能`RecentFiles`，还是只有 MS Paint 对此非常聪明？

# php - PHP 填充图像

> ID：11730889
> 
> 赞同：0
> 
> 时间：2012-07-30T22:57:23.710
> 
> 标签：php, if-statement

我正在寻找一个包含图像的文件夹并让php确定它们的大小，然后根据宽度或高度是否更高来编写它们的代码。

```
<?php

    for($i = 1; $i <= 5; $i++)
    {
        $filename = $i.".png";
        list($width, $height) = getimagesize($filename);
        if($width > $height)
        {
            echo '<img src="' .$filename. '" width="' .$width. '" height="75px" />';
            break;
        }
        elseif ($height > $width)
        {
            echo '<img src="' .$filename. '" width="75px" height="' .$height. '" />';
            break;
        }
        else
        {
            echo '<img src="' .$filename. '" width="' .$width. '" height="' .$height. '" />';
            break;
        }
    }

?> 
```

问题是，它在“if”语句之后编写代码。我不确定我是否编码错误。有没有更好的方法来做我想做的事情？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:04:33.860

删除`break;`每个 if 之后的语句，除非您希望它仅在循环一次后退出 for 循环，我认为您不会这样做。

```
<?php

for($i = 1; $i <= 5; $i++)
{
    $filename = $i.".png";
    list($width, $height) = getimagesize($filename);
    if($width > $height){
        echo '<img src="' .$filename. '" width="' .$width. '" height="75px" />';
    }elseif ($height > $width){
        echo '<img src="' .$filename. '" width="75px" height="' .$height. '" />';
    }else{
        echo '<img src="' .$filename. '" width="' .$width. '" height="' .$height. '" />';

    }
}

?> 
```

# mysql - 如何在 JOIN 的 ON 语句中使用 MATCH？

> ID：11730892
> 
> 赞同：0
> 
> 时间：2012-07-30T22:57:49.350
> 
> 标签：mysql, join, left-join, match

我正在尝试在 LEFT JOIN 上使用 MATCH 语句，但我不断收到：

```
 Incorrect arguments to AGAINST 
```

这就是我正在尝试的：

```
SELECT *
FROM Posts
LEFT JOIN `Follow_Searches` 
ON MATCH(`Posts`.`B`) AGAINST (`Follow_Searches`.`B`) 
```

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:02:41.440

那是做不到的。从[手册](https://dev.mysql.com/doc/refman/5.6/en/fulltext-search.html#function_match)：

> 使用 MATCH() ... AGAINST 语法执行全文搜索。MATCH() 采用逗号分隔的列表来命名要搜索的列。AGAINST 接受一个要搜索的字符串和一个可选的修饰符，指示要执行的搜索类型。**搜索字符串必须是文字字符串，而不是变量或列名。**

强调我的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:04:54.400

JOINing 数据，您必须在关键字 ON 之后指定将要连接数据的字段（例如 ON table1.id = table2.id）。

也许在您的情况下，您应该进行笛卡尔乘法并在 WHERE 中使用 MATCH-AGAINST 或其他比较函数。

# c++ - 按键值搜索无序二叉树

> ID：11730898
> 
> 赞同：1
> 
> 时间：2012-07-30T22:58:27.140
> 
> 标签：c++, tree, binary-tree

我之前发布了一个与此主题相关的问题，但我也无法弄清楚这一点。我正在尝试通过键值搜索无序二叉树并通过递归函数返回其关联值。

该类具有以下形式：

```
 Class Node
  {
     private:
       Node *leftChild;
       Node *rightChild;
       int key;
       int value;
 } 
```

每个变量都有相关的 get 方法。所以我基本上想搜索二叉树并在我到达正确的节点后返回它的值。

到目前为止，这是我的尝试，我认为我非常接近：

```
int preOrder(Node *node, int key)
{
   if(node->getKey() == key)
     return node->getValue();

  Node* leftNode = node->getLeft();

  if(leftNode != NULL)
  {
    return preOrder(leftNode, key);
  }

  Node* rightNode = node->getRight();

  if(rightNode != NULL)
  {
    return preOrder(rightNode, key);
  }

  //I know a return statement needs to be placed here
  //in case both pointers are NULL in order to return to the previous
  //node in the tree, but I'm not sure how to do this...
} 
```

有人有建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:21:36.890

干得好。这包括回答您最后一个问题的代码，已修改为支持键/值节点而不仅仅是值节点。此外，通过这些更改，返回指向节点的指针而不是它包含的值是有意义的，所以我更新最低也是这样做的。

```
template <typename KeyT, typename ValueT>
class Node
{
public:
    Node(KeyT k, ValueT v)
    {
        key = k;
        value = v;
        right = NULL;
        left = NULL;
    }

    Node<KeyT, ValueT> * lowest()
    {
        Node<KeyT, ValueT> * v = this;

        if (right != NULL)
            if (v->value > left->value) v = left;
        if (left  != NULL)
            if (v->value > right->value) v = right;

        return v;
    }

    Node<KeyT, ValueT> * searchByKey(KeyT k)
    {
        if (key == k)
            return this;

        Node<KeyT, ValueT> * n = NULL;

        if (left != NULL)
            n = left->searchByKey(k);
        if (n != NULL) return n;
        if (right!= NULL)
            n = right->searchByKey(k);
        if (n != NULL) return n;

        return NULL;
    }

    Node<KeyT, ValueT> * getRight()
    {
        return right;
    }

    Node<KeyT, ValueT> * getLeft()
    {
        return left;
    }

    void setRight(Node<KeyT, ValueT> * nright)
    {
        right = nright;
    }

    void setLeft(Node<KeyT, ValueT> * nleft)
    {
        left = nleft;
    }

    KeyT getKey()
    {
        return key;
    }

    ValueT getValue()
    {
        return value;
    }

private:
    KeyT   key;
    ValueT value;

    Node<KeyT, ValueT> * right;
    Node<KeyT, ValueT> * left;
}; 
```

查看示例输出：http: [//ideone.com/l5ZNc](http://ideone.com/l5ZNc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:05:08.960

是的，你很接近。当您没有找到钥匙时，您需要弄清楚要返回什么，因为这就是阻止您完成的原因。请注意，如果左节点不为 NULL，您将永远不会检查右节点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T23:07:04.147

```
 int value=NULL;
    void preOrder(Node *node, int key)
    {
       if (node!=NULL){
          if(node->getKey() == key)
            value=node->getValue();

          preOrder(node->getLeft(),key);
          preOrder(node->getRight(),key); 
       }     
    } 
```

# embedded - 硬件要求自动售货机？

> ID：11730899
> 
> 赞同：2
> 
> 时间：2012-07-30T22:58:39.353
> 
> 标签：embedded, hardware

我想从头开始创建自己的自动售货机。但没有金钱方面。只是一个基本的机器，一个人必须选择一个数字，然后适当的项目就会从机器中出来。

我需要什么硬件？有人可以指出我开始使用这个的方向吗？我完全迷失了，无法用谷歌找到任何合适的东西......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:20:57.400

你的意思是那些带有小旋转线圈的那些，它转动一整圈并将一包好吃的东西或一些新使用的内裤放入滑槽？

好吧，在预算上，我会去查找使用 8 段显示驱动程序和数字键盘的 Arduino 项目。您可能需要两个 8 段单元 - 一个用于 A/B/C 等，另一个用于 1/2/3。也许与防盗警报有关的东西会合适？

您还需要一些步进电机和驱动器。您可以将电机从旧的 3.5 英寸软盘驱动器中拉出。由于您一次只需要驱动一个电机，您可以将相关的步进电机线馈入单个驱动器芯片，并使用一些逻辑线选择器来激活相应的线。

大概你可以把你的电机排列成一个网格，并有两个选择电路——一个用于行，一个用于列。您可能需要使用继电器而不是逻辑门，具体取决于电机需要多少电流。我是一个电子爱好者，没有时间真正开始这些项目，所以请接受我的建议...

如果您只是私下做这件事并且没有 Arduino 开发板，那么使用新的 Raspberry-Pi 构建它可能更具成本效益……尽管那是一台成熟的计算机，并且可能无法胜任这项任务.

对于线圈，我想你可以去找一家工程制造商，让他们用不锈钢给你做一些……但是由于你的预算有限，你可以自己动手——绕一些硬线一个大纸板卷什么的。在新西兰，我们几乎使用镀锌“8 号”电线。如果您需要食品级卫生，不建议这样做！

哦，我想你也需要一个投币槽机制……看看 DIY 视频街机游戏亚文化。你应该能够找到接受硬币的东西。尽管接受多种面额并给予适当的更改将是一个比他们习惯的更高级的单位。

听起来是个有趣的项目。希望我给了你一些有用的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T16:49:29.590

不错的项目，我也一直想要一个！

浏览一下 hackaday.com 和危险的原型，以及使用所有原则（用户输入、机制、执行器、控制器）的大量项目。有无数种方法可以给这只猫剥皮，这取决于你的心情和时间/预算等。

同样值得考虑重新利用/回收旧硬件，在 eBay 和任何附近的垃圾箱/旧货店中寻找可以满足您的目的的硬件 - 从您可以修理/修改的实际旧自动售货机到儿童玩具，应有尽有被黑客入侵捐赠机制、按钮等。计算机打印机和 CD/DVD 驱动器是移动部件和控制电子设备的良好来源。

控制方面，arduino 是当今明显的默认选择，但还有很多其他选项（PIC、MSP430 是两个明显的竞争者，raspberryPi 有点矫枉过正但在预算之内），如果你希望学习一些有用的东西，那么 arduino 不是与在其中一种替代方案上用 C 编码一样可取。

# knockout.js - 加载时 Knockout JS 渲染

> ID：11730900
> 
> 赞同：1
> 
> 时间：2012-07-30T22:58:43.843
> 
> 标签：knockout.js, loading, render

如果您有一个列表和一个计数标签。当每个项目被推入视图模型数组时，如何实时渲染每一行并使用新计数增加标签？

对我来说，显示的列表仍然是空的，计数为 0，整个 UI 被阻塞，而 viewmodel 数组被填充，然后当每个项目被推入数组时，列表中的所有行都会突然显示最终数字在计数标签中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T07:42:47.943

您的 UI 被阻塞是非常合乎逻辑的，因为 JavaScript 是单线程的。因此，使用 foreach 将阻止脚本执行的其余部分。

对此的快速解决方法是使用 setTimeout 来延迟代码块的执行。例如，如果您使用：

```
for (var i=0;i< totalGifts;i++) {
    setTimeout(function(){
        self.gifts.push({name: "New Gift " + i, price: "New Price: " + i});
    },1);            
} 
```

每次更新都会延迟 1 毫秒并异步触发，因此不会阻塞您的 UI。我已经更新了你的小提琴，[检查一下](http://jsfiddle.net/YnHQj/20/)。

# android - Android：简单的计时器

> ID：11730902
> 
> 赞同：27
> 
> 时间：2012-07-30T22:59:30.830
> 
> 标签：android, timer

我有一个带有一个 TextView 和两个按钮的简单程序：Button1 和 Button2。

单击按钮 1 将启动一个计数器，每 1 秒增加 1 并在 TextView 上显示结果；叮当按钮 2 将停止它。这是我的 Button1 代码的一部分。但它不起作用。

```
 Timer T=new Timer();
    T.scheduleAtFixedRate(new TimerTask() {         
            @Override
            public void run() {
                myTextView.setText("count="+count);
                count++;                
            }
        }, 1000, 1000); 
```

我知道使用 Thread 有一些类似的问题，但似乎他们没有提到停止计数器。

任何建议都非常感谢。

**添加：**

你好，我只是从一个更大的程序中缩短了我的代码，但它仍然崩溃了：

```
package com.example.hello;
import java.util.Timer;
import java.util.TimerTask;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.widget.TextView;
public class MainActivity extends Activity {
    TextView myTextView;
    int count=0;
    Timer T;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        myTextView=(TextView)findViewById(R.id.t);
        T=new Timer();
        T.scheduleAtFixedRate(new TimerTask() {         
            @Override
            public void run() {
                myTextView.setText("count="+count);
                count++;                
            }
        }, 1000, 1000);       
    }
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

日志文件（我不想发布，因为它太长但有人要求它）：

```
07-28 17:35:07.012: W/dalvikvm(11331): threadid=7: thread exiting with uncaught exception (group=0x4001d800)
07-28 17:35:07.016: E/AndroidRuntime(11331): FATAL EXCEPTION: Timer-0
07-28 17:35:07.016: E/AndroidRuntime(11331): android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.view.ViewRoot.checkThread(ViewRoot.java:2802)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.view.ViewRoot.requestLayout(ViewRoot.java:594)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.view.View.requestLayout(View.java:8125)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.view.View.requestLayout(View.java:8125)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.view.View.requestLayout(View.java:8125)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.view.View.requestLayout(View.java:8125)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.widget.RelativeLayout.requestLayout(RelativeLayout.java:254)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.view.View.requestLayout(View.java:8125)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.widget.TextView.checkForRelayout(TextView.java:5378)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.widget.TextView.setText(TextView.java:2688)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.widget.TextView.setText(TextView.java:2556)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at android.widget.TextView.setText(TextView.java:2531)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at com.example.hello.MainActivity$1.run(MainActivity.java:21)
07-28 17:35:07.016: E/AndroidRuntime(11331):    at java.util.Timer$TimerImpl.run(Timer.java:289) 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-07-30T23:06:01.300

你可以介绍flag。类似的东西`isPaused`。每当按下“暂停”按钮时触发此标志。检查计时器任务中的标志值。成功。

```
Timer T=new Timer();
T.scheduleAtFixedRate(new TimerTask() {         
        @Override
        public void run() {
            runOnUiThread(new Runnable()
            {
                @Override
                public void run()
                {
                    myTextView.setText("count="+count);
                    count++;                
                }
            });
        }
    }, 1000, 1000);

 onClick(View v)
 {
      //this is 'Pause' button click listener
      T.cancel();
 } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-30T23:06:13.327

查看[这个](https://stackoverflow.com/a/8898116/1007273)使用[Chronometer](http://developer.android.com/reference/android/widget/Chronometer.html)类的示例：[http ://android-er.blogspot.com/2010/06/android-chronometer.html](http://android-er.blogspot.com/2010/06/android-chronometer.html)

使用 Chronometer 类将节省您自己管理线程的时间。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-10-12T09:35:58.197

如果您想显示运行时钟，这是完美的解决方案。

```
private void startClock(){
    Thread t = new Thread() {

        @Override
        public void run() {
            try {
                while (!isInterrupted()) {
                    Thread.sleep(1000);
                    runOnUiThread(new Runnable() {
                        @Override
                        public void run() {
                            Calendar c = Calendar.getInstance();

                            int hours = c.get(Calendar.HOUR_OF_DAY);
                            int minutes = c.get(Calendar.MINUTE);
                            int seconds = c.get(Calendar.SECOND);

                            String curTime = String.format("%02d  %02d  %02d", hours, minutes, seconds);
                            clock.setText(curTime); //change clock to your textview
                        }
                    });
                }
            } catch (InterruptedException e) {
            }
        }
    };

    t.start();
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-06-26T01:04:17.407

这种方式就简单多了。这是 android 开发者网站上提供的一项功能。[关联](https://developer.android.com/reference/android/os/CountDownTimer)

```
public void initCountDownTimer(int time) {
    new CountDownTimer(30000, 1000) {

        public void onTick(long millisUntilFinished) {
            textView.setText("seconds remaining: " + millisUntilFinished / 1000);
        }

        public void onFinish() {
            textView.setText("done!");
        }
    }.start();
} 
```

Kotlin 版本

```
fun initCountDownTimer(time: Int) {
object : CountDownTimer(30000, 1000) {
    override fun onTick(millisUntilFinished: Long) {
        textView.setText("seconds remaining: " + millisUntilFinished / 1000)
    }

    override fun onFinish() {
        textView.setText("done!")
    }
}.start() 
```

}

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-30T23:11:00.587

帕维尔在停止它方面走在了正确的轨道上，但他的回答是浪费，因为它不会停止计时器。在他发布的部分执行此操作，并添加了 else 语句：

```
if(!isPaused)
        {
            myTextView.setText("count="+count);
            count++;                
        } else {
            cancel();//adding this makes it actually stop
        } 
```

哦，你说它崩溃了。我们不知道它为什么会崩溃，所以不幸的是，除非我们看到更多代码和错误，否则我们无法真正帮助弄清楚它为什么会这样做。

很好@yorkw问题显然在于它开始运行时试图做的事情。由于它说“Timer-0”，这意味着它永远不会正式启动并且卡在那个部分。运行线程的第一条规则，**永远不要从 UI 外部更改 UI 元素**。我建议`runOnUiThread`像 york 说的那样使用。这是有关如何使用它的链接：[runOnUiThread](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)。可以肯定`TimerTask`的是它是可运行的，这意味着它在单独的线程上运行。至少那是我在文档上注意到的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-26T13:20:22.430

正如[@hovanessyan](https://stackoverflow.com/a/11730958/4464562)建议的那样：您可以使用[Chronometer](https://developer.android.com/reference/android/widget/Chronometer.html)类。例如，如下（使用 Kotlin，Java 模拟）：

```
class ChronometerToggler: Fragment() {
    private lateinit var chronometer: Chronometer
    private var isChronometerRunning = false
    private lateinit var toggleButton: FloatingActionButton

    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {
        val view = inflater.inflate(R.layout.my_layout, container, false)
        chronometer = view.findViewById(R.id.chronometer)
        toggleButton = view.findViewById(R.id.toggle_button)
        toggleButton.setOnClickListener {
            onToggleButtonPressed()
        }
        return view
    }

    private fun onToggleButtonPressed() {
        isChronometerRunning = !isChronometerRunning
        if (isChronometerRunning) {
            chronometer.base = SystemClock.elapsedRealtime()
            chronometer.start()
        }
        else {
            chronometer.stop()
        }
    }
} 
```

在`my_layout.xml`：

```
[...]
     <Chronometer android:id="@+id/chronometer" [...]/>
[...] 
```

# cocoa - 如何实现具有最小和最大尺寸的 3 窗格 NSSplitView？

> ID：11730905
> 
> 赞同：8
> 
> 时间：2012-07-30T23:00:13.670
> 
> 标签：cocoa, nssplitview

我想实现一个 3 窗格垂直`NSSplitView`（非常类似于 Mail.app）。我不确定从哪里开始。我很确定我需要实现 a `NSSplitViewDelegate`，但我不确定哪些方法和/或它们的实现。

我想要的布局如下：

```
+----------+------------------+------------------------------------+
|          |                  |                                    |
|          |                  |                                    |
|          |                  |                                    |
|          |                  |                                    |
|  Pane 1  |      Pane 2      |               Pane 3               |
|          |                  |                                    |
|          |                  |                                    |
|          |                  |                                    |
|          |                  |                                    |
|          |                  |                                    |
+----------+------------------+------------------------------------+ 
```

我想为每个窗格实现以下约束：

*   窗格 1：最小 140pt。最大：400pt。
*   窗格 2：最小 250pt。
*   窗格 3：最低 400pt。

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-13T13:07:14.487

To enforce a minimum size, check out the [BESplitViewConstraintEnforcer](https://github.com/incbee/BESplitViewConstraintEnforcer) utility class we created.

By the way: if you want to avoid nesting split views and instead add an additional pane in Interface Builder, drag the new view into the split view object, as shown in the screenshot below.

![Screenshot](../Images/2c952018061e1e0ed80a1913f1699a68.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-03-20T22:32:05.757

在 Xcode 8.2.1 中非常简单

1.  只需`Split View Controller`在 Interface Builder 中添加一个。
2.  添加一个额外的`View Controller`.
3.  Crtl + 鼠标按下`Split View Controller`并拖动到附加的`View Controller`.
4.  选择`split items`。

而已。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-19T11:06:46.787

实际上，HTH 启发了我在 Interface Builder 中尝试第三种可能性，结果证明效果很好。特别是，移动一个分隔符不会在其他地方进行任何意外更改，如果您嵌套拆分视图，这很容易发生。

*   添加一个`NSSplitView`到你的窗口，
*   添加一个`NSView`（IB 中的自定义视图）作为拆分视图的子项。您最终会得到一个包含三个而不是两个子视图的拆分视图。

![它在 IB 对象列表中的样子](../Images/27059c498d9ca90b43984058bdf004fc.png)

如果您将另一个添加`NSSplitView`为孩子，则同样适用，尽管您必须小心嵌套的拆分视图如何相互影响。上图显示了它在界面生成器中的外观，第二张显示了模拟器中的结果。

![结果](../Images/4fbd4c242a430519ad54c3305b713cce.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T08:47:07.893

我猜你确实解决了这个问题。无论如何，有两种方法。第一个类似于上面的答案，将一个 splitview 拖动到您想要的位置，然后将第二个 splitview 拖动到其中一个容器内（ splitview 的子视图）。视图层次结构就像

```
Window 
Window containerview
        Splitview
            Containerview_left | containerview_right
                                    Splitview
                                        Containerview_left | containerview_right 
```

如果您通过代码，则创建一个拆分视图，将其添加为窗口视图的子视图。然后，通过使用 [splitview addsubview] 添加它们来创建拆分视图子视图，如果添加三个子视图，则有两个分隔符。层次结构不同。

```
Window  Window containerview
         Splitview
             Containerview_ind(0)| Containerview_ind(1) | Containerview_ind(2) 
```

这意味着，如果你想找到一个子视图，你必须知道你是如何创建它的。

高温高压

# c++ - Metro 应用程序上的可中断（阻塞）睡眠：CreateEventEx 用于中断（例如 Ctrl + C）WaitForSingleObjectEx

> ID：11730907
> 
> 赞同：0
> 
> 时间：2012-07-30T23:00:27.967
> 
> 标签：c++, c, windows-runtime, sleep, interrupt

我正在尝试在 Metro App 上等待 Ctrl + C 等中断。

我可以通过`WaitForSingleObjectEx(GetCurrentThread(), ms, TRUE)`. 这将阻塞当前线程，直到 'ms' mSec。虽然它设置为 Alertable，但如果我按 Ctrl + C，它不会退出“睡眠”。

所以我试图实现，睡眠直到'ms'毫秒，或者如果用户按下 Ctrl + C，然后出来并继续下一条语句。不知道如何为中断创建事件（sigint 事件）或在中断时等待。

# c# - 计算布尔数组中真（或假）元素的数量？

> ID：11730912
> 
> 赞同：26
> 
> 时间：2012-07-30T23:01:05.033
> 
> 标签：c#, arrays, boolean

假设我有一个充满布尔值的数组，我想知道有多少元素是真的。

```
private bool[] testArray = new bool[10] { true, false, true, true, false, true, true, true, false, false };

int CalculateValues(bool val)
{
    return ???
} 
```

如果 val 为真，CalculateValues 应返回 6，如果 val 为假，则应返回 4。

明显的解决方案：

```
int CalculateValues(bool val)
{
    int count = 0;
    for(int i = 0; i<testArray.Length;i++)
    {
        if(testArray[i] == val)
            count++;
    }
    return count;
} 
```

有没有“优雅”的解决方案？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-07-30T23:04:45.277

```
return testArray.Count(c => c) 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-07-30T23:02:14.717

使用 LINQ。您可以`testArray.Where(c => c).Count();`进行真实计数或`testArray.Where(c => !c).Count();`用于错误检查

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-07-30T23:06:08.790

您可以使用：

```
int CalculateValues(bool val)
{
    return testArray.Count(c => c == val);
} 
```

这将根据您的参数 处理`true`和检查。`false``val`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-30T23:08:17.883

尝试这样的事情：

```
bool[] testArray = new bool[10] { true, false, true, true, false, true, true, true, false, false };
bool inVal = true;
int i;

i = testArray.Count(ai => ai == inVal); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-10-21T11:02:59.037

虽然`testArray.Count(c => c)`在功能上是正确的，但它并不直观，并且存在一些后来的开发人员会`c => c`认为它没有做任何事情的风险。

这可以通过使用有意义的名称单独声明 lambda 函数来消除风险：

```
Func<bool, bool> ifTrue = x => x;
return testArray.Count(ifTrue); 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-07-31T00:11:44.033

我喜欢这个：

```
int trueCount = boolArray.Sum( x  => x ? 1 : 0 ) ; 
```

# php - 当整个字符串用括号括起来时如何解析json

> ID：11730916
> 
> 赞同：0
> 
> 时间：2012-07-30T23:01:57.183
> 
> 标签：php, jquery, json

正如我所期望的，我的 json 作为关联数组从我的 PDO MySQL 查询中返回，但整个字符串被两个封闭的括号包围。我不确定如何绕过括号进行解析。这是一个类似于需要解析的json的简短示例。关于我可能采取的方法或如何开始的任何想法？

```
{
    "A": {
        "lat": "37.76506200",
        "lng": "-122.4196940"
    },
    "B": {
        "lat": "37.75225400",
        "lng": "-122.4184660"
    },
    "C": {
        "lat": "37.72198087",
        "lng": "-122.4474142"
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:06:17.027

使用*PHP*时，请[`json_decode`](http://php.net/json_decode)考虑：

```
$array = json_decode($string, true); // where $string is your returned value
echo $array['C']['lng']; // will print -122.4474142 
```

* * *

使用*jQuery*，您可以这样做：

```
var res = $.parseJSON(string);
console.log(res.C.lng); // returns -122.4474142 
```

最后使用*vanilla javascript*（如果支持 JSON）

```
var res = JSON.parse(string);
console.log(res.C.lng); 
```

# javascript - 将随机类应用于元素

> ID：11730917
> 
> 赞同：0
> 
> 时间：2012-07-30T23:02:07.617
> 
> 标签：javascript, jquery, hyperlink

> **可能重复：**
> [将随机类应用于指定的每个元素](https://stackoverflow.com/questions/7686592/apply-a-random-class-to-every-element-specified)

是否可以获取页面上的所有“a”元素并将“.pink”、“.blue”或“.yellow”类随机应用于每个带有javascript的a元素？我想在我的页面上有不同颜色的链接，但同样随机。我不知道该怎么做，所以我没有任何脚本可以提供。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:13:05.397

当您按照标签中的说明使用 jQuery 时，这是一个可能的解决方案：

```
// when document is loaded
$(document).ready(function () {

    // set classes
    var classes     = new Array ('pink', 'blue', 'green');

    // calculate length once, as this will never change
    var length      = classes.length;

    // select all a-tags
    var links       = $('a');

    // loop through all a-tags and apply color randomly
    $.each( links, function(key, value) {
        // get random value/class-name from array and add it using the addClass function
        $(value).addClass( classes[ Math.floor ( Math.random() * length ) ] );
    });

}); 
```

评论应该清楚它的作用。

[试试看](http://jsfiddle.net/b7xv8/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T23:13:55.753

您可以将您的类放入数组中，然后遍历“A”标签并为每个标签分配随机索引（使用 Math.random()）：

```
var colorClasses = ['pink', 'blue', 'yellow'];
$("a").each(function(e){
    classIndex = Math.floor(Math.random() * colorClasses.length);
    $(this).addClass(colorClasses[classIndex]);
});​ 
```

现场演示：http: [//jsfiddle.net/ALngA/2/](http://jsfiddle.net/ALngA/2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-30T23:04:10.270

`Math.random()`将返回一个介于 0 和 1 之间的随机浮点数。要将其转换为数组索引，请将其乘以数组的大小并向`Math.floor`下取整：

```
var arr = ['red','green','blue'];
var idx = Math.floor(Math.random() * arr.length);

alert(arr[idx]); 
```

[数学随机（）](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/random)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T23:04:15.417

```
var colors = ['pink', 'blue', 'yellow']
$('a').each(function () {
  var rand = ~~(Math.random() * colors.length)
  $(this).addClass(colors[rand])
}) 
```

# javascript - 如何检查链接按钮是否被点击

> ID：11730920
> 
> 赞同：0
> 
> 时间：2012-07-30T23:02:27.770
> 
> 标签：javascript, jquery

我有`LinkButton`一个

```
 <asp:LinkButton ID="lnkbuton" runat="server" OnClick="lnck" Text="hello"> 
```

实际上我有一个 LinkBut​​ton 和一个 TabContainer 有两个选项卡。当用户单击选项卡时，我正在清除 GridView 中的数据，但是当用户单击 LinkBut​​ton 时，我不想清除数据。因此，我想查找是否单击了 LinkBut​​ton。

我做了这样的事情。

```
function onBeginRequest(sender, args) {
   $(document).ready(function(){
   var shHide = "0";

    $("#lnkbuton").click(function() {
       shHide="1";
      alert("clcik")
    });

    if (shHide == "0") {
        ClearHideElement();
    }
})

} 
```

但这不起作用。此外，警报永远不会被执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:06:05.307

aspx 页面中的控件生成自己的 ID，它们并不总是使用您给它们的 ID：http: [//msdn.microsoft.com/en-us/library/1d04y8ss.aspx](http://msdn.microsoft.com/en-us/library/1d04y8ss.aspx)

试试这个：

```
$("#<%= lnkbuton.ClientID %>").click(function() {
       shHide="1";
      alert("clcik")
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:05:03.050

检查事件的目标，如果不是`anchor`，请执行您的操作。

```
 $("#lnkbuton").click(function(event) {
    if (event.target != this) {
         shHide="1";
        alert("clcik")
    }
}); 
```

* * *

## [事件.目标](http://api.jquery.com/event.target/)

> 目标属性可以是为事件注册的元素或它的后代。将 event.target 与 this 进行比较通常很有用，以确定是否由于事件冒泡而正在处理事件。当事件冒泡时，此属性在事件委托中非常有用。

# c++ - C++ 中使用的句柄

> ID：11730921
> 
> 赞同：0
> 
> 时间：2012-07-30T23:02:32.640
> 
> 标签：c++

我有一个关于 CreateMutex() 的问题

我正在处理图像数据，并对图像的不同旋转进行某些计算。我以 180 步（1° 步）旋转图像，由于除了写回结果之外它们彼此独立，因此我决定进行这个多线程（非常密集的计算，并且写入内存占用了很多时间的执行）。

我最初尝试使用允许线程写入或不写入的单个互斥锁，但这大大降低了我的性能（从 100% 的单线程时间，没有互斥锁，到大约 80% 的执行速度）。

然后我创建了一个 HANDLE 数组，每个像素一个（因为它是 656x480，它大约有 300k 个句柄）。这将我的代码改进到大约 15% 的执行时间（同时 7 个线程）。

现在，当我在任务管理器中看到这个时，我看到它有自己的类别，称为 Handles，它在 30k（只有一些程序和操作系统运行）之间，在我的代码运行时达到 350k。

这种行为是好的，还是不好的，应该改变，如果是，为什么以及如何改变？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:07:56.627

我会说使用 350k+ 句柄的*单个*进程太多了。（每个像素一个句柄，真的吗？）

如果您希望使用多个线程来提高应用程序的整体效率，那么最好减少这些线程之间的争用量。我不太确定您的应用程序在做什么，但是如果您正在创建单个源图像的 180 次不同旋转，那么您可能会考虑制作源图像的 N 个副本（其中 N 是您要运行的线程数） ，并让每个线程在自己的源图像副本上工作。这样你就根本不需要互斥体了，你会减少线程之间的争用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T02:46:57.743

您应该使用`CRITICAL_SECTION`，而不是互斥锁。他们要快得多。如果使用 初始化，您可以获得类似自旋锁的行为`InitializeCriticalSectionAndSpinCount()`。

就像其他人所说的那样，为每个像素设置一个互斥体是很疯狂的。你有多少线程？

您根本不需要任何锁定，您可以与 OpenMP 并行处理图像，而不是自己创建所有这些线程。OpenMP 的问题是，您可以有一个并行化的外部循环遍历输出图像的每一行，并在其中查看该行中的每个像素。现在你的输出是独立的。

要进行旋转，您需要从该输出像素的位置找到反向旋转的像素位置，然后对该位置的颜色值进行区域采样。这根本不应该是计算密集型的，特别是因为您只需为每个图像进行一次 sin 和 cos 计算（您的角度不会因每个像素而改变）。

所以，回顾一下……没有工作线程，没有互斥体，没有对 sin/cos 的冗余调用。您会惊讶于您的代码以多快的速度结束。

```
double sintheta = sin(theta);
double costheta = cos(theta);

#pragma omp parallel for 
for( int y = 0; y < height; y++ ) {
    RGB * inputRow = &inputImage[y * width];
    RGB * outputRow = &outputImage[y * width];

    for( int x = 0; x < width; x++ ) {
        // Whatever your rotation code should be.... =)
        double rotx = -((double)x - xCentre) * costheta;
        double roty = -((double)y - yCentre) * sintheta;

        // Interpolate colour from input image.  We've landed inside
        // a 2x2 square of pixels.  Take some of each.  I'll leave the
        // sampling to you...
        RGB val;
        // TODO

        // Output the rotated pixel without thread contention.
        outputRow[x] = val;
    }
} 
```

# java - Java：选择串口读取Arduino Uno

> ID：11730923
> 
> 赞同：0
> 
> 时间：2012-07-30T23:02:52.220
> 
> 标签：java, serial-port, arduino, rfid, rxtx

我正在尝试读取由视差 RFID 阅读器扫描并使用 Arduino 设备发送到计算机的[RFID标签号。](http://en.wikipedia.org/wiki/Radio-frequency_identification)我正在尝试使用从串行端口读取`RXTXCommDrive`，但问题是当 Arduino 连接到 PC 时，它连接到[COM3](http://en.wikipedia.org/wiki/COM_%28hardware_interface%29)，而当连接到笔记本电脑时，它连接到 COM4。有没有办法循环通过 COM 端口并找到正确的端口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T07:48:24.900

RXTX wiki 列出了两个列出可用端口的示例：

*   [http://rxtx.qbang.org/wiki/index.php/Discovering_comm_ports](http://rxtx.qbang.org/wiki/index.php/Discovering_comm_ports)
*   [http://rxtx.qbang.org/wiki/index.php/Discovering_available_comm_ports](http://rxtx.qbang.org/wiki/index.php/Discovering_available_comm_ports)

但是：如果你找到两个端口，你会怎么做？因此，无论如何您都应该使用一些配置文件。

第三种可能性是：大多数 USB 驱动程序允许将特定芯片分配给特定的 COM 端口 ID。对于使用 FT232R 芯片的 Arduino，有两种方法：通过驱动程序设置重新分配端口 ID，*或*通过注册表编辑重新分配一组端口 ID。

相关应用说明可在此处找到：

[http://www.ftdichip.com/Support/Documents/AppNotes.htm](http://www.ftdichip.com/Support/Documents/AppNotes.htm)

*   **AN_107** “*高级驱动程序选项*”
*   **AN_132** “*使用 Windows 注册表重新分配 COM 端口号*”

我确信较新的 Arduinos 的其他芯片具有类似的功能。

# php - 如何将 css 样式的 html 列表添加到 wordpress，可在仪表板中进行管理

> ID：11730926
> 
> 赞同：0
> 
> 时间：2012-07-30T23:03:25.263
> 
> 标签：php, css, wordpress, html-lists

我想向 WordPress 页面添加一项功能以显示一个简短的人员列表，就像这里看到的那样 - [http://www.blenderbox.com/company/team](http://www.blenderbox.com/company/team)

我已经在其他网站上通过使用 CSS 样式化列表来完成此操作。然而，这一次，它是给客户的，我不能相信他们复制和粘贴 a `<li>`，编辑名称、职位和 img 名称而不会弄乱它。

创建它以便可以轻松地将其减少/添加到 WordPress 仪表板中的最佳方法是什么？基本上，这样用户只需单击“添加人员”，然后在更新页面之前填写一些字段。

我是 WordPress 的新手（尽管我了解它是如何工作的），但我能够胜任编码，因此希望在正确的方向上提供丰富的信息就足够了。

谢谢，本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:16:37.293

使用类别。创建一个名为“人员”或“团队”的新类别或类似的东西。然后使用帖子标题作为他们的名字 - 任何其他信息都可以放在帖子中，然后将图像添加到特色图像中。

通过复制另一个模板文件并给它一个像这样的标题来命名它，为此页面创建一个新模板。

```
<?
/*
Template Name: About Us / Team / Whatever
*/
?> 
```

在页面中只调用你想要的信息，如下所示：

```
//Set up the Loop
<?php 
    global $post;
    $args = array (
    'category' => 4,
    'order' => 'ASC');  
        $teamposts = get_posts( $args );
        foreach( $teamposts as $post ) :    setup_postdata($post); ?>

//Call the information you want - put them in <li> if you need

<?php the_title();?>
    <?php the_excerpt();?> //OR the_content
<?php the_post_thumbnail('new-image-size');?>

//Close the loop
<?php endforeach; ?> 
```

然后，您可以继续调用您想要的任何其他内容，或者在同一页面上运行另一个循环来调用其他信息。

要获得正确大小的缩略图，您已经调用了“new-image-size” - 要进行设置，请在您的 functions.php 文件中添加这样的一行。

```
// Post Thumbnails
    add_theme_support( 'post-thumbnails' );

    // name of the thumbnail, width, height, crop mode
    add_image_size( 'front-page-services',  450, 270, true ); 
```

# sql - 如何从前 50 名中随机选择 8 首具有唯一 user_id 的歌曲？

> ID：11730942
> 
> 赞同：3
> 
> 时间：2012-07-30T23:05:14.857
> 
> 标签：sql, ruby-on-rails, ruby-on-rails-3, postgresql

我试图获得前 50 名的下载量，然后对 8 个结果进行洗牌（随机化）。另外，8 个结果必须是唯一的 user_id。到目前为止，我想出了这个：

```
Song.select('DISTINCT songs.user_id, songs.*').where(:is_downloadable => true).order('songs.downloads_count DESC').limit(50).sort_by{rand}.slice(0,8) 
```

我对此唯一的抱怨是，最后一部分`.sort_by{rand}.slice(0,8)`是通过 Ruby 完成的。有什么办法可以通过 Active Record 来完成这一切？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T00:40:47.857

我想知道该列是如何`user_id`出现在表格中的`songs`？这意味着您对于歌曲和用户的每种组合都有一行？在规范化模式中，这将是使用三个表实现的*n:m 关系：*

```
song(song_id, ...)
usr(usr_id, ...)    -- "user" is a reserved word
download (song_id, user_id, ...) -- implementing the n:m relationship 
```

您问题中的查询会产生不正确的结果。相同的`user_id`可以弹出多次。`DISTINCT`没有做你似乎期望的事情。您需要[`DISTINCT ON`](http://www.postgresql.org/docs/current/interactive/sql-select.html#SQL-DISTINCT)或其他一些方法，如[聚合](http://www.postgresql.org/docs/current/interactive/functions-aggregate.html)或[窗口函数](http://www.postgresql.org/docs/current/interactive/functions-window.html)。

您还需要使用子查询或[CTE](http://www.postgresql.org/docs/current/interactive/queries-with.html)，因为这不能一步完成。使用`DISTINCT`时不能同时使用`ORDER BY random()`，因为排序顺序不能与所规定的顺序不一致`DISTINCT`。这个查询当然不是微不足道的。

### 简单案例，前50首歌曲

如果您很高兴只选择前 50 首歌曲（不知道其中有多少重复的 user_id），那么这个“简单”的案例就可以了：

```
WITH x AS (
    SELECT *
    FROM   songs
    WHERE  is_downloadable
    ORDER  BY downloads_count DESC
    LIMIT  50
    )
    , y AS (
    SELECT DISTINCT ON (user_id) *
    FROM   x
    ORDER  BY user_id, downloads_count DESC -- pick most popular song per user
--  ORDER  BY user_id, random() -- pick random song per user
    )
SELECT *
FROM   y
ORDER  BY random()
LIMIT  8; 
```

1.  获得最高的 50 首歌曲`download_count`。用户可以多次出现。
2.  为每位用户选择 1 首歌曲。随机或最受欢迎的，在你的问题中没有定义。
3.  `user_id`随机选择现在不同的 8 首歌曲。

您只需要一个**索引**就`songs.downloads_count`可以快速：

```
CREATE INDEX songs_downloads_count_idx ON songs (downloads_count DESC); 
```

### 具有唯一 user_id 的前 50 首歌曲

```
WITH x AS (
    SELECT DISTINCT ON (user_id) *
    FROM   songs
    WHERE  is_downloadable
    ORDER  BY user_id, downloads_count DESC
    )
    , y AS (
    SELECT *
    FROM   x
    ORDER  BY downloads_count DESC
    LIMIT  50
    )
SELECT *
FROM   y
ORDER  BY random()
LIMIT  8; 
```

1.  `download_count`获取每位用户最高的歌曲。每个用户只能出现一次，所以它必须是最高的一首歌`download_count`。
2.  从中选出最高的 50 个`downloads_count`。
3.  从中随机选择 8 首歌曲。

使用大表，性能会**很差**，因为您必须先为*每个*用户找到最佳行，然后才能继续。多列索引会有所帮助，但仍然不会很快：

```
CREATE INDEX songs_u_dc_idx ON songs (user_id, downloads_count DESC); 
```

* * *

### 一样，更快

**如果**`user_id`热门歌曲中的重复s 可以**预见的很少**，您可以使用一个**技巧**。从热门下载中挑选出足够多的下载量，这样具有独特`user_id`性的前 50 名肯定就在其中。在这一步之后，像上面一样继续。对于大表，这会**快得多**，因为可以从索引顶部快速读取前 n 行：

```
WITH x AS (
    SELECT *
    FROM   songs
    WHERE  is_downloadable
    ORDER  BY downloads_count DESC
    LIMIT  100 -- adjust to your secure estimate
    )
    , y AS (
    SELECT DISTINCT ON (user_id) *
    FROM   x
    ORDER  BY user_id, downloads_count DESC
    )
    , z AS (
    SELECT *
    FROM   y
    ORDER  BY downloads_count DESC
    LIMIT  50
    )
SELECT *
FROM   z
ORDER  BY random()
LIMIT  8; 
```

上面简单案例的索引足以使其几乎与简单案例一样快。

如果前 100 首“歌曲”中的不同用户少于 50 个，这将达不到要求。

所有查询都应适用于 PostgreSQL 8.4 或更高版本。

* * *

如果它必须更快，但是，创建一个包含预选前 50个的**物化视图，并定期重写该表或由事件触发。**如果你大量使用它*并且*桌子很大，我会去的。否则不值得开销。

### 通用的、改进的解决方案

[后来，我将这种方法形式化并进一步改进，以适用于 dba.SE](https://dba.stackexchange.com/q/18300/3684)的这个相关问题下的一整类类似问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T00:32:29.063

您可以按顺序使用 PostgreSQL 的`RANDOM()`函数，使其

```
___.order('songs.downloads_count DESC, RANDOM()').limit(8) 
```

虽然这不起作用，因为 PostgreSQL 需要`ORDER BY`在`SELECT`. 你会得到一个错误，比如

```
ActiveRecord::StatementInvalid: PG::Error: ERROR:  for SELECT DISTINCT, ORDER BY expressions must appear in select list 
```

*在 SQL （使用 PostgreSQL）*中完成你所要求的所有事情的唯一方法是使用子查询，这对你来说可能是也可能不是更好的解决方案。如果是，最好的办法是使用**[find_by_sql](http://apidock.com/rails/ActiveRecord/Base/find_by_sql/class)**写出完整的查询/子查询。

我很高兴能帮助提出 SQL，尽管现在您知道了`RANDOM()`，它应该是非常微不足道的。

# c# - 如何在 C# 中使数组值相等？

> ID：11730945
> 
> 赞同：1
> 
> 时间：2012-07-30T23:05:28.593
> 
> 标签：c#, equals, arrays

假设我有 2 个具有不同值的字符串数组：
`string[] sArray1 = new string[3]{"a","b","c"};
string[] sArray2 = new string[3]{"e","f","g"}`

我想让值`sArray1`等于`sArray2`（我知道我可以这样写）：`sArray1[0] = sArray2[0]; sArray1[1]= sArray2[1]; sArray1[2]=sArray2[2];`

对于 3 个值，这很容易，但如果我在一个数组中有 100 个值怎么办？有没有其他方法可以使数组值相等？

ps对不起我的英语不好:(

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-30T23:07:23.033

像这样的东西（有一点错误检查）：

```
 if (sArray2.Length == sArray1.Length)
        {
            sArray2.CopyTo(sArray1, 0);    
        } 
```

问候

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T23:10:52.313

我假设您想保留对 sArray1 中原始数组的引用？然后这样做： -

```
Array.Copy(sArray2, sArray1, sArray1.Length); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-15T06:30:11.097

如果您希望它们彼此独立运行，则可以使用 .Clone() 从 .NET 5.0 开始

```
string[] sArray1 = (string[])sArray2.Clone(); 
```

在上述情况下，如果您更改一个数组中的值，它不会影响另一个数组 - 这称为“浅拷贝”（也称为 val 拷贝）。如果您希望两个数组中的值相互关联（通常是不可取的），您可以执行如下简单的分配：

```
string[] sArray1 = sArray2; 
```

在这种情况下，如果您更改任一数组中的值，则另一个数组中的值将更新（也称为 ref 复制）。

# c# - 实体框架实体在保存时不自动填充对象

> ID：11730951
> 
> 赞同：0
> 
> 时间：2012-07-30T23:05:50.787
> 
> 标签：c#, asp.net, .net, entity-framework, entity-framework-4.1

我有以下课程：

```
public class Order
{
    public Order() { LineItems = new List<OrderLineItem>(); }
    public int OrderID { get; set; }
    ..  
    public virtual ICollection<OrderLineItem> LineItems { get; set; }
    ..
}

public class OrderLineItem
{
    public int OrderLineItemID { get; set; }

    public int ProductID { get; set; }
    public virtual Product Product { get; set; }

    public int Quantity { get; set; }

}

 public class Product
 {
    public int ProductID { get; set; }
    ...
 } 
```

当我坚持 Order 时，我已将 OrderLineItems 设置为适当的字段。但是，在我使用以下代码将其保存到数据库之后：

```
 public void SaveOrder(Order ord)
    {
        if (ord.OrderID == 0)
        {
            context.Orders.Add(ord);
        }
        else
        {
            var currentCat = context.Orders.Find(ord.OrderID);

            if (currentCat != null)
                context.Entry(currentCat).CurrentValues.SetValues(ord);
            else
                context.Entry(ord).State = EntityState.Modified;
        }
        context.SaveChanges();
    } 
```

OrderLineItem.Product 对象为空。它具有适当的 ProductID 集，但不填充实际产品。我尝试了一些类似于以下的不同映射，但我对实体框架有点陌生。

```
modelBuilder.Entity<OrderLineItem>()
        .HasRequired(c => c.Product); 
```

非常感激任何的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:21:38.970

我相信您还必须遍历产品并 Add() 它们。

# python - Numpy Arrays：根据阈值对 y-values 数组进行切片，然后对 x-values 数组进行相应切片

> ID：11730952
> 
> 赞同：1
> 
> 时间：2012-07-30T23:05:55.257
> 
> 标签：python, numpy

非常快速的问题，无法使用这些关键字找到答案。执行以下操作的更好方法是什么？

```
t = linspace(0,1000,300)    
x0 = generic_function(t)

x1 = x0[x0>0.8]
t1 = t[t>t[len(x0)-len(x1)-1]] 
```

我正在使用@t1 的操作让我觉得非常非 Python 且效率低下。任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:24:39.863

IIUC，您可以简单地重用切割数组。例如：

```
>>> from numpy import arange, sin
>>> t = arange(5)
>>> t
array([0, 1, 2, 3, 4])
>>> y = sin(t)
>>> y
array([ 0\.        ,  0.84147098,  0.90929743,  0.14112001, -0.7568025 ]) 
```

正如您已经完成的那样，您可以创建一个 bool 数组：

```
>>> y > 0.8
array([False,  True,  True, False, False], dtype=bool) 
```

然后你可以用它来过滤`t`和`y`：

```
>>> t[y > 0.8]
array([1, 2])
>>> y[y > 0.8]
array([ 0.84147098,  0.90929743]) 
```

不使用`len`或假设涉及单调性。

# javascript - 为什么我的按钮没有显示在画布上

> ID：11730957
> 
> 赞同：-1
> 
> 时间：2012-07-30T23:06:11.657
> 
> 标签：javascript, button, canvas

我下面的 html 代码应该显示一个绿色和红色的按钮，但它们没有显示，但是我确实看到了清除画布和你好按钮。有什么问题有什么帮助吗？我最终希望当按钮被按下以改变在画布上绘制的线条的颜色时，我知道如何在 Javascript 代码中实现这将是有帮助的。我对此很陌生。

```
<title>Paint Canvas</title>
</head>
<body>
    <div id="container">
        <canvas id="imageView" width="600" height="300">
            <input type= "button" value= "Green" id= "green" onclick= "GreenRect()" />
            <input type= "button" value= "Red" id= "red" onclick= "RedRect()" />
            </p>
        </canvas>
    </div>

    <script type="text/javascript" src=".js"></script>
</body>
</html>

<body >
    <button id="clear">Clear Canvas</button><br>
    <button id="howdy">Howdy!</button><br>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:09:42.117

您的按钮应位于代码中的画布下方，因为画布忽略了开始和结束标记中的所有内容。

您可以设置按钮位置的样式以覆盖画布。

顺便提一句。你的代码中有双`<body>`标签。

# mysql - 除了手动之外，是否可以在数据库中创建 MySQL 表？

> ID：11730960
> 
> 赞同：1
> 
> 时间：2012-07-30T23:06:24.930
> 
> 标签：mysql

我是 MySQL 新手，我希望将用户表单提交存储在 MySQL 数据库中。

我已经创建了一个数据库并测试了与它的连接等。但是需要一个表来存储数据。

该表单有 47 个字段，我可以看到创建表的唯一方法是通过 WebMin 手动。

有没有更好的办法？感谢并道歉，如果以前有人问过这个问题，我发现了类似的问题，但没有一个专门回答我的问题。

提前谢谢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:15:45.040

可以使用 SQL 创建表

```
CREATE TABLE MyFormTable
(
   Field1  int,
   Field2  varchar(50), --text with 50 characters
   ...
   ...
   Field47 datetime,
   PRIMARY KEY (Field1)
) 
```

[检查此链接](http://sql-info.de/mysql/examples/CREATE-TABLE-examples.html)以了解如何在谷歌中创建表或键入“MySQL 创建表”

# vimeo - Vimeo API 和进度条问题

> ID：11730961
> 
> 赞同：0
> 
> 时间：2012-07-30T23:06:26.427
> 
> 标签：vimeo, froogaloop

我正在使用 vimeo froogaloop API 来控制来自外部按钮的视频（这是一种风格。）

到目前为止，这是一个进步的 jsfiddle：http: [//jsfiddle.net/andrewminton/H8ynJ/](http://jsfiddle.net/andrewminton/H8ynJ/)

我想要做的是监听 playProgress 事件的 api，这样我就可以改变我的 .playhead div 的 css 宽度。

```
function onPlayProgress() {

                            froogaloop.addEvent('playProgress', function(data) {

                                var Playhead = (data.percent)*100;
                                var playheadBar = container.querySelector('div .progress .playhead');
                                playheadBar.css('width', Playhead+'%');

                        });
                    } 
```

任何想法为什么我的播放栏 CSS 宽度百分比没有更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T10:55:28.373

很酷，我想我会添加自己的函数来监听 data.percent 值。

我在想jquery语法而不是纯js：

```
function Progress(message){
                    playbar.style.width = message+'%';
                } 
```

style.width 是这里的关键。

# jquery - 如何从非 SSL 页面提交带有 SSL 的表单？

> ID：11730975
> 
> 赞同：0
> 
> 时间：2012-07-30T23:08:06.757
> 
> 标签：jquery, ajax, ssl

我读到您不能从 http 服务页面到 https 页面进行 ajax 调用。但是reddit是如何做到这一点的呢？

当您单击登录时，它会对[https://ssl.reddit.com/api/login进行 ajax 调用](https://ssl.reddit.com/api/login)

当我尝试在本地测试机器上执行此操作时，萤火虫在 NET 选项卡中返回状态为“已中止”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:14:16.227

它使用[CORS](http://www.google.tt/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&ved=0CFQQFjAC&url=http%3A%2F%2Fwww.w3.org%2FTR%2Fcors%2F&ei=OxUXUIPADY-i8ATCtYAg&usg=AFQjCNGENlRdQ3w0oFhUxIWgiJgyZfpoyA&sig2=mdnVcvnB3pJKZFmA5-Jl6w)这里的标头来自`https://ssl.reddit.com/api/login/tester`

```
access-control-allow-credentials:true
access-control-allow-origin:http://www.reddit.com 
```

# clojure - 如何在clojure中创建一个惰性随机数序列

> ID：11730978
> 
> 赞同：11
> 
> 时间：2012-07-30T23:08:12.160
> 
> 标签：clojure

如何创建一个惰性随机数序列？

我当前的代码：

```
(import '(java.util Random))

(def r (new Random))
(defn rnd [_] 
    (.nextInt r 10))

(defn random-numbers [max] 
    (iterate #(.nextInt r max) (.nextInt r max)))

(println (take 5 (random-numbers 10))) 
```

执行它会引发异常：

> （线程“main”clojure.lang.ArityException 中的异常：传递给：clojure.lang.AFn.throwArity 的 user$random-numbers$fn 的错误数量的 args (1)（AFn.java:437）在 clojure.lang。 AFn.invoke(AFn.java:39) at clojure.core$iterate$fn__3870.invoke(core.clj:2596) at clojure.lang.LazySeq.sval(LazySeq.java:42) at clojure.lang.LazySeq.seq (LazySeq.java:60) 在 clojure.lang.RT.seq(RT.java:466) 在 clojure.core$seq.invoke(core.clj:133) 在 clojure.core$take$fn__3836.invoke(core. clj:2499) 在 clojure.lang.LazySeq.sval(LazySeq.java:42) 在 clojure.lang.LazySeq.seq(LazySeq.java:60) 在 clojure.lang.Cons.next(Cons.java:39) 在clojure.lang.RT.next(RT.java:580) 在 clojure.core$next.invoke(core.clj:64) 在 clojure.core$nthnext.invoke(core.clj:2752) 在 clojure。core$print_sequential.invoke(core_print.clj:57) at clojure.core$fn__4990.invoke(core_print.clj:140) at clojure.lang.MultiFn.invoke(MultiFn.java:167) at clojure.core$pr_on.invoke (core.clj:3264) at clojure.core$pr.invoke(core.clj:3276) at clojure.lang.AFn.applyToHelper(AFn.java:161) at clojure.lang.RestFn.applyTo(RestFn.java: 132) 在 clojure.lang.RestFn.applyTo(RestFn.java:137) 的 clojure.core$prn.doInvoke(core.clj:3309) 的 clojure.core$apply.invoke(core.clj:600)。 core$apply.invoke(core.clj:600) at clojure.core$println.doInvoke(core.clj:3329) at clojure.lang.RestFn.invoke(RestFn.java:408) at user$eval7.invoke(testing .clj:12) 在 clojure.lang.Compiler.eval(Compiler.java:6465) 在 clojure.lang.Compiler.load(Compiler.java:6902) 在 clojure.lang。Compiler.loadFile(Compiler.java:6863) at clojure.main$load_script.invoke(main.clj:282) at clojure.main$script_opt.invoke(main.clj:342) at clojure.main$main.doInvoke(main .clj:426) 在 clojure.lang.RestFn.invoke(RestFn.java:408) 在 clojure.lang.Var.invoke(Var.java:401) 在 clojure.lang.AFn.applyToHelper(AFn.java:161)在 clojure.lang.Var.applyTo(Var.java:518) 在 clojure.main.main(main.java:37) [在 3.8 秒内完成，退出代码为 1]java:518) at clojure.main.main(main.java:37) [在 3.8 秒内完成，退出代码为 1]java:518) at clojure.main.main(main.java:37) [在 3.8 秒内完成，退出代码为 1]

这是一个完全错误的方法，因为我正在使用状态，即 r 是 java.util.Random 的一个实例，还是只是一个 nooby 语法错误？

我只是在自己研究clojure，所以请多多包涵:)。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-30T23:40:57.240

`repeatedly`非常适合重复运行一个函数并在 seq 中收集结果

```
user> (take 10 (repeatedly #(rand-int 42)))
(14 0 38 14 37 6 37 32 38 22) 
```

至于您的原始方法： iterate 接受一个参数，将其提供给一个函数，然后获取该结果并将其传递回同一个函数。我不是你想要的，因为你使用的函数不需要任何参数。你当然可以给它一个占位符来代表那个论点并让它发挥作用，尽管`repeatedly`它可能更合适。

```
(defn random-numbers [max]
  (iterate (fn [ignored-arg] (.nextInt r max)) (.nextInt r max)))
#'user/random-numbers

user> (println (take 5 (random-numbers 10)))
(3 0 0 2 0) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-01T23:25:27.103

作为一般指南，不要从 Java 中的类/函数开始。首先在 clojure.* 中查看 Clojure 的核心函数和命名空间（然后查看现在位于模块化存储库中的贡献命名空间：请参阅[http://dev.clojure.org/display/doc/Clojure+Contrib](http://dev.clojure.org/display/doc/Clojure+Contrib)）；rand-int 本身在 clojure-core 中很容易获得。那么，如何开始寻找随机数助手呢？

从 Clojure 1.3 开始，您可以“使用” clojure-repl 命名空间来访问方便的 apropos 函数（与 Unix/linux 中的 apropos 命令的使用精神相同）；apropos 返回到目前为止加载的命名空间中的所有匹配定义。

```
user> (use 'clojure.repl)
nil
user> (apropos "rand")
(rand rand-int rand-nth) 
```

clojure.repl 中的 find-doc 函数也是另一种选择。

另一个指针是在 www.clojuredocs.org 上搜索，其中包括 clojure core 和 clojure.* 中的函数的用法示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-31T10:46:11.503

至少出于测试目的，能够通过播种生成器来重复“随机”序列是很好的。新`spec`库以这种方式报告其测试结果。

原生 Clojure 函数不允许您播种随机序列，因此我们必须求助于底层 Java 函数：

```
(defn random-int-seq
  "Generates a reproducible sequence of 'random' integers (actually longs)
  from an integer (long) seed. Supplies its own random seed if need be."
  ([] (random-int-seq (rand-int Integer/MAX_VALUE)))
  ([seed]
   (let [gen (java.util.Random. seed)]
     (repeatedly #(.nextLong gen))))) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-01T08:07:32.173

让我们使用换能器好吗？

```
 (def xf (map (fn [x] (* 10 (rand))))) 
```

我们也可以`rand-int`用作：

```
(def xf (map (fn [x] (* 10 (rand-int 10))))) 
```

要使用它来生成惰性序列，我们将使用`sequence`

```
(sequence xf (range)) 
```

这将返回一个惰性随机数序列。要获得*n 个数字*的完整序列，我们可以使用`take`：

```
(take n (sequence xf (range))) 
```

# python - hadoop-streaming：当 mapred.reduce.tasks=1 时，reducer 似乎没有运行

> ID：11730984
> 
> 赞同：0
> 
> 时间：2012-07-30T23:08:37.337
> 
> 标签：python, hadoop, mapreduce, hadoop-streaming

我正在运行一个基本`Map Reduce`程序`hadoop-streaming`

看起来`Map`像

```
import sys

index = int(sys.argv[1])
max = 0
for line in sys.stdin:
    fields = line.strip().split(",")
    if fields[index].isdigit():
        val = int(fields[index])
        if val > max:
            max = val
else:
    print max 
```

我运行它

```
hadoop jar /usr/local/Cellar/hadoop/1.0.3/libexec/contrib/streaming/hadoop-streaming-1.0.3.jar -D mapred.reduce.tasks=1 -input input -output output -mapper '/Users/hhimanshu/code/p/java/hadoop-programs/hadoop-programs/src/main/python_scripts/AttributeMax.py 8' -file /Users/me/code/p/java/hadoop-programs/hadoop-programs/src/main/python_scripts/AttributeMax.py 
```

[我在Hadoop in Action](https://rads.stackoverflow.com/amzn/click/com/1935182196)中读到，`mapred.reduce.tasks=1`是

> 由于我们没有指定任何特定的 reducer，它将使用默认的 IdentityReducer。顾名思义，IdentityReducer 将其输入直接传递给输出。

当我看到我的控制台时，我看到了

```
12/07/30 16:01:33 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
12/07/30 16:01:33 WARN snappy.LoadSnappy: Snappy native library not loaded
12/07/30 16:01:33 INFO mapred.FileInputFormat: Total input paths to process : 1
12/07/30 16:01:34 INFO streaming.StreamJob: getLocalDirs(): [/Users/me/app/hadoop/tmp/mapred/local]
12/07/30 16:01:34 INFO streaming.StreamJob: Running job: job_201207291003_0037
12/07/30 16:01:34 INFO streaming.StreamJob: To kill this job, run:
12/07/30 16:01:34 INFO streaming.StreamJob: /usr/local/Cellar/hadoop/1.0.3/libexec/bin/../bin/hadoop job  -Dmapred.job.tracker=localhost:9001 -kill job_201207291003_0037
12/07/30 16:01:34 INFO streaming.StreamJob: Tracking URL: http://localhost:50030/jobdetails.jsp?jobid=job_201207291003_0037
12/07/30 16:01:35 INFO streaming.StreamJob:  map 0%  reduce 0%
12/07/30 16:01:51 INFO streaming.StreamJob:  map 100%  reduce 0% 
```

它没有任何进展，只是继续运行。它似乎不起作用，我该如何解决这个问题？

**更新**

*   当`D mapred.reduce.tasks=0` 我看到两个文件`part-00000`并且`part-00001`两个文件都有一行 0

*   何时`D mapred.reduce.tasks=1`和`-reduce 'cat'` 行为与 reduce 没有做任何事情一样

*   当我跑步时，`cat file | python AttibuteMax.py 8`
    我得到 868

这意味着`D mapred.reduce.tasks=0`并且`cat file | python AttributeMax.py 8`也没有产生相同的输出（但它们应该，对吗？）

当输入数据也相同时，会导致行为差异的原因是什么？

**更新 1**

*   当`D mapred.reduce.tasks=0` 我看到 4 个文件`part-00000`, `part-00001`,`part-00002`和`part-00002`单行 268, 706, 348, 868
*   当我运行时，`$ cat ~/Downloads/hadoop/input/apat63_99.txt | python ../../../src/main/python_scripts/AttributeMax.py 8 | cat` 我确实看到所需的输出为`868`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:53:06.900

设置时是否得到预期的输出`mapred.reduce.tasks=0`？如果您指定`-reducer 'cat'`with`mapred.reduce.tasks=1`怎么办？流式传输的好处之一是您可以使用管道从命令行非常有效地测试它：

```
cat input | python mapper.py | sort | python reducer.py 
```

但您的应用似乎没有产生任何输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T17:08:16.257

不确定确切的答案，但对我来说，一旦我在具有更好存储的机器上运行它，它就可以正常工作:)

# c++ - 矩阵赋值导致崩溃

> ID：11730985
> 
> 赞同：0
> 
> 时间：2012-07-30T23:08:44.350
> 
> 标签：c++, assignment-operator

每当我将一个已经声明的东西分配`Matrix`给其他东西时，我的程序就会意外退出。

我真的不知道为什么会发生这种情况，我的印象是让编译器生成赋值运算符是最好的事情，除非你绝对必须重载它，这让我觉得我的构造函数或其他东西有问题?

例子：

```
Matrix rotation = rotationMatrix3(Y, degToRad(20.0f));
Vector3 left = rotation * direction_;

rotation = rotationMatrix3(Y, degToRad(-20.0f)); //crash
Vector3 right = rotation * direction_; 
```

这是我的矩阵类：

矩阵.h

```
enum Axis {
    X, Y, Z,
};

class Matrix {
public:
    Matrix(int cols, int rows);
    Matrix(int cols, int rows, const float values[]);
    ~Matrix();

    float& operator()(int col, int row);
    float  operator()(int col, int row) const;
    inline int cols() const { return cols_; }
    inline int rows() const { return rows_; }

private:
    int cols_, rows_;
    float* values_;
};

Vector3 operator*(const Matrix& m, const Vector3& v);

Matrix rotationMatrix3(int axis, float rads); 
```

矩阵.cpp

```
Matrix::Matrix(int cols, int rows) : cols_(cols), rows_(rows), values_(NULL) {
    values_ = new float[rows_ * cols_];
}

Matrix::Matrix(int cols, int rows, const float values[]) : cols_(cols), rows_(rows), values_(NULL) {
    values_ = new float[rows_ * cols_];

    for(int c = 0; c < cols; ++c) {
        for(int r = 0; r < rows; ++r) {
            (*this)(c, r) = values[r * cols + c];
        }
    }
}

Matrix::~Matrix() {
    delete [] values_;
}

float& Matrix::operator()(int col, int row) {
    return values_[row * cols_ + col];
}

float Matrix::operator()(int col, int row) const {
    return values_[row * cols_ + col];
}

Vector3 operator*(const Matrix& m, const Vector3& v) {
    if(m.cols() != 3) {
        throw std::logic_error("Matrix must have only 3 cols");
    }

    Vector3 result;
    result.x = m(0, 0) * v.x + m(1, 0) * v.y + m(2, 0) * v.z;
    result.y = m(0, 1) * v.x + m(1, 1) * v.y + m(2, 1) * v.z;
    result.z = m(0, 2) * v.x + m(1, 2) * v.y + m(2, 2) * v.z;

    return result;
}

Matrix rotationMatrix3(int axis, float rads) {
    float c = static_cast<float>(cos(rads));
    float s = static_cast<float>(sin(rads));

    if(axis == X) {
        const float mat[] = { 1.0f, 0.0f, 0.0f,
                              0.0f, c,    -s,
                              0.0f, s,    c };
        return Matrix(3, 3, mat);
    } else if(axis == Y) {
        const float mat[] = { c,    0.0f, s,
                              0.0f, 1.0f, 0.0f,
                              -s,   0.0f, c };
        return Matrix(3, 3, mat);
    } else if(axis == Z) {
        const float mat[] = { c,    -s,   0.0f,
                              s,    c,    0.0f,
                              0.0f, 0.0f, 1.0f };
        return Matrix(3, 3, mat);
    } else {
        throw std::logic_error("Unknown axis");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:30:44.290

是的，制作一个带有矩阵的复制构造函数。否则，您将复制`values_`随后在立即超出范围的原始返回值中删除的指针。

我对你的建议......你显然是在创建类来做 3D。不要为此创建任意大小的矩阵类。只需制作一个基本的 4x4 齐次矩阵（或 4x3 或 3x3，如果必须）。硬编码。单个值数组 - 没有动态分配。为您节省大量时间、堆碎片和烦人的健全性测试。你永远不会用 5x17 矩阵或其他什么来运行这个类。所以不要为它编码。

您通常需要 2d、3d 或 4d 向量以及 3d 或 4d 方阵。就这样。所以让你的课程：

```
Vector2
Vector3
Vector4
Matrix3
Matrix4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T23:34:20.423

> 我的印象是让编译器生成赋值运算符是最好的做法，除非你绝对必须重载它，这让我觉得我的构造函数有什么问题？

放下那个印象。语言中的那些免费赠品很少是“正确”的事情。您的班级中有一个原始指针`float* values_;`。您绝对必须在此处重载复制构造函数和赋值运算符。

# objective-c - 将自定义 CSS 和 javascript 注入 WebView

> ID：11730986
> 
> 赞同：1
> 
> 时间：2012-07-30T23:08:54.357
> 
> 标签：objective-c, css, cocoa, uiwebview, webview

如何将自定义 CSS 注入到 WebView 中，例如 `background-color:`更改[http://www.apple.com/](http://www.apple.com/)。Javascript 也会很好，因为将来我想控制 javascript。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T03:18:08.723

最好的方法是 Rob Keniger 描述的方法，答案是：[https](https://stackoverflow.com/a/2475623/307881) ://stackoverflow.com/a/2475623/307881 。这种技术也应该适用于 javascript。如果它不能立即工作，请尝试在 WebView 完成加载后修改 DOM（见下文）

* * *

您还可以直接评估 javascript 字符串，而无需访问 DOM。

首先，获取您的 javascript 字符串，然后，当您的 WebView 完成加载其内容时，使用以下委托方法`WebFrameLoadDelegate`：

```
- (void)webView:(WebView *)sender didFinishLoadForFrame:(WebFrame *)frame {
    [sender stringByEvaluatingJavaScriptFromString:jsStringToInject];
} 
```

# css - 为什么 FireFox 会冻结我在此登录表单中的输入？

> ID：11730987
> 
> 赞同：1
> 
> 时间：2012-07-30T23:08:57.633
> 
> 标签：css, firefox, textinput

看看这个[Fiddle](http://jsfiddle.net/qEpVG/)。

这是我的登录页面的一部分，带有整个网站样式表。此登录表单在 Chrome 中运行良好，但在 FireFox 中，由于某种原因，在我开始编写密码后冻结了用户名输入，当您从密码框中移除焦点时，它也被冻结了。

这种情况发生在你身上吗？如果是，知道为什么吗？

* * *

在鲍里斯的回答之后，我的`user-select` [手写笔](https://github.com/learnboost/stylus)功能现在可以完美运行，如下所示：

```
user-select()
    user-select arguments
    -webkit-user-select arguments
    -o-user-select arguments

    if arguments == 'none'
        -moz-user-select -moz-none
    else
        -moz-user-select arguments 
```

使用情况会导致：

`user-select none`：

```
user-select: none;
-webkit-user-select: none;
-o-user-select: none;
-moz-user-select: -moz-none; 
```

`user-select text`：

```
user-select: text;
-webkit-user-select: text;
-o-user-select: text;
-moz-user-select: text; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T07:16:23.013

`-moz-user-select: none`意味着它里面没有任何东西是可选择的，句号。不管里面的东西是什么风格。

如果您希望能够通过样式化后代来覆盖，您需要`-moz-user-select: -moz-none`.

# c# - NHibernate 在 NUnit 和 Console 下工作，但在 IIS 下不工作 [抛出 PropertyAccessException]

> ID：11730988
> 
> 赞同：2
> 
> 时间：2012-07-30T23:09:11.547
> 
> 标签：c#, nhibernate, fluent-nhibernate

我有一个 API，其中包含一个如下所示的对象：

```
public class NOrgUnit {
    public virtual NOrgUnit Parent { get; set;}
    public virtual ISet<NOrgUnit> children { get; set; } // an Iesi 1.0.1 ISet
    public virtual Int64 Id { get; protected set; }
    public virtual string Name { get; set; }

    // etc.
} 
```

该对象具有以下地图：

```
public class NOrgUnitMap : ClassMap<NOrgUnit>
{
    public NOrgUnitMap()
    {
        Id(x => x.Id);

        Map(x => x.Name);

        References(x => x.Parent).Nullable();
        HasMany(x => x.children).AsSet();
    }
} 
```

**当我构建我的 API 并在控制台应用程序中引用它时，一切正常。**

当我在 asp.net 上下文（特别是 sitecore 项目）中引用相同的 .dll 时，我收到 NHibernate 异常：

```
Org Service encountered unexpected exception [NHibernate.PropertyAccessException: Invalid Cast (check your mapping for property type mismatches); setter of TI.Organization.Core.Impl.DAL.Persistence.Entities.Hierarchy.NOrgUnit ---> System.InvalidCastException: Unable to cast object of type 'TI.Security.Core.Impl.Management.Provisioning.DAL.PersistentGenericSet`1[TI.Organization.Core.Impl.DAL.Persistence.Entities.Hierarchy.NOrgUnit]' to type 'Iesi.Collections.Generic.ISet`1[TI.Organization.Core.Impl.DAL.Persistence.Entities.Hierarchy.NOrgUnit]'.
   at (Object , Object[] , SetterCallback )
   at NHibernate.Bytecode.Lightweight.AccessOptimizer.SetPropertyValues(Object target, Object[] values)
   at NHibernate.Tuple.Entity.PocoEntityTuplizer.SetPropertyValuesWithOptimizer(Object entity, Object[] values)
   --- End of inner exception stack trace ---
   at NHibernate.Tuple.Entity.PocoEntityTuplizer.SetPropertyValuesWithOptimizer(Object entity, Object[] values)
   at NHibernate.Tuple.Entity.PocoEntityTuplizer.SetPropertyValues(Object entity, Object[] values)
   at NHibernate.Persister.Entity.AbstractEntityPersister.SetPropertyValues(Object obj, Object[] values, EntityMode entityMode)
   at NHibernate.Engine.TwoPhaseLoad.InitializeEntity(Object entity, Boolean readOnly, ISessionImplementor session, PreLoadEvent preLoadEvent, PostLoadEvent postLoadEvent)
   at NHibernate.Loader.Loader.InitializeEntitiesAndCollections(IList hydratedObjects, Object resultSetId, ISessionImplementor session, Boolean readOnly)
   at NHibernate.Loader.Loader.DoQuery(ISessionImplementor session, QueryParameters queryParameters, Boolean returnProxies) 
```

这已经困扰了我好几天了。为什么应用程序可以在控制台而不是 IIS 中运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T09:31:14.010

`TI.Security.Core.Impl.Management.Provisioning.DAL.PersistentGenericSet<T>`是一个奇怪的类。这是定制开发的吗？如果是这样，它可能不会实现`Iesi.Collections.Generic.ISet<T>`. 如果它确实实现了它，则可能是加载了多个 Iesi 程序集的问题。

我从来没有听说过sitecore，所以也许那是在后台做一些奇怪的事情。

# mysql - mysql工作台修改远程服务器上的存储过程

> ID：11730993
> 
> 赞同：1
> 
> 时间：2012-07-30T23:10:17.453
> 
> 标签：mysql, procedure, workbench

我正在尝试修改远程服务器中的存储过程。user@% 帐户对相关数据库具有`CREATE PROCEDURE`、`ALTER PROCEDURE`和`EXECUTE`权限。

我没有收到来自远程服务器的任何错误或拒绝，只有成功通知。但是，当打开远程服务器的 phpmyadmin 并查看程序时，它的代码是未修改的。

我正在使用 mysql workbitch 5.2.38，连接到 mysql 服务器 5.1.18。我尝试通过 CLI 连接并运行测试，这就是我得到的：

```
mysql> drop procedure benchmark_1;
Query OK, 0 rows affected (0.00 sec)

mysql> create procedure benchmark_1 () begin end;
Query OK, 0 rows affected (0.00 sec) 
```

我可以很好地连接。标准查询可以很好地执行和更新数据，存储过程删除和创建语句也可以正常工作，但是尽管服务器返回操作成功，但这些更改并没有保留在服务器上。