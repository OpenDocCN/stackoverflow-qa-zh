# StackOverflow 问答 10306000-10306999

# tsql - TSQL Geometry：获取具有给定点（纬度，经度）（点在形状中）或靠近形状的记录

> ID：10306000
> 
> 赞同：0
> 
> 时间：2012-04-24T21:06:10.983
> 
> 标签：tsql, geometry, latitude-longitude

我有 zillow 邻域数据并成功导入 DB（感谢[http://shapefilesource.codeplex.com](http://shapefilesource.codeplex.com)）。现在我想编写一个 SP，它需要经纬度，并将返回给定点所在或靠近它们的所有记录。我怎样才能在 TSQL 中实现这一点，或者我需要使用 CLR。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:39:20.790

我认为应该能够使用功能[STBuffer](http://msdn.microsoft.com/en-us/library/bb933965.aspx)和[STIntersects](http://msdn.microsoft.com/en-us/library/bb933962.aspx)。也许这些页面可能会有所帮助：

[http://blogs.msdn.com/b/davidlean/archive/2008/10/24/sql-2008-spatial-samples-part-n-1-of-n-stbuffer.aspx](http://blogs.msdn.com/b/davidlean/archive/2008/10/24/sql-2008-spatial-samples-part-n-1-of-n-stbuffer.aspx)

[http://msdn.microsoft.com/en-us/library/ff929109.aspx](http://msdn.microsoft.com/en-us/library/ff929109.aspx)

# iphone - 如何重新排列以编程方式创建的旋转视图？

> ID：10306002
> 
> 赞同：0
> 
> 时间：2012-04-24T21:06:38.903
> 
> 标签：iphone, objective-c, ios, ipad

`ViewControllerA`有一个`viewDidLoad`以编程方式创建按钮的方法，例如：

```
self.cancelButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
self.cancelButton.frame = CGRectMake(330, 625, 125, 30);
[self.cancelButton setTitle:@"Cancel" forState:UIControlStateNormal];
[self.cancelButton sizeToFit];
[self.cancelButton addTarget:self action:@selector(cancelButton:) forControlEvents:UIControlEventTouchUpInside];
[self.cancelButton setNeedsDisplay];
[self.view addSubview:self.cancelButton]; 
```

我也有`- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation{return YES;}`。

当设备旋转到横向时，我想更改按钮框架。我试过检查`interfaceOrientation`我`shouldAutorotate...`上面的方法并设置框架。我试过在`if (UIInterfaceOrientationLandscapeLeft == [[UIApplication sharedApplication] statusBarOrientation])`那里做和重置框架。这些都没有奏效。有什么建议么？

编辑

这是另一个没有产生任何变化的尝试：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {
  if (toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft){
  self.cancelButton.frame = CGRectMake(15, 15, 300, 50);
  } 
} 
```

所以我试着做：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {
  if (toInterfaceOrientation == UIInterfaceOrientationPortrait
  || toInterfaceOrientation == UIInterfaceOrientationPortraitUpsideDown){
    NSLog(@"Portait");
  } else {
    NSLog(@"Landscape");
  }
} 
```

并且从来没有调用过任何一个 NSLog。我的观点正在旋转...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T21:23:54.140

因此检查方向....

```
- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)
interfaceOrientation duration:(NSTimeInterval)duration {
if (interfaceOrientation == UIInterfaceOrientationPortrait
|| interfaceOrientation == UIInterfaceOrientationPortraitUpsideDown)
 {
  // portrait & upsidedown
  self.cancelButton.frame = CGRectMake(330, 625, 125, 30);
 }
 else
 {
    // landscape
    self.cancelButton.frame = CGRectMake(330, 625, 125, 30);
 }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:09:08.713

从 UIViewController 看一下：

```
– willRotateToInterfaceOrientation:duration:
– willAnimateRotationToInterfaceOrientation:duration:
– didRotateFromInterfaceOrientation: 
```

看看这篇文章： [willAnimateRotationToInterfaceOrientation not called on popViewControllerAnimated](https://stackoverflow.com/questions/3595471/willanimaterotationtointerfaceorientation-not-called-on-popviewcontrolleranimate)

# javascript - 获取 Javascript 中 url 的最后一部分

> ID：10306003
> 
> 赞同：4
> 
> 时间：2012-04-24T21:06:57.003
> 
> 标签：javascript, jquery, regex

使用以下 URL 示例，我将如何从中获取用户名？

[http://www.mysite.com/username_here801](http://www.mysite.com/username_here801)

正则表达式解决方案会很酷。

以下示例仅获取域名：

```
 var url = $(location).attr('href');

  alert(get_domain(url));

  function get_domain(url) {
    return url.match(/http:\/\/.*?\//);
  } 
```

jQuery 解决方案也是可以接受的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T21:11:50.850

```
var url = "http://www.mysite.com/username_here801";    
var username = url.match(/username_(.+)/)[1]; 
```

[http://jsfiddle.net/5LHFd/](http://jsfiddle.net/5LHFd/)

要始终在 .com 后面的斜杠之后直接返回文本，您可以这样做：

```
var url = "http://www.mysite.com/username_here801";
var urlsplit = url.split("/");
var username = urlsplit[3]; 
```

[http://jsfiddle.net/5LHFd/2/](http://jsfiddle.net/5LHFd/2/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T21:08:08.013

您可以使用它访问它`document.location.pathname`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T21:10:56.950

如果 RegEx 解决方案可以接受，您可以尝试：

```
function get_path(url) {
    // following regex extracts the path from URL
    return url.replace(/^https?:\/\/[^\/]+\//i, "").replace(/\/$/, "");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T21:46:30.460

您可以使用您的 getDomain() 函数来找出您的路径名开始的位置。：

```
function getUsername(url){
   var position = getDomain(url).length + 1;
   return url.slice(position); 
} 
```

# c# - 调用异步 Web 服务时 HttpContext.Current.Session 为空

> ID：10306005
> 
> 赞同：1
> 
> 时间：2012-04-24T21:07:17.190
> 
> 标签：c#, asynchronous

我正在开发一个需要异步 Web 服务调用的 Asp.Net 3.5 Web 应用程序。这是一些代码。我已经编写了使用委托进行异步调用的代码，但不知何故我的 HttpContext.Current.Session 为空。为了确保，我什至尝试传递 HttpContext。

```
static HttpContext httpContext;
public void AsyncGetUser()
        {
            httpContext = HttpContext.Current;//not getting Session as null here

            GetUserDelegate delegate = new GetUserDelegate(InvokeWrapperMethod);
            IAsyncResult async = delegate.BeginInvoke(httpContext,new AsyncCallback(CallbackMethod), null);

        }
static void CallbackMethod(IAsyncResult ar)
        {
            AsyncResult result = (AsyncResult)ar;
            GetUserDelegate caller = (GetUserDelegate)result.AsyncDelegate;
            caller.EndInvoke(ar);

        }
private static void InvokeWrapperMethod(HttpContext hc)
        {
            HttpContext.Current = hc; //getting Session as null here
            UserInfo userInfo = Service.GetUserInfo();
            SetInSession(USER_INFO, userInfo);
        } 
```

我已经尝试`<modules runAllManagedModulesForAllRequests="true">`过

```
<system.webServer>
<modules>

  <remove name="Session"/>
  <add name="Session" type="System.Web.SessionState.SessionStateModule"/>

</modules> 
```

正如这个[SO question](https://stackoverflow.com/questions/218057/httpcontext-current-session-is-null-when-routing-requests)所建议的那样，但没有奏效。如果你们能给一些指点，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-28T10:17:12.257

这可能发生在使用`async/await`(TAP) 模式的 ASP.NET 应用程序中。要解决此问题，您需要将此添加到`appSettings`web.config 中的部分。

```
<add key="aspnet:UseTaskFriendlySynchronizationContext" value="true"/> 
```

这可能需要 .NET 4.5，我注意到您没有使用此版本，但我在此处为已升级项目并使用 TAP 代码遇到此问题的其他人添加了此答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:14:45.457

您的 Web 服务应该使用 ,`IRequiresSessionState`标记接口来启用会话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-01T08:16:49.113

您可能正在使用委托来获取“方便”的 BeginInvoke 方法。这是低效的，因为在幕后，它使用了大量的反射。如果后台工作总是很重要，那么这种开销会被摊销，但有时它只是几次读取，那么它会比在原始线程上花费更长的时间。

您可以为 3.5 安装 RX 并使用“迷你 TPL”来获取任务。这本身可以解决问题（问题可能是编写 delegate.BeginInvoke 的方式），否则尝试将上下文作为状态实例传入。

我知道您已经从问题中进行了重构（可能是一件好事），但是为了完整性，我添加了这个答案，更多地查看了您最初在做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T20:51:54.763

我最终决定重构整个项目。

# sqlite - 返回大型结果集的 SQLite 查询是否需要更多时间？

> ID：10306014
> 
> 赞同：1
> 
> 时间：2012-04-24T21:08:05.407
> 
> 标签：sqlite

执行 SQLite 查询时，返回数据集的大小是否会影响查询所需的时间？让我们假设这个问题我实际上并没有访问结果中的任何数据，我只是想知道查询本身是否需要更长的时间。还假设我只是选择所有行并且没有 WHERE 或 ORDER BY 子句。

例如，如果我有两个表 A 和 B。假设表 A 有一百万行，表 B 有 10 行，并且两个表具有相同数量和类型的列。选择表 A 中的所有行会比选择表 B 中的所有行花费更长的时间吗？

这是我的问题的后续行动[游标如何引用已删除的行？](https://stackoverflow.com/questions/7367905/how-does-a-cursor-refer-to-deleted-rows). 我猜如果在查询期间 SQLite 复制了数据，那么返回大数据集的查询可能需要更长的时间，除非有一个优化，如果数据库中的数据发生变化，则只复制查询结果数据而查询仍然存在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T09:21:41.327

根据某些细节，是的，查询可能需要不同的时间。

示例：我有一个包含 20k 个条目的表。我做了一个 GLOB 搜索，必须尝试每一行，有一个限制。如果满足 LIMIT，则查询可以提前停止。如果不是，它必须遍历整个表（或 JOIN）。因此，结果太多的搜索比只有少数结果的搜索返回得更快。

如果查询必须运行相同数量的数据，我不希望在较小和较大数量的选定行之间存在显着差异。当然，可能会有 IO 成本。

# tomcat - 多个实例 Tomcat 作为 Windows 服务

> ID：10306016
> 
> 赞同：1
> 
> 时间：2012-04-24T21:08:13.677
> 
> 标签：tomcat, windows-services, tomcat7

我已经设置了多个 Tomcat 实例并使用批处理文件运行。不幸的是，当我注销 Windows 时，tomcat 服务器停止，因为批处理文件无法继续运行。我想将这些设置为 Windows 服务，但出现以下错误：

**Apache 服务命名报错：>>> 警告：DocumentRoot [C:/Tomcat/webapps/pilot] 不存在。**

我有 Windows 服务来执行以下操作： C:\app\pilot\bin\tomcat7.exe //RS//TomcatPilot

我错过了什么？如何让这个 tomcat 服务查看 c:\app\pilot 而不是默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:15:44.873

在您的 CATALINA_HOME/conf/server.xml 中有一个带有条目的部分 `<Context path="/myApp" docBase="dir">` 使用此条目，您可以配置 Tomcat 实例将从“dir”加载“myApp”的位置。您也可以在`<Host>`标签内进行配置，但您会发现更多文档可用于 Context 标签。希望这可以帮到你。

# python - 命令行提示错误

> ID：10306018
> 
> 赞同：1
> 
> 时间：2012-04-24T21:08:40.213
> 
> 标签：python, command-line, conditional

我的程序需要 2 或 3 个命令行参数：

-s 是可选参数，表示稍后在我的程序中的一个开关 -infile 是文件输入 -outfile 是要写入的文件

如果发生以下任何情况，我需要我的程序打印错误消息并退出：

*   用户指定一个不以 .genes 结尾的 infile 名称
*   用户指定一个不以 .fa 或 .fasta 结尾的输出文件名
*   用户提供少于 2 个或多于 3 个参数
*   用户的第一个参数以破折号开头，但不是“-s”

我已经写了：

```
def getGenes(spliced, infile, outfile):
spliced = False
if '-s' in sys.argv:
    spliced = True
    sys.argv.remove('-s')
    infile, outfile = sys.argv[1:]
if not infile.endswith('.genes'):
    print('Incorrect input file type')
    sys.exit(1)
if not outfile.endswith('.fa' or '.fasta'):
    print('Incorrect output file type')
    sys.exit(1)
if not 2 <= len(sys.argv) <= 3:
    print('Command line parameters missing')
    sys.exit(1)
if sys.argv[1] != '-s':
    print('Invalid parameter, if spliced, must be -s')
    sys.exit(1) 
```

但是，某些条件与某些条件相冲突，包括第一个和最后一个是矛盾的，因为 s.argv[1] 总是不等于 '-s'，因为如果 argv 中存在 's'，它就会被删除早些时候。所以我不确定如何正确写这个......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:23:48.970

`sliced=False`没有缩进

```
def getGenes(spliced, infile, outfile):
     spliced = False 
```

`sys.argv.remove('s')`它应该是 `sys.argv.remove('-s')`

**两个条件相互矛盾：**

```
if '-s' in sys.argv:
    spliced = True
    sys.argv.remove('-s') # you removed '-s' from sys.argv ,so the below if condition becomes false
    infile, outfile = sys.argv[1:]  

if sys.argv[1] != '-s':
    print('Invalid parameter, if spliced, must be -s')
    sys.exit(1) 
```

**您的代码的编辑版本：**

```
import sys

def getGenes(spliced, infile, outfile):
 spliced = False
if '-s' in sys.argv:
    spliced = True
    infile, outfile = sys.argv[2:]
if not infile.endswith('.genes'):
    print('Incorrect input file type')
    sys.exit(1)
if not outfile.endswith('.fa' or '.fasta'):
    print('Incorrect output file type')
    sys.exit(1)
if not 3 <= len(sys.argv) <= 4:
    print('Command line parameters missing')
    sys.exit(1)
if sys.argv[1] != '-s':
    print('Invalid parameter, if spliced, must be -s')
    sys.exit(1) 
```

# css - 在全角 div 中居中浮动元素

> ID：10306019
> 
> 赞同：3
> 
> 时间：2012-04-24T21:08:41.197
> 
> 标签：css, css-float

我正在处理产品目录页面，图像组需要居中，但我还没有找到这样做的方法，因为它们都浮动在宽度为 100% 的 div 中。

我正在寻找一种将这些图像水平居中而不失去其浮动属性的灵活性的方法。

这是网站上目录的链接：http: [//internetvolk.de/katalog/](http://internetvolk.de/katalog/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T21:12:56.117

尝试使用`display: inline-block;`i 而不是浮动并添加`text-align: center`到其父容器）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T21:15:04.520

使用以下规则进行扩充：

```
#katalog {
    text-align: center;
} 
```

和

```
.imageLink {
    /** float: left; <-- REMOVE! */
    display: inline-block;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T21:13:12.180

如果你给#katalog 一个宽度——根据图像的数量和它们的边距来计算。例如

```
#katalog{
width: 960px; /*just an example*/
margin: 0 auto;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T21:18:18.380

```
#katalog {
    margin: 10px auto 0;
    overflow-y: hidden;
    max-width: 940px;
    min-width: 810px;
} 
```

使用`max-height`并`min-height`保持灵活性，我定义一个`max-width`通过添加使其在所有屏幕中居中`margin: 0 auto;`

# cassandra - Cassandra - 从集群中删除一个节点

> ID：10306021
> 
> 赞同：18
> 
> 时间：2012-04-24T21:08:50.307
> 
> 标签：cassandra

我有一个包含三个节点的集群，我需要删除一个节点。在实际删除之前，如何确保将要删除的节点中的数据复制到其他两个节点？这是使用快照完成的吗？我应该如何进行？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-25T09:06:04.490

从[文档](http://cassandra.apache.org/doc/latest/operating/topo_changes.html#removing-nodes)

> 您可以将一个节点从集群中移出`nodetool decommission`到一个活动节点，或者`nodetool removenode`（到任何其他机器）移除一个死节点。这会将旧节点负责的范围分配给其他节点，并在那里复制适当的数据。如果使用 decommission，数据将从 decommissioned 节点流式传输。如果使用 removenode，数据将从剩余的副本中流出。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-25T02:03:34.733

您想`nodetool decommission`在要删除的节点上运行。这将导致节点将其所有数据流式传输到其他节点，然后将自身从环中移除。

# ruby - 你如何卸载 RVM gem？

> ID：10306022
> 
> 赞同：6
> 
> 时间：2012-04-24T21:08:54.043
> 
> 标签：ruby, gem, rvm, uninstallation

奇怪......但这就是我得到的：

```
$ gem list | grep rvm
>> rvm (1.11.3.3)
$ gem uninstall rvm
>> INFO:  gem "rvm" is not installed 
```

这怎么可能？这个问题的根源可能源于我下载了最新的 RVM 并发现它不适用于最新版本的 POW。因此我不得不内爆 RVM 并重新安装旧版本。从那时起，当我做 a 时`cap deploy`，我得到了经典：

```
`<top (required)>': RVM - Capistrano integration was extracted to a separate gem, install: `gem install rvm-capistrano` and remove the `$LOAD_PATH.unshift` line, note also the 'set :rvm_type, :user' is now the default (instead of :system). (RuntimeError) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-27T01:35:34.673

我最近遇到了同样的 rvm 错误：

“RVM - Capistrano 集成已提取到单独的 gem，安装：`gem install rvm-capistrano`并删除该`$LOAD_PATH.unshift`行，还要注意 'set :rvm_type, :user' 现在是默认设置（而不是 :system）。（RuntimeError）”

做错误建议的事情对我根本不起作用。

对我有用的是：`rvm -v`

当我这样做时，我看到我的 rvm 版本是`rvm 1.13.0`

使用“ `rvm get`”我做了“ `rvm get 1.12.0`”但仍然得到错误

然后我尝试了“ `rvm get 1.11.0`”，然后我的 rvm 又开始工作了。

我不是 100% 确定首先是什么导致了错误，但我认为这一切都是`rvm get stable`在我无法安装一些 gem 之后尝试升级 rvm 时开始的。我发现我无法再安装 gems 了，因为我已经将我的 xcode 更新到 4.3.2 并且显然 Apple 更改了他们的 c 编译器，这与 rvm 不兼容。

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-24T21:16:13.990

你在宝石中吗？如果是这样，那么该 gem 可能在解释器的未命名 gemset 或全局 gemset 中。如果是这样，请尝试

```
rvm use 1.9.3
gem uninstall rvm 
```

或者

```
rvm use 1.9.3@global
gem uninstall rvm 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-24T21:13:43.170

我也遇到了这个错误。您遇到的错误是由于最近的`capistrano`更新。如果您添加`rvm-capistrano`到您的 gemfile 并`$LOAD-PATH.unshift`从您的 capistrano 部署文件中删除该行，它应该可以工作，至少它对我有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-10T20:51:32.103

问题是 RVM 1.12 及更高版本不能很好地与 Capistrano 配合使用。因此，请卸载您的 RVM，然后获取 RVM 1.11 ( `rvm get 1.11.0`)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-08-08T02:24:25.117

RVM 的版本可能与 POW 不兼容。您可以[删除 RVM](http://www.mightyuninstaller.com/Uninstall-RVM-Integrator-201726.html)，然后安装最新版本。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-25T05:41:23.517

那是正确的。它在“全球”宝石集中。此 gemset 与“默认”gemset 和您实际创建的任何 gemset 都“混合”在一起。

因此，如果您安装了 Ruby 1.9.3，例如 (rvm install 1.9.3)，它将被安装到该 ruby​​ 的“全局”中。您可以通过执行“gem list rvm -dl”来验证这一点，这将显示所请求 gem 的名称、版本、描述和磁盘上的位置。

```
∴ gem list rvm -dl

*** LOCAL GEMS ***

rvm (1.11.3.3)
    Authors: Wayne E. Seguin, Michal Papis
    Homepage: https://rvm.beginrescueend.com/
    Installed at: /home/me/.rvm/gems/ruby-1.9.3-p194@global

    RVM Ruby Gem Library
∴ 
```

我不知道您为什么要删除它，但是您会按照安倍所说的第二选择来做。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-25T08:36:58.540

为了提供更多详细信息，RVM 与 POW 一起使用，这是已知问题：[https ://github.com/37signals/pow/issues/271](https://github.com/37signals/pow/issues/271)

最简单的解决方案（在项目目录中）：

```
rvm env . > .powenv 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-07-20T13:48:44.103

内森做对了：[https ://stackoverflow.com/a/10306090/294449](https://stackoverflow.com/a/10306090/294449)

您过去必须在 deploy.rb 中执行 unshift，但最新版本的 RVM 使该 hack 不再需要。只需将其删除并将 rvm-capistrano gem 添加到您的 Gemfile。它就像一个魅力。

# netbeans - NetBeans - 用树枝文件突出显示 html 语法

> ID：10306025
> 
> 赞同：5
> 
> 时间：2012-04-24T21:09:21.630
> 
> 标签：netbeans, symfony, netbeans-7, netbeans-plugins

`NetBeans IDE 7.1.1`当我打开具有`twig`扩展名的文件时，我无法弄清楚如何突出显示我的 html 语法。

我尝试`php symfony framework plugin`为 NetBeans 安装，但没有任何改变。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:00:03.963

您不需要安装任何插件。

您只需添加一个新的文件扩展`twig`名

> NetBeans → 杂项 → 选项 → 文件

然后您需要将`twig`扩展​​名关联到`HTML`.

结果如下：

![彩色代码截图](../Images/4226a49e9beb2a8a508c20b65883f350.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T10:46:33.827

我刚刚找到并安装了这个适用于 NetBeans 7.0（及更高版本）的插件，它在我的 NetBeans 7.2.1 中运行良好。

PHP Twig 插件： http: [//plugins.netbeans.org/plugin/37069/php-twig](http://plugins.netbeans.org/plugin/37069/php-twig)

安装：0。下载插件。1\. 菜单 > 工具 > 插件 > 已下载 [找到并安装] 2\. 激活它。菜单 > 工具 > 插件 > 已安装 [选中并单击激活] 3\. 重新启动 NetBeans。（关闭并再次打开） 4\. 享受它；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T12:51:31.740

您可以做的最接近的事情是`twig`在选项卡中添加扩展名`Tools->Options->Miscellaneous->Files`并将 MIME 设置为`TPL (text/x-tpl)`. 通过执行此编辑器将不会显示 html 错误。

# ruby-on-rails - 使用acts_as_taggable_on用相同的标签标记一个对象N次

> ID：10306029
> 
> 赞同：1
> 
> 时间：2012-04-24T21:09:41.797
> 
> 标签：ruby-on-rails, tagging, acts-as-taggable-on

我正在使用acts_as_taggable_on，但现在有一个新要求：

**最终目标：**用户应该能够同意另一个用户所做的标签选择，使标签更加可信/可靠。

**我看到两种方法可以做到这一点：**

1) 做到这一点的一种方法是让一个对象用相同的标记多次标记（即，tag_id 在标记上下文中不需要是唯一的）。

我知道如何删除 tagging.rb 中的验证，但是如何更改代码以让多个用户使用相同的标签标记一个对象？是否像删除验证一样简单？

2.) 另一种方法是使用[thumbs_up](https://github.com/kitop/thumbs_up/)使标记可投票，因此用户可以对标记决定投赞成票/反对票。

这两个似乎都很弱，所以我倾向于推出我自己的标记解决方案，但我宁愿干——所以，任何关于哪种方法最好的见解，或者我错过了一些简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T22:33:06.783

实际上，acts_as_taggable_on gem 支持这个用例。关键是使用标签所有权功能：

```
@owner_a.tag(@taggable_object, :with => "list,of,tags", :on => :taggable_attribute)
@owner_b.tag(@taggable_object, :with => "list,of,neat,tags", :on => :taggable_attribute)

@taggable_object.taggable_attribute(@some_user, :locations) # => [#<ActsAsTaggableOn::Tag id: 1, name: "list">...] 
```

这将为您提供所有标签的列表，包括来自唯一所有者的重复标签，有效地允许每个用户一次使用特定标签标记对象。

我使用以下内容将该列表转换为具有每个标签计数的唯一标签哈希：

```
@taggable_object.taggable_attribute.inject(Hash.new(0)) {|h,i| h[i.name] += 1; h } # => { "list" => 2, ... "neat" => 1 } 
```

我使用它来查看用户已经将哪些标签应用于对象，这让我可以确定是否显示向下/赞成图标：

```
@taggable_object.owner_tags_on(@owner_1, :taggable_attribute); # => [#<ActsAsTaggableOn::Tag id: 1, name: "list">...] 
```

请记住，在使用所有权功能时，作为 taggable on 始终会覆盖以前的标签列表，因此添加另一个`@owner_a.tag(:taggable_object, :with => "new,tags"...)`将删除`@taggable_object`.

# jquery - jQuery焦点事件在选项卡更改时重复

> ID：10306030
> 
> 赞同：1
> 
> 时间：2012-04-24T21:09:59.197
> 
> 标签：jquery, events, focus

这是我注意到的一个非常奇怪的错误。我使用该`.focus()`事件在触发时将 div 附加到另一个 div。代码没问题，它工作正常，但是当我切换选项卡（我的意思是我打开另一个站点）然后返回到我使用`.focus`事件的那个时，结果重复。如果你想看代码就告诉我，但这是一个简单的事件调用，没有什么花哨的。这里有一些代码

```
<div id="song">
   <input type="text" id="post_title" name="title" value="Artist - Song" /><br />               
</div>

   var songSuggestion = '<div id="titleSuggest" style="width:270px; background:#37819d; color:white; margin:0 auto; ">Try this!</div>';

$('#post_title').focus(function(event){ 
    $(this).parent().append(songSuggestion);
    });

$('#post_title').blur(function(){
    $(this).parent().find('#titleSuggest').remove();
}); 
```

![在此处输入图像描述](../Images/be5fe02fb60db8c84668f25ff0a2578a.png) 编辑：这只发生在 chrome 上，在 Firefox 上这永远不会发生！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T21:41:39.467

好吧，所以我尽我所能尝试找出你想要构建的东西。如果您想尝试并详细说明，我可以为您提供帮助。这是[JSFiddle](http://jsfiddle.net/NUrCU/)，代码就在下面。

我建议您不要添加 div，而是隐藏某个 div，然后在触发焦点功能后显示数据。

HTML

```
​​​​​​​​​​​​​​​&lt;form>
   <input type="text" name="firstname" />
   <div class="append-div">Try This Out !</div>             

   <input type="text" name="lastname" />        
   <div class="append-div">Try This Out !</div>
</form> 
```

CSS

```
html { margin: 10px; }

input { 
  border: 1px solid #000; 
  padding: 3px 7px; 
  width: 200px; 
  margin-top: 10px; 
  display: block; 
}

.append-div { 
  width: 200px; 
  padding: 3px 7px; 
  height: 15px; 
  background-color: #999; 
  border: 1px solid #2d2d2d; 
  margin-bottom: 20px; 
  display: none; 
  color: #000; 
} 
```

jQuery

```
$("input").focus(function() {

   if ($(this).next(".append-div").is(":hidden")) {

      $(this).next(".append-div").show();

   } else {
   }

}); 
```

​ 有任何问题欢迎提问！

# java - Java：ClassNotFoundException - 与输入文件有关吗？

> ID：10306034
> 
> 赞同：0
> 
> 时间：2012-04-24T21:10:16.110
> 
> 标签：java

在 Apache Nutch/Solr 中出现以下错误：

```
java.lang.RuntimeException: Error in configuring object
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:93)
    at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:64)
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
    at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:354)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:307)
    at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:177)
Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:88)
    ... 5 more
Caused by: java.lang.RuntimeException: Error in configuring object
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:93)
    at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:64)
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
    at org.apache.hadoop.mapred.MapRunner.configure(MapRunner.java:34)
    ... 10 more
Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:88)
    ... 13 more
Caused by: java.lang.NoClassDefFoundError: opennlp/tools/sentdetect/SentenceDetector
    at java.lang.Class.getDeclaredConstructors0(Native Method)
    at java.lang.Class.privateGetDeclaredConstructors(Class.java:2389)
    at java.lang.Class.getConstructor0(Class.java:2699)
    at java.lang.Class.newInstance0(Class.java:326)
    at java.lang.Class.newInstance(Class.java:308)
    at org.apache.nutch.plugin.Extension.getExtensionInstance(Extension.java:160)
    at org.apache.nutch.indexer.IndexingFilters.<init>(IndexingFilters.java:69)
    at org.apache.nutch.indexer.IndexerMapReduce.configure(IndexerMapReduce.java:62)
    ... 18 more
Caused by: java.lang.ClassNotFoundException: opennlp.tools.sentdetect.SentenceDetector
    at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:315)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:250)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:398)
    ... 26 more
2012-04-24 13:59:18,713 ERROR solr.SolrIndexer - java.io.IOException: Job failed! 
```

我修改了一个名为 BasicIndexingFilter.java 的过滤器类以使用 OpenNLP 的 SentenceDetector 类。BasicIndexingFilter.java 的相关部分：

```
SentenceDetector sentenceDetector = null;

        InputStream modelIn = null;
        try {
            // Loading sentence detection model
            modelIn = getClass().getResourceAsStream("/models/sentdetect/en-sent.bin");
            final SentenceModel sentenceModel = new SentenceModel(modelIn);
            modelIn.close();

            sentenceDetector = new SentenceDetectorME(sentenceModel);

        } catch (final IOException ioe) {
            LOG.info("Model input error");
            ioe.printStackTrace();
        } finally {
            if (modelIn != null) {
                try {
                    modelIn.close();
                } catch (final IOException e) {} // oh well!
            }
        } 
```

我已将此添加到 build.xml 文件中：

```
 <property name="lib.dir"     value="lib"/>

    <path id="classpath">
        <fileset dir="${lib.dir}" includes="**/*.jar"/>
    </path> 
```

它现在编译得很好，但我得到了运行时错误。我是 Java 新手，但我猜它与我尝试加载的模型文件有关：

```
modelIn = getClass().getResourceAsStream("/models/sentdetect/en-sent.bin"); 
```

`opennlp-tools-1.5.0.jar`SentenceDetector 类在我的`./lib folder`，模型文件`en-sent.bin`在`.lib/models/sentdetect`. BasicIndexingFilter 类在其他地方，它都是从 Nutch 的 bin 文件中运行的。

指向模型文件或其他东西有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T21:15:26.167

我认为您缺少`maxent 3.0.0 jar`类路径中的文件。如果你确实有这个，那么尝试将[opennlp-tools-1.5.1-incubating.jar](http://repo1.maven.org/maven2/org/apache/opennlp/opennlp-tools/1.5.1-incubating/opennlp-tools-1.5.1-incubating.jar)添加到你的库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:20:43.950

由于您使用的是 jar 文件中的应用程序，因此请向其中添加 Manifest.mf。在清单中插入要添加到类路径中的 jar 文件。请按照此处的说明进行操作：http: [//java.sun.com/developer/Books/javaprogramming/JAR/basics/manifest.html#applications](http://java.sun.com/developer/Books/javaprogramming/JAR/basics/manifest.html#applications) 希望这可以帮助您。

# css - CSS CDN：是否有一些我可以使用的公共 css 文件（链接到）

> ID：10306039
> 
> 赞同：2
> 
> 时间：2012-04-24T21:10:32.760
> 
> 标签：css, cdn

对于个人/演示/正在进行的工作，我不想制作自己的 css 文件，但仍然应用一些漂亮的标准布局。我可以链接到一些公共CSS吗？类似于 jQuery CDN 链接？

我想在我的标题中这样做：

```
<link rel="stylesheet" href="http://someone.com/styles/xyz/layout.css" type="text/css" /> 
```

然后在我的 html 文件中可能有一个或两个包装器 div（例如`<div class="header">...</div><div class="content">...</div>`）

我查看了 jQuery UI 模板，但它们有点太复杂了。他们要求我为每个按钮、输入、复选框等设置类名。

谢谢，奥拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:11:42.187

[Twitter Bootstrap](http://twitter.github.com/bootstrap/)是目前流行的 CSS 起点

# java - 有趣的记忆值

> ID：10306040
> 
> 赞同：1
> 
> 时间：2012-04-24T21:10:42.373
> 
> 标签：java, memory, heap-memory

我写了一个代码，它使用了大量的内存，所以我正在监视它的输出。结果有点有趣，有人能解释一下为什么我的空闲内存会减少而不是增加，尽管我在不断地分配对象，为什么它会以一个值堆叠？

这是我的监控代码：

```
Thread th = new Thread(new Runnable() {

        @Override
        public void run() {
            while(true){
                System.out.println("" + (Runtime.getRuntime().freeMemory()/1024));
                try {
                    Thread.sleep(5000);
                } catch (InterruptedException ex) {
                    Logger.getLogger(FaAlgoritmus.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        }
    });
    th.start(); 
```

结果：

> 42454
> 49666
> 109869
> 76995
> 39779
> 125981
> 89814
> 191056
> 137835
> 142766
> 121279 50221
> 130072
> 75460
> 143199
> 88164
> 145557 75224 27234 136953 87933 34991 151526 99113 47005 163787 56278 44491 44491 44491 44491 44491 44491 44491 44491 44491 44489 44489 44489

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T21:13:14.363

> 有人可以解释一下为什么我的免费内存减少而不是增加

新对象在伊甸园空间中分配。一旦你用完 Eden 空间，一个小型垃圾收集器就会启动并清除未引用的对象（将所有引用的对象提升到幸存者空间之一）。通常，这会导致可用内存量的跳跃。

# python - 从控制台运行 python 脚本

> ID：10306041
> 
> 赞同：0
> 
> 时间：2012-04-24T21:10:52.333
> 
> 标签：python, console

对python完全陌生，我想做以下事情：

我有这个代码：

```
def assem(myFile):
print "Hello ,World!" 
import myParser
from myParser import Parser
import code
import symboleTable
from symboleTable import SymboleTable

newFile = "Prog.hack"
output = open(newFile, 'w')
input = open(myFile, 'r')

prsr=Parser(input)
while prsr.hasMoreCommands():
    str = "BLANK"
    if(parser.commandType() == Parser.C_COMMAND):
        str="111"+code.comp(prsr.comp())+code.dest(prsr.dest())+code.jump(prsr.jump())+"\n"

    output.write(str)
    prsr.advance() 
```

检查压痕，没关系，这里有点乱。

该程序需要从控制台运行并接收一个名为`Add.asm`

使它运行的控制台命令是什么？

试过：

```
 python assembler.py Add.asm 
```

不工作。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T21:12:46.323

这就是您要查找的内容： http: [//docs.python.org/library/optparse.html](http://docs.python.org/library/optparse.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:19:28.833

optparse 确实是更高级的 cl 选项所需要的。但是，您可以`python assembler.py <filename>`使用一个简单的`if __name__ == "__main__"`块。代替`argparse`or `optparse`，您可以使用`sys.argv[1]`脚本的单个简单参数。

```
def assem(myFile):
    print "Hello ,World!" 
    import myParser
    from myParser import Parser
    import code
    import symboleTable
    from symboleTable import SymboleTable

    newFile = "Prog.hack"
    output = open(newFile, 'w')
    input = open(myFile, 'r')
    prsr = Parser(input)

    while prsr.hasMoreCommands():
        str = "BLANK"
        if(parser.commandType() == Parser.C_COMMAND):
            str= "111" + code.comp(prsr.comp()
                ) + code.dest(prsr.dest()) + code.jump(prsr.jump()
                ) + "\n"

        output.write(str)
        prsr.advance()

if __name__ == "__main__":
    import sys
    assem(sys.argv[1]) 
```

您还需要 google`python string formatting`并找到类似[http://docs.python.org/library/stdtypes.html#string-formatting的链接](http://docs.python.org/library/stdtypes.html#string-formatting)

# php - 简短的 if 子句语法和分隔输入

> ID：10306042
> 
> 赞同：0
> 
> 时间：2012-04-24T21:10:56.810
> 
> 标签：php, html, syntax, if-statement, foreach

我想到了这样的语法：

```
$suffix1 = ($a === 1) ? 'this is one.' : 'this is:'
   foreach ($keywords as $keyword) {
       ' and '
       .$keyword
  }; 
```

在输出的情况下应该是什么样子`$a === 1`：**这是一个。** 在不`$a === 1`输出的情况下：**这是：一`and`二三`and`**...

```
$keywords 
```

来自输入类型的文本，将被分割为：

```
$sepkeywords = preg_split('/[\s]+/', $keywords); 
```

所以如果有人能告诉我如何得到这个，我真的很感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:37:01.413

您在寻找内[爆](http://www.php.net/manual/en/function.implode.php)功能吗？

```
$suffix1 = ($a === 1) ? 'this is one.' : 'this is: ' . implode(' and ', $keywords); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:44:35.863

如果你问我，最短的方法是：

```
$suffix1 = 'this is'.($a === 1 ? ' one' : ': '.implode(' and ',$keywords)).'.'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T21:34:32.307

您可以将 foreach lopp 分开并将其放入变量中并尝试

一些示例 [http://davidwalsh.name/php-shorthand-if-else-ternary-operators](http://davidwalsh.name/php-shorthand-if-else-ternary-operators)

[http://www.php.net/manual/en/language.operators.comparison.php](http://www.php.net/manual/en/language.operators.comparison.php)

```
$suffix1 = ($a === 1) ? 'this is one.' : 'this is:'.$onetwothree 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T21:15:08.773

您可以将第二个字符串生成为一个函数，并在您的结构中调用该函数。

# javascript - 使用 Javascript 连接到 MongoDB

> ID：10306044
> 
> 赞同：3
> 
> 时间：2012-04-24T21:10:57.460
> 
> 标签：javascript, node.js, mongodb

我正在做一个有趣的项目（webcalender），我想使用 mongoDB。MongoDB 正在运行，我想出了如何处理它。我也得到了与 PHP 的连接。我想知道是否有机会使用简单的 javascript 连接到 MongoDB？

我搜索了很多，我总是通过 Node.js？我需要 Node.js 通过 Javascript 连接到 mongoDB 吗？

有人有很好的链接吗？教程？或争论为什么我不应该这样做？

感谢帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T21:18:36.913

有客户端方法可以做到这一点，但它根本不安全。缺乏安全性有几个原因。
1.连接信息在源中供任何人查看。
2\. 如果你使用像 mongoHQ 这样的服务，它是一个连接到 Mongo 的宁静 API，你的秘密就会暴露在客户端。
这两个原因都让我害怕到不使用允许我在客户端连接到 mongo 的 JS 库。

您的应用程序是在节点中构建的吗？还是 PHP？

如果 PHP 我知道 MongoDB 有一个 PEAR 库，那么您可以在客户端使用 javascript 与 php 交互以在数据库上执行您需要的操作。

如果应用程序是在 node.js 中构建的，那么确定为什么不呢？我在节点中使用带有 express 的 Mongoose 取得了成功。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:18:02.943

是的，您需要 Node.js 才能通过 JavaScript 访问 MongoDB，因为简单的纯 JavaScript 运行在用户浏览器上，而不是在服务器上，而 Node.js 旨在运行在服务器上。

直接从浏览器访问数据库将是一个巨大的安全问题，因为浏览页面的人始终可以使用 JS 文件。

# javascript - 我还需要 $(document).ready(function(){ }) 吗？

> ID：10306045
> 
> 赞同：3
> 
> 时间：2012-04-24T21:10:59.103
> 
> 标签：javascript, jquery

我已经用 javascript 开发了几个月，并且在我`$(document).ready(function(){`所有脚本的开头一直在使用。我注意到其他人不会在他们的脚本中使用它，但如果没有它我似乎无法让我的工作。我想让我的代码更干净，但是对于我所有的谷歌搜索，我似乎无法弄清楚如何摆脱它。

我知道它告诉浏览器在页面加载后立即执行我的脚本，但是我可以设置一些全局的东西，这样我就不需要在页面加载时明确告诉浏览器执行我的每个脚本？还是脚本在我的 html 文件中的位置是一个更全球性的问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T21:12:53.157

您需要 document.ready 可能是因为您在加载之前与 DOM 交互。脚本如何操作尚不存在的元素？

如果您将脚本放在文件末尾，则不需要它。对于许多 Javascript 文件，这样做也是一种很好的做法，因为它们可能需要时间来处理（特别是如果它们是在外部托管的）。将它们放在文件末尾通常会[加快页面加载时间](http://betterexplained.com/articles/speed-up-your-javascript-load-time/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-24T21:12:37.493

全部`$(document).ready(function() { ... });`或`$(function() { ... });`所做的是等待文档准备好进行操作。您应该使用`$(document).ready(function() { ... });`or`$(function() { ... });`如果您的脚本是内联的或在该`<head />`部分中，因为 JavaScript 会按照它在页面上出现的顺序执行，否则。

要取消`$(document).ready(function() { ... });`or `$(function() { ... });`，只需在所有内容之后将脚本向下移动到页面底部，就在结束`</body>`标记之前。

无论如何，将脚本放在底部确实是一种最佳实践。对于这个和其他最佳实践，我建议您查看[Html5Boilerplate](http://html5boilerplate.com)和[Yahoo! 最佳实践](http://developer.yahoo.com/performance/rules.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T21:14:32.173

该`$(document).ready()`约定是 jQuery 的一部分，而不仅仅是 JavaScript。从他们[关于准备功能的文档中](http://docs.jquery.com/Tutorials%3aIntroducing_%24%28document%29.ready%28%29)：

> 这是了解 jQuery 的第一件事：如果你想让一个事件在你的页面上工作，你应该在 $(document).ready() 函数中调用它。它里面的所有东西都会在 DOM 被加载并且页面内容被加载之前加载。

所以是的，它是必需的。jQuery 确实为此提供了简写，因此您可以执行以下操作：

```
$(function() {
  //jquery code
}; 
```

# c# - “参数字典包含非可空类型参数的空值”？

> ID：10306052
> 
> 赞同：0
> 
> 时间：2012-04-24T21:11:42.363
> 
> 标签：c#, asp.net-mvc

运行时出现 id 空错误。这是我所有的部分。

这是我的 DAL，ProjectDB

```
 public static List<Product> IsOrganic(int lotid)
    {
        using (var db = new ProductDB())
        {   //Selects from database in SQL what we need
            //IsDamaged is Organic, and bool for true/false for food
            DbCommand cmd = db.GetSqlStringCommand("SELECT * FROM PRODUCTS WHERE ORGANIC = 1");

            return FillList(db.ExecuteDataSet(cmd));
        }
    } 
```

这是我的经理

```
public List<Product> IsOrganic(int lotid)
    {

        return ProductDB.IsOrganic(lotid);

    } 
```

这是我的控制器

```
 public ActionResult Organic(int id)//Store/Organic
    {
        ProductManager mgr = new ProductManager();

        var list = mgr.IsOrganic(id);

        return View(list);
    } 
```

另外，这是我的全球

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:42:05.657

如果您使用的是 C# 4，请使用可选参数的默认值

```
public ActionResult Organic(int id = 0)//Store/Organic
{
    ProductManager mgr = new ProductManager();

    var list = mgr.IsOrganic(id);

    return View(list);
} 
```

如果仅 C# 3，则使用 DefaultValue 属性作为可选参数

```
public ActionResult Organic(
      [System.ComponentModel.DefaultValue(0)] int id) //Store/Organic
{
    ProductManager mgr = new ProductManager();

    var list = mgr.IsOrganic(id);

    return View(list);
} 
```

但我想知道你为什么这样调用 Organic 方法，即没有参数。

如果您想测试 StoreController 的 Organic 操作是否有效，请在 url 中输入：

[http://localhost/Store/Organic/7](http://localhost/Store/Organic/7)

或这个：

[http://localhost/Store/Organic?id=7](http://localhost/Store/Organic?id=7)

如果您为 StoreController 的 Organic 操作的参数 id 使用自定义名称，请说 organicId：

```
public ActionResult Organic(int organicId = 0) //Store/Organic?organicId=7
{
    ProductManager mgr = new ProductManager();

    var list = mgr.IsOrganic(id);

    return View(list);
} 
```

，这个网址不起作用：[http://localhost/Store/Organic/7](http://localhost/Store/Organic/7)

，不会出现运行时错误，但不会将有机ID 值传递给值，因此其值始终为 0

，你必须改用这个：[http://localhost/Store/Organic?organicId=7](http://localhost/Store/Organic?organicId=7)

顺便问一下，运行时错误从何而来？点击链接后？尝试将鼠标悬停在该链接上并查看浏览器的状态栏，您的 URL 必须符合： [http://localhost/Store/Organic/7](http://localhost/Store/Organic/7)或[http://localhost/Store/Organic?id=7](http://localhost/Store/Organic?id=7)。

如果看起来不是这样，请将您的 ActionLink 更改为：

`@Html.ActionLink("Store", "Organic", new {id = 7})`

或者如果您使用的是纯 HTML：

```
<a href="Store/Organic/7"> 
```

或这个：

```
<a href="Store/Organic?id=7"> 
```

# c++-cli - pin_ptr 使用 reinterpret_cast 或 static_cast 替代 (void**)？

> ID：10306062
> 
> 赞同：0
> 
> 时间：2012-04-24T21:12:13.970
> 
> 标签：c++-cli

有没有使用以下的替代方法？

```
class IGraphBuilder;

public ref class Device
{
private:
    IGraphBuilder* pGraphBuilder;

public:
    void Configure()
    {
        pin_ptr<IGraphBuilder*> ppGraphBuilder = &pGraphBuilder;

        HRESULT hr = CoCreateInstance(CLSID_FilterGraph,
            NULL,
            CLSCTX_INPROC,
            IID_IGraphBuilder, (void**)ppGraphBuilder); 
```

reinterpret_cast(ppGraphBuilder) 编译，但如果这对于这种情况是正确的，我有点困惑。

如果这不是 C++/CLI（`&NativeMember`实际上是指`interior_ptr<Type>(NativeMember)`），我会简单地使用`static_cast<void**>(&pGraphBuilder)`，但即使正确转换为`pin_ptr`以下内容也无法编译

```
pin_ptr<IGraphBuilder*> ppGraphBuilder = &pGraphBuilder;
static_cast<void**>(ppGraphBuilder) 
```

有什么解决方案还是我被迫使用 (void**) 因为 pin_ptr 很奇怪？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:26:13.330

`reinterpret_cast`（因此 C 演员）可能不好，尽管由于`pin_ptr`. 事实上，你必须调用转换运算符 from `cli::pin_ptr<IGraphBuilder*>`to `IGraphBuilder**`first （因此来自编译器的抱怨）。

```
reinterpret_cast<void**>(static_cast<IGraphBuilder**>(ppGraphBuilder)) 
```

是正确的。您可能想先引入一个类型的中间变量`IGraphBuilder**`：

```
pin_ptr<IGraphBuilder*> p = &pGraphBuilder;
IGraphBuilder** ppGraphBuilder = p;

HRESULT hr = CoCreateInstance(CLSID_FilterGraph,
        NULL,
        CLSCTX_INPROC,
        IID_IGraphBuilder, reinterpret_cast<void**>(p)); 
```

# javascript - EmberJS 的嵌套 HandlebarsJS #each 助手不起作用

> ID：10306063
> 
> 赞同：4
> 
> 时间：2012-04-24T21:12:18.260
> 
> 标签：javascript, ember.js, handlebars.js

我慢慢开始掌握 EmberJS 的窍门。不幸的是，我遇到了一个我似乎无法解决的问题。

我有一个复杂的数据结构，我通过 JSON 检索它，有多个嵌套数组，我似乎无法嵌套 #each 助手。

我已将模板设置如下（缩短）：

```
{{#each Servers}}
     <div class="server">
          <h1>{{unbound Name}}</h1>
          Time: {{jsonDate CurrentTime}}<br />

          <table>
               {{#each Processes}}
                    <tr>
                         <td>{{unbound Name}}</td>
                         <td>{{unbound Location}}</td>
                    </tr>     
               {{/each}}
          </table>
     </div>
{{#/each}} 
```

第二个循环似乎没有运行，当我修改 Ember 以记录一条消息时，#the second each 被调用，但它似乎不知道该怎么做。

当我用#Queue 替换第二个#each 时，它可以工作，但是在-element 之前，会为列表中的每个元素插入一个“未定义”-text（减1）。

当我将#each 移出另一个循环并放入队列的直接路径（例如Servers.0.Queue）时，它工作正常，所以它肯定不是数据。

我该如何解决？如果嵌套#each 是不可能的，我该如何为其他方法添加“未定义”文本？还有其他可能吗？

PS。出于性能原因，我使用 unbound，我一次更新了 Servers 对象并观察到这一点，因此不需要使用绑定属性 - 因为我注意到它显着降低了浏览器性能（13% CPU 使用率，而 unbound 给了我 0 %）。不确定是否相关。

**编辑**

请参阅：http: [//jsfiddle.net/PTC9B/7/](http://jsfiddle.net/PTC9B/7/)

ServerOverview2a 方法毕竟有效，显然 ServerOverview2b 生成我之前描述的“未定义”文本 - 可能应该为此提交错误报告？

我现在的问题是：**为什么嵌套的#each 不起作用而#Processes 起作用？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T08:04:54.230

看起来您的哈希中的属性导致了麻烦：使用大写属性`Processes`不起作用 - 如果您将其更改为`processes`帮助程序`each`按预期工作，请参阅[http://jsfiddle.net/pangratz666/ndkWt/](http://jsfiddle.net/pangratz666/ndkWt/)：

```
<script type="text/x-handlebars" data-template-name="app-server">
    <h1>Default</h1>
    {{#each data.Servers}}
        <div class="server">
            <h1>{{unbound this.Name}}</h1>

            Time: {{unbound this.CurrentTime}}<br />

            <table>
                {{#each this.processes}}
                    <tr>
                        <td>{{unbound Name}}</td>
                        <td>{{unbound Location}}</td>
                    </tr>     
                {{/each}}
            </table>
        </div>
    {{/each}}
</script>​ 
```

```
App = Ember.Application.create({
    ready: function() {
        Ember.View.create({
            templateName: 'app-server',
            dataBinding: 'App.dataController.data'
        }).append();

        App.dataController.getServers();
    }
});

App.dataController = Ember.Object.create({
    data: {},
    getServers: function() {
        this.set('data', Ember.Object.create({
            "Servers": [
                {
                "Name": "USWest",
                "CurrentTime": "1337",
                "processes": [
                    {
                        "Name": "apache.exe",
                        ...
                    }
                ]}
            ]
        }));
    }
});​ 
```

* * *

恕我直言，`this.Processes`应该在`#each`帮助程序中工作，所以这可能是一个错误。您是否能够更改从服务器获取的 JSON 的属性名称？否则，您可能会编写一个助手，在使用 JSON 之前将其属性名称小写...

* * *

另一个注意事项：`Application#ready`在您提供的 JSFiddle 中不起作用，因为您指定了要执行的 JS `onDomReady`（选择 JSFiddle 左上角的下拉菜单）。如果您将其更改为`no wrap`您可以`App`在`ready`回调中访问。

* * *

关于命名的另一个注意事项：实例应命名为小写，类应命名为大写。所以它会`App.serverOverview1 = Ember.View.create({ ... });`在你的例子中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T14:56:55.593

Ember 尝试通过它是否具有大写属性来推断您的路径是绝对（全局）还是相对（本地）。在这种情况下，Ember 正在寻找`Processes`不存在的全局属性。正如@pangratz 指出的那样，简单的解决方案是使用小写字母。有关详细信息，请参阅[http://www.emberist.com/2012/04/09/naming-conventions.html](http://www.emberist.com/2012/04/09/naming-conventions.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T12:58:24.833

这是我做的后处理方法：

```
function decapitalizeJSON(data, dataType) {
    var output = (dataType == undefined || dataType == '[object Object]') ? {} : [];
    var value, type;

    for(var key in data) {
        if(!data.hasOwnProperty(key)) {
            continue;
        }

        value = data[key];
        type = Object.prototype.toString.apply(value);

        if (type == '[object Array]' || type == '[object Object]') {
            output[key.charAt(0).toLowerCase() + key.substr(1)] = decapitalizeJSON(value, type);
        }
        else {
            output[key.charAt(0).toLowerCase() + key.substr(1)] = value;
        }
    }

    return output;
} 
```

然而，它非常缓慢 - 不足为奇。需要has`hasOwnProperty`来防止它尝试复制 Ember 添加到 Array 对象的方法，并且它是递归的，以确保它对所有内容进行大写。在我的情况下，它可能可以优化为仅对数组进行大写，但随后您再次混合命名约定。

相反，我只是要求 API 供应商添加一个“emberHack”属性，如果通过，它会为我提供正确的 JSON Ember 期望并且已经被授予 - 但据说是一个“la脚”的要求。我可以向你保证，大多数 API 供应商不会像我的那样宽容。

# c# - MonoTouch.Dialog 搜索栏在返回视图时丢失搜索查询

> ID：10306064
> 
> 赞同：2
> 
> 时间：2012-04-24T21:12:19.613
> 
> 标签：c#, xamarin.ios, monotouch.dialog

我正在使用 MT.D 列出 DialogViewController 中的人员。EnableSearch 已打开，您可以过滤列表中的项目。但是，如果你推到另一个视图，然后回来，搜索栏是空的。我能够通过覆盖`OnSearchTextChanged (string text)`字符串并将其存储到本地字段来恢复使用的搜索查询，当视图重新成为焦点时，我使用以下代码：

```
public override ViewDidAppear (bool animated)
{
    base.ViewDidAppear (animated);
    if (EnableSearch && !string.IsNullOrWhiteSpace (lastSearchQuery))
    {
        this.SearchButtonClicked (lastSearchQuery); // this inserts text
        this.StartSearch (); // no clue what this is doing
        this.ReloadData (); // does nothing but was worth a try
    }
} 
```

该代码将文本插入搜索栏中并显示它，但除非您输入某些内容，否则我无法过滤它。键盘出现在视野中，并且有一个搜索按钮，但它什么也没做。有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T05:11:31.593

我认为您所缺少的只是调用 DialogViewController 上的 PerformFilter。

我输入了一个快速示例来显示行为。我从来没有看到你观察到的确切行为。我不必重新填充搜索字段。作为参考，我使用的是 Monotouch 5.2.11。

```
using System;
using System.Linq;
using MonoTouch.UIKit;
using MonoTouch.Dialog;
using MonoTouch.Foundation;

namespace delete201204242A
{
    [Register ("AppDelegate")]
    public partial class AppDelegate : UIApplicationDelegate
    {
        UIWindow _window;
        UINavigationController _nav;
        MyDialogViewController _rootVC;

        public override bool FinishedLaunching (UIApplication app, NSDictionary options)
        {
            _window = new UIWindow (UIScreen.MainScreen.Bounds);

            RootElement _rootElement = new RootElement ("LINQ root element") {
                new Section ("List") {
                    from x in new Expense [] { new Expense () {Name="one"}, new Expense () {Name="two"}, new Expense () {Name="three"} }
                    select (Element)new BindingContext (null, x, x.Name).Root
                }
            };

            _rootVC = new MyDialogViewController (_rootElement);
            _rootVC.EnableSearch = true;
            _nav = new UINavigationController (_rootVC);

            _window.RootViewController = _nav;

            _window.MakeKeyAndVisible ();

            return true;
        }

        public class MyDialogViewController : DialogViewController
        {
            public MyDialogViewController (RootElement root) : base (root) {}

            public string SearchString { get; set; }            
            public override void ViewDidAppear (bool animated)
            {
                base.ViewDidAppear (animated);
                if (!string.IsNullOrEmpty (SearchString))
                    this.PerformFilter (SearchString);
            }
            public override void OnSearchTextChanged (string text)
            {
                base.OnSearchTextChanged (text);
                SearchString = text;
            }
        }

        public class Expense
        {
            [Section("Expense Entry")]

            [Entry("Enter expense name")]
            public string Name;
            [Section("Expense Details")]

            [Caption("Description")]
            [Entry]
            public string Details;
        }

    }
} 
```

# flash - IE9 在“某些”刷新时无法加载 Flash（使用 AS 2.0）

> ID：10306072
> 
> 赞同：1
> 
> 时间：2012-04-24T21:12:51.827
> 
> 标签：flash, internet-explorer, internet-explorer-8, internet-explorer-7, internet-explorer-9

**问题是什么？**
Internet Explorer 9（本地和网络）无法在随机刷新时加载我的 Flash 横幅。例如，我刚刚完全重新加载了页面 19 次，第 19 次加载了横幅。如果我使用强制刷新 (CTRL+F5) 或完全清除缓存（甚至手动转储 Internet 临时文件目录），则无法解决问题。这让我相信这不是缓存问题。Firefox 和 Chrome 总是完美地加载它，但我需要它在 IE 中工作，因为该网站主要面向该受众。

**我如何导出这个 Flash 文件并嵌入它？**
我正在使用使用 Flash CS5 的 Flash 横幅，将 .swf 导出为 Flash Player 8 / Actionscript 2.0。

我已经像 Dreamweaver CS5 默认那样嵌入了 Flash，但如果 Flash 播放器不存在或早于 Flash Player 6，则添加了一个备用（图像）。这是嵌入代码：

```
<object id="FlashID" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="778" height="313" title="title">
    <param name="movie" value="file.swf" />
    <param name="quality" value="high" />
    <param name="wmode" value="transparent" />
    <param name="swfversion" value="6.0.65.0" />
    <!-- This param tag prompts users with Flash Player 6.0 r65 and higher to download the latest version of Flash Player. Delete it if you don’t want users to see the prompt. -->
    <param name="expressinstall" value="Scripts/expressInstall.swf" />
    <!-- Next object tag is for non-IE browsers. So hide it from IE using IECC. -->
    <!--[if !IE]>-->
    <object type="application/x-shockwave-flash" data="file.swf" width="778" height="313" title="title">
      <!--<![endif]-->
      <param name="quality" value="high" />
      <param name="wmode" value="transparent" />
      <param name="swfversion" value="6.0.65.0" />
      <param name="expressinstall" value="Scripts/expressInstall.swf" />
      <!-- The browser displays the following alternative content for users with Flash Player 6.0 and older. -->
      <div class="alternative_logo">&nbsp;</div>
      <!--[if !IE]>-->
    </object>
    <!--<![endif]-->
  </object> 
```

如果有人能帮我解决这个问题，我将非常感激。感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:16:46.493

您应该考虑使用[swfobject](http://code.google.com/p/swfobject/)嵌入 SWF。它可以很好地处理各种浏览器怪癖。

取自[官方文档](http://code.google.com/p/swfobject/wiki/documentation)的示例：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <title>SWFObject - step 3</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <script type="text/javascript" src="swfobject.js"></script>

    <script type="text/javascript">
    swfobject.registerObject("myId", "9.0.115", "expressInstall.swf");
    </script>

  </head>
  <body>
    <div>

      <object id="myId" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="780" height="420">

        <param name="movie" value="myContent.swf" />
        <!--[if !IE]>-->
        <object type="application/x-shockwave-flash" data="myContent.swf" width="780" height="420">
        <!--<![endif]-->
          <p>Alternative content</p>
        <!--[if !IE]>-->
        </object>
        <!--<![endif]-->
      </object>
    </div>
  </body>
</html> 
```

# python - 用于运行可执行文件的python多线程进程

> ID：10306078
> 
> 赞同：2
> 
> 时间：2012-04-24T21:13:04.440
> 
> 标签：python, multithreading, executable

我正在尝试将在 Windows 上运行可执行文件并将文本输出文件管理到使用多个线程进程的版本的 python 脚本升级，这样我就可以利用多个内核。我有四个单独的可执行文件版本，每个线程都知道可以访问它们。这部分工作正常。我遇到问题的地方是它们同时运行并尝试打开（不同的）输出文件以确保它们正确运行并根据输出文件的内容做出反应。

具体来说，当运行三个线程时，两个会崩溃并出现以下错误，而一个继续工作：

```
Exception in thread Thread-4:
Traceback (most recent call last):
  File "C:\Python27\lib\threading.py", line 552, in __bootstrap_inner
    self.run()
  File "E:\HDA\HDA-1.0.1\Hm-1.0.1.py", line 782, in run
    conf = self.conf_file(Run)
  File "E:\HDA\HDA-1.0.1\Hm-1.0.1.py", line 729, in conf_file
    l = open(self.run_dir(Run)+Run, 'r').readlines()     #list of file lines
IOError: [Errno 2] No such file or directory: 'Path/to/Outputfile' 
```

这是由于线程未正确运行可执行文件造成的（即为什么没有创建“路径/到/输出文件”，因此无法找到）。但是其中一个线程可以正确执行此操作，而其他两个线程则不能。为什么我不能让多个线程运行不同版本的可执行文件有什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T02:04:39.133

[由于Global Interpreter Lock](http://wiki.python.org/moin/GlobalInterpreterLock)，Python 目前无法利用多个内核。无论如何，多线程往往充满了麻烦——如果可以的话，最好使用多个进程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T05:57:21.333

我不认为 GIL 本身不会自己杀死它，除非打开文件会让你陷入一些奇怪的死锁或自旋锁状态。 **一般来说，在这种情况下，你*需要***线程，因为你是 I/O-bound 。事实上，线程能够同时运行的事实可能会导致其他线程失败，而不是多次成功打开文件。

[在本演示文稿](http://www.dabeaz.com/python/GIL.pdf)的第十五张幻灯片中，作者指出 GIL 发布了阻塞 I/O 调用以给其他线程一个机会。

这里真正的问题似乎是文件资源的锁定。我不太确定 Windows 是如何工作的，所以我无法解释为什么这个错误会蔓延，但似乎只有一个线程实际上锁定了文件资源。

另一位发帖人关于多核和 GIL 的观点可能会发挥作用，因为您可能会在其他两个线程变得饥饿的情况下进行某种优先级反转，但我认为这不太可能，因为上面的演示文稿说线程在阻塞操作的中间释放其他线程的锁。

一个想法是尝试[`multiprocessing`](http://docs.python.org/library/multiprocessing.html)。我怀疑跨多个进程而不是线程读取文件会更好。

这是我在我的 OS 10.7.3 机器上编写和尝试的示例，它打开了一个文件`test`，其内容为`lol\n`：

```
import multiprocessing
import os

def open_file(x):
   with open(x, 'r') as file_obj:
     return file_obj.readlines()

a = multiprocessing.Pool(4)
print a.map(open_file, ['test']*4) 
```

这是我执行它时的结果：

```
➜  ~ git:(master) ✗ python open_test.py
[['lol\n'], ['lol\n'], ['lol\n'], ['lol\n']] 
```

# .net - Visual Studio 2010 中的引用转发（从库到可执行文件）

> ID：10306087
> 
> 赞同：0
> 
> 时间：2012-04-24T21:13:24.530
> 
> 标签：.net, visual-studio-2010, .net-4.0, system.data.sqlite, project-reference

我有一个 C# 库，它有 System.Data.SQLite 作为参考，还有一个使用该库的可执行文件（作为第二个项目）。

在库中，我有一个引用 System.Data.SQLite 中的类（特别是`SQLiteDataReader`类）的函数：

```
public static IEnumerable<T> SQLiteFetch<T>(Func<SQLiteDataReader, T> formator, string connectionString, string query) 
```

该库可以正确编译，但不能正确编译调用此函数的可执行文件。

这在构建时出现错误，说我“必须添加对程序集'System.Data.SQLite'的引用”。我知道这是由于 IEnumerable，但为什么不通过我的库转发引用？我真的必须在我的可执行文件中添加对 System.Data.SQLite 的引用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:31:41.127

程序集只知道它的直接引用（例如您的库），并且不会递归加载其引用的引用，因此您必须将引用添加到您的可执行文件中。

您的库可以包含一个从 SQLiteDataReader 继承的包装类来解决此问题，但除了您真的不希望可执行文件具有额外的引用之外，我没有看到这样做的任何特殊优势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:23:36.073

是的，您必须添加对可执行文件的引用，因为当您创建`formator`.NET 时，它期望它的类型为`Func<SQLiteDataReader, T>`. 而且由于您的可执行文件没有对 System.Data.SQLite 的引用，因此它不知道如何处理您的格式化程序。即使您作为格式化程序传递`null`也是如此。

# c++ - Windows Search C++(MFC) CFindFiles 路径分隔符

> ID：10306092
> 
> 赞同：0
> 
> 时间：2012-04-24T21:13:49.820
> 
> 标签：c++, search, mfc, path-separator

鉴于以下代码，我需要它在韩文/日文 Windows SO 上工作。它只是不起作用，我不知道为什么......

你们可以帮帮我吗？

```
void RecurseSearch(LPCTSTR pstr, CString serchTerm, CSimpleMap<CString,CString>* arr)
{
    CFileFind finder;
    // build a string with wildcards
    CString strWildcard;
    int code_point =  0x5c ;
    WCHAR chr = (WCHAR) code_point;
    strWildcard.Format(_T("%s%c*%s*"), pstr,chr,serchTerm);
    CString actualFolder;
    // start working for files
    BOOL bWorking = finder.FindFile(strWildcard);

    while (bWorking)
    {

        bWorking = finder.FindNextFile();
        actualFolder=finder.GetFilePath();
        // skip . and .. files; otherwise, we'd
        // recur infinitely!

        if (finder.IsDots())
            continue;

        // if it's a directory, recursively search it

        else if (finder.IsDirectory())
        {
            CString str = finder.GetFilePath();
            RecurseSearch(str, serchTerm, arr);
        }
        else
        {
            if(arr->GetSize()>200) return;
            if(arr->FindKey(finder.GetFileURL())==-1)
                arr->Add(finder.GetFileURL(),finder.GetFileURL());
        }
    }
    bWorking = finder.FindFile(pstr+(CString)chr+(CString)_T("*"));
    while(bWorking)
    {
        bWorking = finder.FindNextFile();
        actualFolder =finder.GetFilePath();
        if (!finder.IsDirectory() || finder.IsDots()) continue;
        else
        {
            RecurseSearch(actualFolder, serchTerm, arr);
        }

    }
    finder.Close();
} 
```

这段代码在美式 Windows 上工作得很好，但在韩语上却不行……我什至将路径分隔符设置为正确的 unicode，但什么也没有……

编辑：我已经确定了错误，它与 ItemNames 和 ItemDisplayNames 相关。我需要搜索 ItemDisplayNames，但 CFindFile 搜索 ItemName。

我将代码更改为使用 ISearchFolderItemFactory，然后执行 AQS 查询。

无论如何，TY伙计们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:23:07.913

使用反斜杠作为路径分隔符。无论当前使用哪种语言，反斜杠都被记录为在所有情况下都被接受。可能是 MFC 搞砸了……

这里有两个链接应该会有所帮助。

[http://msdn.microsoft.com/en-us/library/dd317748(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/dd317748(v=vs.85).aspx)

[http://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx#naming_conventions](http://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx#naming_conventions)

# 3d - 生成扫描的 2D 文本图片的 3D 表示

> ID：10306098
> 
> 赞同：0
> 
> 时间：2012-04-24T21:14:36.900
> 
> 标签：3d

我想生成一些可以使用 realD 眼镜查看的 2D 文本图像的 3D 表示。示例图像在[这里](https://imgur.com/bgLdo,E65lI#1)。

我看到了[这个帖子](https://stackoverflow.com/questions/8080154/how-to-create-3d-images-based-on-2d-images)，和我的很相似，但我只有这些图像的单张照片。有人可以指出一些可能对我有帮助的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T02:20:09.397

您可能想尝试一些geowall 人员使用的[立体图像显示应用程序。](http://www.geowall.org/software.html#stereo)

另外，您是否考虑过交替显示两个图像。这种[闪烁比较器](http://en.wikipedia.org/wiki/Blink_comparator)技术可以快速显示差异。[通过在示例中的](http://imgur.com/bgLdo,E65lI#1)*First Image*和*Second Image*链接上来回单击可以看到这种效果。

# jquery - jQuery Live Search：指定可搜索元素

> ID：10306099
> 
> 赞同：1
> 
> 时间：2012-04-24T21:14:41.707
> 
> 标签：jquery, jquery-plugins, livesearch

我在使用[jQuery Live Search 插件](https://github.com/nakajima/jquery-livesearch)时遇到了一些问题，指定哪些元素应该是可搜索的。我创建了几个 jsFiddles 来演示这个问题。

**注意：** jQuery Live Search 的默认用法只是过滤单词列表（[demo](http://nakajima.github.com/jquery-livesearch/)）。但是，我想要的用法从列表项中的内容块中过滤：

```
<li>
    <h2>Australia</h2>
    <p>Lorem ipsum dolor sit amet.</p>
<li> 
```

**所以有什么问题？**

将 定位`<li>`为可搜索元素效果很好 - 其中的所有内容都可以在实时搜索结果中搜索。

然而，尽管计数器显示了正确的结果，但定位`<h2>`（我想要搜索的唯一部分）会导致结果列表中断（全部隐藏）。

**我如何重现？**

使用以可搜索区域为目标的插件查看[此工作小提琴。](http://jsfiddle.net/alecrust/pcfLJ/)`<li>`正如您将看到的，搜索一个国家（区分大小写）可以正常工作（the `<h2>`）以及搜索“Lorem”返回所有 4 个结果（`<p>`也是可搜索的）。

我想要做的是只使`<h2>`可搜索的，而不是`<li>`. 这是那套[小提琴。](http://jsfiddle.net/alecrust/pcfLJ/4/)现在，当搜索一个国家时，会显示正确的结果编号，但该结果的编号`<li>`仍然不正确地隐藏。正确搜索“Lorem”不会返回任何结果，结果编号为 0。

似乎当`<li>`目标中的元素时，它会破坏`<li>`自身的显示/隐藏。这是插件的错误还是我做错了什么？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T21:59:13.287

问题在于这个回调：

```
on.results(function(results) {
    $('.no-filter-results').hide();
    $('.filter-results li').hide();
    results.show();
}); 
```

该`results`参数包含对您要定位的元素（在本例中为`h2`元素）的引用。

您正在将所有`li`元素设置为在此行中首先隐藏：

```
$('.filter-results li').hide(); 
```

然后将`h2`元素设置为使用此行可见：

```
results.show(); 
```

显然这不起作用，因为父级`li`仍然隐藏。

解决方案是在结果中显示父`li`级`h2`，如下所示：

```
results.parent('li').show(); 
```

这解释了为什么在您之前定位该`li`元素时它会起作用。

# twitter-bootstrap - 防止流体列在 iPhone 屏幕上换行

> ID：10306103
> 
> 赞同：30
> 
> 时间：2012-04-24T21:14:57.810
> 
> 标签：twitter-bootstrap

我正在做我的第一个 Bootstrap 项目，但有点卡住了。在页面的顶部，我想要左侧的徽标和右侧的 2 个按钮堆叠在一起。这是我到目前为止所拥有的：

```
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span4">
      <img src="/img/logo.png" width="120" />
    </div>
    <div class="span8">
      <a class="btn btn-large" href="#" style="width:100%;"><i class="icon-map-marker"></i> Find Location</a><br />
      <a class="btn btn-large" href="#" style="width:100%;"><i class="icon-comment"></i> Call Now</a>    
    </div>
  </div>
</div> 
```

它在桌面上按预期工作，但我在 iPhone 上， span8 列中断并出现在下一行。有没有办法覆盖这个？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-11-19T20:22:55.797

在 Bootstrap 3 中，有一组新的 CSS 类用于脚手架，它们包括允许您在较小的屏幕上禁用堆叠的功能。

新的 CSS 命名法使用“列”而不是“跨度”，它们有多种形式。“col-xs-”品种（超小）允许您设置即使在超小设备上也不会堆叠的网格。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-04-24T23:10:09.047

这是响应式网格的预期行为，当您调整屏幕大小时，您可以在引导文档页面（特别是[脚手架演示）上看到相同的效果。](http://twitter.github.com/bootstrap/scaffolding.html)您可以通过创建自己的类来克服这个问题，以将其包含在`span`您希望在移动设备上并排保存的标签中，我们可以通过将其包装到应该在具有屏幕大小的移动设备上触发的媒体查询中来完成它480px 或以下（又名 iphone），这样在达到该约束之前它不会影响桌面响应网格。

**CSS**

```
@media all and (max-width: 480px)  {
    .half {
        float: left !important;
        width: 50% !important;
    }
} 
```

[演示](http://jsfiddle.net/r5VCy/1/)，尝试在您的移动设备上查看此演示，[http://jsfiddle.net/r5VCy/1/show/](http://jsfiddle.net/r5VCy/1/show/)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-12-12T00:02:57.627

只是想添加到 Bootstrap 3 上的注释。我遇到了同样的问题，即列包装太早并且没有保持它们的宽度足够长（“启动模板”示例中的“col-lg-6”）。将其更改为“col-sm-6”就可以了 - 每个尺寸的参考都在这里：

[http://getbootstrap.com/css/#responsive-utilities](http://getbootstrap.com/css/#responsive-utilities)

# java - 怎么把边框变成泡泡卡通

> ID：10306104
> 
> 赞同：0
> 
> 时间：2012-04-24T21:15:03.437
> 
> 标签：java, android, graphics, border, drawable

因此，我想将布局的边框更改为漫画/卡通中的某种气泡。我知道我可以像这样改变我的边界：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list
xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
        <shape     android:shape="rectangle" >
            <corners  android:radius="5dip" />
            <stroke  android:width="2dip" android:color="@color/white"/>
        </shape>
    </item>
</layer-list> 
```

但我怎么能做尖的部分（看起来像三角形的部分）。我需要用它来指出我点击的内容。我知道这听起来很奇怪或有趣，但我需要尝试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T09:16:13.857

不，你不能那样做。您可以提供*Stroke Corner*但没有复杂的曲线（三角形），对于自定义形状，您可以使用视图和 onDraw()

```
Path path = new Path();
path.moveTo(160.0f, 240.0f);
path.lineTo(140.0f, 200.0f);
path.addArc(new RectF(140, 180, 180, 220), -180, 180);
path.lineTo(160.0f, 240.0f);
path.close(); 
```

这条路径将使用在画布中绘制，

**canvas.drawPath（路径，油漆）；**

![在此处输入图像描述](../Images/da8d12b524c7bd3e4d2d701b7485fd06.png)

`9Patch`更好地用概念来创造形象。![在此处输入图像描述](../Images/3f9e30dfeb90e3464157469629650181.png)

这个工具将有助于轻松构建 9Patch 图像[http://android.elex.pe.kr/a-better-9-patch-tool](http://android.elex.pe.kr/a-better-9-patch-tool)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T05:44:53.247

最简单的选择可能是制作一个看起来像气泡的 9-patch 图像。这将允许气泡增长到其中的文本大小，而不会拉伸或看起来很有趣。

否则直接绘制它可能会有点复杂——你需要在矩形底部绘制一个类似三角形的对象，或者用 XML 或者创建一个自定义组件并覆盖绘制方法——要复杂得多。

9-patch 图像用于许多 Android GUI 组件，如 Buttons 和 TeXtFields - 基本上您只需要创建 9-patch 图像，然后将其设置为组件的背景。这可以在 XML 中完成。

有很多创建 9-patch 图像的示例，android SDK 带有一个 9-patch 工具，可以为您提供的任何图像创建一个 9-patch。请参阅此链接以获取 9-patch 工具... [http://developer.android.com/guide/developing/tools/draw9patch.html](http://developer.android.com/guide/developing/tools/draw9patch.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T13:08:49.547

我制作了一个[示例项目](http://code.google.com/p/speechballoonsample/)，它显示了一个 ListView，其中所有项目都显示在语音气球中。随意下载和使用它。顺便说一句，那块灰泥不是偶然的。[它是原始OmniGraffle](http://www.omnigroup.com/products/OmniGraffle/)源艺术的投影。正如其他作者所建议的那样，它使用 9-patch 可绘制对象。 ![截屏](../Images/f20aaf5df9e8148c3ba36b80a1cd77b1.png)

# ruby-on-rails - HAML 部分 - 部分无法识别我在控制器中查询的对象

> ID：10306106
> 
> 赞同：0
> 
> 时间：2012-04-24T21:15:04.940
> 
> 标签：ruby-on-rails, ruby, haml, partials

我有这个控制器：

```
 def index
    @disclosures = Disclosure.where(:user_id => current_user.id)

    respond_to do |format|
      format.html{}
      format.js{}
    end

  end 
```

在 StackOverflow 的好人的帮助下，我现在可以让我的 HAML 指向这样的部分：

```
 = render :partial => "/influencers/disclosures/shared/list" 
```

但这部分抛出和异常：

```
-if disclosures.empty?
  .alert.alert-info
    %p=(no_disclosures_message || (t "influencers.influencer_dashboard.disclosures.no_disclosures"))
%table.table.influencer-disclosures
  %tbody
    -disclosures.each do |disclosure|
      =render "influencers/disclosures/shared/row", :disclosure => disclosure 
```

说：

```
undefined local variable or method `disclosures' for #<#<Class:0x133ca8a58>:0x133ca25e0> 
```

但这怎么可能呢？我刚刚在我的控制器中查询了该披露对象。知道为什么会发生这种情况以及如何解决吗？

谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T21:16:28.350

您需要在披露信息前加上@。这就是控制器将变量传递给视图的方式。

```
-if @disclosures.empty? 
```

和

```
-@disclosures.each do |disclosure| 
```

**更新**

解决此问题的另一种方法是更改​​您的渲染调用。这将使其与相同部分的其他调用站点向后兼容。

```
render :partial => "/influencers/disclosures/shared/list", :locals => {:disclosures => @disclosures} 
```

# oauth - offline_access 弃用和场景 3 和 4

> ID：10306115
> 
> 赞同：0
> 
> 时间：2012-04-24T21:15:49.977
> 
> 标签：oauth, facebook-oauth

每次阅读[https://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)时，我都比以前更加困惑。我正在寻找对场景 3 和 4（服务器端应用程序和客户端应用程序）下某些项目的一些说明

对于服务器端应用程序，它声明“如果在该用户仍有有效的 60 天 access_token 时进行调用，则第二次调用返回的 access_token 可能相同或可能已更改，但在任何一种情况下都过期时间将是全新的 60 天。”

*   这里所说的“呼召”是什么？
*   是否与初始 OAuth 流程中发生的访问令牌的授权代码交换相同？
*   还是客户端部分下描述的端点调用将令牌更新为 60 天？
*   如果是前者，那么在尝试更新令牌时授权码来自哪里？
*   它与原始回调中的授权代码相同还是我必须再次通过授权流程？

简而言之，服务器端应用程序能否不断更新 60 天令牌的生命周期？如果可以，那么如何？

关于客户端使用，该文档指出客户端必须进行端点调用（除其他外）传递应用程序的客户端 ID 和客户端密码。

*   我对“客户端”的解释可能是错误的，但我考虑的是在 Web 浏览器中运行的基于 JavaScript 的客户端。
*   如果这就是 Facebook 的想法，那么 JavaScript 代码真的应该知道客户端机密吗？（如果它被发送给客户，这将不是什么秘密。）

即便如此，它也表明 60 天的代币不能延长其寿命，并且必须首先获取一个新的 2 小时代币并用于获得 60 天的代币。这是文档的客户端部分，但此规则是否也适用于服务器端 60 天令牌？如果没有，那我再问一遍：如何在服务器端更新 60 天令牌的生命周期？

最后，一直萦绕在我脑海中的问题是：为什么 Facebook 采用了这种策略，而不是采用 OAuth 2 规范（Facebook 正在帮助定义的规范）中定义的刷新令牌？

编辑：再次阅读文件后的进一步想法/问题：

一开始它说“每次用户修改您的应用程序时都可以更新的长期过期时间”。我最初的假设是更新它的方法是在文档的后面调用端点。但是，除了端点在“客户端”标题下描述的事实之外，它还声明“请注意，端点只能用于扩展短期用户 access_tokens。如果您传递的 access_token 具有长时间的过期时间，端点将简单地将相同的 access_token 传回给您，而不会更改或延长过期时间。” （“长期存在”的错字来自 FB 自己的文档。）

好的，因此，如果该端点不能用于更新到期时间（并且我自己尝试使用该端点更新长期令牌的尝试证明了这一点），那么我如何每次都更新长期令牌的过期时间他们访问我的应用程序？

没有人了解这应该如何工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T14:55:39.350

在阅读了 Facebook 的文档（如第五次）并借助[这个问题/答案](https://stackoverflow.com/questions/10132610/how-to-handle-facebooks-deprecation-of-offline-access-when-you-use-token-both-i)之后，这是我的结论。

> 这里所说的“呼召”是什么？

它引用 OAuth 调用来获取访问令牌。

> 是否与初始 OAuth 流程中发生的访问令牌的授权代码交换相同？

是的，我相信就是这样的流动。

> 还是客户端部分下描述的端点调用将令牌更新为 60 天？

不，该端点仅对短期访问令牌有效。

> 它与原始回调中的授权代码相同还是我必须再次通过授权流程？

您必须再次完成授权流程。

> 每次他们访问我的应用程序时，如何更新长期令牌的到期时间？

无法使用客户端端点更新长期访问令牌。用户必须重新授权应用程序才能获得新的应用程序。根据 Facebook 文档：

> 如果调用（OAuth 授权调用）时该用户仍有一个有效的长寿命用户 access_token，则第二次调用返回的用户 access_token 可能相同或可能已更改，但在任何一种情况下，到期时间都将设置为较长的​​过期时间。

重新授权应用程序后，您将获得新的到期时间。Facebook 可能会返回一个新的长期访问令牌，因此您应该获取它并将该信息替换为您已经拥有的那个。

结论：似乎没有用户干预就无法更新长期访问令牌。要获得新的过期时间/访问令牌，他们必须重新授权您的应用。我的谦虚建议是，应该建议用户在到期日期前几天重新授权。此外，这个[Facebook 操作方法](http://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/)可以派上用场检查过期的访问令牌。

# github - 可以修改 GitHub Gist 嵌入代码吗？

> ID：10306118
> 
> 赞同：4
> 
> 时间：2012-04-24T21:15:56.180
> 
> 标签：github

我正在使用 Gist 在我的博客上显示代码位（或者更确切地说，如果/当这个问题得到回答时），以便我可以使用它很好的语法突出显示。当我在我的页面上嵌入 Gist 时，它在嵌入且格式良好的代码下方有一个栏，如下所示：

![在此处输入图像描述](../Images/dd8f881a3e0bfdac78a5670be4dc384d.png)

现在，如果我有几行只有一行长的片段，我认为这个栏看起来有点难看，每个片段下面都有这个栏。我发现可以使用 CSS 轻松隐藏此栏，但我想知道这样做是否“可以”。我应该注意哪些法律后果？我浏览了 Github 的服务条款并花了几分钟谷歌搜索，但我找不到任何东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T07:40:51.010

您不需要从 GitHub 修改[gist/embed.css](https://gist.github.com/stylesheets/gist/embed.css)，但您可以简单地添加一个更具体的规则（如此[处所述](http://www.dreamincode.net/forums/topic/32236-hide-horizontal-scrollbars/)），该规则将在现有规则*之后*声明：

```
.gist .gist-file .gist-meta {
  overflow: auto; overflow-x: hidden;
}
.gist .gist-file .gist-data {
  overflow: auto; overflow-x: hidden;
} 
```

如果 this 在 之后声明`<link rel="stylesheet" href="http://gist.github.com/stylesheets/gist/embed.css"/>`，它应该优先。[在您的 WordPress 博客中制作嵌入要点](http://arin.me/blog/embed-a-gist-in-your-wordpress-blog)
时，另请参阅这个 CSS 修改示例。

# php - 获取带有斜线的对象属性

> ID：10306123
> 
> 赞同：4
> 
> 时间：2012-04-24T21:16:21.587
> 
> 标签：php, freebase

我从 api 请求返回到 freebase 数据库的 json 结果。这是返回的名为 $json 的对象的一部分。$json 的 var 转储：

```
stdClass Object
(
[name] => Abomey
[/location/statistical_region/population_growth_rate] => 
[/common/topic/article] => Array
    (
        [0] => stdClass Object
            (
                [id] => /m/0jk2c
            )
    ) 
```

如何减去 /m/0jk2c 部分？

$json->/common/topic/article[0]->id （显然）不起作用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T21:22:32.870

这应该这样做：

```
$json->{"/common/topic/article"}[0]->id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:27:36.280

这是你应该使用的

```
 $class->{'/location/statistical_region/population_growth_rate'}['/common/topic/article'][0]->id 
```

你的对象看起来像这样的原因

```
$std = new stdClass();
$std->id = '/m/0jk2c' ;

$json  = new stdClass();
$json->name = "Abomey" ;
$json->{'/location/statistical_region/population_growth_rate'} = array('/common/topic/article'=>array($std)); 
```

如果你跑

```
var_dump($json->{'/location/statistical_region/population_growth_rate'}['/common/topic/article'][0]->id); 
```

输出

```
string '/m/0jk2c' (length=8) 
```

跑

```
echo "<pre>";
print_r($json); 
```

输出

```
stdClass Object
(
    [name] => Abomey
    [/location/statistical_region/population_growth_rate] => Array
        (
            [/common/topic/article] => Array
                (
                    [0] => stdClass Object
                        (
                            [id] => /m/0jk2c
                        )

                )

        )

) 
```

# java - 在 Google 协作平台网站中嵌入 Java 小程序

> ID：10306127
> 
> 赞同：3
> 
> 时间：2012-04-24T21:16:45.777
> 
> 标签：java, applet, google-sites

我正在尝试运行我在创建的 Google 站点中编写的一些 Java 代码。我知道这有问题，但我尝试了以下两个选项：

1.  使用此处描述的 Code Wrapper 小工具：[http](http://web.michaelchughes.com/how-to/embed-java-applets-in-google-sites) ://web.michaelchughes.com/how-to/embed-java-applets-in-google-sites 。我使用来自以下 URL 的 Code Wrapper 小工具：http: [//hosting.gmodules.com/ig/gadgets/file/105629041657992777031/code-wrapper.xml](http://hosting.gmodules.com/ig/gadgets/file/105629041657992777031/code-wrapper.xml)和以下 Javascript 代码：

    ```
    <script type="text/javascript" src="http://www.java.com/js/deployJava.js"></script>

    <script type="text/javascript">
        /* <![CDATA[ */
            var attributes = {
                code: 'com.fusego.wimbeep.applet.ScreamURLApplet.class',
                archive: 'http://sites.google.com/site/wimbeep/technology/wimbeeptools.jar',
                width: 500,
                height: 100
            };
              var parameters = { };
              var version = '1.6';
              deployJava.runApplet(attributes, parameters, version);
        /* ]]> */
    </script> 
    ```

这不起作用 - 我在 Firefox 浏览器中打开一个调试控制台，我看到 deployJava 未定义。

1.  使用带有标签的嵌入小工具：

    <_applet archive="http://sites.google.com/site/wimbeep/technology/wimbeeptools.jar" 代码="com.fusego.wimbeep.applet.ScreamURLApplet.class" height="400" width="400" />

这不起作用 - 我看到 JRE 启动但出现错误，控制台报告以下内容：

```
load: class com.fusego.wimbeep.applet.ScreamURLApplet.class not found.
java.lang.ClassNotFoundException: com.fusego.wimbeep.applet.ScreamURLApplet.class
    at sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadCode(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.createApplet(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Exception: java.lang.ClassNotFoundException: com.fusego.wimbeep.applet.ScreamURLApplet.class 
```

这真是令人沮丧。我尝试了很多组合，在代码属性中有和没有 .class 后缀，它只是不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T14:20:22.273

我遇到了类似的问题，我选择了将小程序托管在另一个站点上的简单权宜之计，并在[sites.google.com](http://sites.google.com)上发布了一个普通链接。或者，这个[线程建议通过](https://groups.google.com/a/googleproductforums.com/forum/#!category-topic/sites/ask-a-question/rv4t_BOjQuA)[java-web-start](/questions/tagged/java-web-start "显示标记为“java-web-start”的问题")加载小程序，引用这个[例子](https://sites.google.com/site/fuhrmanator/Home/tft-dice-roller)。

附录：这个（更透明的）[示例](https://sites.google.com/site/drjohnbmatthews/subway)说明了几种方法。

*   Java 网络启动
*   JWS 小程序
*   传统小程序
*   带有清单的可下载 JAR

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T08:57:45.377

我用这个 HTML 在本地看到它“加载没有错误”（然后什么也不做）：

```
<html>
<head>
<title>WimBeepTools</title>
</head>
<body>
<applet
    code="com.fusego.wimbeep.applet.ScreamURLApplet"
    archive="wimbeeptools.jar"
    width="500"
    height="100">
</applet>
</body>
</html> 
```

HTML 和 Jar 位于同一目录中，因此在[http://sites.google.com/site/wimbeep/technology/applet001.html](http://sites.google.com/site/wimbeep/technology/applet001.html)上加载该 HTML 并成功加载小程序。

请务必添加`001`后缀，以确保我们可以在初始失败的情况下检查其他变体。用户看到的页面应该位于另一个 URL。

## 顺便提一句

### 对 HTML 使用代码格式

> <_applet archive="http://sites.google.com/site/wimbeep/technology/wimbeeptools.jar" 代码="com.fusego.wimbeep.applet.ScreamURLApplet.class" height="400" width="400" />

最初`_`是为了防止网站“吞下”HTML 吗？将 HTML（JNLP/XML/输入/输出***和***源代码）放入代码标签中。小程序元素从未打算使用`/>`. 如我的示例所示，添加结束小程序元素。

### 先对细节进行排序

最终最好使用`deployJava.js`来编写部署时嵌入小程序的元素。`applet`但首先，使用“plain old HTML”和元素修复路径和其他属性细节。

# javascript - JavaScript 按名称获取元素

> ID：10306129
> 
> 赞同：152
> 
> 时间：2012-04-24T21:16:48.600
> 
> 标签：javascript, html, dom

考虑这个函数：

```
function validate()
{
  var acc = document.getElementsByName('acc').value;
  var pass = document.getElementsByName('pass').value;

  alert (acc);
} 
```

而这个 HTML 部分：

```
<table border="0" cellpadding="2" cellspacing="0" valign="top">
    <tr>
        <td class="td1">Account</td>
        <td class="td2"><input type="text" name="acc" /></td>
    </tr>
    <tr class="td1">
        <td>Password</td>
        <td class="td2"><input type="password" name="pass" /></td>
    </tr>
</table>
<div><button onClick="validate()" class="cupid-greenx">Login now</button></div> 
```

警告框正在显示，但它显示“未定义”。

* * *

## 回答 #1

> 赞同：288
> 
> 时间：2012-04-24T21:19:27.553

您看到该错误的原因是`document.getElementsByName`返回 a `NodeList`of 元素。并且 a `NodeList`of 元素没有`.value`属性。

改用这个：

```
document.getElementsByName("acc")[0].value 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-04-24T21:21:12.170

请注意此方法中的复数：

```
document.getElementsByName() 
```

它返回一个元素数组，所以使用 [0] 来获得第一次出现，例如

```
document.getElementsByName()[0] 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-04-24T21:20:23.000

你要这个：

```
function validate() {
    var acc = document.getElementsByName('acc')[0].value;
    var pass = document.getElementsByName('pass')[0].value;

    alert (acc);
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2021-02-10T07:31:27.713

这里的所有答案似乎都已过时。请立即使用：

```
document.querySelector("[name='acc']");
document.querySelector("[name='pass']") 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-04-24T21:21:38.447

方法 document.getElementsByName 返回一个元素数组。例如，您应该首先选择。

```
document.getElementsByName('acc')[0].value 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-04-24T21:20:47.793

```
document.getElementsByName("myInput")[0].value; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-06T15:46:27.847

只是为了完整起见，因此阅读本文的其他人对安全网有很好的了解，尤其是在不能保证获得所需元素的情况下，您可以测试缺失值，使用 null coalesce 设置默认值：

```
const accElements = document.getElementsByName('acc');
const accElement = accElements[0] ?? null; // Or some other value
if (!accElement) {
    // handle the problem
} 
```

并在连接对象（而不是返回的数组/节点）时使用[可选链接：](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining)

```
const acc = document.getElementById('acc')?.value ?? null; // Or some other value 
```

此外，虽然`name`属性有时是所有可用的，但请尽可能尝试使用`id`，因为它们更有可能成为唯一的。假设您想要的元素在结果索引 0 ( `[0]`) 中通常是安全的，但最好检查并确定。只需几行代码（可能还有一些日志记录），您就可以为您的最终用户避免出现问题的问题。

# javascript - jqueryUI 模态对话框打破了 knockoutjs 绑定

> ID：10306130
> 
> 赞同：3
> 
> 时间：2012-04-24T21:16:59.100
> 
> 标签：javascript, jquery, knockout.js

意图是让用户单击徽标部分并显示一个模态对话框，他们可以在其中上传新徽标图像，更改当前徽标图像或删除当前徽标图像。

现在上传图片会导致页面刷新，但我正在转向使用 ajax 帖子处理此功能以防止页面刷新。

我遇到的问题是，一旦图像存在，并且用户删除了图像，模态对话框在淘汰 js 模型之后不会更新。图像显示在两个区域中，一次在屏幕上它应该在的位置，另一次在模式对话框中作为预览。主图像 src 更新并且我可以隐藏，但是当 jQueryUI 克隆元素时，看起来敲除和对话框之间的绑定被删除了。

我试图使用这篇[文章](https://groups.google.com/forum/?fromgroups#!topic/knockoutjs/rFKEeN0-3dU)中的 init 示例，但模式对话框没有呈现。

有任何想法吗？

**HTML/剃刀**

```
<div id="logo" data-bind="cmdDialog: {id:'dialog-form', cmd:'open'} ">
    <div id="changeLogo">
        <h1 data-bind="visible: URL() == null"><span>Logo Here</span></h1>
        <img data-bind="attr: { src: URL}, visible: URL() != null"/>
    </div>
    <div id="dialog-form" data-bind="setDialog:{}">
        <img data-bind="attr: { src: URL}"/>
        <button type="button" data-bind="visible: URL() != null, deleteImage: ImageID">Remove Image</button>
        <hr/>
        <form action="uploadImage" method="post">
            @Html.HiddenFor(m => m.ID, new { data_bind = "value: ID" })
            @Html.HiddenFor(m => m.ImageID, new { data_bind = "value: ImageID" })
            <div>
                <input type="file" name="file" id="file"/>
            </div>
            <div>
                <input type="submit" value="Upload" />
                <button type="button" data-bind="cmdDialog: {id:'dialog-form', cmd:'close'} ">Cancel</button>
            </div>
        </form>
    </div>
</div> 
```

​​​​​</p>

**JavaScript**

```
$(document).ready(function () {
        /*************************************/
        // Modal Dialog config
        /*************************************/
        var options = {
            autoOpen: false,
            resizable: false,
            modal: true,
            height: 400,
            width: 450
        };

        /*************************************/
        // Knockout config
        /*************************************/
        var viewModelLogo;

        ko.bindingHandlers.setDialog = {
            init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
                var $element = $(element);

                setTimeout(function() {$element.dialog(options); }, 0);
            }
        };

        ko.bindingHandlers.cmdDialog = {
            init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
                $(element).click(function() {
                    var parms = ko.utils.unwrapObservable(valueAccessor());
                    var $logoForm = $('#' + parms.id);

                    $logoForm.dialog(parms.cmd);
                });
            }
        };

        ko.bindingHandlers.deleteImage = {
            init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
                $(element).click(function() {
                    deleteImage(viewModel);
                });
            }
        };
        $.getJSON("/Logo/Logo/GetPageModel", Model.ID, function(result) {
            updateModel(result.Data);
        });

        var deleteImage = function(imageModel) {
            var image = ko.toJS(imageModel);
            $.post("/Logo/Logo/deleteImage", image, function(result) {
                updateModel(result.Data);
            });
        };

        function updateModel(image) {
                viewModelLogo = ko.mapping.fromJS(image);
                ko.applyBindings(viewModelLogo, document.getElementById('logo'));
                $('#dialog-form').dialog("close");
        };
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T16:17:22.187

我发现当我像你一样定义对话框时 - 即作为普通 div 绑定不起作用。但是，当我使用模板时，我可以使用 data 参数来指定我要绑定的项目，它将所有内容都纳入范围，包括我在视图模型上使用的其他项目。

看看 Ryan Niemeyer 的出色示例，它使用更新原始页面[http://jsfiddle.net/rniemeyer/WpnTU/的对话窗口来执行此操作](http://jsfiddle.net/rniemeyer/WpnTU/)

请注意他如何将对话框的内容定义为模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:28:25.157

看起来你没有设置你的`update`处理程序。查看此[淘汰教程](http://learn.knockoutjs.com/#/?tutorial=custombindings)，了解如何正确执行此操作。

# drag-and-drop - 通过 DragDrop 移动 FlowLayoutPanel 控件

> ID：10306133
> 
> 赞同：1
> 
> 时间：2012-04-24T21:17:05.500
> 
> 标签：drag-and-drop, flowlayoutpanel

我有一个 FlowPanelLayout，它可以包含多个名为 DataGridViewFilterSortElement 的用户控件。这些控件看起来有点像按钮，但又有所不同。我希望用户能够单击其中一个 DataGridViewFilterSortElement 控件并将其拖动到 FlowLayoutPanel 中的另一个位置（索引）。

有没有办法在用户将控件拖动到另一个位置时看到控件的物理移动？换句话说，有没有办法对正在拖动的控件（而不是阴影框）进行“快照”，这会显示实际控件随着光标的移动而移动？此外，当控件被拖动时，我想让其他控件的位置自动移动，而不是等待用户放下拖动来查看移动。

例如，假设 FlowPanelLayout 包含 3 个控件，并且用户想要将第一个控件拖动到第三个控件位置。因此，用户单击并按住第一个 DataGridViewFilterSortElement，然后拖动到第二个控件上，这导致第二个控件移动到位置 1 of 3，然后用户拖动到第三个控件上，这导致第三个控件移动到位置 2 3，然后用户将控件放在位置3。这可能吗？我的小代码如下。

这是一个简短的小视频，展示了我想要做什么： [http ://www.youtube.com/watch?v=YhyTni6KH0Q](http://www.youtube.com/watch?v=YhyTni6KH0Q)

```
 Private Sub lblDescription_MouseDown(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles Me.MouseDown, lblDescription.MouseDown
    ' if the user left clicks and holds the element begin a DragDrop action
    If e.Button = Windows.Forms.MouseButtons.Left Then
        Me.DoDragDrop(Me, DragDropEffects.Move)
    End If
End Sub

Private Sub SortFlowLayoutPanel_DragOver(ByVal sender As Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles Me.DragOver
    e.Effect = DragDropEffects.Move
End Sub

Private Sub SortFlowLayoutPanel_DragDrop(ByVal sender As Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles SortFlowLayoutPanel.DragDrop

        If e.Data.GetData(GetType(DataGridViewFilterSortElement)) IsNot Nothing Then

            'Current Position           
            Dim myIndex As Integer = Me.SortFlowLayoutPanel.Controls.GetChildIndex(CType(e.Data.GetData(GetType(DataGridViewFilterSortElement)), DataGridViewFilterSortElement))

            'Dragged to control to location of next picturebox
            Dim element As DataGridViewFilterSortElement = CType(e.Data.GetData(GetType(DataGridViewFilterSortElement)), DataGridViewFilterSortElement)

            Me.SortFlowLayoutPanel.Controls.SetChildIndex(element, myIndex)
        End If

End Sub

Private Sub SortFlowLayoutPanel_DragOver(ByVal sender As Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles SortFlowLayoutPanel.DragOver
    e.Effect = DragDropEffects.Move
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:05:42.453

这个页面解释了如何做你想做的事。我试过了，看起来还不错。 [http://www.vbdotnetforums.com/gui/45818-flowlayoutpanel-repositioning-object.html](http://www.vbdotnetforums.com/gui/45818-flowlayoutpanel-repositioning-object.html)

# c# - 在 .NET 中模拟时如何获取应用程序的名称

> ID：10306134
> 
> 赞同：0
> 
> 时间：2012-04-24T21:17:05.777
> 
> 标签：c#, .net, vb.net

在 .NET 中进行模拟时如何获取应用程序的名称。我对您喜欢 VB.NET 或 C# 的 .NET 语言没有任何偏好。我本质上是在做（这里请原谅 VB.NET）：

```
theImpersonator = New Impersonator("username", "domain", "password")
Dim finfo As New FileInfo(Process.GetCurrentProcess().MainModule.FileName)
Dim appname As String = finfo.Name.Substring(0, finfo.Name.IndexOf(".")) 
```

不使用“New Impersonator(...)”一切都很好。当我使用“模仿者”时，我得到：

```
Access is denied
   at System.Diagnostics.ProcessManager.OpenProcess(Int32 processId, Int32 access, Boolean throwIfExited)
   at System.Diagnostics.NtProcessManager.GetModuleInfos(Int32 processId, Boolean firstModuleOnly)
   at System.Diagnostics.NtProcessManager.GetFirstModuleInfo(Int32 processId)
   at System.Diagnostics.Process.get_MainModule() 
```

使用模拟时如何找出我的应用程序 .exe 文件的名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:20:04.543

似乎您冒充的人无权访问正在运行的文件。验证它不在模拟用户无法使用的某个文件夹中。例如，在普通用户没有访问权限的服务器上运行。尝试将用户设置为计算机上的本地管理员，或者只是授予他对该文件夹的访问权限。

一种更简单的方法是：

```
Process.GetCurrentProcess().ProcessName 
```

我认为您不应该使用 a `FileInfo`，这很慢并且需要权利。您可以改用 System.IO.Path 静态类

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T00:52:45.033

我对 Impersonator 一无所知，但这适用于我的大多数应用程序（甚至 WPF 应用程序）。

```
 string name = Path.GetFileNameWithoutExtension(
                    System.Windows.Forms.Application.ExecutablePath); 
```

# c - 使用 #define-d 列表作为 C 预处理器宏的输入

> ID：10306135
> 
> 赞同：3
> 
> 时间：2012-04-24T21:17:08.353
> 
> 标签：c, macros, c-preprocessor

在一个示例项目中，我定义了宏

```
#define FOO(x, y) x + y   . 
```

这工作得很好。例如，`FOO(42, 1337)`被评估为`1379`。

但是，我现在想使用另一个`#define`：

```
#define SAMPLE 42, 1337 
```

当我现在打电话时`FOO(SAMPLE)`，这是行不通的。编译器告诉我这`FOO`需要两个参数，但只用一个参数调用。

我想这样做的原因是，尽管宏的参数是在函数本身之前评估的，但预处理器在评估之后不会再次解析整个指令。这类似于不能从宏输出附加预处理器指令的事实。

是否有可能获得所需的功能？

用 C 函数替换`FOO`宏是不可能的。原始宏位于我无法更改的第三方代码中，它输出以逗号分隔的值列表，以直接在数组初始化程序中使用。因此，C 函数不能复制相同的行为。

如果使用简单的方法无法完成此任务：您将如何`(x, y)`以可维护的形式存储对？就我而言，有 8 个论点。因此，将各个部分存储在单独的`#define`-s 中也不容易维护。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T22:59:23.510

您遇到了一个问题，即预处理器没有按照您想要的顺序匹配和扩展宏。现在，您通常可以通过插入一些额外的宏来强制它正确地执行您想要的操作，但为了做到这一点，您需要了解正常的顺序是什么。

*   当编译器看到带有参数的宏的名称后跟 a`(`时，它首先在该参数列表中扫描，将其分解为参数，而不识别或扩展参数中的任何宏。

*   在解析和分离参数之后，它会重新扫描每个参数的宏，并扩展它发现的任何参数，除非该参数与宏体一起使用`#`或`##`在宏体中使用

*   然后它用（现在可能扩展的）参数替换正文中参数的每个实例

*   最后，它重新扫描正文以查找可能与正文一起存在的任何其他宏以进行扩展。在这一次扫描中，原始宏将不会被识别和重新扩展，因此您不能进行递归宏扩展

因此，您可以通过仔细使用 EXPAND 宏来获得所需的效果，该宏接受单个参数并对其进行扩展，从而允许您在过程中的正确位置强制进行额外的扩展：

```
#define EXPAND(X)   X
#define FOO(x,y)    x + y
#define SAMPLE      42, 1337

EXPAND(FOO EXPAND((SAMPLE))) 
```

在这种情况下，您首先在参数列表中显式展开宏，然后手动展开生成的宏调用。

**通过问题海报更新**

```
#define INVOKE(macro, ...) macro(__VA_ARGS__)

INVOKE(FOO, SAMPLE) 
```

提供了一个扩展的解决方案，该解决方案不会使代码与`EXPAND`s 混淆。

# android - Android 通知问题

> ID：10306138
> 
> 赞同：1
> 
> 时间：2012-04-24T21:17:10.613
> 
> 标签：android, notificationmanager

我有一个相当基本的应用程序，它只有两个活动，即进入 MainActivity 的初始屏幕。我使用 AlarmManager 创建了一个固定时间的通知。现在，我在启动画面期间执行了 AlarmManager。我有两个问题。**一**：由于AlarmManger在splashActivity中，所以每次启动app都会执行。因此，如果通知时间已过，应用程序会立即发送通知。**二**：如果通知的时间还没有到，应用程序会崩溃，因为在 MainActivity 中我有一个清除通知的调用，并且由于通知尚未触发，清除通知的调用会导致 MainActivity 崩溃。我知道是明确的通知调用导致 MainActivity 崩溃，因为如果我注释掉调用，应用程序运行良好。

**问题：**有没有办法对通知进行编码，使其在每次启动应用程序时都不会加载？我可以写清除通知位，这样如果应用程序没有触发它就不会崩溃？这是 Splash Activity 中的通知：

```
 private void launchAlarmManager() {
    //---- ALARM MANAGER ------
    //---use the AlarmManager to trigger an alarm---
    AlarmManager aMan = (AlarmManager) getSystemService(ALARM_SERVICE);

    //---get current date and time---
    Calendar alCal = Calendar.getInstance();
    //---sets the time for the alarm to trigger---                       
    alCal.set(Calendar.HOUR_OF_DAY, 12);            
    alCal.set(Calendar.MINUTE, 25);                
    alCal.set(Calendar.SECOND, 00);

    //---PendingIntent to launch activity when the alarm triggers---                    
    Intent iDN = new Intent("com.myapp.DISPLAYNOTIFICATIONS");

    PendingIntent pendA = PendingIntent.getActivity(this, 0, iDN, 0);
    //---sets the alarm to trigger--- 
    aMan.set(AlarmManager.RTC_WAKEUP, alCal.getTimeInMillis(), pendA);

    //---- END ALARM MANAGER ------ 
```

这是 MainActivity 中的取消通知位：

```
NotificationManager nm;
//---cancel the notification by getting the Unique ID from the DisplayNotification class---
nm.cancel(getIntent().getExtras().getInt("uID")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:53:42.483

我想您需要保存警报是否已设置的状态。在伪代码中：

```
load the alarm_has_been_set variable
if( !alarm_has_been_set ) {
    set alarm
    save alarm_has_been_set = true
} 
```

然后，一旦警报触发，您就取消设置该变量。有关保存和加载，请参阅[让数据在 Android 中持久化](https://stackoverflow.com/questions/3310066/making-data-persistent-in-android)。

关于取消通知时崩溃的第二个问题，请尝试使用 try-catch 块：

```
try {
    nm.cancel(getIntent().getExtras().getInt("uID"));
} catch (Exception e) {
    System.out.println("Error when cancelling: "+e.toString());
} 
```

另外，我刚刚注意到，至少您的示例代码会产生 NullPointerException，因为您根本没有初始化 NotificationManager 类。

# java - Java Socket：更改值后多次读取/接收同一实例：ObjectInputStream.readObject()

> ID：10306142
> 
> 赞同：1
> 
> 时间：2012-04-24T21:18:13.330
> 
> 标签：java, sockets, object, serialization

我正在开发一个带有服务器的简单多人游戏。这个概念是在玩家每转一圈后将对象“游戏”发送给所有客户端。它包含客户需要的所有信息。它第一次运行良好。第二次之后，客户端中对象的值不会更改。确认服务器上的值已更改，并且我还在客户端将对象设置为空，然后再读取。我在Java方面没有经验。“Java”是否可能认为因为它是同一个实例，它不会读取新值而只是重新激活旧值（可能来自缓存）？

客户代码

```
this.game = null;
this.game = (Game) ois.readObject(); 
```

服务器代码

```
aCPS.get(i).oos.writeObject(game); 
```

游戏

```
public class Game implements Serializable {...} 
```

如果您需要更多代码，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:42:25.650

如果您将相同的对象写入 a`ObjectOutputStream`而不进行重置，您将获得相同的对象。这就是 Java 序列化处理任意对象图的方式。

要修复，最好使用新鲜的`ObjectOutputStream`. 你可以调用`reset`它。或者使用不可变对象或使用其他东西进行序列化。

# php - cakephp REST api响应不是json，它是完整的html页面

> ID：10306145
> 
> 赞同：0
> 
> 时间：2012-04-24T21:18:20.533
> 
> 标签：php, json, cakephp, rest

我正在使用 cakephp 2.1.1

从我在文档中读到的内容。它使您可以非常轻松地创建 REST api。(http://book.cakephp.org/2.0/en/development/rest.html)

我不知道如何生成 JSON 响应，我从目标 c 调用 api，响应是完整的 HTML 页面。

我的控制器中有这段代码

```
public function add() {
        if ($this->request->is('post')) {
            if ($this->Post->save($this->request->data)) {
                $message = 'Saved';
                //echo 'eyeys';

            } else {
                $message = 'Error';
            }

            $this->set('_serialize',$message);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T12:41:43.417

尝试设置响应类型

```
public function add() {
    $this->autoRender = false;
    $this->response->type('json');
    $message = null;
        if ($this->request->is('post')) {
            if ($this->Post->save($this->request->data)) {
                $message = 'Saved';
            } else {
                $message = 'Error';
            }
        }        
   return json_encode($message);    
} 
```

另请查看官方 cakephp 2.0[响应文档](http://book.cakephp.org/2.0/en/controllers/request-response.html#cakeresponse)

# java - 在 Fragment 被分离然后重新附加后，不会调用 Fragment onResume

> ID：10306147
> 
> 赞同：5
> 
> 时间：2012-04-24T21:18:37.460
> 
> 标签：java, android, android-fragments, actionbarsherlock, android-actionbar

我正在尝试处理所有新的 ActionBar 和 Fragments API。我有一个主要活动，我希望它管理两个不同的选项卡。我正在使用 ActionBarSherlock 来支持比 ICS 更旧的版本。

每个选项卡都包含自己的`Fragment`（每个选项卡都是 的子类`SherlockListFragment`）我让它工作得很好，但我有一个问题，我确信这是愚蠢的，但我还无法弄清楚：

在第一次显示每个 Fragment 时，一切正常，列表已填充，ActionBar 中的 MenuItems 也是如此。

但是第二次看到选项卡时（在切换和切换回之后），列表都不会被填充，ActionBar MenuItems 也不会。

这就是我切换标签的方式：

```
@Override
public void onTabSelected(Tab tab, FragmentTransaction transaction) {
    SherlockListFragment toAttach = // Find the right fragment here...

    if (toAttach != null) {
        if (toAttach.isAdded() == false) {
            transaction.add(R.id.tab_placeholder, toAttach,
                    REMINDER_FRAGMENT_TAG);
        } else {
            transaction.attach(toAttach);
        }
    }
} 
```

而 onTabUneselect 我正在分离片段：

```
@Override
public void onTabUnselected(Tab tab, FragmentTransaction transaction) {
    SherlockListFragment toDetach = // Find the right fragment
    if (toDetach != null) {
        transaction.detach(toDetach);
    }
} 
```

我在 onResume 中填充列表和 ActionBar 菜单：

```
@Override
public void onResume() {
    super.onResume();
    setHasOptionsMenu(true);
    fillRemindersList();
} 
```

我也在 onStart 和 onCreateView 中尝试过，但没有帮助......

那么我在这里错过了什么？如果我的代码中还有其他我不知道的问题，请告诉我。

谢谢！

**编辑：**

我刚刚确认`onResume`在我切换标签后不会被调用，这绝对是错误的，因为我正在分离并重新连接它们......我是否以错误的方式切换标签？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T00:25:51.103

尝试在 onTabUnselected 中使用 transaction.remove(fragment)，在 onTabSelected 中使用 transaction.replace。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:45:49.810

在此代码之外执行 beginTransaction() 和 commit() 我假设还是您忘记了？您还可以从示例中看到此处使用的技巧： [https ://github.com/JakeWharton/ActionBarSherlock/blob/master/samples/fragments/src/com/actionbarsherlock/sample/fragments/FragmentTabs.java](https://github.com/JakeWharton/ActionBarSherlock/blob/master/samples/fragments/src/com/actionbarsherlock/sample/fragments/FragmentTabs.java)

# ruby-on-rails-3 - 如何有条件地从 Rails 3.2 Arel 方法链中添加或删除成员？

> ID：10306148
> 
> 赞同：1
> 
> 时间：2012-04-24T21:18:48.883
> 
> 标签：ruby-on-rails-3, activerecord, arel

我正在复制我`includes`的 、`where`、`order`和`paginate`方法，因为我不知道是否有 Arel 链的块或更好的方法来使这个 DRY。`where`有没有什么东西可以在不使用三元运算符的长字符串的情况下轻松测试 params 中的 special_id 或 facility_id ？

```
class << self
  def list(options = {})

    facility_id  = options[:facility_id]  || nil
    keywords     = options[:keywords]     || nil
    page         = options[:page]         || nil
    specialty_id = options[:specialty_id] || nil
    jobs         = self.arel_table

    unless keywords.nil?
      keywords = keywords.downcase.tr_s('^a-z0-9 ', '').tr_s(' ', '\%')
    end

    if !specialty_id.blank?
      approved.
          includes(:facility, :specialties, :videos).
          where(jobs[:name].matches("%#{keywords}%")).
          where(specialties: {id: specialty_id}).
          order(jobs[:name]).
          paginate(page: page, per_page: 20)
    elsif !facility_id.blank?
      approved.
          includes(:facility, :specialties, :videos).
          where(jobs[:name].matches("%#{keywords}%")).
          where(facilities: {id: facility_id}).
          order(jobs[:name]).
          paginate(page: page, per_page: 20)
    else
      approved.
          includes(:facility, :specialties, :videos).
          where(jobs[:name].matches("%#{keywords}%")).
          order(jobs[:name]).
          paginate(page: page, per_page: 20)
    end

  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:23:47.423

```
query = approved
query = query.includes(:facility, :specialties, :videos)
query = query.where(jobs[:name].matches("%#{keywords}%")) if jobs[:name].present?
query = query. ...
query = query.paginate(page: page, per_page: 20)
query.to_a 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T22:21:39.027

您应该能够将这些链接在一起以在执行之前构建它。

这样的事情应该是可能的：

```
scoped.tap do |query|
  query.
    approved.
    includes(:facility, :specialties, :videos).
    where(jobs[:name].matches("%#{keywords}%"))

  query.where(specialties: { id: specialty_id }) if specialty_id.present?
  query.where(facilities: { id: facility_id })   if facility_id.present?

  query.order(jobs[:name]).paginate(page: page, per_page: 20)
end 
```

有关更多信息，`scoped`请参见[此处](https://github.com/rails/rails/blob/7a80ac0162ae84cf22c91646690ad18916a66274/activerecord/lib/active_record/scoping/named.rb#L30)。

# uitableview - 在 UITableView 上重新加载 UISegmented 控件

> ID：10306149
> 
> 赞同：0
> 
> 时间：2012-04-24T21:18:50.250
> 
> 标签：uitableview, ios5, uisegmentedcontrol

我有一个动态的 UITableView。在第一部分的第一行，我有一个 segmentedControll（所有原型单元格、子类化和委托给 UITableViewController）。使用此分段控件，我希望在同一部分上显示另外一行。我要做的是有一个条件`numberOfRowsInSection`，然后当点击 SegmentedControl 时，它会触发以下内容：

```
 if (cellPath.section==0 && cellPath.row==1) {

        if (segmentedCell.segmentControl.selectedSegmentIndex==0) {

            reverse=NO;

           [self.tableView reloadSections:[NSIndexSet indexSetWithIndex:0] withRowAnimation:UITableViewRowAnimationAutomatic];

        }else if (segmentedCell.segmentControl.selectedSegmentIndex==1){

            reverse=YES;

            [self.tableView reloadSections:[NSIndexSet indexSetWithIndex:0] withRowAnimation:UITableViewRowAnimationAutomatic];

 }

} 
```

它以某种方式起作用，但问题是 SegmentedControl 也会在其初始状态下重新加载，您可以想象其余部分。

关于如何解决这个问题的任何想法？我也尝试过 reloadRowsAtIndex...，但不起作用（我确实放了 begin/end ）。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:46:16.933

当您重新加载表格时，单元格被“重用”。所以每个单元都不会存储状态，而是依赖另一个类（委托）来保存状态。因此，如果您希望保持分段控件的状态，则将其值存储在表视图的委托中，然后确保每次在 cellForRowAtIndexPath 中将该值设置为分段控件的索引路径。

# android - Android - 应用内计费几乎可以正常工作？

> ID：10306150
> 
> 赞同：1
> 
> 时间：2012-04-24T21:18:53.763
> 
> 标签：android, in-app-purchase, in-app-billing

我遵循了本指南：[http ://www.anddev.org/advanced-tutorials-f21/simple-inapp-billing-payment-t52060.html](http://www.anddev.org/advanced-tutorials-f21/simple-inapp-billing-payment-t52060.html)

我创建了一个测试帐户并从自己那里购买了一个项目，并且它有效。这件物品的价格是 9 瑞典克朗（瑞典语），但它被抽了两次，一次是 8 瑞典克朗（这是什么？），另一次是 9 瑞典克朗（我猜是什么东西？）。我还收到了两次 nonce JSONObject，它提供了有关购买的信息。然后我收到一封来自 Google Play 的邮件，说我购买了这件商品，但我的原始帐户没有收到任何邮件说我购买了一件商品。有人知道为什么会这样吗？

谢谢你。

编辑：

我刚刚登录到我的帐户，我可以看到一件商品的售价为 9 瑞典克朗，所以没关系。但是 8SEK 是从哪里来的呢？

# c - c malloc 防止缓冲区溢出

> ID：10306154
> 
> 赞同：1
> 
> 时间：2012-04-24T21:19:12.717
> 
> 标签：c, malloc, buffer-overflow

```
char *host;

host = malloc(64 * sizeof(char)); /* spazio per 64 caratteri */
memset(host,0x00,host[63]); 
```

我有一个疑问：指针可以看作是一个“数组”？？
使用上面的代码，我是否将 NULL 放入 64 字节？（防止缓冲区溢出）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:22:11.943

即使您的代码是正确的（参见@Dietrich 的回答），它也不能防止缓冲区溢出。我可以做这个：

```
strcpy(host, "A very large string that's definitely a lot longer than 64 characters, so it will cause you a great deal of misery"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T21:22:59.050

在 C 中，指针可以看作是一个数组。但是，您的代码是错误的。

正确版本：

```
char *host;
host = malloc(64);   // sizeof(char) == 1, guaranteed by the standard
if (!host) abort();  // malloc can return NULL if it fails
host[63] = '\0';     // put NUL byte into the last element of array 
```

运行时`memset(host, 0x00, host[63])`，它会将存储的值`host[63]`作为*长度*传递给 memset。这是一个错误，因为`host`未初始化，`host[63]`是垃圾，你不应该将垃圾传递给`memset`. 如果你很幸运，你的程序会立即崩溃。如果你不走运，它不会。

将`\0`字节放入最后一个插槽`host`并不能避免大多数缓冲区溢出。大多数不同类型的缓冲区溢出需要单独处理，因此没有“一种方法”可以防止它们。

缓冲区溢出是一类编程错误，和大多数类错误一样，有很多方法可以制造它们。每个不同的缓冲区溢出只是一段需要修复的错误代码。

**术语说明：**我更喜欢使用`NULL`C 中名为“NULL”的无效指针，以及`NUL`ASCII 字符串中的零字节。例如，

```
// Initialize ptr to a NULL ptr...
char *ptr;
ptr = NULL;
ptr = 0; // equivalent to above

ptr = xmalloc(15);
// Set *ptr to the NUL byte...
*ptr = '\0';
*ptr = 0; // equivalent to above 
```

# android - 根据 DemoKit 草图，Arduino 上的 ADK AndroidAccessory 读取功能应该有所收获吗？

> ID：10306158
> 
> 赞同：0
> 
> 时间：2012-04-24T21:19:28.380
> 
> 标签：android, arduino, adk

我正在使用 Freeduino（与 Arduino Uno 兼容）和运行 ICS（4）的三星 Galaxy Tab 10.1，并且我已成功从 Arduino 写入 Android，但我无法在 Arduino 草图中从 Android 读取.

这是 USB 附件的 Android 类：

```
package com.kegui.test;

import java.io.BufferedOutputStream;
import java.io.BufferedReader;
import java.io.ByteArrayOutputStream;
import java.io.FileDescriptor;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.StringWriter;
import java.io.Writer;
import java.nio.ByteBuffer;
import java.nio.CharBuffer;
import java.util.ArrayList;

import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;

import com.kegui.test.Scripto;

import android.app.Activity;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.hardware.usb.UsbAccessory;
import android.hardware.usb.UsbManager;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.os.ParcelFileDescriptor;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class USBAccess extends Activity implements Runnable, OnClickListener {
    private static final String ACTION_USB_PERMISSION = "com.google.android.DemoKit.action.USB_PERMISSION";

    protected static final String TAG = "KegUI";

    private UsbManager mUsbManager;
    private PendingIntent mPermissionIntent;
    private boolean mPermissionRequestPending;

    private TextView debugtext = null;
        private Button button1 = null;
        private Button button2 = null;
        private boolean button2visible = false;

    UsbAccessory mAccessory;
    ParcelFileDescriptor mFileDescriptor;
    FileInputStream mInputStream;
    FileOutputStream mOutputStream;

    private static final int MESSAGE_BUTTON_PRESSED = 1;

    private final BroadcastReceiver mUsbReceiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            String action = intent.getAction();
            Log.i("KegApp", "***********************Received*************************");
            if (ACTION_USB_PERMISSION.equals(action)) {
                synchronized (this) {
                    UsbAccessory accessory = (UsbAccessory) intent.getParcelableExtra(UsbManager.EXTRA_ACCESSORY);
                    if (intent.getBooleanExtra(
                            UsbManager.EXTRA_PERMISSION_GRANTED, false)) {
                        openAccessory(accessory);
                    } else {
                        Log.d(TAG, "permission denied for accessory "
                                + accessory);
                    }
                    mPermissionRequestPending = false;
                }
            } else if (UsbManager.ACTION_USB_ACCESSORY_DETACHED.equals(action)) {
                UsbAccessory accessory = (UsbAccessory) intent.getParcelableExtra(UsbManager.EXTRA_ACCESSORY);
                if (accessory != null && accessory.equals(mAccessory)) {
                    closeAccessory();
                }
            }
        }
    };

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        mUsbManager = (UsbManager) getSystemService(Context.USB_SERVICE);
        mPermissionIntent = PendingIntent.getBroadcast(this, 0, new Intent(
                    ACTION_USB_PERMISSION), 0);
        IntentFilter filter = new IntentFilter(ACTION_USB_PERMISSION);
        filter.addAction(UsbManager.ACTION_USB_ACCESSORY_DETACHED);

        setContentView(R.layout.main);
        final Button button = (Button) findViewById(R.id.button1);
        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                // Perform action on click

                new TempUpdateTask().execute("testing");
            }
        });
        registerReceiver(mUsbReceiver, filter);

        Log.d(TAG,"on Create'd");
    }

    @Override
    public void onResume() {
        super.onResume();

        if (mInputStream != null && mOutputStream != null) {
            return;
        }

        UsbAccessory[] accessories = mUsbManager.getAccessoryList();
        UsbAccessory accessory = (accessories == null ? null : accessories[0]);
        if (accessory != null) {
            if (mUsbManager.hasPermission(accessory)) {
                openAccessory(accessory);
            } else {
                synchronized (mUsbReceiver) {
                    if (!mPermissionRequestPending) {
                        mUsbManager.requestPermission(accessory,
                                mPermissionIntent);
                        mPermissionRequestPending = true;
                    }
                }
            }
        } else {
            Log.d(TAG, "mAccessory is null");
        }
    }

    @Override
    public void onPause() {
        super.onPause();
        closeAccessory();
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        unregisterReceiver(mUsbReceiver);

    }

    private void openAccessory(UsbAccessory accessory) {
        mFileDescriptor = mUsbManager.openAccessory(accessory);
        if (mFileDescriptor != null) {
            mAccessory = accessory;
            FileDescriptor fd = mFileDescriptor.getFileDescriptor();
            mInputStream = new FileInputStream(fd);
            mOutputStream = new FileOutputStream(fd);
            Thread thread = new Thread(null, this, "KegApp");
            thread.start();

            //enableControls(true);
        } else {
            Log.d(TAG, "accessory open fail");
        }
    }

    public void run() { 
        int ret = 0;
        byte[] buffer = new byte[16384];
        int i;
        Log.i("KegApp", "***********************in run*************************");
        while (ret >= 0) {
            try {
                ret = mInputStream.read(buffer); // this will be always positive, as long as the stream is not closed
            } catch (IOException e) {
                break;
            }

            i = 0;
            while (i < ret) {
                Message m = Message.obtain(messageHandler, MESSAGE_BUTTON_PRESSED);
                m.obj = buffer[i];
                messageHandler.sendMessage(m);
                i++;
            }

        }

    }

    private void closeAccessory() {
        //enableControls(false);

        try {
            if (mFileDescriptor != null) {
                mFileDescriptor.close();
            }
        } catch (IOException e) {
        } finally {
            mFileDescriptor = null;
            mAccessory = null;
        }
    }

    public void sendCommand(FileOutputStream mStream) { 
        BufferedOutputStream bo = new BufferedOutputStream(mStream);

    //  if (mStream != null && message.length > 0) {
            try {
                Log.i("KegApp", "***********************sending command now*************************");
                bo.write(1); //message, 0, 3);
            } catch (IOException e) {
                Log.e(TAG, "write failed", e);
            }
    //  }
    }

    @Override
    public void onClick(View v) {
        // Send some message to Arduino board, e.g. "13"
        Log.e(TAG, "write failed");
    }

    // Instantiating the Handler associated with the main thread.
      private Handler messageHandler = new Handler() {

          @Override
          public void handleMessage(Message msg) { 
              Log.i("KegApp", "***********************message handler before " + msg.what +  "************************");
                try {  
                    String load = msg.obj.toString();
                    Log.i("KegApp", "***********************in message handler*************************");
                    /*
                    if (button2visible==false) {
                        debugtext.setText("Received message: "+String.valueOf(load));
                        button2.setVisibility(View.VISIBLE);
                        button2visible = true;
                    } else {
                        debugtext.setText("");
                        button2.setVisibility(View.GONE);
                        button2visible = false;
                    }
                    */
                    new TempUpdateTask().execute(load);

                } catch (Exception e) {
                    Log.e(TAG, "message failed", e);
                }
          }

      };

// UpdateData Asynchronously sends the value received from ADK Main Board.
// This is triggered by onReceive()
class TempUpdateTask extends AsyncTask<String, String, String> {

    // Called to initiate the background activity
    protected String doInBackground(String... sensorValue) {
            try {
                Log.i("KegApp", "***********************calling sendcommand*********************");
                sendCommand(mOutputStream);

                Log.i("KegApp", "*********************incoming-sensorValue*********************" );
                ArduinoMessage arduinoMessage = new ArduinoMessage(sensorValue[0]);

            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (Exception e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            String returnString = String.valueOf(sensorValue[0]);//String.valueOf(sensorValue[0]) + " F";
            publishProgress(String.valueOf(sensorValue[0]));
            return (returnString); // This goes to result

    }

    // Called when there's a status to be updated
    @Override
    protected void onProgressUpdate(String... values) {
        // Init TextView Widget to display ADC sensor value in numeric.
        TextView tvAdcvalue = (TextView) findViewById(R.id.tvTemp);
        tvAdcvalue.setText(String.valueOf(values[0]));

        // Not used in this case
    }

    // Called once the background activity has completed
    @Override
    protected void onPostExecute(String result) {
        super.onPostExecute(result);
        closeAccessory();
    }

}
} 
```

这是我的 Arduino 草图：

```
#include <FHB.h>
#include <Max3421e.h>
#include <Max3421e_constants.h>
#include <Max_LCD.h>
#include <Usb.h>

//FREEDUINO ONLY------------------------------------

//END FREEDUINO ONLY------------------------------------
int pin_light_sensor_1=A0;
int pin_output_sensor=9;
int currLightLevel=0;
//int prevLightLevel=0;
//int lightStableRange=90;
int delayTime=3000;
int loopCtr=0;
char cSTX=char(2);
char cSOH=char(1);
char cEOT=char(4);
char cGS=char(29);
char cRS=char(30);
char cCR=char(13);
char cLF=char(10);

//FREEDUINO ONLY------------------------------------
AndroidAccessory acc("Company Inc.",
             "Kegbot5K datawriter",
             "Kegbot 5000 data writer",
             "1.0",
             "http://companyinc.com",
             "0000000012345678");
//END FREEDUINO ONLY------------------------------------
void setup()
{
  pinMode(pin_light_sensor_1, INPUT);
  pinMode(pin_output_sensor, OUTPUT);
  Serial.begin(57600);
//FREEDUINO ONLY------------------------------------  
  Serial.println("pre-power");
  acc.powerOn();
  Serial.println("post-power");
//END FREEDUINO ONLY------------------------------------
}

void loop()
{
byte msg[3];
if (acc.isConnected()) {
  currLightLevel = analogRead(pin_light_sensor_1);

     //sysPrint(delayTime*loopCtr);
     //sysPrint(",");
     //sysPrint(currLightLevel);
     writeDataMessage("LGH01", currLightLevel);

 }

 delay(1000);
 if (acc.isConnected()) {
    int len = acc.read(msg, sizeof(msg), 1);
    Serial.println(len);
      if (len > 0){
     for (int index=0; index < len; index++){
        digitalWrite(pin_output_sensor, 1);
                delay(500);
        digitalWrite(pin_output_sensor, 0);
     }
      }
 }
  loopCtr++;
  delay(delayTime);
}

void writeHeader(String msgType)
{
  sysPrint(cSTX);
  sysPrint(cSTX);
  sysPrint(cSOH);
  sysPrint(msgType);
  sysPrint(cGS);
}

void writeFooter()
  {
  sysPrint(cEOT);
  sysPrintLn(cEOT);
  }

void writeDataMessage(String sensorID, int value)
  {
  writeHeader("DATA");
  sysPrint(sensorID);
  sysPrint(cRS);
  sysPrint(value);
  writeFooter();
  }

void writeAlarmMessage(String sensorID, String message)
//Do we need to enforce the 5 char sensorID here? I don't think so...
  {
  writeHeader("ALRM");
  sysPrint(sensorID);
  sysPrint(cRS);
  sysPrint(message);
  writeFooter();
  }

void sysPrint(String whatToWrite)
  {
    int len=whatToWrite.length();
  char str[len];
  whatToWrite.toCharArray(str, len);
  acc.write((void *)str, len);
 // acc.write(&whatToWrite, whatToWrite.length());
  }
void sysPrint(char whatToWrite)
  {
  acc.write((void *)whatToWrite, 1);
 // acc.write(&whatToWrite, 1);
  }
void sysPrint(int whatToWrite)
  {
  acc.write((void *)&whatToWrite, 1);
//  acc.write(&whatToWrite, 1);
  }

void sysPrintLn(String whatToWrite)
  {
  int len=whatToWrite.length();
  char str[len];
  whatToWrite.toCharArray(str, len);
  acc.write((void *)str, len);
  acc.write((void *)&cCR, 1);
  acc.write((void *)&cLF, 1);
 // acc.write(&whatToWrite, whatToWrite.length());
 // acc.write(&cCR, 1);
 // acc.write(&cLF, 1);
  }

void sysPrintLn(char whatToWrite)
  {
  acc.write((void *)whatToWrite, 1);
   acc.write((void *)&cCR, 1);
  acc.write((void *)&cLF, 1);
 // acc.write(&whatToWrite, 1);
 // acc.write(&cCR, 1);
 // acc.write(&cLF, 1);
  } 
```

Android 中的 sendCommand 函数正在记录它已发送。acc.read 函数将长度打印到串行输出为 -1，就像没有输入一样。说到这一点，Android 日志没有显示错误，所以我认为这可能是 Arduino 的问题。

我的清单有一个注册设备的意图过滤器，尽管权限可能与它有关。

```
 <intent-filter>
        <action android:name="android.hardware.usb.action.USB_ACCESSORY_ATTACHED" />
    </intent-filter>

    <meta-data android:name="android.hardware.usb.action.USB_ACCESSORY_ATTACHED"
        android:resource="@xml/accessory_filter" />
        </activity> 
```

提前感谢您的任何想法，萨拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:44:08.337

我开发了一种遥控直升机，可以通过使用蓝牙棒从 android 向位于直升机顶部的 arduino 发送消息来使用 android 进行控制，我还没有将 USB 用于任何项目，但是当您向 arduino 发送消息时正在使用串行通信天气连接抛出 USB 或蓝牙我建议简单地使用 Serial.read 并且您发送到 arduino 的每条消息都以一些符​​号“#”结尾，例如只是为了分隔消息并逐个字符地获取消息这是代码从串行端口读取以“#”结尾的完整消息：

```
 String getMessage()
    {
      String msg=""; //the message starts empty
      byte ch; // the character that you use to construct the Message 
      byte d='#';// the separating symbol 

      if(Serial.available())// checks if there is a new message;
      {
        while(Serial.available() && Serial.peek()!=d)// while the message did not finish
        {
          ch=Serial.read();// get the character
          msg+=(char)ch;//add the character to the message
          delay(1);//wait for the next character
        }
      ch=Serial.read();// pop the '#' from the buffer
      if(ch==d) // id finished
      return msg;
      else
      return "NA";
      }
    else
    return "NA"; // return "NA" if no message;
} 
```

此函数检查缓冲区中是否有任何消息，如果没有则返回“NA”。如果这没有帮助，请告知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T14:28:45.000

弄清楚出了什么问题 - sendCommand 是从异步 TempTask 执行的，因此它没有传递对 FileOutputStream 的有效引用。我可以从主线程执行 sendCommand onClick 并在 Arduino 上接收就好了。

# android - 将字符串转换为 JSON 数组时出错

> ID：10306160
> 
> 赞同：1
> 
> 时间：2012-04-24T21:19:32.640
> 
> 标签：android, arrays, string, json

我在 android LogCat 中收到此错误消息

```
04-24 21:14:02.603: W/System.err(831): org.json.JSONException: Value {"id":"602414132","first_name":"Adham","username":"adham.enaya","locale":"en_GB","link":"http:\/\/www.facebook.com\/adham.enaya","name":"Adham Enaya","last_name":"Enaya","gender":"male"} of type org.json.JSONObject cannot be converted to JSONArray
04-24 21:14:02.603: W/System.err(831):  at org.json.JSON.typeMismatch(JSON.java:107)
04-24 21:14:02.603: W/System.err(831):  at org.json.JSONArray.<init>(JSONArray.java:91)
04-24 21:14:02.603: W/System.err(831):  at org.json.JSONArray.<init>(JSONArray.java:103)
04-24 21:14:02.615: W/System.err(831):  at pit.opensource.readjson.D0ReadJSONWebServiceActivity.pasreJSON(D0ReadJSONWebServiceActivity.java:85)
04-24 21:14:02.623: W/System.err(831):  at pit.opensource.readjson.D0ReadJSONWebServiceActivity.access$0(D0ReadJSONWebServiceActivity.java:78)
04-24 21:14:02.623: W/System.err(831):  at pit.opensource.readjson.D0ReadJSONWebServiceActivity$DownloadFBUser.doInBackground(D0ReadJSONWebServiceActivity.java:108)
04-24 21:14:02.623: W/System.err(831):  at pit.opensource.readjson.D0ReadJSONWebServiceActivity$DownloadFBUser.doInBackground(D0ReadJSONWebServiceActivity.java:1)
04-24 21:14:02.623: W/System.err(831):  at android.os.AsyncTask$2.call(AsyncTask.java:185)
04-24 21:14:02.633: W/System.err(831):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
04-24 21:14:02.633: W/System.err(831):  at java.util.concurrent.FutureTask.run(FutureTask.java:138)
04-24 21:14:02.633: W/System.err(831):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
04-24 21:14:02.633: W/System.err(831):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
04-24 21:14:02.633: W/System.err(831):  at java.lang.Thread.run(Thread.java:1019) 
```

有什么问题，我认为是字符串编码？！

## 更新：

代码在这里

```
//Download text -------------------------------------------------------------
private String DownloadText(String urlString){
    InputStream in = null;
    StringBuilder sb = new StringBuilder();
    try{
        in = OpenHttpConnection(urlString);
        BufferedReader br = new BufferedReader(new InputStreamReader(in));
        String line="";
        while((line = br.readLine())!= null){
            sb.append(line);
        }
    }catch(IOException ex){

    }
    return sb.toString();
}

//Parse JSON text -----------------------------------------------------------
private FBUser pasreJSON(String url){
    FBUser user = null;
    JSONArray json;
    Log.d("JSON----------------",DownloadText(url));
    try {
        user = new FBUser();
        json = new JSONArray(DownloadText(url));
        for(int i=0;i<json.length();i++){
            JSONObject object = json.getJSONObject(i);
            user.id = object.getString("id");
            user.name = object.getString("name");
            user.first_name = object.getString("first_name");
            user.last_name = object.getString("last_name");
            user.link = object.getString("link");
            user.username = object.getString("username");
            user.gender = object.getString("gender");
            user.locale = object.getString("locale");
        }
    } catch (JSONException e) {
        e.printStackTrace();
    }

    return user;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:22:48.053

错误在于这不是 JSONArray，而是 JSONObject。数组用方括号括起来，而对象用大括号括起来。

看看官方网站[json.org](http://json.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:31:02.143

在这一行：

```
json = new JSONArray(DownloadText(url)); 
```

将其更改为：

```
json = new JSONObject(DownloadText(url)); 
```

显然改变`json`为`JSONOBject`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T21:37:30.197

尝试

```
JSONObject object = new JSONObject (DownloadText(url));
                     user.id = object.getString("id");   
               user.name = object.getString("name");  
                user.first_name = object.getString("first_name"); 
                 user.last_name = object.getString("last_name"); 
                 user.link = object.getString("link");         
         user.username = object.getString("username");        
          user.gender = object.getString("gender");            
      user.locale = object.getString("locale"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T21:22:14.283

看起来`pit.opensource.readjson.D0ReadJSONWebServiceActivity.pasreJSON`正在尝试将 facebook 用户信息响应解码为一种`JSONArray`类型。

您应该将其存储在 a 中`JSONObject`。

# python - 带有 *args 的 Python 类型错误

> ID：10306163
> 
> 赞同：2
> 
> 时间：2012-04-24T21:20:07.413
> 
> 标签：python

原谅我的无知，我是 Python 新手，我似乎无法在 Google 上找到答案。也许我只是没有搜索正确的关键字。

我有一个基本功能如下：

```
class Basic(object):
    def Process(*values):
        for i in range(len(values)):
            value = int(values[i])
            print value

b = Basic()
b.Process(4, 5, 6) 
```

我收到以下错误：

> TypeError：int() 参数必须是字符串或数字，而不是“基本”

我相信这很简单，但任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T21:22:19.160

你忘了给`self`Process 作为参数：

```
def Process(self, *values): 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:25:06.053

对了，自己。实例方法应该小写并且不应该写类：[http](http://www.youtube.com/watch?v=o9pEzgHorH0) ://www.youtube.com/watch?v=o9pEzgHorH0 （因为我已经在写这个答案了）。

```
class Basic(object):

    def process(self, *values):
        for v in values:
            v = int(v)
            print v

b = Basic()
b.process(4, 5, 6) 
```

# java - 如何使 JTable 列不包含 JTextFields，而是包含 JTextAreas？

> ID：10306164
> 
> 赞同：2
> 
> 时间：2012-04-24T21:20:12.490
> 
> 标签：java, swing, jtable, textarea, awt

请告诉我，如何使 JTable 列包含 JTextAreas，这样当用户输入大量文本时，单元格的高度会增加，我们可以看到不止一行（单元格被扩展；结果，行也会扩展）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T21:48:11.817

您需要基于 JTextArea 编写自己的单元格渲染器和编辑器：

```
 public class Start
{
    public static class JTextPaneCellEditor extends AbstractCellEditor implements TableCellEditor, KeyListener
    {
        private JViewport viewport;
        private JTable table;
        private int row;
        private JTextPane pane;

        public JTextPaneCellEditor(){
            viewport = new JViewport();
            pane = new JTextPane();
            viewport.add(pane);
            pane.addKeyListener(this);
        }

        @Override public Object getCellEditorValue(){
            return pane.getText();
        }

        @Override public Component getTableCellEditorComponent(JTable table, Object value, boolean isSelected, int row, int column){
            this.table = table;
            this.row = row;
            pane.setText(value.toString());
            int newHeight = (int)pane.getPreferredSize().getHeight();
            if(table.getRowHeight(row) < newHeight){
                table.setRowHeight(row, newHeight);
            }
            return pane;
        }

        @Override public boolean isCellEditable(EventObject e){
            if (e instanceof MouseEvent) {
                return ((MouseEvent)e).getClickCount() >= 2;
            }
            return true;
        }

        @Override public void keyTyped(KeyEvent e){
            table.setRowHeight(row, (int)pane.getPreferredSize().getHeight());
        }

        @Override public void keyPressed(KeyEvent e){
            if(e.getKeyCode() == KeyEvent.VK_ENTER){
                stopCellEditing();
            }
        }

        @Override public void keyReleased(KeyEvent e){
        }
    }

    private static class JTextPaneCellRenderer extends JViewport implements TableCellRenderer
    {
        JTextPane pane;
        JTextPaneCellRenderer(){
            pane = new JTextPane();
            add(pane);
        }

        @Override public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column){
            pane.setText(value.toString());
            table.setRowHeight(row, (int)pane.getPreferredSize().getHeight());
            return this;
        }
    }

    public static void main(String[] args){
        JTable table = new JTable(new String[][]{{"String String String String StringString String String String StringString String String String StringString String String String StringString String String String String"}, {"String 2"}}, new String[]{"Column"});
        table.setDefaultRenderer(Object.class, new JTextPaneCellRenderer());
        table.setDefaultEditor(Object.class, new JTextPaneCellEditor());

        JFrame test = new JFrame();
        test.add(new JScrollPane(table));
        test.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        test.setSize(300, 300);
        test.setLocationRelativeTo(null);
        test.setVisible(true);
    }
} 
```

编辑：添加视口以获得更好的尺寸。但该行在第一次编辑时仍未展开。有没有人有任何想法？

EDIT2：我同意这些评论。您想要的东西是可能的，但您需要未经测试的、骇人听闻的自定义实现。如果您重新设计布局以排除此类 JTable 巫术，您的情况会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T22:24:38.693

@Jakub Zaverka

我稍后会删除这个答案

```
import java.awt.*;
import javax.swing.*;
import javax.swing.table.*;
import javax.swing.text.*;

public class AutoWrapTest {

    public JComponent makeUI() {
        String[] columnNames = {"TextAreaCellRenderer"};
        Object[][] data = {
            {"123456789012345678901234567890"},
            {"dddddddddddddddddddddddddddddddddddddddddddddddddddddddddx"},
            {"----------------------------------------------0"},
            {">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>|"},};
        TableModel model = new DefaultTableModel(data, columnNames) {

            private static final long serialVersionUID = 1L;

            @Override
            public boolean isCellEditable(int row, int column) {
                return false;
            }
        };
        JTable table = new JTable(model) {

            private static final long serialVersionUID = 1L;

            @Override
            public void doLayout() {
                TableColumn col = getColumnModel().getColumn(0);
                for (int row = 0; row < getRowCount(); row++) {
                    Component c = prepareRenderer(col.getCellRenderer(), row, 0);
                    if (c instanceof JTextArea) {
                        JTextArea a = (JTextArea) c;
                        int h = getPreferredHeight(a) + getIntercellSpacing().height;
                        if (getRowHeight(row) != h) {
                            setRowHeight(row, h);
                        }
                    }
                }
                super.doLayout();
            }            //http://tips4java.wordpress.com/2008/10/26/text-utilities/

            private int getPreferredHeight(JTextComponent c) {
                Insets insets = c.getInsets();
                View view = c.getUI().getRootView(c).getView(0);
                int preferredHeight = (int) view.getPreferredSpan(View.Y_AXIS);
                return preferredHeight + insets.top + insets.bottom;
            }
        };
        table.setEnabled(false);
        table.setShowGrid(false);
        table.setTableHeader(null);
        table.getColumnModel().getColumn(0).setCellRenderer(new TextAreaCellRenderer());
        JScrollPane sp = new JScrollPane(table);
        sp.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        JPanel p = new JPanel(new BorderLayout());
        p.add(sp);
        return p;
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                createAndShowGUI();
            }
        });
    }

    public static void createAndShowGUI() {
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        f.getContentPane().add(new AutoWrapTest().makeUI());
        f.setSize(200, 200);
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }
}

class TextAreaCellRenderer extends JTextArea implements TableCellRenderer {

    private static final long serialVersionUID = 1L;
    private final Color evenColor = new Color(230, 240, 255);

    public TextAreaCellRenderer() {
        super();
        setLineWrap(true);
        setWrapStyleWord(true);
        setBorder(BorderFactory.createEmptyBorder(2, 2, 2, 2));
    }

    @Override
    public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column) {
        if (isSelected) {
            setForeground(table.getSelectionForeground());
            setBackground(table.getSelectionBackground());
        } else {
            setForeground(table.getForeground());
            setBackground(table.getBackground());
            setBackground((row % 2 == 0) ? evenColor : getBackground());
        }
        setFont(table.getFont());
        setText((value == null) ? "" : value.toString());
        return this;
    }
} 
```

# hibernate - 如何为 SYSDATE 编写 HQL？

> ID：10306166
> 
> 赞同：3
> 
> 时间：2012-04-24T21:20:24.310
> 
> 标签：hibernate, hql

我有检查当前日期的条件 - 3。

```
select * from TABLE_1 SYSDATE-3 >= TABLE_1.created_date 
```

我应该如何用 Hibernate 查询语言编写？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-30T23:04:18.667

对于 Oracle SQL 方言`sysdate()`，使用如下示例：

```
select e
from Entity e
where (e.endDate is null or (e.endDate > sysdate())) 
```

这适用于`orm.xml`或在使用`<named-query>`

对于您的特定查询“过去三天内未创建的所有行”，请使用以下命令：

```
select e from Entity e where to_date(sysdate() - 3) >= e.created_date 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:37:00.153

您需要使用您的实体编写 HQL。

[http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html_single/#queryhql-examples](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html_single/#queryhql-examples)

有一些使用 sysdate 的示例。

# android - 删除 Android 上 kSoap2 生成的 SOAP 请求中的 i:type 字段

> ID：10306171
> 
> 赞同：5
> 
> 时间：2012-04-24T21:20:58.210
> 
> 标签：android, soap, ksoap2, android-ksoap2, ksoap

我已经尝试在互联网上阅读有关我的问题的信息，但找不到所需的正确信息，因此我尝试解释我的问题：

我正在使用 kSoap2 通过 SOAP 与 Web 服务“对话”。要生成我的 SOAP 请求，我使用以下代码：

```
// Generate SOAP request XML
SoapObject request = new SoapObject(PUB_NAMESPACE,
"testSoapInterface");   

// Add request header
PropertyInfo requestHeader = new PropertyInfo();
requestHeader.setNamespace(PUB_NAMESPACE);
requestHeader.setName("requestheader");

// Generate username property
PropertyInfo usernameProp = new PropertyInfo();
usernameProp.setNamespace(BASE_NAMESPACE);
usernameProp.setName("username");
usernameProp.setValue(username);

// Generate applicationId property
PropertyInfo applicationIdProp = new PropertyInfo();
applicationIdProp.setNamespace(BASE_NAMESPACE);
applicationIdProp.setName("applicationId");
applicationIdProp.setValue("test");

// Add properties to requestHeader (nested)
requestHeader.setValue(new SoapObject(PUB_NAMESPACE, "requestheader")
.addProperty(usernameProp)
.addProperty(applicationIdProp));

request.addProperty(requestHeader); 
```

现在，为了序列化它，我使用以下内容：

```
// Serialize SOAP request to the non .NET based SOAP server
SoapSerializationEnvelope soapEnvelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
soapEnvelope.dotNet = false;
soapEnvelope.implicitTypes = true;
soapEnvelope.setAddAdornments(false);
soapEnvelope.setOutputSoapObject(request); 
```

因为我使用的是嵌套的soap（requestheader 由 applicationId 和 username 组成）我可以想象这可能是原因。我还必须为不同的行使用不同的命名空间，这也可能是一个原因。

有人可以帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-06-06T12:27:35.830

您可以使用信封的implicitTypes 属性：

```
SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
envelope.implicitTypes = true; 
```

这样生成的 xml 将不包含 i:type。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T09:36:12.510

有同样的问题，似乎不可能使用 PropertyInfo 而不生成任何 i:type 。不错的解决方案是覆盖 AddProperty(PropertyInfo pi)，因此它适用于任何没有 i:Type 的情况。

提供三种解决方案：

# 1

如果你不需要命名空间，那么 request.AddProperty(name,value) 就可以了！

# 2

你可以让你的请求头成为一个自己的 SoapObject，它不会使用“i：type”。

```
SoapObject requestHeader = new SoapObject(NAMESPACE,"requestheader"); 
```

在最后一行

```
request.AddSoapObject(requestHeader); 
```

# 3

对我来说，将 SoapEnvelope 的版本设置为“VER10”是可行的，因为那时这些类型被忽略了。它们仍在您的请求中，但被忽略了。将：替换`SoapEnvelope.VER11`为：`SoapEnvelope.VER10`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-12T13:41:54.493

你在哪里创作

```
 SoapSerializationEnvelope sEnvelop; 
```

只需分配`sEnvelop.implicitTypes = true;`

它不会创建 "i:type="d:string"" 或 "i:type="d:long"" 内部数据类型标签，并且 Web 服务可以成功执行

# jquery - jquery动画div左/右如果条件

> ID：10306176
> 
> 赞同：0
> 
> 时间：2012-04-24T21:21:21.780
> 
> 标签：jquery, if-statement, jquery-animate

我设法将一段代码放在一起，根据某些条件为容器 div 内的 div 设置动画 - 但是我的数学必须稍微偏离，因为它的动画向左稍微太远了。见例子@http [://dev.whiteb0x.com/gallery](http://dev.whiteb0x.com/gallery)

```
var width = $('#nav').width();
$('#nav').width(width * 2 + 20);

$(".nav-next").click(function () {
    var pos = $('#nav').position();
    var width = $('#nav-viewport').width();
    var width = width * (-1);
    alert(width);
    if (pos.left <= 0 && pos.left > width && !$('#nav').is(':animated')) {
        $('#nav li:first').before($('#nav li:last'));
        $("#nav").animate({"left": "-=300"}, "slow");
    }
});

$(".nav-prev").click(function () {
    var pos = $('#nav').position();
    if (!pos.left <= 0 && !$('#nav').is(':animated')) {
        $('#nav li:first').before($('#nav li:last'));
        $("#nav").animate({"left": "+=300"}, "slow");
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:25:27.020

您要声明`width`三遍，这将在以后引起您的问题。您可以在作用域单击事件中将其减少为一个变量并重命名它，这样它就不会干扰`with`外部作用域中的声明。

```
var _width = - ($('#nav-viewport').width()); 
```

那么这个条件就很奇怪了：

```
if (!pos.left <= 0 && !$('#nav').is(':animated')) 
```

而不是`!pos.left <= 0`你可以做的`pos.left > 0`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:24:01.097

试试外宽？可能解决一些数学问题

[http://api.jquery.com/outerWidth/](http://api.jquery.com/outerWidth/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T21:52:30.867

你有两件事同时发生。您正在将项目从后面移动到前面，等等，并且您正在制作动画。当您进行从前到后的移动时，您的所有图像都会移动。`300px`最重要的是，当您的`li`元素的边距为时，您只能通过 制作动画`5px`，这是`160px`1 张图像的总和。（两人 320，但我不认为你想要那个）：

```
var width = $('#nav').width();
$('#nav').width(width * 2 + 20);

$("#nav").css({
    left: $('#nav').position().left - 160 + 'px' // Give a 1 image "buffer" for shifting left
});

$(".nav-next").click(function() {
    var pos = $('#nav').position();
    if (!$('#nav').is(':animated')) {
        $('#nav li:first').insertAfter($('#nav li:last'));
        $("#nav").css({
            left: pos.left + 160 + 'px'  // Move because we reordered images
        }).animate({
            "left": pos.left
        }, "slow"); // Shift back
    }
});

$(".nav-prev").click(function() {
    var pos = $('#nav').position();
    if (!$('#nav').is(':animated')) {
        $('#nav li:last').insertBefore($('#nav li:first'));
        $("#nav").css({
            left: pos.left - 160 + 'px'  // Move because we reordered images
        }).animate({
            "left": pos.left
        }, "slow"); // Shift back
    }
}); 
```

演示：http: [//jsfiddle.net/jtbowden/GFx7h/1/](http://jsfiddle.net/jtbowden/GFx7h/1/)

# java-me - (J2ME) 从其他类获取 MIDlet 的引用？

> ID：10306178
> 
> 赞同：3
> 
> 时间：2012-04-24T21:21:22.017
> 
> 标签：java-me, midp, midlet, lcdui

我正在尝试在 midlet ( `Main`) 类之外创建一个可以设置屏幕上的内容的类（比如将表单设置为显示，等等。）
所以我想我必须输入并更改`Main`'s 变量`display`，但我出错了。

这是整个程序：

```
//Main.java
import javax.microedition.midlet.*;
import javax.microedition.lcdui.*;
public class Main extends MIDlet {

    public Other othr = new Other(this);
    public Display display = Display.getDisplay(this);
    public void startApp() {
        display.setCurrent(othr);
    }

    public void pauseApp() {
    }

    public void destroyApp(boolean unconditional) {
    }
} 
```

```
//Other.java
import javax.microedition.lcdui.*;
public class Other extends Canvas{

    Form a = new Form("a");
    public TextEdit(Main mc){
        //HERE IT IS!
        mc.display.getDisplay(mc).setCurrent(a);
        //If I comment out the above, I get no error.

    }
    protected void paint(Graphics g) {
         //Nothing yet
    }

} 
```

而且我总是收到错误*“应用程序已意外退出”*。

我也尝试用 替换`mc.display.getDisplay(mc).setCurrent(a);`，`Display.getDisplay(mc).setCurrent(a);`然后没有显示错误，但是根本没有显示 Form a。

这可能是一个愚蠢的错误，但我迷路了

我能做些什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T05:12:40.013

这是您的代码中的一个小错误。在您的代码中进行更改，如下所示。

```
//Main.java
import javax.microedition.midlet.*;
import javax.microedition.lcdui.*;
public class Main extends MIDlet {

    public Other othr ;
    public Display display ;
    public void startApp() {
         display= Display.getDisplay(this);
        othr=new Other(this);
        display.setCurrent(othr);
    }

    public void pauseApp() {
    }

    public void destroyApp(boolean unconditional) {
    }
} 
```

并检查您的 Other 看起来像这样，确保您想要的 Form 或 Canvas 都不同。

像这样形成你的代码

```
//Other.java
import javax.microedition.lcdui.*;
public class Other {

    Form a ;
    public Other(Main mc){
        //HERE IT IS!
       a=new Form("a");
        Display.getDisplay(mc).setCurrent(a);
        //If I comment out the above, I get no error.

    }

} 
```

对于帆布检查这个

```
/Other.java
import javax.microedition.lcdui.*;
public class Other extends Canvas{

     public Other(Main mc){
        //HERE IT IS!
        Display.getDisplay(mc).setCurrent(this);
        //If I comment out the above, I get no error.

    }
    protected void paint(Graphics g) {
         //Nothing yet
    }

} 
```

这将对您有所帮助，注意：：检查 Canvas 和 Forms 之间的区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:16:56.923

代替

```
 public Other othr = new Other(this);
 public Display display = Display.getDisplay(this); 
```

和

```
public Other othr;
public Display display;

public Main()
{
  othr = new Other(this);
  display = Display.getDisplay(this)
} 
```

# design-patterns - 将公共变量传递到 Node.js 中的单独模块的最佳方法是什么？

> ID：10306185
> 
> 赞同：59
> 
> 时间：2012-04-24T21:21:51.953
> 
> 标签：design-patterns, node.js

我使用单独的路由器文件作为主应用程序和身份验证应用程序的模块。我无法获得将变量（数据库客户端）传递到路由器的最佳方法。我不想对其进行硬编码或将其传递给：

```
module.exports = function(app, db) { 
```

也许这是使用单例寄存器或使用全局数据库变量的最佳方式？

你对设计模式有什么经验？哪种方式最好，为什么？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-04-26T06:31:32.070

我发现使用依赖注入来传递东西是最好的风格。它确实看起来像你：

```
// App.js
module.exports = function App() {
};

// Database.js
module.exports = function Database(configuration) {
};

// Routes.js
module.exports = function Routes(app, database) {
};

// server.js: composition root
var App = require("./App");
var Database = require("./Database");
var Routes = require("./Routes");
var dbConfig = require("./dbconfig.json");

var app = new App();
var database = new Database(dbConfig);
var routes = new Routes(app, database);

// Use routes. 
```

这有很多好处：

*   它迫使您将系统分成具有明确依赖关系的组件，而不是将依赖关系隐藏在它们调用的文件中间的某个地方`require("databaseSingleton")`或更糟的地方，`global.database`.
*   它使单元测试变得非常容易：如果我想单独测试`Routes`，我可以用 fake`app`和`database`params 注入它，只测试`Routes`代码本身。
*   它将所有对象图连接放在一个地方，即组合根（在本例中是`server.js`应用程序入口点）。这使您可以在一个地方查看所有内容如何在系统中组合在一起。

我见过的对此的更好解释之一是[对 Mark Seeman 的采访](http://www.infoq.com/articles/DI-Mark-Seemann)，他是优秀著作*.NET 中的依赖注入的*作者。它同样适用于 JavaScript，尤其是 Node.js：`require`通常用作经典的服务定位器，而不仅仅是模块系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T13:13:08.587

我建议您使用 db 实例和其他需要全局使用的东西（如“单例”）创建一个设置文件。

例如，我的 redis db 客户端有 settings.js：

```
var redis = require('redis');
exports.redis = redis.createClient(6379, '127.0.0.1'); 
```

在其他多个模块中，我将其包括在内：

```
var settings = require('./settings');
setting.redis.<...> 
```

很多时候包括它我总是有一个数据库连接实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-25T14:34:29.807

如果您使用依赖注入框架，您可以为自己节省所有连接模块的样板代码

[这个答案](https://stackoverflow.com/a/20461486/3716153)列出了其中一些。我还在[这里构建了一个更简单的 DI 框架](https://github.com/Gaafar/deppie)。

**编辑：**如果页面发生变化，下面是答案的副本

* * *

`require`是Node.js 中管理依赖项**的**方式，当然它是直观和有效的，但它也有其局限性。

我的建议是看一下目前可供 Node.js 使用的一些依赖注入容器，以了解它们的优缺点。他们之中有一些是：

*   [分散](https://github.com/mariocasciaro/scatter)
*   [电解质](https://github.com/jaredhanson/electrolyte)
*   [金属丝](https://github.com/cujojs/wire)
*   [静脉](http://www.royjacobs.org/intravenous/)
*   [流行的](https://github.com/FungusHumungus/pongular)

仅举几个。

现在真正的问题是，与简单的`require`.

**优点：**

*   更好的可测试性：模块接受它们的依赖作为输入
*   控制反转：决定如何在不触及应用程序主代码的情况下连接模块。
*   用于解析模块的可定制算法：依赖项具有“虚拟”标识符，通常它们不绑定到文件系统上的路径。
*   更好的可扩展性：由 IoC 和“虚拟”标识符启用。
*   其他可能的花哨的东西：
    *   异步初始化
    *   模块生命周期管理
    *   DI 容器本身的可扩展性
    *   可以轻松实现更高级别的抽象（例如 AOP）

**缺点：**

*   与 Node.js 的“体验”不同：不使用`require`绝对感觉像是在偏离 Node 的思维方式。
*   依赖项与其实现之间的关系并不总是明确的。依赖关系可以在运行时解决并受各种参数的影响。代码变得更难理解和调试
*   启动时间较慢
*   成熟度（目前）：目前没有一个解决方案**真正**流行，所以没有那么多教程，没有生态系统，没有经过实战测试。
*   一些 DI 容器不能很好地与 Browserify 和 Webpack 等模块捆绑器配合使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-23T16:55:11.060

它已完全过时，但您可以`global` 在脚本中使用：

```
 global.foo = new Foo(); 
```

在另一个脚本中：

```
 foo.bar(); 
```

您还可以使用已经存在的常量：

```
 Object.foo = new Foo(); 
```

和这里 ：

```
 Object.foo.bar(); 
```

# c# - 无法修改存储在另一个属性中的结构的属性

> ID：10306187
> 
> 赞同：3
> 
> 时间：2012-04-24T21:21:53.167
> 
> 标签：c#, .net

我有一个小问题，我无法修改存储在另一个属性中的结构属性，我不知道为什么：

代码：

```
 public struct InfoProTile
    {
        public string Nazev { get; set; }
        public double Hodnota { get; set; }
        public TypValue TypValue { get; set; }
        public NavigovatNa NavigovatNa { get; set; }
    }

        public InfoProTile BNDTileInfo { get { return bndTileInfo; } set { bndTileInfo = value; } } private InfoProTile bndTileInfo;

        LoadModel()
    {
        ...
        BNDTileInfo = new InfoProTile();
        BNDTileInfo.NavigovatNa = NavigovatNa.MainPage;
    } 
```

错误：

```
Error: Error 3 Cannot modify the return value of '...ViewModel.TilesModel.BNDTileInfo' because it is not a variable 
```

我不明白，因为如果我将其更改为：

```
bndTileInfo.NavigovatNa = NavigovatNa.MainPage; 
```

有用。谁能给我解释一下？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T21:27:11.413

A`struct`是一种值类型，因此当您从属性访问它时，您将返回一个副本`struct`而不是底层字段直接。因此，C# 不允许您修改该结构的副本，因为这只是一个将被丢弃的临时对象。

所以，当你打电话时：

```
BNDTitleInfo.NavigovatNa = ...; 
```

它首先调用`get`属性并返回 的副本`bndTitleInfo`，然后尝试设置`NavigovatNa`属性和*副本*。C# 在这里给您错误，因为这不是您真正想做的事情，因此可以保护您免受自己的伤害。

但是，当你打电话时：

```
bndTitleInfo.NavigovatNa = ...; 
```

您直接引用该字段，因此没有复制，也没有编译器问题。

总而言之，可变值类型不能产生好的属性（通常你应该完全避免可变值类型）。

要进行纠正，您可以将其设为引用类型 ( `class`)，也可以将`struct`其设为不可变，这意味着您必须分配一个全新的 struct 实例来更改它的值。

如果您查看 MSDN 的建议，通常`struct`最适合小型、逻辑单值、不可变结构：[在类和结构之间选择](http://msdn.microsoft.com/en-us/library/ms229017.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-24T21:28:18.073

因为`BNDTileInfo`是一个属性，所以你得到一个数据的**克隆**。当克隆被丢弃时，对克隆的更改会丢失，即您的代码是：

```
var tmp = BNDTileInfo; // tmp is a completely separate clone
tmp.NavigovatNa = NavigovatNa.MainPage; // change the local clone
// discard the clone - our change was wasted 
```

编译器已阻止您遇到大问题。这是因为什么`struct` **意思**，即值类型语义，也就是复制语义。

这里真正的答案是：不要把它变成`struct`. 即使不知道这些词是什么，我 99% 肯定这不应该是`struct`. 当然，`struct`即使你刚刚说“我有一个跟注`struct`” ，我仍然有 98.5% 的把握它不应该是 a `InfoProTile`。

做`BNDTileInfo`a `class`，除非你能**非常清楚地**解释为什么它是 a `struct`，**然后**可以证明它为什么是*mutable* `struct`。

# ruby-on-rails - Rails：许多跨字段自定义验证器的最佳实践？

> ID：10306202
> 
> 赞同：0
> 
> 时间：2012-04-24T21:23:09.040
> 
> 标签：ruby-on-rails, customvalidator

我正在开发一个具有一些非常复杂的验证要求的 Rails 项目。该项目输出数据以上传到状态报告系统，因此我想在尝试将其上传到状态之前在系统中提出验证问题。以下是一些验证示例：

*   如果设置了字段 B，则字段 A 必须为空白，如果设置了字段 A，则字段 B 必须为空白。
*   如果字段 D 为 0、6 或 9，则字段 C 必须为 0
*   如果设置了字段 F，则字段 E 必须有一个值。
*   等等

最佳实践是使用模型中的方法进行自定义验证，为模型使用一个自定义验证器类，还是为每个业务规则使用一个自定义验证器类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T21:26:34.220

如果您有可重用的自定义验证逻辑，您可能最好将它们放在单个 CustomValidator 模块中，并将其混合到需要使用它们的任何类中。

所以答案是模型是陈述验证规则的正确位置；只需使用任何可以使其干燥的助手即可。

# mysql - 删除 SQL 中的空格

> ID：10306213
> 
> 赞同：0
> 
> 时间：2012-04-24T21:23:59.490
> 
> 标签：mysql, sql

我的数据库中有很多包含过多空格的记录：

```
to buy  books is  like to buy
bad   journalists  aren't taken   hostage
  for your   information  this isn't    what we do 
```

有没有办法在（My）SQL中 - 用一个替换所有空格 - 从字符串的开头和结尾去除所有空格？

否则我总是可以在 php 中做到这一点，通过查看所有记录

```
$cleaned = trim(preg_replace('/\s+/', ' ', $string)); 
```

但这需要我想象的更多时间（我有数百万条记录）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:53:09.923

由于这是一次性操作，您可以将记录导出为某种文本格式（csv、sql 插入..）并用支持正则表达式的良好文本编辑器进行替换。当您的正则表达式毕竟不是那么完美时，为您提供备份。之后导入到新表中。

当您以代码方式进行替换时，您可以过滤掉不需要替换的记录，例如“where field like "% %"”以加快处理速度。

最后但并非最不重要的一点是，您必须更新写入这些记录的服务器代码，以在写入数据库**之前过滤掉多余的空格。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:37:47.067

在 MySQL 中，只有使用正则表达式对模式匹配的内置支持。可以使用用户定义的函数，例如[http://www.mysqludf.org/lib_mysqludf_preg/](http://www.mysqludf.org/lib_mysqludf_preg/)来解决您的需求。

这个不支持多字节字符。因此，您只能使用此解决方案进行单字节字符编码。

# java - 创建容错系统 - 使用数据文件重新加载保存数据？

> ID：10306219
> 
> 赞同：0
> 
> 时间：2012-04-24T21:24:21.160
> 
> 标签：java, monitor, fault, fault-tolerance

编辑 - 实现语言是 Java。

我想做一个简单的容错系统。

*   对象 A - 此对象包含系统的决策逻辑。
*   对象 B - 此对象将用于控制容错

我最初的想法是让对象 A 使用要保存到数据文件的变量值更新对象 B。然后对象 B 将创建一个数据文件，该文件将保存到平台系统的硬盘驱动器中。

我的问题是：如何使用对象变量的值创建数据文件，然后从数据文件中检索这些变量？当他们被调用时。

我很高兴将变量值写入记事本文件，然后从文件中调用它们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:05:57.857

对于您只想为内存数据提供持久性和容错性的简单用例，您可能需要查看[Prevayler](http://prevayler.org/)。它是一个简单的库，可在序列化之上构建检查点（快照）和重做日志，以低廉的价格为您提供事务语义。

# c++ - 是否有用于配置应用程序的标准会话层协议？

> ID：10306228
> 
> 赞同：1
> 
> 时间：2012-04-24T21:25:42.277
> 
> 标签：c++, linux, configuration

我正在从头开始设计应用程序。我有一个要求，我想使用已经存在的解决方案来满足。

我希望在应用程序的整个生命周期中，用于传递配置信息的传输和方法是统一的。

这是什么意思？这意味着在加载时使用文件进行配置，然后使用套接字通信进行以后的配置是不行的。我希望所有配置都以一种方式进入应用程序。该管道在应用程序的整个生命周期中始终可用。

除此之外，我不想让自己不得不使用 IP。我想使用我喜欢的任何传输方式，包括 System V 共享内存或 IPC 之类的东西。

外面有什么吗？我必须创建自己的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:45:50.553

我认为以下内容不会提供您正在寻找的功能，但它可能会提供一些思考空间......

假设您的应用程序被调用`myApp`，并且`-cfg <...>`命令行选项用于指定其配置的来源。您可以允许以下选项...

`myApp -cfg /path/to/configuration/file.cfg`

上面很明显：从指定文件中读取配置。

`myApp -cfg "exec#curl -sS http://configWebServer/path/to/file.cfg"`

`exec#`前缀指定应执行指定的命令。预计该命令将写入标准输出。然后将该标准输出解析为配置文件。

顺便说一句，`curl`代表[*cat URL*](http://curl.haxx.se/)。它是一个开源实用程序，可以使用多种协议检索文件，包括 HTTP(S)、FTP(S)、LDAP 等。`-sS`命令行选项告诉`curl`它除了错误消息之外不打印诊断信息，这可能是您想要的。

该`"exec#..."`格式为使用其他方式检索配置信息铺平了道路。例如，来自查询数据库的脚本、来自 Subversion 存储库或任何您想要的。

您可能还希望支持以下变体：

`myApp -cfg "shared_lib=foo#..."`

这将加载一个名为 的共享库`foo`，并在其中调用一个入口点函数，将`"...`" 作为参数传递。由共享库函数决定如何处理该参数。共享库的一种实现可能会检索来自共享内存的配置信息；另一个实现可能通过远程过程调用或套接字连接检索它；等等。

所有不同的检索机制*仅*负责将配置数据作为（可能很大的）字符串进行检索。例如，该`-cfg /path/to/file.cfg`机制读取文件的全部内容并将其作为字符串（或者可能作为`std::istream`）返回。然后将该（可能很大）字符串传递给“真正的”配置解析器（XML/ini/properties 文件或其他文件的解析器）。

我相信上述建议为您的一半问题提供了解决方案。特别是，它提供了一种插件架构来从任意来源检索配置数据，其中插件可以编写为 shell 命令或共享库。

您问题的另一半基本上是：“应用程序如何在其生命周期内动态检索更新的配置数据？” 我没有解决这个要求。部分原因是我没有提供优雅的解决方案。部分原因是您没有指出可能触发重新读取配置数据的原因。

顺便说一句，我是一个名为[Config4*](http://www.config4star.org/)的 C++/Java 配置解析器库的维护者。该库提供了该`"exec#..."`功能的实现。我提到，如果您想检查源代码以了解如何实现此类功能。我怀疑支持所需的代码`"shared_lib=foo#..."`可以很容易地以现有的支持代码为模型`"exec#..."`。“Config4* 入门指南”（可从网站以 PDF 和 HTML 格式获得）对该`-cfg "exec#..."`功能进行了很好的讨论，包括防止人们尝试执行恶意命令的安全机制。

# objective-c - Xcode，如何更改一个目标的图像文件？

> ID：10306230
> 
> 赞同：3
> 
> 时间：2012-04-24T21:25:45.140
> 
> 标签：objective-c, xcode, target

在某个时候，我为所有目标添加了所有文件。

但是，现在我想为我的第二个目标使用相同的文件名但不同的电子邮件。

如何更改文件？

我是否必须从所有目标中删除它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:33:15.147

如果您在 Xcode 中选择一个文件并查看检查器，您可以选择该文件属于哪个目标。

你可以在同一个项目中有两个同名的文件*，*它们不能在同一个文件夹中。现在 Xcode 在帮助您管理文件夹方面相当糟糕，但它会将文件留在文件夹中......

所以

1.  在 Finder 中打开您的 Xcode 源文件夹
2.  创建一个子文件夹，如果你愿意，你可以在你的目标之后命名它
3.  将您希望为一个目标更改的文件复制到该文件夹​​中
4.  返回 Xcode 选择文件并在检查器中取消选择目标
5.  添加复制的文件，包括它仅用于一个目标。（在 Xcode 中创建一个组是个好主意）。
6.  大功告成，可以分别编辑两个版本

# ruby-on-rails - 在 Rails 3 中从所有者链接到子记录？

> ID：10306232
> 
> 赞同：0
> 
> 时间：2012-04-24T21:25:50.910
> 
> 标签：ruby-on-rails, nested, hyperlink, model-associations

我知道这是一个非常简单的问题，但我已经完全空白了！我正在阅读 Rails 指南并查看入门部分。以下代码显示属于当前帖子的所有评论：

```
<h2>Comments</h2>
<% @post.comments.each do |comment| %>
 <p>
  <b>Commenter:</b>
  <%= comment.commenter %>
 </p>

<p>
<b>Comment:</b>
<%= comment.body %>
</p>
<% end %> 
```

链接到每个评论的最简单方法是什么？作为参考，我正在查看的页面是[http://guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)

型号如下：

```
class Post < ActiveRecord::Base
  has_many :comments
end

class Comment < ActiveRecord::Base
  belongs_to :post
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:29:38.490

Rails 将尝试创建路线助手来帮助您。您可以通过运行获得完整列表`rake routes`，但您要查找的列表很有可能被命名为`comment_path`：

```
<% @post.comments.each do |comment| %>
  <%= link_to 'Click to view comment', comment_path(comment) %>
<% end %> 
```

作为参考，请查看[Rails 路由指南](http://guides.rubyonrails.org/routing.html#generating-paths-and-urls-from-code)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:30:39.757

您应该查看您的路线，并查看单个评论的路径。

它应该是这样的：`comment_path(comment)`或`post_comment(@post, comment)`

你会将它与`<%= link_to "View comment", comment_path(comment) %>`

# linq-to-entities - LINQ to Entities：查询主键所需的解决方法

> ID：10306234
> 
> 赞同：1
> 
> 时间：2012-04-24T21:26:33.043
> 
> 标签：linq-to-entities, wcf-data-services

在 Silverlight 应用程序中使用 LINQ to Entities 时，在对表的主键生成查询时：

```
var query = (from b in PHOTOS
where b.RECORDID == selectedRecordId
select b); 
```

它看起来像这样`http://localhost/DataService.svc/PHOTOS('123456')`。这是可以的，直到需要将相同的代码用于（令人惊讶地）没有强制执行 PK 约束的旧数据库。结果是返回一条记录，然后出现错误：

```
<error xmlns="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">
  <code></code>
  <message xml:lang="en-US">An error occurred while processing this request.</message>
  <innererror>
    <message>A single resource was expected for the result, but multiple resources were found.</message>
    <type>System.InvalidOperationException</type>
    <stacktrace>   at System.Data.Services.Serializers.Serializer.WriteRequest(IEnumerator queryResults, Boolean hasMoved)&#xD;
   at System.Data.Services.ResponseBodyWriter.Write(Stream stream)</stacktrace>
  </innererror>
</error> 
```

如果我像这样手动重写查询，这个问题就会消失`http://localhost/DataService.svc/PHOTOS()?$filter=RECORDID eq '123456'`：如何编写 LINQ 代码以强制它使用 $filter 而不是括号中的 PK？需要此表中的所有结果，因此仅获取第一个结果是行不通的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:36:44.993

尝试：

```
var query = (from b in PHOTOS
             where b.RECORDID == selectedRecordId
             select b).FirstOrDefault; 
```

这将强制一个结果（或对象的默认值，通常为 Nothing，如果没有具有该 ID 的记录）。

**编辑：**

第二次尝试基于以下评论的解决方案，如果没有 IDE，我目前无法验证：

```
var query = (from b in PHOTOS
             select b).Where(p => p.RECORDID == selectedRecordId); 
```

我的理由是，将`where`子句移到初始查询之外可能会迫使它成为过滤器。

如果这不起作用，我唯一的另一个想法是查看修改 EF 架构以覆盖 PHOTOS 以强制它没有主键。

# codeigniter-2 - codeigniter 2.1.0 路由困难

> ID：10306241
> 
> 赞同：0
> 
> 时间：2012-04-24T21:27:10.937
> 
> 标签：codeigniter-2

我无法加载控制器

```
http://localhost/index.php?controller/method 
```

但如果我不使用“？” 并尝试从视图中加载控制器，然后生成重复的 URL。作为上面的示例，如果我在视图中的表单操作中添加此链接，则结果 url 将是

```
http://localhost/index.php/controller/index.php/controller/method 
```

如何解决？我没有使用 htaccess 文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T14:43:40.957

使用该`site_url()`功能，或者如@JohnFable 所述，使用该`form_open`功能。

```
<form method="post" action="<?= form_open('controller/method'); ?>"> 
```

或者

```
<a href="<?= site_url('controller/method'); ?>">Controller/Method</a> 
```

或者

```
<?= form_open('controller/method'); ?> 
```

这将确保您的“基本 url”，即`http://localhost`正确地添加到您要查看的 URL，即，`http://localhost/index.php/controller/method`或者如果您已将其设置为，`http://localhost/controller/method`

加文

# objective-c - 当 UIButton 在 UIScrollView 内时，为什么不调用 UIButton 操作

> ID：10306245
> 
> 赞同：3
> 
> 时间：2012-04-24T21:27:30.487
> 
> 标签：objective-c, uiscrollview, uibutton

我创建了一个类似面板的跳板，其中包含如下按钮：

```
-(void)configurePanel{

self.criteriaPanel.scrollEnabled=YES;
self.criteriaPanel=[[UIScrollView alloc] initWithFrame:CGRectMake(
                                                                0.0f, 
                                                                0.0f, 
                                                                [UIScreen mainScreen].bounds.size.width,
                                                                (BUTTON_HEIGHT+(3*BUTTON_Y_OFFSET))
                                                                )];

UIView *scrollViewContent=[[UIView alloc]init];
NSArray *criteriaTypeButtonTitles=[NSArray arrayWithObjects:
                                 @"Option1",
                                 @"Option2",
                                 @"Option3",
                                 @"Option4",
                                 @"Option5",
                                 @"Option6",
                                 nil
                                 ];

for (int i=0; i<[criteriaTypeButtonTitles count]; i++) {
  UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
  button.tag=i;
  button.frame = CGRectMake(
                          (((BUTTON_X_OFFSET*i)+(BUTTON_WIDTH*i))+BUTTON_X_OFFSET)
                          , BUTTON_Y_OFFSET
                          , BUTTON_WIDTH
                          , BUTTON_HEIGHT
                          );  
  [button setTitle:[criteriaTypeButtonTitles objectAtIndex:i] forState:UIControlStateNormal];
  [button setTitleColor:[UIColor blueColor] forState:UIControlStateHighlighted];
  button.titleLabel.font=[UIFont systemFontOfSize:13.0f];
  [button setBackgroundColor:[UIColor grayColor]];
  [button.layer setCornerRadius:10.0f];
  [button.layer setBorderWidth:1.0f];
  [button addTarget:self action:@selector(sortByButtonTap:) forControlEvents:UIControlEventTouchDown];
  [scrollViewContent addSubview:button];
}

//based upon # of buttons
self.criteriaPanel.contentSize=CGSizeMake(
                                        (([criteriaTypeButtonTitles count]*BUTTON_WIDTH)+([criteriaTypeButtonTitles count]*BUTTON_X_OFFSET)),
                                        (BUTTON_HEIGHT+(2*BUTTON_Y_OFFSET)));
[self.criteriaPanel addSubview:scrollViewContent];
[self.view addSubview:self.criteriaPanel];
} 
```

面板正确显示并滚动，但从未调用按钮的点击事件 (sortByButtonTap:)。我怀疑这与滚动视图中包含的视图中包含的按钮有关。在阅读了许多其他问题和文档之后，我仍然无法弄清楚解决方案应该是什么。

编辑：我尝试直接将按钮添加到 UIScrollView（self.criteriaPanel），并且按钮点击调用 sortByButtonTap：所以这是在 scrollViewContent 中的按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-30T12:23:57.377

我认为您的问题只是您`UIControlEvent`将`UIButton`. 从 更改`UIControlEventTouchDown`为`UIControlEventTouchUpInside`。如果您在`UIButton`内部连接 ​​a `Interface Builder`，它将始终将其设置为此`UIControlEvent`：

![在此处输入图像描述](../Images/e852ea1f6d5bd3703a19e56cafd6ff2e.png)

另一个原因：

否则，您将`UIScrollView`控制交互，因为它需要知道您是否要滚动它。如果你把它们`UIButtons`放在你的里面`UIScrollView`，它们将是可以访问的，但总是有一点延迟。这就是为什么您应该更改以下设置的原因`UIScrollView`：

您可以禁用`delays content touches`并且`UIButtons`可以立即访问

![在此处输入图像描述](../Images/14acc1b4d8e2838509d25c4c5f0781cb.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T13:24:20.650

如果你尝试：

```
[button setExclusiveTouch:YES]; 
```

当按钮位于同时处理触摸事件的视图中时，它们往往会异常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T21:31:16.317

您可能需要`userInteractionEnabled`在包含视图`scrollViewContent`上设置按钮以接收触摸事件：

```
[scrollViewContent setUserInteractionEnabled:YES]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T21:32:07.987

代替：

```
[button addTarget:self 
           action:@selector(sortByButtonTap:) 
 forControlEvents:UIControlEventTouchDown]; 
```

尝试：

```
[button addTarget:self 
           action:@selector(sortByButtonTap:) 
 forControlEvents:UIControlEventTouchUpInside]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-06T07:03:57.803

按照此代码进行查询，

在滚动视图中添加 UIButton

```
 scrollview.pagingEnabled = YES;
    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    button.frame = CGRectMake();
    [button setTitle:@"X" forState:UIControlStateNormal];
    [button setTitleColor:[UIColor clearColor] forState:UIControlStateNormal];
    [button addTarget:self action:@selector(btnCloseClicked:withEvent:) forControlEvents:UIControlEventTouchUpInside];
    [button addTarget:self action:@selector(btnCloseDraged:withEvent:) forControlEvents:UIControlEventTouchDragInside];
    [button addTarget:self action:@selector(btnCloseDragedEnd:withEvent:) forControlEvents:UIControlEventTouchDragExit];
    [scrollview addSubview:button];
    scrollview.userInteractionEnabled = YES; 
```

您可以手动放置这三种按钮的方法。

如果您仍有疑问，请告诉我。

# php - 为什么使用 objWriter->PHPEXCEL-save 后 Excel 设置的 My Existing Conditional Formatting Rules 会丢失？

> ID：10306247
> 
> 赞同：2
> 
> 时间：2012-04-24T21:27:41.197
> 
> 标签：php, phpexcel

我的问题是我在列中有一个已经存在的带有条件格式规则的 excel 文件，我阅读它并将其与下一句一起保存：

```
$objReader = new PHPExcel_Reader_Excel2007();

$objReader->setReadDataOnly(false);
$objPHPExcel = $objReader->load('../files/Reportes.xlsx');

//i set a value

$objPHPExcel->getActiveSheet()->SetCellValue('F6', 10);

$objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel);

$objWriter->save('../files/Reportes.xlsx'); 
```

输出文件是我的 Reportes.xlsx 文件，没有任何条件格式规则：S

我在一篇文章（2010 年的一篇文章）中读到这是一个错误，我使用的是 PHPEXCEL 的 1.7.6

请帮助我，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T01:49:55.950

当您保存文档时，任何`PHPExcel_Writer`不支持的内容都可能会被清除。

# maven - Sonar 3.0 不进行分析，但不显示错误/警告

> ID：10306251
> 
> 赞同：0
> 
> 时间：2012-04-24T21:27:51.827
> 
> 标签：maven, sonarqube

我使用 eclipse 和 m2e 进行开发，使用 maven 3.0.4 和 Sonar 3.0 进行分析。

在控制台上，我得到 mvn clean install 的“构建成功”和 mvn sonar:sonar 的“分析成功，您可以浏览...”。我不承认任何错误/警告等。

在声纳中，我可以看到我的项目、实际版本和构建日期，但没有分析。

声纳 3.0 是否有任何报告的问题，或者有人知道出了什么问题？

非常感谢。

pom.xml：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>DungeonMasterTools</groupId>
<artifactId>DungeonMasterTools</artifactId>
<version>0.0.1-SNAPSHOT</version>
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.3.2</version>
            <configuration>
                <verbose>true</verbose>
                <fork>true</fork>
                <executable>${JDK_1_7_HOME}/bin/javac</executable>
                <compilerArgument>-verbose</compilerArgument>
                <source>1.7</source>
                <target>1.7</target>
                <meminitial>128m</meminitial>
                <maxmem>512m</maxmem>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>sonar-maven-plugin</artifactId>
            <version>2.0</version>
        </plugin>
    </plugins>
</build>
<dependencies>
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.16</version>
    </dependency>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.10</version>
    </dependency>
    <dependency>
        <groupId>com.thoughtworks.xstream</groupId>
        <artifactId>xstream</artifactId>
        <version>1.4.2</version>
    </dependency>
</dependencies>
</project> 
```

# unix - 带 FUSE 的 Google 云端硬盘

> ID：10306252
> 
> 赞同：5
> 
> 时间：2012-04-24T21:27:53.160
> 
> 标签：unix, fuse, google-drive-api

是否可以使用带有 FUSE 的 Google Drive 在 unix 系统中构建文件系统？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-26T18:06:36.923

[https://github.com/jcline/fuse-google-drive](https://github.com/jcline/fuse-google-drive)

> fuse-google-drive 是在 GPLv2 下发布的 Google Drive 的 fuse 文件系统包装器
> 
> 目前处于 alpha 阶段。不要相信任何重要的事情......
> 
> 讨论：
> 
> *   irc.freenode.net 上的#fuse-google-drive
> 
> 用法：
> 
> 现在您需要访问[http://code.google.com/apis/console](http://code.google.com/apis/console)并创建一个新应用程序并为安装应用程序生成一个客户端 ID 和客户端密码。clientid 值和 clientsecrets 值应分别进入：
> 
> ```
> $XDG_CONFIG_HOME/fuse-google-drive/clientid
> $XDG_CONFIG_HOME/fuse-google-drive/clientsecrets 
> ```
> 
> 分别。你也应该`chmod 700 $XDG_CONFIG_HOME/fuse-google-drive`这样。如果该文件夹在运行时不存在，则会打印一条有用的消息，并尽可能使用正确的权限创建目录。注意：如果`$XDG_CONFIG_HOME`在您的系统上未设置，则默认为`~/.config/`.
> 
> ```
> $ mkdir mountpoint
> $ ./fuse-google-drive mountpoint 
> ```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-24T21:54:48.267

您可以使用[Google Documents List API](https://developers.google.com/google-apps/documents-list/)创建 Fuse 客户端。

# jsp - 在 jsp bean 中找不到符号错误

> ID：10306253
> 
> 赞同：1
> 
> 时间：2012-04-24T21:27:56.037
> 
> 标签：jsp, symbols

感谢您阅读此问题。

**下面的代码**

我正在尝试让 jsp 使用数据库。该数据库目前已部分填充，我正在尝试将此信息返回到我的浏览器并打印出来。

不幸的是，当我尝试这个时，我得到一个错误，说编译器在我尝试在 newjsp.jsp 中调用 getStudentList() 的行上找不到符号“studentData”。

我已经从朋友的项目中复制了 newjsp 中的代码，它工作正常。

我希望你能帮忙！

谢谢，

植物182

****** *** ** *** ** ***** StudentBean.java ***** ** *** *****

 **```
 package my.beans;

         public class StudentBean {

                 private String firstName;
                 private String lastName;
                 private String comment;
                 private String email;

                 public StudentBean(){

                 }

                 // get/set for First Name
                 public void setFirstName(String firstName) {
                         this.firstName = firstName;
                 }
                 public String getFirstName(){
                         return firstName;
                 }

                 // get/set for Last Name
                 public void setLastName(String lastName) {
                         this.lastName = lastName;
                 }
                 public String getLastName(){
                         return lastName;
                 }

                 // get/set for comment
                 public void setComment(String comment) {
                         this.comment = comment;
                 }
                 public String getComment(){
                         return comment;
                 }

                 // get/set for Email
                 public void setEmail(String email) {
                         this.email = email;
                 }
                 public String getEmail(){
                         return email;
                 }
         } 
```

***** ** ***** StudentDataBean.java ***** ** *** ******

```
 package my.beans;

         import java.sql.SQLException;
         import javax.sql.rowset.CachedRowSet;
         import java.util.ArrayList;
         import com.sun.rowset.CachedRowSetImpl; // CachedRowSet implementation

         public class StudentDataBean {

            private CachedRowSet rowSet;

            // construct TitlesBean object
            public StudentDataBean() throws Exception
            {
               // load the MySQL driver
               Class.forName( "com.mysql.jdbc.Driver" );

               // specify properties of CachedRowSet
               rowSet = new CachedRowSetImpl();
               rowSet.setUrl( "jdbc:mysql://localhost:3306/test" );
               rowSet.setUsername( "root" );
               rowSet.setPassword( "" );

                   // obtain list of titles
               rowSet.setCommand(
                  "SELECT firstName, lastName, email, comment FROM guests" );
               rowSet.execute();
            } // end StudentDataBean constructor

            // return an ArrayList of StudnetBeans
            public ArrayList<StudentBean> getStudentList() throws SQLException
            {
               ArrayList<StudentBean> studentList = new ArrayList<StudentBean>();

               rowSet.beforeFirst(); // move cursor before the first row

               // get row data
               while ( rowSet.next() )
               {
                  StudentBean student = new StudentBean();

                  student.setFirstName( rowSet.getString( 1 ) );
                  student.setLastName( rowSet.getString( 2 ) );
                  student.setEmail( rowSet.getString( 3 ) );
                  student.setComment( rowSet.getString( 4 ) );
                  studentList.add( student );
               } // end while

               return studentList;
            } // end method getStudentList

            // insert a Student in student database
         public void addStudent( StudentBean student ) throws SQLException
         {
         rowSet.moveToInsertRow(); // move cursor to the insert row

          // update the three columns of the insert row
         rowSet.updateString( 1, student.getFirstName() );
         rowSet.updateString( 2, student.getLastName() );
         rowSet.updateString( 3, student.getEmail() );
         rowSet.updateString( 4, student.getComment() );
         rowSet.insertRow(); // insert row to rowSet
         rowSet.moveToCurrentRow(); // move cursor to the current row
         rowSet.acceptChanges(); // propagate changes to database
         } // end method addStudent
    } // end class StudentDataBean 
```

****** *** ** ***** newjsp.jsp ***** ** *** ** *** ** *** *****

 **```
 <%@page import="java.util.ArrayList"%>
   <%@page contentType="text/html" pageEncoding="UTF-8"%>
   <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">

   <%@ page import="java.util.*" %>
   <%@ page import="my.beans.StudentDataBean"%>
   <%@ page import="my.beans.StudentBean"%>
   <jsp:useBean id="studentData" scope="request" class="my.beans.StudentDataBean"/>
   <html>
     <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
         <title>Words View</title>
           <style type="text/css">
           table, tr, td, th
           {
                text-algn: center;
                font-size: .9em;
                border: 3px groove;
                padding: 3px;
                background-color: #eee9e9;
           }
     </style>
     </head>
     <body>
     <h1>Student List</h1>
     <table border="1">
        <tr>
            <th>
                <h4>Email</h4>
            </th>
            </tr>
                <%
                    ArrayList<StudentBean> studentList = studentData.getStudentList();
                    Iterator studentListIterator = studentList.iterator();
                    StudentBean student;

                    while (studentListIterator.hasNext()){
                        student = (StudentBean) studentListIterator.next();
                %>
            <tr>
                <td><%= student.getEmail()%></td>

            </tr>
            <% }
            %>
     </table>
     </body>
     </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:32:48.410

可能是ide错误，重启netbeans。（如果你使用的是 netbeans……否则天知道。）爱汤姆 xx****

# php - 是否可以阻止使用 Javascript 或 PHP 设置 cookie？

> ID：10306254
> 
> 赞同：21
> 
> 时间：2012-04-24T21:28:03.477
> 
> 标签：php, javascript, cookies, blocking

很多人可能都知道新的欧盟隐私法，但对于那些不知道的人来说，这基本上意味着欧盟居民公司运营的任何网站都不能设置归类为“对网站运营非必要”的 cookie在访客机器上，除非得到明确许可。

那么，问题就变成了如何最好地处理这个问题？

浏览器显然有能力阻止来自内置于它们的特定网站的 cookie。我的问题是，有没有办法使用 JS 或 PHP 做类似的事情？

即拦截可能试图设置的任何 cookie（包括分析或 Facebook 等第 3 方 cookie），并阻止它们，除非用户同意。

显然，一旦设置了所有 cookie，就可以删除它们，但是尽管这与一开始就不允许设置它们是一样的，但我猜在这种情况下它还不够好，因为它没有遵守法律条文。

想法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-31T07:12:59.560

我也对这个答案很感兴趣。我已经完成了我需要在 PHP 中完成的工作，但是 JavaScript 组件仍然让我望而却步。

这是我在 PHP 中的做法：

```
$dirty = false;
foreach(headers_list() as $header) {
    if($dirty) continue; // I already know it needs to be cleaned
    if(preg_match('/Set-Cookie/',$header)) $dirty = true;
}
if($dirty) {
    $phpversion = explode('.',phpversion());
    if($phpversion[1] >= 3) {
        header_remove('Set-Cookie'); // php 5.3
    } else {
        header('Set-Cookie:'); // php 5.2
    }        
} 
```

然后我有一些额外的代码可以在用户接受 cookie 时将其关闭。

问题是我的网站中使用了第三方插件，它们通过 javascript 操作 cookie，并且没有扫描它们以确定哪些访问 document.cookie - 他们仍然可以设置 cookie。

如果他们都使用相同的框架会很方便，所以我可能能够覆盖 setCookie 函数 - 但他们没有。

如果我可以删除或禁用 document.cookie 以使其无法访问，那就太好了...

编辑：可以防止 javascript 访问获取或设置 cookie。

```
document.__defineGetter__("cookie", function() { return '';} );
document.__defineSetter__("cookie", function() {} ); 
```

编辑 2：为此在 IE 中工作：

```
if(!document.__defineGetter__) {
    Object.defineProperty(document, 'cookie', {
        get: function(){return ''},
        set: function(){return true},
    });
} else {
    document.__defineGetter__("cookie", function() { return '';} );
    document.__defineSetter__("cookie", function() {} );
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-08T17:26:14.263

我从这里改编了迈克尔斯的代码来提出这个问题。

基本上它使用`defineGetter`and`defineSetter`方法设置页面上的所有 cookie，然后删除用户指定的 cookie，如果这是您的目标，这个角色当然也可以反转。

我已经使用第三方 cookie（例如 Google Analytics）对此进行了测试，它似乎运行良好（不包括`__utmb`cookie 意味着我不再在 Google Analytics 中被选中），也许您可​​以使用它并使其适应您的特定需求。

我已经包含了关于如果 cookie 名称不`__utmb`供您参考的部分，尽管您可以轻松地从数组中获取这些值并以这种方式循环这些值。

基本上，此功能将包括所有 cookie，除了在声明部分中指定的那些`if( cookie_name.trim() != '__utmb' ) { all_cookies = all_cookies + cookies[i] + ";"; }`

您可以使用 OR 或 AND 过滤器添加此内容，或从数组、数据库、用户输入或任何您喜欢排除特定内容的内容中提取（用于确定必要和非必要 cookie）。

```
function deleteSpecificCookies() {

var cookies = document.cookie.split(";");
var all_cookies = '';

    for (var i = 0; i < cookies.length; i++) {

        var cookie_name  = cookies[i].split("=")[0];
        var cookie_value = cookies[i].split("=")[1];

        if( cookie_name.trim() != '__utmb' ) { all_cookies = all_cookies + cookies[i] + ";"; }

    }

if(!document.__defineGetter__) {

    Object.defineProperty(document, 'cookie', {
        get: function(){return all_cookies; },
        set: function(){return true},
    });

} else {

    document.__defineGetter__("cookie", function() { return all_cookies; } );
    document.__defineSetter__("cookie", function() { return true; } );

}

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T21:38:24.243

您不能完全禁用它，但您可以使用覆盖默认设置`.htaccess`

尝试

```
 SetEnv session.use_cookies='0'; 
```

如果它对某些用户是可选的，请不要使用`.htaccess`

```
if(!$isAuth)
{
    ini_set('session.use_cookies', '0');
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-10-08T16:38:09.807

有点老了，但我认为你应该得到一个有效的答案：

第一步：不要执行第三方脚本代码。

第 2 步：显示 cookie 横幅。

第三步：等到用户接受，现在就可以执行第三方脚本代码了。

为我工作。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-04-24T21:31:24.043

[不注意恶作剧](http://www.brilliantthinking.net/2012/03/12/new-eu-privacy-law-email-cookies/)怎么样？

除了这是旧消息这一事实之外，文本清楚地表明它仅适用于**对网站功能**不重要的 cookie 。这意味着会话 cookie、购物篮或与使网站正常运行直接相关的任何东西都非常好。未经许可，“不允许”任何其他内容（跟踪、统计信息等）。

# jsf-2 - 子文件夹中的 JSF 页面看不到模板

> ID：10306261
> 
> 赞同：1
> 
> 时间：2012-04-24T21:28:30.570
> 
> 标签：jsf-2

我在 WEB-INF/templates/standardTemplate.xhtml 中有一个模板

在我的“网页”根目录中，我有一个 index.xhtml，它通过以下方式使用模板

```
<ui:composition template="/WEB-INF/templates/standardTemplate.xhtml"> 
```

以上工作正常。

但是，我还有另一个使用相同模板的页面，但它位于子文件夹“Web Pages”/messageboard/list.xhtml

它使用完全相同的语法/路径：

```
<ui:composition template="/WEB-INF/templates/standardTemplate.xhtml"> 
```

但它找不到模板，只呈现 list.xhtml 的内容（没有模板的内容）。

Faces servlet 映射到“/faces/*”

我究竟做错了什么？尝试了我能想到的所有变体，但我无法获得正确的语法。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:48:31.167

根据评论，您`<ui:composition>`在 HTML 输出中看到未解析的内容。

这只能意味着您在浏览器地址栏中的请求 URL 与`FacesServlet`. 确保它与`FacesServlet`. 您已将其映射到`/faces/*`，因此 URL 应`/faces`在上下文路径之后包含路径前缀。

更好的是`FacesServlet`直接映射，`*.xhtml`这样您就不需要摆弄虚拟 URL。

# java - java，“输入程序参数”错误？

> ID：10306264
> 
> 赞同：-2
> 
> 时间：2012-04-24T21:28:48.097
> 
> 标签：java, compilation

我对java编程相当陌生。下面我有我的程序和不断出现的错误。我不知道这是什么意思，如果有人可以帮助我。我正在使用深红色编辑器，当一个窗口询问我“输入程序参数”出现此错误时，我的程序编译得很好。如果有人可以向我解释它的含义。谢谢你。// 我的程序

```
package test.rim.bbapps.testcase.lib;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class michaeltictactoe2 implements ActionListener {

    /* Instance variables */

    private JFrame window = new JFrame (" TicTacToe");
    private JButton button1 = new JButton ("") ;
    private JButton button2 = new JButton ("") ;
    private JButton button3 = new JButton ("") ;
    private JButton button4 = new JButton ("") ;
    private JButton button5 = new JButton ("") ;
    private JButton button6 = new JButton ("") ;
    private JButton button7 = new JButton ("") ;
    private JButton button8 = new JButton ("") ;
    private JButton button9 = new JButton ("") ;
    private String letter = "";
    private int count = 0; 
    private boolean win = false; 

    public michaeltictactoe2 () {
        //* Create Window * /
        window.setSize (300,300);
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        window.setLayout ( new GridLayout (3, 3));

        /* Adding buttons to the window*/
        window.add(button1);
        window.add(button2);
        window.add(button3);
        window.add(button4);
        window.add(button5);
        window.add(button6);
        window.add(button7);
        window.add(button8);
        window.add(button9);

        /* Add the action listener to the Button */
        button1.addActionListener(this);
        button2.addActionListener(this);
        button3.addActionListener(this);
        button4.addActionListener(this);
        button5.addActionListener(this);
        button6.addActionListener(this);
        button7.addActionListener(this);
        button8.addActionListener(this);
        button9.addActionListener(this);

        //* make the window visible * /
        window.setVisible (true) ;
    }

    public void actionPerformed (ActionEvent a) {
        count++;

        /* Calculate who's turn it is */
        if (count == 1 || count == 3|| count == 5 || count == 7 || count == 9) {
            letter = "X"; 
        } else if ( count == 2 || count == 4 || count  == 6 || count == 8  ) {
            letter = "O";   
        }

        /* Display X's or O's on the buttons */
        if ( a.getSource () == button1) {
            button1.setText ( letter ) ;
            button1.setEnabled (false);
        } else if (a.getSource () == button2) {
            button2.setText(letter);
            button2.setEnabled(false); 
        } else if (a.getSource () == button3) {
            button3.setText(letter);
            button3.setEnabled(false); 
        } else if (a.getSource () == button4) {
            button4.setText(letter);
            button4.setEnabled(false); 
        } else if (a.getSource () == button5) {
            button5.setText(letter);
            button5.setEnabled(false); 
        } else if (a.getSource () == button6) {
            button6.setText(letter);
            button6.setEnabled(false); 
        } else if (a.getSource () == button7) {
            button7.setText(letter);
            button7.setEnabled(false); 
        } else if (a.getSource () == button8) {
            button8.setText(letter);
            button8.setEnabled(false); 
        } else if (a.getSource () == button9) {
            button9.setText(letter);
            button9.setEnabled(false);
        }

        // * Determine who won */
        // horizontal wins
        if ( button1.getText () == button2.getText ()
            && button2.getText () == button3.getText ()
            && button1.getText () != "") {

            win = true;

        } else if ( button4.getText () == button5.getText ()
                    && button5.getText () == button6.getText ()
                    && button4.getText () != "") {
            win = true;

        } else if ( button7.getText () == button8.getText ()
                &&    button8.getText () == button9.getText ()
                &&    button7.getText () != "") {
                win = true;

            // Verticle wins 
        } else if (button1.getText() == button4.getText ()
               && button4.getText() == button7.getText ()
               && button1.getText() != "") {
               win = true; 

        } else if (button2.getText() == button5.getText()
                &&  button5.getText() == button8.getText()
                &&  button2.getText() != "") {
               win = true;
        } else if ( button3.getText() == button6.getText()
                &&   button6.getText() == button9.getText()
                &&   button9.getText() != "") {
               win = true ;

        // Diagonal wins 
        } else if (button1.getText() == button5.getText()
                && button5.getText() == button9.getText()
                && button1.getText() != "") {
                win = true; 

         } else if (button3.getText() == button5.getText()
                 && button5.getText() == button7.getText()
                 && button3.getText() != "") {
                win = true;
         } else {
                win = false ;
         }

        /* show a dialog is someone wins or the game is tie*/
        if ( win == true) {
            JOptionPane.showMessageDialog(null, letter + " YOU WIN!");
        } else if (count == 9 && win == false) {
            JOptionPane.showMessageDialog ( null , " Tie Game!" ) ;  
        }
    }

    public static void main (String [] args) {
        new michaeltictactoe2 () ;
    }
} 
```

错误：

```
---------- Capture Output ----------
> "C:\Program Files\Java\jdk1.6.0_22\bin\java.exe" michaeltictactoe1
java.lang.NoClassDefFoundError: michaeltictactoe1 (wrong name: test/rim/bbapps/testcase/lib/michaeltictactoe1)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:632)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:616)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:248)
Could not find the main class: michaeltictactoe1\.  Program will exit.
Exception in thread "main" 
> Terminated with exit code 1. 
```

再次感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:31:56.800

您正在编译 michaeltictactoe1 并且类名是 michaeltictactoe2

编译

```
javac michaeltictactoe2.java 
```

然后运行

```
java michaeltictactoe2 
```

阅读[http://www.oracle.com/technetwork/java/compile-136656.html](http://www.oracle.com/technetwork/java/compile-136656.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:31:22.160

看起来类名与文件名不匹配（michaeltictactoe1 vs. michaeltictactoe2）

# gcc - GCC 编译器标志：-lg2c -lgfortran

> ID：10306267
> 
> 赞同：1
> 
> 时间：2012-04-24T21:29:01.507
> 
> 标签：gcc, compiler-construction

有没有人有关于 GCC 标志的任何信息：-lg2c 或 -lgfortran？我在网上找不到任何文档，我对这些命令的作用很感兴趣。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-23T12:42:14.393

-lg2c 适用于 g77

-lgfortran 用于 gfortran（如果 gcc 晚于 4.0）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T21:33:52.763

`-lXYZ`指定 GCC 应该链接到一个名为`libXYZ`.

请参阅[http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html#Link-Options](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html#Link-Options)。

# php - APACHE 崩溃：父进程：子进程以状态 3221225477 退出 -- 正在重新启动

> ID：10306272
> 
> 赞同：17
> 
> 时间：2012-04-24T21:29:14.510
> 
> 标签：php, mysql, apache, xampp

我的以下设置是 Xampp 1.7.7，这是该软件包中所有内容的信息：- Apache/2.2.21 (Win32) mod_ssl/2.2.21 OpenSSL/1.0.0e PHP/5.3.8 mod_perl/2.0.4 Perl/ v5.10.1

我在 Windows XP SP3 32 位操作系统、4 gigs 内存、四核上运行服务器。

我在 apache 错误日志文件中遇到的问题是：

```
[Tue Apr 24 15:55:55 2012] [notice] Parent: child process exited with status 3221225477 -- Restarting.
[Tue Apr 24 15:55:57 2012] [notice] Digest: generating secret for digest authentication ...
[Tue Apr 24 15:55:57 2012] [notice] Digest: done
[Tue Apr 24 15:55:59 2012] [notice] Apache/2.2.21 (Win32) mod_ssl/2.2.21 OpenSSL/1.0.0e PHP/5.3.8 mod_perl/2.0.4 Perl/v5.10.1 configured -- resuming normal operations
[Tue Apr 24 15:55:59 2012] [notice] Server built: Sep 10 2011 11:34:11
[Tue Apr 24 15:55:59 2012] [notice] Parent: Created child process 776
[Tue Apr 24 15:56:00 2012] [notice] Disabled use of AcceptEx() WinSock2 API
[Tue Apr 24 15:56:01 2012] [notice] Digest: generating secret for digest authentication ...
[Tue Apr 24 15:56:01 2012] [notice] Digest: done
[Tue Apr 24 15:56:02 2012] [notice] Child 776: Child process is running
[Tue Apr 24 15:56:02 2012] [notice] Child 776: Acquired the start mutex.
[Tue Apr 24 15:56:02 2012] [notice] Child 776: Starting 350 worker threads.
[Tue Apr 24 15:56:02 2012] [notice] Child 776: Listening on port 443.
[Tue Apr 24 15:56:02 2012] [notice] Child 776: Listening on port 80. 
```

这似乎在一天中偶尔发生，我什至尝试在 apache conf 文件中使用 Win32DisableEx、EnableIMAP Off 和 EnableSendFile Off。我还尝试将 libmysql.dll 文件复制到 system32 和 apache/bin 文件夹，但无济于事。

如果有人知道子进程退出并导致 apache 崩溃的其他原因，我们将不胜感激。如果需要任何其他日志文件，请告诉我。

谢恩，谢恩。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-24T22:33:24.430

错误代码`3221225477`是`0xC0000005`十六进制的，在 Windows 上是：

```
#define STATUS_ACCESS_VIOLATION  ((NTSTATUS)0xC0000005L) 
```

访问冲突是Windows版本的“分段错误”，简单地说就是程序试图访问未分配的内存。这可能由于许多不同的原因而发生，但大多数（如果不是总是）是程序中的错误。

现在，我对您的情况的猜测是，PHP 或 PHP 的扩展之一或 Perl 或某些 Perl 应用程序中存在错误。Apache 本身通常非常稳定，但如果您使用一些不寻常的扩展，也可能是原因。

我建议将您的所有配置更新到最新版本。如果您想确定问题的根源，请在调试器（如 Visual Studio 或 OllyDbg）中运行 Apache。当异常（访问冲突）发生时，它将停止执行（而不是重新启动），您将看到它在哪个模块中。

还要查看访问日志，是否存在与错误时间戳相同的*可疑请求。*但是在请求保存到日志文件之前可能会发生崩溃。

# vb.net - 用于在 Telerik 网格上添加数据和编辑数据的不同模板

> ID：10306277
> 
> 赞同：0
> 
> 时间：2012-04-24T21:30:06.543
> 
> 标签：vb.net, telerik, telerik-grid

我正在尝试将不同的模板传递给 Telerik Grid，具体取决于是否按下了添加按钮或编辑按钮（创建时：要填充几个字段。现有：添加按钮：要填充的一些额外字段，编辑按钮：大多数字段是只读的，要填写新字段）。

```
Dim myGrid = Html.Telerik().Grid(Of SomeModel) _
.Name("myGrid")

    If Model.Action = AddNewData Then
        myGrid.Editable(Sub(editing) _  
        editing.Enabled(True).Mode(GridEditMode.PopUp).DisplayDeleteConfirmation(False) _
        .TemplateName("AddTemplate"))

    ElseIf Model.Action = EditOldData Then
      if "gridBoutonPushed = Add" then
        grille.Editable(Sub(editing) _
        editing.Enabled(True).Mode(GridEditMode.PopUp).DisplayDeleteConfirmation(False) _
        .TemplateName("EditTemplateNew"))
      else 'edit button was pushed
        grille.Editable(Sub(editing) _
        editing.Enabled(True).Mode(GridEditMode.PopUp).DisplayDeleteConfirmation(False) _
        .TemplateName("EditTemplateOld"))
      end if
    End If

'generate the add button
myGrid.ToolBar(Sub(c) c.Template(" <a href='#' class='t-button t-button-icontext t-grid-add'>" &
                    "<span style='margin-left: 0pt;' class='t-icon t-add'></span>Add stuff</a>")) 
```

我不知道如何做这`if "gridBoutonPushed = Add" then`部分。有什么建议么？
...我也愿意以其他方式处理这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T21:11:46.467

我有一个类似的问题，并想出了一个使用 javascript 和 Telerik 的动作处理程序的解决方法首先我将它添加到 Grid 的属性集中：

```
.ClientEvents(Function(events) events.OnEdit("onEditUsers")) 
```

它将处理程序指向此函数，然后在网格代码之外：

```
<script type="text/javascript">
function onEditUsers(e) {

           var popup = $("#" + e.currentTarget.id + "PopUp");
           var popupDataWin = popup.data("tWindow");

           if (e.mode == "insert") {
               //for creating
               popupDataWin.title("Add new User");

           }
           else {
               //for editing
               popupDataWin.title("Edit Customer");

               // Hide fields from the pop-up.
               $(e.form).find("#UnwantedField1").closest(".editor-field").prev().andSelf().hide();
               $(e.form).find("#UnwantedField2").closest(".editor-field").prev().andSelf().hide();
           }
       }
   </script> 
```

您可以修改这些函数以使字段按您的需要运行

不幸的是，这要求您的模板全部存在于一个文件中，并且需要您定义哪些字段针对每个不同的事件以哪种方式运行

我希望这有帮助！

# javascript - 第二个 JS 按钮触发第一个 JS 按钮

> ID：10306290
> 
> 赞同：0
> 
> 时间：2012-04-24T21:31:12.243
> 
> 标签：javascript, html, onmouseover, onmouseout

我知道我必须做错事，但我还是不完全理解我在做什么。我正在创建一个表单，它将有多个链接到 JavaScript 函数的按钮来做事。我的基本点是将这两个按钮放在同一页面上，当您 onMouseOver、onMouseDown、onMouseUp、onMouseOut 时，它会更改我的按钮的图像。

我知道还有其他方法可以做到这一点（更好的方法），但我正朝着这个方向努力，至少可以更好地理解 JavaScript 的工作原理。我知道我会在路上做一些更复杂的事情，可能需要这样的事情，我想确保当我到达那里时我理解它。

我遇到的问题是，当您尝试使用第二个按钮时，它没有任何作用。第一个按钮工作正常，但第二个按钮不行 当你尝试使用第二个按钮时，它会使第一个按钮熄灭。因此，如果我 onMouseOver 按钮 2，按钮 1 将显示效果。我尝试将我的图像文件复制到一个新集合中，这样它们就不会使用相同的图像，但这只是向我展示了当我使用按钮 2 时，为按钮 2 设置的功能正在应用于按钮 1。

无论如何，这是HTML代码....

```
<input type="hidden"  value="0" id="theValue"  /> 
<p><a  href="javascript:addElement()"  ><img id="button" onMouseOver="hover_over()"
onMouseOut="hover_off()"  onMouseDown="click_add()" onMouseUp="release()"   
src="images/add_default.png" name="add" width="43" height="21"></a></p>

<input type="hidden"  value="0" id="theValue2"  /> 
<p><a href="javascript:addProduct()"  ><img id="button2"  
onMouseOver="hover_over_second()" onMouseOut="hover_off_second()" 
onMouseDown="click_add_second()" onMouseUp="release_second()"  
src="images/add_default2.png" name="add2" width="43" height="21"></a></p> 
```

这里是 JavaScript....

```
////
//----------------Button Animation 1-------------------
////

function hover_off() {
document.images.add.src='images/add_default.png';   
}

function hover_over() {
document.images.add.src='images/add_hover.png';
}

function click_add() {
document.images.add.src='images/add_click.png';
}

function release() {
document.images.add.src='images/add_hover.png';
}
////
//---------------------------------------------------
////

////
//----------------Button Animation 2-------------------
////
function hover_off_second() {
document.images.add.src='images/add_default2.png';

}
function hover_over_second() {
document.images.add.src='images/add_hover2.png';
}
function click_add_second() {
document.images.add.src='images/add_click2.png';
}
function release_second() {
document.images.add.src='images/add_hover2.png';
}
////
//---------------------------------------------------
//// 
```

我在这里做错了什么？如何让这些链接真正彼此分开工作？

请教我聪明的人。我知道这一定很愚蠢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T21:38:44.597

您在第二个按钮处理程序中定位相同的元素，它应该是 add2 而不是像第一个那样添加，这就是为什么第一个元素 src 属性被更改而不是另一个。

```
function hover_off_second() {
document.images.add2.src='images/add_default2.png';
}
function hover_over_second() {
document.images.add2.src='images/add_hover2.png';
}
function click_add_second() {
document.images.add2.src='images/add_click2.png';
}
function release_second() {
document.images.add2.src='images/add_hover2.png';
} 
```

# iphone - 排序 UITableView 结果

> ID：10306302
> 
> 赞同：0
> 
> 时间：2012-04-24T21:32:22.570
> 
> 标签：iphone, objective-c, xcode

所以这是我的设置。我有一个名为 RadioStations 的对象，其中有几个字符串，如呼号、声明的频率和一个名为 amStationInfo 的 NSMutableArray。在我的视图控制器上，我访问了一个 SQLite 数据库，该数据库像这样填充数组......

RadioStations.h

```
@interface RadioStations : NSObject {

    NSString *format;
    NSString *city;
}

@property (nonatomic, retain) NSString *format;
@property (nonatomic, retain) NSString *city; 
```

视图控制器.m

```
NSMutableArray* amStationInfo = [[NSMutableArray alloc] init];

    while (sqlite3_step(statement) == SQLITE_ROW)
    {
        NSString *cityField = [[NSString alloc] initWithUTF8String:
                               (const char *) sqlite3_column_text(statement, 10)];
        NSString *formatField = [[NSString alloc] initWithUTF8String:
                                (const char *) sqlite3_column_text(statement, 0)];
        RadioStations *amStationClass = [[RadioStations alloc] init];            
                [amStationClass setCity:cityField];
                [amStationClass setFormat:formatField];
                [amStationInfo addObject:amStationClass];
    }
[tabView reloadData];
sqlite3_finalize(statement); 
```

然后我填充一个 UITableView

```
NSString *cityValue = [(RadioStations *)[amStationInfo objectAtIndex:indexPath.row] city];
NSString *formatValue = [(RadioStations *)[amStationInfo objectAtIndex:indexPath.row] format];
cityLabel.text = cityValue;
formatLabel.text = formatValue; 
```

我希望能够根据城市（字母）或格式（数字）以及两者、城市和格式对 UITable 结果进行排序。我知道格式是 NSString，假设我已经得到了它的 doubleValue。我想要这样的结果......

城市（按字母顺序） 1) 洛杉矶 - 5.0 2) 旧金山 - 3.0 3) 圣何塞 - 10.0 4) 圣何塞 - 2.0 5) 圣何塞 - 4.0

格式（数字） 1) 圣何塞 - 2.0 2) 旧金山 - 3.0 3) 圣何塞 - 4.0 4) 洛杉矶 - 5.0 5) 圣何塞 - 10.0

两者（城市然后格式） 1) 洛杉矶 - 5.0 2) 旧金山 - 3.0 3) 圣何塞 - 2.0 4) 圣何塞 - 4.0 5) 圣何塞 - 10

我有一种方法可以像这样对格式进行排序......在 RadioStations.m

```
- (NSComparisonResult)sortByFormat:(id)anObject
{
    if (self.format < anObject.format) {
        return NSOrderedAscending;
    } else if (self.format > anObject.format) {
        return NSOrderedDescending;
    }
    return NSOrderedSame;
} 
```

但我在'_strong id'类型的对象上找不到“属性'格式'，它突出显示了anObject.format

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:52:36.523

为什么不传入 RadioStation 而不是 id？也许我错过了一些东西，但我认为这就是你需要做的一切......

```
 - (NSComparisonResult)sortByFormat:(RadioStation *)anObject
{
if (self.format < anObject.format) {
    return NSOrderedAscending;
} else if (self.format > anObject.format) {
    return NSOrderedDescending;
}
return NSOrderedSame; 
```

}

# c# - DirectoryInfo.GetFileSystemInfos 和文件重命名

> ID：10306304
> 
> 赞同：0
> 
> 时间：2012-04-24T21:32:38.480
> 
> 标签：c#, asp.net-mvc-3, file-io, file-rename

重命名图像然后重新显示它们时，我似乎遇到了时间问题。在我的代码中，我使用 System.IO.File.Move 两次重命名目录中的一些图像。然后稍后我尝试检索目录中的文件列表，但是当我这样做时，我得到了一些在第一次重命名后存在的文件名，以及在第二次重命名后存在的一些文件名。如何确保仅获得第二次重命名后存在的文件名？我曾考虑放入一个 Thread.Sleep()，但这感觉就像一个 hack。如果有帮助，我正在使用 MVC3。

```
public ActionResult UpdateImages ()
{
   foreach (file in directory)
      System.IO.File.Move("oldname", "newname");
   foreach (file in directory)
      System.IO.File.Move("oldname", "newname");
   return RedirectToAction("Images", "Manager", new { id = Id });
}

public ViewResult Images(int id)
{
   var di = new DirectoryInfo(Server.MapPath("something")));
   var files = di.GetFileSystemInfos("*-glr.jpg");
   var orderedFiles = files.OrderBy(f => f.Name);
   var images = new List<string>();
   images.AddRange(orderedFiles.Select(fileSystemInfo => fileSystemInfo.Name));
   ViewData["Images"] = images;
   return View();
} 
```

*编辑*

我希望我可以删除我自己的问题。看来我已经解决了这个问题，答案甚至与我在问题中提供的信息无关。

看来我最终将 Get 和 Post 都发送到了服务器。The Post 开始了这项工作，但由于 Get 也被解雇了，因此帖子的响应被中止。由于 Get 快速完成，它将使系统处于中间状态。

有问题的代码行是一个锚元素，它同时附加了一个 href 和一个 javascript 点击处理程序（通过 jQuery）。

# django - Django DateTimePicker 仅显示给我的应用程序中的超级用户

> ID：10306306
> 
> 赞同：0
> 
> 时间：2012-04-24T21:32:44.357
> 
> 标签：django, django-forms, django-admin, datetimepicker, django-widget

我正在使用 django DateTimePicker 小部件 - AdminSplitDateTime() - 在事件创建应用程序中，当登录用户具有超级用户权限时，一切都很好，但是当普通用户尝试访问创建表单时，小部件不会显示。

我不知道为什么会这样？以及如何克服这种行为？

这是我页面中包含的脚本

```
<script type="text/javascript" src="/admin/jsi18n/"></script>
<script type="text/javascript" src="/static/admin/js/core.js"></script>
<script type="text/javascript" src="/static/admin/js/admin/RelatedObjectLookups.js"></script>
<script type="text/javascript" src="/static/admin/js/jquery.min.js"></script>
<script type="text/javascript" src="/static/admin/js/jquery.init.js"></script>
<script type="text/javascript" src="/static/admin/js/actions.min.js"></script>
<script type="text/javascript" src="/static/admin/js/calendar.js"></script>
<script type="text/javascript" src="/static/admin/js/admin/DateTimeShortcuts.js"></script> 
```

她是我的表单代码

```
class Form(ModelForm):
    """

    """

    class Meta:
        model = Model
        exclude = ('creator')
    def __init__(self, *args, **kwargs):
        super(Form, self).__init__(*args, **kwargs)
        self.fields['start'].widget = widgets.AdminSplitDateTime()
        self.fields['end'].widget = widgets.AdminSplitDateTime() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T04:24:29.020

我猜`/admin/jsi18n/`非员工用户无法访问。您应该在第一个小部件之前添加一个 JS 脚本并在那里定义一些变量：

```
var catalog = {}
function pluralidx(count) { return (count == 1) ? 0 : 1; }
function gettext(msgid) { return msgid; }
function ngettext(singular, plural, count) { return count == 1 ? singular : plural; }
function gettext_noop(msgid) { return msgid; }
function interpolate(fmt, obj, named) {
  if (named) {
    return fmt.replace(/%\(\w+\)s/g, function(match){return String(obj[match.slice(2,-2)])});
  } else {
    return fmt.replace(/%s/g, function(match){return String(obj.shift())});
  }
} 
```

这些取自 django 的`/admin/jsi18n/`admin 用户。

PS 您可以在浏览器的 JS 控制台中找到 JS 错误，它可能会给您指明方向。

# javascript - 在单个页面上使用此 .js 2 次时，它仅适用于一个实例

> ID：10306310
> 
> 赞同：0
> 
> 时间：2012-04-24T21:33:02.723
> 
> 标签：javascript

此脚本在文本区域上方创建菜单选项卡。该脚本在一个页面上只使用一次时有效，但是我需要在一个页面上使用它两次，以创建 2 个文本区域，每个区域上方都有一个菜单。一旦我使用它两次，只有一个实例可以工作。有什么建议么。

```
window.onload=function() {

  // get tab container
  var container = document.getElementById("tabContainer");
    // set current tab
    var navitem = container.querySelector(".tabs ul li");
    //store which tab we are on
    var ident = navitem.id.split("_")[1];
    navitem.parentNode.setAttribute("data-current",ident);
    //set current tab with class of activetabheader
    navitem.setAttribute("class","tabActiveHeader");

    //hide two tab contents we don't need
    var pages = container.querySelectorAll(".tabpage");
    for (var i = 1; i < pages.length; i++) {
      pages[i].style.display="none";
    }

    //this adds click event to tabs
    var tabs = container.querySelectorAll(".tabs ul li");
    for (var i = 0; i < tabs.length; i++) {
      tabs[i].onclick=displayPage;
    }
}

// on click of one of tabs
function displayPage() {
  var current = this.parentNode.getAttribute("data-current");
  //remove class of activetabheader and hide old contents
  document.getElementById("tabHeader_" + current).removeAttribute("class");
  document.getElementById("tabpage_" + current).style.display="none";

  var ident = this.id.split("_")[1];
  //add class of activetabheader to new active tab and show contents
  this.setAttribute("class","tabActiveHeader");
  document.getElementById("tabpage_" + ident).style.display="block";
  this.parentNode.setAttribute("data-current",ident);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:01:10.590

还没有找到解决方案，但仅供参考，您最初将其标记为 jQuery，如果它是 jquery，您可以轻松地打破该代码的几行并将其编写为简单：（取决于版本）

```
function displayPage(e) {
    var current = $(this).parent().attr("data-current");
    $("#tabHeader_" + current).removeClass("tabActiveHeader")
    $("#tabpage_" + current).hide();

    var ident = this.id.split("_")[1];
    $(this).addClass("tabActiveHeader");
    $("#tabpage_" + ident).show();
    $(this).parent().attr({ 'data-current': ident })
}
$(function() {
    var container = $("#tabContainer"),
        navitem = container.find((".tabs ul li")).first(),
        ident = navitem[0].id.split("_")[1];
    navitem.addClass("tabActiveHeader").parent().attr({ 'data-current': ident });

    $(".tabpage").filter(function(i) { return i>0; }).hide();
    // OR
    // $(".tabpage:not(:first-child)").hide();

    $(".tabs ul li").on("click", displayPage)
});​ 
```

## [请参阅此 jsFiddle 中上一个 jQUERY 的工作示例](http://jsfiddle.net/SpYk3/GkrVc/)

另外，你看过[jQueryUI.Tabs](http://jqueryui.com/demos/tabs/)吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:44:30.353

使用以下代码为同一对象上的同一事件注册任意数量的事件处理程序，而不是硬设置`window.onload`（将最后设置的处理程序替换为新的处理程序）：

```
window.addEventListener('load',function(){
  // Your code here
},false); 
```

[可以阅读有关 element.addEventListener 的更多信息](https://developer.mozilla.org/en/DOM/element.addEventListener)，特别是[IE 支持](https://developer.mozilla.org/en/DOM/element.addEventListener#Legacy_Internet_Explorer_and_attachEvent)

*这不适用于旧版本的 IE；如果你需要这种支持，我强烈推荐使用像 jQuery 这样的跨浏览器库。您最初将您的问题标记为与 jQuery 相关，但您的代码中没有使用 jQuery。*

# php - 正则表达式从字符串中删除单个字符

> ID：10306312
> 
> 赞同：1
> 
> 时间：2012-04-24T21:33:15.583
> 
> 标签：php, regex

考虑以下字符串

```
breaking out a of a simple prison
this is b moving up
following me is x times better 
```

所有字符串都已小写。我想删除任何“松散”的 az 字符，结果是：

```
breaking out of simple prison
this is moving up
following me is times better 
```

这可能在 php 中使用单个正则表达式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T21:49:03.953

```
$str = "breaking out a of a simple prison
this is b moving up
following me is x times better";
$res = preg_replace("@\\b[a-z]\\b ?@i", "", $str);
echo $res; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T21:38:41.307

怎么样：

```
preg_replace('/(^|\s)[a-z](\s|$)/', '$1', $string); 
```

请注意，这也会捕获位于字符串开头或结尾的单个字符，但不会捕获与标点符号相邻的单个字符（它们必须被空格包围）。

如果您还想立即删除标点符号之前的字符（例如“x.”），那么这在大多数（英语）情况下应该可以正常工作：

```
preg_replace('/(^|\s)[a-z]\b/', '$1', $string); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T21:40:10.810

你可以尝试这样的事情：

```
preg_replace('/\b\S\s\b/', "", $subject); 
```

这就是它的意思：

```
\b    # Assert position at a word boundary
\S    # Match a single character that is a “non-whitespace character”
\s    # Match a single character that is a “whitespace character” (spaces, tabs, and line breaks)
\b    # Assert position at a word boundary 
```

**更新**

正如[Radu](https://stackoverflow.com/users/732284/radu)提出的，因为我已经使用了`\S`this will match more than just `a-zA-Z`。它也会匹配`0-9_`。通常，它会匹配更多，但因为它前面是`\b`，它只能匹配单词字符。

正如[Tim Pietzcker](https://stackoverflow.com/users/20670/tim-pietzcker)的评论中所提到的，请注意，如果您的主题字符串需要删除后跟非单词字符（如`test a (hello)`. 如果像这样的单个字符后有多余的空格，它也会翻倒

```
test a  hello 
```

但您可以通过将表达式更改为`\b\S\s*\b`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T21:59:07.113

作为一个单行：

```
$result = preg_replace('/\s\p{Ll}\b|\b\p{Ll}\s/u', '', $subject); 
```

这匹配单个小写字母 ( `\p{Ll}`)，它前面或后面是空格 ( `\s`)，同时删除两者。单词边界 ( `\b`) 确保只有单个字母确实匹配。`/u`修饰符使正则表达式能够识别 Unicode 。

结果：两边被空格包围的单个字母被缩减为一个空格。前面有空格但后面没有空格的单个字母将被完全删除，就像后面只有一个字母但前面没有空格一样。

所以

```
This a is my test sentence a. o How funny (what a coincidence a) this is! 
```

改为

```
This is my test sentence. How funny (what coincidence) this is! 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T21:42:02.713

试试这个：

```
$sString = preg_replace("@\b[a-z]{1}\b@m", ' ', $sString); 
```

# php - 一周两次约会 php

> ID：10306314
> 
> 赞同：0
> 
> 时间：2012-04-24T21:33:18.667
> 
> 标签：php, mysql, date

我有以下情况： 从今天开始，一个患者可以每周进行 2 次在线预约。

我的代码是：

```
$user_id = $_SESSION['id'];
$datum1 = date("d-n-Y");
$datum2 = date("d-n-Y", strtotime(date("Y-m-d", strtotime($datum)) . " +7 days"));
$query = "SELECT * FROM afspraken WHERE user_id='$user_id' AND datum BETWEEN '$datum1' AND '$datum2'"; 
```

带有值的查询：

```
SELECT * FROM afspraken WHERE user_id='2' AND datum BETWEEN '24-4-2012' AND '01-5-2012' 
```

当有超过 10 条记录时，PhpMyAdmin 仍然给出 0 个结果。

```
id  user_id datum   begintijd   opmerking
55  2   24-4-2012   9:30    Deze afspraak is online gemaakt.
56  2   24-4-2012   10:00   Deze afspraak is online gemaakt. 
```

有人看到我的查询有什么问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:45:04.847

您可以通过将日期表示错误留给 MySQL 来排除它。

```
$query = "SELECT * FROM afspraken WHERE user_id='$user_id' AND datum BETWEEN CURRENT_DATE AND DATE_ADD(CURRENT_DATE, INTERVAL 1 WEEK)"; 
```

一般来说，您可能需要格式“YYYY-MM-DD”。

另一件事：您的代码易受[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)攻击。使用[准备好的语句](http://php.net/manual/en/pdo.prepared-statements.php)。它们也更易于阅读，并且在字符串字段等中转义单引号和反斜杠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:36:57.770

来自 MYSQL 文档：

> 为了在将 BETWEEN 与日期或时间值一起使用时获得最佳结果，请使用 CAST() 将值显式转换为所需的数据类型。

[http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#operator_between](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#operator_between)

`WHERE`我会尝试在您的子句中将日期转换为 DATE MySQL 数据类型。

因此，将您的查询更改为：

```
SELECT * FROM afspraken WHERE user_id='2' AND datum BETWEEN CAST('24-4-2012' AS DATE) AND CAST('01-5-2012' AS DATE); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T21:39:19.887

首先检查数据库中的“基准”字段是否为日期字段。像这样替换您的查询：

```
SELECT * FROM afspraken WHERE user_id='2' AND datum BETWEEN '24/4/2012' AND '01/5/2012' 
```

# c# - 这个小代码上的 ForEach Replace 并没有达到我的预期。我在这里做错了什么？

> ID：10306315
> 
> 赞同：4
> 
> 时间：2012-04-24T21:33:19.057
> 
> 标签：c#, replace, linqpad

我不知道这是否与 LINQPad 相关，或者我做错了什么，但是这段代码没有做我想做的事情，特别是`ForEach(...)`

我的目标是用空字符串替换“”；有一个更好的方法吗？

```
var lastNames = "SMITH, JOHNSON, WILLIAMS, JONES, BROWN";

var listLastNames = lastNames.Split(',');
var list = listLastNames.ToList(); //so I can use .ForEach
list.ForEach(i=>i.Replace(" ",String.Empty));

list.Dump(); //show it on output 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-24T21:44:54.453

正如其他人指出的那样，字符串是*不可变*的。调用 Replace 只返回一个新字符串；它不会改变现有的字符串。这里有三种方法可以做你想做的事：

对*序列*进行转换，并在最后将其转换为列表：

```
string s = "SMITH, JOHNSON, WILLIAMS, JONES, BROWN";  
List<string> lastNames = s.Split(',').Select(x=>x.Trim()).ToList(); 
```

或者，查询语法中的相同内容：

```
string s = "SMITH, JOHNSON, WILLIAMS, JONES, BROWN"; 
var query = from lastName in s.Split(',')
            select lastName.Trim();
List<string> lastNames = query.ToList(); 
```

或者，创建一个数组并就地改变数组：

```
string s = "SMITH, JOHNSON, WILLIAMS, JONES, BROWN";  
string[] lastNames = s.Split(',');
for (int i = 0; i < lastNames.Length; ++i)
    lastNames[i] = lastNames[i].Trim(); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-24T21:35:46.250

`Replace`返回一个新值，但不会影响您调用它的原始字符串。要执行您需要的操作，您必须使用以下结果构建一个新集合`Replace`- 您可以通过以下方式轻松完成此操作`Select`：

```
var replaced = list.Select(i=>i.Replace(" ",String.Empty)); 
```

另一个好处是，您不需要强制转换为 a`List<T>`来执行此操作。

正如其他人指出的那样，您可以使用`Trim()`比以下更清洁的解决方案`Replace()`：

```
var collection = lastNames.Split(',').Select(i => i.Trim()); 
```

# iphone - 执行segue时显示HUD

> ID：10306319
> 
> 赞同：0
> 
> 时间：2012-04-24T21:33:42.383
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我在我的应用程序上使用主从示例。

我添加了[MBProgressHUD](https://github.com/jdg/MBProgressHUD)以在加载细节时显示加载屏幕。

问题是我不知道我在线程上做错了什么，但我最终有两种方法：

1 - 如果我不抛出 dispatch_async()，HUD 会延迟显示；

2 - 如果我在 dispatch_async() 中执行 segue，则加载内容所需的时间比必要的要多。

下面是示例 1 的代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    [HUD show:YES];
    [self performSegueWithIdentifier:@"detail" sender:nil];
    [tableView deselectRowAtIndexPath:indexPath animated:YES];
} 
```

下面是示例 2 的代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    [HUD show:YES];
    dispatch_queue_t taskQ = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0);
    dispatch_async(taskQ, ^{
        [self performSegueWithIdentifier:@"detail" sender:nil];
        [tableView deselectRowAtIndexPath:indexPath animated:YES];
    });
} 
```

有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T12:13:35.330

这是一个对我有用的解决方案：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    HUD = [MBProgressHUD showHUDAddedTo:((AppDelegate*)[[UIApplication sharedApplication] delegate]).window.rootViewController.view animated:YES];
    HUD.labelText = @"Loading";
    HUD.labelFont = [UIFont systemFontOfSize:18];
    HUD.delegate = self;
    [HUD showWhileExecuting:@selector(openYourNewView) onTarget:self withObject:nil animated:YES];
    });
}

-(void)openYourNewView {
    [self performSegueWithIdentifier:@"YourViewIdentifier" sender:self];
} 
```

但是，我在以前的视图中仍然有一些奇怪的旋转，我不知道为什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-07T03:55:23.637

我以某种方式设法解决了这个问题！

1.  创建一个普通方法，您将在其中调用 progressHUD 并调用第二个

2.  创建第二种方法，您可以在其中执行耗时的操作（加载视图）

3.  在主线程上执行该方法

样本：

```
-(void)callHUD {

            [progressHUD show];

            dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
                [self performSelectorOnMainThread:@selector(loadView) withObject:nil waitUntilDone:YES];
                dispatch_async(dispatch_get_main_queue(), ^{
            [progressHUD dismiss];
    });
});
}

-(void)loadView {
    //Perform your segue or transition which needs to load
} 
```

希望这会帮助其他人寻找答案。;) 干杯

# php - 传递自定义参数时CakePHP分页抛出错误

> ID：10306323
> 
> 赞同：0
> 
> 时间：2012-04-24T21:33:54.117
> 
> 标签：php, cakephp

我有以下逻辑：

```
$posts = $this->paginate($this->Topic->TopicPost, array('TopicPost.topic_id' => $topic['Topic']['id'])); 
```

**我什至不确定第一行是如何获得帖子的，因为我没有提到模型及其在 TopicController 中的调用...？？？谁能确认为什么？**

我正在尝试将其转换为更像：

```
$posts = $this->paginate($this->Topic->TopicPost, array
        (
            'limit'=>15,
            'conditions'=>array
            (
                'Post.status' => array(1,2),
                'TopicPost.topic_id' => $topic['Topic']['id'])
            ),
            'order' => array('Post.datetime'=>'desc'),
            'contain'=>array('User'=>'Profile', 'TopicPost')
        )
    ); 
```

但是 Cake 不喜欢它 (v2.1) 这里有什么问题？

# windows - 我们可以在 Windows 的 iTunes Connect 上查看我们应用的统计数据（销售等）吗？

> ID：10306324
> 
> 赞同：0
> 
> 时间：2012-04-24T21:34:07.513
> 
> 标签：windows, app-store, app-store-connect

是否可以在 Windows 机器上访问 iTunes Connect？我不想上传应用程序，只想查看我的应用程序的统计数据（销售、评级等），也可能更改价格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:59:26.987

是的 - 它只是一个网站。虽然我建议使用 Chrome/Safari。IE 至少在当时有一些错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:41:40.087

我不明白为什么不，这是一个网页。但我建议您查看[http://www.appannie.com](http://www.appannie.com)。这是一个更好的界面。

# c++ - push_back 上的分段错误

> ID：10306325
> 
> 赞同：-4
> 
> 时间：2012-04-24T21:34:09.420
> 
> 标签：c++, vector, segmentation-fault

我正在创建一个带有一些设计模式的小程序，并且我正在尝试实现一个单例。在这个单例类中，我有一个包含我自己定义的 File 对象的向量。

现在，在执行实际 push_back 时，我遇到了分段错误。我尝试删除单例模式并且 push_back 效果很好。我在一个论坛上读到这个问题可能是由于向量尚未初始化造成的。他们是一种允许我使用我的向量和我的单例模式而不会导致分段错误的方法吗？

编辑：

标题：

```
class FileManager
{
public:
    static FileManager* GetManager();
    ~FileManager();

    void InitManager();

    void LoadAllTitle();

private:
    FileManager();
    static FileManager* _fileManager;

    std::vector<File> _files;
}; 
```

来源：

```
//C++ Header
#include <iostream>

//C Header

//local header
#include "filemanager.h"
#include "settings.h"
#include "defs.h"
#include "file.h"
#include "utilities.h"

FileManager* FileManager::_fileManager = NULL;

FileManager* FileManager::GetManager()
{
    if( _fileManager )
    {
        _fileManager = new FileManager();
    }

    return( _fileManager );
}

FileManager::FileManager()
{
}

FileManager::~FileManager()
{
}

void FileManager::InitManager()
{
    int numberOfFile = Settings::GetSettings()->NumberOfFile() + 1;
    for( unsigned int i = 1; i < numberOfFile; i++ )
    {
        std::string path = "data/data";
        path += IntToStr( i );
        path += ".ndb";

        File tempFile( path );

        _files.push_back( tempFile );  // segmentation fault
    }

    printf( " Done...\n" ); 
}

void FileManager::LoadAllTitle()
{
    int numberOfFile = Settings::GetSettings()->NumberOfFile() + 1;
    std::string titles = "ALL TITLES: \n";

    for( unsigned int i = 1; i < numberOfFile; i++ )
    {
        titles += _files[i].ReadTitle();
        titles += "\n";
    }
} 
```

这是我在 main.cpp 中的调用

```
FileManager::GetManager()->InitManager(); 
```

问题是，如果我将构造函数公开并主要执行此操作：

```
FileManager fm;
fm.InitManager(); 
```

这不会返回分段错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T22:00:21.607

你的逻辑是倒退的——`if (_fileManager)`应该是`if (!_fileManager)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:40:39.450

我建议您首先在没有单例的情况下在您创建的类中使用向量。通过创建一个对象`new MyClass`。如果您仍然遇到分段错误，那么它与单例无关（我相信是这种情况）

# c# - 太多的包装类

> ID：10306328
> 
> 赞同：0
> 
> 时间：2012-04-24T21:34:26.097
> 
> 标签：c#, generics, log4net

```
class LogUtil<T> : ILogUtility
{
    log4net.ILog log;

    public LogUtil()
    {
        log = log4net.LogManager.GetLogger(typeof(T).FullName);
    }

    public void Log(LogType logtype, string message)
    {
        Console.WriteLine("logging coming from class {0} - message {1} " , typeof(T).FullName, message);
    }
}

public class Logger
{
    ILogUtility _logutility;

    public Logger(ILogUtility logutility)
    {
        _logutility = logutility;
    }

    public void Log(LogType logtype, string message)
    {
        _logutility.Log(logtype, message);
    }

} 
```

我需要具有灵活的功能，并且能够在将来删除 LogUtil 类并使用其他东西。

所以我编写 LoggerUtility 包装类如下：

```
class LoggerUtility<T>
{

    Logger logger;
    public LoggerUtility()
    {
        LogUtil<T> logutil = new LogUtil<T>();

        logger = new Logger(logutil);

    }

    public void Log(LogType logtype, string message)
    {
        logger.Log(logtype, message);
    }

} 
```

我的客户端代码如下：

```
public class TestCode
{
    public void test()
    {

        new LoggerUtility<TestCode>().Log(LogType.Info, "hello world");

    }

} 
```

为了从 LogUtil 获得松耦合，我最终编写了 2 个包装类 Logger 和 LoggerUtility。所以将来，如果我必须在 ILogUtility 中添加另一个方法，我必须将该方法添加到 Logger 类，然后是 LoggerUtility。

编写 LoggerUtility 的最佳方法是什么，以便我可以编写客户端代码如下：

```
new LoggerUtility<TestCode>().Log(LogType.Info, "hello world"); 
```

请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:48:40.963

看起来您正在添加一个真正不需要的抽象级别。

如果我们从您的最终结果开始，LoggerUtility 只需要一个接口，它可以用来根据`LogType`参数记录事物。

你的`Logger`类，正如它目前所写的那样，只是`ILogUtility`接口周围的一个薄包装。那么为什么还要添加该层呢？为什么类不能直接`Logger`使用`ILogUtility`实例？您甚至可以更进一步，将您的接口定义为`ILogUtility<T>`并知道当您创建一个`LoggerUtility<Foo>`它将使用的记录器实例将基于 Foo 类时。

但老实说，我认为你可能只是在这里重新发明轮子。查看[.NET 的通用日志记录](http://netcommon.sourceforge.net/)。从长远来看，它可能会减轻您尝试做的事情并变得更有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:43:46.513

您不需要第二个包装器，您需要一个工厂或使用依赖注入框架来围绕 log4net 构建一个适当的包装器。

使用 Ninject，并修改你的界面，你可以做

```
kernel.Bind(typeof(ILogUtility<>)).To(typeof(Log4NetUtil<>); 
```

并将其实例化为

```
var logger = kernel.Get<ILogUtility<MyClass>>(); 
```

记录器接口/类是：

```
public interface ILogUtility<T> where T : class
{
     void Log(LogType logtype, string message);
}

public class Log4NetUtil<T> : ILogUtility<T> where T : class
{
    log4net.ILog log;

    public LogUtil()
    {
        log = log4net.LogManager.GetLogger(typeof(T).FullName);
    }

    public void Log(LogType logtype, string message)
    {
        Console.WriteLine("logging coming from class {0} - message {1} " , typeof(T).FullName, message);
    }
} 
```

# java - 调整图像大小以适合框架

> ID：10306335
> 
> 赞同：1
> 
> 时间：2012-04-24T21:34:51.823
> 
> 标签：java, image, swing, jlabel, bufferedimage

我的应用程序的一部分正在作为教程工作。为此，我得到了显示 JLabel 的 JPanel，该 JLabel 具有图像作为内容。虽然当图像大于适合屏幕的大小时，它只会剪掉不适合的部分。我需要做的是调整图像大小，以便适合 JLabel 给定的空间。也尝试使用 JScrollPanes 但没有任何区别（尽管我更喜欢调整图像大小）。

我尝试使用

```
Image scaledImg = myPicture.getScaledInstance(width, height, Image.SCALE_SMOOTH); 
```

但这没有任何区别。

这是当前代码：

```
private JLabel getTutorialLabel(int type) {
        String path = "/Images/Tutorial/test" + type + ".png";
        try {
            BufferedImage tutorialPic = ImageIO.read(getClass().getResource(path));
//            int height = (int) (screenDim.height * 0.9);
//            int width = (int) (screenDim.width * 0.9);
//            Image scaledImg = myPicture.getScaledInstance(width, height, Image.SCALE_SMOOTH);
            JLabel picLabel = new JLabel(new ImageIcon(tutorialPic));
            return picLabel;
        } catch (IOException ex) {
            Logger.getLogger(Tutorial.class.getName()).log(Level.SEVERE, null, ex);
        }

        return null;
    } 
```

> 如何让图像正确显示？

请注意，还有其他组件与 JLabel 一起显示（JMenuBar 和屏幕底部的一些按钮），所以我需要图像来填充 JLabel 给出的空间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:14:47.003

**编辑**：更新了方法

您可以在[Java Helper Library](https://github.com/kentcdodds/Java-Helper)中尝试[此方法](https://github.com/kentcdodds/Java-Helper/blob/master/src/com/kentcdodds/javahelper/helpers/SwingHelper.java#L53)。

或者，这是方法本身：

```
/**
* This method resizes the given image using Image.SCALE_SMOOTH.
*
* @param image the image to be resized
* @param width the desired width of the new image. Negative values force the only constraint to be height.
* @param height the desired height of the new image. Negative values force the only constraint to be width.
* @param max if true, sets the width and height as maximum heights and widths, if false, they are minimums.
* @return the resized image.
*/
public static Image resizeImage(Image image, int width, int height, boolean max) {
  if (width < 0 && height > 0) {
    return resizeImageBy(image, height, false);
  } else if (width > 0 && height < 0) {
    return resizeImageBy(image, width, true);
  } else if (width < 0 && height < 0) {
    PrinterHelper.printErr("Setting the image size to (width, height) of: ("
            + width + ", " + height + ") effectively means \"do nothing\"... Returning original image");
    return image;
    //alternatively you can use System.err.println("");
    //or you could just ignore this case
  }
  int currentHeight = image.getHeight(null);
  int currentWidth = image.getWidth(null);
  int expectedWidth = (height * currentWidth) / currentHeight;
  //Size will be set to the height
  //unless the expectedWidth is greater than the width and the constraint is maximum
  //or the expectedWidth is less than the width and the constraint is minimum
  int size = height;
  if (max && expectedWidth > width) {
    size = width;
  } else if (!max && expectedWidth < width) {
    size = width;
  }
  return resizeImageBy(image, size, (size == width));
}

/**
* Resizes the given image using Image.SCALE_SMOOTH.
*
* @param image the image to be resized
* @param size the size to resize the width/height by (see setWidth)
* @param setWidth whether the size applies to the height or to the width
* @return the resized image
*/
public static Image resizeImageBy(Image image, int size, boolean setWidth) {
  if (setWidth) {
    return image.getScaledInstance(size, -1, Image.SCALE_SMOOTH);
  } else {
    return image.getScaledInstance(-1, size, Image.SCALE_SMOOTH);
  }
} 
```

# javascript - Firefox Addon Builder 首选项-服务对我不起作用--为什么？

> ID：10306337
> 
> 赞同：0
> 
> 时间：2012-04-24T21:35:01.947
> 
> 标签：javascript, html, firefox, firefox-addon, firefox-addon-sdk

我正在尝试在 Firefox Add-on Builder 中创建一个按钮，该按钮将更改搜索栏使用的 URL。要更改 URL，我有一个面板显示单击按钮的时间，面板中有一系列按钮。

在第二个`.js`文件（不是`main.js`）中，我有应该`keyword.url`使用`preferences-service`模块更改功能的功能。

这是我用来执行此操作的代码：

```
function changekeywordurl(url) {
    alert('Search Engine Changed');
    require("preferences-service").set('keyword.url', url);
} 
```

面板的 HTML 是：

```
<button onclick="changekeywordurl('http://search.yahoo.com/search?p=')">Yahoo</button> 
```

对不起，如果我犯了一个非常愚蠢的错误；这是我的第一次尝试和附加组件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T05:39:23.860

您的扩展加载的 HTML 页面没有任何特殊权限 - 它们就像普通网页一样。特别是，该函数`require()`未在此上下文中定义。您需要做的是将内容脚本加载到面板中，因为内容脚本可以与扩展程序进行通信。此内容脚本可能如下所示：

```
// Add event listener in the content script, the page cannot "see" content script
// functions
var buttons = document.getElementsByClassName("searchButton");
for (var i = 0; i < buttons.length; i++)
  buttons[i].addEventListener("click", changekeywordurl, false);

// Send a message to the extension if a button is clicked
function changekeywordurl(event)
{
  var button = event.target;
  self.postMessage(button.getAttribute("_keywordURL"));
} 
```

页面中的按钮如下所示：

```
<button _keywordURL="http://search.yahoo.com/search?p="></button> 
```

然后您的扩展程序可以收听来自内容脚本的消息并使用必要的 SDK 模块。

# jquery - mansory + infinitescroll preloder 动画从头加载图像

> ID：10306338
> 
> 赞同：0
> 
> 时间：2012-04-24T21:35:14.270
> 
> 标签：jquery, jquery-masonry, infinite-scroll

我使用 jquery masonry + 无限滚动。我会从一开始就使用加载器图像（当我打开页面时）而不是在第一次滚动时使用无限滚动库来获得预加载效果。

或者，可以在页面打开时使用 gif 预加载器，以便使用 mansory 插件显示第一组图像。

有任何想法吗？提前非常感谢。

> ```
>  $container.imagesLoaded( function(){
> 
>         $container.masonry({
>           isAnimated: true,
>           itemSelector : '.box',
>           columnWidth:10
>         });
> 
>   });
> 
>   $container.infinitescroll({
>             navSelector  : '#page-nav',    // selector for the paged navigation 
>             nextSelector : '#page-nav a',  // selector for the NEXT link (to page 2)
>             itemSelector : '.box',     // selector for all items you'll retrieve
>           //animate:true,
> 
>             // enable debug messaging ( to console.log )
>             loading: {
>                 finishedMsg: 'Pagine da caricare terminate.',
>                 img: 'http://i.imgur.com/6RMhx.gif'
>                }
>               },
>             // trigger Masonry as a callback
>             function( newElements ) {
>                // hide new items while they are loading
>               var $newElems = $( newElements ).css({ opacity: 0 });
>               // ensure that images load before adding to masonry layout
>               $newElems.imagesLoaded(function(){
>                 // show elems now they're ready
>                  $newElems.animate({ opacity: 1 });
>                  $container.append( $newElems ).masonry( 'appended', $newElems, true ); 
> 
>               });
>              }
>           ); 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T10:02:20.263

您可以通过 css 设置可见的加载 gif。加载图像后，您可以将其完全隐藏或从页面中删除。不要忘记为#loading div 设置正确的样式（例如定位）。

```
<div id="loading">... loading content goes here ...</div> 
```

在 jQuery 端；

```
$container.imagesLoaded( function(){

$('#loading').remove();

//masonry stuff goes here

} 
```

# json - 在 Tcl 中打印 JSON 格式的数据

> ID：10306343
> 
> 赞同：1
> 
> 时间：2012-04-24T21:35:25.393
> 
> 标签：json, tcl

嗨，我需要在 tcl 中打印以下内容。

```
{'root':[{'name':'Test', 'val':'1'},{'name':'Test2', 'val':'3'}]}
```

当我执行以下操作时出现错误

```
puts "{'root':[{'name':'$name', 'val':'$val'},{'name':'$name', 'val':'$val'}]}" 
```

有没有办法可以在 tcl 中打印它们？

好的，我现在尝试了：

```
puts "{'root':\[{'name':'$name', 'val':'$id'}" 
```

但这也不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:46:29.193

请记住，'[' 表示您要执行某些操作，因此您需要对其进行转义。

```
puts "{'root':\[{'name':'$name', 'val':'$val'},{'name':'$name','val':'$val'}\]}" 
```

通过这些更改，应该可以工作。

此外，您可以在此处找到更多关于如何在 tcl 中管理 JSON 的示例：[http ://wiki.tcl.tk/13419](http://wiki.tcl.tk/13419)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:59:10.937

只是

```
puts {{'root':[{'name':'Test', 'val':'1'},{'name':'Test2', 'val':'3'}]}} 
```

也就是说，将整个字符串放在 和 之间`{`，`}`使其成为“文字”。

更多信息在[教程](http://www.tcl.tk/man/tcl8.5/tutorial/Tcl4.html)中。

# php - 如何计算数组中每种类型的条目数？

> ID：10306344
> 
> 赞同：-2
> 
> 时间：2012-04-24T21:35:25.803
> 
> 标签：php, arrays, count, find-occurrences

我需要计算这个数组中存在多少次字符 1、2、3、4、5 例如为此我应该得到答案 1-2 次 2-2 次 3-1 次 4-3 次

```
<?php
array(8) {
  [0]=>
  array(2) {
    [0]=>
    string(1) "3"
    ["answer"]=>
    string(1) "3"
  }
  [1]=>
  array(2) {
    [0]=>
    string(1) "4"
    ["answer"]=>
    string(1) "4"
  }
  [2]=>
  array(2) {
    [0]=>
    string(1) "1"
    ["answer"]=>
    string(1) "1"
  }
  [3]=>
  array(2) {
    [0]=>
    string(1) "1"
    ["answer"]=>
    string(1) "1"
  }
  [4]=>
  array(2) {
    [0]=>
    string(1) "2"
    ["answer"]=>
    string(1) "2"
  }
  [5]=>
  array(2) {
    [0]=>
    string(1) "2"
    ["answer"]=>
    string(1) "2"
  }
  [6]=>
  array(2) {
    [0]=>
    string(1) "4"
    ["answer"]=>
    string(1) "4"
  }
  [7]=>
  array(2) {
    [0]=>
    string(1) "4"
    ["answer"]=>
    string(1) "4"
  }
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T21:49:54.677

如果这是从数据库返回的数据，为什么不使用数据库查询来为您进行计数呢？

```
SELECT answer,
       COUNT(1) AS instances
  FROM myTable
 GROUP BY answer 
```

# clojure - 尝试运行 lein 时出现异常

> ID：10306345
> 
> 赞同：4
> 
> 时间：2012-04-24T21:35:32.027
> 
> 标签：clojure, leiningen

尝试在 linux 中运行 lein 时出现以下异常。

```
Exception in thread "main" java.lang.NoClassDefFoundError: clojure.core.protocols$fn__5393
   at java.lang.Class.initializeClass(libgcj.so.10)
   at clojure.core.protocols__init.load(Unknown Source:16)
   at clojure.core.protocols__init.<clinit>(Unknown Source)
   at java.lang.Class.initializeClass(libgcj.so.10)
   at java.lang.Class.forName(libgcj.so.10)
   at clojure.lang.RT.loadClassForName(RT.java:1578)
   at clojure.lang.RT.load(RT.java:399)
   at clojure.lang.RT.load(RT.java:381)
   at clojure.core$load$fn__4519.invoke(core.clj:4915)
   at clojure.core$load.doInvoke(core.clj:4914)
   at clojure.lang.RestFn.invoke(RestFn.java:408)
   at clojure.core__init.load(Unknown Source:5342)
   at clojure.core__init.<clinit>(Unknown Source)
   at java.lang.Class.initializeClass(libgcj.so.10)
   at java.lang.Class.forName(libgcj.so.10)
   at clojure.lang.RT.loadClassForName(RT.java:1578)
   at clojure.lang.RT.load(RT.java:399)
   at clojure.lang.RT.load(RT.java:381)
   at clojure.lang.RT.doInit(RT.java:416)
   at clojure.lang.RT.<clinit>(RT.java:302)
   at java.lang.Class.initializeClass(libgcj.so.10)
   at clojure.main.<clinit>(main.java:20)
   at java.lang.Class.initializeClass(libgcj.so.10)
   at java.lang.Class.forName(libgcj.so.10)
   at java.lang.Class.forName(libgcj.so.10)
   at jline.ConsoleRunner.main(ConsoleRunner.java:69)
Caused by: java.lang.VerifyError: verification failed at PC 214 in      
clojure.core.protocols$fn__5393:invoke((Ljava.lang.Object;Ljava.lang.Object;Ljava.lang.Obje    ct;)Ljava.lang.Object;): incompatible type on stack
   at java.lang.Class.initializeClass(libgcj.so.10)
   ...25 more 
```

我已经按照他们的 github 页面上的说明进行操作，但没有运气。我认为今天开始学习 clojure 会很有趣，但我除了问题什么都没有，我什至不知道 leiningen 是什么，除了我显然必须拥有它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:39:39.327

抱歉让您失望了，

Leiningen 是一个构建工具，可以帮助您摆脱在新的 clojure 项目上进行黑客攻击的痛苦。在 leiningen 存在之前，许多人会尝试通过下载 jar 文件从源代码构建它来“安装”clojure。无需执行任何操作，您只需在 leiningen project.clj 文件中指定要使用的版本，并将其作为该项目的依赖项安装在本地。

你跑了吗：

*   lein new hello_clojure
*   cd hello_clojure
*   编辑 project.clj 并将其设置为使用 clojure 1.3.0`:dependencies [[org.clojure/clojure "1.3.0"]`
*   莱因部门
*   莱因雷普
*   （+ 1 2 3 4）

当 leiningen 出现问题时，我通常会：

*   莱因升级
*   rm库/*
*   莱因部门

像这样的问题并不常见（对我来说）并且通常相当具体，所以也许你最好进入 irc.freenode.net 上的#clojure 并询问。这是一个非常友好的人群不要担心。

# http - 有没有办法通过 HTTP 请求读取 Google 趋势？

> ID：10306351
> 
> 赞同：1
> 
> 时间：2012-04-24T21:35:52.183
> 
> 标签：http, rest

有没有办法使用 HTTP 请求从 Google 趋势中读取输出？

我想使用 HTTP 请求从 Google 趋势中读取我正在开发的应用程序的数据。我对 REST 有一些经验。提前谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-22T07:47:39.197

使用此 API [Google 趋势](http://hawttrends.appspot.com/api/terms/)并获取所有国家/地区的 json 格式数据。国家代码参考： http: [//myweb.fcu.edu.tw/~mhsung/Research/InformationSystem/JSON/JSON_24.htm](http://myweb.fcu.edu.tw/~mhsung/Research/InformationSystem/JSON/JSON_24.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T19:51:25.130

> Google 搜索产品副总裁 Marissa Mayer 宣布了一个与 Google Trends 服务配套的 API。这是在2007年宣布的，到目前为止还没有发布。

*   [维基百科](http://en.wikipedia.org/wiki/Google_Trends#Google_Trends_API)

# css - 将 div 彼此相邻放置，而不是在下方

> ID：10306354
> 
> 赞同：2
> 
> 时间：2012-04-24T21:36:04.147
> 
> 标签：css, wordpress, html

我无法将 div 彼此相邻放置，而不是将它们放在下方。我是使用 CSS 的新手，我不确定我需要做什么。

该网页是 www.panduzee.com/wordpress

帖子“Richard Lu”应该在“Ashley Lee”旁边。

代码的链接是： http: [//pastebin.com/J3CNMfaP](http://pastebin.com/J3CNMfaP) 而 CSS 是： http: [//pastebin.com/isn5NViA](http://pastebin.com/isn5NViA)

抱歉，我尝试让代码在这篇文章中工作，但它没有正确显示。

任何帮助，将不胜感激！CSS 来自 wordpress 主题，只是让大家知道。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T21:44:22.707

jsFiddle（[http://jsfiddle.net/BnJ7g/3/](http://jsfiddle.net/BnJ7g/3/)）

在您的“boxes”和“boxes2”div 上，添加`float:left`属性。

```
<div id="boxes" style="float:left;">
    <div class="box">
        <!--The post title-->
        Ashley Lee    <!--The post image-->
        <a href="http://www.panduzee.com/wordpress/2012/04/15/fashion/"><img width="210" height="312" src="http://www.panduzee.com/wordpress/wp-content/uploads/2012/04/527802_2560693355446_1797426028_1635316_739143794_n-210x312.jpg" class="attachment-homepage-thumb wp-post-image" alt="" title="" /></a>
    </div>    
</div>

<div id="boxes2" style="float:left;">
    <div class="box">
        Richard Lu    <!--The post image-->
        <a href="http://www.panduzee.com/wordpress/2012/04/24/richard-lu/"><img width="210" height="312" src="http://www.panduzee.com/wordpress/wp-content/uploads/2012/04/527802_2560693355446_1797426028_1635316_739143794_n-210x312.jpg" class="attachment-homepage-thumb wp-post-image" alt="" title="" /></a>
    </div>   
</div> 
```

​</p>

# python - Google App Engine 的 Go 教程：ImportError: No module named _md5

> ID：10306361
> 
> 赞同：0
> 
> 时间：2012-04-24T21:36:29.580
> 
> 标签：python, google-app-engine, go

我正在尝试以 Go 语言运行 Google 应用引擎的 hello world 教程。Go 的 GAE SDK 基于我安装的 python 2.5。然后我必须安装 openssl，但现在当我尝试在 SDK 上运行我的示例应用程序时，我收到以下错误：

```
ImportError: No module named _md5 
```

我什至从 python 解释器界面尝试了一个简单的 import md5 & import hashlib，但我仍然得到同样的错误

```
>>> import hashlib
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
File "/usr/local/lib/python2.5/hashlib.py", line 133, in <module>
md5 = __get_builtin_constructor('md5')
File "/usr/local/lib/python2.5/hashlib.py", line 60, in __get_builtin_constructor
import _md5
ImportError: No module named _md5 
```

有人知道解决方法吗？谢谢！我有一种感觉，这个问题实际上是关于 python 安装而不是其他任何事情

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T13:54:39.350

您的问题与 GAE 或 SDK 无关。我以前也遇到过这种情况。如果您尝试安装自定义版本的 python（在 Ubuntu 上），那么您会遇到此类问题。您应该使用 checkinstall 卸载自定义 python。更多细节可以在这里找到：[卸载从源代码构建的python？](https://stackoverflow.com/questions/3544378/uninstall-python-built-from-source).

只需使用默认的 python 就可以了！

# .net - 将 c++ 项目从 4.0 转换为 3.5 框架

> ID：10306363
> 
> 赞同：7
> 
> 时间：2012-04-24T21:36:45.177
> 
> 标签：.net, .net-4.0, .net-3.5, c++-cli, upgrade

我必须将 c++ 项目的目标框架从 4.0 更改为 3.5。我发现这个问题/答案有助于如何做到这一点：[Change C++/CLI project to another framework than 4.0 with vs2010](https://stackoverflow.com/q/2921702/1217150)
我遇到了以下问题：我收到警告：

```
 warning MSB3258: The primary reference "path\file.dll" could not be resolved because it has an indirect dependency on the .NET Framework assembly "mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" which has a higher version "4.0.0.0" than the version "2.0.0.0" in the current target framework 
```

, `System, Version=4.0.0.0`, `Microsoft.VisualC, Version=10.0.0.0`, `System.Configuration, Version=4.0.0.0`, `System.Xml, Version=4.0.0.0`,`System.Security, Version=4.0.0.0`和 也是如此`System.Data.SqlXml, Version=4.0.0.0`。这会导致依赖于无法找到的 file.dll 的所有项目中出现错误。
我不知道如何解决这个问题。我也安装了 Visual Studio 2008 - 尽管它似乎并不在意，并且使用 Platform Toolset v90 甚至无法构建 c++ 项目。请帮忙 ！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T21:52:40.737

Visual C++ 编译器版本 16.00（随 Visual Studio 2010 提供）不能针对 4.0 以外的任何框架版本。

要面向 3.5，您必须使用旧版 (Visual Studio 2008) 的 C++ 编译器，并且您将无法使用新的 C++ 语言功能（例如初步的 C++11 支持）。

通过选择平台工具链 v90，您可以继续使用 Visual Studio 2010 IDE。

# web-applications - 如何使用位置正则表达式通过 nginx 重定向/处理来自搜索引擎的请求

> ID：10306373
> 
> 赞同：5
> 
> 时间：2012-04-24T21:37:24.673
> 
> 标签：web-applications, nginx, server-configuration

我已经开发了一个基于 ajax 的带有 hash bang url 的 web 应用程序。

我正在尝试将来自搜索引擎的请求重定向到另一台生成 HTML 快照并发送响应的服务器。我试图在 nginx 中使用 location 指令来实现这一点，如下所述：

```
 location ~ ^(/?_escaped_fragment_=).*$ {
         proxy_set_header        Host $host;
          proxy_set_header        X-Real-IP $remote_addr;
      proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header        X-Forwarded-Proto $scheme;

          client_max_body_size    10m;
          client_body_buffer_size 128k;
          proxy_connect_timeout   60s;
          proxy_send_timeout      90s;
          proxy_read_timeout      90s;
          proxy_buffering         off;
          proxy_temp_file_write_size 64k;
          proxy_pass      http://x1.x2.x3.x4:8080;
          proxy_redirect      off;
      } 
```

但我无法让这个工作。有人可以纠正我正在使用的正则表达式（或）为我提供一个替代解决方案来实现这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T19:17:19.550

您无法检查位置名称中的参数（[nginx 文档](http://nginx.org/en/docs/http/request_processing.html)）：

> 请注意，所有类型的位置仅测试请求行的 URI 部分，不带参数。这样做是因为查询字符串中的参数可以通过多种方式给出，例如：
> 
> /index.php?user=john&page=1
> /index.php?page=1&user=john

您可以在服务器部分设置重写规则（在[此处](http://fascinated.fm/post/1228952802/enabling-googles-ajax-crawling-convention-on-nginx)找到）：

```
if ($args ~ “_escaped_fragment_=(.+)”) {
    set $real_url $1;
    rewrite ^ /crawler$real_url;
} 
```

并定义一个“/crawler”位置，该位置可以重定向到您的 HTML 生成服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-06T12:05:55.930

我这样解决了这个问题：

```
if ( $arg__escaped_fragment_ ) {
    return 301 $uri$arg__escaped_fragment_;
} 
```

# unix - 在 UNIX 中使用 cut 命令获取最后一个句点

> ID：10306375
> 
> 赞同：0
> 
> 时间：2012-04-24T21:37:29.767
> 
> 标签：unix, command, cut

假设我有很多 ip 号码（每行 2 个 ip 号码，用空格分隔）要查看（这里有两行）：

```
67.21.89.48.1623 139.91.131.115.110
211.47.82.64 139.91.134.123.445 
```

其中一个可能没有端口，因此周期数永远不会一致。我只想要第一个的 ip 号（没有端口）和第二组的端口（没有 ip 号）。所以它应该看起来像：

```
67.21.89.48 110
211.47.82.64 445 
```

或者它可能看起来像这样：

```
67.21.89.48.110
211.47.82.64.445 
```

只要我知道IP和端口的位置，这并不重要。

我一直在使用这样的东西：

```
cut -d'.' -f1-4,9 < file.txt 
```

但这仅适用于一致数量的周期。有什么办法可以从后面剪掉吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T21:42:59.273

详细格式：

```
perl -n -e 'print "$1 $2\n" if m/^
                                 ((?:\d+\.){3}\d+)      # IPv4 address
                                 (?:\.\d+)?             # Optional port
                                 \s+                    # White space
                                 (?:(?:\d+\.){4})       # IPv4 address plus dot
                                 (\d+)                  # Port number
                                 \s*$                   # Optional white space
                                /x' perl.data 
```

单线：

```
perl -ne 'print "$1 $2\n" if m/^((?:\d+\.){3}\d+)(?:\.\d+)? (?:(?:\d+\.){4})(\d+)\s*$/' 
```

如果第二个条目有端口号，这只会打印任何内容；如果没有，则跳过该行。

如果您愿意，可以使 IP 地址和端口号识别对称（即使不会打印第二个 IP 地址）：

```
perl -n -e 'print "$1 $4\n" if m/^ \s*                  # Optional white space
                                 ((?:\d+\.){3}\d+)      # IPv4 address
                                 (?:\.(\d+)) ?          # Optional Port number
                                 \s+                    # White space
                                 ((?:\d+\.){3}\d+)      # IPv4 address
                                 (?:\.(\d+))            # Mandatory Port number
                                 \s* $                  # Optional white space
                                /x' perl.data 
```

我用过`\d+`“一个或多个数字”；对于IPv4点分十进制地址组件，可以做成`\d{1,3}`“一到三位数”，端口号可以做成`\d{1,5}`“一到五位数”。

如果你真的很注重细节，你甚至可以更精确地限制数字范围，但这可能不值得。这是正则表达式处理的一个共同特征；您可以制作出足以胜任手头工作的东西 - 不必处理恶意软件可能向您抛出的所有可能变化。你必须对要做什么做出判断。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T21:53:28.193

正如 Jonathan 在评论中指出的那样，使用`cut`会非常复杂，因为您需要的列数可能会有所不同。

这是一个示例`sed`：

```
$ echo "67.21.89.48.1623 139.91.131.115.110
211.47.82.64 139.91.134.123.445" | sed -r 's/^(([0-9]{1,3}\.){3}[0-9]{1,3})(.*)\.([0-9]{1,4})$/\1 \4/'
67.21.89.48 110
211.47.82.64 445 
```

您可以将其运行为：

```
sed -r 's/^(([0-9]{1,3}\.){3}[0-9]{1,3})(.*)\.([0-9]{1,4})$/\1 \4/' logfile.txt 
```

`[0-9]{1,3}\.){3}[0-9]{1,3}`可能是 IP 地址的蹩脚正则表达式，但这是我能想到的第一个。你可以用更聪明的东西代替它。也许您甚至不需要检查点之间的内容，只需在第 4 个时期之前和最后一个时期之后获取所有内容。

# r - RF：一类的OOB精度高，另一类的精度非常低，类不平衡大

> ID：10306380
> 
> 赞同：4
> 
> 时间：2012-04-24T21:37:50.120
> 
> 标签：r, machine-learning, classification, random-forest

我是随机森林分类器的新手。我正在使用它对具有两个类的数据集进行分类。- 特征数量为 512。 - 数据比例为 1:4。即，75% 的数据来自第一类，25% 来自第二类。- 我正在使用 500 棵树。

分类器产生 21.52% 的袋外错误。第一类（由 75% 的训练数据表示）的每类误差为 0.0059。而第二类的分类误差非常高：0.965。

我正在寻找这种行为的解释，如果您有提高第二类准确性的建议。

我期待着您的帮助。

谢谢

忘了说我使用的是 R 并且在上面的测试中我使用了 1000 的节点大小。

在这里，我只用 10 棵树和 nodesize= 1 重复了训练（只是为了给出一个想法），下面是 R 中的函数调用和混淆矩阵：

*   随机森林（公式 = 标签 ~ .，数据 = chData30PixG12，ntree = 10，重要性 = TRUE，节点大小 = 1，keep.forest = FALSE，do.trace = 50）
*   随机森林类型：分类

*   树的数量：10

*   每次拆分尝试的变量数：22

*   OOB 估计错误率：24.46%

*   混淆矩阵：

*   不相关的，相关的，class.error

*   无关 37954 , 4510 , 0.1062076
*   相关 8775 , 3068 , 0.7409440

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T21:53:31.953

我同意@usr，一般来说，当您看到随机森林简单地将（几乎）每个观察分类为多数类时，这意味着您的特征没有提供太多信息来区分这两个类。

一种选择是运行随机森林，这样您就可以对少数类的观察结果进行过度采样（而不是从整个数据集中进行替换采样）。因此，您可以指定每棵树都建立在大小为 N 的样本上，您可以强制 N/2 的观察来自每个类（或您选择的其他比例）。

虽然这可能对某些人有所帮助，但这绝不是万灵药。与调整 RF 设置相比，找到更好的功能来区分类别可能更有可能获得更多的里程。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-23T13:49:55.833

我很惊讶没有人提到使用“classwt”参数。加权随机森林 (WRF) 专门用于解决此类问题。

请参见此处：[堆栈交换问题 #1](https://stackoverflow.com/questions/10112678/what-does-the-parameter-classwt-in-randomforest-function-in-randomforest-pack)

在这里：[堆栈交换问题 #2](https://stackoverflow.com/questions/20251839/how-to-use-classwt-in-randomforest-of-r)

关于加权随机森林的文章：[PDF](http://statistics.berkeley.edu/sites/default/files/tech-reports/666.pdf)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-14T21:57:41.747

嗯，这是典型的类不平衡问题。随机森林是一种旨在最大化模型准确性的分类器。当一个类占数据的大部分时，分类器实现准确度的最简单方法是将所有观察结果分类到多数类中。在您的情况下，这给出了非常高的准确度，为 0.75，但是一个糟糕的模型 - 对于少数类几乎没有正确的分类。有很多方法可以处理这个。更简单的方法是使用多数类的欠采样来平衡数据，然后用这个平衡的数据训练模型。希望这可以帮助你。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-08-07T20:04:53.190

您可以尝试使用 sampsize = c(500,500) 来平衡错误结果（即，在每棵树中，每个类将使用 500 个，以避免不平衡错误的问题，您当然可以更改数字，以及将节点大小设置得这么大它可能会使树变得非常小（在每棵树中使用一些变量）。你不想过度训练训练集（即使 RF 模型处理了这一点）但你想至少使用一些每棵树中的变量。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-25T08:26:55.513

如果您将显示导致如此糟糕分类的代码，它将很有用。现在我看到了表现如此糟糕的一个原因——`nodesize = 1000`价值太大。你的数据集中有多少观察？尝试使用默认值`nodesize`或将其设置为更小的值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-24T21:43:13.100

看起来分类器完全无法在数据中找到结构。它所能做的最好的事情是将所有内容归类为第 1 类，因为这是最常见的类。

# python - gtkBuilder 在线程中的 get_object

> ID：10306384
> 
> 赞同：4
> 
> 时间：2012-04-24T21:38:10.760
> 
> 标签：python, multithreading, gtk

据说你不应该从线程调用 GUI 函数，但我想知道这是否仅适用于你调用直接影响 GUI 的函数，或者它适用于 GUI 库提供的每个函数。例如，可以安全地调用：

```
gobject.idle_add(self.gui.get_object('button1').set_sensitive, False) 
```

在一个线程中？因为 self.gui.get_object 是 GUI 框架中的一个函数，但 self.gui.get_object('button1') 实际上是在调用它。

谢谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:37:46.993

你在那里显示的电话似乎是安全的。正如已经发布的那样，您可以`get_object`在任何线程中正常阅读 ()，但只能`set_sensitive`在主线程中修改 ()。正是在这里完成，`idle_add`将事件添加到在主线程中运行的主循环中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T08:53:43.600

使用 GUI 进行线程处理有点棘手。如果您想正确执行此操作，则不应从主线程以外的任何其他线程中更新 GUI（GUI 库中的常见限制）。但是，您可以从多个线程进行多次读取调用。

# pcap - 分组数据截取和修改

> ID：10306386
> 
> 赞同：0
> 
> 时间：2012-04-24T21:38:19.387
> 
> 标签：pcap, libpcap

我希望能够在 tcp 客户端一侧拦截/修改 tcp 流中的数据。pcap 的示例显示了如何解析 tcp 数据包标头/有效负载。但是假设，我想在 tcp 客户端读取它之前修改数据包有效负载，或者完全丢弃数据包。我怎么能用 pcap capure 做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T07:20:12.173

如上所述，您不能使用 pcap 进行拦截/修改。为此，您需要以下依赖于操作系统的技术之一：

*   *Linux*：libnetfilter_queue + iptables
*   *MacOS*，*FreeBSD*：转移套接字 + ipfw
*   *Windows*：WinPkFilter（商业）、WinDivert（LGPL），或编写您自己的 NDIS IM 或 WFP 调用驱动程序。

（通常披露：WinDivert 是我的项目）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T07:26:56.727

Scapy 与 python 结合使用是一个非常好的工具兼库。

您可以通过命令行进行各种数据包监控和编辑

您还可以在 scapy 之上构建应用程序来执行特定任务。

[斯卡皮](http://en.wikipedia.org/wiki/Scapy)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T19:22:45.363

你不能用 libpcap 或 WinPcap 做到这一点；libpcap 构建在不支持的操作系统机制之上（这些机制的存在是为了支持被动数据包捕获和低级数据包捕获和注入，不支持数据包输入和输出路径中的数据包修改），WinPcap 的驱动程序构建在一个那种操作系统机制。

无论您使用什么操作系统，您都必须找到某种机制来支持以允许窃听程序在数据包通过网络堆栈时修改数据包的方式进入网络堆栈。这种机制在某些操作系统上可能不存在；在它确实存在的操作系统上，如果有的话，它可能非常依赖于操作系统。（libpcap 使用的机制也依赖于操作系统；libpcap 的存在部分是为了尽可能地隐藏应用程序的这些差异。）

# python - Python将tzinfo传递给没有pytz的天真日期时间

> ID：10306389
> 
> 赞同：17
> 
> 时间：2012-04-24T21:38:29.923
> 
> 标签：python, timezone

我在 Python 中的日期/时区问题上苦苦挣扎了太久，我想有人可以帮我一把。

基本上我想在 UTC 中进行转换并考虑 DST 的变化。

我从 Python 教程之一创建了以下 tzinfo 类（我知道不是 100% 准确，但它不需要）：

```
from datetime import tzinfo, timedelta, datetime

ZERO = timedelta(0)
HOUR = timedelta(hours=1)

def first_sunday_on_or_after(dt):
    days_to_go = 6 - dt.weekday()
    if days_to_go:
        dt += timedelta(days_to_go)
    return dt

DSTSTART_2007 = datetime(1, 3, 8, 2)
DSTEND_2007 = datetime(1, 11, 1, 1)
DSTSTART_1987_2006 = datetime(1, 4, 1, 2)
DSTEND_1987_2006 = datetime(1, 10, 25, 1)
DSTSTART_1967_1986 = datetime(1, 4, 24, 2)
DSTEND_1967_1986 = DSTEND_1987_2006

class USTimeZone(tzinfo):

    def __init__(self, hours, reprname, stdname, dstname):
        self.stdoffset = timedelta(hours=hours)
        self.reprname = reprname
        self.stdname = stdname
        self.dstname = dstname

    def __repr__(self):
        return self.reprname

    def tzname(self, dt):
        if self.dst(dt):
            return self.dstname
        else:
            return self.stdname

    def utcoffset(self, dt):
        return self.stdoffset + self.dst(dt)

    def dst(self, dt):
        if dt is None or dt.tzinfo is None:
            # An exception may be sensible here, in one or both cases.
            # It depends on how you want to treat them.  The default
            # fromutc() implementation (called by the default astimezone()
            # implementation) passes a datetime with dt.tzinfo is self.
            return ZERO
        assert dt.tzinfo is self

        # Find start and end times for US DST. For years before 1967, return
        # ZERO for no DST.
        if 2006 < dt.year:
            dststart, dstend = DSTSTART_2007, DSTEND_2007
        elif 1986 < dt.year < 2007:
            dststart, dstend = DSTSTART_1987_2006, DSTEND_1987_2006
        elif 1966 < dt.year < 1987:
            dststart, dstend = DSTSTART_1967_1986, DSTEND_1967_1986
        else:
            return ZERO

        start = first_sunday_on_or_after(dststart.replace(year=dt.year))
        end = first_sunday_on_or_after(dstend.replace(year=dt.year))

        # Can't compare naive to aware objects, so strip the timezone from
        # dt first.
        if start <= dt.replace(tzinfo=None) < end:
            return HOUR
        else:
            return ZERO 
```

另一方面，我`date`在 EST 中有一个任意对象，我想通过考虑 DST 来了解它们不同的小时数。

我试过这样的事情：

```
>>> Eastern = ustimezone.USTimeZone(-5, "Eastern",  "EST", "EDT")
>>> x = datetime.date.today() # I actually get an arbitrary date but this is for the example
>>> x_dt = datetime.datetime.combine(x, datetime.time())
>>> x_dt_tz = x_dt.astimezone(Eastern)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: astimezone() cannot be applied to a naive datetime 
```

我看过几篇告诉`localize`从`pytz`模块中使用的帖子，但不幸的是我无法使用其他模块，所以无法使用`pyzt`

有谁知道我如何在**不使用 pytz**的情况下将这个天真的日期时间转换为时区对象？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-25T01:32:04.017

对于它的价值，@skyl 提供的答案或多或少等同于所做的事情`pytz`。

这是相关的`pytz`来源。它只是`replace`用kwarg调用`datetime`对象：`tzinfo`

```
def localize(self, dt, is_dst=False):
    '''Convert naive time to local time'''
    if dt.tzinfo is not None:
        raise ValueError('Not naive datetime (tzinfo is already set)')
    return dt.replace(tzinfo=self) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-25T00:42:03.447

使用`x_dt.replace(tzinfo=Eastern)`（[从这个 Google Groups 线程中找到](http://groups.google.com/group/google-appengine/browse_thread/thread/17add9b3070aad7e/b995fe7e1f16cd4e)）。

`x_dt.replace(tzinfo=Eastern).utcoffset()`返回`datetime.timedelta(-1, 72000)`对应于 -4 小时！（来自问题的评论）

# mysql - SQL：多对多对多对多……这效率高吗？

> ID：10306393
> 
> 赞同：2
> 
> 时间：2012-04-24T21:38:56.707
> 
> 标签：mysql, sql

提前感谢您的意见。

我有 3 个对象：

*   学校
*   营
*   教练

具有以下关系：

*   一所学校可以有多个营地。
*   一个学校可以有多个教练。
*   一个营地可以有多个学校。
*   一个训练营可以有多个教练。
*   一个教练可以有多个学校。
*   一个教练可以有多个阵营。

多对多，School_Camp，显然将一所学校链接到一个带有日期附加字段的营地，以标识营地的年份。但是一个营地可以有多个教练。

::School_Camp::

*   School_id
*   Camp_id
*   日期

设置另一个多对多 School_Camp_Coach 链接到 School_Camp 和 Coach 表对我来说会更好吗？

::School_Camp_Coach::

*   School_Camp_id
*   Coach_id

如果这是更有效的方法......我应该给 School_Camp 一个可以快速引用的独立 id 列，而不是使用三个字段作为标识符吗？

::School_Camp::

*   ID*
*   School_id
*   Camp_id
*   日期

**或者**

有一个多对多表 School_Camp_Coach 和 3 个外键会更好吗？

::School_Camp_Coach::

*   School_id
*   Camp_id
*   Coach_id
*   日期

我预见到的唯一问题是，您将有多个外键条目，但日期不同。

再次感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:00:30.467

这不是效率问题，而是正确性问题：您提出的两个选项没有对表中记录之间的相同关系*建模。*

数据库中的每条记录都意味着某种东西。如果连接表中记录的含义是“X 在学校 Z 的营地 Y 执教”，那么您应该选择选项 2；如果您正在寻找独立于“X 为学校 Z 执教”和“学校 Z 跑营 Y”的含义建模“X 在 Y 营地执教”的含义，那么您应该选择选项 1。

在这两种情况下，您都应该为您的联结记录提供独立的主键，而不是依赖于 ID 的三向组合：当您实现对联结表应用更正的代码时，它将简化您的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:58:07.443

请参阅@Ted Hopp 的评论。

鉴于数据（学校营地每分钟不会发生多次），我认为更新时间不如检索时间优先。如果这是真的，我会选择你的最后一个选项，3 个外键。

[这将是星型模式](http://en.wikipedia.org/wiki/Star_schema)的一个示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:15:37.560

对我来说，这个`Coach`实体看起来应该有我通常所说的一个`basket`，它可以与其他实体以多对多的关系链接。这就是我的意思：

```
# The coach model
CREATE TABLE coach(
    id INT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY(id),
    name VARCHAR(20),
    capacity INT
) ENGINE=InnoDB;

# The coach data - who is using the coaches
CREATE TABLE coach_basket(
    coach_id INT,
    FOREIGN KEY(coach_id) REFERENCES coach(id),
    entity_id INT, /* the school or camp id */
    entity_type ENUM("School","Camp"),
    fromdate DATETIME,
    todate DATETIME
) ENGINE=InnoDB; 
```

因此，现在您可以跟踪所有教练的使用情况，只需输入 entity_id（学校或营地 ID），以及他们每次使用教练的日期和时间。

您需要一个类似类型的表来存储连接的学校和营地，它可以如下所示：

```
# Store school-camp connections
CREATE TABLE connections(
    school_id INT,
    FOREIGN KEY(school_id) REFERENCES school(id),
    camp_id INT,
    FOREIGN KEY(camp_id) REFERENCES camp(id)
) ENGINE=InnoDB; 
```

非常简单，只需保存学校和营地 ID，因此如果您查询一个 school_id，您会得到许多与学校相关的营地，反之亦然。

剩下的就是你的`school`和`camp`表，它们是模型（如顶部的教练表）。

# android - 在任何 Android 屏幕上显示相同的字体大小

> ID：10306399
> 
> 赞同：0
> 
> 时间：2012-04-24T21:39:22.600
> 
> 标签：android, fonts

我希望文本在每个 Android 设备中具有相对相同的大小。

我有一个画布（全屏）。在这个画布的中间是一些文本。这段文字占了我屏幕的 20%，两边各占 40%。当在任何 Android 设备中查看文本时，我希望这些百分比是真实的。

我也想要垂直相同的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:20:46.997

我决定以像素为单位测量文本的宽度并保存该值。

当以不同分辨率加载文本时，我将原始像素与分辨率变化的比例相乘。我从一号文本开始循环，总是计算新的分辨率并检查最匹配原始分辨率的分辨率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T02:59:27.300

使用“sp”单位将大小放入[Dimension 资源中。](http://developer.android.com/guide/topics/resources/more-resources.html#Dimension)

# amazon-s3 - 谷歌云端硬盘是一个很好的网络应用数据存储解决方案吗？

> ID：10306400
> 
> 赞同：2
> 
> 时间：2012-04-24T21:39:43.240
> 
> 标签：amazon-s3, google-drive-api

我正在考虑将 Google Drive 用作我正在开发的 Web 应用程序的可扩展的基于云的数据存储解决方案（如 Amazon S3）。Google Drive 在这方面会是一个很好的解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T21:55:28.033

我不能谈论 Amazon S3，但 Google Drive 上的数据存储归用户所有，而不是应用程序所有。

因此，这实际上取决于您的 Web 应用程序的用例，如果您希望用户拥有数据并能够使用其他应用程序打开数据，请使用 Google Drive。

如果数据应该对用户隐藏，您可以使用其他云存储解决方案。

# java - Eclipse：如何使用重构工具将 attr 从公共更改为私有

> ID：10306402
> 
> 赞同：3
> 
> 时间：2012-04-24T21:39:56.547
> 
> 标签：java, eclipse, refactoring

例如：

```
 public class Person {

    public final int age;
   } 
```

eclipse中有没有办法执行以下自动\半自动（通过使用重构工具）

1）将年龄的可见性从公共更改为私人。

2）为年龄添加吸气剂

3) 代码中的任何地方都将 *.age 更改为 *.get_age() (* = person 类的实例)

而且我不是在寻找查找\替换解决方案... :)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T21:46:07.610

您可以使用“封装字段”重构。但是，它将同时生成 getter 和 setter 以保留对该字段的潜在写访问权限（仅当该字段不是最终的，感谢@Louis Wasserman）。毕竟，重构应该在不修改其功能的情况下重构代码。但至少您可以从那里继续并手动删除设置器以查看是否有任何需要修复的问题。

# php - 引用页面和 javascript 登录问题

> ID：10306403
> 
> 赞同：1
> 
> 时间：2012-04-24T21:39:57.887
> 
> 标签：php, javascript, mysql, ajax, redirect

我又遇到了一个引用问题，这次使用的是 javascript。

用户从索引页面单击 myaccount.php 页面，但由于他们未登录，因此显示登录屏幕。一旦他们成功登录，用户就会被带回（重定向）到索引页面。

我在 javascript 中使用此代码存储引用 URL：

```
 refering_url = document.referrer; 
```

然后像这样重定向

```
 window.location=refering_url; 
```

这不存储将用户重定向到 login.php 的 myaccount.php，而是存储用户单击 myaccount.php 链接的 index.php。

**请注意：登录是使用 AJAX 完成的，一旦用户输入正确的用户名和密码，AJAX 调用就会重新运行“接受”。我成功地将预期的 Ajax 返回值接收为“接受”。**

有没有办法解决这个问题。

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:46:07.560

尝试在 PHP 中使用**HTTP_REFERER**来获取 URI，然后在 PHP 中使用`location()`

我希望这会有所帮助。

# python - Python - telnet - 自动化 APC PDU

> ID：10306410
> 
> 赞同：1
> 
> 时间：2012-04-24T21:40:26.483
> 
> 标签：python, automation, telnet, apc, pdu

我正在尝试使用 python 的内置 telnet 功能自动关闭连接到 APC PDU 的设备。我相信我可以输入用户名和密码，但之后我无法继续。我的代码如下：

```
 telnet_session = telnetlib.Telnet(host=self.apc_ip)
    self.logger.info("Entering APC Username")
    telnet_session.read_until("User Name :")
    telnet_session.write(self.apc_username + "\n")
    self.logger.info("Entering APC Password")
    telnet_session.read_until("Password  :")
    telnet_session.write(self.apc_password + "\n")
    sleep(2)
    print telnet_session.read_all() 
```

我正在运行 Windows，所以我相信[https://github.com/quackenbush/APC](https://github.com/quackenbush/APC)不是一个选项，因为我无法安装 pexpect。

任何帮助，将不胜感激。

谢谢，

帕思

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T13:11:15.250

The issue was I wasn't sending the correct end line.

In windows it's \r\n, not \n

# header - PHPExcel：不仅在打印预览中显示页眉和页脚

> ID：10306415
> 
> 赞同：2
> 
> 时间：2012-04-24T21:41:22.910
> 
> 标签：header, footer, phpexcel

我正在通过 PHPExcel 库生成 excel 文档，我已经设置了页眉和页脚部分。但是当我打开文档时，我看不到页眉和页脚。查看打印预览时会显示页眉和页脚。此外，当我通过菜单插入页眉和页脚时，我可以看到我在 PHPExcel 中设置的页眉和页脚值。

现在有谁默认如何显示页眉和页脚？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:58:15.257

引用 Excel 帮助：

> 您可以在打印的工作表的顶部或底部添加页眉或页脚。例如，您可以创建一个包含页码、日期和时间以及文件名称的页脚。
> 
> 页眉和页脚不会显示在普通视图中的工作表上 - 它们仅显示在页面布局视图和打印页面上。您可以在可以看到页眉或页脚的页面布局视图中插入页眉或页脚，或者如果要同时为多个工作表插入页眉或页脚，则可以使用“页面设置”对话框。对于其他工作表类型，例如图表工作表，您只能使用“页面设置”对话框插入页眉和页脚。

所以我不希望 MS Excel 默认显示页眉和页脚

# audio - 复数如何捕获 FFT 结果中的相位、幅度和频率？

> ID：10306427
> 
> 赞同：4
> 
> 时间：2012-04-24T21:42:31.120
> 
> 标签：audio, signal-processing, fft

我知道幅度和相位是在 fft 结果的实部和虚部中捕获的。但是每个样本如何捕获阶段？

相位是否与时域提供的 N 个离散样本相关？

也就是说，如果输入样本在一秒钟内包含 44100 个样本，那么 FFT 的每个结果值是否代表相位的 1/44100？

例如，第一个 FFT 值是频率 1/44100，第二个值是 2/44100，等等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T21:46:59.450

FFT 的输出简单地表达了如何从谐波相关的正弦分量之和重建原始波形。

每个输出值表示相应分量的幅度和相位（即偏移角）。重要的是要注意每个组件都是一个复杂的正弦曲线（某种形式的东西`A * exp(j * 2pi * f * n + phi)`，不是`A * cos(2pi * f * n + phi)`）。

频率隐含在输出样本的索引中；如果您的采样率`fs`（以 Hz 为单位）并且您有一个长度`N`FFT，则对应于输出样本的中心频率`i`为`i*fs/N`（以 Hz 为单位）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T21:45:56.873

当您在问题的某些部分中表示“频率”时，我认为您是在说“相位”？

无论如何，如果您询问频率，它的工作原理与“输入”数据中的时间非常相似。您从时间序列数据开始，其中每个数组元素都在不同的时间。在 fft 之后，“输出”是相似的，但每个元素的频率不同。

它们的范围从恒定偏移到可能的最高频率，以统一的步骤，但实际顺序可能取决于您使用的实现。所以每个复数代表一个特定频率的幅度和相位 - 您可以从输出阵列中的位置计算出频率。

如果您有 N 个覆盖时间 T 的点，则最高频率为 N/(2T)，并且值是 1/T 的倍数（包括 0Hz - 恒定偏移）。例如，1 分钟内 60 个样本（N=60 T=60s）给出 0.5Hz 的最高频率。没有更高的频率，因为数据的采样不够好，无法清楚地挑选出来（例如，1 Hz 信号在每个样本上可能处于最大值，因此会显示为恒定信号）。这个限制称为[奈奎斯特频率](https://en.wikipedia.org/wiki/Nyquist_frequency)

（上面假设输出是一个复数数组；通常它是一个浮点数/双精度数组，您需要将复数从数组不同部分的实数和虚数拼凑起来——这一切都变得有点混乱，但是这个概念与返回一个复数值数组相同）。

ps通常当我必须从某个地方使用fft例程时，我会制作一些具有恒定偏移和两个已知频率正弦波的数据，然后对其进行fft并查看结果。如果您使每个组件的幅度不同，那么通常很明显事物是如何排序的。您还可以检查比例，因为有时它具有/省略了 2pi 的因子...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-24T23:58:08.907

相位与输入样本中周期性信号分量的时间偏移有关。

这是如何看待这个...

首先，回想一下**Fast FT与****Discrete FT**完全相同，只是以更有效的方式计算。因此，回到基础，我们将转换定义为：

X [k] [(0<=k<=N-1) =] [0<=n<=N-1 的]总和(x [n] * e ^(-j * 2*π * n * k/N) )

其中：
x [n]是输入样本
X [k]是输出/转换样本
N 是样本数

现在，这个复数指数 e ^(-j * 2*π * n * k/N)在几何上表示 Re/Im 平面中的圆（半径为 1，以 (0,0) 为中心）上的点。如果您忘记了这一点，请参阅[欧拉公式。](http://en.wikipedia.org/wiki/Euler%27s_formula)

对于一个固定值`k`（表示输出/变换中感兴趣的特定频率），`N/k`对于 all ，这个圆圈上只有不同的点`n`。

再看公式中的总和：

[0<=n<=N-1] (x [n] * e ^(-j * 2*π * n * k/N) )的总和

[在这个总和中，您通过输入信号 x n]将矢量从点 (0,0) 缩放到圆上的上述点。您正在使这些向量更长或更短。然后你把它们加起来。

如果碰巧 x [n]包含一个周期为 的周期信号`N/k`，那么该信号的所有最大值都将在圆上的一个点对齐并相互放大。信号的最小值和所有其他值也有贡献。

简而言之，您在这里所做的是将输入 x [n]缠绕到圆圈上。如果信号中存在周期性分量并且其周期与“周长”（=圆上的点数）匹配，则由于对齐的最大值和最小值，您将获得该周期/频率的峰值。如果周期与“周长”不匹配，则最大值会无处不在并相互抵消。这就是傅立叶变换的精髓，这就是它的工作原理和原因，没有魔法，没有真正复杂的数学，简单地将绳子缠绕到卷轴上。

您在 X [k]中得到的相位只是表示圆上所有最大值对齐的点。如果您将 x [n]中的周期信号移动一个或几个样本，则对齐点也会移动，并且相位会相应地改变。

这就是几何解释。

现在，您可以将其视为傅里叶变换的数学属性。

如果你有你的 x [n]和它的变换 X [k] =F{x [n] }，那么 x [n-m]的变换将是 F{x [n-m] } = F{x [n] } * e ^(-j * 2*π * k * m/ N) = X [k] * e ^(-j * 2*π * k * m/N)。这称为[移位定理/属性](http://en.wikipedia.org/wiki/Discrete_Fourier_transform#The_shift_theorem)。您应该能够轻松得出这一结论。e ^(-j * 2*π * k * m/N)的这个因子的大小为 1，并且仅在乘以 X [k]时才会改变相位。

相位与频率无关。

此外，采样信号 x [n]的最大频率是采样率的一半（实际上，仅比一半小一点，请参阅[奈奎斯特采样定理](http://en.wikipedia.org/wiki/Nyquist%E2%80%93Shannon_sampling_theorem)）。这意味着您的案例永远不会在 22050 Hz 或以上为您提供任何东西，因为更高频率的所有信息都已丢失到采样中。

[X k]值的一半将为您提供负频率的分量。那是因为当`k > N/2`你在圆上的点之间移动的方向反转时。因此，尽管输出/变换中有如此多的样本，但最大频率仍然小于采样率的一半。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T22:39:45.517

FFT 结果的频率不会被结果向量中的复数捕获。倍频器由包含复数的每个数组元素的索引捕获。然后你取索引并乘以一个频率比例因子，它与时域样本的采样率以及 FFT 长度的倒数有关，得到每个 FFT bin 的中心频率。

每个 FFT 结果向量元素表示的每个频率正弦波都有自己独立的相位，不与任何其他 bin 或数组元素共享。

如果您不知道 FFT 的长度，则频率将是未知的。所以你问题最后一部分的答案可能是未知或否。

# c# - 如何通过 c# 代码通过 http get 请求发送文件？

> ID：10306429
> 
> 赞同：0
> 
> 时间：2012-04-24T21:42:37.297
> 
> 标签：c#, c#-4.0, get, httpwebrequest, http-get

我正在尝试使用 sendgrid 的 Web API。要使用它，您需要对如下所示的 URL 发出 get 请求

```
sendgrid.com/api/mail.send.json?to=example%40exaple.com&from=example%40example&subject=Subject&text=Body&files=files%5Bfile1.doc%5D%3Dexample.doc%26files%5Bfile2.pdf%5D%3Dexample.pdf&api_user=usnermae&api_key=apikey 
```

让我困惑的是文件部分：

```
&files=files%5Bfile1.doc%5D%3Dexample.doc%26files%5Bfile2.pdf%5D%3Dexample.pdf&api_user=usnermae&api_key=apikey 
```

在 c# 代码中，如何将流或字节 [] 中的文件提供给 url？

这就是我最终执行请求的方式。

```
using (WebClient client = new WebClient())
{
    string text = client.DownloadString(url);
} 
```

到目前为止，这一切正常，除了附件之外，我已经编写了所有程序。谁能指出我正确的方向，以了解如何将文件放入获取请求的 URL 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:57:42.637

您应该使用`WebClient.UploadFile`方法，但为什么不简单地使用 SendGrid stmp 服务器？然后将此邮件作为任何其他邮件发送`SmtpClient`，示例如下：

[http://www.mattpaulson.com/2011/01/using-sendgrid-in-asp-net/](http://www.mattpaulson.com/2011/01/using-sendgrid-in-asp-net/)

# php - 使用 PHP 显示 RSS 提要属性

> ID：10306436
> 
> 赞同：0
> 
> 时间：2012-04-24T21:43:31.370
> 
> 标签：php, rss, magpie

我正在尝试使用 PHP 显示来自 RSS 提要的结果。我已经成功使用了 magpie [magpierss.sourceforge.net] 和 rss_php [rssphp.net]

但是，两个解析器在获取属性值时都遇到了问题，特别是 media:thumbnail

```
<media:content url="http://cache.wdcdn.net/cdn/asset/view/client/sfi/package/library/id/692313/format/o/h/5c5b86ff5dc804b2d314b3a9718bdef0/JelloAdultContentDirsCut.m4v?7a6013aef28682d61703dff120d21b12266b54a2a637283d7d4f0a0b41a1f35116ad845809e136636fd6663e34fb341ed348bcd006.m4v" fileSize="5936750" type="video/mp4" duration="32" height="360" width="640"/>

<media:thumbnail url="http://cache.wdcdn.net/cdn/asset/view/client/sfi/package/library/id/692313/format/t/size/lg/h/c374cb3c669fdb346ad82adb16b41b4a/library_692313_lg.jpg?7a6013aef28682d61703dff120d21b12266b54a2a637283d7d4f0a0b41a1f35116ad845809e136636fd6663e34fb341ed348bcd006.jpg" height="360" width="634"/>

<media:thumbnail url="http://cache.wdcdn.net/cdn/asset/view/client/sfi/package/library/id/692313/format/t/size/sm/h/c374cb3c669fdb346ad82adb16b41b4a/library_692313_sm.jpg?7a6013aef28682d61703dff120d21b12266b54a2a637283d7d4f0a0b41a1f35116ad845809e136636fd6663e34fb341ed348bcd006.jpg" height="102" width="180"/>

<media:credit role="client" scheme="urn:feeds-wiredrive-com:credits"><![CDATA[Jell-O]]></media:credit>

<media:credit role="director" scheme="urn:feeds-wiredrive-com:credits"><![CDATA[Jerry Simpson]]></media:credit>

<media:credit role="agency" scheme="urn:feeds-wiredrive-com:credits"><![CDATA[CPB]]></media:credit>

<media:keywords><![CDATA[Chocolate, dessert, fruit, Jell-O, pudding]]></media:keywords></item> 
```

任何提示或帮助？我难住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T19:56:36.773

我的解决方案是使用 simplepie。[simplepie.org](http://simplepie.org)非常好的解析器，并为此内置了类。[get_thumbnail()](http://simplepie.org/wiki/reference/simplepie_enclosure/get_thumbnail)和许多其他有用的类。推荐的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:07:29.617

也许您可以尝试使用这些预建类之一吗？[http://php.net/manual/en/refs.xml.php](http://php.net/manual/en/refs.xml.php) 例如，试一试 simplexml。

# c# - Linq-to-SQL 在 where 子句中连接两列

> ID：10306437
> 
> 赞同：1
> 
> 时间：2012-04-24T21:43:32.803
> 
> 标签：c#, asp.net, linq, linq-to-sql

我有一张这样的桌子：

```
prefix | value
 ABC     1234
 ABC     5678
 DEF     1234 
```

是否可以创建一个 linq 查询，在 where 子句中连接前缀和值以进行比较？我试过这个，但它总是返回一个空集：

```
selected =
            from i in dc.items
            where i.prefix + i.value == "ABC1234"
            select i; 
```

编辑：以下 T-SQL 得出了正确的结果：

```
 WHERE LTRIM(RTRIM([prefix])) + LTRIM(RTRIM([value])) = 'ABC1234' 
```

Edit2：以下结合了以下大部分答案的以下内容仍然无效：

```
where (String.Concat(i.prefix.Trim(), i.value.Trim())) == "ABC1234" 
```

Edit3：所以我已经让它工作了，但我不知道为什么。我已经接受了答案，但如果有人发布它为什么有效，我将不胜感激:)

这有效（返回 n 行）：

```
var temp = dc.items.Where(i => i.prefix.Trim() + i.prefix.Trim() == "ABC1234"); 
```

这不起作用（返回 0 行）：

```
var temp =
            from i in dc.items
            where i.prefix.Trim() + i.value.Trim() == "ABC1234"
            select i; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T21:49:35.033

我不会说英语。试试这个：

```
var selected = dc.Where(x => x.prefix + x.value == "ABC1234"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T21:59:21.233

假设这`value`不是一个字符串，你可以像这样连接它们：

```
var selected = dc.Items.Where(x => string.Concat(x.prefix, x.value) == "ABC1234"); 
```

The benefit to using `string.Concat` is that all of the arguments will be converted to string.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T21:52:06.633

```
where (i.prefix + i.value) == "ABC1234" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T21:57:12.877

尝试选择这个

```
selected =
 from c in db.items

 select new {

 Name = string.Format("{0}{1}", c.prefix , c.value)

}; 
```

看看你有没有“ABC1234”

# ios - 将方法名称传递给状态更改对象的选项

> ID：10306440
> 
> 赞同：0
> 
> 时间：2012-04-24T21:43:46.440
> 
> 标签：ios

我有一个状态驱动的类，它根据发生的情况改变状态。该类有一个 state 属性，该属性从许多地方调用，这些地方以各种方法散布在整个代码中。

因此，发现状态更改逻辑是什么并不容易/显而易见，因此我正在考虑将状态更改集中在一个专用方法中，类似于以下伪代码

```
- (void) updateState: (Param) action
{
   switch (self.currentState)
     case: EStateA: 
           if (action == connectionSuccesful)
              self.currentState = EStateB;
           else
              self.currentState = EStateC;
     break;
}

- (void) delegateCallbackConnectionSuccess
{
    [self updateState: Param];
} 
```

所以 updateState 方法需要知道发生了什么动作才能改变状态，一个动作被封装为一个方法，因此 updateState 方法需要知道是什么方法调用它。

所以我的问题是如何最好地实现这一点，Param 应该是什么类型？有什么选择？SEL，@selector，NSInvocation，其他东西？

TIA

（实现一个完整的状态模式似乎有点过头了，除非它在 ​​iOS 中很容易）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:32:17.707

为什么不让这些方法将状态传递给 updateState:？

例如

```
typedef enum {
    EStateA,
    EStateB
} EState;

- (void) updateState: (EState) newState {
    switch (self.currentState): {
        ...
    }
    self.currentState = newState;
}

- (void) delegateCallbackConnectionSuccess {
    [self updateState:EStateB];
} 
```

# c# - 什么可能导致此访问被拒绝错误？

> ID：10306443
> 
> 赞同：1
> 
> 时间：2012-04-24T21:44:07.887
> 
> 标签：c#, .net, windows-7, process, directory

**编辑：**使用“文档”而不是“我的文档”可以消除错误。还建议我使用 Windows 特殊文件夹而不是绝对路径。

我正在尝试用我正在编写的应用程序替换我桌面上的所有快捷方式，该应用程序将拥有自己的快捷方式版本。我计划为新快捷方式提供一些与旧快捷方式相同的功能。在做任何其他事情之前，我认为打开快捷方式指向的文件或文件夹很重要。这是一段示例代码：

```
public partial class Form1 : Form
{
    Process p1, p2, p3, p4;

    public Form1()
    {
        InitializeComponent();
        p1 = new Process();
        p2 = new Process();
        p3 = new Process();
        p4 = new Process();

        p1.StartInfo.FileName = "cmd";
        p2.StartInfo.FileName = "c:\\Users\\Cheese\\My Documents";
        p3.StartInfo.FileName = "c:\\Users\\Cheese\\AppData";
        p4.StartInfo.FileName = "c:\\Program Files (x86)";
    }

    private void button1_Click(object sender, EventArgs e)
    {
        p1.Start();
    }
    private void button2_Click(object sender, EventArgs e)
    {
        p2.Start();
    }
    private void button3_Click(object sender, EventArgs e)
    {
        p3.Start();
    }
    private void button4_Click(object sender, EventArgs e)
    {
        p4.Start();
    }

} 
```

![访问被拒绝错误](../Images/38af569c4730695c8c3b277aaa15daca.png)

这是在 Windows 7 家庭高级版上。在 Visual C# 2010 Express 中调试时出现错误。我在同一个驱动器上的另一个分区上打开了其他几个文件夹，如 System32、AppData 和各种文件夹。我能够打开各种音乐文件并运行不同的程序。除了“我的文档”之外，一切似乎都运行良好。我认为 Windows 文件夹会比个人文件的默认位置有更大的限制。我认为这不是真正的权限问题，但我什至无法猜测可能是什么问题。我可以用资源管理器打开我的文档。我可以将文件移入和移出目录。

这似乎是一件很简单的事情。我知道有很多我不完全了解 Windows 是如何工作的，但是这种情况和其他一些情况让我觉得我可能对 Windows 真的一无所知。我可以查看哪些好书或网络资源来很好地掌握这个操作系统？从新手的角度来看，可能侧重于文件管理和系统权限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:54:58.537

你永远不应该使用这些硬编码的路径。
正确的方法是 Environment.SpecialFolder 枚举加上 Environment.GetFolderPath() 像这样

```
string myDocumentsPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments); 
```

可以[在此处找到其他“SpecialFolder”枚举](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)

**将GetFolderPath**与 SpecialFolder 枚举一起使用非常重要，因为它会返回针对不同操作系统正确调整的位置、操作系统的本地化以及用户可以对其中一些位置进行的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:52:42.610

在 Windows 7 中，“我的文档”已简单地重命名为“文档”。参见[维基百科](http://en.wikipedia.org/wiki/My_Documents)。您尝试打开的路径在您的操作系统中不存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T22:16:49.837

正如评论的那样，

在 Windows 7 下，“我的文档”是指向“文档”的连接点链接，尝试在连接点上启动进程将失败并出现此错误。改为启动“c:\Users\Cheese\Documents”。

或者，如果这是当前用户我的文档文件夹，您应该向系统询问其路径。

```
var path=System.Environment.GetFolderPath(System.Environment.SpecialFolder.MyDocuments); 
```

# jquery - 当使用 .empty() 清空 div 时，不能再解析为可折叠列表

> ID：10306444
> 
> 赞同：0
> 
> 时间：2012-04-24T21:44:09.483
> 
> 标签：jquery, html, append, collapse

以下是我所做的三个解析示例....第一个工作正常，但由于追加而变得越来越长....第二个和第三个仅显示第一个条目，因为 .empty。

据我了解，最后一个示例是在重新解析之前清除旧条目的正确方法，因为它针对内部 div。

奇怪的是，它们在呈现时看起来相同的元素，但我假设在某些地方删除了格式......

有什么想法吗 ？

TIA

人族

有效，但由于附加而变长

```
$('#eventlist').append($('<div data-role="collapsible" data-collapsed="true">').html('<h3>'+CurrentRoadworks.dataitem.ROADMAINTENANCETYPE+' - '+CurrentRoadworks.dataitem.GOFL_LOCCGRP_TPEGILOC_FRAMEDPOINT_NAME_DESCRIPTOR_VALUE+'</h3><p>'+CurrentRoadworks.dataitem.NONGENERALPUBLICCOMMENT_COMMENT_VALUE+'</p>Number of Lanes Retricted '+CurrentRoadworks.dataitem.IMPACT_IMPACTDETAILS_NUMBEROFLANESRESTRICTED+'<br/>Expected Impact '+CurrentRoadworks.dataitem.IMPACT_IMPACTONTRAFFIC+'<br/>Expected Delay '+CurrentRoadworks.dataitem.IMPACT_DELAYS_DELAYTIMEVALUE+'<br/>Lat / Long '+CurrentRoadworks.dataitem.GOFL_LOCCGRP_TPEGILOC_FROM_POINTCOORDINATES_LATITUDE+' / '+CurrentRoadworks.dataitem.GOFL_LOCCGRP_TPEGILOC_FROM_POINTCOORDINATES_LONGITUDE+'<br/>Valid to  '+CurrentRoadworks.dataitem.VALIDPERIOD_ENDOFPERIOD+'</div>')); 
```

解析时仅显示第一个条目...

```
 $('#eventlist').empty.append($('<div data-role="collapsible" data-collapsed="true">').html('<h3>'+CurrentRoadworks.dataitem.ROADMAINTENANCETYPE+' - '+CurrentRoadworks.dataitem.GOFL_LOCCGRP_TPEGILOC_FRAMEDPOINT_NAME_DESCRIPTOR_VALUE+'</h3><p>'+CurrentRoadworks.dataitem.NONGENERALPUBLICCOMMENT_COMMENT_VALUE+'</p>Number of Lanes Retricted '+CurrentRoadworks.dataitem.IMPACT_IMPACTDETAILS_NUMBEROFLANESRESTRICTED+'<br/>Expected Impact '+CurrentRoadworks.dataitem.IMPACT_IMPACTONTRAFFIC+'<br/>Expected Delay '+CurrentRoadworks.dataitem.IMPACT_DELAYS_DELAYTIMEVALUE+'<br/>Lat / Long '+CurrentRoadworks.dataitem.GOFL_LOCCGRP_TPEGILOC_FROM_POINTCOORDINATES_LATITUDE+' / '+CurrentRoadworks.dataitem.GOFL_LOCCGRP_TPEGILOC_FROM_POINTCOORDINATES_LONGITUDE+'<br/>Valid to  '+CurrentRoadworks.dataitem.VALIDPERIOD_ENDOFPERIOD+'</div>')); 
```

解析时仅显示第一个条目...

```
$('#eventlist div').empty(); 
$('#eventlist').append($('<div data-role="collapsible" data-collapsed="true">').html('<h3>'+CurrentRoadworks.dataitem.ROADMAINTENANCETYPE+' - '+CurrentRoadworks.dataitem.GOFL_LOCCGRP_TPEGILOC_FRAMEDPOINT_NAME_DESCRIPTOR_VALUE+'</h3><p>'+CurrentRoadworks.dataitem.NONGENERALPUBLICCOMMENT_COMMENT_VALUE+'</p>Number of Lanes Retricted '+CurrentRoadworks.dataitem.IMPACT_IMPACTDETAILS_NUMBEROFLANESRESTRICTED+'<br/>Expected Impact '+CurrentRoadworks.dataitem.IMPACT_IMPACTONTRAFFIC+'<br/>Expected Delay '+CurrentRoadworks.dataitem.IMPACT_DELAYS_DELAYTIMEVALUE+'<br/>Lat / Long '+CurrentRoadworks.dataitem.GOFL_LOCCGRP_TPEGILOC_FROM_POINTCOORDINATES_LATITUDE+' / '+CurrentRoadworks.dataitem.GOFL_LOCCGRP_TPEGILOC_FROM_POINTCOORDINATES_LONGITUDE+'<br/>Valid to  '+CurrentRoadworks.dataitem.VALIDPERIOD_ENDOFPERIOD+'</div>')); 
```

html....

```
<div data-role="page" id="events">
<div data-role="header"  data-theme="a" data-backbtn="false" class="ui-header ui-bar-a">
    <h1>Events</h1>
</div>
<div data-role="navbar" data-theme="a" >    
    <ul data-role="listview">
        <li><a href="#home">Home</a></li>
        <li><a href="gmap.html" rel="external">Map</a></li>
        <li><a href="#settings">Settings</a></li>
    </ul>     
</div>
<div id="eventscontent" data-role="content" data-theme="a" ><div id="loadingeventdata" align="middle" >Data Loading.... <img src="images/ajax-loader.png" width="35" height="35" align="middle"></div>
<div id="eventlist" data-role="collapsible-set" data-theme="c" ><!--Create dynamic data via URL from GPS & other variables   --></div>
</div> 
```

# bash - bash 陷阱的澄清

> ID：10306448
> 
> 赞同：0
> 
> 时间：2012-04-24T21:44:35.967
> 
> 标签：bash

我目前正在学习 bash 教程：

[http://linuxconfig.org/Bash_scripting_Tutorial](http://linuxconfig.org/Bash_scripting_Tutorial)

我来到了我难以理解的部分：

```
#!/bin/bash
# bash trap command
trap bashtrap INT
# bash clear screen command
clear;
# bash trap function is executed when CTRL-C is pressed:
# bash prints message => Executing bash trap subrutine !
bashtrap()
{
    echo "CTRL+C Detected !...executing bash trap !"
}
# for loop from 1/10 to 10/10
for a in `seq 1 10`; do
    echo "$a/10 to Exit." 
    sleep 1;
done
echo "Exit Bash Trap Example!!!" 
```

你到底在哪里指定 ok 陷阱`CTRL+C`？这条线`trap bashtrap INT`？INT 意味着什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T21:50:25.310

`INT`是`SIGINT`或“键盘中断”，`Ctrl`+`C`导致的信号。

如果您使用的是 Linux，请参阅手册页`signal(7)`以获取有关`SIGINT`和其他信号的更多信息。

# iphone - 添加 uilabels

> ID：10306450
> 
> 赞同：0
> 
> 时间：2012-04-24T21:44:36.480
> 
> 标签：iphone, ios

我有一个简单的问题，我有一个带有 uislider 的应用程序，它可以更改 uilabels 中的数字。我想将所有这些 uilabels 添加在一起并拥有一个总 uilabel。我希望这能解释清楚吗？我已经看了又试了又试了。一直在死胡同！！！

抱歉，如果您认为这是一件简单的事情，但我无法解决。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:00:02.667

我真的很想知道你看过和尝试过什么！

```
int sum  = [label1.text intValue] + [label2.text intValue];
totallabel.text = [NSString stringWithFormat:@"%d",sum]; 
```

# java - 来自 simpleJdbcTemplate 的方法 query() 没有返回值

> ID：10306451
> 
> 赞同：0
> 
> 时间：2012-04-24T21:44:37.993
> 
> 标签：java, templates, jdbc, methods

我的课是这样的：

```
public class DBConection extends SimpleJdbcDaoSupport implements ElectionsDao{
public List<String> getDates(){
        try{
            String sql = "SELECT electiondate FROM electiondate";
            List<String> dates = new ArrayList<String>();
            dates = getSimpleJdbcTemplate().query(sql,  
                    ParameterizedBeanPropertyRowMapper.newInstance(String.class));

            System.out.println(dates.size());
            System.out.println(dates.get(0));

            return dates;
        }catch(DataAccessException ex){
            throw new RuntimeException(ex);
        }
    }
} 
```

我试图从 SQL 语句中获取值，然后将它们作为字符串对象添加到列表中，但是当我运行我的项目时，它返回值的数量，但全部为空白。有人知道为什么吗？我有我的配置文件和一切。我认为定义`query()`. 我正在使用 Spring 框架。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T15:10:05.787

我已经弄清楚该怎么做。

我是这样做的：

```
public class DBConection extends SimpleJdbcDaoSupport implements ElectionsDao{
    public List<String> getDates(){
        List<String> dates = new ArrayList<String>();
        try {
            dates = getSimpleJdbcTemplate().query("SELECT electiondate FROM electiondate";, new StringRowMapper());
        } catch (DataAccessException ex){
        throw new RuntimeException(ex);
        }
        return dates;
    }

    protected static final class StringRowMapper implements ParameterizedRowMapper<String> {
        public String mapRow(ResultSet rs, int line) throws SQLException {
            String string = new String(rs.getString("electiondate"));
            return string;
        }
    }
} 
```

我必须做一个“StringRowMapper”内部类才能工作。

希望对你有帮助！

# javascript - 同一页面上有多个 JQuery 插件

> ID：10306455
> 
> 赞同：0
> 
> 时间：2012-04-24T21:44:55.093
> 
> 标签：javascript, jquery, asp.net

我想知道是否有一个简单的解决方案：我在网格中定义的元素上多次创建了以下 JQuery 插件

```
(function ($) {
    $.fn.MyPlugin = function () {

        $(this).mouseenter(function () {
           //do something for single plugin instance
        });
    };

})(jQuery); 
```

但是，我怎样才能唯一地识别我正在触发鼠标输入功能的插件实例。使用当前设置，我引用了所有实例，但我只想触发其中一个的 mouseenter。

插件是这样创建的：

```
$(".someClass").MyPlugin(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:56:41.250

您不需要多次创建插件，这就是它被称为插件的原因。您只需将其插入任何您想要的地方。查看[jquery 插件创作页面](http://docs.jquery.com/Plugins/Authoring)，了解如何开始编写插件。它提供了一些不错的模板。

在您的代码`$(this)`中是多余的，因为`this`已经是一个 jQuery 对象。然后，您希望始终`return this`在插件中保持可链接性。您可以`$(this)`在`mousenter`事件内部使用来引用 DOM 中插件正在处理的当前元素。

`return this.each()`有时，循环每个元素并做一些事情也很有用。在这种情况下，由于您附加了一个事件，因此它无济于事，因为事件适用于项目集合中的每个项目；在这种情况下，`this`指的是您调用插件的集合：

```
$.fn.MyPlugin = function () {

    return this.mouseenter(function () {
       $(this).something();
       //do something for single plugin instance
    });

}; 
```

然后你会这样调用插件：

```
$('elements').MyPlugin(); 
```

只需在您想要的元素上调用插件，这些元素就会`mouseenter`附加事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:52:07.720

您使用插件的 html 是什么？mouseenter 可以连接到一个元素 id，而不是调用 (this).mouseenter，而是通过 id 调用 div（即 $("div.somediv").mouseenter(function(){ .... 你想要做什么。 ....}

jquery 站点显示了一个使用多个鼠标事件嵌套 div 的示例。

[http://api.jquery.com/mouseenter/](http://api.jquery.com/mouseenter/)

# android - 适用于 Google Drive 的 Android API？

> ID：10306456
> 
> 赞同：18
> 
> 时间：2012-04-24T21:44:58.197
> 
> 标签：android, google-drive-api

目前发布的 API 似乎专注于 Chrome 商店应用程序。

是否会有适用于 Android 的 API，或者是否可以使用现有的 API，例如 Google 文档列表数据？如果是这样，应该使用哪个 URL 来列出/访问文件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-24T21:48:57.517

**编辑：随着文档列表 API 的弃用，这不再是最好的解决方案**

您可以使用现有的 Documents List API 访问 Drive 资源，它们共享相同的端点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T20:07:33.830

[这](https://developers.google.com/drive/android/get-started)是将您的应用程序与 Google Drive 集成的指南

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T04:29:19.637

不幸的是，文档列表 API 主要记录在 .NET 中（只是 oauth 在 java 中）。对于我的一生，我正在努力将 gdata jar 中的端点放在一起以上传一个简单的文件。尝试使用 .net 示例作为指南，但在 java 中找不到可比较的类。

# php - 如何使用outlook和php发送邮件？

> ID：10306458
> 
> 赞同：0
> 
> 时间：2012-04-24T21:45:08.087
> 
> 标签：php, outlook

我创建了一个小型 C# 控制台应用程序来使用非常简单的 Outlook 发送邮件

```
Outlook.Application oApp = new Outlook.Application();
            //Create the new message by using the simplest approach.
Outlook.MailItem oMsg = (Outlook.MailItem)oApp.CreateItem(Outlook.OlItemType.olMailItem);
            oMsg.Recipients.Add("xxx@xxx.com");  //////////////////problem line 
            oMsg.Subject = "aaaa";
            oMsg.Body = "body";
            //Send the message.
            oMsg.Save();
            oMsg.Send(); 
```

此代码需要从 php 代码中调用。

1）它在控制台中工作得很好。

2）当我从 php 调用时，我得到一个错误。我注意到从 php 调用此控制台应用程序时会在系统用户中运行。所以我让outlook作为系统运行，但我仍然得到这个错误。我正在运行 Apache 服务器。

System.Runtime.InteropServices.COMException (0x80004004)：在 Microsoft.Office.Interop.Outlook._MailItem.get_Recipients() 在 SyncEmail.Program.sendMailUsingOutlook（字符串收件人，字符串正文，字符串主题）在 D:\NotEncrypted\Projects\SyncEmail\SyncEmail\Program.cs:line 121

我正在拔头发，看着不同的东西。任何帮助，将不胜感激。感谢您阅读我的帖子。

在我说有些人说使用 php 之后，我决定走 php 路线并编写此代码并得到相同的错误。

```
if (!defined(‘olMailItem’)) define(“olMailItem”,0);
$objApp = new COM(“Outlook.Application”);
$myItem = $objApp->CreateItem(olMailItem);
$myItem->To=’xxxx@xxx.com’;
$myItem->SentOnBehalfOfName = ‘yyy@xxyyx.com’;
$myItem->Subject=”This is a test”;
$myItem->Body=”This is a Body Section now…..!”;
$myItem->Send(); 
```

我得到这个错误

致命错误：在 D:\NotEncrypted\xampp\htdocs\copper\system\modules\projects\index.php 第 11251 行 (!) com_exception: 错误 [0x80004004] D:\ NotEncrypted\xampp\htdocs\copper\system\modules\projects\index.php 在第 11251 行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T21:50:32.597

`PHP`可以直接完成JOB

```
$oApp  = new COM("Outlook.Application") or die('error');
$oMsg  = $oApp ->CreateItem($oApp->OlItemTyp->olMailItem);
$oMsg ->Recipients->Add("xxx@xxx.com");
$oMsg ->Subject="aaaa";
$oMsg ->Body="body";
$oMsg ->Save();
$oMsg ->Send(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:53:47.363

从您的 C# Outlook 项目创建一个服务器，并监听端口（例如 3455）并在您的 php 脚本中使用 CURL 连接到您的服务器（C# 程序）

# java - csv文件的格式问题

> ID：10306461
> 
> 赞同：1
> 
> 时间：2012-04-24T21:45:17.657
> 
> 标签：java, excel, csv, jersey, jax-rs

好的，我已经检查了[这个 SO question](https://stackoverflow.com/questions/137359/excel-csv-number-cell-format)，但它根本没有帮助我。

我需要为用户获取一个 csv 文件，以便他们可以将其导出到 PeopleSoft。其中一个字段 (batch_id) 必须是 4 位数字，目前 Excel 会不断删除那些前导零。我还在 TextPad 中打开了 csv 文件并验证了那些零已经消失了。

所以继承人的过程：

浏览器指向 myapp/Batch/course 如下图：

```
 @GET
    @Path( "Batch/{course}" )
    @Produces( "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" )
    @HttpHeader( values="Content-Disposition=attachment;filename=Batch.csv" ) 
    public String getNextBatch ( @PathParam( "course" ) String course )
    {
      ...
    } 
```

在该方法中，查询 Oracle 数据库并将数据作为 XML 发送回（在 XML 中，batch_id 具有正确的位数）。然后通过 StringBuffer.append() 将该 XML 处理为一个用逗号分隔的长字符串，然后该方法返回该字符串。@Produces 属性获取该字符串并确保 Excel 处理它，并下载文件。

我可以通过在每个逗号后附加制表符来让它显示为 4 位数字，但是当它加载到 PeopleSoft 时它会爆炸。如果我单引号它（单个前导引号或引用整个batch_id），我也可以让它以正确的4位数字出现，但同样存在PeopleSoft上传的问题。

更多信息：我正在附加数据（但在循环中）：

```
 NodeList participants = XmlUtil.selectNodeList( doc, "Batch/row" );
    buffer.append( "\t" + item.getAttribute( "batchid" ) ); 
```

有谁知道如何让 Excel 正常运行？

编辑：我标记了一个解决方案，因为在任何其他情况下它都会起作用。像我现在这样尝试将数据吐出到 Excel 只是一个杂物，所以我将用不同的方式重写它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T01:19:31.697

将文件保存在本地，然后直接用TextPad打开它，前导零会在那里。

不要在 Excel 中打开 CSV 文件。Excel 将重新格式化它并去除前导零。

自己尝试一下，在TextPad中手工制作一个简单的CSV文件，保存，然后在Excel中打开。前导零将被删除。

如果您需要它在 Excel 中正确打开，请使用专为 Excel 设计的格式。让用户下载 XLS 文件或 XLSX 文件。像 Apache POI [http://poi.apache.org/spreadsheet/quick-guide.html](http://poi.apache.org/spreadsheet/quick-guide.html)这样的库是一个很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T01:31:22.243

您可以在 Excel 中打开该文件而不会丢失零。

执行以下操作：

1 - Open Excel; 2 - Click - File->Import and Select the CSV File you want to view in Excel; 3 - Select Delimited and Click Next; 4 - Select Comma as Delimiter and click Next; 5 - Mark Column Data as Text at the column you don't want to lose the zeroes on the left; 6 - Finish.

# assembly - HCS12——程序陷入无限循环

> ID：10306466
> 
> 赞同：0
> 
> 时间：2012-04-24T21:45:54.377
> 
> 标签：assembly

我是组装新手。我正在使用 HCS12 和 AsmIDE 软件。组装并下载程序后，我运行“g $1500”（其中 $1500 可以是任何其他地址）。然后终端中没有任何更新，我无法输入任何内容。它似乎陷入了无限循环。

还有一次，我的程序完美地运行了一次。我去了一个不同的程序，结果卡住了。所以，我回到第一个完美运行的程序，现在它也不会运行。

有人知道怎么修这个东西吗？

程序示例：

```
 org $1500

      ldx #5

      end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:49:07.790

您没有正确退出程序。它执行`ldx`指令，然后继续执行内存中程序之后发生的任何事情。`rts`用before结束例程，`end`看看它是否按预期工作。

# css - Unicode White Heart 字符在 OS X 10.7.3 的 Win 7 中的不同显示

> ID：10306469
> 
> 赞同：1
> 
> 时间：2012-04-24T21:45:59.353
> 
> 标签：css, unicode

我使用 css 显示 unicode 字符，我在 Windows 7 中得到了不同的显示；在 os x 10.7.3 中，它是一颗白心：[http](http://dev.bowdenweb.com/a/i/delete/white-heart-os-x-10.7.3-chrome-20.0.1096.1-dev.png) ://dev.bowdenweb.com/a/i/delete/white-heart-os-x-10.7.3-chrome-20.0.1096.1-dev.png in win 7 它的三行[http://dev.bowdenweb.com/a/i/delete/white-heart-win-7-chrome-20.0.1105.2-dev-m.png](http://dev.bowdenweb.com/a/i/delete/white-heart-win-7-chrome-20.0.1105.2-dev-m.png) 如果它是无法显示字符的正常框，我不会那么迷茫。是我的桌面吗？你可以在这里看到原始页面：http: [//dev.bowdenweb.com/css/unicode/unicode-playing-card-block-css.html](http://dev.bowdenweb.com/css/unicode/unicode-playing-card-block-css.html)

# r - 使用 Mirai 的 XLConnect 格式化数字

> ID：10306474
> 
> 赞同：1
> 
> 时间：2012-04-24T21:46:17.260
> 
> 标签：r

我正在准备一份报告，我需要或多或少地每周重新运行一次。它需要在 Excel 中发送给客户端，我一直在为 R 使用 XLConnect 包并取得了巨大的成功，但我遇到了一个我自己似乎无法解决的问题。

给定以下代码：

```
simple <- data.frame(a = c(1,2,3,,4,5), b = c(1,2,3,4,5))

library(XLConnect)
prcntg <- createCellStyle(wb)
setDataFormat(prcntg, format = "0.0")

wb <- loadWorkbook("foo.xlsx", create = FALSE)

sheet <- "bar"
createSheet(wb, sheet)

writeWorksheet(wb, simple, sheet = sheet)
rows <- 1:5
cols <- 1:2
setCellStyle(wb, sheet = sheet, row = rows, col = cols, cellstyle = prcntg) 
```

我希望将值打印为：

```
a   | b
1.0 | 1.0
2.0 | 2.0
3.0 | 3.0
etc. 
```

但是，他们进入工作表是：

```
a | b
1 | 1
2 | 2
3 | 3
etc. 
```

我如何得到前者而不是后者。根据我在这里看到的文档和帖子：[https ://miraisolutions.wordpress.com/2011/08/31/xlconnect-a-platform-independent-interface-to-excel/](https://miraisolutions.wordpress.com/2011/08/31/xlconnect-a-platform-independent-interface-to-excel/)

我觉得我做的一切都是对的，但显然我不是。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:17:20.333

以下似乎对我有用：

```
wb <- loadWorkbook("~/Desktop/foo.xlsx", create = TRUE)
prcntg <- createCellStyle(wb)
setDataFormat(prcntg, format = "0.0")

sheet <- "bar"
createSheet(wb, sheet)

writeWorksheet(wb, simple, sheet = sheet)
rows <- 2:6
cols <- 1:2
setCellStyle(wb, sheet = sheet, row = rep(2:6,times = 2), col = rep(1:2,times = 6), cellstyle = prcntg)
saveWorkbook(wb) 
```

这运行（带有警告）。请注意 中的 row 和 col 参数的规范`setCellStyle`。但是，我不愿意假设这也适用于您，因为 XLConnect 最近对我来说有点不稳定（我在 OS X 上，必须在 2.15.0 上从源代码构建它，因为它失败了CRAN 检查所以没有二进制文件）。

# php - PHP - 将音频数据写入文件会导致空文件

> ID：10306475
> 
> 赞同：0
> 
> 时间：2012-04-24T21:46:19.980
> 
> 标签：php, ios, file, audio, base64

我正在尝试将音频文件保存在我的服务器上。我在 iPhone 上以 PCM 格式录制音频，并将编码为 Base64 字符串的数据发送。我尝试了 3 种不同的方法来保存文件，所有 3 种方法都创建了一个空的 wav 文件：

尝试1：

```
$file = fopen($filePath, 'w');
fwrite($file, base64_decode($this->data['Voicenote']['audio_data']));
fclose($file); 
```

尝试2：

```
file_put_contents($filePath, base64_decode($this->data['Voicenote']['audio_data'])); 
```

尝试 3：

```
$audioFile = new File($filePath, true);
$audioFile->write(base64_decode($this->data['Voicenote']['audio_data']));
$audioFile->close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T20:46:55.860

我设法按照这个问题中的代码解决了[这个问题](https://stackoverflow.com/questions/8564833/ios-upload-image-and-text-using-http-post)

在我的 PHP 代码中，我执行了以下操作：

```
move_uploaded_file($_FILES['audio_file']['tmp_name'], $filePath); 
```

这样做我能够正确地将我的音频文件保存在服务器上。

# javascript - 当输入类型文本小于 0 或大于 24 时，如何禁用输入类型按钮？

> ID：10306477
> 
> 赞同：0
> 
> 时间：2012-04-24T21:46:26.670
> 
> 标签：javascript, html, css, button

我需要制作一个积分计算器，用户将输入对象的数量，网站会告诉他们值多少积分。到目前为止，我设法做到了，但我想不出任何方法可以阻止用户使用比现有更多的对象。这是代码：

```
 <form>
 <input type="text" name="ob1" size="3" value="0/24" onClick="this.value='';" /> object      <input type="text" name="ob2" size="3" value="0/24" onClick="this.value='';" />
 <br>
 <input type="button" value="Calculate Points" onClick="document.getElementById('calcu').innerHTML='Supply points are ' + (ab1.value*5) +'. Tower points are '+(ab2.value*10)+'.'" name="clc"></form>
 <div id="calcu"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:02:23.650

jsFiddle（[http://jsfiddle.net/gP7SP/15/](http://jsfiddle.net/gP7SP/15/)）

我会做一些假设，但在这里你去：

```
<form>
    Supply:<input type="text" id="supply" name="ob1" size="3" value="0/24" onClick="this.value='';" />
    Tower:<input type="text" id="tower" name="ob2" size="3" value="0/24" onClick="this.value='';" />
    <br/>
    <input type="button" value="Calculate Points" onClick="calculate()" name="clc">
</form>

<div id="calcu"></div>

<script type="text/javascript">
    function calculate()
    {
        // Retrieve the supply and tower values
        var supply = parseInt( document.getElementById("supply").value );
        var tower = parseInt( document.getElementById("tower").value );

        // Make sure supply is less than 24
        if ( supply > 24 )
        {
            alert( "Supply cannot be greater than 24" );
        }
        // Make sure tower is less than 24    
        else if ( tower > 24 )
        {
            alert( "Tower cannot be greater than 24" );
        }
        else
        {
            // Computer new values
            supply = supply * 5;
            tower = tower * 10;

            // Write the values to the calcu div
            document.getElementById("calcu").innerHTML = "Supply points: " + supply + ", Tower points: " + tower;
        }
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:57:02.930

您不需要禁用文本框，只需触发警报作为错误消息。

类似于以下内容：

```
var obj1 = document.forms["form_name"]["obj1"].value;
if (obj1 < 0 || obj1 > 24) {
   alert("Error message");
   return false;
} 
```

# iphone - 使用多行消息而不是短的 1 行消息发布到 facebook

> ID：10306480
> 
> 赞同：0
> 
> 时间：2012-04-24T21:46:40.410
> 
> 标签：iphone, facebook, facebook-graph-api

我可以使用下图所示的代码发布到我的 facebook 墙上，但是，“@message”值中不支持/不允许回车（换行）。请参阅下面的 xcode 中的错误。当我在行尾使用反斜杠“\”来转义换行符时，会发出帖子，但结果不可读。

如何为 Facebook 帖子发布多行内容？

更好的是，我的实际原始内容中有 html 标记，例如粗体等……有没有办法用任何更丰富的文本发布到 facebook？

非常感谢。

菲尔

参见图片：[https ://skitch.com/aibkwik/8iuxt/fb4.xcodeproj-fb-viewcontroller.m](https://skitch.com/aibkwik/8iuxt/fb4.xcodeproj-fb-viewcontroller.m)

```
 NSMutableDictionary* params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                               @"removed for privacy", @"app_id",
                               @"http://itunes.apple.com/us/app/golf-whiz/removed?ls=1&mt=8", @"link",
                               @"https://img.skitch.com/20120424-mauaru649ed4i4igqc8mtth6bh.png", @"picture",
                                @"Golf Whiz", @"name",
                                @"Check this out!", @"caption",
                                @"Summary Information\nSouth Riding GC\nShots fired: 13\nFarts cut: 10", @"description",nil];

  [facebook dialog:@"feed" andParams:params andDelegate:self]; 
```

> 在此处输入代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T21:50:56.327

您在 Xcode 中的 NSString 应该只有一行。要表示换行符，您应该使用`\n`. 您正在寻找的消息是：

```
@"Summary Information\nSouth Riding GC\nShots fired: 13\nFarts cut: 10"; 
```

其他人遇到了这个问题，似乎这里[的第二个回答者](https://stackoverflow.com/questions/4701609/how-insert-linebreaks-in-nsstring-for-facebook-stream-publish)找到了解决方案。

# hibernate - 为什么引用分离实体有效？jpa hibernate

> ID：10306484
> 
> 赞同：1
> 
> 时间：2012-04-24T21:46:56.300
> 
> 标签：hibernate, jpa, entity

假设我有一个关系主从。在数据库中存在 id=1 的表 Master 中的一行。为什么以下代码有效：

```
 Slave slave = new Slave();
    slave.setId(1L);

    Master master = new Master();
    master.setId(1L);
    slave.setMaster(master);
    em.persist(slave); 
```

所以 Master 是分离的实体，在从属和主控之间创建提交引用之后。为什么？我认为在这种情况下，我们必须通过“查找”功能从数据库中读取主行。我在哪里可以阅读更多关于它的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:13:08.087

欢迎来到 Hibernate 关系的黑暗之地。首先，如果您想了解发生了什么，请添加到 hibernate.cfg.xml

```
<property name="show_sql">true</property> 
```

多亏了这一点，您将在控制台中看到 Hibernate 为您执行的所有 SQL 查询——这是了解 Hibernate 在给定时刻如何工作的最佳方式。

回到你意想不到的结果。重要的是谁拥有关系。在你的情况下，我猜在从表中有一个指向主表主键的外键（显然你也可以使用连接表 - 没关系）。

Hibernate 在创建关系时只关心拥有关系的那一方 - 在您的情况下，将有关新关系的信息保存在从表中就足够了。事实上，Master 不需要知道关系，所以没有必要在那个实体上调用 save。这就是您的代码有效的原因。

有帮助的阅读：

*   [http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch01.html#tutorial-associations](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch01.html#tutorial-associations)
*   [http://www.mkyong.com/hibernate/inverse-true-example-and-explanation/](http://www.mkyong.com/hibernate/inverse-true-example-and-explanation/) - 注意inverse属性的含义

# c# - 提高从 MethodCallExpression 获取 MethodInfo 的性能

> ID：10306485
> 
> 赞同：5
> 
> 时间：2012-04-24T21:46:56.593
> 
> 标签：c#, reflection, expression

我们的 UI 系统可以从 MethodInfo 生成表单。在 System.Linq.Expressions 之前，我们使用反射（方法 1）获取 MethodInfo：

```
MethodInfo info = typeof(ExtensionTestClass).GetMethod("InstanceMethod", BindingFlags.Public | BindingFlags.Instance, null, new Type[] { typeof(string), typeof(string) }, null); 
```

不好的地方在于，如果我们更改了 InstanceMethod 的签名或名称，代码仍然可以编译。

输入表达式。现在我们这样做（方法2）：

```
 MethodInfo info = GetMethod<ExtensionTestClass>(x => x.InstanceMethod("defaultValue", "defaultValue")); 
```

或者这个（方法3）：

```
MethodInfo info = GetMethod<ExtensionTestClass, string, string>(x => x.InstanceMethod); 
```

语法“更好”，我们得到智能感知，如果方法不存在或签名不匹配，我们会得到编译错误。但是，方法 2 和方法 3 比反射慢大约 10 到 20 倍。

一些数字（用秒表测量）：

单次调用： 方法 1：.0000565 方法 2：.0004272 方法 3：.0019222

100000 次调用： 方法 1：.1171071 方法 2：1.5648544 方法 3：2.0602607

我们实际上并没有编译或执行表达式，如果有人对性能差异有解释，我很感兴趣。

更新：GetMethod<> 代码：

方法二：

```
public static MethodInfo GetMethod<T>(Expression<Action<T>> target)
{
    MethodCallExpression exp = target.Body as MethodCallExpression;
    if (exp != null)
    {
        return exp.Method;
    }
    return null;
} 
```

方法三：

```
public static MethodInfo GetMethod<T, A1, A2>(Expression<Func<T, Action<A1, A2>>> expression)
{
    var lambdaExpression = (LambdaExpression)expression;
    var unaryExpression = (UnaryExpression)lambdaExpression.Body;
    var methodCallExpression = (MethodCallExpression)unaryExpression.Operand;
    var methodInfoExpression = (ConstantExpression)methodCallExpression.Arguments.Last();
    return (MethodInfo)methodInfoExpression.Value;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:47:35.807

我的猜测是它更慢，因为表达式版本执行相同的反射（尽管它们可能使用`methodof`在 C# 中没有类似物的 IL 快捷方式）来创建表达式树，*除了*为每次调用创建树本身的开销（我不认为它们被编译器发出的代码缓存）；另外，您还必须阅读这些树才能恢复该方法。

反射可能很“慢”，但实际上它非常快；特别是因为我相信幕后的数据也被缓存了。因此，一旦您`GetMethod`拨打第二个电话会更快。这提供了另一个令人信服的证据来解释为什么后续的表达式树版本更慢——因为它们实际上做了更多的工作。

如果您对 IL 感到满意，请使用所有三个版本编译一个版本，然后使用 ILSpy 或 Reflector 分析编译后的图像（在 C# 模式下，两者都会很聪明，并将表达式代码重新构造回 C#，这不好；所以切换到 IL 模式） - 看看为生成表达式树而发出的代码，你就会明白我的意思。

# c# - 将 Exchange 附件保存到域 obj，然后删除电子邮件

> ID：10306486
> 
> 赞同：1
> 
> 时间：2012-04-24T21:46:57.330
> 
> 标签：c#, .net, web-services, ienumerable, exchangewebservices

这是主要问题。

我正在尝试将存储库模式与以下内容一起使用：

```
public interface IExchangeInboxRepository
{
   IEnumerable<InboxEmail> GetAllEmails();
} 
```

我想要完成的是获取电子邮件并创建一个域对象，如下所示：

```
 public class InboxEmail
   {
      public IEnumerable<FileAttachment> Attachments { get; set; }
      public string FromAddress { get; set; }
      public string Subject { get; set; }
      public string Content { get; set; }
      public DateTime DateArrived { get; set; }
   } 
```

问题是，从我尝试使用 EWS 可以看出，就像在这个例子中一样：

[使用 Exchange Web 服务从 Exchange 下载附件](https://stackoverflow.com/questions/5991301/download-attachment-from-exchange-using-exchange-web-services)

当我尝试在域 obj 中的附件列表上执行 fileAttachment.Load() 时，它正在调用 Exchange 服务。没什么大不了的，但我希望存储库在建立 IEnumerable 后删除电子邮件以交回。如果我删除电子邮件，显然当我尝试访问 FileAttachment 时，它会引发“商店为空”的异常。有没有办法持久化 FileAttachment？

我基本上想保留附加在域对象中的文件，并在使用 EWS 对其进行迭代后删除电子邮件并将它们返回给存储库的用户。

# c# - 为什么面板内的按钮不起作用？

> ID：10306488
> 
> 赞同：1
> 
> 时间：2012-04-24T21:47:06.557
> 
> 标签：c#, button, panel

我正在开发 C# 应用程序。基本上我的问题是，当我打开一个面板时（在单击按钮时使用 panel1.Show()，面板确实显示了，但面板内的任何按钮都没有做任何事情（代码是为这些按钮的按钮单击编写的）。部分正在运行的代码：

```
private void button4_Click(object sender, EventArgs e)
{
    if (panel1.Visible == false)
        panel1.Show();
    else
        panel1.Hide();
} 
```

现在问题出在里面的按钮上（按钮 6 在面板中，由设计师设置）：

```
private void button6_Click(object sender, EventArgs e)
{
    panel1.Hide();
} 
```

单击此按钮（在打开面板之后）根本不会做任何事情。我有另一个按钮也不起作用（它的功能更复杂），但是如果我理解为什么简单的按钮不起作用，我相信我能够解决它。抱歉，如果解决方案在某个地方，我已经诚实地尝试过，但我自己找不到任何东西。

# sockets - 使用 luasocket 和代理获取 url 页面

> ID：10306489
> 
> 赞同：5
> 
> 时间：2012-04-24T21:47:16.687
> 
> 标签：sockets, lua, fetch, luasocket

到目前为止，我有以下部分：

```
local socket = require "socket.http"
client,r,c,h = socket.request{url = "http://example.com/", proxy="<my proxy and port here>"}
for i,v in pairs( c ) do
  print( i, v )
end 
```

这给了我如下输出：

```
connection  close
content-type    text/html; charset=UTF-8
location    http://www.iana.org/domains/example/
vary    Accept-Encoding
date    Tue, 24 Apr 2012 21:43:19 GMT
last-modified   Wed, 09 Feb 2011 17:13:15 GMT
transfer-encoding   chunked
server  Apache/2.2.3 (CentOS) 
```

这意味着连接建立得刚刚**好**。现在，我想`url's`使用 this获取我的标题`socket.http`。我搜索了以前的 SO 问题和[luasocket 的 http 文档](http://w3.impa.br/%7Ediego/software/luasocket/http.html)。但是，我仍然不知道如何在变量中获取/存储整个/部分页面并对其进行处理。

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T02:43:58.133

您正在使用 http.request() 的“通用”形式，它需要通过 LTN12 接收器存储正文。它并不像听起来那么复杂，试试这个代码：

```
local socket = require "socket.http"
local ltn12 = require "ltn12"; -- LTN12 lib provided by LuaSocket

-- This table will store the body (possibly in multiple chunks):
local result_table = {};
client,r,c,h = socket.request{
    url = "http://example.com/",
    sink = ltn12.sink.table(result_table),
    proxy="<my proxy and port here>"
}
-- Join the chunks together into a string:
local result = table.concat(result_table);
-- Hacky solution to extract the title:
local title = result:match("<[Tt][Ii][Tt][Ll][Ee]>([^<]*)<");
print(title); 
```

如果您的代理在整个应用程序中保持不变，那么更直接的解决方案是使用简单的 http.request() 形式，并通过 http.PROXY 指定代理：

```
local http = require "socket.http"
http.PROXY="<my proxy and port here>"

local result = http.request("http://www.youtube.com/watch?v=_eT40eV7OiI")
local title = result:match("<[Tt][Ii][Tt][Ll][Ee]>([^<]*)<");
print(title); 
```

输出：

```
 Flanders and Swann - A song of the weather
  - YouTube 
```

# ruby-on-rails - 设计、子域和超级用户

> ID：10306492
> 
> 赞同：1
> 
> 时间：2012-04-24T21:47:24.640
> 
> 标签：ruby-on-rails, ruby, authentication, devise

我正在为应用程序使用 Basecamp 样式的子域。使用 Devise，我允许用户通过在 User.rb 中使用以下内容仅访问其子域：

```
 def self.find_for_authentication(conditions={})
    conditions[:account_id] = Account.find_by_subdomain(conditions.delete(:subdomain)).id
    super(conditions)
  end 
```

这将检查以确保与尝试登录的用户关联的帐户与子域匹配。它工作正常。

我的问题是我也想允许超级用户登录......他们不会有关联的“帐户”。相反，它们将在同一“用户”模型上具有“超级用户”布尔列。

**有没有办法检查正确的子域或“超级用户”状态？**

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:17:05.297

如果您为所有超级用户创建了一个帐户怎么办？我不确定这被称为身份验证过程的哪个阶段，但可能是这些方面的东西..？

```
def self.find_for_authentication(conditions={})
  if subdomain = conditions.delete(:subdomain)
    conditions[:account_id] = Account.find_by_subdomain(subdomain).id
  elsif User.where(conditions).where(:superuser => true).length > 0
    conditions[:account_id] = 1 # 1 is account reserved for super users
  end

  super(conditions)
en 
```

# magento - Magento - 带有 2 个提交按钮的表单（一个没有验证）

> ID：10306496
> 
> 赞同：0
> 
> 时间：2012-04-24T21:48:05.187
> 
> 标签：magento

我有一个使用以下验证的 Magento 表单：

```
var dataForm = new VarienForm('...'); 
```

我想要 2 个提交按钮，一个带有验证（可以），一个没有验证。

如何配置第二个提交按钮，使其不会触发表单的验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:45:58.390

添加一个正常的提交按钮会起作用吗？

```
<input type="submit" value="submit"> 
```

您使用的唯一原因`var dataForm = new VarienForm('...');`是启用事物的验证方面。您只需要确保`action`表单标签的值指向正确的 URL

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:35:33.620

在您提交表单后，Magento 联系表单还会进行一些 Zend 级别的验证。你可以在里面看到这个：

```
 app/code/core/Mage/Contacts/controllers/IndexController.php 
```

检查 PostAction() 方法...

# python - 谷歌应用引擎 python get_by_id 不起作用

> ID：10306503
> 
> 赞同：0
> 
> 时间：2012-04-24T21:48:42.643
> 
> 标签：python, google-app-engine

第一次发布和新的谷歌应用引擎！

我一生都无法弄清楚为什么我尝试使用 Model.get_by_id 访问对象不起作用。

我的测试数据已填充，我可以验证评论的输出。我可以在数据存储查看器中确认数据的 ID...但尝试使用该 ID 无法返回对象。

```
    namespace_manager.set_namespace('myNamespace')

    对于模型中的 t.MyClass.all().fetch(100)：
        print t.key().id() # 打印密钥并在数据存储查看器中验证
        print t.date # 打印日期

        myClassInstance = models.MyClass.get_by_id(t.key().id()) # 永远找不到对象
        如果游览是无：
            打印“未找到 MyClass 实例”

```

所以输出是

```
    6
    2012-04-24 20:47:13.537000
    未找到 MyClass 实例
    27
    2012-04-24 20:47:13.605000
    未找到 MyClass 实例
    29
    2012-04-24 20:47:13.611000
    未找到 MyClass 实例
    31
    2012-04-24 20:47:13.617000
    未找到 MyClass 实例

```

请注意，这不是根实体，也有子实体......但 MyClass.get_by_id 方法不应该返回正确的对象吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:00:30.890

如果您使用父/祖先创建实体，您也需要将其提供给`get_by_id`函数。

```
entity = MyModel(parent = parentkey,
                 name   = 'somename')
entity.put()

entity_by_id = MyModel.get_by_id(entity.key().id(), parent = parentkey) 
```

# c# - 让图表TextAnnotation出现在DataPoints后面

> ID：10306504
> 
> 赞同：0
> 
> 时间：2012-04-24T21:48:55.100
> 
> 标签：c#, .net, winforms, mschart

有没有办法将 TextAnnotation 添加到 C# 中的图表控件中，其中注释出现在数据点后面？似乎没有办法将注释发送到后面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:13:09.043

您是否尝试在 PrePaint 事件中更改文本注释的 Z-Order

检查此链接 [http://support2.dundas.com/OnlineDocumentation/WebChart2005/Annotations.html](http://support2.dundas.com/OnlineDocumentation/WebChart2005/Annotations.html)

搜索“使用 Z 顺序”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-02T09:58:18.983

我在点图中使用的肮脏解决方案。在其他一切之上重绘每个数据点。

```
Private Sub Chart1_Paint(chart1 As Chart, e As PaintEventArgs) Handles Chart1.Paint
    For Each chartSeries As Series In chart1.Series
        Dim ca As ChartArea = chart1.ChartAreas(chartSeries.ChartArea)
        For Each chartPoint As DataPoint In chartSeries.Points

            'Determine the position, size and color of the original datapoint.
            Dim x As Double = ca.AxisX.ValueToPixelPosition(chartPoint.XValue)
            Dim y As Double = ca.AxisY.ValueToPixelPosition(chartPoint.YValues.First)
            Dim b As New SolidBrush(chartSeries.Color)
            Dim width As Double = chartPoint.MarkerSize
            Dim r As New Rectangle(x - width / 2, y - width / 2, width, width)

            'Draw the new datapoint on top of the original (and on top of any annotations)
            e.Graphics.FillEllipse(b, r)
        Next
    Next
End Sub 
```

# regex - RegEx - 需要删除除了单词序列之外的所有单词，允许一个空格继续单词

> ID：10306507
> 
> 赞同：0
> 
> 时间：2012-04-24T21:49:23.267
> 
> 标签：regex

尝试从 html 文档中的名称集合中删除空格和制表符时遇到问题。

前任：

```
 FU BAR       
RE BAR          NULL 
```

我需要我的回应只是：

```
FU BAR RE BAR NULL 
```

我一直在尝试：

```
[^A-Z]+([[A-Z]{1,}\s]+)[\s\r\n\t]+ 
```

最后仍然留下一些零散的空格或标签。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:52:11.800

为什么不直接使用：`s/\s+/ /g`？

哦，刚刚意识到这并没有考虑到前导和尾随空格。您也可以通过首先通过此正则表达式运行输入来处理这些问题，然后是上面的那个：

```
s/^\s+|\s+$// 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:52:20.153

`\s+`用一个空格替换怎么样？（假设我们不受限于单行匹配）。

（如果我们使用一些逐行的正则表达式替换，例如一些 Unix 工具，我们会删除所有前导和尾随空格，用单个空格替换内部空格区域，并删除空行或仅包含空格的行.)

您是否尝试将其应用于 HTML 文档的某些部分，同时在其他区域保留空白？如果是这样，请使用反映此要求的示例更新您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:08:38.740

如果您使用的是 Java，

```
String normalizeSpace = str.replaceAll("\\s+", " "); 
```

[Commons Lang 2.6](http://commons.apache.org/lang/)中的[StringUtils](http://commons.apache.org/lang/api-2.6/org/apache/commons/lang/StringUtils.html)类包含`normalizeSpace`具有相同功能的方法（包括控制字符，char <= 32）。

# php - SQL/PHP - 使用 php 连接到数据库

> ID：10306511
> 
> 赞同：0
> 
> 时间：2012-04-24T21:49:28.120
> 
> 标签：php, sql

我正在尝试根据下面的示例设置与我的 sql 数据库的连接。

```
// ----------------------
// Retrieve some private information like my db password

   include("db_info.php");

// ----------------------
// Connect to Oracle database

   $conn = oci_connect('username', $db_pwd, '(DESCRIPT... 
```

我的问题是，如何处理 db_info.php 文件？我的密码存储在那里

```
$db_pwd = "something" 
```

*编辑 - 我在尝试打开我的页面时遇到的错误如下。

```
Array ( [code] => 24415 [message] => ORA-24415: Missing or null username. [offset] => 0 [sqltext] => ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:06:25.837

确保您的用户名正确。如果它是 中的变量`db_info.php`，则下面的代码是错误的：

```
$conn = oci_connect('username', $db_pwd, '(DESCRIPT... 
```

如果它是一个变量，它应该是：

```
$conn = oci_connect($username, $db_pwd, '(DESCRIPT... 
```

另外，您确定您使用的是 Oracle 数据库吗？（对不起，不得不问）:)

编辑：

再看一遍，看起来你有一个简单的错字。试试这个：

```
include("../db_info.php"); 
```

你有一个额外`.`的在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:52:31.487

您必须在某处写入数据库信息，并且您的解决方案足够合理。它甚至不需要隐藏，因为除非您有 FTP 访问权限，否则您将永远无法查看其内容。

# javascript - 如何检查鼠标是否不在javascript中的元素上？

> ID：10306514
> 
> 赞同：4
> 
> 时间：2012-04-24T21:49:55.463
> 
> 标签：javascript

当悬停在一个元素上时，我的网站会创建一个工具提示。当鼠标停止悬停在元素上时，将调用 mouseout 事件，删除工具提示，并且一切正常。除了有时，用户移动鼠标的速度非常快，以至于在创建工具提示时，鼠标不再位于元素内部。这意味着除非用户将鼠标悬停在元素上并移出元素，否则工具提示不会消失。

我的解决方案是，在创建工具提示后，检查鼠标是否在所需元素上，如果不是，则将其删除。不幸的是我不知道怎么做。

我尝试了[这些](https://stackoverflow.com/questions/1273566/how-do-i-check-if-the-mouse-is-over-an-element-in-jquery)解决方案，但它们都需要一个 mouseout 事件才能工作。我是否遗漏了什么，或者是否有另一种（希望更好）方法来查找鼠标当前是否不在元素上方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:52:50.863

听起来浏览器正在抛出 MouseOut 事件，而您忽略了它们。考虑将 MouseOut 事件默认绑定到处理程序，即使您尚未设置工具提示也是如此。

我希望对于每个 MouseIn 事件，都有一个 MouseOut 事件。如果规范或此特定浏览器中不是这种情况，那么您就有问题了。在这种可怕的情况下，您可以在一秒钟后取消工具提示。

# c# - 在可枚举中加载第一个、下一个项目和上一个项目

> ID：10306515
> 
> 赞同：0
> 
> 时间：2012-04-24T21:50:15.887
> 
> 标签：c#, list, foreach, ienumerable

嗨，我有一个程序，它基本上可以从 IEnumerable 加载新闻文章。我已经开始了一个方法，它只需要加载这个 IEnumerable 中的第一项。然后在用户手势上（向左滑动或向右滑动）将加载 IEnumerable 中的上一项或下一项。此外，如果用户尝试加载超出范围的索引项（例如 -1 或大于 IEnumerable 计数的项），它将什么也不做。

我已经编写了许多迭代 IEnumerable 的方法，但我发现尝试解决这个方法有些困难：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:51:39.070

首先通过调用 ToList 将 enumerable 转换为 List。然后，您可以跟踪当前索引并采取相应措施。

编辑：如果您希望项目仅在需要时“加载”，您可以将每个项目包装在一个 Lazy 中。这样，您可以实现整个列表，但仅在需要时加载单个项目。即使用户来回滑动，这也只会加载一次项目。

# asp.net-mvc - 从 cookie 中获取信息以在 MVC3 中的 gridview 中隐藏行

> ID：10306523
> 
> 赞同：0
> 
> 时间：2012-04-24T21:50:48.467
> 
> 标签：asp.net-mvc, asp.net-mvc-3, cookies, session-cookies, httpcookie

我正在尝试返回一个视图，该视图排除了用户单击隐藏的行，并生成了一个 cookie，存储用户希望隐藏哪些行的信息。

我的问题是 cookie 只包含一个值，因此我的 select 语句一次只排除一行。这是我所拥有的：

```
public ActionResult Hide(int id)
    {
        HttpCookie cookie = new HttpCookie("HideCookie");
        cookie.Value = id.ToString();
        cookie.Expires = DateTime.Now.AddYears(1);
        System.Web.HttpContext.Current.Response.Cookies.Add(cookie);

        int i = Convert.ToInt32(Request.Cookies.Get("HideCookie").Value);
        var quotes = from q in db.View1 where !q.Quote_ID.Equals(i) select q;

        return View(quotes.ToList());
     } 
```

我尝试创建一个字符串并继续向字符串附加新值，但它仍然只需要最后一次单击的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:05:34.193

我不认为 cookie 是执行此操作的最佳方法（您是否考虑过使用 TempData，或者至少使用 Session 对象，以便您只向每个用户发送一个 cookie？）虽然使用这种方法，但您似乎可以做到它通过对 cookie 对象使用逗号分隔的列表。

```
public ActionResult Hide(int id)
{
    var cookie = Request.Cookies.Get("HideCookie");
    List<string> hideItems;
    if (cookie == null)
    {
        cookie = new HttpCookie("HideCookie");
        hideItems = new List<string>() { id.ToString() };
        cookie.Value = id.ToString();
        cookie.Expires = DateTime.Now.AddYears(1);
        System.Web.HttpContext.Current.Response.Cookies.Add(cookie);
    }
    else
    {
        cookie = Request.Cookies.Get("HideCookie");
        hideItems = cookie.Value.Split(',').ToList();
        hideItems.Add(id.ToString());
        cookie.Value = string.Join(",", hideItems);
    }

    var quotes = from q in db.View1 where 
        !hideItems.Select(i=>int.Parse(i)).Contains(q.Quote_ID) select q;

    return View(quotes.ToList());
 } 
```

# c# - 忽略相关实体的属性

> ID：10306529
> 
> 赞同：1
> 
> 时间：2012-04-24T21:51:05.627
> 
> 标签：c#, entity-framework, linq-to-entities

我首先使用 EF 4.3.1 代码从实体用户加载数据

```
public class User
{
    public int Id { get; set; }
    public IList<UserFile> Files { get; set; }
} 
```

连同文件

```
public class UserFile
{
    public int Id { get; set; }
    public User User { get; set; }
    public string Name { get; set; }
    public byte[] Data { get; set; }
} 
```

使用代码

```
var users = Context.Users.Include(u => u.Files).ToList(); 
```

现在这可行，但文件可能非常大。我想做的是加载除实际`Data`属性之外的所有内容，以便可以有效地显示只有文件名的一长串用户。**有没有一些干净的方法来解决这个问题？**

到目前为止，我最好的想法是引入另一个`File`与 1-1 相关`UserFile`并仅包含该`Data`字段的实体，`Name`保留在`UserFile`. 我宁愿不添加另一个冗余表（来自 DB PoV）只是为了让 EF 更容易加载......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:55:21.397

一种方法是创建一个`UserBasicFile`包含除数据之外的所有内容的实体，然后进行`UserFile`扩展`UserBasicFile`，并包含该`Data`属性。这样，如果您的实用程序函数只需要它们可能需要的基本信息`UserBasicFile`，`UserFile`s 仍然可以提供给这些函数。

请记住，您不一定要拥有两个表才能拥有两种实体类型。

# python - Python：ImportError：没有名为 _md5 的模块

> ID：10306531
> 
> 赞同：13
> 
> 时间：2012-04-24T21:51:35.470
> 
> 标签：python

我的 Ubuntu 10.04 x86_64 机器上安装了 python 2.5.1。

当我尝试导入 hashlib/md5 时，出现此错误

```
>>> import hashlib 
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
File "/usr/local/lib/python2.5/hashlib.py", line 133, in <module>
md5 = __get_builtin_constructor('md5')
File "/usr/local/lib/python2.5/hashlib.py", line 60, in __get_builtin_constructor
import _md5
ImportError: No module named _md5 
```

我已经尝试了大多数可以在 google 上找到的解决方案，但对我没有任何帮助。有谁知道如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T09:30:12.237

在从 tarball 配置和编译 python 之前，您必须安装软件包 libssl-dev：

```
sudo apt-get install libssl-dev
cd YOUR_PYTHON_2.5_1_SRC_DIR
make clean
./configure
make
sudo make install 
```

你有充分的理由不使用 2.5.X 系列的最新版本吗？

# c++ - c++ 中无法识别 C 枚举

> ID：10306535
> 
> 赞同：0
> 
> 时间：2012-04-24T21:51:49.253
> 
> 标签：c++, c

我在使用 c++ 程序主函数中的 ac 标头中定义的枚举时遇到了一些麻烦。代码与此类似：

主.cpp：

```
extern "C"
{
#include my_c_header.h
}
//...
int main(void)
{
  my_c_function(channel_1);
  return 0;
} 
```

my_c_header.h：

```
typedef enum channel
{
  channel_0,
  channel_1
};

void my_c_function(channel ch)
{
  //...
} 
```

编译器抱怨它无法解析符号“channel_1”。编译器是 tms470，但我不知道问题是不是这个编译器特有的，还是 c 和 c++ 的这种混合有什么问题

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T21:54:03.090

这不是一个有效的`typedef`陈述，您缺少别名。

尝试

```
typedef enum
{
  channel_0,
  channel_1
} channel; 
```

（它实际上可能是合法的，但它不会将名称`channel`引入 C 编译器使用的搜索空间。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:54:44.170

我相信您在源代码而不是头文件中定义了枚举。

# javascript - 追加到 div 中的 ul 元素

> ID：10306537
> 
> 赞同：1
> 
> 时间：2012-04-24T21:51:58.283
> 
> 标签：javascript, jquery, jquery-mobile

我正在使用此 javascript 将 ID 附加到下面的 div 中：

```
 $("#toadd").append("<li><a href=\"acura.html\"></a></li>");

<div id="toadd" data-role="content">
        <p>Page 1 content</p>
                <ul data-role="listview" data-theme="g">
</ul> 
```

是否可以附加到 div 中的“ul”元素？就像是

```
 $("#toadd.ul").append("<li><a href=\"acura.html\"></a></li>"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T21:53:51.187

不带试试。#toadd 和 ul 之间：

```
$("#toadd ul").append("<li><a href=\"acura.html\"></a></li>"); 
```

编辑：`$("#toadd.ul")`意味着您正在寻找具有 id="toadd" 并具有名为“ul”的类的元素。 `$("#toadd ul")`选择 #toadd 元素中包含的所有 ul。

# xcode - Xcode 项目 CMD-单击符号以“跳转到定义”不起作用

> ID：10306539
> 
> 赞同：44
> 
> 时间：2012-04-24T21:52:00.877
> 
> 标签：xcode, xcode4, intellisense, code-completion, symbol-not-found

自从 Xcode 4.3.1 发布以来，我一直在使用它，并且从那以后我从事了许多不同的项目。在我从事这个新项目之前，一切都一直很好。

代码完成/代码感知永远找不到任何东西。当我“Command+Click”一个变量或类时，它通常会跳转到那个位置，但现在我得到了：

> 未找到符号

该`Jump to Definition`操作不起作用。

如果我在打开这个坏项目时打开我的一个旧项目，旧项目仍然可以用于代码感知，而新项目则不能。

我的合作伙伴正在从事同一个项目，我们都从我们的存储库中获取文件，并且代码感知在他的机器上为这个项目工作......只是不是我的。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-04-24T21:59:05.180

试试这个：

打开组织者。在 Xcode 中关闭您的项目（让 Xcode 和管理器运行）。在管理器的项目中，单击派生数据旁边的删除按钮。退出 Xcode。

通过 finder 找到您的 Xcode 项目。右键单击并“显示包内容”。删除 project.xcworkspace 和 xcuserdata 文件夹。

再次打开 Xcode，看看它是否适合你。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2017-01-12T17:46:39.850

使用 Xcode 8.2 我以这种方式解决了：

1.  文件 > 工作区设置
2.  单击高级...按钮上方的灰色小箭头（派生数据）
3.  选择我的项目文件夹并将其删除。

现在在您的项目中查看 cmd+click 是否有效

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-23T12:14:56.250

Xcode 8 和 Swift 3 也存在类似问题。

只需退出 Xcode 和模拟器，重新打开项目即可。

其他时候，重新启动 Mac 会去掉问号并导航到相关的方法实现

有时，只需关闭项目并从“文件 - > 打开最近”再次打开它也可以。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-24T14:10:07.830

就我而言，我以这种方式解决了。

*   从项目导航器转到项目的属性。
*   构建阶段
*   在“编译源”中添加您的***.m文件**

现在重新构建。

例如，当您在创建类后手动重命名类时，可能会发生这种情况。

希望这有帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-05-30T09:18:19.403

**Xcode 10.2.1** - 完全关闭 Xcode 并重新打开它为我解决了这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-07T12:17:57.607

对于其他人，如果上述方法均无效，请尝试以下操作：

转到菜单栏 Xcode -> 首选项 -> 位置 -> 命令行工具

在此处选择正确的（当前）Xcode 格式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-19T14:43:11.773

在我的例子中，`.m`文件不知何故位于`en.lproj`目录中，这使得它无法在语法着色和智能感知上正确显示。

在`File inspector`侧面板中检查选项卡中是否签入了某些内容`Localization`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-29T16:20:10.917

我遇到了这个问题，重新启动，退出 Xcode，什么也没发生。切换到主分支，拉，结帐到新分支。问题消失了。我什至回到了我以前的分支，一切正常。我唯一的猜测是 git 有时会搞砸！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-05-29T12:06:21.217

发生这种情况的 3 个原因：

1.  导出数据损坏： 解决方法：清理导出数据文件夹。

2.  损坏的项目设置： Project.xcodeproject -> 右键单击​​并清理[g_low 的答案](https://stackoverflow.com/a/10306634/17188)中提到的文件。

3.  文件不是项目目标的一部分：检查文件是否是编译源的一部分，如果不添加...

# c# - Fluent Validation 和 Data Annotation 之间的性能事实

> ID：10306547
> 
> 赞同：1
> 
> 时间：2012-04-24T21:52:23.577
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3, fluentvalidation

有人在 Fluent Validation 和 Data Annotation 之间有实际测量经验吗？ASP MVC 5 对此有很大的改进吗？

# java - Android/JVM在RSA解密上的区别

> ID：10306560
> 
> 赞同：3
> 
> 时间：2012-04-24T21:53:07.117
> 
> 标签：java, android, rsa

我正在尝试解密我在其他地方加密的字符串。这是我的代码：

```
private void test() {

    try {
        String stringMessage="Sf3O7Lr2+WN5szGyLejL3CjuBRZtQ72+ZBmgVTgWnatQZxUElzaBqFa1p0SVBqe9VWVxCxdEkejMVtDGEr0UJSVSK8EB/fPI6v8JE8dIu0JN0mMs4xlowhITy0tQR+1pcBtDFjzOl33xxQcq5JuPezxRDxFIp+IVkD8FdpqlttEKf2Tvqw9tqsdgiBKb5xDvKrkIDQXdLBh1gbAVZDSJYGHRkcOA8vz2ty/PeooKkfDK6IOn7KBwOBgSRgQr/MLBF3Xk2vRWgVGRh/fRkzu21EWo99Q5moWKxWl3HW/bbgTBQTb097XP3NTID9kSPhCfL0BEfBxonuNse5GBoeRnCw==";
        //Convert String back to Byte[] and decrpt
        byte[] byteMessage = Base64.decodeBase64(stringMessage.getBytes("UTF-8"));
        System.out.println("ENCRYPTED MESSAGE byte Length: "+byteMessage.length);

        String decryptedMsg = decryptString(byteMessage, loadCASPrivateKey());
        System.out.println(decryptedMsg);
    } catch (Exception e) {
        e.printStackTrace();
        return;
    }
}

private static String decryptString(byte[] message, Key privateKey) throws InvalidKeyException, NoSuchAlgorithmException, NoSuchPaddingException, IllegalBlockSizeException, BadPaddingException, UnsupportedEncodingException {
    Cipher cipher = Cipher.getInstance("RSA");
    cipher.init(Cipher.DECRYPT_MODE, privateKey);

    byte[] cipherData = cipher.doFinal(message);
    return new String(cipherData, "UTF-8");
}

private PrivateKey loadCASPrivateKey() throws IOException, NoSuchAlgorithmException, InvalidKeySpecException {
    InputStream is = getClass().getResourceAsStream( "/keys/app-private.key" );
    if (is == null) {
        System.out.println("NULL");
    }
    byte[] encodedPrivateKey = new byte[(int) 2000];
    is.read(encodedPrivateKey);
    is.close();

    // Generate KeyPair.
    KeyFactory keyFactory = KeyFactory.getInstance("RSA");

    PKCS8EncodedKeySpec privateKeySpec = new PKCS8EncodedKeySpec(encodedPrivateKey);
    PrivateKey privateKey = keyFactory.generatePrivate(privateKeySpec);

    return privateKey;

} 
```

这在我的桌面 JVM 下可以 100% 工作，但是当我在 Android 模拟器中运行它时，我得到：

> 04-24 22:42:21.011: I/System.out(1041): ��k���_��*��������93|@0�̍4�y)��Q�k�;* A����e�<code>#��A�oiu:�����W5@$�w�j��uS�R�Ocxٰ&����l�w'/�d�8uA ��ؔ�{�4$�U�0��{Ԑ��t!9��n�� ��a��'Jdt2�t�T�D��k+k�;���� �� ����GF��\�r���>]�y+^w�<�� ��'E{�8R]�ZHyu��ζ��软���掱�{�A�# ▲</p>

我认为我的问题归结为编码，但我花了一整天的时间试图弄清楚什么，我真的很难过。

该字符串最初是使用以下加密的：

```
private void test() {
    String message="22223334490384903432221";
try {
    //Encrypt message
    byte[] encryptedMsg = Base64.encodeBase64(encryptString(message, temp.loadCASPublicKey()));
} catch (Exception e) {
e.printStackTrace();
        return;
}

}

private static byte[] encryptString(String message, Key publicKey) throws NoSuchAlgorithmException, NoSuchPaddingException, InvalidKeyException, IllegalBlockSizeException, BadPaddingException, UnsupportedEncodingException {
    Cipher cipher = Cipher.getInstance("RSA");
    cipher.init(Cipher.ENCRYPT_MODE, publicKey);

    byte[] cipherData = cipher.doFinal(message.getBytes("UTF-8"));     
    return cipherData;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T01:55:25.343

由于您正在读入一个 2000 字节的数组，因此您可能会喂食`KeyFactory`垃圾，并且您的密钥可能是 128（1024 位）或 256（2048 位）字节长。此外，您不应该直接使用 RSA 进行加密：这存在安全问题，您可以加密的数据大小受 RSA 密钥大小的限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T14:19:18.223

感谢 GregS 在评论中的帮助。这是对我有用的解决方案。

```
private void test() {

            try {
                String stringMessage="GEQRpAPA577ks/QveudNkk7H9DjItKGLDYW6xhH1YJGabCVzrkejkBh6S+APwEXxB84UV/q0sO5rqkgXWONJQ8CoMTfqXtUkAAwkYHSc86eGewkM8WpctA0AyNVFonOxDCXm84Uq8JRMzqskSH5VXHmMxvHIvpFgdhmt9Ir0cKWzoLsuvgfY9hfypfEyBXGZcoptQeKhsZxRGIlxbXhrFl/LqhC+F6vYtZ/j5pv2LUP38wh2rTCKnAQ+xvC+7wn5SVzt/Wbr/q7GjCoJuU9uFHQSS49KQDt+BzJL2XNwAMmdbC+XHYkEBBWxVSS+0hdSQxoaKVZZJk4hTnHwQlBAkw==";
                //Convert String back to Byte[] and decrpt
                byte[] byteMessage = Base64.decodeBase64(stringMessage.getBytes("UTF-8"));
                System.out.println("ENCRYPTED MESSAGE byte Length: "+byteMessage.length);

                String decryptedMsg = decryptString(byteMessage, loadCASPrivateKey());
                System.out.println(decryptedMsg);
            } catch (Exception e) {
                e.printStackTrace();
                return;
            }
        }

        private static String decryptString(byte[] message, Key privateKey) throws InvalidKeyException, NoSuchAlgorithmException, NoSuchPaddingException, IllegalBlockSizeException, BadPaddingException, UnsupportedEncodingException, NoSuchProviderException {
            Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());

            Cipher cipher = Cipher.getInstance("RSA/None/NoPadding","BC");
            cipher.init(Cipher.DECRYPT_MODE, privateKey);

            byte[] cipherData = cipher.doFinal(message);
            return new String(cipherData, "UTF-8");
        }

        private PrivateKey loadCASPrivateKey() throws IOException, NoSuchAlgorithmException, InvalidKeySpecException {
            InputStream is = getClass().getResourceAsStream( "/keys/app-private.key" );
            if (is == null) {
                System.out.println("NULL");
            }
            byte[] encodedPrivateKey = new byte[(int) 1216];
            is.read(encodedPrivateKey);
            is.close();

            // Generate KeyPair.
            KeyFactory keyFactory = KeyFactory.getInstance("RSA");

            PKCS8EncodedKeySpec privateKeySpec = new PKCS8EncodedKeySpec(encodedPrivateKey);
            PrivateKey privateKey = keyFactory.generatePrivate(privateKeySpec);

            return privateKey;

        } 
```

# objective-c - 添加第二个视图

> ID：10306563
> 
> 赞同：1
> 
> 时间：2012-04-24T21:53:12.313
> 
> 标签：objective-c, ios, view

这似乎很简单，但我在这个网站上没有找到任何关于这个的信息。我想调用一个视图，但我不想使用 addSubview 方法，我只想在当前视图之上调用一个新视图。并在一段时间后将其删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:58:41.957

听起来您需要一个**NavigationController**。

在那里，您可以使用以下代码推送视图：

```
ViewController *viewController = [[ViewController alloc] 
initWithNibName:@"ViewController" bundle:nil];

[self.navigationController pushViewController:viewController animated:YES]; 
```

如果你想切换回旧的 ViewController，只需使用以下代码删除视图：

```
[self.navigationController popViewControllerAnimated:YES]; 
```

# android - MuPdf中的OutOfMemory

> ID：10306569
> 
> 赞同：3
> 
> 时间：2012-04-24T21:53:42.557
> 
> 标签：android, mupdf

您好，我在我的项目中使用 MuPdf 库来查看文档。问题是，当您在平板电脑上的 11 英寸活动中打开 3-7 个文档时，我会出现内存溢出。当您加载一个新文档时，对前一个文档的所有引用都将被销毁，但不会从内存中删除该文档的图像。对象在 10-12 兆字节的内存映像中创建。在 7 英寸大小的平板电脑上不会出现此问题。

也许有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-28T06:24:51.203

通过在PageView.java`recycle()`的方法中调用位图解决了这个问题`relaeseBitmaps()`

```
public void releaseBitmaps() {
        reinit();
        mEntireBm.recycle();
        mPatchBm.recycle();
        mEntireBm = null;
        mPatchBm = null;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T05:59:24.897

在 mupdf.c 里面找到

“/* 128 MB 存储用于低内存设备。根据需要进行调整。*/”和

更改内存限制并尝试

我尝试使用 512 渲染比以前更快

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T08:52:05.400

我添加了以下代码来强制 PageView.java 中的垃圾收集器，到目前为止它似乎工作正常。

```
if (mEntireBm == null || mEntireBm.getWidth() != newSize.x
                              || mEntireBm.getHeight() != newSize.y) {
            mEntireBm = Bitmap.createBitmap(mSize.x, mSize.y, Bitmap.Config.ARGB_8888);
            System.gc();//Added
            Runtime.getRuntime().gc();//Added
        } 
```

编辑：多次打开文件后崩溃

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-08-07T00:53:15.207

1.  编辑 mupdf.c

更改：/* 128 MB 存储用于低内存设备。根据需要进行调整。*/ glo->ctx = ctx = fz_new_context(NULL, NULL, 128 << 20); 到 /* 128 MB 存储低内存设备。根据需要进行调整。*/ glo->ctx = ctx = fz_new_context(NULL, NULL, 32 << 20);

仅此而已。最大堆内存量 ~50Mb。

# android - 操作两个片段

> ID：10306570
> 
> 赞同：0
> 
> 时间：2012-04-24T21:53:45.870
> 
> 标签：android, android-fragments

我有两个片段，片段2下的片段1和片段1小于片段2。

首先我使片段 2 可见，而不是当我使片段 1 可见时，我想禁用片段 2 中的所有按钮和列表，因此用户只能控制片段 1。我该怎么做？

这是我的xml：

```
 <FrameLayout
            android:layout_width="0dip"
            android:layout_height="match_parent"
            android:layout_weight="1.0" >
            <FrameLayout
                android:id="@+id/fragment2"
                android:layout_width="match_parent"
                android:layout_height="match_parent" />

            <FrameLayout
                android:id="@+id/fragment1"
                android:layout_width="200dip"
                android:layout_height="200dip"
                android:visibility="gone" />
        </FrameLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T15:25:31.310

将一个 FrameLayout 用作容器，然后在必要时在代码中替换片段不是更容易吗？

例如：

```
<FrameLayout
    android:id="@+id/fragmentContainer"
    android:layout_width="match_parent"
    android:layout_height="match_parent" /> 
```

然后在包含上述布局的活动中：

```
if (showFragment1()) {
    getFragmentManager().beginTransaction().
        add(R.id.fragmentContainer, Fragment1.newInstance());
} else {
    getFragmentManager().beginTransaction().
        add(R.id.fragmentContainer, Fragment2.newInstance());
} 
```

然后你可以在片段类中使用 onActivityCreated 回调来初始化你的 UI。

# javascript - 不能使用 DIV 工作“onclick()”

> ID：10306575
> 
> 赞同：1
> 
> 时间：2012-04-24T21:54:07.490
> 
> 标签：javascript, jquery, html, onclick

我有一个使用一些选项卡的应用程序。这些选项卡的功能是用 jquery 编程的（我不知道如何编程 jquery）。因此，如果我想添加一个选项卡，我会使用这一行：

```
<div class="tab">1</div> 
```

我没有对该选项卡的功能进行编程，但我需要添加一些其他功能，所以我试图 `onclick()`在 DIV 上使用（如下所示）但不起作用。

```
<div class="tab" onclick="prueba()">1</div> 
```

为了使它工作，我需要使用这样的东西：

```
<div class="tab"><span onclick="prueba()">1</span></div> 
```

我的问题是 DIV 的大小更大，所以`onclick()`只能通过精确单击数字来工作，而不是 div 的任何部分。

我已经尝试将 DIV 插入到 Span 中（如下所示），但不起作用。

```
<span onclick="prueba()"><div class="tab">1</div></span> 
```

有谁知道这是否是因为 jquery 控制选项卡上的功能而发生的？

有什么方法可以使用`onclick()`带有“选项卡”类的 DIV 之外的任何元素？

非常感谢，对不起我的英语

```
function prueba() {
   alert("HELLO");
} 
```

很抱歉没有放 jquery 代码，它太长了，我不知道到底要显示哪个部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T21:56:28.020

您是否考虑过仅使用`$('.tab').click(prueba)`或类似的东西？这就是你通常打算用 jQuery 做这种事情的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T22:02:15.853

从此“*我有一个使用一些选项卡的应用程序。这些选项卡的功能是用 jquery 编程的（我不知道如何编程 jquery）。所以如果我想添加一个选项卡，我使用这一行：* “

听起来 jquery 正在寻找“选项卡”类。我建议发布 jquery 或将选项卡类分配给您希望触发操作的任何元素

IE：

`<span class="tab" onclick="prueba()"><div >1</div></span>`

可能会触发（除非它想要一个 div.tab ）？让我们猜猜！

# sql - Oracle - 为什么它认为它缺少右括号？

> ID：10306578
> 
> 赞同：0
> 
> 时间：2012-04-24T21:54:17.147
> 
> 标签：sql, oracle

为什么甲骨文认为它缺少右括号？

```
SELECT table2.name
    FROM (SELECT id, count (*) AS num
            FROM table1 GROUP BY id WHERE x = 1) 
    table1, table2, table3
    WHERE table2.temp_id = table3.temp_id AND
      table1.num > = s.num AND
      table2.id = table3.id; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T21:56:20.313

在您的内联视图中，您的`WHERE`子句在您的`GROUP BY`. 你需要扭转这一点

```
SELECT id, count (*) AS num
        FROM table1 WHERE x = 1 GROUP BY id) 
```

# javascript - 当文档准备好时，如何使 Jquery 可折叠面板折叠而不是展开？

> ID：10306580
> 
> 赞同：1
> 
> 时间：2012-04-24T21:54:23.043
> 
> 标签：javascript, jquery, expand, collapsable

我有以下 jquery 代码插件：

```
 (function ($) {
                $.fn.extend({
                    collapsiblePanel: function () {
                        // Call the ConfigureCollapsiblePanel function for the selected element
                        return $(this).each(ConfigureCollapsiblePanel);
                    }
                });
            })(jQuery);

            function ConfigureCollapsiblePanel() {
                $(this).addClass("ui-widget");

                // Check if there are any child elements, if not then wrap the inner text within a new div.
                if ($(this).children().length == 0) {
                    $(this).wrapInner("<div></div>");
                }

                // Wrap the contents of the container within a new div.
                $(this).children().wrapAll("<div class='collapsibleContainerContent ui-widget-content'></div>");

                // Create a new div as the first item within the container.  Put the title of the panel in here.
                $("<div class='collapsibleContainerTitle ui-widget-header'><div>" + $(this).attr("title") + "</div></div>").prependTo($(this));

                // Assign a call to CollapsibleContainerTitleOnClick for the click event of the new title div.
                $(".collapsibleContainerTitle", this).click(CollapsibleContainerTitleOnClick);
            }

            function CollapsibleContainerTitleOnClick() {
                // The item clicked is the title div... get this parent (the overall container) 
                // and toggle the content within it.
                $(".collapsibleContainerContent", $(this).parent()).slideToggle();
            } 
```

然后这里是html：

```
<div class="collapsibleContainer" title="Example Collapsible Panel">
                                    <p>
                                        KDLorem ipsum dolor sit amet, consectetur adipiscing elit.... (you get the idea!)
                                    </p>
                                </div> 
```

然后这里是css：

```
.collapsibleContainer
{
}

.collapsibleContainerTitle
{
   cursor:pointer;
}

.collapsibleContainerTitle div
{
  padding-top:5px;
  padding-left:10px;
}

.collapsibleContainerContent
{
   padding: 10px;
} 
```

这是文档准备功能：

```
jQuery(function () {
   jQuery(".collapsibleContainer").collapsiblePanel();
}); 
```

我需要写什么才能使面板在文档就绪时实际折叠而不是像现在加载文档时那样展开？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:02:35.303

将面板的内容设置为`display:none`.

看起来插件使用`slideToggle()`，它只是动画过渡到/从`display:none`。

所以，我认为：

```
.collapsibleContainerContent
{
   padding: 10px;
   display: none;
} 
```

# c# - 在 C# 中使用 Indexof 提取字符串

> ID：10306581
> 
> 赞同：4
> 
> 时间：2012-04-24T21:54:24.433
> 
> 标签：c#, indexof

我正在尝试提取此文件名中的数字部分。“姓名，姓氏_123456_state_city.pdf”

我已经到这一步了。。

```
idstring = file.Substring(file.IndexOf("_") + 1, 
    (file.LastIndexOf("_") - file.IndexOf("_") - 1)); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T21:57:27.900

这是正则表达式可能更好的情况之一：

```
_(\d+)_ 
```

而且，这就是你将如何使用它

```
 string input = "Name, lastname_123456_state_city.pdf";
    string regexPattern = @"_(\d+)_";

Match match = Regex.Match(input, regexPattern, RegexOptions.IgnoreCase);

if (match.Success)
    string yourNumber = match.Groups[1].Value; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T22:00:47.010

```
var firstUnderscore = file.IndexOf("_");
var nextUnderscore = file.IndexOf("_", firstUnderscore + 1);
var idstring = file.Substring(firstUnderscore + 1, nextUnderscore - firstUnderscore - 1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T21:59:28.707

为什么不直接使用正则表达式？测试`@"_([0-9]*)_"`应该可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T22:01:01.077

你可以使用一个`System.Text.RegularExpressions.Regex`

```
var regex = new Regex(@"^.*_(?<number>\d+)_.*\.pdf");
var idstring=regex.Match(file).Groups["number"].Value; 
```

# objective-c - 将 NSDictionary 序列化为 XML 文件

> ID：10306583
> 
> 赞同：0
> 
> 时间：2012-04-24T21:54:35.913
> 
> 标签：objective-c, nsdictionary

我有一本字典，其中包含需要发送到 Web 服务进行验证的必要信息。但是，我必须遵循服务提供的格式。

我创建 XML 结构，如

```
NSData * = [NSPropertyListSerialization dataWithPropertyList:myDictionary options:0 error:0];
NSString *postData [[NSString alloc] initWithData:data encoding:NSUTF*StringEncoding]; 
```

当将 postData 发送到 cosole 时，我将所需的所有信息都包含在一个

```
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
    <plist version="1.0">
    <dict>
        my data structure
    </dict>
    </plist> 
```

如何删除`DOCTYPE`声明`plist`和`dict`元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:03:01.217

那时，进行自定义序列化会更简单......

```
for (id key in dictionary)
{
    [someMutableString appendFormat:@"%@ = %@\n",key,[dictionary objectForKey:key]]];
} 
```

# javascript - 使用 javascript:history.go(-1) 有效，但我丢失了 css 属性和脚本

> ID：10306587
> 
> 赞同：0
> 
> 时间：2012-04-24T21:54:52.450
> 
> 标签：javascript, css, forms, back, browser-history

当我的客户提交表单并收到错误消息时，他们会被带到带有返回链接的页面。我正在使用 javascript:history.go(-1) 返回表单。

当客户端返回时，我失去了我的 css 功能，背景变化和颜色等。

我不希望客户必须重新输入所有内容。

有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:00:06.850

为什么不保存在 PHP Session 中输入的所有数据，并且（而不是 history.go(-1)）再次放置一个指向 Form 的链接，您可以在其中检查 session 中是否有值，并将它们写入PHP 的表单域？

就像是

```
$_SESSION['name']=$_POST['name'] 
```

和向后..

您甚至可以在不显示错误页面的情况下执行此操作，并在表单本身上显示错误...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:58:21.567

如果您提到的 CSS 作为表单的一部分输入，您可以使用[Sisyphus.js](http://simsalabim.github.com/sisyphus/)之类的 shim 签出，以确保当您的用户退回表单时跨浏览器持久性。

# expressionengine - 表达式引擎：我在博客的侧边栏上使用片段还是嵌入模板

> ID：10306598
> 
> 赞同：1
> 
> 时间：2012-04-24T21:55:34.400
> 
> 标签：expressionengine

我有一个使用 codeigniter 框架创建的网站。我正在使用表达式引擎 cms 从头开始​​在该站点上创建博客。我的想法是，我将对网站的其余部分和页面也使用表达式引擎——一次一件事。

我想在我的侧边栏上显示推荐、电子书、最近的帖子等的链接。（推荐和电子书页面尚未创建，将使用表达式引擎创建）。我想在我的网站中单独使用这些元素，例如我想在一个页面上使用推荐代码并在另一个页面上使用我的电子书代码。

考虑到这一点，我应该如何为博客创建侧边栏元素 - 我应该使用每个片段的推荐、电子书、注册表单、最近的帖子等，还是只创建一个嵌入式模板。有没有更好的方法来做到这一点，这样我就可以在转换完成后在整个网站上重用这些内容 - 从性能的角度来看。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:39:36.620

在最基本的情况下，我会为你的整个侧边栏使用一个片段。这样您就可以通过模板`{sidebar}`或其他方式快速调用它。片段的开销非常低。

如果我需要更大的灵活性 - 例如，根据我的模板仅显示我的侧边栏的某些“模块”，我有时会做的是从`embeds/.sidebar`（只是一个例子）嵌入我的侧边栏，并打开/关闭特定位使用[嵌入变量](http://expressionengine.com/user_guide/templates/embedding.html#embed-variables-for-the-embedded-template)：

`{embed="embeds/.sidebar" testimonials="y" recent_posts="y"}`

然后在您的`.sidebar.html`模板中：

```
{if embed:testimonials}
    // testimonials code goes here
{/if}

{if embed:recent_posts}
    // Recent posts code goes here
{/if} 
```

此方法具有更大的开销（嵌入总是如此），但它可以让您根据模板确定要包含在侧边栏中的内容。

# c# - 以与创建相反的顺序处理对象？

> ID：10306599
> 
> 赞同：3
> 
> 时间：2012-04-24T21:55:43.620
> 
> 标签：c#, dispose

我在编写的代码中遇到了一个反复出现的问题：修改一些全局值（我将使用注册表值作为示例），然后尝试将修改恢复为原始状态。

我想我会尝试使用 IDisposable 来解决这个问题。创建时，对象将读取注册表值，将其存储在本地，然后对其进行修改。当被破坏时，它将恢复设置。它会像这样使用：

```
using(RegistryModification mod = new RegistryModification("HKCR\SomeValue", 42))
{
    // reg value now modified to 42, do stuff
} // Object gets disposed, which contains code to revert back the setting 
```

如果只进行 1 次修改，应该会很好用。但是，如果进行了多次修改，或者调用者没有使用“使用”构造创建对象，我会看到出现问题。

```
public void Foo()
{
    // assume HKCR\SomeValue starts as '13'

    // First object reads HKCR\SomeValue and stores '13', then modifies to 42
    RegistryModification mod1 = new RegistryModification("HKCR\SomeValue", 42); 

    // Next object reads HKCR\SomeValue and stores '42', then modifies to 12
    RegistryModification mod2 = new RegistryModification("HKCR\SomeValue", 12);

}
// objects are destroyed. But if mod1 was destroyed first, followed by mod2,
// the reg value is set to 42 and not 13\. Bad!!! 
```

如果调用者手动处理对象，问题会变得更糟。这使我认为我的方法简单地说是有缺陷的。

是否有某种公认的模式来解决这个问题？我在想向班级添加一个静态堆栈可能会有所帮助。

对象被销毁的顺序是否有任何保证？我想我会尝试使用 IDisposable，但我对其他解决方案全心全意。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T21:58:37.987

IDisposable 不保证以这种方式回滚，您所描述的是回滚。Dispose() 方法并非用于此目的，而是负责释放对象拥有的本机资源（网络连接、文件等）

然而，一种恢复状态的方法可以像这样完成

```
public void Foo(SomeObjectType theObject)
{
    int initialValue = theObject.SomeProperty;
    theObject.SomeProperty = 25;
    Console.Out.WriteLine("Property is:" + theObject.SomeProperty);

    // reset object.
    theObject.SomeProperty = initialValue;
    Console.Out.WriteLine("Property oringinal value is:" + theObject.SomeProperty);
} 
```

请记住，仅仅因为资源被释放，它不会逆转使用它执行的操作，如果你释放数据库连接，它不会撤消使用它执行的工作，只会破坏对象。

除非您使用回滚代码覆盖 Dispose()，这是对该方法的滥用，否则它不会提取您的值，这是您作为程序员的责任。我说这是对 dispose 方法的滥用的原因是因为 .net 文档说明了以下内容`Dispose()`

> 使用此方法关闭或释放实现此接口的类的实例所持有的非托管资源，例如文件、流和句柄。按照惯例，此方法用于与释放对象持有的资源或准备对象以供重用相关的所有任务。

这通常意味着例如将句柄释放给重量级的东西（例如一些 GDI 资源）。必须释放本机资源或有时将其置于某种状态，以避免内存泄漏或访问的不良后果。在这种情况下很容易说，也许在您的 Dispose 方法中，您应该将注册表设置回之前的状态，但我认为这不是 dispose 方法的意图。目的是释放资源并将它们恢复到可以再次使用的状态。您要做的是重置一个值（这本质上是另一个设置操作），在自定义 dispose 方法中执行该工作意味着您还缩短了稍后在不同上下文中的重用机会。

我的意思是，当您完成修改后，您必须编写显式代码以将对象设置回其初始状态。如果有多个操作，您可能可以将其存储在数据结构（例如堆栈）中并读回值，或者仅对一个操作使用上述简单方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T22:00:07.943

听起来您想使用该`System.Collections.Generic.Stack<T>`实现。每个修改都会将一个值压入堆栈，每个“撤消”都会将该值从堆栈中弹出。

[http://msdn.microsoft.com/en-us/library/3278tedw.aspx](http://msdn.microsoft.com/en-us/library/3278tedw.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T15:07:53.997

实现该模式有两种通用模式：“准备做某事；做它；清理”：

```
// 模式 #1

void FancyDoSomething(MethodInvoker ThingToDo)
{
  尝试
  {
    PrepareToDoSomething();
    ThingToDo.Invoke(); // “.Invoke”是可选的；括号不是。
  }
  最后
  {
    清理（​​）;
  }
}

无效我的代码（无效）
{
  FancyDoSomething(() => {这里要做的事情});
}

// 模式#2：

// 定义一个 ActionWrapper 以便它的构造函数准备做某事
// 及其 Dispose 方法执行所需的清理。然后...

无效我的代码（无效）
{
  使用(var wrap = new ActionWrapper())
  {
    要做的事情在这里
  }
}

```

模式#2 在某些方面更加通用，因为它允许不遵循严格嵌套规则的使用模式。这是`IEnumerator<T>`使用该模式而不是简单地拥有一个接受委托并在每个列表项上调用它的枚举方法的部分原因。如果必须遵守枚举器的嵌套语义，那么尝试执行列表合并之类的操作充其量是很尴尬的。

另一方面，某些类型的受保护资源只能以严格嵌套的方式有意义地使用。因此，上面给出的第一种方法有时可能更合适，因为它在任何特定线程中严格执行嵌套语义。

如果您不想使用第一种方法，我建议您应该安排您的对象，以便`Disposing`与受保护资源关联的实例将使其之后生成的所有实例无效。为了最大限度地减少“延迟惊讶”因素，您可能希望在创建第一个包装器对象时让资源分配一个线程亲和性，并禁止任何其他线程访问，直到所有包装器都被`Dispose`d（如果线程创建的对象不再存在，如果线程在对象消失之前似乎不太可能对对象做任何坏事）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T22:01:44.067

使用静态工厂方法而不是构造函数来获取对象，并有一个静态的操作堆栈（类可以理解但不需要整个对象来表示的`RegistryModification`一些简化表示，指示其对象是否已被释放`RegistryModifcation`) 在`RegistryModification`课堂上。生成新的时，在堆栈上粘贴一个表示。处置时，将表示标记为表示已处置的对象，并尝试从上到下反转堆栈中的动作（当您从未处置的对象中找到动作时停止）。

不确定使用您试图通过处置来释放的内存要花多少钱，但它应该可以工作。

# css - 如何使用 2 列获得此布局？

> ID：10306603
> 
> 赞同：0
> 
> 时间：2012-04-24T21:56:37.880
> 
> 标签：css, html

我需要做这样的事情：

[http://i.imgur.com/iT1wH.jpg](http://i.imgur.com/iT1wH.jpg)

第一个黑色列始终显示在页面的左侧。

我已经写了这段代码，但它不起作用：

**HTML：**

```
<html>
<head>
    <link rel="stylesheet" href="home.css" type="text/css" media="all" />
</head>

<body>
<div id="allcontent">

<div id="sidebar"> </div>

<div id="center">

<p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p> <p> TEST </p>

</div>

</div>
</body>
</html> 
```

**CSS：**

```
#allcontent{ width:1000px; margin:auto; }

#center{ 
border-right:solid 1px #d0d9e8; height:80%; width:760px;
padding: 35px 10px 10px 0px;
float:right;
}

#sidebar { 
width:200px; height: 100%; float:left;  
background:#000;
border:solid 1px black;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:00:55.003

将两者的边距设置为 0，将边栏的边距设置为 0

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T09:49:29.813

嘿，我认为你应该`display table properties` 像这样使用

**CSS**

```
 #allcontent{ width:1000px; margin:auto;
display:table;}

#center{ 
border-right:solid 1px #d0d9e8;  width:760px;
padding: 35px 10px 10px 30px;
display:table-cell;
}

#sidebar { 
width:200px;
    display:table-cell;  
background:#000;
border:solid 1px black;
}​ 
```

现场演示[http://jsfiddle.net/99Ych/](http://jsfiddle.net/99Ych/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-24T22:04:18.280

在您的 CSS 中，您的黑色列中有 100% 的高度（它没有父级来继承它的高度），为了使 100% 的高度工作将您的列包装在具有定义高度的 div 中，您可以在此看到小提琴[http://jsfiddle.net/3YW2C/](http://jsfiddle.net/3YW2C/)通过定义高度，浮动实际上正在工作

# java - 乘以幂时可能会损失精度？

> ID：10306607
> 
> 赞同：0
> 
> 时间：2012-04-24T21:56:44.683
> 
> 标签：java, binary, precision, exponent

所以我正在研究一个简单的二进制到十进制脚本，并且在乘以幂时可能会丢失精度时发生错误。这是有问题的代码块，它所做的只是将二进制中的 1 和 0 乘以 2 的字符串长度的幂减去循环经过的迭代次数。然后将该结果添加到 z，并重复。

```
public int decimal(String x){
    int z=0;
    for(int a=0;a<x.length();a++){
        z=z+Integer.parseInt(x.substring(a,a+1))*Math.pow(2,x.length()-a);
    }
    return z;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T22:00:07.533

代替：

```
Math.pow(2,x.length()-a) 
```

和：

```
1 << (x.length() - a) 
```

只要整数不溢出，你就可以了。您不必要地使用`double`s，更不用说`Math.pow`它不是计算 2 的幂的最有效和最直接的方法。

顺便说一句，`decimal()`方法的重点是解析二进制字符串吗？如果是这样，试试这个：

```
public int decimal(String x){
  return Integer.parseInt(x, 2);
} 
```

对，就是那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T21:59:52.103

我相信您将**double**乘以**int**并将值存储在**int**中。一些铸造可能会解决它，试试这个；

```
public int decimal(String x){
    int z=0;
    for(int a=0;a<x.length();a++){
        z=z+(int)(Integer.parseInt(x.substring(a,a+1))*Math.pow(2,x.length()-a));
    }
    return z;
} 
```

并且按位命令将加速这一过程，并将完全消除强制转换的需要：

```
public int decimal(String x){
    int z=0;
    for(int a=0;a<x.length();a++){
        z+=Integer.parseInt(x.substring(a,a+1)) << (x.length()-a);
    }
    return z;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:25:52.187

你有一个错误。该函数返回一个两倍大的值。例如，`decimal("1") == 2`. 将其更改为`Math.pow(2,x.length()-1-a)`.

但由于结果是一个整数，最好用整数类型做所有事情，所以像其他人所说的那样使用左移。

您甚至不必计算 2 的幂。您每次只需将部分结果乘以 2。

```
public int decimal(String x) {
    int z=0;
    for (int a = 0; a < x.length(); a++) {
        z = 2 * z + Integer.parseInt(x.charAt(a));
    }
    return z;
} 
```

# php - 在 Freebase 中使用 API 密钥

> ID：10306611
> 
> 赞同：1
> 
> 时间：2012-04-24T21:56:59.413
> 
> 标签：php, freebase, api-key

我在读出信息时达到了 freebase 的用户限制。这当然与我不使用我在 Google API 控制台中生成的 API 密钥这一事实有关。

但我不知道我必须在哪里使用 API 密钥？使用谷歌地图，它位于 javascript 源的链接中。

我在哪里可以为 freebase 添加 API 密钥？

我正在使用此查询从 freebase 中检索我的信息：

```
https://www.googleapis.com/freebase/v1/mqlread?query={....} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:09:18.577

在此处查看[文档](https://developers.google.com/console/help/#WhatIsKey)。

相关部分是：

> API 密钥是您使用控制台生成的唯一密钥。当您的应用程序需要调用此项目中启用的 API 时，应用程序会将此密钥作为 **key=API_key**参数传递给所有 API 请求。使用此密钥不需要任何用户操作或同意，不授予对任何帐户信息的访问权限，也不用于授权。

# android - Samsung Charge RECORD_SOUND_ACTION Intent 在开始时未返回结果

> ID：10306617
> 
> 赞同：5
> 
> 时间：2012-04-24T21:57:59.423
> 
> 标签：android

我正在开发一个涉及让用户录制音频的应用程序。我正在使用以下意图来调用录音机。

```
Intent intent = new Intent(MediaStore.Audio.Media.RECORD_SOUND_ACTION);
intent.putExtra(android.provider.MediaStore.EXTRA_OUTPUT, Uri.fromFile(new File(path)));
startActivityForResult(intent, AUDIO_REQ); 
```

虽然这在模拟器和几乎所有经过测试的设备上都可以正常工作，但当我尝试在三星 Charge 上运行它时，录音机永远不会让我选择保存录音并返回我的活动。录制完成后，我会被发送到设备上所有录制音频的列表，然后从该列表中选择任何一个即可播放它们。我可以使用后退按钮返回调用 Activity，但这会导致`RESULT_CANCLED`结果代码，没有创建文件`path,`并且`data`onActivityResult 的参数为空。（如果我从意图中删除额外的数据，数据仍然为空`EXTRA_OUTPUT`，在这种情况下没有任何变化）

有谁知道使此设备上的录音机正常运行的方法？或者任何人至少可以确认这只是三星充电问题，而不是我在许多设备上必须担心的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T11:52:27.827

我在三星 Galaxy S SCL 上遇到了同样的问题。所以这个问题可能发生在许多设备中。也许最好的解决方案是实现自己的记录器，而不是使用内置的 Intent ......但不像上面建议的那样（我认为最好为应用程序提供统一的界面，而不是为每个设备使用不同的界面. 所以如果你必须编写自己的录制 GUI，为什么不将它用于所有设备？）。

所以无论如何，如果你找到了从记录器返回并获取数据的方法，如果你把它发布在这里会很好。谢谢

# asp.net - 如何在没有 ASP.NET MVC 的情况下使用 WebAPI？

> ID：10306620
> 
> 赞同：13
> 
> 时间：2012-04-24T21:58:08.570
> 
> 标签：asp.net, asp.net-web-api

我想将 WebAPI 用于我的现有项目（经典 ASP.NET），但据我所知，您只能将 WebAPI 与 MVC 一起使用。

是否可以将 WebAPI 与 ASP.NET 一起使用？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-24T22:05:39.383

从[链接页面](http://www.asp.net/web-api/overview/creating-web-apis/using-web-api-with-aspnet-web-forms)：

> 尽管 ASP.NET Web API 与 ASP.NET MVC 打包在一起，但很容易将 Web API 添加到传统的 ASP.NET Web 窗体应用程序中。本教程将引导您完成这些步骤。
> 
> 要在 Web 窗体应用程序中使用 Web API，有两个主要步骤：
> 
> 添加从 ApiController 类派生的 Web API 控制器。将路由表添加到 Application_Start 方法。创建 Web 窗体项目
> 
> 启动 Visual Studio 2010 并从“开始”页面中选择“新建项目”。或者，从“文件”菜单中，选择“新建”，然后选择“项目”。
> 
> 在 Templates 窗格中，选择 Installed Templates 并展开 Visual C# 节点。在 Visual C# 下，选择 Web。在项目模板列表中，选择 ASP.NET Web 应用程序。输入项目的名称，然后单击“确定”。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-24T22:35:08.457

ASP.NET Web API 和 ASP.NET MVC 生活在两个*不同*的世界中，尽管它们是*平行*的世界。

Web API 的设计和构建不依赖于 ASP.NET MVC，而是构建在 ASP.NET 之上。

因此，您的问题的答案 - 充满信心 - 是**正确的**。布拉德威尔逊本人最近在播客中提到了这一点。

# asp.net - 树视图中的标签不起作用

> ID：10306625
> 
> 赞同：0
> 
> 时间：2012-04-24T21:58:36.070
> 
> 标签：asp.net, treeview, anchor

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:12:29.183

尝试使用 TreeNode 的[NavigateUrl](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treenode.navigateurl.aspx)属性来提供目标链接。

```
newNode.Text = filesInDirectory[ctr].Name;
newNode.NavigateUrl = StringToURL(filesInDirectory[ctr].FullName); 
```

# tags - 标签对指示器

> ID：10306627
> 
> 赞同：0
> 
> 时间：2012-04-24T21:58:38.783
> 
> 标签：tags, html-parsing

是否有软件可用于在（网络）文档中突出显示/匹配标签对 - 指示开始和结束标签（例如`<div>....</div>`，`{...}`等），即使标签是嵌套的？

# java - C2DM - 从服务器成功发送消息，但未显示在设备上

> ID：10306630
> 
> 赞同：1
> 
> 时间：2012-04-24T21:58:50.983
> 
> 标签：java, android, android-c2dm

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T11:18:59.913

嗯，有趣的事情发生了。虽然我没有对前一天晚上的代码进行任何更改，但当我今天早上醒来打开 Wifi 时，我收到了一条消息。

现在一切正常。只要我发送消息，我就会自动进入设备。（是的，我的 Wifi 昨晚也开了）

我不确定是什么导致了延迟，因为我收到了来自 Google 服务器的肯定响应代码，但我的设备上没有。发送第一条消息可能需要一些时间？我不知道。

我尝试了其他 Wifi 网络，它也可以工作。希望我不会再碰到这个。尽管如此，我还是觉得这种行为有点奇怪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T08:59:10.050

GCM 通知作为背景数据发送到您的设备。

启用您的后台数据，它位于

> 设置>帐户和同步>后台数据

# jquery - 将数组从外部 js.file 传递到路由

> ID：10306633
> 
> 赞同：0
> 
> 时间：2012-04-24T21:59:04.040
> 
> 标签：jquery, node.js, routes, express

我正在使用 Express 构建基于 Node.js 的应用程序，该应用程序显示来自数据库的图像。

现在我正在研究从显示的图像创建相册的功能，这是通过单击图像来完成的。然后将图像 ID 和名称推送到外部 js 文件中的数组中。当用户完成向相册添加图像时，他单击一个按钮（在表单内），该按钮由路由处理。

问题是如何访问路由中外部 js 文件中的数组？甚至可能吗？

提前致谢！

更新：

我试图实现[@andy 的解决方案](https://stackoverflow.com/a/10311581/937624)，**但我在控制台中得到了 404**。我想我在这里做错了什么？

external.js（包含在 html 文件的标头中）：

```
$('#saveAlbum').click(function (){          
    $.post('http://localhost:3000/createAlbum', { arr: ['val1', 'val2'] })
}); 
```

专辑控制器.js：

```
app.post('/createAlbum', function(req, res) {
    console.log(req.body.arr);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T07:55:44.043

如果您需要将数据从客户端传递到 Express，您可以使用 jquery 的 $.post() 将其发送到特殊路由：

```
var express = require('express');
var app = express.createServer();

app.configure(function(){
  app.use(express.bodyParser());
});

app.post('/for_receive_array', function(req, res) {
  //req.body - body passes your array
});

app.listen(8000); 
```

对不起，如果我不明白你的目的。最好看看你的代码。

# android - 在 android 的 Star TSP100 打印机上创建光栅收据

> ID：10306639
> 
> 赞同：2
> 
> 时间：2012-04-24T21:59:26.650
> 
> 标签：android, printing, receipt, javapos, stario-sdk

我正在尝试创建一张收据，该收据将从 android 设备打印到 TSP100 Star 打印机。我到处搜索，找不到打印光栅化收据的简单示例（因为 TSP100 只接受光栅）。我向 Star 发送了电子邮件，他们向我发送了以下代码，但我不确定这是否正确，或者如何将其转换为格式化的位图并打印出来。

```
 byte[] data;
    ArrayList<Byte> list = new ArrayList<Byte>();

    Byte[] tempList;
    list.addAll(Arrays.asList(new Byte[]{0x1b, 0x1d, 0x61, 0x01}));

    data = "[If loaded.. Logo1 goes here]\r\n".getBytes();
    tempList = new Byte[data.length];
    CopyArray(data, tempList);
    list.addAll(Arrays.asList(tempList));

    list.addAll(Arrays.asList(new Byte[]{0x1b, 0x1c, 0x70, 0x01, 0x00, '\r', '\n'}));  //Stored Logo Printing

    data = "Company Name\r\n".getBytes();
    tempList = new Byte[data.length];
    CopyArray(data, tempList);
    list.addAll(Arrays.asList(tempList));

    data = "Street1\r\nCity, ST, ZIPCODE\r\n\r\n".getBytes();
    tempList = new Byte[data.length];
    CopyArray(data, tempList);
    list.addAll(Arrays.asList(tempList));

    list.addAll(Arrays.asList(new Byte[]{0x1b, 0x1d, 0x61, 0x00})); // Alignment

    list.addAll(Arrays.asList(new Byte[]{0x1b, 0x44, 0x02, 0x10, 0x22, 0x00})); //Set horizontal tab

    data = "Date: 2/22/2012".getBytes();
    tempList = new Byte[data.length];
    CopyArray(data, tempList);
    list.addAll(Arrays.asList(tempList));

    list.addAll(Arrays.asList(new Byte[]{' ', 0x09, ' '}));   //Moving Horizontal Tab

    data = "Time: 9:18 PM\r\n------------------------------------------------\r\n\r\n".getBytes();
    tempList = new Byte[data.length];
    CopyArray(data, tempList);
    list.addAll(Arrays.asList(tempList));

    list.addAll(Arrays.asList(new Byte[]{0x1b, 0x45})); // bold

    data = "SALE \r\n".getBytes();
    tempList = new Byte[data.length];
    CopyArray(data, tempList);
    list.addAll(Arrays.asList(tempList));

    list.addAll(Arrays.asList(new Byte[]{0x1b, 0x46})); // bolf off

    data = "SKU ".getBytes();
    tempList = new Byte[data.length];
    CopyArray(data, tempList);
    list.addAll(Arrays.asList(tempList));

    list.addAll(Arrays.asList(new Byte[]{0x09}));

    // notice that we use a unicode representation because that is how Java expresses these bytes at double byte unicode
    // This will TAB to the next horizontal position
    data = " Description   \u0009         Total\r\n".getBytes();
    tempList = new Byte[data.length];
    CopyArray(data, tempList);
    list.addAll(Arrays.asList(tempList));
data = "34353434 \u0009  SP500\u0009        100.99\r\n".getBytes();
    tempList = new Byte[data.length];
    CopyArray(data, tempList);
    list.addAll(Arrays.asList(tempList)); 
```

ETC..

现在从ArrayList 列表中获取到打印机的位图。一个简单的收据示例将有助于创造奇迹。我已经向 STAR 提出了要求，但不确定他们需要多长时间才能回来。我想外面一定有人这样做了。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T03:31:42.630

你从哪里得到那个代码？这实际上是我不久前创建的收据的一小部分。我是 Kale Evans，在 Star Micronics 工作。

此示例向您展示如何将数据作为原始文本发送到打印机。如果您希望将光栅数据发送到打印机，则必须将收据呈现为 android 位图，然后在我相信的 PrintImageAsBitmap 函数中将其作为参数传递（或类似名称。看看 rasterprinting 活动）。

# java - 如何在java中按位移动二进制字符串？

> ID：10306647
> 
> 赞同：1
> 
> 时间：2012-04-24T22:00:03.307
> 
> 标签：java, binary, hex, bit-manipulation

我有一个 10 位二进制字符串，我必须在每次迭代时循环移位。我很困惑，迷失了。它背后的逻辑可能是什么？如果它是一个十六进制数，我们可以通过 num>>1 或 num<<1 来完成，但是像“1010101010”这样的字符串应该在我们应用按位移位之前转换为十六进制。我必须循环应用按位移位 10 次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:23:59.270

Integer 类中有一些方法可以与二进制字符串相互转换。

```
 int i = Integer.parseInt("1010101010", 2);
    String shiftedi = Integer.toBinaryString(i<<1); 
```

编辑，虽然上面不是循环的，但您可以使用简单的字符串操作：

```
String in = "1010101010";
String shifted1 = in.substring(1)+in.substring(0,1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T22:37:35.767

假设您正在处理`String`包含零和一的 a（也称为“二进制字符串”），按位移位很容易。

要“左移”，请在每个“左移”的右端添加一个“0”字符。

要“右移”，事情要复杂一些。假设您总是处理二进制中的“正数”，请为每个“右移”删除右端的一个字符。如果您希望进行“符号扩展右移”，那么您需要检查字符串的长度以查看它是否是 2 补码形式的二进制值的特定编码的“最大长度”，然后您需要删除如果最左边的字符已经是“1”，则最右边的字符和可选的在左边添加一个“1”字符。

现在，由于字符串的长度不受限制（而 WORD 和 DWORD*是*），因此不清楚`>>>`运算符是否对二进制字符串*有意义*，或者即使*负数的 2 的补码表示对*二进制字符串有意义，除非你强加一个“限制”字符串中有效字符的数量。如果您想在两个二进制字符串之间进行任何类型的二进制数学运算，则该限制对于两个二进制字符串必须相同（或对较小的字符串具有提升规则）。

另一种选择是将字符串转换为整数并对整数使用二进制操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T22:06:32.743

一般来说，如果要进行数字运算，最好对数字进行。所以我建议将你的字符串转换为它实际代表的 int （或其他）。然后，如果需要，您可以进行位移，然后返回字符串。

如果您只想进行文本操作，那么您可以使用 StringBuffer 并玩弄字符。

```
StringBuffer s = new StringBuffer("1010101010");
for(int i=0; i<10; i++) {
    char c = s.charAt(0);
    s.append(c);
    s.deleteCharAt(0);
}
String result = s.toString(); 
```

但如果你只是想做数学，那就太丑了

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T22:26:49.867

```
int bits = Integer.parseInt ("010101010", 2); 
```

将 String 转换为 int。“在我们应用按位移位之前转换为十六进制”是胡说八道 - 抱歉。Hex 只是一种表示 int 的方式（例如）。你移动 int 值，而不是它的表示。

# cryptography - 使用 AES 编码文件

> ID：10306653
> 
> 赞同：1
> 
> 时间：2012-04-24T22:00:22.220
> 
> 标签：cryptography, aes

我正在用 C 编写服务器，我想用 aes 对文件进行编码。

据我所知，编码块大小应该等于 AES 密钥长度，所以我需要用零将最后一个块补足到所需的大小。问题在于解码：如何区分文件内容和补零？好吧，我计划为此使用 Base64 编码，但是对于大文件来说是不是太慢了？可能我应该在发送编码块之前发送文件大小吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:19:56.393

一个常见的方案是 PKCS#5 填充。基本上，用等于填充长度的字节填充（明文的）填充。然后，解密后，查看最后一个字节，看看要丢弃多少。确认丢弃的字节相同可提供快速的完整性检查。一些示例，以十六进制表示：

```
[AABBCCDD EEFF0011 22334455 667788--] -> [AABBCCDD EEFF0011 22334455 66778801]
[AABBCCDD EEFF0011 22334455 66------] -> [AABBCCDD EEFF0011 22334455 66030303]
[AABBCCDD EEFF0011 22334455 66778899] -> [AABBCCDD EEFF0011 22334455 66778899][10101010 10101010 10101010 10101010]
//the last byte must be padding, even if that requires an extra block 
```

旁注：如果您自己实施加密，请阅读操作模式。如果不是，那么您使用的任何库都应该能够处理填充。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T22:18:09.167

对文件进行 Base64 编码然后进行 AES 加密并不是一个好主意。这样做通过将密文的每个字节的高 2 位设置为已知值，将可能的块数从 2^64 减少到 2^48。

我不确定这是“最好”还是“正常”的方法，但我通常会在我的密文的开头或结尾添加几个额外的块，这些块将解密为有关文件的元数据 - 大小、文件名、内容类型等。是的，这些块的熵非常小，但允许一个或两个带有婴儿床的块比让每个字节包含一个要好得多。

例如，如果您有一个 10 字节长的文件，那么您将拥有一个完整的密文块，该块包含两个有用字节，后跟 6 个字节的填充。最后一个块将包含您的元数据。（实际上，元数据块可以放在开头或结尾。随你选。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:45:32.603

请参阅有关填充方案的此页面：

[http://en.wikipedia.org/wiki/Padding_](http://en.wikipedia.org/wiki/Padding_(cryptography) (密码学)

例如对于 CBC 模式：

> 一种方法是用 1 位后跟 0 位来填充最后一个块。如果输入恰好填满了整个块，则会添加一个“虚拟块”来容纳填充；否则，输入明文的结尾可能会被误解为填充。另一种方法是在明文末尾附加 n 个字节，其值为 (n-1)，以填充一个完整的块。如果消息已经完全填满了一个块，那么出于与之前相同的原因，将添加一个完整的填充块块。这意味着填充是一个字节的 0 或两个字节的 1 等。

如果您使用 CTR 模式，则甚至不需要填充，因为密文与纯文本的大小相同。

正如@maybewecouldstealavan 所指出的，流行的填充方案是来自 RSA 实验室的 PKCS #5。这是 OpenSSL 程序用于 CBC 模式的填充方案。

> 所有分组密码通常使用 PKCS#5 填充，也称为标准分组填充：这允许执行基本的完整性或密码检查。

[http://www.openssl.org/docs/apps/enc.html](http://www.openssl.org/docs/apps/enc.html)

# content-management-system - Liferay：更改网页内容中文档链接的 URL 格式（期刊文章）

> ID：10306654
> 
> 赞同：0
> 
> 时间：2012-04-24T22:00:27.640
> 
> 标签：content-management-system, liferay, document

是否可以更改网页内容（期刊文章）内文档链接的 URL 格式。在 url 中查看此文档的 mime 类型对我来说是有用的。`a`向元素添加一些css类可能很简单，比如`<a class="pdf" href="...`

最后要求是在这些链接之前显示不同的图标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-06T22:22:49.710

您可以使用`journal.transformer.regex`查看文档`portal.properties`：

```
journal.transformer.regex.pattern.0=<a href="/documents/(.*\.)(pdf|doc)("|(/.*"))>
journal.transformer.regex.replacement.0=<a class="$2" href="/documents/$1$2$3> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T06:16:14.850

您是否使用 ckEditor 中可用的链接标签来包含文档链接？如果是，则添加链接时弹出的对话框有第三个选项卡，称为“高级”，您可以在其中指定样式表类。

# jenkins - 批量复制类似 Jenkins 作业的最简单方法

> ID：10306656
> 
> 赞同：4
> 
> 时间：2012-04-24T22:00:28.117
> 
> 标签：jenkins, automated-tests

有没有更简单的方法来批量复制 Jenkins 工作？基本上我想要做的是将所有作业从特定视图复制到另一个视图并将几个参数更改为不同的值。

例如，我有一个视图调用 Host_1_Test_Jobs。此视图中的所有作业都有一个“host”和“plan_id”参数。我希望能够将所有这些作业复制到另一个视图，并一举更改所有这些作业的两个参数。

我可以通过复制作业目录和配置文件来编写 Python 脚本来执行此操作，但我想知道是否有更简单或更常见的方法来执行此操作。

或者也许有更好的方法来配置这些作业，这样我就不必创建多个副本（尽管我仍然希望每个主机的测试结果有单独的视图，并且需要能够并行运行这些作业）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T13:49:21.473

[使用cloudbees 文件夹插件](https://wiki.jenkins-ci.org/display/JENKINS/CloudBees+Folders+Plugin)很容易做到这一点，您可以通过更新中心的 cloudbees 插件网关免费获得该插件。

~~您可以创建由文件夹级别定义的环境变量参数化的作业文件夹。然后，您可以复制该文件夹并更改该文件夹的环境变量。该新文件夹中的所有作业现在都将使用更新后的值。~~

您还应该了解 CloudBees 的 Jenkins Enterprise 付费许可证附带的模板插件。模板的优点是您可以在事后在一个地方更新它们，这是其他方法所不具备的。

注意：我是 CloudBees 的员工。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T22:08:35.043

您可能希望使用[Matrix build](https://wiki.jenkins-ci.org/display/JENKINS/Building+a+matrix+project)来查看，它可以让您运行一个具有多种配置的参数化作业。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T12:20:41.823

你可以试试：[Jenkins-maven-plugin](http://evgeny-goldin.com/wiki/Jenkins-maven-plugin)。

它允许您使用 XML 创建作业并创建作业层次结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-28T19:05:28.807

使用“view-clone”插件。使用视图克隆，您可以克隆视图中的所有项目并将字符串替换为您想要的字符串。检查此链接：[https ://wiki.jenkins-ci.org/display/JENKINS/ View+Cloner+Plugin。对](https://wiki.jenkins-ci.org/display/JENKINS/View+Cloner+Plugin.For)我来说，克隆部分正在工作，但创建视图部分失败。不知道为什么。

# ajax - 使用 AJAX 进度条长时间运行的 Plone 操作

> ID：10306661
> 
> 赞同：1
> 
> 时间：2012-04-24T22:00:48.347
> 
> 标签：ajax, progress-bar, plone

我想在 Plone 中运行需要很长时间才能完成的任务（分钟）。在任务期间，我可以使用 AJAX 显示进度条。

是否有任何现成的 Plone 库/附加组件允许您将任务序列化并自动提供 AJAX 状态报告，而无需手动拆分和维护服务器上长时间运行的任务状态？

例如

*   您使用 start() 方法启动任务

*   任务使用 getStatus() 或类似方法给出状态

*   框架将处理使任务异步并具有跟踪任务状态的前端代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T01:35:21.613

[netsight.async](http://pypi.python.org/pypi/netsight.async)可以做到这一点。

# python - OpenCL：内核永远挂起，除非我删除参数

> ID：10306669
> 
> 赞同：0
> 
> 时间：2012-04-24T22:01:15.940
> 
> 标签：python, opencl, pyopencl

这是 OpenCL 1.1 ，使用英特尔 SDK (1.5 x64)。PyOpenCL 2011.2。我在 Linux (Fedora) 上。

下面的代码打印`"DERP1"`，但没有别的。

```
import pyopencl as cl
import numpy
import struct

ctx = cl.create_some_context()
queue = cl.CommandQueue(ctx)
mf = cl.mem_flags

board = numpy.zeros((10, 24), dtype=numpy.int8)
board_buf = cl.Buffer(ctx, mf.READ_ONLY | mf.COPY_HOST_PTR, hostbuf=board)

can_move = numpy.zeros(1, dtype=numpy.int8)
can_move_buf = cl.Buffer(ctx, mf.READ_WRITE | mf.COPY_HOST_PTR, hostbuf=can_move)

program = cl.Program(ctx, """
__kernel void can_move(
    __global const char *board,
    const char2 board_size,
    __global char *can_move)
{
    *can_move = 1;
}
""").build()

move = program.can_move(queue, board.shape, None,
    board_buf, #__global const char *board,
    struct.pack('bb', 10, 24), #__global const char2 board_size
    can_move_buf) #__global *can_move

result = numpy.empty_like(can_move)
print "DERP1"
move.wait()
print "DERP2"
cl.enqueue_copy(queue, result, can_move_buf)
print "DERP3"

print result 
```

它打印`"DERP1"`然后继续工作。

但是，如果我删除第一个或第二个参数（即`board`or `board_size`），程序会停止并按`[1]`我的预期打印。

到底是怎么回事？我如何按照我的意思进行这项工作？

* * *

**编辑：** `top`持续报告超过 350% 的 CPU 使用率。如果我将 global_size 从`board.shape`(ie `(10, 24)`) 替换为`(1,)`(ie only one task in a dimension)，那么我得到大约 100% 的 CPU 使用率。对我来说，这表明这一项任务一直在不停地忙循环运行，但我不知道为什么。对于这个任务，与 10*24 任务一样，如果我删除第一个或第二个参数，它就会停止。

* * *

**edit2:** : 我很确定这是 PyOpenCL 的问题吗？我尽可能地将示例移植到 C 中，其结果可以在[此处](http://codepad.org/J8nFTwzM)找到，但 C 示例没有挂起。谁能发现一些差异或找出问题所在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T20:11:32.597

我将您的代码剪切并粘贴到一个文本文件中并在我的系统上运行它，它运行得很好。

```
jmt@belle:~$ python djhang.py
DERP1
DERP2
DERP3
[1]
jmt@belle:~$ 
```

我确实注意到您的代码中有两件事我在示例代码或我自己的代码中都没有看到。我使用元组来表示大小——例如 (64,) 用于 1D 内核， (64,64,) 用于 2D 内核。那对你有用吗？另外，我将 wait() 调用直接放在程序执行调用之后。数组创建应该与 OpenCL 的东西正交，但我只是不喜欢它们之间有任何东西。

希望有帮助！

# css - CSS 特异性、媒体查询和最小宽度

> ID：10306670
> 
> 赞同：33
> 
> 时间：2012-04-24T22:01:20.420
> 
> 标签：css, media-queries, css-specificity

我正在重新设计我的博客，考虑到响应式网页设计和“移动优先”方法 - 简而言之，我正在尝试使用最小宽度来避免任何类型的复制或 css .. 没有显示：无等。

我的问题是，当我确实需要覆盖 CSS 值时，较低的最小宽度优先。例子：

```
@media only screen and (min-width: 600px) {
    h2 { font-size: 2.2em; }
}

@media only screen and (min-width: 320px) {
    h2 { font: normal 1.7em/2.1em Helvetica, sans-serif; }
} 
```

我希望当我在 600 像素及以上的分辨率下获得 2.2em h2，但我得到 1.7em。在我的开发工具中，我看到 2.2em 声明在那里，但另一个优先。 . 这没有意义！

我可以在不使用更强的选择器或最大宽度的情况下继续使用最小宽度并有效地覆盖更高分辨率的声明吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-25T19:09:00.280

> 我希望当我在 600 像素及以上的分辨率下获得 2.2em h2，但我得到 1.7em。在我的开发工具中，我看到 2.2em 声明在那里，但另一个优先。 . 这没有意义！

这说得通。如果媒体履行了`min-width: 600px`，那么它也应该履行`min-width: 320px`；换句话说，任何至少 600 像素宽的东西也至少是 320 像素宽，因为 600 大于 320。

由于两个媒体查询都评估为真，最后出现的规则在级联中优先，使您的代码等效于：

```
h2 { font-size: 2.2em; }
h2 { font: normal 1.7em/2.1em Helvetica, sans-serif; } 
```

这就解释了为什么它`2.2em`出现在您的开发人员工具中但没有明显效果。

最简单的解决方法是切换`@media`块，以便规则以正确的顺序级联：

```
@media only screen and (min-width: 320px) {
    h2 { font: normal 1.7em/2.1em Helvetica, sans-serif; }
}

@media only screen and (min-width: 600px) {
    h2 { font-size: 2.2em; }
} 
```

# iphone - 导航栏上的标题视图在转场后的视图中不可见

> ID：10306671
> 
> 赞同：5
> 
> 时间：2012-04-24T22:01:25.557
> 
> 标签：iphone, ios, xcode, navigationbar

我正在制作一个 iPhone 应用程序，并希望在导航栏的 titleview 位置显示一个徽标。我创建了 UINavigationController 的子类，并在 viewDidLoad 中添加了以下行：

```
self.navigationBar.topItem.titleView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"titlelogo.png"]]; 
```

（这对于一行来说似乎是一种浪费，但我在多个地方使用它，并且出于各种原因我不想使用 [UINavigationBar 外观]）

这适用于导航控制器的直接子级 - 我看到了徽标。但是，当我将 segue 推到另一个视图时，徽标不会延续，即使它们（据我所知）是“相同”导航控制器的一部分。

（供参考）-> MyNavigationController -> SomeViewController -> SomeOtherViewController

我还尝试使用以下方法进入 SomeOtherViewController 的 viewDidLoad：

```
 self.navigationController.navigationBar.topItem.titleView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"titlelogo.png"]]; 
```

这仍然没有显示徽标。

经过一番摸索，我发现如果 1）我在导航控制器的 viewDidLoad 中没有该行，并且 2）我在 SomeOtherViewController 的 viewDidLoad 中确实有第二行，那么：

开始：查看 SomeViewController。没有标志。Click to push segue：徽标现在出现在 SomeViewController 的栏上，然后消失。我现在正在查看没有徽标的 SomeOtherViewController:。点击返回：SomeViewController 的导航栏仍然有 logo。

显然我误解了导航控制器的工作原理。谁能告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:05:57.427

如果我理解正确，你也可以用另一种方法来做，只需用图像替换整个**NavigationBar**？在那里你可以放置你的图标。

因为更改整个 NavigationBar 非常容易。

```
if ([self.navigationBar respondsToSelector:@selector( setBackgroundImage:forBarMetrics:)]) {
  [self.navigationBar setBackgroundImage:[UIImage imageNamed:@"navigationbar.png"] forBarMetrics:UIBarMetricsDefault];
} 
```

您需要将此代码放入**NavigationController**`viewDidLoad`的方法中。然后它也应该在你推送到 NavigationController 堆栈上的 ViewControllers 中工作。

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-19T10:50:43.670

尝试使用

```
self.navigationItem.titleView = yourCustomView; 
```

而不是

```
self.navigationController.navigationBar.topItem.titleView = yourCustomView; 
```

并且根本不要触摸`self.navigationController.navigationBar.topItem.titleView`。起初我试图将它们都设置为`yourCustomView`，我的自定义视图出现了一瞬间然后消失了我不知道在哪里:)**

# dictionary - 您如何遍历两个字典并在同一路径中获取值？

> ID：10306672
> 
> 赞同：2
> 
> 时间：2012-04-24T22:01:31.703
> 
> 标签：dictionary, python

我有两个结构相似的字典……这意味着它们（应该）具有相同的键结构，即使在嵌套键中也是如此。此外，这些字典几乎可以具有任何类型的嵌套结构......列表、字典等......我希望能够遍历这些字典，并获取两个值并从函数中返回它们。

简单示例：

```
dict_a = {'a':1, 'b':2, 'c':{'d':3}}
dict_b = {'a':2, 'b':4, 'c':{'d':6}}
#Note the structure is the same for these dicts
#I want to be able to do something like:
>>get_values( dict_a, dict_b)
[(1,2),(2,4),(3,6)] 
```

我自己想出了一个解决方案，方法是遍历一个字典，并将每个键（或索引，如果它遇到一个列表）附加到一个列表中......作为一种键路径：

```
key_map = []#A list of all key-paths for a dictionary
generate_key_paths(dict_a, [], key_map)
def generate_key_paths(value, key_list,key_map ):

    new_list = [item for item in key_list]
    if isinstance( value, dict):
        #Handle list
        for key, val in value.iteritems():
            new_list.append( key)
            self._generate_key_paths( val, new_list, key_map )
            new_list = [item for item in key_list]

    elif isinstance( value, list ):
        #Handle list
        for idx,item in enumerate(value):
            new_list.append( idx )  
            self._generate_key_paths( item, new_list, key_map )
            new_list = [item for item in key_list]
    else:
        #Handle data--reached farthest point you can go
        #So just append (key-path, value) to key_map
        key_map.append((new_list, value ) ) 
```

然后一旦你有一个键路径列表，值元组......选择路径，并尝试在第二个字典上到达它以获得它的值......

```
val_list = []
for item in key_map:
    value = get_value( item[0] )
    if value is not None:
        val_list.append( (item[1], value ) )
def get_value( key_list ):
    value = dict_b
    for item in key_list:
        try:
            value = value[item]
        except:
            value = None
            break
    return value 
```

这对于字典可能具有的所有结构都非常有效，但看起来工作量很大。有没有更蟒蛇的方式来实现这一点？有没有更快、更有效的方法？

编辑：我正在寻找一个不是列表或字典的值，所以当达到这些值时，它应该在它们内部迭代，直到找到一个值。可以保证，如果它是一个列表，它将是一个字典列表，因此应该始终遵循某种键：值关系。

例如，一个可能的 dict 可能如下所示：

`dict_a = {'a':1, 'b':2, 'c':[{'d':5},{'e':6}]}`

`dict_b = {'a':2, 'b':4, 'c':[{'d':10},{'e':12}]}`

回答：`[(1,2), (2,4), (5,10), (6,12)]`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T22:14:53.503

您正在寻找`flatten(zipTree(...))`（不存在但其名称应该让我明白的功能）的等价物。

```
from collections import Mapping

def treezipFlat(t1,t2):
    if isinstance(t1,Mapping) and isinstance(t2,Mapping):
        assert set(t1)==set(t2)
        for k,v1 in t1.items():
            v2 = t2[k]
            for tuple in treezipFlat(v1,v2):
                yield tuple
    else:
        yield (t1,t2) 
```

演示：

```
>>> dict_a = {'a':1, 'b':2, 'c':{'d':3}}
>>> dict_b = {'a':2, 'b':4, 'c':{'d':6}}
>>> list( treezipFlat(dict_a, dict_b) )
[(1, 2), (3, 6), (2, 4)] 
```

您还可以通过像这样扩充函数来生成路径元组：

```
from collections import Mapping

def treezipItems(t1,t2, path=[]):
    if isinstance(t1,Mapping) and isinstance(t2,Mapping):
        assert set(t1)==set(t2)
        for k,v1 in t1.items():
            v2 = t2[k]
            for tuple in treezipItems(v1,v2, path=path+[k]):
                yield tuple
    else:
        yield (path, (t1,t2))

>>> list( treezipItems(dict_a, dict_b) )
[(['a'], (1, 2)), (['c', 'd'], (3, 6)), (['b'], (2, 4))] 
```

恕我直言，我觉得这里很自然的是一个名为`treezip`：

```
def treezip(t1,t2):
    if isinstance(t1,Mapping) and isinstance(t2,Mapping):
        assert set(t1)==set(t2)
        R = {}
        for k,v1 in t1.items():
            v2 = t2[k]
            R[k] = treezip(v1,v2)
        return R
    else:
        return (t1,t2)

>>> from pprint import pprint as pp
>>> treezip(dict_a, dict_b)
{'a': (1, 2), 'c': {'d': (3, 6)}, 'b': (2, 4)} 
```

然后调用一个函数`flattenValues`（或者`flattenItems`如果你想保留键）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T23:47:00.440

```
dict_a = {'a':1, 'b':2, 'c':{'d':3,'e':{'f':4}}}
dict_b = {'a':2, 'b':4, 'c':{'d':6,'e':{'f':7}}} 
```

这是第一个版本，只是解包和组合

```
def gen(dict1, dict2):
    for key in dict1:
        if isinstance(dict1[key],dict):
            for item in gen(dict1[key],dict2[key]):
                yield item
        else:
            yield dict1[key], dict2[key]

# prints [(1, 2), (4, 7), (3, 6), (2, 4)]
print list(gen(dict_a, dict_b)) 
```

这是第二个版本，它也对源进行排序（但我认为，最好对结果列表进行排序）

```
def gen(dict1, dict2):
    for key in sorted(dict1):
        if isinstance(dict1[key],dict):
            for item in gen(dict1[key],dict2[key]):
                yield item
        else:
            yield dict1[key], dict2[key]

print list(gen(dict_a, dict_b))

# prints [(1, 2), (2, 4), (3, 6), (4, 7)]
print list(gen(dict_a,dict_b)) 
```

这个 src 基于 flatten 生成器，可以在许多不同的 tuts 中找到

# java - 在属性文件中保护密码

> ID：10306673
> 
> 赞同：73
> 
> 时间：2012-04-24T22:01:32.103
> 
> 标签：java, security

我有一个连接到数据库的 java 应用程序。
数据库的用户名和密码存储在属性文件中。
避免在属性文件中以明文形式存储密码同时仍保留让用户更改密码的选项的常见做法是什么？
这里的主要动机是防止有人在管理员编辑属性文件时越过管理员的肩膀看到密码。[我在这里](https://stackoverflow.com/q/4155187/162056)
读到有一种内置的方法可以在 C# 中执行此操作。 了解java，我不希望找到一个内置的解决方案，但我想听听其他人在做什么。

如果我没有找到任何好的选择，那么我可能会使用将保存在代码中的恒定密码对其进行加密。但我不想这样做，因为感觉不对。

**编辑 2012 年 12 月 12 日** 看起来没有魔法，我必须将密码存储在代码或类似的东西中。最后，我们实现了与答案之一中提到的 Jasypt 非常相似的东西。所以我接受 Jasypt 的答案，因为它是最接近明确答案的东西。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-04-25T00:10:58.727

# [![在此处输入图像描述](../Images/278605a0d726036dd1f452980d5ce1e3.png)](http://www.jasypt.org)

**Jasypt 提供[org.jasypt.properties.EncryptableProperties](http://www.jasypt.org/api/jasypt/1.8/org/jasypt/properties/EncryptableProperties.html)类用于加载、管理和透明解密 .properties 文件中的加密值，允许在同一文件中混合加密和未加密值。**

[http://www.jasypt.org/encrypting-configuration.html](http://www.jasypt.org/encrypting-configuration.html)

> 通过使用 org.jasypt.properties.EncryptableProperties 对象，应用程序将能够正确读取和使用 .properties 文件，如下所示：

```
datasource.driver=com.mysql.jdbc.Driver 
datasource.url=jdbc:mysql://localhost/reportsdb 
datasource.username=reportsUser 
datasource.password=ENC(G6N718UuyPE5bHyWKyuLQSm02auQPUtm) 
```

> 请注意，数据库密码是加密的（事实上，任何其他属性也可以加密，无论是否与数据库配置有关）。
> 
> 我们如何读取这个值？像这样：

```
/*
* First, create (or ask some other component for) the adequate encryptor for   
* decrypting the values in our .properties file.   
*/  
StandardPBEStringEncryptor encryptor = new StandardPBEStringEncryptor();     
encryptor.setPassword("jasypt"); // could be got from web, env variable...    
/*   
* Create our EncryptableProperties object and load it the usual way.   
*/  
Properties props = new EncryptableProperties(encryptor);  
props.load(new FileInputStream("/path/to/my/configuration.properties"));

/*   
* To get a non-encrypted value, we just get it with getProperty...   
*/  
String datasourceUsername = props.getProperty("datasource.username");

/*   
* ...and to get an encrypted value, we do exactly the same. Decryption will   
* be transparently performed behind the scenes.   
*/ 
String datasourcePassword = props.getProperty("datasource.password");

 // From now on, datasourcePassword equals "reports_passwd"... 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-10-22T06:53:34.820

穷人妥协的解决方案是使用简单的多签名方法。

例如，DBA 将应用程序数据库密码设置为 50 个字符的随机字符串。 **TAKqWskc4ncvKaJTyDcgAHq82X7tX6GfK2fc386bmNw3muknjU**

他或她将密码的一半提供给应用程序开发人员，然后他们将其硬编码到 java 二进制文件中。

**私人字符串 pass1 = "TAKqWskc4ncvKaJTyDcgAHq82"**

密码的另一半作为命令行参数传递。DBA 将 pass2 提供给系统支持人员或管理员，他们要么输入应用程序启动时间，要么将其放入自动应用程序启动脚本中。

java -jar /myapplication.jar -pass2 X7tX6GfK2fc386bmNw3muknjU

当应用程序启动时，它使用 pass1 + pass2 并连接到数据库。

该解决方案具有许多优点，没有提到的缺点。

您可以安全地将一半密码放在命令行参数中，因为除非您是拥有另一半密码的开发人员，否则阅读它不会对您有太大帮助。

DBA 仍然可以更改密码的后半部分，开发人员无需重新部署应用程序。

源代码也可以是半公开的，因为阅读它并且密码不会让您访问应用程序。

您可以通过对数据库接受连接的 IP 地址范围添加限制来进一步改善这种情况。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-12-21T12:28:53.797

提供自定义 N 因子身份验证机制怎么样？

在组合可用方法之前，假设我们可以执行以下操作：

1) Java 程序内部的硬代码

2) 存储在 .properties 文件中

3）要求用户从命令行输入密码

4) 要求用户从表单中输入密码

5) 要求用户从命令行或表单加载密码文件

6) 通过网络提供密码

7）许多替代品（例如Draw A Secret、Fingerprint、IP-specific、bla bla bla）

**第一种选择：**我们可以通过使用混淆使攻击者的事情变得更复杂，但这不是一个好的对策。如果他/她可以访问文件，一个好的编码人员可以很容易地理解它是如何工作的。我们甚至可以导出每个用户的二进制文件（或者只是混淆部分或密钥部分），因此攻击者必须有权访问这个用户特定的文件，而不是另一个发行版。同样，我们应该找到一种更改密码的方法，例如通过重新编译或使用反射来即时更改类行为。

**第二种选择：**我们可以将密码以加密格式存储在 .properties 文件中，因此攻击者无法直接看到它（就像[jasypt](http://www.jasypt.org/)一样）。如果我们需要一个密码管理器，我们也需要一个主密码，它应该被存储在某个地方——一个 .class 文件、密钥库、内核、另一个文件甚至内存中——它们各有利弊。
但是，现在用户只需编辑 .properties 文件即可更改密码。

**第三个选项：**从命令行运行时输入密码，例如`java -jar /myprogram.jar -p sdflhjkiweHIUHIU8976hyd`。

这不需要存储密码并将保留在内存中。但是，`history`命令和操作系统日志可能是您最大的敌人。要即时更改密码，您需要实现一些方法（例如监听控制台输入、RMI、套接字、REST bla bla bla），但密码将始终保留在内存中。

甚至可以仅在需要时对其进行临时解密->然后删除解密的内容，但始终将加密的密码保存在内存中。不幸的是，上述方法并没有增加针对未经授权的内存访问的安全性，因为实现这一点的人可能会访问算法、盐和任何其他正在使用的秘密。

**第四个选项：**从自定义表单而不是命令行提供密码。这将规避记录暴露的问题。

**第 5 个选项：**提供一个文件作为先前存储在另一个介质上的密码 -> 然后硬删除文件。这将再次规避记录暴露的问题，而且不需要打字，这可能会被偷走。当需要更改时，提供另一个文件，然后再次删除。

**第 6 种选择：**同样为了避免翻墙，可以实现 RMI 方法调用，以从另一设备（例如通过手机）提供密码（通过加密通道）。但是，您现在需要保护您的网络通道并访问其他设备。

我会选择上述方法的组合以实现最大的安全性，因此必须访问 .class 文件、属性文件、日志、网络通道、肩冲浪、中间人、其他文件 bla bla bla。这可以很容易地使用所有 sub_passwords 之间的 XOR 操作来生成实际密码来实现。

但是，我们无法保护我们免受未经授权的内存访问，这只能通过使用一些访问受限的硬件（例如智能卡、HSM、SGX）来实现，在这些硬件中，一切都被计算在内，没有任何人，甚至是合法的所有者能够访问解密密钥或算法。同样，人们也可以窃取此硬件，据报道，[侧信道攻击](https://www.theregister.co.uk/2017/03/07/eggheads_slip_a_note_under_intels_door_sgx_can_leak_crypto_keys/)可能有助于攻击者提取密钥，并且在某些情况下您需要信任另一方（例如，使用 SGX，您信任英特尔）。当然，当安全飞地克隆（拆卸）成为可能时，情况可能会恶化，但我想这需要几年时间才能实现。

此外，可以考虑一种密钥共享解决方案，其中完整密钥在不同服务器之间拆分。但是，在重建时，完整的密钥可能会被盗。缓解上述问题的唯一方法是通过[安全多方计算](https://crypto.stackexchange.com/questions/41470/how-to-securely-compute-aes-where-the-key-is-splitted-across-different-servers)。

我们应该始终牢记，无论使用哪种输入法，我们都需要确保我们不会受到网络嗅探（MITM 攻击）和/或键盘记录器的攻击。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-10T09:37:18.690

[实际上，这是配置文件中加密密码](https://stackoverflow.com/questions/1132567/encrypt-password-in-configuration-files)的副本？.

到目前为止我发现的最佳解决方案是在这个答案中：[https ://stackoverflow.com/a/1133815/1549977](https://stackoverflow.com/a/1133815/1549977)

优点：密码保存为 char 数组，而不是字符串。它仍然不好，但比其他任何东西都好。

# objective-c - 核心数据出现 sigabrt 错误

> ID：10306675
> 
> 赞同：0
> 
> 时间：2012-04-24T22:01:36.630
> 
> 标签：objective-c

我现在正在学习核心数据，我已经完成了第一部分，但是当我尝试将教授保存在下一个表格视图中时，我得到了一个 signbrt 错误。错误发生在第 8 行。

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
   return [(NSSet *)[department valueForKey:@"Professors"] count]; // uses the department's 
    // "Professors" relationship to get the number of professors in the department entity  
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"ProfessorCell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:CellIdentifier] autorelease];
    }

    NSManagedObject *professor = [[self sortProfessors] objectAtIndex:indexPath.row];
    cell.textLabel.text = [NSString stringWithFormat:@"%@ %@", 
                           [[professor valueForKey:@"FirstName"] description], 
                           [[professor valueForKey:@"LastName"] description]];
    cell.detailTextLabel.text = [[professor valueForKey:@"EMail"] description];
    return cell;
} 
```

这是我运行我的应用程序后打印的文字。

```
2012-04-24 17:43:08.808 BlahBlah[2905:b603] Department Saved in the persistent data store
2012-04-24 17:43:08.812 BlahBlah[2905:b603] -[NSManagedObject count]: unrecognized selector sent to instance 0x5a84a70
2012-04-24 17:43:08.815 BlahBlah[2905:b603] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[NSManagedObject count]: unrecognized selector sent to instance 0x5a84a70'
*** Call stack at first throw:
(
    0   CoreFoundation                      0x00fa35a9 __exceptionPreprocess + 185
    1   libobjc.A.dylib                     0x010f7313 objc_exception_throw + 44
    2   CoreFoundation                      0x00fa50bb -[NSObject(NSObject) doesNotRecognizeSelector:] + 187
    3   CoreFoundation                      0x00f14966 ___forwarding___ + 966
    4   CoreFoundation                      0x00f14522 _CF_forwarding_prep_0 + 50
    5   BlahBlah                            0x00005423 -[ProfessorListViewController tableView:numberOfRowsInSection:] + 115
    6   UIKit                               0x001db2b7 -[UISectionRowData refreshWithSection:tableView:tableViewRowData:] + 1834
    7   UIKit                               0x001d8d88 -[UITableViewRowData numberOfRows] + 108
    8   UIKit                               0x0008c677 -[UITableView noteNumberOfRowsChanged] + 132
    9   UIKit                               0x00099708 -[UITableView reloadData] + 773
    10  BlahBlah                            0x00005212 -[ProfessorListViewController viewWillAppear:] + 146
    11  UIKit                               0x000d8210 -[UINavigationController viewWillAppear:] + 334
    12  UIKit                               0x002ce8e4 -[UIWindowController transition:fromViewController:toViewController:target:didEndSelector:] + 6192
    13  UIKit                               0x000d3385 -[UIViewController _dismissModalViewControllerWithTransition:from:] + 2058
    14  UIKit                               0x000cfeb8 -[UIViewController dismissModalViewControllerWithTransition:] + 940
    15  BlahBlah                            0x000060d8 -[ProfessorDataEntryController save:] + 648
    16  UIKit                               0x0001e4fd -[UIApplication sendAction:to:from:forEvent:] + 119
    17  UIKit                               0x000ae799 -[UIControl sendAction:to:forEvent:] + 67
    18  UIKit                               0x000b0c2b -[UIControl(Internal) _sendActionsForEvents:withEvent:] + 527
    19  UIKit                               0x000af7d8 -[UIControl touchesEnded:withEvent:] + 458
    20  UIKit                               0x00042ded -[UIWindow _sendTouchesForEvent:] + 567
    21  UIKit                               0x00023c37 -[UIApplication sendEvent:] + 447
    22  UIKit                               0x00028f2e _UIApplicationHandleEvent + 7576
    23  GraphicsServices                    0x011dc992 PurpleEventCallback + 1550
    24  CoreFoundation                      0x00f84944 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 52
    25  CoreFoundation                      0x00ee4cf7 __CFRunLoopDoSource1 + 215
    26  CoreFoundation                      0x00ee1f83 __CFRunLoopRun + 979
    27  CoreFoundation                      0x00ee1840 CFRunLoopRunSpecific + 208
    28  CoreFoundation                      0x00ee1761 CFRunLoopRunInMode + 97
    29  GraphicsServices                    0x011db1c4 GSEventRunModal + 217
    30  GraphicsServices                    0x011db289 GSEventRun + 115
    31  UIKit                               0x0002cc93 UIApplicationMain + 1160
    32  BlahBlah                            0x00001ba9 main + 121
    33  BlahBlah                            0x00001b25 start + 53
)
terminate called throwing an exceptionsharedlibrary apply-load-rules all
Current language:  auto; currently objective-c
(gdb) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:19:22.190

查看您的模型，并确保“教授”被声明为 Department 的一对多关系。

# sap - 创建新模型或重新导入模型时出现空指针异常

> ID：10306678
> 
> 赞同：0
> 
> 时间：2012-04-24T22:01:44.730
> 
> 标签：sap, webdynpro

尝试创建或导入模型时，我发现此错误。我正在使用 SAP NetWeaver Developer Studio 7.0，显然某些 java 插件不兼容该平台在 win7 上运行。

一些帮助！？

![在此处输入图像描述](../Images/e2b54c39fbe38dc592360830972a9120.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T10:26:59.947

当某个变量没有任何初始值时，会抛出空指针异常。重新启动应用程序可能会强制程序正常工作。

请参考链接

[类似问题的解决方案](http://scn.sap.com/thread/786605)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T17:57:28.323

是的，Dhivya，昨天我找到了解决问题的链接。

[http://scn.sap.com/thread/786605](http://scn.sap.com/thread/786605)

通过使用不同于 Win XP 的操作系统，我们必须查看 NetWeaver Eclipse 文件夹，一个名为 vm.parameters 的文件。

C:\Program Files\SAP\IDE\IDE70\eclipse

并添加以下行。

-Dos.name='Windows XP'

并准备解决问题​​。

# ruby-on-rails - 如何删除重音等拉丁字符？

> ID：10306679
> 
> 赞同：2
> 
> 时间：2012-04-24T22:02:14.083
> 
> 标签：ruby-on-rails, ruby

我需要删除像重音符号或`"ñ"`Ruby 中的拉丁字符。我尝试使用`force_encoding('UTF-8')`但没有用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T22:16:53.907

我在其他关于 Ruby 编码的答案中使用的这段代码被证明在大多数情况下都是有效的。确保您的脚本本身使用 UTF8 编码保存：

```
t="doña"
p t.force_encoding(Encoding.locale_charmap).encode('UTF-8')
#=>"do\u251C\u2592a" 
```

如果它是你想要的替换而不是编码，那么有一些库可以解决这个问题，但你也可以使用一个简单的正则表达式

```
t="déjà"
puts t.gsub(/[éèàùµñçêï]/, '?') => d?j? 
```

编辑：我在评论中注意到你想用普通字符替换特殊版本的字符，你可以这样做如下

```
p string_with_special_chars.tr( 
"ÀÁÂÃÄÅàáâãäåĀāĂăĄąÇçĆćĈĉĊċČčÐðĎďĐđÈÉÊËèéêëĒēĔĕĖėĘęĚěĜĝĞğĠġĢģĤĥĦħÌÍÎÏìíîïĨĩĪīĬĭĮįİıĴĵĶķĸĹĺĻļĽľĿŀŁłÑñŃńŅņŇňŉŊŋÒÓÔÕÖØòóôõöøŌōŎŏŐőŔŕŖŗŘřŚśŜŝŞşŠšſŢţŤťŦŧÙÚÛÜùúûüŨũŪūŬŭŮůŰűŲųŴŵÝýÿŶŷŸŹźŻżŽž", 
"AAAAAAaaaaaaAaAaAaCcCcCcCcCcDdDdDdEEEEeeeeEeEeEeEeEeGgGgGgGgHhHhIIIIiiiiIiIiIiIiIiJjKkkLlLlLlLlLlNnNnNnNnnNnOOOOOOooooooOoOoOoRrRrRrSsSsSsSssTtTtTtUUUUuuuuUuUuUuUuUuUuWwYyyYyYZzZzZz") 
```

# c# - 避免在 WPF 的画布中添加相同的用户控件？

> ID：10306681
> 
> 赞同：1
> 
> 时间：2012-04-24T22:02:22.777
> 
> 标签：c#, wpf, canvas, user-controls, enumeration

我在 WPF 窗口中使用 Canvas 来显示 UserControl。我不想在 Canvas 中添加相同的 UserControl。

我怎样才能做到这一点？

目前我做过..

```
private void OpenChild(UserControl ctrl)
{            
    ctrl.Uid = ctrl.Name;
    if (JIMSCanvas.Children.Count == 0)
    {                
        JIMSCanvas.Children.Add(ctrl);
    }
    else
    {
        foreach (UIElement child in JIMSCanvas.Children)
        {
            if (child.Uid == ctrl.Uid)
            {
                MessageBox.Show("Already");
            }
            else
            {
                JIMSCanvas.Children.Add(ctrl);
            }
        }
    }
} 
```

并像这样添加一个 UserControl

```
OpenChild(new JIMS.View.Ledger()); 
```

它对我有用，但是当我添加其他控件时

```
OpenChild(new JIMS.View.Stock()); 
```

它抛出一个名为的异常

> 枚举数无效，因为集合已更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:12:59.417

该错误是由于您在循环遍历枚举的过程中（在**foreach**内部）修改了枚举。只需要使用一种不会改变枚举的方法：

```
bool alreadyExists = false;
UIElement existingElement = null;
foreach (UIElement child in JIMSCanvas.Children)
{
    if (child.Uid == ctrl.Uid)
    {
        alreadyExists = true;
        existingElement = child;
    }
}
if (alreadyExists)
{
    MessageBox.Show("Already");
    existingElement.Visibility = System.Windows.Visibility.Visible;
}
else
{
    JIMSCanvas.Children.Add(ctrl);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T10:25:41.023

或者更简单地说

```
if (JIMSCanvas.Children.Any(c => c.Uid == ctrl.Uid)
{
   MessageBox.Show("Already"); 
}
else
{
   JIMSCanvas.Children.Add(ctrl); 
} 
```

# jquery - IE中的jQuery验证日期不起作用

> ID：10306684
> 
> 赞同：2
> 
> 时间：2012-04-24T22:02:28.847
> 
> 标签：jquery, internet-explorer, date

jQuery 中的日期格式是 'dd/M/yyyy' (24/Apr/2012),

代码是：

```
jQuery('.dateofbirth').datepicker({ 
            dateFormat: 'dd/M/yy', 
            changeMonth: true, 
            changeYear: true,
            maxDate: new Date,
            yearRange: "-100:+0",
            minDate: '-100y'
        });

jQuery("#personDetailsForm").validate({
                rules: {
                        dateofdeath: {
                                required: true,
                                date: true
                        }
                }
        }); 
```

它适用于 Firefox 和 Chrome，但不适用于 IE。只是似乎无法让它工作。

如果我在日期控件（在 IE 中）中键入 24/04/2012，它验证正常，但 24/Apr/2012 只是不起作用。

有什么建议么？

# php - 返回数组范围

> ID：10306685
> 
> 赞同：0
> 
> 时间：2012-04-24T22:02:34.477
> 
> 标签：php

```
function GetImages($orderByDate, $start, $end)
{

$container = array();

if ($handle = opendir('uploads')) 
{
    while (false !== ($file = readdir($handle))) 
    {
        if ($file != "." && $file != "..") 
        {
            $filename = 'uploads/' . $file;
            $lastEdit = date("F d Y H:i:s.", filemtime($filename));

            $image = array(
                'fileName' => $file,
                'lastEdit' => $lastEdit
            );

            array_push($container, $image);
        }
    }

    closedir($handle);
} 

if($orderByDate)
{
    function date_compare($a, $b)
    {
        $t1 = strtotime($a['lastEdit']);
        $t2 = strtotime($b['lastEdit']);
        return $t1 - $t2;
    }    
    usort($container, 'date_compare');
}

if(isset($start) && isset($end))
{
    array_slice($container, $start, $end);
}

return $container;

}

echo '<pre>';
var_dump(GetImages(true, 0, 5));
echo '</pre>'; 
```

不`slice`就是去这里的路吗？即使我传递了一个开始值和一个结束值，我仍然从数组中获取所有记录。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:07:16.430

array_slice 返回一个数组，不修改传入的数组

```
$container = array_slice($container, $start, $end); 
```

应该解决你的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:13:41.070

而不是这个

```
 array_slice($container, $start, $end); 
```

你应该写

```
$container = array_slice($container, $start, $end); 
```

它应该工作得更好。

# java - 使用 += 从 null 开始构建字符串的紧凑方法

> ID：10306686
> 
> 赞同：3
> 
> 时间：2012-04-24T22:02:34.753
> 
> 标签：java

我想使用以下紧凑的方式来构建`String`：

```
String attributes = null;
for (Map.Entry<String, String> kvp : attrs.entrySet())
  attributes += (kvp.getKey() + "='" + kvp.getValue() +"' "); 
```

但结果是一个字符串，其内容为：`nullattr1='val1' attr2='val2' attr3='val3'`。我认为这是由于对当前值为空`+=`的 a 执行操作而发生的。`String`有没有紧凑的方法可以做到这一点而不必`attributes`每次通过循环检查是否为空？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T22:07:14.963

```
String attributes = ""; 
```

将允许这样做，并且适用于 5 或​​ 20 个值的小地图。对于较大的地图，StringBuilder 或 ~Buffer 是要走的路：

```
StringBuffer sb = new StringBuffer (estimatedSize);
for (X x: xx) 
     sb.append (foo).append (bar).append (baz);
String attributes = sb.toString (); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T22:03:51.673

`String`这样做是为了在代码的开头初始化：

```
String attributes = ""; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T22:04:45.760

**`null`不是空字符串**。

你应该从而`""`不是开始`null`：

```
String attributes = "";
... 
```

如果`'...'`没有必要，最紧凑的方法是

```
String attributes = "";
for (Map.Entry<String, String> kvp : attrs.entrySet())
  attributes += kvp + " "; 
```

如果您有很多值，也建议使用`StringBuilder`而不是 just `String`：

```
StringBuilder attributes = new StringBuilder();
for (Map.Entry<String, String> kvp : attrs.entrySet())
    attributes.append(kvp.getKey())
              .append("='")
              .append(kvp.getValue())
              .append("' "); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-24T22:03:59.347

```
 String attributes = "";
for (Map.Entry kvp : attrs.entrySet())
  attributes += (kvp.getKey() + "='" + kvp.getValue() +"' "); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T22:08:55.930

其他人都是对的，您可以在`String`开始时将您的字符串设置为空字符串，但如果您要从大量数据构建字符串，可能需要使用[`StringBuilder`](http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html)专为字符串构建而设计的对象。

```
public String getString(Map<String, String> attrs)  {
    StringBuilder bldr = new StringBuilder();
    for (Map.Entry<String, String> kvp : attrs.entrySet()) {
        bldr.append(String.format("'%s'='%s' ", kvp.getKey(), kvp.getValue()));
    }
    return bldr.toString();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-24T22:05:03.777

与其说，`String attributes = null;`不如说`String attributes = "";`

如果您要添加很多字符串，您可能需要查看 StringBuilder，因为这在内部避免了每次在末尾添加新内容时重新分配内存，而 += 就是这样做的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-24T22:04:21.483

初始化`attributes`为：

```
String attributes = ""; 
```

**已编辑**

# javascript - JavaScript 函数无法处理事件

> ID：10306689
> 
> 赞同：1
> 
> 时间：2012-04-24T22:02:53.560
> 
> 标签：javascript, function, event-handling, dom-events

这就是问题所在，我最近一直在处理两段代码，与事件处理有关的基本 Js 和 onClick 函数 - 一切正常，直到今天，单击链接到函数的按钮时没有任何反应。代码如下：

```
<html>
<title>Calculate Your Monthly Payments</title> 

        <script language="JavaScript"> 
            function Calc(){ 
            var a, res;             
            a = parseFloat(document.monthly.borrow.value); 
            res1 = a/300;
            res2 = a/500;
            res3 = a/900;

            if (document.monthly.borrow.value == ""){
                window.alert("Enter the amount that you will be borrowing.");
                return;
            }

            else if (document.monthly.payments.selectedIndex == 0){
                window.alert("Please select a mortgage type.");
                return;
            }

            else if(document.monthly.payments.value == "1" )
            {
                window.alert("Your short term monthly repayments have been estimaded to be £" + res1);
            }
            else if(document.monthly.payments.value == "2" )
            {
                window.alert("Your medium term monthly repayments have been estimaded to be £ " + res2);
            }
            else if(document.monthly.payments.value == "3" )
            {
                window.alert("Your long term monthly repayments have been estimaded to be £ " + res3);
            } 
        }
        </script> 

</head> 

<div id="container">

        <h2>Calculate Your Monthly Payments</h2> 
        <h4>Please fill in the form below</h4>
         <form id="monthly"> 
           How much are you borrowing? (£):<font color="#900">*</font> <br /><input name = "borrow" type = "text" size = "10" id="textarea" /> <br /><br />

                Mortgage Type: <br />
                <select name = "payments">
                  <option value="" selected="selected">Please Select </option>
                  <option value="1">CompleteQuaters Mortgage 2.19% fixed until 2015 </option>
                  <option value="2">CompleteQuaters Mortgage 3.17% fixed until 2017 </option>
                  <option value="3">CompleteQuaters Mortgage 3.18% fixed until 2024 </option>
                </select>
                <br /><br />                
           <input type = "button" value = "Calculate Payments! " onclick = "Calc();" /> 
           <br />
                <p><font color="#900">*Indicates Required Fields</font></p>

        </form>
</html> 
```

自然地，我通过 Chrome(20.0.1096.1) 运行了它，我确实得到了一个错误，准确地说是一个错误：

> 未捕获的类型错误：无法读取未定义的属性“借用”

我不知道从哪里开始，因为这个错误一定一直存在，但它仍然有效。

**问题仍在继续..**
我已经在所有主要浏览器（Firefox、Chrome、IE）和三台不同的计算机（Windows 7、Vista、XP）以及适用于 Android 和 Mobile Safari 的 Chrome Beta 上测试了此代码，但是，没有其中将响应 onClick 事件。

我还应该指出，在 onClick 窗口通常打开并显示：

> “您的 X 学期月供为 XXXXX 英镑”。
> 
> “X”是所选内容的可变结果。

我已经多次经历过这一切，但由于我在 Js 方面并不完全出色，我当然会很感激我能得到的任何帮助。

* * *

如果需要有关该问题的更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:10:39.873

你这样`document.monthly.borrow.value`用

```
<form id="monthly"> 
```

应该

```
<form name="monthly"> 
```

或者你可以同时使用如下

```
<form name="monthly" id="monthly"> 
```

如果要按 id 选择元素，则可以使用 document.getElementById('elementId')

[**演示**](http://jsfiddle.net/a3RLN/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:11:33.863

您有一些语法错误：

1.  `res1, res2, res3`没有定义。这很危险，因为它使用全局范围，而您可能不希望这样。

2.  你不能`return;`在这样的`if`声明中。这肯定会成为错误的来源。为此，我们使用`switch`语句和`break`.

3.  如果您将内容与数字或数字作为字符串进行比较，最好使用`===`而不是`==`避免类型强制。这也是问题的根源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:12:32.427

停止使用属性名称。请改用 ID。要获取元素，请使用 document.getElementById("id") Ex（根据您的 HTML，切换：

```
a = parseFloat(document.monthly.borrow.value); 
```

经过

```
a = parseFloat(document.getElementById("textarea").value); 
```

然后，您必须更改其余代码。

# regex - 什么是匹配没有子域的有效域名的正则表达式？

> ID：10306690
> 
> 赞同：146
> 
> 时间：2012-04-24T22:02:55.647
> 
> 标签：regex, validation, domain-name

我需要验证一个域名：

**google.com**

**stackoverflow.com**

因此，最原始形式的域 - 甚至不是像 www 这样的子域。

1.  字符只能是**az** | **亚利桑那州**| **0-9**和**句**点(.) 和**破折号**(-)
2.  域名部分不应以破折号 (-) 开头或结尾*（例如 -google-.com）*
3.  域名部分的长度应介于 1 到 63 个字符之间
4.  ~~扩展名 (TLD) 目前可以是 #1 规则下的任何内容，稍后我可能会根据列表验证它们，但它应该是 1 个或多个字符~~

~~编辑：TLD 显然是 2-6 个字符~~

**不。4 修订：** TLD 实际上应该被标记为“子域”，因为它应该包括 .co.uk 之类的东西——我想唯一可能的验证（除了对照列表检查）将是“在第一个点之后应该有一个或规则 #1 下的更多字符

非常感谢，相信我我确实试过了！

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2014-11-18T06:08:55.783

我知道这篇文章有点老了，但这里的所有正则表达式都缺少一个非常重要的组件：对 IDN 域名的支持。

[IDN 域名](http://en.wikipedia.org/wiki/Internationalized_domain_name)以 xn-- 开头。它们在域名中启用扩展的 UTF-8 字符。例如，您知道“♡.com”是一个有效的域名吗？是的，“爱心网”！要验证域名，需要让[http://xn--c6h.com/](http://xn--c6h.com/)通过验证。

请注意，要使用此正则表达式，您需要将域转换为小写，并使用 IDN 库来确保将域名编码为 ACE（也称为“ASCII 兼容编码”）。一个好的库是 GNU-Libidn。

idn(1) 是国际化域名库的命令行界面。以下示例将 UTF-8 中的主机名转换为 ACE 编码。生成的 URL [https://nic.xn--flw351e/](https://nic.xn--flw351e/)然后可以用作[https://nic.谷歌/](https://nic.xn--flw351e/)的 ACE 编码等效项。

```
 $ idn --quiet -a nic.谷歌
  nic.xn--flw351e 
```

这个神奇的正则表达式应该涵盖*大多数*领域（尽管我确信我错过了许多有效的边缘情况）：

```
^((?!-))(xn--)?[a-z0-9][a-z0-9-_]{0,61}[a-z0-9]{0,1}\.(xn--)?([a-z0-9\-]{1,61}|[a-z0-9-]{1,30}\.[a-z]{2,})$ 
```

选择域验证正则表达式时，您应该查看域是否与以下内容匹配：

1.  xn--stackoverflow.com
2.  stackoverflow.xn--com
3.  stackoverflow.co.uk

如果这三个域不通过，您的正则表达式可能不允许合法域！

查看[Oracle 国际语言环境指南中的国际化域名支持页面](https://docs.oracle.com/cd/E23824_01/html/E26033/glmkx.html)了解更多信息。

随意在这里试用正则表达式：[http ://www.regexr.com/3abjr](http://www.regexr.com/3abjr)

**ICANN**保留[一份已授权的 tld 列表，](http://newgtlds.icann.org/en/program-status/delegated-strings)可用于查看 IDN 域的一些示例。

* * *

编辑：

```
 ^(((?!\-))(xn\-\-)?[a-z0-9\-_]{0,61}[a-z0-9]{1,1}\.)*(xn\-\-)?([a-z0-9\-]{1,61}|[a-z0-9\-]{1,30})\.[a-z]{2,}$ 
```

此正则表达式将停止在主机名末尾带有“-”的域被标记为有效。此外，它允许无限的子域。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2012-04-24T22:07:55.363

好吧，鉴于您的特定要求，它比看起来更~~简单（请参阅评论）：~~

```
/^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\.[a-zA-Z]{2,}$/ 
```

但请注意，这将拒绝很多有效域。

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2013-11-18T11:45:24.707

我的正则表达式是下一个：

`^[a-zA-Z0-9][a-zA-Z0-9-_]{0,61}[a-zA-Z0-9]{0,1}\.([a-zA-Z]{1,6}|[a-zA-Z0-9-]{1,30}\.[a-zA-Z]{2,3})$`

i.oh1.me和**wow.british-library.uk****都可以**

**UPD**

这是更新的规则

```
^(([a-zA-Z]{1})|([a-zA-Z]{1}[a-zA-Z]{1})|([a-zA-Z]{1}[0-9]{1})|([0-9]{1}[a-zA-Z]{1})|([a-zA-Z0-9][a-zA-Z0-9-_]{1,61}[a-zA-Z0-9]))\.([a-zA-Z]{2,6}|[a-zA-Z0-9-]{2,30}\.[a-zA-Z]{2,3})$ 
```

![正则表达式可视化](../Images/f652e5a0dae443475b694d94ac9d311d.png)

[https://www.debuggex.com/r/y4Xe_hDVO11bv1DV](https://www.debuggex.com/r/y4Xe_hDVO11bv1DV)

现在它检查`-`或`_`在域标签的开头或结尾。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2015-05-02T21:50:53.983

**我的赌注：**

```
^(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]$ 
```

**解释：**

域名是根据段构建的。这是一段（决赛除外）：

```
[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])? 
```

它可以有 1-63 个字符，不以“-”开头或结尾。

现在追加“。” 并重复至少一次：

```
(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+ 
```

然后附加最后一段，长度为 2-63 个字符：

```
[a-z0-9][a-z0-9-]{0,61}[a-z0-9] 
```

**在这里测试它：** [http ://regexr.com/3au3g](http://regexr.com/3au3g)

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2016-12-16T23:16:07.927

### 此答案适用于域名（包括服务 RR），而不是主机名（如电子邮件主机名）。

```
^(?=.{1,253}\.?$)(?:(?!-|[^.]+_)[A-Za-z0-9-_]{1,63}(?<!-)(?:\.|$)){2,}$ 
```

这基本上是[mkyong 的回答](https://stackoverflow.com/a/25717506/436063)，此外：

*   最大长度为 255 个八位字节，包括长度前缀和空根。
*   允许尾随 '.' 用于显式 dns 根目录。
*   允许服务域 RR 使用前导 '_'，（错误：不强制 _ 标签最多使用 15 个字符，也不需要至少一个域高于服务 RR）
*   匹配所有可能的 TLD。
*   不捕获子域标签。

### 按零件

向前看，将最大长度限制在 ^$ 到 253 个字符之间，并带有可选的尾随文字“。”

```
(?=.{1,253}\.?$) 
```

向前看，下一个字符不是'-'，并且下一个'.'之前的任何字符都没有'_'。也就是说，强制标签的第一个字符不是'-'，只有第一个字符可以是'_'。

```
(?!-|[^.]+_) 
```

每个标签的允许字符数介于 1 到 63 个之间。

```
[A-Za-z0-9-_]{1,63} 
```

向后看，前一个字符不是'-'。也就是说，强制标签的最后一个字符不是'-'。

```
(?<!-) 
```

强制使用“。” 在每个标签的末尾，除了最后一个，它是可选的。

```
(?:\.|$) 
```

主要是从上面组合，这需要至少两个域级别，这不是很正确，但通常是一个合理的假设。如果您想允许 TLD 或不合格的相对子域通过（例如 localhost、myrouter 和 to），请从 {2,} 更改为 +。

```
(?:(?!-|[^.]+_)[A-Za-z0-9-_]{1,63}(?<!-)(?:\.|$)){2,} 
```

[此表达式的单元测试](https://regex101.com/r/d5Yd6j/1/tests)。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2014-09-08T04:33:57.013

接受的答案对我不起作用，试试这个：

> ^((?!-)[A-Za-z0-9-]{1,63}(?<!-)\.)+[A-Za-z]{2,6}$

访问此[单元测试用例](http://www.mkyong.com/regular-expressions/domain-name-regular-expression-example/)进行验证。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2013-06-04T15:45:05.707

只是一个小修正 - 最后一部分应该是 6\. 因此，

```
^[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}$ 
```

最长的 TLD 是`museum`（6 个字符） - [http://en.wikipedia.org/wiki/List_of_Internet_top-level_domains](http://en.wikipedia.org/wiki/List_of_Internet_top-level_domains)

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2013-05-23T13:27:49.660

```
^[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,7}$ 
```

[域 - 小写字母和仅 0-9] [可以有连字符] + [TLD - 小写字母，长度必须在 2 和 7 个字母之间]
[http://rubular.com/](http://rubular.com/)非常适合测试正则表达式！
编辑：正如 Dan Caddigan 所指出的，将“.rentals”的 TLD 最多更新为 7 个字符。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2016-07-20T09:46:09.793

感谢您在其他答案中指出域名验证解决方案的正确方向。可以通过多种方式验证域名。

如果您需要以**人类可读**的形式验证**IDN**域，正则表达式会有所帮助。这允许匹配任何语言的任何字符。**`\p{L}`**

 **请注意，**最后一部分也可能包含连字符**！由于 punycode 编码的中文名称可能在 tld 中有 unicode 字符。

我已经找到了匹配的解决方案，例如：

*   google.com
*   masełkowski.pl
*   maselkowski.pl
*   m.maselkowski.pl
*   www.masełkowski.pl.com
*   xn--masekowski-d0b.pl
*   中国互联网络信息中心.中国
*   xn--fiqa61au8b7zsevnm8ak20mc4a87e.xn--fiqs8s

正则表达式是：

```
^[0-9\p{L}][0-9\p{L}-\.]{1,61}[0-9\p{L}]\.[0-9\p{L}][\p{L}-]*[0-9\p{L}]+$ 
```

[在这里检查和调整](https://regex101.com/r/vX8vH8/26)

注意：此正则表达式非常宽松，当前域名允许的字符集也是如此。

**更新**：更加简化，`a-aA-Z\p{L}`就像刚才一样`\p{L}`

注意2：唯一的问题是它会匹配带有双点的域......，比如`masełk..owski.pl`. 如果有人知道如何解决这个问题，请改进。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-07-03T11:41:14.183

没有足够的代表发表评论。针对paka的解决方案，我发现我需要调整三个项目：

*   破折号和下划线被移动，因为破折号被解释为一个范围（如“0-9”）
*   为具有许多子域的域名添加了句号
*   将 TLD 的潜在长度扩展至 13

前：

```
^(([a-zA-Z]{1})|([a-zA-Z]{1}[a-zA-Z]{1})|([a-zA-Z]{1}[0-9]{1})|([0-9]{1}[a-zA-Z]{1})|([a-zA-Z0-9][a-zA-Z0-9-_]{1,61}[a-zA-Z0-9]))\.([a-zA-Z]{2,6}|[a-zA-Z0-9-]{2,30}\.[a-zA-Z]{2,3})$ 
```

后：

```
^(([a-zA-Z]{1})|([a-zA-Z]{1}[a-zA-Z]{1})|([a-zA-Z]{1}[0-9]{1})|([0-9]{1}[a-zA-Z]{1})|([a-zA-Z0-9][-_\.a-zA-Z0-9]{1,61}[a-zA-Z0-9]))\.([a-zA-Z]{2,13}|[a-zA-Z0-9-]{2,30}\.[a-zA-Z]{2,3})$ 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2019-07-21T00:06:41.363

正如已经指出的那样，在实际意义上告诉子域（例如`.co.uk`域）并不明显。[我们使用](https://github.com/c-hive/guides/blob/57cbbf72f1152214a160f9be8a57e2c4dc868cfd/etc/regex.md)这个正则表达式来验证在野外出现的域。它涵盖了我所知道的所有实际用例。欢迎新的。根据[我们的指南](https://github.com/c-hive/guides/blob/a173a9a5524cbcec480d021e053475b20e3169fc/etc/regex.md)，它避免了非捕获组和贪婪匹配。

`^(?!.*?_.*?)(?!(?:[\d\w]+?\.)?\-[\w\d\.\-]*?)(?![\w\d]+?\-\.(?:[\d\w\.\-]+?))(?=[\w\d])(?=[\w\d\.\-]*?\.+[\w\d\.\-]*?)(?![\w\d\.\-]{254})(?!(?:\.?[\w\d\-\.]*?[\w\d\-]{64,}\.)+?)[\w\d\.\-]+?(?<![\w\d\-\.]*?\.[\d]+?)(?<=[\w\d\-]{2,})(?<![\w\d\-]{25})$`

证明、解释和示例：[https](https://regex101.com/r/FLA9Bv/9) ://regex101.com/r/FLA9Bv/9 （*注意：目前仅适用于 Chrome，因为正则表达式使用仅在 ECMA2018 中受支持的lookbehinds*）

验证域时有两种方法可供选择。

书本上的 FQDN 匹配（理论定义，实践中很少遇到）：

*   最长 253 个字符（根据[RFC-1035/3.1](https://www.rfc-editor.org/rfc/rfc1035)，[RFC-2181/11](https://www.rfc-editor.org/rfc/rfc2181#section-11)）
*   每个标签最多 63 个字符（根据[RFC-1035/3.1](https://www.rfc-editor.org/rfc/rfc1035)，[RFC-2181/11](https://www.rfc-editor.org/rfc/rfc2181#section-11)）
*   允许任何字符（根据[RFC-2181/11](https://www.rfc-editor.org/rfc/rfc2181#section-11)）
*   TLD 不能是全数字的（根据[RFC-3696/2](https://www.rfc-editor.org/rfc/rfc3696#section-2)）
*   FQDN 可以写成完整的形式，其中包括根区域（尾随点）

实用/保守的 FQDN 匹配（实用定义，在实践中预期和支持）：

*   与以下例外/补充相匹配的书籍
*   有效字符：`[a-zA-Z0-9.-]`
*   标签不能以连字符开头或结尾（根据[RFC-952](https://www.rfc-editor.org/rfc/rfc952)和[RFC-1123/2.1](https://www.rfc-editor.org/rfc/rfc1123#section-2.1)）
*   TLD 最小长度为 2 个字符，最大长度为 24 个字符，根据当前现有记录
*   不匹配尾随点

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-03-11T09:14:17.030

对于新 gTLD

```
/^((?!-)[\p{L}\p{N}-]+(?<!-)\.)+[\p{L}\p{N}]{2,}$/iu 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-04-24T22:10:36.490

```
^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\.[a-zA-Z]+(\.[a-zA-Z]+)$ 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-08-05T02:54:33.837

```
^((localhost)|((?!-)[A-Za-z0-9-]{1,63}(?<!-)\.)+[A-Za-z]{2,253})$ 
```

谢谢@mkyong 为我的回答奠定了基础。我已经对其进行了修改以支持更长的可接受标签。

此外，“localhost”在技术上是一个有效的域名。我将修改此答案以适应国际化域名。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2017-06-27T12:05:33.497

这是带有示例的完整代码：

```
<?php
function is_domain($url)
{
    $parse = parse_url($url);
    if (isset($parse['host'])) {
        $domain = $parse['host'];
    } else {
        $domain = $url;
    }

    return preg_match('/^(?!\-)(?:[a-zA-Z\d\-]{0,62}[a-zA-Z\d]\.){1,126}(?!\d+)[a-zA-Z\d]{1,63}$/', $domain);
}

echo is_domain('example.com'); //true
echo is_domain('https://example.com'); //true
echo is_domain('https://.example.com'); //false
echo is_domain('https://localhost'); //false 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-06-12T13:43:13.243

> ^[a-zA-Z0-9][-a-zA-Z0-9]+[a-zA-Z0-9].[az]{2,3}(.[az]{2,3}) ?(.[az]{2,3})?$

有效的例子：

```
stack.com
sta-ck.com
sta---ck.com
9sta--ck.com
sta--ck9.com
stack99.com
99stack.com
sta99ck.com 
```

它也适用于扩展

```
.com.uk
.co.in
.uk.edu.in 
```

不起作用的例子：

```
-stack.com 
```

它甚至可以使用最长的域扩展`".versicherung"`

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-04-02T10:34:33.380

```
/^((([a-zA-Z]{1,2})|([0-9]{1,2})|([a-zA-Z0-9]{1,2})|([a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]))\.)+[a-zA-Z]{2,6}$/ 
```

*   `([a-zA-Z]{1,2})`-> 只接受两个字符。

*   `([0-9]{1,2})`-> 只接受两个数字

如果任何东西超过两个`([a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9])`，这个正则表达式会处理这个问题。

如果我们想进行至少一次匹配，`+`就会用到。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-11-03T02:27:48.427

很简单，很随意。它会有像*-notvalid.at-all*这样的误报，但不会有误报。

```
/^([0-9a-z-]+\.?)+$/i 
```

它确保它有一系列可以以点结尾的字母数字和破折号，然后是任意数量的此类序列。

我喜欢这个正则表达式的地方：它很短（可能是这里最短的），易于理解，并且足以在客户端验证用户输入错误。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-12-10T13:06:23.940

*   `^((?!-))(xn--)?[a-z0-9][a-z0-9-_]{0,61}[a-z0-9]{0,}\.?((xn--)?([a-z0-9\-.]{1,61}|[a-z0-9-]{0,30})\.[a-z-1-9]{2,})$`

将`яндекс.рф`在编码后验证此类域。

[https://regex101.com/r/Hf8wFM/1](https://regex101.com/r/Hf8wFM/1) - 沙盒

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-07-25T07:56:34.210

我做了以下操作来简单地获取域以及协议。示例： [https ://www.facebook.com/profile/user/ftp:](https://www.facebook.com/profile/user/) [//182.282.34.337/movies/M](ftp://182.282.34.337/movies/M)

使用下面的正则表达式模式：[a-zA-Z0-9]+://.*?/

将为您提供输出： [https ://www.facebook.com/ftp:](https://www.facebook.com/) [//192.282.34.337/](ftp://192.282.34.337/)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-12-30T20:14:12.723

以下正则表达式提取给定域的 sub、root 和 tld：

```
^(?<domain>(?<domain_sub>(?:[^\/\"\]:\.\s\|\-][^\/\"\]:\.\s\|]*?\.)*?)(?<domain_root>[^\/\"\]:\s\.\|\n]+\.(?<domain_tld>(?:xn--)?[\w-]{2,7}(?:\.[a-zA-Z-]{2,3})*)))$ 
```

针对以下域进行了测试：

```
* stack.com
* sta-ck.com
* sta---ck.com
* 9sta--ck.com
* sta--ck9.com
* stack99.com
* 99stack.com
* sta99ck.com
* google.com.uk
* google.co.in

* google.com
* masełkowski.pl
* maselkowski.pl
* m.maselkowski.pl
* www.masełkowski.pl.com
* xn--masekowski-d0b.pl
* xn--fiqa61au8b7zsevnm8ak20mc4a87e.xn--fiqs8s

* xn--stackoverflow.com
* stackoverflow.xn--com
* stackoverflow.co.uk 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-03-03T11:49:48.830

对于 Javascript，您可以查看验证器库： [https ://www.npmjs.com/package/validator](https://www.npmjs.com/package/validator)

方法：`isFQDN(str [, options])`

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2022-01-08T07:31:41.107

检查域的每个部分是否不超过 63 个字符，并允许使用 punycode 表示法的国际化域名：

```
\b((?=[a-z0-9-]{1,63}\.)(xn--)?[a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,63}\b 
```**

# spring - Spring：当对象同时注入基类和子类 bean 时，值为 null

> ID：10306695
> 
> 赞同：1
> 
> 时间：2012-04-24T22:03:30.737
> 
> 标签：spring, dependency-injection

我有一个父抽象类和一个具体的子类。抽象的有一个具体方法和另一个抽象方法，子类实现。这两个类都配置为 Spring bean。代码片段类似于以下内容：

弹簧配置：

```
<bean id="parent" class="Parent" abstract="true">
  <property name="propA" ref="propA"/>
  <property name="cacheMan" ref="cacheMan"/>
</bean>

<bean id="child" class="Child" parent="parent">
  <property name="propB" ref="propB"/>
  <property name="cacheMan" ref="cacheMan"/>
</bean>

<!-- Of course, cacheMan is defined elsewhere and not relevant here.--> 
```

类定义：

```
 public abstract class Parent {
      private A propA; // A is irrelevant.
      private CacheManager cacheMan; // This is the object in question.
      public void doProcess1() {
         //code logic
         if (cacheMan == null) {
            // Error!
         }
      }
      public void doProcess2();
    }

    public class Child extend Parent {
      private B propB; // Again, B is irrelevant.
      private CacheManager cacheMan; // This is the object in question.
      public void doProcess2() {
         //code logic
      }
    }

public class Test {
        private Parent parent; //Assume this is Spring injected and it's of type Child.
        public void doTest() {
          parent.doProcess1(); // Error thrown since cacheMan is null.
        }
} 
```

这两个类都有适当的 getter/setter 方法`cacheMan`。我不明白`cacheMan`该方法中的空值如何`doProcess1()`。但是，如果我从

`cacheMan == null`to `getCacheMan() == null`，不抛出错误。

我认为`getCacheMan()`正在检索注入到子类的对象，因为`parent`它是实例`Child`，这就是它不为空的原因。

请对此有所了解，如果不清楚，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:11:40.913

这个问题与 Spring 无关，而是与 Java 语言有关——具体的方法覆盖。

您`setCacheMan()`在抽象父类和子类中都定义了（这就是我的假设）方法。当 Spring 调用该方法时，它总是在 child 中调用覆盖的版本——并且该版本也会修改`cacheMan`child 中的引用。`cacheMan`父级中的引用从未真正被触及，因为访问它的唯一方法在子级中被覆盖。

> 如果我将该行从 更改`cacheMan == null`为`getCacheMan() == null`，则不会引发错误。

从已经说过的内容来看，这很明显 -`getCacheMan()`也被覆盖了！`cacheMan`父项中的引用是`null`（见上文），但由于`getCacheMan()`被覆盖，它`cacheMan`在子项中访问，而不是在父项中。实际上，您有两个变量，但 child 中的那个不能更新。

解决方案：父 bean 的想法是在一个地方有共同的依赖，并避免在每个孩子中重复它们：

```
<bean id="parent" class="Parent" abstract="true">
  <property name="propA" ref="propA"/>
  <property name="cacheMan" ref="cacheMan"/>
</bean>

<bean id="child" class="Child" parent="parent">
  <property name="propB" ref="propB"/>
</bean> 
```

并且要么声明`cacheMan`受保护，要么至少具有受保护的吸气剂，以便子类可以访问它。不要`cacheMan`在子类中创建字段。

# objective-c - 在 ios 中获取实时时钟

> ID：10306698
> 
> 赞同：0
> 
> 时间：2012-04-24T22:03:43.997
> 
> 标签：objective-c, ios, datetime

我正在尝试找到一个关于在 ios 中测量时间的可靠解决方案。我想以 1 秒的精度显示时间的流逝。完全像 ios 内置的秒表，但只有几秒钟。到目前为止，我发现的每个解决方案似乎都很笨拙，因为它要么在 NStimer 的帮助下使用轮询，要么使用一些爱级别 C 的东西。我的问题是，“我”每次都需要问系统，几点了。但是如果我应该依赖不确定的 NStimer，那么我的测量是非常不可靠的。没有从系统调用的委托方法可以更新我的时间吗？我想如果我将轮询的分辨率提高到 1 ns，那就没问题了。但是我应该如何使用低级 C 来实现它呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:04:33.980

iOS 设备每秒仅重绘显示 60 次（最大值），因此任何超出此范围的时间精度对用户都是不可见的。您可以使用 CADisplayLink 每帧时间呼叫您，每秒 60 次并忽略（返回）59 个呼叫。但是您仍然需要轮询其中一个时钟（不止一个）来检查显示速率和时钟之间的漂移。而且，如果您的代码在 UI 运行循环中执行的操作过于冗长，您可能会错过一帧，因此您也必须检查这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:48:52.850

我不确定你的目标是什么。我不知道您是否想要一种查询高分辨率时间的好方法，或者您是否希望系统给您回电。

如果是前者，这就是我用于高分辨率计时器的。

```
#import "mach/mach_time.h"

#define TICKS_TO_NANOS(_ticks_, _timebase_) (((_ticks_) * ((_timebase_).numer)) / ((_timebase_).denom))
#define NOW_IN_TICKS() (mach_absolute_time())
#define NOW_IN_NANOS(_timebase_) TICKS_TO_NANOS(NOW_IN_TICKS(), _timebase_) 
```

如果是后者，那么您**永远无法**获得有保证的回调计时器。可能最一致的计时器回调将挂钩到 CADisplayLink，但如果您的图形方法花费太长时间，您可能无法获得一致的结果。

您可以尝试系统计时器，但也无法保证。

# javascript - 使用编码 64 图像构建谷歌地图标记

> ID：10306705
> 
> 赞同：0
> 
> 时间：2012-04-24T22:04:51.697
> 
> 标签：javascript, google-maps

我有以下功能，它获取图像作为参数：

```
function getIcon(img){
  var canvas = document.createElement("canvas");
  canvas.width = img.width;
  canvas.height = img.height;
  var ctx = canvas.getContext("2d");
  ctx.drawImage(img, 0, 0);
  var dataURL = canvas.toDataURL("image/png");
  return dataURL;
} 
```

例如：

```
icon = getIcon(document.getElementById("car_marker")); 
```

和：

```
<img id="car_marker" src="img/car.png"/> 
```

然后创建的图标用作谷歌地图中的标记：

```
var marker = new google.maps.Marker({ position: latLng,
                                          map: map,
                                          title: description,
                                          id: id,
                                          icon: icon
                                       }); 
```

这部分工作正常，但我现在需要修改 getIcon 方法，以便将另一个图像作为参数并合并两个图像。由于我需要添加的新图像采用 base 64 编码，因此以下内容无法按预期工作：

```
function getIcon(img1, img2){
  var canvas = document.createElement("canvas");
  canvas.width = img1.width;
  canvas.height = img1.height;
  var ctx = canvas.getContext("2d");
  ctx.drawImage(img1, 0, 0);
  ctx.drawImage(img2, 0, 0); // add the base 64 encoded image here... does not work
  var dataURL = canvas.toDataURL("image/png");
  return dataURL;
} 
```

我最终得到：

```
Could not convert JavaScript argument arg 0 [nsIDOMCanvasRenderingContext2D.drawImage] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T06:16:28.367

我终于想通了：

```
// Get the image that will be used as the background image
image1 = document.getElementById("blank_marker");

// Build image from base64 encoding (image that will be put on the previous one)
image2 = new Image();
image2.src = "data:image/jpeg;base64," + base64enc;
image2.height = 20;
image2.width = 20; 
```

然后，获取这两张图片的函数：

```
function getIcon(image1, image2){
  var canvas = document.createElement("canvas");
  canvas.width = image1.width;
  canvas.height = image1.height;
  var ctx = canvas.getContext("2d");
  ctx.drawImage(image1, 0, 0);
  ctx.drawImage(image2, 1, 1, 28, 28);
  var dataURL = canvas.toDataURL("image/png");
  return dataURL;
} 
```

这工作正常（除了一个奇怪的刷新问题：加载页面时 image2 没有出现在 image1 上，但重新加载后就可以了）。

# android - 无法反编译的apk文件

> ID：10306711
> 
> 赞同：0
> 
> 时间：2012-04-24T22:05:36.533
> 
> 标签：android, decompiling, cracking

我一直在互联网和stackoverflow中搜索，发现可以使用dex2jar对apk文件进行反编译，然后有许多jar文件的反编译器。有人告诉我，ProGaurd 可以混淆代码，并且很难反编译它，但并非不可能。

我的目标是在设备上运行对任何用户来说都“无法复制”的音频文件。即使我将它保存在设备上的 sqlcipher 数据库中，也必须对其进行解密才能在音频播放器上运行它。

请建议我一种方法来保护我的音频文件不被复制。

在 c++ 代码上运行它并使用 JNI 连接该代码怎么样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:12:27.523

这个要求是不可能实现的。如果它应该为用户播放，用户可以复制它。即使您可以对所有数字组件进行加密，他也可以从耳机插孔录制音频文件。请注意，我不知道 Android 在多大程度上（如果有的话）支持有效防止数字复制所需的基于硬件的 DRM。

编辑：一种更有成效的方法可能是给音频加水印，这样您就可以识别出事后复制音频的用户。安全地执行此操作将需要在下载之前个性化文件，或者再次，我怀疑是否存在硬件支持。

# actionscript-3 - 对匿名对象执行命中测试

> ID：10306713
> 
> 赞同：0
> 
> 时间：2012-04-24T22:05:39.967
> 
> 标签：actionscript-3, hittest

我有一个用 AS3 制作的基本太空射击游戏。

游戏目前由一个敌人和玩家组成 - 一个可移动的炮塔。

游戏的前提是，当敌人被击中时，它会重生，玩家得分上升一分。

现在我想通过在比赛场地上拥有多个敌人来扩展游戏。每一波敌人的数量可能不同，所以我真的不想单独跟踪它们。

当我想创建一个敌人时，我会调用（在我的主类中）

```
this.addChild(createNewEnemy()); 
```

使用 createNewEnemy() 函数创建并返回一个匿名 Enemy 对象。

我的问题是，如何在玩家发射子弹的情况下对这些匿名敌人进行命中测试？当敌人与子弹相撞时，应将其移除并增加分数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:14:38.247

我不太清楚你所说的“匿名对象”是什么意思。您真的应该以可以跟踪它们的方式创建这些东西。一种方法可能是覆盖容器精灵的 addChild 方法并将新敌人推送到向量。例子：

```
var enemies:Vector.<Enemy> = new Vector.<Enemy>();

override public function addChild(child:DisplayObject):DisplayObject
{
    if(child is Enemy) {
       enemies.push(child);
    }
    super.addChild(child);
} 
```

现在您可以简单地针对敌人向量进行测试，或者`is`在您的子弹碰撞中使用相同的“”关键字来检查碰撞显示对象是否为基础类型`Enemy`。

至于进行碰撞检测的实际代码，请参见以下答案：[https ://stackoverflow.com/a/7083965/562566](https://stackoverflow.com/a/7083965/562566)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T00:09:56.083

**你好！**

我真的不明白您所说的“**匿名**”是什么意思，但解决方案之一是创建所谓的**hitboxes**。

让我们假设你有一个 Enemy 类：

```
public class Enemy {
    public var hitBox:Sprite = new Sprite() ;

    public function Enemy() {
        hitBox.graphics.clear() ; /* Not filled by a color, as needs to be invisible */
        hitBox.graphics.drawRect(x,y,width,height) ; /* Adjust the parameters manually */
        this.addChild(hitBox) ;
    }
} 
```

有很多敌人，所以只需创建enemyArray 并将敌人推入其中。这是玩家的子弹：

```
public class PlayerBullet extends Sprite {
    private var stageReference:Stage ;
    public function PlayerBullet(coord:Point, stageReference:Stage){
        this.x = coord.x ;
        this.y = coord.y ;
        this.stageReference = stageReference ;
        this.stageReference.addChild(this) ;
        this.addEventListener(Event.ENTER_FRAME, loop) ;
    }

    private function loop(e:Event){

        /*Provide some movement for bullet by changing or incrementing
          this.x and this.y as you wish */

        for (var i:Number = 0 ; i < enemyArray.length ; i++){
          if (this.hitTestObject(enemyArray[i].hitBox)) {
              enemyArray.splice(i,1) ; /* Remove the enemy from enemy array on collision */
              this.stageReference.removeChild(this) ; /* Do not display bullet anymore on collision with enemy */
          }
       }
    }
} 
```

注意：hitboxes 确实只提供了一些正方形区域。如果您需要一些确切的碰撞细节，请创建几个碰撞箱。

我希望这个能帮上忙 ！:)

# java - Struts2 会话并发问题

> ID：10306717
> 
> 赞同：1
> 
> 时间：2012-04-24T22:06:26.227
> 
> 标签：java, concurrency, struts2

我有一些麻烦。

例如，我有两个动作：First 和 Second。

我编写了简单的实用程序，它使用执行器服务将 100000 个异步请求发送到第一操作和第二操作。

在第一个动作中，我做：

```
HitCounter.increment();
ActionContext.getContext().getSession().put("counter", HitCounter.getAtomicCounter());
return Action.SUCCESS; 
```

在第二个动作中，我做：

```
System.out.println("From session: "+ActionContext.getContext().getSession().get("counter"));
System.out.println("Actual:"+ HitCounter.getAtomicCounter());
return Action.SUCCESS; 
```

我看到的输出（这真的让我很生气）：

```
From session: 2 
Actual: 69352 
```

一段时间后，当我仅从我的浏览器使用此 Fitst 动作/第二个动作并且没有并发请求（由我的加载实用程序生成）时，结果“稳定”为实际值。因此，我有并发问题。

我应该使用一种标准方法来避免 Struts2 中的并发问题吗？

PS HitCounter 是线程安全的，因为它只包含一个字段并且是 AtomicInteger。

PPS HitCounter 实现：

```
public class HitCounter {
    private static AtomicInteger counter = new AtomicInteger(0);

    public static void increment() {
        counter.incrementAndGet();
    }
    public static int getAtomicCounter() {
        return counter.get();
    }
} 
```

PPPS 我删除了 Thread.yield(); 但这没有帮助。:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T09:41:48.180

Struts2 动作是线程安全的，因为它们使用线程本地存储……也就是说，每个线程都有一个从变量到值的映射。因此没有共享的可变状态，也不需要同步。

但是，不能以这种方式处理诸如 Session 之类的资源，因此必须注意并发访问。这个问题讨论了这些问题：[Using request.getSession() as a locking object？](https://stackoverflow.com/questions/1820629/using-request-getsession-as-a-locking-object)

根据这个问题： [Is HttpSession thread safe, are set/get Attribute thread safe operations？](https://stackoverflow.com/questions/616601/is-httpsession-thread-safe-are-set-get-attribute-thread-safe-operations)servlet 规范声明以下是线程安全的：`request.getSession().setAttribute("foo", 1);`

但是请注意，上面的请求是一个 HttpServletRequest ，它反过来派生一个 HttpSession 对象，这个对象不仅仅是一个由 Struts2 返回的映射......这意味着 struts2 版本必须被包装，因此可能不符合规范。因此，我们可以实现 ServletRequestAware，它为我们提供了一个 HttpServletRequest 对象，我们可以从中派生一个 HttpSession。但是正如前面的问题所指出的那样，这一行对我们的帮助不大，所以实现 HttpServletRequest 将是浪费时间。所做的一切让我想知道 Struts2 如何将它为 Session 返回的 Map 与没有实现 Map 的 HttpSession 协调起来，它甚至没有返回地图的方法......

所以让我们考虑一下目前可能发生的事情......

```
line1: hitCounter.increment();
line2: ActionContext.getContext().getSession().put("counter", hitCounter.getAtomicCounter()); 
```

第 1 行：我们增加了一些全局的 hitCounter 对象。

第 2a 行：我们获得了hitCounter 对象的**副本（返回类型为 int）。**

第 2b 行：我们在 Session 中设置 hitCounter 值。

由于 HitCounter 的线程安全特性，我们知道第 1 行总是好的……但是第 2 行呢？我们可以看到有两个部分，如果一个线程在获取 hitCournter 副本和设置 hitCounter 之间被挂起，将会出现竞争条件......从这一点开始执行的最后一个线程将获胜。

一种方法是将 AtomicInteger 放入它自己的会话中，这样可以避免副本滑入的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T06:45:18.157

您没有在第二个操作中检索 HitCounter。

`System.out.println("From session: "+ActionContext.getContext().getSession().get("counter"));`

上面的行只是打印对象。代码中是否缺少某些内容？

# jsp - 从 JSF EL 访问 JSP 变量

> ID：10306724
> 
> 赞同：1
> 
> 时间：2012-04-24T22:07:20.060
> 
> 标签：jsp, jsf, el

我正在尝试做类似的事情（在 JSP 页面中，使用 JavaServer Faces 运行）：

```
<%
String myTitle = "Cool Action!";
String myAction = "coolAction";
%>

<h:commandLink value="#{myTitle}" action="#{myAction}" /> 
```

这不起作用，因为 JSF 看不到 JSP 变量（至少使用这种表示法？）。

有没有办法从 JSF 标记访问 JSP 变量（不使用会话/页面范围的 bean），或者有没有办法从 <% %> JSP 块内定义 JSF 标记，如 commandLink？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:13:39.287

您至少需要将它们放在请求范围内。EL 解析 和 的属性`HttpServletRequest`等。`HttpSession``ServletContext`

```
<%
request.setAttribute("myTitle", "Cool Action!");
request.setAttribute("myAction", "coolAction");
%> 
```

但这完全是错误的使用 JSF 的方式。要遵循正确的 MVC 设计思想，您不应该**以**任何方式使用老式的 JSP*脚本*。更重要的是，JSP 的后继 Facelets 不支持任何形式的*scriptlet*。

根据具体的功能要求，您可以创建一个支持 bean 类，在其中将它们指定为 bean 属性，

```
<h:commandLink value="#{bean.myTitle}" action="#{bean.myAction}" /> 
```

或者直接在`<h:commandLink>`.

```
<h:commandLink value="Cool Action!" action="coolAction" /> 
```

或至少将值放入您加载`<f:loadBundle>`或注册的 i18n 资源包`<resource-bundle>`中`faces-config.xml`：

```
<h:commandLink value="#{text['myTitle']}" action="coolAction" /> 
```

# php - WordPress 主题中带有徽标的 If Else 语句

> ID：10306727
> 
> 赞同：-3
> 
> 时间：2012-04-24T22:07:32.477
> 
> 标签：php, wordpress, themes, wordpress-theming

这个 If Else 语句有问题。我可以在没有语句的情况下显示徽标，因此所有内容都正确路径，但是当我放入 If Else 语句时，它既不显示徽标也不显示 H1 标题。

提前感谢您的帮助。

```
<?php if ( $options['flaunt_one_logo'] != '' ) : ?>
        echo <a href="<?php bloginfo('url')?>/" class="<?php logo_container_class(); ?>"><img src="<?php echo get_option('flaunt_one_logo'); ?>" alt="<?php bloginfo('name')?>" />
    else
        echo <h1 id="site-title"><span><a href="<?php echo esc_url( home_url( '/' ) ); ?>" title="<?php echo esc_attr( get_bloginfo( 'name', 'display' ) ); ?>" rel="home"> <?php bloginfo( 'name' ); ?></a></span></h1>;

    <?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:17:51.147

您的回声在 php 代码之外。

还阅读 IF 语句： http: [//php.net/manual/en/control-structures.if.php](http://php.net/manual/en/control-structures.if.php)

```
<?php if ( $options['flaunt_one_logo'] != '' ) { 
        echo "<a href=\"".bloginfo('url')."\" class=\"".logo_container_class()."\"><img src=\"".get_option('flaunt_one_logo')."\" alt=\"".bloginfo('name').">";
} else {
        echo "<h1 id=\"site-title\"><span><a href=\"".esc_url( home_url( '/' ) )."\" title=\"".esc_attr( get_bloginfo( 'name', 'display' ) )."\" rel=\"home\">".bloginfo( 'name' )."</a></span></h1>";
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T08:03:44.430

试试这个：
你也忘了`<a>`用 a 关闭你的第一个`</a>`

```
<?php if ( get_option('flaunt_one_logo', false) !== false ) : ?>
    <a href="<?php bloginfo('url')?>/" class="<?php logo_container_class(); ?>">
        <img src="<?php echo get_option('flaunt_one_logo'); ?>" alt="<?php bloginfo('name')?>" />
    </a>
<?php else ?>
    <h1 id="site-title">
        <span>
            <a href="<?php echo esc_url( home_url( '/' ) ); ?>" title="<?php echo esc_attr( get_bloginfo( 'name', 'display' ) ); ?>" rel="home">
            <?php bloginfo( 'name' ); ?>
            </a>
        </span>
    </h1>;
<?php endif; ?> 
```

# php - 将数组推入多维数组？

> ID：10306732
> 
> 赞同：0
> 
> 时间：2012-04-24T22:08:05.800
> 
> 标签：php, json, multidimensional-array

我有 json_encoded 数组，我想添加到使用 php

```
[{"id":"a","value":"2"},{"id":"b","value":"2"}] 
```

我想将以下内容添加到上面的数组中：

```
array("id" => c, "value" => "3") 
```

我尝试`json_decode`然后尝试将数组推入其中，但我对如何做到这一点感到困惑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:10:05.147

确保在数组模式而不是对象模式下使用[json_decode ：](http://php.net/manual/en/function.json-decode.php)

```
// Default: JSON is decoded as object
$json_object = json_decode($json_string);

// Pass true in the second argument to get an array instead
$json_array = json_decode($json_string, true);

// Push a new entry onto the end
$json_array[] = array("id" => c, "value" => "3");

// Re-encode JSON string, if needed
$json_final_string = json_encode($json_array); 
```

# syntax - OCaml 构造函数解包

> ID：10306733
> 
> 赞同：5
> 
> 时间：2012-04-24T22:08:07.363
> 
> 标签：syntax, ocaml

是否可以通过将类型的数据绑定到单个值而不是元组来解包类型？

```
# type foo = Foo of int * string;;
type foo = Foo of int * string
# Foo (3; "bar");;
  Foo (3; "bar");;
Error: The constructor Foo expects 2 argument(s),
       but is applied here to 1 argument(s)
# Foo (3, "bar");;
- : foo = Foo (3, "bar")

# (* Can this possibly work? *)
# let Foo data = Foo (3, "bar");;
  let Foo data = Foo (3, "bar");;
Error: The constructor Foo expects 2 argument(s),
       but is applied here to 1 argument(s)

# (* Here is the version that I know works: *)
# let Foo (d1, d2) = Foo (3, "bar");;
val d1 : int = 3
val d2 : string = "bar" 
```

这在语法上可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T22:20:39.977

这是 OCaml 语法的一个棘手部分。如果您在显示时定义类型，则其构造函数`Foo`需要括号中的两个值。它总是必须是两个值，而不是一个元组的单个值。

如果你愿意使用不同的类型，你可以做一些更像你想要的事情：

```
# type bar = Bar of (int * string);;
type bar = Bar of (int * string)
# let Bar data = Bar (3, "foo");;
val data : int * string = (3, "foo")
# let Bar (d1, d2) = Bar (3, "foo");;
val d1 : int = 3
val d2 : string = "foo" 
```

当以这种方式声明时，构造函数`Bar`需要*一个*元组值。这可以更灵活，但也需要更多的内存来表示它，并且访问部分的时间更长。

# php - php中的所有错误路径

> ID：10306734
> 
> 赞同：0
> 
> 时间：2012-04-24T22:08:16.297
> 
> 标签：php, error-handling

请帮助我，我已经通过 htaccess 设置了错误日志：

```
php_flag log_errors On
php_value error_log errors/log/errors_log.txt
php_flag display_errors On
php_value error_reporting 6135 
```

它工作正常，但有一个小问题，我有我自己的函数，它几乎在我的网络上的所有脚本中使用，并且在这个函数内部发生这个错误：

```
[24-Apr-2012 23:33:11] PHP Warning: trim() expects parameter 1 to be string, array given in /path/public_html/req/functions.php on line 200 
```

现在的问题是我不知道这个错误发生在哪个脚本中，它只显示了声明函数的路径，但不显示在这个函数内部传递变量的方式，这个错误导致。

这里有什么简单的方法可以显示所有错误路径吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:11:49.297

在您的错误处理功能中，您可以使用[`debug_print_backtrace()`](http://www.php.net/manual/en/function.debug-print-backtrace.php)or [`debug_backtrace()`](http://www.php.net/manual/en/function.debug-backtrace.php)。

# c++ - c ++通过移动指针在数组中导航

> ID：10306735
> 
> 赞同：1
> 
> 时间：2012-04-24T22:08:16.267
> 
> 标签：c++, arrays, pointers

在下文中，我预计将打印 13。
我想将 arr （这是一个指向内存的指针，如果我理解一切正确的话，存储数组中的 int 值）按一个数组成员的大小，即 int。

而是打印 45。因此，取而代之的是进行一个数组成员范围的跳转，而是检索第 5 个数组成员。为什么？

```
int arr[] = {1,13,25,37,45,56};
int val = *( arr + 4 );         //moving the pointer by the sizeof(int)=4
std::cout << "Array Val: " << val << std::endl; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T22:09:30.170

你的假设是错误的。它将指针向前移动 4 个元素，而不是向前移动 4 个字节。

`*(arr + 4)`就像在那个逻辑中说的那样`*(arr + 4 * sizeof (arr [0]))`。

该语句`*(arr + 4)`等价于`arr [4]`。它确实产生了一些简洁的语法，但`*(4 + arr)`同样有效，意思是`4 [arr]`.

您的行为可以通过以下示例实现：

```
#include <iostream>

int main()
{
    int a[3] = {65,66,67};
    char *b = reinterpret_cast<char *>(a);
    std::cout << *(b + sizeof (int)); //prints 'B'
} 
```

我不建议`reinterpret_cast`为此目的使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T22:10:58.100

`arr + 4`将从数组的起始地址为您提供 4 个项目，而不是 4 个字节。这就是为什么你得到 45，这是第零项加 4。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:11:31.283

它正在执行指针运算。看到这个：[http ://www.eskimo.com/~scs/cclass/notes/sx10b.html](http://www.eskimo.com/~scs/cclass/notes/sx10b.html)

`arr`是你的数组，它分解为第一个元素，然后你`arr[0]`将指针移动 4 个元素，因此它现在指向。`1``+ 4``arr[4]``45`

# android - 与安卓设备的套接字通信

> ID：10306746
> 
> 赞同：0
> 
> 时间：2012-04-24T22:08:59.903
> 
> 标签：android, database, sockets

我可以从客户端（android 设备）与服务器（android 设备）交互，只是为了使用 TCP 套接字查询位于服务器中的数据库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T09:03:44.503

是和否。如果您的设备在无线网络内并且有自己的本地 IP。如果它在同一个网络中，只需提供正确的 IP 和端口，您就可以从客户端电话连接到它。
如果服务器电话位于另一个无线网络中，则端口必须使用路由器设置转发到服务器端口。请记住，如果您将通过电话重新连接到无线网络，那么 IP 将由网络基础设施自动分配，并且它可能会比以前发生更改。

如果您想在 3G 网络（或类似的非 wifi）上连接服务器电话，您将没有任何特定的 IP，而且它不是静态的，这样几乎不可能创建可靠的网络。它是您正在寻找的更多点对点网络模型。

中间使用Server作为网关会好很多，这样就更可靠了。唯一的问题是，您将必须托管服务器及其进程以及所有流量等。

# php - PHP：preg_replace 匹配一些数字但不匹配其他数字

> ID：10306749
> 
> 赞同：1
> 
> 时间：2012-04-24T22:09:12.997
> 
> 标签：php, regex

所以我一直在做一个小项目，为游戏的脚本语言编写语法荧光笔。这一切都顺利进行，除了一个部分：数字。

以这些行为例

`(5:42) Set database entry {healthpoints2} to the value 100.`

`(5:140) Move the user to position (29,40) on the map.`

我想在最后突出显示 100，而不突出显示大括号中的 (5:42) 或 2。数字不会总是在同一个地方，也不会总是只有一个数字。

我基本上需要一个正则表达式来表示：

“匹配任何不在 {} 之间且不匹配 (#:#) 模式的数字。”

我已经做了一天半了，我正在拔头发试图弄清楚。对此的帮助将不胜感激！我已经查看了[regular-expressions.info](http://www.regexbuddy.com/)，并尝试使用[RegexBuddy](http://www.regular-expressions.info/)，但我就是不明白：c

编辑：根据要求，这里有一些直接从脚本编辑器复制的行。

`(0:7) When somebody moves into position (**10** fhejwkfhwjekf **20**,`

`(0:20) When somebody rolls exactly **10** on **2** dice of **6** sides,`

`(0:31) When somebody says {...},`

`(3:3) within the diamond (**5**,**10**) - **20** //// **25**,`

`(3:14) in a line starting at (#, #) and going # more spaces northeast.`

`(5:10) play sound # to everyone who can see (#,#).`

`(5:14) move the user to (#,#) if there's nobody already there.`

`(5:272) set message ~msg to be the portion of message ~msg from position # to position #.`

`(5:302) take variable %var and add # to it.`

`(5:600) set database entry {...} about the user to #.`

`(5:601) set database entry {...} about the user named {...} to #.`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:15:39.290

当你看到这个解决方案时，你可能会踢自己......

假设这个期望的数字总是在一个句子中使用，它应该总是在它前面有一个空格。

```
$pattern = '/ [0-9]+/s'; 
```

如果前面的空格并不总是存在，请告诉我，我会更新答案。

* * *

这是更新的正则表达式，以匹配您问题中的 2 个示例：

```
$pattern = '/[^:{}0-9]([0-9,]+)[^:{}0-9]/s'; 
```

* * *

第三次更新以说明您的问题修订：

```
$pattern = '/[^:{}0-9a-z#]([0-9]+[, ]?[0-9]*)[^:{}0-9a-z#]/s'; 
```

所以你不要在诸如此类的事情中突出显示数字

> {更新 29 测试}

您可能想要预先剥离大括号，如下所示：

```
$pattern = '/[^:{}0-9a-z#]([0-9]+[, ]?[0-9]*)[^:{}0-9a-z#]/s';
$str = '(0:7) Hello {update 29 testing} 123 Rodger alpha charlie 99';
$tmp_str = preg_replace('/{[^}]+}/s', '', $str);
preg_match($pattern, $tmp_str, $matches); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:29:27.327

```
(\d+,\s?\d+)|(?<![\(\{:]|:\d)\d+(?![\)\}]) 
```

[http://regexr.com?30omd](http://regexr.com?30omd)

这行得通吗？

# google-app-engine - 实体组和命名空间

> ID：10306753
> 
> 赞同：0
> 
> 时间：2012-04-24T22:09:28.840
> 
> 标签：google-app-engine, python-2.7

命名空间是否分隔实体组？

假设我有一个具有多个命名空间的应用程序，每个命名空间都有 1 个实体组，而实体组键不是真正的实体，而是一个键结构。

```
master_group = ndb.Key('Foo', 'bar') 
```

如果所有命名空间都具有相同的实体组键，它是否算作**1 个单个实体组**，或者它是否由包含在 Key 对象中的命名空间分隔，并且**master_groups 与命名空间一样多**？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T23:05:10.330

[文档](https://developers.google.com/appengine/docs/python/multitenancy/multitenancy#Using_Namespaces_with_the_Datastore)声明当前命名空间在创建时应用于密钥。[键](https://developers.google.com/appengine/docs/python/datastore/keyclass#Key_from_path)采用命名空间参数。因此，不同命名空间中的根实体位于不同的实体组中。

# javascript - 等待动态加载的 Javascript 文件完成加载的有效方法是什么？

> ID：10306755
> 
> 赞同：0
> 
> 时间：2012-04-24T22:09:32.730
> 
> 标签：javascript

我正在加载一个 Javascript 文件，其中包含我想调用的函数。这是不可能的，因为在“启动”加载和实际调用函数之间，JS 尚未加载。当然，我可以做类似的事情`setTimeout('functionCall();',5000);`，但我认为这不是一个非常有效的方法，而且对我来说似乎真的很不稳定。这就是为什么我想知道是否有更好的方法来做到这一点。

这是我正在使用的代码。有问题的函数被调用`controllerStart`。如果我在这里注释掉最后一行，并将其输入到 Javascript 终端（如在 Chrome 开发人员工具上），一切正常。

```
 function loadController(name){
        clearAll();
        scriptContainer.innerHTML = '';
        var scriptElement = document.createElement('script');
        scriptElement.setAttribute('src','controllers/' + name + '.js');
        scriptElement.setAttribute('type','text/javascript');
        scriptContainer.appendChild(scriptElement);
        controllerStart();// <-- Doesn't work from here, but works on a terminal
    } 
```

谢谢参观！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:32:59.980

从它的声音来看，您正在异步加载 JavaScript。在较新的浏览器中，标签上有一个 onload 事件，该事件在完成加载时触发。但是，如果您需要跨浏览器支持，唯一的方法是：

(a) 如果它是从与您的页面相同的服务器加载的，请使用 AJAX 加载您的 javascript，然后在加载时使用 eval() 执行它（而不是使用`<script>`标签），

(b) 如果您控制该文件，请在其末尾添加一个事件触发器，然后在您的主 JavaScript 文件中进行监听。JQuery 的 bind() 和 trigger() 函数很方便。

(c) 如果它是从其他地方加载的并且您无法控制它（但有权重新分发它），请将其重新定位到您的服务器并遵循 (a)。

您也可以取消异步加载，只需将`<script>`标签流放在标题中，这是老式的方式。这保证了每个脚本在前一个脚本完成之前不会运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:11:35.387

引用 Javascript 后调用该函数。

JS 加载是同步的。

所以.....

---- js库调用-----

----- 在这里调用函数 -----

利润！

编辑：具体来说：

```
function loadController(name){
        clearAll();
        scriptContainer.innerHTML = '';
        var scriptElement = document.createElement('script');
        scriptElement.setAttribute('src','controllers/' + name + '.js');
        scriptElement.setAttribute('type','text/javascript');
        scriptContainer.appendChild(scriptElement);
        scriptElement.onload = new function(){controllerStart();}; 
       //something like that.
    } 
```

编辑 2：我的错 - 使用“onload”而不是“load” - 大脑上有太多 jquery

更多关于“onload”的信息：[http ://www.onlinetools.org/articles/unobtrusivejavascript/chapter4.html](http://www.onlinetools.org/articles/unobtrusivejavascript/chapter4.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:19:54.000

Nicholas C. Zackas 有一篇关于它的好帖子，您可以[在此处](http://www.nczonline.net/blog/2009/07/28/the-best-way-to-load-external-javascript/ "这里")阅读，其中仅包含您想要使用的代码。

基本上它只是一个函数，其中包含要加载的 JS 文件的 URL，以及加载时要执行的回调。然后它创建`<script>`标签，在加载后附加要执行的回调（通过 onreadystatechange 或 onload 事件）并将其插入到 DOM 中。

然后，您需要做的就是这样称呼它：

```
loadScript('controllers/' + name + '.js', controllerStart); 
```

# tcp - 如何通过 tcp 发送 RSA 开放密钥？

> ID：10306759
> 
> 赞同：-1
> 
> 时间：2012-04-24T22:10:06.680
> 
> 标签：tcp, openssl, rsa

那么，问题是如何正确制作 RSA *rsa 密钥的二进制数据？我愿意

```
RSA *rsa = RSA_generate_key(2048, 65537, 0, 0);
uchar *pp = (uchar *)malloc(2560);
int bytes = i2d_RSAPublicKey(rsa, &pp);
write(client, pp, bytes); 
```

并且接收者执行 d2i_RSAPublicKey 并且程序崩溃。我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T11:23:52.560

不要`pp`自己 malloc，而是将其设置为 NULL。`i2d_RSAPublicKey`将为您执行 malloc 并将 pp 设置为指向新分配的公钥。

# gcc - 清理代码以启用 -ffinite-math

> ID：10306761
> 
> 赞同：0
> 
> 时间：2012-04-24T22:10:17.430
> 
> 标签：gcc, floating-point, floating-accuracy

我有几个音频库需要清理，以便打开 -ffinite-math。我知道我需要删除 NaN 和 +/-Inf 作为标记值的使用，但不清楚如何确保代码的稳定性。我也不确定使用 -ffinite-math-only 时可以安全地进行哪种浮点比较测试。只是废弃代码并重写它会更好吗？

我知道没有一个简单的答案，所以请随时发布任何讨论稳定浮点代码的文献的链接，而不使用哨兵值和/或重构浮点代码以提高速度。

谢谢

# android - 使用 android sherlock 编译片段示例时出错

> ID：10306764
> 
> 赞同：0
> 
> 时间：2012-04-24T22:10:36.943
> 
> 标签：android

我正在使用 Android Sherlock，我正在尝试在 Android 中实现片段的经典示例：

[http://developer.android.com/guide/topics/fundamentals/fragments.html](http://developer.android.com/guide/topics/fundamentals/fragments.html)

但是在**TitlesFragment.java**文件中出现错误，避免我的应用程序运行。我不知道为什么。

```
package com.android.fragmenttest;

import android.content.Intent;
import android.os.Bundle;
import android.support.v4.app.FragmentTransaction;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;

import com.actionbarsherlock.app.SherlockListFragment;

public class TitlesFragment extends SherlockListFragment {
    boolean mDualPane;
    int mCurCheckPosition = 0;

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        // Populate list with our static array of titles.
        setListAdapter(new ArrayAdapter<String>(getActivity(), android.R.layout.simple_list_item_1, android.R.id.text1, Shakespeare.TITLES));

        // Check to see if we have a frame in which to embed the details
        // fragment directly in the containing UI.
        View detailsFrame = getActivity().findViewById(R.id.details);
        mDualPane = detailsFrame != null && detailsFrame.getVisibility() == View.VISIBLE;

        if (savedInstanceState != null) {
            // Restore last state for checked position.
            mCurCheckPosition = savedInstanceState.getInt("curChoice", 0);
        }

        if (mDualPane) {
            // In dual-pane mode, the list view highlights the selected item.
            getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE);
            // Make sure our UI is in the correct state.
            showDetails(mCurCheckPosition);
        }
    }

    @Override
    public void onSaveInstanceState(Bundle outState) {
            super.onSaveInstanceState(outState);
            outState.putInt("curChoice", mCurCheckPosition);
    }

    @Override
    public void onListItemClick(ListView l, View v, int position, long id) {
            showDetails(position);
    }

    // Helper function to show the details of a selected item, either by displaying a fragment in-place in the current UI, or starting a
    // whole new activity in which it is displayed.
    void showDetails(int index) {
        mCurCheckPosition = index;

        if (mDualPane) {
            // We can display everything in-place with fragments, so update the list to highlight the selected item and show the data.
            getListView().setItemChecked(index, true);

            // Check what fragment is currently shown, replace if needed.
            DetailsFragment details = (DetailsFragment) getFragmentManager().findFragmentById(R.id.details);
            if (details == null || details.getShownIndex() != index) {
                // Make new fragment to show this selection.
                details = DetailsFragment.newInstance(index);

                // Execute a transaction, replacing any existing fragment with this one inside the frame.
                FragmentTransaction ft = getFragmentManager().beginTransaction();
                ft.replace(R.id.details, details);
                ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
                ft.commit();
            }
        } else {
            // Otherwise we need to launch a new activity to display the dialog fragment with selected text.
            Intent intent = new Intent();
            intent.setClass(getActivity(), DetailsActivity.class);
            intent.putExtra("index", index);
            startActivity(intent);
        }
    }
} 
```

Eclipse 哭泣的台词是：

```
View detailsFrame = getActivity().findViewById(R.id.details); 
```

和：

```
DetailsFragment details = (DetailsFragment) getFragmentManager().findFragmentById(R.id.details); 
```

和：

```
ft.replace(R.id.details, details); 
```

因此，**R.id.details**是问题所在。类**DetailsFragment.java**定义如下：

```
package com.android.fragmenttest;

import android.os.Bundle;
import android.util.TypedValue;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ScrollView;
import android.widget.TextView;

import com.actionbarsherlock.app.SherlockFragment;

public class DetailsFragment extends SherlockFragment {
    // Create a new instance of DetailsFragment, initialized to show the text at 'index'.
    public static DetailsFragment newInstance(int index) {
        DetailsFragment f = new DetailsFragment();

        // Supply index input as an argument.
        Bundle args = new Bundle();
        args.putInt("index", index);
        f.setArguments(args);

        return f;
    }

    public int getShownIndex() {
        return getArguments().getInt("index", 0);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        if (container == null) {
            // We have different layouts, and in one of them this fragment's containing frame doesn't exist.  The fragment
            // may still be created from its saved state, but there is no reason to try to create its view hierarchy because it
            // won't be displayed.  Note this is not needed -- we could just run the code below, where we would create and return
            // the view hierarchy; it would just never be used.
            return null;
        }
        ScrollView scroller = new ScrollView(getActivity());
        TextView text = new TextView(getActivity());
        int padding = (int)TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, 4, getActivity().getResources().getDisplayMetrics());
        text.setPadding(padding, padding, padding, padding);
        scroller.addView(text);
        text.setText(Shakespeare.DIALOGUE[getShownIndex()]);
        return scroller;
    }
} 
```

有谁知道为什么 Eclipse 不让这个片段示例编译？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T23:26:53.170

它应该是`getSherlockActivity();`并且`getSupportFragmentManager();`在使用**ActionbarSherlock 时。**

# asp.net - ASP.NET 如何识别请求是回发？

> ID：10306767
> 
> 赞同：4
> 
> 时间：2012-04-24T22:10:54.777
> 
> 标签：asp.net, http

我有点好奇 ASP.Net 如何在内部识别请求是回发。
我在 Microsoft 的一本书中读到，从技术上讲，您可以使用 POST 和 GET 方法进行回发
。这意味着命令与回发没有任何关系。
我尝试使用 Fiddler 查看请求标头发送的内容。我认为这可能与视图状态有关，但我不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:17:53.767

你几乎是对的。

根据作为请求的一部分发送的 _EVENTTARGET 和 _EVENTARGUMENT 变量触发正确的事件。我相信 IsPostBack 是根据这些值设置的。这些决定了要触发哪个事件以及使用什么参数。

实际提交由`__doPostBack()`javascript 中的函数触发。

更多细节在这里：[http ://dotnetslackers.com/Community/blogs/haissam/archive/2007/05/18/Which-Control-Caused-PostBack_2100_.aspx](http://dotnetslackers.com/Community/blogs/haissam/archive/2007/05/18/Which-Control-Caused-PostBack_2100_.aspx)

# c# - 允许 C# 插件在应用程序挂钩上注册

> ID：10306778
> 
> 赞同：8
> 
> 时间：2012-04-24T22:11:53.990
> 
> 标签：c#, .net, plugins, architecture

我正在构建一个基于 .NET 的应用程序，并希望允许一个更可扩展和可插拔的设计。

为了简单起见，应用程序公开了一组操作和事件：

*   做一点事（）
*   做其他事情（）
*   错误
*   成功

我想提供“插件”以加载并挂钩其中一些操作（例如：当 Event1 触发时，运行 plugin1）。

例如 --当*OnError*事件触发时运行*plugin1.HandleError() 。*

 *这可以通过事件订阅轻松完成：

```
this.OnError += new Plugin1().HandleError(); 
```

问题是：

1.  我的应用不知道“Plugin1”类型（它是一个插件，我的应用不直接引用它）。
2.  这样做会在时间之前实例化插件，这是我不想做的。

在“传统”插件模型中，应用程序（插件的“客户端”）在某些关键点加载并执行插件代码。例如——图像处理应用程序，当执行某个操作时）。

客户端应用程序知道何时实例化插件代码以及何时执行它的控制。

在我的应用程序中，插件本身决定何时执行（“插件应在 OnError 事件上注册”）。

将插件“执行”代码与“注册”代码一起保存会带来一个问题，即插件 DLL 将在注册时加载到内存中，这是我希望防止的。

例如，如果我在插件 DLL 中添加一个 Register() 方法，则插件 DLL 必须加载到内存中才能调用 Register 方法。

对于这个特定问题，什么是好的设计解决方案？

*   延迟加载（或提供延迟/急切加载）插件 DLL。
*   允许插件控制它们连接到系统/应用程序的各个部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T00:05:58.903

您正在尝试解决一个不存在的问题。当您的代码调用 Assembly.LoadFrom() 时加载所有类型的心理形象是错误的。.NET 框架充分利用了 Windows 作为按需分页虚拟内存操作系统的优势。然后还有一些。

当您调用 LoadFrom() 时，球开始滚动。这使得 CLR 创建一个*内存映射文件*，一个核心操作系统抽象。它更新了一些内部状态以跟踪现在驻留在 AppDomain 中的程序集，这非常小。MMF 设置内存映射，创建映射文件内容的虚拟内存页面。只是处理器 TLB 中的一个小描述符。实际上没有从汇编文件中读取任何内容。

接下来，您将使用反射来尝试发现实现接口的类型。这会导致 CLR 从程序集中读取一些程序集元数据。此时，页面错误会导致处理器将覆盖程序集元数据部分的某些页面的内容映射到 RAM 中。少量千字节，如果程序集包含很多类型，则可能更多。

接下来，即时编译器开始运行，为构造函数生成代码。这会导致处理器错误地将包含构造函数 IL 的页面放入 RAM。

等等。核心思想是汇编内容总是被懒惰地读取，只有在*需要*的时候。这种机制对于插件来说并*没有什么*不同，它们就像您解决方案中的常规程序集一样工作。唯一的区别是顺序略有不同。您首先加载程序集，然后立即调用构造函数。与在代码中调用类型的构造函数相反，CLR 然后立即加载程序集。它需要同样长的时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T22:15:51.770

您需要做的是找到 dll 的路径，然后从中创建一个程序集对象。从那里，您将需要获取您希望检索的类（例如，实现您的接口的任何东西）：

```
var assembly = Assembly.Load(AssemblyName.GetAssemblyName(fileFullName));
foreach (Type t in assembly.GetTypes())
{
  if (!typeof(IMyPluginInterface).IsAssignableFrom(t)) continue;
  var instance = Activator.CreateInstance(t) as IMyPluginInterface;
  //Voila, you have lazy loaded the plugin dll and hooked the plugin class to your code
} 
```

当然，从这里你可以自由地做任何你想做的事情，使用方法，订阅事件等等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T22:32:56.963

对于加载插件程序集，我倾向于依靠我的 IoC 容器从目录加载程序集（我使用 StructureMap），尽管您可以按照@Oskar 的回答手动加载它们。

如果您想在应用程序运行时支持加载插件，可以“重新配置”StructureMap，从而选择任何新插件。

对于您的应用程序挂钩，您可以将事件分派到事件总线。下面的示例使用 StructureMap 来查找所有已注册的事件处理程序，但您可以使用普通的旧反射或其他 IoC 容器：

```
public interface IEvent { }
public interface IHandle<TEvent> where TEvent : IEvent {
    void Handle(TEvent e);
}

public static class EventBus {
    public static void RaiseEvent(TEvent e) where TEvent : IEvent {
        foreach (var handler in ObjectFactory.GetAllInstances<IHandle<TEvent>>())
            handler.Handle(e);
    }
} 
```

然后，您可以像这样引发事件：

```
public class Foo {  
    public Foo() {
        EventBus.RaiseEvent(new FooCreatedEvent { Created = DateTime.UtcNow });
    }
}

public class FooCreatedEvent : IEvent {
    public DateTime Created {get;set;}
} 
```

并像这样处理它（例如在你的插件中）：

```
public class FooCreatedEventHandler : IHandle<FooCreatedEvent> {
    public void Handle(FooCreatedEvent e) {
        Logger.Log("Foo created on " + e.Created.ToString());
    }
} 
```

我肯定会推荐Shannon Deminick 的[这篇文章](http://shazwazza.com/post/Developing-a-plugin-framework-in-ASPNET-with-medium-trust.aspx)，它涵盖了开发可插拔应用程序的许多问题。这是我们用作我们自己的“插件管理器”的基础。

我个人会避免按需加载程序集。*IMO 与运行*应用程序的用户必须等待加载必要的插件相比，启动时间稍长一些（甚至在 Web 应用程序上的问题更小）更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T22:52:58.343

[托管可扩展性框架](http://mef.codeplex.com/)是否适合您的需求？*

# python - Python扭曲反应堆未定义变量

> ID：10306779
> 
> 赞同：6
> 
> 时间：2012-04-24T22:12:02.780
> 
> 标签：python, twisted, tcpserver

我正在关注本教程： [http ://www.raywenderlich.com/3932/how-to-create-a-socket-based-iphone-app-and-server](http://www.raywenderlich.com/3932/how-to-create-a-socket-based-iphone-app-and-server)

但是当我写

```
reactor.listenTCP(80, factory) 
```

eclipse 告诉我这是一个未定义的变量.. 我安装了 twisted 并且可以为导入自动完成，但这不起作用.. 谷歌显示了更多有这个问题但我找不到任何解决方案.. 谢谢！

编辑：完整代码：

```
from twisted.internet.protocol import Factory
from twisted.internet import reactor

factory = Factory()
reactor.listenTCP(80, factory)
reactor.run() 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-25T00:19:57.880

这是一个与 Eclipse/PyDev 执行静态分析的方式相关的已知问题。

如果仔细观察，`reactor`在导入时该对象实际上并不存在于 twisted.internet 模块中。模块为空。

当 Eclipse/PyDev 尝试编译字节码时，静态分析看不到`reactor`twisted.internet 模块中的对象并将其标记为未定义变量，即使它实际上在运行时存在（通过一些 Twisted 魔术注册，我无法解释）。

我使用的解决方法很简单，只需添加#@UndefinedVariable 即可抑制错误：

```
reactor.run() #@UndefinedVariable 
```

瞧。没有更多的 IDE 错误。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-24T22:34:12.237

尝试在 Eclipse 之外运行它。如果它有效，这是一个日食问题。

# android - 在 Android 上询问用户英尺和英寸的适当方式？

> ID：10306783
> 
> 赞同：1
> 
> 时间：2012-04-24T22:12:22.583
> 
> 标签：android, android-layout, units-of-measurement

我正在实现一个要求用户进行测量的表单。根据区域设置，用户将输入米或英尺/英寸。

天真地，我当前的实现要求仅使用英尺来使用小数点。例如，2.5 英尺等于 2 英尺 6 英寸，这在我的理解中是相当误导的。我不在一个[没有采用公制的国家](http://en.wikipedia.org/wiki/Metrication#Overview)，所以当时对我来说并不明显。

我看到了一些可能性和问题：

*   显示两个`EditText`字段，一个为英尺，一个为英寸。这使得布局设计变得困难，因为我还允许用户输入米，这将只需要一个`EditText`. 一种可能性是在运行时将其隐藏。
*   使用 one `EditText`，我似乎无法找到一个`android:inputType`允许数字输入加上双素数和素数或双引号和撇号的方法。例如 3' 5" 或 3' 5"。这意味着`EditText`必须使用标准字母键盘，这对用户造成了轻微的阻碍。
*   此外，对于 one `EditText`，我很高兴（并且已经这样做了，只是一个没有英寸的米和英尺的条目），`EditText`在用户失去焦点后添加后缀，并在再次获得焦点时删除后缀。这确实使简单输入字段的代码更加复杂。

还有其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:13:57.373

发布后不久我才意识到：

为什么不创建一个[`NumberPicker`](http://developer.android.com/reference/android/widget/NumberPicker.html)弹出窗口或者`Spinner`当用户关注`EditText`. 这只会出现在英制测量中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T22:23:46.530

我在想，您可以使用[TextWatcher](http://developer.android.com/reference/android/widget/TextView.html#addTextChangedListener%28android.text.TextWatcher%29)来检查用户何时键入空格。`'`发生这种情况时，在末尾 添加后缀并让用户键入英寸。

或者，每次用户键入时，始终将后缀附加到末尾并将其向下推到光标之外。当用户按下空格键时，将光标跳过并`"`超出它。

从用户流的角度来看，它可能会也可能不会很乱（我没有尝试或看到过），但它可以解决一些问题。您可以继续强制用户只输入数字值，以保持数字键盘向上而不是字母。他们不必更换键盘或长按来输入单个字符。它还向用户显示他/她键入时的意图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-12T18:06:05.010

```
 edittext.setOnKeyListener(new View.OnKeyListener() {
        @Override
        public boolean onKey(View v, int keyCode, KeyEvent event) {
            if (event.getKeyCode() != KeyEvent.KEYCODE_DEL) {
                String input = edittext.getText().toString();
                if (input.length() == 1) {
                    input = input + "'";
                    edittext.setText(input);
                    int pos = edittext.getText().length();
                    edittext.setSelection(pos);
                }
            }
            return false;
        }
    }); 
```

# jquery - 将来自 html 文本框的输入添加到 highcharts 图中

> ID：10306785
> 
> 赞同：1
> 
> 时间：2012-04-24T22:12:23.890
> 
> 标签：jquery, textbox, highcharts

我有一个条形图，我想获取当天的活动并将其显示在图表中。这适用于作为参数发送到下面的 myservice 的特定日期。我希望能够更改通过文本输入绘制的日期。使用下面调用的 getChartData 方法，图表不会呈现。为什么会这样？

```
$(function () {
  var chart;
  $(document).ready(function () {
    var options = {
      chart : {
        renderTo : 'container',
        type : 'column'
      },
      title : {
        text : 'Total by Time',
        x : -20 //center
      },            
      xAxis : {
        categories : ['1am', '2am', '3am', '4am', '5am', '6am', '7am', '8am', '9am', '10am', '11am', '12pm', '1pm',
          '2pm', '3pm', '4pm', '5pm', '6pm', '7pm', '8pm', '9pm', '10pm', '11pm', '12am']
      },
      yAxis : {
        min : 0,
        title : {
          text : 'Total'
        },
        stackLabels : {
          enabled : true,
          style : {
            fontWeight : 'bold',
            color : (Highcharts.theme && Highcharts.theme.textColor) || 'gray'
          }
        }
      },
      tooltip : {
        formatter : function () {
          return '<b>' + this.series.name + '</b><br/>' +
          this.x + ': ' + this.y;
        }
      },
      legend : {
        layout : 'vertical',
        align : 'right',
        verticalAlign : 'top',
        x : -10,
        y : 100,
        borderWidth : 0
      },
      plotOptions : {
        column : {
          stacking : 'normal',
          dataLabels : {
            enabled : true,
            color : (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white'
          }
        }
      },
      series : []
    };      
    getChartData();
  });   
});

function getChartData() {
  $.getJSON('http://localhost:8080/myservice/2012-03-23', function (data) {

    options.series = data;
    // Create the chart
    var chart = new Highcharts.Chart(options);
  });   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T17:47:31.337

如果从表单提交发送了两个参数，您可以获取这些参数并使用 getChartData url 中的值，例如：

```
 parts = window.location.search.substr(1).split("&");
 var $_GET = {};
 var custNoPart = parts[0].split("=");
 var dayDatePart = parts[1].split("=");

 var param1 = $_GET[decodeURIComponent(custNoPart[0])] = decodeURIComponent(custNoPart[1]);

  var param2 = $_GET[decodeURIComponent(custNoPart[1])] = decodeURIComponent(dayDatePart[1]); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-24T22:42:59.600

试试这个：

```
$(function () {
  var chartOptions = {
    chart : {
      renderTo : 'container',
      type : 'column'
    },
    title : {
      text : 'Total by Time',
      x : -20 //center
    },
    xAxis : {
      categories : ['1am', '2am', '3am', '4am', '5am', '6am', '7am', '8am', '9am', '10am', '11am', '12pm', '1pm',
        '2pm', '3pm', '4pm', '5pm', '6pm', '7pm', '8pm', '9pm', '10pm', '11pm', '12am']
    },
    yAxis : {
      min : 0,
      title : {
        text : 'Total'
      },
      stackLabels : {
        enabled : true,
        style : {
          fontWeight : 'bold',
          color : (Highcharts.theme && Highcharts.theme.textColor) || 'gray'
        }
      }
    },
    tooltip : {
      formatter : function () {
        return '<b>' + this.series.name + '</b><br/>' +
        this.x + ': ' + this.y;
      }
    },
    legend : {
      layout : 'vertical',
      align : 'right',
      verticalAlign : 'top',
      x : -10,
      y : 100,
      borderWidth : 0
    },
    plotOptions : {
      column : {
        stacking : 'normal',
        dataLabels : {
          enabled : true,
          color : (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white'
        }
      }
    }
  };
  getChartData(chartOptions);
});

function getChartData(chartOptions) {
  $.getJSON('http://localhost:8080/myservice/2012-03-23', function (data) {
    chartOptions.series = data;
    // Create the chart
    var chart = new Highcharts.Chart(chartOptions);
  });
} 
```

# android - Android：当电池电量处于定义水平时做某事

> ID：10306790
> 
> 赞同：3
> 
> 时间：2012-04-24T22:12:35.173
> 
> 标签：android, android-intent, power-management

我在这里遇到了一个小问题。

我希望我的应用程序做点什么，但只有在电池电量为 10% 时。

我的应用程序不会经常观察电池电量；它只是等待 LOW_BATTERY 意图。

如果我不指定级别，它会起作用，但它会起作用 3 次：15%、10% 和 5%

我只希望它以 10% 的速度做某事。

这是我的代码：

```
public void onReceive(Context context, Intent intent) 
{
    if(intent.getAction().equals(ACTION_BATTERY_LOW))
    {
        int level = intent.getIntExtra(BatteryManager.EXTRA_LEVEL, -1);
        int scale = intent.getIntExtra(BatteryManager.EXTRA_SCALE, 100);
        int percent = (level*100)/scale; 

        if(percent == 10)
        {
            // Do Something

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T11:39:27.157

`ACTION_BATTERY_LOW`没有您要从中读取的附加内容，因此您每次都可以`percent`得到。`-1`

正如@bimal 所暗示的那样，这些附加内容*附加*到`ACTION_BATTERY_CHANGED`广播中。但是，这并不意味着您应该只注册以接收它。 `ACTION_BATTERY_CHANGED`具有粘性，因此`registerReceiver()`立即返回最后一个 Intent。这意味着您可以执行以下操作：

```
public void onReceive(Context context, Intent intent) {
    if(intent.getAction().equals(ACTION_BATTERY_LOW)) {
        IntentFilter ifilter = new IntentFilter(Intent.ACTION_BATTERY_CHANGED);
        Intent batteryStatus = context.registerReceiver(null, ifilter);

        int level = batteryStatus.getIntExtra(BatteryManager.EXTRA_LEVEL, -1);
        int scale = batteryStatus.getIntExtra(BatteryManager.EXTRA_SCALE, 100);
        int percent = (level*100)/scale; 

        if (percent <= 10 && percent > 5) {
            // Do Something
        }
    }
} 
```

请注意，这`registerReciever()`是使用 BroadcastReceiver 调用的`null`，因此您不必担心取消注册。这是一种很好、干净的方式，可以说“现在电池状态如何？” （嗯，从技术上讲，这*是*上次发送广播时的内容。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T07:35:57.763

在这种情况下，您可以使用“ACTION_BATTERY_CHANGED”

```
 public void onReceive(Context context, Intent intent) {
        String action = intent.getAction();
        if (Intent.ACTION_BATTERY_CHANGED.equals(action)) {
            int level = intent.getIntExtra("level", 0);
            int scale = intent.getIntExtra("scale", 100);
            double batStatus = level * 100 / scale;
        }
    } 
```

希望这会帮助你。

# jquery - 不显示带有复选框过滤的结果消息

> ID：10306791
> 
> 赞同：0
> 
> 时间：2012-04-24T22:12:41.053
> 
> 标签：jquery, filter, tags

我发现这个解决方案完全符合我的要求......提供复选框并显示符合所有选定标准的结果。

[回复：jQuery 多复选框页面过滤器](https://stackoverflow.com/questions/9747669/re-jquery-multiple-checkbox-page-filter)

如果没有根据所选标准返回结果，我唯一想添加的是一条消息，但我对此很陌生。有什么帮助吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:29:38.597

这里

```
$checked = $('input:checked');

if ($checked.length) {  
  //do something
} else {
  alert('empty');
} 
```

或者

```
$('input:checked').empty() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:31:02.263

### 更新

有 1,001 种方法可以做到这一点……这是一个简单的解决方案。我不能建议这样做的“最佳”方式，因为它取决于站点的其他架构、您的编码风格等。

也就是说，试试这个：http: [//jsfiddle.net/tkLK6/28/](http://jsfiddle.net/tkLK6/28/)

```
if($results.length > 0) {
    $('.no-results-found').remove();
    $results.show();
} else {
    $('.results').append('<li class="no-results-found">No results found.</li>');
} 
```

* * *

试试这个：http: [//jsfiddle.net/tkLK6/27/](http://jsfiddle.net/tkLK6/27/)

代替：

```
$lis.hide().filter(selector).show(); 
```

尝试：

```
var $results = $lis.hide().filter(selector);

if($results.length > 0) {
    $results.show();
} else {
    alert('no results found.');
} 
```

# sql - 来自 3 个不同表的 LINQ 连接

> ID：10306795
> 
> 赞同：0
> 
> 时间：2012-04-24T22:13:09.593
> 
> 标签：sql, linq, join

我有 3 张桌子

```
T1: id1, col1 (id1 is primary key)
T2: id2, id1, col2 (id1 here is  external key from T1)
T3: id3, id1, col3 (id external key of T1) 
```

我的问题很简单：如何使用 LINQ 获取 3 个表的所有列的连接列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T07:58:03.417

我想出了如何连接多个表的结果，这是一个示例，您可以根据需要连接任意数量的表。

```
var a = (from s in _DBEntities.Services
         join d in _DBEntities.Departements on s.se_id_departement equals d.id_departement
         join i in _DBEntities.SsCategoriesServices on s.se_id_sscategorieService equals i.id_SsCategorieService
         select new Services
                    {
                        IdService = s.id_service,
                        Adresse = s.adresseService,
                        NomSousCategory = i.libelleSsCategorieService,
                        NomDepartement = d.nom,
                    }).ToList(); 
```

# javascript - 下拉列表宽度适合所选项目文本

> ID：10306796
> 
> 赞同：6
> 
> 时间：2012-04-24T22:13:15.370
> 
> 标签：javascript, html, css, asp.net-mvc

javascript/jquery 或 css 中是否有办法使 html`<select>/@Html.DropDownList`自动宽度使其适合当前选定的项目，我尝试过`diplay:inline-block`，`width:auto`但宽度似乎总是适合列表中最大的项目？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T23:09:33.633

我的答案类似于 D3mon-1stVFW，但使用隐藏的下拉菜单来动态设置宽度。只要您对隐藏和“真实”的样式使用相同的样式，它就应该考虑不同的字体大小、装饰等。这是 HTML：

```
<!-- this is our hidden "template" drop-down that we'll
     use to determine the size of our "real" one -->
<select id="template" style="display:none;">
  <option id="templateOption"></option>
</select>
<!-- this is our "real" template that will be re-sized -->
<select id="sel">
  <option>Short</option>
  <option>Really, Really, Really Long</option>
</select>​ 
```

和 Javascript：

```
function setSelectWidth() {
  var sel = $('#sel');
  $('#templateOption').text( sel.val() );
  // for some reason, a small fudge factor is needed
  // so that the text doesn't become clipped
  sel.width( $('#template').width() * 1.03 );
}

$(document).ready( function() {
  setSelectWidth();

  $('#sel').change( function() {
    setSelectWidth();
  } );​    
}); 
```

JSFiddle在这里：http: [//jsfiddle.net/kn9DF/1/](http://jsfiddle.net/kn9DF/1/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-12-12T11:10:58.150

@Ethan Brown's answer的变化，`.val()`更正`.text()`并动态创建`select`，因此您的页面不会受到污染：

HTML：

```
<select id="sel">
  <option>Short</option>
  <option>Really, Really, Really Long</option>
</select>​ 
```

JS：

```
function setSelectWidth(selector) {
    var sel = $(selector);
    var tempSel = $("<select style='display:none'>")
        .append($("<option>").text(sel.find("option:selected").text()));
    tempSel.appendTo($("body"));

    sel.width(tempSel.width());

    tempSel.remove();
}

$(function() {
    setSelectWidth("#sel");

    $("#sel").on("change", function() {
        setSelectWidth($(this));
    });
}); 
```

小提琴：

[http://jsfiddle.net/kn9DF/242/](http://jsfiddle.net/kn9DF/242/)

在 Chrome 39、FF 36、IE 11 上测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-28T07:08:11.757

这是一个可以放入任何页面的通用 jQuery 函数。它会立即调整所有选择器的大小，并确保在更改它们时调整它们的大小。

```
function setSelectWidth() {
    var $yardstick = $('<select><option>' + $(this).val() + '</option></select>')
    $yardstick.css({display: 'none'}).appendTo('body');
    var fudge = 1.03; // need a little more to avoid clipping for some reason    
    $(this).width( fudge * $yardstick.width() );
    $yardstick.remove();
}

function initSelectors() {
  $('select').each(function() {
    setSelectWidth.apply(this);
  }).one('change', function() {
    setSelectWidth.apply(this);
  });
}

initSelectors();
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<!-- examples -->
<select id="example-1">
    <option>Short</option>
    <option>Really, Really, Really Long</option>
</select>

<select id="example-2">
    <option>Tiny</option>
    <option>A bit bigger</option>
    <option>Huuuuuuuuuuuuuuuuuuuuge</option>    
</select>
```

该脚本来自 Ethan 和 Ian 的答案。如果添加选择器，确实需要重新调用 initSelectors 函数，但它使用 jQuery `one`，因此如果先前的选择器保留在页面上，它可以安全地多次调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T22:18:06.420

使用我写的这个示例。创建列表时使用相同的方法，只需选择默认值并将其设置在跨度中并获取其宽度。

```
<script>
    function newSelected(ele){
       document.getElementById('jsize').innerHTML = ele.value;
       document.getElementById('selectList').style.width = ($(jsize).width()+30)+'px';
    }

</script>

<span id="jsize" style="display:none"></span><br />

<select id="selectList" onchange="newSelected(this);">
    <option>small item</option>
    <option>a really big long item</option>
</select> 
```

​ 见[http://jsfiddle.net/39ffp/2/](http://jsfiddle.net/39ffp/2/) 可以调整

# grails - Grails：g:each 标签中的 GSP 变量替换

> ID：10306797
> 
> 赞同：0
> 
> 时间：2012-04-24T22:13:32.077
> 
> 标签：grails, gsp

我在循环中有一个循环，并且想将第一个 var 的值替换为第二个。下面是代码片段。

```
<g:each in="${tables}" status="i" var="table">
    <div class="tabletitle">
        ${table.name}
    </div>
    <table>
        <thead>
            <tr>
            <g:each in="${${table.name}DisplayColumns}" status="k" var="displayColumn">
                <td>${displayColumn}</td>
            </g:each>
            </tr>
        </thead>
        <tbody>
            ....
            ....
        </tbody>
    </table>
</g:each> 
```

第二个 g:each 标签中的 ${table.name} 替换不起作用。有什么想法让它发挥作用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T23:01:13.060

尝试这个：

```
 <g:each in="${evaluate(table.name+'DisplayColumns')}" status="k" var="displayColumn"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T02:38:51.767

有趣的是，正如凯利建议的那样，我从未在 gsp 中使用评估。但是我可以建议一种不太理想的方法吗？

您可以使用（[http://grails.org/doc/2.0.x/ref/Tags/set.html](http://grails.org/doc/2.0.x/ref/Tags/set.html)）存储`${table.name}`在变量中`<g:set>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T06:04:14.333

你知道你可以将任何对象传递给 GSP 吗？甚至地图（您正在尝试模拟地图，我不知道为什么），并像这样使用它：

```
<g:each in="${displayColumns[table.name]}"> 
```

其中 displayColumns 是一个包含每个表的列的 Map。

顺便说一句，更干净的方法是使用包含此数据的特殊对象。类似的东西`TableDetails`有`List<String> getColumns()`方法。所以你可以使用

```
<g:each in="${tables}" var="table">

   ${table.name}

   <g:each in="${table.columns}" var="column">
     ${column}
   </g:each>

</g:each> 
```

# image-processing - Cuda 中的噪点和模糊

> ID：10306798
> 
> 赞同：2
> 
> 时间：2012-04-24T22:13:37.353
> 
> 标签：image-processing, cuda, gpgpu, blur, noise

我正在尝试在 Cuda 的项目中添加噪声和模糊功能，经过相当多的研究后，我遇到了一些绊脚石，我已经阅读了高斯模糊矩阵，但我仍然无法获得能够模糊图像某些部分的工作代码，我已经设法得到一种噪声形式来显示。如果有人可以在解释如何实现高斯或更简单的模糊方法或什至提供一些实现模糊的代码方面提供一些帮助。感激不尽！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:28:28.847

[高斯模糊](https://en.wikipedia.org/wiki/Gaussian_blur)是一个可分离的过滤器，因此您可以先将 1D 内核应用到 ROI 中的所有行，然后再应用到模糊行的列。

CUDA 的棘手部分是这是一个邻域操作，因此通常您需要让每个块重叠一半内核大小，以便将所需的邻域像素放入共享内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T22:28:57.490

仅供参考，这是两个独立的问题，应在本网站中单独提出。

关于模糊 - 对于大模糊内核（强模糊），最好的方法是在图像和高斯噪声内核图像上使用 FFT，然后使用复数乘法和逆 FFT 将结果相乘。您必须自己实现 FFT-Shift 功能，如果您使用彩色图像，则必须将图像拆分为每个通道的单独缓冲区。

对于小的模糊内核（外邦模糊），最简单的方法是对结果图像中的每个像素求和源图像中的附近像素（使用高斯权重函数）。

关于噪声测试最简单的方法是在将预生成的伪随机生成器的结果图像从均匀分布的随机数转换为正态分布的随机数之后，将其加载到 CUDA 中。[比如这个问题。](https://stackoverflow.com/questions/75677/converting-a-uniform-distribution-to-a-normal-distribution)

随机图像中正确大小的区域应乘以噪声 sigma 并添加到源图像以接收结果。

上次我检查了 CUDA[没有](https://stackoverflow.com/questions/837955/random-number-generator-in-cuda)随机缓冲区生成解决方案，然而，那是几年前的事了。

更新：CUDA 现在有[cuRand](http://developer.nvidia.com/curand)，因此您应该能够生成随机数，而不是使用预先生成的随机缓冲区。

# matlab - 如何根据另一个 3D 矩阵中的索引置换 3D 矩阵中的每个堆栈？

> ID：10306802
> 
> 赞同：0
> 
> 时间：2012-04-24T22:13:43.440
> 
> 标签：matlab, matrix, permutation, octave

好的，假设我有一个 3D 矩阵 A 和另一个 3D 矩阵 Inds。我想做的是，对于每个 stack `A(i,j,:)`，根据给出的索引排列该堆栈`Inds(i,j,:)`。因此，如果`A(i,j,:)`是`[1.5 2.5 3.5]`且`Inds(i,j,:)`是，`[3 2 1]`则 A`(i,j,:)`变为`[3.5 2.5 1.5]`。

是的，我知道`A(i,j,:)`这不是 Octave 中的向量。考虑它的简写`permute(A, [1 3 2])(i,:,j)`。

这应该很简单，但无论出于何种原因，我似乎都找不到执行此操作的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:18:03.587

它的matlab非常简单：

```
A(i,j,:) = A(i,j,Inds(i,j,:)); 
```

在 Matlab 中，您可以使用索引向量重新排列任何向量：

```
A = [10 20 30 40 50 60];
B = [6 5 4 1 2 3];
A = A(B); 
```

`A`就是现在`[60 50 40 10 20 30]`

If `A`is `MxNxP`，当您使用`A(i,j,:)`符号时，您实际上是在处理`Px1`可以随意操作的向量。

# paypal - PayPal Payments Advanced + PayFlow 链接

> ID：10306806
> 
> 赞同：1
> 
> 时间：2012-04-24T22:14:19.383
> 
> 标签：paypal

尝试通过我的 PayFlow 网关提交沙盒付款时，我不断收到以下错误：

> 错误：处理您的请求时出现问题。请按浏览器的返回按钮，然后刷新页面。如果您仍有问题，请与我们联系。

我正在使用以下代码生成我的 PayFlow 网关，但我无法让它工作。

```
/* PayPal Payments Advanced */

$PF_USER        = 'my_user';
$PF_VENDOR  = 'my_vendor';
$PF_PARTNER     = 'PayPal';
$PF_PWD     = 'my_pass';
$PF_MODE        = 'TEST';
$PF_HOST_ADDR   = 'https://pilot-payflowpro.paypal.com'; // TEST mode
// $PF_HOST_ADDR = 'https://payflowpro.paypal.com' // LIVE mode

$secureTokenId  = uniqid('',true);
$postData       = "USER=".$PF_USER
                ."&VENDOR=".$PF_VENDOR
                ."&PARTNER=".$PF_PARTNER
                ."&PWD=".$PF_PWD

                ."&SECURETOKENID=".$secureTokenId
                ."&CREATESECURETOKEN=Y"
                ."&TRXTYPE=S"
                ."&AMT=1.00"

                ."&BILLTOFIRSTNAME=".$first_name
                ."&BILLTOLASTNAME=".$last_name
                ."&BILLTOSTREET=".$address
                ."&BILLTOCITY=".$city
                ."&BILLTOSTATE=".$state
                ."&BILLTOZIP=".$zip
                ."&BILLTOCOUNTRY=".$country

                ."&SHIPTOFIRSTNAME=".$first_name
                ."&SHIPTOLASTNAME=".$last_name
                ."&SHIPTOSTREET=".$address
                ."&SHIPTOCITY=".$city
                ."&SHIPTOSTATE=".$state
                ."&SHIPTOZIP=".$zip
                ."&SHIPTTOCOUNTRY=".$country

                ."&EMAIL=".$email
                ."&PHONENUM=".$phone;

/* Initialize and Setup Request */

$ch = curl_init();
curl_setopt($ch,CURLOPT_URL,$PF_HOST_ADDR);
curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);
curl_setopt($ch,CURLOPT_POST,true);

/* Ready the postData to send */

curl_setopt($ch,CURLOPT_POSTFIELDS,$postData);

/* Send the data to PayPal and assign response */

$resp = curl_exec($ch);

/* Confirm response and handle */

if(!$resp){
    $error = '<p>There was an error processing your order.</p>';    
}

/* Parse and assign to array */

parse_str($resp,$arr);

if($arr['RESULT'] != 0) {
    // handle error
    die($arr['RESULT']);
    $error = '<p>There was an error processing your order. '.$arr['RESULT'].'</p>';
}

echo '<iframe src="https://payflowlink.paypal.com?mode='.$PF_MODE.'&amp;SECURETOKEN='.$arr['SECURETOKEN'].'&amp;SECURETOKENID='.$secureTokenId.'" width="550" height="565" scrolling="no" frameborder="0" border="0" allowtransparency="true"></iframe>'; 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T23:21:48.283

我必须将我的 Firefox 隐私设置明确设置为“允许”第三方 cookie。这样做会使错误消息消失。我在 Safari 上没有这个问题。

# wpf - 实体框架 4 - 关联通知

> ID：10306812
> 
> 赞同：3
> 
> 时间：2012-04-24T22:14:55.843
> 
> 标签：wpf, entity-framework-4.1, inotifypropertychanged

我在使用 EF 4、外键和 INotifyPropertyChanged / 为标量属性公开的部分方法时遇到了一些困难。

我希望你能帮助我找到正确的方法来做到这一点。

图片 我有一个与 Country 实体有 *..1 关系的 Customer 实体。

现在，我显然希望能够做到：

```
var customer = new Customer();
customer.Country = [...] 
```

...但我不一定需要 CountryKey 属性。

我在 .edmx 设计器中使用正确的基数在 EF 中创建了一个关联。我选择不在对话框中“添加外键属性”。

这给我留下了一个没有部分 OnCountryChanging 和 OnCountryChanged 的​​生成类。

接下来，我尝试添加外键属性，现在我有了 OnCountryKeyChanging 和 OnCountryKeyChanged。

但是，生成的代码如下所示：

```
/// <summary>
/// No Metadata Documentation available.
/// </summary>
[EdmScalarPropertyAttribute(EntityKeyProperty=false, IsNullable=false)]
[DataMemberAttribute()]
public global::System.Int64 CountryKey
{
    get
    {
        return _CountryKey;
    }
    set
    {
        OnCountryKeyChanging(value);
        ReportPropertyChanging("CountryKey");
        _CountryKey = StructuralObject.SetValidValue(value);
        ReportPropertyChanged("CountryKey");
        OnCountryKeyChanged();
    }
}
private global::System.Int64 _CountryKey;
partial void OnCountryKeyChanging(global::System.Int64 value);
partial void OnCountryKeyChanged(); 
```

从生成的代码中可以看出，PropertyChanged 通知发生在“CountryKey”而不是“Country”中。这使得 WPF 中的数据绑定变得困难。

我的问题是：我该如何解决这个问题？

*   我是否将我的对象包装在 ViewModel 中，监听属性更改并剥离“Key”部分？
*   我要修改 T4 模板吗？
*   还是有第三种我还看不到的选项？

我非常感谢这里的任何建议，因为我正在试验 WPF / EF 而不将每个模型属性包装在 ViewModel 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T10:13:57.813

“最佳实践”方法是在视图模型中装饰您的模型，根据需要公开模型属性。你可以创建一个通用的 ViewModel，对动态对象进行一些漂亮的工作，也许使用属性映射等。

```
public class DynamicViewModel : DynamicObject, INotifyPropertyChanged, IDisposable
{
    public event PropertyChangedEventHandler PropertyChanged;

    private static readonly Dictionary<Type, Tuple<Dictionary<string, PropertyInfo>, Dictionary<string, string>>> typeDictionary = new Dictionary<Type, Tuple<Dictionary<string, PropertyInfo>, Dictionary<string, string>>>();

    private readonly Dictionary<string, object> additionalProperties = new Dictionary<string, object>();

    private readonly object underlyingObject;
    public object UnderlyingObject
    {
        get
        {
            return underlyingObject;
        }
    }

    private readonly Type type;

    /// <summary>
    /// constructor which takes a model for which it will be extensing its perceived properties
    /// </summary>
    /// <param name="underlyingObject">the underlying object</param>
    public DynamicViewModel(IBindableRfqViewModel underlyingObject) : this(underlyingObject, new Dictionary<string, string>())
    {

    }

    /// <summary>
    /// constructor which takes a model for which it will be extensing its perceived properties as well as a property map
    /// </summary>
    /// <param name="underlyingObject">the underlying object</param>
    /// <param name="propertyMap">a string/string dictionary, where the key is a property on the underlying object, and the value is the name of the dynamic property to be used as a binding target</param>
    public DynamicViewModel(IBindableRfqViewModel underlyingObject, Dictionary<string, string> propertyMap)
    {
        this.underlyingObject = underlyingObject;
        if (underlyingObject is INotifyPropertyChanged)
        {
            ((INotifyPropertyChanged)underlyingObject).PropertyChanged += OnUnderlyingPropertyChanged;
        }

        type = underlyingObject.GetType();
        if (typeDictionary.ContainsKey(type))
        {
            return;
        }
        lock (typeDictionary)
        {
            if (typeDictionary.ContainsKey(type))
            {
                return;
            }
            var forwardPropertyMap = propertyMap;
            var typeProperties = type.GetProperties(BindingFlags.Public | BindingFlags.Instance).ToDictionary(p => p.Name, p => p);
            typeDictionary.Add(type, Tuple.Create(typeProperties,forwardPropertyMap));
        }
    }

    private void OnUnderlyingPropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        this.OnPropertyChanged(e.PropertyName);
    }

    private bool TryGetProperty(string name, out object result)
    {
        try
        {
            var propertyData = typeDictionary[type];
            var modelProperty = name;
            if (propertyData.Item2.ContainsKey(name))
            {
                modelProperty = propertyData.Item2[name];
            }
            if (propertyData.Item1.ContainsKey(modelProperty))
            {
                result = propertyData.Item1[modelProperty].GetValue(underlyingObject, null);
                return true;
            }

            if (additionalProperties.ContainsKey(name))
            {
                result = additionalProperties[name];
                return true;
            }

            result = null;
            return true;
        }
        catch (Exception ex)
        {
            result = null;
            return false;
        }
    }

    /// <summary>
    /// <see cref="DynamicObject.TryGetMember" />
    /// </summary>
    public override bool TryGetMember(GetMemberBinder binder, out object result)
    {
        return this.TryGetProperty(binder.Name, out result);
    }

    /// <summary>
    /// <see cref="DynamicObject.TryGetIndex" />
    /// </summary>
    public override bool TryGetIndex(GetIndexBinder binder, object[] indexes, out object result)
    {
        return this.TryGetProperty(indexes[0].ToString(), out result);
    }

    private bool TrySetProperty(string name, object value)
    {
        try
        {
            var propertyData = typeDictionary[type];
            var modelProperty = name;
            if (propertyData.Item2.ContainsKey(name))
            {
                modelProperty = propertyData.Item2[name];
            }
            if (propertyData.Item1.ContainsKey(modelProperty))
            {
                propertyData.Item1[modelProperty].SetValue(underlyingObject, value, null);
            }
            else
            {
                if (!additionalProperties.ContainsKey(name))
                {
                    additionalProperties.Add(name, new object());
                }
                additionalProperties[name] = value;
            }

            this.OnPropertyChanged(name);
            return true;
        }
        catch (Exception ex)
        {
            return false;
        }

    }

    /// <summary>
    /// <see cref="DynamicObject.TrySetMember" />
    /// </summary>
    public override bool TrySetMember(SetMemberBinder binder, object value)
    {
        return this.TrySetProperty(binder.Name, value);
    }

    /// <summary>
    /// <see cref="DynamicObject.TrySetIndex" />
    /// </summary>
    public override bool TrySetIndex(SetIndexBinder binder, object[] indexes, object value)
    {
        return indexes.Length == 0 || this.TrySetProperty(indexes[0].ToString(), value);
    }

    private void OnPropertyChanged(string propName)
    {
        var handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(propName));
        }
    }

    /// <summary>
    /// IDisposable implementation
    /// </summary>
    public void Dispose()
    {
        if (underlyingObject is INotifyPropertyChanged)
        {
            ((INotifyPropertyChanged)underlyingObject).PropertyChanged -= OnUnderlyingPropertyChanged;
        }
        if (underlyingObject is IDisposable)
        {
            ((IDisposable)underlyingObject).Dispose();
        }
    }
} 
```

# .net - 在.net 部署上使用sharpdevelop 切换Web 引用的简单方法？

> ID：10306817
> 
> 赞同：0
> 
> 时间：2012-04-24T22:15:50.273
> 
> 标签：.net, deployment

我想知道是否有人知道将本地 Web 引用切换到生产引用的可能无 GUI 的方法。

我正在使用 SharpDevelop 进行开发。我看到的“接缝”是网络参考文件夹，但是我一直遇到问题，通过简单的复制和粘贴将它们换出。

我正在考虑使用 autoit 编写一个手动删除和添加网络引用的脚本，但我想在花时间之前先在这里问一下。

感谢您的任何提示，

丹麦人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T02:30:56.653

一种解决方案：

有一个反映部署文件夹结构的部署文件夹。

如果 Web 界面没有变化，那么包含 Web 服务项目的文件夹应该保持不变。

所以干脆把它放在那里。替换已更改的项目/文件夹。

在部署文件夹中加载解决方案文件，重建所有内容。

# video - 将视频文件流式传输到附近的 ATSC 调谐器需要什么程序？

> ID：10306819
> 
> 赞同：-2
> 
> 时间：2012-04-24T22:16:03.113
> 
> 标签：video, television, boxee, tv-tuner

我有一个带有 ATSC 调谐器的 Boxee Box，我想通过一个免费的本地频道流式传输到它，我会在家里设置托管。首先，对于那些不知道的人来说，ATSC 调谐器是一个小天线，可以接收周围的免费高清频道信号。我见过很多建立电视台的方法，但都是盗版模拟和非法的，没有一个是ATSC。我发现的最好的教程是这个：[http ://www.youtube.com/watch?v=aqstPGKvTO0](http://www.youtube.com/watch?v=aqstPGKvTO0)

我不知道我是否需要某个程序或发射器将 ATSC 信号发送到调谐器（以及该地区的其他调谐器），或者我是否使用小型接收器作为视频中的接收器。

请帮忙！>_<

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:53:27.720

尝试使用带有普通发射器的普通电视信号，也许它会接收。或者尝试使用 RED5 服务器进行流式传输。

# filesystems - 使用输出重定向时何时创建文件？

> ID：10306820
> 
> 赞同：2
> 
> 时间：2012-04-24T22:16:11.460
> 
> 标签：filesystems, ksh, aix, wc

我有一个在 AIX ksh 中运行的脚本，如下所示：

```
wc dir1/* dir2/* | {awk command to rearrange output} | {grep command to filter more} > dir2/output.txt 
```

此行的前提条件是 dir2/output.txt 不存在。

问题是 dir2/output.txt 已经包含在输出中（它在数百次中发生了几次，没有问题）。dir1 和 dir2 是 NFS 安装的。

是不是和`wc`--第一个参数的执行时间长有关系？我认为不是，因为我尝试了以下方法：

```
wc `sleep 5` *.txt > out.txt 
```

即使在这种情况下 out.txt 也不会列出自己。

最后一点，通配符在此示例中使用，它们在实际脚本中使用。那么如果扩容先发生，为什么会出现这个问题呢？

dir2/output.txt 是在什么时候实际创建的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T22:27:41.963

重定向由 shell 完成，glob 也是如此。您的问题是，对于管道，每个管道阶段都是一个单独的子流程；执行最终重定向的 shell 子进程是否在为其构建输入文件的 glob 之前运行`wc`将取决于调度程序和系统负载的详细信息等，并且应该被视为不确定的。

简而言之，您应该假设这会发生并且要么排除`dir2/output.txt`（看看`ksh`扩展的 glob 模式；特别是类似的东西`dir2/!(output.txt)`可能有用），要么在其他地方创建输出，`mv`然后将其放到最终位置。

# php - 如何只从这个类返回一个数组？

> ID：10306822
> 
> 赞同：1
> 
> 时间：2012-04-24T22:16:25.517
> 
> 标签：php, curl

我是一个前程序程序员，对对象不太了解。

我有以下课程（在 SO 上找到）

```
class MultiCurl
{
    private $allToDo;
    private $multiHandle;
    private $maxConcurrent = 20;
    private $currentIndex  = 0;
    private $info          = array();
    private $options       = array(CURLOPT_RETURNTRANSFER => true,
                                   CURLOPT_FOLLOWLOCATION => true,
                                   CURLOPT_MAXREDIRS      => 1,
                                   CURLOPT_TIMEOUT        => 3);

    public function __construct($todo, $concurrent)
    {
        $this->allToDo = $todo;
        $this->maxConcurrent = $concurrent;
        $this->multiHandle = curl_multi_init();
    }

    public function process()
    {
        $running = 0;
        do {
            $this->_addHandles(min(array($this->maxConcurrent - $running, $this->_moreToDo())));
            while ($exec = curl_multi_exec($this->multiHandle, $running) === -1) {
            }
            curl_multi_select($this->multiHandle);
            while ($multiInfo = curl_multi_info_read($this->multiHandle, $msgs)) {
                $this->_showData($multiInfo);
                curl_multi_remove_handle($this->multiHandle, $multiInfo['handle']);
                curl_close($multiInfo['handle']);
            }
        } while ($running || $this->_moreTodo());
        return $this;
    }    

    private function _addHandles($num)
    {
        while ($num-- > 0) {
            $handle = curl_init($this->allToDo[$this->currentIndex]);
            curl_setopt_array($handle, $this->options);
            curl_multi_add_handle($this->multiHandle, $handle);
            $this->info[$handle]['url'] = $this->allToDo[$this->currentIndex];
            $this->currentIndex++;
        }
    }        

    private function _moreToDo()
    {
        return count($this->allToDo) - $this->currentIndex;
    }

    private function _showData($multiInfo)
    {
       // $this->info[$multiInfo['handle']]['multi'] = $multiInfo;
        $this->info[$multiInfo['handle']]['curl']  = curl_getinfo($multiInfo['handle']);
        $this->info[$multiInfo['handle']]['content']  = curl_multi_getcontent($multiInfo['handle']);
        return $this->info[$multiInfo['handle']]; 
    }
} 
```

当我实际使用它时：

```
$concurrent = 20;
$mc = new MultiCurl($nodes, $concurrent);
$output = $mc->process();
print_r($output); 
```

我只是希望它输出所有响应的多维数组，所以只有“_showData”函数返回的内容。

目前它返回一堆其他的东西，比如：

```
[allToDo:MultiCurl:private] => Array
[multiHandle:MultiCurl:private] => Resource id #11
[maxConcurrent:MultiCurl:private] => 20
[currentIndex:MultiCurl:private] => 100
[info:MultiCurl:private] => Array 
```

我只需要“[info:MultiCurl:private]”数组的内容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:28:29.277

将公共方法添加到类“MultiCurl”。例如：

```
public function getInfo() {
  return $this->info;
} 
```

如果您不想编辑类文件，请扩展并使用它。

```
Class MultiCurlWrapper extends MultiCurl {
    public function getInfo() {
      return $this->info;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:28:34.900

在处理方法中，而不是

```
return $this; 
```

利用

```
return $this->info; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:28:48.320

当当前函数返回对象时，我会添加一个方法来获取您需要的内容。

以最简单的形式；

```
public function getInfo()
{
  return $this->info;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T22:20:42.850

~~会`print_r($output[info:MultiCurl:private]);`工作吗？~~

如果`$output`数组的键总是相同的，你能用

```
print_r($output[4]); 
```

# php - php foreach 循环冗余

> ID：10306824
> 
> 赞同：3
> 
> 时间：2012-04-24T22:16:34.023
> 
> 标签：php, function, redundancy

我正在学习如何使用 PHP。我将文件内容读入数组并为数组中的每个索引分配变量名。

例如：
`$words = file("example.txt"); #each line of the file will have the format a, b, c , d`

 ````
foreach ($words in $word) {  
$content = explode(",", $word); #split a, b, c, d  
list($a, $b, $c, $d) = $content;  
do something  
}  

/* And now I want to read file, split the sentence and loop over the array again, but
 the last statement will do something else different:   */
foreach ($words in $word) {  
$content = explode(",", $word); #split a, b, c, d  
list($a, $b, $c, $d) = $content;  
do something else different  
} 
```` 

`我能做些什么来减少这种冗余？如您所见，我无法创建函数，因为最后一条语句对数组做了不同的事情。但是读取文件，拆分句子，分配vars的过程是一样的`

 `谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:20:38.623

我假设你打算`foreach($words as $word)`用“as”而不是“in”来输入，但这与问题相比只是一件小事。

您当然可以通过存储`explode`调用结果来减少冗余：

```
$lines = Array();
foreach($words as $word) {
    list($a,$b,$c,$d) = $lines[] = explode(",",$word);
    // do something here
}

foreach($lines as $line) {
    list($a,$b,$c,$d) = $line;
    // do something else
} 
```

这样你就不必再`explode`排队了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T22:31:47.717

好吧，如果你只是打算使用 $a、$b、$c 和 $d，并且保持 $content 不变，只需再次列出 $content 来做一些不同的事情。

```
foreach ($words in $word) {  
  $content = explode(",", $word); #split a, b, c, d  

  list($a, $b, $c, $d) = $content;
  // do something, and when you're done:

  list($a, $b, $c, $d) = $content;
  // do something else different.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:42:29.213

有很多变化。棘手的部分是识别可以抽象出来的通用部分。有时，您试图使代码过于通用，从而使代码变得更糟。但这里有一个使用匿名函数的示例。

```
function foo($filename, $func) {
    $words = file($filename);
    foreach ($words as $word) {
        $content = explode(",", $word);
        call_user_func_array($func, $content);
    }
}

foo('people.txt', function($a, $b, $c, $d) {
    echo "$a\n";
});

foo('people.txt', function($a, $b, $c, $d) {
    echo $b + $c;
}); 
```

您可能还对array_map 、[array_walk](http://www.php.net/array_walk)和[array_reduce](http://www.php.net/array_map)[感兴趣](http://www.php.net/array_reduce)，尽管我个人不觉得它们通常比循环更好...... php 的 foreach 非常棒。`

# sql - Postgres：为 CAST 失败定义一个默认值？

> ID：10306830
> 
> 赞同：28
> 
> 时间：2012-04-24T22:17:02.283
> 
> 标签：sql, postgresql

是否可以定义一个在`CAST`操作失败时返回的默认值？

例如，这样：

```
SELECT CAST('foo' AS INTEGER) 
```

会返回默认值而不是抛出错误吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-24T23:32:38.067

[CAST](http://www.postgresql.org/docs/current/static/sql-expressions.html#SQL-SYNTAX-TYPE-CASTS)没有默认值：

> 类型转换指定从一种数据类型到另一种数据类型的转换。PostgreSQL 接受两种等效的类型转换语法：
> 
> ```
> CAST ( expression AS type )
> expression::type 
> ```

除了要转换的表达式和所需的目标类型之外，语法中没有任何空间。

但是，您可以使用一个简单的函数手动完成：

```
create or replace function cast_to_int(text, integer) returns integer as $$
begin
    return cast($1 as integer);
exception
    when invalid_text_representation then
        return $2;
end;
$$ language plpgsql immutable; 
```

然后你可以说`cast_to_int('pancakes', 0)`和 get之类的东西`0`。

PostgreSQL 还允许您[创建自己的演员表](http://www.postgresql.org/docs/current/interactive/sql-createcast.html)，以便您可以执行以下操作：

```
create or replace function cast_to_int(text) returns integer as $$
begin
    -- Note the double casting to avoid infinite recursion.
    return cast($1::varchar as integer);
exception
    when invalid_text_representation then
        return 0;
end;
$$ language plpgsql immutable;

create cast (text as integer) with function cast_to_int(text); 
```

那你可以说

```
select cast('pancakes'::text as integer) 
```

得到`0`或者你可以说

```
select cast(some_text_column as integer) from t 
```

并获取不是有效整数`0`的值。`some_text_column`如果您想`varchar`使用此自动默认转换来转换 s ，那么您必须双重转换：

```
select cast(some_varchar::text as integer) from t 
```

仅仅因为你能做到这一点并不意味着它是一个好主意。我不认为将标准文本替换为整数转换是有史以来最好的主意。上述方法还要求您将标准单独`varchar`进行`integer`转换，如果您想自己进行整个转换而不是懒惰地使用内置转换，您可以绕过这个问题。

NULL 处理留给读者作为一个（简单的）练习。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T22:53:35.523

按照文档中的描述捕获错误，然后指定要执行的操作。

[下面包含有关 PostgreSQL](http://www.postgresql.org/docs/8.0/static/plpgsql-control-structures.html) Snippet 错误捕获的文档。

35.7.5。捕获错误

默认情况下，PL/pgSQL 函数中发生的任何错误都会中止函数的执行，实际上也中止周围事务的执行。您可以使用带有 EXCEPTION 子句的 BEGIN 块捕获错误并从中恢复。该语法是 BEGIN 块的正常语法的扩展：

```
[ <<label>> ]
[ DECLARE
    declarations ]
BEGIN
    statements
EXCEPTION
    WHEN condition [ OR condition ... ] THEN
        handler_statements
    [ WHEN condition [ OR condition ... ] THEN
          handler_statements
      ... ]
END; 
```

如果没有发生错误，这种形式的块简单地执行所有语句，然后控制传递到 END 之后的下一条语句。但是，如果语句中发生错误，则放弃对语句的进一步处理，并将控制传递给 EXCEPTION 列表。在列表中搜索与发生的错误匹配的第一个条件。如果找到匹配项，则执行相应的 handler_statements，然后控制权传递到 END 之后的下一条语句。如果没有找到匹配项，错误就会传播出去，就好像 EXCEPTION 子句根本不存在一样：错误可以被带有 EXCEPTION 的封闭块捕获，或者如果没有，则中止函数的处理。

# r - 如何在 ggplot2 中绘制通过 fastshp 加载的 shapefile？

> ID：10306831
> 
> 赞同：4
> 
> 时间：2012-04-24T22:17:03.360
> 
> 标签：r, ggplot2, shapefile

我偶然发现了[fastshp库，根据描述（以及我的快速粗略测试），与](http://www.rforge.net/fastshp/index.html)[其他三种方法](http://www.nceas.ucsb.edu/scicomp/usecases/ReadWriteESRIShapeFiles)相比，它确实提供了读取大型 shapefile 的时间。

我正在使用`read.shp`函数从 maptools 包中加载示例数据集：

```
library("maptools")

setwd(system.file("shapes", package="maptools"))

shp <- read.shp("columbus.shp", format="polygon") 
```

我选择了“多边形”格式，因为根据[文档](http://www.rforge.net/doc/packages/fastshp/html/read.shp.html)：

> 这通常是绘图的首选格式。

我的问题是如何使用 ggplot2 包绘制这些多边形？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T00:27:55.473

由于`read.shp`在`fastshp`包中以列表列表的形式返回多边形数据，因此只需将其减少为绘图所需的单个数据框`ggplot2`。

```
library(fastshp)
library(ggplot2)

setwd(system.file("shapes", package="maptools"))

shp <- read.shp("columbus.shp", format="polygon")
shp.list <- sapply(shp, FUN = function(x) do.call(cbind, x[c("id","x","y")]))
shp.df <- as.data.frame(do.call(rbind, shp.list))
shp.gg <- ggplot(shp.df, aes(x = x, y=y, group = id))+geom_polygon() 
```

编辑：基于@otsaw 关于多边形孔的评论，以下解决方案需要更多步骤，但确保最后绘制孔。它利用 shp.df$hole 是合乎逻辑的，并且带有 hole==TRUE 的多边形将最后绘制。

```
shp.list <- sapply(shp, FUN = function(x) Polygon(cbind(lon = x$x, lat = x$y)))
shp.poly <- Polygons(shp.list, "area")
shp.df <- fortify(shp.poly, region = "area")
shp.gg <- ggplot(shp.df, aes(x = long, y=lat, group = piece, order = hole))+geom_polygon() 
```

# django - action="/i18n/setlang/" 不会重定向到任何页面

> ID：10306836
> 
> 赞同：0
> 
> 时间：2012-04-24T22:17:28.587
> 
> 标签：django, google-app-engine, internationalization, django-views

我已经按照 django 文档 [1] 在“hello word”类型的谷歌应用引擎网站上实现 i18n。

不幸的是，在阅读了几十个 html 页面、django 和 appengine 文档后，我无法弄清楚发生了什么：

*   将语言代码更改为 django_settings.py 确实更改页面的语言并使用当前语言更新下拉列表（即 LANGUAGE_CODE = 'fr' 或 'es' 或 'en'）
*   更改下拉菜单并单击“更改语言”确实会导致“错误 404”并且 URL 显示 http:///i18n/setlang/

我在哪里可以找到应用引擎默认使用的 django 中间件列表？这可能有助于我深入挖掘。

技术要求（我们不打算在 i18n 工作之前升级 :-)：

*   蟒蛇2.5.4
*   谷歌应用引擎 1.6.2
*   姜戈 1.2

[1] [https://docs.djangoproject.com/en/1.2/topics/i18n/]

[2] [cssjanus.googlecode.com] 一段代码，正是我想做的事情。但我错过了一个小技巧

index.html 包含这个

```
<form action="/i18n/setlang/" method="post">
    <input name="next" type="hidden" value="/MainPage">
    <select name="language">
        {% for lang in LANGUAGES %} <option value="{{ lang.0 }}"
            {% ifequal LANGUAGE_CODE lang.0 %}
            selected="selected"
            {% endifequal %}>{{ lang.1 }}</option>
        {% endfor %}
    </select>
    <input type="submit" value="{% trans "Change Language" %}">
</form> 
```

应用程序.yaml：

```
application: i18n
version: 1
runtime: python
api_version: 1

handlers:

- url: .*
  script: helloworld.py` 
```

django_seetings.py

```
import os

DEBUG = True
TEMPLATE_DEBUG = DEBUG

LANGUAGE_CODE = 'fr'
USE_I18N = True

gettext = lambda s: s
LANGUAGES = (
  ('en', gettext('English')),
  ('fr', gettext('French')),
  ('es', gettext('Spanish')),
)

INSTALLED_APPS = (
  'django.contrib.auth',
  'django.contrib.contenttypes',
  'django.contrib.sessions', 
)
SESSION_ENGINE = 'gae_sessions' 
```

helloworld.py（我不使用 urls.py）

```
# coding=UTF-8

# Standard Python imports.
import os
import sys
import logging
import __builtin__

# Google App Hosting imports.
from google.appengine.dist import use_library
use_library('django', '1.2')

# Enable info logging by the app (this is separate from appserver's
# logging).
logging.getLogger().setLevel(logging.INFO)

# Must set this env var *before* importing any part of Django.
os.environ['DJANGO_SETTINGS_MODULE'] = 'django_settings'

from google.appengine.ext.webapp import util 
# Import the part of Django that we use here.

from google.appengine.ext import webapp

from views import MainPage

from django.conf.urls.defaults import include

def main():
    # Create a Django application for WSGI
    application = webapp.WSGIApplication([('/', MainPage),                                        
                                    (r'^i18n/', include('django.conf.urls.i18n')),
                                     ], debug=True)

    # Run the WSGI CGI handler with that application.
    util.run_wsgi_app(application)

if __name__ == '__main__':
    main() 
```

视图.py

```
'''
Created on Apr 24, 2012

@author:xxxx
'''
import os
from google.appengine.ext import webapp
from google.appengine.ext.webapp import template
from django.utils.translation import ugettext #ok

from django import http
from django.http import HttpResponseRedirect
import django_settings  
from django.utils.translation import check_for_language
#from django.shortcuts import render_to_response

#def MainPage(request):

class MainPage(webapp.RequestHandler):
    def get(self):
        template_values = {
            'helloworld': ugettext("helloworld!"),
            'title': ugettext("home page"),
        }

        path = os.path.join(os.path.dirname(__file__), 'index.html')
        self.response.out.write(template.render(path, template_values))
        #return render_to_response('index.html', template_values) 
```

你好世界.py

```
# coding=UTF-8

# Standard Python imports.
import os
import sys
import logging
import __builtin__

# Google App Hosting imports.
from google.appengine.dist import use_library
use_library('django', '1.2')

# Enable info logging by the app (this is separate from appserver's
# logging).
logging.getLogger().setLevel(logging.INFO)

# Must set this env var *before* importing any part of Django.
os.environ['DJANGO_SETTINGS_MODULE'] = 'django_settings'

from google.appengine.ext.webapp import util 
 # Import the part of Django that we use here.

from google.appengine.ext import webapp

from views import MainPage

from django.conf.urls.defaults import include

def main():
    # Create a Django application for WSGI
    application = webapp.WSGIApplication([('/', MainPage),                                        
                                        (r'^i18n/', include('django.conf.urls.i18n')),
                                         ], debug=True)

    # Run the WSGI CGI handler with that application.
    util.run_wsgi_app(application)

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T08:34:41.190

似乎您将 django 路由与 webapp 的路由混淆了。我不认为你可以像`include('django.conf.urls.i18n')`在初始化过程中那样使用语句`webapp.WSGIApplication`。

此外，正如 greg 所说，我还建议使用 Python2.7 运行时，因为在新的运行时中使用 django（相信我，这非常容易）对您来说要容易得多。

*更新：添加了使用 Python2.7 运行时运行 django-1.3 的过程*

这是使 django 与 python2.7 运行时一起工作的粗略过程。

**创建项目**

```
$ env PYTHONPATH=/somewhere/google_appengine/lib/django_1_3 \
   python /somewhere/google_appengine/lib/django_1_3/django/bin/django-admin.py\
   startproject my_django_project
$ cd my_django_project 
```

您可以通过在 app.yaml 中配置 env_variables 将 settings.py 用于 django 设置文件。

**创建一个 app.yaml**

```
application: tmatsuo-hr
version: 1
runtime: python27
api_version: 1
threadsafe: true

env_variables:
  DJANGO_SETTINGS_MODULE: 'settings'

handlers:
- url: /.*                                                                                                                                                     
  script: main.app                                                                                                                                             

libraries:                                                                                                                                                     
- name: django                                                                                                                                                 
  version: 1.3 
```

**创建你的 Django 应用**

```
$ env PYTHONPATH=/somewhere/google_appengine/lib/django_1_3 \
   python manage.py startapp myapp 
```

**创建你的 main.py**

```
import django.core.handlers.wsgi

app = django.core.handlers.wsgi.WSGIHandler() 
```

**配置你的 settings.py**

```
ROOT_URLCONF = 'urls'
Add 'myapp' to your INSTALLED_APPS 
```

**配置 urls.py**

```
url(r'^$', 'myapp.views.index', name='index'), 
```

**在 myapp/views.py 创建您的视图**

```
# Create your views here.

from django.http import HttpResponse

def index(request):
    return HttpResponse('Hello World!') 
```

**完毕。您应该能够以与通常的 django 应用程序相同的方式配置此项目。**

但是，您不能使用 Django 的模型，因为它需要 SQL 后端。如果您想这样做，请检查 django-nonrel，或考虑将 django 与 CloudSQL 一起使用。

# semantics - 芝麻和阿里巴巴是什么关系？

> ID：10306848
> 
> 赞同：1
> 
> 时间：2012-04-24T22:18:47.870
> 
> 标签：semantics, semantic-web, federated

我是这方面的初学者，我很难理解这一点。

什么是阿里巴巴和芝麻？

在上面的两个中，哪一个做查询优化，哪一个做创建存储库的部分。

任何类型的输入都可以。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T08:28:14.753

> “阿里巴巴是一个面向 RESTful 主题的客户端/服务器库，用于使用 RDF 元数据对文件和数据进行分布式持久性。阿里巴巴是下一代 Elmo 代码库的 beta 版本。它是一个模块集合，提供简化的 RDF 存储抽象以加速开发并促进应用程序维护。”

*   [http://www.openrdf.org/alibaba.jsp](http://www.openrdf.org/alibaba.jsp)

> “Sesame 是处理 RDF 数据的事实上的标准框架。这包括解析、存储、推理和查询这些数据。它提供了一个易于使用的 API，可以连接到所有领先的 RDF 存储解决方案。”

*   [http://www.openrdf.org/about.jsp](http://www.openrdf.org/about.jsp)

我想查询引擎、查询优化和存储是芝麻的一部分，而不是阿里巴巴。阿里巴巴是位于芝麻之上的应用程序代码。

Java 中也有替代方案，例如 Apache Jena：

*   [http://incubator.apache.org/jena/](http://incubator.apache.org/jena/)

你猜我用什么？;-)

# spring - 数字范围的 Spring JSP 选择列表

> ID：10306849
> 
> 赞同：2
> 
> 时间：2012-04-24T22:18:52.160
> 
> 标签：spring, jsp, select

我正在创建一个时间输入系统，用户可以通过两个单独的下拉选择框选择小时和分钟。所以小时框有数字**1-12**，分钟框有**00-59**。

这是 Spring 2.5 Java EE 项目的一部分。

例如，我在我的 JSP 中有这个，用于创建选项值作为选择下拉列表的一部分：

```
<% for( int i=1; i<=12; i++) { %>
<option value="<%=i %>" <%= Integer.parseInt(time1fromHr)==i?selected:"" %> />
<% } %> 
```

for 循环生成所有小时并将当前选定的小时标记为默认值。嗯，对我来说它看起来很丑，主要是因为这里涉及到相当多的 Java 代码，我想知道是否有更优雅的解决方案来使用 JSP 标记或 Spring 库来解决这个问题。我通过 Spring 中的 ModelAndView 对象传入当前设置的参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:38:42.937

在您的模型中，您可以将一个整数列表传递几个小时，另一个传递几分钟。然后你可以使用 form:select 标签。

```
<form:select path="hour">
  <form:options items="${hours} />
</form:select> 
```

If your command object for the form has the selected value set in the "hour" value, and the model contains 1-12 in the "hours" value, then it should render the select and take care of marking the appropriate option selected. 然后你做同样的几分钟。

如果您不想采用 spring form taglib 方向，您可以再次将小时放在模型中并使用 JSTL。就像是：

```
<c:forEach var="hour" items="${hours}">
  <c:if test="${hour} == ${selectedHour}">
    <option value="${hour}" selected="selected">${hour}</option>
  </c:if>
  <c:if test="${hour} != ${selectedHour}">
    <option value="${hour}" >${hour}</option>
  </c:if>
</c:forEach> 
```

我知道有一个更好的方法来做 c:if 部分，也许使用 ac:choose，但你明白了要点。您在 selectedHour 中有您选择的值，在模型中有您选择的小时数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T22:34:31.343

是的，Spring MVC 的这一部分：

```
 @RequestMapping(value="/index.html",method=RequestMethod.GET)
    public String form(ModelMap map) {
        Map<String,String> country = new LinkedHashMap<String,String>();
    country.put("US", "United Stated");
    country.put("CHINA", "China");
    country.put("SG", "Singapore");
    country.put("MY", "Malaysia");
    map.addAttribute("countryList", country);
        return "index";
} 
```

然后使用：

```
<form:select path="country" items="${countryList}" /> 
```

不要忘记将 Spring 类型库添加到您的页面：

```
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-18T08:00:52.697

使用 JSTL 进行比较

```
<c:forEach var="hour" items="${hours}">
  <c:if test="${hour == selectedHour}">
    <option value="${hour}" selected="selected">${hour}</option>
  </c:if>
  <c:if test="${hour != selectedHour}">
    <option value="${hour}" >${hour}</option>
  </c:if>
</c:forEach>

OR 

<c:forEach var="hour" items="${hours}">
  <c:if test="${hour eq selectedHour}">
    <option value="${hour}" selected="selected">${hour}</option>
  </c:if>
  <c:if test="${hour ne selectedHour}">
    <option value="${hour}" >${hour}</option>
  </c:if>
</c:forEach> 
```

# python - 基于 Python 中的策略实现深度优先遍历

> ID：10306850
> 
> 赞同：1
> 
> 时间：2012-04-24T22:18:58.290
> 
> 标签：python, algorithm, graph, depth-first-search

再会。

我在实现基于策略的深度优先搜索时遇到问题，该策略在 strategy.py 类中定义。还有一个图和一个遍历类。遍历类负责很好地遍历图。

策略类如下：

```
class Strategy:

init_priority = 0

def __init__(self, init_pri = 0):
    self.init_priority = init_pri

def init(self, graph, node):
    """Called at beginning of traversal process.  Expected that
    this will carry out any necessary initialisation for the
    specific traversal process
    """
    pass

def visit(self, node, pri):
    """Called whenever NODE is visited by a traversal process.
    PRI is the priority associated with the node in the priority
    queue used by the traversal process.
    """
    pass

def complete(self, node):
    """Called at the end of all the processing performed in visiting NODE.
    """
    pass

def discover(self, nbr, node, weight, pri):
    """Return the priority that should be associated with NBR when it is 
    added to the priority queue.

    Called whenever NBR is discovered for the first time.  NODE
    is the node from which the neighbour was discovered, and
    WEIGHT is the value on the edge from NODE to NBR.  PRI is the
    value associated with NODE in the priority queue, at the time
    of discovering NBR.
    """

def rediscover(self, nbr, node, weight, pri):
    """Return the priority that should be associated with NBR when it is 
    added to the priority queue.

    Called whenever NBR is rediscovered.  NODE is the node from
    which the neighbour is rediscovered, and WEIGHT is the value
    associated with the edge from NODE to NBR.  PRI is the
    priority of NODE in the priority queue.  It is provided in
    case it is relevant to the traversal strategy (e.g. for Dijkstra's)
    """
    pass

def getResult(self):
    """Called at the end of the traversal process.  It should
    return whatever is relevant or appropriate for the type of
    traversal implemented by this strategy.
    """
    pass 
```

我设法实现了广度优先搜索，如下所示：

```
class BreadthFirst(Strategy):

sequence = None             # the sequence in which nodes are visted
treeEdges = None            # the edges used to visit the nodes traversed
root = -1                   # the origin of the traversal
last_pri = -1               # the most recent priority used

def __init__(self):
    """The BreadthFirst strategy uses an initial priority of 0"""
    Strategy(0)

def init(self, graph, node):
    """We reset all our state information so that old traversals do not
    affect the one that is about to start."""

    self.last_pri = self.init_priority
    self.treeEdges = []
    self.sequence = []
    self.root = -1

def visit(self, node, src, pri):
    """Breadth first traversal pays no attention to weights."""
    self.sequence.append(node)
    if src == -1:
        self.root = node
    else:
        self.treeEdges.append((src, node))

def complete(self, node):
    pass

def discover(self, nbr, node, pri):
    """Want FIFO behaviour so increment priority (ignore weights)"""
    self.last_pri += 1
    return self.last_pri

def rediscover(self, nbr, node, pri):
    """Rules for rediscovery same as for discovery (because weights are
    ignored)"""
    self.last_pri += 1
    return self.last_pri

def getResult(self):
    """Return the details of the traversal as a dictionary."""
    return {"origin":self.root, 
            "tree":self.treeEdges, 
            "sequence":self.sequence} 
```

不过，深度优先给我带来了麻烦。这是我到目前为止所拥有的：

```
class DepthFirst(Strategy):

forward = None             # the forward sequence in which nodes are visted
back = None                # the backward sequence in which nodes are visited
treeEdges = None           # the edges used to visit the nodes traversed              
cross = None
root = -1                   # the origin of the traversal
last_pri = -1               # the most recent priority used

def __init__(self):
    """The DepthFirst strategy uses an initial priority of 0"""
    Strategy(0)

def init(self, graph, node):
    """Called at beginning of traversal process.  Expected that
    this will carry out any necessary initialisation for the
    specific traversal process
    """
    self.last_pri = self.init_priority
    self.treeEdges = []
    self.forward = []
    self.back = []
    self.cross = []

def visit(self, node, src, pri):
    """Called whenever NODE is visited by a traversal process.
    PRI is the priority associated with the node in the priority
    queue used by the traversal process.
    """
    self.forward.append(node)
    if src == -1:
        self.root = node
    else:
        self.treeEdges.append((src, node))

def complete(self, node):
    """Called at the end of all the processing performed in visiting NODE.
    """
    if node not in self.forward:
        self.cross.append(node)

def discover(self, nbr, node, pri):
    """Return the priority that should be associated with NBR when it is 
    added to the priority queue.

    Called whenever NBR is discovered for the first time.  NODE
    is the node from which the neighbour was discovered, and
    WEIGHT is the value on the edge from NODE to NBR.  PRI is the
    value associated with NODE in the priority queue, at the time
    of discovering NBR.
    """
    self.forward.append((node, nbr))
    self.last_pri -= 1
    return self.last_pri

def rediscover(self, nbr, node, pri):
    """Return the priority that should be associated with NBR when it is 
    added to the priority queue.

    Called whenever NBR is rediscovered.  NODE is the node from
    which the neighbour is rediscovered, and WEIGHT is the value
    associated with the edge from NODE to NBR.  PRI is the
    priority of NODE in the priority queue.  It is provided in
    case it is relevant to the traversal strategy (e.g. for Dijkstra's)
    """
    self.back.append((nbr, node))
    self.last_pri -= 1
    return self.last_pri

def getResult(self):
    """Called at the end of the traversal process.  It should
    return whatever is relevant or appropriate for the type of
    traversal implemented by this strategy.
    """
    return {"tree":self.treeEdges,
            "forward":self.forward,
            "back":self.back,
            "cross":self.cross} 
```

任何提示，指针？他们将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:25:59.270

如果你只是写这两个，你会做通常的迭代循环，使用 DFS 的堆栈和 BFS 的队列。在这里，您正在统一具有优先级队列的那些。所以你需要确定优先级，以便这两种行为出现。对于 DFS，这意味着每次添加某些内容时，它的优先级都比以前更高（因此它会在已经存在的内容之前出现） - 增加正数就可以了。对于 BFS，它需要低于您迄今为止添加的任何内容（因此它会在已经存在的内容之后出现） - 减少负数效果很好。

这只是我扫描您的代码的结果。我可能是错的，我不会详细查看 - 我只是认为这是一种有趣的方式来看待可能有帮助的事情。

ps 用“homework”标记作业是正常的。如果你不这样做，人们会婊子。

# python - scrapy 新手：教程。运行scrapy crawl dmoz时出错

> ID：10306851
> 
> 赞同：3
> 
> 时间：2012-04-24T22:18:58.570
> 
> 标签：python, scrapy

我已经设置了我的 PATH 变量，并且我认为我正在正确配置一切。但是当我在我的 startproject 文件夹中运行“scrapy crawl dmoz”时，我收到以下错误消息：

```
c:\matt\testing\dmoz>scrapy crawl dmoz
2012-04-24 18:12:56-0400 [scrapy] INFO: Scrapy 0.14.0.2841 started (bot: dmoz)
2012-04-24 18:12:56-0400 [scrapy] DEBUG: Enabled extensions: LogStats, TelnetConsole,         
CloseSpider, WebService, CoreStats, SpiderState
2012-04-24 18:12:56-0400 [scrapy] DEBUG: Enabled downloader middlewares:    
HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware,
faultHeadersMiddleware, RedirectMiddleware, CookiesMiddleware,   
HttpCompressionMiddleware, ChunkedTransferMiddleware, DownloaderStats
2012-04-24 18:12:56-0400 [scrapy] DEBUG: Enabled spider middlewares:   
HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware,  DepthMiddware
2012-04-24 18:12:56-0400 [scrapy] DEBUG: Enabled item pipelines:
Traceback (most recent call last):
File "c:\Python27\Scripts\scrapy", line 4, in <module>
execute()
File "c:\Python27\lib\site-packages\scrapy-0.14.0.2841-py2.7- 
win32.egg\scrapy\cmdline.py", line 132, in execute
_run_print_help(parser, _run_command, cmd, args, opts)
File "c:\Python27\lib\site-packages\scrapy-0.14.0.2841-py2.7-
win32.egg\scrapy\cmdline.py", line 97, in _run_print_help
func(*a, **kw)
File "c:\Python27\lib\site-packages\scrapy-0.14.0.2841-py2.7-
win32.egg\scrapy\cmdline.py", line 139, in _run_command
cmd.run(args, opts)
File "c:\Python27\lib\site-packages\scrapy-0.14.0.2841-py2.7-
win32.egg\scrapy\commands\crawl.py", line 43, in run
spider = self.crawler.spiders.create(spname, **opts.spargs)
File "c:\Python27\lib\site-packages\scrapy-0.14.0.2841-py2.7-  
win32.egg\scrapy\spidermanager.py", line 43, in create
raise KeyError("Spider not found: %s" % spider_name)
KeyError: 'Spider not found: dmoz' 
```

有谁知道可能会发生什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-23T17:09:30.160

我也有这个问题。

这是因为 scrapy 教程要求您放置您创建的蜘蛛，`/dmoz/spiders/`但 scrapy 正在查找`tutorial/tutorial/spiders`。

保存`dmoz_spider.py`进去`tutorial/tutorial/spiders`，爬行应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T09:08:14.320

在命令行中尝试

```
C:\Users\Akhtar Wahab> python # any any directory path 
```

如果有效

尝试

```
scrapy version 
```

如果它也有效

然后确保你制作了scrapy项目

```
scrapy startproject name 
```

如果以上一切对你来说都是积极的

然后确保您在存在的目录中运行刮板命令`scrapy.cfg`。

# .net - C++ 面板 DrawToBitmap 无法正常工作

> ID：10306852
> 
> 赞同：0
> 
> 时间：2012-04-24T22:19:05.287
> 
> 标签：.net, winforms, c++-cli

我正在尝试使用 DrawToBitmap 将面板（panel1）保存为图像，并且我已经能够做到。问题是，panel1 在另一个面板中，panel1 Location*不*等于 0, 0。因此，当图像被捕获时，由于某种原因它不会在 panel1 的左上角捕获，而是在它的 Location(0, 0)父母。这是我的代码。

```
Bitmap^ bmp = gcnew Bitmap(panel1->Width, panel1->Height);
panel1->DrawToBitmap(bmp, panel1->Bounds);
bmp->Save("Capture.bmp");
delete bmp; 
```

它使用 panel1 的宽度和高度进行捕获，但这会切断面板的右下角。提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:43:03.263

使用`panel1->ClientRectangle`代替`panel1->Bounds`, 和`panel1->ClientSize`而不是`panel1->Width`and `panel1->Height`。

此外，除非必须，否则不要使用`gcnew`- 您的代码原样不是异常安全的。改用 RAII，就像普通的 C++ 一样：

```
Bitmap bmp(panel1->ClientSize.Width, panel1->ClientSize.Height);
panel1->DrawToBitmap(%bmp, panel1->ClientRectangle);
bmp.Save("Capture.bmp"); 
```

# css - css 子 (>) 选择器在 IE8 中不起作用？

> ID：10306853
> 
> 赞同：7
> 
> 时间：2012-04-24T22:19:08.337
> 
> 标签：css, internet-explorer, internet-explorer-8, css-selectors

根据我在这里和那里收集和理解的内容（当我错了时阻止我）：只要您使用您的文档类型触发标准模式，子选择器（>）就可以在 IE7+ 上工作，html5`<!DOCTYPE html>`应该这样做。

不过，我的CSS：

```
nav > ul > li > a
{
    padding: 0.2em 2em 0.2em 2em;
    background-color: #FAFAFA;
}
nav > ul > li > a:hover
{
    background-color: #AFAFAF;
} 
```

似乎没有到达我的html：

```
<!DOCTYPE html>
...
<body>
<header>
    <nav>
        <a class="inblock valignC logo" href="/"><img src="static/img/logo.gif" /></a>
        <!--Menu nav : LOGO | Agence | Portfolio | Equipe | Clients | Contact-->
        <ul class="inblock valignC">
            <li class="inline"><a class="ie" href="/agence/">Agence</a></li>
        ...
        </ul>
... 
```

在 IE8 中，我必须使用我在 targetted 上添加的专用 .ie 类`<a>`。

有什么解释吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-24T22:24:13.497

9 以下的 IE 版本需要使用[HTML5 Shiv ：](https://github.com/aFarkas/html5shiv)

```
<!--[if lt IE 9]>
<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
<![endif]--> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T22:23:22.537

可能不是选择器，而是标签本身，因为它们在 IE8 及以下版本中没有定义为标准标签。`ul > li`您可以通过使用并查看选择器是否工作来查看是否是这种情况。

除了在更多人升级他们的浏览器之前不使用 HTML5 标记之外，您真的无能为力。就个人而言，我现在宁愿使用`<div class="nav">`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T22:21:44.123

我认为这是因为旧版浏览器没有导航元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-26T16:04:40.540

它不起作用，因为 IE8 不理解或“正确”实现 HTML 标签，例如`<nav>`.

在 2015 年之前不要使用 HTML 5。这有两个原因：

1.  W3C 对 HTML5 的建议直到 2014 年 12 月才最终确定，因此任何当前的浏览器实现都在猜测最终确定的文档将包含什么内容。现在可以工作的代码不能保证在那之后可以工作（但可能会）。在顶部添加 JS hack，以使浏览器兼容 HTML5，增加了更多潜在的前向兼容性问题。

2.  到 2015 年，IE8 的市场份额可能会处于最低水平，例如低于 2-3%，此时支持 IE8 的好处将被不使用 HTML5 兼容代码的成本所抵消。

同时，使用 HTML5 文档类型是一个好主意，因为它向前和向后兼容，并使用在 HTML4 中也有效的 HTML5 标签子集（换句话说，在 HTML4 和 HTML5 中有效的标签，是他们中的大多数）。就个人而言，我喜欢使用`<div class="nav"></div>`而不是`<nav></nav>`etc 等。

归根结底，做你想做的事，但你至少需要意识到这些问题，尤其是在 HTML5 是一个经常被不恰当地使用的流行词的世界里。

# haskell - 切换到字节串

> ID：10306854
> 
> 赞同：0
> 
> 时间：2012-04-24T22:19:08.663
> 
> 标签：haskell, bytestring

编辑：我听从了 Yuras 和 Dave4420 的建议（谢谢）。我仍然有一些错误。更新了问题。最后我将使用meiersi的版本（谢谢）但我仍然想找到我的错误......

我有一个简单的脚本，如下所示：

```
import System.Environment

getRow :: Int -> String -> String
getRow n = (!!n) . lines

getField :: Int -> String -> String
getField n = (!!n) . words'

words' :: String -> [String]
words' str = case str of
                        [] -> []
                        _ -> (takeHead " ; " str) : (words' (takeTail " ; " str))

takeHead :: String -> String -> String
takeHead st1 st2 = case st2 of
                                [] -> []
                                _ -> if st1 == (nHead (length st1) st2) then [] else (head st2):(takeHead st1 (tail st2))

takeTail :: String -> String -> String
takeTail st1 st2 = case st2 of
                                [] -> []
                                _ -> if st1 == (nHead (length st1) st2) then nTail (length st1) st2 else takeTail st1 (tail st2)

nTail :: Int -> String -> String
nTail n str = let rec n str = if n == 0 then str else rec (n - 1) (tail str)
              in if (length str) < n then str else rec n str

nHead :: Int -> String -> String
nHead n str = let rec n str = if n == 0 then [] else (head str):(rec (n - 1) (tail str))
              in if (length str) < n then str else rec n str

getValue :: String -> String -> String -> String
getValue row field src = getField (read field) $ getRow (read row) src

main :: IO ()
main = do
    args <- getArgs
    case args of
        (path: opt1: opt2: _) -> do
            src <- readFile path
            putStrLn $ getValue opt1 opt2 src
        (path: _) -> do
            src <- readFile path
            putStrLn $ show $ length $ lines src 
```

它编译并工作。然后我想切换到`ByteString`s。这是我的尝试：

```
import qualified Data.ByteString.Lazy as B
import qualified Data.ByteString.Lazy.Char8 as Bc (cons, empty,unpack)
import qualified Data.ByteString.Lazy.UTF8 as Bu (lines)
import qualified System.Posix.Env.ByteString as Bg (getArgs)

separator :: B.ByteString
separator = (Bc.cons ' ' (Bc.cons ';' (Bc.cons ' ' Bc.empty)))

getRow :: Int -> B.ByteString -> B.ByteString
getRow n = (`B.index` n) $ Bu.lines

getCol :: Int -> B.ByteString -> B.ByteString
getCol n = (`B.index` n) $ wordsWithSeparator

wordsWithSeparator :: B.ByteString -> [B.ByteString]
wordsWithSeparator str = if B.null str then [] else (takeHead separator str):(wordsWithSeparator (takeTail separator str))

takeHead :: B.ByteString -> B.ByteString -> B.ByteString
takeHead st1 st2 = if B.null st2 then B.empty else if st1 == (nHead (toInteger (B.length st1)) st2) then B.empty else B.cons (B.head st2) (takeHead st1 (B.tail st2))

takeTail :: B.ByteString -> B.ByteString -> B.ByteString
takeTail st1 st2 = if B.null st2 then B.empty else if st1 == (nHead (toInteger (B.length st1)) st2) then nTail (toInteger (B.length st1)) st2 else takeTail st1 (B.tail st2)

nTail :: Integer -> B.ByteString -> B.ByteString
nTail n str = let rec n str = if n == 0 then str else rec (n - 1) (B.tail str)
              in if (toInteger (B.length str)) < n then str else rec n str

nHead :: Integer -> B.ByteString -> B.ByteString
nHead n str = let rec n str = if n == 0 then B.empty else B.cons (B.head str)(rec (n - 1) (B.tail str))
              in if (toInteger (B.length str)) < n then str else rec n str

getValue :: B.ByteString -> B.ByteString -> B.ByteString -> B.ByteString
getValue row field = getCol (read (Bc.unpack field)) . getRow (read (Bc.unpack row))

main = do args <- Bg.getArgs
          case (map (B.fromChunks . return) args) of
                                                    (path:opt1:opt2:_) -> do src <- B.readFile (Bc.unpack path)
                                                                             B.putStrLn $ getValue opt1 opt2 src

                                                    (path:_)           -> do src <- B.readFile (Bc.unpack path)
                                                                             putStrLn $ show $ length $ Bu.lines src 
```

它不起作用。我无法调试它。这是 GHC 告诉我的：

```
BETA_getlow2.hs:10:23:
    Couldn't match expected type `GHC.Int.Int64' with actual type `Int'
    In the second argument of `B.index', namely `n'
    In the expression: (`B.index` n)
    In the expression: (`B.index` n) $ Bu.lines

BETA_getlow2.hs:13:23:
    Couldn't match expected type `GHC.Int.Int64' with actual type `Int'
    In the second argument of `B.index', namely `n'
    In the expression: (`B.index` n)
    In the expression: (`B.index` n) $ wordsWithSeparator 
```

任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T23:18:32.363

```
getRow n = (!!n) . lines 
```

与之比较

```
getRow n = B.index . Bu.lines 
```

在第二个版本中您根本不使用`n`，所以它与

```
getRow _ = B.index . Bu.lines 
```

在第一个示例中，您将`n`其用作`(!!)`运算符的参数。您需要在第二个版本中执行相同的操作。

看起来这不是您的代码中唯一的问题，但我希望这是一个很好的起点；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T10:55:03.320

我冒昧地将以下两个子问题解释为您的原始问题。

1.  Haskell 代码通常会为您发布的脚本编写什么脚本。
2.  什么是有效执行所需功能的正确数据结构。

以下代码为这两个子问题提供了一个答案。它使用该[`text`](http://hackage.haskell.org/packages/archive/text)库来表示 Unicode 字符序列。此外，它利用`text`库的高级 API 来实现所需的功能。这使得代码更容易掌握，从而避免了低级函数实现中的潜在错误。

```
{-# LANGUAGE OverloadedStrings #-}

import qualified Data.Text    as T
import qualified Data.Text.IO as T

import System.Environment (getArgs)

type Table a = [[a]]

-- | Split a text value into a text table.
toTable :: T.Text -> Table T.Text
toTable = map (T.splitOn " ; ") . T.lines

-- | Retrieve a cell from a table.
cell :: Int -> Int -> Table a -> a
cell row col = (!! col) . (!! row)

main :: IO ()
main = do
    (path:rest) <- getArgs
    src <- T.readFile path
    case rest of
        row : col : _ -> T.putStrLn $ cell (read row) (read col) $ toTable src
        _             -> putStrLn $ show $ length $ T.lines src 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T08:24:48.810

我想，Yuras 已经为你解决了前两个错误。

* * *

关于第三个错误：

```
words' :: B.ByteString -> [B.ByteString]
words' str = if B.null str then B.empty else ... 
```

`B.empty`应该`[]`是。`B.empty :: B.ByteString`，但结果应该是 type `[B.ByteString]`。

* * *

关于第 4-7 个错误：

*   `length :: [a] -> Int`
*   `B.length :: B.ByteString -> Int64`

在这种情况下，我将更改 和 的类型签名`nTail`以`nHead`使用`Int64`而不是`Int`. 如果这不起作用，我会`Integer`在所有`Integral`类型上使用`toInteger`，用于进行转换。

* * *

关于第 8 个错误：

的输入`read`必须是`String`. 没有办法解决这个问题。您必须将 转换`B.ByteString`为 a`String`并将其传递给`read`.

（顺便说一句，您确定要切换到 ByteString 而不是 Text？）

* * *

关于第 9 个（最终）错误：

`args :: [Data.ByteString.ByteString]`（nb 是*严格*`args :: B.ByteString`字节串的列表，而不是您在其他地方使用的惰性字节串）但是出于某种原因您期望的模式匹配。

您应该以与在 a 上进行模式匹配`[ByteString]`相同的方式进行模式匹配`[String]`：它们都是列表。

将 args 转换`[B.ByteString]`为`map (B.fromChunks . return) args`.

# .htaccess - htaccess 用锚重写目录和索引

> ID：10306856
> 
> 赞同：0
> 
> 时间：2012-04-24T22:19:42.583
> 
> 标签：.htaccess, mod-rewrite

只是好奇是否有办法重写 /static/index-discover.html 看起来像是来自 /discover/？这是否意味着我可以从那时起将 href 指向 /discover/#whatever 和 /discover/#whatever/andagain 之类的锚点？

我知道 htaccess 的东西已经死了，但我认为我从来没有见过它与锚标签和写回一起使用

当前的.htaccess

```
############################################
## uncomment these lines for CGI mode
## make sure to specify the correct cgi php binary file name
## it might be /cgi-bin/php-cgi

#    Action php5-cgi /cgi-bin/php5-cgi
#    AddHandler php5-cgi .php

############################################
## GoDaddy specific options

#   Options -MultiViews

## you might also need to add this line to php.ini
##     cgi.fix_pathinfo = 1
## if it still doesn't work, rename php.ini to php5.ini

############################################
## this line is specific for 1and1 hosting

    #AddType x-mapp-php5 .php
    #AddHandler x-mapp-php5 .php

############################################
## default index file

    DirectoryIndex index.php #index.php

<IfModule mod_php5.c>

############################################
#resetting the max cookie lifetime to 2 hrs to allow
# long sessions
#php_value session.gc_maxlifetime 7200

############################################
## adjust memory limit

#    php_value memory_limit 64M
#    php_value memory_limit 256M
#    php_value max_execution_time 18000

############################################
## disable magic quotes for php request vars

#    php_flag magic_quotes_gpc off

############################################
## disable automatic session start
## before autoload was initialized

#    php_flag session.auto_start off

############################################
## enable resulting html compression

    #php_flag zlib.output_compression on

###########################################
# disable user agent verification to not break multiple image upload

#    php_flag suhosin.session.cryptua off

###########################################
# turn off compatibility with PHP4 when dealing with objects

#    php_flag zend.ze1_compatibility_mode Off

</IfModule>

<IfModule mod_security.c>
###########################################
# disable POST processing to not break multiple image upload

    SecFilterEngine Off
    SecFilterScanPOST Off
</IfModule>

<IfModule mod_deflate.c>

############################################
## enable apache served files compression
## http://developer.yahoo.com/performance/rules.html#gzip

    # Insert filter on all content
    ###SetOutputFilter DEFLATE
    # Insert filter on selected content types only
    #AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript

    # Netscape 4.x has some problems...
    #BrowserMatch ^Mozilla/4 gzip-only-text/html

    # Netscape 4.06-4.08 have some more problems
    #BrowserMatch ^Mozilla/4\.0[678] no-gzip

    # MSIE masquerades as Netscape, but it is fine
    #BrowserMatch \bMSIE !no-gzip !gzip-only-text/html

    # Don't compress images
    #SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png)$ no-gzip dont-vary

    # Make sure proxies don't deliver the wrong content
    #Header append Vary User-Agent env=!dont-vary

</IfModule>

# <IfModule mod_ssl.c>

############################################
## make HTTPS env vars available for CGI mode

    # SSLOptions StdEnvVars

# </IfModule>

<IfModule mod_rewrite.c>

############################################
## enable rewrites

    # Options +FollowSymLinks
    RewriteEngine on

############################################
## you can put here your magento root folder
## path relative to web root

    # handle the rewriting of non-www better than Magento does (preserve the paths)
    RewriteCond %{HTTP_HOST} ^smartwool.com$ [NC]
    RewriteRule ^(.*)$ http://www.smartwool.com/$1 [R=301,L]

    # handle links from smartwool pro
#   RewriteCond %{HTTP_HOST} ^(www\.)?smartwoolpro.com$ [NC]
#   RewriteRule ^(.*)$ http://www.smartwool.com/pro [R=301,L]

    # hide all SVN
    RedirectMatch 404 /\\.svn(/|$)

RewriteRule ^feed.json$ feed.php

############################################
## workaround for HTTP authorization
## in CGI environment

    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

############################################
## always send 404 on missing files in these folders

    RewriteCond %{REQUEST_URI} !^/(media|skin|js)/

############################################
## never rewrite for existing files, directories and links

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-l

############################################
## rewrite everything else to index.php

    RewriteRule .* index.php [L]

</IfModule>

############################################
## Prevent character encoding issues from server overrides
## If you still have problems, use the second line instead

    AddDefaultCharset Off
    #AddDefaultCharset UTF-8

<IfModule mod_expires.c>

############################################
## Add default Expires header
## http://developer.yahoo.com/performance/rules.html#expires

    ExpiresDefault "access plus 1 year"

</IfModule>

############################################
## By default allow all access

    Order allow,deny
    Allow from all

############################################
## If running in cluster environment, uncomment this
## http://developer.yahoo.com/performance/rules.html#etags

    #FileETag none

############################################
## Redirect Directory Expert to subdomain

    RewriteEngine on
    RewriteCond %{HTTP_HOST} ^(www\.)?smartwool\.com$
    RewriteRule ^expert/(.*) http://expert.smartwool.com/$1 [R=301,L]

############################################
## Deny updater script from everyone

    <filesMatch "^(mupt|edi)\.php$">
     deny from all
    </filesMatch>

############################################
## Discover page rewrite

    RewriteEngine on
    RewriteRule ^discover/$ static/discover.html [L] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:26:29.727

哈希“#”标签是严格的客户端，从不发送到服务器。因此，.htaccess 永远不会看到它们。要使用它们，您必须实现 JavaScript 来读取它们。

但是，要使用 .htaccess 获取您要查找的 URL，请执行以下操作：

```
RewriteEngine On
RewriteRule ^discover/$ static/index-discover.html [L] 
```

编辑：我现在明白你所说的锚标签是什么意思了......我想我读你的问题太快了。如果您像我发布的那样进行重定向，则所有锚标记都可以正常工作。\

# opengl - 坐标系的旋转矩阵（欧拉角，手性）

> ID：10306857
> 
> 赞同：0
> 
> 时间：2012-04-24T22:19:49.433
> 
> 标签：opengl, directx, stereo-3d

我有一个坐标系，其中相机的方向表示为 R=Rz(k) * Ry(p) * Rx(o) 其中 R 是一个 3x3 矩阵，由每个 X,Y 周围的 3x3 旋转矩阵组成,Z 轴。此外，我有一个约定，其中 Z 轴位于相机的观察方向。X 轴为左右，Y 轴为自下而上。

该 R 矩阵用于多视图立体重建算法。我有一个带有预先校准的相机信息的数据测试集。我想使用这个数据集附带的 R 矩阵。但是，我不知道他们采取什么样的轮换顺序，甚至不知道他们的惯用手。

我怎么能弄清楚这一点？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T09:32:24.860

> R=Rz(k) * Ry(p) * Rx(o)

这是一种非常不稳定的做法。欧拉角很容易进入云台锁定，所以我强烈建议不要使用它们。

> 我怎么能弄清楚这一点？

嗯，这个问题很难用封闭的解决方案来表达。最好的办法是将其视为 3 空间中的优化问题，在其中尝试找到 k、p 和 o 的值以与给定的旋转矩阵 R 匹配。评估顺序有 3 种可能的排列，所以你这样做对所有 3 个进行优化并获取最佳匹配结果。

# optimization - 我怎样才能找到 k 最佳解决方案？

> ID：10306862
> 
> 赞同：2
> 
> 时间：2012-04-24T22:20:25.877
> 
> 标签：optimization, solver, ms-solver-foundation

我正在使用 Microsoft 求解器，并想问我如何找到

使用 LP 的 K 最佳解决方案，而不仅仅是最优解决方案？

例如，我知道 CPLEX 具有*解决方案池*功能。

感谢您的帮助。

保罗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T03:33:04.460

Paul Rubin有一篇关于找到 k 个最佳解决方案的不错的[博客文章](http://orinanobworld.blogspot.com/2012/04/k-best-solutions.html)。

# android - 安卓开发工具包。按下按钮时膨胀菜单（xml文件）

> ID：10306867
> 
> 赞同：0
> 
> 时间：2012-04-24T22:20:55.720
> 
> 标签：android, android-2.2-froyo, android-inflate

据我了解，Android 3 之后不支持菜单按钮。所以，我只是想在屏幕上使用一个按钮来膨胀菜单。我目前使用覆盖

```
public boolean oncreateoptionsmenu(Menu menu) { MenuInflater inflater=getMenuInflater();
inflater.inflate( R.menu.menu, menu); return true}. 
```

该脚本在按下菜单按钮时运行，但我也希望它在按下按钮时运行。如何才能做到这一点？什么数据被发送到 Menu 参数（要膨胀到的菜单）？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:16:24.783

在 android 3+ 上，活动开始时菜单将自动添加到操作栏。没有必要改变任何东西。

# android - Android：具有背景对比度的 DrawText

> ID：10306868
> 
> 赞同：0
> 
> 时间：2012-04-24T22:21:09.333
> 
> 标签：android, graphics, canvas, drawtext, contrast

如何“设置”一个油漆来完成上面的“第二个”图像？

```
paint.setColor(Color.BLACK);
canvas.drawText(strValue, x, y, paint); 
```

![在此处输入图像描述](../Images/55b4b182e918e498d6a87f451bbf33ae.png)

第一张图片：由于上面的代码，文本全部为黑色。

第二张图片：更好地对比背景颜色（用图形编辑器编辑，只是为了在这里说明）

请注意，“31”是部分黑色和部分白色（但它可以是与红色对比度更好的任何其他颜色，因为“36”可能是蓝色）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T02:55:30.950

您可以使用[PixelXorXfermode](http://developer.android.com/reference/android/graphics/PixelXorXfermode.html)进行绘制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:30:09.300

我能想到的唯一解决方案是，首先在你的 onDraw 上，你有一个变量 Canvas ，你等于实际的，然后你画你的数字，

```
paint.setColor(Color.BLACK);
canvas.drawText(strValue, x, y, paint); 
```

然后你画红色的 Rect

```
canvas.drawRect(myRect, redPaint); 
```

然后你画你的线

```
canvas.drawline(mStartX,mStartY, mFinishX, mFinishY, myLinePaint); 
```

在你的 onDraw 之外的最后，你调用一个像这样的方法：

```
public void myMethod(){
    Paint paint = new Paint();
    paint.setColor(Color.BLACK);
    this.canvas.drawText(strValue, x, y, paint);
    //here you will define the area that you will mark as dirty 
    //(wich can have the same values as your red Rect)
    Rect myRect = new Rect();
    myRect.set(x0,y0,x1,y1);
    //and finally here you invalidate ONLY the red area
    this.canvas.invalidate(myRect);
} 
```

注意：这将要求在您的 onDraw 上验证全局 Canvas 不为空，如果是，则将您的全局等同于实际值。我不确定这是否真的有效，但这是我能想到的唯一解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T01:31:10.833

设置 AntiAlias 时，PixelXorXfermode 不是好方法。

如果你能得到红色矩形，我认为使用 canvas.clipRect 更好。像这样

```
textpaint.setColor(black);
canvas.drawText(str,x,y,textpaint);

Rect oldClipRect = canvas.getClipBounds();
canvas.clipRect(rcRed,Op.REPLACE);
textpaint.setColor(white);
canvas.drawText(str,x,y,textpaint);
canvas.clipRect(oldclipRect,Op.REPLACE); 
```

# windows - HeapAlloc 导致异常 - Windows 7 x64

> ID：10306870
> 
> 赞同：0
> 
> 时间：2012-04-24T22:21:33.927
> 
> 标签：windows, exception, 64-bit, heap-memory, wow64

在一段时间之前，我编写了自己的小型数据库编辑器程序，我使用 Win API 从零开始对其进行编码，因此它不是非常小的项目。到目前为止，它在所有操作系统上都运行良好，我有 Win 7 x64 和所有最新更新，我的应用程序由于某些堆函数（HeapAlloc 或 HeapFree，我什么都不用）而崩溃，出现 0xC000005 异常，我尝试替换 HeapAlloc &带有 VirtualAlloc 和 VirtualFree 的 HeapFree 一切都很好，但我不想使用虚拟内存.... 别的，我试图附加调试器来跟踪问题，但是当我附加调试器时它没有崩溃，然后我尝试了显示 MessageBox 以跟踪它崩溃的位置，但是当我显示 MessageBox 时它也没有崩溃......

我的应用程序作为 32 位进程运行。用 C 编码。

有人有类似的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T01:27:51.460

您是否已将其附加到应用程序的调试版本？如果问题没有出现在调试版本中，那么您应该检查哪些警告（在最高级别）生成您的代码，也许您会发现一些未初始化的变量。如果这里没有，那么您可能会使用一些静态分析工具来帮助查找错误 - 例如 PVS-Studio [http://www.viva64.com/](http://www.viva64.com/)。

您还可以在启用调试信息的情况下编译发布版本，这样当问题出现时，您应该能够使用调试器附加到您的应用程序并查看带有函数名称的调用堆栈。为了更容易调试，禁用代码优化。

您也可以尝试使用 windows 调试器工具中的 gflags，每次您在缓冲区边界之外写入时，该程序都会触发断点。这是一个非常有用的工具，因为并非所有缓冲区溢出都会出现异常。在启用调试信息的应用程序上使用它，最好关闭代码优化。要为您的应用启用 gflags，请使用：

gflags /p /enable myapp.exe /full (http://msdn.microsoft.com/en-us/library/windows/hardware/ff543097%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:14:08.513

首先，两者都`HeapAlloc`分配`VirtualAlloc`虚拟内存。

我对正在发生的事情的猜测是您正在写入超出分配内存的边界。这不起作用的原因`HeapAlloc`是它准确地分配了您请求的内存量。使用`VirtualAlloc`，返回的大小是向上舍入到下一页边界的请求大小。在您的情况下，这提供了更多的余地（即使您的代码仍然在做错事）。

至于为什么它到目前为止一直有效：你很幸运。仔细查看访问分配内存的代码，如果遇到困难，请在此处发布相关部分。如果调试器没有帮助并且错误很容易重现，只需注释掉部分代码，直到找到导致崩溃的行。

# c# - 使用 Google Analytics API 在 C# 中显示信息

> ID：10306872
> 
> 赞同：51
> 
> 时间：2012-04-24T22:21:39.743
> 
> 标签：c#, .net, google-api, google-analytics-api

我整天都在寻找一个好的解决方案，但谷歌发展得如此之快，以至于我找不到有用的东西。我想要做的是，我有一个 Web 应用程序，它有一个管理部分，用户需要登录才能查看信息。在本节中，我想展示一些来自 GA 的数据，例如某些特定 url 的综合浏览量。由于我显示的不是用户信息，而是谷歌分析用户，我想连接传递信息（用户名/密码或 APIKey），但我不知道如何连接。我发现的所有示例都使用 OAuth2（如果我理解的话，女巫会要求访问者使用 google 登录）。

到目前为止我发现了什么：

*   .Net 的 Google 官方客户端库：[http](http://code.google.com/p/google-api-dotnet-client/) ://code.google.com/p/google-api-dotnet-client/ ，没有 GA 示例
*   官方开发者帮助：[https ://developers.google.com/analytics/](https://developers.google.com/analytics/)
*   另一个关于 SO 代码的问题：[Google Analytics API - Programmatically fetch page view in server side](https://stackoverflow.com/questions/6806577/google-analytics-api-programmatically-fetch-page-views-in-server-side) but I get a 403 when I try to authentication
*   一些访问 API 的源：[http](http://www.reimers.dk/jacob-reimers-blog/added-google-analytics-reader-for-net) ://www.reimers.dk/jacob-reimers-blog/added-google-analytics-reader-for-net下载了源，但我不知道它是如何工作的
*   关于 SO 的另一个问题：[Google Analytics Access with C#](https://stackoverflow.com/questions/15734/google-analytics-access-with-c-sharp)但它没有帮助
*   在写这篇文章时，他们向我推荐了这篇 09 年的旧帖子[Google Analytics API 和 .Net](https://stackoverflow.com/questions/791125/google-analytics-api-and-net) ...

也许我只是累了，明天很容易找到解决方案，但现在我需要帮助！

谢谢

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-10-10T15:26:38.077

它需要在谷歌方面进行一些设置，但实际上非常简单。我会一步一步列出来。

**首先，您需要在 Google 云控制台中创建一个应用程序并启用 Analytics API。**

*   转到[http://code.google.com/apis/console](http://code.google.com/apis/console)
*   如果您还没有项目，请选择下拉菜单并创建一个项目
*   创建项目后，单击服务
*   从这里启用分析 API

**既然启用了 Analytics API，下一步将是启用服务帐户来访问您所需的分析配置文件/站点。服务帐户将允许您登录，而无需提示用户输入凭据。**

*   转到[http://code.google.com/apis/console](http://code.google.com/apis/console)并从下拉列表中选择您创建的项目。
*   接下来转到“API 访问”部分并单击“创建另一个客户端 ID”按钮。
*   在 Create Client ID 窗口中，选择 service account 并单击 create client id。
*   如果此帐户没有自动开始下载，请下载此帐户的公钥。稍后您在编写授权代码时将需要它。
*   在退出之前复制服务帐户自动生成的电子邮件地址，因为您将在下一步中需要它。客户电子邮件看起来像 @developer.gserviceaccount.com

**现在我们有了一个服务帐户，您需要允许该服务帐户访问您在 Google Analytics 中的个人资料/网站。**

*   登录谷歌分析。
*   登录后，单击屏幕左侧底部的管理按钮。
*   在管理员中单击帐户下拉菜单并选择您希望您的服务帐户能够访问的帐户/站点，然后单击帐户部分下的“用户管理”。
*   输入为您的服务帐户生成的电子邮件地址，并授予其读取和分析权限。
*   对您希望您的服务访问的任何其他帐户/站点重复这些步骤。

**现在已经完成了服务帐户通过 API 访问 Google Analytics 的设置，我们可以开始编写代码了。**

从 NuGet 获取此包：

[Google.Apis.Analytics.v3 客户端库](http://www.nuget.org/packages/Google.Apis.Analytics.v3/)

添加这些用法：

```
using Google.Apis.Analytics.v3;
using Google.Apis.Analytics.v3.Data;
using Google.Apis.Services;
using System.Security.Cryptography.X509Certificates;
using Google.Apis.Auth.OAuth2;
using System.Collections.Generic; 
using System.Linq; 
```

需要注意的一些事情是。

*   这`keyPath`是您下载的带有 .p12 文件扩展名的密钥文件的路径。
*   这`accountEmailAddress`是我们之前收到的 api 电子邮件。
*   Scope 是`Google.Apis.Analytics.v3.AnalyticService`类中的一个枚举，它指示要使用的 url 以进行授权（例如：）`AnalyticsService.Scope.AnalyticsReadonly`。
*   应用程序名称是您选择的名称，它告诉 google api 正在访问它的内容（又名：它可以是您选择的任何内容）。

然后进行一些基本调用的代码如下。

```
public class GoogleAnalyticsAPI
{
    public AnalyticsService Service { get; set; }

    public GoogleAnalyticsAPI(string keyPath, string accountEmailAddress)
    {
        var certificate = new X509Certificate2(keyPath, "notasecret", X509KeyStorageFlags.Exportable);

        var credentials = new ServiceAccountCredential(
           new ServiceAccountCredential.Initializer(accountEmailAddress)
           {
               Scopes = new[] { AnalyticsService.Scope.AnalyticsReadonly }
           }.FromCertificate(certificate));

        Service = new AnalyticsService(new BaseClientService.Initializer()
            {
                HttpClientInitializer = credentials,
                ApplicationName = "WorthlessVariable"
            });
    }

    public AnalyticDataPoint GetAnalyticsData(string profileId, string[] dimensions, string[] metrics, DateTime startDate, DateTime endDate)
    {
        AnalyticDataPoint data = new AnalyticDataPoint();
        if (!profileId.Contains("ga:"))
            profileId = string.Format("ga:{0}", profileId);

        //Make initial call to service.
        //Then check if a next link exists in the response,
        //if so parse and call again using start index param.
        GaData response = null;
        do
        {
            int startIndex = 1;
            if (response != null && !string.IsNullOrEmpty(response.NextLink))
            {
                Uri uri = new Uri(response.NextLink);
                var paramerters = uri.Query.Split('&');
                string s = paramerters.First(i => i.Contains("start-index")).Split('=')[1];
                startIndex = int.Parse(s);
            }

            var request = BuildAnalyticRequest(profileId, dimensions, metrics, startDate, endDate, startIndex);
            response = request.Execute();
            data.ColumnHeaders = response.ColumnHeaders;
            data.Rows.AddRange(response.Rows);

        } while (!string.IsNullOrEmpty(response.NextLink));

        return data;
    }

    private DataResource.GaResource.GetRequest BuildAnalyticRequest(string profileId, string[] dimensions, string[] metrics,
                                                                        DateTime startDate, DateTime endDate, int startIndex)
    {
        DataResource.GaResource.GetRequest request = Service.Data.Ga.Get(profileId, startDate.ToString("yyyy-MM-dd"),
                                                                            endDate.ToString("yyyy-MM-dd"), string.Join(",", metrics));
        request.Dimensions = string.Join(",", dimensions);
        request.StartIndex = startIndex;
        return request;
    }

    public IList<Profile> GetAvailableProfiles()
    {
        var response = Service.Management.Profiles.List("~all", "~all").Execute();
        return response.Items;
    }

    public class AnalyticDataPoint
    {
        public AnalyticDataPoint()
        {
            Rows = new List<IList<string>>();
        }

        public IList<GaData.ColumnHeadersData> ColumnHeaders { get; set; }
        public List<IList<string>> Rows { get; set; }
    }
} 
```

* * *

其他有用的链接：

[Analytic API Explorer - 从 Web 查询 API](https://developers.google.com/apis-explorer/#p/analytics/v3/analytics.data.ga.get)

[Analytic API Explorer 版本 2 - 从 Web 查询 API](http://ga-dev-tools.appspot.com/explorer/)

[维度和指标参考](https://developers.google.com/analytics/devguides/reporting/core/dimsmets)

希望这可以帮助将来尝试这样做的人。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-04-24T23:17:28.657

我做了很多搜索，最后要么从多个地方查找代码，然后围绕它包装我自己的界面，我想出了以下解决方案。不确定人们是否将整个代码粘贴在这里，但我想为什么不节省其他人的时间:)

先决条件，您需要安装 Google.GData.Client 和 google.gdata.analytics 包/dll。

这是完成这项工作的主要课程。

```
namespace Utilities.Google
{
    public class Analytics
    {
        private readonly String ClientUserName;
        private readonly String ClientPassword;
        private readonly String TableID;
        private AnalyticsService analyticsService;

        public Analytics(string user, string password, string table)
        {
            this.ClientUserName = user;
            this.ClientPassword = password;
            this.TableID = table;

            // Configure GA API.
            analyticsService = new AnalyticsService("gaExportAPI_acctSample_v2.0");
            // Client Login Authorization.
            analyticsService.setUserCredentials(ClientUserName, ClientPassword);
        }

        /// <summary>
        /// Get the page views for a particular page path
        /// </summary>
        /// <param name="pagePath"></param>
        /// <param name="startDate"></param>
        /// <param name="endDate"></param>
        /// <param name="isPathAbsolute">make this false if the pagePath is a regular expression</param>
        /// <returns></returns>
        public int GetPageViewsForPagePath(string pagePath, DateTime startDate, DateTime endDate, bool isPathAbsolute = true)
        {
            int output = 0;

            // GA Data Feed query uri.
            String baseUrl = "https://www.google.com/analytics/feeds/data";

            DataQuery query = new DataQuery(baseUrl);
            query.Ids = TableID;
            //query.Dimensions = "ga:source,ga:medium";
            query.Metrics = "ga:pageviews";
            //query.Segment = "gaid::-11";
            var filterPrefix = isPathAbsolute ? "ga:pagepath==" : "ga:pagepath=~";
            query.Filters = filterPrefix + pagePath;
            //query.Sort = "-ga:visits";
            //query.NumberToRetrieve = 5;
            query.GAStartDate = startDate.ToString("yyyy-MM-dd", CultureInfo.InvariantCulture);
            query.GAEndDate = endDate.ToString("yyyy-MM-dd", CultureInfo.InvariantCulture);
            Uri url = query.Uri;
            DataFeed feed = analyticsService.Query(query);
            output = Int32.Parse(feed.Aggregates.Metrics[0].Value);

            return output;
        }

        public Dictionary<string, int> PageViewCounts(string pagePathRegEx, DateTime startDate, DateTime endDate)
        {
            // GA Data Feed query uri.
            String baseUrl = "https://www.google.com/analytics/feeds/data";

            DataQuery query = new DataQuery(baseUrl);
            query.Ids = TableID;
            query.Dimensions = "ga:pagePath";
            query.Metrics = "ga:pageviews";
            //query.Segment = "gaid::-11";
            var filterPrefix = "ga:pagepath=~";
            query.Filters = filterPrefix + pagePathRegEx;
            //query.Sort = "-ga:visits";
            //query.NumberToRetrieve = 5;
            query.GAStartDate = startDate.ToString("yyyy-MM-dd", CultureInfo.InvariantCulture);
            query.GAEndDate = endDate.ToString("yyyy-MM-dd", CultureInfo.InvariantCulture);
            Uri url = query.Uri;
            DataFeed feed = analyticsService.Query(query);

            var returnDictionary = new Dictionary<string, int>();
            foreach (var entry in feed.Entries)
                returnDictionary.Add(((DataEntry)entry).Dimensions[0].Value, Int32.Parse(((DataEntry)entry).Metrics[0].Value));

            return returnDictionary;
        }
    }
} 
```

这是我用来包装它的接口和实现。

```
namespace Utilities
{
    public interface IPageViewCounter
    {
        int GetPageViewCount(string relativeUrl, DateTime startDate, DateTime endDate, bool isPathAbsolute = true);
        Dictionary<string, int> PageViewCounts(string pagePathRegEx, DateTime startDate, DateTime endDate);
    }

    public class GooglePageViewCounter : IPageViewCounter
    {
        private string GoogleUserName
        {
            get
            {
                return ConfigurationManager.AppSettings["googleUserName"];
            }
        }

        private string GooglePassword
        {
            get
            {
                return ConfigurationManager.AppSettings["googlePassword"];
            }
        }

        private string GoogleAnalyticsTableName
        {
            get
            {
                return ConfigurationManager.AppSettings["googleAnalyticsTableName"];
            }
        }

        private Analytics analytics;

        public GooglePageViewCounter()
        {
            analytics = new Analytics(GoogleUserName, GooglePassword, GoogleAnalyticsTableName);
        }

        #region IPageViewCounter Members

        public int GetPageViewCount(string relativeUrl, DateTime startDate, DateTime endDate, bool isPathAbsolute = true)
        {
            int output = 0;
            try
            {
                output = analytics.GetPageViewsForPagePath(relativeUrl, startDate, endDate, isPathAbsolute);
            }
            catch (Exception ex)
            {
                Logger.Error(ex);
            }

            return output;
        }

        public Dictionary<string, int> PageViewCounts(string pagePathRegEx, DateTime startDate, DateTime endDate)
        {
            var input = analytics.PageViewCounts(pagePathRegEx, startDate, endDate);
            var output = new Dictionary<string, int>();

            foreach (var item in input)
            {
                if (item.Key.Contains('&'))
                {
                    string[] key = item.Key.Split(new char[] { '?', '&' });
                    string newKey = key[0] + "?" + key.FirstOrDefault(k => k.StartsWith("p="));

                    if (output.ContainsKey(newKey))
                        output[newKey] += item.Value;
                    else
                        output[newKey] = item.Value;
                }
                else
                    output.Add(item.Key, item.Value);
            }
            return output;
        }

        #endregion
    }
} 
```

现在剩下的就是显而易见的东西 - 您必须将 web.config 值添加到您的应用程序配置或 webconfig 并调用 IPageViewCounter.GetPageViewCount

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-06-17T02:29:14.603

此答案适用于那些想要访问自己的 Analytics 帐户并想要使用新的[Analytics Reporting API v4](https://developers.google.com/analytics/devguides/reporting/core/v4/)的人。

我最近写了[一篇](https://washamdev.com/2017/06/how-to-access-google-api-data-using-asp-net/?utm_source=stackoverflow)关于如何使用 C# 获取 Google Analytics 数据的博客文章。阅读那里的所有细节。

您首先需要在连接 OAuth2 或服务帐户之间进行选择。我假设您拥有 Analytics 帐户，因此您需要从 Google APIs [Credentials](https://console.developers.google.com/apis/credentials)页面创建一个“服务帐户密钥”。

创建后，下载 JSON 文件并将其放入您的项目中（我将我的放在我的`App_Data`文件夹中）。

接下来，安装[Google.Apis.AnalyticsReporting.v4](https://www.nuget.org/packages/Google.Apis.AnalyticsReporting.v4/) Nuget 包。还要安装 Newtonsoft 的[Json.NET](http://www.newtonsoft.com/json)。

在你的项目中包含这个类：

```
public class PersonalServiceAccountCred
{
    public string type { get; set; }
    public string project_id { get; set; }
    public string private_key_id { get; set; }
    public string private_key { get; set; }
    public string client_email { get; set; }
    public string client_id { get; set; }
    public string auth_uri { get; set; }
    public string token_uri { get; set; }
    public string auth_provider_x509_cert_url { get; set; }
    public string client_x509_cert_url { get; set; }
} 
```

这就是您一直在等待的：一个完整​​的示例！

```
string keyFilePath = Server.MapPath("~/App_Data/Your-API-Key-Filename.json");
string json = System.IO.File.ReadAllText(keyFilePath);

var cr = JsonConvert.DeserializeObject(json);

var xCred = new ServiceAccountCredential(new ServiceAccountCredential.Initializer(cr.client_email)
{
    Scopes = new[] {
        AnalyticsReportingService.Scope.Analytics
    }
}.FromPrivateKey(cr.private_key));

using (var svc = new AnalyticsReportingService(
    new BaseClientService.Initializer
    {
        HttpClientInitializer = xCred,
        ApplicationName = "[Your Application Name]"
    })
)
{
    // Create the DateRange object.
    DateRange dateRange = new DateRange() { StartDate = "2017-05-01", EndDate = "2017-05-31" };

    // Create the Metrics object.
    Metric sessions = new Metric { Expression = "ga:sessions", Alias = "Sessions" };

    //Create the Dimensions object.
    Dimension browser = new Dimension { Name = "ga:browser" };

    // Create the ReportRequest object.
    ReportRequest reportRequest = new ReportRequest
    {
        ViewId = "[A ViewId in your account]",
        DateRanges = new List() { dateRange },
        Dimensions = new List() { browser },
        Metrics = new List() { sessions }
    };

    List requests = new List();
    requests.Add(reportRequest);

    // Create the GetReportsRequest object.
    GetReportsRequest getReport = new GetReportsRequest() { ReportRequests = requests };

    // Call the batchGet method.
    GetReportsResponse response = svc.Reports.BatchGet(getReport).Execute();
} 
```

我们首先从 JSON 文件反序列化服务帐户密钥信息并将其转换为`PersonalServiceAccountCred`对象。然后，我们创建`ServiceAccountCredential`并通过`AnalyticsReportingService`. 使用该服务，我们然后准备一些基本过滤器以传递给 API 并发送请求。

最好在`response`声明变量的行上设置断点，按一次 F10，然后将鼠标悬停在变量上，这样您就可以看到哪些数据可供您在响应中使用。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-01-16T18:28:03.687

我希望只是为 v3 Beta 的答案添加评论，但代表点阻止了这一点。但是，我认为其他人有这些信息会很好，所以这里是：

```
using Google.Apis.Authentication.OAuth2;
using Google.Apis.Authentication.OAuth2.DotNetOpenAuth;
using System.Security.Cryptography.X509Certificates;
using Google.Apis.Services; 
```

这些名称空间在该帖子的整个代码中使用。我一直希望人们能更频繁地发布名称空间，我似乎花了很多时间寻找它们。我希望这可以为一些人节省几分钟的工作时间。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-09-21T04:39:50.023

我在 nuGet 包中设置了与上述答案非常相似的东西。它执行以下操作： - 连接到您在 API 控制台中设置的“服务帐户” - 提取您想要的任何 Google Analytics 数据 - 使用 Google 的 Charts API 显示该数据，并且它以非常容易修改的方式完成所有这些. 您可以在此处查看更多信息：[https](https://www.nuget.org/packages/GoogleAnalytics.GoogleCharts.NET/) ://www.nuget.org/packages/GoogleAnalytics.GoogleCharts.NET/ 。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-05-31T06:31:41.673

希望谷歌有一天会提供适当的文档。在这里，我列出了在 ASP.NET C# 中集成谷歌分析服务器端身份验证的所有步骤。

**第 1 步：在 google 控制台中创建一个项目**

转到链接[https://console.developers.google.com/iam-admin/projects](https://console.developers.google.com/iam-admin/projects)并通过单击“创建项目”按钮创建项目并在弹出窗口中提供项目名称并提交。

**第 2 步：创建凭据和服务帐户**

创建项目后，您将被重定向到“API Manager”页面。单击凭据，然后按“创建凭据”按钮。从下拉列表中选择“服务帐户密钥”，您将被重定向到下一页。在服务帐户下拉菜单中，选择“新建服务帐户”。填写服务帐号名称并下载 p12 密钥。它将具有 p12 扩展名。您将看到一个弹出窗口，其中包含默认密码“ **notasecret** ”，您的私钥将被下载。

**第 3 步：创建 0auth 客户端 ID**

单击“创建凭据”下拉菜单并选择“0auth 客户端 ID”，您将被重定向到“0auth 同意屏幕”选项卡。在项目名称文本框中提供一个随机名称。选择应用程序类型为“Web 应用程序”，然后单击创建按钮。在记事本中复制生成的客户端 ID。

**第 4 步：启用 API**

在左侧单击“Overview”选项卡，然后从水平选项卡中选择“Enabled APIs”。在搜索栏中搜索“Analytics API”，单击下拉菜单并按“启用”按钮。现在再次搜索“Analytics Reporting V4”并启用它。

**第 5 步：安装 nuget 包**

在 Visual Studio 中，转到工具 > Nuget 包管理器 > 包管理器控制台。将以下代码复制粘贴到控制台中以安装 nuget 包。

*安装包 Google.Apis.Analytics.v3*

*安装包 DotNetOpenAuth.Core -版本 4.3.4.13329*

以上两个包是谷歌分析和DotNetOpenAuth nuget包。

**第 6 步：为服务帐户提供“查看和分析”权限**

转到谷歌分析帐户并单击“管理”选项卡并从左侧菜单中选择“用户管理”，选择您要访问分析数据的域并在其下插入服务帐户电子邮件 ID，然后选择“读取和分析”权限从下拉列表中。服务帐户电子邮件 ID 类似于 ex：*googleanalytics@googleanalytics.iam.gserviceaccount.com*。

*工作代码*

**前端代码：**

将以下分析嵌入脚本复制并粘贴到您的前端，否则您也可以从谷歌分析文档页面获取此代码。

```
 <script>
    (function (w, d, s, g, js, fs) {
        g = w.gapi || (w.gapi = {}); g.analytics = { q: [], ready: function (f) { this.q.push(f); } };
        js = d.createElement(s); fs = d.getElementsByTagName(s)[0];
        js.src = 'https://apis.google.com/js/platform.js';
        fs.parentNode.insertBefore(js, fs); js.onload = function () { g.load('analytics'); };
    }(window, document, 'script'));</script> 
```

将以下代码粘贴到前端页面的正文标记中。

```
 <asp:HiddenField ID="accessToken" runat="server" />
<div id="chart-1-container" style="width:600px;border:1px solid #ccc;"></div>
        <script>
           var access_token = document.getElementById('<%= accessToken.ClientID%>').value;

            gapi.analytics.ready(function () {
                /**
                 * Authorize the user with an access token obtained server side.
                 */
                gapi.analytics.auth.authorize({
                    'serverAuth': {
                        'access_token': access_token
                    }
                });
                /**
                 * Creates a new DataChart instance showing sessions.
                 * It will be rendered inside an element with the id "chart-1-container".
                 */
                var dataChart1 = new gapi.analytics.googleCharts.DataChart({
                    query: {
                        'ids': 'ga:53861036', // VIEW ID <-- Goto your google analytics account and select the domain whose analytics data you want to display on your webpage. From the URL  ex: a507598w53044903p53861036\. Copy the digits after "p". It is your view ID
                        'start-date': '2016-04-01',
                        'end-date': '2016-04-30',
                        'metrics': 'ga:sessions',
                        'dimensions': 'ga:date'
                    },
                    chart: {
                        'container': 'chart-1-container',
                        'type': 'LINE',
                        'options': {
                            'width': '100%'
                        }
                    }
                });
                dataChart1.execute();

                /**
                 * Creates a new DataChart instance showing top 5 most popular demos/tools
                 * amongst returning users only.
                 * It will be rendered inside an element with the id "chart-3-container".
                 */

            });
</script> 
```

您还可以从[https://ga-dev-tools.appspot.com/account-explorer/获取您的视图 ID](https://ga-dev-tools.appspot.com/account-explorer/)

**后端代码：**

```
 using System;
    using System.Linq;
    using System.Collections.Generic;
    using System.Collections.Specialized;
    using System.Web.Script.Serialization;
    using System.Net;
    using System.Text;
    using Google.Apis.Analytics.v3;
    using Google.Apis.Analytics.v3.Data;
    using Google.Apis.Services;
    using System.Security.Cryptography.X509Certificates;
    using Google.Apis.Auth.OAuth2;
    using Google.Apis.Util;
    using DotNetOpenAuth.OAuth2;
    using System.Security.Cryptography;

    namespace googleAnalytics
    {
        public partial class api : System.Web.UI.Page
        {
            public const string SCOPE_ANALYTICS_READONLY = "https://www.googleapis.com/auth/analytics.readonly";

            string ServiceAccountUser = "googleanalytics@googleanalytics.iam.gserviceaccount.com"; //service account email ID
            string keyFile = @"D:\key.p12"; //file link to downloaded key with p12 extension
            protected void Page_Load(object sender, EventArgs e)
            {

               string Token = Convert.ToString(GetAccessToken(ServiceAccountUser, keyFile, SCOPE_ANALYTICS_READONLY));

               accessToken.Value = Token;

                var certificate = new X509Certificate2(keyFile, "notasecret", X509KeyStorageFlags.Exportable);

                var credentials = new ServiceAccountCredential(

                    new ServiceAccountCredential.Initializer(ServiceAccountUser)
                    {
                        Scopes = new[] { AnalyticsService.Scope.AnalyticsReadonly }
                    }.FromCertificate(certificate));

                var service = new AnalyticsService(new BaseClientService.Initializer()
                {
                    HttpClientInitializer = credentials,
                    ApplicationName = "Google Analytics API"
                });

                string profileId = "ga:53861036";
                string startDate = "2016-04-01";
                string endDate = "2016-04-30";
                string metrics = "ga:sessions,ga:users,ga:pageviews,ga:bounceRate,ga:visits";

                DataResource.GaResource.GetRequest request = service.Data.Ga.Get(profileId, startDate, endDate, metrics);

                GaData data = request.Execute();
                List<string> ColumnName = new List<string>();
                foreach (var h in data.ColumnHeaders)
                {
                    ColumnName.Add(h.Name);
                }

                List<double> values = new List<double>();
                foreach (var row in data.Rows)
                {
                    foreach (var item in row)
                    {
                        values.Add(Convert.ToDouble(item));
                    }

                }
                values[3] = Math.Truncate(100 * values[3]) / 100;

                txtSession.Text = values[0].ToString();
                txtUsers.Text = values[1].ToString();
                txtPageViews.Text = values[2].ToString();
                txtBounceRate.Text = values[3].ToString();
                txtVisits.Text = values[4].ToString();

            }

         public static dynamic GetAccessToken(string clientIdEMail, string keyFilePath, string scope)
        {
            // certificate
            var certificate = new X509Certificate2(keyFilePath, "notasecret");

            // header
            var header = new { typ = "JWT", alg = "RS256" };

            // claimset
            var times = GetExpiryAndIssueDate();
            var claimset = new
            {
                iss = clientIdEMail,
                scope = scope,
                aud = "https://accounts.google.com/o/oauth2/token",
                iat = times[0],
                exp = times[1],
            };

            JavaScriptSerializer ser = new JavaScriptSerializer();

            // encoded header
            var headerSerialized = ser.Serialize(header);
            var headerBytes = Encoding.UTF8.GetBytes(headerSerialized);
            var headerEncoded = Convert.ToBase64String(headerBytes);

            // encoded claimset
            var claimsetSerialized = ser.Serialize(claimset);
            var claimsetBytes = Encoding.UTF8.GetBytes(claimsetSerialized);
            var claimsetEncoded = Convert.ToBase64String(claimsetBytes);

            // input
            var input = headerEncoded + "." + claimsetEncoded;
            var inputBytes = Encoding.UTF8.GetBytes(input);

            // signature
            var rsa = certificate.PrivateKey as RSACryptoServiceProvider;
            var cspParam = new CspParameters
            {
                KeyContainerName = rsa.CspKeyContainerInfo.KeyContainerName,
                KeyNumber = rsa.CspKeyContainerInfo.KeyNumber == KeyNumber.Exchange ? 1 : 2
            };
            var aescsp = new RSACryptoServiceProvider(cspParam) { PersistKeyInCsp = false };
            var signatureBytes = aescsp.SignData(inputBytes, "SHA256");
            var signatureEncoded = Convert.ToBase64String(signatureBytes);

            // jwt
            var jwt = headerEncoded + "." + claimsetEncoded + "." + signatureEncoded;

            var client = new WebClient();
            client.Encoding = Encoding.UTF8;
            var uri = "https://accounts.google.com/o/oauth2/token";
            var content = new NameValueCollection();

            content["assertion"] = jwt;
            content["grant_type"] = "urn:ietf:params:oauth:grant-type:jwt-bearer";

            string response = Encoding.UTF8.GetString(client.UploadValues(uri, "POST", content));

            var result = ser.Deserialize<dynamic>(response);

            object pulledObject = null;

            string token = "access_token";
            if (result.ContainsKey(token))
            {
                pulledObject = result[token];
            }

            //return result;
            return pulledObject;
        }

        private static int[] GetExpiryAndIssueDate()
        {
            var utc0 = new DateTime(1970, 1, 1, 0, 0, 0, 0, DateTimeKind.Utc);
            var issueTime = DateTime.UtcNow;

            var iat = (int)issueTime.Subtract(utc0).TotalSeconds;
            var exp = (int)issueTime.AddMinutes(55).Subtract(utc0).TotalSeconds;

            return new[] { iat, exp };
        }

        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-25T13:16:32.260

**另一种工作方法**

在 ConfigAuth 中添加以下代码

```
 var googleApiOptions = new GoogleOAuth2AuthenticationOptions()
        {
            AccessType = "offline", // can use only if require
            ClientId = ClientId,
            ClientSecret = ClientSecret,
            Provider = new GoogleOAuth2AuthenticationProvider()
            {
                OnAuthenticated = context =>
                {
                    context.Identity.AddClaim(new Claim("Google_AccessToken", context.AccessToken));

                    if (context.RefreshToken != null)
                    {
                        context.Identity.AddClaim(new Claim("GoogleRefreshToken", context.RefreshToken));
                    }
                    context.Identity.AddClaim(new Claim("GoogleUserId", context.Id));
                    context.Identity.AddClaim(new Claim("GoogleTokenIssuedAt", DateTime.Now.ToBinary().ToString()));
                    var expiresInSec = 10000;
                    context.Identity.AddClaim(new Claim("GoogleTokenExpiresIn", expiresInSec.ToString()));

                    return Task.FromResult(0);
                }
            },

            SignInAsAuthenticationType = DefaultAuthenticationTypes.ApplicationCookie
        };
        googleApiOptions.Scope.Add("openid"); // Need to add for google+ 
        googleApiOptions.Scope.Add("profile");// Need to add for google+ 
        googleApiOptions.Scope.Add("email");// Need to add for google+ 
        googleApiOptions.Scope.Add("https://www.googleapis.com/auth/analytics.readonly");

        app.UseGoogleAuthentication(googleApiOptions); 
```

添加以下代码、名称空间和相关引用

```
 using Google.Apis.Analytics.v3;
 using Google.Apis.Analytics.v3.Data;
 using Google.Apis.Auth.OAuth2;
 using Google.Apis.Auth.OAuth2.Flows;
 using Google.Apis.Auth.OAuth2.Responses;
 using Google.Apis.Services;
 using Microsoft.AspNet.Identity;
 using Microsoft.Owin.Security;
 using System;
 using System.Threading.Tasks;
 using System.Web;
 using System.Web.Mvc;

public class HomeController : Controller
{
    AnalyticsService service;
    public IAuthenticationManager AuthenticationManager
    {
        get
        {
            return HttpContext.GetOwinContext().Authentication;
        }
    }

    public async Task<ActionResult> AccountList()
    {
        service = new AnalyticsService(new BaseClientService.Initializer()
        {
            HttpClientInitializer = await GetCredentialForApiAsync(),
            ApplicationName = "Analytics API sample",
        });

        //Account List
        ManagementResource.AccountsResource.ListRequest AccountListRequest = service.Management.Accounts.List();
        //service.QuotaUser = "MyApplicationProductKey";
        Accounts AccountList = AccountListRequest.Execute();

        return View();
    }

    private async Task<UserCredential> GetCredentialForApiAsync()
    {
        var initializer = new GoogleAuthorizationCodeFlow.Initializer
        {
            ClientSecrets = new ClientSecrets
            {
                ClientId = ClientId,
                ClientSecret = ClientSecret,
            },
            Scopes = new[] { "https://www.googleapis.com/auth/analytics.readonly" }
        };
        var flow = new GoogleAuthorizationCodeFlow(initializer);

        var identity = await AuthenticationManager.GetExternalIdentityAsync(DefaultAuthenticationTypes.ApplicationCookie);
        if (identity == null)
        {
            Redirect("/Account/Login");
        }

        var userId = identity.FindFirstValue("GoogleUserId");

        var token = new TokenResponse()
        {
            AccessToken = identity.FindFirstValue("Google_AccessToken"),
            RefreshToken = identity.FindFirstValue("GoogleRefreshToken"),
            Issued = DateTime.FromBinary(long.Parse(identity.FindFirstValue("GoogleTokenIssuedAt"))),
            ExpiresInSeconds = long.Parse(identity.FindFirstValue("GoogleTokenExpiresIn")),
        };

        return new UserCredential(flow, userId, token);
    }
} 
```

在 Global.asax 的 Application_Start() 中添加它

```
 AntiForgeryConfig.UniqueClaimTypeIdentifier = ClaimTypes.NameIdentifier; 
```

# jpa - UnsupportedOperationException GlassFish 错误

> ID：10306877
> 
> 赞同：2
> 
> 时间：2012-04-24T22:21:59.603
> 
> 标签：jpa, jsf-2, glassfish

我在 Glassfish 3.1 上使用 JSF2 和 JPA Eclipse Link。

我在本地环境中开发了一个应用程序，在那里我没有任何问题。现在我试图将它部署在公共服务器上，但我最终遇到了一些奇怪的行为。

尝试部署应用程序时出现以下错误：

```
java.lang.UnsupportedOperationException 
```

堆栈跟踪如下所示：

```
Critical error during deployment: java.lang.ExceptionInInitializerError
sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
java.lang.reflect.Constructor.newInstance(Constructor.java:513) at     java.lang.Class.newInstance0(Class.java:355) 
java.lang.Class.newInstance(Class.java:308)
com.sun.faces.mgbean.BeanBuilder.newBeanInstance(BeanBuilder.java:188)
com.sun.faces.mgbean.BeanBuilder.build(BeanBuilder.java:102)
com.sun.faces.mgbean.BeanManager.createAndPush(BeanManager.java:409)
com.sun.faces.mgbean.BeanManager.create(BeanManager.java:269)
com.sun.faces.mgbean.BeanManager.create(BeanManager.java:256)
com.sun.faces.config.ConfigureListener.contextInitialized(ConfigureListener.java:255)
    org.apache.catalina.core.StandardContext.contextListenerStart(StandardContext.java:4690)
com.sun.enterprise.web.WebModule.contextListenerStart(WebModule.java:534)
org.apache.catalina.core.StandardContext.start(StandardContext.java:5305)
com.sun.enterprise.web.WebModule.start(WebModule.java:500)
org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:917)
org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:901)
org.apache.catalina.core.StandardHost.addChild(StandardHost.java:755)
com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1980)
com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1630)
com.sun.enterprise.web.WebApplication.start(WebApplication.java:100)
org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:286)
com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:370)
com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:355)
com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:370)
com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1067)
com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:96)
com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1247)
com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1235)
org.glassfish.admingui.common.util.LocalDeploymentFacility$LocalDFCommandRunner.run(LocalDe    ploymentFacility.java:143)
org.glassfish.deployment.client.AbstractDeploymentFacility.deploy(AbstractDeploymentFacility.java:406)
org.glassfish.admingui.common.util.DeployUtil.invokeDeploymentFacility(DeployUtil.java:100)
org.glassfish.admingui.common.util.DeployUtil.deploy(DeployUtil.java:76)
org.glassfish.admingui.common.handlers.DeploymentHandler.deploy(DeploymentHandler.java:191)
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at com.sun.jsftemplating.layout.descriptors.handler.Handler.invoke(Handler.java:442)
at com.sun.jsftemplating.layout.descriptors.LayoutElementBase.dispatchHandlers(LayoutElementBase.java:420) 
at com.sun.jsftemplating.layout.descriptors.LayoutElementBase.dispatchHandlers(LayoutElementBase.java:394) 
at com.sun.jsftemplating.layout.event.CommandActionListener.invokeCommandHandlers(CommandActionListener.java:150) 
at com.sun.jsftemplating.layout.event.CommandActionListener.processAction(CommandActionListener.java:98) 
at javax.faces.event.ActionEvent.processListener(ActionEvent.java:88) 
at javax.faces.component.UIComponentBase.broadcast(UIComponentBase.java:769) 
at javax.faces.component.UICommand.broadcast(UICommand.java:300) 
at com.sun.webui.jsf.component.WebuiCommand.broadcast(WebuiCommand.java:166) 
at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794) 
at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259) 
at     com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81) 
at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101) 
com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118) 
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:409) 
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1534) 
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343) 
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215) 
at com.sun.webui.jsf.util.UploadFilter.doFilter(UploadFilter.java:223) 
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256) 
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215) 
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279) 
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175) 
at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655) 
at org.apache.catalina.core.StandardPipeline.doChainInvoke(StandardPipeline.java:600) 
at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:96) 
at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91) 
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162) 
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:326) 
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:227) 
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:228) 
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:822) 
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:719) 
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1013) 
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225) 
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137) 
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104) 
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90) 
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79) 
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54) 
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59) 
at com.sun.grizzly.ContextTask.run(ContextTask.java:71) 
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532) 
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513) 
at java.lang.Thread.run(Thread.java:662) Caused by: Exception [EclipseLink-30005] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.PersistenceUnitLoadingException Exception Description: An exception was thrown while searching for persistence archives with ClassLoader: WebappClassLoader (delegate=true; repositories=WEB-INF/classes/) Internal Exception: javax.persistence.PersistenceException: Exception [EclipseLink-28018] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.EntityManagerSetupException Exception Description: Predeployment of PersistenceUnit [Maze] failed. Internal Exception: Exception [EclipseLink-7333] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.ValidationException Exception Description: The reference column name [id] mapped on the element [field country] does not correspond to a valid field on the mapping reference. 
at org.eclipse.persistence.exceptions.PersistenceUnitLoadingException.exceptionSearchingForPersistenceResources(PersistenceUnitLoadingException.java:126) 
at org.eclipse.persistence.jpa.PersistenceProvider.createEntityManagerFactory(PersistenceProvider.java:105) 
at javax.persistence.Persistence.createEntityManagerFactory(Unknown Source) 
at javax.persistence.Persistence.createEntityManagerFactory(Unknown Source) 
at com.maze.factory.EMFactory.initComplete(EMFactory.java:30) 
at com.maze.factory.EMFactory.getInstance(EMFactory.java:23) 
at com.maze.service.BaseService.<init>(BaseService.java:12) 
at com.maze.service.CountryService.<init>(CountryService.java:14) 
at com.maze.service.factory.ServiceFactory.getCountryService(ServiceFactory.java:47) 
at com.maze.util.Constants.<clinit>(Constants.java:175) ... 88 more Caused by: javax.persistence.PersistenceException: Exception [EclipseLink-28018] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.EntityManagerSetupException Exception Description: Predeployment of PersistenceUnit [Maze] failed. Internal Exception: Exception [EclipseLink-7333] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.ValidationException Exception Description: The reference column name [id] mapped on the element [field country] does not correspond to a valid field on the mapping reference. 
at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.predeploy(EntityManagerSetupImpl.java:1127) 
at org.eclipse.persistence.internal.jpa.deployment.JPAInitializer.callPredeploy(JPAInitializer.java:101) 
at org.eclipse.persistence.jpa.PersistenceProvider.createEntityManagerFactory(PersistenceProvider.java:96) ... 96 more Caused by: Exception [EclipseLink-28018] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.EntityManagerSetupException Exception Description: Predeployment of PersistenceUnit [Maze] failed. Internal Exception: Exception [EclipseLink-7333] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.ValidationException Exception Description: The reference column name [id] mapped on the element [field country] does not correspond to a valid field on the mapping reference. 
at org.eclipse.persistence.exceptions.EntityManagerSetupException.predeployFailed(EntityManagerSetupException.java:210) ... 99 more Caused by: Exception [EclipseLink-7333] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.ValidationException Exception Description: The reference column name [id] mapped on the element [field country] does not correspond to a valid field on the mapping reference. 
at org.eclipse.persistence.exceptions.ValidationException.invalidReferenceColumnName(ValidationException.java:1793) 
at org.eclipse.persistence.internal.jpa.metadata.accessors.MetadataAccessor.getReferencedField(MetadataAccessor.java:437) 
at org.eclipse.persistence.internal.jpa.metadata.accessors.MetadataAccessor.getReferencedField(MetadataAccessor.java:386) 
at org.eclipse.persistence.internal.jpa.metadata.accessors.mappings.MappingAccessor.processOneToOneForeignKeyRelationship(MappingAccessor.java:1574) 
at org.eclipse.persistence.internal.jpa.metadata.accessors.mappings.ObjectAccessor.processOneToOneForeignKeyRelationship(ObjectAccessor.java:614) 
at org.eclipse.persistence.internal.jpa.metadata.accessors.mappings.ObjectAccessor.processOwningMappingKeys(ObjectAccessor.java:667) 
at org.eclipse.persistence.internal.jpa.metadata.accessors.mappings.ManyToOneAccessor.process(ManyToOneAccessor.java:110) 
at org.eclipse.persistence.internal.jpa.metadata.MetadataProject.processOwningRelationshipAccessors(MetadataProject.java:1350) 
at org.eclipse.persistence.internal.jpa.metadata.MetadataProject.processStage3(MetadataProject.java:1572) 
at org.eclipse.persistence.internal.jpa.metadata.MetadataProcessor.processORMMetadata(MetadataProcessor.java:486) 
at org.eclipse.persistence.internal.jpa.deployment.PersistenceUnitProcessor.processORMetadata(PersistenceUnitProcessor.java:454) 
at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.predeploy(EntityManagerSetupImpl.java:1081) ... 98 more 
```

** 映射在元素 [field country] 上的引用列名称 [id] 与映射引用上的有效字段不对应。**

现在我是否理解涉及 Country 实体和 Id 字段的映射以某种方式涉及？依靠这一点，我删除了所有涉及 Country 实体的 JPA 映射，但我仍然收到此错误。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T08:54:05.763

只是一个疯狂的猜测。您是否已经有了要通过 jpa 创建或插入值的表。

看起来表架构和数据库与您的 java 应用程序不匹配。

# android - Android FileNotFoundException res/drawable-hdpi/scrollbar_handle_vertical.9.png

> ID：10306882
> 
> 赞同：8
> 
> 时间：2012-04-24T22:22:32.547
> 
> 标签：android, android-layout

我的应用程序目前最严重的用户报告崩溃如下。系统似乎找不到文件 res/drawable-hdpi/scrollbar_handle_vertical.9.png 下面的示例表明问题发生在绘制 webview 时，但它也发生在我的应用程序中的其他活动中，所有这些都可以正常工作时间。

我认为这是一个我不需要担心的 android 资源。但是，为了测试，我从 sdk 中取出文件并将其放入我的项目 drawable-hdpi 文件夹中，用于我的应用程序的最新版本。但是，我仍然观察 google play 中的崩溃报告。

关于可能发生什么的任何想法？

我现在也没有使用 progaurd，所以没有办法删除它不应该删除的文件。

```
android.view.InflateException: Binary XML file line #26: Error inflating class com.android.internal.app.AlertController$RecycleListView
at android.view.LayoutInflater.createView(LayoutInflater.java:513)
at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:565)
at android.view.LayoutInflater.inflate(LayoutInflater.java:385)
at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
at android.webkit.WebView$InvokeListBox.run(WebView.java:8308)
at android.os.Handler.handleCallback(Handler.java:587)
at android.os.Handler.dispatchMessage(Handler.java:92)
at android.os.Looper.loop(Looper.java:123)
at android.app.ActivityThread.main(ActivityThread.java:4627)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:521)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.reflect.InvocationTargetException
at com.android.internal.app.AlertController$RecycleListView.<init>(AlertController.java:703)
at java.lang.reflect.Constructor.constructNative(Native Method)
at java.lang.reflect.Constructor.newInstance(Constructor.java:446)
at android.view.LayoutInflater.createView(LayoutInflater.java:500)
... 14 more
Caused by: android.content.res.Resources$NotFoundException: File res/drawable-hdpi/scrollbar_handle_vertical.9.png from drawable resource ID #0x0
at android.content.res.Resources.loadDrawable(Resources.java:1714)
at android.content.res.TypedArray.getDrawable(TypedArray.java:601)
at android.widget.AbsListView.<init>(AbsListView.java:630)
at android.widget.ListView.<init>(ListView.java:230)
at android.widget.ListView.<init>(ListView.java:226)
... 18 more
Caused by: java.io.FileNotFoundException: res/drawable-hdpi/scrollbar_handle_vertical.9.png
at android.content.res.AssetManager.openNonAssetNative(Native Method)
at android.content.res.AssetManager.openNonAsset(AssetManager.java:405)
at android.content.res.Resources.loadDrawable(Resources.java:1706)
... 22 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:30:54.627

似乎一个（或多个设备）上缺少此资源。即该设备上的 Android 版本缺少此文件。看看这个问题是否会影响非常特定的设备会很有趣。

我希望解决方案是在您的应用程序本身中使用可绘制对象（而不是依赖 android 中的绘制对象）并确保引用您的对象，而不是某些设备上缺少的对象。

您可以使用 BugSense 之类的工具来跟踪此类问题，以收集有关受影响设备和平台版本的数据。如果您无法从 Google Play 商店报告中获取此信息，这将非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-06T17:42:55.600

发生这种情况的另一种情况 - 当您使用更高版本的 android 中引入的属性/资源时。索引有一些复杂的映射属性，当 appt 生成 R.java 时，它可能会重叠一些旧的 id，并且会发生这个非常奇怪的错误。

对我来说，在 api 11 中引入了 in view 时出现了同样的错误
`android:foreground="?android:attr/selectableItemBackground"`

`selectableItemBackground`，但在 api 7 的模拟器中启动。

因此，请检查您的布局是否使用了一些在您的 minSdkVersion 之后引入的资源。可以在[R.java 参考中检查](https://developer.android.com/reference/android/R.attr.html)

# javascript - 防止双击带有 knockout.js 的按钮

> ID：10306883
> 
> 赞同：17
> 
> 时间：2012-04-24T22:22:43.030
> 
> 标签：javascript, knockout.js

禁用按钮的最佳方法是什么，以便在 knockout.js 中不会发生双击。我有一些用户快速点击导致多个 ajax 请求。我认为 knockout.js 可以通过多种方式处理这个问题，并且希望看到一些替代方案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-24T22:29:59.337

使用信号量（自旋锁）。基本上，您计算一个元素已注册的点击次数，如果它超过 1，则返回 false 并且不允许以下点击。可以使用超时功能来清除锁定，以便他们可以在 5 秒后再次单击。[您可以从http://knockoutjs.com/documentation/click-binding.html](http://knockoutjs.com/documentation/click-binding.html)修改示例

如此处所示：

```
<div>
 You've clicked <span data-bind="text: numberOfClicks"></span> times
 <button data-bind="click: incrementClickCounter">Click me</button>
</div>

<script type="text/javascript">
 var viewModel = {
     numberOfClicks : ko.observable(0),
     incrementClickCounter : function() {
         var previousCount = this.numberOfClicks();
         this.numberOfClicks(previousCount + 1);
     }
 };
</script> 
```

通过将嵌套函数内部的逻辑更改为

```
if( this.numberOfClicks() > 1 ){
 //TODO: Handle multiple clicks or simply return false
 // and perhaps implement a timeout which clears the lockout
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-07T18:40:30.477

我在单击按钮时通过 Ajax 提交数据的表单向导遇到了类似的问题。对于每个步骤，我们有 4 个选择性可见的按钮。我们创建了一个 boolean observable `ButtonLock`，如果它为真，则从提交函数返回。然后我们还将`disable`每个按钮的数据绑定到`ButtonLock`observable

视图模型：

```
var viewModel = function(...) {
    self.ButtonLock = ko.observable(false);

    self.AdvanceStep = function (action) {
        self.ButtonLock(true);
        // Do stuff
        // Ajax call
    }

    self.AjaxCallback = function(data) {
        // Handle response, update UI
        self.ButtonLock(false);
    } 
```

按钮：

```
<input type="button" id="FormContinue" name="FormContinue" class="ActionButton ContinueButton"
    data-bind="
        if: CurrentStep().actions.continueAction,
        disable: ButtonLock,
        value: CurrentStep().actions.continueAction.buttonText,
        click: function() {
            AdvanceStep(CurrentStep().actions.continueAction);
        }"/> 
```

如果您只需要防止多次点击，我更喜欢布尔值。但是，如果您需要该功能，计数器方法可以让您检测双击并单独处理它们。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-02-18T14:07:38.640

以防有人仍在寻找一种方法来做到这一点。我发现你可以使用布尔值。

```
self.disableSubmitButton= ko.observable(false);
  self.SubmitPayment = function () {
        self.disableSubmitButton(true);
       //your other actions here
        } 
```

那么在你看来

```
data-bind="click:SubmitPayment, disable:disableSubmitButton" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-05T10:38:42.603

我使用自定义绑定做到了这一点：

```
<button data-bind="throttleClick: function() { console.log(new Date()); }>
    I wont double click quicker than 800ms
</button> 
```

* * *

```
ko.bindingHandlers.throttleClick = {
    init: function(element, valueAccessor) {
        var preventClick = false;
        var handler = ko.unwrap(valueAccessor());

        $(element).click(function() {
            if(preventClick)
                return;

            preventClick = true;
            handler.call();
            setTimeout(function() { preventClick = false; }, 800);
        })
    }
} 
```

# ios - iOS 在图像上滑动图像，露出下面的图像。(A-la jQuery.slide())

> ID：10306886
> 
> 赞同：3
> 
> 时间：2012-04-24T22:23:08.180
> 
> 标签：ios, animation, uiimage, slide

我正在尝试做以下事情 -

我有同一张图片的两个版本，一个是彩色的，一个是黑白的。我希望 B&W 能够“向上滑动”以显示其下方的那个。

我尝试设置高度和框架，但无法让它像我想要的那样工作。

例如，这将是两个 UIImage 的组合，其中一个显示另一个，但不移动：

![在此处输入图像描述](../Images/a368b57b715292dafd07255ca54b34d6.png)

有任何想法吗？:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T01:14:55.037

好的，这是在灰色视图上使用蒙版的另一种方法。我实际上用 blueView 和 grayView 对此进行了测试，其中灰色覆盖了蓝色。在灰色层上放一个蒙版层，使灰色层可见。现在动画蒙版远离灰色层，使灰色层消失而不移动它，蓝色显示灰色消失的地方。

如果您想对此进行试验，请在 XCode 中创建一个带有单个视图的空项目，并将此代码放在 viewDidLoad 中。我就是这样测试的。

```
self.view.backgroundColor = [UIColor whiteColor];

UIView* blueView = [[[UIView alloc] init] autorelease];
blueView.backgroundColor = [UIColor blueColor];
blueView.frame = CGRectMake(50,50,100,100);

UIView* grayView = [[[UIView alloc] init] autorelease];
grayView.backgroundColor = [UIColor grayColor];
grayView.frame = CGRectMake(50,50,100,100);

[self.view addSubview:blueView];
[self.view addSubview:grayView];    // gray covers the blue

// Create a mask to allow the grey view to be visible and cover up the blue view
CALayer* mask = [CALayer layer];
mask.contentsScale   = grayView.layer.contentsScale;  // handle retina scaling
mask.frame           = grayView.layer.bounds;
mask.backgroundColor = [UIColor blackColor].CGColor;
grayView.layer.mask = mask;

// Animate the position of the mask off the grey view, as the grey becomes unmasked,
// that part of the grey "dissappears" and is no longer covering the blue underneath
CABasicAnimation* a = [CABasicAnimation animationWithKeyPath:@"position"];
a.duration  = 4;
a.fromValue = [NSValue valueWithCGPoint:mask.position];
CGPoint newPosition = mask.position;
newPosition.y += mask.bounds.size.height;
a.toValue   = [NSValue valueWithCGPoint:newPosition];
a.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];
[mask addAnimation:a forKey:@"colorize"];   // animate presentation

mask.position = newPosition;        // update actual position 
```

不要忘记顶部带有#imports 的这一行：

```
#import <QuartzCore/QuartzCore.h> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T00:12:29.003

一种方法是堆叠 UIView，使黑白图像位于彩色图像之上，彩色图像完全被黑白图像覆盖（隐藏）。

```
[self.view insertSubview:bwImage aboveSubview:colorImage]; 
```

只有黑白视图可见。现在在 B&W 视图上设置 clipsToBounds：

```
bwImage.clipsToBounds = YES; 
```

最后对 bwImage 边界内的高度进行动画处理，使其高度缩小到 0，剪裁 B&W 图像并显示其背后的彩色图像。像这样的东西：

```
[UIView animateWithDuration:1.0 animations:^{
    CGRect b = bwImage.bounds;
    b.size.height = 0;
    bwImage.bounds = b;
}]; 
```

我还没有尝试过，但希望你明白这一点。

# google-app-engine - 在任务可用之前，我可以阻止 Google AppEngine 拉取任务队列吗？

> ID：10306889
> 
> 赞同：2
> 
> 时间：2012-04-24T22:23:39.787
> 
> 标签：google-app-engine, message-queue, task-queue, amazon-sqs, amazon-sns

在任务可用之前，我可以阻止 Google AppEngine 拉取任务队列吗？或者，我是否需要轮询一个空队列，直到有任务可用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T03:44:08.447

您需要轮询队列。拉队列的一个典型用例是有多个后端，每个后端一次获得一千个任务。

对于一次几个小时队列中没有任务的用例，推送队列可能更适合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:57:49.393

不是 100% 确定您的问题，但想尝试一个答案。由 cron 启动的拉取任务队列可能适用。节省运行后端的费用。我有需要序列化和存储的客户端日志数据。在线处理程序只是将客户端数据传递给任务拉取队列。Cron 每分钟启动一次任务，每次运行最多有 10k 个日志项被序列化和存储。（根据您的负载更改设置——这些远远超出了我的适度需求。）在这种情况下，队列充当缓冲区，并且负载峰值会分布在均匀的处理单元中。如果您想快速访问 TQ 数据或具有不可预测的负载，显然没有用。非常重要的是，日志数据序列化将数据写入减少了 1000 倍。可能不适用于您的问题，所以我将以一个大的 HTH 结尾。-史蒂夫

# mysql - 如何基于 MYSQL 中的十六进制代码进行 REGEXP 搜索？

> ID：10306896
> 
> 赞同：6
> 
> 时间：2012-04-24T22:24:14.017
> 
> 标签：mysql, regex

`SELECT title FROM tags WHERE title REGEXP '[\x20]'`返回所有带有 x、2 或 0 的事物； `SELECT title FROM tags WHERE title REGEXP '\x20'`返回字面上 x20 的所有东西

我的实际用例是我想搜索任何可能意外进入控制字符的标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:50:24.153

可能有更好的方法来做到这一点，但这是我想出的：

```
SELECT title FROM tags WHERE title REGEXP CONCAT('[',CHAR(1),'-',CHAR(31),']') 
```

请注意，这些是十进制字符值，而不是十六进制。我也想不出办法让它找到 NULL 字节（`\x00`）。

这是使用十六进制文字的替代方法：

```
SELECT title FROM tags WHERE title REGEXP CONCAT('[', x'01', '-', x'1F', ']') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-16T23:04:01.173

我相信您在 mysql shell 中执行此操作，它会自行删除反斜杠。以下对我有用：

```
select id, data regexp '\\x1F\\x8B\\x08' from ...; 
```

# javascript - 猪拉丁语翻译器 - JavaScript

> ID：10306899
> 
> 赞同：2
> 
> 时间：2012-04-24T22:24:42.587
> 
> 标签：javascript

因此，对于我的 cit 课程，我必须编写一个 pig Latin 转换器程序，我对如何一起使用数组和字符串感到非常困惑。转换规则很简单，只需将单词的第一个字母移到后面，然后加上ay。例如：英语中的地狱将是猪拉丁语中的 ellhay 到目前为止我有这个：

```
<form name="form">
<p>English word/sentence:</p> <input type="text" id="english" required="required" size="80" /> <br />
<input type="button" value="Translate!" onClick="translation()" />
<p>Pig Latin translation:</p> <textarea name="piglat" rows="10" cols="60"></textarea>
</form>

<script type="text/javascript">
<!--
fucntion translation() { 
var delimiter = " ";
    input = document.form.english.value;
    tokens = input.split(delimiter);
    output = [];
    len = tokens.length;
    i;

for (i = 1; i<len; i++){
    output.push(input[i]);
}
output.push(tokens[0]);
output = output.join(delimiter);
}
//-->
</script> 
```

我真的很感激我能得到的任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-07-30T13:46:13.430

```
function translate(str) {
     str=str.toLowerCase();
     var n =str.search(/[aeiuo]/);
     switch (n){
       case 0: str = str+"way"; break;
       case -1: str = str+"ay"; break;
       default :
         //str= str.substr(n)+str.substr(0,n)+"ay";
         str=str.replace(/([^aeiou]*)([aeiou])(\w+)/, "$2$3$1ay");
       break;
    }
    return str;

}

 translate("paragraphs") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T23:01:04.247

我认为你真正需要看的两件事是`substring()`方法和字符串连接（将两个字符串加在一起）。由于调用返回的数组中的所有对象`split()`都是字符串，因此简单的字符串连接可以正常工作。例如，使用这两种方法，您可以将字符串的第一个字母移动到末尾，如下所示：

```
var myString = "apple";

var newString = mystring.substring(1) + mystring.substring(0,1); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-30T19:10:51.813

这段代码是基本的，但它可以工作。首先，注意以元音开头的单词。否则，对于以一个或多个辅音开头的单词，确定辅音的数量并将它们移到末尾。

```
function translate(str) {
    str=str.toLowerCase();

    // for words that start with a vowel:
    if (["a", "e", "i", "o", "u"].indexOf(str[0]) > -1) {
        return str=str+"way";
    }

    // for words that start with one or more consonants
   else {
   //check for multiple consonants
       for (var i = 0; i<str.length; i++){
           if (["a", "e", "i", "o", "u"].indexOf(str[i]) > -1){
               var firstcons = str.slice(0, i);
               var middle = str.slice(i, str.length);
               str = middle+firstcons+"ay";
               break;}
            }
    return str;}
}

translate("school"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T22:48:33.690

如果您正在为数组苦苦挣扎，这可能会有点复杂，但它简洁紧凑：

```
var toPigLatin = function(str) {
    return str.replace(/(^\w)(.+)/, '$2$1ay');
}; 
```

演示：http: [//jsfiddle.net/elclanrs/2ERmg/](http://jsfiddle.net/elclanrs/2ERmg/)

略微改进的版本可用于整个句子：

```
var toPigLatin = function(str){
    return str.replace(/\b(\w)(\w+)\b/g, '$2$1ay');
}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-01T00:45:41.117

这是我的解决方案

```
function translatePigLatin(str) {
  var newStr = str;
  // if string starts with vowel make 'way' adjustment
  if (newStr.slice(0,1).match(/[aeiouAEIOU]/)) {
    newStr = newStr + "way";
  }
  // else, iterate through first consonents to find end of cluster
  // move consonant cluster to end, and add 'ay' adjustment
  else {
    var moveLetters = "";
    while (newStr.slice(0,1).match(/[^aeiouAEIOU]/)) {
      moveLetters += newStr.slice(0,1);
      newStr = newStr.slice(1, newStr.length);
    }
    newStr = newStr + moveLetters + "ay";
  }
  return newStr;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-06T14:21:00.780

这是我的解决方案代码：

```
function translatePigLatin(str) {
var vowel;
var consonant;
var n =str.charAt(0);
vowel=n.match(/[aeiou]/g);
if(vowel===null)
{
consonant= str.slice(1)+str.charAt(0)+”ay”;
}
else
{
consonant= str.slice(0)+”way”;
}
var regex = /[aeiou]/gi;
var vowelIndice = str.indexOf(str.match(regex)[0]);
if (vowelIndice>=2)
{
consonant = str.substr(vowelIndice) + str.substr(0, vowelIndice) + ‘ay’;
}

return consonant;
}

translatePigLatin(“gloove”); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-04-08T05:32:28.327

还有一种方式。

```
String.prototype.toPigLatin = function()
{
    var str = "";
    this.toString().split(' ').forEach(function(word)
    {
        str += (toPigLatin(word) + ' ').toString();
    });
    return str.slice(0, -1);
};

function toPigLatin(word)
{
    //Does the word already start with a vowel?
    if(word.charAt(0).match(/a*e*i*o*u*A*E*I*O*U*/g)[0])
    {
        return word;
    }

    //Match Anything before the firt vowel.
    var front = word.match(/^(?:[^a?e?i?o?u?A?E?I?O?U?])+/g);
    return (word.replace(front, "") + front + (word.match(/[a-z]+/g) ? 'a' : '')).toString();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-12-24T21:41:08.373

另一种方法是使用单独的函数作为真假开关。

```
function translatePigLatin(str) {

  // returns true only if the first letter in str is a vowel
  function isVowelFirstLetter() {
    var vowels = ['a', 'e', 'i', 'o', 'u', 'y'];
    for (i = 0; i < vowels.length; i++) {
      if (vowels[i] === str[0]) {
        return true;
      }
    }
    return false;
  }

  // if str begins with vowel case
  if (isVowelFirstLetter()) {
    str += 'way';
  }
  else {
    // consonants to move to the end of string
    var consonants = '';

    while (isVowelFirstLetter() === false) {
      consonants += str.slice(0,1);
      // remove consonant from str beginning
      str = str.slice(1);
    }

    str += consonants + 'ay';
  }

  return str;
}

translatePigLatin("jstest"); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-02T08:05:51.180

猪拉丁的另一种方式：

```
function translatePigLatin(str) {
  let vowels = /[aeiou]/g;
  var n = str.search(vowels); //will find the index of vowels
  switch (n){
    case 0:
      str = str+"way";
      break;
    case -1:
      str = str+"ay";
      break;
    default:
      str = str.slice(n)+str.slice(0,n)+"ay";
      break;
  }
  return str;
}

console.log(translatePigLatin("rhythm"));
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-04-24T22:35:42.423

你的朋友是字符串函数`.split`、数组函数`.join`和`.slice`和`.concat`。

*   [https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array#Accessor_methods](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array#Accessor_methods)
*   [https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String#Methods_unrelated_to_HTML](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String#Methods_unrelated_to_HTML)

**警告：** *以下是一个完整的解决方案，您可以在完成或花费太多时间后参考。*

```
function letters(word) {
    return word.split('')
}

function pigLatinizeWord(word) {
    var chars = letters(word);
    return chars.slice(1).join('') + chars[0] + 'ay';
}

function pigLatinizeSentence(sentence) {
    return sentence.replace(/\w+/g, pigLatinizeWord)
} 
```

演示：

```
> pigLatinizeSentence('This, is a test!')
"hisTay, siay aay esttay!" 
```

# asp.net-mvc - asp mvc post不发送表单数据

> ID：10306900
> 
> 赞同：8
> 
> 时间：2012-04-24T22:24:57.777
> 
> 标签：asp.net-mvc

我正在尝试将表单数据发送到我的 ASP MVC 控制器，但表单集合为空。动作中的变量被正确绑定。这是我的剃刀形式

```
 @foreach (var recipe in Model.RecipesInCategory) {
    <form name="input" action="mycontroller/myAction/@Model.Id1/@Model.Id2" method="post">
    <fieldset>
      <table >
        <tr>
          <td>
            <input id="AddBtn" type="submit" value="Add"  />
            <select id="dayOfWeek" >
              <option value="Sunday">Sunday</option>
              <option value="Monday">Monday</option>
              <option value="Tuesday">Tuesday</option>
              <option value="Wednesday">Wednesday</option>
              <option value="Thursday">Thursday</option>
              <option value="Friday">Friday</option>
              <option value="Saturday">Saturday</option>
            </select>
          </td>
        </tr>
      </table>
    </fieldset>
    </form>
  } 
```

这是我的控制器。两个 GUID 正确通过，但 dow 变量始终为空。事实上，Form 根本没有条目。

```
[HttpPost]
public ActionResult myAction(Guid Id1, Guid Id2)
{
    var dow = this.Request.Form["dayOfWeek"]; 
```

请注意，我在此页面上循环创建了许多表单。那是问题吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-24T22:27:06.697

浏览器只会 POST 来自带有`name=""`属性的表单元素的数据。

# java - 如何更改 Java Swing TextArea 中的突出显示颜色？此外，更改与突出显示位置对应的文本的开头

> ID：10306901
> 
> 赞同：11
> 
> 时间：2012-04-24T22:25:00.533
> 
> 标签：java, swing, jtextarea, swing-highlighter

问题 1：通过使用 defaulthighlighter，我可以使焦点线变为蓝色。**现在我想把它改成其他颜色。有谁知道如何更改此参数？** - - 解决了

问题 2： pos 是我要突出显示的子字符串的开始索引。我使用 setCaretPosition(pos); 更新显示内容。但它**总是出现在窗口的底部。我想把它放在顶部。**谁能告诉我如何处理？

我使用一个演示来展示我的问题：

```
import java.awt.Color;
import java.net.MalformedURLException;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.SwingUtilities;
import javax.swing.text.BadLocationException;
import javax.swing.text.DefaultHighlighter;

public class Test {
    public static void main(final String[] args) throws MalformedURLException {
        SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
            try {
                init();
            } catch (BadLocationException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }
    });
}

private static void init() throws BadLocationException {
    JFrame frame = new JFrame();
    final JTextArea textArea = new JTextArea();
    JScrollPane pane = new JScrollPane(textArea);
    textArea.setText("Something. Something else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Samething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Sbmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Scmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Sdmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Semething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Sfmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Sgmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n");
    textArea.setSelectionColor(Color.RED);
    frame.add(pane);
    frame.setSize(300, 120);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);

    String turnToString2 = "Sdmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla";
    int pos2 = textArea.getText().indexOf(turnToString2);
    textArea.getHighlighter().addHighlight(pos2,
            pos2 + turnToString2.length(),
            new DefaultHighlighter.DefaultHighlightPainter(Color.yellow));
    textArea.setCaretPosition(pos2); 
```

结果是： ![在此处输入图像描述](../Images/9f7d07e0aeec09838c50dc218a7370bf.png)

我希望它位于屏幕的右上角，但在此代码中，它显示在滚动窗格的底部。谁能知道如何改变这个？谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-25T04:15:26.007

你可以做到这一点，虽然不是直接的，因为你必须保存对`Highlight`你添加到上述行的引用，因此你必须遍历所有的 Highlights 来删除你想要的，看看附加的程序，也许这会帮助你实现你想要的：

***最新编辑：新代码，删除了一些错误，似乎添加了与设置插入符号位置相关的所需功能***

```
import java.awt.*;
import java.awt.event.*;
import java.util.Map;
import java.util.HashMap;
import javax.swing.*;
import javax.swing.text.*;

public class TextHighlight
{
    private JTextArea tarea;
    private JComboBox cbox;
    private JTextField lineField;
    private String[] colourNames = {"RED", "ORANGE", "CYAN"};

    private Highlighter.HighlightPainter redPainter;
    private Highlighter.HighlightPainter orangePainter;
    private Highlighter.HighlightPainter cyanPainter;   

    private int firstUpdateIndex;
    private int counter;

    private Map<Integer, Highlighter.Highlight> highlights = new HashMap<Integer, Highlighter.Highlight>();

    public TextHighlight()
    {
        redPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.RED);
        orangePainter = new DefaultHighlighter.DefaultHighlightPainter(Color.ORANGE);
        cyanPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.CYAN);

        firstUpdateIndex = -1;
        counter = 0;
    }

    private void createAndDisplayGUI()
    {
        final JFrame frame = new JFrame("Text HIGHLIGHT");
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        JPanel contentPane = new JPanel();
        contentPane.setBorder(BorderFactory.createTitledBorder(
                BorderFactory.createEmptyBorder(5, 5, 5, 5), "Highlighter JTextArea"));

        tarea = new JTextArea(10, 10);
        JScrollPane scrollPane = new JScrollPane(tarea);
        contentPane.add(scrollPane);

        JButton remHighButton = new JButton("REMOVE HIGHLIGHT");
        remHighButton.addActionListener(new ActionListener()
        {
            public void actionPerformed(ActionEvent ae)
            {
                String input = JOptionPane.showInputDialog(frame, "Please Enter Start Index : "
                                                        , "Highlighting Options : "
                                                        , JOptionPane.PLAIN_MESSAGE);

                if (input != null && (highlights.size() > 0))
                {               
                    int startIndex = Integer.parseInt(input.trim());
                    Highlighter highlighter = tarea.getHighlighter();
                    highlighter.removeHighlight(highlights.get(startIndex));
                    tarea.setCaretPosition(startIndex);
                    tarea.requestFocusInWindow();
                    highlights.remove(startIndex);
                }
            }
        });

        JButton button = new JButton("HIGHLIGHT TEXT");
        button.addActionListener(new ActionListener()
        {
            public void actionPerformed(ActionEvent ae)
            {
                String text = null;
                text = tarea.getSelectedText();
                if (text != null && text.length() > 0)
                {
                    int startIndex = tarea.getText().indexOf(text);
                    int endIndex = startIndex + text.length();
                    Highlighter highlighter = tarea.getHighlighter();

                    int selection = JOptionPane.showConfirmDialog(
                                            frame, getOptionPanel(), "Highlight Colour : "
                                                , JOptionPane.OK_CANCEL_OPTION
                                                , JOptionPane.PLAIN_MESSAGE);

                    System.out.println("TEXT : " + text);
                    System.out.println("START INDEX : " + startIndex);
                    System.out.println("END INDEX : " + endIndex);

                    if (selection == JOptionPane.OK_OPTION)
                    {
                        String colour = (String) cbox.getSelectedItem();
                        try
                        {
                            if (colour == colourNames[0])
                            {
                                System.out.println("Colour Selected : " + colour);
                                highlighter.addHighlight(startIndex, endIndex, redPainter);
                            }
                            else if (colour == colourNames[1])
                            {
                                System.out.println("Colour Selected : " + colour);
                                highlighter.addHighlight(startIndex, endIndex, orangePainter);
                            }
                            else if (colour == colourNames[2])
                            {
                                System.out.println("Colour Selected : " + colour);
                                highlighter.addHighlight(startIndex, endIndex, cyanPainter);
                            }
                            Highlighter.Highlight[] highlightIndex = highlighter.getHighlights();
                            System.out.println("Lengh of Highlights used : " + highlightIndex.length);
                            highlights.put(startIndex, highlightIndex[highlightIndex.length - 1]);
                        }
                        catch(BadLocationException ble)
                        {
                            ble.printStackTrace();
                        }
                    }
                    else if (selection == JOptionPane.CANCEL_OPTION)
                    {
                        System.out.println("CANCEL BUTTON PRESSED.");
                    }
                    else if (selection == JOptionPane.CLOSED_OPTION)
                    {
                        System.out.println("JOPTIONPANE CLOSED DELIBERATELY.");
                    }                   
                }
            }
        });

        frame.add(remHighButton, BorderLayout.PAGE_START);
        frame.add(contentPane, BorderLayout.CENTER);
        frame.add(button, BorderLayout.PAGE_END);

        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    private JPanel getOptionPanel()
    {
        JPanel panel = new JPanel();
        panel.setBorder(BorderFactory.createTitledBorder(
                        BorderFactory.createLineBorder(Color.DARK_GRAY, 2), "COLOUR SELECTION"));
        panel.setLayout(new GridLayout(0, 2, 5, 5));

        JLabel colourLabel = new JLabel("Select One Colour : ");
        cbox = new JComboBox(colourNames);

        panel.add(colourLabel);
        panel.add(cbox);

        return panel;
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new TextHighlight().createAndDisplayGUI();
            }
        });
    }
} 
```

输出 ：

**开始 ：** ![开始](../Images/f659658041adc29d5a51204768400110.png)

**突出显示第一行** ![第一行](../Images/a4dbef79539637f1d15a77d3e8a42ed8.png) **第二** ![第二行](../Images/378d12514d5c8f9f87f8180640748010.png)

**移除亮点** ![后](../Images/8b16fe1e2d9f5472899ac3f5b25fd060.png)

***用不同的颜色突出同一条线*** ![再次强调](../Images/0957c994c4c887271dfc0c22f2751dd0.png)

**最新编辑与问题中的示例代码一致**

```
import java.awt.*;
import java.net.MalformedURLException;

import javax.swing.*;
import javax.swing.text.*;

public class Test {
    public static void main(final String[] args) throws MalformedURLException {
        SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
            try {
                init();
            } catch (BadLocationException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }
    });
}

private static void init() throws BadLocationException {
    JFrame frame = new JFrame();
    final JTextArea textArea = new JTextArea();
    JScrollPane pane = new JScrollPane(textArea);
    textArea.setText("Something. Something else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Samething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Sbmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Scmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Sdmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Semething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Sfmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nSomething. Sgmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n");
    textArea.setSelectionColor(Color.RED);
    frame.add(pane);
    frame.setSize(300, 120);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);

    String turnToString2 = "Sdmething else.\nA second line\na third line"
            + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla";
    int pos2 = textArea.getText().indexOf(turnToString2);
    Rectangle startIndex = textArea.modelToView(pos2);
    textArea.getHighlighter().addHighlight(pos2,
            pos2 + turnToString2.length(),
            new DefaultHighlighter.DefaultHighlightPainter(Color.yellow));    
    int y = startIndex.y + (pane.getHeight() - 10);
    System.out.println("Pane Height : " + pane.getHeight());
    System.out.println("X : " + startIndex.x);
    System.out.println("Y : " + y);
    System.out.println("Y (pos2) : " + startIndex.y);
    textArea.setCaretPosition(textArea.viewToModel(new Point(startIndex.x, y)));
    pane.scrollRectToVisible(new Rectangle(startIndex.x, y));
    }
} 
```

这是输出：

![右上](../Images/fa404f48073efc6cba148bfbc6a67477.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-24T22:59:37.507

我认为在使用 Highlighter 的情况下无法更改所有 JTextComponents 的这些方法，但只能更改 Foreground

例如

```
import java.awt.*;
import javax.swing.*;
import javax.swing.text.DefaultHighlighter;

public class TextAreaLineHightLight {

    public static void main(String[] args) throws Exception {
        UIManager.put("TextArea.selectionBackground", Color.yellow);
        UIManager.put("TextArea.selectionForeground", Color.red);

        String string = "Lorem ipsum eum putant gubergren evertitur in, "
                + "no assueverit vituperatoribus eum. Ea cibo offendit vim, est et vivendum qualisque prodesset. "
                + "Vis doctus expetenda contentiones an, no ius mazim epicuri expetendis, "
                + "saperet salutandi forensibus ne usu. Ex fugit alterum usu. "
                + "His ignota cotidieque in, augue erroribus eam no.";
        JTextArea textArea = new JTextArea(string);
        textArea.setLineWrap(true);
        textArea.setWrapStyleWord(true);
        JScrollPane textAreaScroll = new JScrollPane(textArea);
        JFrame frame = new JFrame();
        frame.setLayout(new BorderLayout());
        frame.add(textAreaScroll, BorderLayout.CENTER);
        frame.setSize(400, 300);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
        String term = "qualisque prodesset. "
                + "Vis doctus expetenda contentiones an, no ius mazim epicuri expetendis";
        int termOffset = string.indexOf(term);
        Rectangle view = textArea.modelToView(termOffset);
        int startOffset = textArea.viewToModel(new Point(0, view.y));
        //int rowH = textArea.
        int endOffset = textArea.viewToModel(new Point(textArea.getSize().width, view.y));
        textArea.getHighlighter().addHighlight(startOffset, endOffset, new DefaultHighlighter.DefaultHighlightPainter(Color.YELLOW));
    }
} 
```

JTextPane 的结果相同

```
import java.awt.*;
import javax.swing.*;
import javax.swing.text.*;

public class TextPaneHighlighting extends JFrame {

    private static final long serialVersionUID = 1L;
    private Highlighter.HighlightPainter cyanPainter;
    private Highlighter.HighlightPainter redPainter;

    public TextPaneHighlighting() {
        UIManager.put("TextPane.selectionBackground", Color.yellow);
        UIManager.put("TextPane.selectionForeground", Color.red);
        JTextPane textPane = new JTextPane();
        textPane.setText("one\ntwo\nthree\nfour\nfive\nsix\nseven\neight\n");
        JScrollPane scrollPane = new JScrollPane(textPane);
        getContentPane().add(scrollPane);//  Highlight some text
        cyanPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.cyan);
        redPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.red);
        try {
            textPane.getHighlighter().addHighlight(0, 3, DefaultHighlighter.DefaultPainter);
            textPane.getHighlighter().addHighlight(8, 14, cyanPainter);
            textPane.getHighlighter().addHighlight(19, 24, redPainter);
        } catch (BadLocationException ble) {
        }
    }

    public static void main(String[] args) {
        TextPaneHighlighting frame = new TextPaneHighlighting();
        frame.setDefaultCloseOperation(EXIT_ON_CLOSE);
        frame.setSize(300, 200);
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-24T22:56:46.677

要设置选择背景颜色，请使用 setSelectionColor（如下图所示，但未使用）。

我真的不明白你在说什么，*它总是出现在窗口的底部。我想把它放在顶部*，但我猜（我可能在这里错了）你的文本区域在滚动窗格中，并且通过突出显示文本它滚动到你选择的末尾，所以我建议设置插入符号位置突出显示文本后。

这是我理解的示例。如果这不是您要找的，请告诉我：

```
import java.awt.Color;
import java.net.MalformedURLException;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.SwingUtilities;
import javax.swing.text.BadLocationException;
import javax.swing.text.DefaultHighlighter;

public class Test {
    public static void main(final String[] args) throws MalformedURLException {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                try {
                    init();
                } catch (BadLocationException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

            }
        });
    }

    private static void init() throws BadLocationException {
        JFrame frame = new JFrame();
        final JTextArea textArea = new JTextArea();
        JScrollPane pane = new JScrollPane(textArea);
        textArea.setText("Something. Something else.\nA second line\na third line"
                + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n"
                + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla\nBlabla\n");
        textArea.setSelectionColor(Color.RED);
        frame.add(pane);
        frame.setSize(300, 120);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
        String turnToString = "Something else.\nA second line\na third line"
                + "Blabla\nBlabla\nBlabla\nBlabla\nBlabla";
        final int pos = textArea.getText().indexOf(turnToString);
        textArea.getHighlighter().addHighlight(pos,
                pos + turnToString.length(),
                new DefaultHighlighter.DefaultHighlightPainter(Color.yellow));
        textArea.scrollRectToVisible(new Rectangle(0, 0, pane.getViewport().getWidth(), pane.getViewport().getHeight()));
            SwingUtilities.invokeLater(new Runnable() {
                    @Override
                    public void run() {
                        textArea.setCaretPosition(pos);
                    }
            });
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-25T06:41:19.713

解决 2) 使用 modelToView 获取第一个选定行的点。然后使用 Point 使用 scrollRectToVisible （注意：矩形的高度必须是您的视口高度）。

# vba - 在 Excel 中使用 VBA 连接文本单元格并在工作簿之间复制/粘贴

> ID：10306902
> 
> 赞同：1
> 
> 时间：2012-04-24T22:25:01.553
> 
> 标签：vba, excel

我有两个 Excel 文件：一个包含大量来自 CRM 数据库的原始数据，另一个包含经过清理/组织的数据。我需要将原始数据工作簿中的地址复制到有组织的工作簿中。

问题是原始数据文件将地址存储为两列：一列用于街道/城市/州，另一列用于国家/地区。有组织的工作簿需要街道/城市/州/国家，都在一栏中。所以我需要连接原始数据工作簿中的两列，并将它们粘贴到有组织的工作簿中。像这样：

```
Workbook 1 (Raw Data):
Street/City/State                 Country
1060 W. Addison, Chicago, IL      United States

   |
   v

Workbook 2 (Organized):
Street, City, State, Country
1060 W. Addison, Chicago, IL, United States 
```

我知道如何在工作簿之间复制/粘贴，也知道如何连接两个文本单元格，但我似乎无法让两者一起工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T12:47:00.923

我认为以下建议会对您有所帮助。假设在您的第一个工作簿中，街道/城市/州在 A 列中，而国家在 B 列中，使用这样的基本知识。使用 VBA，您可以通过使用 cell 轻松获取单元格值。

```
Range("A1").Value & " , " & Range("B1").Value 
```

以上将给出结果 1060 W. Addison, Chicago, IL, United States

现在将此值复制到您想要的另一个工作簿中的单元格中。您已经说过您知道如何将值从一个工作簿复制到另一个工作簿。

如果这有助于你投票给我的答案

# ruby-on-rails - 开发中加载缓慢的资产

> ID：10306903
> 
> 赞同：15
> 
> 时间：2012-04-24T22:25:15.963
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, asset-pipeline

我的应用程序中的每个页面请求都会拉下大约 30 个资产（JavaScript 和图像），它们都是 vendor/ 和 app/ 中的第三方内容。当然，所有的 JavaScript 在生产环境中都被合并和缩小，所以在那里很好，但是在开发中，它真的很慢。喜欢 8 秒加载页面，只会变得更糟。这是正常的吗？可以做些什么来加快速度？

我尝试将图像从 assets/ 移动到 public/，但它为它们提供服务的速度同样缓慢。每秒大约 3-4 个文件。

这发生在带有 WEBrick 和 Unicorn 的快速 Macbook Pro 上。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-15T01:47:07.277

关闭资产调试应该会提高一点速度。

```
#development.rb
config.assets.debug = false 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-16T14:25:13.940

最有可能的是，问题在于 Rails 会在每个资产请求上重新加载所有类。这个 gem：[https](https://github.com/wavii/rails-dev-tweaks) ://github.com/wavii/rails-dev-tweaks通过调整 Rails 自动加载规则来解决这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-13T09:12:36.620

我个人使用[瘦](http://code.macournoyer.com/thin/)服务器。还减慢了我的开发环境（花费了我 +- 12 秒）。将它添加到您的 Gemfile 中：

```
group :development do
  gem "thin"
end 
```

捆绑并运行：

```
thin start 
```

在预编译资产之前，我将加载时间降低到 +-5（通过一些配置和代码重构）。希望能帮助到你

![在此处输入图像描述](../Images/a1544f4b09679250bac66a08427a10bc.png)

-source 瘦网站

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T08:22:26.207

当您在文件系统中编辑资产时，您可以查看[guard](https://github.com/guard/guard)及其相关插件，以便在后台预编译资产。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-17T01:55:44.743

我相信 Rails 每次开发时都必须编译资产，而对于生产，它不需要，除了第一次这会导致它的开发缓慢。

# objective-c - 对象与类的实例相同吗？

> ID：10306907
> 
> 赞同：2
> 
> 时间：2012-04-24T22:25:48.117
> 
> 标签：objective-c, oop, terminology

我正在学习Objective-C，我对类的实例和对象之间的区别感到困惑——它们是一样的吗？

这是一个例子：

```
 NSString *name = [[NSString alloc]initWithString:@"Harry"]; 
```

`*name`是指向`NSString`类的指针。`@"Harry"`是字符串的值。那么是`name`来自`NSString`类的对象还是被`name`称为类的实例？

我做的另一个例子：

```
 Rectangle *rect = [[Rectangle alloc]init]; 
```

`*rect`指针也是如此。是`rect`对象还是类的实例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T22:31:11.427

在 ObjectiveC 中，类的实例始终是对象。并且对象始终是类的实例。一个“对象”是一个类的一个实例，这个类在链的某个地方最终继承自`NSObject`. 当你声明一个没有超类的类时，`NSObject`就是隐式超类。

```
NSString *name = [[NSString alloc] initWithString:@"Harry"]; 
```

`name`是一个指向对象的指针，更具体地说，它是一个`NSString`具有“Harry”值的实例。所有 NSString 都是对象。

```
Rectangle *rect = [[Rectangle alloc] init]; 
```

同样在这里。 `rect`是一个指向对象的指针，它是 的一个实例`Rectangle`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T22:29:02.473

> `*rect`指针也是如此。是`rect`对象还是类的实例？

两者兼而有之。一个类的实例也是一个对象，就像我刚吃完的麦金托什是“类”苹果的一个实例，也是一个水果。

“对象”是保持某种状态（其实例变量）并且（通常）可以执行影响该状态（其方法）的编程结构的通用术语。类的实例是*特定*的对象。

在 Objective-C 中，对象是通过指针访问的；这只是您与他们互动的机制。严格来说，对象本身和指向对象的指针是不同的：`rect`是指向对象的指针，是 class 的实例`Rectangle`，但在日常语言中，你可能会看到人们以同样的方式谈论它们：`rect`is a `Rectangle`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T22:42:37.147

指针不是对象。它只是内存中分配（存储）对象的地址。因此，它*指向*对象。指针实际上是一种 C 语言结构，Objective-C 继承了它（请原谅双关语）。Julius 是正确的，您会听到它们可以互换使用，技术上“rect”是实例/对象，“*”表示指向。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T01:01:55.450

> 感谢您的所有回答，但我仍然有点困惑。所以我们说 *rect 只是一个指针。rect 是 Object（它是 Rectangle 类的一个实例）。内存分配给rect。

@pete 是的，你说得对。

# android - 无法从 sharedpreferences 中获取价值

> ID：10306908
> 
> 赞同：1
> 
> 时间：2012-04-24T22:25:51.390
> 
> 标签：android, sharedpreferences

我想从下面定义的 sharedpreference 中加载 Name 的值，但我不能。如何提取 Name 的值并将其吐司或理想情况下将其放在文本字段中？

```
public class FillingActivity extends Activity{

TextView username;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.foodandexercise);

    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(getBaseContext());

    String user = prefs.getString("namepref", "");
    Toast.makeText(FillingActivity.this, user, Toast.LENGTH_LONG).show();

    username = (TextView) findViewById(R.id.loggedastoedit);
    username.setText("najib");

} 
```

}

这是我的 SharedPreferences 类

公共类 ProfilePreferenceActivity 扩展 Activity {

```
DatabaseAdapter usertable = new DatabaseAdapter(this);

float calnum, bmr;
String level, gender;
int Age, Height, Weight, temp;
RadioButton rb_male;
RadioButton rb_female;
RadioButton rb_light;
RadioButton rb_moderate;
RadioButton rb_heavy;
EditText name;
EditText age, weight, height;
RadioGroup genderradiogroup;
RadioGroup levelofactivity;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.createprofile);
    SharedPreferences customSharedPreference = getSharedPreferences(
            "myCustomSharedPrefs", Activity.MODE_PRIVATE);

    name = (EditText) findViewById(R.id.namefield);
    name.setText("");
    age = (EditText) findViewById(R.id.agefield);
    age.setText("");

    genderradiogroup = (RadioGroup) findViewById(R.id.radioGroup2);
    rb_male = (RadioButton) findViewById(R.id.maleradiobutton);
    rb_female = (RadioButton) findViewById(R.id.femaleradiobutton);
    genderradiogroup.check(customSharedPreference.getInt("genderprefs",
            rb_male.getId()));
    genderradiogroup.check(customSharedPreference.getInt("genderprefs",
            rb_male.getId()));

    weight = (EditText) findViewById(R.id.weightfield);
    weight.setText("");
    height = (EditText) findViewById(R.id.heightfield);
    height.setText("");

    levelofactivity = (RadioGroup) findViewById(R.id.radioGroup3);
    rb_light = (RadioButton) findViewById(R.id.lightradiobutton);
    rb_moderate = (RadioButton) findViewById(R.id.moderateradiobutton);
    rb_heavy = (RadioButton) findViewById(R.id.heavyradiobutton);
    levelofactivity.check(customSharedPreference.getInt("levelpref",
            rb_light.getId()));

    try {
        Age = Integer.parseInt(age.getText().toString());
        Weight = Integer.parseInt(weight.getText().toString());
        Height = Integer.parseInt(height.getText().toString());
    } catch (Exception e) {
    }

    Button addUser = (Button) findViewById(R.id.checkcreateprofilebutton);

    addUser.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            savePreferences();

            float calnumber = calculateCalories(Age, Weight, Height);
            String lala = String.valueOf(calnumber);
            Toast.makeText(ProfilePreferenceActivity.this, lala,
                    Toast.LENGTH_LONG).show();

            usertable.open();
            long id = usertable.createUser(name.getText().toString(), age
                    .getText().toString(), gender, weight.getText()
                    .toString(), height.getText().toString(), level,
                    calnumber);

            Toast.makeText(ProfilePreferenceActivity.this,
                    "user added with" + level + gender, Toast.LENGTH_LONG)
                    .show();

            usertable.close();

            Intent Filling = new Intent();
            Filling.setClass(ProfilePreferenceActivity.this,
                    FillingActivity.class);
            startActivity(Filling);

        }
    });

}

private void savePreferences() {

    SharedPreferences customSharedPreference = getSharedPreferences(
            "myCustomSharedPrefs", Activity.MODE_PRIVATE);
    SharedPreferences.Editor editor = customSharedPreference.edit();
    editor.putString("namepref", name.getText().toString());
    editor.putString("agepref", age.getText().toString());
    editor.putInt("genderprefs", genderradiogroup.getCheckedRadioButtonId());
    editor.putString("heightpref", height.getText().toString());
    editor.putString("weightpref", weight.getText().toString());
    editor.putInt("levelpref", levelofactivity.getCheckedRadioButtonId());
    editor.putFloat("calpref", calnum);
    editor.commit();
    finish();

}

public float calculateCalories(int age, int weight, int height) {

    if (rb_male.isChecked()) {

        gender = "male";

        bmr = 66.5f + (13.75f * weight) + (5.003f * height)
                - (6.755f * age);

        if (rb_light.isChecked()) {
            level = "light";
            calnum = bmr * 1.375f;
        }
        if (rb_moderate.isChecked()) {
            level = "moderate";
            calnum = bmr * 1.55f;
        }
        if (rb_heavy.isChecked()) {
            level = "heavy";
            calnum = bmr * 1.725f;
        }

    } else if (rb_female.isChecked()) {

        gender = "female";

        bmr = 665 + (9.563f * weight) + (1.850f * height) - (4.676f * age);

        if (rb_light.isChecked()) {
            level = "light";
            calnum = bmr * 1.375f;
        }
        if (rb_moderate.isChecked()) {
            level = "moderate";
            calnum = bmr * 1.55f;
        }
        if (rb_heavy.isChecked()) {
            level = "heavy";
            calnum = bmr * 1.725f;
        }

    }
    return calnum;

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:51:01.443

您应该使用`getDefaultSharedPreferences()`或`getSharedPreferences("myCustomSharedPrefs",...)`在两个地方都使用。

这样，您创建（AFAIK）不同的共享首选项并且无法读取您写入另一个的数据。

# c# - 控制 ListBox 滚动行为

> ID：10306910
> 
> 赞同：1
> 
> 时间：2012-04-24T22:25:57.163
> 
> 标签：c#, wpf, xaml, listbox, scrollviewer

Adam Nathan 的“WPF 4 Unleashed”的第 10 章包含了这个控制`ListBox`滚动行为的 XAML 示例：

```
<Window x:Class="NathanControllingScrollingBehavior.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">

    <ListBox ScrollViewer.HorizontalScrollBarVisibility="Disabled"
             ScrollViewer.VerticalScrollBarVisibility="Disabled"
             ScrollViewer.CanContentScroll="False"
             ScrollViewer.IsDeferredScrollingEnabled="True">
        ...
    </ListBox>

</Window> 
```

书中没有等效的 C# 示例。我做了一些研究，发现了一些迂回的方法来做到这一点。有关对我有用的两种方法，请参阅[此 SO question](https://stackoverflow.com/questions/10293236/accessing-the-scrollviewer-of-a-listbox-from-c-sharp#comment13246045_10293236)。然而，这些方法似乎有点骇人听闻。在 XAML 中调整这些属性非常简单，但在 C# 中却很尴尬。

这仅仅是 WPF 的一个区域，仅用于 XAML 而不是 C#？谁能解释 XAML/C# 之间这些属性的易用性差异？这只是 WPF 团队的疏忽吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T01:54:13.210

你可以这样做。

```
ListBox listBox1 = new ListBox();

listBox1.SetValue(ScrollViewer.HorizontalScrollBarVisibilityProperty,
ScrollBarVisibility.Disabled);

listBox1.SetValue(ScrollViewer.VerticalScrollBarVisibilityProperty, 
ScrollBarVisibility.Disabled);

listBox1.SetValue(ScrollViewer.CanContentScrollProperty, false);

listBox1.SetValue(ScrollViewer.IsDeferredScrollingEnabledProperty, true); 
```

# perl - 如何在 perl 中取消导入函数？

> ID：10306916
> 
> 赞同：6
> 
> 时间：2012-04-24T22:26:30.227
> 
> 标签：perl

我正在尝试删除导入的符号，以便它们不能作为对象中的方法使用，但`no`似乎不起作用，也许我不明白，或者还有另一种方法。

```
use 5.014;
use warnings;
use Test::More;

# still has carp after no carp
package Test0 {
    use Carp qw( carp );
    sub new {
        my $class = shift;
        my $self  = {};

        carp 'good';

        bless $self, $class;
        return $self;
    }
    no Carp;
}

my $t0 = Test0->new;

ok( ! $t0->can('carp'), 'can not carp');

# below passes correctly
package Test1 {
    use Carp qw( carp );
    use namespace::autoclean;

    sub new {
        my $class = shift;
        my $self  = {};

        carp 'good';

        bless $self, $class;
        return $self;
    }
}
my $t1 = Test1->new;
ok( ! $t1->can('carp'), 'can not carp');
done_testing; 
```

不幸的是，我不能使用[namespace::autoclean](https://metacpan.org/module/namespace::autoclean)，因为我被限制在仅作为核心 perl 一部分的模块（是的，愚蠢但 c'est la vie）。

不只是重写`namespace::autoclean`有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-24T22:50:06.663

我相信 namespace::autoclean 会删除 glob：

```
delete $Test0::{carp}; 
```

无需对包进行硬编码：

```
my $pkg = do { no strict 'refs'; \%{ __PACKAGE__."::" } };
delete $pkg->{carp}; 
```

如果你坚持要保持严格，你可以愚弄严格（但它或多或少不安全）：

```
my $pkg = \%::;
$pkg = $pkg->{ $_ . '::' } for split /::/, __PACKAGE__;
delete $pkg->{carp}; 
```

PS——如果来自 CPAN 的代码不可接受，为什么来自 StackOverflow 的代码可以接受？

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-24T22:49:01.130

我知道这并不能直接回答您的问题，但一个简单的解决方法是首先不导入函数。这将工作得很好：

```
use Carp ();  # import nothing

Carp::carp 'good'; 
```

# php - 不插入数据库

> ID：10306931
> 
> 赞同：-4
> 
> 时间：2012-04-24T22:28:48.637
> 
> 标签：php, mysql

由于某种原因，我的 bookingDate 的帖子值没有被放入数据库中，我不确定为什么。

在控制台里面是 post 变量。预订日期 04/25/2012 14:36

在数据库 bookingDate 日期时间

```
/**
 * Book Event
 *
 * @param   string
 * @param   integer
 * @param   date
 * @param   string
 * @param   string
 * @param   text
 * @return  bool
 */
function bookEvent($eventName, $label, $bookingDate, $location, $arena, $introduction)
{       
    $data = array(
        'eventsNamesListID' => $eventName,
        'label' => $label,
        'bookingDate' => $bookingDate,
        'location' => $location,
        'eventsArenasListID' => $arena,
        'eventsStatusesID' => 1,
        'introduction' => $introduction
    );

    $this->db->insert('events', $data);
    return true;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:42:07.700

是的......那么合适的日期时间 2012-04-25 14:36:00 怎么样？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-24T22:35:09.047

将其传递给函数时是否`$bookingDate`已初始化？

在调用函数之前，您需要使用这样的行手动将 分配`$_POST['bookingDate']`给变量。`$bookingDate``bookEvent()`

`$bookingDate = $_POST['bookingDate'];`

在任何情况下，您都应该`echo $bookingDate;`在调用您的函数之前，以便我们可以验证它`$bookingDate`持有您期望它为您的数据库插入提供的值。

# html - 为什么我的浏览器有时无法识别服务器的标头？

> ID：10306938
> 
> 赞同：1
> 
> 时间：2012-04-24T22:29:32.497
> 
> 标签：html, c, web-services, http

如果我的浏览器尝试对不在我服务器上的文件执行 HTTP GET，我只写

> 未找到 HTTP/1.0 404\r\n\r\n

到港口。在浏览器的 Web 控制台中，我可以看到有时会识别出错误，但有时却不会。相反，文本将显示在浏览器窗口中。为什么会这样？

如果我使用 curl 响应总是一样的，那么为什么它在浏览器中这样做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:42:27.560

似乎大多数网络浏览器都期望`Content-Length:`所有响应中的标头。即使您没有回复任何内容；这很有趣，因为唯一的强制性标头`Host:`仅在请求中且仅适用于 HTTP 1.1。

我用 Firefox 进行了测试，我必须写下以下内容才能使其工作：

```
HTTP/1.0 404 Not Found\r\n
Content-Length: 0\r\n\r\n 
```

然后浏览器应该关闭连接。如果您使用 libcurl，它可能也会插入此标头和其他标头，`Date:`例如。

# c# - 如何使用门面按需进行依赖注入？

> ID：10306939
> 
> 赞同：0
> 
> 时间：2012-04-24T22:29:32.373
> 
> 标签：c#, dependency-injection, unity-container

我有一个这样的 Web 服务外观：

```
interface MyWebServices
{
    ReportsService.Conversion[] Conversions();
    ExportService.Advertiser[] ExportAdvertisers();
}

public class MyWebServices : IMyWebServices
{
    private string apiKey;

    public CakeWebService(string apiKey)
    {
        this.apiKey = apiKey;
    }

    public ExportService.Advertiser[] ExportAdvertisers()
    {
        var service = new ExportService.export();
        int advertiserID = 0;
        var advertisers = service.Advertisers(this.apiKey, advertiserID);
        return advertisers;
    }

    public ReportsService.Conversion[] Conversions()
    {
        var target = new ReportsService.reports();
        DateTime from = new DateTime(2012, 1, 1);
        DateTime to = DateTime.Now.AddDays(1);
        int affiliateID = 0;
        int offerID = 0;
        var conversions = target.ConversionExport(this.apiKey, from, to, affiliateID, offerID, false);
        return conversions;
    }
} 
```

每个方法都会创建一个 Web 服务实例，然后在调用之前对其进行配置。

我宁愿让我的 UnityContainer 做这个配置，但我想要像“**按需方法注入**”这样的东西......

我认为这可能是使用拦截扩展的好选择，但我无法知道这是否真的是一个可行的方案 - 这是一个合理的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T13:16:29.630

解决方案对我来说看起来很简单，为什么不创建`IReportService`并`IExportService`让统一将具体实现注入服务，然后稍微重构您的类，使其看起来像这样：

```
public interface IExportService
{
    ExportService.Advertiser[] ExportAdvertisers();
}

public class ConcreteExportService : IExportService
{
  public ExportService.Advertiser[] ExportAdvertisers()
    {
        var service = new ExportService.export();
        int advertiserID = 0;
        var advertisers = service.Advertisers(this.apiKey, advertiserID);
        return advertisers;
    }
}

public interface IReportService
{
    ReportsService.Conversion[] Conversions();
}

public class ConcreteReportService : IReportService
{
    public ReportsService.Conversion[] Conversions()
    {
        var target = new ReportsService.reports();
        DateTime from = new DateTime(2012, 1, 1);
        DateTime to = DateTime.Now.AddDays(1);
        int affiliateID = 0;
        int offerID = 0;
        var conversions = target.ConversionExport(this.apiKey, from, to, affiliateID, offerID, false);
        return conversions;
    }
}

public class MyWebServices : IMyWebServices
{
    private string apiKey;
    private  IExportService _exportService;
    private  IReportService _reportService;

    public MyWebServices(
        IExportService exportService,
        IReportService reportService)
    {
        this._exportService = exportService;
        this._reportService = reportService;
    }

    public ExportService.Advertiser[] ExportAdvertisers()
    {
       return this._exportService.ExportAdvertisers();
    }

    public ReportsService.Conversion[] Conversions()
    {
       return this._reportService.Conversions();
    }

    public CakeWebService(string apiKey)
    {
        this.apiKey = apiKey;
    }      
} 
```

# jquery - 文本框输入导致回发或重定向？

> ID：10306940
> 
> 赞同：1
> 
> 时间：2012-04-24T22:29:32.567
> 
> 标签：jquery, asp.net, updatepanel

我在 asp.net 中有一个文本框和一个按钮，它包含在更新面板中，如下所示：

```
 <asp:UpdatePanel ID="UpdatePanel21" runat="server" UpdateMode="Always" >
             <ContentTemplate>
                <asp:TextBox ID="txtLIDescription" runat="server" Columns="50">
                </asp:TextBox>
                 &nbsp;<asp:Button ID="btnAddLineItem" runat="server" onclick="btnAddLineItem_Click" 
                     Text="Add" ToolTip="Add line item." UseSubmitBehavior="false" />
                        </ContentTemplate>
        </asp:UpdatePanel> 
```

如果我单击按钮，一切都会按预期工作。但是当我按回车键（我认为我的用户会这样做）时，系统似乎会回帖。我试图使用 jquery 来避免它：

```
 $('#LineItemContent_txtLIDescription')
         .livequery('keyup', function (event) {
             if (event.keyCode == 13) {
                 $('#LineItemContent_btnAddLineItem').focus();
                 $('#LineItemContent_btnAddLineItem').click();
             }
             $("#LineItemContent_btnAddLineItem").button();
         }); 
```

如果我放置一个，`alert("hello world");`我看到它已进入 if 条件，因此它知道已单击输入。然后我希望将焦点设置在按钮上，然后让它单击按钮，就像普通最终用户单击按钮一样。没有似乎回帖。

我尝试添加：

```
event.preventDefault();
return false; 
```

在 jquery 中希望这会避免它，不是同样的事情。我什至尝试了 ASP.net 标记并添加了

`UseSubmitBehavior=false`

该页面似乎仍在回发。这是因为它位于更新面板中吗？有没有其他办法解决这个问题？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:34:55.070

您可以尝试将`UpdatePanel`a 的内容包装起来`Panel`并将其[`DefaultButton`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.panel.defaultbutton.aspx)属性设置为`btnAddLineItem`.

**编辑**：“问题是为什么这个工作......”

首先是您的问题的原因：当您按下回车键时，表单中的第一个按钮将被单击，这不是 ASP.NET 特定的，这是正常行为。但是，仅当导致回发的控件位于 UpdatePanel 内时，UpdatePanel 才会执行异步回发。否则，您需要`AsyncPostBackTrigger`为该控件明确指定一个。

我的方法有效，因为它确保当用户单击该面板内的输入时单击相应的按钮（在 UpdatePanel 内）。这会根据需要导致异步回发。

这不是 hack，而是 ASP.NET 2.0 中引入的一个有用功能。您的代码保持可读性，您不需要使用“javascript hacks”。

# php - 如何在不增加的情况下按字母顺序获取下一个字母？(php)

> ID：10306944
> 
> 赞同：4
> 
> 时间：2012-04-24T22:29:47.247
> 
> 标签：php, increment, letters

```
for ($i=A;$i<L;$i++){                   
    echo $i;
    echo '->';
    echo ++$i;
    echo ', ';
} 
```

给我：

> A->B, C->D, E->F, G->H, I->J, K->L

我想要的是：

> A->B, B->C, C->D, D->E, E->F, F->G

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T22:32:52.003

简单的：

```
for ($i=A;$i<L;){  // remove loop increment                 
    echo $i;
    echo '->';
    echo ++$i;
    echo ', ';
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T22:35:41.730

使用 range() 将字母表作为数组获取，然后使用适当的 int i++ 增量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T22:33:18.457

如何在递增之前复制值：

```
for ($i = 'A'; $i < 'L'; $i++) {                   
    $j = $i;
    $j++;
    echo "$i->$j, ";
} 
```

附言。你真的应该引用你的字符串常量。否则，您的日志将充满如下警告：

```
PHP Notice:  Use of undefined constant A - assumed 'A' in - on line 2
PHP Notice:  Use of undefined constant L - assumed 'L' in - on line 2 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T22:56:39.013

正如 Julien 所提到的，范围很性感：

```
$range = range('A', 'L');

// Had to subtract one from loop iteration total, otherwise the $i + 1 
// would throw an undefined index notice
for ($i = 0, $count = count($range); $i < ($count - 1); $i++) {
    echo sprintf('%s->%s,', $range[$i], $range[($i + 1)]);
} 
```

[有关范围](http://us3.php.net/range)的更多信息。

# java - Android蓝牙上的数据格式

> ID：10306952
> 
> 赞同：1
> 
> 时间：2012-04-24T22:30:47.520
> 
> 标签：java, android, bluetooth, arduino

我正在尝试通过蓝牙将数据从 Android 应用程序发送到 Arduino 板。我的字节测试字符串是 255、0、1、2、3、4、5。但是，接收到的字符串是 255、1、2、32、80。这让我相信数据格式不同。我知道 Arduino 板正在寻找 8 个数据位、1 个停止位、无奇偶校验位格式的数据。顺便说一下，接收到的数据是倾斜的，Android 应用程序似乎忽略了停止位。有没有办法在Android端设置数据格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T02:24:49.437

我使用了 sparkfun 的蓝牙调制解调器，当我将它与 tx/rx 引脚一起使用时，它可以找到，但如果我使用 SoftSerial 和其他一些引脚，当我的 android 应用程序发送太多数据时，它会读取垃圾。我还必须从计算机上拔下 USB。

为了让它第一次工作，我花了很多时间设置调制解调器以匹配我想使用的应用程序，而 blueterm 程序似乎总是能计算出波特率和其他停止位 / 等等。

# linux - 如何创建 .git 文件

> ID：10306959
> 
> 赞同：3
> 
> 时间：2012-04-24T22:31:36.697
> 
> 标签：linux, git, centos

我的团队将他们的存储库作为 .git 文件放在文件系统的各个位置，我们不使用 git 服务器。如何从现有资源创建 .git 文件？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-24T22:59:02.200

简单的回答：

```
cd my_source_dir
git init
git add .
git commit -m "initial commit" 
```

现在您可以访问同一文件系统的朋友可以使用以下命令克隆它：

```
git clone /path/to/my_source_dir new_tree_name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-02T08:50:35.613

我想你的意思是“使用 gitosis 分享” [http://www.jedi.be/blog/2009/05/06/8-ways-to-share-your-git-repository/#gitosis](http://www.jedi.be/blog/2009/05/06/8-ways-to-share-your-git-repository/#gitosis)

> 将本地仓库推送到 gitosis 服务器

```
> $ cd project-X 
> $ git remote add origin gitosis@gitosis-server:project-X.git 
> $ git push origin master:refs/heads/master 
```

> 这将在 /var/lib/gitosis/repositories/ 下创建一个目录 project-X
> 
> 访问存储库 这里没什么特别的。如果您的密钥已添加到 gitosis-admin 存储库，那么您可以访问它。

```
> $ git clone gitosis@gitosis-server:project-X.git 
```

# java - 在 Netbeans 平台中使用自定义 NotifyDescriptor

> ID：10306967
> 
> 赞同：2
> 
> 时间：2012-04-24T22:32:18.490
> 
> 标签：java, swing, netbeans, netbeans-platform

我已经学会了使用 NotifyDescriptor 创建一个弹出对话框。我设计了一个带有两个大按钮的JPanel，它们读取`PURCHASE`和`CASHOUT`，我使用的代码在底部显示了另外两个按钮，读取`Yes`和`No`。我不希望 NotifyDescriptor 将自己的按钮放在屏幕上。我只希望我的按钮在那里，并且当单击我的自定义按钮之一时弹出窗口会关闭并存储值。（就像单击`yes`或`no`单击时它如何关闭窗口一样）。我正在使用的代码如下

```
       // 创建面板实例，扩展 JPanel...
        ChooseTransactionType popupSelector = new ChooseTransactionType();

        // 创建自定义NotifyDescriptor，指定面板实例为参数+其他参数
        NotifyDescriptor nd = 新的 NotifyDescriptor(
                popupSelector, // 面板实例
                "Title", // 对话框的标题
                NotifyDescriptor.YES_NO_OPTION, // 是/否对话框 ...
                NotifyDescriptor.QUESTION_MESSAGE, // ... 问题类型 => 一个问号图标
                null, // 我们已经指定 YES_NO_OPTION => 可以为空，选项由 L&F 指定，
                      // 否则将选项指定为：
                      // new Object[] { NotifyDescriptor.YES_OPTION, ... etc. },
                NotifyDescriptor.YES_OPTION //默认选项是“是”
        );

        // 现在让我们显示对话框...
        if (DialogDisplayer.getDefault().notify(nd) == NotifyDescriptor.YES_OPTION) {
            // 用户点击是，在这里做一些事情，例如：
                System.out.println(popupSelector.getTRANSACTION_TYPE());
        }

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T01:28:00.993

为了替换`options`按钮上的文本，您可以传入 a`String[]`作为`options`参数，或者，如果您需要更多控制，可以传入 a `JButton[]`。因此，在您的情况下，您需要从面板中删除按钮并`message`传入 a参数。`String[]``options`

对于`initialValue`（最后一个参数），`NotifyDescriptor.YES_OPTION`您可以使用您的任何一个`String[]`值（Purchase 或 Cashout），而不是使用。该`DialogDisplayer.notify()`方法将返回选择的任何值。所以，在这种情况下，它会返回 a`String`但如果你传入 a`JButton[]`那么返回的值将是 a `JButton`。

```
String initialValue = "Purchase";
String cashOut = "Cashout";
String[] options = new String[]{initialValue, cashOut};

NotifyDescriptor nd = new NotifyDescriptor(
            popupSelector,
            "Title",
            NotifyDescriptor.YES_NO_OPTION,
            NotifyDescriptor.QUESTION_MESSAGE,
            options,
            initialValue
    );

String selectedValue = (String) DialogDisplayer.getDefault().notify(nd);
if (selectedValue.equals(initialValue)) {
    // handle Purchase
} else if (selectedValue.equals(cashOut)) {
    // handle Cashout   
} else {
    // dialog closed with top close button
} 
```

# iphone - 如何强制键盘保持显示？

> ID：10306968
> 
> 赞同：0
> 
> 时间：2012-04-24T22:32:42.870
> 
> 标签：iphone, xcode

我有一个 IBAction，当有人在字段中输入文本时调用它。然后我验证输入。如果我确定有错误，我会显示一条消息并希望用户再次输入相同的字段。我不想让他们选择文本字段来调出键盘（效果很好），我只想让键盘显示。

我正在做`[SymbolEntered becomeFirstResponder];`IBAction 中的最后一条语句，但键盘仍然消失了。我把它放错地方了吗？任何帮助，将不胜感激。谢谢。

```
- (IBAction)textFieldDoneEditing:(id)sender {

    DebugMsg.text = nil;
    DebugMsg2.text = nil;
    DebugMsg3.text = nil;

    NSLog (@"done editing");
    NSLog (@"%@", SymbolEntered.text);

    if ([SymbolEntered.text isEqualToString:nil])
    {
        Result.textColor = [UIColor redColor];
        Result.text = @"You must enter a symbol!";
        [SymbolEntered becomeFirstResponder];
    }
    else 
    {
        if ([SymbolEntered.text isEqualToString: 
             [NSString stringWithCString:elements_table2[el_tbl_idx-1].element_symbol]])
        {
            correct_count++;
            Result.textColor = [UIColor greenColor];
            Result.text = @"Correct!";
            Score.hidden = FALSE;
            Score.text = [NSString stringWithFormat:@"Score: %d out of %d - %d Percent", correct_count, el_count+1,
                                        (correct_count*100)/(el_count+1)];
            GetNextElementButton.hidden = FALSE;
            SymbolEntered.enabled = FALSE;
            el_count++;
            attempts = max_tries + 1;
        } 
        else 
        {
            Score.hidden = TRUE;
            Result.textColor = [UIColor redColor];
            if (attempts < max_tries)
            {
                if (attempts+1 == max_tries)
                {
                    Result.text = @"Sorry, one more try -";
                }
                else
                {    
                    Result.text = @"Sorry, try again - ";
                }
                GetNextElementButton.hidden = TRUE;
                attempts++;
            }
            else
            {    
                Result.text = [[NSString alloc] initWithFormat: @"Sorry.  The correct answer is %@", 
                   [NSString stringWithCString:elements_table2[el_tbl_idx-1].element_symbol]];
                Score.hidden = FALSE;
                Score.text = [NSString stringWithFormat:@"Score: %d out of %d - %d Percent", correct_count, el_count+1,                      (correct_count*100)/(el_count+1)];
                GetNextElementButton.hidden = FALSE;
                SymbolEntered.enabled = FALSE;
                el_count++;
            }
        }
    }   

    [SymbolEntered becomeFirstResponder];        

    NSLog (@"end of textfieldoneediting");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T04:21:12.417

您可以在 UITextField textFieldShouldEndEditing: 委托方法中进行验证。如果您从该回调中返回 NO，则文本字段将保持为第一响应者，并且键盘不会消失。（当然，如果还没有，您必须将控制器对象设为文本字段的委托。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:15:07.267

稍后尝试调用 [textField becomeFirstResponder]？还要确保 UITextField 指针不是 nil 或其他东西。如需更多帮助，请显示您的一些代码，很难说出问题出在哪里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T08:27:57.217

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField
{
   [textField resignFirstResponder];
   return YES;
} 
```

试试这个它会退出键盘。

# javascript - 页面上有多个 JS 按钮，页面上有翻转状态

> ID：10306979
> 
> 赞同：0
> 
> 时间：2012-04-24T22:33:41.433
> 
> 标签：javascript

我只是在学习 JS，以便我可以拥有具有翻转状态和音效的按钮。我做得很好，直到我厌倦了添加额外的按钮，这导致我失去了翻转状态。

你可以在这里看到我的一个按钮的例子：[http ://www.ultralaboratories.com/sound1.html](http://www.ultralaboratories.com/sound1.html)

这里有两个按钮：[http ://www.ultralaboratories.com/sound2.html](http://www.ultralaboratories.com/sound2.html)

为简单起见，我使用了完全相同的按钮两次，但完成后会有 5 个独特的按钮。

有什么想法吗？谢谢！

```
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
title>Untitled Document</title>
   <audio id="audio_element" src="sound.mp3"></audio>
<script>
    var audio = document.getElementById("audio_element");
    audio.volume = 0;
    audio.play();

    function playAudio() {

        audio.currentTime = 0.01;
        audio.volume = 1;
        audio.play();

    }
</script>

<SCRIPT LANGUAGE="JavaScript">
  <!-- hide from non JavaScript Browsers

  Rollimage = new Array()

  Rollimage[0]= new Image(156,311)
 Rollimage[0].src = "/Images/Banner/e.up.jpg"

  Rollimage[1] = new Image(156,311)
  Rollimage[1].src = "/Images/Banner/e.over.jpg"

  function SwapOut(){
    document.element.src = Rollimage[1].src;
   return true;
  }

  function SwapBack(){
  document.element.src = Rollimage[0].src; 
    return true;
 }

// - stop hiding          --> 
</SCRIPT>

</head>

<body>
<div onmouseover="playAudio()">
<P align="center"> 
<A HREF="http://www.joemaller.com/" onmouseover="SwapOut()" onmouseout="SwapBack()">     <IMG SRC="/Images/Banner/e.up.jpg" NAME="element" WIDTH=156 HEIGHT=311 BORDER=0> </A> 
<A HREF="http://www.joemaller.com/" onmouseover="SwapOut()" onmouseout="SwapBack()">     <IMG SRC="/Images/Banner/e.up.jpg" NAME="element" WIDTH=156 HEIGHT=311 BORDER=0> </A>

</P>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:42:18.840

您在文档中结合了 HTML5 和 HTML3.2……这真的很糟糕。

首先，从旧浏览器中隐藏 JavaScript 表明您仍然生活在 90 年代。它不再需要了。

其次，当你问 JavaScript 时`document.element`，你指的是哪一个？如果只有一个，那没关系，因为它可以猜测。有两个或更多，它不能。要知道悬停在哪个图像上，请将其`this`作为参数传递给`SwapOut`and `SwapBack`（即。`onmouseover="SwapOut(this)"`）。然后接受该论点并从中获取图像。在这种情况下，`elm.children[0]`可以正常工作（假设您将参数命名为`elm`）。结果函数：

```
function SwapOut(elm) {elm.children[0].src = Rollimage[1].src;}
function SwapBack(elm) {elm.children[0].src = Rollimage[0].src;} 
```

（您甚至可以将这两个函数合二为一，并将`1`or`0`作为第二个参数）

然后是关于一般布局的一些事情：当它是一个身体元素时，你在头部有音频元素。您无缘无故地以零音量播放声音。您可以将 移到`getElementById`函数中以避免不必要的全局变量。

`<!DOCTYPE html>`最后，如果您想使用 HTML5 元素，则必须使用 HTML5 文档类型（即）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:50:02.773

对于图像部分，一种更现代的处理方式是改用 CSS。你以前听说过 CSS 精灵吗？他们太棒了！他们需要一点图像制作，但这是值得的。您可以将多个按钮（或按钮背景、箭头、图形标题等）放入一个大精灵中，这样可以减少 HTTP 请求。

```
<!-- HTML -->
<a href="#" class="btn" id="someBtn">button</a>
<a href="#" class="btn" id="someOtherBtn">button</a> 
```

下面的示例假设您的图像有两个按钮状态堆叠在一起（常规和悬停）。在悬停/焦点和ouila上重新定位背景图像！交互性。您还可以使用通用类定位多个按钮，然后按 ID 调整大小/位置。

```
/* CSS */
a.btn {
   background: transparent url(images/some-button-sprite.png) no-repeat;
   display:block;
}
a#someBtn {
   background-position:0 0;
   height:25px;
   width:100px;
}
a#someBtn:hover,
a#someBtn:focus {
   background-position: 0 -26px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:41:39.570

尝试添加

```
onmouseover="playAudio()" 
```

到每个 img 而不是 div。

```
<IMG SRC="/Images/Banner/e.up.jpg" NAME="element" WIDTH=156 HEIGHT=311 BORDER=0 onmouseover="playAudio()" \>

<IMG SRC="/Images/Banner/e.up.jpg" NAME="element" WIDTH=156 HEIGHT=311 BORDER=0 onmouseover="playAudio()" \> 
```

不要忘记关闭您的图像标签`\>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T22:43:38.390

将 id 添加到图像中，然后将这些图像 id 传递到您的交换函数中：

```
<A HREF="http://www.joemaller.com/" onmouseover="SwapOut('image1')" onmouseout="SwapBack('image1')">
    <IMG ID="image1" SRC="/Images/Banner/e.up.jpg" NAME="element" WIDTH=156 HEIGHT=311 BORDER=0>
</A> 
<A HREF="http://www.joemaller.com/" onmouseover="SwapOut('image2')" onmouseout="SwapBack('image2')">
    <IMG ID="image2" SRC="/Images/Banner/e.up.jpg" NAME="element" WIDTH=156 HEIGHT=311 BORDER=0>
</A>

function SwapOut( id )
{
    document.getElementById( id ).src = Rollimage[1].src;
    return true;
}

function SwapBack( id )
{
    document.getElementById( id ).src = Rollimage[0].src; 
    return true;
} 
```

​</p>

# c# - 如何从 C# 中的 TextBox 加载 SQL 数据源？

> ID：10306983
> 
> 赞同：0
> 
> 时间：2012-04-24T22:34:14.300
> 
> 标签：c#, sql, connection, sqlconnection

我正在开发一个程序，我需要为我的数据库连接制作一个设置表单。我停在如何从文本框中设置连接字符串。这是我的代码：

在设置表单中：

```
public string adresa_servera()
        {    
            return textBox1.Text;
        } 
```

此文本框中的文本为：MICHAL-PC\SQLEXPRESS

在我的主要表格中，我使用：

```
db_nastavenia nastavenia = new db_nastavenia(); //db_nastavenia is the name of the settings Form

string x = nastavenia.adresa_servera();

SqlConnection databaza = new SqlConnection();
databaza.ConnectionString = "Data Source=" + x + ";Initial Catalog=ZBERUDAJOVTEPLA;Persist Security Info=False;User ID=sa; password=diplomovka"; 
```

x 我从设置表单的文本框中加载文本。

当我通过手动输入这样的连接字符串来尝试它时，它运行良好：

```
databaza.ConnectionString = "Data Source=MICHAL-PC\\SQLEXPRESS;Initial Catalog=ZBERUDAJOVTEPLA;Persist Security Info=False;User ID=sa; password=diplomovka"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:57:33.583

Michal，如果这是整个代码并且您没有为文本框设置默认值，那么它不起作用也就不足为奇了。您需要在对某些事件做出反应时检索该值，例如当您按下某个按钮时......或者可能监控 OnTextChanged 事件......

此示例显示您创建一些表单并立即尝试检索一个值。那行不通，因为文本框还没有任何价值。

**编辑：** 那些双双斜杠给你带来了这些问题。不知道它在哪里应用这个转义逻辑，它可能是你设置的一些设置，但有一个简单的解决方案：

```
string x = nastavenia.adresa_servera().Replace("\\", "\"); 
```

如果这对您有帮助，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:25:56.473

嗨，你可以这样做：

```
try
            {
               string x = TextBox1.Text;
               string Connection ="Data Source=" + x + ";Initial Catalog=ZBERUDAJOVTEPLA;Persist Security Info=False;User ID=sa; password=diplomovka";
                using (var conn = new SqlConnection(Connection))
                {
                    using (var cmd = new SqlCommand("Select * from Yourtable", conn))
                    {

                        try
                        {
                            conn.Open(); 

                        }
                        catch (SqlException)
                        {
                            throw;
                        }
                        finally
                        {
                            if (conn.State == ConnectionState.Open) conn.Close();
                        }

                    }
                }
            }
            catch (Exception ee)
            {
                MessageBox.Show(ee.Message);
            } 
```

最好的祝福

# android - 在 activitResult() 方法上更新 imageview？

> ID：10306996
> 
> 赞同：0
> 
> 时间：2012-04-24T22:36:03.600
> 
> 标签：android, imageview

我正在尝试更新`imageView`我的活动中的一个，用户单击 Imageview，Imageview 的 Onclick 我正在打开画廊以选择图像，当用户选择图片时，它返回到带有所选图像的上一个活动并更新 imageview。

但我无法更新我的图像视图。

你能告诉我我缺乏的地方吗，下面是我的代码。

```
if(requestCode == Activity.RESULT_OK){
        Uri selectedpic = pic.getData();
        try{
            Bitmap bmpic = MediaStore.Images.Media.getBitmap(
                    this.getContentResolver()
                    , selectedpic);
            ((BitmapDrawable)spic.getDrawable()).getBitmap().recycle();
            spic.setImageBitmap(bmpic);
            spic.invalidate();
        }catch(FileNotFoundException e){
            Log.e(this.getClass().toString(), e.getMessage());
        } catch (IOException e) {
            Log.e(this.getClass().toString(), e.getMessage());
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T02:51:25.170

**这行代码是错误的：**

```
if(requestCode == Activity.RESULT_OK) 
```

**它一定要是：**

```
if(requestCode == RESULT_OK) 
```

# mercurial - 删除本地标签失败

> ID：10306997
> 
> 赞同：3
> 
> 时间：2012-04-24T22:36:24.583
> 
> 标签：mercurial, tags

我正在尝试使用以下方法删除 Mercurial 存储库中的本地标签：

```
hg tag --remove tag-name 
```

我收到以下消息：

> 中止：标签'last-working'不是全局标签

有没有办法删除本地标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:49:03.713

当然：

```
hg tag --remove --local tag-name 
```

# php - PHP 转换日期格式 dd/mm/yyyy => yyyy-mm-dd

> ID：10306999
> 
> 赞同：110
> 
> 时间：2012-04-24T22:36:44.087
> 
> 标签：php, date, formatting, mktime

我正在尝试将日期从`dd/mm/yyyy => yyyy-mm-dd`. 我使用了 mktime() 函数和其他函数，但我似乎无法使其工作。我已经设法`explode`使用作为分隔符的原始日期`'/'`，但我没有成功更改格式`'/'`并将`'-'`.

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：309
> 
> 时间：2012-04-24T22:38:01.493

> `m/d/y`或格式中的日期`d-m-y`通过查看各个组件之间的分隔符来消除歧义：如果分隔符是斜杠 ( )，则假定`/`为美式；`m/d/y`而如果分隔符是破折号 ( `-`) 或点 ( )，则 假定`.`为欧洲格式。`d-m-y`在这里查看[更多](https://devdocs.io/php/function.strtotime)。

使用默认日期函数。

```
$var = "20/04/2012";
echo date("Y-m-d", strtotime($var) ); 
```

**编辑**我刚刚对其进行了测试，不知何故，PHP 不适用于 dd/mm/yyyy 格式。这是另一个解决方案。

```
$var = '20/04/2012';
$date = str_replace('/', '-', $var);
echo date('Y-m-d', strtotime($date)); 
```

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2012-04-24T22:46:46.440

尝试使用[`DateTime::createFromFormat`](https://secure.php.net/manual/en/datetime.createfromformat.php)

```
$date = DateTime::createFromFormat('d/m/Y', "24/04/2012");
echo $date->format('Y-m-d'); 
```

输出

```
2012-04-24 
```

编辑：

如果日期是 2010 年 5 月 4 日（D/M/YYYY 或 DD/MM/YYYY），则使用以下方法将 5/4/2010 转换为 2010-4-5（YYYY-MM-DD 或YYYY-MD) 格式。

```
$old_date = explode('/', '5/4/2010'); 
$new_data = $old_date[2].'-'.$old_date[1].'-'.$old_date[0]; 
```

输出：

```
2010-4-5 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2012-04-24T22:53:06.143

这是另一个不使用 date() 的解决方案。没那么聪明:)

```
$var = '20/04/2012';
echo implode("-", array_reverse(explode("/", $var))); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-24T22:39:19.763

做这个：

```
date('Y-m-d', strtotime('dd/mm/yyyy')); 
```

但请确保 'dd/mm/yyyy' 是实际日期。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T23:03:36.133

我可以看到很好的答案，所以这里不需要重复，所以我想提供一些建议：

我建议使用 Unix Timestamp 整数而不是人类可读的日期格式在内部处理时间，然后使用 PHP 的`date()`函数将时间戳值转换为人类可读的日期格式以供用户显示。这是应该如何完成的粗略示例：

```
// Get unix timestamp in seconds
$current_time = date();

// Or if you need millisecond precision

// Get unix timestamp in milliseconds
$current_time = microtime(true); 
```

然后`$current_time`在您的应用程序中根据需要使用（存储、加减等），然后当您需要向用户显示日期值时，您可以使用`date()`指定所需的日期格式：

```
// Display a human-readable date format
echo date('d-m-Y', $current_time); 
```

这样您就可以避免在处理日期格式、转换和时区方面遇到很多麻烦，因为您的日期将采用紧凑、独立于时区（始终为 UTC）并在编程语言和数据库中得到广泛支持的标准化格式（Unix 时间戳） .