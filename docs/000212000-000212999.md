# StackOverflow 问答 000212000-000212999

# c++ - 多个定义错误，包括来自多个来源的内联代码的 c++ 头文件

> ID：212006
> 
> 赞同：30
> 
> 时间：2008-10-17T12:57:19.690
> 
> 标签：c++

我有一个包含类的 c++ 头文件。我想在几个项目中使用这个类，但我不想为它创建一个单独的库，所以我将方法声明和定义都放在头文件中：

```
// example.h
#ifndef EXAMPLE_H_
#define EXAMPLE_H_
namespace test_ns{

class TestClass{
public:
    void testMethod();
};

void TestClass::testMethod(){
    // some code here...
}

} // end namespace test_ns
#endif 
```

如果在同一个项目中我从多个 cpp 文件中包含此标头，我会收到一条错误消息“ `multiple definition of test_ns::TestClass::testMethod()`”，而如果我将方法定义放在类主体中，则不会发生这种情况：

```
// example.h
#ifndef EXAMPLE_H_
#define EXAMPLE_H_
namespace test_ns{

class TestClass{
public:
    void testMethod(){
        // some code here...
    }
};

} // end namespace test_ns
#endif 
```

由于类是在命名空间中定义的，这两种形式不应该是等价的吗？为什么在第一种情况下认为该方法被定义了两次？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-17T13:03:03.593

在类主体内部被编译器认为是内联的。如果您在正文之外实现，但仍在标题中，则必须将该方法显式标记为“内联”。

```
namespace test_ns{

class TestClass{
public:
    inline void testMethod();
};

void TestClass::testMethod(){
    // some code here...
}

} // end namespace test_ns 
```

**编辑**

对我自己来说，通过意识到编译器看不到任何像头文件这样的东西，它通常有助于解决这些类型的编译问题。头文件经过预处理，编译器只看到一个巨大的文件，其中包含每个（递归）包含文件中的每一行。通常，这些递归包含的起点是正在编译的 cpp 源文件。在我们公司，即使是一个看起来不起眼的 cpp 文件也可以作为一个 300000 行的怪物呈现给编译器。

因此，当一个未声明为内联的方法在头文件中实现时，编译器最终可能会在预处理文件中多次看到 void TestClass::testMethod() {...} 。现在您可以看到这没有任何意义，与在一个源文件中多次复制/粘贴时获得的效果相同。即使您在每个编译单元中只使用一次成功，通过某种形式的条件编译（例如使用包含括号），链接器仍然会发现此方法的符号位于多个编译单元（目标文件）中。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-17T13:04:44.463

这些是不等价的。给出的第二个示例在方法上有一个隐式的“内联”修饰符，因此编译器将自行协调多个定义（如果它不可内联，则很可能与方法的内部链接）。

第一个示例不是内联的，因此如果此标头包含在多个翻译单元中，那么您将有多个定义和链接器错误。

此外，标题应该始终受到保护，以防止在同一个翻译单元中出现多个定义错误。那应该将您的标题转换为：

```
#ifndef EXAMPLE_H
#define EXAMPLE_H

//define your class here

#endif 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T13:09:20.353

不要将函数/方法定义放在头文件中，除非它们被内联（通过直接在类声明中定义它们或由 inline 关键字明确指定）

头文件（大部分）用于声明（无论您需要声明什么）。允许的定义是常量和内联函数/方法（以及模板）的定义。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-06-10T00:04:03.480

实际上，可以在单个头文件中定义定义（没有单独的 .c/.cpp 文件），并且仍然可以从多个源文件中使用它。

考虑这个`foobar.h`标题：

```
#ifndef FOOBAR_H
#define FOOBAR_H

/* write declarations normally */
void foo();
void bar();

/* use conditional compilation to disable definitions when necessary */
#ifndef ONLY_DECLARATIONS
void foo() {
   /* your code goes here */
}
void bar() {
   /* your code goes here */
}
#endif /* ONLY_DECLARATIONS */
#endif /* FOOBAR_H */ 
```

如果您只在一个源文件中使用此头文件，请正常包含并使用它。就像在`main.c`：

```
#include "foobar.h"

int main(int argc, char *argv[]) {
    foo();
} 
```

如果您的项目中还有其他源文件需要`foobar.h`，则`#define ONLY_DECLARATIONS`在包含它之前使用宏。在`use_bar.c`你可以写：

```
#define ONLY_DECLARATIONS
#include "foobar.h"

void use_bar() {
    bar();
} 
```

编译后 use_bar.o 和 main.o 可以毫无错误地链接在一起，因为其中只有一个 (main.o) 将实现 foo() 和 bar()。

这有点不习惯，但它允许将定义和声明放在一个文件中。[我觉得它是真正模块](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2015/n4465.pdf)的穷人替代品。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T17:41:23.563

您的第一个代码片段违反了 C++ 的“一个定义规则” [- 请参阅此处以获取描述 ODR 的 Wikipedia 文章的链接。](http://en.wikipedia.org/wiki/One_Definition_Rule)您实际上违反了第 2 点，因为每次编译器将头文件包含到源文件中时，您都会遇到编译器生成全局可见定义的风险`test_ns::TestClass::testMethod()`。当然，当您链接代码时，链接器将拥有小猫，因为它会在多个目标文件中找到相同的符号。

第二个片段有效，因为您已经内联了函数的定义，这意味着即使编译器没有为该函数生成任何内联代码（例如，您关闭了内联或编译器决定该函数太big to inline），为函数定义生成的代码将仅在翻译单元中可见，就好像您将其卡在匿名命名空间中一样。因此，您会在生成的目标代码中获得该函数的多个副本，链接器可能会或可能不会优化，具体取决于它的智能程度。

您可以在您的第一个代码片段中通过添加前缀来实现类似的`TestClass::testMethod()`效果`inline`。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-07-16T10:21:01.297

```
//Baseclass.h  or  .cpp

#ifndef CDerivedclass
#include "Derivedclass.h"
#endif

or
//COthercls.h    or .cpp

#ifndef CCommonheadercls
#include "Commonheadercls.h"
#endif

I think this suffice all instances. 
```

# java - 我必须在 Webstart 应用程序中显式调用 System.exit() 吗？

> ID：212009
> 
> 赞同：8
> 
> 时间：2008-10-17T12:58:00.563
> 
> 标签：java, swing, java-web-start

最近我将一个 Swing 应用程序转换为 Webstart。这个过程非常简单，但我发现在我关闭所有窗口后，我的应用程序的 JVM 并没有终止。线程转储显示有几个非守护线程，特别是 Swing 的 EDT、AWT 和几个 websart 相关线程。

实际使用的策略是每个窗口在创建时递增一个计数器，在关闭时递减一个。默认关闭操作是 DISPOSE_ON_CLOSE。当计数器达到零时，我停止所有线程池并释放所有 JNI 资源。

当我从 bat 文件（相同的 JAR）启动应用程序时，它在所有窗口都关闭时正常终止，所以我认为问题与 Webstart 有关。

现在的问题：

1.  谁能告诉我到底发生了什么？为什么 Webstart 会留下僵尸 JVM？
2.  有没有办法在不停止 JVM 的情况下显式释放 Webstart 资源？
3.  我一直认为调用 System.exit() 会鼓励草率的做法，即不释放您的资源并依赖操作系统在您之后进行清理（如果您稍后重用代码，这可能会导致令人讨厌的意外）......我错过了什么吗？

另请参阅[后续问题](https://stackoverflow.com/questions/216315/what-is-the-best-way-to-detect-whether-an-application-is-launched-by-webstart)以检测 Webstart 是否已启动该应用程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T19:36:16.547

由于 WebStart 中的错误，是的。WebStart 为自己的目的启动了一个与 EDT 交互的“安全线程”。此 SecureThread 可防止在释放所有窗口和 AWT 资源时自动终止 Java 进程。

欲了解更多信息，请参阅[http://www.pushing-pixels.org/?p=232](http://www.pushing-pixels.org/?p=232)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T13:22:48.813

AWT EDT 通常是罪魁祸首。几年来，当没有未处理的窗口时，它有一些关闭的逻辑。但是，泄漏问题经常出现，包括在 AWT 和 Swing 的实现中。因此，我强烈建议在生产版本中使用 System.exit（您可能希望将其排除在外以进行一些测试以检测泄漏）。

当没有系统窗口（控制台、javax.jnlp 服务和其他对话框）显示时，WebStart 线程应该都是守护进程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T13:09:01.243

Webstart 启动控制台窗口（您可以禁用它）。控制台窗口用于查看 webstart 进程的标准输出/错误以及基本日志/调试，但具有创建顶级 AWT/Swing 窗口的副作用。由于 AWT/EDT 仅在最后一个窗口被释放时才结束，因此控制台窗口正在阻止您的应用程序。您可能应该调用 System.exit() 以 100% 确保您的应用程序退出（除非您可以保证某个客户端配置，webstart 控制台已关闭）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T19:45:37.577

考虑使用 jconsole 附加并查看 JVM 正在做什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T15:27:19.860

我在使用 web start 时遇到了同样的问题。如果我关闭 java 控制台，进程不会挂断。来自 Sun 的任何已知错误 ID？

# asp.net-mvc - MVC 中的业务规则在哪里

> ID：212027
> 
> 赞同：26
> 
> 时间：2008-10-17T13:06:51.200
> 
> 标签：asp.net-mvc, model-view-controller, business-rules

现在每个人都在谈论 MVC，我注意到业务规则没有得到解决。在过去的 3 层架构中，业务规则位于中间层。它们在新的 MVC 中处于什么位置？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-17T16:42:19.830

您从未看到 MVC 地址“业务规则”的原因是 MVC 总的来说是一种表示模式。它专注于如何构建您的应用程序。例如，模型可以被认为是一个表示模型。应用程序的模型，然后视图呈现。

但是，为了创建表示模型，您通常需要转到所有业务逻辑所在的域模型。那时，MVC 并没有规定该代码的物理位置。是在另一层吗？MVC 不在乎。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-17T13:15:57.017

乍一看，我会说它们属于模型。维基百科上的[MVC 条目](http://en.wikipedia.org/wiki/Model-view-controller)似乎同意：“在 MVC 中，模型表示应用程序的信息（数据）和用于操作数据的业务规则”。毕竟，“业务规则”是指对应用程序所涉及的域进行编码的功能算法和逻辑，而不是与输入/输出相关的逻辑。这些与业务相关的核心逻辑不会或不应该根据向用户显示的内容（即视图的域）或用户输入（主要由控制器接收）而改变。

根据我的经验，在软件开发过程中提出这样的问题非常具有启发性：我们发现了大量被某些人认为是“业务规则”的东西，但结果却是另外一回事。如果它不是真正的业务规则，它可能不属于模型。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-17T13:22:11.387

业务规则始终存在于模型中。该模型是您可以通过完全不同的 UI 重复使用的部分。视图显然完全依赖于 UI 选择，控制器必须从模型中获取数据并告诉视图渲染它。

将业务逻辑放入视图是不好的，因为它将结构与表示联系在一起。

将业务逻辑放入控制器是不好的，因为它在模型持久化的数据和控制器中的规则之间分割了您的业务域。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-17T13:15:05.723

[维基百科文章](http://en.wikipedia.org/wiki/Model-view-controller)的引述：

MVC 经常出现在 Web 应用程序中，其中视图是实际的 HTML 页面，控制器是收集动态数据并在 HTML 中生成内容的代码。最后，**模型**由通常存储在数据库或 XML 节点中的实际内容以及基于用户操作转换该内容**的业务规则来表示。**

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-17T13:20:22.170

有什么理由不能混合 MVC 和 Ntier 吗？我们的应用程序就是这样做的。我们的控制器用于数据验证并决定调用哪个业务层。

OurApp.Web - Asp.net MVC 项目
OurApp.Business - 业务层库
OurApp.DataAccess - 数据层库
OurApp.Entities - 基本上所有层共享的所有“模型”

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-10-01T09:03:58.667

业务规则应该在模型中，而不是控制器中。控制器和视图是表示层的一部分。

该模型表示域的实体和功能..

控制器只是一个管理器，用于接受用户输入和请求，在模型中/模型上执行操作并将其映射到表示层中的视图。控制器也不仅仅是一个中介，视图或控制器可以作用于模型。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-11T05:56:56.893

这是一个古老的问题，但我喜欢规则存储库完全独立于应用程序的任何部分。多个应用程序、业务层的多个实现应该能够访问业务规则存储库的静态呈现。诸如此类的简单分离决策使得从桌面 -> Web 的迁移变得微不足道。

在我的架构中，视图 -> 模型 -> 控制器 -> 业务层 -> 规则存储库，即控制器访问业务层/层呈现的粗略数据，将其提供给模型，模型将其按摩成可呈现的形式，然后view 被动地显示它。可跨任何表示格式重用的业务层将具有显式规则，并且可以访问具有隐式规则的子系统。按照设计，每个组件都不知道它上面的组件的细节。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-05T16:49:26.717

我认为这个问题是一个定义问题。在我看来，按所需顺序呈现屏幕的逻辑是控制器问题，我已经看到一些项目使用规则引擎来确定顺序以及用户需要输入的内容。这与恕我直言的业务规则不同。

* * *

## 回答 #9

> 赞同：-7
> 
> 时间：2009-06-23T14:48:59.187

你们错了，业务规则存在于控制器而不是模型中......

# c# - 缓存委托结果

> ID：212028
> 
> 赞同：7
> 
> 时间：2008-10-17T13:06:59.670
> 
> 标签：c#, .net, asp.net, delegates, memoization

我有一个接受 Predicate<Foo> 并返回匹配项列表的 C# 方法...

```
public static List<Foo> FindAll( Predicate<Foo> filter )
{
    ...
} 
```

过滤器通常是常见的一组...

```
public static class FooPredicates
{
    public static readonly Predicate<Foo> IsEligible = ( foo => ...)
    ...
} 
```

...但可能是匿名代表。

我现在想让这个方法在 ASP.NET 缓存中缓存它的结果，所以重复调用同一个委托只会返回缓存的结果。为此，我需要从委托创建一个缓存键。Delegate.GetHashCode() 会为此目的产生合理的结果吗？还有其他我应该看的代表成员吗？你会完全以另一种方式来做这件事吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T13:40:24.377

要执行缓存任务，您可以遵循其他建议并创建缓存结果的 Dictionary<Predicate<Foo>,List<Foo>> （全局为静态，否则为成员字段）。在实际执行 Predicate<Foo> 之前，您需要检查结果是否已存在于字典中。

这种确定性函数缓存的通用名称称为记忆化——它真棒:)

自从 C# 3.0 添加了 lambda 和 Func/Action 委托后，将 Memoization 添加到 C# 就非常容易了。

Wes Dyer 有一篇[很棒的文章](http://blogs.msdn.com/wesdyer/archive/2007/01/26/function-memoization.aspx)，通过一些很好的例子将这个概念带到了 C# 中。

如果您希望我向您展示如何做到这一点，请告诉我……否则，Wes 的帖子应该足够了。

回答您关于委托哈希码的查询。如果两个代表相同，d1.GetHashCode() 应该等于 d2.GetHashCode()，但我对此不是 100%。您可以通过使用 Memoization 并在 FindAll 方法中添加 WriteLine 来快速检查这一点。如果这最终不是真的，另一种选择是使用 Linq.Expression<Predicate<Foo>> 作为参数。如果表达式不是闭包，那么做同样事情的表达式应该是相等的。

让我知道这是怎么回事，我很想知道关于 delegate.Equals 的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T13:23:15.643

委托相等性查看调用列表中的每个调用，测试要调用的方法的相等性以及方法的目标。

该方法是缓存键的一个简单部分，但方法的目标（调用它的实例 - 假设是实例方法）可能无法以可序列化的方式缓存。特别是，对于捕获状态的匿名函数，它将是为捕获该状态而创建的嵌套类的实例。

如果这一切都在内存中，只需将委托本身保留为哈希键就可以了 - 尽管这可能意味着客户端希望被垃圾收集的某些对象会挂起。如果您需要将其序列化到数据库中，它会变得更加复杂。

你能让你的方法也接受一个缓存键（例如一个字符串）吗？（这是假设内存缓存不足。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-18T13:20:57.613

将缓存的结果保存在 Dictionary<Predicate<Foo>,List<Foo>> 对我来说很尴尬，因为我希望 ASP.NET 缓存为我处理到期而不是永远缓存所有结果，但这是一个很好的解决方案。我想我最终会使用 Will 的 Dictionary<Predicate<Foo>,string> 来缓存我可以在 ASP.NET 缓存键中使用的字符串。

一些初步测试表明，委托平等做了其他人所说的“正确的事情”，但 Delegate.GetHashCode 在病态上没有帮助。反光板揭示

```
public override int GetHashCode()
{
    return base.GetType().GetHashCode();
} 
```

所以任何 Predicate<Foo> 返回相同的结果。

我剩下的问题是匿名代表如何实现平等。那么“在同一个目标上调用相同的方法”是什么意思呢？似乎只要在同一个地方定义了委托，引用就相等。在不同地方定义的具有相同主体的代表不是。

```
static Predicate<int> Test()
{
    Predicate<int> test = delegate(int i) { return false; };
    return test;
}

static void Main()
{
    Predicate<int> test1 = Test();
    Predicate<int> test2 = Test();
    Console.WriteLine(test1.Equals( test2 )); // True

    test1 = delegate(int i) { return false; };
    test2 = delegate(int i) { return false; };
    Console.WriteLine(test1.Equals( test2 )); // False
} 
```

这应该可以满足我的需要。带有预定义谓词的调用将被缓存。对一个使用匿名方法调用 FindAll 的方法进行多次调用应该会获得缓存结果。使用显然相同的匿名方法调用 FindAll 的两个方法不会共享缓存的结果，但这应该是相当罕见的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T13:25:23.923

除非您确定 Delegate 的 GetHashCode 实现是确定性的并且不会导致任何冲突，否则我不会相信它。

这里有两个想法。首先，将委托的结果存储在 Predicate/List 字典中，使用谓词作为键，然后将整个结果字典存储在缓存中的单个键下。不好的是，如果缓存项丢失，您会丢失所有缓存的结果。

另一种方法是为 Predicate 创建一个扩展方法 GetKey()，它使用对象/字符串字典来存储和检索所有 Predicate 的所有键。您使用委托对字典进行索引并返回其键，如果找不到则创建一个。通过这种方式，您可以确保每个代表都获得了正确的密钥，并且没有任何冲突。一个简单的方法是类型名称 + Guid。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T05:06:26.787

对象的相同实例将始终返回相同的哈希码（.Net 中 GetHashCode() 的要求）。如果您的谓词在静态列表中并且您没有每次都重新定义它们，那么我看不出将它们用作键的问题。

# gwt - 如何在 GWT 标签小部件中格式化文本

> ID：212031
> 
> 赞同：9
> 
> 时间：2008-10-17T13:08:02.303
> 
> 标签：gwt, widget

我想打破分配给 GWT 中标准标签小部件的一长行文本。我正在尝试使用内联`<br />`元素，但没有成功。

像这样的东西：

```
label = "My very very very long<br />long long text" 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-17T15:08:05.933

您需要使用 HTML 小部件，它扩展了标准的 Label 小部件，并添加了对解释 HTML 标记的支持。

请参阅[JavaDoc](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/user/client/ui/HTML.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-13T09:11:49.967

我会使用 CSS 来设置标签的样式以适应给定的内容并将`<br/>`所有内容放在一起。

# algorithm - 学生第一次学习排序算法应该先教什么？

> ID：212039
> 
> 赞同：19
> 
> 时间：2008-10-17T13:10:22.847
> 
> 标签：algorithm, sorting

如果你是一名编程老师，你必须选择一种排序算法来教你的学生，你会选择哪一种？我只要求一个，因为我只想介绍排序的概念。应该是冒泡排序还是选择排序？我注意到这两个是最常教的。是否有另一种类型的排序可以以更容易理解的方式解释排序？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-17T13:25:08.010

我不确定我能不能成为一名计算机科学老师，只教一种排序算法。

至少应向学生教授每种[主要排序类型](http://en.wikipedia.org/wiki/Sorting_algorithm#List_of_sorting_algorithms)中的至少一种，即交换排序、选择排序、插入排序和合并排序。除了这些类型中的一种之外，我还将介绍[属于](http://en.wikipedia.org/wiki/Quicksort)分区排序标题下的快速排序。

至于我将涵盖的每种类型的具体种类：

*   [冒泡排序](http://en.wikipedia.org/wiki/Bubble_sort)作为交换排序类别的一个例子，因为它是最简单的排序类型之一，而且他们可能已经看到或偶然发现了一种。如果他们必须为简单的事情自己动手，这也是他们最有可能最常使用的那种，所以他们理解它是有意义的。
*   来自选择排序类别的[堆排序。](http://en.wikipedia.org/wiki/Heapsort)这可能是仅次于快速排序的最令人困惑的排序，但一旦他们了解它如何设置他们以理解快速排序算法。
*   [将介绍作为插入](http://en.wikipedia.org/wiki/Insertion_sort)排序类别示例的插入排序，因为它也是一种简单的排序，可以大量使用。因为他们可能会遇到需要将两个列表合并在一起的情况，所以知道这个是有道理的。
*   [合并排序](http://en.wikipedia.org/wiki/Merge_sort)在某种程度上是一种专门的排序，因此您不会经常看到它，但它非常擅长它的作用，并且在您需要对以零碎方式获得的数据进行排序的情况下仍然有用。

如果我必须将事情缩小到我可以教的一种，但我有时间确保学生准确理解发生了什么，那么我会教 Quicksort。虽然不容易掌握，但绝大多数框架都将它用于排序算法，因此了解它的工作原理对于使用该框架进行开发很有用。此外，如果有人能够理解快速排序，那么他们很可能应该能够自己学习冒泡排序和插入排序。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-12-03T06:32:16.587

**让你的学生决定。**

在介绍任何排序算法之前，先给每个学生一些扑克牌，大概 10 张左右。然后让他们对卡片进行分类。让他们写下他们采取的步骤，这基本上就是他们的算法。他们可能会发现插入或选择排序。你也可以让他们估计如果他们有 100 或 1000 张卡片，他们的排序会采取多少步，这很好地引导到大 O 符号。

*PS - 有人认为他们会发现冒泡排序吗？*

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-17T13:14:59.140

不管教的是什么排序算法，如果学生不学习[bogosort](http://en.wikipedia.org/wiki/Bogosort)，他们就会错失良机，而且老师正在失去吸引观众的明显方式:)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-10-17T13:14:47.360

如果你想教排序，那么冒泡排序可能是最容易理解的。如果你想教授排序算法，那么你真的应该教授快速排序、归并排序、插入排序，甚至可能是堆排序，以便学生能够感受各种排序方法之间的权衡。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-17T13:32:19.103

我将从显示插入排序开始。每个整理过牌的人（基本上是每个人）都知道这种分类。另外，它没有冒泡排序的糟糕表现。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-17T13:18:00.770

我首先学习了冒泡排序——我认为如果你只做一个，你可能需要做一个 O(n^2) 算法，因为它们更容易理解。

有很多排序可视化工具可以帮助快速显示比较：

*   [http://www.cs.ubc.ca/~harrison/Java/sorting-demo.html](http://www.cs.ubc.ca/~harrison/Java/sorting-demo.html)
*   [http://math.hws.edu/TMCM/java/xSortLab/](http://math.hws.edu/TMCM/java/xSortLab/)
*   [http://vision.bc.edu/~dmartin/teaching/sorting/anim-html/all.html](http://vision.bc.edu/~dmartin/teaching/sorting/anim-html/all.html)
*   [http://maven.smith.edu/~thiebaut/java/sort/](http://maven.smith.edu/~thiebaut/java/sort/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-17T15:07:18.023

我会在一般排序算法上建议选择和合并排序。与他们的朋友相比，两者都相对直截了当。但是如果你只能教一个并且人们可以处理它，我会选择合并排序。因为归并排序是高效、稳定的，并且教授了几个重要的概念（合并、分治）。

选择排序：
找到最小值/最大值并将其放在适当的位置，然后在列表的其余部分上再次执行...这非常直观。对我来说，选择甚至比冒泡排序更直观。你可能会在很短的时间内教这个。而且实现这个的人会有成就感……虽然Bubble和Insertion可以提前退出，不会在排序列表上浪费时间。选择可能是最容易做到的。插入可能是最难实现的。

MergeSort：
这将教授如何合并（这很重要，因为通过将两个排序列表合并在一起可以获得大量加速）以及如何将问题划分为更小的子问题（对于处理层次结构和也很重要）用于快速排序）。快速排序虽然更快，但更难理解。您需要两个扫描变量，一个数据透视项目等......合并更直接，合并对于排序以外的事情会派上用场（比如将两个在字段上排序的记录连接在一起）......

合并的基本概念是直观的。从排序列表中取出较小的项目并将其放入最终列表中。划分归并排序问题也很直观。
合并排序（前半部分） 合并排序（后半部分）
合并（前半部分，后半部分）

如果您只能教授一种并且必须快速完成（或者观众根本不感兴趣），我会倾向于选择，因为这更难并且可以快速教授选择。但如果观众更有动力，那么我会做 Merge，因为它教了很多额外的基本概念。

在更有效的排序中，这种排序比快速排序和堆排序要容易得多。尽管快速排序在实践中可能是最快的（只要你有足够的内存）并且堆可能能够对最大的列表进行排序（如果非递归实现）。

桶排序：
我会谈到这一点，因为它也很直观并且代表了另一种类型的排序算法。在许多情况下，这是合适的，而且 O(n) 时间非常有吸引力。

计数排序：
它有它的用途。在某些情况下，这是非常有效的......它也相对容易。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-17T13:18:25.013

选择排序可能是最容易教授和最容易掌握的排序算法。这也是为什么简单的解决方案并不总是最好的一个很好的例子，这可能会引发对更有趣和更快的排序的讨论，比如合并排序和快速排序。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-17T13:18:30.443

我认为排序方法是算法的一个很好的例子。但是，当您比较各种方法时，它只会成为一个很好的例子。如果你只能教一个，我不确定它是否值得。

实际上，我们在某些框架中调用 sort 方法。所以如果你不能有效地教授排序算法，那可能不值得花时间。

再也没有人需要编写排序方法了，但它仍然是算法影响的一个很好的例子。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-17T13:16:45.673

我会教“调用框架”排序。

教授和学习这种方法会很有效。学生在实施这种分类时会有很高的成功率和很低的错误率。

* * *

编辑：关于我的单分类课程的质量，这个答案有很多批评性评论。这些批评适用于这个问题的任何答案，即——“如果你是一名编程老师，你必须选择**一种排序算法**来教你的学生会是哪**一种**？”

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-17T14:58:27.823

这将是[基数排序](http://en.wikipedia.org/wiki/Radix_sort)。因为它非常简单，但并不明显。像这样的东西只能教。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-17T13:19:01.707

嗯...排序算法确实是一种直观、具体的方法，可以教授一些关于大 O 表示法、优化、常识和计算机科学的好课程，也许是“冒泡排序”+“选择排序”+“合并排序”方法可能有用，用于比较。我认为最直观（在许多情况下也是有效的）是选择排序。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-17T13:54:16.377

我认为只教一种是残废的。请记住，[对于 Small n 来说，一切都](http://www.codinghorror.com/blog/archives/000957.html)很快，因此在教授排序方面，这不是性能问题，而是理解算法。

我认为介绍应该是冒泡排序来介绍这个概念，但至少要引入另一种排序来让学生思考执行任务的其他方法。确保他们了解性能和代码复杂性之间的权衡，并确保针对不同情况有不同的工具。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-17T13:17:03.457

冒泡排序是经典，很容易理解它为什么起作用。

但除非这是一门非常介绍性的课程，否则它应该包括对其他排序算法的概述，因为这是迄今为止展示算法设计中所涉及的权衡和解释最佳情况、最坏情况和平均行为（运行时和内存）的最佳方式）。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-22T21:51:40.543

如果你想教授排序的概念，那么我相信你必须至少教授两种不同的排序方式——否则学生会认为排序只是你教给他们的一种方式。

我认为学生将从学习经典的 O(n^2) 算法（最好是插入或选择排序，但请**不要**冒泡排序，它没有理由在实际应用中使用）中获得最大价值，以及分治法，O(nlogn) 算法，例如快速排序或归并排序。

如果您担心这些课程太难教您的学生，请查看[Computer Science Unplugged中的](http://csunplugged.org/)[这些活动](http://csunplugged.org/index.php/en/07-sorting-algorithms-activitiesmenu-113)，这些活动是为小学生设计的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-17T16:16:41.580

让每个人都带上一副牌，然后挑出一套花色。分成两人一组。一个人将 13 张牌洗牌，然后将它们面朝下连续放置。合作伙伴可以指向其中两张牌。另一个把它们捡起来，看着它们，要么说“按顺序”，要么“按顺序”，然后对方可以告诉他交换它们，然后再放下它们（面朝下）

合作伙伴的工作是按顺序对卡片进行分类（您需要预先定义）。

当伙伴认为他们已排序时，他会说“停止”。另一个将牌面朝上，然后他们过牌。

完成后，讨论对每个人都有效的方法。然后说说BUBBLE SORT vs SELECTION sort

然后谈谈快速排序。

让他们用他们的纸牌试一试。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-17T13:21:16.787

我认为选择排序是最容易理解的，而 IMO 最好是引入排序。

我认为不教他们至少一种 O(nlog(n)) 排序算法以及对大 O 表示法的解释是愚蠢的。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-17T13:18:11.770

我参加过的关于算法的最佳讲座*将所有*算法演示为通过 Java 小程序绘制的条形图。然后，您还可以看到排序模式以及 O(N) 特征......

教泡泡，因为它非常简单，其余的可能会显示为动画？

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-07T14:54:41.927

应该首先要求他们实现自己的排序算法 - 从头开始​​，而不事先参考任何现有算法。这样做将教会他们排序方式，而不是告诉他们一种算法，他们不知道它是如何派生的。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-17T14:47:14.367

我会比较和对比一个 o(n-squared)，比如选择排序和 ao(n log n) 排序，比如快速排序。

但是，如果他们不是计算机科学人员并且不一定打算成为，那么只需显示一种易于理解的类型，例如选择或气泡。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-17T16:08:49.193

上周我刚刚和我的孩子一起做了这个，我让他想出他们自己的排序算法，并询问使用他的方法对一副纸牌进行排序需要多长时间。然后我向他展示了Bubble Sort（最容易向孩子解释）“这是一个泡沫！” 又让他数步数。他意识到这更容易，更快捷。

然后如果你想你可以教更高级的（快速排序是最令人惊讶的），理想情况下你应该至少教三个不同的（不是相同的变化）

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-12-03T06:47:13.703

我认为 30 年前制作的电影[Sorting Out Sorting](http://www.imdb.com/title/tt0210301/)仍然是一个很好的指导帮助，可以更好地理解排序算法。[这是 12 倍速版本](http://www.youtube.com/watch?v=F3oKjPT5Khg)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-10-17T13:19:03.920

冒泡排序是初学者最容易理解的一种，它也是一个很好的例子，说明了为什么简单的解决方案可能很昂贵。可能是一种进入渐近复杂性和大 O 符号的好方法吗？

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-10-17T13:19:51.890

如果我只能选择一个，我会教冒泡排序，因为它更容易掌握（我认为）。然而，我从研究各种排序算法中得到的最有价值的东西是，有不止一种方法可以做到这一点（最终导致我使用 Perl，但这是另一回事），每种方法都有优点和缺点。因此，学习单一的排序算法可能会错过整个事情的关键方面。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-10-17T13:20:53.450

快速排序绝对是另一种非常易于理解的排序算法，实现它很容易。它有就地和“不合时宜”的版本，想想就很有趣。而且很快。

至少对你来说够快了，老头。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-10-17T13:25:09.197

呃，你应该给他们一个 O(n^2) 和一个 O(n log n) 排序。泡沫和堆将是*我的*选择。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-10-17T13:27:52.280

无论您选择哪种实际算法，我都建议您展示**两种**算法（而不是一种）并解释它们所做的权衡（在内存、执行速度等方面）。

然后你应该坚持认为，没有理想的排序算法可以盲目地应用于任何任务。然而，也有很好的候选人。在这一点上，向他们展示快速排序和自省排序（作为家庭作业）并认为您的任务已完成 :)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-10-17T13:31:34.753

请记住，您的学生可能永远不必自己编写排序代码，所以问题真的应该由“学习这种算法的价值是什么？”来决定。而不是“这个算法是做什么的？”

换句话说，你的学生应该学习各种不同的算法——它们是否用于排序、搜索、压缩等在很大程度上是无关紧要的。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2008-10-17T13:42:14.670

一旦学生学会了快速排序和堆排序，IntroSort 也是一种很好的教学算法。IntroSort（Introspective sort 的缩写）从 QuickSort 开始，如果递归深度超过基于被排序元素数量的对数的级别，则切换到 HeapSort。

总的来说，你得到了最好的快速和堆排序世界和*O* ( *n log n* ) 的最坏情况运行时间。

维基百科上的[介绍排序](http://en.wikipedia.org/wiki/Intro_sort "维基百科上的介绍排序")

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-10-21T22:28:01.610

如果您最终只能教授一种算法，我认为选择排序更容易教授（并实现恕我直言）作为 BubbleSort **。**它可能效率极低，但每个人都会明白它的概念，每个有一点编程知识的人都可以阅读它的代码，并且有一件事使 SelectionSort 在所有排序算法中相当独特：它只需要 n - 1 次交换即可获得 n 的列表条目 :-) 不仅它不需要进行超过 n - 1 次交换，它实际上需要恰好 n - 1 次交换。执行的交换次数是 100% 确定的，甚至在开始之前就知道。我认为这不适用于任何其他就地排序算法（尽管人们可以在评论中自由地纠正我）。

否则我会投票给 BubbleSort 和 SelectionSort，它们最容易理解并展示了排序的简单方法（这些很简单，学生实际上可能在没有听说过任何排序算法的情况下提出这些解决方案）有时不是很有效。相比之下，我将展示 QuickSort 和 MergeSort，它们是非常好的分而治之的算法，而且速度也非常快。

我不会使用的算法是 ShellSort、RadixSort、HeapSort 和 BucketSort，因为它们的概念更难理解。它们也相当特殊（通常仅在对某种数据进行排序或对排序有一定限制时才使用它们）。

你可能会提到 ShellSort 的小妹妹 InsertionSort（它基本上是一种步长最终达到 1 的 shell 排序），但这只是因为许多 QuickSort 实现使用 InesrtionSort 作为后备排序，一旦递归变得太深（或递归排序的剩余数据集太小了）......但在这里它开始变得非常复杂，你不应该让它太复杂。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2010-06-07T14:39:03.437

不要忘记[意大利面条排序](http://en.wikipedia.org/wiki/Spaghetti_sort)......为量子计算做好准备:-)

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2010-01-29T11:38:27.300

从 insertSort 开始，然后继续使用 mergeSort、quickSort 和 heapSort，避免使用 bubbleSort（有大量研究表明 insertSort 并不难理解/实现，并且与 bubbleSort 相比，它具有实际用途（更快比合并排序小的数组，例如）。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2010-11-09T21:08:24.937

我会避免谈论冒泡排序，因为虽然它有效，但它在理论上并不是很优雅。此外，它在实践中从未在任何地方使用过。有一大堆算法依赖于选择排序（例如就地合并）或插入排序（如疯狂的快速内引排序），所以这些可能是很好的开始。我个人最喜欢插入排序，因为从教学的角度来看，它是一座金矿。最坏情况下为 O(n^2)，最好情况下为 O(n)，因此为讨论最坏情况/最佳情况分析提供了一个很好的测试平台。它是一种就地排序，因此您可以使用它来讨论原位排序与非原位排序，并且可以通过谈论它所体现的基本思想将其概括为堆排序。

# asp.net - 在 ListView LayoutTemplate 中显示总计

> ID：212048
> 
> 赞同：3
> 
> 时间：2008-10-17T13:12:57.897
> 
> 标签：asp.net, listview

我正在使用 ListView 控件 (ASP.NET 2008) 来显示一堆数据行，并且在底部我想要一些总数。我最初打算在 LayoutTemplate 中定义页眉和页脚，并使用一些本地函数获取总数，即 <%#GetTheSum()%>，但似乎 LayoutTemplate 不处理 <%#...%>句法。

另一个想法是在 LayoutTemplate 中放置一个标签并使用 FindControl 来更新它。不确定这是否可能（将很快尝试）。

使用 ListView 显示总计的最佳方式是什么？

更新：解决方案[在这里](https://stackoverflow.com/questions/212048/displaying-totals-in-the-listview-layouttemplate#212308)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T14:11:50.040

事实证明 FindControl 确实有效：

```
CType(MyListView.FindControl("litTotal"), Literal).Text = GetTheSum() 
```

我仍然想知道是否有更好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T13:34:09.413

使用文字并在代码隐藏中设置变量。

```
<asp:Literal ID="litTotal" runat="server" /> 
```

代码隐藏：

```
litTotal.Text = GetTheSum(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T13:58:33.280

您不能在代码隐藏中引用该控件，因为它位于 LayoutTemplate 中。也许使用 FindControl，但我还没有尝试过。

# spring - 在 spring 配置中，使用 name 和 id 有什么区别？

> ID：212050
> 
> 赞同：4
> 
> 时间：2008-10-17T13:14:32.463
> 
> 标签：spring

在 spring 配置中，使用 name 和 id 有什么区别？我知道 XML 将“id”属性限制为在文档中是唯一的，并限制在 id 中使用的字符。但是否则在声明 bean 时，使用“name”属性与“id”属性有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T13:53:57.953

本质上，这实际上只是一个 XML 问题。但是你也可以使用 name 属性来为 bean 指定别名，使用在 id 中非法的字符，我认为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T06:12:31.103

通常，您应该尽可能尝试使用 id 而不是 name。这样，解析器可以为您捕获重复项。

# cross-platform - 是否可以仅使用一个主机操作系统来交付 FreePascal 的跨平台二进制文件？

> ID：212055
> 
> 赞同：1
> 
> 时间：2008-10-17T13:14:54.460
> 
> 标签：cross-platform, cross-compiling, freepascal, binaries

我正在做一个小应用程序，我想在不同的平台上分发，至少是 3 个主要平台。

是否可以仅使用具有主机操作系统的 Windows 来为 Linux、Mac OS X 和其他支持的平台编译二进制文件，而无需借助虚拟机？

或者我应该在某个社区中四处询问以帮助我在 OS X 上进行编译，实际上，因为我可以很容易地虚拟化 Linux 机器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T11:11:31.477

**可以**从一个平台编译到另一个平台，这称为***交叉编译***。您可以在[http://www.stack.nl/~marcov/buildfaq.pdf](http://www.stack.nl/~marcov/buildfaq.pdf)
找到大量信息。 上面的 buildfaq 包含示例交叉编译：

*   从 Windows 到 Linux，
*   从 FreeBSD 到 AMD64 Linux

FPC 下载页面包含：

*   i386-win32 到 x86_64-win64 交叉编译器
*   i386-win32 到 arm-wince 的交叉编译器

FPC 邮件列表位于[http://www.freepascal.org/maillist.var您可以在](http://www.freepascal.org/maillist.var) [http://www.freepascal.org/moreinfo.var](http://www.freepascal.org/moreinfo.var)
找到有关 FPC 的更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T07:05:59.973

（我是上面buildfaq文档的作者）

有一些限制。您不能从 powerpc 定位 x86，因为 powerpc 缺少“扩展”类型。但总的来说它是有效的。

我已经为 Windows 上的 OS X 生成了一个完整的 Lazarus。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T13:29:12.153

我会虚拟化 Linux，因为即使您可以交叉编译，也意味着您没有在其本机平台上测试二进制文件。OS X 是一个棘手的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T11:09:05.550

不可能从一个平台编译到另一个平台。我们有一台 Mac 并且经常使用 FPC。如果您在 Mac 上编译需要帮助，请给我留言。

# sql-server - 与 SQL Server 2005 相比，使用 SQL Server 2008 是否有任何性能优势？

> ID：212063
> 
> 赞同：5
> 
> 时间：2008-10-17T13:16:22.867
> 
> 标签：sql-server, performance

与 SQL Server 2005 相比，使用 SQL Server 2008 是否有任何性能优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T15:07:38.397

从 SQL Server 2005-2008 移动单个数据库不会真正注意到差异。但是，SQL Server 2008 中提供了新的工具和选项，您可以利用它们在以后的应用程序中提供更好的性能。

想到的一项是过滤索引。允许在信息子集上创建索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-21T02:27:32.267

是的。您可以在 SQL 2008 中压缩数据，这会对备份和数据传输时间产生巨大影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T02:27:57.073

实际上，SQL2008 具有内置的压缩​​功能，您可以开箱即用地启用它，这肯定会提高性能，但这可能取决于返回的内容。我会尝试这个选项和基准，看看你是否觉得它值得改变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T06:44:52.967

引擎中可能有以不同方式执行查询的新功能。这包括对优化器的更改。

因此，您可能知道的唯一方法是从您在 MSSQL2005 上的应用程序收集详细的性能数据，然后在使用 SQL2008 的相同（生产质量）硬件上重复实验。

您需要确保您的应用程序正常工作——这样的迁移不能轻易完成，因为任何更改都可能引入错误。

此外，新版本的数据库可能会出现性能*下降*——您需要非常小心。

总而言之：

*   在 SQL2005 上对您的应用程序进行基准测试
*   在 SQL2008 上对其进行基准测试
*   两次在您的实验室中使用相同的生产级测试硬件
*   不要运行虚拟机（除非你在生产中这样做）
*   不要更改其他参数

如果您的应用程序很大/很复杂，这可能并不容易。

# .net - 在 .NET 中加载 32 位 PNG

> ID：212087
> 
> 赞同：0
> 
> 时间：2008-10-17T13:22:35.847
> 
> 标签：.net, graphics, image

我还没有写任何代码，但我之前遇到过类似的问题。希望自从我上次访问它以来情况已经发生了变化。

我正在尝试将自己的游戏图像转换为特殊的 OpenGL 图像格式。

为了正确执行转换，我需要所有像素数据，更重要的是，我需要所有 Alpha 通道数据（每像素 8 位）。

.NET 中的 System.Drawing.dll 是否支持完整的 32 位 alpha 透明加载？

我能在 C# 中保留所有信息的情况下通过 alpha 通道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T13:37:46.270

System.Drawing 支持 GDI+ 支持的任何图像格式（包括 PNG-32），并且可以获取该信息。

查看 System.Drawing.Bitmap.GetPixel 或 LockBits

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T13:30:43.023

是的，它确实。你应该得到一个 PixelFormat 设置为 Format32bppArgb 的图像，然后当你调用 LockBits 时，你可以使用返回的 BitmapData 对象的 Scan0 属性来获取数据。

# c# - 从文件读取速度不够快，我将如何加快速度？

> ID：212089
> 
> 赞同：2
> 
> 时间：2008-10-17T13:22:53.897
> 
> 标签：c#, .net, optimization, .net-2.0, io

这是我读取文件的方式：

```
 public static string readFile(string path)
    {
        StringBuilder stringFromFile = new StringBuilder();
        StreamReader SR;
        string S;
        SR = File.OpenText(path);
        S = SR.ReadLine();
        while (S != null)
        {
            stringFromFile.Append(SR.ReadLine());
        }
        SR.Close();
        return stringFromFile.ToString();
    } 
```

问题是它太长了（.txt 文件大约 2.5 兆）。花了5多分钟。有没有更好的办法？

**采取的解决方案**

```
 public static string readFile(string path)
    {

       return File.ReadAllText(path);

    } 
```

花了不到 1 秒... :)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-17T13:34:23.140

```
S = SR.ReadLine();
while (S != null)
{
    stringFromFile.Append(SR.ReadLine());
} 
```

这里需要注意的`S`是，在该 initial 之后永远不会设置`ReadLine()`，因此`S != null`如果您进入 while 循环，则不会触发条件。尝试：

```
S = SR.ReadLine();
while (S != null)
{
    stringFromFile.Append(S = SR.ReadLine());
} 
```

或使用其他评论之一。

如果需要删除换行符，请使用 string.Replace(Environment.NewLine, "")

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T13:25:03.987

撇开可怕的变量名和缺少 using 语句（如果有任何异常，您不会关闭文件）应该没问题，*当然*不应该花 5 分钟来读取 2.5 兆。

文件在哪里？它在不稳定的网络共享上吗？

顺便说一句，您正在做的事情和使用 File.ReadAllText 之间的唯一区别是您正在丢失换行符。这是故意的吗？ReadAllText 需要多长时间？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-17T13:26:53.017

```
return System.IO.File.ReadAllText(path); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T13:39:12.647

马库斯·格里普说得对。它需要很长时间，因为您有一个无限循环。复制了您的代码并进行了更改，它在不到一秒的时间内读取了一个 2.4 M 的文本文件。

但我认为您可能会错过文件的第一行。试试这个。

```
 S = SR.ReadLine();
while (S != null){
    stringFromFile.Append(S);
    S = SR.ReadLine();
} 

```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T13:25:15.750

您是否需要一次占用整个 2.5 Mb 内存？

如果没有，我会尝试使用您需要的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T13:26:46.683

请改用 System.IO.File.RealAllLines。

[http://msdn.microsoft.com/en-us/library/system.io.file.readalllines.aspx](http://msdn.microsoft.com/en-us/library/system.io.file.readalllines.aspx)

或者，估计字符数并将其作为容量传递给 StringBuilder 的构造函数应该可以加快速度。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-17T13:27:51.127

试试这个，应该更快：

```
var str = System.IO.File.ReadAllText(path);
return str.Replace(Environment.NewLine, ""); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-17T13:44:48.753

顺便说一句：下次遇到类似情况时，请尝试预分配内存。无论您使用的确切数据结构如何，这都会极大地改善运行时间。大多数容器（`StringBuilder`以及）都有一个允许您保留内存的构造函数。这样，在读取过程中需要较少耗时的重新分配。

例如，如果要将文件中的数据读入 a 中，可以编写以下代码`StringBuilder`：

```
var info = new FileInfo(path);
var sb = new StringBuilder((int)info.Length); 
```

（强制转换是必要的，因为`System.IO.FileInfo.Length`is `long`。）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-05T11:21:14.520

ReadAllText 对我来说是一个非常好的解决方案。我将以下代码用于 3.000.000 行文本文件，读取所有行需要 4-5 秒。

```
string fileContent = System.IO.File.ReadAllText(txtFilePath.Text)
string[] arr = fileContent.Split('\n'); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-17T13:27:51.533

循环和`StringBuilder`可能是多余的；尝试使用 [ReadToEnd](http://msdn.microsoft.com/en-us/library/system.io.streamreader.readtoend.aspx)。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2016-06-23T07:48:31.173

要最快地读取文本文件，您可以使用类似这样的东西

```
public static string ReadFileAndFetchStringInSingleLine(string file)
    {
        StringBuilder sb;
        try
        {
            sb = new StringBuilder();
            using (FileStream fs = File.Open(file, FileMode.Open))
            {
                using (BufferedStream bs = new BufferedStream(fs))
                {
                    using (StreamReader sr = new StreamReader(bs))
                    {
                        string str;
                        while ((str = sr.ReadLine()) != null)
                        {
                            sb.Append(str);
                        }
                    }
                }
            }
            return sb.ToString();
        }
        catch (Exception ex)
        {
            return "";
        }
    } 
```

希望这会帮助你。欲了解更多信息，请访问以下链接 [- 阅读文本文件的最快方式](http://cc.davelozinski.com/c-sharp/fastest-way-to-read-text-files)

# user-interface - Microsoft 用户界面，它们仍然对用户友好吗？

> ID：212092
> 
> 赞同：2
> 
> 时间：2008-10-17T13:23:36.220
> 
> 标签：user-interface

我发现大多数微软的新程序都很难用。

Microsoft Office 2007（特别是单词）我发现很难使用。Microsoft IIS 7.0 很麻烦，我不记得要单击哪个图标，只是杂乱无章，很难找到。

作为程序员，我们也必须根据人们的习惯来设计，MS到底告诉我们要做什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-17T13:37:22.870

> 我们也必须根据人们的习惯来设计

嗯，这是一个小小的误解。熟悉某些事物的人会欣赏仍然熟悉的界面，这并没有错，但并非所有更改都是不好的。你必须权衡改变的力量和它对老用户造成的伤害。

让我们以 Office 2007 为例。

功能区界面与我记忆中 Office 一直使用的界面大相径庭，**但****其背后有合理的逻辑**。

*   用户功能按活动分组，很容易更改您正在查看的功能集。
*   它们也是上下文相关的，所以只有当你在桌子或图像（等）上时才会出现一些东西。
*   这些都有助于保持混乱——随着这些应用程序功能集的增长，这真的非常有用。您无需花费数小时来选择和自定义一组工具栏，而是可以通过选项卡访问所有内容。

*微软以正确*的方式做到了这一点。他们在很多真人身上测试了界面。他们倾听，看看哪些有效，哪些应该修复或放弃。他们还为经验丰富的专业人士保留了一些传统的键盘快捷键。

重新设计的目标是让初学者和中级用户的生活更轻松。任务完成。你遇到的问题是克服你的熟悉，但我不能比说：它会及时发生，但你最终会管理它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T13:32:31.100

看，我只是一个简单的穴居人，被你的后现代建筑吓到了，呜呜呜机器按喇叭。习惯了旧石器时代的简朴生活；木炭洞穴壁画和基于骨骼的技术。我无法对您花哨的功能区 UI 和尖尖的点击图标做出正面或反面。这就是我从不从 DOS 升级的原因。旧方法总是最好的，学习新方法就像火一样糟糕。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T13:31:26.173

好吧，微软必须平衡这一点。一方面，在许多 MS 软件中，用户为新功能和为改变而改变而尖叫。另一方面，缺乏向后兼容性（包括主观的 UI 兼容性）是一个交易破坏者。真的没有办法在那里取胜。

也就是说，我认为我们不需要按照人们的习惯来设计；微软也没有。如果我们只做以前一直在做的事情，就永远不会发生变化。IIS 不是为程序员开发的；它是为 IT 人员开发的。新界面很好地为他们服务。同样，Office 是为办公室无人机设计的，而不是程序员，新的 Office 非常容易被该特定群体发现。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T13:34:22.533

我认为他们需要一段时间才能习惯，但我确实喜欢他们。（虽然我会完全承认我是一个 mac 人，而且我更喜欢 mac UI）。

我见过的关于 UI 的最大困难是它与以前的版本有很大不同（我说的是当前版本的 Office）。这似乎是最麻烦的地方。

我学到的关于 UI 设计的规则是用户必须熟悉事物（这确实是让它“直观”的原因）。MS 打破了这条规则......但从商业角度来看，他们在这样做时被允许有一点回旋余地，因为他们控制了如此多的市场份额。最终，他们知道彻底的改变不会导致市场份额的损失，因为对于大多数人和企业来说，没有真正可行的替代方案。（我知道有开放式办公室，但是将中型到大型办公室迁移到它所花费的钱与继续使用相同的产品一样多或更多）。

我们是否必须根据人们的习惯进行设计，是的，我们有点做。这是否意味着我们必须让它看起来像 MS 现在正在做的事情，不一定。我们要做的是创建一个用户可以关联的设计。他们必须能够从他们已经知道的逻辑跳跃到使用我们创建的产品。如果没有，他们很可能不会使用该应用程序，除非他们绝对被迫这样做。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-17T13:42:07.167

用户界面和用户体验是完全不同的概念。（[Simon Guest](http://simonguest.com/blogs/smguest/archive/2007/11/16/User-Interface-_2800_UI_2900_-vs.-User-Experience-_2800_UX_2900_.aspx)；[用户界面博客](http://www.user-interface.org/2006/06/27/usability-vs-user-experience/)。）

Microsoft 对 Office 2007 的原始可用性进行了大量研究，发现虽然对于像您或我这样是该工具专家的人来说有一个学习曲线，但新用户和非专家对 Office 2007 的可发现性要大得多。更高级的功能，并最终使用更多应用程序的功能和功能。是的，如果您对 Office 2003 了如指掌（坦率地说，我们当中很少有人真正做到这一点），那么就会有一个学习曲线。

现在我不是在道歉——微软的用户界面并不总是易于使用，有时它们会惨遭失败。（我个人认为没有在功能区上标准化他们所有的办公产品是一个典型的例子——当我打开 Project 或 Visio 时，与我打开 Word 时相比，我的大脑中有一个很大的上下文切换。）

至于开发人员“应该”做什么：请记住，功能区并非适用于所有场景。如果您将它用作美化的工具栏，那么它的使用不正确。它旨在帮助您以一种让最终用户可以发现它们的方式组织数百条（如果不是数千条）命令。当您的应用程序的深度太大而无法在菜单中运行时，它应该加强以安全方式发现应用程序功能的传统体验（请参阅任何版本的*About Face ）。*

除此之外，请记住，我们通常应该为自己的受众制作最合适的 UI，就像微软试图为自己的受众做的那样。同样，我们可能会发现这些东西更难使用，因为我们习惯于以固定的方式做事——但这（通常）对微软来说是正确的。请记住，我们程序员**并不是**大多数 UI 的目标用户。（例如，我们中有多少人关闭了视觉主题？现在有多少普通的最终用户？顺便说一句，我不属于那个阵营；我是少数真正觉得 Vista 具有中等吸引力的人之一。）

同样，归根结底，Microsoft 所做的事情仅在它成为您的用户期望的范围内才重要，并且只有在您无法教育他们“您的方式”更好的情况下。无论如何，如果可用性对您和您的用户来说真的很重要，那么是时候投资于可用性测试并确保您的应用程序确实像您认为的那样可用。并开始阅读可用性网站。（您不必全部同意，但要理解它们。）以下是一些示例：

*   [AskTog](http://www.asktog.com)（Bruce Tognazzini，不活跃但档案是宝库）
*   [UseIt](http://www.useit.com/)（雅各布尼尔森）
*   [jnd.org](http://jnd.org/)（唐诺曼）
*   [Office 用户界面博客](http://blogs.msdn.com/jensenh/)(Jensen Harris)
*   [Microsoft Windows 用户体验交互指南](http://msdn.microsoft.com/en-us/library/ms997506.aspx)（Windows 上的圣言）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T13:37:26.693

这很有趣，因为有很多关于功能区控件设计的可用性测试的讨论，但与我认识的几乎所有其他人一样，我发现它们很难使用。我不断丢失我需要的控件并且无法将它们取回，直到我循环通过另外三个或四个文档视图来寻找它们。我本能地将鼠标移到不再存在的菜单上。

我想知道对于不习惯早期办公产品的人来说，它们是否会更容易——也许这就是他们进行可用性测试的人。我不认为新界面的设计本身就很*糟糕*，但是对于我们这些不把所有时间都花在盯着 Office 但已经使用该产品很长时间的人来说，它已经足够不同了难的。我想大多数真正的高级用户无论如何都会通过击键来完成大多数任务，这可能并没有太大变化。

业务问题实际上是他们需要升级的动力，因此他们不断添加新功能（你知道谁使用了 Word 的所有功能），然后他们需要找到方法来呈现这些功能，而不会使应用程序变得非常混乱，这肯定发生在以前版本的 Office 中。

我不确定作为开发人员我们能从中得到什么——也许是我们应该从一开始就设计可用性，或者想办法让现有用户尽可能轻松地在新旧功能之间进行转换。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-17T13:55:52.490

> Microsoft IIS 7.0 是一个难题

听到其他人发现新的 IIS UI 是一个挑战，我松了一口气。我在没有预先警告的情况下跌跌撞撞地进入了它，并且完全混乱了。周围有很多点击。您必须记住该功能的位置，或者单击并单击。我不知道有一种方法可以同时查看所有 IIS 设置（以前也不是这样，但至少可以留在单个选项卡式对话框中）。

我认为当您对旧 UI 如此熟悉时，要适应全新的 UI 真的很难。我同样对功能区菜单感到迷失方向。更多点击以查找功能。并非所有内容都在功能区中。有些位于可从其他入口点访问的菜单中，例如文件属性。

对于从未见过旧 UI 的新用户来说，这可能不是什么大问题。

我想我真正不喜欢花时间学习新的 UI，至少是方便的时间。当您必须学习新的 UI 时，工作效率会立即下降。您不能只是进入 IIS，配置网站，然后继续前进。前几次，它会花费更长的时间。也许随着越来越熟悉，我们会越来越喜欢新的 UI。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-18T02:44:33.717

MS is trying to give users more power by being able to click this to do this or that and try to make what others may see as very advanced functions simpler to use and more powerful than the previous ones. I remember going from IIS 3.0 to 4.0 where suddenly, there are all these new buttons to click and things are different but it is kind of better. I also remember going from Windows 3.11 to 95 having its own shock of updating things.

Did you ever try watching a movie on VHS and on DVD or go from cassette to CD? Remember how the DVD suddenly had all these new features like chapters, no need to rewind, bonus features that you could just go to and not have to fast forward to find? Similarly how a CD organized things so much better than a cassette? Another point would be to look at TVs where it used to be very few options on a TV: There were 2 dials, the power and volume where combined into one place, and a few other knobs were all we had but now you have TVs where you can store favorites, closed captioning options, sound setting, and color style that could scare some people that remember the old days where you had to physically pull a knob to turn on the machine.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-17T13:44:23.900

我希望他们可以选择为我们这些老家伙展示菜单。

去年，当我提出相同的观点时，我与一位 Microsoft Office 人员开会。他的观点是，特征的数量增长得如此之多，以至于需要一种新的方法来显示它们。我并不完全相信，并且觉得有趣的是，微软对这个问题如此敏感，以至于他有一个非常好的、精心准备的 PowerPoint 演示文稿来尝试解释它。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-10-17T13:42:03.173

> 我发现大多数微软的新程序都很难用。

如果您有这种感觉，请帮自己一个忙，改用 Mac。我做到了，不会回到Windows。用 Windows 完成小事浪费了很多时间。

Apple 有 GUI 样式指南。你不必坚持他们，但据我所知，大多数开发人员都会这样做。

为了防止 Mac-Windows-Flamewar，我想指出这完全是我的意见。请亲爱的 Windows 用户，不要被我的观点攻击。

# java - Are there tools that log user actions to help reproduce bugs?

> ID：212109
> 
> 赞同：6
> 
> 时间：2008-10-17T13:29:00.860
> 
> 标签：java, testing, logging, manual-testing, exploratory

As a test engineer, I often engage in exploratory testing. When I encounter a bug, it is not always immediately clear which steps led to the problem. So, obviously, I have to find the required steps to reproduce the problem. Depending on the situation, this can take a large amount of time.

What would be really helpful is a logging tool that keeps track of mouse and keyboard actions and possibly also stores the properties of components that have been clicked (the AUT is written in Java).

I could simply not find a suitable tool, but maybe my search approach is erroneous.

Could anyone point me to the right direction?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T13:37:04.383

[This question](https://stackoverflow.com/questions/7440/what-do-you-use-to-unit-test-your-web-ui) lists tools that can be used test web applications. Some of the answers may be useful.

One for example is Selenium - a mozilla plugin that records your actions and can be replayed later.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T13:37:44.600

[Log4J](http://logging.apache.org/log4j/1.2/index.html) is an apache logging tool for Java with many options for outputting logs. The nice thing about it is that you can insert as many log messages in the code and switch them on and off based on a logging level as you see fit. So for instance, you have debug messages and info messages. if you insert some debug messages and some info messages in your code then you set the logging level to debug, then you find all debug and info messages are logged.

If you set the logging level to info then only info messages are logged. You have other levels too.

EDIT: I re-read the question and realized that I did not answer correctly...sorry. But, you could put logging statements into the actions in the Java code and accomplish the same thing that you want. It does require a recompile though.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T14:53:41.593

if your testing does NOT take a whole lot of time, you can record your actions(including the whole screen) into a video. You could replay the video to see how the application responded during all your exploration.

1) [http://camstudio.org/](http://camstudio.org/)
2) google for "free screen video capture" for more.

BR,
~A

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-18T02:02:38.823

You may want to check out [BB Test Assistant](http://www.bbsoftware.co.uk/BBTestAssistant.aspx). I saw a very early version of this and was impressed. I've also heard good things from people who have used it since then.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-18T03:30:07.900

In addition to @anjanb suggestion about screen capture, you can run your program under a debugger that records its execution and allows you to step back through the trace.

Omnicore CodeGuide has pretty good implementation of the concept (though you need to postprocess your bytecode). It is a commercial software but it's reasonably priced. Not sure if it's under active development though.

Another (free) product is the [Omniscient Debugger](http://www.lambdacs.com/debugger/debugger.html) which I tested a few years back and found to be inferior to GC (used too much memory, unacceptable slowdowns). Still I see on their webpage that they have made some progress so you might want to check it out.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T16:24:28.780

Check out ReplayDIRECTOR: [http://replaysolutions.com/](http://replaysolutions.com/) Very useful for exploratory testing, as it records all the interactions of your Java app with its surrounding environment (user input, system calls, DB responses), and allows later replay of the recorded session, with the application actually running and executing the same path through the code. The recorded inputs will be fed to the application exactly as during the recording.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T14:54:07.007

There's also Session Tester: [http://sessiontester.openqa.org/](http://sessiontester.openqa.org/)

> Session Tester is an exploratory testing tool for managing and recording Session-Based Testing. Session Tester has a timer so you can keep your test sessions at the desired length, and it provides an easy way to record session notes. Notes are stored in an XML format that can be converted to HTML, or be transformed into whatever form you wish.

# wpf - 将 WPF 应用程序转换为 SilverLight

> ID：212111
> 
> 赞同：18
> 
> 时间：2008-10-17T13:29:13.697
> 
> 标签：wpf, silverlight, silverlight-2.0

是否可以自动/轻松地将现有的 WPF 应用程序转换为 SilverLight？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T23:03:56.533

我认为您可以毫不费力地将 Silverlight 移植到 WPF。我花了 2 小时移植和应用程序，我花了 3 周时间编写。我会争辩说，花费的 2 个小时将归类为最小的努力。

当然，您需要创建一个新项目，将文件添加到新项目并调整它们。

由于 Silverlight 是 WPF 的子集，因此从 Silverlight 到 WPF 的分配比反过来更容易。

对于业务逻辑和非 UI 代码，您的代码应该几乎可以直接移植。我在身份验证方面遇到了一些小问题，因为 Silverlight 2 会在浏览器中获取任何身份验证信息，而[在 WPF 中，您必须扮演自己的登录屏幕并管理 cookie 等](http://jonas.follesoe.no/WCFAuthenticationServicesSilverlightAndSmellyCookies.aspx)。

对于 XAML，如果您不设置控件样式，它将直接移植。如果您为控件设置样式，则使用目前 WPF 中缺少的 Visual State Manager 会使事情变得有点棘手。您可以使用触发器在 WPF 中重新设置控件的样式，也可以使用[John Gossman 为 WPF 完成的 VSM 实现](http://blogs.msdn.com/johngossman/archive/2008/08/08/visualstatemanager-for-desktop-wpf.aspx)。微软已经宣布他们将把 VSM 添加到 WPF 中，以使这两个框架更加兼容。

The perhaps most important reuse tough, is skills and experience. Since the two platforms are so similar you will be able to reuse all your skills in WPF.

I [recently did a blog post about the Dive Log sample application and how I ported it from Silverlight 2 to WPF](http://jonas.follesoe.no/PortingTheSilverlightDiveLogApplicationToWPF.aspx). Might give you some idea of the process.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-17T13:39:17.953

并不真地。我同时发现了一些关于[WPF 和 Silverlight的](http://blogs.msdn.com/dphill/archive/2008/08/31/hello-prism-2-0.aspx)[多目标](http://msdn.microsoft.com/en-us/magazine/cc895632.aspx)选项的文章。目前，如果您不使用[PRISM](http://www.codeplex.com/CompositeWPF)，要同时瞄准它们是一个相当大的挑战，幸运的是可以实现。

您需要记住的是，Silverlight 使用的库比 WPF 更小（因此更有限）。

回应评论：实际上，PRISM（[v2](http://www.codeplex.com/CompositeWPF/Release/ProjectReleases.aspx?ReleaseId=17802)）中已经支持silverlight。PRISM 的理念是为不仅使用 WPF 还使用[Silverlight](http://www.codeplex.com/CompositeWPFContrib/Wiki/View.aspx?title=Prism%20to%20Silverlight)开发应用程序提供指导- Prism V2 正式称为 WPF 和 Silverlight 的复合应用程序指南。通过将 PRISM 用于 silverlight 功能，它可以保证您的代码可以在两个平台上运行，并且只需极少的更改（如果[没有更改的话）（Visual Studio 的不同项目类型可能除外）](http://www.pnpguidance.net/post/Prism2Drop1CompositeWPFSilverlightApplicationGuidancePatternsPractices.aspx)。

但是，当然，如果您已经开始开发应用程序，则需要更改代码以使用 PRISM。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-17T13:47:36.140

威尔和波格丹的回答是正确的。这里的关键词是“最小”。Rob Eisenberg 在[这里](http://devlicio.us/blogs/rob_eisenberg/archive/2008/07/26/silverlight-problems-that-affect-me.aspx)列出了不同之处（尽管这是 RTW 之前的版本）。

### [WPF 和 Silverlight 的差异列表](http://devlicio.us/blogs/rob_eisenberg/archive/2008/07/26/silverlight-problems-that-affect-me.aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-17T13:34:25.467

不，Silverlight 在其自己的 CLR 精简版中运行。它也类似于 WPF，而不是 WPF。你必须做大量的工作来转换它。

* * *

时代变了。查看.NET 4.0 现在支持的[可移植类库](http://msdn.microsoft.com/en-us/library/gg597391.aspx)。您可以构建可在不同支持平台上使用的程序集：WP7、Silverlight WPF 甚至 XBOX 应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T16:53:00.180

Here is a thread about this: [http://silverlight.net/forums/t/3898.aspx](http://silverlight.net/forums/t/3898.aspx)

# .net - 开发人员/架构师在评估消息队列时应该寻找哪些品质？

> ID：212113
> 
> 赞同：4
> 
> 时间：2008-10-17T13:30:27.690
> 
> 标签：.net, message-queue, messaging

在 Java 世界中，消息队列有更多选择，但在 .Net 中，只有少数几种。在评估使用哪一个时，应该寻找哪些特征？构成可靠消息队列系统的基本概念是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T15:50:23.460

如果它是一个开源消息队列，那么我总是会选择一个拥有最大社区的消息队列，这样你就知道你的投资不会被浪费。此外，由于风险，可能会避免实际上只有一家小公司做出贡献的伪开源项目（例如，是什么阻止了公司破产或为其他事情做出贡献？）。例如，[Apache ActiveMQ](http://activemq.apache.org/)有一个[庞大的社区，是](http://www.nabble.com/Java-Software-f787.html)[Apache 最活跃的](http://www.nabble.com/Apache-f90.html)社区之一，同时有[多家公司提供支持和服务](http://activemq.apache.org/support.html)。

如果它是商业或开源的，那么您需要确保它支持您的任何系统要求，例如：通过不同客户端的连接、吞吐量、延迟、可扩展性、持久性、性能、集群、HA 和可靠性。如果它对开发人员和测试和生产都非常容易使用，那么奖励积分。

# c# - 控制台实用程序应用程序版本的方法

> ID：212115
> 
> 赞同：26
> 
> 时间：2008-10-17T13:31:05.783
> 
> 标签：c#, .net, console

在 C# 控制台应用程序中显示主要/次要版本的最佳方法是什么？

`System.Windows.Forms`命名空间包含一个`ProductVersion`类，可用于显示通过 Visual Studio 项目属性（程序集信息）设置的名称/版本信息。因此，这是我目前的机制：

```
Console.WriteLine("{0} ({1})", 
   System.Windows.Forms.Application.ProductName, 
   System.Windows.Forms.Application.ProductVersion); 
```

为什么是这一部分`Forms`？这适合控制台应用程序吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-10-17T13:36:00.593

```
Assembly.GetExecutingAssembly().GetName().Version 
```

此外，您仍然可以使用该类，您只需引用包含的程序集。这没什么大不了的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-17T17:35:14.013

`Assembly.GetExecutingAssembly().GetName().Version`与`Application.ProductVersion`（但可能足够好，具体取决于您的环境。

从 Lutz Reflector 可以看出，`Application.ProductVersion`首先尝试使用**AssemblyInformationalVersion**属性，`Assembly.GetEntryAssembly()`如果它存在，并且如果`GetEntryAssembly()`它不为空。

否则，它使用可执行文件的文件版本。

我看不出有任何理由不在`Application.ProductVersion`控制台应用程序中使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-02T11:12:08.677

下面一行呢

```
Console.WriteLine("FileVersionInfo::ProductVersion : {0}",
  System.Diagnostics.Process.GetCurrentProcess().MainModule.FileVersionInfo.ProductVersion); 
```

# naming-conventions - 非常长的类/变量/属性/方法名称

> ID：212124
> 
> 赞同：6
> 
> 时间：2008-10-17T13:33:19.150
> 
> 标签：naming-conventions, naming, variable-names, class-names

我的一些朋友和同事有一个小小的竞赛来寻找或写出最长的类/变量/属性/方法名。请记住，我们努力成为好男孩和女孩，并保持命名清晰明了，同时仍通过名称解释事物的作用。

有时它只是不会发生。你遇到过这个吗？我只是想看看外面有什么。（也许我和我的朋友并没有我们想象的那么疯狂）

注意：我不是在寻找**错误的**命名。那已经[在这里了](https://stackoverflow.com/questions/143701/what-is-the-worst-classvariablefunction-name-you-have-ever-encountered)。我正在寻找一个有点长的**好名字。**

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-09-08T18:43:41.433

这不是一个类名，而是一个枚举，但它更长：

```
VirtualMachineDeviceRuntimeInfoVirtualEthernetCardRuntimeStateVmDirectPathGen2InactiveReasonOther 
```

来自 VMware vSphere API。谷歌它，你会找到在线文档。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-17T15:11:48.700

它并不长，但我最喜欢的变量名称是表示用户已选择接收电子邮件。

> User.IsSpammable

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-17T13:36:44.807

我发现有描述测试的长测试名称很好。例如：

```
testMapWithOneEntryAllowsDifferentEntryPreservingFirst
testMapWithOneEntryAllowsDuplicateEntryOverwritingFirst 
```

（这些只是我脑海中的例子......不过你明白了。）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-01-29T14:24:11.653

```
org.aspectj.weaver.patterns;

public class HasThisTypePatternTriedToSneakInSomeGenericOrParameterizedTypePatternMatchingStuffAnywhereVisitor {
    boolean ohYesItHas = false;

    public boolean wellHasItThen/*?*/() {
        return ohYesItHas;
    }

    ... more methods...
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-17T15:20:50.993

前段时间，我遇到了 Hibernate 的问题。我在名为 findIntendedAliasedFromElementBasedOnCrazyJPARequirements 的方法中得到了 NullPointerException ！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-17T13:44:26.397

```
protected virtual OcrBarcodeSymbologies GetSupportedBarcodeSymbologies() { } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-17T13:56:54.327

优秀的[GTK+](http://www.gtk.org/)库因此而“受苦”。它有非常整齐的命名函数，但由于主要 API 是 C，而 GTK+ 非常面向对象，它必须在函数名中编码类名。类 X 的构造函数是 X_new()，依此类推。这会导致诸如[gtk_recent_chooser_widget_new_for_manager()](http://library.gnome.org/devel/gtk/stable/GtkRecentChooserWidget.html#gtk-recent-chooser-widget-new-for-manager)之类的好消息。

我敢肯定那里还有更长的函数名称，这只是我很快找到的一个。:)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-26T20:52:23.200

只要没有明显更简洁的名称并且命名合理，长变量名称就不会打扰我。例如，在 Kamaelia 中，有一个类类型命名为：

```
threadedadaptivecommscomponent 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-17T13:35:07.210

查看 Apple 的文档。他们是那方面的国王。非常具有描述性，但有时长达数英里。NSString 类的几个例子：

```
NSString.completePathInfoString:caseSensitive:matchesToArray:filterType
NSString.stringByAddingPercentEscapesUsingEncoding 
```

我在微软世界的最爱：`SetProcessWorkingSetSize`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-17T13:37:22.433

在苹果邮件应用程序中：

```
_synchronouslyTellServicesToRegisterAndSync() 
```

在一个应用程序中，我写道：

```
User.CanViewRestrictedItems() 
```

我的一个应用程序一位同事写道：

```
Profile.DisplayMyDraftOrPendingProfile()
Profile.DisplayMyApprovedProfile() 
```

只是为了开始。

**新的：**

外键约束名称：

```
constraint ReportCompanyReportTemplateIDVersionID_ReportTemplateVersionReportTemplateIDVersionIDFk foreign key (ReportTemplateID, VersionID) references customer_ReportTemplateVersion (ReportTemplateID, VersionID) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-07-28T14:07:26.390

我见过的命名约定，在流利的流行之前几年

```
public DataSet SelectAllUsersWhereDobIsGreaterThan1980AndIsMaleOrderByNameAndAge() 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-03-29T00:09:36.170

```
bool instrumentAreaDockWidgetVisibilityFollowsChildPresence; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-04-20T11:54:42.510

get the `js` items that will be retrieved and if page should display recommendations.

# python - 将 GqlQuery 结果集转换为 python 字典

> ID：212125
> 
> 赞同：3
> 
> 时间：2008-10-17T13:34:03.593
> 
> 标签：python, google-app-engine, gqlquery

假设我有一个这样的模型

```
class Foo(db.Model):
    id = db.StringProperty()
    bar = db.StringProperty()
    baz = db.StringProperty() 
```

我要像这样的 GqlQuery

```
foos = db.GqlQuery("SELECT * FROM Foo") 
```

**我想获取 GqlQuery 的结果并将其转换为某种 JSON 字符串，我可以使用不同的语言对其进行操作。**

* * *

这就是我现在的做法

1.  向**Foo**类添加一个方法，将其转换为字典

    ```
    def toDict(self):
        return {
             'id': self.id,
             'bar': self.bar,
             'baz': self'baz
           } 
    ```

2.  循环遍历 GqlQuery 结果并手动将每个 Foo 实例添加到字典

    ```
    fooDict = {}

    for foo in foos:
        fooDict[foo.id] = foo.toDict()

    return simplejson.dumps(fooDict) 
    ```

* * *

我上面的方法有效，但感觉有点恶心。

有没有更干净、更“Pythonic”的方式来处理这个问题？

**最终格式不必完全是我上面所做的。它必须是可以很好地转换为 JSON 的东西，这样我就可以从 Javascript/PHP/whatever 处理它。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T15:37:18.057

看看[google.appengine.api.datastore](http://code.google.com/p/googleappengine/source/browse/trunk/google/appengine/api/datastore.py)。它是 google.appengine.ext.db 构建的较低级别的数据存储 API，它返回 Entity 对象，它是 dict 的子类。[您可以使用带有google.appengine.ext.gql](http://code.google.com/p/googleappengine/source/browse/trunk/google/appengine/ext/gql/__init__.py)的GQL 来查询它，或者（我个人的偏好）使用 Query 类，这样就无需为 GQL 解析器构建文本字符串来解析。api.datastore 中的 Query 类的行为与[此处记录](http://code.google.com/appengine/docs/datastore/queryclass.html)的完全一样（但返回较低级别的 Entity 对象而不是 Model 实例）。

例如，您上面的查询可以重新表述为“datastore.Query("Foo").all()”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T14:21:25.480

我不能做得比这更好，但这里有几个想法：

```
class Foo:
    id = db.StringProperty() # etc.
    json_attrs = 'id bar baz'.split()

# Depending on how easy it is to identify string properties, there
# might also be a way to assign json_attrs programmatically after the
# definition of Foo, like this
Foo.json_attrs = [attr for attr in dir(Foo)
                  if isStringProperty(getattr(Foo, attr))]

fooDict=dict((foo.id,dict(getattr(foo, attr)
                          for attr in Foo.json_attrs))
              for foo in foos) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T08:41:26.540

[http://code.google.com/p/google-app-engine-samples/source/browse/trunk/geochat/json.py?r=55](http://code.google.com/p/google-app-engine-samples/source/browse/trunk/geochat/json.py?r=55)

编码器方法将很好地解决您的 GQL-to-JSON 需求。我建议摆脱一些过多的日期时间选项......作为一个时代的超时时间？真的吗？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-03T17:15:14.563

您可以在 GAE 上使用 web2py 并执行以下操作：

```
db.define_table('foo',SQLField('bar'),SQLField('baz'))
rows=db(db.foo.id>0).select()
### rows is a list, rows.response is a list of tuples
for row in rows: print  dict(row) 
```

也可以在 Oracle、Postgresql、Mssql、mysql 等上运行。

# java - 如何从 Java EE 中启动多个线程？

> ID：212134
> 
> 赞同：4
> 
> 时间：2008-10-17T13:35:49.487
> 
> 标签：java, tomcat, jakarta-ee

我需要将调用扩展到 Tomcat，并且建议在内部启动线程。有没有人需要这样做，如果需要，他们想出了什么解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T13:46:05.397

通常不鼓励在应用程序服务器中创建自己的线程，因为服务器应该管理线程以获得更好的可伸缩性。如果容器对线程上下文中可用的内容做出假设，例如安全信息（例如，经过身份验证的主题），您也可能会遇到问题。如果您生成一个线程，然后使用该线程中容器未知的服务器资源，通常会发生这种情况。

检查是否有办法从 Tomcat 获取容器管理的线程。WebLogic 和 WebSphere 支持 commonj.WorkManager，它允许您在容器管理的线程上安排工作。Spring 也可以使用 commonj，但我不确定 Tomcat 是否提供该支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T14:09:49.187

除非您有非常特殊的需要，否则您不应该真正从您的 web 应用程序中启动线程。如果没有关于您的问题的更多详细信息，很难判断这是否是解决您的问题的正确方法。

您可能想看看[Quartz](http://www.quartz-scheduler.org/)，它“*是一个功能齐全的开源作业调度系统，可以与几乎任何 J2EE 或 J2SE 应用程序集成或一起使用*”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T13:38:46.767

你的问题有点含糊。Tomcat 本身已经使用线程池来服务 HTTP 请求。您可以通过 Tomcat 配置增加线程数 - 查看 Tomcat wiki 以获取相关信息。

如果您的意思是在您的代码中要启动线程，那么我建议您仔细阅读 Java 5 中引入的 java.util.concurrent API。另请阅读“Java Concurrency in Practice”，这是有关此主题**的**文本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T13:40:46.577

您试图用线程解决的问题是什么？

如果有长时间运行的任务，您应该使用 JMS + 一个完整的 Java EE 容器。

如果您尝试处理过多的负载，您可以考虑两个 tomcat 实例，但是，如果您使用的是 http 会话，则需要调查会话复制。

如果您被迫使用 Tomcat，请考虑在`java.util.concurrency`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T15:28:34.597

托管多线程的 J2EE 抽象是[JCA](http://java.sun.com/j2ee/connector/)。特别是看一下 WorkManager 和 Work 类。另见[这篇文章](http://www.ibm.com/developerworks/java/library/j-jca2/)。Spring 还提供了 JCA 支持的工作管理器抽象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T14:49:54.550

正如其他人所问的那样，您应该提供有关您要完成的工作的更多详细信息。

否则，tomcat 使用线程池。增加池中的线程数。使用较新版本的 tomcat -- 6.x。使用 Java 6.0_10。如果需要，请使用分析器调整应用程序并根据需要调整 JVM 设置。

# header-files - 外部依赖/头文件

> ID：212148
> 
> 赞同：2
> 
> 时间：2008-10-17T13:38:02.447
> 
> 标签：header-files, external-dependencies

在 Windows MSVC6.0 编译器中，如果有一个工作区，其中包含一个项目，那么**Header Files 文件** 夹中会包含哪些文件，**External Dependencies**文件夹中会包含哪些文件？

我认为那些明确包含的文件（#include <*.h> 将在**Header Files 文件**夹中，而这些文件又包含在添加的头文件中，将在**External Dependencies**文件夹中？但似乎并非如此。

那么两者有什么区别呢？

-广告

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T14:16:28.390

列为外部依赖项的头文件不会被分析并且在类视图选项卡中可用。将文件从外部依赖项移动到头文件会将其包含到类视图中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T13:54:01.573

树视图中的文件夹纯粹是为了您的方便（至少在 vs200x 中 - 我不记得在 vc6 中更改过下摆）。
您可以将它们重命名为您想要的任何名称，并将任何文件放在您想要的任何文件夹中。我通常根据程序的各个部分（即 gui、server、fileIO ）创建文件夹，并将类的头文件和 cpp 文件放在同一个文件夹中，这样我就可以快速找到定义和声明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T13:45:57.237

查看工作区中的头文件和#include *.h 的结构后，我发现以下内容：

1.) 那些没有明确添加到 Projects **Header Files 文件**夹，但仍然使用#include 指令包含在不同的头文件和源文件中的文件，由 MSVC 在**External Dependencies文件夹下自动添加到项目中**

但是现在我有一个问题，是让 MSVC 将这些头文件添加为**外部依赖项更好，还是在****Header Files 文件**夹中显式添加更好，或者两者没有区别？

-广告

# language-agnostic - 开发人员在编程语言之间迁移的真正挑战是什么？

> ID：212151
> 
> 赞同：9
> 
> 时间：2008-10-17T13:39:14.207
> 
> 标签：language-agnostic, migration

许多开发人员会声称从一种编程语言迁移到另一种编程语言相对简单，特别是如果这些语言基于相似的范例。然而，在实践中，努力不是来自学习语言的语法，而是来自对语言细微差别的深入理解，更重要的是了解语言库中提供的内容。例如，从 Java 切换到 .Net 从句法的角度来看并不困难，但编程效率需要对可用库有很好的了解。鉴于语言差异，从 PHP 切换到 .Net 可能会遇到更大的障碍。

开发人员在同一范例中迁移到不同语言的真正开销是多少？如果范式不同怎么办？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-17T13:41:56.260

（对我而言）最大的挑战通常是 API，而不是语言本身（尽管有 .NET）。例如，我使用 Microsoft 的 C++ 和 C# 已经很多年了（在那之前的 Delphi）。但是我很难开始使用 Java。即使是琐碎的项目也会花费我一段时间。不是因为语言难（不是），而是因为 API 不同，排列方式不同。

需要几个月的时间来加快 API 的速度，直到你可以流利地使用它，并且需要几年的时间才能变得“好”并学习该语言的所有细节。这对许多开发人员来说是令人生畏的，因为您基本上必须投入大量（如果不是全部）时间和精力来使用新语言工作以成为它的专家。很多时候，你没有离开当前专业领域的动力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T13:45:33.353

相同的范例要容易得多，因为它实际上只是掌握各种库并如您提到的那样快速定位它们的问题。

如果范式不同的话，这个切换就比较困难了。从静态语言到动态语言或从过程语言到 OOP 语言将需要不同的思维方式。这将花费更多时间，但这是可能的，并且仍然是一个非常好的练习。

这可能类似于学习外语。如果你说英语，那么转到另一种基于拉丁语的语言比转到希腊语之类的语言要容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T13:40:59.837

对我来说，它会在该语言上找到优秀的博主和有用的网站。一段时间后，您会知道最好的人在哪里。这些人和网站是了解细节的良好信息来源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T13:41:21.490

离开你的舒适区。我认为这是一些开发人员不学习新语言的最大原因之一。

但对于其他人来说，这就是他们的动力。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T13:58:47.553

在同一范式中移动相对容易。我发现在 Java 和 .NET 之间切换很轻松，因为这两个平台都提供了相似的功能和相似的库。但是转换范式可能是一个真正的挑战。

我的学生在学习 Java 后通常很难再学习函数式和逻辑式语言，尽管函数式和逻辑编程更容易。

另一个问题是在应用程序类型之间切换。例如，如果您习惯于用 Java 构建桌面应用程序，然后突然尝试在 .NET 中构建 Web 应用程序，那么切换是很困难的，因为您不仅要学习新语言，还要学习新的编程领域。

另一个挑战是可用于特定语言的工具集。Java 和 .NET 有类似的工具，但有一些区别。如果您学会了使用 Visual Studio 进行编程，那么 Visual Studio 的功能可能会与语言混淆。我经常看到学生有这个问题。当您切换到 Java 并且在新 IDE 中没有等效的向导菜单选项时，它可能会导致问题。

我提倡学习编程的人学习范式的核心概念而不是特定的语言，因为它让你在未来更加便携。一个熟悉面向对象概念的人将比一个简单地学习如何使用 C# 编程的人更容易在 Java 和 .NET 或 Python 之间切换。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T14:04:08.213

就像学习一门新的人类语言一样，对我来说，最大的问题在于解决问题所需的典型结构。

我知道也许在几种语言中学习“while”或“for”循环并不是那么困难 - 但是当你的问题上升到一个抽象级别时（遍历这个数组）你会发现自己使用“[”而不是“ (" 反之亦然。

如果除了学习一门新语言之外，您还必须学习一个新框架，那么学习曲线可能会更加陡峭。当我从典型的 ASP.Net 转到 MVC（使用 NVelocity）时，我有点觉得自己完全迷失了——我所有关于如何用 asp.net 控制解决典型问题的知识都必须被遗忘。

最后，当你在不同范式的语言之间转换时，最大的挑战就出现了——因为你不能再以同样的方式思考来解决一个问题。就像 - 当从 C# 迁移到 Prolog 时，而不是考虑函数、参数、类层次结构等......我不得不只考虑状态、与数据更改相关的事件以及通过递归链接事件 - 这很疯狂，但我可以完成我的大学作业。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-25T08:15:54.457

拥有 15 年以上的 C++ 背景，我刚刚为我正在从事的一个新项目迁移到 Java，这是一个相当痛苦的步骤。几乎所有东西都有工具和框架，但是学习曲线是巨大的！新语法没什么好担心的，API 比较难，但最难的地方是在所有框架中找到出路。

此外，与 Emacs 相比，必须使用 Eclipse 作为 IDE 在稳定性和可靠性方面是一个倒退。Eclipse 的特性确实很吸引人，但 IDE 中的错误却经常带来麻烦。

# c# - Memory AccessViolationException 错误从 C# 调用 DLL

> ID：212155
> 
> 赞同：2
> 
> 时间：2008-10-17T13:40:37.497
> 
> 标签：c#, c++

从 C# 调用已编译的 DLL 时，我遇到了一个奇怪的内存读/写错误。我使用 DllImport 来获取我们需要的函数的句柄，该函数将返回值写入指向 int 的参数指针（即 int* out）。该函数在一个线程内被多次调用，并在第一个线程的执行生命周期内成功运行。但是，如果在第一个线程完成后启动另一个线程，则对外部 dll 的调用会引发 AccessViolationException。由于来自第一个线程的多次调用成功执行，我认为这与第一个线程没有释放指向相关整数参数的指针（？）有关。如果是这样，我怎样才能显式释放该内存？或者，也许有人对这里可能发生的事情有不同的见解？非常感谢。

编辑：丹尼要求提供更多细节，我很乐意答应。这里是调用外部例程的地方：

```
 int success = -1;
    unsafe
    {
        int res = 0;
        int* res_ptr = &res;
        int len = cmd.ToCharArray().Length;
        int* len_ptr = &len;
        CmdInterpreter(ref cmd, len_ptr, res_ptr);
        success = *res_ptr;
    } 
```

其中 CmdInterpreter 定义为：

```
 [DllImport("brugs.dll", EntryPoint="CmdInterpreter", 
        ExactSpelling=false, CallingConvention = CallingConvention.StdCall)]
    public static unsafe extern void CmdInterpreter(ref string cmd, int *len, int *res); 
```

如果有任何其他有用的信息，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T01:02:51.253

鉴于该问题仅在涉及多个线程时发生，可能是命令解释器 DLL 正在使用某种线程本地存储并且执行不正确。它还可能与第二个线程（产生错误的那个）的 COM 初始化状态有关。

如果您在第一个/主线程上对 DLL 进行任何调用*之前*启动新线程并让它调用 DLL 会发生什么，这会很有趣。如果它有效，那可能支持线程本地存储理论。如果它失败了，那将支持 COM 状态理论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T13:49:41.457

它可能是 [DllImport]。如果您发布 [DllImport] 签名和 DLL 的原型，也许我们可以发现问题。

我读到托管、本机和 COM 互操作团队在 CodePlex 上发布了 PInvoke 互操作助手。[http://www.codeplex.com/clrinterop/Release/ProjectReleases.aspx?ReleaseId=14120](http://www.codeplex.com/clrinterop/Release/ProjectReleases.aspx?ReleaseId=14120)

# windows - 用于 Windows 的 Berkley 数据包过滤器

> ID：212160
> 
> 赞同：-1
> 
> 时间：2008-10-17T13:41:02.677
> 
> 标签：windows, sniffing

Windows 是否支持 Berkley 数据包过滤器，或者是否有类似的东西我应该使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T13:56:10.897

对于 Windows，有[WinPCap](http://www.winpcap.org)可以帮助您做同样的事情。在 XP SP2 和 Vista 上，存在只有管理员才能创建原始数据包的限制。

有关伯克利包过滤器的更多信息[在这里](http://en.wikipedia.org/wiki/Berkeley_Packet_Filter)

# asp.net - 用于 .Net 开发的最佳 VOIP 工具集是什么？

> ID：212168
> 
> 赞同：1
> 
> 时间：2008-10-17T13:43:03.200
> 
> 标签：asp.net, windows, voip

我需要探索将 VOIP 集成到 .Net 应用程序中。如果该工具集可通过 ASP.Net（2.0 版或更高版本）使用，并为开发人员提供允许在客户端上进行交互的选项，可以嵌入在 Web 浏览器中，也可以在客户端 Web 浏览器外部进行交互，这将非常有帮助。它至少应该与 Internet Explorer 兼容，但如果可以选择浏览器独立性会更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-19T17:15:57.047

I don't really understand your question -- what are you trying to DO with VoIP? Since you mentioned ASP.NET I'm guessing you mean some kind of server app? If you explain more about what you want to do, we can give you better advice.

You could check out Microsoft's Speech stuff: [http://www.microsoft.com/speech/speech2007/default.mspx](http://www.microsoft.com/speech/speech2007/default.mspx). As I understand it, Speech Server was moved into being part of OCS. I remember that it supported using .NET 3.0's Workflow Foundation as well as some multi-modal stuff with ASP.NET.

[FreeSWITCH](http://www.freeswitch.org) is a flexible VoIP system that works for both large-scale server implementations as well as embedded scenarios (say as an ActiveX softphone). There is full .NET and Mono support via [mod_managed](http://wiki.freeswitch.org/wiki/Mod_managed). (This allows you to create voice applications in FreeSWITCH using any .NET language.) There's also an XML-based API that allows you to send and receive events to control a remote FS server. You could use this from ASP.NET. FreeSWITCH is very active in #freeswitch@irc.freenode.net so you can get a lot of advice there.

# c# - “运行方式...”无法正确创建用户环境

> ID：212172
> 
> 赞同：3
> 
> 时间：2008-10-17T13:43:44.103
> 
> 标签：c#, .net, windows-server-2003, user-environment

在以非管理员用户运行时，我的 C# 应用程序在某些情况下会崩溃。

我在使用 Windows Server 2003 时遇到问题，我正在尝试查找有关它的更多信息。这可能是其他 Windows 操作系统的问题。

似乎如果我创建一个非管理员用户，然后使用“运行为...”命令在该用户下运行我的应用程序，则用户环境设置不正确，并且 TEMP 环境变量指向 C :\Windows\Temp 而不是用户在“文档和设置”配置文件中拥有自己的 Temp 文件夹。用户没有此文件夹的权限，因此应用程序崩溃，.Net JIT 编译器尝试写入/读取此文件夹。

如果我以该用户身份登录，情况仍然是错误的。我没有准备好你在登录新用户时通常会得到的环境，而且我的应用程序在启动期间仍然无法运行而不会崩溃。事实上，我已经意识到用户无法在 Windows 文件夹中运行 calc.exe 或其他程序。他们的环境似乎永远混乱了，我想唯一的出路就是删除他们的个人资料。

如果我创建一个非管理员用户，并在执行“运行为..”之前以他们的身份登录，他们的环境设置正常，我的应用程序可以正常工作。

我找不到有关此问题的任何信息或有关 Microsoft 是否承认它的说明。你有没有经历过，或者你知道我在哪里可以找到更多关于它的信息吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T14:16:29.467

如果您不是，请考虑使用带有用户配置文件的 runas。

> `C:\temp>runas RUNAS USAGE:`
> 
> ```
> RUNAS [ [/noprofile | /profile] [/env] [/netonly] ]
>         /用户：程序
> 
> RUNAS [ [/noprofile | /profile] [/env] [/netonly] ]
>         /smartcard [/user:] 程序
> 
> ```
> 
> /noprofile 指定不应加载用户的配置文件。这会导致应用程序加载更快，但可能会导致某些应用程序出现故障。
> /profile 指定应加载用户的配置文件。这是默认设置。/env 使用当前环境而不是用户的环境。/netonly 如果指定的凭据仅用于远程访问，则使用。/savecred 使用用户先前保存的凭据。此选项在 Windows XP Home Edition 上不可用，将被忽略。如果要从智能卡提供凭据，则使用 /smartcard。/user 应
> 为 EXE 的 USER@DOMAIN 或 DOMAIN\USER 程序命令行形式。请参阅下面的示例
> 
> 例子：
> 
> > `runas /noprofile /user:mymachine\administrator cmd` `runas /profile /env /user:mydomain\admin "mmc %windir%\system32\dsa.msc"` `runas /env /user:user@domain.microsoft.com "notepad \"my file.txt\""`
> 
> 注意：仅在出现提示时输入用户密码。注意： USER@DOMAIN 与 /netonly 不兼容。注意：/profile 与 /netonly 不兼容。

# visual-studio - 仅使用 Visual Studio 进行 Silverlight 2 开发？

> ID：212173
> 
> 赞同：3
> 
> 时间：2008-10-17T13:43:44.200
> 
> 标签：visual-studio, visual-studio-2008, silverlight, silverlight-2.0, expression-blend

好的，所以请参阅[这个](https://stackoverflow.com/questions/60620/getting-started-with-silverlight-development)和[这个](https://stackoverflow.com/questions/28826/what-exactly-is-microsoft-expression-studio-and-how-does-it-integrate-with-visu)之类的问题，我的问题是 - 是否*必须*使用 Expression Blend 来进行 Silverlight 开发，或者仅使用 Visual Studio 就可以完成其中的任何一个？（2008 年，在这种情况下）

我还没有开始使用 Silverlight，通过我工作场所的 MSDN，我可以毫无问题地获得 Expression Blend，但是对于我的副业，我是否必须放弃 499 美元购买 Expression Blend 2？（我知道有一个试验，但我的想法不止于此）

显然，我担心为了进入 Silverlight 开发需要大量的财务投资，而且我已经拥有 Visual Studio 2008 - 是否可以在没有 Expression Blend 的情况下进行开发，或者那是不可能的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T13:50:51.547

你可以在 Visual Studio 中做任何事情。但是话又说回来，您也可以在记事本中完成所有操作……这完全取决于给定工具在此过程中对您的帮助程度。从设计的角度来看，拥有 Blend 将是一项巨大的资产，但在编程应用程序方面不会真正为您做太多事情。下载试用版，看看它是如何工作的......如果它增加了价值并节省了时间，那么它非常值得购买。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T13:55:33.083

我听说由于没有 Expression Blend Express 或 Expression Blend Light，至少在一段时间内总会有一个 Blend 版本处于“预览”状态，并且下一个版本将在前一个版本到期之前发布。

话虽如此，很难把你的生意押在这样的事情上。[有像Kaxaml](http://www.kaxaml.com/)这样的第三方工具可以做一些 Blend 可以做的事情，我不会惊讶地看到更多来填补这个空白。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T06:49:34.750

您可以在 Visual Studio 2008 中执行此操作，它会起作用。我在尝试只做 Visual Studio 时遇到的问题是，我发现在 Blend 中做事的速度比在 Visual Studio 中要快得多。视觉设计师非常不同，根据您要做什么，您可能会发现自己同时使用这两种环境。

如果你只做小项目，而不是很多 UI 组件，那么你可以只使用 Visual Studio。但是，如果您正在做大量的设计工作并且 UI 对您很重要，那么我建议您使用整个表达式工作室，因为您会发现自己使用 Blend 和 Designer。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T13:47:53.597

这是完全可能的。如果你不太在意眼糖。Blend 与其说是开发工具，不如说是设计师的工具。

如果您至少是[Microsoft 注册合作伙伴](http://partner.microsoft.com/)，则可以尝试 Microsoft Action Pack[网络解决方案](http://partner.microsoft.com/40047166)特别版。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T18:00:34.663

现在您甚至可以使用 Eclipse。:)

# c# - 什么是 C# Using 块，我为什么要使用它？

> ID：212198
> 
> 赞同：306
> 
> 时间：2008-10-17T13:49:20.583
> 
> 标签：c#, .net, syntax, using, using-statement

`Using`C#中块的目的是什么？它与局部变量有何不同？

* * *

## 回答 #1

> 赞同：365
> 
> 时间：2008-10-17T13:51:33.387

如果该类型实现 IDisposable，它会自动释放该类型。

鉴于：

```
public class SomeDisposableType : IDisposable
{
   ...implmentation details...
} 
```

这些是等价的：

```
SomeDisposableType t = new SomeDisposableType();
try {
    OperateOnType(t);
}
finally {
    if (t != null) {
        ((IDisposable)t).Dispose();
    }
} 
```

```
using (SomeDisposableType u = new SomeDisposableType()) {
    OperateOnType(u);
} 
```

第二个更容易阅读和维护。

* * *

从 C# 8 开始，有一种[新的语法`using`](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-8#using-declarations)可以使代码更具可读性：

```
using var x = new SomeDisposableType(); 
```

它没有自己的`{ }`块，使用的范围是从声明点到声明它的块的末尾。这意味着您可以避免以下内容：

```
string x = null;
using(var someReader = ...)
{
  x = someReader.Read();
} 
```

并有这个：

```
using var someReader = ...;
string x = someReader.Read(); 
```

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2008-10-17T13:50:55.043

`Using``Dispose()`在 -block 离开后调用`using`，即使代码抛出异常。

因此，您通常`using`用于需要在它们之后进行清理的类，例如 IO。

所以，这个 using 块：

```
using (MyClass mine = new MyClass())
{
  mine.Action();
} 
```

会做同样的事情：

```
MyClass mine = new MyClass();
try
{
  mine.Action();
}
finally
{
  if (mine != null)
    mine.Dispose();
} 
```

使用`using`方式更短，更易于阅读。

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2008-10-17T13:53:41.200

来自 MSDN：

> C# 通过 .NET Framework 公共语言运行时 (CLR) 自动释放用于存储不再需要的对象的内存。内存的释放是不确定的；每当 CLR 决定执行垃圾回收时，就会释放内存。但是，通常最好尽快释放文件句柄和网络连接等有限资源。
> 
> using 语句允许程序员指定使用资源的对象何时应该释放它们。提供给 using 语句的对象必须实现 IDisposable 接口。该接口提供了 Dispose 方法，该方法应该释放对象的资源。

换句话说，该`using`语句告诉 .NET 在`using`不再需要块中指定的对象时释放它。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2012-01-13T00:01:38.670

using 语句用于处理 C# 中实现`IDisposable`接口的对象。

该`IDisposable`接口有一个称为`Dispose`用于处置对象的公共方法。当我们使用 using 语句时，我们不需要在代码中显式地处理对象，using 语句会处理它。

```
using (SqlConnection conn = new SqlConnection())
{

} 
```

当我们使用上面的块时，内部代码是这样生成的：

```
SqlConnection conn = new SqlConnection() 
try
{

}
finally
{
    // calls the dispose method of the conn object
} 
```

有关更多详细信息，请阅读：[了解 C# 中的“使用”语句](http://www.codeproject.com/KB/cs/tinguusingstatement.aspx)。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-17T13:54:22.617

```
using (B a = new B())
{
   DoSomethingWith(a);
} 
```

相当于

```
B a = new B();
try
{
  DoSomethingWith(a);
}
finally
{
   ((IDisposable)a).Dispose();
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-05-28T12:46:57.010

另请注意，通过实例化的对象`using`在 using 块中是只读的。[请参阅此处](http://msdn.microsoft.com/en-us//library/yh598w02.aspx)的官方 C# 参考。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-17T13:51:03.263

将代码放在 using 块中可确保在控制离开该块时立即释放对象（尽管不一定要收集）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-17T13:53:44.490

它实际上只是一些语法糖，不需要您对实现 IDisposable 的成员显式调用 Dispose。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-10-05T06:45:47.433

using 语句获取一个或多个资源，执行一个语句，然后释放该资源。

# c# - ASP.NET MVC URL 生成性能

> ID：212201
> 
> 赞同：15
> 
> 时间：2008-10-17T13:50:16.260
> 
> 标签：c#, performance, asp.net-mvc-routing

ASP.NET MVC 的小基准测试。查看页面代码：

```
 public string Bechmark(Func<string> url)
    {
        var s = new Stopwatch();
        var n = 1000;

        s.Reset();
        s.Start();
        for (int i = 0; i < n; i++)
        {
            var u = url();
        }
        s.Stop();
        return s.ElapsedMilliseconds + " ms, " + ((s.ElapsedMilliseconds) / (float)n) + " ms per link<br/>";
    } 
```

查看代码：

```
<%= Bechmark(() => Url.Action("Login", "Account")) %>

<%= Bechmark(() => Url.Action("Login", "Account", new {username="bla", password="bla2", returnurl="blabla32", rememberme=false} )) %>

<%= Bechmark(() => Html.BuildUrlFromExpression<AccountController>(a=>a.ChangePassword("bla", "bla", "ya")) ) %> 
```

在具有 ASP.NET MVC Beta 的默认新项目模板上的典型 Core2 笔记本上运行此程序会产生以下结果：

> 38 毫秒，每个链接 0,038 毫秒
> 
> 120 毫秒，每个链接 0.12 毫秒
> 
> 54 毫秒，每个链接 0,054 毫秒

在一个包含大约 10 个控制器的生产项目上运行相同的基准测试，总共有大约 100 个方法和 30 个路由表条目，基于表达式的方法的性能大大降低：

> 31 毫秒，每个链接 0,031 毫秒
> 
> 112 毫秒，每个链接 0,112 毫秒
> 
> 450 毫秒，每个链接 0.45 毫秒

我们经常使用这种方法（可维护性）并进行一些性能基准测试，这大大降低了网站的性能 - 页面很快包含大约 30 个或更多这样的链接，这意味着单个页面上的额外开销为 10 毫秒。即使是每个 URL 的 0.112 毫秒，也大约是 4 毫秒的纯 CPU 开销。

应该注意的是，MVC Preview 3 和 Beta（昨天发布）之间的所有三个 URL 生成调用的性能都提高了 5 倍。

Stack Overflow 应该由相同的框架提供支持，你们是如何解决这个扩展问题的？首页（大量链接）和预渲染控件的自由缓存？

ASP.NET MVC 中的其他生产网站是否存在性能问题或一些好的提示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-19T14:02:10.993

我在 MS 论坛上问了这个问题，得到了 MS MVC 开发人员的回答。

[帖子](http://forums.asp.net/t/1335585.aspx)

**答案**

> 从 MVC Preview 2 到昨天最近发布的 MVC Beta，路由发生了很多变化。其中一些更改包括性能改进。这里有一些技巧可以让您的应用程序中的 URL 生成更加高效：
> 
> 1.  使用命名路由。命名路由是路由的可选功能。这些名称仅适用于 URL 生成 - 它们从不用于匹配传入的 URL。当您在生成 URL 时指定名称时，我们将仅尝试匹配该一个路由。这意味着即使您指定的命名路由是路由表中的第 100 条路由，我们也会直接跳转到它并尝试匹配。
>     
>     
> 2.  将您最常用的路由放在路由表的开头。这将提高 URL 生成和处理传入 URL 的性能。路由工作基于第一场比赛获胜的规则。如果第一个匹配项是路由表中的第 100 个路由，那么这意味着它必须尝试 99 个其他路由并且没有一个匹配。
>     
>     
> 3.  不要使用 URL 生成。有些人喜欢，有些人不喜欢。掌握起来有点棘手。如果您的 URL 非常动态，那么使用它会很好，但是当您开始的 URL 非常少并且您可能并不关心它们的外观时，它可能会有点麻烦。
>     
>     
> 
> 我最喜欢的选项是 #1，因为它非常易于使用，并且从应用程序开发人员的角度（就是您！），它还使 URL 生成更具确定性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T14:15:11.467

好的，空白模板项目的两个额外指标：

```
<%= Bechmark(() => Url.Action("Login", "Account", new Dictionary<string, object> {{"username", "bla"}, {"password", "bla2"}, {"returnurl", "blabla32"}, {"rememberme", "false"}})) %>

<%= Bechmark(() => Url.Action("Login", "Account", new RouteValueDictionary(new Dictionary<string, object> {{"username", "bla"}, {"password", "bla2"}, {"returnurl", "blabla32"}, {"rememberme", "false"}}))) %> 
```

结果：

> 71 毫秒，每个链接 0,071 毫秒
> 
> 35 毫秒，每个链接 0,035 毫秒

使用更糟糕的代码获得更好的性能。太糟糕了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T13:58:01.503

缓存链接可能对团队来说是一个很好的建议，因为它们在整个过程的生命周期内都不会改变（无论如何对于大多数应用程序来说）。

在您开始以可配置的形式（例如 web.config 或在数据库中）定义路由之前，您必须缩减一点。

我怀疑中间示例的很大一部分延迟是自动转换为字典的匿名类型。在这里缓存 URL 无济于事 b/c 您仍然需要反映该类型。

同时，您可以为一些基于字典的链接创建自己的辅助方法，这些链接可以获取您需要的确切输入。然后你可以自己处理缓存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T17:43:58.630

> 缓存链接可能对团队来说是一个很好的建议，因为它们在整个过程的生命周期内都不会改变（无论如何对于大多数应用程序来说）。

你怎么能缓存链接，据我所知你不能这样做，因为你需要缓存被执行的方法，这发生在路由被解析之后，这是缓慢的部分。

# winapi - 如何获取java应用程序的图标？

> ID：212212
> 
> 赞同：3
> 
> 时间：2008-10-17T13:51:40.453
> 
> 标签：winapi

我有一个代码，列出了 win32 框上正在运行的应用程序，然后显示他们的图标。

到目前为止一切顺利，我得到了应用程序的 hwnd，然后调用 GetClassLong(hwnd,GCL_HICONSM)，一切都很好。

但是处理 java 应用程序的情况很痛苦，因为响应我的调用的进程是 javaw.exe，而不是闪亮的、pimpy 的 java 应用程序，它有一个非常漂亮的图标......

我也给了 GetWindowThreadProcessId 一个镜头，但是唉，它是返回的 javaw 的 PID ......

不过有一种方法可以做到这一点，因为任务管理器 (alt+tab) 会显示好图标。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T12:01:00.660

我回答了我自己的问题，感谢[PhiLho](https://stackoverflow.com/users/15459/philho)让我走上了正确的道路：[Codeproject](http://www.codeproject.com/KB/dotnet/AltTab.aspx)的一篇文章使用正确的算法来获取窗口图标（无论它是否是 java）：

//第一次尝试：

SendMessageTimeout(WM_GETICON)

//如果没有找到图标，试试

GetClassLong(GCL_HICONSM)

//如果还是没有图标，试试

SendMessageTimeout(WM_WM_QUERYDRAGICON)

//如果还是没有图标，你就完蛋了，返回一个错误，或者一个空图标

由于某种原因，Java 应用程序会响应第一个调用，但不会响应其他调用，这似乎是由 javaw.exe 处理的。

再次感谢 PhiLho。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T16:34:44.633

嗯，它可以完成，因为[Process Viewer](http://www.teamcti.com/pview/prcview.htm "进程查看器")有一个 Show Applications 按钮可以做到这一点（即使主视图显示 Java 的图标）。唉，这个免费软件不是开源的，所以它不会说出它的秘密...... :-(

Sysinternals 的 ProcMon 不这样做，唉。

我会再挖掘一点...... :-)

[编辑] 如果 GCL_HICON 失败，MS KB 文章和[代码项目](http://www.codeproject.com/KB/dotnet/AltTab.aspx "选择正在运行的应用程序")文章都建议使用 WM_QUERYDRAGICON...

# iphone - 在下载网络资源时显示加载图标

> ID：212215
> 
> 赞同：8
> 
> 时间：2008-10-17T13:52:11.513
> 
> 标签：iphone, ios, networking

我试图在我的 iPhone 应用程序下载网络资源时显示加载图标，但我不知道如何让它正确显示。

我四处搜索并找到了有关`UIActivityView`该类的一些详细信息，但是可用的示例源代码不起作用，并且文档有点简洁。

有人可以提供一个关于如何使用这个类的简单例子吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-17T15:07:10.317

假设您已经设置了一个视图控制器，并且想要添加一个视图控制器，`UIActivityIndicator`您可以这样做：

（假设您有一个名为 的成员变量`indicator`，您可以稍后使用它来清理）

**对于您的界面（.h 文件）：**

```
UIActivityIndicator *indicator; 
```

**对于您的实现（.m 文件）：**

**开始动画**

```
CGRect b = self.view.bounds;
indicator = [[UIActivityIndicator alloc] initWithActivityIndicatorStyle: 
                                             UIActivityIndicatorStyleWhite];
//center the indicator in the view
indicator.frame = CGRectMake((b.size.width - 20) / 2, (b.size.height - 20) / 2, 20, 20); 
[self.view addSubview: indicator];
[indicator release];
[indicator startAnimating]; 
```

**停止动画**

```
[indicator removeFromSuperview];
indicator = nil; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T18:17:25.160

Ben 的回答看起来与我正在做的非常相似 - 你对线程的猜测可能是准确的。你是`NSURLConnection`用来处理你的下载吗？如果是这样，您使用的是同步版本还是异步版本？如果它是同步版本，并且您只是在同步调用周围启动和停止动画，那么 UI 在您停止动画之前不会更新。

# nlp - 对于对自然语言处理感兴趣的人来说，什么是好的起点？

> ID：212219
> 
> 赞同：42
> 
> 时间：2008-10-17T13:52:51.623
> 
> 标签：nlp, dcg

# 问题

因此，我最近提出了一些新的可能项目，这些项目必须处理从用户提交和生成的文本中获取“意义”。

[自然语言处理](http://en.wikipedia.org/wiki/Natural_language_processing)是处理这类问题的领域，经过一些初步研究，我发现了[OpenNLP Hub](http://opennlp.sourceforge.net/)和大学的合作，比如[尝试项目](http://attempto.ifi.uzh.ch/site/)。而stackoverflow有[这个](https://stackoverflow.com/questions/88984/your-favorite-natural-language-parser)。

如果有人可以将我链接到一些好的资源，从研究论文和介绍性文本到 api，我会比一个 6 岁的孩子打开他的圣诞礼物更快乐！

# 更新

通过您的一项建议，我发现[了 opencyc](http://www.opencyc.org/)（*“世界上最大、最完整的通用知识库和常识推理引擎”*）。更令人惊奇的是，有一个项目是 opencyc 的精炼版本，名为[UMBEL](http://umbel.org/)。它具有 rdf/owl/skos n3 语法中的语义数据。

我还偶然发现了[antlr](http://antlr.org/)，这是一个解析器生成器，用于*“从语法描述中构建识别器、解释器、编译器和翻译器”*。

我在这里提出了一个问题，列出了大量[免费和开放的数据](https://stackoverflow.com/questions/202092/where-can-i-find-free-and-open-data)。

感谢stackoverflow社区！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-18T14:00:44.443

艰难的呼吁，NLP 是一个比大多数人想象的更广泛的领域。基本上，语言可以分为几类，这需要你学习完全不同的东西。

在我开始之前，让我告诉你，如果没有某个（密切相关的）领域的学位，我怀疑你会取得任何显着的成功（至少作为专业人士）。涉及的理论很多，大部分都是枯燥的东西，很难学。你需要很多耐力，最重要的是：时间。

如果您对文本的含义感兴趣，那就是 Next Big Thing。语义搜索引擎预计将启动 Web 3.0，但我们离“那里”还很远。从文本中提取逻辑取决于几个步骤：

*   标记化，分块
*   词汇层面的消歧（时光如箭，果蝇如香蕉。）
*   句法分析
*   形态分析（时态、体态、格、数等）

一个小清单，在我脑海中浮现。还有更多:-)，以及每一点的更多细节。例如，当我说“解析”时，这是什么？有*许多*不同的解析算法，也有同样多的解析形式。其中最强大的是[树邻接语法](https://secure.wikimedia.org/wikipedia/en/wiki/Tree_adjoining_grammar)和[头部驱动的短语结构语法](https://secure.wikimedia.org/wikipedia/en/wiki/HPSG)。但是它们都很少在该领域中使用（目前）。通常，您将处理一些半生不熟的生成方法，并且必须自己进行形态分析。

从那里到语义是一大步。语法/语义接口依赖于所使用的句法*和*语义框架，目前还没有单一的工作解决方案。在语义方面，有经典的生成语义，然后是[话语表示理论](https://secure.wikimedia.org/wikipedia/en/wiki/Discourse_Representation_Theory)、[动态语义](http://staff.science.uva.nl/~stokhof/papers.html)等等。甚至一切都基于的逻辑形式主义仍然没有明确定义。有人说应该使用一阶逻辑，但这似乎还不够；然后是蒙太古使用的内涵逻辑，但这似乎过于复杂，并且在计算上不可行。还有动态逻辑（Groenendijk 和 Stokhof 开创了这个东西。很棒的东西！）最近，实际上是今年夏天，[Jeroen Groenendijk](http://home.medewerker.uva.nl/j.a.g.groenendijk/)提出了一种新的形式主义，*Inquisitive* *Semantics*，也很有趣。

如果您想从一个非常简单的层面开始，请阅读[Blackburn 和 Bos (2005)](http://homepages.inf.ed.ac.uk/jbos/comsem/)，这是很棒的东西，以及事实上的计算语义介绍！正如 Groenendijk 和 Stokhof (1982) 所提出的，我最近扩展了他们的系统以涵盖问题的划分理论（问题回答是一头野兽！），但不幸的是，该理论在个人领域具有 O(n²) 的复杂性. 这样做的时候，我发现 B&B 的实现有点，呃…… hackish，在某些地方。尽管如此，它确实会真正帮助您深入了解计算语义，而且它仍然是一个非常令人印象深刻的展示可以做什么。此外，他们应该获得额外的酷点来实现在低俗小说（电影）中解决的语法。

当我在做的时候，拿起Prolog。许多计算语义的研究都是基于 Prolog 的。[立即学习 Prolog！](http://www.coli.uni-saarland.de/~kris/learn-prolog-now/)是一个很好的介绍。我还可以推荐《The Art of Prolog》和 Covington 的《Prolog Programming in Depth》和《Prolog Programmers 的自然语言处理》，前者可在线免费获得。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-16T04:05:56.080

Chomsky 完全是寻找 NLP 的错误来源（他自己也会这么强调）——参见 Abney 的“ [Statistical Methods and Linguistics](http://www.vinartus.net/spa/95c.pdf) ”。

上面提到的 Jurafsky 和 ​​Martin 是标准参考，但我自己更喜欢[Manning 和 Schütze](http://nlp.stanford.edu/fsnlp/)。如果您对 NLP 很认真，您可能会想同时阅读这两本书。[网上](http://see.stanford.edu/SEE/lecturelist.aspx?coll=63480b48-8819-4efd-8412-263f1a472f5a)有 Manning 的一门课程的视频。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T09:38:48.563

如果您通过 Prolog 直到现在 Learn Prolog 中的 DCG 章节！上面 Dimitrov 先生提到，您将有一个良好的开端，将一些语义融入您的系统，因为 Prolog 为您提供了一种非常简单的方法来维护知识和信念数据库，可以通过问答进行更新。

关于文献，我给你一个主要的建议：用完并购买Jurafsky & Martin 的[Speech and Language Processing](http://www.cs.colorado.edu/~martin/slp.html)。这几乎是一本关于 NLP*的*书（第一章可在线获取）；在一所大学的课程中使用，但对于非语言学家和实践导向的人来说也非常易读，同时对语言学问题进行了相当深入的研究。我真的不能推荐它。第 17、18 和 21 章似乎是您正在寻找的内容（第一版中的第 14、15 和 18 章）；他们向您展示了简单的 lambda 符号，它可以很好地转换为具有功能的 Prolog DCG。

哦，顺便说一句，关于获得语言学硕士学位；如果你喜欢 NL 语义，我宁愿推荐你能找到所有与 AI 相关的课程（尽管任何关于“普通”语言语义、逻辑、逻辑语义、[DRT](http://en.wikipedia.org/wiki/Discourse_Representation_Theory)、[LFG](http://en.wikipedia.org/wiki/Lexical_Functional_Grammar) /HPSG/CCG、NL的课程解析，形式语言理论等不会受到伤害......）

阅读乔姆斯基的原著并没有什么用处；据我所知，目前还没有与他的理论*直接*对应的实现，他的所有有用的东西几乎都被其他理论所包含（并且任何在任何时间都与语言学家保持密切联系的人都会通过渗透吸收乔姆斯基的知识） .

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-14T02:23:01.750

我强烈建议您使用[NLTK](http://www.nltk.org/)并阅读[NLTK Book](http://www.nltk.org/book)。NLTK 非常强大且易于上手。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T14:00:28.860

您可以尝试阅读一些有关[短语结构化语法](http://en.wikipedia.org/wiki/Generalised_phrase_structure_grammar)的内容，这基本上是许多语言处理背后的数学。它实际上并没有那么重，主要基于集合和图论。我在很多个月前作为离散数学课程的一部分研究了它，我想在这个阶段有很多很好的参考资料。

编辑：没有我在谷歌上的预期，虽然[这个](http://www.ling.gu.se/~lager/Labs/PSG-Lab/help.htm)看起来是一个很好的学习资源。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-17T14:01:11.417

NLP 的早期探索者之一是 Noam Chomsky。他在 50 年代到 70 年代写了关于这个主题的小书。您可能会发现阅读引人入胜。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-17T14:20:19.880

Cycorp[简要描述](http://www.cyc.com/cyc/cycrandd/areasofrandd_dir/nlu)了他们的 Cyc 知识库如何从句子中获取含义。

通过利用大量的常见事实知识库，系统可以确定句子的最合乎逻辑的解析。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-20T14:33:54.657

从构建块开始的一个更简单的地方是查看尝试执行此操作的包的文档。我推荐 Python [Natural Language Toolkit (NLTK) [1](http://nltk.sourceforge.net/index.php/Book)，特别是因为他们[写得很好，免费的书](http://nltk.sourceforge.net/index.php/Book)，里面充满了例子。它不会让你一直得到你想要的（这是一个人工智能难题），但它会给你一个很好的立足点。NLTK 具有解析器、分块器、上下文无关语法等。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-20T14:50:11.067

这**真是件**难事。我会从至少获得语言学硕士学位开始，然后攻读计算机科学博士学位，专注于 NLP。

问题是我们大多数人不了解什么是语言。如果没有这种理解，实施解决方案将非常困难。

其他评论给出了一些读数，如果您想开始解决问题的一小部分，这可能很好，但是为了提出一个真正强大的解决方案，没有捷径可走。你需要这两个学科的学术背景。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-20T14:44:47.803

Steven Pinker 的 The Language Instinct 是一个非常有趣的可读介绍。它涉及乔姆斯基的东西，还从进化生物学的角度讲述了有趣的故事。如果您是该主题的新手，那么在深入研究乔姆斯基的论文和相关工作之前，可能值得从类似的东西开始。

# parsing - Gold Parsing System - 它在编程中可以用来做什么？

> ID：212228
> 
> 赞同：2
> 
> 时间：2008-10-17T13:54:39.793
> 
> 标签：parsing, gold-parser

我已阅读 GOLD 主页 ( [http://www.devincook.com/goldparser/](http://www.devincook.com/goldparser/) ) 文档、常见问题解答和维基百科，以了解 GOLD 可能有哪些实际应用。我一直在考虑为我的系统（例如 SAP 上的 ABAP 或 Axapta 上的 X++）提供一种编程语言（很容易）——但它对我来说并不可行，至少不容易——即使你使用 GOLD。

GOLD 生成的解析结果的最终用途让我无法理解 - 你如何处理解析的结果？

编辑：一个实际的例子（描述）会很棒。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T15:00:52.407

解析实际上包括两个阶段。第一个是“词法分析”，它将原始字符串转换为程序更容易理解的东西（通常称为标记）。

简单的例子，lex 会转换：

如果 (a + b > 2) 那么

进入：

```
IF_TOKEN LEFT_PAREN IDENTIFIER(a) PLUS_SIGN IDENTIFIER(b) GREATER_THAN NUMBER(2) RIGHT_PAREN THEN_TOKEN

```

解析采用该标记流，并尝试从它们中获得更多意义。在这种情况下，它会尝试将这些标记与 IF_STATEMENT 匹配。对于解析，IF _STATEMENT 可能看起来像这样：

```
IF (BOOLEAN_EXPRESSION) 那么
```

在词法分析阶段的结果是令牌流的情况下，解析阶段的结果是解析树。

因此，解析器可以将上述内容转换为：

```
    if_statement
        |
        v
    boolean_expression.operator = GREATER_THAN
       | |
       | v
       V numeric_constant.string="2"
    expression.operator = PLUS_SIGN
     | |
     | v
     v 标识符.string = "b"
   标识符.string = "a"

```

在这里你看到我们有一个 IF_STATEMENT。IF_STATEMENT 有一个参数，即 BOOLEAN_EXPRESSION。这以某种方式向解析器解释。当解析器转换令牌流时，它“知道” IF 是什么样的，并且知道 BOOLEAN_EXPRESSION 是什么样的，因此它可以在看到代码时进行正确的分配。

例如，如果您刚刚：

如果 (a + b) 那么

解析器可以知道它不是布尔表达式（因为 + 是算术运算符，而不是布尔运算符），此时解析器可能会抛出错误。

接下来，我们看到一个 BOOLEAN_EXPRESSION 有 3 个组件，运算符 (GREATER_THAN) 和两侧，左侧和右侧。

在左侧，它指向另一个表达式“a + b”，而在右侧，它指向一个 NUMERIC_CONSTANT，在本例中为字符串“2”。同样，解析器“知道”这是一个 NUMERIC 常量，因为我们告诉它有关数字字符串的信息。如果不是数字，它将是一个标识符（如“a”和“b”）。

请注意，如果我们有类似的东西：

如果 (a + b > "XYZ") 那么

那“解析”就好了（左边的表达式，右边的字符串常量）。我们不知道这是否是一个有效的表达式。此时我们不知道“a”或“b”是否引用字符串或数字。因此，这是解析器无法为我们决定的，也无法将其标记为错误，因为它根本不知道。当我们评估（执行或尝试编译成代码）IF 语句时，就会发生这种情况。

如果我们这样做了：

如果 [a > b) 那么

解析器可以很容易地将语法错误视为一个问题，并将抛出一个错误。那串令牌看起来不像它知道的任何东西。

所以，关键是当你得到一个完整的解析树时，你有一些保证，一开始切割“代码看起来不错”。现在在执行过程中，很可能会出现其他错误。

要评估解析树，您只需遍历树即可。在编译或评估部分，您将有一些与解析树的主要节点相关联的代码。假设我们有一个解释器。

```
public void execute_if_statment(ParseTreeNode node) {
    // We already know we have a IF_STATEMENT node
    Value value = evaluate_expression(node.getBooleanExpression());
    if (value.getBooleanResult() == true) {
        // we do the "then" part of the code
    }
}

public Value evaluate_expression(ParseTreeNode node) {
    Value result = null;
    if (node.isConstant()) {
        result = evaluate_constant(node);
        return result;
    }
    if (node.isIdentifier()) {
        result = lookupIdentifier(node);
        return result;
    }
    Value leftSide = evaluate_expression(node.getLeftSide());
    Value rightSide = evaluate_expression(node.getRightSide());
    if (node.getOperator() == '+') {
        if (!leftSide.isNumber() || !rightSide.isNumber()) {
            throw new RuntimeError("Must have numbers for adding");
        }
        int l = leftSide.getIntValue();
        int r = rightSide.getIntValue();
        int sum = l + r;
        return new Value(sum);
    }
    if (node.getOperator() == '>') {
        if (leftSide.getType() != rightSide.getType()) {
            throw new RuntimeError("You can only compare values of the same type");
        }
        if (leftSide.isNumber()) {
            int l = leftSide.getIntValue();
            int r = rightSide.getIntValue();
            boolean greater = l > r;
            return new Value(greater);
        } else {
            // do string compare instead
        }
    }
} 
```

所以，你可以看到我们这里有一个递归评估器。您会看到我们如何检查运行时类型并执行基本评估。

将会发生的是 execute_if_statement 将评估它的主要表达式。即使我们在解析中只需要 BOOLEAN_EXPRESION，所有表达式对于我们的目的来说大部分都是相同的。因此，execute_if_statement 调用了 evaluate_expression。

在我们的系统中，所有表达式都有一个运算符和一个左右两边。表达式的每一面也是一个表达式，因此您可以看到我们如何立即尝试并评估它们以获得它们的真实值。需要注意的是，如果表达式由 CONSTANT 组成，那么我们只需返回常量值，如果它是标识符，我们将其作为变量查找（这将是抛出“我找不到变量'a'”消息），否则我们回到左侧/右侧的事情。

我希望你能看到一旦你从解析器获得了一个令牌流，一个简单的评估器是如何工作的。注意在评估过程中，语言的主要元素是如何到位的，否则我们会遇到语法错误并且永远不会进入这个阶段。我们可以简单地期望“知道”，例如，当我们有一个 PLUS 运算符时，我们将有 2 个表达式，左侧和右侧。或者当我们执行一个 IF 语句时，我们已经有一个布尔表达式要计算。解析对我们来说是什么繁重的工作。

开始使用一门新语言可能是一个挑战，但是一旦你开始学习，你会发现其余的都变得非常简单，而且最终一切都可以正常工作几乎是“魔法”。

请注意，请原谅格式，但下划线把事情搞砸了——我希望它仍然很清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T14:12:48.070

我会推荐 antlr.org 以获取信息和我将用于任何解析器的“免费”工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T13:59:31.530

GOLD 可用于任何类型的应用程序，您必须将上下文无关语法应用于输入。

阐述：

本质上，CFG 适用于所有编程语言。因此，如果您想为您的公司开发一种脚本语言，您需要编写一个解析器或获取一个解析程序。或者，如果您想为公司中的非程序员输入一种半自然语言，您可以使用解析器来读取该输入并输出更多“机器可读”数据。本质上，上下文无关文法允许您描述比正则表达式更多的输入。GOLD 系统显然比 lex/yacc（用于解析的 UNIX 标准程序）更容易解决解析问题。

# architecture - .NET 中字符串解析的合适层是什么？

> ID：212230
> 
> 赞同：2
> 
> 时间：2008-10-17T13:54:59.947
> 
> 标签：architecture

考虑一个标准的 ASP.NET Web 应用程序，其中用户在表单上键入一些数字数据。在提交时，一些业务对象被启动以对数字数据进行操作。但是 .Net 中的服务器端文本框控件返回字符串类型的值。问题：页面的代码隐藏是否应该负责将字符串解析为数字数据（如果无效则抛出错误），或者业务对象是否应该接受字符串作为输入并自行解析？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T13:56:53.237

IMO，业务对象应该只接受数字类型。根据文化特定的规则，可以以各种格式解析字符串。数字就是数字。您不想更改业务对象以进行本地化 - 仅接受数字会使重用变得更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T14:00:11.217

通常，您希望您的业务逻辑接受它所使用的类型，这样会更清晰。在进入业务逻辑之前格式化传入的数据并对其进行验证是一种很好的做法，因为您实际上并没有对数据进行处理，而是对其进行了预格式化以供业务层使用。当输入验证失败时，这尤其有用，您无需逐步完成即可将其返回给用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T13:59:16.617

业务对象应该只给出正确解析和验证的对象。

现在，这种解析和验证是否应该在代码隐藏中完成？很难说，因为代码隐藏真的不是一层。正确地，代码隐藏应该只处理 UI 问题，并且应该在 UI 和业务之间的控制器层进行解析。但是，大多数人只是将控制器插入代码隐藏中。

# vba - 如何刷新访问表单

> ID：212234
> 
> 赞同：6
> 
> 时间：2008-10-17T13:55:53.347
> 
> 标签：vba, ms-access, refresh

我正在构建一个 MS Access 应用程序，其中所有表单都是模态的。但是，在表单中的数据更改后，我想用更新的数据刷新此表单的父表单。有没有办法做到这一点。进一步阐述：

考虑有两种形式，形式 A 和形式 B。两者都是模态形式。从Form A，我发起Form B，现在Form B得到了用户的关注。但是在表格B结束时，我想刷新表格A。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T14:10:45.843

您可以重新绘制和/或重新查询：

关于表格 B 的关闭事件：

```
Forms!FormA.Requery 
```

你是这个意思吗？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-17T14:51:41.597

> 不，这就像我想运行 Form A 的 Form_Load，如果可能的话

——瓦伦·马哈詹

执行此操作的常用方法是将相关代码放在可以由两种形式调用的过程中。最好将代码放在标准模块中，但您可以将其放在 Form a 中：

表格 B：

```
Sub RunFormALoad()
   Forms!FormA.ToDoOnLoad
End Sub 
```

表格 A：

```
Public Sub Form_Load()
    ToDoOnLoad
End Sub    

Sub ToDoOnLoad()
    txtText = "Hi"
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T14:55:03.463

“重新查询”确实是您想要运行的内容，但您可以在 Form A 的“On Got Focus”事件中执行此操作。如果您的 Form_Load 中有代码，也许您可​​以将其移至 Form_Got_Focus。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-22T13:03:26.223

我建议您使用`REQUERY`您已更改其数据的特定组合框，并且您在`Cmd.Close`语句之后执行此操作。这样，如果您正在输入数据，也会要求该数据。

```
DoCmd.Close
Forms![Form_Name]![Combo_Box_Name].Requery 
```

您可能还想指向最近更改的值

```
Dim id As Integer
id = Me.[Index_Field]
DoCmd.Close
Forms![Form_Name]![Combo_Box_Name].Requery
Forms![Form_Name]![Combo_Box_Name] = id 
```

此示例假设您打开了一个表单以将数据输入到辅助表中。

假设您将 School_Index 和 School_Name 保存在 School 表中，并在 Student 表（仅包含 School_Index 字段）中引用它。在编辑学生时，您需要将他与不在您的学校表中的学校相关联，等等

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2016-09-06T13:54:27.193

**to refresh the form you need to type -** me.refresh in the button event on click

# internet-explorer-7 - 在 IE7 中使用 LightBox 2 的问题

> ID：212236
> 
> 赞同：0
> 
> 时间：2008-10-17T13:56:18.603
> 
> 标签：internet-explorer-7, lightbox

单击使用 Lightbox 2 javascript 图像查看器打开的图像时，我遇到了 IE7 问题。它不会将图像覆盖在当前页面上，而是将图像打开到单独的页面中。

不确定这是否可能是 AJAX 问题？在 Firefox 中运行良好。

其他人以前遇到过这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-11-02T08:49:05.360

您的页面正在执行您在以下情况下所期望的回退行为......

1.  JavaScript 被禁用
2.  创建灯箱效果的 JavaScript 中存在错误（在加载下一页之前，请注意黄色错误图标的短暂闪烁 - 或启动一些开发工具）
3.  *点击图片前*页面出现 JavaScript 错误，导致页面停止执行 JavaScript（再次注意状态栏中的黄色错误图标！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T09:04:08.060

我唯一能想到的是我安装了谷歌工具栏和迈克菲安全，它可能会阻止覆盖（????）但不认为这应该有任何区别。

# c++ - C++ 中的常量和编译器优化

> ID：212237
> 
> 赞同：50
> 
> 时间：2008-10-17T13:56:35.997
> 
> 标签：c++, optimization, compiler-construction

我已经阅读了所有关于 C++ 中 const 正确性的建议，并且它很重要（部分）因为它可以帮助编译器优化你的代码。我从未见过关于编译器如何使用这些信息来优化代码的很好的解释，即使是好书也没有继续解释幕后发生的事情。

例如，编译器如何优化声明为 const 的方法与不是但应该声明的方法。当你引入可变变量时会发生什么？它们会影响 const 方法的这些优化吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-10-17T14:30:37.427

我认为 const 关键字主要是为了程序语义的编译检查而引入的，而不是为了优化。

Herb Sutter 在[GotW #81 文章](http://www.gotw.ca/gotw/081.htm)中很好地解释了为什么编译器在通过 const 引用传递参数或声明 const 返回值时无法优化任何内容。原因是编译器无法确保引用的对象不会被更改，即使声明为 const ：可以使用 const_cast，或者某些其他代码可以在同一对象上具有非常量引用。

但是，引用 Herb Sutter 的文章：

> [只有] 一种情况，说“const”确实意味着什么，那就是当对象在它们被定义的时候变成 const 时。在这种情况下，编译器通常可以成功地将此类“真正的 const”对象放入只读内存 [...]。

这篇文章还有很多内容，所以我鼓励你阅读它：之后你会对不断优化有更好的理解。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-10-17T15:41:05.787

让我们忽略方法，只看 const 对象；编译器在这里有更多的优化机会。如果一个对象被声明为 const，那么 (ISO/IEC 14882:2003 7.1.5.1(4))：

> 除了可以修改任何声明为 mutable (7.1.1) 的类成员外，任何在 const 对象的生命周期 (3.8) 期间修改它的尝试都会导致未定义的行为。

让我们忽略可能具有可变成员的对象 - 编译器可以自由假设该对象不会被修改，因此它可以产生显着的优化。这些优化可以包括以下内容：

*   将对象的值直接合并到机器指令操作码中
*   完全消除由于 const 对象用于编译时已知的条件表达式而永远无法达到的代码
*   如果 const 对象控制循环的迭代次数，则循环展开

请注意，这些内容仅适用于实际对象为 const - 它不适用于通过 const 指针或引用访问的对象，因为这些访问路径可能导致非 const 对象（它甚至可以通过 const 更改对象指针/引用，只要实际对象是非常量的，并且您抛弃了对象访问路径的常量性）。

在实践中，我认为没有编译器可以对所有类型的 const 对象进行任何重大优化。但是对于原始类型的对象（整数、字符等），我认为编译器可以非常积极地优化这些项目的使用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-17T14:03:08.527

*挥手开始*

本质上，数据越早修复，编译器就越能围绕数据的实际分配移动，确保管道不会停止

*结束挥手*

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-17T14:14:56.243

嗯。常量正确性更像是一种样式/错误检查，而不是优化。一个全面优化的编译器将跟踪变量的使用，并且可以检测变量何时有效地为 const 或不是。

除此之外，编译器不能依赖你说真话——你可能会在它不知道的库函数中丢弃 const。

所以是的，const-correctness 是一个值得追求的目标，但它不会告诉编译器任何它自己无法弄清楚的事情，假设一个好的优化编译器。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-17T14:11:02.833

它不会优化声明为 const 的函数。

它可以优化*调用*声明为 const 的函数的函数。

```
void someType::somefunc();

void MyFunc()
{
    someType A(4);   // 
    Fling(A.m_val);
    A.someFunc();
    Flong(A.m_val);
} 
```

这里要调用 Fling，必须将值 A.m_val 加载到 CPU 寄存器中。如果 someFunc() 不是 const，则必须在调用 Flong() 之前重新加载该值。如果 someFunc 是 const，那么我们可以使用仍在寄存器中的值调用 Flong。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-17T14:13:46.713

**将方法**设置为 const的主要原因是为了 const 的正确性，而不是为了可能对方法本身进行编译优化。

如果**变量**是 const 它们可以（理论上）被优化掉。但只有编译器可以看到范围。毕竟编译器必须允许它们在别处使用 const_cast 进行修改。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-23T20:23:00.677

这些都是真实的答案，但答案和问题似乎假设一件事：编译器优化实际上很重要。

只有一种代码对编译器优化很重要，即在代码中

*   紧密的内环，
*   在您编译的代码中，而不是第 3 方库中，
*   不包含函数或方法调用（甚至是隐藏的），
*   程序计数器花费大量时间的地方

如果其他 99% 的代码被优化到第 N 级，它不会有太大的不同，因为它只在程序计数器实际花费时间的代码中很重要（您可以通过采样找到）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-17T14:15:28.363

如果优化器实际上将大量库存放入 const 声明中，我会感到惊讶。有很多代码最终会抛弃 const-ness，这将是一个非常鲁莽的优化器，它依赖于程序员声明来假设状态何时可能改变。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-23T21:25:25.887

const-correctness is also useful as documentation. If a function or parameter is listed as const, I don't need to worry about the value changing out from under my code (unless somebody else on the team is being very naughty). I'm not sure it would be actually worth it if it wasn't built into the library, though.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-17T14:58:08.057

直接优化最明显的一点`const`是将参数传递给函数。确保函数不会修改数据通常很重要，因此函数签名的唯一真正选择是：

```
void f(Type dont_modify); // or
void f(Type const& dont_modify); 
```

当然，这里真正的魔力是传递引用而不是创建对象的（昂贵的）副本。但是如果引用没有被标记为`const`，这会削弱这个函数的语义并产生负面影响（例如使错误跟踪更难）。因此，`const`在此处启用优化。

/EDIT：实际上，一个好的编译器可以分析函数的控制流，确定它不会修改参数并进行优化（传递引用而不是副本）本身。`const`这只是对编译器的帮助。然而，由于 C++ 有一些相当复杂的语义，而且这样的控制流分析对于大函数来说可能非常昂贵，我们可能不应该依赖编译器。有没有人有任何数据支持我/证明我错了？

/EDIT2：是的，一旦自定义复制构造函数开始发挥作用，它就会变得更加棘手，因为不幸的是，编译器不允许在这种情况下省略调用它们。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-17T15:17:55.367

这段代码，

```
class Test
{
public:
  Test (int value) : m_value (value)
  {
  }

  void SetValue (int value) const
  {
    const_cast <Test&>(*this).MySetValue (value);
  }

  int Value () const
  {
    return m_value;
  }

private:
  void MySetValue (int value)
  {
    m_value = value;
  }

  int
    m_value;
};

void modify (const Test &test, int value) 
{
  test.SetValue (value);
}

void main ()
{
  const Test
    test (100);

  cout << test.Value () << endl;
  modify (test, 50);
  cout << test.Value () << endl;
} 
```

输出：

```
100
50 
```

这意味着 const 声明的对象已在 const 成员函数中更改。C++ 语言中 const_cast（和 mutable 关键字）的存在意味着 const 关键字不能帮助编译器生成优化的代码。正如我在之前的帖子中指出的那样，它甚至会产生意想不到的结果。

作为基本规则：

> const != 优化

事实上，这是一个合法的 C++ 修饰符：

```
volatile const 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-10-17T18:51:09.803

`const`帮助编译器优化主要是因为它使您编写可优化的代码。除非你扔进去`const_cast`。

# java - 用于 HTTP 错误的 Java 异常类是什么？

> ID：212239
> 
> 赞同：32
> 
> 时间：2008-10-17T13:56:41.707
> 
> 标签：java, http, exception

我正在使用 Apache [HttpClient](http://hc.apache.org/httpclient-3.x/)并希望通过 Java 异常机制将 HTTP 错误（400 Bad Request、404 Not Found、500 Server Error 等）传达给调用代码。Java 标准库或广泛使用的库中是否存在适合为此目的使用或子类化的异常？

另一种方法是检查状态返回码。这似乎是 HttpClient 的设计理念，但由于这些错误在我的应用程序中确实异常，因此我希望在它们发生时为我设置堆栈跟踪和其他不错的异常。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T14:04:33.703

如果它不是 HttpClient 设计理念中的 Exception，而是您的代码中的 Exception，那么创建您自己的 Exception 类。（作为 org.apache.commons.httpclient.HttpException 的子类）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-17T14:13:09.770

查看[HttpClient 的异常处理页面](http://hc.apache.org/httpclient-3.x/exception-handling.html)

要回答您的问题，尽管似乎有一个可能很合适的[org.apache.commons.httpclient.HttpException类。](http://hc.apache.org/httpclient-3.x/apidocs/index.html)

如果您确实需要一个自定义异常类，我认为[java.io.IOException](http://java.sun.com/javase/6/docs/api/java/io/IOException.html)将是正确使用的超类。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-11-01T15:34:56.797

### 快速回答

在 Spring 中，你有你想要**的：**

*   [HttpClientErrorException](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/client/HttpClientErrorException.html) - 收到 HTTP 4xx 时抛出的异常。
*   [HttpServerErrorException](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/client/HttpServerErrorException.html) - 收到 HTTP 5xx 时引发的异常。

### 和推荐的做法

最低限度，您应该将与业务逻辑相关的异常（例如，余额不足、电子邮件地址无效）与*其他*异常（例如，服务器不可用、不支持的媒体类型、SQLException）区分开来。

在我们的 REST API 中，我们有一个用于 Java 客户端的库，它解析响应并仅抛出三个不同的异常：

*   **400, 401, 403, 404, 409, 422** : throw `MyBusinessException`，其中包含可以显示给最终用户的消息。消息来自响应正文（服务端的异常处理），但如果不存在，我们有一个特定于每个状态代码的默认消息。
*   **405, 412, 415**：抛出`HttpClientErrorException`特定于每个状态代码的消息。
*   **其他 4xx 代码**：抛出`HttpClientErrorException`通用消息。
*   **5xx 代码**：抛出`HttpServerErrorException`通用消息。

*所有这些异常都是未经检查的。*

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-17T14:20:57.150

我想说这取决于您使用 HTTPClient 的目的。例如，PayPal SDK 使用 HttpClient 将 API 调用传输到 PayPal 服务器，但在完成时无法检查 HTTP 响应代码。我修补了我的副本，以便如果响应代码不是 200，它会引发 PayPal FatalException，并带有适当的消息。这是因为调用者对 HTML 或此 HTTP 帖子的任何细节不感兴趣，甚至对我们使用 HTTP 作为传输的事实也不感兴趣。如果调用成功，则响应正文包含事务详细信息，这些详细信息被提取并放入响应对象中；否则它包含无用的 HTML。在这种情况下，HTTP 只是传输，因此某些响应代码表示可以使用异常报告的错误。因为这是 PayPal SDK 的一部分，所以我使用了 PayPal Exception 类。在其他一些系统或库中，我会使用该库已经使用的任何异常的子类型。例如，如果我正在编写一个访问 GMail 帐户的 GMail 库，我可能会创建一个 GMailException 类，并为库遇到的不同类型的异常创建一个子类。或者，您可以使用类似的东西[异常](http://java.sun.com/javase/6/docs/api/java/io/IOException.html)。

HttpClient 让您检查响应代码的原因是因为即使响应代码不是 200，响应也可能有用。一些网站将有用的文本放在 404 页面上，或者为用户提供有用的操作，或者提供搜索表单，或者只是一个有用的错误信息。根据您的用例，您可能只想显示响应内容而不是抛出异常。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-01-27T17:28:32.793

我在 Apache HTTP Client 4.5.7 上发现了这个异常：

```
...
import org.apache.http.client.HttpResponseException;

...
StatusLine statusLine = response.getStatusLine();
if(statusLine.getStatusCode() != 200) {
    throw new HttpResponseException(statusLine.getStatusCode(), statusLine.getReasonPhrase());
}
... 
```

结果样本为：

```
Exception in thread "main" org.apache.http.client.HttpResponseException: status code: 400, reason phrase: Bad Request 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-17T14:12:38.977

如果你想要一个库异常，有[org.apache.commons.httpclient.HttpException 。](http://hc.apache.org/httpclient-3.x/tutorial.html)我们有时也会为特定目的创建自己的异常，既为特定 HTTP 状态代码创建异常，又为意外状态代码创建通用异常。

# apache-flex - 在部署 Flex 应用程序时，我应该预料到哪些类型的生产问题？

> ID：212242
> 
> 赞同：4
> 
> 时间：2008-10-17T13:57:12.767
> 
> 标签：apache-flex

我的公司一直在开发一个显示实时财务信息的 Flex 仪表板。它将通过公司 WAN 部署到可能有几十个用户。

这是我们的第一个 Flex 项目，虽然开发非常愉快，但我们有点担心可能会出现哪些生产问题（用户没有安装正确的 Flash 播放器、下载时间长、BlazeDS 性能等）。

我们的堆栈是 RDBMS/Spring/BlazeDS（远程处理和消息传递）/Flex。

有部署商业 Flex 应用程序经验的人有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T14:17:23.803

您最大的问题可能是：

*   您的用户没有正确版本的 Flash 播放器
*   您的用户有锁定的桌面并且无法下载正确版本的播放器或根本不允许使用播放器
*   如果您有大型应用程序，则 swf 的下载速度
*   由于代码中的错误或网络连接不可用，与后端的连接间歇性丢失
*   限制性浏览器政策

这些都不是不可克服的，但你可能会在最初几个月遇到所有这些。

我假设您已经在合理负载下测试了您的应用程序的性能，并且已经修复了这些可伸缩性问题 :-)

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T09:02:36.277

如果您谈论的是几十个用户，我认为您不会遇到很多性能问题。在我看来，西蒙的第一个树子弹将是最有可能出现的问题。我们有一个带有 .NET/WebORB 后端和 MS SQL2005 服务器的灵活业务解决方案。

前端应用程序的 swf 大小约为 1.2 Mb。如果您有宽带互联网连接，那么下载时间不是问题（因为它是在 WAN 中企业部署的，我想这不是问题）。如果没有，那么用户第一次加载 swf 时会花费一些时间，但是应该会缓存它。（如果您经常有新的构建，缓存是另一个问题。最好是在您的 swf 中有一个上下文菜单，您可以在其中看到构建版本。如果用户在应用程序中遇到问题，我首先检查的事情之一是他们是否已经加载了最后一个版本。）。

有时，500 名候选人同时使用前端播放器。每个玩家定期加载和保存数据到服务器。到目前为止，我们没有遇到任何问题，而且我知道在服务器端使用缓存可以大大提高性能。压力测试在这里很重要，因为很大程度上取决于您的架构、硬件、并发用户......

我们还使用消息传递来进行悲观的并发控制，这完全是另一回事。我们在这里做了很多测试，以使事情正常运行。

在您的项目中，安全性似乎不是一个大问题，因为它是在企业中部署的。但请注意，swf 可用的远程调用在没有安全性的情况下是不安全的。

Lieven Cardoen 又名 Johlero

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T22:59:16.527

我们的日志显示 flex 应用程序会随机断开与我们服务器的连接。我们最终为所有 REST 调用添加了自动重试逻辑。

# html - 如何解决 IE 中的渲染性能问题

> ID：212254
> 
> 赞同：4
> 
> 时间：2008-10-17T14:00:10.500
> 
> 标签：html, windows, performance, internet-explorer, rendering

我们的 web 应用在某些 IE 浏览器中渲染速度很快，在其他浏览器中渲染速度很慢……这似乎是一个 HTML 渲染问题……页面的前 10% 立即显示，最后 90% 最多需要 10 秒，这是静态内容。我使用 firefox/yslow 运行，渲染速度非常快。似乎与 ie 的某些用户/配置隔离。怪癖模式似乎没有什么不同。

是否有可以用来帮助我发现渲染瓶颈的工具或应用程序？我在我的代码中做了一些令人震惊的事情吗？可能是javascript问题吗？任何帮助或建议将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T14:08:58.313

使用Fiddler查看加载图片、css、js文件等的时间。也就是说，缓存是不是有问题？Javascript 肯定会在不同的浏览器版本中引起问题。您可以在某些版本中找到许多其他版本中没有的优化。此外，如果可能，请确保您的 html 是格式正确的 xhtml。页面的排列方式也会影响生活。如果你的文档树很深，它可能需要等待渲染大的部分，直到它读取所有的子节点。需要注意的另一件事是，某些工具栏和插件确实会提前加载，并且会减慢生活速度。HTTP 代理至少可以帮助您观察网络上发生的事情。

不确定这些想法是否可以帮助您解决确切的问题，但它们可以帮助整个生活。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T14:31:14.057

如果它在 FF 或 Chrome 中运行得很快，那肯定是 javascript 问题。IE7 在处理大量脚本和复杂的 HTML 时非常慢。我们有一个共享点页面，在 IE 中渲染需要 10 秒，而在 FF 和 Chrome 中渲染不到 1 秒。我们通过向服务器端处理添加一个计时器并通过 Response.Write() 将输出发送到客户端来对页面进行基准测试。通过这样做，我们可以确定服务器处理页面的时间和客户端呈现页面的时间（因为您会在屏幕上看到计时器结果，然后等待 10 秒以等待其余时间呈现）。瓶颈是客户端上的 100% IE。这也解释了为什么速度在不同人的机器上是可变的，因为根据客户端机器的速度，页面将以 8-15 秒之间的某个速度呈现。

我们甚至让 MS 查看了这个问题，他们确认 IE 有一个更慢的“丰富渲染”引擎...... IE8 运行得更快，但这对今天的任何人都没有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T14:46:47.177

您是否在 CSS 中使用任何行为？如果使用太多和/或如果它们影响太多元素，我已经看到行为会使应用程序崩溃。检查潜伏的任何 .htc 文件。

当然，行为只适用于 IE，并且它们使用 JavaScript，所以我确信不同的 IE 版本比其他版本更能胜任地处理它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-17T15:09:05.633

有一个用于此类场景的特殊工具，称为 dynaTrace，可在以下网站免费获得：http: [//ajax.dynatrace.com/pages/](http://ajax.dynatrace.com/pages/) 该工具可以真正帮助您，因为它几乎可以跟踪所有内容，并且专门为 IE 构建。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-13T10:17:13.390

检查脚本中的内存泄漏。

[http://www.javascriptkit.com/javatutors/closuresleak/index.shtml](http://www.javascriptkit.com/javatutors/closuresleak/index.shtml)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T14:52:13.703

Steve Souders 就提高网页性能的 14 个（简单）步骤进行了出色的演示：

[http://developer.yahoo.net/blogs/theater/archives/2007/08/steve_souders_high_performance.html](http://developer.yahoo.net/blogs/theater/archives/2007/08/steve_souders_high_performance.html)

如果它挂在页面中间，我个人要做的第一件事就是确保或移动我所有的 JavaScript 都在页面底部。

IE 擅长表现不佳，尤其是 JavaScript，因此如果将其移至底部，IE 可以呈现页面，*然后*继续处理 JavaScript。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-18T08:09:53.973

我使用[HttpWatch](http://www.httpwatch.com/)解决 IE 中的链接资产（图像、脚本、css）、网络或 HTTP 相关问题。有免费和付费版本。免费很好，但您会失去一些不错的功能。

# c# - 带有 LINQ 数据源插入模板的 ListView

> ID：212257
> 
> 赞同：1
> 
> 时间：2008-10-17T14:00:35.647
> 
> 标签：c#, asp.net, linq, listview

看起来这应该很简单，但我令人难以置信。我已经设置好我的列表视图并绑定到我的 LINQ 数据源。源取决于一个下拉列表，该下拉列表决定在列表视图中显示哪些分支信息。我的编辑模板工作正常，但我的插入模板不起作用，因为它需要我想从列表视图外部的下拉列表中获取的分支 ID，但我不知道如何绑定该值并将其设置在我的模板中。它看起来像这样：

```
<InsertItemTemplate>
    <tr style="">
      <td>
         <asp:Button ID="InsertButton" runat="server" CommandName="Insert" 
               Text="Insert" />
     </td>
      <td>
       <asp:TextBox ID="RechargeRateTextBox" runat="server" 
          Text='<%# Bind("RechargeRate") %>' />
         </td>
              <td>
       <asp:Calendar SelectedDate='<%# Bind("StartDate") %>' ID="Calendar1"  runat="server"></asp:Calendar>                                    
       </td>
           </tr>
    </InsertItemTemplate> 
```

我需要在其中获取一个标签，该标签绑定到列表视图之外的数据绑定 asp 下拉列表的值，以便插入工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T14:19:22.957

当 DropDownList 的值更改时，使用 DropDownList 的 OnSelectedIndexChanged（使用 AutoPostBack=True）回调将 ListView 中的值手动设置为该分支的默认值。

```
protected void BranchDropDownList_OnSelectedIndexChanged( object sender, EventArgs e )
{
    DropDownList ddl = (DropDownList)sender;
    RechargeRateTextBox.Text = BranchManager.GetRechargeRate( ddl.SelectedValue );
} 
```

将整个事情包装在一个 UpdatePanel 中，这一切都可以通过 AJAX 发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T14:41:54.720

我最终选择了这个，谢谢 twanfosson。

```
protected void ListView1_ItemInserting(object sender, System.Web.UI.WebControls.ListViewInsertEventArgs e)
        {
            e.Values["BranchID"] = DropDownList1.SelectedValue;
        } 
```

# c# - 如何从 Java 迁移到 C#？

> ID：212263
> 
> 赞同：35
> 
> 时间：2008-10-17T14:01:58.250
> 
> 标签：c#, java

我很了解Java。哪些警告和资源将帮助我尽可能轻松地跨越到另一边（C#）。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-17T14:06:36.383

最大的提示：使用 go 一词中的[.NET 命名约定](http://msdn.microsoft.com/en-us/library/ms229045.aspx)。这样，您将不断被提醒您使用的是哪种语言。（听起来很傻，但它确实很有帮助。）尽可能地接受该语言的习语。

有各种专门针对您所处情况的人的书籍 - 在 Amazon 中搜索“C# for Java”，您将获得大量点击。值得*仔细*阅读以确保您不会假设 C# 中的工作方式与 Java 中的相同。（例如，在 C# 中，实例变量初始化程序在基类构造函数主体之前执行；在 Java 中它们发生在之后。像这样的微妙事物可能需要一段时间来学习，并且如果您略读很容易错过。）

如果您打算使用 C# 3，我会得到一本肯定涵盖该内容的书 - C# 3 中的所有内容对您来说都是新的。免费插件：我自己的书（[C# in Depth](http://manning.com/skeet)）涵盖了 C# 2 和 3，但假设您已经了解 C# 1。（换句话说，它本身是不够的，但您可能希望它作为“第二”书。）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-17T14:07:41.670

[从 Java Developer's Perspective](http://www.25hoursaday.com/CsharpVsJava.html)查看这篇关于 C# 的精彩文章。它对双方可以做的事情有几个见解，以避免最小的开销。在你知道的语言和你想学习的语言中都有例子可以大大简化学习曲线。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T15:32:20.533

1.  使用 IntelliJ IDEA 键绑定安装 Visual Studio 2008 和 Resharper。如果您开始使用命名空间，这会提示您包含命名空间。
2.  开始一个新项目并开始编写 Java 代码，当您遇到无法正常工作的问题或无法找到您尝试使用 Google“PrintLn in c#”的类时。
3.  为完整性检查编写测试或代码片段，例如您可能想检查 == 是否适用于字符串（确实如此）
4.  意识到 c# 别名数据类型（int 是 System.Int32 的别名，System.String 的字符串）
5.  看别人的代码 我推荐[JP Boodhoos 谷歌代码](http://code.google.com/p/jpboodhoo/)
6.  找一份 C# 的工作，有很多工作需要 Java 和 C#，尤其是在支持方面。
7.  了解您的库，大多数 Java 库都已被移植，并且大多数时候名称类似于 (Hibernate => NHibernate) 或 (Xstream => Xstream.Net)。并非每个库都有一个明显的名称，因此只需开始查找您在此处听到的随机名称即可。即 (Rhino.Mocks,HTMLAgilityPack,MBUnit,Rhino.Commons,Castle Project)
8.  去用户组会议寻找一个 DNUG（Dot Net 用户组）他们会很有帮助，你可以获得一些好的建议。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-04-07T14:26:18.607

Microsoft 为使用 C# 的 Java 开发人员提供了一份[备忘单](https://download.microsoft.com/download/D/E/E/DEE91FC0-7AA9-4F6E-9FFA-8658AA0FA080/CSharp%20for%20Java%20Developers%20-%20Cheat%20Sheet.pdf):)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-16T11:54:33.380

我知道一个好的答案已经被接受了。不过，我想补充一点……

我发现学习一门新语言通常需要学习细微的句法差异……尤其是在处理 C/C++/Java/C# 系列中的语言之间的差异时。

除了一本厚厚的不错的参考书，我建议您[从 O'Reilly 获得一本袖珍参考书，例如 C# 3 Pocket Reference](http://oreilly.com/catalog/9780596519223/)。它不会帮助您了解设计模式等...但会提供有关您使用的语言的具体差异的*非常快速的参考。*

以下是该网站上关于这本书的简要介绍：

> C# 3.0 袖珍参考包括大量的插图和代码示例来解释：
> 
> *   C# 3.0 的新功能，例如 lambda 表达式、匿名类型、自动属性等
> *   C# 语法、预定义类型、表达式和运算符的所有方面
> *   创建类、结构、委托和事件、枚举、泛型和约束、异常处理和迭代器
> *   装箱、操作重载、委托协方差、扩展方法解析、接口重新实现、可空类型和操作提升的精妙之处
> *   LINQ，从序列、延迟执行和标准查询运算符的原则开​​始，并以完整的查询语法参考结束——包括多个生成器、连接、分组和查询延续
> *   使用、编写和反映自定义属性

我使用这本书（以及原版）帮助我从 Java 开发人员转变为 C# 开发人员。在我学习的时候，我一直把它放在我的桌子上，它真的很有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-16T12:16:11.120

我在工作中使用 C# 非常轻松地完成了转换，但最重要的事情之一是熟悉 .NET API 和 C# 中可用的一些强大技术。

在我学习了 .net 库之后，我比以前更依赖它了，所以了解它可以为你做的事情是非常有帮助的。之后，如果您完全使用 db 代码，请学习 LINQ，并且还可以学习 lambas、匿名类型和委托的技术。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T14:09:47.390

语言语法各不相同，所以我应该只阅读 C# 语法的一小部分参考。就像一本简单的书（对于有经验的程序员）或者维基百科（[http://en.wikipedia.org/wiki/Comparison_of_Java_and_C_Sharp](http://en.wikipedia.org/wiki/Comparison_of_Java_and_C_Sharp)）就足够了。

最大的区别是库：Asp.Net 网站与 java servlet 完全不同。

不多读，开始编程吧！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T14:40:41.183

这是一个在 Java 和 C# 之间进行语法比较的链接（即使它几乎相同，也有一些差异）。

[http://www.harding.edu/fmccown/java1_5_csharp_comparison.html](http://www.harding.edu/fmccown/java1_5_csharp_comparison.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-19T20:17:58.473

使用[Sharpen](http://developer.db4o.com/blogs/product_news/archive/2008/05/20/smart-java-to-c-conversion-for-the-masses-with-sharpen.aspx)将您的 Java 程序转换为 C# 并查看差异。

# oracle - 如何选择和优化oracle索引？

> ID：212264
> 
> 赞同：32
> 
> 时间：2008-10-17T14:01:59.233
> 
> 标签：oracle, optimization, indexing

我想知道是否有创建索引的一般规则。如何选择应该包含在此索引中的字段或何时不包含它们？

我知道它总是取决于环境和数据量，但我想知道我们是否可以制定一些全球公认的关于在 Oracle 中创建索引的规则。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-10-17T19:56:19.657

Oracle 文档为索引选择提供了一系列出色的注意事项：http: [//download.oracle.com/docs/cd/B28359_01/server.111/b28274/data_acc.htm#PFGRF004](http://download.oracle.com/docs/cd/B28359_01/server.111/b28274/data_acc.htm#PFGRF004)

19c 更新：[https ://docs.oracle.com/en/database/oracle/oracle-database/19/tgdba/designing-and-developing-for-performance.html#GUID-99A7FD1B-CEFD-4E91-9486- 2CBBFC2B7A1D](https://docs.oracle.com/en/database/oracle/oracle-database/19/tgdba/designing-and-developing-for-performance.html#GUID-99A7FD1B-CEFD-4E91-9486-2CBBFC2B7A1D)

报价：

*   考虑在 WHERE 子句中经常使用的索引键。

*   考虑在 SQL 语句中经常用于连接表的索引键。有关优化连接的更多信息，请参阅“使用哈希集群提高性能”部分。

*   选择具有高选择性的索引键。索引的选择性是表中具有相同索引键值的行的百分比。如果少数行具有相同的值，则索引的选择性是最佳的。注意：Oracle 会在您使用完整性约束定义的唯一键和主键的键和表达式上自动创建索引或使用现有索引。如果数据分布偏斜，以至于一两个值的出现频率远低于其他值，则索引低选择性列会很有帮助。

*   不要在具有很少不同值的键或表达式上使用标准 B 树索引。此类键或表达式通常具有较差的选择性，因此不会优化性能，除非经常选择的键值出现的频率低于其他键值。在这种情况下，您可以有效地使用位图索引，除非索引被频繁修改，例如在高并发 OLTP 应用程序中。

*   不要索引经常修改的列。修改索引列的 UPDATE 语句以及修改索引表的 INSERT 和 DELETE 语句比没有索引时花费的时间更长。此类 SQL 语句必须修改索引中的数据以及表中的数据。它们还会生成额外的撤消和重做。

*   不要索引仅出现在带有函数或运算符的 WHERE 子句中的键。使用除 MIN 或 MAX 之外的函数或具有索引键的运算符的 WHERE 子句不会使使用索引的访问路径可用，但基于函数的索引除外。

*   在大量并发 INSERT、UPDATE 和 DELETE 语句访问父表和子表的情况下，请考虑为参照完整性约束的外键编制索引。这样的索引允许对父表进行 UPDATE 和 DELETE 操作，而无需共享锁定子表。

*   在选择索引键时，请考虑查询的性能增益是否值得 INSERT、UPDATE 和 DELETE 的性能损失以及存储索引所需空间的使用。您可能希望通过比较带和不带索引的 SQL 语句的处理时间来进行试验。您可以使用 SQL 跟踪工具测量处理时间。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-17T14:10:30.090

有些事情你应该总是索引：

*   主键 - 自动为它们提供索引（除非您指定合适的现有索引供 Oracle 使用）
*   唯一键 - 自动为这些键提供索引（同上）
*   外键 - 这些**不会**自动编入索引，但您应该添加一个以避免在检查约束时出现性能问题

之后，寻找其他**经常**用于过滤查询的列：一个典型的例子是人们的姓氏。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T16:40:52.530

来自 10g Oracle 数据库应用程序开发人员指南 - 基础，第 5 章：

一般来说，在以下任何一种情况下，您都应该在列上创建索引：

*   该列被频繁查询。
*   列上存在参照完整性约束。
*   列上存在唯一键完整性约束。

使用以下准则来确定何时创建索引：

*   如果您经常要检索大表中不到 15% 的行，请创建索引。但是，根据表扫描的相对速度以及行数据与索引键的聚集程度，此阈值百分比变化很大。表扫描越快，百分比越低；行数据越聚集，百分比越高。
*   用于连接以提高连接性能的索引列。
*   主键和唯一键自动具有索引，但您可能希望在外键上创建索引；有关详细信息，请参阅第 6 章“维护应用程序开发中的数据完整性”。
*   小表不需要索引；如果查询花费的时间太长，那么表可能已经从小变大了。

有些列是索引的有力候选者。具有以下一项或多项特征的列是索引的良好候选者：

*   值在列中是唯一的，或者很少有重复项。
*   值范围很广（适用于常规索引）。
*   值范围很小（适用于位图索引）。
*   该列包含许多空值，但查询通常会选择所有具有值的行。在这种情况下，匹配所有非空值的比较，例如：

    WHERE COL_X >= -9.99 *power(10,125) 优于 WHERE COL_X IS NOT NULL

    这是因为第一个使用 COL_X 上的索引（假设 COL_X 是一个数字列）。

具有以下特征的列不太适合索引：

*   列中有许多空值，您不搜索非空值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T17:28:47.397

哇，这真是一个巨大的话题，这种格式很难回答。我强烈推荐这[本书](https://rads.stackoverflow.com/amzn/click/com/0471719994)。

Tapio Lahdenmaki 的关系数据库索引设计和优化器

您不仅使用索引来加快表访问速度，有时还使用索引来完全避免表访问。一些尚未提及但至关重要的东西。

如果你真的想让你的数据库发挥最大的作用，这就是一门科学。

啊，对 Oracle 的一项特定优化是构建反向键索引。如果您有一个单原子递增值的 PK 索引，例如序列，并且您有高度并发的插入并且不打算对该列进行范围扫描，则将其设为反向键索引。

看看这些优化有多具体？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T15:07:41.627

查看数据库规范化 - 你会发现很多关于应该存在哪些键、数据库应该如何关联以及索引提示的行业标准规则。

-亚当

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T14:14:33.467

通常将 ID 列放在前面，而这些列通常唯一地标识行。列的组合也可以做同样的事情。作为使用汽车的示例...标签或车牌是唯一的并且有资格获得索引。它们（标签列）可以用作主键。如果您要搜索名称，则所有者名称可以符合索引的条件。make of car 真的不应该在一开始就得到一个索引，因为它不会有太大的变化。如果列中的数据变化不大，索引就没有帮助。

看一下 SQL - where 子句在看什么。那些可能需要一个索引。

措施。问题是什么 - 页面/查询耗时太长？用于查询的内容。在这些列上创建索引。

警告：索引需要时间来更新和空间。

有时全表扫描比索引更快。可以比获取索引然后点击表更快地扫描小表。看看你的加入。

# architecture - 应用程序架构师应该编写代码吗？

> ID：212270
> 
> 赞同：45
> 
> 时间：2008-10-17T14:03:32.613
> 
> 标签：architecture

这是一个经常被问到的问题，双方都有看法。赞成的人会争辩说：

*   要为编码人员设计一个系统，您必须了解如何编码（并且正在编码）
*   您无法在不了解底层发生的情况的情况下设计系统
*   架构不仅仅是关于粗略的设计，而是关于在代码级别适应不断变化的需求

另一方面，

*   架构是高级角色，不应该关心实现细节
*   编码是一个面向细节的、低调的功能，它与风险管理、架构的广阔视野性质不一致
*   架构是关于技术风险管理而不是实施
*   建筑是关于领导力的。很难从后面带路

以我的经验，架构师不应该花费大量时间编码，而必须主要通过主要开发人员的沟通、审查和站立与代码库保持联系。如果您花费大量时间进行编码，您就会忽略高层次的问题，并且在管理技术风险方面变得无效。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-17T14:09:27.640

即使您反对编码的论点是有效的，我认为开发团队尊重您和您的设计决策也很重要。如果您与他们一起“承受”架构决策的后果，那么他们就*不太*可能质疑它们。

一直以来，我看到架构师与编码方面脱节，而他们的开发团队知道这一点。他们没有得到太多的尊重。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-10-17T14:11:35.127

**绝对是frickin-lutely**

没有什么比失去现实的建筑师更糟糕的了。

将脚放在地上，把头放在云端是工作的一部分。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-10-17T14:24:02.853

只是为了给我两分钱（以及我对“建筑师”的看法）

我相信有几种类型的架构师，每一种都有自己的领域：

*   **业务和功能架构师**：他们关心业务运营和功能工作流程，他们***实际上不应该编码***，因为他们必须能够从任何类型的实现中抽象出来，并且他们必须制定*功能规范*，让技术解决方案保持开放.

*   **应用架构师**：他们将功能域（如“损益分析”）划分为应用程序（如“组合处理器”、“启动器”、“调度程序”、“gui”）。***他们不需要编码，但他们应该是以前的编码员***，以便清楚地了解他们的架构必须解决的技术挑战。他们的主要技能不是编码，而是听取技术同事的意见以选择正确的解决方案。然后他们将产生必须实施（编码）的*技术实施。*

*   **技术架构师**：他们负责选择和/或实施技术框架（对于任何功能项目都是通用的，如 KPI、日志记录、异常管理），他们***绝对应该编码***（并且编码良好），因为它们的组件将是由所有其他职能团队使用。

*   **开发架构师**（嘿，[那是我](https://stackoverflow.com/users/6309/vonc)；））：负责开发工具和流程以及技术调查，***他们应该编码并热爱编码***。

所以我相信答案不只是一个：它取决于你的架构领域和专业知识：当谈到“应用程序架构师”时，我相信后三个类别可以有不同的编码经验......

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-17T14:08:55.333

我认为建筑的作用正在改变。我看到越来越少的象牙塔架构师为底层程序员设计一个完整的系统以在瀑布过程中实现。

在进行迭代项目时，架构师和程序员之间的沟通变得更加重要。架构师是团队的一部分，应该能够与程序员一起处理不断变化的需求和新想法。在这种情况下，架构师和程序员的工作关系更密切。我见过开发主管担任架构师角色的团队，他们为非常复杂的解决方案提供了经过深思熟虑的架构。

**编辑**在回复评论
时，我认为应用程序、解决方案和企业架构师之间的区别有点人为，在很多情况下并不真正适合。安全架构师、数据架构师等角色对职责进行了更清晰的区分。您可以在这里查看更多详细信息[http://stevendwright.home.comcast.net/~stevendwright/ArchRoles.htm](http://stevendwright.home.comcast.net/~stevendwright/ArchRoles.htm)

顺便说一句，通过再次阅读您的问题，我注意到许多反对编码架构师的论点似乎表明架构师具有强大的管理/领导角色。我认为将管理和架构角色分开是个好主意。让您的技术人员在编码和架构之间分配时间比在管理和架构之间分配时间要好。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-17T14:11:20.087

是的。多年未编写代码的软件架构师与构建产品的现实失去了联系。他们开始制作具有更高抽象层次的宏伟设计，这似乎一直在推迟他们的发货日期。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-17T15:29:40.460

我参与的每个项目都包括一位架构师，他没有花费大量时间亲自处理代码，由于缺乏实践知识，因此遇到了问题。

这包括我是那个建筑师的项目:-)

它现在是个人的大红旗。

我同意所有支持编码架构师的论点。反对的论点对我来说并不好。

代码需要抽象应用程序中的高级概念和低级概念。除非设计和代码在所有级别都集成，否则解决方案将不是最佳的。

至于“编码是一个面向详细的、低头的功能，它与风险管理、架构的广泛视角性质不一致”——根据我的经验，一个广泛的视角——尤其是风险管理——让更好的编码人员不会变得更糟:-)

“架构是关于技术风险管理而不是实施” - 不是的。这是关于风险管理*和*实施（以及一堆其他东西）。

“架构是关于领导力的。很难从后面领导”——为什么编码会让你落后？就我个人而言，我发现最好的领导方式是和你一起工作的人在一起。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-10-17T14:23:40.360

我（认为我）是一名建筑师，编码是这份工作的乐趣所在。

然后你会看到你的想法正在变为现实，你可以看到你的设计正在运行，你可以看到设计中的错误（无论如何都为时已晚，但下一次......）

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-17T14:07:46.367

是的，为了保持他们的编码经验。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-17T15:48:19.767

我认为他们不需要对应用程序中的所有内容进行编码。但是应该给他们一些任务。一些“架构师”基本上是没有技术经验的黑客，他们将自己伪装成“传奇的编码员”，并且设计的系统会使如果没有架构的话，你不得不做的工作量增加数周或数月。如果他们不能编写代码，那么他们就没有担任该角色的业务......因为这个想法是架构应该使应用程序更易于开发和维护。但如果建筑师不能发展，他或她怎么知道如何建造建筑？

此外，即使是最好的架构师也会做出错误的决定。有时某些东西在白板上看起来很棒，但实际上架构决策最终使事情变得比应有的困难得多。如果架构师不得不吃他/她自己的狗粮（并使用架构），他们更倾向于想要纠正错误的决定或围绕它们设计方法。同样通过触摸代码，他们至少对它有点熟悉。因此，如果开发人员带着编码问题来找他们，架构师的眼睛不会呆滞，因为他/她解雇了开发人员并说开发人员做错了，但没有提供关于正确方法的见解。

架构师不需要在代码库中做大项目。但他们至少应该在代码库中做一些小任务，迫使他们使用自己的架构。此外，小任务可能涉及阅读大量其他人的代码，以让他们了解人们如何使用架构以及是否可以做任何事情来改进它。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-10-17T14:18:19.510

有架构师，也有 IT 战略家。如果您正在领导一个涉及多个部门的 500 人的集成项目，那么不，它会妨碍您。如果您在一个开发项目中领导多达几十个人的设计和实施，那么可以。否则，您将不太可能对使用您的架构的日常现实有适当的洞察力。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-30T20:57:53.280

正如 Vlion 所说，在一个以开发人员为主的社区中提出这个问题意味着答案将倾向于“是”。

作为一个头衔是“建筑师”但最近还获得了“杰出工程师”徽章的人，我的忠诚被撕裂了。总的来说，我认为编码通常不能有效地利用架构师的时间。那我该怎么办？

*   了解业务。
*   了解用于支持业务的系统。
*   与业务部门合作制定 IT 战略和策略。
*   确保当前的项目是以长远的眼光来完成的，项目经理专注于短期的眼光。

那么建筑师应该如何与现实保持联系呢？我认为通过定期会议和走访，只是与各个级别的人交谈并为沟通的轮子加油。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-17T14:48:47.907

我开始相信，“实现细节”通常不是细节（从某种意义上说，当您将某些特定的实现问题视为从“架构”角度来看可能被忽略为细枝末节的细节时，就会出现许多问题)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-02T01:45:23.003

应用程序架构师必须能够定义应用程序架构、设计应用程序、实现模式并指导其他人编写代码。如果您不能做这些事情，那么您就不是应用程序架构师。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-11T16:28:15.630

架构是软件开发人员的核心技能。对于架构师来说，不编码可能有一些罕见的情况，但我不记得在我自己的经验中遇到过这样的情况。

架构师必须要么在项目上编码，要么至少完全有能力在项目上编码。第二部分意味着他们必须能够使用团队其他成员使用的工具和技术进行编码。（如果不继续编码，要保持这些技能肯定是非常困难的。）

最后，当架构师负责选择其他人使用的工具和技术时，如果不实际使用建议的工具，他们就无法很好地做出这样的选择。在这种情况下，非编码架构师迅速退化为一个尖头发的老板，办公桌上放着一堆小册子。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-07-03T07:10:57.000

> 架构是高级角色，不应该关心实现>细节

代码就是设计。想象一下，一位建筑技术人员设计了漂亮的建筑，但拒绝进入实施细节，例如在哪里放置紧急出口、管道、电力、电梯或建筑法律问题。

> ```
> * Coding is a detailed oriented, heads-down funtion which is at odds 
> ```
> 
> 具有风险管理，架构的广阔视野

编码时，首先要关注细节。然后你以更广泛的关注点进行重构。

> 建筑是关于领导力的。很难从后面带路

软件开发的战场是编码。可能是产品经理或者项目经理不会编码。但是建筑师需要这样做。也许他应该花更多的时间重构来展示代码有多好。这样，他以身作则。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-17T14:10:11.867

有时，他们必须编码。例如，当团队只有一个人时。

在我看来，他们可以根据需要进行编码，但不能失去大局。每天都改变设计的结构是不行的。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-17T14:14:41.267

你在一个编码网站上问这个。你会让基本上每个人都站在“是”的一边。

我的观点是，*是的，但仅足以跟上不断变化的需求，仅此而已*

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-17T16:56:03.250

因为这里的每个人都是编码员，所以最喜欢的肯定是地狱——是的答案——你不会从我这里得到任何不同意见。

但在我看来，[更细粒度的答案](https://stackoverflow.com/questions/212270/should-application-architects-write-code#212362)更正确，因为它适当地重视领域专业知识。对软件知之甚少，但只是使用它的人是如此宝贵。

架构角色如何划分似乎取决于组织的规模和性质。

如果我按照自己的方式去做，我会给客户一个故事架构师的角色，如果他们写出好的、有用的、详细的故事和用例。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-04-11T23:58:31.320

我想知道为什么没有人提到可以取代编码的代码审查或结对编程。

我花在阅读代码和与同事一起解决问题上的时间比编码要多得多。这让我对代码、其结构和复杂性的理解与自己编写几乎相同，而且耗时少得多。当我编码时，我这样做是为了好玩或探索新技术（这是我发现编码有用的唯一地方）。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-10-17T18:19:32.800

只编写接口算作代码吗？如果是这样，那么这是我对架构师的最低期望，而在其他情况下，他们可能会提供更多代码，例如带有方法存根的类。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-10-18T07:59:43.893

这个标准的开发人员回答是架构师也应该编码。但它是一种将技术放在首位的开发人员。但我倾向于不同意。是的，拥有一些编码技能是有益的，以便能够审查代码。

但是架构师唯一要做的就是将业务需求与实现结合起来。在我们的例子中是代码。如果你有一个非常复杂的系统，你不能同时编码和做架构，因为你在太多不同的抽象级别上操作。

相反，您应该能够依赖开发人员。他们应该能够描述实现的各个方面，以及它如何适合您向他们指出的业务需求。选择什么技术是建筑师的决定，但要做出这个决定，他必须进行研究或利用过去的经验。这并不意味着他不与开发人员交谈，或者让他们研究特定技术以查看架构是否真的有效。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-08-14T06:48:02.833

冒着偏离主题的风险...

在大型应用程序中，架构师可能无法随时更新正在编写的代码。此外，由于其他重要职责，他不可能编写代码。话虽如此，我还是建议架构师不要放弃正在开发的代码库的大局。这可以通过监控代码库的代码覆盖率、代码质量指标、静态代码分析等来实现。他应该使用上述标准定期评估代码质量。“持续集成”的做法在这里可以提供帮助。

# sql - 查询所有用户一天的平均通话时长

> ID：212271
> 
> 赞同：5
> 
> 时间：2008-10-17T14:03:33.723
> 
> 标签：sql, sql-server, sql-server-2005

一个人每天使用手机多次，通话时间长短不一。我正在跟踪表格中呼叫的长度：

```
Calls [callID, memberID, startTime, duration] 
```

我需要一个查询来返回用户**每天**的平均通话时长。每天的意思是，如果用户使用手机 3 次，第一次使用 5 分钟，第二次使用 10 分钟，最后一次使用 7 分钟，计算方式为：`5 + 10 + 7 / 3 = ...`

笔记：

1.  人们并非每天都使用电话，因此我们必须获取最近一天的平均每人通话时间，并以此来获取总体平均通话时长。

2.  我们不想将任何人平均计算两次，因此每个用户只有 1 行用于计算平均每日通话时长。

一些澄清...

我需要基于每个用户每天的平均值，使用用户最近的天数（因为我们只在查询中计算给定用户 ONCE），所以这意味着我们将使用不同的天数平均 因为人们可能不会每天甚至在同一天使用手机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T14:54:29.190

以下查询将为您提供所需的最终结果。

```
SELECT AVG(rt.UserDuration) AS AveragePerDay
FROM
(
    SELECT
        c1.MemberId,
        AVG(c1.Duration) AS "UserDuration"
    FROM Calls c1
    WHERE CONVERT(VARCHAR, c1.StartTime, 102) =
        (SELECT CONVERT(VARCHAR, MAX(c2.StartTime), 102)
            FROM Calls c2
            WHERE c2.MemberId = c1.MemberId)
    GROUP By MemberId
) AS rt 
```

为此，首先创建一个表，其中包含每个成员的 1 条记录以及他们最近一天通话的平均持续时间。然后它简单地平均所有这些值以获得最终的“平均通话持续时间”。如果您想查看特定用户，您可以只运行 innser SELECT 部分来获取成员列表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T14:07:21.437

您需要将 DATETIME 转换为可以制作“每天”组的内容，因此这将产生“yy/mm/dd”。

```
SELECT
  memberId,
  CONVERT(VARCHAR, startTime, 102) Day,
  AVG(Duration) AvgDuration
FROM
  Calls
WHERE
  CONVERT(VARCHAR, startTime, 102) = 
  (
    SELECT 
      CONVERT(VARCHAR, MAX(startTime), 102) 
    FROM 
      Calls i WHERE i.memberId = Calls.memberId
  )
GROUP BY
   memberId,
   CONVERT(VARCHAR, startTime, 102) 
```

用于`LEFT(CONVERT(VARCHAR, startTime, 120), 10)`产生“yyyy-mm-dd”。

对于这类查询，有一个专门的“仅限一天”列将有助于避免整个转换业务，并作为副作用使查询更具可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T14:06:46.990

```
select average(duration) from calls group by date(startTime); 
```

# vb.net - 从 vb.NET (2003) 迁移到 vb2005 有哪些好处？

> ID：212289
> 
> 赞同：1
> 
> 时间：2008-10-17T14:08:19.127
> 
> 标签：vb.net, visual-studio-2005, upgrade, visual-studio-2003

我们正在从 vs2003 更改为 vs2005 并使用 vb 作为我们的主要语言，我正在寻找对 VB 的一些更改，这将有助于我们的 ASP.NET 开发。有人可以指点我一个列表（可能来自微软吗？）或提供两个版本之间的一些他们最喜欢的差异？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T14:12:13.783

哇！没那么快，伙计！急什么？放松，伙计。再给它几年。

任何不使用 3.5 版框架的 .NET 开发人员都只是在浪费时间。它的每一点...... Linq，WPF，lambdas，WCF，**GENERICS**，我可以继续......它的每一点都是黄金。我宁愿在高速公路上玩，也不愿在目标 1.1 上玩。就像白天和黑夜。

帮自己和你的团队一个忙……跳过 2k5 并打 2k8。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T14:12:51.380

[VB 2005 中的新功能（来自 MS）](http://msdn.microsoft.com/en-us/library/we86c8x2(VS.80).aspx)

[Code Magazine 中涵盖的相同主题](http://www.code-magazine.com/Article.aspx?quickid=0505051)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T14:15:43.197

从语言的角度来看，添加[泛型](http://msdn.microsoft.com/en-us/library/w256ka79(VS.80).aspx)和[可空类型](http://dotnetdud.blogspot.com/2008/04/nullable-type-in-visual-basicnet.html)（[第二个链接](http://www.vbdotnetheaven.com/UploadFile/PashuSX/NullableTypes12122006000056AM/NullableTypes.aspx)）（基于泛型）对我的工作来说是一个非常引人注目的故事。[My 命名空间](http://msdn.microsoft.com/en-us/vbasic/ms789188.aspx)为 VB 开发人员提供了相当多的捷径，可以进入“有点”更复杂的系统功能。

从 ASP.NET 的角度来看，尽管它们不是特定于 VB 的，但添加[母版页](http://msdn.microsoft.com/en-us/library/wtxbf3hh.aspx)框架和[MembershipProvider](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)体系结构也非常有价值。

这是 Microsoft提供的所有 Visual Studio 2005、语言和主要 .NET 框架更改的相当全面的[列表。](http://msdn.microsoft.com/en-us/library/88fx1xy0(VS.80).aspx#newinlangandtech)

对于它的价值，您可能会考虑使用 .NET 3.5 跳过 2005 年并直接进入 2008 年。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T14:19:51.020

Rick Strahl 对主要变化进行了评估，并就一些[高点和低点](http://www.simple-talk.com/dotnet/asp.net/asp.net-2.0-and-vs-2005---you-win-some,-you-lose-some/)提供了个人观点。

.NET 1.1 到 .NET 2.0 迁移 [第 1](http://blogs.msdn.com/peterlau/archive/2006/05/11/595294.aspx) [条 第 2 条](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-6139045.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T14:09:46.160

一个更好的IDE。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T14:11:50.040

我发现从 .Net 1.1 到 2.0 的最大改进是泛型和 yield return，以便于实现 ienumerables。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T14:33:43.943

我个人发现一些 IDE 更改是最有益的。

*   设计师不会按照感觉重新格式化您的代码这一事实
*   标准布局是默认布局而不是网格布局的事实
*   智力的提高

除了 IDE 更改之外，如果我必须选择 1 个非常有用的 .NET 2.0 东西，我会说泛型。

# gcc - 用于 MIPS、3.4.4 或 4.3.2 的 gcc？

> ID：212292
> 
> 赞同：0
> 
> 时间：2008-10-17T14:08:58.797
> 
> 标签：gcc, mips

我们对 gcc 3.3.2（用于 MIPS）进行了许多更改，以支持我们正在开发的嵌入式系统的变幻莫测。gcc 3.4 及更高版本似乎大大改进了 MIPS 代码生成，因此我计划将我们的更改向前移植。问题是我应该针对哪个 gcc 版本：3.4.4 还是直接到 4.3.2？移植更改需要大量工作，我不想重复两次并选择更好的结果。

Linux-MIPS 项目仍然推荐 gcc 3.4.4，MIPS Technologies 维护了一个基于 gcc 3.4.4 的修改后的 SDE 工具链。虽然我的嵌入式系统没有运行 Linux，但我尊重他们的专业知识。

从我读过的内容来看，MIPS 后端并没有受益于 4.x 中更高级别的优化，实际上产生的代码比 3.4.4 慢。任何人都可以确认或否认这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T15:30:32.953

从课堂开始我就没有使用过 MIPS，所以我不能直接回答你的问题。

我建议向 Linux-MIPS 项目中的某个人发送电子邮件，并询问他们何时计划升级。估计不会很快。看起来 3.4.4 是一个值得升级的版本。

# java - 如何从 WAS 模块中删除类路径变量

> ID：212302
> 
> 赞同：0
> 
> 时间：2008-10-17T14:10:37.747
> 
> 标签：java, websphere, classpath, application-server

在我们的开发框中，我们的应用程序模块包含对`file:/apps/WebSphere61/systemApps/isclite.ear/`jar 文件和类路径条目的引用。然而，在我们的 Prod 框中，它只包含包含我们所有必需类的 jar 文件。在 Dev 上，这在使用 apache-commons-fileuploader 时会导致问题，因为这些类也是 systemApps jar 中的引用。我们如何从应用程序模块的类路径中删除 systemApps 库引用？

Websphere 应用服务器 6.1.0.17

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T12:11:13.900

有几个地方引用了库。

我假设您希望 test 与 prod 匹配。

启动管理控制台（测试中）。在 Environment > Shared Libraries 区域以及 Applications > Ent 中定义了库。应用。>“我的耳朵”>（附加属性）库部分。

查看它是否在 Env > Shared Libraries 区域中定义并将其删除。

# architecture - 什么时候项目不需要应用程序架构师？

> ID：212310
> 
> 赞同：5
> 
> 时间：2008-10-17T14:12:03.813
> 
> 标签：architecture

中型或大型项目是否不需要建筑师？我参与过许多项目，其中涉及的开发公司选择不指定应用程序架构师。要么软件是有机构建的，几乎不关心设计，要么设计责任落在高级开发人员身上。

没有架构师的动机从成本考虑到相信开发方法使架构角色变得不必要（这个论点可以用于敏捷开发）。一些开源项目的工作原则是集体贡献，而不是在架构领导下进行开发。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T14:23:55.973

如果您已经拥有允许您构建项目的架构/系统模式，那么您根本不需要架构师。

我在大学教授软件架构，我们相信架构师带来的核心技能是一个系统的、彻底的设计过程，它可以满足所有利益相关者的需求，并仔细考虑相互竞争的利益。架构师必须具备大量技术知识，但开发人员拥有相同知识（甚至更多）的情况并不少见。

关键是捕捉质量场景并知道如何应用满足这些质量的设计技术/模式。或者，如果必须的话，可以即时发明一些东西。

行业中的架构重用率很高，通常以至于架构师是多余的。

由于我经常谈论这些东西，我真的可以继续说下去……

**更新：** 我以为我会整理其他答案中表达的一些想法。

*   建筑师是一个中心交流点。
*   建筑师沟通设计 - 优秀的人有效地做到这一点。
*   架构师为产品/项目带来必要的经验。
*   更大的建筑需要更大的设计、更多的规划、原型制作等，并且需要有人来确保“正确的系统是正确的”。
*   与开发人员相比，架构师将开发人员视为利益相关者并实施策略来处理他们想要的非运行时质量（可扩展性、可维护性、可测试性、可重用性、可配置性 (MeTRiCS)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T14:23:27.707

我将不得不在这里使用房屋进行类比。不久前（相对）人们可以在没有建筑师或建筑计划的情况下建造房屋。他们砍伐了一些木头，使用学到的技能切割和刨板并建造房屋。大教堂、城堡等……当然，他们有建筑师和工程师。但绝大多数时候是人们使用传承下来的技能来建造房屋。

这些房子完成了这项工作，但并没有持续多久。它们可能有点漏水，可能很难改进，等等。但是用水来平整你的地基然后添加木头很容易。

现代房屋有需要接入的基础设施、必须满足的规范等。我们的房屋设计需要先由建筑师创建或批准，然后才能建造。建筑师确保一切都符合要求，并确保房子能够站立并适合居住。

* * *

应用程序也不例外。我们不是生活在一个复杂的结构可以在没有架构的情况下逃脱的世界。当然，我可以为我的图书馆编写一个数据库作为一项简单的练习；我还可以为我的图书馆建造书架，而无需建筑师参与。但是一旦你超越了简单的结构，你绝对应该确保有人关注更大的图景——你的结构（房子或应用程序）是否会做它需要做的事情，它是否与其他人相处得很好，以及是否它符合建造时设定的规则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T14:24:59.187

定义“要求”。

您当然可以在没有中心愿景或领导力的情况下构建大型产品。它只会花费更长的时间，有更多的错误，更难维护，并且需要更多的工时才能完成。

以我的经验，拥有应用程序架构师的好处远远多于缺点，而且项目越大，效果就越大。

现在您可以采取一些措施来减轻这种影响，例如拥有关于应用程序预期设计的强大而完整的文档，开发人员会忠实地遵循这些文档 - 但这只是让一个文档代替应用程序架构师，它是并不是真正的不同方法。

敏捷开发可以是成功的，但它的成功在于拥有一个运行良好的开发团队机器，每个人都同意程序设计的基本概念，并且当他们做出错误的决定和互相纠正错误。

同样，您并没有真正取代应用程序架构师的角色，您只是将职责分摊给了一群人。

一个简单的事实是，这个角色 [i] 是 [/i] 你想要坐下的东西。你如何安置它取决于你，但最成熟、最有效的方法是让一个人去做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T14:28:42.063

当只涉及不需要任何架构返工或分析的少量维护时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T14:38:52.543

我的经验是，有时建筑师只是不被称为。通常有人或某个小组负责代码的整体设计。我让这个人担任技术负责人、团队负责人或项目负责人。它也往往是一个开发人员，他们负有指导大规模设计的额外责任。也许我只是在较小的开发商店工作过，但我从来没有看到让一个人只做架构工作的意义，在任何一个项目上都做得不够！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T14:25:02.947

在我工作的地方，我们有一个大型项目的建筑师。如果您喜欢“理智的声音”，架构师就是在业务分析师风格的角色（“这是我们认为行业需要的”）和高级开发人员（“这就是它的工作方式”）之间架起一座桥梁。它们提供了软件应该如何开发的一致视图 - 如果您愿意，可以提供更大的图景。

在我看来，开发人员四处走动——尤其是优秀的开发人员——并且在项目上保持一致性是关键。建筑师专注于项目的一个领域（大型项目，请记住）并且不会四处走动，因此他们对要实现的目标以及我们应该如何到达那里有了很好的理解。

它们还为您在不断变化的业务需求和开发人员对更改已经完成的流程的自然抵制中遇到的触发器情况提供了一条“平滑曲线”。

即使是开源项目也有我所说的架构师——项目中的核心人员通常对正在构建的内容以及应该如何构建有一个愿景。合作者提供想法并推动界限，但如果更改不合适，有人会否决更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T14:28:03.610

这取决于您所说的“建筑师”是什么意思。如果您的意思是 CVertex 的意思，那么确实是正确的。如果您的意思是“一个不写代码但非常喜欢 UML 并亲吻管理的胖子”，那么主要风险是项目将工作并且不受管理层的支持，而不是相反。

* 根据我的经验，很多没有代码的人的体重比我还多。不过，我看到很多瘦的程序员。

# java - 如何使用 Java 日历从日期中减去 X 天？

> ID：212321
> 
> 赞同：194
> 
> 时间：2008-10-17T14:14:06.587
> 
> 标签：java, calendar, subtraction

有人知道使用 Java 日历从日期中减去 X 天的简单方法吗？

我找不到任何函数可以让我直接从 Java 中的日期中减去 X 天。有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：329
> 
> 时间：2008-10-17T14:17:06.800

取自[此处的文档](http://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html#add%28int,%20int%29)：

> 根据日历的规则，在给定的日历字段中添加或减去指定的时间量。例如，要从日历的当前时间减去 5 天，可以通过调用实现：
> 
> ```
> Calendar calendar = Calendar.getInstance(); // this would default to now
> calendar.add(Calendar.DAY_OF_MONTH, -5). 
> ```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-10-17T14:22:03.373

您可以使用该`add`方法并将其传递给负数。但是，您也可以编写一个不使用`Calendar`该类的更简单的方法，例如以下

```
public static void addDays(Date d, int days)
{
    d.setTime( d.getTime() + (long)days*1000*60*60*24 );
} 
```

这将获取日期的时间戳值（自纪元以来的毫秒数）并添加适当的毫秒数。您可以为 days 参数传递一个负整数来进行减法。这将比“正确”的日历解决方案更简单：

```
public static void addDays(Date d, int days)
{
    Calendar c = Calendar.getInstance();
    c.setTime(d);
    c.add(Calendar.DATE, days);
    d.setTime( c.getTime().getTime() );
} 
```

请注意，这两种解决方案都会更改`Date`作为参数传递的对象，而不是返回一个全新的`Date`. 如果需要，可以轻松更改任一功能以另一种方式进行。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2008-10-17T14:24:34.273

[Anson 的答案](https://stackoverflow.com/questions/212321/anyone-know-a-simple-way-using-java-calendar-to-subtract-x-days-to-a-date#212334)适用于简单的情况，但如果您要进行更复杂的日期计算，我建议您查看[Joda Time](http://joda-time.sourceforge.net/)。它会让你的生活更轻松。

仅供参考，你可以在 Joda Time

```
DateTime dt = new DateTime();
DateTime fiveDaysEarlier = dt.minusDays(5); 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2015-11-04T19:56:49.330

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-17T14:17:49.183

```
int x = -1;
Calendar cal = ...;
cal.add(Calendar.DATE, x); 
```

看[`java.util.Calendar#add(int,int)`](https://docs.oracle.com/javase/10/docs/api/java/util/Calendar.html#add(int,int))

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-08-13T12:29:32.743

与其`addDays`按照 Eli 的建议编写我自己的，我更愿意使用`DateUtils`from **Apache**。它很方便，尤其是当您必须在项目中的多个位置使用它时。

API 说：

`addDays(Date date, int amount)`

将天数添加到返回新对象的日期。

请注意，它返回一个新`Date`对象，并且不会对前一个对象本身进行更改。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-12-19T06:37:01.197

可以通过以下方式轻松完成

```
Calendar calendar = Calendar.getInstance();
        // from current time
        long curTimeInMills = new Date().getTime();
        long timeInMills = curTimeInMills - 5 * (24*60*60*1000);    // `enter code here`subtract like 5 days
        calendar.setTimeInMillis(timeInMills);
        System.out.println(calendar.getTime());

        // from specific time like (08 05 2015)
        calendar.set(Calendar.DAY_OF_MONTH, 8);
        calendar.set(Calendar.MONTH, (5-1));
        calendar.set(Calendar.YEAR, 2015);
        timeInMills = calendar.getTimeInMillis() - 5 * (24*60*60*1000);
        calendar.setTimeInMillis(timeInMills);
        System.out.println(calendar.getTime()); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-12-09T13:11:55.163

**我相信使用java.time.Instant**类可以实现一种干净而漂亮的方法来执行任何时间单位（月、天、小时、分钟、秒……）的减法或加法。

从当前时间减去 5 天并将结果作为日期的示例：

```
new Date(Instant.now().minus(5, ChronoUnit.DAYS).toEpochMilli()); 
```

另一个减 1 小时加 15 分钟的例子：

```
Date.from(Instant.now().minus(Duration.ofHours(1)).plus(Duration.ofMinutes(15))); 
```

如果您需要更高的精度，Instance 可以测量到纳秒级。处理纳秒部分的方法：

```
minusNano()
plusNano()
getNano() 
```

另外，请记住，Date 不如 Instant 准确。我的建议是尽可能**留在 Instant 类**中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-10-27T20:33:46.667

有人推荐了 Joda Time - 我一直在使用这个**CalendarDate**类 [http://calendardate.sourceforge.net](http://calendardate.sourceforge.net)

这对 Joda Time 来说是一个有点竞争的项目，但在只有 2 节课时更加基础。因为我不想使用比我的项目更大的包，所以它非常方便并且非常适合我需要的东西。与 Java 对应物不同，它的最小单位是天，所以它实际上是一个日期（没有精确到毫秒或其他什么）。创建日期后，您要做的只是减去 myDay.addDays(-5) 之类的内容，以返回 5 天。您可以使用它来查找星期几之类的东西。另一个例子：

```
CalendarDate someDay = new CalendarDate(2011, 10, 27);
CalendarDate someLaterDay = today.addDays(77); 
```

和：

```
//print 4 previous days of the week and today
String dayLabel = "";
CalendarDate today = new CalendarDate(TimeZone.getDefault());
CalendarDateFormat cdf = new CalendarDateFormat("EEE");//day of the week like "Mon"
CalendarDate currDay = today.addDays(-4);
while(!currDay.isAfter(today)) {
    dayLabel = cdf.format(currDay);
    if (currDay.equals(today))
        dayLabel = "Today";//print "Today" instead of the weekday name
    System.out.println(dayLabel);
    currDay = currDay.addDays(1);//go to next day
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-25T09:30:16.083

Eli Courtwright 的第二个解决方案是错误的，应该是：

```
Calendar c = Calendar.getInstance();
c.setTime(date);
c.add(Calendar.DATE, -days);
date.setTime(c.getTime().getTime()); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-25T12:59:05.627

我面临着同样的挑战，我需要回退 1 天（即使前一天落入前一年或前几个月，也应该能够回滚一天）。

我做了以下，基本上减去了 1 天的 24 小时。someDateInGregorianCalendar.add(Calendar.HOUR, -24);

或者，我也可以这样做

```
GregorianCalendar cal = new GregorianCalendar();
    cal.set(Calendar.YEAR, 2021);
    cal.set(Calendar.MONTH, 0);
    cal.set(Calendar.DATE, 1);
    System.out.println("Original: " + cal.getTime());
    cal.add(Calendar.DATE, -1);
    System.out.println("After adding DATE: " + cal.getTime()); 
```

输出：

```
Original: Fri Jan 01 15:08:33 CET 2021
After adding DATE: Thu Dec 31 15:08:33 CET 2020 
```

# visual-studio-2008 - VS 上的 T4 错误。编译转换：'Write' 不是成员

> ID：212326
> 
> 赞同：1
> 
> 时间：2008-10-17T14:15:09.487
> 
> 标签：visual-studio-2008, t4

我正在尝试在 VS2008 的 T4 模板中使用一个类。

这是我正在做的简化版本...

```
<#@ template language="VB" debug="True" hostspecific="True" #>
<#@ output extension=".vb" debug="True" hostspecific="True" #>
<#@ assembly name="System.Data" #>
<#@ assembly name="System.Windows.Forms.dll" #>
<#@ assembly name="System.xml" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="System.Data.SQLClient" #>
<# Call (New SomeClass).Start()#>
<#+
Private Class SomeClass
    Public Sub Start()
    #>test<#+
    End Sub
End Class 
#> 
```

当我运行此模板时...我收到以下错误...

* * *

> 错误 1 ​​编译转换：“Write”不是“Microsoft.VisualStudio.TextTemplatingF77BDE667ECAD297F587D3D651053846”的成员。GeneratedTextTransformation.SomeClass'。D:\Development\PrivateProjects\CodeGeneration\CodeGeneration\Generation\Common\test2.tt 16 1 CodeGeneration

**谁能告诉我为什么这会导致错误，更重要的是如何否定它的影响？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T14:48:13.600

编码...

```
#>test<#+ 
```

...内部转换为...

```
Write("test"); 
```

由于我的类没有“Write”方法，因此编译失败。

解决方法是......

```
<#@ template language="VB" debug="True" hostspecific="True" #>
<#@ output extension=".vb" debug="True" hostspecific="True" #>
<#@ assembly name="System.Data" #>
<#@ assembly name="System.Windows.Forms.dll" #>
<#@ assembly name="System.xml" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="System.Data.SQLClient" #>
<#@ import namespace="Microsoft.VisualStudio.TextTemplating" #>

<# Call (New SomeClass(Me)).Start()#>

<#+
Private Class SomeClass
Private mOutput as TextTransformation
Public Sub New(Output as TextTransformation)
    mOutput = Output
End Sub 
Public Sub Write(SomeText as String)
    mOutput.Write(SomeText)
End Sub 
    Public Sub Start()
        #>test<#+
    End Sub
End Class 
#> 
```

这导致写入被传递给父类进行处理。

# f# - 并行计算、f# 和 GPU 并行处理可能解决哪些实际问题

> ID：212347
> 
> 赞同：4
> 
> 时间：2008-10-17T14:20:39.117
> 
> 标签：f#, parallel-processing, brute-force, wifi, stream-processing

[最近，WiFi 加密是通过使用现代 GPU 的并行处理能力强行进行的。](http://www.tomshardware.com/news/nvidia-gpu-wifi-hack,6483.html) 您认为其他现实生活中的问题会从类似技术中受益吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T14:28:28.913

图像处理只是更高级的信号处理，它是大规模并行数学。

鉴于此，可能是人脸识别、语音识别、视频解码/编码、音频解码/编码、加密/解密

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T14:25:06.003

大多数批处理任务可以并行化，非常适合 GPU 中的流处理器。折叠式的。塞提。所有这些 gubbins 已经在 GPU 上运行良好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-21T10:45:46.880

*   计算流体动力学
*   物理处理
*   光线追踪
*   数据挖掘
*   医学影像
*   控制工程软件
*   数字信号处理
*   生物信息学

事实上，请查看[此页面](http://en.wikipedia.org/wiki/GPGPU#Applications)以获取更多使用 GPGPU 的示例。

仅举几例。

# java - 我应该使用哪个注释：@IdClass 或 @EmbeddedId

> ID：212350
> 
> 赞同：146
> 
> 时间：2008-10-17T14:21:14.623
> 
> 标签：java, jpa, annotations, java-persistence-api

( `JPA`Java Persistence API) 规范有 2 种不同的方式来指定实体复合键：`@IdClass`和`@EmbeddedId`.

我在我的映射实体上使用了这两个注释，但对于不太熟悉`JPA`.

我只想采用一种方式来指定复合键。哪一个真的是最好的？为什么？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2008-10-17T14:27:03.720

我认为这`@EmbeddedId`可能更冗长，因为`@IdClass`您无法使用任何字段访问运算符访问整个主键对象。使用`@EmbeddedId`你可以这样做：

```
@Embeddable class EmployeeId { name, dataOfBirth }
@Entity class Employee {
  @EmbeddedId EmployeeId employeeId;
  ...
} 
```

这给出了构成复合键的字段的清晰概念，因为它们都聚合在一个通过字段访问运算符访问的类中。

`@IdClass`与and的另一个区别`@EmbeddedId`是在编写 HQL 时：

和`@IdClass`你一起写：

```
从员工 e 中选择 e.name
```

和`@EmbeddedId`你一起写：

```
从员工 e 中选择 e.employeeId.name
```

您必须为同一个查询编写更多文本。有些人可能会争辩说，这与一种更自然的语言（如`IdClass`. 但大多数情况下，从查询中了解给定字段是组合键的一部分是非常有用的。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2017-02-13T21:38:48.270

使用复合主键的三种策略：

*   将其标记为`@Embeddable`并向您的实体类添加一个普通属性，标记为`@Id`.
*   为您的实体类添加一个普通属性，用`@EmbeddedId`.
*   为实体类的所有字段添加属性，用 标记它们，用`@Id`标记实体类`@IdClass`，提供主键类的类。

使用`@Id`带有标记为的类`@Embeddable`是最自然的方法。无论如何，该`@Embeddable`标签都可用于非主键可嵌入值。它允许您将复合主键视为单个属性，并允许`@Embeddable`在其他表中重用该类。

下一个最自然的方法是使用`@EmbeddedId`标签。在这里，主键类不能用于其他表，因为它不是`@Embeddable`实体，但它确实允许我们将键视为某个类的单个属性。

最后，使用`@IdClass`和`@Id`注释允许我们使用实体本身的属性映射复合主键类，这些属性对应于主键类中的属性名称。名称必须对应（没有覆盖它的机制），并且主键类必须履行与其他两种技术相同的义务。这种方法的唯一优点是它能够从封闭实体的接口“隐藏”主键类的使用。注解接受一个 Class 类型的 value 参数，该`@IdClass`参数必须是要用作复合主键的类。与要使用的主键类的属性对应的字段都必须用 注释`@Id`。

参考： http: [//www.apress.com/us/book/9781430228509](http://www.apress.com/us/book/9781430228509)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-17T19:05:06.903

我发现了一个实例，我必须使用 EmbeddedId 而不是 IdClass。在这种情况下，有一个定义了附加列的连接表。我尝试使用 IdClass 来表示明确表示连接表中的行的实体的键来解决这个问题。我无法让它以这种方式工作。值得庆幸的是，“Java Persistence With Hibernate”有一个专门讨论这个主题的部分。一个提议的解决方案与我的非常相似，但它使用 EmbeddedId 代替。我按照书中的对象建模了我的对象，它现在可以正常运行。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-09-19T09:11:18.410

据我所知，如果您的复合 PK 包含 FK，则使用起来更容易、更直接`@IdClass`

`@EmbeddedId`你必须为你的 FK 列定义一个映射两次，一次是一次`@Embeddedable`，一次是因为你不能在两个变量中设置一个列（可能的冲突）。 所以你必须使用一个简单的类型来设置你的 FK 。`@ManyToOne``@ManyToOne``@PrimaryKeyJoinColumn`
`@Embeddedable`

在另一个站点上使用`@IdClass`这种情况可以更容易地处理，如[通过 OneToOne 和 ManyToOne 关系的主键](http://web.archive.org/web/20150508144430/http://blog.theapplicationbox.com/2012/07/primary-keys-through-onetoone-and.html)所示：

示例 JPA 2.0 ManyToOne id 注释

```
...
@Entity
@IdClass(PhonePK.class)
public class Phone {

    @Id
    private String type;

    @ManyToOne
    @Id
    @JoinColumn(name="OWNER_ID", referencedColumnName="EMP_ID")
    private Employee owner;
    ...
} 
```

示例 JPA 2.0 id 类

```
...
public class PhonePK {
    private String type;
    private long owner;

    public PhonePK() {}

    public PhonePK(String type, long owner) {
        this.type = type;
        this.owner = owner;
    }

    public boolean equals(Object object) {
        if (object instanceof PhonePK) {
            PhonePK pk = (PhonePK)object;
            return type.equals(pk.type) && owner == pk.owner;
        } else {
            return false;
        }
    }

    public int hashCode() {
        return type.hashCode() + owner;
    }
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-01-12T19:15:28.393

我认为主要优点是我们可以`@GeneratedValue`在使用`@IdClass`? 我确定我们不能使用`@GeneratedValue`for `@EmbeddedId`。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-08-30T06:24:55.027

复合键在使用时不能有`@Id`属性`@EmbeddedId`。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-04-02T17:20:35.163

使用 EmbeddedId，您可以在 HQL 中使用 IN 子句，例如：`FROM Entity WHERE id IN :ids`其中 id 是 EmbeddedId，而使用 IdClass 实现相同的结果很痛苦，您需要执行类似的操作`FROM Entity WHERE idPartA = :idPartA0 AND idPartB = :idPartB0 .... OR idPartA = :idPartAN AND idPartB = :idPartBN`

# python - Python中的二分搜索（二分法）

> ID：212358
> 
> 赞同：198
> 
> 时间：2008-10-17T14:23:17.630
> 
> 标签：python, binary-search, bisection

是否有一个库函数对列表/元组执行二进制搜索，如果找到则返回项目的位置，如果没有则返回“假”（-1、无等）？

[我在bisect 模块](http://docs.python.org/library/bisect.html)中找到了 bisect_left/right 函数，但即使项目不在列表中，它们仍然返回一个位置。这对于他们的预期用途来说非常好，但我只想知道一个项目是否在列表中（不想插入任何东西）。

我想过使用`bisect_left`然后检查该位置的项目是否等于我正在搜索的项目，但这似乎很麻烦（而且我还需要检查该数字是否可以大于我列表中的最大数字）。如果有更好的方法我想知道。

**编辑**澄清我需要这个：我知道字典非常适​​合这个，但我试图保持内存消耗尽可能低。我的预期用途是一种双向查找表。我在表中有一个值列表，我需要能够根据它们的索引访问这些值。如果该值不在列表中，我还希望能够找到特定值的索引或 None 。

为此使用字典将是最快的方法，但会（大约）使内存需求增加一倍。

我在问这个问题时认为我可能忽略了 Python 库中的某些内容。正如 Moe 建议的那样，我似乎必须编写自己的代码。

* * *

## 回答 #1

> 赞同：262
> 
> 时间：2010-02-10T02:05:27.873

`bisect_left`查找`p`可以在给定排序范围内插入元素的第一个位置，同时保持排序顺序。这将是`x`if`x`存在于范围内的位置。如果`p`是过去的位置，`x`没有找到。否则，我们可以测试看看是否`x`存在，看看是否`x`找到。

```
from bisect import bisect_left

def binary_search(a, x, lo=0, hi=None):
    if hi is None: hi = len(a)
    pos = bisect_left(a, x, lo, hi)                  # find insertion position
    return pos if pos != hi and a[pos] == x else -1  # don't walk off the end 
```

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-10-17T14:36:49.287

为什么不查看 bisect_left/right 的代码并对其进行调整以适合您的目的。

像这样：

```
def binary_search(a, x, lo=0, hi=None):
    if hi is None:
        hi = len(a)
    while lo < hi:
        mid = (lo+hi)//2
        midval = a[mid]
        if midval < x:
            lo = mid+1
        elif midval > x: 
            hi = mid
        else:
            return mid
    return -1 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-10-17T16:59:57.453

这有点离题（因为 Moe 对 OP 的问题的回答似乎很完整），但可能值得从头到尾查看整个过程的复杂性。如果您将事物存储在排序列表中（这是二进制搜索会有所帮助的地方），然后只是检查是否存在，那么您正在招致（最坏的情况，除非指定）：

**排序列表**

*   O(n log n) 最初创建列表（如果它是未排序的数据。O(n)，如果它是排序的）
*   O(log n) 查找（这是二进制搜索部分）
*   O(n) 插入/删除（可能是 O(1) 或 O(log n) 平均情况，具体取决于您的模式）

而使用 a [`set()`](http://docs.python.org/library/stdtypes.html#set)，您会招致

*   O(n) 创建
*   O(1) 查找
*   O(1) 插入/删除

排序列表真正为您提供的是“下一个”、“上一个”和“范围”（包括插入或删除范围），它们是 O(1) 或 O(|range|)，给定一个起始索引。如果您不经常使用这些类型的操作，那么存储为集合和排序以显示可能会更好。 [`set()`](http://docs.python.org/library/stdtypes.html#set)在 python 中产生很少的额外开销。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2011-04-23T08:36:45.133

值得一提的是，bisect 文档现在提供了搜索示例： [http ://docs.python.org/library/bisect.html#searching-sorted-lists](http://docs.python.org/library/bisect.html#searching-sorted-lists)

（引发 ValueError 而不是返回 -1 或 None 更符合 Python 风格——例如 list.index() 会这样做。当然，您可以根据需要调整示例。）

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-09T22:41:14.233

最简单的是使用[bisect](http://docs.python.org/library/bisect.html)并检查一个位置以查看该项目是否存在：

```
def binary_search(a,x,lo=0,hi=-1):
    i = bisect(a,x,lo,hi)
    if i == 0:
        return -1
    elif a[i-1] == x:
        return i-1
    else:
        return -1 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-12-29T17:20:44.757

这是正确的手册：

[http://docs.python.org/2/library/bisect.html](http://docs.python.org/2/library/bisect.html)

8.5.1。搜索排序列表

上面的 bisect() 函数对于查找插入点很有用，但对于常见的搜索任务来说可能很棘手或尴尬。以下五个函数显示了如何将它们转换为排序列表的标准查找：

```
def index(a, x):
    'Locate the leftmost value exactly equal to x'
    i = bisect_left(a, x)
    if i != len(a) and a[i] == x:
        return i
    raise ValueError 
```

因此，稍作修改，您的代码应该是：

```
def index(a, x):
    'Locate the leftmost value exactly equal to x'
    i = bisect_left(a, x)
    if i != len(a) and a[i] == x:
        return i
    return -1 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-05-21T23:02:52.773

这个是：

*   不递归（这使得它比大多数递归方法更**节省内存）**
*   实际**工作**
*   快速，因为它**运行时没有任何不必要*的 if*和条件**
*   **基于一个数学断言**，即*(low + high)/2*的下限总是小于*high*，其中*low*是下限，*high*是上限。

* * *

```
def binsearch(t, key, low = 0, high = len(t) - 1):
    # bisecting the range
    while low < high:
        mid = (low + high)//2
        if t[mid] < key:
            low = mid + 1
        else:
            high = mid
    # at this point 'low' should point at the place
    # where the value of 'key' is possibly stored.
    return low if t[low] == key else -1 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-09-08T08:28:55.953

我同意[@DaveAbrahams](https://stackoverflow.com/a/2233940/2484194)使用 bisect 模块的答案是正确的方法。他在回答中没有提到一个重要的细节。

从[文档](http://docs.python.org/2/library/bisect.html#searching-sorted-lists) `bisect.bisect_left(a, x, lo=0, hi=len(a))`

对分模块不需要提前预先计算搜索数组。您可以使用 and 的默认值将端点呈现给而`bisect.bisect_left`不是它。`0``len(a)`

对我来说更重要的是，寻找一个值 X 以使给定函数的误差最小化。为此，我需要一种方法来让 bisect_left 的算法调用我的计算。这真的很简单。

只需提供一个定义`__getitem__`为的对象`a`

例如，我们可以使用 bisect 算法找到任意精度的平方根！

```
import bisect

class sqrt_array(object):
    def __init__(self, digits):
        self.precision = float(10**(digits))
    def __getitem__(self, key):
        return (key/self.precision)**2.0

sa = sqrt_array(4)

# "search" in the range of 0 to 10 with a "precision" of 0.0001
index = bisect.bisect_left(sa, 7, 0, 10*10**4)
print 7**0.5
print index/(10**4.0) 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-17T15:03:30.357

如果您只想查看它是否存在，请尝试将列表转换为字典：

```
# Generate a list
l = [n*n for n in range(1000)]

# Convert to dict - doesn't matter what you map values to
d = dict((x, 1) for x in l)

count = 0
for n in range(1000000):
    # Compare with "if n in l"
    if n in d:
        count += 1 
```

在我的机器上，“if n in l”耗时 37 秒，而“if n in d”耗时 0.4 秒。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-09-07T22:08:09.663

Dave Abrahams 的解决方案很好。虽然我会做它简约：

```
def binary_search(L, x):
    i = bisect.bisect_left(L, x)
    if i == len(L) or L[i] != x:
        return -1
    return i 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-11-15T18:03:48.623

虽然 Python 中没有明确的二进制搜索算法，但有一个模块 -`bisect`旨在使用二进制搜索在排序列表中查找元素的插入点。这可以被“欺骗”执行二进制搜索。这样做的最大优势与大多数库代码所具有的优势相同——它性能卓越、经过良好测试并且可以正常工作（特别是二进制搜索可能[很难成功实现](http://en.wikipedia.org/wiki/Binary_search_algorithm#Implementation_issues)——尤其是在没有仔细考虑边缘情况的情况下）。

# 基本类型

对于像 Strings 或 ints 这样的基本类型，这很容易——你只需要`bisect`模块和一个排序列表：

```
>>> import bisect
>>> names = ['bender', 'fry', 'leela', 'nibbler', 'zoidberg']
>>> bisect.bisect_left(names, 'fry')
1
>>> keyword = 'fry'
>>> x = bisect.bisect_left(names, keyword)
>>> names[x] == keyword
True
>>> keyword = 'arnie'
>>> x = bisect.bisect_left(names, keyword)
>>> names[x] == keyword
False 
```

您还可以使用它来查找重复项：

```
...
>>> names = ['bender', 'fry', 'fry', 'fry', 'leela', 'nibbler', 'zoidberg']
>>> keyword = 'fry'
>>> leftIndex = bisect.bisect_left(names, keyword)
>>> rightIndex = bisect.bisect_right(names, keyword)
>>> names[leftIndex:rightIndex]
['fry', 'fry', 'fry'] 
```

显然，如果需要，您可以只返回索引而不是该索引处的值。

# 对象

对于自定义类型或对象，事情有点棘手：您必须确保实现丰富的比较方法才能正确比较 bisect。

```
>>> import bisect
>>> class Tag(object):  # a simple wrapper around strings
...     def __init__(self, tag):
...         self.tag = tag
...     def __lt__(self, other):
...         return self.tag < other.tag
...     def __gt__(self, other):
...         return self.tag > other.tag
...
>>> tags = [Tag('bender'), Tag('fry'), Tag('leela'), Tag('nibbler'), Tag('zoidbe
rg')]
>>> key = Tag('fry')
>>> leftIndex = bisect.bisect_left(tags, key)
>>> rightIndex = bisect.bisect_right(tags, key)
>>> print([tag.tag for tag in tags[leftIndex:rightIndex]])
['fry'] 
```

这应该至少适用于 Python 2.7 -> 3.3

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-17T21:01:17.340

除非您存储的对象非常小，否则使用 dict 不会使您的内存使用量翻倍，因为这些值只是指向实际对象的指针：

```
>>> a = 'foo'
>>> b = [a]
>>> c = [a]
>>> b[0] is c[0]
True 
```

在该示例中，“foo”仅存储一次。这对你有影响吗？我们到底在谈论多少项目？

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-04-30T21:25:18.467

此代码以递归方式处理整数列表。寻找最简单的情况，即：列表长度小于 2。这意味着答案已经存在，并执行测试以检查正确答案。如果不是，则设置一个中间值并测试是否正确，如果不是，则通过再次调用该函数执行二等分，但将中间值设置为上限或下限，将其向左或向右移动

```
def binary_search（intList，intValue，lowValue，highValue）：
    如果（高值 - 低值）< 2：
        返回 intList[lowValue] == intValue 或 intList[highValue] == intValue
    中值 = 低值 + ((高值 - 低值)/2)
    如果 intList[middleValue] == intValue:
        返回真
    如果 intList[middleValue] > intValue：
        return binary_search(intList, intValue, lowValue, middleValue - 1)
   return binary_search(intList, intValue, middleValue + 1, highValue)

```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-05-14T06:26:24.167

查看 Wikipedia 上的示例[http://en.wikipedia.org/wiki/Binary_search_algorithm](http://en.wikipedia.org/wiki/Binary_search_algorithm)

```
def binary_search(a, key, imin=0, imax=None):
    if imax is None:
        # if max amount not set, get the total
        imax = len(a) - 1

    while imin <= imax:
        # calculate the midpoint
        mid = (imin + imax)//2
        midval = a[mid]

        # determine which subarray to search
        if midval < key:
            # change min index to search upper subarray
            imin = mid + 1
        elif midval > key:
            # change max index to search lower subarray
            imax = mid - 1
        else:
            # return index number 
            return mid
    raise ValueError 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-05-11T16:54:56.547

```
'''
Only used if set your position as global
'''
position #set global 

def bst(array,taget): # just pass the array and target
        global position
        low = 0
        high = len(array)
    while low <= high:
        mid = (lo+hi)//2
        if a[mid] == target:
            position = mid
            return -1
        elif a[mid] < target: 
            high = mid+1
        else:
            low = mid-1
    return -1 
```

我想这更好，更有效。请纠正我:)。谢谢

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-01-08T15:01:25.150

*   `s`是一个列表。
*   `binary(s, 0, len(s) - 1, find)`是最初的电话。
*   函数返回查询项的索引。如果没有这样的项目，它会返回`-1`。

    ```
    def binary(s,p,q,find):
        if find==s[(p+q)/2]:
            return (p+q)/2
        elif p==q-1 or p==q:
            if find==s[q]:
                return q
            else:
                return -1
        elif find < s[(p+q)/2]:
            return binary(s,p,(p+q)/2,find)
        elif find > s[(p+q)/2]:
            return binary(s,(p+q)/2+1,q,find) 
    ```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-02-23T13:18:55.193

我需要 python 中的二进制搜索和 Django 模型的泛型。在 Django 模型中，一个模型可以有另一个模型的外键，我想对检索到的模型对象执行一些搜索。我写了以下功能，您可以使用它。

```
def binary_search(values, key, lo=0, hi=None, length=None, cmp=None):
    """
    This is a binary search function which search for given key in values.
    This is very generic since values and key can be of different type.
    If they are of different type then caller must specify `cmp` function to
    perform a comparison between key and values' item.
    :param values:  List of items in which key has to be search
    :param key: search key
    :param lo: start index to begin search
    :param hi: end index where search will be performed
    :param length: length of values
    :param cmp: a comparator function which can be used to compare key and values
    :return: -1 if key is not found else index
    """
    assert type(values[0]) == type(key) or cmp, "can't be compared"
    assert not (hi and length), "`hi`, `length` both can't be specified at the same time"

    lo = lo
    if not lo:
        lo = 0
    if hi:
        hi = hi
    elif length:
        hi = length - 1
    else:
        hi = len(values) - 1

    while lo <= hi:
        mid = lo + (hi - lo) // 2
        if not cmp:
            if values[mid] == key:
                return mid
            if values[mid] < key:
                lo = mid + 1
            else:
                hi = mid - 1
        else:
            val = cmp(values[mid], key)
            # 0 -> a == b
            # > 0 -> a > b
            # < 0 -> a < b
            if val == 0:
                return mid
            if val < 0:
                lo = mid + 1
            else:
                hi = mid - 1
    return -1 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-05-17T19:57:39.420

```
def binary_search_length_of_a_list(single_method_list):
    index = 0
    first = 0
    last = 1

    while True:
        mid = ((first + last) // 2)
        if not single_method_list.get(index):
            break
        index = mid + 1
        first = index
        last = index + 1
    return mid 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-06-26T13:43:58.380

**二进制搜索：**

```
// List - values inside list
// searchItem - Item to search
// size - Size of list
// upperBound - higher index of list
// lowerBound - lower index of list
def binarySearch(list, searchItem, size, upperBound, lowerBound):
        print(list)
        print(upperBound)
        print(lowerBound)
        mid = ((upperBound + lowerBound)) // 2
        print(mid)
        if int(list[int(mid)]) == value:
               return "value exist"
        elif int(list[int(mid)]) < value:
             return searchItem(list, value, size, upperBound, mid + 1)
        elif int(list[int(mid)]) > value:
               return searchItem(list, value, size, mid - 1, lowerBound) 
```

// 要调用上述函数，请使用：

```
list = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
searchItem = 1        
print(searchItem(list[0], item, len(list[0]) -1, len(list[0]) - 1, 0)) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-04-18T19:08:27.270

上面有很多好的解决方案，但我没有看到一个简单的（KISS 保持简单（因为我）愚蠢地使用 Python 内置/通用 bisect 函数进行二进制搜索。在 bisect 函数周围有一些代码，我想我在下面有一个例子，我已经测试了一个小的字符串数组的所有案例。上面的一些解决方案暗示/说这个，但希望下面的简单代码能帮助任何像我一样困惑的人。

Python bisect 用于指示将新值/搜索项插入排序列表的位置。下面的代码使用 bisect_left 如果找到列表/数组中的搜索项，将返回命中的索引（注意 bisect 和 bisect_right 将返回命中或匹配后元素的索引作为插入点）如果没有找到, bisect_left 将返回排序列表中下一项的索引，该索引不会 == 搜索值。唯一的另一种情况是搜索项将位于列表的末尾，返回的索引将超出列表/数组的末尾，并且在 Python 的早期退出下面的代码中使用“and”逻辑句柄。（第一个条件 False Python 不检查后续条件）

```
#Code
from bisect import bisect_left
names=["Adam","Donny","Jalan","Zach","Zayed"]
search=""
lenNames = len(names)
while search !="none":
    search =input("Enter name to search for or 'none' to terminate program:")
    if search == "none":
        break
    i = bisect_left(names,search)
    print(i) # show index returned by Python bisect_left
    if i < (lenNames) and names[i] == search:
        print(names[i],"found") #return True - if function
    else:
        print(search,"not found") #return False – if function
##Exhaustive test cases:
##Enter name to search for or 'none' to terminate program:Zayed
##4
##Zayed found
##Enter name to search for or 'none' to terminate program:Zach
##3
##Zach found
##Enter name to search for or 'none' to terminate program:Jalan
##2
##Jalan found
##Enter name to search for or 'none' to terminate program:Donny
##1
##Donny found
##Enter name to search for or 'none' to terminate program:Adam
##0
##Adam found
##Enter name to search for or 'none' to terminate program:Abie
##0
##Abie not found
##Enter name to search for or 'none' to terminate program:Carla
##1
##Carla not found
##Enter name to search for or 'none' to terminate program:Ed
##2
##Ed not found
##Enter name to search for or 'none' to terminate program:Roger
##3
##Roger not found
##Enter name to search for or 'none' to terminate program:Zap
##4
##Zap not found
##Enter name to search for or 'none' to terminate program:Zyss
##5
##Zyss not found 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-04-01T18:33:59.200

你好，这是我没有二分法的python实现。让我知道是否可以改进。

```
def bisectLeft(a, t):
    lo = 0
    hi = len(a) - 1
    ans = None
    # print("------lower------")
    # print(a, t)
    while lo <= hi:
        mid = (lo + hi) // 2
        # print(a[lo:mid], [a[mid]], a[mid:hi])
        if a[mid] < t:
            lo = mid + 1
        elif a[mid] > t:
            hi = mid - 1
        elif a[mid] == t:
            if mid == 0: return 0
            if a[mid-1] != t: return mid
            hi = mid - 1

    return ans

def bisectRight(a, t):
    lo = 0
    hi = len(a) - 1
    ans = None
    # print("------upper------")
    # print(a, t)
    while lo <= hi:
        mid = (lo + hi) // 2
        # print(a[lo:mid], [a[mid]], a[mid:hi])
        if a[mid] == t:
            ans = mid
        if a[mid] <= t:
            lo = mid + 1
        else:
            hi = mid - 1
    return ans 
```

# javascript - 如何在 Web 服务器上设置 gzip 压缩？

> ID：212378
> 
> 赞同：3
> 
> 时间：2008-10-17T14:28:51.597
> 
> 标签：javascript, compression, gzip

我有一个嵌入式网络服务器，它总共有 2 兆的空间。通常你 gzip 文件是为了客户的利益，但这会节省我们在服务器上的空间。我读到您可以只压缩 js 文件并将其保存在服务器上。我在 IIS 上进行了测试，但我一点运气都没有。在完成这项工作的过程的每个步骤中，我究竟需要做什么？

这就是我想象的样子：

1.  gzip foo.js
2.  将 html 中的链接更改为指向 foo.js.gz 而不仅仅是 .js
3.  在响应中添加某种标题？

非常感谢您的帮助。

-fREW

**编辑**：我的网络服务器不能即时做任何事情。它不是 Apache 或 IIS；它是 ZiLog 处理器上的二进制文件。我知道你可以压缩流；我刚刚听说您也可以将文件压缩一次并保持压缩状态。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T15:37:57.213

正如其他人提到的那样， mod_deflate 会为您执行此操作，但我想您需要手动执行此操作，因为它是嵌入式环境。

首先，您应该在 gzip 之后保留文件 foo.js 的名称。

您不应更改 html 文件中的任何内容。由于文件仍然是 foo.js

在（gzipped）foo.js 的响应标头中，您发送标头

```
Content-Encoding: gzip 
```

这应该可以解决问题。客户端请求 foo.js 并接收 Content-Encoding: gzip 后跟 gzip 压缩文件，它会在解析之前自动解压缩。

当然，这假设您确定客户端理解 gzip 编码，如果您不确定，您应该只在请求标头包含时发送 gzip 压缩数据

```
Accept-Encoding: gzip 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T14:33:29.637

在网络服务器上使用 gzip 压缩通常意味着压缩它的输出以节省您的带宽——这并不是您的想法。

[看这个描述](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/25d2170b-09c0-45fd-8da4-898cf9a7d568.mspx?mfr=true) 或者 [这个例子](http://www.keylimetie.com/Blog/2008/5/20/How-to-enable-HTTP-Compression-on-Windows-Server-2003/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T15:06:03.440

如果您使用的是 Apache，则使用[mod_deflate](http://httpd.apache.org/docs/2.0/mod/mod_deflate.html)，它会即时压缩。

我认为你会因为认为如果你 gzip 某些东西它必须是一个文件而感到困惑。相反，想想一个文件是如何只是一个数据流，并且该数据流可以在这里被压缩、传输和解压缩，而客户端甚至不必考虑它。

# database - 数据库可变长度文本字段应该是 2 的幂吗？

> ID：212380
> 
> 赞同：6
> 
> 时间：2008-10-17T14:29:22.733
> 
> 标签：database, database-design

我的一个朋友声称，在典型的数据库中，使用（例如）`nvarchar[256]`将提供比页面分配的粒度更好的性能，`nvarchar[200]`或者`nvarchar[250]`由于页面分配的粒度。

这有什么道理吗？

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-17T16:49:26.273

这不是真的。表在磁盘上以 8k 页分配。从磁盘读取表时，会在一次 IO 操作中读取整个页面并存储在内存中。因此，列的长度根本不会影响内存对齐。事实上，对于非可变长度数据类型，越短肯定越好：与 nchar(256) 列相比，nchar(200) 列每页允许的行数更多。这允许每个物理 IO 读取更多行，这会对数据库性能产生***巨大影响。***

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T14:31:51.933

不，没有。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-17T14:32:52.117

如果有的话，由于分配开销，它可能会更糟。当您分配 nvarchar(256) 时，数据库可能包含几个字节的长度，因此存储要求实际上可能是 258。

这里有太多的抽象层次在起作用，如果尝试在顶部优化只在底部重要的东西，你不会看到任何好处，而且你可能只会让事情变得更糟！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-19T05:58:14.710

我想知道您的朋友是否以某种方式自己得出了结论，或者这是否是神话传播的案例。

Tom Kyte 关于“你知道的事情”的精彩演讲，几乎每个人都应该在做出上述声明之前观看：[你知道的事情](http://www.ioug.org/services/webcast/things_you_know.zip)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-19T07:10:48.933

可以这样想：如果 nvarchar[256] 的性能比 nvarchar[200] 好，那么当您请求 nvarchar[200] 时，DBMS 不会只创建一个 nvarchar[256] 吗？（但仍然让它看起来像 nvarchar[200]）

好的 DBMS 有一些非常先进的优化。我很确定他们也有所有简单的。

# php - 错误：字符串不支持 [] 运算符

> ID：212381
> 
> 赞同：8
> 
> 时间：2008-10-17T14:29:47.833
> 
> 标签：php, arrays

我正在尝试使用以下语法创建一个多维数组：

```
$x[1] = 'parent';
$x[1][] = 'child'; 
```

我得到错误：`[] operator not supported for strings` 因为它正在评估`$x[1]`字符串而不是返回数组，所以我可以附加到它。

这样做的正确语法是什么？总体目标是在将元素附加到已知索引的迭代中创建这个多维数组。

语法`${$x[1]}[]`也不起作用。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-17T14:32:51.323

父母必须是一个数组！

```
$x[1] = array();
$x[1][] = 'child'; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T14:32:24.257

```
$x = array();
$x[1] = array();
$x[1][] = 'child'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-19T12:21:44.080

我想你想要做的是最后使用 $x['parent'] ，不是吗？

所以它不完全是 $x = array() 而是更像：

```
$x = array('parent' => array());
$x['parent'][] = 'child'; 
```

# ftp - 电子邮件和 ftp 文本消息之间的大小差异 - EOL 字符？

> ID：212389
> 
> 赞同：1
> 
> 时间：2008-10-17T14:31:25.147
> 
> 标签：ftp, mime, eol

我试图通过 FTP 或电子邮件传递相同的消息，但保存的文件总是以不同的大小出现。消息的文字内容是一样的，但不可打印的字符一定要占不同的大小！

通过 FTP 传输文本文件时（在二进制模式下以防止 FTP 转换 EOL 字符），交付的文件大小为 7660 字节。

当我通过电子邮件传递消息（使用 smtp 发送，使用 POP3 检索）时，传递的消息大小（直接转储到新文件时）为 8043 字节。电子邮件作为纯文本电子邮件发送，并且消息包含整个电子邮件正文。这是 383 字节的大小差异，行数是 385 行，这让我认为这两者是相关的……但尽我所能，我无法通过电子邮件收到相同的消息！

我尝试了几种在电子邮件数据上剥离回车和换行的组合，但无济于事！

MIME 消息是否有不同的换行处理方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T14:48:58.340

在 SMTP 期间，您应该以 CR LF 结束每一行。如果您的原始电子邮件以换行符结束每一行，则在传输之后，邮件程序可能已将每个换行符转换为 CR LF，这将为每一行添加一个额外的字节。

另一方面，也可能是巧合。您是否查看过两端的邮件程序是否添加了额外的标题行，例如 From 行？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T14:36:13.733

这不是一个解决方案，但是逐字节比较这两个消息当然是个好主意，以确定确切的差异是什么。根据您所说的，我同意这听起来像是一个行尾问题，但最好确定一下。

此外，如果您真的使用 FTP 来传输消息（这听起来有点奇怪，但没关系），您可能需要调查在 FTP 的二进制与 ascii/文本模式之间切换时结果的差异。

# javascript - JavaScript - 我如何了解“闭包”的用法？

> ID：212401
> 
> 赞同：3
> 
> 时间：2008-10-17T14:33:11.960
> 
> 标签：javascript, closures

来自维基百科，免费的百科全书：**闭包（计算机科学）**

> 在计算机科学中，闭包是在包含一个或多个绑定变量的环境中评估的函数。调用时，该函数可以访问这些变量。闭包的显式使用与函数式编程以及 ML 和 Lisp 等语言相关联。其他语言中的对象等构造也可以用闭包来建模。

要在 JavaScript 中使用它，有人可以给我举个例子来说明它是如何应用的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-17T14:37:44.870

搜索“javascript 闭包”会提供大量看起来令人鼓舞的链接。前三个是这两个（第三个链接是第二个的重新格式化版本）：

*   [Javascript 闭包](http://www.jibbering.com/faq/faq_notes/closures.html)
*   [傻瓜的 JavaScript 闭包](http://web.archive.org/web/20101113013100/http://blog.morrisjohns.com/javascript_closures_for_dummies.html)

如果这些对您没有帮助，请解释原因，以便我们能够更好地提供实际帮助。如果您在提问之前没有搜索，那么 - 请下次再搜索 :)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T14:40:24.710

（使用来自 jQuery 的示例）

```
function SetClassOnHover(className){
  $("td").hover(
    function () {
      $(this).addClass(className);
    },
    function () {
      $(this).removeClass(className);
    }
  );
} 
```

当变量 className 在每个函数的范围内使用时，闭包就会发挥作用。当 SetClassOnHover 退出时，两个函数都必须保留 className 的句柄，以便在调用函数时访问其值。这就是闭包所能实现的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-22T22:50:25.020

闭包的一个实际示例是当它们用于创建“私有”变量时，例如

```
function incrementer(){
    var i=0;
    this.increment=function(){
        i++;
    }
    this.get=function(){
        return i;
    }
} 
```

访问 i 的唯一方法是使用 get 方法，而更改它的唯一方法是使用方法 increment。在类中，您可以这样做来模拟私有变量。

# ruby - ruby 中的单例类到底是什么？

> ID：212407
> 
> 赞同：90
> 
> 时间：2008-10-17T14:35:36.480
> 
> 标签：ruby, oop, singleton

Ruby 中的单例类本身就是一个类吗？这就是所有对象都属于“类”的原因吗？这个概念是**模糊**的，但我相信这与我为什么可以定义一个类方法有关（`class foo; def foo.bar ...`）。

Ruby 中的单例类是什么？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2008-10-17T18:01:00.403

首先，一点定义：**单例方法**是只为单个对象定义的方法。例子：

```
irb(main):001:0> class Foo; def method1; puts 1; end; end
=> nil
irb(main):002:0> foo = Foo.new
=> #<Foo:0xb79fa724>
irb(main):003:0> def foo.method2; puts 2; end
=> nil
irb(main):004:0> foo.method1
1
=> nil
irb(main):005:0> foo.method2
2
=> nil
irb(main):006:0> other_foo = Foo.new
=> #<Foo:0xb79f0ef4>
irb(main):007:0> other_foo.method1
1
=> nil
irb(main):008:0> other_foo.method2
NoMethodError: undefined method `method2' for #<Foo:0xb79f0ef4>
        from (irb):8 
```

实例方法是类的方法（即在类的定义中定义）。类方法是类`Class`实例上的单例方法——它们没有在类的定义中定义。相反，它们是在对象的**单例类**上定义的。

```
irb(main):009:0> Foo.method_defined? :method1
=> true
irb(main):010:0> Foo.method_defined? :method2
=> false 
```

You open the singleton class of an object with the syntax `class << obj`. Here, we see that this singleton class is where the singleton methods are defined:

```
irb(main):012:0> singleton_class = ( class << foo; self; end )
=> #<Class:#<Foo:0xb79fa724>>
irb(main):013:0> singleton_class.method_defined? :method1
=> true
irb(main):014:0> singleton_class.method_defined? :method2
=> true
irb(main):015:0> other_singleton_class = ( class << other_foo; self; end )
=> #<Class:#<Foo:0xb79f0ef4>>
irb(main):016:0> other_singleton_class.method_defined? :method1
=> true
irb(main):017:0> other_singleton_class.method_defined? :method2
=> false 
```

So an alternative means of adding singleton methods to an object would be to define them with the object's singleton class open:

```
irb(main):018:0> class << foo; def method3; puts 3; end; end
=> nil
irb(main):019:0> foo.method3
3
=> nil
irb(main):022:0> Foo.method_defined? :method3
=> false 
```

In summary:

*   methods must always belong to a class (or: be instance methods of some class)
*   normal methods belong to the class they're defined in (i.e. are instance methods of the class)
*   class methods are just singleton methods of a `Class`
*   singleton methods of an object are not instance methods of the class of the object; rather, they are instance methods of the singleton class of the object.

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-01-19T20:21:16.563

Ruby provides a way to define methods that are specific to a particular object and such methods are known as Singleton Methods. When one declares a singleton method on an object, Ruby automatically creates a class to hold just the singleton methods. The newly created class is called Singleton Class.

```
 foo = Array.new
    def foo.size
      "Hello World!"
    end
    foo.size  # => "Hello World!"
    foo.class # => Array
    #Create another instance of Array Class and call size method on it
    bar = Array.new
    bar.size  # => 0 
```

Singleton class is object specific anonymous class that is automatically created and inserted into the inheritance hierarchy.

`singleton_methods` can be called on an object to get the list of of names for all of the singleton methods on an object.

```
 foo.singleton_methods  # => [:size]
    bar.singleton_methods  # => [] 
```

This [article](http://www.devalot.com/articles/2008/09/ruby-singleton) really helped me to understand Singleton Classes in Ruby and it has a good code example.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-10-24T17:42:54.953

As just update to @Pistos answer, from version 1.9.2 ruby add new syntax to getting singleton class

```
 singleton_class = ( class << foo; self; end ) 
```

can be replaced with:

```
singleton_class = foo.singleton_class 
```

[https://apidock.com/ruby/Object/singleton_class](https://apidock.com/ruby/Object/singleton_class)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-17T16:49:06.913

最务实/以行动为导向的思考方式（恕我直言）是：作为继承链，或方法查找/解析顺序。这张照片可能会有所帮助

[http://www.klankboomklang.com/2007/11/25/modules-part-i-enter-the-include-class/](http://www.klankboomklang.com/2007/11/25/modules-part-i-enter-the-include-class/)

这是 r 1.9，对比内置和用户定义的类：我仍在消化这个。

[http://d.hatena.ne.jp/sumim/20080111/p1](http://d.hatena.ne.jp/sumim/20080111/p1)

另外，我认为这个术语的一个令人困惑的用法是“单例对象”，这是一个不同的概念。单例对象来自一个类，该类的构造函数/实例化方法被覆盖，因此您只能分配该类中的一个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-02-29T18:26:56.857

A singleton class in the simplest terms is a special class ruby whips up to host methods defined on individual objects. In ruby, it is possible to define methods on individual objects that are unique to that object alone. For instance consider the following below

```
class User; end
user = User.new
def user.age
  "i'm a unique method"
end
user1 = User.new 
user.age #"i'm a unique method"
user1.age # NoMethodError (undefined method `age' for #<User:0x0000559c66ab7338>) 
```

As you can see above, user1 object does not respond to the 'age' method because it is a singleton method, a method uniquely defined on user object. For this to happen, ruby creates a special class, called singleton class, or eigenclass, to host this unique method. You can verify this by doing the following:

```
user.singleton_class # #<Class:#<User:0x0000559c66b47c58>> 
```

You can also ask ruby whether the 'age' method is found here by using the method object to find out where the method 'age' is defined. When you do this you will see that singleton class has that method.

```
user_singleton_class = user.method(:age).owner # #<Class:#<User:0x0000559c66b47c58>>
user.method(:age).owner == user.singleton_class # true
user_singleton_class.instance_methods(false) # [:age] 
```

Also note that, as far a singleton class goes, singleton methods are actually it's instance methods.

```
user.singleton_methods == user_singleton_class.instance_methods(false) # true 
```

# c# - 我在哪里可以获得有关使用 MVC / ASP.NET 开始 C# 编程的一些信息？

> ID：212423
> 
> 赞同：7
> 
> 时间：2008-10-17T14:39:06.583
> 
> 标签：c#, asp.net-mvc

我是一名 Java 开发人员，希望学习一些 C#/ASP.NET。我从一开始就不喜欢 .NET 的一件事是它不支持 MVC。但现在它做到了！所以我想知道是否有人知道从哪里开始学习 C# MVC。

另外，您是否需要非免费版本的 developer-studio 来执行此操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T14:44:56.323

请留意[Scott Guthrie](http://weblogs.asp.net/Scottgu/)和[Phil Haack](http://haacked.com/)的博客。它们是目前文档的主要来源。

小心，因为大多数关于 MVC 的帖子都是关于以前的版本并且不再适用（不幸的是，任何使用 lambda 的帖子都已经发布了）。

当然，你在这里也有很好的资源。Haack 偶尔会回答有关 MVC 的问题...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T14:39:58.610

[http://www.asp.net/mvc/](http://www.asp.net/mvc/)

[VWD (Visual Web Developer) 2008](http://www.microsoft.com/express/vwd/) Express Edition现在支持 MVC。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T18:25:21.947

看看这个[学习 ASP.NET MVC Beta 1 的指南](http://weblogs.asp.net/stephenwalther/archive/tags/ASP.NET+MVC/default.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T14:58:14.267

只是为了补充 Will 的答案，Scott 有一个关于 ASP.NET MVC 开发的系列：

[ASP.NET MVC 框架第 1 部分](http://weblogs.asp.net/scottgu/archive/2007/11/13/asp-net-mvc-framework-part-1.aspx)

[ASP.NET MVC 框架（第 2 部分）：URL 路由](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)

[ASP.NET MVC 框架（第 3 部分）：将 ViewData 从控制器传递到视图](http://weblogs.asp.net/scottgu/archive/2007/12/06/asp-net-mvc-framework-part-3-passing-viewdata-from-controllers-to-views.aspx)

[ASP.NET MVC 框架（第 4 部分）：处理表单编辑和发布场景](http://weblogs.asp.net/scottgu/archive/2007/12/09/asp-net-mvc-framework-part-4-handling-form-edit-and-post-scenarios.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T15:40:46.360

如果您想查看功能齐全的全功能解决方案，您应该查看[TheBeerHouse MVC 项目](http://www.codeplex.com/TheBeerHouse/SourceControl/ListDownloadableCommits.aspx)，我认为您会找到很多关于如何使用 MVC 的非常好的示例。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-09T22:10:45.093

我会查看[这里的 NerdDinner ASP.NET MVC 教程。](http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T15:05:55.280

如果您有，您可以浏览您所在地区的本地 .Net 用户组的会议列表。如果您没有看到正在呈现的 MVC 主题，请让组长安排一个。如果他不能满足您的要求，他应该仍然可以将您指向其他资源。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T18:18:14.317

我自己正在学习 ASP.NET MVC，发现[Stephan Walter 的博客](http://weblogs.asp.net/stephenwalther/archive/tags/ASP.NET+MVC/default.aspx)非常有用。他有 45 篇包含各种技巧的帖子，还发布了关于两个示例 ASP.NET MVC 站点的帖子。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-09T22:27:28.413

买这本书，

Steven Sanderson 的 Pro ASP.NET MVC 框架

这是一本非常好的书。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-29T21:43:05.167

我不建议你从网上教程开始，如果你想系统地学习它，那就从纸质书开始。它将帮助您更系统地学习事物。

# ruby-on-rails - 创建带有可选路径前缀的路由

> ID：212425
> 
> 赞同：22
> 
> 时间：2008-10-17T14:39:23.900
> 
> 标签：ruby-on-rails, ruby, routing

我怎样才能让我的路线识别一个可选的前缀参数，如下所示：

```
/*lang/controller/id 
```

其中 lang 部分是可选的，如果 URL 中未指定，则具有默认值：

```
/en/posts/1   => lang = en
/fr/posts/1   => lang = fr
/posts/1      => lang = en 
```

*编辑*

理想情况下，我希望通过映射命名空间来跨许多控制器和操作执行此操作：

```
map.namespace "*lang" do |lang|
  lang.resources :posts
  lang.resources :stories
end 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-21T08:13:04.643

好的，我已经设法解决了这个问题：

默认情况下，在 Rails 中没有办法做到这一点（至少目前还没有）。我需要安装[Sven Fuchs 的路由过滤器](http://github.com/svenfuchs/routing-filter/tree/master)，而不是使用命名空间和默认值。

安装插件后，我将以下文件添加到我的 lib 目录：

```
require 'routing_filter/base'

module RoutingFilter
  class Locale < Base

    # remove the locale from the beginning of the path, pass the path
    # to the given block and set it to the resulting params hash
    def around_recognize(path, env, &block)
      locale = nil
      path.sub! %r(^/([a-zA-Z]{2})(?=/|$)) do locale = $1; '' end
      returning yield do |params|
        params[:locale] = locale || 'en'
      end
    end

    def around_generate(*args, &block)
      locale = args.extract_options!.delete(:locale) || 'en'
      returning yield do |result|
        if locale != 'en'
          result.sub!(%r(^(http.?://[^/]*)?(.*))){ "#{$1}/#{locale}#{$2}" }
        end 
      end
    end

  end
end 
```

我将此行添加到 routes.rb：

```
map.filter 'locale' 
```

这基本上填写了一个由插件生成的前后钩子，它包装了rails路由。

当一个 url 被识别时，在 Rails 对其进行任何操作之前，将调用 around_recognize 方法。这将提取表示区域设置的两个字母代码，并将其传递到参数中，如果未指定区域设置，则默认为“en”。

同样，当生成 url 时，locale 参数将被推送到左侧的 URL 中。

这给了我以下网址和映射：

```
/   => :locale => 'en'
/en => :locale => 'en'
/fr => :locale => 'fr' 
```

所有现有的 url 助手都像以前一样工作，唯一的区别是除非指定了语言环境，否则它会被保留：

```
home_path                  => /
home_path(:locale => 'en') => /
home_path(:locale => 'fr') => /fr 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T17:42:13.360

`:defaults`您可以使用键在路由中定义默认值。试试这个：

```
map.connect ':lang/posts/:id', :controller => 'posts', :action => 'show',
                               :defaults => { :lang => 'en' } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-30T09:23:17.237

我理解这个老问题，但它可能有用。

```
 map.with_options(:path_prefix => ":locale") do |m|
    m.resources :posts
    m.resources :stories        
  end 
```

并且您必须在过滤器之前添加到应用程序控制器以定义语言环境，例如

```
before_filter :define_locale

def define_locale
  if params[:locale] == nil
    I18n.locale = 'en'
  else
    I18n.locale = params[:locale]
  end
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T16:37:55.860

我猜（现在没有时间测试）这可能有效：

```
map.connect ':language/posts/:id', :controller => 'posts', :action => 'show'
map.connect 'posts/:id', :controller => 'posts', :action => 'show' 
```

好的，试过了——至少在 Rails 2.1.1 上有效。所以这很好。但是，无法使 :defaults 想法起作用，这很遗憾，因为它是 DRYer。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T21:09:19.337

以为您可以一次使用 [key] => nil 来指定可选参数。就像是：

```
map.connect ':lang/posts/:id', :controller => 'posts', :action => 'show', :lang => nil 
```

# c# - 无法将“System.Object[]”类型的对象转换为“MyObject[]”，这是什么原因？

> ID：212429
> 
> 赞同：12
> 
> 时间：2008-10-17T14:40:07.673
> 
> 标签：c#, .net, arrays, reflection, casting

设想：

我目前正在编写一个层来将 3 个类似的 Web 服务抽象为一个可用的类。每个 Web 服务都公开了一组具有共同性的对象。我创建了一组利用共性的中间对象。但是在我的层中，我需要在 Web 服务对象和我的对象之间进行转换。

在调用 Web 服务之前，我使用反射在运行时创建了适当的类型，如下所示：

```
 public static object[] CreateProperties(Type type, IProperty[] properties)
    {
        //Empty so return null
        if (properties==null || properties.Length == 0)
            return null;

        //Check the type is allowed
        CheckPropertyTypes("CreateProperties(Type,IProperty[])",type);

        //Convert the array of intermediary IProperty objects into
        // the passed service type e.g. Service1.Property
        object[] result = new object[properties.Length];
        for (int i = 0; i < properties.Length; i++)
        {
            IProperty fromProp = properties[i];
            object toProp = ReflectionUtility.CreateInstance(type, null);
            ServiceUtils.CopyProperties(fromProp, toProp);
            result[i] = toProp;
        }
        return result;
    } 
```

这是我的调用代码，来自我的一个服务实现：

```
Property[] props = (Property[])ObjectFactory.CreateProperties(typeof(Property), properties);
_service.SetProperties(folderItem.Path, props); 
```

因此，每个服务都公开了一个不同的“Property”对象，我将其隐藏在我自己的 IProperty 接口实现后面。

反射代码在单元测试中工作，产生一个对象数组，其元素是适当的类型。但调用代码失败：

> System.InvalidCastException：无法将“System.Object[]”类型的对象转换为“MyProject.Property[]”类型

有任何想法吗？

我的印象是，只要包含的对象是可转换的，来自 Object 的任何转换都会起作用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T14:44:39.410

基本上，没有。数组协方差有一些有限的用途，但最好简单地知道您想要哪种类型的数组。有一个通用的 Array.ConvertAll 很容易（至少，使用 C# 3.0 更容易）：

```
Property[] props = Array.ConvertAll(source, prop => (Property)prop); 
```

C# 2.0 版本（含义相同）不太容易吸引眼球：

```
 Property[] props = Array.ConvertAll<object,Property>(
     source, delegate(object prop) { return (Property)prop; }); 
```

或者只是创建一个合适大小的新 Property[] 并手动（或通过`Array.Copy`）复制。

作为使用数组协方差*可以*做的事情的一个例子：

```
Property[] props = new Property[2];
props[0] = new Property();
props[1] = new Property();

object[] asObj = (object[])props; 
```

在这里，“asObj”*仍然*是一个`Property[]`- 它可以简单地访问为`object[]`. 在 C# 2.0 及更高版本中，泛型通常是比数组协方差更好的选择。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-17T14:56:13.617

替代答案：泛型。

```
public static T[] CreateProperties<T>(IProperty[] properties)
    where T : class, new()
{
    //Empty so return null
    if (properties==null || properties.Length == 0)
        return null;

    //Check the type is allowed
    CheckPropertyTypes("CreateProperties(Type,IProperty[])",typeof(T));

    //Convert the array of intermediary IProperty objects into
    // the passed service type e.g. Service1.Property
    T[] result = new T[properties.Length];
    for (int i = 0; i < properties.Length; i++)
    {
        T[i] = new T();
        ServiceUtils.CopyProperties(properties[i], t[i]);
    }
    return result;
} 
```

然后您的调用代码变为：

```
Property[] props = ObjectFactory.CreateProperties<Property>(properties);
_service.SetProperties(folderItem.Path, props); 
```

更干净:)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-17T14:45:33.230

正如其他人所说，数组必须是正确的类型。其他答案已经展示了如何在事后转换真正的 object[] ，但是您可以创建正确类型的数组以使用[Array.CreateInstance](http://msdn.microsoft.com/en-us/library/system.array.createinstance.aspx)开始：

```
object[] result = (object[]) Array.CreateInstance(type, properties.Length); 
```

假设`type`是引用类型，这应该可以工作 - 数组将是正确的类型，但您将使用它`object[]`来填充它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-17T14:42:12.973

你不能像这样转换一个数组——它返回一个对象数组，这与一个对象不同。试试[Array.ConvertAll](http://msdn.microsoft.com/en-us/library/exc45z53.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T14:42:50.163

没错，但这并不意味着您可以将 Object 类型的容器转换为其他类型的容器。Object[] 与 Object 不同（尽管奇怪的是，您可以将 Object[] 转换为 Object）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-20T14:39:30.660

在 C# 2.0 中，您*可以*使用反射来执行此操作，而无需使用泛型并且在编译时不知道所需的类型。

```
//get the data from the object factory
object[] newDataArray = AppObjectFactory.BuildInstances(Type.GetType("OutputData"));
if (newDataArray != null)
{
    SomeComplexObject result = new SomeComplexObject();
    //find the source
    Type resultTypeRef = result.GetType();
    //get a reference to the property
    PropertyInfo pi = resultTypeRef.GetProperty("TargetPropertyName");
    if (pi != null)
    {
        //create an array of the correct type with the correct number of items
        pi.SetValue(result, Array.CreateInstance(Type.GetType("OutputData"), newDataArray.Length), null);
        //copy the data and leverage Array.Copy's built in type casting
        Array.Copy(newDataArray, pi.GetValue(result, null) as Array, newDataArray.Length);
    }
} 
```

您可能希望将所有 Type.GetType("OutputData") 调用和 GetProperty("PropertyName") 替换为从配置文件中读取的一些代码。

我还将使用泛型来指示 SomeComplexObject 的创建

```
T result = new T();
Type resultTypeRef = result.GetType(); 
```

但我说你不需要使用泛型。

不能保证性能/效率，但它确实有效。

# arrays - 防止 VBA 动态数组中的额外元素

> ID：212434
> 
> 赞同：1
> 
> 时间：2008-10-17T14:41:03.163
> 
> 标签：arrays, excel, optimization, vba, vb6

正如标题所述，有没有办法防止额外的元素在非零基时出现在 VBA 动态数组中？

例如，当使用类似于以下的代码时：

```
While Cells(ndx, 1).Value <> vbNullString
    ReDim Preserve data(1 To (UBound(data) + 1))
    ndx = ndx + 1
Wend 
```

在处理结束时，您有一个额外的空数组元素。虽然这可以通过以下方式消除：

```
ReDim Preserve data(1 To (UBound(data) - 1)) 
```

这似乎不是解决此问题的最佳方法。

因此，有没有办法一开始就防止创建额外的元素？最好是在循环内不需要额外逻辑的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T15:19:34.893

`ReDim Preserve`是一个相对昂贵的操作，可能不是每次迭代都要做的事情。最好`ReDim`将数组设置为比您需要的更大的上限（可能是块），然后在完成后将数组减少到所需的上限。

此外，您可能想研究将 Excel 范围读入数组的其他方法，例如

```
 Dim a()
  With Sheet1
    a = .Range(.Range("A1"), .Range("A1").End(xlDown)).Value
  End With
  Debug.Print a(1, 1) 
```

循环通常很慢:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T14:54:02.497

Visual Basic 数组是从零开始的。不过，这可以通过`Option Base`语句进行更改。

对于你的数组，额外的元素是因为你做了 a `UBound() + 1`， UBound 已经给你正确的数字了。如果数组有 5 个元素，则 UBound 将为 5。但最后一个索引将为 4，因此 ReDim to UBound 将为您提供一个大小为 +1 的数组。

由于数组无论如何都很难使用（即在 VBA 中），并且`ReDim Preserve`实际上是对新的固定大小数组的数组复制操作，因此我建议您尽可能使用 Collections。它们更容易迭代 ( `For Each ... In ...`) 并且在添加、查找和删除元素方面效率更高。

```
' creation ' 
Dim anyValue as Variant
Dim c as New Collection

' and adding values '
c.Add anyValue, strKey

' iteration '
For Each anyValue in c
  Debug.Print anyValue
Next c

' count values '
Debug.Print c.Count

' element deletion '
c.Delete strKey 
```

*（您可以使用 VBScript 中的 Scripting.Dictionary 来增加舒适度，但您需要先引用它。）*

您还可以通过简单地将它们放在彼此内部来拥有多个维度的集合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T17:42:43.233

VB6 和 COM 混合使用基于 0 和 1 的索引（数组是基于 0 的，除非您使用 Option Base 更改它或以其他方式显式声明它们）。

COM 集合在早期的 COM 对象模型中通常是从 1 开始的，但有时是从 0 开始的......

Dim/Redim data(1 To N) 是从 1 到 N 索引的 N 个元素的数组

Dim/Redim data(0 to N-1) 是从 0 到 N-1 索引的 N 个元素的数组

Dim/Redim data(N) 是从 0 到 N 索引的 N+1 个元素的数组（如果 Option Base 为 0）

最后一种情况有时会令人困惑，data(N) 通常表示 data(0 To N)，它是 N+1 个元素的数组。

就我个人而言，我总是将数组显式声明为 (0 To N-1) 并且不依赖 Option Base，这对于使用一种以上语言的开发人员来说更熟悉。

有一种极端情况：VBA 不支持零长度数组，您必须始终至少有一个元素（对于多维数组中的每个维度）。因此，您可以声明的最小数组是具有一个元素的 data(0 To 0) 或 data(1 To 1)。

在您的情况下，我怀疑您正在创建一个包含一个元素的数组，然后每次通过循环添加一个元素：

```
ReDim data(1 To 1)    
While Cells(ndx, 1).Value <> vbNullString    
    ReDim Preserve data(1 To (UBound(data) + 1))    
    ndx = ndx + 1
Wend 
```

相反（暂时不考虑在循环中调用 ReDim Preserve 的效率），您应该使用：

```
ReDim data(1 To 1)    
nStartIndex = ndx
While Cells(ndx, 1).Value <> vbNullString    
    ' On the first iteration this does nothing because
    ' the array already has one element
    ReDim Preserve data(1 To ndx - nStartIndex + 1)    
    ndx = ndx + 1
Wend 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T19:34:40.170

所以这变成了一个烦人的小问题，因为看起来真的没有办法阻止这个问题的出现。根据其他用户提供的答案，我厌倦了以下解决问题的方法。

**[使用集合](https://stackoverflow.com/questions/212434/is-there-a-way-to-prevent-extra-elements-in-vba-dynamic-arrays#212497)**- 虽然这种方法在您需要读取和存储数据的情况下非常有效，但您不能将用户定义的类型与集合一起使用。能够定义项目键很有用，因为您可以使用它来交叉引用两个集合；但是，在 VBA 中，[无法获取 Collection 中的键列表，](http://www.issociate.de/board/post/302889/VBA_collections_question.html)这可能会受到限制。

**[将 Excel 范围读入数组](https://stackoverflow.com/questions/212434/is-there-a-way-to-prevent-extra-elements-in-vba-dynamic-arrays#212615)**- 另一种非常好的方法，但当您提前知道范围将是什么时，它似乎效果最好。如果您必须即时计算范围，那么您可能会发现自己处于使用 Collection 或较小的 ReDim 数组更容易使用的情况。

**使用 ReDim Preserve 动态构建阵列**- 虽然这可能是一个相当简单的操作，但它涉及两个问题。一个是[ReDim](http://msdn.microsoft.com/en-us/library/w8k3cys2.aspx)可能是一项昂贵的操作，因为 Visual Basic 实际上会创建一个具有给定大小的新数组，复制旧数组，然后删除旧数组（或为 Visual Basic .NET 中的垃圾收集器释放它）。因此，如果您要使用非常大的数组，您会希望尽量减少对 ReDim 的调用。

此外，您可能会遇到类似于问题中的情况，即在数组的开头或数组的末尾有一个额外的元素是空的。解决此问题的唯一方法似乎是在执行操作之前检查是否需要调整大小，或者在返回结果之前删除空元素。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-19T16:43:16.970

自从提出这个问题以来已经有一段时间了；但是，我今天遇到了同样的问题并像这样解决了它：

有一种方法可以做到这一点，即定义一个永远不会使用的第一个元素。如果您需要一个基于零的数组，您将定义一个像这样的空数组

```
Dim data()
Dim i as Long

ReDim data(-1 To -1) ' Empty array. We never use data(-1).

For i = 0 To UBound(data)
    ...
Next i 
```

如果你需要一个基于 1 的数组，你会这样做

```
ReDim data(0 To 0) ' Empty array. We never use data(0).

For i = 1 To UBound(data)
    ...
Next i 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T17:54:42.727

诚然，自从我完成经典的 VB6 以来已经有一段时间了，我的 VBA 体验更加生疏了……如果内存服务，VB 的数组语法是不同的，不仅仅是基数是 1 而不是 0。语法也表示您指定的“大小”并不表示数组中元素的总数，而是表示最后一个可寻址的索引。

# c++ - 如何在 C++ 中创建类似 for 循环的命令？

> ID：212442
> 
> 赞同：0
> 
> 时间：2008-10-17T14:44:19.553
> 
> 标签：c++, function

我想在 C++ 中做一些非常简单的事情，但我找不到如何做。我想创建一个类似于 for 循环的函数，理想情况下，我将在其中输入一个变量来表示迭代应该发生的时间，并且括号内的一些函数将执行我的函数。我希望我足够清楚。谢谢...

例子

```
superFor (1)
{
  //commands to be executed here  
  add(1+2);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T14:48:22.710

```
#define superFor(n) for(int i = 0; i < (n); i++) 
```

编辑：注意不要在循环中使用另一个名为 i 的变量。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T14:48:05.253

你想要的在 C++ 中是不可能的，因为（当前版本的）语言缺少这里需要的一些特性：即“动态”创建功能块。

您可以做的最好的事情是将函数指针或函数对象传递给您的函数。STL 提供了很多这样的例子。考虑：

```
void out(int x) {
    cout << x << ' ';
}

vector<int> xs;
xs.push_back(42);
xs.push_back(23);

for_each(xs.begin(), xs.end(), out); 
```

这会将指向函数的指针传递给`out`函数[`for_each`](http://cppreference.com/wiki/stl/algorithm/for_each)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T14:52:54.573

在 C++ 中，您使用常规的 for 循环来做到这一点。

```
 for(variable; condition; increment) {
    //stuff goes here
  } 
```

在你的 for 循环中：变量是一个像 i 一样的计数变量。您可以在此处定义变量并对其进行初始化。你经常看到像“int i = 0”这样的东西

条件是某种测试。在您的情况下，您想检查您的计数变量是否小于您希望循环执行的次数。你会放一些像“i < how_many_times_to_loop”

increment 是增加计数变量的命令。在您的情况下，您想要“i++”，这是说“i = i + 1”的简写方式

所以这给了我们：

```
 for(int i = 0; i < how_many_times_to_loop; i++) {
    //stuff goes here
  } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T14:52:23.233

这很疯狂，但它可能只是工作......

[http://www.boost.org/doc/libs/1_36_0/doc/html/lambda.html](http://www.boost.org/doc/libs/1_36_0/doc/html/lambda.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T14:51:03.843

你可以使用宏。

```
#define superFor(v,i) for(int v=0; v<(i); v++) 
```

并像这样使用它：

```
superFor(i,10) {
   printf("Doing something ten times");
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T14:47:49.390

```
void DoSomethingRepeatedly(int numTimesTo Loop)
{
   for(int i=0; i<numTimesToLoop; i++)
   { 
       //do whatever; 
   }
} 
```

那呢？那不可能..太简单了..我一定误解了你的问题:(当然你必须检查 numTimesToLoop 的值是否> = 0。

编辑：我把它做成了一种方法，以防万一。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T14:49:16.517

也许 BOOST_FOREACH 会做你想做的事：

[http://engineering.meta-comm.com/resources/cs-win32_metacomm/doc/html/foreach.html](http://engineering.meta-comm.com/resources/cs-win32_metacomm/doc/html/foreach.html)

# solr - Solr - 在不返回搜索结果的情况下获取构面计数

> ID：212446
> 
> 赞同：38
> 
> 时间：2008-10-17T14:45:11.097
> 
> 标签：solr, faceted-search

我只需要从 solr 返回方面计数。所以我基本上想搜索所有文档并返回构面计数，但我不想返回任何搜索结果。这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2010-04-29T19:28:50.143

设置`facet=true`将启用分面，设置`rows=0`将阻止返回任何结果。方便地`numFound`显示找到了多少结果。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-17T15:38:02.627

我想显而易见的解决方案是使用通配符进行搜索并指定您希望返回零结果。

到目前为止，这是我的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-09T08:27:02.313

因此，根据我的理解，如果我需要获取分页系统中所有文档的方面计数，我需要提出两个请求（选择）：
- 第一个获取所有文档的方面计数。
- 第二个是从当前页面获取文件。

# compact-framework - Click-Once 是否可用/与 .NETCF 兼容？

> ID：212448
> 
> 赞同：5
> 
> 时间：2008-10-17T14:45:51.733
> 
> 标签：compact-framework, clickonce

我开发和管理了大约 45 台 WindowsCE5 设备。更新设备上的应用程序是一场噩梦。在 CF 上执行 Click-Once 是否可能/可行？

我认为缺乏答案是“不”。:)

**编辑**：这是[问题 116713的副本](https://stackoverflow.com/questions/116713)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T14:53:09.160

我们在这里对 CF 应用程序做了很多工作。如果您的设备具有无线功能，您可以在应用程序中构建自动更新功能而不会遇到很多麻烦。基本上，当应用程序启动时，它会检查清单文件的预定义 URL，对其进行解析以找出服务器上的 .exe 版本，并将其与设备上安装的 .exe 版本进行比较。当有更新的版本可用时，它会将其从服务器上拉下来，并将其放到设备上的正确位置。此时用户所要做的就是重新启动应用程序以获取最新版本。

我们的逻辑基于本文中的代码，并根据需要进行了修改。 [http://www.codeproject.com/KB/vb/Auto_Update_Revisited.aspx](http://www.codeproject.com/KB/vb/Auto_Update_Revisited.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T14:50:38.213

不确定，如果不是，您总是可以尝试类似[http://www.modaco.com/category/332/apptodate/](http://www.modaco.com/category/332/apptodate/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T00:57:24.357

为避免 Tim 的解决方案提供的重启，请使用您自己的自动更新程序来代替应用程序运行。

让它检查一个预定义的 url 并下载最新的，然后安装并运行它。

为了完整起见，请让应用程序检查更新的自动更新程序:)

这是我通过 50 台设备安装实现的，它正在发挥作用。

我添加了允许 sql ce 脚本作为更新的一部分运行的功能，您可以获得与在桌面上执行的大部分相同的脚本功能。（虽然没有一代）

# sharepoint - 如何通过 Web 服务添加新的 SharePoint 警报

> ID：212450
> 
> 赞同：5
> 
> 时间：2008-10-17T14:46:16.163
> 
> 标签：sharepoint, alerts

我找到了警报服务，但它似乎只有获取和删除的方法。如何添加新警报？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T15:43:44.050

经过一些更好的搜索，我发现了这个：

[http://groups.google.com/group/microsoft.public.sharepoint.portalserver/browse_thread/thread/9cf658fd6791e2b8/509ead400091f673?hl=en&lnk=st&q=add+sharepoint+alert+web+services#509ead400091f673](http://groups.google.com/group/microsoft.public.sharepoint.portalserver/browse_thread/thread/9cf658fd6791e2b8/509ead400091f673?hl=en&lnk=st&q=add+sharepoint+alert+web+services#509ead400091f673)

*AFAIK 没有可用的网络服务允许您添加或编辑警报，所以我认为您有两个选择。*

# c - 什么是总线错误？它与分段错误不同吗？

> ID：212466
> 
> 赞同：305
> 
> 时间：2008-10-17T14:48:44.083
> 
> 标签：c, unix, segmentation-fault, bus-error

“总线错误”消息是什么意思，它与[分段错误](https://en.wikipedia.org/wiki/Segmentation_fault)有何不同？

* * *

## 回答 #1

> 赞同：288
> 
> 时间：2008-10-17T15:12:09.903

总线错误现在在 x86 上很少见，并且当您的处理器甚至无法尝试请求的内存访问时发生，通常：

*   使用地址不满足对齐要求的处理器指令。

访问不属于您的进程的内存时会发生分段错误。它们很常见，通常是以下原因的结果：

*   使用指向已释放对象的指针。
*   使用未初始化的因此伪造的指针。
*   使用空指针。
*   溢出缓冲区。

PS：更准确地说，不是操纵指针本身会导致问题。它正在访问它指向的内存（取消引用）。

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2008-10-17T14:55:11.887

段错误正在访问您无权访问的内存。它是只读的，您没有权限等...

总线错误正在尝试访问不可能存在的内存。您使用了对系统没有意义的地址，或者用于该操作的地址类型错误。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2015-08-07T12:00:08.393

**`mmap`最小的 POSIX 7 示例**

当内核发送`SIGBUS`到进程时会发生“总线错误”。

`ftruncate`一个因为被遗忘而产生它的最小示例：

```
#include <fcntl.h> /* O_ constants */
#include <unistd.h> /* ftruncate */
#include <sys/mman.h> /* mmap */

int main() {
    int fd;
    int *map;
    int size = sizeof(int);
    char *name = "/a";

    shm_unlink(name);
    fd = shm_open(name, O_RDWR | O_CREAT, (mode_t)0600);
    /* THIS is the cause of the problem. */
    /*ftruncate(fd, size);*/
    map = mmap(NULL, size, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);
    /* This is what generates the SIGBUS. */
    *map = 0;
} 
```

运行：

```
gcc -std=c99 main.c -lrt
./a.out 
```

在 Ubuntu 14.04 中测试。

POSIX[描述](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/signal.h.html) `SIGBUS`为：

> 访问内存对象的未定义部分。

[mmap 规范](http://pubs.opengroup.org/onlinepubs/9699919799/functions/mmap.html#tag_16_332)说：

> 地址范围内的引用从 pa 开始并持续 len 字节到对象结束后的整个页面，将导致 SIGBUS 信号的传递。

并`shm_open` [说它](http://pubs.opengroup.org/onlinepubs/9699919799/functions/shm_open.html)生成大小为 0 的对象：

> 共享内存对象的大小为零。

因此，`*map = 0`我们正在触及分配对象的末尾。

**ARMv8 aarch64 中未对齐的堆栈内存访问**

这在：[什么是总线错误？](https://stackoverflow.com/questions/212466/what-is-a-bus-error/212519#212519)对于 SPARC，但在这里我将提供一个更具重现性的示例。

您只需要一个独立的 aarch64 程序：

```
.global _start
_start:
asm_main_after_prologue:
    /* misalign the stack out of 16-bit boundary */
    add sp, sp, #-4
    /* access the stack */
    ldr w0, [sp]

    /* exit syscall in case SIGBUS does not happen */
    mov x0, 0
    mov x8, 93
    svc 0 
```

[然后，该程序在ThunderX2 服务器机器](https://www.marvell.com/server-processors/thunderx2-arm-processors/)中的 Ubuntu 18.04 aarch64、Linux 内核 4.15.0 上引发 SIGBUS 。

不幸的是，我无法在 QEMU v4.0.0 用户模式下重现它，我不知道为什么。

错误似乎是可选的，由`SCTLR_ELx.SA`and`SCTLR_EL1.SA0`字段控制，我在[这里进一步](https://github.com/cirosantilli/linux-kernel-module-cheat/tree/79cade9e46363f30d1376046131d7988a641d1e4#armv8-aarch64-stack-alignment)总结了相关文档。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-17T14:54:54.757

> 我相信当应用程序在数据总线上出现数据错位时，内核会引发 SIGBUS。我认为，由于大多数处理器的大多数[？]现代编译器为程序员填充/对齐数据，因此（至少）过去的对齐问题得到了缓解，因此这些天人们不会经常看到 SIGBUS（AFAIK）。

来自：[这里](http://mail.nl.linux.org/kernelnewbies/2002-01/msg00064.html)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-18T17:52:10.903

在[POSIX](https://en.wikipedia.org/wiki/POSIX)系统上，当代码页由于某种原因无法分页时，您还可以获得[SIGBUS信号。](https://stackoverflow.com/questions/27615147/what-are-the-possible-reasons-for-posix-sigbus)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-10-30T16:26:01.787

我同意以上所有答案。这是我关于 BUS 错误的 2 美分：

程序代码中的指令不一定会出现 BUS 错误。当您运行二进制文件并且在执行期间，二进制文件被修改（被构建覆盖或删除等）时，可能会发生这种情况。

**验证是否是这种情况**

检查这是否是原因的一种简单方法是从构建输出目录启动相同二进制文件的几个实例，并在它们启动后运行构建。`SIGBUS`在构建完成并替换二进制文件（两个实例当前正在运行的那个）后不久，两个正在运行的实例都会因错误而崩溃。

**根本原因**

这是因为操作系统交换内存页面，在某些情况下，二进制文件可能没有完全加载到内存中。当操作系统试图从同一个二进制文件中获取下一页时，就会发生这些崩溃，但该二进制文件自上次读取后发生了变化。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-17T14:58:15.000

总线错误的一个典型实例是在某些架构上，例如[SPARC](http://en.wikipedia.org/wiki/SPARC)（至少是一些 SPARC，也许这已经改变了），就是当您执行未对齐的访问时。例如：

```
unsigned char data[6];
(unsigned int *) (data + 2) = 0xdeadf00d; 
```

此代码段尝试将 32 位整数值写入`0xdeadf00d`（很可能）未正确对齐的地址，并将在这方面“挑剔”的体系结构上生成总线错误。顺便说一下，Intel x86**不是**这样的架构。它将允许访问（尽管执行速度较慢）。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-10-08T16:07:07.880

我刚刚在 OS X 上编程 C 时遇到的总线错误的一个具体示例：

```
#include <string.h>
#include <stdio.h>

int main(void)
{
    char buffer[120];
    fgets(buffer, sizeof buffer, stdin);
    strcat("foo", buffer);
    return 0;
} 
```

如果您不记得文档`strcat`通过更改第一个参数将第二个参数附加到第一个参数（翻转参数并且它工作正常）。在 linux 上，这给出了分段错误（如预期的那样），但在 OS X 上，它给出了总线错误。为什么？我真的不知道。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-06-16T03:39:51.490

当根目录为 100% 时出现总线错误。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-17T14:52:27.383

这取决于您的操作系统、CPU、编译器以及可能的其他因素。

一般来说，这意味着 CPU 总线无法完成命令或发生冲突，但这可能意味着一系列事情，具体取决于正在运行的环境和代码。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-17T14:57:03.210

它通常意味着未对齐的访问。

尝试访问实际不存在的内存也会产生总线错误，但如果您使用带有 MMU 的处理器和没有错误的操作系统，您将不会看到这一点，因为您不会有任何非-existent 内存映射到您的进程的地址空间。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-11-19T13:56:52.620

我在 Mac OS X 上出现总线错误的原因是我试图在堆栈上分配大约 1Mb。这在一个线程中运行良好，但是在使用 openMP 时，这会导致总线错误，因为 Mac OS X[对于非主线程的堆栈大小](https://groups.google.com/a/chromium.org/forum/#!topic/chromium-reviews/DMt5bDdK7s8)非常有限。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-07-04T14:26:29.107

首先，SIGBUS 和 SIGSEGV 不是特定类型的错误，而是错误组或错误系列。这就是为什么您通常会看到信号编号 (si_no) 和信号代码 (si_code)。

它们还取决于操作系统和体系结构，以了解究竟是什么导致了它们。

一般我们可以这么说。SIGSEGV 与内存映射（权限、无映射）有关，即 mmu 错误。

SIGBUS 是指内存映射成功并且您遇到底层内存系统问题（内存不足、该位置没有内存、对齐、smmu 阻止访问等），即总线错误..

如果文件从系统中消失，例如您将文件映射到可移动媒体上并且它被拔出，则 SIGBUS 也可以与映射文件一起使用。

在平台上查看的一个好地方是 siginfo.h 标头，以了解信号子类型。例如对于 linux 这个页面提供了一个概述。 [https://elixir.bootlin.com/linux/latest/source/include/uapi/asm-generic/siginfo.h#L245](https://elixir.bootlin.com/linux/latest/source/include/uapi/asm-generic/siginfo.h#L245)

```
/*
 * SIGSEGV si_codes
 */
#define SEGV_MAPERR 1   /* address not mapped to object */
#define SEGV_ACCERR 2   /* invalid permissions for mapped object */
#define SEGV_BNDERR 3   /* failed address bound checks */
#ifdef __ia64__
# define __SEGV_PSTKOVF 4   /* paragraph stack overflow */
#else
# define SEGV_PKUERR    4   /* failed protection key checks */
#endif
#define SEGV_ACCADI 5   /* ADI not enabled for mapped object */
#define SEGV_ADIDERR    6   /* Disrupting MCD error */
#define SEGV_ADIPERR    7   /* Precise MCD exception */
#define SEGV_MTEAERR    8   /* Asynchronous ARM MTE error */
#define SEGV_MTESERR    9   /* Synchronous ARM MTE exception */
#define NSIGSEGV    9

/*
 * SIGBUS si_codes
 */
#define BUS_ADRALN  1   /* invalid address alignment */
#define BUS_ADRERR  2   /* non-existent physical address */
#define BUS_OBJERR  3   /* object specific hardware error */
/* hardware memory error consumed on a machine check: action required */
#define BUS_MCEERR_AR   4
/* hardware memory error detected in process but not consumed: action optional*/
#define BUS_MCEERR_AO   5
#define NSIGBUS     5 
```

最后要注意的是，所有信号也可以是用户生成的，例如 kill。如果它是用户生成的，那么 si_code 就是 SI_USER。所以特殊来源得到负 si_codes。

```
/*
 * si_code values
 * Digital reserves positive values for kernel-generated signals.
 */
#define SI_USER     0       /* sent by kill, sigsend, raise */
#define SI_KERNEL   0x80        /* sent by the kernel from somewhere */
#define SI_QUEUE    -1      /* sent by sigqueue */
#define SI_TIMER    -2      /* sent by timer expiration */
#define SI_MESGQ    -3      /* sent by real time mesq state change */
#define SI_ASYNCIO  -4      /* sent by AIO completion */
#define SI_SIGIO    -5      /* sent by queued SIGIO */
#define SI_TKILL    -6      /* sent by tkill system call */
#define SI_DETHREAD -7      /* sent by execve() killing subsidiary threads */
#define SI_ASYNCNL  -60     /* sent by glibc async name lookup completion */

#define SI_FROMUSER(siptr)  ((siptr)->si_code <= 0)
#define SI_FROMKERNEL(siptr)    ((siptr)->si_code > 0) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-03-16T11:38:20.097

我刚刚发现在 ARMv7 处理器上你可以编写一些代码，在未优化时给你一个分段错误，但是在使用 -O2 编译时它会给你一个总线错误（优化更多）。

我正在使用来自 Ubuntu 64 位的 GCC ARM gnueabihf 交叉编译器。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-06-21T20:57:17.057

对我来说，我没有声明我的程序集正在返回该`.text`部分，从而意外触发了“总线错误”。这似乎很明显，但它让我难倒了一段时间。

例如。

```
.globl _myGlobal # Allocate a 64-bit global with the value 2
.data
.align 3
_myGlobal:
.quad 2
.globl _main # Main function code
_main:
push %rbp 
```

从数据返回代码时缺少文本指令：

```
_myGlobal:
.quad 2
.text # <- This
.globl _main
_main: 
```

希望这最终对某人有所帮助

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-10-25T21:52:03.100

一个值得注意的原因是，如果您尝试映射不允许用户空间访问的 /dev/mem 区域，则会返回 SIGBUS。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2012-06-26T08:51:36.510

导致总线错误的典型缓冲区溢出是，

```
{
    char buf[255];
    sprintf(buf,"%s:%s\n", ifname, message);
} 
```

在这里，如果双引号 ("") 中的字符串大小大于 buf 大小，则会出现总线错误。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2014-02-06T17:41:47.237

为了补充上面 blxtd 的回答，当您的进程*无法尝试访问特定 'variable' 的内存*时，也会发生总线错误。

```
for (j = 0; i < n; j++) {
    for (i =0; i < m; i++) {
        a[n+1][j] += a[i][j];
    }
} 
```

注意第一个“for循环”中***变量“i”***的“***无意***”使用***？***这就是在这种情况下导致总线错误的原因。

 **# validation - 动作与域对象级别的 Struts2 验证

> ID：212473
> 
> 赞同：2
> 
> 时间：2008-10-17T14:49:25.440
> 
> 标签：validation, struts2

struts2 验证框架允许您为操作或在域对象级别定义验证。

我的问题是，使用一个比另一个有优势还是劣势？你有什么建议吗？

我自己的发现：您可能在多个操作中使用相同的域对象，并且可能必须重新定义每个操作的验证规则......也许将验证规则放在对象中更好。但是，在域级别放置验证规则让我感到不舒服，因为它似乎是属于操作的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T14:52:42.047

在 MVC 体系结构中，验证应该在模型级别（即域对象）完成。我认为在控制器（动作）中有验证逻辑是不合适的。

# windows - 如何让输出显示在 Visual Studio 2005 的错误列表的消息窗格中？

> ID：212481
> 
> 赞同：21
> 
> 时间：2008-10-17T14:51:23.063
> 
> 标签：windows, visual-studio, visual-c++

我有一个这样的头文件：

```
#ifndef __GEN_NOTE_MARKERS_TO_DEVELOPERS_HPP__
#define __GEN_NOTE_MARKERS_TO_DEVELOPERS_HPP__

  #ifdef _DEBUG

    // macros for turning a number into a string
    #define STRING2(x)  #x
    #define STRING(x)  STRING2(x)

    #ifdef TRIAGE_MESG_AS_WARNING
      #define TRIAGE_TODO_TAG(description)    __pragma(message(__FILE__"("STRING(__LINE__)") : warning : TRIAGE TO-DO: " STRING(description) ))
      #define TRIAGE_FIXTHIS_TAG(description) __pragma(message(__FILE__"("STRING(__LINE__)") : warning : TRIAGE FIXTHIS: " STRING(description) ))
    #else
      #define TRIAGE_TODO_TAG(description)    __pragma(message(__FILE__"("STRING(__LINE__)") : message : TRIAGE TO-DO: " STRING(description) ))
      #define TRIAGE_FIXTHIS_TAG(description) __pragma(message(__FILE__"("STRING(__LINE__)") : message : TRIAGE FIXTHIS: " STRING(description) ))
    #endif
  #else
    #define TRIAGE_TODO_TAG(description)
    #define TRIAGE_FIXTHIS_TAG(description)
  #endif

#endif // __GEN_NOTE_MARKERS_TO_DEVELOPERS_HPP__ 
```

它将注释输出到 Visual Studio 2005 中的输出窗格。定义“TRIAGE_MESG_AS_WARNING”时，Visual Studio 将收集这些消息并将它们列为错误列表中的警告。这样做是因为文本格式与警告匹配。但是，我不希望它们一直显示为警告，我希望它们显示在错误列表的消息窗格中。

> 你如何格式化你放在“输出窗口”中的行，以便 Visual Studio 会自动在“错误列表”窗口的“消息”选项卡中显示它们？

我在上面的代码中为消息设置的格式看起来像来自其他输出的消息，但不会以同样的方式获得。

一位同事向我建议，我可能需要编写一个“自定义自动化对象”来写入消息窗格。这似乎很痛苦，尤其是因为仅通过正确的格式就可以在错误窗格和警告窗格中输入条目是微不足道的。这是一条可能的途径吗？

我们使用的是非托管 C++，因此我们不能仅依赖托管 (.NET) 工具。我们不想用钩子扩展 VS。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T21:27:26.727

我相信他们只是***忘记***添加其他类别：信息。至少它没有在外部工具的输出格式中指定。

引用：“类别必须是'*错误*'或'*警告*'。大小写无关紧要。与起源一样，类别不得本地化。”

链接：http: [//blogs.msdn.com/msbuild/archive/2006/11/03/msbuild-visual-studio-aware-error-messages-and-message-formats.aspx](http://blogs.msdn.com/msbuild/archive/2006/11/03/msbuild-visual-studio-aware-error-messages-and-message-formats.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T14:48:53.770

好的，我已经四处寻找，如果您安装了 Visual Studio SDK，您似乎可以做到这一点。

[我在这里](http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/b1c37c03-f92b-46b1-83f5-7d54a1bbf5e6)找到了这个链接

我相信您需要使用 Microsoft.VisualStudio.Shell 命名空间。

来自上述链接的代码片段如下：

```
//Get the "Error List Window"

ErrorListProvider errorProvider = new ErrorListProvider(this);
Task newError = new Task();
newError.ErrorCategory = TaskErrorCategory.Error; // or TaskErrorCategory.Warning for warnings
newError.Category = TaskCategory.BuildCompile;
newError.Text = "Some Error Text";
errorProvider.Tasks.Add(newError); 
```

我还没有尝试过，所以如果你成功了，你可以在这里发回以供将来参考。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T13:10:31.313

我试图让它也能正常工作，据我所知，除非你真的为 VS 编写自己的插件来解析输出并生成任务，否则这是不可能的。这将是一个非常方便的功能，我只是希望他们在未来的某个时候添加它（我自己写一个插件不会打扰，还有太多其他的小项目正在进行以节省时间：L）

最后，我只是选择将其作为警告输出，这还不错，看看我如何尝试修复所有警告（或者如果它们是故意的，请为那一点代码和注释关闭警告如果它不明显为什么警告被忽略）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T15:38:09.617

我可能没有正确理解您的问题，但无论如何我都会试一试。

你看过 TraceSwitch 的实现吗？您可以实现不同的侦听器并将信息输出到各种来源，如文本、控制台等。

这可能是你需要的。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T21:17:29.570

您是否尝试过自定义任务列表关键字？

[此页面](http://msdn.microsoft.com/en-us/library/ekwz6akh.aspx)表明可以这样做。我建议你从那里继续阅读，以防你还没有。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-11T09:39:55.417

你不能在你的代码中使用“Trace”命令吗？这只会将您告诉它的任何文本放在“输出”窗口中。因此，为了放置错误消息，您可能需要先格式化它们。

# c++ - 如何在 VC++ 中添加用于编译的外部库？

> ID：212492
> 
> 赞同：16
> 
> 时间：2008-10-17T14:53:09.143
> 
> 标签：c++, visual-studio-2008, visual-c++, visual-studio-2005

我使用过几个 Visual C++ 编译器（VC97、VC2005、VC2008），但我还没有真正找到一种明确的方法来将外部库添加到我的构建中。我来自 Java 背景，Java 库就是一切！

我通过在我的 Linux 机器上编译开源项目了解到，似乎需要包含该库的所有源代码，但那些 .so 文件除外。

我也听说过 .lib 静态库和 .dll 动态库，但我仍然不完全确定如何将它们添加到构建中并使它们工作。怎么办？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T18:09:19.920

Libraries in C++ are also considered helpful, but the way you integrate them is different to Java because the compiler only has to see the *interface* of the library, which is usually declared in header files. In Java, the compiler will have to inspect the actual libraries because Java doesn't have this distinction between an externally visible header file and the generated object code providing the implementation.

What you normally do is build the libraries separately, once, and put the generated lib/dll files plus the header files into a place that projects requiring the library can access. A common idiom is to put the header files into `include`, the static libraries into `lib` and the dynamic libraries into `bin` subdirectories for your compiled library.

The reason you have found that most C++ libraries are provided in source code form and not in precompiled form is that every C++ compiler has a certain freedom as to how to mangle symbol names etc and the resulting object code isn't portable across compilers, let alone operating systems. So shipping the compiled code doesn't make sense for a lot of applications. You'll occasionally find it with closed-source C++ libraries on Windows (C libraries are an entirely different matter), but then the vendor will have to provide a compiled version for each and every build type (Release, Debug, 32 bit, 64 bit etc) and target compiler (various versions of Visual Studio require different binaries, then there is Borland and a bunch of other compilers) and it quickly becomes a nightmare to support...

When you take a library and build it as a dynamic library on Windows (ie, a DLL), the compiler/linker will normally generate a static 'import' library for it (same name, just with a .lib extension). When you link your project against the dynamic library, you specify the .lib file as a library dependency. Linking your application against said import library allows the linker to record the dependency on the .dll file and also which symbols it should expect the library to provide.

Making them work - in the sense of your program finding them on Windows - usually requires that the .dll file is either in the same directory as the executable or accessible via the 'PATH' environment variable and its equivalent in Visual C++.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-31T20:51:23.803

In I think you might be asking the mechanics of how to add a lib to a project/solution in the IDEs...

In 2003, 2005 and 2008 it is something similar to:

from the solution explorer - right click on the project select properties (typically last one) I usually select all configurations at the top... Linker Input

Additional dependencies go in there

I wish I could do a screen capture for this.

In VC6 it is different bear with me as this is all from memory

project settings or properties and then go to the linker tab and find where the libs can be added.

Please excuse the haphazard nature of this post. I think that is what you want though.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-17T14:56:32.820

行。通常您不想手动加载动态库，但如果您这样做，请查看 LoadLibrary。然后你必须调用其他函数来获取函数指针地址等等。通常它是如何工作的，甚至 .dll 文件都有 .lib 文件。所以当需要它们时，它们会自动加载。

您如何指定 .lib 文件/静态库位于 Properties/Linker/Input->Additional Dependencies 下。在 gui 中。

如果您正在编写脚本……好吧。您只需在链接时在命令行上指定 .lib 文件。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-08-14T10:09:29.773

For adding libraries, this is very simple (if that's what you mean) Project -> properties -> configure properties -> Linker -> Input -> additional libraries. Go stand on one of the libraries in there and press enter. You freed up a space to add a library, eay as pie :)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-20T03:08:36.977

For adding external libraries or library directories in a VC++ project follow these steps:
1- Go to your project properties (that can be done by right clicking on the project in your solution)
2- Select 'Linker' > 'General' > Additional Library Directories
3- Click on the empty bar in front of 'Additional Library Directories' and VS allows you to add directories to its default ones into which it searches for the required libraries.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T14:58:16.793

您是什么意思“将它们添加到构建中”？

在 VC 中，在一个解决方案中，您可以有一个项目，其输出是一个库（静态或动态），然后另一个项目依赖于输出并使用它（即，链接到它）。

在我们的代码库中，我们通常为每个库或一组库提供单独的解决方案，然后将它们链接到目标项目中。我们的大多数目标项目都是托管程序集——那些需要非托管功能的项目通常用托管 C++ 或 C++/CLI 编写，并链接到非托管静态库中。我们发现这是最容易维护的，因为非托管库更改最少。

# asp.net - 有没有办法让 App_Data 中的文件在发布时不会覆盖较新的文件？

> ID：212494
> 
> 赞同：2
> 
> 时间：2008-10-17T14:53:12.500
> 
> 标签：asp.net, deployment, application-data

我将 App_Data 中的 XML 文件与 Intranet 应用程序主页上的中继器结合使用，允许我在用户登录时向用户显示有关应用程序状态、维护等的消息。为了测试功能，最好有开发中的 App_Data 文件夹中的文件，但是如果我这样做，它会在我发布应用程序时将其复制到生产服务器上的文件中。无论如何我可以防止这种情况发生，而不是去一个 Web 部署项目（这会解决我的问题）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T15:04:36.390

在 Visual Studio 2005 中，我看到一个标有“包括 App_Data 文件夹中的文件”的复选框，默认为选中状态。您是否尝试过在未选中该复选框的情况下发布？

**编辑：**看到该复选框对您的项目不可用，我会考虑使用 Visual Studio 的[VS2005 Web 部署插件](http://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx)。我自己没有使用过它，但是在调试和发布模式之间自定义发布的功能看起来很有希望。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T15:04:54.003

为了避免这个问题，我还将部署到本地“暂存”位置，本质上是我桌面上的一个文件夹。一旦文件被 Visual Studio 编译并部署到那里，我将删除我不感兴趣的文件（在您的情况下为 App_Data），然后使用 XCopy 或使用 Windows 资源管理器将文件复制到 Web 服务器。

除了类似的东西，我知道没有办法让 Visual Studio 本身在部署时省略这些文件/文件夹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T00:57:06.870

另一种方法是拥有一个“调试”文件和一个“生产”文件。

```
Stream xml;
#if DEBUG
xml = File.Open("debug.xml");
#else
xml = File.Open("release.xml");
#endif 
```

在 DEBUG 模式下编译将使用调试文件，在发布模式下编译将使用发布文件。

# c# - 将密码保存到注册表时加密密码的最简单方法是什么？

> ID：212510
> 
> 赞同：63
> 
> 时间：2008-10-17T14:55:48.093
> 
> 标签：c#, encryption, passwords

目前我正在用明文写它*哎呀！*，这是一个内部程序，所以它不是那么糟糕，但我想把它做好。在写入注册表时我应该如何加密它以及如何解密它？

```
OurKey.SetValue("Password", textBoxPassword.Text); 
```

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2008-10-17T15:00:18.303

# 您不解密身份验证密码！

使用诸如 SHA256 提供程序之类的东西对它们进行哈希处理，当您必须挑战时，对来自用户的输入进行哈希处理并查看两个哈希值是否匹配。

```
byte[] data = System.Text.Encoding.ASCII.GetBytes(inputString);
data = new System.Security.Cryptography.SHA256Managed().ComputeHash(data);
String hash = System.Text.Encoding.ASCII.GetString(data); 
```

让密码可逆是一个*非常*可怕的模型。

Edit2：我以为我们只是在谈论前线身份验证。当然，在某些情况下，您想为其他需要可逆的东西加密密码，但最重要的是应该有一个单向锁（只有极少数例外）。

我已经升级了散列算法，但为了获得最佳强度，您希望保留一个私有盐并在[散列](https://stackoverflow.com/q/2138429/12870)[*之前*](https://stackoverflow.com/q/2138429/12870)[将其添加到您的输入](https://stackoverflow.com/q/2138429/12870)*中。当你比较时，你会再次这样做。这增加了另一层，使某人更难逆转。*

 ** * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-17T15:13:10.087

还请考虑“加盐”你的哈希（不是烹饪概念！）。基本上，这意味着在对密码进行散列之前将一些随机文本附加到密码中。

"[如果您的凭证存储受到威胁，盐值有助于减缓攻击者执行字典攻击的速度，从而为您提供额外的时间来检测和应对威胁。](http://msdn.microsoft.com/en-us/library/ms998372.aspx) "

要存储密码哈希：

a) 生成随机盐值：

```
byte[] salt = new byte[32];
System.Security.Cryptography.RNGCryptoServiceProvider.Create().GetBytes(salt); 
```

b) 将盐附加到密码中。

```
// Convert the plain string pwd into bytes
byte[] plainTextBytes = System.Text UnicodeEncoding.Unicode.GetBytes(plainText);
// Append salt to pwd before hashing
byte[] combinedBytes = new byte[plainTextBytes.Length + salt.Length];
System.Buffer.BlockCopy(plainTextBytes, 0, combinedBytes, 0, plainTextBytes.Length);
System.Buffer.BlockCopy(salt, 0, combinedBytes, plainTextBytes.Length, salt.Length); 
```

c）散列组合的密码和盐：

```
// Create hash for the pwd+salt
System.Security.Cryptography.HashAlgorithm hashAlgo = new System.Security.Cryptography.SHA256Managed();
byte[] hash = hashAlgo.ComputeHash(combinedBytes); 
```

d) 将盐添加到生成的哈希中。

```
// Append the salt to the hash
byte[] hashPlusSalt = new byte[hash.Length + salt.Length];
System.Buffer.BlockCopy(hash, 0, hashPlusSalt, 0, hash.Length);
System.Buffer.BlockCopy(salt, 0, hashPlusSalt, hash.Length, salt.Length); 
```

e) 将结果存储在您的用户存储数据库中。

这种方法意味着您不需要单独存储盐，然后使用盐值和从用户获得的明文密码值重新计算哈希。

**编辑**：随着原始计算能力变得更便宜和更快，散列的价值 - 或盐渍散列 - 已经下降。[Jeff Atwood 有一个出色的 2012 年更新](http://www.codinghorror.com/blog/2012/04/speed-hashing.html)，太长了，无法在此完整重复，其中指出：

> 这（使用加盐哈希）将提供比任何实际安全更多的安全假象。由于您需要盐和散列算法的选择来生成散列并检查散列，因此攻击者不太可能有一个而没有另一个。如果您已经被入侵到攻击者拥有您的密码数据库的程度，那么可以合理地假设他们拥有或可以获得您的秘密隐藏盐。
> 
> 安全的第一条规则是始终为最坏的情况做假设和计划。您是否应该使用盐，最好是为每个用户使用随机盐？当然，这绝对是一种很好的做法，至少它可以让您消除两个具有相同密码的用户的歧义。但是现在，单靠盐已经不能让你从愿意花几千美元购买显卡硬件的人手中拯救你了，如果你认为他们可以，那你就有麻烦了。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-10-23T21:38:40.050

Tom Scott 在Computerphile 上关于如何（不）存储密码的报道中是正确的。

[https://www.youtube.com/watch?v=8ZtInClXe1Q](https://www.youtube.com/watch?v=8ZtInClXe1Q)

1.  **如果您可以完全避免它，请不要尝试自己存储密码。**改为使用单独的、预先建立的、值得信赖的用户身份验证平台（例如：OAuth 提供商、您公司的 Active Directory 域等）。

2.  **如果您必须存储密码，请不要遵循此处的任何指导。**至少，不要不咨询适用于您选择的语言的最新且知名的出版物。

这里肯定有很多聪明人，甚至可能给出了一些好的指导。但是很有可能，当您阅读本文时，这里的所有答案（包括这个答案）都已经过时了。

* * *

## 存储密码的正确方式会随着时间而改变。

## ***可能比某些人更频繁地更换内衣。***

* * *

说了这么多，这里有一些一般性的指导，希望在一段时间内仍然有用。

1.  ***不要加密密码。***任何允许恢复存储数据的存储方法对于保存密码来说都是不安全的——包括所有形式的加密。
2.  ***完全按照用户在创建过程中输入的密码进行处理。***在将密码发送到加密模块之前对密码所做的任何事情都可能会削弱它。执行以下任何操作也只会增加密码存储和验证过程的复杂性，这可能会导致其他问题（甚至可能引入漏洞）。

    *   不要转换为全大写/全小写。
    *   不要删除空格。
    *   不要剥离不可接受的字符或字符串。
    *   不要更改文本编码。
    *   不要进行任何字符或字符串替换。
    *   不要截断任何长度的密码。
3.  ***拒绝创建任何未经修改就无法存储的密码。***加强上述。如果由于某种原因您的密码存储机制无法正确处理某些字符、空格、字符串或密码长度，则返回错误并让用户了解系统的限制，以便他们可以使用适合它们的密码重试。为了获得更好的用户体验，请预先列出用户可以访问的这些限制。甚至不用担心，更不用说麻烦，向攻击者隐藏列表 - 无论如何，他们自己会很容易地弄清楚。

4.  ***为每个帐户使用一个长的、随机的、唯一的盐。***任何两个帐户的密码在存储中都不应该看起来相同，即使密码实际上是相同的。
5.  ***使用专为与密码一起使用而设计的慢速且加密强度高的散列算法。***MD5肯定出来了。SHA-1/SHA-2 是不行的。但我也不会告诉你*应该*在这里使用什么。（请参阅这篇文章中的第一个 #2 项目符号。）
6.  ***尽可能多地迭代。***虽然您的系统可能比整天使用哈希密码更能处理其处理器周期，但破解您密码的人的系统却没有。尽可能对他们施加压力，而不是对你“太苛刻”。

* * *

最重要的是...

## 不要只听这里的任何人。

去查找有关您选择的语言的正确密码存储方法的著名且最近的出版物。实际上，在您确定一种方法之前，您应该从多个不同的来源找到多个最近的出版物，这些出版物是一致的。

极有可能这里的每个人（包括我自己）所说的一切都已经被更好的技术所取代，或者被新开发的攻击方法变得不安全。去寻找更可能不是的东西。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-11-07T14:31:40.667

这就是你想要做的：

```
OurKey.SetValue("Password", StringEncryptor.EncryptString(textBoxPassword.Text));
OurKey.GetValue("Password", StringEncryptor.DecryptString(textBoxPassword.Text)); 
```

您可以使用以下课程来做到这一点。这个类是一个泛型类，是客户端端点。[它使用Ninject](http://ninject.org)启用各种加密算法的 IOC 。

```
public class StringEncryptor
{
    private static IKernel _kernel;

    static StringEncryptor()
    {
        _kernel = new StandardKernel(new EncryptionModule());
    }

    public static string EncryptString(string plainText)
    {
        return _kernel.Get<IStringEncryptor>().EncryptString(plainText);
    }

    public static string DecryptString(string encryptedText)
    {
        return _kernel.Get<IStringEncryptor>().DecryptString(encryptedText);
    }
} 
```

下一个类是允许您注入各种算法的 ninject 类：

```
public class EncryptionModule : StandardModule
{
    public override void Load()
    {
        Bind<IStringEncryptor>().To<TripleDESStringEncryptor>();
    }
} 
```

这是任何算法都需要实现加密/解密字符串的接口：

```
public interface IStringEncryptor
{
    string EncryptString(string plainText);
    string DecryptString(string encryptedText);
} 
```

这是使用 TripleDES 算法的实现：

```
public class TripleDESStringEncryptor : IStringEncryptor
{
    private byte[] _key;
    private byte[] _iv;
    private TripleDESCryptoServiceProvider _provider;

    public TripleDESStringEncryptor()
    {
        _key = System.Text.ASCIIEncoding.ASCII.GetBytes("GSYAHAGCBDUUADIADKOPAAAW");
        _iv = System.Text.ASCIIEncoding.ASCII.GetBytes("USAZBGAW");
        _provider = new TripleDESCryptoServiceProvider();
    }

    #region IStringEncryptor Members

    public string EncryptString(string plainText)
    {
        return Transform(plainText, _provider.CreateEncryptor(_key, _iv));
    }

    public string DecryptString(string encryptedText)
    {
        return Transform(encryptedText, _provider.CreateDecryptor(_key, _iv));
    }

    #endregion

    private string Transform(string text, ICryptoTransform transform)
    {
        if (text == null)
        {
            return null;
        }
        using (MemoryStream stream = new MemoryStream())
        {
            using (CryptoStream cryptoStream = new CryptoStream(stream, transform, CryptoStreamMode.Write))
            {
                byte[] input = Encoding.Default.GetBytes(text);
                cryptoStream.Write(input, 0, input.Length);
                cryptoStream.FlushFinalBlock();

                return Encoding.Default.GetString(stream.ToArray());
            }
        }
    }
} 
```

您可以在以下网址观看我的视频并下载代码：[http ://www.wrightin.gs/2008/11/how-to-encryptdecrypt-sensitive-column-contents-in-nhibernateactive-record-video.html](http://www.wrightin.gs/2008/11/how-to-encryptdecrypt-sensitive-column-contents-in-nhibernateactive-record-video.html)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-17T14:59:43.467

一种选择是存储密码的散列（SHA1、MD5）而不是明文密码，每当您想查看密码是否正确时，只需将其与该散列进行比较即可。

如果您需要安全存储（例如用于连接服务的密码），那么问题就更复杂了。

如果只是用于身份验证，那么使用哈希就足够了。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-17T15:02:23.353

如果您希望能够解密密码，我认为最简单的方法是使用 DPAPI（用户存储模式）来加密/解密。这样您就不必摆弄加密密钥，将它们存储在某个地方或将它们硬编码到您的代码中——在这两种情况下，有人可以通过查看注册表、用户设置或使用 Reflector 来发现它们。

否则，像其他人在这里所说的那样使用哈希 SHA1 或 MD5。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-23T17:04:57.070

就像 ligget78 所说，DPAPI 将是存储密码的好方法。[查看 MSDN 上的 ProtectedData 类以](http://msdn.microsoft.com/en-us/library/system.security.cryptography.protecteddata.aspx)了解示例用法。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-05-27T20:20:15.873

我到处寻找加密和解密过程的一个很好的例子，但大多数都过于复杂。

无论如何，有人可能想要解密某些文本值（包括密码）的原因有很多。我需要在我目前正在处理的网站上解密密码的原因是因为他们想确保当有人在密码过期时被迫更改密码时，我们不会让他们使用相同密码的紧密变体来更改密码他们在过去的 x 个月内使用过。

因此，我编写了一个流程，以简化的方式执行此操作。我希望这段代码对某人有益。据我所知，我可能最终会在另一个时间为不同的公司/站点使用它。

```
public string GenerateAPassKey(string passphrase)
    {
        // Pass Phrase can be any string
        string passPhrase = passphrase;
        // Salt Value can be any string(for simplicity use the same value as used for the pass phrase)
        string saltValue = passphrase;
        // Hash Algorithm can be "SHA1 or MD5"
        string hashAlgorithm = "SHA1";
        // Password Iterations can be any number
        int passwordIterations = 2;
        // Key Size can be 128,192 or 256
        int keySize = 256;
        // Convert Salt passphrase string to a Byte Array
        byte[] saltValueBytes = Encoding.ASCII.GetBytes(saltValue);
        // Using System.Security.Cryptography.PasswordDeriveBytes to create the Key
        PasswordDeriveBytes pdb = new PasswordDeriveBytes(passPhrase, saltValueBytes, hashAlgorithm, passwordIterations);
        //When creating a Key Byte array from the base64 string the Key must have 32 dimensions.
        byte[] Key = pdb.GetBytes(keySize / 11);
        String KeyString = Convert.ToBase64String(Key);

        return KeyString;
    }

 //Save the keystring some place like your database and use it to decrypt and encrypt
//any text string or text file etc. Make sure you dont lose it though.

 private static string Encrypt(string plainStr, string KeyString)        
    {            
        RijndaelManaged aesEncryption = new RijndaelManaged();
        aesEncryption.KeySize = 256;
        aesEncryption.BlockSize = 128;
        aesEncryption.Mode = CipherMode.ECB;
        aesEncryption.Padding = PaddingMode.ISO10126;
        byte[] KeyInBytes = Encoding.UTF8.GetBytes(KeyString);
        aesEncryption.Key = KeyInBytes;
        byte[] plainText = ASCIIEncoding.UTF8.GetBytes(plainStr);
        ICryptoTransform crypto = aesEncryption.CreateEncryptor();
        byte[] cipherText = crypto.TransformFinalBlock(plainText, 0, plainText.Length);
        return Convert.ToBase64String(cipherText);
    }

 private static string Decrypt(string encryptedText, string KeyString) 
    {
        RijndaelManaged aesEncryption = new RijndaelManaged(); 
        aesEncryption.KeySize = 256;
        aesEncryption.BlockSize = 128; 
        aesEncryption.Mode = CipherMode.ECB;
        aesEncryption.Padding = PaddingMode.ISO10126;
        byte[] KeyInBytes = Encoding.UTF8.GetBytes(KeyString);
        aesEncryption.Key = KeyInBytes;
        ICryptoTransform decrypto = aesEncryption.CreateDecryptor(); 
        byte[] encryptedBytes = Convert.FromBase64CharArray(encryptedText.ToCharArray(), 0, encryptedText.Length); 
        return ASCIIEncoding.UTF8.GetString(decrypto.TransformFinalBlock(encryptedBytes, 0, encryptedBytes.Length)); 
    }

 String KeyString = GenerateAPassKey("PassKey");
 String EncryptedPassword = Encrypt("25Characterlengthpassword!", KeyString);
 String DecryptedPassword = Decrypt(EncryptedPassword, KeyString); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-17T17:21:49.330

如果它是您的应用程序用于身份验证的密码，则按照其他人的建议对密码进行哈希处理。

如果您要存储外部资源的密码，您通常希望能够提示用户输入这些凭据并让他有机会安全地保存它们。Windows 为此提供了 Credentials UI (CredUI) - 有许多示例展示了如何在 .NET 中使用它，包括[MSDN 上的这个](http://msdn.microsoft.com/en-us/library/aa302353.aspx)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-17T15:02:36.520

..NET 在 System.Security.Cryptography 命名空间中包含的类中提供加密服务。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-17T15:06:47.323

如果您需要更多，例如保护连接字符串（用于连接到数据库），请查看这篇[文章](http://msdn.microsoft.com/en-us/library/89211k9b(VS.80).aspx)，因为它为此提供了最佳“选项”。

Oli 的回答也很好，因为它展示了如何为字符串创建散列。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-10-17T15:01:09.690

您应该通过散列算法 md5/sha512 或类似算法传递密码，而不是加密/解密。理想情况下你会做的是散列密码并存储散列，然后当需要密码时，你散列​​条目并比较条目。密码将永远不会被“解密”，只是简单地散列然后比较。

# c++ - 如何获取（Linux）机器的 IP 地址？

> ID：212528
> 
> 赞同：98
> 
> 时间：2008-10-17T15:00:45.917
> 
> 标签：c++, linux, networking, ip-address

这个问题与之前问的几乎相同，[我如何获取本地计算机的 IP 地址？](https://stackoverflow.com/questions/122208/get-the-ip-address-of-local-computer)-问题。但是我需要找到**Linux Machine**的 IP 地址。

所以：我如何 - 在**C++**中以编程方式 - 检测我的应用程序正在运行的 linux 服务器的 IP 地址。服务器将至少有两个 IP 地址，我需要一个特定的 IP 地址（给定网络中的一个（公共网络））。

我确信有一个简单的功能可以做到这一点 - 但在哪里？

* * *

为了让事情更清楚一点：

*   服务器显然会有“localhost”：127.0.0.1
*   服务器将有一个内部（管理）IP 地址：172.16.xx
*   服务器将有一个外部（公共）IP 地址：80.190.xx

我需要找到外部 IP 地址来将我的应用程序绑定到它。显然我也可以绑定到 INADDR_ANY （实际上这就是我现在所做的）。不过，我更愿意检测公共地址。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-11-05T17:34:43.260

I found the ioctl solution problematic on os x (which is POSIX compliant so should be similiar to linux). However getifaddress() will let you do the same thing easily, it works fine for me on os x 10.5 and should be the same below.

I've done a quick example below which will print all of the machine's IPv4 address, (you should also check the getifaddrs was successful ie returns 0).

I've updated it show IPv6 addresses too.

```
#include <stdio.h>      
#include <sys/types.h>
#include <ifaddrs.h>
#include <netinet/in.h> 
#include <string.h> 
#include <arpa/inet.h>

int main (int argc, const char * argv[]) {
    struct ifaddrs * ifAddrStruct=NULL;
    struct ifaddrs * ifa=NULL;
    void * tmpAddrPtr=NULL;

    getifaddrs(&ifAddrStruct);

    for (ifa = ifAddrStruct; ifa != NULL; ifa = ifa->ifa_next) {
        if (!ifa->ifa_addr) {
            continue;
        }
        if (ifa->ifa_addr->sa_family == AF_INET) { // check it is IP4
            // is a valid IP4 Address
            tmpAddrPtr=&((struct sockaddr_in *)ifa->ifa_addr)->sin_addr;
            char addressBuffer[INET_ADDRSTRLEN];
            inet_ntop(AF_INET, tmpAddrPtr, addressBuffer, INET_ADDRSTRLEN);
            printf("%s IP Address %s\n", ifa->ifa_name, addressBuffer); 
        } else if (ifa->ifa_addr->sa_family == AF_INET6) { // check it is IP6
            // is a valid IP6 Address
            tmpAddrPtr=&((struct sockaddr_in6 *)ifa->ifa_addr)->sin6_addr;
            char addressBuffer[INET6_ADDRSTRLEN];
            inet_ntop(AF_INET6, tmpAddrPtr, addressBuffer, INET6_ADDRSTRLEN);
            printf("%s IP Address %s\n", ifa->ifa_name, addressBuffer); 
        } 
    }
    if (ifAddrStruct!=NULL) freeifaddrs(ifAddrStruct);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-10-17T15:38:32.267

1.  创建一个套接字。
2.  履行`ioctl(<socketfd>, SIOCGIFCONF, (struct ifconf)&buffer);`

阅读`/usr/include/linux/if.h`有关`ifconf`和`ifreq`结构的信息。这应该为您提供系统上每个接口的 IP 地址。另请阅读`/usr/include/linux/sockios.h`其他 ioctl。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2010-06-25T18:15:55.927

我喜欢[jjvainio 的回答](https://stackoverflow.com/questions/212528/linux-c-get-the-ip-address-of-local-computer/215333#215333)。正如 Zan Lnyx 所说，它使用本地路由表来查找将用于连接到特定外部主机的以太网接口的 IP 地址。通过使用连接的 UDP 套接字，您无需实际发送任何数据包即可获取信息。该方法要求您选择特定的外部主机。大多数时候，任何知名的公共 IP 都可以解决问题。为此，我喜欢 Google 的公共 DNS 服务器地址 8.8.8.8，但有时您可能想要选择不同的外部主机 IP。这是一些说明完整方法的代码。

```
void GetPrimaryIp(char* buffer, size_t buflen) 
{
    assert(buflen >= 16);

    int sock = socket(AF_INET, SOCK_DGRAM, 0);
    assert(sock != -1);

    const char* kGoogleDnsIp = "8.8.8.8";
    uint16_t kDnsPort = 53;
    struct sockaddr_in serv;
    memset(&serv, 0, sizeof(serv));
    serv.sin_family = AF_INET;
    serv.sin_addr.s_addr = inet_addr(kGoogleDnsIp);
    serv.sin_port = htons(kDnsPort);

    int err = connect(sock, (const sockaddr*) &serv, sizeof(serv));
    assert(err != -1);

    sockaddr_in name;
    socklen_t namelen = sizeof(name);
    err = getsockname(sock, (sockaddr*) &name, &namelen);
    assert(err != -1);

    const char* p = inet_ntop(AF_INET, &name.sin_addr, buffer, buflen);
    assert(p);

    close(sock);
} 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-10-18T17:51:42.150

正如您所发现的，没有单一的“本地 IP 地址”这样的东西。以下是如何找出可以发送到特定主机的本地地址。

1.  创建一个 UDP 套接字
2.  将套接字连接到外部地址（最终将接收本地地址的主机）
3.  使用getsockname获取本地地址

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-05-18T13:23:50.557

这样做的好处是可以处理多种风格的 unix ...并且您可以对其进行简单的修改以在任何 o/s 上工作。上述所有解决方案都会根据月相给我编译器错误。有一种很好的 POSIX 方法可以做到这一点......不要使用它（在编写本文时，情况并非如此）。

```
// ifconfig | perl -ne 'print "$1\n" if /inet addr:([\d.]+)/'

#include <stdlib.h>

int main() {
        setenv("LANG","C",1);
        FILE * fp = popen("ifconfig", "r");
        if (fp) {
                char *p=NULL, *e; size_t n;
                while ((getline(&p, &n, fp) > 0) && p) {
                   if (p = strstr(p, "inet ")) {
                        p+=5;
                        if (p = strchr(p, ':')) {
                            ++p;
                            if (e = strchr(p, ' ')) {
                                 *e='\0';
                                 printf("%s\n", p);
                            }
                        }
                   }
              }
        }
        pclose(fp);
        return 0;
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-11-23T13:28:50.353

我认为您的问题没有明确的正确答案。相反，有很多方法可以接近你想要的。因此，我将提供一些提示如何完成它。

如果一台机器有超过 2 个接口（`lo`算作一个），您将无法轻松地自动检测正确的接口。这里有一些关于如何做到这一点的食谱。

例如，问题是，如果主机位于 NAT 防火墙后面的 DMZ 中，它将公共 IP 更改为某个私有 IP 并转发请求。你的机器可能有10个接口，但只有一个对应公共的。

如果您在双 NAT 上，即使自动检测也不起作用，您的防火墙甚至会将源 IP 转换为完全不同的东西。因此，您甚至无法确定默认路由是否通向您的具有公共接口的接口。

# 通过默认路由检测

> 这是我推荐的自动检测事物的方法

通常`ip r get 1.1.1.1`会告诉您具有默认路由的接口。

如果你想用你最喜欢的脚本/编程语言重新创建它，请使用`strace ip r get 1.1.1.1`并遵循黄砖路。

# 设置它`/etc/hosts`

> 如果您想保持控制，这是我的建议

`/etc/hosts`您可以在like中创建一个条目

```
80.190.1.3 publicinterfaceip 
```

然后你可以使用这个别名`publicinterfaceip`来引用你的公共接口。

> 可悲的是`haproxy`没有用 IPv6 理解这个技巧

# 使用环境

> 这是一个很好的解决方法`/etc/hosts`，以防万一你不是`root`

与 相同`/etc/hosts`。但为此使用环境。您可以尝试`/etc/profile`或`~/.profile`为此。

因此，如果您的程序需要一个变量`MYPUBLICIP`，那么您可以包含如下代码（这是 C，请随意从中创建 C++）：

```
#define MYPUBLICIPENVVAR "MYPUBLICIP"

const char *mypublicip = getenv(MYPUBLICIPENVVAR);

if (!mypublicip) { fprintf(stderr, "please set environment variable %s\n", MYPUBLICIPENVVAR); exit(3); } 
```

`/path/to/your/script`所以你可以像这样调用你的脚本/程序

`MYPUBLICIP=80.190.1.3 /path/to/your/script`

这甚至适用于`crontab`.

# 枚举所有接口并消除那些你不想要的

> 如果你不能使用的绝望方式`ip`

如果您确实知道您不想要什么，您可以枚举所有接口并忽略所有错误的接口。

对于这种方法，这似乎已经是一个答案[https://stackoverflow.com/a/265978/490291 。](https://stackoverflow.com/a/265978/490291)

# 像 DLNA 一样做

> 醉汉试图在酒精中淹死自己的方式

您可以尝试枚举网络上的所有 UPnP 网关，这样可以为某些“外部”事物找到正确的路由。这甚至可能在您的默认路由未指向的路由上。

有关这方面的更多信息，请参阅[https://en.wikipedia.org/wiki/Internet_Gateway_Device_Protocol](https://en.wikipedia.org/wiki/Internet_Gateway_Device_Protocol)

即使您的默认路由指向其他地方，这也会给您留下一个好印象，哪个是您真正的公共接口。

# 还有更多

> 山与先知相遇的地方

IPv6 路由器会宣传自己，为您提供正确的 IPv6 前缀。查看前缀可以提示您它是否具有一些内部 IP 或全局 IP。

您可以侦听 IGMP 或 IBGP 帧以找出一些合适的网关。

IP 地址少于 2^32 个。因此，在 LAN 上 ping 它们并不需要很长时间。从您的角度来看，这为您提供了有关 Internet 大部分位置的统计提示。但是，您应该比著​​名的[https://de.wikipedia.org/wiki/SQL_Slammer更明智一些](https://de.wikipedia.org/wiki/SQL_Slammer)

ICMP 甚至 ARP 都是很好的网络边带信息来源。它也可能对您有所帮助。

您可以使用以太网广播地址联系您的所有网络基础设施设备，这通常会有所帮助，例如 DHCP（甚至 DHCPv6）等。

这个额外的列表可能是无穷无尽的，而且总是不完整的，因为每个网络设备制造商都在忙于发明如何自动检测他们自己的设备的新安全漏洞。这通常有助于如何检测一些不应该存在的公共接口。

'纳夫说。出去。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-18T09:24:50.727

Further to what Steve Baker has said, you can find a description of the SIOCGIFCONF ioctl in the [netdevice(7) man page](http://linux.die.net/man/7/netdevice).

Once you have the list of all the IP addresses on the host, you will have to use application specific logic to filter out the addresses you do not want and hope you have one IP address left.

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-07-12T04:41:54.603

不要硬编码：这是可以改变的事情。许多程序通过读入配置文件并执行任何操作来确定要绑定的内容。这样，如果您的程序将来某个时候需要绑定到不是公共 IP 的东西，它可以这样做。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-06-27T22:00:28.690

由于问题指定了 Linux，我最喜欢的发现机器 IP 地址的技术是使用 netlink。通过创建协议 NETLINK_ROUTE 的 netlink 套接字并发送 RTM_GETADDR，您的应用程序将收到包含所有可用 IP 地址的消息。[此处](http://linux-hacks.blogspot.no/2009/01/sample-code-to-learn-netlink.html)提供了一个示例。

为了简单地处理部分消息，libmnl 很方便。如果您想了解更多关于 NETLINK_ROUTE 的不同选项（以及如何解析它们）的信息，最好的来源是 iproute2 的[源代码](http://www.linuxfoundation.org/collaborate/workgroups/networking/iproute2)（尤其是监控应用程序）以及内核中的接收函数。[rtnetlink](http://linux.die.net/man/7/rtnetlink)的手册页也包含有用的信息。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-03-04T01:47:44.773

你只玩`stdio.h`头球怎么样？（不涉及网络标头）

这是完整的 C++ 代码：

（这是本地 IP；例如，如果您使用家庭调制解调器）

```
#include <stdio.h>
int main()
{
    static char ip[32];
    FILE *f = popen("ip a | grep 'scope global' | grep -v ':' | awk '{print $2}' | cut -d '/' -f1", "r");
    int c, i = 0;
    while ((c = getc(f)) != EOF) i += sprintf(ip+i, "%c", c);
    pclose(f);
    printf(ip);
} 
```

*   奖励：您也可以通过它的 NDK C++ 编译器为 Android 交叉编译它

*   只是说：我有一个运行它的 VPS，它获取**外部 IP**

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-17T18:13:55.447

您可以与 curl 进行一些集成，就像这样简单：`curl www.whatismyip.org`从 shell 中获取您的全局 IP。你有点依赖一些外部服务器，但如果你在 NAT 后面，你将永远如此。

* * *

## 回答 #12

> 赞同：-12
> 
> 时间：2011-03-27T22:03:06.710

```
// Use a HTTP request to a well known server that echo's back the public IP address
void GetPublicIP(CString & csIP)
{
    // Initialize COM
    bool bInit = false;
    if (SUCCEEDED(CoInitialize(NULL)))
    {
        // COM was initialized
        bInit = true;

        // Create a HTTP request object
        MSXML2::IXMLHTTPRequestPtr HTTPRequest;
        HRESULT hr = HTTPRequest.CreateInstance("MSXML2.XMLHTTP");
        if (SUCCEEDED(hr))
        {
            // Build a request to a web site that returns the public IP address
            VARIANT Async;
            Async.vt = VT_BOOL;
            Async.boolVal = VARIANT_FALSE;
            CComBSTR ccbRequest = L"http://whatismyipaddress.com/";

            // Open the request
            if (SUCCEEDED(HTTPRequest->raw_open(L"GET",ccbRequest,Async)))
            {
                // Send the request
                if (SUCCEEDED(HTTPRequest->raw_send()))
                {
                    // Get the response
                    CString csRequest = HTTPRequest->GetresponseText();

                    // Parse the IP address
                    CString csMarker = "<!-- contact us before using a script to get your IP address -->";
                    int iPos = csRequest.Find(csMarker);
                    if (iPos == -1)
                        return;
                    iPos += csMarker.GetLength();
                    int iPos2 = csRequest.Find(csMarker,iPos);
                    if (iPos2 == -1)
                        return;

                    // Build the IP address
                    int nCount = iPos2 - iPos;
                    csIP = csRequest.Mid(iPos,nCount);
                }
            }
        }
    }

    // Unitialize COM
    if (bInit)
        CoUninitialize();
} 
```

# .net - 构建 Silverlight 应用程序的最佳参考是什么？

> ID：212532
> 
> 赞同：2
> 
> 时间：2008-10-17T15:01:42.747
> 
> 标签：.net, silverlight, reference

我很好奇是否可以推荐任何文本来实际讨论有关在 Web 应用程序中使用 Silverlight 的应用程序架构最佳实践。ASP.Net 会更好，但我也愿意考虑其他技术。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T17:29:10.000

我个人还没有看到任何讨论这个问题的最佳实践指南，但是我可以自己提出一些建议，但这取决于正在开发的应用程序的类型。

到目前为止，Silverlight 的典型用途一直是富媒体，从这个角度来看，网站的架构几乎没有相关性。

然而，对于业务线应用程序，Silverlight 2 公开了一些有趣的解决方案。我们刚刚完成了一个相当大的产品开发，该产品基于 Silverlight 2 作为客户端应用程序，调用 WCF 3.5 SOAP 服务，托管在使用标准 Membership Provider 和 WCF 安全管道等的 ASP.NET 3.5 Web 应用程序中，并建立在SQL Server 2005 的顶部。

在改进架构方面，我们计划做以下事情：

*   将 SOAP 替换为 REST。
*   使用 PostSharp 引入服务器端数据缓存。
*   在 Silverlight 客户端应用程序中使用 PostSharp 拦截数据服务调用以进行客户端缓存。

我希望这有帮助。如果您想进一步讨论任何事情，请随时联系我。您可以在我的博客 ( [http://craign.net/](http://craign.net/) ) 上与我联系。

# asp.net - 通过 CSS 重置 HTML 元素的高度

> ID：212534
> 
> 赞同：22
> 
> 时间：2008-10-17T15:02:23.213
> 
> 标签：asp.net, html, css

我使用一个定制的 asp.net 控件，该控件呈现为一个 DIV，并且将“height='0'”硬编码到元素中（我知道......愚蠢）。但我需要重置它 - 以某种方式摆脱高度分配。这对 CSS 可行吗？

例如，我可以将高度设置为 100px，它可以工作。但这不是我想要的——我希望高度分配几乎被删除。

更新：使用 FireBug，我可以看到 CSS 的高度被硬编码的高度覆盖：

*删除了无效的 ImageShack 链接*

我想除了删除硬编码的 height=0 之外，我没有办法解决这个问题。还有人看到替代品吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-10-17T15:24:51.110

您可能需要使用`height:auto !important`，因为 height 属性具有非常高的优先级 (IIRC)。

但理想情况下，你会空手道踢出那个属性。呸。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T15:11:26.317

将高度更改为“自动”，看看是否适合您。

Auto 是元素的默认高度，这意味着浏览器会自行计算高度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T15:24:08.990

样式属性总是覆盖类。因此，您将不得不删除样式属性的高度规则。

# java - Java相当于app.config？

> ID：212539
> 
> 赞同：26
> 
> 时间：2008-10-17T15:03:25.817
> 
> 标签：java, configuration-files

是否有与 .NET 的 App.Config 等效的 Java？

如果没有，是否有一种标准方法可以保留您的应用程序设置，以便在应用程序分发后可以更改它们？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-17T15:16:18.833

对于 WebApps，web.xml 可用于存储应用程序设置。

除此之外，您可以使用[Properties](http://java.sun.com/javase/6/docs/api/java/util/Properties.html)类来读取和写入属性文件。

您可能还想查看[Preferences](http://java.sun.com/javase/6/docs/api/java/util/prefs/Preferences.html)类，它用于读写系统和用户首选项。它是一个抽象类，但您可以使用`userNodeForPackage(ClassName.class)`and获取适当的对象`systemNodeForPackage(ClassName.class)`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-09-27T00:31:27.647

将@Powerlord 关于使用`Properties`该类的建议 (+1) 放入示例代码中：

```
public class SomeClass {
    public static void main(String[] args){
        String dbUrl = "";
        String dbLogin = "";
        String dbPassword = "";     
        if (args.length<3) {
            //If no inputs passed in, look for a configuration file
            URL configFile = SomeClass.class.getClass().getResource("/Configuration.cnf");
            try {
                InputStream configFileStream = configFile.openStream();
                Properties p = new Properties();
                p.load(configFileStream);
                configFileStream.close();

                dbUrl      = (String)p.get("dbUrl");
                dbLogin    = (String)p.get("dbUser");
                dbPassword = (String)p.get("dbPassword");               
            } catch (Exception e) {  //IO or NullPointer exceptions possible in block above
                System.out.println("Useful message");
                System.exit(1);
            }
        } else {
            //Read required inputs from "args"
            dbUrl      = args[0];
            dbLogin    = args[1];
            dbPassword = args[2];           
        }
        //Input checking one three items here
        //Real work here.
    }
} 
```

然后，在容器的根目录（例如 jar 文件的顶部）放置一个`Configuration.cnf`包含以下内容的文件：

```
#Comments describing the file
#more comments
dbUser=username
dbPassword=password
dbUrl=jdbc\:mysql\://servername/databasename 
```

这感觉并不完美（我很想听听改进），但足以满足我目前的需求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T15:15:48.960

简单的方法是简单地拥有一个包含所有设置的属性文件，例如 myapp.properties。这不是一种非常高级的设置方法，但它就足够了，或者你可以拥有自己的基于 XML 的设置，或者从数据库等

# javascript - 此页面上的脚本导致 ie 运行缓慢

> ID：212550
> 
> 赞同：30
> 
> 时间：2008-10-17T15:05:28.713
> 
> 标签：javascript, internet-explorer

问题出在标题中 - IE 行为不端，并说有一个脚本运行缓慢 - FF 和 Chrome 没有这个问题。

我怎样才能找到问题。.那个页面上有很多JS。手动检查不是一个好主意

**编辑：**这是我正在处理的项目中的一个页面......但我需要一个工具来找到问题。

**结束：**原来是 UpdatePanel - 不知何故，它会变得“混乱”并且需要很长时间来处理某些东西。我只是把它扔出窗外——从现在开始只使用 JQuery :D。

我选择 Remy Sharp 的回答是因为我真的不知道这个工具，而且它看起来很酷。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2010-02-27T00:34:54.183

不同浏览器对长时间运行的脚本的检测方式不同：

*   一旦执行了 500 万条语句，IE 就会发出警告（[MSDN 上的更多信息](http://support.microsoft.com/kb/175500)）
*   如果脚本花费的时间超过 10 秒，Firefox 会发出警告（[有关 MDN 的更多信息](http://support.mozilla.com/en-US/kb/Warning%20Unresponsive%20script)）
*   如果脚本运行时间超过 5 秒，Safari 会发出警告
*   Chrome (1.0) 没有设定限制，只会继续尝试，直到出现 OutOfMemory 异常，此时它崩溃
*   Opera 将继续永远运行，不会发出警告。

[Nicholas Zakas 写了一篇关于这个主题的优秀文章。](http://www.nczonline.net/blog/2009/01/05/what-determines-that-a-script-is-long-running/)

因此 - 避免这些问题的最佳方法是减少循环、递归和 DOM 操作。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-18T00:18:08.600

获取一份 IBM Page Profiler 的副本：

[https://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=61d74777-1701-4014-bfc0-96067ed50156](https://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=61d74777-1701-4014-bfc0-96067ed50156)

它是免费的（总是胜利）。在后台启动它，等待几秒钟，然后在 IE 中刷新页面。返回分析器，它将列出页面上使用的所有资源，并为您提供详细的配置文件信息 - 特别是 JavaScript 需要很长时间执行的地方。

这应该是找到问题根源的良好开端。

如果脚本标签是内联的，我建议创建文件的本地副本，如果可以的话，将脚本标签分离到单独的文件中。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-17T15:14:27.790

删除一半的代码，看看它是否仍然发生。如果没有，它在你删除的一半。重复直到找出导致问题的代码块。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T15:16:53.713

它通常是导致这种情况的无限循环。检查您的循环及其退出条件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-27T00:19:23.623

对于 IE，对话框基于处理的 JS 命令数。有关更改默认值的信息和方法，请参见此处：http: [//support.microsoft.com/kb/175500](http://support.microsoft.com/kb/175500)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-03T14:54:50.920

您还可以检查您的页面中是否包含谷歌分析 javascript。该错误仅发生在 IE 中，一旦删除了 google 代码，它就可以工作了！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-28T03:18:29.833

确保下面的 JavaScript 代码只运行一次：

```
Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(win_onload); 
```

上面的代码在函数内部`win_onload()`。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-12-11T18:57:43.177

我发现添加 alert('before X') alert('after X') 有助于我找到我的问题。我将它们添加到我的 $(function () {

}

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-17T15:22:25.093

我不相信有一个工具可以找到有问题的脚本。您可以尝试附加一个像 Visual Studio 这样的 IE 调试器，它可能会在问题发生的地方中断。但我不能对这项工作做出任何保证。

过去，当我遇到类似问题时，我只是简单地注释掉代码部分以测试缩小问题发生的范围，通常采用二进制搜索类型模式。注释掉一半的javascript库等...

除此之外，正如其他人所说，这种类型的问题发生在大型循环和许多 setTimeout 函数调用或 setTimeout 递归循环中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-17T17:16:33.597

如果 javascript 占用页面处理超过 10 秒，您会收到此消息。IE 显然有一个较慢的 javascript 引擎，导致了这种情况。

我猜一些代码优化肯定会有所帮助，并尝试减少页面加载时执行的 javascript 数量。如果必须的话，也许可以使用 setTimeout() 来推迟处理一些不必要的事情。

就工具而言，使用 Firebug 的分析器来查看您在哪里花费了这么多时间。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-01-13T15:07:14.227

如果您可以控制 JavaScript，则可以将其分解为单独的脚本或尝试延迟加载方法。

只是我的 $.02

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-06-13T11:22:20.440

在我的情况下，在绑定到很多行的 GridView 中有太多 ASP.NET HoverMenuExtender 控件会导致性能极慢。我删除了 HoverMenuExtender，我的速度问题（和对话框）消失了。与弹出对话框的原因不太相关，但它可能对某人有所帮助。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-07-17T19:57:01.413

@nikmd23 答案内容丰富..

我在这里的 2 美分...我遇到了脚本警告问题 - 由于在循环`dropdown list`的帮助下加载了一个项目。`for`

[我在Disabling the long-running-script message in Internet Explorer](https://stackoverflow.com/questions/4460263/disabling-the-long-running-script-message-in-internet-explorer)中提到了@Eric Leschinski 的帖子 。

请参阅[setTimeout 以在下拉列表中加载项目](https://stackoverflow.com/questions/24847655/settimeout-for-loading-items-in-a-dropdown-list)以查看我如何解决此问题

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-09-16T13:33:45.260

这种警报的原因很少

1.  IE 执行的 JS 指令数超过了预定义的限制。这可以通过编辑 Windows 注册表来修复，请参见[此处](http://support.microsoft.com/default.aspx?scid=kb;en-us;175500)

2.  优化 javascript 代码以减少执行时间。

3.  JS 代码优化是一个真正的试验和错误主题，并且没有什么经验法则可以做到这一点。只需谷歌它。

# c++ - C++ win32 GUI编程，最短路径？

> ID：212559
> 
> 赞同：13
> 
> 时间：2008-10-17T15:06:44.343
> 
> 标签：c++, user-interface, winapi

你知道学习 C++ win32（不是 .Net/MFC/ATL/Wx/Qt..）GUI 编程的好方法吗？一本书，一个教程，一个现有项目，最好是带有实际示例的动手方法..我不是初学者，所以我不介意“高级”起点..

感谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-17T15:08:54.417

Charles Petzolds 的书是最好的。

[编程窗口](https://rads.stackoverflow.com/amzn/click/com/157231995X)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-17T15:56:38.360

没有“C++ Win32 GUI 编程”之类的东西。C++ 用于您看到的许多包装库（想到 QT 和 MFC）。但是，纯粹的 Win32 编程在技术上完全是过程性的，如果不是在概念上的话。它从 Pascal 开始，然后在 C 中重铸，从那以后就再也没有出现过。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-08T22:15:14.850

[theForger 的 Win32 API 编程教程](http://www.winprog.org/tutorial/)将自己描述为“尝试让您尽可能快速和清晰地开始使用 Win32 API 进行开发”，并且它的项目和解决方案是为 Visual C++ 编写的。它还以 PDF 格式提供，只有 108 页长。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-17T15:09:13.840

如果你能找到一份 Petzold 的编程窗口。所有 win32 gui 的东西都在 MFC/Winforms 等下面。 [http://www.charlespetzold.com/pw5/index.html](http://www.charlespetzold.com/pw5/index.html)

编辑 - 正如有人提到的，win32 api 纯粹是“C”，就像 Petzold 中的所有示例一样。如果您从 C++ 中调用它们，这并不重要，只是您必须理解常规的 C 字符串。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-17T15:09:47.597

所有 Win32 编程（包括但不限于 GUI 主题）的圣经都是[Petzold 的书](http://www.charlespetzold.com/pw5/)。

确保您获得[版本 4](http://www.charlespetzold.com/pw5/ProgWinEditions.html)或更高版本，因为以前的版本是 16 位！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-17T15:33:40.013

#Efnet WinProg 频道有一个不错的教程和常见问题解答。虽然它不是一个严格的 C++ 指南。

[http://www.winprog.org/tutorial/](http://www.winprog.org/tutorial/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-17T17:54:33.443

我想我是通过学习 VC6 的帮助文件来学习的。:-) 我发现 VC8 的文件总体上对 Win32 编程的帮助要小得多，因为它们充满了 MFC、COM、WinCE 和其他你不能总是过滤掉的东西。

（我知道这个答案并不是那么有帮助，我只是在说我是如何*学习*的。）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-07-27T08:10:26.463

我从 Forger 的 winprog 教程中获得了我的 Win32 经验。我花了将近一年的时间才掌握了这一点，让我告诉你，当时我不是 C 程序员，但现在我是。此外，在阅读它们的同时，购买 Ritchie 和 Kernighan II 版的 ANSI C 编程副本。

使用 Visual C Express 作为开始。我现在使用 Windows SDK 终端编写我的 Win32/C 程序。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-20T00:18:53.433

这里是一些[在线 Win32 教程的列表，这里是](http://www.zeusedit.com/forum/viewtopic.php?t=7)[WIN32 SDK](http://www.zeusedit.com/forum/viewtopic.php?t=7)帮助文件的链接列表。

我个人喜欢 Winhelp 格式的**Borland Win32 SDK**（来自上面的链接），因为它涵盖了**Win32**的所有基础知识，并且比**MSDN**之类的更容易搜索。

一旦您知道自己在做什么，**MSDN**就很棒，但我怀疑它可能会让新手感到困惑。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-17T16:10:26.540

您可能还想查看 WTL 源代码。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-20T19:11:25.953

为什么 C++ 为什么不直接使用 C 和 WIN32？它更容易...... Petzold 是您的答案。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-18T10:56:18.077

*   Petzold

*   MSDN

*   Advanced Win32 api newsgroup comp.os.ms-windows.programmer.win32 (undocumented apis and any Win32 api source code)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-17T15:15:37.290

我从[Iczelion 教程](http://win32assembly.online.fr/tutorials.html)中学到了很多关于 win32 GUI 的知识。它们基本上是用于 win32 汇编的，所以源代码示例是 MASM 而不是 C++，但是 Windows GUI 的机制描述得很好。无论如何，API 本身并不依赖于语言。

# java - 有没有一个好方法有一个地图 获取并放置忽略大小写？

> ID：212562
> 
> 赞同：64
> 
> 时间：2008-10-17T15:07:03.047
> 
> 标签：java, map, case-insensitive

有没有一个好方法可以`Map<String, ?>`忽略大小写？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-12-09T20:55:41.450

TreeMap 扩展了 Map 并支持自定义比较器。

String 提供了一个默认的不区分大小写的比较器。

所以：

```
final Map<String, ...> map = new TreeMap<>(String.CASE_INSENSITIVE_ORDER); 
```

比较器不考虑语言环境。在其 JavaDoc 中阅读有关它的更多信息。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-10-17T15:16:35.463

您可以使用Apache 的 Commons Collections 中的[CaseInsensitiveMap](http://commons.apache.org/proper/commons-collections/javadocs/api-release/org/apache/commons/collections4/map/CaseInsensitiveMap.html)。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-10-17T15:23:28.037

是否可以实现自己的 Map 覆盖 put/get 方法？

```
public class CaseInsensitiveMap extends HashMap<String, String> {
    ...
    put(String key, String value) {
       super.put(key.toLowerCase(), value);
    }

    get(String key) {
       super.get(key.toLowercase());
    }
} 
```

这种方法不会强迫您更改“键”类型，而是您的 Map 实现。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-10-17T15:11:44.940

您需要一个带有不区分大小写的 equals() 和 hashCode() 实现的 String 键的包装类。使用它而不是 Map 的键的字符串。

[请参阅http://www.java.happycodings.com/Java_Util_Package/code3.html](http://www.java.happycodings.com/Java_Util_Package/code3.html)上的示例实现， 我在 2 分钟的谷歌搜索中找到了它。对我来说看起来很明智，虽然我从未使用过它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-17T15:46:08.740

想到的三个明显的解决方案：

*   在使用字符串作为键之前对大小写进行规范化（不是土耳其语区域设置与世界其他地方的工作方式不同）。

*   使用设计用作键的特殊对象类型。这是处理复合键的常用习语。

*   将 TreeMap 与不区分大小写的 Comparator 一起使用（可能是 PRIMARY 或 SECONDARY 强度 java.text.Collat​​or）。不幸的是，Java 库没有与 hashCode/equals 等效的比较器。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-30T14:23:37.953

[您可以使用此处](http://underlap.blogspot.com/2009/04/caseinsensitivemapv.html)讨论的我的 Apache 许可[CaseInsensitiveMap](https://src.springsource.org/svn/dm-server-util/main-branches/jersey/com.springsource.util.common/src/main/java/com/springsource/util/common/CaseInsensitiveMap.java)。与 Apache Commons 版本不同，它保留了键的大小写。它比 TreeMap 更严格地实现了 map 契约（加上具有更好的并发语义）（详见博客评论）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-09T20:54:06.977

[Trove4j](http://trove4j.sourceforge.net/html/overview.html)可以为 HashMap 使用自定义散列。然而，鉴于无法缓存哈希码，这可能会对性能产生影响（尽管 Trove4j 可能已经找到了解决这个问题的方法？）。包装器对象（如 John M 所述）没有这种缓存缺陷。另请参阅我关于 TreeMap 的其他答案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-29T07:43:53.210

在下面的链接中检查接受的答案。 [无论情况如何，如何检查 Map 中的密钥？](https://stackoverflow.com/questions/3092710/how-to-check-for-key-in-a-map-irrespective-of-the-case)

底线是“最简单的解决方案是在插入/检查之前简单地将所有输入转换为大写（或小写）。您甚至可以编写自己的地图包装器来确保一致性。”

# java - 来自 Spring-JDBC 的 getResultSet

> ID：212569
> 
> 赞同：6
> 
> 时间：2008-10-17T15:07:58.833
> 
> 标签：java, spring, jdbc, jasper-reports

我正在使用 Spring 对 JDBC 的支持。我想使用[JdbcTemplate](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/jdbc/core/JdbcTemplate.html)（或 SimpleJdbcTemplate）来执行查询并获取结果作为 ResultSet 的实例。

我能看到实现这一目标的唯一方法是使用：

```
String sql = "select * from....";
SqlRowSet results = jdbcTemplate.queryForRowSet(sql);
((ResultSetWrappingSqlRowSet) results).getResultSet(); 
```

这种方法的一个明显缺点是它需要我对 SqlRowSet 的实现类型做出假设（通过强制转换），但是有更好的方法吗？

**背景资料...**

我想以 ResultSet 而不是 bean 集合的形式获取结果的原因是因为结果将直接传递给 Jasper 报告以进行显示。换句话说，Java bean 将只用于临时存储 ResultSet 中的每一行，如果可能的话，我想避免为每个 Jasper 报告创建这样的 bean。

干杯，唐

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T15:24:07.787

如果您只想执行查询并获取结果，为什么不使用纯 jdbc 并获取结果集？请注意，您不需要 spring 来执行此操作。

```
 Connection c = ...
    c.prepareCall("select ...").getResultSet(); 
```

此外，您可以通过将对象用作 DTO 来获得优势。即使您的数据访问或报告工具发生更改，您也不需要更改 DTO 类（假设您开始使用 xquery 而不是 jdbc，或者您使用 apache-poi 而不是 jasper。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-27T02:35:11.777

您可以在 JdbcTemplate 回调（如 ResultSetExtractor）中调用 Jasper，也可以使用直接 JDBC 将 ResultSet 传递给 Jasper。无论哪种方式，当您调用 Jasper 时，您与数据库的连接仍然处于活动状态，直到您的报告完成。

# java - 如何在 Java 中从 XML 创建 PDF？

> ID：212577
> 
> 赞同：33
> 
> 时间：2008-10-17T15:09:46.537
> 
> 标签：java, xml, pdf, xslt, itext

目前，我正在用 Java 创建一个 XML 文件，并通过使用 XSL/XSLT 对其进行转换，将其显示在 JSP 页面中。现在我需要获取该 XML 文件并在 PDF 中显示相同的信息。有没有办法通过使用某种 XSL 文件来做到这一点？

我已经看过[iText](http://www.lowagie.com/iText/) Java-PDF 库，但我找不到任何方法将它与 XML 和样式表一起使用。

任何帮助将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2016-12-08T21:48:01.070

### A - 解释

您应该使用**Apache FOP**框架来生成**pdf**输出。只需提供**xml格式的数据并使用****xsl-fo**文件呈现页面，并在此**xsl-fo**文件中指定*边距*、*页面布局*等参数。

 **我将提供一个简单的演示，我使用**maven**构建工具来收集所需的 jar 文件。请注意，在页面末尾，有一个嵌入 pdf 的 svg 图形。我还想证明您可以在 pdf 中嵌入 svg 图形。

### B - 示例 XML 输入数据

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="application/xml"?>
<users-data>
    <header-section>
        <data-type id="019">User Bill Data</data-type>
        <process-date>Thursday December 9 2016 00:04:29</process-date>
    </header-section>
    <user-bill-data>
        <full-name>John Doe</full-name>
        <postal-code>34239</postal-code>
        <national-id>123AD329248</national-id>
        <price>17.84</price>
    </user-bill-data>
    <user-bill-data>
        <full-name>Michael Doe</full-name>
        <postal-code>54823</postal-code>
        <national-id>942KFDSCW322</national-id>
        <price>34.50</price>
    </user-bill-data>
    <user-bill-data>
        <full-name>Jane Brown</full-name>
        <postal-code>66742</postal-code>
        <national-id>ABDD324KKD8</national-id>
        <price>69.36</price>
    </user-bill-data>
</users-data> 
```

### C - XSL-FO 模板

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:fo="http://www.w3.org/1999/XSL/Format" version="1.0">
    <xsl:output encoding="UTF-8" indent="yes" method="xml" standalone="no" omit-xml-declaration="no"/>
    <xsl:template match="users-data">
        <fo:root language="EN">
            <fo:layout-master-set>
                <fo:simple-page-master master-name="A4-portrail" page-height="297mm" page-width="210mm" margin-top="5mm" margin-bottom="5mm" margin-left="5mm" margin-right="5mm">
                    <fo:region-body margin-top="25mm" margin-bottom="20mm"/>
                    <fo:region-before region-name="xsl-region-before" extent="25mm" display-align="before" precedence="true"/>
                </fo:simple-page-master>
            </fo:layout-master-set>
            <fo:page-sequence master-reference="A4-portrail">
                <fo:static-content flow-name="xsl-region-before">
                    <fo:table table-layout="fixed" width="100%" font-size="10pt" border-color="black" border-width="0.4mm" border-style="solid">
                        <fo:table-column column-width="proportional-column-width(20)"/>
                        <fo:table-column column-width="proportional-column-width(45)"/>
                        <fo:table-column column-width="proportional-column-width(20)"/>
                        <fo:table-body>
                            <fo:table-row>
                                <fo:table-cell text-align="left" display-align="center" padding-left="2mm">
                                    <fo:block>
                                        Bill Id:<xsl:value-of select="header-section/data-type/@id"/>
                                        , Date: <xsl:value-of select="header-section/process-date"/>
                                    </fo:block>
                                </fo:table-cell>
                                <fo:table-cell text-align="center" display-align="center">
                                    <fo:block font-size="150%">
                                        <fo:basic-link external-destination="http://www.example.com">XXX COMPANY</fo:basic-link>
                                    </fo:block>
                                    <fo:block space-before="3mm"/>
                                </fo:table-cell>
                                <fo:table-cell text-align="right" display-align="center" padding-right="2mm">
                                    <fo:block>
                                        <xsl:value-of select="data-type"/>
                                    </fo:block>
                                    <fo:block display-align="before" space-before="6mm">Page <fo:page-number/> of <fo:page-number-citation ref-id="end-of-document"/>
                                    </fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                        </fo:table-body>
                    </fo:table>
                </fo:static-content>
                <fo:flow flow-name="xsl-region-body" border-collapse="collapse" reference-orientation="0">
                    <fo:block>MONTHLY BILL REPORT</fo:block>
                    <fo:table table-layout="fixed" width="100%" font-size="10pt" border-color="black" border-width="0.35mm" border-style="solid" text-align="center" display-align="center" space-after="5mm">
                        <fo:table-column column-width="proportional-column-width(20)"/>
                        <fo:table-column column-width="proportional-column-width(30)"/>
                        <fo:table-column column-width="proportional-column-width(25)"/>
                        <fo:table-column column-width="proportional-column-width(50)"/>
                        <fo:table-body font-size="95%">
                            <fo:table-row height="8mm">
                                <fo:table-cell>
                                    <fo:block>Full Name</fo:block>
                                </fo:table-cell>
                                <fo:table-cell>
                                    <fo:block>Postal Code</fo:block>
                                </fo:table-cell>
                                <fo:table-cell>
                                    <fo:block>National ID</fo:block>
                                </fo:table-cell>
                                <fo:table-cell>
                                    <fo:block>Payment</fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                            <xsl:for-each select="user-bill-data">
                                <fo:table-row>
                                    <fo:table-cell>
                                        <fo:block>
                                            <xsl:value-of select="full-name"/>
                                        </fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell>
                                        <fo:block>
                                            <xsl:value-of select="postal-code"/>
                                        </fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell>
                                        <fo:block>
                                            <xsl:value-of select="national-id"/>
                                        </fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell>
                                        <fo:block>
                                            <xsl:value-of select="price"/>
                                        </fo:block>
                                    </fo:table-cell>
                                </fo:table-row>
                            </xsl:for-each>
                        </fo:table-body>
                    </fo:table>
                    <fo:block id="end-of-document">
                        <fo:instream-foreign-object>
                            <svg width="200mm" height="150mm" version="1.1" xmlns="http://www.w3.org/2000/svg">
                                <path d="M153 334
C153 334 151 334 151 334
C151 339 153 344 156 344
C164 344 171 339 171 334
C171 322 164 314 156 314
C142 314 131 322 131 334
C131 350 142 364 156 364
C175 364 191 350 191 334
C191 311 175 294 156 294
C131 294 111 311 111 334
C111 361 131 384 156 384
C186 384 211 361 211 334
C211 300 186 274 156 274" style="fill:yellow;stroke:red;stroke-width:2"/>
                            </svg>
                        </fo:instream-foreign-object>
                    </fo:block>
                </fo:flow>
            </fo:page-sequence>
        </fo:root>
    </xsl:template>
</xsl:stylesheet> 
```

### D - 项目目录结构

[![在此处输入图像描述](https://i.stack.imgur.com/f8dV5.png)](https://i.stack.imgur.com/f8dV5.png)

### E - Pom 文件

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.levent.fopdemo</groupId>
    <artifactId>apache-fop-demo</artifactId>
    <packaging>jar</packaging>
    <version>1.0-SNAPSHOT</version>
    <name>apache-fop-demo</name>
    <url>http://maven.apache.org</url>

    <properties>
        <fop.version>2.1</fop.version>
    </properties>

    <dependencies>      
        <!-- https://mvnrepository.com/artifact/org.apache.xmlgraphics/fop -->
        <dependency>
            <groupId>org.apache.xmlgraphics</groupId>
            <artifactId>fop</artifactId>
            <version>${fop.version}</version>
        </dependency>
    </dependencies>

    <build>
        <finalName>Apache Fop Demo</finalName>

        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.5.1</version>
                <configuration>
                    <source>1.8</source>
                    <target>1.8</target>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project> 
```

### F - 演示代码：PdfGenerationDemo.java

```
package com.levent.fopdemo;

import java.io.File;
import java.io.IOException;
import java.io.OutputStream;

import javax.xml.transform.Result;
import javax.xml.transform.Transformer;
import javax.xml.transform.TransformerException;
import javax.xml.transform.TransformerFactory;
import javax.xml.transform.sax.SAXResult;
import javax.xml.transform.stream.StreamSource;

import org.apache.fop.apps.FOPException;
import org.apache.fop.apps.FOUserAgent;
import org.apache.fop.apps.Fop;
import org.apache.fop.apps.FopFactory;
import org.apache.fop.apps.MimeConstants;

public class PdfGenerationDemo 
{
    public static final String RESOURCES_DIR;
    public static final String OUTPUT_DIR;

    static {
        RESOURCES_DIR = "src//main//resources//";
        OUTPUT_DIR = "src//main//resources//output//";
    }

    public static void main( String[] args )
    {
        try {
            convertToPDF();
        } catch (FOPException | IOException | TransformerException e) {
            e.printStackTrace();
        }
    }

    public static void convertToPDF() throws IOException, FOPException, TransformerException {
        // the XSL FO file
        File xsltFile = new File(RESOURCES_DIR + "//template.xsl");
        // the XML file which provides the input
        StreamSource xmlSource = new StreamSource(new File(RESOURCES_DIR + "//data.xml"));
        // create an instance of fop factory
        FopFactory fopFactory = FopFactory.newInstance(new File(".").toURI());
        // a user agent is needed for transformation
        FOUserAgent foUserAgent = fopFactory.newFOUserAgent();
        // Setup output
        OutputStream out;
        out = new java.io.FileOutputStream(OUTPUT_DIR + "//output.pdf");

        try {
            // Construct fop with desired output format
            Fop fop = fopFactory.newFop(MimeConstants.MIME_PDF, foUserAgent, out);

            // Setup XSLT
            TransformerFactory factory = TransformerFactory.newInstance();
            Transformer transformer = factory.newTransformer(new StreamSource(xsltFile));

            // Resulting SAX events (the generated FO) must be piped through to
            // FOP
            Result res = new SAXResult(fop.getDefaultHandler());

            // Start XSLT transformation and FOP processing
            // That's where the XML is first transformed to XSL-FO and then
            // PDF is created
            transformer.transform(xmlSource, res);
        } finally {
            out.close();
        }
    }
} 
```

### G - 样本输出：output.pdf

[![在此处输入图像描述](https://i.stack.imgur.com/yQ4In.png)](https://i.stack.imgur.com/yQ4In.png)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-17T15:15:41.563

您可以使用 XSL 格式化对象。这里有一些关于如何做到这一点的好文章：

*   [http://www.xml.com/pub/a/2001/01/17/xsl-fo/index.html](http://www.xml.com/pub/a/2001/01/17/xsl-fo/index.html)
*   [http://www.xml.com/pub/a/2001/01/24/xsl-fo/index.html?page=1](http://www.xml.com/pub/a/2001/01/24/xsl-fo/index.html?page=1)
*   [http://www.javaworld.com/javaworld/jw-04-2006/jw-0410-html.html](http://www.javaworld.com/javaworld/jw-04-2006/jw-0410-html.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-17T15:19:54.457

您还可以在[此处查看 Apache FOP 项目](http://xmlgraphics.apache.org/fop/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T15:16:32.717

[BIRT](http://www.eclipse.org/birt/phoenix/)有一个用于 Eclipse 的 GUI，可以让您从 XML、DB、CSV 等定义 PDF。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T15:13:49.260

您可能希望查看可以将 PDF 创建作为转换的 XSL-FO 库。我会尝试找到一个链接。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-19T20:09:56.603

试试[xhtmlrenderer](http://code.google.com/p/flying-saucer//)项目。请参阅文章“[使用飞碟和 iText 为乐趣和利润生成 PDF](http://today.java.net/pub/a/today/2007/06/26/generating-pdfs-with-flying-saucer-and-itext.html) ”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-03-08T18:22:31.790

您可以将 XSL-Fo 应用于您的 XML 并使用 Java 转换器对其进行转换：

```
File xmlfile = new File(baseDir, xml);
File xsltfile = new File(baseDir, xsl);
File pdffile = new File(outDir, "ResultXMLPDF.pdf");

FopFactory fopFactory = FopFactory.newInstance();
FOUserAgent foUserAgent = fopFactory.newFOUserAgent();

OutputStream out = new java.io.FileOutputStream(pdffile);
out = new java.io.BufferedOutputStream(out);

try
{
    Fop fop = fopFactory.newFop(MimeConstants.MIME_PDF, foUserAgent, out);
    // Setup XSLT
    TransformerFactory factory = TransformerFactory.newInstance();
    Transformer transformer = factory.newTransformer(new StreamSource(xsltfile));

    transformer.setParameter("versionParam", "1.0");

    Source src = new StreamSource(xmlfile);

    Result res = new SAXResult(fop.getDefaultHandler());

    transformer.transform(src, res);

} finally {
    out.close();
}

System.out.println("Success!"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T16:06:14.817

使用 JasperReports。您可以从数据库或 XML 中提取数据。您可以导出为多种格式：pdf、excel、html 等...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-26T19:15:15.323

稍后，您可以使用 Adob​​e 的设计器创建具有可编辑字段的静态 PDF，然后创建匹配的 XDP XML 文档。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-02-28T06:21:27.623

有两种方法可以做到这一点。

*   首先，您可以创建一个普通的 PDF，它在回读时不会为您提供原始 XML 文件的层次结构。`'Section 9.4.2 Parsing XML'`这在中解释得很详细`'iText in Action : Edition 2'`。

*   其次，您可以创建一个带标签的 PDF，其中包含 XML 的层次结构和数据。这使您能够读回 PDF 文件并从中创建一个 XML 文件（与原始 XML 文件完全匹配）。这个概念在 中也有详细`'15.2.3 Adding structure'`论述`'iText in Action : Edition 2'`。

根据您的要求，您可以使用上述任何一种方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-08-09T10:49:04.370

XML、CSS、XHTML 等包含在开放标准的“活跃生态系统”中，而*XSL-FO*是一个孤立的标准。

...从历史上看，XSL-FO 和 XSLT 是作为双胞胎兄弟创建的，但只有 XSLT 仍然是“活着的标准”，XSL-FO 将大量 DNA 集中在专有 (Adobe) 标准中......现在已经过时了。

严格来说，XSL-FO 是一种不会进化的“废弃方式”的一部分，它忽略了 CSS，在“活着的生态系统”中表达布局的“新方式”。

## 这不是 Java 问题

请参阅有关将**CSS-page**与 XML 或 XHTML 一起使用的[答案。](https://stackoverflow.com/a/21345708/287948)

# javascript - 下拉列表问题

> ID：212587
> 
> 赞同：4
> 
> 时间：2008-10-17T15:12:15.190
> 
> 标签：javascript, internet-explorer, drop-down-menu, cross-browser, html-select

我遇到了一个问题，即 IE 6/7 中的下拉列表的行为如下：

![替代文字](https://i488.photobucket.com/albums/rr249/djfloetic/ie7.jpg)

您可以看到下拉列表`width`不够宽，无法在不展开整体下拉列表的情况下显示整个文本。

但是在 Firefox 中，没有问题，因为它`expands the width`相应地。这是我们在 IE 6/7 中想要的行为：

![替代文字](https://i488.photobucket.com/albums/rr249/djfloetic/firefox.jpg)

我们已经研究了利用`onfocus, onblur, onchange, keyboard and mouse events`来尝试解决问题的各种方法，但仍然存在一些问题。

我想知道是否有人在不使用任何工具包/框架（YUI、Ext-JS、jQuery 等）的情况下在 IE 6/7 中解决了这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T16:45:23.583

[这个](http://www.dougboude.com/blog/1/2008/05/Viewing-Option-Text-in-IE7-thats-Wider-than-the-Select-List.cfm)人和你有同样的问题，他想出了一个解决方案。这有点小技巧，取决于您的 UI 设置方式，但它是一种选择。我希望它有所帮助。

**编辑**

我开始寻找的链接实际上是[这个](http://www.hedgerwow.com/360/dhtml/ui_select_with_fixed_width/demo.php)，这与蒂姆建议的相同。我认为这是一个比我原来的发现更好的解决方案。**第二次编辑**这个解决方案实际上依赖于 YUI 框架，但我不认为复制它背后的主要思想太难了。否则，第一个链接也可以，而且要简单得多。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T15:32:33.463

在您的情况下，这样的事情是否可行？

[http://www.hedgerwow.com/360/dhtml/ui_select_with_fixed_width/demo.php](http://www.hedgerwow.com/360/dhtml/ui_select_with_fixed_width/demo.php)

鼠标悬停期间下拉菜单的宽度会增大/缩小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T21:38:04.583

```
<script type="text/javascript">
    var MAX_WIDTH = 500; //the biggest width the select is allowed to be

    function biggestOption(elem) {
        var biggest = 0;
        for (var i=0;i<elem.options.length;i++) {
            if ( elem.options[i].innerHTML.length > biggest ) {
                biggest = elem.options[i].innerHTML.length;
            }
        }
        return roughPixelSize(biggest);
    }

    function roughPixelSize(charLength) {
        //this is far from perfect charLength to pixel
        //but it works for proof of concept
        roughSize =  30 + (charLength * 6);
        if (roughSize > MAX_WIDTH) {
            return MAX_WIDTH;
        } else {
            return roughSize;
        }
    }

    function resizeToBiggest(elem) {
        elem.style.width = biggestOption(elem);
    }

    function resizeToSelected(elem) {
        elem.style.width = roughPixelSize(elem.options[elem.selectedIndex].innerHTML.length);
    }

</script>

<select onmouseover="resizeToBiggest(this)" style="width:70px" onchange="resizeToSelected(this)" onblur="resizeToSelected(this)" >
    <option>test 1</option>
    <option>test 2</option>
    <option>test 3</option>
    <option>this is some really really realy long text</option>
    <option>test 4</option>
    <option>test 5</option>
</select> 
```

如果没有大量工作或使用框架，我认为您想做的事情是不可能的。以上是您可以考虑尝试/弄乱的东西...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T15:20:00.870

我建议扩大选择范围。Firefox对此很友好，并扩大了选项的宽度，以便您可以看到它的值，但这并不能解决一旦您选择了一个选项，您将无法看到您选择的确切内容的问题一个用户，除非您使选择范围更广。因此，从用户友好的角度来看，我建议只允许浏览器根据其内容调整选择的大小，或者设置一个足够宽的宽度以容纳最宽选项内容的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T15:23:38.367

我认为，如果您将控件上的宽度留空，它将调整为控件中的数据。

[编辑] 是的，在 vs2005 网络应用程序中对其进行了测试。添加控件并将项目放入。它调整为 ie 7.0 中最长的项目当我规定宽度时它不再这样做。

[编辑 2] 唯一的问题是下拉菜单的文本框也会调整。这可能会影响您的 UI。所以这可能不是您正在寻找的解决方案。

[编辑 3] 这绝对是他们渲染的不同方式。我认为您可以克服此问题的唯一方法是创建类似于[此处建议的控件](http://forums.asp.net/p/1145442/1861195.aspx#1861195)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T15:32:41.717

问题是我们不希望它自动调整大小，让我们将问题隔离到这个特定问题。虽然我同意从可用性的角度来看它并不理想，但我仍然想解决这个问题。

我们有一个固定宽度的下拉列表，我们希望它在 FireFox 7 中的行为如上所示。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T15:49:52.680

我在 IE7 上对此进行了测试，并相应地进行了扩展。你确定你没有使用某种奇怪的 CSS 迫使它只在 IE 6/7 中达到那个大小吗？（可以使用奇怪的 CSS 选择器黑客攻击特定的浏览器，例如 '* html'）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T15:49:57.080

基本上，如果您确实需要一个 ACTUAL 文本框，您将需要选择一个或另一个（定义或不定义宽度）。这是为所有已知的浏览器编写代码时遇到困难的一个典型例子，除非公司聚在一起说“这就是它的方式。永远”，否则真的没有办法解决这个问题。

作为替代方案，您可以使用另一个答复中提到的本土解决方案。在你的情况下，我会推荐它。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-10-17T15:26:25.317

你如何填充 DropDownList。我正在使用以下代码填充 DropDownList 并根据显示的最大文本调整宽度：

```
private void BindData()
        {
            List<Foo> list = new List<Foo>();
            list.Add(new Foo("Hello"));
            list.Add(new Foo("bye bye"));
            list.Add(new Foo("this is a reall asd a s das d asd as da sf gfa sda sd asdasd a"));

            ddl1.DataSource = list;
            ddl1.DataTextField = "Text"; 
            ddl1.DataBind(); 
        } 
```

哦，是的，不要在 DropDownList 上明确定义宽度。

# asp.net - 如何检测 ASP.net 应用程序中的 SqlServer 连接泄漏？

> ID：212596
> 
> 赞同：33
> 
> 时间：2008-10-17T15:14:49.210
> 
> 标签：asp.net, sql-server, connection-pooling, performancecounter, connection-leaks

我目前正在对 ASP.net 2.0 应用程序进行一些 GUI 测试。RDBMS 是 SQL Server 2005。主机是 Win Server 2003 / IIS 6.0。

我没有应用程序的源代码，因为它是由没有发布代码的外部公司编写的。

我注意到当我重新启动 IIS 时应用程序运行良好，但经过一些测试，在我打开和关闭浏览器几个小时后，应用程序开始变得越来越慢。我想知道这种行为是否是由于程序员关闭连接的错误做法造成的：我怀疑这里的数据库存在开放连接泄漏。

我猜.Net 垃圾收集器最终会关闭它们，但是......这可能需要一段时间，不是吗？

我有 SQL Server Management Studio，我确实从活动监视器中注意到在数据库上打开了很多连接。

综上所述，这里有一些与主要问题相关的问题：

1.  在 SQL Server 2005 中有什么方法可以知道连接是因为等待在连接池中使用而打开的，还是因为它们被应用程序使用而打开的？

2.  有人知道好的在线/纸质资源，我可以在其中学习如何使用性能计数器或其他类型的工具来帮助追踪这类问题吗？

3.  如果性能计数器是最好的解决方案，我应该注意哪些变量？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-09-14T16:10:19.750

发现这个线程正在研究类似的问题。我想出了以下 sql 作为调试 SQL Server 中泄漏连接的好方法：

```
SELECT S.spid, login_time, last_batch, status, hostname, program_name, cmd,
(
      select text from sys.dm_exec_sql_text(S.sql_handle)
) as last_sql
FROM sys.sysprocesses S
where dbid > 0
and DB_NAME(dbid) = '<my_database_name>'
and loginame = '<my_application_login>'
order by last_batch asc 
```

这为您提供的是特定数据库和登录上的所有打开连接，*以及在该连接上执行的最后一个 sql*，按执行该 sql 的时间排序。

由于连接池，您不能仅仅依靠周围有很多连接的事实来告诉您有连接泄漏，因为连接池将保留连接，即使它们已从代码中正确关闭。然而，如果你确实有连接泄漏，你会看到一些连接被“冻结”——它们会出现在上面的查询中，并且“last_batch”时间戳永远不会改变。其他连接也会挂起，但每次在它们上运行新的 sql 时，“last_batch”时间戳都会更新。所以效果是冻结的连接将浮动到这个查询的顶部。

如果您有相关应用程序的源代码，那么这会为您提供在孤立连接上执行的最后一条 sql，这对于调试非常有价值。

**注意**'loginame' 的拼写错误（缺少'n'）在`sys.sysprocesses`视图中。上面的说法是正确的。

> loginame nchar(128) 登录名。

[https://docs.microsoft.com/en-us/sql/relational-databases/system-compatibility-views/sys-sysprocesses-transact-sql?view=sql-server-ver15](https://docs.microsoft.com/en-us/sql/relational-databases/system-compatibility-views/sys-sysprocesses-transact-sql?view=sql-server-ver15)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-10-28T19:26:57.333

我遇到了这个问题，发现 SQL Server Profiler 是一个很棒的工具，我在短暂的测试运行中监控了该站点，并注意到正在创建的许多连接 (sp_who) 没有被连接池重用，所以我只打开了 SQL Server Profiler 和然后检查从代码中对 SP 的所有调用是否都跟在“sp_reset_connection”调用之后。如果在新批次开始之前呼叫不存在，那么您只是缺少第一个连接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T15:30:51.313

您始终可以检查来自 web.config 的连接字符串（主要是如果它们激活了连接池，如果它们启用了任何连接限制）。

此外，如果您使用的是 IIS 6，您可以将 Web 应用程序设置为使用单独的应用程序池，并设置其他选项来回收内存和进程。

关于性能计数器，您可以检查垃圾收集器运行了多长时间、应用程序使用了多少内存等。

如果您有权访问 sql server，则可以监视从应用程序建立的连接（为每个已安装的 SQL Server 实例定义了性能计数器）。

[MSDN 杂志](http://msdn.microsoft.com/en-us/magazine/cc163528.aspx)上有一些文章。您也可以使用 SOS 调试库附加到应用程序的进程并手动检查它。

而且，如果您没有源代码，请尝试使用[Reflector](http://www.red-gate.com/products/reflector/)获取应用程序的源代码（它们对于调试非常有用）

@稍后编辑：您也可以在 stackoverflow.com 上查看此[问题](https://stackoverflow.com/questions/163164/iis-connection-pool-interrogationleak-tracking)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T15:34:13.337

[关于（ ADO.NET 性能计数器](http://msdn.microsoft.com/en-us/library/ms254503.aspx)）的 MSDN 参考非常清楚地说明了在分析应用程序时可以查找的内容。您可以使用Windows 内置的[perfmon](http://blog.sqlauthority.com/2008/02/14/sql-server-introduction-to-performance-monitor-how-to-use-perfmon/)应用程序监视计数器。

除此之外，我建议学习 ADO.NET 连接池。如果您真的怀疑他们的代码中存在错误，您可以使用[Red Gate 的 Reflector](http://www.red-gate.com/products/reflector/)（现在免费）来查看它，它将 MSIL 反汇编为 C#。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T15:30:23.203

我会首先查看连接并查看活动时间，看看您是否可以找到保持连接打开的项目。

我想说的是，如果解决方案是重新启动 IIS，您可能还会查看应用程序的内存使用情况，以查看是否存在内存泄漏或确实导致其占用空间增加的东西。

如果打开的连接是一个问题，在活动监视器中，您会看到大量没有活动的连接。

对于性能计数器，您可能会开始查看“SQL Server : General Stats”性能对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-17T02:45:16.777

Todd Denlinger 编写了一个很棒的类[http://www.codeproject.com/KB/database/connectionmonitor.aspx](http://www.codeproject.com/KB/database/connectionmonitor.aspx)，它监视 Sql Server 连接并报告在一段时间内未正确处理的连接。将其连接到您的站点，它会在发生泄漏时通知您。

# visual-studio - Microsoft Access 查询被 Visual Studio 2005 视为函数或视图

> ID：212599
> 
> 赞同：1
> 
> 时间：2008-10-17T15:15:15.513
> 
> 标签：visual-studio, ms-access, dataset

我有一个**Microsoft Access**数据库查询，我试图将它导入**Visual Studio 2005**数据集。

当使用这样的**NZ()**函数形成查询时：

```
SELECT NZ(tblComponentSpecs.nPurchaseCostQuantity, 0) AS Quantity
FROM tblComponentSpecs; 
```

它出现在数据连接中的**功能**列表下。

但是，当使用这样的**IIF()**函数形成查询时：

```
SELECT IIF(tblComponentSpecs.nPurchaseCostQuantity Is Null, 0, nPurchaseCostQuantity) AS Quantity
FROM tblComponentSpecs; 
```

它出现在**视图**列表下。

谁能解释一下为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T13:58:44.650

这可能是因为`Nz()`它是一个 VBA 函数，而`IIF`它是 Jet SQL 的一部分。（是的，在 VBA 中也有一个函数`Iif()`。更多信息在[Allen Browne 的网站上](http://allenbrowne.com/QueryPerfIssue.html)。）

我想那`IIF`是翻译成`CASE WHEN`然后形成一个有效的观点，而`Nz()`不是翻译。

# sql - SQL Server xp_delete_file 不删除文件

> ID：212603
> 
> 赞同：13
> 
> 时间：2008-10-17T15:15:55.760
> 
> 标签：sql, sql-server, maintenance

我正在尝试编写一些 SQL 来删除超过 7 天的“.7z”类型的文件。

这是我得到的不起作用的东西：

```
DECLARE @DateString CHAR(8)
SET @DateString = CONVERT(CHAR(8), DATEADD(d, -7, GETDATE()), 1)
EXECUTE master.dbo.xp_delete_file 0, 
                  N'e:\Database Backups',N'7z', @DateString, 1 
```

我也尝试将'1' a end 更改为'0'。

这将返回“成功”，但文件不会被删除。

我正在使用 SQL Server 2005，标准版，带 SP2

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-09T20:26:51.827

有类似的问题，找到了各种答案。这是我发现的。

您不能使用 xp_delete_file 删除 7z 文件。这是一个未记录的扩展存储过程，它是 SQL 2000 的保留版本。它检查要删除的文件的第一行，以验证它是 SQL 备份文件还是 SQL 报告文件。它不根据文件扩展名进行检查。据我所知，它的预期用途是在维护计划中清理旧备份和计划报告。

这是一个基于 Tomalak 链接的示例，用于删除超过 7 天的备份文件。让人们绊倒的是“sys”模式、文件夹路径中的尾部斜杠以及文件扩展名中没有要查找的点。运行 SQL Server 的用户还需要对该文件夹具有删除权限。

```
DECLARE @DeleteDate datetime
SET @DeleteDate = DateAdd(day, -7, GetDate())

EXECUTE master.sys.xp_delete_file
0, -- FileTypeSelected (0 = FileBackup, 1 = FileReport)
N'D:\SQLbackups\', -- folder path (trailing slash)
N'bak', -- file extension which needs to be deleted (no dot)
@DeleteDate, -- date prior which to delete
1 -- subfolder flag (1 = include files in first subfolder level, 0 = not) 
```

请注意，xp_delete_file 在 SP2 中已损坏，并且不适用于报告文件；[在 [ http://support.microsoft.com/kb/938085]](http://support.microsoft.com/kb/938085])上有一个修补程序。我还没有用 SP3 测试过它。

由于没有记录，xp_delete_file 可能会在 SQL Server 的未来版本中消失或更改。许多站点建议使用 shell 脚本来代替执行删除操作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T16:19:56.223

AFAIK`xp_delete_file`仅删除 SQL Server 2005 识别的文件（备份文件、事务日志等）。也许你可以尝试这样的事情：

```
xp_cmdshell 'del <文件名>'
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T16:50:27.910

本sp只会删除本机sql server备份文件或本机维护报告文件（出于安全考虑）

正如 Smink 建议的那样，您可以使用

```
xp_cmdshell 'del <filename>' 
```

对文件夹具有适当的权限。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-09T14:37:54.430

我发现了这个问题，但该解决方案不适用于我（因为它是 .bak 文件，SQL Server 本身已经制作，作为维护计划的一部分）。

我的问题是安全性。该脚本以启动 SQL Server (MSSQL)（在我的情况下，可能是大多数情况下为“网络服务”）的用户身份运行，该用户无权访问它试图删除文件的文件夹。

所以添加“网络服务”并授予它“修改”帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-13T19:33:02.687

在尝试使用扩展存储过程 xp_delete 解决问题时，我已经阅读了许多不同的方法和解决方案。解决方案是：

1.  配置 SSIS 维护任务时，请确保扩展名中没有句点 (.)。
2.  如果每个数据库备份都存在第一级子文件夹，请务必单击它们。
3.  请务必单击顶部的备份文件。维护任务会检查文件类型。对于数据库备份，我相信它会检查备份文件头。

在我的情况下，以上所有内容都是正确的。网上很少有评论说例程 xp_delete 有问题。

当备份文件没有被删除时，我提取了 SQL 进行维护并从 SSMS 运行它。结果消息是该文件不是 sql server 备份文件。此消息是错误的，因为备份可以成功还原，从而导致数据库正常运行。

用于验证数据库的数据库命令是：

```
RESTORE HEADERONLY FROM DISK = N'<file path\filename>.Bak'
RESTORE VERIFYONLY FROM DISK = N'<file path\filename>.bak' 
```

以上两个命令都表明备份文件是有效的。

接下来，我打开事件查看器，发现连接管理器出现登录错误的消息。这很奇怪，因为我已经使用测试连接按钮验证了连接。这些错误与我创建的任何帐户无关。

事件查看器消息：

> *找不到来自源 MS SQL SERVER 的事件 ID 17052 的描述。引发此事件的组件未安装在本地计算机上，或者安装已损坏。您可以在本地计算机上安装或修复组件。如果事件起源于另一台计算机，则显示信息必须与事件一起保存。

活动中包含以下信息：

> 严重性：16 错误：18456，操作系统：18456 [Microsoft][SQL Server Native Client 11.0][SQL Server]用户 'domain\servername$' 登录失败。*

接下来，我登录到 xp_delete 正常运行的机器。在查看了活动目录并没有找到系统帐户后，我继续使用事件查看器查找类似的消息。在这里，很明显 domain\server$ 的帐户被映射到系统安全性。

下一步是将 xp_delete 工作的数据库安全性与它不工作的数据库进行比较。在 xp_delete 不起作用的数据库中有 2 个在安全性下丢失的登录。缺少的 2 个登录名是：NT AUTHORITY\SYSTEM NT Service\MSSQLSERVER

添加 NT 服务\MSSQLSERVER 后，xp_delete 成功运行。

一种测试方法是使用维护任务来删除单个文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T15:58:37.140

尝试将第一个参数从 0 更改为 1。

这是我刚刚找到的一个小[总结。`xp_delete_file`](http://nikeshikari.blogspot.com/2008/05/tech-mssql-xpdeletefile.html)听起来有点像你对这个程序不走运。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-20T11:29:55.687

我知道这有点老了，但我想与大家分享我的挫败感。我和很多这些帖子都有同样的问题，但似乎没有任何效果。然后我记得我们在数据库上有一个名为 NetLib 的加密层。这意味着备份已加密，因此 xp_delete_file 无法读取标头。我现在在操作系统中使用批处理文件并从代理作业中调用它。希望这可以帮助某人。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-21T12:32:09.000

当您将数据库移动到另一台服务器或在同一台服务器上重新安装 SQL 实例但备份保留在旧目录中时，我们通常会遇到这种情况。例如：您将数据库从服务器 1 移动到服务器 2，但您的服务器具有执行定期备份的维护计划，或者您在服务器 1 上重新安装 SQL 实例并恢复数据库。

在备份情况下，作为信息保存在 msdb 中的集合不再存在，因此不会删除所有已创建的旧备份，因为没有从具有备份集的表派生的失败中检查任何信息。

```
EXECUTE master.sys.xp_delete_file  0, -- FileTypeSelected (0 = FileBackup, 1 = FileReport) 
```

第一个参数表明正在使用 msdb 中的表。

希望这可以帮助某人。

# php - 我可以创建一个可以不带括号调用的 PHP 函数吗？

> ID：212604
> 
> 赞同：29
> 
> 时间：2008-10-17T15:16:03.373
> 
> 标签：php, function

我有一个可以有效替代 print 的函数，我想在不带括号的情况下调用它，就像调用 print 一样。

```
# Replace
print $foo, $bar, "\n";

# with
myprint $foo, $bar, "\n"; 
```

在 Perl 中，您可以使用参数模板创建子例程，如果您将子例程定义为

```
sub myprint(@) { ... } 
```

PHP中有类似的东西吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-17T15:22:23.547

print 不是[变量函数](http://ca.php.net/manual/en/functions.variable-functions.php)

> 因为这是一种语言结构而不是函数，所以不能使用变量函数调用它

和 ：

> 变量函数
> 
> PHP 支持变量函数的概念。这意味着如果一个变量名附加了括号，PHP 将寻找一个与该变量计算结果相同的名称的函数，并尝试执行它。除其他外，这可用于实现回调、函数表等。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-17T15:29:41.817

只需编辑 PHP 代码库并添加新的语言结构即可。

-亚当

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-17T15:19:35.190

不，你不能在 PHP 中做到这一点。Print 实际上不是一个函数，它是一个“语言结构”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-18T20:49:55.007

不，PHP 不允许您这样做。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-03-27T21:50:41.457

我正在寻找一种方法来编写 echoh 来执行以下操作：

```
echoh "hello"; 
```

并得到：

```
'hello<br>\n'. 
```

我想一种解决方案可能是定义一个常量并使用它：

```
<?php
const PHP_BR_EOL = "<br>\n";
echo "Hello" . PHP_BR_EOL;
?> 
```

现在我得到：

```
Hello<br> 
```

我知道它需要更多的输入，但它更符合 PHP 手册中的示例，我使用 gvim 和 omnicomplete 来节省输入。此外，通过 PHP_BR_EOL 进行全局搜索/替换 PHP_EOL 也很容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-05T10:34:10.617

那不能用 PHP 吃饭。您声明的函数必须用括号调用

# java - 我们应该@Override 接口的方法实现吗？

> ID：212614
> 
> 赞同：462
> 
> 时间：2008-10-17T15:18:01.980
> 
> 标签：java, oop, interface, annotations

实现接口方法的方法应该用 注释`@Override`吗？

[注释](http://java.sun.com/javase/6/docs/api/java/lang/Override.html)的[javadoc`Override`](http://java.sun.com/javase/6/docs/api/java/lang/Override.html)说：

> 表示方法声明旨在覆盖超类中的方法声明。如果一个方法被这个注解类型注解但没有覆盖超类方法，编译器需要生成一个错误信息。

我不认为接口在技术上是超类。或者是吗？

`[Question Elaboration](https://stackoverflow.com/revisions/212614/5)`

* * *

## 回答 #1

> 赞同：327
> 
> 时间：2008-10-17T15:21:31.270

您应该尽可能使用@Override。它可以防止犯简单的错误。例子：

```
class C {
    @Override
    public boolean equals(SomeClass obj){
        // code ...
    }
} 
```

这不会编译，因为它没有正确覆盖[`public boolean equals(Object obj)`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#equals(java.lang.Object)).

实现接口（**仅限 1.6 及更高版本**）或覆盖 Super 类的方法的方法也是如此。

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2008-10-17T15:28:03.800

我相信 javac 的行为已经改变 - 1.5 它禁止注释，1.6 它没有。注释提供了额外的编译时检查，因此如果您使用的是 1.6，我会选择它。

* * *

## 回答 #3

> 赞同：79
> 
> 时间：2011-11-25T09:10:12.010

如果方法可用，您应该始终注释方法`@Override`。

在 JDK 5 中，这意味着覆盖超类的方法，在 JDK 6 和 7 中，这意味着覆盖超类的方法，并实现接口的方法。如前所述，原因是它允许编译器在您认为您正在覆盖（或实现）一个方法，但实际上是在定义一个新方法（不同的签名）时捕获错误。

`equals(Object)`vs.例子是一个标准的`equals(YourObject)`例子，但同样的论点可以用于接口实现。

我想注释接口的实现方法不是强制性的原因是JDK 5将此标记为编译错误。如果 JDK 6 强制使用此注释，它将破坏向后兼容性。

我不是 Eclipse 用户，但是在其他 IDE（IntelliJ）中，`@Override`只有在项目设置为 JDK 6+ 项目的情况下，才会在实现接口方法时添加注释。我想Eclipse是相似的。

但是，我更希望看到此用法的不同注释，也许是`@Implements`注释。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-10-17T15:27:35.410

我会一有机会就使用它。请参阅[何时使用 Java 的 @Override 注释以及为什么？](https://stackoverflow.com/questions/94361/when-do-you-use-javas-override-annotation-and-why)

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-06-08T12:01:31.633

如果您正在实现接口中声明的方法（其编译错误）， JDK 5.0 不允许您使用`@Override`注解，但 JDK 6.0 允许使用注解。因此，您可能可以根据您的要求配置您的项目偏好。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-12-19T00:48:57.817

如果**具体**类没有**覆盖**抽象方法，则使用`@Override`实现是一个开放的问题，因为编译器总是会警告您任何未实现的方法**。**在这些情况下，可以提出一个论点，即它降低了可读性——在你的代码上阅读更多的东西，在较小程度上，它被称为`@Override`而不是`@Implement`.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-03-09T02:26:04.270

通过阅读java8中的javadoc，可以在interface Override的声明处找到如下内容：

如果使用此注解类型对方法进行注解，则编译器需要生成错误消息，除非至少满足以下条件之一：

*   该方法确实覆盖或实现了在超类型中声明的方法。
*   该方法的签名与 {@linkplain Object} 中声明的任何公共方法的签名等效。

因此，至少在 java8 中，您应该在接口方法的实现上使用 @Override。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-17T21:16:36.157

覆盖从您自己的类继承的您自己的方法通常不会在使用 ide 进行重构时中断。但是，如果您覆盖从库继承的方法，建议使用它。如果你不这样做，你通常不会在以后的库更改中得到错误，而是一个隐藏得很好的错误。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-12-03T05:50:18.937

这不是JDK的问题。在 Eclipse Helios 中，它允许对实现的接口方法使用 @Override 注解，无论是 JDK 5 还是 6。 至于 Eclipse Galileo，不允许使用 @Override 注解，无论是 JDK 5 还是 6。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-02-02T07:00:07.640

如果实现的类`interface`是一个`abstract`类，`@Override`则有助于确保实现是针对`interface`方法的；即使实现方法签名与;中声明的方法`@Override`不匹配，如果没有 类，也可以正常编译。不匹配的方法将保持未实现状态。@Zhao 引用的 Java 文档`abstract``interface``interface`

> 该方法确实覆盖或实现了在超类型中声明的方法

显然是指一个`abstract`超类；an`interface`不能称为超类型。因此，对于具体类中`@Override`的方法实现是多余的并且不明智。`interface`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-29T00:52:04.290

对我来说，通常这是某些代码需要 Java 6 编译的唯一原因。不确定是否值得。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-03-19T20:47:38.203

包含的问题`@Override`是它会让你认为你忘记调用该`super.theOverridenMethod()`方法，这是*非常令人困惑*的。这应该是非常清楚的。也许 Java 应该提供一个`@Interface`在这里使用。哦，好吧，又是一个半途而废的 Java 特性......

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-09-28T06:57:31.920

在 java 6 及更高版本中，您可以使用`@Override`实现接口的方法。

但是，我认为这没有意义：覆盖意味着您在超类中拥有一个方法，并且您正在子类中实现它。

如果您正在实现一个接口，我认为我们应该使用`@Implement`或其他东西，但不是`@Override`.

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-17T21:19:32.017

`@Override`当您在创建实现接口的类期间告诉它“生成未实现的方法”时，Eclipse 本身将添加注释。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-01-25T20:51:46.207

这可能为时已晚。但我希望这个例子能帮助人们理解为什么`@override`如此重要（对于这样的场景）

```
public interface Restaurant(){
    public boolean getBill();
    public BigDecimal payAmount();
}

public interface Food() extends Restaurant{
    public boolean haveSomeFood();
    public boolean drinkWater();
}

public class Hungry() implements Food{
    public boolean haveSomeFood(){}
    public boolean drinkWater(){}
    public boolean getBill(){}
    public BigDecimal payAmount(){}
} 
```

在上面的例子中，如果我是`Hungry`，我可以`Food`从`Restaurant`. 但是如果我拿出Restaurant的实施，我就不用拿账单也不需要付金额了！！！！

**如何？**

*   该接口`Food`有关键字`extends Restaurant`- 这意味着 Hungry 类也是从接口 Restaurant 实现的。
*   从接口实际覆盖的方法*没有*关键字`@override`
*   因此，如果我删除关键字 extends Restaurant（或者说如果我删除接口 Restaurant，它不会显示任何错误。

如果有`@override`，每当我尝试删除 Restaurant 界面时，它都会显示编译错误。

**注意**：当您实现一个接口时，您可能不知道该接口是否扩展为另一个接口，或者是否可以扩展，或者继承可能会被删除。所以最好使用`@override`关键字

# nant - 用于本机代码环境的 NAnt

> ID：212643
> 
> 赞同：2
> 
> 时间：2008-10-17T15:28:06.577
> 
> 标签：nant

有谁知道关于将 NAnt 用于本机代码构建过程说明的任何好的教程？

* * *

还有其他更适合原生代码环境的构建过程自动化工具吗？

* * *

我们正在开发一个 win32 移动应用程序，它可以作为 CAB 文件在线下载。CAB 文件应包含用户在下载前填写的信息，以便应用程序安装过程将一些用户信息写入设备注册表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T15:38:28.227

我们前段时间尝试使用 NAnt 构建一个大型 VC++ (VS2005) 项目……但没有成功。

问题是无法捕获 Visual Studio 之外的依赖项。IE。修改给定的头文件时应重建哪些 cpp 文件。

我们可以创建将所有文件扔给编译器的 nant 任务，它每次都会重新构建它们。

最后，我们坚持使用调用 devenv 进行构建的 NAnt 任务。这可能在VS2008中有所改变，但我对此表示怀疑......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T15:53:26.573

NAnt 的特点是它可以做任何你想做的事情。因为我没有你想要做什么的完整细节，所以我只能放弃我们用它来做的事情。

我们目前有许多不同的系统连接到自动构建中。您提到了**本机**开发，我将其视为 Win32 或非 .NET 代码。我们的大部分产品都是在非 Microsoft IDE 中编写的。NAnt 仍然是我们的赢家，因为只要您用于开发的 IDE 或工具具有某种命令行界面，通常只需调用[exec 任务](http://nant.sourceforge.net/release/0.85/help/tasks/exec.html)即可使用它们。

在不进一步了解您的努力的更多细节的情况下，我没有专门的教程供您执行此操作。

# java - 哪个 log4j 版本与最新的 OpenCms 7 捆绑在一起？

> ID：212644
> 
> 赞同：0
> 
> 时间：2008-10-17T15:28:07.920
> 
> 标签：java, content-management-system, log4j, opencms

哪个 log4j 版本与最新的 OpenCms 7 捆绑在一起？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-01T05:51:18.717

OpenCms 7.5.3 包括 log4j **1.2.15**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T16:05:20.887

OpenCms [7.0.5](http://www.opencms.org/en/modules/downloads/dl_7.0.5_dist.html)包括 log4j **1.2.14**

# c++ - _ftime / Windows 内部时间如何工作？

> ID：212645
> 
> 赞同：3
> 
> 时间：2008-10-17T15:28:14.283
> 
> 标签：c++, windows, winapi, time

我在 Windows 中发现了一个有趣的问题，它允许我使 Windows 时钟（但不是硬件时钟）快速运行 - 每分钟最多 8 秒。我正在做一些背景研究来弄清楚 Windows 如何计算和更新它的内部时间（而不是它如何与 NTP 服务器同步）。任何人拥有的任何信息或您可以指出我的任何文件将不胜感激！

另外，如果有人知道 _ftime 是如何工作的，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T22:44:31.550

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms724961(VS.85).aspx)对如何处理系统时间给出了非常简短的描述：“系统首次启动时，它会将系统时间设置为基于计算机实时时钟的值，然后定期更新时间。” 另一个有趣的函数是[GetSystemTimeAdjustment](http://msdn.microsoft.com/en-us/library/ms724394.aspx)，它是这样说的：

> TRUE [for lpTimeAdjustmentDisabled] 值表示禁用周期性时间调整。在每次时钟中断时，系统仅将时钟中断之间的间隔添加到时间时钟。但是，该系统可以免费使用其他技术调整其时钟。当进行调整时，此类其他技术可能会导致时钟明显跳动。

最后，关于 _ftime，它似乎是使用[GetSystemTimeAsFileTime](http://msdn.microsoft.com/en-us/library/ms724397(VS.85).aspx)实现的。因此，它将直接包装在与其他任何地方使用的相同的内置时间设施上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-18T01:25:24.640

关于如何`_ftime()`工作：

如果您安装了 Microsoft Visual C++，您可能也安装了 C 运行时源代码。在和`_ftime()`中定义。`%ProgramFiles%\Microsoft Visual Studio <version>\VC\crt\src\ftime.c``ftime64.c`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T18:23:15.333

_ftime 根本不使用 GetSystemTimeAsFileTime。只需阅读源代码。

# sql-server - 从存储过程执行存储过程时如何禁用查询结果？

> ID：212657
> 
> 赞同：24
> 
> 时间：2008-10-17T15:30:40.643
> 
> 标签：sql-server, stored-procedures, cursors

在一个存储过程中，另一个存储过程在游标中被调用。对于每个调用，SQL Management Studio 结果窗口都会显示一个结果。光标循环超过 100 次，此时结果窗口会因错误而放弃。有没有办法可以阻止游标内的存储过程输出任何结果？

```
 WHILE @@FETCH_STATUS = 0
  BEGIN
    EXEC @RC = dbo.NoisyProc
    SELECT @RValue2 = 1 WHERE @@ROWCOUNT = 0
    FETCH NEXT FROM RCursor INTO @RValue1, @RValue2
  END 
```

谢谢！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-17T17:14:21.950

您可以按照以下步骤丢弃 SQL Server Mgmt Studio 2005 中的结果集：

• 在查询窗口中单击鼠标右键
• 选择“查询选项”
• 单击左侧面板树视图中的“结果”“节点”
• 在表格的中心/右侧选中“执行后丢弃结果”

你可以试穿

```
DECLARE @i int
SET @i = 1
WHILE (@i <= 100)
  BEGIN
    SELECT @i as Iteration
    SET @i = @i + 1
  END 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-17T16:19:37.067

您可以将结果插入临时表，然后删除临时表

```
create table #tmp (columns)

while
    ...
    insert into #tmp exec @RC=dbo.NoisyProc
    ...
end
drop table #tmp 
```

否则，您可以修改被调用的 proc 以接受一个标志，告诉它不要输出结果集吗？

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-02-14T15:51:33.463

我知道这个问题很老，但您可以设置`SET NOCOUNT ON`以防止 SP 为每一行输出一条消息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T17:29:05.693

光标不好。如果这意味着您必须使用游标执行基于集合的函数，请不要重用存储的过程代码。以基于集合的方式编写代码可以提高性能。

我想我担心你更关心抑制消息而不是光标中有错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T18:37:36.010

错误可能来自返回的记录集过多，而不是 SP 或游标本身的逻辑缺陷。看这个例子：

```
DECLARE @I INT
SET @I=0
WHILE @I<200 BEGIN
    SELECT * FROM INFORMATION_SCHEMA.TABLES
    SET @I = @I + 1
END 
```

将运行多次（略超过 100 次）然后失败：

> 查询已超出结果网格中可显示的最大结果集数。网格中仅显示前 100 个结果集。

SSMS 对它可以显示给您的记录集的数量有限制。绕过该限制的一种快速方法是按 Ctrl+T（或菜单 Query->Results to->Results to Text）以强制输出为纯文本，而不是类似表格的记录集。您最终会达到另一个限制（结果窗口无法处理无限量的文本输出）但它会更大。

在上面的示例中，将结果更改为文本形式后不会出现错误！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-07-04T14:15:20.683

这个页面很旧，回复很旧。但是，最好的答案并没有被投票给顶部。我想这是因为没有提供足够的解释。

使用 NOCOUNT 设置。每个人都应该看看 NOCOUNT 设置。默认设置为关闭。

即使在新数据库上也普遍更改 this 的默认设置可能会导致某些编码人员\用户感到困惑。我建议使用在更改设置之前捕获设置，然后将其设置回来的方法。这在下面的示例脚本中显示，该脚本演示了 NOCOUNT 设置的使用。

这是一篇好文章。 [https://www.sqlshack.com/set-nocount-on-statement-usage-and-performance-benefits-in-sql-server/](https://www.sqlshack.com/set-nocount-on-statement-usage-and-performance-benefits-in-sql-server/)

```
DROP TABLE IF EXISTS TestTable
GO
CREATE TABLE TestTable (ID INT, TestText VARCHAR (40))
GO

-- Get the Original NOCOUNT setting and save it to @OriginalNoCountSettingIsOn
DECLARE @options INT
SET @options = @@OPTIONS
DECLARE @OriginalNoCountSettingIsOn AS bit
SET @OriginalNoCountSettingIsOn = IIF(( (512 & @@OPTIONS) = 512 ),1,0)

-- Now set NOCOUNT ON to suppress result output returned from INSERTS 
-- Note - this does not affect @@ROWCOUNT values from being set 
SET NOCOUNT ON --  <---- Try running script with SET NOCOUNT ON and SET NOCOUNT OFF to See difference

INSERT INTO TestTable (ID, TestText)
VALUES  (0, 'Test Row 1')

INSERT INTO TestTable (ID, TestText)
VALUES  (0, 'Test Row 2'),
        (0, 'Test Row 3'),
        (0, 'Test Row 4')

INSERT INTO TestTable (ID, TestText)
VALUES  (0, 'Test Row 5')

/*Now set NOCOUNT back to original setting*/
IF @OriginalNoCountSettingIsOn = 1 
BEGIN
    SET NOCOUNT ON
END
ELSE
BEGIN
    SET NOCOUNT OFF
END 

DROP TABLE IF EXISTS TestTable
GO 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T15:33:59.903

地方：

```
SET ROWCOUNT OFF
/* the internal SP */
SET ROWCOUNT ON 
```

将其包裹在内部 SP 周围，或者您甚至可以围绕原始查询中的 SELECT 语句执行此操作，这将阻止结果出现。

# lua - Jabber 的 Lua 库

> ID：212659
> 
> 赞同：4
> 
> 时间：2008-10-17T15:30:52.640
> 
> 标签：lua, xmpp

有人知道 Lua 的 Jabber 库吗？我找到了 AIM 的“Lua 消息库”，虽然我找不到它的下载，但它似乎已被放弃。

对 Lua 来说，类似的东西会有所帮助。

* * *

对不起，我最初没有说明这一点，我的意思是一个“纯 Lua”库。

我对 Verse 很熟悉，但没有选择为这个特定的应用程序构建我自己的 Lua 发行版。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T20:22:22.397

作为后续，我是 Prosody 和 Verse 的作者。我正在更新 Verse 以使用为 Prosody 开发的新代码，因此 Verse 将成为它的“纯 Lua”XMPP 库。

它当然需要依赖于通常的 LuaSocket、LuaExpat 等，但不会像目前那样涉及生成的绑定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T15:41:29.220

[诗句](http://matthewwild.co.uk/projects/verse/verse_doc.xml)。

> Verse 是 Lua 的 Jabber/XMPP 库。它基于 strophe 库的 C 版本。
> 
> verse 的一个方便的功能是默认情况下只实现核心协议。可以“描述”协议的扩展（XEP 或定制协议），然后由任何诗歌应用程序使用。开发人员的意图是在 verse 中包含对尽可能多的 XEP 的支持，在初始化库时，应用程序可以选择加载任意数量的 XEP。

亲切的问候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T12:42:59.400

Prosody是一个 LUA XMPP 服务器：它可以让您领先一步[。](http://prosody.im/ "韵律主页")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-21T10:01:08.157

是的，这里有类似的需求：我想使用内置 LUA 的 VideoLan (VLC) 软件进行 XMPP 消息传递... [http://jpeg.dinauz.org/blog/index.php?post/2010/01 /30/Extensions-in-VLC&pub=1#pr](http://jpeg.dinauz.org/blog/index.php?post/2010/01/30/Extensions-in-VLC&pub=1#pr) ... 所以我期待更新的 Verse 作品！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-23T19:12:16.187

“Pure Lua”没有网络能力。根据定义，您将找到的任何 XMPP 库都需要已编译的扩展。

# informix - 适合初学者的 Informix

> ID：212667
> 
> 赞同：9
> 
> 时间：2008-10-17T15:33:23.650
> 
> 标签：informix

什么是 Informix？我知道它是一个 DBMS，它在学习难度和语法方面与 SQL Server 相比如何？

如何开始学习 Informix？我可以知道“hello world”教程吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T16:19:22.810

IBM Informix Dynamic Server（IDS，通俗地称为 Informix，尽管还有许多其他产品属于 Informix 产品系列）是用于多种用途的优秀 DBMS。它具有出色的数据管理能力，出色的数据复制能力，并且可靠。第一个基于 Informix SQL 的 DBMS 发布于 1985 年，因此它也具有类似于 Oracle、DB2、Ingres、Sybase 的长寿和血统。与所有主要的 DBMS（包括 MS SQL Server）一样，它早于 SQL 标准，因此它的某些部分不符合 SQL 标准，但它通常可以完成合理的工作。它可以在 Unix 和衍生产品（Solaris、AIX、HP-UX、Linux 和 MacOS X）以及 Windows（XP、Vista 等）上运行。

IDS 的最新版本是 11.50（完整版本为 11.50.FC2 或 11.50.UC2）。您可能遇到的其他版本包括 7.31、9.40、10.00 或 11.10。Informix 还提供当前版本 7.25 的 Informix 标准引擎 (Informix SE) 和当前版本 5.20 的 Informix OnLine（IDS 的前身）。客户端工具的主要来源是客户端 SDK，当前版本 3.50。这包括 ESQL/C、ODBC、JDBC、.NET 和各种其他驱动程序。Informix SQL（一种产品，不同于 IDS 中嵌入的 SQL 的 Informix 方言）和 Informix 4GL。

您可以将 DBI 和 DBD::Informix 与 Perl 一起使用。PHP 有一个 PDO_INFORMIX 和一个 PDO_IBM 驱动程序。有一个 Python 驱动程序。Ruby 有一个驱动程序。（古老的）Tcl/Tk 有一个古老的驱动程序。您可以在下面提到的 IIUG 网站上找到 SQLCMD（比同名的 MS SQL Server 程序早了十年多一点）。有一个 I4GL 的开源重新实现，可用作 Aubit4GL。您还可以在[4Js](http://www.4js.com/)和[Querix](http://www.querix.com/)找到 I4GL 衍生产品。[您可以在www.serverstudio.com](http://www.serverstudio.com/)找到 Server Studio Java 版 (SSJE) 。

规范的 Web 站点是[www.ibm.com/software/data/informix](http://www.ibm.com/software/data/informix)，并且[www.informix.com](http://www.informix.com/)也将您带到那里（您通常在 URL 中以 www-01.ibm.com 结束）。您还可以在国际 Informix 用户组网站[www.iiug.org](http://www.iiug.org/)上找到很多信息。会员资格是免费的。IIUG 提供了许多邮件列表，包括informix-list@iiug.com 列表和comp.databases.informix 新闻组之间的网关。

您可以从 IBM 和 IIUG 获得该软件的试用版。

*完全披露：我从 1986 年开始使用 Informix 产品，目前在 IBM 从事 IDS 方面的工作。*

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-10-29T22:12:32.760

从 .NET 开发人员的角度来看，使用 IDS 是一件非常痛苦的事情。

主要原因（IDS 11.5）：

1.  缺乏 IDE 集成或可视化工具
2.  需要其他工具解码的错误消息
3.  无法从 .NET 端链接 SQL
4.  无法在服务器端执行字符串操作功能（或者我的 DBA 告诉我 - DBA 使用 IDS 已有 10 多年的时间
5.  IDS 驱动程序中似乎存在大量与 .NET 和 64 位操作系统有关的已知（未修复）错误
6.  返回的 DataReader 对象上没有列名（这意味着手动映射 - 无法执行 reader['columnname']）

这些只是一个处理 IDS 的项目中的几个项目。我可以看到它很快，我确信它是可靠的，但是如果你不能轻松地针对对象模型进行编码，那么它就毫无意义了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-25T17:35:10.483

对不起，你的陈述一定有点过时了。Informix 11.50（一个非常旧的版本，很快就会停止支持 - 我们现在是 12.10 版本）已经通过 IBM Data Server 驱动程序与 .NET 实体框架兼容。您需要做的就是在安装驱动程序后安装 VSAI 插件。我已经帮助几个 .NET 开发人员对其进行了配置，他们对此感到非常惊讶。

作为前端，您可以使用 Squirrel（开源），它使用 JDBC 连接与多个数据库一起工作。

有关字符串操作的实际版本 (12.10) 手册页，请参见[此处](http://www-01.ibm.com/support/knowledgecenter/api/content/SSGU8G_12.1.0/com.ibm.sqls.doc/ids_sqs_1554.htm)。

Informix 现在能够混合 NoSQL 应用程序，并提供事务支持！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T16:10:55.493

如果您了解 SQL，则可以在基础级别上轻松使用 Informix（如果您是 DBA，那完全是另一回事）。

对我来说，最大的问题是缺乏一个像样的开发 IDE——你可以从[QuantumDB](http://quantum.sourceforge.net/) Eclipse 插件运行基本查询，但你不能使用存储过程（我认为这是 IBM JDBC 驱动程序的问题）。Unix 命令行界面似乎是在那里正确执行任何操作的最简单方法。

有一些技巧（比如知道连接的顺序很重要），但我相信你会在途中**学会这些技巧。**

```
SELECT
  table1_alias.column1 column1_alias, 
  table2_alias.column2 column2_alias 
FROM
  table1 table1_alias,
  table2 table2_alias
WHERE
  table1_alias.column1 = table2_alias.column2
AND
  table1_alias.column3 != 'value' 
AND
 (char_length(table1_alias.column3) > 3
AND
 table1_alias.column3 IS LIKE 'another_value%' 
```

# c++ - Accelerated C++ Practical Programming by Example 中的概念今天仍然成立吗？

> ID：212669
> 
> 赞同：0
> 
> 时间：2008-10-17T15:33:43.960
> 
> 标签：c++, performance, oop, procedural-programming

有人向我推荐了一本书，名为：

Andrew Koenig 和 Barbara E. Moo Addison-Wesley 通过示例加速 C++ 实用编程，2000 ISBN 0-201-70353-X

这本书的基础是面向对象编程在内存方面非常浪费，并且大多数源代码不应该这样编写，而应该使用所有内联函数调用和过程编程。

我的意思是我知道大多数编程书籍的保质期和牛奶差不多，但是如果您编写客户端/服务器应用程序（数据库、服务器和所有）（不是设备驱动程序或视频游戏）真的值得无法维护的代码只是为了提高速度？

或者仅仅让应用程序在客户真正的旧机器上运行是否值得？或者能够在单个机器上运行更多服务器？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-17T15:35:39.213

哇，没有。

现代 C++ 编译器非常出色。大量内存使用更多是设计不佳或内存数据集大的症状。C++ 类所需的开销很小，现在真的不是问题。

面向对象编程是一种编写组件的方式，使得它们可以对与单个概念相关的动作进行逻辑分组（即，“汽车”的所有动作或“猫”的所有动作）。这并不是说它不能被滥用来编写意大利面条对象，但正如他们所说，您可以用任何语言编写 COBOL。

再举一个例子，现在用 C++ 和对象为嵌入式软件平台编写是很有可能并被接受的。轻微的速度下降和内存使用量增加（如果有的话）通过提高可维护性和代码可用性得到了千倍的回报。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-17T15:54:56.477

I haven't read the book, but I have trouble believe that they wrote a book whose "basis ...is that Object Oriented Programming is highly wasteful memory-wise" (Full disclosure: Andy & Barbara are friends of mine).

Andy would never say the OOP is wasteful of memory. He WOULD say that a particular algorithm or technique is wasteful, and might recommend a less OO approach in some cases, but, he would be the first to argue that as a general rule OO designs are no more or less wasteful that any other style of programming.

The argument that OO designs are wasteful largely came from the fact that the EXEs of C++ "hello world" programs tend to be larger that the EXEs of C "hello world" programs. This is mostly because iostreams is larger the printf (but then, iostreams does more).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T16:19:17.473

C++ and OOP are not inefficient per se, but it I have seen many C++ programs perform an operation in a less efficient manner than the equivalent C program. The biggest culprit is often due to lots of small memory allocations occurring due to *new*ing individual objects rather than *malloc*ing a whole bunch of them at once. Similarly, polymorphism and virtual functions are great, but they do incur an overhead that some C++ programmers are not aware of. Piecewise construction of objects can also be a lot slower than one dirty great *memset* of the aforementioned *malloc*ed array of structs.

My guess is that for most applications, on modern computers, this is not really an issue. Given that C++ also includes all of C as a subset, there is also nothing to stop you mixing and matching paradigms as situations demand. Newer heap handlers are also way better than the early MS efforts, and are a bg help.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T16:24:38.150

> The basis of this book is that Object Oriented Programming is highly wasteful memory-wise, and that most source-code should not be written this way, rather that you should use all inline function calls and procedural programming.

I would say this is a somewhat reductive summary of [the book](http://www.acceleratedcpp.com/details/contents.html).

In short, to answer the title question, I would continue to recommend both the book and the concepts included therein.

I suspect that the advice is more along the lines that someone shouldn't create a class just to implement an algorithm, which I would say remains good advice.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T15:49:01.467

**想想开发人员一个小时的成本。**

**想想一个小时的 CPU 时间成本。**

话虽如此，编码面向对象的性能损失绝对可以忽略不计。特别是考虑到当你的程序计算时，它会计算*一些东西*——这可能更多地取决于所使用的算法的性质，而不是是否使用 OOP。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-17T19:02:59.047

Some of the answers are totally missing the point. OOP in C++ has many opportunities to be much faster than their C counterparts. I'll give the example from I think Effective C++ by Scott Meyers, which is that quicksort runs slower than C++ sort because the compiler is able to inline the function call easily in C++ whereas it is unable to do so in C due to quicksort being passed a function pointer.

Additionally, nothing about c++ makes it slow, unlike other languages, any slowness is purely library implementations or algorithm design.

# sql - 如何为数据库用户生成授予数据库表的权限表？

> ID：212681
> 
> 赞同：0
> 
> 时间：2008-10-17T15:37:00.413
> 
> 标签：sql, sql-server, permissions

我有一个包含大约几百个表的 SQL Server 2000 数据库。有几个 SQL 用户帐户可以访问此数据库，但每个帐户都对数据库中的表授予不同的权限。

如何创建脚本来报告授予特定用户的权限。即生成类似的东西：

```
Table      SELECT   DELETE   UPDATE    INSERT    ALTER
-----      ------   ------   ------    ------    -----
Invoices   Yes      No       Yes       Yes       No
Orders     Yes      Yes      Yes       Yes       No
Customers  Yes      No       Yes       Yes       No 
```

等等。今天是星期五，我的 SQL-fu 今天很低，在今天完成之前我还有一百万件事要做，如果有人已经有一个方便的脚本来做这件事，那么我将永远感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T15:46:31.237

我不确定这个过程是否适用于 SQL 2000，它没有得到确切的格式，但它可能会让你部分到达那里，你可以将它转出以获得你的格式。

```
sys.sp_helprotect @Username = 'myUser' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T23:45:05.140

```
Select TABLE_NAME, PRIVILEGE_TYPE
from INFORMATION_SCHEMA.TABLE_PRIVILEGES 
where GRANTEE = @username 
```

这将适用于 SQL Server 2000/2005/2008

# ios - 在 UIImageView 中的两个图像之间转换的最佳方法

> ID：212689
> 
> 赞同：20
> 
> 时间：2008-10-17T15:38:37.743
> 
> 标签：ios, objective-c, uiimageview

我已经实现了一个非常简单的图片查看器，它允许用户浏览一组图像。它们从 Internet 加载，并通过`UIImageView`对象显示在设备上。像这样的东西：

```
UIImage *image = [[UIImage alloc] initWithData:imageData];
[img setImage:image]; 
```

`imageData`是`NSData`我用来从 URL 加载图像内容的实例，并且`img`是`UIImageView`实例。

一切都很好，但是新图像替换了之前显示的图像而没有任何过渡，我想知道是否有一种简单的方法可以进行良好的动画过渡以改善用户体验。

知道怎么做吗？代码示例将不胜感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-08-23T07:46:10.783

我刚刚浏览了你的帖子，并且有完全相同的要求。上述所有解决方案的问题是，您必须将转换逻辑合并到您的控制器中。从某种意义上说，该方法不是模块化的。相反，我编写了 UIImageView 的这个子类：

**TransitionImageView.h 文件：**

```
#import <UIKit/UIKit.h>

@interface TransitionImageView : UIImageView 
{
    UIImageView *mOriginalImageViewContainerView;
    UIImageView *mIntermediateTransitionView;
}
@property (nonatomic, retain) UIImageView *originalImageViewContainerView;
@property (nonatomic, retain) UIImageView *intermediateTransitionView;

#pragma mark -
#pragma mark Animation methods
-(void)setImage:(UIImage *)inNewImage withTransitionAnimation:(BOOL)inAnimation;

@end 
```

**TransitionImageView.m 文件：**

```
#import "TransitionImageView.h"

#define TRANSITION_DURATION 1.0

@implementation TransitionImageView
@synthesize intermediateTransitionView = mIntermediateTransitionView;
@synthesize originalImageViewContainerView = mOriginalImageViewContainerView;

- (id)initWithFrame:(CGRect)frame {
    if ((self = [super initWithFrame:frame])) {
        // Initialization code
    }
    return self;
}

/*
// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect {
    // Drawing code
}
*/

- (void)dealloc 
{
    [self setOriginalImageViewContainerView:nil];
    [self setIntermediateTransitionView:nil];
    [super dealloc];
}

#pragma mark -
#pragma mark Animation methods
-(void)setImage:(UIImage *)inNewImage withTransitionAnimation:(BOOL)inAnimation
{
    if (!inAnimation)
    {
        [self setImage:inNewImage];
    }
    else
    {
        // Create a transparent imageView which will display the transition image.
        CGRect rectForNewView = [self frame];
        rectForNewView.origin = CGPointZero;
        UIImageView *intermediateView = [[UIImageView alloc] initWithFrame:rectForNewView];
        [intermediateView setBackgroundColor:[UIColor clearColor]];
        [intermediateView setContentMode:[self contentMode]];
        [intermediateView setClipsToBounds:[self clipsToBounds]];
        [intermediateView setImage:inNewImage];

        // Create the image view which will contain original imageView's contents:
        UIImageView *originalView = [[UIImageView alloc] initWithFrame:rectForNewView];
        [originalView setBackgroundColor:[UIColor clearColor]];
        [originalView setContentMode:[self contentMode]];
        [originalView setClipsToBounds:[self clipsToBounds]];
        [originalView setImage:[self image]];

        // Remove image from the main imageView and add the originalView as subView to mainView:
        [self setImage:nil];
        [self addSubview:originalView];

        // Add the transparent imageView as subview whose dimensions are same as the view which holds it.
        [self addSubview:intermediateView];

        // Set alpha value to 0 initially:
        [intermediateView setAlpha:0.0];
        [originalView setAlpha:1.0];
        [self setIntermediateTransitionView:intermediateView];
        [self setOriginalImageViewContainerView:originalView];
        [intermediateView release];
        [originalView release];

        // Begin animations:
        [UIView beginAnimations:@"ImageViewTransitions" context:nil];
        [UIView setAnimationDuration:(double)TRANSITION_DURATION];
        [UIView setAnimationDelegate:self];
        [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];
        [UIView setAnimationDidStopSelector:@selector(animationDidStop:finished:context:)];
        [[self intermediateTransitionView] setAlpha:1.0];
        [[self originalImageViewContainerView] setAlpha:0.0];
        [UIView commitAnimations];
    }
}

-(void)animationDidStop:(NSString *)animationID finished:(NSNumber *)finished context:(void *)context
{
    // Reset the alpha of the main imageView
    [self setAlpha:1.0];

    // Set the image to the main imageView:
    [self setImage:[[self intermediateTransitionView] image]];

    [[self intermediateTransitionView] removeFromSuperview];
    [self setIntermediateTransitionView:nil];

    [[self originalImageViewContainerView] removeFromSuperview];
    [self setOriginalImageViewContainerView:nil];
}

@end 
```

你甚至可以重写`-setImage`UIImageView 的方法并调用我的`-setImage:withTransitionAnimation:`方法。如果这样做，请确保您调用`[super setImage:]`而不是`[self setImage:]`在方法中调用，`-setImage:withTransitionAnimation:`这样它就不会以无限递归调用结束！

-拉吉

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-04-16T19:30:26.557

```
[UIView 
    animateWithDuration:0.2 
    delay:0 
    options:UIViewAnimationCurveEaseOut
    animations:^{
        self.view0.alpha = 0;
        self.view1.alpha = 1;
    }
    completion:^(BOOL finished){
        view0.hidden = YES;
    }
]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T18:37:17.990

诀窍是你制作了两个 UIImageView 实例。你在调用 UIView +beginAnimations 和 +commitAnimations 之间交换它们。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-06-11T08:49:40.763

请检查答案。我想你正在寻找这个：

```
imgvw.image=[UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:@"Your Image name as string"]]];
CATransition *transition = [CATransition animation];
transition.duration = 1.0f;
transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
transition.type = kCATransitionFade;
[imgvw.layer addAnimation:transition forKey:nil]; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-09T18:18:42.543

与已解释的内容没有什么不同，但在代码中，这些是可用的转换：

```
typedef enum {
        UIViewAnimationTransitionNone,
        UIViewAnimationTransitionFlipFromLeft,
        UIViewAnimationTransitionFlipFromRight,
        UIViewAnimationTransitionCurlUp,
        UIViewAnimationTransitionCurlDown,
    } UIViewAnimationTransition; 
```

**代码** *（把它放在像 touchesEnded 这样的回调中）*：

```
CGContextRef context = UIGraphicsGetCurrentContext();
[UIView beginAnimations:nil context:context];

[UIView setAnimationTransition: UIViewAnimationTransitionFlipFromLeft forView:[self superview] cache:YES];

// -- These don't work on the simulator and the curl up will turn into a fade -- //
//[UIView setAnimationTransition: UIViewAnimationTransitionCurlUp forView:[self superview] cache:YES];
//[UIView setAnimationTransition: UIViewAnimationTransitionCurlDown forView:[self superview] cache:YES];

[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
[UIView setAnimationDuration:1.0];

// Below assumes you have two subviews that you're trying to transition between
[[self superview] exchangeSubviewAtIndex:0 withSubviewAtIndex:1];
[UIView commitAnimations]; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-21T20:39:31.597

有几种方法可以做到这一点，我同意 Ben View Transitions 就是一个很好的例子。如果您正在寻找简单的全屏转换，我会考虑启动一个新的实用程序并查看`RootViewController.m`. 尝试切换`UIViewAnimationTransitionFlipFromLeft`and `UIViewAnimationTransitionFlipFromRight`to`UIViewAnimationTransitionCurlUp`以`UIViewAnimationTransitionCurlDown`获得非常好的过渡效果（这仅适用于设备）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-09T01:51:47.617

这就是我所做的：褪色。我放置了另一个具有相同 UIImage 和维度的 UIImageView，称为 tmp。我替换了基本 UIImageView 的 UIImage。然后我把正确的图像放在底座上（仍然被 tmp 覆盖）。

下一步是 - 将 tmp 的 alpha 设置为零， - 根据基础的高度将基础 UIImageView 拉伸到新 UIImage 的正确比例。

这是代码：

```
 UIImage *img = [params objectAtIndex:0]; // the right image
UIImageView *view = [params objectAtIndex:1]; // the base

UIImageView *tmp = [[UIImageView alloc] initWithImage:view.image]; // the one which will use to fade
tmp.frame = CGRectMake(0, 0, view.frame.size.width, view.frame.size.height);
[view addSubview:tmp];

view.image = img;
float r = img.size.width / img.size.height;
float h = view.frame.size.height;
float w = h * r;
float x = view.center.x - w/2;
float y = view.frame.origin.y;

[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:1.0];

tmp.alpha = 0;
view.frame = CGRectMake(x, y, w, h);

[UIView commitAnimations];

[tmp performSelector:@selector(removeFromSuperview) withObject:nil afterDelay:1.5];
[tmp performSelector:@selector(release) withObject:nil afterDelay:2]; 
```

# java - 如何减少 Java 日志记录样板代码？

> ID：212697
> 
> 赞同：15
> 
> 时间：2008-10-17T15:41:52.760
> 
> 标签：java, logging

每个想要使用 java.util.logging 的类通常都需要像这样声明一个记录器：

```
public class MyClass {
    private static Logger _log = Logger.getLogger(MyClass.class.getName());
} 
```

你如何避免这个 MyClass.class.getName() 样板代码？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-17T16:41:43.950

我在 Eclipse 中设置了一个模板，因此我只需键入声明的一部分，然后 Eclipse 会自动为我完成其余部分。

```
${:import(org.apache.log4j.Logger)}
private final static Logger log = Logger.getLogger(${enclosing_type}.class);
${cursor} 
```

因此，我只需键入`logger`、 hit和`Ctrl+Space`，然后`Enter`Eclipse 会为我填写其余部分并添加导入声明。

这不会减少样板代码的数量，但至少会减少击键的数量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T17:05:50.203

看看在你的代码中使用切入点

自从将它们与弹簧一起使用后，我就再也没有回头。

这是一篇关于使用 AspectJ 的文章

[http://www.developer.com/java/other/article.php/3109831](http://www.developer.com/java/other/article.php/3109831)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T17:51:58.800

根据您的日志记录需求，您可以创建一个带有静态方法的“LoggingService”类，用于记录到各种“通道”。我发现我真的不需要将日志记录粒度降至类级别。您可以为记录器命名最适合您的记录器。几年来，我们一直在大型企业应用程序中使用它，粒度对我们来说确实不是问题。

日志服务在静态初始化块中初始化......所以要记录一条消息：

LoggingService.logError("blah");

每个类中没有样板代码。

这是一个示例日志服务：

```
public class LoggingService {

/**
 * A log for informational messages.
 */
static private Logger infoLog;

/**
 * A log for data access messages.
 */
static private Logger dataAccessLog;

/**
 * A log for debug messages.
 */
static private Logger debugLog;

/**
 * A log for error messages.
 */
static private Logger errorLog;

/**
 * A log for all XML related messages.
 */
static private Logger xmlLog;

/**
 * A log for all trace messages.
 */
static private Logger traceLog;

/**
 * A log for all warning messages.
 */
static private Logger warnLog;

static {

    //This is the bootstrap for the logging service.
    //Setup each logger
    infoLog = Logger.getLogger("com.company.logging.info");
    dataAccessLog = Logger.getLogger("com.company.logging.dataaccess");
    debugLog = Logger.getLogger("com.company.logging.debug");
    errorLog = Logger.getLogger("com.company.logging.error");
    xmlLog = Logger.getLogger("com.company.logging.xml");
    traceLog = Logger.getLogger("com.company.logging.trace");
    warnLog = Logger.getLogger("com.company.logging.warn");

    // This must be set so isErrorEnabled() will work.
    errorLog.setLevel(Level.ERROR);
    warnLog.setLevel(Level.WARN);
}
static public void logDataAccess(String pMessage) {
    dataAccessLog.info(pMessage);
}

static public void logInfo(String pMessage) {
    infoLog.info(pMessage);
}

static public void logDebug(String pMessage) {
    debugLog.debug(pMessage);
}

static public void logTrace(String pMessage) {
    traceLog.debug(pMessage);
}

static public void logWarn(String pMessage) {
    warnLog.warn(pMessage);
}

static public void logError(String pMessage) {
    errorLog.error(pMessage);
}

static public void logError(String pMessage, Throwable pThrowable) {
    errorLog.error(pMessage, pThrowable);
}

static public void logXml(String pMessage, XmlBean pContainer) {

    if (!xmlLog.isInfoEnabled()) return;

    xmlLog.info(pMessage + " : " + JAXBHelper.marshal(pContainer));
}

static public boolean isInfoEnabled() {
    return infoLog.isInfoEnabled();
}

static public boolean isDataAccessEnabled() {
    return dataAccessLog.isInfoEnabled();
}

static public boolean isDebugEnabled() {
    return debugLog.isDebugEnabled();
}

static public boolean isErrorEnabled() {
    if (errorLog.getLevel().toInt() >= Level.ERROR_INT) {
        return true;
    }
    return false;
}

static public boolean isTraceEnabled() {
    return traceLog.isDebugEnabled();
}

static public boolean isXmlEnabled() {
    return xmlLog.isInfoEnabled();
}

static public boolean isWarnEnabled() {
    return warnLog.isEnabledFor(Level.WARN);
} 
```

}

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T10:28:06.573

实际上，使用类名作为记录器名称的常见做法比任何事情都懒惰。

更好的做法是按任务上下文命名记录器。这涉及到更多的思考过程和计划，但最终，结果是更有意义的粒度，您可以在其中切换实际任务而不是类的日志记录级别。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T15:53:53.920

如果您使用 1.2+ 版本的 log4j，则不需要 getName()，getLogger() 接受 Class 参数。但至于其余部分，如果您希望每个类都有一个具有自己类别的静态日志成员，则没有任何办法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-17T15:58:09.870

如果您使用包级记录器，并为每个包添加样板类，您可以编写：

```
private static final Logger log = Logs.log; 
```

有一些技巧可以读取调用者的类名（实际上日志实现有一个技巧可以检测当前方法），但我不建议这样做。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-05-26T08:07:05.720

您可以使用 lombok 减少该代码和许多其他样板代码

[https://github.com/rzwitserloot/lombok](https://github.com/rzwitserloot/lombok)

```
 @Slf4j
     public class LogExample {
 } 
```

将会

```
 public class LogExample {
     private static final org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger(LogExample.class);
 } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T15:56:11.060

您可以稍微简化一下，因为 getLogger 被重载，也只是上课。像这样：

```
public class MyClass {
    private static Logger _log = Logger.getLogger(MyClass.class);
} 
```

Logger 可以随心所欲地灵活或不灵活。您可以为每个类获取一个新的记录器，如上面的示例所示，并拥有一个记录器层次结构，您可以在其中按类控制和打开/关闭日志记录。或者，如果您的项目很小或原型等，您可以只调用 Logger.getRootLogger() - 但您将失去微调您记录和不记录的内容的灵活性。你可以有一个记录器所在的基类，并让每个人都调用它，但同样，你失去了一些灵活性：

```
public class MyBase {
     protected static Logger _log = Logger.getLogger(MyClass.class);
}

public class MyClass extends MyBase {
    ....
    _log.info("Stuff....");
} 
```

最重要的是，如果您想保留在项目后期微调配置日志的能力（只为一个类打开更精细的调试），那么您可能必须在每个类中坚持使用样板。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-17T23:01:08.613

看看[SLF4J](http://www.slf4j.org/manual.html)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-10-17T15:57:47.017

如果您使记录器成为非静态的，您至少可以继承它：

```
public class SomeBaseClass
{
    protected Logger logger = Logger.getLogger(getClass());
}

public class SubClass extends SomeBaseClass
{
    public void doit() { logger.debug("doit!!!!"); }
} 
```

这就是我一直这样做的方式。

# css - CSS清除是如何真正起作用的？

> ID：212705
> 
> 赞同：17
> 
> 时间：2008-10-17T15:44:30.477
> 
> 标签：css, layout

我有一个`<div>`我想自己上线的。根据[W3Schools](http://www.w3schools.com/Css/pr_class_clear.asp)，这条规则：

```
div.foo {
  clear: both;
} 
```

...应该是这个意思：

> “左侧或右侧都不允许浮动元素。”

但是，如果我将两个元素向左浮动`<div>`，并将上面的规则应用于第一个元素，则第二个元素不会让步。

另一方面，如果我申请`"clear: left"`第二个`<div>`，它会向下移动到下一行。这是我的正常做法，但我不明白为什么我必须这样做。

上面的 W3Schools 描述是否表述不佳，还是我遗漏了什么？**清除规则是否只能移动应用它的元素？**

## 回答

感谢 Michael S 和 John D 的良好解释。Warren 指出[CSS2 spec](http://www.w3.org/TR/REC-CSS2)，这就是我找到这个答案的地方（强调我的）：

> 此属性指示元素框的哪些边可能不与 **较早的**浮动框相邻。

所以：`clear`只影响应用它的元素的位置，相对于出现在它之前的元素的代码。

令人失望的是我不能告诉我`<div>`让其他 div 向下移动，但它们是休息时间。:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-17T15:48:06.133

当您将 clear 应用于元素时，它将移动该元素，使其左侧或右侧没有项目。它不会重新定位任何其他元素，它只是将元素移动到周围没有任何东西的位置。

**编辑**

已清除项目上方的项目不会移动，元素下方的项目可以移动。还要注意评论中的附加评论

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T15:51:40.743

您的 CSS 正在“正确”解析。你的第二个 div 仍然向左浮动，所以即使你清除了第一个，如果第二个在宽度方向上有空间，它会在它可以的最高点向左浮动。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T16:20:13.027

是的，清除只会移动应用它的元素。但是，根据元素是“流入”还是流出，结果会有所不同。我想这让你感到困惑。

如果元素处于流动状态，则清除会将其与随后的所有内容一起向下移动。将其视为向下移动当前笔位置（应放置下一个元素的位置）。这种行为很容易理解。

如果元素不流动，如示例中的浮动，则仅移动元素，笔位置保持在同一位置，除非其他规则使它们移动。例如，一个浮点数不允许在前一个浮点数之上开始。

还有一个边缘崩溃的混乱问题。清理打断了他们，有时以一种不直观的方式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T15:53:33.330

您将 clear 应用于您想要在新行上的元素。您使用的清除取决于您不希望它接触的元素。如果您希望图像 B 在新行上并且不触摸图像 A（可以说是浮动：左），您会将图像 B 设置为 {clear: left} 而不是您自然认为的右清晰。您正在清除前一个元素的浮动。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T15:49:11.917

我通常会为此效果执行以下操作：

```
float: left;
clear: right; 
```

我不知道它是否仅适用于它所应用的元素，尽管它是有道理的。

不过，规格可在此处获得：http: [//www.w3.org/TR/REC-CSS2/](http://www.w3.org/TR/REC-CSS2/)

# embedded - 如何在 C 中重置 PIC18？

> ID：212706
> 
> 赞同：5
> 
> 时间：2008-10-17T15:44:53.610
> 
> 标签：embedded, pic, microchip

使用 C 代码和 HiTech Pic18 C 编译器重置 PIC18 的最佳方法是什么？

编辑：

我正在使用

```
void reset()
{
#asm 
  reset
#endasm
} 
```

但必须有更好的方法

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-20T15:43:32.473

The compilers usually have their own reset() function built in, but it just does exactly what your function does, and the actual name may vary from compiler to compiler.

You are already doing it the best possible way.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-29T18:45:09.860

Your answer is the best way I know of. The key is that you have the assembly instruction inside a function call, all by itself. The compiler will not optimize a function that has inline assembly in it, so if you include the reset instruction inline to a very large function, the compiler will not optimize any of the code in that function. You have avoided this by putting Reset in its own function. The code in this function won't be optimized, but who cares, since it is such a small function.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T18:51:24.577

这里有一个[常见问题解答](http://www.microchipc.com/HiTechCFAQ/index.php#_Toc475127553)。

问：如何重置微信？

> 一种方法是将所有变量重置为其默认值，如 PIC 手册中所列。然后，使用汇编语言跳转到微中的0x0000位置。
> 
> #asm ljmp 0x0000
> 
> #endasm
> 
> 这使用起来非常安全，即使在中断或过程中调用也是如此。PIC 16x 系列微控制器有 8 个堆栈级别。每次调用过程时，返回地址都会用完一层堆栈。它是一个循环缓冲区，因此即使 micro 有 7 个程序级深并且在调用复位时处于中断状态，这也是堆栈缓冲区的新开始，并且 micro 将照常继续。
> 
> Another way is to set watchdog the timer when the chip is programmed, and use CLRWDT() instructions all through the code. When you want the micro to reset, stop clearing the watchdog bit and the micro will reset after around 18ms to 2 seconds depending on the prescaler.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-12-22T01:25:35.320

As [Mike](https://stackoverflow.com/users/9061264/mike) has edited this original question from 11 years ago it seems doubtful the Original Poster needs a comprehensive answer. In fact the OP seems to have asked about or responded on just 2 topics regarding microcontrollers in the past 9 years.

Given all that it may be helpful to look at some of the ways the PIC18F controller can be caused to begin execution from the reset vector with code that compiles with Hi-Tech C or XC8 as it is now called by Microchip.

This code has been tested using MPLABX v5.25, XC8 v2.05 and the PIC18F45K20 controller.

```
/*
 * File:     main.c
 * Author:   dan1138
 * Target:   PIC18F45K20
 * Compiler: XC8 v2.05
 *
 *                                                             PIC18F46K20
 *                 +---------+                 +---------+                 +----------+                 +----------+
 *           <>  1 : RC7/RX  :           -- 12 : NC      :           <> 23 : RA4      :           -- 34 : NC       :
 *      LED4 <>  2 : RD4     :           -- 13 : NC      :           <> 24 : RA5      : 32.768KHz -> 35 : RC1/SOSI :
 *      LED5 <>  3 : RD5     :           <> 14 : RB4     :           <> 25 : RE0      :           <> 36 : RC2      :
 *      LED6 <>  4 : RD6     :           <> 15 : RB5/PGM :           <> 26 : RE1      :           <> 37 : RC3      :
 *       GND ->  5 : VSS     :       PGC <> 16 : RB6/PGC :           <> 27 : RE2      :      LED0 <> 38 : RD0      :
 *       3v3 ->  6 : VDD     :       PGD <> 17 : RB7/PGD :       3v3 -> 28 : VDD      :      LED1 <> 39 : RD1      :
 *       SW1 <>  7 : RB0/INT :       VPP -> 18 : RE3/VPP :       GND -> 29 : VSS      :      LED2 <> 40 : RD2      :
 *           <>  8 : RB1     :       POT <> 19 : RA0/AN0 :      4MHz -> 30 : RA7/OSC1 :      LED3 <> 41 : RD3      :
 *           <>  9 : RB2     :           <> 20 : RA1     :      4MHz <- 31 : RA6/OSC2 :           <> 42 : RC4      :
 *           <> 10 : RB3     :           <> 21 : RA2     : 32.767KHz <- 32 : RC0/SOSO :           <> 43 : RC5      :
 *      LED7 <> 11 : RD7     :           <> 22 : RA3     :           -- 33 : NC       :           <> 44 : RC6/TX   :
 *                 +---------+                 +---------+                 +----------+                 +----------+
 *                                                              TQFP-44
 *
 *
 * Created on December 21, 2019, 2:26 PM
 */

/* Target specific configuration words */
#pragma config FOSC = INTIO67, FCMEN = OFF
#pragma config IESO = OFF, PWRT = OFF, BOREN = SBORDIS, BORV = 18
#pragma config WDTEN = OFF, WDTPS = 32768, CCP2MX = PORTC, PBADEN = OFF
#pragma config LPT1OSC = ON, HFOFST = ON
#pragma config MCLRE = ON, STVREN = ON, LVP = OFF, XINST = OFF
#pragma config CP0 = OFF, CP1 = OFF, CP2 = OFF, CP3 = OFF
#pragma config CPB = OFF, CPD = OFF
#pragma config WRT0 = OFF, WRT1 = OFF, WRT2 = OFF, WRT3 = OFF
#pragma config WRTC = OFF, WRTB = OFF, WRTD = OFF
#pragma config EBTR0 = OFF, EBTR1 = OFF, EBTR2 = OFF, EBTR3 = OFF
#pragma config EBTRB = OFF

/* Target specific definitions for special function registers */
#include <xc.h>

/* Declare the system oscillator frequency setup by the code */
#define _XTAL_FREQ (4000000UL)

/* reset instruction */
void ResetMethod_1(void)
{
    asm(" reset");
}

/* long jump to absolute address zero */
void ResetMethod_2(void)
{
    INTCON = 0;
    asm(" pop\n ljmp 0");
}

/* return to absolute address zero */
void ResetMethod_3(void)
{
    INTCON = 0;
    asm(" clrf TOSU\n clrf TOSH\n clrf TOSL\n");
}

/* provoke stackoverflow reset */
void ResetMethod_4(void)
{
    INTCON = 0;
    while (1) 
    {
        asm(" push\n");
    }
}

/* provoke stackunderflow reset */
void ResetMethod_5(void)
{
    INTCON = 0;
    STKPTR = 0;
}

/* clear the program counter */
void ResetMethod_6(void)
{
    INTCON = 0;
    asm(" clrf PCLATU\n clrf PCLATH\n clrf PCL\n");
}

void main(void)
{
    INTCON = 0;             /* Disable all interrupt sources */
    PIE1 = 0;
    PIE2 = 0;
    INTCON3bits.INT1IE = 0;
    INTCON3bits.INT2IE = 0;

    OSCCON = 0x50;          /* set internal oscillator to 4MHz */
    OSCTUNEbits.TUN = 0;    /* use factory calibration of internal oscillator */
    ANSEL = 0;
    ANSELH = 0;

    if(!RCONbits.nPOR)
    {
        RCONbits.nPOR = 1;
        LATD = 0;
    }

    TRISD = 0;
    /*
     * Application loop
     */
    while(1)
    {
        __delay_ms(500);
        if (LATDbits.LD0 == 0)
        {
            LATDbits.LD0 = 1;
            ResetMethod_1();
        }

        if (LATDbits.LD1 == 0)
        {
            LATDbits.LD1 = 1;
            ResetMethod_2();
        }

        if (LATDbits.LD2 == 0)
        {
            LATDbits.LD2 = 1;
            ResetMethod_3();
        }

        if (LATDbits.LD3 == 0)
        {
            LATDbits.LD3 = 1;
            ResetMethod_4();
        }

        if (LATDbits.LD4 == 0)
        {
            LATDbits.LD4 = 1;
            ResetMethod_5();
        }

        if (LATDbits.LD5 == 0)
        {
            LATDbits.LD5 = 1;
            ResetMethod_6();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T16:17:34.467

除非编译器供应商的运行时库定义了一个库函数（如果这样的库甚至存在于微控制器世界中......但它应该存在），那么没有。C 本身当然不会帮助你，做“重置”对于 C 来说是一个太多特定于平台的问题，无法涵盖它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T17:07:42.523

我使用 ccsinfo.com 编译器，它有一个类似的 API 调用来重置 PIC，但我认为编译器的解决方案会做正确的事情。

# svn - Subversion：合并时“目标路径不存在”是什么意思？

> ID：212713
> 
> 赞同：9
> 
> 时间：2008-10-17T15:47:17.333
> 
> 标签：svn, merge

使用颠覆 1.5 我有分支 B，它是从分支 A 分支出来的。在两个分支中完成工作后，我将 A 中的更改合并到 B 中（`svn merge http://path/to/A`在 B 的工作目录中使用）并获取`svn: Target path does not exist`. 这是什么意思？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T20:40:05.030

这意味着分支 A 中的一个文件发生了更改，Subversion 试图合并到分支 B 中，但该文件在分支 B 中不存在，因此它无处合并更改。例如：

*   创建分支 B
*   更改 A/自述文件
*   删除 B/README
*   合并 A -> B

现在 README 中的更改无法应用于分支 B，因为该文件已在那里删除。

编辑：这将导致 Subversion 1.6 中的**树冲突**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-10T00:08:58.347

即使没有不兼容的更改，我也会在 svn 1.5.4 中收到此错误。升级到 1.5.5 为我修复了它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T18:05:29.063

我遇到了这个问题，因为我的树干和分支有一段奇怪的历史。

像这样：

```
 /---------\
trunk -------+---+       +---\
                  \-----------BOOM! 
```

合并主干-> 分支不起作用。

合并分支 - > 主干虽然有效。

```
 /---------\
trunk -------+---+       +---+-----
                  \---------/ 
```

可能是因为树干对他们共享的最后一个祖先有更好的信息。

就我而言，我还没有准备好合并回主干，但我能够从主干创建一个新分支并在那里合并我的旧分支。

```
 /---------\
trunk -------+---+       +---+-------
                  \           \---+--
                   \-------------/ 
```

# python - 在 Windows 上的 Python 中打开设备的句柄

> ID：212715
> 
> 赞同：13
> 
> 时间：2008-10-17T15:47:40.063
> 
> 标签：python, windows, device

我正在尝试使用需要打开“文件”才能访问受保护内存的 giveio.sys 驱动程序。我正在查看 WinAVR/AVRdude 中使用以下语法的 C 示例：

```
 #define DRIVERNAME      "\\\\.\\giveio"
 HANDLE h = CreateFile(DRIVERNAME,
            GENERIC_READ,
            0,
            NULL,
            OPEN_EXISTING,
            FILE_ATTRIBUTE_NORMAL,
            NULL); 
```

但这似乎在 Python 中不起作用 - 我只是收到“指定的路径无效”错误，对于两者

```
f = os.open("\\\\.\\giveio", os.O_RDONLY) 
```

和

```
f = os.open("//./giveio", os.O_RDONLY) 
```

为什么这不做同样的事情？

**编辑**以希望减少想法的混乱（感谢威尔）。我确实通过 AVRdude 附带的批处理文件验证了设备驱动程序是否正在运行。

**进一步编辑**以澄清 SamB 的赏金。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-20T14:07:25.040

解决方案：在 python 中你必须使用 win32file.CreateFile() 而不是 open()。感谢大家告诉我我想要做什么，它帮助我找到了答案！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-18T10:32:02.493

I don't know anything about Python, but I do know a bit about drivers. You're not trying to 'open a file in kernel space' at all - you're just trying to open a handle to a device which happens to be made to look a bit like opening a file.

CreateFile is a user-mode function, and everything you're doing here is user-mode, not kernel mode.

As xenon says, your call may be failing because you haven't loaded the driver yet, or because whatever Python call you're using to do the CreateFile is not passing the write parameters in.

I've never used giveio.sys myself, but personally I would establish that it was loaded correctly by using 'C' or C++ (or some pre-written app) before I tried to get it working via Python.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T22:38:41.403

至少可以说，您的问题非常令人困惑。

1>您粘贴的代码使用了一个技巧来使用它的“DOSNAME”与驱动程序进行通信，即

```
\\.\DRIVERNAME 
```

2> 您是否创建并加载了“giveio”驱动程序？

驱动程序处理这个调用的原因是因为这个

[http://msdn.microsoft.com/en-us/library/ms806162.aspx](http://msdn.microsoft.com/en-us/library/ms806162.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-18T07:54:21.453

我不确定这是否可能。[作为替代方案，您可以编写一个 C/C++ 程序来为您完成所有内核空间工作，并通过子进程模块](http://www.python.org/doc/2.5.2/lib/module-subprocess.html)或[Python C/C++ 绑定](http://www.language-binding.net/)（以及[另一个链接](http://wiki.cacr.caltech.edu/danse/index.php/Writing_C_extensions_for_Python)）在 Python 中与它交互。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-05-05T01:59:00.137

在我看来，您在问为什么 os.open 并不神奇地等于使用一组非常具体的参数调用 CreateFile。Kostya 的回答很实用，因为它告诉您可以使用 Win32 python 绑定直接调用 Win32 API 的 CreateFile。

除了直接执行 CreateFile/readFile/writeFile IO 之外的任何操作都将在顶部引入另一层（python 文件对象及其行为），将您限制为 os.open 支持的参数。os.open 创建一个 python 文件对象，这不是完全相同的东西，并且不打算提供所有 Win32 CreateFile 的选项。

这意味着，例如，不能保证 GENERIC_READ、OPEN_EXISTING 或 FILE_ATTRIBUTE_NORMAL 的精确模拟存在。

我最好的猜测是 os.open 并不是为了取代对 CreateFile 的直接调用，因为你使用它的目的很奇怪。

如果你会读 C，为什么不打开 python 的源代码并阅读 os.open 的实现。如果您真的必须通过 os.open，您将找出要传递给它的参数，以便最后，os.open 的实现（在 C 中）使用上面正确的参数调用 Win32 API 中的 CreateFile。所有这些看起来更像是工作，而不仅仅是使用 Kostya 的建议。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-03T14:11:26.537

有两种方法可以做到这一点。

第一种方法是使用 win32 python 绑定

```
h = win32file.CreateFile 
```

或使用 ctypes

# c# - 何时使用 TestFixtureSetUp 属性而不是默认构造函数？

> ID：212718
> 
> 赞同：78
> 
> 时间：2008-10-17T15:48:41.747
> 
> 标签：c#, unit-testing, nunit

NUnit 文档没有告诉我何时使用带有 a 的方法`TestFixtureSetup`以及何时在构造函数中进行设置。

```
public class MyTest
{
    private MyClass myClass;

    public MyTest()
    {
        myClass = new MyClass();
    }

    [TestFixtureSetUp]
    public void Init()
    {
        myClass = new MyClass();
    }
} 
```

关于与默认构造函数有什么好的/坏的做法，`TestFixtureSetup`或者没有任何区别？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-10-17T16:02:41.250

为什么需要在测试类中使用构造函数？

我使用`[SetUp]`并`[TearDown]`标记了每次测试之前和之后要执行的代码的方法，并且类似地`[TestFixtureSetUp]`标记`[TestFixtureTearDown]`了在夹具中的所有测试运行之前和之后只执行一次代码的方法。

我想您可能可以将 替换`[TestFixtureSetUp]`为构造函数（尽管我没有尝试过），但这似乎只是违反了标记方法提供的明确约定。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-17T18:00:17.910

我认为这是 nUnit 团队尚未解决的问题之一。然而，有一个优秀的[xUnit 项目](http://www.codeplex.com/xunit)看到了这个确切的问题，并认为构造函数是用于[测试夹具初始化](http://www.codeplex.com/xunit/Wiki/View.aspx?title=Comparisons&referringTitle=Home#attributes)的好东西。

对于 nunit，我在这种情况下的最佳实践是使用文档中描述的`TestFixtureSetUp`、`TestFixtureTearDown`、`SetUp`和方法。`TearDown`

I think it also helps me when I don't think of an nUnit test fixture as a normal class, even though you are defining it with that construct. I think of them as fixtures, and that gets me over the mental hurdle and allows me to overlook this issue.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-08-27T01:36:39.850

One thing you can't do with `[TestFixtureSetup]` that you can do in the constructor is receive parameters from the `[TestFixture]` .

If you want to parameterise your test fixture, then you will have to use the constructor for at least *some* of the set-up. So far, I've only used this for integration tests, e.g. for testing a data access layer with multiple data providers:

```
[TestFixture("System.Data.SqlClient",
  "Server=(local)\\SQLEXPRESS;Initial Catalog=MyTestDatabase;Integrated Security=True;Pooling=False"))]
[TestFixture("System.Data.SQLite", "Data Source=MyTestDatabase.s3db")])]
internal class MyDataAccessLayerIntegrationTests
{
    MyDataAccessLayerIntegrationTests(
        string dataProvider,
        string connectionString)
    {
        ...
    }
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-01-11T10:37:20.863

There is difference between constructor and method marked with `[TestFixtureSetUp]` attribute. According to NUnit documentation:

> It is advisable that the constructor not have any side effects, since NUnit may construct the object multiple times in the course of a session.

So if you have any expensive initialization it is better to use `TestFixtureSetUp`.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-06T16:26:22.633

I have often wondered what the need for `[TestFixtureSetUp]` was, given that there is a simple, well understood first class language construct that does exactly the same thing.

My preference is to use constructors, to take advantage of the readonly keyword ensuring member variables cannot be reinitialised.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-02-09T10:51:07.173

`[TestFixtureSetUp]` and `[TestFixtureTearDown]` are for whole test class. runs only once.

`[SetUp]` and `[TearDown]` are for every test method(test). runs for every test.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-03-16T17:40:09.657

An important difference between constructor and TestFixtureSetUp is that, in NUnit 2 at least, constructor code is actually executed on test enumeration, not just test running, so basically you want to limit ctor code to only populating readonly, i.e. parameter, values. Anything that causes side-effects or does any actual work needs to either be wrapped in a Lazy or done in the TestFixtureSetUp / OneTimeSetUp. So, you can think of the constructor as solely a place to configure the test. Whereas the TestFixtureSetUp is where the test fixture, the required initial state of the system before tests are run, is initialized.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-07-25T07:13:49.160

I think I have a negative good answer - the reason to use a constructor instead of the attribute is when you have an inheritence between test classes.

Only one method annotated with `[TestFixtureSetup]` will be called (on the concrete class only), but the other fixture initializers will not. In this case I'd rather put the initialization in the constructor, which has a well-defined semantics for inheritance :)

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2012-06-13T09:13:36.293

The constructor and the `SetUp` methods are used differently:
The constructor is run only once.
However, the `SetUp` methods are run multiple times, before every test case is executed.

# .net - 安装后如何自动启动服务？

> ID：212734
> 
> 赞同：52
> 
> 时间：2008-10-17T15:51:44.143
> 
> 标签：.net, installation, service

从 Visual Studio 安装项目运行安装后如何自动启动服务？

我只是想出了这个问题，并认为我会为了普遍的利益而分享答案。回答跟随。我对其他更好的方法持开放态度。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-10-17T15:52:35.703

将以下类添加到您的项目中。

```
using System.ServiceProcess;  

class ServInstaller : ServiceInstaller
{
    protected override void OnCommitted(System.Collections.IDictionary savedState)
    {
        ServiceController sc = new ServiceController("YourServiceNameGoesHere");
        sc.Start();
    }
} 
```

安装程序完成后，安装项目将选择课程并运行您的服务。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-04-20T18:10:41.140

已接受答案的小补充：

您还可以像这样获取服务名称 - 避免将来更改服务名称时出现任何问题：

```
protected override void OnCommitted(System.Collections.IDictionary savedState)
{
    new ServiceController(serviceInstaller1.ServiceName).Start();
} 
```

（每个 Installer 都有一个 ServiceProcessInstaller 和一个 ServiceInstaller。这里的 ServiceInstaller 称为 serviceInstaller1。）

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2012-05-26T01:02:33.307

这种方法使用 Installer 类和最少的代码。

```
using System.ComponentModel;
using System.Configuration.Install;
using System.ServiceProcess;

namespace MyProject
{
    [RunInstaller(true)]
    public partial class ProjectInstaller : Installer
    {
        public ProjectInstaller()
        {
            InitializeComponent();
            serviceInstaller1.AfterInstall += (sender, args) => new ServiceController(serviceInstaller1.ServiceName).Start();
        }
    }
} 
```

在 Installer 类设计器中定义`serviceInstaller1`（键入 ServiceInstaller），并在`ServiceName`设计器中设置其属性。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-09T04:06:08.047

谢谢运行正常...

```
private System.ServiceProcess.ServiceInstaller serviceInstaller1;

private void serviceInstaller1_AfterInstall(object sender, InstallEventArgs e)
{
    ServiceController sc = new ServiceController("YourServiceName");
    sc.Start();
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-05-10T09:37:43.577

不要创建自己的类，而是在项目安装程序中选择服务安装程序并将事件处理程序添加到 Comitted 事件：

```
private void serviceInstallerService1_Committed(object sender, InstallEventArgs e)
{
    var serviceInstaller = sender as ServiceInstaller;
    // Start the service after it is installed.
    if (serviceInstaller != null && serviceInstaller.StartType == ServiceStartMode.Automatic)
    {
        var serviceController = new ServiceController(serviceInstaller.ServiceName);
        serviceController.Start();
    }
} 
```

只有当启动类型设置为自动时，它才会启动您的服务。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-19T00:17:05.917

根据上面的片段，我的 ProjectInstaller.cs 文件对于名为 FSWServiceMgr.exe 的服务看起来像这样。该服务确实在安装后启动。附带说明一下，当在解决方案资源管理器中选择设置项目以设置公司等时，请记住单击属性选项卡（不是右键单击）。

* * *

```
using System.ComponentModel;
using System.Configuration.Install;
using System.ServiceProcess;

namespace FSWManager {
    [RunInstaller(true)]
    public partial class ProjectInstaller : Installer {
        public ProjectInstaller() {
            InitializeComponent();
            this.FSWServiceMgr.AfterInstall += FSWServiceMgr_AfterInstall;
        }

        static void FSWServiceMgr_AfterInstall(object sender, InstallEventArgs e) {
            new ServiceController("FSWServiceMgr").Start();
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-07T02:17:46.980

还有另一种不涉及代码的方式。您可以使用服务控制表。使用 orca.exe 编辑生成的 msi 文件，并将条目添加到[ServiceControl Table](https://msdn.microsoft.com/en-us/library/windows/desktop/aa371634(v=vs.85).aspx)。

只有 ServiceControl、Name、Event 和 Component_ 列是必需的。Component_ 列包含来自文件表的 ComponentId。（选择文件表中的文件，并将 Component_value 复制到 ServiceControl 表中。）

最后一步是在表 InstallExecutesequence 中将 StartServices 的值更新为 6575。这足以启动服务。

顺便说一句，服务安装表允许您配置安装程序以安装 Windows 服务。

# bash - 从命令行将文本转换为 7 位 ASCII

> ID：212745
> 
> 赞同：4
> 
> 时间：2008-10-17T15:54:14.607
> 
> 标签：bash, text, ascii, 7-bit

我在 OS X 10.5.5 上（尽管我猜这并不重要）

我有一组带有花哨字符的文本文件，例如双反引号、省略号（“...”）在一个字符中等等。

我需要将这些文件转换为良好的老式纯 7 位 ASCII，最好不要丢失字符含义（即，将这些省略号转换为三个句点，将反引号转换为通常的 "s 等）。

请建议一些智能命令行（bash）工具/脚本来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T16:56:03.030

Elinks Web 浏览器会将 Unicode 实体转换为其 ASCII 等价物，例如“--”代表“-”，“...”代表“...”等。有一个 python 模块[python](http://elinks.or.cz/) [-elinks](http://code.google.com/p/python-elinks/)使用相同的转换表，将其变成外壳过滤器将是微不足道的，如下所示：

```
#!/usr/bin/env python
import elinks
import sys
for line in sys.stdin:
    line = line.decode('utf-8')
    sys.stdout.write(line.encode('ASCII', 'elinks')) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T16:30:42.410

据我所知，[iconv应该这样做。](http://www.manpagez.com/man/1/iconv/)不能 100% 确定它如何处理一个输入字符应该/可能成为多个输出字符的转换，例如省略号示例……尝试一下！

更新：我确实尝试过，但它似乎不起作用。它失败了，可能是因为它不知道如何以“较小”的编码表示省略号（我使用的测试字符）。从 UTF-8 转换为 UTF-16 很顺利。:/ 不过，iconv 可能值得进一步研究。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T16:48:08.600

看看音译工具；我喜欢[Unidecode](http://search.cpan.org/~sburke/Text-Unidecode-0.04/lib/Text/Unidecode.pm)（在 Perl 中），移植到其他语言并不难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T02:49:10.843

我已经使用 iconv 将由 Windows 中的 TextPad 创建的 UTF-16LE（我通过反复试验发现的小端序）转换为 OSX 上的 ASCII 文件，如下所示：

```
 cat utf16file.txt |iconv -f UTF-16LE -t ASCII > asciifile.txt 
```

您也可以通过 hexdump 管道查看字符并确保您获得正确的输出，终端知道如何解释 UTF-16 并正确显示它，因此您不能只说对文件执行“cat” ：

```
cat utf16file.txt | iconv -f UTF-16LE -t ASCII | hexdump -C 
```

这在右侧显示了十六进制字符代码和 ASCII 字符的布局，您可以在 -f "from" 参数中尝试不同的编码来确定您正在处理的内容。

使用 'iconv -l' 列出 iconv 可以在您的系统上使用的字符集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T16:59:06.177

昨天或前一天有一个关于文件重命名的问题，我展示了一个`rename.pl`可用于该任务的 Perl 脚本。问题领域是知道奇数字符是如何编码的，并设计出正确的音译序列。我可能会通过改编那个按顺序完成所有映射的脚本来做到这一点。一次只做一个角色会过于繁琐。

问题是：[如何使用前缀/后缀重命名](https://stackoverflow.com/questions/208181/how-to-rename-with-prefixsuffix)

# nunit - 如何在 NUnit 中编写测试方法来测试保存文件方法？

> ID：212748
> 
> 赞同：4
> 
> 时间：2008-10-17T15:55:54.277
> 
> 标签：nunit, tdd

我编写了一个保存文件方法来将对象保存到 xml。但我不确定如何在 NUnit 中测试该方法。我是否需要手动创建示例文件并比较文件之间的字符串？有没有更好的方法来测试该方法？

感谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T16:05:47.890

呃，验证 XML 输出。欢迎来到地狱 ：）

`XmlDocument`一种对我有用的方法是在内存中生成一个对象。然后运行您的 SaveFile 方法，并将其加载到另一个`XmlDocument`. 递归遍历两个 XmlDocument，比较所有元素和属性。

不幸的是，用 C# 对象编写 xml 是大而笨重的。我建议一次测试小节。也许您的保存文件有一个`<FileList>`子元素、一个`<Cups>`子元素和一个`<Rifles>`子元素。在这种情况下，编写一系列测试以确保每个子部分都正确完成，而不是整体输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T16:08:05.203

如果您显示代码会更容易。我解决这个问题的方法是添加一个抽象层。不要让您的 Save 方法直接处理 XmlWriter。相反，创建包装器，每个包装器都能够将数据的小逻辑块保存到 xml，并对其进行测试。

对于每个 Wrapper 都有一个类似的方法

```
void Persist(XmlWriter writer); 
```

让 Save 只从包装器中收集数据。换句话说，正确保存数据是 Wrappers 的责任，但每个人只负责其中的一小部分。在那里你可以通过比较字符串来测试它（将 StringWriter 放入 XmlWriter 你传递给 Persist 方法）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T16:16:32.127

选项

1.  简单化：使用“黄金文件”方法。创建一个只读的预期输出文件作为资源。与实际生成的文件进行字节/字符串比较。
2.  我听说有些人为此目的使用[XmlUnit 。](http://xmlunit.sourceforge.net/)从未亲自使用过，但可能值得一看

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T16:05:19.747

这就是我所做的——它对我有用，但可能不符合您的要求。

在拆解过程中，我确保删除了我可能作为套件的一部分创建的所有文件。所以是的，确保该文件是一个临时文件，仅用于测试

在测试方法中，如果文件存在，我将其删除（它不应该因为拆解已经处理了它），然后将文件输出到 XML，然后断言文件存在。然后，我将文件重新加载到对象图或 xml DOM 中，并根据需要通过尽可能多的断言查询状态。

如果您可以避免写入文件并且您的设计允许您写入通用文本写入器或 xml 写入器，那么您可以绕过文件保存并用字符串写入器替换调用，而只需查询一个字符串。更干净，但它没有测试实际的文件持久性是否有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T16:15:41.553

设计你的类，使你有 SaveFile(string fileName) 和 SaveFile(XmlWriter writer)。SaveFile(string filename) 只需要为命名文件创建一个 XmlWriter 并调用 SaveFile(writer)。对可以使用模拟 XmlWriter 的 SaveFile(XmlWriter writer) 方法进行广泛的单元测试。在 SaveFile(string filename) 方法上测试一些错误条件——如果您希望处理它们而不是向上传播它们。根据错误处理，您可能根本不需要创建文件。

顺便说一句，如果您不想，则不需要直接使用 XmlWriter 公开您的方法。您可以将其设为私有并使用访问器在您的测试中调用它。

# email - 确认电子邮件链接提交 ID 的最佳方式

> ID：212758
> 
> 赞同：1
> 
> 时间：2008-10-17T16:00:00.133
> 
> 标签：email, confirmation

我有一个网站向某人发送确认电子邮件。

现在在电子邮件中，我想要一个链接，用户必须单击以确认他收到了邮件。

我想在确认地址中包含用户的密码（或一些随机代码），因此用户不需要再次手动输入，但如果我这样做，密码将最终出现在浏览器历史记录中，并且日志文件。

有没有其他方法可以在电子邮件中获取确认链接以发送用户名和密码等信息，而不会以某种方式在链接中结束？
例如，是否可以在电子邮件中输入表单并将密码作为 POST 而不是 GET 发送？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T16:05:44.943

这通常的工作方式是确认电子邮件包含一个包含某种 GUID（全局唯一标识符）的链接。GUID 与用户的帐户相关联。单击链接时，Web 应用程序只需设置确认标志并使用 GUID 登录用户，而不是使用通常的用户名和密码组合。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T16:12:57.860

根据用户的 id 和当前时间计算一个十六进制摘要（例如 md5）。将此代码保存到数据库或以它作为文件名写入文件，并包含用户的 ID 和电子邮件地址。

设置一个 http 处理程序（cgi、php、servlet 等）以接收基于类似于“/confirm_email/{hexdigest}”或“/confirm_email.php?code={hexdigest}”的 URI 的 GET 请求

当用户需要确认他们的电子邮件时，发送一个指向上述 servlet 的链接，其中包含摘要。

当有人链接到此 URI 时，检索具有匹配摘要的数据库记录或文件。如果找到一个，则现在验证包含的电子邮件地址。

如果你想让它更健壮：当用户验证他们的电子邮件时，将十六进制摘要更改为电子邮件地址本身的哈希值，不加盐。然后您可以测试某人的电子邮件是否已更改并需要重新验证。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T16:04:06.270

您可以在电子邮件中传递 GUID。该特定 GUID 必须与用户相关联。然后，当用户单击链接时，GUID 会被发送回应用程序，并且可以作为 QueryString 捕获。提取 GUID 用户已获批准的更新。

# vb.net - 在 .NET 中“正方形”图像的最佳方法是什么？

> ID：212762
> 
> 赞同：1
> 
> 时间：2008-10-17T16:00:44.250
> 
> 标签：vb.net, image-processing, thumbnails

我需要为一堆 jpeg（200,000+）生成[缩略图，但我想确保我所有的拇指都具有相同的高度和宽度。](https://stackoverflow.com/questions/27921/what-is-the-best-way-to-create-a-thumbnail-using-aspnet)但是，我不想改变图像的比例，所以我需要在较短的维度上添加空白空间以“对齐”。空白区域的背景颜色是可变的。

这是我用来生成拇指的代码片段。进行平方的最佳方法是什么？

```
 Dim imgDest As System.Drawing.Bitmap = New Bitmap(ScaleWidth, ScaleHeight)
     imgDest.SetResolution(TARGET_RESOLUTION, TARGET_RESOLUTION)  
     Dim grDest As Graphics = Graphics.FromImage(imgDest)

     grDest.DrawImage(SourceImage, 0, 0, imgDest.Width, imgDest.Height) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T16:08:51.957

这个怎么样。也许您应该首先在位图上绘制一个黑色（或任何颜色）矩形。

然后，当您放置调整大小的图像时，只需根据较短的尺寸计算图像的位置，然后将该尺寸移动差异的一半（并将另一个保持为 0）。

那不行吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-19T05:17:28.397

就像**Vaibhav**所说，首先用黑色绘制整个缩略图区域。这比首先将图像拟合到缩略图中然后确定将哪些矩形涂黑以实现[邮筒](http://en.wikipedia.org/wiki/Pillarbox)或[信箱](http://en.wikipedia.org/wiki/Letterbox)更简单。

`imageWidth`将x`imageHeight`图像拟合到`thumbWidth`x `thumbHeight`（不必是正方形）区域的通用解决方案的伪代码：

```
imageRatio = imageWidth / imageHeight;
thumbRatio = thumbWidth / thumbHeight;

zoomFactor = imageRatio >= thumbRatio
    ? thumbWidth / imageWidth 
    : thumbHeight / imageHeight;

destWidth = imageWidth * zoomFactor;
destHeight = imageHeight * zoomFactor;

drawImage(
    (thumbWidth - destWidth) >> 1,
    (thumbHeight - destHeight) >> 1,
    destWidth,
    destHeight); 
```

# c# - C# Windows 应用程序中的密码散列，缺少 ASP.NET 的 FormsAuthentication？

> ID：212763
> 
> 赞同：8
> 
> 时间：2008-10-17T16:00:52.173
> 
> 标签：c#, .net, hash, passwords

我的 Win 表单应用程序似乎不喜欢 FormsAuthentication，我对散列完全陌生，因此非常欢迎任何帮助转换它。谢谢。

```
//Write hash
protected TextBox tbPassword;
protected Literal liHashedPassword;

{
  string strHashedPassword = FormsAuthentication.HashPasswordForStoringInConfigFile(tbPassword.Text, "sha1");
  liHashedPassword.Text = "Hashed Password is: " + strHashedPassword;    
}

//read hash
string strUserInputtedHashedPassword = FormsAuthentication.HashPasswordForStoringInConfigFile( tbPassword.Text, "sha1");
if(strUserInputtedHashedPassword == GetUsersHashedPasswordUsingUserName(tbUserName.Text))
{
  // sign-in successful
}
else
{
  // sign-in failed
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-17T16:16:57.650

```
using System.Security.Cryptography;

public static string EncodePasswordToBase64(string password)
{  byte[] bytes   = Encoding.Unicode.GetBytes(password);
   byte[] inArray = HashAlgorithm.Create("SHA1").ComputeHash(bytes);
   return Convert.ToBase64String(inArray);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T16:06:06.313

FormsAuthentication 是在 System.Web.dll 程序集中的 System.Web.Security 命名空间中定义的。

仅仅因为您正在编写一个 WinForm 应用程序并不会阻止您使用该命名空间或引用该程序集；它们只是默认情况下不会像 WebForms 应用程序那样完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T00:46:23.650

如果您将散列用于用户凭据，我建议您做的不仅仅是散列，理想情况下您还需要密钥拉伸。

这是一个以安全方式执行您想要的操作的 API：

[https://sourceforge.net/projects/pwdtknet/](https://sourceforge.net/projects/pwdtknet/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T16:03:27.647

我认为它应该工作。您需要做的就是在代码中引用 System.Web.Security（并将其添加为 Visual Studio 项目中的引用）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T16:22:17.297

如果您实际上必须“发布”此表单应用程序，那么添加 System.Web.Security 可能不是一个好主意...

如果您需要 SHA1 哈希，则有一个非常易于使用的 .net 密码库，其中包含 msdn 上的示例。关键是

1.  拿走你想加密的东西
2.  将其转换为您使用的任何编码（ascii，utf *）的字节
3.  使用 .Net 内置的众多散列方案之一来获取散列字节
4.  将这些字节转换回与步骤 2 相同编码的字符串
5.  将生成的散列字符串保存在某处以供以后比较

* * *

```
//step 1 and 2
byte[] data = System.Text.Encoding.Unicode.GetBytes(tbPassword.Text,);
byte[] result; 

//step 3
SHA1 sha = new SHA1CryptoServiceProvider(); 
result = sha.ComputeHash(data);

//step 4
string storableHashResult = System.Text.Encoding.Unicode.ToString(result);

//step 5
    // add your code here 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-09T15:15:03.230

您不能使用 BitConverter 函数而不是“x2”循环吗？

例如

返回 BitConverter.ToString(hash).Replace("-", "");

# python - Python中的键盘可中断阻塞队列

> ID：212797
> 
> 赞同：12
> 
> 时间：2008-10-17T16:10:51.780
> 
> 标签：python, multithreading, concurrency, python-2.x

它似乎

```
import Queue

Queue.Queue().get(timeout=10) 
```

是键盘可中断（ctrl-c）而

```
import Queue

Queue.Queue().get() 
```

不是。我总是可以创建一个循环；

```
import Queue
q = Queue()

while True:
    try:
        q.get(timeout=1000)
    except Queue.Empty:
        pass 
```

但这似乎是一件奇怪的事情。

那么，有没有办法让一个无限期等待但键盘可中断的 Queue.get()？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T17:01:03.880

`Queue``Condition`对象具有这种行为是因为它们使用模块中的对象进行锁定`threading`。所以你的解决方案真的是唯一的出路。

但是，如果您真的想要一个`Queue`执行此操作的方法，您可以对该`Queue`类进行monkeypatch。例如：

```
def interruptable_get(self):
    while True:
        try:
            return self.get(timeout=1000)
        except Queue.Empty:
            pass
Queue.interruptable_get = interruptable_get 
```

这会让你说

```
q.interruptable_get() 
```

代替

```
interruptable_get(q) 
```

尽管 Python 社区通常不鼓励在此类情况下使用猴子补丁，因为常规函数似乎也一样好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-19T17:40:36.280

这可能根本不适用于您的用例。但是我已经在几种情况下成功地使用了这种模式：（粗略而且可能有问题，但你明白了）。

```
STOP = object()

def consumer(q):
    while True:
        x = q.get()
        if x is STOP:
            return
        consume(x)

def main()
    q = Queue()
    c=threading.Thread(target=consumer,args=[q])

    try:
        run_producer(q)
    except KeybordInterrupt:
        q.enqueue(STOP)
    c.join() 
```

# debugging - 如何将VS2005附加到WinCe 5.0上运行的进程

> ID：212804
> 
> 赞同：1
> 
> 时间：2008-10-17T16:12:26.193
> 
> 标签：debugging, windows-mobile, visual-studio-2005, windows-ce

为了能够将 Visual Studio 2005 附加到设备上运行的进程，我需要在 Window CE 5.0 设备上使用哪些应用程序/模块/dll？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T17:00:10.450

在 Debug 菜单中，选择 Attach to process...
在弹出的对话框中将 Transport 更改为 Smart Device。
点击浏览按钮并选择设备类型。
它会弹出一个连接对话框，当它消失时，您会获得设备上的进程列表。

选择你要调试的那个，调试器就会启动。

只要您在安装期间选择了智能设备开发（Express 不支持智能设备），这至少应该适用于标准 VS2005。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T18:52:01.330

你需要确保你有一个 CoreCon 连接。这可以通过 ActiveSync（我不推荐）或直接通过以太网来完成。这是一个非常简单的过程，虽然在这里清楚地发布有点冗长，但它需要在设备上运行 CoreCon 客户端并将 Studio 的设备连接选项设置为设备 IP。[OpenNETCF](http://community.opennetcf.com/articles/cf/archive/2007/08/31/debugging-without-activesync.aspx)上有一篇文章介绍了如何在 Studio '05 或 '08 中建立连接。

# java - 在Java中，如何动态确定数组的类型？

> ID：212805
> 
> 赞同：45
> 
> 时间：2008-10-17T16:12:33.290
> 
> 标签：java

```
Object o = new Long[0]
System.out.println( o.getClass().isArray() )
System.out.println( o.getClass().getName() )
Class ofArray = ??? 
```

运行前 3 行发出；

```
true
[Ljava.lang.Long; 
```

如何得到 ？？？要长吗？我可以解析字符串并执行 Class.forname()，但这太糟糕了。什么是简单的方法？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-10-17T16:16:04.080

写吧

```
Class ofArray = o.getClass().getComponentType(); 
```

从[JavaDoc](http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html#getComponentType--)：

> `public Class<?> getComponentType()`
> 
> 返回`Class`表示数组的组件类型。如果此类不表示数组类，则此方法返回`null`。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-17T16:15:52.253

[http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Class.html#getComponentType()](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Class.html#getComponentType())：

> ```
> public Class<?> getComponentType() 
> ```
> 
> 返回`Class`表示数组的组件类型。如果此类不表示数组类，则此方法返回 null...

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-17T16:25:54.277

@ddimitrov 是正确答案。放入代码中，如下所示：

```
public <T> Class<T> testArray(T[] array) {
    return array.getClass().getComponentType();
} 
```

更一般地，我们可以先测试该类型是否代表一个数组，*然后*获取它的组件：

```
Object maybeArray = ...
Class<?> clazz = maybeArray.getClass();
if (clazz.isArray()) {
    System.out.printf("Array of type %s", clazz.getComponentType());
} else {
    System.out.println("Not an array");
} 
```

一个具体的例子是将此方法应用于已知组件类型的数组：

```
String[] arr = {"Daniel", "Chris", "Joseph"};
arr.getClass().getComponentType();              // => java.lang.String 
```

很简单！

# c++ - 寻找C++区间树算法实现

> ID：212808
> 
> 赞同：8
> 
> 时间：2008-10-17T16:12:56.317
> 
> 标签：c++, algorithm, red-black-tree, interval-tree

我试图找到一个没有病毒或限制性许可的有效 C++ 区间树实现（很可能基于红黑树）。任何指向干净的轻量级独立实现的指针？对于我想到的用例，一开始就知道一组间隔（比如说一百万），我希望能够快速获得与给定间隔重叠的间隔列表。因此树一旦构建就不会改变——只需要快速查询。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-11-17T14:02:00.740

我用 C++ 编写了一个基于模板的区间树实现，[https://github.com/ekg/intervaltree](https://github.com/ekg/intervaltree)。麻省理工学院许可证。享受。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T18:31:22.043

C++ 标准库提供红/黑树`std::map`、`std::multimap`和.`std::set``std::multiset`

真的，我想不出比保留 a `std::map`of 迭代器对并将这些迭代器对传递给`upper_bound()`and更有效地处理这个问题的任何方法`lower_bound()`。您希望迭代器对本身保存在映射中，以便您可以轻松地将哪些对可能在区间内归零（如果“候选区间”中的开始迭代器出现在给定区间结束之后您正在查看，然后您可以跳过检查 - 以及以后 - 迭代器对）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T23:34:37.837

[在这个链接](http://code.google.com/p/intervaltree/)上还有一个区间树的 C# 实现。为有需要的人翻译成 C++ 很容易

# asp.net - 有没有办法在 IIS 7.0 的子目录中访问根 App_Code 文件夹和 App_Code 文件夹？

> ID：212813
> 
> 赞同：0
> 
> 时间：2008-10-17T16:14:26.297
> 
> 标签：asp.net, iis-7

我希望能够在我的根 App_Code 文件夹中拥有一组通用的类，这就是我们现在的设置方式。但是，为驻留在子目录中的某些应用程序放置特定代码是没有意义的。

*   根文件夹
*   应用程序代码
    *   子目录App1
        *   应用程序代码
    *   子目录App2
        *   应用程序代码

我们目前将每个生产应用程序都放在其自己的“根”文件夹中，并拥有自己的应用程序池。然后我们只镜像那里的主根 App_Code 文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T16:17:27.803

就个人而言，如果您有一组由多个程序集/应用程序引用的公共类，我会将它们编译成一个 .dll 文件，然后将它们作为参考添加，而不是在 app_code 文件夹中复制源代码。

在我看来，这是构建类库的主要案例，这确实是它们的设计目的！

# c# - 如何在 C# Web 服务对象属性中强制设置最大字符串长度？

> ID：212821
> 
> 赞同：4
> 
> 时间：2008-10-17T16:16:57.180
> 
> 标签：c#, web-services, soap, .net-2.0, xml-serialization

例如，在这个类中，我想强制限制名字/姓氏可以允许的字符。

```
public class Person
{
     public string FirstName { get; set; }
     public string LastName { get; set; }
} 
```

有没有办法强制对名字或姓氏进行字符串限制限制，所以**当客户端**在将其发送给我之前对其进行序列化时，如果它违反了长度限制，它会在他们这边抛出一个错误？

更新：这需要在 WSDL 本身中识别和强制，而不是在我收到无效数据之后。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-03-29T07:10:30.137

死灵时间......虽然值得一提。

```
using System.ComponentModel.DataAnnotations;
public class Person
{
     [StringLength(255, ErrorMessage = "Error")]
     public string FirstName { get; set; }
     [StringLength(255, ErrorMessage = "Error")]
     public string LastName { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T16:45:30.197

[您可以使用SOAP Extensions](https://web.archive.org/web/20150118095235/http://msdn.microsoft.com/en-us/magazine/cc164115.aspx)应用 XML Schema 验证（例如，*maxLength* facet）：

```
[ValidationSchema("person.xsd")]
public class Person { /* ... */ }

<!-- person.xsd -->

<?xml version="1.0"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">

  <xsd:element name="Person" type="PersonType" />

  <xsd:simpleType name="NameString">
     <xsd:restriction base="xsd:string">
        <xsd:maxLength value="255"/>
     </xsd:restriction>
  </xsd:simpleType>

  <xsd:complexType name="PersonType">
    <xsd:sequence>
         <xsd:element name="FirstName" type="NameString" maxOccurs="1"/>
         <xsd:element name="LastName"  type="NameString" maxOccurs="1"/>
     </xsd:sequence>
  </xsd:complexType>
</xsd:schema> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T16:20:11.247

从自动属性转换属性并自行验证，然后您可以抛出参数异常或他们在提交之前必须处理的类似内容。

注意：如果调用 .NET 以外的语言，您很可能也希望在服务端对其进行验证。或者在最低限度的测试中看看它在另一种语言中的工作方式。

# eclipse - 如何在 Pydev for Eclipse 中为 WebOb 响应/请求对象启用自动完成功能？

> ID：212827
> 
> 赞同：3
> 
> 时间：2008-10-17T16:17:59.940
> 
> 标签：eclipse, google-app-engine, pydev

我一直在使用 Pydev/Eclipse 开发 Google App Engine (GAE) 应用程序，但我无法从 WebOb 获取响应/请求对象以自动完成。我使用了[广泛推荐的教程](http://code.google.com/appengine/articles/eclipse.html)来配置所有内容；自动完成适用于我遇到的所有其他事情。

例如：如果我输入“self”。我得到响应和请求的自动完成；如果我选择其中一个，请说“响应”，然后添加“。” （到目前为止，将整行带到“self.response”。）我没有任何选项 - 由于包含 WebOb 库，我希望将“out.write()”之类的东西作为选项。

我将以下库包含到我的 Pydev 项目中：

*   C:\Program Files\Google\google_appengine
*   C:\Program Files\Google\google_appengine\lib\django
*   C:\Program Files\Google\google_appengine\lib\webob
*   C:\Program Files\Google\google_appengine\lib\yaml\lib

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T23:22:10.610

我已经尝试过我的安装，它可以工作。但是，请记住，PyDev 的分析在遇到错误时会停止，这可能是自动完成在您的情况下不起作用的原因。

我建议您与主要开发人员 Fabio Zadrozny 联系；他非常友好和乐于助人，并且还运行了一个[博客](http://pydev.blogspot.com/)，其中包含许多有用的技巧，用于使用各种框架和所有限制配置 PyDev。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-23T20:48:22.433

显然，这是各种 Python IDE 的一个已知问题——似乎没有人有一个单一的解决方案。谷歌更改了一些内部路径，使其只能通过执行 python 脚本来确定。尽管 Wing IDE 有一个不错的解决方法，但我还没有为 Pydev 提出令人满意的解决方案：

## 改进自动完成和转到定义

Wing 无法解析最新版本的 Google App Engine 中的 sys.path 黑客，因此它可能无法找到一些用于自动完成、goto-definition 和其他功能的模块。要解决此问题，请在 dev_appserver.py 的 fix_sys_path 中设置断点并开始调试。

然后，在 Debug Probe 工具（仅限 Wing Pro）中键入以下内容：

```
os.pathsep.join(EXTRA_PATHS) 
```

将此复制到剪贴板并通过右键单击文件打开 dev_appserver.py 的文件属性。然后，在 Environment 选项卡下，为 Python Path 选择 Custom，单击 View as Text 按钮并粘贴到额外的路径中。

如果您移动应用程序引擎安装，则需要重做此操作，或者您可以使用 ${WING:PROJECT_DIR} 将这些路径转换为基于项目文件的位置。

（取自： http: [//www.wingware.com/doc/howtos/google-app-engine](http://www.wingware.com/doc/howtos/google-app-engine)）

# windows-vista - Vista 如何决定在内存不足时应该关闭哪些程序？

> ID：212828
> 
> 赞同：4
> 
> 时间：2008-10-17T16:18:26.647
> 
> 标签：windows-vista

当系统虚拟内存不足时，Vista 会显示对话框“关闭程序以防止信息丢失”。

在此对话框中，它会命名您应该关闭的程序。人们向我报告说，它有时会命名我开发的程序。

Vista 如何决定应该关闭哪些程序？我想知道这个对话框是否告诉我我的程序有问题，或者它只是因为其他原因而被命名（例如它是最后一个要启动的程序）。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T16:28:34.757

它也可以被列出，因为它比其他正在运行的东西占用（按比例）更多的内存。如果您使用 .NET 来开发它，那更有可能。

Vista会选择消耗较高的应用程序来建议首先关闭是有道理的，因为这样可以为用户带来最大的不便（可能会在几分钟内防止该对话再次发生）。

# web-services - 在 ASMX 中测试自定义 SOAP 标头

> ID：212839
> 
> 赞同：2
> 
> 时间：2008-10-17T16:20:27.737
> 
> 标签：web-services, soap, asmx

ASMX 生成的测试表单对于测试操作非常方便。但是，没有明显的方法来包含 SOAP 标头。

如何在不编写客户端使用该服务的情况下测试您的标头？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-26T16:20:11.837

如果您关心互操作，请不要使用 .net 客户端应用程序来测试 .net Web 服务。使用像 SOAPUI 这样的适当工具来测试您的 Web 服务。[www.soapui.org](http://www.soapui.org)

该工具是用 Java 编写的，但它是免费的，并且非常方便用于测试任何类型的 Web 服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T21:30:46.107

如果我了解您要执行的操作，则可以使用 asmx 提供的 SOAP 执行 HTTP 请求。如果您在浏览器中打开 asmx，您将获得 Web 服务中可用的方法列表。单击您要测试的方法，您将获得一个可以使用的 SOAP 请求，只需填写您要测试的值即可。下面是可用于测试 SOAP 的代码。

```
// Set SOAP Message
string msg = "<?xml version='1.0' encoding='UTF-8'?><soap:Envelope>";
...
...

// Make http request
HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://linktoyour/service.asmx");

req.Headers.Add("SOAPAction", "http://linktoyour/NameOfFuntion");

req.ContentType = "text/xml;charset=\"utf-8\"";
req.Accept = "text/xml";
req.Method = "POST";
byte[] bytes = System.Text.Encoding.UTF8.GetBytes(msg);

req.ContentLength = bytes.Length;

System.IO.Stream st = req.GetRequestStream();
st.Write(bytes,0,bytes.Length);
st.Close();

// Read response
HttpWebResponse res = (HttpWebResponse)req.GetResponse();
System.IO.Stream st1 = res.GetResponseStream();

System.IO.StreamReader sr = new System.IO.StreamReader(st1, System.Text.Encoding.UTF8);

string txt = sr.ReadToEnd();

// Display response
Response.Write(txt); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-21T23:41:50.930

您询问

> 如何在不编写客户端使用该服务的情况下测试您的标头？

答案是您应该对客户端进行编程以使用该服务。

将编写代码以使用您的服务的开发人员将被迫编写一个客户端，该客户端使用您设计不良、难以使用的服务，并带有奇怪的标头。最好在 {badly-designed, hard-to-use, 奇怪} 之前找到它们。

这样，您可以将服务重新设计为{精心设计、易于使用、正常}。

顺便说一句，为您的 Web 服务编写单元测试是一个很好的方法。这样，您就拥有了小型、简单的客户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T23:30:54.620

不要直接访问标头，而是提供代码访问的抽象。例如，如果您有一个名为“Customer”的标头，您可以提供一个可以访问的上下文类，如下所示：

字符串客户 = MyContext.Current.Customer；

现在，您所要做的就是在您的测试类中交换一个不需要所有管道的模拟实现。

但是请注意，在 Web 服务器之外测试 ASMX 并不完全理想，因为它可能会遗漏诸如序列化之类的事情。如果您可以部署到测试服务器并测试部署的副本，那您会更好。如果您真的关心测试，WCF 是一个更好的选择，因为您可以在测试中轻松地自托管 WCF。

# debugging - 什么可以在 Linux 中执行类似 Cheat-Engine 的任务？

> ID：212842
> 
> 赞同：3
> 
> 时间：2008-10-17T16:21:15.113
> 
> 标签：debugging, memory, gdb

简而言之，我如何在 linux 中搜索、查看和修改内存中的值，最好尽可能简单/简单。

[像这样](http://www.raymond.cc/blog/archives/2007/02/27/how-to-cheat-and-hack-flash-based-games/)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-30T15:55:15.080

最接近您的是 scanmem

sudo apt-get install scanmem

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T16:44:20.310

这个论坛帖子解释了如何以及为什么。

[http://forum.cheatengine.org/viewtopic.php?t=264431](http://forum.cheatengine.org/viewtopic.php?t=264431)

长话短说，您需要在 Wine 中运行 Firefox 的 IE，以便 CE 可以查看它使用的内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T16:28:56.643

保持一切与 Windows 相同的最简单方法是使用[Wine](http://www.winehq.org)。它是 Windows API 的一种实现，允许某些应用程序以接近本机的速度运行。

我这么说是因为您建议的链接使用特殊的应用程序为您完成了一半的工作。除非它被移植到你身上，否则你只剩下 Wine、Windows 或在 Linux 下的 VM 中运行 Windows。

但你不应该作弊。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-17T20:13:43.227

哇！！！不知道Windows存在这样的东西！感谢分享！

SNES9X 具有类似的能力，可以在播放 SNES ROM 映像时对其进行破解、调整甚至重新编程（我读到它的灵感来自 Game Genie），我在十几岁时经常使用它来获得无限弹药、生命、隐藏场景或角色等SNES游戏...

老实说，如果你在我认为根本不可能为任何版本的 Windows>=NT 或 Linux 做类似的事情之前没有发布过这个……为什么？因为据说现在我们有更多的内存保护（在可能的情况下强制执行硬件）来避免这种情况：一个进程覆盖另一个进程的数据。

我认为这仅适用于控制台 ROM，因为从技术上讲，整个 ROM 都是模拟器的数据，所以它不是其他人的数据。如果您制作了自己的 Flash 播放器，也可以这样说。但是这个程序就在这里并且在 Windows**可执行文件**上工作！真是令人印象深刻。

现在，你可以从[这个页面](http://www.heijnen1.demon.nl/)下载一个旧版本的代码，作者在那里也说你可以给他发邮件问他最新版本的代码。

您可以尝试将其移植到 Linux 上。它是用 Delphi 编写的，在使用现代 Pascal 编译器进行一些小的调整后可能可以编译。

# version-control - 非网络环境的最佳版本控制系统？

> ID：212847
> 
> 赞同：8
> 
> 时间：2008-10-17T16:23:00.010
> 
> 标签：version-control, dvcs

我正在指导一个高中机器人团队的编程小组。我想建立一个源代码控制存储库，以避免手动复制用于共享/备份的目录并手动合并这些目录的混乱。构建位置通常没有网络访问权限，因此这导致我使用了我不熟悉的分布式版本控制系统 (DVCS)。

最大的要求如下：

1.  适用于 Windows XP 和 Vista。（绝对必须）
2.  可以在本地提交更改。（似乎所有 DVCS 都是这种情况）
3.  无需网络访问即可合并来自多台计算机的存储库。（可能通过将存储库存储在 USB 驱动器上并将驱动器交换到另一台机器，然后从那里合并）

它还应该易于学习和使用，最好是通过图形 UI，因为我正在与从未使用过版本控制系统的高中生一起工作。

关于哪种 DVCS 最适合此的任何建议。

编辑：

感谢您的回答。Mercurial 看起来不错，但它是否支持将存储库从一个目录合并到另一个目录，还是我必须设置一个本地网络才能合并？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T16:29:34.050

Git 很可爱，但它对 Windows 的支持极其松懈（即使使用[MSysGit 也是如此](http://code.google.com/p/msysgit/)）。我会推荐 Mercurial。我自己并没有真正使用过它，但我听说它的 Windows 支持非常有用。此外，对于来自传统 VCS（如 SVN）的人来说，它的学习曲线稍微容易一些。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T16:30:18.387

[Mercurial](http://www.selenic.com/mercurial/wiki/)在 Windows 和 Linux 上都非常易于使用。 [TortoiseHg](http://tortoisehg.sourceforge.net/)是一个集成到资源管理器中的 Windows gui 前端；它工作正常。两者都是开源的。据我了解，在 Windows 下使用 Git 没有那么简单。

> 感谢您的回答。Mercurial 看起来不错，但它是否支持将存储库从一个目录合并到另一个目录，还是我必须设置一个本地网络才能合并？

Mercurial/TortoiseHg 将执行此操作（以及更多），所有其他分布式版本控制工具（据我所知）也将执行此操作。我相信它会解决你的问题。它是一个 DVCS，并且与 TortoiseHg 一起，它很容易在 Windows 上使用。其他分布式版本控制工具可能也可以工作（例如 bzr），但我对它们的经验较少。Subversion (svn) 是一个中心化的版本控制工具。通过一些变通方法，您可以让它在您的环境中运行，但它实际上并不能解决您想要解决的问题。我不知道为什么其他响应者建议这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T16:38:37.950

我想[Mercurial](http://www.selenic.com/mercurial/wiki/ "水银")很适合您的需求。

*   它是用 Python 编写的，因此在 Windows 下运行它不会有任何问题。
*   使用补丁或捆绑包可以轻松地在本地应用更改
*   有几个可用的[GUI 工具](http://www.selenic.com/mercurial/wiki/index.cgi/OtherTools)（寻找 TurtoiseHG）

Mercurial 是我个人使用的 VCS。真的很容易学。您肯定想通过 Git 尝试它，因为它对 Windows 的支持要好得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T18:14:29.643

我喜欢集市：[http ://bazaar-vcs.org/](http://bazaar-vcs.org/)

它拥有您所要求的一切，而且非常易于使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T18:42:43.940

> 感谢您的回答。Mercurial 看起来不错，但它是否支持将存储库从一个目录合并到另一个目录，还是我必须设置一个本地网络才能合并？

是的，它确实。 *所有*的 DVCS 都支持这一点。这与从服务器合并之间的唯一区别通常是您将适当的命令传递给本地文件路径而不是 URL。

在 Mercurial 中，它看起来像这样：

假设您有两个存储库，一个在硬盘上 (C:\Project)，另一个在闪存驱动器上 (F:\Project)：

> `cd C:\Project`
> 
> `hg pull F:\Project`

同样，如果您在同一系统上有两个存储库：

> `cd C:\Project`
> 
> `hg pull C:\Project1`

如果需要合并，它将创建两个“头”并要求您将它们与`hg merge`.

> `added 1 changesets with 1 changes to 1 files (+1 heads)`
> 
> `(run 'hg heads' to see heads, 'hg merge' to merge)`

请注意，这与从服务器中提取和合并相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T16:36:32.697

我发现 SVN 的设置和使用非常简单，尤其是对于单个用户！

我发现非常有趣的一件事——ssh+svn 协议使用 SSH 在远程系统上运行命令行的能力来实际启动 SVN，因此在为您的存储库创建目录之外实际上根本没有在服务器上进行任何设置。

如果你不喜欢 CLI（Windows 上的 TortiseSVN），SVN 有很多 shell——所以它和其他任何东西一样容易使用。

# continuous-integration - Scrum/Agile：您如何计划内部改进？

> ID：212850
> 
> 赞同：14
> 
> 时间：2008-10-17T16:23:35.920
> 
> 标签：continuous-integration, agile, scrum

在过去的两年里，我曾在两个使用敏捷/Scrum 方法的不同团队中工作，两个团队都渴望改进他们处理软件开发的方式。在第一个团队中，我们可以很容易地说服我们的产品负责人花时间进行内部工作，例如改进构建系统、设置更好的集成测试、制定更好的发布策略等。现在 PO 也愿意给我们时间，但是他更加推后，这是合理的，因为他也必须完成他的事情。

无论如何，我现在的问题是，其他团队如何处理这个问题？您是否创建了一个改进故事并在计划期间将其放在桌面上，或者您是否为此类事情保留“桶”时间？根据您的经验，说服产品负责人花时间进行改进有多难？毕竟，所有这些改进都会使团队受益，但不会直接或立即使产品所有者/企业受益。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-18T03:53:04.327

好问题。我认为回顾展中有几种“行动项目”值得采用不同的方法。

1) 解决技术债务或基础设施改进等问题的技术任务——比如“我们应该确保我们的应用程序的视图层中没有数据库调用，因为这导致我们在过去的迭代中浪费了时间......有人应该做一个搜索代码以确保我们没有在其他地方这样做。”

2) 流程改进（例如，“人们没有准时参加站立会议......让我们开始为慈善捐款捐款 1 美元，只要有人迟到了”。）

第一类可能是重要的工作，也可能是直截了当的。我展示的示例非常简单……但可能会生成其他需要安排的任务（例如，删除发现它们的 5 个位置的数据库调用）。

第二类应该由迭代经理、项目经理、Scrum 经理等处理/驱动。我（作为 Scrum Master 或项目经理）通常将它们列在项目 wiki 上并在回顾中讨论它们，当它们出现时勾选它们'被解决，并向团队报告状态。我一直点燃火。

我认为第一类——技术任务——的错误在于我们没有定义验收标准。您的示例包括“改进构建系统、设置更好的集成测试、制定更好的发布策略”。这些是非确定性的，需要用清晰的术语进行枚举（必要时使用尖峰）。所以 - 改进构建系统可能会从技术任务或评估选项的尖峰开始。

我们还需要分解技术任务并确定优先级（例如，也许“更好的集成测试”可以从定义当前集成覆盖率的技术任务开始，或者评估可归咎于集成失败的错误百分比，以构建案例在那里投资。

一旦确定了优先级，您就可以传达高优先级项目的价值，并与产品负责人协商花费时间。我不喜欢花在任何东西上的预定义存储桶……但是与产品负责人进行明确的需求、投资回报率和验收标准的对话是关键。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-17T16:29:55.173

改进应该是 sprint 的一部分，就像新功能一样。团队有责任向产品负责人证明这些改进对于即将到来的 sprint 是必要的。这可能会减慢新功能的产生速度，但最终对产品很有用。

另一方面，我对只包含改进的 sprint 有问题。每个 sprint 都应该产生可以向产品负责人展示的输出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T16:35:07.533

[Crystal Methods](https://rads.stackoverflow.com/amzn/click/com/0201699478)将反射研讨会的概念作为调整开发过程的一种手段。团队定期开会（可能比您的开发周期少）讨论流程的改进和状态。想出我们这次尝试的 0-3 项有效的东西，我们会保留，1-3 项无效的东西，以及下次尝试的 1-3 项。这个想法是在过程和产品中进行渐进式改进。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T17:03:02.923

去年，我为最早的敏捷 (xp) 采用者/顾问/培训师之一工作。我认为他有一个很好的方法。

我们每周五见面，讨论什么有效，什么无效。我们会将它们写在两张大纸上（他真的很喜欢纸和画架而不是白板，因为它更永久并且可以更容易地重新定位）。

可行的事情可能非常简单——我们作为一个团队进行了良好的互动，配对顺利，等等。

那些不起作用的事情同样简单而随机。有些人可能会抗拒结对，甚至“老板没有按承诺带我们上船”。

每周我们还会回顾过去的“没用”，看看我们是否修复了它们——如果是这样，它们将始终列在这周的“没用”列中。

虽然我们会讨论具体的解决方案，但公开提出问题往往会产生非常积极的影响。如果它们在“无效”列表中停留 3 或 4 周，我们将讨论不同/更好的解决方案，并更加刻意地尝试实施它们。

在一个项目在“运行良好”列中停留一两个星期后，我们会删除它，因为它或多或少已经符合预期（除非它继续改进）。

这也让周五下午变得更加有趣，因为这是一个每个人都可以参加的相当有趣的会议。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T16:28:59.590

对于这样的事情，我会使用“尖峰”。内部/流程改进不能是用户故事，但它会成为一个完美的高峰。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-24T18:55:55.643

我在这里没有太多要补充的内容，但是我认为应该有专门的资源来解决这些与环境改善相关的问题，并且这些任务不应该包含在燃尽图上。如果它是该项目所需的额外硬件，那么它应该已经被添加并提前预算。因此，最终这些不应该影响 Scrum 上的时间分配，但是任何因这些问题而受影响的工作都应该说明理由。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-21T14:27:48.850

不，不应*创建*技术用户故事：理论上，由于它们通常不会为客户带来直接价值，因此在迭代中被选中的机会非常少。说服产品负责人是缓解这种情况的一种选择，但这里可以使用另一种工具：slack。

Slack 是为这些改进任务留出的一*小部分迭代时间。*如果迭代期间一切顺利，那么您将能够利用这段时间进行这些改进。另一方面，如果团队过度承诺迭代（或任务被低估，如预期的那样更难......），您将有另一个机会履行您的承诺

使用 slack 的另一个好处是，这将降低速度的变化，因为您可能会更频繁地履行承诺，而无需加班。

请参阅 Tom DeMarco [Slack：摆脱倦怠、忙碌和总效率的神话](https://rads.stackoverflow.com/amzn/click/com/0767907698)（亚马逊链接）- ISBN 0767907698。

# .net - 如何使 DataGridViewComboBoxColumn 向左展开下拉菜单？

> ID：212851
> 
> 赞同：5
> 
> 时间：2008-10-17T16:24:13.033
> 
> 标签：.net, drop-down-menu

我有一个`DataGridViewCobmoboxColumn`必须在屏幕最右侧的。单元格中的项目比单元格宽度宽，因此下拉列表也比单元格宽，因此用户可以看到顶部选择的内容。当列表下拉时，下拉列表的右侧是不可见的，因此滚动条也是不可见的。用户认为只有 7 项可供选择，而实际上有很多项。

由于这必须在右侧，有没有办法将下拉菜单锚定到单元格的右侧并扩展到左侧？

我们在这个项目中使用 .Net 2.0。由于我们同时使用 VB 和 C# 进行编码，因此我不太关心特定语言的答案。我什么都要...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T17:03:26.883

如果我理解正确，您需要自动调整宽度以便显示？ [我在 MSDN 上找到了一篇关于如何做到这一点的帖子。](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/a3cab53b-8c03-4f43-83ac-808dc3751db9/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-06T10:39:16.510

我知道这个问题很老，但是：

最好的解决方案是使用类似的东西，`ToolStripDropDownDirection.AboveLeft` *但据我从源代码中看到的，没有这样的东西。*

因此，另一种方法可能是根据组合框从屏幕右侧/底部的位置设置 DropDownWidth/MaxDropDownItems 的值。 *但这不起作用，因为下拉列表不能小于单元格。*

所以你可以试试

*   使用重构来修复控件的行为（机会低）；
*   禁止将窗口（以编程方式）移动到靠近屏幕的右边缘；
*   使用您自己的控件（覆盖或编写您自己的 DataGridViewComboBoxColumn 类）或购买自定义网格。

# html - HTML 选择列表验证

> ID：212858
> 
> 赞同：2
> 
> 时间：2008-10-17T16:26:40.750
> 
> 标签：html, security, data-integrity

我正在开发一个 web 应用程序项目（在 java 中；没关系），我们有一个带有下拉列表和输入字段的表单。

显然提供了下拉列表，因为我们期望从一组值中获得特定值。

所以我的问题是：确保提交的值在预期值集中是否有意义？或者只是假设出现了正确的值是否可以接受？

提交的不同值不会产生任何“错误”，但数据存储与业务规则/要求不一致。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T16:28:54.177

您**绝对应该**验证提交的值是否在预期值集中。使用 firebug 提交任何你想要的下拉菜单是*微不足道的。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T16:31:23.563

最佳实践：假设每个用户都是一个肮脏的黑客，他们为你服务，并会尽其所能来让你的网站崩溃。

**因此，必须在服务器端验证所有数据。**

黑客不会使用您的表单。他们创建随机表单数据并通过其他方式提交。事实上，黑客甚至不知道你的网站做了什么——他们的扫描仪只是在你的网站上徘徊并提交随机的东西。

我使用广泛的客户端验证（c# 验证器）并验证表单上的每个字段。这样当用户使用我的表单时，当最终访问服务器时，数据应该是好的。

但是，我们仍然得到错误的数据！这是黑客使用他们自己的工具探测该站点。

这不像我们是一个好的目标——我们没有任何财务记录暴露在网络上，那又怎样？如果您可以免费使用我们的网站。问题是黑客不知道这一点，并且无论如何都在探索。

# c# - 如何并行运行 NUnit(Selenium Grid) 测试？

> ID：212863
> 
> 赞同：8
> 
> 时间：2008-10-17T16:28:38.157
> 
> 标签：c#, selenium, testing, nunit, selenium-grid

我当前的项目使用 NUnit 进行单元测试并驱动用 Selenium 编写的 UAT。开发人员通常在 VS.Net 2003 中使用 ReSharper 的测试运行程序运行测试，而我们的构建框通过 NAnt 启动它们。

我们希望并行运行 UAT 测试，这样我们就可以利用 Selenium Grid/RC，从而使它们能够运行得更快。

有人对如何实现这一目标有任何想法吗？和/或在不自动编写重复测试的情况下针对多个浏览器环境测试 Selenium 测试的最佳实践？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T16:49:53.993

在这个主题上没有很多工作。我没有发现任何真正相关的东西。

但是，您的观点很好。与强大的单核 cpu 相比，现在大多数机器都有更多的核心和更少强大的核心。

所以我确实在微软博客上找到了一些东西。该技术称为 PUnit，专门用于测试多线程环境。

它尽可能接近你要求我能找到的:)

您可以在此处访问相应的博客文章：http: [//blogs.microsoft.co.il/blogs/eyal/archive/2008/07/09/punit-parallel-unit-testing-in-making.aspx](http://blogs.microsoft.co.il/blogs/eyal/archive/2008/07/09/punit-parallel-unit-testing-in-making.aspx)

**更新：链接不再有效。CodePlex 上的项目已被删除。**

**Update2：这是 NUnit 2.5 的路线图。[参考](http://www.nunit.org/index.php?p=roadmap)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T11:49:28.980

我自己也为这两个问题苦苦挣扎。最后，我开发了一个自定义的 Nunit 测试运行器，它能够并行运行多个测试。这与 nunit 的 Taumuon.Rakija 扩展相结合，允许根据您希望在哪个浏览器上运行测试来动态创建测试。

我现在可以在尽可能多的操作系统上针对尽可能多的浏览器类型启动我的测试套件，只要我希望并行运行。

不幸的是，这些问题似乎还没有很好的解决方案，因此您可能必须针对您的特定环境自己解决这些问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-27T09:17:43.143

NUnit version 3 will support running tests in parallel, this works good with a Selenium Grid:

Adding the attribute to a class: `[Parallelizable(ParallelScope.Self)]` will run your tests in parallel with other test classes.

> • ParallelScope.None indicates that the test may not be run in parallel with other tests.
> 
> • ParallelScope.Self indicates that the test itself may be run in parallel with other tests.
> 
> • ParallelScope.Children indicates that the descendants of the test may be run in parallel with respect to one another.
> 
> • ParallelScope.Fixtures indicates that fixtures may be run in parallel with one another.

[NUnit Framework-Parallel-Test-Execution](https://github.com/nunit/docs/wiki/Parallel-Test-Execution)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-13T17:15:46.923

Igor Brejc 有一篇关于使用 MbUnit 并行运行测试的博客文章。

However he does say "Once we integrate Selenium into acceptance testing", so it looks like he was just experimenting, I can't find any other posts so I don't know if he has successfully run Selenium tests in parallel.

[http://igorbrejc.net/development/continuous-integration/gallio-running-tests-in-parallel](http://igorbrejc.net/development/continuous-integration/gallio-running-tests-in-parallel)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-20T19:33:06.077

You can use the Task Parallel Library and the DynamicObject class to achieve parallelization of the same test on multiple browsers. See my article [Running Selenium In Parallel with any .NET Unit Testing Tool](http://blog.dmbcllc.com/running-selenium-in-parallel-with-any-net-unit-testing-tool/) for details.

# .net - .NET Framework、CLR 和 Visual Studio 版本号如何相互关联？

> ID：212896
> 
> 赞同：59
> 
> 时间：2008-10-17T16:37:57.060
> 
> 标签：.net, visual-studio, clr, versions

随着最近发布的 .NET 4.0 和 Visual Studio 2010，跟踪哪些 .NET Framework 版本构建在哪个版本的 CLR 以及属于哪个版本的 Visual Studio 变得越来越困难。

是否有明确的表格显示这些关系？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-10-17T16:50:05.290

```
Visual Studio CLR .NET 框架
-------------------------------------------------- --------------------------------------
Visual Studio .NET (Ranier) 1.0.3705 1.0
Visual Studio 2003 (埃弗雷特) 1.1.4322 1.1
Visual Studio 2005 (Whidbey) 2.0.50727 2.0
带有 .NET 3.0 扩展的 Visual Studio 2005 2.0.50727 2.0、3.0
Visual Studio 2008 (Orcas) 2.0.50727 2.0 SP1、3.0 SP1、3.5
Visual Studio 2008 SP1 2.0.50727 2.0 SP2、3.0 SP2、3.5 SP1
Visual Studio 2010（夏威夷）4.0.30319 4.0

```

对此进行一点扩展，并包括 dok1 的回答中的一些信息，Aaron Stebner 的[博客](http://blogs.msdn.com/astebner/archive/2005/07/12/what-net-framework-version-numbers-go-with-what-service-pack.aspx)上提供了 .NET Framework 的不同发布版本的实际版本号，该博客涵盖了从 1.0 到 3.5 SP1 的所有内容。

实际的 Visual Studio 版本号是：

```
产品名称 版本 发货日期
-------------------------------------------------- --------------------------------------
Visual Studio .NET 7.0.?? 02/2002
Visual Studio .NET 2002 Service Pack 1 7.0.??
Visual Studio 2003 7.1.?? 04/2003
Visual Studio 2003 服务包 1 7.1.6030 09/13/2006
视觉工作室 2005 8.0.5072.42
Visual Studio 2005 服务包 1 2006 年 12 月 14 日
Visual Studio 2008 9.0.21022.8 2007 年 11 月 19 日
视觉工作室 2008 SP1 9.0.30729.1
Visual Studio 2010 10.0.30319.1 04/12/2010
Visual Studio 2010 SP1 10.0.40219.1 03/03/2011

```

*请帮助填写缺失的部分。这是我在网上很容易找到的。*

*感谢 @DannySmurf 提供有关 CLR 完整版本号的信息。*

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-05-19T18:30:30.990

请注意，虽然 3.0 基本上只添加了新程序集（相同的 CLR），但 3.5 添加了新程序集、新编译器，并将 CLR 更新到了 SP1 级别。

Framework 4.0 将是一个全新的 CLR（4.0，没有 CLR 3.x），它将与 CLR 1.1 和 2.0 并行运行。它还将拥有 4.0 版的全新程序集，而不是使用 2.0 程序集。

```
框架 CLR 和程序集发布
-------------------------------------------------- --------
1.0 RTM 1.0.3705.0 Visual Studio .NET（又名 VS.NET 2002）
1.0 SP1 1.0.3705.209
1.0 SP2 1.0.3705.288
1.0 SP3 1.0.3705.6018

1.1 RTM 1.1.4322.573 VS.NET 2003
1.1 SP1 1.1.4322.2032
1.1 SP1 1.1.4322.2300 Windows Server 2003

2.0 RTM 2.0.50727.42 Visual Studio 2005 RTM
2.0 RTM 2.0.50727.312 Windows Vista
2.0 SP1 2.0.50727.1433 Visual Studio 2008 RTM 和 .NET 3.5 RTM
2.0 SP2 2.0.50727.3053 Visual Studio 2008 SP1 和 .NET 3.5 SP1
2.0 SP2 2.0.50727.4016 Windows Vista SP2 和 Windows Server 2008 SP2
2.0 SP2 2.0.50727.4927 视窗 7

框架 CLR 新程序集
-------------------------------------------------- --------
3.0 RTM 2.0 RTM 3.0.4506.30 唯一的“带外”非SP框架版本
3.0 SP1 2.0 SP1 3.0.4506.648 Visual Studio 2008 RTM 和 .NET 3.5 RTM
3.0 SP2 2.0 SP2 3.0.4506.2123 Visual Studio 2008 SP1 和 .NET 3.5 SP1

3.5 RTM 2.0 SP1 3.5.21022.8 Visual Studio 2008 RTM 和 .NET 3.5 RTM
3.5 SP1 2.0 SP2 3.5.30729.01 Visual Studio 2008 SP1 和 .NET 3.5 SP1
3.5 SP1 2.0 SP2 3.5.30729.4926 Windows 7

框架 CLR 和程序集发布
-------------------------------------------------- --------
4.0 RTM 4.0.30319.1 Visual Studio 2010

```

（这是从各种答案和链接文档中收集的，尤其是 MSDN 文章*[如何确定 Microsoft .NET Framework 的哪些版本和服务包级别](http://support.microsoft.com/kb/318785)*[由DOK](https://stackoverflow.com/questions/212896/how-do-the-net-framework-clr-and-visual-studio-version-numbers-relate-to-each-o/212912#212912)链接安装。）包含 KB 更新版本和支持停用日期的完整列表可以是在 Wikipedia，*[.NET Framework 版本列表中](http://en.wikipedia.org/wiki/List_of_.NET_Framework_versions)*找到。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-17T16:43:54.413

很难找到，不是吗？我相信这些是版本（忽略服务包）

*   [Visual Studio 版本 6 = .NET](http://en.wikipedia.org/wiki/.NET_Framework)之前的最后一个版本，于 1998 年发布
*   Visual Studio 2002 = 7.1 版，Rainier，第一个 .NET 版本追溯性地将 2002 添加到名称中，.NET 1.0 - 2002 年 2 月发布
*   Visual Studio 2003 = 版本 7，Everett，.NET 1.1——2003 年初发布。
*   Visual Studio 2005 = 版本 8 Whidbey、.NET 2.0 和 3.0 - 于 2005 年 11 月发布。不再称为 Visual Studio .NET
*   Visual Studio 2008 = 版本 9 Orcas，.NET 3.5 -- 于 2007 年 11 月 19 日发布为 9.0.21022.8
*   Visual Studio 2010 = 版本 10 夏威夷

Visual Studio Team System 的下一个版本是 Rosario。

*[如何确定安装的 Microsoft .NET Framework 的版本和服务包级别](http://support.microsoft.com/kb/318785)*将为您提供有关内部版本号和服务包的更多信息，但仅限于 .NET 2.0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-12T22:17:08.467

框架 4.0 RTM

视觉工作室 2010

程序集版本 4.0.30319

日期 2010 年 4 月 12 日

# c++ - Antlr 的优势（相对于 lex/yacc/bison）

> ID：212900
> 
> 赞同：151
> 
> 时间：2008-10-17T16:40:25.637
> 
> 标签：c++, antlr, yacc, bison

我过去曾在各种项目中使用过 lex 和 yacc（通常是 bison），通常是翻译器（例如流入 EDA 应用程序的 EDIF 子集）。此外，我不得不支持基于 lex/yacc 语法的代码，这些语法可以追溯到几十年前。因此，尽管我不是专家，但我知道如何使用这些工具。

过去我在各种论坛上看到过关于 Antlr 的正面评价，我很好奇我可能遗漏了什么。因此，如果您两者都使用过，请告诉我 Antlr 中哪个更好或更高级。我目前的限制是我在 C++ 商店工作，我们发布的任何产品都不会包含 Java，因此生成的解析器必须遵循该规则。

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2008-10-17T16:50:10.670

### 更新/警告：这个答案可能已经过时了！

* * *

一个主要区别是 ANTLR 生成 LL(*) 解析器，而 YACC 和 Bison 都生成 LALR 解析器。这是许多应用程序的重要区别，最明显的是运算符：

```
expr ::= expr '+' expr
       | expr '-' expr
       | '(' expr ')'
       | NUM ; 
```

ANTLR 完全无法按原样处理这种语法。要使用 ANTLR（或任何其他 LL 解析器生成器），您需要将此语法转换为非左递归的语法。但是，Bison 对这种形式的语法没有问题。您需要将 '+' 和 '-' 声明为左关联运算符，但这并不是左递归的严格要求。一个更好的例子可能是调度：

```
expr ::= expr '.' ID '(' actuals ')' ;

actuals ::= actuals ',' expr | expr ; 
```

请注意，the`expr`和`actuals`规则都是左递归的。这在代码生成时会产生更有效的 AST，因为它避免了对多个寄存器和不必要的溢出的需要（左倾树可以折叠，而右倾树不能）。

就个人品味而言，我认为 LALR 语法更容易构建和调试。缺点是你必须处理一些隐晦的错误，比如 shift-reduce 和（可怕的）reduce-reduce。这些是 Bison 在生成解析器时捕获的错误，因此不会影响最终用户体验，但可以使开发过程更有趣。正是因为这个原因，ANTLR 通常被认为比 YACC/Bison 更容易使用。

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2009-12-14T11:41:17.783

YACC/Bison 和 ANTLR 之间最显着的区别是这些工具可以处理的语法类型。YACC/Bison 处理 LALR 语法，ANTLR 处理 LL 语法。

通常，长期使用 LALR 语法的人会发现使用 LL 语法更加困难，反之亦然。这并不意味着语法或工具本质上更难使用。您发现哪种工具更容易使用将主要归结为对语法类型的熟悉程度。

就优势而言，LALR 语法在某些方面比 LL 语法具有优势，在其他方面 LL 语法比 LALR 语法具有优势。

YACC/Bison 生成表驱动解析器，这意味着“处理逻辑”包含在解析器程序的数据中，而不是在解析器的代码中。回报是即使是非常复杂的语言的解析器也具有相对较小的代码足迹。这在 1960 年代和 1970 年代硬件非常有限时更为重要。表驱动的解析器生成器可以追溯到这个时代，当时的主要要求是代码占用空间小。

ANTLR 生成递归下降解析器，这意味着“处理逻辑”包含在解析器的代码中，因为语法的每个产生式规则都由解析器代码中的一个函数表示。回报是通过阅读其代码更容易理解解析器在做什么。此外，递归下降解析器通常比表驱动解析器更快。但是，对于非常复杂的语言，代码占用空间会更大。这是 1960 年代和 1970 年代的一个问题。那时，由于硬件限制，只有相对较小的语言（例如 Pascal）以这种方式实现。

ANTLR 生成的解析器通常在 10.000 行代码左右，甚至更多。手写递归下降解析器通常在同一个球场。Wirth 的 Oberon 编译器可能是最紧凑的编译器，大约 4000 行代码，包括代码生成，但 Oberon 是一种非常紧凑的语言，只有大约 40 条生产规则。

正如有人已经指出的那样，ANTLR 的一大优势是图形 IDE 工具，称为 ANTLRworks。它是一个完整的语法和语言设计实验室。它会在您键入语法规则时将其可视化，如果发现任何冲突，它将以图形方式向您显示冲突是什么以及导致冲突的原因。它甚至可以自动重构和解决左递归等冲突。一旦你有了一个无冲突的语法，你就可以让 ANTLRworks 解析你的语言的输入文件，并为你构建一个解析树和 AST，并在 IDE 中以图形方式显示树。这是一个非常大的优势，因为它可以为您节省大量工作时间：在开始编码之前，您会发现语言设计中的概念错误！我还没有找到任何用于 LALR 语法的此类工具，似乎没有任何此类工具。

即使对于那些不想生成解析器而是手动编码的人来说，ANTLRworks 也是语言设计/原型设计的绝佳工具。很可能是最好的此类工具。不幸的是，如果您想构建 LALR 解析器，这对您没有帮助。仅仅为了利用 ANTLRworks 从 LALR 切换到 LL 可能是值得的，但是对于某些人来说，切换语法类型可能是一个非常痛苦的经历。换句话说：YMMV。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-05-22T13:46:57.823

ANTLR 的几个优点：

*   可以输出各种语言的解析器 - 运行生成的解析器不需要 Java。
*   令人敬畏的 GUI 使语法调试变得容易（例如，您可以在 GUI 中看到生成的 AST，不需要额外的工具）
*   生成的代码实际上是人类可读的（这是 ANTLR 的目标之一），它生成 LL 解析器这一事实在这方面肯定会有所帮助。
*   终端的定义也是上下文无关的（与 (f)lex 中的正则表达式相反） - 因此允许，例如，包含正确闭合括号的*终端的定义*

我的 .02$

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-02T01:19:31.077

ANTRL 的另一个优点是您可以使用[ANTLRWORKS](http://www.antlr.org/works/index.html)，尽管我不能说这是一个严格的优势，因为其他生成器可能也有类似的工具。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-05-31T10:09:59.997

*   Bison 和 Flex 会导致更小的内存占用，但您没有图形 IDE。
*   antlr 使用更多内存，但您有 antlrworks，一个图形 IDE。

Bison/Flex 内存使用量通常为 MB 左右。与 antlr 进行对比——假设它为要解析的文件中的每个标记使用 512 字节的内存。400 万个令牌，而您在 32 位系统上的虚拟内存不足。

如果您要解析的文件很大，antlr 可能会耗尽内存，因此如果您只想解析配置文件，这将是一个可行的解决方案。否则，如果您想解析包含大量数据的文件，请尝试 Bison。

# asp.net - 关于 web.config 的官方、广泛、完整的文档在哪里？

> ID：212902
> 
> 赞同：22
> 
> 时间：2008-10-17T16:41:02.530
> 
> 标签：asp.net, configuration, documentation, web-config

我正在尝试查找我可以设置的所有可能选项`web.config`。令人惊讶的是，我根本找不到这个。我预计它会在[MSDN](http://msdn.microsoft.com)中的某个地方。

我知道我可以在技术上添加“任何东西” `web.config`，我正在寻找的是 .NET Framework“交付”使用的东西。

特别是，现在我对该`<mailsettings>`部分感兴趣。
例如，在我发现的许多示例中，我注意到它们设置了`DeliveryMethod="Network"`. 我真的很好奇这个属性可以取什么其他值。

是否有关于所有属性及其所有值以及它们的所有影响的文档？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-17T16:50:44.727

这一切都始于[http://msdn.microsoft.com/en-us/library/zeshe0eb(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/zeshe0eb(v=vs.100).aspx)：

*   [`<system.web>`](http://msdn.microsoft.com/en-us/library/dayb112d(v=vs.100).aspx)
*   [`<system.web.extensions>`](http://msdn.microsoft.com/en-us/library/bb546044(v=vs.100).aspx)
*   [`<appSettings>`](http://msdn.microsoft.com/en-us/library/ms228154(v=vs.100).aspx)
*   [`<configSections>`](http://msdn.microsoft.com/en-us/library/ms228256(v=vs.100).aspx)
*   [`<connectionStrings>`](http://msdn.microsoft.com/en-us/library/bf7sd233(v=vs.100).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T20:55:02.927

先前答案中包含的链接已失效，但这个 SO 问题是我为“asp.net web.config 文档”获得的第二个 Google 搜索结果。

为了帮助下一个通过这里寻找官方文档的搜索者，这里是一个 msdn.microsoft.com 链接（截至 2012 年 11 月 28 日）工作得很好：

[ASP.NET 配置设置](http://msdn.microsoft.com/en-us/library/b5ysx397%28v=vs.100%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T16:52:20.120

这可能是您所追求的（不是一页中的全部内容），而是架构的顶部 - 递归向下钻取以找到所有内容:)

[ASP.NET 配置设置](http://msdn.microsoft.com/en-US/library/b5ysx397(v=vs.100).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T16:55:35.933

我也发现了这个，特别是 <mailsettings> 部分：

[http://msdn.microsoft.com/en-us/library/w355a94k.aspx](http://msdn.microsoft.com/en-us/library/w355a94k.aspx)

# file - 将扩展关联到程序的脚本

> ID：212906
> 
> 赞同：11
> 
> 时间：2008-10-17T16:41:58.020
> 
> 标签：file, registry, batch-file, openoffice.org, scripting

我的客户正在某些工作站中用 OpenOffice 替换 MS Office。我的程序使用 .xml 扩展名（使用开放格式）将文件导出到 Excel，并使用当前关联的程序（使用 ShellExecute）打开它

问题是 OpenOffice 没有注册与其关联的 .xml 扩展名。

手动关联工作正常，但我想制作一个 .reg 或其他东西来轻松更改设置。

我正在查看已经进行更改的 PC 中的注册表，但是

```
"HKEY_CLASSES_ROOT\.xml" 
```

key 没有任何引用 OpenOffice 的内容。

关联存储在哪里？我怎样才能制作一个脚本来完成这项工作？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-17T16:47:06.823

真正的关联存储在`"HKEY_CLASSES_ROOT\.xml"`指向的键中。

在我的机器上，该键的默认值说`"xmlfile"`，很可能与您的相同。

所以让我们去吧`"HKEY_CLASSES_ROOT\xmlfile"`。在那里您可以看到（并更改）将用于启动该类型文件的命令：

```
HKEY_CLASSES_ROOT\xmlfile\shell\open\command 
```

Windows 使用这种重定向将多个文件扩展名映射到同一个文件类型，从而映射到同一个应用程序。

下面`"HKEY_CLASSES_ROOT\xmlfile\shell"`有多个子键，类似于您可以对文件执行的操作的“动词”。`"shell"`同样，如果您双击文件，则键的默认值决定使用这些动词中的哪一个。就我而言，这是`"open"`.

**结论：**

有了这些知识，使关联可编写脚本的最简单方法是使用 regedit 导出包含该更改的 .reg 文件，然后通过双击将其应用到目标计算机，或者：

```
regedit /s new_xml_association.reg 
```

或者（如果您使用的是 XP 或更高版本并且知道自己在做什么）使用以下命令覆盖当前值：

```
reg add "HKEY_CLASSES_ROOT\xmlfile\shell\open\command" /ve /d "path\to\program %1" 
```

无论如何，`reg add/?`建议对指挥进行更深入的研究。第一种解决方案更安全。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T17:03:25.107

考虑 dos 命令`assoc`：

> C：>关联/？显示或修改文件扩展名关联
> 
> ASSOC [.ext[=[fileType]]]
> 
> .ext 指定将文件类型与 fileType 关联的文件扩展名 指定与文件扩展名关联的文件类型
> 
> 键入不带参数的 ASSOC 以显示当前文件关联。如果仅使用文件扩展名调用 ASSOC，它将显示该文件扩展名的当前文件关联。不为文件类型指定任何内容，该命令将删除文件扩展名的关联。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T17:32:39.463

在这种情况下使用文件关联似乎是错误的做法。*您*希望您的应用程序在 OpenOffice 中打开文件，但如果您的用户希望保持 XML 文件的文件关联不变，该怎么办？如果他们系统上的其他东西也依赖于该关联怎么办？在这种情况下，您正在破坏他们的系统。如果您是 IT 人员，那么也许可以（仍然值得怀疑的编程实践），但如果不是，那么这是一件坏事。

请改用 OpenOffice COM 实现来打开文件。

这里的简单示例： [http ://www.kalitech.fr/clients/doc/VB_APIOOo_en.html](http://www.kalitech.fr/clients/doc/VB_APIOOo_en.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-09-15T15:39:51.170

我只是在寻找相同的答案时遇到了这个问题。我使用 Windows FindExecutable API 找到了一个更好的解决方案，可以使用 PInvoke 从 C# 中使用它。

[http://www.pinvoke.net/default.aspx/shell32.findexecutable](http://www.pinvoke.net/default.aspx/shell32.findexecutable)

# winapi - 将目录的权限设置为具有所有访问权限的每个人都拥有

> ID：212919
> 
> 赞同：1
> 
> 时间：2008-10-17T16:46:41.240
> 
> 标签：winapi

我需要将目录的权限更改为由对该目录具有所有访问权限的所有人用户拥有。我对 Win32 API 有点陌生，所以我有点迷失在 SetSecurity* 函数中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T20:25:41.657

好的，我想通了：

```
SetSecurityInfo(hDir, SE_FILE_OBJECT, DACL_SECURITY_INFORMATION, NULL, NULL, NULL, NULL); 
```

这将为给定目录句柄的所有用户授予所有权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T21:11:29.770

你确定这是个好主意吗？我花了很多时间从 Unix 系统上的文件和目录中删除公共访问（尤其是公共写访问），部分原因是允许任何人删除或添加文件到目录是公开的滥用邀请。

# windows - SDI 中的 OLE 客户端。如何添加工具栏？

> ID：212926
> 
> 赞同：0
> 
> 时间：2008-10-17T16:49:53.450
> 
> 标签：windows, excel, menu, ole

我有一个 SDI，我正在使用 OLE 将 Excel 加载到其中。我想为此添加一个工具栏，我可以使用它来拥有一个非常突出且明显的“导入”按钮（以及其他一些按钮）。当 Excel 激活时，我添加的工具栏`MFC`全部隐藏或从界面中删除。当 Excel Ole 项目变为活动状态时，有没有办法让工具栏保持在界面上？

我试过`FloatControlBar`在初始化 Excel OLE 项后调用，但没有效果。我想将菜单（确实保留并正常运行）扭曲成工具栏，但它需要停靠在左侧（要求）并具有用于命令的大而可见的图形描述......我还没有找到了一种方法来做到这一点。`CMenu`类允许图形菜单项，但我还没有发现一种方法可以对菜单命令本身做很多事情（除了`commandid`在消息表中获取它）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T08:47:06.107

虽然我对 MFC 不是很了解，但我对通过 COM/OLE 与 Microsoft Office 应用程序进行交互有一些经验。我想如果我理解正确，您正在将一个 excel 文档加载到您的应用程序中并在 OLE 窗口中显示？Excel 菜单和按钮会显示在您的应用程序中吗？

如果是这种情况，那么到目前为止，将按钮添加到工具栏的最直接方法是通过启动时加载的模板将其添加到 excel 中。这可以包含您的按钮，然后运行一小段调用您的代码的 VBA 代码。甚至可以调用您通过 MFC 创建的菜单项。

通过 OLE 实现自动化的问题之一是，尽管它非常强大，但一旦 excel 意识到它是在 ole 窗口中运行而不是本机运行，似乎就会出现某些限制。这可能会阻止您创建按钮并将它们显示在您的 ole 窗口中。

希望这有点用。

# mysql - 如何修改 MySQL 列以允许 NULL？

> ID：212939
> 
> 赞同：476
> 
> 时间：2008-10-17T16:52:23.053
> 
> 标签：mysql, syntax, alter

MySQL 5.0.45

更改表以允许列为空的语法是什么，或者这有什么问题：

```
ALTER mytable MODIFY mycolumn varchar(255) null; 
```

我将手册解释为只是运行上面的内容，它会重新创建列，这次允许 null。服务器告诉我我有语法错误。我只是没有看到他们。

* * *

## 回答 #1

> 赞同：705
> 
> 时间：2008-10-17T16:55:11.550

您需要以下内容：

```
ALTER TABLE mytable MODIFY mycolumn VARCHAR(255); 
```

默认情况下，列可以为空。只要该列未声明`UNIQUE`or `NOT NULL`，就不应该有任何问题。

* * *

## 回答 #2

> 赞同：312
> 
> 时间：2008-10-17T16:58:39.093

您的语法错误是由查询中缺少“表”引起的

```
ALTER TABLE mytable MODIFY mycolumn varchar(255) null; 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2011-11-24T09:36:43.153

我的解决方案：

```
ALTER TABLE table_name CHANGE column_name column_name type DEFAULT NULL 
```

例如：

```
ALTER TABLE SCHEDULE CHANGE date date DATETIME DEFAULT NULL; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-09-02T16:15:27.520

在某些情况下（如果你得到“ERROR 1064 (42000): You have an error in your SQL syntax;...”）你需要做

```
ALTER TABLE mytable MODIFY mytable.mycolumn varchar(255); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-04-20T20:35:42.200

我的解决方案与@Krishnrohit 相同：

```
ALTER TABLE `table` CHANGE `column_current_name` `new_column_name` DATETIME NULL; 
```

我实际上将列设置为，`NOT NULL`但通过上面的查询，它被更改为`NULL`.

PS我知道这是一个旧线程，但似乎没有人承认这`CHANGE`也是正确的。

* * *

## 回答 #6

> 赞同：-9
> 
> 时间：2015-08-12T13:21:09.150

采用： `ALTER TABLE mytable MODIFY mycolumn VARCHAR(255);`

# python - 使用 django-rest-interface

> ID：212941
> 
> 赞同：21
> 
> 时间：2008-10-17T16:53:23.020
> 
> 标签：python, django, rest

我有一个 django 应用程序，我想添加一些休息接口。我看过[http://code.google.com/p/django-rest-interface/](http://code.google.com/p/django-rest-interface/)但它似乎很简单。例如，它似乎没有强制执行安全性的方法。我将如何限制人们可以通过其余界面查看和操作的内容？通常我会把这种逻辑放在我的观点中。这是正确的地方还是我应该将更多的逻辑向下移动到模型中？或者那里有更好的图书馆还是我需要自己动手？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-15T14:28:37.620

如果安全是您的主要关注点，我会考虑使用 django-piston [http://bitbucket.org/jespern/django-piston/wiki/Home应用程序。](http://bitbucket.org/jespern/django-piston/wiki/Home)

我过去使用过 django-rest-interface，它可靠且虽然简单但功能强大，但 django-piston 似乎更加灵活。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-18T01:52:44.553

好吧，从外观上看，有一个`authentication`参数 to `Collection`。（见这个例子：[authentication.py](http://django-rest-interface.googlecode.com/svn/trunk/django_restapi_tests/examples/authentication.py)）

其次，（即使 Django 还没有）可能应该有一个中间件来进行 CSRF/XSRF 表单检查。（哦，似乎[有一个](http://docs.djangoproject.com/en/dev/ref/contrib/csrf/#ref-contrib-csrf)。）您还应该能够在 urls.py中使用[`login_required`和`permission_required`装饰器。](http://docs.djangoproject.com/en/dev/topics/auth/#topics-auth)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-18T11:49:51.353

即使使用 Authentication 参数，您也无法细粒度地控制人们可以做什么。Django-REST 接口的当前实现不跟踪用户信息，因此您没有这些信息可用于进行细粒度的授权检查。

请参阅[问题 #32](http://code.google.com/p/django-rest-interface/issues/detail?id=32)。

但是，扩展它以添加一些功能相对容易。我使用很多子类来添加功能。

然而，在 Django 中使用登录信息更新请求是很棘手的。我没有这样做，而是将信息留在集合中。

现在，我估计在补丁和子类之间，我所写的内容与滚动我自己的 RESTful 视图函数一样大。

然而，Django-REST 优雅而整洁地处理 HTTP Digest 身份验证。我不期待为我的 Django 视图函数用某种装饰器替换它们。

[也许我们应该打开一个源代码锻造项目并找出一个干净的替代品？]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-16T14:16:34.390

请看一下 django-rest-framework，我刚从 sweetpie 跨到这个新框架，效果很好！

[http://django-rest-framework.org/](http://django-rest-framework.org/)

尤其是基于类的视图和可浏览的 api！和许多其他优点（例如上传图片）

# bash - 如何将多行输入从标准输入读入变量以及如何在 shell（sh，bash）中打印出来？

> ID：212965
> 
> 赞同：72
> 
> 时间：2008-10-17T16:57:58.410
> 
> 标签：bash, shell, stdin, multiline

我想要做的是以下内容：

1.  `stdin`从变量中读取多行输入`A`
2.  进行各种操作`A`
3.  管道`A`不丢失分隔符（，，，`\n`等`\r`）`\t`到另一个命令

当前的问题是，我无法使用`read`命令读取它，因为它在换行符处停止读取。

我可以用 读取标准输入`cat`，如下所示：

```
my_var=`cat /dev/stdin` 
```

，但后来我不知道如何打印它。这样换行符、制表符和其他分隔符仍然存在。

我的示例脚本如下所示：

```
#!/usr/local/bin/bash

A=`cat /dev/stdin`

if [ ${#A} -eq 0 ]; then
        exit 0
else
        cat ${A} | /usr/local/sbin/nextcommand
fi 
```

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-10-17T17:04:24.917

这对我有用：

```
myvar=`cat`

echo "$myvar" 
```

周围的报价`$myvar`很重要。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-03-07T10:47:31.880

在 Bash 中，有另一种方法；`man bash`提到：

> 命令替换`$(cat file)`可以替换为等效但更快的`$(< file)`.

```
$ myVar=$(</dev/stdin)
hello
this is test
$ echo "$myVar"
hello
this is test 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-02-27T09:33:47.297

**三通**做的工作

```
#!/bin/bash
myVar=$(tee) 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-11-17T04:36:06.660

## [更新]

如果管道中没有任何内容，则此分配将无限期挂起...

```
var="$(< /dev/stdin)" 
```

我们可以通过`read`对第一个字符进行超时来防止这种情况。如果超时，返回码将大于 128，我们将知道 STDIN 管道（又名`/dev/stdin`）是空的。

否则，我们通过...获得 STDIN 的其余部分

*   仅为命令设置`IFS`为 NULL`read`
*   关闭转义`-r`
*   用 .消除读取的分隔符`-d ''`。
*   最后，将它附加到我们最初得到的角色上

因此...

```
__=""
_stdin=""

read -N1 -t1 __  && {
  (( $? <= 128 ))  && {
    IFS= read -rd '' _stdin
    _stdin="$__$_stdin"
  }
} 
```

这种技术避免使用`var="$(command ...)"`命令替换，根据设计，命令替换总是会删除任何尾随的换行符。

如果首选命令替换，为了保留尾随换行符，我们可以将一个或多个分隔符附加到内部的输出中`$()`，然后将它们剥离到外部。

例如*（注意`$(parens)`第一个命令和`${braces}`第二个命令）* ...

```
_stdin="$(awk '{print}; END {print "|||"}' /dev/stdin)"
_stdin="${_stdin%|||}" 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-17T17:12:44.870

是的，它也适用于我。谢谢。

```
myvar=`cat` 
```

是相同的

```
myvar=`cat /dev/stdin` 
```

嗯，是。从`bash`手册页：

> 将字符括在双引号中会保留引号内所有字符的字面值，但 $、`、\ 以及启用历史扩展时的! 除外。字符 $ 和 ` 在双引号中保留其特殊含义。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-09-09T07:01:01.323

如果您确实关心在输出末尾保留尾随换行符，请使用以下命令：

```
myVar=$(cat; echo x)
myVar=${myVar%x}
printf %s "$myVar" 
```

这使用了[这里](http://wiki.bash-hackers.org/syntax/expansion/cmdsubst#examples)的技巧。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-09-14T20:21:14.903

读取也可以使用设置选项 -d [DELIMITER]，其中 `input' DELIMITER 是一个字符长。如果您设置`-read d ''`，则它会读取到 null 或所有输入。

请记住，无论如何，Bash 不能在变量中保存空字节。

```
read -d'' myvar
echo "$myvar" 
```

Obs：虽然不保留尾随换行字节..

# c# - NHibernate 中的多对多删除级联

> ID：212968
> 
> 赞同：14
> 
> 时间：2008-10-17T16:58:51.433
> 
> 标签：c#, nhibernate, many-to-many

我在一个系统中有一个场景，我试图尽可能地简化它。我们有一个（让我们称之为）人工制品表，人工制品可以被任意数量的安全角色访问，安全角色可以访问任意数量的人工制品。因此，我们在数据库中有 3 个表 - 一个描述人工制品，一张描述角色，以及一个将人工制品 ID 链接到角色 ID 的多对多关联表。

在领域方面，我们有两个类——一个用于角色，一个用于人工制品。artefact 类有一个 IList 属性，它返回可以访问它的角色列表。（但是，角色不提供获取可以访问的人工制品的属性）。

因此，人工制品的休眠映射包含以下内容；

```
<bag name="AccessRoles" table="ArtefactAccess" order-by="RoleID" 
    lazy="true" access="field.camelcase-underscore" optimistic-lock="false">
    <key column="ArtefactID"/>
    <many-to-many class="Role" column="RoleID"/>
</bag> 
```

这一切都很好，如果我删除了一个人工制品，关联表将被适当地清理，并且删除的人工制品和角色之间的所有引用都被删除（尽管角色没有被正确删除——因为我们不希望删除孤儿）。

问题是 - 如何删除一个角色并让它自动清除关联表。如果我目前尝试删除一个角色，我会得到一个引用约束，因为该角色的关联表中仍有条目。成功删除角色的唯一方法是查询链接到该角色的所有人工制品，从人工制品的角色集合中删除该角色，更新人工制品，然后删除该角色 - 不是很有效或很好，尤其是在联合国 -简化的系统，角色可以与任意数量的其他表/对象相关联。

我需要能够向 NHibernate 提示我希望在删除角色时清除此关联表 - 这可能吗，如果可以的话 - 我该怎么做？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-02T15:43:20.583

由于我一直在寻找这个答案并在谷歌上找到了这个帖子（没有答案），我想我会发布我的解决方案。带有三个表：Role、RolesToAccess(ManyToMany)、Access。

创建以下映射： 访问：

```
<bag name="Roles" table="RolesToAccess" cascade="none" lazy="false">
      <key column="AccessId" />
      <many-to-many column="AccessId" class="Domain.Compound,Domain" />
    </bag>

<bag name="RolesToAccess" cascade="save-update" inverse="true" lazy="false">
      <key column="AccessId" on-delete="cascade" />
      <one-to-many class="Domain.RolesToAccess,Domain" />
    </bag> 
```

角色：

```
<bag name="Accesses" table="RolesToAccess" cascade="none" lazy="false">
      <key column="RoleId" />
      <many-to-many column="RoleId" class="Domain.Compound,Domain" />
    </bag>

<bag name="RolesToAccess" cascade="save-update" inverse="true" lazy="false">
      <key column="RoleId" on-delete="cascade" />
      <one-to-many class="Domain.RolesToAccess,Domain" />
    </bag> 
```

如上所述，您可以使 RolesToAccess 属性受到保护，这样它们就不会污染您的模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-12T13:41:45.160

你在这里说什么：

> 成功删除角色的唯一方法是查询链接到该角色的所有人工制品，从人工制品的角色集合中删除该角色，更新人工制品，然后删除该角色 - 不是很有效或很好，尤其是在联合国 -简化的系统，角色可以与任意数量的其他表/对象相关联。

没有必要。假设您不想映射关联表（使其成为域对象），您仍然可以用最少的代码在两端执行删除。

假设有 3 个表：Role、Artifact 和 ArtifactAccess（链接表）。在您的映射中，您只有角色和工件的域对象。两者都有一个用于多对多关联的包。

角色：

```
 <bag name="Artifacts" table="[ArtifactAccess]" schema="[Dbo]" lazy="true"
        inverse="false" cascade="none" generic="true">
        <key column="[ArtifactID]"/>

        <many-to-many column="[RoleID]" class="Role" />
    </bag> 
```

神器：

```
 <bag name="Roles" table="[ArtifactAccess]" schema="[Dbo]" lazy="true"
        inverse="false" cascade="none" generic="true">
        <key column="[RoleID]"/>

        <many-to-many column="[ArtifactID]" class="Role" />
    </bag> 
```

如您所见，两端都指定了 inverse=false。NHibernate 文档建议您选择关联的一端作为“反向”端，但没有什么能阻止您将两者都用作“控制端”。在执行更新或插入时，这可以从两个方向顺利进行。在执行任一端的删除时，您会收到 FK 违规错误，因为关联表未更新，true。但是您可以通过在执行删除之前将集合清除到另一端来解决这个问题，这比您所做的要简单得多，如果有使用 'this，则在关联的“另一端”中查找' 结尾。如果这有点令人困惑，这里有一个代码示例。如果您只有一个控制端，对于您的复杂删除，您需要执行以下操作：

```
foreach(var artifact in role.Artifacts)
    foreach(var role in artifact.Roles)
        if(role == roleToDelete)
            artifact.Roles.Remove(role)
    artifact.Save();
roleToDelete.Delete(); 
```

删除角色时我所做的类似于

```
roleToDelete.Artifacts.Clear(); //removes the association record
roleToDelete.Delete(); // removes the artifact record 
```

这是一行额外的代码，但这样您就不需要决定关联的哪一端是反向端。您也不需要映射关联表来进行完全控制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T17:30:00.403

您可以为关联表进行映射，然后对该表调用 delete，其中 Role_id 是您要删除的值，然后执行角色本身的删除。这样做应该相当简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T20:35:31.810

虽然我相信 NHibernate 必须提供一种方法来做到这一点，而无需在角色 C# 类中包含集合，但您始终可以在 SQL 中设置此行为。为数据库中的 FK 选择级联删除，它应该是自动的，只需注意 NHib 的缓存。

但我强烈建议您将此作为最后的资源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T23:08:30.063

您需要创建从 Role 到`Artifact`.

您可以使其延迟加载，并将其映射到受保护的虚拟成员，这样它就不会真正被访问，但您需要该映射以便 NHibernate 知道它必须从`ArtefactAccess`表中删除角色

# asp.net - 使用 JavaScript 重新排列的 ListBox 元素导致回发时发生事件验证错误

> ID：212988
> 
> 赞同：5
> 
> 时间：2008-10-17T17:04:52.717
> 
> 标签：asp.net, javascript, listbox, eventvalidation

我创建了一个包含两个列表框和一些按钮的项目交换器控件，这些按钮允许我在两个列表之间交换项目。交换是使用javascript完成的。我还在列表中上下移动项目。基本上，当我将项目移动到右侧的列表框时，我将元素（GUID）的数据键存储在隐藏字段中。在回发时，我只是从现场读取 GUID。一切正常，但在回发时，我得到以下异常：

> 无效的回发或回调参数。使用配置或页面中的 <%@ Page EnableEventValidation="true" %> 启用事件验证。出于安全目的，此功能验证回发或回调事件的参数是否源自最初呈现它们的服务器控件。如果数据有效且符合预期，请使用 ClientScriptManager.RegisterForEventValidation 方法注册回发或回调数据以进行验证。

我准备了一个测试应用程序。您所要做的就是下载存档并运行项目。在网页上选择 3 个项目，按全部添加，然后将第三个元素上移一级，然后点击“按钮”。错误会出现。关闭事件验证是绝对不能接受的。任何人都可以帮助我，我已经花了两天时间没有找到解决方案。

[测试应用](http://cid-c9672af9b84b07ef.skydrive.live.com/self.aspx/TestApp/TestProject.zip)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T19:08:16.463

问题是列表的保存视图状态和回发时收到的数据不匹配。事件验证问题很可能只是由于这种方法而可能出现的问题之一。webforms 的架构不允许这种用途，而且这种方法很可能会出现更多问题，即使您成功避免了事件验证问题。您有几种选择：

1) 最简单的是在服务器上执行交换逻辑，而不是使用 javascript。这样，在回发之间将保留视图状态，并且多次往返服务器的额外开销可能不是问题。

2）如果到服务器的多次往返是一个问题，请编写一个服务器控件来处理它自己的视图状态。这当然是一种非常吸引人的方法。

3) 一种中间方法可能是使用两个简单的 html 列表（只需编写 html 标记而不使用 asp.net 控件）并在客户端从 javascript 维护隐藏字段中的 id 列表。在回发时，只需解析隐藏字段并提取 id 忽略 html 列表。

如果没有严重的反对意见，我会选择 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T04:52:03.850

几个可能的选择：

*   如果可能，请禁用两个列表上的 ViewState。如果没有 ViewState，服务器将不知道原始值是什么，因此不会出错。使用这种方法，您将需要重新填充列表（由于缺少 ViewState），并且可能需要手动跟踪选择 - 或者需要在 OnInit 阶段填充列表。

*   关闭事件验证（如果可以）

*   在服务器端完全填充两个列表，并根据需要使用客户端脚本 (javascript) 从两个列表中删除条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T17:59:07.710

它抱怨是因为列表中的选定项目在呈现时不存在于列表中。考虑通过 AJAX 使用 PageMethods 将数据返回到表单而不是 PostBack。或者使用非输入控件来保存数据——比如你在列表元素之间来回移动的无序列表。您可以将 GUID 放在列表元素内的隐藏跨度中，如果需要，您可以在其中获取它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T19:26:20.683

第一种选择会带来相当大的开销。我已经定义了我自己的从列表框类派生的自定义列表框控件，并执行了 loadpostback 数据的覆盖：

```
public class CustomListBox : ListBox
{
    protected override bool LoadPostData(string postDataKey, System.Collections.Specialized.NameValueCollection postCollection)
    {
        return true;
    }
} 
```

在我的用户控件中使用它而不是常规列表框解决了问题，但是我的方法是否存在任何风险？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T21:19:37.193

碰巧，你已经试过了吗？每当您以任何方式弄乱列表时，请执行此操作。

```
document.getElementById("listbox").selectedIndex = -1; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-22T05:26:07.097

或者，您可以使用服务器端 HtmlSelect 代替 ListBox 来解决事件验证问题。最重要的是，您可以保留大部分代码隐藏（即列表填充逻辑与 ListBox 相同）。

```
<select runat="server" id="myList" multiple="true" /> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-19T17:42:28.820

您可以覆盖 Render 事件以使用两个列表框注册所有可能的列表框项目。这样，无论将哪些项目移动到哪里，验证都在期待它们。

```
protected override void Render(HtmlTextWriter writer)
{
  foreach (DictionaryEntry entry in ColumnConfig) {          
    Page.ClientScript.RegisterForEventValidation(lstbxColumnsToExport.UniqueID,(string)entry.Key);
    Page.ClientScript.RegisterForEventValidation(lstbxNonExportColumns.UniqueID,(string)entry.Key);
  }
  base.Render(writer);
} 
```

# .net - 以编程方式将 G729 音频转换为 WAV PCM

> ID：212989
> 
> 赞同：5
> 
> 时间：2008-10-17T17:05:05.773
> 
> 标签：.net, audio, codec

我有 G729 编码的音频文件。我需要在一个也在做其他事情的工具流中以编程方式将它们转换为 WAV PCM（16 位 8kHz 单声道）。我有一个可执行文件可以为我做到这一点。但是每次我转换时产生那个外部进程对资源来说太重了。特别是如果我需要其中许多并行完成。寻找可以让我在我的进程中调用它的 .NET 库或代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T17:21:04.150

请点击此链接：[VoiceAge Open G.729 实施](http://www.voiceage.com/openinit_g729.php)。他们还提供用 C 编写的 g729 解码器和编码器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T17:16:44.813

根据 Wikipedia，G.729 包含多项专利并由[Sipra](http://www.spiro.com)授权，因此您可能不会很幸运地找到合适的图书馆。除非您要解码大量非常小的文件，否则与进行解码的成本相比，生成新进程的成本不应该那么大，所以我会说使用您拥有的可执行文件。

就资源而言，是的，与使用线程相比，生成进程需要更多的资源。不过，这并不重要，只要您生成的进程数量与机器中的内核数量一样多。产生更多进程只会浪费资源并且不会为您带来任何额外的并行性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T17:20:05.837

维基百科说：“G.729 包括来自多家公司的专利，并由 Sipro ( [http://www.sipro.com/](http://www.sipro.com/) ) 许可。在许多国家，使用 G.729 可能需要支付许可费和/或特许权使用费。”

但我猜你已经在你的应用程序中考虑到了这一点。

如果您绝对必须在进程中，一种解决方案（不是说它是最好的）可能是使用 LGPL 下的 LibAVCodec。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T17:39:03.287

免费使用的参考实现：[http ://www.readytechnology.co.uk/open/ipp-codecs-g729-g723.1/](http://www.readytechnology.co.uk/open/ipp-codecs-g729-g723.1/)

请注意其他人提出的专利问题，即参考实现仅在英特尔处理器上运行，并且您需要向英特尔支付费用才能使用其 IPP 库作为商业产品的一部分分发代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T18:15:12.793

如果您的系统上有用于 G729 的 ACM 编解码器，则可以使用[NAudio](http://www.codeplex.com/naudio)将其转换为 PCM。尝试使用 NAudio 中包含的 NAudioDemo 应用程序，它将向您显示系统上可用的 ACM 编解码器，并使用它们解码文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-26T07:32:54.657

当谈到 g729 转换器时，首先提示我的是 ITU G729-A 标准。一个非常麻烦的方法是首先将 g729 转换为 pcm，它们在您的 wav 文件前面添加一个 wav 标头。从 .g729 构造一个 .wav。由于ITU官方g729a（并且官方不支持多线程......）lib高度参与了这个想法，我想你必须考虑并发以及如何正确编程g729a lib中的一堆静态变量。我曾经参与在像OP descibes这样的小项目中，我基本上将巨大的g729文件分成g729块，并以合理的并发编程方式单独解码它们......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-24T08:02:22.143

如果您只想查看文件所需的编解码器，请转到[GSopt](http://www.headbands.com/gspot/)并下载最新版本（您可以[单击此处](http://www.headbands.com/gspot/gspot252dl.html)直接打开下载页面）。

After download, extract file open folder and run the `EXE`, Now select the file from the browse button and after file is loaded all its information will be shown. (If file is not shown in the `browse dialogue box` just select `All Files(*.*)` from `browse file dialogue`)

# c++ - 带有逆向工程的简单 C++ UML

> ID：212990
> 
> 赞同：3
> 
> 时间：2008-10-17T17:05:28.410
> 
> 标签：c++

我需要一种从 UML 图构建 C++ 代码的方法，反之亦然。

希望也应该很简单。我不介意付出太多。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T17:08:48.060

您可以尝试[Sparx Enterprise Architect](http://www.sparxsystems.com.au/products/ea/index.html)，但代码质量一般，不是很好。

我不知道有任何出色的 C++ 自动代码生成器

价格从 135 美元起

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T18:56:18.013

Visio 很慢，一天吃掉了整个周末的工作量。不要将它用于 UML。

我过去使用过[UMLStudio——](http://www.pragsoft.com/)它很便宜，而且它在逆向工程我的 C++ 代码以制作图表方面做得不错。使用起来有点奇怪，但是一旦你进入了这个东西的精神，它就快得要命了。

它也会生成代码，但我主要是在“制作漂亮的图表”模式下，而不是像建筑宇航员所说的那样来回尝试使用 UML 应该使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T18:52:04.357

Visio 也支持这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T20:19:01.390

不是您正在寻找的答案，但如果 UML 如此简单，那么只需手动编写代码，从长远来看，您将对项目有更多的控制权。如果您想将此作为一种技术来节省大量重复输入，那么从表面上看，您可能需要首先解决设计问题。

我有点偏见，因为我也会说如果 UML 太复杂，那么无论如何都要自己编写代码，实际上我很少建议从 UML 生成代码。

UML 是一种建模工具，它不是一种编程语言，应该与语言无关。您需要清楚这两个概念是不同的。仅仅因为在您的 UML 模型中有一个概念类，并不意味着在实现该模型时您需要出于各种原因（性能、语言约束等）将其创建为一个类

总之，让设计工具帮你设计，让开发工具帮你设计。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-10T19:54:30.720

[当我在 C++ 课程中使用Borland Together](http://www.borland.com/us/products/together/index.html)时，它在这方面做得很好。教练推荐了它，它似乎功能非常丰富，但我不确定它的成本是多少。

# linux - Linux下模块的CVS选项卡补全

> ID：212994
> 
> 赞同：3
> 
> 时间：2008-10-17T17:06:17.050
> 
> 标签：linux, cvs, tab-completion

如何让选项卡完成以在 Linux 下选择 CVS 模块（最好使用 bash）？

例如，“cvs co” + 选项卡会列出我可以签出的模块。我听说使用 zsh 很容易，但我仍然没有设法让它工作。

另外，如何列出 CVSROOT 中可用的所有可用模块（或存储库？）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T17:19:07.663

有[Bash 完成](http://www.caliban.org/bash/index.shtml#completion)项目。它有一些 cvs 完成，如果它可以确定所有要结帐的模块，我不是 100%。但这将是一个很好的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T17:19:10.987

我认为在 Ubuntu 8.04 中我已经有这种行为（没有可靠的 CVS 存储库来检查）。

/etc/bash_completion 中有很多代码来处理 cvs 完成，可能想看看。

列出 CVSRoot 上的模块的命令是`cvs -d "$the_cvsroot" checkout -c`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T20:26:40.003

实际上，正如你们所说，Ubuntu 已经内置了对 CVS 模块的制表符完成的支持。

我缺少的一件事是，我必须在 CVSROOT/modules 文件中手动添加模块名称及其别名的映射，以便支持的完成工作。

# iphone - Xcode 项目的持续集成？

> ID：212999
> 
> 赞同：56
> 
> 时间：2008-10-17T17:10:44.250
> 
> 标签：iphone, xcode, continuous-integration, cruisecontrol, xcodebuild

在使用 Hudson 与之前的项目进行持续集成之后，我想为我现在正在处理的 iPhone 项目设置一个持续集成服务器。在做了一些研究之后，似乎没有任何专门为 Xcode 设计的 CI 引擎，但是有人成功地[使用了 Cruise Control 和 xcodebuild CLI 工具](http://www.pragmaticautomation.com/cgi-bin/pragauto.cgi/Build/XcodeOnCC.rdoc)。这里有人试过吗？是否有任何与 Xcode 项目配合良好的 CI 引擎？

我可能会尝试巡航控制。我会用我的发现发布答案。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-07-25T18:43:16.623

我在 Mac 上通过 xcodebuild 成功使用了 Hudson。随着 3.0 iPhone sdk 的发布，您可以完全控制要构建项目的目标、配置和 sdk。

就像在 hudson 中创建一个构建步骤并告诉 xcodebuild 构建项目一样简单：

```
xcodebuild -target "myAppAppStore" -configuration "DistributionAppStore" -sdk iphoneos2.1 
```

前期工作为我带来了回报，因为我的构建无需任何额外思考就可以正常工作。如果有人感兴趣，我已经在我的博客上写了详细的描述。

[iPhone 应用程序分发变得容易](http://silent-code.blogspot.com/2009/07/iphone-app-distribution-made-easy-part.html)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-01-31T18:29:24.337

复活这个线程。我没有找到令人满意的解决方案来在构建服务器上使用单元测试自动构建 XCode，因此我进行了一些调查和编码。结果是[这篇博客文章](http://blog.jayway.com/2010/01/31/continuos-integration-for-xcode-projects/)解释了这一切，[这个 Ruby 脚本](http://github.com/ciryon/OCUnit2JUnit)将 OCUnit 输出从 xcodebuild 转换为 JUnit 用于测试报告的 XML 格式。我选择的构建服务器是[Hudson](http://hudson-ci.org/)。

2012 年 3 月 2 日更新：我已对此进行了更新，以使用一些自定义 shell 脚本进行构建和运行。[在这里](https://github.com/ciryon/xcodebuild-script)可用。它不仅有利于持续集成，也有利于在您自己的机器上从命令行构建。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-17T17:39:09.807

Adium非常有效地使用带有 Xcode的[buildbot 。](http://buildbot.net)我们编写了一个简单的 makefile，它使用正确的目标和配置调用 xcodebuild，但我很确定这是可选的。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-06-13T21:01:57.760

Apple 刚刚（2013 年 6 月 10 日）为 OSX Mavericks（OS X 10.9）发布了一个新的持续集成平台，这是我之前见过的集成度最高的持续集成解决方案。它可从 developer.apple.com 获得，此页面的此处有详细信息：

[https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/xcode_guide-continuous_integration/](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/xcode_guide-continuous_integration/)

我建议查看有关该主题的 wwdc 2013 演示文稿。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-20T18:49:37.497

我已经将 CruiseControl 与 Xcode 一起使用（类似于 Pragmatic Automation 的建议）并且取得了相当大的成功。我对 CruiseControl 也非常熟悉，它是相对可怕的配置格式设置。

我也使用 BuildBot 取得了很好的效果，但发现它的优势并不能真正满足我的需求（分布式从站构建和报告跨多个不同系统）。配置 buildbot 设置本身就是一门艺术，尽管它并不困难。这一切本质上都是用python编写脚本。

由于 Hudson 已经可用，我推荐它作为运行持续集成的途径。它有一个基于 Web 的界面（我认为 CruiseControl 的主要缺陷）并且在它支持的各种系统中非常灵活。您可以非常轻松且非常明显地调用命令行驱动的构建。也就是说，我还没有使用 Hudson 和 Xcode 设置实例，而我在其他系统中设置了实例，所以这部分是我的猜测。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-18T14:30:16.570

我认为您应该仍然可以使用 Hudson。Hudson 非常灵活，还允许您使用 shell 脚本进行构建：[Shell 脚本和 Windows 批处理命令](http://hudson.gotdns.com/wiki/display/HUDSON/Building+a+software+project#Buildingasoftwareproject-ShellScriptsandWindowsBatchCommands)

只需输入xcodebuild。查看 xcodebuild 手册页以查看 xcodebuild 的选项。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-27T11:30:37.397

如果您不介意生活在最前沿，我刚刚为 CruiseControl提交了一个[xcode 构建器。](http://blog.jeffreyfredrick.com/2008/11/27/continuous-integration-for-iphonexcode-projects/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-07T17:03:48.647

詹金斯似乎对某些人很有效。（虽然，我之前从未使用过任何 CI 服务器。）

[https://wiki.jenkins-ci.org/display/JENKINS/Xcode+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Xcode+Plugin)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-21T02:00:14.837

詹金斯工作正常。您可以通过编写自己的 shell 脚本来构建您的 xcode 项目，然后让 Jenkins 运行它，或者您也可以使用 xcode 插件。

但是你必须意识到权限问题。只需对 Jenkins 配置稍作调整，您就可以在很短的时间内管理您的 CI 服务器。*****