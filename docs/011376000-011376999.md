# StackOverflow 问答 11376000-11376999

# ajax - tomahawk t:inputFileUpload 不工作

> ID：11376002
> 
> 赞同：0
> 
> 时间：2012-07-07T14:53:10.953
> 
> 标签：ajax, jsf, richfaces, tomahawk

我开发了一个具有以下方面的 jsf 应用程序

*   动态网页模块 2.5
*   爪哇 5
*   JavaServer Faces 1.2
*   丰富的面孔 3.3.2

我有一个带有 t:inputFileUpload 组件的页面。在我将 ajax 和丰富的面孔组件和标签库添加到我的页面之前，它工作正常。如下：-

```
<%@ taglib uri="http://java.sun.com/jsf/html" prefix="h"%>
<%@ taglib uri="http://java.sun.com/jsf/core" prefix="f"%>
<%@ taglib uri="http://myfaces.apache.org/tomahawk" prefix="t"%>
<%@taglib uri="http://richfaces.org/a4j" prefix="a4j"%>
<%@taglib uri="http://richfaces.org/rich" prefix="rich"%>
...
<t:inputFileUpload... 
```

我只想问的是，这些标签库不可能一起工作吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T23:42:51.500

只要您不通过ajax提交表单，它就应该可以正常工作。即不能通过 ajax 使用`<t:inputFileUpload>`. 因此，您需要确保通过同步（非 ajax）请求提交表单。

您还应该确保 Tomahawk在RichFaces*之前*`ExtensionsFilter`已注册，否则它将在 Tomahawk有机会这样做之前消耗请求。`web.xml` *`org.ajax4jsf.Filter``multipart/form-data``ExtensionsFilter`*

 *或者，您可以放弃 Tomahawk`<t:inputFileUpload>`并使用 RichFaces 自己的`<rich:fileUpload>`。它能够使用 Flash 模拟“类似 ajax 的”文件上传。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-05T14:32:03.990

请确保您的表单中有“encrypeType”。

```
<h:form enctype="multipart/form-data"> 
```*

# opengl - OpenGL：使用帧缓冲区对象的多通道渲染

> ID：11376006
> 
> 赞同：1
> 
> 时间：2012-07-07T14:53:38.880
> 
> 标签：opengl, glsl, shader, fbo, multipass

在开发小型 2D 引擎时，我偶然发现了一个小设计问题，不幸的是，以我的知识水平，如果没有您的帮助，我无法解决。

让我解释一下：我正在为其开发 2D 引擎的游戏应该包含复杂的效果，这可能需要多次渲染。问题是，我不确定我是否正确理解了多通道渲染的概念。

在这个知识水平上，我会以这种方式实现它：

1.  最初创建，设置（将其附加到纹理，...）并绑定帧缓冲区对象
2.  现在渲染应该应用效果的东西到 FBO 的附加纹理
3.  在第一遍使用着色器将该纹理渲染到相同的 FBO
4.  取消绑定 FBO 并将附加的纹理渲染到标准 FBO，方法是使用最后一遍的着色器

现在的问题是这是否是解决我的问题的最有效方法，或者是否有更好的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T18:29:20.617

> 在第一遍使用着色器将该纹理渲染到相同的 FBO

您[不能同时读取和写入同一纹理中的同一图像](http://www.opengl.org/wiki/Framebuffer_Object#Feedback_Loops)。好吧，你*可以*，但你会得到未定义的行为，这可能没有帮助。因此，您需要使用多个纹理，或者在可用的情况下使用[NV_texture_barrier](http://www.opengl.org/registry/specs/NV/texture_barrier.txt)。

# actionscript-3 - 从项目渲染器获取数据并在 flex 的主应用程序中使用

> ID：11376007
> 
> 赞同：0
> 
> 时间：2012-07-07T14:53:51.063
> 
> 标签：actionscript-3, flex4, itemrenderer

我在项目渲染器中有一些数据，需要在应用程序级别使用。示例：-我在数据网格中有一个按钮 itemRenderer。当我单击按钮时，我必须携带一些数据以在应用程序级别调度事件。那么如何将项目渲染器数据获取到邮件应用程序中。我编写了一个自定义事件并在主应用程序中侦听该事件。但它不起作用。任何人都可以有更好的想法来解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:13:13.893

如果你想监听从 itemrender 到外部组件的事件，那么事件的气泡值必须为真，默认值为假，所以你必须在自定义变量之后为真......

```
this.dispatchEvent(new customEvent(CutomEventType, CustomVariable, **true)**); 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T15:41:49.903

您可以简单地访问 dataGridId.selectedItem 以在没有事件的情况下获取选择的任何项目，但是您不知道它何时更改。如果您只需要在某些用户操作后知道该值，则可以使用 selectedItem 属性。如果您需要知道它何时更改使用事件绝对是最好的方法，正如 JK Patel 所说，如果您不直接在调度它的对象上监听它，则必须将其标记为冒泡......而不是自定义事件 如果您从渲染器本身分派事件，则可以使用 event.target.data 来获取数据的句柄，而无需自定义事件。

# jquery - 延迟加载中的多个容器

> ID：11376016
> 
> 赞同：6
> 
> 时间：2012-07-07T14:54:46.500
> 
> 标签：jquery, image, jquery-plugins, containers, lazy-loading

我正在尝试将[延迟加载插件](http://www.appelsiini.net/projects/lazyload)应用于多个容器。我发现了这个类似的问题：[Lazy Load on MULTIPLE Horizo​​ntal containers](https://stackoverflow.com/questions/10539557/lazy-load-on-multiple-horizontal-containers)。

这是我的尝试：http: [//jsfiddle.net/BAFMC/](http://jsfiddle.net/BAFMC/)

```
$(".p_outer_content").each(function() {
    var tthis = $(this);
    $(this).find('img').lazyload({
        container: tthis
    });
});​ 
```

但我有与提到的问题相同的问题，即延迟加载仅适用于最后一个容器（.p_outer_content）（这是小提琴中的第三个）。

有谁知道如何解决这个问题或有其他建议？提前致谢'

**编辑：**

好的，每次滚动容器之一时，我都尝试重新应用延迟加载功能：

```
$(".p_outer_content").each(function() {
    var tthis = $(this);
    $(this).find('img').lazyload({
        container: tthis
    });
});

$(".p_outer_content").scroll(function() {
    var tthis = $(this);
    $(this).find('img').lazyload({
        container: tthis
    });

});​ 
```

[http://jsfiddle.net/BAFMC/4/](http://jsfiddle.net/BAFMC/4/)

哪个有效，但我不知道这是否是解决它的好方法。但是有没有人想出更好的解决方案？谢谢'

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T19:43:17.997

LazyLoad 插件中有一个错误。当您提供自定义容器时，会出现全局变量泄漏。我在此分支中添加了最低限度的必要修复。

[https://raw.github.com/marchingants/jquery_lazyload/master/jquery.lazyload.js](https://raw.github.com/marchingants/jquery_lazyload/master/jquery.lazyload.js)

这是一个工作演示[http://jsfiddle.net/BAFMC/5/](http://jsfiddle.net/BAFMC/5/)

我在该示例中直接使用 github 原始文件，但在您的项目中，克隆文件，将其缩小并在本地使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-14T00:51:53.030

为了让多个 div 使用延迟加载，您必须明确提及图像的容器 ID。当你有两个 div`#container1`然后`#container2`写：

`$("#container1 img.lazy").lazyload({ container: $("#container1") });`

`$("#container2 img.lazy").lazyload({ container: $("#container2") });`

代替： `$("img.lazy").lazyload({ container: $("#container1") });`

`$("img.lazy").lazyload({ container: $("#container2") });`

# iphone - 通过在 UIButton1 的方法中调用 UIButton2 的方法来连接 UIButton1 和 UIButton2

> ID：11376019
> 
> 赞同：0
> 
> 时间：2012-07-07T14:55:21.317
> 
> 标签：iphone, uibutton

要将 UIButton1 与 UIButton2 连接，在 UIButton1 的方法中调用 UIButton2 的方法，使 UIButton1 的行为类似于 UIButton2，这不是要求的。UIButton1 仅充当 UIButton2。

UIButton1 是倒带按钮

```
-(void)rewind:(id)sender{
audioPlayer.currentTime = 0;
[timer invalidate];
ContainerViewController *viewController = [[[ContainerViewController alloc] init]autorelease];
viewController.view.frame = CGRectMake(0, 0, 320, 480);
[self.view addSubview:viewController.view]; 
[self.view addSubview:toolbar];
[self playpauseAction:_playButton];
} 
```

UIButton2 是播放暂停按钮

```
-(void)playpauseAction:(id)sender {

if([audioPlayer isPlaying])
{
[sender setImage:[UIImage imageNamed:@"Play Icon.png"] forState:UIControlStateSelected];
[audioPlayer pause];
[self pauseTimer];
[self pauseLayer:self.view.layer];

 }else{
[sender setImage:[UIImage imageNamed:@"52.png"] forState:UIControlStateNormal];
[audioPlayer play];
[self resumeTimer];
[self resumeLayer:self.view.layer];

 if(isFirstTime == YES)
{
    self.timer = [NSTimer scheduledTimerWithTimeInterval:11.0
                                                  target:self
                                                selector:@selector(displayviewsAction:)
                                                userInfo:nil
                                                 repeats:NO];
    isFirstTime  = NO;
}} } 
```

要求是在 UIButton1 方法中调用 UIButton2 方法时，UIButton1 应充当 UIButton1，UIButton2 应充当 UIButton2。

技术上的要求是当按下倒带按钮并且从头开始播放音频文件时，应该有可以暂停的选项。因此，如果我不在 UIButton1 方法中调用 UIButton2 方法，那么我没有可供用户使用的暂停选项。这就是在 UIButton1 方法中调用 UIButton2 方法的原因。

因此，当按下倒带按钮时，它会将播放按钮切换到暂停按钮，这很好，但只是为了测试目的，如果您再次按下倒带按钮，它会暂停，这意味着它充当播放暂停按钮，如果您再次按下倒带按钮，那么它将从头开始玩。

如何阻止 UIButton1 充当 UIButton2。

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T15:08:01.983

好的，按照您的描述进行操作有点复杂，但是据我所知，您希望回放在倒带时暂停，以便用户可以再次按下播放。

在切换按钮之前，您只需要检查一下您是否正在玩游戏。

```
if([audioPlayer isPlaying]) {
  [self playpauseAction:_playButton];
} 
```

所以它只会暂停播放并再次显示播放按钮。那是你要的吗？

# c++ - C++ 中的可选分号

> ID：11376025
> 
> 赞同：7
> 
> 时间：2012-07-07T14:57:03.183
> 
> 标签：c++

以下代码编译良好（每行后没有分号）。为什么公共部分下的每行末尾不需要分号？

注意：在每行之后放一个分号也可以，所以在这里使用分号似乎是可选的。

```
template<typename T>

class Accessor {

    public:

        explicit Accessor(const T& data) : value(data) {}

        Accessor& operator=(const T& data) { value = data; return *this; }
        Accessor& operator=(const Accessor& other) { this->value = other.value; return *this; }
        operator T() const { return value; }
        operator T&() { return value; }

    private:

        Accessor(const Accessor&);
        T value;
}; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-07T15:14:22.123

方法定义后不需要分号。

类定义后需要分号的原因是您可以在定义后立即声明类的实例：

```
class X
{

} x;

//x is an object of type X 
```

对于方法，这个论点显然不成立，所以分号是多余的（尽管是合法的）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-07T15:00:17.737

你的代码是正确的。这就是语言的工作原理。在方法/函数实现的主体之后不需要分号。

如果添加分号，则不会发生任何不好的事情，因为带有分号的空语句就像无操作一样。例如，`x += y;;`是合法的 C++。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T14:59:27.463

您不必在方法声明的右括号之后放置分号。在我见过的大部分代码中，没有这样的分号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T15:18:10.707

要清楚，

```
explicit Accessor(const T& data) : value(data) {} 
```

相当于

```
explicit Accessor(const T& data)
:value(data) // initializer list
{
} 
```

这是一个成员函数定义。这里在函数签名的末尾放置一个分号使其成为一个成员*函数声明*，需要在类之外的程序中的某处定义，如下所示

```
Accessor::Accessor(const T& data)
{
    // some code
} 
```

此外，正如另一个答案所暗示的那样，函数体的结尾不需要在右大括号后使用分号（*类或结构定义*的结尾确实需要它），但在末尾添加一个分号不会产生影响，因为它被视为无操作，这就是您可以在末尾添加分号的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T14:59:48.720

`}`因为 C++ 规则在函数/方法声明之后不需要分号。

# php - 在 MySQL + PHP 中的行之间除数

> ID：11376038
> 
> 赞同：0
> 
> 时间：2012-07-07T14:58:59.980
> 
> 标签：php, mysql, arrays

嗨，我正在研究一种抽奖系统，它将 100 万个随机数分成 x 数量的票，例如 100 万个随机数到 10,000 张票。

每张票都是数据库中的一行，然后我们有另一个表票号，我需要在其中为每张票提供 100 个数字，它们与票号相关。

所以目前这是我的代码：

```
//Amount of the 1 million tickets divided to the tickets
$numbersPerTickets = $_POST['numbersPerTicket'];

//The total cost of the property
$propertyPrice = $_POST['propertyPrice'];

//The total amount of tickets
$totalTickets = NUMBER_CIELING / $numbersPerTickets;

//The ticket price
$ticketPrice = $propertyPrice / $totalTickets;

//Generate array with random numbers up to 999,999
$randomTicketNumbers = createTicketNumbers();

//Creation loop counter
$ticketCreationCount = 1;

//Loop and create each ticket
while($ticketCreationCount <= $totalTickets)
{

    //Create a padded ticket number
    $ticketNumber = str_pad($ticketCreationCount, 6, 0, STR_PAD_LEFT);

    $query = '
        INSERT INTO tickets(
            propertyID,
            ticketNumber,
            price
        )
        VALUES(
            "'.$propertyID.'",
            "'.$ticketNumber.'",
            "'.$ticketPrice.'"
        )
    ';

    $db->query($query);

    //Get the ID of the inserted ticket to use to insert the ticket numbers
    $ticketID = $db->insert_id;

    $loopBreak = $numbersPerTickets;
    $addedNumberCount = 1;

    foreach($randomTicketNumbers as $key => $value)
    {

        $query = '
            INSERT INTO ticketNumbers(
                ticketID,
                number
            )
            VALUES(
                "'.$ticketID.'",
                "'.$value.'"
            )
        ';

        $db->query($query);

        unset($randomTicketNumbers[$key]);

        if($addedNumberCount == $loopBreak){ 
            break;
        }else{ 
            $addedNumberCount++;
        }

    }

    $ticketCreationCount++;

} 
```

但这不起作用，它添加了适量的票，在测试的情况下是 10,000，但是添加了太多的票号，最终超过了随机票数组中的百万个数字，随机票数组只是一个简单的 1 层数组，包含 100 万个随机排序的数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:11:11.643

将 foreach 循环更改为 for：

```
for ($i = 1; $i <= $numbersPerTickets; $i++) {
    $query = ' 
        INSERT INTO ticketNumbers( 
            ticketID, 
            number 
        ) 
        VALUES( 
            "'.$ticketID.'", 
            "'.$randomTicketNumbers[$i].'" 
        ) 
    '; 
```

保证只给你 $numbersPerTickets 迭代并消除迭代器++/中断逻辑的复杂性。

有时简单更好。

请更正我的php！TIA。

# ruby-on-rails - 在 Rails 中从艺术家那里获取所有作品的标题

> ID：11376039
> 
> 赞同：0
> 
> 时间：2012-07-07T14:59:07.910
> 
> 标签：ruby-on-rails, request

所以这就是我想要得到的：对于表格中的每个艺术家，我希望它发布它的名字和他最近创作的三件作品。

这是我到目前为止所拥有的：

```
 class Artist < ActiveRecord::Base
      attr_accessible :image, :name

      has_many :works

    end

    class Work < ActiveRecord::Base
      attr_accessible :artist_id, :exhibition_id, :image, :title

      belongs_to :artist
      belongs_to :exhibition

    end

<% @artists.each do |artist| %>
<div class="one-artist">

    <h3><%= artist.name %></h3>

    <div class="artist-work first-work">
        <%= artist.works.title %>
    </div>

<% end %> 
```

我认为这是一种可以接受的接近艺术家作品的方式，但它似乎失败了。

它给了我以下回复：

```
undefined method `title' for #<ActiveRecord::Relation:0x00000102e89038> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:02:24.327

作品是包含所有作品的关系。如果你想访问，比如说，第一个你应该写类似`artist.works.first.title`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T15:19:02.550

```
<% artist.works.each do |work| %>
    <div class="artist-work">  
        <%= work.title %>
    </div>
<% end %> 
```

# c# - 如何并行循环xmlnodes

> ID：11376043
> 
> 赞同：0
> 
> 时间：2012-07-07T14:59:43.400
> 
> 标签：c#, winforms, parallel-processing

我有以下代码：

```
foreach (XmlNode xn in xnList)
{
 String NAME = xn["name"].InnerText;
} 
```

我想并行启动每个循环。我怎样才能做到这一点？我认为我可以使用以下方法，但我无法弄清楚使其工作的方法：

```
 ParallelOptions parOptions = new ParallelOptions();
        parOptions.MaxDegreeOfParallelism = 4; //only up to 5 threads allowed.
        Parallel.ForEach(xnList.AsEnumerable(), parOptions, xn=>
        { 
         String NAME = xn["name"].InnerText;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:30:16.103

我想出了这个解决方案：

```
 var parallelLoop1 = xnList.Count;
        Parallel.For(0, parallelLoop1, index =>
        {
         String NAME = xnList[index]["name"].InnerText;
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T15:33:24.737

您尝试的操作如下：

```
Parallel.ForEach(xnList.AsEnumerable(),
                 item=>{String NAME = item["name"].InnerText;}); 
```

但是，如果您使用 winform 并且想要执行一些进程并防止等待光标，这是另一个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-06T06:43:45.423

我在下面的链接中找到了这个链接，它允许您在 XmlNodeList 等非泛型集合上并行执行 foreach。

```
// Process the results in parallel
Parallel.ForEach(nodes.Cast<XmlNode>(), options, (thenode) =>
{
    // do stuff
}); 
```

[非泛型集合上的并行 foreach 的详细信息](http://blogs.msdn.com/b/pfxteam/archive/2010/03/02/9971804.aspx)

# iphone - 保存在 NSDocumentDirectory 中导致崩溃

> ID：11376046
> 
> 赞同：0
> 
> 时间：2012-07-07T14:59:57.893
> 
> 标签：iphone, ios, ipad, nsdocumentdirectory

在我的应用程序中，从`camera roll`我选择的（单张/多张图像）中。然后我将这些图像保存在 中`NSDocumentDirectory`，这是我的代码：

```
for (int i = 0; i < info.count; i++) {
    NSLog(@"%@", [info objectAtIndex:i]);
    NSArray *paths = NSSearchPathForDirectoriesInDomains( NSDocumentDirectory,    NSUserDomainMask ,YES );
    NSString *documentsDir = [paths objectAtIndex:0];
    NSString *savedImagePath = [documentsDir stringByAppendingPathComponent:[NSString stringWithFormat:@"Images%d.png", i]];

            ALAssetRepresentation *rep = [[info objectAtIndex: i] defaultRepresentation];
            UIImage *image = [UIImage imageWithCGImage:[rep fullResolutionImage]];

            NSData *imageData = UIImagePNGRepresentation(image);
            [imageData writeToFile:savedImagePath atomically:YES];

            NSLog(@"saving at:%@",savedImagePath);           
 } 
```

从那以后，它工作正常。但是当我在相机胶卷中再次返回然后再次保存（不重新启动应用程序）时，它有时会在实际设备中进行测试时崩溃（大部分时间）或滞后应用程序。我不知道它是`AGImagePicker`我用来导入照片的库还是我保存它的方式。我的储蓄方式是不是`NSDocumentDirectory`错了？或者如果有更好的方法帮助将不胜感激。

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T15:16:08.010

尝试启用僵尸对象并运行

![在此处输入图像描述](../Images/6f267eb0d3318b8e988f39ecf82acdb7.png)

# c# - 如何更正通用排序代码以对可空类型进行排序

> ID：11376047
> 
> 赞同：4
> 
> 时间：2012-07-07T15:00:00.040
> 
> 标签：c#, .net, generics, sorting, nullable

我们一直在使用这种方法对通用 List<> 进行排序。最近，当 T 中的目标属性是可空类型（十进制？）时，我们注意到不正确的结果。任何想法如何纠正？

```
public void SortList<T>(List<T> dataSource, string fieldName, SortDirection sortDirection)
{
    PropertyInfo propInfo = typeof(T).GetProperty(fieldName);
    Comparison<T> compare = delegate(T a, T b)
    {
        bool asc = sortDirection == SortDirection.Ascending;
        object valueA = asc ? propInfo.GetValue(a, null) : propInfo.GetValue(b, null);
        object valueB = asc ? propInfo.GetValue(b, null) : propInfo.GetValue(a, null);

        return valueA is IComparable ? ((IComparable)valueA).CompareTo(valueB) : 0;
    };
    dataSource.Sort(compare);
} 
```

以上代码来自 Phil Hustead 的文章“按对象属性名称排序通用列表和 IEnumerables” [http://www.codeproject.com/Articles/27851/Sorting-Generic-Lists-and-IEnumerables-by-Object-P](http://www.codeproject.com/Articles/27851/Sorting-Generic-Lists-and-IEnumerables-by-Object-P)

例如，对于我的*Employee*具有可为空的十进制属性*Hours*的对象。

可空小时 **107, null, 8, 152, 64, null** 排序为 **8, null, 64, null, 107, 152**。

我认为空值应该排序到列表的开头或结尾。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T15:35:00.563

将您的方法更改为

```
public static void SortList<T>(List<T> dataSource, string fieldName, SortDirection sortDirection)
{
    PropertyInfo propInfo = typeof(T).GetProperty(fieldName);
    Comparison<T> compare = delegate(T a, T b)
    {
        bool asc = sortDirection == SortDirection.Ascending;
        object valueA = asc ? propInfo.GetValue(a, null) : propInfo.GetValue(b, null);
        object valueB = asc ? propInfo.GetValue(b, null) : propInfo.GetValue(a, null);

        if(valueA == null)
        {
            if(valueB == null)
            {
                return 0;
            }
            else
            {
                return asc ? -1 : 1;
            }
        }
        if(valueB == null)
        {
            return asc ? 1 : -1;
        }

        return valueA is IComparable ? ((IComparable)valueA).CompareTo(valueB) : 0;
    };
    dataSource.Sort(compare);
} 
```

主要问题是您只检查`valueA`，`IComparable`并且 if `valueA == null`- 比较返回对象相等，无论`valueB`. 当可空值被装箱时（这正是这里发生的事情），它由实际值或`null`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-23T22:44:55.797

支持可为空值的上述（最终）示例非常适用于我的列表，但仅在某些情况下。我的CustomType 包含四个字段，其中两个是字符串类型，其中两个是DateTime？（可为空的）类型。

当我对任一字符串值进行排序时，效果很好。但是，当我对任一可为空的 DateTime 进行排序时？值，它排序一个 DateTime? 值正确，但它“丢失”了字符串值的信息！

我留下了一个按指定日期时间排序的列表？值，并且仍然包含另一个 DateTime？值，但清空字符串值？

这里有什么想法吗？

# haskell - Emacs 24.1 和 haskell 模式键绑定

> ID：11376051
> 
> 赞同：4
> 
> 时间：2012-07-07T15:00:47.243
> 
> 标签：haskell, emacs

[我在Haskell Emacs](http://www.haskell.org/haskellwiki/Emacs/Keybindings_and_simple_usage)页面上读到，在 haskell 模式中有许多可用的键绑定。我下载了 Emacs 24.1 并加载了一个 Haskell 文件，但绑定不起作用。例如，`C-c C-=`应该插入一个`=`并排列类型签名，但 Emacs 给了我一个`C-c C-= is undefined`.

如何启用这些键绑定？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T15:51:56.600

将此添加到您的 Emacs 配置中：

```
(require 'haskell-indent) 
```

在您正在编辑的任何缓冲区中运行`M-x haskell-indent-mode`。然后`C-c C-=`为我工作。

# c# - BindingSource 获取当前行

> ID：11376053
> 
> 赞同：2
> 
> 时间：2012-07-07T15:01:09.857
> 
> 标签：c#, datasource, generic-list, bindingsource

我无法获得当前行值。我能怎么做？

> ```
> bindingSource1.DataSource = LData; (LData is Generic List) 
> ```

```
public DataRow currentRow
    {
        get
        {
            int position = this.BindingContext[bindingSource1].Position;
            if (position > -1)
            {
                return ((DataRowView)bindingSource1.Current).Row;
            }
            else
            {
                return null;
            }
        }
    } 
```

我无法获得当前行：

```
 MessageBox.Show(currentRow["NAME"].ToString()); 
```

出现错误：InvalidCastException，我该怎么办？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T15:19:59.673

如果您设置为 a而不是 a ，则不能期望有`DataRow`对象。在您的情况下，将包含泛型类型的实例。`bindingSource1.Current``DataSource``List<T>``DataTable``bindingSource1.Current`

我想您正在像这样初始化 LData：

```
LData = new List<T>(); 
```

该属性应如下所示：

```
public T currentRow
{
    get
    {
        int position = this.BindingContext[bindingSource1].Position;
        if (position > -1)
        {
            return (T)bindingSource1.Current;
        }
        else
        {
            return null;
        }
    }
} 
```

您可以像这样读取值（假设`Name`是 的属性`T`）：

```
MessageBox.Show(currentRow.Name); 
```

当然没有经过测试，但这样的东西应该可以工作。使用以下行中的调试器查看`Current`属性的内容实际上是什么样的：

```
return (T)bindingSource1.Current; 
```

# css - 网站布局问题

> ID：11376056
> 
> 赞同：1
> 
> 时间：2012-07-07T15:01:38.670
> 
> 标签：css, layout, width

我的网站有问题。当我调整窗口大小时，一切都保持静止不动，窗口只是跨越一切。

这里有一些图像可以更好地说明它......希望。

这是普通窗口中的网站 - [http://imageshack.us/photo/my-images/407/problem2a.jpg/](http://imageshack.us/photo/my-images/407/problem2a.jpg/)

调整大小时 - [http://imageshack.us/photo/my-images/696/problemim.jpg/](http://imageshack.us/photo/my-images/696/problemim.jpg/)

谁能告诉我问题是什么？我希望我的布局像这个网站一样工作 - [http://www.thisoldbear.com/](http://www.thisoldbear.com/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:11:02.203

下次，请将您的 HTML 和 CSS 代码添加到您的问题中，因为这会使一切变得如此简单，并且您将获得更准确的答案。

通过查看您的照片，我感觉您已经添加了左侧填充/边距（150 像素的东西？）以尝试将您的内容居中，而您确实应该将其添加到您的容器 DIV(s)

```
margin: 0 auto; 
```

这将使内容居中并在调整窗口大小时保持居中

**更新**

HTML

```
<div id="container">
  <header>
    <div id="logo"></div>
    <nav>
      <a href="#">Home</a>
      <a href="#">About</a>
    </nav>
  </header>
</div>
<div class="content">
  ...
</div> 
```

CSS

```
body {
  background: url(../../core/images/bg.png);
  font-family: 'Pontano Sans', sans-serif;
  padding: 0;
  margin: 0;
}

#container {
  width: 100%;
  height: 80px;
  background: url(../../core/images/header.png);
}

#content, header {
  position: relative;
  width: 800px;
  margin: 0 auto;
}

#logo {
  position: absolute;
  top: 0;
  left: 0;
  width: 124px;
  height: 171px;
  background: url(../../core/images/logo.png);
}

nav {
  padding: 0;
  margin: auto 0px auto 150px;
}

nav a {
  text-decoration: none;
  font-size: 17px;
  color: #f4f4f4;
  outline: none;
  margin: 0px 0px 0px 50px;
}
nav a:hover { text-decoration: underline; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T15:15:52.470

检查您分配给最外层布局的宽度（可能是一个 div）。您似乎为页面分配了一个固定宽度，该宽度与您的屏幕分辨率大小大致相同或更大。尝试使用较小的尺寸和属性 margin:0 auto;

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T15:09:49.833

您可能有一个宽度为 1000 像素的大容器，并使用它来使您的布局居中，可能带有边距和填充。

而是放下大容器并仅使用一个容器`margin: auto`将其居中。像这样：

HTML：

```
<body>
    <div id="main-container">
    </div>
</body> 
```

CSS：

```
#main-container {
    width: 800px;
    margin: auto;
} 
```

请注意，您不能`float:left`在主容器上使用。如果您需要（例如用于背景），请包含另一个`width: 100%`没有填充或边距的容器宽度并浮动该宽度。

# c# - 我应该将客户对 API 的特定要求放入 BLL 层吗？

> ID：11376061
> 
> 赞同：1
> 
> 时间：2012-07-07T15:02:25.840
> 
> 标签：c#, wcf, architecture, n-tier-architecture

我必须构建一个小应用程序，它基本上是一个 wcf API，用于对数据库进行 CRUD 操作。我想按该顺序创建一个 DAL --> BLL --> Web 服务层。

在 DAL 中，我打算在 1 对 1 的基础上创建对 db 的基本表 CRUD 操作，1 在表上调用一个操作。

其中一项要求是使用此接口的旧版应用程序需要能够访问 WCF Web 服务，以便每个屏幕都有一个关联的 Web 服务方法。即一个屏幕（业务决定将有一个单一的方法来服务每个屏幕）。

我想知道我是否应该将这些要求构建到 BLL 中，然后通过 web 服务重新公开？或者我应该创建 BLL 来执行逻辑业务操作，然后在顶部构建一个外观，这将创建特定的（上面提到的屏幕到 Web 方法调用要求），然后在 WCF 上重新公开它？

我不想让应用程序过于复杂，但我希望它显然是可扩展的。

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T18:06:26.430

总的来说，我认为保持 BLL 清洁并可供其他需要它的东西使用是有意义的。然后，如果你需要支持一些遗留调用，你的门面想法是一个很好的想法。这将使您的 BLL 保持应有的方式，而外观将编排正确/现有的 BLL 逻辑以服务于遗留应用程序。

以这种方式回答几乎是一种廉价的方式。我的回答是同意你的看法；构建一个外观来支持遗留调用并协调现有的 BLL API 调用。这样你的 BLL 就会保持干净。

# javascript - 如何传递一个整数来创建新的变量名？

> ID：11376063
> 
> 赞同：0
> 
> 时间：2012-07-07T15:02:30.723
> 
> 标签：javascript

我有 50 个名为 animation0、animation1、animation2 等的 svg 动画，我想在将整数 0 到 49 传递给此函数时加载它们：

```
function loadAnimation(value){
    var whichswiffy = "animation" + value;
    var stage = new swiffy.Stage(document.getElementById('swiffycontainer'), whichswiffy);
    stage.start();
} 
```

目前它不起作用，也许它正在传递“whichswiffy”而不是animation10？

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T15:09:24.410

> *“我有 50 个名为 animation0、animation1、animation2 等的 svg 动画。”*

***使用全局变量***

我认为这意味着你有变量。如果它们是全局变量，您可以将它们作为全局对象的属性来访问。

```
var whichswiffy = window["animation" + value]; 
```

* * *

***使用对象而不是变量***

但是如果它们不是全局变量*（或者即使它们是）*，你最好将它们存储在一个对象中......

```
var animations = {
    animation0: your first value,
    animation1: your second value,
    /* and so on */
} 
```

...然后将它们作为该对象的属性访问...

```
var whichswiffy = animations["animation" + value]; 
```

* * *

***使用数组而不是变量***

或者更好的是，只使用一个数组，因为唯一的区别是数字......

```
var animations = [
    your first value,
    your second value,
    /* and so on */
] 
```

然后只需使用索引...

```
var whichswiffy = animations[value]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T15:06:53.560

如果你的变量是全局的，你可以这样做

```
var stage = new swiffy.Stage(document.getElementById('swiffycontainer'), window[whichswiffy]); 
```

# java - 在 OpenGL ES 2.0 中绘制球体

> ID：11376064
> 
> 赞同：2
> 
> 时间：2012-07-07T15:02:46.947
> 
> 标签：java, android, opengl-es, glsl, opengl-es-2.0

我正在尝试在 Android 上的 openGL ES 2.0 中绘制一个球体。我已经查看了相关问题并尝试了他们的一些代码，但我仍然无法让它工作。

基于[Android 开发者示例](http://developer.android.com/training/graphics/opengl/draw.html)和[在 gamedev.net 上找到的这段代码，](http://www.gamedev.net/topic/272001-rendering-a-sphere-unsing-gldrawelements-and-gl_triangle_strip/)我想出了下面的代码。但是它没有正确绘制；使用`glDrawArrays()`渲染工作但结果不正确时，使用时`glDrawElements()`出现`GL_INVALID_OPERATION`错误。我在下面列出了我的缓冲区的内容。

Sphere.java

```
public class Sphere
{
    private int stacks;
    private int slices;
    private float radius;

    //Buffers
    private FloatBuffer vertexBuffer;
    private FloatBuffer colorBuffer;
    private ShortBuffer indexBuffer;

    //Buffer sizes in aantal bytes
    private int vertexBufferSize;
    private int colorBufferSize;
    private int indexBufferSize;

    private int vertexCount;

    private int program;

    static final int FLOATS_PER_VERTEX = 3; // Het aantal floats in een vertex (x, y, z)
    static final int FLOATS_PER_COLOR = 4;  // Het aantal floats in een kleur (r, g, b, a)
    static final int SHORTS_PER_INDEX = 2;  
    static final int BYTES_PER_FLOAT = 4;   
    static final int BYTES_PER_SHORT = 2;   

    static final int BYTES_PER_VERTEX = FLOATS_PER_VERTEX * BYTES_PER_FLOAT;
    static final int BYTES_PER_COLOR = FLOATS_PER_COLOR * BYTES_PER_FLOAT;
    static final int BYTES_PER_INDEX_ENTRY = SHORTS_PER_INDEX * BYTES_PER_SHORT;

    // Set color with red, green, blue and alpha (opacity) values
    private float color[] = { 0.63671875f, 0.76953125f, 0.22265625f, 1.0f };

    public Sphere(float radius, int stacks, int slices)
    {
        this.stacks = stacks;
        this.slices = slices;
        this.radius = radius;

        vertexCount         = (stacks+1) * (slices+1);
        vertexBufferSize    = vertexCount * BYTES_PER_VERTEX;
        colorBufferSize     = vertexCount * BYTES_PER_COLOR;
        indexBufferSize     = vertexCount * BYTES_PER_INDEX_ENTRY;

        program = GLHelpers.createProgram();
        if (program == 0) {
            return;
        }
        GLHelpers.checkGlError("program");

        // Setup vertex-array buffer. Vertices in float. A float has 4 bytes.
        vertexBuffer = ByteBuffer.allocateDirect(vertexBufferSize).order(ByteOrder.nativeOrder()).asFloatBuffer();
        colorBuffer = ByteBuffer.allocateDirect(colorBufferSize).order(ByteOrder.nativeOrder()).asFloatBuffer();
        indexBuffer = ByteBuffer.allocateDirect(indexBufferSize).order(ByteOrder.nativeOrder()).asShortBuffer();    

        generateSphereCoords(radius, stacks, slices);

        vertexBuffer.position(0);
        colorBuffer.position(0);
        indexBuffer.position(0);
    }

    public void draw(float[] modelViewProjectionMatrix)
    {
        GLES20.glUseProgram(program);

        GLHelpers.checkGlError("useprogram");

        int positionHandle = GLES20.glGetAttribLocation(program, "a_Position");
        GLES20.glEnableVertexAttribArray(positionHandle);
        GLES20.glVertexAttribPointer(positionHandle, 3, GLES20.GL_FLOAT, false, BYTES_PER_VERTEX, vertexBuffer);
        GLHelpers.checkGlError("pos");

        //int colorHandle = GLES20.glGetAttribLocation(program, "a_Color");
        //GLES20.glEnableVertexAttribArray(colorHandle);
        //GLES20.glVertexAttribPointer(colorHandle, 4, GLES20.GL_FLOAT, false, BYTES_PER_COLOR, colorBuffer);
        //GLHelpers.checkGlError("color");

        int matrixHandle = GLES20.glGetUniformLocation(program, "u_Matrix");
        GLES20.glUniformMatrix4fv(matrixHandle, 1, false, modelViewProjectionMatrix, 0);

        /*
         * When using glDrawArrays rendering works but the results are not correct, when using glDrawElements I get an GL_INVALID_OPERATION error.
         */
        GLES20.glDrawElements(GLES20.GL_TRIANGLE_STRIP, indexBuffer.capacity(), GLES20.GL_SHORT, indexBuffer);
        //GLES20.glDrawArrays(GLES20.GL_TRIANGLE_STRIP, 0, vertexCount);

        GLHelpers.checkGlError("draw");

        // Disable vertex array
        GLES20.glDisableVertexAttribArray(positionHandle);
        //GLES20.glDisableVertexAttribArray(colorHandle);
    }

    private void generateSphereCoords(float radius, int stacks, int slices)
    {
        for (int stackNumber = 0; stackNumber <= stacks; ++stackNumber)
        {
            for (int sliceNumber = 0; sliceNumber < slices; ++sliceNumber)
            {
                float theta = (float) (stackNumber * Math.PI / stacks);
                float phi = (float) (sliceNumber * 2 * Math.PI / slices);
                float sinTheta = FloatMath.sin(theta);
                float sinPhi = FloatMath.sin(phi);
                float cosTheta = FloatMath.cos(theta);
                float cosPhi = FloatMath.cos(phi);
                vertexBuffer.put(new float[]{radius * cosPhi * sinTheta, radius * sinPhi * sinTheta, radius * cosTheta});
            }
        }

        for (int stackNumber = 0; stackNumber < stacks; ++stackNumber)
        {
            for (int sliceNumber = 0; sliceNumber <= slices; ++sliceNumber)
            {
                indexBuffer.put((short) ((stackNumber * slices) + (sliceNumber % slices)));
                indexBuffer.put((short) (((stackNumber + 1) * slices) + (sliceNumber % slices)));
            }
        }
    }
} 
```

GLHelpers.java

```
public class GLHelpers
{
    private static final String TAG = "GLHelpers";

    private static final String VERTEX_SHADER_CODE =
            "uniform mat4 u_Matrix;" +
            "attribute vec4 a_Position;" +
            "attribute vec4 a_Color;" +
            "varying vec4 v_Color;" +
            "void main() {" +
            "  v_Color = a_Color;" +
            "  gl_Position = a_Position * u_Matrix;" +
            "}";

    private static final String FRAGMENT_SHADER_CODE =
        "precision mediump float;" +
        "varying vec4 v_Color;" +
        "void main() {" +
        "  gl_FragColor = v_Color;" +
        "}";

    private static int loadShader(int shaderType, String source)
    {
        int shader = GLES20.glCreateShader(shaderType);
        if (shader != 0) {
            GLES20.glShaderSource(shader, source);
            GLES20.glCompileShader(shader);
            int[] compiled = new int[1];
            GLES20.glGetShaderiv(shader, GLES20.GL_COMPILE_STATUS, compiled, 0);
            if (compiled[0] == 0)
            {
                Log.e(TAG, "Could not compile shader " + shaderType + ":");
                Log.e(TAG, GLES20.glGetShaderInfoLog(shader));
                GLES20.glDeleteShader(shader);
                shader = 0;
            }
        }
        return shader;
    }

    public static int createProgram()
    {
        int vertexShader = GLHelpers.loadShader(GLES20.GL_VERTEX_SHADER, GLHelpers.VERTEX_SHADER_CODE);
        if (vertexShader == 0)
            return 0;

        int pixelShader = GLHelpers.loadShader(GLES20.GL_FRAGMENT_SHADER, GLHelpers.FRAGMENT_SHADER_CODE);
        if (pixelShader == 0)
            return 0;

        int program = GLES20.glCreateProgram();
        if (program != 0) {
            GLES20.glAttachShader(program, vertexShader);
            GLHelpers.checkGlError("glAttachShader");
            GLES20.glAttachShader(program, pixelShader);
            GLHelpers.checkGlError("glAttachShader");
            GLES20.glLinkProgram(program);
            int[] linkStatus = new int[1];
            GLES20.glGetProgramiv(program, GLES20.GL_LINK_STATUS, linkStatus, 0);
            if (linkStatus[0] != GLES20.GL_TRUE)
            {
                Log.e(TAG, "Could not link program: ");
                Log.e(TAG, GLES20.glGetProgramInfoLog(program));
                GLES20.glDeleteProgram(program);
                program = 0;
            }
        }
        return program;
    }

    public static void checkGlError(String glOperation)
    {
        int error;
        while ((error = GLES20.glGetError()) != GLES20.GL_NO_ERROR)
        {
            Log.e(TAG, glOperation + ": glError " + error);
            throw new RuntimeException(glOperation + ": glError " + error);
        }
    }
} 
```

的内容`vertexBuffer`

```
X               Y               Z
0.0,            0.0,            1.0,
0.0,            0.0,            1.0,
-0.0,           0.0,            1.0,
-0.0,           -0.0,           1.0,
0.0,            -0.0,           1.0,
0.58778524,     0.0,            0.809017,
0.18163562,     0.559017,       0.809017,
-0.4755283,     0.34549147,     0.809017,
-0.4755282,     -0.34549156,    0.809017,
0.18163571,     -0.55901694,    0.809017,
0.95105654,     0.0,            0.30901697,
0.29389262,     0.90450853,     0.30901697,
-0.769421,      0.55901694,     0.30901697,
-0.76942086,    -0.5590171,     0.30901697,
0.29389274,     -0.9045085,     0.30901697,
0.9510565,      0.0,            -0.30901703,
0.2938926,      0.9045085,      -0.30901703,
-0.7694209,     0.5590169,      -0.30901703,
-0.7694208,     -0.55901706,    -0.30901703,
0.29389274,     -0.9045084,     -0.30901703,
0.5877852,      0.0,            -0.80901706,
0.1816356,      0.55901694,     -0.80901706,
-0.47552824,    0.3454914,      -0.80901706,
-0.47552818,    -0.34549153,    -0.80901706,
0.1816357,      -0.5590169,     -0.80901706,
-8.742278E-8,   -0.0,           -1.0,
-2.7015123E-8,  -8.3144E-8,     -1.0,
7.0726514E-8,   -5.138581E-8,   -1.0,
7.072651E-8,    5.138583E-8,    -1.0,
-2.7015135E-8,  8.3143995E-8,   -1.0,
0.0,            0.0,            0.0,
0.0,            0.0,            0.0,
0.0,            0.0,            0.0,
0.0,            0.0,            0.0,
0.0,            0.0,            0.0,
0.0,            0.0,            0.0 
```

的内容`indexBuffer`

```
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] 
```

使用时的结果`glDrawArrays()`：

![结果](../Images/82493a77519d3097097e1cc58d893119.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-11T12:41:14.090

正如所承诺的创建球体的工作代码：

```
 public static Model3D createSphere(float radius, int stacks, int slices)
    {
        int vertexCount = (stacks + 1) * (slices + 1);
        FloatBuffer vertexBuffer        = ByteBuffer.allocateDirect(vertexCount * GLHelpers.BYTES_PER_VERTEX).order(ByteOrder.nativeOrder()).asFloatBuffer();
        FloatBuffer normalBuffer        = ByteBuffer.allocateDirect(vertexCount * GLHelpers.BYTES_PER_NORMAL).order(ByteOrder.nativeOrder()).asFloatBuffer();
        FloatBuffer textureCoordBuffer  = ByteBuffer.allocateDirect(vertexCount * GLHelpers.BYTES_PER_TEXTURE_COORD).order(ByteOrder.nativeOrder()).asFloatBuffer();
        ShortBuffer indexBuffer         = ByteBuffer.allocateDirect(vertexCount * GLHelpers.BYTES_PER_TRIANGLE_INDEX).order(ByteOrder.nativeOrder()).asShortBuffer();

        for (int stackNumber = 0; stackNumber <= stacks; ++stackNumber)
        {
            for (int sliceNumber = 0; sliceNumber <= slices; ++sliceNumber)
            {
                float theta = (float) (stackNumber * Math.PI / stacks);
                float phi = (float) (sliceNumber * 2 * Math.PI / slices);
                float sinTheta = FloatMath.sin(theta);
                float sinPhi = FloatMath.sin(phi);
                float cosTheta = FloatMath.cos(theta);
                float cosPhi = FloatMath.cos(phi);

                float nx = cosPhi * sinTheta;
                float ny = cosTheta;
                float nz = sinPhi * sinTheta;

                float x = radius * nx;
                float y = radius * ny;
                float z = radius * nz;

                float u = 1.f - ((float)sliceNumber / (float)slices);
                float v = (float)stackNumber / (float)stacks;

                normalBuffer.put(nx);
                normalBuffer.put(ny);
                normalBuffer.put(nz);

                vertexBuffer.put(x);
                vertexBuffer.put(y);
                vertexBuffer.put(z);

                textureCoordBuffer.put(u);
                textureCoordBuffer.put(v);
            }
        }

        for (int stackNumber = 0; stackNumber < stacks; ++stackNumber)
        {
            for (int sliceNumber = 0; sliceNumber < slices; ++sliceNumber)
            {
                int second = (sliceNumber * (stacks + 1)) + stackNumber;
                int first = second + stacks + 1;

                //int first = (stackNumber * slices) + (sliceNumber % slices);
                //int second = ((stackNumber + 1) * slices) + (sliceNumber % slices);

                indexBuffer.put((short) first);
                indexBuffer.put((short) second);
                indexBuffer.put((short) (first + 1));

                indexBuffer.put((short) second);
                indexBuffer.put((short) (second + 1));
                indexBuffer.put((short) (first + 1));
            }
        }

        vertexBuffer.rewind();
        normalBuffer.rewind();
        indexBuffer.rewind();
        textureCoordBuffer.rewind();

        Model3D sphere = new Model3D().setVertexBuffer(vertexBuffer)
                                      .setNormalBuffer(normalBuffer)
                                      .setIndexBuffer(indexBuffer)
                                      .setTexture(R.drawable.earth)
                                      .setTextureCoordBuffer(textureCoordBuffer)
                                      .setDiffuseLighting(-3f, 2.3f, 2f);
        return sphere;

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T17:03:30.503

你设置`vertexCount`为`lat * lon * bytes per float`，这对我来说看起来很奇怪。

我认为您错误地命名了这个变量，因为顶点数与每个浮点数的字节数无关。

您在 glDrawArrays 中使用相同的变量，在我看来，它不会有准确的顶点数。

# android - 使用应用程序的通知来调用另一个应用程序/活动

> ID：11376066
> 
> 赞同：0
> 
> 时间：2012-07-07T15:03:09.217
> 
> 标签：android, notifications

如何使用应用程序的通知来启动新应用程序。NotificationManager 没有提供让我访问生成的通知的方法。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:56:03.940

您必须使用创建通知`PendingIntent`。来自[Android 开发者](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)：

```
Context context = getApplicationContext();
CharSequence contentTitle = "My notification";
CharSequence contentText = "Hello World!";
Intent notificationIntent = new Intent(this, MyClass.class);
PendingIntent contentIntent = PendingIntent.getActivity(this, 0, notificationIntent, 0);

notification.setLatestEventInfo(context, contentTitle, contentText, contentIntent);

private static final int HELLO_ID = 1;
mNotificationManager.notify(HELLO_ID, notification); 
```

`MyClass`您要从通知开始的活动在哪里。

# objective-c - Objective C在2个字符串concat之间插入变量

> ID：11376069
> 
> 赞同：4
> 
> 时间：2012-07-07T15:03:45.917
> 
> 标签：objective-c, ios, cocoa-touch, concatenation

我正在尝试执行以下操作（伪）

```
NSString *variable = 'Name'; 
NSString *newString = @"Hello, " + variable + @" blah blah"; 
```

看来它并不像上面的那么简单！有什么帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-07T15:10:28.483

```
NSString *str = @"Hello, ";
str = [str stringByAppendingString:variable];
str = [str stringByAppendingString:@" blah blah"]; 
```

如果你喜欢它作为一行语句

```
 NSString *str = [[@"Hello, " stringByAppendingString:variable] stringByAppendingString:@" blah blah"]; 
```

**迅速**

```
var str = "Hello, " + varaible + "blah blah" 
```

或者

```
var str = "Hello, \(variable) blah blah" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T15:15:15.610

```
NSString *newString = [NSString stringWithFormat:@"Hello, %@ blah blah", variable]; 
```

# java - Servlet 和 TLS

> ID：11376073
> 
> 赞同：0
> 
> 时间：2012-07-07T15:04:42.410
> 
> 标签：java, http, servlets, glassfish-3, ssl

我正在使用 Java EE Servlet 开发一个简单的 Web 服务。

我的客户端是一个简单的 java 应用程序（没有浏览器），所以我需要使用 TLS（或 SSL v3）来保护我的通信。关于应用服务器，我使用的是 Glassfish v3。例如，我需要在 HTTP Post 请求中将一些数据从客户端传输到服务器到安全连接中。我可以使用一些外部库、服务器配置或教程吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:14:21.740

在服务器端，您必须以某种方式通过 HTTPS 公开您的 servlet。如果您使用的是[tomcat](/questions/tagged/tomcat "显示标记为“tomcat”的问题")，请查看[SSL Configuration HOW-TO](http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html)。如果您前面有 Apache Web 服务器，请参阅：[Apache SSL/TLS 加密](http://httpd.apache.org/docs/2.0/ssl/)。

在客户端， JDK 中内置了[ssl](/questions/tagged/ssl "显示标记为“ssl”的问题")和[https](/questions/tagged/https "显示标记为“https”的问题")`https://...`支持，只需使用[`URLConnection`](http://docs.oracle.com/javase/7/docs/api/java/net/URLConnection.html). 但是请记住，您的服务器使用的证书必须是可信的——要么由某个权威机构确认，要么在客户端上手动添加。默认情况下不接受自签名证书。

# css - 现代响应式 HTML5 布局的理想 padding-top 值是多少？

> ID：11376078
> 
> 赞同：0
> 
> 时间：2012-07-07T15:05:30.240
> 
> 标签：css, html, twitter-bootstrap, responsive-design

Twitter Bootstrap 2.0 自带一个of `padding-top`，`20px`主要用来下推容器，让导航栏不隐藏`60px`- 万能的价值。`60px`适合 1280x1024 和更高的布局，但任何低于`1024px`宽度的东西都开始看起来有点太多的空白空间。

我猜这个值也必须响应。以下是 Twitter Bootstrap 响应式 CSS 中的所有媒体查询：

```
@media (max-width: 480px) { ... }
@media (max-width: 767px) { ... }
@media (min-width: 768px) and (max-width: 979px) { ... }
@media (max-width: 979px) { ... }
@media (min-width: 980px) { ... }
@media (min-width: 1200px) { ... } 
```

每个的理想填充值是多少？

**更新：** 20px怎么样？在 320x480 下看起来还不错，在 1920x1080 下也不会太破旧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T18:22:46.960

我只需将导航栏高度移至 padding-top 以保持“twitter bootstrap 精神”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T15:43:26.460

当然，这取决于您要达到的目标！很酷的事情是你也可以有[垂直媒体查询](http://trentwalton.com/2012/01/11/vertical-media-queries-wide-sites/)——也许使用那些来调整你的顶部填充而不是查看视口宽度？

# python - 用 matplotlib 绘制 numpy datetime64

> ID：11376080
> 
> 赞同：24
> 
> 时间：2012-07-07T15:05:43.507
> 
> 标签：python, datetime, numpy, matplotlib

我有两个 numpy 数组 1D，一个是 datetime64 格式的测量时间，例如：

```
array([2011-11-15 01:08:11, 2011-11-16 02:08:04, ..., 2012-07-07 11:08:00], dtype=datetime64[us]) 
```

和其他具有整数数据的相同长度和维度的数组。
我想在 matplotlib 时间与数据中绘制一个图。如果我直接放入数据，这就是我得到的：

```
plot(timeSeries, data) 
```

![在此处输入图像描述](../Images/d5569c93dbb93065aa542e4c18a2496e.png)

有没有办法在更自然的单位中获得时间？例如，在这种情况下，月/年就可以了。

编辑：
我已经尝试过 Gustav Larsson 的建议，但是出现错误：

```
Out[128]:
[<matplotlib.lines.Line2D at 0x419aad0>]
---------------------------------------------------------------------------
OverflowError                             Traceback (most recent call last)
/usr/lib/python2.7/dist-packages/IPython/zmq/pylab/backend_inline.pyc in show(close)
    100     try:
    101         for figure_manager in Gcf.get_all_fig_managers():
--> 102             send_figure(figure_manager.canvas.figure)
    103     finally:
    104         show._to_draw = []

/usr/lib/python2.7/dist-packages/IPython/zmq/pylab/backend_inline.pyc in send_figure(fig)
    209     """
    210     fmt = InlineBackend.instance().figure_format
--> 211     data = print_figure(fig, fmt)
    212     # print_figure will return None if there's nothing to draw:
    213     if data is None:

/usr/lib/python2.7/dist-packages/IPython/core/pylabtools.pyc in print_figure(fig, fmt)
    102     try:
    103         bytes_io = BytesIO()
--> 104         fig.canvas.print_figure(bytes_io, format=fmt, bbox_inches='tight')
    105         data = bytes_io.getvalue()
    106     finally:

/usr/lib/pymodules/python2.7/matplotlib/backend_bases.pyc in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, **kwargs)
   1981                     orientation=orientation,
   1982                     dryrun=True,
-> 1983                     **kwargs)
   1984                 renderer = self.figure._cachedRenderer
   1985                 bbox_inches = self.figure.get_tightbbox(renderer)

/usr/lib/pymodules/python2.7/matplotlib/backends/backend_agg.pyc in print_png(self, filename_or_obj, *args, **kwargs)
    467 
    468     def print_png(self, filename_or_obj, *args, **kwargs):
--> 469         FigureCanvasAgg.draw(self)
    470         renderer = self.get_renderer()
    471         original_dpi = renderer.dpi

/usr/lib/pymodules/python2.7/matplotlib/backends/backend_agg.pyc in draw(self)
    419 
    420         try:
--> 421             self.figure.draw(self.renderer)
    422         finally:
    423             RendererAgg.lock.release()

/usr/lib/pymodules/python2.7/matplotlib/artist.pyc in draw_wrapper(artist, renderer, *args, **kwargs)
     53     def draw_wrapper(artist, renderer, *args, **kwargs):
     54         before(artist, renderer)
---> 55         draw(artist, renderer, *args, **kwargs)
     56         after(artist, renderer)
     57 

/usr/lib/pymodules/python2.7/matplotlib/figure.pyc in draw(self, renderer)
    896         dsu.sort(key=itemgetter(0))
    897         for zorder, a, func, args in dsu:
--> 898             func(*args)
    899 
    900         renderer.close_group('figure')

/usr/lib/pymodules/python2.7/matplotlib/artist.pyc in draw_wrapper(artist, renderer, *args, **kwargs)
     53     def draw_wrapper(artist, renderer, *args, **kwargs):
     54         before(artist, renderer)
---> 55         draw(artist, renderer, *args, **kwargs)
     56         after(artist, renderer)
     57 

/usr/lib/pymodules/python2.7/matplotlib/axes.pyc in draw(self, renderer, inframe)
   1995 
   1996         for zorder, a in dsu:
-> 1997             a.draw(renderer)
   1998 
   1999         renderer.close_group('axes')

/usr/lib/pymodules/python2.7/matplotlib/artist.pyc in draw_wrapper(artist, renderer, *args, **kwargs)
     53     def draw_wrapper(artist, renderer, *args, **kwargs):
     54         before(artist, renderer)
---> 55         draw(artist, renderer, *args, **kwargs)
     56         after(artist, renderer)
     57 

/usr/lib/pymodules/python2.7/matplotlib/axis.pyc in draw(self, renderer, *args, **kwargs)
   1039         renderer.open_group(__name__)
   1040 
-> 1041         ticks_to_draw = self._update_ticks(renderer)
   1042         ticklabelBoxes, ticklabelBoxes2 = self._get_tick_bboxes(ticks_to_draw, renderer)
   1043 

/usr/lib/pymodules/python2.7/matplotlib/axis.pyc in _update_ticks(self, renderer)
    929 
    930         interval = self.get_view_interval()
--> 931         tick_tups = [ t for t in self.iter_ticks()]
    932         if self._smart_bounds:
    933             # handle inverted limits

/usr/lib/pymodules/python2.7/matplotlib/axis.pyc in iter_ticks(self)
    876         Iterate through all of the major and minor ticks.
    877         """
--> 878         majorLocs = self.major.locator()
    879         majorTicks = self.get_major_ticks(len(majorLocs))
    880         self.major.formatter.set_locs(majorLocs)

/usr/lib/pymodules/python2.7/matplotlib/dates.pyc in __call__(self)
    747     def __call__(self):
    748         'Return the locations of the ticks'
--> 749         self.refresh()
    750         return self._locator()
    751 

/usr/lib/pymodules/python2.7/matplotlib/dates.pyc in refresh(self)
    756     def refresh(self):
    757         'Refresh internal information based on current limits.'
--> 758         dmin, dmax = self.viewlim_to_dt()
    759         self._locator = self.get_locator(dmin, dmax)
    760 

/usr/lib/pymodules/python2.7/matplotlib/dates.pyc in viewlim_to_dt(self)
    528     def viewlim_to_dt(self):
    529         vmin, vmax = self.axis.get_view_interval()
--> 530         return num2date(vmin, self.tz), num2date(vmax, self.tz)
    531 
    532     def _get_unit(self):

/usr/lib/pymodules/python2.7/matplotlib/dates.pyc in num2date(x, tz)
    287     """
    288     if tz is None: tz = _get_rc_timezone()
--> 289     if not cbook.iterable(x): return _from_ordinalf(x, tz)
    290     else: return [_from_ordinalf(val, tz) for val in x]
    291 

/usr/lib/pymodules/python2.7/matplotlib/dates.pyc in _from_ordinalf(x, tz)
    201     if tz is None: tz = _get_rc_timezone()
    202     ix = int(x)
--> 203     dt = datetime.datetime.fromordinal(ix)
    204     remainder = float(x) - ix
    205     hour, remainder = divmod(24*remainder, 1)

OverflowError: signed integer is greater than maximum 
```

这可能是一个错误吗？或者我错过了什么。我还尝试了一些简单的方法：

```
import matplotlib.pyplot as plt
import numpy as np
dates=np.array(["2011-11-13", "2011-11-14", "2011-11-15", "2011-11-16", "2011-11-19"], dtype='datetime64[us]')
data=np.array([1, 2, 3, 4, 5])
plt.plot_date(dates, data)
plt.show() 
```

我仍然收到此错误：

```
OverflowError: signed integer is greater than maximum 
```

我不明白我在做什么错。ipython 0.13，matplotlib 1.1，Ubuntu 12.04 x64。

最终编辑： matplotlib
似乎不支持`dtype=datetime64`，所以我需要将.`timeSeries``datetime.datetime``datetime`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-06-20T09:36:28.723

```
from datetime import datetime
a=np.datetime64('2002-06-28').astype(datetime)
plot_date(a,2) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T15:10:29.747

你可能想试试这个：

```
plot_date(timeSeries, data) 
```

默认情况下，x 轴将被视为日期轴，并且是常规轴。这可以定制。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-02-21T11:38:17.233

Matplotlib>=2.2 原生支持绘制 datetime64 数组。请参阅[https://github.com/matplotlib/matplotlib/blob/master/doc/users/prev_whats_new/whats_new_2.2.rst#support-for-numpydatetime64](https://github.com/matplotlib/matplotlib/blob/master/doc/users/prev_whats_new/whats_new_2.2.rst#support-for-numpydatetime64)：

> Matplotlib 在 matplotlib.dates 中长期支持 datetime.datetime 日期。我们现在也支持 numpy.datetime64 日期。任何可以使用 datetime.datetime 的地方，都可以使用 numpy.datetime64。例如：
> 
> ```
> time = np.arange('2005-02-01', '2005-02-02', dtype='datetime64[h]')
> plt.plot(time) 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-14T18:57:53.957

我有一个类似的问题。有时，日期轴正确地绘制了我的 np.datetim64 数组，而在其他时候它没有使用相同的时间数组，而是在日期轴上给出了一些不可识别的整数值。

原因是我在第一次使用对数刻度后设置了 ax.xscale('linear') 。删除 ax.xscale('linear') 解决了这个问题。我了解到，线性轴不是日期时间轴。

# javascript - 骨干.js Collection.add() 不`construct` (`initialize`) 一个对象

> ID：11376082
> 
> 赞同：1
> 
> 时间：2012-07-07T15:06:00.900
> 
> 标签：javascript, backbone.js

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html>
<head>
<script
    src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script
    src="http://documentcloud.github.com/underscore/underscore-min.js"></script>
<script src="http://documentcloud.github.com/backbone/backbone-min.js"></script>
</head>
<body>

    <button id="cmd_create_event" name="cmd_create_event" type="button">Create
        a new `Event`</button>

    <script type="text/javascript">
        var EventModel = Backbone.Model.extend({
            initialize : function() {
                console.log("`Event` is initialized. id: " + this.cid);

                this.bind("change:status", function() {
                    console.log(this.get("status") + " is now the value for `status`");
                });

                this.bind("error", function(model, error) {
                    console.error(error);
                });
            },
            defaults : {
                "status" : 0
            },
            validate : function(attrs) {
                if (attrs.status <= 0)
                    return "invalid status";
            }
        });

        var EventList = Backbone.Collection.extend({
            initialize : function() {
                console.log("`EventList` is initialized");
            },
            model : EventModel,
            add : function(event) {
                console.log("`Event` added to `EventList`.");
            }
        });

        var EventView = Backbone.View.extend({});

        $(document).ready(function() {
            var event_list = new EventList();

            $("#cmd_create_event").click(function() {

                // GENERATION METHOD #1:
                /*var event = new EventModel();
                event.set({
                    status : 1
                });
                event_list.add(event);*/

                // GENERATION METHOD #2:
                event_list.add({
                    status : 1
                });

            });
        });
    </script>

</body>
</html> 
```

在上面的代码中，我使用两种方法将一个添加`EventModel`到一个`EventList`.

方法 #1 会触发`EventModel.initialize()`，而方法 #2 不会。

[文档说](http://backbonejs.org/#Collection-add)可以像方法 #2 一样添加对象，那么，为什么我不像我那样构造对象`new EventModel()`呢？引用文档：

> 如果定义了模型属性，您还可以传递原始属性对象，并将它们作为模型的实例进行激活。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:15:03.013

使用第一种方法，您实际上调用了模型的构造函数

```
var event = new EventModel(); 
```

使用第二种方法，您只需传递`{ status: 1 }`到`EventList.add`您之前定义的方法，该方法仅记录到控制台并且不执行任何操作。

如果你打电话

```
Backbone.Collection.prototype.add.call(this, event); 
```

在您的`EventList.add`方法中，Backbone 从传递的数据创建一个新模型实例`initialize()`并将被调用（因为您`model`在定义时指定了一个属性`EventList`）。

# installation - 安装或编译问题寻求 Debian Squeeze

> ID：11376083
> 
> 赞同：0
> 
> 时间：2012-07-07T15:06:13.767
> 
> 标签：installation, debian

我正在尝试在我的 Debian Squeeze （Linux vserver 2.6.32-5-vserver-amd64）上安装（并编译，但错误最终是由于同样的问题引起的）SeekS

这是我得到的输出：

```
root@vserver:~/seeks# apt-get install seeks 
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:
 seeks : Depends: libevent-2.0-5 (>= 2.0.10-stable) but it is not installable
         Depends: libicu48 (>= 4.8-1) but it is not installable
         Depends: libopencv-calib3d2.3 but it is not installable
         Depends: libopencv-contrib2.3 but it is not installable
         Depends: libopencv-core2.3 but it is not installable
         Depends: libopencv-features2d2.3 but it is not installable
         Depends: libopencv-flann2.3 but it is not installable
         Depends: libopencv-highgui2.3 but it is not installable
         Depends: libopencv-imgproc2.3 but it is not installable
         Depends: libopencv-legacy2.3 but it is not installable
         Depends: libopencv-ml2.3 but it is not installable
         Depends: libopencv-objdetect2.3 but it is not installable
         Depends: libopencv-video2.3 but it is not installable
         Depends: libpcre3 (>= 8.10) but 8.02-1.1 is to be installed
         Depends: libprotobuf7 but it is not installable
         Depends: libstdc++6 (>= 4.6) but 4.4.5-8 is to be installed
         Depends: libtokyocabinet9 (>= 1.4.47) but it is not installable
E: Broken packages 
```

有人知道如何解决吗？我检查了我的曲目，一切似乎都很好。

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T10:59:08.637

我不知道你从哪里得到那个包，但很明显它的依赖关系不能从 Debian/squeeze 中得到满足。以`libicu48`为例：

```
$ rmadison libicu48
 libicu48 | 4.8.1.1-8 | wheezy | amd64, armel, armhf, i386, ia64, kfreebsd-amd64, kfreebsd-i386, mips, mipsel, powerpc, s390, s390x, sparc
 libicu48 | 4.8.1.1-8 | sid    | amd64, armel, armhf, hurd-i386, i386, ia64, kfreebsd-amd64, kfreebsd-i386, mips, mipsel, powerpc, s390, s390x, sparc 
```

的源文件`libicu48`是`icu`，让我们去寻找它：

```
$ rmadison icu
 icu | 4.4.1-8   | squeeze-security | source
 icu | 4.4.1-8   | squeeze          | source
 icu | 4.8.1.1-8 | wheezy           | source
 icu | 4.8.1.1-8 | sid              | source 
```

看起来你将不得不从源代码构建包。 `libstdc++`, `libicu*`, `libevent*`,`libpcre3`可能不会有太大问题。

# php - MySQL 查询 - WHERE 和 IF？

> ID：11376084
> 
> 赞同：1
> 
> 时间：2012-07-07T15:06:18.727
> 
> 标签：php, mysql, if-statement, pdo

已解决：国家和操作系统表中的数据类型设置为 VARCHAR，因此在我的位置中，我将 = 0 更改为 = '0'。感谢raina77ow 指出这一点！欣赏它。

我不太确定如何编写此查询。基本上，我将有一个包含两列（OS 和 country_code）的表——还有更多列，但这些是有条件的。这些将被设置为全部或特定的 0，以逗号分隔。

现在，如果 OS 和 country_code = 0，或者如果它们包含匹配数据（用逗号分隔），我想要实现的是从表中提取数据。

然后，我有一个时间专栏。我想选择时间大于时间列的行，除非列 time_t 设置为 false，在这种情况下，这无关紧要。

我希望我解释得对吗？

到目前为止，这就是我所拥有的：

```
$get = $db->prepare("SELECT * FROM commands 
    WHERE country_code = 0 OR country_code LIKE :country_code 
    AND OS = 0 OR OS LIKE :OS 
    AND IF (time_t = 1, expiry > NOW())
");
$get->execute(array(
    ':country_code' => "%{$data['country_code']}%",
    ':OS' =>  "%{$data['OS']}%"
)); 
```

编辑：这是我现在使用的代码，但我似乎仍然无法让操作系统和 Country_code 部分正常工作：

```
$get = $db->prepare("SELECT * FROM commands 
WHERE (country_code = 0 OR country_code LIKE :country_code) 
AND (OS = 0 OR OS LIKE :OS) 
AND (time_t <> 1 OR expiry > NOW())
");

$get->execute(array(
':country_code' => "%{$data['country_code']}%",
':OS' =>  "%{$data['OS']}%"
)); 
```

发送到数据库的数据将是： OS => Windows 7 country_code => GB 仅发送一个，不超过一个。我现在遇到的问题是，它适用于操作系统和时间，但不适用于国家。我什至尝试了一个原始查询，当表中的数据是“FR，SA”并且我做了 LIKE '%GB%' 它仍然返回了该行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:10:04.070

这是逻辑运算符优先级的问题：`AND`高于`OR`阶梯，因此您的原始查询将被执行为...

```
WHERE country_code = 0 OR (country_code LIKE ... AND OS = 0) OR OS LIKE... 
```

使用括号分隔您的条件，如下所示：

```
WHERE (country_code = 0 OR country_code LIKE ...) 
  AND ( OS = 0 OR OS LIKE ...) 
```

我想，这个查询中的最终过滤条件应该写成......

```
AND ( time_t <> 1 OR expiry > NOW() ) 
```

更新：...实际上应该是`country_code = '0'`您的代码中的类似内容。请记住，您正在检查 VARCHAR 列。

# c++ - c++中的奇怪类型

> ID：11376085
> 
> 赞同：8
> 
> 时间：2012-07-07T15:06:23.320
> 
> 标签：c++, types, reference, parameters

我有一个原型方法：

```
 bool getAssignment(const Query& query, Assignment *&result); 
```

我对第二个参数 ( `Assignment *&result`) 的类型有点困惑，因为我认为我以前从未见过类似的东西。它的用法如下：

```
 Assignment *a;
 if (!getAssignment(query, a))
    return false; 
```

它是对指针的引用还是相反？或者两者都不是？任何解释表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-07T15:07:12.883

它是对指针的引用。这个想法是能够改变指针。它就像任何其他类型一样。

* * *

详细解释和示例：

```
void f( char* p )
{
    p = new char[ 100 ];
}
int main()
{
    char* p_main = NULL;
    f( p_main );
    return 0;
} 
```

不会更改`p_main`为指向分配的 char 数组（这是明确的内存泄漏）。这是因为您**复制**了指针，它是按值传递的（就像`int`按值传递；例如`void f( int x )`!= `void f( int& x )`）。

所以，如果你改变`f`：

```
void f( char*& p ) 
```

现在，这将通过`p_main`引用传递并改变它。因此，这不是内存泄漏，在执行 后`f`，`p_main`将正确指向分配的内存。

* * *

PS 同样可以通过使用双指针来完成（例如，`C`没有引用）：

```
void f( char** p )
{
    *p = new char[ 100 ];
}
int main()
{
    char* p_main = NULL;
    f( &p_main );

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-07T15:18:46.933

对于这样的事情，您基本上是从右到左（或由内而外）阅读声明。

换句话说，你想从被声明的项目的名称开始，然后向外推进。在这种情况下，直接从名称到类型，我们得到：

![在此处输入图像描述](../Images/087b9bad0ca760cfa30aa3b5c78289af.png)

# c - 此函数声明的预期符号问题

> ID：11376086
> 
> 赞同：2
> 
> 时间：2012-07-07T15:06:31.103
> 
> 标签：c, qt, cmake

我刚刚回到 C 编程领域，我遇到了一个我认为与链接器相关的问题。

我也是第一次使用 cmake，所以这可能会增加我的挫败感。

我已经包含了一个第三方头文件，其中包含我的代码尝试使用的 typedef，它有这一行：

```
typedef struct pcap pcap_t; 
```

所以我的代码有

```
pcap_t *var;
//later.....
var->fd;// this line throws the error 
```

抛出

```
error: dereferencing pointer to incomplete type 
```

那么我只是缺少另一个包含文件，还是这是链接器问题？我正在 QtCreator 中构建此代码并使用 cmake。我可以深入 a_t 以查看包含的标头中的 typedef 声明，但我似乎无法深入“struct a”本身以查看它的来源。

谢谢

编辑了上面的代码以反映我正在使用 pcap 库

所以我在源文件的头文件中包含了以下几行

```
#include <net/bpf.h>
#include <pcap/pcap.h> 
```

所以我猜这两个包括之间，我错过了 pcap 结构的定义。我在哪里可以找到它？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T16:31:59.577

该`typedef`声明做了两件事。它声明了某种类型的存在`struct a`。它还声明 that`a_t`是`struct a`. 在没有任何信息来确定其大小的情况下声明类型的存在被 C 语言称为*不完整类型*。该声明通俗地称为*前向声明*，并且该类型通俗地称为对那些永远无法看到类型定义的代码部分*不透明。*

```
typedef struct a a_t;
a_t *var; 
```

C 语言允许定义指向不完整类型的指针。指向不完整类型的指针本身并不是不完整的，因为指向类型的指针与 void 指针大小相同。但是，您的代码随后会尝试取消引用该指针：

```
var->member; 
```

由于没有`struct a`可用的定义，编译器在你的程序中发现了一个错误，并告诉你它。这不是链接器问题，而是程序中的语义错误。

不透明类型是一种向该类型的用户隐藏实现细节的方法。也就是说，它是 C 提供接口的方式：

```
typedef struct a a_t;

a_t *a_create ();
void a_destroy (a_t *);
int a_get_member (a_t *);
void a_set_member(a_t *, int); 
```

然后，在您的代码中，您应该使用该接口。

```
a_t *var = a_create();
a_set_member(var, 10);
int m = a_get_member(var);
a_destroy(var); 
```

实现接口的源文件实际上会定义`struct a`外观。由于您说您在调试器中没有要引用的定义，这可能意味着您没有在程序的任何地方提供定义。

**编辑：**您似乎正在尝试使用数据包捕获库。您需要将`<pcap.h>`头文件包含到您的代码中，并使用`-lpcap`. 如果头文件或库不存在，您将需要为您的操作系统安装数据包捕获开发包。已经为它`<pcap.h>`创建了一个 typedef `pcap_t`，并且它是故意不透明的。所以你必须使用头文件定义的接口来访问你想要的信息。

# objective-c - 使用 UIImage 定义背景图像

> ID：11376087
> 
> 赞同：1
> 
> 时间：2012-07-07T15:06:47.373
> 
> 标签：objective-c, ios, background, uiimageview

我正在使用头文件为我的应用程序设置背景。我有类似的东西：

```
#define backgroundImage [UIColor colorWithPatternImage:[UIImage imageNamed:@"background.jpeg"]] 
```

但我想使用`UIImageView`而不是`UIColor`. 我知道我可以做到：

```
UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)
[imageView setImage:[UIImage imageNamed:@"background.png"]];
self.tableView.backgroundView = imageView; 
```

但是我该如何使用它`#define`呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T00:18:16.717

#define 是一个预处理指令。这将做的是你使用的任何地方`backgroundImage`你会得到`[UIColor colorWithPatternImage:[UIImage imageNamed:@"background.jpeg"]]`

处理此问题的最佳方法是使用 #define 指定图像名称：

```
#define kBackgroundImage @"background.png" 
```

然后在您的代码中使用它：

```
// Use the table view bounds so the background view is the size of the table view
UIImageView *imageView = [[UIImageView alloc] initWithFrame:self.tableView.bounds;

[imageView setImage:[UIImage imageNamed:kBackgroundImage]];
self.tableView.backgroundView = imageView; 
```

但是，如果你想，你可以这样做：

```
#define kBackgroundImage [UIImage imageNamed:@"background.png"] 
```

和：

// 使用table view bounds 所以背景view是table view的大小 UIImageView *imageView = [[UIImageView alloc] initWithFrame:self.tableView.bounds;

```
[imageView setImage:kBackgroundImage];
self.tableView.backgroundView = imageView; 
```

如果您选择将整个代码块作为预处理器定义，您可以使用它`\`来创建新行。

```
#define UIImageView *imageView = [[UIImageView alloc] initWithFrame:self.tableView.bounds; \
[imageView setImage:[UIImage imageNamed:kBackgroundImage]]; \
self.tableView.backgroundView = imageView; 
```

# compiler-construction - 词法分析器的目的是什么？

> ID：11376089
> 
> 赞同：5
> 
> 时间：2012-07-07T15:07:07.323
> 
> 标签：compiler-construction, lexical-analysis

我正在阅读[这个问题的答案。](https://stackoverflow.com/questions/2842809/lexers-vs-parsers) 我似乎找不到为什么有人需要单独**使用词法分析器的答案**

它是程序在编译过程中经历的步骤之一吗？有人可以简单地解释一下为什么我需要一个词法分析器，它的用途是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T10:45:51.320

词法分析器将获取输入字符流并将其转换为标记。

这可以用于多种目的。您可以对词位应用转换以进行简单的文本处理和操作。

或者可以将词位流提供给解析器，解析器将其转换为解析器树。

如果目标是编译，那么词法分析是第一步。将其视为获取字符并将其转换为标记的较低级别的步骤。解析器是一种更高级别的机制，其字母表由标记（由词法分析器创建）组成，它解析并创建解析树。

如果目标是文本操作，那么操作规则可以应用于词位本身。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-07T15:13:46.530

[Wikipedia http://en.wikipedia.org/wiki/Lexical_analysis](http://en.wikipedia.org/wiki/Lexical_analysis)就是一个很好的例子。

例如，如果要计算表达式“(33+3)*2”，第一步是将字符串拆分为标记“(”、“33”、“+”、“3”、“)”、“* ”、“2”。据我记得我的编译器课程是由最长匹配词自动机完成的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-08-21T09:38:13.303

重要的是要知道*您不需要词法分析器*进行解析。

词法分析器是许多编译器用来在某些方面*简化*解析的*传统步骤。*但它并不总是简化解析，事实上它可能会因为它创建中间对象而减慢解析速度。自上而下的递归下降解析器或诸如 PEG 解析表达式语法之类的东西不使用词法分析器，而是直接解析整个文本。

 *词法分析器可用于在概念上简化解析，但这不是必需的。*

# php - 在joomla中从组件获取数据到模块

> ID：11376091
> 
> 赞同：0
> 
> 时间：2012-07-07T15:07:42.633
> 
> 标签：php, joomla, joomla-extensions, joomla2.5, joomla-module

我在 joomla 2.5 中创建了一个模块，我想从一个组件获取数据到一个模块配置，就像这个会发生什么：

```
<field
 name="catid"
 type="category"
 extension="com_content"
 published=""
 label="Category"
 description="A content category"/> 
```

我知道我的模块 XML 配置文件中的这个特定示例代码能够从组件 com_content 中获取类别列表，但我无法弄清楚它来自哪里，joomla 是如何做到的？我也可以启用我的自定义组件吗？如果是的话怎么办？我不确定这个论坛之前是否有人问过这个问题，但我真的很难弄清楚你是否能给我一个链接来教我如何做到这一点，那就太好了。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T00:34:23.690

当您创建一个包含各种`model`s 的组件时，您可以`forms`为它们创建自定义，因为您可能知道。这让 Joomla! 为您做很多后端表单工作 - 您所要做的就是在 XML 文件中定义表单的内容/结构。

当然，Joomla！无法了解每种数据类型，因此表单需要可扩展。为此，Joomla！提供对自定义表单字段类型的支持......这些`forms`在模型中的目录旁边定义，在一个`fields`目录中。

通过定义一个`extension`和`type`值，你告诉 Joomla！使用该特定扩展的字段类型。因此，对于您的示例字段，Joomla 将寻找`/administrator/components/com_content/models/fields/cateogry.php`

您可以在有关创建组件的教程中阅读有关“[添加新字段类型”的更多信息。](http://docs.joomla.org/Developing_a_Model-View-Controller_%28MVC%29_Component_for_Joomla!2.5_-_Part_06#Adding_a_new_field_type)

# objective-c - ios - 如何连接字符串以创建 url？

> ID：11376093
> 
> 赞同：0
> 
> 时间：2012-07-07T15:07:48.087
> 
> 标签：objective-c, ios, ios5, nsstring

我试图通过首先收集参数来创建一个 url，然后在一个语句中创建实际的 url。这是我正在尝试做的事情：

```
NSString *urlString = @"http://www.some_login_url.com?email=%@&password=%@";

NSString *email = self.email.text;
NSString *password = self.password.text;

NSString *url_to_send = [NSString stringWithFormat:@"%@%@", urlString , email , password]; 
```

所以我想做的是用变量中的值替换@符号，但第二个变量只是被附加到字符串的末尾。

我将如何更改最后一行，以便将正确的参数放在正确的位置？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:10:05.560

我想你的意思是：

```
NSString *url_to_send = [NSString stringWithFormat:urlString , email , password]; 
```

但是您可能想寻找方法来构造一个正确转义参数等的 URL。例如，请参阅[这个问题](https://stackoverflow.com/questions/1250212/encoding-string-arguments-for-urls)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T15:10:46.923

urlString*是*你的格式，所以你想要：

```
NSString *url_to_send = [NSString stringWithFormat:urlString , email , password]; 
```

# javascript - 如何将.js文件中的JS函数调用到.jsp文件中？

> ID：11376094
> 
> 赞同：7
> 
> 时间：2012-07-07T15:07:55.603
> 
> 标签：javascript, jsp

我正在尝试将 .../js/index.js 文件中的 javaScript 函数调用到 .../index.jsp 文件。

任何建议都会有所帮助。

这是两个文件中的代码：

## index.js

```
function testing() {

    if ("c" + "a" + "t" === "cat") {
        document.writeln("Same");
    } else {
        document.writeln("Not same");
    };
}; 
```

## 索引.jsp

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Insert title here</title>
</head>
<body>

    <script type="text/javascript" src="js/index.js">

       <!-- I want to call testing(); function here -->

    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-07T15:09:32.600

首先引用外部`index.js`文件，然后在内联脚本元素中调用该函数：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Insert title here</title>
</head>
<body>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
       testing();
    </script>
</body>
</html> 
```

顺便说一句，您的 test.js 函数中有错误。您不应该`;`在 if/else 条件之后放置，也不应该在函数声明的末尾放置。正确的语法是：

```
function testing() {
    if ("c" + "a" + "t" === "cat") {
        document.writeln("Same");
    } else {
        document.writeln("Not same");
    }
} 
```

或者：

```
var testing = function() {
    if ("c" + "a" + "t" === "cat") {
        document.writeln("Same");
    } else {
        document.writeln("Not same");
    }
}; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-06-18T06:13:55.193

你可以这样做

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<script type="text/javascript" src="js/index.js"></script>
<title>Insert title here</title>
</head>
<body>
<input type = "button" onclick = "javascript:testing()"/>
</body>
</html> 
```

这是最简单的

# java - 值未插入android中的数据库

> ID：11376100
> 
> 赞同：1
> 
> 时间：2012-07-07T15:08:46.387
> 
> 标签：java, android

下面给出的是我的代码。

我有 2 节课：`Dbhelper.java`和`RssActivity.java`

基本上我已经制作了一个`students`表格，我的代码正在创建表格，但没有将值插入其中。

有2个文本框：一个用于输入名称，另一个用于输入`roll no`。

我希望当`roll no`谎言在 00113202709 到 12013203709 范围内时插入这些值

我希望这些值应该从 2 个文本框中获取`editText1`并`editText2`插入到我的数据库表中。

谢谢你的帮助。

dbhelper.java：

```
public class Dbhelper extends SQLiteOpenHelper {

//private static final String TAG = Dbhelper.class.getSimpleName();

public static final String db_name = "member.db";

public static final int db_version = 1;

public final String TABLE = "students";

public static final String C_ID = BaseColumns._ID;

public static final String C_Name = "SName";

public static final String C_ENo = "Enroll No";

private Context context;

public Dbhelper(Context context) {

    super(context, db_name, null, db_version);
    this.context=context;

}

@Override
public void onCreate(SQLiteDatabase db) {

    String sql = String.format(
            "create table %s (%s TEXT primary key, %s TEXT, %s TEXT )",
            TABLE, C_ID, C_Name, C_ENo);

db.execSQL(sql);

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // TODO Auto-generated method stub
    db.execSQL("drop table if exists " + TABLE);
    this.onCreate(db);

}
} 
```

RssActivity.java：

```
public class RssActivity extends Activity implements OnClickListener {

TextView Title;
EditText Name, ENo;
Button but;
public String n1 = "001";
public String n2 = "120";
public String s1, s2, s3;
Dbhelper obj;
SQLiteDatabase db;
ContentValues val;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Title = (TextView) findViewById(R.id.textView1);
    Name = (EditText) findViewById(R.id.editText2);
    ENo = (EditText) findViewById(R.id.editText1);
    but = (Button) findViewById(R.id.button1);
    but.setOnClickListener(this);
    obj=new Dbhelper(RssActivity.this);
    db=obj.getWritableDatabase();
}

public void onClick(View v) {
    String name = Name.getText().toString();
    String enr = ENo.getText().toString();

    try {

        if (name.equals("")) {
            Name.setError(getText(R.string.Empty));
            Toast.makeText(this, R.string.Empty, Toast.LENGTH_LONG).show();

        } else if ((ENo.getText().toString().length() == 0)) {
            ENo.setError(getText(R.string.Empty));
            Toast.makeText(this, R.string.Empty, Toast.LENGTH_LONG).show();

        } else if ((ENo.getText().toString().length() < 11))

        {
            ENo.setError(getText(R.string.Invalid));
            Toast.makeText(this, R.string.Invalid, Toast.LENGTH_LONG)
                    .show();

        }

        else

        {
            s1 = "000";
            s2 = "00000000";
            throw new Exception();
        }

    }

    catch (Exception e) {
        e.printStackTrace();

        s1 = enr.substring(0, 3);
        s2 = enr.substring(3, 11);
        s3 = "13202709";
        int r1 = s1.compareTo(n1);
        int r2 = s1.compareTo(n2);

        if (s2.equals(s3)) {
            if (r1 == 0 || r2 == 0) {

                Toast.makeText(this, R.string.Success, Toast.LENGTH_LONG)
                        .show();
                val=new ContentValues();
                val.clear();
                val.put(obj.C_ID, s1);
                val.put(obj.C_Name, name);
                val.put(obj.C_ENo,enr);
                db.insert(obj.TABLE, null, val);
                db.close();

            } else if (r1 < 0 || r2 > 0) {
                Toast.makeText(this, R.string.Fail, Toast.LENGTH_LONG)
                        .show();
            } else if (r1 > 0 || r2 < 0) {
                Toast.makeText(this, R.string.Success, Toast.LENGTH_LONG)
                        .show();
            }
        }

        else

            Toast.makeText(this, R.string.Fail, Toast.LENGTH_LONG).show();

    }
    db.close();
    obj.close();
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // TODO Auto-generated method stub
    MenuInflater mi = getMenuInflater();
    mi.inflate(R.menu.menu, menu);
    return super.onCreateOptionsMenu(menu);
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    // TODO Auto-generated method stub
    switch (item.getItemId()) {
    case R.id.item1:
        startActivity(new Intent(this, Welcomescreen.class));
        this.finish();
        break;

    case R.id.item2:
        this.finish();
        break;
    }
    return super.onOptionsItemSelected(item);
}

@Override
public void onBackPressed() {
    Intent intent = new Intent(this, Welcomescreen.class);
    // intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    startActivity(intent);
    this.finish();
}

} 
```

# android - 操作栏上的下拉菜单

> ID：11376101
> 
> 赞同：17
> 
> 时间：2012-07-07T15:08:53.120
> 
> 标签：android, android-actionbar

我正在开发一个带有操作栏的 android 应用程序菜单，我想将下拉菜单放在操作栏中，就像谷歌地图应用程序中的菜单一样。 ![谷歌地图操作栏](../Images/d057a6635ec5c6d80467749d274d0bef.png)

有人可以帮助我吗？如何实现这一点请指出一些我可以遵循的简单教程。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-01-27T11:21:54.893

将此添加到您的活动 onCreate() 方法中：

```
// Adapter
SpinnerAdapter adapter =
        ArrayAdapter.createFromResource(this, R.array.actions,
        android.R.layout.simple_spinner_dropdown_item);

// Callback
OnNavigationListener callback = new OnNavigationListener() {

    String[] items = getResources().getStringArray(R.array.actions); // List items from res

    @Override
    public boolean onNavigationItemSelected(int position, long id) {

        // Do stuff when navigation item is selected

        Log.d("NavigationItemSelected", items[position]); // Debug

        return true;

    }

};

// Action Bar
ActionBar actions = getActionBar();
actions.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
actions.setDisplayShowTitleEnabled(false);
actions.setListNavigationCallbacks(adapter, callback); 
```

此示例需要列表项的数组资源：

资源/值/arrays.xml

```
<string-array name="actions">
    <item>Item 1</item>
    <item>Item 2</item>
    <item>Item 3</item>
</string-array> 
```

或者，您可以创建自己的适配器和从 SpinnerAdapter 扩展的布局，以显示更高级或动态的列表项。

为了使活动 onCreate 代码更加整洁，您还可以更改活动以实现 OnNavigationListener 并使用回调代码添加覆盖 onNavigationItemSelected。然后在 setListNavigationCallbacks() 方法中将“callback”改为“this”。

请注意，您需要针对操作栏的 API 11+，否则您将需要添加版本检查或支持库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-08T11:02:01.550

检查此链接也是有用的示例[示例链接](http://codebybrian.com/2012/12/06/google_maps_android_v2_sample.html)

```
GoogleMap map;

TextView txt;

String[] mapTypes={"Normal","Hybrid","Satellite","Terrain"};

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    map = ((MapFragment) getFragmentManager().findFragmentById(R.id.map))
            .getMap();

    txt=(TextView)findViewById(R.id.textView1);

//to set map Type
    map.setMapType(GoogleMap.MAP_TYPE_NORMAL);

//To set the marker on map on specific location using lat lag
    // latitude and longitude
    double latitude = 18.520430300000000000;
    double longitude = 73.856743699999920000;

    // create marker
    MarkerOptions marker = new MarkerOptions().position(new LatLng(latitude, longitude)).title("My Location");

    // change color to the marker icon
    marker.icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_CYAN));

    // adding marker
    map.addMarker(marker);

    // Create an array adapter to populate dropdownlist 
    ArrayAdapter<String> adapter =new ArrayAdapter<String>(getBaseContext(), android.R.layout.simple_spinner_dropdown_item, mapTypes);

    /** Enabling dropdown list navigation for the action bar */
    getActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);

    /** Defining Navigation listener */
    ActionBar.OnNavigationListener navigationListener=new ActionBar.OnNavigationListener() {

        @Override
        public boolean onNavigationItemSelected(int itemPosition, long itemId) {
            Toast.makeText(getBaseContext(), "U Select : "+mapTypes[itemPosition], Toast.LENGTH_SHORT).show();
            if (mapTypes[itemPosition].equals("Normal")) {
                map.setMapType(GoogleMap.MAP_TYPE_NORMAL);
            }
            else if (mapTypes[itemPosition].equals("Hybrid")) {
                map.setMapType(GoogleMap.MAP_TYPE_HYBRID);
            }
            else if (mapTypes[itemPosition].equals("Satellite")) {
                map.setMapType(GoogleMap.MAP_TYPE_SATELLITE);
            }
            else if (mapTypes[itemPosition].equals("Terrain")) {
                map.setMapType(GoogleMap.MAP_TYPE_TERRAIN);
            }
            return false;
        }
    };

    // Setting dropdown items and item navigation listener for the actionbar 
    getActionBar().setListNavigationCallbacks(adapter, navigationListener);

} 
```

# facebook - Open Graph & Rails 不检索对象的 URL

> ID：11376111
> 
> 赞同：0
> 
> 时间：2012-07-07T15:10:06.590
> 
> 标签：facebook, ruby-on-rails-3, facebook-opengraph, koala

我正在使用 Rails 尝试在打开的图表上为我的应用程序定义的对象添加一个操作。我在我的控制器中使用 :after_filter 在 session#create 之后调用以下内容：

```
@graph.put_connections('me', 'workkout:complete', :session => url_for([@plan, @session])) 
```

我从 Facebook 收到以下回复：

```
{"error":{"type":"Exception","message":"Could not retrieve data from URL.","code":1660002}} 
```

我检查了正确的 URL 是否传递给 put_connections，当我使用 Facebook 的 Lint 工具访问此 URL 时，一切都是正确的。

我不明白为什么这不起作用，我唯一的想法是 Facebook 在 rails 生成对象之前就点击了 URL？- 不确定这是否可能。

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:47:32.270

原来这是因为创建操作和 put_connection 方法发生在独立的线程中，因此在调用 put_connections 时 URL 还没有准备好。解决方案在这里[http://railscasts.com/episodes/363-facebook-open-graph?autoplay=true](http://railscasts.com/episodes/363-facebook-open-graph?autoplay=true)

# objective-c - 类方法在目标 c 中不起作用

> ID：11376113
> 
> 赞同：-1
> 
> 时间：2012-07-07T15:10:17.047
> 
> 标签：objective-c, class, properties, methods, instance

在我的代码中，我有一个名为“ProfileShareViewController”的类，在其中我导入了另一个我创建的名为“OwnProfileData”的类，并且我还创建了该类的一个实例（类 = OwnProfileData）作为“ProfileShareViewController”的属性和合成它（实例称为“OwnProfile”）。

在另一个名为“EditProfileViewController”的类中，我导入了“ProfileShareViewController”，现在我试图从 EditProfileViewController 类中的 ProfileShareViewController 更改 OwnProfile 对象的属性。

由于某种原因，这不起作用。我试过打字：

```
[[ProfileShareViewController ownProfile] setName:@"Ido"]; 
```

（我试图设置的属性是名称，因为它是在 OwnProfileData 中合成的，所以我使用的是“setName”）。这不起作用，我收到警告：“选择器'ownMethod'没有已知的类方法。

关于为什么会发生这种情况以及如何解决这个问题的任何想法？

感谢您的意见！非常感谢任何支持！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T15:17:13.113

您需要 的实例`ProfileShareViewController`，因为`ownProfile`它是实例属性，而不是类方法。阅读类和实例之间的区别。

还是我误会了？

# iphone - 钥匙串和应用商店更新的问题

> ID：11376121
> 
> 赞同：0
> 
> 时间：2012-07-07T15:11:10.467
> 
> 标签：iphone, objective-c, ios, ipad, keychain

我有一个非常令人沮丧的错误。我已经通过首先安装以前的版本 (1.0.1) 然后运行版本 (1.0.2) 来测试应用程序升级。一切正常。我提交了应用程序，然后我遇到了人们在升级时遇到崩溃的问题。我尝试做同样的事情，安装 1.0.1，然后在应用商店安装二进制文件，然后它崩溃了。我查看了控制台和崩溃日志，我得到了这个：

```
Jul  7 08:07:45 unknown MyApp[1429] <Warning>: KeychainUtils keychainValueForKey: - Error finding keychain value for key. Status code = -25300
Jul  7 08:07:45 unknown MyApp[1429] <Warning>: AccountSession readUserDataFromDisk - Error finding keychain value for key /var/mobile/Applications/997B32E7-6FFC-4696-9CAA-129BADE2FE64/Documents/instagram_json
Jul  7 08:07:45 unknown MyApp[1429] <Warning>: UISegmentedControlStyleBezeled is deprecated. Please use a different style.
Jul  7 08:07:45 unknown MyApp[1429] <Error>: *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFDictionary setObject:forKey:]: attempt to insert nil value (key: username)'
    *** First throw call stack:
    (0x33ee688f 0x367e7259 0x33ee6789 0x33ee67ab 0x33e5368b 0x14fd99 0x152319 0x1530bb 0x170299 0x3270ec59 0x32711817 0x354e7dfb 0x354e7cd0)
Jul  7 08:07:45 unknown UIKitApplication:com.firesnakelabs.pinstagram[0x14e4][1429] <Notice>: terminate called throwing an exception
> 
```

**更新：**

我想我知道问题是什么，升级它正在寻找的文件路径是：

```
/var/mobile/Applications/997B32E7-6FFC-4696-9CAA-129BADE2FE64/Documents/instagram_json 
```

而在升级（v1.0.1）之前，钥匙串的文件路径位于：

```
/var/mobile/Applications/CEE344F7-4FE1-4455-BD6D-A4D6EAA4F5FE/Documents/instagram_json 
```

因此它现在找不到钥匙串上的钥匙，这是我确定文件路径的方法：

```
- (NSString *)filePath {
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *filePath = [[paths objectAtIndex:0] stringByAppendingPathComponent:[NSString stringWithFormat:@"%@_json", self.identifier]];
    return filePath;
} 
```

我只是走我找到的第一条路。那么如何使路径在升级前后或一直保持一致？

我基本上使用 filePath 作为钥匙串名称：

```
[attributesDictionary setObject:filePath forKey:(id)kSecAttrAccount]; // Use the key as the account name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:51:34.457

您的问题并不完全清楚，但听起来这些构建中的一个是临时分布式构建，另一个是应用商店签名的二进制文件。如果是这种情况，两者将具有不同的钥匙串值。钥匙串链接到应用程序的签名，这两种机制不同。

# javascript - 无法使用查询从 Sqlite DB 获取值

> ID：11376126
> 
> 赞同：2
> 
> 时间：2012-07-07T15:11:50.170
> 
> 标签：javascript, html, sqlite

我使用 sqlite 在数据库中填充了一些表。我在另一个执行数据库并从表中选择一些值的 javascript 页面上创建了一个函数。该函数在 $(document).ready() 处调用。

Javascript：

```
 //DB Population
function onDeviceReady() {
    var db = window.openDatabase("Database", "1.0", "SqliteTrial", 20000);
    db.transaction(populateDB, errorCB, successCB);
}

function populateDB(tx) {
tx.executeSql('DROP TABLE IF EXISTS Subjects');
tx.executeSql('CREATE TABLE IF NOT EXISTS Subjects (id unique, subjectname)');
tx.executeSql('INSERT INTO Subjects (id, subjectname) VALUES (1, "Math")');
tx.executeSql('INSERT INTO Subjects (id, subjectname) VALUES (2, "Science")');
}  

function GetSubjectsFromDB()
{
    console.log("");
    tx.executeSql('SELECT * FROM Subjects', [], queryNSuccess, errorCB);
}

function queryNSuccess(tx, results) {
    alert("Query Success");
    console.log("Returned rows = " + results.rows.length);
    if (!results.rowsAffected) {
        console.log('No rows affected!');
        return false;
    }
    console.log("Last inserted row ID = " + results.insertId);
}

function errorCB(err) {
    alert("Error processing SQL: "+err.code);
} 
```

这条线有问题吗？

```
tx.executeSql('SELECT * FROM Subjects', [], queryNSuccess, errorCB); 
```

没有调用 queryNSuccess，errorCB 也没有调用，所以我不知道出了什么问题。

这就是我在另一个页面上的称呼：

Javascript：

```
 $(document).ready(function () {
            DisplayData();
            GetSubjectsFromDB(tx);
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T17:01:24.187

不，它不是那样工作的。`tx`变量实际上是一个参数，将通过`db.transaction`方法发送到指定的回调函数中。所以你可能想要这样做：

```
$(document).ready(function () {
    ...
    db.transaction(GetSubjectsFromDB);            
}); 
```

...并将此函数定义重写为...

```
function GetSubjectsFromDB(tx) { ... something to do with tx ... } 
```

但在我看来，实际上还有另一个问题。`db`存储连接句柄（通过`window.openDatabase`调用创建）的变量对于函数是本地的-`onDeviceReady`换句话说，它在此函数之外不可见。

解决这个问题的最简单方法是在全局上下文中定义这个变量：

```
var dbh; // the SQLite connection handle
function onDeviceReady() { ... dbh = window.openDatabase ... }
function GetSubjects() { ... dbh.transaction(getSubjectsFromDb) ... }
function getSubjectsFromDb(tx) { ... tx.executeSql(...) ... } 
```

这是一个很棒的[演示文稿](http://html5-demos.appspot.com/static/html5storage/index.html#slide1)，描述了 WebSQL DB 的一般用法。但我还想补充一点，WebSQL DB API 已被弃用；建议改用 IndexedDB。这里有[一些](http://www.html5rocks.com/en/tutorials/webdatabase/websql-indexeddb/)关于它的阅读。

# iphone - iPhone iOs 5，需要帮助让我的顶部标签栏工作

> ID：11376127
> 
> 赞同：0
> 
> 时间：2012-07-07T15:12:04.287
> 
> 标签：iphone, ios, ios5, tabs, uitabbarcontroller

我想在顶部有标签栏。

所以我在 XCode 中创建了一个新项目。添加了一个视图，然后在该视图中我添加了（滚动条、文本和另一个视图）。见图片。

![MainWindow 的情节提要视图。 顶部是标签主机，中间是内容，底部是版权](../Images/ed20a06b7a8a826144368528691e5108.png)

我想要的是让我的标签栏在顶部。然后在中间是标签栏的内容，下面是一个小的版权文本。见图片。

![我在 StoryBoard 中添加的所有控件](../Images/8e685681aebec1a8bc4f2e6565b55994.png)

不知道如何正确地做到这一点。我试图动态创建 UITabBarController，然后将其分配到顶部的视图中。（图片上的顶部空白区域专用于标签栏）。

这是我初始化 MainWindow 的代码。

主窗口.h

```
#import <UIKit/UIKit.h>

@class Intro;

@interface MainWindow : UIViewController
@property (strong, nonatomic) IBOutlet UIScrollView *mainContentFrame;
@property (strong, nonatomic) IBOutlet UIView *mainTabBarView;
@property (strong, nonatomic) UITabBarController *mainTabBar;

@property (nonatomic, strong) Intro *intro; // Trying to get this tab to show in the tab bar

@end 
```

主窗口.m

```
#import "MainWindow.h"
#import "Intro.h"

@interface MainWindow ()

@end

@implementation MainWindow
@synthesize mainContentFrame = _mainContentFrame;
@synthesize mainTabBarView = _mainTabBarView;
@synthesize mainTabBar = _mainTabBar;

@synthesize intro = _intro;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    _intro = [[Intro alloc] init];
    NSArray *allViews = [[NSArray alloc] initWithObjects:_intro, nil];

    [super viewDidLoad];
    // Do any additional setup after loading the view.

    _mainTabBar = [[UITabBarController alloc] init];
    [_mainTabBar setViewControllers:allViews];

    [_mainTabBarView.window addSubview:_mainTabBar.tabBarController.view];
}

- (void)viewDidUnload
{
    [self setMainTabBar:nil];
    [self setMainContentFrame:nil];
    [self setMainContentFrame:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

@end 
```

我缺少什么让这个工作？希望内容最终出现在滚动视图中，以便所有选项卡都可以滚动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T09:51:11.143

iOS 用户界面指南说 UITabBar 必须在 ViewController 的底部。您应该为这种视图创建自己的 GUI 或使用“老式”方式。我不会尝试绕过 UITabBar，因为您的应用程序可能会被 Apple 拒绝。

# eclipse - 我可以一步从本地历史中恢复整个项目吗？

> ID：11376141
> 
> 赞同：1
> 
> 时间：2012-07-07T15:14:29.083
> 
> 标签：eclipse

在 Eclipse 中，我可以通过右键单击包资源管理器中的文件将单个文件替换为本地历史记录中的版本。

有没有办法一步一步用给定时间戳的本地历史替换整个项目或包？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T19:59:16.950

假设这是不可能的，我提交了一个 Eclipse[增强请求](https://bugs.eclipse.org/bugs/show_bug.cgi?id=384525)。

# google-app-engine - Google Cloud SQL 配置 - 通过 GoogleCL for SQL 或 Eclipse 获取 OAuth 2 令牌

> ID：11376142
> 
> 赞同：1
> 
> 时间：2012-07-07T15:14:39.720
> 
> 标签：google-app-engine, gwt, eclipse-plugin, google-cloud-sql

配置 Google Cloud SQL 以使用使用 GWT Eclipse EE 插件构建的应用程序并且遇到身份验证问题。

### Google 命令行工具 - 尝试运行 ./google_sql.sh*实例*

需要为 CloudSQL 设置 GoogleCL 的指导。我使用 MacPorts 安装了常规的 GoogleCL。接下来是什么？我试过了：

> echo 'export PATH=Applications/eclipse/plugins/com.google.appengine.eclipse.sdkbundle_1.7.0/appengine-java-sdk-1.7.0/bin/:$PATH' >> ~/.profile

### 蚀

Eclipse 在两个单独的字段中询问实例名称和数据库名称。我已经尝试了项目 ID：数据库名称（例如 petproject:dog）的所有排列。

这是 Eclipse 错误报告（每次都一样）：

> 无法连接到配置文件（名称-of-the-project-in-Eclipse.GoogleCloudSQL.DevInstance）。创建与配置文件的 SQL 模型连接连接时出错（名称-of-the-project-in-Eclipse.GoogleCloudSQL.DevInstance）。（错误：用户'my-login-id'@'localhost'的访问被拒绝（使用密码：YES））用户'my-login-id'@'localhost'的访问被拒绝（使用密码：YES）创建谷歌云时出错SQL 连接工厂连接到 Profile（pse：无法连接到 Profile（名称-of-the-project-in-Eclipse.GoogleCloudSQL.DevInstance）。（错误：用户'my-login-id'@'localhost'的访问被拒绝） （使用密码：YES））

### 其他

我可以让测试应用程序正常工作。我有通过我拥有的域运行的测试应用程序。我创建了一个 Google Cloud SQL 项目和实例。我已允许我的应用在 Google API 控制台上使用该实例。我正在运行本地 mysql，并在我的机器上创建了数据库/模式。我无法将我的本地数据库链接到 GWT，因为整个 Google Cloud SQL 都需要运行。

谢谢 - 非常感谢。

# facebook - Twitter 脚本在 IE9 中作为 Facebook 应用程序运行时失败（即在 iFrame 中）

> ID：11376144
> 
> 赞同：1
> 
> 时间：2012-07-07T15:15:04.783
> 
> 标签：facebook, twitter, internet-explorer-9

我们有一个 Facebook 应用程序，其中包含网络意图集成，以在用户发布关于他们的表现的推文时奖励积分。该应用程序在 Facebook 以外的所有浏览器以及在 Facebook 内运行时在除 IE9 之外的所有浏览器中运行都没有问题。这个问题似乎源于 Facebook 在 iframe 中运行代码的方式。

我们看到的具体错误发生在 hubclient.js 中的页面加载期间（第 7 行）：无法获取属性 insertBefore 的值。

该代码基于[https://dev.twitter.com/docs/intents/events集成到我们的应用程序中](https://dev.twitter.com/docs/intents/events)

在文档头中，我们有以下脚本来设置 twitter 平台 api：

```
<script type="text/javascript" charset="utf-8">
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script> 
```

然后我们在文档正文中使用了一个简单的关注按钮

```
<a href="https://twitter.com/clearcreativity" class="twitter-follow-button" data-show-count="false">Follow</a> 
```

最后，我们有包装在 $(document).ready() 块中的事件绑定：

```
$(document).ready(function(){
    twttr.ready(function (twttr) {
    twttr.events.bind('tweet', function(event) {
            //Notify and potentially give credit for a tweet
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:41:46.250

在这个问题上多次尝试不同的解决方案后，它似乎与在 iframe 中运行时平台脚本的异步加载有关。为了解决这个问题，我们简单地将平台 api 的加载移动到页面加载结束时的同步调用：

```
 <script src="https://platform.twitter.com/widgets.js"></script>
<body> 
```

当然，请确保我们代码中对 twttr 的所有引用都包含在

```
$(document).ready(); 
```

# php - showposts 和 posts_per_page 都不能在我的主页上工作

> ID：11376145
> 
> 赞同：1
> 
> 时间：2012-07-07T15:15:06.313
> 
> 标签：php, wordpress

有一个主页，事情进展顺利。

但是主页应该显示每个指定类别的 1 个帖子...它正在显示更多...

尝试使用showposts和posts_per_page，但没有成功

这是页面的副本，两者都无济于事：

have_posts()) : $mb_recent->the_post(); $更多 = 0; ?>

```
 <!-- post -->
         <div class="post archive">
        <div class="post-comments"><?php comments_popup_link('0', '1', '%'); ?></div>

    <h3><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></h3>
        <div class="post-date"><?php the_time('l, F jS, Y') ?></div>
        <?php if (get_post_meta($post->ID, 'post_image_value', true)) { ?><div class="post-tnail"><a href="<?php the_permalink() ?>"><?php if (get_post_meta($post->ID, 'post_image_value', true) && $mb_resize == 0) { ?><img src="<?php echo bloginfo('template_url'); ?>/thumb.php?src=<?php echo get_post_meta($post->ID, "post_image_value", $single = true); ?>&amp;w=98&amp;h=98&amp;zc=1&amp;q=95" alt="<?php the_title(); ?>" /><?php } else if (get_post_meta($post->ID, 'post_image_value', true) && $mb_resize == 1) { ?><img src="<?php bloginfo('home'); ?><?php echo get_post_meta($post->ID, "post_image_value", $single = true); ?>" alt="<?php the_title(); ?>" /><?php } ?></a></div><?php } ?>

      <?php the_excerpt() ?>
<p><a href="<?php the_permalink() ?>" class="more">Continue reading...    
         </a></p>                       
                    </div>
                    <!-- /post -->

                    <?php endwhile; ?>

                    <?php $mb_recent = new WP_Query('cat=5' . $mb_blog . '&posts_per_page=1' . $mb_blog_home . ''); ?>
                    <?php while ($mb_recent->have_posts()) : $mb_recent->the_post(); $more = 0; ?>

                    <!-- post -->
                    <div class="post archive">
                        <div class="post-comments"><?php comments_popup_link('0', '1', '%'); ?></div>
                        <h3><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></h3>
                        <div class="post-date"><?php the_time('l, F jS, Y') ?></div>
                        <?php if (get_post_meta($post->ID, 'post_image_value', true)) { ?><div class="post-tnail"><a href="<?php the_permalink() ?>"><?php if (get_post_meta($post->ID, 'post_image_value', true) && $mb_resize == 0) { ?><img src="<?php echo bloginfo('template_url'); ?>/thumb.php?src=<?php echo get_post_meta($post->ID, "post_image_value", $single = true); ?>&amp;w=98&amp;h=98&amp;zc=1&amp;q=95" alt="<?php the_title(); ?>" /><?php } else if (get_post_meta($post->ID, 'post_image_value', true) && $mb_resize == 1) { ?><img src="<?php bloginfo('home'); ?><?php echo get_post_meta($post->ID, "post_image_value", $single = true); ?>" alt="<?php the_title(); ?>" /><?php } ?></a></div><?php } ?>
                        <?php the_excerpt() ?>
                        <p><a href="<?php the_permalink() ?>" class="more">Continue reading...</a></p>                      
                    </div> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-16T15:48:26.477

我同时使用“showposts”和“posts_per_page”也遇到了这个问题。一旦我添加了“ignore_sticky_posts”，它就为我解决了。

```
$minposts = new WP_Query( array(
            'posts_per_page'=> 3,
            'ignore_sticky_posts' => 1
        )   
    ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:24:09.373

我不确定变量 $mb_blog 和 $mb_blog_home 包含什么，但我确信它们会导致问题。

您应该只需要 category 和您的查询中的 posts_per_page

```
<?php $mb_recent = new WP_Query('cat=5&posts_per_page=1'); ?> 
```

# python - Python Json 将数组解码为字符串

> ID：11376148
> 
> 赞同：2
> 
> 时间：2012-07-07T15:15:25.610
> 
> 标签：python, arrays, json, string

我正在尝试解析一些 Json，我的代码如下所示：

```
Json = '{"status":"Success", "resultsMethod":"database", "lastScrape":"2012-05-28 00:03:52", "domainCount":"45", "remoteAddress":"www.digg.com", "remoteIpAddress":"64.191.203.30", "domainArray":[["567gu.com", ""], ["64.191.203.30", ""], ["64.191.203.30.", ""], ["bellacor.com", ""], ["blogs.vancouversun.com", ""], ["da-dk.chinathin.com", ""], ["dads.new.digg.com", ""], ["deathofaclown.com", ""], ["digg-inc.com", ""], ["digg.bokefu.com", ""], ["digg.com", ""], ["digg.com.", ""], ["diggcontest.com", ""], ["diggcorp.com", ""], ["diggentertainment.com", ""], ["diggriver.com", ""], ["e.digg.com", ""], ["evercleancanada.com", ""], ["feeds.digg.com", ""], ["feeds.gawker.com", ""], ["feeds.paidcontent.org", ""], ["firthfamily.net", ""], ["m.digg.com", ""], ["media.digg.com", ""], ["new.digg.com", ""], ["rfcoron.no-ip.org", ""], ["rss.digg.com", ""], ["samtesta.com", ""], ["services.digg.com", ""], ["shopzilla.com", ""], ["theultimatebathrooms.com", ""], ["tmpnetwork.com", ""], ["www.567gu.com", ""], ["www.businesswire.com", ""], ["www.calibex.com", ""], ["www.digg-inc.com", ""], ["www.digg.com", ""], ["www.freshnews.org", ""], ["www.iconfactory.com", ""], ["www.istoleyoursite.com", ""], ["www.lethargy.org", ""], ["www.pheedcontent.com", ""], ["www.stuff.co.nz", ""], ["www.tr.im", ""], ["www.xkan.cn", ""]]}'

obj = json.loads(Json)
for key, value in obj.iteritems():
    print key,value 
```

上面的例子打印这个：

```
status Success
domainArray [[u'567gu.com', u''], [u'64.191.203.30', u''], [u'64.191.203.30.', u''], [u'bellacor.com', u''], [u'blogs.vancouversun.com', u''], [u'da-dk.chinathin.com', u''], [u'dads.new.digg.com', u''], [u'deathofaclown.com', u''], [u'digg-inc.com', u''], [u'digg.bokefu.com', u''], [u'digg.com', u''], [u'digg.com.', u''], [u'diggcontest.com', u''], [u'diggcorp.com', u''], [u'diggentertainment.com', u''], [u'diggriver.com', u''], [u'e.digg.com', u''], [u'evercleancanada.com', u''], [u'feeds.digg.com', u''], [u'feeds.gawker.com', u''], [u'feeds.paidcontent.org', u''], [u'firthfamily.net', u''], [u'm.digg.com', u''], [u'media.digg.com', u''], [u'new.digg.com', u''], [u'rfcoron.no-ip.org', u''], [u'rss.digg.com', u''], [u'samtesta.com', u''], [u'services.digg.com', u''], [u'shopzilla.com', u''], [u'theultimatebathrooms.com', u''], [u'tmpnetwork.com', u''], [u'www.567gu.com', u''], [u'www.businesswire.com', u''], [u'www.calibex.com', u''], [u'www.digg-inc.com', u''], [u'www.digg.com', u''], [u'www.freshnews.org', u''], [u'www.iconfactory.com', u''], [u'www.istoleyoursite.com', u''], [u'www.lethargy.org', u''], [u'www.pheedcontent.com', u''], [u'www.stuff.co.nz', u''], [u'www.tr.im', u''], [u'www.xkan.cn', u'']]
lastScrape 2012-05-28 00:03:52
remoteAddress www.digg.com
resultsMethod database
remoteIpAddress 64.191.203.30
domainCount 45 
```

我真的很想首先显示 domainCount、RemoteIpAddress 和 RemoteAddress，但并非最不重要；具有 domainArray 键的普通字符串列表。在此示例中，domainArray 键对应于如下所示的列表：[[u'567gu.com', u''],

我想要一个这样的列表：

```
DomainArray : 
ellacor.com
blogs.vancouversun.com
da-dk.chinathin.com
etc, etc. 
```

任何帮助将不胜感激 ！

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T15:20:58.437

```
obj = json.loads(Json)
print("DomainCount: %d" % obj['domainCount'])
print("DomainArray: %s" % '\n'.join(e[0] for e in obj['domainArray'])
# etc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T17:17:19.477

```
try:
    import simplejson as json
except ImportError:
    import json

s = '{"status":"Success", "resultsMethod":"database", "lastScrape":"2012-05-28 00:03:52", "domainCount":"45", "remoteAddress":"www.digg.com", "remoteIpAddress":"64.191.203.30", "domainArray":[["567gu.com", ""], ["64.191.203.30", ""], ["64.191.203.30.", ""], ["bellacor.com", ""], ["blogs.vancouversun.com", ""], ["da-dk.chinathin.com", ""], ["dads.new.digg.com", ""], ["deathofaclown.com", ""], ["digg-inc.com", ""], ["digg.bokefu.com", ""], ["digg.com", ""], ["digg.com.", ""], ["diggcontest.com", ""], ["diggcorp.com", ""], ["diggentertainment.com", ""], ["diggriver.com", ""], ["e.digg.com", ""], ["evercleancanada.com", ""], ["feeds.digg.com", ""], ["feeds.gawker.com", ""], ["feeds.paidcontent.org", ""], ["firthfamily.net", ""], ["m.digg.com", ""], ["media.digg.com", ""], ["new.digg.com", ""], ["rfcoron.no-ip.org", ""], ["rss.digg.com", ""], ["samtesta.com", ""], ["services.digg.com", ""], ["shopzilla.com", ""], ["theultimatebathrooms.com", ""], ["tmpnetwork.com", ""], ["www.567gu.com", ""], ["www.businesswire.com", ""], ["www.calibex.com", ""], ["www.digg-inc.com", ""], ["www.digg.com", ""], ["www.freshnews.org", ""], ["www.iconfactory.com", ""], ["www.istoleyoursite.com", ""], ["www.lethargy.org", ""], ["www.pheedcontent.com", ""], ["www.stuff.co.nz", ""], ["www.tr.im", ""], ["www.xkan.cn", ""]]}'
obj = json.loads(s)

printorder = ['domainCount', 'remoteIpAddress', 'remoteAddress', 'lastScrape', 'resultsMethod', 'status', 'domainArray']
for var,val in ((var, obj.get(var)) for var in printorder):
    if var == 'domainArray':
        val = ''.join('\n  {}'.format(domain[0]) for domain in val)
    var = '{}:'.format(var)
    print('{:<20} {}'.format(var, val)) 
```

结果是

```
domainCount:         45
remoteIpAddress:     64.191.203.30
remoteAddress:       www.digg.com
lastScrape:          2012-05-28 00:03:52
resultsMethod:       database
status:              Success
domainArray:         
  567gu.com
  64.191.203.30
  64.191.203.30.
  bellacor.com
  blogs.vancouversun.com
  da-dk.chinathin.com
  dads.new.digg.com
  deathofaclown.com
  digg-inc.com
  digg.bokefu.com
  digg.com
  digg.com.
  diggcontest.com
  diggcorp.com
  diggentertainment.com
  diggriver.com
  e.digg.com
  evercleancanada.com
  feeds.digg.com
  feeds.gawker.com
  feeds.paidcontent.org
  firthfamily.net
  m.digg.com
  media.digg.com
  new.digg.com
  rfcoron.no-ip.org
  rss.digg.com
  samtesta.com
  services.digg.com
  shopzilla.com
  theultimatebathrooms.com
  tmpnetwork.com
  www.567gu.com
  www.businesswire.com
  www.calibex.com
  www.digg-inc.com
  www.digg.com
  www.freshnews.org
  www.iconfactory.com
  www.istoleyoursite.com
  www.lethargy.org
  www.pheedcontent.com
  www.stuff.co.nz
  www.tr.im
  www.xkan.cn 
```

# c++ - 在编译时动态生成结构

> ID：11376149
> 
> 赞同：2
> 
> 时间：2012-07-07T15:15:34.047
> 
> 标签：c++, templates, c++11, structure, template-meta-programming

我必须生成一个仅在特定条件下包含特定字段的数据结构。这通常总是转化为如下内容

```
struct MyStruct {
    int     alwaysHere;

#ifdef WHATEVER
    bool    mightBeHere;
#endif

    char    somethingElse;

#if SOME_CONSTANT > SOME_VALUE
    uint8_t alywasHereButDifferentSize;
#else
    uint16_t alywasHereButDifferentSize;
#endif
...
}; 
```

从我的角度来看，这很容易看起来很难看，而且不可读。甚至不用谈论处理这些字段的代码，通常也是在 ifdefs 下。

我正在寻找一种优雅的方式来实现相同的结果，而不增加任何开销，但代码更具可读性。模板专业化似乎有点过分，但在我看来它是唯一的选择。

C++11 是否添加了任何东西来处理这种情况？

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T16:36:14.057

对于第二种情况，我通常更喜欢将黑客限制在一个地方的 typedef：

```
#if SOME_CONSTANT > SOME_VALUE
    typedef uint8_t always_type;
#else
    typedef uint16_t always_type;
#endif 
```

然后您的其余代码将`always_type`始终使用：

```
struct MyStruct {
    // ...
    always_type always_here_but_different_size;
    // ...
}; 
```

如果你想使用：

```
typedef std::conditional<(SOME_CONSTANT > VALUE), uint8_t, uint16_t>::type always_type; 
```

这也很好——这里的重点不在于您用于获取所需类型的语法，而是您通常希望为该类型创建一个名称以便可以在需要时使用它的事实。

至于有没有东西的情况，就*有点难*说了。通常，这样的事情将与在构建时启用/禁用某些功能有关。如果是这样，则该类似乎具有与可以启用/禁用的功能以及其他内容相关的职责。这听起来可能违反了单一责任原则，并且可能不是很有凝聚力。如果是这种情况，它可能表明一个问题在整体设计级别上得到了更好的解决，而不仅仅是您使用的语法。

警告：我可能从公认的最小证据中推断出很多——可能比证据真正支持的要多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-07T15:22:08.693

第二种情况可以替换为

```
std::conditional<(SOME_CONSTANT > SOME_VALUE), uint8_t, uint16_t>::type
alywasHereButDifferentSize; 
```

首先我认为没有。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T15:22:00.287

我已经通过联合（http://www.cplusplus.com/doc/tutorial/other_data_types/）看到了这一点，但我不确定具体细节，因为我自己从未实现过。而不是第二个宏黑客，您将拥有：

```
union {
  uint8_t alywasHereButDifferentSize;
  uint16_t alywasHereButDifferentSize;
} 
```

并且在引用时，您将有一个 if 引用一个或另一个变量。

或者，您可以创建一个在运行时初始化的 void * 指针，指向任一类型的变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T16:23:30.380

为了第一：

```
template <bool>
struct implement_maybe_here
{};

template <>
struct implement_maybe_here<true>
{
    int maybe_here;
};

struct my_struct : implement_maybe_here<HAS_MAYBE_HERE>
{
    double always_here;
}; 
```

我不建议以任何方式这样做，因为它难以维护并且`maybe_here`变量难以初始化（但使用任何方法，无论如何这都会是一团糟）。

请注意，您不能保证`implement_maybe_here<false>`会占用零内存，但是许多编译器实现了这种“[空基优化](http://en.wikibooks.org/wiki/More_C++_Idioms/Empty_Base_Optimization)”。

正如@ForEveR`std::conditional`建议的那样，用于第二个。

# iphone - managedObjectContext 为零...不知道发生了什么

> ID：11376151
> 
> 赞同：-2
> 
> 时间：2012-07-07T15:15:39.127
> 
> 标签：iphone, objective-c, ios, xcode, core-data

我有一个现有项目，我正在向其中添加 CoreData 框架，但遇到了一些麻烦。我之前已经将 CoreData 添加到现有项目中，但我不确定在这种情况下我哪里出错了。

我已将所有必要的代码添加到 AppDelegate.h 和 .m 文件中。我已将导入语句添加到我的 .pch 中。我已经使用我的课程对象的所有属性创建了我的数据模型文件。我已经完成了我能想到的所有事情，但是当我的 viewDidLoad 方法运行时，我的 managedObjectContext 仍然为零。

我已经在下面发布了我的 AppDelegate 和 ViewController 的代码。希望有人可以就我哪里出错提供一些建议。谢谢 ：）

AppDelegate.h

```
#import <UIKit/UIKit.h>

@interface AppDelegate : UIResponder <UIApplicationDelegate>

@property (strong, nonatomic) UIWindow *window;

@property (readonly, strong, nonatomic) NSManagedObjectContext *managedObjectContext;
@property (readonly, strong, nonatomic) NSManagedObjectModel *managedObjectModel;
@property (readonly, strong, nonatomic) NSPersistentStoreCoordinator *persistentStoreCoordinator;

- (void)saveContext;
- (NSURL *)applicationDocumentsDirectory;

@end 
```

AppDelegate.m

```
#import "AppDelegate.h"

@implementation AppDelegate

@synthesize window = _window;
@synthesize managedObjectContext = __managedObjectContext;
@synthesize managedObjectModel = __managedObjectModel;
@synthesize persistentStoreCoordinator = __persistentStoreCoordinator;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.
    return YES;
}

- (void)applicationWillResignActive:(UIApplication *)application
{
    // Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.
    // Use this method to pause ongoing tasks, disable timers, and throttle down OpenGL ES frame rates. Games should use this method to pause the game.
}

- (void)applicationDidEnterBackground:(UIApplication *)application
{
    // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later. 
    // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.
}

- (void)applicationWillEnterForeground:(UIApplication *)application
{
    // Called as part of the transition from the background to the inactive state; here you can undo many of the changes made on entering the background.
}

- (void)applicationDidBecomeActive:(UIApplication *)application
{
    // Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.
}

- (void)applicationWillTerminate:(UIApplication *)application
{
    // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.
}

- (void)saveContext
{
    NSError *error = nil;
    NSManagedObjectContext *managedObjectContext = self.managedObjectContext;
    if (managedObjectContext != nil) {
        if ([managedObjectContext hasChanges] && ![managedObjectContext save:&error]) {
            // Replace this implementation with code to handle the error appropriately.
            // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
            NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
            abort();
        } 
    }
}

#pragma mark - Core Data stack

// Returns the managed object context for the application.
// If the context doesn't already exist, it is created and bound to the persistent store coordinator for the application.
- (NSManagedObjectContext *)managedObjectContext
{
    if (__managedObjectContext != nil) {
        return __managedObjectContext;
    }

    NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
    if (coordinator != nil) {
        __managedObjectContext = [[NSManagedObjectContext alloc] init];
        [__managedObjectContext setPersistentStoreCoordinator:coordinator];
    }
    return __managedObjectContext;
}

// Returns the managed object model for the application.
// If the model doesn't already exist, it is created from the application's model.
- (NSManagedObjectModel *)managedObjectModel
{
    if (__managedObjectModel != nil) {
        return __managedObjectModel;
    }
    NSURL *modelURL = [[NSBundle mainBundle] URLForResource:@"iLessonsPiano" withExtension:@"momd"];
    __managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL];
    return __managedObjectModel;
}

// Returns the persistent store coordinator for the application.
// If the coordinator doesn't already exist, it is created and the application's store added to it.
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator
{
    if (__persistentStoreCoordinator != nil) {
        return __persistentStoreCoordinator;
    }

    NSURL *storeURL = [[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"iLessonsPiano.sqlite"];

    NSError *error = nil;
    __persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]];
    if (![__persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeURL options:nil error:&error]) {
        /*
         Replace this implementation with code to handle the error appropriately.

         abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 

         Typical reasons for an error here include:
         * The persistent store is not accessible;
         * The schema for the persistent store is incompatible with current managed object model.
         Check the error message to determine what the actual problem was.

         If the persistent store is not accessible, there is typically something wrong with the file path. Often, a file URL is pointing into the application's resources directory instead of a writeable directory.

         If you encounter schema incompatibility errors during development, you can reduce their frequency by:
         * Simply deleting the existing store:
         [[NSFileManager defaultManager] removeItemAtURL:storeURL error:nil]

         * Performing automatic lightweight migration by passing the following dictionary as the options parameter: 
         [NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption, [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption, nil];

         Lightweight migration will only work for a limited set of schema changes; consult "Core Data Model Versioning and Data Migration Programming Guide" for details.

         */
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }    

    return __persistentStoreCoordinator;
}

#pragma mark - Application's Documents directory

// Returns the URL to the application's Documents directory.
- (NSURL *)applicationDocumentsDirectory
{
    return [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject];
}

@end 
```

视图控制器.h

```
#import <UIKit/UIKit.h>
#import "Lesson.h"
#import "PDFViewController.h"
#import "MediaPlayer/MediaPlayer.h"
#import "PracticeViewController.h"

@interface ViewController : UIViewController <UITableViewDelegate, UITableViewDataSource>

@property (nonatomic, strong) NSManagedObjectContext* managedObjectContext;

// Array to hold all lessons.

@property (nonatomic, strong) NSMutableArray *lessonLibrary;

// Array to hold the purchased lessons.

@property (nonatomic,strong) NSMutableArray *purchasedLessons;

// Lesson detail display items.

@property (strong, nonatomic) IBOutlet UIImageView *coverArt;
@property (weak, nonatomic) IBOutlet UILabel *lessonTitle;
@property (weak, nonatomic) IBOutlet UILabel *lessonSubtitle;
@property (weak, nonatomic) IBOutlet UILabel *timingLabel;
@property (weak, nonatomic) IBOutlet UILabel *keySignatureLabel;
@property (weak, nonatomic) IBOutlet UIImageView *difficultyImage;
@property (weak, nonatomic) IBOutlet UITextView *descriptionTextView;
@property (weak, nonatomic) IBOutlet UIImageView *dividerImage;
@property (weak, nonatomic) IBOutlet UIImageView *detailBackgroundImage;
@property (weak, nonatomic) IBOutlet UIImageView *detailsImage;

@property (strong, nonatomic) IBOutlet UITableView *tableView;

//Table Methods

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath;

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section;

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath;

// Variables and Methods for the Video Player

@property (strong, nonatomic) MPMoviePlayerViewController *player;

@end 
```

视图控制器.m

```
#import "ViewController.h"
#import "AppDelegate.h"

@interface ViewController ()

@end

@implementation ViewController

@synthesize coverArt;
@synthesize lessonTitle;
@synthesize lessonSubtitle;
@synthesize timingLabel;
@synthesize keySignatureLabel;
@synthesize difficultyImage;
@synthesize descriptionTextView;
@synthesize dividerImage;
@synthesize detailBackgroundImage;
@synthesize detailsImage;
@synthesize purchasedLessons;
@synthesize tableView;
@synthesize player;
@synthesize managedObjectContext;
@synthesize lessonLibrary;

//TABLE METHODS

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return purchasedLessons.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    // Create a cell.
    UITableViewCell *cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:@"purchased"];

    // Populate the cell with data.
    Lesson *temp = [[Lesson alloc] init];
    temp = [purchasedLessons objectAtIndex:indexPath.row];
    cell.textLabel.text = temp.title;
    cell.detailTextLabel.text = temp.subtitle;

    // Return the cell.
    return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    // Determine what row is selected and retrieve the correct Lesson object.
    Lesson *currentSelection = [[Lesson alloc] init];
    int row = [indexPath row];
    currentSelection = [purchasedLessons objectAtIndex:row];
    if (currentSelection.purchaseStatus == 1) {
        UIImage *tempCoverArt = [UIImage imageNamed:currentSelection.coverArtFilename];
        UIImage *tempDifficulty = [UIImage imageNamed:currentSelection.difficultyImageFilename];

        // Change the information in the details pane to the details for the current lesson.
        [coverArt setImage:tempCoverArt];
        lessonTitle.text = currentSelection.title;
        lessonSubtitle.text = currentSelection.subtitle;
        timingLabel.text = currentSelection.timing;
        keySignatureLabel.text = currentSelection.keySignature;
        [difficultyImage setImage:tempDifficulty];
        descriptionTextView.text = currentSelection.lessonDescription;
    }

}

//END TABLE METHODS

- (void)viewDidLoad
{    
    [super viewDidLoad];

    if (managedObjectContext == nil) 
    { 
        managedObjectContext = [(AppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext]; 
    }

    // Song library

    Lesson *Lesson0 = [[Lesson alloc] init];
    Lesson0 = [NSEntityDescription insertNewObjectForEntityForName:@"Lesson" inManagedObjectContext:managedObjectContext];
    Lesson0.productID = 0;
    //Lesson0.purchaseStatus = 1;
    Lesson0.title = @"Happy Birthday to You";
    Lesson0.subtitle = @"Patty & Mildred Hill";
    Lesson0.titleAndSubtitle = @"Happy Birthday to You - Patty & Mildred Hill";
    Lesson0.coverArtFilename = @"beethoven.png";
    Lesson0.timing = @"3/4";
    Lesson0.keySignature = @"G";
    Lesson0.difficultyImageFilename = @"easy.png";
    Lesson0.lessonDescription = @"Originally, this song piece was called 'Good Morning to All' and was sung to and by children in school.";
    Lesson0.sheetFilename = @"1_score";
    Lesson0.midiFilename = @"happyBirthdayToYou";
    Lesson0.materialsFilename = @"1_score";
    Lesson0.roll = @"happyBirthdayToYou";
    //Lesson0.startingIndicatorPosition = 175;
    Lesson0.rollPositionArray = [NSArray arrayWithObjects:   /* 0 */ [NSNumber numberWithInteger:0],
                                 /* 1 */ [NSNumber numberWithInteger:0],    
                                 /* 2 */ [NSNumber numberWithInteger:0],
                                 /* 3 */ [NSNumber numberWithInteger:-65],
                                 /* 4 */ [NSNumber numberWithInteger:-100],
                                 /* 5 */ [NSNumber numberWithInteger:-135],
                                 /* 6 */ [NSNumber numberWithInteger:-185],
                                 /* 7 */ [NSNumber numberWithInteger:-185],
                                 /* 8 */ [NSNumber numberWithInteger:-241],
                                 /* 9 */ [NSNumber numberWithInteger:-306],
                                 /* 10 */ [NSNumber numberWithInteger:-341],
                                 /* 11 */ [NSNumber numberWithInteger:-376],
                                 /* 12 */ [NSNumber numberWithInteger:-426],
                                 /* 13 */ [NSNumber numberWithInteger:-426],
                                 /* 14 */ [NSNumber numberWithInteger:-483],
                                 /* 15 */ [NSNumber numberWithInteger:-548],
                                 /* 16 */ [NSNumber numberWithInteger:-582],
                                 /* 17 */ [NSNumber numberWithInteger:-617],
                                 /* 18 */ [NSNumber numberWithInteger:-666],
                                 /* 19 */ [NSNumber numberWithInteger:-701],
                                 /* 20 */ [NSNumber numberWithInteger:-737],
                                 /* 21 */ [NSNumber numberWithInteger:-799],
                                 /* 22 */ [NSNumber numberWithInteger:-834],
                                 /* 23 */ [NSNumber numberWithInteger:-868],
                                 /* 24 */ [NSNumber numberWithInteger:-918],
                                 nil];

    // Load in the CoreData library of Lessons

    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription 
                                   entityForName:@"Lesson" inManagedObjectContext:managedObjectContext];
    [fetchRequest setEntity:entity];
    NSError *error;
    NSArray *tempArray = [managedObjectContext executeFetchRequest:fetchRequest error:&error];
    lessonLibrary = [[NSMutableArray alloc] initWithArray:tempArray];

    NSSortDescriptor *desc = [[NSSortDescriptor alloc] initWithKey:@"subtitle" ascending:YES];
    [lessonLibrary sortUsingDescriptors:[NSArray arrayWithObjects:desc, nil]];

    // Load background images.
    UIImage *detailsDivider = [UIImage imageNamed:@"detailsDividerImage.png"];
    [dividerImage setImage:detailsDivider];

    UIImage *detailsBackground = [UIImage imageNamed:@"detailsBackgroundImage.png"];
    [detailBackgroundImage setImage:detailsBackground];

    UIImage *detailsPanel = [UIImage imageNamed:@"detailsDisplayImage.png"];
    [detailsImage setImage:detailsPanel];

    // Load default cover art.
    UIImage *defaultCoverArt = [UIImage imageNamed:@"coverArtDefault.png"];
    [coverArt setImage:defaultCoverArt];

    if (![managedObjectContext save:&error]) {
        NSLog(@"Whoops, couldn't save: %@", [error localizedDescription]);
    }

    for (Lesson *lesson in lessonLibrary) {
        [purchasedLessons addObject:lesson];
    }
//    purchasedLessons = [[NSMutableArray alloc] initWithObjects:Lesson0, nil];

}

- (void)viewDidUnload
{
    [self setLessonTitle:nil];
    [self setLessonSubtitle:nil];
    [self setCoverArt:nil];
    [self setTimingLabel:nil];
    [self setKeySignatureLabel:nil];
    [self setDifficultyImage:nil];
    [self setDescriptionTextView:nil];
    [self setDividerImage:nil];
    [self setDetailBackgroundImage:nil];
    [self setDetailsImage:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
}

- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    // Segue to the materials screen.

    if ([segue.identifier isEqualToString:@"materials"]) {
        PDFViewController *pdfViewController = [segue destinationViewController];

        NSIndexPath *path = [self.tableView indexPathForSelectedRow];
        int row = [path row];
        Lesson *selected = [purchasedLessons objectAtIndex:row];
        pdfViewController.selectedLesson = selected;

        pdfViewController.fileToView = @"materials";

    }

    // Segue to the sheet screen.

    else if ([segue.identifier isEqualToString:@"sheet"]) {
        PDFViewController *pdfViewController = [segue destinationViewController];

        NSIndexPath *path = [self.tableView indexPathForSelectedRow];
        int row = [path row];
        Lesson *selected = [purchasedLessons objectAtIndex:row];

        pdfViewController.selectedLesson = selected;

        pdfViewController.fileToView = @"sheet";
    }

    // Segue to the practice screen.

    else if ([segue.identifier isEqualToString:@"practice"]) {
        PracticeViewController *practiceViewController = [segue destinationViewController];

        NSIndexPath *path = [self.tableView indexPathForSelectedRow];
        int row = [path row];
        Lesson *selected = [purchasedLessons objectAtIndex:row];
        practiceViewController.selectedLesson = selected;
    }
}

@end 
```

课程.h

```
#import <Foundation/Foundation.h>

@interface Lesson : NSObject

@property int purchaseStatus;
@property int productID;
@property (nonatomic, strong) NSString *title;
@property (nonatomic, strong) NSString *subtitle;
@property (nonatomic, strong) NSString *titleAndSubtitle;
@property (nonatomic, strong) NSString *coverArtFilename;
@property (nonatomic, strong) NSString *timing;
@property (nonatomic, strong) NSString *keySignature;
@property (nonatomic, strong) NSString *difficultyImageFilename;
@property (nonatomic, strong) NSString *lessonDescription;
@property (nonatomic, strong) NSString *materialsFilename;
@property (nonatomic, strong) NSString *sheetFilename; // PDF
@property (nonatomic, strong) NSString *midiFilename;
@property (nonatomic, strong) NSString *roll;
@property NSArray *rollPositionArray;
@property int startingIndicatorPosition;

@end 
```

课程.m

```
#import "Lesson.h"

@implementation Lesson
@synthesize productID, coverArtFilename, title, subtitle, titleAndSubtitle, timing, keySignature, difficultyImageFilename, lessonDescription, materialsFilename, sheetFilename, midiFilename, purchaseStatus, roll, rollPositionArray, startingIndicatorPosition;

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T20:38:55.007

我不确定发生了什么，但我重新开始并让它在第二次运行:) 这可能与我的 AppDelegate 在哪里寻找模型有关。

# c# - 这个 c# 3.0 代码有什么问题？

> ID：11376153
> 
> 赞同：0
> 
> 时间：2012-07-07T15:15:50.597
> 
> 标签：c#, c#-3.0

我在下面有这段代码。

```
 delegate void TestDel(string str);
        static void Main(string[] args)
        {
            TestDel td = name=> Console.WriteLine(name);
            TestDel td = (string name) { Console.WriteLine(name);}
            td("hello");
            Console.ReadLine();
        } 
```

在这里，我有一个委托 TestDel ，它首先是通过使用一个很好的 lambda 表达式创建的。但是我使用匿名方法的第二种方法不会编译，但如果像下面这样：

```
TestDel td = delegate(string name) { Console.WriteLine(name);}; 
```

然后一切都很好，我的困惑是为什么我可以使用 lambda 表达式而不是匿名方法，而它们是相同的，为什么我需要使用匿名方法而不是 lambda 表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T15:25:01.440

你的第二个例子应该是：

```
TestDel td = (string name) => { Console.WriteLine(name); }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T15:21:36.010

因为匿名方法*是*使用`delegate`关键字创建的：http: [//msdn.microsoft.com/en-us/library/0yw3tz5k%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/0yw3tz5k%28v=vs.80%29.aspx)这就是语言的工作原理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T15:26:47.290

Lambda 表达式和匿名方法是不同的语言特性。一个 lambda 看起来像这样：

```
a => Something(a) 
```

匿名方法如下所示：

```
delegate (string a) { Something(a); } 
```

可以将其视为匿名类型和类之间的区别，其中 lambda 是匿名方法，而委托是类。

# c# - 如何从路由名称中检索控制器和操作名称？

> ID：11376158
> 
> 赞同：0
> 
> 时间：2012-07-07T15:16:16.747
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing

注册路由后，如何检索属于指定路由名称的控制器和动作名称？

例如，如果我注册这条路线：

```
routes.MapRoute("Category",
                "C/{id}/{urlText}",
                new { controller = "Catalog", action = "ProductListByCategoryId" }
); 
```

我想通过路由名称参数“Category”检索控制器名称“Catalog”和操作名称“ProductListByCategoryId”。

我需要这个作为 html 助手：

```
public static MvcHtmlString MenuLink(this HtmlHelper helper,
                                string name,
                                string routeName,
                                object routeValues)
{
    string currentAction = helper.ViewContext.RouteData.GetRequiredString("action");
    string currentController = helper.ViewContext.RouteData.GetRequiredString("controller");
    object currentId = helper.ViewContext.RouteData.Values["id"];

    string actionName = ""; //This is what I want to specify
    string controllerName = "";  //This is what I want to specify
    var propertyInfo = routeValues.GetType().GetProperty("id");
    var id = propertyInfo.GetValue(routeValues, null);

    if (actionName == currentAction &&
        controllerName == currentController &&
        id == currentId)
    {
        return helper.RouteLink(name, routeName, routeValues, new { @class = "active" });
    }
    else
    {
        return helper.RouteLink(name, routeName, routeValues, new { @class = "active" });
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:32:45.210

仅给定路线名称，您无法执行此操作。原因是一个路由可以匹配多个控制器和动作。您可以做的是从以下位置检索当前控制器和操作`HttpContext`：

```
RouteData rd = HttpContext.Request.RequestContext.RouteData;
string currentController = rd.GetRequiredString("controller");
string currentAction = rd.GetRequiredString("action"); 
```

# javascript - 如何创建带有菜肴选项的餐厅订单菜单？

> ID：11376159
> 
> 赞同：2
> 
> 时间：2012-07-07T15:16:17.397
> 
> 标签：javascript, html

我目前正在开发一个餐厅菜单订购网站，我一直在为某些菜肴添加菜肴选项。我使用单选按钮让用户选择他们喜欢的选项：

`<label class="option"><input type="radio" value="Ketchup"> Ketchup</label>`ETC ...

然后，我有一个添加按钮，它是一个带有 onclick 属性的链接，然后运行一个函数。如何在没有表单的情况下通过函数传递选中的单选框值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:53:46.333

当您单击添加按钮时，它不知道选择了哪个单选按钮，因此您不能真正“通过选中的单选框值”。你可以做的只是检查函数内部的值，如果你给你的收音机一个让你引用它们的类。使用一类说“菜”，其jQuery代码将是：

```
$('.dish:checked').val(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T15:48:16.660

如果您给表单元素 ID，如下所示：

```
<label class="option"><input type="radio" id="radioButton1" value="Ketchup"> Ketchup</label> 
```

然后，您可以通过 DOM 轻松访问单选按钮的值。我不会使用参数，而是使用局部变量，如下所示：

```
function myFunction {
    var myValue;
    if (document.getElementById('radioButton1').checked == true) {
        myValue = document.getElementById('radioButton1').value;
    }
    else {
        // Check other radio buttons
    }
    // Perform some function using myValue
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-25T02:29:05.060

为输入“单选按钮”提供一个 id，每个按钮上都有一个 onClick 事件，当单击该按钮时，将运行该事件所附加到的函数。

# java - 用于绘图的 Java API

> ID：11376160
> 
> 赞同：0
> 
> 时间：2012-07-07T15:16:22.410
> 
> 标签：java, excel, api, plot

有谁知道可以用来绘制数据的不错的 Java API？（我会说它应该“几乎”和 Excel 一样好）

如果没有，有什么方法可以将 Java 程序集成到 Excel 中？目前，我必须将我的 java 程序的输出写入文本文件，然后编写一个宏将数据加载到 Excel 电子表格中并在那里进行绘图。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:17:53.440

你可以试试[JFreeChart](http://www.jfree.org/jfreechart/)。它非常好，开源并且非常积极地开发。它还可以与[JasperReports](http://jasperforge.org/projects/jasperreports/)等其他工具集成（如果您想输出 HTML 和/或 PDF 文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T15:24:36.283

[***jXLS***](http://jxls.sourceforge.net/index.html)

它支持：

1.  复杂对象图导出
2.  数据的动态分组
3.  XLS 模板中的图表、宏和许多其他 Excel 功能

还有很多...

[*基本图表示例*](http://jxls.sourceforge.net/samples/chartsample.html)中的示例[](http://jxls.sourceforge.net/samples/chartsample.html)

# javascript - Firebug 不允许我选择脚本文件

> ID：11376161
> 
> 赞同：0
> 
> 时间：2012-07-07T15:16:32.700
> 
> 标签：javascript, firefox, firebug

Firefox 13.0.1 和 Firebug 1.9.2。

我加载了一个激活 Firebug 的页面。我选择脚本选项卡。此页面加载了多个脚本文件，脚本选项卡显示列表中的第一个（恰好是 JQuery）。到目前为止，一切都很好。我进入包含所有脚本的菜单，然后选择我想要查看的一个。它显示这个脚本大约半秒钟，然后切换回 JQuery。

每次都会发生这种情况，但仅限于我现在正在处理的页面上，并且仅限于一个特定的脚本文件。没有任何错误消息。

有人有什么想法吗？

* * *

更新：问题似乎与脚本文件中的一行有关。

```
$(document).ready(function() {
    // ...

    // If I remove this, the problem goes away:
    setInterval("foo()", 1000) 

}) 
```

# eclipse - ACCELEO：根据模型结构在路径中创建文件

> ID：11376162
> 
> 赞同：0
> 
> 时间：2012-07-07T15:16:39.330
> 
> 标签：eclipse, acceleo, mda, emf

在 Acceleo 模型到文本的转换中，我想为 UML 类创建一个文件，该文件与包含该类的包（UML 模型中的类名称空间）一致。我面临的问题是我必须这样做，因为 [file] 命令需要它，所以我正在尝试这样的事情

```
[file ((c.allOwningPackages().name.->sep('/')).concat(c.name.concat('.hpp')),false,'UTF-8')] 
```

但我在 concat 上收到此错误：

```
 Cannot find operation (concat(String)) for the type (OclAny) 
```

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T07:19:05.740

不必在与文件块相同的行上执行此操作。完成您正在尝试做的事情的两种常用方法是

*   将文件块嵌套到 let 块中或
*   将逻辑提取到另一个模板或查询中。

对于您的示例， b) 会给出以下内容：

```
[template public myMainTemplate(c : uml::Class)]
    [file (getpackage(c), false, 'UTF-8')]
        ...
    [/file]
[/template]

[template private getPackage(c : uml::Class) post(trim())]
    [c.ancestors()->reverse()->sep('/')->including(c.name.concat('.hpp'))/]
[/template] 
```

请注意集合使用“ *->包括*”而不是“ *.concat* ”，这就是您收到错误消息的原因。当然，这只是在一个表情中。它可能更具可读性：

```
[template private getPackage(c : uml::Class) post(trim())]
    [c.ancestors()->reverse()->sep('/')/]/[c.name/].hpp
[/template] 
```

# c++ - 用作 unordered_map 键的一对枚举值的自定义哈希函数

> ID：11376163
> 
> 赞同：2
> 
> 时间：2012-07-07T15:16:51.793
> 
> 标签：c++, hash, enums, unordered-map

我正在尝试使用 std::pair 枚举值作为 unordered_map 容器的键，但我在定义自定义哈希函数时遇到了困难。

我尝试了以下方法：

```
//enum and pair declaration
enum ShapeType{PLANE, BOX, SPHERE};
typedef std::pair<ShapeType,ShapeType> ShapePair;

//unordered_map declaration
typedef void(*CollisionMethod)(const Shape*, const Shape*, CollisionData*);
typedef std::unordered_map<ShapePair, CollisionMethod,ShapePairHash> CollisionMethodsTable; 
```

我不明白如何正确定义 ShapePairHash 函子。我尝试了以下方法：

```
struct ShapePairHash
{
    std::size_t operator()(const ShapePair &pair)
    {
        return std::hash<std::size_t>()(pair.first) ^ std::hash<std::size_t>()(pair.second);
    }
}; 
```

`expression having type 'type' would lose some const-volatile qualifiers in order to call 'function'`但我在 VS 编译器上收到错误 C3840 ( )。

谁能建议我正确的方法来声明要与 unordered_map 一起使用的自定义哈希函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T15:20:58.983

您可以定义最后一个枚举值，然后使用它来生成散列（实际上是一个完美的散列）。请注意，这假设可能的枚举值的数量足够低，因此（假设枚举值的数量为 N）：`N * N + N < MAX_UINT`

```
enum class ShapeType : unsigned int { PLANE=0, BOX=1, SPHERE=2, LAST=3 };

struct ShapePairHash
{
    std::size_t operator()(const ShapePair &pair) const
    {
      return static_cast<std::size_t>(pair.first)
           * static_cast<std::size_t>(ShapeType::LAST)
           + static_cast<std::size_t>(pair.second)
    }
}; 
```

此外，对于您的编译问题，您只需要声明函数*const*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T15:27:54.107

您的 operator() 方法应该是 const：

```
std::size_t operator()(const ShapePair &pair) const 
```

# c# - c#如何组织dll工具？

> ID：11376165
> 
> 赞同：1
> 
> 时间：2012-07-07T15:17:18.793
> 
> 标签：c#, dll, organization

我想知道哪种是组织 dll 工具的最佳方式。

例如，我可以有一个项目，其中包含公司已实施的所有类工具。例如，使用字符串的类、使用文件的类……等等。我的意思是，一个带有我可以在许多项目中使用的工具的通用 dll。例如，这将是一个通用的 myCompaty.Utils.dll。

对于每种类型的工作，它都有许多 dll 的其他方式。例如，我可以有一个 myCompany.Utils.Files，其他 myCompany.Utils.Strings... 等等。

使用第一个选项，我只有一个 dll，但如果两个人需要添加或修复某些东西，只能一个人工作，因为如果两个人同时工作，当一个人编译新的 dll 时，其他人失去工作。

如果我有很多 dll，每种类型的工作一个，那么两个人需要修改同一个 dll 会更加困难，因为每个人都可能负责其中一个 dll。但是，问题是这样，当我部署应用程序时，我的程序目录下会有很多dll。

所以我想知道创建 dll 时哪个是最佳实践。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T15:28:58.850

从您的问题可以清楚地看出您没有使用[版本控制系统](http://en.wikipedia.org/wiki/Software_versioning)。[试试看Tortoise SVN](http://tortoisesvn.tigris.org/)之类的东西——然后，你不会有几个人在同一个软件上工作的问题。

关于 DLL - 我会使用多个 DLL，每个 DLL 仅包含特定类型的实用程序方法。它将使部署更简单。如果您反其道而行之，即为您的所有实用程序方法使用一个 DLL，则每次其中的*任何*内容发生更改时，您都需要重新部署它 - 您更改负责处理文件的代码，您必须发送整个 DLL也将包含不相关的代码。而如果您将拥有多个 DLL，您只需重新部署真正改变的那个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T15:28:20.597

基本上，这将取决于您的库将拥有的类、接口和委托的数量。

想象一下，您的“Company.Shared.dll”中有 3000 个类，并且您正在开发一个 Web 应用程序。3000 个课程中有 600 个用于移动开发。在您的 Web 应用程序开发中使用它们的机会是什么？**零**。

那么，如果您只需要与 Web 开发相关的类，为什么还要为 Web 应用程序开发部署一个包含 3000 个类的程序集呢？*库的大小大于特定于 Web 的库，因为第一个库可以包含许多在 Web 开发中不起作用的代码。*

出于这个原因，您将拥有一个名为**Company.Shared.Web.dll**的共享库和一个所有开发场景通用的名为**Company.Shared.dll**的库。

您可以将上述逻辑用于其他情况和场景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T15:46:33.063

除了版本控制系统（当超过**一半**的开发人员在一个项目上工作时应该是必须的），您的组织允许每个人更改每个其他项目所依赖的基础库（或库）真的很疯狂。这将很快演变成一团糟。

在我的店里，只有一/两个人可以在那里改变任何东西。而这些家伙是最熟练和最有价值的同事。

对于库中存在的功能细分，我不关心大型 DLL。确实，即使我们更改了一点代码（并且当您的代码成熟且经过良好测试时，这种情况很少发生），我也需要重新分发所有内容，但是跟踪为该项目或该项目运送的每个 dll 超过了成本单个 DLL

# php - PHP发送电子邮件PEAR失败

> ID：11376166
> 
> 赞同：0
> 
> 时间：2012-07-07T15:17:34.143
> 
> 标签：php, email, pear

[从 PHP 页面使用 GMail SMTP 服务器发送电子邮件](https://stackoverflow.com/questions/712392/send-email-using-gmail-smtp-server-from-php-page)

我正试图让这个工作。根据给定链接中的答案“它是工作代码，所以使用它”。除非它对我不起作用。

尤其是：

```
<?php

       require_once "Mail.php";

        $from = "<xxxxx.gmail.com>";
        $to = "<xxxxx.gmail.com>";
        $subject = "Hi!";
        $body = "Hi,\n\nHow are you?";

        $host = "smtp.gmail.com";
        $port = "465";
        $username = "xxxxx@gmail.com";
        $password = "*****";

        $headers = array ('From' => $from,
          'To' => $to,
          'Subject' => $subject);
        $smtp = Mail::factory('smtp',
          array ('host' => $host,
            'port' => $port,
            'auth' => true,
            'username' => $username,
            'password' => $password));

        $mail = $smtp->send($to, $headers, $body);

        if (PEAR::isError($mail)) {
          echo("<p>" . $mail->getMessage() . "</p>");
         } else {
          echo("<p>Message successfully sent!</p>");
         }

    ?>  <!-- end of php tag--> 
```

产生：

> 严格标准：非静态方法 Mail::factory() 不应在第 23 行的 F:\xampp\htdocs\test\index.php 中静态调用
> 
> 严格标准：不应静态调用非静态方法 PEAR::isError()，假设 $this 来自第 365 行的 F:\xampp\php\PEAR\Mail\smtp.php 中的不兼容上下文
> 
> 严格标准：不应静态调用非静态方法 PEAR::isError()，假设 $this 来自第 450 行的 F:\xampp\php\PEAR\Net\SMTP.php 中的不兼容上下文
> 
> 严格标准：不应静态调用非静态方法 PEAR::isError()，假设 $this 来自第 467 行 F:\xampp\php\PEAR\Net\SMTP.php 中的不兼容上下文

虽然 phpinfo() 提供注册的套接字：

> tcp、udp、ssl、sslv3、sslv2、tls

但最重要的是，没有发送电子邮件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T15:52:59.867

`$from`尝试在和中设置正确的电子邮件地址`$to`

```
'PeterMorgan@gmail.com' instead of '<PeterMorgan.gmail.com>' 
```

来自 PEAR Mail 文档：

```
include('Mail.php');

$recipients = 'joe@example.com';

$headers['From']    = 'richard@example.com';
$headers['To']      = 'joe@example.com';
$headers['Subject'] = 'Test message';

$body = 'Test message';

$params = ... // set smtp values here
              // http://pear.php.net/manual/en/package.mail.mail.factory.php

$mail_object =& Mail::factory('smtp', $params);

$mail_object->send($recipients, $headers, $body); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:52:02.910

想通了这个问题。对于GMail，他们在他们的网站上说：

> TLS/STARTTLS 端口：587
> 
> SSL 端口：465
> 
> 如果您在发送邮件时遇到问题，但您已确认邮件客户端中的 SMTP 加密已启用，请尝试在不同的端口（465 或 587）上配置您的 SMTP 服务器。

所以我将端口从 465 更改为 587，即使我使用的是 SSL。我不知道为什么这对我有用，但确实如此。

# c++ - 对话框关闭后屏幕保护程序应用程序未关闭

> ID：11376167
> 
> 赞同：1
> 
> 时间：2012-07-07T15:17:38.620
> 
> 标签：c++, memory-leaks, screensaver

我正在尝试用 C++ 编写屏幕保护程序。我已经实现了预览窗口，但我发现它没有关闭的问题是因为我打开了任务管理器，并且我看到 3 个“bounce.scr”实例打开，显然是从预览窗口中打开的。不要误会我的意思。我花了几个小时试图让它关闭，例如检查窗口是否可见，以及父窗口，使用 WM_SYSTEMCOMMAND 和 SC_CLOSE。屏幕保护程序对话框关闭后它仍然不会关闭。这是代码：

抱歉，如果很难阅读，但我并没有真正评论我的代码。

```
 #include <windows.h>
    #include <gl/gl.h>
    #include <gl/glu.h>
    #include <string.h>
    #include <stdlib.h>
    #include <sys/timeb.h>

    struct BALL
    {
        float posX;
        float posY;
        float posZ;
        float velX;
        float velY;
        float velZ;
        float size;
        float colorR;
        float colorG;
        float colorB;
    };

    float state;

    void SetupPixelFormat(HDC hDC)
    {
            int nPixelFormat;

            static PIXELFORMATDESCRIPTOR pfd = {
                    sizeof(PIXELFORMATDESCRIPTOR),          
                    1,                                      
                    PFD_DRAW_TO_WINDOW |                    
                    PFD_SUPPORT_OPENGL |                    
                    PFD_DOUBLEBUFFER,                       
                    PFD_TYPE_RGBA,                          
                    32,                                     
                    0, 0, 0, 0, 0, 0,                       
                    0,                                      
                    0,                                      
                    0,                                      
                    0, 0, 0, 0,                             
                    16,                                     
                    0,                                      
                    0,                                      
                    PFD_MAIN_PLANE,                         
                    0,                                      
                    0, 0, 0 };                              

                    nPixelFormat = ChoosePixelFormat(hDC, &pfd);

                    SetPixelFormat(hDC, nPixelFormat, &pfd);
    }

    HDC scr_hdc;
    bool done;
    bool isPreview;
    int timeFromStart = 0;
    int prevX = 0;
    int prevY = 0;

    LRESULT CALLBACK WndProc(HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)
    {
        static HGLRC hRC;
        static HDC hDC;

        int width, height;

        if (!IsWindowVisible(GetParent(hwnd)) && timeFromStart >= 5 && isPreview)
        {
            message = WM_CLOSE;
        }

        switch(message)
        {
            case WM_CREATE:
                hDC = GetDC(hwnd);
                scr_hdc = hDC;
                SetupPixelFormat(hDC);

                hRC = wglCreateContext(hDC);
                wglMakeCurrent(hDC, hRC);

                return 0;
                break;
            case WM_KEYDOWN:
            case WM_MOUSEMOVE:
                if (isPreview) break;
            case WM_SYSCOMMAND:
                if (isPreview) 
                    { if (wParam == SC_CLOSE) { } else { break; } }
            case WM_CLOSE:
                int x = LOWORD(lParam);
                int y = HIWORD(lParam);
                if (timeFromStart >= 5)
                {
                    if ((x != prevX && y != prevX) || message != WM_MOUSEMOVE)
                    {
                        wglMakeCurrent(hDC, NULL);
                        wglDeleteContext(hRC);
                        done = true;
                        //PostQuitMessage(0);
                    }
                }
                else
                {
                    timeFromStart++;
                }
                prevX = x;
                prevY = y;
                return 0;
                break;
        }
        return (DefWindowProc(hwnd, message, wParam, lParam));
    }

    int screensaver(HINSTANCE hInstance, int balls, HWND parent)
    {
        WNDCLASSEX windowClass;
        HWND hwnd;
        HWND desktopHWND;
        MSG msg;
        DWORD dwExStyle;
        DWORD dwStyle;
        RECT windowRect;
        RECT desktopRect;

        if (parent)
        {
            GetClientRect(parent, &windowRect);
            windowRect.left = 0L;
            windowRect.top = 0L;
            isPreview = true;
        }
        else
        {
            desktopHWND = GetDesktopWindow();
            GetWindowRect(desktopHWND, &desktopRect);

            windowRect.left = 0L;
            windowRect.right = desktopRect.right;
            windowRect.top = 0L;
            windowRect.bottom = desktopRect.bottom;
            isPreview = false;
        }

        windowClass.cbSize = sizeof(WNDCLASSEX);
        windowClass.style = CS_HREDRAW | CS_VREDRAW;
        windowClass.lpfnWndProc = WndProc;
        windowClass.cbClsExtra = 0;
        windowClass.cbWndExtra = 0;
        windowClass.hInstance = hInstance;
        windowClass.hIcon = LoadIcon(NULL, IDI_APPLICATION);
        windowClass.hCursor = LoadCursor(NULL, IDC_ARROW);
        windowClass.hbrBackground = NULL;
        windowClass.lpszMenuName = NULL;
        windowClass.lpszClassName = "ScreensaverClass";
        windowClass.hIconSm = LoadIcon(NULL, IDI_WINLOGO);

        if (!RegisterClassEx(&windowClass))
        {
            return 0;
        }

        //SetCapture();

        /*DEVMODE dmScreenSettings;
        memset(&dmScreenSettings, 0, sizeof(dmScreenSettings));
        dmScreenSettings.dmSize = sizeof(dmScreenSettings);
        dmScreenSettings.dmPelsWidth = 800;
        dmScreenSettings.dmPelsHeight = 600;
        dmScreenSettings.dmBitsPerPel = 32;
        dmScreenSettings.dmFields = DM_BITSPERPEL | DM_PELSWIDTH | DM_PELSHEIGHT;

        ChangeDisplaySettings(&dmScreenSettings, CDS_FULLSCREEN != DISP_CHANGE_SUCCESSFUL); */

        dwExStyle = WS_EX_APPWINDOW;
        dwStyle = WS_POPUP;
        if (!parent)
        {
            ShowCursor(FALSE);
        }

        AdjustWindowRectEx(&windowRect, dwStyle, FALSE, dwExStyle);

        hwnd = CreateWindowEx(NULL, "ScreensaverClass",
                              "Screensaver",
                              dwStyle |
                              WS_CLIPCHILDREN |
                              WS_CLIPSIBLINGS,
                              0, 0,
                              windowRect.right - windowRect.left,
                              windowRect.bottom - windowRect.top,
                              NULL,
                              NULL,
                              hInstance,
                              NULL);
        if (!hwnd)
        {
            return 0;
        }

        if (parent)
        {
            SetParent(hwnd, parent);

            SetWindowLong(hwnd, -16, GetWindowLong(hwnd, -16) | 0x40000000);
        }

        ShowWindow(hwnd, SW_SHOW);
        UpdateWindow(hwnd);

        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        gluPerspective(79, (float)windowRect.right / (float)windowRect.bottom, .03f, 100);
        glMatrixMode(GL_MODELVIEW);

        glDepthFunc(GL_LEQUAL);
        glEnable(GL_DEPTH_TEST);
        glEnable(GL_LIGHTING);
        glEnable(GL_LIGHT0);
        glEnable(GL_COLOR_MATERIAL);

        GLuint room = glGenLists(1);
        glNewList(room, GL_COMPILE);
        glBegin(GL_QUADS);
        glColor4f(1,1,1,1);
        glNormal3f(0,0,-1); // North Side
        glVertex3i(0, 50, 50);
        glVertex3i(50, 50, 50);
        glVertex3i(50, 0, 50);
        glVertex3i(0, 0, 50);
        glNormal3f(-1,0,0); // East Side
        glVertex3i(50, 50, 50);
        glVertex3i(50, 50, 0);
        glVertex3i(50, 0, 0);
        glVertex3i(50, 0, 50);
        glNormal3f(0,0,1); // South Side
        glVertex3i(50, 50, 0);
        glVertex3i(0, 50, 0);
        glVertex3i(0, 0, 0);
        glVertex3i(50, 0, 0);
        glNormal3f(1,0,0); // West Side
        glVertex3i(0, 50, 0);
        glVertex3i(0, 50, 50);
        glVertex3i(0, 0, 50);
        glVertex3i(0, 0, 0);
        glNormal3f(0,-1,0); // Top Side
        glVertex3i(0, 50, 0);
        glVertex3i(50, 50, 0);
        glVertex3i(50, 50, 50);
        glVertex3i(0, 50, 50);
        glNormal3f(0,1,0); // Bottom Side
        glVertex3i(0, 0, 50);
        glVertex3i(50, 0, 50);
        glVertex3i(50, 0, 0);
        glVertex3i(0, 0, 0);
        glEnd();
        glEndList();

        GLuint ball = glGenLists(1);
        glNewList(ball, GL_COMPILE);
        GLUquadric *s = gluNewQuadric();
        gluSphere(s, 1, 10, 10);

        glEndList();

        struct BALL* ballsList = (struct BALL*)calloc(balls, sizeof(struct BALL));

        for (int i = 0; i < balls; i++) 
        {
            ballsList[i].posX = (float)(rand()%50);
            ballsList[i].posY = (float)(rand()%50);
            ballsList[i].posZ = (float)(rand()%50);
            ballsList[i].velX = ((float)rand() / (float)RAND_MAX) - .5f;
            ballsList[i].velY = ((float)rand() / (float)RAND_MAX) - .5f;
            ballsList[i].velZ = ((float)rand() / (float)RAND_MAX) - .5f;
            ballsList[i].size = (float)rand() / (float)RAND_MAX;
            ballsList[i].colorR = (float)rand() / (float)RAND_MAX;
            ballsList[i].colorG = (float)rand() / (float)RAND_MAX;
            ballsList[i].colorB = (float)rand() / (float)RAND_MAX;
        }

        SetTimer(hwnd, 31, 50, (TIMERPROC) NULL);

        struct timeb timeobj;
        long lasttimestamp;
        long thistimestamp;
        float framemultiplier;

        ftime(&timeobj);
        lasttimestamp = (long)timeobj.time * 1000L + timeobj.millitm;

        done = false;

        state = 3;
        float yaw = 0;

        while (!done)
        {
            PeekMessage(&msg, hwnd, NULL, NULL, PM_REMOVE);

            if (msg.message == WM_QUIT)
            {
                state = 1;
                done = true;
            }
            else
            {
                if (msg.message == WM_TIMER)
                {

                ftime(&timeobj);
                thistimestamp = timeobj.time * 1000L + timeobj.millitm;
                framemultiplier = (float)(thistimestamp - lasttimestamp) / 50;

                yaw += framemultiplier;

                glClearColor(0,0,0,1);
                glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

                glLoadIdentity();
                glRotatef(yaw,0,1,0);
                glTranslatef(-25,-25,-25);

                glCallList(room);

                for (int i = 0; i < balls; i++)
                {
                    struct BALL *b = &ballsList[i];
                    b->posX += (b->velX * framemultiplier);
                    b->posY += (b->velY * framemultiplier);
                    b->posZ += (b->velZ * framemultiplier);

                    if (b->posX < b->size)
                    {
                        b->velX = -b->velX;
                        b->posX = b->size;
                    }
                    if (b->posY < b->size)
                    {
                        b->velY = -b->velY;
                        b->posY = b->size;
                    }
                    if (b->posZ < b->size)
                    {
                        b->velZ = -b->velZ;
                        b->posZ = b->size;
                    }
                    float fms = 50 - b->size;
                    if (b->posX > fms)
                    {
                        b->velX = -b->velX;
                        b->posX = fms;
                    }
                    if (b->posY > fms)
                    {
                        b->velY = -b->velY;
                        b->posY = fms;
                    }
                    if (b->posZ > fms)
                    {
                        b->velZ = -b->velZ;
                        b->posZ = fms;
                    }

                    b->velY -= .01f * framemultiplier;

                    glColor3f(b->colorR, b->colorG, b->colorB);
                    glPushMatrix();
                    glTranslatef(b->posX, b->posY, b->posZ);
                    glScalef(b->size, b->size, b->size);
                    glCallList(ball);
                    glPopMatrix();
                    lasttimestamp = thistimestamp;
                }

                SwapBuffers(scr_hdc);
                }

                TranslateMessage(&msg);
                DispatchMessage(&msg);
            }
        }

        /*ChangeDisplaySettings(NULL, 0);*/
        ShowCursor(TRUE);
        //ReleaseCapture();

        KillTimer(hwnd, 31);

        free(ballsList);

        return msg.wParam;
    }

    int APIENTRY WinMain(HINSTANCE hInstance,
                         HINSTANCE hPrevInstance,
                         LPSTR     lpCmdLine,
                         int       nCmdShow)
    {
        if (strstr(lpCmdLine, "/s"))
        {
            return screensaver(hInstance, 30, NULL);
        }
        else if (strstr(lpCmdLine, "/p"))
        {
            HWND ptr = (HWND)atoi(lpCmdLine + 3);
            screensaver(hInstance, 30, ptr);
        }
        return 0;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-17T23:18:41.903

当您制作预览窗口时，您应该使用 WS_CHILD 而不是 WS_POPUP，否则您将不会收到关闭父窗口的通知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-19T03:38:38.767

您无需创建自己的预览窗口。您可以使用 Windows 为您创建的一个。

```
if( parent ){
    hwnd= parent;
}else{
    hwnd= CreateWindow ...
}
hDC= GetDC(hwnd);
SetupPixelFormat(hDC);
hRC= wglCreateContext(hDC);
wglMakeCurrent(hDC, hRC); 
```

后来在渲染检查结果之后`SwapBuffers`。如果它失败了，那么用户已经关闭了预览，并且窗口被破坏了，是时候退出了。

```
if( !SwapBuffers(scr_hdc) )
    break;
} 
```

请记住，您`WndProc`没有附加到该窗口。所以在预览时不会有`WM_TIMER`, `WM_CREATE`, , 。`WM_QUIT`

还记得不要破坏预览窗口，如果你还没有创建它。

# javascript - Javascript解析json日期时区不匹配导致错误日期显示

> ID：11376169
> 
> 赞同：3
> 
> 时间：2012-07-07T15:18:08.890
> 
> 标签：javascript, json, date, timezone-offset

javascript 解析日期的显示会根据加载页面的机器的时区而有所不同。

```
SERVER TIME: EST
MACHINE #1 TIME: EST - shows proper date
MACHINE #2 TIME: EST - shows proper date
MACHINE #3 TIME: PST - shows one day earlier 
MACHINE #4 TIME: PST - shows one day earlier 
```

我想知道如何解析 JSON 日期，这样时区就不会成为一个因素。这是我当前的代码：

```
var jsonDate = "/Date(1341633600000)/";
var formattedDate = new Date(parseInt(jsonDate.substr(6)));
return formattedDate.getMonth() + 1 + "/" + formattedDate.getDate() + "/" + formattedDate.getFullYear(); 
```

忽略时区偏移的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T15:21:24.000

**该问题与解析**日期无关。您正在向客户端发送 UTC 时间戳，并且客户端（正确地）以本地术语反映日期。

您始终可以使用`getUTCxxx`方法 ( `getUTCDate()`, `getUTCMonth()`, `getUTCFullYear()`) 使页面将日期显示为 UTC。或者，您可以将时间戳转换为服务器上其本地时区的日期字符串，以便客户端时区根本不会计算在内。

# objective-c - 更改 UIView alpha 值

> ID：11376170
> 
> 赞同：0
> 
> 时间：2012-07-07T15:18:09.430
> 
> 标签：objective-c, ios, ios5, uiview

我正在尝试创建一个 UIView 并更改其 alpha 属性以模拟背光变化。这是我的代码

```
 TransparentView = [[UIView alloc] initWithFrame:self.view.bounds];
    TransparentView.backgroundColor = [UIColor whiteColor];
    self.view = TransparentView;

    TransparentView.alpha = 0.2; 
    float step = 1.0 / ( appDelegate.OnOffTime * 100);
    for (float f = 0; f < 1; f=f+step) {
        TransparentView.alpha = (CGFloat)(1 - f);
        [NSThread sleepForTimeInterval:0.01];
} 
```

两者`TransparentView.alpha = 0.2`都 `TransparentView.alpha = (CGFloat)(1 - f)`改变`TransparentView.alpha`​​了，但只`TransparentView.alpha = 0.2`改变了真实设备的“亮度”。我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T15:59:36.040

我认为问题在于您正在休眠线程，而不是实际设置异步计时器。这意味着，您实际上并没有让运行循环在屏幕上进行更改，因为您不会退出此循环，直到它恢复到 1 :-)

编辑：澄清：

在运行循环“回来”之前，您对 UI 所做的任何更改实际上都不会被绘制，这需要您的方法返回。您可能需要一个 NSTimer 实例，配置为调用此对象上的方法，该方法增加 alpha（并根据您的目标值检查 alpha；当计时器到达时使计时器无效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T20:03:27.040

您可能需要考虑更改代码以使用内置的 UIView 动画支持。这将确保您的视图已更新，并且您不会使主线程处于休眠状态。如果你需要在动画完成后做一些特别的事情，你可以使用**completion:**版本的方法。

```
TransparentView.alpha = 0.2;
[UIView animateWithDuration: appDelegate.OnOffTime animations:^{
    TransparentView.alpha = 0.0;
}]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T15:47:40.887

Alpha 和亮度是视图的两个不同概念。如果你真的想改变显示器的亮度，你可以使用 iOS 5+ 的`[[UIScreen mainScreen]brightness];`，否则你的 alpha 变化需要在黑色背景下进行，而不是使用像 cast 1-float 这样奇怪的数字。我敢打赌，你的小算法返回了一个足够大的步长因子，以至于你的视图被告知显示超过一个的 alpha 值（无论如何默认为一个）。

# mysql - 仅当我刷新页面时从 jquerymobile 上的 MySQL 获取数据

> ID：11376172
> 
> 赞同：0
> 
> 时间：2012-07-07T15:18:23.603
> 
> 标签：mysql, jquery-mobile, getjson

好的，所以我正在尝试加载数据并在我单击 index.html 中的搜索按钮后移至另一个页面

这是我的搜索按钮

```
 <a href="results.html" data-role="button" data-icon="search"
 data-iconpos="notext">search</a> 
```

并且在加载时我希望页面运行此功能并获取数据

```
 $(function () { $.getJSON("API.php", {
         command: "getBusiness",
         orig_lat: myPos.lat,
         orig_long: myPos.lon, 
         distance: 0.05 },

      function (result) { 
         $("#locations").html("");
         for (var i = 0; i < result.length; i++) {
            $("<a href='business.html?ID=" + result[i].id + "&bsnName=" + "'>
            <div>" + result[i].bsnName + " " + (parseInt(result[i].distance * 1000))
            "</div></a>").appendTo("#locations");}});}); 
```

只有当我点击刷新时，页面才会在没有数据库的情况下加载，它会向我显示结果

我不确定这里出了什么问题，我不应该使用 getJSON 吗？我见过人们谈论 .Ajax() 和 getJSON() 一样吗？

关于如何移动到另一个页面并同时将数据从数据库抓取到您要在 jquerymobile 上加载的页面，是否有更好的主意？

我尝试使用 onclick 使用相同的功能，当我给它一个 div 时它起作用了

头部的其余部分

```
 <link rel="stylesheet" href="styles/jquery.mobile.structure-1.1.0.min.css" />
    <link rel="stylesheet" href="styles/jquery.mobile.theme-1.1.0.min.css" />
    <link rel="stylesheet" href="styles/my.css" />
    <script src="scripts/jquery-1.7.2.min.js"></script>
    <script src="scripts/jquery.mobile-1.1.0.min.js"></script>
    <script src="scripts/cordova-1.8.1.js"></script>

        <script>

            // Wait for Cordova to load
            //
            document.addEventListener("deviceready", onDeviceReady, false);

            var watchID = null;
            var myPos = { lat: 32.0791, lon: 34.8156 };

            // Cordova is ready
            //
            function onDeviceReady() {
                // Throw an error if no update is received every 30 seconds
                var options = { timeout: 10000 };
                watchID = navigator.geolocation.watchPosition(onSuccess, onError, options);
            }

            // onSuccess Geolocation
            //
            function onSuccess(position) {
                var element = document.getElementById('geolocation');
                //myPos.lat=position.coords.latitude;
                //myPos.lon=position.coords.longitude;     

                element.innerHTML = 'Latitude: ' + position.coords.latitude + '<br />' +
                            'Longitude: ' + position.coords.longitude + '<br />' +
                            '<hr />' + element.innerHTML;
            }

            // onError Callback receives a PositionError object
            //
            function onError(error) {
                alert('code: ' + error.code + '\n' +
              'message: ' + error.message + '\n');
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:23:56.263

基本上，当 jQuery 移动首先加载或索引页面时，它会加载整个头部部分（Javascript、CSS 等）和正文部分。但是当用户单击 jQuery Mobile 驱动的站点中的链接时，导航系统的默认行为是使用该链接的 href 来制定 Ajax 请求（而不是允许浏览器的默认链接行为请求该 href 与整个页面加载)。当该 Ajax 请求发出时，框架将接收其整个文本内容，但它只会注入响应的正文元素的内容。

这个问题可以有多种解决方案，例如

*   构建 jQuery Mobile 站点时最简单的方法是在每个页面的头部引用相同的样式表和脚本集。

*   通过在链接中使用属性 data-ajax="false" 在没有 Ajax 的情况下进行链接，此属性将加载没有 ajax 和动画的下一页，因此头部和正文部分都会加载。

*   如果您需要为特定页面加载特定的脚本或样式，建议将逻辑绑定到 pageInit，例如“#aboutPage”是 id="aboutPage" 属性。

    ```
     $( document ).delegate("#aboutPage", "pageinit", function() {
       //you can place your getJson script here. that will execute when page loads 
       alert('A page with an ID of "aboutPage" was just created by jQuery Mobile!');
     }); 
    ```

因此，在您的情况下，更好的解决方案是将您的 ajax 调用或其他特定脚本与 pageinit 事件绑定。

您可以从这些 jQuery Mobile 文档页面获得帮助。

[http://jquerymobile.com/demos/1.1.0/docs/pages/page-links.html](http://jquerymobile.com/demos/1.1.0/docs/pages/page-links.html)

[http://jquerymobile.com/demos/1.1.0/docs/pages/page-scripting.html](http://jquerymobile.com/demos/1.1.0/docs/pages/page-scripting.html)

# macos - Mac 欺骗 HTTP 响应

> ID：11376175
> 
> 赞同：0
> 
> 时间：2012-07-07T15:18:41.487
> 
> 标签：macos, networking, spoofing

如果一个程序发送一个http请求，有没有办法欺骗请求返回的数据？

例如：

将名称发送到服务器以检查权限的程序：`http://example.com/test.php?name=Stackoverflow`

实际反应：`HI`

我想恶搞的回应：`HELLO`

此外，是否有良好的身份验证形式来防止这种情况（如果可能的话）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:23:22.503

这个问题是非常开放的，所以很难用非常具体的东西来回答它。根据您要执行的操作，像 Fiddler（仅限 Windows）、Burp 等这样的简单代理可能会成功。您还可以使用主机文件、iptables（请参阅 Otto 的评论）等来玩技巧。这绝对是可能的，但取决于您正在尝试做什么，某些方法可能比其他方法更合适。

至于您问题的第二部分（确保不会发生这种情况的身份验证），这是 HTTPS 的主要目的之一。

> 在其在 Internet 上的流行部署中，HTTPS 提供对与之通信的网站和相关 Web 服务器的身份验证，从而防止中间人攻击。此外，它还提供客户端和服务器之间通信的双向加密，从而防止窃听和篡改和/或伪造通信内容。在实践中，这提供了一个合理的保证，即一个人正在与一个想要与之通信的网站进行通信（而不是一个冒名顶替者），并确保用户和网站之间的通信内容不会被阅读或伪造由任何第三方。

[http://en.wikipedia.org/wiki/HTTP_Secure](http://en.wikipedia.org/wiki/HTTP_Secure)

# ruby-on-rails-3 - 引导选项卡内的 kaminari 分页

> ID：11376180
> 
> 赞同：4
> 
> 时间：2012-07-07T15:19:12.263
> 
> 标签：ruby-on-rails-3, pagination, twitter-bootstrap, kaminari

我的项目正在使用 twitter 引导选项卡，并且在每个选项卡中都有 Rails 模型对象的集合。我需要为每个选项卡中的集合使用 kaminari 分页。

因为，在每个选项卡中，都会有一个来自显示的模型对象的选项卡内容的分页。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-27T13:36:24.510

我昨天遇到了同样的问题，尽管我会在这里发布我找到的解决方案。（在引导程序中工作 3x）

我也想使用 Kaminari 在引导程序的选项卡中跨多个表进行分页。问题是，每次您前进页面时，它都会刷新并将您送回第一个选项卡。

解决此问题所需的第一步是了解如何在页面加载时将其定向到特定选项卡。通过一些搜索，我发现我可以通过将链接到选项卡的哈希链接到选项卡的 url 来做到这一点。（我不记得我在哪里找到的。）

```
// Example
#tab1, #tab2, #tab3 
```

**咖啡脚本**

```
$ ->
hash = window.location.hash
hash and $("ul.nav a[href=\"" + hash + "\"]").tab("show")
$(".nav-tabs a").click (e) ->
$(this).tab "show"
scrollmem = $("body").scrollTop()
window.location.hash = @hash
$("html,body").scrollTop scrollmem
return

return 
```

**Javascript**

```
$(function(){
var hash = window.location.hash;
hash && $('ul.nav a[href="' + hash + '"]').tab('show');

$('.nav-tabs a').click(function (e) {
$(this).tab('show');
var scrollmem = $('body').scrollTop();
window.location.hash = this.hash;
$('html,body').scrollTop(scrollmem);
});
}); 
```

然后，所有需要的只是将正确的锚传递给 Kaminari。

```
= paginate @foo, :param_name => "page_method", :params => { :anchor => 'tab4' } 
```

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-28T19:10:59.723

这是使用 bootstrap 2.3 在视图中工作的解决方案片段。如果`tab`调用 URL 中提供了 ' ' 参数，则将显示该选项卡；否则，将显示第一个选项卡。

```
<ul class="nav nav-tabs" id="my_tabs">
    <li><a href="#one" data-toggle="tab">Tab One</a></li>
    <li><a href="#two" data-toggle="tab">Tab Two</a></li>
    <li><a href="#three" data-toggle="tab">Tab Three</a></li>
</ul>

<div class="tab-content">
    <div id="one" class="tab-pane">
         <%= paginate @stuff, :params => {:tab => "one"}, :theme => 'twitter-bootstrap', :pagination_class => "pagination-large"  %>
    </div>

    <div id="two" class="tab-pane">
         <%= paginate @stuff, :params => {:tab => "two"}, :theme => 'twitter-bootstrap', :pagination_class => "pagination-large"  %>
    </div>

    <div id="three" class="tab-pane">
         <%= paginate @stuff, :params => {:tab => "three"}, :theme => 'twitter-bootstrap', :pagination_class => "pagination-large"  %>
    </div>
</div>

<% @tab_id = params[:tab] ? "#my_tabs a[href=" + %Q(##{params[:tab]}) + "]" : "#my_tabs a:first" %>

<% content_for :footer do %>
    <script>
      $(function () {
        $('#<%= @tab_id %>').tab('show');
      })
    </script>
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-11T01:03:32.277

如果您使用 jQuery.tabs() 那么这种方式可以帮助您。

您应该为所有选项卡添加 kaminari 主题。

```
$> rails g kaminari:views default
$> cd app/views/kaminari
$> mkdir one
$> cp *_.html.* one/ 
```

然后你应该编辑*kaminari/first_tab*中的文件。您应该将变量*url*替换为目录中的*“#{url}”#one*。

像这样： *app/views/kaminari/one/_first_page.html.erb*

```
<%= link_to 'prev', "#{url}#one", class: 'first', page: '1' %> 
```

那么你应该添加主题名称：

```
<script>
  $(document).ready(function () {
    $("#my_tabs").tabs();
  });
</script>
<ul class="nav nav-tabs" id="my_tabs">
  <li><a href="#one" data-toggle="tab">Tab One</a></li>
  <li><a href="#two" data-toggle="tab">Tab Two</a></li>
  <li><a href="#three" data-toggle="tab">Tab Three</a></li>
</ul>

<div class="tab-content">
  <div id="one" class="tab-pane">
    <%= paginate @stuff, theme: 'one' %>
  </div>
  <div id="two" class="tab-pane">
    <%= paginate @stuff, theme: 'two' %>
  </div>
</div> 
```

# php - 在'onexit'或'onsubmit'之后，查询mysql并填充表单字段而不离开页面php js

> ID：11376182
> 
> 赞同：0
> 
> 时间：2012-07-07T15:19:20.670
> 
> 标签：php, javascript, mysql

我正在尝试使用 MySQL 数据填充一些表单字段。

我希望能够在文本字段中输入一个值，使用该字段中的值搜索数据库，然后在不离开页面的情况下用结果填充表单字段的其余部分。

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:30:09.643

您可以为此使用 AJAX - 使用您的输入提交按钮来触发一个 php 文件来搜索数据库。

这使我们进入 MySQL 搜索。您将需要使用 FULLTEXT 搜索数据库（此处有大量文档[http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)）。或者，如果搜索不那么复杂，您应该只使用 SELECT * WHERE。然后回显你找到的数据。

然后，AJAX 请求会将回显的内容返回给您，然后您可以使用一些 JQuery 来用您的数据填充您喜欢的任何元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T15:25:13.030

使用 jQuery post 从数据库中获取数据

在带有输入的页面上：

```
$.post("pageWhereYouGetData.php", {valueYouWantToQueryTheDBWith: $("input.info").val()}, function(data){
    var dataArray = data.join(", ");
    //do stuff with inputs here like: $("input.moreInfo").val(dataArray[0]) which would set the value of your input to the value of the row 'row1' from the database
}); 
```

pageWhereYouGetData.php：

```
$results = mysql_fetch_assoc(mysql_query("SELECT row1, row2, row3 FROM table WHERE rowName = '" . mysql_real_escape_string($_POST['valueYouWantToQueryTheDBWith']) . "'"));

$data = array($results['row1'], $results['row2'], $results['row3']);
echo explode(", ", $data); 
```

在这里，您正在创建一个填充了所需数据的数组，将其转换为字符串，然后将其回显。在 javascript 方面，您将其转换回数组（因为您不能通过 ajax 发送变量，只能发送值），然后使用该数组来填充您的输入。

这个想法是在不重新加载页面的情况下发送数据，将其转换为字符串，一旦我们获得数据就将其转换回来，然后按照我们的意愿使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T17:29:40.337

我最终修改了我找到的这个脚本。它不在同一页面上，但执行我需要的功能。当用户输入一个值并退出该字段时，将根据表检查该值是否匹配。然后它将结果与字段中的值一起返回到调用页面。

这与表单元素一起放置在页面中：

```
function showData(str)
{
if (str=="")
  {
  document.getElementById("txtHint").innerHTML="";
  return;
  } 
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","get_listing_data.php?q="+str,true);
xmlhttp.send();
}

<input type="text" name="mls_id" id="mls_id" onchange="showData(this.value)">

<div id="txtHint"></div> // this is where the populated fields appear 
```

这是执行查询并将结果返回到第一个文件的文件 - 从第一个文件调用。

```
$link = mysql_connect("localhost","name","pw") or die ("No database connection -     please try again later.");
$db = mysql_select_db("db", $link); 

$q=$_GET["q"];

$sql="SELECT * FROM table WHERE MLS_LISTING_ID = '$q'";

$result = mysql_query($sql);

while($row = mysql_fetch_array($result))
  {
 echo "<input type=\"text\" name=\"agent_name\" id=\"agent_name\" value=" . $row    ['MLS_AGENT_NAME'] . " readonly=\"readonly\">";
 echo "<input type=\"text\" name=\"sale_price\" id=\"last_name\" value=" . $row['SALE_PRICE'] . " readonly=\"readonly\">";
 echo "<input type=\"text\" name=\"street_number\" id=\"last_name\" value=" . $row['STREET_NUMBER'] . " readonly=\"readonly\">";
 echo "<input type=\"text\" name=\"street_name\" id=\"last_name\" value=" . $row['STREET_NAME'] . " readonly=\"readonly\">";
  } 
```

# android - Phonegap/HTML5 和 Android 屏幕从横向旋转到纵向时调整大小问题

> ID：11376183
> 
> 赞同：13
> 
> 时间：2012-07-07T15:19:31.557
> 
> 标签：android, html, cordova, rotation, portrait

当用户从横向旋转到纵向时，我现在遇到一个 android phonegap 应用程序的奇怪问题，但反之则不然。

当屏幕从横向旋转到纵向时，内容视口的高度似乎保持在先前的高度 - 但是视口的宽度会正确调整大小。以下图像试图更清楚地显示这一点：

![风景...](../Images/6f79c2d271925f07854318f8b1163804.png)旋转到 ![...然后是纵向视图](../Images/5f2a82e689a9096d5e5045d8def42cf7.png)

我看到了这个问题：[Android Screen Orientation: Landscape Back to Portrait](https://stackoverflow.com/questions/9678197/android-screen-orientation-landscape-back-to-portrait) ...但是虽然公认的答案可能是正确的，但我并不完全确定那里要求的是什么。

我只有一个带有默认配置的 layout/main.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >
<TextView  
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" 
    android:text="@string/hello"
    />
</LinearLayout> 
```

我也尝试过放置一些方向检测脚本，看看是否有帮助 - 我试过：

```
 var viewPortHeight = $(window).height();
alert (viewPortHeight+" x "+$(window).width());
var headerHeight = $('div[data-role="header"]').height();
var footerHeight = 0;
var contentHeight = viewPortHeight - headerHeight - footerHeight;

// Set all pages with class="page-content" to be at least contentHeight
$('div[class="page-content"]').css({'min-height': contentHeight + 'px'}); 
```

并且

```
 var devInfo = new DeviceInformation();
            devInfo.setOrientation(0);
            time_column_count = Math.floor(viewport.height / 270);
            devInfo.setResolution({
                height  : $(window).width(),
                width : $(window).height()
            }); 
```

但是 - 没有骰子。这里有什么想法吗？

**更新**

这似乎只是 ICS 设备上的问题 - 在遇到此问题的设备上，横向模式下实际上存在滚动问题。JQM Scroll 用于在不同的 div 上启用滚动。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-11T10:05:28.937

前段时间我遇到了与phonegap类似的问题。下面的代码应该可以帮助您解决这个问题。

1 - 确保在 html 文件的头部调用 phonegap.js 文件

2 - 在 html 页面的头部添加以下元标记

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

3 - 在 onDeviceReady() 中添加事件监听器

```
<script type="text/javascript">
function onDeviceReady() 
{
    document.addEventListener("orientationChanged", updateOrientation);
}
</script> 
```

4 - 如果要对不同的方向（可能是不同的图像）添加特定更改，请使用类似的 switch 语句

```
function updateOrientation()
{
    var e = window.orientation;
    switch(e)
    {  
        case 0:
            // PORTRAIT
        break;

        case -90:
            // LANDSCAPE
        break;

        case 90:
            // LANDSCAPE
        break;

        default:
            //PORTRAIT
        break;
    }        
} 
```

5 - 在结束 javascript 标记后添加以下样式

```
<style>
    [data-role=page]{height: 100% !important; position:relative !important; top:0 !important;}
</style> 
```

请尝试上述方法并让我知道它是否有效，如果没有，您可以采取其他一些方法。

谢谢， L & L 合作伙伴

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T12:10:29.817

转到清单文件：

在活动内添加以下属性：

```
android:theme="@android:style/Theme.Translucent" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T14:05:42.940

我同意之前关于使用视口元标记的评论。尽管我要补充一点，您还应该为布局指定预期的像素密度。

我发现在移动设备上布局纵向与横向时非常宝贵的一件事是使用 CSS 媒体查询。这些将允许您更改横向和纵向模式中屏幕元素的 CSS 样式，而无需完全依赖 javascript。
这也可以更好地控制智能手机与平板电脑的布局。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-20T17:52:07.490

我遇到了同样的问题，但是使用了内置了 cordova 的 Intel xdk 应用程序框架。为了解决这个问题，我所做的只是做一个新项目，复制我在前一个项目中的所有内容并在其中重建 cordova。尽管这一次，我没有通过界面添加插件，而只是复制了我之前项目中的配置文件。奇怪的是，它起作用了，现在视口调整得很好。所以我的猜测是它可能是版本的问题或者配置中的某些东西是错误的。

希望在某种程度上有所帮助。

PS对不起英语不好

**更新** 当我构建应用程序时，问题似乎仍然存在。解决问题（目前看来是唯一的解决方案）就是这样做。

```
window.addEventListener('orientationchange', doOnOrientationChange);
function doOnOrientationChange()
  {
    switch(window.orientation) 
    {  
      case -90:
      case 90:
                setTimeout(function(){
                var ScreenHeight = screen.height;
                document.body.style.height = '100%';
                window.innerHeight = ScreenHeight - (FOOTER HEADER);},100);
        break; 
      default:
            var ScreenHeight = screen.height;
            document.body.style.height = "100%";
            window.innerHeight = ScreenHeight - (FOOTER HEADER);
        break; 
    }
  } 
```

它在 99% 的时间里都能正常工作（有时它不能正确调整，但并不经常发生），并且在几帧界面中会有一些滞后。如果您想知道为什么风景中有超时，因为出于某种原因，它会被....某物覆盖。我不知道为什么科尔多瓦会这样做，但目前，这是我发现解决此错误的唯一方法。

希望它有所帮助:-D

# jquery - jQuery serializeArray() 键值对

> ID：11376184
> 
> 赞同：52
> 
> 时间：2012-07-07T15:19:36.260
> 
> 标签：jquery, serialization

我在序列化表单时遇到了一些麻烦

```
<form>
    <input type="text" name="name1" value="value1"/>
    <input type="text" name="name2" value="value2"/>
</form>

$(form).serializeArray() 
```

将返回`[{name:"name1",value:"value1"},{name:"name2",value:"value2"}]`对。

是否有可能以表格形式获得输出

```
{name1:value1,name2:value2} 
```

让他们更容易处理？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-07-07T15:24:04.560

```
var result = { };
$.each($('form').serializeArray(), function() {
    result[this.name] = this.value;
});

// at this stage the result object will look as expected so you could use it
alert('name1 = ' + result.name1 + ', name2 = ' + result.name2); 
```

[现场演示。](http://jsfiddle.net/9zZbu/)

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2015-07-31T16:54:42.940

```
$.fn.serializeObject = function () {
    var o = {};
    var a = this.serializeArray();
    $.each(a, function () {
        if (o[this.name] !== undefined) {
            if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
            }      
            o[this.name].push(this.value || '');
        } else {
            o[this.name] = this.value || '';
        }
    });
    return o;
}; 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2012-09-13T03:42:58.500

如果您的表单没有复选框或单选按钮，则接受的答案非常有用。由于这些组都具有相同的名称属性，因此您需要在对象内创建一个数组值。所以对于像这样的html：

```
<input type="checkbox" value="1" name="the-checkbox">
<input type="checkbox" value="2" name="the-checkbox">
<input type="checkbox" value="3" name="the-checkbox"> 
```

你会得到：

```
{the-checkbox:['1', '2', '3']} 
```

[这段](https://raw.github.com/cowboy/jquery-misc/master/jquery.ba-serializeobject.js)代码可以很好地处理所有事情。

```
/*!
 * jQuery serializeObject - v0.2 - 1/20/2010
 * http://benalman.com/projects/jquery-misc-plugins/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

// Whereas .serializeArray() serializes a form into an array, .serializeObject()
// serializes a form into an (arguably more useful) object.

(function($,undefined){
  '$:nomunge'; // Used by YUI compressor.

  $.fn.serializeObject = function(){
    var obj = {};

    $.each( this.serializeArray(), function(i,o){
      var n = o.name,
        v = o.value;

        obj[n] = obj[n] === undefined ? v
          : $.isArray( obj[n] ) ? obj[n].concat( v )
          : [ obj[n], v ];
    });

    return obj;
  };

})(jQuery); 
```

用法

```
$(form).serializeObject(); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-07-07T15:27:02.793

```
new_obj = {}

$.each($(form).serializeArray(), function(i, obj) { new_obj[obj.name] = obj.value }) 
```

您的数据在 new_obj 中

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-06-20T14:56:49.257

您可以非常简单地使用`.reduce()`和解构赋值：

```
const arr = $('form').serializeArray(); // get the array
const data = arr.reduce((acc, {name, value}) => ({...acc, [name]: value}),{}); // form the object 
```

例子：

```
$('form').on('submit', function(e) {
  e.preventDefault(); // only used for example (so you can see output in console);
  const arr = $(this).serializeArray(); // get the array
  const data = arr.reduce((acc, {name, value}) => ({...acc, [name]: value}),{}); // form the object
  console.log(data);
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<form>
  <input type="text" placeholder="username" name="username"/>
  <input type="email" placeholder="email" name="email"/>
  <input type="submit" />
</form>
```

或者如果你能支持它，[`Object.fromEntries()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries)甚至更容易：`.map()`

例子：

```
$('form').on('submit', function(e) {
  e.preventDefault(); // only used for example (so you can see output in console);
  const arr = $(this).serializeArray(); // get the array
  const data = Object.fromEntries(arr.map(({name, value}) => [name, value]));
  console.log(data);
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<form>
  <input type="text" placeholder="username" name="username"/>
  <input type="email" placeholder="email" name="email"/>
  <input type="submit" />
</form>
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-21T19:47:03.777

您可以制作自定义功能。

```
var complex = $(form).serialize(); // name1=value1&name2=value2
var json = toSimpleJson(complex); // {"name1":"value1", "name2":"value2"}

function toSimpleJson(serializedData) {
    var ar1 = serializedData.split("&");
    var json = "{";
    for (var i = 0; i<ar1.length; i++) {
        var ar2 = ar1[i].split("=");
        json += i > 0 ? ", " : "";
        json += "\"" + ar2[0] + "\" : ";
        json += "\"" + (ar2.length < 2 ? "" : ar2[1]) + "\"";
    }
    json += "}";
    return json;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-10-07T14:41:51.757

这是[Hollister](https://stackoverflow.com/users/475071/hollister)代码的一些现代化。

```
(function($,undefined){
  '$:nomunge'; // Used by YUI compressor.

  $.fn.serializeObject = function(){
    var obj = {},
        names = {};

    $.each( this.serializeArray(), function(i,o){
      var n = o.name,
        v = o.value;

        if ( n.includes( '[]' ) ) {
          names.n = !names.n ? 1 : names.n+1;
          var indx = names.n - 1;
          n = n.replace( '[]', '[' + indx + ']' );
        }

        obj[n] = obj[n] === undefined ? v
          : $.isArray( obj[n] ) ? obj[n].concat( v )
          : [ obj[n], v ];
    });

    return obj;
  };

})(jQuery); 
```

如果您需要`myvar[]`复选框的字段名称。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-09-28T07:54:58.227

这是我的解决方案，它支持单选按钮和多选。

```
var data = $('#my_form').serializeArray().reduce(function (newData, item) {
    // Treat Arrays
    if (item.name.substring(item.name.length - 2) === '[]') {
        var key = item.name.substring(0, item.name.length);
        if(typeof(newData[key]) === 'undefined') {
            newData[key] = [];
        }
        newData[key].push(item.value);
    } else {
        newData[item.name] = item.value;
    }
    return newData;
}, {});

console.log(data);
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<form id="my_form">
  <select name="muli_select[]" multiple="multiple">
    <option value="1" selected>Value 1</option>
    <option value="2" selected>Value 2</option>
    <option value="3">Value 3 Not selected</option>
  </select>
  <br>
  <input name="my_text" type="hidden" value="Hidden Text"/>
  <input name="my_text2" type="text" value="Shown Text"/>
  <br>

  <input type="radio" name="gender" value="male" checked> Male<br>
  <input type="radio" name="gender" value="female"> Female
</form>
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-11-30T17:20:07.950

给你的表单一个 id(form-id)

```
var jsoNform = $("#form-id").serializeObject();

jQuery.fn.serializeObject = function () {
    var formData = {};
    var formArray = this.serializeArray();
    for (var i = 0, n = formArray.length; i < n; ++i)
         formData[formArray[i].name] = formArray[i].value;
     return formData;
}; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-06-05T21:50:49.510

要仅获取具有值的表单输入...

```
var criteria = $(this).find('input, select').filter(function () {
    return ((!!this.value) && (!!this.name));
}).serializeArray(); 
```

条件：{名称：“姓氏”，值：“史密斯”}

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-02-03T12:22:03.870

我还将使用 Nick Parsons 的剪辑添加一些内容：

```
(function($,undefined){
    $.fn.serializeObject = function(){
        return this.serializeArray()
            .reduce((acc, {name, value}) => ({...acc, [name]: value}),{});
    };

})(jQuery); 
```

其他示例不允许覆盖具有相同名称的字段。“serializeArray” 负责这一点，尼克的剪断使它工作得更好。

# c - gtk+2.0 哪个小部件用于好友列表？

> ID：11376185
> 
> 赞同：0
> 
> 时间：2012-07-07T15:19:53.733
> 
> 标签：c, gtk

我刚刚开始研究 gtk，因为我必须用它编写一个 GUI 应用程序。这是一个 IM 应用程序，我需要在用户登录时显示他/她的朋友列表。列表应在左侧显示小图片，在右侧显示名称，如下所示：

```
Friends
-----------
Pic1  John
Pic2  Sara
...   ... 
```

据我目前所知，我认为最好的套装是 Treeview，但它有烦人的分隔符和标题，所以列表是这样的：

```
Friends
------------
PIC  |  Name
------------
Pic1 |  John
------------
Pic2 |  Sara 
```

有没有办法解决这个问题？还是有更好的方法来实现这一目标？

我还想在名称部分包含更多信息，如下所示：

```
Friends
----------
Pic1  John
Pic1  This is more about John
Pic1  Still more about John
Pic1  Sara
Pic1  This is more about Sara
Pic1  Still more about Sara 
```

请注意，三个 Pic1 和 Pic2 仍然代表上面的一张图片。

我也在用 C 编写应用程序。

建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:15:38.190

您可以在文本单元格渲染器中使用多行字符串。例如，这是我处理过的应用程序的一个示例：[https](https://github.com/wmvanvliet/Chimara/blob/browser/player/browser.c) ://github.com/wmvanvliet/Chimara/blob/browser/player/browser.c 。

在单元格渲染器上设置自定义数据函数：

```
gtk_tree_view_column_set_cell_data_func(column, renderer, (GtkTreeCellDataFunc)text_function, NULL, NULL); 
```

这是一个自定义数据函数的示例，它很好地将作品的标题、作者和出版年份格式化为单元格渲染器的标记属性：

```
static void
text_function(GtkTreeViewColumn *column, GtkCellRenderer *cell, GtkTreeModel *model, GtkTreeIter *iter, gpointer data)
{
    char *title, *author, *rendered_string;
    unsigned year;
    gtk_tree_model_get(model, iter,
        1, &title,
        2, &author,
        3, &year,
        -1);
    rendered_string = g_strdup_printf("<big><big><b><i>%s</i></b></big>\nby %s</big> (%d)", title, author, year);
    g_object_set(cell, "markup", rendered_string, NULL);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T17:36:25.810

对于 TreeView，可以使用 隐藏列标题`gtk_tree_view_set_headers_visible(view,false)`。这似乎也删除了列分隔符，尽管我找不到有关此行为的任何文档。

# sql - 数据库设计是否规范化

> ID：11376189
> 
> 赞同：0
> 
> 时间：2012-07-07T15:20:23.727
> 
> 标签：sql, sql-server, tsql, database-design

我有以下表格

```
Groups
- Id
- Name

People
- Id
- GroupId
- EntryDate (DateTime) 
```

现在我想检索按组的最新成员条目日期排序的所有组。

```
//pseudo code

select * from groups order by (select top 1 from people order by entrydate desc) 
```

将 LatestEntryDate 字段添加到 Groups 并在添加人员时更新会更好吗？因为这将是一个常见的查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:23:08.850

```
SELECT g.Id, g.Name, MAX(p.EntryDate) AS LatestPeopleEntryDate
FROM Groups g
    INNER JOIN People p
        ON p.GroupId = g.Id
GROUP BY g.Id, g.Name
ORDER BY MAX(p.EntryDate) 
```

不，我不会在表格中添加`LatestEntryDate`字段。`Groups`这很容易计算。

正如@danihp 指出的那样，您可能希望在此处使用左连接。上述查询将要求表中存在一个值`People`。您选择使用什么取决于您的具体要求。

```
SELECT g.Id, g.Name, MAX(p.EntryDate) AS LatestPeopleEntryDate
FROM Groups g
    LEFT JOIN People p
        ON p.GroupId = g.Id
GROUP BY g.Id, g.Name
ORDER BY MAX(p.EntryDate) 
```

**更新**

要回答您关于在 Linq 中执行此操作的问题，我认为应该是这样的：

```
var result = groups.Select(g => 
    new {
            g.Id, 
            g.Name, 
            LatestPeopleEntryDate = g.People.Max(p => p.EntryDate)
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:54:02.773

这是一个带有非常小的样本数据的测试示例，它显示了三种方法。

要获得最佳查询计划：

按 (GroupID, EntryDate.) 在 People 上放置一个非唯一索引。

A. 使用原始伪代码（按顺序执行但不显示日期）或

B. 使用 top 1 子查询来获取和显示日期。

A 和 B 的查询计划相同。

使用 People 表的左连接和 max() 将导致扫描（最多在 GroupID 内）获得最大值，而不是对索引中的单行进行探测。

```
set nocount on
if object_id('Groups') is not null drop table Groups
if object_id('People') is not null drop table People
go

-- set up tables
create table Groups
(
    ID int primary key,
    Name varchar(20)
)

create table People 
(
    ID int,
    GroupID int,
    EntryDate datetime
)
-- make an index that is ordered by Group, EntryDate
create index IE_GroupDate on People(GroupID, EntryDate)

-- Sample data
insert into Groups (ID, Name)
values
    (1, 'Group1'),
    (2, 'Group2'),
    (3, 'GroupC')

insert into People (ID, GroupID, EntryDate)
values 
    (1, 1, '2012-01-01'),
    (2, 1, '2012-02-01'),
    (1, 3, '2007-12-31')

-- Queries
-- Equivalent to the original poster's intent.  Note that it doesn't actually
-- show the entry date
select *
from Groups G
order by (
    select top 1 EntryDate
    from People P
    where P.GroupID = G.ID order by EntryDate desc)

-- Same query (by query plan) but includes the EntryDate in the result set
select
    G.ID,
    G.Name,
    LatestEntryDate = Latest.EntryDate
from Groups G
outer apply (
    select top 1 EntryDate
    from People P
    where P.GroupID = G.ID
    order by EntryDate desc
) Latest
order by LatestEntryDate

-- Query using left join.  This causes a scan of the left join table to
-- compute the max.  (The optimizer isn't smart enough to turn this into 
-- a TOP 1)
select
    G.ID,
    G.Name,
    LatestEntryDate = max(P.EntryDate)
from Groups G
left join People P on P.GroupID = G.ID
group by G.ID, G.Name
order by max(P.EntryDate) 
```

# java - 双向异步 Java RPC

> ID：11376195
> 
> 赞同：3
> 
> 时间：2012-07-07T15:21:23.233
> 
> 标签：java, asynchronous, rpc, protocol-buffers

[protobuf-rpc-pro](http://code.google.com/p/protobuf-rpc-pro/)为基于协议缓冲区的 Java 提供双向异步 RPC 实现。还有其他类似的吗（不需要协议缓冲区）？[这个问题](https://stackoverflow.com/questions/7293011/asynchronous-bidirectional-rpc)类似，但只收到关于 Python 的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:19:47.717

与您链接的问题中基于 python 的答案之一类似，还有一个名为[Versile Java](http://versile.com/products/vjava/)的 Java Versile 平台实现（完全披露：我是开发人员之一）。它已获得 AGPL 许可，目前正在开发中；如果这适用于您的项目，您可能想看看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T19:16:01.907

Protobuf wiki 列出了一些 RPC 实现 - 请参阅[http://code.google.com/p/protobuf/wiki/ThirdPartyAddOns#RPC_Implementations](http://code.google.com/p/protobuf/wiki/ThirdPartyAddOns#RPC_Implementations) （以防万一您没有看到它）

# java - 基于体素的游戏中的块管理

> ID：11376201
> 
> 赞同：0
> 
> 时间：2012-07-07T15:21:54.653
> 
> 标签：java, voxel

我正在开发基于 minecraft 的 java LWJGL 游戏。我正在研究地形管理，这很困难，因为世界可以随着你的探索而扩展。如果地形存储在块对象中，并且您需要知道从渲染列表中删除哪个块、添加哪个块以及根据玩家的 xyz 位置生成哪个块，您将如何管理地形？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T09:12:17.707

我使用高分辨率医学体素数据并使用八叉树以有效的方式存储它。

您不能真正使用八叉树，因为您想要动态扩展地形（八叉树在查找时非常快，但在构建/扩展时非常慢）。

我建议你尝试使用 HashMap，如果你为 Vector3 提供了一个好的散列函数，那么对于任何数量的块（理论上 O(1)，但这只是最好的情况......）的查找时间几乎相同。

然后，您可以通过遍历映射键来删除所有看不见的映射条目。（这可以在处理所有加载/卸载的辅助线程上完成）。

希望这可以帮助，

~ 洛基

# jquery - 如何过滤 attr href 中的文章并找到用法？简单的标签列表

> ID：11376207
> 
> 赞同：0
> 
> 时间：2012-07-07T15:22:20.293
> 
> 标签：jquery, filter, href, each, attr

我有很多 div.articles 和那些文章；我有标签列表。我正在尝试隐藏没有 href = '#myFilter' 的文章 div。

我到达 href 没有问题，我的问题是到达它的 parent() 而不创建 jQuery 冲突。

[**这是要检查的 jsFiddle 示例。**](http://jsfiddle.net/nUsWT/25/)

jQuery

```
//trying to hide which don't got a href '#/news'
var news = '#/news';
$('.article a').each(function() {
    var category = $(this).attr('href');

    if ( category === news ) {//select only articles got #/news href in it
      //$(this).parent().parent().parent().show();//trying to reach article
        $(this).show();
    }else{
      //$(this).parent().parent().parent().hide();//this way hides all articles
        $(this).hide();//this works only on a elements
    }
});​ 
```

html:

```
<div class="article">
    <img src="http://content.photojo.com/content1.jpg" width="50" height="50" />
    <ul>
        <li><a href="#/news">News</a></li>
        <li><a href="#/nature">Nature</a></li>
        <li><a href="#/sport">Sport</a></li>
        <li><a href="#/hobbies">Hobbies</a></li>
    </ul>
</div>
<div class="article">
    <img src="https://encrypt.google.com/content2.jpg" width="50" height="50" />
    <ul>
        <li><a href="#/nature">Nature</a></li>
        <li><a href="#/economy">Economy</a></li>
        <li><a href="#/world">World</a></li>
        <li><a href="#/hobbies">Hobbies</a></li>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:29:26.973

**更新**：新演示： http: [//jsfiddle.net/9GErB/](http://jsfiddle.net/9GErB/) 这消除了您之前看到的闪存，还演示了如何更改选择器以使用变量。依赖于[jQuery filter 方法](http://api.jquery.com/filter/)，这确实是您的问题所需要的。

```
var news = '#/news';
var nature = '#/nature';
var sport = '#/sport';
var hobbies = '#/hobbies';
var economy = '#/economy';
var world = '#/world';

$('.article').filter(function() {
    return $(this).find('a[href="'+news+'"]').length==0;
}).hide(); 
```

这会将文章集减少为与过滤器表达式匹配的文章，然后隐藏它们。这比遍历文章然后遍历每篇文章中的链接要高效得多。

* * *

更新：工作演示[http://jsfiddle.net/WfdXE/](http://jsfiddle.net/WfdXE/)

使用 jQuery 的`.closest()`方法来获取与某个选择器匹配的 dom 树中最近的祖先。

```
$('.article').hide();
$('.article').find('a[href="#/news"]').each(function() {
    $(this).closest('.article').show();
}); 
```

[​ jQuery 属性选择](http://api.jquery.com/attribute-equals-selector/)器是`[name="value"]`.

要在此处使用字符串变量，您可以这样做：

```
var sel = "myFilter"; 
.find('a[href="'+sel+'"]') // this simply includes the text value of sel as the value 
```

在 JS 中，您`+`用于字符串连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T15:58:14.697

对于每篇文章，使用闭包来跟踪是否应该隐藏当前项目。这不会有 nbrooks 答案的闪烁。

正如这个小提琴所示：http: [//jsfiddle.net/878zQ/14/](http://jsfiddle.net/878zQ/14/)

```
var news = '#/news';
var nature = '#/nature';
var sport = '#/sport';
var hobbies = '#/hobbies';
var economy = '#/economy';
var world = '#/world';

$('.article').each(function() {

    var hide = 1;

    $(this).find('a').each(function() {

        var category = $(this).attr('href');

        if (category == news) { 
            hide = 0;
        }
    });

    if (hide == 1) $(this).hide();

}); 
```

为了解释它的作用，这里是该功能的英文描述：

```
For each page element containing a class of article.

    Set the hide flag to true

    For each a element in this page element

        Look at the href attribute and see if it matches the variable news
        If it does set the hide variable to false.

    If the hide flag is true hide this element. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T15:25:35.113

试试这个，

**[现场演示](http://jsfiddle.net/nUsWT/29/)**

```
$('.article').each(function() {
    $(this).find('a').each(function(){        
  if ( $(this).attr('href') === news ) {
    $(this).closest('.article').show();    
    return false;
  }else
      $(this).closest('.article').hide();            
  });
});​ 
```

# php - PHP函数重新排序数组

> ID：11376208
> 
> 赞同：0
> 
> 时间：2012-07-07T15:22:49.630
> 
> 标签：php, arrays

是否有一个 PHP 函数来移动数组键/值对并使其成为数组中的第一个元素。

基本上，我想转换

```
Array
(
    [a] => rose
    [b] => tulip
    [c] => dahlia
    [d] => peony
    [e] => magnolia
) 
```

到

```
Array
(
    [c] => dahlia
    [a] => rose
    [b] => tulip
    [d] => peony
    [e] => magnolia
) 
```

澄清一下，目的是选择一个特定的键/值对并将其移动为第一个索引，同时保持订单的其余部分不变。

所以在这种情况下，我正在寻找类似的东西

```
$old_array = Array
    (
        [a] => rose
        [b] => tulip
        [c] => dahlia
        [d] => peony
        [e] => magnolia
    );
$new_array = some_func($old_array, 'c'); 
```

在 $new_array 中，'c' 应该是列表中的第一个。

关于“some_func()”的代码有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:26:49.550

如果您只想将一个元素放在第一位，那么您可以这样做：

```
function some_func($array, $key) {
   $tmp = array($key => $array[$key]);
   unset($array[$key]);
   return $tmp + $array;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T15:39:36.683

这可能对您有帮助：

```
function myfun($ar,$key){
    if (array_key_exists($key,$ar)) {
        $arr_tmp = array($key => $ar[$key]);
        unset($ar[$key]);
        return $arr_tmp + $ar;        
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T15:55:38.913

```
function some_func($arr, $key) {
    $val = $arr[$key];
    unset($arr[$key]);
    return array_merge(array($key => $val), $arr);
} 
```

[**在键盘上查看**](http://codepad.org/DyudyH1g)

# windows - 通过另一个应用程序访问第三方应用程序

> ID：11376211
> 
> 赞同：0
> 
> 时间：2012-07-07T15:23:13.617
> 
> 标签：windows

我有一个需要与现有程序进行通信的程序的想法。

这是场景：

市场上有一个（或多个）用于 Windows 的 CRM 软件。我不会告诉 CRM 系统的开发人员 100% 集成我的搜索应用程序，而是让他们只在 CRM 中的适当位置添加一个简单的按钮。

单击此按钮时，我的应用程序将打开，它基本上是一个搜索引擎。此应用程序由我的开发人员编写。从搜索结果中，用户将能够选择结果并将信息“回传”到 CRM。

就像我提到的那样，这样做的目的是让我只发布和控制搜索应用程序，而不是让每个 CRM 公司每次都通过并创建相同的界面，并且让 CRM 软件公司只打开我的应用程序。

类似于 javascript 小部件在网站上的工作方式。网站本身无法更改小部件中的任何内容。

这在技术上可行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:34:32.640

是的你可以。在 Windows 操作系统中运行的任何应用程序都能够启动另一个应用程序来运行。

这里的问题是将您的搜索结果导出到 CRM 数据库中。当您说您的应用程序将附带特定的 crm 产品时，我猜您的应用程序将特定于特定的 CRM 产品，以便以该特定的 crm 产品格式发布数据。

为了扩展我的答案，我需要以下信息。

```
1\. Your targetted crm product technology. ex: CRM product1 built using .NET 4.0
2\. Your application technology. ex: C++
3\. Integration mechanism supported by CRM product. ex: Webservice call, Website csv upload etc., 
```

编辑：基于作者评论

我从您的评论中了解到，您将编写一个软件并将其出售给 CRM 产品公司，以将您的软件包含在他们的产品中。如果我错了，请纠正我。

在这种情况下，您需要定义格式和集成机制。您可以构建您的应用程序以支持不同类型的集成。例如：a) Web 服务 - REST、JSON、SOAP b) 数据库 - SQL Server、MYSQL、PostgreSQL、Oracle c) 网站上传 - CSV、制表符分隔、Excel

您甚至可以将您的格式设置为通用项目。您可以提供一个屏幕来将您的列与 CRM 产品列映射。

一旦您的应用程序支持这些机制，CRM 产品公司就可以选择最佳机制，并且需要一次设置来配置这些信息。如果将来发生变化，那么他们必须重新配置您的应用程序。

# html - 如何将 Aloha HTML5 编辑器修复到页面上的特定位置？

> ID：11376213
> 
> 赞同：6
> 
> 时间：2012-07-07T15:23:30.273
> 
> 标签：html, aloha-editor

我需要将 Aloha 编辑器固定到特定位置，而不是在整个页面上弹跳。

有没有配置选项？有一个用于配置 Aloha 的“附加”选项，但我不知道如何应用，或者即使它可以解决我的问题......

如果没有配置选项，也可以使用 hack 来覆盖位置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T18:45:09.497

[配置](http://aloha-editor.org/guides/configure_aloha.html)表明您使用“元素”设置来指定要附加到的元素的 id ：

```
behaviour: 'float', // 'float' (default), 'topalign', 'append'
element: 'my-html-element-id', // use with 'append' behaviour option: HTML DOM ID of the element the FM should get the position from 
```

此外，请使用其他选项，例如 draggable: false 和 pin: false。

如果这对您不起作用，请打开[错误](https://github.com/alohaeditor/Aloha-Editor/issues)报告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T03:21:19.230

对我的错误报告的回应：

> 此设置已添加到 dev 分支（但到目前为止还没有找到通往发布分支的方法），并且指南中的描述已添加到发布分支。

[https://github.com/alohaeditor/Aloha-Editor/issues/584#issuecomment-6870029](https://github.com/alohaeditor/Aloha-Editor/issues/584#issuecomment-6870029)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-10T22:00:02.083

```
var toolbar = $('.aloha-toolbar');
// make the toolbar extend to 100% of the div.
toolbar.css({'width': '100%', 'height': '100%', });
// ADDS THE ALOHA EDITOR TO A DIV! 
$('#alohaContainer').append(toolbar);
// Renders the toolbar to the screen             
UiPlugin.showToolbar();
// The child element must also be resized, don't know why
toolbar.children().css({'width': '100%', 'height': '100%'}); 
```

# android - 我使用什么 API/类来检查拨出电话？- 安卓

> ID：11376214
> 
> 赞同：0
> 
> 时间：2012-07-07T15:23:36.620
> 
> 标签：android, telephonymanager

我似乎找不到一个好的类/API 可以告诉我什么时候我的手机正在打电话。我知道我可以使用 TelephonyManager 检测何时接到电话，但我如何检测用户是否正在呼叫某人？

以下是我目前拥有的代码：

```
public class hiWorld extends Activity {

private int counter=0; 

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    TelephonyManager tm = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);

 if(tm.getCallState()==1) //ringing  
 {

     setContentView(R.layout.activity_hi_world);
     TextView tcounter = (TextView)findViewById(R.id.textbox1);

    tcounter.setText("calling");  

 }

 else if (tm.getCallState()==0) //idle 

 { 
     setContentView(R.layout.activity_hi_world);
     TextView tcounter = (TextView)findViewById(R.id.textbox1);

     tcounter.setText("not calling");
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:28:40.643

您需要`android.intent.action.NEW_OUTGOING_CALL`在您的应用程序中注册一个接收器以接收拨出呼叫广播：

* * *

**AndroidManifest.xml**

```
<receiver android:name=".OutgoingCallReceiver" >
        <intent-filter>
            <action android:name="android.intent.action.NEW_OUTGOING_CALL" >
            </action>
        </intent-filter>
    </receiver> 
```

* * *

**OutgoingCallReceiver.java：**

```
public class OutgoingCallReceiver extends BroadcastReceiver {

     @Override
     public void onReceive(Context context, Intent intent) {

    final String originalNumber =
    intent.getStringExtra(Intent.EXTRA_PHONE_NUMBER);
    //START YOUR SERVICE HERE FOR COUNTING MINS
    Intent intent = new Intent(context, MyService.class);
    intent.putExtra("number", originalNumber);
    context.startService(intent);
    }
  } 
```

* * *

**需要许可：**

```
<uses-permission android:name="android.permission.PROCESS_OUTGOING_CALLS"/> 
```

* * *

# iphone - 如何找出屏幕方向，纵向还是横向？

> ID：11376216
> 
> 赞同：0
> 
> 时间：2012-07-07T15:24:06.577
> 
> 标签：iphone, objective-c, ios, frame, uiscreen

我不敢相信这是不可能的。这只是每个人都必须要求的东西之一。

所以这：

```
[UIScreen currentScreen] bounds]; 
```

在我的 iPhone 上返回 320 的宽度，无论手机是纵向还是横向。所以我做了这个辅助方法：

```
+(CGRect)screenFrame {

    CGRect frame = [UIScreen mainScreen].bounds;

    if (UIDeviceOrientationIsPortrait([[UIDevice currentDevice] orientation])) {
        return frame;
    }
    else {
        CGRect newFrame = CGRectMake(frame.origin.x, frame.origin.y, frame.size.height, frame.size.width);
        return newFrame;
    }

} 
```

效果很好，除非设备平放时，显然这使它认为它是横向的，即使屏幕没有变成横向。

我该如何调整它以使其正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T15:42:00.387

最好的指导（主要是因为“平躺”方向）是使用`[[UIApplication sharedApplication] statusBarOrientation]`. 然后，这将根据应用程序如何调整主窗口的坐标变换矩阵为您提供正确的值。

# paypal - 支付流退款

> ID：11376220
> 
> 赞同：3
> 
> 时间：2012-07-07T15:24:36.357
> 
> 标签：paypal, payflowpro

有谁知道如何根据 pnref 或通过调用 paypal 返回的其他参数进行退款（使用 payflow api 时）。谢谢马切克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T15:30:54.713

如果交易尚未结算，您可以使用 Void 退款。对于较长期的交易，例如一个月前，您需要进行贷记。这是无效代码：

```
 using System;
    using PayPal.Payments.Common;
    using PayPal.Payments.Common.Utility;
    using PayPal.Payments.DataObjects;
    using PayPal.Payments.Transactions;

    namespace PayPal.Payments.Samples.CS.DataObjects.BasicTransactions
    {
/// <summary>
/// This class uses the Payflow SDK Data Objects to do a simple Void transaction.
/// The request is sent as a Data Object and the response received is also a Data     Object.
/// </summary>
public class DOVoid
{
    public DOVoid()
    {
    }

    public static void Main(string[] Args)
    {
        Console.WriteLine("------------------------------------------------------");
        Console.WriteLine("Executing Sample from File: DOVoid.cs");
        Console.WriteLine("------------------------------------------------------");

        // Create the Data Objects.
        // Create the User data object with the required user details.
        //UserInfo User = new UserInfo("<user>", "<vendor>", "<partner>", "<password>");

        UserInfo User = new UserInfo("xxx", Xxx", "paypal", "password");

        // Create the Payflow  Connection data object with the required connection details.
        // The PAYFLOW_HOST property is defined in the App config file.
        PayflowConnectionData Connection = new PayflowConnectionData();
        ///////////////////////////////////////////////////////////////////

        // Create a new Void Transaction.
        // The ORIGID is the PNREF no. for a previous transaction.
        //VoidTransaction Trans = new VoidTransaction("<ORIGINAL_PNREF>",
        //  User, Connection, PayflowUtility.RequestId);

        VoidTransaction Trans = new VoidTransaction("V35A0A3E6E0C",
            User, Connection, PayflowUtility.RequestId);

        // Submit the Transaction
        Response Resp = Trans.SubmitTransaction();

        // Display the transaction response parameters.
        if (Resp != null)
        {
            // Get the Transaction Response parameters.
            TransactionResponse TrxnResponse =  Resp.TransactionResponse;

            if (TrxnResponse != null)
            {
                Console.WriteLine("RESULT = " + TrxnResponse.Result);
                Console.WriteLine("PNREF = " + TrxnResponse.Pnref);
                Console.WriteLine("RESPMSG = " + TrxnResponse.RespMsg);
                Console.WriteLine("AUTHCODE = " + TrxnResponse.AuthCode);
                Console.WriteLine("AVSADDR = " + TrxnResponse.AVSAddr);
                Console.WriteLine("AVSZIP = " + TrxnResponse.AVSZip);
                Console.WriteLine("IAVS = " + TrxnResponse.IAVS);
            }

            // Get the Fraud Response parameters.
            FraudResponse FraudResp =  Resp.FraudResponse;

            // Display Fraud Response parameter
            if (FraudResp != null)
            {
                Console.WriteLine("PREFPSMSG = " + FraudResp.PreFpsMsg);
                Console.WriteLine("POSTFPSMSG = " + FraudResp.PostFpsMsg);
            }

            // Display the response.
            Console.WriteLine(Environment.NewLine + PayflowUtility.GetStatus(Resp));    

            // Get the Transaction Context and check for any contained SDK specific errors (optional code).
            Context TransCtx = Resp.TransactionContext;
            if (TransCtx != null && TransCtx.getErrorCount() > 0)
            {
                Console.WriteLine(Environment.NewLine + "Transaction Errors = " + TransCtx.ToString());
            }
        }
        Console.WriteLine("Press Enter to Exit ...");
        Console.ReadLine();
    }
}
    } 
```

这是信用代码：

```
 using System;
    using PayPal.Payments.Common;
    using PayPal.Payments.Common.Utility;
    using PayPal.Payments.DataObjects;
    using PayPal.Payments.Transactions;

    namespace PayPal.Payments.Samples.CS.DataObjects.BasicTransactions
   {
/// <summary>
/// This class uses the Payflow SDK Data Objects to do a simple independent Credit transaction.
/// The request is sent as a Data Object and the response received is also a Data Object.
/// </summary>
public class DOCredit
{
    public DOCredit()
    {
    }

    public static void Main(string[] Args)
    {
        Console.WriteLine("------------------------------------------------------");
        Console.WriteLine("Executing Sample from File: DOCredit.cs");
        Console.WriteLine("------------------------------------------------------");

        // Create the Data Objects.
        // Create the User data object with the required user details.
        UserInfo User = new UserInfo("xxx", "xxx", "paypal", "a12");

        // Create the Payflow  Connection data object with the required connection details.
        // The PAYFLOW_HOST property is defined in the App config file.
        PayflowConnectionData Connection = new PayflowConnectionData();

        // Create a new Invoice data object with the Amount, Billing Address etc. details.
        Invoice Inv = new Invoice();

        // Set Amount.
        Currency Amt = new Currency(new decimal(1));
        Inv.Amt = Amt;
        Inv.PoNum = "PO12345";
        Inv.InvNum = "INV12345";

        // Set the Billing Address details.
        BillTo Bill = new BillTo();
        Bill.Street = "123 Main St.";
        Bill.Zip = "12345";
        Inv.BillTo = Bill;

        // Create a new Payment Device - Credit Card data object.
        // The input parameters are Credit Card Number and Expiration Date of the Credit Card.
        CreditCard CC = new CreditCard("5105105105105100", "0112");

        // Create a new Tender - Card Tender data object.
        CardTender Card = new CardTender(CC);
        ///////////////////////////////////////////////////////////////////

        // Create a new Credit Transaction.
        // Following is an example of a independent credit type of transaction.
        CreditTransaction Trans = new CreditTransaction(User, Connection, Inv, Card,
            PayflowUtility.RequestId);

        // Submit the Transaction
        Response Resp = Trans.SubmitTransaction();

        // Display the transaction response parameters.
        if (Resp != null)
        {
            // Get the Transaction Response parameters.
            TransactionResponse TrxnResponse =  Resp.TransactionResponse;

            if (TrxnResponse != null)
            {
                Console.WriteLine("RESULT = " + TrxnResponse.Result);
                Console.WriteLine("PNREF = " + TrxnResponse.Pnref);
                Console.WriteLine("RESPMSG = " + TrxnResponse.RespMsg);
                Console.WriteLine("AUTHCODE = " + TrxnResponse.AuthCode);
                Console.WriteLine("AVSADDR = " + TrxnResponse.AVSAddr);
                Console.WriteLine("AVSZIP = " + TrxnResponse.AVSZip);
                Console.WriteLine("IAVS = " + TrxnResponse.IAVS);
                Console.WriteLine("CVV2MATCH = " + TrxnResponse.CVV2Match);
                // If value is true, then the Request ID has not been changed and the original response
                // of the original transction is returned. 
                Console.WriteLine("DUPLICATE = " + TrxnResponse.Duplicate);
            }

            // Get the Fraud Response parameters.
            FraudResponse FraudResp =  Resp.FraudResponse;
            // Display Fraud Response parameter
            if (FraudResp != null)
            {
                Console.WriteLine("PREFPSMSG = " + FraudResp.PreFpsMsg);
                Console.WriteLine("POSTFPSMSG = " + FraudResp.PostFpsMsg);
            }

            // Display the response.
            Console.WriteLine(Environment.NewLine + PayflowUtility.GetStatus(Resp));    

            // Get the Transaction Context and check for any contained SDK specific errors (optional code).
            Context TransCtx = Resp.TransactionContext;
            if (TransCtx != null && TransCtx.getErrorCount() > 0)
            {
                Console.WriteLine(Environment.NewLine + "Transaction Errors = " + TransCtx.ToString());
            }
        }
        Console.WriteLine("Press Enter to Exit ...");
        Console.ReadLine();
    }
}
} 
```

# c++ - 从函数返回对对象的静态常量引用

> ID：11376221
> 
> 赞同：3
> 
> 时间：2012-07-07T15:24:41.830
> 
> 标签：c++, oop

在 Effective C++（第 18 条：使接口易于正确使用和难以错误使用）中，我看到了类似以下的代码示例：

```
class Month
{
public:
    static Month Jan()
    {
        return Month(1);
    }

    static Month Feb()
    {
        return Month(2);
    }

    //...

    static Month Dec()
    {
        return Month(12);
    }

private:
    explicit Month(int nMonth)
        : m_nMonth(nMonth)
    {
    }

private:
    int m_nMonth;
};

Date date(Month::Mar(), Day(30), Year(1995)); 
```

更改函数以使它们返回对 Month 的静态 const 引用是否有任何缺点？

```
class Month
{
public:
    static const Month& Jan()
    {
        static Month month(1);
        return month;
    }

    static const Month& Feb()
    {
        static Month month(2);
        return month;
    }

    //...

    static const Month& Dec()
    {
        static Month month(12);
        return month;
    }

private:
    explicit Month(int nMonth)
        : m_nMonth(nMonth)
    {
    }

private:
    int m_nMonth;
}; 
```

我认为第二个版本比第一个版本更有效。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T15:29:03.177

**原因1：不是更好。**

按值返回会产生复制整个对象的成本。

通过引用返回会产生复制有效指针的成本，以及取消引用该指针的成本。

因为`Month`是 的大小`int`：

*   复制参考并不比复制快`Month`
*   每次访问该引用时都会发生取消引用。

所以一般来说，通过 const 引用返回是一种优化选择，以防止代价高昂的复制。

**原因2：`static`让事情变得更糟**

与 C 不同，C++ 承诺将在函数第一次调用时构造函数中的静态变量。

实际上，这意味着对函数的每次调用都必须以一些看不见的逻辑开始，以确定它是否是第一次调用。

另见沃恩卡托的回答

另见 ildjam 的评论

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T15:31:43.247

一些编译器不会内联包含静态局部变量的方法，而内联是这里最重要的性能优化。

# php - 制作横幅/图像/ iframe等

> ID：11376222
> 
> 赞同：0
> 
> 时间：2012-07-07T15:24:55.323
> 
> 标签：php, javascript, mysql, banner

我有一个关于 PHP MySQL 的网站。我想为用户提供他们可以放在他们的网站/论坛上的横幅/图像等。

任何人都可以使用带有链接的横幅，例如 Facebook 提供的链接。横幅上的数据将是动态的，因此我无法制作图像。

我应该如何进行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T15:38:07.353

查看 PHP [GD](http://php.net/manual/en/book.image.php)和[ImageMagick](http://php.net/manual/en/book.imagick.php)以动态生成图像。

# php - NicEdit 不会保存 HTML

> ID：11376228
> 
> 赞同：1
> 
> 时间：2012-07-07T15:25:37.117
> 
> 标签：php, nicedit

我正在尝试 NicEdit 女巫的重量超轻且易于安装。问题是当我使用 NicEdit 时，它在 textarea 中可以正常更改内容 - 但是当我保存我的内容时，帖子中没有 HTML 标签？全部都是明文...有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T03:25:16.043

您如何使用 NicEdit 进行保存？

您无法使用“var variable = $("#id").val();”获取值 因为那只会得到文本区域中的文本。

NicEdit 有一个可以使用的内置 ajax 保存功能。查看[http://wiki.nicedit.com/w/page/519/FrontPage](http://wiki.nicedit.com/w/page/519/FrontPage)并单击通过 Ajax 保存。

# ios - iOS 5 设备能否利用新的 iOS 6 委托方法？

> ID：11376230
> 
> 赞同：0
> 
> 时间：2012-07-07T15:25:47.287
> 
> 标签：ios

有一个新的`UITableView`委托方法，称为类似于`cellDidEndDisplaying`(like `willDisplayCell:`) 的东西，当单元格离开屏幕时会调用它。这是在新的预览版 SDK 中。我的问题是，如果我使用这种方法，它只能在 iOS 6 设备上工作，还是在 iOS 5 上也能工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T15:31:54.510

此信息受 Apple NDA 保护。

话虽这么说，方法不向后兼容 - 也就是说，如果您在 iOS 4 中使用了新方法，它在 iOS 3 中将不起作用。因为在您的情况下，您正在覆盖委托方法，您的应用程序不会崩溃 - 该方法根本不会被调用。如果您想自己调用以前版本的 iOS 中不存在的新方法，您需要询问该对象是否`respondsToSelector:`为新类，检查是否`NSClassFromString(@"MyClass")`为`nil`.

# css - 如何为我的 CSS 使用另一个括号/制表符策略？

> ID：11376232
> 
> 赞同：1
> 
> 时间：2012-07-07T15:26:48.383
> 
> 标签：css, sublimetext, sublimetext2

这是现在发生的事情的一个例子：

```
.class {

} 
```

所以当我输入`.class {` **SublimeText**时会自动插入`}`（这是正确的）。然后我按*Enter*并得到这个：

```
.class {
    #CURSOR_POSITION#
} 
```

但我真正想要的是（注意右括号）：

```
.class {
    #CURSOR_POSITION#
    } 
```

我什至在一些编辑器的特殊设置中看到过（好吧，只有一次）。现在我开始使用 SublimeText（这很酷！），我觉得可以以这种方式自定义它，但我不太确定如何。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T00:29:12.500

好的！做到这一点并不难，但知道如何做到这一点并不简单 =)

所以我的做法是：

1.  编写一个简单的宏（我已经编辑了`Enter`名为`Add Line in Braces.sublime-macro`which的默认宏`~Data/Packages/Default`）并用新名称保存它。我已经调用它`CSS.Add Line in Braces.sublime-macro`并放入了`~Data/Packages/User`.

    ```
    [
        {"command": "insert", "args": {"characters": "\n\n"} },
        {"command": "move_to", "args": {"to": "hardbol", "extend": false} },
        {"command": "insert", "args": {"characters": "\t"} },
        {"command": "move", "args": {"by": "lines", "forward": false} },
        {"command": "move_to", "args": {"to": "hardeol", "extend": false} },
        {"command": "reindent", "args": {"single_line": true} }
    ] 
    ```

2.  将其应用于`Enter`CSS 文件中的键。为此，我们需要转到 Preferences > Key Bindings - User （它将打开`~Data/Packages/User/Default (YOUR_OPERATING_SYSTEM).sublime-keymap`）并粘贴以下代码：

    ```
    [
        { "keys": ["enter"], "command": "run_macro_file", "args": {"file": "Packages/User/CSS.Add Line in Braces.sublime-macro"}, "context":
            [
                { "key": "selector", "operator": "equal", "operand": "source.css" },
                { "key": "setting.auto_indent", "operator": "equal", "operand": true },
                { "key": "selection_empty", "operator": "equal", "operand": true, "match_all": true },
                { "key": "preceding_text", "operator": "regex_contains", "operand": "\\{$", "match_all": true },
                { "key": "following_text", "operator": "regex_contains", "operand": "^\\}", "match_all": true }
            ]
        }
    ] 
    ```

    它是从默认的键绑定文件中复制粘贴的，并添加了一个上下文： `{ "key": "selector", "operator": "equal", "operand": "source.css" }` 它告诉 Sublime 仅将其应用于 CSS ext。

3.  利润！

# ios - 如何在 Titaninum 中更改 App Id

> ID：11376237
> 
> 赞同：1
> 
> 时间：2012-07-07T15:27:28.053
> 
> 标签：ios, titanium

当我在 Titanium 中创建我的个人资料时，我创建了 App Id。

在摘要标识符中的 X 代码中，我可以更改名称。

但是在 Titanium 中，我在哪里输入或更改我的应用程序 App Id？

com.companyName.product

我需要在我的项目中设置钛合金。

@提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T22:13:32.360

您的钛项目根目录中的 tiapp.xml 拥有所有这些。当您进行干净构建时，它将在 Xcode 中重新生成 info.plist。

# python - Python：仅使用原始字符串发送 POST 请求

> ID：11376239
> 
> 赞同：3
> 
> 时间：2012-07-07T15:27:46.613
> 
> 标签：python, post, custom-action

我想仅使用原始字符串发送 POST 请求。

我正在写一个解析器。我已经加载了页面，并在 firebug 中看到了一个包含许多标题和正文的复杂请求：

```
__EVENTTARGET=&__EVENTARGUMENT=&__VIEW.... (11Kb or unreadable text) 
```

我怎样才能再次手动发送这个确切的请求（标​​题+帖子正文）（将其作为一个巨大的字符串传递）？

喜欢：

```
func("%(headers) \n \n %(body)" % ... ) 
```

我希望它由我的脚本发送（并处理响应），并且不想手动制作参数和标题字典。

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T16:31:35.703

另一个答案太大而令人困惑，并且显示的内容超出了您的要求。我觉得我应该为未来的读者提供一个更简洁的答案：

```
import urllib2
import urllib
import urlparse

# this was the header and data strings you already had
headers = 'baz=3&foo=1&bar=2'
data = 'baz=3&foo=1&bar=2'

header_dict = dict(urlparse.parse_qsl(headers))

r = urllib2.Request('http://www.foo.com', data, headers)
resp = urllib2.urlopen(r) 
```

您至少需要将标题解析回字典，但它的工作量很小。然后把它一直传递给一个新的请求。

*注意：这个简洁的示例假设您的标题和数据主体都是`application/x-www-form-urlencoded`格式的。如果标头采用原始字符串格式，例如`Key: Value`，请参阅其他答案以获取有关首先解析的更多详细信息。

最终，您不能只是复制粘贴原始文本并运行新请求。它必须以适当的格式分为标题和数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T15:59:05.120

```
import urllib
import urllib2

# DATA:

# option #1 - using a dictionary
values = {'name': 'Michael Foord', 'location': 'Northampton', 'language': 'Python' }
data = urllib.urlencode(values)

# option #2 - directly as a string
data = 'name=Michael+Foord&language=Python&location=Northampton'

# HEADERS:

# option #1 - convert a bulk of headers to a dictionary (really, don't do this)    

headers = '''
Host: www.http.header.free.fr
Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg,
Accept-Language: Fr
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 4.0)
Connection: Keep-Alive
'''

headers = dict([[field.strip() for field in pair.split(':', 1)] for pair in headers.strip().split('\n')])

# option #2 - just use a dictionary

headers = {'Accept': 'image/gif, image/x-xbitmap, image/jpeg, image/pjpeg,',
           'Accept-Encoding': 'gzip, deflate',
           'Accept-Language': 'Fr',
           'Connection': 'Keep-Alive',
           'Host': 'www.http.header.free.fr',
           'User-Agent': 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 4.0)'}

# send the request and receive the response

req = urllib2.Request('http://www.someserver.com/cgi-bin/register.cgi', data, headers)
response = urllib2.urlopen(req)
the_page = response.read() 
```

# spring - Spring Security with Hibernate，存储加密密码

> ID：11376244
> 
> 赞同：2
> 
> 时间：2012-07-07T15:28:29.223
> 
> 标签：spring, hibernate, spring-security

我确定以前有人问过这个问题，但我找不到任何可以回答这个问题的东西。

使用 Spring-security，我正在使用密码编码器。

```
<beans:bean class="org.springframework.security.authentication.encoding.ShaPasswordEncoder" id="passwordEncoder"/>

    <authentication-manager>
         <authentication-provider user-service-ref='CustomUserDetailsService'>
         <password-encoder ref="passwordEncoder"/>
         </authentication-provider>
    </authentication-manager> 
```

在我的 UserDAOImpl 添加用户时，我有以下代码......

```
@Override
public void addUser(final User user) {
    user.setPassword(passwordEncoder.encodePassword(user.getPassword(), "salt"));
    sessionFactory.getCurrentSession().save(user);
} 
```

我的密码被正确编码，但总是被读取为无效，这是有道理的，因为我不知道 Spring 如何知道我的盐是“盐”——你如何告诉 Spring Security 和 Hibernate 使用相同的盐? 我是否遗漏了有关 Spring Security 如何管理密码的信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T15:42:32.287

推荐的方法是使用标准密码编码器，它将使用随机盐，并将此盐与消化密码一起存储。这样，您不需要提供任何盐。如果您想提供自己的盐，那么您需要将 SaltSource 注入 DAO 身份验证器，如[文档所述](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#d0e3021)（当然，在对密码进行编码以创建新用户时使用相同的源）：

> crypto 包中的 StandardPasswordEncoder 使用随机的 8 字节 salt，存储在与密码相同的字段中。
> 
> 笔记
> 
> 处理 salt 的传统方法是将 SaltSource 注入 DaoAuthenticationProvider，这将为特定用户获取 salt 值并将其传递给 PasswordEncoder。使用随机盐并将其与密码数据字段相结合意味着您不必担心盐处理的细节（例如值的存储位置），因为它都是在内部完成的。所以我们强烈建议您使用这种方法，除非您已经有一个单独存储盐的系统。

在您的情况下， SaltSource 将始终返回“盐”。请注意，这种加盐方式是不安全的，因为所有共享共同密码的用户（是的，确实如此）最终都会使用相同的散列密码。这意味着攻击者在找到一个用户的密码时，也会找到共享相同密码的所有用户的密码。

# android - Android Manifest，如何接收共享 URL、文件和联系人？

> ID：11376245
> 
> 赞同：3
> 
> 时间：2012-07-07T15:28:30.627
> 
> 标签：android, android-intent, manifest, share

我看到这是一个关于 ACTION_SEND 和使用哪些过滤器的反复出现的问题，但我可以保证我搜索过这个。

应用程序开发进展顺利，直到现在我一直在使用图像和视频进行测试：

```
 <intent-filter>
            <action android:name="android.intent.action.SEND" />
            <data android:mimeType="image/*" />
            <data android:mimeType="video/*" />
        </intent-filter> 
```

但现在我想扩展应用程序以接受任何文件（无论它是什么类型）、联系人（在联系人应用程序上有一个共享联系人的选项）和 URL（通常从浏览器发送）。

对于我之前看到人们使用 Text 的 URL，`<data android:mimeType="text/plain" />`但在我看来，这对于非常特定的字符序列来说是一种非常通用的方法。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T21:51:00.653

我发现了如何做到这一点：

从这个线程：[https ://stackoverflow.com/a/10161863/906362](https://stackoverflow.com/a/10161863/906362)

```
<intent-filter>
    <action android:name="android.intent.action.SEND" />
    <category android:name="android.intent.category.DEFAULT"/>
    <data android:mimeType="application/*" />
    <data android:mimeType="audio/*" />
    <data android:mimeType="image/*" />
    <data android:mimeType="message/*" />
    <data android:mimeType="multipart/*" />
    <data android:mimeType="text/*" />
    <data android:mimeType="video/*" />
</intent-filter> 
```

为什么它需要 category.DEFAULT 我不知道，但没有它，它只适用于画廊。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-04T22:51:22.983

要获得任何 mimetype：

```
<data android:mimeType="*/*" /> 
```

# java - 使用 JPA、Maven 和 Tomcat，但出现 java.lang.NoClassDefFoundError: javax/persistence/Persistence

> ID：11376247
> 
> 赞同：3
> 
> 时间：2012-07-07T15:28:36.910
> 
> 标签：java, tomcat, maven, jpa

但看看其他情况，我试图将这些依赖项放到 Maven 中：

```
<dependencies>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>3.8.1</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-api</artifactId>
        <version>6.0</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.21</version>
    </dependency>
</dependencies> 
```

我正在尝试直接从 Eclipse 运行，但我不断收到错误消息：java.lang.NoClassDefFoundError: javax/persistence/Persistence

我不明白，因为它应该由 javaee-api 依赖项提供。

问候， 爱德华多

更新

现在我尝试在我的 POM 中使用这些：

```
<dependencies>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>3.8.1</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>4.1.4.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate.javax.persistence</groupId>
        <artifactId>hibernate-jpa-2.0-api</artifactId>
        <version>1.0.1.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>4.1.4.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate.java-persistence</groupId>
        <artifactId>jpa-api</artifactId>
        <version>2.0.Beta-20090815</version>
    </dependency>
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.21</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tomcat</groupId>
        <artifactId>tomcat-servlet-api</artifactId>
        <version>7.0.26</version>
        <scope>provided</scope>
    </dependency>
</dependencies> 
```

一旦 Tomcat 不会为我提供任何功能。但是我仍然遇到同样的错误，这可能与依赖范围有关吗？另外，我的进口是这样的：

```
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.Persistence; 
```

如何告诉我的容器使用 Hibernate 实现？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T02:52:22.760

终于能够解决这个问题。这是 Hibernate 4 的正确 POM。从 3.5 开始，您不应该使用 hibernate 注释作为依赖项

```
<dependencies>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>3.8.1</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>4.1.4.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate.javax.persistence</groupId>
        <artifactId>hibernate-jpa-2.0-api</artifactId>
        <version>1.0.1.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>4.1.4.Final</version>
    </dependency>
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.21</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-jdk14</artifactId>
        <version>1.5.8</version>
    </dependency>
</dependencies> 
```

# java - 在添加到另一个 JPanel 的 JPanel 中不显示图形

> ID：11376252
> 
> 赞同：2
> 
> 时间：2012-07-07T15:29:03.047
> 
> 标签：java, swing, jpanel, paintcomponent

将`JPanel`具有图形的 a 添加到 a`JFrame`时，它工作正常。但是当我尝试添加一个`JPanel` 我已经添加了另一个`JPanel`图形时，它没有显示在`JFrame`. 请看下面的代码

```
package sample;

import java.awt.Graphics;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Main extends JFrame{
    public static void main(String[] args) {
        new Main();
    }

    public Main(){
        setTitle("Sample");
        setVisible(true);
        setSize(500,500);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        add(new SamplePanel2());
    }
}

class SamplePanel2 extends JPanel{
    public SamplePanel2(){
        add(new JButton("Hi"));
        add(new SamplePanel());
    }
}
class SamplePanel extends JPanel {
    public SamplePanel(){
    }

    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.drawString("HHHHHHHHHHHH", 100, 100);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T15:38:10.880

请务必注意类的构造函数`Main`，使其成为遵循本例所示顺序的习惯。首先将组件添加到`JFrame`然后只进行调用 `pack(), setSize() or setVisible(...)`，而不是在此之前。

永远让它成为你的习惯，无论何时你重写`paintcomponent()`方法，也重写`getPreferredSize()`方法。

并且总是像`pack()/setVisible(...)`在 EDT - Event Dispatch Thread 中那样进行调用。有关该主题的更多详细信息，请阅读[Swing 中的并发。](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)

```
import java.awt.Dimension;
import java.awt.Graphics;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Main extends JFrame{
    public static void main(String[] args) {
        new Main();
    }

    public Main(){
        setTitle("Sample");        
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setContentPane(new SamplePanel2());
        pack();        
        setVisible(true);
    }
}

class SamplePanel2 extends JPanel{
    public SamplePanel2(){
        add(new JButton("Hi"));
        add(new SamplePanel());
    }
}
class SamplePanel extends JPanel {
    public SamplePanel(){
    }

    @Override
    public Dimension getPreferredSize()
    {
        return (new Dimension(300, 300));
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.drawString("HHHHHHHHHHHH", 100, 100);
    }
} 
```

# html - iframe 不显示动态生成的 html 文件

> ID：11376254
> 
> 赞同：1
> 
> 时间：2012-07-07T15:29:22.297
> 
> 标签：html, iframe

我正在使用 HTMLTEXTWRITER 动态创建一个 HTML 文件，我可以在浏览器中查看它，但是当我尝试在 iframe 中查看这个 html 时，什么都没有显示！动态生成的 html 有什么问题？iframe 也不在 Firefox 中显示一些 HTML，这是我创建 html 的方式：

```
static string GetDivElements()
    {
        // Initialize StringWriter instance.
        StringWriter stringWriter = new StringWriter();

        // Put HtmlTextWriter in using block because it needs to call Dispose.
        using (HtmlTextWriter writer = new HtmlTextWriter(stringWriter))
        {
            // Loop over some strings.
            foreach (var word in _words)
            {
                // Some strings for the attributes.
                string classValue = "ClassName";
                string urlValue = "http://www.dotnetperls.com/";
                string imageValue = "image.jpg";

                // The important part:
                writer.AddAttribute(HtmlTextWriterAttribute.Class, classValue);
                writer.RenderBeginTag(HtmlTextWriterTag.Div); // Begin #1
...my html
                writer.RenderBeginTag(HtmlTextWriterTag.Img); // Begin #3
                writer.RenderEndTag(); // End #3

                writer.Write(word);

                writer.RenderEndTag(); // End #2
                writer.RenderEndTag(); // End #1
            }
        }
        // Return the result.

        string pre = "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">";
        pre += "<html xmlns=\"http://www.w3.org/1999/xhtml\"><head>";
        pre += "<meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\"><title></title></head><body>";

        return stringWriter.ToString();// +"</body></html>";
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        using (StreamWriter outfile =
        new StreamWriter(@"d:\myFile.htm"))
        {
            outfile.Write(GetDivElements());
        }
    } 
```

# jquery - jQuery 将每个 X 元素包装在 div 中

> ID：11376256
> 
> 赞同：7
> 
> 时间：2012-07-07T15:29:37.240
> 
> 标签：jquery, grouping

我有一个 H3 标签 preseded 的元素（div）列表

```
<h3></h3>
<div class="item"></div>
<div class="item"></div>
<div class="item"></div>
<div class="item"></div>
<h3></h3>
<div class="item"></div>
<div class="item"></div> 
```

ETC...

使用 jQuery，我想对每 3 个 div（或更少）进行分组，然后是每个 h3，如下所示：

```
<h3></h3>
<div class=row>
    <div class="item"></div>
    <div class="item"></div>
    <div class="item"></div>
</div>
<div class=row>
    <div class="item"></div>
</div>
<h3></h3>
<div class=row>
    <div class="item"></div>
    <div class="item"></div>
</div> 
```

我尝试了这里提出的解决方案：[使用 Javascript 为每 5 个元素插入 <div> ，](https://stackoverflow.com/questions/7248423/insert-div-for-every-5-elements-using-javascript) 但它显然将所有 div 分组。我也尝试使用 ~ 选择器但没有成功：

```
var a = $('h3 ~ div.item');

for( var i = 0; i < a.length; i+=3 ) {
    a.slice(i, i+3).wrapAll('<div class="row"></div>');
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T17:49:21.293

我已经完成了这个并且它正在工作

```
$(function(){
    var h3=$('h3');
    h3.each(function(){
        var divs=$(this).nextUntil('h3');
        var row_wreapper=$('<div></div>');
        while(divs.length)
        {
            var grp=divs.splice(0, 3);
            var row=$('<div class="row"></div>');
            $(grp).each(function(){
                row.append($(this));
            });
            row_wreapper.append(row);
        }
        $(this).after(row_wreapper.html());
    });
});​ 
```

[**DEMO**](http://jsfiddle.net/a8pGT/3/)`item`或对 DEMO类进行一些额外检查[**。**](http://jsfiddle.net/a8pGT/5/)

或者

```
$(function(){
    var h3=$('h3');
    h3.each(function(){
    var divs=$(this).nextUntil('h3');
    var row_wreapper=$('<div></div>');
    while(divs.length)
    {
        var grp=divs.splice(0, 3);
        var row=$(grp).wrapAll('<div class="row"></div>');
        if(row.children().length) row_wreapper.append(row);
    }
    $(this).after(row_wreapper.html());
    });
});​ 
```

[**演示。**](http://jsfiddle.net/a8pGT/6/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T16:34:30.883

[这里有一个插件，当我想包装时我会使用它，只是因为它很干净并且可以让我做一些令人惊奇的事情](http://phrappe.com/javascript/wrap-any-amount-of-elements-with-jquery/)。|| [您可以在此处以纯文本形式找到包装器的来源](http://phrappe.com/demos/nwrapper/jquery.nwrapper.js)

唯一的问题是 - 由于您的 DOM，我们必须对所有项目进行一些结构化并将它们分组，然后才能遍历这些列表。

我们将首先通过 ->

```
$.each($('h3'), function(i,v){
  $(v).nextUntil($('h3')).wrapAll('<div class="row-container"></div>');    
}); 
```

`.nextUntil()`是 jQuery 1.6+，所以希望那里没有限制。

现在，使用上面我链接的插件，我们可以引用它并让它在每个新的`row-container`.

```
$.each($('.row-container'), function(i,v){
  $(v).nwrapper({
    wrapEvery      : 3,
    defaultClasses : false,
    extraClasses: ['row']     
  });
}); 
```

[证据就在布丁里，所以这里是 jsFiddle](http://jsfiddle.net/QzKpn/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T16:38:09.390

试试这个。一个简单的解决方案..

```
var h3s = $('h3');   // caching all h3 tags

// looping over h3 tags
$.each(h3s, function(i, hs) {

    // selecting div.item between two h3
    // for example
    // div.item between this (current h3) and h3:eq(1) (next h3) and so on

    var divs = $(this).nextUntil($('h3').eq(i+1), 'div.item');

    // looping with divs
    $.each(divs, function(i, el) {

        // checking for div.item
        // to group for wrapping

        if(i % 3 == 0) {
            divs.slice(i , i+3).wrapAll('<div class="row">');
        }
    });
}); 
```

**[工作样本](http://jsfiddle.net/QStkd/586/)**

***相关参考：***

*   [`.nextUntil()`](http://api.jquery.com/nextUntil)

*   [`wrapAll()`](http://api.jquery.com/wrapAll)

*   [`.slice()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/slice)

*   [`.each()`](http://api.jquery.com/each)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T18:22:18.850

你可以这样做：

```
(function(c, h, s, $g, n) {
    $(c).find([h,s].join()).each(function() {
        if ($(this).filter(h).length || $g.find(s).length == n) {
            $g = $g.clone().empty().insertAfter(this);
        }
        $g.append($(this).not(h));
    });
})(document, 'h3', '.item', $('<div class="itemGroup"/>'), 3); 
```

如果您的元素包含在特定容器中，则传递容器的选择器（例如“#myContainer”）而不是`document`.

**[演示](http://jsfiddle.net/BcmZ5/2/)**

# java - Android ThreadPoolExecutor 和 join()

> ID：11376257
> 
> 赞同：2
> 
> 时间：2012-07-07T15:29:46.070
> 
> 标签：java, android, multithreading, threadpoolexecutor

我有一个线程池执行器，它有几个同时运行的线程。我想在所有线程完成后执行一些代码。我怎样才能做到这一点？

```
 for(String x : mList){
        mExecutor.execute(new Runnable(){

            @Override
            public void run() {
                //Do Stuff
                            }

        });

       //after all threads finish
       doOtherStuff(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:45:53.083

你必须使用一个`CountDownLatch`. `CountDownLatch`用执行器的线程数初始化。在末尾`Runnable`添加`CountDownLatch.countDown();`

```
 CountDownLatch countDownL = new CountDownLatch(N);
for(String x : mList){
        mExecutor.execute(new Runnable(){

            @Override
            public void run() {
                //Do Stuff
                countDownL.countDown();
            }

        });
  }

   countDownL.await();
       //after all threads finish
       doOtherStuff(); 
```

请注意，调用`await()`会导致调用者的阻塞，直到`countDonwL`达到 0 的值。当然，如果您在 UI 线程上调用 await()，它会阻塞 UI。

编辑我在检查语法之前把它写下来。所以可能会出现一些拼写错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T15:53:31.100

这应该可以实现您所需要的：

```
for(String x : mList) {
   mExecutor.execute(new Runnable() {    
        @Override
        public void run() {
            //Do Stuff
        }    
   });
 }

 mExecutor.shutdown();
 mExecutor.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS);

 //after all threads finish
 doOtherStuff(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:21:42.643

使用**java.util.concurrency 包中提供的 CountDownLatch**将帮助您实现您所需要的。

```
CountDownLatch latch = new CountDownLatch(3); 
```

**上面这行将创建一个计数为 3 的 CountDownlatch。**

```
latch.countDown(); 
```

**上面的这行代码每次执行时都会将锁存器减 1。**

```
latch.await(); 
```

**一旦闩锁的倒计时达到0，上面的这行代码就会执行它下面的代码。在此之后，您可以放置​​您需要做的工作......**

# ios - CGRect和触摸

> ID：11376258
> 
> 赞同：0
> 
> 时间：2012-07-07T15:29:56.983
> 
> 标签：ios, cocos2d-iphone, touch, cgrect

在这个 cocos2d 应用程序中，当我按下 ccsprite 时，nslog 没有触发。有人可以帮助我吗？

```
-(BOOL)ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event{
NSMutableArray *targetsToDelete = [[NSMutableArray alloc] init];
for (CCSprite *target in _targets) {
    CGRect targetRect = CGRectMake(target.position.x - (target.contentSize.width/2), 
                                   target.position.y - (target.contentSize.height/2), 
                                   27, 
                                   40);

CGPoint touchLocation = [self convertTouchToNodeSpace:touch];
if (CGRectContainsPoint(targetRect, touchLocation)) {            
    NSLog(@"Moo cheese!");
    }
}
return YES;   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:01:20.320

首先确保将触摸精灵注册到`onEnter`方法中，例如：

```
- (void)onEnter
{
    [[CCTouchDispatcher sharedDispatcher] addTargetedDelegate:self priority:defaultTouchPriority_ swallowsTouches:YES];
    [super onEnter];
} 
```

这将使您的精灵可触摸，并在用户按下它时将事件触发给精灵。然后重构您的代码以使其更具可读性并测试类似的内容：

```
- (BOOL)ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event
{
    CGPoint touchLocation = [self convertTouchToNodeSpace:touch];

    NSArray *targetsToDelete = [self touchedSpritesAtLocation:touchLocation];

    // Put your code here
    // ...

    return YES;
}

- (NSArray *)touchedSpritesAtLocation:(CGPoint)location
 {
    NSMutableArray *touchedSprites = [[NSMutableArray alloc] init];

    for (CCSprite *target in _targets)
        if (CGRectContainsPoint(target.boundingBox, location))
            [touchedSprites addObject:target];

    return [touchedSprites autorelease];
} 
```

它应该返回已触及的目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T17:24:26.320

在层初始化方法中添加这个

```
self.isTouchEnabled = true; 
```

使用此代码进行触摸检测

```
- (void)ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *myTouch = [touches anyObject];
    CGPoint location = [myTouch locationInView:[myTouch view]];
    location = [[CCDirector sharedDirector] convertToGL:location];

    CGRect rect = [self getSpriteRect:yourSprite];

    if (CGRectContainsPoint(rect, location))
    {
        NSLog(@"Sprite touched\n");
    }

} 
```

要获得精灵矩形：

```
-(CGRect)getSpriteRect:(CCNode *)inSprite
{
    CGRect sprRect = CGRectMake(
                                inSprite.position.x - inSprite.contentSize.width*inSprite.anchorPoint.x,
                                inSprite.position.y - inSprite.contentSize.height*inSprite.anchorPoint.y,
                                inSprite.contentSize.width, 
                                inSprite.contentSize.height
                                ); 

    return sprRect;
} 
```

# objective-c - 如何使用 iOS 5 SDK ping 服务器端口

> ID：11376259
> 
> 赞同：0
> 
> 时间：2012-07-07T15:29:57.693
> 
> 标签：objective-c, ios5, xcode4.2, ping

基本上，我想检查游戏服务器是否在线/离线，但服务器是通过端口托管的，我将如何 ping 它来检查这一点。出于测试目的，我要 ping 的服务器是`fr7.mooshroom.net:25667`，但最终我将从在线 plist 导入服务器 IP 和端口，以便将 IP 地址和端口分开

如果你能给我一个关于如何做到这一点的分步指南，那将不胜感激。

我正在使用`Reachability`by，`tonymillion`因为 Apple 不适用于 iOS 5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T05:42:02.360

首先，这取决于您是在谈论 TCP 还是 UDP。

如果是 TCP，那么答案可能很简单：尝试在该端口打开与服务器的 TCP 连接。如果连接打开，则断开连接并报告成功。否则，失败。这是简单化的观点。如果服务器前面有负载平衡器或防火墙，则 TCP 连接可能会打开但后端服务器已关闭。

UDP会更难。除非它向您发送某种响应，否则无法知道您何时发送 UDP 数据服务器获得了数据。如果 UDP 服务器已关闭并且您向端口发送了一条消息，您的计算机*可能会*收到一条 ICMP 错误消息。那肯定会让您知道服务器已关闭。但是防火墙可能会阻止此消息返回您的设备，因此这可能不可靠。

否则，您需要向服务器发送格式正确的消息以获得某种响应。这取决于协议，但最可靠。

传统的“ping”消息是 ICMP 回显查询和响应消息。因此，没有与 ICMP 关联的“端口”。

# python - ImportError：无法导入名称 asn1

> ID：11376265
> 
> 赞同：0
> 
> 时间：2012-07-07T15:30:31.530
> 
> 标签：python, python-2.4

我已经使用easy_install在centos上安装了pysnmp，但是当我导入asn1时它不起作用

```
[root@server ~]# python
Python 2.4.3 (#1, Jun 18 2012, 08:55:23)
[GCC 4.1.2 20080704 (Red Hat 4.1.2-52)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from pysnmp import asn1
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
ImportError: cannot import name asn1
>>> import sys
>>> print sys.path
['', '/usr/lib/python2.4/site-packages', '/usr/lib/python2.4/site-packages/pysnmp-4.2.2-py2.4.egg', '/usr/lib/python2.4/site-packages/pycrypto-2.6-py2.4-linux-x86_64.egg', '/usr/lib/python2.4/site-packages/pyasn1-0.1.3-py2.4.egg', '/usr/lib64/python24.zip', '/usr/lib64/python2.4', '/usr/lib64/python2.4/plat-linux2', '/usr/lib64/python2.4/lib-tk', '/usr/lib64/python2.4/lib-dynload', '/usr/lib64/python2.4/site-packages', '/usr/lib64/python2.4/site-packages/gtk-2.0', '/usr/lib/python2.4/site-packages']
>>> 
```

我正在尝试运行此示例[http://pysnmp.sourceforge.net/examples/2.x/snmpagent.html](http://pysnmp.sourceforge.net/examples/2.x/snmpagent.html)

我的目标是读取其他设备发送的 snmp 陷阱并在服务器上处理它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:23:36.373

您正在尝试使用 4.x 版本的软件包运行 2.x 示例。改为查找 4.x 示例。

# mysql - 在 CakePHP 中确定要在 MySQL 中索引哪些列

> ID：11376267
> 
> 赞同：6
> 
> 时间：2012-07-07T15:31:07.593
> 
> 标签：mysql, database, cakephp, join, indexing

我有一个网络应用程序，每个页面都有很多查询。随着更多数据添加到数据库中，我们注意到页面加载时间越来越长。

在检查 PhpMyAdmin -> Status -> Joins 时，我们注意到了这一点（红色数字）：

Select_full_join 348.6 k 不使用索引的连接数。如果此值不为 0，则应仔细检查表的索引。

1.  如何确定导致问题的连接？所有的连接都应该受到同样的指责吗？
2.  我如何确定应该索引哪些列，以使性能正确？

我们使用的是 CakePHP + MySQL，查询都是自动生成的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-07T17:10:55.927

我一直使用的经验法则是，如果我使用 join，我要加入的字段需要被索引。

例如，如果您有如下查询：

```
SELECT t1.name, t2.salary
    FROM employee AS t1 
    INNER JOIN info AS t2 ON t1.name = t2.name; 
```

t1.name 和 t2.name 都应该被索引。

以下是一些很好的读物：

[优化 MySQL：JOIN 顺序的重要性](http://www.webdevstuff.com/119/optimizing-mysql-importance-of-join-order.html)

[如何通过索引优化 MySQL JOIN 查询](http://www.cryptkcoding.com/2012/04/how-to-optimize-mysql-join-queries-through-indexing/)

总的来说，这个人的网站也有一些很好的信息。

[MySQL 优化器团队](http://mysqloptimizerteam.blogspot.com/)

编辑：这总是有帮助的。

如果您有权访问服务器设置，请查看：

[MySQL 慢速服务器日志](http://dev.mysql.com/doc/refman/5.1/en/slow-query-log.html)

Once you have a log of slow queries, you can use explain on them to see what needs indexing.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T15:43:31.397

如果您不知道哪些查询运行效率低下，您有几个选择。

你可以试试这个：

`SHOW FULL PROCESSLIST`尝试在您的网站处于活动状态时从 phpmyadmin发出命令。希望它会向您展示一堆运行缓慢的查询。`FULL`进程列表应该为您提供整个查询。然后，您可以使用该`EXPLAIN`命令来确定它在做什么。

你也应该试试这个：

考虑您的应用程序代表您的用户所做的工作。考虑一下您的哪些查询必须通过大量数据才能为用户提供价值。考虑一下随着您的应用程序越来越多地使用哪些表正在增长。

然后，找到能够提供该价值并访问您不断增长的表的查询。同样，使用`EXPLAIN`命令查看 MySQL 如何处理它们，并根据需要添加索引。

我怀疑应该添加哪些索引会非常明显。添加明显的，然后让您的系统稳定几个工作日，然后重新测量。

请注意，这是将新应用程序投入生产的正常部分。

# objective-c - 在 Xcode 中循环播放音频

> ID：11376269
> 
> 赞同：4
> 
> 时间：2012-07-07T15:31:15.743
> 
> 标签：objective-c, ios, xcode, avaudioplayer

我在我的应用程序中播放我想循环播放的声音。我对此的研究并没有完全解决我的问题。

我的代码.m

```
CFBundleRef mainBundle = CFBundleGetMainBundle();
CFURLRef soundFileURLRef;
soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (CFStringRef) @"ar4", CFSTR 
                                          ("wav"), NULL);

UInt32 soundID;
AudioServicesCreateSystemSoundID (soundFileURLRef, &soundID);
AudioServicesPlaySystemSound (soundID); 
```

我想我需要把这样的东西放进去

```
numberOfLoops = -1; 
```

但是不确定如何在我的代码中实现，因为我收到 numberOfLoops 的未声明错误。一些建议将不胜感激

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-07T15:35:41.263

这样的事情应该可以解决您的问题：

```
 NSString* resourcePath = [[NSBundle mainBundle] resourcePath];
    resourcePath = [resourcePath stringByAppendingString:@"/YOURMUSICNAME.mp3"];
    NSLog(@"Path to play: %@", resourcePath);
    NSError* err;

    //Initialize our player pointing to the path to our resource
    player = [[AVAudioPlayer alloc] initWithContentsOfURL:
                 [NSURL fileURLWithPath:resourcePath] error:&err];

    if( err ){
        //bail!
        NSLog(@"Failed with reason: %@", [err localizedDescription]);
    }
    else{
        //set our delegate and begin playback
        player.delegate = self;
        [player play];
        player.numberOfLoops = -1;
        player.currentTime = 0;
        player.volume = 1.0;
    } 
```

然后，如果你想停止它：

```
[player stop]; 
```

或暂停：

```
[player pause]; 
```

并将其导入您的头文件中：

```
#import <AVFoundation/AVFoundation.h>. 
```

您当然应该在标题中声明它，然后合成它。

//.h 并添加**粗体**部分：

@interface ViewController : UIViewController < **AVAudioPlayerDelegate** > {

```
AVAudioPlayer *player;
}
@property (nonatomic, retain) AVAudioPlayer *player; 
```

//.m

```
@synthesize player; 
```

# delegates - 将侦听器委托给 XTemplate (ExtJS) 中的 ID

> ID：11376270
> 
> 赞同：2
> 
> 时间：2012-07-07T15:31:24.097
> 
> 标签：delegates, extjs, listener

我正在使用 Listeners + XTemplate。

我们的目标是将一个“itemtap”监听器委托给XTemplate 中的一个ID（即div id="xplay"）。

收到错误：

```
Error in event handler for 'undefined': INDEX_SIZE_ERR: DOM Exception 1 undefined event_bindings:207
chrome.Event.dispatch event_bindings:207
chromeHidden.Port.dispatchOnMessage miscellaneous_bindings:250 
```

这是我们的 XTemplate：

```
var itemTpl = new Ext.XTemplate(
    '<tpl for=".">',
        '<img src="http://www.myShortenedUrl.com/{taskImgPath}" />',
        '<img src="http://www.myShortenedUrl.com/{timeImgPath}" />',
        '<div id="xplay">',
            '<img src="http://www.starrbc.org/play_button.jpg" />',
        '</div>',
    '</tpl>'
); 
```

这是我们的 xtype: 列表，其中绑定了 XTemplate ( *itemTpl* )，以及一个委托给“xplay”的 itemtap 侦听器：

```
xtype: 'panel',
items: [{
    xtype: 'list',
    id: 'bookmarkView',
    store: bookmarkStore,
    itemTpl: itemTpl, // setting the XTemplate here
    listeners: {
        itemtap: function(bookmarkView, index, item, e){
            console.log("Hello I am Here!");
        },
        element: 'innerElement',
        delegate: 'xplay'
    } 
```

我们删除了`element: 'innerElement'`并且当我们单击 XTemplate 的任何部分时`delegate: 'xplay'`它会触发该`itemtap`功能，但这不是我们的目标。我们只希望我们的 PLAY 按钮来触发这个监听器。

## 更新

感谢埃文的快速回复。

这是我对您的输入进行的尝试-如果我做错了，请告诉我。

将 div id 更改为 div 类。

```
var itemTpl = new Ext.XTemplate(
    '<tpl for=".">',
        '<img src="http://www.myShortenedUrl.com/{taskImgPath}" />',
        '<div class="xplay">',
            '<img src="http://src.sencha.io/200/http://www.starrbc.org/play_button.jpg" />',
        '</div><br/>',
    '</tpl>'
); 
```

我添加了对事件对象的检查，注释掉了元素和委托的代码（让这些代码不起作用）。

```
listeners: {
    itemtap: function(bookmarkView, index, item, e) {
                console.log("Hello I am Here!");

                if (e.getTarget().hasCls('xplay')) {
                    console.log('hasCls: xplay');
                }
            } //,
    // element: 'innerElement',
    // delegate: 'xplay'
} 
```

但是，我们遇到了这个问题：

> Uncaught TypeError: Object [object Object] has no method 'getTarget' 事件处理程序中的错误'undefined': INDEX_SIZE_ERR: DOM Exception 1 undefined

我们很困惑，这是否意味着我们没有得到一个 Event 对象？还是我们错误地解释了您的解释？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:21:37.953

你的做法是错误的。

1）ID应该是唯一的，你不能一遍又一遍地重复ID，每个元素必须有一个。相反，给元素一个类名。

2) 像您一直在做的那样监听 itemtap 事件，然后检查事件对象以查看它是否与您的委托匹配：

```
if (e.getTarget().hasCls('myCustomCls')) {
    // do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T13:13:02.403

```
listeners: {
    element: 'element',//i hope element works.
    delegate: 'div.xplay',
    event:'tap',
    fn: 'Your function here',
} 
```

这就是听众应该如何满足您的要求。

# java - paintComponent 中的初始化不起作用

> ID：11376272
> 
> 赞同：4
> 
> 时间：2012-07-07T15:31:34.050
> 
> 标签：java, swing

我正在做一些练习来理解 Java 和 Swing API。为什么我在 Disegno 构造函数中有一个 nullPointerException？我想打印两个矩形的坐标，但它们似乎没有被初始化。

```
import java.awt.*;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Disegno extends JFrame{

    Disegno(){
        this.setSize(500, 500);
        this.setDefaultCloseOperation(this.EXIT_ON_CLOSE);
        MyPanel aba = new MyPanel();
        this.setContentPane(aba);
        this.setVisible(true);

        System.out.println(aba.rect.blue.x + "-" + aba.rect.blue.y);
        System.out.println(aba.rect.yellow.x + "-" + aba.rect.yellow.y);
    }

    public static void main(String[] args){
        new Disegno();
    }
}

class MyPanel extends JPanel{

    JPanel up, down;
    RectArea rect;

    MyPanel(){
        this.setLayout(new BorderLayout());

        up = new JPanel();
        this.add(up, BorderLayout.NORTH);
        up.setBackground(Color.red);
        up.setVisible(true);

        down = new JPanel();
        down.setBackground(Color.green);
        this.add(down, BorderLayout.SOUTH);
        down.setVisible(true);

        rect = new RectArea();
        this.add(rect, BorderLayout.CENTER);

        this.setVisible(true);
    }
}

class RectArea extends JPanel{

    Rectangle blue, yellow;
    boolean check = false;

    RectArea(){
        super();
        this.setVisible(true);
    }

    public void initRect(){
        blue = new Rectangle(0, 0, 100, 100);
        yellow = new Rectangle(this.getWidth(), this.getHeight(), 100, 100);
        System.out.println("ok");
    }

    @Override
    protected void paintComponent(Graphics g){
        super.paintComponent(g);
        if(check == false){
            this.initRect();
            check = true;
        }

        System.out.println(this.getWidth() + "-" + this.getHeight());
        g.setColor(Color.blue);
        g.fillRect(blue.x, blue.y, blue.width, blue.height);
        g.setColor(Color.yellow);
        g.fillRect(yellow.x - yellow.width, yellow.y - yellow.height, yellow.width, yellow.height);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T18:19:29.517

其他人提出了有用的方法来检测和避免`NullPointerException`. 不幸的是，你不能依赖*什么时候*`paintComponent()`调用你的实现。反而，

*   根据当前寡妇的大小确定所需的几何形状；在下面的示例中调整窗口大小以查看`yellow`似乎如何*粘*在右下角。

*   因为`MyPanel`不包含它自己的组件，所以您应该覆盖`getPreferredSize()`，正如@nIcE cOw[在这里](https://stackoverflow.com/a/11376322/230513)显示的那样。

*   用于`pack()`调整封闭的`Window`.

*   建立在[事件分派线程](http://download.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)上。

附录：*我不明白你为什么要覆盖方法* `getPreferredSize()`。

`JComponent`override的子类，[`getPreferredSize()`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComponent.html#getPreferredSize%28%29)以便[`pack()`](http://docs.oracle.com/javase/7/docs/api/java/awt/Window.html#pack%28%29)可以调整大小`Window`“以适应其子组件的首选大小和布局”。这样你就不必担心用户是否有不同的字体，例如。`MyPanel`只是绘制几何形状，所以你是首选尺寸的老板。[正如这里](https://stackoverflow.com/q/7229226/230513)所讨论的，为了方便起见，可能会使用演示`setPreferredSize()`，但您应该了解这样做的局限性。

![在此处输入图像描述](../Images/c20161dcd2b1144f14556fc67f8f1457.png)

```
import java.awt.*;
import javax.swing.JFrame;
import javax.swing.JPanel;

/**
* @see https://stackoverflow.com/q/11376272/230513
*/
public class Disegno extends JFrame {

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Disegno();
            }
        });
    }

    Disegno() {
        this.setSize(500, 500);
        this.setDefaultCloseOperation(EXIT_ON_CLOSE);
        MyPanel aba = new MyPanel();
        this.add(aba);
        this.pack();
        this.setLocationRelativeTo(null);
        this.setVisible(true);
    }

    class MyPanel extends JPanel {

        private JPanel up, down;
        private RectArea rect;

        MyPanel() {
            super(new BorderLayout());

            up = new JPanel();
            up.setBackground(Color.red);
            this.add(up, BorderLayout.NORTH);

            rect = new RectArea();
            this.add(rect, BorderLayout.CENTER);

            down = new JPanel();
            down.setBackground(Color.green);
            this.add(down, BorderLayout.SOUTH);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(320, 240);
        }
    }

    class RectArea extends JPanel {

        private Rectangle blue = new Rectangle(0, 0, 100, 100);
        private Rectangle yellow = new Rectangle(0, 0, 100, 100);

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            System.out.println(this.getWidth() + " x " + this.getHeight());
            g.setColor(Color.blue);
            g.fillRect(blue.x, blue.y, blue.width, blue.height);

            g.setColor(Color.yellow);
            int dx = getWidth() - yellow.width;
            int dy = getHeight() - yellow.height;
            g.fillRect(dx, dy, yellow.width, yellow.height);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T17:01:22.820

你从来没有`rect.initRect();`在任何地方打电话，这就是为什么你`NullPointerException`在那些`System.out.println() lines`. 为什么你`panelObject.setVisible(true)`在每个类中使用，首先将它们添加到`JPanel`并简单地调用`setVisible(...)`就`JFrame`可以了。在这里用上述的东西观察你修改过的代码，按预期工作：

```
import java.awt.*;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Disegno extends JFrame{

    Disegno(){
        this.setSize(500, 500);
        this.setDefaultCloseOperation(this.EXIT_ON_CLOSE);
        MyPanel aba = new MyPanel();
        this.setContentPane(aba);
        this.setVisible(true);

        System.out.println(aba.rect.blue.x + "-" + aba.rect.blue.y);
        System.out.println(aba.rect.yellow.x + "-" + aba.rect.yellow.y);
    }

    public static void main(String[] args){
        new Disegno();
    }
}

class MyPanel extends JPanel{

    JPanel up, down;
    RectArea rect;

    MyPanel(){
        this.setLayout(new BorderLayout());

        up = new JPanel();
        this.add(up, BorderLayout.NORTH);
        up.setOpaque(true);
        up.setBackground(Color.red);

        down = new JPanel();
        down.setOpaque(true);
        down.setBackground(Color.green);
        this.add(down, BorderLayout.SOUTH);

        rect = new RectArea();
        rect.initRect();
        this.add(rect, BorderLayout.CENTER);
    }
}

class RectArea extends JPanel{

    Rectangle blue, yellow;
    boolean check = false;

    RectArea(){
        super();
        setOpaque(true);
    }

    public void initRect(){
        blue = new Rectangle(0, 0, 100, 100);
        yellow = new Rectangle(this.getWidth(), this.getHeight(), 100, 100);
        System.out.println("ok");
    }

    @Override
    protected void paintComponent(Graphics g){
        super.paintComponent(g);
        if(check == false){
            this.initRect();
            check = true;
        }

        System.out.println(this.getWidth() + "-" + this.getHeight());
        g.setColor(Color.blue);
        g.fillRect(blue.x, blue.y, blue.width, blue.height);
        g.setColor(Color.yellow);
        g.fillRect(yellow.x - yellow.width, yellow.y - yellow.height, yellow.width, yellow.height);
    }
} 
```

如果你在`System.out.println()`里面写一个你就会知道的，那些给你错误的行是在方法本身`intiRect()`之前被调用的。`paintComponent(...)`因此，在我看来，您必须将该逻辑从`paintComponent(...)`方法中取出并将其保存在其他地方，或者如果您不需要这些行，则删除它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T15:42:27.880

您正在尝试访问`aba.rect.blue`和`aba.rect.yellow`在您的`Disegno`构造函数中，但是这些在`RectArea.paintComponent`被调用之前不会被初始化，因此它会引发 NPE。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T16:28:36.600

您确定您的代码给出了 NullPointerException ........？

**因为当我运行你的代码时，它运行良好......**

**输出：**

```
ok
484-442 
```

# sql-server - 无法连接到远程服务器

> ID：11376277
> 
> 赞同：0
> 
> 时间：2012-07-07T15:31:59.480
> 
> 标签：sql-server, networking, remote-access

我无法连接到远程 SQL Server。

我做了以下事情：

1.  启用 TCP/IP 协议

2.  关闭防火墙

3.  启动 SQL Server Browser 服务。

但我仍然无法连接到服务器

服务器名称：--ip\SQLSERVER
用户--用户名
密码--密码

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T15:41:46.210

我会做以下检查。

1.  启用 TCP/IP 协议
2.  关闭服务器上的防火墙（不知道你这里是关闭了客户端防火墙还是服务器防火墙）
3.  远程服务器已启动并正在运行
4.  远程服务器 SQL Server 服务已启动并正在运行 a) SQL Server 代理 b) SQL Server (SQLSERVER)
5.  客户端机器能够 ping 远程服务器（这不是强制性的。如果 ping 仍然无法正常工作，则可以访问服务器。如果 ping 正常工作，那就少担心一件事）
6.  最后，如果您收到任何错误消息，请发布您的错误消息，这将有助于我们更清楚地了解可能出现的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T15:37:21.823

如果您还没有，请尝试以下操作：

*   在 Management Studio 中，右键单击您的服务器，然后单击*属性*
*   转到*连接*页面并确保选中*允许远程连接到此服务器*
*   单击*安全*页面，并在*服务器身份验证*下确保选择了*SQL Server 和 Windows 身份验证*模式。

此外，请确保服务器和客户端都使用相同的 IP 版本（`IPv4`或`IPv6`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-04T08:21:00.483

您是否检查了您的用户是否有权连接到服务器？查看以下输出：

```
select host, user from mysql.user; 
```

它应该是这样的：

```
+--------------+------------------+
| host         | user             |
+--------------+------------------+
| %            | MyUserName       |
| 12.12.12.123 | MyUserName       |
| localhost    | debian-sys-maint |
| localhost    | mysql.session    |
| localhost    | mysql.sys        |
| localhost    | root             |
+--------------+------------------+ 
```

我们看前2行，host下的“%”表示可以从任意IP连接。第二行指定主机（只需选择其中一个选项）。

希望这有帮助。

# google-maps-api-3 - navigator.geolocation.getcurrentposition 完成后如何调用另一个js函数？

> ID：11376279
> 
> 赞同：0
> 
> 时间：2012-07-07T15:32:21.093
> 
> 标签：google-maps-api-3

看看这个：

```
 function doGeolocation() {
       if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(positionSuccess, positionError);
       if(//here i need check)
         {
         Save();
         } 
      }
  else 
  {
    positionError(-1);
  }
} 
```

因此，在内部“如果”中，我想检查 navigator.geolocation.getcurrentposition(); 已经成功完成。任何帮助将不胜感激。

谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:35:06.347

`getCurrentPosition`自己检查是否成功，并根据结果调用不同的函数。

在您的函数中，成功`positionSuccess`时将调用一个被调用的函数；如果地理定位失败，那么`positionError`将被调用。

因此，您需要提供一个`positionSuccess()`可以进行保存的函数。你不需要自己检查。

请记住，这`getCurrentPosition`需要一些时间。这被移交给一个单独的进程[这称为*异步处理*]，您的代码将继续到下一行。在您当前的代码中，执行将在找到地理定位结果之前到达“这里我需要检查”测试。这就是为什么还有其他函数来处理成功和失败的原因——无法保证何时返回结果。

# regex - 正则表达式 shell 脚本将文件的特定部分保存到变量

> ID：11376281
> 
> 赞同：0
> 
> 时间：2012-07-07T15:32:43.633
> 
> 标签：regex, shell, expression

我需要一些命令的帮助来处理以下情况。我在网上搜索寻求帮助，但我无法成功找到解决方案。

问题是：

我有一个名为“temp.xml”的xml文件，xml文件中的文本例如

```
<?xml version="1.0" encoding="utf-8"?>
<NoteData Note_Nbr="312" Data_Revision="2" Note_Revision="1" /> 
```

我只想将 Note_Nbr 保存到我的变量 x (312)

我尝试了一些东西，但它不起作用。

```
 X=$(sed  -r  's/[^|]*(Note_Nbr=")(\d\d\d)([^|]*)/2 /' temp.xml ) 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:36:03.260

正确的方法是使用真正的 XML 解析器：

```
x=$(xmllint --xpath 'string(/NoteData/@Note_Nbr)' test.xml) 
```

...或者，如果您有 XMLStarlet 而不是足够新的 xmllint：

```
x=$(xmlstarlet sel -t -m '/NoteData' -v @Note_Nbr -n <test.xml) 
```

另请参阅此答案：[https ://stackoverflow.com/a/1732454/14122](https://stackoverflow.com/a/1732454/14122)

现在，如果您只想使用文字字符串，您可以使用[参数扩展](http://mywiki.wooledge.org/BashGuide/Parameters#Parameter_Expansion)构建一些看起来像这样的脆弱的东西：

```
s='<NoteData Note_Nbr="312" Data_Revision="2" Note_Revision="1" />'
s=${s#* Note_Nbr=\"}; s=${s%%\"*}; echo "$s" 
```

或者，您可以在 bash 中使用本机正则表达式支持（请注意，此功能是 POSIX sh 中不存在的 bash 扩展）：

```
s='<NoteData Note_Nbr="312" Data_Revision="2" Note_Revision="1" />'
re='Note_Nbr="([^"]+)"'
if [[ $s =~ $re ]]; then
  match="${BASH_REMATCH[1]}"
else
  echo "ERROR: No match found" >&2
fi 
```

# java - 如何在不破坏界面的情况下制作可滚动客户端？

> ID：11376283
> 
> 赞同：0
> 
> 时间：2012-07-07T15:33:16.927
> 
> 标签：java, swing, jscrollpane

好的，我在 ScrollPanes 上度过了一段不可能的时光。这是我的构造函数：

```
private static JTextField field = new JTextField();
private static JTextArea pane = new JTextArea();
public Client(){
    JButton close = new JButton("Close");
    close.setMnemonic(KeyEvent.VK_C);
    close.addActionListener(new closeList());
    JButton send = new JButton("Send");
    send.setMnemonic(KeyEvent.VK_S);
    send.addActionListener(new sendList());
    JPanel buttonPanel = new JPanel(new GridLayout(1, 2));
    buttonPanel.add(send);
    buttonPanel.add(close);

    JScrollPane scroll = new JScrollPane(pane);

    pane.setLineWrap(true);
    pane.setWrapStyleWord(true);
    pane.setEditable(false);        
    Container tupper = getContentPane();
    tupper.add(field, BorderLayout.PAGE_START);
    tupper.add(pane, BorderLayout.CENTER);
    tupper.add(scroll, BorderLayout.EAST);
    tupper.add(buttonPanel, BorderLayout.PAGE_END);
} 
```

所以，滚动窗格在那里，但 id 没有做任何事情。我试过用 bar 代替窗格，但都是一样的。所有在线示例都使用了一些特殊的 awt 布局。有什么方法可以让我的 textarea 可滚动吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:56:26.897

您要添加`pane`两次：一次是 的孩子，`scroll`一次是直接添加到`tupper`. 一个组件一次只能有一个父级。尝试删除此行：

```
tupper.add(pane, BorderLayout.CENTER); 
```

# c - 快速计算 64 位整数的 log2

> ID：11376288
> 
> 赞同：60
> 
> 时间：2012-07-07T15:33:30.330
> 
> 标签：c, 64-bit, bit-manipulation, 32bit-64bit, lookup

一个很棒的编程资源 Bit Twiddling Hacks 提出（[在这里](http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogLookup)）以下方法来计算 32 位整数的 log2：

```
#define LT(n) n, n, n, n, n, n, n, n, n, n, n, n, n, n, n, n
static const char LogTable256[256] = 
{
    -1, 0, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3,
    LT(4), LT(5), LT(5), LT(6), LT(6), LT(6), LT(6),
    LT(7), LT(7), LT(7), LT(7), LT(7), LT(7), LT(7), LT(7)
};

unsigned int v; // 32-bit word to find the log of
unsigned r;     // r will be lg(v)
register unsigned int t, tt; // temporaries
if (tt = v >> 16)
{
    r = (t = tt >> 8) ? 24 + LogTable256[t] : 16 + LogTable256[tt];
}
else 
{
    r = (t = v >> 8) ? 8 + LogTable256[t] : LogTable256[v];
} 
```

并提到

> 查找表方法只需要大约 7 次操作即可找到 32 位值的日志。如果扩展到 64 位数量，大约需要 9 次操作。

但是，唉，没有提供任何关于应该以哪种方式将算法扩展到 64 位整数的额外信息。

关于这种 64 位算法的外观有什么提示吗？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-07-09T15:55:28.340

内在函数非常快，但对于真正的跨平台、独立于编译器的 log2 实现来说仍然不够。因此，如果有人感兴趣，这里是我在自己研究该主题时遇到的最快、无分支、类似 CPU 抽象的 DeBruijn 算法。

```
const int tab64[64] = {
    63,  0, 58,  1, 59, 47, 53,  2,
    60, 39, 48, 27, 54, 33, 42,  3,
    61, 51, 37, 40, 49, 18, 28, 20,
    55, 30, 34, 11, 43, 14, 22,  4,
    62, 57, 46, 52, 38, 26, 32, 41,
    50, 36, 17, 19, 29, 10, 13, 21,
    56, 45, 25, 31, 35, 16,  9, 12,
    44, 24, 15,  8, 23,  7,  6,  5};

int log2_64 (uint64_t value)
{
    value |= value >> 1;
    value |= value >> 2;
    value |= value >> 4;
    value |= value >> 8;
    value |= value >> 16;
    value |= value >> 32;
    return tab64[((uint64_t)((value - (value >> 1))*0x07EDD5E59A4E28C2)) >> 58];
} 
```

四舍五入到 2 的下一个较低幂的部分取自[Power-of-2 Boundaries](http://ptgmedia.pearsoncmg.com/images/0201914654/samplechapter/warrench03.pdf)，获取尾随零数量的部分取自[BitScan](http://chessprogramming.wikispaces.com/BitScan)（`(bb & -bb)`代码用于挑出设置为的最右边的位1，在我们将值向下舍入到 2 的下一个幂之后就不需要了）。

顺便说一下，32 位实现是

```
const int tab32[32] = {
     0,  9,  1, 10, 13, 21,  2, 29,
    11, 14, 16, 18, 22, 25,  3, 30,
     8, 12, 20, 28, 15, 17, 24,  7,
    19, 27, 23,  6, 26,  5,  4, 31};

int log2_32 (uint32_t value)
{
    value |= value >> 1;
    value |= value >> 2;
    value |= value >> 4;
    value |= value >> 8;
    value |= value >> 16;
    return tab32[(uint32_t)(value*0x07C4ACDD) >> 27];
} 
```

与任何其他计算方法一样，log2 要求输入值大于零。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2012-07-07T16:30:41.923

如果您使用的是 GCC，则在这种情况下不需要查找表。

GCC 提供了一个内置函数来确定前导零的数量：

> 内置函数： 返回 x 中前导 0 位的数量，从最高有效位位置开始。如果 x 为 0，则结​​果未定义。[**`int __builtin_clz (unsigned int x)`**](http://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html)

所以你可以定义：

```
#define LOG2(X) ((unsigned) (8*sizeof (unsigned long long) - __builtin_clzll((X)) - 1)) 
```

它适用于任何 unsigned long long int。结果四舍五入。

对于 x86 和 AMD64，GCC 会将其编译为[`bsr`](https://www.felixcloutier.com/x86/bsr)指令，因此解决方案非常快（比查找表快得多）。

[工作示例](http://coliru.stacked-crooked.com/a/acd3252e19ad55f6)：

```
#include <stdio.h>

#define LOG2(X) ((unsigned) (8*sizeof (unsigned long long) - __builtin_clzll((X)) - 1))

int main(void) {
    unsigned long long input;
    while (scanf("%llu", &input) == 1) {
        printf("log(%llu) = %u\n", input, LOG2(input));
    }
    return 0;
} 
```

编译输出：[https ://godbolt.org/z/16GnjszMs](https://godbolt.org/z/16GnjszMs)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2014-04-10T22:59:05.430

我试图通过强制使用幻数[将 O(lg(N)) 操作中的 Find the log base 2 of an N-bit integer with multiply and lookup转换为 64 位。](http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogDeBruijn)不用说这需要一段时间。

然后我找到了戴斯蒙德的答案，并决定尝试他的幻数作为起点。由于我有一个 6 核处理器，我从 0x07EDD5E59A4E28C2 / 6 倍数开始并行运行它。我很惊讶它立即发现了一些东西。结果 0x07EDD5E59A4E28C2 / 2 工作。

所以这里是 0x07EDD5E59A4E28C2 的代码，它为您节省了移位和减法：

```
int LogBase2(uint64_t n)
{
    static const int table[64] = {
        0, 58, 1, 59, 47, 53, 2, 60, 39, 48, 27, 54, 33, 42, 3, 61,
        51, 37, 40, 49, 18, 28, 20, 55, 30, 34, 11, 43, 14, 22, 4, 62,
        57, 46, 52, 38, 26, 32, 41, 50, 36, 17, 19, 29, 10, 13, 21, 56,
        45, 25, 31, 35, 16, 9, 12, 44, 24, 15, 8, 23, 7, 6, 5, 63 };

    n |= n >> 1;
    n |= n >> 2;
    n |= n >> 4;
    n |= n >> 8;
    n |= n >> 16;
    n |= n >> 32;

    return table[(n * 0x03f6eaf2cd271461) >> 58];
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-07-15T01:59:46.387

## 以 2 为底的整数对数

这是我为 64 位无符号整数所做的。这会计算以 2 为底的对数的下限，它相当于最高有效位的索引。这种方法对于大量数据来说*非常快，因为它使用了一个展开的循环，该循环总是以 log₂64 = 6 步执行。*

本质上，它的作用是在序列 { 0 ≤ k ≤ 5: 2^(2^k) } = { 2³², 2¹⁶, 2⁸, 2⁴, 2², 2¹ } = { 4294967296, 65536, 256 , 16, 4, 2, 1 } 并将减去值的指数 k 相加。

```
int uint64_log2(uint64_t n)
{
  #define S(k) if (n >= (UINT64_C(1) << k)) { i += k; n >>= k; }

  int i = -(n == 0); S(32); S(16); S(8); S(4); S(2); S(1); return i;

  #undef S
} 
```

请注意，如果给定无效输入 0（这是初始`-(n == 0)`值检查的内容），则返回 –1。如果您从未期望使用 调用它`n == 0`，则可以替换`int i = 0;`初始化程序并将`assert(n != 0);`at entry 添加到函数中。

## 以 10 为底的整数对数

可以使用类似的方法计算以 10 为底的整数对数——要测试的最大平方为 10¹⁶，因为 log₁₀2⁶⁴ ≅ 19.2659...（注意：这不是完成以 10 为底的整数对数的最快方法，因为它使用整数除法，这本质上很慢。更快的实现是使用具有指数增长的累加器，并与累加器进行比较，实际上是进行一种二进制搜索。）

```
int uint64_log10(uint64_t n)
{
  #define S(k, m) if (n >= UINT64_C(m)) { i += k; n /= UINT64_C(m); }

  int i = -(n == 0);
  S(16,10000000000000000); S(8,100000000); S(4,10000); S(2,100); S(1,10);
  return i;

  #undef S
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-07-07T15:56:24.497

这是一个非常紧凑*和*快速的扩展，不使用额外的临时：

```
r = 0;

/* If its wider than 32 bits, then we already know that log >= 32.
So store it in R.  */
if (v >> 32)
  {
    r = 32;
    v >>= 32;
  }

/* Now do the exact same thing as the 32 bit algorithm,
except we ADD to R this time.  */
if (tt = v >> 16)
  {
    r += (t = tt >> 8) ? 24 + LogTable256[t] : 16 + LogTable256[tt];
  }
else
  {
    r += (t = v >> 8) ? 8 + LogTable256[t] : LogTable256[v];
  } 
```

这是一个用`if`s 链构建的，同样没有使用额外的临时对象。不过可能不是最快的。

```
 if (tt = v >> 48)
    {
      r = (t = tt >> 8) ? 56 + LogTable256[t] : 48 + LogTable256[tt];
    }
  else if (tt = v >> 32)
    {
      r = (t = tt >> 8) ? 40 + LogTable256[t] : 32 + LogTable256[tt];
    }
  else if (tt = v >> 16)
    {
      r = (t = tt >> 8) ? 24 + LogTable256[t] : 16 + LogTable256[tt];
    }
  else 
    {
      r = (t = v >> 8) ? 8 + LogTable256[t] : LogTable256[v];
    } 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-10-10T20:07:11.380

如果您正在寻找 c++ 的答案并且您到了这里，并且由于归结为计数零，那么您[`std::countl_zero`](https://en.cppreference.com/w/cpp/numeric/countl_zero)根据 godbolt.org 的调用得到了 which `bsr`。 `std::countl_zero`可从 C++20 获得，您可能需要添加`-std=gnu++2a`到编译器命令行

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-07-07T15:42:55.103

该算法基本上找出哪个字节包含最高有效1位，然后在查找中查找该字节以找到该字节的日志，然后将其添加到该字节的位置。

这是 32 位算法的简化版本：

```
if (tt = v >> 16)
{
    if (t = tt >> 8)
    {
        r = 24 + LogTable256[t];
    }
    else
    {
        r = 16 + LogTable256[tt];
    }
}
else 
{
    if (t = v >> 8)
    {
        r = 8 + LogTable256[t];
    }
    else
    {
        r = LogTable256[v];
    }
} 
```

这是等效的 64 位算法：

```
if (ttt = v >> 32)
{
    if (tt = ttt >> 16)
    {
        if (t = tt >> 8)
        {
            r = 56 + LogTable256[t];
        }
        else
        {
            r = 48 + LogTable256[tt];
        }
    }
    else 
    {
        if (t = ttt >> 8)
        {
            r = 40 + LogTable256[t];
        }
        else
        {
            r = 32 + LogTable256[ttt];
        }
    }
}
else
{
    if (tt = v >> 16)
    {
        if (t = tt >> 8)
        {
            r = 24 + LogTable256[t];
        }
        else
        {
            r = 16 + LogTable256[tt];
        }
    }
    else 
    {
        if (t = v >> 8)
        {
            r = 8 + LogTable256[t];
        }
        else
        {
            r = LogTable256[v];
        }
    }
} 
```

我想出了一种算法，适用于我认为比原始尺寸更好的任何尺寸类型。

```
unsigned int v = 42;
unsigned int r = 0;
unsigned int b;
for (b = sizeof(v) << 2; b; b = b >> 1)
{
    if (v >> b)
    {
        v = v >> b;
        r += b;
    }
} 
```

注意：`b = sizeof(v) << 2`将 b 设置为 v 中位数的一半。我在这里使用移位而不是乘法（只是因为我喜欢它）。

您可以向该算法添加一个查找表以加快它的速度，但这更像是一个概念验证。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-07-05T15:08:10.473

拿着这个：

```
typedef unsigned int uint;
typedef uint64_t ulong;
uint as_uint(const float x) {
    return *(uint*)&x;
}
ulong as_ulong(const double x) {
    return *(ulong*)&x;
}
uint log2_fast(const uint x) {
    return (uint)((as_uint((float)x)>>23)-127);
}
uint log2_fast(const ulong x) {
    return (uint)((as_ulong((double)x)>>52)-1023);
} 
```

工作原理：输入整数`x`被转换`float`为位，然后重新解释为位。IEEE`float`格式将 30-23 位中的指数存储为具有偏差 127 的整数，因此通过将其向右移动 23 位并减去偏差，我们得到 log2(x)。对于 64 位整数输入，`x`转换为`double`，其指数在 62-52 位（右移 52 位），指数偏差为 1023。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-10-20T15:19:35.720

这是[SPWorley 于 2009 年 3 月 22 日](https://stackoverflow.com/a/671826/2352507)稍作修改的版本（详见帖子）

```
double ff=(double)(v|1);
return ((*(1+(uint32_t *)&ff))>>52)-1023;  // assumes x86 endianness 
```

旁注：一些用户指出，在某些情况下编译时，这可能会导致错误的答案。

# c++ - 为什么 sizeof statsements 会产生不同的结果？

> ID：11376289
> 
> 赞同：2
> 
> 时间：2012-07-07T15:33:32.490
> 
> 标签：c++

> **可能重复：**[在 C 编程语言中](https://stackoverflow.com/questions/1975128/sizeof-an-array-in-the-c-programming-language)
> [计算数组的大小Sizeof 一个数组？](https://stackoverflow.com/questions/720077/calculating-size-of-an-array)

为什么`sizeof(arr)/(double)sizeof(arr[0])`工作和`sizeof(arr+0)/(double)sizeof(arr[0])`不工作？

为什么`sizeof(arr)/(double)sizeof(arr[0])`将 arr 传递给函数时也不起作用？这是完整的代码示例：

```
#include <iostream>

using namespace std;

int givesize(int arr[])
{
   cout<<sizeof(arr)/(double)sizeof(arr[0])<<"\n";
}

int main()
{
   int arr[] = {1,2,3,4,5};
   cout<<sizeof(arr)/(double)sizeof(arr[0])<<"\n";
   cout<<sizeof(arr+2)/(double)sizeof(arr[0])<<"\n";
   givesize(arr);
   return 0;
} 
```

输出 5 1 1

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T15:35:15.937

发生这种情况是因为[数组](https://stackoverflow.com/a/1461449/335858)在传递给将指针作为参数的函数时会衰减为指针。

在你`main`的内部，

```
int arr[] = {1,2,3,4,5}; 
```

声明相当于

```
int arr[5] = {1,2,3,4,5}; 
```

因为编译器有足够的信息来计算`5`聚合初始值设定项。然而，在函数头中，`int arr[]`并不意味着同样的事情：它周围没有上下文告诉编译器它只是一个指向整数的指针。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T15:41:25.487

`int arr[]`在函数参数列表中与`int* arr`. 这意味着在：

```
int givesize(int arr[])
{
   cout<<sizeof(arr)/(double)sizeof(arr[0])<<"\n";
} 
```

`sizeof(arr)/(double)sizeof(arr[0])`实际上是`sizeof(int*) / (double)sizeof(int)`。因为它的输出`1`意味着一个 32 位平台。

`int arr[]`作为局部变量与 不同`int* arr`，因此与计算结果为 5`sizeof(arr)/(double)sizeof(arr[0])`的相同。`sizeof(int[5]) / (double)sizeof(int)`

接下来，`sizeof(arr+2)/(double)sizeof(arr[0])`再次与 相同`sizeof(int*) / (double)sizeof(int)`，因为表达式的类型`arr+2`是`int*`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T15:45:41.223

> 为什么 sizeof(arr)/(double)sizeof(arr[0]) 有效

因为`sizeof(arr)`以字节为单位返回整个数组的大小（假设 20`int`是 32 位），并`sizeof(arr[0])`返回第一个 int 的大小（即 4 个字节）。这会给我们5。

> 为什么将 arr 传递给函数时 sizeof(arr)/(double)sizeof(arr[0]) 也不起作用？

因为数组衰减为指针。这意味着它们丢失了一个重要信息：它们的大小。我们不能仅通过指针直接计算数组的大小。这个函数怎么会知道它是一个数组开头的呢？

* * *

C++？使用模板函数：

```
template <typename T, int N>
int getsize(const T (&arr)[N])
{
    return N;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T15:39:13.757

在 main 内部，arr 的类型为“五个整数的数组”，但 arr+0 的类型为“指向 int 的指针”。当您将零添加到 arr 时，您将其视为指针，并且一旦您将数组用作指针，它就会转换为指针。

# java - java - 如何在java中将消息附加到unix邮箱？

> ID：11376290
> 
> 赞同：1
> 
> 时间：2012-07-07T15:33:44.477
> 
> 标签：java, linux, email

我想将消息附加到 unix 邮箱文件（像 /var/mail/username 这样的文件）。我该怎么做？那里的消息是如何分开的？网上有规范吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:53:14.760

有多种不兼容的格式，但应遵循的基本格式在[RFC 4155](https://www.rfc-editor.org/rfc/rfc4155)中进行了描述，其中包含附录 A 中的基本规则，还链接到[mbox 的 qmail 手册页](http://qmail.org./man/man5/mbox.html)以进一步描述一些变体。

通过查看您自己系统的 mbox 和/或邮件手册页，您可能能够获取有关系统上使用的特定格式的信息。但是您的系统甚至不一定有这些手册页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T15:39:04.443

这个问题的答案取决于您使用的邮箱，因为其中有几个。

我想最好的起点是这里：

[http://en.wikipedia.org/wiki/Mbox](http://en.wikipedia.org/wiki/Mbox)

# drupal - 为什么表单属性中有'#'

> ID：11376292
> 
> 赞同：3
> 
> 时间：2012-07-07T15:34:15.023
> 
> 标签：drupal

使用表格时。为什么要在键上加上“#”？有什么特殊原因吗？

```
$form['a'] = array(
        '#type' => 'textfield',
        '#title' => t('Score if not chosen'),
      ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T14:47:21.403

在 Drupal 中，将井号标记 (#) 添加到对应于设置而不是元素的变量名称的开头是一种约定。这样做是为了避免命名空间冲突。

# android - 我是否需要保留我的通知 ID

> ID：11376294
> 
> 赞同：0
> 
> 时间：2012-07-07T15:34:47.607
> 
> 标签：android, notifications

我有一个警报应用程序，用户可以在其中设置多个警报。当警报响起时，应用程序只会显示一个通知，单击该通知将启动主活动屏幕并删除通知。

每个警报都有自己的通知，这是我的问题所在；如果显示多个通知，当用户单击一个时，我想清除我所有应用程序的通知。为此，我需要跟踪当前显示的通知的 ID。推荐的方法是什么？

我想这些将需要保留，因为一旦创建并显示了通知，我的应用程序的进程就会被终止。我的想法正确吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:27:12.713

> 为此，我需要跟踪当前显示的通知的 ID。

或者只是调用`cancelAll()`,`NotificationManager`以取消所有未完成的通知。

> 推荐的方法是什么？

为了安全起见，您应该使用一些持久性数据存储（例如，文件），因为您的进程可能会在*警报*之间停止。

> 我想这些将需要保留，因为一旦创建并显示了通知，我的应用程序的进程就会被终止。我的想法正确吗？

[正如您在最近的另一个问题](https://stackoverflow.com/questions/11376409/when-does-my-apps-process-die)中所讨论的那样，它肯定可以在下一次警报之前被杀死。

# php - 使用 PHP 或 Javascript 生成自动照片库

> ID：11376297
> 
> 赞同：-3
> 
> 时间：2012-07-07T15:35:16.910
> 
> 标签：php, javascript, photo-gallery, auto-generate

所以我有大量的汽车照片，我把它们整理成这样的结构（这是一个虚构的例子来展示我的原则）：

```
Cars > Audi > Sports cars > '5 pictures'

Cars > Audi > Family cars > '3 pictures'

Cars > BMW > Family cars > '5 pictures' 
```

我会将名为 Cars 的文件夹上传到我的服务器。

现在我想要的是一个片段/脚本，它读取我的目录，然后为一个简单的相册生成并返回 html。相册不需要高级，我只想跳过手动编写相册HTML。

我猜这已经做了很多次了，虽然我找不到它的简单演示。我愿意为此付费，但我当然会对代码的质量提出更高的要求。

如果有任何不清楚的地方，请告诉我，我会尽快更新我的问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:39:57.593

对不起，我刚刚找到了答案：

[http://davidwalsh.name/generate-photo-gallery](http://davidwalsh.name/generate-photo-gallery)

# objective-c - 从另一个视图控制器访问 ViewController 的实例方法

> ID：11376301
> 
> 赞同：1
> 
> 时间：2012-07-07T15:35:51.280
> 
> 标签：objective-c, ios, properties, uiviewcontroller, instance

假设我有一个名为 vc1 的视图控制器，它有一个名为 property1 的综合属性，我想从另一个视图控制器 (vc2) 访问它并从 vc2 更改它。

现在@syntisize 创建的用于更改和获取属性的方法是实例方法，那么我怎样才能从另一个视图控制器获取它们（视图控制器在应用程序中是否有实例，如果有，它们是什么？）

只是为了清楚我正在使用情节提要，所以我从来没有真正实例化视图控制器......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T15:41:44.503

VC1.m:

```
-(void) yourMethod {
     ...
} 
```

VC2.m

```
YOURViewController * vc2 = [[YOURViewController alloc]init];
[vc yourMethod];
[vc release]; 
```

确保在您的其他视图中导入您`YOURViewController`的 .m 文件 类似的东西应该可以工作。

或者，如果您遇到问题，请在此处尝试本教程：

[如何在两个视图控制器之间传递数据的教程](http://klanguedoc.hubpages.com/hub/IOS-5-Tutorial-on-How-To-Pass-Data-Between-Two-View-Controllers)

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T15:45:28.037

虽然您可以按照您描述的方式进行操作，但我认为通用技术（假设 VC1 与 VC2 有一个 segue）有点不同，其中 VC2 将具有一个由`prepareForSegue`. 请参阅View Controller Programming Guide 中的在[触发 Segue 时配置目标控制器。](http://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/ManagingDataFlowBetweenViewControllers/ManagingDataFlowBetweenViewControllers.html#//apple_ref/doc/uid/TP40007457-CH8-SW4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T15:49:25.400

您需要将情节提要视图与视图控制器链接起来，以便 vc1 的视图将使用 vc1 类等其余部分（我假设您已经这样做了，因为这在为不同视图编码时很重要）

然后你需要做的就是你在哪里调用属性所以让我们说`viewDidLoad`方法，像这样声明视图控制器：

`- (void) viewDidLoad {
vc1 *viewController;
// Now you change the variable I'll presume its a UILabel so I'll change its text
[viewController.property1 setText:@"I changed a different views UILabel"];
}`

让我知道这是否有效......它之前对我有用，所以应该有效

# c# - C# Ln 到 Mathf.Log

> ID：11376302
> 
> 赞同：3
> 
> 时间：2012-07-07T15:35:54.460
> 
> 标签：c#, math

您将如何在 C# 中编写此函数？

![在此处输入图像描述](../Images/22699e6193644c7970058fd649fa1f93.png)

我知道这与 Mathf.Log 有关，但我的数学有点生疏。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T15:38:04.563

`Mathf`看起来它是为 Unity 准备的。除非您使用 Unity，否则您可能想要：

```
double x = 1 + (Math.log(v -s) / (10 * Math.log(2))); 
```

# java - 在 Spring 中编写 JSON 反序列化器或对其进行扩展的正确方法

> ID：11376304
> 
> 赞同：63
> 
> 时间：2012-07-07T15:36:20.747
> 
> 标签：java, json, spring, jackson, deserialization

我正在尝试在 Spring 中编写自定义 JSON 反序列化器。我想对大部分字段使用默认序列化程序，并对少数属性使用自定义反序列化程序。是否可以？我正在尝试这种方式，因为大部分属性都是值，所以对于这些我可以让杰克逊使用默认的反序列化器；但很少有属性是引用，所以在自定义反序列化器中，我必须查询数据库以获取引用名称并从数据库中获取引用值。

如果需要，我会展示一些代码。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-07-07T17:54:48.330

我已经搜索了很多，到目前为止我发现的最好方法是在这篇[文章中](https://www.sghill.net/how-do-i-write-a-jackson-json-serializer-deserializer.html)：

**要序列化的类**

```
package net.sghill.example;

import net.sghill.example.UserDeserializer
import net.sghill.example.UserSerializer
import org.codehaus.jackson.map.annotate.JsonDeserialize;
import org.codehaus.jackson.map.annotate.JsonSerialize;

@JsonDeserialize(using = UserDeserializer.class)
public class User {
    private ObjectId id;
    private String   username;
    private String   password;

    public User(ObjectId id, String username, String password) {
        this.id = id;
        this.username = username;
        this.password = password;
    }

    public ObjectId getId()       { return id; }
    public String   getUsername() { return username; }
    public String   getPassword() { return password; }
} 
```

**反序列化器类**

```
package net.sghill.example;

import net.sghill.example.User;
import org.codehaus.jackson.JsonNode;
import org.codehaus.jackson.JsonParser;
import org.codehaus.jackson.ObjectCodec;
import org.codehaus.jackson.map.DeserializationContext;
import org.codehaus.jackson.map.JsonDeserializer;

import java.io.IOException;

public class UserDeserializer extends JsonDeserializer<User> {

    @Override
    public User deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException {
        ObjectCodec oc = jsonParser.getCodec();
        JsonNode node = oc.readTree(jsonParser);
        return new User(null, node.get("username").getTextValue(), node.get("password").getTextValue());
    }
} 
```

编辑：或者，您可以查看使用新版本 com.fasterxml.jackson.databind.JsonDeserializer的[这篇文章。](http://www.baeldung.com/jackson-deserialization)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-12-12T18:30:13.143

我试图将`@Autowire`Spring 管理的服务放入我的`Deserializer`. `new`有人在调用序列化器/反序列化器时使用操作员向杰克逊小费。这意味着杰克逊的 my `Deserializer`. 以下是我如何能够将`@Autowire`我的服务类纳入我的`Deserializer`：

**上下文.xml**

```
<mvc:annotation-driven>
  <mvc:message-converters>
    <bean class="org.springframework.http.converter.json.MappingJackson2HttpMessageConverter">
      <property name="objectMapper" ref="objectMapper" />
    </bean>
  </mvc:message-converters>
</mvc>
<bean id="objectMapper" class="org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean">
    <!-- Add deserializers that require autowiring -->
    <property name="deserializersByType">
        <map key-type="java.lang.Class">
            <entry key="com.acme.Anchor">
                <bean class="com.acme.AnchorDeserializer" />
            </entry>
        </map>
    </property>
</bean> 
```

既然 my`Deserializer`是 Spring 管理的 bean，自动装配就可以了！

**AnchorDeserializer.java**

```
public class AnchorDeserializer extends JsonDeserializer<Anchor> {
    @Autowired
    private AnchorService anchorService;
    public Anchor deserialize(JsonParser parser, DeserializationContext context)
             throws IOException, JsonProcessingException {
        // Do stuff
    }
} 
```

**AnchorService.java**

```
@Service
public class AnchorService {} 
```

* * *

**更新**：当我写这篇文章时，我原来的答案对我有用，@xi.lin 的回应正是需要的。很好的发现！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-07T03:14:02.060

使用 Spring MVC 4.2.1.RELEASE，您需要使用新的 Jackson2 依赖项，如下所示，Deserializer 才能工作。

不要使用这个

```
<dependency>  
            <groupId>org.codehaus.jackson</groupId>  
            <artifactId>jackson-mapper-asl</artifactId>  
            <version>1.9.12</version>  
        </dependency> 
```

改用这个。

```
<dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-annotations</artifactId>
            <version>2.2.2</version>
        </dependency>
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-core</artifactId>
            <version>2.2.2</version>
        </dependency>
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-databind</artifactId>
            <version>2.2.2</version>
        </dependency> 
```

也使用`com.fasterxml.jackson.databind.JsonDeserializer`and `com.fasterxml.jackson.databind.annotation.JsonDeserialize`用于反序列化，而不是来自的类`org.codehaus.jackson`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-15T19:25:09.350

1.  如果您想覆盖特定属性的默认反序列化器，您可以标记要使用的属性和反序列化器，例如：

--

```
// root json object
public class Example {
  private String name;
  private int value;
  // You will implement your own deserilizer/Serializer for the field below//
  @JsonSerialize(converter = AddressSerializer.class)
  @JsonDeserialize(converter = AddressDeserializer.class)
  private String address;
} 
```

[这](https://www.tutorialspoint.com/jackson_annotations/jackson_annotations_jsondeserialize.htm)是一个完整的例子。

2.  如果您想在 Spring 应用程序上下文中使用非 Spring 托管对象映射器并配置序列化器/反序列化器以使用 Spring 托管服务来查询数据库，这可以通过告诉 Jackson 用于`Spring Handler instantiator`创建反序列化器/序列化器的实例来实现。

在您的应用程序上下文配置中，创建`ObjectMapper`bean，`SpringHandlerInstantiator`例如：

```
@Autowired
ApplicationContext applicationContext;

@Bean    
public ObjectMapper objectMapper(){
    Jackson2ObjectMapperBuilder builder = new Jackson2ObjectMapperBuilder();
    builder.handlerInstantiator(handlerInstantiator());
    // add additional configs, etc.. here if needed
    return builder.build();
}

@Bean
public HandlerInstantiator handlerInstantiator(){
    return new SpringHandlerInstantiator(applicationContext.getAutowireCapableBeanFactory());
} 
```

然后您可以在 objectMapper 上方 @Autowire 反序列化 jsons：

```
@Autowired
ObjectMapper objectMapper;

public Something readSomething(...){
    ...
    Something st = objectMapper.readValue(json, Something.class);
    ...
    return st;
} 
```

无论您要使用哪种反序列化器，即：字段或类，您都可以在反序列化器中使用 spring 上下文，这意味着您可以 @Autowire 您的服务或由其管理的任何 spring bean `ApplicationContext`。

```
public class MyCustomDeserialiser extends ..{

    @Autowired;
    MyService service;

    @AutoWired
    SomeProperties properties;

    @Override
    public MyValue deserialize(JsonParser jp, DeserializationContext ctxt) throws IOException, JsonProcessingException {
    ....
    }
    ...
} 
```

[此外，您可以在此处](https://dzone.com/articles/custom-json-deserialization-with-jackson)找到 Jackson 解串器的示例。

# php - jQuery标签选择器

> ID：11376306
> 
> 赞同：1
> 
> 时间：2012-07-07T15:36:47.050
> 
> 标签：php, jquery

我正在寻找添加标签功能栏，例如 stackoverflow 在提交问题以添加到我的网站时必须输入标签。问题是他们有一个昵称，出于某种原因，我无法在谷歌上找到他们。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T15:38:52.860

这个看起来对你有用：http: [//ivaynberg.github.com/select2/](http://ivaynberg.github.com/select2/)

# multithreading - Thread.sleep(1000) 什么时候睡眠少于 1000 毫秒？

> ID：11376307
> 
> 赞同：6
> 
> 时间：2012-07-07T15:36:49.250
> 
> 标签：multithreading, time, sleep

[在这篇关于程序员相信时间的谎言](http://infiniteundo.com/post/25509354022/more-falsehoods-programmers-believe-about-time-wisdom)的有趣文章中，其中之一是

> Thread.sleep(1000) 睡眠 >= 1000 毫秒。

这什么时候不是真的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T16:02:14.307

根据[this](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686298%28v=vs.85%29.aspx)（windows操作系统的sleep实现，就是Thread.sleep下面会调用的）：如果dwMilliseconds小于系统时钟的分辨率，线程可能会休眠小于指定的时间长度。如果 dwMilliseconds 大于 1 个滴答但小于 2 个滴答，则等待可能介于 1 到 2 个滴答之间，依此类推。要提高睡眠间隔的准确性，请调用[timeGetDevCaps](http://msdn.microsoft.com/en-us/library/windows/desktop/dd757627%28v=vs.85%29.aspx)函数以确定支持的最小计时器分辨率，并[调用 timeBeginPeriod](http://msdn.microsoft.com/en-us/library/windows/desktop/dd757624%28v=vs.85%29.aspx)函数将计时器分辨率设置为最小值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T07:07:09.803

操作系统仅在中断时做出反应，因此在中断时处理睡眠到期。可以通过 增加中断频率是正确的`timeBeginPeriod`。难点在于`Sleep()`函数的到期需要满足两个条件：

1.  必须发生中断
2.  *dwMilliseconds*必须过期。

条件2是这里的问题。dwMilliseconds将与中断时的过期系统时间进行比较*。*系统时间将导致`Sleep()`函数以文件时间格式增量过期，换句话说，当系统时间增量的 n 倍变得大于*dwMilliseconds 时*。因此，人们可能永远无法获得 1 毫秒的睡眠延迟。这在很大程度上取决于系统的硬件和软件以及配置（系统时间增量/粒度）。

可以在[这里找到一些示例的仔细查看](http://windowstimestamp.com/description)

回答这个问题： Thread.sleep(1000) sleeps for >= 1000 毫秒总是正确的！编辑：在 Thread.sleep(1) 之后立即执行时

编辑：但是 Thread.sleep(1) 睡眠时间 >= 1 毫秒可能并不总是 TRUE

# mysql - 从mysql执行系统命令

> ID：11376308
> 
> 赞同：1
> 
> 时间：2012-07-07T15:36:57.160
> 
> 标签：mysql, linux, user-defined-functions, ubuntu-12.04

我正在尝试从 mysql 中执行 shell 命令（从过程或触发器或 mysql 的命令行中）。

我已将 lib_mysqludf_sys 添加到 mysql 插件并创建了该库可用的函数。(图书馆)[主页](http://www.mysqludf.org/lib_mysqludf_sys/index.php)

该库有 5 个功能。

1.  sys_set - 设置 $PATH - 这可以工作并存储我以后可以检查的 $PATH。
2.  sys_get - 获取 $PATH 的存储值 - 这也有效并返回我存储的值。
3.  sys_exec - 在系统中执行命令并返回退出代码。
4.  sys_eval - 在系统中执行命令并返回标准输出。
5.  lib_mysqludf_sys_info - 返回库的当前版本 - 这也有效。

我需要 sys_exec 和 sys_eval 才能正常工作。

我想我在搜索中发现了问题，但无法解决。

mysql 受[apparmor](https://help.ubuntu.com/community/AppArmor)限制，默认 apparmor 配置文件不授予执行系统命令的访问权限。我已经尝试了文档中的命令来禁用单个配置文件，禁用框架，将除一个之外的所有配置文件置于强制模式并将所有配置文件置于抱怨模式。没有任何效果。命令

```
sudo apparmor_status 
```

总是给我相同的输出。

```
20 profiles are loaded.
20 profiles are in enforce mode.
  /opt/extras.ubuntu.com/unity-lens-askubuntu/unity-askubuntu-daemon
  /sbin/dhclient
  /usr/bin/evince
  /usr/bin/evince-previewer
  /usr/bin/evince-previewer//launchpad_integration
  /usr/bin/evince-previewer//sanitized_helper
  /usr/bin/evince-thumbnailer
  /usr/bin/evince-thumbnailer//sanitized_helper
  /usr/bin/evince//launchpad_integration
  /usr/bin/evince//sanitized_helper
  /usr/lib/NetworkManager/nm-dhcp-client.action
  /usr/lib/connman/scripts/dhclient-script
  /usr/lib/cups/backend/cups-pdf
  /usr/lib/lightdm/lightdm/lightdm-guest-session-wrapper
  /usr/lib/telepathy/mission-control-5
  /usr/lib/telepathy/telepathy-*
  /usr/sbin/cupsd
  /usr/sbin/mysqld
  /usr/sbin/tcpdump
  /usr/share/gdm/guest-session/Xsession
0 profiles are in complain mode. 
5 processes have profiles defined. 
5 processes are in enforce mode.    
  /sbin/dhclient (2537)     
  /usr/lib/telepathy/mission-control-5 (2709)  
  /usr/sbin/cupsd (12245)     
  /usr/sbin/cupsd (12250)     
  /usr/sbin/mysqld (12675)  
0 processes are in complain mode. 
0 processes are unconfined but have a profile defined. 
```

请告诉我如何禁用 apparmor 或更改 mysql 的配置文件，以便它可以访问执行系统命令。

我这样做的原因是，当数据库中发生某些事情时（通过数据库触发器），我可以执行系统命令，如果您有其他一些可以轻松实现的方法的建议，那么也请提及这些。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T18:41:58.837

设法得到这个工作。首先将 apparmor 置于抱怨模式以获取必要的配置文件，然后使用 apparmor 的交互式工具 (aa-genprof/aa-logprof) 为 mysqld 配置配置文件

# python - 使用python在csv文件的两列中排列数据

> ID：11376311
> 
> 赞同：0
> 
> 时间：2012-07-07T15:37:05.520
> 
> 标签：python, csv

我有一个 csv 文件，如下所示

```
1,1  
2,2  
3,4  
4,5  
6,6 
```

如您所见，第 1 列缺少“5”，第 2 列缺少“3”。
我想编写一个脚本，允许我比较两列并插入“缺少值”。输出看起来像：

```
1,1  
2,2
3, value missing
4,4
value missing, 5
6,6 
```

任何帮助将不胜感激！
注意：我在示例中使用了数字，真正的问题是没有任何实际意义的字符串

编辑：我在下面包含了一个实际数据的样本

```
HM999993,HM999993  
HM999995,HM999995  
HM999997,HM999997  
J04353,J04353  
JF800658,JF834523  
JF834523,JF906559  
JF906559,JN171845  
JN171845,K02718  
JN709469,M12732  
JN709470,M12737  
JN709471,M14119  
JN709472,M17463  
JQ754321,M20219 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:50:47.463

这是一个使用整数的相当简单的任务。但是，使用字符串会更复杂。使用整数，您可以比较这两个数字，如果其中一个高于另一个，那么您就会知道存在缺失值。这种直截了当的比较不适用于字符串，除非它们按字母顺序排列并且您只有一个以每个字母开头的字符串。

如果您只是比较每个文件中的行数来确定丢失字符串的总数，那么您会遇到问题，以确定丢失的字符串来自哪个位置，如您的问题中所要求的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:37:19.807

需要进一步简化，但我想它有效：

```
#!/usr/bin/python
import csv

def navigation(iterable):
    iterator = iter(iterable)
    prev = None
    item = iterator.next()

    for next in iterator:
        yield (prev, item, next)
        prev = item
        item = next

    yield (prev, item, None)

with open('input.csv') as csv_input:
    with open('output.csv', 'w') as csv_output:
        old_data = []
        new_data = []

        for row in csv.reader(csv_input):
            old_data += row

        for index, (_prev, item, _next) in enumerate(navigation(old_data)):
            if _next != item:
                if _prev != item:
                    row = [item, 'missing value']
                    new_data.append(row if index % 2 == 0 else row[::-1])
            else:
                new_data.append([item, _next])

        writer = csv.writer(csv_output, delimiter=',', lineterminator='\n')
        writer.writerows(new_data) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:49:26.353

在不知道每列中预期的完整字符串列表的情况下，我认为这无法解决。除此以外，

```
import csv

expected_in_A = set(['a','b','c','d'])
expected_in_B = set(['w','x','y','z'])

def main():
    with open('myfile.csv', 'rb+') as f:
        incsv = csv.reader(f)
        for row in incsv:
            expected_in_A.discard(row[0])
            expected_in_B.discard(row[1])

        # because the file opening mode included '+',
        # and because we have already read to the end of it,
        # we can now simply append to it:
        outcsv = csv.writer(f)
        outcsv.writerows([val, 'value missing'] for val in expected_in_A)
        outcsv.writerows(['value missing', val] for val in expected_in_B)

if __name__=="__main__":
    main() 
```

如果`myfile.csv`包含

```
a,w
b,x
d,z 
```

（在 z 之后有一个回车！）然后它变成

```
a,w
b,x
d,z
c,value missing
value missing,y 
```

# php - 从上传的图像创建缩略图

> ID：11376315
> 
> 赞同：36
> 
> 时间：2012-07-07T15:37:25.927
> 
> 标签：php, image, gd, thumbnails

我想从用户上传的图像创建一个缩略图，这样图像看起来就不会被压扁。但也想要原始图像的副本.. 所以我希望原始图像将原始图像发送到我的服务器，并创建一个拇指版本并将其发送到我的服务器，这样我就可以为每个用户调用它们上传自己的图像。

我的用户表有 2 个表

```
`user_pic` longblob NOT NULL,
`user_pic_small` longblob NOT NULL, 
```

我对编码的图像方面并不感冒，但这就是我到目前为止所拥有的。

图片上传.php

```
> <form id="myForm" action="include/media.profileimage.upload.php"
> method="POST" enctype="multipart/form-data" target="ifr1">
>                   <input type = "file" name = "image_data" class = "input_text" style="width:800px;" >    
>                   <input type = "submit" name = "submit"   class = "btn_login" value = "Upload">
>         </form> 
```

media.profileimage.upload.php

```
if(isset($_FILES['image_data'])){
       if(is_uploaded_file($_FILES['image_data']['tmp_name'])) {

            // prepare the image for insertion
                $imgData =addslashes (file_get_contents($_FILES['image_data']['tmp_name']));

            // get the image info..
              $size = getimagesize($_FILES['image_data']['tmp_name']);

            // our sql query
            $creator_id     =   $_SESSION['id'];
            $sql = "UPDATE users SET user_pic='".$imgData."' WHERE id=$creator_id";
            $sql2 = "INSERT INTO userphotos(photo_ownerid,photo_ispublic, photo_name, photo_caption, photo_imagedata) VALUES ($creator_id,1,'Profile Picture','Profile Picture','$imgData')";

            // insert the image
            if(!mysql_query($sql)) {
                echo "Fail. It broke.";
            }else{
            $c=mysql_query($sql2);

                echo "<script> parent.alert('Image Uploaded','',1000);</script>";
            }
        }
    } 
```

将不胜感激任何帮助或指导。谢谢

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-07-07T15:44:44.830

更新：

如果您想利用 Imagick（如果它安装在您的服务器上）。注意：我没有使用 Imagick 的特性`writeFile`，因为我在服务器上遇到了问题。文件放置内容同样有效。

```
<?php
/**
 * 
 * Generate Thumbnail using Imagick class
 *  
 * @param string $img
 * @param string $width
 * @param string $height
 * @param int $quality
 * @return boolean on true
 * @throws Exception
 * @throws ImagickException
 */
function generateThumbnail($img, $width, $height, $quality = 90)
{
    if (is_file($img)) {
        $imagick = new Imagick(realpath($img));
        $imagick->setImageFormat('jpeg');
        $imagick->setImageCompression(Imagick::COMPRESSION_JPEG);
        $imagick->setImageCompressionQuality($quality);
        $imagick->thumbnailImage($width, $height, false, false);
        $filename_no_ext = reset(explode('.', $img));
        if (file_put_contents($filename_no_ext . '_thumb' . '.jpg', $imagick) === false) {
            throw new Exception("Could not put contents.");
        }
        return true;
    }
    else {
        throw new Exception("No valid image provided with {$img}.");
    }
}

// example usage
try {
    generateThumbnail('test.jpg', 100, 50, 65);
}
catch (ImagickException $e) {
    echo $e->getMessage();
}
catch (Exception $e) {
    echo $e->getMessage();
}
?> 
```

* * *

我一直在使用它，只需在存储原始图像并使用该位置创建缩略图后执行该功能。根据自己的喜好编辑...

```
function makeThumbnails($updir, $img, $id)
{
    $thumbnail_width = 134;
    $thumbnail_height = 189;
    $thumb_beforeword = "thumb";
    $arr_image_details = getimagesize("$updir" . $id . '_' . "$img"); // pass id to thumb name
    $original_width = $arr_image_details[0];
    $original_height = $arr_image_details[1];
    if ($original_width > $original_height) {
        $new_width = $thumbnail_width;
        $new_height = intval($original_height * $new_width / $original_width);
    } else {
        $new_height = $thumbnail_height;
        $new_width = intval($original_width * $new_height / $original_height);
    }
    $dest_x = intval(($thumbnail_width - $new_width) / 2);
    $dest_y = intval(($thumbnail_height - $new_height) / 2);
    if ($arr_image_details[2] == IMAGETYPE_GIF) {
        $imgt = "ImageGIF";
        $imgcreatefrom = "ImageCreateFromGIF";
    }
    if ($arr_image_details[2] == IMAGETYPE_JPEG) {
        $imgt = "ImageJPEG";
        $imgcreatefrom = "ImageCreateFromJPEG";
    }
    if ($arr_image_details[2] == IMAGETYPE_PNG) {
        $imgt = "ImagePNG";
        $imgcreatefrom = "ImageCreateFromPNG";
    }
    if ($imgt) {
        $old_image = $imgcreatefrom("$updir" . $id . '_' . "$img");
        $new_image = imagecreatetruecolor($thumbnail_width, $thumbnail_height);
        imagecopyresized($new_image, $old_image, $dest_x, $dest_y, 0, 0, $new_width, $new_height, $original_width, $original_height);
        $imgt($new_image, "$updir" . $id . '_' . "$thumb_beforeword" . "$img");
    }
} 
```

上述函数创建具有统一缩略图大小的图像。如果图像的尺寸与指定的缩略图大小（按比例）不同，则它的顶部和底部只有空白。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2017-06-02T07:18:46.203

**您可以使用最简单的方法**

```
<?php
function make_thumb($src, $dest, $desired_width) {

    /* read the source image */
    $source_image = imagecreatefromjpeg($src);
    $width = imagesx($source_image);
    $height = imagesy($source_image);

    /* find the "desired height" of this thumbnail, relative to the desired width  */
    $desired_height = floor($height * ($desired_width / $width));

    /* create a new, "virtual" image */
    $virtual_image = imagecreatetruecolor($desired_width, $desired_height);

    /* copy source image at a resized size */
    imagecopyresampled($virtual_image, $source_image, 0, 0, 0, 0, $desired_width, $desired_height, $width, $height);

    /* create the physical thumbnail image to its destination */
    imagejpeg($virtual_image, $dest);
}

$src="1494684586337H.jpg";
$dest="new.jpg";
$desired_width="200";
make_thumb($src, $dest, $desired_width);
?> 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2013-01-09T20:46:45.253

我猜你已经弄清楚了这一点。但是我看到您将图像存储为“longblob”，这使我认为您正在存储图片的整个二进制内容。

我希望您已经意识到将文件名简单地存储在您的数据库中然后使用该信息从“上传”文件夹或类似文件夹中获取图片更有意义。

提示 - 不要保存文件路径.. 只是文件名.. 根据需要在代码中添加路径信息。这样你就有了最大的自由。如果您需要更改文件夹结构，您可以在代码中完成，而不是更改数据库记录。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-08-07T14:21:23.367

我知道这是一个老问题，但我偶然发现了同样的问题并尝试使用 Alex 的答案中给出的函数。

但是 jpeg 结果的质量太低了。因此，我稍微更改了该功能以使其在我的项目中更有用，并将“imagecopyresized”更改为“imagecopyresampled”（[根据此建议](https://stackoverflow.com/a/3389088)）。

如果您对如何使用此功能有疑问，请尝试在[此处](https://gist.github.com/pedroppinheiro/7a039da05fd9a1bc4182)查看文档完善的版本。

```
function createThumbnail($filepath, $thumbpath, $thumbnail_width, $thumbnail_height, $background=false) {
    list($original_width, $original_height, $original_type) = getimagesize($filepath);
    if ($original_width > $original_height) {
        $new_width = $thumbnail_width;
        $new_height = intval($original_height * $new_width / $original_width);
    } else {
        $new_height = $thumbnail_height;
        $new_width = intval($original_width * $new_height / $original_height);
    }
    $dest_x = intval(($thumbnail_width - $new_width) / 2);
    $dest_y = intval(($thumbnail_height - $new_height) / 2);

    if ($original_type === 1) {
        $imgt = "ImageGIF";
        $imgcreatefrom = "ImageCreateFromGIF";
    } else if ($original_type === 2) {
        $imgt = "ImageJPEG";
        $imgcreatefrom = "ImageCreateFromJPEG";
    } else if ($original_type === 3) {
        $imgt = "ImagePNG";
        $imgcreatefrom = "ImageCreateFromPNG";
    } else {
        return false;
    }

    $old_image = $imgcreatefrom($filepath);
    $new_image = imagecreatetruecolor($thumbnail_width, $thumbnail_height); // creates new image, but with a black background

    // figuring out the color for the background
    if(is_array($background) && count($background) === 3) {
      list($red, $green, $blue) = $background;
      $color = imagecolorallocate($new_image, $red, $green, $blue);
      imagefill($new_image, 0, 0, $color);
    // apply transparent background only if is a png image
    } else if($background === 'transparent' && $original_type === 3) {
      imagesavealpha($new_image, TRUE);
      $color = imagecolorallocatealpha($new_image, 0, 0, 0, 127);
      imagefill($new_image, 0, 0, $color);
    }

    imagecopyresampled($new_image, $old_image, $dest_x, $dest_y, 0, 0, $new_width, $new_height, $original_width, $original_height);
    $imgt($new_image, $thumbpath);
    return file_exists($thumbpath);
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-02-01T16:12:59.530

以防万一您需要创建具有最大宽度和最大高度的拇指...

```
function makeThumbnails($updir, $img, $id,$MaxWe=100,$MaxHe=150){
    $arr_image_details = getimagesize($img); 
    $width = $arr_image_details[0];
    $height = $arr_image_details[1];

    $percent = 100;
    if($width > $MaxWe) $percent = floor(($MaxWe * 100) / $width);

    if(floor(($height * $percent)/100)>$MaxHe)  
    $percent = (($MaxHe * 100) / $height);

    if($width > $height) {
        $newWidth=$MaxWe;
        $newHeight=round(($height*$percent)/100);
    }else{
        $newWidth=round(($width*$percent)/100);
        $newHeight=$MaxHe;
    }

    if ($arr_image_details[2] == 1) {
        $imgt = "ImageGIF";
        $imgcreatefrom = "ImageCreateFromGIF";
    }
    if ($arr_image_details[2] == 2) {
        $imgt = "ImageJPEG";
        $imgcreatefrom = "ImageCreateFromJPEG";
    }
    if ($arr_image_details[2] == 3) {
        $imgt = "ImagePNG";
        $imgcreatefrom = "ImageCreateFromPNG";
    }

    if ($imgt) {
        $old_image = $imgcreatefrom($img);
        $new_image = imagecreatetruecolor($newWidth, $newHeight);
        imagecopyresized($new_image, $old_image, 0, 0, 0, 0, $newWidth, $newHeight, $width, $height);

       $imgt($new_image, $updir."".$id."_t.jpg");
        return;    
    }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-10-10T04:16:31.057

希望此代码有助于为 JPG、PNG 和 GIF 格式创建缩略图。

```
<?php

    $file = "D:/server/sites/Sourcefol/high/bucket/kath23.png";   /*Your Original Source Image */
    $pathToSave = "D:/server/sites/Sourcefol/high/bucket/New/"; /*Your Destination Folder */
    $sourceWidth =60;
    $sourceHeight = 60;
    $what = getimagesize($file);
    $file_name = basename($file);/* Name of the Image File*/
    $ext   = pathinfo($file_name, PATHINFO_EXTENSION);

    /* Adding image name _thumb for thumbnail image */
    $file_name = basename($file_name, ".$ext") . '_thumb.' . $ext;

    switch(strtolower($what['mime']))
    {
        case 'image/png':
            $img = imagecreatefrompng($file);
            $new = imagecreatetruecolor($what[0],$what[1]);
            imagecopy($new,$img,0,0,0,0,$what[0],$what[1]);
            header('Content-Type: image/png');           
        break;
        case 'image/jpeg':
            $img = imagecreatefromjpeg($file);
            $new = imagecreatetruecolor($what[0],$what[1]);
            imagecopy($new,$img,0,0,0,0,$what[0],$what[1]);
            header('Content-Type: image/jpeg');
        break;
        case 'image/gif':
            $img = imagecreatefromgif($file);
            $new = imagecreatetruecolor($what[0],$what[1]);
            imagecopy($new,$img,0,0,0,0,$what[0],$what[1]);
            header('Content-Type: image/gif');
        break;
        default: die();
    }

        imagejpeg($new,$pathToSave.$file_name);
        imagedestroy($new);

?> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-06-11T11:51:09.620

# 带缩略图生成的图像上传

## 上传.php

```
<?php
function generate_thumb_now($field_name = '',$target_folder ='',$file_name = '', $thumb = FALSE, $thumb_folder = '', $thumb_width = '',$thumb_height = ''){
         //folder path setup
         $target_path = $target_folder;
         $thumb_path = $thumb_folder;   
         //file name setup
    $filename_err = explode(".",$_FILES[$field_name]['name']);
    $filename_err_count = count($filename_err);
    $file_ext = $filename_err[$filename_err_count-1];
     if($file_name != '')
     {
        $fileName = $file_name.'.'.$file_ext;
      }
    else
    {
        $fileName = $_FILES[$field_name]['name'];
    }   
    //upload image path
    $upload_image = $target_path.basename($fileName);   
    //upload image
    if(move_uploaded_file($_FILES[$field_name]['tmp_name'],$upload_image))
    {
         //thumbnail creation
        if($thumb == TRUE)
        {
            $thumbnail = $thumb_path.$fileName;
            list($width,$height) = getimagesize($upload_image);
            $thumb_create = imagecreatetruecolor($thumb_width,$thumb_height);
            switch($file_ext){
                case 'jpg':
                    $source = imagecreatefromjpeg($upload_image);
                    break;
                case 'jpeg':
                    $source = imagecreatefromjpeg($upload_image);
                    break;
                case 'png':
                    $source = imagecreatefrompng($upload_image);
                    break;
                case 'gif':
                    $source = imagecreatefromgif($upload_image);
                     break;
                default:
                    $source = imagecreatefromjpeg($upload_image);
            }
       imagecopyresized($thumb_create, $source, 0, 0, 0, 0, $thumb_width, $thumb_height, $width,$height);
            switch($file_ext){
                case 'jpg' || 'jpeg':
                    imagejpeg($thumb_create,$thumbnail,100);
                    break;
                case 'png':
                    imagepng($thumb_create,$thumbnail,100);
                    break;
                case 'gif':
                    imagegif($thumb_create,$thumbnail,100);
                     break;
                default:
                    imagejpeg($thumb_create,$thumbnail,100);
            }
        }
        return $fileName;
     }
    else
    {
        return false;
     }
    }
    if(!empty($_FILES['image']['name'])){       
    $upload_img = generate_thumb_now('image','uploads/','',TRUE,'uploads /thumbs/','400','320');

    //full path of the thumbnail image
    $thumb_src = 'uploads/thumbs/'.$upload_img;

    //set success and error messages
    $message = $upload_img?"<span style='color:#008000;'>Image thumbnail created successfully.</span>":"<span style='color:#F00000;'>Some error occurred, please try again.</span>";

    }else{

    //if form is not submitted, below variable should be blank
    $thumb_src = '';
    $message = '';
    }
    ?>

    <html>
    <head>Image upload and generate thumbnail</head>
     <body>
     <div class="messages"><?php echo $message; ?></div>
      <form method="post" enctype="multipart/form-data">
      <input type="file" name="image"/>
      <input type="submit" name="submit" value="Upload"/>
    </form>
    <?php if($thumb_src != ''){ ?>
    <div class="gallery">
    <ul>
        <li><img src="<?php echo $thumb_src; ?>" alt=""></li>
    </ul>
   </div>
    <?php } ?>
    </body>
    </html> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-01-20T15:36:57.603

```
function getExtension($str) 
    {

          $i = strrpos($str,".");
         if (!$i) { return ""; } 

         $l = strlen($str) - $i;
         $ext = substr($str,$i+1,$l);
         return $ext;
    }

$valid_formats = array("jpg", "png", "gif", "bmp","jpeg","PNG","JPG","JPEG","GIF","BMP");
if(isset($_POST) and $_SERVER['REQUEST_METHOD'] == "POST")
    {
        $name = $_FILES['photoimg']['name'];
        $size = $_FILES['photoimg']['size'];

        if(strlen($name))
            {
                 $ext = getExtension($name);
                if(in_array($ext,$valid_formats))
                {
                if($size<(1024*1024))
                    {
                        $actual_image_name = time().substr(str_replace(" ", "_", $txt), 5).".".$ext;
                        $tmp = $_FILES['photoimg']['tmp_name'];
                        if(move_uploaded_file($tmp, $path.$actual_image_name))
                            {

                            mysql_query("INSERT INTO users (uid, profile_image) VALUES ('$session_id' , '$actual_image_name')");

                                echo "<img src='uploads/".$actual_image_name."'  class='preview'>";
                            }
                        else
                            echo "Fail upload folder with read access.";
                    }
                    else
                    echo "Image file size max 1 MB";                    
                    }
                    else
                    echo "Invalid file format..";   
            }

        else
            echo "Please select image..!";

        exit;
    } 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2016-10-26T06:17:47.110

```
<?php 
error_reporting(0);

$change="";
$abc="";

 define ("MAX_SIZE","4000");
 function getExtension($str) {
         $i = strrpos($str,".");
         if (!$i) { return ""; }
         $l = strlen($str) - $i;
         $ext = substr($str,$i+1,$l);
         return $ext;
 }

 $errors=0;

 if($_SERVER["REQUEST_METHOD"] == "POST")
 {
    $image =$_FILES["file"]["name"];
    $uploadedfile = $_FILES['file']['tmp_name'];

    if ($image) 
    {

        $filename = stripslashes($_FILES['file']['name']);

        $extension = getExtension($filename);
        $extension = strtolower($extension);

 if (($extension != "jpg") && ($extension != "jpeg") && ($extension != "png") && ($extension != "gif")) 
        {

            $change='<div class="msgdiv">Unknown Image extension </div> ';
            $errors=1;
        }
        else
        {

 $size=filesize($_FILES['file']['tmp_name']);

if ($size > MAX_SIZE*1024)
{
    $change='<div class="msgdiv">You have exceeded the size limit!</div> ';
    $errors=1;
}

if($extension=="jpg" || $extension=="jpeg" )
{
$uploadedfile = $_FILES['file']['tmp_name'];
$src = imagecreatefromjpeg($uploadedfile);

}
else if($extension=="png")
{
$uploadedfile = $_FILES['file']['tmp_name'];
$src = imagecreatefrompng($uploadedfile);

}
else 
{
$src = imagecreatefromgif($uploadedfile);
}

echo $scr;

list($width,$height)=getimagesize($uploadedfile);

$newwidth=45;
$newheight=45;
$tmp=imagecreatetruecolor($newwidth,$newheight);

$newwidth1=90;
$newheight1=90;
$tmp1=imagecreatetruecolor($newwidth1,$newheight1);

$tmp2=imagecreatetruecolor($width,$height);
imagecopyresampled($tmp,$src,0,0,0,0,$newwidth,$newheight,$width,$height);

imagecopyresampled($tmp1,$src,0,0,0,0,$newwidth1,$newheight1,$width,$height);

imagecopyresampled($tmp2,$src,0,0,0,0,$width,$height,$width,$height);

$filename = "images/1-". $_FILES['file']['name']=time();

$filename1 = "images/2-". $_FILES['file']['name']=time();

$filename2 = "images/3-". $_FILES['file']['name']=time();

imagejpeg($tmp,$filename,100);

imagejpeg($tmp1,$filename1,100);

imagejpeg($tmp2,$filename2,100);

imagedestroy($src);
imagedestroy($tmp);
imagedestroy($tmp1);
}}

}
 if(isset($_POST['Submit']) && !$errors) 
 {

   // mysql_query("update {$prefix}users set img='$big',img_small='$small' where user_id='$user'");
    $change=' <div class="msgdiv">Image Uploaded Successfully!</div>';
 }

?>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>
    <title>picture demo</title>

   <link href=".css" media="screen, projection" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.0/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery_002.js"></script>
<script type="text/javascript" src="js/displaymsg.js"></script>
<script type="text/javascript" src="js/ajaxdelete.js"></script>

  <style type="text/css">
  .help
{
font-size:11px; color:#006600;
}
body {
     color: #000000;
 background-color:#999999 ;
    background:#999999 url(<?php echo $user_row['img_src']; ?>) fixed repeat top left;

    font-family:"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif; 

    }
        .msgdiv{
    width:759px;
padding-top:8px;
padding-bottom:8px;
background-color: #fff;
font-weight:bold;
font-size:18px;-moz-border-radius: 6px;-webkit-border-radius: 6px;
}
#container{width:763px;margin:0 auto;padding:3px 0;text-align:left;position:relative; -moz-border-radius: 6px;-webkit-border-radius: 6px; background-color:#FFFFFF }
</style>

  </head><body>
     <div align="center" id="err">
<?php echo $change; ?>  </div>
   <div id="space"></div>

  <div id="container" >

   <div id="con">

        <table width="502" cellpadding="0" cellspacing="0" id="main">
          <tbody>
            <tr>
              <td width="500" height="238" valign="top" id="main_right">

              <div id="posts">
              &nbsp;&nbsp;&nbsp;&nbsp;<img src="<?php// echo $filename; ?>" />  &nbsp;&nbsp;&nbsp;&nbsp;<img src="<?php// echo $filename1; ?>"  />
                <form method="post" action="" enctype="multipart/form-data" name="form1">
                <table width="500" border="0" align="center" cellpadding="0" cellspacing="0">
               <tr><Td style="height:25px">&nbsp;</Td></tr>
        <tr>
          <td width="150"><div align="right" class="titles">Picture 
            : </div></td>
          <td width="350" align="left">
            <div align="left">
              <input size="25" name="file" type="file" style="font-family:Verdana, Arial, Helvetica, sans-serif; font-size:10pt" class="box"/>

              </div></td>

        </tr>
        <tr><Td></Td>
        <Td valign="top" height="35px" class="help">Image maximum size <b>4000 </b>kb</span></Td>
        </tr>
        <tr><Td></Td><Td valign="top" height="35px"><input type="submit" id="mybut" value="       Upload        " name="Submit"/></Td></tr>
        <tr>
          <td width="200">&nbsp;</td>
          <td width="200"><table width="200" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td width="200" align="center"><div align="left"></div></td>
                <td width="100">&nbsp;</td>
              </tr>
          </table></td>
        </tr>
      </table>
    </form>
 </div>
            </td>

        </tr>
          </tbody>
     </table>
   </div>

  </div>

</body></html> 
```

# android - Android getAuthToken 返回一个空令牌

> ID：11376316
> 
> 赞同：0
> 
> 时间：2012-07-07T15:37:48.313
> 
> 标签：android, oauth-2.0

好吧，我需要为用户授权 Google 日历的访问权限，当我使用时，第一个 google Id 工作正常

```
blockingGetAuthToken 
```

它得到一个令牌，我通常登录这个令牌。因此，当我尝试使用其他帐户时，我得到了一个空令牌。我进行了很多搜索，发现 using`getAuthToken`是首选，因为它使用调用它的活动的上下文。然后我将整个过程转换为使用它

```
 private static final String AUTH_TOKEN_TYPE = "oauth2:https://www.googleapis.com/auth/calendar";

public static String authorize(AndroidtestActivity parent, Account account) {
    AccountManager accountManager = AccountManager.get(parent);
    Bundle options= new Bundle();

    Log.d("MyAPP", "Get Authorization");
    try {
        AccountManagerFuture<Bundle> acc=accountManager.getAuthToken ( account, AUTH_TOKEN_TYPE,  options, true, null, null);
        Bundle authTokenBundle = acc.getResult();
        String authToken = authTokenBundle.get(AccountManager.KEY_AUTHTOKEN).toString();

        Log.d("MyAPP","Token= "+authToken);
        return authToken;

    } catch (Exception ex) {
        Logger.getLogger(GoogleAuthorize.class.getName()).log(Level.SEVERE,
                null, ex);
    }
    return null;
} 
```

}

但仍然没有帐户可以获得有效的令牌，他们都得到一个空的

然后我看到了这个答案[https://stackoverflow.com/a/2021337/1280902](https://stackoverflow.com/a/2021337/1280902) 并随后使用`invalidateAuthToken`

```
private static final String AUTH_TOKEN_TYPE = "oauth2:https://www.googleapis.com/auth/calendar";

public static String authorize(AndroidtestActivity parent, Account account) {
    AccountManager accountManager = AccountManager.get(parent);
    Bundle options= new Bundle();

    Log.d("MyAPP", "Get Authorization");
    try {
        AccountManagerFuture<Bundle> acc=accountManager.getAuthToken ( account, AUTH_TOKEN_TYPE,  options, true, null, null);
        Bundle authTokenBundle = acc.getResult();
        String authToken = authTokenBundle.get(AccountManager.KEY_AUTHTOKEN).toString();
        accountManager.invalidateAuthToken("com.google",authToken);
        acc=accountManager.getAuthToken ( account, AUTH_TOKEN_TYPE,  options, true, null, null);
        authTokenBundle = acc.getResult();
        authToken = authTokenBundle.get(AccountManager.KEY_AUTHTOKEN).toString();

        Log.d("MyAPP","Token= "+authToken);
        return authToken;

    } catch (Exception ex) {
        Logger.getLogger(GoogleAuthorize.class.getName()).log(Level.SEVERE,
                null, ex);
    }
    return null;
} 
```

}

但是我在使用的每个帐户上都遇到了同样的问题，即使是一开始使用的那个`blockingGetAuthToken`

所以我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:43:03.570

好的，当我使用时它工作正常

```
getAuthToken (Account account, String authTokenType, Bundle options, Activity activity, AccountManagerCallback<Bundle> callback, Handler handler) 
```

活动参数解决了问题..

# php - 如何安装下载的 Doctrine 2.2 ORM 版本

> ID：11376317
> 
> 赞同：0
> 
> 时间：2012-07-07T15:37:52.237
> 
> 标签：php, orm, doctrine, doctrine-orm, autoload

我已经下载了最新版本的 Doctrine ORM，在他们的网站上它说：“请参阅配置部分，了解如何配置和引导下载的 Doctrine 版本。”

然后我去那里（[http://docs.doctrine-project.org/en/latest/reference/configuration.html](http://docs.doctrine-project.org/en/latest/reference/configuration.html)），我在“类加载”部分找到，我必须将以下行添加到我的项目中：

```
require_once "vendor/autoload.php"; 
```

autoload.php 文件在哪里？供应商文件夹在哪里？我不明白...谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T15:50:19.320

当您下载“最新版本”时，它包含该自动加载文件。在下载中找到它并将 require_once 函数中的文件路径更改为文件的路径：

```
require_once "/location/of/files/you/downloaded/vendor/autoload.php"; 
```

正如您在此处的页面上看到的大约 400px，您需要先使用 PEAR 安装文件：

[http://www.doctrine-project.org/projects/orm.html](http://www.doctrine-project.org/projects/orm.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T04:20:30.753

您可以通过先安装作曲家来做到这一点。按照此页面[http://getcomposer.org/doc/00-intro.md](http://getcomposer.org/doc/00-intro.md)中的指南进行操作。有一个针对 Windows 和 Unix 用户的描述，这将安装 composer，然后创建一个如下所示的 json 文件：

```
{
  "require": {
      "doctrine/orm": "2.*",
      "symfony/yaml": "2.*"
  },
  "autoload": {
      "psr-0": {"": "src/"}
  }
} 
```

然后从 cmd/终端，运行以下命令：`composer install`

您会发现该`vendor`文件夹是自动创建的。

# php - 将表单值存储在会话数组中

> ID：11376320
> 
> 赞同：0
> 
> 时间：2012-07-07T15:38:04.863
> 
> 标签：php, arrays, session

在 page1.php 中，用户可以输入日期名称并将其存储在名为 days 的会话数组中。

```
<?
// starting the session
session_start(); 

if (isset($_POST['submit'])) { 
    $_SESSION['days'] = $_POST['days'];
} 
?> 

<strong>Add a day</strong>
<form action="" method"post">
    <input type="text" name="days[]"/>
    <input type="submit" name="submit" value="Submit!" />
</form>
<p><a href="/test/page2.php">Page 2</a></p> 
```

在 page2.php 中，用户可以检查它输入的日期：

```
<?php
session_start();
// loop through the session array with foreach
foreach($_SESSION['days'] as $key=>$value)
    {
    // and print out the values
    echo 'The value of $_SESSION['."'".$key."'".'] is '."'".$value."'".' <br />';
    }
?> 
```

但我无法使会话连接正确，它只是空白。这是处理数组会话的正确方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:41:12.930

您忘记了 page2.php 中的 session_start() 和 $_SESSION != $_session

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T15:42:13.427

你不会忘记第二页的 session_start() 吗？

另外，为什么不将值发布到第二页并使用 $_POST 而不是先将它们放入会话中？

# java - 谁能告诉我为什么在使用 SSL 时出现 Java 错误？

> ID：11376323
> 
> 赞同：0
> 
> 时间：2012-07-07T15:38:19.967
> 
> 标签：java, sockets, ssl, applet

我一直在尝试在 Cpp 服务器和 Java 小程序客户端之间建立连接，但是当我运行小程序时，我在浏览器中收到此错误。我在信任存储文件中有证书（如果不需要，请告诉我）。任何帮助，将不胜感激。

> 拒绝访问（“java.util.propertypermission”“javax.net.ssl.truststore”“write”）

```
import java.awt.*;
import java.applet.*;
import javax.net.ssl.SSLSocket;
import javax.net.ssl.SSLSocketFactory;
import java.io.*;
import javax.swing.*;

public class no2 extends Applet {

   int width, height;

   public void init() {

        System.setProperty("javax.net.ssl.trustStore", "keystore.jks"); 
        System.setProperty("javax.net.ssl.trustStorePassword", "changeit"); 

        String trustStore = System.getProperty("javax.net.ssl.trustStore"); 
        if (trustStore == null) { 
            System.out.println("javax.net.ssl.trustStore is not defined"); 
        } else { 
            System.out.println("javax.net.ssl.trustStore = " + trustStore); 
        } 

        try {

        PrintWriter toServer = null;
        BufferedReader fromServer = null;

        SSLSocketFactory sslsocketfactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
        SSLSocket sslsocket = (SSLSocket) sslsocketfactory.createSocket("192.168.0.10", 12120);

        String[] newProtocols = {"TLSv1"};
        sslsocket.setEnabledProtocols(newProtocols);

        toServer = new PrintWriter(sslsocket.getOutputStream(), true);

        toServer.println("Data1\n");
        toServer.println("Data2\n");

        InputStreamReader isr = new InputStreamReader(sslsocket.getInputStream());
        fromServer = new BufferedReader(isr, 1);

        } catch (Exception exception) {

            exception.printStackTrace();
        }
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:39:37.437

您不能在 Applet 中设置系统属性。您也无法访问本地文件 (keystore.jks) 系统（除非您请求特定权限）。

您可以将特殊参数传递给 JVM，如[文档](http://docs.oracle.com/javase/6/docs/technotes/guides/jweb/applet/applet_deployment.html)中所述：

```
<APPLET archive="my_applet.jar" code="MyApplet" width="300" height="300">
    <PARAM name="java_arguments" value="-Djavax.net.ssl.trustStore=keystore.jks">
</APPLET> 
```

但同样，请注意访问本地文件所需的特殊权限。

# iphone - XCODE 如何：将按钮移动到另一个视图

> ID：11376325
> 
> 赞同：0
> 
> 时间：2012-07-07T15:39:00.467
> 
> 标签：iphone, xcode, animation

我有一个包含 2 个按钮（视频、歌曲）的主视图

单击时如何使视频按钮移至视频视图，以及将歌曲按钮移至歌曲视图时如何？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:07:59.170

您可以使用`[videoBtn removeFromSuperView];`并添加一行`[videoView addSubView:videoBtn];`

在这里您可能需要再次设置 videoBtn 帧以进行相应调整。

# java - ThreadLocal 和 SimpleDateFormat 数组

> ID：11376328
> 
> 赞同：3
> 
> 时间：2012-07-07T15:39:05.650
> 
> 标签：java, thread-safety, simpledateformat, thread-local

[使用与最近一个问题](https://stackoverflow.com/questions/10491135/threadlocal-for-multithreaded-access-to-simpledateformat)中描述的模式非常相似的模式，对于多线程应用程序，我得到了奇怪的日期值（例如，像 2025 或 2035 这样的年份，而源数据中显然不存在这样的值）。似乎正在发生并发问题。

源代码看起来像

```
// Various Java DateFormat patterns, e.g. "yyyy-MM-dd".
private static final String[] DATE_PATTERNS = new String[] {...};

private static SimpleDateFormat[] getFormats(final String[] patterns)
{
    ThreadLocal<SimpleDateFormat[]> LOCAL_FORMATS = new ThreadLocal<SimpleDateFormat[]>()
    {
        @Override
        protected SimpleDateFormat[] initialValue()
        {
            List<SimpleDateFormat> formatList = new ArrayList<SimpleDateFormat>();

            for (String pattern:patterns)
            {
                formatList.add(new SimpleDateFormat(pattern));
            }

            return formatList.toArray(new SimpleDateFormat[formatList.size()]);
        }
    };

    return LOCAL_FORMATS.get(); // Create a thread-local copy
}

private static final SimpleDateFormat[] DATE_FORMATS = getFormats(DATE_PATTERNS); 
```

在其静态初始化之后，`DATE_FORMATS`数组被许多类访问，这些类又使用`SimpleDateFormat`数组的对象来解析或格式化多个日期字符串。

在这种使用场景中是否存在任何并发问题，尤其是考虑到使用`ThreadLocal`?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T16:03:49.257

是的，可能存在并发问题。您的线程局部变量没有任何用途。它仅在类初始化时使用，用于临时存储日期格式数组，该数组会立即检索并存储在静态常量中。

之后，所有线程总是同时使用相同的日期格式实例，而不是从任何线程局部变量中获取它们。

代码应该是：

```
private static final String[] DATE_PATTERNS = new String[] {...};
private static final ThreadLocal<SimpleDateFormat[]> DATE_FORMATS = 
    new ThreadLocal<SimpleDateFormat[]>() {
        @Override
        protected SimpleDateFormat[] initialValue() {
            List<SimpleDateFormat> formatList = new ArrayList<SimpleDateFormat>();

            for (String pattern : DATE_PATTERNS)
            {
                formatList.add(new SimpleDateFormat(pattern));
            }

            return formatList.toArray(new SimpleDateFormat[formatList.size()]);
        }
    };

public static SimpleDateFormat[] getDateFormats() {
    return DATE_FORMATS.get();
} 
```

为了更安全，我还会使用不可修改的`List<SimpleDateFormat>`而不是数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T15:56:43.563

```
// Various Java DateFormat patterns, e.g. "yyyy-mm-dd". 
```

'yyyy-mm-dd' 格式可能会给您带来奇怪的结果，因为 'mm' 是分钟而不是月。从javadoc：

```
M   Month in year   Month   July; Jul; 07
...
m   Minute in hour  Number  30 
```

# image - ASIHttpRequest 上传图片

> ID：11376330
> 
> 赞同：0
> 
> 时间：2012-07-07T15:39:23.670
> 
> 标签：image, cocoa, upload, asihttprequest, yfrog

嘿，我有一个带有以下代码的 mac 应用程序：

```
 NSURL *url;
        url = [NSURL URLWithString:@"http://yfrog.com/api/xauth_upload"];

        ASIFormDataRequest *request = [[[ASIFormDataRequest alloc] initWithURL:url] autorelease];

        [request setDelegate:self];
        [request setUseCookiePersistence:NO];
        [request setUploadProgressDelegate:self];
        [request showAccurateProgress]; 
        [request signRequestWithClientIdentifier:@"w" secret:@"x" tokenIdentifier:@"y" secret:@"z" usingMethod:ASIOAuthHMAC_SHA1SignatureMethod];
        [request setPostValue:@"a" forKey:@"key"];
    NSData *imageData = [[NSData alloc]initWithContentsOfFile:[draggedFilenames objectAtIndex:0]];
    [request setPostValue:imageData forKey:@"media"];

        [request startAsynchronous]; 
```

但问题是我总是从 yfrog 服务器得到这个响应：

所以图片上传有问题。在 iPhone 上它是这样工作的：

```
[request setData:UIImageJPEGRepresentation(picture, 0.8) withFileName:@"filename.jpg" andContentType:@"image/jpeg" forKey:@"media"]; 
```

但这不起作用 cocoa(mac) 因为没有像 UIIMageJPEGRepresentation 这样的方法。身份验证也有效，这不是问题。如果您向您询问此方法 signRequestWithClientIdentifier 它来自此处的 asihttprequest+oauth 包装器： [https ://github.com/keybuk/asi-http-request-oauth](https://github.com/keybuk/asi-http-request-oauth)

那么如何正确上传图片呢？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:56:08.303

```
NSData* NSImageJPEGRepresentation(NSImage* image, CGFloat compressionQuality)
{
    if(nil == image)return nil;
    NSDictionary *dict;
    dict = [NSDictionary dictionaryWithObjectsAndKeys:
            [NSNumber numberWithFloat:compressionQuality],
            NSImageCompressionFactor,
            nil];

    NSBitmapImageRep* imageRep;
    imageRep = [NSBitmapImageRep imageRepWithData:[image TIFFRepresentation]];
    return [imageRep representationUsingType:NSJPEGFileType 
                                  properties:dict];
} 
```

# google-calendar-api - 谷歌日历和谷歌任务有什么区别？

> ID：11376333
> 
> 赞同：3
> 
> 时间：2012-07-07T15:39:37.610
> 
> 标签：google-calendar-api, google-tasks-api

我很困惑 Google Task 和 Google Calendar 有什么区别？

最初我以为我想使用 Google 日历，但现在我意识到我想使用 Google Task。

他们甚至有不同的 API。这让我很困惑：

谷歌任务 API：[http ://code.google.com/p/google-api-dotnet-client/wiki/APIs#Tasks_API](http://code.google.com/p/google-api-dotnet-client/wiki/APIs#Tasks_API)

谷歌日历 API：[https ://developers.google.com/google-apps/calendar/v2/developers_guide_dotnet](https://developers.google.com/google-apps/calendar/v2/developers_guide_dotnet)

它们之间有什么区别？

# linux - 如何在 Linux shell 脚本中声明？

> ID：11376338
> 
> 赞同：0
> 
> 时间：2012-07-07T15:40:00.293
> 
> 标签：linux, shell

我想在 shell 脚本中声明：proxy_set

```
declare -x https_proxy="https://192.168.220.4:8080/" 
```

然后我像下面一样执行它。

```
$ ./proxy_set 
```

但“出口”表明什么也没发生。

以另一种方式，如果我这样执行它：

```
$ source proxy_set 
```

然后“导出”显示它有效！

我的问题是如何在没有额外的“源”cmd 的情况下使其工作？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T15:45:49.143

你不能。在环境中设置变量只会影响该外壳的环境以及它产生的任何未来的孩子；没有办法影响父外壳。当您在没有`source`(or `.`) 的情况下运行它时，会启动一个全新的 shell，然后在该 shell 的环境中设置变量，然后该 shell 退出，并带上它的环境。

读取命令并在当前 shell 中执行它们，`source`就像您键入它们一样。

所以如果你想在脚本中设置环境变量，你必须这样`source`做。或者，您可以让命令生成 shell 命令作为输出而不是运行它们，然后父级可以评估命令的输出。像`ssh-agent`使用这种方法的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T15:48:17.743

尝试添加：

```
export https_proxy="https://192.168.220.4:8080/" 
```

然后正常执行你的脚本。

# android - Error on creating a menu when menu button clicked on android

> ID：11376339
> 
> 赞同：0
> 
> 时间：2012-07-07T15:40:05.737
> 
> 标签：android, android-layout, android-intent

I want a menu when I click the menu button on an android device and I have created a method and other stuff in this. It was on another project bt I took the code and adapted it into my new project! earlier it worked fine bt, now the activity force closes! I could'nt find the error! please help me!

the method ---->

```
@Override
public boolean onMenuItemSelected(int featureId, MenuItem item) {
    // TODO Auto-generated method stub
    switch (item.getItemId()) {
    case R.id.about:
        Intent contextmenu = new Intent("com.sliit.droidman.main.About");
        startActivity(contextmenu);
        break;
    case R.id.exit:
        finish();
        break;
    }
    return false;
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // TODO Auto-generated method stub
    MenuInflater droidmenu = getMenuInflater();
    droidmenu.inflate(R.menu.contextmenu, menu);
    return true;
} 
```

The logcat log, from where the error occures!

```
 07-05 17:11:43.419: W/dalvikvm(4546): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
 07-05 17:11:43.448: E/AndroidRuntime(4546): FATAL EXCEPTION: main
 07-05 17:11:43.448: E/AndroidRuntime(4546): android.content.ActivityNotFoundException: No Activity found to handle Intent { act=com.sliit.droidman.main.About }
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1545)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.app.Instrumentation.execStartActivity(Instrumentation.java:1416)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.app.Activity.startActivityForResult(Activity.java:3351)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.app.Activity.startActivityForResult(Activity.java:3312)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.app.Activity.startActivity(Activity.java:3522)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.app.Activity.startActivity(Activity.java:3490)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at com.sliit.droidman.main.MainActivity.onMenuItemSelected(MainActivity.java:130)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at com.android.internal.policy.impl.PhoneWindow.onMenuItemSelected(PhoneWindow.java:958)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at com.android.internal.view.menu.MenuBuilder.dispatchMenuItemSelected(MenuBuilder.java:735)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at com.android.internal.view.menu.MenuItemImpl.invoke(MenuItemImpl.java:149)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at com.android.internal.view.menu.MenuBuilder.performItemAction(MenuBuilder.java:874)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at com.android.internal.view.menu.ListMenuPresenter.onItemClick(ListMenuPresenter.java:166)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.widget.AdapterView.performItemClick(AdapterView.java:298)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.widget.AbsListView.performItemClick(AbsListView.java:1086)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at      android.widget.AbsListView$PerformClick.run(AbsListView.java:2855)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.widget.AbsListView$1.run(AbsListView.java:3529)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.os.Handler.handleCallback(Handler.java:615)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.os.Handler.dispatchMessage(Handler.java:92)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.os.Looper.loop(Looper.java:137)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at android.app.ActivityThread.main(ActivityThread.java:4745)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at java.lang.reflect.Method.invokeNative(Native Method)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at java.lang.reflect.Method.invoke(Method.java:511)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at      com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
 07-05 17:11:43.448: E/AndroidRuntime(4546):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:43:53.363

To start your "About"-activity, simply use

`startActivity(new Intent(this, About.class));`

The logcat error means that either your Activity `com.sliit.droidman.main.About` doesn't exist, is in another project, or not defined in the manifest.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T15:42:45.470

You need to define the Activity in your manifest file, look in your manifest and look at the previously defined Activity and create a new one and make changes where you need them.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T15:56:12.727

try as:

```
 Intent intent = new Intent("com.sliit.droidman.main.About");
    final ComponentName cn = new 
    ComponentName("com.sliit.droidman.main","com.sliit.droidman.main.About");
    intent.setComponent(cn);
    startActivity(intent); 
```

* * *

and make sure you have added `android.intent.action.DEFAULT` intent-filter with About as:

```
<activity android:name=".About"
          android:label="@string/app_name">
 </intent-filter>
     <intent-filter>
          <action android:name="com.sliit.droidman.main.About" />
          <category android:name="android.intent.category.DEFAULT" />
     </intent-filter>
</activity> 
```

* * *

# objective-c - 当我在 IOS 项目中使用 ARC 时，如何使用 void *？

> ID：11376343
> 
> 赞同：1
> 
> 时间：2012-07-07T15:41:15.487
> 
> 标签：objective-c, automatic-ref-counting, void-pointers

看看这个方法： beginAnimations:context：这是 UIView 类的一个方法。上下文需要参数，它是一种无效指针，我需要将 UIImageView 发送到上下文。我收到一个警告，上面说当我使用 ARC 时 void* 已被禁止。那么除了不使用 ARC 之外，我如何将 UIImageView 发送到上下文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:27:35.250

上面的评论为这种特殊情况提供了正确的答案（使用基于块的动画方法），但一般来说，如果你有一个接受上下文的 API`void *`并且你想传递一个对象，我发现最好将你转换`id`为a`CFTypeRef`这样您就可以在指针上获得手动内存管理语义（`CFTypeRef`是 typedef for `void *`）等。但是请注意，这要求**必须**调用回调才能释放您的对象（即转换回 ARC 的内置管理） .

这是我刚刚梦想的一些虚构 API 的示例：

```
- (void) doSomethingWithObject: (id) object {
    // use CFBridgingRetain() to turn object into a manually-retained CFTypeRef/void*
    [someObject performBackgroundTaskWithTarget: self
                                       selector: @selector(bgTask:)
                                        context: CFBridgingRetain(object)];
}

- (void) bgTask: (void *) context
{
    // use CFBridgingRelease() to turn our void*/CFTypeRef into an ARC-managed id
    id object = CFBridgingRelease((CFTypeRef)context);
    ...
} 
```

# javascript - 如何创建覆盖整个显示器的全屏画廊？

> ID：11376345
> 
> 赞同：0
> 
> 时间：2012-07-07T15:41:17.967
> 
> 标签：javascript, gallery, fullscreen, monitor, cover

我刚开始从事 Web 开发，所以我知道一些 HTML、CSS、JS 和 PH，我需要一个带有全屏按钮的照片库，我需要全屏来覆盖整个显示器，而不仅仅是浏览器的大小。您是否知道任何具有该功能的画廊，或者您能帮助我实现这种效果吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T15:48:31.620

HTML5 有一个[全屏 API](http://html5-demos.appspot.com/static/fullscreen.html)；但是，支持[并不完美](http://caniuse.com/#feat=fullscreen)，因此如果您坚持这样做，您可能需要一个基于 Flash 的解决方案。

# linux - 在linux调度程序中，它是否跟踪当前的睡眠任务或终止任务？

> ID：11376346
> 
> 赞同：0
> 
> 时间：2012-07-07T15:41:23.980
> 
> 标签：linux, sleep, scheduler

我知道当一个任务运行时，它被排入运行队列。当它休眠时，它会从运行队列中出列。但是有睡眠任务的队列吗？我在源代码中没有看到这一点。

即使我要创建这样一个队列，我怎么知道任务何时被终止并应该从睡眠队列中删除？

谁能给我一个提示？谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T05:20:03.080

在 Linux 中，阻塞（休眠）任务在称为等待队列的结构中排队。每个事件（或对象）都存在一个等待队列，可以等待。

因此，没有单个等待队列（或每个内核），而是每个事件等待队列。内核代码明确地将任务放在等待队列中，并在特定事件到达时将其删除。例如，请参阅 wait_event() 内核 API。

# java - 将布尔方法执行传递给另一个类 - java

> ID：11376352
> 
> 赞同：2
> 
> 时间：2012-07-07T15:41:56.437
> 
> 标签：java, class, methods, boolean

我有一个布尔方法

```
public boolean addCar(CarReg carReg, Car car){
    return ?;
} 
```

上面的这个方法是为了传递给另一个进行实际检查的类

```
public class Car{ 
    Map<CarReg, Car> carMap = new HashMap<carReg, Car>();
    //if the check is successfull, the details are added to the collection
    public boolean addCar(CarReg carReg, Car car){
        If (garage.getOwner().toString == "pete"){
            carMap.put(carReg, car);
            return true;
        }
    }
} 
```

我可以通过说 car.addCar(carReg, car); 来调用它吗？实际上，我已经尝试过，但它似乎不起作用。除非错误在其他地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:02:05.447

与函数式语言不同，在 Java 等面向对象的语言中，您不会传递函数，而是传递可以调用方法的对象。有几种方法可以让您的布尔方法对 Car 类可见。我将调用该方法`canAddCar`只是为了避免与`Car#addCar`.

最简单的是如果您可以在 Car 类本身中定义方法：

```
public class Car {
  public boolean canAddCar(CarReg carReg, Car car) {
    // logic for checking if you can add the car
  }
  public boolean addCar(CarReg carReg, Car car) { 
    if (canAddCar(carReg, car)) {
      // logic for adding the car goes here
      return true;
    } else {
      // anything special if you can't add the car?
      return false;
    }
  }
} 
```

下一个最简单的方法是，如果您可以在传入的对象的类中定义方法，例如`CarReg`

这是有道理的，如果 carReg 负责检查您是否可以添加汽车。根据命名，我想你可能希望 carReg 也负责添加汽车，但我没有在这里展示：

```
public class CarReg {
  public boolean canAddCar(Car car) {
    // logic for testing if you can add the car, for example:
    return (car.getOwner().toString().equals("pete"));
  }
}

public class Car {
  public boolean addCar(CarReg carReg, Car car) {
    if (carReg.canAddCar(car)) {
      // ...
    } else {
      // ...
    }
  }
} 
```

接下来，您可以将另一个对象传递给可以负责检查的类。这可以是方法的另一个对象，也可以是类`addCar`的属性`Car`。我在这个例子中展示了后者（因为前面的例子基本上是前者）：

```
// might as well use an interface if you'll have multiple methods of checking
public interface CarChecker {
  boolean canAddCar(CarReg carReg, Car car);
}

// specific implementation of the CarChecker interface
// you can instantiate this and pass it into the Car class via a setter
public class MyCarChecker implements CarChecker {
  public boolean canAddCar(CarReg carReg, Car car) {
    // checking logic goes here
  }
}

public class Car {
  private CarChecker carChecker;
  // you'll have to implent getCarChecker and setCarChecker 
  // (or let your IDE generate the getters and setters)

  // assuming you'll call setCarChecker somewhere (or have it wired up via IoC)

  public boolean addCar(CarReg carReg, Car car) {
    if (carChecker.canAddCar(carReg, car)) {
      // ...
    } else {
      // ...
    }
  }
} 
```

还有其他几种方法（匿名类、单例类、静态方法），但这些是最常见的，应该可以帮助您入门。

# android - ActionBarSherlock 和 ICS

> ID：11376357
> 
> 赞同：0
> 
> 时间：2012-07-07T15:42:31.053
> 
> 标签：android, android-4.0-ice-cream-sandwich, actionbarsherlock

看到这里，我的眼睛都红了：

我使用 ABS 并且在 Android 2.2 下一切正常，但在 ICS 上`item.getItemId()`总是返回 0。因为`item.toString()`返回不同的值。我觉得我应该能够解决这个问题，但我总是在信息页面上结束。

```
public boolean onCreateOptionsMenu(Menu menu) {
    menu.add("Info")
        .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);
    menu.add("Preferences")
        .setIcon(R.drawable.ic_preferences)
        .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {

    if(item.toString() == "Preferences"){
        Intent intent = new Intent();
        intent.setClass(this,Preferences.class);
        startActivity(intent);
        return true;
    }
    else {
        Intent intent = new Intent();
        intent.setClass(this,Info.class);
        startActivity(intent);
        return true;
    }
} 
```

我想我应该打开`item.getItemId()`，但我不知道在哪里定义 ActionBar 视图。一段时间以来，我一直对菜单文件夹下的文件 actionbar.xml 感到困惑，但收效甚微：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:id="@+id/preferences" 
        android:showAsAction="always" 
        android:icon="@drawable/ic_preferences"></item>
    <item android:id="@+id/info" 
        android:showAsAction="always"></item>
</menu> 
```

人们应该相信答案相当简单。任何人都可以给我一个正确的方向，从 SDK 版本 7 到 15 的工作方式相同吗？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:46:29.103

试试这个：

```
private static final int MENU_INFO = 0;
private static final int MENU_SETTINGS = 1;

@Override
public boolean onCreateOptionsMenu(Menu menu) {

    menu.add(0, MENU_INFO, 0, "Info")
         .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);

    menu.add(0, MENU_SETTINGS, 0, "Preferences")
        .setIcon(R.drawable.ic_preferences)
        .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);

    return true;
}

/* Handles item selections */
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case MENU_INFO:
        startActivity(new Intent(this, Info.class));
        return true;
    case MENU_SETTINGS:
        startActivity(new Intent(this, Preferences.class));
        return true;
    }
    return false;
} 
```

诀窍确实是使用`item.getItemId();`，因为您永远无法确定`.toString()`. 通过在创建菜单选项时为每个菜单项分配静态 int 引用，您可以知道在 - 方法中单击了哪个菜单项`onOptionsItemSelected`。

# java - 在安卓中使用搜索栏

> ID：11376359
> 
> 赞同：0
> 
> 时间：2012-07-07T15:42:41.250
> 
> 标签：java, android, media-player, seekbar

我正在制作一个 android 应用程序，我在其中找到了一些音乐的搜索栏。我得到了搜索栏来显示音乐播放状态，我目前在音乐播放中。但是我如何设置一个监听器，以便我可以说媒体播放器会在轨道上播放特定位置？我知道在 mediaplayer 中设置播放时间的代码，但是如何处理来自 seekbar 的点击事件？像 onClick() 或类似的东西？

固定：我的代码：

```
package com.mycompany.appname;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import android.app.ListActivity;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.os.CountDownTimer;
import android.os.Environment;
import android.view.KeyEvent;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SeekBar;
import android.widget.SeekBar.OnSeekBarChangeListener;
import android.widget.SlidingDrawer;

public class MusicActivity extends ListActivity implements OnClickListener, OnSeekBarChangeListener {
//Called when the activity is first created
List<String> myList = new ArrayList<String>();
EditText AddItemToListViewEditText;
  static final String[] COUNTRIES = new String[] {
      "Movies"
      };
  MediaPlayer mp1;
  String musicUri;
  Button PausePlay;
  int positionInt;
  SlidingDrawer slidingDrawer2;
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.musicscreen);

    //Import views
    PausePlay = (Button)findViewById(R.id.PausePlay);
    slidingDrawer2 = (SlidingDrawer)findViewById(R.id.slidingDrawer2);

    //Setup onClickListener for the buttons
    PausePlay.setOnClickListener(this);

    //Setup mediaPlayer
    mp1 = new MediaPlayer();

    //Setup ListView
    setListAdapter((ListAdapter) new ArrayAdapter<String>(this, R.layout.list_item, COUNTRIES));
    setListAdapter((ListAdapter) new ArrayAdapter<String>(this, R.layout.list_item, myList));

    //Setup seekBar
    final SeekBar progress = (SeekBar)findViewById(R.id.musicProgressBar);
    progress.setOnSeekBarChangeListener(this);

    ListView lv = getListView();
    lv.setTextFilterEnabled(true);

    File mFile = new File(Environment.getExternalStorageDirectory() + "/Music/");
    myList.addAll(Arrays.asList(mFile.list()));
    setListAdapter((ListAdapter) new ArrayAdapter<String>(this, R.layout.list_item, myList));

    lv.setOnItemClickListener(new OnItemClickListener() {
      public void onItemClick(AdapterView<?> parent, View view,
          int position, long id) {
        //When an item is clicked, play it on a MediaPlayer
          //Play song
          positionInt = position;
          if (mp1.isPlaying()) {
              //Reset mediaPlayer
              mp1.reset();
              try {
                  musicUri = Environment.getExternalStorageDirectory() + "/Music/" + myList.get(positionInt);
                mp1.setDataSource(musicUri);
                mp1.prepare();
                mp1.start();
                slidingDrawer2.animateOpen();
            } catch (IllegalArgumentException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IllegalStateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
          } else {
          try {
              musicUri = Environment.getExternalStorageDirectory() + "/Music/" + myList.get(position);
            mp1.setDataSource(musicUri);
            mp1.prepare();
            mp1.start();
            slidingDrawer2.animateOpen();
        } catch (IllegalArgumentException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IllegalStateException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

          //Setup seekBar
          final SeekBar progress = (SeekBar)findViewById(R.id.musicProgressBar);
          progress.setProgress(0);
          progress.setMax(mp1.getDuration());
          new CountDownTimer(mp1.getDuration(), 250) {
            public void onTick(long millisUntilFinished) {
                if (progress.getProgress() == mp1.getDuration()) {
                    mp1.reset();
                    progress.setProgress(0);
                } else {
                  progress.setProgress(mp1.getCurrentPosition());
                }
            }
            public void onFinish() {}
          }.start();
        }
  }
    });
}

@Override
public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) {
    if (fromUser == true) {
        mp1.seekTo(seekBar.getProgress());
    } else {
        //Do nothing
    }
}

@Override
public boolean onKeyDown(int KeyCode, KeyEvent event) {
    if ((KeyCode == KeyEvent.KEYCODE_BACK)) {
        if (mp1.isPlaying()) {
            mp1.reset();
            System.exit(0);
        } else {
            finish();
        }
        return true;
    }
    return super.onKeyDown(KeyCode, event);
}

public void onClick(View src) {
    switch(src.getId()) {
    case R.id.PausePlay:
        if (mp1.isPlaying()) {
            mp1.pause();
            PausePlay.setText("Play");
        } else {
            mp1.start();
            PausePlay.setText("Pause");
        }
        break;
    }
}

@Override
public void onStartTrackingTouch(SeekBar seekBar) {
    // TODO Auto-generated method stub
}

@Override
public void onStopTrackingTouch(SeekBar seekBar) {
    // TODO Auto-generated method stub
}
} 
```

我的xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Musikk"
    android:textAppearance="?android:attr/textAppearanceLarge" />

<FrameLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <ListView
        android:id="@+android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

    </ListView>

    <SlidingDrawer
        android:id="@+id/slidingDrawer2"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:content="@+id/content"
        android:handle="@+id/handle" >

        <Button
            android:id="@+id/handle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Spiller nå" />

        <LinearLayout
            android:id="@+id/content"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:orientation="vertical" >

            <SeekBar
                android:id="@+id/musicProgressBar"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content" />

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content" >

                <Button
                    android:id="@+id/PausePlay"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:text="Pause" />

            </LinearLayout>

        </LinearLayout>
    </SlidingDrawer>

</FrameLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:52:04.763

您需要实现`SeekBar.OnSeekBarChangeListener`，然后实现[onProgressChanged](http://developer.android.com/reference/android/widget/SeekBar.OnSeekBarChangeListener.html#onProgressChanged%28android.widget.SeekBar,%20int,%20boolean%29)方法。

这在进度发生变化时调用（例如，用户单击搜索栏上的某处），并将为您提供新位置。

例子：

```
public void onProgressChanged (SeekBar seekBar, int progress, boolean fromUser) {
    // Do something
} 
```

不要忘记使用 seekBar.setOnseekBarChangeListener 注册 OnSeekBarChanged 监听[器](http://developer.android.com/reference/android/widget/SeekBar.html#setOnSeekBarChangeListener%28android.widget.SeekBar.OnSeekBarChangeListener%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-12T05:59:38.653

```
public void onProgressChanged(SeekBar seekBar, int progress,
                    boolean fromUser) {
                // TODO Auto-generated method stub
                if (fromUser) {
                    mp1.seekTo(progress);
                    seekBar.setProgress(progress);
                }

            } 
```

# android - 清单中的哪一项权限表示我正在阅读电话信息？

> ID：11376364
> 
> 赞同：1
> 
> 时间：2012-07-07T15:42:52.297
> 
> 标签：android, permissions, manifest

我的清单中有一些权限：

```
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
<uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.INTERNET" /> 
```

当我去安装我的应用程序时，它说它可以访问：“电话 - 读取电话状态和身份”。哪些权限会​​触发该警告？我从不阅读电话信息。是我使用 PowerManager.isScreenOn() 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:46:18.583

通过消除过程，我建议它是：`ACCESS_NETWORK_STATE`因为其他人都不是专门与手机有关的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:04:07.513

事实证明这是一个错误问题，您至少需要指定 4 个最小 SDK：

[Android 权限：电话：读取电话状态和身份](https://stackoverflow.com/questions/1747178/android-permissions-phone-calls-read-phone-state-and-identity)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T15:55:21.497

这些都与阅读电话信息无关。因为它应该像 .READ_PHONE_STATE（读取电话）。我想一定是因为ACCESS_NETWORK_STATE。

# shell - 相同的命令给出不同的输出

> ID：11376366
> 
> 赞同：0
> 
> 时间：2012-07-07T15:42:58.763
> 
> 标签：shell

我正在尝试执行命令：

```
ps -e|grep some-process-name|grep -v grep|awk '{print $1}'|grep -v $$ 
```

它给了我进程名称的进程的pid：“some-process-name”

但是当我在 shell 脚本中使用相同的长命令时，进程名称作为命令行参数传递并通过“$1”使用，我在输出中得到两个 pid。

```
PIDS=$(ps -e|grep $1|grep -v grep|awk '{print $1}'|grep -v $$)
echo $PIDS 
```

这可能是什么原因？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T19:02:46.053

我在 Ubuntu 12.04 上的 bash 4.0 上看不到这种行为。pgrep 在您的平台上可用吗？ *pgrep some-process-name*应该为您解决问题。

# javascript - JavaScript 中的计算/瞬态字段

> ID：11376367
> 
> 赞同：3
> 
> 时间：2012-07-07T15:43:14.110
> 
> 标签：javascript

我正在尝试使用 OO JavaScript 实现以下目标：

```
class Sample
{
  public int x {get; set;}
  public int y {get; set;}

  public int z
  {
    get {return x+y;}
  }
} 
```

我无法理解如何在上面的类中实现属性“z”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T15:47:18.380

你必须使用一个函数。从 ECMAScript 第 5 版 (ES5) 开始，该函数可以成为您以正常非函数方式访问的属性的“getter”；在此之前，您必须使用显式函数调用。

这是 ES5 的方式，使用[`defineProperty`](http://ecma-international.org/ecma-262/5.1/#sec-15.2.3.6)：[Live copy](http://jsbin.com/ikeyur) | [资源](http://jsbin.com/ikeyur/edit)

```
function Sample()
{
    // Optionally set this.x and this.y here

    // Define the z property
    Object.defineProperty(this, "z", {
        get: function() {
            return this.x + this.y;
        }
    });
} 
```

用法：

```
var s = new Sample();
s.x = 3;
s.y = 4;
console.log(s.z); // "7" 
```

使用 ES3（例如，早期版本）：

```
function Sample()
{
    // Optionally set this.x and this.y here
}
Sample.prototype.getZ = function() {
    return this.x + this.y;
}; 
```

用法：

```
var s = new Sample();
s.x = 3;
s.y = 4;
console.log(s.getZ()); // "7" 
```

请注意，您必须实际进行函数调用`getZ()`，而 ES5 使其成为可能的属性访问（只是`z`）。

* * *

请注意，JavaScript（还）没有一个`class`特性（尽管它是一个保留字并且即将推出）。您可以通过构造函数和原型来创建对象类，因为 JavaScript 是一种原型语言。（嗯，它有点混合。）如果你开始进入层次结构，就会开始有一些重要的、重复的管道。有关更多信息，请参阅Stack Overflow 上的[其他答案。](https://stackoverflow.com/a/11072626/157247)

# c++ - OpenCV：C++ 和 C 性能比较

> ID：11376368
> 
> 赞同：17
> 
> 时间：2012-07-07T15:43:16.343
> 
> 标签：c++, c, performance, opencv

现在我正在使用 OpenCV API ( `C++`) 开发一些应用程序。此应用程序使用视频进行处理。

在 PC 上，一切都运行得非常快。今天我决定将这个应用程序移植到 Android 上（使用摄像头作为视频输入）。幸运的是，有适用于 Android 的 OpenCV，所以我只是将我的本机代码添加到示例 Android 应用程序中。除了性能，一切都很好。我对我的应用程序进行了基准测试，发现该应用程序以 4-5 fps 的速度运行，这实际上是不可接受的（我的设备具有单核 1ghz 处理器）——我希望它以大约 10 fps 的速度工作。

完全重写我的应用程序是否有意义`C`？我知道使用诸如此类的东西`std::vector`对开发人员来说很舒服，但我不在乎。

似乎`OpenCV's C`接口具有与接口相同的功能/方法`C++`。

我用谷歌搜索了这个问题，但没有找到任何东西。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-07-07T16:46:10.573

我在Android和优化方面做了很多工作（我写了一个视频处理应用程序，可以在4ms内处理一帧），所以我希望能给你一些中肯的答案。

OpenCV 中的 C 和 C++ 接口没有太大区别。一些代码是用 C 编写的，并且有一个 C++ 包装器，而一些反之亦然。两者之间的任何显着差异（由 Shervin Emami 衡量）要么是回归，要么是错误修复，要么是质量改进。您应该坚持使用最新的 OpenCV 版本。

**为什么不重写？**

您将花费大量时间，您可以更好地利用这些时间。C 接口很繁琐，引入错误或内存泄漏的机会很高。在我看来，你应该避免它。

**优化建议**

**A.**打开优化。

编译器优化和调试断言的缺乏都会对您的运行时间产生很大影响。

**B.**分析您的应用程序。

首先在您的计算机上执行此操作，因为它更容易。使用 Visual Studio Profiler，识别慢速部分。优化它们。永远不要因为你认为慢而优化，而是因为你衡量它。从最慢的功能开始，尽可能优化它，然后再慢一点。衡量您的更改以确保它确实更快。

**C.**专注于算法。

更快的算法可以将性能提高几个数量级（100 倍）。C++ 技巧可能会给您带来 2 倍的性能提升。

经典技法：

*   将视频帧的大小调整为更小。通常，您可以从 200x300 像素的图像中提取信息，而不是 1024x768。第一个的面积要小 10 倍。

*   使用更简单的操作而不是复杂的操作。使用整数而不是浮点数。并且永远不要在执行数千次`double`的矩阵或循环中使用。`for`

*   做尽可能少的计算。您能否仅在图像的特定区域中跟踪对象，而不是针对所有帧进行全部处理？您能否对非常小的图像进行粗略/近似检测，然后在全帧的 ROI 上对其进行细化？

**D.**在重要的地方使用 C

在循环中，使用 C 风格而不是 C++ 可能是有意义的。指向数据矩阵或浮点数组的指针比 mat.at 或 std::vector<> 快得多。通常瓶颈是嵌套循环。专注于它。到处替换 vector<> 并将您的代码意大利化是没有意义的。

**E.**避免隐藏成本

一些 OpenCV 函数将数据转换为双精度，对其进行处理，然后再转换回输入格式。当心它们，它们会破坏移动设备的性能。示例：翘曲、缩放、类型转换。此外，众所周知，色彩空间转换是惰性的。更喜欢直接从原生 YUV 获得的灰度。

**F.**使用矢量化

ARM 处理器使用称为 NEON 的技术实现矢量化。学会使用它。它很强大！

一个小例子：

```
float* a, *b, *c;
// init a and b to 1000001 elements
for(int i=0;i<1000001;i++)
    c[i] = a[i]*b[i]; 
```

可以改写如下。它更冗长，但速度更快。

```
float* a, *b, *c;
// init a and b to 1000001 elements
float32x4_t _a, _b, _c;
int i;
for(i=0;i<1000001;i+=4)
{  
    a_ = vld1q_f32( &a[i] ); // load 4 floats from a in a NEON register
    b_ = vld1q_f32( &b[i] );
    c_ = vmulq_f32(a_, b_); // perform 4 float multiplies in parrallel
    vst1q_f32( &c[i], c_); // store the four results in c
}
// the vector size is not always multiple of 4 or 8 or 16\. 
// Process the remaining elements
for(;i<1000001;i++)
    c[i] = a[i]*b[i]; 
```

纯粹主义者[说](https://stackoverflow.com/questions/9828567/arm-neon-intrinsics-vs-hand-assembly)你必须用汇编程序编写，但对于普通程序员来说，这有点令人生畏。我使用[gcc intrinsics](http://gcc.gnu.org/onlinedocs/gcc/ARM-NEON-Intrinsics.html)得到了很好的结果，就像上面的例子一样。

另一种快速启动的方法是将 OpenCV 中手动编码的 SSE 优化代码转换为 NEON。SSE 是英特尔处理器中的 NEON 等价物，许多 OpenCV 函数都使用它，就像[这里](http://code.opencv.org/projects/opencv/repository/entry/trunk/opencv/modules/imgproc/src/filter.cpp#L1949)一样。这是 uchar 矩阵（常规图像格式）的图像过滤代码。不要一味地一一转换指令，而是以它为例。

[您可以在此博客](http://blogs.arm.com/software-enablement/161-coding-for-neon-part-1-load-and-stores/)和以下帖子中阅读有关 NEON 的更多信息。

**G**、注意抓图

在移动设备上它可能会非常慢。优化它是特定于设备和操作系统的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-07T15:51:03.277

在做出这样的决定之前，您应该分析您的代码以定位代码中的热点。如果没有这些信息，您为加快速度所做的任何更改都将是猜测。你试过这个[Android NDK 分析器吗？](http://code.google.com/p/android-ndk-profiler/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-07T15:48:31.687

shervin imami 在他的网站上有一些性能测试。你可以检查它以获得一些想法。

[http://www.shervinemami.info/timingTests.html](http://www.shervinemami.info/timingTests.html)

希望能帮助到你。

（而且，如果您有任何提高性能的方法，如果您在某处分享您自己的发现，那就太好了。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-07T15:53:51.003

我想这个问题需要表述为：C 比 C++ 快吗？答案是否定的。两者都被编译为本地机器语言，并且 C++ 被设计为与 C 一样快。至于 STL（尤其是 ISO 标准）也被设计并注意它们与指针一样快 + 它们提供了灵活性。使用 C 的唯一原因是您的平台不支持 C++ 在我谦虚的开放中，不要将所有内容都转换为 C，因为您可能会获得几乎相同的性能。而是尝试改进您的代码或使用 opencv 的其他功能来做您想做的事情。

不服气？好吧，然后编写一个简单的函数，一次在 C 中，一次在 C++ 中，并在 1 亿次循环中运行它并自己测量时间。也许这可以帮助您做出正确的决定

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-07T15:55:53.953

我从未在 Android 中使用过 C 或 C++。但是在 PC 中，您可以让 C++ 与 C 代码一样快（有时甚至更快）。大多数 C++ 都是专门为允许更多功能而设计的，但不以速度为代价（模板在编译时解决）。大多数编译器都非常擅长优化您的代码，并且您的 std::vector 调用将被内联，并且代码几乎与使用本机 C 数组相同。

我建议你寻找另一种方法来提高你的表现。也许在 Android 中有一些多媒体硬件扩展，您可以访问并使用它来优化代码。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-03-13T20:06:46.500

我在多次测试中注意到：

1.  直接访问像素而不是使用 Mat.at(x,y) 方法时，C 接口 (IplImage) 的速度要快很多倍，当我将 C++ 应用程序转换为 C 时，我的 blob 检测例程的性能提高了 3 倍

2.  当从外部应用程序（例如 LabView）调用时，C++ 接口在某些例程中崩溃，而在 C 中调用相同例程时它可以工作。这方面的示例是 FindContours 和 cvFindContours

3.  C 与嵌入式设备的兼容性要好得多。但是，我还没有在这个领域做过任何事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-13T05:00:36.607

我在 IOS 设备和讨论中遇到了类似的问题[IOS/iPad/iPhone 的最大速度](https://stackoverflow.com/questions/11219240/maximum-speed-from-ios-ipad-iphone)也包括一些适用于其他移动平台的提示。

# java - 排序数组不起作用

> ID：11376370
> 
> 赞同：1
> 
> 时间：2012-07-07T15:43:19.013
> 
> 标签：java, arrays, sorting

```
public static void main(String[] args) {       
   String[] errorStr = new String[] {
       "Line No: " + " " + 1,
       "Line No: " + " " + 11,
       "Line No: " + " " + 10,
       "Line No: " + " " + 2,
       "Line No: " + " " + 3
   };

   Arrays.sort(errorStr);       
   for(Object obj : errorStr){
       System.out.println(obj);
   }
} 
```

有人能指出为什么排序在这里不起作用吗？

```
expected is,

Line No: 1
Line No: 2
Line No: 3
Line No: 10
Line No: 11

Actual is, 
Line No: 1
Line No: 11
Line No: 10
Line No: 2
Line No: 3 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T15:44:35.260

它按字典顺序排序 - 字典上“11”在“2”之前，“Line No: 11”在“Line No: 2”之前。

如果你想要“更智能”的排序，你需要实现一个`Comparer<String>`执行适当的解析来比较字符串。

如果您的所有值*实际上都是*“行号：”后跟一个值，我只需将它们转换为一个数组或整数列表，因为这是您试图表示的*自然*`int`数据......并对一个值数组进行排序将按您的预期工作。

从根本上说，这就是将数字视为字符串的结果:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T15:47:50.410

正如乔恩所说，它按字典顺序对元素进行排序。您可以尝试使用所需的数字创建一个 int 数组，对其进行排序，然后将“行号：”连接到每个元素。我想解决方案策略首先取决于元素是如何失序的......

编辑：继承人的代码示例

```
 int[] errorInt = new int[]{ 1,11,10,2,3} ;
    String[] errorString = new String[ errorInt.length ];
    Arrays.sort(errorInt);
    for( int i = 0; i < errorInt.length; i++) {
        errorString[i] = "Error No:" + errorInt[i];
    } 
```

# iphone - iPhone .ipa 和文件提取

> ID：11376374
> 
> 赞同：1
> 
> 时间：2012-07-07T15:44:00.393
> 
> 标签：iphone, ipa

我正在为 iphone 平台编写一个应用程序。我的代码主要是 C++，带有一些 Objective-C 代码来与 ios sdk apis 交互。我对 iphone 编程不是很精通，这是我的第一个应用程序，所以问题是我需要使用 C++ 代码读取包含一些数据的二进制文件，但我不知道该怎么做。我担心的是：我可以直接使用 fopen/fread 吗？我应该使用哪条路径？我来自Android开发。.apk 是一个简单的 .zip 存档，所以只需要在内存中提取所需的文件并处理它，或者将文件提取到临时目录中并以通常的方式读取它，但我不知道如何在 iPhone 应用程序的情况下也是如此。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T15:47:57.043

我相信您提出的核心问题已经被提出并得到了回答。您想读取和写入文件，但对如何/在何处执行此操作没有信心：[在 iOS 上写入文件](https://stackoverflow.com/questions/5619719/write-a-file-on-ios)

# python - Python：填充空心物体

> ID：11376381
> 
> 赞同：2
> 
> 时间：2012-07-07T15:45:17.087
> 
> 标签：python, python-2.7

我正在编写一个脚本来计算任何随机形状的 3D 对象的体积。我不在乎物体是否是空心的，我需要计算它的总体积。我拥有的数据模型是一个带有 1 和 0 的 3D 表（像素直方图）。显然是物体所在的地方，而零是我们一无所有的地方。要计算填充良好的对象的体积，只需将所有包含 1 的像素相加并乘以像素体积即可。另一方面，主要的困难仍然是我们有一个空心物体，所以我们有一个被一个包围的零。因此，应用我在此描述的直接方法不再有效。我们需要做的是用 1 填充所有对象区域。这是一个 2D 示例，因此您可以理解我的意思

二维表：

```
0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 1 1 1 1 1 1 0 0 0 
0 0 1 1 0 0 0 1 1 1 0 0 
0 0 0 1 0 0 1 0 0 0 0 0 
0 0 1 0 0 0 0 1 0 0 0 0 
0 0 1 0 0 0 0 1 0 0 0 0 
0 0 1 1 1 1 1 1 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 
```

我需要把它变成这个

```
0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 1 1 1 1 1 1 0 0 0 
0 0 1 1 1 1 1 1 1 1 0 0
0 0 0 1 1 1 1 0 0 0 0 0 
0 0 1 1 1 1 1 1 0 0 0 0 
0 0 1 1 1 1 1 1 0 0 0 0 
0 0 1 1 1 1 1 1 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T19:38:41.583

如果您使用[`scipy`](http://www.scipy.org/)，您可以在一行中使用[`binary_fill_holes`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.morphology.binary_fill_holes.html#scipy.ndimage.morphology.binary_fill_holes). **这适用于 n 维。**用你的例子：

```
import numpy as np
from scipy import ndimage
shape=np.array([
    [0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,1,1,1,1,1,1,0,0,0],
    [0,0,1,1,0,0,0,1,1,1,0,0],
    [0,0,0,1,0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,1,0,0,0,0],
    [0,0,1,0,0,0,0,1,0,0,0,0],
    [0,0,1,1,1,1,1,1,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0]
    ])
shape[ndimage.binary_fill_holes(shape)] = 1
#Output:
[[0 0 0 0 0 0 0 0 0 0 0 0]
 [0 0 0 1 1 1 1 1 1 0 0 0]
 [0 0 1 1 1 1 1 1 1 1 0 0]
 [0 0 0 1 1 1 1 0 0 0 0 0]
 [0 0 1 1 1 1 1 1 0 0 0 0]
 [0 0 1 1 1 1 1 1 0 0 0 0]
 [0 0 1 1 1 1 1 1 0 0 0 0]
 [0 0 0 0 0 0 0 0 0 0 0 0]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T16:00:44.630

标准的[洪水填充](http://en.wikipedia.org/wiki/Flood_fill)应该可以扩展到三个维度。来自维基百科，2-d 版本的大纲：

```
1\. If the color of node is not equal to target-color, return.
 2\. Set the color of node to replacement-color.
 3\. Perform Flood-fill (one step to the west of node, target-color, replacement-color).
    Perform Flood-fill (one step to the east of node, target-color, replacement-color).
    Perform Flood-fill (one step to the north of node, target-color, replacement-color).
    Perform Flood-fill (one step to the south of node, target-color, replacement-color).
 4\. Return. 
```

请注意，在第 3 步中，您正在跟踪所有相邻的单元格。如果您更改它以在 3-d 中查找所有相邻单元格并像以前一样运行它应该可以很好地工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T16:15:03.100

```
matrix=[
    [0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,1,1,1,1,1,1,0,0,0],
    [0,0,1,1,0,0,0,1,1,1,0,0],
    [0,0,0,1,0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,1,0,0,0,0],
    [0,0,1,0,0,0,0,1,0,0,0,0],
    [0,0,1,1,1,1,1,1,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0]
    ]

def fill (x,y):
    global matrix
    if ( x==len (matrix)
             or y==len (matrix[0])
             or x==-1
             or y==-1
             or matrix[x][y]==1 ):
            return
    else:
        matrix[x][y]=1
        fill (x+1,y)
        fill (x-1,y)
        fill (x,y+1)
        fill (x,y-1)

fill (4,4)

for i in matrix:
    print i 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T16:25:22.143

不直观且难以阅读，但紧凑：

```
matrix = [[0, 0, 0, 0, 0, 0],
          [0, 0, 1, 0, 1, 0],
          [0, 1, 0, 0, 0, 1],
          [0, 0, 0, 0, 0, 0]]

ranges = [1 in m and range(m.index(1), len(m)-list(reversed(m)).index(1)) or None for m in matrix]
result = [[ranges[j] is not None and i in ranges[j] and 1 or 0 for i,a in enumerate(m)] for j,m in enumerate(matrix)]

result
[[0, 0, 0, 0, 0, 0],
 [0, 0, 1, 1, 1, 0],
 [0, 1, 1, 1, 1, 1],
 [0, 0, 0, 0, 0, 0]] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T16:09:30.653

假设您正在谈论诸如填充[体素](http://en.wikipedia.org/wiki/Voxel)形状之类的事情，为什么您不能这样做（将其作为简化 2D 案例的伪代码示例，因为我不知道您使用的是什么数据结构-也许一个[numpy.array](http://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html)？ - 所以我只是将一个假设的“列表列表作为矩阵”，并且我没有考虑在遍历它时修改可迭代对象的问题等）：

```
for i, row in enumerate(matrix):
    last_filled_voxel_j = false
    for j, voxel in enumerate(row):
        if voxel:
            if last_filled_voxel != false:
                fill_matrix(matrix, i, last_filled_voxel_j, j)
            last_filled_voxel_j = j 
```

...假设`fill_matrix(matrix, row, column_start, column_end)`只是填充之间的体素行，不包括`column_start`and `column_end`。

我想这可能不是您要寻找的答案，但是您能否在实际需要之前扩展与我伪编码的内容不同的内容，以便我们可以提供更多帮助？

# java - 检索两个标签之间的代码

> ID：11376384
> 
> 赞同：0
> 
> 时间：2012-07-07T15:45:43.637
> 
> 标签：java, netbeans

大家好，我正在尝试检索这两个标签之间的链接，例如此处的文本，然后它将其存储在列表中，我如何使用模式和匹配器检索这些文本

```
public void getlinks() {
    Pattern Start = Pattern.compile(this.PatternStart);  //<Link>
    Pattern End = Pattern.compile(this.PatternEnd);      //</Link>
    Matcher mStart = Start.matcher(this.Source); // matches Start
    Matcher mEnd = End.matcher(this.Source); // matches end

   ????????????
} 
```

试图找到一个 html 源代码之间和内部的链接，仅用作示例

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:56:02.347

一般来说，你这样做：

```
public static List<String> getLinks(String text) {
    Matcher matcher = Pattern.compile("<tagstart>(.*?)<tagend>").matcher(text);
    List<String> linkList = new ArrayList<String>();
    while (matcher.find()) {
        linkList.add(matcher.group(1));
    }
    return linkList;
} 
```

where`<tagstart>`和`<tagend>`是你的开始和结束标签。`matcher.group(1)`为您提供标签之间的所有内容，在哪里或`matcher.group()`也会`matcher.group(0)`给您标签。
请注意，`(.*?)`如果您有一个包含多个标签对的文本，则使用它很重要，否则这将匹配第一个`<tagstart>`和最后一个`<tagend>`并返回其间的所有内容。
一个示例用法是：

```
 System.out.println(getLinks("<tagstart>beer<tagend><tagstart>juice<tagend>")); 
```

哪个打印

```
[beer, juice] 
```

# ios - 加载新视图时如何禁用 UISwipeGestureRecognizer？

> ID：11376389
> 
> 赞同：2
> 
> 时间：2012-07-07T15:46:06.337
> 
> 标签：ios, xcode, gesture, swipe

在我的 viewDidLoad 我设置

```
UISwipeGestureRecognizer *swipeRecognizerU = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipeUpDetected:)]; swipeRecognizerU.direction = UISwipeGestureRecognizerDirectionUp; [self.view addGestureRecognizer:swipeRecognizerU]; 
```

当我通过弹出窗口加载新视图时，我需要禁用该手势

```
// show popup view
-(IBAction)showPopup:(id)sender
{
    MJDetailViewController *detailViewController = [[MJDetailViewController alloc] initWithNibName:@"MJDetailViewController" bundle:nil];
    [self presentPopupViewController:detailViewController animationType:MJPopupViewAnimationSlideBottomBottom];
} 
```

弹出视图被关闭后，我需要重新设置滑动手势。

```
// hide popup view
-(IBAction)hidePopup:(id)sender
{
    [self dismissPopupViewControllerWithanimationType:MJPopupViewAnimationSlideBottomBottom];
} 
```

如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T15:53:09.533

我认为有一个名为 enabled 的属性`UIGestureRecognizer`。你有没有试过这个，禁用你的滑动应该没问题：

```
swipeGestureRecognizer.enabled = NO; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-22T20:36:06.220

你需要在这里设置委托。

前任 ：

```
swipeleft=[[UISwipeGestureRecognizer alloc]initWithTarget:self action:@selector(swipeleft:)];
        swipeleft.direction=UISwipeGestureRecognizerDirectionLeft;
        swipeleft.delegate = self;
        [self.view addGestureRecognizer:swipeleft]; 
```

然后添加功能

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {

    if ((touch.view == test[1]) || (touch.view == test[2]) || (touch.view == test[3])) {

        [gestureRecognizer setCancelsTouchesInView:YES];
        [swipeleft setCancelsTouchesInView:YES];

        [gestureRecognizer setEnabled:NO];
        [swipeleft setEnabled:NO];

        return NO;

    }
    else
    {
        [gestureRecognizer setCancelsTouchesInView:NO];
        [swipeleft setCancelsTouchesInView:NO];

        [gestureRecognizer setEnabled:YES];
        [swipeleft setEnabled:YES];

    return YES;
    }
} 
```

我觉得对你有用

# java - java.lang.NullPointerException 但对象不为空（我想）

> ID：11376391
> 
> 赞同：2
> 
> 时间：2012-07-07T15:46:07.393
> 
> 标签：java

我的最后一个项目（也是最大的:)）是乒乓球比赛。我正在尝试实现“AI”，但我不能这样做，因为

```
Exception in thread "Timer-0" java.lang.NullPointerException
    at main.Ball$1.run(Ball.java:25)
    at java.util.TimerThread.mainLoop(Unknown Source)
    at java.util.TimerThread.run(Unknown Source) 
```

我想我已经把整个代码写得很好，但肯定有问题。

Main.java - [http://pastebin.com/nvHwQAFD](http://pastebin.com/nvHwQAFD)

Ball.java - [http://pastebin.com/cgE5r5eW](http://pastebin.com/cgE5r5eW)

Player.java - pastebin.com/7QeiNciz

ai.java - pastebin.com/xsGhJ7Zb（只有两个超链接，防止垃圾邮件）

代码写得不好，我希望你不会去（得到？）盲目 :)

问候，阿德里安

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T15:49:56.410

你有一个比赛条件。

当您调用`Ball`构造函数时，它会立即调用`movement()`调度有问题的代码（诚然在不同的线程中）。所有这一切都发生在`Main`构造函数的中间，*然后* `Main.player`才被赋值。所以在`movement()`这里：

```
if(main.player.intersects(main.ball) && hitP == false){ 
```

...`main.player`如果计时器线程启动得足够快，则仍然为 null，因此`main.player.intersects`调用会引发异常。（`main.ball`也是空的，但这*实际上*并不会导致您看到的问题。但它仍然是一个问题。）

需要学习的几个教训：

*   不要在构造函数中做太多
*   理想情况下，尽量避免创建这种循环引用，或者如果您*必须*拥有一个，请确保在开始实际工作之前一切都已初始化
*   让你的类名更有意义：作为一个程序的入口点`Main`很好，*但是*创建一个类型的*对象*`Main`对我来说听起来很可疑。什么*是*`Main`? _ 你会如何描述它？
*   不要滥用继承 - 没有理由`Ball`应该扩展`Thread`（你说`implements Runnable`但你自己没有提供`run()`方法`Ball`）
*   避免与`true`or比较`false`- write`if (foo)`而不是`if (foo == true)`and`if (!foo)`而不是`if (foo == false)`
*   让你的变量名有意义——根据我之前的评论，在你有一个变量调用的同一个类中调用一个`Rectangle`变量是自找麻烦`player``Player``p`
*   将所有变量设为私有，*如果需要，*可以通过属性公开它们。*（除非你真的*需要，否则不要暴露它们）
*   缩进很重要——正确缩进你的代码会更容易阅读
*   在您*真正*熟悉该语言的基础知识之前，请避免使用线程——这很难，并且会引入各种微妙的问题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T15:49:55.597

在您的代码中，您`ball.movement()`在第 17 行调用，然后在第 18 行分配`main`一个非空值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T15:52:52.077

此行：`player = new Rectangle(p.getX(), p.getY(), 10, 50);`在 Main line 18 必须`b = new Ball(this);`在 Main line 15 之前。否则当你调用移动时 player 为 null。

# php - 当显示未找到服务器错误页面时，如何刷新页面/框架？

> ID：11376400
> 
> 赞同：2
> 
> 时间：2012-07-07T15:47:16.213
> 
> 标签：php, javascript, html, frames

我已经搜索但无法找到有关此主题的任何讨论：

我有一个私人网页（用 php 实现）滚动浏览几个不同的 php 页面显示信息，然后每分钟刷新到下一个页面，以便在显示最新工作、天气等的消防站中使用。我目前`header( 'refresh: 60; url=screen2.php' );`在每个 php 文件中使用只是指向到下一个文件..

问题是有时页面由于某种原因无法加载，此时会显示“找不到服务器”页面。当这种情况发生时，刷新指令当然会丢失，错误页面会一直保留在那里，直到有人注意到问题并手动刷新页面。不理想。。

我应该提到该页面显示在消防站周围的多个监视器上，并且运行它的电脑被锁定。因此，经常手动刷新它的麻烦！

如果可能的话，在没有人工干预的情况下自动从这种情况中恢复是很重要的。如果显示错误页面，有什么方法可以使用框架、php、javascript 或其他方式再次刷新？

任何想法将不胜感激。

谢谢！亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:59:19.100

您可以在 setTimeout 函数或元刷新标签中使用 javascript window.location。

除非您关心用户是否可以更改刷新信息，否则没有理由需要在 PHP 端执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:04:07.137

您说它“由于某种原因无法加载”-您知道这是为什么吗？如果问题出在您的服务器端，那么您可以设置您的服务器，使其 404 响应（或 500 内部服务器错误响应，或任何错误）包含重定向到起始 PHP 页面的标头。

如果问题与 DNS 或连接相关 - 即。甚至没有联系服务器，因此浏览器正在显示“未找到”错误页面，那么您可以做的是更改此页面。这并不容易做到，但在 Firefox 中，您可以例如按照[http://forums.mozillazine.org/viewtopic.php?f=7&t=492177&start=0](http://forums.mozillazine.org/viewtopic.php?f=7&t=492177&start=0)上的说明来自定义显示的错误页面。

除此之外，解决页面无法加载的问题可能会更好，这可能更简单:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:04:25.857

您还可以将信息保存在会话中。 [http://php.net/manual/en/features.sessions.php](http://php.net/manual/en/features.sessions.php)

另一种独立于服务器的方式是 javascript 的 Web Storage API。大多数现代浏览器已经支持它。

# android - 我的应用程序的进程何时终止

> ID：11376409
> 
> 赞同：0
> 
> 时间：2012-07-07T15:48:18.707
> 
> 标签：android, process

我有一个警报应用程序，用户可以在其中设置多个警报。当警报响起时（使用 AlarmManager 和 BroadcastReceiver），应用程序只会显示一个通知。

我的应用可能长时间不在前台，因此不会有 UI 线程运行。

我的问题是，当警报响起并显示通知时，我的应用程序的部分代码会被执行（广播接收器和通知创建）。接下来发生什么？我的应用程序的进程是否立即被杀死？在 Android 决定杀死它之前，它是否会一直处于空闲状态？

（这都与关于持久通知 ID 的另一个问题（http://stackoverflow.com/questions/11376294/do-i-need-to-persist-my-notification-ids）有关。当我的应用程序未在前台和两个警报相隔一分钟，我将通知 ID 存储在静态 ArrayList 中。在第二个通知创建时使用调试器，似乎我的通知创建者类仍然在 ArrayList 中保存第一个通知的 ID。这表明该过程介于第一个和第二个警报响起之间。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:02:12.340

Android 在这里有一些文档：[Activity | 进程生命周期](http://developer.android.com/reference/android/app/Activity.html#ProcessLifecycle) 这一切都取决于系统有多少内存和进程的类型。对于 BroadcastReceivers 来说，当设备内存不足时，它们似乎首先被杀死，但如果不是，它们会持续存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:04:30.853

> 接下来发生什么？

给定你的头像，你就有了一个茶点。或者可能是一品脱，这取决于一天中的时间和饮料偏好。

:-)

> 我的应用程序的进程是否立即被杀死？

可能不是。

> 在 Android 决定杀死它之前，它是否会一直处于空闲状态？

是的。当 Android 需要 RAM 来启动其他进程时，它会终止进程。如果您的进程没有正在运行的组件，它将在要终止的进程列表中相对较高。`BroadcastReceiver`因此，您的流程可能不会存活很长时间，但您的结束与被终止的流程之间没有直接的因果关系。

> 当我的应用程序没有在前台运行并且两个警报相隔一分钟时，我将通知 ID 存储在静态 ArrayList 中。在创建第二个通知时使用调试器，我的通知创建者类似乎仍然在 ArrayList 中保存第一个通知的 ID。这表明该过程存在于第一个和第二个警报响起之间。

警报之间只有一分钟，您的进程可能会持续存在是合理的，但这不能保证。当然，每分钟不断地运行警报不太可能让您非常受欢迎，因此请确保用户对这种行为有一定的控制权（例如，可以完全停止您的应用程序，可以修改轮询周期）。

# mysql - 在 MySQL Workbench EER 图中的多个列上创建唯一约束

> ID：11376413
> 
> 赞同：48
> 
> 时间：2012-07-07T15:48:34.480
> 
> 标签：mysql, mysql-workbench, unique-constraint, multiple-columns, workbench

在 MySQL Workbench 的 EER 图中，有一个复选框可以使表中的每一列都是唯一的，不为空，主键等。

但是，我想对多个列有一个 UNIQUE 约束。是否可以将其添加到 MySQL Workbench 的 EER 图中？

编辑：好的，我意识到唯一的复选框，创建一个唯一的索引，而不是一个唯一的约束

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2013-04-18T06:38:10.360

在 MySQL Workbench 的 Alter Table 对话框中：

*   转到索引选项卡。
*   双击空白行以创建新索引。
*   选择“唯一”作为索引类型。
*   检查您希望一起唯一的列。

关于这是否奇怪存在一些[讨论，因为索引与约束不同。](http://bugs.mysql.com/bug.php?id=48468as)我当然不会想到去那里看。然而，显然“唯一索引”以与唯一约束相同的方式强制唯一性，并且可以提高性能。例如，如果我尝试在使用此方法后插入一个将唯一性分开的行，则会引发“1062 Duplicate entry”错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T20:29:27.427

它似乎不可用：[http](http://bugs.mysql.com/bug.php?id=48468) ://bugs.mysql.com/bug.php?id=48468 。似乎您可以在索引选项卡上创建多列唯一索引，但对于多列唯一约束，您需要手动运行创建命令。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-14T07:37:58.307

使用最新的 MWB（我在 6.0.8），[可以创建复合键](https://dev.mysql.com/doc/workbench/en/wb-table-editor.html)

> 如果您希望创建复合主键，您可以选择多个列并选中 PK 复选框。但是，还需要一个额外的步骤，您必须单击“索引”选项卡，然后在“索引列”面板中设置所需的主键顺序。

# c# - mcs：找不到类型或命名空间名称“XXX”...缺少 using 指令或程序集引用？

> ID：11376415
> 
> 赞同：2
> 
> 时间：2012-07-07T15:49:03.463
> 
> 标签：c#, .net, build, mono

我正在尝试使用 mcs 从命令行构建单个 cs 文件。我在 c# 代码中使用了一个外部库：

`using SomeLib`

但是，我不知道如何为 mcs 指定所需的库。如何解决此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:12:58.293

The solution was to use `gmcs` and pass the library using the **r** specifier as follows:

```
gmcs filename.cs -r:libthirdparty 
```

# git - git - .gitignore 的子模块问题

> ID：11376418
> 
> 赞同：1
> 
> 时间：2012-07-07T15:49:29.273
> 
> 标签：git, git-submodules, gitignore

我遇到以下错误：

> git.exe 子模块添加——“D:/Programming/boost_1_50_0”“C:/Users/qwerty/Documents/Visual Studio 2010/Projects/framework”
> 
> 您的 .gitignore 文件之一会忽略以下路径： C:/Users/qwerty/Documents/Visual 如果您真的想添加它，请使用 -f。
> 
> git 没有完全退出（退出代码 1）

我的 gitignore 文件都没有指定*C:/Users/qwerty/Documents/Visual*甚至远程。

当我尝试使用 -f 标志时，我收到以下消息：

> 将“C:/Users/qwerty/Documents/Visual Studio 2010/Projects/framework”中的现有存储库添加到索引致命：“C:/Users/qwerty/Documents/Visual Studio 2010/Projects/framework”在外部存储库失败添加子模块'C：/Users/qwerty/Documents/Visual Studio 2010/Projects/framework'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:06:55.397

通过替换命令解决了问题：

> git.exe 子模块添加——“D:/Programming/boost_1_50_0”“C:/Users/qwerty/Documents/Visual Studio 2010/Projects/framework”

和：

> git.exe 子模块添加 -- "D:/Programming/boost_1_50_0" ""

而`C:/Users/qwerty/Documents/Visual Studio 2010/Projects/framework`当前工作目录。

# objective-c - 如何更改已弃用的 beginSheetForDirectory 方法

> ID：11376419
> 
> 赞同：2
> 
> 时间：2012-07-07T15:49:38.530
> 
> 标签：objective-c, cocoa, xcode4.3, nssavepanel

我有一个正在使用的应用程序`beginSheetForDirectory:file:modalForWindow:modalDelegate:didEndSelector:contextInfo:`。

我检查了 Apple 文档，该文档说它已被弃用，并改用另一种方法：

> 将保存面板显示为具有指定路径的工作表，并且可以选择在该路径中指定文件。（在 Mac OS X v10.6 中已弃用。改用 beginSheetModalForWindow:completionHandler:。）

我的问题是如何将此代码更改为新代码？

```
//  [savePanel setRequiredFileType:@"png"];
[savePanel beginSheetForDirectory:nil 
                             file:nil  
                   modalForWindow:[self window] 
                    modalDelegate:self 
                   didEndSelector:@selector(didEndSaveSheet:returnCode:conextInfo:) 
                      contextInfo:NULL]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T17:20:27.500

你正在寻找[`beginSheetModalForWindow:completionHandler:`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSSavePanel_Class/Reference/Reference.html#//apple_ref/occ/instm/NSSavePanel/beginSheetModalForWindow%3acompletionHandler%3a)方法。

例子：

```
NSSavePanel *savePanel = [NSSavePanel savePanel];

[savePanel beginSheetModalForWindow:_window completionHandler:^(NSInteger result) {
    if (result == NSFileHandlingPanelOKButton) {
        NSURL *savePath = [[savePanel URLs] objectAtIndex:0];
    } else {
        [savePanel close];
    }
}]; 
```

# image-processing - 有没有办法检测主要的投资回报率？

> ID：11376422
> 
> 赞同：3
> 
> 时间：2012-07-07T15:50:01.480
> 
> 标签：image-processing, opencv, computer-vision, javacv

我想检测图片中重要的 ROI 元素。（我想得到这个职位）我测试了一个还原的[SeamCarving-Method](http://en.wikipedia.org/wiki/Seam_carving)。我希望，图片中最重要的区域具有最高的能级。我已经生成了一个垂直接缝和一个水平接缝，并采用了交叉点。但这种方法似乎并不完美。一些例子：

良好检测： [良好检测 http://img713.imageshack.us/img713/2928/seamcastle.jpg](http://img713.imageshack.us/img713/2928/seamcastle.jpg) [良好检测 http://img39.imageshack.us/img39/9584/seamente.jpg](http://img39.imageshack.us/img39/9584/seamente.jpg) [良好检测 http://img193.imageshack .us/img193/2693/seamwuffi.jpg](http://img193.imageshack.us/img193/2693/seamwuffi.jpg)

接近可接受的； [良好的检测 http://img440.imageshack.us/img440/7459/seamflower.jpg](http://img440.imageshack.us/img440/7459/seamflower.jpg)

更糟糕的检测：

[良好的检测 http://img836.imageshack.us/img836/5766/seamsun.jpg](http://img836.imageshack.us/img836/5766/seamsun.jpg)（也许这个点是一个很好的结果。它是这张图片中最大能级的点）

[良好的检测 http://img507.imageshack.us/img507/2750/seambluesky1.jpg](http://img507.imageshack.us/img507/2750/seambluesky1.jpg)

有没有人有更好地检测 roi 的想法？

问候，愿望

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T07:23:14.973

我认为您正在寻找的关键术语是：显着性检测，显着对象检测等

也许这些论文会为您指明正确的方向：

*   用于快速场景分析的基于显着性的视觉注意模型 ( [PDF](http://www.lira.dist.unige.it/teaching/SINA_08-09/papers/itti98model.pdf) )
*   在自然图像上模拟人类扫视扫描路径 ( [PDF](http://www.psy.pku.edu.cn/Upload/pubs/2011062100003.pdf) )
*   通过组合物检测显着目标 ( [PDF](http://research.microsoft.com/en-us/people/yichenw/iccv11_salientobjectdetection.pdf) )
*   显着性过滤器：用于显着区域检测的基于对比度的过滤（[Web](http://www.fedeperazzi.com/saliency_filters/) )

# php - mysql中的NULL或'字符串'在php中插入查询字符串

> ID：11376423
> 
> 赞同：1
> 
> 时间：2012-07-07T15:50:06.127
> 
> 标签：php, mysql, null

如何在 sql 查询中传递“NULL”或“String”。

例如（城市是可选的，在mysql中可以使用NULL）

```
<?php
$var = !empty($_POST['city']) ? $_POST['city'] : NULL;
$query = mysql_query("INSERT INTO table VALUES('".$_POST['firstname']."','".$var."')");
?> 
```

这不起作用，因为 NULL 和 'NULL'(as String) 对于 mysql 是不一样的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T15:51:23.573

不要在查询中用引号将 NULL 括起来：

```
$var = !empty($_POST['city']) ? ( "'" . $_POST['city'] . "'") : 'NULL';
$query = mysql_query("INSERT INTO table VALUES('".$_POST['firstname']."',".$var.")"); 
```

现在，当`$_POST['city']`未指定时，您的查询将如下所示：

```
INSERT INTO table VALUES('nickb',NULL) 
```

# teechart - 使用 Techart for Mono for Android 时出错

> ID：11376425
> 
> 赞同：0
> 
> 时间：2012-07-07T15:50:18.707
> 
> 标签：teechart

编译 TeeChart for Android（Beta 版）的演示项目时出现错误：

```
Error   1
The type 'Android.Widget.FrameLayout' is defined in an assembly that is not referenced. You must add a reference to assembly 'Mono.Android, Version=0.0.0.0, Culture=neutral, PublicKeyToken=c4c4237547e4b6cd'.
F:\Digital\Digital Mobile Development group\Projects\POC for CT\Supported Component\TeeChartMonodroidBeta201200515\TeeChartMonodroidBeta201200515\Examples\MonoAndroidDemo\ChartEditor.cs   21  20  MonoAndroidDemo 
```

请帮忙

谢谢

* * *

我已经验证并且对 Mono.Android 的引用是正确的。

Also, to mention that it is not working on my home machine. but on different machine it doesn't show any error while compiling & app get deployed to Android emulator successfully but when i run the app & select any chart option it shows blank screen & come again to list of chart types. Is this component applicable to specific Android version only?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T08:25:28.017

您能否检查一下您的 MonoAndroidDemo 项目是否有 Mono.Android.dll 引用，如果它损坏或丢失，请重新添加它？

# java - 向后显示字符串

> ID：11376429
> 
> 赞同：0
> 
> 时间：2012-07-07T15:50:34.773
> 
> 标签：java, string

再会！我这里有一个 Java 程序，它应该向后显示一个字符串。例如，“番茄酱”应显示“puhctek”。

```
import java.util.*;
import java.text.*;
import javax.swing.*;

public class StringManipulation {

    public static String ReverseStr(String S) {
           String newS = "";
           for (int i=0; i<S.length(); i++) {
              newS = S.charAt(i) + newS;
           }
           return newS;
        }
        public static void main(String[] args) {
        int choice;
        String menu, choiceStr = "", enterString="", noSpace;

        do {    
            menu = "MENU \n" +
                    "(1) Enter a string \n" +
                    "(2) Remove all spaces from a string \n" +
                    "(3) Display the string backward \n" +
                    "(4) Quit";
            choiceStr = JOptionPane.showInputDialog(menu);
            choice = Integer.parseInt(choiceStr);
            switch (choice) {
                case 1: enterString = JOptionPane.showInputDialog("Please enter the string:"); 
                        break;
                case 2: noSpace = enterString.replaceAll("\\s", "");
                        JOptionPane.showMessageDialog(null, noSpace); 
                        break;
                case 3: ReverseStr(enterString);
                        break;
                case 4: System.exit(0);
            }
        } while (choice != 4);
    }

} 
```

它在输入字符串时效果很好，删除了字符串的空格，但是当向后显示字符串时，对话框返回菜单。请帮助我代码中有什么问题。非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T15:56:46.723

```
case 3: ReverseStr(enterString);
    break; 
```

您在这里所做的只是调用 ReverseStr 方法然后中断 - 您没有对结果做任何事情，例如将其显示给用户。你可能想要这样的东西：

```
case 3: String rev = ReverseStr(enterString);
    JOptionPane.showMessageDialog(null, rev); 
    break; 
```

作为旁注，以下是在 Java 中反转字符串的更简单、更快的 1 行：

```
new StringBuilder(str).reverse().toString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:10:38.997

给你哥们：

```
public static void main(String[] args) {
        int choice;
        String menu, choiceStr = "", enterString = "", noSpace;
        String stringWithNoSpaces = "";
        String reversedString = "";

        do {
            menu = "MENU \n"
                    + "(1) Enter a string \n"
                    + "(2) Remove all spaces from a string \n"
                    + "(3) Display the string backward \n"
                    + "(4) Quit";
            choiceStr = JOptionPane.showInputDialog(menu);
            choice = Integer.parseInt(choiceStr);
            switch (choice) {
                case 1:
                    enterString = JOptionPane.showInputDialog("Please enter the string:");
                    stringWithNoSpaces = enterString;
                    break;
                case 2:
                    stringWithNoSpaces = enterString.replaceAll("\\s", "");                    
                    JOptionPane.showMessageDialog(null, stringWithNoSpaces);
                    break;
                case 3:
                    reversedString = ReverseStr(stringWithNoSpaces);
                    JOptionPane.showMessageDialog(null, reversedString);
                    break;
                case 4:
                    System.exit(0);
            }
        } while (choice != 4);
    } 
```

我做了一些更改：您的选项 3 返回到菜单，因为您的 ReverseStr 方法返回了一个反转的字符串，但您从未捕获并显示它。你可能只是赶时间哈哈。我进行了另一项更改，对此我可能错了，但是当您想反转字符串时，它不会将删除空格的字符串发送给它（建议您在选项 3 之前选择选项 2）。我已经这样做了，如果您在选项 3 之前选择选项 2，它将反转不再有空格的字符串。享受！

# php - SUM 查询或遍历对象数组并对数据成员求和会更有效吗？

> ID：11376432
> 
> 赞同：1
> 
> 时间：2012-07-07T15:51:04.853
> 
> 标签：php, mysql

假设我在一个数组中有 50 个对象，并且每个对象都有属性`cost`。此外，所有对象都在 MySQL 数据库中。

`cost`循环遍历所有对象并添加它们的成员，或者进行诸如 之类的查询会更有效`SELECT sum(cost) FROM ...`吗？

编辑：已经建立了一个 PDO 数据库对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T15:56:03.310

取决于数组大小，您是否已经建立了数据库连接等。我一般会选择循环部分，因为它只有 50 个项目。但是最终的答案是您可以为自己做的基准..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T15:53:48.547

SUM 查询。把手放下。如果它不比在应用程序代码中循环遍历数组更有效，那么您需要进行一些数据库调整。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T15:54:25.370

一般来说，让 MySQL 为您做这件事要高效得多。但是，如果它真的*只有*50 个对象，那么其他因素（例如与数据库的网络连接）可能会发挥作用。但是，编写假设应用程序不会扩展的代码绝不是一个好主意。所以使用 MySQL :-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T15:55:12.533

求和查询。这将比你自己尝试更有效率。

无论如何，它们将足够相似以至于无关紧要，这意味着您会想要使用 sum，因为它有时很快，有时几乎相同。没有理由自己执行代码来冒险。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-30T06:18:04.963

我在 php 中尝试了一个包含 74601 条记录的表，发现 sql SUM 查询比在 php 中循环快大约 10 倍

[在这里检查结果](https://i.stack.imgur.com/dGApy.png)

# colors - 计算颜色图中的颜色

> ID：11376434
> 
> 赞同：1
> 
> 时间：2012-07-07T15:51:25.040
> 
> 标签：colors, statistics

假设我有一些数据要显示在条形图上，每个条形都会根据其高度着色。

假设条形的高度范围从*a*到*b*。

计算连续颜色图中数字的最佳方法是什么，以便为*a*分配一组 RGB 值，*为 a+1*分配一组 RGB 值，一直到*b*。数据是连续的。

分配的颜色需要这样，如果数据点 1 的值*x*并且数据点 2 的值接近*x*，则分配给数据点 1 和 2 的颜色将相似。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:00:24.903

几乎，取决于您使用什么程序来执行此操作，这相当简单。考虑有 3 列 RG 和 B（它们可以以多种不同的方式存储）。

纯红色是 255，G 和 B 为 0。纯绿色和蓝色也是如此，它们各自的颜色。然后，只需覆盖您想要的所有可能的颜色。

示例颜色图表在[这里](https://www.google.com/search?q=rgb+color+codes&hl=en&prmd=imvns&tbm=isch&tbo=u&source=univ&sa=X&ei=alz4T-ZB477QAeW00fYG&ved=0CGkQsAQ&biw=1280&bih=963#hl=en&tbm=isch&q=rgb+color+chart&revid=2016809888&sa=X&ei=blz4T9O4EqXD0QHenJTfBg&ved=0CEgQgxY&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=fd6b265ac54d034a&biw=1280&bih=963)

另一种选择是使用[HSV 颜色系统](http://en.wikipedia.org/wiki/HSL_and_HSV)，然后如果您确实需要 RGB，则将其转换为 RGB。我个人发现在生成一系列可用颜色时使用 HSV 更容易、更简洁。

# sql - sql计数记录

> ID：11376441
> 
> 赞同：0
> 
> 时间：2012-07-07T15:52:10.657
> 
> 标签：sql

我有一个包含酒店、客户、定价等的餐桌预订

现在我想通过计算我的定价来计算每家酒店的总和。

我已经有一个查询可以计算每条记录的价格，但现在我想查看每家酒店的价格。

这就是我所拥有的：

```
select c.naam,((d.prijs+e.prijs+f.prijs)*(a.eind_datum - a.start_datum) )as sum 
from hotel c, kamer b, reservatie a, verblijfsformule d, verblijfsperiode e, kamertype f 
where a.kamerid = b.kamerid and b.hotelid = c.hotelid and a.verblijfsformuleid =   d.verblijfsformuleid and a.verblijfsperiodeid = e.verblijfsperiodeid and b.kamertypeid =   f.kamertypeid 
```

如果我运行这个查询，它会给我这个结果：

```
Name -           sum
Hilton antwerp - 2100
Hilton antwerp - 2250
Consequat      - 2000
consequat      - 1200
Hilton antwerp - 3000 
```

因此，正如您所看到的，它给出了正确的总和，而不是只给 hilton antwerp 和 Consequat 1 次，并将所有这些总和每家酒店相加，它总是单独给出。

我该如何解决这个问题？我尝试使用 Group BY a.hotelid，它给了我 2 家酒店，但只有第一条记录的总和，然后它没有加起来。

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:01:07.380

```
SELECT c.naam
    ,SUM((d.prijs+e.prijs+f.prijs)*(a.eind_datum - a.start_datum)) AS PriceSum
FROM hotel c
    INNER JOIN kamer b
        ON b.hotelid = c.hotelid
    INNER JOIN reservatie a
        ON a.kamerid = b.kamerid
    INNER JOIN verblijfsformule d
        ON a.verblijfsformuleid = d.verblijfsformuleid
    INNER JOIN verblijfsperiode e
        ON a.verblijfsperiodeid = e.verblijfsperiodeid
    INNER JOIN kamertype f
        ON b.kamertypeid = f.kamertypeid 
GROUP BY c.naam 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T15:54:45.560

您需要使用该`group by`子句。

像这样：

```
select c.naam,((d.prijs+e.prijs+f.prijs)*(a.eind_datum - a.start_datum) )as sum 
  from hotel c, kamer b, reservatie a, verblijfsformule d, 
       verblijfsperiode e, kamertype f 
 where a.kamerid = b.kamerid
   and b.hotelid = c.hotelid 
   and a.verblijfsformuleid =   d.verblijfsformuleid 
   and a.verblijfsperiodeid = e.verblijfsperiodeid 
   and b.kamertypeid =   f.kamertypeid
 group by c.naam 
```

而已。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T15:56:34.147

您需要添加一个`GROUP BY`子句。 `SELECT`...... `GROUP BY hotelid`_

# php - 教义2：未定义的索引

> ID：11376444
> 
> 赞同：0
> 
> 时间：2012-07-07T15:52:31.880
> 
> 标签：php, doctrine, doctrine-orm

当我尝试执行此 DQL 查询时：

```
SELECT r, s FROM Rule r
JOIN r.splash_page s
WHERE r.active = 1 
```

我想要做的只是加入两个实体，我得到这个错误：

```
Notice: Undefined index: rules in C:\xampp\htdocs\excap\vendor\doctrine\orm\lib\Doctrine\ORM\Internal\Hydration\ObjectHydrator.php on line 110
Notice: Undefined index: rules in C:\xampp\htdocs\excap\vendor\doctrine\orm\lib\Doctrine\ORM\Internal\Hydration\ObjectHydrator.php on line 428
Notice: Undefined index: rules in C:\xampp\htdocs\excap\vendor\doctrine\orm\lib\Doctrine\ORM\Internal\Hydration\ObjectHydrator.php on line 428
Notice: Undefined index: rules in C:\xampp\htdocs\excap\vendor\doctrine\orm\lib\Doctrine\ORM\Internal\Hydration\ObjectHydrator.php on line 428
Notice: Undefined index: rules in C:\xampp\htdocs\excap\vendor\doctrine\orm\lib\Doctrine\ORM\Internal\Hydration\ObjectHydrator.php on line 428 
```

这些是我的实体文件的一部分，我在其中声明它们之间的关系：

```
// Rule.php 
/**
 *
 * @var type 
 * @ManyToOne(targetEntity="SplashPage", inversedBy="rules")
 */
protected $splash_page; 
```

* * *

```
// SplashPage.php
/**
 *
 * @var type
 * OneToMany(targetEntity="Rule", mappedBy="splash_page") 
 */
protected $rules = null; 
```

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T19:45:42.877

您的文档块中有错字`$rules`：您忘记了`@`OneToMany 之前的标志

文档块应该是：

```
/**
 * @OneToMany(targetEntity="Rule", mappedBy="splash_page") 
 */
protected $rules = null; 
```

代替

```
/**
 * OneToMany(targetEntity="Rule", mappedBy="splash_page") 
 */
protected $rules = null; 
```

# sql-server - 空间索引使用 STContains 减慢查询速度

> ID：11376445
> 
> 赞同：1
> 
> 时间：2012-07-07T15:52:35.453
> 
> 标签：sql-server, tsql, sql-server-2012, spatial-index, spatial-query

我正在测试是否可以在 SQL Server 2012 上使用空间索引。

所以，我有一张桌子

```
CREATE TABLE [dbo].[Records]
(
 [ID] [uniqueidentifier] PRIMARY KEY NOT NULL,
 [Value] [nvarchar](256) NOT NULL,
 [Padding] [nvarchar](max) NOT NULL,
 [Bounds] [geometry] NOT NULL
) 
```

和一个索引

```
CREATE SPATIAL INDEX [RecordsSpatialIndex]
ON [Records]([Bounds])
USING GEOMETRY_GRID
WITH
(
    BOUNDING_BOX = (0, 0, 2000, 2000) -- all coordinates are within this range
); 
```

[Bounds] 列包含 5 点多边形，实际上是矩形 (x1 y1, x1 y2, x2 y2, x2 y1, x1 y1)。

@bounds 变量包含相同类型的矩形。奇怪的是下面的查询

```
SELECT
    [ID], [Value], [Padding]
FROM
    [Records]
WHERE
    ([Bounds].STContains(@Bounds) = 1) 
```

在没有空间索引的情况下运行速度提高了三倍以上。

对于索引，65% 的时间是 Clustered Index Seek over Records 表，29% 是 Filter。总共65秒。

如果没有索引，92% 的时间是过滤器，8% 的时间是聚集索引扫描记录表。总共19秒。

那么，我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T19:26:06.553

此外，这篇 MSDN[文章](http://msdn.microsoft.com/en-us/library/bb895265.aspx)对我了解如何创建对特定查询有用的索引很有帮助

# android - AndEngine中如何获取移动体的速度和矢量？

> ID：11376446
> 
> 赞同：0
> 
> 时间：2012-07-07T15:52:50.557
> 
> 标签：android, box2d, andengine, game-engine

我有一个小问题。我正在尝试制作空气曲棍球安卓游戏（类似于发光曲棍球）。在我了解 AndEngine 的第一步的冒险中，我发现了以下问题：在你可能知道的空气曲棍球中，玩家的圆盘可以通过触摸来移动。问题是，我需要获得玩家移动的速度和矢量。为什么？当玩家的身体与曲棍球的圆盘碰撞时（以适当的玩家速度跳转到矢量），我想制作完美的物理效果。我的意思是当玩家缓慢移动时 - 曲棍球的圆盘在与物体碰撞后会获得低速但矢量不会改变。等等也许你可以告诉我更好的解决我的问题？有没有针对此的 AndEngine 解决方案？十分感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T12:08:11.127

有两种方法可以解决这个问题。首先是通过 AndEngine Box2D 扩展。您可以将圆形“物体”应用于圆盘和圆盘，并使用诸如质量和摩擦力之类的物理元素，直到您对结果感到满意为止。论坛：[http ://www.andengine.org/forums/physics-box2d-extension/](http://www.andengine.org/forums/physics-box2d-extension/)

另一种选择是手动完成，如果您想要挑战，我只会这样做。就我个人而言，我会避免这种情况，因为 Box2D 会为您做很多数学运算:)

# javascript - 对 Regex JS 模式感到困惑

> ID：11376454
> 
> 赞同：0
> 
> 时间：2012-07-07T15:53:38.487
> 
> 标签：javascript, regex

好的，我的 div 中确实有以下数据

```
<div id="mydiv">
<!--
 what is your present
 <code>alert("this is my present");</code>
 where?
 <code>alert("here at my left hand");</code>
 oh thank you! i love you!! hehe
  <code>alert("welcome my honey ^^");</code>
-->
</div> 
```

好吧，我需要做的是获取`<code>`块内的所有脚本和 html 代码文本节点，而不删除里面的 html 注释。好吧，这是我教授的作业，我不能修改那个 div 块..

我需要为此使用正则表达式，这就是我所做的

```
var block = $.trim($("div#mydiv").html()).replace("<!--","").replace("-->","");
var htmlRegex = new RegExp(""); //I don't know what to do here
var codeRegex = new RegExp("^<code(*n)</code>$","igm");

var code = codeRegex.exec(block);
var html = ""; 
```

真的不行。。请不要给出确切的答案。。请教教我。。谢谢

我需要有以下变量块`code`

```
alert("this is my present");
alert("here at my left hand");
alert("welcome my honey ^^"); 
```

这是我需要的变量块`html`

```
 what is your present
     where?
     oh thank you! i love you!! hehe 
```

我的问题是获得上述结果的正则表达式模式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T17:35:08.127

使用正则表达式解析 HTML 不是您应该做的事情。

我敢肯定你的教授认为他/她真的很聪明，并且没有办法访问 DOM API，并且可以挥舞横幅并证明使用正则表达式解析 DOM 的一些小角落案例是合理的，有时它还可以。

嗯，不，不是。如果那里有复杂的代码，会发生什么？您的正则表达式会中断，如果它曾经在生产中，它可能会成为一个安全漏洞。

所以在这里：

[http://jsfiddle.net/zfp6D/](http://jsfiddle.net/zfp6D/)

1.  走dom，从节点中获取nodeType 8（注释）文本值。
2.  调用HTML解析器（浏览器用来解析HTML的东西，而不是正则表达式，为什么你不使用HTML解析器来解析HTML完全超出了我的理解，就像说“是的，我可以用锤子钉上这个钉子，但我想我会用脚踩在钉子上，直到钉子钉进去”）。
3.  在新解析的 HTML 中查找所有 CODE 元素。
4.  将它们记录到控制台，或任何你想对它们做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:45:53.027

首先，您应该知道，由于 HTML 不是正则语言，因此您不能使用适用于所有有效输入的正则表达式进行通用解析（特别是通用嵌套不能用正则表达式表示）。许多解析器确实使用正则表达式来匹配单个标记，但需要围绕它们构建其他算法

但是，对于像这样的固定输入，这只是处理您拥有的结构的一种情况（尽管使用不同的解析方法通常比使用正则表达式更容易）。

首先让我们获取所有代码：

```
var code = '', match = [];
var regex = new RegExp("<code>(.*?)</code>", "g");
while (match = regex.exec(content)) {
    code += match[1] + "\n";
} 
```

我假设`content`包含您已经提取的 div 的内容。这里的“g”标志表示这是“全局”匹配，所以我们可以重用正则表达式来查找每个匹配项。方括号表示一个捕获组，`.`表示任何字符，`*`表示重复 0 次或多次，`?`表示“非贪婪”（看看没有它会发生什么，看看它做了什么）。

现在我们可以做类似的事情来获取所有其他位，但这次正则表达式稍微复杂一些：

```
new RegExp("(<!--|</code>)(.*?)(-->|<code>)", "g") 
```

这里`|`的意思是“或”。所以这匹配所有以“开始注释”或“结束代码”开头并以“结束注释”或“开始代码”结尾的位。另请注意，我们现在有 3 组括号，因此我们要提取的部分是`match[2]`（第二组）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T18:08:52.663

你做了很多不必要的事情。.html() 将内部内容作为字符串提供给您。您应该能够使用 regEx 从那里准确获取您需要的内容。此外，尝试坚持使用正则表达式文字（例如`/^regexstring$/`）。您必须使用非常混乱的新 RegExp 来转义转义字符。当您需要将字符串 var 放入正则表达式时，您通常只想使用新的正则表达式。

字符串的匹配函数接受正则表达式并在您添加全局标志时返回每个匹配项的集合（例如`/^regexstring$/g`<--注意'g'）。我会做这样的事情：

```
var block = $('#mydiv').html(), //you can set multiple vars in one statement w/commas
matches = block.match(/<code>[^<]*<\/code>/g);

//[^<]* <-- 0 or more characters that aren't '<' - google 'negative character class'

matches.join('_') //lazy way of avoiding a loop - join into a string with a safe character
.replace(/<\/*code>/g,'') //\/* 0 or more forward slashes
.split('_');//return the matches string back to array

//Now do what you want with matches. Eval (ew) or append in a script tag (ew).
//You have no control over the 'ew'. I just prefer data to scripts in strings 
```

# django - 具有共享代码库和数据库的多个 Django 站点

> ID：11376455
> 
> 赞同：8
> 
> 时间：2012-07-07T15:53:45.420
> 
> 标签：django, heroku, django-sites

我为 20 个不同的国家/地区创建了一个包含 20 个站点（每个站点一个不同的域）的 Django 项目。这些网站共享所有内容：代码库、数据库、网址、模板等。

他们唯一不共享的是我在每个站点设置文件中设置的小自定义（徽标、CSS 主题的背景颜色、语言代码等）（每个站点都有一个设置文件，以及所有这些文件导入带有通用内容的全局设置文件）。现在，为了在开发模式下运行站点，我将执行以下操作：

```
django-admin.py runserver 8000 --settings=config.site_settings.site1
django-admin.py runserver 8001 --settings=config.site_settings.site2
...
django-admin.py runserver 8020 --settings=config.site_settings.site20 
```

我有一些问题：

1.  我读过可以为每个站点（域）创建一个虚拟主机并将其传递给站点的 settings.py 文件。但是，恐怕这会为每个站点创建一个 Django 实例。我对吗？
2.  有没有更有效的部署方式？我已经阅读了有关[django-dynamicsites 的](http://blog.uysrc.com/2011/03/23/serving-multiple-sites-with-django/)信息，但我不确定这是否是正确的方法。
3.  如果我决定使用 Heroku 进行部署，似乎 Heroku 期望每个应用程序只有一个设置文件，所以我需要有 20 个应用程序。有解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T21:41:21.063

所以，我最近做了类似的事情，发现下面的策略是最好的选择。我将假设您此时熟悉 git 分支以及 Heroku 遥控器。如果你不是，你应该先阅读这个：[https ://devcenter.heroku.com/articles/git#multiple-remotes-and-environments](https://devcenter.heroku.com/articles/git#multiple-remotes-and-environments)

我正在采取的主要策略是拥有一个单一的代码库（一个单一的 Git 存储库），其中包含：

*   `master`包含所有共享代码的分支：模板、视图、URL。
*   许多`site`基于 的分支，`master`其中包含所有特定于站点的自定义：css、图像、设置文件（如果它们有很大不同）。

它的工作方式是这样的：

首先，确保你在`master`分支上。

其次，为您的一个域创建一个新的 git 分支，例如：`git checkout -b somedomain.com`.

第三，自定义您的`somedomain.com`分支，使其看起来像您想要的那样。

接下来，通过运行实时部署`somedomain.com`到 Heroku `heroku create somedomain.com --remote somedomain.com`。

现在，将您的`somedomain.com`分支代码推送到您的新 Heroku 应用程序：`git push somedomain.com somedomain.com:master`. 这将在 Heroku 上部署您的代码。

现在您已经`somedomain.com`使用自己的 Heroku 应用程序部署了您的分支，您可以通过添加`--remote somedomain.com`到您的普通 Heroku 命令来完成所有普通 Heroku 的工作，例如：

*   `heroku pg:info --remote somedomain.com`
*   `heroku addons:add memcache:5mb --remote somedomain.com`
*   等等

所以，现在你基本上有了两个分支：一个`master`分支，一个`somedomain.com`分支。

返回您的`master`分支，为您的下一个域创建另一个新分支：`git checkout master; git checkout -b anotherdomain.com`. 然后根据您的喜好对其进行自定义（css，特定于站点的内容），并按照我们上面所做的相同方式进行部署。

现在我相信你现在可以看到这是怎么回事。我们的每个 custom 都有一个 git 分支，`domains`每个域都有自己的 Heroku 应用程序。好处（显然）是这些项目自定义中的每一个都基于`master`分支，这意味着您可以轻松地一次对*所有*站点进行更新。

假设您更新了`master`分支中的一个视图——如何一次将其部署到*所有*自定义站点？容易地！

赶紧跑：

*   `git checkout somedomain.com`
*   `git merge master`
*   `git push somedomain.com somedomain.com:master`# 部署更改

并为您的每个域重复。在我的环境中，我编写了一个脚本来执行此操作，但如果您愿意，手动操作也很容易。

无论如何，希望这会有所帮助。

# java - 有没有更小的、可再发行的 java 编译器？

> ID：11376460
> 
> 赞同：4
> 
> 时间：2012-07-07T15:54:29.973
> 
> 标签：java, compiler-construction

我的代码需要编译 java 源代码，当我现在使用 JavaCompiler API 时，在没有 JDK 的计算机上运行时，它返回 null。我意识到我可以将 JDK 与我的程序一起打包，但是超过 100mb，包含在一个小程序中会非常大。我四处寻找第三方编译器，最好比 JDK 小，如果有人知道可以添加到我的程序中的编译器，我将不胜感激。（我打算使用运行时脚本通过命令行编译一组文件。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:16:45.217

看看[这个项目](http://docs.codehaus.org/display/JANINO/Home)。我自己没有使用它，但它看起来像你正在寻找的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T18:46:22.910

您真的需要编译整个 Java 源文件，还是只编译单个方法？[如果是后者，Javassist 可以使用CtMethod.make](http://www.csg.ci.i.u-tokyo.ac.jp/~chiba/javassist/html/javassist/CtMethod.html#make%28java.lang.String,%20javassist.CtClass%29)完成您需要的工作。这[很简单](http://www.csg.ci.i.u-tokyo.ac.jp/~chiba/javassist/tutorial/tutorial2.html#add)。

Javassist 并不小——大约 650 kB——但它比 JDK 小。

# jquery-datatables - 数据表可以对带有输入字段的列进行排序吗？

> ID：11376469
> 
> 赞同：8
> 
> 时间：2012-07-07T15:55:45.403
> 
> 标签：jquery-datatables

我正在尝试使数据表对我的列进行排序。第一列可以正常工作，因为它是一个简单的数字。但是，下一列是输入字段。当我尝试进行那种排序时，什么也没有发生。

```
<table width="100%" cellspacing="0" class="table sortable no-margin">
<thead>
<tr>
   <th scope="col" class="sorting" style="width: 57px;">
        <span class="column-sort">
        <a href="#" title="Sort up" class="sort-up"></a>
        <a href="#" title="Sort down" class="sort-down"></a>
        </span>
        ID
   </th>
   <th scope="col" class="sorting_desc" style="width: 94px;">
        <span class="column-sort">
        <a href="#" title="Sort up" class="sort-up"></a>
        <a href="#" title="Sort down" class="sort-down"></a>
        </span>
        Order
   </th>
</tr>
</thead>
<tbody>
<tr id="row_20" class="odd">
    <td id="refKey_20" style="text-align:center;" class="">
        1Y
    </td>
    <td class=" sorting_1">
        <input type="text" value="160" size="3" name="item.Order" 
        maxlength="3" id="Order_20" >
    </td>

</tr>
<tr id="row_19" class="even">
    <td id="refKey_19" style="text-align:center;" class="">
        1X
    </td>
    <td class=" sorting_1">
        <input type="text" value="150" size="3" name="item.Order" 
        maxlength="3" id="Order_19" >
    </td>

</tr>
</tbody>
</table> 
```

有什么方法可以让数据表对输入字段进行排序？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2018-12-26T08:12:24.217

最简单的方法是在列内添加隐藏跨度 `<span style="visibility:hidden">value of the input</span>`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-08T14:39:48.427

您应该查看这个示例，该示例解释了如何[对输入字段进行排序。](http://datatables.net/examples/plug-ins/dom_sort.html)基本上你声明一个排序函数

```
/* Create an array with the values of all the input boxes in a column */
$.fn.dataTableExt.afnSortData['dom-text'] = function  ( oSettings, iColumn )
{
    var aData = [];
    $( 'td:eq('+iColumn+') input', oSettings.oApi._fnGetTrNodes(oSettings) ).each( function () {
        aData.push( this.value );
    } );
    return aData;
} 
```

然后告诉你的桌子使用它

```
$('#example').dataTable( {
    "aoColumns": [
        null,
        { "sSortDataType": "dom-text" }
    ]
} ); 
```

或机智 aoColumnDefs

```
$('#example').dataTable( {
    "aoColumnDefs": [{ "sSortDataType": "dom-text" , aTarget: "yourclass"}]
} ); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-03-23T22:51:12.743

对于 Datatables 1.10+ 的版本，一些选项变量的名称已更改，并引入了新的 API。此处的文档：http: [//datatables.net/examples/plug-ins/dom_sort.html](http://datatables.net/examples/plug-ins/dom_sort.html)。

这是 1.10+ 中上述已接受答案的工作版本：

```
$(document).ready(function () {
    var table = $('#example').DataTable({
        "columnDefs": [
            {
                "orderDataType": "dom-input",
                "targets": 0, // Just the first column
            },
        ],
    });
}); 
```

自定义排序功能：

```
$.fn.dataTable.ext.order['dom-input'] = function (settings, col) {
    return this.api().column(col, { order: 'index' }).nodes().map(function (td, i) {
        return $('input', td).val();
    });
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-30T16:34:22.667

```
jQuery.fn.dataTableExt.oSort['textbox-asc'] = function (a, b) {
    var vala = $('#' + $(a).filter('input').attr('id')).val().toLowerCase();
    var valb = $('#' + $(b).filter('input').attr('id')).val().toLowerCase();
    if (vala === '')
        return 1;
    if (valb === '')
        return -1;
    return vala < valb ? -1 : vala > valb ? 1 : 0;
};

jQuery.fn.dataTableExt.oSort['textbox-desc'] = function (a, b) {
    var vala = $('#' + $(a).filter('input').attr('id')).val().toLowerCase();
    var valb = $('#' + $(b).filter('input').attr('id')).val().toLowerCase();
    if (vala === '')
        return 1;
    if (valb === '')
        return -1;
    return vala < valb ? 1 : vala > valb ? -1 : 0;
}; 
```

然后像这样使用它

```
 $(datatable).dataTable({
                    "iDisplayLength": 50,
                    "bLengthChange": false,
                    "bPaginate": false,                        
                    "columns": [
                        null, { "sType": "textbox" }
                    ],
                }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-16T19:06:21.060

如果您决定使用列选项从 JSON 文件中渲染信息，您可以轻松地在渲染属性上添加隐藏跨度。看起来好像 DataTables 查找要排序的文本，如果找不到，它将中断。[https://datatables.net/examples/plug-ins/dom_sort.html](https://datatables.net/examples/plug-ins/dom_sort.html)上的示例使用了一个已经呈现的表。下面是一个使用 API 的示例：

```
...columns([{ 
        "data": "receivedDate",
        "render": function (data, type, row, meta)
        {

            if (data == "null")
            {
                return "<input type='text' id='datepicker_" + meta.row + "' class='datepicker form-control' /><span class='hidden'><span>";
            }
            else
            {
                return "<input type='text' id='datepicker_" + meta.row + "' class='datepicker form-control' value='" + moment(data).format("MM/DD/YYYY") + "'/><span class='hidden'>" + moment(data).format('MM/ DD / YYYY') + "</span>";
            }
        }
    }]); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-12-13T11:46:25.467

使用输入字段之前的值设置一个不可见的 div。

```
<tbody>
<tr id="row_20" class="odd">
    <td id="refKey_20" style="text-align:center;" class="">
        1Y
    </td>
    <td class=" sorting_1">
        <div style="display:none;">160</div>
        <input type="text" value="160" size="3" name="item.Order" 
        maxlength="3" id="Order_20" >
    </td>

</tr>
<tr id="row_19" class="even">
    <td id="refKey_19" style="text-align:center;" class="">
        1X
    </td>
    <td class=" sorting_1">
        <div style="display:none;">150</div>
        <input type="text" value="150" size="3" name="item.Order" 
        maxlength="3" id="Order_19" >
    </td>
</tr>
</tbody> 
```

# uitableview - 删除带有静态单元格的 UITableView 的一部分的最佳方法是什么？

> ID：11376470
> 
> 赞同：3
> 
> 时间：2012-07-07T15:55:46.057
> 
> 标签：uitableview, ios5

我的 iPhone 应用程序的`UITableView`一部分以分组格式显示三个静态部分。然而，在某些情况下（基于用户输入），当视图控制器显示表格时，这些部分中的最后一个不出现是最合适的。

在`viewDidLoad`控制器的方法中，我添加了以下有条件执行的代码行：

```
if ([self.formula containsElementWithoutStableIsotopes]) {
    NSLog(@"Deleting section 2 ...");
    NSUInteger sectionToDelete = 2;
    [self.tableView deleteSections:[NSIndexSet indexSetWithIndex:sectionToDelete] 
                  withRowAnimation:UITableViewRowAnimationAutomatic];
} 
```

“删除第 2 节 ...”记录到控制台，所以我知道这段代码正在执行，但表格似乎没有受到影响：所有三个部分都照常显示。

在理想情况下，我希望在表格视图显示之前删除第 2 部分，但我可以忍受它在出现时被删除。但是，如果我将上面的代码放在`viewDidAppear`方法中，程序会引发 an，`NSInternalInconsistencyException`因为删除前后的节数不匹配。

我真的很感谢你在这个话题上的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T15:59:49.603

请使用以下代码：

```
- (void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];
    sectionToDelete = 1;
    [self.tableView deleteSections:[NSIndexSet indexSetWithIndex:sectionToDelete] withRowAnimation:UITableViewRowAnimationFade];
    [self.tableView reloadData];

}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 3 - numberOfSectionsToDelete;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-21T04:48:48.130

最好的办法是——

```
[myTableView beginUpdates];
[myArray removeObjectAtIndex:myIndexPath.section];
[myTableView deleteSections:[NSIndexSet indexSetWithIndex:myIndexPath.section] 
           withRowAnimation:UITableViewRowAnimationRight];
[myTableView endUpdates]; 
```

# ruby-on-rails-3 - Rails 3.2.2 动作被调用两次

> ID：11376475
> 
> 赞同：2
> 
> 时间：2012-07-07T15:56:04.817
> 
> 标签：ruby-on-rails-3

我的应用程序基于**`Rails 3.2.2.`**面临一些奇怪的问题：开发/生产中的所有操作都被调用了两次。有什么建议么？

```
Started GET "/faqs" for 127.0.0.1 at 2012-07-07 17:08:06 +0200
Processing by FaqsController#index as HTML
  Faq Load (0.5ms)  SELECT `faqs`.* FROM `faqs` WHERE `faqs`.`active` = 1 ORDER BY position asc
  Rendered faqs/index.html.haml within layouts/application (3.1ms)
  Rendered shared/_navigation_bar.html.haml (5.3ms)
  Rendered devise/registrations/_register.html.erb (5.5ms)
Completed 200 OK in 137ms (Views: 43.3ms | ActiveRecord: 0.5ms | Solr: 0.0ms)

Started GET "/faqs" for 127.0.0.1 at 2012-07-07 17:08:06 +0200
Processing by FaqsController#index as */*
  Faq Load (0.2ms)  SELECT `faqs`.* FROM `faqs` WHERE `faqs`.`active` = 1 ORDER BY position asc
  Rendered faqs/index.html.haml within layouts/application (0.2ms)
  Rendered shared/_navigation_bar.html.haml (3.9ms)
  Rendered devise/registrations/_register.html.erb (12.1ms)
Completed 200 OK in 33ms (Views: 30.2ms | ActiveRecord: 0.2ms | Solr: 0.0ms) 
```

* * *

**更新#1**

简单的控制器：

```
class FaqsController < ApplicationController
  respond_to :html

  def index
    @faqs = Faq.all
    respond_with(@faqs)
  end
end 
```

视图也很简单：

```
%h2 Faqs
- @faqs.each_with_index do |faq, index|
  .span9  
    %h3
      = "%d." % (index + 1)
      = faq.title
    %p= faq.body 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-13T17:10:43.380

This is probably due to Chrome. You can test in Safari/Firefox/IE etc

The reason I believe it causes two loads is because Chrome "forks" the request and essentially makes two requests. It renders the first one that returns in its window.

IIRC I researched this many years ago and this was a feature implemented to render pages faster.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T17:58:27.983

这个问题可能与 Rails 3.2.2 没有任何关系。

如果您的页面上有 javascript 在页面加载时发出 ajax 请求，就会看到这种确切的行为。我将遍历您的所有脚本资产，并寻找一个旨在在页面加载后回调您的应用程序的脚本资产。你可能会在那里找到罪魁祸首。

# javascript - 创建滑块函数

> ID：11376480
> 
> 赞同：0
> 
> 时间：2012-07-07T15:56:17.040
> 
> 标签：javascript, jquery

我正在创建一个轮播（我知道那里有插件，但我想创建自己的）。我正在努力将这段代码放在一个函数中，因为我必须返回一个真值或假值才能让代码再次运行。到目前为止，我有这个重复的代码：

```
if(!active) {
        active = true;
        $('#box ul').animate({ 'left': left_indent }, 500, function () {
            $('#box li:last').after($('#box li:first'));
            $('#box ul').css({ 'left': left_value });
            active = false;
        });
    } 
```

我已经尝试将它放入这样的函数中：

```
function slider(left_indent, left_value) {
$('#box ul').animate({'left' : left_indent}, 500,function(){   

    $('#box li:first').before($('#box li:last'));          
    $('#box ul').css({'left' : left_value});

    var active = false;
}); 
```

}

我试过这样称呼它：

```
if(!active) {
        active = true;
        slider(left_indent, left_value);
    } 
```

每次我调用该函数时，我似乎都无法主动返回 false。我不确定我错过了什么。

到目前为止，这是我的所有代码：

```
$(function () {
var item_width = $("#box li img").outerWidth();
var left_value = item_width * (-1);

$('#box li:first').before($('#box li:last'));
$('#box ul').css({ 'left': left_value });

var active = false;
$("#next").click(function () {
    var left_indent = parseInt($('#box ul').css('left')) - item_width;

    if(!active) {
        active = true;
        $('#box ul').animate({ 'left': left_indent }, 500, function () {
            $('#box li:last').after($('#box li:first'));
            $('#box ul').css({ 'left': left_value });
            active = false;
        });
    }
    return false;
});

$("#back").click(function () {
    var left_indent = parseInt($('#box ul').css('left')) + item_width;

    if(!active) {
        active = true;
        slider(left_indent, left_value);
    }
    return false;
}); 
```

});

函数滑块（left_indent，left_value）{ $（'#box ul'）.animate（{'left'：left_indent}，500，function（）{

```
 $('#box li:first').before($('#box li:last'));          
    $('#box ul').css({'left' : left_value});

    var active = false;
}); 
```

}

任何建议都会很棒。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:19:05.983

您不能真正以有用的方式从这样的回调中返回函数。因为外部函数会在回调改变它之前返回活动状态。此外，您使用 'var' 重新定义/重新定义了活动范围，因此无论如何您都不会更改外部活动。您需要的是在共享范围中处于活动状态并在单击处理程序中进行测试。

就像是：

```
var active = false;

//assumes left_indent, left_value defined further up
$('#slideRightBtn').click(function(){
    if(!active){ slider(left_indent,left_value)); }
});

function slider(left_indent, left_value) {

    //Don't use 'var' for active here
    //that sets a new var 'active' in the scope of this func

    active = true;
    $('#box ul').animate({'left' : left_indent}, 500,function(){   

        $('#box li:first').before($('#box li:last'));          
        $('#box ul').css({'left' : left_value});

        active = false;
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:25:50.490

`var`如果要修改外部范围或全局变量中的变量，则可以从函数内的最后一行代码中删除，只需：

```
function slider(left_indent, left_value) {
$('#box ul').animate({'left' : left_indent}, 500,function(){   

    $('#box li:first').before($('#box li:last'));          
    $('#box ul').css({'left' : left_value});

    active = false; // Changed!
}); 
```

注意：...但请不要这样做。事实上，你可以做到这一点——在外部范围内修改一个变量，而不仅仅是访问它的值，这对 Javascript 来说是一个“坏事”——在像 Python 这样的“理智”语言中，你不能这样做！[一些像LiveScript](http://gkz.github.com/LiveScript/)这样的Javascript“替代品”甚至使这成为不可能（实际上你必须为此使用特殊的语法），但不幸的是，更流行的 CoffeeScript 没有:( 选择一本好的 Javascript 书并学习编写结构良好的代码，如果你继续阅读任何更复杂的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:27:34.247

active 不在同一范围内。请参阅工作示例[http://jsfiddle.net/AvzvJ/7/](http://jsfiddle.net/AvzvJ/7/)

但是，为此使用像 active 这样的信号量是不好的风格。

# php - 如何在php中检查指定像素附近的像素：颜色

> ID：11376484
> 
> 赞同：0
> 
> 时间：2012-07-07T15:56:31.887
> 
> 标签：php, image, pixel

在这里我尝试检查图像，但它有一些另一种颜色的“椭圆”，我尝试用我的颜色平滑它们。但是我的代码只搜索特定的颜色，怎么说他例如5%的差异是不好的呢？如何在我的像素附近找到所有相同的像素并将它们着色为另一种颜色？

```
<?php
function LoadJpeg($imgname)
{
    $count = 0;
    /* Attempt to open */
    $im = @imagecreatefrompng($imgname);
    $imagedata = getimagesize($imgname);

    for($i=0; $i<$imagedata[0]; $i++){
        for($j=0; $j<$imagedata[1]; $j++){
            $rgb[$i][$j] = imagecolorat($im, $i, $j);
            //echo $rgb[$i][$j];
            //echo "<br>";
        }
    }
    for($i=0; $i<$imagedata[0]-5; $i++){
        for($j=0; $j<$imagedata[1]-5; $j++){
            if (($rgb[$i][$j] == $rgb[$i+3][$j]) || ($rgb[$i][$j] == $rgb[$i][$j+3]))
            {
                #echo "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAa";
                $count = $count + 1;
                //echo "<br> <br>";
                //echo $count;
                //$red = imagecolorallocate($im, 255, 255, 255);
                imagesetpixel($im, $i, $j, 13437229);
            }

        }
    }
    return $im;
}

header('Content-Type: image/jpeg');

$img = LoadJpeg('1.png');

// echo "Image width  is: " . $imagedata[0];
// echo "Image height is: " . $imagedata[1];

imagejpeg($img,null, 100);

?> 
```

主要问题是strong ==，但是我的if case 必须捕捉到这种颜色的一些差异。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:04:35.777

What about calculating distance between each color component? If one of the components differ by more than 5 percents, return false:

```
// Returns RGB components of the color represented by an integer
function components($color) {
  return array(($color >> 16) & 0xFF, ($color >> 8) & 0xFF, $color & 0xFF);
}

// Performs "similarity test" of 2 colors
function isSimilar($color1, $color2) {
  $c1 = components($color1);
  $c2 = components($color2);
  for ($i = 0; $i < 3; $i++) {
    $k = ($c1[$i] > $c2[$i]) ? ($c1[$i] - $c2[$i]) / $c2[$i] : ($c2[$i] - $c1[$i]) / $c1[$i];
    if ($k > 0.05) return false;
  }
  return true;
}

// ...
if (isSimilar($rgb[$i][$j], $rgb[$i][$j + 3]) or isSimilar($rgb[$i][$j], $rgb[$i + 3][$j])) {
  // ...
} 
```

The code may require additional testing and tweaking, but I think you've got an idea.

# rest - memcached 键命名

> ID：11376490
> 
> 赞同：1
> 
> 时间：2012-07-07T15:57:29.033
> 
> 标签：rest, memcached

我正在构建一个使用 memcached 的休息服务。支持我的服务句柄：

```
GET http://server/books/6/pages?top=10&skip=5&sort=number 
```

使用 url 作为 memcached 键更好吗？或者我应该通过以某种方式连接参数来构建自己的密钥字符串？例如“books_6_10_5_number”。或者 key 可以是参数的 json 表示？

使用网址非常容易。但是，如果有人交换了参数的顺序，就会出现缓存未命中。

同样的问题也与 sql 查询有关——我应该将 sql 存储为键还是将其分解为参数。

编辑：按照建议，排序适用于 url（尽管不适用于 sql）。问题更笼统：使用原始格式（url，sql）与滚动我自己的格式（“books_6_10_5_number”）是否有任何其他权衡

# linux - 无法访问相对于 CANVAS 小部件的鼠标坐标

> ID：11376491
> 
> 赞同：1
> 
> 时间：2012-07-07T15:57:47.650
> 
> 标签：linux, common-lisp, x86-64, sbcl, ltk

我正在 AMD64 机器上使用 SBCL for Linux。
函数 ANIMTEST 用 CANVAS 小部件实例化一个 LTK 窗口。两个项目，BARRIER 和 FOLLOWER，存在于画布中。两者都连续旋转，BARRIER 位于画布中心，FOLLOWER 旨在跟随鼠标，但未按预期工作。我的第一次尝试（见评论）导致鼠标的绝对屏幕坐标被解释为画布内的相对坐标，而不考虑两者之间的偏移。在搜索 ltk.lisp 和文档后，我找到了 SCREEN-MOUSE-X/Y（第二次尝试，见评论）。根据文档，我觉得我正在使用 SCREEN-MOUSE-X & -Y，但为什么它不起作用？= 注意 = 包含 ANIMTEST 的文件和支持它的包可以正常加载和运行。我定义的函数（UCTK-BEAM 等）经过测试并且运行良好。

```
(defun animtest ()
      "Test a spinning figure in LTK"
      (with-ltk ()
        (let* ((cnvs (make-instance 'canvas :width 400 :height 400))
           (barrier (uctk-beam 200 200 40 20))
           (follower (uctk-beam 0 40 40 20))
           (slp-time 50) ; in ms
           (bar-theta 0)
           (fol-theta 0))
          (labels ((update ()
             (draw barrier nil)
             (draw follower nil)
             (incf bar-theta (/ pi 15))
             (incf fol-theta (/ pi 15))
             (geo:set-theta barrier bar-theta)
             (geo:set-theta follower fol-theta)
             (geo:set-center follower 
                     ;== FIRST ATTEMPT ==
                     (cons (screen-mouse-x cnvs)
                       (screen-mouse-y cnvs)))
                     ; == SECOND ATTEMPT ==
                     ;(cons (canvasx cnvs (screen-mouse-x cnvs))
                    ;   (canvasy cnvs (screen-mouse-y cnvs))))
             (after slp-time #'update)))
        (pack cnvs :fill :both :expand 1)
        (update))))) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T07:23:29.267

为了在画布小部件中获取鼠标位置，我不调用屏幕鼠标函数，而是绑定动作和按钮按下事件。回调传递了包含插槽 event-x 和 event-y 的事件结构，它们是画布坐标。通过这种方式，您不仅可以直接获得正确的值，而且效率更高，因为您不必轮询鼠标位置——当它发生变化时，您会自动获得更新。在您的情况下，您可以选择在鼠标移动时更新屏障，或者将鼠标坐标存储在您在更新循环中读取的变量中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T21:34:48.423

尽管 CANVASX/Y 函数似乎仍然无法按预期工作，但 LTK 提供了 WINDOW-X/-Y 来返回小部件的 X 和 Y 屏幕坐标，以便您可以编写以下代码来达到预期的效果：

```
(cons (- (screen-mouse-x) (window-x cnvs))
      (- (screen-mouse-y) (window-y cnvs))) 
```

这假定鼠标光标与名为 CNVS 的画布小部件位于同一屏幕上。

# xcode - XCode防止UIWebView在启动图像后闪烁白屏

> ID：11376495
> 
> 赞同：1
> 
> 时间：2012-07-07T15:58:17.767
> 
> 标签：xcode, ios5, uiwebview

我对 XCode 相当陌生 - 我正在设计一个具有单个视图的应用程序，该视图仅显示加载我的 jQuery 移动网站的 UIWebView。

我有用于启动图像的 Default.png 和 Default@2x.png 文件。当我在测试设备或模拟器中运行应用程序时，它会显示我的启动图像，然后在 UIWebView 加载第一页时闪烁白屏。

我知道我可以改变背景颜色和不透明度，所以它会闪烁不同于白色的颜色，但我想完全防止闪烁。我希望应用程序启动，显示启动图像，并且在第一页完全加载之前不显示 UIWebView。帮助？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T12:48:20.690

@ Andreas Volz（还有其他想知道我如何解决白色“闪光”问题的人）

首先，将`name-of-loading-image.png`和`name-of-loading-image@2x.png`文件添加到您的 Xcode 项目中。常规图像应为 320 x 460，`@2x`图像应为 640 x 920。

然后，在我的`ViewController.h`文件中，我添加了这些属性：

```
@property (nonatomic, retain) UIWebView *webView;
@property(nonatomic, strong) UIImageView *loadingImageView;
@end 
```

然后在我的`ViewController.m`文件中我添加了这个：

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController;

@synthesize webView;
@synthesize loadingImageView;

- (void)viewDidLoad
{
    [super viewDidLoad];

    //**************** Set website URL for UIWebView
    [webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.example.com"] cachePolicy:NSURLCacheStorageAllowed timeoutInterval:20.0]];

    //**************** Add Static loading image to prevent white "flash" ****************/  
    UIImage *loadingImage = [UIImage imageNamed:@"name-of-loading-image.png"];
    loadingImageView = [[UIImageView alloc] initWithImage:loadingImage];
        loadingImageView.animationImages = [NSArray arrayWithObjects:
                                            [UIImage imageNamed:@"name-of-loading-image.png"],
                                            nil];
    [self.view addSubview:loadingImageView];   

}

- (void)webViewDidFinishLoad:(UIWebView *)webView {

    // Remove loading image from view
    [loadingImageView removeFromSuperview];

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T22:03:07.153

要知道您的 webView 何时完成加载，您必须实现 UIWebViewDelegate 协议。

在您的 viewController 的 .h 文件中：

```
@interface viewController : UIViewController <UIWebViewDelegate>
{
    UIWebView *webView;
}
@end 
```

然后在 viewController 的 .m 文件中，添加这个方法：

```
- (void)webViewDidFinishLoad:(UIWebView *)webView {

    NSLog(@"content loading finished");
    // Display your webView
    [self.view addSubview:webView];

} 
```

您可以在 viewController 的 .m 中使用 -viewDidLoad 方法来继续显示您的启动图像。你也可以开始为你的 webView 加载内容：

```
- (void)viewDidLoad {
    [super viewDidLoad];

    // continue to display launch image
    UIImage *launchImage = [[UIImage alloc] initWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"launchImage.png" ofType:nil ]];
    UIImageView *launchImageView = [[[UIImageView alloc] initWithImage:launchImage] autorelease];
    [self.view addSubview:launchImageView];

    // now setup the base view for the webView controller
    UIView *contentView = [[UIView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]];
    contentView.backgroundColor = [UIColor blueColor];

    // for rotation
    contentView.autoresizingMask = (UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight);
    self.view = contentView;

    //create a frame to size and place the web view
    CGRect webFrame = [[UIScreen mainScreen] applicationFrame];
    UIWebView *aWebView = [[UIWebView alloc] initWithFrame:webFrame];
    self.webView = aWebView;

    //aWebView.scalesPageToFit = YES;
    aWebView.autoresizesSubviews = YES;
    aWebView.autoresizingMask=(UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth);

    //set the web view delegates for the web view to be itself
    [aWebView setDelegate:self];

    //determine the path the to the index.html file in the Resources directory
    NSURL *url = [[NSBundle mainBundle] URLForResource:@"index" withExtension:@"html"];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
    [aWebView loadRequest:requestObj];
} 
```

# c# - 一种更好的方法来实现 INSERT 而无需多次访问数据库

> ID：11376498
> 
> 赞同：0
> 
> 时间：2012-07-07T15:58:38.177
> 
> 标签：c#, asp.net, sql, sql-server, iterator

我有以下内容，我可以让它按我的意愿工作，但我认为我做错了，你能解释一下如何以更有效的方式完成吗？同时也在同一个方法中循环`Categories`并执行相同的操作。`Districts``Insert()`

提前致谢。

```
 #region Methods
    public int Insert(List<District> Districts, List<Category> Categories)
    {
        StringBuilder sqlString = new StringBuilder("INSERT INTO Stores (name, image) VALUES (@Name, @Image);");

        using (SqlConnection sqlConnection = new
           SqlConnection(ConfigurationManager.ConnectionStrings["OahuDB"].ConnectionString))
        {
            SqlCommand sqlCommand = new SqlCommand(sqlString.ToString(), sqlConnection);
            sqlCommand.Parameters.AddWithValue("@Name", this.Name);
            sqlCommand.Parameters.AddWithValue("@Image", this.Image);

            sqlConnection.Open();
            int x = (int)sqlCommand.ExecuteScalar();

            sqlString.Clear();
            sqlCommand.Parameters.Clear();

            foreach (District item in Districts)
            {
                sqlString.AppendLine("INSERT INTO districts_has_stores (district_id, store_id) VALUES (@DistrictID, @StoreID);");
                sqlCommand.CommandText = sqlString.ToString();
                sqlCommand.Parameters.AddWithValue("@DistrictID", item.ID);
                sqlCommand.ExecuteNonQuery();
            }

            return x;
        }
    } 
```

# 编辑

通过执行以下操作来实现上述目标是错误的吗？

```
 sqlString.Clear();
            sqlCommand.Parameters.Clear();
            sqlString.AppendLine("INSERT INTO districts_has_stores (district_id, store_id) VALUES (@DistrictID, @StoreID);");
            sqlCommand.CommandText = sqlString.ToString();
            sqlCommand.Parameters.AddWithValue("@StoreID", x);
            foreach (District item in Districts)
            {
                sqlCommand.Parameters.AddWithValue("@DistrictID", item.ID);
                sqlCommand.ExecuteNonQuery();
            } 
            sqlString.Clear();
            sqlCommand.Parameters.Clear();
            sqlString.AppendLine("INSERT INTO categories_has_stores (category_id, store_id) VALUES (@CategoryID, @StoreID);");
            sqlCommand.CommandText = sqlString.ToString();
            sqlCommand.Parameters.AddWithValue("@StoreID", x);
            foreach (Category item in Categories)
            {
                sqlCommand.Parameters.AddWithValue("@CategoryID", item.ID);
                sqlCommand.ExecuteNonQuery();
            } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T16:03:26.513

第一个明显的事情是将 sqlCommand 的不变部分移出循环

```
sqlCommand.Parameters.Clear(); 
sqlString.Clear();
sqlString.AppendLine("INSERT INTO districts_has_stores (district_id, store_id) VALUES (@DistrictID, @StoreID);"); 
sqlCommand.CommandText = sqlString.ToString(); 
sqlCommand.Parameters.AddWithValue("@DistrictID", 0);  // as dummy value
sqlCommand.Parameters.AddWithValue("@StoreID", x);  // invariant
foreach (District item in Districts) 
{ 
    sqlCommand.Parameters["@DistrictID"].Value = item.ID; 
    sqlCommand.ExecuteNonQuery(); 
} 
```

但这并不能解决您的基本问题。如何避免多次访问数据库。
您可以像这样使用多个插入构建查询

```
sqlString.Clear();
sqlString.Append("INSERT INTO districts_has_stores (district_id, store_id) VALUES (");
foreach(District item in Districts)
{
    sqlString.Append(item.ID.ToString);
    sqlString.Append(", ")
    sqlString.Append(x.ToString()); 
    sqlString.Append("),"); 
}
sqlString.Length--;
sqlCommand.CommandText = sqlString.ToString() 
```

但是字符串连接确实是一种不好的做法，我提出这个解决方案只是作为一个例子，我不想建议这种方法。

最后一种可能性是[表值参数](http://msdn.microsoft.com/en-us/library/bb675163%28v=vs.100%29.aspx)（仅来自 SqlServer 2008）。

首先，您需要为要传入的表创建一个 Sql 类型

```
CREATE TYPE dbo.DistrictsType AS TABLE
    ( DistrictID int, StoreID int ) 
```

和一个 StoredProcedure，它将插入传入的数据表中的数据

```
CREATE PROCEDURE usp_InsertDistricts 
(@tvpNewDistricts dbo.DistrictsType READONLY)
AS
BEGIN
    INSERT INTO dbo.Districts (DistrictID, StoreID)
    SELECT dt.DistrictID, dt.StoreID FROM @tvpNewDistricts AS dt;
END 
```

然后，回到您的代码，您将区域传递到存储过程中

（可能您需要在 DataTable 中转换您的列表）

```
DataTable dtDistricts = ConvertListToDataTable(Districts);
SqlCommand insertCommand = new SqlCommand("usp_InsertDistricts", sqlConnection);
SqlParameter p1 = insertCommand.Parameters.AddWithValue("@tvpNewDistricts", dtDistricts);
p1.SqlDbType = SqlDbType.Structured;
p1.TypeName = "dbo.DistrictsType";
insertCommand.ExecuteNonQuery(); 
```

好吧，如果您回头看上面的链接，您会发现其他方法可以将数据一步传递到数据库后端......（滚动到最后，您还会发现一种不需要数据库上的存储过程）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T16:13:08.593

假设 Stores 有一个标识列，在 SQL Server 中，创建一个表类型和一个表值参数以利用它：

```
CREATE TYPE dbo.DistrictsTVP AS TABLE
(
  DistrictID INT -- PRIMARY KEY? I hope so.
);
GO

CREATE PROCEDURE dbo.InsertStoreAndDistricts
  @Name NVARCHAR(255),
  @Image <some data type???>,
  @Districts dbo.DistrictsTVP READONLY
AS
BEGIN
  SET NOCOUNT ON;

  DECLARE @StoreID INT;

  INSERT dbo.Stores(name, [image]) SELECT @Name, @Image;

  SET @StoreID = SCOPE_IDENTITY();

  INSERT dbo.district_has_stores(district_id, store_id)
    SELECT DistrictID, @StoreID
      FROM @Districts;
END
GO 
```

然后在 C# 中，您可以直接传递您的 List 而无需任何循环：

```
 using (...)
  {
    SqlCommand cmd       = new SqlCommand("dbo.InsertStoreAndDistricts", sqlConnection);
    cmd.CommandType      = CommandType.StoredProcedure;
    SqlParameter tvparam = cmd.Parameters.AddWithValue("@Districts", Districts);
    tvparam.SqlDbType    = SqlDbType.Structured;

    // other params here - name and image

    cmd.ExecuteNonQuery();
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T16:33:13.477

最近在我的项目中，我在存储过程中使用 XML 作为数据类型，并且一次插入更新和删除，而不是多次访问数据库。

示例存储过程

```
ALTER PROCEDURE [dbo].[insertStore]
@XMLDATA xml,
@name varchar(50),
@image datatype
 AS
 Begin
  INSERT INTO Store
  (name
   ,image
  )
Select XMLDATA.item.value('@name[1]', 'varchar(10)') AS Name,   
XMLDATA.item.value('@image[1]', 'yourData type') AS Image
FROM @XMLDATA.nodes('//Stores/InsertList/Store') AS XMLDATA(item)
END 
```

同样，您可以编写更新和删除。在 C# 中，您需要创建 xml

```
public  string GenerateXML(List<District> Districts)
 var xml = new StringBuilder();
 var insertxml = new StringBuilder();
 xml.Append("<Stores>");
 for (var i = 0; i < Districts.Count; i++)
        { var obj = Districts[i];
          insertxml.Append("<Store");
          insertxml.Append(" Name=\"" + obj.Name  + "\" ");
          insertxml.Append(" Image=\"" + obj.Image + "\" ");
          insertxml.Append(" />");
        }
xml.Append("<InsertList>");
xml.Append(insertxml.ToString());
xml.Append("</InsertList>");

SqlCommand cmd= new SqlCommand("insertStore",connectionString);
cmd.CommandType=CommandType.StoredProcedure;
SqlParameter param = new SqlParameter ();
param.ParameterName ="@XMLData";
param.value=xml;
paramter.Add(param);
cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T18:23:38.453

想想你的系统设计。您需要插入的数据来自哪里？如果它已经在数据库、另一个数据库或某种其他类型的数据存储中，您应该能够实现更批量的传输，只需在存储过程的循环中从一个数据库插入到另一个数据库。

如果数据来自用户，或者来自一些不兼容的数据存储，比如从某个第三方程序导出，那么您基本上必须意识到将其输入数据库将涉及到数据库的相当多的往返。您可以使用一些表或 XML 等，但这些实际上更接近于使用其他方法进行批量插入。

底线是 SQL 数据库被设计为一次插入一个。这在 99% 的情况下都可以，因为您永远不会要求使用 UI 的用户一次输入数千个内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T16:11:27.097

就个人而言，我会为插入创建一个存储过程并传入一个表值参数，这将允许你做

```
INSERT tbl (f1, f2, ... fN)
SELECT * FROM @TVP 
```

[http://msdn.microsoft.com/en-us/library/bb510489.aspx](http://msdn.microsoft.com/en-us/library/bb510489.aspx)

除非您使用的是 SQL 2005，否则我将在我的存储过程中使用 XML 参数并序列化要插入的集合。

# java - 能否自动将一个类的对象转换为子类并在 Java 中调用重载方法？

> ID：11376500
> 
> 赞同：0
> 
> 时间：2012-07-07T15:58:53.840
> 
> 标签：java, polymorphism, overloading, factory-pattern

我有以下设置：

```
class Base {};
class ImplA extends Base {};
class ImplB extends Base {};
class ImplC extends Base {};

Base baseFactory(int type) {
    switch(type) {
    case 0:
        return new ImplA();
    case 1:
        return new ImplB();
    case 2:
        return new ImplC();
}

Base a = baseFactory(0);
Base b = baseFactory(1);
Base c = baseFactory(2);

List<Base> list = new ArrayList<Base>();

list.add(a);
list.add(b);
list.add(c);

// Somewhere else I have:
interface BaseHandler {
    process(ImplA a);
    process(ImplB b);
    process(ImplC c);
}; 
```

现在，我希望能够做的事情是：

```
class Processor {

BaseHandler bh;

Processor(BaseHandler bh) {
    this.bh = b;
}

void processList(List<Base> list) {

    for (Base x : list) {
        bh.process(x);
    }
} 
```

然后让用户实现 BaseHandler 并能够构造一个 Processor 来对 Base 列表中的每个元素进行操作。

但是，这不起作用，因为`process(Base)`没有定义。只添加 3 个 if 语句似乎很简单，但我已经有了一个类似 switch 的结构来构建扩展 Base 的类的实例。似乎没有必要一遍又一遍地重复这一点。有没有办法实现这个想法，而无需编写中间步骤来确定列表中每个 Base 的运行时类并调用适当的方法（实际上是另一个 switch 案例——但它会是 if 的）？

我认为一个解决方法是让每个 Base 都有一个`process`需要由 Impl 类实现的抽象方法。但是，这在我的情况下是不可接受的，因为用户不会实现 Impl 类。基本上，我需要`process`是一个用户定义的回调。`process`此外，成为 Impl 或 Base 类的成员没有任何意义，因为它们没有任何关系。这是一个单独的回调，需要动态响应调用它的类型。并且类型总是保证是 Base 的子类。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T16:05:20.687

您确实需要您描述的“中间步骤”，但它不需要是`if`陈述。您正在寻找的是使用[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)的双重调度。基本上你的`Base`班级会有一个方法：

```
void accept(BaseHandler handler); 
```

并且每个子类都将其实现为：

```
handler.process(this); 
```

where`this`将在编译时解析为每个子类中的正确类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T16:07:17.740

您正在寻找的是访问者模式。您在 上放置了一个抽象方法`Base`，但它所做的只是在以下位置调用适当的方法`BaseHandler`：

```
public interface Base {
    void acceptHandler(BaseHandler handler);
} 
```

然后你的具体实现覆盖`acceptHandler`并调用正确的重载。

```
public class ImplA implements Base {
    public void acceptHandler(BaseHandler handler) {
        handler.process(this);
    }
} 
```

在这一点上，重载没有太大的价值，你最好给你的方法提供描述性的名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T16:12:19.280

听起来您想要的是这里的**访问者**模式：

```
public interface BaseVisitor {
  void caseA(ImplA a);
  void caseB(ImplB b);
  void caseC(ImplC c);
}

public class MyVisitor implements BaseVisitor {
  void visit(List<Base> bases) {
    for (Base b : bases) {
      b.accept(this);
    }
  }
  public void caseA(ImplA a) { // ... }
  public void caseB(ImplB b) { // ... }
  public void caseC(ImplC c) { // ... }
}

public abstract class Base {
  abstract void accept(BaseVisitor visitor);
}

public class ImplA {
  public void accept(BaseVisitor visitor) {
    visitor.caseA(this);
  }
}
public class ImplB {
  public void accept(BaseVisitor visitor) {
    visitor.caseB(this);
  }
}
public class ImplC {
  public void accept(BaseVisitor visitor) {
    visitor.caseC(this);
  }
} 
```

# php - php 发送电子邮件类 - 第一次尝试

> ID：11376506
> 
> 赞同：1
> 
> 时间：2012-07-07T15:59:41.337
> 
> 标签：php, oop, class, foreach

这是我第一次尝试使用 php 类，以前从未这样做过，我很享受这个过程。

**代码可能有点乱，如果您有任何建议，我将非常感激！**

关于这个问题，我正在尝试，`echo "$asd->getData()"`结果有点奇怪，我无法解释结果：

> 数组 ( [0] => 名称 [1] => 电子邮件 [2] => telemovel [3] => loja [4] => assunto [5] => mensagem [6] => localidade [7] => nserie [nome] => holder [email] => eeee [telemovel] => 913582837 [loja] => braga [assunto] => [mensagem] => [localidade] => [nserie] => )

我正在寻找以下结果：

> Array([nome] => MyName [email] => emailHotmail [telemovel] => cellphone_here [loja] => store_name [assunto] => subject_here [mensagem] => Message_here [localidade] => Location [nserie] => Serial_number )

为什么会出现数组编号/键？

```
<?php

class Email{

    private $data;

    function Email(){
            $this->data=array();
    }

        public function setData($d){
            $this->data = $d;
        }

    public function valida(){
            $verifica = true;
        foreach ($this->data as $campo) {
                $this->data[$campo] = $_GET[$campo];
                if(!isset($_GET[$campo]) || empty($_GET[$campo])){
                    $verifica=true;
                }
            }
            return $verifica;
    }

    public function getData(){
            print_r($this->data);
        }

        public function sendEmail($data){
            $to = ($this->data['loja']=="braga") ? "email1@email.com" : "email1@email.com";
            $subject = $this->data['assunto'];//$campos[4];
        $nserie = ($this->data['nserie']) ? '\r\n nº de série:'.$this->data['nserie'] : "";
        $localidade = ($this->data['localidade']) ? '\r\n Localidade:'.$this->data['localidade'] : "";
        $messages = $this->data['mensagem'];//$campos[5];
        $message = $messages.$nserie.$localidade;
            $message = htmlspecialchars_decode($message,ENT_QUOTES);//optional - I use encoding to POST data
            $name = $this->data['nome'];
            $from = $this->data['email'];//$campos[1];
            $headers = "From:".$name." <".$from.">\r\n";
            $headers .= "MIME-Version: 1.0\r\n"; 
            $headers .= "Content-type: text/plain; charset=utf-8\r\n";
            $headers .= "Content-Transfer-Encoding: 8bit";

            return mail($to, "=?utf-8?B?".base64_encode($subject)."?=", $message, $headers);
        }
}
$asd = new Email();
$campos = array('nome','email','telemovel','loja','assunto','mensagem','localidade','nserie');
$asd->setData($campos);
$asd->sendEmail($data);
echo ($asd->valida($data)) ? "sent<br/>" : "not sent<br/>";
echo "<br/>".$asd->getData()."<br/>";

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:03:17.023

您正在打印一个数组。您需要循环并打印出数组中的每个项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:04:43.167

```
$campos = array('nome','email','telemovel','loja','assunto','mensagem','localidade','nserie'); 
```

与 /short 相同

```
$campos = array(0=> 'nome',1=> 'email',....); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:12:57.300

您想在通话中设置 $campos，如下所示：

```
$campos = array('nome' => '','email' => '','telemovel' => '','loja' => '','assunto' => '','mensagem' => '','localidade' => '','nserie' => '');
$asd->setData($campos); 
```

$campos 数组是一个值列表，您希望将这些值作为空白值的键。

祝你好运！

# java - 没有提供者的服务提供者接口

> ID：11376508
> 
> 赞同：9
> 
> 时间：2012-07-07T16:00:17.577
> 
> 标签：java, design-patterns, service-provider

我正在阅读 Bloch 的 Effective java book ^([1])并遇到了以下 SPI 示例：

```
//Service interface
public interface Service {
  //Service specific methods here
}

//Service provider interface
public interface Provider {
  Service newService();
}

//Class for service registration and access
public class Services {
  private Services(){}

  private static final Map<String, Provider> providers =
    new ConcurrentHashMap<String, Provider>();
  public static final String DEFAULT_PROVIDER_NAME = "<def>";

  //Registration
  public static void registerDefaultProvider(Provider p) {
    registerProvider(DEFAULT_PROVIDER_NAME, p);
  }
  public static void registerProvider(String name, Provider p) {
    providers.put(name, p);
  }

  //Access
  public static Service newInstance() {
    return newInstance(DEFAULT_PROVIDER_NAME);
  }
  public static Service newInstance(String name) {
     // you get the point..lookup in the map the provider by name
     // and return provider.newService();
  } 
```

这是我的问题：为什么需要提供者接口？难道我们不能自己轻松地注册服务吗？例如，维护服务实现的映射，然后在查找时返回实例？为什么要增加额外的抽象层？

也许这个例子太笼统了——任何“更好”的例子来说明这一点也很好。

* * *

^([1]) [第二版](http://www.worldcat.org/title/effective-java/oclc/474025857)，第 2 章。第一版示例未提及服务提供者接口。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-03-28T15:16:34.523

**为什么需要提供者接口？难道我们不能自己轻松地注册服务吗？例如，维护服务实现的映射，然后在查找时返回实例？**

正如其他人所说，Provider 的目的是拥有一个可以创建`Service`实例的 AbstractFactory。您并不总是希望保留对所有服务实现的引用，因为它们可能是短暂的和/或在执行后可能无法重用。

**但是提供者的目的是什么？如果没有提供者，如何使用“提供者注册 API”？**

拥有 Provider 接口的最有力的原因之一是您不需要在编译时实现。API 的用户可以稍后添加他们自己的实现。

让我们以 JDBC 为例，就像在另一个答案中使用的 Ajay 一样，但让我们更进一步：

有许多不同类型的数据库和数据库供应商，它们管理和实现数据库的方式（以及查询它们的方式）略有不同。Java 的创建者不可能创建所有这些不同可能方式的实现，原因有很多：

*   最初编写 Java 时，许多这样的数据库公司或系统还不存在。
*   并非所有这些数据库供应商都是开源的，因此 Java 的创建者不知道如何与他们沟通，即使他们愿意。
*   用户可能想要编写自己的自定义数据库

那么你如何解决这个问题呢？通过使用`Service Provider`.

*   [驱动程序](http://docs.oracle.com/javase/7/docs/api/java/sql/Driver.html)`Provider`接口是. 它提供了与特定供应商的数据库交互的方法。其中一种方法`Driver`是工厂方法，用于在给定 url 和其他属性（如用户名和密码等）的情况下为数据库创建`Connection`实例（即`Service`）。

每个数据库供应商都编写了自己的`Driver`实现，以了解如何与自己的数据库系统进行通信。这些不包含在 JDK 中；您必须访问公司网站或其他代码存储库并将它们作为单独的 jar 下载。

要使用这些驱动程序，您必须将 jar 添加到类路径中，然后使用 JDK`DriverManager`类来注册驱动程序。

*   [DriverManager](http://docs.oracle.com/javase/7/docs/api/java/sql/DriverManager.html)`Service Registration`类是.

DriverManager 类有一个方法`registerDriver(Driver)`，用于在服务注册中注册一个 Driver 实例，以便可以使用它。按照惯例，大多数`Driver`实现在类加载时注册，因此您在代码中所要做的就是编写

```
Class.forname("foo.bar.Driver"); 
```

为供应商“foo.bar”注册驱动程序（假设您的类路径中有该类的 jar。）

注册数据库驱动程序后，您可以获得连接到数据库的服务实现实例。

例如，如果您在本地计算机上有一个名为“test”的 mysql 数据库，并且您的用户帐户的用户名为“monty”，密码为“greatsqldb”，那么您可以像这样创建一个服务实现：

```
Connection conn =
   DriverManager.getConnection("jdbc:mysql://localhost/test?" +
                               "user=monty&password=greatsqldb"); 
```

DriverManager 类看到你传入的 String 并找到可以理解其含义的注册驱动程序。（这实际上是`Chain of Responsibility`通过遍历所有注册的驱动程序并调用它们的`Driver.acceptsUrl(Stirng)`方法直到 url 被接受来使用 Pattern 完成的）

请注意，JDK 中没有特定于 mysql 的代码。您所要做的就是注册某个供应商的驱动程序，然后将格式正确的字符串传递给服务提供者。如果我们稍后决定使用不同的数据库供应商（如 oracle 或 sybase），那么我们只需交换 jar 并修改我们的连接字符串。DriverManager 中的代码不会改变。

**为什么我们不只是建立一次联系并保持联系呢？为什么我们需要服务？**

我们可能希望在每次操作后连接/断开连接。或者我们可能希望将连接保持更长时间。拥有该服务允许我们随时创建新的连接，并且不妨碍我们保留对它的引用以供以后重复使用。

这是一个非常强大的概念，框架使用它来允许许多可能的排列和扩展，而不会弄乱核心代码库。

**编辑**

使用多个提供者和提供多个的提供者`Services`：

没有什么可以阻止您拥有多个提供者。您可以同时连接到使用不同数据库供应商软件创建的多个数据库。您还可以同时连接到同一供应商生产的多个数据库。

多种服务 - 一些提供者甚至可能`Service`根据连接 url 提供不同的实现。例如，H2 可以创建基于文件系统或基于内存的数据库。告诉 H2 你想使用哪个的方法是不同的 url 格式。我没有看过 H2 代码，但我假设基于文件和基于内存是不同的服务实现。

**为什么 DriverManager 不只管理 Connections 而 Oracle 可以实现 OracleConnectionWrapper？没有供应商！**

这还需要您知道您有一个 Oracle 连接。那是非常紧密的耦合，如果我改变供应商，我将不得不改变很多代码。

`Service Registration`只需要一个字符串。请记住，它使用`chain of Responsiblity`来查找第一个知道如何处理 url 的注册提供程序。应用程序可以是供应商中立的，它可以从属性文件中获取连接 url 和驱动程序类名称。这样，如果我更改供应商，我就不必重新编译我的代码。但是，如果我硬编码对“OracleConnectionWrapper”的引用，然后我更改了供应商，我将不得不重写部分代码，然后重新编译。

如果他们愿意，没有什么可以阻止某人支持多种数据库供应商 url 格式。因此，如果我愿意，我可以制作一个可以处理 mysql 和 oracle 的 GenericDriver。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:04:46.417

If you might need more than one service of each type, you can't just reuse the old Services. (Additionally, tests and the like might want to create fresh services for each test, rather than reusing services that might have been modified or updated by previous tests.)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-26T22:10:28.640

`Effective Java`我认为答案是与一个例子一起提到的。

> **服务提供者框架的第四个可选**组件是服务提供者接口，提供者实现该接口以创建其服务实现的实例。在没有服务提供者接口的情况下，实现由类名注册并反射地实例化（第 53 条）。

在这种情况下`JDBC`，
`Connection`扮演**服务接口**的角色，
`DriverManager.registerDriver`是**提供者注册API**，`DriverManager.getConnection`是**服务访问API**，
`Driver`是**服务提供者接口**。

因此，正如您正确指出的那样，拥有 Provider 接口不是必须的，而只是一种更简洁的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-26T21:54:20.577

因此，您似乎可以有多个`Provider`相同的 s，`Service`并且基于特定的 Provider 名称，您可能会获得同一服务的不同实例。所以我想说每个 Provider 有点像工厂，可以适当地创建服务。

例如假设`class PaymentService implements Service`它需要一个`Gateway`. 你有 PayPal 和 Chase 网关来处理这些支付处理器。现在，您创建了一个 PayPalProvider 和 ChaseProvider，每个都知道如何使用正确的网关创建正确的 PaymentService 实例。

但我同意，似乎做作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-17T13:56:43.480

作为其他答案的综合（第四部分是文本原因），我认为这是为了限制编译依赖性。使用 SPI，您可以使用所有工具来排除对实现的显式引用：

*   *META-INF/services/*目录包含提及可用服务提供者实现的文件
*   [ServiceLoader](https://docs.oracle.com/javase/6/docs/api/java/util/ServiceLoader.html)标准类允许解析可用的实现名称，顺便说一下动态构造^([1])。

第一版中没有提到 SPI。将它包含在有关静态工厂的项目中可能不是正确的地方。文中提到的DriverManager是一个提示，但布洛赫并没有深入。在某种程度上，平台实现了一种[ServiceLocator 模式](http://www.oracle.com/technetwork/java/servicelocator-137181.html)来减少编译依赖，具体取决于环境。在您的抽象工厂中使用 SPI，它在 ServiceLoader 的帮助下成为 ServiceLocator 的 ServiceFactory 以实现模块化。

[ServiceLoader 迭代器](https://docs.oracle.com/javase/6/docs/api/java/util/ServiceLoader.html#iterator())可用于动态填充示例的*服务*映射。

* * *

^([1])在 OSGi 环境中，这是一个[微妙的操作](http://blog.osgi.org/2013/02/javautilserviceloader-in-osgi.html)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-03-27T08:35:00.257

**没有提供者的服务提供者接口**

让我们看看没有提供者的情况。

```
//Service interface
public interface Service {
  //Service specific methods here
}

//Class for service registration and access
public class Services {
  private Services(){}

  private static final Map<String, Service> services =
    new ConcurrentHashMap<String, Service>();
  public static final String DEFAULT_SERVICE_NAME = "<def>";

  //Registration
  public static void registerDefaultService(Provider p) {
    registerService(DEFAULT_SERVICE_NAME, p);
  }
  public static void registerService(String name, Provider p) {
    services.put(name, p);
  }

  //Access
  public static Service getInstance() {
    return newInstance(DEFAULT_SERVICE_NAME);
  }
  public static Service getInstance(String name) {
     // you get the point..lookup in the map the service by name
     // and return it;
  } 
```

*如您所见，可以在没有Provider*接口的情况下创建 Service Provider Interface 。最终的调用者`#getInstance(..)`不会注意到差异。

**那我们为什么需要提供者？**

该`Provider`接口是一个[抽象工厂](http://en.wikipedia.org/wiki/Abstract_factory_pattern)，`Services#newInstance(String)`是一个[工厂方法](http://en.wikipedia.org/wiki/Factory_method_pattern)。两种设计模式都具有将服务实现与服务注册分离的优点。

[**单一责任原则**](http://en.wikipedia.org/wiki/Single_responsibility_principle)

您无需在注册所有服务的启动事件处理程序中实现服务实例化，而是为每个服务创建一个提供程序。这使它松散耦合并且更容易重构，因为服务和服务提供者可以彼此靠近，例如放在另一个 JAR 文件中。

“工厂方法在工具包和框架中很常见，其中库代码需要创建类型的对象，这些对象可能被使用框架的应用程序子类化。” [[1]](http://en.wikipedia.org/wiki/Factory_method_pattern)

**终身管理**：

您可能已经在没有提供者的上层代码中意识到，我们正在注册服务*实例*而不是提供者，提供者可以决定实例化一个新的服务实例。

这种方法有一些缺点：

1\. 必须在第一次服务调用之前创建服务实例。延迟初始化是不可能的。这将延迟启动并将资源绑定到很少使用甚至从不使用的服务。

1b。您“不能”在使用后关闭服务，因为无法重新实例化它们。（使用提供者，您可以以调用者必须调用的方式设计*服务接口*`#close()`，这会通知提供者并且提供者决定保留或完成服务实例。）

2\. 所有调用者都将使用相同的服务实例，因此您必须确保它是线程安全的。但是使其线程安全会使其变慢。相反，提供者可能会选择创建几个服务实例来减少保留时间。

**结论**

提供者接口不是必需的，但它封装了特定于服务的实例化逻辑并优化了资源分配。

# javascript - JavaScript / jQuery：可以通过 for 循环“自动化”切换语句吗？

> ID：11376514
> 
> 赞同：1
> 
> 时间：2012-07-07T16:01:12.983
> 
> 标签：javascript, jquery, loops, scroll, switch-statement

**解决方案**

```
$(window).scroll(function() {
            var y = $(this).scrollTop();
            for (var i = 0; i < offset.length; i++)
                {
                    if (y < offset[i].bottom) {
                        $("#catSelect option:selected").removeAttr("selected");
                        $("#catSelect option[value=#"+offset[i].id+"]").attr("selected", "selected");
                        break;
                    }
                }
        }); 
```

谢谢你们的帮助！

**问题**

我是 JavaScript 和 jQuery 的初学者，所以我希望有好心人可以帮助我。下面是一个执行得很好的代码片段......但由于它非常重复，我试图想出一些代码来帮助我在 switch 语句中“自动化”所有这些条件，而不是手动指定它（如果那讲得通）。我将使用“for”循环，但目前还没有结果。

向正确的方向轻推，好吗？谢谢 ：）

~ 初步代码 ~

```
var offset = [];
        $(".cat").each(function() {
            var top =  $(this).offset().top;
            var bottom = top + $(this).outerHeight();
            var id = $(this).attr("id");
            offset.push({"top": top, "bottom": bottom, "id": id });
            $(document.body).append(offset.length);
        }); 
```

~ 代码都是关于 ~

```
$(window).scroll(function() {
    var y = $(this).scrollTop();

        switch (true) {
            case (y < offset[0].bottom):
                $("#catSelect option:selected").removeAttr("selected");
                $("#catSelect option[value=#"+offset[0].id+"]").attr("selected", "selected");
                break;
            case (y < offset[1].bottom):
                $("#catSelect option:selected").removeAttr("selected");
                $("#catSelect option[value=#"+offset[1].id+"]").attr("selected", "selected");
                break;
            case (y < offset[2].bottom):
                $("#catSelect option:selected").removeAttr("selected");
                $("#catSelect option[value=#"+offset[2].id+"]").attr("selected", "selected");
                break;
            }

        }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T16:05:19.907

你的方法很了不起！我从来没有考虑过`switch(true)`:)

你可以试试这个，看看它是否适合你：

```
for (var i = 0; i<=2; i++)
{
    if (y < offset[i].bottom) {
        $("#catSelect option:selected").removeAttr("selected");
        $("#catSelect option[value=#"+offset[i].id+"]").attr("selected", "selected");
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T16:06:29.323

因为它只是在不同情况下不同的数组索引：

```
for (var i = 0; i < offset.length; i++) {
  if (y < offset[i].bottom) {
    $("#catSelect option:selected").removeAttr("selected");
    $("#catSelect option[value=#"+offset[i].id+"]").attr("selected", "selected");
    break;
  } 
```

# android - 以编程方式更改可绘制颜色

> ID：11376516
> 
> 赞同：181
> 
> 时间：2012-07-07T16:02:02.217
> 
> 标签：android

我正在尝试通过代码更改白色标记图像的颜色。我已经读过下面的代码应该改变颜色，但我的标记仍然是白色的。

```
Drawable.setColorFilter( 0xffff0000, Mode.MULTIPLY ) 
```

我错过了什么？有没有其他方法可以更改我的 res 文件夹中的可绘制对象的颜色？

* * *

## 回答 #1

> 赞同：317
> 
> 时间：2012-07-07T16:12:04.150

尝试这个：

```
Drawable unwrappedDrawable = AppCompatResources.getDrawable(context, R.drawable.my_drawable); 
Drawable wrappedDrawable = DrawableCompat.wrap(unwrappedDrawable);
DrawableCompat.setTint(wrappedDrawable, Color.RED); 
```

使用`DrawableCompat`很重要，因为它在 API 22 和更早版本的设备上提供了向后兼容性和错误修复。

* * *

## 回答 #2

> 赞同：154
> 
> 时间：2016-10-06T09:40:44.257

你可以试试这个 svg vector drawable

```
DrawableCompat.setTint(
    DrawableCompat.wrap(myImageView.getDrawable()),
    ContextCompat.getColor(context, R.color.another_nice_color)
); 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2016-01-21T07:11:06.073

您可能需要在可绘制对象上调用 mutate() ，否则所有图标都会受到影响。

```
Drawable icon = ContextCompat.getDrawable(getContext(), R.drawable.ic_my_icon).mutate();
TypedValue typedValue = new TypedValue();
getContext().getTheme().resolveAttribute(R.attr.colorIcon, typedValue, true);
icon.setColorFilter(typedValue.data, PorterDuff.Mode.SRC_ATOP); 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2018-01-16T09:03:32.310

你可以试试这个`ImageView`。使用`setColorFilter()`.

```
imageView.setColorFilter(ContextCompat.getColor(context, R.color.colorWhite)); 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2014-12-09T17:03:02.197

在 Lollipop、android 5.+ 上执行此操作的另一种方法是在可绘制的位图上设置色调，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<bitmap
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:src="@drawable/ic_back"
    android:tint="@color/red_tint"/> 
```

如果您想在可绘制对象上使用的颜色数量有限，这将适用于您。[查看我的博客文章了解更多信息](http://toastdroid.com/2014/12/06/tinting-drawables-on-lollipop/)。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-03-20T08:28:19.473

我编写了一个通用函数，您可以在其中传递上下文，图标是 id 可绘制/mipmap 图像图标和该图标所需的新颜色。

这个函数返回一个drawable。

```
public static Drawable changeDrawableColor(Context context,int icon, int newColor) {
    Drawable mDrawable = ContextCompat.getDrawable(context, icon).mutate(); 
    mDrawable.setColorFilter(new PorterDuffColorFilter(newColor, PorterDuff.Mode.SRC_IN)); 
    return mDrawable;
} 

changeDrawableColor(getContext(),R.mipmap.ic_action_tune, Color.WHITE); 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2012-07-07T16:38:25.610

您可以尝试使用 ColorMatrixColorFilter，因为您的关键颜色是白色：

```
// Assuming "color" is your target color
float r = Color.red(color) / 255f;
float g = Color.green(color) / 255f;
float b = Color.blue(color) / 255f;

ColorMatrix cm = new ColorMatrix(new float[] {
        // Change red channel
        r, 0, 0, 0, 0,
        // Change green channel
        0, g, 0, 0, 0,
        // Change blue channel
        0, 0, b, 0, 0,
        // Keep alpha channel
        0, 0, 0, 1, 0,
});
ColorMatrixColorFilter cf = new ColorMatrixColorFilter(cm);
myDrawable.setColorFilter(cf); 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2017-11-15T04:14:45.163

这对我有用。确保将“ff”放在 0x 和颜色代码之间。像这样 0xff2196F3

```
Drawable mDrawable = ContextCompat.getDrawable(MainActivity.this,R.drawable.ic_vector_home);
                    mDrawable.setColorFilter(new
                            PorterDuffColorFilter(0xff2196F3,PorterDuff.Mode.SRC_IN)); 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2017-05-18T17:51:17.410

与接受的答案相同，但更简单的便捷方法：

```
val myDrawable = ContextCompat.getDrawable(context, R.drawable.my_drawable)
myDrawable.setColorFilter(Color.GREEN, PorterDuff.Mode.SRC_IN)
setCompoundDrawablesWithIntrinsicBounds(myDrawable, null, null, null) 
```

注意，这里的代码是 Kotlin。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2020-07-08T20:44:42.980

**对于那些使用 Kotlin**的人来说，一个简单的扩展功能：

```
fun Drawable.tint(context: Context,  @ColorRes color: Int) {
    DrawableCompat.setTint(this, context.resources.getColor(color, context.theme))
} 
```

然后简单地做

```
background.tint(context, R.color.colorPrimary) 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-07-07T16:12:55.787

您可能想尝试`Mode.LIGHTEN`或`Mode.DARKEN`. Android Javadocs 很难解释 PorterDuff 模式的作用。您可以在这里查看它们：[PorterDuff | 安卓](http://developer.android.com/reference/android/graphics/PorterDuff.Mode.html)

我建议在这里查看 Mozilla 网站上的 Compositing [。](https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Canvas_tutorial/Compositing)（他们没有 android 的所有模式，但他们有很多）

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-07-12T19:55:28.347

使用这个：对于java

```
view.getBackground().setColorFilter(Color.parseColor("#343434"), PorterDuff.Mode.SRC_OVER) 
```

对于科特林

```
view.background.setColorFilter(Color.parseColor("#343434"),PorterDuff.Mode.SRC_OVER) 
```

如果您的背景有圆角等，您可以使用 PorterDuff.Mode.SRC_ATOP。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-07-05T03:21:07.803

SDK >= 21 一行 myIconImageView.getDrawable().setTint(getResources().getColor(myColor))

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2021-03-03T14:46:47.637

您可以通过以下方式更改可绘制颜色：

```
background = view.findViewById(R.id.background)

val uDrawable = AppCompatResources.getDrawable(view.context, R.drawable.background)
uDrawable?.let {
      val wDrawable = DrawableCompat.wrap(it)
      DrawableCompat.setTint(wDrawable, ContextCompat.getColor(view.context, 
                                                      color /*specify your int color code*/))
      background.background = wDrawable
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-05-03T10:06:30.787

**句法**

```
"your image name".setColorFilter("your context".getResources().getColor("color name")); 
```

**例子**

```
myImage.setColorFilter(mContext.getResources().getColor(R.color.deep_blue_new)); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-05-30T07:54:57.647

长话短说 ：

```
public void changeDrawableColor(Drawable drawable,int color){
    drawable.setColorFilter(color, PorterDuff.Mode.SRC_ATOP);
} 
```

```
public Drawable getColoredDrawable(@DrawableRes int resid,int color){
    Drawable drawable= ContextCompat.getDrawable(context, resid).mutate();
    drawable.setColorFilter(color, PorterDuff.Mode.SRC_ATOP);
    return drawable;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-11-27T11:35:25.257

最简单的方法：

```
imageView.setColorFilter(Color.rgb(r, g b)); 
```

或者

```
imageView.setColorFilter(Color.argb(a, r, g, b)); 
```

a, r, g, b ：颜色 argb 值。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-09-02T16:38:25.677

像这样创建方法：

```
//CHANGE ICON COLOR
private void changeIconColor(Context context ,int drawable){
    Drawable unwrappedDrawable = AppCompatResources.getDrawable(context, drawable);
    assert unwrappedDrawable != null;
    Drawable wrappedDrawable = DrawableCompat.wrap(unwrappedDrawable);
    DrawableCompat.setTint(wrappedDrawable, getResources().getColor(R.color.colorAccent));
} 
```

并像这样使用它：

```
 changeIconColor(this,R.drawable.ic_home); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-05-16T16:40:56.943

这就是我所做的：

```
public static Drawable changeDrawableColor(int drawableRes, int colorRes, Context context) {
    //Convert drawable res to bitmap
    final Bitmap bitmap = BitmapFactory.decodeResource(context.getResources(), drawableRes);
    final Bitmap resultBitmap = Bitmap.createBitmap(bitmap, 0, 0,
            bitmap.getWidth() - 1, bitmap.getHeight() - 1);
    final Paint p = new Paint();
    final Canvas canvas = new Canvas(resultBitmap);
    canvas.drawBitmap(resultBitmap, 0, 0, p);

    //Create new drawable based on bitmap
    final Drawable drawable = new BitmapDrawable(context.getResources(), resultBitmap);
    drawable.setColorFilter(new
            PorterDuffColorFilter(context.getResources().getColor(colorRes), PorterDuff.Mode.MULTIPLY));
    return drawable;
} 
```

# tomcat - Tomcat 未关闭连接，仍处于睡眠模式

> ID：11376522
> 
> 赞同：1
> 
> 时间：2012-07-07T16:02:46.723
> 
> 标签：tomcat, apache-commons-dbcp

我们在 MySql 5.1 中使用 tomcat 6.0.26，与数据库的连接在 server.xml 中设置，如下所示，

```
<GlobalNamingResources>
<!-- Editable user database that can also be used by
     UserDatabaseRealm to authenticate users
-->
<Resource name="UserDatabase" auth="Container"
          type="org.apache.catalina.UserDatabase"
          description="User database that can be updated and saved"
          factory="org.apache.catalina.users.MemoryUserDatabaseFactory"
          pathname="conf/tomcat-users.xml" />

 <Resource name="jdbc/abs" type="javax.sql.DataSource"  maxActive="150"   maxIdle="5"  username="XXXXXXXXXXX" testWhileIdle="true"  removeAbandonedTimeout="60"  maxWait="-1" removeAbandoned="true"
    validationQuery="select 1" driverClassName="com.mysql.jdbc.Driver" password="XXXXXXXXXXX" minEvictableIdleTimeMillis="30000" timeBetweenEvictionRunsMillis="300000" url="jdbc:mysql://XXXXXXXXXXXX?autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=utf-8"/>

    <Resource driverClassName="com.mysql.jdbc.Driver" maxActive="150" maxIdle="5" maxWait="-1" testWhileIdle="true" minEvictableIdleTimeMillis="30000"  removeAbandonedTimeout="60"  timeBetweenEvictionRunsMillis="300000" name="jdbc/1234" password="XXXXXXXXXXX" removeAbandoned="true" type="javax.sql.DataSource" url="jdbc:mysql:///XXXXXXXXXXXXXXXXXXXXXX?autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=utf-8" username="XXXXXXXXXXX" validationQuery="select 1"/> 
```

当我在 MySql 中运行 show full processlist 时，它显示大量连接处于睡眠模式，这可能是什么原因造成的？

问候，

罗希特

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-07T16:06:51.373

A`javax.sql.DataSource`是 MySQL 的连接池。您的应用程序服务器将打开一些与 MySQL 的连接（它们仍处于睡眠模式）并在您每次执行以下操作时使用它们：

```
DataSource ds = ...;
// you get one of the 'sleeping' connections here
Connection conn = ds.getConnection();
// you return the connection to the pool here (it does not actually closes it)
conn.close(); 
```

# javascript - jQuery 表单上传进度

> ID：11376528
> 
> 赞同：0
> 
> 时间：2012-07-07T16:03:31.567
> 
> 标签：javascript, jquery, css, forms

您好，我想弄清楚如何修复这个上传进度条，以便它在 Firefox 中工作。

在 Firefox 中，它仅达到 90% 左右，在 chrome 中显示进度为 100%

任何想法都非常感谢

*干杯

编辑我应该提到这是使用 jQuery 表单插件[http://jquery.malsup.com/form/](http://jquery.malsup.com/form/)

编辑不确定我做了什么，但它现在将状态设置为 99% 任何想法如何在 Firefox 中将其设置为 100% :-)

我已经更新了下面的代码

下面的代码

```
<style>
<!--
/*form {display: block; background: #333; padding: 15px}*/

.progress {margin-left:auto; margin-right: auto; position:relative; width:400px; border: 1px solid #ddd; padding: 1px; border-radius: 3px;}
.bar {margin-left:auto; margin-right: auto;background-color: #B4F5B4; width:0%; height:20px; border-radius: 3px; }
.percent {position:absolute; display:inline-block; top:3px; left:48%;}
-->
</style> 
```

和 jQuery

```
 <div class="progress">
        <div class="bar"></div >
        <div class="percent">0%</div >
    </div>
    <div id="status"></div>

<script type='text/javascript'>
<!--  

jQuery('document').ready(function() {
    var bar = $('.bar');
    var percent = $('.percent');
    var status = $('#status');   
        $('form').ajaxForm({
            dataType: 'script',
            url: "{{=URL('default', 'user_song_form')}}",
            beforeSend: function() {
                status.empty();
                var percentVal = '0%';
                bar.width(percentVal)
                percent.html(percentVal);
            },             
            uploadProgress: function(event, position, total, percentComplete) {
                var percentVal = percentComplete + '%';
                bar.width(percentVal)
                percent.html(percentVal);
            },
            complete: function(xhr) {
                status.html('Thank You Upload Complete!');
            }     
        });         
   });     
-->

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T05:39:16.463

最简单的方法是使用我推荐的上传器

[http://fineuploader.com/](http://fineuploader.com/)

最酷的是不需要外部依赖

![在此处输入图像描述](../Images/d0a5433cffec559c0c29861a2ae866cf.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:51:24.660

我通过更改完整功能解决了上传状态的问题

jQuery 代码现在如下所示

```
<script type='text/javascript'>
<!--  

jQuery('document').ready(function() {
    var bar = $('.bar');
    var percent = $('.percent');
    var status = $('#status');   
        $('form').ajaxForm({
            dataType: 'script',
            url: "{{=URL('default', 'user_song_form')}}",
            beforeSend: function() {
                status.empty();
                var percentVal = '0%';
                bar.width(percentVal)
                percent.html(percentVal);
            },             
            uploadProgress: function(event, position, total, percentComplete) {
                var percentVal = percentComplete + '%';
                bar.width(percentVal)
                percent.html(percentVal);
            },
            complete: function(xhr) {
                var percentVal = '100%';
                bar.width(percentVal)
                percent.html(percentVal);
                status.html('Thank You Upload Complete!');
            }     
        });         
   });     
-->

</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:06:27.677

考虑使用 uploadify 作为替代方案。它工作得很好，可以在 IE 和 Firefox 100% 中工作

[http://www.uploadify.com/](http://www.uploadify.com/)

# javascript - GAE blobstore url 错误：不支持 GET

> ID：11376531
> 
> 赞同：0
> 
> 时间：2012-07-07T16:03:54.300
> 
> 标签：javascript, jquery, google-app-engine, blobstore

我在使用谷歌应用引擎 blob 商店时遇到问题。我在开发环境中运行（即在我的机器上本地运行。）

这是我在做什么...

一旦表单弹出，我调用一个 servlet 来生成这样的 URL

```
String url = blobstoreService.createUploadUrl("test/joi"); 
```

一旦我有了它，我将它保存在我的 java 脚本中，然后一旦用户提交表单我正在这样做

```
$.ajax({ url: self.url,
        type: "POST",
//crossDomain: true,
dataType: "jsonp",
//dataType: "multipart/form-data",
success:    
function(response, textStatus, jqXHR)
{
  alert("saved.");
    }
 });
     } 
```

但是，当我这样做时，我得到以下异常

GET 405（此 URL 不支持 HTTP 方法 GET）jquery.js:4

我真的很挣扎，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T04:11:26.467

除了任何其他问题之外，blobstore 还需要以多部分格式上传文件；您正在尝试使用 jquery 发布到它。如果您想在 javascript 中发布，您需要适当地格式化 POST 请求的正文。

# php - 将变量与 2 个值进行比较

> ID：11376536
> 
> 赞同：1
> 
> 时间：2012-07-07T16:04:31.410
> 
> 标签：php

我有一个`$var`必须是*一*或*二*的变量，如果不是，则抛出错误

```
if($var != "one" && $var != "two")
{
    exit('$var must be either one or two');
} 
```

这行得通。然而，作为`$var`一个字符串，只能保存一个值而不是两者，所以我想知道这样写是否不合逻辑？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T16:09:09.890

没关系，不合逻辑的代码是`($var == 'one' && $var == 'two')`

您正在检查它不是一个或两个 - 一个变量不能“不是”无穷无尽的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T16:09:54.380

你可以这样尝试：

```
$possible = Array( "one", "two" );
if(!in_array($var, $possible) ) {
    echo "$var can be either of: " . implode($possible, ", ");
} 
```

这样，您以后可以包含更多要检查的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T16:08:00.437

```
if( !( $var == "one" || $var == "two" ) )
{
    exit('$var must be either one or two');
} 
```

这将是我检查 $var 容器是“一”还是“二”的方式。如其他答案所述，还有其他选择，但为什么过于复杂？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-07T16:08:14.860

写你写的东西是完全合乎逻辑的！

您正在写的是，如果 $var 不是一个（这意味着它仍然可以是其他任何东西）并且如果 $var 也不是两个（此时您已经排除了两种可能性），那么抛出错误！

另外，我建议您使用`throw new Exception('Error Message');`

# scala - Scala 中的交换运算符定义

> ID：11376545
> 
> 赞同：3
> 
> 时间：2012-07-07T16:05:21.897
> 
> 标签：scala

假设我为我的类定义了一些运算符，如下所示：

```
class A {
    def +(f: Float) = /* ... */
}

val a: A = new A 
```

这让我可以做到`a + 1f`，很容易。如果我想让 lib 的用户也能够写`1f + a`怎么办？我该如何实施？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-07T16:12:31.050

在 Scala 2.9 中，您可以导入此隐式转换：

```
implicit def floatPlusAExtender (x: Float) = 
  new {
    def + (a: A) = a + x
  } 
```

并随心所欲地使用它。从 Scala 2.10 开始，您最好像这样进行转换：

```
implicit class FloatPlusAExtender (x: Float) {
  def + (a: A) = a + x
} 
```

甚至更好的是：

```
implicit class FloatPlusAExtender (val x: Float) extends AnyVal {
  def + (a: A) = a + x
} 
```

最后一种方法称为[值类](http://docs.scala-lang.org/sips/pending/value-classes.html)，与前两种不同，它以零开销提供此功能。（谢谢，axel22）这也是2.10自带的新东西

或者你可以`A`像这样修改：

```
class A {
  def + (x: Float) = /* ... */
  def +: (x: Float) = this + x
} 
```

并像这样使用它：

```
1f +: a 
```

最后一种方法更可取。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T16:13:27.563

一种方法是[pimp-my-library-pattern](http://www.artima.com/weblogs/viewpost.jsp?thread=179766)：

```
class FloatWithPlusA(f: Float) {
  def +(a: A) = a + f
}

implicit def floatPlusA(f: Float): FloatWithPlusA =
  new FloatWithPlusA(f)

val a: A = new A
a + 1.0f  /* a.+(1.0f) */
1.0f + a  /* floatPlusA(1.0f).+(a) */ 
```

另一种方法是添加右关联方法，但明显的缺点是两个运算符的语法不同：

```
class A {
  val f: Float = 1.0f

  def +(f: Float) = this.f + f
  def +:(f: Float) = this.f + f
}

val a: A = new A
a + 1.0f
1.0f +: a 
```

# jquery - 如何使用 jQuery 更改文本大小写

> ID：11376547
> 
> 赞同：1
> 
> 时间：2012-07-07T16:06:16.693
> 
> 标签：jquery

我觉得自己像个傻瓜，不知道如何使用 jQuery 更改大小写。堆栈溢出 = 堆栈溢出。

jQuery

```
 var name = "Stackoverflow"
 $('name').toLowerCase();
 alert(name); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T16:08:05.770

为此，您不需要 JQuery。只需使用纯 JavaScript：

```
var name = "Stackoverflow"
name = name.toLowerCase();
alert(name); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:08:19.610

尝试：

```
var name = "Stackoverflow"
name.toLowerCase();
alert(name); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:09:11.340

您正在声明一个变量 ，`name`然后尝试使用 jQuery 将其作为对象引用，这是不正确的，因为它不是有效的对象。相反，您希望将 JavaScript 方法`toLowerCase()`应用于变量，并根据需要转换字符串。

```
var name = "Stackoverflow"
name = name.toLowerCase();
alert(name); 
```

为了在实际对象上使用该方法，您首先必须从该对象中提取一个字符串值，可能使用`text()`or`val()`方法，然后再应用大小写转换方法。

您可以通过将`toLowerCase()`方法直接应用于变量声明中的字符串来使其更简单，如下所示：

```
var name = "Stackoverflow".toLowerCase();
alert(name); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T16:11:12.477

为此，您不需要 jQuery。JavaScript 具有已内置到 String 类的 toLowerCase 和 toUpperCase 函数。

# php - yii 布局没有可见的变化

> ID：11376551
> 
> 赞同：0
> 
> 时间：2012-07-07T16:06:37.003
> 
> 标签：php, layout, yii

我尝试在浏览器上强制刷新并将布局的名称从更改`main.php`为`main_.php`仍然没有发生任何事情。没有可见的效果，没有错误，什么都没有。

我肯定在这里遗漏了一个小细节。任何人都可以指导初学者解决这个问题吗？

版本：Yii 1.1.10

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:21:59.837

检查站点/布局和主题/布局中的主要布局，肯定还有更多版本。

对您来说，[yii 调试工具栏](http://www.yiiframework.com/extension/yii-debug-toolbar)第 3 方扩展肯定有助于识别所使用的布局文件，安装它。

您可以控制哪些布局文件包含在控制器的`$layout`属性中

您需要告诉您的控制器使用当前模块中的布局，使用单斜杠表示法，例如：$layout = '/site/myview' 在以下位置了解更多信息：[getLayoutFile](http://www.yiiframework.com/doc/api/1.1/CController#getLayoutFile-detail) ()

# c++ - 将 temp 分配给 const ref 成员会导致分段错误

> ID：11376557
> 
> 赞同：5
> 
> 时间：2012-07-07T16:07:16.223
> 
> 标签：c++, constructor, temporary-objects, const-reference

通过一个例子更好地解释：

**托克.h**

```
#include <string>

static const char* defaultDelim = ".,;";

class Tokenizer {
public:
    Tokenizer():
        // 'delim' is the const ref member that is initialized by the temp string 
        delim( (altDelim.size())? altDelim : std::string(defaultDelim) ) 
    {}

    size_t scan(const std::string& str)
    { return str.find_first_of(delim); }

    static void setDelim(const std::string& d) { altDelim = d; }
private:
    static std::string altDelim;
    const std::string& delim;
}; 
```

**主文件**

```
#include <iostream>
using namespace std;

#include "tok.h"

std::string Tokenizer::altDelim;

int main()
{
    Tokenizer tok;

    size_t pos = tok.scan("hello, world");
    cout << pos << endl;
} 
```

程序打印 0 这是错误的。实际代码出现段错误。

我希望延长分配给 const 引用的 temp 的生命周期的规则在这里会成立，但显然不是。你知道原因吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T16:11:05.363

该规则不适用于班级成员。这在 C++03 标准的 12.2.5 中有说明：

```
A temporary bound to a reference member in a constructor's ctor-initializer
persists until the constructor exits. 
```

使临时对象的持续时间比这更长意味着必须将临时对象保留为类的一部分，以便可以维持其生命周期。如果构造函数位于单独的编译单元中，这是不可能的，因为在定义类时必须知道类的大小。

```
// header file
struct A {
  A();
  B &b;
};

// file1.cpp
void f()
{
  A a; // Reserve the size of a single reference on the stack.
}

// file2.cpp
A::A()
: b(B()) // b is referencing a temporary, but where do we keep it?
         // can't keep the temporary on the stack because the
         // constructor will return and pop everything off the stack.
         // Can't keep it in the class because we've already said the
         // class just contains a single reference.
{
} 
```

# java - 不使用浏览器访问网站

> ID：11376559
> 
> 赞同：-2
> 
> 时间：2012-07-07T16:07:27.450
> 
> 标签：java, http, sockets, servlets, web

我只是在学习java。我只想制作一个简单的应用程序来访问网站。有一个网站我想通过java登录：然后通过我的界面与之交互，基本上在登录后，我会在一些文本框中写并发送它。我尝试了很多地方，研究了 HTTP 协议，但仍然无法做到。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-07T16:20:32.777

访问网站、登录并与其中的表单交互是一项复杂的工作，因此它可能不是第一个 java 项目的最佳选择。

但是如果你想这样做，你可能应该使用[Apache HttpComponents/HttpClient](http://hc.apache.org/httpcomponents-client-ga/)。

上面的链接中也有一些有用的示例，可以帮助您入门。

# php - 在 javascript 中调用 php 时出错

> ID：11376560
> 
> 赞同：0
> 
> 时间：2012-07-07T16:07:38.850
> 
> 标签：php, javascript

当我写：

```
alert(<?php echo "33333";?>); 
```

有用。

如果我回显一个数字，它也可以。但如果我写

```
alert(<?php echo "346346gj";?>); 
```

它不起作用。

有人能告诉我为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:09:46.377

确保将生成的 JS 括在引号中：

```
alert('<?= $stringVariable ?>'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:21:29.860

`alert(<?php echo "33333";?>);`将输出`alert(33333);`. 这是一个正确的 javascript 语法。

`alert(<?php echo "346346gj";?>);`将输出`alert(346346gj);`. 这不是正确的语法。

当你想`alert`在 javascript 中写一个字符串时，`alert("346346gj");`或者`alert('346346gj');`

因此，您必须替换`alert(<?php echo "346346gj";?>);`为以下内容之一：

*   `alert('<?php echo "346346gj";?>');`
*   `alert("<?php echo "346346gj";?>");`
*   `alert('<?php echo '346346gj';?>');`
*   `alert("<?php echo '346346gj';?>");`
*   `alert(<?php echo "'346346gj'";?>');`
*   `alert(<?php echo '"346346gj"';?>');`

而且还有不同的组合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:09:54.183

我不确定我是否理解你的问题，但是

```
alert(""+number); 
```

也许我误解了你。如果你想在 JavaScript 中打印 php 值，你应该通过 ajax 请求它们。“硬编码”它们不是要走的路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T16:12:02.620

因为在javascript中，字符串需要用引号引起来..所以试试

```
alert('<?php echo "33333j";?>'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T16:23:28.323

要将任何类型的 PHP 值（资源除外）直接输出到 JavaScript，请使用[`json_encode`](http://php.net/json-encode).

```
alert(<?php echo json_encode($myvar); ?>); 
```

`$myvar`几乎可以是任何东西，而且它总是有效的。我总是`json_encode`将 PHP 变量放入 JS 中。

# android - 多个意图接收器？

> ID：11376561
> 
> 赞同：4
> 
> 时间：2012-07-07T16:07:44.287
> 
> 标签：android, android-intent, action

文档指出，如果一个`Intent`可以由多个应用程序处理，则会提示用户一个对话框，要求他选择应用程序来完成操作。有没有办法让用户选择多个应用程序来完成操作？例如，如果我想共享一条消息，我将使用`ACTION_SEND`指定的 MIME 类型，系统会提示我提供可以共享该消息的应用程序列表。我可以让用户选择多个应用程序同时在 Twitter、Facebook 等上分享消息吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:25:07.643

> 有没有办法让用户选择多个应用程序来完成操作？

不是安卓原生的。

话虽如此，没有什么能阻止您使用`PackageManager`并`queryIntentActivities()`创建自己的选择器以允许多项选择，然后将事件一一分派给每个选中的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:21:37.487

操作系统处理它的方式似乎不是。你谈论[这个](http://developer.android.com/training/sharing/send.html)，对吧？因为您加载文本和/或图像，然后共享它。许多应用程序可以处理它，但每个应用程序处理它的方式不同。让应用程序在获取文本和/或图像时，什么也不做！

例如 G+，询问您要与哪些圈子分享。facebook 我不知道，我不使用它。短信/彩信：可能会看到它们之间是否有图片或其他东西可供选择。

甚至Dropbox有时认为可以处理一些共享，但最终它不能！

此外，共享中没有多选选项。

如果有，会发生什么？比如选择g+和twitter，先打开G+ New post Activity，完成后打开Twitter一个？

也许为那些 soc 使用 API。网络，但用户可能不得不再次提供其凭据。

# c# - C#在不同的选项卡中显示相同的面板

> ID：11376572
> 
> 赞同：0
> 
> 时间：2012-07-07T16:08:50.070
> 
> 标签：c#, panel

我有一个带有多个选项卡的选项卡控件，我想要一个显示进度条的面板，当用户正在处理某些内容时，它会显示进度条，并在处理完成时隐藏起来。

我在 tabcontrol 的第一个选项卡中添加了该面板。但是，现在面板仅在用户选择第一个选项卡时可见，但在用户选择其他选项卡时消失。

我希望面板在用户选择其他选项卡时显示。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:13:45.880

把它放在外面有什么问题`TabControl`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:11:06.957

我希望你谈论 WPF，如果是这样，将 TabControl 包装在一个网格中，给网格 2 个孩子的第一个 tb 控件第二个进度条，每当你将进度条的可见性设置为可见时，它都会在屏幕顶部。

# php - 查询线程消息系统不起作用（基于另一位成员的帖子）

> ID：11376574
> 
> 赞同：0
> 
> 时间：2012-07-07T16:08:58.113
> 
> 标签：php, mysql, database

我一直在阅读这篇文章[创建像 facebook 和 gmail 这样的线程私人消息系统](https://stackoverflow.com/questions/6420264/creating-a-threaded-private-messaging-system-like-facebook-and-gmail)

它很好地解释了一切，但查询对我不起作用。我在第 1 行收到一个错误，上面写着 "top 1" 。:(

以下是我试图达到的场景：

1.  5 个人正在与 member1 交谈。成员 1 和其他 5 个成员有线程，所以总共有 5 个线程，因为有 5 个对话。我需要从 5 个线程中的每一个中获取最新回复以及留下最后回复的人的用户名。

2.  消息打开后，显示回复。

我猜我正在阅读的帖子很有效率，并且可以很好地处理成千上万的线程/回复。如果它会很慢，请告诉我是否有人可以将我指向一篇正确完成的文章。我对MYSQL不太好，还在学习。

我正在使用这个表设置

![在此处输入图像描述](../Images/48e768e0d07fea84a84b33e03e6afd35.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:12:52.753

[`TOP`](http://technet.microsoft.com/en-us/library/ms189463)是 Transact-SQL 语法——例如用于 MS SQL Server 和 Sybase。MySQL 中的等效语法是`LIMIT`（位于命令末尾[`SELECT`](http://dev.mysql.com/doc/en/select.html)）：

```
select
  M.message_id
, M.sent_datetime
, M.title
, M.message_text
, S.user_id
, S.user_name
-- and anything else you want...
from MESSAGE M inner join USER S
  on M.sender_user_id = U.user_id
where M.reply_to_message_id = @ThreadRootMessageID
order by
  M.sent_datetime desc
limit 1 
```

# hibernate - org.hibernate.MappingException：无效配置

> ID：11376575
> 
> 赞同：0
> 
> 时间：2012-07-07T16:09:04.603
> 
> 标签：hibernate

运行以下代码时，我是休眠的新手，它显示映射异常如何纠正任何人指导我。我正在使用 Eclipse IDE

我的主要课程

```
 UserDetails userDetails = new UserDetails();
        userDetails.setUserId(1);
        userDetails.setUserName("Anand");
        SessionFactory sessionFactory = new 
        Configuration().configure().buildSessionFactory();
        Session session = sessionFactory.openSession();
        session.beginTransaction();
        session.save(userDetails);
        session.getTransaction().commit(); 
```

我的 hibernate.cfg.xml 文件

```
<session-factory>
<property name="connection.driver_class">com.mysql.jdbc.Driver</property>
<property name="connection.url">jdbc:mysql://localhost:3306/test</property>
<property name="connection.username">root</property>
<property name="connection.password"></property>
<property name="dialect">org.hibernate.dialect.MySQLDialect</property>
<property name="cache.provider_class">org.hibernate.cache.internal.NoCacheProvider</property>
<property name="show_sql">true</property>
<property name="hbm2ddl.auto">create</property>
<mapping class="classes.UserDetails"></mapping>
</session-factory> 
```

用户详细信息.java

```
package classes;

import javax.persistence.Entity;
import javax.persistence.Id;

@Entity
public class UserDetails {
    @Id
    private int userId;
    private String userName;

    public int getUserId() {
        return userId;
    }
    public void setUserId(int userId) {
        this.userId = userId;
    }
    public String getUserName() {
        return userName;
    }
    public void setUserName(String userName) {
        this.userName = userName;
    }

} 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-05T15:55:26.377

[下面的 xml 是来自Hibernate 社区文档](http://docs.jboss.org/hibernate/core/3.5/reference/en/html/session-configuration.html)的示例配置文件

```
<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
    "-//Hibernate/Hibernate Configuration DTD//EN"
    "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">

<hibernate-configuration>

    <!-- a SessionFactory instance listed as /jndi/name -->
    <session-factory
        name="java:hibernate/SessionFactory">

        <!-- properties -->
        <property name="connection.datasource">java:/comp/env/jdbc/MyDB</property>
        <property name="dialect">org.hibernate.dialect.MySQLDialect</property>
        <property name="show_sql">false</property>
        <property name="transaction.factory_class">
            org.hibernate.transaction.JTATransactionFactory
        </property>
        <property name="jta.UserTransaction">java:comp/UserTransaction</property>

        <!-- mapping files -->
        <mapping resource="org/hibernate/auction/Item.hbm.xml"/>
        <mapping resource="org/hibernate/auction/Bid.hbm.xml"/>

        <!-- cache settings -->
        <class-cache class="org.hibernate.auction.Item" usage="read-write"/>
        <class-cache class="org.hibernate.auction.Bid" usage="read-only"/>
        <collection-cache collection="org.hibernate.auction.Item.bids" usage="read-write"/>

    </session-factory>

</hibernate-configuration> 
```

我参考[了@Vash 的回答](https://stackoverflow.com/questions/10586512/configure-sessionfactory-in-hibernate-in-standalone-application/10586765#10586765)。

我希望这将有助于解决您的问题。

# javascript - 在 Backbone.View 中隐藏 div

> ID：11376576
> 
> 赞同：0
> 
> 时间：2012-07-07T16:09:06.160
> 
> 标签：javascript, jquery, html, backbone.js

为什么 jquery 选择器不起作用？

看法

```
 Views.Now = Backbone.View.extend({
        template:"mytemplate",

        initialize:function () {
            var self = this;
            this.$el.find(".content").hide();  // selector is not working
        }

    }); 
```

模板：

```
<div id="now">
<p class="loader">Waiting for connection</p>
<div class="content">
    <button>hello world</button>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:13:07.347

主干视图仅在调用其 render() 方法后才会呈现。在此之前，视图的元素仍然是空的，所以选择器不会找到任何东西。

# c# - 如何通过 LINQ 在 asp.net 中检索值？

> ID：11376581
> 
> 赞同：0
> 
> 时间：2012-07-07T16:09:26.263
> 
> 标签：c#, asp.net, linq

我想使用 LINQ 将值设置为文字控件。我通过以下代码从 var 中的数据库中获得了结果：

```
var result=md.StoredProc_Name(id); 
```

现在我想将特定的列值分配给文字。正如我们可以在数据表的帮助下在 asp.net 中简单地做的那样，

```
dt=obj.Test(id);
ltrlName.Text=dt.Rows[0]["Name"].ToString();
ltrlAddress.Text=dt.Rows[0]["Address"].ToString(); 
```

我们如何在 LINQ 中做同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:14:30.420

```
var first = result.FirstOrDefault();

if (first != null)
{
   ltrlName.Text = first.Name;
   ltrlAddress.Text = first.Address;
} 
```

* * *

附录 - 如何在没有 linq 到对象的情况下执行此操作：

在名为 DB 的类中使用下面的代码

```
var result = DB.SelectIntoItem("StoredProc_Name",
                               connectionString,
                               System.Data.CommandType.StoredProcedure,
                               new { param1 = "val1" });

if (!reader.Empty)
{
   ltrlName.Text=result.Name;
   ltrlAddress.Text=result.Address;
}
etc. 
```

* * *

代码

```
public static dynamic SelectIntoItem(string SQLselect, string connectionString, CommandType cType = CommandType.Text, object parms = null)
{
  using (SqlConnection conn = new SqlConnection(connectionString))
  {
    using (SqlCommand cmd = conn.CreateCommand())
    {
      dynamic result = new System.Dynamic.ExpandoObject();

      cmd.CommandType = cType;
      cmd.CommandText = SQLselect;

      if (parms != null)
        Addparms(cmd, parms);

      conn.Open();

      using (SqlDataReader reader = cmd.ExecuteReader())
      {
        if (reader.Read())  // read the first one to get the columns collection
        {
          var cols = reader.GetSchemaTable()
                       .Rows
                       .OfType<DataRow>()
                       .Select(r => r["ColumnName"]);

          foreach (string col in cols)
          {
            ((IDictionary<System.String, System.Object>)result)[col] = reader[col];
          }
          result.Empty = false;

          if (reader.Read())
          {
            // error, what to do?
            result.Error = true;
            result.ErrorMessage = "More than one row in result set.";
          }
          else
          {
            result.Error = false;
          }

        }
        else
        {
          result.Empty = true;
          result.Error = false;
        }
      }

      conn.Close();

      return result;
    }
  }
}

private static void Addparms(SqlCommand cmd, object parms)
{
  // parameter objects take the form new { propname : "value", ... } 
  foreach (PropertyInfo prop in parms.GetType().GetProperties())
  {
    cmd.Parameters.AddWithValue("@" + prop.Name, prop.GetValue(parms, null));
  }
} 
```

如果你有兴趣关注我的 GitHub，我会尽快将其余部分公开（[GitHub](https://github.com/hoganlong "GitHub")）

# php - 在php脚本之前加载图像

> ID：11376590
> 
> 赞同：0
> 
> 时间：2012-07-07T16:10:09.220
> 
> 标签：php, image, loading

大家好，我有一个表单，在提交指向脚本“sendeveryone.php”的链接后，这个脚本需要很长时间才能完成，所以我想在完成时显示加载图像，我怎么能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:15:02.537

在提交时，您可以使用 javascript 显示加载图像。将`onclick="showLoading()"`属性放入您的提交按钮，并创建一个 showLoading() javascript 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:15:43.350

您有 2 个选项：ajax 调用脚本，然后在客户端运行一些显示进度的 js，或者您可以在 php 中返回响应并使用以下代码片段继续执行

```
/*
 * basically allow a php script to return a response and continue with
 * code execution, good for statistics.
 * before echo anything to user call begin and after call end, than you can continue doing stuff
 */
class ScriptContinuationManager
{
    /**
     * this is the point where we need to give a sign to this class
     * that we wanna write our response.
     * @return void
     */
    public function beginRespone()
    {
        ob_end_clean();
        header("Connection: close");
        ignore_user_abort(); // optional
        ob_start();

    }

    /*
     * after this function execution the response will be sent to the
     * client, and code continue without client need to wait.
     */
    public function endResponse()
    {
        $size = ob_get_length();
        header("Content-Length: $size");
        ob_end_flush(); // Strange behaviour, will not work
        flush(); // Unless both are called !

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:20:37.987

尝试一个javascript解决方案：

这将隐藏提交按钮并在适当位置显示图像。您需要自己选择加载图像，您可以在[http://ajaxload.info/](http://ajaxload.info/)生成一个。此外，您必须为表单提供一个 ID 属性，并将其放入脚本中。

（确保包含 jQuery）

```
var formid = ''; // What is the ID of the form? (without the #)
var imgpath = ''; // What is the path to the loading image you want to display?

$(document).ready(function(event){  
    $('#'+ formid).submit(function(event){
        $('#'+ formid +' input[type=submit]').after('<img src="'+ imgpath +'">').hide();
    });
}); 
```

编辑：我也建议使用 AJAX 方法，但看看你帖子的写作风格，我认为你没有那么先进。

# ios - 视图中的滚动视图不响应 IOS

> ID：11376595
> 
> 赞同：0
> 
> 时间：2012-07-07T16:10:48.110
> 
> 标签：ios, view, scrollview, viewcontroller

我知道我一定在做一些非常愚蠢的事情，但我正在努力做一些应该简单的事情。

我有一个标签栏应用程序，最初我有一个加载了仅包含滚动视图的 XIB 的视图控制器。我将滚动视图绑定到视图控制器视图，并将滚动视图绑定到滚动视图插座，并使文件所有者也成为委托……一切正常。

然后我决定在这个视图中添加更多元素，所以我创建了一个 VIEW，将 ScrollView 移动为该 VIEW 的子视图，并添加了更多元素。我将顶视图绑定到文件所有者视图，并将滚动视图再次绑定到控制器中的滚动视图元素，并将其委托为视图控制器

现在，突然滚动视图不滚动，似乎交互没有到达滚动视图或其他东西，并且被父视图拦截。

我对这个有点困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:24:01.293

进入 XIB 并确保滚动视图的“用户交互”选项仍处于启用状态。如果是，请检查每个视图上的“Exclusive Touch”插座以查看它们是否被禁用（应该是），并在滚动视图上启用它。如果一切都失败了，检查这个东西的内容大小是否大于它的框架，否则它不会滚动。

# node.js - NodeJS 加密的 HTTPS 响应体

> ID：11376596
> 
> 赞同：0
> 
> 时间：2012-07-07T16:10:53.883
> 
> 标签：node.js, ssl, https

我正在使用节点创建一个小型 icloud 客户端，以便我可以提取一些数据并对其进行分析。我目前正在编写登录序列的脚本。当我收到响应时，标头很好，并且我期望的会话 cookie 在那里，但是应该是 JSON 的响应正文看起来是加密的，它甚至不是纯文本。它通过 SSL，但如果标题是可读的，那么正文不应该也是如此吗？是否有我缺少的设置或节点中的错误，我使用的是最新的 0.8.1

```
{ date: 'Sat, 07 Jul 2012 14:51:56 GMT',
 'x-apple-request-uuid': '............',
 'x-responding-instance': '...........',
 'cache-control': 'no-cache, no-store, private',
 'access-control-allow-origin': 'https://www.icloud.com',
 'access-control-allow-credentials': 'true',
 'set-cookie': [........],
 'content-type': 'application/json; charset=UTF-8',
 'content-encoding': 'gzip',
 'content-length': '126' }
���������VJ-*�/R�R
K��LI,IUJ-,M-.Q��U��,.��KW��u�q�
wur
��
��v�SH����LU�Q��+.I�KN�bhldijiaaf/.MNN-.V�JK�)N��$���l��� 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T18:10:51.750

根据响应头`content-encoding: gzip`，响应没有加密，只是压缩了。您可以使用 Node 的`zlib`模块即时解压缩它。这是一个使用我的博客主页作为端点的示例（因为我的服务器在被询问时会使用 gzip 压缩的数据进行响应）：

```
http = require('http');
zlib = require('zlib');
url = require('url');

var uri = url.parse("http://brandontilley.com/");
uri.headers = {'accept-encoding': 'gzip'};

var request = http.get(uri, function(res) {
  var buffers = [];
  res.pipe(zlib.createGunzip()).on('data', function(chunk) {
    buffers.push(chunk);
  }).on('end', function() {
    console.log(Buffer.concat(buffers).toString());
  });
});
request.end(); 
```

[zlib 模块](http://nodejs.org/docs/latest/api/zlib.html#zlib_examples)的 Node.js 文档中有更多示例。

# android - Cocos2D-X：图像调整大小然后切割部分到 CCSprite

> ID：11376600
> 
> 赞同：0
> 
> 时间：2012-07-07T16:11:06.267
> 
> 标签：android, ios, xcode, image-resizing, cocos2d-x

我正在 XCode for iOS 下创建一个 Cocos2D-X 项目。然后我打算将最终代码转移到Android。

我想做的是制作一个函数来加载图像并在内存中任意调整它们的大小。然后，从调整大小的图像中，我将切出部分并创建 CCSprite 对象......我遇到的真正问题是在切割部分之前获得调整大小的图像。

我知道 Cocoa/UIImage 可以实现这一点，但我不会不使用 Objective-c 代码，以便 Android 移植更容易。如果可能的话，我想用 C++/Cocos2D-X 做所有事情。

我尝试在我的 XCode 项目中使用 ImageMagick Magick++ 源代码，但没有运气，因为我无法编译它。我尝试使用 CCImage，但其中没有调整大小的功能。

所以我的问题是：有没有办法在 Cocos2DX 中调整图像文件的大小？有没有其他方法可以达到我的目标？

谢谢，让

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:50:21.050

此重新缩放/剪切过程是您的应用程序的一部分，还是试图使应用程序图形适合多种 Android 屏幕分辨率？如果是后者，我不会推荐它。

您必须了解可以按任何顺序调整大小和切割。所以你真的不需要先调整图像大小，你也可以先剪切它，然后再调整它的大小。要调整大小，只需使用精灵的 scale 属性来放大或缩小它。

至于剪切图像，这实际上取决于您要如何剪切它。有很多方法可以切掉图像的一部分（沿边界切开、切出任意形状、切出透明度等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T18:04:11.457

要创建作为位图提取的精灵，您可以这样做并避免创建新位图（不确定这是您要查找的内容）：

CCSprite *cutSprite = CCSprite::spriteWithTexture(texture,CCRectMake(originX,originY,width,height));

# java - 使用多线程连接到 MySQL DB

> ID：11376602
> 
> 赞同：1
> 
> 时间：2012-07-07T16:11:12.563
> 
> 标签：java, mysql, multithreading

如果我有一个处理数据库的 java 代码并且我想在我的应用程序中使用多线程。每个线程都假设运行一个包含插入数据库的函数。我的问题是：我应该在哪里放置以下语句：

```
Connection con = DriverManager.getConnection (dbUrl);
query = " insert into schema.table values (default,?,?)";   
preparedStmt = con.prepareStatement(query); 
```

我应该将它们放在`run`每个线程中执行它们吗？或者`Main`他们只执行一次？还是在函数调用的`run`函数内部？当我有多线程时，我需要知道插入数据库的正确方法。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:48:12.540

您应该考虑为您的数据库相关工作创建一个 ConnectionPool 并从此池中获取连接。

您可能会感兴趣以下两个链接：

[连接池](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/conpool.html)
[Apache Commons DBCP](http://commons.apache.org/dbcp/)

**编辑** *感谢@MJB 指出这一点*：
[c3p0](http://www.mchange.com/projects/c3p0/)是另一个非常好的。
[BoneCP](http://jolbox.com/)是另一个

但归根结底，简单的一点是：您需要实现连接池。您选择哪一个完全是您的决定，并基于您的要求。

# dll - 经典 ASP 和 COM DLL 在 Server 2008 R2 中不起作用（Microsoft VBScript 运行时错误“800a01ad”ActiveX 组件无法创建对象）

> ID：11376604
> 
> 赞同：5
> 
> 时间：2012-07-07T16:11:14.477
> 
> 标签：dll, com, asp-classic, activex, windows-server-2008-x64

我在 Visual Studios 2010 中创建了一个 dll。我执行了以下步骤：

1.  给定通过将密钥对（snk 文件）关联到它来构建一个强名称

2.  给每个类一个单独的 ProgID 和 GUID

3.  因为它是一个 64 位 DLL，所以我确保使用了位于“FrameWork64/v4xxxx”文件夹中的 RegAsm.exe。我使用了 RegAsm.exe /codebase ECE2.dll

4.  我在 DLL 上运行了“gacutil -i”

所有这些步骤都已成功。我使用它的 DLL 和 ASP 页面存储在 intetpub/wwwroot 中。

现在，该 DLL在我的笔记本电脑和家用计算机（均运行 Windows 7 Ultimate）上运行*良好。*我现在正试图让它在**Windows Server 2008 R2**上工作。这就是我遇到问题的地方。

我完成了和上面一样的步骤，都成功了。但是，当我运行 ASP 页面时，我收到一条错误消息，提示它尚未注册，即使它具有：

> Microsoft VBScript 运行时错误“800a01ad”ActiveX 组件无法创建对象：“ECE2.CSV_DataSet”

我认为这可能是 IIS 中需要更改的设置。请注意，此服务器已配置为允许经典 ASP 页面，所以我知道不是这样。谁能给我任何指示，说明我是否需要在服务器中更改特定设置，或者是否有额外的安全环我必须跳过以使其在 Server 2008 上运行，而我不需要在 Windows 上执行7终极？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-08T19:56:50.683

Check the advanced settings of the application pool that this ASP application runs in. Does it have "Enable 32-Bit Application" set to True. If so then thats your problem you can't instantiate a 64 bit dll under a 32 bit pool.

Is there a reason you consider this to be a "64bit dll" instead of simple "Any CPU"? If not regasm it also for use as a 32 bit dll.

Otherwise you will need to run this ASP application without "Enable 32-Bit application" so that it runs as 64 bit but then there is probably a reason this is set in the first place. So the next step is to create a new application pool that doesn't have this setting and make a portion of your ASP run as a seperate application in this pool.

# php - 检查特定数组值是否设置 PHP

> ID：11376607
> 
> 赞同：0
> 
> 时间：2012-07-07T16:11:59.063
> 
> 标签：php, arrays, multidimensional-array

我有一个用于新闻项目的滑块，并循环获取每个项目的帖子信息。工作正常，但我被 json 返回的一个参数卡住了，我再次循环遍历它。$xtras 参数返回一些附加值，其中之一是附加介绍文本。我需要检查此值是否已设置，否则我需要返回默认介绍文本。

我遇到的问题是，如果 `$xtra_values->id 44` 不存在，我会从上一篇文章中获取介绍文本，而不是那篇文章`$post['intro']`

$xtras 像这样返回 stdClass 对象

```
stdClass Object
(
    [id] => 1
    [value] => 38
)
stdClass Object
(
    [id] => 28
    [value] => 1
)
stdClass Object
(
    [id] => 44
    [value] => This is extra intro text
) 
```

这是我的循环

```
foreach ($post_array as $key=> $posts){

    $xtras  = json_decode($posts['xtra']);

     foreach($xtras as $key=> $xtra_values){

        if($xtra_values->id == 44){
           $intro_text = $xtra_values->value;
        }else{
           $intro_text = $post['intro'];
        }     

     }

      echo $post['title'];.'<br />';
      echo $intro_text;
} 
```

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:15:31.540

foreach ($post_array as $key=> $posts){

```
$xtras  = json_decode($posts['xtra']);
$intro_text = null;

 foreach($xtras as $key=> $xtra_values){

    if($xtra_values->id == 44){
       $intro_text = $xtra_values->value;
    }     

 }
if($intro_text == null){
       $intro_text = $post['intro'];
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:13:43.183

尝试：

```
if(isset($xtra_values->id) && $xtra_values->id >= 0 && $xtra_values->id == 44){ 
```

# android - 如何在 SQLite 保存日期触发警报？

> ID：11376608
> 
> 赞同：0
> 
> 时间：2012-07-07T16:12:00.787
> 
> 标签：android, android-alarms

我正在申请生日警报。如果 SQLite 中保存的日期与当前日期匹配，则应启动警报。

谁能给我一些建议或任何链接？

```
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    setAlarm();
}

private void setAlarm()
{
    Calendar cal = Calendar.getInstance();

    cal.setTimeInMillis(System.currentTimeMillis());
    cal.clear();
    cal.set(2012,2,8,18,16);

    AlarmManager alarmMgr = (AlarmManager)getSystemService(Context.ALARM_SERVICE);
    Intent intent = new Intent(this, AlarmReceiver.class);
    PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0, intent, 0);
   // cal.add(Calendar.SECOND, 5);
    alarmMgr.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), pendingIntent);
} 
```

在此之后，我不知道该怎么做，因为我是新手。任何人都可以建议我的过程或链接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:44:01.983

您应该在 SO 上发布特定问题/问题，而不是完整的要求，请按照以下步骤操作

1）将您的要求分解为尽可能小的步骤..

2）逐步尝试，做一些学习/阅读..

3）如果仍然无法控制，请来发布具体问题，

4）您对 SO 的问题应包括问题、您尝试过的内容、预期输出、当前输出和 logcat 错误（如果有）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:56:05.617

在发布问题之前，您应该对某个主题进行更多研究，但是，这里有一些链接可以解决您的问题。

[http://justcallmebrian.com/?p=129](http://justcallmebrian.com/?p=129)

[http://www.androidcompetencycenter.com/2009/02/android-basics-alarm-service/](http://www.androidcompetencycenter.com/2009/02/android-basics-alarm-service/)

# c# - 从我的 C# 应用程序连接到我的远程 mysql 数据库

> ID：11376613
> 
> 赞同：2
> 
> 时间：2012-07-07T16:12:29.840
> 
> 标签：c#, .net, mysql, visual-studio-2010

好的，所以我正在尝试从我的 Web 主机连接到我的数据库，但是如果我使用“localhost”，支持人员一直说在我的 C# 程序中使用“localhost”，它会连接到我本地计算机上的 mysql 数据库。

我只是想知道从我的程序连接到我的数据库以使其连接到我的服务器并在我的服务器下使用“localhost”时是否可以在“服务器”参数下放置一些东西？我必须对 DNS 做些什么吗？如果是这样，我要添加什么？它在我的虚拟主机的 DNS 记录编辑器下显示“名称”和“地址”。

这是我的代码 **请求人：JMK** （密码和 uid 被审查）

```
string connString = "Server=localhost.mydomain.com;Database=***;Uid=bender;password=***";
           MySqlConnection conn = new MySqlConnection(connString);
           MySqlCommand command = conn.CreateCommand();
            command.CommandText = "SELECT * FROM users";
            try
           {
                conn.Open();
            }
            catch(Exception ex)
            {
               MessageBox.Show(ex.Message);
           }
          MySqlDataReader reader = command.ExecuteReader();
            while (reader.Read())
            {
                listView1.Items.Add(reader["username"].ToString());
            } 
```

这是我的代码。我试过“localhost.mydomain.com”，但它只是将它重定向到我的本地主机机器。我将如何获得我的域的 ip？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:18:25.137

如果您想连接到“支持人员”服务器，您需要指定它的地址。他们希望您使用 localhost 因为可能应用程序将位于运行服务器的同一台计算机上，但您正在本地计算机上进行开发，因此 localhost 就是您的 PC 本身。为了获得更大的灵活性，我将使用 2 个配置文件（发布和调试）来自动分配连接到哪台机器（目标机器名称取自目标团队或本地主机，它将指向您的 PC）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:26:39.890

他们说 localhost 是因为数据库与 Web 服务器在同一台服务器上运行。当您说“从我的程序连接到我的数据库以使其连接到我的服务器”时，您的意思是您自己的数据库服务器不在您的开发 PC 上吗？

如果您使用的是 .NET 4，您实际上可以在 web.config 上运行转换以根据您的目标配置更改设置。这样，您就可以拥有在本地计算机上运行时使用的调试配置，以及在发布模式下发布项目时使用的发布配置。要在两者之间切换，您只需更改 Visual Studio 中的构建配置。

这里有更多关于它如何工作的信息：http: [//www.shubho.net/2011/03/transformation-webconfig-aspnet-40.html](http://www.shubho.net/2011/03/transformation-webconfig-aspnet-40.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:27:43.417

当您使用 godaddy.com 时，它为您提供全局访问 mysql 数据库的选项，并为您提供可以在任何地方使用的主机名。并非所有提供商都提供该选项。您还应该考虑通过 Internet 进行的延迟和不安全的数据传输。

# vb.net - 硬件资源内存信息列表视图（msinfo32）

> ID：11376621
> 
> 赞同：0
> 
> 时间：2012-07-07T16:13:07.997
> 
> 标签：vb.net, visual-studio, memory, ram, system-information

有没有办法在 vb.net 中做到这一点？

![在此处输入图像描述](../Images/e1f2811c16515906bc18695de9392f63.png) 有没有检索该信息的功能？有什么方法可以在 ListView 中显示主题？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:39:28.837

您可以通过`My.Computer.Info`Object.

以下属性提供有关您的计算机内存的信息

> 可用物理内存
> 可用虚拟内存总计物理内存
> 总计
> 虚拟内存

Code Project 上有一篇关于获取 PC 硬件信息的有趣文章：[How To: (Almost) Everything In WMI via C# - Part 3: Hardware](http://www.codeproject.com/Articles/18268/How-To-Almost-Everything-In-WMI-via-C-Part-3-Hardw)。代码在 C# 中；但是，在 VB 中也可以使用相同的方法。

# perl - 使用 Perl 替换 Word 中的特殊字符

> ID：11376627
> 
> 赞同：0
> 
> 时间：2012-07-07T16:13:39.577
> 
> 标签：perl

我可以替换一个单词中几乎所有的特殊字符，除了以下内容：

```
">" - greater than symbol
"<" - less than symbol
"=" - equal to symbol 
```

我可以通过转义其他特殊字符（如 (+[]/) 等元字符）来工作。

但是，我无法使上述 3 个特殊字符起作用。

```
$word =~ s/[\>\<\=]//g; # Delete these special characters from the word 
```

我该如何替换它们？就我而言，我试图从单词中删除或去除特殊字符，而这 3 个符号似乎是唯一我无法替代的符号。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T16:22:52.637

好吧，即使在正则表达式主体中，您也不需要转义这些符号，更不用说将它们用作字符类的一部分了。这很有效：

```
 my $test_string = '<my_word=some_word>';

  $test_string =~ s/[<>=]//g;
  # $test_string =~ s/<|>|=//g; is correct too, although a bit slower
  print $test_string; # my_wordsome_word 
```

尽管如此，它在编写时与您的示例中的[工作方式相同。](http://codepad.org/uCcEHzdw)所以我猜这个错误在你的代码中的其他地方。你能展示更多吗？)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T15:04:38.473

正如其他人指出的那样，您的角色在任何方面都没有特别之处，因此您的代码应该可以正常工作。

我想补充一点，替换运算符可能不是从字符串中删除字符的最佳方法。无需为此调用正则表达式引擎的强大功能和复杂性。我会改为使用音译运算符（请参阅[perldoc perlop](http://perldoc.perl.org/perlop.html#Quote-Like-Operators)中的 tr/// ）。

```
$ perl -E'$ARGV[0]=~ tr/<>=//d; say $ARGV[0]; ' 'a<>=b'
ab 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T16:21:21.537

<、> 和 = 没有什么特别之处，它们不是元字符，所以你甚至不需要转义它们

```
perl -E'$ARGV[0]=~ s{[<>=]}{}g; say $ARGV[0]; ' 'a<>=b' 
```

给我 ab

你的问题来自别的东西

# android - 我应该写什么我的应用程序在手机转动的情况下没有改变方向？

> ID：11376630
> 
> 赞同：-2
> 
> 时间：2012-07-07T16:13:46.160
> 
> 标签：android, orientation

如果手机转动 90 度角，我的应用程序没有改变方向，我该怎么写？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:16:51.720

在您的 AndroidManifest.xml 文件中，您可以为每个应用程序的活动指定默认屏幕方向。使用`android:screenOrientation`带有值的标记，例如`portrait`或`landscape`。更多信息[在这里](http://developer.android.com/guide/topics/manifest/activity-element.html)。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:16:56.157

您基本上可以在清单中的活动声明中使用 screenOrientation 标记。您可以根据需要设置风景或肖像。下面是一个例子......''

```
 <activity android:name=".ActivityName"

              android:screenOrientation="portrait"> 
```

# linux - 如何使用 sed 显示记录的特定列

> ID：11376631
> 
> 赞同：4
> 
> 时间：2012-07-07T16:13:53.407
> 
> 标签：linux, sed

我有一个这样的列表：

```
5678:robert dylan   :d.g.m. :marketing  :04/19/43 85000 
```

我只想显示此人的姓名和名称。我想用`sed`它。我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T16:17:03.650

**更新**：

```
echo "5678:robert dylan :d.g.m. :marketing :04/19/43 85000" | 
sed 's/:/\n/g' | sed '1d;3d;$d'| sed 'N;s/\n/ - /' 
```

产量

```
robert dylan - marketing 
```

*解释：*

工作原理是根据 将行拆分为多行`:`，删除第一行、第三行和最后一行，然后再次将它们连接起来。

**注意**：在最后一个表达式中，您可以通过在最后一组in之间放置其他内容*来指定将名称与指定分开的内容*`/ /``'N;s/\n/ /'`

* * *

*以前的 AWK 解决方案*：

不是`sed`，但是`awk`如果可以接受的话，它是一个非常自然的工具：

```
$ echo "5678:robert dylan :d.g.m. :marketing :04/19/43 85000" | awk -F":" '{print $2, $4}' 
```

产量

```
robert dylan  marketing 
```

或者，如果您的数据存储在名为的文件中`data.txt`：

```
awk -F":" '{print $2, $4}' data.txt 
```

将产生相同的输出。

[awk](http://www.grymoire.com/Unix/Awk.html)非常适合这类任务。

*说明*：

```
awk -F":" '{print $2, $4}' 
```

`-F`将字段分隔符设置为`:`，`print $2, $4`分别打印结果字段 2 和 4。您可以根据`printf`需要使用特定格式输出。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-26T15:49:21.180

只是想我会使用解决方案`cut`

```
 cut -d ":" -f 2,4 
```

产生：

```
 robert dylan :marketing 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-07T16:35:31.797

这可能对您有用：

```
echo "5678:robert dylan :d.g.m. :marketing :04/19/43 85000" |
sed 's/[^:]*:\([^:]*:\)[^:]*:\([^:]*\):.*/\1\2/'
robert dylan :marketing 
```

解释：

替换命令的左侧 (LHS) 表示：

*   `[^:]*:`匹配零个或多个 non`:`后跟 a `:`- 这匹配`5678:`
*   `\([^:]*:\)`如上所述，但将被记住为反向引用`\1`- 匹配`robert dylan :`
*   `[^:]*:`如上所述，但没有反向引用 - 匹配`d.g.m. :`
*   `\([^:]*\)`如上所述（除了`:`but 将被记住为反向引用`\2`- 匹配`marketing`
*   `:.*`a`:`后跟其他所有内容 - 匹配`:04/19/43 85000`

替换命令的右侧说：

*   `\1\2`用第一个和第二个后引用替换左侧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-07T13:35:06.693

类似于[Lavon 的方法](https://stackoverflow.com/a/11376656/438457)，但适用于多条记录

```
sed -n 's/:/\n/pg' file | sed -n '2~5h;4~5{H;g;s/\n/|/g;p}' 
```

会产生

```
robert dylan |marketing 
penny farthing |accident & emergency 
... 
```

对于输入文件

```
5678:robert dylan :d.g.m. :marketing :04/19/43 85000
8076:penny farthing :d.g.m. :accident & emergency :04/19/43 85000
... 
```

首先用换行符替换`:`每条`\n`记录5行；然后对于每组 5 行，复制第 2 行并将第 4 行附加到保存空间，转移到模式空间，`\n`用分隔符替换（在这种情况下`|`）并打印。（如果您不关心列顺序`{H;g;...`可以缩短为`{G;...`。）

# php - PHP Unicode 电子邮件

> ID：11376632
> 
> 赞同：0
> 
> 时间：2012-07-07T16:13:59.353
> 
> 标签：php

我想使用 PHP 发送主题为日文字符的电子邮件。我可以在发件人中使用日语字符发送，但是当我在主题中使用它时，电子邮件不会收到。我该如何解决这个问题。请帮忙。

谢谢，吉普

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:23:03.720

使用 PHPmailer 库，我在使用 UTF8 字符时从未遇到过问题。[http://phpmailer.worxware.com/](http://phpmailer.worxware.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:18:41.043

[google 的第一个结果](http://robotlibrarian.billdueber.com/sending-unicode-email-headers-in-php/)（对于“php unicode email”）

这是代码：

```
$headers['To'] = $to;
$headers['From'] = $from;
$headers['Content-Type'] = "text/plain; charset=utf-8";
$headers['Content-Transfer-Encoding'] = "8bit";
$b64subject = "=?UTF-8?B?" . base64_encode($subject) . "?=";
$headers['Subject'] = $b64subject;

$mail = Mail::factory('sendmail', array('host' => $host, 'port'=>$port));
$retval =  $mail->send($to, $headers, $body); 
```

# c++ - dll和应用程序之间的C++外部使用

> ID：11376633
> 
> 赞同：5
> 
> 时间：2012-07-07T16:14:22.633
> 
> 标签：c++, dll, extern

如果这是一个愚蠢的问题，请原谅我，但我正在关注一本书并且它不起作用。我有一个游戏引擎，它存在于一个 dll 中。它有几个外部函数可以在实际的游戏应用程序中使用：

```
extern void game_preload(); 
```

这一切都很完美而且很花哨，但是当我去构建所有东西时，我得到了一个错误：

```
Undefined reference to `game_preload()' 
```

为什么是这样？我怎样才能让它构建出 dll，以便我可以在应用程序中实现这些功能？

我正在关注的书名为“高级 2D 游戏开发”，它没有提到存在问题。

编辑：我读错了这本书，我应该制作一个静态库而不是动态库。但是我可以问一下有什么类似于动态库的“外部”用法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:21:32.950

您必须链接静态或动态库（对于 MSVC，这是一个带有“lib”扩展名的文件，对于 GCC，这是“a”、“o”或“dll”，具体取决于您的系统等）。该`extern`关键字旨在告诉编译器某些变量可以在另一个编译单元中找到（如前向声明，但用于变量）。无论如何，函数原型总是`extern`存在的，因此可以在此处省略。

还有一种特殊情况是使用`extern "C"`明确告诉编译器将某些代码作为 C 而不是 C++ 处理（例如，链接到 C++ 代码中的 C 风格函数）。

编辑：创建和使用静态库更容易。[您可以阅读此内容，包括此处的一些示例。](http://www.adp-gmbh.ch/cpp/gcc/create_lib.html)但是我认为它应该在书中的某些部分进行解释，除非你到目前为止不应该使用任何图书馆（如评论之一所述）。

# visual-studio-2010 - 在 Visual Studio 2010 中添加调试 DLL 和发布 DLL 配置

> ID：11376634
> 
> 赞同：1
> 
> 时间：2012-07-07T16:14:26.940
> 
> 标签：visual-studio-2010, dll, linker, configurationmanager

我全新安装了 Visual Studio 2010。在之前的安装中，我为 C++ 项目设置了 Debug DLL 和 Release DLL 构建配置，但对于我的一生，我不记得我是如何做到的或找到说明（我模糊记住开关 /MD 和 /MDd）。

有人可以解释如何为 C++ 项目添加 32 位和 64 位调试/发布 dll 配置吗？

# java - 关于 Java 同步块的 3 个快速问题

> ID：11376637
> 
> 赞同：3
> 
> 时间：2012-07-07T16:14:32.750
> 
> 标签：java, synchronized

据我了解，下面的代码在`synchronized`块中`this`是一个计数器的实例。

**问题一：**在下面的例子中，这是否意味着当线程 A 到达`synchronized`块时，线程 B 被阻止对 Counter 的实例做任何事情？换句话说，这是否意味着线程可以继续按他们看到的方式执行，但是在任何一个到达 `synchronized`块时，另一个停止对类做任何事情，直到块退出？

```
public class Counter {

    public void increment() {
        // Some code

        synchronized (this) {  // <---- "this" is an instance of Counter
             // Some more code
        }
    }
} 
```

将上面的代码与

```
public class Counter {

    List<String> listOfStrings = new ArrayList<String>();

    public void increment() {
        // Some code

        synchronized (listOfStrings) {  
             // Some code that deals with 
             //    listOfStrings 
        }
    }
} 
```

**问题2：**在上面的例子中，一旦线程A到达`synchronized`块，线程B可以继续读写类中的任何东西，除了`listOfStrings`ArrayList，它是块`mutex`中的a。`synchronized`它是否正确？

**问题3：**假设如果我们需要对多个对象进行修改是否更正确，`this`我们`mutex`应该使用？

例如：

```
public class Counter {

    List<String> listOfStrings = new ArrayList<String>();
    List<Integers> listOfIntegers = new ArrayList<Integers>();

    public void increment() {
        // Some code

        synchronized (this) {  
             // Some code that deals with 
             //    listOfStrings and listOfIntegers
        }
    }
} 
```

我理解正确吗？如果我遗漏了什么，请更正。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T16:20:26.497

> 线程 B 被阻止对 Counter 的实例执行任何操作？

不，线程 B 被阻止进入同步的代码块，它仍然可以进入其他方法：那些不同步的方法和那些使用不同对象同步的方法。线程 B 不能只访问使用已被*不同*线程占用的对象同步的块（同步锁是可重入的）。

> 线程 B 可以继续读写类中的任何内容，除了`listOfStrings`

`listOfStrings`并非如此，在一个块中用作互斥锁这一事实`synchronized`并不意味着其他线程无法显式访问该对象。这仅意味着其他线程无法访问由同一对象保护的同步块。因此，如果您想保护对`listOfStrings`对象的访问，则访问该对象的所有方法都必须同步并使用相同的锁（例如`listOfStrings`）。

顺便说一句，您同步的每个对象都应该`final`避免头痛。

> 假设如果我们需要对多个对象进行修改，这就是我们应该使用的互斥体，是否更正确？

是和不是。考虑以下情况：

```
List<String> listOfStrings = new ArrayList<String>();
List<Integers> listOfIntegers = new ArrayList<Integers>();
Set<String> setOfStrings = new HashSet<String>();
Set<Integers> setOfIntegers = new HashSet<Integers>(); 
```

如果一种方法只访问列表而第二种方法只访问集合，您可以安全地使用两个锁——一个用于第一种方法，第二个用于第二种方法。同步`this`不会受到伤害，但会影响性能：

```
private final Object listLock = new Object();
private final Object setLock = new Object(); 
```

然后：

```
synchronized (listLock) {  
     // Some code that deals with 
     // setOfStrings and setOfIntegers
}

//...

synchronized (setLock) {  
     // Some code that deals with 
     // setOfStrings and setOfIntegers
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-07T16:22:24.147

快速回答：

1.  来自的锁`synchronized`是可重入的，这意味着获得它的线程仍然可以进入同一对象上的任何其他同步块。任何其他想要进入该对象上的任何同步块的线程都将被阻止。

2.  对象上的同步并不意味着该对象不能被修改。**备注**：不要将同步对象视为互斥锁。任何线程都可以进入不同步对象的类的方法。如果该方法修改了对象，则没有什么可以阻止它。要获得您想要的，您需要使同步对象的类本身是线程安全的。

3.  ~~你不正确~~：你**是对的**，但你做得过火了。您不应该跳到使用同步所需类的最大范围。事实上，你不应该依赖`this`一般。最好将内部对象（甚至是“虚拟对象”，例如 a `new Object()`）锁定到该类，否则将允许使用该类中的对象的任何代码尝试在它们上进行同步。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T16:18:21.913

同步块中的对象只是一个令牌，这意味着持有令牌的线程可以进入执行块（同步内部的内容），而不是锁定对该对象的访问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T16:46:17.623

在 java 中，任何对象都可以用作互斥锁 - java.lang.Object 具有充当互斥锁的能力，并具有 wait() 和 notify() 方法。

同步块引用对象 - 一旦线程进入同步块，作为互斥体传递的对象被锁定。每当线程尝试进入同步块时，它都会检查互斥对象上的锁。如果对象被锁定，线程会等待对象。一旦工作线程退出同步块 - 调用对象的通知方法并通知等待线程 - 在所有等待线程中，只有一个线程会锁定对象并进入同步块，其余线程继续等待对象引用。

决定将哪个对象用作互斥锁非常重要 - 如您的场景中所述。

另一个需要注意的重点是同步块不会阻止多个线程编辑互斥对象。这是参考您的问题 2 - 特别是以下句子：

> 在上面的例子中，一旦线程 A 到达同步块，线程 B 可以继续读取和写入类中的任何内容，但 listOfStrings ArrayList 除外，它是同步块中的互斥锁

假设线程 B 不能读/写 listOfStrings，因为它被用作互斥体，这是错误的。以下场景可能允许 listOfString 被多个线程处理：

```
public class Counter {      

List<String> listOfStrings = new ArrayList<String>();  

public void decrement(){
   listOfStrings = new ArrayList<String>();
}

public void increment() {      
    // Some code      

    synchronized (listOfStrings) {        
         // Some code that deals with       
         //    listOfStrings       
    }      
 }      
} 
```

在上述场景中，线程 A 可能调用增量 - 进入同步块锁定 listOfStrings，同时线程 B 可能调用减量，即使它使用增量互斥体，它也能够更新 listOfStrings。之所以如此，是因为同步块不会阻止互斥对象的更新——它只是确保 2 个线程不会进入具有相同互斥对象的同步块。互斥锁这个名字突出了这个本质——互斥——使用同一个互斥锁不是强制，而是不同代码块的相互理解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T16:25:42.377

关于问题1：多个线程可以同时执行同步块外的代码，但一次一个线程可以执行同步块内的代码。通常，您希望将任何修改`Counter`类的实例变量的代码放在块内，而仅适用于当前方法的局部变量的代码可以放在同步块之外。

关于问题二和三：您可以在您想要的任何对象上进行同步，只要所有访问实例变量的代码`Counter`都在同步块内（假设您不希望在写入时从计数器读取数据）操作正在进行中）。我实际上建议在其中一个列表上同步，或者`Object`在这种情况下甚至是显式的私有独立实例 - 如果不需要此类之外的代码直接获取其同步监视器，通常最好通过同步来禁用它类内部的私有对象。

# windows - 使用 CMake 和 minGW 编译 OpenCV

> ID：11376640
> 
> 赞同：5
> 
> 时间：2012-07-07T16:15:14.450
> 
> 标签：windows, opencv, mingw

我无法在 Windows 上使用 Cmake 和 MinGW 编译 openCV。我完全不明白我的错误，请看一下：

好吧，我不能发布任何图片。所以这里是错误：

```
CMake Error at cmake/OpenCVUtils.cmake:19 (if): 
```

如果给定参数：

```
"C:/BuildOpenCV" "MATCHES" "^C:/Users/Corentin/Desktop/C_C++/openCV/opencv" "OR" "C:/BuildOpenCV" "MATCHES" "^C:/BuildOpenCV" 
```

正则表达式“^C:/Users/Corentin/Desktop/C_C++/openCV/opencv”无法编译调用堆栈（最近调用优先）：CMakeLists.txt:281 (ocv_include_directories)

我的源目录：C:/Users/Corentin/Desktop/C_C++/openCV/opencv

在哪里构建二进制文件：C:/BuildOpenCV

你知道什么会导致这种问题吗？我是新用户，我可能忘记了一些重要的细节，请原谅我=）。

谢谢 ！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-09T14:00:05.090

令人惊讶的是，我今天遇到了同样的错误，并在 stackoverflow 上搜索了解决方案... ;o)

答案在第二条错误信息中：Regular expression "^C:/Users/Corentin/Desktop/ **C_C++** /openCV/opencv" cannot compile

和你一样，我是否将我的文件夹命名为 ../C++/..

由于整个路径是作为正则表达式输入的，因此“+”被解释为“一个或多个字符”的正则表达式控制序列。因此 ++ 没有意义，表达式无法编译。

（快速）解决方案是将您的目录重命名为 cpp 或其他不带控制字符的名称。

从我的角度来看，这是一个错误，因为还可能有其他“控制字符”[]().*+\{}? （特别是在 Windows 中）在路径字符串中，即版本号：OpenCV-2.4.1

我没有时间注册自己以报告错误，但也许其他人已经有一个帐户？

# bash - 在 Bash 中正确解析 yad 输出

> ID：11376641
> 
> 赞同：0
> 
> 时间：2012-07-07T16:15:16.860
> 
> 标签：bash, shell

我想使用[yad](http://code.google.com/p/yad/)显示项目列表，然后对每个项目执行 shell 命令。但是，yad 似乎产生了一个似乎不是简单空格的分隔符。我需要帮助解析它的输出。如果用户选择所有三个项目，这个 bash 脚本

```
#!/bin/bash
items=`yad --list --separator='' --height=600 --multiple --column="Items" item1 item2 item3`

echo $items

IFS=' ' read -r -a ARRAY <<< $items
for item in "${ARRAY[@]}"; do
        echo "$item"
done 
```

应该输出

```
item1 item2 item3
item1
item2
item3 
```

相反，脚本仅输出：

```
item1 item2 item3
item1 
```

我正在使用[这个技巧](https://stackoverflow.com/questions/918886/split-string-based-on-delimiter-in-bash)将 yad 的输出解析为一个数组。它曾经与 yad 的前身 zenity 一起工作得很好，但它似乎与 yad 一起失败了。

回显`$items`到文本文件并使用 cat 读取此文本文件按预期工作：`IFS=' ' read -r -a ADDR <<< $items`在上面的脚本中替换为

```
echo "$items" > tmpfile
IFS=' ' read -r -a ADDR <<< `cat tmpfile` 
```

产生预期的结果。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T17:36:19.057

我认为你让这变得比必要的更复杂。

这是另一种可行的方法。

```
items=`yad --list --separator='' --height=600 --multiple --column="Items" item1 item2 item3`

echo $items

for item in $items; do
        echo "$item"
done 
```

这是最简单和最直接的。它拆分 IFS 中的元素（默认情况下，这包括空格、制表符和换行符）

无需创建数组、使用`read`或此处的字符串。

# entity-framework - 第二次插入时的实体框架重复记录

> ID：11376642
> 
> 赞同：0
> 
> 时间：2012-07-07T16:15:23.893
> 
> 标签：entity-framework, duplicates

我正在为食谱/膳食计划构建一个应用程序，但我遇到了一个我似乎无法弄清楚的问题。

我有一个计量单位表，我将使用的单位保存在其中，我只想要这里的唯一单位（用于杂货清单计算等）

但是如果我在食谱上使用表中的一个单位，第一次没问题，没有插入度量单位，但第二次我得到一个“重复”。

我怀疑它与 entitykey 有关，因为主键是 sql server (2008 r2) 上的标识列

出于某种原因，它可以更改某些对象（课程，请参阅代码）上的对象状态并且不会生成重复项，但这不适用于测量单位

我的插入方法如下所示：

```
public recipe Create(recipe recipe)
    {

        using (RecipeDataContext ctx = new RecipeDataContext())
        {
            foreach (recipe_ingredient rec_ing in recipe.recipe_ingredient)
            {
                if (rec_ing.ingredient.ingredient_id == 0)
                {
                    ingredient ing = (from _ing in ctx.ingredients
                                      where _ing.name == rec_ing.ingredient.name
                                      select _ing).FirstOrDefault();

                    if (ing != null)
                    {
                        rec_ing.ingredient_id = ing.ingredient_id;
                        rec_ing.ingredient = null;   
                    }
                }

                if (rec_ing.unit_of_measure.unit_of_measure_id == 0)
                {
                    unit_of_measure _uom = (from dbUom in ctx.unit_of_measure
                                            where dbUom.unit == rec_ing.unit_of_measure.unit
                                            select dbUom).FirstOrDefault();
                    if (_uom != null)
                    {
                        rec_ing.unit_of_measure_id = _uom.unit_of_measure_id;
                        rec_ing.unit_of_measure = null;
                    }
                }

                ctx.Recipes.AddObject(recipe);
//for some reason it works to change object state of this, and not generate a duplicate
                ctx.ObjectStateManager.ChangeObjectState(recipe.courses[0], EntityState.Unchanged);  
            }

            ctx.SaveChanges();
        }

        return recipe;
    } 
```

我的数据模型如下所示：

[http://i.imgur.com/NMwZv.png](http://i.imgur.com/NMwZv.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T09:11:50.917

我想当您尝试保存已分配 UoM 的配方时会发生这种情况（FK！= 0）？在这种情况下，您必须更改其状态`Unchanged`以避免重复。`AddObject`标记对象图中的所有实体（不仅`Recipe`），`Added`因此如果图还包含现有实体，则必须将它们设置回`Unchanged`以避免意外插入。

# javascript - 部分 Javascript（Ruby on Rails）

> ID：11376643
> 
> 赞同：2
> 
> 时间：2012-07-07T16:15:30.010
> 
> 标签：javascript, ruby-on-rails, ajax

例如，我为该帖子提供了许多评论。

```
<%= render post.comments %> 
```

在部分评论中，我有javascript，它会重复很多次我有多少评论

**_comment.html.erb**

```
<div id="content_<%= comment.id %>"><%= comment.content %></div>
<scr​ipt>$("content_<%= comment.id %>").click(function() { a​lert(​'content of comment <%= comment.id %>'​) });</sc​ript> 
```

避免在源代码中重复 javascript 的最佳方法是什么？我试图创建 *_comment.js.erb* 文件并将 javascript 放在那里，但我不明白如何使它工作。

谁能解释一下如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T16:23:51.590

您可以将实现更改为在 app/assets/javascripts 下拥有一个带有脚本的 js 文件。更改脚本的选择器以匹配评论的类而不是唯一的 ID。如果需要，请使用 javascript 来读取元素的内容，而不是像现在这样在服务器上执行此操作。

# svn - svn eclipse 将项目移动到另一个文件夹

> ID：11376647
> 
> 赞同：1
> 
> 时间：2012-07-07T16:15:47.553
> 
> 标签：svn

我已将我的一个项目上传到一个文件夹中，但现在我想将其传输到主干文件夹。我怎样才能做到这一点？或者我可以删除项目并创建一个新项目吗？

# c# - Outlook Addin FormRegion 关闭事件或类似事件？

> ID：11376648
> 
> 赞同：1
> 
> 时间：2012-07-07T16:16:02.863
> 
> 标签：c#, outlook, vsto, outlook-addin

我正在尝试在检查员关闭之前更新一些 Outlook 约会项目数据（具体的主题和位置）。

从[这个线程](http://social.msdn.microsoft.com/Forums/en-US/outlookdev/thread/22181ee8-dcf2-43ee-b6ed-d5a1c669201e/)我发现关闭事件序列是：

1.  检查基础项目的状态以查看它是否需要保存
2.  如果是的话，写
3.  然后调用表单区域关闭处理程序

我需要在第 1 步执行之前运行一些代码。

我所知道的围绕该区域的唯一事件是 OutlookFormRegion.Close，但这已经为时已晚，第 1 步和第 2 步已经过去了。

formregion（带有 C# 用户控件的 AC# 表单）本身也不会在此修改检查之前触发事件。

本质上，我正在寻找关闭**事件**而不是关闭**事件**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T04:42:14.690

如果您只想更新约会数据，那么为什么不更新主题等并从关闭处理程序对对象执行 Save() 呢？这意味着它可以写两次，但至少你把你的信息放在正确的地方。

# sql - 从多个列中检索非 NULL 列

> ID：11376649
> 
> 赞同：-10
> 
> 时间：2012-07-07T16:16:09.333
> 
> 标签：sql, sql-server-2008

我必须从下表在 sql server 中编写一个查询：

```
**Column-1** **Column-2** **Column-**3
  x              Null         Null
 Null             y           Null
 Null            Null          z 
```

我的输出将是：

```
**Columnname**
    x
    y
    z 
```

请尽快将结果发送给我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T16:25:04.763

```
SELECT Columnname = COALESCE([Column-1],[Column-2],[Column-3]) FROM dbo.tablename; 
```

# java - 爱普生热敏票据打印机的Java控制

> ID：11376650
> 
> 赞同：1
> 
> 时间：2012-07-07T16:16:16.057
> 
> 标签：java, epson

早在 2007 年，我就用 Java 编写了一些控制 Epson TM90 收据打印机的软件。我的软件使用了 JavaPOS API。

看来这个JavaPOS软件已经不存在了！

在 2012 年，从 Wava 编写的应用程序通过 USB 从 Win7 驱动 Epson Receipt 打印机的正确方法是什么？

TIA BfW

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:47:51.587

呃[JavaPOS 主页](http://www.javapos.com/index.html)好像是活跃的？

# linux - 我们可以在使用原始套接字时选择特定的接口吗？

> ID：11376652
> 
> 赞同：2
> 
> 时间：2012-07-07T16:16:31.460
> 
> 标签：linux, raw-sockets

我正在 linux 中构建一个仅通过某个接口发送数据的应用程序。我可以使用原始套接字来做到这一点，也许使用设置套接字选项功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:38:48.750

当你绑定一个套接字时，你是通过 IP 来完成的。但希望您的接口有不同的 IP 地址。如果是这样，您可以先调用[getifaddrs](http://linux.die.net/man/3/getifaddrs)并找到您想要的接口的地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-10T19:02:19.523

我们可以使用以下方法将已经打开的套接字绑定到给定的接口。

1.  在套接字上使用绑定。
2.  使用 setsockopt。使用选项 SO_BINDTODEVICE。

# php - phpThumb 写入测试失败

> ID：11376653
> 
> 赞同：0
> 
> 时间：2012-07-07T16:16:37.263
> 
> 标签：php, caching, permissions, phpthumb

我正在尝试使用 IIS7 在 Godaddy Windows 共享主机中部署我的 PHP 网站。我的网站使用 phpThumb 库来生成拇指图像。

但是没有显示拇指图像，我得到了：

> 用法：/########/filename.jpg 详细阅读用法注释

当我检查`phpThumb.demo.check.php`时，缓存写入测试出现红色错误，如下所示

```
D: / Hosting / ########### / cache / 6 / 67 / 67c / 67c4 / phpThumb_cache_########__raw67c44e91c46b79493d95da579a7fef28_par52b4fbd9e2256843fcdbe9d1f35f2875.jpeg
directory does NOT exist (before EnsureDirectoryExists())
directory does NOT exist (after EnsureDirectoryExists())
write test FAILED 
```

目录`D: / Hosting / ########### /`缓存已经存在，并且已经从 godaddy 文件管理器更改为可写。

但我注意到“缓存目录”和“临时目录”检查结果都是“存在/可读/可写”。

尽管缓存目录存在/可读/可写，为什么 phpThumb 给出“写测试失败”？当我检查缓存文件夹时，`CacheStart.txt`会创建文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-15T17:33:15.427

对于 Godaddy Windows 共享托管，我做了以下更改并为我工作。可能还有其他更好的解决方案，但我只是尝试快速更改为我工作。

at phpthumb.functions.php //它将修复在缓存目录中创建子文件夹，可选没有它缓存将不会生成

```
static function EnsureDirectoryExists($dirname) {
    $dirname = str_replace('/', DIRECTORY_SEPARATOR, $dirname);  //added for godaddy
    $directory_elements = explode(DIRECTORY_SEPARATOR, $dirname);
    $startoffset = 5;  //added for godaddy

    /*  comment for godaddy
    $startoffset = (!$directory_elements[0] ? 2 : 1);  // unix with leading "/" then start with 2nd element; Windows with leading "c:\" then start with 1st element
    $open_basedirs = preg_split('#[;:]#', ini_get('open_basedir'));
    foreach ($open_basedirs as $key => $open_basedir) {
        if (preg_match('#^'.preg_quote($open_basedir).'#', $dirname) && (strlen($dirname) > strlen($open_basedir))) {
            $startoffset = count(explode(DIRECTORY_SEPARATOR, $open_basedir));
            break;
        }
    }
    */
    $i = $startoffset;
    ..... 
```

at phpthumb.class.php //它是必需的，没有它 sourcefilepath 出错了

```
function ResolveFilenameToAbsolute($filename) {
    ....
    if ($this->iswindows) {
        //$AbsoluteFilename = preg_replace('#^'.preg_quote(realpath($this->config_document_root)).'#i', realpath($this->config_document_root), $AbsoluteFilename);
        $AbsoluteFilename = str_replace(DIRECTORY_SEPARATOR, '/', $AbsoluteFilename);
    ..... 
```

# c# - C#中的委托和动作有什么区别

> ID：11376657
> 
> 赞同：32
> 
> 时间：2012-07-07T16:17:26.780
> 
> 标签：c#

如果我搜索，我肯定会得到展示什么是代表和动作的示例。我已经阅读了提供代表示例的基本书籍。

但我想知道的是它们在现实世界中的用途。请不要给出 Hello World 示例或 Animal 类，它们太基础了

例如：

1.  它们之间有什么区别
2.  何时使用委托或操作
3.  何时不使用委托或操作
4.  当他们可以过度杀戮时

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-07T16:31:04.257

`Action` *是*一个`Delegate`。它是这样定义的：

```
public delegate void Action(); 
```

您可以像创建抽象方法一样创建自己的委托类型；你写了签名但没有实现。然后，您可以通过引用方法来创建这些委托的实例。

```
class Program
{
    public static void FooMethod()
    {
        Console.WriteLine("Called foo");
    }

    static void Main()
    {
        Action foo = FooMethod; // foo now references FooMethod()
        foo(); // outputs "Called foo"
    }
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-07-07T16:19:57.387

当您定义委托时，您实际上是在定义方法的签名（返回类型和参数）。

一个 Action 是一个已经定义好的委托（void return 并且没有 args）。

```
public delegate void Action() 
```

你可以去定义，自己看看。或者在文档中。 [http://msdn.microsoft.com/en-us/library/system.action.aspx](http://msdn.microsoft.com/en-us/library/system.action.aspx)

当我要查找的方法的签名与支持的签名匹配时，我几乎总是使用现有的通用委托（其中一个操作是其中一个）。使用泛型委托的一个好处是它们是众所周知的。大多数开发人员都知道 Action 是无效/无效的。如果我要定义自己的 Action 版本，每个人都需要查找它的签名，而我只是复制了一些已经存在的东西。

例如... 操作碰巧有点少见，因为 void/void 方法的目的只能用于突变。Func 很常见（也是通用委托）。在整个框架中都有使用它的示例，尤其是在 linq 中。以 .where 为例。[http://msdn.microsoft.com/en-us/library/bb534803.aspx](http://msdn.microsoft.com/en-us/library/bb534803.aspx)。这是一个 Func，这意味着它将您正在处理的集合类型的元素作为参数并返回一个布尔值。在具有 Func 返回 true 的 where 语句的上下文中，意味着将其包含在结果中，反之亦然。

```
public static IEnumerable<TSource> Where<TSource>(
    this IEnumerable<TSource> source,
    Func<TSource, bool> predicate
) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-07-07T18:20:06.133

由于 Kenneth & Siege 已经指出了代码和 MSDN，我将尝试填写真实世界的示例。

考虑一个定义“移动”的委托。

现实世界中的“Action”代表将是“Run”或“Walk”。您不关心您的移动速度、您采取的路线或报告移动所需的时间。

例如，非 Action 委托可以定义您运行的速度并返回完成它所花费的时间。

```
public delegate void MoveAction();
public delegate int MoveDelegate(int speed); 
```

扩展围攻的例子..

```
class Program
{
    public static void Run()
    {
        Console.WriteLine("Running");
    }

    public static int RunAtSpeed(int speed)
    {
         // logic to run @ speed and return time
         Console.WriteLine("Running @ {0}", speed); 
         return 10;
    }

    public static int WalkAtSpeed(int speed)
    {
         // logic to walk @ speed and return time
         Console.WriteLine("Walking @ {0}", speed); 
         return 20;
    }

    static void Main()
    {
        Action foo = Run; 
        foo(); 

        MoveDelegate run = RunAtSpeed;
        int result1 = run(5);

        MoveDelegate walk = WalkAtSpeed;
        int result2 = walk(1);
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-03-19T04:32:19.553

**什么是Action：** 很简单Action,Func<>,Predicate 都是delegate 类型。

**为什么需要Action：** Action封装了不同数量的参数和不同类型的返回类型，在很多情况下足以满足应用开发的需要。这些在 System 命名空间中提供。您可以自由创建自己的委托。

请注意，有 17 种不同类型的 Action 和 Func，每种都有零到 16 个参数化的通用参数。

**动作总是没有返回值。Func 有一个参数化的泛型返回类型。**

**恕我直言，**不需要将谓词委托定义为它真正等同于接受 arg 并返回 bool 的 Func。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-11-02T04:35:11.177

“Console.WriteLine”用户已在较早的答案中提供了反复请求的真实世界示例代码。

至于为什么提供它，据我了解，Action 是一种省去继续定义自己的新代表的方法。由于它是特定签名类型的预定义委托，因此您可以省去为每个预期目的创建不同委托的麻烦。您只需使用预定义的 Action 委托来指向您的方法并运行它们。Func 代表也是如此。

更多的是一种便利，而不是真正的新功能。帮助您的代码简短易懂，减少麻烦。

至于你的点问题，

1.  **它们之间有什么区别**

没有不同。Action 是一个预定义的委托，旨在为您省去重复定义新委托的麻烦。

2.  **何时使用委托或操作**

通常，委托（和操作）用于需要具有表驱动功能的地方。即，可能是对应于某些特定要求的方法字典。请注意，在这里使用 Action 可以轻松更改最终调用的方法，以动态指向其他方法（可能基于用户选择的某些设置？）

* * *

```
class Program
{
    static void Main()
    {
     Dictionary<string, Action> dict = new Dictionary<string, Action>();
     dict["loadFile"] = new Action(LoadFile);
     dict["saveFile"] = new Action(SaveFile);

     dict["loadFile"].Invoke();
     dict["saveFile"].Invoke();
    }

    static void SaveFile()
    {
     Console.WriteLine("File saved!");
    }

    static void LoadFile()
    {
     Console.WriteLine("Loading File...");
    }
} 
```

* * *

另一个典型的用法是回调方法。例如，您使用 BubbleSort 类，将比较器方法作为委托传递给该类，BubbleSort 类将使用该委托来允许您的代码定义比较逻辑，同时处理其他所有事情。这也可以从您启动的线程中使用，并且当需要将一些中间操作通知给您的代码时，该线程会调用委托。

您可以参考这篇 SO 帖子以查看上述的一个很好的示例。 [https://stackoverflow.com/a/3794229/1336068](https://stackoverflow.com/a/3794229/1336068)

3.  **何时不使用委托或操作**

我能想到在情况需要时不使用它们的唯一原因是，如果您的代表将在短时间内被呼叫数百万次。这涉及到一点点开销，如果这导致应用程序滞后，那么您可能必须找到一种更好的方法来解决这个问题，使用直接引用您的函数，而不是通过委托。

4.  **当他们可以过度杀戮时**

当您在没有任何实际需要的情况下免费使用它们时。否则，在大多数情况下，它们可以成为解决上述情况的一种优雅方式。

另外，请阅读此 SO 答案以查看普通方法和委托之间的区别，以便更好地了解在何处使用委托/操作/func [https://stackoverflow.com/a/17380580/1336068](https://stackoverflow.com/a/17380580/1336068)

# haskell - 根据一个参数的类型动态调用函数（以前是“Zope in Haskell”）

> ID：11376659
> 
> 赞同：1
> 
> 时间：2012-07-07T16:17:28.553
> 
> 标签：haskell

我正在学习 Haskell，我发现它非常优雅和强大。但是我仍然无法想象如何使用 OOP 来做看起来如此简单的事情。以 zope3/grok/pyramid 网络平台为例。他们有一个美丽的哲学，基于匹配内容和视图来呈现页面。

在 zope 中，您有一个异端内容类型树。当您请求一个 URL 时，您使用它到`traverse`该树的路径并获取一个`context`对象。路径的最后一部分是“视图名称”。您将`View`根据对象的类型和视图名称获得。`View`是从特定上下文类型`Request`到对象的`Response`函数。

因此，如果您访问 URL [http://example.com/aFolder/aFaq/aQuestion/index.html，zope](http://example.com/aFolder/aFaq/aQuestion/index.html)将从树的根部开始。它将搜索一个名为 的节点`aFolder`，然后在该对象内搜索另一个名为的节点，并`aFaq`在其中搜索一个名为的节点`aQuestion`。因此该`traverse`函数可以返回任何类型的对象。

这里没有问题。因为我只遍历树，所以我可以在 Haskell 中创建一个新的包装类型或一个名为的类`Traversable`，所以我会有一个`Tree Traversable`和一个函数`traverse :: Tree Traversable -> [string] -> Traversable`。

但随之而来的一个问题`index.html`是视图的名称。在一个简化的 exposition[*] 中，Zope 查找对（上下文类型，视图名称）并返回一个函数，粗略地说，类型为`{type of the context} -> Request -> Response`。我可以编写一个函数`render :: Traversable -> String -> Response`来检查可遍历的类型，但是，只要有人添加新的内容类型或新视图，就必须更新该函数。视图函数（或子函数）需要知道上下文的类型才能使用其数据。

**那么，经验丰富的哈斯克尔是如何解决这类问题的呢？有一段时间我在 GADT 中思考过，但我不确定这是否会有所帮助，或者是否有更简单的替代方案。**

谢谢！

编辑：伪代码澄清

```
def traverse(node, path):
    # returns the context and the view name
    itemname = path[0]
    if hasattr(node, itemname):
       # The next element in the path is a subnode of the node, let's visit it
       return traverse(node[itemname], path[1:])
    else:
       # We can't go down the tree anymore, we found our context and view name
       viewname = itemname
       return node, viewname

def render(tree, request):
    path = somehow_get_path_from_request(request)
    context, viewname = traverse(tree, path)
    # We get the view from a registry which is a map/dictionary
    view = registry[(context, viewname)]
    # here comes the problem:
    #   view is an object that knows exactly the type of context
    #   A view for a Question object can use its 'question' and 'answer' fields
    #   A View for a Folder can use its 'items' fields, a view for Image can use
    #   its 'img' field.
    #
    return view.render(context, request) 
```

这是我不知道如何在haskell中做的事情。在 haskell f 我有一棵树，它必须是同质对象。所以我必须定义一个包装类型 Traversable。但是如果有人想添加一个新类型，他应该修改我的代码。或者我可以创建一个 Haskell 类 Traversable。通过这种方式，可以将未来类型添加到树中。但是我怎么能从 (context, viewname) 映射到一个未知上下文的函数呢？

[*] 事实要复杂一些。在zope中，一个对象或其类可以在运行时任意标记`interfaces`（python没有接口的概念，这完全是zope的构造）。这些接口形成一棵树。您将视图与一对（接口、名称）相关联。当您请求 (context, name) 的视图时，它会返回与最具体的界面关联的视图。这个想法是您可以更改视图，更改接口注册表而不修改代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T09:33:06.553

如果我理解这一点，您的问题归结为“我想将未知类型的东西塞入容器中，然后在运行时我想将它们拉出来并根据它们的类型运行不同的功能”。

有几种可能的方法来解决这个问题，具有不同程度的复杂性。

首先，Haskell 有*类型擦除*。当你编译一个程序时，在编译器检查所​​有类型都OK后，它*会删除*它们。因此，在运行时不可能判断任何东西的类型。这只有效，因为在编译时不可能不知道某物的类型。这是说“Haskell 是静态类型的”的冗长方式。

刚刚说过，“带有一些扩展的 Haskell”可以做到这一点。但是，我怀疑您的问题可能有一个更简单的解决方案......

好的，所以你想存储不同类型的东西。但是，一旦您存储了这些东西，您实际上想对它*做什么呢？*如果你只是想对数据执行一些函数（取决于它的类型），那么为什么*不只存储函数本身呢？*

想想看。与其内部包含许多不同类型的容器，不如简单地包含许多具有相同类型的函数。你获取你想要的函数，然后运行它。完毕。

那是什么？您需要能够对数据运行*多个*不同的功能吗？好吧，在这种情况下，请尝试存储一个包含您需要的所有功能的数据结构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T18:46:00.660

所以，我认为具体化的 Typeclass 可能会有所帮助。我还是不太清楚你想要什么。

```
{-# LANGUAGE ExistentialQuantification #-}

data Showable = forall a. (Show a) => Showable a

instance Show Showable where
  show (Showable x) = show x

exampleList = [Showable 42, Showable "have a nice day"] 
```

在您的情况下，您需要创建一个 Context 类型类，然后在其上创建一个数据类型，称之为 Contextable （可怕的名字，但我当时想不出更好的东西，抱歉）。
然后，您可以将 Data.Map 从 (Contextable, ViewName) 存储到 Contextable -> Request -> Response。

现在，如果您有一个 SpecificContext，它的关联视图中有您需要的一些信息，但其他上下文都没有，您可以执行类似的操作

```
class Context a where
    maybeSpecificContext :: a -> MaybeSpecificContext
    ...

instance Context SpecificContext where
    maybeSpecificContext ctx = Just ctx
    ...

instance Context OtherContext where
    maybeSpecificContext _   = Nothing
    ... 
```

但我认为这看起来有点难看。也许您为上下文的属性执行此操作，因此如果事情重叠，工作量就会减少。但它会起作用的。

# java - 我可以在客户端使用 .cc proto 文件，在服务器端使用 .java proto 文件吗

> ID：11376660
> 
> 赞同：-1
> 
> 时间：2012-07-07T16:17:47.157
> 
> 标签：java, c++

我是 protobuf 的新手

我已经搜索并了解了一些关于 protobuf 的东西，我知道使用 protobuf 包我们能够为 proto 文件生成 c++、java 和 python 中的类，甚至我还学到了一些关于 RPC 实现的第三方库的知识

现在我的疑问是，假设如果我想实现一个客户端和服务器程序，在客户端我将使用一些 proto 文件，我将为该 proto 文件生成 c++ 类，在服务器端我希望使用相同的 proto文件，我将为该原始文件生成 java 类

可以这样使用吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:21:44.093

是的，这是 Protocol Buffers 的主要用途之一。将 .proto 文件编译为 C++ 和 Java。您必须使用两种语言都支持的某种传输方式。但是在 C++ 中序列化的协议缓冲区将在 Java 中很好地反序列化。

# c# - 无法将 .csproj 转换为 Visual Studio 2010

> ID：11376661
> 
> 赞同：2
> 
> 时间：2012-07-07T16:17:49.863
> 
> 标签：c#, visual-studio-2010, visual-studio

有一个包含 3 个 .csproj 文件的开源项目 ( [Keepass )。](http://keepass.info/download.html)当我打开主解决方案时，它会询问我有关转换的问题，并且它会毫无问题地完成整个过程。除了，“KeepassLibSD”不会转换。

“此安装不支持项目类型。”
如何确定转换项目需要哪种安装？

**所说的.csproj**：[http://pastebin.com/y3enieZf](http://pastebin.com/y3enieZf)

我的关于对话框显示以下包（和信息，没有 kb 修复）：

```
Microsoft Visual Studio 2010
Version 10.0.40219.1 SP1Rel
Microsoft .NET Framework
Version 4.5.50501 SP1Rel

Installed Version: Ultimate

Microsoft Office Developer Tools   01019-532-2002102-70520
Microsoft Office Developer Tools

Microsoft Visual Basic 2010   01019-532-2002102-70520
Microsoft Visual Basic 2010

Microsoft Visual C# 2010   01019-532-2002102-70520
Microsoft Visual C# 2010

Microsoft Visual C++ 2010   01019-532-2002102-70520
Microsoft Visual C++ 2010

Microsoft Visual F# 2010   01019-532-2002102-70520
Microsoft Visual F# 2010

Microsoft Visual Studio 2010 Architecture and Modeling Tools   01019-532-2002102-70520
Microsoft Visual Studio 2010 Architecture and Modeling Tools

UML® and Unified Modeling Language™ are trademarks or registered trademarks of the Object Management Group, Inc. in the United States and other countries.

Microsoft Visual Studio 2010 Code Analysis Spell Checker   01019-532-2002102-70520
Microsoft Visual Studio 2010 Code Analysis Spell Checker

Portions of International CorrectSpell™ spelling correction system © 1993 by Lernout & Hauspie Speech Products N.V. All rights reserved.

The American Heritage® Dictionary of the English Language, Third Edition Copyright © 1992 Houghton Mifflin Company. Electronic version licensed from Lernout & Hauspie Speech Products N.V. All rights reserved.

Microsoft Visual Studio 2010 Team Explorer   01019-532-2002102-70520
Microsoft Visual Studio 2010 Team Explorer

Microsoft Visual Web Developer 2010   01019-532-2002102-70520
Microsoft Visual Web Developer 2010

Crystal Reports Templates for Microsoft Visual Studio 2010   
Crystal Reports Templates for Microsoft Visual Studio 2010

Microsoft Visual Studio 2010 SharePoint Developer Tools   10.0.30319
Microsoft Visual Studio 2010 SharePoint Developer Tools 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:28:41.793

互联网搜索返回此[页面](http://sourceforge.net/projects/keepass/forums/forum/329221/topic/3950018)。

> Visual Studio 的 Express 版本不支持智能设备的项目。

它有帮助吗？:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T17:07:23.240

```
 <PlatformFamilyName>PocketPC</PlatformFamilyName> 
```

这是项目的问题部分。PocketPC 是 PDA 的规范，PDA 是引导 Windows Mobile Classic 的手持设备。仍然支持它的最后一个 Visual Studio 版本是 VS2008 Professional。从 VS2010 中删除了对 Windows Mobile 项目的所有支持。

一家名为 Apple 的公司对此负有主要责任，您可能听说过；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-28T19:16:58.657

[根据 KeePass 论坛](https://sourceforge.net/p/keepass/discussion/329221/thread/bb0e01f1)，您可以放心地忽略项目加载失败。其他项目不需要它来构建。

# android - 用于 CRUD 的 SQLite 或 JSON？

> ID：11376664
> 
> 赞同：0
> 
> 时间：2012-07-07T16:17:58.793
> 
> 标签：android, json

需要建议 po：SQLite 还是 JSON？

我正在创建一个简单的测验游戏，我尝试过使用 JSON 解析。并因为 SQLite 的功能而被遗忘了。JSON 可以在其上添加新问题、更新、删除和搜索。

我将所有问题数据写入 JSON 文件，解析每个问题，并将它们全部添加到 ArrayList 中，然后处理 ArrayList of Questions 中的每个问题。

但是你认为最好的使用方法是什么？SQLite 还是 JSON？提前谢谢宝。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T16:43:17.330

我在开发我的 Android 游戏[Taboost](https://play.google.com/store/apps/details?id=it.muvapp.taboost)时遇到了同样的问题。

一开始，我将所有卡片存储在 xml 文件中（可能是 json 文件）。当卡片开始超过 200 时，xml 文件的加载和解析开始变慢，我切换到 SQLite。实现 SQLite 有点困难，但从 SQLite 加载 500 多个单词后发现比使用 xml/json 解析文件要快。

因此，如果您有几个问题，您可以同时使用 xml 或 json 或 SQLite，但 SQlite 将需要更多时间来设置。当您开始有很多问题时，使用 SQLite 可能会更有效。

如果你喜欢 JSON 并且你有成千上万的字符串，你甚至可以使用[couchdb 移植到 Android](https://github.com/daleharvey/Android-MobileFuton)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:21:51.333

如果您没有庞大的关系模型结构，请坚持使用 JSON 或仅实现可序列化或 Parcelable。如果你这样做，请考虑 sqlite

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T16:20:56.373

首先，您在这里将苹果与橙子进行比较。JSON 是一种数据格式，其中 SQLite 是数据库。如果您需要持久化在应用程序使用过程中会发生变化的数据，那么 SQLite 将是正确的选择。如果您需要存储不会更改的数据（或者可能仅在应用程序更新时），将其存储在文件中（可能是 JSON）是有意义的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T16:28:48.197

好吧，除了这两种方法都可以让您解决问题之外，如果您正在开发一个没有“Web 服务”交互的本地应用程序，那么使用 SQLite 为您提供了一种优雅的简单方法来实现 CRUD。

JSON 是一种对对象进行轻度编码的方法，目的是通过网络传输数据。如果您的响应位于您要定位的 Android 设备之外的 Web/应用程序服务器中，那么这绝对是您的最佳选择。对于本地使用，您需要创建所有 CRUD 处理，这是您已经使用 Android SQLlite 帮助程序开箱即用的东西。

第三个不错的选择是使用 ORMlite，我认为它更适合您的需求：

[http://ormlite.com/sqlite_java_android_orm.shtml](http://ormlite.com/sqlite_java_android_orm.shtml)

但同样，由你决定使用。问候。

# javascript - 对象没有方法 getColumnType

> ID：11376665
> 
> 赞同：2
> 
> 时间：2012-07-07T16:18:21.673
> 
> 标签：javascript, playframework, google-visualization

在我的 play 应用程序中，我将一些 JSON 输出发送到我的视图，以显示谷歌饼图。渲染 js 时出现问题

```
Object {cols: [{id: 'title', label: 'Title' , type: 'string'},{id: 'unitPrice', label: 'Unit Price', type: 'int'}],rows: [ has no method 'getColumnType'× 
```

这条消息是我尝试使用 Google Chart API 绘制饼图所得到的全部信息。这甚至意味着什么？“没有方法'getColumnType'”

任何洞察力都会受到极大的赞赏。我的代码，到目前为止：

```
<!DOCTYPE html>

<html>
<head>
<title>PayView</title>
   <head>    
        <script type="text/javascript">var pieChartData;</script>
        <script type="text/javascript">var loads = 0;</script>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>  
        <script src="@routes.Assets.at("javascripts/jquery-1.7.1.min.js")" type="text/javascript"></script>
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
        <script type="text/javascript">
            google.load("visualization", "1", {packages:["corechart"]});      
            google.setOnLoadCallback(function() {
                ++loads;
                if (loads == 2)
                drawVisualization();
            });

            function drawVisualization() {
                $('.log').html('pieChartData: ' + pieChartData);
                new google.visualization.PieChart(document.getElementById('visualization')).
                draw(pieChartData, {title:"Purchases"});
            }               

            $(document).ready(function() {
                $(function() {
                    pieChartData = new google.visualization.DataTable();
                    pieChartData.addColumn('string', 'Title');
                    pieChartData.addColumn('number', 'Unit Price');

                    var getJSon2 = $.ajax({
                        url: '@routes.Application.getJson()',
                        processData:false,
                        type: 'GET',
                        beforeSend:function(jqXHR, settings){                   
                            jqXHR.setRequestHeader("Content-Type", "application/json");
                        },
                        success: function(data, textStatus, jqXHR){                         
                            ++loads;
                            if (loads == 2)
                                drawVisualization();
                            process_items(data);   
                        },
                        error: function(jqXHR, textStatus, errorThrown){
                        },
                        complete: function(jqXHR,textStatus){                   
                        }   
                    );

                    var process_items = function(data){                     
                        pieChartData.addRows(data.length);
                        $.each(data, function(index, item) {
                            $("#purchases").append("<li>" + item.name + "</li>");
                            pieChartData.setCell(index, 0, item.title);
                            pieChartData.setCell(index, 1, item.unitPrice); 
                        });
                    });
                });         
            };  
        });     
        </script>       
    </head>
    <body>
        <div class="log"></div>
        <div id="purchases"></div>
        <div id="visualization" style="width: 500px; height: 300px;"></div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T11:18:55.563

你也可以给函数一个参数

```
function drawChart(draw)
{
    if(draw > 0)
    {
      var data=....;
      var options = ....;
      var chart = ....;
      chart.draw(data,options)
    }
} 
```

你在你的ajax中调用这个函数，给出一个值`drawChart(1)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:31:10.770

您正在尝试使用在调用完成之前从 ajax 调用结果构建的“googleData”字符串。

您将不得不安装一些等待谷歌库加载完成以及您的 ajax 调用的东西。这可能看起来像这样：

```
 var loads = 0;
        google.load("visualization", "1", {packages:["corechart"]});      
        google.setOnLoadCallback(function() {
          ++loads;
          if (loads == 2)
            drawVisualization();
        });

    // then in your "ready" handler:

            success: function(data, textStatus, jqXHR){
                process_items(data);
                ++loads:
                if (loads == 2)
                  drawVisualization();
            }, 
```

当 ajax 调用完成和 google 事情完成时，那个（不优雅的）设置会增加一个计数器。两个处理程序都检查它们是否是最后一个完成的，如果是，则调用“draw”函数。

# algorithm - 部分子树匹配算法

> ID：11376672
> 
> 赞同：4
> 
> 时间：2012-07-07T16:19:15.007
> 
> 标签：algorithm, matching, subtree

我搜索了论坛，但我无法弄清楚其他类似的问题是否必然与这个问题有关。

我要做的是将子树与对象树匹配。

我知道有基于后缀树或自动机的模式匹配算法，但我不确定它们是否适用于此。

![例子](../Images/5258c3713e699416a2a8d1f7c0d55894.png)

我试图将图片中红色节点给出的子树与更大的树进行匹配，无论树的整体结构或红色节点是否有子节点。

直接模式匹配不起作用的原因是没有可用的节点排序（后/预排序、广度）。

所以我正在考虑编写一个递归算法，它从子树的根开始并尝试匹配节点，然后是它们的子节点。

我想知道是否存在任何这样的（有效的算法）。抱歉，如果这已经被问到了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T17:10:36.110

以下是一些可能对您有所帮助的参考资料：

Aho 的[高效树模式匹配：代码生成的辅助工具](http://www.nada.kth.se/~mosavian/masterthesis/other/p334-aho.pdf)

斯坦福的[树模式匹配程序](http://nlp.stanford.edu/~manning/courses/ling289/TreePatternMatchingPrograms.pdf)

来自 IMECS 2011：[使用简洁数据结构的树模式匹配算法](http://www.iaeng.org/publication/IMECS2011/IMECS2011_pp206-211.pdf)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T16:35:00.177

看来我正在寻找的是一种解决“树包含问题”的算法。我找到了一些有用的文件：

[寻找最近共同祖先的快速算法](http://sydney.edu.au/engineering/it/~comp2160/files/lca/harel_tarjan_nca.pdf)

[树包含问题：在最优空间和更快](http://www2.imm.dtu.dk/~ilg/treeInclusion.pdf)

[树同构及相关问题](http://www.lsi.upc.edu/~valiente/graph-00-01-c.pdf)

我将上一篇论文中的一个算法翻译成 C#（返回 a 和 b 的第一级子树之间最大匹配中的对数）。

```
public static int Match(Node a, Node b, NodeSimilarityComparer comp) {
  if (!comp.Equals(a, b))
    return 0;
  int m = a.SubtreeCount;
  int n = b.SubtreeCount;
  var matrix = new int[m + 1, n + 1];

  for (int i = 0; i <= m; ++i)
    matrix[i, 0] = 0;

  for (int j = 0; j <= n; ++j)
    matrix[0, j] = 0;

  for (int i = 1; i <= m; ++i)
    for (int j = 1; j <= n; ++j) {
      var ai = a.GetSubtree(i - 1);
      var bj = b.GetSubtree(j - 1);
      var match = Match(ai, bj, comp);
      matrix[i, j] = Math.Max(Math.Max(matrix[i, j - 1], matrix[i - 1, j]), matrix[i - 1, j - 1] + match);
    }
  return matrix[m, n] + 1;
} 
```

希望这对其他人也有帮助。

# ios - iOS：多个 AU 与一个渲染回调中的所有内容

> ID：11376677
> 
> 赞同：1
> 
> 时间：2012-07-07T16:20:21.857
> 
> 标签：ios, optimization, core-audio, audiounit, remoteio

我正在为我的（iPhone 4+）应用程序开发自定义采样器和音频引擎，特别是添加录音和发送效果功能。我一直在尝试决定是走在一个大的 RemoteIO 渲染回调中处理所有内容还是将其分解为单独的 AU 节点的路线。

无论如何，可能知道一个更复杂的 AUGraph 与多个 RemoteIO 和一个混合器 AU 相加，与在单个、调整良好的渲染回调中完成所有操作相比，是否会产生显着的开销？是否有任何其他原因想要采用一种方式或另一种方式（例如可能是 AU 边界剪辑/截断音频）？

性能是个大问题，我可能只使用单个渲染回调，但我不想错过不断增长的可用 fx AU 列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T20:03:07.877

一般来说，我更喜欢一个渲染回调，但如果您计划重新排序效果链，使用 AUGraph 可能更容易。

此外，您应该查看[Novocaine](https://github.com/alexbw/novocaine) ，而不是直接处理 AudioUnits ，它会为您完成所有令人讨厌的 AU 接口，并为您提供一个干净的基于块的回调。

# php - Sphinx 属性的实时更新

> ID：11376682
> 
> 赞同：0
> 
> 时间：2012-07-07T16:20:46.017
> 
> 标签：php, mysql, sphinx

我正在尝试在网站上实现 sphinx 搜索服务器。该网站将用于内部跟踪。

数据库定义了一个状态，我已将其配置为 sphinx 中的一个属性。我需要实时更新，没有任何延迟。我还想使用磁盘索引，因此可以很容易地对索引进行定期更新，并且我避免使用 SphinxQL。

我发现这可以通过 sphinx API 的 UpdateAttribute 方法实现。我想知道的是是否可以从 MySQL 触发器调用 UpdateAttribute()？我想我可以有一个 php 脚本，它在获取请求中获取所需的输入，然后更新索引。请提出可能的实施方法，因为我还没有找到任何可行的方法。

如果您有任何其他方式来实现搜索以便我实时更新属性，请告诉我。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T08:41:14.563

UpdateAttribute 是正确的方法。

IMO 可以使用 MySQL 用户定义函数在 MySQL 触发器中调用此方法。但是，我认为这不是一个好的解决方案，因为这样的功能会非常复杂，并且会大大降低 mysql 更新速度。

一个更好的解决方案已发布到 sphinxforums。它使用 gearman 和为其存在的当前 UDF。（从技术上讲，为 sphinx C API 编写 UDF 更好，但这更容易）见[这里](http://sphinxsearch.com/forum/view.html?id=9823)。

# php - 浮点字符串格式

> ID：11376685
> 
> 赞同：1
> 
> 时间：2012-07-07T16:20:58.923
> 
> 标签：php, string, floating-point, printf

`%01.2f`

我知道“.2”是精度，但第一部分是什么意思 - `%01`？

我尝试将其更改为 05、2 等，结果字符串看起来相同..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:38:39.640

打印列很有用。例如，如果要打印一列 50 个字符的数字，其中包含 4 个浮动数字，并希望在数字的开头填充 0，请使用：

```
%050.4f 
```

如果要在列的开头填充空格而不是 0，请改用：

```
% 50.4f 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:26:27.190

那就是有多少间距。它从 C 中的 printf 回来。查找 printf 将为您提供更多信息。但是，在这里解释很简单。

我猜它不做任何事情的原因是因为 HTML 不允许超过 1 个连续的空间，所以它不会显示，但是如果你在命令行中运行你的 PHP（这是可能的）那么你会看到出现间距。

例如在 C 中（php 基本上是一种用于网络的 C 语言）你可以说

```
printf("%20s %20s!", "Hello", "World"); 
```

那会打印出这样的东西

```
 Hello                World! 
```

在普通的 html 中，它应该显示如下（而不是在“代码块”中）：Hello World！

^^ 顺便说一句，代码中的间距相同。

# ruby-on-rails - 使用 has_many 和 belongs_to 关系创建的未定义方法

> ID：11376688
> 
> 赞同：0
> 
> 时间：2012-07-07T16:21:16.113
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, relationship, belongs-to

当我尝试访问由关系 has_many - belogs_to 创建的方法时，我得到一个未定义的方法错误。这是代码（简化）：

local.rb（模型）：

```
class Local < ActiveRecord::Base
   has_many :foods, dependent: :destroy, :foreign_key => 'local_id'
end 
```

食物.rb：

```
class Food < ActiveRecord::Base
   attr_accessible :descrizione, :nome, :prezzo, :voto
   belongs_to :local, :foreign_key => 'local_id'
end 
```

/locals/show.html.erb 视图调用 foodsController 上的 create 操作：

```
...

<%= form_for :food, :url => {:controller  => :foods, :action => :create} do |f| %>
...
<% end %> 
```

food_controller.rb

```
class FoodsController < ApplicationController
    def create
        @food = @local.foods.build(params[:food])
    end
end 
```

在创建操作的foods_controller 中提出了问题：“未定义的方法'foods''。为什么？关系应该启用local.foods 方法？（@local 在locals_controller.rb 中定义，@local = Local.find(params[ :id]) ，并且 local_id 属性在 schema.rb 和最后一个数据库迁移中定义，只是为了清楚）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:54:25.270

`accepts_nested_attributes_for` [在这里](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html)查看。我认为这是做你想做的事情的标准方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:54:40.180

由于`@local`在不同的控制器中定义，您将无法从 FoodController 访问它。

# objective-c - NSTimer 不会失效

> ID：11376697
> 
> 赞同：1
> 
> 时间：2012-07-07T16:22:12.517
> 
> 标签：objective-c, cocoa-touch, nstimer

这里的代码不多，但这个问题让我很恼火！

。H：

```
@interface processController : UIViewController {
         NSTimer *timer;
}
@property (nonatomic, retain) NSTimer *timer; 
```

米：

```
- (void)viewDidLoad {
    [super viewDidLoad];
    timer = [NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector (main) userInfo:nil repeats:YES];
}
- (void)main {
    NSLog(@"testing");
}
- (void)viewDidUnload {
    [self.timer invalidate];
    self.timer = nil;
} 
```

奇怪的是，当我触发这段代码时：

```
ViewController *main = [[ViewController alloc] initWithNibName:nil bundle:nil];
    [self presentModalViewController:main animated:YES]; 
```

并切换视图，计时器不断触发！我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T16:25:43.860

`viewDidUnload`当视图从屏幕上移除时不会调用，但**只有**在应用程序收到内存警告时才会调用。UIViewController 被释放时也不会调用它。来自 Apple 的文档：

> 当内存不足的情况发生并且不需要当前视图控制器的视图时，系统可能会选择从内存中删除这些视图。此方法在视图控制器的视图被释放后调用，这是您执行任何最终清理的机会。如果您的视图控制器存储了对视图或其子视图的单独引用，您应该使用此方法来释放这些引用。您还可以使用此方法删除对您为支持视图而创建但在视图消失后不再需要的任何对象的引用。您不应使用此方法发布用户数据或任何其他无法轻松重新创建的信息。

您很可能打算使用`viewWillDisappear`

```
- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
    [self.timer invalidate];
    self.timer = nil;
} 
```

您可能希望在 viewWillAppear 中启动计时器：因为一旦访问控制器的视图属性，就会调用 viewDidLoad。显示视图时不一定。

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    timer = [NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector(main) userInfo:nil repeats:YES];
} 
```

[我建议阅读UIViewController 文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)中关于 viewDidLoad 和 viewDidUnload 以及 viewWillAppear 和 viewWillDisappear 的讨论。

# asp.net - 如何在 HtmlEditorExtender 中设置图像上传位置并在引用 3 个 dll 并编辑 web.config 后启用清理停止调试？

> ID：11376700
> 
> 赞同：3
> 
> 时间：2012-07-07T16:22:24.773
> 
> 标签：asp.net, ajax

今天我将 HtmlEditorExtender 添加到我的 asp.net Web 应用程序中，一切正常，但我在这方面面临两个主要问题： 1\. 如何设置 HtmlEditorExtender 将上传图像的图像上传位置。2\. 我无法为这个 HtmlEditorExtender 启用 AntiXSS Sanitizer Provider 我遵循了这个页面 [asp.net ajax 页面上的方法](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/HTMLEditorExtender/HTMLEditorExtender.aspx)

但是当我把这段代码放在 Web.config

```
<sanitizer defaultProvider="AntiXssSanitizerProvider">
    <providers>
        <add name="AntiXssSanitizerProvider" 
        type="AjaxControlToolkit.Sanitizer.
          AntiXssSanitizerProvider"></add>
    </providers>
</sanitizer> 
```

这强调了`<sanitizer>`标记并在调试时要求我提供一个 Sanitizer.cs 文件并告诉我无法加载类型“AjaxControlToolkit.Sanitizer.AntiXssSanitizerProvider”。（C:\Users\saurav\Documents\Visual Studio 2010\Projects\sauravtopnet\sauravtopnet\web.config 第 56 行） 'c:\Users\Stephen\Documents\Repos\Superexpert\AjaxControlToolkit\Server\AjaxControlToolkit\HtmlEditorExtender 的定位源\HtmlEditorExtender.cs'。校验和：MD5 {79 93 7c d3 c7 ff b7 88 f af 76 3c 18 24 66 19} 文件 'c:\Users\Stephen\Documents\Repos\Superexpert\AjaxControlToolkit\Server\AjaxControlToolkit\HtmlEditorExtender\HtmlEditorExtender.cs'不存在。在脚本文档中查找 'c:\Users\Stephen\Documents\Repos\Superexpert\AjaxControlToolkit\Server\AjaxControlToolkit\HtmlEditorExtender\HtmlEditorExtender.cs'... 查看“c:\Users\Stephen\Documents\Repos\Superexpert\AjaxControlToolkit\Server\AjaxControlToolkit\HtmlEditorExtender\HtmlEditorExtender.cs”的项目。在项目中找不到该文件。查看目录 'D:\Program Files\Microsoft Visual Studio 10.0\VC\crt\src\'... 查看目录 'D:\Program Files\Microsoft Visual Studio 10.0\VC\atlmfc\src\mfc\'。 .. 查看目录 'D:\Program Files\Microsoft Visual Studio 10.0\VC\atlmfc\src\atl\'... 查看目录 'D:\Program Files\Microsoft Visual Studio 10.0\VC\atlmfc\include\ '...活动解决方案的调试源文件设置表明调试器不会要求用户查找文件：c:\Users\Stephen\Documents\Repos\Superexpert\AjaxControlToolkit\Server\AjaxControlToolkit\HtmlEditorExtender\HtmlEditorExtender。 CS。

我应该告诉你，在 c:\Users\Stephen\Documents\Repos\Superexpert\AjaxControlToolkit\Server\AjaxControlToolkit\HtmlEditorExtender\HtmlEditorExtender.cs 中，Stephen 不是我系统上的任何用户，而不是调试器正在寻找此路径的原因。

我将这两行添加到页面后面的代码中

```
using AjaxControlToolkit.Sanitizer;
using Microsoft.Security.Application; 
```

这是我的ajax代码

```
<ajaxToolkit:HtmlEditorExtender
    ID="hee" EnableSanitization="true"
    TargetControlID="txtComments"
    Runat="server" >
    <Toolbar> 
            <ajaxToolkit:Undo />
            <ajaxToolkit:Redo />
            <ajaxToolkit:Bold />
            <ajaxToolkit:Italic />
            <ajaxToolkit:Underline />
            <ajaxToolkit:StrikeThrough />
            <ajaxToolkit:Subscript />
            <ajaxToolkit:Superscript />
            <ajaxToolkit:JustifyLeft />
            <ajaxToolkit:JustifyCenter />
            <ajaxToolkit:JustifyRight />
            <ajaxToolkit:JustifyFull />
            <ajaxToolkit:InsertOrderedList />
            <ajaxToolkit:InsertUnorderedList />
            <ajaxToolkit:CreateLink />
            <ajaxToolkit:UnLink />
            <ajaxToolkit:RemoveFormat />
            <ajaxToolkit:SelectAll />
            <ajaxToolkit:UnSelect />
            <ajaxToolkit:Delete />
            <ajaxToolkit:Cut />
            <ajaxToolkit:Copy />
            <ajaxToolkit:Paste />
            <ajaxToolkit:BackgroundColorSelector />
            <ajaxToolkit:ForeColorSelector />
            <ajaxToolkit:FontNameSelector />
            <ajaxToolkit:FontSizeSelector />
            <ajaxToolkit:Indent />
            <ajaxToolkit:Outdent />
            <ajaxToolkit:InsertHorizontalRule />
            <ajaxToolkit:HorizontalSeparator />
            <ajaxToolkit:InsertImage />
        </Toolbar>
    </ajaxToolkit:HtmlEditorExtender> 
```

这是我的参考

```
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="asp" %> 
```

我已经下载并添加了所有三个 .dll。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T07:13:16.953

你做对的第一部分：

```
<configsections>
    <sectionGroup name="system.web">
    <section name="sanitizer" requirePermission="false" type="AjaxControlToolkit.Sanitizer.ProviderSanitizerSection,  AjaxControlToolkit" />
    </sectionGroup>
</configsections> 
```

在你的`system.web`：

```
<system.web>
    <sanitizer defaultProvider="AntiXssSanitizerProvider">
        <providers>
          <add name="AntiXssSanitizerProvider" type="AjaxControlToolkit.Sanitizer.HtmlAgilityPackSanitizerProvider" />
        </providers>
      </sanitizer>
</system.web> 
```

的HTML：

```
 <asp:Textbox ID="replyBody" Height="400px" Width="892px" runat="server" TextMode ="MultiLine"  />
 <ajaxToolkit:HtmlEditorExtender ID="replyBody_HtmlEditorExtender" runat="server" Enabled="True" OnImageUploadComplete="saveFile"  ClientIDMode="AutoID" EnableSanitization="true"  TargetControlID="replyBody">
 <Toolbar>
     <ajaxToolkit:Bold />
     <ajaxToolkit:Italic />
     <ajaxToolkit:Underline />
     <ajaxToolkit:StrikeThrough />
     <ajaxToolkit:Subscript />
     <ajaxToolkit:Superscript />
     <ajaxToolkit:JustifyLeft />
     <ajaxToolkit:JustifyCenter />
     <ajaxToolkit:JustifyRight />
     <ajaxToolkit:JustifyFull />
     <ajaxToolkit:InsertOrderedList />
     <ajaxToolkit:InsertUnorderedList />
     <ajaxToolkit:CreateLink />
     <ajaxToolkit:UnLink />
     <ajaxToolkit:RemoveFormat />
     <ajaxToolkit:Cut />
     <ajaxToolkit:Copy />
     <ajaxToolkit:Paste />
     <ajaxToolkit:BackgroundColorSelector />
     <ajaxToolkit:ForeColorSelector />
     <ajaxToolkit:FontNameSelector />
     <ajaxToolkit:FontSizeSelector />
     <ajaxToolkit:Indent />
     <ajaxToolkit:Outdent />
     <ajaxToolkit:InsertHorizontalRule />
     <ajaxToolkit:HorizontalSeparator />
     <ajaxToolkit:InsertImage />
 </Toolbar>
 </ajaxToolkit:HtmlEditorExtender> 
```

至于设置图像位置，它在`AjaxControlToolkit.AjaxFileUploadEventArgs`

属性是`e.FileName`检索文件名并`e.postedUrl`告诉控件您将其上传到何处，可以如下所示完成：

```
protected void saveFile(object sender, AjaxControlToolkit.AjaxFileUploadEventArgs e)
{
    string fullPath = "/Images/Upload_test/"+ e.FileName;

    // Save your File
    replyBody_HtmlEditorExtender.AjaxFileUpload.SaveAs(Server.MapPath(fullPath));

    // Tells the HtmlEditorExtender where the file is otherwise it will render as: <img src="" />
    e.PostedUrl = fullPath;
} 
```

这对我来说效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:38:13.570

我面临着完全相同的问题，而且我已经搞砸了好几天。

至少我现在取得了第一次成功。我正在关注本指南： [http ://www.asp.net/web-forms/tutorials/ajax-control-toolkit/getting-started/using-ajax-control-toolkit-controls-and-control-extenders-cs](http://www.asp.net/web-forms/tutorials/ajax-control-toolkit/getting-started/using-ajax-control-toolkit-controls-and-control-extenders-cs)

我正在写下对我来说最重要的步骤：

*   创建 Web 窗体项目
*   使用 NuGet 或手动安装都没有关系（我通过 NuGet 安装它并将工具箱条目链接到我项目的包文件夹中的 dll）
*   我没有在我的项目的 web.config 中修复任何东西（尽管我需要看看消毒的东西作为接下来的步骤之一）
*   我使用 ASP 脚本管理器，而不是 ajax 控件工具包之一

所以这是我的片段，它实际上对我有用（至少现在，看到任何不依赖斯蒂芬斯的电脑的东西现在对我来说都是成功的^^）

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="webforms._Default" %>
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit.HTMLEditor" TagPrefix="cc1" %>
<%@ Register TagPrefix="asp" Namespace="AjaxControlToolkit" Assembly="AjaxControlToolkit"%>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
  <title>hey ho</title>
</head>
<body>
  <form id="form1" runat="server">
    <div>
      hello world!
    </div>
    <div>
      second div
      <br/>
      <asp:ScriptManager ID="ScriptManager1" runat="server">
      </asp:ScriptManager>
      <cc1:Editor ID="Editor1" runat="server" />
    </div>
  </form>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T16:59:07.663

配置 Ajax HtmlEditorExtender 是一项非常艰巨的任务，但此[链接：http:](http://stephenwalther.com/archive/2012/05/01/ajax-control-toolkit-may-2012-release.aspx) //stephenwalther.com/archive/2012/05/01/ajax-control-toolkit-may-2012-release.aspx将指导您如何设置图像上传路径和其他相关设置

下一个问题是如何设置 sanitizer 来保护您免受 XSS 攻击。实际上推荐的消毒剂供应商不能正常工作。看看我为此做了什么

1.  从 Microsoft CodePlex 或通过 NuGet 下载 AntiXSS.4.2.1
2.  现在解压缩 zip 文件，您将获得两个 .dll AntiXSSLibrary.dll 和 HtmlSanitizationLibrary.dll 将您的项目引用添加到这两个 .dll
3.  现在添加`using Microsoft.Security.Application;`到页面后面的代码。
4.  现在使用下面的代码来处理您想要通过它在 htmleditor 中获取并显示您的输入的任何按钮的单击事件。

这里 txteditor 是与您的 htmleditor 链接的 asp:textbox 的 id。任何文本框的输入始终由 .net 安全框架编码，因此首先解码输入 html 文本，然后`<br>`用我自己的单词替换标签，然后我将输入转发到将删除任何 XSS 攻击代码的消毒剂，但不幸的是，它也删除了 html 代码，`<br>, <img src=""/> or <a href=""></a>`这就是为什么我在`<br>`这里替换了标签，现在再次解码经过清理的 html，并用相应的标签替换您的文字。现在你可以在任何地方显示你的 html，就像我在 div1 中显示的那样。我认为这些信息。可以帮助您进一步的步骤。

```
String x = HttpUtility.HtmlDecode(txteditor.Text).Replace("<br>", "rrrbbbbrbrbrbrbr"); 
String y = Sanitizer.GetSafeHtmlFragment(x); 
div1.InnerHtml = HttpUtility.HtmlDecode(y).Replace("rrrbbbbrbrbrbrbr", "<br>"); 
txteditor.Text = HttpUtility.HtmlDecode(y).Replace("rrrbbbbrbrbrbrbr", "<br>"); 
```

将默认 sanitizer 设置为 false，如下所示：

```
 <ajaxToolkit:HtmlEditorExtender ID="ajaxeditor" OnImageUploadComplete="ajaxFileUpload_OnUploadComplete" TargetControlID="txteditor" DisplaySourceTab="false" EnableSanitization="false" Runat="server" > 
```

无需在 web.config 中配置任何内容，也无需添加 www.asp.net 上推荐的 3 个 .dll

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T13:48:26.507

在我的情况下，将此设置为 false 对我有帮助，`EnableSanitization="false"`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-21T15:47:32.897

正如上面的欺负者建议的那样，您将需要脚本管理器。但是，您将需要 ajax 工具包脚本管理器。我发现的另一件事是您需要在 web.config 中放置正确的设置才能正确上传文件。这两个设置都是必需的“安全”和“处理程序”。

```
 <system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
    <handlers>
      <add name="AjaxFileUploadHandler" verb="*" path="AjaxFileUploadHandler.axd"type="AjaxControlToolkit.AjaxFileUploadHandler, AjaxControlToolkit" />
    </handlers>
    <security>
      <requestFiltering>
        <requestLimits maxAllowedContentLength="4294967295" />
      </requestFiltering>
    </security>
  </system.webServer> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-03T07:57:54.100

在 htmlediterextender 代码中上传图片

```
 protected void htmleditorextender_ImageUploadComplete(object sender, AjaxFileUploadEventArgs e)
       {
           string fullpath = Server.MapPath("~/images/") + e.FileName;

           editor_extender.AjaxFileUpload.SaveAs(fullpath);

           e.PostedUrl = Page.ResolveUrl("~/images/" + e.FileName);
       } 
```

# titanium - 钛预加载图像

> ID：11376705
> 
> 赞同：1
> 
> 时间：2012-07-07T16:23:19.727
> 
> 标签：titanium, titanium-mobile

我想知道 Titanium 如何处理图像。如果我要在图像视图中加载图像，然后将图像视图中的图像更改为本地图像，然后将图像更改回以前的图像，图像视图是否需要再次下载以前的图像？

不确定 Titanium 如何处理下载的图像，但我认为它不会缓存它们。

我在想我可以创建一些屏幕外图像并将其他一些图像视图设置为他们的图像 url，但这会工作吗？或者图像视图会下载图像吗？

只是想弄清楚图像视图如何在钛中工作，以及确保我可以预加载/重用图像的最佳方法。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T00:00:12.707

2015 年 4 月更新：从 Titanium 3.X 开始，根据 Gautier 的回答，图像中有缓存

* * *

默认情况下，ImageView 中没有缓存远程图像。在您的场景中，当您切换回远程图像时，它将再次重新下载。

在我的大多数项目中，我创建了一个缓存图像视图，用于在下载后保存本地图像。这是受到 Dawson Toth 在[https://gist.github.com/938172](https://gist.github.com/938172)上的工作的启发。唯一的问题是，如果图像在本地缓存后在服务器上发生更改，除非文件名更改，否则客户端不会获得更新的图像。代码如下。

```
exports.createCachingImageView = function(params) {
    var image = Ti.UI.createImageView();

    image.doRemote = function(imageURL) {
        image.remoteImage = imageURL;
        var file = Ti.Filesystem.getFile(somedirectory, image.localFileName(imageURL));

        if(!file.exists()) {
             // cached file does not exist, load the image
            image.addEventListener("load", image.saveImageOnLoad);
            image.image = imageURL;
        } else {
            Ti.API.debug(image.localFileName(imageURL) + ' does exist, just setting image');
            image.image = file.nativePath;
        }
    };

    image.saveImageOnLoad = function(e) {
        Ti.API.debug('saving image ' + image.localFileName(image.remoteImage));
        var f = Ti.Filesystem.getFile(somedirectory, image.localFileName(image.remoteImage));
        if(!f.read()) {
            f.write(e.source.toBlob());
        }
        e.source.removeEventListener('load', image.saveImageOnLoad);
    };

    image.localFileName = function(imageURL) {
        hashedSource = Ti.Utils.md5HexDigest(imageURL + '');
        return hashedSource;
    };
    if(params.image) {
        image.doRemote(params.image);
    }

    for(var v in params) {
        if(v != 'image') {
            image[v] = params[v];
        }
    }

    return image;
}; 
```

如果您想在不使用 imageView 的情况下单独下载图像，请使用 Ti.Network.httpClient 获取图像并将其保存到文件系统，如下所示：

```
xhr.onload = function(){    
  var file = Ti.Filesystem.getFile(somedirectory, somefilename );
  file.write(this.responseData);
} 
```

我使用它来提前获取图像，因此当客户使用它们时它们应该立即。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-21T15:44:49.807

挖掘出这个很老的问题，因为我必须做同样的事情。

从 Android 3.1 和 iOS 开始，现在有一个默认缓存：请参阅[http://docs.appcelerator.com/titanium/latest/#!/guide/Image_Best_Practices-section-30082525_ImageBestPractices-Cachingremoteimages](http://docs.appcelerator.com/titanium/latest/#!/guide/Image_Best_Practices-section-30082525_ImageBestPractices-Cachingremoteimages)

> 在 Android 平台上，缓存限制为 25 MB，并且数据会在应用程序的整个生命周期内保留（只要它安装在设备上）。在 iOS 平台上，缓存大小不是预先确定的（无法保证大小），数据会一直保留在那里，直到 iOS 清理目录（需要更多的本地存储）。

该文档页面也有自己的图像手动缓存实现。

```
var Utils = {
  /* modified version of https://gist.github.com/1243697 */
  _getExtension: function(fn) {
    // from http://stackoverflow.com/a/680982/292947
    var re = /(?:\.([^.]+))?$/;
    var tmpext = re.exec(fn)[1];
    return (tmpext) ? tmpext : '';
  },
  RemoteImage: function(a){
    a = a || {};
    var md5;
    var needsToSave = false;
    var savedFile;
    if(a.image){
      md5 = Ti.Utils.md5HexDigest(a.image)+this._getExtension(a.image);
      savedFile = Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory,md5);
      if(savedFile.exists()){
        a.image = savedFile;
      } else {
        needsToSave = true;
      }
    }
    var image = Ti.UI.createImageView(a);
    if(needsToSave === true){
      function saveImage(e){
        image.removeEventListener('load',saveImage);
        savedFile.write(
          Ti.UI.createImageView({image:image.image,width:'auto',height:'auto'}).toImage()
        );
      }
      image.addEventListener('load',saveImage);
    }
    return image;
  }
};
// example usage
var image = Utils.RemoteImage({
  image:'http://farm7.staticflickr.com/6059/6262552465_e53bccbd52_z.jpg',
  defaultImage:'KS_nav_ui.png',
  width:300,
  height:200,
  top:20
});
win2.add(image); 
```

# ruby-on-rails - 更新数据库时运行一些 Rails 代码

> ID：11376714
> 
> 赞同：1
> 
> 时间：2012-07-07T16:23:57.870
> 
> 标签：ruby-on-rails, database

当某个数据库表被更新（不一定由我的程序）时，运行某些 Rails 代码的最干净的方法是什么？事件挂钩不必用 Ruby 编写，但重用我的一些 Rails 代码会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:26:46.837

那将是一个 Active Record[回调](http://guides.rubyonrails.org/active_record_validations_callbacks.html#callbacks-overview)。

> 回调是在对象生命周期的特定时刻被调用的方法。使用回调，可以编写在创建、保存、更新、删除、验证或从数据库加载 Active Record 对象时运行的代码。

# php - 如何在无需用户批准的情况下将照片发布到 Facebook？

> ID：11376716
> 
> 赞同：2
> 
> 时间：2012-07-07T16:24:06.340
> 
> 标签：php, facebook, facebook-graph-api

我正在尝试制作一个页面，我的手机应用程序可以点击该页面将图像发布到 Facebook。看起来我的图像刚刚消失在虚空中，但我终于弄清楚发生了什么（感谢 phwd！）

图像正在正确上传，问题是图像必须先获得批准才能显示在相册中。这不会那么糟糕，除非相册不包含*任何*已批准的图像，当您单击照片时它不会显示在您的相册列表中（感谢第 22 条，FB！）；这意味着除了获得指向它们或相册的直接链接之外，没有其他方法可以访问图像来批准它们。

假设如果您拥有正确的权限，则可以发布图像并立即显示它们，而不需要用户批准，如答案[here](https://stackoverflow.com/questions/9496595/the-picture-cant-upload-directly-to-album)中所述。

该应用程序启用了沙盒模式，我正在使用具有以下权限的测试用户：`read_stream`、`user_photos`、`manage_pages`、`photo_upload`和`publish_stream`。

我的理解是，`publish_stream`如果照片尚不存在，该权限允许我为照片创建一个新相册，但仅使用该权限上传的图像必须得到用户的批准。该`user_photos`许可显然应该让我绕过用户批准，但由于某种原因似乎没有发生。有没有人有什么建议？

代码：

```
<?php

// facebook variables
require_once("fbsdk/facebook.php");
$fbconfig = array();
$fbconfig['appId'] = '...';
$fbconfig['secret'] = '...';
$fbconfig['fileUpload'] = true;

// set up FB connection
$facebook = new Facebook($fbconfig);
$facebook->setAccessToken($_POST['access']);

// some database stuff
$image = 'image name goes here';

// verify access token
$user = $facebook->getUser();
if (!$user)
    die(json_encode(array('result' => '0',
        'message' => 'Invalid FB access token.')));

// see if target album exists
try {
    $album = $facebook->api(array(
        'query' => "SELECT object_id FROM album WHERE owner=me()' 
            . ' AND name='The App With No Name' AND can_upload=1",
        'method' => "fql.query"));

    // if it exists, grab its ID
    if (isset($album[0]['object_id']))
        $album_id = $album[0]['object_id'];
    else {
        // otherwise, create it
        $create_album = $facebook->api('/me/albums', 'post', array(
            'message' => 'My photos from The App With No Name',
            'name' => 'The App With No Name'));
        $album_id = $create_album['id'];
    }
} catch (FacebookApiException $e) {
    error_log($e->getType());
    error_log($e->getMessage());
    die(json_encode(array('result' => '0',
        'message' => 'FB call (query/create albums) failed: '
            . $e->getType() . ' | ' . $e->getMessage())));
}

// try to post the photo
try {
    $fbresult = $facebook->api('/' . $album_id . '/photos', 'POST',
        array('source' => '@' . realpath('../images/' . $image . '.jpg'),
            'message' => 'Shared from The App With No Name'));
} catch (FacebookApiException $e) {
    error_log($e->getType());
    error_log($e->getMessage());
    die(json_encode(array('result' => '0',
        'message' => 'FB call (post image) failed: '
            . $e->getType() . ' | ' . $e->getMessage())));
}

// more database stuff

// report success
echo json_encode(array('result' => '1', 'message' => ''));

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T17:32:08.350

关闭沙盒模式显然可以解决这个问题，但我不知道为什么。我的印象是沙盒模式只是让您无法与普通用户互动？

将接受任何正确解释这一点的答案，只需将其放上来，以便人们看到我找到的解决方案。

# ruby-on-rails - Ruby 1.9.2 的 RSpec 中的 require lib 带来“没有要加载的文件”

> ID：11376718
> 
> 赞同：15
> 
> 时间：2012-07-07T16:24:16.120
> 
> 标签：ruby-on-rails, ruby, rspec, require, ruby-1.9

我正在尝试将我的 Rails 项目之一升级到`Ruby 1.9.2`. 一切进展顺利，但一项 RSpec 测试失败了。在这个测试中我`require`是一个 Ruby `lib`：

```
# file spec/models/my_lib_spec.rb
require 'spec_helper'
require 'lib/services/my_lib'

describe "MyLib" do

  it "should do something" do
... 
```

库看起来像这样：

```
# file lib/services/my_lib.rb
class MyLib

  def self.do_something
  ... 
```

在 Ruby 1.8.7 (REE) 中，测试运行良好：

```
$ ruby -v   
ruby 1.8.7 (2011-02-18 patchlevel 334) [i686-darwin11.1.0], MBARI 0x6770, Ruby
Enterprise Edition 2011.03
$ rspec ./spec/models/my_lib_spec.rb
..

Finished in 1.4 seconds
2 examples, 0 failures 
```

在 Ruby 1.9.2 我得到一个错误`no such file to load`：

```
$ ruby -v
ruby 1.9.2p290 (2011-07-09 revision 32553) [x86_64-darwin11.1.0]
$ rspec ./spec/models/my_lib_spec.rb
/Users/tmangner/.rvm/gems/ruby-1.9.2-p290@madgoal/gems/activesupport-
3.2.2/lib/active_support/dependencies.rb:251:in `require': no such file
to load -- lib/services/my_lib (LoadError) 
```

我不知道是什么让 Ruby 1.9 无法找到 lib。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-07T16:39:42.597

ruby 1.9 中的加载路径与 1.8 中的加载路径不同。

您需要将项目的根目录添加到加载路径。

您可以通过像这样运行 rspec 来做到这一点：

```
rspec -I . ./spec/models/tipp_remember_spec.rb 
```

...或通过手动将内容添加到您的加载路径中`spec_helper.rb`（将其放在您的顶部`spec_helper.rb`

```
$:<< File.join(File.dirname(__FILE__), '..') 
```

我认为 rspec 默认情况下也会将您的本地`lib`目录添加到加载路径中，因此您可以改写 require 行，如下所示：

```
require 'services/my_lib' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-26T20:12:18.347

在 RSpec 2.x 中，`lib`目录会自动添加到加载路径（请参阅[RSpec-Core#get_started](http://rubydoc.info/github/rspec/rspec-core/file/README.md#get_started)）。

所以你可以`require 'services/my_lib'`在你的规范文件中使用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-07T17:26:57.450

如果您的规范已定位`spec/models/my_lib_spec.rb`并且您想测试`lib/services/my_lib.rb`，那么只需告诉规范如何访问 lib 文件

```
require 'spec_helper'
require_relative '../../lib/services/my_lib'

describe "MyLib" do

  it "should do something" do 
```

最后一点：由于您包含了 spec_helper，您通常不必提供所有依赖项的路径，因为 Rails 应该为您加载所有这些路径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T16:45:18.217

尝试手动定义路径

`$LOAD_PATH << './lib/services/'`

然后像这样添加库

```
require 'my_lib.rb' 
```

# c++ - 从相同索引的两个不同数组中获取数据

> ID：11376729
> 
> 赞同：1
> 
> 时间：2012-07-07T03:13:01.970
> 
> 标签：c++

我创建了一个这样的数组：

```
string mobs [5] = {"Skeleton", "Dragon", "Imp", "Demon", "Vampire"};
int mobHP[5] = {10, 11, 12, 13, 14, 15}; 
```

我创建了一个随机数生成器来获取我想要的暴民数，但我失败了。假设生成的数字是 4，我将如何将其等同于或等于字符串 mob number 5 和 mob hp number 5？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T03:23:29.853

如果您有一个返回 0 到 4 之间的随机数（数组索引）的函数，那么代码将类似于：

```
// Since we are using raw arrays we need to store the length
int array_length = 5 

// Some function that returns a random number between 
int randomIndex = myRandomNumberFunction(array_length) 

// Now we select from the array using the index we calculated before
std::string selectedMobName = mobs[randomIndex]
int selectMobHP = mobHP[randomIndex] 
```

然而，使用现代 C++ 实践实现这一目标的更好方法是创建一个怪物类并在向量中使用它，如下所示：

```
#include <vector>
#include <string>
#include <iostream>

// Normally we would use a class with accessors here but for the sake
// of brevity and simplicity we'll use a struct
struct Monster {
    Monster(const std::string& in_name, const int in_health) :
        name(in_name), health(in_health) 
    {}

    std::string name;
    int health;
};

// A vector is like an array that can grow larger if you add stuff to it
// Note: Normally we wouldn't use a raw pointer here but I've used it for
// for the sake of brevity. Instead we would either use a smart pointer
// or we would implement the Monster class with a copy or move constructor.
std::vector<Monster*> monsters;
monsters.push_back(new Monster("Dragon", 5));
monsters.push_back(new Monster("Eelie", 3));
... // Arbitrary number of monsters
monsters.push_back(new Monster("Slime", 1));

// Select a random monster from the array
int random_index = myRandomNumberFunction(monsters.size());
Monster* selected_monster = monsters[random_index];

// Print the monster stats
std::cout << "You encounter " << selected_monster->name << " with "
    << selected_monster->health << "hp" << std::endl;

// Clean up the vector since we're using pointers
// If we were using smart pointers this would be unnecessary.
for(std::vector<Monster*>::iterator monster = monsters.begin();
    monster != monsters.end();
    ++monster) {
    delete (*monster);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:49:24.733

对于元素数组，有效索引在to`N`的范围内，其中表示第一个元素并表示最后一个元素。`0``N-1``0``N-1`

由于您在此范围内生成了一个数字，因此它直接映射到数组的元素上。

如果你有 value `ix=4`，它指的是第五个怪物。您可以在 上访问名称`mobs[ix]`和在 上的健康状况`mobHP[ix]`。

# jsoup - Jsoup 返回与网络浏览器不同的 html

> ID：11376731
> 
> 赞同：0
> 
> 时间：2012-07-07T16:26:00.737
> 
> 标签：jsoup

我有一个`url = "http://mp3.zing.vn/tim-kiem/playlist.html?q=Bảo Thy`

> `Document doc = Jsoup.connect(url).get()`

当我`Jsoup`用来获取html时。它不能正常工作。它返回与我使用浏览器时不同的 html。我怎么解决这个问题。

但是，当我使用不带参数的 url (`http://mp3.zing.vn)`时，它可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T15:27:05.930

我已经解决了这个问题。

```
http://mp3.zing.vn/tim-kiem/playlist.html?q=Bảo thy 
```

参数是越南语单词，在这种情况下，本网站使用 URL 编码。因此，我必须将所有参数编码为 UTF-8 编码。

```
keyword = URLEncoder.encode(keyword,"UTF-8"); 
```

和编码后的网址

```
http://mp3.zing.vn/tim-kiem/playlist.html?q=B%E1%BA%A3o%20thy 
```

Jsoup 工作正常。

谢谢大家。关闭主题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:36:58.393

您很可能需要提供 cookie、会话或某种注册方法。

请检查：

[爬取网站内容的建议](https://stackoverflow.com/questions/11294765/advice-with-crawling-web-site-content/11296314#11296314)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T04:36:53.337

我有同样的问题，我通过

```
Document doc = Jsoup.connect("YourURL").userAgent("Mozilla").get(); 
```

# java - 我如何知道我的字符串中存在哪些字符，然后计算它们的出现次数？

> ID：11376737
> 
> 赞同：-2
> 
> 时间：2012-07-07T16:26:55.947
> 
> 标签：java, string

我有这个字符串***string="aaaaaaaaaddsssaaakkaaaaand"***我需要知道其中有哪些字符并计算它们的出现次数，我在**stackOverFlow**中找到了这段代码，但它没有帮助，因为我需要计算字符而不要求用户输入一个。

```
public static int countOccurrences(String haystack, char needle)
{
    int count = 0;
    for (int i=0; i < haystack.length(); i++)
    {
        if (haystack.charAt(i) == needle)
        {
             count++;
        }
    }
    return count;
} 
```

我需要一种方法来知道有 5 个 a 和 4 个 v 等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:30:49.393

这行得通吗？

```
public static Map<Character, Integer> countOccurrences(String haystack)
{
    Map<Character, Integer> count = new HashMap<Character, Integer>();
    for (int i=0; i < haystack.length(); i++)
    {
        char c = haystack.charAt(i);
        Integer charCount = count.get(c);
        if(charCount == null) {
            count.put(c, 1);
        } else {
            count.put(c, charCount + 1);
        }
    }
    return count;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:37:02.077

您需要获取字符串中所有字符的计数吗？如果是这样，这样的类可能会起作用：

```
public class CharCounter {

  private final int[] counts = new int[Character.MAX_VALUE];

  public CharCounter(String input) {
    for (int i = 0; i < input.length(); i++) {
      counts[input.charAt(i)] += 1;
    }
  }

  public int getCount(char c) {
    return counts[c];
  }
} 
```

要使用它，您需要执行以下操作：

```
CharCounter counter = new CharCounter("hello world");
System.count.println("number of 'l' characters: " + counter.getCount('l')); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T16:59:22.137

我不会给你代码答案，但这个不同的想法应该让你开始：

1.  您需要有一个空的字符数组（或 arrayList）和一个空的字符串，当然还有您的“待计数”字符串（干草堆）。
2.  使用排序方法通过大海捞针并按 **字母顺序排序**（去看看这个，它不是真的太难）。
3.  一旦您按字母顺序对其进行了排序，请执行另一个 for 循环，该循环遍历新的按字母顺序排序的字符串，如果位置 i+1 处的字符与之前的字符不同，则将一个新字符**添加到空字符数组中。**现在，在这个循环结束时，该字符数组将在您的原始字符串中包含一个不同字母的小列表！
4.  还有另一个 for 循环......这是最后一个。这一次，它将是一个 for 循环中的一个 for 循环。外部 for 循环将遍历您的新字符数组，内部循环将遍历原始字符串的字符。现在，您可以计算字符串中字符数组中第一个字符出现的次数，然后是第二个、第三个、第四个......等。每次，您可以打印出“5 a's”“6 b's”等.

这应该有效。让我知道！

# php - 在 CodeIgniter (MVC) 中从内容文件设置页面标题

> ID：11376745
> 
> 赞同：2
> 
> 时间：2012-07-07T16:28:25.977
> 
> 标签：php, codeigniter, templates

我的 CodeIgniter 网站的控制器设置如下：

```
$this->load->view('head', $data); // Contains <head> stuff
$this->load->view('header', $data); // Nav and sidebars
$this->load->view($this->uri->segment(1), $data); // Main page content
$this->load->view('footer', $data); // Footer 
```

我的问题是关于在哪里存储`<title>`标签的内容。理想情况下，它将与页面内容（第 3 个加载的视图）一起使用，但是您如何将其放入`<title>`已在第一个视图中加载的标签中？

我读过让 JavaScript 设置标题很糟糕，因为它与搜索引擎机器人不兼容。

我还阅读了一个建议，该建议说有一个包含所有页面的大视图文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-10-07T16:11:43.760

对于更改页面标题，这是更好的方法。在您的配置文件中添加此参数：

```
$config['pageTitle'] = 'Book Store'; 
```

在模板页面中：

```
<title><?=$this->config->config["pageTitle"]?></title> 
```

在您喜欢的任何页面中更改此配置：

```
$this->config->config["pageTitle"] = $detail[0]['Title']; 
```

每次您都可以轻松更改标题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T17:17:03.753

我不太明白为什么要在加载的第三个视图中而不是在编译的 HTML 文档的头部（加载的第一个视图）中添加标签。为什么没有类似的东西：

```
$data['title'] = 'my page title';

$this->load->view('head', $data); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T00:24:25.920

我想了一个办法来解决我的问题，我从[http://joshhighland.com/blog/2008/11/09/how-i-do-layouts-and-views-in-codeigniter/](http://joshhighland.com/blog/2008/11/09/how-i-do-layouts-and-views-in-codeigniter/)得到了这个想法。如果您查看该页面，您会在第一个代码摘录的底部附近看到这样的一行：

```
$layout_data['content_body'] = $this->load->view('home/homePage', $body_data, true); 
```

这会将视图作为字符串加载到该变量中。然后，我将对该字符串运行一个函数来提取我想要的标题（我会将其存储在 HTML 注释中）并将其放入`$layout_data['pageTitle']`. 然后，按照链接上的其余布局方法，我将能够解决我的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T17:11:10.197

从逻辑上讲，您的`<title>`标签应该在`<head>`标签内，并且将它放在您的“头部”视图中是有意义的。因此，您传递给 head 视图的 $data 数组应该包含一个标签元素。从您的脚本中，我了解到您正在为所有 4 个视图传递相同的 $data 数组？不是很好的做法，因为您最终可能会传递在一个视图中使用的元素，但不会在其他四个视图中传递。我建议为每个视图形成一个不同的数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T20:32:37.150

写一个辅助函数怎么样？

**帮手** `helpers/header_helper.php`

```
function set_title($title) {
    $ci &= get_instance();
    $ci->header_title = $title;
}

function get_title() {
    $ci &= get_instance();
    return $ci->header_title;
} 
```

您可能希望将其设置为自动**加载**`config/autoload.php`

然后在您的*视图*中您可以调用该函数`get_title()`，在您的*控制器*中您可以调用`set_title()`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-19T11:42:15.847

我以我的风格解决了这个问题。也许它不是完美的，但它解决了我的最大目的。

我创建了一个名为 getMyPageTitle() 的辅助函数。

在那里我写下了页面标题的逻辑。

逻辑的基本部分是我在配置文件中假设了一个默认标题。

```
 <?php
            function getMyPageTitle(){

                $title = '';
                $ci = &get_instance();

                $default_title = 'My Site';// you can load it from a config file,and that is better option
                // get the view name
                $view = $this->uri->segment(2);
                // check if controller set a page tile
                /* If you want to set a page title for a particular page then always 
                 * named that variable 'pageTitle' as $data['pageTitle'] = 'My page title | For this page'
                 */

                global $pageTitle;

                if($pageTitle){// the controller sets the page title
                    $title = $pageTitle;
                }elseif($view !== ''){//you can include your view name in the page title,,and the view name is not blanks
                    $title = $default_title.' | '. $view;
                }/**
                  * You can write several else if , before or after this or
                  * can change the total logic as you want
                  */
                 else{
                    $title = $default_title;
                }

                return $title;
            }
            ?> 
```

在视图中使用这个

```
<title><?= getMyPageTitle()?></title> 
```

我认为这解决了目的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-04T11:22:41.053

试试这个

-> 在模板中设置 TITLE 标签

```
 <title>
        <?php if (!empty($page_title)) echo $page_title;?>
    </title> 
```

-> 设置 $data['page_title'] = 'title name'

```
public function index()
    {
        $data['page_title'] = 'List'; 
        $this->load->view('head', $data); // Contains <head> stuff
        $this->load->view('header', $data); // Nav and sidebars
        $this->load->view($this->uri->segment(1), $data); // Main page content
        $this->load->view('footer', $data); // Footer
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-07T07:55:57.423

在 Codeignitor 控制器中

```
public function index()
{
    $data['title'] = 'Website &mdash; Welcome To Website';
    $this->load->view('header', $data);
    $this->load->view('index');
    $this->load->view('footer');
}

public function about()
{
    $data['title'] = 'Coachify &mdash; About Us';
    $this->load->view('header', $data);
    $this->load->view('about');
    $this->load->view('footer');
} 
```

在`view/header.php`

```
<title><?= $title; ?></title> 
```

# ruby-on-rails - 如何检查 Ruby 数组中是否存在具有特定属性的对象

> ID：11376746
> 
> 赞同：27
> 
> 时间：2012-07-07T16:28:30.417
> 
> 标签：ruby-on-rails, ruby

我有一个对象数组*并且该对象看起来像这样`{seat_id, room_id, date_created};`
我想查找在该数组中是否有一个对象其 seat_id 等于特定值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-07-07T16:33:47.563

```
arr.any?{|a| a.seat_id == "value"} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-07-07T16:33:34.193

这里：

```
arr.find_index {|item| item.seat_id == other.seat_id} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T11:46:42.553

```
arr.map{|a| a.seat_id == "value"} 
```

它将返回真假值数组，真值是匹配值。

# java - ehcache 默认设置

> ID：11376754
> 
> 赞同：-1
> 
> 时间：2012-07-07T16:30:03.343
> 
> 标签：java, ehcache

使用 ehcache 时，您（通常）在 XML 文件中配置一组缓存。每个缓存都有大量可以配置的设置，例如

*   姓名
*   永恒
*   溢出到磁盘
*   maxElementsInMemory
*   maxElementsOnDisk

但是，如果您省略其中一些参数会发生什么。它们是否假定了合理的默认值，如果是，它们是否记录在某个地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-02-20T05:00:06.260

不确定您使用的 ehcache 版本，但对于 2.10.3 版本，您可以[在此处找到所有常量值](http://www.ehcache.org/apidocs/2.10.3/constant-values.html)

您可以更改 URL 中的版本并浏览您正在使用的版本。通常在不同版本中保持相同，直到并且除非在实施中发生任何重大变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:45:25.050

[EHCache 文档](http://ehcache.org/files/documentation/ehcache-2.5.x-documentation.pdf)，继续搜索“default”，你会找到它们。

# c - 为什么两个字符指针之间的字符串复制不起作用？

> ID：11376758
> 
> 赞同：1
> 
> 时间：2012-07-07T16:30:23.690
> 
> 标签：c, pointers, malloc

我正在尝试将字符串从一个 char * 复制到另一个，但不知道为什么复制不起作用。

我正在编写一个链表程序——`Linklist`并且涉及到两个`char *`指针。每个指向a`struct Node`如下：

```
struct Node
{
    char * message;
    char * text;
    struct Node * next;
};

typedef struct Node * Linklist; 
```

我写了一个函数，它有两个参数来创建一个新的`LinkNode`：

```
Linklist create(char *message,char * text)
{
    Linklist list =(Linklist)malloc(sizeof(struct Node));
    //the message changes after the sentence but text is right.
    if(list==NULL) printf("error:malloc"); 
    list->message=message;
    list->text=text;
    return list;
} 
```

主要：

char *消息是“helloworld”

char *text 是“测试”

在 malloc 之后，我在 gdb 中查看了消息。消息更改为“/21F/002”，但文本仍为“测试”

我`const`在消息之前添加了，但它不起作用。

谁能告诉发生了什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T16:42:18.280

问题是 c 中的字符串的工作方式不同。以下是复制字符串的方法：

```
Linklist create(char *message,char * text)
{
    Linklist list =(Linklist)malloc(sizeof(struct Node));
    //the message changes after the sentence but text is right.
    if(list==NULL) printf("error:malloc"); 

    list->message = malloc(strlen(message)+1);
    if(list->message==NULL) printf("error:malloc"); 
    strcpy(list->message,message);

    list->text = malloc(strlen(text)+1);
    if(list->text==NULL) printf("error:malloc"); 
    strcpy(list->text,text);

    return list;
} 
```

当然，您必须在这里小心，确保消息和文本不是来自用户，否则您将面临缓冲区溢出漏洞的风险。

您可以使用 strncpy() 来解决该问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T17:11:24.373

you must allocate the storage for your pointers message and text and then copy the string.

# c++ - C++ 中的向量订阅错误

> ID：11376767
> 
> 赞同：0
> 
> 时间：2012-07-07T16:31:23.560
> 
> 标签：c++, visual-c++, vector

我正在用 C++ 构建一个简单的 Tac Tac Toe 游戏，但是当计算机轮到我时出现矢量订阅错误。我找不到这个错误的原因，请告诉我。

这是我的代码：

```
//Tic-Tac-Toe
//Plays the game of Tic-Tac-Toe with a human opponent

#include <iostream>
#include <string>
#include <vector>
#include <algorithm>

using namespace std;

//global constants
const char X = 'X';
const char O = 'O';
const char EMPTY = ' ';
const char TIE = 'T';
const char NO_ONE = 'N';

//function prototypes
void instructions();
char asYesNo(string question);
int askNumber(string question, int high, int low = 0);
char humanPiece();
char opponent(char piece);
void displayBoard(const vector<char>& board);
char winner(const vector<char>& board);
bool isLegal(const vector<char>& board, int move);
int humanMove(const vector<char>& board, char human);
int computerMove(vector<char> board, char computer);
void announceWinner(char winner, char computer, char human);

//main function
int main()
{
    int move;
const int NUM_SQUARES = 9;
vector<char> board(NUM_SQUARES, EMPTY);

instructions();
char human = humanPiece();
char computer = opponent(human);
char turn = X;
displayBoard(board);

while (winner(board) == NO_ONE)
{
    if (turn == human)
    {
        move = humanMove(board, human);
        board[move] = human;
    }
    else
    {
        move = computerMove(board, computer);
        board[move] = computer;
    }
    displayBoard(board);
    turn = opponent(turn);
}

announceWinner(winner(board), computer, human);

return 0;
}

//displays instructions
void instructions()
{
cout << "Welcome to the ultimate man-machine showdown: Tic-Tac-Toe.\n";
cout << "--where human brain is pit against silicon processor\n\n";

cout << "Make your move known by entering a number, 0 - 8\. The number\n";
cout << "corresponds to the desired board position, as illustrated:\n\n";

cout << "   0 | 1 | 2\n";
cout << "   ---------- \n";
cout << "   3 | 4 | 5\n";
cout << "   ---------- \n";
cout << "   6 | 7 | 8\n\n";

cout << "Prepare yourself, human. The battle is about to begin.\n\n";
}

//asks 'yes' or 'no' until it gets an answer either equel to 'y' or 'n'
char askYesNo(string question)
{
char response;
do
{
    cout << question << "(y/n): ";
    cin >> response;
}while (response != 'y' && response != 'n');

return response;
}

//asks a number within a range ans keeps asking untill the number is within that range, next it return that number within the specific range
int askNumber(string question, int high, int low)
{
int number;
do
{
    cout <<question << " (" <<low <<" - " <<high <<"): ";
    cin  >> number;
}while (number > high || number < low);

return number;
}

//asks who will go first, X always starts cuz of tradition
char humanPiece()
{
char go_first = askYesNo("Do you require the first move?");
if (go_first == 'y')
{
    cout <<"\nThen take the first move, you will need it!\n";
    return X;
}
else
{
    cout <<"\nYour bravery will be your undoing...I will go first.\n";
    return O;
}
}

//cuz X always starts we need to decide who will be X
char opponent(char piece)
{
if (piece == X)
{
    return O;
}
else
{
    return X;
}
}

//Displays the board
void displayBoard(const vector<char>& board)
{
cout <<"\n\t" <<board[0] << " | " <<board[1] << " | "<<board[2];
cout <<"\n\t" <<"---------";
cout <<"\n\t" <<board[3] << " | " <<board[4] << " | "<<board[5];
cout <<"\n\t" <<"---------";
cout <<"\n\t" <<board[6] << " | " <<board[7] << " | "<<board[8];
cout <<"\n\t" <<"---------";
cout <<"\n\n";
}

//checks every possible way for someone to win, if there is no winner it checks for a tie
char winner(const vector<char>& board)
{
//all possible winning rows
const int WINNING_ROWS[8][3] = {{0, 1, 2},
                                {3, 4, 5},
                                {6, 7, 8},
                                {0, 3, 6},
                                {1, 4, 7},
                                {2, 5, 8},
                                {0, 4, 8},
                                {2, 4, 6}};
const int TOTAL_ROWS = 8;

//if any winning row has three values that are the same (and not EMPTY),
//then we have a winner
for (int row = 0; row < TOTAL_ROWS; ++row)
{
    if ( (board[WINNING_ROWS[row][0]] != EMPTY) &&
         (board[WINNING_ROWS[row][0]] == board[WINNING_ROWS[row][1]]) &&
         (board[WINNING_ROWS[row][1]] == board[WINNING_ROWS[row][2]]) )
    {
        return board[WINNING_ROWS[row][0]];
    }
}

// since nobody has won, check for a tie (no EMPTY squares left)
if (count (board.begin(), board.end(), EMPTY) == 0)
    return TIE;
// since nobody has won an it isn't a tie, the game  ain't over
return NO_ONE;
}

//checks if the move is legal
inline bool isLegal(int move , const vector<char>& board)
{
return (board[move] == EMPTY);
}

//asks the human to typ his move and checks if it legal
int humanMove(const vector<char>& board, char human)
{
int move = askNumber("Where will you move?", (board.size() -1));
while (!isLegal(move, board))
{
    cout <<"\nThat square is already occupied, foolish human.\n";
    move = askNumber("Where will you move?", (board.size() -1));
}
cout <<"Fine...\n";

return move;
}

//calculate's the computers move
int computerMove(vector<char> board, char computer)
{
//three good steps to win:
//
//1\. if the computer can win, make that winning move
//2\. if the human can win, block that son of a b*tch
//3\. otherwise take the middle, if not possible the corners and so on

unsigned int move = O;
bool found = false;

//if the computer can win, make that winning move
while (!found && move < board.size())
{
    if (isLegal (move, board))
    {
        board[move] = computer;
        found = winner(board) == computer;
        board[move] = EMPTY;
    }

    if (!found)
    {
        ++move;
    }
}

//if the human can win, block that son of a b*tch
if (!found)
{
    move = O;
    char human = opponent(computer);

    while (!found && move < board.size())
    {
        if (isLegal(move, board))
        {
            board[move] = human;
            found = winner(board) == human;
            board[move] = EMPTY;
        }

        if (!found)
        {
            ++move;
        }
    }
}

//otherwise take the middle, if not possible the corners and so on
if (!found)
{
    move = O;
    unsigned int i = O;

    const int BEST_MOVES[] = {4, 0, 2, 6, 8, 1, 3, 5, 7};
    //pick best open square
    while (!found && i < board.size())
    {
        move = BEST_MOVES[i];
        if (isLegal(move, board))
        {
            found = true;
        }

        ++i;
    }
}

cout <<"I shall take a square number " <<move <<endl;
return move;
}

//tells (epicly) who won the game
void  announceWinner(char winner, char computer, char human)
{
if (winner == computer)
{
    cout << winner <<"'s won!\n";
    cout << "As i predicted, human, I am triumphant once more -- proof\n";
    cout << "that computers are superior to humans in all regards.\n";
}

else if (winner == human)
{
    cout << winner <<"'s won!\n";
    cout <<"No, no! It cannot be! Somehow you tricked me, human.\n";
    cout <<"But never again! I, the computer, so swear it!\n";
}

else
{
    cout <<"It's a tie.\n";
    cout <<"You were most lucky, human, and somehow managed to tie me.\n";
    cout <<"Celebrate... for this is the best you will ever archieve.\n";
}
} 
```

抱歉，代码太长了。如果您需要更多信息，请发表评论。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T16:42:52.087

在computerMove你写

```
int move = O; 
```

定义为

```
const char O = 'O'; 
```

所以... move 值 79（字母 O 的 ASCII 值），它大于你的棋盘大小（9）。结果，没有执行 computerMove 的任何循环，因为您始终拥有 move > board.size() 并且您返回 move = 79 - 所以错误，因为您超过了线路板的大小：

```
board[move] = computer; 
```

你想要的大概是

```
int move = 0; 
```

在你的函数 computerMove() 的每一步

# image - 如何使用 MATLAB 自动删除图像中不需要的对象？

> ID：11376770
> 
> 赞同：3
> 
> 时间：2012-07-07T16:32:19.123
> 
> 标签：image, matlab, image-processing

我已经在 MATLAB 中进行了一些图像分割。附图是结果。我的问题是如何从图像中自动删除树部分（底部）？换句话说，我需要将鸟与周围环境隔离开来。我需要编写一个方法来做到这一点，因为我有数百张这样的图像。谢谢

![图片](../Images/dd4e67f5d20165f3300abbd3450a5fd0.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T00:06:33.603

![在此处输入图像描述](../Images/2b092eda4fedcea1e7e0d98b96770dc5.png)

如果此答案对您来说足够好，请下载以下代码： http: [//www.mathworks.com/matlabcentral/fileexchange/32532](http://www.mathworks.com/matlabcentral/fileexchange/32532)并尝试以下命令：

```
I = rgb2gray(imread('BO1NO.jpg'));
th = 0.35 * max(max(I));
[P, J] = regionGrowing(I, [240,390], th, 300, 'true', 'true', 'false');
figure;imshow(J) 
```

由于您可以看到鸟和树木繁茂的树枝之间明显的强度差异，因此尝试区域种植方法比其他任何方法都更合乎逻辑。如果我是你，接下来我会尝试一些彩色图像分割算法。因为我感觉比从 RGB-> Gray 转换时的感觉，我们丢失了一些有用的信息。Bcoz 在图像的灰色版本中，木树枝与鸟的值有些相同（在少数地区）。所以更好地直接处理彩色图像而不转换为灰色。不要急于使用任何模式分类器。它可能会解决您的问题，但如果有更简单/更便宜的解决方案可用，这不是明智之举。有不止一种方法可以严格地在图像处理的范围内解决这个问题，而不会侵入模式识别/机器学习。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T21:18:02.067

试试这个代码，看看它是否是你需要的：

```
I = imread('BO1NO.jpg');

% level = graythresh(I); BW = im2bw(I, level);figure;imshow(BW)

BW = im2bw(rgb2gray(I), 0.25);figure;imshow(BW); 
```

% 删除 BW 图像中最大的连通分量（即鸟），这主要给出了分支。因此，从原始 BW 图像中减去结果图像。不同的图像是鸟。

```
BW1 = BW;
CC = bwconncomp(BW);

numPixels = cellfun(@numel,CC.PixelIdxList);

[biggest,idx] = max(numPixels);

BW(CC.PixelIdxList{idx}) = 0;

figure, imshow(BW);

figure, imshow(BW1);

Ir = imsubtract(BW1,BW);

figure;imshow(Ir) 
```

也可以使用 otsu 的阈值选择方法检查阈值。

# mobile - 如何在listview项目上使用jquery mobile tapholdThreshold

> ID：11376774
> 
> 赞同：0
> 
> 时间：2012-07-07T16:32:49.487
> 
> 标签：mobile, jquery-mobile

我有一个移动应用程序，其中一个页面上有一个列表视图。当用户长按列表视图项时，我想显示一个对话框。我正在寻找示例，但找不到任何带有 tapholdThreshold 示例的示例。如果有人能指出我正确的方向或展示一个快速的例子，将不胜感激。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:25:27.013

我希望这会有所帮助...搜索水龙头事件.. [http://www.elated.com/articles/jquery-mobile-what-c ​​an-it-do-for-you/](http://www.elated.com/articles/jquery-mobile-what-can-it-do-for-you/)

# windows-phone-7 - 在我的 wp 7 应用程序中覆盖强调色

> ID：11376777
> 
> 赞同：1
> 
> 时间：2012-07-07T16:33:26.803
> 
> 标签：windows-phone-7, xaml, themes

我正在为 Windows Phone 7 编写一个应用程序，我想在应用程序中使用基于浅色主题的我自己的颜色。我开始在资源文件中定义画笔并将它们应用到我的应用程序中的控件，但这些在我看来太麻烦了。

有一个更好的方法吗？有没有办法重新定义强调色和背景色，所以无论我的应用程序运行的实际手机上的配色方案是什么，所有控件都将使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T18:04:49.107

抱歉，简短的回答是否定的。有关更多详细信息，请参阅此答案。干杯:)

[覆盖默认主题 WP7 的自定义主题](https://stackoverflow.com/questions/5658951/custom-theme-that-overrides-default-theme-wp7)

# javascript - 成员变为未定义

> ID：11376784
> 
> 赞同：0
> 
> 时间：2012-07-07T16:34:33.853
> 
> 标签：javascript, jquery

我开发了一个具有默认选项的 jQuery 插件：

```
$.fn.incromentor.defaults = {
   max : 65355,
   min : 0
}; 
```

在插件的初始化中，我将用户选项与插件默认选项合并使用`$.extend`

```
function init( $elm, options )
{
    this.$element = $elm;
    this.options = $.extend( {}, $.fn.incromentor.defaults, options ); 
} 
```

所以问题是，如果用户设置`min`or `max`，则`0`该属性变为未定义！
为什么会这样，我怎样才能存储一个简单的 0？

这里有一个 jsFiddle：http: [//jsfiddle.net/KDXa6/2/](http://jsfiddle.net/KDXa6/2/)

**编辑**
在 JSLint 中对代码进行 linting 后，错误消失了，所以我怀疑我的输入中有一个模糊的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:10:00.187

$.fn.incromentor.defaults = {} will overwrite your default options, so something else such as more_text, less_text is turned to undefined. Your Users should pass their options into the constructor such as

```
$('#myel').Incrementor({ max : 65355, min : 0}); 
```

--

$this to $(this) [http://jsfiddle.net/KDXa6/1/](http://jsfiddle.net/KDXa6/1/)

# javascript - WinRT Javascript 应用程序中的 Google API OAuth 2.0

> ID：11376786
> 
> 赞同：1
> 
> 时间：2012-07-07T16:34:37.577
> 
> 标签：javascript, oauth, oauth-2.0, microsoft-metro, windows-runtime

我目前正在努力在 WinRT Metro Javascript 应用程序中实现 Google API OAuth。问题是我无法[提供](https://code.google.com/apis/console/)任何适用于 Metro 应用程序的有效 redirect_uri。已安装应用程序的 urn:ietf:wg:oauth:2.0:oob URL 不起作用，我无法想象在可以处理重定向的 Javascript 应用程序中托管 HttpListener 的方法。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-09T10:53:17.463

```
START URI = https://accounts.google.com/o/oauth2/auth?client_id= Ur Client ID &redirect_uri=urn:ietf:wg:oauth:2.0:oob&response_type=code&scope=https://www.googleapis.com/auth/userinfo.email%20https://www.googleapis.com/auth/userinfo.profile

End URI =https://accounts.google.com/o/oauth2/approval?
Windows.Security.Authentication.Web.WebAuthenticationBroker.authenticateAsync(Windows.Security.Authentication.Web.WebAuthenticationOptions.useTitle, startURI, endURI)
   .then(function (result) {
} 
```

以上是我的代码的一些一瞥，所以我粘贴在这里..你可以试试这个它会对你有所帮助。

# php - 使用匿名函数回调根据值拆分数组

> ID：11376787
> 
> 赞同：2
> 
> 时间：2012-07-07T16:35:05.027
> 
> 标签：php, arrays, callback, split

给定一个形式的数组`$arr`：

```
Array (
    [0] => Array ([id] => id1, ...)
    [1] => Array ([id] => id1, ...)
    [2] => Array ([id] => id2, ...)
    ...
) 
```

使用这个 foreach 循环：

```
$rowsById = [];
foreach ($arr as $row) {
    $rowsById[$row['id']][] = $row;
} 
```

我们可以将其转换为以下形式的数组（以 id 为键）：

```
Array (
    [id1] => Array (
                 [0] => Array ([id] => id1, ...)
                 [1] => Array ([id] => id1, ...)
             )
    [id2] => Array (
                 [0] => Array ([id] => id2, ...)
             )
    ...
) 
```

***我们可以做同样的事情但没有 foreach 循环吗？*** （也就是说，使用一些迭代函数，如 array_walk 和回调）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T16:44:42.600

```
$map = array();
array_walk($arr, function($row, $i) use(&$map) { $map[$row['id']][] = $row; }); 
```

从正式的角度来看，此解决方案是对您问题的肯定回答。

**但是**，如果您想加快代码速度，或者即使您想要更简洁的代码而又不会在其他地方丢失太多，这里有一个惊喜：这个解决方案肯定比您的循环慢（在我的机器上是**3**倍）**。**原因几乎可以肯定是对匿名函数的函数调用，而这在 foreach 解决方案中是不存在的。正如我在 SO的另一个[答案](https://stackoverflow.com/questions/10721618/php-object-arrays-not-linearly-scale-while-global-arrays-do/10806300#10806300)中已经指出的那样，*是函数调用占用了 CPU 时间*。`foreach`

 ***如果我们可以组合简单`array_`的函数以获得相同的结果，这种情况可能会有所不同，但是`['id']`必须以某种方式访问​​的事实、创建中间数组的开销以及没有`array_`函数可用于直接分配给键控箱的事实，使得这是一项不可能完成的任务。

例如，我在意识到它*错误*之前发布的这段代码（因为它替换而不是附加到垃圾箱）

```
$map = array_combine(array_map(function($a) { return $a['id']; }, $arr), $arr); 
```

在我的机器上运行速度比你的慢**2.5**`foreach`倍。

 **所以，最后，你的问题的答案是：“是的，如果我们不关心处理时间”。*****

# jquery - 在 IE8 中淡出/生效期间不需要的透明背景（jQuery 画廊）

> ID：11376790
> 
> 赞同：0
> 
> 时间：2012-07-07T16:35:34.117
> 
> 标签：jquery, css, internet-explorer, fancybox, galleria

我正在为我的 g/f 创建一个新网站，作为她生日的惊喜。但是，如果图像库位于 iframe 中，则在切换图像时出现淡出/淡入效果时，我在 IE 8（可能还有 7）中遇到了一个小的视觉故障。在所有其他浏览器中，背景保持白色以便看起来不错，但在 IE 中，它会淡出为透明，然后再次出现。

重现：在 IE8 中访问[她的新站点](http://hegevatnaland.com/2/)，单击其中一个部分（加载到 fancybox iframe 中），然后观察切换图像时效果会发生什么。现在直接启动[iframe](http://hegevatnaland.com/2/gallery-tegninger.php)，看看一切看起来都很好。

切换期间：

![用于淡出/淡入的 IE 透明背景](../Images/d45e3d628fa7044e68211f215a28d440.png)

我试过在我能想到的任何地方设置 background-color: white 都无济于事。此外，iframe 元素上的 IE-only 属性 allowtransparency 并没有多大作用。我试过 allowtransparency="false" 并完全删除它。

**编辑：**哦，画廊似乎通过更改（内联）样式来淡出/淡入：不透明度从 1 到 0 并再次返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:30:57.983

您很可能需要更新您的 jQuery 版本

目前您有：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/libs/jquery-1.6.2.min.js"><\/script>')</script> 
```

（~~无论如何，第一行都会抛出 404 错误~~）

尝试这个：

```
<script src="http://code.jquery.com/jquery-latest.js"></script> 
```

你会看到 IE 神奇地工作。您实际上不需要重新定位关闭按钮以使其适合框。

# windows - 为什么 64 位 Windows 不能解除用户-内核-用户异常？

> ID：11376795
> 
> 赞同：37
> 
> 时间：2012-07-07T16:36:29.690
> 
> 标签：windows, 64-bit, windows64, structured-exception, windows-appcompat-platform

如果堆栈跨越内核边界，为什么 64 位 Windows 不能在异常期间展开堆栈 - 而 32 位 Windows 可以？

整个问题的背景来自：

[OnLoad 异常消失案例——x64 中的用户态回调异常](http://blog.paulbetts.org/index.php/2010/07/20/the-case-of-the-disappearing-onload-exception-user-mode-callback-exceptions-in-x64/)

## 背景

*在 32 位 Windows 中，如果我在我的用户模式*代码中抛出异常，该异常是从*内核模式*代码回调的，它是从我的*用户模式*代码调用的，例如：

```
User mode                     Kernel Mode
------------------            -------------------
CreateWindow(...);   ------>  NtCreateWindow(...)
                                   |
WindowProc   <---------------------+ 
```

Windows 中的结构化异常处理 (SEH) 可以展开堆栈，通过内核模式展开，回到我的用户代码，在那里我可以处理异常并且我看到有效的堆栈跟踪。

## 但不是在 64 位 Windows 中

64 位版本的 Windows 不能这样做：

> 由于复杂的原因，我们**无法将异常传播回 64 位操作系统**（amd64 和 IA64）。自从 Server 2003 的第一个 64 位版本以来，情况就一直如此。在 x86 上，情况并非如此——异常通过内核边界传播，最终将帧返回

而且由于在这种情况下无法返回可靠的堆栈跟踪，因此必须做出决定：让您看到无意义的异常，或者完全隐藏它：

> 当时的内核架构师决定采取保守的 AppCompat-friendly 方法——隐藏异常，并寄希望于最好的结果。

本文继续讨论所有 64 位 Windows 操作系统的行为方式：

*   Windows XP 64 位
*   Windows Server 2003 64 位
*   Windows Vista 64 位
*   Windows Server 2008 64 位

但从 Windows 7（和 Windows Server 2008）开始，架构师改变了他们的想法——在某种程度上。***仅***对于64 位应用程序（不是 32 位应用程序），它们将（默认情况下）**停止**抑制这些用户-内核-用户异常。因此，默认情况下，打开：

*   Windows 7 64 位
*   视窗服务器 2008

所有 64 位应用程序都会*看到*这些异常，它们以前从未见过它们。

> 在 Windows 7 中，当*原生 x64*应用程序以这种方式崩溃时，[程序兼容性助手](http://msdn.microsoft.com/en-us/library/bb756937.aspx)会收到通知。如果应用程序没有[Windows 7 清单](http://msdn.microsoft.com/en-us/library/dd371711%28VS.85%29.aspx)，我们会显示一个对话框，告诉您 PCA 已应用[应用程序兼容性 shim](http://technet.microsoft.com/en-us/library/dd837644%28WS.10%29.aspx)。这是什么意思？这意味着，下次您运行应用程序时，Windows 将模拟 Server 2003 的行为并使异常消失。请记住，Server 2008 R2 上不存在 PCA，因此此建议不适用。

## 所以这个问题

问题是*为什么*64 位 Windows 无法通过内核转换来展开堆栈，*而 32 位版本的 Windows 可以？*

唯一的提示是：

> 由于复杂的原因，我们**无法将异常传播回 64 位操作系统**（amd64 和 IA64）。

提示是*复杂的*。

我可能不明白这个解释，因为我不是操作系统开发人员 - 但我想知道为什么。

* * *

## 更新：停止抑制 32 位应用程序的修补程序

Microsoft 发布[了一个*修补程序*，使 32 位应用程序](http://support.microsoft.com/kb/976038)也不再抑制异常：

> ## KB976038：在 64 位版本的 Windows 中运行的应用程序引发的异常被忽略
> 
> *   在回调例程中引发的异常在用户模式下运行。
> 
> 在这种情况下，此异常不会导致应用程序崩溃。相反，应用程序进入不一致的状态。然后，应用程序抛出一个不同的异常并崩溃。
> 
> 用户模式回调函数通常是由内核模式组件调用的应用程序定义的函数。用户模式回调函数的示例是 Windows 过程和挂钩过程。Windows 调用这些函数来处理 Windows 消息或处理 Windows 挂钩事件。

然后，此修补程序可让您阻止 Windows 全局吃掉异常：

> ```
> HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options
> DisableUserModeCallbackFilter: DWORD = 1 
> ```

或每个应用程序：

> ```
> HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\Notepad.exe
> DisableUserModeCallbackFilter: DWORD = 1 
> ```

该行为也记录在 XP 和 Server 2003 的 KB973460 中：

*   [在 64 位版本的 Windows Server 2003 或 Windows XP Professional 中运行的 64 位应用程序引发的异常将被静默忽略](http://support.microsoft.com/kb/973460)

* * *

## 一个提示

在研究使用 xperf 在 64 位 Windows 上捕获堆栈跟踪时，我发现了另一个提示：

## [Xperf 中的堆栈行走](http://blogs.msdn.com/b/pigscanfly/archive/2009/08/06/stack-walking-in-xperf.aspx)

> **禁用寻呼执行器**
> 
> 为了在 64 位 Windows 上进行跟踪，您需要设置**DisablePagingExecutive**注册表项。这告诉操作系统不要将内核模式驱动程序和系统代码分页到磁盘，这是使用 xperf 获取 64 位调用堆栈的先决条件，因为 64 位堆栈遍历依赖于可执行映像中的元数据，并且在某些情况下xperf**堆栈遍历代码不允许触摸分页页面**。从提升的命令提示符运行以下命令将为您设置此注册表项。
> 
> ```
>  REG ADD "HKLM\System\CurrentControlSet\Control\Session Manager\Memory Management" -v 
>  DisablePagingExecutive -d 0x1 -t REG_DWORD -f 
> ```
> 
> 设置此注册表项后，您需要重新启动系统才能记录调用堆栈。设置此标志意味着 Windows 内核将更多页面锁定到 RAM 中，因此这可能会消耗大约 10 MB 的额外物理内存。

这给人的印象是，在 64 位 Windows 中（并且仅在 64 位 Windows 中），您不允许遍历内核堆栈，因为磁盘上可能有页面输出。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-03-14T00:13:21.257

我是很久以前编写此修补程序以及博客文章的开发人员。主要原因是由于性能原因，当您转换到内核空间时，并不总是捕获完整的寄存器文件。

如果您进行正常的系统调用，x64[应用程序二进制接口](http://en.wikipedia.org/wiki/Application_binary_interface)(ABI) 只需要您保留[非易失性寄存器](http://msdn.microsoft.com/en-us/library/9z1stfyw.aspx)（类似于进行正常的函数调用）。但是，正确展开异常需要您拥有**所有**寄存器，因此这是不可能的。基本上，这是在关键场景中的性能（即每秒可能发生数千次的场景）与 100% 正确处理病态场景（崩溃）之间的选择。

## 奖金阅读

*   [x64 调用约定概述](http://msdn.microsoft.com/en-us/library/ms235286.aspx)
*   [x86 Software Conventions - Register Usage](http://msdn.microsoft.com/en-us/library/9z1stfyw.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-20T11:54:12.027

一个非常好的问题。

我可以提示为什么跨内核用户边界“传播”异常有些问题。

引用您的问题：

> **如果堆栈跨越内核边界**，为什么 64 位 Windows 不能在异常期间展开堆栈- 而 32 位 Windows 可以？

原因很简单：不存在“堆栈跨越内核边界”这样的事情。调用内核模式函数决不能与标准函数调用相提并论。它实际上与调用堆栈无关。您可能知道，内核模式内存根本无法从用户模式访问。

调用内核模式函数（又名*syscall*）是通过触发软件中断（或类似机制）来实现的。用户模式代码将一些值放入寄存器（标识所需的内核模式服务）并调用 CPU 指令（例如`sysenter`），该指令将 CPU 转换为内核模式并将控制权传递给操作系统。

然后是处理请求的系统调用的内核模式代码。它在单独的内核模式堆栈中运行（与用户模式堆栈无关）。处理请求后 - 控件返回到用户模式代码。根据特定的系统调用，用户模式返回地址可能是调用内核模式事务的地址，也可能是不同的地址。

有时你调用一个内核模式函数，“在中间”应该调用一个用户模式调用。它可能看起来像一个由用户-内核-用户代码组成的调用堆栈，但它只是一个**仿真**。在这种情况下，内核模式代码将控制权转移到包装用户模式函数的用户模式代码。此包装器代码调用您的函数，并在其返回后立即触发内核模式事务。

现在，如果“从内核模式调用”的用户模式代码引发异常 - 这应该会发生：

1.  包装用户模式代码处理 SEH 异常（即停止其传播，但尚未执行堆栈展开）。
2.  将控制权传递给内核模式 (OS)，就像在正常的程序流案例中一样。
3.  Kenrel 模式代码会做出适当的响应。它完成了请求的服务。根据是否存在用户模式异常 - 处理可能会有所不同。
4.  返回用户模式后 - 内核模式代码可以指定是否存在嵌套异常。如果发生异常，堆栈不会恢复到其原始状态（因为还没有展开）。
5.  用户模式代码检查是否存在此类异常。如果是 - 调用堆栈被伪造以包含嵌套的用户模式调用，并且异常传播。

因此，跨越内核用户边界的异常是**emulation**。国内是没有这种东西的。

# javascript - 谷歌地图嵌入和权限访问

> ID：11376797
> 
> 赞同：1
> 
> 时间：2012-07-07T16:36:45.290
> 
> 标签：javascript, google-maps

我需要在页面中动态添加一些简单的地图。当我尝试这个静态代码时，它可以工作

```
<iframe src="http://maps.google.it/?ie=UTF8&amp;ll=45.442726,12.3925788&amp;t=w&amp;z=12&amp;output=embed&amp;iwloc=near"></iframe> 
```

但是，如果我尝试使用此代码动态添加该 iframe

```
var HTMLiframe = document.createElement("iframe");
var code = "src=https://maps.google.it/?ie=UTF8";
code += "&amp;ll=" + itemMap.latitude + "," + itemMap.longitude + "&amp;t=w";
code += "&amp;z" + itemMap.zoom;
code += "&amp;output=embed&amp;iwloc=near";

HTMLiframe.setAttribute("src", code);
HTMLelemFather.appendChild(HTMLiframe); 
```

更新：记录了一条错误消息：拒绝显示文档，因为 X-Frame-Options 禁止显示我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:47:13.290

你正在这样做：

```
var code = "src=https://maps.google.it/?ie=UTF8"; 
```

将其更改为：

```
var code = "https://maps.google.it/?ie=UTF8"; 
```

这部分将其分配给 iframe 元素的 src 属性：

```
HTMLiframe.setAttribute("src", code); 
```

# https - iPhone 的 HTTPS 请求 API

> ID：11376800
> 
> 赞同：1
> 
> 时间：2012-07-07T16:37:15.473
> 
> 标签：https, request

我的 API 看起来像 #https://www.wikifood.eu/wikifood/en/struts/userfoodDB.do?method=getProductOverview&query=4016249502058&startAt=0&limit=5&filter=true&loginname=developer&password=4f14f46f76c4b9be2150be579669e699b79f0093

我需要将它添加到我的扫描条形码的应用程序中。所以参数查询我需要改成resultText：

```
#https://www.wikifood.eu/wikifood/en/struts/userfoodDB.do?method=getProductOverview&query="resultText"&startAt=0&limit=5&filter=true&loginname=developer&password=4f14f46f76c4b9be2150be579669e699b79f0093 
```

现在我需要创建对数据库的请求。而不是接收一些xml文件。

1）我该怎么做？如果我只需要解析结果（xml 文件）并将其显示在 iPhone 上？

2) 解析后可以在ImageView中显示结果吗？

我现在正在尝试使用 ASIHTTPRequest [http://allseeing-i.com/ASIHTTPRequest/How-to-use](http://allseeing-i.com/ASIHTTPRequest/How-to-use)来做到这一点，但实际上我不明白除了这个我应该做什么：

```
- (IBAction)grabURLInBackground:(id)sender
{
 NSURL *url = [NSURL     URLWithString:@"https://www.wikifood.eu/wikifood/en/struts/userfoodDB.do?method=getProductOverview&query="resultText"&startAt=0&limit=5&filter=true&loginname=NNNNNNNN&password=PPPPPPPPPP"];
ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
[request setDelegate:self];
[request startAsynchronous]; 
```

}

```
- (void)requestFinished:(ASIHTTPRequest *)request
{
// Use when fetching text data
NSString *responseString = [request responseString];

}

- (void)requestFailed:(ASIHTTPRequest *)request
{
NSError *error = [request error];
}
@end 
```

我应该在委托文件或控制器文件中添加一些东西吗？

谢谢

希望早日收到你的消息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T06:14:38.057

所以我也在使用 ASIHTTPRequest。

当我从 ... *requestFinished*获取数据时，只需通过调用 JSON Value 将其放入 NSDictionary （在[此处](https://github.com/stig/json-framework/)下载 api ）

例如：

```
NSDictionary *dic = [[request responseString] JSONValue]; 
```

然后您可以访问 cellForRowAtIndexPath 中的数据以在 tableView 中购买数据。

知道了？

# objective-c - Objective C 内存问题

> ID：11376803
> 
> 赞同：0
> 
> 时间：2012-07-07T16:37:25.510
> 
> 标签：objective-c, ios, string, memory-management, memory-leaks

我目前正在为 iPhone 开发我的第一个应用程序，我几乎完成了，但我遇到了内存管理等问题。请记住，我对 java 非常擅长，而且我只学习了 Objective C 大约 4 天。

因此，确切的问题在于该区域（星号行之间）。注意：如果重要的话，所有代码都位于一个大游戏循环中。

```
else 
        {
            ***********************************
            NSString *rand = [NSString stringWithFormat:@"%@", randNumberS];
            while(lastTime + interval >= currentTime)
            {
        !!!!!!!!!NSString *user = [NSString stringWithFormat:@"%@", userText]; 
                    if([user isEqualToString: rand])
                    {
            ***********************************
                        score += 10;
                        randNumberS = nil;
                        timeToGenerateNum = true;
                        bottomClear = true;
                        break;
                    }
                    else 
                    {

                        //NSLog(@"%@ != %@, %i", userText, randNumberS, score);
                    }

            }
            NSLog(@"Game Over! Your score was %i!", score);
        }
    } 
```

每次我在启用僵尸之前运行（注意：代码运行了几秒钟顺便说一句），我`Thread 6: Program received signal: "EXC_BAD_ACCESS"`在标有“！”的行处得到一个。启用僵尸后，它会运行几秒钟，然后停止工作，并且消息`-[CFString respondsToSelector:]: message sent to deallocated instance 0x11168440`出现在控制台中。它还用“！”标记同一行

我查看了这两个，它们都指向糟糕的内存管理，我尝试释放 NSString 对象，但我的程序不允许我释放对象（注意：我收到此错误消息`"release" is unavailable: not available in automatic reference counting mode`）。

任何帮助将不胜感激，谢谢！

编辑：

userText 用在多种方法中，但主要是在这个方法中。

```
-(IBAction)button1Clicked:(id)sender
{    
if(userText == nil)
{
    userText = [NSString stringWithFormat:@"%i", 1];
}
else 
{
    userText = [NSString stringWithFormat:@"%@%i",userText , 1];
}
bottomLabel.text = userText;
NSLog(@"Test 1");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:42:56.970

该`userText`变量不是有效对象，这是您的错误消息所指示的。一般来说，EXC_BAD_ACCESS 发生在您尝试使用指向不再存在的东西的指针时。然后在启用 Zombies 的情况下，消息更加清晰，`userText`以前是一个字符串，但已被释放。

编辑：

如果 userText 是实例变量，建议使用属性，然后使用点表示法。某处有一个 @interface 部分，其中声明了 userText 。它*应该*如下所示：

```
@property (nonatomic, strong) NSString *userText; 
```

然后在@implementaiton 区域中，如下所示：

```
@synthesize userText = _userText; 
```

这些一起使点符号可用，然后您*应该使用 self.userText 在**任何地方*访问它（自定义访问器除外）：

```
self.userText = @"something";
NSString *something = self.userText; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:48:24.813

您正在使用 ARC，因此您将无法释放对象，但是如果您想释放它们，您可以将它们设置为 nil。

相反，您可以对不需要保留的变量使用弱修饰符，或者对打算保留的变量使用强修饰符。

如果您只是学习 obj-c，我强烈建议您禁用 ARC，这样您就可以全面了解 Objective-c 的工作原理以及为什么 ARC 现在是 Apple 的推荐。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T17:05:12.263

在 Instruments 下的模拟器上运行您的应用程序（使用 Xcode 的 Product > Profile 菜单项）。选择僵尸乐器。当 Instruments 因僵尸引用而停止您的应用程序时，您可以在详细信息面板（Instruments 窗口的底部）中深入了解僵尸对象的保留和释放历史记录。您可以通过打开扩展详细信息面板（仪器窗口右侧）查看每个保留和释放的堆栈跟踪。

这应该可以帮助您找出为什么您的僵尸对象在您预期之前被释放。

带有额外指导的链接：

[http://www.markj.net/iphone-memory-debug-nszombie/](http://www.markj.net/iphone-memory-debug-nszombie/)

[http://www.dimzzy.com/blog/2011/02/hunting-down-zombies-in-ios-apps/](http://www.dimzzy.com/blog/2011/02/hunting-down-zombies-in-ios-apps/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T16:54:20.067

解决这类问题的常用方法是启用 NSZombies。当您以比抛出此异常更友好的方式向已释放对象发送消息时，这将被标记。

此外，对于 ARC，您不能使用`retain`，`release`或者`autorelease`因为编译器在构建时添加了这些调用。

`rand`您创建和NSStrings的方式有一些奇怪的结构`user`，但是在不知道什么`randNumberS`和`userText`是什么的情况下，我无能为力。

最后，由于您是 Cocoa 和 Objective-C 的新手；有苹果的[编码风格指南](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CodingGuidelines/CodingGuidelines.html)，我写了一个[编码约定](http://abizern.org/cocoa-coding-conventions/)指南。

编写 Cocoa 时有一些约定可以让其他开发人员更容易阅读您的代码。

# java - java.lang.NoSuchMethodError: javax.persistence.OneToMany.orphanRemoval()

> ID：11376804
> 
> 赞同：5
> 
> 时间：2012-07-07T16:37:25.917
> 
> 标签：java, hibernate, jpa, hibernate-mapping

我有一个使用 spring、hibernate (3.6.4)、GWT(2.3)、drools 的 maven 项目......在我开始使用 hibernate OneToMany、ManyToMany 关系之前，一切都正常工作......

当我从“mvn jetty:run”运行应用程序时，它可以工作，但是当我从 gwt 嵌入式码头和我嵌入在我的应用程序中的码头版本运行应用程序时，我得到：

```
[INFO] Caused by: java.lang.NoSuchMethodError: javax.persistence.OneToMany.orphanRemoval()Z
[INFO]  at org.hibernate.cfg.AnnotationBinder.processElementAnnotations(AnnotationBinder.java:1912)
[INFO]  at org.hibernate.cfg.AnnotationBinder.processIdPropertiesIfNotAlready(AnnotationBinder.java:796)
[INFO]  at org.hibernate.cfg.AnnotationBinder.bindClass(AnnotationBinder.java:707)
[INFO]  at org.hibernate.cfg.Configuration$MetadataSourceQueue.processAnnotatedClassesQueue(Configuration.java:4035)
[INFO]  at org.hibernate.cfg.Configuration$MetadataSourceQueue.processMetadata(Configuration.java:3989)
[INFO]  at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1398)
[INFO]  at org.hibernate.cfg.Configuration.buildMappings(Configuration.java:1375)
[INFO]  at org.springframework.orm.hibernate3.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:717)
[INFO]  at org.springframework.orm.hibernate3.AbstractSessionFactoryBean.afterPropertiesSet(AbstractSessionFactoryBean.java:211)
[INFO]  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1477)
[INFO]  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1417)
[INFO]  ... 95 more 
```

这些是罐子：

```
 [INFO] +- org.hibernate.javax.persistence:hibernate-jpa-2.0-api:jar:1.0.0.Final:compile
  [INFO] +- junit:junit:jar:4.8.2:test
  [INFO] +- log4j:log4j:jar:1.2.16:compile
  [INFO] +- org.slf4j:slf4j-api:jar:1.6.1:compile
  [INFO] +- org.slf4j:jcl-over-slf4j:jar:1.6.1:compile
  [INFO] +- org.slf4j:slf4j-log4j12:jar:1.6.1:compile
  [INFO] +- org.aspectj:aspectjrt:jar:1.6.11:compile
  [INFO] +- org.aspectj:aspectjweaver:jar:1.6.11:compile
  [INFO] +- javax.servlet:servlet-api:jar:2.5:compile
  [INFO] +- net.sf.flexjson:flexjson:jar:2.1:compile
  [INFO] +- org.apache.commons:commons-io:jar:1.3.2:compile
  [INFO] +- org.springframework.roo:org.springframework.roo.annotations:jar:1.1.5.RELEASE:provided
  [INFO] +- org.springframework:spring-core:jar:3.0.5.RELEASE:compile
  [INFO] |  \- org.springframework:spring-asm:jar:3.0.5.RELEASE:compile
  [INFO] +- org.springframework:spring-test:jar:3.0.5.RELEASE:test (scope not updated to compile)
  [INFO] +- org.springframework:spring-context:jar:3.0.5.RELEASE:compile
  [INFO] |  +- org.springframework:spring-beans:jar:3.0.5.RELEASE:compile
  [INFO] |  \- org.springframework:spring-expression:jar:3.0.5.RELEASE:compile
  [INFO] +- org.springframework:spring-aop:jar:3.0.5.RELEASE:compile
  [INFO] |  \- aopalliance:aopalliance:jar:1.0:compile
  [INFO] +- org.springframework:spring-aspects:jar:3.0.5.RELEASE:compile
  [INFO] |  \- org.springframework:spring-context-support:jar:3.0.5.RELEASE:compile
  [INFO] +- org.springframework:spring-tx:jar:3.0.5.RELEASE:compile
  [INFO] +- org.hsqldb:hsqldb:jar:1.8.0.10:compile
  [INFO] +- org.hibernate:hibernate-core:jar:3.6.4.Final:compile
  [INFO] |  +- antlr:antlr:jar:2.7.6:compile
  [INFO] |  +- commons-collections:commons-collections:jar:3.1:compile
  [INFO] |  +- dom4j:dom4j:jar:1.6.1:compile
  [INFO] |  \- org.hibernate:hibernate-commons-annotations:jar:3.2.0.Final:compile
  [INFO] +- org.hibernate:hibernate-entitymanager:jar:3.6.4.Final:compile
  [INFO] |  \- javassist:javassist:jar:3.12.0.GA:compile
  [INFO] +- org.hibernate:hibernate-validator:jar:4.1.0.Final:compile
  [INFO] +- javax.validation:validation-api:jar:1.0.0.GA:compile
  [INFO] +- cglib:cglib-nodep:jar:2.2:compile
  [INFO] +- javax.transaction:jta:jar:1.1:compile
  [INFO] +- org.springframework:spring-jdbc:jar:3.0.5.RELEASE:compile
  [INFO] +- org.springframework:spring-orm:jar:3.0.5.RELEASE:compile
  [INFO] +- commons-pool:commons-pool:jar:1.5.4:compile
  [INFO] +- commons-dbcp:commons-dbcp:jar:1.3:compile
  [INFO] +- org.springframework:spring-web:jar:3.0.5.RELEASE:compile
  [INFO] +- org.springframework:spring-webmvc:jar:3.0.5.RELEASE:compile
  [INFO] +- org.springframework.webflow:spring-js-resources:jar:2.2.1.RELEASE:compile
  [INFO] +- commons-digester:commons-digester:jar:2.0:compile
  [INFO] |  \- commons-beanutils:commons-beanutils:jar:1.8.0:compile
  [INFO] +- commons-fileupload:commons-fileupload:jar:1.2.1:compile
  [INFO] +- javax.servlet:jstl:jar:1.2:compile
  [INFO] +- javax.servlet.jsp.jstl:jstl-api:jar:1.2:compile
  [INFO] +- org.glassfish.web:jstl-impl:jar:1.2:compile
  [INFO] +- javax.el:el-api:jar:1.0:provided
  [INFO] +- joda-time:joda-time:jar:1.6:compile
  [INFO] +- javax.servlet.jsp:jsp-api:jar:2.1:compile
  [INFO] +- commons-codec:commons-codec:jar:1.4:compile
  [INFO] +- com.google.gwt:gwt-servlet:jar:2.3.0:compile
  [INFO] +- com.google.gwt:gwt-user:jar:2.3.0:provided
  [INFO] +- org.json:json:jar:20090211:compile
  [INFO] +- com.google.gwt.inject:gin:jar:1.5.0:compile
  [INFO] |  +- com.google.inject:guice:jar:3.0-rc2:compile
  [INFO] |  |  \- javax.inject:javax.inject:jar:1:compile
  [INFO] |  \- com.google.inject.extensions:guice-assistedinject:jar:3.0-rc2:compile
  [INFO] +- javax.validation:validation-api:jar:sources:1.0.0.GA:compile
  [INFO] +- xalan:xalan:jar:2.7.1:compile
  [INFO] |  \- xalan:serializer:jar:2.7.1:compile
  [INFO] |     \- xml-apis:xml-apis:jar:1.3.04:compile
  [INFO] +- mysql:mysql-connector-java:jar:5.1.17:compile
  [INFO] +- proj.Dependencies:advancedComponents:jar:2.0.6:compile
  [INFO] +- proj.Dependencies:gwtent:jar:2.0RC1:compile
  [INFO] +- proj.Dependencies:gwtent-orm:jar:2.0RC1:compile
  [INFO] +- proj.Dependencies:gwt-crypto:jar:3.0.0:compile
  [INFO] +- javax.mail:mail:jar:1.4.4:compile
  [INFO] |  \- javax.activation:activation:jar:1.1:compile
  [INFO] +- com.thoughtworks.paranamer:paranamer-generator:jar:2.3:compile
  [INFO] |  +- com.thoughtworks.qdox:qdox:jar:1.12:compile
  [INFO] |  \- asm:asm:jar:3.3:compile
  [INFO] +- com.thoughtworks.paranamer:paranamer:jar:2.3:compile
  [INFO] +- com.lowagie:itext:jar:2.0.8:compile
  [INFO] |  +- bouncycastle:bcmail-jdk14:jar:138:compile
  [INFO] |  \- bouncycastle:bcprov-jdk14:jar:138:compile
  [INFO] +- proj.Dependencies:core-renderer:jar:8:compile
  [INFO] +- proj.Dependencies:core-renderer-minimal:jar:8:compile
  [INFO] +- proj.Dependencies:xml-apis-xerces:jar:2.9.1:compile
  [INFO] +- org.apache.poi:poi:jar:3.8-beta4:compile
  [INFO] +- org.apache.poi:poi-ooxml:jar:3.8-beta4:compile
  [INFO] +- org.apache.poi:poi-ooxml-schemas:jar:3.8-beta4:compile
  [INFO] |  \- org.apache.xmlbeans:xmlbeans:jar:2.3.0:compile
  [INFO] |     \- stax:stax-api:jar:1.0.1:compile
  [INFO] +- proj.Dependencies:gwt_i18n_server:jar:1.0:compile
  [INFO] +- org.mortbay.jetty:jsp-api-2.1-glassfish:jar:2.1.v20100127:compile
  [INFO] +- org.mortbay.jetty:jsp-2.1-glassfish:jar:2.1.v20100127:compile
  [INFO] |  +- org.eclipse.jdt.core.compiler:ecj:jar:3.5.1:compile
  [INFO] |  \- ant:ant:jar:1.6.5:compile
  [INFO] +- org.eclipse.jetty:jetty-server:jar:7.2.2.v20101205:compile
  [INFO] |  +- org.eclipse.jetty:jetty-continuation:jar:7.2.2.v20101205:compile
  [INFO] |  \- org.eclipse.jetty:jetty-http:jar:7.2.2.v20101205:compile
  [INFO] |     \- org.eclipse.jetty:jetty-io:jar:7.2.2.v20101205:compile
  [INFO] +- org.eclipse.jetty:jetty-webapp:jar:7.2.2.v20101205:compile
  [INFO] |  \- org.eclipse.jetty:jetty-xml:jar:7.2.2.v20101205:compile
  [INFO] |     \- org.eclipse.jetty:jetty-util:jar:7.2.2.v20101205:compile
  [INFO] +- org.eclipse.jetty:jetty-servlet:jar:7.2.2.v20101205:compile
  [INFO] |  \- org.eclipse.jetty:jetty-security:jar:7.2.2.v20101205:compile
  [INFO] +- org.drools:drools-core:jar:5.3.1.Final:compile
  [INFO] |  \- org.mvel:mvel2:jar:2.1.0.drools4:compile
  [INFO] +- org.drools:droolsjbpm-knowledge:pom:5.3.1.Final:compile
  [INFO] +- org.drools:droolsjbpm-integration:pom:5.3.1.Final:compile
  [INFO] +- org.drools:droolsjbpm-tools:pom:5.3.1.Final:compile
  [INFO] +- org.drools:droolsjbpm-parent:pom:5.3.1.Final:compile
  [INFO] +- org.drools.planner:drools-planner:pom:5.3.1.Final:compile
  [INFO] +- org.drools:drools-multiproject:pom:5.3.1.Final:compile
  [INFO] +- org.drools:knowledge-api:jar:5.3.1.Final:compile
  [INFO] +- org.jbpm:jbpm-flow-builder:jar:5.2.0-SNAPSHOT:compile
  [INFO] |  \- org.jbpm:jbpm-flow:jar:5.2.0-SNAPSHOT:compile
  [INFO] \- org.drools:drools-compiler:jar:5.3.1.Final:compile
  [INFO]    +- org.antlr:antlr-runtime:jar:3.3:compile
  [INFO]    +- org.antlr:antlr:jar:3.3:compile
  [INFO]    \- org.antlr:stringtemplate:jar:3.2.1:compile 
```

我发现有人暗示这意味着有对 jpa 1.0 jar 的引用，但我似乎找不到...除了hibernate jpa 2.0 v. 1.0 final，找不到任何与jpa或持久性相关的东西。我的类路径上没有 ejb3-persistance.jar ......

我该怎么办？

非常感谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-21T15:06:15.953

我有同样的问题，我通过从类路径中删除 persistence-api-1.0.2.jar 来解决它

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-09T02:28:10.637

我们遇到了完全相同的问题，输出 OneToMany.class.getProtectionDomain().getCodeSource().getLocation() 向我们展示了这个问题。由于我们的 pom.xml 中存在陈旧的依赖关系，我们选择了 ejb3 JAR。非常感谢您发布此解决方案！

顺便说一句，如果您使用的是 Eclipse，请记住运行 mvn eclipse:eclipse，否则 .classpath 仍将引用不需要的 JAR。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-01T13:54:58.537

谢谢....这帮助我解决了同样的问题。作为 Web 应用程序运行时，我得到了“坏”路径，但作为应用程序运行时，我得到了“好”路径。

坏 /C:/Program Files (x86)/IBM/SDP/runtimes/base_v7/plugins/javax.j2ee.persistence.jar

好 /C:/hibernate-release-4.1.7.Final%20(1)/hibernate-release-4.1.7.Final/lib/required/hibernate-jpa-2.0-api-1.0.1.Final.jar

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T07:38:37.287

它会导致在实体类中使用持久性 API 注释，以解决此问题，让您的类路径包含

```
 <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-annotations</artifactId>
            <version>3.4.0.GA</version>
            <scope>provided</scope>
        </dependency> 
```

这个依赖使用 ejb3-persistence.jar

# sockets - IcedJava：在提供的 JUnit 测试中具有空地址的套接字

> ID：11376805
> 
> 赞同：1
> 
> 时间：2012-07-07T16:37:36.130
> 
> 标签：sockets, ice

我正在尝试使用[IcedJava](http://java.net/projects/siptools/pages/IcedJava)，并通过运行提供的 JUnit 测试开始。子包*package.attribute*和*stun*中的那些似乎运行完美，但是来自*ice*子包的 IcePeerTest、StreamingTest 和 IcedRTPConnectorTest不起作用：这是因为 DatagramStunSocket 类的 getLocalAddress() 方法返回空值。从 javax.sdp.Media 类型的对象创建的 IceSockets 没有绑定到任何地址。我正在从 mercurial 存储库运行最新版本的 IcedJava。

我做错什么了吗 ？还是我错过了一步？

如果需要，我可以提供更多详细信息。

提前致谢。

# java - Java 平台游戏不运行最初的几行代码...？

> ID：11376807
> 
> 赞同：1
> 
> 时间：2012-07-07T16:38:00.313
> 
> 标签：java

我正在为 Java 中的 2d 平台游戏制作基本大纲......我遇到了一个最近开始的问题！有时，当我运行我的程序时，我的框架出现了，一切都设置好了，你可以看到那个人，但由于某种原因，地面没有被“添加”（我有一个 addGround() 方法，我在运行的第一段）。随着我对游戏的深入了解，这种情况开始越来越多地发生，直到现在，大部分时间它都失败了，不会显示/添加地面！但是，有时它可以完美地完成。

这是它工作时的样子：

![](../Images/2e01bd6efb929e0b5d9661af8f79b799.png)

这是它在大多数时候的样子，当它不起作用时：

![](../Images/6d5142111e87b1b1b411494abd28b281.png)

所以，这是我的主要类代码：（我没有包括所有的导入和东西，只是核心）

```
 public BusiWorld()
    {
        this.setFocusable(true);
        if(init)
        {
            ground.addGround(x-300, y+100, 35, 1);
            ground.addGround(x-100, y-360, 1, 46);
            ground.addGround(x+100, y+90, 1, 1);
            ground.addGround(x+400, y+20, 2, 1);
            ground.addGround(x+460, y-50, 2, 1);
            ground.addGround(x+520, y-120, 2, 1);
            ground.addGround(x+460, y-190, 2, 1);
            ground.addGround(x+140, y-260, 15, 1);
            ground.addGround(x, y-280, 1, 1);
            init = false;
        }
        t = new Timer(16, new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent ae) {
                repaint();
            }
        });
        t.start();
    }
    public static void main(String[] args)
    {
        mainFrame.setTitle("Busiworld");
        mainFrame.setSize(600,500);
        mainFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        mainFrame.setBackground(Color.WHITE);
        mainFrame.setResizable(false);
        mainFrame.setVisible(true);
    }
} 
```

这是地面类代码：

```
public class Ground extends JFrame
{
    private Image groundImg = Toolkit.getDefaultToolkit().getImage("ground.png");
    private ArrayList<Point> groundLocs = new ArrayList<Point>();
    public Ground()
    {

    }
    public void addGround(int xCoord, int yCoord, int howManyWide, int howManyTall)
    {
    for(int i = 0; i < howManyWide; i++)
    {
        for(int j = 0; j < howManyTall; j++)
        {
            groundLocs.add(new Point(xCoord+i*groundImg.getWidth(null), yCoord+j*groundImg.getHeight(null)));
        }
    }
    }
    public void drawGround(Graphics g)
    {
        for(Point p: groundLocs)
        {
            g.drawImage(groundImg, p.x, p.y, this);
        }
    }
    public int groundArraySize()
    {
        return groundLocs.size();
    }
    public Point getGroundArray(int index)
    {
        return groundLocs.get(index);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:06:22.683

This is `JFrame` from Swing? I don't see `invokeLater()` for example when you call `repaint()`. Not managing the threads properly in a Swing application can make all sorts of things go wrong. Given the amount of code you've posted, I suggest you deal with threading first - then you can narrow-down your issue if it's still present.

Here's a [tutorial on how to manage threads in Swing](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html).

### Edit:

Basically, anything that modified or causes any drawing to happen must occur before the Swing components are initialised, or on the event-dispatch thread. Code in an event listener or called through `invokeLater()` or `invokeAndWait()` is run on the event-dispatch thread. The code in your `Timer` is *not* called on the event-dispatch thread but does interact with the Swing component, so could make all sorts of things go wrong (such as erasing half your drawing).

# javascript - 为什么当我使用 JQuery DatePicker 时 Google Code Prettifier 停止工作（反之亦然）

> ID：11376808
> 
> 赞同：0
> 
> 时间：2012-07-07T16:38:07.310
> 
> 标签：javascript, jquery, jquery-ui-datepicker, google-code-prettify

如果[Google Code Prettifier](http://code.google.com/p/google-code-prettify/)（或[JQuery Syntax Highlighter ）与](http://balupton.github.com/jquery-syntaxhighlighter)[JQuery DatePicker](http://jqueryui.com/datepicker/)在同一页面中使用，则两者都不会正常工作。为什么是这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:38:08.057

因为他们都将 now 方法修补到本机 Date 对象上！

美化这样做：

```
var clock = Date;
if (!clock['now']) {
  clock = { 'now': function () { return +(new Date); } };
} 
```

DatePicker 这样做：

```
Date.now=function(){return new Date();} 
```

所以 Prettify 返回日期的 int 表示形式（以便它可以添加一些毫秒），而 DatePicker 返回日期。

（IMO 这种事情在两个这样的常用库中是令人发指的。）

# sql - oracle group by 多表连接

> ID：11376818
> 
> 赞同：1
> 
> 时间：2012-07-07T16:39:24.907
> 
> 标签：sql, oracle

我的桌子设计如下：-

```
 Table A 
--------------------------
subCatId | catId | catDesc
--------------------------
   1     |  3    |  100
   2     |  3    |  100
   3     |  5    |  100
   4     |  5    |  100
   5     |       |  100

Table B
--------------------------
subCatId | amount 
--------------------------
   1     |  10
   2     |  20
   3     |   5
   4     |  15
   5     | 
```

第三个表，即表 AB，是要插入记录的表。在上述表格的基础上查询应该： 1.检查表AB，其中是否存在任何subCatId。2\. 如果表为空，则获取表 A 中存在的所有 subCatId 和 catId，其中 catDesc=100 并根据表 A 的 subCatId 获取表 B 的数量。

```
 Table AB
--------------------------
subCatId | catId | amount
--------------------------
   1     |  3    |  10
   2     |  3    |  20
   3     |  5    |  35       
   4     |  5    |  15
   5     |       |  50 
```

正如您在上面的表 AB 中看到的 subCatId 1 和 2 的 catId 为 3，因此 1 和 2 的金额值应该汇总并显示为 subCatId 3（包括表 B 中已经存在的金额值 5）。同样，对于 subCatId 5，金额值应从 subCatId 3 和 4 中求和。

如果有人可以帮助我获得如上 TableAB 所示的预期结果，我将不胜感激。

我已经分别尝试了以下查询

```
SELECT A.CATID, SUM(B.AMOUNT) 
FROM A LEFT OUTER JOIN B 
           ON A.SUBCATID = B.SUBCATID 
WHERE A.CATDESC=100
  AND A.SUBCATID NOT IN 
          (SELECT AB.SUBCATID FROM AB) 
GROUP BY CATID; 
```

但是，它只给出 catid 和总量值，但我也找不到获取`subCatId`它们各自数量的方法。请帮助...谢谢。应用左外连接的原因是，如果 subCatId 在表 B 中不存在，但在表 A 中存在，那么它也应该与结果一起显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:44:22.380

这个解释很接近，但并没有完全得到你想要的。

首先，从金额基表开始：

```
select a.subcatid, a.catid, b.amount
from (select *
      from A
      where a.catdesc = 100
     ) A left outer join
     B
     on a.subcatid = b.subcatid left outer join
     AB
     on a.subcatid = ab.subcatid and a.catid = b.catid
where ab.subcatid is null 
```

接下来，您要在此处获取金额并添加 catid 等于 subcat id 的所有金额。为此，我们需要一个自联接。我将使用 with 语法将其定义为别名：

```
with t as (
     select a.subcatid, a.catid, b.amount
     from (select *
           from A
           where a.catdesc = 100
          ) A left outer join
          B
          on a.subcatid = b.subcatid left outer join
          AB
          on a.subcatid = ab.subcatid and a.catid = b.catid
     where ab.subcatid is null
)
select t.subcatid, t.catid,
       (t.amount + coalesce(tcat.amount, 0)) as amount
from t left outer join
     (select catid, sum(amount) as amount
      from t
      group by catid
     ) tcat
     on t.subcatid = t.cat 
```

问题在于，这会汇总基本金额，而不是沿途的中间总额。因此，“5”的总数包括“3”和“4”的基数，但不包括它们下面的小计。

要获得完整的解决方案，您似乎需要两件事之一。要么建立一个循环逐行遍历表，使用更新和查询来获得你需要的东西。或者，我认为 Oracle 有“connect by”语句，它允许沿树结构进行查询。不幸的是，我对它的了解还不够，无法生成正确的 SQL。或者，如果树结构不是太深（例如在您的示例中），那么您可以手动遍历一两个级别（如果足够的话）。

# struts2 - 在 Struts2 中引用静态字段作为参数值

> ID：11376824
> 
> 赞同：2
> 
> 时间：2012-07-07T16:40:11.457
> 
> 标签：struts2

是否有可能得到如下结果：

```
 <result name="defaultLocaleLoginScreen" type="httpheader">
            <param name="status">301</param>
            <param name="headers.Location">${@zzz.yyy.xxx.MyClass@MyValue}</param>
    </result> 
```

其中 MyValue 是 MyClass 类的静态字段。我无法让它发挥作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T19:06:18.807

好吧，毕竟它工作得很好，我不知道我做错了什么。我需要比静态字段更复杂的东西，我需要执行一个静态方法，然后从返回的对象中获取一个 getter。最终的解决方案是：

```
<param name="headers.Location">${@zzz.yyy.xxx.Myclass@getInstance().getValue()}</param> 
```

# tomcat - 在哪里保存 ActiveMQ 数据？

> ID：11376825
> 
> 赞同：4
> 
> 时间：2012-07-07T16:40:13.243
> 
> 标签：tomcat, debian, tomcat6, activemq

我正在管理使用我们的程序员编写的应用程序运行 tomcat6 的服务器。它使用 ActiveMQ。应用程序将 ActiveMQ 队列数据保存在 $JAVA_TEMP/activemq-data 中。Debian Squeeze 上的 Tomcat6 在每次重新启动时都会清除 $JAVA_TEMP（默认为 /tmp/tomcat6-temp）。程序员说，这些数据在服务重启之间必须是持久的。java servlet 保存持久数据的合适位置是什么？恕我直言，它不是 $JAVA_TEMP 目录。或者可能是程序员是对的，我应该改变默认的 Debian tomcat 行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:59:40.383

ActiveMQ 提供持久性适配器来存储服务器重启所需的消息。持久化消息有不同的策略。

*   基于文件的持久性存储：在此策略中，消息存储到文件存储中。您可以在 ActiveMQ 配置中指定目录。看下面的例子，更多配置请参考：[http ://activemq.apache.org/amq-message-store.html](http://activemq.apache.org/amq-message-store.html)

    `<broker brokerName="broker" persistent="true" useShutdownHook="false">` `<persistenceAdapter>`

    `<amqPersistenceAdapter directory="activemq-data" maxFileLength="32mb"/>`

    `</persistenceAdapter>`

    `<transportConnectors>`

    `<transportConnector uri="tcp://localhost:61616"/>`

    `</transportConnectors>`

    `</broker>`

*   基于数据库的持久性存储：在此策略中，消息存储在数据库中，如果您的消息很关键，请使用此策略。有关配置 JDBC - 数据库持久性的信息，请参阅[http://activemq.apache.org/jdbc-support.html](http://activemq.apache.org/jdbc-support.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:06:49.463

当谈到 java servlet 的存储时，会想到可伸缩性。通常，Java servlet 被构建和设计为可同时部署在多个服务器（tomcat 实例等）上，以实现垂直扩展。因此，经验法则是尽可能使用数据库存储。在您的特定情况下，您似乎运行单个服务器，您可以使用文件系统上您想要的任何位置。也许您想将数据存储在 NAS/SAN 上。

ActiveMQ 可以通过持久性适配器处理大多数存储选项。

此[链接](http://activemq.apache.org/persistence.html)描述了 ActiveMQ 如何处理持久性以及如何配置它。这是一个丰富的领域，它取决于很多要求以及您喜欢如何进行设置。

# c# - 例外清单

> ID：11376829
> 
> 赞同：21
> 
> 时间：2012-07-07T16:40:40.857
> 
> 标签：c#, c++, vb.net, jscript, j#

我正在寻找 c#、c++、vb.net、j# 和 jscript 中可能的异常列表。问题是一些网站向我显示了 20 个例外的列表，而其他一些网站向我显示了 39 个例外的列表。谁能给我一个适当的信息？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-07T16:44:07.890

如果您正在寻找 .Net 框架可以抛出的异常列表，[这篇文章有很多](http://mikevallotton.wordpress.com/2009/07/08/net-exceptions-all-of-them/)。我不知道您从哪里获取这些特定数字，也不知道您希望通过了解所有例外情况（包括您可能永远不会看到的例外情况）来实现什么。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-07T16:42:25.553

*.NET*框架声明了许多异常 - 其他代码（包括您自己的）可以创建更多。肯定有超过 39 个……查看文档[`System.Exception`](http://msdn.microsoft.com/en-us/library/system.exception.aspx)，您会在底部附近看到.NET 框架中所有*直接已知的子类的列表。*

基本上，知道“所有异常”是没有用的——重要的是*你正在执行的代码*可以抛出哪些异常，特别是你应该真正尝试处理哪些异常（而不是那些应该杀死进程或只是使请求在服务器环境中失败）。

# html - “float:left;”的优点 没有缺点

> ID：11376831
> 
> 赞同：0
> 
> 时间：2012-07-07T16:40:56.910
> 
> 标签：html, css

我想得到与此相同的结果：http: [//jsfiddle.net/mageek/faDkw/](http://jsfiddle.net/mageek/faDkw/)

HTML：

```
<div id="foo" >Hello</div>
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
World! 
```

CSS：

```
#foo
{
    background-color:red;
    height:400px;
    float:left;
} 
```

但是没有所有的`<br />`，因为高度可能会改变。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:44:08.513

您可以只使用`display: inline-block`（[MDN docu](https://developer.mozilla.org/en/CSS%3adisplay)），它不像`float: left`不将 div 放在页面流之外。

HTML

```
<div id="foo" >Hello</div>
<br />
World! 
```

CSS

```
#foo
{
    background-color:red;
    height:400px;
    display: inline-block;
} 
```

[示例小提琴](http://jsfiddle.net/faDkw/1/)。

# http-headers - wget 保存标题和文件损坏？

> ID：11376832
> 
> 赞同：0
> 
> 时间：2012-07-07T16:41:15.963
> 
> 标签：http-headers, wget, corruption

运行`wget --save-headers`会将响应标头留在下载文件的顶部。但是，使用此参数下载的任何文件似乎都已损坏，即使删除了标头也是如此。

```
$ wget svnpenn.github.io/img/2012/git.jpg

$ wget --save-headers -O- svnpenn.github.io/img/2012/git.jpg | sed '1,/^$/d' > git2.jpg

$ ls -l
total 136
-rw-r--r--+ 1 Steven None 65755 Jul  4 21:58 git.jpg
-rw-r--r--+ 1 Steven None 65753 Jul  7 11:35 git2.jpg 
```

![git2](../Images/81c57e91de9a0ce3a19cb19ca6c5a4b6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:50:40.357

看起来这`sed`是执行此操作的命令。如果它用十六进制编辑编辑文件，它工作正常。以下命令对我有用。

```
$ wget --save-headers svnpenn.github.io/img/2012/git.jpg
HTTP request sent, awaiting response... 200 OK
Length: 65755 (64K) [image/jpeg]

$ sed -b '1,/^\r/d' git.jpg > good.jpg

$ ls -l
total 136
-rw-r--r--+ 1 Steven None 66044 Jul  8 18:17 git.jpg
-rw-r--r--+ 1 Steven None 65755 Jul  9 17:53 good.jpg 
```

# mongodb - MongoDB 限制稀疏索引的数量

> ID：11376833
> 
> 赞同：1
> 
> 时间：2012-07-07T16:41:42.790
> 
> 标签：mongodb, indexing, mongodb-query

我特别需要在 MongoDB 集合中拥有特别大量的稀疏索引。这个数字可能只有几千。每个存储的文档将只使用相对较少的索引，平均每个大约 10 到 30 个。但是，这些文档种类繁多，并且每个都需要不同的索引集。

我找不到任何关于在集合上拥有 > 1000 个稀疏索引的可能影响的文档。空间不是问题。我特别关心的是对节省时间和查询设置的影响。MongoDB 会因如此大的开销而陷入困境吗？

我将运行我自己的基准测试，但我想知道 a) 是否有人知道这方面的一些官方指导方针，并且 b) 对这种情况有任何经验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T10:55:52.370

在服务器中实现之前，您可以运行两次 OR 查询 - 每个字段一次并在客户端合并结果。

例如，如果您有对象：

```
{_id: 123, foo: 12}
{_id: 124, bar: 13}
{_id: 124, foo: 12, bar: 15} 
```

您可以拥有一个稀疏索引`{foo:1, _id:1}`和另一个稀疏索引，`{bar:1, _id:1}`然后执行查询`find({foo:12}, {_id:1})`，`find({bar:13}, {_id:1})`然后执行 OR 或 AND 客户端中的对象 ID。然后，您可以仅检索那些匹配 ID 的完整对象。

注意：通过只检索`_id`find 查询中的字段，Mongo 可以从索引中返回结果，并且不需要解压任何 BSON 来提供结果，这使得这非常快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T17:14:03.870

您可能会遇到命名空间限制（索引、集合的总数等），但可以使用 --nssize 解除限制：[http ://www.mongodb.org/display/DOCS/Using+a+大+数量+个+集合](http://www.mongodb.org/display/DOCS/Using+a+Large+Number+of+Collections)

插入会增加一些开销，但一旦意识到您插入的文档不需要添加到大多数索引中，它应该“快速失败”。免责声明：我没有尝试过您考虑的基准测试。我有兴趣看看它是否会起作用。

要记住的一件事是，如果不使用 $or，您将无法在每个查询中使用多个索引，这是 mongodb 中的当前限制。[http://www.mongodb.org/display/DOCS/Indexing+Advice+and+FAQ#IndexingAdviceandFAQ-Oneindexperquery](http://www.mongodb.org/display/DOCS/Indexing+Advice+and+FAQ#IndexingAdviceandFAQ-Oneindexperquery)。

# php - 亚马逊云搜索的替代品

> ID：11376838
> 
> 赞同：3
> 
> 时间：2012-07-07T16:42:31.463
> 
> 标签：php, search, amazon-cloudsearch

我们正在为我们的网站寻找一种基于搜索的解决方案，该网站将拥有数百万条音乐记录。我们正在寻找亚马逊云搜索，但它会有点贵，因为我们必须每月支付 90 美元。有没有更便宜的/开源解决方案？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T10:03:58.920

有不同的云以及开源的本地产品可用，其中一些如下

*   **www.elasticsearch.org** - 它是建立在 Apache Lucene 之上的开源。在云环境中很好地扩展。

*   **www.searchify.com** - SaaS 产品就像 Amazon Cloudsearch

*   **sphinxsearch.com** - 开源且易于实施和维护。可预测的负载真的很好。

我认为您不需要使用云，除非您在一天的不同时间段内具有不可预测的高搜索负载，或者您没有资源可管理或不想管理自托管解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-18T09:49:47.980

您可以在 heroku 插件部分找到很多基于云的搜索提供程序：Searchbox.io（公共测试版）、Found ElasticSearch（私人测试版）、IndexDen（私人测试版）

有一些我可以看到没有提到的。其中一些也存在于 Heroku 之外的其他云平台上。

我认为搜索是您需要在任何域上实现的那些管道工具之一，而且不是很简单，因此它是外包的一个很好的候选者。

# c++ - 如何组织目录结构并为外部代码编写 Makefile

> ID：11376846
> 
> 赞同：1
> 
> 时间：2012-07-07T16:43:14.910
> 
> 标签：c++, makefile

我正在开始一个包含一些外部代码的大项目。到目前为止，我有一个这样的目录结构：

```
MyProject
|-- include
|    |-- FANN 
|    |    |-- src
|    |    |    |-- include
|    |-- eigen
|         |-- Eigen
|-- MyLibrary
|       +-- header1.H
|       +-- header2.H
|       +-- otherheaderN.H
|-- test
        +-- Makefile
        +-- test1.cpp
        +-- testN.cpp 
```

我将`include`subdir 用于外部代码、`MyLibrary`我自己的头文件和`test`cpp 测试代码。

我有 FANN、Eigen 和其他库。我直接使用他们的代码，我没有包含文件、使用不同目录以及类似的东西的经验。

在 Makefile 我有这样的行：

```
test1:
    g++ -I $(FANN) -I $(FANNINCLUDE) -I $(EIGEN) -I $(MyLib) test1.cpp -o test1 
```

我就是这样解决编译的，但是不知道用各种-I选项是不是不好。例如，我使用 FANN 作为指向 FANN/src 的路径，使用 FANNINCLUDE 作为路径/src/include；这是因为我包含了 FANN/src/"doublefann.c" 并且它有一个 #include"config.h"（在 FANN/src/include 中是 config.h）。我是个烂摊子！

您会推荐一种更好的文件组织方式还是更好？我在Makefile中做错了吗？任何其他建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:07:20.780

I don't think including doublefann.c is a good idea.

To cope with this situation, you can compile all the external code into a shared (or static) library, and then include the headers into files in MyLibrary (or test) directory. After compilation, you can 'link' to the library.

If you have an option to switch from Makefile then CMake would be a better option. In my experience, using CMake to organize projects is easier than using Makefile.

# silverlight - 如何从 Silverlight 组合框而不是 DTO 值获取实际值

> ID：11376848
> 
> 赞同：1
> 
> 时间：2012-07-07T16:43:25.083
> 
> 标签：silverlight

我正在自动化一个 Silverlight 应用程序进行测试。我有一个具有 1000 个值的 Silverlight 组合框。

我可以通过索引选择值，但不能通过传递实际值。

此外，如果我尝试获取组合框的内容，它会以数据模板对象的形式显示一些 xyz.DTO。

我没有开发知识，所以我无法理解数据模板的概念并对其进行解码。

有人可以帮助我了解如何从组合框而不是代码中检索实际值，或者如何通过传递值而不是索引来选择值。

感谢有人可以提供快速建议。

谢谢， SlvAutomator

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:54:06.860

您可以通过执行以下操作来选择组合框项的**Content属性：**

```
 string content = ((ComboBoxItem)comboBox.Items[index]).Content.ToString(); 
```

要使用 Content 属性选择项目，您需要在组合框中指定**SelectedValuePath**：

```
 <ComboBox x:Name="comboBox" Width="100" Height="100" SelectedValuePath="Content">
        <ComboBoxItem Content="Blue"/>
        <ComboBoxItem Content="Black" />
        <ComboBoxItem Content="Dark Red" />
    </ComboBox> 
```

然后在后面的代码中你可以选择这样的值：

```
 comboBox.SelectedValue = "Black"; 
```

# cakephp - 无法关闭 MAMP 中的严格标准警告

> ID：11376850
> 
> 赞同：2
> 
> 时间：2012-07-07T16:43:44.817
> 
> 标签：cakephp, mamp, php

我一直在尝试在 MAMP 上设置 CakePHP。一切都很顺利，除了它在所有页面上都显示“严格标准”和“已弃用”警告。

我相信其他人可能已经经历过这种情况，我已经按照[http://planetcakephp.org/aggregator/items/142-mamp-php5-cakephp-and-strict-standards](http://planetcakephp.org/aggregator/items/142-mamp-php5-cakephp-and-strict-standards)将错误报告设置为：

```
error_reporting  =  E_ALL & ~E_STRICT 
```

...这没有任何区别（这显然包括重新启动 MAMP，并且我还三重检查了我正在编辑正确的 php.ini 文件，如 phpInfo() 中所引用的）。

查看 phpInfo 报告，error_reporting 显示的值为“30719”，我理解它是 E_ALL 的机器值。鉴于我在 php.ini 中设置的内容，我不确定这是否正确。我现在也设置了

```
display_errors = Off 
```

这可能会阻止任何错误显示......但同样，没有区别。

最后，我还尝试编辑 htaccess 文件（例如，包括 php_value error_reporting 6143），但这也没有任何区别。

我确定我只是在某个地方做了一些非常愚蠢的事情——谁能指出我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-24T07:34:44.383

为可能面临此问题的人回答一个非常古老的问题-

```
Configure::write('Error', array(
    'handler' => 'ErrorHandler::handleError',
    'level' => E_ALL & ~E_DEPRECATED &  ~E_STRICT, // This line
    'trace' => true
)); 
```

在`core.php`里面`/app/Config`

# asp.net-mvc - 如何在 ASP.NET MVC 视图中对 HTML 列表项进行分组？

> ID：11376855
> 
> 赞同：7
> 
> 时间：2012-07-07T16:44:30.497
> 
> 标签：asp.net-mvc, razor, html-lists, grouping

我在视图中有这段代码

```
<ul>
    @foreach (var tag in Model)
    {
        <li><a href="/Post/Tag/@tag.Id">@tag.Name</a></li>
    }
</ul> 
```

现在我需要按第一个字符对列表项进行分组，比如

```
A
 -Apple
 -Ant

C
 -Car

S
 -Sky
 -Sea
 -Sun 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-07T17:38:32.997

> 我怎样才能做到这一点？

好简单。答案，就像[asp.net-mvc](https://stackoverflow.com/questions/tagged/asp.net-mvc)标签中 99.99% 的问题一样：**使用视图模型**。

我假设您具有以下域模型：

```
public class Tag
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

因此，与往常一样，您首先定义一个视图模型，该模型将满足您要在此视图中实现的要求（按属性`Tag`的第一个字母对域模型列表进行分组`Name`并显示一个链接）：

```
public class TagViewModel
{
    public string Letter { get; set; }
    public IEnumerable<Tag> Tags { get; set; }
} 
```

那么您显然将拥有一个控制器，其职责是查询您的 DAL 层以获取域模型、构建视图模型并最终将此视图模型传递给视图：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        // Get the domain model
        var tags = new[]
        {
            // Guess this comes from a database or something
            new Tag { Id = 1, Name = "Apple" },
            new Tag { Id = 2, Name = "Ant" },
            new Tag { Id = 3, Name = "Car" },
            new Tag { Id = 4, Name = "Sky" },
            new Tag { Id = 5, Name = "Sea" },
            new Tag { Id = 6, Name = "Sun" },
        };

        // now build the view model:
        var model = tags.GroupBy(t => t.Name.Substring(0, 1)).Select(g => new TagViewModel
        {
            Letter = g.Key,
            Tags = g
        });

        return View(model);
    }
} 
```

最后是一个观点：

```
@model IEnumerable<TagViewModel>

@foreach (var item in Model)
{
    <h2>@item.Letter</h2>
    <ul>
        @foreach (var tag in item.Tags)
        {
            <li>
                <!-- Please notice the usage of an HTML helper to generate
                     the anchor instead of the hardcoded url shown in your
                     question which is very bad
                -->
                @Html.ActionLink(
                    tag.Name, 
                    "Post", 
                    "Tag", 
                    new { id = tag.Id }, 
                    null
                )
            </li>
        }
    </ul>
} 
```

这显然会给出预期的结果：

![在此处输入图像描述](../Images/d566bfd8a4b81d557041c63f9fd42134.png)

所以下次你在 ASP.NET MVC 中遇到一些困难或问题时，请告诉自己：*我必须使用视图模型*。看，问题解决了。

# java - 如果显示键盘，Android 应用程序会崩溃

> ID：11376856
> 
> 赞同：0
> 
> 时间：2012-07-07T16:44:34.053
> 
> 标签：java, android

我有一个活动，我强制使用键盘出现，

```
InputMethodManager inputMethodManager=(InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
inputMethodManager.toggleSoftInput(InputMethodManager.SHOW_FORCED, 0); 
```

键盘显示正确，并且在需要时也会被遮挡。问题是当我完成活动时，应用程序崩溃。如果活动从不显示键盘或在没有开始编辑文本的情况下显示它，则它已完成且没有错误，但如果您只输入一个或多个字符，应用程序将崩溃。如何解决？谢谢你。

用于完成活动的方法，

```
 boto_back.setOnClickListener(new OnClickListener() 
            {
                @Override
                public void onClick(View arg0) 
                {
                    InputMethodManager inputMethodManager=(InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
                    inputMethodManager.toggleSoftInput(InputMethodManager.HIDE_IMPLICIT_ONLY, 0);

                    finish();
                }
            });
 @Override
      public void onDestroy() 
      {
        if (adMob != null) 
        {
          // Destroy the AdView.
          adMob.destroy();
        }

        super.onDestroy();
      } 
```

日志猫，

```
07-07 19:04:25.191: E/AndroidRuntime(8443): FATAL EXCEPTION: main
07-07 19:04:25.191: E/AndroidRuntime(8443): java.lang.RuntimeException: Unable to destroy activity {com.xxxx.xxxx/com.xxxx.projecte1.TabBar_iOSActivity}: java.lang.RuntimeException: Unable to destroy activity {com.xxxx.xxxx/com.xxxx.projecte1.webPush}: java.lang.NullPointerException
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.app.ActivityThread.performDestroyActivity(ActivityThread.java:2693)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.app.ActivityThread.handleDestroyActivity(ActivityThread.java:2711)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.app.ActivityThread.access$2100(ActivityThread.java:121)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:976)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.os.Looper.loop(Looper.java:130)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.app.ActivityThread.main(ActivityThread.java:3701)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at java.lang.reflect.Method.invokeNative(Native Method)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at java.lang.reflect.Method.invoke(Method.java:507)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:866)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:624)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at dalvik.system.NativeStart.main(Native Method)
07-07 19:04:25.191: E/AndroidRuntime(8443): Caused by: java.lang.RuntimeException: Unable to destroy activity {com.xxxx.xxxx/com.xxxx.projecte1.webPush}: java.lang.NullPointerException
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.app.ActivityThread.performDestroyActivity(ActivityThread.java:2693)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.app.ActivityThread.performDestroyActivity(ActivityThread.java:2603)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.app.LocalActivityManager.dispatchDestroy(LocalActivityManager.java:622)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.app.ActivityGroup.onDestroy(ActivityGroup.java:85)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at com.xxxx.projecte1.TabBar_iOSActivity.onDestroy(TabBar_iOSActivity.java:417)
07-07 19:04:25.191: E/AndroidRuntime(8443):     at android.app.ActivityThread.performDestroyActivity(ActivityThread.java:2680)
07-07 19:04:25.191: E/AndroidRuntime(8443):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:49:40.717

这是你唯一的活动......??

**如果是......尝试删除finish();**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T08:00:11.560

你为什么不试试这种方式：

**用于显示键盘：**

```
InputMethodManager mgr = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
mgr.showSoftInput(inputEditText, InputMethodManager.SHOW_FORCED); 
```

**隐藏：**

```
InputMethodManager mgr = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
mgr.hideSoftInputFromWindow(inputEditText.getWindowToken(), 0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T09:33:40.557

我认为你的旗帜颠倒了：

从 Android[文档](http://developer.android.com/reference/android/view/inputmethod/InputMethodManager.html#toggleSoftInput%28int,%20int%29)中，该`toggleSoftInput`函数具有以下参数：

```
public void toggleSoftInput (int showFlags, int hideFlags) 
```

在您使用时，您正在使用 hideFlags 代替 showFlags：

```
inputMethodManager.toggleSoftInput(InputMethodManager.HIDE_IMPLICIT_ONLY, 0); 
```

尝试如下交换它们：

```
inputMethodManager.toggleSoftInput(0, InputMethodManager.HIDE_IMPLICIT_ONLY); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-10T19:59:22.037

作为最后的手段，您始终可以使用如下所示的 try catch 块来捕获异常：

```
 @Override
  public void onDestroy() 
  {
    try {
       if (adMob != null) 
       {
         // Destroy the AdView.
         adMob.destroy();
       }
    } catch (NullPointerException e) {
        e.printStackTrace(); //Or don't print it if you dont want.
    }

    super.onDestroy();
  } 
```

虽然，这不是最好的方法（也许是最不可取的），但它可以完成工作。既然你要退出活动，我不相信这会搞砸一些事情。

# ios - 缓存中的 localNotification.soundName

> ID：11376858
> 
> 赞同：0
> 
> 时间：2012-07-07T16:44:48.987
> 
> 标签：ios, caching, nsbundle, localnotification

是否可以从设备缓存中为 localNotification 分配声音名称？我试图从应用程序包中分配一个现有文件并且它工作正常。

我的应用程序将录制一个声音文件，它应该作为 localNotification.soundName 工作。我无法将此文件保存在应用程序包中，因此我想使用存储在缓存中的声音文件。

有人可以帮助我吗？

谢谢，朱利安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:31:19.367

不，文档在多个地方说本地通知声音和推送通知声音必须包含在二进制包中。[[资源]](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/IPhoneOSClientImp/IPhoneOSClientImp.html#//apple_ref/doc/uid/TP40008194-CH103-SW1)

# asp.net-mvc-3 - _Layout.cshtml 中的操作后返回当前视图

> ID：11376859
> 
> 赞同：1
> 
> 时间：2012-07-07T16:44:53.873
> 
> 标签：asp.net-mvc-3

我正在尝试围绕 MVC.NET 3。

我使用 a`_Layout.cshtml`作为基础（结构，导航）。作为布局的一部分，我想显示两个用于更改语言/本地化的链接。

无论查看哪个页面，这些都应该显示并可点击，并且在更改本地化后*我想重新加载调用 action 的视图*。因此，客户正在查看的页面将被重新加载，并设置新的本地化设置。

一种方法是在每个站点控制器中复制和粘贴更改本地化的操作，但没有更简单、更优雅的方法吗？

我尝试创建一个处理本地化更改的特定控制器，但无法弄清楚如何将查看器返回到前一个控制器。

也许这用jquery更容易完成？

这是带有语言更改按钮`DIV`的文件。`_Layout`它调用当前控制器中的动作，这意味着我必须在每个站点的控制器中定义它。（好在返回的视图总是正确的。）

```
<div id="top>
    @using (Html.BeginForm())
    {
        <button id="sv_flag" name="localization" title="@Resources.Global.Sv_Flag_Hover" value="sv-SE" />
        <button id="en_flag" name="localization" title="@Resources.Global.En_Flag_Hover" value="en-GB" />
    }
</div> 
```

我也尝试为此使用特定的控制器，但想不出我之后如何返回当前视图？像这样：

```
@using (Html.BeginForm("LocalizationAction", "LocalizationController"))
... 
```

**编辑** 现在使用 Darin 的建议，我从布局页面发送`controller`和值：`action`

```
@using (Html.BeginForm("SetLocalization", "Localization",
            new {   returnController = @ViewContext.Controller.ValueProvider.GetValue("controller").RawValue,
                    returnAction = @ViewContext.Controller.ValueProvider.GetValue("action").RawValue }))
... 
```

但我无法使本地化更改生效，我的控制器操作如下所示：

```
 public ActionResult SetLocalization(string localization, string returnController, string returnAction)
    {
        Thread.CurrentThread.CurrentCulture = Thread.CurrentThread.CurrentUICulture = CultureInfo.GetCultureInfo(localization);
        return RedirectToAction(returnAction, returnController);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T17:29:53.970

你可以传递一个 returnUrl：

```
@using (Html.BeginForm("LocalizationAction", "LocalizationController", new { returnUrl = Request.Url.AbsoluteUri }))
{
    ...    
} 
```

并在您`LocalizationAction`重定向到此网址的内部：

```
public ActionResult LocalizationAction(string returnUrl)
{
    ... do your localization stuff and once you are done get back:

    return Redirect(returnUrl);
} 
```

显然，您可以在盲目重定向之前进行一些检查。例如 returnUrl 参数是否不为空以及它是否属于您的域。您可以看看默认值如何在`AccountController`对用户进行身份验证后执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-23T13:24:15.567

> **返回重定向（Request.UrlReferrer.ToString（））；**

```
 public ActionResult Change(String LanguageAbbrevation)
    {
        if (LanguageAbbrevation != null)
        {
            Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(LanguageAbbrevation);
            Thread.CurrentThread.CurrentUICulture = new CultureInfo(LanguageAbbrevation);
        }

        HttpCookie cookie = new HttpCookie("Language");
        cookie.Value = LanguageAbbrevation;
        Response.Cookies.Add(cookie);

        return Redirect(Request.UrlReferrer.ToString());
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T19:07:48.330

我为我的问题找到了一个完全不同的（而且更简单、更优雅）的解决方案。

我只是创建了一个`BaseController`, 它包含更改本地化的操作。

然后我添加到站点的所有控制器都继承自 this `BaseController`。这为代码提供了一个位置，并且不需要发送任何返回参数等。

`BaseController`：

```
public class BaseController : Controller
{
    [HttpPost]
    public ActionResult Index(string localization)
    {
        Thread.CurrentThread.CurrentCulture = Thread.CurrentThread.CurrentUICulture = CultureInfo.GetCultureInfo(localization);
        return View();
    }
} 
```

然后每个站点`Controllers`只需要从它继承，然后注意自己的操作：

```
public class ApplicationsController : BaseController
{
    //
    // GET: /Applications/

    public ActionResult Index()
    {
        return View();
    }
}
... 
```

# c# - 枚举网络上的 Oracle 数据库

> ID：11376869
> 
> 赞同：1
> 
> 时间：2012-07-07T16:46:34.540
> 
> 标签：c#, oracle, tnsnames

我知道我可以使用以下代码枚举网络上的所有 SQL Server 实例：

```
 SqlDataSourceEnumerator instance = SqlDataSourceEnumerator.Instance;
 DataTable table = instance.GetDataSources(); 
```

但我想知道是否有办法为 Oracle 实例执行此操作。Oracle 的 ODP.NET (Oracle.DataAccess.Client) 支持 DataSourceEnuerator，但显然 System.Data.OracleClient 不支持。但是，DataSourceEnumerator 仅枚举在本地 TNSNames.ora 文件中找到的条目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T16:58:21.747

您所看到的是由于 SQL Server 和 Oracle 数据库如何宣布自己的根本差异。SQL Server（至少 2000 和 2005）使用[SQL Browser 服务](http://msdn.microsoft.com/en-us/library/ms165724%28v=sql.90%29.aspx)来通告网络上可用的数据库。另一方面，Oracle 要求您使用[TNS 条目](http://en.wikipedia.org/wiki/Transparent_Network_Substrate)显式枚举可用的实例。

这是*When in Rome*的一个实例，Oracle 正在尝试遵循 API。不幸的是，如果没有自定义代码，您将无法复制 SQL Server 行为。

# c++ - wxwidgets透明客户区

> ID：11376872
> 
> 赞同：0
> 
> 时间：2012-07-07T16:47:04.097
> 
> 标签：c++, wxwidgets, native-code, alpha-transparency

我已经寻找解决方案，但我没有找到任何解决方案。在本机 Win32 中，可以使框架窗口的客户区透明：

```
HWND hwnd = (HWND)GetHandle();
SetWindowLong(hwnd, GWL_EXSTYLE, GetWindowLong(hwnd, GWL_EXSTYLE) | WS_EX_LAYERED|WS_EX_TOOLWINDOW);
SetLayeredWindowAttributes(hwnd, RGB(255,255,255), 0, LWA_COLORKEY);
Refresh(); 
```

这也适用于 wxwidgets。它也使客户区透明。但现在 windows 窗体不可点击。我试图将此代码放在绘画事件方法“TestFrame::OnPaint(wxPaintEvent& event)”和方法“TestFrame::TestFrame(wxWindow* parent,wxWindowID id)”中。

我只需要使标题栏可点击即可移动窗口。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T18:23:46.830

将 Windows API 调用与 wxWidgets 代码混合使用可能是个坏主意。

你试过 wxWindow::SetTransparent (wxByte alpha) 吗？

[http://docs.wxwidgets.org/trunk/classwx_window.html#ac8cf4398cec50ac36634760f45a0656f](http://docs.wxwidgets.org/trunk/classwx_window.html#ac8cf4398cec50ac36634760f45a0656f)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T19:08:56.373

尝试

```
HWND hwnd = (HWND)GetHandle();
SetWindowLong(hwnd, GWL_EXSTYLE, GetWindowLong(hwnd, GWL_EXSTYLE) | WS_EX_LAYERED|WS_EX_TOOLWINDOW);
SetLayeredWindowAttributes(hwnd, RGB(255,255,0), 0, LWA_COLORKEY); 
```

并设置背景颜色=黄色

也许问题是您选择使用 rgb(255,255,255)。如果您使用 RGB(255,255,0)。有用。

# ios - 带有 NSOperation 和 NSOperationQueue iOS 的后台任务

> ID：11376873
> 
> 赞同：2
> 
> 时间：2012-07-07T16:47:06.010
> 
> 标签：ios, cocoa-touch, ios4

我想上传一些即使应用程序进入后台也应该继续的文件。

目前我正在从数据库中检索文件，然后通过 NSOperation 将其添加到队列中，然后启动上传过程。

即使应用程序进入后台或前台，也应上传所有文件。下面是单个任务的代码，任何人都可以给我一个提示，我们如何使它能够用于上传许多文件。

```
UIApplication* application = [UIApplication sharedApplication];
bgTask = [application beginBackgroundTaskWithExpirationHandler:^{
  // Clean up any unfinished task business by marking where you
  // stopped or ending the task outright.

  [application endBackgroundTask: bgTask];
  bgTask = UIBackgroundTaskInvalid;
}]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T09:17:16.390

如果您的应用程序遵循并满足必要条件，Apple 允许后台执行。 [请参考这里](https://stackoverflow.com/questions/3215502/continue-task-execution-in-background)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T23:49:10.957

为什么不尝试这样做呢？..我还没有尝试过，我会在尝试后发布更新

```
UIApplication* application = [UIApplication sharedApplication];
bgTask = [application beginBackgroundTaskWithExpirationHandler:^{
  // Clean up any unfinished task business by marking where you
  // stopped or ending the task outright.

  // Bring up your NSOperation queue instance here and block this thread until it is complete
  [queue waitUntilAllOperationsAreFinished];

  [application endBackgroundTask: bgTask];
  bgTask = UIBackgroundTaskInvalid;
}]; 
```

还要确保您有办法在后台取消所有这些长期存在的操作

```
 bgTask = [application beginBackgroundTaskWithExpirationHandler:^{
        // Clean up any unfinished task business by marking where you.
        // stopped or ending the task outright.
        [queue cancelAllOperations];

        [application endBackgroundTask:endSessionTask];
        bgTask = UIBackgroundTaskInvalid;
    }]; 
```

# c - 我应该使用哪个：C99 的 complex.h 库或“复数类型的 GNU 扩展”？

> ID：11376876
> 
> 赞同：3
> 
> 时间：2012-07-07T16:47:27.547
> 
> 标签：c, gcc, complextype

我喜欢“复数类型的 GNU 扩展”的语法，但我知道它不像 complex.h 那样是标准的。那么，我应该使用哪个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T17:18:43.367

这真的是一个对你来说最重要的问题。

*如果有一天您有可能*想要在除 gnu 之外的任何编译器上使用该代码，那么使用来自`<complex.h>`.

如果您有理由确定您只是针对 gnu 编译器，或者至少考虑到它们提供的语法改进值得您最终可能不得不重写代码，那么使用 gnu 扩展可能更有意义。 .

至少对我来说，这将归结为一个相当简单的情况：如果代码（甚至合理地）可移植，否则我也会遵循复杂类型的标准。如果代码使用了足够多的 gnu 扩展，否则移植到另一个编译器可能需要（几乎）完全重写，那么如果您更喜欢 gnu 扩展，则不妨使用它们。

我还应该补充一点，移植并不是唯一的考虑因素，但它们都可以协同工作。可读性的工作方式几乎相同——如果你使用了足够多的 gnu 扩展，以至于有人非常需要了解 gnu 扩展来阅读代码，那么使用他们的扩展来处理复杂的代码不会有一点损失。如果代码足够标准以至于有人可以阅读它，那么仅为复杂而添加专有扩展可能不是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T21:40:09.500

任何一个都会导致可移植性问题。您必须根据需要代码使用的编译器集来决定。

`<complex.h>`当然，C99是标准语言的一部分——但并非所有编译器都支持 C99。特别是，微软表示他们不打算支持 C99 或任何更高版本的标准，除了那些恰好存在于 C++ 中的功能。（C++ 支持复数，但作为一个库，而不是像 C99 那样的内置类型集。）

另一方面，gcc 扩展仅适用于 gcc，或与 gcc 充分兼容的编译器。

我怀疑这`<complex.h>`将比 gcc 扩展更便携；您将无法将 Microsoft 的编译器与任何一个一起使用，但任何支持 C99 的实现都将支持`<complex.h>`.

（另一种选择是使用 C++ 而不是 C，并使用 C++ 的`<complex>`.）

# login - 如何让googlebot在登录后访问页面

> ID：11376879
> 
> 赞同：0
> 
> 时间：2012-07-07T16:47:53.427
> 
> 标签：login

已经搜索过网络和此处，但仍在寻找允许 Googlebot 访问我登录后页面的可靠答案。

有没有安全的方法来做到这一点？

我已经通过 Adsense 添加了登录允许，但希望进一步超越仅允许包含 Adsense 内容的页面。

我收到报告说 238 个页面存在访问被拒绝错误。

希望能得到一些帮助。

亲切的问候克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T22:47:11.193

如果两种情况都匹配，如何检查 ip（是否以 66.249.* 开头）和用户代理（Googlebot）并提供授权页面？

# django - Django 用户过滤

> ID：11376885
> 
> 赞同：0
> 
> 时间：2012-07-07T16:48:48.080
> 
> 标签：django, authentication

我希望能够有效地找到具有特定权限的所有用户，然后在这些用户中找到具有特定标志的所有用户（我扩展了基本`User`模型并创建了自己的具有标志的用户）。我想知道最简单/有效的方法是什么？我正在阅读以下内容（在其他网站中）：

[如何在 django Guardian 中获取用户具有特定权限的所有对象？](https://stackoverflow.com/questions/4663694/how-can-i-get-all-objects-a-user-has-specific-permissions-to-in-django-guardian)

但他们似乎对我的情况没有帮助。如果有遗漏的文章请告诉我，谢谢！

**[编辑]**

我阅读了以下页面：

[http://digitaldreamer.net/blog/2010/5/10/get-all-users-group-django/](http://digitaldreamer.net/blog/2010/5/10/get-all-users-group-django/)

基本上我想获得所有具有特定权限和具有特定标志的用户。现在我可以做：根据我的代码`User.objects.filter(organization_id = id)`让所有用户都在一个特定的范围内。`organization`但在该列表中，我想要所有具有特定权限的用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:51:17.477

我问了一个与 django-guardian 相关的问题，经过大量研究后自己回答了。我相信你应该可以在这里找到答案：[Django Groups and Permissions。扩展组以拥有 FK？](https://stackoverflow.com/questions/11095296/django-groups-and-permissions-extending-groups-to-have-a-fk/11325519#11325519)

**更新**

你可以这样做：

```
user_list = []
for user in User.Objects.filter(organization_id=id):
    if user.has_perm('PERM NAME'):
        user_list.append(user) 
```

有关详细信息，请参阅此链接：[http ://packages.python.org/django-guardian/userguide/check.html](http://packages.python.org/django-guardian/userguide/check.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T17:58:08.663

你可以按照上面说的来做。但是通过链接过滤器语句，它也是可能的。我提到了另一个问题：[How to get a list of all users with a specific permission group in Django](https://stackoverflow.com/questions/378303/how-to-get-a-list-of-all-users-with-a-specific-permission-group-in-django)。通过链接这两个过滤器语句，我可以让所有用户都拥有权限，所有用户都拥有`organization_id`.

# php - 当它应该返回true时，方法一直返回false？

> ID：11376891
> 
> 赞同：0
> 
> 时间：2012-07-07T16:49:30.577
> 
> 标签：php, class, methods, return

我有一种方法可以检查缩略图是否可以上传。由于某种原因，它在调用程序中返回 false。

图像文件在正确的大小、尺寸、文件类型方面完全符合我为其设置的要求，并且文件中没有错误。

这是`print_r()`图像文件的：

```
imageArray ( [file] => Array ( [name] => juliensbook2slide.jpg [type] => image/jpeg [tmp_name] => C:\Users\chris\AppData\Local\Temp\php5A99.tmp [error] => 0 [size] => 20590 ) ) 
```

下面是方法代码：

```
public function checkThumb(){
        $this->temp_dir = $_FILES['file']['tmp_name'];
        $this->image_type = $_FILES['file']['type'];
        $this->image_size = $_FILES['file']['size'];
        $this->image_name = $_FILES['file']['name'];
        $this->image_error = $_FILES['file']['error'];
        @$this->image_dimensions = getimagesize($this->temp_dir);
        $this->image_width = $this->image_dimensions[0]; // Image width
        $this->image_height = $this->image_dimensions[1]; // Image height
        $this->path = '';
        $this->error = '';
        if(!empty($this->image_name) && $this->image_error == 0){

            $this->path = 'img/thumb_/'.$this->random_name. $_FILES['file']['name'];

            if(in_array($this->image_type, $this->allowed_type)){

                if($this->image_size <= $this->max_size){

                    if(($this->image_width < $this->max_width) && $this->image_height < $this->max_height){

                        return true;

                    }else{
                        return $error = 'ERROR: Image dimension must be no larger than 4050x4050';
                    }

                }else{
                    return $error = 'ERROR: Image size must be no larger than 5MB';
                }
            }else{
                return $error = 'ERROR: image must be .jpg, .gif, .png only.';
            }
        }else {
            return false;
        }
    } 
```

这是它没有移动上传的图像的代码，因为它返回错误：

```
if($register->checkThumb){
                //send image to permanent image directory
                $register->moveUploadedImage();

                //if the thumbnail failed validation put the error message in variable
            }else if(is_string($register->checkThumb())){
                $message = $register->checkThumb();

            }
                print_r($_FILES);
                //put record of user into database
                $register->convertSex();
                $register->insertIntoDB($thumb);
} 
```

那么为什么它返回错误呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:51:55.483

您没有调用该方法。方法名称后没有圆括号。所以基本上你正在检查是否设置了名为 checkThumb 的属性。

就像在`$register->checkThumb`vs. `$register->checkThumb()`.

这应该有效：

```
if($register->checkThumb()){  //send image to permanent image directory
    $register->moveUploadedImage();
}  //if the thumbnail failed validation put the error message in variable
else if(is_string($register->checkThumb())) {
    $message = $register->checkThumb();
} 
```

但我建议不要调用相同的方法 3 次，所以我会使用以下内容：

```
$checked_thumb = $register->checkThumb();
if($checked_thumb){  //send image to permanent image directory
    $register->moveUploadedImage();
}  //if the thumbnail failed validation put the error message in variable
else if(is_string($checked_thumb)) {
    $message = $checked_thumb;
} 
```

# html - 我怎样才能有两列的组合宽度为 100% ？

> ID：11376896
> 
> 赞同：0
> 
> 时间：2012-07-07T16:50:04.220
> 
> 标签：html, css

他们说，一张图片可以解释更多的词，所以这是我的“更多”：[http ://www.imagebanana.com/view/hcqsz5fs/cols.png](http://www.imagebanana.com/view/hcqsz5fs/cols.png)

我的目标是使列如图所示，它们一起具有 100% 的体宽。

我的小提琴在这里：http: [//jsfiddle.net/c2JH3/](http://jsfiddle.net/c2JH3/)（请注意，这只是我当前工作的模型）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:30:32.980

我不知道如何使用小提琴。但这对我来说效果很好。我只是使用背景颜色和边框来正确显示差异

```
<!doctype html>
<html>
<head>
    <title>xxx</title>
    <style>
        body{
            margin: 0;
        }
        #wrap {
            width: 100%;
        }
        #left {
            width: 600px;
            float: right;
            border: 1px solid #000000;
        }
        #right {
            width: 350px;
            border: 1px solid #000000;
        }
        #container_left {
            width: 55%;
            float: left;
            background: red;
        }
        #container_right {
            width: 45%;
            float: right;
            background: blue;
        }
    </style>
</head>
<body>
    <div id="wrap">
    <div id="container_left">
        <div id="left">
            <p>Content</p>
        </div>
    </div>
    <div id="container_right">
        <aside id="right">
            <p>Sidebar</p>
        </aside>
    </div>
</div>
</body> 
```

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T17:47:01.033

## 速记

在您的评论中，您说您不能使用背景图片，因为高度是可变的。

解决此问题的方法是使用多个图像，并告诉它们在页面的不同部分重复或不重复。但是，在我直接回答您的问题后，我会讨论这个问题。

## 简答

要获得 100% 的身体宽度，您需要`%`在规则中使用百分比 ( ) `width`。像这样：

```
#left {
  width: 60%;
}

#right {
  width: 40%;
} 
```

## 解决一些问题

当您的内容通过屏幕底部时，您一定会遇到一个问题。在这种情况下，您需要告诉他们`divs`并排。

这应该可以解决问题：

```
#left {
  position: absolute;
    top: 0;
    left: 0;
  width: 60%;
}

#right {
  position: absolute;
    top: 0;
    right: 0;
  width: 40%;
} 
```

## 回到笔记

相信我，您不想在宽度上使用百分比。它使得尺寸和缩放很难很好地设计，如果不完全重新设计你的 css，你将来尝试做出的改变可能不会奏效。

就像我之前说的，你想使用多个图像。您将在`body`标签上有背景图像 - 按照您提供的设计 - 有*灰色到橙色的*淡入淡出。CSS看起来像这样：

```
body {
  background-image: url('path/to/header.jpg') no-repeat;
} 
```

然后，您将拥有一个包装器 div，就像您已经拥有的那样，它包含内容等。在包装器内你有：

*   A `header`（标志和导航栏），没有背景（所以你可以看到`body`背景）。

*   一个`featured`部分在中间拥有那个非常大的图像。您可以使用负边距使其居中。

*   中间那些图像的`subnav`部分。这将有它自己的背景图像，该图像具有背景的匹配部分，`body`因此它看起来像图像一样流入。

*   `content`包含页面所有内容的部分。这将使图像垂直重复以看起来连续。

    ```
    #content {
      background-image: url('path/to/slice.jpg') repeat-y;
    } 
    ```

*   具有`subfooter`页面弯曲部分的部分（底部的*灰色到橙色曲线）。*

*   最后是一个`footer`包含所有内容的部分。

您可以在内页上使用相同的结构，只需使用不同的图像和间距来改变页面的外观。

## 总结一下

你**永远**不需要`100%`为你的 wrapping 设置一个宽度`div`。（我这样说是为了概括，有些风格使用了这个，但它们不是同一种设计）。

您应该始终首先*尝试*为创建所需外观的`body`、`header`、`content`和`footer`部分创建图像。

然后让您`wrap`设置一个**像素**宽度，该宽度将保持在页面的中心，而边距会增加并显示更多的背景图像。

祝您设计愉快，祝您好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T19:05:22.833

谢谢大家的回答和想法。他们很有帮助，我确实学到了一些新东西（我最大的“谢谢”去@Jon 写了一个非常棒的帖子）。但是，由于我既不能用百分比也不能用背景来解决这个问题（因为我的设计比提供的要复杂一些），所以我用 jQuery 来解决这个问题。总而言之，这是我的[模型小提琴](http://jsfiddle.net/RayNn/1/)。

注意：有时您需要将 left 更改`125`为`126`，以确保两端相遇。

# python - 在 matplotlib 中动画 3d 散点图

> ID：11376898
> 
> 赞同：12
> 
> 时间：2012-07-07T16:50:32.500
> 
> 标签：python, matplotlib

我正在尝试在 matplotlib 中获取散点图的 3d 动画，基于此处发布的 2d 散点图动画和此处发布[的](http://matplotlib.sourceforge.net/examples/animation/simple_3danim.html)[3d](https://stackoverflow.com/questions/9401658/matplotlib-animating-a-scatter-plot)线图。

问题出现在 3D 中`set_data`并且`set_offsets`不能在 3D 中工作，因此您应该使用`set_3d_properties`来附加 z 信息。玩弄它通常会窒息，但它会运行下面发布的代码。但是，透明度增加得足以使点在几帧后消失。我在这里做错了什么？我希望这些点在框的范围内跳跃一段时间。即使将步长调整到非常小的值也不会减慢透明度。

```
import matplotlib.pyplot as plt
import matplotlib.animation as animation
import numpy as np
from mpl_toolkits.mplot3d import Axes3D

FLOOR = -10
CEILING = 10

class AnimatedScatter(object):
    def __init__(self, numpoints=5):
        self.numpoints = numpoints
        self.stream = self.data_stream()
        self.angle = 0

        self.fig = plt.figure()
        self.ax = self.fig.add_subplot(111,projection = '3d')
        self.ani = animation.FuncAnimation(self.fig, self.update, interval=100, 
                                           init_func=self.setup_plot, blit=True)

    def change_angle(self):
        self.angle = (self.angle + 1)%360

    def setup_plot(self):
        x, y, z = next(self.stream)
        c = ['b', 'r', 'g', 'y', 'm']
        self.scat = self.ax.scatter(x, y, z,c=c, s=200, animated=True)

        self.ax.set_xlim3d(FLOOR, CEILING)
        self.ax.set_ylim3d(FLOOR, CEILING)
        self.ax.set_zlim3d(FLOOR, CEILING)

        return self.scat,

    def data_stream(self):
        data = np.zeros((3, self.numpoints))
        xyz = data[:3, :]
        while True:
            xyz += 2 * (np.random.random((3, self.numpoints)) - 0.5)
            yield data

    def update(self, i):
        data = next(self.stream)
        data = np.transpose(data)

        self.scat.set_offsets(data[:,:2])
        #self.scat.set_3d_properties(data)
        self.scat.set_3d_properties(data[:,2:],'z')

        self.change_angle()
        self.ax.view_init(30,self.angle)
        plt.draw()
        return self.scat,

    def show(self):
        plt.show()

if __name__ == '__main__':
    a = AnimatedScatter()
    a.show() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-12T09:33:41.150

终于找到了解决方案，这里是如何更新没有触摸颜色的点：

```
from mpl_toolkits.mplot3d.art3d import juggle_axes
scat._offsets3d = juggle_axes(xs, ys, zs, 'z') 
```

这是由 set_3d_properties 内部完成的以及重新初始化颜色

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-05T07:05:19.607

我找到了这个更通用的解决方案：`np.ma.ravel( x_data ) ...`在将数据插入集合之前，您应该添加。

但是散点图似乎不适用于动画；它太慢了。

```
import matplotlib.pyplot as plt
import matplotlib.animation as animation
import numpy as np
from mpl_toolkits.mplot3d import Axes3D

FLOOR = -10
CEILING = 10

class AnimatedScatter(object):
    def __init__(self, numpoints=5):
        self.numpoints = numpoints
        self.stream = self.data_stream()
        self.angle = 0

        self.fig = plt.figure()
        self.ax = self.fig.add_subplot(111,projection = '3d')
        self.ani = animation.FuncAnimation(self.fig, self.update, interval=100, 
                                           init_func=self.setup_plot, blit=True)

    def change_angle(self):
        self.angle = (self.angle + 1)%360

    def setup_plot(self):
        X = next(self.stream)
        c = ['b', 'r', 'g', 'y', 'm']
        self.scat = self.ax.scatter(X[:,0], X[:,1], X[:,2] , c=c, s=200, animated=True)

        self.ax.set_xlim3d(FLOOR, CEILING)
        self.ax.set_ylim3d(FLOOR, CEILING)
        self.ax.set_zlim3d(FLOOR, CEILING)

        return self.scat,

    def data_stream(self):
        data = np.zeros(( self.numpoints , 3 ))
        xyz = data[:,:3]
        while True:
            xyz += 2 * (np.random.random(( self.numpoints,3)) - 0.5)
            yield data

    def update(self, i):
        data = next(self.stream)
        data = np.transpose(data)

        self.scat._offsets3d = ( np.ma.ravel(data[:,0]) , np.ma.ravel(data[:,0]) , np.ma.ravel(data[:,0]) )

        self.change_angle()
        self.ax.view_init(30,self.angle)
        plt.draw()
        return self.scat,

    def show(self):
        plt.show()

if __name__ == '__main__':
    a = AnimatedScatter()
    a.show() 
```

# bash - 在 MSYS 中浏览文件夹

> ID：11376899
> 
> 赞同：116
> 
> 时间：2012-07-07T16:50:37.370
> 
> 标签：bash, msys

这将是当天最棘手的问题。如何在 MSYS shell 中浏览我的 Windows 文件夹结构？当我启动 shell 时，我看到的只是一个“~”。我输入“ls”，文件夹为空。我只想知道怎么去我的c盘。

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2012-07-07T16:54:19.083

`cd /c/`访问 C：

`cd /d/`对于 D：

等等

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-11-10T13:03:26.077

用于`df`查看所有挂载点，以便您导航到它们。我的`df`输出如下所示：

```
 Filesystem           1K-blocks      Used Available Use% Mounted on
C:\Users\Sam\AppData\Local\Temp
                      76694276  46239412  30454864  61% /tmp
C:\MinGW\msys\1.0     76694276  46239412  30454864  61% /usr
C:\MinGW\msys\1.0     76694276  46239412  30454864  61% /
C:\MinGW\build32      76694276  46239412  30454864  61% /build32
C:\MinGW\build64      76694276  46239412  30454864  61% /build64
C:\MinGW\local32      76694276  46239412  30454864  61% /local32
C:\MinGW\local64      76694276  46239412  30454864  61% /local64
C:\MinGW\mingw32      76694276  46239412  30454864  61% /mingw32
C:\MinGW\mingw64      76694276  46239412  30454864  61% /mingw64
C:\MinGW\opt          76694276  46239412  30454864  61% /opt
C:\MinGW\src          76694276  46239412  30454864  61% /src
c:                    76694276  46239412  30454864  61% /c
d:                    62471380  33791832  28679548  55% /d
e:                   163839996 129349800  34490196  79% /e
f:                   266237948 222816904  43421044  84% /f
g:                   407410152 346169248  61240904  85% /g
h:                    65328288  22612768  42715520  35% /h
i:                   122881152  54066728  68814424  44% /i
j:                   409601240 176372780 233228460  44% /j
k:                   378949628  56153980 322795648  15% /k 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-07-07T16:54:09.150

您的`C:`驱动器`/c`由 MinGW 自动安装，只需输入`cd /c`即可。

# android - 如何检测 Android 应用程序是否在韩国使用？

> ID：11376905
> 
> 赞同：12
> 
> 时间：2012-07-07T16:51:25.823
> 
> 标签：android, localization, google-play, iso, country-codes

我在 Google Play 商店中有一款游戏，可以选择将评分系统从积分更改为 $'s。显然这是在韩国模拟赌博和非法行为。我收到了 Google 的正式谴责，他们将我的应用从韩国市场撤下，并将我的成熟度评级提高到“成熟”。尽管许多用户喜欢它，但这个额外的功能对于游戏来说是完全没有必要的。我只想在韩国禁用它。但是我需要一些可靠的方法。

我虽然关于使用语言环境，但用户可以改变它。

```
context.getResources().getConfiguration().locale.getDisplayCountry(Locale locale); 
```

我找到了这个：

```
android.telephony.TelephonyManager.getNetworkCountryIso() 
```

国家 ISO 能保证是正确的吗？有没有我忽略的不同方法？

另外，我的应用没有 GPS 权限。我认为只为这个用例启用它是错误的。此外，我还考虑过多个 APK。这将是最后的手段。我相信它们会被视为两个独立的应用程序。我不会有我所有的好收视率和下载。

希望如果我能完成这项工作，我可以让谷歌重新考虑他们的决定。

编辑：@Nobu Games 提出了一个很好的观点。这也需要适用于平板电脑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T16:53:29.213

```
android.telephony.TelephonyManager.getNetworkCountryIso() 
```

**绝对地**

我认为语言环境选项不好，因为可以手动更改语言环境，有一个应用程序可以做到。

我试过一次。用于测试我的应用程序的多语言支持。

这个[答案](https://stackoverflow.com/a/3659841/519718)可以帮助你更多。

# asp.net - Chrome 网络标签中的延迟测量

> ID：11376912
> 
> 赞同：13
> 
> 时间：2012-07-07T16:52:38.147
> 
> 标签：asp.net, ajax, google-chrome

我正在本地机器上运行我的应用程序，并且正在从 Chrome 发出 ajax 请求。当我提出请求时，我看到网络选项卡在时间列中显示 2 个数字。

![在此处输入图像描述](../Images/424678ba65e89a2707a94d643da43112.png)

我应该如何解释这些数字？该应用程序正在进行数据库调用，然后在将数据发送到客户端之前对其进行处理。在第一行，它显示 133/106；这是否意味着一旦请求到达本地机器只需要 27ms 在服务器上处理？

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-13T17:07:01.730

延迟，即发出请求和服务器第一次响应之间的时间，在每个条形图中以较浅的阴影显示。

106ms 是延迟。133 毫秒是时间。27ms 是接收数据时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-27T08:14:08.440

看看 chrome 网络选项卡[时间线视图](https://developers.google.com/chrome-developer-tools/docs/network#resource_network_timing)。

*等待*是等待服务器初始响应所花费的时间。*接收*是接收响应数据所花费的时间。所以，大致上，

*   延迟=等待
*   时间 = 等待 + 接收

# asp.net - 从 asp:menu 数据源排序项目

> ID：11376921
> 
> 赞同：0
> 
> 时间：2012-07-07T16:54:27.437
> 
> 标签：asp.net, xml

*我无法在其他地方找到答案。*

我制作了一个 XML 文件，我倾向于将其用作我的站点导航提供程序。
在这个 XML 中，我为导航元素添加了一个名为“Position”的属性。

`<asp:Menu />`如何按 Position 属性的升序对提供给我的控件的项目进行排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:30:06.063

找到我的答案：

> XMLDataSource 控件不支持排序和分页

# android - MapView / MapActivity 崩溃 onBackPressed 由 Child Activity

> ID：11376922
> 
> 赞同：0
> 
> 时间：2012-07-07T16:54:37.117
> 
> 标签：android, android-mapview, mapactivity

我正在尝试创建一个信息活动，它在谷歌的 MapView 上显示一个位置等。每当我浏览此 MapActivity，然后单击后退按钮时，我都会收到以下错误：

“...引起：java.lang.IllegalStateException：您只能在 MapActivity 中拥有一个 MapView...”

你应该知道的事情！：

onResume 调用我的 setUpDisplay，它在 LinearLayout 中初始化我的 MapView：

...

```
 List<Address> geoResults = geocoder.getFromLocationName(formalAddress, 1);
    while (geoResults.size()==0) 
    {
        geoResults = geocoder.getFromLocationName("empire state building", 1);
    }
    if (geoResults.size()>0) 
    {
        point= new GeoPoint( (int) (geoResults.get(0).getLatitude() * 1E6), (int) (geoResults.get(0).getLongitude() * 1E6));
    }
    mapView = new MapView(this, "YOU-NO-GET-TO-SEE-MY-KEY-HERE!");

    MapController mapController = mapView.getController();

    mapController.animateTo(point);
    mapController.setZoom(15);

               myMainLinearLayout.addView(mapView); 
```

...

我还确保在我重写的 onPause() 上调用 myMainLinearLayout.removeAllViews()，并将变量设置为 null，以确保所有事情都得到清理。

我还尝试查看在 mapView 初始化之前是否 mapView == null ——它永远不会。有人有想法么？

提前致谢。-伊森

- - - - 编辑：

这是我在我的 onPause 方法中所做的，在我的 MapActivity 中

```
@Override
public void onPause()
{//CLEANUP
    super.onPause();
    myMainLinearLayout.removeAllViews();
    myMainLinearLayout= null;
    mapView = null;
} 
```

这是除了 onResume() 之外我要覆盖的唯一方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:08:04.940

这篇文章应该会有所帮助：

[您只能在 MapActivity 中拥有一个 MapView](https://stackoverflow.com/questions/5216046/you-are-only-allowed-to-have-a-single-mapview-in-a-mapactivity)

摘要：不要破坏你以前的 MapView。在 onCreate 中将其实例化一次，并在需要时直接对其进行修改。

# android - Android：画布绘图、drawARGB和drawColor

> ID：11376924
> 
> 赞同：0
> 
> 时间：2012-07-07T16:54:41.240
> 
> 标签：android, canvas, live-wallpaper, ondraw

小问题：

我用我制作的可运行文件制作了动态壁纸。为什么当我尝试在画布上使用白色或任何颜色的 .drawARGB 或 .drawColor 时，它会显示片刻然后在整个屏幕上变回黑色？

但是当我用 .drawLine 画线时，它们会留在那里，就好像已经打印了一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T14:51:11.190

尝试使用禁用硬件加速

```
<application android:hardwareAccelerated="false"> 
```

# php - 为函数参数指定对象类型？

> ID：11376925
> 
> 赞同：0
> 
> 时间：2012-07-07T16:55:13.163
> 
> 标签：php, oop, function

我刚刚使用 php 进入 OOP，几乎偶然发现，如果我将对象类型放在函数定义中的名称之前，那么我正在使用的 IDE 可以解析对象的成员函数和数据成员。

例如：

`public function foo(car $car) { }`

相对于：

`public function foo($car) { }`

第一种方法是否合法且首选？

感谢您帮助菜鸟:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T16:56:55.297

绝对：[键入 Hinting](http://php.net/language.oop5.typehinting)。那是 PHP 本身的一个特性，而 IDE 只是为您提供更有用的代码完成功能。试一试并传递错误类型的对象。这将帮助您更早地找到由于传递给方法的错误类型而导致的错误。

```
class A{}
class B{}
function foo(A $a) { echo "OK";}
foo(new A);
foo(new B); 
```

你也应该看看文档评论（对不起，没有链接）。大多数 IDE 也能够阅读并使用它们来获得额外的代码完成建议。

```
/**
 * @return MyObject
 */
function bar(){/* ..*/};
bar()->[Strg-Space] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T17:15:33.843

实际上，最好的做法是提示[接口](http://php.net/manual/en/language.oop5.interfaces.php)，而不是特定的类名。这可以追溯到面向对象应用程序设计中的[接口隔离原则](http://en.wikipedia.org/wiki/Interface_segregation_principle)。

这意味着，当您注入一个对象时，您应该期望该对象具有特定的方法足迹，然后您可以对其进行调用。这就是多态性的工作原理。

# php - PHP如何写一个模板引擎？

> ID：11376927
> 
> 赞同：1
> 
> 时间：2012-07-07T16:55:30.663
> 
> 标签：php, string, templates, token

## 编辑：也许我应该把这部分说清楚。用户正在编写模板。所以我希望语法简单，我不能相信他们有强大的模板引擎。

所以，我需要一个模板引擎，用于编写电子邮件，使用令牌（简单）和条件逻辑（不太容易）。

例子：`Hello{if first_name} dear {first_name}{endif}, blah blah blah.`

如果 first_name 不可用，则应为：`Hello, blah blah blah.`

我能够使用 eval 让它工作......但我们都知道 eval 是邪恶的。

```
$body = preg_replace('/{if ([^{\|}]+)}/i', '<?php if(isset(\$tokens[\'$1\'])):?>', $body);
$body = preg_replace('/{endif}/i', '<?php endif;?>', $body); 
```

谁能指点我这个教程？除了简单的令牌替换，我似乎找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T13:09:37.567

如上所述，我会为此使用 Mustache.js，它应该可以完成您需要的一切。如果您想要的只是“令牌替换和条件逻辑”，Mustache 可用于同时提供：

**令牌替换**

```
Hello {{first_name}} 
```

**条件逻辑**

尽管 Mustache.js 将自己标榜为“无逻辑”，

> 我们称其为“无逻辑”，因为没有 if 语句、else 子句或 for 循环。

您可以在控制器中做出基于逻辑的决策，然后将这些决策传递给视图——请参阅[如何在 mustache.js 中完成 if/else？](https://stackoverflow.com/questions/6027525/how-do-i-accomplish-an-if-else-in-mustache-js). 所以，在你的情况下，这样的事情应该有效：

```
function( view ){

   if ( logged_in ) {
     var user = {
       first_name: "Jane",
       last_name: "Doe"
     };
   } else {
     var user = {
       first_name: "Buddy"
     };
   }

   // more template stuff...

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T15:00:08.900

使用大家的评论，我能够弄清楚如何使用自定义语法快速制作我自己的安全模板引擎。

假设如果设置了 first_name 变量，我想将`{first_name|buddy}`其设为变量，但如果未设置，则使用字符串“buddy”作为默认值。

使用强大的模板引擎，例如 Smarty。Smarty 对此有支持，但我不喜欢这种语法`{$first_name|default:"buddy"}`

用正确的语法替换所有出现的自定义语法

```
preg_replace('/{([\w\s]+)\|([\w\s]+)}/', '{\$$1|default:"$2"}', $content); 
```

然后通过 Smarty 运行它。这与使用 eval 基本相同，但安全。多谢你们。

# asp.net-mvc - 在 MVC 中使用带有 viewModel 的 TextBoxFor 的问题

> ID：11376935
> 
> 赞同：5
> 
> 时间：2012-07-07T16:56:40.350
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, viewmodel, html.textboxfor

我最近开始使用 viewModel。这是我正在使用的视图模型：

```
public class ContentViewModel
    {
        public Content Content { get; set; }
        public bool UseRowKey { 
            get {
                return Content.PartitionKey.Substring(2, 2) == "05" ||
                   Content.PartitionKey.Substring(2, 2) == "06";
            }
        }
        public string TempRowKey { get; set; }

    } 
```

我改变了我的剃刀观点：

```
@model WebUx.Content

<div class="colx2-left">
    <label for="complex-fr-url" class="required">Order</label>
    @Html.TextBoxFor(model => model.Order)
</div> 
```

至：

```
@model WebUx.Areas.Admin.ViewModels.Contents.ContentViewModel

<div class="colx2-left">
    <label for="complex-fr-url" class="required">Order</label>
    @Html.TextBoxFor(model => model.Content.Order)
</div> 
```

现在我的观点因以下消息而失败：

> 编译器错误消息：CS0411：方法 System.Web.Mvc.Html.InputExtensions.TextBoxFor TModel,TProperty> 的类型参数（System.Web.Mvc.HtmlHelper<TModel>，System.Linq.Expressions.Expression<System.Func< TModel,TProperty>>) 不能从用法中推断出来。尝试明确指定类型参数。

有人可以给我建议我应该做什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T01:44:40.467

根据经验，我确保我的视图/模板只引用它正在处理的模型中的一个属性，而不是下面的一个。

您在更改之前的第一次尝试是正确的。

因此，我会将您的视图更改为以下内容：

```
@model WebUx.Areas.Admin.ViewModels.Contents.ContentViewModel
@Html.EditorFor(model => model.Content) 
```

并利用您现有的模板：

```
@model WebUx.Content
<div class="colx2-left">
    <label for="complex-fr-url" class="required">Order</label>
    @Html.TextBoxFor(model => model.Order)
</div> 
```

我也不知道是什么`Order`。如果它不是一个字符串，那么这也将是一个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-29T21:42:16.207

确保`Order`是 上的*公共*财产`Content`。现在我在实现[POC](http://en.wikipedia.org/wiki/Proof_of_concept)应用程序时遇到了这个异常。你猜怎么着？我忘记在我的 ViewModel 属性前面添加[公共说明符。](http://msdn.microsoft.com/en-us/library/h05xxt5d.aspx)

我有这个：

```
public class UserViewModel
{
    [StringLength(16)]
    string Name { get; set; }

    [Range(18, 65)]
    int Age { get; set; }
} 
```

然后在这里抛出了同样的异常。

我这样做是为了解决问题：

```
public class UserViewModel
{
    [StringLength(16)]
    public string Name { get; set; }

    [Range(18, 65)]
    public int Age { get; set; }
} 
```

# android - 在 Mac 上为 Android 应用设置 Trigger.io 时出错

> ID：11376941
> 
> 赞同：2
> 
> 时间：2012-07-07T16:57:17.603
> 
> 标签：android, macos, trigger.io

我刚开始在我的 Mac 上使用 Trigger.io。不幸的是，我在设置测试 Android 应用程序时遇到了错误。我能够构建一个 Web 应用程序，但是在为 android 构建时出现以下错误。

[错误] 失败：错误：目标 ID 无效。使用 'android list targets' 获取目标 ID。

我的 andriod sdk 在 /Applications/android-sdk-macosx 中，应该可以工作。

如果有人可以提供帮助，将不胜感激，

多谢你们，

kSeudo。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T18:28:52.610

我们以前曾见过这个问题，并试图深入了解特定设置是如何导致它的——它不会影响所有用户。

目前的解决方法是使用实​​际设备进行测试，或者在使用“forge run android”之前手动创建和启动 AVD。您可以使用 AVD 管理器创建 AVD。要打开它，请在命令行中运行“android”并选择“工具”->“管理 AVD”。这里有进一步的说明：

[http://developer.android.com/tools/devices/managing-avds.html](http://developer.android.com/tools/devices/managing-avds.html)

# vba - 获取同一行的第一列

> ID：11376942
> 
> 赞同：0
> 
> 时间：2012-07-07T16:57:27.877
> 
> 标签：vba, excel, find, row

如何使用 vba 在 Excel 工作表中找到第一列相同的行？

我写了一个宏来在单元格中查找一个单词，我需要将一条消息放入同一行的第一列。

此致

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T16:59:07.223

```
Sheets("Sheet1").Cells(aCell.Row,1) 
```

`aCell`您搜索的单词的范围在哪里

或者，您也可以使用此

```
Sheets("Sheet1").Range("A" & aCell.Row) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T08:13:22.883

```
aCell.Offset(0, -aCell.Column + 1).Value = "This is my message." 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T14:13:44.580

为避免需要知道工作表名称，请使用

```
aCell.EntireRow.Cells(1,1) 
```

# c# - 在.net 4下使用带有城堡的压缩器和捆绑器

> ID：11376943
> 
> 赞同：0
> 
> 时间：2012-07-07T16:57:36.913
> 
> 标签：c#, .net, c#-4.0, .net-4.0, castle

我已经尝试了 squshit 和 rejuicer 来尝试从视图中组合和缩小一些 css 和 js。到目前为止还没有运气。我所做的是在我放置的过滤器中

```
#region using
    using System;
    using Castle.MonoRail.Framework;
    using campusMap.Models;
    using MonoRailHelper;
    using Rejuicer;
#endregion

namespace campusMap.Filters
{
    public class scriptFilter : IFilter
    {
        public bool Perform(ExecuteWhen exec, IEngineContext context, IController controller, IControllerContext controllerContext)
        {
            controllerContext.PropertyBag["adminRejuicer_css"] = OnRequest.ForCss("~/Content/css/min/Combined.css").Compact;
            controllerContext.PropertyBag["adminRejuicer_js"] = OnRequest.ForJs("~/Content/js/min/Combined.js");
            //controllerContext.PropertyBag["JavaScriptBundle"] = new JavaScriptBundle();
            return true;
        }
    }
} 
```

然后在基本控制器上

```
#region Directives
    using Castle.MonoRail.Framework;
    using campusMap.Services;
    using System.Text.RegularExpressions;
    using System;
    using campusMap.Models;
    using Castle.ActiveRecord;
    using MonoRailHelper;
    using campusMap.Filters;
    using log4net;
    using log4net.Config;
    using System.Text;

#endregion
namespace campusMap.Controllers
{
    [Filter(ExecuteWhen.BeforeAction, typeof(scriptFilter))]
    [Layout("default"), Rescue("generalerror")]
    public abstract class BaseController : MonoRailHelper.HelperBaseController
    {
    } 
```

然后最后从视图中

```
 $adminRejuicer_css.File("~/Content/css/admin_styles.css").File("~/Content/js/colorpicker/css/jpicker-1.1.6.min.css") 
```

但什么都没有。如果我对 ssushit 做基本相同的事情，但在过滤器中

```
 controllerContext.PropertyBag["cssBundle"] = Bundle.Css(); 
```

并且在视图中

```
 $cssBundle.Add("~/Content/css/admin_styles.css").Add("~/Content/js/colorpicker/css/jpicker-1.1.6.min.css").Render("~/Content/css/min/admin.css") 
```

这次它至少只输出两个脚本的标签，没有缩小或捆绑，但至少它在做一些事情。

关于如何做到这一点的任何想法？谢谢你-杰里米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T21:03:22.757

您需要将其放在 Application_OnStart 方法中的 Global.asax.cs 文件中

`OnRequest.ForCss("~/Content/css/min/Combined.css")`

请参阅此博客文章（不是我的）[在 aspnet 网站中添加 global.asax.cs 文件](http://beyondrelational.com/modules/2/blogs/80/posts/10629/adding-the-globalasaxcs-file-in-aspnet-web-site.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:18:33.333

所以这就是它的完成方式。这是使用**squshit**，但**rejucier**的操作方式相同。

**基本控制器.cs**

```
#region Directives 
    using Castle.MonoRail.Framework; 
    using campusMap.Services; 
    using campusMap.Models; 
    using Castle.ActiveRecord; 
    using MonoRailHelper; 
    using campusMap.Filters; 
    //any others you'd need
#endregion 
namespace campusMap.Controllers 
{ 
    [Filter(ExecuteWhen.BeforeAction, typeof(scriptFilter))] 
    [Layout("default"), Rescue("generalerror")] 
    public abstract class BaseController : MonoRailHelper.HelperBaseController 
    { 
        protected ScriptsService ScriptsService = new ScriptsService();
    } 
} 
```

然后在过滤器中

**脚本过滤器.cs**

```
#region using
    using System;
    using Castle.MonoRail.Framework;
    using campusMap.Models;
    using MonoRailHelper;
    using campusMap.Services;
#endregion

namespace campusMap.Filters
{
    public class scriptFilter : IFilter
    {
        protected ScriptsService scriptsService = new ScriptsService();
        public bool Perform(ExecuteWhen exec, IEngineContext context, IController controller, IControllerContext controllerContext)
        {
            controllerContext.PropertyBag["scriptsService"] = scriptsService;
            return true;
        }
    }
} 
```

您会看到此时您正在为每个调用附加一个过滤器，所有内容都被渲染，并将对服务的引用放入属性包中，以便我们可以访问它。接下来是服务，因此我们可以提供访问方法。

**ScriptsService.cs**

```
#region Directives
    using System;
    using campusMap.Models;
    using MonoRailHelper;
    using campusMap.Services;
    using Castle.MonoRail.Framework;
    using campusMap.Filters;

    using SquishIt.Framework;
    using SquishIt.Framework.Css;
    using SquishIt.Framework.JavaScript;
    using System.Security.Cryptography;

#endregion

namespace campusMap.Services
{
    public class ScriptsService
    {
        public static string CalculateMD5Hash(string input)
        {
            // step 1, calculate MD5 hash from input
            MD5 md5 = MD5.Create();
            byte[] inputBytes = System.Text.Encoding.ASCII.GetBytes(input);
            byte[] hash = md5.ComputeHash(inputBytes);

            // step 2, convert byte array to hex string
            StringBuilder sb = new StringBuilder();
            for (int i = 0; i < hash.Length; i++)
            {
                sb.Append(hash[i].ToString("X2"));
            }
            return sb.ToString();
        }

        public static String Css(string files)
        {
            String name = CalculateMD5Hash(files);
            String path = @"/cache/script/css/";
            String FilePath = path + name + ".css";

            if (!HelperService.DirExists(path))
            {
                System.IO.Directory.CreateDirectory(path);
            }
            CSSBundle css = new CSSBundle();     
            foreach (string fl in files.Split(','))
            {
                css.Add(fl);
            }
            return css.ForceRelease().Render(FilePath);
        }
        public static String Js(string files)
        {

            String name = CalculateMD5Hash(files);
            String path = @"/cache/script/js/";
            String FilePath = path + name + ".js" ;

            if (!HelperService.DirExists(path))
            {
                System.IO.Directory.CreateDirectory(path);
            }
            JavaScriptBundle js = new JavaScriptBundle();
            foreach (string fl in files.Split(','))
            {
                js.Add(fl);
            }
            return js.ForceRelease().Render(FilePath);
        }
    }
} 
```

因此，您需要在服务中注意的是，我们正在调用方法参数的 md5 哈希，它为我们提供了一个基本名称。

这就对了！！..查看易于设置。现在你如何使用它？

**someView.vm**

```
//CSS
$scriptsService.Css("~/Content/css/jquery-ui-1.8.19.custom.css,~/Content/css/central_main.css,~/Content/css/map_admin.css,~/Content/css/colorbox.css?")

//JS
$scriptsService.Js("~/Content/js/modernizr-2.0.6/modernizr.min.js,~/Content/js/jquery.defaultvalue.js,~/Content/js/utilities_general.js,~/Content/js/infobox.js,~/Content/js/jquery.ui.map.js") 
```

需要注意的一件事是永远不要手动清除缓存。Squshit 会为您破坏客户端，因此不必担心触摸文件。

这里的所有都是它的。

# android - 在不同的xml中查找textview

> ID：11376946
> 
> 赞同：1
> 
> 时间：2012-07-07T16:58:02.700
> 
> 标签：android

**主要的.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:padding="10dp"
android:background="@drawable/gradientbg" >

<android.support.v4.view.ViewPager
android:layout_width="match_parent"
android:layout_height="match_parent"
android:id="@+id/viewPager"/>

</LinearLayout> 
```

**主页.xml**

```
 <TextView
 android:id="@+id/gpsStatus"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 android:layout_marginTop="10dp"
 android:layout_marginRight="10dp"
 android:layout_marginBottom="10dp"
 android:layout_marginLeft="2dp" /> 
```

**我的主要活动**

```
TextView gpsStatus = (TextView)findViewById(R.id.gpsStatus); // gpsStatus = null
gpsStatus.setText("foo"); 
```

这将导致空指针异常。

```
LayoutInflater inflater = getLayoutInflater();
View homeView = inflater.inflate(R.layout.home, null);
TextView gpsStatus = (TextView)homeView.findViewById(R.id.gpsStatus);
gpsStatus.setText("foo"); 
```

这不会使代码崩溃，但也不会更改我的文本。

那么如何找到和操作不在我的`main.xml`.

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:23:18.443

这是因为当您调用 findViewById 时，您的主活动中不存在 home.xml。一旦你的 home.xml 布局文件膨胀到你的主要活动中，findViewById 应该可以工作。

findViewById 仅适用于当前视图层次结构下的 ID。通过在您的膨胀视图上调用 findViewById，您正在检查您创建的布局对象上的视图层次结构。

如果您将 home.xml 布局添加到主活动中的视图，它将被添加到活动的视图层次结构中，然后您的 findViewById 和 setText 调用将起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T17:33:15.480

`So how do i find and manipulate controls that arent located in my main.xml?`

在 main.xml 中

```
<LinearLayout 
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:id="@+id/aLyoutWillbeAddedIfruqired"
 >
</LinearLayout> 
```

在你的活动中做一些类似...

```
LinearLayout statusLayout= (LinearLayout )findViewById(R.id.aLyoutWillbeAddedIfruqired); 
```

和

```
LayoutInflater inflater = getLayoutInflater();
View homeView = inflater.inflate(R.layout.home, null);
TextView gpsStatus = (TextView)homeView.findViewById(R.id.gpsStatus);
gpsStatus.setText("foo");
statusLayout.addView(homeView); 
```

我希望它会帮助你...

# c# - 在 ASP.NET Web 应用程序中绘制图形：饼图和矩形

> ID：11376950
> 
> 赞同：0
> 
> 时间：2012-07-07T16:58:30.997
> 
> 标签：c#, asp.net, charts

我想在asp.net web应用程序页面上按百分比绘制一些图形，需要什么代码？我特别要求饼图和矩形。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:08:42.787

您可以使用 .net 3.5 和 4 附带的数据可视化内容（图表）。

有一个可下载的 Visual Studio 解决方案（一个 asp.net Web 应用程序项目），其中显示了不同类型图表的示例以及相应的代码和标记：

[http://archive.msdn.microsoft.com/mschart/Release/ProjectReleases.aspx?ReleaseId=1591](http://archive.msdn.microsoft.com/mschart/Release/ProjectReleases.aspx?ReleaseId=1591)

根据您的情况，您甚至可以在不编写任何代码的情况下生成饼图等。

# ios - iOS模拟器问题

> ID：11376955
> 
> 赞同：0
> 
> 时间：2012-07-07T16:58:49.933
> 
> 标签：ios, xcode4, simulator, updating

我下载了 xcode 4 并创建了一个带有情节提要的单视图应用程序。

我在 segue 中添加了两个视图并将它们绑定回主屏幕。在那之后，我一定做了一些奇怪的事情。我唯一能想到的就是我把iOS模拟器放在了dock上。我已经更新了项目并且更改没有反映在模拟器上。

我认为问题在于我的计算机上有两个 iOS 模拟器。出于某种原因，每当我尝试在聚光灯下或在应用程序中找到一个时，它只显示一个。当我点击它时，它是来自 Xcode 3 的旧 iOS 模拟器。所以我所做的是我查看了 stackoverflow，它建议清理和运行项目。那没有用。

在那之后，我更仔细地看了看，发现我应该在我的新 iOS 模拟器上重置内容和设置。这就是我所做的，现在当我构建和运行它时，它说它找不到我的故事板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:11:19.120

通常你不会单独运行模拟器，而是让 Xcode 为你启动它。因此，在 Xcode 中，您可以在左上角选择您的方案（您可以选择是在模拟器还是设备上使用它）。然后您可以选择模拟器，然后按“运行”按钮，它应该会为您启动模拟器。无需单独启动模拟器。

如果 Xcode 表现不佳（即没有错误消息，但当您告诉 Xcode 在您的模拟器上运行它时，模拟器永远不会自动出现），我建议（a）退出并重新启动 Xcode（有时它会变得很奇怪状态）; (b) 清理您的项目；(c) 尝试再次运行它。

就在 Spotlight 中找不到模拟器而言，它现在是 Xcode.app 捆绑包的一部分，因此 Spotlight 不会找到它。但是如果你想停靠它（不知道为什么，但随意），只需通过在模拟器上运行一个应用程序从 Xcode 启动它，当它出现在你的停靠栏中时，按住 Control 单击它并选择“选项 > 保留”码头”。

# android - GestureDetector.onTouchEvent 中的 NullPointerException

> ID：11376956
> 
> 赞同：10
> 
> 时间：2012-07-07T16:58:51.910
> 
> 标签：android, gesturedetector

我在 onTouch 中有一个使用 GestureDetector 的活动。在我的布局中，我还有一个实现 onClickListener 的视图。在 Android ICS 上，我在处理 TouchEvent 时收到 NullPointerException。这个错误的原因是什么？我看过几篇帖子说 onClick 和 onTouch 不能很好地配合使用，但是当人们看到这个错误时，没有真正解释原因或问题的真正解决方案。

这是代码：

```
public class FlipCardActivity extends Activity implements
    View.OnClickListener, View.OnTouchListener {

    protected GestureDetector gestureDetector;

    protected class TouchSwipeListener extends GestureDetector.
        SimpleOnGestureListener {       
        @Override
        public boolean onDown(MotionEvent e) {
            return false;
        }

        @Override
        public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
            float velocityY) {
            // Calculate dx, gradient, velocity, etc
            // Check for and discard unacceptable swipes
            if (Math.abs(gradient) > SWIPE_MAX_GRADIENT || Math.abs(distance) < 
                SWIPE_MIN_DISTANCE || Math.abs(velocity) < SWIPE_MIN_VELOCITY)
                return false;

            // Determine whether it's a left or a right swipe
            if (dx < 0)
                activity.showNext();
            else
                activity.showPrevious();
            return true;
        }
    }

    @Override
    protected void onCreate(Bundle savedInstance) {
        super.onCreate(savedInstance);
        gestureDetector = new GestureDetector(this, new TouchSwipeListener(this));
        setContentView(R.layout.main);
    }

    @Override
    public boolean onTouch(View v, MotionEvent ev) {
        return gestureDetector.onTouchEvent(ev);
    }
} 
```

堆栈跟踪是：

```
java.lang.NullPointerException
at android.view.GestureDetector.onTouchEvent(GestureDetector.java:587)
at com.fivepumpkins.common.FlipCardActivity.onTouch(FlipCardActivity.java:602)
at android.view.View.dispatchTouchEvent(View.java:5536)
at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1912)
at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1371)
at android.app.Activity.dispatchTouchEvent(Activity.java:2364)
at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1860)
at android.view.View.dispatchPointerEvent(View.java:5721)
at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:2890)
at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2466)
at android.view.ViewRootImpl.processInputEvents(ViewRootImpl.java:845)
at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2475)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4575)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:789)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:556)
at dalvik.system.NativeStart.main(Native Method) 
```

查看 ICS Source，我可以提取带有错误的行：`GestureDetector.java:587`. 它发生在`onTouchEvent()`方法内部，在 case 中`case MotionEvent.ACTION_UP:`。这是摘录：

```
// Hold the event we obtained above - listeners may have changed the original.
586            mPreviousUpEvent = currentUpEvent;
587            mVelocityTracker.recycle();
588            mVelocityTracker = null;
589            mIsDoubleTapping = false;
590            mHandler.removeMessages(SHOW_PRESS);
591            mHandler.removeMessages(LONG_PRESS);
592            break; 
```

第 587 行中的 A`NullPointerException`表示`mVelocityTracker`为空。这是类的私有`VelocityTracker`属性`SimpleOnGestureListener`。为什么此时此变量为空？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-28T13:37:06.280

我还在`onTouchEvent()`：587 中获得了 NPE。所以我`GestureDetectorCompat`从支持库开始使用它，它工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T12:57:28.467

它确实可能与点击监听器有关。GestureDetector 访问 mVelocityTracker 并在 MotionEvent.ACTION_UP 和 MotionEvent.ACTION_CANCEL 中将其设置为 null。点击监听在 View 类的 onTouchEvent 方法的 MotionEvent.ACTION_UP 中执行。可能与 GestureDetector 在单击时执行的触发器、MotionEvent.ACTION_UP 或 MotionEvent.ACTION_CANCEL 之间存在关系（我现在没有时间找到），之前它已经被其中之一设置为 null。

尝试删除点击监听器，看看它是否仍然发生。如果是，您可能会更好地处理触摸侦听器中的所有内容。

# mysql - 查找哪个字段将结果限制为零记录

> ID：11376958
> 
> 赞同：0
> 
> 时间：2012-07-07T16:59:01.527
> 
> 标签：mysql, sql

是否有任何标准方法来查找哪个子句将结果限制为零记录？

例如我有这个查询：

```
SELECT * FROM `tb` WHERE `room` > 2 AND `keywords` LIKE 'Apartment' 
```

如果此查询不返回任何记录，我如何找到将结果限制为零记录的字段。

当您尝试搜索某些内容时，如果没有结果，某些搜索引擎会向您显示如下消息：

> 尝试不使用**关键字进行搜索**

或者，如果您正在使用`MATCH(city) AGAINST('tegas')`它向您展示：

> 你是说**德克萨斯吗**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T17:02:05.543

在查询执行期间，将评估所有条件。为了确定一个特定项目是否导致查询返回零记录，您必须为每个条件方案运行单独的语句。

我建议从所有可能的标准开始，然后根据其余项目的重要性进行回溯。这样，您就可以以最有效的方式限制处理。

# c# - Entity Framework 生成的 sql 限制相关记录

> ID：11376960
> 
> 赞同：0
> 
> 时间：2012-07-07T16:59:14.250
> 
> 标签：c#, .net, entity-framework

我有以下 linq 选择查询，它循环链接到以 B 开头的“adrianMember”的所有“Places”，我只想显示 PlaceName。我有一个从成员到地方的导航关联，但没有从地方到成员的导航关联。

```
using (var fdb = new FALDbContext())
{
    var adrianMember = fdb.Members.Find(1);

    foreach (string s in adrianMember.Places.Where(p=>p.PlaceName.StartsWith("B")).Select(p => p.PlaceName))
    {
        Console.WriteLine("- " + s);
    }
} 
```

我也尝试过各种 linq 语法，例如不使用 Find ...

```
var adrianMember = fdb.Members.Where(m => m.MemberId == 1).FirstOrDefault(); 
```

并提供两个 linq 查询，一个用于检索成员，然后检索相关位置（并希望使 EF 进行一些延迟延迟加载），但这仍然导致 sql 效率非常低。

```
using (var fdb = new FALDbContext())
{
    //Need the FirstOrDefault otherwise we will return a collection (first or default will return the inner collection
    //could have multiple members with multiple places
    var members = fdb.Members.Where(m=>m.FirstName == "Bob");

    foreach (var member in members)
    {
        var places = member.Places.Where(p => p.PlaceName.StartsWith("B")).Select(p => p.PlaceName);

        foreach (var place in places)
        {
            Console.WriteLine(place);
        }
    }
} 
```

SQL 输出获取所有行和所有列

```
exec sp_executesql N'SELECT 
[Extent1].[PlaceId] AS [PlaceId], 
[Extent1].[PlaceName] AS [PlaceName], 
[Extent1].[PlaceLocation] AS [PlaceLocation], 
[Extent1].[Member_MemberId] AS [Member_MemberId]
FROM [dbo].[Places] AS [Extent1]
WHERE [Extent1].[Member_MemberId] = @EntityKeyValue1',N'@EntityKeyValue1 int',@EntityKeyValue1=1 
```

有没有办法将 sql 限制为类似

SELECT PlaceName FROM Places WHERE MemberId = 1 AND PlaceName like 'B%'

我的项目中有几种情况，上面生成的 sql 会使查询太慢（每个成员 20,000 条记录超过 20 列）。如果我确实有更多记录，linq 是否足够聪明以进行更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T19:14:18.753

试试这个：

```
using (var fdb = new FALDbContext()) 
{     
    var members = fdb.Members.Where(m=>m.FirstName == "Bob");      
    foreach (var member in members)     
    {         
        fdb.Places.Where(p => p.PlaceName.StartsWith("B") && p.MemberId == member.Id).Select(p => p.PlaceName);
        foreach (var place in places)         
        {             
            Console.WriteLine(place);         
        }     
    } 
} 
```

[这里](https://stackoverflow.com/questions/1938204/linq-where-vs-findall)有一个类似的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:05:57.603

在解决这个问题一个月后，我想我会再看一眼......

首先，我不确定我想要实现什么！！！但是，我似乎确实找到了一些我想要的有趣且更有效的 sql 查询。

我的第一个选择是使用 Entry & Collection 方法使用显式加载。这将创建一个 SQL 查询来检索每个相应的 Place 记录，并且重要的是，投影我想要的列（只是描述）并限制行（那些以 L 开头的 Places）。如果我有很多关联的地方，这确实会创建很多查询，但是如果我不知道要检索哪些地方，我可以即时执行此操作。

```
 using (var fdb = new FALDbContext())
    {
        foreach (var member in fdb.Members)
        {
            var places = fdb.Entry(member)
                            .Collection(m => m.Places)
                            .Query()
                            .Where(p => p.PlaceName.StartsWith("L"))
                            .Select(p => p.PlaceName);

            foreach (var place in places)
            {
                Console.WriteLine(place);
            }
        }
    } 
```

第二个选项是使用延迟加载，但指定严格控制的 LINQ to Entities 位。

这会进入数据库一次，只检索我想要的成员和项目，并限制两个表以及一个可爱高效的 sql 查询！

```
 using (var fdb = new FALDbContext())
    {
        var myList = fdb.Members
                            .Where(m => m.GenderShareWithId > 0)
                            .Select(m => new { m.MemberId, m.DisplayName, Places = m.Places.Where(p => p.PlaceName.StartsWith("L")).Select(p => p.PlaceName) });

        foreach (var item in myList)
        {
            Console.WriteLine(item.DisplayName);
            foreach (var place in item.Places)
            {
                Console.WriteLine(" - " + place);
            }
        }
    }

SELECT 
    [Extent1].[MemberId] AS [MemberId], 
    [Extent1].[DisplayName] AS [DisplayName], 
    [Extent2].[PlaceName] AS [PlaceName]
FROM  [dbo].[Members] AS [Extent1]
LEFT OUTER JOIN [dbo].[Places] AS [Extent2] 
    ON ([Extent1].[MemberId] = [Extent2].[Member_MemberId]) AND ([Extent2].[PlaceName] LIKE N'L%')
WHERE [Extent1].[GenderShareWithId] > 0 
```

# apache - 无法从同一网络上的不同计算机访问 WAMP 服务器

> ID：11376963
> 
> 赞同：1
> 
> 时间：2012-07-07T16:59:23.680
> 
> 标签：apache, wamp

我的笔记本电脑上有一个 WAMP 服务器作为我的本地服务器。在这台服务器上，我托管了一个仅供本地使用的网页。

我还从 dyndns.org 为我的服务器注册了一个免费域名。我通过运行来自 dyndns.org 的软件来使用动态 DNS。

当我尝试访问我的服务器并使用我的浏览器查看我在其上托管的网站时，通过键入 localhost 或我的免费域名，它工作得很好。

但问题是，当我坐在我旁边的一个朋友（在同一个本地网络上）试图从他的笔记本电脑访问我的网页时，他收到一条错误消息： **“你没有访问此服务器的权限”** .

我在安装 WAMP 服务器后配置了 httpd.conf 文件，并且仅将 DocumentRoot 和目录更改为我在 www 文件夹中选择的文件夹。我也将 ServerName 更改为我的免费域名。

我不认为以上是问题。那么，任何人都知道这里可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T17:11:49.620

Did you try writing this:

```
<Directory yourdir>
Order Allow,Deny
Allow from all
</Directory> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T15:31:14.730

不，这都不起作用。但是在弄乱了 httpd.conf 文件之后，我找到了解决方案。在里面

```
< Directory yourdir >
Order Allow,Deny
Allow from all

# I had to put this line also
Require all granted

< /Directory> 
```

# php - 用 php 或 javascript 获取 youtube 视频源

> ID：11376966
> 
> 赞同：0
> 
> 时间：2012-07-07T17:00:07.900
> 
> 标签：php, javascript, youtube-api

所以有一种方法可以通过 php/javascript 获取 youtube 视频信息。但我不确定我应该使用 Php 还是 javascript。
哪种方法会使页面加载更快？
我应该在我的网站上托管视频还是将它们放在 youtube 上并使用 JW 播放器之类的东西？

目前，我用 PHP 编写代码。我有一个来自 youtube 的视频 ID 列表。php 代码读取所有这些 id，循环遍历它们以提供视频标题、描述等信息。并在页面上显示这些信息。谢谢！

```
foreach ($vidIds as $vidId){
            $xml ="http://gdata.youtube.com/feeds/api/videos/" . $vidId;
$doc = new DOMDocument;
$doc->load($xml);
$ns = "http://search.yahoo.com/mrss/";
$title = $doc->getElementsByTagNameNS($ns, "title")->item(0)->nodeValue;
$desc = $doc->getElementsByTagNameNS($ns, "description")->item(0)->nodeValue;
$thumbnail = $doc->getElementsByTagNameNS($ns, "thumbnail")->item(2)->getAttribute("url");

<div class="preview-frame">
    <a href="player.php?vidId=<?= $vidId ?>" >
    <img class="preview-img" src="<?= $thumbnail ?>" alt="Te Cong preview image"/>
    </a>
    <div class="preview">
    <span>
    <a href="player.php?vidId=<?= $vidId ?>"><?= $title ?></a>
    </span>
    <br/>
    <?= $desc ?>
    </div>
</div>
    <?php   } ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:02:34.990

Php 和 Javascript 都很好，但如果你不断地从 youtube 和 yahoo 页面获取这些信息，你的页面总是很慢。如果您可以设置一个 cron 作业来缓存结果，然后只在页面加载时从该缓存中读取，您应该会大大加快页面加载时间。这不是语言问题，而是后端设计问题。

# php - oauth + php：是否可以从不同的域进行代码请求和令牌请求

> ID：11376973
> 
> 赞同：0
> 
> 时间：2012-07-07T17:01:34.250
> 
> 标签：php, oauth

是否可以从一个域发出代码请求（重定向），然后在另一个域的访问令牌上交换它？

**PS**任一域都添加到 oauth 提供者端。

**PPS**是否每个 oauth 提供商都支持一个应用程序的多个域？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:29:14.613

是的，您的用户可以在一个域上启动该过程，然后在另一个域上结束它。一旦你有了访问令牌，你应该可以自由地从任何你想要的机器上调用 API 端点。

这是因为域除了作为回调 URL 的一部分之外没有其他作用。

基本上，您是在问回调对吗？你做的第一件事不是来自“域”，它是一个普通的 HTTP 请求，第二个是重定向到提供者，第三个是他们重定向到你的回调，并使用 URL 中包含的访问令牌。

# shell - 是否有最低限度符合 POSIX.2 的外壳？

> ID：11376975
> 
> 赞同：24
> 
> 时间：2012-07-07T17:01:37.367
> 
> 标签：shell, posix

在以下意义上是否有一个最低限度的[POSIX](http://en.wikipedia.org/wiki/POSIX) .2 兼容外壳（我们称之为它）：`mpcsh`

如果`mpcsh myscript.sh`在我的（兼容的）系统上行为正确，那么对于任何兼容系统上`xsh myscript.sh` 的任何 POSIX.2 兼容 shell 的行为都将相同`xsh`。（“相同”到不太相关的事情，例如错误消息的措辞等）

[破折号](http://en.wikipedia.org/wiki/Debian_Almquist_shell)符合条件吗？

如果没有，有什么方法可以验证合规性`myscript.sh`吗？

* * *

编辑（9年后）：

接受的答案仍然有效，但请查看[此博客文章](https://dev.to/bowmanjd/writing-bash-scripts-that-are-not-only-bash-checking-for-bashisms-and-testing-with-dash-1bli)和`chackbashisms`命令（[来源](https://sourceforge.net/projects/checkbaskisms/)）。避免 bashism 与编写符合 POSIX.2 的 shell 脚本不同，但它很接近。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-05-04T15:41:34.313

## 预先悲伤的答案

它不会帮助你（不像你期望的那样可靠和可靠）。

* * *

这就是为什么。

虚拟“POSIX shell”无法解决的一个大问题是标准中措辞模棱两可或根本没有解决的问题，因此 shell 可以以不同的方式实现事物，同时仍然遵守标准。

以这两个关于管道的例子为例，其中第一个是众所周知的：

## 示例 1 - 范围界定

```
$ ksh -c 'printf "foo" | read s; echo "[${s}]"'
[foo]

$ bash -c 'printf "foo" | read s; echo "[${s}]"'
[] 
```

`ksh`在当前 shell 中执行管道的最后一个命令，而`bash`在子 shell 中执行所有命令 - 包括最后一个命令。`bash 4`引入了`lastpipe`使其行为类似于的选项`ksh`：

```
$ bash -c 'shopt -s lastpipe; printf "foo" | read s; echo "[${s}]"'
[foo] 
```

所有这些都是（有争议的）根据[标准](http://pubs.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html#tag_02_12)：

> 此外，多命令管道的每个命令都处于子shell环境中；然而，作为扩展，管道中的任何或所有命令都可以在当前环境中执行。

我不是 100% 确定他们对*extension*的含义，但是根据文档中的其他示例，这并不意味着 shell 必须提供一种在行为之间切换的方法，而只是说它可以，如果它愿意的话，实现一些东西以这种“扩展方式”。其他人对此的理解不同，并争论这种`ksh`行为不符合标准，我明白为什么。措辞不仅不吉利，而且一开始就允许这样做也不是一个好主意。

在实践中，哪种行为是正确的并不重要，因为它们是“”“两个大壳”“”，人们会认为如果你不使用他们的扩展并且只使用它应该工作的符合 POSIX 的代码要么，但事实是，如果您依赖上面提到的一种或另一种行为，您的脚本可能会以可怕的方式中断。

## 示例 2 - 重定向

这是我几天前才了解到的，请[在此处](https://stackoverflow.com/a/16322932/612462)查看我的答案：

```
foo | bar 2>./qux | quux 
```

常识和[POLA](http://en.wikipedia.org/wiki/Principle_of_least_astonishment)告诉我，当命中下一行代码时，两者都`quux`应该`bar`已经完成​​运行，这意味着文件`./qux`已完全填充。对？不。

[POSIX](http://pubs.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html#tag_02_09_02)指出

> 如果管道不在后台（参见异步列表），shell 将等待管道中指定的最后一个命令完成，也可能等待所有命令完成。）

*可以*（！）等待所有命令完成！哇！

[bash](/questions/tagged/bash "显示标记为“bash”的问题")等待：

> shell 在返回值之前等待管道中的所有命令终止。

但[ksh](/questions/tagged/ksh "显示标记为“ksh”的问题")没有：

> 每个命令（可能是最后一个命令除外）都作为单独的进程运行；shell 等待最后一个命令终止。

因此，如果您在管道之间使用重定向，请确保您知道自己在做什么，因为这会受到不同的处理，并且可能会在极端情况下严重中断，具体取决于您的代码。

我可以举另一个与管道无关的例子，但我希望这两个就足够了。

## 结论

有一个标准是好的，不断修改它更好，坚持它是很好的。但是，如果标准由于模棱两可或许可而失败，事情仍然会意外地破坏，实际上使标准的有用性无效。

这在实践中意味着，除了编写“符合 POSIX 的”代码之外，您还需要思考并知道您正在做什么以防止某些事情发生。

话虽如此，根据其手册页，一个尚未提及的 shell[`posh`](http://packages.debian.org/unstable/shells/posh)据说是 POSIX 加上比现有更少的扩展`dash`（主要`echo -n`是关键字）：`local`

```
BUGS
   Any bugs in posh should be reported via the Debian BTS.
   Legitimate bugs are inconsistencies between manpage and behavior,
   and inconsistencies between behavior and Debian policy
   (currently SUSv3 compliance with the following exceptions:
   echo -n, binary -a and -o to test, local scoping). 
```

YMMV。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T15:49:14.177

可能最接近[规范 shell 的是`ash`](http://en.wikipedia.org/wiki/Almquist_shell)由[NetBSD 基金会](http://en.wikipedia.org/wiki/NetBSD#The_NetBSD_Foundation)和其他组织维护的。

这种[外壳的下游变体称为`dash`](http://en.wikipedia.org/wiki/Debian_Almquist_shell)更广为人知。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-09T21:20:42.790

目前，没有单一的*榜样*。`POSIX shell`

自最初的 Bourne shell 以来，POSIX shell 采用了许多附加功能。

我所知道的所有实现这些功能的 shell 都具有超出 POSIX shell 功能集的扩展。

例如，POSIX 允许以下格式的算术表达式：

```
var=$(( expression )) 
```

但它不允许等效：

```
(( var = expression )) 
```

支持`bash`和`ksh93`。

我知道`bash`有一个`set -o posix`选项，但这不会禁用任何扩展。

```
$ set -o posix
$ (( a = 1 + 1 ))
$ echo $a
2 
```

据我所知，`ksh93`尝试开箱即用符合 POSIX，但仍允许扩展。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-04-06T00:21:24.320

POSIX 开发人员花了数年时间（毫不夸张地说）来解决这个问题：“应用程序符合标准意味着什么？” 虽然 POSIX 开发人员能够为标准（POSIX.1 和 POSIX.2）的*实现*定义一致性测试套件，并且可以将“严格符合应用程序”的概念定义为不使用超出强制元素的接口的概念在标准中，他们无法定义一个测试制度来确认特定应用程序“严格符合”POSIX.1，或者shell脚本“严格符合”POSIX.2。

最初的问题就是寻求这一点；验证脚本的一致性测试仅使用完全指定的标准元素。唉，该标准充满了放宽行为定义的“狡猾的词”，使得这样的测试对于任何显着有用性的脚本实际上是不可能的。（即使不考虑 shell 脚本可以生成和执行 shell 脚本的事实，这也是正确的，因此将“严格符合”的问题等同于停止问题。）

（全面披露：从 1988 年到 1999 年，我是 IEEE-CS TCOS（POSIX 系列标准的创建者）的工作成员和委员会负责人。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-09T21:28:27.443

> 如果没有，有什么方法可以验证 myscript.sh 的合规性吗？

这基本上是一个质量保证的案例。从...开始：

*   代码审查
*   单元测试（是的，我已经完成了）
*   功能测试
*   使用尽可能多的不同 shell 程序执行测试套件。( `ash`, `bash`, `dash`, `ksh93`, `mksh`, `zsh`)

`bash`就个人而言，我的目标是由和支持的通用扩展集`ksh93`。它们是可用的 shell 语言中最古老和最广泛使用的解释器。

**编辑**最近我偶然发现了[rylnd/shpec](https://github.com/rylnd/shpec) - 一个用于你的 shell 代码的测试框架。您可以在测试用例中描述代码的功能，并指定如何验证它们。披露：我帮助它在 bash、ksh 和 dash 上运行。

# javascript - 在链接选择上使用 jQuery 添加/删除类

> ID：11376986
> 
> 赞同：0
> 
> 时间：2012-07-07T17:03:08.780
> 
> 标签：javascript, jquery, addclass

我正在尝试在 jQuery 中编写一个函数，它将一个类添加到选定的链接（在 iframe 中打开一个页面），然后在选择另一个链接时删除该类。我以前从这里的另一位成员那里得到了一些类似的帮助，但涉及单选按钮和表格。

我尝试使用它一段时间，但 jQuery 对我来说仍然很新，所以我对它了解不多。

基本上，我包含大约 3-4 组链接`<div id="CollapsiblePanelContent"> ... </div>`，我想`<a>`在用户选择的这个容器内的标签中添加一个样式。

任何帮助将不胜感激。谢谢你。

```
<div id="CollapsiblePanelContent">  
  <a href="page1.asp" onclick="return handlelink(this)">Link1</a>
  <a href="page2.asp" onclick="return handlelink(this)">Link2</a>
  <a href="page3.asp" onclick="return handlelink(this)">Link3</a>
  <a href="page4.asp" onclick="return handlelink(this)">Link4</a>
</div>

<script type='text/javascript'>
  $(function() {
    $('div').click(function(event) {
      $(this).closest('.CollapsiblePanelContent').addClass('selected').parent().siblings().each(function() {
        $(this).find('.CollapsiblePanelContent').removeClass('selected');
      });
    });
  });
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T17:09:38.077

```
$('#CollapsiblePanelContent a').on('click', function(e){
  e.preventDefault(); // prevent page reload, you may remove it if don't need
  $(this).addClass('selected').siblings().removeClass('selected');
}); 
```

如此`CollapsiblePanelContent`正确的`id`选择器`#CollapsiblePanelContent`不会`.CollapsiblePanelContent`。

但是如果你使用`CollapsiblePanelContent`for multiple s 那么应该用 selector`div`代替它。因为多个元素可以有相同的 .`id``class``.CollapsiblePanelContent``id`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T17:09:00.930

你可以试试 ：

```
function handlelink(this)
{
$(this).siblings().removeClass('selected');
$(this).addClass('selected');
//do the rest with the click
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T17:08:48.590

根据您提供的 HTML，以下内容应该可以工作：

```
$(function() {
    $('.CollapsiblePanelContent a').click(function() {
        $(this).addClass('selected').siblings().removeClass('selected');
    });
}); 
```

这会将 click 事件处理程序绑定到`<a>`内部的任何元素`<div class="CollapsiblePanelContent">`，这会将`selected`类添加到单击的链接，并从其所有同级中删除相同的类。

# c# - Parallel.Foreach 循环创建多个数据库连接会引发连接错误？

> ID：11376990
> 
> 赞同：2
> 
> 时间：2012-07-07T17:04:05.650
> 
> 标签：c#, sql, entity-framework, task-parallel-library

“登录失败”错误从未再次出现，好奇吗？但是，其他连接错误似乎可以通过猛击服务器来解释。错误发生的随机性仍然是一个谜。

> 登录失败。登录来自不受信任的域，不能用于 Windows 身份验证

我想让我的代码并行运行，所以我将 foreach 循环更改为并行 foreach 循环。这似乎很简单。每个循环都连接到数据库，查找一些内容，执行一些逻辑，添加一些内容，关闭连接。但我得到上述错误？

我正在使用我的本地 sql 服务器和实体框架（每个循环都使用它自己的上下文）。使用相同的本地登录名连接多次是否有问题？我是如何解决这个问题的？

我已经（在尝试转换为 parallel.foreach 循环之前）将我正在 foreach 循环的对象列表拆分为四组（单独的 csv 文件）并运行我的程序的四个并发实例（总体上运行速度比一个快，因此并行的想法）。所以似乎连接到数据库不应该是一个问题？

有任何想法吗？

**编辑**：这是以前

```
var gtgGenerator = new CustomGtgGenerator();
var connectionString = ConfigurationManager.ConnectionStrings["BioEntities"].ConnectionString;

var allAccessionsFromObs = _GetAccessionListFromDataFiles(collectionId);

ForEach(cloneIdAndAccessions in allAccessionsFromObs)
    DoWork(gtgGenerator, taxonId, organismId, cloneIdAndAccessions, connectionString)); 
```

后

```
var gtgGenerator = new CustomGtgGenerator();
var connectionString = ConfigurationManager.ConnectionStrings["BioEntities"].ConnectionString;

var allAccessionsFromObs = _GetAccessionListFromDataFiles(collectionId);

Parallel.ForEach(allAccessionsFromObs, cloneIdAndAccessions => DoWork(gtgGenerator, taxonId, organismId, cloneIdAndAccessions, connectionString)); 
```

在 DoWork 内部，我使用 BioEntities

```
using (var bioEntities = new BioEntities(connectionString)) {...} 
```

越来越好奇了……

我在 DoWork 方法中添加了一些代码：

```
Debug.WriteLine(“Executing “ + itemName + ” as “ + WindowsIdentity.GetCurrent().Name); 
```

它神秘地开始工作（实际上很好/很快）。但最终我得到了同样的例外（大约一个小时后）。但我能够追踪到这个..？

```
A first chance exception of type 'System.Data.SqlClient.SqlException' occurred in System.Data.dll 
```

**EDIT2：** 嗯..我今天早上进来工作并把它烧了（痴迷于理解为什么它会工作一点点），到目前为止它工作得很好（而且很快！）。偶尔：线程 '' (0x27c8) 以代码 0 (0x0) 退出。线程 '' (0x26b8) 以代码 0 (0x0) 退出。

但除此之外，它还没有搞砸吗？坦率地说，这让我更担心。这是一次性的，所以我可以使用它（如果它有效），但发生了什么？会不会是 NLOG，登录多个线程会阻塞东西并导致 sql 超时？我真的不明白。一旦它再次停止工作，我将尝试解决问题。有没有办法重置 sql server，我不知道为什么它会工作一个小时，然后搞砸，然后永远不会工作超过几秒钟，现在（重新启动后）工作（大约 30 分钟至今）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T18:49:10.173

您的身份不会流向执行并行 for.each 的底层任务的工作线程。

这里的答案很好，所以我不会复制它。 [WCF 服务中的 TPL 任务无法使用正确的 IIS 安全凭据（SQL 连接）](https://stackoverflow.com/questions/10007535/tpl-task-in-wcf-service-fails-to-use-correct-iis-security-credentials-sql-conne)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T19:34:19.827

好的，很抱歉回答我自己的问题，但它可能对某人、某处、某个时间有价值。

添加（并随后删除）以下代码以查看每个线程使用的身份后，“登录失败”错误再也没有发生过。我不确定使用它是否会影响某些东西，但我现在不使用它，而且它似乎从未在最初给出的链接和答案中讨论过身份问题。

```
Debug.WriteLine("Executing " + cloneIdAndAccessions.Item1.ToString() + " as " + WindowsIdentity.GetCurrent().Name); 
```

这里一定有**两个**问题，第一个是掩盖后者。但是我仍然收到以下两种类型的连接错误。特别是（我注意到）在打开 SQL Server Management Studio 并可能使服务器紧张之后。

```
System.Data.EntityCommandExecutionException: An error occurred while reading from the store provider's data reader. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The query processor could not start the necessary thread resources for parallel query execution. 
```

和...

```
System.Data.EntityCommandExecutionException: An error occurred while executing the command definition. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding. 
```

所以，我的解决方案（因为我找不到错误发生的押韵或理由）是简单地捕获错误并记录 Parallel.ForEach 循环中哪个对象抛出它，然后重新运行这些对象。仍然比简单的 foreach 循环快得多。

**编辑：**嗯，这很有趣，我发现了错误的一些押韵/原因（不是当它们被抛出时，而是可能是为什么）。如果我将 Parallel.ForEach 循环中的对象数量分成更小的组（10,000 个对象而不是 100,000 个）组，那么我永远不会抛出任何异常。好的。

所以总结 - 检查身份，然后可能会分解你在 foreach 循环中运行的组......有人弄清楚为什么这是必要的并报告:)

**编辑/结束**

不是最好的解决方案，但与深入研究任务和线程疯狂相比相对简单。

# amazon-s3 - Paperclip S3 image path issue

> ID：11376992
> 
> 赞同：1
> 
> 时间：2012-07-07T17:04:11.033
> 
> 标签：amazon-s3, paperclip, ruby-on-rails-3.2

I've just upgraded from Rails 3.1 to Rails 3.2.6 and my paperclip photo paths are now broken on production.

`photo.rb`

```
if Rails.env == "production"
  has_attached_file :image,
    :storage => :s3,
    :s3_credentials => S3_CREDENTIALS,
    :url => "/app/public/system/images/:id/:style/:basename.:extension", 
```

I need the resulting path to be like so: `http://s3.amazonaws.com/photoramblr/app/public/system/images/5/thumb_large/image.jpg`

but instead the above url settings result in: `http://s3.amazonaws.com/photoramblr/app/public/app/public/system/images/5/thumb_large/image.jpg`

I've also tried setting the paperclip url to `:url => "/system/images/:id/:style/:basename.:extension"` but that resulted in this url: `http://s3.amazonaws.com/photoramblr/images/5/thumb_large/image.jpg`

Any thoughts on how I can set this properly?

UPDATE: Well, I still don't understand how it's working, but I 'fixed' this by just moving the files to the location it was looking in.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T11:42:25.687

尝试添加一个路径参数来替换 url 参数，并在存储桶名称下指定存储文件的路径，并且 URL 将从存储桶和提供的路径构造。这是 [回形针 s3 文档](http://rubydoc.info/gems/paperclip/Paperclip/Storage/S3)的链接以获取更多详细信息。如果您提供一个 url 参数，它会被视为相对于您的“应用程序/公共”。这就解释了为什么你得到的图像路径加倍“app/public”。Ryan Bate 的[回形针教程](http://asciicasts.com/episodes/134-paperclip)也解释了这种行为。在您的情况下，您的代码将如下所示；

```
if Rails.env.production?
  has_attached_file :image,
    :storage => :s3,
    :s3_credentials => S3_CREDENTIALS,
    :path => "app/public/system/images/:id/:style/:basename.:extension", 
```

您生成的链接将是（我假设您的存储桶名称是链接中的 photorambler）；s3.amazonaws.com/photorambler/app/public/system/images/5/thumb_large/image.jpg

# iphone - 搜索完成后 UINavigationBar 取消隐藏

> ID：11376994
> 
> 赞同：0
> 
> 时间：2012-07-07T17:04:16.547
> 
> 标签：iphone, uinavigationcontroller

我不确定这是如何工作的。我有一个 UITabBarController，其中我的第一个选项卡是 UiNavigationController，它的 rootViewController 有一个 UISearchDisplayController 和 UISearchBar。我将 rootViewController 设置为 UINavigationControllerDelegate。

我这样做：

```
- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated {
    [self.navigationController.navigationBar setHidden:YES];
} 
```

所以我的导航栏不会显示。那部分有效。在我进行搜索并按 Enter 后，导航栏就会进入并将我的搜索栏推到它下方。这里发生了什么？还有其他地方我需要阻止导航栏显示吗？

我知道我可以以模态方式展示我的视图控制器，因为这是我以前做的。但是除了 navBar 问题之外，没有其他理由以模态方式呈现它。一旦进行了搜索并且用户选择了一些东西以进入该项目的更详细的视图，那么我曾经在那里创建了一个 navigationController。如果我在根目录下只有一个 UINavigationController 似乎会更好，因为就像我说的那样，没有理由以模态方式呈现详细列表。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:10:42.943

尝试更换

```
[self.navigationController.navigationBar setHidden:YES]; 
```

和

```
[self.navigationController setNavigationBarHidden:YES animated:NO]; 
```

# android - Verifying in app billing response on server with PHP

> ID：11376996
> 
> 赞同：1
> 
> 时间：2012-07-07T17:04:34.230
> 
> 标签：android, in-app-billing

I'm trying to verify the response of the Play Store on my server. There are some questions about this topic but none have worked for me.

Here's how I'm doing it:

```
 $KEY_PREFIX = "-----BEGIN PUBLIC KEY-----\r\n";
    $KEY_SUFFIX = '-----END PUBLIC KEY-----';
$mykey=<MyPlayStoreKey>;
$key = $KEY_PREFIX . chunk_split($mykey, 64, "\r\n") . $KEY_SUFFIX;
$key = openssl_get_publickey($key);

    $correct=$param1=openssl_verify (
    $signedData, 
    base64_decode($signature),
    $key); 
```

Where $signedData and $signature are responses from the Play Store. $correct is always 0 (Which means that the signatures don't match) What I'm doing wrong?

I'm testing this with static responses in a device with the developer account set as primary.

# c++ - Allegro 可以在运行时更新操纵杆的数量吗？

> ID：11376998
> 
> 赞同：0
> 
> 时间：2012-07-07T17:04:45.550
> 
> 标签：c++, allegro, joystick

`remove_joystick()`除了不断调用then之外，有没有办法在运行时更新插入的操纵杆数量`install_joystick`？这被证明是非常缓慢的（从 60 FPS 到 5 左右）。

Allegro 4.2 只回答请...

```
void Joystick::Update() {
    //If joystick input was lost, attempt to reacquire.
    if(GetNumJoysticks() == 0) {
        throw InputNotAvailableException("Joystick");
    }
    //If all joysticks were deleted remove input and do nothing.
    if(_numjoysticks == 0) {
        remove_joystick();
        return;
    }

    //Update state information
    if(poll_joystick() < 0) {
        throw InputNotAvailableException("Joystick");
    }
    for(int i = 0; i < _numButtons; ++i) {
        _prevButtons[i].b = _curButtons[i].b;
        _prevButtons[i].name = _curButtons[i].name;

        _curButtons[i].b = joy[_joyNumber].button[i].b;
        _curButtons[i].name = joy[_joyNumber].button[i].name;
    }
    for(int i = 0; i < _numSticks; ++i) {
        for(int j = 0; j < joy[_joyNumber].stick[i].num_axis; ++j) {
            _prevSticks[i].axis[j].name = _curSticks[i].axis[j].name;
            _prevSticks[i].axis[j].pos = _curSticks[i].axis[j].pos;
            _prevSticks[i].axis[j].d1 = _curSticks[i].axis[j].d1;
            _prevSticks[i].axis[j].d2 = _curSticks[i].axis[j].d2;

            _curSticks[i].axis[j].name = joy[_joyNumber].stick[i].axis[j].name;
            _curSticks[i].axis[j].pos = joy[_joyNumber].stick[i].axis[j].pos;
            _curSticks[i].axis[j].d1 = joy[_joyNumber].stick[i].axis[j].d1;
            _curSticks[i].axis[j].d2 = joy[_joyNumber].stick[i].axis[j].d2;
        }
        _prevSticks[i].flags = _curSticks[i].flags;
        _prevSticks[i].name = _curSticks[i].name;

        _curSticks[i].flags = joy[_joyNumber].stick[i].flags;
        _curSticks[i].name = joy[_joyNumber].stick[i].name;
    }
}
int Joystick::GetNumJoysticks() {
    remove_joystick();
    if(install_joystick(JOY_TYPE_DIRECTX)) {
        return 0;
    }
    return (num_joysticks);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T17:55:30.083

4.x 系列没有。5.x 系列可以。

您必须使用自定义平台特定代码（假设存在此类事件）侦听本机操作系统事件，并且仅在检测到更改时调用 Allegro deinit/init 函数，或者要求用户手动启动操纵杆刷新。

在 Linux 下，您可以`inotify_add_watch()`/dev/input 检查更改。查看 4.4 Allegro 代码，您似乎想要调用 Win32 函数`joyGetNumDevs()`和`joyGetPos()`. 就像是：

```
int WIN_MAX_JOYSTICKS = joyGetNumDevs(); // this should never change
JOYINFO ji;
int pluggedin_count = 0;
for (int i = 0; i < WIN_MAX_JOYSTICKS; ++i)
  if (joyGetPos(i, &ji) == JOYERR_NOERROR) ++pluggedin_count;

if (pluggedin_count != last_pluggedin_count) /* reinit Allegro */ 
```

您必须每 N 秒执行一次。

这些joy* 函数是Windows 函数，因此请阅读MSDN 文档以了解如何使用它们。