# StackOverflow 问答 10021000-10021999

# c - C：数字前面的和号

> ID：10021000
> 
> 赞同：-1
> 
> 时间：2012-04-05T00:06:17.920
> 
> 标签：c

这行 (x = n & 5;) 在下面的代码中是什么意思？据我所知，＆符号用于指针。我没想到会编译这段代码，但它编译并运行良好。我得到的结果是

> 0,1,0,1,4,5,4,5,0,1,

```
#include <stdio.h>

int main(void){
    int x, n;
    for (n = 0; n < 10; n++){
        x = n & 5;
        printf("%d,", x);
    }
    printf("\n");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T00:07:39.647

在这种情况下，它是按位与。

```
x = n & 5; 
```

将 AND 5（即 0b101）与`n`.

AND 作用于表示值的位。如果两个值在该位置都有 1，则结果将为 1，否则为 0。

由于我们用 5 进行与运算，而 0b101 中的两位只能生成 4 个值，因此 x 唯一可能的值是 1、4、5 和 0。下面是一个说明：

```
n           &    5     = x
1 (0b0001)  &  0b0101  = 1  (0b0001)
2 (0b0010)  &  0b0101  = 0  (0b0000)
3 (0b0011)  &  0b0101  = 1  (0b0001)
4 (0b0100)  &  0b0101  = 4  (0b0100)
5 (0b0101)  &  0b0101  = 5  (0b0101)
6 (0b0110)  &  0b0101  = 4  (0b0100)
7 (0b0111)  &  0b0101  = 4  (0b0100)
8 (0b1000)  &  0b0101  = 0  (0b0000)
9 (0b1001)  &  0b0101  = 1  (0b0001) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T00:12:00.410

这就是“按位与”运算符。通常，它需要两个整数，并返回一个整数，该整数仅具有在它的两个参数中设置的位。

```
base10 base2
6       0110
3       0011
6&3     0010   (=2) 
```

还有“按位或”`|`设置任何一个设置的位。

```
base10 base2
6       0110
3       0011
6|3     0111   (=7) 
```

并且有“按位异或”`^`设置不同的位。

```
base10 base2
6       0110
3       0011
6^3     0101   (=5) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T00:07:36.390

这是一个按位与运算符。n 的值与 5 进行与运算。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T00:15:02.007

你已经被告知在这种情况下它是一个二进制和。但这需要更多的解释。在 C 和其他类 C 语言中，有两个`&`运算符。一个是**一元**的，另一个是**二进制**的。

一**元运算**符单独作用于单个值，而**二元**运算符接收两个值。在 C中，**二元**运算符优先于一元运算符。如果你写

```
int b;
int *a = &b; 
```

然后`b`是操作员可以处理的唯一值。如果你写但是

```
int c, d;
int d = c & d; 
```

那么运算符有两个值可以使用，并且二进制解释优先于一元解释。请注意，这不仅适用于`&`运营商，也适用于其对应的`*`

```
int *f;
int h = *f; 
```

但是也

```
int i,j;
int k = i * j; 
```

与所有运算符一样，优先级可以用括号覆盖：

```
int l, *m;
int n = l * (*m); 
```

# sql - 来自具有多个 where 条件的 SQL 的 sqlalchemy 查询

> ID：10021002
> 
> 赞同：6
> 
> 时间：2012-04-05T00:06:45.490
> 
> 标签：sql, sqlalchemy

我有三个表，定义为：

```
class User(Base):
    __tablename__ = 'users'

    id = Column(Integer(10), primary_key=True)
    firstname = Column(String(64))
    surname = Column(String(64))

class SWMS(Base):
    __tablename__ = 'swms'
    id = Column(Integer(10), primary_key=True)
    owner_id = Column(Integer(10), ForeignKey('users.id', ondelete='CASCADE'))
    filename = Column(String(255))

    swmowner = relationship('User', backref=backref('users'))

class SWM_perms(Base):
    __tablename__ = 'swm_perms'
    id = Column(Integer(10), primary_key=True)
    swm_id = Column(Integer(10), ForeignKey('swms.id', ondelete='CASCADE'))
    user_id = Column(Integer(10), ForeignKey('users.id', ondelete='CASCADE'))

    swm = relationship('SWMS', backref=backref('swms'))
    swmuser = relationship('User', backref=backref('swmusers')) 
```

本质上，SWMS 表是一个文档信息表，其中 owner_id 定义了创建文档的用户。SWM_perms 是一个表，其中包含文档 ID 到用户 ID 的映射 - 用于定义允许哪些用户查看文档。

要生成所有文档的表，这些文档要么 1）由用户拥有，要么 2）可由用户查看，在 SQL 中我会这样做：

```
select owner_id, users.firstname, users.surname, filename
from swms, swm_perms, users
where users.id=swms.owner_id and 
  ((swms.id=swm_perms.swm_id and swm_perms.user_id = 27) or (owner_id = 27)); 
```

您将如何在 sqlalchemy 中定义此查询？我熟悉 or_() 函数，但我尝试的变体不会生成正确的对象。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T05:21:53.170

```
cond1 = and_(SWMS.id==SWM_perms.swm_id,SWM_perms.user_id==27)
swms = DBSession.query(User,SWMS).filter(or_(cond1,SWMS.owner_id==27)).\
                                  filter(User.id==SWMS.owner_id).all() 
```

然后你可以做一个列表理解来提取你想要的字段：

```
details = [(u.firstname, s.filename, s.blob_key, s.last_modified) for u,s in swms] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-15T21:06:51.343

另外值得注意的是，您可以在查询正文中使用“&”运算符代替“and_”。请参阅他们在此处提供的示例（第二个代码块）：

[http://docs.sqlalchemy.org/en/rel_1_0/core/sqlelement.html#sqlalchemy.sql.expression.and_](http://docs.sqlalchemy.org/en/rel_1_0/core/sqlelement.html#sqlalchemy.sql.expression.and_)

# c# - C# 多个项目引用同一个 dll - 更新 dll 的简单方法是什么？

> ID：10021011
> 
> 赞同：2
> 
> 时间：2012-04-05T00:07:59.567
> 
> 标签：c#, .net

我很好奇其他人是如何做到的，或者是否有更简单的方法......

我有多个项目引用相同的 DLL，即 nhibernate.dll。这些 dll 存储在 NHibernate-3.2.0 等版本文件夹中。如果有新版本出现并且我们要升级到它，我们会创建一个新版本文件夹，并且需要将所有引用项目更新到新的 dll。

有没有更简单的方法来做到这一点？就像一些引用 nhibernate 的中心项目（我们称之为 REF_PROJ），而所有其他项目只引用 REF_PROJ？所以新版本的更新只在一个中心位置进行，REF_PROJ。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T00:09:56.157

您的解决方案是一种方法。恕我直言，“更好”的方法是使用[nuget packages](http://nuget.org)。特别[是 nhibernate nuget 包](http://nuget.org/packages/NHibernate/3.2.0.4000)。然后您可以右键单击解决方案并在新版本出现时更新所有 nhibernate 包。

编辑：添加到其他答案。如果您希望使用特定版本的 nuget 包以包中特定版本的程序集为目标，请在从包管理器控制台安装它们时使用 --version。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:11:32.740

只是有一个根文件夹，而不是特定于版本的。或者，如果您确实需要特定版本，则有 2 份副本 - 一份在根文件夹中，一份在特定版本文件夹中。

这是我的意思的一个例子。

休眠

-->休眠3.2

----> nhibernate.dll

--> nhibernate.dll

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:14:01.227

另一种解决方案是使用[GAC](http://msdn.microsoft.com/en-us/library/yf1d93sz%28v=vs.71%29.aspx)

将您的程序集注册到 gac，并在不指定程序集版本的情况下从多个项目中添加对它的引用。并使用 gac util 轻松更新。

# maven - 使用 cxf-codegen-plugin 生成源时，有没有办法去除注释？

> ID：10021013
> 
> 赞同：0
> 
> 时间：2012-04-05T00:08:13.023
> 
> 标签：maven, annotations, cxf

我正在使用[cxf-codegen-plugin](http://cxf.apache.org/docs/maven-cxf-codegen-plugin-wsdl-to-java.html)从 WSDL 生成一些类。生成源之后，会删除一堆 bean（我们不需要它们，只需要服务接口），但是`@XmlSeeAlso`在生成的源中有一个注释，它引用了其中一些已删除的类。我们根本不需要`@XmlSeeAlso`注解，有没有办法告诉 cxf-codegen-plugin 在生成源时排除某些注解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T22:23:40.723

我通过向 a 添加标签来解决这个问题`maven-antrun-plugin`，注释掉所有`@XmlSeeAlso`实例：

```
<target>
    <replace file="${basedir}/target/generated-sources/x/x/x/Service.java" token="@XmlSeeAlso" value="//@XmlSeeAlso" />
</target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T07:24:33.800

生成代码的想法是让它保持原样。问题是你为什么要删除我认为是手动工作的文件，这与生成代码的想法相矛盾。

# python - 在 Python 中 Markdown 到 LaTeX

> ID：10021016
> 
> 赞同：1
> 
> 时间：2012-04-05T00:08:42.210
> 
> 标签：python, latex, markdown

Python 的 Markdown-Latex 包的版本很少，但我无法使用当前版本的 Markdown 包。有没有人有一个使用 python 的工作示例，例如：

```
lines = markdown.markdown(lines,extensions=[MarkdownLatex()] 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:33:47.303

您可以将扩展名的文件重命名为“mdx_latex.py”，然后在同一目录中运行以下命令：

```
import markdown
md = markdown.Markdown(extensions=['latex'])
out = md.convert(text) 
```

# javascript - 检查javascript中的某些网址？

> ID：10021018
> 
> 赞同：0
> 
> 时间：2012-04-05T00:09:13.457
> 
> 标签：javascript, javascript-events

如果找到匹配项，我如何在 javascript 中添加一些内容来检查网站上某人的网站 url，然后重定向到网站上的某个页面？例如...

我们要检查的字符串将是`mydirectory`，所以如果有人去`mysite.com/mydirectory/anyfile.php`甚至`mysite.com/mydirectory/index.php`javascript 会重定向他们的页面/url，`mysite.com/index.php`因为它`mydirectory`在 url 中有，我怎么能用 javascript 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:19:09.540

看看`window.location`，特别是[它的属性和方法](https://developer.mozilla.org/en/DOM/window.location#Properties)。您会对（部分）`pathname`属性（您可以将其拆分`/`）和`href`更改页面的属性感兴趣。

这一切都假设首先提供 javascript；所以我假设`anyfile.php`并且`index.php`都会导致 JS 被提供，而不是一些“通用 404”消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T00:22:31.550

如果我正确理解了这个问题，那么它相当简单，可以使用 document.URL 来实现

```
var search = 'mydirectory'; // The string to search for in the URL.
var redirect = 'http://mysite.com/index.php' // Where we will direct users if it's found
if(document.URL.substr(search) !== -1) { // If the location of 
    // the current URL string is any other than -1 (doesn't exist)
    document.location = redirect // Redirect the user to the redirect URL.
} 
```

使用 document.URL 您可以检查 URL 中的任何内容，但是您可能需要考虑使用 Apache 的 mod_rewrite 之类的东西来在用户加载页面之前重定向用户。

# algorithm - 笛卡尔/组合算法（同时保持顺序）

> ID：10021021
> 
> 赞同：2
> 
> 时间：2012-04-05T00:09:33.803
> 
> 标签：algorithm, combinations, cartesian-product

由于我不太了解这些类型的算法的语言（即如何用谷歌搜索），我将只演示我正在寻找的内容：

我有一个三个数组（源数组的长度不相等）：

```
$array1 = array('A', 'B', 'C', 'D');
$array2 = array('x', 'y', 'z');
$array3 = array('1', '2', '3'); 
```

我想要这些数组的所有可能组合，其中：

*   每个源数组中的元素不超过一个。
*   array1、array2、array3 的顺序永远不会被打破（`ABC`总是在之前`xyz`总是在之前`123`）。

所以结果是：

```
array(
  array('A', 'x', '1'),
  array('A', 'x', '2'),
  array('A', 'x', '3'),
  array('A', 'y', '1'),
  // etc ...

  // But I also need all the partial sets, as long as the rule about
  // ordering isn't broken i.e.:
  array('B'),
  array('B', 'x'),
  array('B', 'x', '1'),
  array('x'),
  array('x', '1'),
  array('1'),
); 
```

结果的顺序对我来说并不重要。

在 php 中工作，但类似的语言或伪代码当然可以。或者我只是对我应该查看哪些特定类型的排列/组合算法提出建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:27:09.000

我会说这些是笛卡尔积。生成它们非常容易。

*   对于固定数量的数组（在 Perl 中）：

    ```
    for my $a(@arrayA) {
      for my $b(@arrayB) {
        push @result, [$a, $b];
      }
    } 
    ```

*   一般过程：假设`@partial`是一个笛卡尔积的数组，`A1 x A2 x ... x An`我们想要`A1 x ... x An x An+1`

    ```
    for my $a(@partial) {
      for my $b(@An_plus_1) {
        push @result, [@$a, $b];
      }
    } 
    ```

    这显然需要遍历所有数组。

现在，您还想省略集合中的一些元素，只需稍微扭曲一下即可。在第一种方法中，您可以向每个数组添加另一个元素（这`undef`是显而易见的选择，但任何事情都可以），然后在结果集中过滤掉这些元素。在第二种方法中，它更容易：您只需将`@partial`和添加`map { [$_] } @An_plus_1`到结果（或者，在英语中，由 的部分笛卡尔积得到的所有集合`A1 x ... x An`加上由新集合的元素组成的单元素集合）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:32:39.090

根据 RBarryYoung 的提示，这是生成它们的最短方法 bash（和 sed，用于删除 D、w 和 4）：

```
echo {A..D}{w..z}{1..4} | sed 's/[Dw4]//g' 
```

> A1 A2 A3 A Ax1 Ax2 Ax3 Ax Ay1 Ay2 Ay3 Ay Az1 Az2 Az3 Az B1 B2 B3 B Bx1 Bx2 Bx3 Bx By1 By2 By3 By Bz1 Bz2 Bz3 Bz C1 C2 C3 C Cx1 Cx2 Cx3 Cx Cy1 Cy2 Cy3 Cy Cz1 Cz2 Cz3 Cz 1 2 3 x1 x2 x3 x y1 y2 y3 y z1 z2 z3 z

另一种简单的方法是 SQL，它默认执行此操作：

```
SELECT upper, lower, num 
FROM uppers, lowers, numbers
WHERE upper in ('A', 'B', 'C', ' ')
AND lower in (' ', 'x', 'y', 'z')
AND (number in (1, 2, 3) OR number IS NULL); 
```

如果您的表格仅包含“A,B,C,,”和“x,y,z,,,”和“1,2,3”，则它要短得多：

```
SELECT upper, lower, num 
FROM uppers, lowers, numbers; 
```

另一个词，除了*笛卡尔积*之外，这种组合是*叉积*。

对于未知数量的未知大小的列表/序列/其他集合，我会推荐一个迭代器——如果 PHP 有这样的东西。这是Scala中的一个实现：

```
 class CartesianIterator (val ll: Seq[Seq[_]]) extends Iterator [Seq[_]] {
    var current = 0
    def size = ll.map (_.size).product
    lazy val last: Int = len

    def get (n: Int, lili: Seq[Seq[_]]): List[_] = lili.length match {
      case 0 => List () 
      case _ => {
        val inner = lili.head 
        inner (n % inner.size) :: get (n / inner.size, lili.tail) 
      }
    }

    override def hasNext () : Boolean = current != last
    override def next (): Seq[_] = {
      current += 1
      get (current - 1, ll) 
    }
  }

  val ci = new CartesianIterator (List(List ('A', 'B', 'C', 'D', ' '), List ('x', 'y', 'z', ' '), List (1, 2, 3, 0)))
  for (c <- ci) println (c)

List(A, x, 1)
List(B, x, 1)
List(C, x, 1)
List(D, x, 1)
List( , x, 1)
List(A, y, 1)
List(B, y, 1)
...
List( , z, 0)
List(A,  , 0)
List(B,  , 0)
List(C,  , 0)
List(D,  , 0)
List( ,  , 0) 
```

包装器可用于从输出中删除“0”和“”。

# python - Python/Cherrypy 处理从 Kwargs 上传的文件。实例类型不可索引。尝试转储 FieldStorage 数据

> ID：10021029
> 
> 赞同：0
> 
> 时间：2012-04-05T00:11:04.030
> 
> 标签：python, cherrypy, keyword-argument

我正在运行cherrypy和一个接收文件的模块，我想将数据转储到磁盘。我不想使用cherrypy暴露并从我的主cherrypy应用程序中获取文件，而是想自己处理它。我已经能够做到这一点

`print kwargs['image']`

并将其转储到控制台

`FieldStorage('image', 'Diagram1.jpeg', *raw image data*)`

如何访问那里的三个变量并在我的程序中使用它们？

如果我尝试索引它们，它会说，实例类型不可索引。

我能够摆脱这个`print kwargs['image'].__dict__`

```
{'fp': <cherrypy.wsgiserver.SizeCheckWrapper object at 0x23ba510>,
'disposition_options': {'name': 'image', 'filename': 'Diagram1.jpeg'},
'innerboundary': '',
'name': 'image',
'_FieldStorage__file': None,
'list': None,
'filename': 'Diagram1.jpeg',
'keep_blank_values': 1,
'headers': <rfc822.Message instance at 0x23c1830>,
'length': -1,
'done': 1,
'disposition': 'form-data',
'qs_on_post': None,
'strict_parsing': 0,
'file': <open file '<fdopen>',
mode 'w+b' at 0x23a1270>,
'outerboundary': '----WebKitFormBoundary5KJ5TEJBxEKAvcW1',
'type_options': {},
'type': 'image/jpeg'} 
```

但它似乎都没有，因为它说`TypeError: not indexable`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T11:31:39.220

你`kwargs['image']`是一个`FieldStorage`对象。该`__dict__`方法是一个包装器，因此您可以执行`dict(kwargs['image'])`.

# c# - 在我的应用程序中编辑 docx 的 asp.net + c# 提示

> ID：10021030
> 
> 赞同：2
> 
> 时间：2012-04-05T00:11:15.860
> 
> 标签：c#, asp.net, visual-studio-2010, ms-word

> **可能重复：**
> [打开/处理 Word 文档，如 SharePoint](https://stackoverflow.com/questions/1907960/open-handle-word-documents-like-sharepoint)

我开发了一个网站，可以在其中上传 docx 文件。现在我想要一种直接在浏览器中编辑它的方法，我的意思是，一种像谷歌文档一样的方法。

或者

从 MSWord 复制到我的应用程序窗口 e 维护所有格式，包括表格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T06:39:08.237

对于 word 文档的操作，您可以使用[**DocX**](http://docx.codeplex.com/)。有了这个，您可以读取/写入 word 文档（docx 不是 doc）。然而，这距离以类似谷歌文档的方式编辑您的文档还有很长的路要走......

它确实符合您的第二个要求！

# c# - 如何从字符串中删除特定字符的所有实例？

> ID：10021036
> 
> 赞同：42
> 
> 时间：2012-04-05T00:11:37.200
> 
> 标签：c#, string

我正在尝试从字符串中删除所有特定字符。我一直在使用`String.Replace`，但它什么也没做，我不知道为什么。这是我当前的代码：

```
 if (Gamertag2.Contains("^"))
        {
            Gamertag2.Replace("^" + 1, "");
        } 
```

这只是让字符串保持原样。谁能向我解释为什么？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-04-05T00:15:12.180

您必须将返回值分配给[`String.Replace`](http://msdn.microsoft.com/en-us/library/fk49wtc1.aspx)原始字符串实例：

因此而不是（不需要`Contains check)`

```
if (Gamertag2.Contains("^"))
{
    Gamertag2.Replace("^" + 1, "");
} 
```

只是这个（那是什么神秘的`+1`？）：

```
Gamertag2 = Gamertag2.Replace("^", ""); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-05T00:14:07.407

两件事情：

1) C# 字符串是不可变的。你需要这样做：

```
Gamertag2 = Gamertag2.Replace("^" + 1, ""); 
```

2) `"^" + 1`? 你为什么做这个？您基本上是在说`Gamertag2.Replace("^1", "");`我确定这不是您想要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-12T18:50:08.417

就像攀登说的，你的问题肯定是

```
Gamertag2.Replace("^"+1,""); 
```

该行只会从您的字符串中删除“^1”的实例。如果要删除“^”的所有实例，您想要的是：

```
Gamertag2.Replace("^",""); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-11T09:35:50.960

我知道这个线程很旧，而且我的解决方案可能效率极低，但它替换了所有出现的字符串。发现如果我正在寻找 "\r\n\r\n\r\n" 以替换为 "\r\n\r\n" 单个 Replace() 并不能全部捕获。

为此：

```
do // First get rid of spaces like "  \r"
{
  str = str.Replace(" \r","\r")
} while (str.Cointains(" \r"));

do // Then remove the CrLf's in surplus.
{
  str = str.Replace("\r\n\r\n\r\n","\r\n\r\n")
} while (str.Cointains("\r\n\r\n\r\n")); 
```

# mysql - 在 MYSQL 中组合 2 个表并删除重复项的最佳方法是什么？

> ID：10021037
> 
> 赞同：1
> 
> 时间：2012-04-05T00:11:45.920
> 
> 标签：mysql, group-by, multiple-tables

我有 2 张桌子：

```
matches TABLE
   FIELDS: record, date, competition

outrights TABLE
   FIELDS: record, competition 
```

我想要的是选择按不同类型的比赛分组的行。以下是当我单独处理每个表时可以正常工作的语句。

首先，从“匹配”开始，并且仅当日期尚未过去时：

```
SELECT competition, date FROM matches WHERE date >= '$currentTime' GROUP BY competition 
```

后跟来自'outrights'的行：

```
SELECT competition FROM outrights GROUP BY competition 
```

这一切都非常简单，除了相同的竞争值经常（但不总是）出现在两个表中。我查看了许多不同的方法（包括 LEFT 和 RIGHT JOINS），但还没有找到一个简单的解决方案。基本上我想要两个表中出现的不同竞争类型，没有重复。这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T00:21:51.323

这是你想要的。对这个问题有点困惑，但您似乎想要两个表中竞争列的 DISTINCT 列表

```
SELECT DISTINCT competition 
FROM
(
    SELECT competition  FROM matches
    UNION
    SELECT competition from outrights
) AS t 
```

如果您需要只出现在两个表中而不是一个或两个表中的不同比赛，您可以使用

```
SELECT DISTINCT competition 
FROM
(
    SELECT competition  FROM matches INNER JOIN 
        outrights ON matches.competition = outrights.competition
) AS t 
```

# mips - MIPS中的字符数组

> ID：10021039
> 
> 赞同：2
> 
> 时间：2012-04-05T00:12:05.417
> 
> 标签：mips

我将如何创建一个字符数组并在 MIPS 中访问这些字符？我正在做一个项目，其中一部分就是这样做。我了解如何使用整数并且无法在网上找到任何关于如何处理字符的参考，特别是我试图移植......

```
static char   hexdigits[16] = "0123456789ABCDEF"; 
```

这是我失败的尝试：

```
hexarray: .word '0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F' #declare memory space for our hex array 
```

编辑：如果有人可以提供一个示例如何打印出这些项目之一，那将非常有帮助（您可以根据需要修改我拥有的代码）。因为我刚刚收到内存地址错误。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-05T05:24:40.197

```
static char   hexdigits[16] = "0123456789ABCDEF"; 
```

可以翻译成：

```
.data
hexdigits: .byte '0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F' 
```

或者

```
.data
hexdigits: .ascii "0123456789ABCDEF" 
```

我们可以使用

```
la    $t0, hexdigits
lb    $t1, 0($t0)        # $t1 = hexdigits[0]
lb    $t2, 1($t0)        # $t2 = hexdigits[1] 
```

您可以使用系统调用打印元素（如果您的模拟器支持它。大多数都支持）

```
la    $t0, hexdigits          # address of the first element
lb    $a0, 10($t0)            # hexdigits[10] (which is 'A')
li    $v0, 11                 # I will assume syscall 11 is printchar (most simulators support it)
syscall                       # issue a system call 
```

# c# - 试图在编译时分配一个大数字

> ID：10021046
> 
> 赞同：3
> 
> 时间：2012-04-05T00:14:06.437
> 
> 标签：c#, compiler-construction, checked, unchecked

以下两个操作是相同的。但是，MaxValues1 将无法编译，因为“在检查模式下编译时操作溢出”。有人可以解释一下编译器发生了什么以及我如何绕过它而不必使用 MaxValues2 中的硬编码值？

```
public const ulong MaxValues1 = 0xFFFF * 0xFFFF * 0xFFFF;

public const ulong MaxValues2 = 0xFFFD0002FFFF; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T00:19:58.970

要获得无符号文字，请添加`u`后缀，并使它们长为`l`后缀。即你需要`ul`。

如果你真的想要溢出行为，你可以添加`unchecked`get`unchecked(0xFFFF * 0xFFFF * 0xFFFF)`但这可能不是你想要的。你会得到溢出，因为文字被解释为`Int32`而不是`ulong`，并且`0xFFFF * 0xFFFF * 0xFFFF`不适合 32 位整数，因为它大约是 2^48。

```
public const ulong MaxValues1 = 0xFFFFul * 0xFFFFul * 0xFFFFul; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T00:21:22.360

默认情况下，整数文字的类型是`int`. 您可以添加“UL”后缀以将它们更改为`ulong`文字。

```
public const ulong MaxValues1 = 0xFFFFUL * 0xFFFFUL * 0xFFFFUL;

public const ulong MaxValues2 = 0xFFFD0002FFFFUL; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T00:21:37.487

为每个数字添加数字后缀“UL”。否则，C# 将它们视为 Int32。

[C# - 数字后缀](https://stackoverflow.com/questions/3569695/c-sharp-numeric-suffixes)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T00:20:13.180

我认为它实际上不是一个`ulong`，直到你最后分配它，尝试

```
public const ulong MaxValues1 = (ulong)0xFFFF * (ulong)0xFFFF * (ulong)0xFFFF; 
```

即在`MaxValues1`您将 3 个 32 位整数相乘在一起时溢出，因为结果暗示为另一个 32 位整数，当您将操作更改为乘以 3`ulongs`时，这不会溢出，因为您推断结果是`ulong`

```
(ulong)0xFFFF * 0xFFFF * 0xFFFF;

0xFFFF * (ulong)0xFFFF * 0xFFFF; 
```

也可以作为结果类型根据最大类型计算

但

```
0xFFFF * 0xFFFF * (ulong)0xFFFF; 
```

将不起作用，因为前 2 个将溢出 int

# c++ - 成员函数指针和继承

> ID：10021062
> 
> 赞同：3
> 
> 时间：2012-04-05T00:16:42.367
> 
> 标签：c++, winapi, visual-studio-2010

因此，为了自己的方便，我正在开发一个简单的 win32 包装器，但我遇到了一个稍微复杂的问题。

这有很多其他成员，但我省略了一点，只留下有问题的成员。

```
class Windows::AbstractWindow
{
public:
     void InstallHandler(UINT msgName, void (Windows::AbstractWindow::*)(HWND, UINT, WPARAM, LPARAM));

private:
     std::map<UINT, void (Windows::AbstractWindow::*)(HWND, UINT, WPARAM, LPARAM)> HandlerIndex;

}; 
```

（作为记录，在这种情况下，Windows 是我制作的各种类和对象的命名空间）

只是有点讨厌，但请解释我的过程和推理。我有一个名为 AbstractWindow 的类，它以非常面向对象的方式包含窗口的大部分功能。

我现在正在研究一种获取私有成员函数的方法，并通过指向它们的指针将它们存储在映射中，这些指针由它们应该处理的 Windows 消息标识。这样，当 Windows 过程接收到一条消息时，它会通过这个映射来查看您是否为它安装了一个处理程序。如果有，它会调用该函数并退出。它没有调用 DefWindowProc 并退出。很容易。

然而，这个对象永远不应该被实例化，而只是应该被继承和扩展。问题是，该映射的函数指针声明属于 AbstractWindow 类型，它不允许我存储从 AbstractWindow 继承的类型的成员函数指针。例如，

```
class BasicWindow : public Windows::AbstractWindow
{
public:
    BasicWindow() 
    {
         InstallHandler(WM_CREATE, &create);
    }

private:
    void Create(HWND, UINT, WPARAM, LPARAM) {}
} 
```

...产生一个错误：

```
error C2664: 'Windows::AbstractWindow::InstallHandler' : cannot convert parameter 2 from 'void (__thiscall BasicWindow::* )(HWND,MSG,WPARAM,LPARAM)' to 'void (__thiscall Windows::AbstractWindow::* )(HWND,UINT,WPARAM,LPARAM)' 
```

因为指针类型不一样，尽管是从基类继承的。那么有没有人想提出一个解决方案，同时仍然保持这种方法？如果没有，我也愿意接受您认为会使消息处理比这种方式更方便的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T00:43:05.603

您面临的问题是您正试图以相反的方式进行转换。函数指针的参数是逆变的`this`（即，指向基类函数的函数指针将用于指向派生类方法的函数指针，反之亦然）。你可以：

*   只需强制转换（使用`static_cast`，因为它与隐式转换相反）。只要您可以确保永远不会在不适当的类（例如`NotABasicWindow().*method()`）上调用该方法，它就可以正常工作。
*   摆脱该方案，并注册通用函数（即任何可以调用的东西，而不是成员函数指针）。你会使用例如。`std::function<void(HWND, UINT, WPARAM, LPARAM)>`作为您的处理程序类型并注册将知道其窗口的处理程序（例如 lambda 函数）。

    *   [lambda 函数是 C++11 的一个特性](https://stackoverflow.com/q/7627098/51831)。它们大致对应于带有活页夹的函数对象；他们创建了一个匿名函数，可以从它们所在的范围内引用变量。一个例子是

        ```
        [=](HWND wnd, UINT i, WPARAM wp, LPARAM lp) { this->printHandler(wnd, i, wp, lp); } 
        ```

        它会记住`this`，所以它会在调用时调用`printHandler`当前对象（创建 lambda 的代码的当前，而不是调用代码）。当然，应该调用该方法的对象可能只是另一个参数。

        Lambda 以及其他函数对象（即已`operator()`定义的对象）可以转换为对象并存储为`std::function`对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T15:29:33.117

您应该阅读 Curiously Recurring Template Pattern ( [http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern) )。

基本上，您将基类转换为模板，其中包含指定子类的模板参数。

如果您看到它，也许会更容易理解：

```
namespace Windows
{
     template <typename T>
     class AbstractWindow
     {
     public:
          void InstallHandler(UINT msgName, void (T::*)(HWND, UINT, WPARAM, LPARAM));

     private:
          std::map<UINT, void (T::*)(HWND, UINT, WPARAM, LPARAM)> HandlerIndex;

     };
}

class BasicWindow : public Windows::AbstractWindow< BasicWindow >
{
public:
    BasicWindow() 
    {
         InstallHandler(WM_CREATE, &BasicWindow::Create);
    }

private:
    void Create(HWND, UINT, WPARAM, LPARAM) {}
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:41:47.790

这种性质的东西会起作用吗……？附言。我使用 typedef 作为函数签名。

```
BasicWindow() 
    {
         InstallHandler(WM_CREATE, reinterpret_cast<void (__thiscall Windows::AbstractWindow::* )(HWND,UINT,WPARAM,LPARAM)>(&create));
    } 
```

# android - android预填充数据库程序中的nullPointerException

> ID：10021066
> 
> 赞同：0
> 
> 时间：2012-04-05T00:17:23.923
> 
> 标签：android, nullpointerexception

我正在修改访问预填充数据库的代码。我遇到了 nullPointerException 错误，我不知道发生了什么。我将发布我的代码，如果有人可以提供帮助，我将不胜感激。

活动：

```
 public class Activity1c extends ListActivity {

IngredientHelper mDbHelper=null;
int char_property;
int char_name;
long a=1;

@Override
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.act1c);
    mDbHelper = new IngredientHelper(this);

    Bundle extras = getIntent().getExtras();
    char_name = extras.getInt("char_name");
    char_property = extras.getInt("char_property");
    char_name+=1;
    char_property+=1;

    Toast.makeText(Activity1c.this,
            "The char_name you picked was " + char_name  + " and the property was "+char_property,
            Toast.LENGTH_LONG).show();

    Cursor notesCursor = mDbHelper.fetchNote(a);
    startManagingCursor(notesCursor);

    // Create an array to specify the fields we want to display in the list (only TITLE)
    String[] from = new String[]{IngredientHelper.COLUMN_TITLE,IngredientHelper.COLUMN_TITLE2};

    // and an array of the fields we want to bind those fields to (in this case just text1)
    int[] to = new int[]{R.id.craft_type_display,R.id.spec_type_display};

    // Now create a simple cursor adapter and set it to display
    SimpleCursorAdapter notes = 
        new SimpleCursorAdapter(this, R.layout.finalresult1, notesCursor, from, to);
    setListAdapter(notes);

}///end main

  }///end class 
```

xml/act1c

```
 <?xml version="1.0" encoding="utf-8"?>
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"

  android:layout_width="fill_parent"
    android:layout_height="fill_parent">

<ListView android:id="@+id/android:list"
      android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>
<TextView android:id="@+id/android:empty"
      android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        />
  </LinearLayout> 
```

xml/最终结果1

```
 <?xml version="1.0" encoding="utf-8"?>
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
   android:orientation="vertical" >

   <TextView
    android:id="@+id/craft_type_display"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />

<TextView
    android:id="@+id/spec_type_display"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />

  </LinearLayout> 
```

类/IngredientHelper

```
public class IngredientHelper extends SQLiteOpenHelper{

 //we declare a bunch of useful constants
//the should be pretty obvious what they are!
private static final String DATABASE_PATH = "/data   /data/com.android.Database_Practice_3_31_12/databases/";
private static final String DATABASE_NAME="infotest.sqlite";
private static final int SCHEMA_VERSION=1;
public static final String TABLE_NAME = "info";
public static final String COLUMN_ID = "_id";
public static final String COLUMN_TITLE = "name";
public static final String COLUMN_TITLE2 = "phone";
public static final String COLUMN_TITLE3 = "fav_color";
public static final String COLUMN_TITLE4 = "home_city";

public SQLiteDatabase dbSqlite;

private final Context myContext;

public IngredientHelper(Context context) {
    super(context, DATABASE_NAME, null, SCHEMA_VERSION);
    this.myContext = context;
    // check if exists and copy database from resource
    //createDB();
}

@Override
public void onCreate(SQLiteDatabase db) {
    // check if exists and copy database from resource

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

}
public void createDatabase() {
    createDB();
}

private void createDB() {

    boolean dbExist = DBExists();

    if (!dbExist) {

        //By calling this method we create an empty database into the default system location
        //We need this so we can overwrite that database with our database.
        this.getReadableDatabase();
        //now we copy the database we included!
        copyDBFromResource();

    }

}    

private boolean DBExists() {

    SQLiteDatabase db = null;

    try {
        String databasePath = DATABASE_PATH + DATABASE_NAME;
        db = SQLiteDatabase.openDatabase(databasePath, null,
                SQLiteDatabase.OPEN_READWRITE);
        db.setLocale(Locale.getDefault());
        db.setLockingEnabled(true);
        db.setVersion(1);

    } catch (SQLiteException e) {

        Log.e("SqlHelper", "database not found");

    }

    if (db != null) {

        db.close();

    }

    return db != null ? true : false;
}

private void copyDBFromResource() {

    InputStream inputStream = null;
    OutputStream outStream = null;
    String dbFilePath = DATABASE_PATH + DATABASE_NAME;

    try {

        inputStream = myContext.getAssets().open(DATABASE_NAME);

        outStream = new FileOutputStream(dbFilePath);

        byte[] buffer = new byte[1024];
        int length;
        while ((length = inputStream.read(buffer)) > 0) {
            outStream.write(buffer, 0, length);
        }

        outStream.flush();
        outStream.close();
        inputStream.close();

    } catch (IOException e) {

        throw new Error("Problem copying database from resource file.");

    }

}

public void openDataBase() throws SQLException {

    String myPath = DATABASE_PATH + DATABASE_NAME;
    dbSqlite = SQLiteDatabase.openDatabase(myPath, null,
            SQLiteDatabase.OPEN_READWRITE);

}

@Override
public synchronized void close() {

    if (dbSqlite != null)
    {
        dbSqlite.close();
    }
    super.close();

}

public Cursor getCursor() {

    SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();

    queryBuilder.setTables(TABLE_NAME);

    String[] asColumnsToReturn = new String[] { COLUMN_ID,COLUMN_TITLE};

    //make sure you get your search by string pass correctly!
    Cursor mCursor = queryBuilder.query(dbSqlite, asColumnsToReturn, null,
            null, null, null, null);

    return mCursor;
}

public String getName(Cursor c) {
    return(c.getString(1));
}

public Cursor fetchNote(long rowId) throws SQLException {

    Cursor mCursor =

        dbSqlite.query(true, TABLE_NAME, new String[] {
                COLUMN_ID,  COLUMN_TITLE,COLUMN_TITLE2,COLUMN_TITLE3,COLUMN_TITLE4}, COLUMN_ID + "=" + rowId, null,
                null, null, null, null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;

} 
```

}

日志猫

```
 04-04 19:54:50.764: E/AndroidRuntime(454): Uncaught handler: thread main exiting due to uncaught exception
 04-04 19:54:50.774: E/AndroidRuntime(454): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.android.Database_Practice_3_31_12/com.android.Database_Practice_3_31_12.Activity1c}: java.lang.NullPointerException
 04-04 19:54:50.774: E/AndroidRuntime(454):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)
 04-04 19:54:50.774: E/AndroidRuntime(454):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
 04-04 19:54:50.774: E/AndroidRuntime(454):     at android.app.ActivityThread.access$2200(ActivityThread.java:119)
 04-04 19:54:50.774: E/AndroidRuntime(454):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
 04-04 19:54:50.774: E/AndroidRuntime(454):     at android.os.Handler.dispatchMessage(Handler.java:99)
 04-04 19:54:50.774: E/AndroidRuntime(454):     at android.os.Looper.loop(Looper.java:123)
 04-04 19:54:50.774: E/AndroidRuntime(454):     at android.app.ActivityThread.main(ActivityThread.java:4363)
04-04 19:54:50.774: E/AndroidRuntime(454):  at java.lang.reflect.Method.invokeNative(Native Method)
04-04 19:54:50.774: E/AndroidRuntime(454):  at java.lang.reflect.Method.invoke(Method.java:521)
04-04 19:54:50.774: E/AndroidRuntime(454):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
04-04 19:54:50.774: E/AndroidRuntime(454):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
04-04 19:54:50.774: E/AndroidRuntime(454):  at dalvik.system.NativeStart.main(Native Method)
04-04 19:54:50.774: E/AndroidRuntime(454): Caused by: java.lang.NullPointerException
04-04 19:54:50.774: E/AndroidRuntime(454):  at com.android.Database_Practice_3_31_12.IngredientHelper.fetchNote(IngredientHelper.java:173)
04-04 19:54:50.774: E/AndroidRuntime(454):  at com.android.Database_Practice_3_31_12.Activity1c.onCreate(Activity1c.java:49)
04-04 19:54:50.774: E/AndroidRuntime(454):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
 04-04 19:54:50.774: E/AndroidRuntime(454):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:05:13.350

哎呀。很难遵循所有这些。

首先，您在 fetchNote() 中遇到错误。在堆栈跟踪中，从底部算起的第 5 行显示了这一点。您可以使用末尾的行号来接近它发生的*位置。*

我的猜测是查询失败。

我进一步的猜测是，这是因为您正试图通过从其他地方逐字节复制数据库来“恢复”数据库。我不相信这会奏效。在应用程序中提供预填充数据库的最佳方法是将其数据放在一个平面文件中，然后在应用程序首次运行时创建数据库并将数据写入其中。

在开发人员指南中，示例应用程序 SearchableDictionary 中的源文件 DictionaryDatabase.java 提供了示例代码。

# loops - 汇编语言求和

> ID：10021071
> 
> 赞同：-2
> 
> 时间：2012-04-05T00:17:45.077
> 
> 标签：loops, x86-64, nasm

> **可能重复：**
> [带 x86-64 组件的谐波系列](https://stackoverflow.com/questions/10002349/harmonic-series-with-x86-64-assembly)

试图在汇编中做一个谐波系列的版本

当前代码采用 1 + 1/2 + 1/3 + 1/4 + 1/n 直到求和的值大于输入的值。（浮点值）

当前代码在第一次循环后退出循环并打印出 .33333

这是我的退出条件吗？

```
denominator:
xor r14,r14             ;zero out r14 register
add r14, 2              ;start counter at 2
fld1                    ;load 1 into st0
fxch    st2
denomLoop:
fld1
mov [divisor], r14              ;put 1 into st0
fidiv   dword [divisor]         ;divide st0 by r14
inc r14             ;increment r14
fst qword [currentSum]      ;pop current sum value into currentSum
addParts:
fxch    st2             ;put the current value that is in st2 into st0
fadd    qword [currentSum]      ;add result of first division to 1
fxch    st2             ;place result of addition into st2
fld qword [realNumber]          ;place real number into st0
;compare to see if greater than inputed value
fcom    st2             ;compare st0 with st2
fstsw   ax              ;needed to do floating point comparisons on FPU
sahf                    ;needed to do floating point comaprisons on FPU
jae done                ;jump if greater than
jmp denomLoop           ;jump if less than 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:22:02.713

这条线似乎很可疑：

```
fst qword [currentSum]      ;pop current sum value into currentSum 
```

与注释相反，`fst`将堆栈顶部存储到内存中而不弹出它。如果你想`fstp`弹出它，你想要。

# delphi - 求很简单的TIdCommandHandler条件响应例子

> ID：10021073
> 
> 赞同：2
> 
> 时间：2012-04-05T00:18:03.743
> 
> 标签：delphi, indy10

德尔福 XE2，所以印地 10。

我的客户端发送一个由我的 TIdCmdTCPServer 的 TIdCommandHandler 处理的命令。

我希望能够执行一些逻辑并返回成功或失败响应并在客户端进行检查。

有人可以以几行代码为例吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:32:08.610

好吧，这是最简单的演示。

![在此处输入图像描述](../Images/9fe8f88598f05de0be2e75cf5fc4abb7.png)

在表单中添加一个 IdCmdTCPServer，并添加一个命令，在`Command`属性中设置它的名称，我原本以为我应该像这样处理事件中的响应`OnCommand`：

```
procedure TForm1.IdCmdTCPServer1CommandHandlers0Command(ASender: TIdCommand);
begin
   //ASender.Response.Add('Hello');  // wrong way
   ASender.Reply.SetReply(0,'HELLO');

end; 
```

**更新**Remy 指出我不应该使用 Response。

所以你想返回成功或失败，传统上使用数字结果后跟字符串值。响应字符串列表中的每个字符串都有一个隐含的行尾传输回客户端：

```
procedure TForm1.IdCmdTCPServer1CommandHandlers0Command(ASender: TIdCommand);
begin
  if DoSomething then
    ASender.Reply.SetReply(0,'OK')
  else
    ASender.Reply.SetReply(999,'ERROR');

end; 
```

IdCommandHandler 和 CmdTCPServer/Client 的想法是遵循基于 ANSI/ASCII 文本的“RFC”协议风格。RFC 风格的 Internet 协议的回复通常通过网络编码为具有数字和字符串值的文本。 `ASender.Response`如果您需要获取字符串列表的内容并将其作为响应返回，则可以使用它。

至于客户端，[这里的一个问题表明 TIdCmdTcpClient 不是为此服务器构建客户端的最自然方式](https://stackoverflow.com/questions/2060751/should-tidcmdtcpserver-and-tidcmdtcpclient-be-used-together)。从他们的名字来看，你会认为他们是为彼此而生的，但事实并非如此。对于您可以构建的大多数简单 TIdCMDTCPServer，您会发现普通香草`TIdTCPClient`是启动客户端的最简单的构建块。

# algorithm - 具有 16 位元素的 10000 个数组，查找位集（无限 RAM） - Google 采访

> ID：10021074
> 
> 赞同：21
> 
> 时间：2012-04-05T00:18:33.797
> 
> 标签：algorithm, data-structures

这是我最近在谷歌采访中提出的问题，我提供了一个涉及位移的答案，并且是 O(n)，但她说这不是最快的方法。我不明白，有没有办法计算所设置的位而不必遍历提供的整个位？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-05T00:33:20.343

蛮力：10000 * 16 * 4 = 640,000 次操作。（每个 16 位字的移位、比较、递增和迭代）

*更快的方式：*

我们可以建立表 00-FF -> 设置的位数。256 * 8 * 4 = 8096 次操作

即，我们建立一个表格，我们为每个字节计算一组位。

然后对于每个 16 位 int 我们将其拆分为上和下

```
for (n in array)
   byte lo = n & 0xFF; // lower 8-bits
   byte hi = n >> 8;   // higher 8-bits
   // simply add number of bits in the upper and lower parts 
   // of each 16-bits number
   // using the pre-calculated table
   k += table[lo] + table[hi];
} 
```

迭代中总共有 60000 次操作。即总共 68096 次操作。虽然它是 O(n)，但常数较小（约少 9 倍）。

换句话说，我们计算每个 8 位数字的位数，然后将每个 16 位数字拆分为两个 8 位，以便计算使用预建表设置的位。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-05T00:20:54.727

（几乎）总是有更快的方法。阅读有关[查找表](http://en.wikipedia.org/wiki/Lookup_table)的信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-17T02:08:23.120

当被问到这个问题时，我不知道正确答案是什么，但我相信今天解决这个问题最明智的方法是使用`POPCNT`指令。具体来说，您应该使用*64 位*版本。由于我们只需要设置位的总数，因此我们不关心 16 位元素之间的边界。由于 32 位和 64 位`POPCNT`指令[同样快](https://software.intel.com/en-us/forums/topic/289168)，因此您应该使用 64 位版本来计算每个周期的四个元素的位数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-16T20:51:46.980

我刚刚用Java实现了它：

```
import java.util.Random;

public class Main {

static int array_size = 1024;
static int[] array = new int[array_size];
static int[] table = new int[257];
static int total_bits_in_the_array = 0;

private static void create_table(){
    int i;
    int bits_set = 0;

    for (i = 0 ; i <= 256 ; i++){
        bits_set = 0;
        for (int z = 0; z <= 8 ; z++){
            bits_set += i>>z & 0x1;
        }
    table[i] = bits_set;
    //System.out.println("i = " + i + " bits_set = " + bits_set);
    }

}

public static void main(String args[]){
        create_table();
        fill_array();
        parse_array();
        System.out.println("The amount of bits in the array is: " + total_bits_in_the_array);
}

private static void parse_array() {
    int current;

    for (int i = 0; i < array.length; i++){
        current = array[i];

        int down = current & 0xff; 
        int up = current & 0xff00;

        int sum = table[up] + table[down];

        total_bits_in_the_array += sum;
    }       
}

private static void fill_array() {
    Random ran = new Random();

    for (int i = 0; i < array.length; i++){
        array[i] = Math.abs(ran.nextInt()%512);
    }

}
} 
```

也在[https://github.com/leitao/bits-in-a-16-bits-integer-array/blob/master/Main.java](https://github.com/leitao/bits-in-a-16-bits-integer-array/blob/master/Main.java)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-24T07:59:06.570

您可以预先计算以字节为单位的位计数，然后将其用于查找。如果您做出某些假设，它会更快。

操作数（仅计算，不读取输入）应采用以下

**换档方法**：

对于每个字节：2 次操作（移位、加法）乘以 16 位 = 32 次操作，0 次内存访问次数 10000 = 320 000 次操作 + 0 次内存访问

**预计算方法：**

255 次 2 次操作（移位、加法）乘以 8 位 = 4080 次操作 + 255 次内存访问（写入结果）

对于每个字节：2 ops（计算地址）+ 2 mem 访问 + op（添加结果）= 30 000 ops + 20 000 mem 访问

总计 30 480 个操作 + 20 255 个内存访问

所以更多的内存访问和更少的操作

因此，假设其他一切都相同，如果我们可以假设内存访问比操作快 (320 000 - 30 480)/20 255 = 14.29 倍，那么 10 000 字节的预计算会更快

如果您独自在一个相当现代的盒子上的专用内核上，这可能是正确的，因为 255 字节应该适合缓存。如果您开始出现缓存未命中，则该假设可能不再成立。

此外，该数学假设指针算术和直接内存访问以及原子操作和原子内存访问。根据您选择的语言（显然，根据之前的答案，您选择的编译器切换），该假设可能不成立。

最后，如果您考虑可扩展性，事情会变得更有趣：移位可以轻松地并行化到多达 10000 个内核上，但不一定要进行预计算。然而，随着字节数的增加，查找变得越来越有利。

所以，简而言之。是的，在相当合理的假设下，预计算会更快，但不，不能保证会更快。

# php - mysql/php 时区问题

> ID：10021075
> 
> 赞同：1
> 
> 时间：2012-04-05T00:18:43.137
> 
> 标签：php, mysql, timestamp

我正在尝试为 mysql 条目使用时间戳，但它显示为 20 小时之后。

当我在 mysql 命令行中输入以下内容时，会显示正确的时间（目前是东部时间晚上 8:15）

```
SELECT NOW(); 
```

当我使用以下内容将某些内容提交到我的数据库时，除了时间显示为上午 12:15 之外，一切都是正确的。

```
date('m/d/Y,h:i:a'); 
```

如果这很重要，我表中的列是 varchar(20)。

我还尝试通过使用确保将其设置为东部时区，但出现错误说时区不正确。

```
SET time_zone = 'America/New_York'; 
```

有没有人知道为什么我在数据库条目中关闭了 20 小时，但是当我使用 mysql 命令行查找它正确显示的时间时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:27:34.187

我假设这是一个 PHP 时区问题。您应该检查您在 PHP ini 文件中设置的时区。

```
[Date]
; Defines the default timezone used by the date functions
date.timezone = America/New_York 
```

您还可以在脚本中设置时区：

```
ini_set('date.timezone', 'America/New_York'); 
```

好像您正试图更改 MySQL 中的时区。您还应该检查您的时区设置 MySQL，以确保。

# mysql - 在此查询上使用 RIGHT JOIN 时 JOIN 非常慢

> ID：10021077
> 
> 赞同：6
> 
> 时间：2012-04-05T00:18:44.633
> 
> 标签：mysql, query-optimization

我遇到了这个查询的问题，需要几秒钟才能完成。我已经尝试了许多优化，但此时我正在拍摄空白。

表格如下（并且没有完全标准化，尤其是轨道表）

```
CREATE TABLE `tracks` (
`id` int(14) unsigned NOT NULL AUTO_INCREMENT,
`artist` varchar(200) NOT NULL,
`track` varchar(200) NOT NULL,
`album` varchar(200) NOT NULL,
`path` text NOT NULL,
`tags` text NOT NULL,
`priority` int(10) NOT NULL DEFAULT '0',
`lastplayed` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
`lastrequested` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
`usable` int(1) NOT NULL DEFAULT '0',
`accepter` varchar(200) NOT NULL DEFAULT '',
`lasteditor` varchar(200) NOT NULL DEFAULT '',
`hash` varchar(40) DEFAULT NULL,
PRIMARY KEY (`id`),
UNIQUE KEY `hash` (`hash`),
FULLTEXT KEY `searchindex` (`tags`,`artist`,`track`,`album`),
FULLTEXT KEY `artist` (`artist`,`track`,`album`,`tags`)
) ENGINE=MyISAM AUTO_INCREMENT=3336 DEFAULT CHARSET=utf8

CREATE TABLE `esong` (
`id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`hash` varchar(40) COLLATE utf8_bin NOT NULL,
`len` int(10) unsigned NOT NULL,
`meta` text COLLATE utf8_bin NOT NULL,
PRIMARY KEY (`id`),
UNIQUE KEY `hash` (`hash`)
) ENGINE=InnoDB AUTO_INCREMENT=16032 DEFAULT CHARSET=utf8 COLLATE=utf8_bin

CREATE TABLE `efave` (
`id` int(10) unsigned NOT NULL DEFAULT '0',
`inick` int(10) unsigned NOT NULL,
`isong` int(10) unsigned NOT NULL,
UNIQUE KEY `inick` (`inick`,`isong`),
KEY `isong` (`isong`),
CONSTRAINT `inick` FOREIGN KEY (`inick`) REFERENCES `enick` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT `isong` FOREIGN KEY (`isong`) REFERENCES `esong` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8

CREATE TABLE `enick` (
`id` int(10) unsigned NOT NULL AUTO_INCREMENT
`nick` varchar(30) COLLATE utf8_bin NOT NULL,
`dta` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
`dtb` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
PRIMARY KEY (`id`),
KEY `nick` (`nick`)
) ENGINE=InnoDB AUTO_INCREMENT=488 DEFAULT CHARSET=utf8 COLLATE=utf8_bin 
```

我试图以正常速度执行的查询如下

```
SELECT esong.meta, tracks.id FROM tracks RIGHT JOIN esong ON tracks.hash = esong.hash JOIN efave ON efave.isong = esong.id JOIN enick ON efave.inick = enick.id WHERE enick.nick = lower('nickname'); 
```

如果您删除 RIGHT JOIN 并将其更改为 JOIN 它很快

EXPLAIN 给了我这个结果，似乎在 efave 选择中有一个小问题，但我不知道如何解决这个问题

```
+----+-------------+--------+--------+---------------+---------+---------+-----------------------+------+----------+--------------------------+
| id | select_type | table  | type   | possible_keys | key     | key_len | ref                   | rows | filtered | Extra                    |
+----+-------------+--------+--------+---------------+---------+---------+-----------------------+------+----------+--------------------------+
|  1 | SIMPLE      | enick  | ref    | PRIMARY,nick  | nick    | 92      | const                 |    1 |   100.00 | Using where; Using index |
|  1 | SIMPLE      | efave  | ref    | inick,isong   | inick   | 4       | radiosite.enick.id    |   12 |   100.00 | Using index              |
|  1 | SIMPLE      | esong  | eq_ref | PRIMARY       | PRIMARY | 4       | radiosite.efave.isong |    1 |   100.00 |                          |
|  1 | SIMPLE      | tracks | ALL    | hash          | NULL    | NULL    | NULL                  | 3210 |   100.00 |                          |
+----+-------------+--------+--------+---------------+---------+---------+-----------------------+------+----------+--------------------------+ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T00:48:20.773

你的解释看起来很干净，唯一让我印象深刻的是 esong 表使用 utf8_bin 的排序**规则**，而 track 表没有指定排序规则，这意味着它可能使用**了另一种**排序规则类型。尝试对齐排序规则并查看连接的执行情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T00:40:01.377

你检查过你的执行计划吗？如果没有，请运行您的查询以包含它。您的 Right Join 可能正在执行 Index Scan 而不是 Index Seek。或者您可能缺少索引。无论哪种方式，您都需要查看执行计划，以便更好地优化查询。在您知道真正的问题是什么之前，没有人能够真正告诉您如何使用 Right Join（或就此而言的 Join）使其更快。这里有一些链接.. 对于 MySQL：[http](http://dev.mysql.com/doc/refman/5.5/en/execution-plan-information.html) ://dev.mysql.com/doc/refman/5.5/en/execution-plan-information.html 对于 SqlServer：[http ://www.sql-server-performance.com /2006/查询执行计划分析/](http://www.sql-server-performance.com/2006/query-execution-plan-analysis/)

# dvcs - Bazaar - 推、拉或与不同版本和操作系统合并的效果？

> ID：10021080
> 
> 赞同：1
> 
> 时间：2012-04-05T00:19:12.073
> 
> 标签：dvcs, bazaar

假设一个人在 Linux 上使用 Bazaar 2.3，而另一个人在 Windows 上使用 Bazaar 2.5。在不同版本和操作系统上的存储库之间推送、拉取或合并可能会导致问题吗？或者它是否旨在跨不同的发行版本和操作系统进行无缝互操作？较旧和较新的版本，比如 2.6 和 2.2，兼容性是否同样有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:13:32.297

显然 2.x 版本都相互兼容。

# excel - 如何在 Excel 中创建敏捷燃尽图

> ID：10021083
> 
> 赞同：0
> 
> 时间：2012-04-05T00:19:36.677
> 
> 标签：excel, agile, agile-project-management, excel-template

有谁知道 excel 中的免费敏捷燃尽图模板或如何在 excel 中创建燃尽图？我找到了很多燃尽图，但找不到燃尽图的说明或模板。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T03:10:44.577

这是我刚刚在 Google Docs 中创建的快速烧录。您应该能够将其用作创建自己的基础。希望能帮助到你。

[https://docs.google.com/spreadsheet/ccc?key=0AuPj0DNF9GoHdElURXZpdnZheXpQdGE4MnI0Wm8zaVE](https://docs.google.com/spreadsheet/ccc?key=0AuPj0DNF9GoHdElURXZpdnZheXpQdGE4MnI0Wm8zaVE)

谢谢！

布兰登

# mysql - mysql客户端“使用数据库名称”执行时间过长

> ID：10021084
> 
> 赞同：3
> 
> 时间：2012-04-05T00:19:39.077
> 
> 标签：mysql

我的数据库包含大量表（超过 300 个表）。当我在 mysql 命令行客户端上执行“使用数据库名称”命令时，它需要很长时间才能执行。有什么办法可以让它执行得更快。?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-05T00:24:30.737

您可以将`-A`参数传递给`mysql`命令行工具，使其在使用数据库时不加载数据库元数据。

话虽如此，您所描述的通常表明您的表和/或列太多，或者您的数据库服务器过载。通常，两者兼而有之。任何一个都应该修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-03-22T16:23:00.533

我知道它很老的帖子，但想写这篇文章，因为我过去也遇到过同样的问题，发现这一切

在远程连接 mysql 时使用 cli 时会遇到此问题，此问题通常不会在 localhost 上发生。在使用“使用”命令 mysql 检查表的元数据并加载它时，它会在远程连接到 mysql cli 时确认主机和凭据，并且可能会减慢选择 DB，您可以跳过 dns 解析，但我认为不会彻底解决问题

因此， ***“-A”***标签/属性必须在远程连接时通过 mysql 命令传递，这在使用“USE”命令选择 DB 时不会加载元数据。

例如：-

> mysql -A -h 主机 -u 用户 -p

# background - 无法停止后台工作人员

> ID：10021088
> 
> 赞同：0
> 
> 时间：2012-04-05T00:20:20.537
> 
> 标签：background, worker

我正在编写一个在另一个胎面/后台工作人员上的机器人，我试图阻止它，但在按下取消后，机器人仍在工作 oO

代码在这里：//停止我的机器人

```
 private void botOff_Click(object sender, EventArgs e)
        {
            bot_worker.WorkerSupportsCancellation = true;
            if (bot_worker.IsBusy)
                bot_worker.CancelAsync();
            botOn.Text = "Enable";
            botOn.Enabled = true;
            botOff.Enabled = false;
        }
    }
} 
```

//启动我的机器人

```
private void botOn_Click(object sender, EventArgs e)
{
    if (toolStripLabel5.Text == "Not attached")
    {
        MessageBox.Show(notAttached, "Skype Pwnage - Info!", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
    }
    else
    {
        botOn.Text = "Running";
        botOn.Enabled = false;
        botOff.Enabled = true;
        bot_worker.RunWorkerAsync();
    }
} 
```

编辑，跟随评论者链接并在下面得到这个代码它什么都不做，它仍然继续运行

```
private void bot_worker_DoWork(object sender, DoWorkEventArgs e)
{
    {
        BackgroundWorker worker = sender as BackgroundWorker;

        for (int i = 1; (i <= 1); i++)
        {
            if ((worker.CancellationPending == true))
            {
                e.Cancel = true;
                break;
            }
            else
            {
                skype.Attach(7, false);
                skype.MessageStatus += new _ISkypeEvents_MessageStatusEventHandler(skype_MessageStatus);
            }
        }
    }
}
private void skype_MessageStatus(ChatMessage msg, TChatMessageStatus status)
{
    try
    {
        string command = msg.Body.Remove(0, trigger.Length).ToLower();
        string[] lines = richTextBox4.Text.Split('\n');
        foreach (string ln in lines)
        {
            string[] commands = ln.Split(':');
            if (command == commands[0])
            {
                listBox2.Items.Add(commands[0]);
                skype.SendMessage(msg.Sender.Handle, string.Format(commands[1]));
                break;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:24:19.287

您确实意识到您需要`CancellationPending`在 DoWork() 方法中检查取消（例如通过检查）？CancelAsync() 不会“神奇地停止工作人员”，它只是“发出”您要取消工作人员的“信号”；工人需要中止它正在做的任何事情，清理它的东西等等，然后返回。[这个例子](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.cancellationpending%28v=vs.95%29.aspx)可能会为您清除它。

此外，来自[CancelAsync 文档](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.cancelasync%28v=vs.95%29.aspx)：

> CancelAsync 方法**提交**停止后台操作的请求**并将 CancellationPending 属性设置为 true**。
> 
> 当您调用 CancelAsync 时，您的后台操作将能够停止并退出。**操作代码应定期检查 CancellationPending 属性以查看它是否已设置为 true。**

# ios - 如何创建一个获取的属性来获取具有最小字段的实体？

> ID：10021098
> 
> 赞同：0
> 
> 时间：2012-04-05T00:21:15.093
> 
> 标签：ios, core-data, nsfetchedresultscontroller, fetched-property

我无法解决这个问题......我在获取的属性（而不是获取的请求）方面遇到了一些问题。

如何创建一个获取的属性来获取具有最小字段的实体？如果您看到这些捕获，您将看到它： ![在此处输入图像描述](../Images/3037398ddeb430df0bb32de404b37655.png) ![在此处输入图像描述](../Images/558d75cac2adb6c720894de04de89ce6.png)

我必须在名为 minItemTimestamp 的获取属性中写什么？我尝试了几种选择，但都不起作用。"@min.items.timestamp" "items.@min.timestamp" @min 似乎是一个聚合，不确定这就是我要找的。

我试过这个回复，但没有运气： [XCode Data Model Editor 中的 Fetched Property for minimum value](https://stackoverflow.com/questions/2664776/fetched-property-in-xcode-data-model-editor-for-minimum-value)

那么，我可以创建一个获取的属性来获取属于当前类别的所有项目，即时间戳最小的项目吗？

非常感谢，非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:08:57.060

您不需要获取的属性。

使用以下代码行：

```
id minTimestamp=[myCategory.items valueForKeyPath:@"@min.timestamp"];
id maxTimestamp=[myCategory.items valueForKeyPath:@"@max.timestamp"]; 
```

请参阅[在谓词中使用 @min](https://stackoverflow.com/questions/5023017/using-a-min-in-predicate)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T00:34:49.003

NSFetchedResultsController 将通过一个属性接受一个 NSSortDescriptors 数组，并相应地为您对数据进行排序。

# html - 内联块元素的浮点数和宽度

> ID：10021101
> 
> 赞同：0
> 
> 时间：2012-04-05T00:21:23.837
> 
> 标签：html, css, internet-explorer-7

[http://jsfiddle.net/zerkms/4zJyw/1/](http://jsfiddle.net/zerkms/4zJyw/1/)

在除 IE7 之外的所有主流浏览器中，该示例都按预期工作 - 父 div 的总宽度为 100 像素，但在 IE7 中，由于某种原因，它会拉伸到所有宽度。

这只发生在`v`元素有`float: right`

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:33:15.117

我可以解决这个问题的唯一方法是`position:relative`在父级和`position:absolute; right:0`div 上使用'v'。

# jquery-ui - jQuery 工具提示在 AJAX 表单提交后停止工作

> ID：10021107
> 
> 赞同：0
> 
> 时间：2012-04-05T00:22:14.450
> 
> 标签：jquery-ui, jquery

我正在使用 jQuery 和 jQuery UI。当我提交表单($("#compareit").submit(function(e){...) 时，我在页面上隐藏了我的左右列并显示表单提交的AJAX结果。我也是使用一些简单的工具提示。在提交表单之前，工具提示工作正常......提交后，它们停止工作。我假设这是因为我正在更改 DOM。关于如何解决这个问题的任何想法？

我有太多代码要发布，所以这里是功能。如果代码有帮助，我很乐意发布它（下）

提交执行 ajax 调用的表单。在我的页面上隐藏右/左列在页面上显示结果。工具提示停止工作

有问题的工具提示是： $('.tTip').betterTooltip({speed: 150, delay: 300});

```
$(document).ready(function(e) { 

    positions = new Array ('8' , '9');
    positions_num = 7;
    position_list = new Array(positions_num);

    $("#tabsP" ).tabs();
    $("#tooManySelected").hide();
    $('.tTip').betterTooltip({speed: 150, delay: 300});

    $("#compareit").submit(function(e){
        $("#topsection").hide();
        $("#tabsP").hide();
        $("#bottomWrap").hide(); 
        $("#error").html('');
        $("#leftcolumn").hide();
        $("#rightcolumn").hide();
        $("#yearChooser").hide();
        e.preventDefault();
        var queryString = $('#compareit').serialize();
        var dataString = queryString + "&count=" + totalselected;
        //alert(dataString);

        $.ajax({
            type: 'GET',
            url:'newmlbcompare2p.php', 
            cache: false,
            data: dataString,
            dataType : 'html',
            success:function(result){
                $('#ajaxDiv').html(result);
            }
        });
        return false; 
    });

    $( "#accordionRight" ).accordion({
        collapsible: true,
        autoHeight: false
    });
    $( "#accordionLeft" ).accordion({
        header: "h3", 
        autoHeight: false,
        navigation: true,
        collapsible: true,
        active: true
    })

    $(".btn-slide").click(function(){
        $("#ppanel").slideToggle("slow");
        $(this).toggleClass("active"); return false;
    });

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T00:54:32.800

如果 ajax 内的工具提示不起作用，因为您在绑定方法以启用工具提示后加载的内容。所以工具提示功能不知道添加的新元素。因此，您可能需要再次将该函数绑定到加载的新内容。加载数据后，您可以在 ajax 成功事件中执行此操作

```
$.ajax({
            type: 'GET',
            url:'newmlbcompare2p.php', 
            cache: false,
            data: dataString,
            dataType : 'html',
            success:function(result){
                $('#ajaxDiv').html(result);
                $('.tTip').betterTooltip({speed: 150, delay: 300});

            }
}); 
```

**编辑：**同样的事情也适用于您的其他活动。就像你说的，你的点击事件不起作用，你可能需要改变它来使用 jQuery`on`

改变

```
 $(".btn-slide").click(function() {
  //do stuff
 }); 
```

到

```
$("#yourContainerDiv").on("click", ".btn-slide", function(event){
     //do stuff
}); 
```

on 将处理当前元素和未来元素（例如从 ajax 加载的内容）。

[http://api.jquery.com/on/](http://api.jquery.com/on/)

jquery on 从 jQuery 1.7+ 版本开始可用。如果您使用的是以前的版本，则需要使用 jQuery`live`方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-05T10:21:43.420

谢谢你的回答，Shyju。[**我在UI Tooltip**](http://jqueryui.com/tooltip/)上遇到了同样的问题，您的解决方案有帮助：

```
<script>
$(document).ready(function() {
    $("#dialog-window").dialog({
    autoOpen: false,
    width: 540,
    height: 200,
    modal: true,
    buttons: [
    {
    text: "OK",
    click: function() {
    $( this ).dialog( "close" );
    },
}
]
});
    $("#dialog-link").on("click", function(event){
    // post data
    $.post('submit.php', $('#formName').serialize(), function(data){
    $('#content-container').html (data);
    //  add tooltip         
    $('.tooltipClassName').tooltip({
    position: {
    my: "center bottom-10",
    at: "center top",
    using: function( position, feedback ) {
    $( this ).css( position );
    $( "<div>" )
    .addClass( "arrow" )
    .addClass( feedback.vertical )
    .addClass( feedback.horizontal )
    .appendTo( this );
    }
    }
    });
});
$("#dialog-window" ).dialog("open");
event.preventDefault();
});
});
</script> 
```

# objective-c - UIControl 和 setImage 问题

> ID：10021108
> 
> 赞同：0
> 
> 时间：2012-04-05T00:22:17.467
> 
> 标签：objective-c, ios, xcode

我有一个显示 9 个 UIImageViews 的应用程序，我正在尝试添加用户删除它们的功能。因此，我设置了所有内容，并为用户设置了一个警报视图，以确认他们想要删除他们点击的图像。当我在警报视图中单击是时，应用程序崩溃并且调试器状态：

**2012-04-04 18:19:44.311 AppName[1857:f803]-[UIControl setImage:]：无法识别的选择器发送到实例 0x6aac690**

**2012-04-04 18:19:44.312 AppName[1857:f803] 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[UIControl setImage:]：无法识别的选择器发送到实例 0x6aac690”**

奇怪的是我没有在我的任何代码中调用 setImage 。这是我正在使用的代码：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)img editingInfo:(NSDictionary *)editInfo {
    if (imageView.image == nil) {
        imageView.image = img;

        self.array = [NSMutableArray arrayWithObject:[NSData dataWithData:UIImagePNGRepresentation(imageView.image)]];

        [picker dismissModalViewControllerAnimated:YES];
        [self.popover dismissPopoverAnimated:YES];
        return;

    }

    if (imageView2.image == nil) {
        imageView2.image = img;
        NSLog(@"The image is a %@", imageView);
        [self.array addObject:[NSData dataWithData:UIImagePNGRepresentation(imageView2.image)]];

        [picker dismissModalViewControllerAnimated:YES];
        [self.popover dismissPopoverAnimated:YES];
        return;
    }

    } 
```

**......**

```
 - (IBAction)deleteButtonPressed:(id)sender {
        NSLog(@"Sender is %@", sender);
        UIAlertView *deleteAlertView = [[UIAlertView alloc] initWithTitle:@"Delete"
                                                                  message:@"Are you sure you want to delete this photo?"
                                                                 delegate:self
                                                        cancelButtonTitle:@"No"
                                                        otherButtonTitles:@"Yes", nil];
        [deleteAlertView show];
        int imageIndex = ((UIButton *)sender).tag;
        deleteAlertView.tag = imageIndex;

    }

    - (void)alertView: (UIAlertView *) alertView 
    clickedButtonAtIndex: (NSInteger) buttonIndex
    {

        if (buttonIndex != [alertView cancelButtonIndex]) {
            NSLog(@"User Clicked Yes. Deleting index %d of %d", alertView.tag, [array count]);
            NSLog(@"The tag is %i", alertView.tag);
            [self.array removeObjectAtIndex: alertView.tag];
            NSLog(@"After deleting item, array count  = %d", [array count]);
        NSLog(@"Returned view is :%@, in view: %@", [self.view viewWithTag:alertView.tag], self.view);
            ((UIImageView *)[self.view viewWithTag:alertView.tag]).image =nil;
        }

        [self.user setObject:self.array forKey:@"images"];
    } 
```

我添加了断点，似乎导致崩溃的行是：

`((UIImageView *)[self.view viewWithTag:alertView.tag]).image =nil;` 该行的目的是从 UI 中删除图像。我不确定为什么该行会导致此错误，但代码似乎是正确的。有问题的 nib 文件是一个 UIControl，而不仅仅是一个 UIView，所以这可能是问题所在。非常感谢任何帮助或建议，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:51:05.793

原来我的标签搞砸了。我在 UIImageView 上标记了不可见的按钮，忘记了它不是实际的 UIImageView。这解释了所有的奇怪之处。这次我根据 UIButtons 标记了实际的 UIImageViews，它现在可以正常工作了。感谢大家的帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-05T00:30:42.433

UIControl 没有图像属性。您将 imageView 误认为是 UIControl

# c - 这个算法是如何工作的？

> ID：10021110
> 
> 赞同：1
> 
> 时间：2012-04-05T00:22:24.757
> 
> 标签：c

这是一个 C 实现，它根据我需要移植到 MIPS 的基数将整数转换为 ASCII 字符串。在我完全做到这一点之前，我需要了解这段代码是如何工作的（底部的完整代码），而且我以前从未真正处理过纯 C。

我不确定：

做什么

```
*p ++ = hexdigits[c]; 
```

究竟是做什么的？在我看来 p 是一个字符数组，所以我不确定这里发生了什么分配。如果我能弄清楚 p 到底在做什么，我相信我能弄清楚其余的。谢谢！

```
#include    <stdio.h>
#include    <stdlib.h>

char    * my_itoa(unsigned int  v, char *p, int r)
{
    unsigned int c;
    char    *p_old, *q;
    static char   hexdigits[16] = "0123456789ABCDEF";

    if (r < 2 || r > 16) {
        *p = 0;
        return p;
    }

    if (v == 0) {
        *p = '0';
        return p;
    }

    p_old = p; 
hy
    // doing the conversion
    while (v > 0) {
        // You can get both c an v with ONE MIPS instruction 
        c = v % r;
        v = v / r;
        *p ++ = hexdigits[c]; 
    }

    *p = 0;

    // reverse the string

    // q points to the head and p points to the tail
    q = p_old;
    p = p - 1;

    while (q < p) {
        // swap *q and *p
        c = *q;
        *q = *p;
        *p = c;

        // increment q and decrement p
        q ++;
        p --;
    }

    return p_old;
}

char    buf[32];

int main (int argc, char **argv)
{
    int r;
    unsigned int m0 = (argc > 1) ? atoi(argv[1]) : 100;

    for (r = 2; r <= 16; r ++) 
        printf("r=%d\t%s\n", r, my_itoa(m0, buf, r));

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T00:24:50.363

这个：

```
*p ++ = hexdigits[c]; 
```

与此相同：

```
*p = hexdigits[c];
p++; 
```

# ios - 用于革命的 OpenGL 矩阵变换

> ID：10021111
> 
> 赞同：0
> 
> 时间：2012-04-05T00:22:30.303
> 
> 标签：ios, opengl-es

我编写了以下代码来将立方体在 x 轴上旋转一整圈，然后在 y 轴上来回旋转。代码生成所需的结果。

```
- (void)update
{
if (_x_axis) {
    if (i >= 6.28) {
        i = 0;
        _x_axis = false;
    } else {
        float aspect = fabsf(self.view.bounds.size.width / self.view.bounds.size.height);
        GLKMatrix4 projectionMatrix = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(65.0f), aspect, 0.1f, 100.0f);
        self.effect.transform.projectionMatrix = projectionMatrix;
        GLKMatrix4 modelViewMatrix = GLKMatrix4MakeTranslation(0.0f, 0.0f, -3.0f);
        modelViewMatrix = GLKMatrix4Rotate(modelViewMatrix, i, 0.0f, 1.0f, 0.0f);
        self.effect.transform.modelviewMatrix = modelViewMatrix;
        i += .01;
    }
} else {
    if (i >= 6.28) {
        i = 0;
        _x_axis = true;
    } else {
        float aspect = fabsf(self.view.bounds.size.width / self.view.bounds.size.height);
        GLKMatrix4 projectionMatrix = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(65.0f), aspect, 0.1f, 100.0f);
        self.effect.transform.projectionMatrix = projectionMatrix;
        GLKMatrix4 modelViewMatrix = GLKMatrix4MakeTranslation(0.0f, 0.0f, -3.0f);
        modelViewMatrix = GLKMatrix4Rotate(modelViewMatrix, i, 1.0f, 0.0f, 0.0f);
        self.effect.transform.modelviewMatrix = modelViewMatrix;
        i += .01;
    }
} 
```

我的问题是，当我将增量 i 更改为 .02 或 .2 或 .3 之类的值时，为什么立方体仍然恰好旋转一圈？

如果 i 增加 0.2，则在转换中使用的 i 的最后一个值将是 6.2，然后它会被重置并更改旋转轴。基本上，什么是保持立方体水平？我认为随着 i 的较大增量，立方体在切换轴之前不会旋转一整圈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:53:23.870

`6.28 = 2*M_PI`, 给定一个完整的旋转代码。参数`i`直接给出`GLKMatrix4Rotate`。如果你想要不同的长度，你可以在条件中改变这个常量，或者`i`在调用之前映射参数`GLKMatrix4Rotate`。

对于第二种方法，修改代码：

1.  将 的间隔更改`i`为`[0;1]`，并使步长稍微小一些。
2.  `GLKMatrix4Rotate`用调用`i*2*M_PI`。

现在动画通常像以前一样运行，但是，您可以使用[缓动函数](https://www.google.de/search?q=easing+function)来扭曲它。

# c# - C# 的 DllImport（原始在 C++/CLI 中）需要输出数组

> ID：10021114
> 
> 赞同：1
> 
> 时间：2012-04-05T00:22:50.880
> 
> 标签：c#, pointers, c++-cli, dllimport

这就是它在 C++ 中的样子：

```
[DllImportAttribute("Win32DLLRecon.dll", CharSet=CharSet::Auto, CallingConvention=CallingConvention::StdCall)]
    extern "C" void proc1
        (__int32 *i1,
             __int16 *i2,
             __int16 *i3,
             char *i4,
             unsigned *i5,      
             unsigned char *o1, 
             unsigned __int16 *o2,
             float *o3); 
```

其中 i = input , o = output 什么是 C# 等价的？
我试图指定类似的数组，例如“out Byte [] output”，但它抱怨它需要 byte*，而不是 byte[]（我确实需要在代码中使用指针）。编辑：如果我只是将我的整个类声明为不安全并将它们作为指针传递会发生什么：extern proc (out Byte* output, etc)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:29:00.743

我相信您需要为此使用 a `System.IntPtr`，或者`System.IntPtr[]`为真正的数组使用 a 。

# php - 用php加密图像以防止在HTML电子邮件中下载？

> ID：10021115
> 
> 赞同：2
> 
> 时间：2012-04-05T00:23:09.920
> 
> 标签：php, html, image, email

我收到一个客户的请求，要求“加密一些图像以防止人们下载它们”。这将在来自一些我目前不知道的电子邮件发送应用程序的 HTML 电子邮件中，因此我需要使用一个字符串作为源，例如“http://somewhere.com/images/img.jpg”等等。这种事情甚至存在吗？我唯一能想到的就是“加密”图像，因此 src 不是“whatever/img.jpg”，而是“http://somewhere.com/img.php?i=12383824724”。但我是只是吐口水，不知道那会如何工作。在你开始回答之前：

1.  客户知道我们可以在图片上加水印
2.  客户端知道我们可以将图像作为背景（使用适当的方法来实现跨客户端兼容性）

有任何想法吗？谢谢大家，

菲尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:25:51.080

如果用户可以***看到***图像，他*已经下载*了它。阻止用户下载图像意味着阻止他看到它。这似乎毫无意义。

您可能想要的是阻止您的用户*将已下载的图像保存到文件*或其他位置。这只有在您能够完美控制用户查看图像的环境（包括屏幕前的任何东西（如数码相机））时才有可能。即，这是徒劳的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:25:17.673

您可能需要考虑在邮件中使用[PGP 。](https://en.wikipedia.org/wiki/Pretty_Good_Privacy)这是事实上的标准，但前提是您正在做一些信息上易于处理的事情。

虽然您无法“阻止人们下载 [您的图像]”，但您*可以*阻止他们解密它们，除非他们是受信任的一方。如果需要更细粒度的 DRM 级别，您可能需要考虑与客户进行讨论并向他们准确解释为什么这是不可行的。

简而言之：如果目标方已经看到了图像内容，那么您几乎无能为力。最好的水印和隐写标记注定要[模拟漏洞](https://en.wikipedia.org/wiki/Analog_hole)，即使您竭尽全力保护您的网络服务器。

# android - 有谁知道如何制作软键盘？

> ID：10021117
> 
> 赞同：2
> 
> 时间：2012-04-05T00:23:28.983
> 
> 标签：android, android-softkeyboard

好的，我是应用程序开发的新手，我尝试了很多代码，甚至尝试使用 SDK 软键盘示例，一旦我修复一件事，我的运气为零，依此类推……我永远无法让软键盘显示在图形视图中我不知道还能做什么..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T03:00:52.247

完全按原样使用软键盘——确保在尝试更改任何内容之前先运行它。直接导入eclipse，然后运行。

您可能想查看的另一件事是：[http](http://code.google.com/p/softkeyboard/source/checkout) ://code.google.com/p/softkeyboard/source/checkout 这是 AnySoftKeyboard 的源代码。这应该会给你一个很好的例子来说明一个功能齐全的 Android 键盘是如何工作的。

如果您在执行此操作时遇到任何问题，请告诉我；几个月来我一直在开发软键盘，所以我非常熟悉触摸输入的工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T12:02:42.190

我在自定义键盘上找到的最好的文章：

[http://www.fampennings.nl/maarten/android/09keyboard/index.htm](http://www.fampennings.nl/maarten/android/09keyboard/index.htm)

作者：马丁彭宁斯

# android - 如何使用 ViewPager 在活动之间滑动？

> ID：10021118
> 
> 赞同：0
> 
> 时间：2012-04-05T00:23:39.147
> 
> 标签：android, android-fragments, android-viewpager

我想在不同的活动之间滑动，就像我可以点击一个项目并启动一个活动的菜单一样。我读过这是不可能的，但有一种叫做片段的东西。它们是如何工作的？它们像我可以单独调用的活动吗？我该如何实施？我对此很陌生，但我想学习:)

这是我做的代码，但我只能在布局之间进行更改：

```
import com.viewpagerindicator.TitlePageIndicator;
import com.viewpagerindicator.TitleProvider;
import android.app.Activity;
import android.content.Context;
import android.graphics.Typeface;
import android.os.Bundle;
import android.os.Parcelable;
import android.support.v4.view.PagerAdapter;
import android.support.v4.view.ViewPager;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.LinearLayout;
import android.widget.TextView;

/** *************************************************************************************************
/** Clase:   public class LCMeter extends Activity
/** Notas:   esta Activity usa desplazamiento por paginas horizontal
/** Funcion: obtiene de puerto USB los datos de frecuencia, inductancia, capacitancia y los muestra
/**          con multiples funciones como creacion de graficos, logs, etc
****************************************************************************************************/
public class LCMeter extends Activity {

    // titulos de las paginas
    private static String[] titulosPaginas = { "APP 1", "APP 2", "APP 3" };
    private Context cxt;
    private ViewPager columnas;
    private ColumnasAdapter myAdapter;
    TextView txt;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);  //layout con PagerViewer
        cxt = this;

        myAdapter = new ColumnasAdapter();
        columnas = (ViewPager) findViewById(R.id.columnas);
        columnas.setAdapter(myAdapter);

        // Agrega los titulos
        TitlePageIndicator titleIndicator = (TitlePageIndicator) findViewById(R.id.titulos);    //layout XML
        titleIndicator.setViewPager(columnas);
    }

/** *************************************************************************************************
/** Clase:   private class ColumnasAdapter extends Pager Adapter implements TitleProvider
/** Notas:   extends PagerAdapter hace uso de la libreria y al usar implements TitleProvider permite
/**          colocar titulos a las paginas por las que nos movemos
/** Funcion: crea paginas por las cuales deslizarse hotizontalmente cambiando los Layout
****************************************************************************************************/
    private class ColumnasAdapter extends PagerAdapter implements TitleProvider {

        /// Obtiene numero de paginas en este caso el numero de elementos en el String
        @Override
        public int getCount() {
            return titulosPaginas.length;
        }

        // Obtiene el titulo para ponerle a la pagina
        @Override
        public String getTitle(int position) {
            // TODO Auto-generated method stub
            return titulosPaginas[position];    // titulo de la pagina
        }

        //Cambia los layout de acuerdo a las paginas
        @Override
        public Object instantiateItem(View collection, int position) {
            LinearLayout v = (LinearLayout) LayoutInflater.from(cxt).inflate(R.layout.lcmeter, null);

            // Ejecuto una Activity de acuerdo a la pagina en la que este
            switch (position) {
            case 0:
                v = (LinearLayout) LayoutInflater.from(cxt).inflate(R.layout.lcmeter, null);
                break;
            }

            ((ViewPager) collection).addView(v, 0);

            return v;
        }

        //Destruye las paginas cuando dejan de usarse
        @Override
        public void destroyItem(View collection, int position, Object view) {
            ((ViewPager) collection).removeView((LinearLayout)view);
        }

        @Override
        public boolean isViewFromObject(View view, Object object) {
            return view == ((LinearLayout) object);
        }

        @Override
        public void finishUpdate(View arg0) {}

        @Override
        public void restoreState(Parcelable arg0, ClassLoader arg1) {}

        @Override
        public Parcelable saveState() {
            return null;
        }

        @Override
        public void startUpdate(View arg0) {}

    }
} 
```

# c# - Monotouch 使用哪种数据访问技术

> ID：10021120
> 
> 赞同：2
> 
> 时间：2012-04-05T00:24:08.763
> 
> 标签：c#, ios, xamarin.ios, data-access-layer, simple.data

我只是想知道人们在 Monotouch 中使用什么数据访问层？我正在开发一个基于 CRUD 的应用程序，并在编写内联 SQL 或滚动我自己的 ORM 之间寻找一些东西，并在它不受支持时尝试将实体框架融入其中。

我很想尝试使用 Simple.Data，但我不确定它是否可以在 Mono 下编译。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T00:57:40.000

答案取决于您是将数据存储在设备上还是关闭（当然，两者兼而有之）。

对于设备上的存储，您可以使用内置于 iOS 中的 Sqlite 数据库，并通过 Mono.Data.Sqlite 驱动程序访问它。

对于设备外存储，我建议使用自烘焙 Web 服务。

# java - 解析参数

> ID：10021123
> 
> 赞同：1
> 
> 时间：2012-04-05T00:24:50.343
> 
> 标签：java, command-line, io

所以我对每个人的快速问题是，谁能向我解释为什么我应该解析 (String[]args) 中的参数的基本原因？我对这个主题不是很了解，希望得到一些快速帮助，以便更好地理解事情。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T00:30:53.933

你问你**为什么**要这么做？好吧，当然**需要**（或要求）这样做。例如，如果您的应用程序应该支持像`-install`,`-debug`或`-foo -bar -quick -user=simpson -pass=bart`

类似于`ls`linux 中的方式支持`-R`递归等参数`dir`，“Dos”支持`/S`递归。您想“解析”这些参数（例如“看看它们，弄清楚它们的含义”）以使您的应用程序相应地采取行动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:35:41.937

这是在 java 中使用命令行应用程序的一种非常方便的方法。例如，如果你想创建一个批处理文件来运行一些 Java 应用程序（也许它会在你的计算机上设置一个邮件配置文件），那么你可以使用命令行参数来输入标准的操作系统值，比如用户名，等等

你需要一直这样做吗？哎呀，不，但就像编程中的一切一样，它是我们在适当时使用的工具。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:58:15.410

例如，一个使用命令行参数的典型程序会测试一个数字是否为素数：

```
java mytools.IsPrime 1234567 
```

或者翻译程序可以帮助找到翻译：

```
java mytools.Translate Kindergarten 
```

在 Windows 上，您可能很少使用命令行，但如果您通过拖放将文件列表传递给程序，操作系统会将此操作转换为名称列表，然后将其传递给您的程序，以便您可以对它们进行操作：

```
java mytools.PrettyPrint PrettyPrint.java Translate.java IsPrime.java 
```

# axapta - 按代码输入采购订单接收数量

> ID：10021128
> 
> 赞同：1
> 
> 时间：2012-04-05T00:25:32.017
> 
> 标签：axapta

在采购订单表格 - 行 - 选项卡数量中，有收到，交货提醒和已订购。

我希望能够通过 X++ 代码输入这些字段，因为目前我们公司仍在将数据输入到旧系统中。

我可以从旧系统中检索到货采购订单货物数据，然后我想通过代码将这些检索到的数据输入 Axapta。

这样做时我应该考虑什么表和字段？有哪些功能可以轻松更新每个订单行接收数量？示例代码很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T06:59:43.953

如何创建采购订单？

销售订单的示例代码可以在[jinx 的 AX 博客](http://starside.eu/PermaLink,guid,6c149fe7-050f-4f28-be3b-ac4b30247c47.aspx)中找到。

跳过或翻译德语文本，代码在底部，关键是`createLine`方法调用。将“销售”全球替换为“采购”将为您解决问题。

需要考虑哪些领域？

很多很多，但从识别号、数量和项目单位开始。

数量以采购单位 ( `PurchQty`) 和库存单位 ( `QtyOrdered`) 为单位。您必须同时设置两者，但其中一个参数`createLine`将为您完成。

更新：

要更新收到的数量，您必须更新装箱单。除了更新数量之外，它还会更新/创建库存交易。

您可以通过更新表上的`PurchReceivedNow`和`InventReceivedNow`字段来做到这一点`PurchLine`，第二个字段可以通过调用`setInventReceivedNow`方法来设置。

然后更新装箱单（您将需要采购订单和装箱单 ID）：

```
void postPackingSlip(PurchTable purchTable, PackingSlipId packingSlipId)
{
    PurchFormLetter letter = PurchFormletter::construct(DocumentStatus::PackingSlip, true);    
    letter.update(purchTable, packingSlipId, letter.transDate(), PurchUpdate::ReceiveNow);
} 
```

# css - 为什么要在一个 CSS 选择器中放置两个不同的位置规则

> ID：10021129
> 
> 赞同：5
> 
> 时间：2012-04-05T00:25:34.480
> 
> 标签：css

发现这是我正在阅读的一些 CSS 示例，我很难确定为什么一个选择器中有两个位置规则。

```
#Div
{
     position:fixed !important;
     position:absolute;
} 
```

这有什么作用？元素不是`!important`总是会覆盖`position: absolute`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T00:28:04.687

所有支持的浏览器都`position:fixed`将使用它，其他浏览器回退到`absolute`.

# context-free-grammar - 证明以下语言是上下文无关的：

> ID：10021130
> 
> 赞同：0
> 
> 时间：2012-04-05T00:25:38.990
> 
> 标签：context-free-grammar

这个问题是在一个样本考试中，我们的教授懒得输入答案，我被困得很糟糕。在此先感谢您的帮助！

证明以下语言是上下文无关的`{x is an element of {a,b,c}* | the number of a's in x is greater than the number of b's or the number of c's in x}`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T13:47:57.323

> {x 是 {a,b,c}* 的一个元素 | x 中 a 的数量大于 b 的数量或 x 中 c 的数量}

这可以解释为两种方式：

1.  的个数`a`大于（的个数`b`加上 的个数`c`）
2.  （`a`'的数量大于`b`'的数量）或（`a`'的数量大于`c`'的数量）。

提示 1：PDA 可以按如下方式工作。如果堆栈为空并且您`a`在输入中看到一个，则将一个添加`a`到堆栈中。如果堆栈为空并且您在输入中看到 a`b`或 a ，则将 a 添加到堆栈中。如果最顶部的堆栈符号是 a并且您在输入中看到 an ，则从堆栈中删除 a 。如果最顶部的堆栈符号是 a并且您在输入中看到 a或 a ，则将另一个添加到堆栈中。如果最顶部的堆栈符号是 an并且您在输入中看到 an ，则将另一个添加到堆栈中。如果最顶部的堆栈符号是 an并且您在输入中看到 a或 a ，请删除`c``b``b``a``b``b``b``c``b``a``a``a``a``b``c``a`从堆栈中。现在简单地产生一个参数，这样一个 PDA 将有 (1) 如果 's 的数量`a`等于`b`'s 和`c`'s 的数量之和，则该 PDA 将具有一个空堆栈；(2)如果它看到的 's 比它看到的's 或's (组合)`a`多，则在堆栈顶部；(3) a在堆栈顶部，如果它看到的's 少于它看到的's 或's（组合）。`a``b``c``b``a``b``c`

提示 2：首先，构造一个 PDA 接受`a`'s、`b`'s 和`c`'s 的任何字符串，其中`a`'s 比`b`'s 多，忽略任何`c`'s（上面在提示 1 中描述的 PDA 可以很容易地修改为忽略`c`的）。然后，构造一个 PDA 接受任何字符串`a`' `b`s 和`c`'s，其中`a`'s 比`c`'s 多，忽略任何`b`'s（类似于您刚刚构建的那个）。最后，证明你试图证明上下文无关的语言是这些自动机接受的语言的联合；一个简单的论据就足够了。由于无上下文语言在联合下是封闭的，这证明了这一主张，即您开始证明无上下文的语言是，

请随时要求进一步澄清。此外，请查看新站点以了解以下问题：[https](https://cs.stackexchange.com/) ://cs.stackexchange.com/ 。您可能会在该站点上收到关于未来问题的更好答案。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-05T00:45:47.747

任务是证明语言可以由上下文无关文法生成。

一些提示：

```
A -> aabAc | B
B -> B|epsilon 
```

# windows-7 - 从 cygwin / mintty 以管理员身份运行命令

> ID：10021131
> 
> 赞同：2
> 
> 时间：2012-04-05T00:25:51.687
> 
> 标签：windows-7, cygwin, cmake, uac, mintty

我在 Windows 7 的 cygwin 上运行 mintty。我将 mintty.exe 设置为始终“以管理员身份运行”。我正在尝试从 mintty 中运行 cmake 以构建 Visual Studio 11 解决方案。

但是，当 cmake 尝试进行测试编译时，它会失败，因为**CL.exe**没有足够的权限来运行。我已将**cmake.exe**、**devenv.exe**和我可以在磁盘上找到的所有**CL.exe**设置为始终“以管理员身份运行”，但这没有帮助。

当我从以管理员权限启动的 Windows 命令行运行相同的 cmake 命令时，它会成功。这告诉我 cmake 和 CL 可执行文件设置正确，但是以某种方式从 mintty / cygwin 调用它们会在没有管理员权限的情况下启动它们。

关于如何设置 cygwin 以使用“以管理员身份运行”设置启动所有外部可执行文件的任何想法？

**编辑：**有关我尝试的组合及其结果的更多信息。

**在 cmd（非管理员）中运行 cmake（非管理员）**会产生[此处](http://www.cmake.org/pipermail/cmake/2010-January/034317.html)`Could not COPY_FILE`描述的错误。建议的解决方案是以管理员身份运行。`devenv.exe``cmake.exe`

**在 cmd（管理员）中运行 cmake（非管理员）**可以工作。打开命令行时我得到管理员提示，没有提示运行 cmake。

**在 cmd（非管理员）中运行 cmake（管理员）**可以工作。弹出一个新的命令窗口，我得到管理员提示符来运行 cmake。

**在 cmd (admin) 中运行 cmake (admin)**可以工作。打开命令行时我得到管理员提示，没有提示运行 cmake。

**在 mintty（非管理员）中运行 cmake（非管理员）**会产生与在非管理员 cmd 中的非管理员 cmake 相同的结果。

**在 mintty (admin) 中运行 cmake (non-admin)**会产生一个不同的错误（[在此处](http://blog.ashodnakashian.com/2012/01/building-webkit-on-windows-7-with-vs2010/#windows-7-uac)描述），这基本上归结为`cl.exe`没有以管理员身份运行。启动 mintty 时出现管理员提示。

**在 mintty（非管理员）中运行 cmake（管理员）会生成**cmake`Permission denied`可执行文件。

**在 mintty (admin) 中运行 cmake (admin)**会产生与非管理员 cmake 和 admin mintty 相同的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-30T11:37:50.217

（由 OP 在问题编辑中回答。转换为社区 wiki 答案。请参阅[没有答案的问题，但问题在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

OP写道：

> 好的，我设法“解决”了它。问题是我总是以管理员身份运行 Visual Studio 11。（我这样做是为了将调试器附加到具有管理员权限的正在运行的进程，这是我工作所需要的。）当 VS11 始终以管理员身份运行时，它需要`cmake`以管理员身份运行，这反过来又需要`cmd`或`mintty`以管理员身份运行行政。
> 
> 现在为什么这适用于`cmd`而不是`mintty`，即为什么管理员升级没有一直到`cl.exe`我不知道。

# c++ - 命名空间和包含文件的 C++ 链接错误

> ID：10021132
> 
> 赞同：1
> 
> 时间：2012-04-05T00:25:57.150
> 
> 标签：c++, c++11

我正在研究我的引擎的核心，我在 Microsoft Visual c++ express 中遇到了严重的链接问题。

为简化起见，导致问题的是这两个头文件，每个头文件都有一个具有不同标识符的命名空间。这两个包含文件实际上是相互包含的。编译没有错误，但是在链接时，显示错误“X 已在 A.obj 中定义”。下面提供了一个示例：

**标题 1**

```
#ifndef HEADER1_H
#define HEADER1_H

#include "header2.h"
namespace Core{
    int x, y, z;
}
#endif 
```

**标题 2**

```
#ifndef HEADER2_H
#define HEADER2_H

#include "header1.h"
namespace GUI{
    int x, y, z;
}
#endif 
```

最终发生的事情是我收到一条错误消息，指出 x、y 和 z 变量已在创建的第一个 .obj 文件中定义。我假设因为变量来自不同的命名空间，所以它们不会发生冲突。我也有头文件保护，所以头文件似乎没有被多次包含。

无论如何，任何形式的帮助或建议将不胜感激。我已经坚持了大约 3 天：P。另外，如果我没有提供足够的信息，请告诉我，只是我当前的代码非常长。

干杯，乔伊

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-05T00:41:54.443

实际上，问题在于变量是在头文件中定义的——不是头文件包含，而是在每个包含头文件的 .cpp 文件中，都定义了所有 6 个变量。

每个 .cpp 文件都变成一个 .o 文件，每个 .o 都以定义的变量结束，这会导致链接器错误。你想要做的是在标题中使用 extern 关键字，它告诉编译器实际变量是在其他地方定义的......

例如：

```
namespace Core{
    extern int x, y, z;
} 
```

和

```
namespace GUI{
    extern int x, y, z;
} 
```

然后，在一个 cpp 文件中（仅在一个 cpp 文件中！）您需要定义*不带*extern的变量

```
namespace Core {
    int x, y, z;
}
namespace GUI{
    int x, y, z;
} 
```

这将修复您的链接器错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:39:05.010

问题不在于您在多个命名空间中包含相同的变量名称，而在于您在标头中*定义*变量，而不仅仅是*声明*它们。这使得编译器为包含头文件的每个编译单元创建这些变量的一个副本，并且这些变量在链接时发生冲突，这就是您得到错误的原因。

使用 extern 仅在标头中声明它们，而不是定义它们：

**标题 1**

```
#ifndef HEADER1_H
#define HEADER1_H

#include "header2.h"
namespace Core{
    extern int x, y, z;
}
#endif 
```

**标题 2**

```
#ifndef HEADER2_H
#define HEADER2_H

#include "header1.h"
namespace GUI{
    extern int x, y, z;
}
#endif 
```

然后在您的两个标题的相应`.cpp`文件中，将您的`namespace Core { int x, y, z; }`和 `namespace GUI{ int x, y, z; }`

# android - 将apk文件下载到内部存储

> ID：10021139
> 
> 赞同：0
> 
> 时间：2012-04-05T00:27:20.113
> 
> 标签：android, android-intent

无论如何都可以将网站上的apk文件直接下载到内存中。我很清楚将数据写入文件并使用位图将图像获取到内存中，但不确定是否直接下载 apk 文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:29:20.530

APK 文件只是文件。您没有理由不能像任何其他文件一样下载和存储它们。

# android - 像素检测中的Android ListView滚动位置

> ID：10021143
> 
> 赞同：0
> 
> 时间：2012-04-05T00:28:05.337
> 
> 标签：android, android-listview

我想检测用户滚动的列表视图上的像素数。同时，我可以基于已滚动的像素数，并显示带有已滚动像素的文本视图。

将不胜感激您的回答。谢谢！

正义便士

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:35:38.957

[`View.getScrollY`](http://developer.android.com/reference/android/view/View.html#getScrollY%28%29)应该有帮助。这应该给你你正在寻找的滚动位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T16:46:46.153

检查我对[这个问题](https://stackoverflow.com/questions/10808387/android-getting-exact-scroll-position-in-listview/13415273#13415273)的回答。

```
View.getScrollY() 
```

是从 View 继承的方法，文档说：

> 返回此视图的滚动顶部位置。这是视图显示部分的顶部边缘。

因此，对于全屏列表，它将始终返回 0。

# javascript - 当我只想更改一个时，多个 id 受影响（javascript 和 jquery）

> ID：10021144
> 
> 赞同：0
> 
> 时间：2012-04-05T00:28:34.643
> 
> 标签：javascript, jquery

我在 a 中有许多`.box`元素`.color_container`。我编写了这个函数，这样当我点击其中一个框时，我就可以改变它的背景颜色。这适用于一个框，但是当我单击另一个框并更改其颜色时，我单击的所有其他框也会受到影响。

我只想更改刚刚单击的框的颜色。这是我的代码。非常感谢您对此的任何帮助。

```
function defineColor(){
$(".color_container .box").click(function(){
    var boxToModify = $(this);

    if( $(this) .hasClass("plus") ){
        $(this) .css("background-color", "rgb(255, 255, 255)")
                .removeClass("plus")
                .contents().remove();
    };

    var rgb = $(this).css("background-color").match(/\d{1,3}/g);        
    $("#box_r input").val(rgb[0]);
    $("#box_g input").val(rgb[1]);
    $("#box_b input").val(rgb[2]);

    $(".box input").keyup(function(event){

        var value = $(this).val();

        if(value > 255 || isNaN(value) ){
            alert("Error! Input must be a number 255 or less.");
        }else if( value >= 0 && value <=255){
            var r = $("#box_r input").val();
            var g = $("#box_g input").val();
            var b = $("#box_b input").val();
            var output = "rgb(" + r + ", " + g +", " + b + ")";

            $(boxToModify).css("background-color", output);
        };
    });
}); 
```

};

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:35:10.140

你可能想改变这个：

```
$(".box input").keyup(function(event){ 
```

对此：

```
$(this).find('input').off('keyup').on('keyup', function(event) { 
```

每次单击单个框时，您都会将 keyup 事件绑定到具有该类的所有框。

# c++ - 图像库的 SQLite 数据库结构

> ID：10021145
> 
> 赞同：1
> 
> 时间：2012-04-05T00:28:35.190
> 
> 标签：c++, database, qt, sqlite

我想创建一个用于管理、搜索和显示图像文件数据库的应用程序，类似于 Picasa 或 Shotwell，但我对数据库几乎没有经验。我打算使用 Qt 框架使用 SQLite。

假设有 50,000 个文件。通过以下数据搜索的最佳数据库表结构是什么？添加和删​​除文件相对较少，而查询和编辑将非常普遍。

1.  图像文件的路径
2.  缩略图文件的路径（此字段不可搜索）
3.  各种元数据（作者、创建日期、尺寸、评级、文件类型等）
4.  标签数组

如果我希望搜索在用户键入时发生（类似于 Picasa 或 Shotwell），这将需要每秒最多几个查询，我应该...

1.  在启动时查询一次数据库并将数据保存在内存中？
2.  在每次更新搜索框时查询数据库？
3.  两者的混合？

据我了解，我应该创建一个包含外键的常见重复数据（标签、作者、文件类型）表。这是一个正确的假设吗？对于每个文件可能唯一的数据（例如创建日期或文件名），是否有替代方法来简单地搜索整个文件表？

任何意见，将不胜感激。谢谢你。

# c# - 使用 LINQ 过滤 XML 文件

> ID：10021149
> 
> 赞同：0
> 
> 时间：2012-04-05T00:29:12.727
> 
> 标签：c#, asp.net, xml, linq

我有一个如下所示的 XML 文件：

```
<SiteMenuItems>
    <SiteMenuItem text="Home" navigateurl="/Default.aspx" tooltip="Return Home" />
    <SiteMenuItem text="Admin" roles="Admin">    
        <SiteMenuItem text="User Admin" navigateurl="/Authorized/UserAdmin/Default.aspx" roles="SuperAdmin" />
    </SiteMenuItem>
</SiteMenuItems> 
```

使用我[在这个 StackOverflow question](https://stackoverflow.com/questions/2824794/how-to-convert-database-hierarchical-data-to-xml-using-asp-net-3-5-and-linq)中找到的示例，我能够提出以下代码：

```
 public string GetMenu()
    {

        XDocument xmlDoc = XDocument.Load(HttpContext.Current.Server.MapPath(@"~/App_Data/SiteMenu.xml"));
        xmlDoc = FilterRoles(xmlDoc); //Working on role problem
        return ExecuteXSLTransformation(xmlDoc.ToString());
    }

    private XDocument FilterRoles(XDocument xmlDoc)
    {
        XElement element = xmlDoc.Element("SiteMenuItems");
        XElement root = new XElement("SiteMenuItems",
                        (
                            from sm
                            in element.Elements("SiteMenuItem")
                            where UserHelper.IsUserAuthorized(sm.Attribute("roles"))
                            select new XElement(sm))
                        );

        XDocument menuXml = new XDocument();
        menuXml.Add(root);
        return menuXml;
    } 
```

我遇到的问题是代码仅过滤第一级：

```
<SiteMenuItem text="Admin" roles="Admin"> 
```

但我也不知道如何过滤内部 SiteMenuItem：

```
<SiteMenuItem text="User Admin" navigateurl="/Authorized/UserAdmin/Default.aspx" roles="SuperAdmin" /> 
```

就像现在一样，如果您具有管理员角色，它还会返回“用户管理员”项。

[更新] 感谢woodings，我的子节点现在正在通过“IsUserAuthorized”测试。

不幸的是，即使测试为“User Admin”节点返回“false”，该节点仍然作为整个 XML 文档的一部分返回。

我希望它会返回如下内容：

```
<SiteMenuItems>
    <SiteMenuItem text="Home" navigateurl="/Default.aspx" tooltip="Return Home" />
    <SiteMenuItem text="Admin" roles="Admin">    
    </SiteMenuItem>
</SiteMenuItems> 
```

有任何想法吗？

再次感谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T00:35:26.967

XElement.Elements() 仅返回该特定元素的直接子元素。请改用 XElement.Descendants()。

```
private XDocument FilterRoles(XDocument xmlDoc)
{
    XElement element = xmlDoc.Element("SiteMenuItems");
    XElement root = new XElement("SiteMenuItems",
                    (
                        from sm
                        in element.Descendants("SiteMenuItem")
                        where UserHelper.IsUserAuthorized(sm.Attribute("roles"))
                        select new XElement(sm))
                    );

    XDocument menuXml = new XDocument();
    menuXml.Add(root);
    return menuXml;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T01:47:03.433

我解决了我的问题，甚至消除了`FilterRoles()`方法：

```
public string GetMenu() 
{
    XDocument xmlDoc = XDocument.Load(HttpContext.Current.Server.MapPath(WebConfigHelper.GetSiteMenu));

    xmlDoc.Descendants().Where(element => !UserHelper.IsUserAuthorized(element.Attribute("roles"))).Remove();

    return XsltTransformHelper.ExecuteXslTransformation(xmlDoc.ToString(), HttpContext.Current.Server.MapPath(WebConfigHelper.GetSiteMenuTransform));
} 
```

感谢大家的帮助！！！

# c# - 可以为纵向和横向指定两种不同的布局吗？

> ID：10021152
> 
> 赞同：2
> 
> 时间：2012-04-05T00:29:43.263
> 
> 标签：c#, windows-8, microsoft-metro

我看到的 Win8 Metro 风格应用程序的 C# 示例和源代码使用故事板动画来修改页面以适应不同的视图（不仅是不同的全屏方向，还包括*捕捉*和*填充*视图模式）。

这似乎是针对不同分辨率、方向等调整视图的好方法，但是...

我有时会得到纵向和横向视图的 UI 规范，它们需要非常不同的内部结构`<Grid>`和`<StackPanel>`标签。尝试使用动画将这些结构中的一个变形为另一个似乎是一项非常艰巨的任务，更不用说随着规范的成熟而难以维护。

在我辞职采用 animate-a-single-layout 方法之前，我想确保***不能***简单地指定两个完全独立的 XAML 布局，类似于它在 Android 中的工作方式？

有人知道吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T16:42:10.123

唯一的缺点是你有一个很大的重复 XAML，就像你已经为 Landscape/Filled vs. Snapped 所做的那样。

但是，您可以做的是为您的景观布局上的某些特定属性设置动画，如果这可以让您到达您需要的位置。

例如，如果有 a`GridView`并且您的框需要从 250x250 变为 200x300，您只需复制您用于 的样式`ItemTemplate`，调整它以使宽度和高度值正确，然后使用`Storyboard`将您的`ItemTemplate`from更改`"Standard250x250"`为`"MyNewPortrait200x300Style"`。

`GridView`现在，如果这是一个根本性的变化，比如 a和 a之间的区别`ListView`，你可能只需要忍受一些重复的布局代码并使用一些`Storyboard`s 来折叠一个并显示另一个（就像模板对 Landscape/Filled vs.抢购）。

**编辑**

需要明确的是，我的意思是您最好的选择是通过动画调整样式属性，或者为您的其他布局创建一个完全独立的`Panel`（无论是`Grid`、`StackPanel`或其他），并使用动画将`Visibility`Landscape one 设置为`Collapsed`和肖像一到`Visible`。这就是 Grid Template 处理 Snapped 的方式，而且效果非常好。比尝试变形根面板的每个子控件要容易得多。

# html - 任何在复制到 word 时保留颜色格式的 Web 开发应用程序？

> ID：10021157
> 
> 赞同：2
> 
> 时间：2012-04-05T00:31:01.153
> 
> 标签：html, css, ms-word, copy

任何在复制到 word 时保留颜色格式的 Web 开发应用程序？

我尝试了 Netbeans、Dreamweaver CS5 和 Notepad++，它只是给了我默认的 Word 样式。真的不想每次都截屏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T01:44:35.060

Visual Studio 做到了，但我不确定其他任何人（Eclipse 或 Zend Studio 可能？）。有一些关于 Netbeans 插件的讨论 (http://forums.netbeans.org/topic7825.html)，但我不确定您是否会找到最近的任何内容。

我的建议是坚持使用您当前使用的任何内容，或者将您的代码粘贴到 Visual Studio 中进行代码着色（然后粘贴到 Word 中），或者使用在线着色器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-23T09:00:00.743

Notepad++ 允许使用菜单中[的格式进行复制。](https://stackoverflow.com/questions/3475790/copy-notepad-text-with-formatting)

然后我建议你链接一个快捷键，比如`CTRL`++ 。`SHIFT``C`

# javascript - Firefox 扩展中的僵尸隔间

> ID：10021161
> 
> 赞同：0
> 
> 时间：2012-04-05T00:31:30.703
> 
> 标签：javascript, firefox, memory-leaks, firefox-addon

我参与了 Firefox 扩展的开发。我们的扩展很复杂，我们遇到了永久性僵尸隔间的问题。Mozilla [Zombie 隔间页面](https://developer.mozilla.org/en/Zombie_compartments)仅提供一般信息，仅介绍问题和测试方法。

所以，我想问一下是否有人知道常见的瓶颈和有问题的设计模式（或者简单地说，已知的错误和失败）以及如何处理它们的最佳实践。

补充：这是扩展中内存泄漏的常见原因的一个[很好的链接](https://developer.mozilla.org/en/Extensions/Common_causes_of_memory_leaks_in_extensions)。还有其他建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:10:53.063

最常见的故障模式是存储对网页的引用时间过长。这可能有几个原因，我已经看到：

1.  分配给全局变量。特别是由于忘记了'var'。
2.  分配给用于存储状态而不清除它的全局变量的成员。
3.  创建关闭网页对象的新函数对象，然后将这些函数存储在某处（尤其是作为事件侦听器）一段时间。

基本上，无论何时您使用网页中的某些内容，请确保您永远不会将其分配给使用 var 声明的局部变量以外的任何内容，并且您不会创建新的长寿命函数来关闭它。这两件事将对很大一部分案件有所帮助。

请注意，这些都不是特定于 Firefox 扩展的；它适用于 JavaScript 中的所有编码...

# perl - 如何从批处理文件将参数传递给perl脚本

> ID：10021164
> 
> 赞同：2
> 
> 时间：2012-04-05T00:32:09.313
> 
> 标签：perl, batch-file, activeperl, awstats

所以，我想知道如何将参数从 Windows 中的 .bat 文件传递​​给 perl 脚本。我正在运行主动 perl。如果您想知道为什么，我正在为 awstats+iis 自动进行日志索引。

我只需直接输入命令就可以做到这一点：

```
 awstats.pl -config:blahblah.com -update 
```

我尝试将其直接放入我的批处理文件中。我也尝试使用标准的批处理文件方式：

```
 awstats.pl /config:blahblah.com /update 
```

我什至试过这个，认为破折号被 perl 以不同的方式解析：

```
 awstats.pl /-config:blahblah.com /-update 
```

所以我想我会尝试逃避破折号（当然是为了好玩）：

```
 awstats.pl /%-config:blahblah.com /%-update 
```

然后我尝试了上述组合，试图逃避冒号：

```
 awstats.pl /config%:blahblah.com /update 
```

这些都没有产生我在输入命令时得到的成功屏幕。是的，我有一个暂停，所以我可以验证...

有什么想法吗？关于参数，我有什么明显的遗漏吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T07:42:46.677

我对批处理文件一无所知，但是 Perl 附带的许多程序在[Strawberry Perl](http://www.strawberryperl.com)中都有等效的批处理文件。它们都长这样，这是对`perl`'s `-x`switch的巧妙使用：

```
@rem = '--*-Perl-*--
@echo off
if "%OS%" == "Windows_NT" goto WinNT
perl -x -S "%0" %1 %2 %3 %4 %5 %6 %7 %8 %9
goto endofperl
:WinNT
perl -x -S %0 %*
if NOT "%COMSPEC%" == "%SystemRoot%\system32\cmd.exe" goto endofperl
if %errorlevel% == 9009 echo You do not have Perl in your PATH.
if errorlevel 1 goto script_failed_so_exit_with_non_zero_val 2>nul
goto endofperl
@rem ';
...perl script goes here...
__END__
:endofperl 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:42:42.820

问题出在批处理文件中，冒号变成了等号。

```
 awstats.pl -config=blahblah.com -update 
```

这很奇怪，因为命令行接受一个冒号作为参数。也许它在批处理文件或其他东西中被神奇地忽略了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:40:40.787

尝试显式调用 perl：

```
perl awstats.pl -config:blahblah.com -update 
```

还要确保 perl 在你的 %PATH% 中。

# c# - 银行账户程序存款按钮不起作用

> ID：10021166
> 
> 赞同：2
> 
> 时间：2012-04-05T00:32:46.833
> 
> 标签：c#, webforms

该程序是一个有两个选项卡的 GUI。在第一个选项卡上有四个文本框，分别代表姓名、身份证、年龄和帐户余额。此选项卡上还有一个按钮，可将帐户添加到第二个选项卡上的组合框中。在第二个选项卡上，有名称、id、年龄和余额的组合框和四个文本框。当我从组合框中选择一个名称时，四个文本框会自动填写其信息。我遇到的问题是我必须有一个提款和一个存款按钮，用户可以输入一个金额并将其减去或添加到文本框中的余额中。我有一些撤回按钮的示例代码，有人已经帮我解决了。谁能告诉我为什么当我按下按钮时它没有改变平衡？

```
class BankAccount
{
    //attributes
    public string accountID;
    public string customerName;
    public int customerAge;
    public double balance;
    public const double DEFAULT_BALANCE = 500.00;

    //construct
    public BankAccount()
    {
    }

    public BankAccount(string anID, string aName, int anAge, double aBalance)
    {
        accountID = anID;
        customerName = aName;
        customerAge = anAge;
        balance = aBalance;
        if (aBalance == 0)
        {
            balance = DEFAULT_BALANCE;
        }
        else
        {
            balance = aBalance;
        }
    }

    public BankAccount(string anID, string aName, int anAge)
    {
        accountID = anID;
        customerName = aName;
        customerAge = anAge;
        balance = DEFAULT_BALANCE;
    }

    //accessors
    public void SetID(string anID)
    {
        accountID = anID;
    }

    public void SetName(string aName)
    {
        customerName = aName;
    }

    public void SetAge(int anAge)
    {
        customerAge = anAge;
    }

    public void SetBalance(double aBalance)
    {
        balance = aBalance;
    }

    public string GetID()
    {
        return accountID;
    }

    public string GetName()
    {
        return customerName;
    }

    public int GetAge()
    {
        return customerAge;
    }

    public double GetBalance()
    {
        return balance;
    }

}

} 
```

这是表格

```
 public partial class Form1 : Form
 {

    private List<BankAccount> account = new List<BankAccount>();

    public Form1()
    {
        InitializeComponent();
    }

    private void btnAddAccount_Click(object sender, EventArgs e)
    {
        BankAccount aBankAccount = new BankAccount(txtAccountID.Text, txtName.Text,
            int.Parse(txtAge.Text), double.Parse(txtBalance.Text));

        account.Add(aBankAccount);
        AddToComboBox();
        ClearText();

    }

    private void AddToComboBox()
    {
        cboAccount.Items.Clear();
        foreach (BankAccount person in account)
        {

            cboAccount.Items.Add(person.GetName());

        }

    }
    private void ClearText()
    {
        txtName.Clear();
        txtAccountID.Clear();
        txtBalance.Clear();
        txtAge.Clear();
        txtAccountID.Focus();

    }

    private void cboAccount_SelectedIndexChanged(object sender, EventArgs e)
    {
        txtNameTab2.Text = account[cboAccount.SelectedIndex].customerName;
        txtAgeTab2.Text = account[cboAccount.SelectedIndex].customerAge.ToString();
        txtAccountIDTab2.Text = account[cboAccount.SelectedIndex].accountID.ToString();
        txtBalanceTab2.Text = account[cboAccount.SelectedIndex].balance.ToString();
    }

    private void btnWithdraw_Click(object sender, EventArgs e)
    {

        double amount = 0;

        if (double.TryParse(txtWithdraw.Text, out amount))
        {
            if (amount > 0)
            {
                BankAccount currentAccount = account[cboAccount.SelectedIndex];
                double currentBalance = currentAccount.GetBalance();
                double amountLeft = currentBalance - amount;

                if (amountLeft >= 0)
                {
                    currentAccount.SetBalance(amountLeft);
                    txtBalanceTab2.Text = amountLeft.ToString("c");
                }
                else
                {
                    MessageBox.Show("You don't have enough money!");
                }

            }

        }
    }

}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:45:52.193

“谁能告诉我为什么当我按下按钮时它没有改变平衡？”

撤回按钮有效，因为有一个事件编码来处理点击：

```
private void btnWithdraw_Click(object sender, EventArgs e) 
```

**余额按钮没有任何此类事件。**

*我会推荐一本好书作为参考，可能很难通过谷歌搜索了解一些编程知识并请你的朋友帮助指导你。编码是艺术、科学、数学和技术的融合，而且很复杂。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:17:01.710

您的按钮中有两个 if 语句。其中之一或两者都可能是错误的。在 if 语句附近放置断点并查看调试时传递的值。或者，如果 Amountleft 不大于 0，则将 else 语句与您使用的消息框类似。您应该得到一些东西。

如果它有助于为所有值设置断点以查看正在传递的值。

# ruby-on-rails - Ruby rails - 会话管理

> ID：10021169
> 
> 赞同：2
> 
> 时间：2012-04-05T00:33:04.253
> 
> 标签：ruby-on-rails, ruby

我正在尝试在使用 ldap 进行身份验证后管理用户会话。身份验证部分运行良好，但似乎无法生成会话 ID。我收到“未定义的方法 `id' for true:TrueClass”错误。

模型 -

```
def self.Authenticate(login, pass)
  user = find_by_user_id(login)
  if user
    user
  else
    return false
  end
  conn = Net::LDAP.new(
    :host => SERVER,
    :port => PORT,
    :base => BASE,
    :auth => { 
      :username => "#{login}@#{DOMAIN}",
      :password => pass,
      :method => :simple 
    }
  )
  if conn.bind
    return true
  else
    return false
  end
rescue Net::LDAP::LdapError => e
  return false
end 
```

控制器 -

```
def create
  user = User.Authenticate(params[:user_id], params[:password])

  if user
    session[:user_id] = user.id
    redirect_to theapp_url, :notice => "Logged in!"
  else
    flash.now.alert = "Invalid email or password"
    render "new"
  end
end 
```

看法 -

```
<%= form_tag sessions_path do %>
  <p>
    <%= label_tag :Username %><br />
    <%= text_field_tag :user_id, params[:user_id] %>
  </p>
  <p>
    <%= label_tag :Password %><br />
    <%= password_field_tag :password %>
  </p>
  <p class="button"><%= submit_tag "Log in" %></p>
<% end %> 
```

错误 -

```
NoMethodError in SessionsController#create

undefined method `id' for true:TrueClass
Rails.root: /myapp

Application Trace | Framework Trace | Full Trace
app/controllers/sessions_controller.rb:12:in `create'
Request

Parameters:

{"utf8"=>"✓",
 "authenticity_token"=>"OmzCrLHR1t/xfIXNcEzy2NCGfVpEKSyI4OZfqpPEFNw=",
 "user_id"=>"admin",
 "password"=>"[FILTERED]",
 "commit"=>"Log in"} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T00:51:18.940

在 的定义中`User#Authenticate`，它可以返回 true。控制器的`create`动作有`session[:user_id] = user.id`，但在这种情况下，`user`是`true`。这就是为什么您会收到错误消息 undefined method `id' for true:TrueClass

修改您的 Authenticate 方法以始终返回用户，或修改您的控制器以接受`true`作为用户值。

# c - 如何获得复杂的 C 预处理器行为以简化动态程序汇编

> ID：10021178
> 
> 赞同：0
> 
> 时间：2012-04-05T00:33:47.850
> 
> 标签：c, include, c-preprocessor, c99

我正在编写一个程序来为另一个用 OpenCL 语言编写的动态程序汇编代码。出于这个问题的目的，我们假设动态程序语言是 C99，但限制是所有代码都必须放在一个编译块中。

我的较大程序确定了将在 main 函数中发生的一系列步骤，以及实现这些步骤所需的 C99 源文件。然后它调用 C99 预处理器/编译器来生成动态程序可执行文件。`-D SYMBOL=defn`我可以使用调用参数提供编译器宏定义。

这是一个适用于我的示例方案，并且避免了使用单独的预处理库或其他大量字符串操作工具。我将动态创建列为 mainfile.c 的字符串，其他包含的文件将实际存在。

**有什么方法可以将单独的声明和定义文件合并到一个文件中？**

```
// mainfile.c
#include "ParentDeclarationFile.txt"
#include "ChildDeclarationFile.txt"
#include "ParentDefinitionFile.txt"
#include "ChildDefinitionFile.txt"

int main()
{
    return aFunctionParent( 5 );
}

// ParentDeclarationFile.txt
typedef float Type1;
int aFunctionParent( Type1 t );

// ChildDeclarationFile.txt
int aFunctionChild( Type1 t );

// ParentDefinitionFile.txt
int aFunctionParent( Type1 t ) { return aFunctionChild( t ); }

// ChildDefinitionFile.txt
int aFunctionChild( Type1 t ) { return 2*t; } 
```

我想要一个这样的文件，我可以 #include 两次。

```
// SingleParentFile.txt
#ifdef DECLARATION_MODE
    //declarations here
#else
    // definitions here
#endif 
```

但是*`#define`定义不会传递到#include'd文件*中（**编辑：结果是不正确的。**）并且提供`-D`的定义在预处理过程中不能改变。对？第一次通过后我可以置换任何类型的预处理器状态变量吗？

注意：我试图提供一个简化的示例，它要求声明和定义部分出现在不同的代码位置。我的问题的目的不是在这个简单的示例中找到解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:54:16.413

一种简单的解决方案是`#define`使用宏来区分代码中的声明部分和定义部分。`#define`确实传播到`#include`文件。

```
// mainfile.c
#define DECLARATION_MODE
#include "ParentFile.txt"
#include "ChildFile.txt"
#undef DECLARATION_MODE
#include "ParentFile.txt"
#include "ChildFile.txt"

int main()
{
    return aFunctionParent( 5 );
}

// ParentFile.txt
#ifdef DECLARATION_MODE
    typedef float Type1;
    int aFunctionParent( Type1 t );
#else
    int aFunctionParent( Type1 t ) { return aFunctionChild( t ); }
#endif

// ChildFile.txt
#ifdef DECLARATION_MODE
    int aFunctionChild( Type1 t );
#else
    int aFunctionChild( Type1 t ) { return 2*t; }
#endif 
```

# nstableview - NSComboBoxCell 没有显示它的值。.

> ID：10021179
> 
> 赞同：0
> 
> 时间：2012-04-05T00:33:51.413
> 
> 标签：nstableview, nsarraycontroller, nscombobox

正如标题所说，我声明了一个 NSComboBoxCell，我有一个数组控制器，它实例化 selectFood 类的对象（只是为了说点什么），并且该类有一个 NSComboBoxCell 属性称为菜，类 selectFood 的 init 方法是这样的：

```
- (id)init
{
self = [super init];
if (self) {
    dishes = [NSComboBoxCell new];
    [dishes addItemWithObjectValue:@"Select"];
    [dishes addItemWithObjectValue:@"Chicken"];
    [dishes addItemWithObjectValue:@"Fish"];
    [dishes addItemWithObjectValue:@"Meat"];
    [dishes selectItemAtIndex:0];
    NSLog(@"successful initialization of selectFood\n%@",self);
}    
return self;
} 
```

一切都加载并正确实例化，问题是当它们显示时（数组控制器具有与表视图的相应绑定以及添加和删除按钮，以便将其内容显示到表视图中）只有第一个值是正在显示（在本例中为选择）如果我评论选择选项的添加或选择另一个项目（[菜肴 selectItemAtIndex：1]），它会正确显示（我的意思是如果我评论值的声明，请选择组合框单元格显示是鸡等），我真的不明白这种行为，你能给我提示一下这是怎么回事，以及如何解决它？

提前致谢！

PS：我试图将其标记为 nscomboboxcell，但该标记不存在，因此我将其标记为 nscombobox。. .

# r - 将列表参数传递给 llply

> ID：10021182
> 
> 赞同：1
> 
> 时间：2012-04-05T00:34:23.717
> 
> 标签：r, plyr, lapply

这个问题我一直没有找到满意的答案。假设我有一个功能：

```
foo <- function(a,b,c) {
...
} 
```

`a`是一个包含许多`data.frame`对象的列表

`b`是一个包含特殊数据类的列表（如果有帮助，则`ppp`来自库的类）。`spatstat`

`c`是一个整数。

我想通过该功能推送一个列表：

```
result <- llply(a, foo, b,c) 
```

列表项的名称`b`对应于 list 中 data.frames 中的“type”列`a`。所以内部功能`foo`我可以快速做到：

```
id <- which(names(b) == unique(a$type))
baseline_pattern <- b[[id]] 
```

将 b 中的每个基础空间模式与 a 中的正确 data.frame 匹配。b 中有大约 10 个项目，a 中有 1000 个项目。不幸的是，这不起作用，因为`llply`（或`lapply`通常）尝试一次推送一个列表项`a`，即使对于参数列表`b`，并且将正确列表项`b`与正确数据帧匹配的两行代码失败，因为该函数不再具有整个列表`b`。有没有办法解决？

在紧要关头，我可以创建另一个列表（有效地结合`a`and `b`），其中每个列表项本身就是一个长度为 2 的列表，其中包含`data.frame`和对应的点模式对象。但这将导致 1000 多个冗余副本（并使在集群上运行此操作的效率大大降低）。

**更新**：我打算把它变成一个`mclapply`在集群上运行它。我不能这样做`mapply`（除非有`mcmapply`）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:01:32.717

我还没有完全醒来，但听起来你想用`mapply`with `MoreArgs=list(b, c)`。

# iphone - 检查是否选择了 UIButton

> ID：10021186
> 
> 赞同：4
> 
> 时间：2012-04-05T00:35:08.443
> 
> 标签：iphone, objective-c, ios, ipad

有什么方法可以跟踪 UIButton 的状态，无论它是否被选中？我尝试访问选定的属性，但它似乎不起作用，似乎只适用于 UISwitch

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T00:40:32.023

如果您想像切换一样使用它，则需要将状态设置为选中

```
- (void)buttonTapped:(UIButton *)button;
{
    button.selected = ![button isSelected];
} 
```

然后你可以像往常一样查询它

```
[self.button isSelected]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T01:00:36.877

是的，一些 UIButtons 可以具有选定状态，这可能只是暂时的。然而，UIButtons 继承自 UIControls，它有一个 selected 属性。您可以使用以下方法查询是否选择了您的按钮：

```
if([myButton isSelected])
    NSLog(@"Selected!") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:39:12.393

你说的“被选中”是什么意思？在标准用法中，UIButtons 只有三种状态：正常、禁用和激活，其中“激活”表示“正在被点击”。它们不粘。

# c# - 在 Nhibernate 中，除了外键列之外，我是否可以使用映射中的其他条件进一步限制一对多的内容？

> ID：10021188
> 
> 赞同：1
> 
> 时间：2012-04-05T00:35:20.410
> 
> 标签：c#, nhibernate, nhibernate-3

我遇到了一种情况，表 A 对象需要将一些表 B 记录映射为一对多，但表 B 有很多记录链接到特定表 A 记录，我想进一步限制哪些记录进入一对多。这是一个遗留数据库结构，由于生产中的其他遗留程序，它不能轻易更改。

假设表 B 如下所示：

```
TableBPKey (int not null)
TableAFKey (int not null)
TableBColumn1 (char(4) null)
TableBColumn2 (varchar(50) null) 
```

假设 TableBColumn1 记录可能包含以某种方式对表 B 记录进行分类的“N”4 个字符代码中的任何一个。

无论如何，假设我已经使用 TableAFKey 列将一对多映射。我还可以告诉映射我只想要 TableBColumn1 == "ABCD" 的那些记录吗？

任何使用代码映射的东西都是首选解决方案。如果它可以在旧的 xml 映射中完成，但不能通过代码映射，我也会将其作为解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:32:42.593

我相信一对多的“公式”方法是你所追求的。您应该能够使用它来指定附加的 SQL 条件，例如“is_active = 1”。

你可以在这里找到更多信息。 [http://notherdev.blogspot.com.au/2012/02/mapping-by-code-map.html](http://notherdev.blogspot.com.au/2012/02/mapping-by-code-map.html)

*（更新链接）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:47:20.863

map.Where() 是我想要的。我测试了它并且它有效。您可以在 sql Where 子句之后放置一个可以工作的 sql 表达式，它会以这种方式限制结果。

```
Set<TableBObject>(x => x.TableBRecordsABCDOnly, map =>
            {

                map.Inverse(true);
                map.Cascade(Cascade.All);
                map.Key(k => k.Column(c => c.Name("TableAFKey")));
                map.Where("TableBColumn1 = 'ABCD'");

            },
            action => action.OneToMany()); 
```

# magento - magento中list.phtml模板中的随机产品

> ID：10021192
> 
> 赞同：1
> 
> 时间：2012-04-05T00:35:36.007
> 
> 标签：magento

下面是在 list.phtml 中的类别页面上获取产品列表的代码。

```
$_productCollection=$this->getLoadedProductCollection();
$_helper = $this->helper('catalog/output'); 
```

我想要此列表下方的另一个部分，我可以在其中列出任何类别的随机产品。我可以做些什么来调整这个相同的功能并重用它吗？

如果我可以使用相同的助手，那将非常容易。

我想要一个“你可能对这些感兴趣”的部分，我在那里展示随机产品。

谢谢抗体

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:54:12.163

我无法想象 Magento 中的某些东西如此简单：

```
shuffle($_productCollection); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T06:42:48.313

在 XML 中，您应该定义您的块，如下所示：

```
<block type="catalog/product_list_random" template="your random template" name="random" /> 
```

并在类别视图页面中只需调用您的模板，例如

```
echo $this->getChildHtml('random'); 
```

# css - 显示与块 div 列表的第一个 div 内联的 div

> ID：10021198
> 
> 赞同：0
> 
> 时间：2012-04-05T00:35:54.187
> 
> 标签：css, html, inline, block

抱歉，这是一个如此简单的问题，但我无法弄清楚。如何显示与块 div 列表的第一个 div 内联的 div。

这是一个 jsfiddle，所以你可以明白我的意思：http: [//jsfiddle.net/trpeters1/u6pt6/11/](http://jsfiddle.net/trpeters1/u6pt6/11/)

这是HTML：

```
<div class="">1</div>
<div class="">2</div>
<div class="">3</div>
<div class="title">this is my title</div> 
```

这是CSS：

```
div{
    width:30px;
    height:30px;
    margin:1px;
    background:red;
} 
```

在此示例中，我希望 div 与`class="title"`数字 1 一起内嵌显示，而不是像当前那样显示在数字 3 下方的底部。一个重要的警告是前 3 个 div 需要保持在一起，因为它们是由一些 php 代码呈现的。因此，首选基于非嵌套的解决方案。

感谢您的帮助，

蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:40:39.950

像这样？

```
<section>
    <div>1</div>
    <div>2</div>
    <div>3</div>
</section>
<section>
    <div class="title">this is my title</div>
</section> 
```

​</p>

```
div{
    width:30px;
        height:30px;
        margin:1px;
        background:red;
}
section{
    float:left;
}
.title {
    width: 150px;
} 
```

右侧标题：http: [//jsfiddle.net/u6pt6/13/](http://jsfiddle.net/u6pt6/13/)

左侧标题：http: [//jsfiddle.net/u6pt6/14/](http://jsfiddle.net/u6pt6/14/)

# ruby-on-rails - 有没有办法根据根级域重置任何和所有会话？

> ID：10021199
> 
> 赞同：0
> 
> 时间：2012-04-05T00:36:00.037
> 
> 标签：ruby-on-rails, session

我在我的应用程序中使用子域，并且 rails 为每个子域存储一个单独的会话。这意味着当用户切换子域时，他/她会设置一个新会话，这允许用户同时通过来自一个客户端的两个单独的子域登录到两个单独的帐户。

我想防止这种情况发生。除非有人有更好的建议，否则我想重置登录视图（以及注销控制器）上的所有会话。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:53:55.493

你看过这个railscast吗？

[http://railscasts.com/episodes/221-subdomains-in-rails-3](http://railscasts.com/episodes/221-subdomains-in-rails-3)

似乎你可以做这样的事情：

```
Rails.application.config.session_store :cookie_store, :key => '_blogs_session', :domain => :all 
```

... 这样 Rails 只存储一个会话。

# visual-c++ - 简单的代码显示的数字大得离谱……？

> ID：10021201
> 
> 赞同：1
> 
> 时间：2012-04-05T00:36:41.077
> 
> 标签：visual-c++

我以前运行过这个程序，它运行良好。然后我将“if”语句添加到“set”方法中，当我运行程序时我开始看到非常大的数字。我能做些什么来解决这个问题，或者有人能告诉我为什么会这样吗？

```
class GradeBook{

public: 
    void setStudentID(int ID){

        if(10000 <= studentID && studentID <= 50000){

            studentID = ID;
        }
    }

    int getStudentID(){

        return studentID;
    }

    void setStudentGrade(int grade){

        if(0 <= studentGrade && studentGrade <= 100){

        studentGrade = grade;
        }
    }

    int getStudentGrade(){

        return studentGrade;
    }

    void displayMessage(){

        cout << "Student " << getStudentID() << " has a score of " << getStudentGrade() << endl;
    }

private:

    int studentGrade;
    int studentID;
};

int main(){

    int nameOfID;
    int nameOfGrade;
    GradeBook gb;

    cout << "Please enter a student ID: " << endl;
    cin >> nameOfID;
    gb.setStudentID(nameOfID);
    cout << "Please enter the student's grade: " << endl;
    cin >> nameOfGrade;
    gb.setStudentGrade(nameOfGrade);
    getchar();

    gb.displayMessage();
    getchar();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:39:49.777

两个猜测（我的 C++ 不太好）：

1.  您的变量未初始化；如果 if 表达式的计算结果不为 true，则私有变量将永远不会设置为任何值。“大数”只是碰巧在存储变量的内存中的随机值。
2.  您正在使用 cin 读取**字符串**并将它们的指针传递给 set-methods。“大数”实际上是指针地址的（可能是一些乱码表示）。

编辑：实际上，忘记 2；[这](http://www.cplusplus.com/doc/tutorial/basic_io/)似乎表明它应该起作用。我的 C++ 有点生锈了 ;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:44:19.443

1.  你的意思是你的比较是错误的。

    ```
    if(10000 >= studentID && studentID <= 50000) 
    ```

2.  您没有其他语句来确保变量已初始化，因此我将其更改为：

    ```
    if(10000 >= studentID && studentID <= 50000){
         studentID = ID;
    }
    else{
         studentID = 0; //or whatever value you want to mean invalid
    } 
    ```

    这有望解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:42:09.520

我注意到的第一件事是你的 ivars 没有被初始化，所以如果设置器中的输入没有验证，那么你已经确定的行为是可以预料的。

您应该创建一个默认构造函数并将两个变量初始化为 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T00:43:56.040

当您定义 GradeBook gb 时，私有字段（studentGrade 和 studentID）未初始化。然后，gb.setStudentID 尝试读取 studentID。studentID 将是随机值。

# scala - Akka 远程处理和 Heroku

> ID：10021204
> 
> 赞同：8
> 
> 时间：2012-04-05T00:37:42.963
> 
> 标签：scala, heroku, akka

我正在研究 Heroku 上 Scala/Play/Akka 的使用，我对某些事情感到好奇。假设我有一个构建为 Akka 演员网络的应用程序。一些参与者将与 Web 应用程序本身处于进程中，但我可能希望留出一个或多个节点作为专用的 Akka 参与者：例如，一组缓存管理器参与者。

要配置 Akka 远程处理，我需要在`akka.conf`. 但是由于 Heroku 节点有点短暂，所以在我编写配置文件时我不会知道每个节点的地址。

拥有一个中央“注册”节点可能会简化事情，但即使在那里，我也不会提前知道该节点的 IP 地址。

那么我的 Akka 节点如何在 Heroku 上相互引用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T00:58:04.350

Heroku dynos 不能直接相互交谈，所以你必须使用像[RabbitMQ](https://addons.heroku.com/rabbitmq)这样的外部消息系统。Heroku 开发中心上有一篇很棒的文章，介绍了如何以这种方式协调 Akka Actor：
[https ://devcenter.heroku.com/articles/scaling-out-with-scala-and-akka](https://web.archive.org/web/20150908071553/https://devcenter.heroku.com/articles/scaling-out-with-scala-and-akka)

# mysql - 连接失败：HY000 MySQL ODBC 驱动程序访问被拒绝

> ID：10021209
> 
> 赞同：0
> 
> 时间：2012-04-05T00:38:16.317
> 
> 标签：mysql, database

我花了一些时间查找与我的查询类似的查询，但我找不到任何有用的解决方案。

我正在尝试在我的 Web 主机 Linux 服务器上创建与 MySQL 数据库的 ODBC 连接。他们给了我正确的登录信息。在从运行 Windows 7 的本地计算机创建连接时，遇到以下错误：

```
Connection Failed: [HY000] [MySQL][ODBC] 3.51 Driver]Access denied for user"MyDatabasename"@host-"MYLOCALMACHINE'S PUBLIC IP.net" (Using password: YES) 
```

我不知道为什么我被拒绝访问我的本地计算机而不是我希望连接的 Web 主机服务器，我似乎不知道出了什么问题。主机应该是公司的主机名而不是我的本地主机名机器主机 任何提示或帮助将不胜感激。谢谢。

# ios - iOS：UISplitViewController 无法推送到 UINavigationController

> ID：10021210
> 
> 赞同：25
> 
> 时间：2012-04-05T00:38:24.163
> 
> 标签：ios, ios5, uinavigationcontroller, uisplitviewcontroller

我有一个使用导航控制器的 XCode iPad 项目。我试图获得一个按钮来将 UISplitViewController 推送到导航堆栈，但出现此错误：

> 拆分视图控制器无法推送到导航控制器

原来 UISplitViewController 不能很好地与 UINavigationController 配合使用。但是，单击此按钮时，我仍然需要显示拆分视图控制器。我该怎么做呢？而且，同样重要的是，我如何制作一个后退按钮，以便用户可以返回到导航控制器？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-05T00:57:46.097

要显示 SplitViewController，您需要使用 setRootViewController。这是因为 SplitViewController 需要是根视图控制器。

来自 Apple 的文档：

> 拆分视图控制器必须始终是您创建的任何界面的根。换句话说，您必须始终将 UISplitViewController 对象中的视图安装为应用程序窗口的根视图。然后，拆分视图界面的窗格可能包含导航控制器、选项卡栏控制器或您实现界面所需的任何其他类型的视图控制器。

要返回，您需要使用 setRootViewController 返回上一页。当我将我的 iPhone 应用程序转换为通用应用程序时遇到了这个问题，最终我使用了 iPhone 的导航控制器和 iPad 版本的 setRootViewController。这有点令人沮丧，因为如果不加一点修饰就无法很好地制作[动画](https://stackoverflow.com/questions/9671926/can-you-animate-setrootviewcontroller)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-06-29T10:27:31.077

**如果您仍需要导航到，一种解决方法`splitView`是创建一个空文件`UIViewController`并将其添加`splitViewController`为子项**

```
/// This should be in your parent controller
/// that you to navigate your splitView
func navigateToSplit() {

    let container = UIViewController()
    let splitView = MySplitViewController() // ===> Your splitViewController
    container.addAsChildViewController(type: splitView, attached: container.view)
    navigationController?.pushViewController(container, animated: true)
}

extension UIViewController {
    /// this add a child controller to the view of another controller
    func addAsChildViewController(type controller: UIViewController, attached toView: UIView) {

        // Add Child View Controller
        addChild(controller)

        // Add Child View as Subview
        toView.addSubview(controller.view)

        // Configure Child View
        controller.view.frame = toView.bounds
        controller.view.autoresizingMask = [.flexibleWidth, .flexibleHeight]

        // Notify Child View Controller
        controller.didMove(toParent: self)

    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-05-14T18:16:23.047

> 无法通过导航控制器推送拆分视图控制器，但有一种替代方法可以完成工作

您可以创建一个视图控制器并将拆分视图控制器添加为子视图，然后您可以通过导航控制器推送创建的视图控制器。它将显示您的拆分视图控制器，您可以同时使用主视图和细节。

***记得**将 yoursplitviewcontroller 类添加到故事板中的自定义类中

***注意***splitcontroller -> (master, detail)

```
let splitVC = getViewController(storyBoardName: "story board name", viewControllerName: "split view controller identifier") as! yoursplitviewcontroller
        view.addSubview(splitVC.view)
        view.bounds = splitVC.view.bounds
        addChild(splitVC)

func getViewController(storyBoardName: String, viewControllerName: String) -> UIViewController{
        let storyBoard = UIStoryboard(name: storyBoardName, bundle: nil)
        return storyBoard.instantiateViewController(identifier: viewControllerName)
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-27T14:22:49.243

我在我的应用程序中添加了包含 SplitView 的第 6 个选项卡。在 iPad 上，新选项卡在选择时工作正常，但在 iPhone 上，新选项卡被移动到“更多...”选项卡，并且在选择时产生“拆分视图控制器无法推送到导航控制器 <UIMoreNavigationController:”消息。

我通过移动新标签解决了这个问题，这样它就不会落入“更多...”标签中。

可以在以下位置找到对该问题的更深入讨论：

[带有七个选项卡的选项卡栏控制器，五个选项卡导致拆分视图控制器](https://stackoverflow.com/q/33871819/1911037)

# java - 如何设置按钮的相对位置？

> ID：10021211
> 
> 赞同：0
> 
> 时间：2012-04-05T00:38:26.183
> 
> 标签：java, swing

现在我有一个名为 panel1 的面板，我想在 panel1 上放置一个按钮，并将按钮的位置设置为 (30,30)。我怎样才能做到这一点？

我试过这个，但似乎它不是正确的方法:(

```
 int x = panel1.getX();
     int y = panel2.getY();
     button.setLocation(x+30,y+30); 
```

非常感谢，布局管理器似乎是个不错的选择，但这是我的问题，我需要在面板上动态生成很多按钮，而且按钮大小也不一样。那么我应该使用哪个布局管理器？根据教程，似乎没有这样的布局管理器....一个关键问题是我不希望按钮看起来像在网格中组织，例如，button1 at (20,20) size 15 , 按钮 2 为 (40,70) 尺寸 20，按钮 3 为 (150,40) 尺寸 5.....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T12:23:04.760

使用[NetBeans 中的表单设计](http://netbeans.org/features/java/swing.html)器，您可以将按钮放置在 GUI 界面中相对于彼此的任意位置。构建器使用您可以手动执行的[GroupLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/groupExample.html)，但不建议这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T12:19:17.280

> 我希望按钮分散在面板中。

为此使用[绝对布局](http://docs.oracle.com/javase/tutorial/uiswing/layout/none.html)很诱人，但您必须想办法防止按钮重叠甚至相互隐藏。可能值得[*创建一个自定义布局管理器*](http://docs.oracle.com/javase/tutorial/uiswing/layout/custom.html)。

# javascript - 如何在 OAuth 2.0 中获取刷新令牌？

> ID：10021212
> 
> 赞同：3
> 
> 时间：2012-04-05T00:38:27.727
> 
> 标签：javascript, google-chrome-extension, xmlhttprequest, oauth-2.0

我正在编写一个 Chrome 扩展程序，它需要通过 OAuth 2.0 访问 minus.com。我有密钥和秘密，但没有刷新令牌，所以每次我制作一个`XMLHttpRequest`刷新令牌`undefined`时，服务器都会响应 400 错误，响应文本显示“没有这样的刷新令牌：未定义”。那么谁能告诉我如何获得刷新令牌？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:34:39.517

refresh_token 应该在令牌获取期间使用用户权限步骤在响应结构中传回，如下所示：http: [//miners.github.com/MinusAPIv2/v2/auth_tutorial.html#getting-tokens-using-user-credentials](http://miners.github.com/MinusAPIv2/v2/auth_tutorial.html#getting-tokens-using-user-credentials)

您将使用用户凭据发出对令牌的请求，然后返回如下所示的响应结构：

```
{
    "access_token": "dc19a1ea88",
    "token_type": "bearer",
    "expires_in": 3600,
    "refresh_token": "20ad15128b",
    "scope": "read_public"
} 
```

如果您提取刷新令牌，然后在此处的刷新步骤中使用它：http: [//miners.github.com/MinusAPIv2/v2/auth_tutorial.html#refreshing-an-access-token](http://miners.github.com/MinusAPIv2/v2/auth_tutorial.html#refreshing-an-access-token)应该可以工作。

# javascript - 为什么在此代码中一个变量大于另一个变量？

> ID：10021220
> 
> 赞同：0
> 
> 时间：2012-04-05T00:39:36.083
> 
> 标签：javascript, comparison, numeric

为什么是`rfd_total > max_rfd`真的？我不明白如何`rfd_total`比`max_rfd`以下代码更大：

```
max_rfd = parseFloat(jQuery('#mx-rfd_'+order_id).val()).toFixed(2);

rfd_total = parseFloat(items_total+tax_total+shipping+allowances*1).toFixed(2);

if( rfd_total > max_rfd)
{   if(isNaN(rfd_total)) alert('rfd_total isNaN'); // not triggered
    if(isNaN(max_rfd)) alert('max_rfd isNaN'); // not triggered
    alert(rfd_total); // alerts 51.16
    alert(max_rfd); // alerts 102.32
    return false;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T00:43:21.680

这是因为`rfd_total`an`max_rfd`是字符串。

您会注意到`"51.16" > "102.32"`返回 true。

`toFixed()`返回一个字符串。

您需要将变量强制转换为数字，您可以通过快速搜索了解如何操作。

或者你可以保持你的代码干净，并使用这样的函数正确地完成它

```
function decimalRoundTo(n, decimalPlaces) {
    var d = Math.pow(10, decimalPlaces);
    return Math.round(n*d)/d;
} 
```

# javascript - 如何管理 DOM 元素

> ID：10021223
> 
> 赞同：3
> 
> 时间：2012-04-05T00:39:58.313
> 
> 标签：javascript, jquery, asp.net, html

我已经实现了无限滚动（即当滚动条到达 div 的底部时加载记录）。它工作正常，但是在页面上加载太多记录后，页面变得太重并导致渲染缓慢。实际上，我正在使用这种技术作为 gridview 的替代品，那么在这种情况下我该如何管理繁重的 DOM？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:25:38.227

1.  将 DOM 元素减少到最少。
2.  尽量减少包装器的数量。
3.  最小化对 DOM 元素的访问，其中包括（[雅虎建议](http://developer.yahoo.com/performance/rules.html)）：
    *   缓存对访问元素的引用
    *   “离线”更新节点，然后将它们添加到树中
    *   避免使用 JavaScript 修复布局
4.  如果有任何可以减少的计算，例如获取行数（不要每次都计算，只需将新行数添加到当前行数），缓存它（memoization [^(wikipedia)](http://en.wikipedia.org/wiki/Memoization)）

如果您对 DOM 元素的集合有任何类型的迭代并且您不使用 jQuery 进行迭代，请使用此（[JavaScript 模式](https://rads.stackoverflow.com/amzn/click/com/0596806752)的建议）：

```
for (var iteration = 0, limit = lengthOfElements; iteration++; iteration < limit) 
```

或者

```
for (var i = myarray.length; i--; ) 
```

# jquery - 如何在 JQuery 中定位一系列 div 中的第一个 div

> ID：10021225
> 
> 赞同：1
> 
> 时间：2012-04-05T00:40:02.393
> 
> 标签：jquery

我在另一个 div 中有一个 div 列表，我只想定位第一个。

```
<div id="content">
  <div>
    I want to target this Div
  </div>

  <div>
  </div>

  <div>
  </div>
</div> 
```

我将如何只针对第一个而忽略其余的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:45:03.187

你也可以这样做：

```
$('#content div').first() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:42:39.617

试试`$('#content div:first')`。

# c# - 如何在 List 中选择键值对列表 >> 并修改它们的值？C＃

> ID：10021229
> 
> 赞同：2
> 
> 时间：2012-04-05T00:40:30.073
> 
> 标签：c#, linq, select, key-value

现在这个问题很难。现在这是我的主要清单

```
List<List<KeyValuePair<string, double>>> dblWordFreqByCluster = new List<List<KeyValuePair<string, double>>>(); 
```

所以让我们给出示例列表

```
(house,40),(home,20),(monitor,40)
(home,10),(work,60),(monitor,30)
(school,70),(home,10),(word,20) 
```

所以每一行都是一个`List<KeyValuePair<string, double>>`，并且有一个包含所有这些行的最大列表。

我想要做的是选择每个单词的值，将它们相加，然后将整个列表中的单词数除以。所以经过这个修改列表会变成以下

```
(house,40),(home,40/3),(monitor,70/2)
(home,40/3),(work,60),(monitor,70/2)
(school,70),(home,40/3),(word,20) 
```

这意味着获取每个键的平均值并更新每个键的值。

C# 4.0 WPF

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T00:49:36.857

使用 Linq 很容易。首先，计算每个键的平均值：

```
var averages =
    (from list in dblWordFreqByCluster
     from kvp in list
     group kvp by kvp.Key into g
     select new 
     {
         Key = g.Key,
         Avg = g.Average(kvp => kvp.Value)
     }).ToDictionary(x => x.Key, x => x.Avg); 
```

然后更新列表。由于`KeyValuePair`它是不可变的，因此您需要将这些项目替换为新项目：

```
foreach (var list in dblWordFreqByCluster)
{
    for (int i = 0; i < list.Count; i++)
    {
        string key = list[i].Key;
        list[i] = new KeyValuePair<string, double>(key, averages[key]);
    }
} 
```

# javascript - 取消选中时保留浮动图例标签复选框

> ID：10021239
> 
> 赞同：2
> 
> 时间：2012-04-05T00:40:53.203
> 
> 标签：javascript, jquery, graph, flot

我有一个场景，我想根据复选框选择来切换系列。我在图例中使用**labelFormatting**选项将复选框添加到图例中，例如：

```
 var otherOptions = {
                           legend: {
                                     container: legend,
                                     labelFormatter: function (label, series) {
                                        var cb = '<input type="checkbox" name="' + label + '" checked="checked" id="id' + label + '"> ' + label;
                                        return cb;
                                     }
                            },
                         }; 
```

我已经为图例添加了点击事件，以便我可以根据选中的项目来操作系列。一切正常，除非我取消选中图例中的标签，重新绘制它也会从图例中删除该系列线。所以例如，下面是之前和之后的图像：

**前**

![前](../Images/55ade5c1f6f901c911ee1202d06a137b.png)

**后**

![后](../Images/b33255c0b5c8b28205947f87464b56af.png)

请注意，后图像“美国”复选框缺失。有什么办法我仍然可以在图例中显示未选中的“美国”复选框？

我在这里查看了建议：[flot graph, use legend to turn on/off series](https://stackoverflow.com/questions/4230945/flot-graph-use-legend-to-turn-on-off-series)

但唯一的问题是我不想将图例和复选框图例分开。给定链接上的问题已在 1 年前得到回答，所以我想我会抓住机会再次问这个问题，以防有人知道如何做到这一点。

请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T15:57:21.393

如果未选中该复选框，则不要一起删除该系列，而是使用空数据添加它。

像这样的东西：

```
function plotByChoice(doAll)
{
  $('#legend .legendCB').each(
   function(){
     if (this.checked)
     {         
       data.push(datasets[someLabel]);
     }
     else
     {
       data.push({label: someLabel, data: []})
     }        
   }
 );

 // plot call etc...
} 
```

工作小提琴就[在这里](http://jsfiddle.net/larsenmtl/GVt9V/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-14T17:41:35.773

### 对于任何寻找干净解决方案和 Chart.js v3 的人：

不幸的是，这对于 Chart.js v3 是不可能的，因为图例是用文本生成的（不幸的是，不能将 HTML 附加到图例本身）。

我们必须使用`generateLabels`函数来渲染图例标签。

我建议使用`pointStyle`渲染图像的选项（实际上是复选框），而不是默认情况下的矩形，因此我们可以在每次用户检查或不检查图例时自动重新渲染（它是动态的，ofc，我们不必做任何事情编程复杂）。

因此，首先，生成与复选框相对应的 2 个图像（我使用的是从 SVG 文件以 PNG 格式生成的 FontAwesome 图标）：

```
let checkboxYes = new Image(14, 14);
checkboxYes.src = '/static/img/check_yes.png';
let checkboxNo = new Image(14, 14);
checkboxNo.src = '/static/img/check_no.png'; 
```

然后，我们可以在 Chart.js 选项中使用它：

```
legend: {
    labels: {
        usePointStyle: true,
        generateLabels: function(chart) {
            labels = Chart.defaults.plugins.legend.labels.generateLabels(chart);
            for (var key in labels) {
                labels[key].pointStyle = labels[key].hidden ? checkboxNo : checkboxYes
            }
            return labels;
          }
    }
}, 
```

### 解释

*   我设置`usePointStyle`为**true**以便以后可以自定义点样式
*   `Chart.defaults.plugins.legend.labels.generateLabels(chart)`有点为我预先生成标签（并将其存储到标签中），所以它就像一个函数覆盖！
*   然后对于每个标签，我将**根据****参数**`pointStyle`将其更改为复选框图像（如果用户选中了该框）**`hidden`**
*   最后，返回标签

这可能不是最好的解决方案，但对我来说效果非常好：

[单击此处以 GIF 格式查看动画结果 :)](https://i.stack.imgur.com/JOW8I.gif)

# c - read_un/lock(&tasklist_lock) 的意义

> ID：10021240
> 
> 赞同：1
> 
> 时间：2012-04-05T00:41:04.170
> 
> 标签：c, linux, architecture, linux-kernel

在跟踪等待系统调用的路径时，注意到在调用 do_wait_thread 之前我们获取了 tasklist_lock。我试图了解 tasklist_lock 的重要性以及它适合使用的地方。

```
716        read_lock(&tasklist_lock);
1717        tsk = current;
1718        do {
1719                retval = do_wait_thread(wo, tsk);
1720                if (retval)
1721                        goto end;
1722
1723                retval = ptrace_do_wait(wo, tsk);
1724                if (retval)
1725                        goto end;
1726
1727                if (wo->wo_flags & __WNOTHREAD)
1728                        break;
1729        } while_each_thread(current, tsk);
1730        read_unlock(&tasklist_lock); 
```

我看了一下tasklist_lock的声明，如下。

```
/*
 251 * This serializes "schedule()" and also protects
 252 * the run-queue from deletions/modifications (but
 253 * _adding_ to the beginning of the run-queue has
 254 * a separate lock).
 255 */
 256 extern rwlock_t tasklist_lock;
 257 extern spinlock_t mmlist_lock; 
```

我无法理解我们应该在哪里使用它。你能告诉我这件事吗？感谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:32:59.827

循环遍历当前任务的每个线程。持有任务列表锁可确保循环运行时这些线程都不会消失。

# c - 调度算法cpu时间

> ID：10021243
> 
> 赞同：0
> 
> 时间：2012-04-05T00:41:21.627
> 
> 标签：c, unix, process, scheduling, system-clock

我正在尝试使用循环和 fcfs 为 C 中的调度算法制作一个模拟器。

我只是有几个问题，因为我试图查找它并阅读内核命令，但我仍然很困惑:(这个程序是在 putty(linux) 上完成的，你有一个带有时钟的进程列表执行或占用cpu时间。

1.  我们如何让一个进程占用 CPU 时间？我们是调用 sys() 函数（不知道是哪一个），还是当我在程序中从文本文件中读取它时，我们是否打算 malloc 一个进程？我知道我可能听起来很愚蠢，但请解释一下。

2.  您建议用于存储 ex (0,2,70,8) 的进程（创建时间、进程 ID、内存大小、作业时间）的最佳数据结构是什么？

3.  当一个进程在其工作时间内完成时，我们如何终止它以使其从CPU中释放出来，以确保其他进程在它可以使用cpu之后的时钟时间？

4.  您如何实现时钟时间，是否有任何内置函数或仅使用 for 循环。

我希望这些不是问太多问题，但谁能回复我，我将不胜感激。

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:49:13.403

如果您正在构建一个模拟器，您实际上不应该等待那么长的时间，您应该通过更新计数器并说进程 p1 到目前为止总共运行了 750 毫秒，计划 3 次，分别为 250 毫秒、250 毫秒、250 毫秒等，来“安排”。 .. 尝试在用户空间中实时运行调度模拟势必会给您带来奇怪的结果，因为您的进程本身也需要调度。

例如，如果你想模拟 FCFS，你可以实现一个简单的“进程”队列，并给它们每个时间片（你可以使用默认的内核时间片或你自己的，没关系），这些进程中的每一个都会有完成一些总执行时间，您可以根据此进行计算。例如，P1 是一个进程，需要 3.12 秒的 CPU 时间才能完成（我认为不需要内存模拟，因为我们正在进行调度而不是缓存或其他任何考虑）。您只需像往常一样运行算法，但只是添加数字，因此您“运行”P1，将时间添加到它的计数器并检查它是否完成。如果是检查差异等...并且您可以保留全局时间以跟踪它在挂钟时间中运行了多长时间。

现在，如果您想测量完全不同的调度性能，这通常涉及运行工作负载基准以在系统上运行许多进程并检查每个进程的整体性能指标。

# php - 当用户正在下载时，为什么他们不能加载另一个页面？

> ID：10021248
> 
> 赞同：0
> 
> 时间：2012-04-05T00:42:11.197
> 
> 标签：php, download, fopen, fread

下载脚本的相关代码：

```
$fp = @fopen($file, 'rb');

while(!feof($fp) && ($p = ftell($fp)) <= $end) {

    if ($p + $buffer > $end) {
        $buffer = $end - $p + 1;
    }
    echo fread($fp, $buffer);
    flush();
    if($limits["Max_DL"]) sleep(1); 
}

fclose($fp); 
```

在下载过程中，不会加载同一站点的任何其他页面。但它们仍然会在另一个浏览器中加载。我认为这与下载页面不断“加载”以阻止其他页面加载这一事实有关？

关于如何解决这个问题的任何建议？对于大文件，我不希望用户在下载过程中无法浏览网站

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-14T18:19:04.317

如果您的下载脚本`session_start()`在任何时候调用，您将需要在`session_write_close()`将文件流式传输给用户之前调用。

这将关闭 PHP 会话文件并允许用户加载可能正在调用的另一个页面`session_start`（因此正在等待会话文件上的锁定）。

`$_SESSION`注意：调用后您仍然可以阅读`session_write_close()`，但任何修改都将被丢弃 - 您只是告诉 PHP 您已完成对会话的更改。

更多信息： [http ://us2.php.net/manual/en/function.session-write-close.php](http://us2.php.net/manual/en/function.session-write-close.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T00:59:01.540

PHP 不是交付大文件的最佳解决方案，因为您将在服务器上为每个用户占用整个下载过程中的进程；如果您使用的是 Apache 或 nginx，您应该考虑使用[mod_xsendfile](https://tn123.org/mod_xsendfile/)或[XSendfile](http://wiki.nginx.org/XSendfile/)来提供文件。

如果这不可能，您总是可以尝试通过使用该`readfile()`功能来简化交付文件的过程。

# c# - 将枚举作为参数传递

> ID：10021249
> 
> 赞同：3
> 
> 时间：2012-04-05T00:42:22.397
> 
> 标签：c#, types, parameters, enumeration

我正在尝试制作一个简单的 Roguelike 游戏来更好地学习 C#。我正在尝试创建一个通用方法，我可以给它一个 Enum 作为参数，它将返回该 Enum 中有多少元素作为 int。我需要使其尽可能通用，因为我将有几个不同的类调用该方法。

我已经搜索了最后一个小时左右，但我在这里找不到任何资源或其他可以完全回答我的问题的资源......我仍处于 C# 的初学者 - 中级阶段，所以我仍在学习所有事物的语法，但这是我到目前为止所拥有的：

```
// Type of element
public enum ELEMENT
{
    FIRE, WATER, AIR, EARTH
}

// Counts how many different members exist in the enum type
public int countElements(Enum e)
{
    return Enum.GetNames(e.GetType()).Length;
}

// Call above function
public void foo()
{
    int num = countElements(ELEMENT);
} 
```

它编译时出现错误“参数 1：无法从 'System.Type' 转换为 'System.Enum'”。我有点明白为什么它不起作用，但我只需要一些指导来正确设置所有内容。

谢谢！

PS：是否可以在运行时更改枚举的内容？当程序执行时？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T00:44:36.790

试试这个：

```
public int countElements(Type type)
{
    if (!type.IsEnum)
        throw new InvalidOperationException();

    return Enum.GetNames(type).Length;
}

public void foo()
{
    int num = countElements(typeof(ELEMENT));
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T00:53:09.157

您也可以使用通用方法来执行此操作。就我个人而言，我更喜欢`foo()`这种方法的语法，因为您不必指定`typeof()`

```
 // Counts how many different members exist in the enum type
    public int countElements<T>()
    {
        if(!typeof(T).IsEnum)
            throw new InvalidOperationException("T must be an Enum");
        return Enum.GetNames(typeof(T)).Length;
    }

    // Call above function
    public void foo()
    {
        int num = countElements<ELEMENT>();
    } 
```

# java - 我在 main.xml 中设置的背景颜色在应用程序运行时未显示

> ID：10021259
> 
> 赞同：0
> 
> 时间：2012-04-05T00:44:25.907
> 
> 标签：java, android

我在 main.xml 中设置背景颜色。

当我在 Eclipse 中预览布局时，背景颜色显示正确，但是当应用程序在我的设备上运行时，背景颜色默认为黑色。似乎我在 main.xml 中的任何更改都没有在应用程序运行时反映出来。

这是我的 main.xml 文件

```
<?xml version="1.0" encoding="utf-8"?>

<ListView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/lst"
android:layout_width="match_parent"
android:background="@color/listViewBG"
android:divider="@drawable/divider"
/> 
```

这是主要活动中的 OnCreate

```
public class AleWorldActivity extends ListActivity
{
String classes[] = { "Movies", "Pictures" };

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setListAdapter(new ArrayAdapter<String>(AleWorldActivity.this, android.R.layout.simple_list_item_1, classes));
} 
```

有任何想法吗？谢谢

这是我的strings.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>

<string name="hello">Hello World, AleWorldActivity!</string>
<string name="app_name">Ale World</string>
<color name="listViewBG">#e101f5</color>

</resources> 
```

凯文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:06:15.100

你应该在 上声明你的颜色`colors.xml`。在同一文件夹中创建该文件`strings.xml`。

除此之外，您还有一些错误：

*   您缺少`setContentView(R.layout.main)`AleWorldActivity 上的 。
*   您的 ListView 的 id 是错误的。将其更改为：`android:id="@android:id/list`
*   添加`android:layout_height="wrap_content"`您的 ListView xml。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:09:54.617

更改`@color/listViewBG`以`#FFFFFF`查看屏幕是否更改颜色，这意味着您在 strings.xml 中声明它时存在问题。

[http://developer.android.com/resources/samples/SoftKeyboard/res/values/colors.html](http://developer.android.com/resources/samples/SoftKeyboard/res/values/colors.html)

# c# - 在参考中找不到 System.Drawing.dll

> ID：10021262
> 
> 赞同：1
> 
> 时间：2012-04-05T00:44:48.137
> 
> 标签：c#, .net, visual-studio, windows-phone-7

我有一个奇怪的问题。我正在使用适用于 Windows Phone 的 Visual Studio 2010 Express，并希望引用 System.Drawing.dll。我在项目中右键单击“引用”并单击“添加引用...”，但是，我在 .NET 选项卡下找不到 System.Drawing.dll。任何想法为什么？谢谢！

飞

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T00:49:34.937

那是一个 Winforms 程序集，它要求主机操作系统支持 GDI+，这对 wp7 不可用。

看看[System.Windows.Media](http://msdn.microsoft.com/en-us/library/system.windows.media.aspx)代替

# php - PHP MySQL中大双的奇怪行为

> ID：10021264
> 
> 赞同：0
> 
> 时间：2012-04-05T00:45:03.380
> 
> 标签：php, mysql

我有一个数据库，用于存储长度为 17 个字符的车辆的 VIN 号码（存储为 VID）。我正在尝试递增到下一个 VID 以将其显示在可以在数据库中添加新车的页面上。数据库中的 VID 字段类型为 bigint(17) 并设置了 auto_increment。

```
$incr_query = "SELECT MAX(VID) FROM Vehicle";
$incr_result = mysql_query($incr_query);
$row = mysql_fetch_assoc($incr_result);
$vid = $row["MAX(VID)"] + 1; 
```

输出：

```
print var_dump{$row);//array(1) { ["MAX(VID)"]=> string(17) "12345678123456788" }
print gettype($vid);    //double
print $vid;             //1.2345678123457E+16
print number_format(++$vid, 0, '.', '');       //12345678123456788
print number_format(--$vid, 0, '.', '');       //12345678123456788
print number_format($vid - 5, 0, '.', '');     //12345678123456784 
```

我不确定这里发生了什么。根据[PHP 浮动手册](http://php.net/manual/en/language.types.float.php)：

```
"The size of a float is platform-dependent, although a maximum of ~1.8e308 with 
a precision of roughly 14 decimal digits is a common value" 
```

**编辑：**

所以使用 bcadd，这些是输出：

```
$vid = bcadd($vid, '1', 0); 
print "\n".$vid;                              //12345678123456789
print "\n".number_format($vid, 0, '.', '');   //12345678123456788 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:50:50.943

VID 号码可能**看起来**像“双”或“整数”或其他任何东西，但它**不是**。将其存储为字符串。查看[Vimeo](http://vimeo.com/7403673)上的 Skeet 以获得解释。它从 6:10 左右开始，到 10:00 左右结束。

A bigint in the DB might do, but a double is a [floating point](http://en.wikipedia.org/wiki/Floating_point) and floating points are [not intended](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems) to be used as discrete numbers; that's why they're floating points. I would go with string (varchar) all the way, up to the database. Using a bigint would encourage you/other developers to keep treating it as a "number" wich, in fact, it isn't (exactly).

# c# - 使用带 out 参数的 dynamic 调用方法

> ID：10021265
> 
> 赞同：3
> 
> 时间：2012-04-05T00:45:12.673
> 
> 标签：c#, dynamic

我有一个`Dictionary<string,K>`where K 是通过反射加载的类型，我不能命名 K。

不幸的是，我无法弄清楚我应该如何使用该`TryGetValue`方法。我尝试了几种不同的方法，它们都导致异常。我该怎么办？

```
dynamic dict = GetDictThroughMagic();
dynamic d;
bool hasValue = dict.TryGetValue("name",out d);
bool hasValue = dict.TryGetValue("name",d); 
```

我可以写得更详细`if(dict.Contains("name")) d=dict["name"]`

但如果我可以编写更简洁的 TryGetValue 方法，我会更喜欢。

更新以包括实际异常：

```
Unhandled Exception: Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The
best overloaded method match for 'System.Collections.Generic.Dictionary<string,K>
.TryGetValue(string, out K)' has some invalid arguments
   at CallSite.Target(Closure , CallSite , Object , String , Object& ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T01:14:28.920

您不能这样做，因为在.Net 中，用作`ref`和`out`参数的变量必须与类型完全匹配。`dynamic`变量实际上是运行时的`object`变量。

但是您可以通过切换哪个参数是哪个参数是`out`返回值来解决这个问题，尽管使用它会比正常情况下好`TryGetValue()`：

```
static class DictionaryHelper
{
    public static TValue TryGetValue<TKey, TValue>(
        Dictionary<TKey, TValue> dict, TKey value, out bool found)
    {
        TValue result;
        found = dict.TryGetValue(value, out result);
        return result;
    }
} 
```

然后你可以这样称呼它：

```
dynamic dict = GetDictThroughMagic();
bool hasValue;
dynamic d = DictionaryHelper.TryGetValue(dict, "name", out hasValue); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:57:22.930

你为什么用一个`dynamic`？这是通过互操作来的吗？我建议使用可以在这里使用的通用抽象。反射并不意味着动态，并且这个关键字在静态语言中被扔在不需要它的地方。它是为互操作而设计的...

更具体到您的问题：[这似乎是一个很好的答案](https://stackoverflow.com/questions/3929444/dynamic-type-in-method-parameter)。我不相信演员表可以在这里工作，因为它不能转换为 K 型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-11T14:37:43.120

我最近遇到了类似的错误，但找到了一个解决方案，使所有对字典的访问都是动态的。

尝试

```
dynamic dict = GetDictThroughMagic();
dynamic value = "wacka wacka"; // I renamed from 'd' and gave it a value
dynamic key = "name";

if (dict.ContainsKey(key))
{
    dict[key] = value;
} 
```

希望这对你有用！

# c++ - 对话框类不允许我在对话框上与 CButton 交互？

> ID：10021268
> 
> 赞同：-1
> 
> 时间：2012-04-05T00:45:43.910
> 
> 标签：c++, visual-c++, mfc

如果我在 myTab 类中创建 CButton，我无法以用户身份与其交互。

但是，如果我在 Main CDialog 中“创建”CButton 并将 pParentWnd 设置为 dlgMine，那么我可以与之交互。

谢谢

```
//Main CDialog

CDialog *dlgMine = new myTab(this);
dlgMine->Create(IDD_DIALOG1,this);

dlgMine->SetWindowPos(&wndTop, 20, 20, 300, 300, SWP_SHOWWINDOW); 
```

* * *

```
myTab::myTab(CWnd* pParent /*=NULL*/)
    : CDialog(myTab::IDD, pParent)
{
    //{{AFX_DATA_INIT(myTab)
        // NOTE: the ClassWizard will add member initialization here
    //}}AFX_DATA_INIT

    CButton *btn = new CButton();
    btn->Create("Run", WS_BORDER|WS_CHILD|WS_VISIBLE|BS_PUSHBUTTON,CRect(40,40,100,100),this,10);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T06:44:41.860

您不应在对话框构造函数中创建按钮，因为对话框本身仍未创建。而是在 OnInitDialog 中执行此操作。

# php - 使用 php 或 ajax 在索引文件中包含内容以进行搜索优化

> ID：10021271
> 
> 赞同：0
> 
> 时间：2012-04-05T00:46:09.073
> 
> 标签：php, jquery, ajax, static

过去几天我一直在设计一个网站，我意识到我可能使用了错误的格式来编码网站。

我通常会在 index.php 中使用（这很容易讨论）

```
<?php 
require("header.php");
include("home.php");
require("footer.php);
?> 
```

我可以使用它来设置一个简单的布局，我不需要为新页面再次重写代码。

或者有时我会使用它的变体让它指向我想要的链接。

我的一个朋友告诉我，由于搜索 google 等，这不是加载页面的好方法。

我想知道我是否必须以某种方式使用 Ajax 并根据谷歌的爬行系统编写代码（我真的很困惑）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:49:23.917

PHP 在请求页面时在服务器端运行，因此当客户端能够查看页面时它已经运行。无论您使用 php 输出什么，都将是所看到的，而不是实际的 php。

# javascript - 如何从数据对象中提取字符并返回新的

> ID：10021272
> 
> 赞同：2
> 
> 时间：2012-04-05T00:46:44.283
> 
> 标签：javascript

我想把这个**1332251639632**变成这个**1332251639**

我尝试了这段代码，但因为它不是一个字符串，所以它不起作用

```
var date = new Date();
var t = date.getTime();
var p = t.substring(10);

alert(p); 
```

我想剪掉它，因为在 php **time()**中返回 10 位数字

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:50:43.360

像这样？

```
var p = parseInt(t/1000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:22:10.553

我认为更好的方法是：

```
var dateObject = new Date(),
    time = dateObject.getTime();
Math.floor ( time / 1000 ); 
```

现在原因是：

1.  parseInt() [^(ECMA Specs)](http://ecma262-5.com/ELS5_HTML.htm#Section_15.1.2.2)期望一个字符串被某个基数转换。在幕后，解释器正在处理字符串，最后返回整数。示例[^(MDN)](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseInt#Examples)该功能如何工作。正如[Chris Wesseling 指出](https://stackoverflow.com/a/10028887/179669)的那样，由于字符串和基数的额外工作，它更慢。ES5 将在未来版本的浏览器中实现，将强制使用基数，原因如下：

    parseInt("011"); //返回9，0起始字符串表示八进制数

    parseInt("011", 10); //按预期返回11

2.  getTime() [^(MDN)](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/getTime)将返回一个数字，自 1970 年 1 月 1 日 00:00:00 UTC 以来的毫秒数，没有从字符串到数字的转换。这意味着“语义上”更好地使用舍入功能。

3.  floor( *x* ) [^(ECMA 规范)](http://ecma262-5.com/ELS5_HTML.htm#Section_15.8.2.9)旨在处理数字。返回不大于 x 的最大数值。使用[^(MDN)](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/floor#Examples)
4.  ceil(x) [^(ECMA Specs)](http://ecma262-5.com/ELS5_HTML.htm#Section_15.8.2.6)几乎相同 - 返回不小于 x 的最小 Number 值。使用[^(MDN)](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/ceil#Examples)

有点离题 即使是[Linux y2k(38) 问题](http://en.wikipedia.org/wiki/Year_2038_problem)也不会产生任何影响，因为该数字是 64 位的，并且 Javascript 中的整数在 53-bits [^(ECMA Specs)](http://ecma262-5.com/ELS5_HTML.htm#Section_8.5) [^(SO question)](https://stackoverflow.com/questions/307179/what-is-javascripts-max-int-whats-the-highest-integer-value-a-number-can-go-t)中呈现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T00:54:48.023

您可以按照建议的 Ilia 解决方案进行舍入，或者使用如下子字符串：

```
var date = new Date();
var t = date.getTime().toString();
var p = t.substring(0, 10);

alert(p); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T00:54:31.683

尝试：

```
var t = "" + date.getTime();
var p = t.substring(0,10); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T01:00:02.410

这个怎么样？

```
var date = new Date();
var t = date.getTime();
var p = parseInt(t.toString().match(/\d{10}/));

alert(p); 
```

它将数字转换为字符串，匹配前 10 位数字，然后将结果重新转换为数字。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-05T12:46:53.547

好奇有没有区别

```
var p = parseInt(t/1000); 
```

和

```
var p = Math.floor(t/1000); 
```

我这样做了：

```
 start = new Date().getTime(); for ( var i=0; i<1000000; i++) parseInt(start/1000); new Date().getTime() - start; 
```

和

```
start = new Date().getTime(); for ( var i=0; i<1000000; i++) Math.floor(start/1000); new Date().getTime() - start; 
```

在 Chromium`parseInt`中大约需要 7.2 秒，而`Math.floor`在我的上网本上需要 6.6 秒。

Firefox 抱怨脚本耗时过长。它只能在大约同一时间内完成 200000 次操作。

所以我想这非常依赖于实现。

# ruby-on-rails - Ruby On Rails 基本变量

> ID：10021273
> 
> 赞同：0
> 
> 时间：2012-04-05T00:47:13.177
> 
> 标签：ruby-on-rails, ruby

我正在尝试通过玩东西来学习 Ruby on Rails，并且我正在尝试玩 Grit。但是，我从 PHP 背景中获得了 repo 的东西，我有点困惑。我的代码

```
class RepoController < ApplicationController
  require "grit"
  repo = Grit::Repo.new("blahblahblah")

  def index()
    puts YAML::dump(repo)
  end

  def show()
    repo.commits('master', 10)
    puts repo.inspect
  end
end 
```

我正在尝试转储有关对象的信息，但似乎无法访问 repo 变量。我的 IDE 和 Ruby 一直在说`undefined local variable or method repo'`，我不知道为什么它不能访问 repo 变量，它是在类的顶部声明的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:52:30.180

你有范围问题。尝试：

```
require 'grit'

class RepoController < ApplicationController
  def repo
    @repo ||= Grit::Repo.new("blahblahblah")
  end

  def index()
    puts YAML::dump(repo)
  end

  def show()
    repo.commits('master', 10)
    puts repo.inspect
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:10:13.507

您的 repo 变量被定义在您的索引和显示操作中可见的范围之外。可能你想要的是这样的：

```
class RepoController < ApplicationController

  before_filter :set_repo  

  def index()
    puts YAML::dump(@repo)
  end

  def show()
    @repo.commits('master', 10)
    puts @repo.inspect
  end

  def set_repo
    @repo = Grit::Repo.new("blahblahblah")
  end
end 
```

这会在控制器加载时创建一个实例变量。此外，您将希望从那里获取该 require 语句并将 gem "grit" 放入您的 Gemfile 中。

# c++ - 二叉搜索树问题

> ID：10021283
> 
> 赞同：1
> 
> 时间：2012-04-05T00:49:29.813
> 
> 标签：c++, binary-search-tree

我真的被卡住了，我在“CTree.add(num);”处遇到错误 说“CTree”是未声明的，这没有意义，因为我在 tree.h 中对其进行了初始化？

该程序应该提示用户，用户输入一个命令（即“加 3”，只有 0-9 个整数），然后我希望它将该数字插入树中。

```
//File: tree.h

class CTree
{
private:
    CTree* m_pLeft;
    CTree* m_pRight;
    CTree* m_pRoot;
    int m_nData;

public:

    CTree();

    bool isEmpty() const { return m_pRoot; }
    bool search(int);
    void print_inorder();
    void inorder(CTree*);
    void Add(int);
    void remove(int);
    void height();
};

//File: CTree.cpp

#include <iostream>
#include <cstdlib>

using namespace std;

CTree::CTree()
{
 m_pRoot=NULL;
}

bool CTree::search(int x)
{
    if(x==m_nData) return true;
    if(x < m_nData){ //go left
       if(m_pLeft != NULL) //if possible
            return m_pLeft->search(x);
    }
    else //go right
       if(m_pRight != NULL) //ifpossible
            return m_pRight->search(x);
    return false;
}

void CTree::Add(int x)
{
CTree* t = new CTree;
CTree* parent;
t->m_nData = x;
t->m_pLeft = NULL;
t->m_pRight = NULL;
parent = NULL;

if(isEmpty()) m_pRoot = t;
else
{
     //insert leaf nodes
    CTree* leaf;
    leaf = m_pRoot;
     // find parent
    while(leaf)
    {
        parent = leaf;
        if(t->m_nData > leaf->m_nData)
            leaf = leaf->m_pRight;
        else
            leaf = leaf->m_pLeft;
    }

    if(t->m_nData < parent->m_nData)
       parent->m_pLeft = t;
    else
       parent->m_pRight = t;
}
}

void CTree::remove(int x)
{
bool found = false;
if(isEmpty())
{
    cout<< "Tree is empty!" <<endl;
    return;
}

CTree* current;
CTree* parent;
current = m_pRoot;

while(current != NULL)
{
     if(current->m_nData == x)
     {
        found = true;
        break;
     }
     else
     {
         parent = current;
         if(x > current->m_nData) current = current->m_pRight;
         else current = current->m_pLeft;
     }
}
if(!found)
{
    cout<< "Not found!" <<endl;
    return;
}

// Node with single child
if((current->m_pLeft == NULL && current->m_pRight != NULL)|| (current->m_pLeft != NULL&& current->m_pRight != NULL))
{
   if(current->m_pLeft == NULL && current->m_pRight != NULL)
   {
       if(parent->m_pLeft == current)
       {
         parent->m_pLeft = current->m_pRight;
         delete current;
       }
       else
       {
         parent->m_pRight = current->m_pRight;
         delete current;
       }
   }
   else // left child present, no right child
   {
      if(parent->m_pLeft == current)
       {
         parent->m_pLeft = current->m_pLeft;
         delete current;
       }
       else
       {
         parent->m_pRight = current->m_pLeft;
         delete current;
       }
   }
 return;
}

             //We're looking at a leaf node
             if( current->m_pLeft == NULL && current->m_pRight == NULL)
{
    if(parent->m_pLeft == current) parent->m_pLeft = NULL;
    else parent->m_pRight = NULL;
                             delete current;

//Node with 2 children
// replace node with smallest value in right subtree
if (current->m_pLeft != NULL && current->m_pRight != NULL)
{
    CTree* check;
    check = current->m_pRight;
    if((check->m_pLeft == NULL) && (check->m_pRight == NULL))
    {
        current = check;
        delete check;
        current->m_pRight = NULL;
    }
    else // right child has children
    {
        //if the node's right child has a left child
        // Move all the way down left to locate smallest element

        if((current->m_pRight)->m_pLeft != NULL)
        {
            CTree* lcurrent;
            CTree* lcurrent_parent;
            lcurrent_parent = current->m_pRight;
            lcurrent = (current->m_pRight)->m_pLeft;
            while(lcurrent->m_pLeft != NULL)
            {
               lcurrent_parent = lcurrent;
               lcurrent = lcurrent->m_pLeft;
            }
            current->m_nData = lcurrent->m_nData;
            delete lcurrent;
            lcurrent_parent->m_pLeft = NULL;
       }
       else
       {
           CTree* tmp;
           tmp = current->m_pRight;
           current->m_nData = tmp->m_nData;
           current->m_pRight = tmp->m_pRight;
           delete tmp;
       }

    }
             return;
}
}
}

void CTree::print_inorder()
{
 inorder(m_pRoot);
}

void CTree::inorder(CTree* x)
{
  if(x != NULL)
{
    if(x->m_pLeft) inorder(x->m_pLeft);
    cout<<" "<<x->m_nData<<" ";
    if(x->m_pRight) inorder(x->m_pRight);
}
else return;
}

//File: main.cpp

#include <iostream>
#include <cstdlib>
#include <sstream>
#include <locale>
#include <string>
#define PROMPT "bst> "

using namespace std;

int getNumber(string s)
{
    int num;

for(int i; i<=s.length();i++)
{
        if(isdigit(s[i]))
        {
              num= s[i]-48;
        }
}

return num;
} // getNumber

bool process(const string& s, CTree* aTree)
{
    bool mustquit=false;
    int num;
    istringstream iss(s);

do
{
    string sub;
    iss >> sub; //               
    if(sub=="add" || sub=="insert")
    {
        num=getNumber(s);
        cout<<num<<endl;
        aTree->Add(num);
    }
    else if(sub=="delete" || sub=="remove")
    {
        num=getNumber(s);
        cout<<num<<endl;
    }
    else if(sub=="search" || sub=="find")
    {
         num=getNumber(s);
         cout<<num<<endl;
    }
    else if(sub=="height")
    {
         //do stuff
    }
    else if (sub=="quit") 
        return mustquit;
    //else cout<<"INPUT ERROR"<<endl;    
 }  while (iss);     

 return mustquit;
 }// process

int main(){ 

string input="";
CTree *myTree;
myTree = new CTree();

bool finished=false;
int i;

    cout<<PROMPT;
    while(!finished)
    {
            if(input!="")cout<<PROMPT;
            getline(cin,input);
            finished=process(input, myTree);
            delete myTree;
    }//while

return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T00:52:36.387

`add`**是一个非静态成员函数，这意味着**您只能在`CTree`. 例如

```
CTree myTree;
myTree.add(num); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:14:18.727

你知道你需要一个类的**实例**`CTree`来实际使用它吗？您在假设您正在对类的实例进行操作的情况下编写了整个内容。一棵实际的树，而不是它的*蓝图*。

正如我之前的答案所说，它不是静态函数或类级别。需要在实例上调用非静态方法，以便可以将静默指针`this`设置为有意义的东西，即。您正在使用的实际实例 - 在这种情况下添加一个节点。

**附录**

*（下面的所有内容都可以在不修改您的代码的情况下工作，只是对您的问题的明确回答，以使其编译。从“工作的角度”来看，该程序远未完成。有些部分甚至没有意义，许多变量未使用或未初始化（然后使用）。让我在下面进一步详细说明。）*

你需要做的就是在你的 main 中添加旧的 process() 调用：

```
CTree myTree; // you could also add (), even though it's a default constructor
finished=process(input, myTree); 
```

并修改函数进程的参数列表以包含对您希望操作的树的引用。这只是其中一种可能性，您也可以使用指针等。但是引用更清晰：

```
bool process(const string& s, CTree& aTree) 
```

另外，请注意编译器警告。好的做法是照顾好所有人。请记住，这使它编译，而不是工作。它似乎未完成且边缘粗糙。

并记住类（一个想法）和一个实例（该想法的体现）之间的区别。技术细节现在并不重要，只要确保你有一个可以使用的实例，就像你的类设计想要的那样。在我看来，您似乎不了解计算机软件的工作原理，在其上运行的数据和指令如何连接，尤其是从内存的角度来看。计算机只知道你想做什么是不够的，它需要知道你想要执行什么操作（哪些变量或对象或你有什么）。您可以按值复制并返回，在主函数中执行此操作，传递带有地址的引用或指针，以便它可以知道您的对象/实例在内存中的位置等。如果您只是在试验，您可以创建一个全局实例。很多选择。

重新声明所有内容不会延续之前发生的更改（因为内容超出了范围）。在类级别调用非静态成员方法也没有意义——甚至不正确。

*希望它有所帮助并快乐编码。坚持下去，没有什么值得做的事情是简单的。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T03:14:19.443

我认为他们对你的经验水平来说有点太技术化了。YourCTree 类代码创建 CTree 类是什么以及它的行为方式（蓝图），但实际上您必须告诉您的代码构造一个，然后有一种方法来引用它。

您可以像这样声明堆栈变量实例：

```
CTree myTree; 
```

这会为您的类分配内存并在进入函数时调用构造函数。然后，您可以通过使用点表示法从实例名称中引用函数来使用它。

```
myTree.Add(4); 
```

或者您可以声明一个指向 CTree 的指针并使用 new 运算符创建一个动态实例

```
CTree *myTree;

myTree = new CTree(); 
```

然后使用指针表示法引用树：

```
myTree->Add(4); 
```

如果你这样做，你将需要删除你分配的内存

```
delete myTree; 
```

因此，总而言之，您在此处显示的类定义描述了一个类，但不会创建一个类（分配内存并设置指向方法代码的指针）。如果您的代码逻辑需要它们，这允许您拥有许多树；

```
CTree directoryTree;
CTree fileTree;
CTree indexTree; 
```

这些每个都有自己的数据......

祝你好运，

# ruby-on-rails - Rails：Rails 3.2 中的嵌套命名空间控制器无法加载（在 3.0 中很好）

> ID：10021288
> 
> 赞同：2
> 
> 时间：2012-04-05T00:49:59.490
> 
> 标签：ruby-on-rails, rspec

我有一个名为 Reports::Accountant::ApprovedTimeOffRequestsController 的控制器。它位于正确的目录中，并且文件自身中的类名是正确的。Rails 控制台和独角兽加载得很好，但 rspec 在测试期间似乎无法加载文件。

这是错误。

`/Users/mdarby/.rvm/gems/ruby-1.9.3-p125-perf/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:503:in load_missing_constant': Expected /Users/mdarby/Documents/Code/ccw_32/app/controllers/reports/accountant/approved_time_off_requests_controller.rb to define Reports::Accountant::ApprovedTimeOffRequestsController (LoadError) from /Users/mdarby/.rvm/gems/ruby-1.9.3-p125-perf/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:192:in block in const_missing'`

这个文件是在 Rails 3.0 堆栈上找到的，但现在我已经升级到 3.2/rspec 2.9，这已经被炸毁了。

类的定义： `class Reports::Accountant::ApprovedTimeOffRequestsController < ApplicationController`

**编辑：**

如果有人遇到这个问题，我通过删除规范来解决它:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T16:48:33.527

你的测试有什么花哨的吗？我在应用程序本身有一个案例，其中多个线程试图加载同一个模块。我只能猜测在实际运行之前将其标记为已加载，然后该常量不可用于下一个。无论如何，我的解决方案是在线程之外添加一个准备块。

development.rb（你可能在 test.rb 中需要这个）

```
ActionDispatch::Reloader.to_prepare do
  Reports::Accountant::ApprovedTimeOffRequestsController
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T09:26:52.273

我打赌你正在使用Spork。我遇到了这个确切的问题。我删除了 Spork，我正在路上。给它一个重击，让我知道它是否修复了它。如果是这样的话，可能值得在 spork 上提出问题。

# php - 为什么 setcookie 在实时网站中不起作用，但在 localhost 中起作用？

> ID：10021296
> 
> 赞同：0
> 
> 时间：2012-04-05T00:51:24.797
> 
> 标签：php, codeigniter, setcookie

我有一个验证码脚本

[验证码链接](http://www.arcticpost.net/ap/user/create_captcha/ "验证码网址")

它使用以下代码：

```
include 'kcaptcha/kcaptcha.php';
$path = "/";
//this line will produce captcha image
$captcha = new KCAPTCHA();
//writing the cookie so that we can check on next page

//captcha value save as md5 encryption so that when validating is should make md5 mask to captcha form input
setcookie("captcha", md5($captcha->getKeyString()), time()+1000, $path); 
```

此代码适用于本地主机，但不适用于我的实时网站。怎么了？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T13:43:52.113

在 config/config.php 的 $config['cookie_domain'] 中输入的域是否正确？

# android - Android：阿拉伯语 XML 解析？

> ID：10021297
> 
> 赞同：1
> 
> 时间：2012-04-05T00:51:26.417
> 
> 标签：android, xml, encoding

我有一些类似于以下示例的 XML：

```
<?xml version="1.0" encoding="....."?> 
<music> 
  <song>
     <id>1</id>
     <title>العقائد </title>
     <duration>عدد الكتب: 10</duration>   
  </song>
</music> 
```

当我运行我的应用程序时，它会向我显示奇怪的字符。我想知道如何解析阿拉伯字符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-28T22:09:41.927

Android 无法处理基本的 unicode 字符 0x6--。如果要正确显示阿拉伯字符，则需要使用阿拉伯表示 B 字符 0xFE--。这些角色不会自动连接在一起——你必须自己做。

您还需要使用支持这些字符的字体。有一个很好的**Deja Vu**字体，或者你可以使用“ **AGA Rasheeq Bold** ” - 并将它放入你的资产中，然后像这样加载它

```
Typeface tfArabic = Typeface.createFromAsset (getAssets (), "AGA-Rasheeq-Bold.ttf"); 
```

然后使用这样的东西来使用字体：

```
textview.setTypeface (tfArabic); 
```

# javascript - jQuery 可切换选项卡内的 Javascript 图表

> ID：10021298
> 
> 赞同：1
> 
> 时间：2012-04-05T00:51:48.620
> 
> 标签：javascript, jquery, jquery-plugins, tabs

我正在尝试在 jQuery 可切换选项卡内显示一个 javascript 图表（使用 Ruby on Rails 和 bootstrap-tab.js）。如果图表位于选项卡外部，则图表显示正常，但不显示在选项卡内部。我确定我忽略了一件非常简单的事情，但我一直在努力解决这个问题。

我的查看代码：

```
 <ul class="nav nav-tabs">
 <li class="active"><a href="#home" data-toggle="tab">Home</a></li>
 <li><a href="#graph" data-toggle="tab">Graph</a></li>
 </ul>

 <div class="tab-content">
 <div class="tab-pane active" id="home">...</div>
 <div class="tab-pane" id="graph">
 <div id="chartdiv" style="width: 100%; height: 400px;"></div>
 </div> 
```

Javascript代码：

我试过这个：

```
 <script type="text/javascript">
 $(function() {
 $ ('a#graph').click(function(){

        var chart;

        var chartData = [{
            country: "USA",
            visits: 4025
        }, {
            country: "Poland",
            visits: 328
        }];

        AmCharts.ready(function () {
            // SERIAL CHART
            chart = new AmCharts.AmSerialChart();
            chart.dataProvider = chartData;
            chart.categoryField = "country";
            chart.startDuration = 1;

            // AXES
            // category
            var categoryAxis = chart.categoryAxis;
            categoryAxis.labelRotation = 90;
            categoryAxis.gridPosition = "start";

            // GRAPH
            var graph = new AmCharts.AmGraph();
            graph.valueField = "visits";
            graph.balloonText = "[[category]]: [[value]]";
            graph.type = "column";
            graph.lineAlpha = 0;
            graph.fillAlphas = 0.8;
            chart.addGraph(graph);

            chart.write("chartdiv");
           });
         });
       });
    </script> 
```

还有这个：

```
 <script type="text/javascript">

        var chart;

        var chartData = [{
            country: "USA",
            visits: 4025
        }, {
            country: "Poland",
            visits: 328
        }];

        AmCharts.ready(function () {
            // SERIAL CHART
            chart = new AmCharts.AmSerialChart();
            chart.dataProvider = chartData;
            chart.categoryField = "country";
            chart.startDuration = 1;

            // AXES
            // category
            var categoryAxis = chart.categoryAxis;
            categoryAxis.labelRotation = 90;
            categoryAxis.gridPosition = "start";

            // GRAPH
            var graph = new AmCharts.AmGraph();
            graph.valueField = "visits";
            graph.balloonText = "[[category]]: [[value]]";
            graph.type = "column";
            graph.lineAlpha = 0;
            graph.fillAlphas = 0.8;
            chart.addGraph(graph);

            chart.write("chartdiv");
           });
         });
       });
    </script> 
```

任何帮助或指示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:42:01.757

此博客文章详细介绍了如何在选项卡或其他动态页面元素中显示图表：http: [//www.amcharts.com/tutorials/displaying-charts-in-tabs-or-other-dynamic-page-elements/](http://www.amcharts.com/tutorials/displaying-charts-in-tabs-or-other-dynamic-page-elements/)

# c# - Response.Write 到标签

> ID：10021301
> 
> 赞同：1
> 
> 时间：2012-04-05T00:52:06.480
> 
> 标签：c#, asp.net

我在表单上有以下代码，以便用户提交表单并发送和发送电子邮件。我有两个 response.write 语句，我想更改这些语句，以便将它们写入标签 (lblSubmit)。任何帮助，将不胜感激。

```
<script runat="server">

    protected void Page_Load(object sender, EventArgs e)
    {

        if (IsPostBack)
        {

            SmtpClient sc = new SmtpClient("smtp.talktalk.net");
            StringBuilder sb = new StringBuilder();
            MailMessage msg = null;

            sb.Append("Email from: " + txtEmail.Text + "\n");
            sb.Append("Message   : " + txtQuestion.Text + "\n");

            try
            {
                msg = new MailMessage(txtEmail.Text,
                    "myemail@talktalk.net", "Message from Web Site",
                    sb.ToString());

                sc.Send(msg);

                Response.Write("Message sent!");

            }
            catch (Exception ex)
            {

                // something bad happened
                Response.Write("Something bad happened!");

            }
            finally
            {

                if (msg != null)
                {
                    msg.Dispose();
                }

            }

        }

    }

</script>
<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
</asp:Content>
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">

<div id="title"><p>Contact Us...</p></div>

<div id="titletext"><p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.</p></div>

<div id="contactform">

    <asp:Label ID="lblName" runat="server" Text="Name:"></asp:Label>
    &nbsp;
    <asp:TextBox ID="txtName" runat="server" Width="189px"></asp:TextBox>
    <br />
    <asp:RequiredFieldValidator ID="RequiredFieldValidator3" runat="server" 
        ControlToValidate="txtName" ErrorMessage="Please enter your name" 
        ForeColor="Red" Display="Dynamic"></asp:RequiredFieldValidator>
    <br /><br />
    <asp:Label ID="lblEmail" runat="server" Text="Email:"></asp:Label>
    &nbsp;
    <asp:TextBox ID="txtEmail" runat="server" Width="189px"></asp:TextBox>
    <br />
    <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" 
        ControlToValidate="txtEmail" Display="Dynamic" ErrorMessage="Please enter an email address" 
        ForeColor="Red"></asp:RequiredFieldValidator>
    <asp:RegularExpressionValidator ID="RegularExpressionValidator1" runat="server" 
        ControlToValidate="txtEmail" ErrorMessage="Please enter a valid Email address" 
        ForeColor="Red" 
        ValidationExpression="\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*" 
        Display="Dynamic"></asp:RegularExpressionValidator>
    <br />
    <br />

    <asp:Label ID="lblPhone" runat="server" Text="Phone:"></asp:Label>
    &nbsp;
    <asp:TextBox ID="txtPhone" runat="server" Width="189px"></asp:TextBox>
    <br />
    <asp:RequiredFieldValidator ID="RequiredFieldValidator4" runat="server" 
        ControlToValidate="txtPhone" 
        ErrorMessage="Please enter a contact telephone number" ForeColor="Red" 
        Display="Dynamic"></asp:RequiredFieldValidator>

    <br />

    <asp:Label ID="lblQuestion" runat="server" Text="Question:"></asp:Label>
    <asp:TextBox ID="txtQuestion" runat="server" Height="103px" TextMode="MultiLine" 
        Width="189px"></asp:TextBox>
    <br />
    <asp:RequiredFieldValidator ID="RequiredFieldValidator2" runat="server" 
        ControlToValidate="txtQuestion" ErrorMessage="Please enter a message" 
        ForeColor="Red"></asp:RequiredFieldValidator>

    <asp:Label ID="lblSubmit" runat="server"></asp:Label>

<asp:Button ID="cmdSubmit" runat="server" Text="Submit" CssClass="cmdSubmit" 
        onclick="cmdSubmit_Click" PostBackUrl="~/Contact Us.aspx" />

</div>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T00:54:17.357

要设置`Label`控件的文本，您只需在其`.Text`属性中设置一个值。所以代替这个：

```
Response.Write("some string"); 
```

你会有这个：

```
lblSomeLabel.Text = "some string"; 
```

这是*非常受欢迎*的，`Response.Write`因为标签控件允许您将页面上的位置指定为占位符。 `Response.Write`只是盲目地将字符串写入响应，可能将其附加在 HTML 的其余部分之后或中间的某个未定义的位置。

请注意，`Label`控件将文本包装在`span`元素中。如果您想输出您拥有完整标记控制的原始数据，请考虑使用`Literal`控件。

在旁注中，对您的代码的几句话建议......

查看C# 中[的`using`语句](http://msdn.microsoft.com/en-us/library/yh598w02%28v=vs.100%29.aspx)。它以更优雅的方式处理`try/finally`任何实现`IDisposable`（您需要调用的任何东西）的构造。`.Dispose()`从本质上讲，它节省了您自己编写处理代码的需要，并且通常会产生更清洁和更安全的代码。

在您的`catch`声明中，您目前*完全忽略*了您实际捕获的异常。这是故意的吗？或者正在使用此代码修复您计划的这一部分？作为一般规则，*永远不要*丢弃异常数据。它包含实际发生的错误消息*（*而不是“发生了不好的事情”）以及*发生*的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:34:06.760

Better to use labelname.text="yourtext";

Or the text property value of the label as mentioned above.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:59:15.563

如果你有一个 ASP.NET 标签控件，你可以设置它的 Text 属性值。

```
<asp:Label ID="lblSubmit" runat="server" Text="Label"></asp:Label> 
```

在代码中，

```
lblSomeLabel.Text = "Email Sent"; 
```

您甚至可以使用带有 runat="server" 属性的 Div 控件并从您的代码中设置它的内部 html

```
<div id="divMessage" runat="server" /> 
```

在代码中，

```
 divMessage.innerHTML="Email Sent!"; 
```

# html - 如何在不影响带有 html/css 的子元素的情况下应用不透明度？

> ID：10021302
> 
> 赞同：58
> 
> 时间：2012-04-05T00:52:20.113
> 
> 标签：html, css, opacity

我想使用 html 和 css 来实现这一点：

![图式](../Images/b54a24957f98d850c8cce8e9e25f71fe.png)

我试图将容器的不透明度设置为 0.3，将盒子设置为 1，但它不起作用：两个 div 的不透明度都为 0.3。

[我在这里尝试的 jsFiddle](http://jsfiddle.net/yT6nG/)

我想要达到的效果是出现在页面顶部的弹出框。它通过淡化下面的内容（通过降低不透明度）来突出显示。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-04-05T05:04:42.930

您可以将不透明度与背景颜色结合使用，如下所示：

```
#container {
    border: solid gold 1px;   
    width: 400px;
    height: 200px;
    background:rgba(56,255,255,0.1);
}

#box {
    border: solid silver 1px;
    margin: 10px;
    width: 300px;
    height: 100px;
    background:rgba(205,206,255,0.1);
}
```

```
<div id="container">
    containter text
    <div id="box">
        box text
    </div>
</div>
```

[现场演示](http://jsfiddle.net/rohitazad/yT6nG/29/)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-05T00:59:12.467

据我所知，你不能以简单的方式做到这一点。这里有几个选项：

1.  使用绝对定位将框定位在容器“内部”。

    ```
    #container {
        opacity: 0.3;
        background-color: #777788;
        position: absolute;
        top: 100px;
        left: 100px;
        height: 150px;
        width: 300px;
    }
    #box {
        opacity: 1;
        background-color: #ffffff;
        position: absolute;
        top: 110px;
        left: 110px;
        height: 130px;
        width: 270px;
    }
    ```

    ```
    <div id="container"></div>
    <div id="box">
        <p>Something in here</p>
    </div>
    ```

2.  使用 Javascript - 与上面几乎相同，但不必对位置和大小进行硬编码。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-01-12T15:55:19.137

尝试使用 rgba 作为图像的“预内容”叠加层，这是一种保持响应且不会影响其他元素的好方法。

```
header #inner_header_post_thumb {
  background-position: center;
  background-size: cover;
  position: relative;
  background-image: url(https://images.pexels.com/photos/730480/pexels-photo-730480.jpeg?w=1260&h=750&auto=compress&cs=tinysrgb);
  border-bottom: 4px solid #222;
}

header #inner_header_post_thumb .dark_overlay {
  position: relative;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.75);
}

header #inner_header_post_thumb .dark_overlay .container .header-txt {
  padding-top: 220px;
  padding-bottom: 220px;
  color: #ffffff;
  text-align:center;
}

header #inner_header_post_thumb .dark_overlay .container .header-txt h1 {
  font-size: 40px;
  color: #ffffff;
}

header #inner_header_post_thumb .dark_overlay .container .header-txt h3 {
  font-size: 24px;
  color: #ffffff;
  font-weight: 300;
}

header #inner_header_post_thumb .dark_overlay .container .header-txt p {
  font-size: 18px;
  font-weight: 300;
}

header #inner_header_post_thumb .dark_overlay .container .header-txt p strong {
  font-weight: 700;
}
```

```
<header>
  <div id="inner_header_post_thumb">
    <div class="dark_overlay">
      <div class="container">
        <div class="row header-txt">
          <div class="col-xs-12 col-sm-12">
            <h1>Title On Dark A Underlay</h1>
            <h3>Have a dark background image overlay without affecting other elements</h3>
            <p>No longer any need to re-save backgrounds as .png ... <strong>Awesome</strong></p>

          </div>
        </div>
      </div>
    </div>
  </div>
</header>
```

[在此处查看工作代码笔](https://codepen.io/jbennett45/pen/MrXwow)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-05-09T07:33:15.813

使用`background-color: rgba(#777788, 0.3);`而不是不透明度可能会解决问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-07-27T09:55:37.160

你不能在不影响子元素的情况下应用 opacity 属性！

*“不透明度适用于整个元素，包括其内容，即使该值不被子元素继承。因此，**元素及其子元素相对于元素的背景都具有相同的不透明度**，即使它们具有不同的不透明度相对彼此...**如果您不想对子元素应用不透明度，请改用背景属性**。”* [https://developer.mozilla.org/en-US/docs/Web/CSS/opacity](https://developer.mozilla.org/en-US/docs/Web/CSS/opacity)

如果您希望不透明度仅应用于背景，而不影响子元素，请使用：

```
background-color: rgba(255, 255, 255, .3)
```

但是，如果将它们放在 div 父元素中并使用 CSS 位置属性，则可以达到预期的效果：

```
.parent {
  border: solid green 3px;
  position: relative;
  width: 400px;
  height: 200px;
}

.sibling-one {
  border: solid red 3px;
  position: absolute;
  box-sizing: border-box;
  width: 400px;
  height: 200px;
  opacity: .3;
 }

.sibling-two {
    border: solid blue 1px;
    margin: 10px;
    width: 200px;
    height: 100px;
    position: absolute;
    transform: translateY(50%);
} 
```

```
<div class="parent">
  <div class="sibling-one">
  <p>A sibling's one element</p>
</div>
<div class="sibling-two">
    <p>A sibling's two element</p>
</div>
</div>
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-05T01:04:56.077

应用此 CSS 规则

```
.alpha60 { 

/* Fallback for web browsers that doesn't support RGBa */ 

background: rgb(0, 0, 0); 

/* RGBa with 0.6 opacity */ 

background: rgba(0, 0, 0, 0.6); 

/* For IE 5.5 - 7*/ 

filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000,      endColorstr=#99000000); 

/* For IE 8*/ 

-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000,     endColorstr=#99000000)"; 
} 
```

除此之外，您必须声明背景：对于 IE 网络浏览器透明。

欲了解更多详情，请访问以下链接：

[http://robertnyman.com/2010/01/11/css-background-transparency-without-affecting-child-elements-through-rgba-and-filters/](http://robertnyman.com/2010/01/11/css-background-transparency-without-affecting-child-elements-through-rgba-and-filters/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-05T00:58:41.073

设置了不透明度的元素的任何子元素都将采用该不透明度。

要实现这种风格，您可以使用 IE 的 rgba 颜色和过滤器作为背景，并在文本元素上使用不透明度。只要第二个框不是其中一个文本元素的子元素，它就不会继承不透明度。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-03-29T13:45:20.660

另一种解决方法是简单地使用叠加背景来创建类似的效果。

我个人喜欢不透明度约为 65% 的黑色覆盖层，但对于您想要做的事情，您可能希望使用大约 70% 的白色覆盖层。

在 Photoshop 或 GIMP 中创建一个小的（100 x 100 或更小）PNG，它具有您想要的颜色和不透明度。然后只需将其设置为灯箱的背景。

如果您以不同的不透明度创建多个 PNG，您可以使用 JS 轻松地在它们之间切换，或者通过后端脚本在加载时动态切换。

从技术上讲，这不是您想要做的，但从美学上讲，它可以产生非常相似的效果，而 UX 明智的做法是完成同样的事情。它也很容易做到，并且几乎所有东西都得到广泛支持。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-03-07T01:47:36.583

不透明度将始终由子元素继承，无论其中的元素是什么，到目前为止还没有建议的解决方法，当将子元素移动到透明背景之外不是弹出菜单/对话框创建中的选项时，解决方案是使用带有 rgba 的背景。

这是我创建的一个输入框，我可以使用 javascript 不可见的类属性打开或关闭它

```
<div id="blackout" class="invisible">
    <div id="middlebox">
        <p>Enter the field name: </p>
        <input type="text" id="fieldvalue" />
        <input type="button" value="OK" id="addfname" />
    </div>
</div> 
```

CSS

```
#blackout {
    z-index: 9999;
    background: rgba(200, 200, 200, 0.6); 
    height: 100%;
    width: 100%;
    display: block;
    padding: 0px;
    clear: both;
    float: left;
    position: absolute;
    margin-top: -10px;
    margin-right: 0px;
    margin-bottom: 0px;
    margin-left: -10px;
}

#blackout #middlebox {
    border: thick solid #333;
    margin: 0px;
    height: 150px;
    width: 300px;
    background-color: #FFF;
    top: 50%;
    left: 50%;
    position: absolute;
    -ms-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
    padding: 10px 50px 0px 50px;

}

#middlebox p {
    float: left;
    width:100%;
    clear:both;
}

#middlebox input {
    clear:both;
    margin-bottom:10px;
}

#middlebox input[type=text]{
    width:100%;
}

#middlebox input[type=button]{
    float:right;
    width:30%;
}

.invisible{
    visibility:hidden !important;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-07-27T08:04:47.410

使用可以添加**:before 或 :after 的元素。**我的解决方案

```
<div class="container">
    <div>
         Inside of container element is not effected by opacity. 
    </div>
</div> 
```

**CSS。**

```
.container{
    position: relative;
}

.container::before{
    content: '';
    height: 100%;
    width: 100%;
    position: absolute;
    background-color: #000000;
    opacity: .25
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-05-06T19:31:16.790

这可能不是最正统的方法，但您可以为每个重复的 div / 容器使用一个小的半透明背景图像。似乎在这个时代，你应该能够在没有 js 的纯（简单而不是 hackish）css 中实现这一点，但正如上面的答案所示，这并不是那么简单......

使用平铺图像可能看起来过时了，但在所有浏览器中都可以放心使用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-08-16T10:00:27.207

您可以添加一个绝对位于容器后面的容器同级，大小相同，并对其应用不透明度。

并且在您的容器上不使用背景。

现在容器的孩子没有不透明的父母，问题就消失了。

# python - 我在哪里可以获得 python 脚本的 pymssql

> ID：10021304
> 
> 赞同：1
> 
> 时间：2012-04-05T00:52:30.003
> 
> 标签：python, macos

我正在尝试使用以下命令运行 python 脚本：-

python scriptname.py“一些选项”

当我这样做时，它会抛出一个错误说

```
Traceback (most recent call last):
  File "scriptname.py", line 7, in <module>
    import pymssql
ImportError: No module named pymssql 
```

我在 Mac 上。有人可以告诉我如何获得这个包吗？我需要把它放在哪里？

这是 pip 显示的错误：-

```
> Downloading pymssql-2.0.0b1-dev-20111019.tar.gz (5.0Mb): 5.0Mb
> downloaded  Running setup.py egg_info for package pymssql    Traceback
> (most recent call last):
>      File "<string>", line 14, in <module>
>      File "/private/tmp/my_new_env/build/pymssql/setup.py", line 41, in <module>
>        from Cython.Distutils import build_ext as _build_ext    ImportError: No module named Cython.Distutils    Complete output from
> command python setup.py egg_info:    Traceback (most recent call
> last):
> 
>  File "<string>", line 14, in <module>
> 
>  File "/private/tmp/my_new_env/build/pymssql/setup.py", line 41, in
> <module>
> 
>    from Cython.Distutils import build_ext as _build_ext
> 
> ImportError: No module named Cython.Distutils 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:58:05.590

[http://code.google.com/p/pymssql/](http://code.google.com/p/pymssql/)

安装它的最简单方法可能是通过[`pip`](http://pypi.python.org/pypi/pip)（或更旧的`easy_install`）。

# macos - 在 Mac OS X 应用程序上定位 Core Data 的 sqlite 数据库

> ID：10021310
> 
> 赞同：6
> 
> 时间：2012-04-05T00:54:09.117
> 
> 标签：macos, core-data

我在哪里可以找到 Core Data 的 Mac OS X 应用程序的 sqlite 数据库？

我找到了它，但它是带有 3 个文件（VersionInfo.plist、*.mom *.omo）的 *.momd 文件夹。我怎样才能看到它的内容？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T22:53:44.713

在 OS X 10.7 Lion 上，当应用程序被沙盒化时，它存储在：

```
~/Library/Containers/com.yourcompany.yourAppName/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T02:42:58.693

Core Data 中的持久化存储只是一个文件。因此，如果它是用户的文档，它很可能在您的 Documents 目录中。如果它是一个内部商店，那么它可能在捆绑包中，或者可能放在像 ~/Library/Application Support 这样的地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-08T06:32:55.077

在 High Sierra 中，SQLite 文件保存在**~/Library/Application Support/[YourAppName]**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-18T09:29:54.517

我注意到它被存储在 `/Users/<username>/Library/Containers/<appbundleid>/Data/Library/Application%20Support/<AppName>/<DataModel>.sqlite`

所以在我的情况下，以下是测试应用程序的路径 `/Users/kaunteya.s/Library/Containers/com.kaunteya.T1/Data/Library/Application%20Support/T1/T2.sqlite`

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-04-05T22:21:22.287

您可以在下面找到 sqlite 文件`~/Library/Application Support/iPhone Simulator/[SDK version]/Applications/[App GUID]/Documents`

要检查数据库文件的内容，您可以使用这个 firefox 扩展：[Sqlite-manager](https://addons.mozilla.org/de/firefox/addon/sqlite-manager/)

# scope - 使用地图在规则之间共享数据

> ID：10021313
> 
> 赞同：0
> 
> 时间：2012-04-05T00:54:21.763
> 
> 标签：scope, drools, fact

这应该很简单，但我还是迷路了。这里有一个非常相似的帖子：[How to share data between Drools rules in a map？](https://stackoverflow.com/questions/8353997/how-to-share-data-between-drools-rules-in-a-map) 但它不能解决我的问题：

我有一套规则，在启动它们之前，我插入一个 Map<String, Object> 作为事实。在这些规则中，我使用地图来写一些结论，例如：

```
when
   $map : Map();
   something ocurrs;
then
   $map.put("conclusion1", 100); 
```

现在我想在其他规则中使用这些中间结论，例如：

```
when
   $map : Map(this["conclusion1"] > 50)
then
   do something cool; 
```

问题是当我执行规则时，就像第二个规则看不到第一个规则的结论，并且它不会触发。我尝试设置一个断点并分析工作内存，事实上，在触发第一条规则后，Map 将包含结论 1, 100。我还尝试在结论中进行更新（$map），但这会触发无限循环。

知道为什么这不起作用，或者我的问题有任何替代解决方案吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:03:47.290

当您修改事实时，您需要通知引擎您正在这样做。其中一种方法是使用 modify()。例如：

```
when
   $map : Map();
   something ocurrs;
then
   modify( $map ) { 
      put("conclusion1", 100)
   }
end 
```

# slider - 动画完成后如何更新 jQuery Cycle 寻呼机？

> ID：10021317
> 
> 赞同：0
> 
> 时间：2012-04-05T00:55:15.967
> 
> 标签：slider, jquery-cycle, pager

我正在使用 jQuery Cycle 插件，我想更改寻呼机的更新。是否可以在单击后而不是在更改幻灯片后更新寻呼机？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T01:37:30.700

您可以更改一个事件以更新活动的寻呼机元素。

请参阅插件站点的文档：http: [//jquery.malsup.com/cycle/pager7.html](http://jquery.malsup.com/cycle/pager7.html)

工作 JsFiddle 示例：

[http://jsfiddle.net/KWUqj/2/](http://jsfiddle.net/KWUqj/2/)

# ruby-on-rails - 在创建用户之前验证测试代码的存在

> ID：10021320
> 
> 赞同：1
> 
> 时间：2012-04-05T00:55:55.817
> 
> 标签：ruby-on-rails, validation, before-save

型号：**用户**

```
has_one :beta_invite

before_save :beta_code_must_exist

def beta_code_must_exist
    if beta_invite_id == beta_invite.find_by_name(beta_invite.id)
      user
    else
      nil
    end
end 
```

型号：**BetaInvite**

```
has_many :users 
```

我要做的是在允许保存用户之前检查数据库中是否存在测试版邀请。

由于用户将 BetaInvite 名称传递到该字段中，我想检查它是否与数据库中的任何现有代码匹配。

希望我没有把事情搞混太多。

感谢您对这个问题的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:09:47.480

1.  在 :beta_code 的表单中添加一个文本字段

2.  为该字段添加 attr_accessor： attr_accessor :beta_code

3.  然后将以下行添加到模型中（假设您只想对用户创建进行此检查）：

    `validate :beta_code_must_exist, :on => :create`

4.  更改`beta_code_must_exist`以向表单添加错误。还要确保正确地将 :beta_code 转换为正确的类型。

    **警告以下未经测试的代码**

    ```
    def beta_code_must_exist
      @invite = BetaInvite.find_by_name(beta_code)
      if @invite.empty?
        errors.add(:beta_code, "is not a valid invite code")
      else
        beta_invite_id = @invite.id
      end
    end 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:40:56.317

`:inclusion`与`:in`选项一起使用。您可以提供`:in`任何可枚举的：

```
validates :beta_invite, :inclusion => { :in => BetaInvite.all,
:message => "%{value} is not a valid beta invite code" } 
```

资料来源：[Rails 活动记录验证](http://guides.rubyonrails.org/active_record_validations_callbacks.html#inclusion)

# html - 仅使用 css 将元素移动到容器顶部

> ID：10021323
> 
> 赞同：0
> 
> 时间：2012-04-05T00:56:36.183
> 
> 标签：html, css

我正在使用[happy.js](http://happyjs.com/)进行表单验证。发生错误时，将在未通过验证的表单元素之前直接放置一个带有“unhappyMessage”类的跨度。html 最终看起来像这样：

```
<form id="myForm">
  <label for="text1">Label 1</label><br />
  <span id="text1_unhappy" class="unhappyMessage">Error message</span>
  <input id="text1" type="text" />
  <br />
  <label for="text2">Label 2</label><br />
  <span id="text2_unhappy" class="unhappyMessage">Error message</span>
  <input id="text2" type="text" />
</form> 
```

在`<span>`发生错误之前， s 不会出现。我想使用 css 以某种方式将错误消息过滤到父级的顶部，*就好像*它是这样编码的：

```
<form id="myForm">
  <span id="text1_unhappy" class="unhappyMessage">Error message</span><br />
  <span id="text2_unhappy" class="unhappyMessage">Error message</span><br />
  <label for="text1">Label 1</label><br />
  <input id="text1" type="text" />
  <br />
  <label for="text2">Label 2</label><br />
  <input id="text2" type="text" />
</form> 
```

请注意，我想让每个都`.unhappyMessage`出现在自己的行上。有没有一种仅限 CSS 的方法来做到这一点？

*注意：对于那些想知道的人，我只想使用 css，因为我必须做一些逆向工程才能使用 javascript，因为似乎我通过 happy.js 提供的唯一事件不是唯一一次创建错误消息。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:05:13.853

Css 不会为您提供解决方案。如果您无法轻松访问事件委托，请寻找另一个表单验证器。或者查看代码，看看你是否能找到解决办法。

编辑：
查看happy.js 页面，它提供了一个回调函数供您指定是否愿意。

> unHappy（函数）：尝试提交表单但任何字段验证失败时触发的回调。

因此，传递一个预先设置所有错误消息的函数。

# linux - 是否可以对通过管道传输的输出进行着色？

> ID：10021325
> 
> 赞同：10
> 
> 时间：2012-04-05T00:56:54.633
> 
> 标签：linux, bash, unix, pipe

我将*ls*和*grep*别名为*'ls --color=auto'*和*'grep --color=auto'*用于彩色输出，但是当我通过管道传输更多颜色时，颜色会丢失。

似乎没有*更多*或*更少的参数来为他们的输出着色。*有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-05T00:59:25.423

问题不在于`more`并且`less`没有对它们的输出进行着色，`ls`而是没有输出颜色，因为它连接到另一个进程而不是终端。

当它输出颜色时，你不能轻易地变得`ls`更聪明，但你可以添加`--color`以强制它在管道输出颜色时输出颜色`more`

当您有颜色输出时，用于`... |less -R`将`less`颜色传递到终端，而不是将转义码显示为文本

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T00:59:33.310

```
ls --color | less -r 
```

在 Linux、GNU 用户空间上测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-01T12:27:00.893

在 macOS 10.15 Catalina (darwin 19.0.0) 上，您可以将`ls`管道的输出着色为`head`, `grep`,`less`并对`more`zsh 配置进行以下调整：

**~/.zshrc**

```
alias less="less -R"
alias more="more -R" 
```

**~/.zshenv**

```
export GREP_COLOR=always
export CLICOLOR_FORCE=true 
```

运行`open x-man-page://command`以打开该命令的手册页`command`。

# android - 应用程序 -> 相机 -> 照片 -> 低分辨率

> ID：10021353
> 
> 赞同：3
> 
> 时间：2012-04-05T01:01:00.137
> 
> 标签：android, camera, resolution

问题：

当我使用我的应用程序拍摄照片并将其存储在 SD 上时，分辨率为 160x120。如果使用普通相机，照片的分辨率为 1920x2560。

所以，请帮我说我必须做些什么来强制相机，从应用程序开始，以标准高分辨率拍照？

这是我用于启动相机意图和保存照片的代码：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE); 
    startActivityForResult(cameraIntent, CAMERA_REQUEST); 
}
public void onActivityResult(int requestCode, int resultCode, Intent data) {  
    if (requestCode == CAMERA_REQUEST) { 

    Bundle xz = data.getExtras();
    if (xz!=null) {

    Bitmap image = (Bitmap) data.getExtras().get("data");

    String filePath = "/mnt/sdcard/DCIM/"; 
    filePath += "hml.png";
 try {
  image.compress(Bitmap.CompressFormat.PNG, 100, new FileOutputStream(new File(filePath)));
 } 
    catch (FileNotFoundException e) {
                 // TODO Auto-generated catch block
                e.printStackTrace();}  
    catch (NullPointerException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();       } 
    }} 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T22:44:24.743

If you don't supply a uri for the output image, the camera intent will return only a thumbnail of the picture. Follow these instructions on how to do this properly: [http://www.tutorialforandroid.com/2010/10/take-picture-in-android-with.html](http://www.tutorialforandroid.com/2010/10/take-picture-in-android-with.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T03:29:56.280

我发现了同样的问题。也许我们使用前置摄像头。我发现还有另一个可以使用相机并发现代码崩溃。

AndroidManifest.xml：

```
 </application>
    <uses-sdk android:minSdkVersion="8" />
<uses-permission android:name="android.permission.CAMERA" />
   <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-feature android:name="android.hardware.camera"/>
<uses-feature android:name="android.hardware.camera.autofocus"/></manifest> 
```

源代码：

```
import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.Calendar;
import java.util.Locale;

import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.PixelFormat;
import android.hardware.Camera;
import android.os.Bundle;
import android.text.format.DateFormat;
import android.util.Log;
import android.view.KeyEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.Window;
import android.view.WindowManager;
import android.widget.FrameLayout;
import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends Activity {

    private CameraView cv;
    private Camera mCamera = null;
    private Bitmap mBitmap = null; 

    public Camera.PictureCallback pictureCallback = new Camera.PictureCallback() {

        public void onPictureTaken(byte[] data, Camera camera) {
            Log.i("yao","onPictureTaken");
            Toast.makeText(getApplicationContext(), "saving……", Toast.LENGTH_LONG).show();
            mBitmap = BitmapFactory.decodeByteArray(data, 0, data.length);
            File file = new File("/sdcard/YY"+ new DateFormat().format("yyyyMMdd_hhmmss", Calendar.getInstance(Locale.CHINA)) + ".jpg");
            try {
                file.createNewFile();
                BufferedOutputStream os = new BufferedOutputStream(new FileOutputStream(file));
                mBitmap.compress(Bitmap.CompressFormat.PNG, 100, os);
                os.flush();
                os.close();
                Toast.makeText(getApplicationContext(), "save completed", Toast.LENGTH_LONG).show();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }

    };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN);
        getWindow().setFormat(PixelFormat.TRANSLUCENT);

        FrameLayout  fl = new FrameLayout(this);     

        cv = new CameraView(this);
        fl.addView(cv);

        TextView tv = new TextView(this);
        tv.setText("take a picture");
        fl.addView(tv);

        setContentView(fl);

    }

    public boolean onKeyDown(int keyCode, KeyEvent event) {
        Log.i("yao","MainActivity.onKeyDown");
        if (keyCode == KeyEvent.KEYCODE_CAMERA) {
            if (mCamera != null) {
                Log.i("yao","mCamera.takePicture");
                mCamera.takePicture(null, null, pictureCallback);
            }
        }
        return cv.onKeyDown(keyCode, event);
    }

    class CameraView extends SurfaceView {

        private SurfaceHolder holder = null;

        public CameraView(Context context) {
            super(context);
            Log.i("yao","CameraView");

            holder = this.getHolder();
            holder.addCallback(new SurfaceHolder.Callback() {

                @Override
                public void surfaceDestroyed(SurfaceHolder holder) {
                    mCamera.stopPreview();
                    mCamera.release();
                    mCamera = null;
                }

                @Override
                public void surfaceCreated(SurfaceHolder holder) {
                    mCamera = Camera.open();
                    try {
                        mCamera.setPreviewDisplay(holder);
                    } catch (IOException e) {
                        mCamera.release();
                        mCamera = null;
                    }

                }

                @Override
                public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {

                    Camera.Parameters parameters = mCamera.getParameters();
                    parameters.setPictureFormat(PixelFormat.JPEG);
                    parameters.setPreviewSize(854, 480);
                    parameters.setFocusMode("auto");
                    parameters.setPictureSize(2592, 1456);
                    mCamera.setParameters(parameters);
                    mCamera.startPreview();
                }
            });
            holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
        }

    }

} 
```

# list - 从客户端过滤外部列表字段

> ID：10021360
> 
> 赞同：0
> 
> 时间：2012-04-05T01:02:33.363
> 
> 标签：list, sharepoint, bcs, sharepoint-clientobject

背景：

我们正在开发一个通过客户端对象模型访问 SharePoint 的自定义应用程序，该应用程序需要使用 OM（对象模型）访问 SharePoint 中定义的 ECT（外部内容类型）列表。此应用程序是一种产品，应该可以与大多数 SharePoint 安装和配置一起使用，并且不具备外部列表的先验知识。

如果没有为 ECT 设置过滤器，SharePoint 将返回列表中的所有可用项目（假设数量低于阈值）。当我们为此 ECT 定义过滤器时，SharePoint 仅返回应用此过滤器后的项目（可能来自 SP 的正确行为）。

问题：

我们需要能够根据用户在搜索框中输入的文本来搜索这个 ECT 列表（未过滤）。目前似乎无法更改将值返回给调用对象时应用的筛选器 SharePoint。

即我的 ECT 列表中有 10 个项目（1,2,3…10）。每个项目有 3 列（ID、名称、描述）。为 ECT 列表设置过滤器后，当我向 SharePoint 询问项目列表时，SharePoint 返回项目 2、3 和 6。

不，用户会搜索与项目 7 的描述匹配的内容。如何搜索/过滤列表以返回与我的搜索查询匹配的项目？

我一直在兜圈子试图解决这个问题，但似乎没有任何效果。我尝试设置 CAML 查询以及[http://pholpar.wordpress.com/2011/02/09/how-to-query-external-lists-on-the-client-side-using中定义的 LoadQuery -caml/](http://pholpar.wordpress.com/2011/02/09/how-to-query-external-lists-on-the-client-side-using-caml/)和[http://msdn.microsoft.com/en-us/library/ff464384.aspx](http://msdn.microsoft.com/en-us/library/ff464384.aspx)但似乎没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T11:06:41.870

即使我有这个问题。让我告诉你，没有办法做到这一点。即使在服务器对象模型中，也可以选择更改默认视图的过滤器，但是一旦应用过滤器，SPList 将返回 0 个项目。有趣的是，一旦您的代码运行并在 SP UI 中打开列表，您就可以看到实际修改后的列表。但是对象模型中的查询也不能这样。

看起来很奇怪。我想如果你在这个实例中修改 SPList（基于 ECT），那么你只能在下一个实例中得到结果（比如在下一页刷新.....）

# php - HTML 电子邮件格式

> ID：10021361
> 
> 赞同：0
> 
> 时间：2012-04-05T01:02:55.213
> 
> 标签：php, email

> **可能重复：**
> [html 电子邮件的 mail() 标头问题](https://stackoverflow.com/questions/850701/mail-header-problem-for-html-email)

我将以下内容用于`$headers`：

```
 $headers = "MIME-Version: 1.0\r\n";
        $headers .= "Content-Type: text/html; charset=ISO-8859-1\r\n";
        $headers .= "From: " .  $from . "\r\n"; 
        $headers .= "Reply-To: ". $from . "\r\n";
        $headers .= "CC: me@site.com\r\n"; 
```

我在 Gmail 中看起来不错，但是在 Outlook 中`html`看起来很原始。`html`

我在标题中忘记了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:19:13.170

在 2007 年展望中（至少）。可以更改电子邮件格式。看看：工具>选项>电子邮件格式（选项卡）>消息格式（选择框）>更改为html

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:26:02.143

我检查了位于此处的问题[https://stackoverflow.com/a/2423592/1012061](https://stackoverflow.com/a/2423592/1012061)作为@Shawn H. 在上面的评论中推荐。

其中一个答案是这样说的：

“我有一个非常相似的问题，请尝试从您的退货中删除 /r 并仅使用 /n。Outlook 和 hotmail 有 /r/n 的问题。”

效果很好！

# java - 使用 ObjectOutputStream 插入 MySQL 数据库

> ID：10021362
> 
> 赞同：0
> 
> 时间：2012-04-05T01:03:01.430
> 
> 标签：java, mysql, sql, jdbc

我现在正在制作一个多人游戏服务器。目前它将每个播放器保存为序列化文件，我希望将其转换为通过 MySQL 保存所有内容，以便我也可以在我的网站上访问它。

我想知道的是写入序列化文件，我使用 ObjectOutputStream。以下是我保存文件的方法。

```
public static final void storeSerializableClass(Serializable o, File f)
        throws IOException {
    ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f));
    out.writeObject(o);
    out.close();
} 
```

所以我想知道，我将如何能够做到这一点，但保存到 SQL，而不是序列化？我一直在玩几种不同的东西，但我似乎无法找到一种可靠的方法来做到这一点。

此外，我不需要知道如何在 Java 中使用 MySQL，我知道，我只需要知道如何使用 ObjectOutputStream 即可。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-11T23:33:17.350

您可以将其存储为 Blob，然后对其进行反序列化。这里有一个例子：http: [//www.mindfiresolutions.com/Store-Java-Class-Object-in-Database-754.php](http://www.mindfiresolutions.com/Store-Java-Class-Object-in-Database-754.php)

另一种可能性是将文件简单地存储为文本。这一切都取决于要求。

# c# - 获取 Facebook Graph API 令牌密钥的正确方法

> ID：10021363
> 
> 赞同：3
> 
> 时间：2012-04-05T01:03:07.257
> 
> 标签：c#, facebook, facebook-graph-api

我通常使用肮脏的方法在获取 Facebook 数据的应用程序中获取我的 Facebook Graph API 令牌密钥。我在 graph dot facebook dot com 下载了 Graph API 示例页面，然后我在页面中找到了令牌密钥。（账号已经绑定）

现在，我需要（为其他人）编写一个使用 Graph API 的商业应用程序，我担心如果 Facebook 网站发生变化，这种骇人听闻的方式可能会失效。

是否有比 Graph API token_key 所在的示例页面更常见的静态 URL，或者您认为我的方法会长期安全吗？

[编辑]

只是为了评论我的问题，以及我的问题的答案：

我试图构建一个桌面应用程序，仅使用 Graph Explorer 和 Graph API 示例页面在 Facebook 上获取数据，而不是在答案中执行 Web 请求。我不想拥有一个依赖 Facebook 应用程序的桌面应用程序，所以这就是为什么我总是要求用户通过两个文本框进行连接（这违反了 Facebook t&c）然后我下载了 Graph API 示例页面以获取适当的令牌。

但是 Graph Explorer 及其示例也在使用“Facebook 应用程序”。所以不清楚 access_token 是否会长期有效：这不是一个好习惯。

答案是：将用户重定向到身份验证页面然后获取访问令牌比通过文本框和多个 WebBrowser 导航连接用户更安全、易于处理且稳定得多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T06:43:10.223

您可以从以下 URL 获取应用程序访问令牌以查询 Facebook 上的公共数据：

`https://graph.facebook.com/oauth/access_token?type=client_cred&client_id={yourappid}&client_secret={yourappscret}`

您需要在 Facebook 上创建一个应用程序并传递它的 ID 和密钥。

更多信息：http: [//developers.facebook.com/docs/authentication/applications/](http://developers.facebook.com/docs/authentication/applications/)

# ruby-on-rails - API 文档的 Rails 路由

> ID：10021364
> 
> 赞同：1
> 
> 时间：2012-04-05T01:03:46.833
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rest, documentation, routes

我目前正在为我的网站的 API 编写文档。

我不确定编写路线的“最佳”方式。我认为 twitter 做得很好，我想复制他们的 url 结构：

```
https://dev.twitter.com/docs/api
https://dev.twitter.com/docs/api/1/get/statuses/show/:id
https://dev.twitter.com/docs/api/1/post/statuses/retweet/:id 
```

它会是这样的：

```
 namespace :docs do
     resources :api do
         # and then... not sure
     end
 end 
```

不确定如何编写这部分的路线：`/get/statuses/show/:id`。

我应该只创建一个自定义路线吗？

```
match "/:verb/:resource/:action/:params" => "api#resource" 
```

或者，还有更好的方法？

* * *

我最终得到的结果可能会对某人有所帮助:)

```
Ibarcraft::Application.routes.draw do
    def api_versions; [:v1] end
    def api_verbs; [ :index, :show ] end

    constraints subdomain: "api" do
        scope module: "api", as: "api" do
            versions = api_versions

            versions.each do |version|
                namespace version, defaults: { format: "json" } do

                    # all my routes
                    resources :barcrafts, only: api_verbs do
                        collection do
                            get :search
                        end
                        scope module: "barcraft" do
                            resources :users, only: [:index]
                        end
                    end
                    # and more...

                end
            end

            match 'v:api/*path', to: redirect { |params, request| "/#{versions.last}/#{params[:path]}" + (params[:format] ? ".#{params[:format]}" : "") }
            match '*path', to: redirect { |params, request| "/#{versions.last}/#{params[:path]}" + (params[:format] ? ".#{params[:format]}" : "") }
        end
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:57:37.343

是的，您需要自定义路线。

但请注意，该`:action`键是为控制器的操作名称保留的，最好使用类似`:action_name`

# php - 使用回溯的 php 简单数独求解器

> ID：10021365
> 
> 赞同：2
> 
> 时间：2012-04-05T01:04:02.053
> 
> 标签：php, sudoku, backtracking

我最近想看看我是否能够在 php.ini 中解决一个简单的数独（起初）。我知道 php 并不是真正出于编程原因的选择，但我最了解 php，而且我在 java 和 c 中的设计有问题。尽管如此，我看不出它不应该工作的任何理由。

首先我不想问你，因为那里有一些已解决的线程。但是我发现这些解决方案太复杂了，我无法理解（其他语言，复杂的结构）并且超出了我的目标。

我的问题是：有人可以根据我的目标给我一个提示吗？我想要一个简单的数独求解器，无需猜测，只需回溯。

该算法如下所示：

```
$cell;  // 1-81 - as parameter of the recursive function solve()
$value; // 1-9  - as parameter ...

class Sudoku {

function solve($cell = 1, $value = 1) {

    // skipping values

    if the current cell is fix:

        return solve(cell++, $value);

    // testing values (logic)

    if not:

        if the value is within the square (3x3) itself:

            return solve($cell, $value++);

        if the value is within the row:

            return solve($cell, $value++);

        if the value is within the col:

            return solve($cell, value++);

        if the value is bigger than 9:

            return solve($cell--, $value_prev);

        // all test passed, add the new value to list
        $this->values[$cell] = $value;

        if all fields are filled:
            return;

        if there are fields left:
            return solve($cell++, 1);
}
} 
```

如果我创建一个空白数独，它将正确填满，直到单元格 43。脚本崩溃并出现致命错误：致命错误：允许的内存大小为 134217728 字节已用尽（尝试分配 261904 字节）。

值填写如下：

1 2 3 | 4 5 6 | 7 8 9
4 5 6 | 7 8 9 | 1 2 3
7 8 9 | 1 2 3 | 4 5 6
2 1 4 | 3 6 5 | 8 9 7
3 6 5 | 2 1 4 | . . .

我想有一个无限循环或导致这次崩溃的东西。也许它不是这样解决的。我只是想知道我是否做对了，或者我忘了检查什么。我还尝试了这个算法，它使用来自简单数独的固定值。它也崩溃了……也许有太多的回溯。

最后，我想说我并不反对更好的解决方案，但我只是希望它能够奏效。如果您不能基于此给我答案，您可以查看 php 文件：

[数独.php](http://www.4shared.com/file/rqKepkeq/sudoku.html)

**编辑：** [数独2.php](http://www.4shared.com/file/0pXh5HJk/sudoku2.html)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:54:52.160

这是您的主要问题：

```
if the value is bigger than 9:
    return solve($cell--, $value_prev); 
```

当你到达那个点时（没有任何效果，所以你必须回去改变以前的东西），你不能像现在这样更深地递归，因为你的堆栈会随着错误的积累而变得太大。您实际上需要返回到先前的堆栈级别并从那里继续前进。

例如，如果它是完整的，或者如果它用完了选项，你可能会`solve`退货。然后任何时候你递归调用，如果它返回，你返回，如果它返回，你再次调用它。`TRUE``FALSE``solve``TRUE``TRUE``FALSE``$value++`

# android - Android 上的详细日志记录

> ID：10021366
> 
> 赞同：2
> 
> 时间：2012-04-05T01:04:28.813
> 
> 标签：android, optimization, architecture, logging

如果您在[Android Dev](http://developer.android.com/reference/android/util/Log.html)上查找日志记录文档，则有一个部分显示为

> 详细程度从少到多的顺序是 ERROR、WARN、INFO、DEBUG、VERBOSE。除非在开发期间，否则永远不应将详细信息编译到应用程序中。调试日志被编译，但在运行时被剥离。始终保留错误、警告和信息日志。

这个简介的第二部分是目前让我感到困惑的部分。这是否意味着

a）编译器优化器会自动去除所有详细的日志记录（就像在调试中特别建议的那样）

或者

b) 我应该在发布之前找到所有 Log.v() 并将其替换为 ""

我意识到最终用户并不需要详细的日志记录，我完全同意这一点，但我也相信在开发过程中应该尽可能多地使用日志。我意识到我理论上可以做一些类似的事情

```
if(IS_VERBOOSE_LOGGING_ENABLED) 
{ 
    Log.v("My log message here");
} 
```

但是，这仍然会违反建议（假设这意味着在编译时间之前删除）。

社区的任何澄清将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:07:48.160

最好的办法是配置 proguard 以摆脱发布工件中的所有日志记录。那你就完全不用担心了。

```
# get rid of all the logging
-assumenosideeffects class android.util.Log {
    public static int v(...);
    public static int d(...);
    public static int w(...);
    public static int i(...);
} 
```

# windows - node.js 中 process.on('SIGINT') 的 Windows 等效项是什么？

> ID：10021373
> 
> 赞同：94
> 
> 时间：2012-04-05T01:05:17.653
> 
> 标签：windows, node.js

我正在按照[此处](https://stackoverflow.com/questions/9299331/what-is-the-best-practice-to-gracefully-shutdown-a-node-js-program-from-an-exter)的指导（监听`SIGINT`事件）优雅地关闭我的 Windows-8 托管的 node.js 应用程序以响应`Ctrl`+`C`或服务器关闭。

但是 Windows 没有`SIGINT`. 我也尝试过`process.on('exit')`，但这似乎为时已晚。

在 Windows 上，这段代码给了我：**错误：没有这样的模块**

```
process.on( 'SIGINT', function() {
  console.log( "\ngracefully shutting down from  SIGINT (Crtl-C)" )
  // wish this worked on Windows
  process.exit( )
}) 
```

在 Windows 上，此代码运行，但**为时已晚，无法优雅地执行任何操作**：

```
process.on( 'exit', function() {
  console.log( "never see this log message" )
}) 
```

Windows 上是否有`SIGINT`类似的事件？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2013-02-13T19:32:22.080

您必须使用 readline 模块并监听 SIGINT 事件：

[http://nodejs.org/api/readline.html#readline_event_sigint](http://nodejs.org/api/readline.html#readline_event_sigint)

```
if (process.platform === "win32") {
  var rl = require("readline").createInterface({
    input: process.stdin,
    output: process.stdout
  });

  rl.on("SIGINT", function () {
    process.emit("SIGINT");
  });
}

process.on("SIGINT", function () {
  //graceful shutdown
  process.exit();
}); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-07-28T09:20:01.183

我不确定何时，但在节点 8.x 和 Windows 10 上，原始问题代码现在可以正常工作。

```
process.on( "SIGINT", function() {
  console.log( "\ngracefully shutting down from SIGINT (Crtl-C)" );
  process.exit();
} );

process.on( "exit", function() {
  console.log( "never see this log message" );
} );

setInterval( () => console.log( "tick" ), 2500 ); 
```

[![在此处输入图像描述](../Images/6581f94f12b21561d3dad3959715f7d8.png)](https://i.stack.imgur.com/Gvne0.gif)

也适用于 Windows 命令提示符。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-01-19T09:13:59.987

现在*它只适用* [于所有平台](https://nodejs.org/api/process.html)，包括 Windows。

以下代码记录并在 Windows 10 上正确终止：

```
process.on('SIGINT', () => {
    console.log("Terminating...");
    process.exit(0);
}); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-09-07T20:44:25.220

除非您需要为其他任务导入“readline”，否则我建议在程序验证它在 Windows 上运行后导入“readline”。此外，对于那些可能不知道的人 - 这适用于 Windows 32 位和 Windows 64 位系统（将返回关键字“win32”）。感谢加布里埃尔的这个解决方案。

```
if (process.platform === "win32") {
  require("readline")
    .createInterface({
      input: process.stdin,
      output: process.stdout
    })
    .on("SIGINT", function () {
      process.emit("SIGINT");
    });
}

process.on("SIGINT", function () {
  // graceful shutdown
  process.exit();
}); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-04-05T05:56:41.967

目前节点中仍然不支持捕获 Windows 控制台控制事件，因此没有与 POSIX 信号等效的功能：

[https://github.com/joyent/node/issues/1553](https://github.com/joyent/node/issues/1553)

但是[tty 模块文档](http://nodejs.org/api/tty.html)确实提供了一个捕获按键以启动正常关闭的机制示例，但这仅适用于`ctrl`+ `c`。

```
var tty = require('tty');

process.stdin.resume();
tty.setRawMode(true);

process.stdin.on('keypress', function(char, key) {
  if (key && key.ctrl && key.name == 'c') {
    console.log('graceful exit of process %d', process.pid);
    process.exit();
  }
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-01T21:47:49.737

从 node.js 0.8 开始，该`keypress`事件不再存在。然而，有一个名为[keypress](https://github.com/TooTallNate/keypress)的 npm 包重新实现了该事件。

安装`npm install keypress`，然后执行以下操作：

```
// Windows doesn't use POSIX signals
if (process.platform === "win32") {
    const keypress = require("keypress");
    keypress(process.stdin);
    process.stdin.resume();
    process.stdin.setRawMode(true);
    process.stdin.setEncoding("utf8");
    process.stdin.on("keypress", function(char, key) {
        if (key && key.ctrl && key.name == "c") {
            // Behave like a SIGUSR2
            process.emit("SIGUSR2");
        } else if (key && key.ctrl && key.name == "r") {
            // Behave like a SIGHUP
            process.emit("SIGHUP");
        }
    });
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-17T09:46:09.777

上面没有对我有用，所以解决方法是挂一个 readline 并从那里捕获信号。

这是我的解决方案：

```
const readline = require('readline');

const rl = readline.createInterface({ input: process.stdin, output: process.stdout });

// Flag to be able to force the shutdown
let isShuttingDown = false;

// https://nodejs.org/api/readline.html
rl.on('SIGINT', async () => {
  if (isShuttingDown) {
    logger.info("Forcing shutdown, bye.");
    process.exit();
  } else {
    if (!<yourIsCleanupNecessaryCheck>()) {
      logger.info("No cleanup necessary, bye.");
      process.exit();
    } else {
      logger.info("Closing all opened pages in three seconds (press Ctrl+C again to quit immediately and keep the pages opened) ...");
      isShuttingDown = true;
      await sleep(3000);
      await <yourCleanupLogic>();
      logger.info("All pages closed, bye.");
      process.exit();
    }
  }

function sleep(ms: number) {
  return new Promise(resolve => setTimeout(resolve, ms));
} 
```

它非常普通，它是异步的，并且可以在 MacOS 11.3 和 Windows 10 上运行（在撰写本文时）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-30T17:38:43.947

# Windows + Git Bash/Cygwin 解决方案：

Windows 和 Git Bash 的其他解决方案都不起作用，所以我的解决方案是简单地使用[WINPTY](https://github.com/rprichard/winpty)如下启动 Node：

我`package.json`有这个启动脚本：

```
"start": "winpty node app.js" 
```

这是受类似 Python 问题在此处接受的答案的启发：

[python错误抑制信号18到win32](https://stackoverflow.com/questions/50110571/python-error-suppressing-signal-18-to-win32/50120613)

*注意：* [WINPTY](https://github.com/rprichard/winpty)在 Windows XP 及更高版本上运行。

# grails - Grails GORM 事件被多次调用

> ID：10021376
> 
> 赞同：2
> 
> 时间：2012-04-05T01:05:25.940
> 
> 标签：grails

只是试图用 Grails 2.0.2 实现一个简单的审计日志解决方案，看起来任何域类事件都被多次调用。对于 before* 和 after* 事件也是如此。

```
 def afterUpdate () {
        log.info "Updating..."
 } 
```

我本来预计只会触发 1 个事件，所以如果按设计多次调用它，我将如何确保只创建 1 个审计条目？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:24:34.320

最近我自己也遇到了同样的问题。有一个[为此开放的 JIRA](http://jira.grails.org/browse/GRAILS-8237)，它提到它将在 2.0.4 中修复，看起来它会为每个数据源触发事件......同时 JIRA 用户已经捐赠了一个简单的解决方法。

我尝试了 Auditable 插件，但无法按我的意愿工作（可能受到相同问题的影响）

# sql - SQL Server 计算列降低了简单选择语句的性能

> ID：10021377
> 
> 赞同：3
> 
> 时间：2012-04-05T01:05:39.040
> 
> 标签：sql, sql-server, stored-procedures, user-defined-functions, calculated-columns

背景：

以前，我的公司使用用户定义的函数对存储过程的 where 子句中的一些数据进行 html 编码。下面的例子：

```
DECLARE @LName --HTML encoded last name as input parameter from user

SELECT * 
  FROM (SELECT LName
          FROM SomeView xtra
         WHERE (( @LName <> '' 
              AND dbo.EncodingFunction(dbo.DecodingFunction(xtra.LName)) = @LName) 
           OR @Lname='')) 
```

为了清楚起见，我对此进行了简化。

问题是，当使用此查询的存储过程被快速连续调用 45 次时，具有 62,000 条记录的表的平均性能约为 85 秒。当我移除 UDF 时，运行 sproc 45 次的性能提高到 1 秒多一点。

因此，我们咨询并决定了一个解决方案，该解决方案在视图访问的表中包含一个计算列，`SomeView`. 计算列被写入到表定义中，如下所示：

```
[LNameComputedColumn] AS (dbo.EncodingFunction(dbo.DecodingFunction([LName]))) 
```

然后，我运行了一个更新表的进程，并为所有 62,000 条记录自动填充了该计算列。然后我将存储过程查询更改为以下内容：

```
DECLARE @LName --HTML encoded last name as input parameter from user

SELECT * FROM
      (SELECT LNameComputedColumn
      FROM SomeView xtra
      WHERE  (( @LName <> '' AND xtra.LNameComputedColumn=@LName) OR @Lname='') 
```

当我运行该存储过程时，45 次执行的平均运行时间增加到大约 90 秒。我的改变实际上使问题变得更糟！

我究竟做错了什么？有没有办法提高性能？

附带说明一下，我们目前使用的是 SQL Server 2000，并计划很快升级到 2008 R2，但所有代码都必须在 SQL Server 2000 中运行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T01:30:48.707

添加一个计算创建一个*虚拟*列，仍然在运行时为每一行选择计算。你想要的是一个计算的**持久**列，它在插入时计算并物理存储在表中：

```
[LNameComputedColumn] 
   AS (dbo.EncodingFunction(dbo.DecodingFunction([LName]))) PERSISTED 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T01:08:18.597

> 问：MS SQL 计算列会降低性能...

答：马曲棍球；）

```
 ... where @LName <> '' ... 
```

问：你能说“全表扫描”吗？

我不是说你的功能*不*贵。但是在你指责之前，你真的必须做出一个更有选择性的“where”子句......

恕我直言...

建议：

1.  *查询数据（首先*获取所有相关的“Lname” ）

2.  在结果上运行你的函数（只有选定的“Lnames”——我想，*不是*整个视图或表中的每一行）

3.  在您的存储过程中执行这两项操作（使用过滤器进行查询，然后进行后处理）

# php - 使用 jQuery 将 php 文件加载到 div 中不起作用

> ID：10021379
> 
> 赞同：1
> 
> 时间：2012-04-05T01:05:56.997
> 
> 标签：php, javascript, jquery, html

所以我的主要布局是这样的：

```
<div class="menu">
    <?php include('/menu.php'); ?>
</div>
<div class="main" id="content">
    <?php include('/home.php'); ?>
</div> 
```

在`menu.php`我有 4 个 div 设置如下：

```
<div class="link current">
    <a href="#" class="home">
        Home
    </a>
</div>
<div class="link">
    <a href="#" class="about">
        About
    </a>
</div>
<div class="link">
    <a href="#" class="forums">
        Forums
    </a>
</div>
<div class="link">
    <a href="#" class="contact">
        Contact
    </a>
</div> 
```

我在索引页的头部包含了这个 .js 文件

```
$(function () {
    $('div.link a').click(function () {
        $('div.link').removeClass('current');
        $(this).closest('div.link').addClass('current');
        if($('div.link a').hasClass('home')) {
            $('#content').load('/home.php');
        } else if($('div.link a').hasClass('about')) {
            $('#content').load('/about.php');
        } else if($('div.link a').hasClass('forums')) {
            $('#content').load('/forums.php');
        } else if($('div.link a').hasClass('contact')) {
            $('#content').load('/contact.php');
        } else return false;
    });
}); 
```

但它不起作用。

我对这一切都很陌生，并且在自己尝试过但无法弄清楚之后，使用互联网上的各种资源将这段代码拼凑在一起，我来寻求帮助。

网站的层次结构就是这样。

```
-/
    -res/
        -css/
            -default.css
        -imgs/
    -scripts/
        -jquery.js
        -load.js (this is the one shown above) 
    -index.php 
    -menu.php 
    -home.php 
    -about.php 
    -forums.php 
    -contact.php 
```

如果有人可以提供帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T01:16:59.910

语句中的第一个条件`if`是检查是否*有任何*“div.link a”具有“home”类。因此，第一个 if 条件始终为真，并且您始终将 /home.php 加载到 #content 中。您要做的是检查*单击的链接是否*具有类。

你应该使用`if($(this).hasClass('home')) {`...

另外，如果您想稍微清理一下，我建议：

```
$('div.link a').click(function () {
    $('div.link').removeClass('current');
    $(this).closest('div.link').addClass('current');
    $('#content').load('/' + $(this).attr('class') + '.php');
}); 
```

这样您就不必维护`if`语句。但是，如果您最终向这些链接添加更多类，这将中断。也许使用`data-*`属性？ `<a href="#" data-load="contact">`...

# cocoa - Cocoa：NSView 上的按键事件未触发

> ID：10021383
> 
> 赞同：18
> 
> 时间：2012-04-05T01:06:30.600
> 
> 标签：cocoa, keydown, document-based

我制作了一个自定义 NSView 并实现了该`keyDown:`方法。但是，当我按键时，该方法永远不会被调用。我必须注册才能接收这些活动吗？仅供参考，我正在制作一个基于文档的应用程序，并且可以在任何地方处理此代码（不必在此视图中）。在基于文档的应用程序中执行此操作以使事件在整个应用程序中发生的最佳位置是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-05T01:28:50.940

您需要覆盖`-acceptsFirstResponder`才能返回`YES`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-07-19T23:00:50.990

在斯威夫特：

```
class MDView: NSView {
    override var acceptsFirstResponder: Bool { return true }
} 
```

# java - GWT RPC 序列化异常

> ID：10021384
> 
> 赞同：2
> 
> 时间：2012-04-05T01:06:31.917
> 
> 标签：java, gwt, serialization, gwt-rpc, objectify

我正在尝试通过 GWT RPC (GWT 2.4) 发送一个对象。该对象包括一个对象，该对象包括以下字段：

```
@Serialized
private Map<Class<? extends Foo>, Foo> fooMap = ImmutableMap.of(); 
```

`Foo`定义为：

```
public interface Foo extends Serializable {

} 
```

当`fooMap`为空时，它工作正常。填充后，GWT RPC 失败并显示`SerializationException`. （服务器永远不会被击中。）`Foo`in的唯一类型`fooMap`来自此类：

```
public class FooImpl implements Foo {

  private static final long serialVersionUID = 1L;

  private long bar;
  private float baz;
  private int batz;

  ... 
} 
```

我究竟做错了什么？`FooImpl`不应该造成任何问题。每个类都有一个无参数构造函数。我不需要每个序列化对象的每个私有字段的 getter 和 setter，对吗？有`Class<? extends Foo>`问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T13:40:13.117

`Class<? extends Foo>`很可能是个问题。据我所知，GWT 根本不知道如何序列化-反序列化`Class`实例（它的代码仅用于序列化普通对象、枚举和数组，并且没有 CustomFieldSerializer）。所以尝试使用类名而不是`Class`实例。

# django - 在 django 的 auotslugfield populatefrom() 中使用外键的属性

> ID：10021387
> 
> 赞同：0
> 
> 时间：2012-04-05T01:07:09.320
> 
> 标签：django

我正在尝试这样做

```
 nvc = models.ForeignKey(Nvc)
    slug = AutoSlugField(max_length=50, unique=True, populate_from=('channel_index','nvc__mac_address'))
    channel_index = models.IntegerField()    
    ... 
```

其中 nvc 是带有字段 mac_address 的外键，通道索引是本地字段

我的尝试基于 AutoSlugField ( [autoslugfield](http://pydoc.net/django-autoslug/1.3.9/autoslug.fields) )中显示的与“unique_with”一起使用的内容

```
# minimum date granularity is shifted from day to month
slug = AutoSlugField(populate_from='title', unique_with='pub_date__month') 
```

但我得到这个错误

> 'NvcChannel' 对象没有属性 'nvc__mac_address'

有可能做我想做的事吗？如果是这样，我哪里出错了？

我查看了这个问题[覆盖保存以执行代码](https://stackoverflow.com/questions/2307943/django-overriding-the-model-create-method) 并想出了这个

```
def save(self, *args, **kwargs):
    if not self.pk:
        self.slug = AutoSlugField(max_length=50, unique=True, populate_from=('channel_index',self.nvc.mac_address))
    super(NvcChannel, self).save(*args, **kwargs) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:17:22.237

`nvc__mac_address`仅用于数据库查找（通常使用`filter()`）。您正在尝试访问检索到的对象的字段，因此您应该使用`nvcchannel.nvc.mac_address`

# ios - 是否可以对 CorePlot 中表示的数据进行动画更改？

> ID：10021389
> 
> 赞同：0
> 
> 时间：2012-04-05T01:07:19.713
> 
> 标签：ios, core-animation, core-plot, observer-pattern, key-value-observing

我希望使用 CorePlot 显示来自 API 的一堆数据，我想观察变化，以便图形可以动态变化。为了获得最佳体验，我认为数据应该是动画的。

我知道观察数据模型的变化完全取决于我，但我无法弄清楚如何为情节本身的变化设置动画。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:31:25.490

还没有为此内置任何东西。您可以使用新数据创建第二个绘图，将其添加到图表中，然后对其进行动画处理。适当时删除旧绘图（有或没有动画）。要使用的最佳动画类型可能取决于您使用的绘图类型。

# string - 将一组字符串划分为大小大致相同的最小互斥组的算法

> ID：10021390
> 
> 赞同：3
> 
> 时间：2012-04-05T01:07:27.760
> 
> 标签：string, algorithm, grouping

我有一大串字符串。我想将字符串分成子集，这样：

1.  子集中的每个项目共享 1 个或多个连续字符。
2.  定义子集的共享连续字符对于子集集是唯一的（即，共享字符足以定义与其他子集互斥关系的字符串子集）。
3.  子集的大小大致相同。
4.  生成的子集集是满足上述标准所需的最小子集数。

例如，给定以下一组名称：

艾伦、拉里、阿尔弗雷德、芭芭拉、阿尔方斯、卡尔

我可以将这个集合分成两个大小相等的子集。由连续字符“AL”定义的子集 1 将是

艾伦、阿尔弗雷德、阿尔方斯

由连续字符 ar 定义的子集 2 将是

拉里、芭芭拉、卡尔。

我正在寻找一种可以对任意字符串集执行此操作的算法。子集的结果集不必等于 2，但它应该是最小集，并且结果子集应该近似相等。

艾略特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:33:17.923

这很棘手。我想知道是否有更高的目的（比如词索引）或者这只是一个学术问题？

一般来说，它是不可解的，除非您接受由空序列定义的单个集合的平凡解（它出现在所有单词中）。例如，获取字符串：`a`, `ab`, `b`.

1.  `a`必须进入由 定义的集合`a`。
2.  `b`必须进入由 定义的集合`b`。
3.  `ab`必须进入两者，因为它包含两个子序列。

你正在处理的单词会出现类似的例子吗？我不知道。也许您可以处理映射到多个集合的单词，或者您可以拥有一个打破平局的系统来确定放置它的位置。

假设这不是问题，[burrows-wheeler 变换](http://en.wikipedia.org/wiki/Burrows%E2%80%93Wheeler_transform)可能有助于找到好的子串。

或者怎么样：

1.  生成单词中的所有子序列。
2.  构建子序列的干扰图，如果两个子序列都出现在一个单词中，则用一条边连接它们。
3.  为图表着色。
4.  为每种颜色选择一个有代表性的子序列。
5.  制作一个由每个代表性子序列定义的集合。如果该颜色的所有单词都具有该子字符串，则将它们全部放入该集合中。
6.  否则，从图中删除该子字符串，然后从步骤 3 开始重复。

该算法可能已损坏，但它可能会给您一些关于解决方案的想法（或者至少对您的问题的棘手性有一些想法；-）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T04:24:45.773

看看[http://en.wikipedia.org/wiki/Suffix_array](http://en.wikipedia.org/wiki/Suffix_array)。您真正想要做的可能是为每个文档创建一个后缀数组，然后它们合并所有后缀数组，并带有指向原始版本的指针，这样您就可以通过查找将集合作为一个字符串来搜索因为它作为数组中的后缀。

# java - 如何使 Java GUI 与 Core 完全分离

> ID：10021393
> 
> 赞同：5
> 
> 时间：2012-04-05T01:07:41.163
> 
> 标签：java, architecture, software-design

我正在做一个项目。我正在尝试将核心实现为可以从命令行甚至 Windows 服务运行的独立 jar 文件。核心将负责跟踪几个文件并发送一些通知电子邮件。问题是，保持 GUI 完全独立的最佳主意是什么？

GUI 需要与核心进行以下交互

*   发送文件列表
*   从核心接收有关这些文件已处理量的通知
*   接收有关文件的状态通知，即发送/处理/失败等在 GUI 中显示
*   如果有来自核心的传入消息，则接收信息

我用 Delphi 和 C 开发了这个软件。C 用于编写核心逻辑并使用 Windows 消息和回调，我在 C dll/服务上注册了 Delphi GUI。我很困惑如何在java中实现它。

*   观察者模式？
*   核心和gui之间的小型客户端/服务器通信？

PS：我在这里讨论它的原因是为了学习和探索用 Java 编码的此类软件的更好设计。我不是要求观察者模式文档或客户端服务器架构。可能还有其他我不知道的可能方式。所以我很期待任何想法、设计或框架。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T15:35:55.833

观察者模式确实是 4 个用例中的三个的正确答案。

在您的描述级别上，您的核心可能实现了以下接口：

```
public interface Core {

    sendFiles(List<File> files);
    registerProgressListener(ProgressListener listener);            
    registerStatusListener(StatusListener listener);
    registerMessageListener(MessageListener listener);
} 
```

侦听器界面看起来与这个非常相似

```
public interface ProgressListener{
    madeProgress(ProgressEvent)
} 
```

ProgressEvent（和其他 Event 类）应该是值对象，例如

```
public class ProgressEvent {
    public final double progress;
    public final String fileName;
    public ... // constructor
} 
```

您可能希望您的核心和您的 gui 在不同的线程中运行。否则，您的 GUI 在内核运行时不会对任何事件做出反应。由于核心不应该知道关于 GUI 的任何事情，线程之间的切换应该由 GUI 完成，即侦听器应该注意使用`SwingUtilities.invokeLater`或`invokeAndWait`更新 GUI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:23:33.120

也许这个答案看起来有点老派，但是普通的旧 IPC 呢？

使 GUI 将内核实例化为单独的线程，并且仅通过消息队列 (java.util.concurrent.*) 进行通信。使用它们发送文件列表、事件、进度报告和几乎所有内容。

然后你可以发布几个接口，只要所有接口都知道核心的入口点，你就可以做生意了。

# java - Android：后台列表视图

> ID：10021394
> 
> 赞同：1
> 
> 时间：2012-04-05T01:07:44.253
> 
> 标签：java, android, android-listview

如何更改 ListView 的单个单元格的背景？我在java中写道：

```
n_list = new ListView(this);
n_list.setBackgroundDrawable(getResources().getDrawable(R.drawable.list_pressed)); 
```

这种方式改变了整个列表的背景。当我按下一个单元格时，它会更改所有单元格的背景。

`list_pressed.xml`在可绘制

```
<?xml version="1.0" encoding="utf-8"?>

    <selector xmlns:android="http://schemas.android.com/apk/res/android"> 

    <item android:state_focused="true"
          android:drawable="@drawable/listviewpress" />

    <item android:state_pressed="true"
          android:drawable="@drawable/listviewpress" />
    <item 
          android:drawable="@drawable/listview" />
</selector> 
```

我怎样才能解决这个问题？提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:37:04.167

您需要创建一个[自定义适配器](http://www.softwarepassion.com/android-series-custom-listview-items-and-adapters/)，然后`getView()`您可以在其中说出您想为您的行赋予什么颜色。

如果您按照链接上的教程进行操作，您可以在您`convertView`的 a`setBackground()`上使用您想要的颜色。如果您想要一个特定的位置，只需在此之前执行 if `setBackground`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:21:36.377

下面是几个带有 customadapter 的列表视图的 URL，以便您可以在 getVIew() 中为行设置背景::

[LINL1](http://www.ezzylearning.com/tutorial.aspx?tid=1763429&q=customizing-android-listview-items-with-custom-arrayadapter)

[链接2](http://saigeethamn.blogspot.in/2010/04/custom-listview-android-developer.html)

[链接3](http://www.softwarepassion.com/android-series-custom-listview-items-and-adapters/)

[链接4](http://geekswithblogs.net/bosuch/archive/2011/01/31/android---create-a-custom-multi-line-listview-bound-to-an.aspx)

[链接5](http://www.codeproject.com/Articles/183608/Android-Lists-ListActivity-and-ListView-II-Custom)

# java - 重写这个工作 Java 数组，使其更容易、更好或更高效，而不需要 ArrayList

> ID：10021395
> 
> 赞同：2
> 
> 时间：2012-04-05T01:07:44.933
> 
> 标签：java

G'day

我有一个面向对象编程入门课程的 Java 作业。我已经完成了任务，程序按预期工作（我花了一段时间才实现这一点！），我得到了想要的输出。仅通过我的一种方法，我使用了 2 个带有 IF 语句的 FOR 循环，我想知道是否还有另一种更简单、更好或更有效的方法？但我不允许使用 ArrayList。我知道 ArrayList 更简单、更好、更高效，但是如果不能使用 ArrayList，是否可以让我的代码更好并且仍然达到相同的结果？

基本上我要求用户输入一个属性对象的 ID 号，然后将该 ID 与数组索引位置匹配，将该对象从一个数组 (propertiesForSale) 复制到另一个数组 (propertiesSold)，将增量 1 添加到我的计数器(numPropertiesSold) 在删除和压缩（我的老师说重新洗牌）第一个 (propertiesForSale) 数组并将我的另一个计数器 (numPropertiesForSale) 递减 1 之前。

我的代码如下..

```
public void sellProperty(int inID)
    {
         for (int index = 0; index < numPropertiesForSale; index++) {

            if (propertiesForSale[index].getId() == inID) {

                propertiesSold[numPropertiesSold]= propertiesForSale[index];
                numPropertiesSold++;

                for (int i = index; i < numPropertiesForSale; i++) {

                propertiesForSale[i] = propertiesForSale[i + 1];
                }

                numPropertiesForSale--;
            }
        }
    } 
```

如果有不使用 ArrayList 的更简单、更好或更有效的方法，我只是想知道是否存在以及如何完成。

感谢您的时间、耐心和投入（如果有）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T01:14:50.810

如果你不被允许使用`ArrayList`，那在我看来几乎是你能做的最好的。

尽管不是使用循环将`propertiesForSale`数组向下移动一个，但您可能希望考虑使用`System.arraycopy()`而不是您自己的循环，因为`arraycopy()`它是一种本机方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:16:43.997

您可以使用由节点组成的自定义链表。这样您在出售房产时就不需要移动数组的条目；您只需从列表中删除节点并更新指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T01:23:29.507

您正在搜索`inID`. `propertiesForSale`当您找到匹配项时，您将该对象传输到下一个索引，`propertiesSold`然后通过将其上方的所有记录传输到更低的一个索引来*压缩*数组。最后一个元素就留在那里，但在下一次查找中不会访问它，因为您减少了计数。

另一种选择是根本不压缩数组，而是将其设置为空。您当然必须调整外部 for 循环中的最大界限并添加非空检查，但内部 for 循环已消失。

这个会比较好吗？也许。你所拥有的非常好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T06:13:20.370

`propertiesForSale`在出售房产之前，通过完全填充数组来测试您的代码。也就是说，如果`numPropertiesForSale == propertiesForSale.length`你试图移除一个元素会发生什么？

# java - 不知道为什么我得到这个空指针异常错误

> ID：10021398
> 
> 赞同：1
> 
> 时间：2012-04-05T01:08:23.560
> 
> 标签：java, nullpointerexception

我正在开发一个基于文本的冒险游戏项目。它涉及带有物品的房间并在房间之间导航。有一个类叫做Item，这个更大的类叫做Room。我的所有方法似乎都有效，除了 addNeighbor （大概还有 getNeighbor，然后。）我创建了一个房间，里面有一个物品，效果很好，我创建了第二个房间，但是当我尝试添加一个邻居时，它崩溃并给出了我是空指针异常。我在这里做错了什么？

```
public class Room
{
    private String roomDescription;
    private Item item;
    private HashMap <String, Room> myNeighbors;

    public Room (String pDescription){
        roomDescription = pDescription;
        item = null;
    }

    public Room (String pDescription, Item pItem){
        roomDescription = pDescription;
        item = pItem;
    }

    public String getRoomDescription(){
        return roomDescription;
    }

    public Item getItem(){
        return item;
    }

    public void addItem (Item i){
        item = i;
    }

    public boolean hasItem(){
        if(item != null){
            return true;
        }else{
            return false;
        }
    }

    public void addNeighbor (String pDirection, Room r){
        myNeighbors.put(pDirection, r);
    }

    public Room getNeighbor (String pDirection){
        return myNeighbors.get(pDirection);
    }

    public Item removeItem(){
        item = null;
        return item;
    }

    public String getLongDescription(){
        String longDescription = "You are at " + roomDescription + "You see " + item;
        return longDescription;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:10:25.503

你从来没有初始化过`myNeighbors`；它只是一个指向无处的参考。

考虑`private HashMap <String, Room> myNeighbors = new HashMap<String,Room>();`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:10:57.417

以下代码不是空安全的：

```
public void addNeighbor (String pDirection, Room r){
    myNeighbors.put(pDirection, r);
}

public Room getNeighbor (String pDirection){
    return myNeighbors.get(pDirection);
} 
```

你可以试试：

```
public void addNeighbor (String pDirection, Room r){
    if(myNeighbors == null) {
       myNeighbors = new HashMap <String, Room>();
    }
    myNeighbors.put(pDirection, r);
}

public Room getNeighbor (String pDirection){
    if(myNeighbors == null) {
       myNeighbors = new HashMap <String, Room>();
    }
    return myNeighbors.get(pDirection);
} 
```

或者

```
private HashMap <String, Room> myNeighbors = new HashMap <String, Room>(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T01:13:00.130

我的邻居从未初始化。

你忘了这个：

```
 private HashMap <String, Room> myNeighbors= new HashMap<String Room>(); 
```

问候。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T01:13:56.097

你必须到`new`地图。更改构造函数，如：

```
public Room (String pDescription, Item pItem)
{
        roomDescription = pDescription;
        item = pItem;
        // add this
        myNeighbors = new HashMap <String, Room>();
} 
```

并将另一个构造函数更改为：

```
public Room (String pDescription)
{
        this(pDescription, null);
} 
```

# object - 我希望参考我创建的 JPanel

> ID：10021399
> 
> 赞同：1
> 
> 时间：2012-04-05T01:08:31.783
> 
> 标签：object, reference, jpanel, bufferedimage

总的来说，我希望将显示的 JPanel 绘制到 bufferedImage 上并将其保存到文件中。但是我很难理解如何引用我正在绘制的 JPanel。

我的类扩展了 JPanel，我正在绘制它，但我从未明确定义过 JPanel 对象，除非我猜在我的 main 方法中（当我将它添加到 JFrame 时），但这显然是在不同的类中。如何引用我在扩展 JPanel 的类中隐式绘制的 JPanel，以便我可以将其作为参数传递给：

public static BufferedImage createImage(JComponent component)//<---我想在这里传递我的JPanel来创建一个缓冲图像，然后使用ImageIO.write()来保存文件。{ 维度 d = component.getSize();

```
 if (d.width == 0 || d.height == 0)
    {
        d = component.getPreferredSize();
        component.setSize( d );
    }

    Rectangle region = new Rectangle(0, 0, d.width, d.height);
    return ScreenImage.createImage(component, region);
} 
```

我希望这个问题是有道理的。我知道我听起来像个新手，这是因为我是。请帮我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:33:44.823

我觉得

```
createImage(YourClassName.this) 
```

作品

# java - 筛选和上传 Java 类在本地工作，但不能在线工作。没有任何错误。怎么了？

> ID：10021405
> 
> 赞同：0
> 
> 时间：2012-04-05T01:09:46.610
> 
> 标签：java, class, upload, applet, screenshot

我是新手，所以请不要对我太苛刻。这个概念非常简单，我希望我的用户查看我网站的某个部分，在他们的机器上截取屏幕截图并上传回我的网站。

我在网上的课程中没有看到任何明显的错误，但我猜上传部分有问题，因为当我主持课程时，我的帐户中没有截图 img。在本地，下面设置为 C:/ 的路径就像有人帮助我一样工作正常。如何让它在网络上工作？

```
import java.applet.*;
import java.awt.AWTException;
import java.awt.Rectangle;
import java.awt.Robot;
import java.awt.Toolkit;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.net.*;
import java.io.*;
import javax.imageio.ImageIO;

public class ScreenShot extends Applet {

static boolean captureScreenShot(String uploadPath) 
{
boolean isSuccesful = false;
Rectangle screenRect = new Rectangle(Toolkit.getDefaultToolkit().getScreenSize());
BufferedImage capture;
try {
URL whatismyip = new URL("http://mysite.com/misc.php?page=showremoteaddr");
BufferedReader in = new BufferedReader(new InputStreamReader(
            whatismyip.openStream()));

String ip = in.readLine(); //you get the IP as a String
capture = new Robot().createScreenCapture(screenRect);
// screen shot image will be save at given path with name "screen.jpeg"
ImageIO.write(capture, "png", new File( uploadPath, ip + ".png")); 
isSuccesful = true;
} catch (AWTException awte) {
awte.printStackTrace();
isSuccesful = false;
}
catch (IOException ioe) {
ioe.printStackTrace();
isSuccesful = false;
}
return isSuccesful;
}

public static void main(String [] args){
    String path = "/var/chroot/home/content/srvu/srvr/www";
    captureScreenShot(path);
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:12:46.193

从 Internet 下载的 Java 小程序无权截取屏幕截图或访问文件系统。想象一下，如果他们这样做了，将会出现巨大的安全问题！获得这些权限的关键是对您的小程序进行数字签名——这是一个相当复杂的过程，也可能需要花钱。[这](http://www-personal.umich.edu/~lsiden/tutorials/signed-applet/signed-applet.html)是有关该主题的简短教程。

此外，applet 没有`main()`例程——或者更准确地说，如果您创建一个 applet 并给它一个`main()`方法，浏览器就不会调用它。您的小程序中的代码永远不会运行！小程序有自己的一套入口点；你可以在这里学习创建它们的基础知识[。](http://docs.oracle.com/javase/tutorial/deployment/applet/)

# actionscript-3 - AS3 Facebook 应用程序 - 在 IE8-9 上登录后，应用程序在 Facebook 登录窗口中重新加载

> ID：10021411
> 
> 赞同：0
> 
> 时间：2012-04-05T01:10:19.700
> 
> 标签：actionscript-3, facebook-graph-api

我有一个用 AS3 编写的 Facebook 应用程序，使用 Adob​​e Facebook Api。

它在除 IE8 和 9 之外的所有浏览器上都能完美运行。如果用户尚未登录 Facebook，该应用程序将要求他们登录，如果他们尚未登录，则接受权限。那就是一切都出错的地方。登录后，应用程序会在登录弹出窗口内重新加载并重新初始化**。**预期的行为，在 Chrome、Firefox 和 Safari 中看到的行为是登录窗口应该关闭，并且应用程序应该收到登录成功回调。页面选项卡中的应用永远不会收到此回调。

希望有人对如何解决这个问题有想法。我搜索过嗨和低。我尝试了 p3p 标头、各种频道 url 的内容，以及我在网上阅读的各种可能的修复。没有什么能改变行为。

我的facebook初始化如下（我都试过了）：

```
Facebook.init(APP_ID, onInitFacebook);
Facebook.init(APP_ID, onInitFacebook, {channelUrl:'http://www.somesite.com/channel.html'}); 
```

和登录：

```
Facebook.login(handleLogin, {scope:'publish_stream, user_photos'}); 
```

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T13:57:04.630

```
params.allowscriptaccess = "always";
params.allownetworking = "all";
params.wmode = "transparent"; 
```

不要问我为什么，但是在 swfobject.embedSWF 中设置参数对我有用... :)

祝你好运！

# android - 在 Eclipse 中仅调试您的 Android 源代码

> ID：10021414
> 
> 赞同：1
> 
> 时间：2012-04-05T01:10:51.210
> 
> 标签：android, eclipse, debugging, breakpoints

我在我的代码中设置了一个断点，当我进入调试模式时，它会在断点处停止。当我进入或结束时，调试器不会转到源代码的下一行，而是将我带入 SDK 源代码。

我怎样才能避免这种情况，只查看我编写的源代码的调试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T05:06:08.807

需要在 Eclipse Preferences->Java->Debug->Step Filtering 中设置 Step Filtering 并添加要忽略的类

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:15:09.370

当您进入不是您编写的代码（即其他 dex 字节码）时会发生这种情况，因此您需要越过这些行。如果抛出异常也会发生这种情况，因此也要小心。否则，它应该可以正常工作。

您遇到了特定问题吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T02:41:13.357

当您不在您的代码中时 - 单击“Step Return”（右上箭头），您将返回到您的代码。

# c - 如何从 Objective-C 方法返回 C 指针引用？

> ID：10021415
> 
> 赞同：-1
> 
> 时间：2012-04-05T01:10:51.887
> 
> 标签：c, pointers, methods, return

如果你有一个在方法中定义的 C 指针，并试图从 Objective C 中的对象方法返回它，你将什么作为方法的返回对象类型？

例如，我正在使用将 UIImage 转换为 RGBA 图像映射的代码（如此处所示[）](http://iphonedevelopment.blogspot.com/2009/05/opengl-es-from-ground-up-part-6_25.html) - 但该代码存储了一个指向内存的 C 指针，该指针不清楚如何返回。

```
- (??what goes here??) returnTextureRGB
{
  // ... other code ...
  void *imageData = malloc(height*width *r);
  // ... other code ...
  return(imageData);
} 
```

声明返回的正确对象类型是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:14:24.530

我不知道为什么这与 C# 有关，但是 Objective-C 是 C 的超集，因此每个 C 语法也是有效的 Objective-C 语法。

只需`void*` 作为返回类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:18:02.390

好吧，您提到了 Objective-C，谈到了 C#……所以不清楚您到底在问什么。对于 C#，您可以使用您想要的任何类型，只要它的大小足以存储`sizeof(void *)`字节数（这取决于架构，即 86_64 架构上的 64 位）并且它具有相同的对齐方式（尽管可以解决对齐方式）。例如，[`ulong`](http://msdn.microsoft.com/en-us/library/t98873t4%28v=vs.80%29.aspx)会做。Objective-C 透明地支持 C，因此只需按原样使用指针数据类型。

# jquery - 如何使用 jquery 遍历克隆列表

> ID：10021422
> 
> 赞同：1
> 
> 时间：2012-04-05T01:12:03.757
> 
> 标签：jquery

如何使用 jquery 遍历克隆列表？

```
 <ul id=testList>
          <li><p> Test A </p></li>
          <li><p> Test B </p></li>
          <li><p> Test C </p></li>
          <li><p> Test D </p></li>
          <li><p> Test E </p></li>
     </ul> 
```

jquery代码...

```
 var $cloneList = $("#testList").clone();

         $cloneList.each(function()
         {
              alert($(this).html());
         }); 
```

问题是 alert 方法的输出显示了列表的内容：

```
 <p> Test A </p> 
```

我需要的是这样的ul列表的显示

```
 <li><p> Test A </p></li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:17:21.620

在 jQuery 中没有直接的方法来打印元素及其自己的标签，您可以做的是中间将元素包装在 div 中并打印它的 innerHtml：

```
$clonseList.each(function() {
   alert(this.outerHTML || $('<div />').append($(this).clone()).html());
}); 
```

上面不会修改 DOM，因为我们从不将额外内容附加`<div>`到文档中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:18:34.820

那么你试图迭代的是一个 li 元素的列表。每个都包含一些 html ( `"<p>text</p>`")。

鉴于您描述的场景，最快的方法是使用 outerHTML：

```
$cloneList.find('li').each(function(){
alert(this.outerHTML);
}); 
```

然而，发布更大范围的问题可能是谨慎的，因为看起来 .clone() 的结果可能不是您想要使用的结果。

# selenium-ide - Selenium IDE - 单选按钮错误

> ID：10021423
> 
> 赞同：0
> 
> 时间：2012-04-05T01:12:04.520
> 
> 标签：selenium-ide

Selenium IDE - 运行脚本时，selenium IDE 中的单选按钮出现错误。在我的脚本中，需要选择单选按钮（选择日期），但其错误消息“[error] Element id=radio250 not found”。它在这里停止执行。即使我使用另一个日期，它仍然会停在同一点。如何更改动态值？

我是测试行业的新手，希望对此有任何帮助。我知道它与 xpath 有关，但我不知道如何使用它；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:19:43.940

您可以使用以下替代方法来定位单选按钮

```
//input[@type='radio']
//input[@name='name_attribute' and @value='value_attribute'] 
```

或通过 xpath

```
xpath=(//*[@class="name of the class"]) 
```

或者，如果您的页面没有完全加载，那么您也将面临同样的问题 - 找不到元素。如果存在这种情况，请在执行单选按钮命令之前放置暂停命令

或提供您尝试定位的元素的 HTML

# macos - MacOS——如何使用 gcc/ld 将动态库与相对路径链接

> ID：10021428
> 
> 赞同：18
> 
> 时间：2012-04-05T01:13:23.993
> 
> 标签：macos, gcc, linker, ld, dynamic-library

如果您想了解动态链接，[这个问题](https://stackoverflow.com/questions/194485/how-do-i-create-a-dynamic-library-dylib-with-xcode)可能会很有趣。

该问题的一个答案提供了一个创建和使用动态库的绝妙示例。在此基础上，我做了一些简单的文件：

主.c：

```
extern void someFunction (int x);

int main (int argc, char** argv ) {
    someFunction(666);
} 
```

图书馆.c：

```
#include <stdio.h>

void someFunction (int x) {
    printf ("\nsomeFunction called with x=%d\n", x);
} 
```

生成文件：

```
main: mylibrary.c main.c
    gcc -c mylibrary.c
    gcc -dynamiclib -current_version 1.0 mylibrary.o -o libmylibrary.dylib
    gcc -c main.c
    gcc -v main.o ./libmylibrary.dylib -o main

clean:
    rm *.o
    rm main
    rm *.dylib 
```

到目前为止，一切都很好。如果我 make 然后在命令提示符下输入 ./main ，我会看到预期的输出：

```
someFunction called with x=666 
```

现在，我想把事情混为一谈。我创建了一个目录 hidelib，它是我的主目录的子目录。我在我的makefile中添加了一行：

```
main: mylibrary.c main.c
    gcc -c mylibrary.c
    gcc -dynamiclib -current_version 1.0 mylibrary.o -o libmylibrary.dylib
    gcc -c main.c
    mv libmylibrary.dylib hidelib     # this is the new line

clean:
    rm *.o
    rm main
    rm hidelib/*.* 
```

现在，我想在 makefile 中添加另一行，以便在 hidelib 子目录中找到 libmylibrary.dylib。我希望能够以相同的方式运行 ./main。我怎样才能做到这一点？

编辑：感谢您的回复。有很多选择固然很棒，但初学者只想要一个可行的具体选择。这是我在最后一行尝试的内容，但显然我不明白。makefile 执行时没有错误，但在运行时显示“找不到库”。

```
 gcc main.o -rpath,'$$ORIGIN/hidelib' -lmylibrary -o main 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-13T14:42:56.427

一个可行的具体选项是`install_name`在链接`.dylib`.

```
gcc -dynamiclib -install_name '$(CURDIR)/hidelib/libmylibrary.dylib' -current_version 1.0 mylibrary.o -o libmylibrary.dylib 
```

然后你可以正常链接到库：

```
gcc main.o -L '$(CURDIR)/hidelib' -lmylibrary -o main 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-05T01:56:38.800

您可能需要`-L` 添加到库搜索路径的编译器/链接器标志。

在链接后尝试移动内容，您需要一个`dyld`环境变量来搜索搜索位置。`man dyld`并且您应该能够获得有关`DYLD_LIBRARY_PATH`其他环境变量的更多信息。

`-install_name`但是，通常情况下，您在使用链接器标志链接到某个东西之前将库的安装名称设置为类似值，然后在使用该标志`@rpath/mylibrary.dylib`编译时将主可执行文件上的运行路径搜索路径设置为.`-rpath``@executable_path/hidelib`

有关更多信息，请参阅`install_name_tool`和 的`-rpath`&`-install_name`参数`ld`。

基本上，您尝试做的事情有很多选择。

# asp.net-mvc-3 - 缺少 sgen.exe

> ID：10021430
> 
> 赞同：0
> 
> 时间：2012-04-05T01:13:40.683
> 
> 标签：asp.net-mvc-3, sgen.exe

我正在尝试通过项目附带的 .BAT 文件构建 NopCommerce，但我收到一条错误消息，提示我缺少 sgen.exe。我已经查看了它应该在的所有地方，并在我的计算机上进行了搜索，但它不见了。

我有 VWD2010、.NET v4.0.30319 和 MVC3 和 4，但没有 sgen.exe。

我尝试在 VWD2010 中构建项目，但有一堆 Web 引用位于网站根目录之外。

我想我要么需要找到 sgen.exe 的副本并将其放在 .BAT 文件正在查找的位置，要么更好的是能够从 VWD2010 中发布它，但我不知道该怎么做。如果我右键单击解决方案，我没有发布选项？

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:32:09.137

NopCommerce V2.50 发布说明

我能够手动解决，并在 VWD 中发布了网站和管理员。

1、将Nop.Web发布到你选择的根目录下

2，在新创建的文件夹中创建一个目录并将其命名为 Administration

3，将 Nop.Admin 发布到根目录内新创建的管理目录。

4、复制Plugins目录（\Presentation\Nop.Web\Plugins），而不是根目录下的Plugins目录到你新项目的根目录。

5 将“所有文件”、dll 和其余文件从 Administration 目录中的 bin 目录复制到项目根目录下的 bin 目录中，不要替换重复文件，将有三个驻留在 Nop 的 bin 中。不在 Nop.Web 的 bin 中的管理员

你完成了。

干杯，

麦克风。

# ruby-on-rails - ruby on rails 来自 DB 的动态属性字段使用 method_missing 问题

> ID：10021431
> 
> 赞同：6
> 
> 时间：2012-04-05T01:13:52.680
> 
> 标签：ruby-on-rails, ruby, activerecord, attributes, metaprogramming

所以，以为我昨晚有这个工作，可以发誓。现在它没有工作，我想是时候寻求帮助了。

我在数据库中定义动态字段，半 EAV 风格，现在让我们说一下，我不想听听你对 EAV 是否​​是个好主意的意见:)

无论如何，我所做的与我过去所做的有点不同，基本上当添加一个属性（或字段）时，我创建一个添加列到特定属性表迁移并运行它（或删除它）——无论如何，因为中间有一个类别层，它是定义所有属性的直接关系，所以我不能使用实际的属性名称作为列名，因为属性是特定于类别的。

所以，如果它可以帮助你形象化

```
 Entity
    belongs_to :category

    Category
    has_many :entities

    EntityAttribute
    belongs_to :category

    EntityAttributeValue
    belongs_to :entity_attribute
    belongs_to :entity 
```

随着新属性的创建，EAV 表水平跨越，列标记为属性_1 属性_2，其中包含该特定实体的值。

无论如何——我试图在实体模型上使方法动态化，所以我可以调用@entity.actual_attribute_name，而不是@entity.entity_attribute_value.field_5

这是我认为有效的代码 -

```
 def method_missing(method, *args)

      return if self.project_category.blank?

      puts "Sorry, I don't have #{method}, let me try to find a dynamic one."
      puts "let me try to find a dynamic one"

      keys = self.project_category.dynamic_fields.collect {|o| o.name.to_sym }

      if keys.include?(method)
        field = self.project_category.dynamic_fields.select { |field| field.name.to_sym == method.to_sym && field.project_category.id == self.project_category.id }.first
        fields = self.project_category.dynamic_field_values.select {|field| field.name.to_sym == method }
        self.project_category_field_value.send("field_#{field.id}".to_sym, *args)
      end

    end 
```

然后今天当我回到代码时，我意识到虽然我可以在 rails 控制台中设置属性，并且它会返回正确的字段，但当我保存记录时，EntityAttributeValue 没有被更新（表示为 self.project_category_field_value，上面。 )

所以在进一步研究之后，看起来我只需要添加一个 before_update 或 before_save 回调来手动保存属性，这就是我注意到的地方，在回调中，它会重新运行 method_missing 回调，就好像对象被复制一样（并且新对象是原始对象的副本），或者什么，我不太确定。但是在保存过程中或之前的某个时刻，我的属性消失了。

所以，好吧，我想我在输入后回答了我自己的问题，我需要设置一个实例变量并检查它是否存在于我的 method_missing 方法的开头（对吗？）也许这不是发生了什么我不知道，但我也问是否有更好的方法来做我想做的事情。

如果使用 method_missing 是一个坏主意，请解释原因，因为在浏览有关方法缺失的帖子时，我听到一些人抨击它，但没有一个人愿意提供一个合理的解释来解释为什么方法缺失是一个糟糕的解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T09:03:39.810

您可以查看我的演示文稿，其中我描述了如何 [使用 ActiveRecord 将方法委托给关联模型 EAV](http://www.slideshare.net/stepanyuk/implementation-of-eav-pattern-for-activerecord-models-13263311)

例如，我们将**STI**用于我们的**产品**模型，并且我们为它们关联了**属性**模型。

首先我们创建抽象的**属性**模型

```
class Attribute < ActiveRecord::Base
  self.abstract_class = true
  attr_accessible :name, :value
  belongs_to :entity, polymorphic: true, touch: true, autosave: true
end 
```

那么我们所有的属性模型都继承自这个类。

```
class IntegerAttribute < Attribute
end

class StringAttribute < Attribute
end 
```

现在我们需要描述**基础**产品类

```
class Product < ActiveRecord::Base
  %w(string integer float boolean).each do |type|
    has_many :"#{type}_attributes", as: :entity, autosave: true, dependent: :delete_all
  end

  def eav_attr_model(name, type)
    attributes = send("#{type}_attributes")
    attributes.detect { |attr| attr.name == name } || attributes.build(name: name)
  end

  def self.eav(name, type)
    attr_accessor name

    attribute_method_matchers.each do |matcher|
      class_eval <<-EOS, __FILE__, __LINE__ + 1
        def #{matcher.method_name(name)}(*args)
          eav_attr_model('#{name}', '#{type}').send :#{matcher.method_name('value')}, *args
        end
      EOS
    end
  end
end 
```

因此，我们将`#eav_attr_model`作为**代理**方法的方法添加到我们的关联模型和`.eav`生成属性方法的方法中。

就是这样。现在我们可以创建继承自**Product**类的产品模型。

```
class SimpleProduct < Product
  attr_accessible :name

  eav :code, :string
  eav :price, :float
  eav :quantity, :integer
  eav :active, :boolean
end 
```

用法：

```
SimpleProduct.create(code: '#1', price: 2.75, quantity: 5, active: true)
product = SimpleProduct.find(1)
product.code     # "#1"
product.price    # 2.75
product.quantity # 5
product.active?  # true

product.price_changed? # false
product.price = 3.50
product.code_changed?  # true
product.code_was       # 2.75 
```

如果您需要一个更复杂的解决方案，它允许在运行时创建属性或使用**查询方法**获取数据，您可以查看我的 gem [hydra_attribute](https://github.com/kostyantyn/hydra_attribute)，它为 active_record 模型实现了**EAV**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T02:57:16.267

`method_missing`这是该部门正在进行的一些非常紧张的计划。你应该拥有的更像是这样的：

```
def method_missing(name, *args)
  if (method_name = dynamic_attribute_method_for(name))
    method_name.send(*args)
  else
    super
  end
end 
```

然后，您可以尝试将其分解为两部分。第一个是创建一个方法，该方法决定它是否可以处理具有给定名称的调用，here `dynamic_attribute_method_for`，第二个是有问题的实际方法。前者的工作是确保后者在被调用时工作，可能`define_method`用于避免在下次访问相同的方法名称时再次执行所有这些操作。

该方法可能如下所示：

```
def dynamic_attribute_method_for(name)
  dynamic_attributes = ...

  type = :reader

  attribute_name = name.to_s.sub(/=$/) do 
    type = :writer
    ''
  end

  unless (dynamic_attributes.include?(attribute_name))
    return
  end

  case (type)
  when :writer
    define_method(name) do |value|
      # Whatever you need
    end
  else
    define_method(name) do
      # Whatever you need
    end
  end

  name
end 
```

我不知道你的方法发生了什么，因为结构不清楚，而且它似乎高度依赖于你的应用程序的上下文。

从设计的角度来看，您可能会发现创建一个封装所有这些功能的专用包装类更容易。而不是调用`object.attribute_name`你会调用`object.dynamic_attributes.attribute_name`where 在这种情况下`dynamic_attributes`按需创建：

```
def dynamic_attributes
  @dynamic_attributes ||= DynamicAccessor.new(self)
end 
```

初始化该对象时，它将使用所需的任何方法预先配置自己，并且您不必处理此方法缺少的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T00:02:10.747

对于其他尝试做同样事情但遇到问题的人，据我所知，问题/解决方案是：

1）虽然我认为下面的代码会起作用：

```
self.project_category_field_value.send("field_#{field.id}".to_sym, *args) 
```

每次都会返回相关模型的新实例，这就是它丢失的原因。

2）需要手动保存相关对象，因为相关模型不会被保存。我最终在模型上放置了一个标志并添加了一个回调以保存相关模型，如果存在标志，例如

```
case(type)

when :writer
    self.update_dynamic_attributes=(true)
    etc...... 
```

然后回调，

```
 before_update :update_dynamic_attributes, :if => :update_dynamic_attributes?

  def update_dynamic_attributes?
    instance_variable_get("@update_dynamic_attributes")
  end

  def update_dynamic_attributes=(val)
    instance_variable_set("@update_dynamic_attributes",val)
  end

  def update_dynamic_attributes
    self.project_category_field_value.save
  end 
```

3）回到＃1，最大的问题是每次都返回新的对象实例。在问这个问题之前，我尝试使用 define_method 方法，但它对我不起作用，最终我需要做的是让它工作。-- 这个解决方案让我觉得很愚蠢，但我相信其他人也会遇到它，所以，如果你在活动记录类中直接使用 define_method，请确保你调用

```
self.class.send(:define_method, name) 
```

代替

```
self.send(:define_method, name) 
```

或者你会:(当它不起作用时

# javascript - java fx的webview中的JSexception？

> ID：10021433
> 
> 赞同：4
> 
> 时间：2012-04-05T01:13:56.247
> 
> 标签：javascript, javafx, javafx-2

我的 java Fx webview 为以下代码引发 JS 异常。谁能解释我为什么？

```
WebView webview = new WebView();
WebEngine webengine=webview.getEngine();
newtab.setText("Start Page");
newtab.setContent(webview);
editTabset.getTabs().add(newtab);
webengine.load("file:///E:/myproj/src/novuseditor/resources/html/clike.html");/*works till here*/
webengine.executeScript("document.getElementById('code').value=\"Hi\"");
/*exception:netscape.javascript.JSException: TypeError: 'null' is not an object */ 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-05T07:22:59.697

`webengine.load()`调用是异步的。在应用 javascript 之前，您需要等到文档加载完毕。例如：

```
 WebView webview = new WebView();
    final WebEngine webengine = webview.getEngine();
    webengine.getLoadWorker().stateProperty().addListener(
    new ChangeListener<State>() {
        public void changed(ObservableValue ov, State oldState, State newState) {
            if (newState == Worker.State.SUCCEEDED) {
                webengine.executeScript("document.getElementById('header').innerHTML = '<p>Hi</p>';");
            }
        }
    });
    webengine.load("http://stackoverflow.com");
    primaryStage.setScene(new Scene(webview, 400, 400)); 
```

WebEngine javadoc 中有一个示例。

# javascript - 返回 node.js 中多个 shell 命令的结果

> ID：10021437
> 
> 赞同：0
> 
> 时间：2012-04-05T01:14:32.470
> 
> 标签：javascript, node.js, asynchronous

所以我想要做的是循环遍历一组javascript对象（`sensors`），每个对象都带有`cmd`和`parser`属性，`cmd`在系统shell中运行每个对象，用适当的函数解析它的输出`parser`，并将结果字符串附加到服务器的`res`对象中。

第一个问题是我收到一个错误，声称当前对象没有方法`parser`。我尝试了一些不同的方法，但仍然无法识别对象的该属性。

第二个问题，当我放弃并在循环内硬编码解析函数时（这破坏了我添加需要不同解析器的命令的能力），因为每个命令的输出都是在回调函数中读取的，所以服务器运行`res.end()`之前回调返回，导致对浏览器的响应为空。

我对 node 和 javascript 很陌生，所以我确定我犯了一些初学者的错误，我似乎无法在脑海中解决它们。任何帮助，将不胜感激。

```
// requires
var http = require('http');
var exec = require('child_process').exec;

// parsers
var parseTemp = function(str) {
    return ((parseInt(str, 16) / 50 - 273.15).toFixed(2));
};

// sensors
var sensors = [
    {
        label:  "Object temp",
        cmd:    "i2cget -y 3 0x5a 0x07 w",
        parser: parseTemp,
        units:  " degrees C"
    },
    {
        label:  "Ambient temp",
        cmd:    "i2cget -y 3 0x5a 0x06 w",
        parser: parseTemp,
        units:  " degrees C"
    }
];

// server
http.createServer(function (req, res) {
    res.writeHead(200, {'Content-Type': 'text/plain'});
    for (var s in sensors) {
        exec(s.cmd, function (error, stdout, stderr) {
            res.write( s.label + ': ' + s.parser(stdout) + s.units + '\n' );
        });
    }
    res.end();
}).listen(1337, '');

console.log('Server running on port 1337'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:36:13.717

您的第一个问题是每个回调函数引用相同`s`变量的结果。您可以通过将`for(s in sensors)`循环更改为`sensors.forEach(function(s){...})`. 这将关闭（google javascript 关闭） s 并在时机成熟时使其成为每个回调的正确选择。可能还有其他问题 - 一旦我看到这个问题，我并没有那么努力。

你的第二个问题正是你所说的。在`res.end()`回调之前调用 - 因为它们是异步的，所以充其量将在当前执行的“线程”完成后调用。你可以用一个简单的计数器来解决这个问题：每次`exec`调用之前递增，每次回调递减并检查计数器是否已达到其初始值 - 如果是，则运行`res.end()`.

# php - 检查 foreach 循环中的数组是否为空

> ID：10021439
> 
> 赞同：1
> 
> 时间：2012-04-05T01:14:57.883
> 
> 标签：php, arrays, multidimensional-array, foreach

我正在尝试检查我的数组是否为空，但奇怪的是我无法让它工作。

```
foreach ($friend as $key => $id){

    $friendActivity = $db->friendActivity($id);

    if (!empty($friendActivity)) {

        //rest of the code

    }

} 
```

我在***if 语句***之前使用了**var_dump($friendActivity)**，结果如下：

 *```
array(0) { } array(0) { } array(0) { } array(0) { } array(0) { } array(0) { } 
```

//////---> 需要知道的事情 <--------/////////

我不是想查看数组的数量。数据库中的每个用户都有一些活动。我想看看这些活动是否与（活动投票）相匹配。因此，如果用户提到了他们的活动，则 $friendActivity 不会为空。

如果我使用空：

```
if (empty($friendActivity)){

    //rest of the code

} 
```

我能够进入if条件......

我个人认为，我必须在每个 foreach 循环结束时删除数组，这样我就不会存储其他用户的朋友活动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T01:19:27.013

`count()`应该给你一个准确的数组编号： http: [//php.net/manual/en/function.count.php](http://php.net/manual/en/function.count.php)

```
if (count($friendActivity) > 0) {
   ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-04T13:11:41.017

你可以试试这个解决方案：

```
if (sizeof($friendActivity) > 0) { 
```*

# powershell - 如何设置 MSMQ 集群队列的权限？

> ID：10021440
> 
> 赞同：1
> 
> 时间：2012-04-05T01:14:59.870
> 
> 标签：powershell, msmq, cluster-computing

我有一个具有正常运行的私有 MSMQ 3.0 队列的集群。我正在尝试以编程方式设置权限，但似乎无法通过队列上的 System.Messaging 进行连接。下面的代码在使用本地队列（并使用 .\ 本地队列的命名法）时工作得很好。如何以编程方式设置集群队列的权限？

从活动节点执行的 Powershell 代码

```
function set-msmqpermission ([string] $queuepath,[string] $account, [string] $accessright)
{
    if (!([System.Messaging.MessageQueue]::Exists($queuepath))){
    throw "$queuepath could not be found."
}
$q=New-Object System.Messaging.MessageQueue($queuepath)
$q.SetPermissions($account,[System.Messaging.MessageQueueAccessRights]::$accessright,            
  [System.Messaging.AccessControlEntryType]::Set)
}
set-msmqpermission "clusternetworkname\private$\qa1ack" "UserAccount" "FullControl" 
```

使用“3”参数调用“SetPermissions”的异常：“无效的队列路径名”。在 line:30 char:19 + $q.SetPermissions <<<< ($account,[System.Messaging.MessageQueueAccessRights]::$accessright,
+ CategoryInfo : NotSpecified: (:) [], MethodInvocationException + FullyQualifiedErrorId : DotNetMethodException

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T21:12:37.357

来自：[http ://winterdom.com/2011/10/using-powershell-with-clustered-msmq](http://winterdom.com/2011/10/using-powershell-with-clustered-msmq)

在使用 messageQueue 之前，您必须设置集群网络名称环境变量。

```
$env:_CLUSTER_NETWORK_NAME_ = 'myclusterMSMQ'
[System.Messaging.MessageQueue]::Create('.\Private$\MyQueue') 
```

将集群网络名称添加到脚本顶部应该可以解决问题

链接到我作为另一个问题的答案提供的完整（简单化 - 但适用于简单创建和分配烫发）脚本。 [https://stackoverflow.com/a/11268755/761599](https://stackoverflow.com/a/11268755/761599)

# c++ - 什么是堆排序和优先队列？

> ID：10021447
> 
> 赞同：-4
> 
> 时间：2012-04-05T01:16:25.237
> 
> 标签：c++, data-structures, priority-queue, binary-heap

对于我的 C++ 数据结构类，我们正在实现一个拨号调制解调器模拟器。我们的教授给了我们一个使用 STL 优先级队列的工作源文件，但我们的工作是通过实现二进制堆来替换它。今天我去找她寻求帮助，了解二进制堆到底是什么，但她基本上告诉我和我的朋友转移到 IT :(。她周一才开始谈论它，优先级队列和二进制堆，哪个她在一个小时内冲了过去，她今天开始谈论一个新主题，因为她的幻灯片还没有完成，所以她将在周五恢复二进制堆，这是程序到期的时候。

我明白这一点，二进制堆是优先级队列的后端。但是当元素被插入或弹出时我是否排序？她提到使用向量或列表，当你只是建造一棵树时，它在哪里发挥作用？我也不明白为什么这段代码适用于她：

```
typedef priority_queue<Event,vector<Event>,greater<Event> > PQ; 
```

这就是您声明 STL 优先级队列的方式吗？该程序很难描述，因此我将其粘贴在底部。它只是一个源文件。

注意：Random.h 仅具有根据某些统计分布返回随机数的函数。

调制解调器Simu.cpp：

```
#include <queue>
#include <vector>
#include <functional>  // for greater()
#include <climits>     // for INT_MAX
#include <iostream>
#include "random.h"
using namespace std;

class Event{
    enum { DIAL_IN = 1, HANGUP = 2 };
  public:
    Event( int name = 0, int tm = 0, int type = DIAL_IN )
         : time( tm ), who( name ), what( type ) { }
    bool operator> ( const Event & rhs ) const
      { return time > rhs.time; }
    friend class ModemSim;
  private:
    int who;        // the number of the user
    int time;       // when the event will occur
    int what;       // DIAL_IN or HANGUP
};

typedef priority_queue<Event,vector<Event>,greater<Event> > PQ; 

class ModemSim{
  public:
    ModemSim( int modems, double avgLen, int callIntrvl );
      // Add a call to eventSet at the current time,
      // and schedule one for delta in the future.
    void nextCall( int delta );

      // Run the simulation
    void runSim( int stoppingTime = INT_MAX );

  private:
    Random r;                       // A random source
    PQ eventSet;                    // Pending events

      // Basic parameters of the simulation
    int freeModems;                 // Number of modems unused
    const double avgCallLen;        // Length of a call
    const int freqOfCalls;          // Interval between calls
};

// Constructor for ModemSim.
ModemSim::ModemSim( int modems, double avgLen, int callIntrvl )
  : freeModems( modems ), avgCallLen( avgLen ),
    freqOfCalls( callIntrvl ), r( (int) time( 0 ) )
{
    nextCall( freqOfCalls );  // Schedule first call
}

// Place a new DIAL_IN event into the event queue.
// Then advance the time when next DIAL_IN event will occur.
// In practice, we would use a random number to set the time.
    void ModemSim::nextCall( int delta ){
    static int nextCallTime = 0;
    static int userNum = 0;

    eventSet.push( Event( userNum++, nextCallTime ) );
    nextCallTime += delta;
}

// Run the simulation until stopping time occurs.
void ModemSim::runSim( int stoppingTime ){
    static Event e;
    int howLong;

    while( !eventSet.empty( ) ){
        e = eventSet.top( );
        eventSet.pop( );
        if( e.time > stoppingTime )
            break;

        if( e.what == Event::HANGUP )    // HANGUP
        {
            freeModems++;
            cout << "User " << e.who << " hangs up at time "
                 << e.time << endl;
        }
        else                             // DIAL_IN
        {
            cout << "User " << e.who << " dials in at time "
                 << e.time << " ";
            if( freeModems > 0 )
            {
                freeModems--;
                howLong = r.negExp( avgCallLen );
                cout << "and connects for "
                     << howLong << " minutes" << endl;
                e.time += howLong;
                e.what = Event::HANGUP;
                eventSet.push( e );      // insert HANGUP
            }
            else
                cout << "but gets busy signal" << endl;
            nextCall( freqOfCalls );
        }
    }
}

// Simple main to test ModemSim class.
int main( )
{
    int numModems;
    int totalTime;
    double avgConnectTime;
    int dialInFrequency;

    cout << "Enter number of modems, length of simulation,\n"
         << " average connect time, how often calls occur: ";

    cin >> numModems >> totalTime >>
                    avgConnectTime >> dialInFrequency;

    ModemSim s( numModems, avgConnectTime, dialInFrequency );
    s.runSim( totalTime );

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T01:31:06.913

你没有文字吗？如果没有，我建议您在几乎任何数据结构文本中查找堆排序，例如 Aho、Hopcroft 和 Ullman。堆是一种二叉树，通常存储在数组（向量）中，其中树的左半部分位于数组的下半部分，右半部分位于数组的上半部分（递归）。您只需要数组中的索引来确定树中的位置（反之亦然）。堆实际上并没有保持排序；前面的元素始终是最小值（或者可能是最大值）；并且有一个通常称为 re-heapify 的操作，在添加或删除元素后需要 log n 时间来恢复堆属性。仅从正面移除。这应该让您了解堆和优先级队列和向量是如何相关的。

# c - 用于迭代多个数组的高效设计结构

> ID：10021454
> 
> 赞同：0
> 
> 时间：2012-04-05T01:17:23.727
> 
> 标签：c, arrays, loops

我有 20 个不同的可变长度数组，每个数组都有一个唯一值，我需要计算这些数组的所有可能组合：

```
#define LENGTH_COUNT 6
#define WIDTH_COUNT 4
etc, for all 20 arrays:

int length[LENGTH_COUNT];
int width[WIDTH_COUNT];
int height[HEIGHT_COUNT];
int weight[WEIGHT_COUNT];
int growth[GROWTH_COUNT];
int decay[DECAY_COUNT];
int sound[SOUND_COUNT];
int texture[TEXTURE_COUNT];
int moisture[MOISTURE_COUNT];
int volume[VOLUME_COUNT];
int speed[SPEED_COUNT];
int color[COLOR_COUNT];
int purpose[PURPOSE_COUNT];
int delay[DELAY_COUNT];
int vibrancy[VIBRANCY_COUNT];
int brix[BRIX_COUNT];
int ripeness[RIPENESS_COUNT];
int mold[MOLD_COUNT];
int temp[TEMP_COUNT];
int language[LANGUAGE_COUNT];

void iterate(void)
{
    for (int i = 0; i < LENGTH_COUNT; ++i)
          for (int j = 0; j < WIDTH_COUNT; ++j)
                for (int k = 0; k < HEIGHT_COUNT; ++k)
                // etc for all 20 arrays
                    int value = doSomething(length[i], width[j], height[k].....);
} 
```

必须有一种不那么脑残的方法来做到这一点。我的一个想法是：

```
#define ARRAY_COUNT  20
#define MAX_LENGTH 12   // the longest array length is 12
int arrays[ARRAY_COUNT][MAX_LENGTH]; 
```

但如果我要这样做，我不知道如何做与我在 iterate 函数中所做的等效的事情。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:33:00.660

您可以创建（未经测试/未编译）：

```
int *arrays[] = { first_arr, second_arr, ... }; // array of arrays
int maxes[] = { FIRST_ARR_MAX, SECOND_ARR_MAX, ... }; // array of array lengths
int counter[NUM_ARRAYS] = {0}; // initialize a counter to 0 for each of the arrays.

int state = 0;

while (true) {
    doSomething(first_arr[counter[0]], second_arr[counter[1]], ... );

    // Update the counter.
    int i;
    for (i = NUM_ARRAYS - 1; i >= 0; i--) {
        counter[i]++;
        // If incrementing the current counter didn't overflow, we're good, so we break.
        if (counter[i] < maxes[i]) {
            break;
        } else {
            // Overflow by setting the counter to 0.
            counter[i] = 0;
            // Now we will fall through and move to the next counter.
        }
    }
    // Check for all 0's intelligently.  State == 0 means counter[0] is 0.
    // If it's no longer 0, move to state 1.
    if (state == 0 && counter[0] > 0) {
        state = 1;
    } else (state == 1 && counter[0] == 0) {
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:04:55.557

这似乎有效，虽然我没有彻底测试过。它在 python 中，但希望很清楚如何在您的情况下使用。重要的一点是，它将问题划分为更容易的部分，以避免深度嵌套的 for 循环。

```
test_arrays = [[0, 1, 2], [3, 4, 5], [6, 7, 8]]
def combine(partial, next_array):
    new_array = []
    for p in partial:
        if not isinstance(p, list):
            p = [p]
        for v in next_array:
            new_array.append(p + [v])
    return new_array

def combinations(arrays):
    base = arrays[0]
    for i in xrange(1, len(arrays)):
        base = combine(base, arrays[i])
    return base

print combinations(test_arrays) 
```

但正如上面其他人所说，您几乎可以肯定根本不想这样做。更好的方法是选择随机组合并测试/评估它们。可以使用各种算法来改进朴素随机抽样，但哪种算法合适取决于您的应用程序。

# javascript - 加载 GeoRSS 文件后无法让 Google Maps API 缩小

> ID：10021456
> 
> 赞同：0
> 
> 时间：2012-04-05T01:17:28.850
> 
> 标签：javascript, google-maps

我正在尝试构建一个将 GeoRSS 文件导入谷歌地图的应用程序，但是我看到了奇怪的行为，在我导入文件后我无法缩小地图。它被放大到文件导入的第一个引脚。

例如，请参见下面的代码：

```
<script type="text/javascript">
  function initialize() {
    var myOptions = {
    zoom:0,
    mapTypeId: google.maps.MapTypeId.SATELLITE 
  };

var map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);
var georssLayer = new google.maps.KmlLayer('https://twitter.com/statuses/user_timeline/findingnewo.rss');
georssLayer.setMap(map);
map.setZoom(0);
  }

</script> 
```

有人见过类似的行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:23:34.110

这是你的答案：

[https://developers.google.com/maps/documentation/javascript/layers#KMLLayers](https://developers.google.com/maps/documentation/javascript/layers#KMLLayers)

添加 KML 图层时，默认行为是缩放和定位地图以适合图层内容。您可以提供一个选项来防止这种情况发生。

选项：

[https://developers.google.com/maps/documentation/javascript/reference#KmlLayerOptions](https://developers.google.com/maps/documentation/javascript/reference#KmlLayerOptions)

例子：

```
var options = { preserveViewport: true },
    georssLayer = new google.maps.KmlLayer('https://twitter.com/statuses/user_timeline/findingnewo.rss', options); 
```

# php - 在php中按创建日期对目录文件进行排序

> ID：10021458
> 
> 赞同：1
> 
> 时间：2012-04-05T01:17:52.413
> 
> 标签：php, sorting

这是我用来获取目录中文件数组的代码。

```
$dir = "thumbnails/";
$images = scandir($dir); 
```

如何按创建日期对 $images 数组进行排序？我找到了几种方法，但我无法让它们中的任何一种与我的阵列一起使用。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:23:55.647

在 Windows 上，您可以使用[`filectime()`](http://php.net/filectime). 只需将其与文件名放在一个数组中并对该数组进行排序即可。

大多数 *nix 文件系统不存储创建时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:29:48.453

尝试以下教程，其中包含有关如何按文件修改/创建排序的脚本。

[http://www.bitrepository.com/sort-files-by-filemtime.html](http://www.bitrepository.com/sort-files-by-filemtime.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T01:32:40.610

您必须手动排序

```
$dir = "thumbnails/";

function compare_time($a, $b)
{
    global $dir;

    $timeA = filectime("$dir/$a");
    $timeB = filectime("$dir/$b");

    if($timeA == $timeB) return 0;

    return ($timeA < $timeB) ? -1 : 1;
}

$images = scandir($dir);
usort($images, 'compare_time'); 
```

# android - Android 上的验证码？

> ID：10021460
> 
> 赞同：2
> 
> 时间：2012-04-05T01:18:06.993
> 
> 标签：android, httpclient, recaptcha

我想知道如何在我的 Android 应用中使用 reCAPTCHA？现在，我被卡住了，我可以使用 HttpClient 请求获取 HTML 代码，但我不知道如何处理它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:45:01.150

我没有实施验证码的经验。但对我来说，你似乎想通过这样的调用将你的 html 字符串传递给[WebView ：](http://developer.android.com/reference/android/webkit/WebView.html)

```
wv.loadData(htmlStr,"text/html", "UTF-8"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-15T15:21:38.943

[reCaptcha android 库](https://developer.android.com/training/safetynet/recaptcha.html)将解决您的问题。

它是谷歌播放服务的一部分。

# batch-file - 将字符添加到 txt 文件中每行的开头和结尾的批处理文件

> ID：10021464
> 
> 赞同：9
> 
> 时间：2012-04-05T01:19:23.300
> 
> 标签：batch-file, cmd

我有一个文本文件，我想知道有人有一个批处理文件要在文本文件的每一行末尾添加“到 beninning 和”吗？

例如我有

```
1
2
3 
```

而且我要

```
"1",
"2",
"3", 
```

如果有人可以快速粘贴一个它会帮助我=）

编辑（从评论到@mastashake57 的帖子）：

我在 Windows 上，如果我觉得我是在要求某人做这件事，我很抱歉，这就是我所拥有的。

```
@echo off 
setlocal 
set addtext=test 
for /f "delims=" %%a in (list.txt) do (echo/|set /p =%%a%addtext% & echo\ & echo) >>new.txt 
```

但我不知道如何放置逗号，因为它认为它是我假设的命令的一部分或类似的东西。这只会将文本放置在每行的字体中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T01:41:42.397

```
@echo off
setLocal EnableDelayedExpansion
for /f "tokens=* delims= " %%a in (input.txt) do (
set /a N+=1
echo ^"%%a^",>>output.txt
) 
```

-乔德夫

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T01:28:44.543

在我的脑海中，在 Linux 中，你可以...

```
$ for each in `cat filename` ; do echo \"$each\", ; done >> newfilename

"1",
"2",
"3",
"4",
"5", 
```

已编辑 - 因为它适用于 Windows，所以这对我有用：

```
@echo off
setLocal EnableDelayedExpansion

for /f "tokens=* delims= " %%a in (filename.txt) do (
echo "%%a", >>newfilename.txt
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-25T08:52:31.473

```
set "f=PATH\FILE.txt"
call :add_str_beginning_end_each_line "BEGIN_LINE--" "--END_LINE" "%f%"

REM : Adds strings at the beginning and end of each line in file
:add_str_beginning_end_each_line
    set "str_at_begining=%~1"
    set "str_at_end=%~2"
    set "input_file=%~3"

    set "tmp_file=tmp.ini"

    REM : >NUL => copy command is silent
    REM : Make a backup
    copy /Y "!input_file!" "!input_file!.bak" >NUL
    copy /Y "!input_file!" "!tmp_file!" >NUL
    del "!input_file!"

    REM : Add strings at each line
    for /f "delims=" %%a in (!tmp_file!) do (
        >>"!input_file!" echo !str_at_begining!%%a!str_at_end!
    )

    REM : delete backup
    del "!tmp_file!"
    del "!input_file!.bak"

    REM : exiting the function only
    EXIT /B 0 
```

您可以编辑代码：

```
 "!input_file!" echo !str_at_begining!%%a!str_at_end! 
```

通过删除 !str_at_end! 仅在行首添加 str ，其中 %%a 是实际行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-25T10:06:58.063

该脚本使用`FOR`循环计数行数，并[`FOR /L`](https://ss64.com/nt/for_l.html)逐行`SET /P`读取文件：

```
@echo off
SETLOCAL EnableDelayedExpansion

::Initialize SUB character (0x1A)
>nul copy nul sub.tmp /a
for /F %%S in (sub.tmp) do set "sub=%%S" SUB CHARACTER

::Variables
;set "lines=-1" Exclude LAST line
set "in=<CHANGE THIS>"
set "out=text.txt"

::Count lines
FOR /F tokens^=*^ delims^=^ eol^= %%L in (
'2^>nul findstr /N "^" "%in%"'
) do set /a "lines+=1"

::Read file using SET /P
>newline.tmp <"!in!" (
  for /L %%a in (1 1 %lines%) do (
    set "x=" For EMPTY lines
    set /p "x="
    echo("!x!",
  )
    ;set "x="
    ;echo("!x!",!sub!
)

::Trim trailing newline appended by ECHO
;copy newline.tmp /a "!out!" /b
;del sub.tmp newline.tmp 
```

[这个答案](https://stackoverflow.com/a/61322494/12861751)解释了计算行数的万无一失的方法。
利用`SUB`字符 (0x1A) 来修剪尾随换行符，在[DosTips](https://www.dostips.com/forum/viewtopic.php?t=4213)上进行了讨论。如果您不想修剪它们，只需注释掉以 . 开头的行`;`。

# youtube - 为什么 YouTube 上视频的观看次数明显错误，而且总是如此？

> ID：10021468
> 
> 赞同：2
> 
> 时间：2012-04-05T01:20:07.997
> 
> 标签：youtube

通常，对于非常受欢迎的视频，我会看到一个荒谬的观看次数。例如，请参阅[来自 Google 的此视频](http://www.youtube.com/watch?v=9c6W4CCU9M4)：

在此处查看查看次数：http: [//i.stack.imgur.com/YV7yO.png](http://i.stack.imgur.com/YV7yO.png)

显然，一个视频不能有 305 次观看，但不能有 22,000 多个点赞。我以前见过这种情况，至少几个月前。我想知道：

*   这个计数器是否总是关闭，或者我可以确定这个值是正确的，“实时”的视图计数？
*   你知道*为什么*会这样吗？YouTube 应该具备解决此类问题的技术能力吗？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:27:36.243

该视频于 2012 年 4 月 4 日发布。它目前只有 305 次观看，但有 23,000 次喜欢和 750 次不喜欢。它还有超过 305 条评论。

我的猜测是视图每小时或每天更新一次。所以它可能会关闭，直到 youtube 下次计算访问次数。我的猜测是，这是由于避免了相同 IP 地址的重复视图。它可以使用 cookie 作为一种确定它是否也是独特视图的方式。无论如何，它可能无法立即更新视图计数，因此它必须在定期安排的时间间隔内更新，或者只是在服务器有时间重新计算时更新。

我只打扰到第 100 页评论，因为我看不到最后一条评论的方法。第 100 页上的最后一个条目仅在 1 小时前。所以我猜它是最近添加的，一定是通过推文传播得如此之快。所以也许它在一小时前只有 305 次观看。我会在一个小时内检查，并让您知道视图是否进一步增加。

编辑

经过更多研究，该视频于 11 小时前由谷歌更新。所以我不猜测它不是每小时计算的。必须每 12 小时或 24 小时计算一次。正如另一个人所暗示的那样，这可能是由于服务器端缓存而不是计算的一部分，或者可能是两者兼而有之。除非我们认识谷歌的程序员，否则我们可能永远不会知道。

在视频发布 24 小时后编辑，它有 1,870,649 次观看和 43,917 次喜欢和 1,659 次不喜欢。在这一点上，我假设视图是根据某个时间段缓存或计算的。它也可能与视频是否被完全观看有关，但我认为这并不能完全解释这些数字以及与喜欢和不喜欢相比观看次数的巨大延迟。

视频发布 32 小时后编辑 4,807,821 次观看 52,066 次喜欢，2,040 次不喜欢。所以我肯定会说这是由于缓存或一些定时的服务器端计算更新了值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-20T12:09:26.817

这样做似乎是为了减少 youtube 上的观看次数，因为该网站正在向观看次数多的人付款，并且他们有一些标准，因此他们不愿意增加所有类型视频的观看次数。他们不为喜欢付费，因此喜欢可以从观看次数中增加。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-05T01:37:58.137

可能是由于缓存了视图统计信息

# iphone - 如何使用 AVFoundation.framework 将文本与视频结合起来

> ID：10021469
> 
> 赞同：1
> 
> 时间：2012-04-05T01:20:09.790
> 
> 标签：iphone, date, video, avfoundation

请教我如何使用 AVFondation.framework 在视频中插入文本。我想将当前日期和时间与录制视频结合起来。

我尝试使用 CALayer，但我做不到。

所以请给我这个问题的解决方案。

谢谢你。

太田恭平

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:33:02.510

简单地说，你应该做一个标签。显然，使用 CALayer 是可以实现的，但这也许根本就无法解决。

首先，您应该为moviePlayerView 添加一个标签。

```
|                   |
|  moviePlayerVew   |
|                   |
|                   |
|[Your Label]       | 
```

我推荐以下代码。

如果您想了解更多关于下面的代码，请参阅此处。

[https://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVPlayer_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40009530](https://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVPlayer_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40009530)

和

[https://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/02_Playback.html](https://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/02_Playback.html)

简单说一下，玩家每秒跑10次会产生格挡部分。

```
[yourPlayer addPeriodicTimeObserverForInterval:CMTimeMakeWithSeconds(0.1, NSEC_PER_SEC) queue:queue usingBlock:^(CMTime time)
{
 yourLabel.text = @"your string".
} 
```

# android - Android 模拟器 sd 卡映像已在使用中

> ID：10021471
> 
> 赞同：2
> 
> 时间：2012-04-05T01:20:43.270
> 
> 标签：android, android-emulator, android-sdcard

我已经按照[这个](https://stackoverflow.com/questions/9913247/android-virtual-device)问题的答案没有成功。我无法回复发布的答案（缺乏声誉），所以我不得不提出一个新问题。

清除所有*adb*进程并不能缓解“SD 卡映像已在使用”错误。同样，如果我删除 SD 卡映像，创建一个新映像，然后*立即*启动模拟器，错误仍然存​​在。模拟器加载到手机主屏幕后，会显示“已移除 SD 卡”消息。这是调用模拟器时我的命令行的样子：

jet98f@rc04ucs213:/mnt/dfs/jet98f/Users/jet98f/android-sdk-linux/tools$ emulator -avd Phone -sdcard sdcard.iso

警告：数据分区已在使用中。变化不会持续！

警告：SD 卡映像已在使用中：sdcard.iso

警告：缓存分区已在使用中。变化不会持续！

无法将 /nethome/users/jet98f/.pulse/f4ac236e8e0d8ef32a8796d24e3c758b-runtime 符号链接到 /tmp/pulse-2L9K88eMlGn7：不支持操作

模拟器：模拟器窗口不在视野范围内，并已居中

编辑：还有一件事：运行 'lsof | grep sdcard ' 没有回报。也就是说，UNIX 实用程序说该文件未打开，但 adb 声称该映像已在使用中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T17:25:11.090

删除锁定pid文件？

我在 Windows7 上，SD 卡映像也有同样的问题，以及 Eclipse 不想与 Adb 连接的一般问题。状态似乎不同步。

在 Windows 中，有锁定文件。在我的情况下（环境，如果你愿意的话）它是`C:\Users\joe\.android\avd\Em22.avd\xxx\pid`

其中 xxx 是：

*   缓存.img.lock
*   硬件-qemu.ini.lock
*   sdcard.img.lock **<<<---**
*   用户数据-qemu.img.lock

当eclipse的状态似乎丢失时，我关闭了所有东西，并删除了锁定目录中的pid文件。它至少在 Eclipse 无法与 adb 连接的情况下做到了这一点，并且当它连接时，抱怨锁定了 sd 卡图像。

哎呀，我只是注意到它在原始问题的链接中得到了相同的回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-29T02:43:42.160

这是解决方案，1）打开任务管理器。2）从列表中关闭所有正在运行的模拟器。3) 如果正在运行，请关闭 bluestack 程序。4) 现在你完成了。您现在可以运行新模拟器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T04:01:07.330

sdcard 映像应该是可写的 FAT32 映像文件。看到[这个链接](https://developer.android.com/studio/command-line/mksdcard.html)

看来您正在使用 ISO 映像。

如果您真的怀疑有另一个进程（模拟器）使用特定的 sdcard 映像，您可以通过运行来确认它

```
$ fuser ~/.android/avd/4.0.3.avd/sdcard.img 

~/.android/avd/4.0.3.avd/sdcard.img: 90719 
```

在这种情况下，有一个模拟器正在运行（*或其他打开文件的东西*）（pid 90719）。

# iphone - 当我分配 NSError userInfo 来设置 NSDictionary 时，为什么我的应用程序会崩溃？

> ID：10021472
> 
> 赞同：0
> 
> 时间：2012-04-05T01:21:17.973
> 
> 标签：iphone, objective-c, nsdictionary, nserror

```
NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:@"Please, other format selected.", NSLocalizedDescriptionKey, @"This format is not available.", NSLocalizedFailureReasonErrorKey, @"The operation couldn't be completed.", NSUnderlyingErrorKey, self.URL, NSURLErrorKey, nil];

NSLog(@"dict:%@", dict); // no Crash

NSError *error = [NSError errorWithDomain:@"testError" code:1 userInfo:dict];// crash 
```

为什么分配错误对象时崩溃？

* * *

以下是崩溃详情：

```
+[__NSCFConstantString objectForKey:]: unrecognized selector sent to class 0x3ebf5550 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T01:46:24.670

IIRC`NSUnderlyingErrorKey`应该是`NSError`.

从文档：

> 用户信息字典有时可以包含另一个`NSError`对象，该对象表示子系统中的错误，该子系统由包含`NSError`. 您可以查询此基础错误对象以获取有关错误原因的更具体信息。
> 
> 您可以使用`NSUnderlyingErrorKey`字典键访问底层错误对象。

# git - 回到 master 将更改推送到 Heroku

> ID：10021479
> 
> 赞同：0
> 
> 时间：2012-04-05T01:22:20.717
> 
> 标签：git, heroku

我开始理解 git，但我仍然在抽象方面遇到了一些麻烦。我检查了以前的版本，通过简单的方式进行了一些更改：

```
git checkout [commit id] 
```

我收到消息 HEAD 已移动到一个新的这个新的提交 ID。我进行了我需要的更改并添加并提交了它们。但是，当我尝试将更改推送到 Heroku 时，我收到了所有内容都是最新的消息。我知道这不可能，所以我假设当我回到以前的版本并提交更改时，我做了一些替代分支。

所以我然后尝试：

```
git merge master 
```

当它尝试自动合并我一直在处理的文件时出错。所以我清理了文件中出现的冲突并添加并提交了更改并做了：

```
git merge master 
```

然而，这一次我收到了“已经是最新的”消息。当我尝试将更改推送到 Heroku 时，当我跳回几个版本时，该文件仍处于我离开它的状态。我不太确定如何让我所做的更改出现......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:55:59.777

你在一个“分离的头”上。您不在任何分支上，这使得许多 git 操作变得困难。

首先要做的是`git checkout -b <new branch name>`。这样，至少，您将有一个名称来引用您当前的状态。

接下来我们必须弄清楚你实际上想要做什么。您检查了“以前的版本进行一些更改”？您希望如何处理这些更改？你不能编辑过去。（嗯，你可以，但这是非常不寻常的，你现在应该忽略它。）你可以在一个分支上添加新的东西，或者你可以创建一个新的分支来保存项目的另一个版本。

很可能，您应该在 master 的提示下进行更改，提交它们然后推送它们。

或者，如果你想创建一个分支，你应该已经完成​​了`git checkout -b <new branch name> <id of commit to form base of new branch>`. 然后，您可以使用类似`git push origin <new branch name>`. 建立一个分支将是为您的项目的旧版本发布错误修复。（实际上，根据您的工作流程，您可能应该进行分支以发布之前的版本，并且您的错误修复将在该预先存在的分支之上进行。）

我担心你所做的合并让你处于难以优雅恢复的状态。如果您所做的更改不大，您可能只是重新创建它们并折腾您当前的状态。或者，如果您可以找到包含更改的提交，您可以重置为`master`然后选择它。您可以使用`git whatchanged master..`来查找该提交。

# codeigniter - 可以在 CodeIgniter 的模型中调用另一个模型中的方法吗？

> ID：10021481
> 
> 赞同：22
> 
> 时间：2012-04-05T01:22:43.480
> 
> 标签：codeigniter

可以在 CodeIgniter 的模型中调用另一个模型中的方法吗？我试了一下，在我自动加载所有模型后它似乎工作了。

但是，模型的顺序是否重要？仅仅因为它对我有用一次并不意味着它一直有效。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-05T01:57:18.563

是的，您可以在 Code Igniter 的模型中调用另一个模型中的方法。您需要加载要调用方法的模型。如果您自动加载所有模型，它将始终有效。自动加载的顺序无关紧要。

当我想在另一个模型上调用一个方法时，我通常会在使用它之前加载那个模型。例如：

```
class User_model extends CI_Model
{
  function test()
  {
    $this->load->model('Blog_model', 'blog');
    $result = $this->blog->method_on_blog_model();
  }
} 
```

# c# - 删除位图c#上的alpha chanel（仅限纯色切片图像）

> ID：10021483
> 
> 赞同：1
> 
> 时间：2012-04-05T01:23:15.903
> 
> 标签：c#, image-processing, bitmap

我想得到两个图像之间的区别

我使用这个源代码：

```
 public Bitmap GetDifference(Bitmap bm1, Bitmap bm2)
        {

            if (bm1.Size != bm2.Size)
                throw new ArgumentException("exception");

            var resultImage = new Bitmap(bm1.Width, bm1.Height);

            using (Graphics g = Graphics.FromImage(resultImage))
                g.Clear(Color.Transparent);

            for (int w = 0; w < bm1.Width; w++)
            {
                for (int h = 0; h < bm1.Height; h++)
                {
                    var bm2Color = bm2.GetPixel(w, h);
                    if (IsColorsDifferent(bm1.GetPixel(w, h), bm2Color))
                    {
                        resultImage.SetPixel(w, h, bm2Color);                    
                    }                  
                }
            }

            return resultImage;
        }

        bool IsColorsDifferent(Color c1, Color c2)
        {
            return c1 != c2;
        } 
```

这个来源对我很有用，但我有以下问题：

例如，如果我选择分辨率为 480x320 的图像，我的 resultImage 具有相同的分辨率（这是正确的，因为我在创建新位图时设置了），但我的图像具有透明色，我只想获得纯色的结果图像.

让我们说 - 如果 480x320 中的纯色结果图像（纯色像素）具有 100x100 字段，我应该只获得分辨率为 100x100 的纯色位图。

简而言之，我只需要获得以纯色和 alpha chanel 为边界的矩形。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T13:21:26.117

请参阅我在下面写的课程：

```
class ProcessingImage
    {         
        public Bitmap GetDifference(Bitmap bm1, Bitmap bm2)
        {            
            if (bm1.Size != bm2.Size)
                throw new ArgumentException("Images must have one size");

            var resultImage = new Bitmap(bm1.Width, bm1.Height);

            using (Graphics g = Graphics.FromImage(resultImage))
                g.Clear(Color.Transparent);

            int min_height = int.MaxValue;
            int min_width = int.MaxValue;
            int max_height = -1;
            int max_width = -1;

            for (int w = 0; w < bm1.Width; w++)
                for (int h = 0; h < bm1.Height; h++)
                {
                    var bm2Color = bm2.GetPixel(w, h);
                    if (IsColorsDifferent(bm1.GetPixel(w, h), bm2Color))
                    {
                        resultImage.SetPixel(w, h, bm2Color);
                        if (h < min_height) min_height = h;
                        if (w < min_width) min_width = w;
                        if (h > max_height) max_height = h;
                        if (w > max_width) max_width = w;
                    }                    
                }

            max_height = max_height + 1;    //Needed for get valid max height point, otherwise we lost one pixel.
            max_width = max_width + 1;      //Needed for get valid max width point, otherwise we lost one pixel.

            // Calculate original size for image without alpha chanel.

            int size_h = max_height - min_height;
            int size_w = max_width - min_width;

            var resizeImage = new Bitmap(size_w, size_h); // Creaete bitmap with new size.

            for (int w = 0; w < resultImage.Width; w++)
                for (int h = 0; h < resultImage.Height; h++)
                {
                    var color = resultImage.GetPixel(w, h);
                    if (color.A != 0)
                    {
                        // Move each pixels at a distance calculate before.
                        int x = w - min_width;
                        int y = h - min_height;
                        resizeImage.SetPixel(x, y, color);
                    }
                }           

            return resizeImage;
        }

        bool IsColorsDifferent(Color c1, Color c2)
        {
            return c1 != c2;
        }
    } 
```

我认为，这个类可以修改优化，但现在效果很好。如果您需要返回具有原始大小且没有 alpha 通道的图像 - 这是众多解决方案之一。

# codeigniter - CodeIgniter 无需回调即可验证表单数据的方法

> ID：10021485
> 
> 赞同：0
> 
> 时间：2012-04-05T01:23:31.257
> 
> 标签：codeigniter, frameworks, validation

我的配置文件中有以下数组：

```
$config['reg_datas'] = array(
    'high' => array(
        7  => 200,
        30 => 500
    ),
    'box' => array(
        7   => 125,
        30  => 350
    ),
    'shots' => array(
        7   => 25,
        30  => 50
    )
); 
```

所以，参考 CI 的手册，我正在使用这个验证规则来验证我的表单数据：`callback__validate_high`......而且我必须使用这个回调函数：

```
public function _validate_high($input)
{
    $cfg = $this->config->item('reg_datas');
    if ( !array_key_exists($cfg['high'], $input)
    {
        $this->form_validation->set_message('_validate_high', 'Invalid High Field...');
        return FALSE;
    }

    return TRUE;
} 
```

问题是; 每次我需要检查时，我真的必须创建一个新的回调`array_key_exists`吗？上面的代码只是一个验证规则（对于一个数组），但我的配置文件中有 3 个数组（可能很快会有更多） - 所以我真的必须为这样的简单检查创建 3 个回调函数吗？

CodeIgniter 是我正在学习的第一个框架，我希望尽可能地学习它，我真的很关心这样的事情，因为我不想浪费我的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:38:37.097

首先，您的语法`array_key_exists()`错误，键是第一个属性，第二个是数组。像这样：`array_key_exists($input, $cfg['high']);`。

并且为了验证，做一个通用的函数，而不是一个一个地检查键。还将错误代码放在配置文件上。

```
$config['reg_datas_error'] = array(
  'high' => 'Invalid High Field',
  'box' => 'Invalid box Field',
  'shots' => 'Invalid Shots Field'
); 
```

和你共同的验证功能

```
public function _validate_field($input, $key)
{
   $cfg = $this->config->item('reg_datas');
   $cfg_error = $this->config->item('reg_datas_error');
   if ( !array_key_exists($input, $cfg[$key])
   {
      $this->form_validation->set_message('_validate_'.$key, $cfg_error[$key]);
      return FALSE;
   }

   return TRUE;
} 
```

请注意，这些只是示例，您可以改进或做其他方式。只是主要逻辑如何进行一般验证

# actionscript-3 - swf 在 CPU 上非常激烈

> ID：10021490
> 
> 赞同：1
> 
> 时间：2012-04-05T01:23:43.667
> 
> 标签：actionscript-3, memory-leaks, flash, gsap

如果有人在过去几天看到我发布了很多关于这个项目的问题，我非常感谢大家的帮助。有很多麻烦和最后期限即将到来。

示例文件（fla 和 swf）位于此处：

[http://www.mediafire.com/download.php?ejy6j9h9r1c1829](http://www.mediafire.com/download.php?ejy6j9h9r1c1829)

如果你加载 .swf，它对 cpu 和 ram 的使用会非常紧张，我不知道如何修复它。上面链接中的那个 .swf 只加载了两个视频，其中我真正的一个正在加载大约 45 个视频（总共 78MB）并且它们都使用大约相同的 cpu 使用率。加载更多视频的那个也使用了近 1GB 的内存。

我不知道如何找到主要问题。我得到了很多帮助，所以代码根本没有优化或重构。它每三秒重复调用一个 php 文件 (flashpull.php) 以检查我服务器上数据库中的变量。当我检查本地存储时，它无限地在服务器上放置了越来越多的“flashpull.php”文件，但该文件只有 2KB，我认为这不会导致 swf 变得如此密集。有没有一种方法可以让我继续检查该文件，但覆盖本地存储副本，或者这甚至有什么大不了的？

我正在使用 greensock 加载所有视频，我将 maxConnections 设置为 6，不知道这是否会影响它。

我真的希望有一个明显的问题或内存泄漏，而不是整个文件过于臃肿以至于导致性能如此糟糕。非常感谢任何帮助，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:40:49.967

您似乎对视频容器应用了 3D 旋转。在舞台上，选择剪辑“rewinder”，然后在 Property Inspector -> 3D 位置中，您将看到 Y 旋转 -1。这意味着每一帧，Flash 都会将您的视频渲染为位图并应用轻微的 3D 转换。这是非常昂贵的，我有一种感觉，不是故意的。;)

要修复，修改 > 变换 > 删除变换 (ctrl-shift-Z)。或者只是将 Y 旋转设置回零也可以。

# asp.net - Asp.net Forms 身份验证 - 主体更改？

> ID：10021496
> 
> 赞同：1
> 
> 时间：2012-04-05T01:25:11.830
> 
> 标签：asp.net, c#-4.0, webforms

我在表单身份验证方面遇到了一个奇怪的问题。我有自己的自定义主体和身份类，登录后我将 HttpContext.Current.User 设置为此主体，并将其存储在缓存 (HttpContext.Current.Cache) 中。似乎经过一段时间后，奇怪的行为开始了。这是我的 AuthenticateRequest 处理程序：

```
protected void Application_AuthenticateRequest( object sender, EventArgs e ) {
    string userName;

    var formAuthCookie = HttpContext.Current.Request.Cookies[ FormsAuthentication.FormsCookieName ];
    var isAuthenticated = HttpContext.Current.Request.IsAuthenticated;

    if ( isAuthenticated || formAuthCookie != null ) {
        if ( !isAuthenticated ) {
            var ticket = FormsAuthentication.Decrypt( formAuthCookie.Value );
            userName = ticket.Name;
        }
        else {
            userName = HttpContext.Current.User.Identity.Name;
        }

        var prin = (IPrincipal)HttpContext.Current.Cache[ userName ];

        if ( prin != null ) {
            HttpContext.Current.User = prin;
        }
    }
} 
```

这总是很好用；自定义主体从缓存中提取并正确设置为当前上下文的用户。

问题是当我加载页面时，Page.User 属性有一个 GenericPrincipal（没有角色）和一个 FormsIdentity。我不知道这是在哪里发生的。当然，由于用户没有担任适当的角色，因此该页面无法正常工作，尽管 FormsAuth 让他们进入角色受限页面。

任何想法为什么我在 AuthenticateRequest 处理程序中设置的主体被替换？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-05T14:44:46.863

试试这个：

```
var formAuthCookie = Context.Request.Cookies[ FormsAuthentication.FormsCookieName ]; 
var isAuthenticated = Context.Request.IsAuthenticated; 

if ( isAuthenticated || formAuthCookie != null ) { 
    if ( !isAuthenticated ) { 
        var ticket = FormsAuthentication.Decrypt( formAuthCookie.Value ); 
        userName = ticket.Name; 
    } 
    else { 
        userName = Context.User.Identity.Name; 
    } 

    var prin = (IPrincipal)Context.Cache[ userName ]; 

    if ( prin != null ) { 
        Context.User = prin; 
    } 
} 
```

# jquery - 使用 AJAX 和 Jquery 保存 tinymce 编辑器

> ID：10021500
> 
> 赞同：4
> 
> 时间：2012-04-05T01:25:42.050
> 
> 标签：jquery, ajax

我一直在阅读与此问题类似的问题并且已经能够走得很远，但显然我的情况略有不同，所以我仍在努力解决这个问题。

我有一个表单，其中包含使用 Tinymce html 编辑器设置样式的文本区域。我希望 textarea 使用 AJAX 自动保存。

我一直在使用基于时间间隔保存文本区域的代码：

```
$(document).ready(function() {

$(function() {
// Here we have the auto_save() function run every 30 secs
    // We also pass the argument 'editor_id' which is the ID for the textarea tag
    setInterval("auto_save('editor_id')",30000);
}); 
```

});

```
// Here is the auto_save() function that will be called every 30 secs
function auto_save(editor_id) {

// First we check if any changes have been made to the editor window
    if(tinyMCE.getInstanceById(editor_id).isDirty()) {
    // If so, then we start the auto-save process
        // First we get the content in the editor window and make it URL friendly
        var content = tinyMCE.get(editor_id);
        var notDirty = tinyMCE.get(editor_id);
        content = escape(content.getContent());
        content = content.replace("+", "%2B");
        content = content.replace("/", "%2F");
        // We then start our jQuery AJAX function
        $.ajax({
        url: "PAFormAJAX.asp", // the path/name that will process our request
            type: "POST", 
            data: "itemValue=" + content, 
            success: function(msg) {
                alert(msg);
                // Here we reset the editor's changed (dirty) status
                // This prevents the editor from performing another auto-save
                // until more changes are made
                notDirty.isNotDirty = true;
            }
        });
        // If nothing has changed, don't do anything
    } else {
        return false;
    }
} 
```

这是可行的，但我的问题是，表单元素是动态创建的，所以我并不总是有可以使用的静态 editor_id。如何更新它以接受动态 ID？

例如，这里有一个文本区域，它的 id 是用 ASP 动态设置的：

```
<textarea id="Com<%=QuesID%>" row= "1" cols= "120" name="Com<%=QuesID%>" QuesID="<%=QuesID%>" wrap tabindex="21" rows="10" class="formTxt"><%=TempTxt%></textarea> 
```

此外，我试图找出一种方法，不仅可以在时间间隔内调用 save 函数，还可以在用户单击 textarea 并失去焦点时调用。我不确定如何做到这一点，因为 TinyMce 显然将其从 textarea 更改为 iframe。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T01:35:44.550

`tinyMCE.editors`将使您可以访问页面上的所有编辑器。请参阅[http://www.tinymce.com/wiki.php/API3:property.tinymce.editors](http://www.tinymce.com/wiki.php/API3%3aproperty.tinymce.editors)。

因此，您可以将代码更改为

```
$(document).ready(function() {
    setInterval(function() { 
        for (edId in tinyMCE.editors)
            auto_save(edId);
    },30000);
}); 
```

不过，这将每 30 秒保存一次页面上的*每个编辑器。*我不确定这是否是你想要的。`tinyMCE.activeEditor`如果您只想访问当前活动的编辑器，也可以这样做。

针对您的以下问题：

1.您应该能够使用文本区域的模糊事件来触发您的保存。

```
$(document).ready(function() {
    for (edId in tinyMCE.editors) {
        $('#' + edId).blur(function() {
            auto_save($(this).attr('id'));
        });
    }
}); 
```

2.如果你想从你的函数内部访问 QuesID `auto_save`，你可以使用

```
var quesId = $('#' + editor_id).attr('QuesID'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-08T18:54:36.717

这很好。我做了一些更改，因为该帖子仍然被多次触发。此外，现在 auto_save 计时器在进行更改时会重置：

```
$.status = function (message) {
    $('#statusMsg').html('<p>' + message + '</p>');
};
$.status('log div');

$(document).ready(function () {
var myinterval;    

//for version 4.1.5 
    tinymce.init({
        selector: 'textarea',
        width: "96%",
        height: "200",
        statusbar: true,
        convert_urls: false,
        plugins: [
            "advlist autolink lists charmap print preview",
            "searchreplace fullscreen",
            "insertdatetime paste autoresize"
        ],
        toolbar: "undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image",
        external_plugins: {"nanospell": "/Scripts/nanospell/plugin.js"},
        nanospell_server: "asp.net", // choose "php" "asp" "asp.net" or "java"

        setup: function (ed) {  //start a 30 second timer when an edit is made do an auto-save 
            ed.on('change keyup', function (e) {
                //clear the autosave status message and reset the the timers
                $.status('');
                clearInterval(myinterval);
                myinterval = setInterval(function () {
                    for (edId in tinyMCE.editors)
                        auto_save(edId);
                }, 30000); //30 seconds
            });
        }
    });

    // Here is the auto_save() function that will be called every 30 secs
    function auto_save(editor_id) {
        var editor = tinyMCE.get(editor_id);
        if (editor.isDirty()) {
            var content = editor.getContent();
            content = content.replace("+", "%2B"); 
            content = content.replace("/", "%2F");
            $.ajax({
                type: "POST",
                url: "/PlanningReview/Save",
                data: "itemValue=" + content,
                cache: true,
                async: false,   //prevents mutliple posts during callback
                success: function (msg) {
                    $.status(msg)
                }
            });
        }
        else {
            return false;        // If nothing has changed, don't do anything
        }
    }
}); 
```

# javascript - 如何集成 Wufoo 表单和 Google Analytics

> ID：10021502
> 
> 赞同：0
> 
> 时间：2012-04-05T01:26:03.760
> 
> 标签：javascript, jquery, wordpress, wufoo

我按照本教程[将 Google Analytics 与 Wufoo 集成，](http://borism.net/2008/12/24/integrating-google-analytics-and-wufoo/)但我无法让它工作，它说

> “我们需要做的就是包含一个小的 javascript 文件，该文件将解析我们的谷歌分析 >cookie 并使用 url 修改将其传递给 wufoo。”

我的问题是我将把 jquery 脚本放在哪里？我不是 javascript 和 jquery 方面的专家，我正在就如何实现这一点寻求您的帮助。本教程的原作者不再活跃，wufoo 论坛目前处于离线状态。

TIA帕特里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:05:42.517

创建 .js 文件后，将其命名为您想要的任何名称，例如 wufoo-ga.js 并将其放在您的服务器上保存您网站的文件夹中。您可能在某处有一个名为*js*或*scripts*的文件夹。最好把它放在那里。在此示例中，假设您将文件放在*mywebsitefolder/js*中。然后，您需要将以下代码放入您要使用的页面的 html 中：

```
<script src="js/wufoo-ga.js"></script> 
```

这将调用您创建并放入*js*文件夹中的脚本

# java - Java如何检查是否选择了树中的节点？

> ID：10021505
> 
> 赞同：2
> 
> 时间：2012-04-05T01:26:58.883
> 
> 标签：java, jtree

我有一个 Java 中的 JTree，它具有不同的父节点，例如计算机、游戏系统、电视和网络设备，我的根节点是“技术”，我想做的是，每当用户单击其中一个节点时（例如在游戏系统节点下，我有 xbox360 和 ps3）所以如果用户在哪里点击 ps3，会弹出一个网络浏览器，将他们带到 ps3 主网站。我知道如何使用 Java 中的 Desktop 类来做到这一点，但我不确定如何检查节点是否已被选中，或者是否已释放鼠标单击，因为节点不提供 MouseListeners 等。有什么帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:36:05.177

JTree 响应[TreeSelectionListener](http://docs.oracle.com/javase/7/docs/api/javax/swing/event/TreeSelectionListener.html)而不是 MouseListener。试试[这个页面](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html#select)的一些例子。

# xml - 使用 TXMLTransformProvider 时控制 XML 节点的顺序

> ID：10021507
> 
> 赞同：2
> 
> 时间：2012-04-05T01:27:31.777
> 
> 标签：xml, delphi, tclientdataset

我正在使用 TXMLTransformProvider 使用 TClientDataSet 编辑 XML 文件（这很酷）。我希望能够控制 XML 文件中节点的顺序 - 使用主键或类似键。但是当我执行 ClientDataSet1.ApplyUpdates 时，新记录将添加到 XML 文件的末尾，而不是按照我的首选顺序（我在 DBGrid 中看到它们的顺序）。有没有一种简单的方法来保存我的订单，或者我是否必须放弃我的 TXMLTransformProvider 来保存数据并使用 TXMLDocument 手动对其进行编码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T05:37:56.960

我放弃了这一点，并使用 TXMLDocument 从 TClientDataSet 手动输出了 xml，虽然不是最漂亮的，但工作方式都一样。

# linux - 如何从控制台创建 dbus 服务？

> ID：10021511
> 
> 赞同：2
> 
> 时间：2012-04-05T01:28:03.687
> 
> 标签：linux, bash, dbus

使用 dbus-send 或 dbus-monitor 等工具，有或多或少直接的方式来发出或监听现有 DBus 服务的信号。

如何从 shell 注册服务和对象？期待类似的东西

```
1> dbus-service --session org.example.Test /Test
  2> qdbus org.example.Test /Test org.example.Test.Call qqq
1> qqq
  2> qdbus org.example.Test /Test org.example.Test.Call www
1> www 
```

或喜欢

```
1> dbus-service --argc=2 --session org.example.Test /Test -- /usr/bin/printf "%s Q %s\n"
  2> qdbus org.example.Test /Test org.example.Test.Call qqq ttw
1> qqq Q ttw
  2> qdbus org.example.Test /Test org.example.Test.Call www 111
1> www Q 111 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:38:57.320

我自己实现了：http: [//vi-server.org/pub/dbus-shell-service.pl](http://vi-server.org/pub/dbus-shell-service.pl)以[这个问题](https://stackoverflow.com/questions/6799472/start-the-session-bus-of-dbus-with-perl-netdbus)为例。

```
Usage: dbus-shell-service.pl service_name command_line_arguments...
Example:
  dbus-shell-service.pl org.example.Test /usr/bin/printf '%s Q %s\n' &
  qdbus org.example.Test / org.vi_server.DbusShellService.Call2 s1 s2
  s1 Q s2 
```

# c# - 转换为基类会引发 InvalidCastException

> ID：10021514
> 
> 赞同：3
> 
> 时间：2012-04-05T01:28:20.247
> 
> 标签：c#, casting, xml-deserialization

我的一个程序集包含以下“提供者”类型：

![继承树](../Images/32b7b9ebe9d25c60f31b40c46b725c91.png)

我还有一个 XML 文件，它使用`DeviceInfoProvider`基类保存提供者信息。简化版本如下所示：

```
<DeviceInfoProvider Type="SbRioI2CProvider" Assembly="assembly.dll" >
</DeviceInfoProvider>
<DeviceInfoProvider Type="GenericProvider" Assembly="assembly.dll" >
</DeviceInfoProvider> 
```

在运行时，我将 XML 字段映射到我的变量：

```
assembly.dll  ⇒ assemblyPath
Type          ⇒ typeName 
```

在阅读 XML 之后，使用以下代码来实例化我的类型：

```
var assembly = Assembly.LoadFrom(assemblyPath);

var type = (from t in assembly.GetTypes()
            where t.IsPublic && t.Name == typeName
            select t).FirstOrDefault();

if (type != null)
{
    instance = type.GetConstructor(Type.EmptyTypes).Invoke(null);
} 
```

正如预期的那样，这会适当地生成我的对象。

当我尝试将实例转换为基类对象时，问题就来了：

```
using (var provider = instance as DeviceInfoProvider)
{
    // provider is null!
} 
```

的运行时类型`instance`是预期的派生类，但我无法成功地将其转换为它的基类型。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T06:20:53.103

您的问题可能是您正在从 LoadFrom 上下文中的 assembly.dll 中的类型创建实例（GenericProvider、SbRioI2CProvider）。然后，您尝试按名称强制转换为该程序集中的类型（DeviceInfoProvider）。这隐含地使用了 Load 上下文。来自同一程序集但在不同上下文中加载的类型被运行时视为不同的类型，因此转换失败并且您得到 null。[本文](http://msdn.microsoft.com/en-us/magazine/dd727509.aspx)提供了对程序集绑定上下文的一些附加说明。

要使此转换成功，您需要`Assembly`将 LoadFrom 上下文中加载的内容放入 Load 上下文中。有几种方法可以做到这一点。一种方法是将程序集放在 GAC 中。另一种是从应用程序库中删除assembly.dll，这样它就不会被探测发现。然后使用 AppDomain.AssemblyResolve 事件加载`Assembly`您通过 LoadFrom 获得的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:22:45.840

调用反射类型的构造函数不会创建它的实例。

要创建反射类型的实例，请调用`Activator.CreateInstance`.

这条线看起来应该是：

```
if (type != null) {
    instance = Activator.CreateInstance(type)
} 
```

这将导致`instance`type `object`，但现在您可以将其转换为您想要的任何内容。

请参阅：http: [//msdn.microsoft.com/en-us/library/wccyzw83.aspx](http://msdn.microsoft.com/en-us/library/wccyzw83.aspx)

# c - 如何从带有扇区的软盘中读取块？

> ID：10021516
> 
> 赞同：-1
> 
> 时间：2012-04-05T01:28:47.727
> 
> 标签：c, block, head, sector, floppy

我需要从预操作系统状态读取软盘，并且我有一个要读取的功能，但它似乎无法读取第 4 个扇区...

```
void get_block(blk, buf) int blk; char buf[]
{
   int cyl, head, sector;

   cyl = ((blk*2) / 18) / 2;
   head = ((blk*2) / 18) % 2;
   sector = (blk*2) % 18;

   // Read first sector <<Dies here if blk > 2>>
   diskr(cyl, head, sector, buf);

   // Increment
   if ((sector = (++sector % 18)) == 0)
      if ((head = (++head % 2)) == 0)
         cyl++;

   // Read second sector <<Dies here if blk == 2>>
   diskr(cyl, head, sector, buf+512);
} 
```

知道为什么吗？我是否错误地从块转换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:11:39.547

不，假设您的磁盘是 1.44M 的“软盘”（80 个柱面，2 个磁头/柱面，18 个扇区/磁头，512 字节/扇区），这些计算应该没问题，如以下程序所示：

```
#include <stdio.h>
int main (void) {
    int blk, cyl, head, sector;
    for (blk = 0; blk <= 18; blk++) {
        cyl = ((blk*2) / 18) / 2;
        head = ((blk*2) / 18) % 2;
        sector = (blk*2) % 18;
        printf ("%2d (a) -> %2d %2d %2d", blk, cyl, head, sector);
        if ((sector = (++sector % 18)) == 0)
            if ((head = (++head % 2)) == 0)
                cyl++;
        printf (" (b) -> %2d %2d %2d\n", cyl, head, sector);
    }
    return 0;
} 
```

其输出是：

```
 0 (a) ->  0  0  0 (b) ->  0  0  1
 1 (a) ->  0  0  2 (b) ->  0  0  3
 2 (a) ->  0  0  4 (b) ->  0  0  5
 3 (a) ->  0  0  6 (b) ->  0  0  7
 4 (a) ->  0  0  8 (b) ->  0  0  9
 5 (a) ->  0  0 10 (b) ->  0  0 11
 6 (a) ->  0  0 12 (b) ->  0  0 13
 7 (a) ->  0  0 14 (b) ->  0  0 15
 8 (a) ->  0  0 16 (b) ->  0  0 17
 9 (a) ->  0  1  0 (b) ->  0  1  1
10 (a) ->  0  1  2 (b) ->  0  1  3
11 (a) ->  0  1  4 (b) ->  0  1  5
12 (a) ->  0  1  6 (b) ->  0  1  7
13 (a) ->  0  1  8 (b) ->  0  1  9
14 (a) ->  0  1 10 (b) ->  0  1 11
15 (a) ->  0  1 12 (b) ->  0  1 13
16 (a) ->  0  1 14 (b) ->  0  1 15
17 (a) ->  0  1 16 (b) ->  0  1 17
18 (a) ->  1  0  0 (b) ->  1  0  1 
```

我*有点*担心以下未定义的行为性质：

```
if ((sector = (++sector % 18)) == 0) 
```

构造，更喜欢类似的东西：

```
if ((sector = (sector + 1) % 18)) == 0) 
```

但是，如果它给你正确的价值观，那应该没问题。但是，您需要检查它*是否**在您运行的环境中*为您提供了正确的值。它在我的版本中的这一事实`gcc`并不意味着它会在你的情况下。

或者您可以只使用上面定义的建议*形式*。

您遇到的故障点远不及磁头或气缸之间的切换，因此我认为这不是包装问题，但如果可能的话，您应该打印出环境中的值。

当您说“无法阅读第 4 个扇区”时，您应该具体说明这意味着什么*？*机器是否冻结，是否出现磁盘错误，是否返回您认为垃圾的内容？

磁盘可能没有正确格式化，或者它有故障，也有可能它没有您希望看到的数据。使用 DOS/Windows/whatever 格式化软盘并检查程序中的功能可能是值得的。

# iphone - 应该从父 ViewController 还是子 ViewController 调用 popViewController？

> ID：10021519
> 
> 赞同：4
> 
> 时间：2012-04-05T01:29:25.677
> 
> 标签：iphone, objective-c, ios, uiviewcontroller, uinavigationcontroller

我可以通过从实例化它的父视图控制器或从子视图控制器本身`UINavigationController`调用来从 a 的堆栈中弹出视图控制器。`[self.navigationController popViewControllerAnimated:YES];`哪种方式更可取？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:19:37.167

我想答案是“最有意义的”；正如您所说，您可以`popViewControllerAnimated:`从父级、子级甚至其他包含对导航控制器的引用的类中调用。

对于大多数应用程序，子视图将包含一个“返回”或“完成”按钮或其他一些导致它被弹出的操作。一般来说，我会说这是更可取的行为：子视图控制器会自行弹出。

否则，孩子将不得不（通过代表或其他方式）呼唤父母说“pop！” 然后会调用`popViewControllerAnimated:`. 对于这样一个简单的动作来说，这感觉有点太复杂了。

# php - 如何向 YouTube API 浏览器上传表单添加额外字段（并处理它们）？

> ID：10021522
> 
> 赞同：1
> 
> 时间：2012-04-05T01:30:09.357
> 
> 标签：php, forms, api, youtube

[我正在使用此处](https://developers.google.com/youtube/2.0/developers_guide_protocol_browser_based_uploading)描述的表格将文件上传到 Youtube 帐户。像这样：

```
<form action="<?=$YTurl ?>?nexturl=http://localhost/update-video.php" method="post" enctype="multipart/form-data">
    <input id="file" type="file" name="file"/>
    <input type="hidden" name="token" value="<?=$YTtoken ?>"/>
    <input type="hidden" name="test" value="testvalue1234"/>
    <input type="submit" value="go" />
</form> 
```

但我计划在表单上添加更多字段，并且由于操作设置为 YouTube 的服务器，我无法处理剩余的字段。有没有人有解决方法？我希望 YT 允许我添加自定义参数，并在 nexturl 指定的回调中将它们发回给我。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:12:00.063

在提交表单之前，我最终通过 AJAX 发送了其他表单字段。我还使用会话 ID 哈希标识视频，以确保将其存储在正确的记录中。这是代码以防它帮助某人（包装到 jquery.validate.js 中）：

```
<script type="text/javascript">
    $(document).ready(function(){
        $("form").validate({
            rules: { ... },
            messages: { ... },
            submitHandler: function (form) {
                if ($('#video_file').val()) {
                    var data = {};
                    $('input').each(function() {
                        data[$(this).attr('name')] = $(this).val();
                    });
                    $.ajax({
                        url: 'process.php', dataType: 'json', type: 'POST', data: data,
                        success: function(response) {
                            if (response.status == '200') {
                                url = '<?=$tokenArray['url']?>?nexturl=http://localhost/update-video.php?hash=' + response.sid;
                                $(form).attr('action', url);                                        
                                form.submit();
                            }
                        }
                    });
                } else if ($('#video_url').val()) {
                    form.submit();
                }
            }
        });

    });
</script> 
```

# java - 禁用 Wifi 状态并尝试再次启用后出现 NullPointerException

> ID：10021523
> 
> 赞同：0
> 
> 时间：2012-04-05T01:30:27.850
> 
> 标签：java, android

我第一次启用 Wifi 然后禁用它一切都很好，但是如果我尝试在之后（立即或等待移动数据再次连接）重新启用 Wifi，它会抛出 NullPointerException 并强制关闭。

```
private void toggleWifi(){

    if (wifi == 0){
        wifiManager.setWifiEnabled(true);
        scanOnly = wifiManager.createWifiLock(WifiManager.WIFI_MODE_SCAN_ONLY, "scanOnly");
        scanOnly.acquire();

        bWifi.setText("Turn Wifi OFF");

        List<ScanResult> wifiResults = wifiManager.getScanResults();

        StringBuilder sb = new StringBuilder("Scan Results:\n");            
        sb.append("-----------------------\n");

        for (ScanResult r : wifiResults) {
            sb.append(r.SSID + " " + r.level + " dBM\n");
        }

        tvWifi.setText(sb.toString());

        wifi = 1;

    } else {
        scanOnly.release();
        wifiManager.setWifiEnabled(false);

        bWifi.setText("Turn WiFi ON");

        tvWifi.setText("");

        wifi = 0;
    }

} 
```

错误在这一行：

```
for (ScanResult r : wifiResults) {
    sb.append(r.SSID + " " + r.level + " dBM\n");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:46:59.663

你试过调试吗？目前 wifiResults 可能为空

# android - 从 Uri 打开文件，与 android 中的位置无关

> ID：10021528
> 
> 赞同：3
> 
> 时间：2012-04-05T01:31:06.180
> 
> 标签：android, file

我可以使用一些帮助来了解如何在 android 中打开文件。我的具体问题与打开图像文件有关。在我的应用程序中，用户使用他们选择的相机应用程序拍摄图像，然后我对返回的图像进行操作。根据手机、android 版本和选择的相机应用程序，我会在 onActivityResult 中返回不同的参数。有时我得到一个 URI，有时只是一个图像，有时两者兼而有之。

启动相机的代码是：

```
Intent i = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
startActivityForResult(i, CAMERA_IMAGE); 
```

然后我收到结果：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (requestCode == CAMERA_IMAGE && resultCode == Activity.RESULT_OK) {
        Log.d(TAG,"In onActivityResult");
        Bitmap imageBmp = null;
        Uri imageUri = data.getData();

        if (data.getExtras() != null) {
        imageBmp = (Bitmap)data.getExtras().get("data");
        Log.d(TAG,"Got Bitmap");
        }
        ...
    }
} 
```

当我得到一个 URI 而不是一个图像时，我的问题就出现了。如果 imageBmp 为空，那么我需要从 URI 加载图像。我已经测试了几个设备/应用程序组合。有时 URI 位于内部存储上，有时位于 SD 卡上。如果文件在 SD 卡上，那么我使用 managedQuery 来获取文件。

```
String[] proj = { MediaStore.Images.Media.DATA };
Cursor cursor = managedQuery(imageUri, proj, null, null, null);
int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);                        
cursor.moveToFirst();
imageFileName = cursor.getString(column_index);  
File imageFile = new File(imageFileName);
... 
```

如果它在内部存储上，那么我会收到 FileNotFoundException。

我的具体问题是：如何修改它以打开一个独立于文件系统位置的文件，只知道 URI？我想做类似的事情：

```
File imageFile = new File(imageUri); 
```

但 File 不接受 Uri 对象。我执行托管查询以将其转换为字符串。

我更一般的问题是为什么我需要首先进行查询？为什么我不能只使用返回的 URI？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T04:59:50.223

您将不得不使用 contentResolver 来访问作为 uri 传递的内部文件

```
ContentResolver cr = getContentResolver();
InputStream is = cr.openInputStream(imageUri); 
```

# php - 我的网址末尾出现了一个斜杠，没有明显的原因

> ID：10021531
> 
> 赞同：2
> 
> 时间：2012-04-05T01:31:16.447
> 
> 标签：php, .htaccess, xhtml

上周的一天，我的电子商务网站上的所有表格都停止工作（最重要的是，结帐不起作用）。我的网站是用 XHTML 和 PHP 编写的。我没有对网站的代码进行任何更改，因此假设我的网络主机对我的主机设置进行了一些更改。无论如何，他们非常绝望，并告诉我他们什么都没做，并暗示我网站上的代码有问题。

我目前在我的 htaccess 文件中使用以下代码来删除我的网页地址的 php 扩展名（恐怕我不太明白我只是从互联网上复制并粘贴的这段代码，但它似乎可以工作）：

```
# Remove the need for php extension to web page addresses
RewriteCond %{REQUEST_URI} ^(.*[^/])/?$
RewriteCond %{DOCUMENT_ROOT}%1.php -f
RewriteRule .+ %1.php [QSA,L] 
```

在解决了这个错误之后，我意识到我所有的 URL 现在都添加了斜杠，没有明显的原因。这意味着通过 POST 发送的表单数据不会传递到下一页，因为表单指向没有尾部斜杠的网页。我通过简单地在我的表单指向的地址中添加一个斜杠来临时修复了我的网站。

但是我对这个解决方案不满意，因为我希望我的网页恢复原样 - 没有尾部斜杠。特别是我担心对 SEO 工作的影响，因为我知道带有和不带有斜杠的页面被认为是完全不同的页面。最奇怪的是，如果我创建一个新页面，即使它与旧页面相同，它也没有斜杠。

我想知道是否有人知道为什么会突然发生这种变化以及如何解决这个问题。我的虚拟主机当前运行 PHP 版本 5.2.17。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T08:52:09.533

听起来 Apache 的 mod_dir 模块可能正在起作用；在 URL 中添加斜杠是该模块的一个关键特性：[http ://httpd.apache.org/docs/2.0/mod/mod_dir.html](http://httpd.apache.org/docs/2.0/mod/mod_dir.html)

您可以放入`DirectorySlash Off`一个 .htaccess 文件，看看是否可行。 `RewriteOptions AllowNoSlash`也可能让你到达某个地方。

或者，`RewriteLog "rewrite.log"`指令`RewriteLogLevel 3`会给你更多关于重写的信息，那里可能会发生一些事情。

# c++ - 提高优化级别 g++

> ID：10021536
> 
> 赞同：2
> 
> 时间：2012-04-05T01:32:16.813
> 
> 标签：c++, optimization, g++, cygwin

我正在尝试使用 cygwin 和 g++ 编译一个相对简单的 c++ 程序。我可以使用以下命令编译它：

`g++ -o main main.cpp -lgmpxx -lgmp`

（注意：最后两个反映了 gmp 库的包含）。

我想提高编译时的优化级别。我以为我可以将此命令行更改为：

`g++ -o3 main main.cpp -lgmpxx -lgmp`

但这完全爆炸了。我收到大约两个完整的错误消息屏幕。

我怎样才能在这里增加优化？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T01:34:53.067

应该是`-O3`，不是`-o3`。否则，您是在告诉 g++ 将已编译的可执行文件放入名为 的文件`3`中，然后您将它`main`（您之前编译的可执行文件）作为*input 提供*。它可能试图将其解释为源代码，因此会出现错误。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-05T01:35:10.590

选项区分大小写：该`-o`选项允许您指定输出文件的名称，`-O`设置优化量，因此您需要：

```
g++ -O3 -o main main.cpp -lgmpxx -lgmp 
```

# ember.js - 在 Controller 中观察绑定模型中任何字段的变化

> ID：10021544
> 
> 赞同：2
> 
> 时间：2012-04-05T01:32:58.407
> 
> 标签：ember.js

我正在将模型绑定到我的控制器，并且我想观察其字段的任何更改，以便我可以重新加载一些数据并刷新视图。

现在我有一些真正非干燥的东西：

```
goalController = Ember.Object.create({
  ...
  recompute: function() { save model, load recomputed data from server }
  ...
  nameChanged: function() { this.recompute() }.observes('content.name'),
  incomeChanged: function() { this.recompute() }.observes('content.income')  
}); 
```

有没有一种 Ember-y 方式来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T12:54:30.003

您可以一次设置多个观察者，因此您可以像这样重写您的示例：

```
goalController = Ember.Object.create({

    goalUpdated: function() {
        // do your thing
    }.observes("content.name", "content.income")

}); 
```

这是一个小提琴：http: [//jsfiddle.net/rlivsey/upZDU/](http://jsfiddle.net/rlivsey/upZDU/)

# unix - 查找命令不从结果中排除文件夹

> ID：10021547
> 
> 赞同：2
> 
> 时间：2012-04-05T01:33:14.543
> 
> 标签：unix, find

我有一个 shell 脚本，它输出用户提供的文件夹中的所有 .js 和 .html 文件。我需要从搜索结果中排除一个子文件夹及其所有文件。我正在使用`find`命令来执行此操作。我目前使用的命令排除了此子文件夹下的所有文件，但在结果中输出子文件夹。我想排除一个名为“CrashLog”的文件夹及其所有文件。该子文件夹的路径是“Users/test/Desktop/Units/JSunit/CrashLog/”

这是我正在使用的查找命令：

```
find "Users/test/Desktop/Units" -name CrashLog -prune -o -name "*.html" -o -name "*.js" 
```

输出包括“Users/test/Desktop/Units/JSunit/CrashLog/”。我怎样才能排除这个？我知道我可以使用 grep，但如果有使用 find 本身的解决方案，我会更喜欢。我在 Mac OSX 上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:33:59.880

您需要`-print`, 在文件扩展名测试的末尾和括号：

```
find "Users/test/Desktop/Units" -name CrashLog -prune -o \( -name "*.html" -o -name "*.js" \) -print 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:35:53.747

```
find "Users/test/Desktop/Units" -name CrashLog -prune -a \( -name "*.html" -o -name "*.js" \) 
```

# visual-c++ - C++/CLI LoadLibrary 无法将 System::String 转换为 LPCWSTR 和 const char *

> ID：10021549
> 
> 赞同：1
> 
> 时间：2012-04-05T01:33:17.960
> 
> 标签：visual-c++, c++-cli

尝试传入用户提供的字符串，该字符串具有 jvm.dll 的路径，但它不会加载库，除非我使用以下内容进行硬编码：

```
#define RUNTIME_DLL _T("C:\\Program Files\\Java\\jre7\\bin\\Server\\jvm.dll") 
```

如果我尝试这样做，它会编译但会失败：

```
HINSTANCE handle = LoadLibrary((const char*)Marshal::StringToHGlobalAnsi(string).ToPointer()); 
```

“字符串” var 具有 _T() 具有但仍然失败的确切复制和粘贴路径。不是 C/C++ 方面的专家，所以我不确定是什么 _T() 让它工作。

**更新：**

试过这个：

```
// System::String always stored as Unicode, get a Unicode pointer with no conversion necessary
        pin_ptr<const WCHAR> lib_name = PtrToStringChars(string);
        // Always use the Unicode version of LoadLibrary
        HINSTANCE handle = LoadLibraryW(lib_name); 
```

而且它仍然不会加载 jvm.dll 文件。如果我这样做，它只会加载它：

```
#define RUNTIME_DLL _T("C:\\Program Files\\Java\\jre7\\bin\\Server\\jvm.dll")

        // System::String always stored as Unicode, get a Unicode pointer with no conversion necessary
        pin_ptr<const WCHAR> lib_name = PtrToStringChars(RUNTIME_DLL);
        // Always use the Unicode version of LoadLibrary
        HINSTANCE handle = LoadLibraryW(lib_name); 
```

**也试过这个：**

```
 // System::String always stored as Unicode
        marshal_context^ ctx = gcnew marshal_context();
        pin_ptr<const WCHAR> lib_name = PtrToStringChars(jvmDllPath);           
        //const wchar_t * lib_name = ctx->marshal_as<const wchar_t*, System::String^>(jvmDllPath);
        printf("JVM Path: %s", lib_name);
        // Always use the Unicode version of LoadLibrary
        handle = LoadLibraryW(lib_name);            

        if( handle == 0) {
            printf("Failed to load jvm dll \n");
            //printf(ErrorExit((LPTSTR)(const char*)"Initialize"));
                            // this is the part that will work
            System::String^ string = gcnew System::String("C:\\Program Files\\Java\\jre7\\bin\\Server\\jvm.dll");
            pin_ptr<const WCHAR> lib_name = PtrToStringChars(string);
            handle = LoadLibraryW(lib_name);
        }
        delete ctx;  // do this for now to not create memory leaks 
```

C++/CLI 方法签名是：

```
void Initialize(String^ jvmDllPath) 
```

body基本上就是上面的代码

使用字符串参数调用 this 的 C# 代码如下：

```
obj.Initialize("c:\\program files\\java\\jdk7\\jre\\bin\\server\\jvm.dll"); 
```

从 Ben 的建议中提供答案，以便人们/新手和临时 c/c++/cli 编码人员可以找到一个快速答案来避免我经历的事情：

```
 const char * CliToNativeString(String^ cliString){
        const char * converted;
        converted = (gcnew marshal_context())->marshal_as<const char *>( cliString );           
        return converted;
    }

    String^ NativeToCliString(const char * nString){
        String^ converted = gcnew String("");
        if(nString != NULL)
            converted = (gcnew marshal_context())->marshal_as<String^>(nString); 
        return converted;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:24:28.180

有更好的方法可以从`System::String^`. 查看VC++ 提供的`marshal_as`和模板。`marshal_context`

您的直接问题是您正在为 Unicode 编译，因此`LoadLibrary`需要 unicode 字符串，但`StringToHGlobalAnsi`不返回 unicode 字符串。再多的指针转换都不会改变指向的字符串的编码。

你也有内存泄漏。

试试这个：

```
#include <vcclr.h>

// System::String always stored as Unicode, get a Unicode pointer with no conversion necessary
pin_ptr<const WCHAR> lib_name = PtrToStringChars(string);
// Always use the Unicode version of LoadLibrary
HINSTANCE handle = LoadLibraryW(lib_name); 
```

如果这有效而上述无效，则说明从 C# 发送的字符串有问题：

```
System::String^ string = gcnew System::String(L"C:\\Program Files\\Java\\jre7\\bin\\Server\\jvm.dll");
pin_ptr<const WCHAR> lib_name = PtrToStringChars(string);
HINSTANCE handle = LoadLibraryW(lib_name); 
```

# android - 闪屏全白？

> ID：10021552
> 
> 赞同：3
> 
> 时间：2012-04-05T01:34:24.853
> 
> 标签：android, screen, splash-screen

基本上我有一个启动屏幕，显示用户何时启动应用程序。初始屏幕应该打开一个网站（稍后将显示的网站）以下载所有字体和图像以缓存，以使您第一次运行应用程序时一切运行更顺畅。但是你现在看到的只是一个白屏，代码可以工作（经过测试），但它显示的是一个白色的闪屏，而不是一个带有徽标和一些文字的闪屏。

这是代码；
飞溅.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:background="#4A4A4A">

    <ImageView
        android:id="@+id/logo"
        android:layout_width="200dp"
        android:layout_height="wrap_content"
        android:src="@drawable/logo"
        android:layout_gravity="center" />

    <TextView
        android:text="@string/loading"
        android:layout_gravity="center"
        android:textColor="#FFA500"
        android:textSize="15dp"
        android:typeface="normal"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

    <WebView
        android:id="@+id/splashview"
        android:layout_width="0px"
        android:layout_height="0px"
        android:layout_weight="0" />

</LinearLayout> 
```

飞溅.java

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.webkit.WebChromeClient;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class Splash extends Activity {
    @Override
    protected void onCreate(Bundle savedInstance) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstance);
        setContentView(R.layout.splash);

        WebView webView = (WebView) findViewById(R.id.splashview);
        webView.setWebChromeClient(new WebChromeClient());

        webView.loadUrl("http://ngmat.site90.net/matsedel/");

        webView.setWebViewClient(new WebViewClient() {
            @Override
            public void onPageFinished(WebView view, String url) {
                Intent NGMat = new Intent("android.intent.category.SECONDARY");
                startActivity(NGMat);
            }
        });

    }

    @Override
    protected void onPause() {
        // TODO Auto-generated method stub
        super.onPause();
        finish();
    }

    @Override
    protected void onResume() {
        super.onResume();
        setContentView(R.layout.main);
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T01:59:08.890

我只是尝试在普通的桌面浏览器中[打开您的 URL](http://ngmat.site90.net/matsedel/)，并且在很长一段时间内完全没有显示任何内容，几乎直到最终下载了需要下载的任何内容。所以存在延迟问题。

网络视图是一头奇怪的野兽。在我看来，你给它 HTML（或者在你的情况下是一个外部 URL），它几乎立即从 loadUrl 调用返回。然后在另一个线程上，Web 视图找出它想要渲染的内容，然后渲染它。因此，在 loadURL() 调用返回和屏幕实际更新之间通常存在延迟。在我的应用程序中，我将 HTML/CSS 全部放在一个字符串中，因此没有“下载”延迟，但在屏幕显示和 Web 视图渲染之间仍然存在明显的延迟。

而且您的网站似乎有一个下载延迟，以增加网络视图的自然延迟。我怀疑 web 视图正在变得可见，它还没有任何东西可以显示，所以呈现一个空白/白色屏幕，然后从外部网站下载 HTML/任何内容，仍然显示一个空白屏幕，直到它有除了通过 onPageFinished() Web 视图客户端方法调用下一个活动之外，所有下载的内容都已准备好在屏幕上呈现某些内容。

UI 线程似乎发现另一个影响 UI 的线程正在运行（下一个活动的开始），因此实际上并没有更新屏幕，因为知道它无论如何都会被覆盖。因此，当新活动开始并完成其 onCreate()、onStart() 等一系列调用以最终更新屏幕时，您的屏幕将保持空白/白色。

因此，您将永远不会看到您的启动画面。Web 视图没有机会更新屏幕，因为下一个活动控制了屏幕。

不幸的是，我认为您的方法有缺陷。我认为最好将方法一分为二——用非常简单的东西加载启动画面，然后**在后台线程上**导致数据下载发生。让后台线程在完成所有操作后调用辅助活动，最好通过向 UI 线程发出调用以切换到下一个活动。

这样用户会看到一些东西，然后在用户欣赏你的启动画面时在后台发生其他事情。

您能否将启动画面内容嵌入到应用程序的下载/安装包中，使其始终快速显示，而不受数据连接的存在或其速度的影响？应用程序通常会在已安装的软件包中“刻录”一个简单的闪屏，以便无论设备是否能够到达自身外部，它们都可以显示一些内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:40:32.480

我认为`setContentView(R.layout.main)`线路`onResume`可能会导致问题。您已经在调用`setContentView(R.layout.splash)`，`onCreate`因此您无需再次调用它`onResume`。不确定您的 main.xml 是什么样的，但似乎它可能只是一个空白布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T01:43:01.053

也许页面加载太快？开始加载内容前 3-5 秒的计时器怎么样？

# c - 使用 pthreads / cond_signal / cond_wait 时如何考虑循环缓冲区大小为 1？

> ID：10021559
> 
> 赞同：0
> 
> 时间：2012-04-05T01:35:39.340
> 
> 标签：c, pthreads, circular-buffer

我正在尝试实现一个程序，该程序使用线程从文件中读取数据并写入任意大小的缓冲区，而另外两个线程从该缓冲区读取信息。一切正常，除了当我指定缓冲区大小为 1 时。当我这样做时，一切都锁定了。我或多或少地从[这里](http://www.mimuw.edu.pl/~idziaszek/zajecia/so/pthreads/prod_kon.c)改编了经典的“消费者/生产者”示例这是我的代码：

我正在使用的结构：

```
struct prodcons {
 char** buffer; pthread_mutex_t lock;
 pthread_cond_t notempty; pthread_cond_t notfull;
 int readpos, writepos, finished;
}; 
```

我的“添加到缓冲区”线程

```
static void buf_add(struct prodcons *b, char* data) {
 /* Add the data after locking the buffer */
 pthread_mutex_lock(&b-> lock);
 printf("Reader adding %s\n", data);

 int err;
 /*Wait until buffer is not full*/
 while ((b->writepos + 1) % numlines == b->readpos) {
      err = pthread_cond_wait(&b->notfull, &b->lock);
      if (err != 0) { fprintf(stderr, "cond wait");}
 }

 /* Needed to stop writes */
 if (data != NULL) {
      b->buffer[b->writepos] = strdup(data);
 } else {
      //fprintf(stderr, "End of file reached, adding NULL\n");
      b->buffer[b->writepos] = NULL;
 }

 /* Increments the writing position */
 (*b).writepos++;
 if ((*b).writepos >= numlines) {
      printf("Resetting write position\n");
      (*b).writepos = 0;
 }   

 /* Unlock */
 pthread_cond_signal(&b->notempty);
 pthread_mutex_unlock(&b->lock);
 } 
```

这是输出的样子：

```
 Reader adding 64.233.173.85 
```

然后它就挂了。很明显，它永远不会超出第一个 while 循环。它适用于任何其他尺寸，但不适用于 1。对此实施修复的最佳方法是什么？如果这有帮助，这是我的“从缓冲区获取”方法。

```
 static void *read_from_buffer(struct prodcons *b) {
 pthread_mutex_lock(&b -> lock);

 /* We have to wait for the buffer to have something in it */
 while ((*b).writepos == (*b).readpos) {
      pthread_cond_wait(&b->notempty, &b->lock);
 }

 /* Set the thread delay */
 thread_delay.tv_sec = threaddelay / 100000;
 thread_delay.tv_nsec = 1000*threaddelay%100000;

 char *t = NULL;

 /* Read the data and advance the reader pointer */
 if ((*b).buffer[(*b).readpos] != NULL) {
      t = (char*)malloc(strlen ((*b).buffer[(*b).readpos] ) + 1);
      strcpy(t, (*b).buffer[(*b).readpos]);
      printf("Consumer %u reading from buffer: got %s\n", (unsigned int)pthread_self(), t);

      /*At this point, we should probably check is FQDN*/
      if (strcmp(t, "-1") == 0) {
           (*b).finished = 1;
      } else {
           nanosleep(&thread_delay, &thread_delay_rem);
           check_cache(t, &cache);
      }
 }

 /* We have to adjust the reading position */
 (*b).readpos++;
 if ( (*b).readpos >= numlines) {
      (*b).readpos = 0;
 }

 /*Need to signal and unlock */
 pthread_cond_signal (&b->notfull);
 pthread_mutex_unlock(&b->lock);
 return t;
 } 
```

我确信有一个相当简单的解决方法来处理这种边缘情况，但我似乎无法弄清楚。我们欢迎所有的建议！

编辑：我也像这样初始化我的缓冲区：

```
 static void init(struct prodcons *temp) {
 (*temp).buffer = (char**)malloc(numlines * sizeof(char*)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:40:45.700

没有单步执行您的代码，但您正在编写一个终止 NUL`'\0'`字节，这将占用整个 1 字节缓冲区。写入者永远等待缓冲区中的空间。

```
while ((b->writepos + 1) % numlines == b->readpos) { /* always satisfied */ 
```

# php - ++$a + $a++ 在 PHP 中是如何产生歧义的？

> ID：10021561
> 
> 赞同：8
> 
> 时间：2012-04-05T01:35:50.580
> 
> 标签：php, grammar, interpreter, operator-precedence

php手册声称：

```
$a = 1;
echo ++$a + $a++; 
```

在它的语法下是模棱两可的，但对我来说似乎非常清楚。++$a 和 $a++ 首先计算，从左到右，所以 ++$a 递增然后返回 2，$a++ 返回 2 然后递增。2 + 2 的总和是 4，所以它会回显 4。但是，[PHP 手册](http://www.php.net/manual/en/language.operators.precedence.php)非常清楚地说明它可能会打印 4 或 5。

php规范是否没有指定将从左到右执行操作？

即使它不强制从左到右执行操作，在这种情况下，它不会返回 4 无论如何？

编辑：我重新阅读了该页面，并指出它是由每个特定的运营商确定的。+ 的优先级最低，并且从左到右进行评估，所以我之前的假设似乎是正确的。我还是不明白。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T01:40:47.957

`++$a`设为`$a`2，返回 2， 再次`$a++`递增，现在是 3，但它返回 2。`$a``$a`

在相同的 PHP 版本中，结果总是相同的。但如果 PHP 版本发生变化，可能会产生不同的结果。它取决于`++$a`和`$a++`，首先评估哪个。如果`$a++`先求值，则结果为 5，否则结果为 4。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T03:08:06.437

### 请注意，这只是我的拙见。

我认为这个结果背后的想法是，当只有一个运算符时，没有一个附加数具有优先权，并且在一个操作中，一个变量被保留作为参考，而不是在所有计算过程中被它的结果替换，直到最后一个（加上，在这个例子中）。所以当它来自 lr 时：

```
$a = 1;
++$a + $a++
operand 1 --> ++$a ==> $a = ++1 = 2
result (where $a = 2) --> 2 + (2++) = 4 
```

否则：

```
$a = 1;
++$a + $a++
operand 2 --> $a++ ==> $a = 1
// new operation on the left side
// so the value gets incremented ==> $a = 2
result (where $a = 2) --> (++2) + 2 = 5 
```

不过，我不确定这一点。

# java - 如何在 JCalendar 中仅显示今天之后的日期

> ID：10021565
> 
> 赞同：1
> 
> 时间：2012-04-05T01:36:12.493
> 
> 标签：java, swing, date, jcalendar

我试图限制用户只选择今天之后的日期，或者选择另一个日期`Date` 我在[JCalendar API](http://www.toedter.com/en/jcalendar/api/com/toedter/calendar/JCalendar.html)上看到 一些可以帮助我的东西，但我什么也没找到。我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T05:16:24.343

我认为组件上没有直接的方法可以做到这一点。我知道的一种方法是使用`setSelectableDateRange(Date from,Date to)`- 当您将开始日期设置为当前日期时，所有前一天的单元格，年/月下拉菜单都会被禁用。

例子：

```
 JCalendar calendar = new JCalendar();
    calendar.setSelectableDateRange(new Date(),new SimpleDateFormat("MM-DD-YYYY").parse("05-05-2015"));

    PropertyChangeListener calendarChangeListener  = new PropertyChangeListener() {
        @Override
        public void propertyChange(PropertyChangeEvent evt) {
            Date selectedDate = ((JCalendar)evt.getSource()).getDate();
        }
    };
    calendar.addPropertyChangeListener("calendar",calendarChangeListener); 
```

这将禁用选择当前日期之前和 2015 年 5 月 5 日之后的任何日期

请注意，此 API 未记录在其 javadoc 中。但这仍然是一个按预期工作的公共设置器。

**编辑**，因为您想知道如何`JDateChooser`在类似的上下文中使用

```
 JDateChooser chooser = new JDateChooser();
    chooser.getJCalendar().setSelectableDateRange(new Date(),new SimpleDateFormat("MM-DD-YYYY").parse("05-05-2015"));
    chooser.getJCalendar().addPropertyChangeListener("calendar",...); 
```

# java - LuaJava：使用 LuaJava 将整个 Lua-Table 导入类 Java 数组

> ID：10021569
> 
> 赞同：1
> 
> 时间：2012-04-05T01:37:14.103
> 
> 标签：java, arrays, lua, lua-table, luajava

我真的坚持这一点，肯定搜索了我的谷歌，试图用 luajava 将表从 lua“导入”到 java 中的数组......现在，我已经能够做一些简单的事情，打印 lua- java中的vars并从表中读取单个元素..一切都在这里工作

**JAVA**

```
LuaState L = LuaStateFactory.newLuaState();
L.openLibs();
L.LdoFile("data/test.lua");
L.getGlobal("x"); //I want to read lua-variable x
LuaObject obj = L.getLuaObject(L.getTop()); //So I get the top-element here
System.out.println(obj.getField("Version")); 
```

**卢阿**

```
 x = { ["Version"] = 1.3,["Scans"] = 3 } 
```

现在，这对于检索单个值显然相当容易，但我想将整个对象放入 Java（作为数组或其他任何东西），所以我可以用它做一些事情。我尝试循环遍历那个 LuaObject 但因为它是还不是可迭代的或“真正的”数组，那是不可能的。简单的输出`obj`会告诉我它是一个 lua 表，我用 .getObject 尝试了很多愚蠢的东西，但没有成功。然后我读了一些关于代理和 .pcall 的东西（这看起来像是将 Java 中的值传递给 lua 中的函数，这不是我想要的）在（非常非常糟糕的）记录的 javadoc 中找不到任何东西，所以我希望有人有这方面的经验.. 可能真的很容易，但很难找到相关信息。对这方面的任何信息感到非常高兴！

ps 我不能更改原始 lua 文件（稍后），但该文件将只包含一个大表..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T09:10:59.487

Lua 是一种动态语言，表是它唯一的数据结构。一个表可以包含键/值对的任意组合，这与 Java 的静态类型相反。因此，您需要创建一个转换函数，该函数将从 Lua 表中创建一个 Java 对象。这不是 LuaJava 自动提供的。

如果你想用从 Lua 表中获取的数据填充 Java [POD类，你基本上有以下选项：](http://en.wikipedia.org/wiki/Plain_old_data_structure)

1.  **手动操作（最简单）** - 创建一个简单的函数，它采用 Lua 堆栈索引，在该索引处需要一个 Lua 表，然后创建您的 POD 类的 Java 实例并手动填充数据，即您需要输入所有必需的`getField`调用。

2.  **使用 Java 反射（更通用）** - 转换函数采用 Lua 堆栈索引和 Java `Class`，创建该类的新实例并使用Java[反射](http://docs.oracle.com/javase/tutorial/reflect/index.html)[`lua_next`](http://www.lua.org/manual/5.1/manual.html#lua_next)来迭代 Lua 表并填写必要的 Java 字段。

如果你只打算在一种 Lua 表上使用转换，我建议你使用第一个选项。缺点是每次更改结构时，都必须更新转换代码。第二种方法也有缺点，例如您应该如何处理丢失/额外键、子表等的情况。

# python - 为什么我的 Python 索引程序中出现“dict”没有属性“sort”错误

> ID：10021570
> 
> 赞同：3
> 
> 时间：2012-04-05T01:37:17.390
> 
> 标签：python, python-2.7

任务是编写一个程序，提示输入文件名，然后生成该文件的索引。前任。索引是按字母顺序排列的索引，显示文档中每个单词出现的行。例如，本段的索引可能显示为：

```
Word          Line Number
a             1 1 2
alphabetical  1
an            1
appear        2 
```

在这里，我列出了一个列表，以便我可以对单词进行排序。

我有这个代码：

```
f = open(raw_input("Enter a filename: "), "r")
myDict = {}
linenum = 0

for line in f:
line = line.strip()
line = line.lower()
line = line.split()
linenum += 1

for word in line:
    word = word.strip()
    word = word.lower()
    myDict[word] = linenum

    if word in myDict:
        myDict.sort()
    else:
        myDict.append(word)

print "%-15s %-15s" %("Word", "Line Number")
print "%-15s %-15d" %(myDict.keys(), myDict.values()) 
```

当我现在运行程序时，它说'dict'没有属性'sort'。你能解释一下吗？

该文件与示例相同，输出也应该是上面的示例。我是python的新手，请帮助：[

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:23:35.547

我认为使用 dict 是有意义的，但是您必须在添加到 dict 的每个值的同时添加一个键。例如：

```
>>> dict = {}
>>> dict["apple"] = "red"
>>> dict["banana"] = "yellow"
>>> dict
{'apple': 'red', 'banana': 'yellow'} 
```

在这个例子中，键是“apple”和“banana”，值是“red”和“yellow”。由于这是家庭作业，因此我将由您自己决定适合您的作业的键和值。

此外，这条线是有问题的：

```
for word in line: 
```

`line`是一个字符串，因此您实际上是在查看 中的每个字符`line`，而不是每个单词。您必须找到某种方法来转换`line`为单词列表...

最后，您的最终语句将只打印最后读取的单词。您正在构建一个字典，但您不是在打印字典，而是在打印单个值。一旦你建立了字典，你应该打印字典本身。

* * *

```
myDict[word] = linenum

if word in myDict:
    myDict.sort()
else:
    myDict.append(word) 
```

您走在正确的道路上，但是对字典进行排序并不是处理多次出现的单词的正确方法（此外， dict 没有排序方法，这就是您收到错误的原因，但即使如果是这样，你就不需要它了）。此外，一旦你为一个键赋值，它就会被添加到字典中，所以它已经被“附加”了。

在您的示例中，单词*a*出现 3 次，并且输出列出了它出现的每一行，因此您需要一种方法来存储每个单词的行列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:46:36.587

你想让 myDict 只是一个列表吗？如果是这样，请将其声明为 myDict = []。列表具有排序和追加功能，但字典没有。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T18:41:22.537

您可以通过这种方式轻松地对字典的顺序进行排序：

```
f = open(raw_input("Enter a filename: "), "r")
myDict = {}
linenum = 0

for line in f:
  line = line.strip()
  line = line.lower()
  line = line.split()
  linenum += 1

  for word in line:
    word = word.strip()
    word = word.lower()

    if not word in myDict:
      myDict[word] = [] 

    myDict[word].append(linenum)

print "%-15s %-15s" %("Word", "Line Number")
for key in sorted(myDict):
  print '%-15s: %-15d' % (key, myDict(key)) 
```

希望它可以帮助乔迪

# mysql - 为下表编写 SELECT 查询

> ID：10021571
> 
> 赞同：0
> 
> 时间：2012-04-05T01:37:21.453
> 
> 标签：mysql, sql, ms-access

> **可能重复：**
> [将 SQL 查询写入下表中的 SELECT 项](https://stackoverflow.com/questions/10020369/writing-an-sql-query-to-select-item-from-the-following-table)

我无法弄清楚如何编写一个 SELECT 查询，该查询从表中选择列中具有多个相同单元格值的每个单元格。例如，如果列名称为“汽车”，则仅当“福特”在列中占据多个单元格时才选择“福特”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:42:01.083

您可能需要使用 Have 子句。

```
 SELECT count(*), cars
 FROM table
 GROUP BY cars
 HAVING count(*) > 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:44:43.133

这是一个没有额外列的版本：

```
Select cars from (select cars, count(*) as nbr from theTable group by cars) 
where nbr > 1; 
```

# php - 用php从xml中删除元素

> ID：10021572
> 
> 赞同：0
> 
> 时间：2012-04-05T01:37:27.233
> 
> 标签：php, xml, post

我正在构建一个 iphone 应用程序，它允许人们通过向 php 脚本发送 POST 来更新 xml 文件。在他们将帖子发送到 php 脚本并更新 xml 后，我希望用户能够取消对 XML 的更新。如何从 XML 中只删除一个元素并将 XML 文件重写到服务器上的相同位置（换句话说，现在只有一个元素消失了，其他一切都相同）？为了添加一个元素，我使用了如下代码：

```
$xmlUrl = "Bars.xml"; // XML 
$xmlStr = file_get_contents($xmlUrl);
$xml = new SimpleXMLElement($xmlStr);
$bartenders = $xml->xpath('//Bartenders');
$new_bartender = $bartenders[$newBar_ID]->addChild('Bartender');
$new_bartender->fname = $newfname;
$new_bartender->lname = $newlname;
$new_bartender->imageURL = $newimageURL;
$new_bartender->shift = $newShift;
print_r($bartenders);

$xml->asXML('Bars.xml'); 
```

当我将 POST 方法发送到 php 脚本时，我有元素的属性来识别要删除的内容。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:16:38.493

[可能与此](https://stackoverflow.com/questions/262351/remove-a-child-with-a-specific-attribute-in-simplexml-for-php)重复。

从您的代码片段中，我真的不知道给出了什么数据。你可以尝试做

```
unset($bartenders[$newBar_ID]); 
```

或者

```
$bartenders->removeChild($bartenders[$newBar_ID]); 
```

我猜...我根据谷歌出现的代码片段编写了这些，从未测试过它们。如果它有效，请随时给我反馈。

# asp.net - 我有 3 个数据库，实时、测试和开发。我可以在 DBML 中轻松交换这些之间的链接吗？

> ID：10021573
> 
> 赞同：0
> 
> 时间：2012-04-05T01:37:35.080
> 
> 标签：asp.net, sql, ado.net, linq-to-xml

我需要在相同设计的不同数据库实例之间进行交换。有没有办法将 DBML 重新指向这个不同的数据库。理想的做法是在代码中指定不同的 web.config 连接字符串。但是，不想更改代码库中的 Datacontext 名称。如果在 ADO.NET 中执行此操作，则可以选择连接字符串。

谢谢，

埃德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:51:55.200

您可以使用 web.config 转换并轻松交换所需的配置，这里有一些链接：

[使用 Visual Studio 2010 进行常见的 Web.Config 转换](http://weblogs.asp.net/srkirkland/archive/2009/10/13/common-web-config-transformations-with-visual-studio-2010.aspx)

[Web 应用程序项目部署的 Web.config 转换语法](http://msdn.microsoft.com/en-us/library/dd465326.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T02:27:34.627

当您实例化 DBML 时，将从配置文件中检索适当的连接字符串。（`app.config`或`web.config`）。在没有找到设置的情况下，使用初始连接字符串（作为属性存在于 DBML 中，并且可以通过设计器查看）。

如果您通过单个实例使用多个连接字符串，则只需要使用连接字符串构造函数，并且需要指定您应该连接的数据库。

在您的情况下，您只需在执行设置文件中包含适当的连接字符串。连接字符串必须正确命名 - 请参阅放置在包含 DBML 的项目中的设置以检查名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T01:48:50.067

你应该能够做到这一点。当您生成 DBML 时，它通常会将连接字符串写入配置文件（web.config 或 app.config）。我们应该只更改配置文件中的数据库位置。但是，您必须确保所有数据库都处于同步状态。

# linux - 从 rc.local 运行 Bash 脚本

> ID：10021575
> 
> 赞同：2
> 
> 时间：2012-04-05T01:38:12.523
> 
> 标签：linux, bash

我制作了一个脚本，它使用了一个名为 Diascope 的程序，它是一个视频幻灯片程序。

我正在尝试在 encodeVideo.sh 中运行此命令

```
echo "Running diascope -clean /mnt/videos/video$1.txt..."
diascope -clean /mnt/videos/video$1.txt > /var/www/html/video/encodeVideo.log
echo "Removing old deploy dir, and making new one..." 
```

我正在从 rc.local 运行此脚本，以便每次启动实例时它都会运行。

**我所需要的只是获得“diascope”命令的输出**，在 rc.local 中我运行 encodeVideo：

```
/bin/bash /var/www/html/video/encodeVideo.sh > /var/www/html/video/newlog 
```

在新日志中我可以看到这个

```
Running diascope -clean /mnt/videos/video7.txt...
Removing old deploy dir, and making new one... 
```

和 /var/www/html/video/encodeVideo.log 完全是空的！Diascope 使用 gawk，顺便说一句，当我手动运行 encodeVideo.sh 脚本时，我可以看到处理的输出。为什么我无法在此日志中捕获它？

有没有可能它不是标准输出，所以“>”实际上并没有捕获它？

任何想法都会有所帮助，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:45:31.893

尝试将**stderr**和**stdout**重定向到文件名

```
diascope -clean /mnt/videos/video$1.txt 1> /var/www/html/video/encodeVideo.log  2>&1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T01:45:56.760

> 有没有可能它不是标准输出，所以“>”实际上并没有捕获它？

绝对：它可能是标准错误，在这种情况下你必须使用`2>`而不是`>`.

# java - 我可以在标签内有一个文本字段吗？

> ID：10021579
> 
> 赞同：2
> 
> 时间：2012-04-05T01:39:49.287
> 
> 标签：java, swing, textfield, jlabel, jtextfield

我想要做的是在表单中显示以下内容：

```
Open [15] minutes before class 
```

**文本字段**`[15]`在哪里。 这可能吗？

 *** * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-05T02:09:00.970

通过将所需部分添加到`JPanel`. 例如

![课前时间](../Images/f258ebf8ec2e78615c27573ec9c1212c.png)

```
import java.awt.FlowLayout;
import javax.swing.*;

class TimeBeforeClass {

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                JPanel gui = new JPanel(new FlowLayout(FlowLayout.LEFT, 3,3));
                gui.add(new JLabel("Open"));
                gui.add(new JSpinner(new SpinnerNumberModel(15,0,20,1)));
                gui.add(new JLabel("minutes before class"));
                JOptionPane.showMessageDialog(null, gui);
            }
        });
    }
} 
```

请注意，我将“文本字段”换成了`JSpinner`一个更适合选择“以分钟为单位的时间”的组件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T05:51:54.290

```
Can I have a textfield inside a label? 
```

*   答案是，可以，这是 Java`AWT / Swing`对象的基本属性

*   `JComboBox`, `JTable`, `JList`, `JSpinner`, `JFile(Color)Chooser`.... 是复合的`JComponents`，你可以把它们全部提取出来`JComponent`再放在一起。

*   你可以把任何一个放到`JComponents`另一个

*   仅在 API 中默认实现`JFrame/JDialog/JWindow`，[其余时间您必须实现正确的 LayoutManager](https://stackoverflow.com/questions/8575641/how-returns-xxxsize-from-jcomponents-added-to-the-jlabel)`JPanel``LayoutManager`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T01:58:03.127

我想我还没有理解。但是，我会尝试：

您可以从 TextField 中获取文本：

label.setText("打开 " + textField.getText()+ " 上课前几分钟");**

# scala - 使用隐含类型种姓会改变变量的类型吗？

> ID：10021587
> 
> 赞同：0
> 
> 时间：2012-04-05T01:41:01.253
> 
> 标签：scala, type-conversion

我从一段代码中得到一个错误。我只会显示一行代码，至少我认为是错误报告中导致它的那一行。这是：

```
b = temp(temp.length-1).toInt; //temp is an ArrayBuffer[String] 
```

错误是：

```
For input string: "z"
at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
at java.lang.Integer.parseInt(Integer.java:449)
at java.lang.Integer.parseInt(Integer.java:499)
at scala.collection.immutable.StringLike$class.toInt(StringLike.scala:231)
at scala.collection.immutable.StringOps.toInt(StringOps.scala:31)
at Driver$.stringParse$1(Driver.scala:59)
at Driver$.main(Driver.scala:86)
at Driver.main(Driver.scala)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at scala.tools.nsc.util.ScalaClassLoader$$anonfun$run$1.apply(ScalaClassLoader.scala:78)
at scala.tools.nsc.util.ScalaClassLoader$class.asContext(ScalaClassLoader.scala:24)
at scala.tools.nsc.util.ScalaClassLoader$URLClassLoader.asContext(ScalaClassLoader.scala:88)
at scala.tools.nsc.util.ScalaClassLoader$class.run(ScalaClassLoader.scala:78)
at scala.tools.nsc.util.ScalaClassLoader$URLClassLoader.run(ScalaClassLoader.scala:101)
at scala.tools.nsc.ObjectRunner$.run(ObjectRunner.scala:33)
at scala.tools.nsc.ObjectRunner$.runAndCatch(ObjectRunner.scala:40)
at scala.tools.nsc.MainGenericRunner.runTarget$1(MainGenericRunner.scala:56)
at scala.tools.nsc.MainGenericRunner.process(MainGenericRunner.scala:80)
at scala.tools.nsc.MainGenericRunner$.main(MainGenericRunner.scala:89)
at scala.tools.nsc.MainGenericRunner.main(MainGenericRunner.scala) 
```

据我所知，这导致了这个问题。由于它是不可变的，我知道它无法更改。但我不确定。我以此为基础

```
at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48) 
```

一旦我做了类似上面唯一的代码的事情，它会改变整个对象吗？Temp 是一个 ArrayBuffer[String]。所以我试图访问一个数字的字符串表示形式，并将其转换。但是这样做是否会改变现状并阻止我做任何事情？

如果您认为放置我所有的代码会有所帮助，请告诉我编辑它，但它很多，我不想惹恼任何人。我感谢任何可以帮助我理解这一点的人！

*编辑：我的代码（仅在这里帮助我找出我的错误，但没有必要查看。我只是看不到它在哪里给了我这个错误）。

我的代码的重点是解析顶部的任何一个字符串。它将组合成一个字符串，然后读取其他两个符号以配合它。它可以很好地解析 str，但是当它在 str2 中读取“z”和在 str3 中读取“y”时发现了问题。可以看出，问题在于递归之后的第二个字符串。同样重要的是要注意字符串必须采用这种形式。所以它只能像“（和x（和yz））”那样解析，但不能以任何其他更方便的方式解析。

```
val str = "(and x y)";
val str2 = "(and x (and y z))"; //case with expression on th right side
val str3 = "(and (and x y) z)"; //case with expression ont he left side

var i = 0; //just counter used to loop through the finished parsed array to make a list
//var position = 0; //this is used for when passing it in the parser to start off at zero
var hold = new ArrayBuffer[String]();//finished array should be here

def stringParse ( exp: String, expreshHolder: ArrayBuffer[String] ): ArrayBuffer[String] = { //takes two arguments, string, arraybuffer
    var b = 0; //position of where in the expression String I am currently in
    var temp = expreshHolder; //holder of expressions without parens
    var arrayCounter = 0;
    if(temp.length == 0) 
        b = 0; 
        else {
            b = temp(temp.length-1).toInt;
            temp.remove(temp.length-1); 
            arrayCounter = temp.length;
        } //this sets the position of wherever the string was read last plus removes that check from the end of the ArrayBuffer
     //just counts to make sure an empty spot in the array is there to put in the strings

    if(exp(b) == '(') {
        b = b + 1;

        while(exp(b) == ' '){b = b + 1;} //point of this is to just skip any spaces between paren and start of expression type
        if(exp(b) == 'a') {
            //first create the 'and', 'or', 'not' expression types to figure out 
            temp += exp(b).toString;
            b = b+1; 
            temp(arrayCounter) = temp(arrayCounter) + exp(b).toString; //concatenates the second letter
            b = b+1; 
            temp(arrayCounter) = temp(arrayCounter) + exp(b).toString; //concatenates the last letter for the expression type
            //arrayCounter+=1;
            //this part now takes the symbols and puts them in an array
            b+=1;

            while(exp(b) == ' ') {b+=1;} //just skips any spaces until it reaches the FIRST symbol
            if(exp(b) == '(') { 
                temp += b.toString; 
                temp = stringParse(exp, temp); 
                b = temp(temp.length-1).toInt; 
                temp.remove(temp.length-1); 
                arrayCounter = temp.length-1 
                } else {
                    temp += exp(b).toString; 
                    arrayCounter+=1; b+=1; }

            while(exp(b) == ' ') {b+=1;} //just skips any spaces until it reaches the SECOND symbol
            if(exp(b) == '(') { 
                temp += b.toString;
                temp = stringParse(exp, temp); 
                b = temp(temp.length-1).toInt; 
                temp.remove(temp.length-1); 
                arrayCounter = temp.length-1 
                } else {
                    temp += exp(b).toString; 
                    arrayCounter+=1; 
                    b+=1; 

        } 
    temp;
    } else { var fail = new ArrayBuffer[String]; fail +="failed"; fail;}

}
hold = stringParse(str2, ho );
for(test <- hold) println(test); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:44:07.890

包含什么`temp`？您的代码假定它包含`String`可以转换为`Int`s 的 s，但似乎您`String` `"z"`在其中有一个。这会产生错误：

```
scala> "z".toInt
java.lang.NumberFormatException: For input string: "z"
... 
```

这是一个`temp`可能看起来像的娱乐：

```
val temp = ArrayBuffer("1", "2", "z")
temp(temp.length-1).toInt //java.lang.NumberFormatException: For input string: "z" 
```

所以你需要弄清楚为什么有些人`String` `"z"`会进入`temp`.

编辑：

因此，您将“表达式”添加到`temp`( `temp += exp(b).toString`) 并添加索引 ( `temp += b.toString`)。然后你假设`temp`它只包含索引 ( `b = temp(temp.length-1).toInt`)。您需要确定`temp`用途，然后将其专门用于该目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T08:17:14.597

我无法理解您的问题，因为我无法理解您的代码。让我们尝试简化您的代码。

首先：您有一些具有表达式类型和操作数列表的表达式：

```
scala> :paste
// Entering paste mode (ctrl-D to finish)

abstract sealed class Operand
case class IdentOperand(name: String) extends Operand { override def toString(): String = name }
case class IntOperand(i: Int) extends Operand  { override def toString(): String = i.toString() }
case class ExprOperand(expr: Expression) extends Operand { override def toString(): String = expr.toString() }
case class Expression(exprType: String, operands: Seq[Operand]) {
  override def toString(): String = operands.mkString("(" + exprType + " ", " ", ")")
}

// Exiting paste mode, now interpreting.

defined class Operand
defined class IdentOperand
defined class IntOperand
defined class ExprOperand
defined class Expression

scala> Expression("and", Seq(IdentOperand("x"), IdentOperand("y")))
res0: Expression = (and x y)

scala> Expression("and", Seq(IdentOperand("x"), ExprOperand(Expression("and", Seq(IdentOperand("y"), IdentOperand("z"))))))
res1: Expression = (and x (and y z))

scala> Expression("and", Seq(ExprOperand(Expression("and", Seq(IdentOperand("x"), IdentOperand("y")))), IdentOperand("z")))
res2: Expression = (and (and x y) z) 
```

现在我们必须将字符串解析为这种类型的表达式：

```
scala> import scala.util.parsing.combinator._
import scala.util.parsing.combinator._

scala> object ExspessionParser extends JavaTokenParsers {
     |   override def skipWhitespace = false;
     |
     |   def parseExpr(e: String) = parseAll(expr, e)
     |
     |   def expr: Parser[Expression] = "(" ~> exprType ~ operands <~ ")" ^^ { case exprType ~ operands => Expression(exprType, operands) }
     |   def operands: Parser[Seq[Operand]] = rep(" "~>operand)
     |   def exprType: Parser[String] = "and" | "not" | "or"
     |   def operand: Parser[Operand] = variable | exprOperand
     |   def exprOperand: Parser[ExprOperand] = expr ^^ (ExprOperand( _ ))
     |   def variable: Parser[IdentOperand] = ident ^^ (IdentOperand( _ ))
     | }
defined module ExspessionParser

scala> ExspessionParser.parseExpr("(and x y)")
res3: ExspessionParser.ParseResult[Expression] = [1.10] parsed: (and x y)

scala> ExspessionParser.parseExpr("(and x (and y z))")
res4: ExspessionParser.ParseResult[Expression] = [1.18] parsed: (and x (and y z))

scala> ExspessionParser.parseExpr("(and (and x y) z)")
res5: ExspessionParser.ParseResult[Expression] = [1.18] parsed: (and (and x y) z) 
```

现在（据我了解您的代码）我们必须用整数值替换字符串操作数（ `x`, `y`, ）。`z`让我们将这 2 个方法添加到`Expression`类中：

```
 def replaceOperands(ints: Seq[Int]): Expression = replaceOperandsInner(ints)._2

  private def replaceOperandsInner(ints: Seq[Int]): (Seq[Int], Expression) = {
    var remainInts = ints
    val replacedOperands = operands.collect{
      case n: IdentOperand =>
        val replacement = remainInts.head
        remainInts = remainInts.tail
        IntOperand(replacement)
      case ExprOperand(e) =>
        val (remain, replaced) = e.replaceOperandsInner(remainInts)
        remainInts = remain
        ExprOperand(replaced)
    }

    (remainInts, Expression(exprType, replacedOperands))
  } 
```

现在我们可以这样做了：

```
scala> ExspessionParser.parseExpr("(and (and x y) z)").get.replaceOperands(Seq(1, 2, 3))
res7: Expression = (and (and 1 2) 3) 
```

如果你有字符串形式的整数值，那么你可以先转换它们：

```
scala> Seq("1", "2", "3") map { _.toInt }
res8: Seq[Int] = List(1, 2, 3) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T01:53:21.477

不，toInt 不会更改对象，它将对象作为参数并返回一个整数，使对象保持原样。

# actionscript-3 - 我如何知道 AS3 中的 NetStream 加载了多少视频？

> ID：10021588
> 
> 赞同：1
> 
> 时间：2012-04-05T01:41:24.290
> 
> 标签：actionscript-3, netstream

我正在 AS3 中制作视频播放器，想知道如何找出当前缓存/缓冲了多少视频。我不确定正确的术语是什么，所以我无法在文档中找到它。

`NetStream.time`给我视频的当前位置，因此我可以显示一个进度条。

在进度条下方，我想显示已经加载了多少视频。我如何找到这个值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T01:46:34.730

您可以使用[`NetSteam.bytesLoaded`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/NetStream.html#bytesLoaded)and[`NetSteam.bytesTotal`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/NetStream.html#bytesTotal)来获取加载的总粗略百分比：

```
var bufferPercent:Number = myNetStream.bytesLoaded / myNetStream.bytesTotal;

// Use percentage to scale buffer bar.
myBufferBar.scaleX = bufferPercent; 
```

# ruby - 在不组合标记的情况下计算 Unicode 字符串长度

> ID：10021591
> 
> 赞同：4
> 
> 时间：2012-04-05T01:41:44.187
> 
> 标签：ruby, unicode

考虑以下分析三字节 UTF-8 字符串的 Ruby 代码：

```
#encoding: utf-8
s = "\x65\xCC\x81"
p [s.bytesize, s.length, s, s.encoding.name]
#=> [3, 2, "é", "UTF-8"] 
```

正如[我的这个页面上](http://phrogz.net/e-acute)所描述的那样，上面确实*是*一个两个字符的字符串：拉丁小写`e`，后跟[Combining Acute Accent](http://www.fileformat.info/info/unicode/char/0301/index.htm)。但是，它*看起来*像一个字符，这在布置固定宽度的显示器时很重要。

*例如，查看[此目录列表](http://phrogz.net/svg/)中“moiré.svg”的两个条目，并注意其中一个条目是如何弄乱列对齐的。*

如何计算 Ruby 中不包含任何零宽度组合字符的字符串的“等宽视觉长度”？（一种有效的技术可能是将 Unicode 字符串转换为其规范表示的方法，将上述转换为`"\xC3\xA9"`看起来也像`é`但具有`length`of 的方法`1`。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T02:05:50.357

unicode_utils gem 可能会有所帮助

*   当前链接：[https ://github.com/lang/unicode_utils](https://github.com/lang/unicode_utils)

*   旧链接：[http ://unicode-utils.rubyforge.org/UnicodeUtils.html](http://unicode-utils.rubyforge.org/UnicodeUtils.html)

有一个[`char_display_width`](http://unicode-utils.rubyforge.org/UnicodeUtils.html#method-c-char_display_width)方法：

```
require "unicode_utils/char_display_width"
UnicodeUtils.char_display_width("別")  # => 2
UnicodeUtils.char_display_width(0x308) # => 0
UnicodeUtils.char_display_width("a")   # => 1 
```

有一个字符串[`display_width`](http://unicode-utils.rubyforge.org/UnicodeUtils.html#method-c-display_width)方法：

```
require "unicode_utils/display_width"
UnicodeUtils.display_width("別れ") => 4
UnicodeUtils.display_width("12") => 2
UnicodeUtils.display_width("a\u{308}") => 1 
```

还看[`each_grapheme`](http://unicode-utils.rubyforge.org/UnicodeUtils.html#method-c-each_grapheme)。

（感谢迈克尔安德森指出其他方法）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:29:45.157

您可以使用正则表达式来获取 Unicode 属性：

```
s = "\x65\xCC\x81"
count = s.each_char.inject(0) do |c, char|
  c += 1 unless char=~/\p{Mn}/
  c
end

puts count #=> 1 
```

这在这种情况下有效，但您必须确定要在更强大的解决方案中排除哪些属性。

使用[@joelparkerhenderson 的回答](https://stackoverflow.com/a/10021756/214790)中建议的 unicode_utils gem可能是一个更好的选择，但我想我会为了完整起见将其包括在内。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-05T01:55:24.887

我远不是 Ruby 方面的专家，但这[给出](http://snippets.dzone.com/posts/show/4527)了以下内容：

```
def length_utf8
  count = 0
  scan(/./mu) { count += 1 }
  count
end 
```

# utf-8 - 字符集特殊字符

> ID：10021594
> 
> 赞同：7
> 
> 时间：2012-04-05T01:42:03.800
> 
> 标签：utf-8, iso-8859-1, windows-1252, iso-8859-2

*   iso-8859-1 是 utf-8 的真子集吗？
*   那么iso-8859-n呢？
*   windows-1252呢？

如果以上任何一项的答案是否定的，那么不相交的字符是什么？我正在测试一些检测字符集的逻辑，并希望编写测试来验证检测是否正常工作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T02:33:22.823

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:11:45.367

Unicode 是所有这些字符集的超集，也是几乎所有已建立的字符集的超集。您可以在此处找到所有这些字符集到 Unicode 代码点的映射列表：http: [//unicode.org/Public/MAPPINGS/](http://unicode.org/Public/MAPPINGS/)。

# objective-c - ARC不允许对目标c类型指针'CFDataRef'进行隐式转换？

> ID：10021598
> 
> 赞同：0
> 
> 时间：2012-04-05T01:42:36.410
> 
> 标签：objective-c, automatic-ref-counting, implicit-conversion, cfdata

我有一个去年夏天创建的 UDP 类型的套接字，它运行良好，如果我打开项目文件仍然运行良好。但是，我已将 .h/.m 文件导入到一个新项目中，该项目确实有 ARC。

ARC 不喜欢以下命令（在 if 语句中使用）；

```
CFSocketSendData(WOLsocket, 
                   address,
                   Data,
                   0) < 0) 
```

出现错误：

> 目标 c 类型指针 'CFDataRef' 的隐式转换（又名 'const struct__CFData' 不允许使用 ARC

错误重复，一次为WOLsocket，一次为地址

其中 WOLsocket 创建如下；

```
WOLsocket = CFSocketCreate(kCFAllocatorDefault, PF_INET, SOCK_DGRAM, IPPROTO_UDP, 0, NULL, NULL);
int desc = -1;
desc = CFSocketGetNative(WOLsocket);
int yes = 1;
setsockopt (desc, SOL_SOCKET, SO_BROADCAST, (char *)&yes, sizeof (yes)) 
```

（有错误检查代码，这是最基本的！）

并且地址是这样创建的；

```
memset(&addr, 0, sizeof(addr));
    addr.sin_len = sizeof(addr);
    addr.sin_family = AF_INET;
    addr.sin_port = htons(PORT); //port
    addr.sin_addr.s_addr = ad;
    address = [NSData dataWithBytes: &addr length: sizeof(addr)]; 
```

我对为什么会发生这种情况感到非常困惑，所有其他 ARC 错误似乎都可以通过丢失“dealloc，release”语句来解决！

所以我的问题是，如何让 ARC 停止抱怨我使用 CFData？（我需要做哪些修改？）

谢谢，

亚历克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:36:55.623

Both the question and chosen answer to [ARC and bridged cast](https://stackoverflow.com/questions/7036350/arc-and-bridged-cast) should answer your question pretty well.

# java - Java 2d 数组，测试正方形

> ID：10021599
> 
> 赞同：1
> 
> 时间：2012-04-05T01:42:47.540
> 
> 标签：java

我得到了一个数组（a2d），我需要确定每一行和每一列是否与其他每一行和每一列具有相同数量的元素。如果是，那么我将布尔 isSquare 设置为 true。

我提出了以下代码，但它不喜欢它，也没有给我任何关于如何改进它的建议。

```
for(int row = 0; row < a2d.length; row++){
for(int col = 0; col < a2d[row].length; col++)
    if(a2d.length == a2d[row].length)
        isSquare = true;
    else
        isSquare = false;
} 
```

我是用错误的方式测试这个还是有更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T01:51:20.503

不需要 2 个循环，你应该能够做这样的事情（我不会给出代码，因为它是家庭作业）

```
1\. Save the length of the array (a2d.length)
2\. Loop over all the rows
3\. Check to see if the given row has the same length
4\. if Not return false 
5\. if you reach the end of the loop return true 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:51:33.160

```
for (int i = 0, l = a2d.length; i < l; i++) {
  if (a2d[i].length != l) {
    return false;
  }
}
return true; 
```

您只需要确保第二维数组的所有长度都与第一维数组的长度相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T01:50:35.760

```
if(a2d.length == a2d[row].length)
    isSquare = true;
else
    isSquare = false; 
```

如果最后一个元素通过，这将始终返回 true。试试这个：

```
isSquare = true;
for(int row = 0; row < a2d.length; row++){
for(int col = 0; col < a2d[row].length; col++)
    if(a2d.length != a2d[row].length)
        isSquare = false;
} 
```

# c# - 单击列表对象并在另一个列表框C#中显示其他多个列表对象

> ID：10021600
> 
> 赞同：0
> 
> 时间：2012-04-05T01:42:48.493
> 
> 标签：c#, dictionary, listbox, datasource

我已经接近答案了，但很烦人，不完全是。到目前为止，我的代码是：

```
 private void lstIndividuals_SelectedIndexChanged(object sender, EventArgs e)
   {
        var individual = lstIndividuals.SelectedItem as Individual;
        var tempSimilarFilesToFile1 = new HashSet<Individual>();
        int Counter = 0;
        foreach (KeyValuePair<int, Individual> kvpInd in _Individuals1)
        {
            tempSimilarFilesToFile1 = new HashSet<Individual>();
            foreach (KeyValuePair<int, Individual> kvpInd2 in _Individuals2)
            {
                if (kvpInd.Value.name.name.ToLower() == kvpInd2.Value.name.name.ToLower())
                {
                    Counter++;
                    similarInds.Add(kvpInd.Value);
                    if (Counter >= 1)
                    {
                        tempSimilarFilesToFile1.Add(kvpInd2.Value);
                    }
                }
            }
        lstIndividuals2.DataSource = tempSimilarFilesToFile1.ToList();
        lstIndividuals2.DisplayMember = "DisplayName";
        lstIndividuals2.ValueMember = "id";
   } 
```

正如您可能看到的，`lstIndividuals2`列表框项目的缩放速度非常快。我只想点击一个项目`lstIndividuals`

然后我希望显示找到的类似记录（任何遵守规则的记录`kvpInd.value.name.name == kvpInd2.value.name.name`）

所有类似的项目，我想存储在`tempSimilarFilesToFile1`其中，并作为数据源`lstIndividual2`

如果我解释得不好，我深表歉意。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:46:32.927

`tempSimilarFilesToFile1`您每次都在外部循环中初始化，因此您实际上会得到一个列表，`_Individuals2`其中包含与 中的最终项目相同的项目`_Individuals1`。只需尝试在外部循环中注释 init 语句，看看是否有帮助。

```
private void lstIndividuals_SelectedIndexChanged(object sender, EventArgs e)    
{
    var individual = lstIndividuals.SelectedItem as Individual;
    var tempSimilarFilesToFile1 = new HashSet<Individual>();
    int Counter = 0;
    foreach (KeyValuePair<int, Individual> kvpInd in _Individuals1)
    {
        // comment the statement below
        //tempSimilarFilesToFile1 = new HashSet<Individual>();
        foreach (KeyValuePair<int, Individual> kvpInd2 in _Individuals2)
        {
            if (kvpInd.Value.name.name.ToLower() == kvpInd2.Value.name.name.ToLower())
            {
                Counter++;
                similarInds.Add(kvpInd.Value);
                if (Counter >= 1)
                {
                    tempSimilarFilesToFile1.Add(kvpInd2.Value);
                }
            }
        }
    lstIndividuals2.DataSource = tempSimilarFilesToFile1.ToList();
    lstIndividuals2.DisplayMember = "DisplayName";
    lstIndividuals2.ValueMember = "id";
} 
```

# ftp - 如何在 MAMP 服务器上安装 mod_ftp 模块

> ID：10021602
> 
> 赞同：4
> 
> 时间：2012-04-05T01:43:15.770
> 
> 标签：ftp, mamp, apache, apache-modules

**背景：**

我最近安装了 MAMP，并将其用作生产服务器。服务器设置没有附带 FTP 服务器，根据我的阅读，您可以通过 Apache 模块 mod_ftp 设置 FTP 服务器。我不是 Apache 软件或服务器管理员方面的专家，尽管我可以快速学习。我可以达到以下几点，然后我被卡住了。有人可以帮我吗？

**我从存储库中检查了 mod_ftp 模块文件，这里：http:** [//svn.apache.org/repos/asf/httpd/mod_ftp/trunk/](http://svn.apache.org/repos/asf/httpd/mod_ftp/trunk/) 并将内容解压缩到：

```
/Applications/MAMP/mod_ftp 
```

**我打开了 README-FTP 文件（在这里）：http:**
[//svn.apache.org/repos/asf/httpd/mod_ftp/trunk/README-FTP](http://svn.apache.org/repos/asf/httpd/mod_ftp/trunk/README-FTP)

**自述文件-FTP：**

```
To build and install as a DSO outside of the httpd source
build, from the ftp source root directory, simply;

    ./configure.apxs
    make
    make install

...

To build static, or as a DSO but within the same build as httpd,
copy the entire ftp source directory tree on top of your existing 
httpd source tree, and from the httpd source root directory

    ./buildconf  (to pick up ftp)
    ./configure --enable-ftp {your usual options}

and proceed as usual. 
```

**一些问题：**

1.  “从 ftp 源根目录在 httpd 源构建之外构建和安装 DSO”——ftp 源根目录是我从存储库中签出的压缩文件创建的**mod_ftp文件夹吗？**

2.  “在 httpd 源代码构建之外”是什么意思？-- 这是我在 httpd.conf 中设置为“/Applications/MAMP/Library”的 ServerRoot 值吗？

3.  同样，“在同一个 httpd 构建中”是什么意思——这是指什么位置？

4.  我如何知道我想要静态构建还是 DSO 构建？

5.  什么是声明：“将整个 ftp 源目录树复制到现有的 httpd 源代码树之上”实际上要求我这样做？（在上面？？如在httpd源码树的父目录中，还是在同一目录中？）

6.  如果你做到了这一点，我想赞扬你！

从这一点开始，我选择了第一个选项，并将 README-FTP 中看到的命令输入到我的终端中。

**这是我的终端的样子：**

```
$ ./configure.apxs
Configuring mod_ftp for APXS in /usr/sbin/apxs
Detecting features

Finished, run 'make' to compile mod_ftp

Run 'make FTPPORT=8021 install' to install mod_ftp
(The default FTPPORT is 21 if not specified)

The manual pages ftp/index.html and mod/mod_ftp.html
will be installed to help get you started.

The conf/extra/ftpd.conf will be installed as an example
for you to work from.  In your configuration file,
  /private/etc/apache2/httpd.conf
uncomment the line '#Include conf/extra/ftpd.conf'
to activate this example mod_ftp configuration.
$ make
Making all in modules/ftp
$ sudo make install
Password:
Making install in modules/ftp
/usr/share/apr-1/build-1/libtool --silent --mode=install cp mod_ftp.la /usr/libexec/apache2/
Installing configuration files
for i in /private/etc/apache2/httpd.conf /private/etc/apache2/original/httpd.conf; do \
        if test -f $i; then \
        (awk -f /applications/mamp/library/mod_ftp/build/addloadexample.awk \
            -v MODULE=ftp -v DSO=.so -v LIBPATH=libexec/apache2 \
            -v EXAMPLECONF=/private/etc/apache2/extra/ftpd.conf \
            < $i > $i.new && \
            mv $i $i.bak && mv $i.new $i \
            ) || true; \
        fi; \
        done
Preserving existing FTP documents
Installing header files
Installing online manual
$ 
```

那么我该怎么做呢？我在任何地方都看不到 mod_ftp.so，而且我特别关注这个目录：

```
/Applications/MAMP/Library/modules (where all of Apache's other mod_*.so files are...) 
```

和这个目录：

```
/Applications/MAMP/mod_ftp/modules/ftp (where all of mod_ftp's various .c, .h and other files are) 
```

最终，我认为我遇到的问题是我不明白我的 mod_ftp 源文件夹和 httpd 源文件夹之间的文件结构需要如何集成才能使模块正常运行。另外，我不知道我不知道什么，所以可能有一个简单的问题要问，但不幸的是我不知道如何问。感谢您的帮助和耐心！

干杯!

PS，是的，我已经在互联网上搜索了几个小时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-13T02:08:45.140

我最终放弃了 MAMP 并使用 Mac 的内置服务器。通过“系统偏好设置”>“共享”菜单，您可以启用文件共享，其中有一个“选项”窗格，允许您“使用 FTP 共享文件和文件夹”。我能够通过 Comcast Business 获得静态 IP 地址，并在路由器的 21 端口上配置端口转发以接受流量。然后，我可以使用我的 FTP 客户端以“123.456.789:21”之类的东西作为我的主机连接到我的路由器。不是最好或最安全的解决方案，但它确实有效，因此请谨慎对待。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-16T20:38:40.710

是的，我终于设法在 Ubuntu LTS 16.04 上安装了它。

首先，您应该通过运行
sudo apt-get install subversion apache2-dev 来安装 svn 和 apxs 功能。

然后，cd 到一个方便的文件夹，然后运行 ​​svn co [http://svn.apache.org/repos/asf/httpd/mod_ftp/trunk/](http://svn.apache.org/repos/asf/httpd/mod_ftp/trunk/)。这将下载名为 /trunk 的文件夹中的所有内容。然后，cd 进入下载的 repo 的 /trunk 文件夹。

然后，运行所述指令
./configure.apxs --> 在子文件夹中执行某些操作以使 makefile 能够工作
make --> 这会编译 repo 的内容并更改内容。
make install --> 您可能希望使用建议的标志运行。本质上是将内容复制到需要复制的位置，并创建必要的模块。

建议的 ./buildconf 和 ./configure 仅应在您同时使用 ftp 编译 apache2 时完成。由于您应该已经安装了 apache2，所以这不是您应该做的选择。只需坚持第一组指令，它们用于独立于 apache2 编译 mod_ftp 并根据需要修补内容。

此时，安装在技术上应该可以工作。但是，您还没有完全摆脱困境。如果此时重新启动 apache2，它应该无法启动。如果你运行 systemctl -xe，你会看到这是由于配置文件的各个地方的语法错误，有人忘记在前面加上正斜杠，所以指定的目录不是相对于 root，而是指定的目录最终是相对的改为 /etc/apache2 。修复这些，使用行号作为指导。可以在指定 mod_ftp 模块位置的 apache2.conf 文件和指定错误日志位置的 ftpd.conf 文件中找到遗漏。

您现在需要处理 apache2.conf 和 ftpd.conf（位于 /etc/apache2 文件夹的 /extra 子文件夹中）。确保
包含 /etc/apache2/extra/ftpd.conf
LoadModule ftp_module /usr/lib/apache2/modules/mod_ftp.so 的行存在且未注释。
第一个基本上告诉主 apache2.conf 文件包含 mod_ftp 的配置文件，以帮助对您的 http 和 ftp 配置设置进行分区。第二个只是确保加载了 ftp 模块，以便它可以解释 ftpd.conf 文件中的指令。因此，您不需要添加“FTP on”行或指定端口，因为这些在 ftpd.conf 中处理得非常好。

你现在应该可以走了。请注意，由于某些奇怪的原因，如果您将 ftpd.conf 中的文档根目录设置为与 apache2.conf 中的相同，则 apache2 仍将正常运行。ftp 服务器可以正常工作，但 http 服务器不能正常工作。不知道为什么，但是如果您想这样做，一个简单的解决方法就是对 http 文档根目录进行符号链接并将其设置为 ftp 文档根目录。

# java - 从超类调用子类方法

> ID：10021603
> 
> 赞同：28
> 
> 时间：2012-04-05T01:43:30.257
> 
> 标签：java, inheritance

我正在上一门介绍性的 java 课程，我们刚刚开始学习继承。我正在处理一项任务，要求我们创建一个带有名称和年龄的“宠物”超类；和三个子类，每个子类都有自己独特的特征（我选择了“狗”、“猫”和“鸟”）。在我们构建完所有这些之后，我们将创建一个 Main 类来测试所有内容，这就是我遇到问题的地方。我试图在 中调用`get`这些独特特征的方法`Main`，但似乎只能找到超类中的方法。

这是主类：

```
public class Kennel {
    public static void main(String[] args) {
        // Create the pet objects
        Pet cat = new Cat("Feline", 12, "Orange");
        Pet dog = new Dog("Spot", 14, "Dalmation");
        Pet bird = new Bird("Feathers", 56, 12);

        // Print out the status of the animals
        System.out.println("I have a cat named " + cat.getName()
                + ". He is " + cat.getAge() + " years old."
                + " He is " + cat.getColor()
                + "When he speaks he says " + cat.speak());
        System.out.println("I also have a dog named " + dog.getName()
                + ". He is " + dog.getAge() + " years old."
                + " He is a " + dog.getBreed()
                + " When he speaks he says " + dog.speak());
        System.out.println("And Finally I have a bird named " 
                + bird.getName() + ". He is " + bird.getAge() + " years old."
                + " He has a wingspan of " + bird.getWingspan() + " inches."
                + " When he speaks he says " + bird.speak());       
    }
} 
```

这是我的超类

```
abstract public class Pet {
    private String name;
    private int age;

    // Constructor
    public Pet(String petName, int petAge) {
        this.name = petName;
        this.age = petAge;
    }

    // Getters
    public String getName() { return(this.name); }
    public int getAge() { return(this.age); }

    // Setters
    public void setName(String nameSet) { this.name = nameSet; }
    public void setAge(int ageSet) { this.age = ageSet; }

    // Other Methods
    abstract public String speak();

    // toString
    @Override
    public String toString() {
        String answer = "Name: " + this.name + " Age: " + this.age;
        return answer;
    }
} 
```

这是其中一个子类（它们看起来都一样并且有相同的错误）

```
public class Cat extends Pet {
    private String color;

    // Constructor
    public Cat(String petName, int petAge, String petColor) {
        super(petName, petAge);
        this.color = petColor;
    }

    // Getters
    public String getColor() { return(this.color); }

    // Setters
    public void setColor(String colorSet) { this.color = colorSet; }

    // Other Methods
    @Override
    public String speak() { return "Meow!"; } 

    // toString
    @Override
    public String toString() {
        String answer = "Name: " + super.getName() + " Age: "+super.getAge()
                + " Color: " + this.color;
        return answer;
    }
} 
```

所以发生的事情是我无法获得主要方法来找到该`cat.getColor()`方法，或者任何其他子类独有的方法。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-05T01:55:05.647

当您将变量声明为具有超类的类型时，您只能通过该变量访问超类​​的（公共）方法和成员变量。

```
Pet cat = new Cat("Feline",12,"Orange"); 
cat.getName(); // this is OK
cat.getColor(); // this is not OK, getColor() is not in Pet 
```

要访问具体类中的方法（`Cat`在这种情况下），您需要将变量声明为派生类

```
Cat cat = new Cat("Feline",12,"Orange"); 
cat.getName(); // OK, getName() is part of Cat (and the superclass)
cat.getColor(); // OK, getColor() is part of Cat 
```

或将其转换为您知道/怀疑是具体类型的类型

```
Pet cat = new Cat("Feline",12,"Orange"); 
((Cat)cat).getName(); // OK (same as above)
((Cat)cat).getColor(); // now we are looking at cat through the glass of Cat 
```

您甚至可以结合使用这两种方法：

```
Pet pet = new Cat("Feline",12,"Orange"); 
Cat cat = (Cat)pet;
cat.getName(); // OK
cat.getColor(); // OK 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:48:01.313

```
Pet cat = new Cat("Feline",12,"Orange");
^^^
This is the error. 
```

`Pet`没有一个名为的方法`getColor()`

你需要做：

```
Cat cat = new Cat(...); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T01:50:33.280

当你这样做时：

```
 Pet cat = new Cat("Feline",12,"Orange"); 
```

编译器将变量 cat 视为 Pet。所以不能使用 Cat 类的具体方法。

您必须将 cat 声明为 Type Cat 才能解决您的问题。

问候。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-11T23:32:35.000

在这里，您尝试使用作为子类方法的构造函数 (Cat) 创建超类类型 object(cat)，这是不可能的。这违反了继承规则。

`Pet cat = new Cat("Feline", 12, "Orange");`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-17T08:00:19.903

您还可以将这些空方法添加到您的 Pet 类中：

```
public String getColor() { }
public String setColor() { }
public String speak() { } 
```

这样，您可以从 Pet 对象调用此方法，而无需将其强制转换为 Cat。一旦被调用，Cat 的方法就会覆盖超类中的方法。这个技巧的缺点是您必须在超类中为您打算从子类调用的每个方法声明一个空方法，如果要添加多个方法，这可能会变得混乱。因此，仅对将在许多不同子类中使用的方法执行此操作。

# solr - 删除 Solr 中的所有文档导致 400 错误请求

> ID：10021605
> 
> 赞同：0
> 
> 时间：2012-04-05T01:43:36.950
> 
> 标签：solr

我创建了一个包含以下内容的 xml 文件“cleanall.xml”：

```
<?xml version="1.0" encoding="UTF-8"?>
<delete><query>*:*</query></delete>
<commit /> 
```

然后发出以下命令：

```
java -Durl=http://localhost:8080/solr/update -jar post.jar cleanall.xml 
```

它返回 #400 错误请求。但如果我发出另一个命令：

```
java -Ddata=args -Dcommit=yes -Durl=http://localhost:8080/solr/update -jar post.jar "<delete><query>*:*</query></delete>" 
```

然后它运行正常。不允许`post.jar`在 xml 文件参数中指定删除命令？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T06:40:06.933

post.jar 自动将更改提交到 Solr 索引。只使用这个 -

```
<delete><query>*:*</query></delete> 
```

所以你不需要在xml中明确。

400 错误是因为您在 xml 中有多个根。

```
Error 400 Illegal to have multiple roots (start tag in epilog?). 
```

# perl - Perl OpenOffice::OODoc - 访问页眉/页脚元素

> ID：10021610
> 
> 赞同：1
> 
> 时间：2012-04-05T01:44:28.573
> 
> 标签：perl, odt

如何在 odt 文档的页眉/页脚中获取元素？

例如我有：

```
use OpenOffice::OODoc;    
my $doc = odfDocument(file => 'whatever.odt');
    my $t=0;
    while (my $table = $doc->getTable($t))
    {
       print "Table $t exists\n";
       $t++;
    } 
```

当我检查表格时，它们都来自身体。我似乎无法在页眉或页脚中找到任何元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T13:05:35.083

[我在这里](http://www.oakbox.com/OOODoc/examples.tar.gz)找到了示例代码，这让我得到了答案：

```
#! /usr/local/bin/perl

use OpenOffice::OODoc;

my $file='asdf.odt';

# odfContainer is a representation of the zipped odf file 
# and all of its parts.
my $container = odfContainer("$file");

# We're going to look at the 'style' part of the container,
# because that's where the header is located.
my $style = odfDocument
    (
    container => $container,
    part      => 'styles'
    );

# masterPageHeader takes the style name as its argument.
# This is not at all clear from the documentation.
my $masterPageHeader = $style->masterPageHeader('Standard');
my $headerText = $style->getText( $masterPageHeader );

print "$headerText\n" 
```

母版页样式定义了文档的外观和感觉——想想 CSS。显然，“标准”是 OpenOffice 创建的文档的母版页样式的默认名称……这是最难破解的问题……一旦我找到示例代码，它就掉在了我的腿上。

# c# - 遍历数据库中的列

> ID：10021616
> 
> 赞同：0
> 
> 时间：2012-04-05T01:45:02.253
> 
> 标签：c#, database, visual-studio

单击“登录”按钮时，我想遍历表中的列并检查是否发生匹配。我该怎么做呢？我已经连接到一个数据库，我正在从数据库中读取并写入数据库。我不确定如何遍历数据库。

PS 我是 C# 和视觉工作室的新手。我在 C# 方面没有太多麻烦，因为我是从 Java 过来的，但是我很难掌握 Visual Studio。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:13:56.660

这很简单，你会看到。

```
 SqlConnection myConnection = new SqlConnection(@"Server = (Local); Integrated Security = True;" + "Database = insertDataBaseName"); // Assuming (Local)
            myConnection.Open();
            SqlCommand myCommand = myConnection.CreateCommand();
            myCommand.CommandText = ("SELECT UserName, Password,from Login"); // Where Login is your table . UserName and Password Columns
            SqlDataReader myReader = myCommand.ExecuteReader();
            bool login = false;

            while (myReader.Read())
            {
                if (userNameBox.Text.CompareTo(myReader["UserName"].ToString()) == 0 && passwordBox.Text.CompareTo(myReader["Password"].ToString()) == 0) // A little messy but does the job to compare your infos assuming your using a textbox for username and password
                {
                    login = true;
                }
            }

            if (login)
            {
                      //Your're in.
            }

            else
            {
                MessageBox.Show("Invalid UserName or Password", "Access Denied"); // Error message
            }

                 myReader.Close(); 
                 myConnection.Close(); // Just close everything 
```

希望这可以帮助。如果您对此代码部分有任何疑问，请不要犹豫。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:51:07.170

在 sql 中这样的东西会有所帮助

```
Select top(1) from Users where Id = @Id 
```

或在 linq

```
var user = (from u in users 
            where u.Id == id
            select u).SingleOrDefault(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T02:24:49.473

如果您正在检查用户名密码验证，我认为您不应该获取所有用户记录并通过它循环迭代。如果您获得 100000 个用户注册怎么办？你真的想迭代 100000 次吗？真的吗 ？

您可能应该查询您正在寻找的特定记录

像这样的东西

```
SELECT TOP 1 UserID,FIRSTNAME,LASTNAME,HASHED_PASSWORD,SALT WHERE USERNAME='kristy' 
```

在您的数据库中再次执行该查询并查看是否存在任何记录，如果存在一条记录，现在您可以使用您拥有的数据验证密码。

# php - Mailgun & CI / PHP

> ID：10021621
> 
> 赞同：0
> 
> 时间：2012-04-05T01:45:38.150
> 
> 标签：php, email

将 Mailgun 视为向大量收件人发送 HTML 电子邮件的良好解决方案

这将如何通过 CI 实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T01:55:55.257

我会使用 MailGun 的[SMTP 传送](http://documentation.mailgun.net/quickstart.html#sending-messages)和为 SMTP 配置的标准 Codeigniter[电子邮件库](http://codeigniter.com/user_guide/libraries/email.html)。

我最近对 ​​SendGrid 做了类似的事情。与 Sendgrid 一起工作，除了对他们的 smtp 服务器进行身份验证外，无需担心任何事情。Sendgrid 处理数量没有任何问题（尽管接收者少得多 - 大约 1k）。

# java - JSF：禁用组件时，其值不会进入请求映射参数。有解决方法吗？

> ID：10021634
> 
> 赞同：6
> 
> 时间：2012-04-05T01:47:28.773
> 
> 标签：java, jsf, primefaces

我有一个下拉列表`p:selectonemenu`和一个复选框`p:selectbooleancheckbox`，当我选择复选框时，我想将其设置`selectonemenu`为特定值。而且我不希望用户更改它，所以我将`selectonemenu` `disabled`属性设置为`true`. 但是，当它被禁用时，它的值不会出现在请求参数映射中，当我这样做时`facescontext.getcurrentinstance().getexternalcontext().getrequestparametermap()`，我需要它的值到这个映射。有没有办法解决这个问题？

我为遗留 Servlet 系统编写了一个字体端，它们使用请求映射参数来获取表单属性值。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T12:03:30.823

正如 Adrian Mitev 在评论中指出的那样，禁用该`selectBooleanCheckbox`组件将意味着它不会在表单提交上发布其值。

但是，您可以做的是有一个隐藏的输入字段，您可以在其中将值设置为与复选框相同的托管 bean 属性。

```
<h:inputHidden id="checkDisabled" value="#{managedBean.someValue}" /> 
```

当复选框被禁用时，您可以使用 javascript 设置此隐藏输入的值。

# sql-server - 使用 where table1.jobid = table 2.jobid 在 SQL Server 中移动数据

> ID：10021635
> 
> 赞同：1
> 
> 时间：2012-04-05T01:47:39.817
> 
> 标签：sql-server, where

只是想知道是否有人可以帮助我完成一个非常简单的 SQL 查询。

我需要将数据从 table1 传输到 table2`where table1.jobID = table2.jobID`

我应该使用 join 吗？

我只想用来自 table1 的数据填充一个 NULL 列，使用 jobID 来匹配。

提前致谢

交流电

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:50:28.567

由于知识有限，听起来您只需要一个简单的更新：

```
UPDATE PreviousJobsTEST
SET dValuationDate = Jobs.dValuationDate
FROM PreviousJobsTEST
    JOIN Jobs
        ON PreviousJobsTEST.iJobID= Jobs.iJobID 
```

如果您只想在它为空时更新它，那么您可以这样做：

```
UPDATE PreviousJobsTEST
SET dValuationDate = CASE WHEN PreviousJobsTEST.dValuationDate IS NULL THEN Jobs.dValuationDate ELSE PreviousJobsTEST.dValuationDate END
FROM PreviousJobsTEST
    JOIN Jobs
        ON PreviousJobsTEST.iJobID= Jobs.iJobID 
```

或者，根据您的评论，您可以执行您列出的操作，您只需将其转换为插入后面的 SELECT ：

```
INSERT INTO [DocPrep].[dbo].[PreviousJobsTEST] (dValuationDate) 
SELECT [DocPrep].[dbo].[Jobs].[dValuationDate]
FROM [DocPrep].[dbo].[PreviousJobsTEST]
    JOIN [DocPrep].[dbo].[Jobs] 
        ON [DocPrep].[dbo].[Jobs].[iJobID] = [DocPrep].[dbo].[PreviousJobsTEST].[iJobID] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:06:17.657

当 t1.column 为 null 时，您需要更新。当 t1.column 不为空时，您应该将其设置为自身。

```
SELECT *
INTO   #table1
FROM   (SELECT '1'  AS jobid,
               NULL AS column1
        UNION ALL
        SELECT '2',
               NULL
        UNION ALL
        SELECT '3',
               NULL
        UNION ALL
        SELECT '4',
               'A'
        UNION ALL
        SELECT '5',
               NULL) a

SELECT *
INTO   #table2
FROM   (SELECT '1' AS jobid,
               '1' AS column1
        UNION ALL
        SELECT '2',
               '2'
        UNION ALL
        SELECT '3',
               '3'
        UNION ALL
        SELECT '4',
               '4'
        UNION ALL
        SELECT '5',
               '5')b

UPDATE t1
SET    t1.column1 = ( CASE
                        WHEN t1.column1 IS NULL THEN t2.column1
                        ELSE t1.column1
                      END )
FROM   #table1 t1
       LEFT JOIN #table2 t2
         ON t1.jobid = t2.jobid

SELECT *
FROM   #table1 
```

# javascript - 有没有办法使用greasemonkey暂停（然后取消暂停）第3方网站上所有正在运行的js脚本？

> ID：10021642
> 
> 赞同：2
> 
> 时间：2012-04-05T01:48:44.800
> 
> 标签：javascript, greasemonkey

**tl；博士**——这是否可以使用greasemonkey暂停或停止页面上所有正在运行的js？

**情况是这样的：**我讨厌在 fb 上观看视频时，他们如何口吃。我 99% 确定卡顿是由后台运行的过多 js 引起的（提供所有实时页面更新）

**这就是我想要做的：**创建一些将暂停所有 js 执行的代码（我会将它附加到一个按钮或可能在播放视频时自动检测） - 然后稍后恢复执行（在视频完成后）（这部分不是必需的，我总是可以重新加载页面）

现在我知道我可以使用像 noscript 这样的插件来暂停 - 取消暂停，但如果我能有一些自动魔法的东西会很好（而且更苗条）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T02:43:10.440

不，没有简单的通用 Greasemonkey 解决方案来停止或阻止网页脚本的执行。Greasemonkey 可以添加，但不能删除，javascript。Opera 更强大的用户 Javascript 系统可以做到这两点。

/ Greasemonkey 共同维护者

# java - Java 中 Windows NFS 的 Runtime.getRuntime().exec() 问题

> ID：10021644
> 
> 赞同：1
> 
> 时间：2012-04-05T01:48:54.230
> 
> 标签：java, windows, runtime, mount, runtime.exec

我已经为 Windows 2008 安装了 NFS，但是当我尝试访问 C:/Windows/System32/mount.exe 或 umount.exe 并在 Java 中执行它时，我得到一个找不到文件的 IO 异常。

```
Runtime.getRuntime().exec("C:/Windows/System32/mount.exe <location> J:"); 
```

如果您认为它可能，这也不起作用：

```
Runtime.getRuntime().exec("cmd.exe /C call C:/Windows/System32/mount.exe <location> J:"); 
```

该文件甚至不会通过 Java 注册为现有文件

```
if(new File("C:/Windows/System32/mount.exe").exists())
    System.exit(0);
else
    System.exit(-1); 
```

此代码将始终退出 -1

我一遍又一遍地验证该文件确实存在并且我的命令有效。到底是怎么回事？如何通过 Java for Windows 挂载 NFS 驱动器？

```
java.io.IOException: Cannot run program "C:/Windows/System32/mount.exe": CreateProcess error=2, The system cannot find the file specified
at java.lang.ProcessBuilder.start(Unknown Source)
at Data.SystemExecutor.exec(SystemExecutor.java:46)
at Data.SystemExecutor.exec(SystemExecutor.java:18)
at Mount.Mount.setMount(Mount.java:40)
at Mount.Mount.<init>(Mount.java:30)
at Main.Main.main(Main.java:94)
Caused by: java.io.IOException: CreateProcess error=2, The system cannot find the file specified
at java.lang.ProcessImpl.create(Native Method)
at java.lang.ProcessImpl.<init>(Unknown Source)
at java.lang.ProcessImpl.start(Unknown Source)
... 6 more 
```

我也尝试以管理员身份运行 CMD

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:24:21.187

这听起来像是位数的问题（即，运行 32 位版本的 Java 并安装了 64 位版本的 SUA）。`C:\Windows\System32`为 32 位应用程序重定向到`C:\Windows\SYSWOW64`. 看到这个[问题](https://stackoverflow.com/questions/1855042/system32-folder-on-a-64-bit-system)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:01:27.697

尝试创建一个执行“java yourClass”并以管理员身份运行的 .bat 文件。可能是windows中的权限设置。

# php - 显示数据库中的数据

> ID：10021647
> 
> 赞同：0
> 
> 时间：2012-04-05T01:49:29.473
> 
> 标签：php, mysql

我正在尝试显示数据库中的数据，我想知道我做错了什么。

班级：

```
class Information {

    protected $info;

    protected $sinfo;

    public function __construct()
    {
        $this->db = new Config;

        $r = $this->db->query('SELECT * FROM categories');

        while($row = $r->fetch_array())
        {
            $this->info[] = $row;
        }

    }

    public function getCategory()
    {
        return $this->info;
    }

    public function getCategoryTitle($category_title)
    {
        echo $category_title;
    }

    public function getListing($category_id)
    {

        $s = $this->db->query("SELECT * FROM listings WHERE category_id = $category_id");

        while($sow = $s->fetch_array())
        {
            $this->sinfo[] = $sow;
        }
        return $this->sinfo;
    }

    public function getListingTitle($listing_title)
    {
        echo $listing_title;
    }

} 
```

显示信息：

```
$display_listings = new Info();

foreach ($display_listings->getCategory() as $row) 
{
    $display_listings->getCategoryTitle($row['category_title']);

    foreach ($display_listings->getListing($row['category_id']) as $sow)
    {
        $display_listings->getListingTitle($sow['listing_title']);
    }
} 
```

由此可见：

第一类

清单 1

第 2 类

清单 1

清单 2

第 3 类

清单 1

清单 2

清单 3

我希望它显示：

第一类

清单 1

第 2 类

清单 2

第 3 类

清单 3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:55:15.470

也许尝试把它放在 getListing 的开头：

```
$this->sinfo = ''; 
```

看起来数组保留了以前的值。

# java - 我可以在 Hibernate 中一次保存多条记录吗？

> ID：10021648
> 
> 赞同：1
> 
> 时间：2012-04-05T01:49:35.550
> 
> 标签：java, hibernate

我有特定班级的名单。我想使用 Hibernate Transaction 一次保存此列表而无需循环。可能吗 ？

假设我有一堂课

```
 Class a{
    private int no;
    private String name;

    public getNo(){
    return this.no;
    }
    public setNo(int no){
    this.no=no;
    }
    public getName(){
    return this.name;
    }
    public setName(String name){
    this.name=name;
    }
} 
```

我现在有

```
List<a> list; 
```

所以我可以直接保存列表而不循环？如果是，请帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T01:56:10.623

你可以在没有循环的情况下做到这一点

为此，您需要使用 spring 的休眠实用程序

那个实用程序喜欢

```
getHibernateTemplate().saveOrUpdateAll(questionsCollection); 
```

或者

```
getHibernateTemplate().deleteAll(questionsCollection); 
```

# cocoa-touch - 为什么我在 Cocoa touch for ios/macos 下看不到“UIViewController 子类”？

> ID：10021650
> 
> 赞同：5
> 
> 时间：2012-04-05T01:50:11.387
> 
> 标签：cocoa-touch, uiviewcontroller

我是一个新手，显然是从“Beginning-iOS-5-Games-Development”一书中的示例代码开始的。一切似乎都很简单，但我看不到 Cocoa touch 下的 UIViewController 子类对于 ios/macos ......这是否与该示例试图使用通用设备类型的事实有关。我的 Xcode 版本是 4.3.2，我正在试用 ios5...

感谢您的帮助..

用户

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T04:34:38.340

您必须选择`Objective-C class`，然后单击`Next`。在下一个屏幕上，您可以指定您正在创建的类是`UIViewController`.

# c++ - 五子棋（5-in-a-row）计算机逻辑

> ID：10021651
> 
> 赞同：0
> 
> 时间：2012-04-05T01:50:17.713
> 
> 标签：c++, arrays, logic, tic-tac-toe

好的，让我先说我的教授向我们提出了一个项目，我认为我们还没有准备好接受。尽管如此，我必须构建一个“智能”的连续 5 人游戏。所以我开始让程序使用这个询问用户电路板的尺寸：

[https://gist.github.com/2307257](https://gist.github.com/2307257)

现在由于这个游戏中的棋盘很大，我想要一个算法来对棋盘上的空间进行排序，以便计算机尝试控制棋盘的中间。例如，在 5x5 板上，值将是：

1 1 1 1 1

1 2 2 2 1

1 2 3 2 1

1 2 2 2 1

1 1 1 1 1

在这种情况下，计算机将选择棋盘的中间（值三）。作为一个菜鸟，我在做这件事时遇到了一些困难。我一直在想我可以用一些循环来做到这一点，因为我相信板上任何位置的值应该是：array [（min width + i）到（max width - i）] [（min height + i）通过（最大高度 - i）] = 1 + i 对吗？好吧，我一直在尝试使用这样的东西：

[https://gist.github.com/2307327](https://gist.github.com/2307327)

但当然它不起作用，否则我不会在这里。所以请帮我解决这个问题。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:31:45.303

该代码将导致缓冲区溢出，因为长度/大小为 5 的数组将具有从 0 到 4 的索引。

当 y 等于高度时，第 27 行将导致崩溃，因为您将导致写入超出数组边界。当 x 等于宽度并且 y 小于高度时，您将写入数组 [0][y+1] 单元格。

你的循环应该是 ... for (y = 0; y < height; y++) for (x = 0; x < width; x++) ... 因为高度和宽度（比如他们）等于 5。y 和 x 将迭代从 0 到 4。这将是有效的数组索引。

如果要填充数组，如上所示，则忽略 y 方向。你可以简化。

```
#define MIN(A, B) (((A) < (B)) ? A : B)

// x or y is cell 0 to 4 then the cell value should x or y + 1
// x or y is close to the other edge then the cell value should be width - x, or height - y
// I'm assuming that if the playing field is larger than 9x9 then a cell value of 5 is
// good enough.
array[x][y] = 
   MIN(
      5,
      MIN(
         MIN(x + 1, width  - x),
         MIN(y + 1, height - y))); 
```

我看到你试图通过意识到结果与第 27 行对称来变得聪明。但是，如果你这样做，那么你应该更改 for 循环以迭代宽度的“一半”（最终是高度）。否则你将被覆盖已经计算过的单元格。简而言之，这是一种优化。你应该先做的事情，然后先做一些事情。

通常，就速度而言，做一些简单易懂的事情就“足够好”了，可能不需要优化。在这种情况下，您需要一台 1970 年代的超慢机器，以使脑死亡的简单算法看起来很慢。

一些挑剔...
- 验证您的输入。如果某些 yahoo 输入负数，则在尝试创建数组时会崩溃。在这种情况下，接受小于 5 的值是没有用的，因为您需要连接 5。4x4 的板将导致不可能。

# php - PHP mail() 函数不会发送到 gmail 但会发送到我的非 gmail 帐户

> ID：10021655
> 
> 赞同：7
> 
> 时间：2012-04-05T01:50:30.187
> 
> 标签：php, email

由于某种原因，php mail() 函数在我正在构建的站点上无法正常工作。我试图以最简单的形式解决问题，并提出了这个文件：

```
<?php
mail('myEmail@gmail.com', 'the subject', 'the message', 'From: webmaster@example.com', '-fwebmaster@example.com');
?> 
```

当 myEmail 是 Gmail 帐户时，我从未收到过邮件。但是，当我使用非 gmail 帐户时，我确实会收到该消息。我很茫然，已经尝试了一切来解决这个问题。我开始认为这是一个晦涩的主机/服务器问题。您可以在此处查看服务器规格：http: [//aopmfg.com/php.php](http://aopmfg.com/php.php)

有任何想法吗？

编辑 - 让我还补充一点，几周前一切正常，这是我最后一次测试它。从那以后根本没有重大的代码更改。

编辑 2 - 在阅读了类似的帖子后，我尝试添加 From 和 Reply-To 标题......仍然没有运气。新代码：

```
<?
$headers = 'From: <some@email.com>' . "\r\n" .
'Reply-To: <some@email.com>';

mail('<myEmail@gmail.com>', 'the subject', 'the message', $headers,
'-fwebmaster@example.com');
?> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-23T01:22:36.760

事实证明，谷歌阻止了我的服务器，因为同一服务器上的另一个站点被黑客入侵并用于垃圾邮件。

为了测试并确保这是服务器的问题，我创建了一个简单的 PHP 文件，它会在页面刷新时向我的电子邮件地址发送一封电子邮件。当我发送到基于交换的电子邮件地址时，它起作用了，但没有发送到任何与 Google 相关的帐户。

代码：

```
$headers = 'From: <test@test.com>' . "\r\n" .
'Reply-To: <test@test.com>';

mail('<myEmail@gmail.com>', 'the subject', 'the message', $headers,
  '-fwebmaster@example.com');
?> 
```

感谢大家的帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T02:03:05.603

尝试将 <> 放在 From 和 Reply to 地址周围。我在工作电子邮件中遇到了同样的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-04T10:03:24.183

我对gmail也有类似的问题。然而，我的主题标题是“看看你是否赢了”。当我将其更改为更少的营销/垃圾邮件时，它就通过了。因此，造成这种情况的并不总是 PHP 代码，但也可能是被列入黑名单的主题标题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-03T14:43:56.037

我遇到了同样的问题。但是当我检查我的 C:\xampp\mailoutput 文件夹时，发送的邮件是在这个文件夹中接收的。现在请检查并做必要的事情。它是在我的测试本地服务器中发送的。如果它是在真实服务器上发送的，那可能在您的托管服务器上，您必须通过网站托管商进行检查

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-28T06:26:46.890

我发现将 SPF 和 DKIM 记录添加到 DNS 解决了这个问题。我可以使用 phpmail() 函数发送到 Gmail 订阅者列表。

1.  在 php.ini sendmail 参数或 mail() 额外参数字段中的 -f 选项中使用的电子邮件中的域需要具有该域的有效 SPF 记录。
2.  您还应该使用域密钥或 DKIM。这里的诀窍是域密钥/DKIM 区分大小写！

更新记录后，邮件将被发送到 Gmail、Yahoo 和 AOL 地址。

在此处阅读源代码。来自 ABOMB 的评论

[https://www.php.net/manual/en/function.mail.php#107321](https://www.php.net/manual/en/function.mail.php#107321)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-24T14:10:42.443

我有同样的问题。我使用密件抄送电子邮件地址记录发送的消息。这是一个优势，好像 gmail 或 hotmail 阻止了邮件然后密件抄送也被阻止了。我创建了一个 SPF 记录，但它本身并没有帮助，但这可能是个好主意。似乎对我有帮助的是将电子邮件地址放入 <> 并在标题中添加对条目的回复。

```
$headers = 'From: <test@test.com>' . "\r\n" .
'BCC: <fred@test.com>' . "\r\n" .
'Reply-To: <test@test.com>';

mail('<myEmail@gmail.com>', 'the subject', 'the message', $headers); 
```

# powershell - Powershell 设置 GPO

> ID：10021659
> 
> 赞同：0
> 
> 时间：2012-04-05T01:50:49.413
> 
> 标签：powershell, active-directory, powershell-2.0, gpo

我想设置“中度风险文件类型的包含列表”的值以启用并将文件扩展名添加到列表中。密钥存在于：

```
User Configuration>Administrative Templates>Windows Components>Attachment Manager 
```

如何使用 powershell 打开和关闭它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:33:12.823

要在 W2K8 R2 计算机上基于注册表项创建 GPO，路线图如下

导入 Active-Directory 模块：

`Import-module activeDirectory`

创建一个 GPO 并将其链接到一个 OU ：

```
New-GPO -Name "MyGPO" | New-GPLink -target "ou=MyOU,dc=silogix,dc=fr" -LinkEnabled Yes" 
```

创建注册表值：

```
Set-GPPrefRegistryValue -Name "MyGPO" -Context User -Action Create -Key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MyClef" -ValueName Value1 -Value Value2 -Type string 
```

# c++ - 允许安装在应用程序级别的文件系统库

> ID：10021665
> 
> 赞同：1
> 
> 时间：2012-04-05T01:51:25.820
> 
> 标签：c++, design-patterns, architecture, filesystems

我一直在寻找一个文件系统的库，它允许在纯粹的应用程序级别上进行路径安装。这可能不仅仅被称为“路径安装”，因为它具有操作系统级别路径安装的含义，但还有其他一些东西，我不确定术语。我希望能够找到一些，但无法找到我正在寻找的任何东西（boost::filesystem 是我找到的最接近的）。我希望能够比较几个不同的库，以期了解它们的优缺点。

我所说的带有路径挂载的文件系统是什么意思，所以我会有一个路径，例如

`"SomeRoot:data\file.txt"`

并将`"SomeRoot"`替换为`C:\SomeFolder"`，它将设置为文件挂载系统。

有谁知道允许路径挂载的文件系统？

编辑：

由于看起来可能没有很多图书馆，我也会对如何正确构建一个感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T03:00:04.477

如果您正在寻找“应用程序级文件系统”，那么在最基本的级别上，您将需要进行字符串替换。在最基本的层面上，有两个字符串

`MountPoint` 它将用作“挂载点”，例如您的`SomeRoot`.

`MountResolve` 这是`mount point`“解析”文件位置时指向的位置。这和你的一样`C:\SomeFolder`。

除了这些变量的明显访问器和获取器之外，还需要一个函数来解析路径，这种情况可以是

`bool ResolvePath(const String& mountPath, String& resolvedPath);`

的内容`ResolvePath`很简单，你只需要把当前`MountPoint`字符串替换进去，`mountPath`然后把结果放到`resolvedPath`.

```
resolvedPath = mountPath;
resolvedPath.replace(0, mMountPoint.size() + 1, mMountResolve.c_str(), mMountResolve.size()); 
```

但是，在该功能中还可以做更多事情。我让它返回 bool 的原因是函数应该失败`mountPath`没有`MountPoint`. 要检查，只需做一个简单的`string::find`.

```
if(mountPath.find(mMountPoint) == String::npos)
    return false; 
```

有了这个，您现在可以解析`SomeRoot:data\file.txt`MountResolve`C:\SomeFolder\data\file.txt`是否设置为`C:\SomeFolder\`。但是，您提到末尾没有斜杠。由于目前没有任何事情可以验证该斜线，因此您的结果将是`C:\SomeFolderdata\file.txt`. 这是错误的。

在您设置挂载解析的访问权限时，您要检查是否有尾随文件夹斜杠。如果没有，则添加它。

```
void FileSystem::SetMountResolve(const String& mountResolve)
{
    mMountResolve = mountResolve;

    if(*(mMountResolve.end() - 1) != FOLDERSLASH)
        mMountResolve += FOLDERSLASH;
} 
```

这将允许一个基本的“文件系统”类有一个 MountPoint/MountResolve。扩展它以允许多个挂载点也不是很困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T06:24:55.287

> 我一直在寻找允许路径挂载的文件系统的库

你应该忘记它。在 Linux 上可以阻止安装路径/驱动器（可能需要管理员权限），而在 Windows 上没有内置机制（尽管有目录连接）。在某些发行版上，您必须是 root 才能安装 cdrom 驱动器。手动。

> 有谁知道允许路径挂载的文件系统？

ntfs、ext3、jfs。操作可能需要 root/管理员权限。

> 并且“SomeRoot”将替换为 C:\SomeFolder”

您需要在程序中使用类似于环境变量的东西。使用 "${SomeDir}/path" 并将 ${SomeDir} 替换为您想要的任何内容。这将比安装更容易实现。

- 编辑 -

> 我所说的带有路径挂载的文件系统的意思是，我会有一个诸如“SomeRoot:data\file.txt”之类的路径

为 fopen 或您使用的任何东西提供自定义包装器。或者制作实现“文件”的自定义类。在该类/包装器中，通过在提供的文件路径上进行搜索/替换来添加对“挂载”的支持——可能使用存储在程序中的变量集合。这是最简单的解决方案。当然，您还必须包装您将使用的其他文件功能，但这仍然比跨平台安装要容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T11:46:21.897

您可能还想考虑[PhysicsFS](http://icculus.org/physfs/)。本质上，它是一个抽象文件位置的库。您可以定义“搜索路径”，每当您读取文件时，就会在这些位置（即文件夹或档案）中搜索该文件。例如，如果您想阅读“logo.png”，可能会在以下位置搜索它：

```
C:\mygame\data
E:\mygame\data (read-only CD-ROM)
C:\mygame\data.zip 
```

写入文件时，它总是存储在一个特殊的“写入路径”中。

PhysicsFS 还有一个应用级挂载的概念。引用他们的网页：

> PhysicsFS 2.0 将“挂载”档案的概念添加到搜索路径中的任意点。如果 zip 文件包含“maps/level.map”并且您将该存档安装在“mods/mymod”，那么您必须打开“mods/mymod/maps/level.map”才能访问该文件，即使“mods/ mymod”实际上并未在 .zip 文件中指定。与挂载文件系统的 Unix 心态不同，挂载 zipfile 时实际上不必存在“mods/mymod”。这是一个“虚拟”目录。

当然，整个解决方案是 100% 的用户空间，不需要内核支持或管理权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T05:21:38.693

Unix 上的 FUSE，MacOS X 上的 FUSE4X，我们在 Windows 上带有 FUSE 适配器的回调文件系统。没有单一的跨平台解决方案，因为文件系统驱动程序的体系结构在这些平台上是不同的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T22:00:18.537

好像您正在寻找符号链接功能。

在 Posix 系统上，例如 Linux/Unix，您可以查看 link()/symlink()。此功能一直存在并且非常可靠。

在 Windows 上，您可能需要查看 CreateSymbolicLink() 和公司。这些是在 Windows 2000 中引入的，我不确定它们有多强大。

文件系统的实际挂载是一件比较棘手的事情，实际上取决于你挂载的是什么——NTFS、FAT、ext3、XFS、NFS、CIFS、WebDAV 等。

# jquery - 如何从 div 中删除附加文本？

> ID：10021667
> 
> 赞同：0
> 
> 时间：2012-04-05T01:51:41.767
> 
> 标签：jquery, json

你好，我是新来的，我希望我不要在错误的地方发帖问题是这样的：我使用 .getJson 从数据库中检索结果。一旦我点击一个img，结果就会附加到一个表[多行]中，它会将数据的详细视图加载到一个div（或另一个表）中。我的问题如下：我必须删除详细 div 的旧内容 - 只有 appendTo 部分 -

代码看起来像这样：

脚本：

```
$("button.#results").click(
function(){
$.getJSON(dataretrive.php?callback=?&query=1' ,
function(data) {
$.each(data, function(i, item) {
var mindata = "<tr><td class='border'>" +data[i].name+ "</td>";
.... [minimal data]

$(mindata).appendTo("table.#shorttableinfo");

var detailfull = "<tr valign='top' height='25' width='100px'><td> Name: </td><td>" + data[i].name + "</td></tr>"
... [lots of data]

$("img.#editrow" + i ).click(   
function(){
    $(detailfull).appendTo("table.#detailsfull");
});
});
});
}); 
```

的HTML：

[html代码]

```
&lt;table id="shorttableinfo"&gt; // i need a small table here

&lt;tr&gt;&lt;td&gt;Name:&lt;/td&gt;&lt;td&gt; [other minimal data] &lt;/td&gt;&lt;/tr&gt;

&lt;/table&gt; 
```

[其他html代码]

```
&lt;table id="detailsfull"&gt; // i need a small table here

&lt;tr&gt;&lt;td&gt;Name:&lt;/td&gt;&lt;td&gt; [other minimal data] &lt;/td&gt;&lt;/tr&gt;

&lt;/table&gt; 
```

我的问题是我需要在 jquery 将新数据加载到带有 id detailsfull 的 tablbe 之前删除代码，而不删除表的第一行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:58:24.190

您的选择器在 上无效`appendTo()`，应该是`appendTo("table#shorttableinfo")`

您可以通过以下方式删除行

```
$('table#detailsFull tr:gt(0)').remove(); 
```

以上将删除所有行，但第一行`detailsFull`除外

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:59:06.030

给你添加的东西一个特定的类：

```
var detailfull = "<tr class=specific-data valign='top' height='25' width='100px'><td> Name: </td><td>" + data[i].name + "</td></tr>" 
```

然后清除它：

```
$('#detailsfull').find('.specific-data').remove(); 
```

# jquery - Backbone JS从视图函数中重置视图集合

> ID：10021668
> 
> 赞同：0
> 
> 时间：2012-04-05T01:51:48.880
> 
> 标签：jquery, backbone.js, coffeescript

我有一个我认为很容易诊断的问题，但我似乎无法自己解决。

我有以下用 CoffeeScript 编写的缩写 Backbone 代码：

```
events = FD.Events # collection

# instantiated on page load with collection: events
class FD.StreamView extends Backbone.View

el: $(".stream")

initialize: ->
    # Bind the view to listen for a reset of the collection and rerender
    @collection.on("reset", @render)

    # Listen for a change to this model and run the function getActivities
    FD.filters.on("change", @getActivities)

render: =>
    # render function code

getActivities: =>
    # create a new instance of the FD.Events collection class
    events = new FD.Events

    # create a new instance of this view, passing in the new empty collection
    streamView = new FD.StreamView collection: events, model: FD.filters

    # make an AJAX call and as a part of the callback function, reset the collection
    # for the view we just instantiated above
    params = FD.filters.attributes
    callbackFunc = (responseText) ->
        json = $.xml2json(responseText)
        activities = json.activity
        events.reset activities
    params = FD.filters.attributes
    activities_json = $.get("/landing/Data", params, callbackFunc) 
```

如您所见，问题在于 getActivities 函数在每次调用集合时运行的次数加倍，因为它第一次运行时会创建第二个视图，然后这两个视图都会运行。当集合发生变化时，这两个实例中的每一个都会创建两个实例，所以我们现在有四个，并且所有四个都运行 getActivities。然后是8，然后是16。

显然，创建 FD.StreamView 类的新实例不是正确的方法，但我不知道如何重置单个视图所绑定的集合，以及如何触发绑定的 @render 函数。

任何的想法？如果我遗漏了重要信息，请告诉我。提前致谢。

迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:02:26.123

您想要的结构只是将视图绑定`render`到集合的事件，就像您拥有的那样，`reset`也可能`add/remove`取决于您的应用程序的具体情况。但是，`getActivities`应该简单地告诉集合通过该`fetch`方法获取数据，但使用当前的过滤器集（我假设这是一个搜索查询）。所以添加一个实例属性调用`filters`到你的集合类，在`getActivities`do`events.filters = FD.filters`然后 just `events.fetch()`。当响应到达时，集合将重置，这将触发一个导致`render()`执行的事件，瞧，您的视图将是最新的。您在`render()`其中发出 ajax 请求的代码属于集合，而不是视图。

# c - C 和 C++ 中 'char* numberlist[]' 的长度

> ID：10021671
> 
> 赞同：0
> 
> 时间：2012-04-05T01:51:57.627
> 
> 标签：c, visual-c++

尝试了解如何在 C 和 C++ 中获取 char* numberlist[] 中的项目总数，以下是代码：

```
const char* list_of_filename[] = {"One","Two","Three","Four","Five"}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T01:53:57.903

查找数组中元素个数的标准习语是

```
int num_items = sizeof(list_of_filename) / sizeof(list_of_filename[0]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T01:54:09.597

怎么样：

```
sizeof(list_of_filename) / sizeof(char*) 
```

或更一般地说：

```
sizeof(list_of_filename) / sizeof(list_of_filename[0]) 
```

# sql - 将 Sql 脚本存储在数据库表中的最佳方法

> ID：10021672
> 
> 赞同：-1
> 
> 时间：2012-04-05T01:52:23.717
> 
> 标签：sql, sql-server, sql-injection

我需要将存储过程执行脚本存储在数据库表中。

举个例子：

```
exec proc_name 'somedata' 
```

这些是在将要更改的数据经过审核过程后稍后执行的。

清理脚本以使该语句不能用于 sql 注入的最佳方法是什么。

是否有我可以使用的特定编码类型？还是像在*'上进行替换一样简单*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:00:39.980

那么听起来你想使用一个 varchar(max) 列并有一个单独的参数表。如果你使用参数，你应该免受 SQL 注入的影响。请参阅下面的快速 C# 示例：

C# 伪代码示例

```
SQLCommand command = new SQLCommand("select * from myScripts where scriptid = @scriptid");
SQLParameter param = new SQLParameter("@scriptid", 12, int);

...new SQLCommand("select * from myParams where scriptid = @scriptid");
...new SQLParameter...

DataReader dr = new blah blah...

SQLCommand userCommand = new SQLCommand(dr['sql']);

foreach (parameter in params)
{
    userCommand.Parameter.Add(parameter['name'], value);
}

userCommand.Execute... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:31:27.000

没有办法“清理”脚本。
保护代码的唯一方法是将代码与数据分开。并且只“清理”数据。

这就是我们将代码与数据分开的原因。
代码是可靠且安全的，数据是可变的，需要“清理”。

由于您违反了这条基本法则，将代码视为数据，因此无法保护它。

从任务的完全不寻常来看，我会说肯定有一个适当的解决方案。
你只是选择了错误的架构。
所以，你最好再问一个问题，比如“我想处理相当复杂的元数据结构（提供的结构和目的）”，你会得到一个合适的解决方案，不需要在数据中存储 SQL 代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T01:54:19.997

您可以将脚本存储在存储过程或计划作业中以供以后执行。我看不出有任何理由对存储过程进行编码，因为您可以设置用户权限来防止不同的用户阅读甚至看到它们。

# video - Windows中的ffmpeg关键帧提取

> ID：10021673
> 
> 赞同：0
> 
> 时间：2012-04-05T01:52:25.303
> 
> 标签：video, ffmpeg

我已经从这个站点下载了 ffmpeg：http: [//www.videohelp.com/tools/ffmpeg](http://www.videohelp.com/tools/ffmpeg)。

有人能告诉我如何从 flv、mp3 或 mp4 视频中提取关键帧吗？

我尝试了在网上找到的这个命令：

```
ffmpeg -i Wildlife.wmv Desktop/img_%05d.jpeg 
```

我得到了错误

> 无法打开文件：桌面/img_%05。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T07:07:35.947

您正在寻找的命令是：

```
ffmpeg -i INPUT.FLV -vf "select=key" key_frame_%d.jpg 
```

有关更多信息，请参阅[ffmpeg 文档](http://www.ffmpeg.org/ffmpeg.html)，尤其是视频过滤器选择[`select`](http://www.ffmpeg.org/ffmpeg.html#select)。

# selenium - 当远程桌面窗口不活动时，Java 机器人代码不起作用

> ID：10021675
> 
> 赞同：3
> 
> 时间：2012-04-05T01:52:35.033
> 
> 标签：selenium, webdriver, remote-desktop, awtrobot

我正在亚马逊云机器上运行一些硒测试。我的 web 应用程序有一个 flash 区域，我在其中模拟键盘类型并使用 java 机器人代码单击（还尝试了 auto it 脚本来模拟用户单击并在 flash 区域上键入）。当我使用远程桌面连接到服务器并且远程桌面窗口处于活动状态时，该代码有效，但是当我最小化远程桌面窗口时，java机器人代码不起作用？

```
 Robot robot = new Robot();
    robot.delay(5000);
    robot.mouseMove(400, 400);
    robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);
    robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);
    robot.delay(2000);
    robot.keyPress(KeyEvent.VK_H);
    robot.keyPress(KeyEvent.VK_I);
    robot.keyPress(KeyEvent.VK_SPACE);
    robot.keyPress(KeyEvent.VK_B);
    robot.keyPress(KeyEvent.VK_U);
    robot.keyPress(KeyEvent.VK_D);
    robot.keyPress(KeyEvent.VK_D);
    robot.keyPress(KeyEvent.VK_Y); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T14:01:42.857

我安装了 UltraVNC 服务器并使用 VNC 客户端连接。没有观察到问题，即使在断开连接后机器人也可以工作。以下是具体步骤：

1.  使用 Windows 远程桌面工具登录到远程计算机。
2.  将 UltraVNC 服务器安装为 Windows 服务。
3.  从系统注销（您仍在远程桌面工具中）。
4.  现在使用 VNC 查看器，连接到系统。
    您将看到登录屏幕。您现在可以使用 vnc viewer 登录系统。

# django - python django 从 datetime 对象中减去 timedelta 对象？

> ID：10021676
> 
> 赞同：0
> 
> 时间：2012-04-05T01:52:37.643
> 
> 标签：django, python-datetime

一个 python/django 初学者的问题：

我有一个 datetime 对象 (drive_date)、一个 time 对象 (start_time) 和一个 timedelta 对象 (when_to_notify)。

我首先这样做：

```
d = datetime.combine(l.drive_date, l.start_time) 
```

然后我想从 d 中减去“when_to_notify”timedelta 对象以获得通知日期和时间。但是，django 不喜欢这样。它告诉我： TypeError: unsupported operand type(s) for -: 'datetime.time' and 'datetime.timedelta'

如何从 datetime 对象中减去 timedelta 对象中的时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:05:19.680

[*从评论部分移出*]

`datetime.combine`返回可以从中减去`datetime`a 的 a 。`datetime.timedelta`从例外情况来看，您似乎正在尝试`datetime.timedelta`从时间对象而不是`datetime`对象中减去 a。可以复查吗？

# solr - SOLR - 仅当范围内的所有日期都匹配时才匹配范围查询

> ID：10021686
> 
> 赞同：1
> 
> 时间：2012-04-05T01:54:04.037
> 
> 标签：solr

我正在使用 SOLR 并存储销售人员可以访问客户的日期数组（旅行可以持续一天以上，具体取决于客户的要求）。对于每个销售人员，我都有一个给定月份可供销售人员使用的日期列表。还有其他字段，包括销售人员数据、地理位置信息等。

我熟悉范围查询，但似乎 SOLR 对数组的范围搜索的工作方式与我想要的不同——只要数组中的任何项目都是匹配的，那么范围就是匹配的）。我想向 SOLR 发送一个带有范围的查询，并且只有在数组中找到该范围内的所有日期时才返回匹配项。例如：

```
<arr name="available_dates">
    <date>2012-04-30T00:00:00Z</date>
    <date>2012-05-01T00:00:00Z</date>
    <date>2012-05-02T00:00:00Z</date>
</arr>

-- should match --
available_dates:[2012-04-30T00:00:00.000Z TO 2012-05-02T00:00:00.000Z]

-- should not match as 2012-04-29 is not contained in available_dates --
available_dates:[2012-04-29T00:00:00.000Z TO 2012-05-02T00:00:00.000Z] 
```

这是可能的还是我做错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T01:00:20.923

您有正确的想法，但[您的初始查询是*search*而不是*match*](http://lucene.apache.org/core/old_versioned_docs/versions/3_4_0/queryparsersyntax.html#Range%20Searches)。直观地说，您的搜索*应该*`available_dates:[2012-04-30T00:00:00.000Z TO 2012-05-02T00:00:00.000Z]`包含 的所有元素`available_dates`才能成功*匹配*。

您有两个选项可以有效且成功地实现此逻辑。您可以手动或动态地对数组中的每个元素执行范围查询，也可以设置一个辅助功能，在执行搜索后尝试执行匹配。例如：

`available_dates:[2012-04-30T00:00:00.000Z TO 2012-05-02T00:00:00.000Z](available_dates)`

也就是说，按从左到右的顺序：评估范围搜索，然后检查所有结果`available_dates`是否包含在此评估中（通过默认`AND`查询）。如果是，则返回元素。如果没有，不要。

从语法上讲，上述内容未经测试，可能不起作用。但在程序上，您应该能够围绕此起草正确的查询以满足您的需求。

（[讨论复合搜索查询的默认`AND`行为的](https://stackoverflow.com/questions/2613592/how-can-i-search-on-a-list-of-values-using-solr-lucene)附加资源）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T17:44:20.277

假设您要从数据库中导入此数据。

在您的数据库或搜索索引中，创建一个新列来存储销售人员日期的最大值（如最新日期）以及最小值。此外，计算并存储最大和最小日期之间的差异。

匹配查询必须匹配三个条件（因此在查询中使用 AND）

1.  查询的最大值和最小值之间的差异不能大于存储在索引中的差异

2.  你要确保 {!frange l=0 u=difn_bet_query_max_and_min}sub(field_min,query_min)

3.  为你的最大值制定同样的事情

有关功能范围的参考 [http://www.lucidimagination.com/blog/2009/07/06/ranges-over-functions-in-solr-14/](http://www.lucidimagination.com/blog/2009/07/06/ranges-over-functions-in-solr-14/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T09:39:58.647

您应该使用多个子句，而不是使用范围查询，每个日期一个子句。

所以而不是`available_dates:[2012-04-29T00:00:00.000Z TO 2012-05-02T00:00:00.000Z]`

你应该使用`available_dates:"2012-04-29T00:00:00.000Z" AND available_dates:"2012-04-30T00:00:00Z" AND available_dates:"2012-05-01T00:00:00.000Z" AND available_dates:"2012-05-02T00:00:00.000Z"`

希望这能回答你的问题！

# r - 使用 convertColor 将 sRGB 转换为 Lab？

> ID：10021692
> 
> 赞同：1
> 
> 时间：2012-04-05T01:55:13.270
> 
> 标签：r, rgb, lab-color-space

我正在尝试使用 Lab 颜色，并且需要从 sRGB 进行转换，最好使用 R。我刚刚尝试了[convertColor](http://stat.ethz.ch/R-manual/R-devel/library/grDevices/html/convertColor.html "转换颜色")，有点困惑。作为测试，我正在转换 Macbeth ColorChecker 色板，但没有得到完全正确的值。

例子：

```
swatch1sRGB <- c(115,82,68)/255
swatch1Lab <- convertColor(swatch1sRGB, from="sRGB", to="Lab")
swatch1Lab
            L      a.x        b
[1,] 38.05293 11.86536 13.71442 
```

这与实际值（37.986、13.555、14.059）相差了 Macbeth ColorChecker 值的合理余量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-12-26T13:27:36.040

你得到的数字`convertColor`是正确的。`convert_colour`我使用按`farver`包复制了您的结果：

```
library(farver)
convert_colour(
  t(c(115, 82, 68)), 
  from = "rgb", 
  to = "lab") 
```

结果与您的示例几乎相同：

```
 l        a        b
[1,] 38.01682 11.79681 13.66437 
```

此外[，ColorHexa 也](https://www.colorhexa.com/735244)显示了几乎相同的数字（对于 CIE-LAB）：

[![在此处输入图像描述](../Images/f9ec38cc683eb583609254a79cb360d6.png)](https://i.stack.imgur.com/30byP.png)

# ios - 哪个带有 ios SDK 的 JSON 框架？

> ID：10021694
> 
> 赞同：0
> 
> 时间：2012-04-05T01:55:23.560
> 
> 标签：ios, json

有几个 JSON 框架。JSONKit、SBJSON、原生 JSON 等。哪一个最适合用于 Iphone 应用程序或 ios 应用程序，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:12:16.127

如果您只想针对 iOS5 及更高版本，您可以尝试`NSJSONSerialization`

> 基本上，iOS 5 有一个名为 NSJSONSerialization 的新类。它有一个名为 JSONObjectWithData:options:error 的静态方法，它接受一个 NSData 并返回一个 Foundation 对象——通常是一个 NSDictionary 或一个 NSArray，这取决于你在 JSON 文件层次结构的顶部有什么。

一个很好的例子

[来自雷·温德利希](http://www.raywenderlich.com/5492/working-with-json-in-ios-5)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:21:23.340

我已经使用 SBJson 两年了，许多 Object-C API 也使用 SBJson。比较不同的 json api 是相当困难的，但是 SBJson 易于使用且被广泛使用。

# xcode - UIInterfaceOrientaion 不遵循应用程序规则

> ID：10021696
> 
> 赞同：0
> 
> 时间：2012-04-05T01:55:34.410
> 
> 标签：xcode, ipad, ios5, uiinterfaceorientation

我一直有一个很大的问题。Xcode 只是简单地将我的横向模式应用程序变成了纵向视图并且它不会返回！

我已经对整个应用程序进行了编程，几乎可以在 Ipad 中以横向模式运行。

在情节提要上，每个窗口都是横向的。我相信我根据下面的图片正确地进行了设置

![在此处输入图像描述](../Images/e54e0cbe00f0d888ca3f7d028406efcd.png)

![在此处输入图像描述](../Images/c588b3e18264da5989088346bd9f4a16.png)

最后在我的 viewController 上我有：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
return YES;
} 
```

任何人都知道可能出了什么问题，或者为什么 Xcode 会在我调整 viewController 时突然将屏幕设置为纵向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:53:29.380

如果您只想支持横向，请更改`shouldAutorotateToInterfaceOrientation`为：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    if (interfaceOrientation == UIInterfaceOrientationLandscapeLeft ||
        interfaceOrientation == UIInterfaceOrientationLandscapeRight) {
        return YES;
    }
    // Default
    return NO;
} 
```

# javascript - onmouseout 与 onclick 冲突

> ID：10021703
> 
> 赞同：0
> 
> 时间：2012-04-05T01:56:27.100
> 
> 标签：javascript, html, onmouseout

好的，我正在使用 JavaScript 来控制图像交换，以便当有人单击图像时，它会变为图像的“点亮”版本。在链接标签中执行此操作的代码是`onclick="changeto('wdl')"`我添加`onmouseover="changeto('wdl')"`到链接中的，因此当您将鼠标悬停在它上面时，它也会亮起。

现在，问题出现的地方自然是我添加`onmouseout="changeto('wdd')"`了图像的未点亮版本。当然，这里发生的事情是当我将鼠标悬停在它上面时，它会亮起，当我将光标移开时，它会变为不亮的版本。但是，当您单击它时，它会将图像更改为应有的点亮版本，但是由于该`onmouseout`命令，它会更改为未点亮的版本。

我想要的是能够将鼠标悬停在图像上并使其亮起。如果您单击它并将鼠标移开，它会保持点亮状态，但如果您不单击它并将鼠标移开，它会停留在“关闭”图像上。

任何帮助表示赞赏，我在这里很难过。我打算尝试使用某种`if (!this)`类型的东西，但老实说我不知道​​。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:01:48.710

您应该使用 CSS 和 javascript 的组合。查css hover实现鼠标悬停功能，从js做点击部分

CSS 悬停在 w3schools [http://www.w3schools.com/cssref/sel_hover.asp](http://www.w3schools.com/cssref/sel_hover.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:02:01.077

~~`onclick`我看到了两种解决方案：1.为下面定义的事件声明单独的 CSS 类`wdd`（或使用`!important`. 2\. 使用设置为`true`in`onclick`然后测试的标志变量`onmouseout`：~~

 ~~```
onclick="changeto('wdl');flag=true;" 
onmouseout="if (!flag) changeto('wdd')" 
```~~  ~~这是一个使用 CSS 和 Javascript 的简单示例：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Example</title>
        <style>
            #whl {
                background: #e0e0ff;
                line-height: 150px;
                text-align: center;
                width: 150px;
            }
            #wdl {
                background: #e0ffe0;
                line-height: 150px;
                text-align: center;
                width: 150px;
            }
            #whl:hover {
                background: #ffcccc;
            }
            #wdl:hover {
                background: #ffcccc;
            }
            #whl.selected {
                background: #ffcccc;
            }
            #wdl.selected {
                background: #ffcccc;
            }
        </style>
        <script>
            function doClick(el) {
                document.getElementById("whl").className = document.getElementById("whl").className.replace( /(?:^|\s)selected(?!\S)/ , '' );
                document.getElementById("wdl").className = document.getElementById("wdl").className.replace( /(?:^|\s)selected(?!\S)/ , '' );
                el.className += "selected";
            }
        </script>
    </head>
    <body>
        <div id="whl" onclick="doClick(this);">WHL</div>
        <div id="wdl" onclick="doClick(this);">WDL</div>
    </body>
</html> 
```

它适用于颜色，在您的情况下，您必须用背景图像替换颜色（在 CSS 中）。~~

# php - 如何使用 hook_form 创建前端节点表单？

> ID：10021705
> 
> 赞同：1
> 
> 时间：2012-04-05T01:56:51.377
> 
> 标签：php, drupal, hook, drupal-hooks

我创建了一个自定义模块并使用“hook_form”创建了一个自定义表单。然后我使用菜单回调创建了一个新页面并在其上插入了这个表单

这种形式基本上是从前端创建节点。我拥有与后端相同的字段。

表格代码：

```
function input_simple_form($form, &$form_submit) {

$form['title'] = array(
  '#type' => 'textfield',
  '#default_value' => '',
  '#required' => TRUE,
  '#title' => 'Title',
  '#maxlength' => 1024,
);

$form['submit'] = array(
    '#type' => 'submit',
    '#value' => 'Submit',
);

return $form; 
```

}

如何保存它，或者如何告诉 hook_form 这是针对特定内容类型的？我知道如何使用 node_save，但不确定如何使用 hook_form 来实现它。

我如何去实现我想要的？

谢谢罗伯特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T11:50:53.457

在您的回调函数中使用：

```
$my_form = drupal_get_form('input_simple_form');
echo $my_form; 
```

如果您使用 hook_theme 将您的页面部分主题`$my_form`化为变量并将其打印在您的模板/主题文件中。

# c++ - 代码合成 XSD 解析/数据绑定 xml 字符串而不是 xml 文件

> ID：10021706
> 
> 赞同：2
> 
> 时间：2012-04-05T01:57:03.597
> 
> 标签：c++, xml, xsd, xml-parsing, codesynthesis

如果您在系统上的文件中提供 xml，我到处都看到了解释如何让代码合成 xsd 工作的教程，但是我找不到任何关于将 xml 作为字符串提供的信息。

我正在从 TCP 连接接收 xml，并尝试使用 Code Synthesis xsd 对其进行解析，当我已经将它作为字符串保存在内存中时，创建 xml 文件似乎是一个无用的附加步骤。

是的，这是在 C++ 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T11:24:00.007

您可以使用 std::istringstream 使字符串显示为 std::istream 然后解析：

```
#include <sstream>

std::string str = ... // Input XML in a string.
std::istringstream istr (str);

std::auto_ptr<root_type> r = root (istr); 
```

这里 root_type 是类型，root 是 XML 根元素的名称。除了使用 std::ostringstream 之外，相同的方法适用于序列化：

```
#include <sstream>

std::ostringstream ostr;

root (ostr, *r, ...);
std::string str = ostr.str () // Output XML in a string. 
```

# javascript - 对不同函数的总数求和 - Javascript

> ID：10021711
> 
> 赞同：1
> 
> 时间：2012-04-05T01:57:27.200
> 
> 标签：javascript, function, variables, sum, new-operator

我需要能够创建一个单独的函数，该函数从 2 个不同函数中的变量创建一个总数字。

```
 function addToy1()
{
var i = document.getElementById("qty_toy1");
var qtytoy1 = i.options[i.selectedIndex].text;
var qtytoy1tot = qtytoy1 * 26.99;
var generateTableToy1="<table width=\"210px\" border=\"0\">"
                    +"  <tr>"
                    +"    <td width=\"140\">Optimus Prime</td>"
                    +"    <td width=\"25\">x " + qtytoy1 + "</td>"
                    +"    <td width=\"45\">&pound;" + qtytoy1tot + "</td>"
                    +"  </tr>"
                    +"</table>";

document.getElementById("toy1_add").innerHTML=generateTableToy1;

}

function addToy2()
{
var i = document.getElementById("qty_toy2");
var qtytoy2 = i.options[i.selectedIndex].text;
var qtytoy2tot = qtytoy2 * 14.39;
var generateTableToy2="<table width=\"210px\" border=\"0\">"
                    +"  <tr>"
                    +"    <td width=\"140\">Bumblebee</td>"
                    +"    <td width=\"25\">x " + qtytoy2 + "</td>"
                    +"    <td width=\"45\">&pound;" + qtytoy2tot + "</td>"
                    +"  </tr>"
                    +"</table>";

document.getElementById("toy2_add").innerHTML=generateTableToy2;

} 
```

使用此代码，我需要将两个变量“qtytoy1tot”和“qtytoy2tot”相加。我是 Javascript 新手。请在力所能及的地方提供帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:59:23.847

您在这里有很多选择。最直接的是正如 Amit 在评论中建议的那样，只需返回每个方法的总数。这可能会也可能不会起作用，具体取决于您计划如何使用这些方法。像下面这样的东西应该适合你的目的。

```
function ToyBox() {
    this.total = 0;
}

ToyBox.prototype.addToy1 = function() {
    var i = document.getElementById("qty_toy1");
    var qtytoy1 = i.options[i.selectedIndex].text;
    var qtytoy1tot = qtytoy1 * 26.99;
    this.total += qtytoy1tot;
    var generateTableToy1="<table width=\"210px\" border=\"0\">"
                        +"  <tr>"
                        +"    <td width=\"140\">Optimus Prime</td>"
                        +"    <td width=\"25\">x " + qtytoy1 + "</td>"
                        +"    <td width=\"45\">&pound;" + qtytoy1tot + "</td>"
                        +"  </tr>"
                        +"</table>";

    document.getElementById("toy1_add").innerHTML=generateTableToy1;
        };

ToyBox.prototype.addToy2 = function() {
    var i = document.getElementById("qty_toy2");
    var qtytoy2 = i.options[i.selectedIndex].text;
    var qtytoy2tot = qtytoy2 * 14.39;
    this.total += qtytoy2tot;
    var generateTableToy2="<table width=\"210px\" border=\"0\">"
                        +"  <tr>"
                        +"    <td width=\"140\">Bumblebee</td>"
                        +"    <td width=\"25\">x " + qtytoy2 + "</td>"
                        +"    <td width=\"45\">&pound;" + qtytoy2tot + "</td>"
                        +"  </tr>"
                        +"</table>";

    document.getElementById("toy2_add").innerHTML=generateTableToy2;
};

var toyBox = new ToyBox();
toyBox.addToy1();
toyBox.addToy2();
console.log(toyBox.total); 
```

请记住，您实际上只有一个函数，您应该将变量部分作为参数传递给函数，但我认为这可能超出了这个问题的范围。

# iphone - 确定长按手势识别器的位置

> ID：10021714
> 
> 赞同：10
> 
> 时间：2012-04-05T01:57:43.210
> 
> 标签：iphone, objective-c, ios, cocoa-touch, cocoa

目前，我在四个不同的 TableViews 上有 Long Pres Gesture Recognizers（每个情节提要场景中有两个，因此两个情节提要场景）。我在 ViewDidLoad 方法中使用以下代码创建这些 LPGR...

```
//Add Long Press Gesture Reconizer
UILongPressGestureRecognizer *lpgr = [[UILongPressGestureRecognizer alloc] 
                                      initWithTarget:self action:@selector(handleLongPress:)];
lpgr.minimumPressDuration = 1; //seconds
lpgr.delegate = self;
[self.GolferOne addGestureRecognizer:lpgr];
[self.GolferTwo addGestureRecognizer:lpgr];
[self.GolferThree addGestureRecognizer:lpgr];
[self.GolferFour addGestureRecognizer:lpgr];
//Done Adding Long Press Gesture Reconizer 
```

接下来我有另一种方法，我想在按下 LPG 的地方进行 NSLog ......

```
CGPoint p = [gestureRecognizer locationInView:self.GolferOne];

   NSIndexPath *indexPath = [self.GolferOne indexPathForRowAtPoint:p];
    if (indexPath == nil)
        NSLog(@"long press on table view but not on a row [Golfer One]");
    else
        NSLog(@"long press on table view at row %d [Golfer One]", indexPath.row);

    //Golfer Two

    p = [gestureRecognizer locationInView:self.GolferTwo];

    indexPath = [self.GolferTwo indexPathForRowAtPoint:p];
    if (indexPath == nil)
        NSLog(@"long press on table view but not on a row [Golfer Two]");
    else
        NSLog(@"long press on table view at row %d [Golfer Two]", indexPath.row);

    //Golfer Three

    p = [gestureRecognizer locationInView:self.GolferThree];

    indexPath = [self.GolferThree indexPathForRowAtPoint:p];
    if (indexPath == nil)
        NSLog(@"long press on table view but not on a row [Golfer Three]");
    else
        NSLog(@"long press on table view at row %d [Golfer Three]", indexPath.row);

    //Golfer Four

    p = [gestureRecognizer locationInView:self.GolferFour];

    indexPath = [self.GolferFour indexPathForRowAtPoint:p];
    if (indexPath == nil)
        NSLog(@"long press on table view but not on a row [Golfer Four]");
    else
        NSLog(@"long press on table view at row %d [Golfer Four]", indexPath.row); 
```

我知道为什么它不起作用，但我找不到让它起作用的解决方案。它不仅返回一个 NSLog，还返回四次（每个高尔夫球手一次，因为其中三个具有 indexPath=nil）

任何帮助将不胜感激。另外，为什么它对 NSLog 有这么大的滞后？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-08-23T18:02:23.257

要从识别器的 locationInView: 属性确定手势在视图中的位置：

```
// Get the location of the gesture
CGPoint location = [recognizer locationInView:self.view]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-05T02:50:35.410

您可以使用获取识别器的接触点，

```
 -(void)handleLongPress:(UILongPressGestureRecognizer *)gestureRecognizer
{
 NSLog(@"%@",NSStringFromCGPoint([[gestureRecognizer valueForKey:@"_startPointScreen"] CGPointValue]));

} 
```

您将获得与添加识别器的视图坐标系统相关的点。

您的识别器仅为最后一个 Golfer 注册。你应该做这个，

```
UILongPressGestureRecognizer *lpgr = [[UILongPressGestureRecognizer alloc] 
                                      initWithTarget:self action:@selector(handleLongPress:)];
lpgr.minimumPressDuration = 1; //seconds
[self.GolferOne addGestureRecognizer:lpgr];
[lgpr release];
lpgr = [[UILongPressGestureRecognizer alloc] 
                                      initWithTarget:self action:@selector(handleLongPress:)];
lpgr.minimumPressDuration = 1; //seconds

[self.GolferTwo addGestureRecognizer:lpgr];
[lgpr release]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T02:05:27.297

长按识别器应用于**整个**视图。要使 NSLog 出现“滞后”，您可以使用 NSTimer。您可以获得想要的结果的一种方法是 alpha 为零的按钮。当他们释放（无论是 1 秒还是 120 秒）时，它会记录触摸。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T03:05:08.877

1.  正如 TheDeveloper 所说，长按手势是针对整个视图的。

2.  顺便说一句，如果您要为多个视图设置手势，我相信您需要为每个视图设置一个单独的手势识别器。这里不相关，但我看到很多人想知道为什么他们试图分配给多个视图的手势只适用于一个。

3.  使用长按手势，我建议您检查您的 sender.state == UIGestureRecognizerStateEnded 或 Started 或您要查找的任何内容。您将为一个用户交互触发多个事件。

4.  如果您在视图上有手势并且想要查看，例如，如果用户在特定子视图上松开手指，您可以获得用于释放的 CGPoint（通过 locationInView，正如 Vignesh 指出的那样），然后，您还可以获取特定子视图框架的 CGRect，然后通过 CGRectContainsPoint() 检查 CGPoint 是否在 CGRect 内。

# java - 在 Java Web Start 中的 jar 中加载 jar 时的奇怪行为

> ID：10021715
> 
> 赞同：1
> 
> 时间：2012-04-05T01:57:51.233
> 
> 标签：java, eclipse, jar, jnlp, java-web-start

地狱所有，所以我已经面对这种行为很长一段时间了，我相信其他人也面临过它并知道解决方案。我正在使用 eclipse 将我的应用程序 jar 导出为可运行的 jar，显然这个应用程序还有许多其他 jar，所以我正在导出主 jar 中的选项打包其他 jar。问题是当我启动我的应用程序时，它没有从 db2jcc.jar 和其他几个 jar 加载文件，但是如果我将 db2jcc.jar 部署为单独的 jar 应用程序运行良好。![在此处输入图像描述](../Images/ae01f4dcbfb0d419068180f4f02a82ca.png)

![在此处输入图像描述](../Images/4c36d4e6340ee64cf5f497fbae382486.png)

![在此处输入图像描述](../Images/1b97a4d9b826319359184329e55e60d4.png)

我只想让我的 jnlp 文件和 jar 过程的签名尽可能简单，这就是我在主 jar 中包含 jar 的原因。非常感谢您的建议。我正在使用 Rational Software Architect 8.0（基于 eclipse）进行导出

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:32:23.470

我认为在主 jar 文件中包含依赖项（其他 jar 文件）不是一个好主意。也许有一种方法可以实现这一点，但有一个很好的理由不这样做：*缓存*。

Java Web Start 在客户端计算机上缓存 jar 文件。因此，通过将它们与应用程序 jar 分开，Java Web Start 不必在每次更新应用程序时重新下载它们。您的屏幕截图显示您有超过 12MB 的依赖项，因此每次都需要大量下载。

如果您担心使签名过程尽可能简单，那么只需编写一个脚本来为您完成。事实上，我在屏幕截图中注意到该向导将为您创建一个 Ant 脚本。我建议您使用它为您创建 Ant 脚本，然后直接运行该脚本——它应该比每次都通过向导更简单、更快捷！

# c# - ASP.Net 开发服务器死锁

> ID：10021717
> 
> 赞同：2
> 
> 时间：2012-04-05T01:58:13.333
> 
> 标签：c#, asp.net, multithreading

我有使用来自网络应用程序的 win32 api 的代码。当我在 ASP.Net 开发服务器中运行此代码时，我遇到了死锁（我无法在 IIS 中重现，但我不知道在某些情况下它不会发生）。下面是一个我已经修剪过的类，它仍然重现了这个问题：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Runtime.InteropServices;
namespace Web_ShellIconBug
{
    public class IconIndexClass
    {
        [StructLayout(LayoutKind.Sequential)]
        private struct SHFILEINFO
        {
            public IntPtr hIcon;
            public int iIcon;
            public int dwAttributes;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)]
            public string szDisplayName;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 80)]
            public string szTypeName;
        }

        [DllImport("shell32", CharSet = CharSet.Unicode)]
        private static extern IntPtr SHGetFileInfo(string pszPath, int dwFileAttributes, ref SHFILEINFO psfi, uint cbFileInfo, uint uFlags);

        private static object m_lock = new object();

        public int IconIndex(
            string fileName,
            bool tryDisk,
            int iconState
            )
        {
            // On some machines, you might need this to make sure multiple threads are spawned
            //System.Threading.Thread.Sleep(100);
            SHFILEINFO shfi = new SHFILEINFO();
            IntPtr retVal;
            uint shfiSize = (uint)Marshal.SizeOf(shfi.GetType());

            MyLog("Before Lock.");
            lock (m_lock)
            {
                MyLog("Obtained Lock.");
                retVal = SHGetFileInfo(fileName, 0, ref shfi, shfiSize, 0);
            }
            MyLog("Lock released.");
            if (retVal.Equals(IntPtr.Zero))
            {
                MyLog("IntPtr is zero");
                if (tryDisk)
                {
                    if (System.IO.Directory.Exists(fileName))
                        return IconIndex(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData), false, iconState);
                    else return IconIndex(fileName, false, iconState);
                }
                else
                    return 0;
            }
            else
            {
                return shfi.iIcon;
            }
        }

        private void MyLog(string val)
        {
            System.Diagnostics.Debug.WriteLine(DateTime.Now.ToString("HH:mm:ss.ffff") + " - Thread:" + System.Threading.Thread.CurrentThread.ManagedThreadId + " - Msg:" + val);
        }
    }
} 
```

我可以使用以下代码在 Web 应用程序中重现该错误：

```
protected void Page_Load(object sender, EventArgs e)
{
    Web_ShellIconBug.IconIndexClass ii = new Web_ShellIconBug.IconIndexClass();
    Parallel.ForEach(System.IO.Directory.GetFiles("C:\\Windows"), file =>
    {
        ii.IconIndex(file, false, 0);
    });
    Debug.WriteLine("Done.");
} 
```

我已经在运行 Win 7 64 位和 VS 2010 SP1 的两台不同的机器上重现了这个。在我的输出中，我将看到如下内容：

```
21:39:01.7812 - Thread:5 - Msg:Before Lock.
21:39:01.7912 - Thread:5 - Msg:Obtained Lock.
21:39:01.8022 - Thread:5 - Msg:Lock released.
21:39:01.8162 - Thread:10 - Msg:Before Lock.
21:39:02.8382 - Thread:11 - Msg:Before Lock.
21:39:03.8172 - Thread:12 - Msg:Before Lock.
21:39:04.3032 - Thread:5 - Msg:Before Lock.
21:39:04.3032 - Thread:5 - Msg:Obtained Lock.
21:39:04.3042 - Thread:5 - Msg:Lock released.
21:39:04.8162 - Thread:13 - Msg:Before Lock.
... 
```

在这种情况下，看起来线程 5 正在获取锁，但没有释放它，因此所有其他线程都被无限期地阻塞。

其他一些需要注意的事项：

*   重现僵局是相当棘手的。如果我在检查返回值等于 IntPtr.Zero 之后修改任何递归调用，死锁似乎消失了，但我不明白为什么这会影响任何锁定，所以我犹豫要不要说修改该代码纠正问题。
*   如果我手动执行 Monitor.Enter 和 Monitor.Exit （而不是锁定），我不会遇到死锁，但同样，我不确定我是否已经解决了问题，或者只是为我的测试用例修复了它。
*   这段代码与代码的生产版本相比非常精简，因此该类中任何看起来没有多大作用的代码可能是因为我试图从问题中消除尽可能多的噪音，同时仍然能够重新创建它。

任何人都可以提供任何可能导致僵局的见解吗？我似乎无法将手指放在它上面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T12:43:16.747

如果我可以建议您最好的方法是获取挂起过程的转储，然后使用 windbg 进行分析。

为了帮助您入门，这里有一个使用 windbg 检测死锁场景的示例

第 1 步：修复符号路径

> .symfix c:\sos .reload

第 2 步：加载 sos - 只需加载您正在使用的任何版本的 .net

> .load C:\Windows\Microsoft.NET\Framework64\v2.0.50727\sos

第三步：列出加载的模块

> 。链

第 4 步：检查死锁 - 这将告诉您哪个线程挂起

> 同步块

第 5 步：切换到该线程号 - 在本例中为 #7

> ~7

第 6 步：列出当时线程在做什么

> ķ

第 7 步：检查任何异常

> ！
> 
> 第 8 步：获取更多关于线程的详细信息 ~7kL 10

第 9 步：以防万一检查堆栈是否有错误

> ~* e !clrstack

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:45:56.407

事实证明，这是 StructLayout 的问题。我们在函数上指定了 Unicode，但没有在结构上指定它，所以它默认为 ANSI。正确的结构布局是：

```
 [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)] 
```

# ruby-on-rails - 嵌入式表单更新上的 ActiveSupport::HashWithIndifferentAccess

> ID：10021718
> 
> 赞同：9
> 
> 时间：2012-04-05T01:58:21.757
> 
> 标签：ruby-on-rails, forms, activesupport

`ActiveSupport::HashWithIndifferentAccess`尝试更新嵌入式表单时出现错误。

这是最简单的例子：

形式：

```
<h1>PlayersToTeams#edit</h1>
<%= form_for @players_to_teams do |field| %>
    <%= field.fields_for @players_to_teams.player do |f| %>
        <%= f.label :IsActive %>
        <%= f.text_field :IsActive %>
    <% end %>
    <%= field.label :BT %>
    <%= field.text_field :BT %>
    <br/>
    <%= field.submit "Save", class: 'btn btn-primary' %>
<% end %> 
```

楷模：

```
class PlayersToTeam < ActiveRecord::Base
  belongs_to :player
  belongs_to :team

  accepts_nested_attributes_for :player
end

class Player < ActiveRecord::Base
  has_many :players_to_teams
  has_many :teams, through: :players_to_teams
end 
```

控制器：

```
class PlayersToTeamsController < ApplicationController
  def edit
    @players_to_teams=PlayersToTeam.find(params[:id])
  end

  def update
    @players_to_teams=PlayersToTeam.find(params[:id])
    respond_to do |format|
      if @players_to_teams.update_attributes(params[:players_to_team])
        format.html { redirect_to @players_to_teams, notice: 'Player_to_Team was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @players_to_teams.errors, status: :unprocessable_entity }
      end
    end
  end
end 
```

这是`params[:players_to_team]`表单提交时的对象：

![:players_to_team](../Images/0aecf3f83ca4d15d500798737926ab42.png)

错误是什么`ActiveSupport::HashWithIndifferentAccess`意思？我需要做什么才能让此表单更新`players_to_team`条目？

**编辑**

`BT`是 中的一列`players_to_teams`。如果我删除`field_for`块，我可以成功保存`BT`字段/`players_to_teams`行。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T17:05:07.360

归功于@Brandan。回答：[fields_for中使用“:”和“@”有什么区别](https://stackoverflow.com/questions/10021980/what-is-the-difference-between-using-and-in-fields-for)

> 好的，我能够克隆您的示例项目并重现错误。我想我明白发生了什么。
> 
> 在您调用 accept_nested_attributes_for 之后，您现在在您的模型上有一个名为 的实例方法`player_attributes=`。这是对通常为 关联`player=`定义的方法的补充。`has_one`该`player_attributes=`方法接受属性的散列，而该`player=`方法只接受一个实际的 Player 对象。
> 
> 这是您调用时生成的文本输入的示例 `fields_for @players_to_teams.player`：
> 
> `<input name="players_to_team[player][name]" ... />`这是调用时相同的输入`fields_for :player`：
> 
> `<input name="players_to_team[player_attributes][name]" ... />`当您调用`update_attributes`控制器时，第一个示例将调用 `player=`，而第二个示例将调用`player_attributes=`。在这两种情况下，传递给方法的参数都是散列（因为 params 最终只是散列的散列）。
> 
> 这就是为什么你得到一个`AssociationTypeMismatch`：你不能将哈希传递给`player=`，只能传递一个 Player 对象。
> 
> 似乎唯一安全的使用方式`fields_for`是 `accepts_nested_attributes_for`传递关联的名称而不是关联本身。
> 
> 因此，要回答您最初的问题，区别在于一个有效，另一个无效:-)

# pca - 总散射矩阵的主成分分析和行列式

> ID：10021723
> 
> 赞同：1
> 
> 时间：2012-04-05T01:59:14.547
> 
> 标签：pca

大家好，我正在阅读一篇论文 Eigenfaces vs. Fisherfaces: Recognition Using Class Specific Linear Projection，我想知道为什么在 PCA 中选择投影 W 以最大化投影样本的总散射矩阵的**行列式**，即 arg max |W^T S_T W|(以乳胶形式) 其中 S_T 是原始数据集的散布矩阵。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:42:16.540

如果我们注意到矩阵的特征值可以使用特征方程从行列式中找到，则该表达式是有意义的。

### （PCA 快速回顾）

您可能已经知道，由于我们正在执行 的主成分分析 (PCA) `S_T`，我们的目标是找到一个对角矩阵 B，使得

```
B = W^(T) * S_T * W 
```

`W^(T)`是W的转置。对角矩阵B的元素是特征值，W的列向量是特征向量。这为我们提供了我们寻求的主成分。

### 回到特征方程：

矩阵的行列式可用于从特征方程中找到其特征值。直接引用维基百科：

> ![](../Images/c56a6b9cc0dec3989d02a982451e4013.png)
> 
> （其中 I 是单位矩阵）。由于 v 不为零，这意味着矩阵 I - A 是奇异的，这反过来意味着它的行列式是 0（不可逆）。因此，函数的根是`det( I − A)`A 的特征值...
> 
> [http://en.wikipedia.org/wiki/Characteristic_polynomial](http://en.wikipedia.org/wiki/Characteristic_polynomial)

因此，通过最大化行列式或找到它的根，您可以找到特征值。

### 阅读更多：

[http://en.wikipedia.org/wiki/Determinant#Relation_to_eigenvalues_and_trace](http://en.wikipedia.org/wiki/Determinant#Relation_to_eigenvalues_and_trace) [http://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors](http://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors)

# sql - 如何按降序列出与每种天气类型相关的车祸次数？

> ID：10021727
> 
> 赞同：0
> 
> 时间：2012-04-05T01:59:50.847
> 
> 标签：sql

我有一个包含 12,000 条具有各种属性的记录的数据库。其中之一是weather_condition（整数）。

此查询将按降序返回每个具有天气类型的车祸。

```
SELECT weather_condition FROM nyccrash ORDER BY weather_condition DESC; 
```

我特别想要的是显示与每个 weather_condition 相关的事故数量。有 7 个条件：0 到 7。

例如：

```
Condition | Count
0         | 452
1         | 558
2         | 1242
3         | 92
...       | ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:01:39.280

这个怎么样：

```
SELECT weather_condition, COUNT(weather_condition) AS Count 
FROM nyccrash
GROUP BY weather_condition
ORDER BY weather_condition DESC ; 
```

# c# - 优化内存使用

> ID：10021730
> 
> 赞同：0
> 
> 时间：2012-04-05T02:01:10.203
> 
> 标签：c#, memorystream

```
public static byte[] Compress(byte[] data)
{
    using (MemoryStream ms = new MemoryStream())
    {
        using (DeflateStream ds = new DeflateStream(ms, CompressionMode.Compress))
        {
            ds.Write(data, 0, data.Length);
            ds.Flush();
        }
        return ms.ToArray();
    }
} 
```

上面的函数中会关闭内存流吗？或者将内存流分配给数组并返回数组是否更好？

```
public static byte[] Compress(byte[] data)
{
    byte[] compressedData;
    using (MemoryStream ms = new MemoryStream())
    {
        using (DeflateStream ds = new DeflateStream(ms, CompressionMode.Compress))
        {
            ds.Write(data, 0, data.Length);
            ds.Flush();                   
        }
        compressedData= ms.ToArray();
    }
    return compressedData;
} 
```

哪些代码可以更好地优化内存使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:07:28.203

我认为您可能正在过度优化，但是唉...

查看 IL 代码。很可能，它最终是相同或非常相似的代码。这是最好的微优化。

就个人而言，我会选择选项 1 以提高可读性和更少的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:05:24.720

在这`MemoryStream`两种情况下都将关闭。因此，代码工作相同，所以第一个版本更好（因为它更短更清晰）。内存使用也是相同的，除了`compressedData`第二种情况下额外的附加引用变量，它将在方法退出后被销毁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T02:11:05.943

非常相似的结果，不值得努力。

为了回答您的问题，内存流被关闭，因为它离开了范围并且处于 using 块中，这意味着 Dispose 将被称为 IDispose 模式。顺便说一句，我个人更喜欢您的第二个示例，因为它更容易在调试器中停止它以检查`compressedData`. 但这确实不值得以性能的名义进行重构。

在其他地方还有更大的收获。

这里的示例代码`MemoryStream.toArray`看起来像这样

```
byte[] numArray = new byte[this._length - this._origin];
Buffer.InternalBlockCopy(this._buffer, this._origin, numArray, 0, this._length - this._origin);
return numArray; 
```

流将被关闭的原因是因为它根本没有被您的代码保留，并且随着流的内容被复制到数组中，所有引用都被删除。

内存流里面是这段代码

```
protected override void Dispose(bool disposing)
{
    try
    {
        if (disposing)
        {
            this._isOpen = false;
            this._writable = false;
            this._expandable = false;
        }
    }
    finally
    {
        base.Dispose(disposing); // ultimately this will dispose of the stream 
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T03:45:49.323

由于没有人提到它，我还要补充一点，MemoryStream 不需要被释放。不关闭流可能会让一些人觉得不对，但你可以放心，它绝对不会对它进行 Dispose，没有要释放的资源等等。

当然，Flush 也没有任何内容，因为 Flush 是在写入底层流之前写入内部数组...... MS 除了写入内部缓冲区“流”之外别无他法，所以它总是被刷新。

像 Albahari (C# xx in a Nutshell) 之类的引用也重复说 MemoryStreams 不需要处置。

# android - 'ACTION_CALL' 和 ACTION_CALL_PRIVILEGED' 有什么区别

> ID：10021732
> 
> 赞同：3
> 
> 时间：2012-04-05T02:01:14.270
> 
> 标签：android, call

作为标题，我不知道两种意图有什么区别。

有人确切知道这些意图吗？

```
@SdkConstant(SdkConstantType.ACTIVITY_INTENT_ACTION)

public static final String ACTION_CALL = "android.intent.action.CALL";

public static final String ACTION_CALL_PRIVILEGED = "android.intent.action.CALL_PRIVILEGED"; 
```

# hibernate - Hibernate 和 cassandra 数据库连接和事务

> ID：10021733
> 
> 赞同：0
> 
> 时间：2012-04-05T02:01:19.127
> 
> 标签：hibernate, cassandra

我对使用 Hibernate 和 RDBMS 有一些想法。任何朋友都可以提供一些想法或任何示例代码来解释如何使用 Hibernate 和 Cassandra。

我需要一些基于这方面的示例代码。

提前致谢。

-安库尔。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T10:42:07.647

Cassandra 不是关系数据库，不能与 Hibernate 一起使用。大多数 Java 用户将[Hector](https://github.com/rantav/hector)与 Cassandra 一起使用。

# asp.net-mvc-3 - 编辑以将图像上传到数据库

> ID：10021740
> 
> 赞同：0
> 
> 时间：2012-04-05T02:02:51.120
> 
> 标签：asp.net-mvc-3, entity-framework

刚刚创建完文件上传功能；用于将图像上传到数据库。这工作正常。

下面的代码是控制器的简化版本，其中只有一个图像。

```
 [HttpPost]
            public ActionResult Create(CarAdvert caradvert,
                 HttpPostedFileBase picture1)
            {
                if (ModelState.IsValid)
                {

                    if (picture1 != null)
                    {
                        string image1 = picture1.FileName;
                        caradvert.Image1 = image1;
                        var image1Path = Path.Combine(Server.MapPath("~/Content/Images"), image1);
                        picture1.SaveAs(image1Path);
                    }
db.CarAdverts.Add(caradvert);
                 db.SaveChanges();
                 return RedirectToAction("Index"); 
```

创建记录后，所有图像都可以正常上传；控制器中的代码有效，只是当我尝试编辑上传的图像时出现问题。图像不会保存。

```
[HttpPost]
            public ActionResult Edit(CarAdvert caradvert,  HttpPostedFileBase picture1)
            {
                if (ModelState.IsValid)
                {

                    if (picture1 != null)
                    {
                        string image1 = picture1.FileName;
                        caradvert.Image1 = image1;
                        var image1Path = Path.Combine(Server.MapPath("~/Content/Images"), image1);
                        picture1.SaveAs(image1Path);
                    }

                db.Entry(caradvert).State = EntityState.Modified;
                db.SaveChanges();
                return RedirectToAction("Index"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:16:02.300

我认为您可能需要将“caradvert”实体附加到 DbContext。在编辑功能中试试这个。

```
db.CarAdverts.Attach(caradvert);  // Entity is in Unchanged state
db.Entry(caradvert).State = EntityState.Modified;

db.SaveChanges(); 
```

# .htaccess - htaccess - 规则解释

> ID：10021743
> 
> 赞同：0
> 
> 时间：2012-04-05T02:03:30.067
> 
> 标签：.htaccess

我想知道是否有人可以解释这条规则的含义：

```
<IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteRule (.*)\.html$ news.php?name=$1
</IfModule> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:09:45.790

它会翻译如下 URL：

```
/foo.html 
```

进入如下网址：

```
/news.php?name=foo 
```

[http://httpd.apache.org/docs/current/mod/mod_rewrite.html](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:10:17.753

匹配 URL 字符串中以 .html 结尾的任何内容。将 .html 之前和域名之后的文件部分作为 $_GET['name'] 传递给 news.php 脚本。

# jquery - 如何绑定事件以隐藏菜单

> ID：10021745
> 
> 赞同：0
> 
> 时间：2012-04-05T02:03:50.887
> 
> 标签：jquery

我创建了一个小插件来在单击 div 时显示下拉菜单。

下面是让它工作的代码

```
$('#clickable_div').click(function() {
    $('#nav_menu').showMenu({
        parent:'#clickable_div' 
    });                
}); 
```

带有插件的 Jsfiddle：http: [//jsfiddle.net/HtNK3/](http://jsfiddle.net/HtNK3/)

所以现在基本上我想添加一个功能，当用户单击文档中的任何位置而不是打开的下拉 div 时，我需要隐藏下拉 div

如何实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:13:58.360

我正在使用这样的东西：

```
//Close popup menus by clicking anywhere
$("body").mouseup(function(event){
        if (!$(event.target).hasClass("YOUR_CLASS_HERE")) {
        $("#nav_menu").hide();
    } 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:06:46.333

当鼠标离开下拉菜单（`mouseleave`事件）然后隐藏 div 时，我会使用 setTimout。很常见也很容易。

错误但基本的示例：http: [//jsfiddle.net/HtNK3/5/](http://jsfiddle.net/HtNK3/5/)

# ios - 如何显示/隐藏 UIBarButtonItem？

> ID：10021748
> 
> 赞同：267
> 
> 时间：2012-04-05T02:04:29.327
> 
> 标签：ios, uibarbuttonitem, uitoolbar

我在 IB 中创建了一个带有几个按钮的工具栏。我希望能够根据主窗口中的数据状态隐藏/显示其中一个按钮。

`UIBarButtonItem`没有隐藏属性，到目前为止我发现的任何隐藏它们的示例都涉及将导航栏按钮设置为 nil，我认为我不想在这里做，因为我可能需要再次显示按钮（不是提到这一点，如果我将按钮连接到 IBOutlet，如果我将其设置为 nil，我不确定如何将其取回）。

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2012-04-05T03:18:18.560

将您的按钮保存在一个**强大**的插座中（我们称之为`myButton`）并执行此操作以添加/删除它：

```
// Get the reference to the current toolbar buttons
NSMutableArray *toolbarButtons = [self.toolbarItems mutableCopy];

// This is how you remove the button from the toolbar and animate it
[toolbarButtons removeObject:self.myButton];
[self setToolbarItems:toolbarButtons animated:YES];

// This is how you add the button to the toolbar and animate it
if (![toolbarButtons containsObject:self.myButton]) {
    // The following line adds the object to the end of the array.  
    // If you want to add the button somewhere else, use the `insertObject:atIndex:` 
    // method instead of the `addObject` method.
    [toolbarButtons addObject:self.myButton];
    [self setToolbarItems:toolbarButtons animated:YES];
} 
```

因为它存储在插座中，所以即使它不在工具栏上，您也会保留对它的引用。

* * *

## 回答 #2

> 赞同：224
> 
> 时间：2014-07-09T00:48:44.723

我知道这个问题的答案已经晚了。但是，如果其他人面临类似情况，它可能会有所帮助。

在 iOS 7 中，要隐藏条形按钮项，我们可以使用以下两种技术：-

*   使用`SetTitleTextAttributes`:- 这在“完成”、“保存”等条形按钮项目上效果很好。但是，它不适用于添加、垃圾符号等项目（至少对我来说不是），因为它们不是文本。
*   使用`TintColor`：- 如果我有一个名为“deleteButton”的条形按钮项：-

为了隐藏按钮，我使用了以下代码：-

```
[self.deleteButton setEnabled:NO]; 
[self.deleteButton setTintColor: [UIColor clearColor]]; 
```

为了再次显示该按钮，我使用了以下代码：-

```
[self.deleteButton setEnabled:YES];
[self.deleteButton setTintColor:nil]; 
```

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2012-08-25T19:31:28.697

这是一个简单的方法：

```
hide:  barbuttonItem.width = 0.01;
show:  barbuttonItem.width = 0; //(0 defaults to normal button width, which is the width of the text) 
```

我刚刚在我的 Retina iPad 上运行了它，而且 .01 小到它不会出现。

* * *

## 回答 #4

> 赞同：61
> 
> 时间：2013-05-03T17:22:43.207

可以在不更改其宽度或将其从栏中删除的情况下将按钮隐藏在适当的位置。如果将样式设置为普通，删除标题并禁用按钮，它将消失。要恢复它，只需反转您的更改。

```
-(void)toggleBarButton:(bool)show
{
    if (show) {
        btn.style = UIBarButtonItemStyleBordered;
        btn.enabled = true;
        btn.title = @"MyTitle";
    } else {
        btn.style = UIBarButtonItemStylePlain;
        btn.enabled = false;
        btn.title = nil;
    }
} 
```

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2013-09-17T11:50:22.940

以下是我的解决方案，虽然我正在寻找导航栏。

```
navBar.topItem.rightBarButtonItem = nil; 
```

这里“navBar”是XIB视图中NavigationBar的IBOutlet 这里我想隐藏按钮或根据某些条件显示它。所以我在“If”中测试条件，如果为真，我在目标视图的 viewDidLoad 方法中将按钮设置为 nil。

这可能与您的问题不完全相关，但如果您想隐藏 NavigationBar 上的按钮，则类似的情况

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2016-12-02T19:50:06.320

对于 Swift 3 和 Swift 4，您可以这样做来隐藏`UIBarButtomItem`：

```
self.deleteButton.isEnabled = false
self.deleteButton.tintColor = UIColor.clear 
```

并显示`UIBarButtonItem`：

```
self.deleteButton.isEnabled = true
self.deleteButton.tintColor = UIColor.blue 
```

在`tintColor`您必须指定您用于`UIBarButtomItem`

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2014-09-23T01:53:52.050

我目前正在运行针对 iOS 7.1 的 OS X Yosemite Developer Preview 7 和 Xcode 6 beta 6，以下解决方案对我来说很好：

*   `UINavigationItem`为和`UIBarButtonItem`s创建出口
*   运行以下代码删除

    ```
    [self.navItem setRightBarButtonItem:nil];
    [self.navItem setLeftBarButtonItem:nil]; 
    ```

*   运行以下代码再次添加按钮

    ```
    [self.navItem setRightBarButtonItem:deleteItem];
    [self.navItem setLeftBarButtonItem:addItem]; 
    ```

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2016-06-19T13:58:01.990

我在我的项目中使用了 IBOutlets。所以我的解决方案是：

```
@IBOutlet weak var addBarButton: UIBarButtonItem!

addBarButton.enabled = false
addBarButton.tintColor = UIColor.clearColor() 
```

当您需要再次显示此栏时，只需设置反转属性。

在**Swift 3**中`enable`使用`isEnable`属性。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2012-12-12T09:02:17.817

`self.dismissButton.customView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 0, 0)];`

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2015-07-03T10:46:52.657

iOS 8\. 带有自定义图像的 UIBarButtonItem。尝试了许多不同的方法，大多数都没有帮助。Max的解决方案，`setTintColor`没有改变任何颜色。我自己想出了这个，认为它会对某些人有用。

隐藏：

```
[self.navigationItem.rightBarButtonItem setEnabled:NO];
[self.navigationItem.rightBarButtonItem setImage:nil]; 
```

展示：

```
[self.navigationItem.rightBarButtonItem setEnabled:YES];
[self.navigationItem.rightBarButtonItem setImage:image]; 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2015-04-15T15:09:54.610

**在Swift**中尝试，`tintColor`如果您有一些 UIBarButtonItem 设计，例如 AppDelegate 中的字体大小，请不要更新，它会在显示时完全改变您的按钮的外观。

如果是文本按钮，更改标题可以让您的按钮“消失”。

```
if WANT_TO_SHOW {
    myBarButtonItem.enabled = true
    myBarButtonItem.title = "BUTTON_NAME"
}else{
    myBarButtonItem.enabled = false
    myBarButtonItem.title = ""
} 
```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2017-12-19T23:00:53.453

`tintColor`我在 Max和其他人建议的方法中发现了另一个问题`isEnabled`- 当 VoiceOver 启用辅助功能并且按钮在*逻辑上*隐藏时，辅助功能光标仍将聚焦在条形按钮上，并声明它“变暗”（即`isEnabled`因为设置为假）。接受的答案中的方法不会受到这种副作用的影响，但我发现的另一个解决方法是`isAccessibilityElement`在“隐藏”按钮时设置为 false：

```
deleteButton.tintColor = UIColor.clear
deleteButton.isEnabled = false
deleteButton.isAccessibilityElement = false 
```

然后在“显示”按钮时设置`isAccessibilityElement`回 true：

```
deleteButton.tintColor = UIColor.blue
deleteButton.isEnabled = true
deleteButton.isAccessibilityElement = true 
```

在我的情况下，让条形按钮项仍然占用空间不是问题，因为我们隐藏/显示了最左侧的右侧条形按钮项。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2017-05-10T11:26:50.280

```
@IBDesignable class AttributedBarButtonItem: UIBarButtonItem {

    var isHidden: Bool = false {

        didSet {

            isEnabled = !isHidden
            tintColor = isHidden ? UIColor.clear : UIColor.black
        }
    }
} 
```

现在只需更改`isHidden`属性。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2015-11-20T11:16:49.267

从@lnafziger 改进答案

将您的 Barbuttons 保存在一个**强大的插座**中并执行此操作以隐藏/显示它：

```
-(void) hideBarButtonItem :(UIBarButtonItem *)myButton {
    // Get the reference to the current toolbar buttons
    NSMutableArray *navBarBtns = [self.navigationItem.rightBarButtonItems mutableCopy];

    // This is how you remove the button from the toolbar and animate it
    [navBarBtns removeObject:myButton];
    [self.navigationItem setRightBarButtonItems:navBarBtns animated:YES];
}

-(void) showBarButtonItem :(UIBarButtonItem *)myButton {
    // Get the reference to the current toolbar buttons
    NSMutableArray *navBarBtns = [self.navigationItem.rightBarButtonItems mutableCopy];

    // This is how you add the button to the toolbar and animate it
    if (![navBarBtns containsObject:myButton]) {
        [navBarBtns addObject:myButton];
        [self.navigationItem setRightBarButtonItems:navBarBtns animated:YES];
    }
} 
```

需要时在功能下方使用..

```
[self showBarButtonItem:self.rightBarBtn1];
[self hideBarButtonItem:self.rightBarBtn1]; 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2017-08-04T07:40:35.760

只需设置 `barButton.customView = UIView()`并查看技巧

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2018-07-08T00:09:23.147

这是一个可以处理这个问题的扩展。

```
extension UIBarButtonItem {

    var isHidden: Bool {
        get {
            return tintColor == .clear
        }
        set {
            tintColor = newValue ? .clear : .white //or whatever color you want
            isEnabled = !newValue
            isAccessibilityElement = !newValue
        }
    }

} 
```

用法：

```
myBarButtonItem.isHidden = true 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2012-04-05T02:29:16.627

没有办法“隐藏” UIBarButtonItem，您必须将其从 superView 中删除，并在您想再次显示时将其添加回来。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2016-01-30T22:20:11.997

这在答案列表中还有很长的路要走，但以防万一有人想要一个简单的复制和粘贴来快速解决方案，这里是

```
func hideToolbarItem(button: UIBarButtonItem, withToolbar toolbar: UIToolbar) {
    var toolbarButtons: [UIBarButtonItem] = toolbar.items!
    toolbarButtons.removeAtIndex(toolbarButtons.indexOf(button)!)
    toolbar.setItems(toolbarButtons, animated: true)
}

func showToolbarItem(button: UIBarButtonItem, inToolbar toolbar: UIToolbar, atIndex index: Int) {
    var toolbarButtons: [UIBarButtonItem] = toolbar.items!
    if !toolbarButtons.contains(button) {
        toolbarButtons.insert(button, atIndex: index)
        toolbar.setItems(toolbarButtons, animated:true);
    }
} 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2012-04-05T03:26:59.083

一种方法是 `initWithCustomView:(UIView *)`在分配`UIBarButtonItem`. 的子类`UIView`将具有隐藏/取消隐藏属性。

例如：

**1.**有一个`UIButton`你想隐藏/取消隐藏的。

**2.**将其`UIButton`设为自定义视图。像 ：

```
UIButton*myButton=[UIButton buttonWithType:UIButtonTypeRoundedRect];//your button

UIBarButtonItem*yourBarButton=[[UIBarButtonItem alloc] initWithCustomView:myButton]; 
```

**3.**您可以隐藏/取消隐藏`myButton`您创建的。`[myButton setHidden:YES];`

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2015-12-01T09:16:46.047

对于 Swift 版本，这里是代码：

对于`UINavigationBar`：

```
self.navigationItem.rightBarButtonItem = nil

self.navigationItem.leftBarButtonItem = nil 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2014-04-04T17:28:11.140

当栏按钮项被禁用时，将文本颜色设置为清晰的颜色可能是一个更干净的选项。您不必在评论中解释任何奇怪之处。此外，您不会破坏按钮，因此您仍然保留任何相关的故事板 segues。

```
[self.navigationItem.rightBarButtonItem setTitleTextAttributes:@{NSForegroundColorAttributeName:[UIColor clearColor]}
                                                      forState:UIControlStateDisabled]; 
```

然后，当您想要隐藏栏按钮项目时，您可以这样做：

```
self.navigationItem.rightBarButton.enabled = NO; 
```

没有隐藏的属性很糟糕，但这提供了相同的结果。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2014-06-10T19:58:06.493

如果 UIBarButtonItem 有一个图像而不是其中的文本，你可以这样做来隐藏它： `navigationBar.topItem.rightBarButtonItem.customView.alpha = 0.0;`

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2015-11-13T01:18:44.170

我认为我会根据 lnafziger 接受的答案分享一些辅助方法，因为我在每个工具栏中都有多个工具栏和多个按钮：

```
-(void) hideToolbarItem:(UIBarButtonItem*) button inToolbar:(UIToolbar*) toolbar{
    NSMutableArray *toolbarButtons = [toolbar.items mutableCopy];
    [toolbarButtons removeObject:button];
    [toolbar setItems:toolbarButtons animated:NO];
}

-(void) showToolbarItem:(UIBarButtonItem*) button inToolbar:(UIToolbar*) toolbar atIndex:(int) index{
    NSMutableArray *toolbarButtons = [toolbar.items mutableCopy];
    if (![toolbarButtons containsObject:button]){
        [toolbarButtons insertObject:button atIndex:index];
        [self setToolbarItems:toolbarButtons animated:YES];
    }
} 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2016-05-31T15:49:15.277

您可以通过这种方式轻松获取视图并将其隐藏

```
let view: UIView = barButtonItem.valueForKey("view") as! UIView
view.hidden = true 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2016-10-25T07:14:04.807

**如果您使用的是 Swift 3**

```
if (ShowCondition){
   self.navigationItem.rightBarButtonItem = self.addAsset_btn 
 } 
else {
   self.navigationItem.rightBarButtonItem = nil
 } 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2013-09-16T17:57:18.080

补充 Eli Burke 的回复，如果您`UIBarButtonItem`有背景图片而不是标题，您可以使用以下代码：

```
-(void)toggleLogoutButton:(bool)show{
    if (show) {
        self.tabButton.style = UIBarButtonItemStyleBordered;
        self.tabButton.enabled = true;
        UIImage* imageMap = [UIImage imageNamed:@"btn_img.png"];
        [((UIButton *)[self.tabButton customView]) setBackgroundImage:imageMap forState:UIControlStateNormal];
    } else {
        self.tabButton.style = UIBarButtonItemStylePlain;
        self.tabButton.enabled = false;
        [((UIButton *)[self.tabButton customView]) setBackgroundImage:nil forState:UIControlStateNormal];
    }
} 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2015-08-21T11:43:40.243

您可以使用文本属性来隐藏条形按钮：

```
barButton.enabled = false
barButton.setTitleTextAttributes([NSForegroundColorAttributeName : UIColor.clearColor()], forState: .Normal) 
```

另请参阅我的 UIBarButtonItem 扩展解决方案以解决类似的问题：[Make a UIBarButtonItem disapear using swift IOS](https://stackoverflow.com/a/32139271/979986)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2012-04-05T02:47:14.250

您需要操作 toolbar.items 数组。

这是我用来隐藏和显示完成按钮的一些代码。如果您的按钮位于工具栏的最边缘或其他按钮之间，您的其他按钮将移动，因此如果您希望按钮消失，请将您的按钮作为最后一个按钮放在中心。我为按钮移动设置动画效果，我非常喜欢它。

```
-(void)initLibraryToolbar {

    libraryToolbarDocumentManagementEnabled = [NSMutableArray   arrayWithCapacity:self.libraryToolbar.items.count];
    libraryToolbarDocumentManagementDisabled = [NSMutableArray arrayWithCapacity:self.libraryToolbar.items.count];
    [libraryToolbarDocumentManagementEnabled addObjectsFromArray:self.libraryToolbar.items];
    [libraryToolbarDocumentManagementDisabled addObjectsFromArray:self.libraryToolbar.items];
    trashCan = [libraryToolbarDocumentManagementDisabled objectAtIndex:3];
    mail = [libraryToolbarDocumentManagementDisabled objectAtIndex:5];
    [libraryToolbarDocumentManagementDisabled removeObjectAtIndex:1];
    trashCan.enabled = NO;
    mail.enabled = NO;
    [self.libraryToolbar setItems:libraryToolbarDocumentManagementDisabled animated:NO]; 
```

}

所以现在可以使用下面的代码来显示你的按钮

```
[self.libraryToolbar setItems:libraryToolbarDocumentManagementEnabled animated:YES];
trashCan.enabled = YES;
mail.enabled = YES; 
```

或隐藏您的按钮

```
[self.libraryToolbar setItems:libraryToolbarDocumentManagementDisabled animated:YES];
trashCan.enabled = NO;
mail.enabled = NO; 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2013-01-10T21:00:18.700

在 IB 中，如果您将按钮的标题留空，它将不会出现（从未初始化？）。我经常在 UI 更新期间的开发过程中这样做，如果我希望一个条形按钮项临时消失而不删除它并丢弃它的所有出口引用。

这在运行时没有相同的效果，将按钮的标题设置为 nil 不会导致整个按钮消失。抱歉并没有真正回答您的问题，但可能对某些人有用。

编辑：这个技巧只有在按钮的样式设置为普通时才有效

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2013-11-10T20:36:45.737

我将在这里添加我的解决方案，因为我在这里找不到它。我有一个动态按钮，其图像取决于一个控件的状态。对我来说最简单的解决方案是将图像设置为`nil`如果控件不存在。每次控件更新时都会更新图像，因此这对我来说是最佳选择。只是为了确保我也设置了`enabled`to `NO`。

将宽度设置为最小值在 iOS 7 上不起作用。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2014-02-09T17:23:50.653

感谢@lnafziger、@MindSpiker、@vishal 等。人，

对于单个右（或左）条形按钮，我得出的最简单的衬线是：

```
self.navigationItem.rightBarButtonItem = <#StateExpression#>
    ? <#StrongPropertyButton#> : nil; 
```

如：

```
@interface MyClass()

@property (strong, nonatomic) IBOutlet UIBarButtonItem *<#StrongPropertyButton#>;

@end

@implementation

- (void) updateState
{
    self.navigationItem.rightBarButtonItem = <#StateExpression#>
        ? <#StrongPropertyButton#> : nil;
}

@end 
```

我对此进行了测试，它对我有用（通过 IB 连接的强大的条形按钮项目）。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-08-28T07:44:57.060

子类`UIBarButtonItem`。确保 Interface Builder 中的按钮设置为`HidableBarButtonItem`. 制作从按钮到视图控制器的出口。然后从视图控制器中，您可以通过调用隐藏/显示按钮`setHidden:`

HidableBarButtonItem.h

```
#import <UIKit/UIKit.h>

@interface HidableBarButtonItem : UIBarButtonItem

@property (nonatomic) BOOL hidden;

@end 
```

HidableBarButtonItem.m

```
#import "HidableBarButtonItem.h"

@implementation HidableBarButtonItem

- (void)setHidden:(BOOL const)hidden {
    _hidden = hidden;

    self.enabled = hidden ? YES : NO;
    self.tintColor = hidden ? [UIApplication sharedApplication].keyWindow.tintColor : [UIColor clearColor];
}

@end 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2015-01-20T13:20:57.790

我使用 xib 和 UIToolbar。BarButtonItem 是在 xib 文件中创建的。我为 BarButtonItem 创建了 IBOutlet。我用这段代码隐藏了我的 BarButtonItem

```
 self.myBarButtonItem.enabled = NO;
 self.myBarButtonItem.title =  nil; 
```

这对我有帮助。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2019-06-11T08:20:49.587

为了隐藏许多项目之一，我使用了以下代码：

```
self.navigationItem.leftBarButtonItems?.remove(at: 0)  
self.navigationItem.rightBarButtonItems?.remove(at: 1) 
```

我想如果需要可以重新添加这些项目。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2020-04-25T15:45:06.367

我有 2 个 leftBarButtonItems 的问题。在 Mac Catalyst 上，firstButton 指向一个不受支持的操作：使用 AVFoundation 录制视频。只有第二个按钮在 Mac Catalyst 上有效：使用 UIImagePickerController。

因此，在 Mac Catalyst 上，我必须将第一个 UIBarButtonItem 指向 secondButton 并始终隐藏第二个 UIBarButtonItem。在 iOS 上，两个按钮都应该显示。这是我的解决方案：

```
#if TARGET_OS_MACCATALYST
        self.navigationItem.leftBarButtonItem = self.secondButton;
        NSUInteger count = [self.navigationItem.leftBarButtonItems count];
        for (NSUInteger i = 0; i < count; i++) {
            UIBarButtonItem *thisButton = [self.navigationItem.leftBarButtonItems objectAtIndex:i];
            if (i == 1) {
                thisButton.enabled = NO;
                thisButton.tintColor = [UIColor clearColor];
            }
        }
#else
        self.navigationItem.leftBarButtonItem = self.firstButton;
#endif 
```

我希望它可以帮助有类似问题的人。

* * *

## 回答 #36

> 赞同：-1
> 
> 时间：2019-03-21T13:56:05.387

我的答案是 Swift 4！

```
if $0 {
    self.navigationItem.rightBarButtonItems = [UIBarButtonItem(customView: self.button1)]
} else {
    self.navigationItem.rightBarButtonItems = [UIBarButtonItem(customView: self.button2)]
} 
```

* * *

## 回答 #37

> 赞同：-5
> 
> 时间：2012-05-25T03:08:21.940

`bounds.width`对于您在 UIBarButtonItem 中的内容，我的解决方案设置为 0（我将这种方法与 UIButton 和 UISearchBar 一起使用）：

隐藏：

```
self.btnXXX.bounds = CGRectMake(0,0,0,0); 
```

显示：

```
self.btnXXX.bounds = CGRectMake(0,0,40,30); // <-- put your sizes here 
```

# python - Django Tastypie 高级过滤：如何使用 Q 对象进行复杂查找

> ID：10021749
> 
> 赞同：28
> 
> 时间：2012-04-05T02:04:39.640
> 
> 标签：python, django, tastypie, django-q

我有一个基本的 Django 模型，例如：

```
class Business(models.Model):
    name = models.CharField(max_length=200, unique=True)
    email = models.EmailField()
    phone = models.CharField(max_length=40, blank=True, null=True)
    description = models.TextField(max_length=500) 
```

我需要对上述模型执行一个复杂的查询，例如：

```
qset = (
    Q(name__icontains=query) |
    Q(description__icontains=query) |
    Q(email__icontains=query)
    )
results = Business.objects.filter(qset).distinct() 
```

我尝试了以下使用**美味派**但没有运气：

```
def build_filters(self, filters=None):
    if filters is None:
        filters = {}
    orm_filters = super(BusinessResource, self).build_filters(filters)

    if('query' in filters):
        query = filters['query']
        print query
        qset = (
                Q(name__icontains=query) |
                Q(description__icontains=query) |
                Q(email__icontains=query)
                )
        results = Business.objects.filter(qset).distinct()
        orm_filters = {'query__icontains': results}

    return orm_filters 
```

在美味派的 Meta 类中，我将过滤设置为：

```
filtering = {
        'name: ALL,
        'description': ALL,
        'email': ALL,
        'query': ['icontains',],
    } 
```

关于如何解决这个问题的任何想法？

谢谢 - 牛顿

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-04-05T03:20:07.107

你在正确的轨道上。但是，`build_filters`应该将资源查找转换为 ORM 查找。

默认实现将基于查询关键字拆分`__`为 key_bits、值对，然后尝试在查找的资源与其 ORM 等效项之间找到映射。

您的代码不应该在那里应用过滤器，只构建它。这是一个改进和固定的版本：

```
def build_filters(self, filters=None):
    if filters is None:
        filters = {}
    orm_filters = super(BusinessResource, self).build_filters(filters)

    if('query' in filters):
        query = filters['query']
        qset = (
                Q(name__icontains=query) |
                Q(description__icontains=query) |
                Q(email__icontains=query)
                )
        orm_filters.update({'custom': qset})

    return orm_filters

def apply_filters(self, request, applicable_filters):
    if 'custom' in applicable_filters:
        custom = applicable_filters.pop('custom')
    else:
        custom = None

    semi_filtered = super(BusinessResource, self).apply_filters(request, applicable_filters)

    return semi_filtered.filter(custom) if custom else semi_filtered 
```

因为您使用的是 Q 对象，所以标准`apply_filters`方法不足以应用您的自定义过滤器键（因为没有），但是您可以快速覆盖它并添加一个称为“自定义”的特殊过滤器。在这样做时，您`build_filters`可以找到一个合适的过滤器，构造它的含义并将其作为自定义传递给 apply_filters，这将简单地直接应用它，而不是尝试将其值从字典中解压缩为一个项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:24:51.653

我这样解决了这个问题：

```
Class MyResource(ModelResource):

  def __init__(self, *args, **kwargs):
    super(MyResource, self).__init__(*args, **kwargs)
    self.q_filters = []

  def build_filters(self, filters=None):
    orm_filters = super(MyResource, self).build_filters(filters)

    q_filter_needed_1 = []
    if "what_im_sending_from_client" in filters:
      if filters["what_im_sending_from_client"] == "my-constraint":
        q_filter_needed_1.append("something to filter")

    if q_filter_needed_1:
      a_new_q_object = Q()
      for item in q_filter_needed:
        a_new_q_object = a_new_q_object & Q(filtering_DB_field__icontains=item)
      self.q_filters.append(a_new_q_object)

  def apply_filters(self, request, applicable_filters):
    filtered = super(MyResource, self).apply_filters(request, applicable_filters)

    if self.q_filters:
      for qf in self.q_filters:
        filtered = filtered.filter(qf)
      self.q_filters = []

    return filtered 
```

这种方法感觉比我见过的其他方法更清晰地分离了关注点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-05T18:07:24.150

将astevanovic的答案中的想法和清理一下，以下应该可以工作并且更简洁。

主要区别在于 apply_filters 通过`None`用作键而不是`custom`（可能与列名冲突）变得更加健壮。

```
def build_filters(self, filters=None):
    if filters is None:
        filters = {}
    orm_filters = super(BusinessResource, self).build_filters(filters)

    if 'query' in filters:
        query = filters['query']
        qset = (
                Q(name__icontains=query) |
                Q(description__icontains=query) |
                Q(email__icontains=query)
                )
        orm_filters.update({None: qset}) # None is used as the key to specify that these are non-keyword filters

    return orm_filters

def apply_filters(self, request, applicable_filters):
    return self.get_object_list(request).filter(*applicable_filters.pop(None, []), **applicable_filters)
    # Taking the non-keyword filters out of applicable_filters (if any) and applying them as positional arguments to filter() 
```

# java - Java - 是什么导致 ClassFormatError？

> ID：10021752
> 
> 赞同：2
> 
> 时间：2012-04-05T02:05:14.583
> 
> 标签：java, class, format

从 Eclipse 运行程序时，它工作正常。

在 Eclipse 之外运行它时，我得到了这个：

```
 java.lang.ClassFormatError: Duplicate method name&signature in class file [Class Name] 
```

有问题的类是从一个接口实现的，并且该程序还有几个其他类是从错误中提到的类扩展而来的。

是什么原因造成的，如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-15T14:37:48.293

我遇到过同样的问题。至于我，根本原因是 aspectj 插件编译了两次源代码。Aspect 类留在“服务”模块中并使用 aspectJ 插件进行编译。然后它已经作为依赖项编译到顶级'web'模块中并再次符合（因为'service'模块在'web'模块的aspectJ插件配置中作为'weaveDependency'）。解决方案：我已经替换了“web”模块中的下一个配置

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>aspectj-maven-plugin</artifactId>
    <version>1.5</version>
    <configuration>
        <weaveDependencies>
            <weaveDependency>
                <groupId>com.taxi.core</groupId>
                <artifactId>service</artifactId>
            </weaveDependency>
        </weaveDependencies>
    </configuration> 
```

和

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>aspectj-maven-plugin</artifactId>
    <version>1.5</version>
    <configuration>
        <aspectLibraries>
            <aspectLibrary>
                <groupId>com.taxi.core</groupId>
                <artifactId>service</artifactId>
            </aspectLibrary>
        </aspectLibraries>
    </configuration> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T02:10:25.300

> 当 Java 虚拟机尝试读取类文件并确定该文件格式错误或无法解释为类文件时抛出。

[http://docs.oracle.com/javase/7/docs/api/java/lang/ClassFormatError.html](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassFormatError.html)

Javadocs 是您的朋友。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:28:57.963

谷歌搜索并发现禁用“保存时部署”可能有助于解决问题。在测试平台上试用并投入生产！

# r - 如何将多项式映射到多项式？

> ID：10021755
> 
> 赞同：1
> 
> 时间：2012-04-05T02:05:38.063
> 
> 标签：r, func

我怎样才能做类似双多项式的事情？

我有这个：

```
b <- function(ftn){2*ftn}
b(function(x) x) 
```

但是我在 2 * ftn 中得到错误：二进制运算符的非数字参数

我可以做某种 x <-2x 替换吗？

对不起，我是一个完整的初学者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:16:32.037

是的，但是您可以通过返回一个匿名函数来获取`x`值、调用`ftn`并应用转换。例如`f(x) ↦ 2f(x)`：

```
> doublePoly <- function(ftn) { function(x) { 2 * ftn(x) } }
> f <- function(x) {x^2 + 1}
> g <- doublePoly(f)
> c(f(1), g(1))
[1] 2 4
> c(f(3), g(3))
[1] 10 20 
```

可以使用这种技术进行任意转换，例如乘以`1+x`：

```
mult.1plusx <- function(ftn) { function(x) { (1+x) * ftn(x) } } 
```

或添加`exp(x)`到函数的对数：

```
exp.plus.log <- function(ftn) { function(x) { exp(x)  + log(ftn(x)) } } 
```

# python - 什么情况会导致打开的、非阻塞的命名管道 (fifo) 对读取“不可用”？

> ID：10021759
> 
> 赞同：13
> 
> 时间：2012-04-05T02:06:56.500
> 
> 标签：python, linux, named-pipes, fifo, mkfifo

情况：

```
new_pipe = os.open(pipe_path, os.O_RDONLY | os.O_NONBLOCK) # pipe_path points to a FIFO
data = os.read(new_pipe, 1024) 
```

读取偶尔会引发 errno -11：资源暂时不可用。

何时引发此错误？这似乎非常罕见，因为常见情况会返回数据：

*   如果没有 writer 打开管道，则返回空 str ('')。
*   如果 writer 已打开管道，但 fifo 中没有数据，则还返回空 str ('')
*   当然，如果作者将数据放入先进先出，该数据将被读取。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-05T02:36:28.650

从[系统调用的](http://pubs.opengroup.org/onlinepubs/009695399/functions/read.html)[POSIX 规范`read`](http://pubs.opengroup.org/onlinepubs/009695399/functions/read.html)（强调我的）：

> 尝试从空管道或 FIFO 中读取时：
> 
> *   如果没有进程打开管道进行写入，read() 将返回 0 以指示文件结束。
>     
>     
> *   **如果某个进程打开管道进行写入并且设置了 O_NONBLOCK，则 read() 应返回 -1 并将 errno 设置为 [EAGAIN]。**

所以基本上你的第二个假设是错误的：

> 如果 writer 已打开管道，但 fifo 中没有数据，则还返回空 str ('')

这将违反规范，我无法在我的机器上重现该行为（它`EAGAIN`为我提出）。但是，这不是一个大问题，您可以捕获异常并重试：

```
import errno

def safe_read(fd, size=1024):
   ''' reads data from a pipe and returns `None` on EAGAIN '''
   try:
      return os.read(fd, size)
   except OSError, exc:
      if exc.errno == errno.EAGAIN:
         return None
      raise 
```

# ajax - 在不刷新页面的情况下加载 Google 自定义搜索结果

> ID：10021761
> 
> 赞同：2
> 
> 时间：2012-04-05T02:07:03.980
> 
> 标签：ajax, google-custom-search

我想提交一个谷歌自定义搜索查询而不重新加载/刷新整个 html 页面。我正在使用带有“仅结果”布局的最新 v2 gcs。

在搜索表单上方的任何位置加载 gcs api

```
<script src="//www.google.com/jsapi" type="text/javascript"></script>
<script>
    google.load('search', '1',
        {language : 'en', style : google.loader.themes.V2_DEFAULT});
</script> 
```

我的自定义搜索表单

```
<form onsubmit="return executeQuery();" id="cse-search-box-form-id">
    <input type="text" name="q" id="cse-search-input-box-id" size="25" autocomplete="off"/>
    <input type="submit" id="site-search-submit" value="search"/>
</form> 
```

gcs 结果脚本放置在需要搜索结果的任何位置

```
<div id="cse" style="width: 100%;">Loading</div>

<script src="http://www.google.com/jsapi" type="text/javascript"></script>

<script type="text/javascript"> 

    google.load('search', '1', {language : 'en', style : google.loader.themes.V2_DEFAULT});
    google.setOnLoadCallback(function() {
        var customSearchOptions = {};  
        var customSearchControl = new google.search.CustomSearchControl(
       'UNIQUE-API-KEY', customSearchOptions);
        customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
        var options = new google.search.DrawOptions();
        options.setAutoComplete(true);
        options.enableSearchResultsOnly(); 
        customSearchControl.draw('cse', options);
        function parseParamsFromUrl() {
            var params = {};
            var parts = window.location.search.substr(1).split('\x26');
            for (var i = 0; i < parts.length; i++) {
                var keyValuePair = parts[i].split('=');
                var key = decodeURIComponent(keyValuePair[0]);
                params[key] = keyValuePair[1] ?
                    decodeURIComponent(keyValuePair[1].replace(/\+/g, ' ')) :
                    keyValuePair[1];

            }

            return params;

        }

        var urlParams = parseParamsFromUrl();
        var queryParamName = "q";
        if (urlParams[queryParamName]) {
            customSearchControl.execute(urlParams[queryParamName]);

        }

    }, true);

</script> 
```

任何帮助表示赞赏。

谢谢

**更新**

我已经实施，

```
customSearchControl.execute(urlParams[queryParamName]); 
```

现在我的搜索表单如下：

```
<form onsubmit="customSearchControl.execute(urlParams[queryParamName]);" id="cse-search-box-form-id">
    <input type="text" name="q" id="cse-search-input-box-id" size="25" autocomplete="off"/>
    <input type="submit" id="site-search-submit" value="search"/>
</form> 
```

但是，执行搜索仍会刷新整个页面，这会在启动 jquery 脚本之前将我的初始 html 格式设置为混乱。

谢谢

**更新**

我已经以多种组合添加了以下所有变体，但要么刷新整个页面，要么根本没有任何反应。

```
<form onsubmit="return executeQuery(); return false;" id="cse-search-box-form-id">

<form onsubmit="executeQuery(); return false;" id="cse-search-box-form-id">

<form onsubmit="return false; executeQuery();" id="cse-search-box-form-id">

<form onsubmit="return false; return executeQuery();" id="cse-search-box-form-id">

<form onsubmit="customSearchControl.execute(urlParams[queryParamName]); return false;" id="cse-search-box-form-id">

<form onsubmit="return executeQuery(); event.preventDefault();" id="cse-search-box-form-id">

<form onsubmit="customSearchControl.execute(urlParams[queryParamName]); event.preventDefault();" id="cse-search-box-form-id">

<form onsubmit="customSearchControl.execute(urlParams[queryParamName]); event.stopPropagation();" id="cse-search-box-form-id"> 
```

等等...

有人有这方面的经验吗？用于进一步定制的 json api 呢？这会以某种方式解决页面刷新的问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:14:19.133

你需要打电话

*customSearchControl.execute(urlParams[queryParamName]);*

每当你需要搜索。所以在表单上的 onsubmit 中使用该功能。

在解决这个问题时，我已经在我自己的网站上进行了设置。你可以[在这里查看](http://www.paragengineering.com/)。

基本上，我只是通过 jquery 将提交处理程序添加到表单中，并完成了谷歌在提交处理程序中所做的所有工作。完美无缺。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-02T17:37:41.827

最好的选择是使用 JQuery 创建钩子。下面的代码将在**searchButton**和**searchresults 之间创建一个钩子——仅**当渲染完成时。

为了使此设置正常工作，您需要为您的元素指定一个 gname，否则您将无法通过 google.cse.element 方法找到它。我有以下代码的[实时版本](http://cs.ndsu.nodak.edu/~skibinsk/search_only/)，但我不承诺将永久实时，因为它托管在我的 NDSU FTP 中。

**索引.html**

```
<!DOCTYPE html>
<html>
  <head>
    <title>Google Search Customization</title>
    <script src="https://code.jquery.com/jquery-1.12.1.js"></script>
    <script src="index.js"></script>
  </head>
  <body>
    <h1>Trigger an Element API v2 search through a custom textbox</h1>
    <label>Enter Search Query:</label><input id="customSearchText" type="text">
    <input id="customSearch" type="submit">
    <div style="width: 50%; float: right;">
      <gcse:searchresults-only gname="searchOnlyCSE"></gcse:searchresults-only>
    </div>
  </body>
</html> 
```

**index.js**

```
//Hook a callback into the rendered Google Search. From my understanding, this is possible because the outermost rendered div has id of "___gcse_0".
window.__gcse = {
  callback: googleCSELoaded
}; 
function googleCSELoaded() {
  // The hook in question.
  $("#customSearch").click(function() {
    var searchText = $("#customSearchText").val();
    console.log(searchText);
    var element = google.search.cse.element.getElement('searchOnlyCSE');
    element.execute(searchText);
  })
}

// CSE Code. This is a free version, so please don't make too many requests.
(function() {
  var cx = '001386805071419863133:cb1vfab8b4y';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})(); 
```

# objective-c - 在objective-c（xcode）中，如何知道视图的焦点发生了变化

> ID：10021764
> 
> 赞同：0
> 
> 时间：2012-04-05T02:07:19.470
> 
> 标签：objective-c, xcode, focus, views

我是 Objective-c (Xcode) 程序的新手。

我想知道当视图的焦点得到和失去焦点时如何获取事件。

视图未处理。只是在窗口中添加了另一个 subView。

```
 [self.window addSubview:anotherView.view] 
```

所以不会有 viewWillDisappear, viewDidDisappear, viewWillAppear, viewDidAppear 用于原始加载视图... :(

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T11:08:36.620

您实际上并不需要一个，因为您正在控制视图的添加和删除。但是，您可以`- (void)didAddSubview:(UIView *)subview`在视图子类（UIView 或 NSView）中覆盖。

根据[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)：

> 此方法的默认实现什么也不做。添加子视图时，子类可以覆盖它以执行其他操作。调用此方法以响应使用任何相关视图方法添加子视图。

# java - 使用 jpa jpql 进行复杂的 sql 查询

> ID：10021769
> 
> 赞同：0
> 
> 时间：2012-04-05T02:08:02.493
> 
> 标签：java, sql, hibernate, jpa, jpql

我将 JPA2 用于 dao 层。

假设我有一个如下表（只是一个示例）：

```
emp_name     week     approver_name  status   hours
emp1       2010-01-02    app1          a        2
emp1       2010-01-02    app1          a        2
emp1       2010-01-02    app2          b        3
emp1       2010-01-09    app1          b        2
emp1       2010-01-09    app2          a        7
emp2       2010-01-02    app1          b        5
emp2       2010-01-02    app2          a        9
emp2       2010-01-02    app1          a        3
emp2       2010-01-09    app2          a        4
emp2       2010-01-09    app2          b        7
emp2       2010-01-09    app1          a        3
emp2       2010-01-09    app1          a        2 
```

根据给定的表格，（实际上比这更复杂），我怎样才能得到这样的结果

```
emp_name     week     approver_name    status  hours (add hours together)
emp1      2010-01-02      app1          a        4
emp1      2010-01-02      app2          b        3
emp1      2010-01-09      app1          b        2
emp1      2010-01-09      app2          a        7
emp2      2010-01-02      app1          b        5
emp2      2010-01-02      app1          a        3
emp2      2010-01-02      app2          a        9
emp2      2010-01-09      app1          a        5
emp2      2010-01-09      app2          a        4
emp2      2010-01-09      app2          b        7 
```

注意：状态也必须区分。数据库中也不存在小时列，该列是 start_time 和 end_time

所以任何人都可以对此有一些好主意吗？我可以按任何列分组，因为它会混合结果。

感谢那。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:19:32.730

试试这个：

```
SELECT emp_name, week, approver_name, status, SUM(hours)
FROM MyTable
GROUP BY emp_name, week, approver_name, status
ORDER BY emp_name, week, approver_name, status 
```

# architecture - 避免分支 - 但需要维护多个国家/地区的代码

> ID：10021770
> 
> 赞同：0
> 
> 时间：2012-04-05T02:08:05.737
> 
> 标签：architecture, internationalization, branch, cvs

我们支持超过 4 个国家/地区的同一组代码库，每个国家/地区都有一些特定的更改。我们正在使用 CVS，我们在每个国家/地区都有 HEAD 和分支机构。一旦我们修复了任何分支中的某些内容，最终我们会将其合并到 HEAD 中。

我们只是想摆脱这个模型，我们可以避免合并问题。

是否有任何策略或流程或其他方法来避免合并，但为所有国家/地区维护一个代码库。？（我们尝试实现这一点：从 HEAD 签出并将其部署在某个国家/地区，并且该应用程序应该适用于该国家/地区而无需任何代码更改）

一种复杂的方法是检查国家为“XY”的代码，然后执行此操作。

但是，如果您能想到，除了这个代码更改之外还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-10T02:51:28.880

使用 XML 字典或 resourceBundles 来抽象本地化数据：

*   [本地化资源包](http://pic.dhe.ibm.com/infocenter/ssfs/v9r2/index.jsp?topic=%2Fcom.ibm.help.local.doc%2Ft_LocalizingResourceBundles.html)

*   [XSLT 反射](http://www.xml.com/lpt/a/1313)

*   [使用 XSLT 进行国际化](http://docstore.mik.ua/orelly/xml/jxslt/ch08_06.htm)

# css - css定位的Bazaar行为。在 jsfiddle 中工作，而不是在任何其他浏览器中。可能与内联与块有关

> ID：10021771
> 
> 赞同：1
> 
> 时间：2012-04-05T02:08:18.423
> 
> 标签：css, jsfiddle

这里有点疯了。

**这是jsfiddle：http:** [//jsfiddle.net/mersenneprimes/CvGKK/](http://jsfiddle.net/mersenneprimes/CvGKK/)

注意“业务”在右上角。

现在这是我在**html 文档**中的相同代码。

**这就是我得到的：** [http ://screencast.com/t/plAli1D3gpx](http://screencast.com/t/plAli1D3gpx)

注意“业务”*不在*右上角。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>

    <STYLE TYPE="text/css">

        div {
            position:relative;
            width:400px;
            height:100px;
            border:3px solid orange;

        }

        p {
            position:absolute;
            top:0;
            right:0;
            background-color:green;
        }

    </STYLE>
</head>
<body>
    <div>
        <p>business</p> 
    </div>
</body>
</html> 
```

**但是**，如果我改变

到 ，那么我做对了。

它正确地位于右上角。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:21:28.217

JSFiddle 上的 CSS 规范化包括：

```
body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,form,fieldset,input,textarea,p,blockquote,th,td { 
    margin:0;
    padding:0;
} 
```

你的 CSS 没有。添加

```
margin: 0;
padding: 0; 
```

到你的 'div' 和 'p' CSS，你应该得到与 JSFiddle 相同的行为。

# php - 在 PHP 中将特殊字母（á、â 等）转换为 UTF 8（十六进制）

> ID：10021772
> 
> 赞同：1
> 
> 时间：2012-04-05T02:09:01.013
> 
> 标签：php, utf-8, world-of-warcraft

我有一个问题，我似乎无法找到解决方案。我正在尝试使用提供的工具从魔兽世界军械库中提取数据，效果很好：

```
<?php
$toon = 'http://eu.battle.net/api/wow/character/(realm)/(character name)';
$data = file_get_contents($toon);
$obj = json_decode($data);?>
<img src="http://eu.battle.net/static-render/eu/<?php echo $obj->thumbnail; ?>"> </img><br />
<?php
echo "Name: " . $obj->name . "<br />";
echo "Level: " . $obj->level . "<br />";
echo "Image: " . $obj->thumbnail . "<br />";
?> 
```

我试图检索的是缩略图，其余的名称/级别等对我来说并不重要。问题仅在名称开始使用特殊字符时出现，例如：

á,â,etc ( [http://www.utf8-chartable.de/](http://www.utf8-chartable.de/) )

问题或多或少是军械库api只允许像

á = %C3%A1
â = %c3%a2

这有点奇怪，因为默认页面只是将这些转换回普通字母。但是 Api 不支持它。

**例如：**
[http](http://eu.battle.net/api/wow/character/darkspear/J%C3%ADmmeh) ://eu.battle.net/api/wow/character/darkspear/J%C3%ADmmeh （是 api）
[http://eu.battle.net/wow/en/character/darkspear/Jímmeh/simple](http://eu.battle.net/wow/en/character/darkspear/J%C3%ADmmeh/simple) （普通军械库页面）

我现在的问题是有人可以帮我找出一种将á转换为十六进制代码的方法吗？

```
&charname (getting the information from some input field normal characters)
**Converting the &charname with special characters to the charname with hex code's)**
&realmname = http://eu.battle.net/api/wow/character/(realm name)
&toon = &realmname.&charname 
```

（继续其余代码）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:17:10.717

URL 只能包含 ASCII 字符的子集，它们不支持“á”等字符。
要在 URL 中包含这样的非 ASCII 字符，您需要[`urlencode`](http://php.net/urlencode)它。

如果浏览器将 URL 显示为`darkspear/Jímmeh/simple`，那只是浏览器美化了 URL 以供显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T11:07:38.700

经过一夜好眠和更多工作后，我发现它并不完全有效:(

问题仍然在于现在例如：

á 变成 %E1 ，它的工作原理当然是它的 inteded。但是这个链接对于 wow API 仍然没有用。但经过一番搜索，我终于找到了方法，如果你想获得这样的链接，你必须这样做：

```
urlencode(utf8_encode($test)); 
```

这将使字符串为 utf8，然后将其更改为 url 编码，从而得到我所需要的:)

# mysql - 截断 SQL 选择中的字段值

> ID：10021775
> 
> 赞同：1
> 
> 时间：2012-04-05T02:09:16.987
> 
> 标签：mysql, sql

在 SQL 语句中，如何将文本字段 char 长度的返回值限制为一定的大小？

到目前为止尝试过-

```
select len(mytextfield,30) from table 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T02:11:46.903

您需要[SUBSTRING](http://msdn.microsoft.com/en-us/library/ms187748.aspx)功能。

`SELECT SUBSTRING(mytextfield, 1, 30) FROM Table`

（这是假设 SQL Sever / T-SQL；您没有指定数据库引擎。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:18:45.810

```
select left(mytextfield,30) 
```

我并不肯定，但我认为 substring 函数不适用于 TEXT 数据类型。

# jquery - 使用 JQuery 获取父级的父级

> ID：10021779
> 
> 赞同：2
> 
> 时间：2012-04-05T02:10:01.747
> 
> 标签：jquery

我有一个消失的删除动画代码，我想让整个 div“parent_parent”消失。

这是HTML

```
<div class="parent_parent">
    <div class="parent">
        <a href="?delete=1" class="delete_link"></a>
    </div>
</div> 
```

这是使 parent_parent div 消失的 jquery 代码的一部分：

```
$(document).ready(function() {
    $('a.delete_element').click(function(e) {
        e.preventDefault();
        var parent = $(this).parent();
        $.ajax({
            type: 'get',
            url: 'delete.php',
            data: 'ajax=1&delete=' + parent.parent().attr('id').replace('sort_', ''),
            beforeSend: function() {
                parent.parent().animate({
                    'backgroundColor': '#fff'
                }, 300);
            },
            success: function() {
                parent.parent().slideUp(300,function() {
                parent.parent().remove();
                });
            }
        });
    });
});​ 
```

但是到目前为止没有动画发生，但是如果我只调用一个父级，那么内部 div 确实会消失。我也没有收到任何错误消息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T02:14:07.737

您的代码对于您正在尝试做的事情仍然太复杂。这个更好：

```
// $(function(){ is shorthand for $(document).ready(function(){
$(function() {
    $('a.delete_element').click(function(e) {
        e.preventDefault();
        // Don't give thing ambiguous names like 'parent'
        // You should change your class names too.
        var container = $(this).closest(".parent_parent");
        $.ajax({
            type: 'get',
            url: 'delete.php',
            // You had multiple instances of parent.parent(), but no direct usage of parent alone
            // This is a clue that you can simplify parent.parent() since you are traversing to the same element every time
            data: 'ajax=1&delete=' + container.attr('id').replace('sort_', ''),
            beforeSend: function() {
                containter.animate({
                    'backgroundColor': '#fff'
                }, 300);
            },
            success: function() {
                container.slideUp(300, function() {
                    // Do not repeat the same selector within a callback
                    // That's what `this` is for
                    $(this).remove();
                });
            }
        });
    });
});​ 
```

如果您按原样使用此代码示例，它将起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:20:46.423

您可能没有阻止默认的锚标记操作。您可能还想缓存您将多次使用的引用。这是工作代码：

```
function(e) {
    e.preventDefault();
    var theParent = $(this).closest(".parent_parent");    
    theParent.slideUp(300, function() {
        theParent.remove();
    });
}; 
```

小提琴：http: [//jsfiddle.net/VXEUM/](http://jsfiddle.net/VXEUM/)

另请注意，我正在使用`closest()`而不是在`parent()`. 只是一种风格偏好。另外，如果您的元素嵌套更深，它仍然可以使用`closest()`.

# objective-c - 在屏幕外绘制 CoreGraphics 以防止动画在过渡期间出现卡顿？

> ID：10021780
> 
> 赞同：0
> 
> 时间：2012-04-05T02:10:03.243
> 
> 标签：objective-c, ios, xamarin.ios, core-animation, core-graphics

我的应用程序中有很多情况，我使用 CATransition 从一个视图转换到另一个视图。在转换到视图时，通常会有一个由 CoreGraphics 绘制的图形。为了论证的缘故，假设它是几个正方形。然而，当动画进入视图时，动画在第一次绘制图形时会在过渡的中途停顿一秒。

是否有一种（希望是简单的）方法在动画开始之前使用其自定义图形预先绘制此视图，因此不会发生这种口吃？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T09:01:51.833

设置`shouldRasterize`在`YES`图层上。

# iphone - ipa 安装后不显示 iPad 视网膜资源

> ID：10021782
> 
> 赞同：1
> 
> 时间：2012-04-05T02:10:19.860
> 
> 标签：iphone, ipad, ios5

我在为 New iPad 测试视网膜资源时遇到了一个奇怪的情况。我有一个准备发货的项目，它支持新 iPad。我们在项目中拥有所有的视网膜资源。当我通过 Xcode 在与我的机器物理连接的设备上进行构建时，视网膜图像显示良好，所有图形看起来都非常清晰。但是，当我进行归档以创建 ipa 文件并通过 iphone 配置实用程序在同一设备上安装应用程序时，不会显示视网膜图像，而是显示常规尺寸的图像，并且非常明显。

这是 iphone 配置实用程序的问题，还是我需要在归档 IPA 以包含视网膜资源时设置一些特定设置？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T21:37:36.687

对我来说，这是因为我是在 OS X 10.8 Mountain Lion 上构建的。我通过 App Store 使用最后一个官方 Xcode 将我们的构建服务器切换到 10.7.3，现在一切都很好。

我不是 100% 确定这是真正的原因，但是……很好的改变是 :-)

# database - 我们如何使用分页处理大表中的记录，其中记录的状态不断变化，从而影响给定页面中的内容？

> ID：10021783
> 
> 赞同：0
> 
> 时间：2012-04-05T02:10:20.967
> 
> 标签：database

有一个表包含超过 100,000 条与特定感兴趣标准匹配的记录。一个作业运行一次从该集合中获取 1000 条记录，并对每条记录执行一些操作。还有其他进程可能会更改此表中的记录，这可能会影响感兴趣的集合。由于这些变化，作业开始时应该在页面中的记录将不断变化。这会导致丢失某些记录或多次处理某些记录。

虽然我知道系统的设计应该避免这种情况，但在这一点上重新设计系统不是一个选择。所以，我想知道这是否是一个常见的场景，如果是，存在什么样的解决方案模式？我尝试使用谷歌搜索，但无法获得任何有意义的点击。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:12:24.960

一种方法是在数据库空闲时克隆数据库，然后在作业中处理副本。数据会有点过时，但如果您的数据库在您尝试访问全部内容时不断更新，那么它不可能是“最新的”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:22:53.077

假设获取 1000 条记录并对其执行计算不是一个耗时的过程，您可以将代码包装到事务中。当然，这意味着其他连接将无法同时修改感兴趣的表。他们基本上必须等到事务完成才能运行更新/插入语句。因此，如果您的代码没有花费大量时间并且其他连接的超时是合理的，那么这是一个可能的解决方案。

# ruby-on-rails - Rails 资产管道和摘要值

> ID：10021784
> 
> 赞同：6
> 
> 时间：2012-04-05T02:10:24.290
> 
> 标签：ruby-on-rails, ruby, rake, asset-pipeline, sprockets

有谁知道资产摘要值是如何计算的？如果我有两个 JS 文件，其中包含各种其他包含的 JS 脚本，那么如果没有更改任何内部脚本，每个文件是否会保持相同的摘要哈希？还是每次运行 assets:precompile 操作时都会计算一个新的摘要值？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-10-22T06:23:23.843

公认的答案并不完全正确。我们为我们的登台、演示和生产服务器构建静态资产，并且在每种情况下，相同的资产被赋予不同的摘要值。

事实证明，Rails 环境也被考虑在内。Sprockets 创建摘要如下：

```
# Sprockets::Environment::initialize
@digest_class = ::Digest::MD5

# Sprockets::Base::digest
@digest ||= digest_class.new.update(VERSION).update(version.to_s)

# Sprockets::Base::file_digest(path)
digest.file(path.to_s)

# Sprockets::Asset::initialize
@digest = environment.file_digest(pathname).hexdigest 
```

Rails 钩入 Sprockets 如下：

```
# Sprockets::Railtie
app.assets = Sprockets::Environment.new(app.root.to_s) do |env|
  env.version = ::Rails.env + "-#{config.assets.version}"
  ...
end 
```

所以 rails 正在创建一个与 Rails 环境版本相同的 Sprockets 环境，并且 Sprockets 在创建摘要类时使用该版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:18:02.103

从[导轨上抓取](http://guides.rubyonrails.org/asset_pipeline.html)

> 当文件名是唯一的并且基于其内容时，可以设置 HTTP 标头以鼓励各处的缓存（无论是在 CDN、ISP、网络设备还是 Web 浏览器中）以保留自己的内容副本。当内容更新时，指纹会发生变化。这将导致远程客户端请求内容的新副本。这通常称为缓存清除。
> 
> Rails 用于指纹识别的技术是在名称中插入内容的散列，通常在末尾。例如，CSS 文件 global.css 可以使用**其内容的 MD5 摘要重命名**

# java - 我的 dll 代码从 exe 文件工作，但无法从 Java loadLibrary 加载

> ID：10021786
> 
> 赞同：16
> 
> 时间：2012-04-05T02:10:48.270
> 
> 标签：java, dll, java-native-interface, loadlibrary

我创建了一个 C++ 模块来构建共享库文件，然后使用 JNI 从 Java 调用它。

我有 2 个环境，Windows 和 Unix，我有一个 C++ 可执行程序和一个 Java 程序，我只是为每个环境重新编译。

*   当我在 Unix 中编译我的 tester.exe 程序并使用我的库 (.so) 中的方法运行它时，它工作正常。
*   当我在 Unix 中编译我的 Java 程序并使用 Java 的 loadLibrary 加载我的库 (.so) 时，它工作正常。
*   当我在 Windows 中编译我的 tester.exe 程序并使用我的库 (.dll) 中的方法运行它时，它工作正常。就像unix版本一样。

*   **当我在 Windows 中编译我的 Java 程序并使用 Java 的 loadLibrary 加载我的库 (.dll) 时，它失败了。它说尝试访问无效地址。**

我不知道为什么它在 Windows 中运行时不能与 Java loadLibrary 一起使用，但它在其他任何地方都可以使用相同的代码。如果我延迟加载我的库使用的依赖 DLL，那么我的库会以 Java 加载但无法正常工作。我知道有特定的代码会导致 Java 加载我的库时出现问题，但我无法弄清楚为什么我的 C++ exe 对相同的方法和库没有问题。

* * *

我的 dll 有 1 个公开的方法，它从一些现有的库中调用 4 个方法。如果我将这 4 个方法注释掉，那么我的 dll 可以很好地加载到 Java 中。我知道这与我的 dll 链接到的库中的这些方法有关。Java如何看待依赖库有什么不同吗？我已经尝试先加载依赖库，但是我加载的其中一个 dll 文件会导致递归错误并且堆栈溢出。

任何人都知道解决导致递归错误堆栈溢出的 DLL 的方法吗？我需要其中的方法，但我无法使用 java loadLibrary 加载它。

* * *

这是有关所涉及文件和实际错误消息的更多详细信息。我在我的初始 dll 文件中添加了一个 DllMain 只是为了查看加载的内容和时间。如果我将同一个程序（my_plain_dll_to_call_JNI_DLL）编译为 exe 文件，一切正常。如果我编译它并从我的 java 程序中加载它，就会发生这种情况。

*   myJavaProgram，只需调用 System.loadLibrary() 来加载一个基本的 .dll 文件，该文件调用我的另一个包含 JNI 代码的 dll 中的方法。
*   my_plain_dll_to_call_JNI_DLL 是我通过将其链接到我的 dll 库文件创建的一个 dll，只是为了测试依赖关系。它只是从另一个调用我需要的本机代码的 dll 中调用一个方法。
*   my_JNI_DLL.ll 是一个 dll 文件，它与我需要从 JNI 访问的现有 C++ 编程库链接。它包含对现有源代码库中方法的直接调用。

我写了文件名，在每行左侧显示文本，以显示执行所在的层。

```
 c:\java myJavaProgram
myJavaProgram: Java Static Method Entry.

myJavaProgram: Java Calling System.loadLibrary(my_plain_dll_to_call_JNI_DLL)

my_JNI_DLL.dll: Entering DllMain

my_JNI_DLL.dll: DLL_PROCESS_ATTACH

my_plain_dll_to_call_JNI_DLL: DLL_PROCESS_ATTACH
my_plain_dll_to_call_JNI_DLL: DLL_THREAD_ATTACH
my_plain_dll_to_call_JNI_DLL: DLL_THREAD_DETACH
my_plain_dll_to_call_JNI_DLL: DLL_PROCESS_DETACH

myJavaProgram: my_plain_dll_to_call_JNI_DLL Loaded!

myJavaProgram: Java Static Method Exit.

myJavaProgram: Entering Main().

my_plain_dll_to_call_JNI_DLL: In call_my_JNI_DLL_method

my_JNI_DLL.dll: In my_JNI_DLL_method

my_JNI_DLL.dll: Entering my_JNI_DLL_CheckEnvironmentVariables()

my_JNI_DLL.dll: Exiting my_JNI_DLL_CheckEnvironmentVariables

my_JNI_DLL.dll: Calling StartExistingNativeCode.

#
# A fatal error has been detected by the Java Runtime Environment:
#
#  Internal Error (0xc0fb007e), pid=7500, tid=7552
#
# JRE version: 6.0_21-b06
# Java VM: Java HotSpot(TM) Client VM (17.0-b16 mixed mode, sharing windows-x86 )
# Problematic frame:
# C  [KERNELBASE.dll+0x9673]
#
# An error report file with more information is saved as:
# C:\hs_err_pid7500.log
#
# If you would like to submit a bug report, please visit:
#   http://java.sun.com/webapps/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#

my_plain_dll_to_call_JNI_DLL: DLL_PROCESS_DETACH

my_JNI_DLL.dll: Entering DllMain

my_JNI_DLL.dll DLL_PROCESS_DETACH 

```

* * *

**更新** 我已将问题范围缩小到从我的程序使用的另一个 dll 链接的内存管理库。它使用的 dll 是 sh33w32.dll，它被称为 SmartHeap，我认为是由一家名为 Microquil 的公司提供的。我有 3.3 版，当 Java LoadLibrary 尝试加载该 dll 时，它失败了。我不确定我能做些什么来让 java 处理加载该库。它必须与 Java 可以访问的内存区域有关，而不是 windows 允许 exe 访问的内存区域。exe 与 SmartHeap 库没有问题，但 Java 不允许我使用它。有任何想法或经验来处理这个问题吗？我试图通过重新编译其他库来删除链接库，但是代码中的正常调用失败了，这通常是有效的。

* * *

**找到的附加信息** dll 中无法在 java 中加载的函数称为 MemRegisterTask。它来自 Microquill 的名为 SmartHeap 的产品。这是我找到的有关此功能的文档。我认为这种内存分配是导致 java 无法加载它的原因。

MemRegisterTask 初始化 SmartHeap 库。在大多数平台上，您不需要调用 MemRegisterTask，因为 SmartHeap 会在您第一次调用时自行初始化。

SmartHeap 为每个任务或进程维护一个注册引用计数。每次调用 MemRegisterTask 时，此引用计数都会增加。如果您对 SmartHeap 的最后一次调用发生在您的应用程序准备好终止之前，您可以调用 MemUnregisterTask 来终止 SmartHeap。MemUnregisterTask 将注册引用计数减一——当计数为零时，SmartHeap 将释放任何 SmartHeap 分配的内存和与当前任务或进程相关的调试状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T17:40:05.237

hs_err ... 日志文件中的任何有用信息。通常有一个堆栈回溯等指出一些事情。

还尝试在调试器中运行 java.exe（使用运行加载内容的测试的参数）？

从上面的跟踪可以看到加载似乎工作正常（跟踪输出表明 dllentrypoint/dllmain 已由您增加了跟踪输出）。

加载顺序如下：

1.  加载依赖的dll
2.  加载dll本身
3.  调用带有进程附加的 dllentrypoint/dllmain

所以这已经超出了加载 DLL 的范围。

您是否检查过您是否使用 Windows 的调试/发布运行时？调试可能与发布冲突 - Java 是发布，您的示例 exe 可能与您的 dll 版本相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T10:45:00.190

对我来说，这看起来像是一个调用约定或类型大小不匹配。每个 Windows C 编译器都有自己的一组特性，并且 Windows JNI 标头假定（最新版本）Microsoft Visual C++。仔细查看警告 - 精度下降是不好的迹象。

例如，`__int64`是特定于 MSVC 的。在`__int64`包含`jni.h`.

# java - 使用非静态方法而不将其引用到对象？

> ID：10021788
> 
> 赞同：1
> 
> 时间：2012-04-05T02:10:56.250
> 
> 标签：java, object, methods

```
public class Appointment{
    public TimeInterval getTime();
    {/*implementation not shown*/}

    public boolean conflictsWith(Appointment other)
    {
     return getTime().overlapsWith(other.getTime());
    }
}

public class TimeInterval{
    public boolean overlapsWith(TimeInterval interval)
    {/*implementation not shown*/}
} 
```

我的问题在于`return getTime().overlapsWith(other.getTime())`陈述。`getTime()`不是静态方法，所以我认为它只能在引用对象时使用。但是从该声明中，没有提到任何对象。我知道它会`getTime()`为后续方法返回一个对象，但它本身呢？我的同学解释说“当我们要使用该`conflictsWith()`方法时，我们会声明一个对象，因此return语句将相当于`return object.getTime().overlapsWith(other.getTime()）;`”这种解释是否正确？那么这是否意味着当我们在方法中使用非静态方法时，不需要引用对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T02:13:52.700

由于`getTime()`不是静态方法，因此在当前对象上调用它。实现相当于

```
public boolean conflictsWith(Appointment other)
{
  return this.getTime().overlapsWith(other.getTime());
} 
```

您只会调用`conflictsWith()`一个`Appointment`对象，如下所示：

```
Appointment myAppt = new Appointment();
Appointment otherAppt = new Appointment();
// Set the date of each appt here, then check for conflicts
if (myAppt.conflictsWith(otherAppt)) {
  // Conflict
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T02:12:53.150

调用非静态方法时，对象`this`是隐含的。在运行时，`this`对象指的是正在操作的对象的实例。在您的情况下，它指的是调用外部方法的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T02:20:18.203

在 Appointment 内部，getTime() 等价于 this.getTime()。

您的 conflictWith 可以这样重写：

```
TimeInterval thisInterval = this.getTime(); // equivalent to just getTime()
TimeInterval otherInterval = object.getTime();
return thisInterval.overlapsWith(otherInterval); 
```

# ssis - 如何提高在 SSIS 中向表中插入数据的性能

> ID：10021790
> 
> 赞同：0
> 
> 时间：2012-04-05T02:11:02.900
> 
> 标签：ssis

我有一个包含7 列的**30 万（300,000）**条记录的文本文件。我将数据插入到临时表中，然后执行业务逻辑以将数据从那里插入到多个表中。

该文件如下所示：

```
01|000001111|27/04/2011|12/01/2012|ISDF|AB|1      
02|000002222|09/01/2010|29/01/2010|CfGH|CV|1      
03|000003333|19/07/2005|09/07/2007|TBRF|CC|1 
```

暂存表称为`Stagetable`.

我正在使用平面文件源和 OLEDB 目标，它需要 7 个多小时才能将数据插入临时表。我需要提高性能。

我是第一次使用 SSIS 包。

关于如何提高性能的任何建议都会很棒。

谢谢王子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T12:07:52.500

以下内容应该有所帮助；

- 在处理之前将您的文件靠近您的目标（即在同一个盒子上）以避免网络延迟

- 从 SQL Server 而非 Visual Studio 中部署和运行您的包

- 使用 SQL Server 目标，而不是 OLE DB 作为目标以加快加载速度

-关闭目标组件的约束检查

-检查目标表在加载时没有发生昂贵的触发器

- 如果您不需要执行任何转换，请考虑使用批量插入任务

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:02:24.533

3 lacs 只有 300000，而且每行的字段看起来也不是特别宽。这是一个很小的数字，不会引起任何问题。

试着找出瓶颈在哪里——在源头还是目的地？如果 source 是瓶颈，您可以拆分文件并将它们暂存到单独但相同的暂存表中，例如 stg_1、stg_2 等，然后并行加载它们。

如果目标是瓶颈，您可以使用平衡数据分配器，并将它们放入不同的临时表中。

同样，对于 300K 行来说，所有这些似乎都是多余的。

确保暂存表上没有任何索引。我们很乐意听取您的意见，您尝试了哪些方法，哪些方法有效，以及您是如何解决的。

# entity-framework - 像这样使用 EF 将多个查询聚合为一个？

> ID：10021795
> 
> 赞同：3
> 
> 时间：2012-04-05T02:11:48.407
> 
> 标签：entity-framework, entity-framework-4, querying

我在我的应用程序中使用 EF 4.0 POCO。**检索这样的信息有什么缺点吗？**

给定 a`customerId`和 a `productId`，我想应用一些业务规则，这些规则要求我从需要多个查询的数据库中获取大量信息。相反，我可以像这样编写一个查询：

```
var customerId = 1;
var productId = 1;

var aggregateQuery = 
    from entry in Customers.Take(0).DefaultIfEmpty()
    select new
    {
        numberOfOrders = SalesOrderHeaders.Where (header => header.CustomerID == customerId).Count(),
        canSellProduct = Products.Where(product => product.ProductID == productId && product.SellEndDate > DateTime.Now).Count () > 0

        //more infromation of this sort, required to enforce business rules
    };

var informationPacket = aggregateQuery.First(); 
```

`Customers.Take(0).DefaultIfEmpty()`只是提供了一种启动查询的方法，`Customers`并且`SalesOrderHeaders`和`Products`是上下文中的 EF ObjectQuery 实例（此示例来自 LinqPad）。这将产生以下 SQL：

```
-- Region Parameters
DECLARE @p0 Int = 1
DECLARE @p1 Int = 1
DECLARE @p2 DateTime = '2012-04-04 21:02:20.798'
DECLARE @p3 Int = 0
-- EndRegion
SELECT TOP (1) [t6].[value] AS [numberOfOrders], [t6].[value2] AS [canSellProduct]
FROM (
    SELECT (
        SELECT COUNT(*)
        FROM [Sales].[SalesOrderHeader] AS [t3]
        WHERE [t3].[CustomerID] = @p0
        ) AS [value], 
        (CASE 
            WHEN ((
                SELECT COUNT(*)
                FROM [Production].[Product] AS [t5]
                WHERE ([t5].[ProductID] = @p1) AND ([t5].[SellEndDate] > @p2)
                )) > @p3 THEN 1
            WHEN NOT (((
                SELECT COUNT(*)
                FROM [Production].[Product] AS [t5]
                WHERE ([t5].[ProductID] = @p1) AND ([t5].[SellEndDate] > @p2)
                )) > @p3) THEN 0
            ELSE NULL
         END) AS [value2]
    FROM (
        SELECT NULL AS [EMPTY]
        ) AS [t0]
    OUTER APPLY (
        SELECT TOP (0) NULL AS [EMPTY]
        FROM [Sales].[Customer] AS [t1]
        ) AS [t2]
    ) AS [t6] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:20:54.960

我倾向于使用单独的查询，原因有以下三个：

*   **隔离**：单独的查询更清晰，更易于维护：使用一个整体查询，每次更改都可能有许多副作用。将业务规则应用于小的、孤立的代码段更容易。
*   **效率**：您最终*可能会*编写一个比单独查询效率低得多的查询，因为不可能找到一个好的执行计划，这甚至可能超过更多数据库往返的成本（但这要进行基准测试）。
*   **锁定**：它可能会工作一段时间，直到需求以一种大查询不再工作的方式发生变化：可能需要不成比例的大量重构。

再加上一点直觉：需要一些技巧 ( `Take(0)`) 通常表示糟糕的设计（或者也许你只是 f** 聪明，但在我的情况下通常是前者）。

但是，我当然看到了潜在的优势。如前所述，由于较少的数据库往返，它可能会表现得更好。`select new`使用一个来组合一个数据传输对象而不是从单独的位将它编织在一起是相当舒服的。

所以，没有一个明确的判决。就我个人而言，我喜欢让事情变得简单，并在真正成为问题时处理性能。

# java - 如何生成一个由 n 个随机正整数组成的序列，它们加起来等于某个值？

> ID：10021796
> 
> 赞同：5
> 
> 时间：2012-04-05T02:12:00.013
> 
> 标签：java, math, random, precision

我正在尝试生成一个整数数组，其中包含随机数加起来一个特定的值。这是我的代码：

```
private long[] getRandoms(long size , long sum) throws Exception {
  double iniSum = 0;
  System.out.println("sum = " + sum);
  long[] ret = new long[(int) size];
  for (int i = 0 ; i < ret.length; i++) {
    ret[i] = randomInRange(1, sum);
    iniSum += ret[i];
  }

  double finSum = 0;
  for (int i = 0 ; i < ret.length; i++) {
    ret[i] =  Math.round((sum * ret[i]) / iniSum);
    System.out.println("ret[" + i +"] = " + ret[i]);
    finSum += ret[i];
  }

  if (finSum != sum) throw new Exception("Could not find " + size + " numbers adding up to " + sum  + " . Final sum = " + finSum);
  return ret;
}

private long randomInRange(long min , long max) {
  Random rand = new Random();
  long ret = rand.nextInt((int) (max - min + 1)) + min;
  System.out.println("ret = " + ret);
  return ret;
} 
```

但是，结果并不准确，例如：

> 找不到 4194304 的 100 个数字。最终总和 = 4194305.0

我认为我在这一点上失去了准确性：

```
(sum * ret[i]) / iniSum 
```

您能否在我的代码中推荐一种替代算法或修复方法来帮助我实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T02:35:14.490

每次用 缩放一个值时`ret[i] = Math.round((sum * ret[i]) / iniSum)`，都会损失一些精度，部分原因是除法运算本身，但主要是因为将缩放后的值存储为整数。后一种情况类似于比例选举制度，其中少数席位必须按比例分配给大量选票。

缓解这种情况的两种技术：

首先缩放列表中的所有值，但跟踪理想缩放值（实数）和存储的缩放值之间的差异。使用截断而不是四舍五入，以便差异始终为正。如果存在差异，您可以按照理想数量和当前存储数量之间的差异顺序增加一些值。

```
long finSum = 0;  // Might as well be a long
float[] idealValues = new float[size];
for (int i = 0 ; i < ret.length; i++) {
    ideal[i] = (sum * ret[i]) / iniSum;
    ret[i] = (long) (ideal[i]);  // Truncate, not round
    System.out.println("ret[" + i +"] = " + ret[i]);
    finSum += ret[i];
}

/* There are iniSum - finSum extra amounts to add. */
for (int i = 0; i < iniSum - finSum; i++)
{
    /* Pick a target slot to increment.  This could be done by keeping a priority queue. */
    int target = 0;
    float bestScore = 0.0;
    for (int j = 0; j < size; j++) {
        float score = (ideal[j] - ret[j])/ret[j];
        if (score > bestScore) {
            target = j;
            bestScore = score;
        }
    }

    /* Allocate an additional value to the target. */
    ret[target]++;
} 
```

或者更简单地说，您可以将列表中的最后一个值设置为缩放完成所有其他值之后的突出值。然而，这确实会在统计上扭曲输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T02:25:14.807

刚刚有了一个想法。将数组初始化为全0。随机选择数组中的一个数字，然后加1，减1，直到总和为0。总和很大时根本不实用:)

```
long ret = new long[size];
for(int i=0;i<size;i++) ret[i]=0;
for(int i=0;i<sum;i++) {
  int n = random(0,size);
  ret[n]++;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-06T16:49:01.047

是的，有一种标准方法可以避免浮点数不准确。它与计算[数字相加](https://stackoverflow.com/a/10046001/238419)[的方式数的方法有关`n``s`](https://stackoverflow.com/a/10046001/238419)。它并不复杂，但奇怪的是还没有人提到它，所以这里是：

* * *

想象一下，我们有一个带有`n-1`X 和`s`o 的字符串。因此，例如，对于 s=5，n=3，一个示例字符串将是

> oXooXoo

请注意，X 将 o 分为三个不同的组：长度 1、长度 2 和长度 2 之一。这对应于解 [1,2,2]。通过计算组合在一起的 o 的数量，每个可能的字符串都为我们提供了不同的解决方案*（0 是可能的：例如，`XoooooX`将对应于 [0,5,0]）*。

所以，我们需要做的就是想象通过为`n-1`X 选择随机位置来创建这样一个字符串，然后找出对应的解决方案。以下是更详细的细分：

1.  **在 之间生成`n-1`唯一的随机数`[1, s+n-1]`**。[使用拒绝抽样](http://en.wikipedia.org/wiki/Rejection_sampling)来做到这一点很简单——如果一个数字被选择了两次，只需放下它并选择另一个。
2.  **对它们进行排序，然后找出每个 X 之间的 o 数**。这个数字原来是`currentValue - previousValue - 1`。

* * *

最后，这里是一些应该执行此操作的示例 Java（未经测试）：

```
private List<long> getRandomSequenceWithSum(int numValues, long sum)
{
    List<long> xPositions = new List<long>();
    List<long> solution = new List<long>();
    Random rng = new Random();

    //Determine the positions for all the x's
    while(xPositions.size() < numValues-1)
    {
        //See https://stackoverflow.com/a/2546186/238419
        //for definition of nextLong
        long nextPosition = nextLong(rng, sum+numValues-1) + 1; //Generates number from [1,sum+numValues-1]
        if(!xPositions.contains(nextPosition))
            xPositions.add(nextPosition);
    }

    //Add an X at the beginning and the end of the string, to make counting the o's simpler.
    xPositions.add(0);
    xPositions.add(sum+numValues);
    Collections.sort(xPositions);

    //Calculate the positions of all the o's
    for(int i = 1; i < xPositions.size(); i++)
    {
        long oPosition =  xPositions[i] - xPositions[i-1] - 1;
        solution.add(oPosition);
    }

    return solution;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T02:16:20.567

我相信您的问题在于`Math.round`尝试修改代码以使用双精度并避免任何精度损失

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T02:35:22.330

一个好的方法是使用一个间隔列表，然后在每个步骤中对其进行拆分。这是伪代码

```
 array intervals = [(0,M)]
   while number intervals<desired_number
     pick an split point x
     find the interval containing x
     split that interval at x 
```

如果你想非常小心，你需要检查你的分割点 x 不是间隔的终点。你可以通过拒绝来做到这一点，或者你可以选择要拆分的区间，然后在哪里拆分该区间，但在这种情况下，你需要小心不要引入偏见。（如果你关心偏见）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-05T02:29:09.373

这个怎么样：

```
long finSum = 0;
for (int i = 0 ; i < ret.length; i++) {
  ret[i] =  Math.round((sum * ret[i]) / iniSum);
  System.out.println("ret[" + i +"] = " + ret[i]);
  finSum += ret[i];
}
ret[0] += sum - finSum; 
```

换句话说，将所有舍入误差放入第一个元素中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-05T02:29:39.037

建议：

```
 for (int i = 0 ; i < ret.length; i++) {
    ret[i] = randomInRange(1, sum);
    iniSum += ret[i];
  } 
```

在第一个 for 循环中，不是从 0 迭代到 (ret.length-1)，而是仅使用从 0 到 (ret.length-2) 的迭代。保留最后一个元素进行调整。

也不要调用 randomInRange(1, sum)，而是使用 randomInRange(1, sum-iniSum)。这将减少所需的标准化。

最后，最后一个输出数字将是 (sum-iniSum)。因此，可以删除第二个 for 循环。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-05T02:44:17.240

拿一个号码。从中减去一个合理的随机数。重复直到你得到足够的数字。根据定义，它们的总和是固定的，并且等于初始数字。您在需要的数字数量处进行精确`n`操作；`n`没有猜测。

这是Python代码：

```
import random
def generate_randoms(initial, n):
  # generates n random numbers that add up to initial.
  result = [] # empty list
  remainder = initial # we'll subtract random numbers and track the remainder
  numbers_left = n
  while numbers_left > 1:
    # guarantee that each following step can subtract at least 1
    upper_bound = remainder - numbers_left 
    next_number = random.randrange(1, upper_bound) # [1, upper_bound) 
    result.append(next_number)
    remainder -= next_number # chop off
    numbers_left -= 1
  result.append(remainder) # we've cut n-1 numbers; don't forget what remains
  return result 
```

它有效，但它有一个缺点：数字越远，它们越小。您可能需要对结果列表进行洗牌来解决这个问题，或者使用较小的上限。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-05T07:55:07.633

这肯定是一个有趣的问题（赞成！），我期待看到一些更有创意的解决方案。我对您列出的代码的一个问题是您正在使用`Random`该类，它只返回整数，而不是长整数，但是您只需将其转换为长整数。因此，如果您的函数确实需要 long，则必须找到不同的随机数生成器。

“理想”的解决方案是生成所有可能的加法组合（称为分区），然后随机选择一个。然而，最知名的算法确实非常昂贵。关于这个问题有很多很好的源材料。这是关于分区算法的特别好的阅读：

[http://www.site.uottawa.ca/~ivan/F49-int-part.pdf](http://www.site.uottawa.ca/~ivan/F49-int-part.pdf)

部分问题是在这种情况下弄清楚你所说的“随机”是什么意思。例如，如果您要查找一个由 5 个数字组成且总和为 1000 的数组，则 {1000,0,0,0,0} 与 {200,200,200,200,200} 一样有效，与 {136,238,124,66,436} 一样有效. 具有相同机会生成任何这些集合的算法将是真正随机的。

但是，我猜您不是在寻找完全随机的分布，而是介于两者之间。

不幸的是，我的 Java 已经很生疏了，而且这些天我几乎所有的事情都是用 C# 做的，所以我将用 C# 来介绍……将这些算法转换成 Java 不需要太多的翻译。

这是我对这个问题的看法：

```
public int[] GetRandoms( int size, int sum, Random r=null ) {
  if( r==null ) r = new Random();
  var ret = new int[size];
    while( sum > 0 ) {
      var n = r.Next( 1, (int)Math.Ceiling((double)sum/size)+1 );
      ret[r.Next(size)] += n;
      sum -= n;
    }
    return ret;
} 
```

（实际上，看看我是如何传入我的随机数生成器`null`的？为了方便起见，我将其默认为并创建一个新的，但现在我可以传入一个种子随机数生成器，并在以下情况下生成相同的结果我希望，这非常适合测试目的。每当您有使用随机数生成器的方法时，我强烈建议采用这种方法。）

该算法基本上不断将随机数添加到数组中的随机条目，直到达到总和。由于它的加法性质，它将有利于更大的数字（即，小数字极不可能出现在结果中）。但是，这些数字看起来是随机的，并且它们会适当地相加。

如果您的目标数量很小（比如说 100 以下），您实际上可以实现真正的随机方法，即生成所有分区并随机选择一个。例如，这是一个分区算法（由[http://homepages.ed.ac.uk/jkellehe/partitions.php](http://homepages.ed.ac.uk/jkellehe/partitions.php)提供，翻译成 C#）：

```
public List<int[]> GetPartitions( int n ) {
var result = new List<int[]>();
var a = new int[n+1];
var k = 1;
a[0] = 0;
var y = n - 1;
while( k != 0 ) {
    var x = a[k-1] + 1;
    k--;
    while( 2*x <= y ) {
        a[k] = x;
        y -= x;
        k++;
    }
    var l = k + 1;
    while( x <= y ) {
        a[k] = x;
        a[l] = y;
        result.Add( a.Take( k + 2 ).ToArray() );
        x++;
        y--;
    }
    a[k] = x + y;
    y = x + y - 1;
    result.Add( a.Take( k + 1 ).ToArray() );
}
return result;
} 
```

（为了帮助您进行 Java 翻译，`a.Take(x)`意味着将第一个`x`元素从数组中取出`a`......我相信这些天在 Java 中有一些等效的魔法可以做到这一点。）

这将返回一个分区列表......只需随机选择一个，您将获得完美的随机分布。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-05T08:27:32.623

-这个怎么样？

```
private long[] getRandoms(int size , long sum) {
    long[] array = new long[size];
    long singleCell = sum / size;
    Arrays.fill(array, singleCell);
    array[size-1] += sum % singleCell;
    int numberOfCicles = randomInRange(size, size*10);
    for (int i = 0; i < numberOfCicles; i++) {
        int randomIndex = randomInRange(0, size);
        long randomNumToChange = randomInRange(0, array[randomIndex]);
        array[randomIndex] -= randomNumToChange;
        array[randomInRange(0, size)] += randomNumToChange;
    }
    return array;
} 
```

# iphone - 自动调整 UIScrollView 高度

> ID：10021799
> 
> 赞同：0
> 
> 时间：2012-04-05T02:12:32.993
> 
> 标签：iphone, objective-c, xcode, ipad, uiscrollview

我将如何动态调整 a 的高度`UIScrollView`？基本上我`UILabels`创建了一堆（UILabels 的确切数量是随机的），并且`UIScrollView`是自动调整其高度以适应`UILables`. 这是我迄今为止在`viewDidLoad`.

```
- (void)viewDidLoad
{
[scroller setScrollEnabled:YES];
[scroller setContentSize:CGSizeMake(320
                                    , 1500)];
scroller.indicatorStyle = UIScrollViewIndicatorStyleWhite;
{ 
```

这是创建额外 UILavels 的操作

```
-(IBAction)scheduale{
int i;
for(i=0; i<[self retrieveTime] ; i++){
    //Add time label
    UILabel *timeLabel = [[UILabel alloc] init];
    timeLabel.frame = CGRectMake(10, (i+1) * 21, 31, 20);
    timeLabel.textColor = [UIColor whiteColor];
    timeLabel.backgroundColor = [UIColor colorWithRed:76.0/225.0 green:76.0/225.0 blue:76.0/225.0 alpha:1.0];
    NSString *labelString;
    labelString = [[NSNumber numberWithInt:i] stringValue];
    timeLabel.text = labelString;
    timeLabel.textAlignment = UITextAlignmentCenter;
    //theLabel.tag = (i+1) * 100;
    [scroller addSubview:timeLabel];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:26:04.057

您需要保留一个变量来跟踪您添加的标签数量及其高度，以便在您完成创建标签时设置内容大小。请参阅下面的调整代码：

```
-(IBAction)scheduale{

 int i; 
 int contentSize = 0;

 for(i=0; i<[self retrieveTime] ; i++){

     UILabel *timeLabel = [[UILabel alloc] init];
     timeLabel.frame = CGRectMake(10, (i+1) * 21, 31, 20);
     contentSize += 20;
     timeLabel.textColor = [UIColor whiteColor];
     timeLabel.backgroundColor = [UIColor colorWithRed:76.0/225.0 green:76.0/225.0 blue:76.0/225.0 alpha:1.0];
     NSString *labelString;
     labelString = [[NSNumber numberWithInt:i] stringValue];
     timeLabel.text = labelString;
     timeLabel.textAlignment = UITextAlignmentCenter;
     //theLabel.tag = (i+1) * 100;
     [scroller addSubview:timeLabel]; }

 [scroller setContentSize:CGSizeMake(320, contentSize)]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T03:02:03.447

我同意@Kyle，但内容大小将随着标签的位置而增加，以最后一个位置+最后一个高度结束。所以他的想法需要稍微调整一下。

另外，只是为了确认：@world Peace - 你想改变滚动条的框架，还是只是它的内容大小？@Kyle 是正确的，您*至少*必须更改内容大小。

这是对该代码的一些清理：

```
#define kButtonWidth   31.0
#define kButtonHeight  20.0
#define kMargin         1.0

-(IBAction)scheduale {

    int i;
    CGFloat contentPositionY = 0.0;

    UIColor *labelColor = [UIColor colorWithRed:76.0/225.0 green:76.0/225.0 blue:76.0/225.0 alpha:1.0];

    for(i=0; i<[self retrieveTime] ; i++){
        //Add time label
        UILabel *timeLabel = [[UILabel alloc] init];

        timeLabel.frame = CGRectMake(0, contentPositionY, kButtonWidth, kButtonHeight);
        contentPositionY += kButtonHeight + kMargin;

        timeLabel.textColor = [UIColor whiteColor];
        timeLabel.backgroundColor = labelColor;

        timeLabel.text = [NSString stringWithFormat:@"@d", i];

        timeLabel.textAlignment = UITextAlignmentCenter;
        //theLabel.tag = (i+1) * 100;
        [scroller addSubview:timeLabel];
    }

    // now size the content
    scroller.contentSize = CGSizeMake(kButtonWidth, contentPositionY + kButtonHeight);

    // and to get the margins you built into the loop calculation
    scroller.contentInset = UIEdgeInsetsMake(21, 10, 0, 0);   // your code implied these values
} 
```

# php - 保护贝宝付款信息变量？

> ID：10021808
> 
> 赞同：1
> 
> 时间：2012-04-05T02:14:18.040
> 
> 标签：php, paypal, paypal-ipn, paypal-sandbox

我有一个网络表单，可以将用户付款的所有贝宝变量发布到贝宝：

```
<input type="hidden" name="item_name" value="Digital Download" />
<input type="hidden" name="amount" value="9.99" />
<input type="hidden" name="on0" value="Payment For" />
<input type="hidden" name="os0" value="My Product Description" /> 
```

还有很多。但是，用户可以很容易地修改这些变量，并且发送到贝宝的数据是错误的。

我知道我仍然可以检查 IPN 响应以了解付款是否匹配，但我还希望能够保护用户免于篡改这些变量。

据我所知，paypal 在他们的网站上有一个“创建立即购买按钮”表单，它做同样的事情，但生成一个加密的表单数据，然后在 paypal 解密。

我是否有可能以某种方式在我发送到 paypal 的数据中使用这种加密和解密？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:57:05.503

您可以使用 php 自己对按钮进行加密，虽然这需要一些工作，但它确实可以完成这项工作。

[https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_html_encryptedwebpayments#id08A3I0P017Q](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_html_encryptedwebpayments#id08A3I0P017Q)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:09:05.237

您可以查看他们的[文档](https://www.google.es/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CCYQFjAA&url=https://cms.paypal.com/cms_content/JP/ja_JP/files/developer/PP_WPSButtonMgrAPINVP.pdf&ei=MSh9T-PPBced0AXWxvXRDQ&usg=AFQjCNEeUhtclNLplh4Smm_NoOiRBxM2vA)以使用他们的 NVP API（名称值对）生成安全按钮。

虽然生成加密按钮仍然有效，但它需要更多的工作，这种方法更简单并且还提供安全性。

# javascript - 将一个函数的所有参数传递给另一个函数？(javascript)

> ID：10021819
> 
> 赞同：3
> 
> 时间：2012-04-05T02:16:50.327
> 
> 标签：javascript

如何将一个函数的所有参数传递给另一个函数

```
function a(){
    arguments.length;// this is 1
    // how do I pass any parameter function a receives into another function
    b(what to put here?); // say pass all parameters function a receives to function b
}
a('asdf'); // this is okay 
```

因此，如果函数 a 接收 X 个参数，则每个参数都以相同的顺序传递给函数 b。所以如果 a("1", "2"); , b("1", "2");, 如果 a("1", 2, [3]); , b("1", 2, [3]);.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T02:19:30.030

使用，像这样：`Function.prototype.[apply(thisArg[, argsArray])](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)`

```
b.apply(this, arguments); 
```

现在，[`arguments`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)是一个类似数组的对象，[`callee`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments/callee)除了它的 n-index 属性之外，它还有一些其他属性（如 ）。因此，您可能应该使用将对象转换为简单的参数数组（尽管两者都可以在现代环境中使用）。`Array.prototype.[slice()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/slice)`

```
b.apply(this, Array.prototype.slice.call(arguments)); 
```

[也可以看看：`Function.prototype.[call()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call)`]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T02:25:33.247

为什么不将它们作为单个对象传递？使用单个对象作为参数的优点是

*   订单不是必需的。不像参数，你必须知道它是接收集合中的第一个、第二个还是第三个，在对象中，它们就在那里。需要时给他们打电话。
*   你永远不用担心通过了多少。你可以发送一个包含很多属性的对象——你只在调用者和被调用者之间传递一个参数

当然，你必须在使用前测试它们是否存在

```
function foo(data){
    data.param1; //is foo
    data.param2; //is bar
    data.param3; //is baz

    //send params to bar
    bar(data);
}

function bar(info){
    info.param1; //is foo
    info.param2; //is bar
    info.param3; //is baz
}

//call function foo and pass object with parameters
foo({
    param1 : 'foo',
    param2 : 'bar',
    param3 : 'baz'
}) 
```

# mysql - MySQL排序：为什么“11x”之后是“5x”？

> ID：10021822
> 
> 赞同：0
> 
> 时间：2012-04-05T02:17:21.257
> 
> 标签：mysql, sql, sql-order-by

我在 MYSQL 中有一个表，其中有一个名为 League 的列。

当我尝试使用此查询对值进行排序时，我无法正确排序。

```
SELECT DISTINCT (
t.league
)
FROM teams t
GROUP BY t.league
ORDER BY t.league ASC 
```

然而，我得到：

```
11a12
13
14
15
16a17
5a7
8a10 
```

除了最后两个之外，看起来它对所有这些都进行了正确排序

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T02:20:00.433

不，它们是按字典顺序而不是按数字排序的：

```
11a12
13
14
15
16a17
5a7        # 5 is greater than 1
8a10 
```

如果要按数字对它们进行排序，可以使用以下内容：

```
order by (t.league + 0)
order by cast (t.league, int) 
```

但我不确定他们将如何处理该领域的非数字。您可能想研究使用[该`lpad`功能](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_lpad)：

```
order by lpad (t.league, 20, '0') 
```

`0`这将通过在字段前面加上字符来将字段填充到特定大小。

请记住，每行函数很少能很好地扩展，因此，如果您想在表变大时保持性能，您可能需要执行一些操作，例如将列拆分为组件，使数字的非文本。根据您的具体情况，这可能有效，也可能无效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T02:19:38.633

是的，该列必须是字符串类型并且`5`出现在 AFTER 之后`11`。`a`您可能会考虑将这些字段（似乎是多值的）更改为 2 个单独的数字字段（如果该值有任何区别，甚至可以更改为 3个）

# jquery - 使用 jQuery 和 Json 显示图像

> ID：10021838
> 
> 赞同：-2
> 
> 时间：2012-04-05T02:20:22.360
> 
> 标签：jquery, json

我有一个包含图像的 HTML 源的数据库。使用 jQuery 和 Json；我想显示图像。这是我为它写的片段，

```
$(document).ready(function() {
        $("#domainID").click(function() {
            var domain_id = $(this).val();
            $("#picture").html('');
            $.getJSON('/index.php/admin/show_picture/' + domain_id, function(data) {
                img = "<img src=\"https://url/" + data.htmlImageFull + "\" />";
                var items = [];
                $.each(data, function(key, val) {
                    $("#picture").append(data[key].htmlImageFull);
                });
            });
        });
    }); 
```

主要的是我将使用与其关联的图像的 ID 检索 html 源。我必须在这里做任何改变吗？我还使用 MySQL 来检查与图像关联的 id。

这是HTML，

```
<form method="post" action="/index.php/add">
    <p>
        <select name="id" id="id" size="15">
            <option>Select a Domain</option>
            <? foreach ($unmatchedDomains as $row) {
            ?>
            <option value="<?=$row->id?>"><?=$row->domain
                ?></option>
            <? }?>
        </select>
        </td>
        <select name="id" id="id">
            <option style="alignment-adjust: &#x2190;">Select Something</option>
            <? foreach ($some as $row) {
            ?>
            <option value="<?=$row->id?>"><?=$row->name
                ?></option>
            <? }?>
        </select>
        <input type="submit" value="Something" />
        <div id="email_content"></div>
        <div id="picture"></div>
    </p>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>
    </table>
</form> 
```

使用提供的代码进行测试显示没有图片/图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:33:05.283

您需要将 img 标签附加到图片元素。

```
$.each(data, function(key, val) {
    $("#picture").append("<img src=\"https://url/" + data[key].htmlImageFull + "\" />");
}); 
```

# asp.net - Silverlight 客户端未连接到服务器

> ID：10021843
> 
> 赞同：2
> 
> 时间：2012-04-05T02:21:35.090
> 
> 标签：asp.net, silverlight, deployment, wcf-ria-services

我刚刚部署了一个 Silverlight 应用程序。

这是一个经过身份验证的应用程序（即只有登录用户可以访问它，否则导航到登录屏幕），我启动应用程序，我可以看到 Silverlight 界面加载并转发到登录屏幕，但即使我输入了 un/pwd存在于服务器中，它不让我进入。

我尝试从 (RIA) 抛出异常`AuthenticationService.GetUser`，但在客户端上没有看到任何异常迹象。

你能想到我在部署时错过的东西吗？

在我的开发环境中，它运行良好，只是无法在服务器上运行。

**更新**

请注意，我导航到[http://localhost/project-authenticationservice.svc](http://localhost/project-authenticationservice.svc)，并且在我的浏览器中呈现了一个类似的页面：

![在此处输入图像描述](../Images/aeb25529a4128eafc1b6bad13d639ef0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:24:46.667

这确实可能是由多种原因引起的。确保您的服务端点已正确更新以反映服务器环境。此外，在使用 RIA 服务部署 Silverlight 应用程序时，这里有一些有用的故障排除提示。

看看[这篇](http://todormihailov.com/2010/12/03/silverilght-with-net-4-0-wcf-ria-services-and-iis-error-notfound-%E2%80%93-a-deploy-nightmare "Silverilght 与 .Net 4.0、WCF RIA 服务和 IIS 错误 NotFound – 部署的噩梦")博文。

这是一个视频，详细介绍了部署 WCF RIA 服务时的一些更多部署和调试技巧：http: [//channel9.msdn.com/Shows/SilverlightTV/Silverlight-TV-51-Debugging-and-Deploying-WCF-RIA-Services](http://channel9.msdn.com/Shows/SilverlightTV/Silverlight-TV-51-Debugging-and-Deploying-WCF-RIA-Services)

谷歌浏览器有一套很好的开发工具，可以让你监控 http 网络流量，这也可以帮助你。

# python - 解释会话活动

> ID：10021846
> 
> 赞同：0
> 
> 时间：2012-04-05T02:21:44.147
> 
> 标签：python, django

我在看我的桌子，`django_session`想知道这本质上意味着什么。

如果我在过去一小时内有 100 个会话条目，这是否意味着过去一小时内有 100 人登录？还是有别的意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:14:36.463

如果您将一些数据放入其中，则会自动在会话中间件`request.session`中创建一条记录。因此，如果您在会话中没有放置任何内容，并且它只存储登录数据 - 那么它将是登录次数（也由同一用户 - 登录清除会话数据，因此如果有人登录，它将被重新创建）`django_session``process_response`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T13:57:50.833

这意味着有 100 次唯一访问，在此期间 request.session 被修改。唯一访问基于每个用户的浏览器：使用 Firefox 和 Chrome 访问您的站点**并**在此过程中修改 request.session 的用户将被识别为两个或多个访问。通常，对 request.session 没有修改，因此不会生成会话条目。默认登录页面在 request.session 中设置了 test 标志，因此无论是否登录成功，都会为访问者生成会话条目。此外，如果访问者拒绝 cookie，他对登录页面的每次访问都会生成一个会话条目。

# javascript - 多维javascript数组中的for循环

> ID：10021847
> 
> 赞同：46
> 
> 时间：2012-04-05T02:22:11.003
> 
> 标签：javascript, loops, multidimensional-array

从现在开始，我使用这个循环来迭代数组的元素，即使我将具有各种属性的对象放入其中，它也能正常工作。

```
var cubes[];

for (i in cubes){
     cubes[i].dimension
     cubes[i].position_x
     ecc..
} 
```

现在，让我们假设 cubes[] 是这样声明的

```
var cubes[][]; 
```

我可以在 JavaScript 中执行此操作吗？然后我怎样才能自动迭代

```
cubes[0][0]
cubes[0][1]
cubes[0][2]
cubes[1][0]
cubes[1][1]
cubes[1][2]
cubes[2][0]
ecc... 
```

作为一种解决方法，我可以声明：

```
var cubes[];
var cubes1[]; 
```

并分别使用这两个数组。这是一个更好的解决方案吗？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-04-05T02:29:25.560

你可以这样做：

```
var cubes = [
 [1, 2, 3],
 [4, 5, 6],    
 [7, 8, 9],
];

for(var i = 0; i < cubes.length; i++) {
    var cube = cubes[i];
    for(var j = 0; j < cube.length; j++) {
        display("cube[" + i + "][" + j + "] = " + cube[j]);
    }
} 
```

工作的jsFiddle：

*   [http://jsfiddle.net/TRR4n/](http://jsfiddle.net/TRR4n/)

上面的输出：

```
cube[0][0] = 1
cube[0][1] = 2
cube[0][2] = 3
cube[1][0] = 4
cube[1][1] = 5
cube[1][2] = 6
cube[2][0] = 7
cube[2][1] = 8
cube[2][2] = 9 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-04-05T02:25:40.110

```
var cubes = [["string", "string"], ["string", "string"]];

for(var i = 0; i < cubes.length; i++) {
    for(var j = 0; j < cubes[i].length; j++) {
        console.log(cubes[i][j]);
    }
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2018-10-28T19:46:49.797

有点太晚了，但是这个解决方案很好很整洁

```
const arr = [[1,2,3],[4,5,6],[7,8,9,10]]
for (let i of arr) {
  for (let j of i) {
    console.log(j) //Should log numbers from 1 to 10
  }
} 
```

或者在你的情况下：

```
const arr = [[1,2,3],[4,5,6],[7,8,9]]
for (let [d1, d2, d3] of arr) {
  console.log(`${d1}, ${d2}, ${d3}`) //Should return numbers from 1 to 9
} 
```

**注意：** `for ... of`循环在 ES6 中是标准化的，所以只有在你有 ES5 Javascript 编译器（例如 Babel）时才使用它

**另一个注意事项：**有替代品，但它们有一些细微的差异和行为，例如`forEach()`,`for...in`和`for...of`传统`for()`的 。这取决于您的情况来决定使用哪一个。（ES6 也有`.map()`, `.filter()`, `.find()`, `.reduce()`）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-11-30T14:26:26.757

循环遍历数组的一种有效方法是[内置数组方法 .map()](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Array/map)

对于一维数组，它看起来像这样：

```
function HandleOneElement( Cuby ) {
   Cuby.dimension
   Cuby.position_x
   ...
}
cubes.map(HandleOneElement) ; // the map function will pass each element 
```

对于二维数组：

```
cubes.map( function( cubeRow ) { cubeRow.map( HandleOneElement ) } ) 
```

对于任何形式的 n 维数组：

```
Function.prototype.ArrayFunction = function(param) {
  if (param instanceof Array) {
    return param.map( Function.prototype.ArrayFunction, this ) ;
  }
  else return (this)(param) ;
}
HandleOneElement.ArrayFunction(cubes) ; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-04-05T02:25:40.987

试试这个：

```
var i, j;

for (i = 0; i < cubes.length; i++) {
    for (j = 0; j < cubes[i].length; j++) {
       do whatever with cubes[i][j];
    }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-05-30T08:41:08.017

或者您也可以使用“forEach()”来执行此操作：

```
var cubes = [
 [1, 2, 3],
 [4, 5, 6],    
 [7, 8, 9],
];

cubes.forEach(function each(item) {
  if (Array.isArray(item)) {
    // If is array, continue repeat loop
    item.forEach(each);
  } else {
    console.log(item);
  }
}); 
```

如果您需要数组的索引，请尝试以下代码：

```
var i = 0; j = 0;

cubes.forEach(function each(item) {
  if (Array.isArray(item)) {
    // If is array, continue repeat loop
    item.forEach(each);
    i++;
    j = 0;
  } else {
    console.log("[" + i + "][" + j + "] = " + item);
    j++;
  }
}); 
```

结果将如下所示：

```
[0][0] = 1
[0][1] = 2
[0][2] = 3
[1][0] = 4
[1][1] = 5
[1][2] = 6
[2][0] = 7
[2][1] = 8
[2][2] = 9 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-02-25T00:41:41.170

如果你使用 ES2015 并且你想定义你自己的像二维数组一样迭代的对象，你可以通过以下方式实现[迭代器协议](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols)：

1.  定义一个调用的*@@iterator*`Symbol.iterator`函数，它返回...
2.  ...一个具有`next()`返回函数的对象...
3.  ...一个具有一个或两个属性的对象：一个`value`具有下一个值（如果有的话）的可选值和一个布尔值`done`，如果我们完成迭代，则为真。

一*维*数组迭代器函数如下所示：

```
// our custom Cubes object which implements the iterable protocol
function Cubes() {
    this.cubes = [1, 2, 3, 4];
    this.numVals = this.cubes.length;

    // assign a function to the property Symbol.iterator
    // which is a special property that the spread operator
    // and for..of construct both search for
    this[Symbol.iterator] = function () { // can't take args

        var index = -1; // keep an internal count of our index
        var self = this; // access vars/methods in object scope

        // the @@iterator method must return an object
        // with a "next()" property, which will be called
        // implicitly to get the next value
        return {
            // next() must return an object with a "done" 
            // (and optionally also a "value") property
            next: function() {
                index++;
                // if there's still some values, return next one
                if (index < self.numVals) {
                    return {
                        value: self.cubes[index],
                        done: false
                    };
                }
                // else there's no more values left, so we're done
                // IF YOU FORGET THIS YOU WILL LOOP FOREVER!
                return {done: true}
            }
        };
    };
} 
```

现在，我们可以将我们的`Cubes`对象视为可迭代对象：

```
var cube = new Cubes(); // construct our cube object

// both call Symbol.iterator function implicitly:
console.log([...cube]); // spread operator
for (var value of cube) { // for..of construct
    console.log(value);
} 
```

要创建我们自己的*2-D*`next()`可迭代对象，我们可以返回另一个可迭代对象，而不是在函数中返回值：

```
function Cubes() {
    this.cubes = [
        [1, 2, 3, 4],
        [5, 6, 7, 8],
        [9, 10, 11, 12],
    ];
    this.numRows = this.cubes.length;
    this.numCols = this.cubes[0].length; // assumes all rows have same length

    this[Symbol.iterator] = function () {
        var row = -1;
        var self = this;

        // create a closure that returns an iterator
        // on the captured row index
        function createColIterator(currentRow) {
            var col = -1;
            var colIterator = {}
            // column iterator implements iterable protocol
            colIterator[Symbol.iterator] = function() {
                return {next: function() {
                    col++;
                    if (col < self.numCols) {
                        // return raw value
                        return {
                            value: self.cubes[currentRow][col],
                            done: false
                        };
                    }
                    return {done: true};
                }};
            }
            return colIterator;
        }

        return {next: function() {
            row++;
            if (row < self.numRows) {
                // instead of a value, return another iterator
                return {
                    value: createColIterator(row),
                    done: false
                };
            }
            return {done: true}
        }};
    };
} 
```

现在，我们可以使用嵌套迭代：

```
var cube = new Cubes();

// spread operator returns list of iterators, 
// each of which can be spread to get values
var rows = [...cube];
console.log([...rows[0]]);
console.log([...rows[1]]);
console.log([...rows[2]]);

// use map to apply spread operator to each iterable
console.log([...cube].map(function(iterator) { 
    return [...iterator];
}));

for (var row of cube) {
    for (var value of row) {
        console.log(value);
    }
} 
```

请注意，我们的自定义迭代不会在所有情况下都表现得像二维数组。例如，我们还没有实现一个`map()`函数。[这个答案](https://stackoverflow.com/a/28718967/6157047)显示了如何实现生成器映射函数（[请参阅此处](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators)了解迭代器和生成器之间的区别；此外，生成器是 ES2016 功能，而不是 ES2015，因此如果您使用 babel 进行编译，则需要[更改 babel 预设](https://stackoverflow.com/questions/33527653/babel-6-regeneratorruntime-is-not-defined-with-async-await/42495576#42495576)）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-05T02:25:00.113

JavaScript 没有这样的声明。这将是：

```
var cubes = ... 
```

不管

但你可以这样做：

```
for(var i = 0; i < cubes.length; i++)
{
  for(var j = 0; j < cubes[i].length; j++)
  {

  }
} 
```

请注意，JavaScript 允许使用锯齿状数组，例如：

```
[
  [1, 2, 3],
  [1, 2, 3, 4]
] 
```

因为数组可以包含任何类型的对象，包括任意长度的数组。

正如[MDC](https://developer.mozilla.org/en/JavaScript/Reference/Statements/for...in)所指出的：

> “for..in 不应用于迭代索引顺序很重要的数组”

如果您使用原始语法，则无法保证将按数字顺序访问元素。

# javascript - 如果选中/取消选中复选框，则启用/禁用提交按钮？

> ID：10021848
> 
> 赞同：14
> 
> 时间：2012-04-05T02:22:24.020
> 
> 标签：javascript, html, forms, validation

如何在我的 HTML 表单中启用提交按钮并在未选中复选框时禁用？

这段代码有什么问题？

```
EnableSubmit = function(val)
{
    var sbmt = document.getElementById("Accept");

    if (val.checked == true)
    {
        sbmt.disabled = false;
    }
    else
    {
        sbmt.disabled = true;
    }
} 
```

复选框

```
<td width="30%">Do you accept Terms of Service agreement?</td>
<td width="10px" style="min-width: 10px"></td>
<td width="70%">
    <input type="checkbox" name="TOS" value="Accept" onClick="EnableSubmit"> I agree to Terms of Service agreement.
</td> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-05T02:32:31.543

将您的 HTML 更改为：

```
<td width="30%">Do you accept Terms of Service agreement?</td>
<td width="10px" style="min-width: 10px"></td>
<td width="70%">
    <input type="checkbox" name="TOS" value="Accept" onClick="EnableSubmit(this)"> I agree to Terms of Service agreement.
</td> 
```

它不起作用的原因：你没有传递你的函数任何东西。实际上，因为您没有在函数名中使用括号，所以您根本没有调用该函数。`this`在 HTML 事件属性的上下文中传递它`onclick`意味着您正在传递对元素的 DOM 对象的引用，从而使您可以访问其`checked`属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T02:33:11.747

您需要包含以下参数：`onClick="EnableSubmit()"`

```
 <input type="checkbox" name="TOS" value="Accept" onClick="EnableSubmit()"> I agree to Terms of Service agreement. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-17T10:15:48.150

首先，如果条件检查切换是否切换到所需的一侧。条件可以根据需要改变。最后一个 jquery 是将切换按钮设置为灰色。

```
 if(!$('#togglehk').is(":checked"))
                    {
                        $('#togglehk').click();
                    }
  jQuery('#togglehk').attr("disabled", true);
  jQuery('#togglehk').prop("disabled",true);

  jQuery('#togglehk').next(".slider").css("backgroundcolor","#B3B3B3"); 
```

# php - 要求使用 php 和 vfp 提供更快、更安全的 Web 服务

> ID：10021849
> 
> 赞同：0
> 
> 时间：2012-04-05T02:22:43.590
> 
> 标签：php, web-services, oledb, visual-foxpro

我不确定这些是否是编程问题，但我敢肯定很多像我这样的新程序员一直在问同样的问题。

我创建了一个 web 服务来使用 php 将数据更新到一个 vfp 免费表。我使用 VfpOledb 连接 php 和表。许多客户端使用此 Web 服务将其数据更新到服务器中的多个表中。示例：用户 A 更新目录 X 中的表 t_sales，用户 B 更新目录 Y 中的表 t_sales，用户 C 更新目录 Z 中的表 t_sales。

问题是：

1.  哪个更好/更快，为什么：为不同的用户创建不同的 php 文件（webservice），或创建一个内部带有 switch case 部分的 php 文件以确定数据源位置？

2.  哪个更好/更安全，为什么：将数据源位置作为参数从用户发送，或将数据源位置存储在 php 文件中？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:31:37.417

通过数据源位置，我假设您指的是数据库服务器和表。假设数据库服务器和表是你的，并且你想限制用户可以访问哪些表，你应该在内部确定数据库信息。

Web 服务应该提供一个 API，可以像“/myservice/update?name=x&email=y&key=32453457830957834”一样访问，只有所需的信息位是：

*   用于插入/更新的数据
*   搜索/过滤参数
*   安全令牌或 API 密钥

这使得使用您的 Web 服务变得容易，并且只要您逃避输入，它就可以防止注入攻击。（如果您允许将表定义为参数，则无法对其进行转义，然后您和您的用户将任由用户摆布。）

至于性能，与数据库事务所需的时间相比，对于大多数应用程序来说，决定如何访问数据库的逻辑可以忽略不计。

# c++ - 求解整数约束优化问题

> ID：10021852
> 
> 赞同：2
> 
> 时间：2012-04-05T02:22:58.187
> 
> 标签：c++, optimization, equations, inequalities, diophantine

我对这些问题在数学和编程上都是新手。如果有人可以建议使用可以解决以下问题的 c++ 库，我将不胜感激。

给定常量：

`{x_1, ..., x_n}, {y_1, ..., y_n}, {z_1, ..., z_n}, C, & variables {q_1, ..., q_n}`

最大化：`sum(i = 1..n} q_i*x_i`

受制于：`C - sum(i = 1..n){ sum(j = 1..q_i) [y_i + (j-1)*z_i ] } >= 0 AND q_i >= 0`

所有常量都是大于零的整数。`q_i's`也是整数。

所以我试图解决`{q_1, ..., q_n}`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T04:20:11.680

听起来像是一个非常适合线性规划的优化问题。[GNU 线性编程工具包 (GLPK)](http://www.gnu.org/software/glpk/)是一个功能齐全的 C 库。

IBM 有一个很好的关于线性编程以及如何使用 GLPK 的[教程](http://www.ibm.com/developerworks/linux/library/l-glpk1/)。

# sql - 为下表编写 SELECT 查询时遇到问题

> ID：10021853
> 
> 赞同：0
> 
> 时间：2012-04-05T02:23:07.123
> 
> 标签：sql, ms-access

> **可能重复：**
> [将 SQL 查询写入下表中的 SELECT 项](https://stackoverflow.com/questions/10020369/writing-an-sql-query-to-select-item-from-the-following-table)

我正在尝试列出至少有两个不同零件的供应商的供应商名称（sname）和零件编号（pnum）。

这是我需要使用的两张表...

出货量表：http: [//i44.tinypic.com/1zdcc9j.jpg](http://i44.tinypic.com/1zdcc9j.jpg)

供应商表：http: [//i39.tinypic.com/o6w414.png](http://i39.tinypic.com/o6w414.png)

我尝试了什么：

这是不正确的，我尝试了一些类似的东西......

```
SELECT snum 
FROM (SELECT snum, count(snum) AS nbr FROM Shipments ) 
WHERE nbr > 1; 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:34:58.110

I don't know about Access (as this question is tagged as such), but this should work in MySQL:

```
select su.sname from suppliers su
join shipments sh on su.snum = sh.snum
group by su.sname
having count(distinct su.pnum) >= 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:30:59.037

```
SELECT suppliers.sname, shipments.pnum
FROM suppliers, shipments
WHERE shipments.snum = suppliers.snum
GROUP BY suppliers.sname
HAVING count(shipments.pnum) >= 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T02:31:23.047

使用 COUNT 等聚合函数时，您需要使用 GROUP BY 子句。当使用聚合和 GROUP BY 时，HAVING CLAUSE 充当您的 where 子句。

这将为您提供所有计数 > 1 的 snum

```
SELECT snum
FROM
(
    SELECT snum, count(snum) AS nbr
    FROM Shipiments
    GROUP BY snum
    HAVING COUNT(snum) > 1
) AS T 
```

这会将表连接回供应商表以获取供应商名称

```
SELECT DISTINCT Suppliers.sname
FROM
(
    SELECT snum, count(snum) AS nbr
    FROM Shipiments
    GROUP BY snum
    HAVING COUNT(snum) > 1
) AS T INNER JOIN Suppliers ON Suppliers.snum = T.snum 
```

# javascript - 如何为每个超链接检测某个 HREF

> ID：10021854
> 
> 赞同：1
> 
> 时间：2012-04-05T02:23:15.520
> 
> 标签：javascript, jquery

```
 $(document).ready(function(){
                $(".item_delete").easyconfirm({locale: {
                        title: 'Select Yes or No', 
                        text: 'Do you really want to delete this product?',
                        button: ['No','Yes']
                }});
                $(".item_delete").click(function(){
                    $(location).attr('href',$(this).attr("href"));
                });
            }); 
```

上面的代码是我想要运行的代码，但是它不适用于 MULTIPLE 链接，可能是因为代码无法确定选择哪个 HREF。

```
 <a href="<?php echo "index.php?module=account&del_product=".$row['product_code']; ?>" class="item_delete ui-icon ui-icon-trash"></a> 
```

如果链接有多个href，如下所示，jquery 如何检测我点击的特定链接？

```
 <a href="index.php?module=account&del_product=1"></a>
             <a href="index.php?module=account&del_product=2"></a>
             <a href="index.php?module=account&del_product=3"></a>
             <a href="index.php?module=account&del_product=4"></a>
             <a href="index.php?module=account&del_product=5"></a>
             <a href="index.php?module=account&del_product=6"></a> 
```

感谢您的合作...

顺便说一句，我使用这个用于 jQuery 的“Easy Confirm Dialog”插件 - [http://projectshadowlight.org/jquery-easy-confirm-dialog/](http://projectshadowlight.org/jquery-easy-confirm-dialog/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:28:08.117

使用$(this)可以得到当前点击的超链接的href

```
 $("a.item_delete").on("click", function(){
        console.log($(this).attr("href"));
    }); 
```

# python - Apache 等效的 runserver 视图

> ID：10021855
> 
> 赞同：-1
> 
> 时间：2012-04-05T02:23:26.500
> 
> 标签：python, apache

Django 提供了一个运行服务器，可以在 cli 中近乎实时地打印出请求。如何打印在 apache/wsgi 上运行的网站的所有请求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:26:05.150

您可以`tail -F`在 Web 服务器的日志上运行，或者您可以通过`httpd -X`.

# c# - IQueryable Lambda 表达式中的 Orderby

> ID：10021857
> 
> 赞同：1
> 
> 时间：2012-04-05T02:23:40.627
> 
> 标签：c#, linq, entity-framework, linq-to-sql, visual-studio-lightswitch

我在使用 EF lambda 表达式时遇到了问题。

```
partial void StatusCallBackRequired_PreprocessQuery(ref IQueryable<PatientsTelephoneFollowupDetail> query)
{
    var newList = PatientsTelephoneFollowupDetails.OrderBy(x => x.Id).ToList();
    query = query.Where(p => p.PatientsMasterItem.PatientsTelephoneFollowupDetail.OrderByDescending(c => c.Id).FirstOrDefault(c => c.Status == "7") != null);
 } 
```

错误是：

> “Microsoft.LightSwitch.IOrderedDataServiceQueryable”不包含“ToList”的定义，并且找不到接受“Microsoft.LightSwitch.IOrderedDataServiceQueryable”类型的第一个参数的扩展方法“ToList”（您是否缺少 using 指令或程序集引用?)

我已经包含了 system.linq 命名空间。

**编辑：（基于 D Stanley 代码的结果）**

示例数据可以在下面找到，我正在寻找检索突出显示的记录 ![在此处输入图像描述](../Images/d8b5536962fee580c547d54dac55a217.png)

但是当前的输出是

![在此处输入图像描述](../Images/0b95aa4dc7c4347452bdabeba466ca64.png)

将查询更改为 query.select 仅返回一条记录，但它是错误的记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:50:50.993

几件事要尝试：

投射到`IEnumerable<T>`：

```
var newList = ((IEnumerable<PatientsTelephoneFollowupDetail>)PatientsTelephoneFollowupDetails.OrderBy(x => x.Id)).ToList(); 
```

根据查询结果初始化列表：

```
var newList = new List<PatientsTelephoneFollowupDetail>(PatientsTelephoneFollowupDetails.OrderBy(x => x.Id))); 
```

**编辑** 看起来 LightSwitch 没有实现`IEnumerable<T>`。还有两件事要尝试：

假设它实现`IEnumerable`，使用`IEnumerable.Cast<T>()`：

```
var newList = new List<PatientsTelephoneFollowupDetail>(
    PatientsTelephoneFollowupDetails.OrderBy(x => x.Id)
        .Cast<PatientsTelephoneFollowupDetail>()
    ); 
```

蛮力：

```
var newList = new List<PatientsTelephoneFollowupDetail>();
foreach(var item in PatientsTelephoneFollowupDetails.OrderBy(x => x.Id))
    newList.Add(item); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T03:52:50.503

你需要找到这个类型的定义：`Microsoft.LightSwitch.IOrderedDataServiceQueryable`

找到后，确认：

它执行`IEnumerable<T>`吗？如果是这样，您的代码无法访问[`System.Linq.Enumerable`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx). 您说您正在使用 System.Linq，因此请确保您的项目正在引用`System.Core.dll`.

如果没有，它是否实施`IEnumerable`？如果是这样，您可以编写一个`foreach`循环并将每个项目添加到`List<T>`您制作的 a 中。

如果不是，请检查属性。通常有一些方法可以得到你可以写一个循环的东西。

# android - android - 使用 jackson/gson 从 json 解析字节 []

> ID：10021862
> 
> 赞同：1
> 
> 时间：2012-04-05T02:24:32.327
> 
> 标签：android, json, parsing

任何人都可以帮助我从 json 文件中解析一个字节 [] -

JSON 文件如下所示：

```
 {
    name:"test"
    myImage:[67,78,....]
    } 
```

我不想创建一个新的 JSONObject() 并解析，因为这个文件可以有多个图像并且系统内存不足。

我想使用 GSON/Jackson/JSONReader(android>3.1)，但它似乎主要有 getInt()、getString() 对象。

我如何将 byte[] 本身解析为一个对象，然后我可以将其转换为可绘制对象。

我真的很感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T14:07:32.357

你试过什么？在杰克逊，你可以使用 POJO，如：

```
class Stuff {
  public String name;
  public byte[] myImage;
}

Stuff stuff = new ObjectMapper().readValue(new File("stuff.json"), Stuff.class); 
```

这应该工作。

但是这种 JSON 序列化并不是典型的实现方式：将字节数组包含为 base64 编码数据更为常见。这就是杰克逊将它序列化的方式，如果你使用`ObjectMapper.writeValue(...)`. 原因是 base64 编码会更紧凑，比数字数组使用更少的内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T18:18:04.307

我是这样解决的

```
InputStream instream = entity.getContent();
            Gson gson = new Gson();
            Reader reader = new InputStreamReader(instream);
            JsonReader jsonReader = new JsonReader(jsonReader);
                jsonReader.beginArray();
                while (jsonReader.hasNext()) {
                    MyCustomObject cobj = gson.fromJson(jReader,
                            MyCustomObject.class);
                    byte[] image = cobj.Image;
                    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-13T22:11:00.277

JSON对象->`getString().getBytes();`

GSON/JsonReader->`getString().getBytes();`

# android - 消息：android.app.Activity.createDialog：（Activity#onCreateDialog 没有为 id xxxxx 创建对话框）

> ID：10021865
> 
> 赞同：0
> 
> 时间：2012-04-05T02:24:44.043
> 
> 标签：android, dialog

我在创建对话框时有时会报告此错误，我自己没有遇到过该错误，而且似乎每个用户都不会发生此错误，因为我正在通过对话框发送数据。我已经测试了 android 2.2。这是代码。

```
private static final int DIALOG_CONTEST_ENTRY = 939321;

showDialog(DIALOG_CONTEST_ENTRY);

protected Dialog onCreateDialog(int id) {

    switch (id) {
    case DIALOG_CONTEST_ENTRY: 
        final Dialog dialog = new Dialog(this);
        dialog.setContentView(R.layout.contest_entry_dialog);
        dialog.setTitle(getString(R.string.ContestEntryDialogTitle));
        dialog.setCanceledOnTouchOutside(true);
        TextView text = (TextView) dialog.findViewById(R.id.contest_text); 
        text.setText(getString(R.string.ContestEntryDialogText));
        Button sendButton = (Button) dialog.findViewById(R.id.ButtonSend);
        Button cancelButton = (Button) dialog.findViewById(R.id.ButtonCancel);
        final EditText name = (EditText) dialog.findViewById(R.id.editName);
        final EditText email = (EditText) dialog.findViewById(R.id.editEmail);
        final TextView score = (TextView) dialog.findViewById(R.id.textScore);

        final Prefs prefs = new Prefs(xxxActivity.this);

        name.setText(prefs.ReadString("Name"));
        email.setText(prefs.ReadString("Email"));
        score.setText("Score: " + scoreCurrent);

        sendButton.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                                            //Send form
                    dialog.dismiss();
                }
            }
        });
        cancelButton.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                dialog.dismiss();
            }
        });
        dialog.show();
        return dialog;
    default:
        break;
    }
    return super.onCreateDialog(id);
}

<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
   android:layout_width="match_parent"
  android:layout_height="match_parent" android:orientation="vertical" android:padding="10dp" android:background="#FFF">

<TextView
    android:id="@+id/contest_text"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/ContestEntryDialogText"
    android:textColor="#000" />

<EditText
    android:id="@+id/editName"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inputType="textPersonName" android:hint="Enter Name"/>

<EditText
    android:id="@+id/editEmail"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inputType="textEmailAddress" android:hint="Enter Email">

    <requestFocus />
</EditText>
<TextView
    android:id="@+id/textScore"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Score: " android:textSize="20dp"/>

<LinearLayout
    android:id="@+id/linearLayout1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <Button
        android:id="@+id/ButtonSend"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Send" />

    <Button
        android:id="@+id/ButtonCancel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Cancel" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:06:42.157

在遇到同样的问题（并且发现从 onPause 中调用 removeDialog 不能可靠地工作）之后，我开发了一个似乎可以正常工作的解决方法（尽管它被承认是一个 hack）。

从[antslava 发布的 grepcode 链接](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.1_r2/android/app/Activity.java)中可以看出，在方法 performRestoreInstanceState 中，onRestoreInstanceState 在 restoreManagedDialogs 之前被调用，并传递了同一个 Bundle savedInstanceState 实例。

```
final void performRestoreInstanceState(Bundle savedInstanceState) {
    onRestoreInstanceState(savedInstanceState);
    restoreManagedDialogs(savedInstanceState);
} 
```

因此，有机会修改从 onRestoreInstanceState 方法中传递给 restoreManagedDialogs 的 Bundle savedInstanceState。

为了防止任何和所有托管对话框被恢复，可以通过以下方式实现 onRestoreInstanceState：

```
// This same variable is defined as private in the Activity class. I need
// access to it, so I redefine it here.
private static final String SAVED_DIALOGS_TAG = "android:savedDialogs";

@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);
    final Bundle b = savedInstanceState.getBundle(SAVED_DIALOGS_TAG);
    if (null != b) {
        savedInstanceState.remove(SAVED_DIALOGS_TAG);
    }
} 
```

这会导致键“android:savedDialogs”引用的 Bundle 从 Bundle savedInstanceState 中删除，随后会导致在发现无法找到该键时立即返回对 restoreManagedDialogs 的调用：

```
private void restoreManagedDialogs(Bundle savedInstanceState) {
    final Bundle b = savedInstanceState.getBundle(SAVED_DIALOGS_TAG);
    if (b == null) {
        return;
    }
    ...
} 
```

这将导致在恢复 Activity 时不会调用 onCreateDialog，从而有效地“隐藏”任何对话框，从而防止发生必须从 onCreateDialog 返回 null 的情况。

这不是“一刀切”的解决方案，但考虑到我的要求，它似乎符合要求。通过查看多个平台版本（1.6、2.1、2.2、2.2.2 和 4.0.3）的 grepcode 中的代码，在这些现有实现的情况下，该解决方案似乎应该始终如一地工作。

# r - 是否可以只评估一些变量？

> ID：10021866
> 
> 赞同：-2
> 
> 时间：2012-04-05T02:24:44.900
> 
> 标签：r

是否可以只评估一些变量？

```
t<- function(a,b,c){a+b+c}
t(1,2,c) 
```

产生错误

> a + b + c 中的错误：二元运算符的非数字参数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:43:51.240

您可以设置一些默认值，这样您就不必输入所有参数。

```
fun <- function(a=0, b=0, c=0){return(a + b + c)}
fun(1, 2, 3)
#[1] 6
fun(4, 5)
#[1] 9
fun()
#[1] 0 
```

请注意，您可能不应该调用函数“t”，因为已经有一个相当重要的函数名为 t。

我猜您正在尝试处理一个稍微复杂的示例。否则，您可以只使用 sum 来完成此任务。

* * *

编辑：您似乎只想通过设置某些参数的值将多参数函数转换为单参数函数。你可以定义一个新的函数来做你想做的事。

```
newfun <- function(c){return(fun(1, 2, c))}
newfun(1)
#[1] 4
newfun(5)
#[1] 8 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:55:21.843

```
> t<- function(a,b,c){if(missing(c)) { function(c){a+b+c}} else{a+b+c} }
> t(1,2)(4)
[1] 7
> t(1,2)
function(c){a+b+c}
<environment: 0x159956028>
> t(1,2,3)
[1] 6 
```

# ruby - 如何定义从模块化 sinatra 应用程序的配置块中调用的方法？

> ID：10021869
> 
> 赞同：6
> 
> 时间：2012-04-05T02:25:14.183
> 
> 标签：ruby, sinatra

我有一个 Sinatra 应用程序，归结起来，基本上是这样的：

```
class MyApp < Sinatra::Base

  configure :production do
    myConfigVar = read_config_file()
  end

  configure :development do
    myConfigVar = read_config_file()
  end

  def read_config_file()
    # interpret a config file
  end

end 
```

不幸的是，这不起作用。我明白了`undefined method read_config_file for MyApp:Class (NoMethodError)`

中的逻辑`read_config_file`很重要，所以我不想在两者中重复。如何定义可以从我的两个配置块中调用的方法？还是我只是以完全错误的方式解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T02:55:10.887

似乎在`configure`读取文件时执行了该块。您只需将方法的定义移到配置块之前，并将其转换为类方法：

```
class MyApp < Sinatra::Base

  def self.read_config_file()
    # interpret a config file
  end

  configure :production do
    myConfigVar = self.read_config_file()
  end

  configure :development do
    myConfigVar = self.read_config_file()
  end

end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:36:48.570

您的配置块在评估类定义时运行。因此，上下文是类本身，而不是实例。所以，你需要一个类方法，而不是实例方法。

```
def self.read_config_file 
```

那应该行得通。虽然没有测试。;)

# java - Android 对话框未显示

> ID：10021876
> 
> 赞同：2
> 
> 时间：2012-04-05T02:26:00.650
> 
> 标签：java, android, android-layout, dialog

谁会想到要显示一个对话框会如此困难。在 C# 中，这很容易。我到处寻找帮助，每个提示似乎都给我带来了麻烦而不是好处。有人可以看看下面的代码并告诉我哪里可能出错了吗？

我想要的很简单。用户点击按钮。然后出现列表。然后用户单击列表中的一项，并出现对话框。listview 事件中 onItemClick 中的代码来自其他人。它显然适用于那个人。我一直点击，什么也没看到。我愿意接受有关如何修复它或新代码的建议。抱歉，日志没有错误消息。

请具体说明我将代码放在哪里，因为我是 Android 菜鸟。并提前感谢您！

```
public class SetPrediction extends Activity
{
    Button btnInsrt, btnFTeam, btnSTeam;
    ArrayList<NameValuePair> nameValuePairs;
    TextView txtGameTeams;
    Bundle recdData;
    String game;

    JSONArray jArray;
    String result;
    InputStream is;
    StringBuilder sb;

    ArrayList<String> fNames;
    ListView listView;

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.set_prediction);

        nameValuePairs = new ArrayList<NameValuePair>();
        txtGameTeams = (TextView) findViewById(R.id.txtGameTeams);

        recdData = getIntent().getExtras(); 
        game = recdData.getString("xxxx.xxxx.xxx");
        txtGameTeams.setText("xxxxxxx: " + game + " game.");

        btnInsrt = (Button) findViewById(R.id.btnInsert);
        btnFTeam = (Button) findViewById(R.id.btnFirstTeam);
        btnSTeam = (Button) findViewById(R.id.btnSecondTeam);

        btnFTeam.setText(removeSpaces(game.split("vs")[0]));
        btnSTeam.setText(removeSpaces(game.split("vs")[1]));

        btnSTeam.setOnClickListener(new View.OnClickListener() 
        {
            public void onClick(View v) 
            {
                String result = "";
                ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
                nameValuePairs.add(new BasicNameValuePair("players", removeSpaces(game.split("vs")[1])));

                fNames = new ArrayList<String>();
                listView = (ListView) findViewById(R.id.lstPlayerForPrediction);

                //http post
                try
                {
                    HttpClient httpclient = new DefaultHttpClient();
                    HttpPost httppost = new HttpPost("http://xxxxx/getTeamPlayers.php");
                    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                    HttpResponse response = httpclient.execute(httppost); 
                    HttpEntity entity = response.getEntity();
                    InputStream is = entity.getContent();

                    BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
                    StringBuilder sb = new StringBuilder();
                    String line = null;
                    while ((line = reader.readLine()) != null) 
                    {
                        sb.append(line + "\n");
                    }
                    is.close();

                    result=sb.toString();
                }
                catch(Exception e)
                {
                    Log.e("log_tag", "Error in http connection " + e.toString());
                }

                //parse json data
                try
                {
                    JSONArray jArray = new JSONArray(result);
                    for(int i=0;i<jArray.length();i++)
                        fNames.add(jArray.getJSONObject(i).getString("First_Name"));  

                }
                catch(JSONException e)
                {
                    Log.e("log_tag", "Error parsing data " + e.toString());
                }

                ArrayAdapter<String> adapter = new ArrayAdapter<String>(SetPrediction.this, android.R.layout.simple_list_item_1, fNames);
                listView.setAdapter(adapter);

                listView.setOnItemClickListener(new OnItemClickListener()
                {
                    public void onItemClick(AdapterView<?> arg0, View predictView, int item, long arg3) 
                    {
                        final CharSequence[] items = {"Online", "Away", "Do not distrub","Invisible","Offline"}; 
                        AlertDialog.Builder builder = new AlertDialog.Builder(SetPrediction.this); 

                        builder.setTitle("Change Status"); 
                        builder.setItems(items, new DialogInterface.OnClickListener() 
                        { 
                            public void onClick(DialogInterface dialog, int item) 
                            { 
                                Toast.makeText(getApplicationContext(), items[item], Toast.LENGTH_SHORT).show(); 
                            } 
                        });

                        AlertDialog alert = builder.create(); 
                        alert.show();
                    } 
                });
            }
        });
    }

    public String removeSpaces(String s) 
    {  
        StringTokenizer st = new StringTokenizer(s," ",false);
        String t="";
        while (st.hasMoreElements()) t += st.nextElement();
        return t;
    } 
```

问题出在`listView.setOnItemClickListener(new OnItemClickListener()`事件中。那个不起作用的部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T10:11:05.250

看看这个：

```
public void showAlertDialog(String title, String message, Context context)
{
    final AlertDialog alertDialog = new AlertDialog.Builder(context).create();

    alertDialog.setTitle(title);
    alertDialog.setMessage(message);
    alertDialog.setButton("OK", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {
            alertDialog.dismiss();
        }
    });

    alertDialog.show();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:52:27.360

尝试使用这些代码而不是您的代码只是一个小的改动:::

```
AlertDialog.Builder builder = new AlertDialog.Builder(SetPrediction.this).create();
builder.setTitle("Change Status"); 
builder.setItems(items, new DialogInterface.OnClickListener() { 
public void onClick(DialogInterface dialog, int item){ 
Toast.makeText(getApplicationContext(), items[item], Toast.LENGTH_SHORT).show(); 
} 
});
builder.show(); 
```

还导入以下 :::

导入 android.app.AlertDialog；导入 android.content.DialogInterface；

# python - 在 Python 中使随机模块线程安全

> ID：10021882
> 
> 赞同：7
> 
> 时间：2012-04-05T02:26:44.097
> 
> 标签：python, random, thread-safety

在给定相同随机种子的情况下，我有一个应用程序需要相同的结果。但我发现 random.randint 不是线程安全的。我试过互斥体，但这不起作用。这是我的实验代码（长而简单）：

```
import threading
import random

def child(n, a):
    g_mutex = threading.Lock()
    g_mutex.acquire()
    random.seed(n)
    for i in xrange(100):
        a.append(random.randint(0, 1000))
    g_mutex.release()

def main():
    a = []
    b = []
    c1 = threading.Thread(target = child, args = (10, a))
    c2 = threading.Thread(target = child, args = (20, b))
    c1.start()
    c2.start()
    c1.join()
    c2.join()

    c = []
    d = []
    c1 = threading.Thread(target = child, args = (10, c))
    c2 = threading.Thread(target = child, args = (20, d))
    c1.start()
    c1.join()
    c2.start()
    c2.join()

    print a == c, b == d

if __name__ == "__main__":
    main() 
```

我想编写代码来打印**true, true**，但它有机会给出**false, false**。我怎样才能使线程安全randint？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-05T02:30:28.127

`random.Random`您可以为每个线程创建单独的实例

```
>>> import random
>>> local_random = random.Random()
>>> local_random.seed(1234)
>>> local_random.randint(1,1000)
967 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-05T02:30:55.010

从[文档中`random`](http://docs.python.org/library/random.html)：

> 该模块提供的函数实际上是**random.Random**类的隐藏实例的绑定方法。您可以实例化您自己的 Random 实例以获取不共享状态的生成器。**这对于多线程程序特别有用，为每个线程创建不同的 Random 实例**，并使用 jumpahead() 方法使每个线程看到的生成序列可能不重叠。

文档没有确切说明这个类是什么，但它确实显示了`class random.SystemRandom([seed])`，并且`random.Random([seed])`似乎是一样的。

例子：

```
local_random = random.Random(n)
for i in xrange(100):
    a.append(local_random.randint(0, 1000)) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-05T02:35:55.630

其他人指出了以`random`线程安全方式使用的正确方法。但我觉得重要的是要指出您编写的代码对于任何东西都不是线程安全的。

```
def child(n, a):
    g_mutex = threading.Lock()
    g_mutex.acquire()
    random.seed(n)
    for i in xrange(100):
        a.append(random.randint(0, 1000))
    g_mutex.release() 
```

每个线程都独立运行此方法。这意味着每个线程都在创建自己的锁实例，获取它，执行工作，然后释放它。除非每个线程都试图获取相同的锁，否则无法确保非并行执行。`g_mutex`您需要在 run 方法的上下文之外分配一个值。

**编辑**：

我只想补充一点，简单地切换到全局锁并不能保证完全按照您所说的进行。锁将确保一次只有一个线程在生成数字，但它不保证哪个线程将首先启动。

# c++ - 在 Netbeans 中使用特征库

> ID：10021884
> 
> 赞同：2
> 
> 时间：2012-04-05T02:27:07.730
> 
> 标签：c++, netbeans, eigen

我在 C++ 中使用 Eigen 库。根据[Eigen 文档](http://eigen.tuxfamily.org/dox/GettingStarted.html)：

> 要使用 Eigen，您只需要下载并提取 Eigen 的源代码（请参阅 wiki 以获取下载说明）。事实上，Eigen 子目录中的头文件是使用 Eigen 编译程序所需的唯一文件。所有平台的头文件都相同。不需要使用 CMake 或安装任何东西。

所以在 Netbeans 中，我将 Eigen 的目录添加到“包含目录”中。然后我使用了一个如下的简单程序（在 Eigen 文档中提供）：

```
#include <iostream>
#include <Eigen/Dense>

using namespace std;
using namespace Eigen;

int main()
{
   Matrix3f A;
   Vector3f b;
   A << 1,2,3,  4,5,6,  7,8,10;
   b << 3, 3, 4;
   cout << "Here is the matrix A:\n" << A << endl;
   cout << "Here is the vector b:\n" << b << endl;
   Vector3f x = A.colPivHouseholderQr().solve(b);
   cout << "The solution is:\n" << x << endl;
} 
```

Netbeans 为 colPivHouseholderQr() 方法画了一条红色下划线！！此外，在可以在对象 A 上调用的方法下，我看不到 colPivHouseholderQr() 方法。

令人惊讶的是，尽管 colPivHouseholderQr() 有红色下划线，但一切正常，程序编译并正确运行！

我的配置有什么问题？

![在此处输入图像描述](../Images/979f2c7263a6c23235e7dbb9d9d61c22.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T13:16:16.060

问题在于`colPivHouseholderQr()`QR 模块中，但您只包括 Dense 模块。

尝试添加以下包括：

```
#include <Eigen/QR> 
```

见：[http : *//eigen.tuxfamily.org/api/group_QR_Module.html*](http://eigen.tuxfamily.org/api/group__QR__Module.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T05:51:59.103

这是[使用 Eigen 时 Netbeans 中报告的问题](https://netbeans.org/bugzilla/show_bug.cgi?id=216095)。

它无法解析许多对象标识符，包括模板化对象的成员函数，例如您的`colPivHouseholderQr()`函数。

我得出的最佳解决方案是改用[Eclipse](http://www.eclipse.org/downloads/)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-05T03:24:36.690

抱歉 - 这更像是一条评论，但我无法发表评论 - 但您是否尝试删除缓存？不了解 Windows，但在 Ubuntu 中，它通常位于 ~/.netbeans/7.0（或其他）/var/cache 下 - 只需删除缓存目录下的所有内容。有时这对我有用。

# php - 如何使用 PHP 更新/扩展 facebook 访问令牌？

> ID：10021892
> 
> 赞同：12
> 
> 时间：2012-04-05T02:28:15.133
> 
> 标签：php, facebook

Facebook 已删除 offline_access 令牌功能，现在令牌必须在用户访问您的网站时更新以保持其活跃。

假设某人已经授予了您的网站访问权限，并且您为他们存储了一个令牌。你会用什么代码和 Facebook 的 PHP 库来更新这个令牌？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-08T03:50:06.887

您可以通过以下方式扩展您的令牌：

原始场景

*   您的应用向用户请求权限
*   您提示用户登录/授予权限
*   您获得用户的令牌（短期令牌）并通过 CURL 或其他方式使用 grant_type=fb_exchange_token 交换 60 天
*   你持久化令牌

现在，您拥有该令牌，可以在 60 天内随心所欲地使用它。最多，因为用户可以更改密码，取消授权应用程序等，令牌将失效。扩展令牌可以做的是每次用户访问您的页面，您可以检查他们是否通过 javascript 登录，如果是，则对您的服务器进行 ajax 调用以将现有令牌延长 60 天今天。您可以拨打任意数量的电话，只有第一个有效。这是我的做法：

1.  在加载事件期间的某个页面上，添加如下内容：

    ```
     FB.getLoginStatus(function (response) {
         if (response.status === 'connected') {
            $.ajax({
                type: "POST",
                async: false,
                url: YOUR_URL,
                dataType: "text",
                data: {token  : response.authResponse.accessToken }
             });
         }
     });
             //rest of jquery ajax call here 
    ```

这将为用户获取一个新的客户端访问令牌并将其发送到服务器

1.  然后，服务器可以获取该令牌并将其交换为 60 天

    ```
    $token_url = "https://graph.facebook.com/oauth/access_token?client_id=".FACEBOOK_CLIENT_ID."&client_secret=".FACEBOOK_SECRET."&grant_type=fb_exchange_token&fb_exchange_token=".$token;

    $c = curl_init();
    curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($c, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($c, CURLOPT_URL, $token_url);
    $contents = curl_exec($c);
    $err  = curl_getinfo($c,CURLINFO_HTTP_CODE);
    curl_close($c);

    $paramsfb = null;
    parse_str($contents, $paramsfb); 
    ```

参考：

[https://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

如果用户在 60 天内回到您的网站，那只会延长令牌。如果没有，您将需要再次提示权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T07:28:51.243

**更新**

是的@zerkms 是对的，如果应用程序有权限，则不需要 access_token。

`With this permission, you can publish content to a user's feed at any time. However, please note that Facebook recommends a user-initiated sharing model. Please read the Platform Policies to ensure you understand how to properly use this permission. Note, you do not need to request the publish_stream permission in order to use the Feed Dialog, the Requests Dialog or the Send Dialog.`

所有扩展权限都有类似的权限：[https ://developers.facebook.com/docs/authentication/permissions/](https://developers.facebook.com/docs/authentication/permissions/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T00:32:47.403

这是我目前正在做的事情

```
public function setExtendAccessToken($accessToken = NULL) {

enter code here
    if(!$accessToken) return;

    $graphUrl = 'https://graph.facebook.com/oauth/access_token?client_id='.$facebookAppId.
                '&client_secret='.$facebookSecret.
                '&grant_type=fb_exchange_token&fb_exchange_token='.$accessToken;
    $accessToken = @file_get_contents($graphUrl);
    parse_str($accessToken); //get the access_token param in the string and would be named $access_token
    if(!$access_token) $access_token = $accessToken; //if cannot be extended then just return the access token with 2 hours expiry
    return $access_token;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-22T05:42:28.663

```
use Facebook\FacebookSession;
use Facebook\GraphSessionInfo;
use Facebook\FacebookRequest;
use Facebook\GraphUser;
use Facebook\FacebookRequestException;
use Facebook\FacebookRedirectLoginHelper;

    FacebookSession::setDefaultApplication('YOURAPPID', 'SECRET');

    $user_accessToken = $_COOKIE['access_token_facebook']

    $session = new FacebookSession($user_accessToken);

    try {
        $session->validate();
    } catch (FacebookRequestException $ex) {
        // When Facebook returns an error
        echo $ex->getMessage();
    } catch (\Exception $ex) {
        // When validation fails or other local issues
        echo $ex->getMessage();
    }
    if ($session) {
        // Exchange token for long token
        $longToken = $session->getExchangeToken();
        // ... your other stuff
    } 
```

参考： [https ://developers.facebook.com/docs/facebook-login/access-tokens#pagetokens](https://developers.facebook.com/docs/facebook-login/access-tokens#pagetokens) [https://developers.facebook.com/docs/facebook-login/access-tokens#extending](https://developers.facebook.com/docs/facebook-login/access-tokens#extending)

# apache - 有人可以告诉我为什么这个 apache 配置会导致 404s 吗？

> ID：10021893
> 
> 赞同：0
> 
> 时间：2012-04-05T02:28:16.893
> 
> 标签：apache, mod-rewrite, ssl, virtualhost

我已经更改了所有个人信息，但是这个完全相同的配置在 *:80 上运行良好。为重写和正常访问日志打开详细日志级别会创建一个包含 SSL 信息的文件，但没有实际的文档请求。难住了。

```
<VirtualHost *:443>
ServerName *.domain.com
DocumentRoot /domain/web/public
RewriteEngine On
RewriteCond %{HTTP_HOST} !^www.* [NC]
RewriteCond %{HTTP_HOST} ^([^\.]+)\.domain\.com
RewriteRule ^(.*) /file.php?parameter=%1 [L]
<Directory /domain/web/public>
Options -Indexes IncludesNOEXEC FollowSymLinks -MultiViews
AllowOverride All
Order allow,deny
Allow from all
</Directory>
SSLEngine on
SSLCertificateFile /domain/etc/domain.crt
SSLCertificateKeyFile /domain/etc/domain.key
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T17:36:49.833

其他虚拟主机文件正在干扰有问题的虚拟主机。不是最好的解决方案，但遵循 craniumonempty 的要求：我将所有其他主机文件注释掉，什么都不做，直到我有更多时间弄清楚为什么微调它们不起作用。

# php - 谷歌地图：用 mysql 查询更新标记不起作用

> ID：10021897
> 
> 赞同：0
> 
> 时间：2012-04-05T02:29:01.690
> 
> 标签：php, mysql, google-maps-api-3

我从 https://developers.google.com/maps/articles/phpsqlajax_v3 开始，[并](https://developers.google.com/maps/articles/phpsqlajax_v3)使用 [https://developers.google.com/maps/articles/phpsqlsearch_v3](https://developers.google.com/maps/articles/phpsqlsearch_v3)尝试动态过滤来自 mysql 数据库的内容并更新我的基于返回结果的标记。我的 php 返回一个有效的 xml 文件，所以不用担心。我只是不确定我在清除和从新查询中创建新标记时做错了什么。load() 函数给了我一个不错的新地图，上面有标记，但表单似乎没有做任何事情。我什至尝试让表单按钮调用 clearLocations() 并且没有任何反应。屏幕有点闪烁，但所有点都留在那里。

```
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>Property Sales</title>
    <script src="http://maps.google.com/maps/api/js?sensor=false"
            type="text/javascript"></script>
    <script type="text/javascript">
    //<![CDATA[

var markersArr = [];
var map;
var infoWindow;

function updateMap(){
var maxbid = document.getElementById('maxbid').value;
var minbid = document.getElementById('minbid').value;
var salestatus = document.getElementById('salestatus').value;
var saledate = document.getElementById('saledate').value;

infoWindow = new google.maps.InfoWindow;

 var queryString = "phpsqlajax_genxml3dynamic.php?maxbid=" + maxbid + "&minbid=" + minbid + "&salestatus=" + salestatus + "&saledate=" + saledate;
//var queryString = "phpsqlajax_genxml3dynamic.php?maxbid=" + maxbid + "&minbid=" + minbid;
queryString="phpsqlajax_genxml3dynamic.php?maxbid=340000&minbid=0&salestatus=*&saledate=*";
downloadUrl( queryString, function(data) {
        var xml = data.responseXML;
         markers = xml.documentElement.getElementsByTagName("marker");
clearLocations();
        for (var i = 0; i < markers.length; i++) {
          var SaleDate = markers[i].getAttribute("SaleDate");
          var CaseNumber = markers[i].getAttribute("CaseNumber");
          var Address = markers[i].getAttribute("Address");
          var ZipCode = markers[i].getAttribute("ZipCode");
          var Plaintiff = markers[i].getAttribute("Plaintiff");
          var Defendant = markers[i].getAttribute("Defendant");
          var Attorney = markers[i].getAttribute("Attorney");
          var SoldTo = markers[i].getAttribute("SoldTo");
          var PID = markers[i].getAttribute("PID");
          var Appraisal = markers[i].getAttribute("Appraisal");
          var MinBid = markers[i].getAttribute("MinBid");
          var SaleAmt = markers[i].getAttribute("SaleAmt");
          var SaleStatus = markers[i].getAttribute("SaleStatus");

          var point = new google.maps.LatLng(
              parseFloat(markers[i].getAttribute("Latitude")),
              parseFloat(markers[i].getAttribute("Longitude"))
              );
   var info = "<b>Sale Date:" + SaleDate +"<br/>Address:"+ Address+"<br/>Sale Amount:" + SaleAmt + "</b> <br/>Sale Date:" + SaleDate+ "<br/>Case Number:"+ CaseNumber+ "<br/>Address:"+ Addre\
ss+ "<br/>Zipcode:"+ ZipCode+ "<br/>Plaintiff:"+ Plaintiff+ "<br/>Defendant:"+ Defendant+ "<br/>Attorney:"+ Attorney+ "<br/>Sold to:"+ SoldTo+ "<br/>Parcel ID:"+ PID+ "<br/>Appraisal:"+ Appraisal+\
 "<br/>Minimum bid:"+ MinBid+ "<br/>Sale amount:"+ SaleAmt+ "<br/> Sale status:"+ SaleStatus;

          var icon = customIcons[SaleStatus] || {};
          var marker = new google.maps.Marker({
            map: map,
            position: point,
            icon: icon.icon,
            shadow: icon.shadow
          });
          bindInfoWindow(marker, map, infoWindow, info);
markersArr.push(marker);
        }
      });

}

    var customIcons = {
      ACTIVE: {
        icon: 'http://labs.google.com/ridefinder/images/mm_20_green.png',
        shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
      },
      CANCELLED: {
        icon: 'http://labs.google.com/ridefinder/images/mm_20_black.png',
        shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
      },
      NOBIDNOSALE: {
        icon: 'http://labs.google.com/ridefinder/images/mm_20_blue.png',
        shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
   },
      SOLD: {
        icon: 'http://labs.google.com/ridefinder/images/mm_20_red.png',
        shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
      }
    };

function clearLocations() {
     infoWindow.close();
     for (var i = 0; i < markers.length; i++) {
       markersArr[i].setMap(null);
     }
     markersArr.length = 0;
}

    function load() {
       map = new google.maps.Map(document.getElementById("map"), {
        center: new google.maps.LatLng(39.7620028,-84.3542049),
        zoom: 10,
        mapTypeId: 'roadmap'
      });
      infoWindow = new google.maps.InfoWindow;

      // Change this depending on the name of your PHP file
//      downloadUrl("phpsqlajax_genxml3.php", function(data) {
downloadUrl( "phpsqlajax_genxml3dynamic.php?maxbid=54,000&minbid=0&salestatus=*&saledate=*", function(data) {
        var xml = data.responseXML;
        var markers = xml.documentElement.getElementsByTagName("marker");
        for (var i = 0; i < markers.length; i++) {
          var SaleDate = markers[i].getAttribute("SaleDate");
          var CaseNumber = markers[i].getAttribute("CaseNumber");
          var Address = markers[i].getAttribute("Address");
          var ZipCode = markers[i].getAttribute("ZipCode");
          var Plaintiff = markers[i].getAttribute("Plaintiff");
          var Defendant = markers[i].getAttribute("Defendant");
          var Attorney = markers[i].getAttribute("Attorney");
          var SoldTo = markers[i].getAttribute("SoldTo");
          var PID = markers[i].getAttribute("PID");
          var Appraisal = markers[i].getAttribute("Appraisal");
          var MinBid = markers[i].getAttribute("MinBid");
          var SaleAmt = markers[i].getAttribute("SaleAmt");
          var SaleStatus = markers[i].getAttribute("SaleStatus");

          var point = new google.maps.LatLng(
              parseFloat(markers[i].getAttribute("Latitude")),
              parseFloat(markers[i].getAttribute("Longitude")));

 var info = "<b>Sale Date:" + SaleDate +"<br/>Address:"+ Address+"<br/>Sale Amount:" + SaleAmt + "</b> <br/>Sale Date:" + SaleDate+ "<br/>Case Number:"+ CaseNumber+ "<br/>Address:"+ Addre\
ss+ "<br/>Zipcode:"+ ZipCode+ "<br/>Plaintiff:"+ Plaintiff+ "<br/>Defendant:"+ Defendant+ "<br/>Attorney:"+ Attorney+ "<br/>Sold to:"+ SoldTo+ "<br/>Parcel ID:"+ PID+ "<br/>Appraisal:"+ Appraisal+\
 "<br/>Minimum bid:"+ MinBid+ "<br/>Sale amount:"+ SaleAmt+ "<br/> Sale status:"+ SaleStatus;

          var icon = customIcons[SaleStatus] || {};

          var marker = new google.maps.Marker({
            map: map,
            position: point,
            icon: icon.icon,
            shadow: icon.shadow
          });
          bindInfoWindow(marker, map, infoWindow, info);
markersArr.push(marker);
        }
      });
    }

    function bindInfoWindow(marker, map, infoWindow, html) {
      google.maps.event.addListener(marker, 'click', function() {
        infoWindow.setContent(html);
        infoWindow.open(map, marker);
      });
    }

    function downloadUrl(url, callback) {
      var request = window.ActiveXObject ?
          new ActiveXObject('Microsoft.XMLHTTP') :
          new XMLHttpRequest;
  request.onreadystatechange = function() {
        if (request.readyState == 4) {
          request.onreadystatechange = doNothing;
          callback(request, request.status);
        }
      };

      request.open('GET', url, true);
      request.send(null);
    }

    function doNothing() {}

    //]]>
  </script>
  </head>

 <body onload="load()">
<form name='myForm'>
Min Bid $ :<input type='text' id='minbid' value='1,000' />  and
 $ :<input type='text' id='maxbid' value='1,000,000' />  <br>
Sale Status:<select id='salestatus'>
<option value="*" selected>All</option>
<option>Active</option>
<option>Sold</option>
<option>Cancelled</option>
<option>No Bid, No Sale</option>
</select>
<br>
Sale Date:<select id='saledate'>
<option value="*" selected>All</option>
<option>2012-06-08</option>
<option>2012-06-01</option>
<option>2012-05-25</option>
<option>2012-05-18</option>
<option>2012-05-11</option>
<option>2012-05-04</option>
<option>2012-04-27</option>
<option>2012-04-20</option>
<option>2012-04-13</option>
<option>2012-04-06</option>
<option>2012-03-30</option>
<option>2012-03-23</option>
<option>2012-03-16</option>
<option>2012-03-09</option>
<option>2012-03-02</option>
</select>
<input type='button' onclick='updateMap()' value='Update Map' />
</form>

    <div id="map" style="width: 95%; height: 85%"></div>
  </body>
</html> 
```

我再次 99.9% 确定 php 没有问题，因为它返回用于填充字段的有效结果。我对我在更新中做错了什么感到困惑。嘿，这不是垃圾邮件，让我发布这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:02:29.203

您的`clearLocations`函数正在循环，其中`markers`不`markersArr`包含现有的标记引用。

应该

```
function clearLocations() {
     infoWindow.close();
     for (var i = 0; i < markersArr.length; i++) {
       markersArr[i].setMap(null);
     }
     markersArr.length = 0;
} 
```

# python - 什么是生成方法？

> ID：10021899
> 
> 赞同：19
> 
> 时间：2012-04-05T02:29:11.543
> 
> 标签：python, sqlalchemy

我熟悉 Python 生成器，但是我刚刚遇到了我不熟悉的术语“生成方法”，也找不到令人满意的定义。

为了把它放在上下文中，我在 SQLAlchemy 的叙述文档中找到了这个术语：

> 使用 Connection、Engine、Executable 上提供的生成 Connection.execution_options() 方法可以完全控制“自动提交”行为，使用“自动提交”标志将打开或关闭所选范围的自动提交。

什么是生成方法？尝试迭代返回的对象`Connection.execution_options()`不起作用，所以我认为它不是标准生成器。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-07T10:13:52.623

它似乎不是一个常见的数据库概念，但 SQLAlchemy在“由您的程序在运行时迭代生成”的意义上使用术语*生成。*（所以，没有连接到 python 生成器）。教程中的一个例子[：](http://docs.sqlalchemy.org/en/latest/orm/tutorial.html#querying)

> 该`Query`对象是完全**生成的，**这意味着大多数方法调用都会返回一个新`Query`对象，可以在该对象上添加更多标准。例如，要查询全名为“Ed Jones”的名为“ed”的用户，您可以调用`filter()`两次，它使用 AND 连接条件：

```
>>> for user in session.query(User).\
...   filter(User.name=='ed').\
...   filter(User.fullname=='Ed Jones'):
...     print user 
```

这种调用语法通常被称为“方法链接”，并且允许它作为[“流利接口”](http://en.wikipedia.org/wiki/Fluent_interface)的设计。

因此，在 的情况下`Connection.execution_options()`，“生成”意味着它返回修改后的连接对象，以便您可以像上面那样链接调用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-08T10:48:40.883

查看 Connection.execution_options (lib/sqlalchemy/engine/base.py) 的源代码，该方法所做的只是向连接添加选项。

这个想法是这些选项会影响例如查询的未来行为。

举个例子：

```
 result = connection.execution_options(stream_results=True).\
                            execute(stmt) 
```

在这里，仅此查询的行为在连接中间发生了变化。在某种程度上，它“生成”或将自己克隆为具有略微不同行为的对象。

在这里，您还可以将自动提交设置为 True。例子

```
# obtain a connection
connection = ...
# do some stuff
# for the next section we want autocommit on
autocommitting_connection = connection.execution_options(autocommit=True)
autocommitting_connection.execute(some_insert)
result = autocommitting_connection.execute(some_query)
# done with this section. Continue using connection (no autocommit) 
```

这就是文档的该部分的含义。“生成方法”是指返回可以继续使用的同一实例的修改副本的方法。这适用于 Connection、Engine、Executable 类。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T02:44:26.647

您必须查阅该项目的特定文档或源代码才能真正确定，但我猜它会返回某个对象的修改版本，该版本适合参数定义的要求/行为。

该[文档](http://docs.sqlalchemy.org/en/latest/core/connections.html#sqlalchemy.engine.base.Connection.execution_options)指出：

> 该方法返回 this 的副本，该副本`Connection`引用相同的底层 DBAPI 连接，但还定义了给定的执行选项，这些选项将对`execute()`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-13T10:19:27.067

正如上面的@zzzeek 评论，这现在记录在 SQLAlchemy[词汇表](http://docs.sqlalchemy.org/en/latest/glossary.html "词汇表")中。

[生成的](http://docs.sqlalchemy.org/en/latest/glossary.html#term-generative "生成的")意思：

> SQLAlchemy 用来指代通常称为方法链接的术语；有关详细信息，请参阅该术语。

[方法链](http://docs.sqlalchemy.org/en/latest/glossary.html#term-method-chaining "方法链")是：

> 一种面向对象的技术，通过调用对象上的方法来构造对象的状态。该对象具有任意数量的方法，每个方法都返回一个新对象（或在某些情况下是同一个对象），并为该对象添加了额外的状态。

# php - 有没有比 VALUES($var1, $var2, $var3) 更好的方法向 MySQL 查询插入值？

> ID：10021905
> 
> 赞同：1
> 
> 时间：2012-04-05T02:29:56.450
> 
> 标签：php, mysql, sql

我只有 15 个值的数组，所有这些值都需要插入到表中。我只是想知道是否有这样的事情：

```
INSERT INTO table VALUES($myarrayofvalues) 
```

只是好奇，会非常有用。

更新：
只有一行 15 列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:36:17.277

```
$query = "INSERT INTO table VALUES('" . implode("', '", $myarrayofvalues) . "')"; 
```

**Edit**:

If you haven't done your escaping yet, you can do that in a tiny loop before the above statement, something like:

```
foreach($myarrayofvalues as $k=>$v)
    $myarrayofvalues[$k] = mysql_real_escape_string($v); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:41:31.820

虽然您可以执行**Rick**的答案中显示的操作，但它对 SQL 注入是开放的。

如果没有某种列映射，真的没有什么*好方法可以做到这一点。*也就是说元素 1 是字符串，元素 2 是整数。

因此，我看到两个选择：

1.  逃离一切

    ```
    $values = array();
    foreach ($myarrayofvalues as $value) {
      $column[] .= "'" . mysql_real_escape_string($value) . "'";
    }
    $sql = "INSERT INTO table VALUES(" . implode(',', $values) . ")"; 
    ```

2.  编写完整的 SQL 语句

    ```
    $sql = "INSERT INTO table (column1_string, column2_int, ...)
      VALUES ('" . mysql_real_escape_string($myarray[0]) . "', " . (int)$myarray[1] . ", ...) 
    ```

我更喜欢＃2，因为它更具可读性且不那么脆弱。目前，如果您的架构或数组发生更改，您的代码就会中断。

# c++ - 在 C++ 中引用 const 对象/指针

> ID：10021906
> 
> 赞同：1
> 
> 时间：2012-04-05T02:30:12.507
> 
> 标签：c++, pointers, reference, constants

对于 C++ 中引用的处理方式，我不太了解：

```
B objB = B();                   // Regular B object
const B &refConstObjB = objB;   // Reference to const B object

B* ptrB = new B();              // Regular pointer to B
B* const &refPtrConstB = ptrB;  // Reference to const pointer to B 
```

以上所有编译都很好。但是以下没有：

```
const B* &refConstPtrB = ptrB;  // Reference to pointer to const B 
```

考虑到对象和指针都被声明为非常量，为什么我可以将对象引用为 const 对象，但不能对指针做同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T02:36:06.073

请注意：`const`引用并不**意味着**对象`const`。
它只是意味着一个通过该引用**只读的对象。**因此，无论一个对象是否是`const`，您都可以拥有一个只读引用或指向它的指针。

现在，如果您提到的内容被允许，您可以说`refConstPtrB = pointer_to_some_const_B`，然后通过 改变该对象，这将违反指针目标的*-ness*。`ptrB``const`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:35:17.527

这个错误的原因是你可以用它在类型系统中放一个洞。考虑以下代码：

```
const B dontChangeMe;
B* ptrB = new B();

/* This step is NOT legal. */
const B* &refConstPtrB = ptrB;

/* Uh oh!  I now have ptrB pointing at dontChangeMe! */
refConstPtrB = &dontChangeMe; 
```

因此，您无法完成您标记的作业。

希望这可以帮助！

# android - 我可以向这个 Xml 添加一个 Scrollview 吗？

> ID：10021909
> 
> 赞同：-1
> 
> 时间：2012-04-05T02:30:20.640
> 
> 标签：android, xml, layout

一直试图弄清楚这一点..我是 Adroid 新手，并试图让整个屏幕滚动查看......它是一个标题图像和一个列表......希望它全部一起滚动。可以使用这种布局来完成吗？谢谢！

```
<?xml version="1.0" encoding="UTF-8"?>

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/containerView"
    android:background="@android:color/transparent"    
    android:padding="0dip"
    android:layout_margin="0dip"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content">

    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/headerImageContainer"
        android:background="@android:color/transparent"    
        android:padding="0dip"
        android:layout_margin="0dip"
        android:layout_centerHorizontal="true"
        android:layout_alignParentTop="true"
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content">

            <ImageView 
                  xmlns:android="http://schemas.android.com/apk/res/android"               
            android:id="@+id/headerImageView"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:scaleType="center"
            android:layout_centerHorizontal="true"
            android:layout_alignParentTop="true">
        </ImageView>

    </LinearLayout>

    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/listViewContainer"
        android:background="@android:color/transparent"    
        android:paddingLeft="35dip"
            android:paddingRight="35dip"
            android:paddingTop="10dip"
            android:paddingBottom="0dip"

        android:layout_margin="0dip"
        android:layout_weight="1"
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"
        android:layout_below="@+id/headerImageContainer">

        <ListView xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/listView"
            android:background="@android:color/transparent"    
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:cacheColorHint="#000000"

            android:choiceMode="singleChoice" 
            android:layout_weight="1"
            android:scrollbars="none">
        </ListView>

    </LinearLayout>

   </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:44:17.317

一起滚动是什么意思。如果您想在从项目 1 移动到项目 n 时也滚动图像。然后而不是更好地使用滚动视图将列表视图与第一行中的图像集成或将该图像作为列表项的标题。滚动视图用于滚动列表视图在内置滚动视图中滚动项目的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T03:05:19.360

封装你所拥有的一切

```
<LinearLayout
 ...>
    <ScrollView
     ...>
         Your original XML content here
    </ScrollView>
</LinearLayout> 
```

它应该工作。

# actionscript-3 - Flex 数字微调器，要添加前面的 0

> ID：10021914
> 
> 赞同：2
> 
> 时间：2012-04-05T02:31:19.360
> 
> 标签：actionscript-3, apache-flex, adobe, flex4.5, flexbuilder

我有一个 Flex UI，如果它在 0 和 9 之间，希望数字步进器在显示的值中添加一个前面的“0”，这样它总是 2 位数。我该怎么做呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T04:41:06.003

使用`valueFormatFunction`NumericStepper 的：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
               xmlns:s="library://ns.adobe.com/flex/spark"
               xmlns:mx="library://ns.adobe.com/flex/mx">

    <fx:Script>
        <![CDATA[
            protected function formatNumber(value:Number):String
            {
                if (value < 10)
                    return '0' + value;

                return value.toString();
            }
        ]]>
    </fx:Script>

    <s:NumericStepper valueFormatFunction="formatNumber"
                      minimum="0"
                      maximum="100" />

</s:Application> 
```

# ruby-on-rails-3 - Rails 3：数据库列不会通过活动记录更新

> ID：10021918
> 
> 赞同：2
> 
> 时间：2012-04-05T02:32:06.950
> 
> 标签：ruby-on-rails-3

我没有似乎无法更新或修改 rails 3 中的数据库列的问题。我以前从未见过这样的事情，因此我确信这是我忽略的小东西。请帮忙！

IRB 输出：

```
 ruby-1.9.2-p318 :002 > User.all
      User Load (0.1ms)  SELECT "users".* FROM "users" 
     => [] 
    ruby-1.9.2-p318 :003 > User.create( :login => "dummy", :password => "foobar", :password_
    confirmation => "foobar", :role => "user", :email => "dummy@email.com" )
       (0.1ms)  begin transaction
      User Exists (0.1ms)  SELECT 1 FROM "users" WHERE "users"."login" = 'dummy' LIMIT 1
      User Exists (0.0ms)  SELECT 1 FROM "users" WHERE "users"."email" = 'dummy@email.com' L
    IMIT 1
      SQL (0.8ms)  INSERT INTO "users" ("created_at", "email", "hashed_password", "login", "
    role", "salt", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)  [["created_at", Thu, 05 Apr 2
    012 02:21:00 UTC +00:00], ["email", "dummy@email.com"], ["hashed_password", "6416111c47f
    a52ddfbde9e539ee6e369807bdeab"], ["login", "dummy"], ["role", nil], ["salt", "1LTzevgRHt
    "], ["updated_at", Thu, 05 Apr 2012 02:21:00 UTC +00:00]]
       (61.5ms)  commit transaction
     => #<User id: 3, login: "dummy", role: nil, hashed_password: "6416111c47fa52ddfbde9e539
    ee6e369807bdeab", email: "dummy@email.com", salt: "1LTzevgRHt", created_at: "2012-04-05 
    02:21:00", updated_at: "2012-04-05 02:21:00"> 
    ruby-1.9.2-p318 :004 > u = User.first
      User Load (0.2ms)  SELECT "users".* FROM "users" LIMIT 1
     => #<User id: 3, login: "dummy", role: nil, hashed_password: "6416111c47fa52ddfbde9e539
    ee6e369807bdeab", email: "dummy@email.com", salt: "1LTzevgRHt", created_at: "2012-04-05 
    02:21:00", updated_at: "2012-04-05 02:21:00"> 
    ruby-1.9.2-p318 :005 > u.role 
     => nil 
    ruby-1.9.2-p318 :006 > u.role = "foo"
     => "foo" 
    ruby-1.9.2-p318 :007 > u.role
     => "foo" 
    ruby-1.9.2-p318 :008 > u
     => #<User id: 3, login: "dummy", role: nil, hashed_password: "6416111c47fa52ddfbde9e539
    ee6e369807bdeab", email: "dummy@email.com", salt: "1LTzevgRHt", created_at: "2012-04-05 
    02:21:00", updated_at: "2012-04-05 02:21:00"> 
```

移民：

```
 class CreateUsers < ActiveRecord::Migration
      def change
        create_table :users do |t|
          t.column :login, :string
          t.column :role, :string
          t.column :hashed_password, :string
          t.column :email, :string
          t.column :salt, :string
          t.timestamps
        end
      end
    end 
```

架构：

```
 ActiveRecord::Schema.define(:version => 20120318205424) do

      create_table "users", :force => true do |t|
        t.string   "login"
        t.string   "role"
        t.string   "hashed_password"
        t.string   "email"
        t.string   "salt"
        t.datetime "created_at",      :null => false
        t.datetime "updated_at",      :null => false
      end

    end 
```

模型：

```
 require 'digest/sha1'
    class User < ActiveRecord::Base
      validates_length_of :login, :within => 3..40
      validates_length_of :password, :within => 4..40
      validates_presence_of :login, :email, :password, :password_confirmation, :salt
      validates_uniqueness_of :login, :email
      validates_confirmation_of :password
      validates_format_of :email, :with => /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i, :message => "Invalid email"  

      attr_accessor :password, :password_confirmation, :role
      attr_protected :id, :salt

      def self.random_string(len)
        chars = ("a".."z").to_a + ("A".."Z").to_a + ("0".."9").to_a
        newpass = ""
        1.upto(len) { |i| newpass << chars[rand(chars.size-1)] }
        return newpass
      end

      def password=(pass)
        @password=pass
        self.salt = User.random_string(10) if !self.salt?
        self.hashed_password = User.encrypt(@password, self.salt)
      end

      def self.encrypt(pass, salt)
        Digest::SHA1.hexdigest("#{pass}#{salt}")
      end

      def self.authenticate(login, pass)
        u=find(:first, :conditions=>["login = ?", login])
        return nil if u.nil?
        if User.encrypt(pass, u.salt)==u.hashed_password
          # edits wont save without this
          u.password=u.password_confirmation=pass
          return u
        end
        nil
      end

      def send_new_password
        new_pass = User.random_string(10)
        self.password = self.password_confirmation = new_pass
        self.save
        Notification.deliver_forgot_password(self.email, self.login, new_pass)
      end

      def admin?
        (self.role == "admin")
      end

    end 
```

SQLite 更新，以显示它的工作原理：

```
 sqlite> select * from users;
    3|dummy||6416111c47fa52ddfbde9e539ee6e369807bdeab|dummy@email.com|1LTzevgRHt|2012-04-05 02:21:00.752890|2012-04-05 02:21:00.752890
    sqlite> select role from users;

    sqlite> select role from users where login = "dummy";

    sqlite> update users set role = "user" where login = "dummy";
    sqlite> select role from users where login = "dummy";
    user
    sqlite> select * from users;
    3|dummy|user|6416111c47fa52ddfbde9e539ee6e369807bdeab|dummy@email.com|1LTzevgRHt|2012-04-05 02:21:00.752890|2012-04-05 02:21:00.752890 
```

我已经搞砸了一段时间......感谢您提供的任何帮助。

根据要求编辑：

```
 ruby-1.9.2-p318 :011 > User.last.update_attributes!(:role => "foo") 
      User Load (0.2ms)  SELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT 1
       (0.1ms)  begin transaction
      User Exists (0.1ms)  SELECT 1 FROM "users" WHERE ("users"."login" = 'dummy' AND "users"."id" != 3) LIMIT 1
      User Exists (0.1ms)  SELECT 1 FROM "users" WHERE ("users"."email" = 'dummy@email.com' AND "users"."id" != 3) LIMIT 1
       (0.1ms)  rollback transaction
    ActiveRecord::RecordInvalid: Validation failed: Password is too short (minimum is 4 characters), Password can't be blank, Password confirmation can't be blank
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/validations.rb:56:in `save!'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/attribute_methods/dirty.rb:33:in `save!'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/transactions.rb:246:in `block in save!'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/transactions.rb:208:in `transaction'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/transactions.rb:246:in `save!'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/persistence.rb:224:in `block in update_attributes!'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/transactions.rb:208:in `transaction'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/persistence.rb:222:in `update_attributes!'
            from (irb):11
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/commands/console.rb:47:in `start'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/commands/console.rb:8:in `start'
            from /home/jmervine/Development/personal/blog/vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:41:in `<top (required)>'
            from script/rails:6:in `require'
            from script/rails:6:in `<main>'ruby-1.9.2-p318 :012 > User.last.update_attributes!(:role => "foo") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T03:20:54.133

`:role`从此行中删除`attr_accessor :password, :password_confirmation, :role`

# php - 使用 INSERT VALUES 时插入错误的数字

> ID：10021920
> 
> 赞同：0
> 
> 时间：2012-04-05T02:32:12.903
> 
> 标签：php, javascript

我的插入值有问题。问题是当我尝试插入问题编号时。假设我尝试插入 2 个问题。那么对于第一个问题，问题编号（QuestionId）应该是 1，对于第二个问题应该是 2。

但问题是当我插入值时，这两个问题都显示问题编号 3。所以它对每个问题所做的就是插入下一个问题编号，在这个例子中，所有问题都是“3”。

下面是当我为 2 个问题回显 $questionsql 时它显示的示例：

```
INSERT INTO Question (QuestionId, QuestionContent) VALUES ('3','what is my name'), ('3','what is my age') 
```

以上是不正确的。以下是它应该回应的内容：

```
INSERT INTO Question (QuestionId, QuestionContent) VALUES ('1','what is my name'), ('2','what is my age') 
```

所以我想知道的是如何为每个问题显示正确的问题编号，它应该按照问题 1、2、3 等的正确顺序添加正确的问题编号。

下面是将问题附加到表格行中的 javascript 代码和表单代码。用户将问题附加到表格行中。当用户添加第一个问题时，它会附加第 1 个问题和问题，当他们附加第二个问题时，它会附加第 2 个问题和问题等。

```
<script>

    function insertQuestion(form) {   

    var $tbody = $('#qandatbl > tbody'); 
    var $tr = $("<tr class='optionAndAnswer' align='center'></tr>");
    var $qid = $("<td class='qid'>" + qnum + "</td>");
    var $question = $("<td class='question'></td>");

    $('.questionTextArea').each( function() {

    var $this = $(this);
    var $questionText = $("<textarea class='textAreaQuestion'></textarea>").attr('name',$this.attr('name')+"[]")
                   .attr('value',$this.val())

    $question.append($questionText);

    });

    $tr.append($qid); 
    $tr.append($question);   
    $tbody.append($tr); 

    }

    ++qnum;
    $(".questionNum").text(qnum);
    $(".num_questions").val(qnum);

</script>

<form id="QandA" action="insertQuestion.php" method="post" >

<table id="question">
<tr>
    <th colspan="2">
        Question Number <span class="questionNum">1</span>
        <input type="hidden" class="num_questions" value="" name="numQuestion">
    </th>
</tr>
<tr>
    <td rowspan="3">Question:</td> 
    <td rowspan="3">
        <textarea class="questionTextArea" rows="5" cols="40" name="questionText"></textarea>
    </td>
</tr>
</table>

</form> 
```

下面是插入值的 php 代码。

```
$i = 0;

$insertquestion = array();

for($i = 0; $i++ ){

   $insertquestion[] = "'".  mysql_real_escape_string( $_POST['numQuestion'] ) ."','".  
                    mysql_real_escape_string( $_POST['questionText'][$i] ) ."'";

}

 $questionsql = "INSERT INTO Question (QuestionId, QuestionContent) 
    VALUES (" . implode('), (', $insertquestion) . ")";

    echo($questionsql); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:38:14.007

I believe you need to set the value of the form ie. `value="1"`

```
<form id="QandA" action="insertQuestion.php" method="post" >
<table id="question">
<tr>
    <th colspan="2">
        Question Number <span class="questionNum">1</span>
        <input type="hidden" class="num_questions" value="1" name="numQuestion">
    </th>
</tr>
<tr>
    <td rowspan="3">Question:</td> 
    <td rowspan="3">
        <textarea class="questionTextArea" rows="5" cols="40" name="questionText"></textarea>
    </td>
</tr>
</table>

</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:43:37.793

for() 循环中的代码有语法错误；此代码不解析。假设您修复了该问题并正确循环，您的问题可能是您正在插入 $_POST['questionNum']。据我所知，这个变量的值将是问题的*总数*，而不是单个问题的数量。

相反，您可以只使用 $i 的值，例如

```
for($i = 0; $i++; $i < count($_POST['questionText']) ){

   $insertquestion[] = "'". $i ."','".  
                mysql_real_escape_string( $_POST['questionText'][$i] ) ."'";

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T02:48:59.030

您可以将 POST 变量作为数组 ( `$_POST['questionText'][$i]`) 访问，因为您在这里使用了一个小技巧：

```
$("<textarea class='textAreaQuestion'></textarea>").attr('name',$this.attr('name')+"[]")
                   .attr('value',$this.val()) 
```

（顺便说一句，你错过了一个 ; 在行尾）使用这一行，你正在生成一个 HTML，如：

```
<textarea name="dunnowhat[]"></textarea>
<textarea name="dunnowhat[]"></textarea>
<textarea name="dunnowhat[]"></textarea>
<textarea name="dunnowhat[]"></textarea> 
```

看到那些 [] 了吗？那是什么使这项工作。但是对于问题编号，您并没有使用相同的技巧。现在更大的问题，即使你用过，也可能不一样。想象一下，如果你跳过一个值会发生什么。它可能不会在 POST 变量数组中显示为空，因此它可能会按索引混淆问题和问题编号的配对（数组项将被移动）。

因此，我建议不要使用这个技巧，而是使用名称间距。有一个索引计数，并附加它而不是 []。所以它会变成这样：

```
<input type="text" name="question-index.1">3</input>
<textarea name="dunnowhat.1"></textarea>
<input type="text" name="question-index.2">5</input>
<textarea name="dunnowhat.2"></textarea>
<input type="text" name="question-index.3">4</input>
<textarea name="dunnowhat.3"></textarea>
<input type="text" name="question-index.4">1</input>
<textarea name="dunnowhat.4"></textarea> 
```

或者更简单，将这些 id 直接附加到名称（使用 jquery）

```
<textarea name="dunnowhat.3"></textarea>
<textarea name="dunnowhat.5"></textarea>
<textarea name="dunnowhat.4"></textarea>
<textarea name="dunnowhat.1"></textarea> 
```

对 $_POST 数组进行 foreach 检查键是否以 开头`dunnowhat`，您将得到所有问题。

但即使有所有这些。为什么不只使用 MySQL 的**`AUTO_INCREMENT`**？如果您不需要用户指定可以解决整个问题的问题编号。至于完整的代码……我就不写了，这里要改的太多了。

# image - API 图像请求返回奇怪的字符。如何显示图像？

> ID：10021921
> 
> 赞同：0
> 
> 时间：2012-04-05T02:32:13.633
> 
> 标签：image, api

我通过 API 请求得到了一张图片，我得到了

```
  大批
(
    [代码] => 200
    [标题] => 数组
        (
            [缓存控制] => maxage=15552000
            [内容类型] => 图片/png
            [日期] => 2012 年 4 月 5 日星期四 02:14:10 GMT
            [过期] => 2012 年 10 月 2 日星期二 02:14:11 GMT
            [p3p] => CP="NOI ADM DEV PSAi COM NAV OUR OTRo STP IND DEM"
            [pragma] => 公开
            [服务器] => 阿帕奇
            [set-cookie] => CAKEPHP=ni9r4qo9ia4a0os2; 过期=周日，2037 年 4 月 5 日 08:14:10 GMT；路径=/; 域=.somedomain.com
            [变化] => 接受编码，用户代理
            [内容长度] => 4303
            [连接] => 保持活动状态
        )

```
[body] => ‰PNG 
```

IHDRôôî½€V pHYsHHFÉk> vpAgôôL´£<�
IDATxÚí?¯ãÆGÆ3ì ÿ¼k'¤ZìA z°HŠ)\°w³.÷,ÀÊíøâ‚ö'PÂüB$Ž
öªÕ)€BRÚ·Zk†œ¯æÍêžShõÞÓ½;Ô)Jäðgv sß€ø ]!HWÒ‚t… ]!HWÒ‚t… ]!HWÒ‚t… ]!HWÒ‚t… ]!HWÒ‚t… ]!HWÒ ‚t… ]!HW‚‚t… ]!HW‚‚t… ]!HW‚‚t… ]!HW‚‚t… ]!HW‚‚t… ]!HW‚‚t… ]!HW‚‚t… ]!HW‚‚t … ]!HWÒ‚t… ]!HWÒ‚t… ]!HWÒ‚t… ]!HWÒ‚t… ]!HWÒ‚t… ]!HWÒr$}[gæ^X4òË%¼,Y½oS,I¯M±jî :7éÅ^–Uaêû6%È'ô¬¸¯AÌKéŽùB¸a'Ez.bp$Ý¬îke.¾XÒË²º¦ŸŸcéÍ}
¢'—.½,
Ò…Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥ Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\îÒ¥Az\&K—Hâ@ z\&IßÖÅÜ~¬œšjWzaæû;+óòas3e,ôÛ.©OEš~þWzëz¿y*©ú;3šËƒô=›ÌÌ»¨”æîÉ;—¸Ò·Æ,û;íVjÿ/ÛV!}ÏÌd‡§ª0Ó‚r "¿§ç¦ÏrÚ˜ùl/{aF€ôÃÓpW°ÂJJdéK3ÛÿS,ö/ÖÙaÕ\Zé!Þ#çK¯ŒXTYdé›ýËuaêÚt‰pODzÏÂˆÞÅþÈ6ï÷AÚmû¦ß'¯^îÎ€ôžùÄ½·#bK/»TÓÝÌ» 7ã HïÉÞ\é«no½ìTwªÛ~7t=¼ÿŽôžÓ]Þª[mJ³Ûæ£#7k5gêUûµê÷ëòá
¤÷¿n¿YvÏç./R—¾0å¶ÿl¾m...—ýÎI¾ZíÍ!ýð4Ü}µÍæ]mμÈv«EÛ±I]zmæÍþÃGfÖó~9òy9[-ôï' _Îäæåì³TìïUu¶.ê7Azû¡Øï'”íþ[¾Õ6ËÖ'¾§}L °ÎWÕ²~ïÞé»îˆAÿ¦;|ÐÝi·U¤Ónì÷ã«jcŠ¶c³Ìš ãnñ¥Wí <ŒÞä+6ï>l—yë}^
ëzW®wù.oY‡ô‰/}ç‡Ïæåa¬y½:Ò†ti8‰".H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.H÷éÒ =.ÇÒëóÛL#4¼oœÙh6v õ•J_^?õžlå_nÅxNr¹X„tIoÌ¼¬îÂÌ,½|X›™ä²”³û{ï»Ç[M™ßµ¸óvY*Ñ!V›éCJ‡kz«O®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®Uúja ,˜ÍKÝ.çaóZd M·—Œ}d[çkÇ_‚>²µ¯ˆÌµyøÈ–ÏóYf^éuaª&¬dSzVTU@‰Kz>[87ï_Î¬›&[Úû(–^U²Ò7]ÄK@‰óË™ué`3ûÀ6Õ,¬ÏbõªøJ¥¯Úç¼  ¡œ\’¡˜A
[¹6ëMèÀªYfN6«‚ÚÔùÑû+•~U•\Õ7áWË(2ß_Ò˜õé/×áIÈŠ»»W*ýŒš?g\hhe+É«à>sKI~y•£«9]«ôF¸äét[É×ãBzp  ÒÓéC%H÷+Azú }¨é~%HO¤• Ý¯éé#'ýp5Ë©Ò·‡&gt;S¥¾6Dº…3¤?þ¯õ×Õ£ÛîPÅwƒþð‡£óY5Ô?Ügq{ôÃ§Ëî[ÙÛðë#ÝVò­õ×•1æá‹Õ·×ô¦;ÒõñróäŒ5ýó£þÖ¶ytÛ|Îš~ŠKú6w.ðØ±ÉÝÿ¬eë,w©il]~î’^×¡˜ÜzàÖµÎC1z¥W…[º{Moù…CúvÑ¸"
N×tsc8¤—åz¶²ÿédMoyÇ%};Ÿ¹]­ô²³7ïGŠDØæ}³ÌW@Ú¼—eîXt¤[8wGn9slÞÃväêÜ•@²#×Ì·H?a`
5 üF®v¼Ûè•~v _Ã¦Ò‡JîW,ôôAúP ÒýJž>H*¹VéLv8)¹zéLk:áú§5
Mo<Ï»>£ Ûw `ü^rã¿»›ÿLžÀøCwóãô Œ?Þ5S8Ñ1#ø÷ÝÍ{’S•?èn~;yªòƒîæÝéS•ß½k¦pª²“?™Õô&amp;Ç¬ÍC‘&gt;OeBäkótüAÊ¤¯y.ÛñÖˆ¼Œ6Æ<“N»OýV&½º1d;>2æ…@›å11ò[cn–£R&ý©‘Y1ïXwg²ôÉÚ>Û÷º;?gôQº¤oº]‰óŽ²]CÍzr›~`]Ò—oug¼Iv|Ü=Ë·“ÛÔÝkGà§Ûq¿Ýbè'žõŸ^¦¯∼wôk¨ùãä>Ïú>“ßxV}›Ñ=B]Ò›¦1M3¾{ëÍ¶ oØ¤2°ßptI¿ÄK5êãÓé©4Dúå@:ÒÓiˆôËt¤§Óé—éHO§!Ò/ *Ò'žNC¤¤¯ôðsäFNa* :G®)¬gÂ
ÌqŽœu8ïÝ5û)EóªøJ¥'|6lv6lé:¶;6»þ³aÅÏ{ßrÞ{ò`†KðlÌp‰sÙ†JîW‚ôôAúP ÒýJž>H*Aº_ ÒÓéC%H÷+Azú\mœÇ¡
Ò-^Æyt_ƒ~>‹å‡~hÌ³ýU ¿
îCœ‡'iÆy|VÄyÜ˜öeHœ‡gœÇâüd;Cq¯ýÐáNvØ•ÆµòÚ'~EœÇ)Î%>,#Î#ˆó°àÊp)
wœ‡õh½c)¶q'œçñà¹DœÇÍpœGíçñbEœ‡Á8ö
½ýç»'®:wœÇë;rŸ-»Ç¹ã<2¿8ý~%qäâ<6#u›L$ÎcEœÇd\Ò×Kãš~nœÇÒ5œ8È¼yq
qSákØ¡¤û• =}>T,t¿¤§Ò‡JîW,ôô¹¦8Ì&=x¢ŒéWçÑxþr~ëŸÖ´2‹•ôFëŒÁO œÇjqýƒã<©¯ŽóÈêÿÀ.çqœ.rÒ]$çñ'TœÇGãR&}-|¹ ÷îŒ—3>)–BœÇåX¦ç!1âJ—ôþšü¥dÇŠ8Ôéã<Â/â0À'2/#â<.q=º¤7Äytè'~‰æâéƒt¤§Óé—éHO§!Ò/Ò'žNC¤_¤ #=†H¿HGz:`tÇyXVÍíçÖ8ï5ÄyÔÖ’ý$Þ÷f¿Â17øòq¥}ªrIœ‡7ÄyìÔI'Î£C™ôêFörïýß§_î8K’tœ‡ÀÀº¾çñ:ÉÆyl»IÅyŒn1tIïã<$VÌ;>éže8~¯{úpúwâ<^ƒ8]Òâ<:tI¿ÄsñÀôA:ÒÓiˆôËt¤§Óé—éHO§!Ò/Ò‘žNC¤_¤#=†HŸLç±‹ó¨­çÈ}èH*Aº_   ÒÓ'½8Ã¿Äy\Á8Ç¢q óøâµ«@?]öWþ"¸
Òm%îë½?º•ŠóØJÄy<.‰ó°!çñK÷¥¿â<Œy_"Îã†8ñâ<²•Xœ‡ã QPœÇŽ8SÎŒó¨ÿ)çñt(Îcåçñ8+’qÏeâ<>>;ÎãË£>m÷/Ú¾$Îã”ˆqs‘8†8ÉÄ‹óÈ¥â&lt;
â<&òÆyÄyL„¯a‡JîW‚ôôAúP  ÒýJž>H*Aº_  ÒÓçŒëðçñ¦“_OœÇÚç|ÙËëŸÖçQÍG^&‹Ð8Â1Ñ:°¡8ë¦y`
'>{jÆÏº›·mñˆóÈœß±ý%(ÎãÝÐm—ÖSöÞvžk§ Î£1Yåâ¶_úÄyØê¾én¾²ýÅç±¶¬Ó×ö9â<¬ÃùÚ¹€ÙÑÁÅ+•žnœGðÑ|©8ùÕŸ÷NœÇiÉÕÏpa.ÛP ÒºC%H +Azú }¨é~%HO¤• ý%O\qeçñ$¬[Ë÷ýÐ¼ÿ¼¿HÁ_§Çyt_çaA2ÎãÆ<º]‹Äy<“ˆóxË<%ÎÃŠxœÇï„â<~#çñkâT,t¿¤§Ò‡JîW ‚ôôAúPÉµJ'Îã¤äê¥ç‹ÐŠ'€â<Ò§6…3ÎÃŠGœGÔ0,ÎÃÍÒç±ŽŠ8Ìáç1ëç10°ÂçQGsœì®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºB®¤+é
AºBþçL™@ùE¯'%tEXtdate:create2012-04-05T01:46:01+00:00>—O%tEXtdate:modify2012-04-05T01:46:01+00:00pc/óIEND®B`,
)
```

如何在常规网页中显示此图像？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T06:06:14.933

字符是二进制数据格式的图像。

为了将此数据显示为图像，我执行了以下操作：

我将字符保存在一个文件中（使用 notepad++ 文本编辑器），并使用 .png 扩展名保存了该文件。

```
$imgfile = $_SERVER['DOCUMENT_ROOT']."/images/charts/".$_GET['documentId'].".png";
$imglink = "http://domain.com/images/charts/".$_GET['documentId'].".png";
$imgfilehandle = fopen($imgfile, 'w') or die('COULD NOT OPEN FILE: '.$imgfile);
fwrite($imgfilehandle, $result['body']);
fclose($imgfilehandle); 
```

然后在 html 文档的正文中，我通过这段代码显示了图像

```
 function data_uri($imgfile, $mime) {

    $contents = file_get_contents($imgfile);
    $base64 = base64_encode($contents);
    return "data:$mime;base64,$base64";

    }

<img id="thischart" class="chart" style="margin: 0 auto; min-height: 1px; min-width: 1px; position: relative; " src="<?php echo data_uri($imgfile, 'image/png');?>" /> 
```

瞧……

# perl - 打印 10GB 文件的唯一行

> ID：10021927
> 
> 赞同：11
> 
> 时间：2012-04-05T02:32:46.707
> 
> 标签：perl

我有一个包含 2 亿行的 10GB 文件。我需要获取此文件的唯一行。

我的代码：

```
 while(<>) {
     chomp;
     $tmp{$_}=1;
 }
 #print... 
```

我只有2GB内存。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T04:13:10.170

正如我对大卫的回答所评论的那样，数据库是要走的路，但一个不错的可能是[`DBM::Deep`](http://p3rl.org/DBM%3a%3aDeep)因为它是纯 Perl 并且易于安装和使用；它本质上是一个绑定到文件的 Perl 哈希。

```
use DBM::Deep;
tie my %lines, 'DBM::Deep', 'data.db';

while(<>) {
    chomp;
    $lines{$_}=1;
} 
```

这基本上是您已经拥有的，但哈希现在是一个与文件（此处为 data.db）相关联的数据库，而不是保存在内存中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T03:36:14.267

在大多数情况下，您可以将该行作为键存储在哈希中。但是，当你变得这么大时，这真的不是很有效。在这种情况下，您最好使用数据库。

要尝试的一件事是曾经包含在 Unix (BDB) 中[的伯克利数据库。](http://www.oracle.com/technetwork/products/berkeleydb/overview/index.html?origref=http://en.wikipedia.org/wiki/Berkeley_DB)现在，它显然归甲骨文所有。

Perl 可以使用[BerkeleyDB](http://search.cpan.org/%7Epmqs/BerkeleyDB-0.51/BerkeleyDB.pod)模块与 BDB 数据库通信。事实上，您甚至可以将 Perl 哈希[绑定](http://perldoc.perl.org/functions/tie.html)到 BDB 数据库。完成此操作后，您可以使用普通 Perl 哈希来访问和修改数据库。

BDB 非常健壮。比特币使用它，SpamAssassin 也使用它，因此它很可能可以处理您必须创建的数据库类型以查找重复行。如果您已经安装了 DBD，那么编写一个程序来处理您的任务应该不会花那么长时间。如果它不起作用，你就不会在这上面浪费太多时间。

我能想到的唯一另一件事是使用 SQL 数据库，它会更慢且更复杂。

* * *

## 附录

可能是我想多了……

我决定尝试一个简单的哈希。这是我的程序：

```
#! /usr/bin/env perl
use strict;
use warnings;
use feature qw(say);
use autodie;

use constant DIR => "/usr/share/dict";

use constant WORD_LIST => qw(words web2a propernames connectives);

my %word_hash;
for my $count (1..100) {
    for my $file (WORD_LIST) {
        open my $file_fh, "<", DIR . "/$file";
        while (my $word = <$file_fh>) {
            chomp $word;
            $word_hash{"$file-$word-$count"} = $word;
        }
    }
} 
```

读入的文件总共包含大约 313,000 行。我这样做了 100 次以获得包含 31,300,000 个键的散列。它几乎是低效的。每把钥匙都是独一无二的。内存量将是巨大的。然而...

有效。尽管该程序效率极低，但运行大约需要 10 分钟，并且最大容量约为 6 GB。但是，其中大部分都在虚拟内存中。奇怪的是，即使它正在运行、吞噬内存并占用 98% 的 CPU，我的系统并没有真正减慢那么多。我想问题真的是你期待什么样的表现？如果运行大约 10 分钟对您来说不是什么大问题，并且您不希望经常使用此程序，那么可能会为了简单起见并使用简单的哈希。

我现在正在从 Oracle 下载 DBD，对其进行编译和安装。我将使用 DBD 尝试相同的程序，看看会发生什么。

* * *

## 使用 BDB 数据库

完成这项工作后，我想如果你安装了 MySQL，使用 Perl DBI 会更容易。我不得不：

*   从 Oracle 下载 Berkeley DB，您需要一个 Oracle 帐户。我不记得我的密码，并告诉它给我发电子邮件。一直没收到邮件。我花了 10 分钟试图记住我的电子邮件地址。
*   下载后，必须对其进行编译。找到了为 Mac 编译的方向，看起来很简单。
*   运行 CPAN 崩溃。最终发现 CPAN 正在寻找`/usr/local/BerkeleyDB`并将其安装为`/usr/local/BerkeleyDB.5.3`. 创建链接解决了这个问题。

总而言之，安装 BerkeleyDB 大约需要 1/2 小时。安装后，修改我的程序非常简单：

```
#! /usr/bin/env perl
use strict;
use warnings;
use feature qw(say);
use autodie;

use BerkeleyDB;

use constant {
    DIR       => "/usr/share/dict",
    BDB_FILE  => "bdb_file",
};

use constant WORD_LIST => qw(words web2a propernames connectives);

unlink BDB_FILE if -f BDB_FILE;

our %word_hash;
tie %word_hash, "BerkeleyDB::Hash",
    -Filename => BDB_FILE,
    -Flags    => DB_CREATE
        or die qq(Cannot create DBD_Database file ") . BDB_FILE . qq("\n);

for my $count (1..10) {
    for my $file (WORD_LIST) {
        open my $file_fh, "<", DIR . "/$file";
        while (my $word = <$file_fh>) {
            chomp $word;
            $word_hash{"$file-$word-$count"} = $word;
        }
    }
} 
```

我所要做的就是添加几行。

运行该程序令人失望。它不是更快，而是慢得多。它花了 2 多分钟，而使用纯哈希只需要 13 秒。

但是，它使用的内存要少得多。虽然旧程序吞噬了千兆字节，但 BDB 版本几乎不使用兆字节。相反，它创建了一个 20MB 的数据库文件。

但是，在虚拟机和廉价内存的时代，它有什么成就吗？在虚拟内存和良好内存处理之前的过去，如果程序使用了所有内存（内存以兆字节而不是千兆字节为单位），它会导致计算机崩溃。现在，如果您的程序需要比可用内存更多的内存，则只需为其提供虚拟内存。

所以，最后，使用伯克利数据库并不是一个好的解决方案。我在编程时间中节省的任何东西`tie`都浪费在了安装过程中。而且，它很慢。

使用 BDB 只需使用 DBD 文件而不是内存。现代操作系统也会这样做，而且速度更快。当操作系统会为您处理它时，为什么要这样做？

使用数据库的唯一原因是您的系统确实没有所需的资源。2 亿行是一个大文件，但现代操作系统可能会接受它。如果您的系统确实没有资源，请在另一个系统上使用 SQL 数据库，而不是 DBD 数据库。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-05T04:47:32.790

如果您不关心保留顺序，我敢打赌以下解决方案比以前发布的解决方案（例如 DBM::Deep）更快：

```
sort -u file 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-05T03:09:42.273

您可能会考虑为每一行计算一个哈希码，并跟踪（哈希、位置）映射。为此，您不需要复杂的散列函数（甚至是大散列）；事实上，如果主要关注的是内存使用，“更小”比“更独特”要好。即使是 CRC，或总结字符的代码，也可以。关键不是在这个阶段保证唯一性——只是将候选匹配从 2 亿个缩小到几十个。

对于每一行，计算哈希值并查看是否已有映射。如果你这样做了，那么对于映射到该哈希的每个位置，读取该位置的行并查看这些行是否匹配。如果他们中的任何一个这样做，请跳过该行。如果没有，或者您没有该哈希的任何映射，请记住 (hash, position) 然后打印该行。

请注意，我说的是“位置”，而不是“行号”。为了在不到一年的时间内完成这项工作，您几乎可以肯定必须能够找到线路的权利，而不是找到线路#1392499 的方式。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-05T02:59:27.110

如果您不关心时间/IO 限制，也不关心磁盘限制（例如，您还有 10 GB 空间），您可以执行以下愚蠢算法：

1）读取文件（听起来它有 50 个字符行）。扫描时，记住最长的行长度`$L`。

2) 分析前 3 个字符（如果您知道 char #1 是相同的 - 比如说`"["`- 分析位置 N 中可能有更多不同字符的 3 个字符）。

3) 对于每个包含 3 个字符 $XYZ 的行，将该行附加到文件 3char.$XYZ 中，并将该文件中的行数记录在一个散列中。

4）当您的整个文件以这种方式拆分时，您应该有一大堆（如果文件仅是 AZ，则为 26^3）较小的文件，并且最多 4 个文件，每个文件 >2GB。

5) 将原始文件移动到“已处理”目录中。

6）对于每个大文件（> 2GB），选择接下来的3个字符位置，并重复步骤#1-#5，新文件为6char.$XYZABC

7) 起泡、冲洗、重复。您最终将获得以下两个选项之一：

8a）一堆较小的文件，每个文件都在 2GB 以下，所有这些文件都具有相互不同的字符串，并且每个（由于其大小）都可以通过您问题中的标准“存储到哈希”解决方案单独处理。

8b）或者，大多数文件都较小，但是，`$L`在重复步骤 7 处理 >2GB 的文件时，您已经耗尽了所有字符，并且您仍然有 1-4 个大文件。你猜怎么着——因为那些最多 4 个大文件在位置 1..$L 的文件中具有相同的字符，因此它们也可以在您的问题中使用“存储到哈希”方法进行处理，因为它们不会尽管它们的大小，但包含多个不同的行！

请注意，在最坏的情况下，这可能需要`10GB * L / 3`磁盘空间，但如果您将步骤#5 从“移动”更改为“删除”，则只需要 20GB 磁盘空间。

瞧。完毕。

* * *

作为一种替代方法，考虑散列你的行。我不是散列专家，但您应该能够将一行压缩为 <5 倍行大小恕我直言的散列。

如果您想对此有所了解，您将在第一遍对字符序列进行频率分析，然后以这种方式进行压缩/编码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-05T08:50:48.943

如果你有更多的处理器并且至少有 15GB 的可用空间并且你的存储速度足够快，你可以试试这个。这将并行处理它。

```
split --lines=100000 -d 4 -d input.file
find . -name "x*" -print|xargs -n 1 -P10 -I SPLITTED_FILE sort -u SPLITTED_FILE>unique.SPLITTED_FILE
cat unique.*>output.file
rm unique.* x* 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-05T04:49:58.113

您可以将文件分成 10 个 1 GB 的文件，然后一次读取一个文件，对该文件中的行进行排序，并在排序后将其写回。打开所有 10 个文件并将它们合并回一个文件（确保以正确的顺序合并它们）。打开输出文件以保存唯一行。然后一次一行地读取合并文件，保留最后一行进行比较。如果最后一行和当前行不匹配，则写出最后一行，并将当前行保存为最后一行进行比较。否则从合并文件中获取下一行。这将为您提供一个包含所有独特行的文件。

执行此操作可能需要一段时间，但如果您的内存有限，那么将文件分解并处理其中的一部分将起作用。

写出文件时可能会进行比较，但这会有点复杂。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-05T04:50:14.867

为什么要为此使用 perl？posix外壳：

```
sort | uniq 
```

完了，我们去喝啤酒吧。

# jquery - EventClick function in jquery-ui dialogbox not working when button is bound to a function

> ID：10021943
> 
> 赞同：1
> 
> 时间：2012-04-05T02:34:40.327
> 
> 标签：jquery, button, modal-dialog

I'm using fullCalendar in conjuction with jquery UI's dialog box. The problem I am having is with the 'Update' button located in the eventClick() method. I can never get the alert() to display:"Pressing update should display an alert message". The Cancel button closes the dialog box as it should.

Ideas ?

* * *

```
$().ready(function() {
        var calendar = $('#calendar').fullCalendar({
            header: {
                left: 'month,agendaWeek,agendaDay',
                center: 'prevYear title nextYear',
                right: 'prev,next, today'
            },
            theme:true,//use JQuery UI theme
            selectable: true,
            selectHelper: true,
            weekMode:'variable',
            dayClick:function(){
                //alert('a day has been clicked');
            },
            editable: true,
            eventClick:function(calEvent, jsEvent, view){
                $("#event").dialog({
                    modal:true,
                    title:calEvent.title ,
                    position:'top',
                    width:600,
                    buttons:[
                      {text:'Update',click:function(){updateEvent();}},
                      {text:'Cancel',click:function(){$("#event").dialog('close');}}
                    ]
                });
                $('#title').val(calEvent.title);
                $('#location').val(calEvent.location);
                $('#start').val($.fullCalendar.formatDate($.fullCalendar.parseDate(calEvent.start),'MM/dd/yyyy'));
                if ( calEvent.end != null ) $('#end').val($.fullCalendar.formatDate($.fullCalendar.parseDate(calEvent.end),'MM/dd/yyyy'));
                $('#description').val(calEvent.description);
                $('#uID').val(calEvent.uID);
            },
            select: function(start, end, allDay) {
                //a new event to be created (1 or more days)    

                var title = prompt('Add a new event:');
                if (title) {
                    var newEvent = {updateType:1,startString:getDateString(start),endString:getDateString(end),title:title,start:start,end:end,allDay:allDay,description:'This is a desc.',location:'Event is at home'};
                    sendDataToCalendar(newEvent);
                    calendar.fullCalendar('renderEvent', newEvent, true);
                }

                calendar.fullCalendar('unselect');
            }
        });

        calendar.fullCalendar( 'addEventSource', getEventsFromDB() );

        //setup date picker
        $('#start').datepicker({autoSize:true});
        $('#end').datepicker({autoSize:true});

        //auto update title of dialog box
        $('#title').bind('keyup', function(){
            $('#event').dialog('option', 'title', $('#title').val());
        });
    });

    function updateEvent(){
        alert('Pressing update should display an alert message');
    //  var jsonData = $('#event').serialize() + '&' + $.param({updateType:1});
    //  sendDataToCalendar(jsonData);
    //  $("#event").dialog('close');
    } 
```

# php - 将字符串缩短为产品名称

> ID：10021946
> 
> 赞同：2
> 
> 时间：2012-04-05T02:35:07.997
> 
> 标签：php, nlp, linguistics

我需要帮助。我正在尝试缩短亚马逊的完整产品名称。例如：

三星 Galaxy S II Epic Touch 4G 安卓手机（Sprint）

银河 S II

我想以编程方式执行此操作。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:42:25.440

@bdares 指出了似乎是最简单的处理方法——列出所有产品名称，然后使用某种文本搜索来查找字符串包含的产品名称。

我问[给定一个搜索词列表，我怎么知道我的字符串包含哪些？](https://stackoverflow.com/questions/10022062/given-a-list-of-search-terms-how-can-i-tell-which-ones-my-string-contains)因为我现在想不出一个好方法来做到这一点。

编辑：我得到了一个[很好的答案](https://stackoverflow.com/a/10056567/212555)。

# javascript - 通过多个标签切换 div - Jquery/Javascript

> ID：10021956
> 
> 赞同：0
> 
> 时间：2012-04-05T02:36:12.673
> 
> 标签：javascript, jquery, jquery-ui, javascript-events

 我可以通过一个 js 函数来切换，该函数使用 href id 匹配到相应的 div 或 td 来切换。

但我的目标是能够使用页面底部的另一个 href 来切换 div/td。此 href 包含相同的 id 和名称。 

这是一个示例：[jsfiddle](http://jsfiddle.net/X8U82/15/)（切换功能在我的远程服务器中有效，但在 jsfiddle 中不起作用）

```
<script type="text/javascript">

function showonlyonev2(thechosenone) {
      var newboxes = document.getElementsByTagName("div");
      for(var x=0; x<newboxes.length; x++) {
            name = newboxes[x].getAttribute("name");
            if (name == 'newboxes-2') {
                  if (newboxes[x].id == thechosenone) {
                        if (newboxes[x].style.display == 'block') {
                              newboxes[x].style.display = 'none';
                        }
                        else {
                              newboxes[x].style.display = 'block';
                        }
                  }else {
                        newboxes[x].style.display = 'none';
                  }
            }
      }
}​
</script>

<table>
   <tr>
      <td>
         <div style="border: 1px solid blue; background-color: #99CCFF; padding: 5px;">
            <a id="myHeader1-2" href="javascript:showonlyonev2('newboxes1-2');" >toggle</a>
         </div>
         <div name="newboxes-2" id="newboxes1-2" name="div1" style="border: 1px solid black; background-color: #CCCCCC; display: block;padding: 5px;">Div #1</div>
      </td>
      <td>
         <div style="border: 1px solid blue; background-color: #99CCFF; padding: 5px;">
            <a id="myHeader2-2" href="javascript:showonlyonev2('newboxes2-2');" >toggle</a>
         </div>
         <div name="newboxes-2" id="newboxes2-2" name="div2" style="border: 1px solid black; background-color: #CCCCCC; display: none;padding: 5px;">Div #2</div>
      </td>
      <td>
         <div style="border: 1px solid blue; background-color: #99CCFF; padding: 5px;">
            <a id="myHeader3-2" href="javascript:showonlyonev2('newboxes3-2');" >toggle</a>
         </div>
         <div name="newboxes-2" id="newboxes3-2" name="div3" style="border: 1px solid black; background-color: #CCCCCC; display: none;padding: 5px;">Div #3</div>
      </td>
   </tr>
</table>

<div style="padding-top:20px;">
    <a id="myHeader1-2" name="div1" href="javascript:showonlyonev2('newboxes1-2');">See Div #1</a>  
</div>    

<div style="padding-top:20px;">
    <a id="myHeader2-2" name="div2" href="javascript:showonlyonev2('newboxes2-2');">See Div #2</a>  
</div>

<div style="padding-top:20px;">
    <a id="myHeader3-2" name="div3" href="javascript:showonlyonev2('newboxes3-2');">See Div #3</a>  
</div>    ​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:43:19.890

在 div 上具有“名称”属性是不寻常的。

顶部表格中的 div 每个都有 2 个“名称”属性。

我会清理它并再试一次。

# html - 使用 CSS，有没有办法使用不同的字体显示不同的字符？

> ID：10021959
> 
> 赞同：6
> 
> 时间：2012-04-05T02:36:35.677
> 
> 标签：html, css, fonts, typography

我的 HTML 文本是这样的：

```
<p>abcdefghijklmnopqrstuvwxyz</p> 
```

我想要的是使用“Times New Roman”显示，并使用“Courier New”显示oz，这应该使用CSS来完成，比如说，不改变HTML文本。

简单来说，就是想让 CSS**自动**选择对应哪个字符的指定字体。
an 应使用“Times New Roman”显示；
oz 应使用“Courier New”显示。

有没有办法做到这一点？

如果能解决这个问题，就可以解决另一个问题：用不同的字体显示不同的语言。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-05T03:13:33.250

是的，您可以使用`unicode-range` 它在所有现代网络浏览器中使用的东西：[https ://developer.mozilla.org/en-US/docs/Web/CSS/@font-face](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face)

[顺便说一句，来自http://24ways.org/2011/unicode-range](http://24ways.org/2011/unicode-range)的更多信息

现场示例：http: [//jsfiddle.net/jfcox/3LQyr/](http://jsfiddle.net/jfcox/3LQyr/)

```
<style>
@font-face {
    font-family: Foobar;
    src: local('Times New Roman');
    unicode-range: U+61-6E;
}
@font-face {
    font-family: Foobar;
    src: local('Arial');
    unicode-range: U+6F-7A;
}
body{
  font-family:Foobar;
}
</style>
<p>abcdefghijklmnopqrstuvwxyz</p>​ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T04:33:41.360

如果字符属于不同的书写系统，例如拉丁语和希伯来语，或者西里尔语和希腊语，浏览器通常会自动为它们使用不同的字体。但是，这只发生在页面未指定字体的情况下，即这仅与默认字体有关，并且使用的字体由浏览器默认值和用户控制的浏览器设置确定。

尽管 JayC 的回答中描述的技术提供了部分解决方案，但通过在标记中区分不同语言的文本，您可以获得更好的浏览器覆盖率。在双语文档中，对其中一个文本使用标记就足够了（出于实际原因，使用较少的文本）。`class`在 gutch 的答案中使用as 可以提供最好的覆盖率，但现在对 CSS 中语言选择器的支持非常普遍，您可能会考虑使用更合乎逻辑的`lang`属性，例如

```
<h1>Hello − <a lang=ru>Привет</а></h1> 
```

然后你会使用像这样的规则

```
[lang=ru] { font-family: ...; } 
```

（我的示例`<a>`有效地将元素用作 的较短变体`<span>`。形式上，这仅在文本不在外部`<a>`元素内时才有可能。）

然而，对于视觉风格，将需要与按语言选择字体相反。如果“Hello”中的“e”与同一行的“Привет”中的西里尔字母“е”不同，这看起来真的很奇怪。如果可能，对文档中的所有语言使用相同的字体几乎总是更好。这意味着选择一种适用于所有人的字体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T02:57:40.777

您不能使用 CSS 来更改您所描述的特定字符的字体，因为 CSS 选择器不会选择单个字符——它们会选择 HTML 元素。

因此，您需要围绕需要特定字体的文本块创建元素。理想情况下，您会在服务器端代码中执行此操作，但我不知道这对您是否实用。您的服务器需要像这样输出 HTML：

```
<p><span class="languageOne">abcdefghijklmn</span><span class="languageTwo">opqrstuvwxyz</span></p> 
```

然后在 CSS 中应用适当的字体：

```
.languageOne { font-family: "Times New Roman", serif; }
.languageTwo { font-family: "Courier New", monospace; } 
```

# eclipse - Using JSF 2, XHTML. Eclipse 3.7 won't throw any warnings.. No validation seems to be happening

> ID：10021963
> 
> 赞同：0
> 
> 时间：2012-04-05T02:37:09.350
> 
> 标签：eclipse, jsf

I can put any kind of jibberish tags in the file and no warnings/errors are flagged.

Also, ctrl + shift + / doesn't work for adding block comments. I tried to use the JBOSS tools, but that didn't help.

# c# - Internet Explorer 9 Keeps using the wrong CAB file

> ID：10021968
> 
> 赞同：1
> 
> 时间：2012-04-05T02:37:57.423
> 
> 标签：c#, internet-explorer, activex

I'm working on an activeX component of a web application with Visual Studio 2008 in Windows 7 and IE9\. I have a method to test it so that i don't have to deploy it to the Web server to check whether it is working or not.

However, recently I noticed that IE9 has been using an unreleased version of the ActiveX component. I kept building and updating codes here and there, and apparently IE is grabbing that build version which is unreleased yet. The released version is available on the webserver, while the one i'm testing is not released yet as it is still incomplete.

Can anyone tell me how to prevent this from happening?

# java - Java：如何在 ActionListener 之后不断更新使用 atomicInteger 倒计时的 JLabel

> ID：10021969
> 
> 赞同：2
> 
> 时间：2012-04-05T02:38:01.743
> 
> 标签：java, swing, timer, jlabel, actionlistener

我正在阅读有关该主题的不同主题，这些主题建议使用[Swing Timer 类](https://stackoverflow.com/questions/6811064/jlabel-displaying-countdown-java)或[SwingUtilities.InvokeLater](https://stackoverflow.com/questions/2477155/how-to-update-jlabel-in-swing)

......但我很难绕过他们。

我使用**atomicInteger**创建倒数计时器，它在控制台中运行良好。但是，当我尝试将它合并到 Swing 中时，它只会更新开始和结束值（例如，设置 5 秒倒计时将显示在框架中：“5”-> 5 秒后->“0”。

有什么简单的方法可以让我**保持和“刷新”我的 atomicInteger 倒计时标签**，还是唯一的方法是使用 Swing Timer 类？

感谢您的耐心等待！

附言。不是作业，只是想让自己成为一个自定义的计时器来学习。（即拖延）

*我希望这节课就足够了，如果您还需要框架/面板代码，请告诉我。*

```
private class ClickListener implements ActionListener{

     public void actionPerformed(ActionEvent e){            
         int t_study = 5;
         atomicDown.set(t_study);

         if (e.getSource() == b_study){
             while(atomicDown.get() > 0){       
                t_study = atomicDown.decrementAndGet(); 
        l_studyTime.setText(Integer.toString(t_study));
             try {
                Thread.sleep(1000);
             }
             catch (InterruptedException e1) {
                 System.out.println("ERROR: Thread.sleep()");   
                 e1.printStackTrace();
             }
          }
     }
     else if(e.getSource() == b_exit){
         System.exit(0); 
     }
     else
         System.out.println("ERROR: button troll");
     }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T03:26:35.707

将代码片段转换为 SSCCE 后，这就是我得到的（这似乎有效 - 就我对原始代码的理解而言）。

我没有更改变量名称。请了解类、方法和属性名称的常见[Java 命名约定](http://java.sun.com/docs/books/jls/second_edition/html/names.doc.html#73307)^(1 ，并始终如一地使用它。)

1.  具体来说，like`b_study`的名称应该更接近`studyButton`或相似。有些人会注意到“按钮”不应该是名称的一部分，但是当您有一个带有“学习”按钮**和标签的 GUI 时，**我看不到任何其他合乎逻辑的方式来分隔它们。

* * *

```
import java.awt.event.*;
import javax.swing.*;
import java.util.concurrent.atomic.AtomicInteger;

class TimerTicker {

    public static final int STUDY_TIME = 15;
    AtomicInteger atomicDown = new AtomicInteger(STUDY_TIME);
    JButton b_study;
    JButton b_exit;
    JLabel l_studyTime;

    TimerTicker() {
        JPanel gui = new JPanel();

        b_study = new JButton("Study");
        ClickListener listener = new ClickListener();
        b_study.addActionListener(listener);
        gui.add(b_study);

        b_exit = new JButton("Exit");
        b_exit.addActionListener(listener);
        gui.add(b_exit);

        l_studyTime = new JLabel("" + atomicDown.get());
        gui.add(l_studyTime);

        JOptionPane.showMessageDialog(null, gui);
    }

    private class ClickListener implements ActionListener {

        Timer timer;

        public void actionPerformed(ActionEvent e){
            if (e.getSource() == b_study) {
                ActionListener countDown = new ActionListener() {

                    public void actionPerformed(ActionEvent ae) {
                        if (!(atomicDown.get() > 0)) {
                            timer.stop();
                            // reset the count.
                            atomicDown.set(STUDY_TIME);
                        } else {
                            l_studyTime.setText(
                                Integer.toString(
                                    atomicDown.decrementAndGet()));
                        }
                    }
                };
                timer = new Timer(1000,countDown);
                timer.start();
            } else if(e.getSource() == b_exit) {
                System.exit(0);
            } else {
                System.out.println("ERROR: button troll");
            }
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new TimerTicker();
            }
        });
    }
} 
```

# c - 指向结构的指针和数组的 malloc 内存的指针

> ID：10021970
> 
> 赞同：2
> 
> 时间：2012-04-05T02:38:09.240
> 
> 标签：c, pointers, malloc

我正在创建一个指向结构的指针，以在 C 中使用 malloc 创建一个动态数组，但我得到一个调用结构数组的分段错误。这是我的代码的简要说明：

```
#include <stdio.h>

typedef struct {
    int test1;
    int test2;
    }testStruct;

int main() {
    testStruct **neato;

    neato = (testStruct **) malloc( sizeof(testStruct *) * 5);
    // Array of 5 for convience

    // any neato[x]->testy call results in segmentation fault.
    scanf("%d", &neato[0]->test1);    // Segmentation fault

    return 0;
    } 
```

我尝试了其他调用，例如 (*neato)[0].test1 并且都导致分段错误。这显然不是正确的方法，否则我的 GNU 编译器已经严重过时。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T02:40:19.897

您已经为 5 个指针分配了足够的内存。但是，您尚未初始化指针，因此它们是垃圾。分配指针，然后继续初始化每个指针。

```
int elems = 5;

neato = malloc(sizeof(testStruct *) * elems);
for( i = 0; i < elems; ++i ) {
    neato[i] = malloc(sizeof(testStruct));
} 
```

附带说明一下，我认为这里不需要指针数组。为什么不简单地为 5 `testStruct`s 分配足够的空间（即`neato`变为 a `testStruct*`）并将该指针的地址传递给初始化它的函数？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:41:40.867

您不是`mallocing`必须添加的所有结构本身的空间

```
for(int i = 0; i < 5; i++) {
    neato[i] = malloc(sizeof(testStruct));
} 
```

在你 malloc 整齐之后。此外，您应该检查 malloc 的返回值，`NULL`以确保 malloc 已通过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T02:42:42.293

您分配了指针数组，但没有为这些指针分配有效地址。

如果您只想创建动态数组，只需使用指向结构的指针：

```
testStruct *neato;
neato = malloc( sizeof(testStruct) * 5);
scanf("%d", &neato[0].test1); 
```

# php - Image to server not uploading, PHP issue?

> ID：10021974
> 
> 赞同：0
> 
> 时间：2012-04-05T02:38:48.693
> 
> 标签：php, iphone, xcode, ipad

So I've mad an app to upload a image to a php server and its just not working. I click the upload button and nothing uploads. The directories don't matter, if i have to change them to make it work, i will. Thanks

HEres my code

```
//over here 
NSString *urlString = @"image8photo.com/photo/php.php";

// setting up the request object now
NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
[request setURL:[NSURL URLWithString:urlString]];
[request setHTTPMethod:@"POST"];

/*
 add some header info now
 we always need a boundary when we post a file
 also we need to set the content type

 You might want to generate a random boundary.. this is just the same 
 as my output from wireshark on a valid html post
 */
NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
[request addValue:contentType forHTTPHeaderField: @"Content-Type"];

/*
 now lets create the body of the post
 */
NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];    
[body appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"userfile\"; filename=\"ipodfile.jpg\"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[NSData dataWithData:imageData]];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
// setting the body of the post to the reqeust
[request setHTTPBody:body];

// now lets make the connection to the web
NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];

NSLog(returnString); 
```

}

@end

Php Script on servor

```
$uploaddir = '/storage/'; $file = basename($_FILES['userfile']['name']); $uploadfile =         $uploaddir . $file; if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {   echo "image8photo.com/storage {$file}"; } 
```

# ruby-on-rails - 在 fields_for 中使用“：”和“@”有什么区别

> ID：10021980
> 
> 赞同：6
> 
> 时间：2012-04-05T02:40:31.503
> 
> 标签：ruby-on-rails, forms

我正在我的 rails 应用程序中设置嵌入式表单。

这不起作用

```
<h1>PlayersToTeams#edit</h1>
<%= form_for @players_to_teams do |field| %>
  <%= field.fields_for @players_to_teams.player do |f| %>
    <%= f.label :IsActive %>
    <%= f.text_field :IsActive %>
  <% end %>
  <%= field.label :BT %>
  <%= field.text_field :BT %>
  <br/>
  <%= field.submit "Save", class: 'btn btn-primary' %>
<% end %> 
```

给我一个`ActiveRecord::AssociationTypeMismatch`错误。注意行`@players_to_teams.player`中的`forms_for`。

这确实有效：

```
<h1>PlayersToTeams#edit</h1>
<%= form_for @players_to_teams do |field| %>
    <%= field.fields_for :player do |f| %>
        <%= f.label :IsActive %>
        <%= f.text_field :IsActive %>
    <% end %>
    <%= field.label :BT %>
    <%= field.text_field :BT %>
    <br/>
    <%= field.submit "Save", class: 'btn btn-primary' %>
<% end %> 
```

注意线路`:player`中的呼叫`fields_for`。

使用符号和使用实例有什么区别？我想我会想在这种情况下使用一个实例，但我猜不是？

**编辑**

楷模：

```
class Player < ActiveRecord::Base
  has_many :players_to_teams
  has_many :teams, through: :players_to_teams
end

class PlayersToTeam < ActiveRecord::Base
  belongs_to :player
  belongs_to :team

  accepts_nested_attributes_for :player
end 
```

控制器：

```
class PlayersToTeamsController < ApplicationController
  def edit
    @players_to_teams=PlayersToTeam.find(params[:id])
  end

  def update
    @players_to_teams=PlayersToTeam.find(params[:id])
    respond_to do |format|
      if @players_to_teams.update_attributes(params[:players_to_team])
        format.html { redirect_to @players_to_teams, notice: 'Player_to_Team was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @players_to_teams.errors, status: :unprocessable_entity }
      end
    end
  end
end 
```

**示例项目**

Github：[https ://github.com/workmaster2n/embedded-form-errors](https://github.com/workmaster2n/embedded-form-errors)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T02:56:47.617

似乎`fields_for`无法弄清楚实例变量的`player`关联是什么。`@players_to_teams`您可以通过显式指定关联的名称（即`:player`）来绕过它。您是否在两个方向上定义关联？IE：

```
class PlayersToTeam < ActiveRecord::Base
  has_one :player
end

class Player < ActiveRecord::Base
  belongs_to :players_to_team
end 
```

此外，查看[的文档`fields_for`](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-fields_for)，第一个参数被称为`record_name`，所以看起来 Rails 期望的是关联的*名称*而不是关联本身。但是如果不进一步研究代码，很难准确地判断该方法的作用，并且他们的一些示例确实确实将关联直接传递到`fields_for`.

* * *

好的，我能够克隆您的示例项目并重现错误。我想我明白发生了什么。

在您调用 之后[`accepts_nested_attributes_for`](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html#method-i-accepts_nested_attributes_for)，您现在在模型上拥有一个名为 的实例方法`player_attributes=`。这是对通常为关联`player=`定义的方法的补充。`has_one`该`player_attributes=`方法接受属性的散列，而该`player=`方法只接受一个实际的`Player`对象。

这是您调用时生成的文本输入的示例`fields_for @players_to_teams.player`：

```
<input name="players_to_team[player][name]" ... /> 
```

这是调用时相同的输入`fields_for :player`：

```
<input name="players_to_team[player_attributes][name]" ... /> 
```

当您调用`update_attributes`控制器时，第一个示例将调用`player=`，而第二个示例将调用`player_attributes=`。在这两种情况下，传递给方法的参数都是散列（因为`params`最终只是散列的散列）。

这就是为什么你得到一个`AssociationTypeMismatch`：你不能将哈希传递给`player=`，只能传递一个`Player`对象。

似乎唯一安全的使用方式`fields_for`是`accepts_nested_attributes_for`传递关联的名称而不是关联本身。

因此**，要回答您最初的问题**，区别在于一个有效，另一个无效:-)

# django - How can I add avatar and hidden field to django idios

> ID：10021982
> 
> 赞同：2
> 
> 时间：2012-04-05T02:40:40.993
> 
> 标签：django, pinax

I'm using pinax, and using the idios which is the default profile apps for user profile. However, I don't know how to add my own logic. I know I can customize my own model, but the document seems too naive for me. Is there any method to extend idios, for example I want to add a hidden field in module, but I don't know how to change its value when submit the form. Also how can I add gravatar to idios?

Thank you.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T13:25:49.757

由于 Pinax 只是一个基于 Django 的项目，因此您只需从`idios.ProfileBase`模型继承并使用您自己的配置文件模型覆盖设置文件中的 AUTH_PROFILE_MODULE

## 您带有头像的个人资料

```
class ProfileWithAvatar(ProfileBase):
    """ Profile model with user avatar """
    avatar = models.ImageField(upload_to="uploads/")
    # and add fields whatever you want 
```

## 设置.py

```
...
AUTH_PROFILE_MODULE = 'MyApp.ProfileWithAvatar'
... 
```

享受，希望这对你有帮助。

苏丹，

谢谢

# jquery - 在 .click() 函数中使用 .live('click') 会触发自身

> ID：10021984
> 
> 赞同：0
> 
> 时间：2012-04-05T02:40:53.543
> 
> 标签：jquery, jquery-click-event

我正在尝试`$('body').live('click')`在用户单击 div 后添加一个侦听器。目的是创建一个自定义下拉框，用户可以通过单击页面上的任意位置来打开和最终关闭该下拉框。

但是当我在函数内部添加`.live()`或函数时，由于某种原因会触发该函数：`.bind()``.click()``live()`

```
$('#myDiv').click(function(){
    $('#myDiv .child').show().addClass('showing');
    $('body').live('click', function(){
           $('#myDiv .child').hide();
           $('body').die();
    })
}) 
```

`#myDiv``.showing`显示但立即隐藏，挥之不去的班级证明了这一点。

我用`live()`错了吗？如何避免这种递归？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:54:19.793

`return false`将停止事件传播：

```
 $('#myDiv').click(function(){
    $('#myDiv .child').show().addClass('showing');
    $('body').live('click', function(){
           $('#myDiv .child').hide();
           $('body').die();
    });
    return false;
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:44:35.517

使用没有实时的第二个正文点击绑定（你也不需要它，因为它总是在页面上）并使用超时：

```
$('#myDiv').on('click',function(){
    $('#myDiv .child').show().addClass('showing');
setTimeout(function(){
$('body').on('click', function(){
           $('#myDiv .child').hide();
           $('body').off('click');
    });
},0);

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T02:50:49.623

也许它应该起作用，也许它不应该。但事实并非如此。我建议在开始时设置所有事件处理程序，并且只使用一个全局变量（例如）来跟踪第二个事件处理程序是否应该实际响应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T02:51:24.497

您可能必须停止当前事件的传播，以防止它冒泡到您的新事件处理程序将看到它的主体。此外，您可以使用`.one()`一次性事件处理程序：

```
$('#myDiv').on('click',function(e){
    $('#myDiv .child').show().addClass('showing');
    e.stopPropagation();
    $(document.body).one('click', function() {
           $('#myDiv .child').hide();
    });
}) 
```

# git - 从 Git 钩子中排除提交？

> ID：10021987
> 
> 赞同：1
> 
> 时间：2012-04-05T02:41:14.560
> 
> 标签：git, github, githooks, travis-ci

是否可以排除某些提交被推送到 Github 上的服务挂钩？例如，如果我只编辑一个项目的 Readme 文件，那么在 Travis 上重新测试整个应用程序是没有意义的。有没有办法告诉 Git 那个特定的提交不应该被发送到 Travis 钩子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:52:12.037

没有办法告诉`git push`跳过钩子。但是，您可以修改挂钩以检查收到的提交，并且仅在源文件已被修改时才运行测试。你如何做到这一点取决于你的项目，但它可以查找具有特定扩展名的文件、`src/`目录中的文件等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T10:41:33.993

回答与 Travis 相关的部分：如[Travis 文档](http://about.travis-ci.org/docs/user/how-to-skip-a-build/)中所述，如果您附加`[ci skip]`到要推送的任何提交，则可以跳过构建。

# javascript - JPG 图像未出现在动态 Web 项目的 JSP 中

> ID：10021990
> 
> 赞同：5
> 
> 时间：2012-04-05T02:41:34.353
> 
> 标签：javascript, eclipse, jsp

我正在尝试在我在 Eclipse Indigo IDE 中创建的动态 Web 项目中使用以下 index.jsp 文件中的图像。我在项目文件夹的 WebContent 下的 WEB-INF/images/pict1.jpg 下添加了图像。但是当我在浏览器中运行时，图像不可见。文本和提交按钮按预期出现。我错过了什么吗？关于如何使图像出现的任何想法？

任何帮助将不胜感激。下面是代码。

谢谢，

索姆纳特

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>
<%@ taglib uri="/WEB-INF/tld/c.tld" prefix="c" %> 
```

```
<html> 
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">

<c:import url="/WEB-INF/javascript/index.js" />

<title>My Page</title>
</head>
<body>
<img alt="picture1" src="images/pict1.jpg">
<table border="0">
<tr><td valign="top">
<h1>Continue</h1></td><td><input type="submit"></td></tr>
<tr><td valign="top">
<h1>Continue</h1></td><td><input type="submit"></td></tr>
</table>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-05T02:48:10.823

image 'src' 属性是相对于你的 web 应用程序的上下文根的。图像不进入 WEB-INF。将“图像”文件夹移动到项目的“WebContent”文件夹中。

WEB-INF 通常保留用于容器使用的项目元数据。您的应用程序 jsps 和其他资源通常位于相对于 WebContent 文件夹的文件夹中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T02:49:37.720

根据 Oracle 的[这份](http://docs.oracle.com/cd/E12840_01/wls/docs103/webapp/configurewebapp.html)文件：

> WEB-INF 目录不是应用程序公共文档树的一部分。WEB-INF 目录中包含的任何文件都不能由容器直接提供给客户端。

文件夹中包含的`WEB-INF`文件无法通过 URL 访问。如果您使用的是 Eclipse，请将`pict1.jpg`图像放入其中，`WebContent/images`以便您的 JSP 指向有效位置。

# android - 如何使用水平滚动视图？

> ID：10021993
> 
> 赞同：0
> 
> 时间：2012-04-05T02:41:55.513
> 
> 标签：android, xml, layout

我希望我的应用程序能够水平滚动，以便它可以在页面之间滑动。但是当我在 android sdk 上使用此功能时，它不会让我让 xml 布局填充父级，即它不会让我有一个全屏来包含我的按钮和对象。

关于如何解决此问题或什么是替代方法的任何想法？

这是代码：

```
<?xml version="1.0" encoding="utf-8"?>
<HorizontalScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <RelativeLayout
        android:layout_width="348dp"
        android:layout_height="559dp" >

        <ImageButton
            android:id="@+id/imageButton1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:layout_marginBottom="341dp"
            android:layout_marginLeft="146dp"
            android:src="@drawable/ic_launcher" />

    </RelativeLayout>

</HorizontalScrollView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T02:48:00.637

将相对布局更改为 LinearLayout。与垂直 ScrollView 类似，它使用了 LinearLayout。

这是我在一个项目中的示例布局：

```
<HorizontalScrollView
            android:id="@+id/horizontalScrollView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:scrollbars="none" >

            <LinearLayout
                android:id="@+id/LinearLayout1"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:orientation="horizontal" >

                <Button
                     android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="@string/class_tab" />

                <Button
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="@string/exam" />

                <Button
                    android:id="@+id/button_more"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="@string/more" />

            </LinearLayout>
        </HorizontalScrollView> 
```

# jquery - 向 iframe 提交表单？

> ID：10021994
> 
> 赞同：0
> 
> 时间：2012-04-05T02:41:57.863
> 
> 标签：jquery, iframe, file-upload, submit

谁能告诉我我在以下代码中做错了什么，表单没有提交到 iframe？

```
$(function() {
    $(".preview").click(function() {
        $('#sliderimage').wrap('<form action="/index/upload.php" method="post" id="imageform" target="imageupload" />');
        $('#imageform').submit();
        $('#sliderimage').unwrap();
        return false;
    });
});​

<iframe style="display: none;" name="imageupload" id="imageupload"></iframe>
<input type="file" id="sliderimage" name="sliderimage">
<input type="button" class="preview" value="Preview"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:03:29.710

我马上看到了两个问题，不确定它们是否能解决问题。

您已将“类型”设置为`post`。这个属性应该是`method`。

您还需要在表单上设置 enctype。

```
$(function() {
    $(".preview").click(function() {
        $('#sliderimage').wrap('<form action="/index/upload.php" method="post" id="imageform" target="imageupload" enctype="multipart/form-data" />');
        $('#imageform').submit();
        $('#sliderimage').unwrap();
        return false;
    });
});​ 
```

# 编辑

上面的代码是从您的源代码直接剪切和粘贴的......这意味着 'hidden'(â€‹) 字符 jsfiddle 粘贴到您的 javascript 中也在那里。删除它，你的 js 将起作用。要做到这一点，只需在你的 js 代码末尾退格一次。

# c# - 使用舒适的代码为结构上的数组赋值

> ID：10021995
> 
> 赞同：1
> 
> 时间：2012-04-05T02:42:09.207
> 
> 标签：c#, arrays, struct, indexing

这个想法很简单。为商店的“部门”创建一个结构，给它一个用于命名的变量（一个名为“部门”的字符串），以及一个用于保存在该部门完成的所有购买的数组。

现在，我希望每次在特定部门保存购买时，它都会根据部门名称和购买金额自动应用折扣。

现在，示例类：

```
class Program
{
    struct Departments
    {
        public string Department;
        private double[] _buys;

        public double[] Buys
        {
            get { return _buys; }
            set
            {
                if (value > 100)
                {
                    if (Department == "CLOTH")
                    _buys = value * .95;
                    if (Department == "FOOD")
                    _buys = value * .90;
                    if (Department == "OTHER")
                    _buys = value * .97;
                }
                _buys = value;
            }
        }
    }

    static void Main()
    {
        var departments = new Departments[3];
        departments[0].Department = "CLOTH";
        departments[1].Department = "FOOD";
        departments[2].Department = "OTHER";
        departments[0].Buys = new double[5];
        departments[0].Buys[0] = 105;
    }
} 
```

注意这一行`departments[0].Buys[0] = 105`，这就是我想保存购买的东西的方式，“代码简单”......

现在，注意`Buys`结构的属性，它是一个“数组属性”。然后，当我使用`value > 100`条件时，它给出了一个明显的错误，不能从`double`to 转换`double[]`。

问题......我怎样才能为 写一个正确的条件`value > 100`，必须在结构上放置什么才能实现这一点？

我已经尝试过使用“索引器”，但只要我尝试过，我就无法让它以`departments[0].Buys[0] = 105`正确的方式通过分配。

请注意，我想保留这个模式，特别是为了方便简单地说`departments[0].Buys[0] = 105`购买

编辑：

前面的结构“部门”仅用于示例目的。我不会回答如何通过另一种方式来拥有正确的“部门”，我想要一个关于如何使 set 参数对数组的各个元素起作用的答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:21:24.687

另一种可能的解决方案是为 _buys 数组创建另一个类：

```
class Buys
{
    private double[] _buys;

    public Buys (int capacity)
    {
        _buys = new double[capacity];
    }

    public double this[int index]
    {
        get { return _buys; }
        set 
        {
            if (value > 100)
            {
                if (Department == "CLOTH")
                    value = value * .95;
                if (Department == "FOOD")
                    value = value * .90;
                if (Department == "OTHER")
                    value = value * .97;
            }
            _buys = value;
        }
    }
}

struct Departments
{
    public string Department;
    public Buys Buys;
}

static void Main()
{
    var departments = new Departments[3];
    departments[0].Department = "CLOTH";
    departments[1].Department = "FOOD";
    departments[2].Department = "OTHER";
    departments[0].Buys = new Buys(5);
    departments[0].Buys[0] = 105;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T03:03:38.300

您最好使用 a`List<double>`来记录购买情况。这样列表可以动态增长。您还可以使用索引来获取列表元素。

您可以使用字典简化折扣代码。

对于这些数据，您最好使用 a `class`，而不是 a `struct`。 `Struct`s 通常更适合用于不可变值。使类代表一个部门并在其中存储适当的折扣。

所以是这样的：

```
class Program
{
    class Department
    {
        public string Name;
        public double Discount;

        private List<double> _buys = new List<double>();

        public List<double> Buys
        {
            get { return _buys; }
        }

        public void AddBuy(double value)
        {
            _buys.Add(value > 100 ? value * discount : value);
        }
    }

    static void Main()
    {
        var departments = new List<Department>();
        departments.Add(new Department { Name = "CLOTH", Discount = 0.95 });
        departments.Add(new Department { Name = "FOOD", Discount = 0.90 });
        departments.Add(new Department { Name = "OTHER", Discount = 0.97 });
        departments[0].AddBuy(105);

        Console.WriteLine(departments[0].Buys[0]);
    }
} 
```

我还有很多其他方法可以改进这个设计，但这应该能让你继续前进。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T03:31:56.497

你可以做这样的事情

```
public class Departments
{
    public string Department;
    public MyList buys;
    public Departments()
    {
        buys = new MyList(this, 5);
    }
}
public class MyList
{
    private double[] backingList;
    private Departments owner;
    public MyList(Departments owner, int size)
    {
        this.owner = owner;
        backingList = new T[size];
    }

    public double this[int index]
    {
        get{ return backingList[index]; }
        set { backingList[index] = discountFor(owner.Department) * value; }
    }

    private float discountFor(string department)
    {
        switch(department)
        {
        case "department1":
            return 0.5f;
        //...
        default:
             return 1.0f;
        }
    }

} 
```

但是，通过将折扣放入设置器自身，您并没有保持良好的关注点分离。更好的代码看起来像

```
departments[0].Buys[0] = DiscountFor("department1") * 105; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T03:05:48.150

通过你的错误，你可以做这样的事情。

```
struct Departments
    {
        public string Department;
        private double[] _buys;
        public double[] Buys
        {
            get { return _buys; }
            set
            {
                for (int i = 0; i < value.Length; i++)
                {
                    if (value[i] > 100)
                    {
                        if (Department == "CLOTH")
                            _buys[i] = value[i] * .95; if (Department == "FOOD")
                            _buys[i] = value[i] * .90; if (Department == "OTHER")
                            _buys[i] = value[i] * .97;
                    }
                }
                _buys = value;
            }
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T03:11:16.517

您可以创建一个方法来执行这样的设置：

```
 public double[] Buys { get; set; }

        public void SetBuy(int index, double value)
        {
           if (value > 100)
           {
              if (Department == "CLOTH")
               value = value * .95;
              if (Department == "FOOD")
               value = value * .90;
              if (Department == "OTHER")
               value = value * .97;
           }
           _buys[index] = value;
        } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-07T21:17:17.590

包含对可变项的可变引用的结构通常是一个坏主意，因为这种结构最终会表现出值和引用语义的奇怪组合。例如，应该是什么效果：

```
  部门 dep1,dep2;
  ...
  dep1 = dep2;
  dep1.Department = "布料";
  dep1.Buys[5] = 123;

```

这样的声明将或应该影响`dep2.Buys[5]`. 如果给定结构的`Buys`字段/属性总是引用同一个数组，这样的语义可能是可以容忍的，但是如果数组需要调整大小会发生什么？

# copy - Xcode 复制/粘贴元素并丢失情节提要视图

> ID：10021996
> 
> 赞同：1
> 
> 时间：2012-04-05T02:42:11.567
> 
> 标签：copy, storyboard, paste

当我在按下 command-v（粘贴）后立即在情节提要中复制和粘贴元素时，我被导航离开情节提要，并且每次都必须向后导航。我不确定它发生了什么，但任何帮助将不胜感激。通过谷歌搜索，但所有回复似乎都被删除或网站不存在。再次感谢。

# django - 使用 db 中的数据预填充 formset_factory

> ID：10021997
> 
> 赞同：1
> 
> 时间：2012-04-05T02:42:23.210
> 
> 标签：django, django-forms, django-views

我正在尝试制作一个应该使用现有值进行推广的编辑表单。虽然我预先填充了所有字段，但是外键字段给了我一个问题。

这是我的forms.py

```
def make_bowling_form(teamid, fixtureid):
    class BowlingForm(forms.Form):
        player = forms.ModelChoiceField(
            queryset=PlayerShortlist.objects.filter(
                team = teamid,
                fixture = fixtureid
            )
        )
        overs = forms.FloatField(initial=0.0)
        runs = forms.IntegerField(initial=0)
        wickets = forms.IntegerField(initial=0)
    return BowlingForm 
```

和views.py

```
@login_required
def edit_bowling(request, team_id, fixture_id):
    template = get_template('cricket/edit_bowling.html')
    if Team.objects.get(id=team_id) == Team.objects.get(owner=request.user):
        matchscorecard = InningsCard.objects.get(team = team_id, fixture = fixture_id)
        bowlers = BowlingDetail.objects.filter(innings = matchscorecard)
        bowlingforms = formset_factory(
            make_bowling_form(team_id, fixture_id),
            extra=0,
        )
        bowlingforms = bowlingforms(initial = bowlers.values())
        page_vars=Context({
            'loggedinuser': request.user,
            'bowlers': bowlers,
            'bowlingforms': bowlingforms,
        })
    else:
        error = "You dont have permission to add score for this team"
        page_vars=Context({
            'loggedinuser': request.user,
            'error': error
        })
    crsfcontext = RequestContext(request, page_vars)
    output = template.render(crsfcontext)
    return HttpResponse(output) 
```

它正确地给了我所有的值，除了外键字段。t 进一步调查我继续并打印了 bowlers.value()

```
[{'runs': 32, 'innings_id': 1, 'wickets': 1, 'player_id': 3, 'overs': 4.0, 'id': 1}, {'runs': 21, 'innings_id': 1, 'wickets': 3, 'player_id': 4, 'overs': 4.0, 'id': 2}, {'runs': 19, 'innings_id': 1, 'wickets': 3, 'player_id': 2, 'overs': 4.0, 'id': 3}] 
```

我的模板给了我..

```
<select name="form-0-player" id="id_form-0-player">
<option value="" selected="selected">---------</option>
<option value="37">AC</option>
<option value="38">AD</option>
<option value="39">DD</option>
<option value="40">LF</option>
<option value="41">22</option>
<option value="42">dkja</option>
</select> 
```

在这种情况下选择的值是 ------------ .. 它应该是我选择的值，但我的 Bowlers.value 没有给我一个名字.. 它给了我一个 id。

我该如何纠正这种情况？

//鼠

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:10:06.247

使用`ModelForm`和`instance`（或`queryset`用于表单集）：

```
def make_bowling_form(teamid, fixtureid):
    class BowlingForm(forms.ModelForm):
        class Meta:
            model = Bowling

        player = forms.ModelChoiceField(
            queryset=PlayerShortlist.objects.filter(
                team = teamid,
                fixture = fixtureid
            )
        )
    return BowlingForm 
```

和

```
BowlingFormSet = modelformset_factory(
    make_bowling_form(team_id, fixture_id),
    extra=0,
)
bowlingforms = BowlingFormSet(queryset=bowlers) 
```