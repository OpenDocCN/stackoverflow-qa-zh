# StackOverflow 问答 000630000-000630999

# c# - 在 Silverlight/WPF 中将元素前移（Z 索引）

> ID：630006
> 
> 赞同：37
> 
> 时间：2009-03-10T12:53:44.540
> 
> 标签：c#, wpf, silverlight, xaml

我在网上找到的所有用于设置 Z-Index 以在 Silverlight 中引入元素的文档和示例都使用 Canvas 元素作为容器。

我的项目是 DataTemplate 中 ItemsControl 容器内的 Border 元素。我正在使用 MouseEnter 和 MouseLeave 事件来触发 ScaleTransform.ScaleX 和 ScaleTransform.ScaleY 上的动画，因此它们在悬停时会增长。由于它们已调整大小并与容器中的其他项目占用相同的空间，因此最近添加的项目与旧项目重叠（与当前调整大小的项目相反）。有没有一种干净的方法可以在我触发动画的代码中将当前项目向前移动，以便它们在调整大小时与所有其他项目重叠？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-06-22T18:25:25.417

我不得不处理这个。

假设您有一个 ItemsControl，其 ItemTemplate 设置为自定义控件的实例。在该控件中，您执行 Canvas.SetZIndex(this, 99)。它不起作用，因为“this”不是 ItemsControl 的 ItemsPanel 的直接子级。ItemsControl 为每个项目创建一个 ContentPresenter，将其放入 ItemsPanel，并在 ContentPresenter 中呈现 ItemTemplate。

所以，如果你想在你的控件中改变 ZIndex，你必须找到它的 ContentPresenter，然后改变它的 ZIndex。一种方法是...

```
 public static T FindVisualParent<T>( this DependencyObject obj )
        where T : DependencyObject
    {
        DependencyObject parent = VisualTreeHelper.GetParent( obj );
        while ( parent != null )
        {
            T typed = parent as T;
            if ( typed != null )
            {
                return typed;
            }
            parent = VisualTreeHelper.GetParent( parent );
        }
        return null;
    }
                ContentPresenter foo = this.FindVisualParent<ContentPresenter>();
            Canvas.SetZIndex( foo, 99 ); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-10T16:37:39.463

在 WPF 中，您可以在触发器中设置[Panel.ZIndex](http://msdn.microsoft.com/en-us/library/system.windows.controls.panel.zindex.aspx)属性：

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid.Resources>
        <x:Array x:Key="colors" Type="{x:Type Color}">
            <Color>Green</Color>
            <Color>Red</Color>
            <Color>Blue</Color>
            <Color>Orange</Color>
            <Color>Yellow</Color>
            <Color>Violet</Color>
        </x:Array>
        <DataTemplate DataType="{x:Type Color}">
            <Border x:Name="brd" Height="20" Width="20">
                <Border.Background>
                    <SolidColorBrush Color="{Binding}"/>
                </Border.Background>
                <Border.RenderTransform>
                    <ScaleTransform CenterX="10" CenterY="10"/>
                </Border.RenderTransform>
                <Border.Style>
                    <Style TargetType="{x:Type Border}">
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderThickness" Value="2"/>
                                <Setter Property="BorderBrush" Value="Black"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                <Border.Triggers>
                    <EventTrigger RoutedEvent="Border.MouseEnter">
                        <BeginStoryboard>
                            <Storyboard>
                               <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="brd" Storyboard.TargetProperty="RenderTransform.ScaleX" To="1.5"/>
                               <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="brd" Storyboard.TargetProperty="RenderTransform.ScaleY" To="1.5"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                    <EventTrigger RoutedEvent="Border.MouseLeave">
                        <BeginStoryboard>
                            <Storyboard>
                               <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="brd" Storyboard.TargetProperty="RenderTransform.ScaleX" To="1"/>
                               <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="brd" Storyboard.TargetProperty="RenderTransform.ScaleY" To="1"/>
                            </Storyboard>
                        </BeginStoryboard>
                  </EventTrigger>
                </Border.Triggers>
            </Border>
        </DataTemplate>
    <Style TargetType="{x:Type ContentPresenter}">
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Panel.ZIndex" Value="99999"/>
            </Trigger>
        </Style.Triggers>
    </Style>
    </Grid.Resources>
    <ItemsControl ItemsSource="{StaticResource colors}" Margin="20" Width="40">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <WrapPanel/>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
    </ItemsControl>
</Grid> 
```

在`Style`for`ContentPresenter`我们将 设置`Panel.ZIndex`为 99999`IsMouseOver`时`true`。它必须在 the`ContentPresenter`而不是 the`Border`因为`ContentPresenter`s 是`ItemsControl`'s 面板的子项。

不幸的是，我认为这家酒店还没有进入 Silverlight...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-25T15:46:27.303

首先找到其所有子元素的最大 ZIndex，然后设置新的 ZIndex。

```
private int MaxZIndex()
{
    int iMax = 0;
    foreach (UIElement element in JIMSCanvas.Children)
    {            
        int iZIndex=Canvas.GetZIndex(element);
        if(iZIndex>iMax)
        {
            iMax = iZIndex;
        }
    }
    return iMax+1;
} 
```

然后赋值

```
Canvas.SetZIndex(child, MaxZIndex()); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-21T19:08:59.360

对于使用 Grid 作为 LayoutRoot 的控件，您可以像在控件本身中那样做一些简单的事情：

```
Canvas.SetZIndex(this, 999); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-10T15:15:15.010

首先，附加属性 Zindex 在[Canvas](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas_attachedproperties(VS.95).aspx)中定义，因此在 Panel 的其他衍生产品中不可用。

ItemsControl 根据列表的顺序对子元素进行排序。堆栈底部的第一个项目和顶部的最后一个项目。有了这个，您所要做的就是确保所选项目位于列表的底部。

首先为排序创建一个接口。像这样：

```
interface IOrderable
    {
        int theZOrder{get;set;}
    } 
```

现在在您展示的课程中实现这一点。

当你想把一个项目带到最前面时，给它一个大的数字，给所有其他的小数字。

剩下的就是实际的排序。添加这样的东西，你就设置好了：

```
ItemsCont.ItemsSource = 
            ItemsCont.Items.OrderByDesc(t=>((IOrderable)t).theZOrder); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-11-01T12:39:32.967

以这种方式设置元素的 zIndex

```
var zIndex = 
    ((Panel) element.Parent)
    .Children.Cast<UIElement>()
    .Max(child => Canvas.GetZIndex(child))
    ;

zIndex++;

Canvas.SetZIndex(element, zIndex); 
```

*   也许您需要检查 zIndex 是否等于 int.MaxValue 然后重置“ZIndex”。
*   但这几乎不会发生

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-07-30T09:05:57.727

Html 的工作方式相同。如果要分层排列，所有列表项都必须是同级的。

我扩展了上面的代码，以便它在找到（例如）一个 ItemsPresenter 时停止。如果 ContentPresenter 没有在此处和 ItemsPresenter 之间显示，那么请使用我的原始代码。

```
void setZindex(MyLayeredType layeredObj, int index) 
{
    ContentPresenter sibbling = 
    FindVisualParent<ContentPresenter, ItemsPresenter>(layeredObj);
    if (sibbling != null)
    {
        sibbling.SetValue(Canvas.ZIndexProperty, index);
    }
    else
    {
        layeredObj.SetValue(Canvas.ZIndexProperty, index);
    }
}

public static T FindVisualParent<T,C>(this DependencyObject obj)
where T : DependencyObject
where C : DependencyObject
{
    DependencyObject parent = VisualTreeHelper.GetParent(obj);
    while (parent != null)
    {
        T typed = parent as T;
        if (typed != null)
        {
            return typed;
        }
        C ceiling = parent as C;
        if (ceiling != null)
            return null;
        parent = VisualTreeHelper.GetParent(parent);
    }
    return null;
} 
```

# programming-languages - 为什么逻辑编程没有流行起来？

> ID：630007
> 
> 赞同：25
> 
> 时间：2009-03-10T12:54:00.857
> 
> 标签：programming-languages, prolog, logic-programming

随着时间的推移，函数式编程似乎对其他编程语言的影响越来越大。我们在我的 AI 课程中开始使用 Prolog，似乎有一些东西可以让非 AI 领域的编程变得更容易。我的问题是：为什么逻辑编程没有以同样的方式流行起来？

在本[主题](https://stackoverflow.com/questions/145489/should-logic-techniques-be-blended-into-mainstream-programming)中，似乎达成了普遍共识，即逻辑编程是有用的，但必须证明这一点。它没有被视为有用的原因吗？

**更新**：也许我应该更清楚一点。我并不是真的在问 Prolog。我明白为什么在大多数实际应用程序中选择 Prolog 不是一个好主意。

举一个我正在谈论的更多示例，请考虑 Python 中的列表推导/映射/过滤器。这些显然受到函数式语言的影响。为什么像 Python 这样的语言还没有像函数式语言那样从逻辑编程语言中吸取这些东西？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-10T14:16:32.313

当您使用 Prolog 在计算机科学课程中学习逻辑编程时，重点不是让您成为精通的 Prolog 程序员，而是让您对其他形式的编程技术（数据结构/算法）敞开心扉。 d 之前没有考虑过。

当我开始学习计算机科学时，为了说明我的观点，我的工程学校曾经要求所有学生用 Pascal 编写他们的软件程序，但自从我毕业后，我什至从未使用过 Pascal。但是我通过选择正确的数据结构和算法学到的技能我仍然每天都在使用。

Pascal 并没有作为我所知道的语言出现在我的简历中，但它对我作为软件工程师的培训很有帮助。它的有用性不能仅通过当前生产的 Pascal 代码行数来衡量。

当您开发软件时，您会意识到，即使您没有编写一行 Prolog 代码，您有时也会重复使用您在参加过的这些“无用”Prolog 或 AI 课程中首次学习的技术.

评估一项技术（特定的编程语言、特定的软件工具/应用程序）的有用性不仅仅是评估其实际使用水平，而是评估其影响力。

如果你看看逻辑编程在专家系统、电脑游戏人工智能、空中交通管制领域以及可能相当多的其他领域（有人建议吗？）我认为它不能说是逻辑——编程还没有流行...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-14T09:54:04.973

在我的编程生涯中，我花了大约 4 年的时间研究基于规则的“专家系统”，用于根据客户要求为电话交换机配置和配置硬件。

它非常成功，据我所知，10 多年后仍在日常使用。但是找到能够理解其工作原理的程序员是比开发系统本身更大的任务。

我认为这就是这种方法没有成功的原因，因为与能够理解过程和函数式编程概念的人数相比，很少有人具备基于逻辑编程的必要思维方式。

逻辑编程语言提供了一种机制，用于将事实和推理规则输入“推理引擎”，然后启动该“推理引擎”以将规则应用于给定的事实以产生新的事实。特定逻辑语言的成败取决于其特定推理引擎的实力。

Prolog 的推理引擎的实现非常幼稚，效率非常低。只需在循环中编写大量 if 语句，在大多数过程语言中就可以更有效地解决相同的问题。

我们为“配置器”选择的语言是 DEC 的 RuleWorks，它是对更广为人知的 OPS5 语言的改进。这有一个基于[Rete 算法](http://en.wikipedia.org/wiki/Rete_algorithm)的推理引擎，这使得它比程序方法更有效。

自从 DEC 被 Compaq 吞并被 HP 吞并后，RuleWorks 已经开源，可以[从这个网页](http://www.ruleworks.co.uk/)获得。

遗憾的是，人们对这些技术没有更多的兴趣，因为它们可以非常有效地解决各种原本难以解决的问题。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-10T13:41:57.670

我对普通 Prolog 的印象是它是一种玩具语言。这并不是说逻辑编程没有用。例如，在[Twelf](http://twelf.plparty.org/)中，可以很容易地为简单的编程语言声明语义，并让声明充当解释器。我还听说过一些关于[λProlog](http://www.lix.polytechnique.fr/~dale/lProlog/)的好消息。

我认为尝试将逻辑编程语言用作通用语言的问题是某些任务不太适合这个概念。我认为逻辑编程特性需要整合到一种同时具有命令式和函数式构造的语言中。至少有一种这样的语言：[Oz](http://en.wikipedia.org/wiki/Oz_(programming_language))，但我还没有尝试过。

编辑：有一个想法我想尝试一段时间：将关系数据库作为原子提供给 Prolog，并使用它来执行查询而不是 SQL。我觉得这将是对 SQL 的巨大改进。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-30T03:58:44.603

我最近在一个游戏设计 AI 研究项目中使用了一堆逻辑编程（[预告视频](http://www.youtube.com/watch?v=0BcF1d8I1CE)！），但我的逻辑繁重的项目中至少有一半是实现基本游戏引擎的函数式或命令式 Scala 代码。 **编程的重点**，如果我可以这么说的话，**就是让机器对你想要的东西的理解与你自己**的同步——而大多数同步*需要*在某种程度上给出你想要的东西的*命令式*细节完毕。那些愚蠢的机器总是那么的字面意思……

逻辑编程，无论是传统的、演绎的、序言风格的东西，还是更具异国情调的归纳逻辑编程或答案集编程风格，都以能够轻松传达命令式知识（这在现实世界的应用程序中总是需要*某个地方）。*有时，交互式应用程序的顾虑会使您在表达命令式知识时的工作效率受到最轻微的影响，这是不可接受的。以逻辑编程风格编写整个游戏引擎总是一个坏主意（同样使用具有相同计算能力的 perl 兼容正则表达式来尝试它）。在混合语言中（或者可以让你轻松嵌入逻辑解释器的语言）你可以两全其美（我用过[jTrolog](https://java.net/projects/jtrolog)将 Prolog 嵌入到我的 Scala 引擎中，形成各种多范式 voltron）。

我认为逻辑编程肯定会更受欢迎和更容易理解，但是从某种意义上说，纯逻辑编程在“流行”方面并不能比 SQL 或正则表达式做得更好，因为它的魔力来自于带走你的命令式表达（理想情况下，让您不会迷失在不重要的细节中）。这种解释几乎同样适用于函数式编程。我喜欢逻辑编程，但这只是因为我可以选择何时使用它。最好的前进方式似乎是以一致、精心设计的方式呈现选择的混合语言。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-10T13:38:42.870

我对 Prolog 的第一个问题是它不是一种逻辑编程语言。它缺乏“真”、“假”和“不知道”的三值标准逻辑，将后两者混为一谈。也就是说，这两个真值实际上是“可以显示”和“不能显示”。这给 Prolog 的“非”概念带来了真正的问题，这对于逻辑推理来说是非常基本的。

在正常逻辑中，通过否定命题来证明命题是完全合理的，这被称为“reductio ad absurdum”。（是的，有些人试图在不使用它的情况下重建数学，但这有点深奥。）这在 Prolog 中根本不起作用，因为证明错误和未证明任何东西之间没有区别。

因此，当我在 Prolog 中做一个课堂项目时，每当我认为它是编程逻辑时，我就遇到了麻烦。我总是会做一些需要实际否定的事情。也许其他人不这样做，但我最终认为它是一种模式匹配语言，然后完成项目几乎没有困难。

不可能有一个真正的基于逻辑的语言，程序员可以编写东西并真正依赖结果。一阶谓词演算（即，具有变量的逻辑、真或假函数、“和”、“或”、“非”、“对于所有”和“存在”）是肯定不可判定的。（毕竟，我们不断向数学家倒咖啡而不是机械地生成所有可能的定理是有原因的。）即使程序员已经知道，程序员也无法先验地知道给定命题是否会被证明它是真还是假。

编辑：我也忘记了正确排序条款的关键必要性。在逻辑上，你写下东西的顺序并不重要。在 Prolog 中，我不断陷入无限循环，直到我不再将其视为基于逻辑的语言。同样，它作为一种模式匹配语言有一些不错的特性，但它不符合逻辑，在我看来，它就像一门语言中的一匹小马。YMMV，但其他一些人似乎同意我的观点。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-10T14:13:34.240

当我们学习 prolog 时（仅在编程语言课上学习了几周，所以我几乎不是专家），教授还指出，根据您的定义，逻辑编程实际上可能根本不是编程。

当我们说编程时，我们通常指的是“向计算机发出一系列任务或指令”之类的东西。这就是命令式或函数式编程语言所做的。这就是每一种“真正的”编程语言所做的。Prolog 或逻辑编程并没有真正做到这一点。它更像是 SQL。您可以向计算机提出很多问题。它会根据您之前提供的数据尽其所能回答，但与其他编程范例不同，您并没有真正告诉计算机该做什么。

它只是非常专业，不适合通用编程。而且它专门*用于*的东西并不经常需要。

另一方面，函数式编程绝对是通用编程，可以用于任何事情，没有大问题。这就是为什么后者正在流行，而逻辑编程却没有。我认为... ：）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-10T13:02:14.020

函数式编程变得越来越流行，因为它在应用于多线程编程时具有一些重要的好处，并且随着我们越来越多地转向多核处理器，多头编程将变得越来越重要。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-10T12:56:01.883

根据我自己使用 Prolog 的经验，它非常适合特定任务，但作为一种通用编程语言，在我看来它根本不像许多其他语言那样灵活。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-10T13:18:20.643

事实上，Prolog 非常适合特定任务，但在我 11 年的工作经验中，我从来没有遇到过 Prolog 是最佳解决方案的问题。只是 Prolog 理想的问题非常罕见。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-10T13:36:30.910

当我在大学的 AI 课程中学习 Prolog 时，我发现它绝对令人着迷，但我只能想到今天在 AI 之外使用它的少数几种情况。即使在那些情况下，我也不愿意使用它。我花了很长时间才最终“获得” Prolog，当我这样做时，我认为它很棒，但我立即发现它的用处有限。

尽管如此，我还是强烈建议学习它，如果没有其他原因，只是为了学习以另一种不同的方式进行编程。能够从许多不同的角度看待问题绝对会让你成为一个更好的程序员。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-10T13:49:48.383

这是为工作使用正确工具的标准案例。您确实会在某些情况下看到逻辑编程：它们通常被称为基于规则或专家系统之类的东西。

在您的[可计算性理论课程中](http://en.wikipedia.org/wiki/Computability_theory_(computer_science))，您将讨论所有这些通用语言实际上是等效的这一事实（从数学的角度来看）。然而，原型设计和长期开发是非常不同的领域。因此，在基于规则的系统中，您完全有可能使用 Prolog 之类的东西来制定规则集（如果这对您很有效），然后在您的交付平台（例如 Java）上实现最终系统。

顺便说一句，我一直很喜欢 Prolog 对几乎所有事情的回答都是“不”的方式。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-10T13:31:18.943

您在*AI*课程中开始使用 Prolog 的事实应该是一个提示。人工智能也没有很好地流行起来。

我记得在 80 年代挑战一位教授展示 AI 的重要用途（好吧，“嘲笑”是一个更准确的术语，但那时我还年轻）。当时他做不到，今天，我怀疑他在教书大约是他当时大肆宣传的人工智能应用程序的 1/10。

也许这同样适用于 Prolog。我不记得上次看到一家公司寻求 Prolog 经验是什么时候了。也许从来没有，或者也许我看到它并忽略了它。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-10-28T10:19:02.783

在这个讨论线程中有调用真正声明性的逻辑编程语言（语句可以按任何顺序进行），并且可以用于查询数据库作为 SQL 的替代品。

[Datalog](http://en.wikipedia.org/wiki/Datalog)正是您所寻找的。例如，它用于数据集成、安全应用程序和程序分析。

# javascript - 底部浮动工具栏，居中，当前屏幕宽度的 80%

> ID：630017
> 
> 赞同：1
> 
> 时间：2009-03-10T12:55:49.870
> 
> 标签：javascript, html, css

我正在尝试在屏幕底部为我目前正在处理的网站实现类似 Facebook 的工具栏。

目前，我拥有 100% 的屏幕宽度，但我希望它看起来几乎完全像 Facebook 的工具栏，居中，底部对齐在顶部，大约是当前屏幕宽度的 80%。

这是我拥有的工具栏的当前 CSS，它是屏幕宽度的 100%。

提前致谢。

CSS：

```
<style type="text/css">
#toolbar
{
background:url('/_assets/img/toolbar.gif') repeat-x;
height:25px;
position:fixed;
bottom:0px;
width:100%;
left:0px;
border-left:1px solid #000000;
border-right:1px solid #000000;
z-index:100;
font-size:0.8em;
}   
</style> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T13:02:18.653

采用：

```
left:10%;
right:10%; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T13:03:36.560

```
width: 80%;
left: 10%;
right: 10%; 
```

怎么样？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-08T03:30:21.577

CSS：

```
#container {
    width: 100%;
}
#toolbar {
    width: 80%;
    height: 40px;
    margin-right: auto;
    margin-left: auto;
} 
```

html:

```
<div id="container">
  <div id="toolbar"></div>
</div> 
```

# c# - 设置环境以测试多台打印机

> ID：630018
> 
> 赞同：0
> 
> 时间：2009-03-10T12:55:56.360
> 
> 标签：c#, .net, printing

我必须修改当前将文档打印到单个打印机的现有打印解决方案（.NET 2.0，C#），以便它可以打印到具有故障转移功能的多台打印机（如果一台打印机停机，它使用备用打印机） . 我需要创建一个开发人员环境（以及后来的系统测试环境）来模拟多打印机设置。我不能使用模拟框架，因为必须创建实际的打印作业并将其发送到打印机作为测试的一部分。如果可以以某种方式保存或记录生成的打印作业，例如`print job 1 was received by printer 2`.

您对如何创建此设置有任何指示吗？我已经在研究使用`Print To File`选项，但任何其他信息将不胜感激。非常感谢您的回复。

问候，安迪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T17:34:55.253

最初的答案是使用虚拟打印监视器，例如来自 [AlphaTronics的](http://www.alphatronics.net/)[这个](http://www.alphatronics.net/AVPMon.html)。使用该选项，我可以设置多个指向文件系统上不同文件夹的虚拟打印机，即 Printer1 将文件打印到 C:\temp\Folder1，Printer2 将文件打印到 C:\temp\Folder2 等。使用此设置-起来，然后我可以模拟 LIVE 环境并编写测试等，以确定是否打印了正确的打印机（即在正确的文件夹中生成了一个文件）。将 .PRN 扩展名附加到生成的文件中，我还可以使用诸如[PCL Reader](http://www.pclreader.com/)之类的工具查看打印文件。`File to Print`

希望这对其他人有帮助。

问候，安迪。

# php - 在我的站点中使用 PHPBB2 登录凭据

> ID：630027
> 
> 赞同：3
> 
> 时间：2009-03-10T12:57:37.900
> 
> 标签：php, login, credentials, phpbb

我目前正在为我的一个站点的一部分使用 PHPBB2 论坛，并且我想扩展这个站点（添加新页面、脚本等）。我想限制已经登录 PHPBB2 论坛的用户访问这些页面。

事实上，如果只有某个 MemberGroup 的成员可以访问这些页面，那就太好了。

有没有办法在我的网站的其余部分使用相同的登录凭据，并检查成员来自哪些组？

谢谢

（顺便说一下，这些页面是 PHP 的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T13:29:04.127

使用 PHPBB2 的用户表以及其他页面中的登录和权限代码。它很脏，但它有效。

通过使用 PHPBB2 的代码，我的意思是：

深入研究 PHPBB2 的代码，弄清楚 PHPBB2 如何验证用户，并复制相关的代码块。如果 PHPBB2 结构合理，您可以只在 PHPBB2 中包含几个文件并使用它们，而无需大量的 hack 工作。如果它的结构不好，它将变得又脏又丑。

不要忘记测试您网站的新安全添加项！确保你得到正确的黑客攻击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T14:01:41.130

如果用户登录到 PHPBB，则很有可能（尽管并非总是如此），然后他们将拥有一个 cookie，您可以读取该 cookie 并帮助检查谁与数据库相对。

在这种情况下，您需要打破以下 cookie 的碎屑：

```
$_COOKIE["phpbb2mysql_data"] 
```

让我们举个例子，把它吹出来找到我们需要查询数据库的数据。以下是在上述 cookie 中找到的块：

```
a:2:{s:11:"autologinid";s:0:"";s:6:"userid";s:1:"3";} 
```

为此，您需要进入并提取恰好对应于已登录 PHPBB 用户的“3”。

[反序列化该数据](http://au.php.net/unserialize)以提取该 user_id：

```
 $goo = unserialize($_COOKIE["phpbb2mysql_data"]);
 $extracted_id = $goo["userid"]; 
```

（感谢[epochwolf](https://stackoverflow.com/users/16204/epochwolf)指出该 cookie 的上述序列化形式）

该数字可以很好地针对数据库运行以检查成员所属的组。然后您将对`phpbb_user_group`表格进行检查（如果您将 phpbb_ 作为论坛表格的前缀。）

如果您不想跟踪数据库中的组 ID，那么您将需要进行某种连接并针对名称进行测试。也许是这样的：

```
SELECT pug.user_id FROM phpbb_user_group pug 
 LEFT JOIN phpbb_groups g 
 ON pug.group_id=g.group_id
 WHERE pug.user_id='$extracted_id'
 AND g.group_name='Foo'; 
```

如果您可以从中抽出一行，那么您已经发现自己是属于该 Foo 组的登录用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T14:10:40.237

您可以直接使用 phpBB 2 的用户和组表。我记得，密码列只是实际密码的 md5() 。

这个技巧在 phpBB3 中不再有效，因为密码（最终）是加盐的。

# zend-framework - Zend Studio 报告警告：分配条件。这有那么糟糕吗？

> ID：630035
> 
> 赞同：9
> 
> 时间：2009-03-10T12:59:45.307
> 
> 标签：zend-framework, warnings, while-loop, variable-assignment, conditional-statements

我最近开始使用 Zend Studio，它报告了以下类型的代码警告：

```
$q = query("select * from some_table where some_condition");
while ($f = fetch($q)) {
  // some inner workings
} 
```

要停止警告，代码需要这样编写：

```
$q = query("select * from some_table where some_condition");
$f = fetch($q);
while ($f) {
  // some inner workings
  $f = fetch($q);
} 
```

为什么这被标记为警告？有这么糟糕吗？

我了解该警告可能旨在阻止此类错误：

```
$a = 1;
while ($a = 1) {
  // some inner workings
  $a++;
} 
```

它永远不会终止，因为 1 被分配给 $a，而 $a 又将 1 返回给 while 语句，而不是针对 $a 进行测试并在 $a 不为 1 时返回 false 给 while 语句。

容易犯的错误可能会验证警告，已授予，但是忘记在第二个示例中的 while 块末尾添加额外的 $f = fetch($q) 也会导致永远不会终止的循环. 如果我更改我的代码以删除警告，然后忘记在 while 块的末尾添加 $f = fetch($q) Zend 不会发出警告！

因此，通过删除有关常见错误的警告，我将自己设置为另一个常见错误。

出锅，入火。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-04-05T04:53:05.417

```
while (($row = $sql->db_Fetch("MYSQL_ASSOC")) != false) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-12-10T09:49:26.473

因此，您不必在没有正当理由的情况下重写所有代码：您可以在**Window |中禁用对这种潜在编程错误的检测。首选项，PHP | 语义分析**。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-10T13:04:22.063

这可能被标记为警告，因为人们在表示“==”时经常会错误地使用“=”。

例如：

```
$a = 1
while($a = 1) {
   $a++;
} 
```

这永远不会终止，但如果你认为你已经写了“==”，它应该会。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-24T12:59:02.617

Zend Studio 正试图帮助您编写更容易调试的更好的代码。禁用语义检查不是一个好主意，它只会将潜在的问题扫到地毯下，而您将错过真正的问题。这是一个正当的理由！不要通过忽略它们来避免警告消息，通过实施正确的解决方案来修改您的代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-11T23:57:38.643

众所周知，Zend Studio 是基于 Eclipse 构建的，Eclipse 是一个 Java IDE。在 Java 语言中，这样做是非法的：

```
String s;
while (s = getName()) {
    ...
} 
```

这是因为即使“getName”返回一个空值，它也会被分配给“s”，并且对象和布尔值（这是条件语句所需的类型）之间的转换与 PHP 一样有点主观，因此它会抛出一个编译时异常。

PHP 中的情况可能有所不同，但出于某种原因，Zend 开发人员决定默认保持此警告处于活动状态，您可以如前所述禁用它，但我认为它会在发生真正的条件分配时为您提供帮助。

只需分配结果然后像这样比较它，清除警告就很容易了：

```
if (($result = $mysqli->query ( $query )) == true) { 
```

代替：

```
if ($result = $mysqli->query ( $query )) { 
```

如您所见，您不需要额外的代码束。

无论如何这只是一个警告，你不必太担心他们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-28T08:59:05.537

实际上，我想您的问题已经在某种程度上得到了回答。但是为了解决您的实际问题，我认为这可能会有所帮助。

```
//i dont know what is returned if there are no more records to fetch...
//but lets assume it is a boolean value
while (($f = fetch($q))!= false)
{
    $this->doSomethingVeryImportantThatMakesYourBossHappy($f);
} 
```

这应该可以解决问题，并且“条件分配”消息应该消失。

作为旁注：使用等于运算符的方式与否定事物时的方式相同。您还可以将等号与其他运算符一起使用，例如

```
if ($falseness != false){$trueness = true} 
```

并不是

```
if ($falseness ! false){$trueness = false} 
```

这有助于我始终记住如何比较值而不是为它们分配值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T13:13:39.733

它不好的原因是很多人在表示“==”时使用“=”

= 运算符会将分配返回到左侧，因此如果您使用 if`if($x=true)`中的代码将运行，如果您使用`if($x=false)`代码将不会运行。这是一个巧妙的技巧，可以节省一两行代码，但它也很危险，因为如果你是认真的`if($x == false)`并输入`if($x = false)`了它，那将是一个难以追踪的错误。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-09-30T18:36:28.670

不，我的朋友，条件中的*所有*作业都会生成此警告。我不想完全关闭它，因为 = 而不是 == 是我容易出现的语法错误。至于为什么有必要的问题，我将使用 PHP 手册中的一个示例。这是来自“MySQL 改进”扩展或 mysqli 的部分：

```
$query = "SELECT Name, CountryCode FROM City ORDER by ID DESC LIMIT 50,5";

if ($result = $mysqli->query($query)) {

    /* fetch associative array */
    while ($row = $result->fetch_assoc()) {
        printf ("%s (%s)\n", $row["Name"], $row["CountryCode"]);
    } 
```

不幸的是，我已经使用这种技术开发了我的数据库函数，并试图在 Zend Studio 中使用它们。这个错误已经出现了足够多的时间来成为一个真正的痛苦。我将在这里重新提出建议，因为我重视明确的代码，但是我也会跳到 PHP 手册并建议他们更改示例以使用更好的样式。也许你们中的一些人可以这样做，我们可以改进文档？！

# c# - 如何改变存根的行为？

> ID：630037
> 
> 赞同：18
> 
> 时间：2009-03-10T12:59:50.640
> 
> 标签：c#, unit-testing, rhino-mocks

我可以在运行时更改存根的行为吗？就像是：

```
 public interface IFoo { string GetBar(); }
    [TestMethod]
    public void TestRhino()
    {
        var fi = MockRepository.GenerateStub<IFoo>();
        fi.Stub(x => x.GetBar()).Return("A");
        Assert.AreEqual("A", fi.GetBar());
        fi.Stub(x => x.GetBar()).Return("B");
        Assert.AreEqual("B", fi.GetBar());    // Currently fails here
    } 
```

我的代码示例在给定行中仍然失败，`fi.GetBar()`仍然返回`"A"`.

或者是否有另一个技巧来模拟行为随时间变化的存根？我宁愿不诉诸使用`fi.Stub(...).Do(...)`.

啊，可能我只需要精美手册的硬拷贝，以便有人用它打我的头。看起来应该很明显，但我找不到。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-10T13:24:35.120

**警告**

*改变存根的行为是一种代码味道！*

它通常表明您的单元测试太复杂、难以理解并且很脆弱，在对被测类进行正确更改时很容易崩溃。

查看：

*   [xUnit 测试模式][1]
*   [单元测试的艺术][2]

所以，请：**只有在无法避免的情况下才使用此解决方案**。在我看来，这篇文章几乎是一个糟糕的建议——但是在极少数情况下你真的需要它。

* * *

啊，我自己想通了。Rhino 支持录制/回放模式。虽然 AAA 语法始终将对象保持在重放模式，但我们可以切换到记录并返回重放，以清除存根的行为。

它看起来有点hackish，但是......

```
 public interface IFoo { string GetBar(); }
    [TestMethod]
    public void TestRhino()
    {
        var fi = MockRepository.GenerateStub<IFoo>();
        fi.Stub(x => x.GetBar()).Return("A");
        Assert.AreEqual("A", fi.GetBar());

        // Switch to record to clear behaviour and then back to replay
        fi.BackToRecord(BackToRecordOptions.All);
        fi.Replay();

        fi.Stub(x => x.GetBar()).Return("B");
        Assert.AreEqual("B", fi.GetBar());
    } 
```

*更新：*

我将来会使用它，所以看起来会更好一些：

```
internal static class MockExtension {
    public static void ClearBehavior<T>(this T fi)
    {
        // Switch back to record and then to replay - that 
        // clears all behaviour and we can program new behavior.
        // Record/Replay do not occur otherwise in our tests, that another method of
        // using Rhino Mocks.

        fi.BackToRecord(BackToRecordOptions.All);
        fi.Replay();
    }
} 
```

# c# - 使用例如 Linq-To-Xml 时处理空引用

> ID：630041
> 
> 赞同：8
> 
> 时间：2009-03-10T13:00:41.183
> 
> 标签：c#, null, linq-to-xml, extension-methods

是否有更好/更短的方法来处理（大量）空引用，例如当我使用 LinqToXML 时。

我为 XElement 编写了这个扩展，它可以很好地处理它，但也许还有另一种方法？

那么函数名呢？“和”并不是真正的描述性。

```
public static class XmlExtentions
{
    public static T And<T>(this T obj, Func<T, T> action) where T : XElement
    {
        return obj == null ? obj : action(obj);
    }
}

internal class Program
{
    private static void Main()
    {
        //create example xml element
        var x = 
          XElement.Parse("<root><find><name>my-name</name></find></root>");

        //old way
        var test1 = x.Element("find");
        if (test1 != null) test1 = test1.Element("name");
        Console.WriteLine(test1);

        //using the extentions method
        var test2 = x.Element("find").And(findme => findme.Element("name"));
        Console.WriteLine(test2);

        Console.ReadLine();
    }
} 
```

PS：我知道我可以在这个示例中使用 XPath，但在更复杂的情况下并非总是如此。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T13:09:55.327

总体方法是合理的 - 尽管我不确定`Func<T,T>`这似乎有点限制。如果您限制返回相同的东西，我想知道是否只接受名称 ( `string`) 作为第二个参数会不会更容易？

重新命名 - 也许是从 LINQ 借来的？这本质上是一个`Select`- 怎么样`SelectOrDefault`：

```
public static TResult SelectOrDefault<TSource, TResult>(
    this TSource obj, Func<TSource, TResult> selector) where TSource : class
{
    return SelectOrDefault<TSource, TResult>(
        obj, selector, default(TResult));
}

public static TResult SelectOrDefault<TSource, TResult>(
    this TSource obj, Func<TSource, TResult> selector,
    TResult @default) where TSource : class
{
    return obj == null ? @default : selector(obj);
} 
```

（编辑）也许有额外的`XElement`具体：

```
public static XElement SelectOrDefault(
    this XElement element, XName name)
{
    return element == null ? null : element.Element(name);
} 
```

# unit-testing - 使用输入参数存根对象

> ID：630042
> 
> 赞同：0
> 
> 时间：2009-03-10T13:00:48.173
> 
> 标签：unit-testing, testing, matlab, tdd, stub

因此，我正在尝试存根数据库连接器以便为其编写测试。问题是数据库连接器是一个非常薄的层，对它的查询有点开放。我希望我的代码能够从数据库中请求一个变量，并且连接器应该可以接受。此调用的签名如下所示：

```
dim = getDimension(self,dimensionName,otherIndentifyingInformation) 
```

（这一切都在 MATLAB 中——希望答案与语言无关，或者至少在 MATLAB 中不是不可行的。）

当我在我的代码中使用它时，`dimensionName`它是存储在数据库中的少数东西之一。如果代码调用它，但它不存在，那很好。这里的问题是我想测试一些对 进行两次调用的代码，`getDimension`例如：

```
alt = conn.getDimension('alt',otherID);
str = conn.getDimension('str',otherID); 
```

出于（希望）显而易见的原因，`alt`并且`str`不保证相同。事实上，它们通常不是。

所以，我的问题。如果我想存根 getDimension 以返回良好的测试值，我该怎么做？创建`getDimensionAlt`似乎很笨拙，因为可以从数据库中出来的东西的数量是无限的，维护起来会很痛苦。有没有比将逻辑放入我的存根对象更好的方法？这似乎是错误的处理方式......

编辑：建议设置一个 testDB。那么我不是必须为每个测试用例设置一个 testDB 吗？在每个测试中，我都必须创建一个数据库连接，将其作为存根返回，运行测试，然后清理数据库连接。这似乎对每个测试来说都是很多开销，尤其是当它甚至不是我正在测试的系统时。

我想可以设置一个 testDB，并每次都用适当的值填充它。这是好习惯吗？

编辑2：也许我的问题不清楚。我有一小段代码正在尝试测试。它并不比上面那两行复杂多少，我想干净利落地测试一下。问题是存根`getDimension`调用取决于参数。我不需要将此存根与其他测试重用。

I think the answer might be "It's OK to have simple logic in your stubs." This is all confounded by the fact that there's no anonymous classes or stubbing framework in MATLAB, so that's hard, but I want to make sure what I'm doing is conceptually clear before I go off and write a stubbing framework in MATLAB.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T13:06:00.143

Could you set up a a test database with known values and then perform a known set of queries against it (with known expected return values)?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T13:43:26.840

I think setting up a testdb is a good idea if you're doing automated integration tests or acceptance tests. This usually calls for tests where you test the whole stack (UI, application, database, services etc.) at once.

Unit testing is quite different, they are used during development and not during testing, therefore they should be quicker to run, quicker to change and quicker to write. Its usually a good idea to have unit tests only depend on the small piece of code they're testing. This makes them less brittle, easier to understand and makes developers more willing to run them often.

Using stubs in unit tests is a good idea. The problem you seem to run in to is that if you want to reuse stubs for many tests their behaviour can get very complex, in the worst case you're rebuilding the thing they are supposed to stand in for. This can also happen if you are testing too much at one time.

The solution to this is to have more smaller stubs that only implement the behaviour for one or a few tests and have your tests only test a single behaviour. Tests that test lots of behaviour at once are useful too but they're not unit tests, you should move them to your integration test suite (and can run on a real database). I'm not sure about matlab but in many languages you have mocking frameworks you can use to handle creating stubs and setting up behaviour for you.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T16:50:03.037

My answer on a similar question [Creating mock data for unit testing](https://stackoverflow.com/questions/595926/creating-mock-data-for-unit-testing/595965#595965):

> You can have Builder class(es) that helps you building the instances you need / in this case ones you would use related to the repository. Have the Builder use appropiate defaults, and on your tests you can overwride what you need. This helps you avoid needing to put have every single case of "data" mixed up for all the different tests (which introduces problems, because usually there are cases that aren't compatible for different tests).
> 
> Update 1:Take a look at www.markhneedham.com/blog/2009/01/21/c-builder-pattern-still-useful-for-test-data

Also check this answer, on the overall unit test relation to external systems: [How can I improve my junit tests](https://stackoverflow.com/questions/589603/how-can-i-improve-my-junit-tests/589620#589620)

Note there is an alternative using in-memory databases like dbunit. I prefer the builder, for the reasons mentioned in the later link.

# xaml - 将 Autocad DXF 转换为 Microsoft XAML

> ID：630043
> 
> 赞同：4
> 
> 时间：2009-03-10T13:00:53.353
> 
> 标签：xaml, dxf

任何人都有一个好的，最好是便宜和简单的方法来做到这一点？我得到的最接近的是将文件保存为 .SVG 并使用 Inkscape 将其转换为 XAML。所有行等都转换得很好，但所有文本都只是文档顶部的一堆文本。我还尝试将 DXF 导入 Adob​​e Illustrator 并使用 Mike Swansons AI 到 XAML 导出插件，但这对我的文件不起作用。我只是说“无法保存”之类的话。

更新：

我测试了 Visio，我无法让它读取单个 DXF 文件。最终我下载了 AutoCAD LT，用 2 行、一个框和一些文本绘制了一个绘图。将其保存为所有可用格式并尝试将所有文​​件导入 Visio。不去。我真的很想知道 Visio 如何声称它支持 DXF 文件。

我测试了 3D PaintBrush，我怀疑它只适用于 3D 模型。我的绘图是简单的 2D 绘图，带有一些线条、框、路径和一些文本。

我很确定 Zam 3D 也只会导入 3D 对象，但我将对其进行测试（即使我认为我之前已经尝试过）。

大多数转换工具的链接都已过时，剩下的少数是 3D 工具。我今天能够转换 PDF 文档，但这也只是将文本导出为路径而不是文本对象（我真的需要）。

我还研究了 BAML（二进制 Xaml），似乎在 .Net 4 中对创建和使用 BAML 的支持会非常好，因为它在 3.5 中几乎不存在。但我想如果我设法正确转换文件，它们将足够小，可以作为 XAML 文件处理（我现在尝试过的文件转换为 3.5 mb 并且加载速度非常慢）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-26T13:13:02.407

对..一个新的后续行动。我真的必须解决这个问题，因为我们需要使用 Silverlight 在网页上显示 AutoCAD 的技术图纸。

我之前最成功的尝试是使用 Illustator 和 Mike Swansons 导出插件。我再次尝试了这个解决方案，现在我的转换成功率达到了 100%。我不知道是因为我使用的是最新的 Adob​​e Illustrator、更新了导出插件还是因为我使用的绘图与以前不同；但它有效。

所以，简而言之：

*   下载并保存导出插件到 Adob​​e Illustrator 插件文件夹
*   使用 Adob​​e Illustrator CS5 打开 AutoCAD 绘图
*   使用 Mike Swansons 优秀的工具[链接文本导出到 xaml](http://www.mikeswanson.com/xamlexport/ "关联")

嘿 presto，xaml 可以通过 silverlight 应用程序动态下载和显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T13:10:02.240

如果您有 Microsoft Visio，则可以使用[VisioExportToXAML](http://www.codeplex.com/VisioExportToXAML)。我知道 Visio 可以导入 DXF，但我还没有尝试过转换为 XAML 的工具。

[此页面](http://blogs.msdn.com/mswanson/articles/WPFToolsAndControls.aspx)列出了一些其他 WPF 工具，包括[ZAM 3D](http://www.zam3d.com/)，它被特别提到能够将 DXF 转换为 XAML。 [同一博客上的这篇文章](http://blogs.msdn.com/mswanson/archive/2006/11/28/more-wpf-conversion-tools-including-vb6-to-xaml.aspx)提到了更多（但链接似乎刚刚被破坏）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-24T02:54:40.473

[Open Design Alliance .Net API](http://www.opendwg.org/the_oda_platform/dwgdirect.net)也具有AutoCAD - SVG 导出功能。Firefox 呈现 SVG（显然）。我还没有尝试过，但它可能是将 AutoCAD 图形导入浏览器的一种方法。让我们知道你的进展。

DXF 兼容性随版本控制而变化。AutoDesk 可能与 DWG 一样频繁地还原 DXF。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-01T19:04:05.770

如果您有权访问 AutoCAD，则当前版本（2010 和更高版本）可以打印为基于 XAML 的 DWFx 格式，并且可以使用 Silverlight 进行查看。

# java - 如何编写 java 调试器命令行工具 (jdb) 脚本？

> ID：630044
> 
> 赞同：2
> 
> 时间：2009-03-10T13:01:03.163
> 
> 标签：java, ruby, debugging, jdb

如何使用诸如 ruby​​ 之类的脚本语言来驱动调试会话？有没有比使用[Expect](http://en.wikipedia.org/wiki/Expect)或带有脚本语言的类似模块更简单的选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T13:25:20.033

您可以通过[JPDA](http://java.sun.com/javase/6/docs/technotes/guides/jpda/index.html) API使用[JRuby](http://jruby.codehaus.org/)来驱动您自己的调试器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-13T18:47:26.280

查看[jdiscript](https://github.com/jfager/jdiscript)；它是 JDI 的精简脚本前端，可与 Java、JRuby 或任何其他 jvm 语言一起使用。

# linq - LINQ：点表示法与查询表达式

> ID：630045
> 
> 赞同：60
> 
> 时间：2009-03-10T13:01:03.460
> 
> 标签：linq, .net-3.5, lambda

我开始使用一般的 LINQ（到目前为止 toXML 和 toSQL）。我看到有时有两种或多种方法可以达到相同的结果。举这个简单的例子，据我所知，两者都返回完全相同的东西：

```
SomeDataContext dc = new SomeDataContext();

var queue = from q in dc.SomeTable
        where q.SomeDate <= DateTime.Now && q.Locked != true
        orderby (q.Priority, q.TimeCreated)
        select q;

var queue2 = dc.SomeTable
        .Where( q => q.SomeDate <= DateTime.Now && q.Locked != true )
        .OrderBy(q => q.Priority)
        .ThenBy(q => q.TimeCreated); 
```

这个想法是有两种方式来表达同一件事；我知道第一种方法有一些局限性，“点符号”更完整，但除此之外，还有其他优点吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-03-10T13:14:12.837

“点”表示法通常称为 Lambda 语法。第一个符号有多个名称，但我通常将其称为查询语法。

我在一个由 10 名开发人员组成的团队中工作，我们详细讨论了应该使用哪个标准。通常，经验更丰富（使用 LINQ）的开发人员会迁移到 Lambda 语法，但也有明显的例外。

Lambda 更简洁，但执行多个表连接是一场噩梦。使用查询语法，连接更加简洁。另一方面，有许多 LINQ 操作只存在于 Lambda 语法中：Single()、First()、Count() 等。

所以，使用你觉得最舒服的东西，并意识到随着你获得经验，你的偏好可能会改变。能够同时阅读两者都有很大的价值，而且肯定会有一些情况下您必须同时使用两者。其他情况会更倾向于一种风格而不是另一种风格。最后，它们都被翻译成相同的可执行代码。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-10T13:40:00.857

我根据具体情况使用对我的查询更具可读性的语法。

在可能的情况下，我尽量避免将两者混合和匹配，尽管*有时*这没关系（`First()`例如，如果它是在查询结束时的一次调用）。延迟执行意味着使用查询表达式并将结果分配给变量，然后使用该变量使用点表示法*同样*有效：

```
var query = from x in y
            orderby z
            group x by x.Name into groups
            // etc
            select foo;

var page = query.Skip(50).Take(10); 
```

正如其他人所说，查询表达式只是在没有查询表达式的情况下翻译成“普通”C# 3，所以这样做没有任何惩罚。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-10T13:07:16.100

好吧，“点”符号可以短得多。拿：

```
var result = from p in dc.Products
             where p.Id > 5
             select p; 
```

或者：

```
var result = dc.Products.Where(p => p.Id > 5); 
```

我更喜欢后者，因为它更短，更易读。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-19T13:11:44.797

我发现 Lambda 表示法更整洁、更简洁。我只是觉得烦人的是，如果你在方法调用中的**任何地方**都有一个 Lambda 表达式，你就不能在调试模式下动态修改代码......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-10T13:10:00.693

它们编译成相同的代码，或者更确切地说，第一个代码首先被翻译成第二个，然后编译。

你是对的，区别在于第一个版本更干净但更有限。例如，在第二个中，您可以使用已经存在的委托，例如：

```
Func<int, bool> isEven = i => i%2 == 0;
Enumerable.Range(10).Where(isEven).ToList().ForEach(Console.WriteLine); 
```

# .net - WPF 中 WinForms Control.Invoke 的等价物是什么？

> ID：630046
> 
> 赞同：4
> 
> 时间：2009-03-10T13:01:29.483
> 
> 标签：.net, wpf, winforms

我用什么代替

```
Me.Invoke 
```

当我使用 wpf 时？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-10T13:06:32.497

您将在 WPF 中使用 Dispatcher.Invoke。

[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.invoke.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T13:03:22.723

刚在谷歌上看过

[找到这个](http://adventuresdotnet.blogspot.com/2008/11/wpf-what-happened-to.html)

# django - 如何安全地更新实时网站

> ID：630047
> 
> 赞同：7
> 
> 时间：2009-03-10T13:01:39.233
> 
> 标签：django, deployment, schema, versioning

我们有一个相当简单的基于 Django 的网站来进行 CRUD 操作。我一直在本地进行测试和开发，然后在测试完成后将版本和数据库架构更改检查到实时服务器上。我们最近在发布某些类型的更改时遇到了问题。想象以下事件序列：

1.  用户打开 Web 表单
2.  网站已更新以要求此表单上的新字段
3.  用户提交他们一直在处理的表单
4.  服务器返回错误，因为它希望接收在步骤 2 中添加的新字段

其他网站如何处理此类问题？我的想法：

*   **在进行更新时使站点脱机。**这并不能真正解决问题，因为用户在提交之前可能会无限期地打开 Web 表单，但是在一定时间之后，任何人都不太可能提交表单。
*   **在非常低的流量时间进行自动更新。**同样，这并不能真正解决问题，但我们的网站并不那么受欢迎，如果我们在凌晨 3:00 进行更新，我怀疑会有很多用户。这种技术的一个问题是自动更新失败。
*   **对表单进行版本控制**，以便服务器识别正在提交的旧表单并提供对用户更友好的响应。是否有自动化工具可以帮助解决这个问题？

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:12:02.697

更改已发布的 API（或 UI，在这种情况下）总是很棘手。如果可能，请保持向后兼容性。对于大多数形式，我认为功能不会在版本之间发生变化。您可以添加或删除一两个字段，但这将由后端的表单验证处理。这基本上就是您在第 4 步中所描述的内容。我真的不认为这是什么大问题。运行时错误不时发生——只要您的应用程序优雅地处理它并通知用户问题，那么真的没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T14:02:02.380

如果这确实是一个大问题，您可以将代码版本作为某种隐藏变量包含在每个表单中。如果提交的版本与当前运行的应用程序版本不匹配，您可以显示适当的错误，并让他们填写表单上可能存在的任何新字段。您甚至可以更进一步，只显示表单已更改的消息。可能根据表单的定义创建某种散列，并将其用作隐藏字段。如果哈希错误，您就知道他们提交的表单不正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T18:54:14.143

做到这一点的“正确”方法是拥有定义明确的视图来优雅地处理整个故障类别。如果需要向模型添加一个新字段（我假设这是正在发生的事情），视图应该使用 ValidationError 异常处理该异常，该异常会引发友好的错误消息并将用户发送回表单（ ，重新加载时，应该有可用的新字段）。无论向模型添加什么字段，异常都会抛出一个干净的错误并将用户返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T13:57:46.930

如果没有在验证中编码发生更新的可能性，我看不出如何实现这一点。例如。“预期”该字段在提交时可能已更改，并相应地设置默认值/拒绝。

随着维护窗口的临近，如何“缩减”提交内容，以最大限度地减少那些让浏览器保持打开状态的用户？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T14:32:57.407

我使用的许多网站（当然，主要是在我的工作地点内部）都宣布了类似“我们将在本周末从周六下午 6:00 到周日早上 6:00 进行维护。请计划那时离开系统。” 虽然它并不完美，但没有什么是完美的，这似乎是一个好方法。只需腾出足够的时间来推出新的东西，对其进行测试，并在需要时回滚到旧的。如果您觉得有必要，您总是可以设置一个简单的页面，上面写着“抱歉，我们现在不可用”，并在停机期间将人们引导至该页面。一般来说，如果你不需要你最初所说的所有时间并且你早早回来，没有人会抱怨（也许那些想要借口逃避工作的懒鬼是个例外，但他们

# ruby - soap4r 自定义标题

> ID：630050
> 
> 赞同：3
> 
> 时间：2009-03-10T13:02:42.583
> 
> 标签：ruby, documentum, soap4r, documentum-dfs

我一直在使用soap4r并尝试使用SOAP::Header::SimpleHandler，我试图让它在传出消息上放置一个自定义标头，但我不知道如何让它包含属性而不是子元素：

```
 class ServiceContext < SOAP::Header::SimpleHandler
  NAMESPACE = "http://context.core.datamodel.fs.documentum.emc.com/"
  def initialize()
    super(XSD::QName.new(NAMESPACE, 'ServiceContext'))
    XSD::QName.new(nil, "Identities")
  end

  def on_simple_outbound
    username = "username"
    password = "password"
    docbase = "Test"
    return {"Identities" => {"Username" => username, "Password" => password, "Docbase" => docbase}}
  end
end 
```

返回：

```
 <n1:ServiceContext xmlns:n1="http://context.core.datamodel.fs.documentum.emc.com/"
        env:mustUnderstand="0">
      <n1:Identities>
        <n1:Username>username</n1:Username>
        <n1:Password>password</n1:Password>
        <n1:Docbase>Test</n1:Docbase>
      </n1:Identities>
    </n1:ServiceContext> 
```

我需要它返回的是以下内容：

```
 <ServiceContext xmlns="http://context.core.datamodel.fs.documentum.emc.com/">
        <Identities xsi:type="RepositoryIdentity" userName="_USER_" password="_PWD_" repositoryName="_DOCBASE_" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
    </ServiceContext> 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T18:22:09.680

soap4r 不是很漂亮。我在 rdocs 上一探究竟，看起来解决问题的最简单方法是`on_simple_outbound`返回要创建的元素的字符串表示形式。

所以而不是

```
return {"Identities" => {"Username" => username, "Password" => password, "Docbase" => docbase}} 
```

尝试

```
%Q(<Identities xsi:type="RepositoryIdentity" userName="#{user}" password="#{password}" repositoryName="#{docbase}" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>) 
```

使用类似builder的东西，你可以让它看起来更红，但试试看。

另一种选择是研究较新的肥皂库。[洗手液](http://github.com/troelskn/handsoap/)看起来很有趣。

# asp.net - 在我的 ASP.NET 应用程序中强制执行许可条款

> ID：630052
> 
> 赞同：0
> 
> 时间：2009-03-10T13:03:23.283
> 
> 标签：asp.net, licensing

我有一个 ASP.Net 应用程序，它托管在我公司客户内部网络上的 Web 服务器上。

我希望执行各种已知的许可条款（到期日期/用户数量等）

我打算使用一个加密的 xml 文档，其中包含作为键/值对的术语，并将其作为加密的平面文本文件存储在 Web 服务器上。

然后，我计划使用自定义安全 Httpmodule 来解密加密文件，并将术语提取并存储在内存中（应用程序？），然后在应用程序相关区域的每个页面请求期间强制执行这些术语。

是否有更好的方法来执行 Web 应用程序的许可条款？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T13:15:47.153

我选择了一条不同的路线：我只是将许可信息放在数据库中的加密字段中，这样我就不必担心 Httpmodule。SQL Server 具有 EncryptByKey 和 DecryptByKey 函数，可以很容易地获取/放置加密数据。我还使用了一个简单的密码密钥来使整个过程非常易于管理。我很欣赏你的方法——它真的很聪明——但我认为你让自己的生活有点太难了！

就安全性而言，只要您实际上不提供源代码，这是相对安全的。唯一的缺点是他们可能会反汇编您的代码以尝试提取密码或其他加密技术（这可能也适用于您的 Httpmodule 方法）。然而，这*并不是*我担心的事情，因为我主要与财富 500 强公司合作，并且我与他们签订了包含“禁止拆卸”条款的法律协议。绝大多数公司根本不会为了获得一些额外的功能或扩展他们的数据库而这样做而冒着法律危险。另一方面，如果您要分发给数以千计的匿名用户，那么情况可能就不同了。

更新：如果您不使用 SQL Server，您还可以使用某种形式的基于代码的加密来保存/检索您的许可信息。如果您需要加密类，我为[之前的答案](https://stackoverflow.com/questions/165808/simple-2-way-encryption-for-c/212707#212707)上传了一个简单但非常强大的 AES 类。

# java - Hibernate 在查询后调用实体上的公共方法，为什么？

> ID：630054
> 
> 赞同：0
> 
> 时间：2009-03-10T13:03:26.903
> 
> 标签：java, hibernate, postgresql, netbeans6.5

我正在使用休眠 3.0（带有 posgre 8.3）、Java 1.6 和 Netbeans 6.5。我创建了一个本机查询来返回所有唯一的最新条目，如下所示：

```
String query = "SELECT DISTINCT ON (origem) * FROM entrada " +
                "ORDER BY origem, horadata DESC";
        SQLQuery sqlQuery = this.getSession().createSQLQuery(query);
        sqlQuery.addEntity(Entrada.class);
        List entradas = sqlQuery.list(); 
```

当调用“sqlQuery.list()”时，Entrada 对象按预期返回。但是对象 Entrada 中的所有公共非静态方法都会被调用。我不想要这种行为，有人可以帮助我吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T13:11:16.197

什么是“所有”公共方法？

当 hibernate 创建实体并从数据库中填充数据时，会调用 getter 和 setter。由于实体类必须满足 java bean 规范，所以除了 hashCode()、toString() 之外，不应该有任何公共方法......

# html - 如何在选择时使 HTML 单选按钮变为粗体？

> ID：630057
> 
> 赞同：8
> 
> 时间：2009-03-10T13:04:03.330
> 
> 标签：html, radio-button

在 HTML 中，我有以下单选按钮选项

o 选择 1
o 选择 2
o 选择 3

我想做的是当有人从上面选择一个单选按钮时，与所选单选按钮对应的文本变为粗体。

因此，例如 - 如果该人选择“选择 2”，则单选按钮选择现在看起来像：

o 选择 1
**o 选择 2**
o 选择 3

我该怎么做呢？我假设必须使用 JavaScript 或 CSS。

提前致谢

**更新**：**您将如何在不使用 jQuery 的情况下实现“nickf”解决方案？**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-10T13:24:04.543

您可以纯粹使用 CSS 来做到这一点，但您需要将每个输入的文本包装在 span 或其他标记中：

```
<input type="radio" name="group1" value="Milk"><span>Milk</span><br> 
```

然后只需使用兄弟选择器：

```
input[type="radio"]:checked+span { font-weight: bold; } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-10T13:16:48.290

你可以尝试用 CSS 做所有事情。

我试过了，它**有效**¹：

```
<input type="radio" name="choice" value="1" checked /><span>First choice</span>
<input type="radio" name="choice" value="2" /><span>Second choice</span>

input[type="radio"]:checked + span
{
    font-weight: bold;
} 
```

**说明：**这会捕获无线电输入 (type="radio") 之后的所有跨度并进行检查。

¹我用 Firefox 3 和 IE7 进行了测试，它只适用于 Firefox。（[兼容性参考](http://reference.sitepoint.com/css/pseudoclass-checked)）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-10T13:23:13.643

我会做这样的事情：

```
<label><input type="radio" name="myRadio" value="1" /> One</label>
<label><input type="radio" name="myRadio" value="2" /> Two</label>
<label><input type="radio" name="myRadio" value="3" /> Three</label> 
```

在每个元素上使用一个`onchange`处理程序来更改父标签的 CSS 类。在 jQuery 中，它看起来像这样：

```
$(':radio').change(function() {           // get all the radio buttons and
                                          // add an onchange handler
    var $label = $(this).parent('label'); // get a reference to the parent label
    if (this.checked) {                   // if the radio is on...
        $label.addClass('selected');      // add the CSS class "selected" to the label
    } else {                              // otherwise...
        $label.removeClass('selected');   // take the class away.
    }
}); 
```

请记住覆盖标签的默认样式（粗体）：

```
label {
    font-weight: normal;
}
label.selected {
    font-weight: bold;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T13:09:14.300

使用您的 OnChange 事件`select`将所选元素的 css 样式更改为粗体。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T13:12:54.760

```
<input type=button onClick="this.style.fontWeight=bold"> 
```

这可能有效，我没有自己测试。当然还有更好的解决方案。

如果您在代码中插入了一个 JavaScript 框架（如**jQuery**），那么它可能有许多功能可以做同样的事情。选择器、样式器、css 处理程序等等。

我宁愿建议创建一个这样的 CSS 类：

```
.felkover
{
    font-weight: bold;
} 
```

然后只需在任何给定按钮的**类属性**中添加或删除此定义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T13:29:13.673

Here is an example :

```
<script>
  function makeBold()
  {
    var radios = document.getElementsByName("sex");
    for (var index = 0; index < radios.length; index++)
    {
      if (radios[index].checked)
      {
        document.getElementById("span_" + radios[index].value).style.fontWeight='bold';
      }
      else
      {
        document.getElementById("span_" + radios[index].value).style.fontWeight='normal';
      }
    }
  }
</script>

<input type="radio" name="sex" value="male" onclick="makeBold();"> 
<span id="span_male">Male</span>

<br>
<input type="radio" name="sex" value="female" onclick="makeBold()"> 
<span id="span_female">Female</span> 
```

**EDIT :** You should define your text spans with ids like that : **span_**

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-10T13:23:35.903

有趣的是，您的按钮周围有标签以包含文本，我会将其添加到标签中。

```
<label onchange="this.parent.children.fontWeight='normal';this.fontWeight='bold';"> 
```

虽然理想情况下我不会将此代码内联，而是在页面加载后从头部的某个位置将其连接到它们。

# .net - 如何访问 iframe 父元素？

> ID：630064
> 
> 赞同：0
> 
> 时间：2009-03-10T13:06:52.900
> 
> 标签：.net, asp.net, javascript, html, ajax

我正在做的是一个新的图像上传器，我想将输入文件放在 iframe 中并在父页面中显示上传的图像。那么如何从内部 iframe 访问父元素？或者如果有人有一个例子，那也很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T13:37:37.103

框架对象 .parent 将允许您访问外部，甚至是 document.top。如果这两个页面不在同一个域中，您的浏览器可能会阻止脚本执行作为 XSS 攻击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T13:20:32.073

由于 iframe 在浏览器范围内**不兼容**，因此您的选择有限。

如果你真的坚持下去，你只能通过服务器端来完成。JavaScript 在许多情况下错误地处理 iframe，它是不安全的、不确定的和值得怀疑的。

如果您足够开放，请查看**Ajax**框架，将您的上传 iframe 更改为流畅有效的上传器。

如果您对后者感兴趣，可以在广播中获得示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T13:31:38.007

我不认为你可以，否则我可以将我的 IFRAME 注入你的页面，然后去猿。从安全的角度来看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-21T11:23:20.243

[http://groups.google.com/group/jquery-en/browse_thread/thread/6a8ffe14ba525ccb](http://groups.google.com/group/jquery-en/browse_thread/thread/6a8ffe14ba525ccb)

在火狐中工作。

# c# - 数据网格颜色更改 + C#

> ID：630069
> 
> 赞同：0
> 
> 时间：2009-03-10T13:08:15.910
> 
> 标签：c#, winforms

如何使用 .net 1.1 更改 datagrid.im 中选定单元格的颜色，我需要它的 windows applns。

如果我单击第 2 行中的单元格，则应更改特定的单元格颜色

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T13:28:09.573

I suspect what you are looking for in .NET 1.1 is something like this:

```
DataGridTest.Rows(1).Cells(1).Style.Backcolor = Color.Red 
```

* * *

The .NET2 equivalent would be something like:

```
DataGridViewCellStyle MakeItGreen = new DataGridViewCellStyle;
MakeItGreen.BackColor = Color.Green;

DataGridViewRow row2 = myGrid.Rows(2);
row2.Cells(2).Style = MakeItGreen 
```

Or simply:

```
this.myDataGridView[2,3].Style.BackColor = Color.Green; 
```

If this is not what you were looking for please provide more information in your question...

# c# - 为什么要词典 () 与 LINQ to SQL 一起使用时生成编译器错误？

> ID：630071
> 
> 赞同：2
> 
> 时间：2009-03-10T13:08:31.570
> 
> 标签：c#, linq, linq-to-sql

从这个问题开始：

[Linq-to-SQL ToDictionary()](https://stackoverflow.com/questions/245168/linq-to-sql-todictionary)

我有一个名为 的表`Domains`，它有两列：

`DomainID int`
`DomainName varchar(250)`

我想返回一个`Dictionary<int, string>`. 当我尝试以下任一 LINQ to SQL 代码时：

```
Dictionary<int, string> dict =
    dbc
    .Domains
    .Select(d => new {d.DomainID, d.DomainName})
    .AsEnumerable()
    .ToDictionary<int, string>(k => k.DomainID, k => k.DomainName); 
```

或者

```
Dictionary<int, string> dict = 
    (from d in dbc.Domains
      select new { d.DomainID, d.DomainName })
      .AsEnumerable()
      .ToDictionary<int, string>(k => k.DomainID, k => k.DomainName); 
```

我收到以下编译错误：

`Instance argument: cannot convert from 'System.Collections.Generic.IEnumerable<AnonymousType#1>' to 'System.Collections.Generic.IEnumerable<int>'`

这里的场景似乎与[q245168](https://stackoverflow.com/questions/245168/linq-to-sql-todictionary)相同并且应该可以工作，我是否遗漏了一些明显的东西？

干杯
凯夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T13:16:48.057

尝试删除泛型类型参数；第一个是**源**，而不是关键：

```
Dictionary<int, string> dict = 
(from d in dbc.Domains
  select new { d.DomainID, d.DomainName })
  .AsEnumerable()
  .ToDictionary(k => k.DomainID, k => k.DomainName); // <==== no angles 
```

在这里，我们使用泛型类型推断来提供细节。

# c# - 如何在 ASP.NET 中存储会话数据？

> ID：630073
> 
> 赞同：2
> 
> 时间：2009-03-10T13:08:36.767
> 
> 标签：c#, asp.net, session

我们有一个适用于 ASP.NET 的 flex 应用程序。（通过 weborb）。并且我们在.NET 端使用了几个数据来加载数据，例如：UserId、ChannelId、... 目前只有 userid 存储在 HttpContext.Current.Identity 的名称中。所以flex端不需要一直push用户id，但是现在我们也想禁用channelid的“push”。

我想知道我们应该在哪里“存储”这些数据。会话是否足够保存或者我们需要使用 cookie？或者有没有其他方法可以解决这个“问题”。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-10T13:25:22.810

我建议使用`Session`，因为这些值随后存储在服务器上（cookie 存储在客户端上）。还使用静态类并将会话包装在那里。

代替

```
Session["channelid"] = ChannelId 
```

采用

```
SessionManager.ChannelId = ChannelId 
```

并且您可以声明`SessionManager`为具有使用会话的静态属性的静态类。我相信这也是微软的一般做法。

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T13:17:57.447

Session 听起来是个不错的选择。除非您确实需要扩展到非常大量的并发用户，否则人们对此有很多反感，但对于每个会话如此少量的数据，没有理由避免它。

Cookies 是一个选项，但这意味着数据保存在客户端，这可能是不可取的，并且会增加发送到服务器的每个请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T13:23:16.670

如果只是存储 userId 和 channelId 或类似整数值的情况，我更喜欢 session，但如果你将拥有比这些更多的数据，并且你可能有相当多的并发会话，那么 session 可能有点重。

# xml - 有没有办法在 XSL 转换期间忽略名称空间？

> ID：630077
> 
> 赞同：7
> 
> 时间：2009-03-10T13:09:45.080
> 
> 标签：xml, xslt

在处理 XSL 转换的服务器上禁用了命名空间检查（因为编写 XSL 的人不理解命名空间）。我必须对 XSL 进行更改，但我无法对其进行测试，因为没有定义任何命名空间，即。

代替

```
 <xsl:template match="ns:element[position()=1]">... 
```

它有

```
 <xsl:template match="element[position()=1]">... 
```

所以它不匹配 XML 中的任何元素，因为它们都符合命名空间。

我无法在服务器上进行测试，因为我无权访问它。修复 XSL 是没有用的，因为必须启用命名空间检查，这会破坏所有其他转换。

所以我需要做的是找到一种在 XSL 转换期间忽略名称空间的方法。我可以访问 MSXML、XMLSpy（在这里找不到选项），如果我真的需要，我可以用 C# 或类似语言编写一些代码。

作为最后的手段，我可​​以编写一些正则表达式，但我真的不想走这条路，尤其是在处理 XML 时......

回应有关更多细节的评论：

它是一个 Windows 2003 虚拟服务器，运行一个 Methode Servlet (www.eidosmedia.com) 实例。我不知道这个 servlet 使用什么技术来执行 XSL 转换。他们忽略了命名空间，因为最初编写 XSL 的人不理解它们，并且没有将它们包含在 XSL 中。所以现在所有的 XSL 文件（数百个）都没有名称空间。

一次性修复所有这些文件可能是一个有趣的挑战，但这不是我现在需要的（而且部门经理无论如何也不会同意，因为涉及的测试量很大）。我只想知道是否有可用的工具（或技术）允许我按原样获取这些 XSL 文件并使用它们来转换相应的 XML 文档而不考虑名称空间。在我看来，必须存在一个工具，因为编写原始 XSL 的人自己一定使用过类似的东西来测试转换。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T13:22:38.933

您*可以*在“真实”转换之前进行转换以从输入中删除所有命名空间。但是......我不确定你是否*应该*这样做。感觉很丑

```
<xsl:stylesheet version="1.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:template match="*">
    <xsl:element name="{local-name()}" >
      <xsl:apply-templates select="@*|node()"/>
    </xsl:element>
  </xsl:template>  

  <xsl:template match="@*">
    <xsl:attribute name="{local-name()}">
      <xsl:value-of select="." />
    </xsl:attribute>
  </xsl:template>  

</xsl:stylesheet> 
```

* * *

原答案：

那会是一个选择吗？

```
<xsl:template match="*[local-name()='element' and position()=1]">... 
```

（如评论所示 - 它不会）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T03:00:36.500

我将其发布为答案，因为它太长而不适合作为评论。

我从未听说过的任何 XSLT 处理器都不允许您在输入 XML 中全局忽略名称空间。如果您有在不了解名称空间的情况下编写的 XSL 转换以及使用它们的 XML 文档，您要么必须使用损坏的 servlet 进行转换，要么对 XML 文档进行预处理以删除名称空间。

Tomalak 发布的转换将做到这一点 - 与使用正则表达式不同，它不会搞砸 XML 中的所有其他内容。这样做也不是很多工作。链接转换非常简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T13:29:14.377

How many namespaces are there in the XML being transformed?

If 1 can you temporarily add that namespace as the default namespace of your XSL? Ok that means you might need change the output namespace etc. but once tested you could remove these tweaks.

If there are more than 1 that implies that there are no local name collisions across the namespaces. Could you tweak the test input XML so that all aliases point to the same namespace and then perform the tweak above.

# asp.net - 通过 .aspx 检测客户端 PC 上是否存在 NET Framework

> ID：630091
> 
> 赞同：1
> 
> 时间：2009-03-10T13:13:40.310
> 
> 标签：asp.net, frameworks, client-side

如果客户端电脑安装了 NET 框架 2.0，有什么方法可以检查 ASP.NET 网页？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T13:15:21.570

您可以使用位于 HttpRequest 对象中的服务器变量来检查框架是否已安装。框架版本位于 HTTP_USER_AGENT 中，看起来像这样：

Mozilla/4.0（兼容；MSIE 7.0；Windows NT 5.1；.NET CLR 1.1.4322；.NET CLR 2.0.50727；.NET CLR 3.0.4506.2152；.NET CLR 3.5.30729）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T13:23:14.377

字符串版本 = [Request.Browser.ClrVersion](http://msdn.microsoft.com/en-us/library/system.web.httpbrowsercapabilities.clrversion.aspx) .ToString();

我认为这将揭示 clr 版本。如果这还不够，您需要将对象下载到客户端来调查客户端计算机。

# java - 是否有访问 bugzilla 的 java api？

> ID：630095
> 
> 赞同：7
> 
> 时间：2009-03-10T13:15:11.743
> 
> 标签：java, api, xml-rpc, bugzilla

是否有（独立的！）java api 将 XML-RPC 接口包装到 bugzilla？我不想为它编写自己的 api，而且我实际上找不到执行此操作的库（并且仅此）。

**更新：**

我正在寻找类似[http://oss.dbc.dk/bugzproxy/](http://oss.dbc.dk/bugzproxy/)的东西， 只用 Java 编写

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-03T21:26:34.687

我知道这是一个有点老的线程，但是很可能有相同问题的人会在这里登陆我想分享一篇博客文章，我写了一篇关于我发现用于访问 Bugzilla 的四个 Java 客户端库：J2Bugzilla、B4J（Bugzilla对于 Java）、Bugzilla 库、LightingBugAPI。

[http://www.dzone.com/links/r/bugzilla_web_service_and_java_client_libraries.html](http://www.dzone.com/links/r/bugzilla_web_service_and_java_client_libraries.html)

最好的问候， 南达那

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-10T13:21:34.630

有[Apache WS XML-RPC](http://ws.apache.org/xmlrpc/) *（现在已经满口了！）*，它是一个完整的 XML-RPC 实现，您可以使用它。我不太了解BugZilla，但假设它支持XML-RPC，使用我刚刚链接的可怕的一口应该不会有任何问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T13:20:38.813

该库/API 称为 JAX-WS（或 JAXB），允许您调用任何性质的 WS。获取模式，生成 bean 和代理，调用它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-03T05:37:53.127

这是一个使用 Java 的 bugzilla api 的简单示例。 [http://codehelpline.blogspot.com/2010/08/how-to-access-bugzilla-webservice-api.html](http://codehelpline.blogspot.com/2010/08/how-to-access-bugzilla-webservice-api.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-05T06:04:14.567

这是Nandana Mihindukulasooriya[对 4 个 Bugzilla API 库](http://www.nandana.org/2012/10/bugzilla-web-service-interface-and-java-client-libraries.html)的一个很好的比较，我从中摘录：

*   [J2Bugzilla](http://j2bugzilla.com/)，[http://code.google.com/p/j2bugzilla/](http://code.google.com/p/j2bugzilla/)
*   [B4J – 用于 Java 的 Bugzilla](http://techblog.ralph-schuster.eu/b4j-bugzilla-for-java/)
*   [ConQuat Bugzilla 库](https://www.conqat.org/?page_id=169)
*   [LightingBugAPI](http://code.google.com/p/lightningbugapi/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-21T06:59:27.397

还有应该在 Eclipse 之外独立运行的 Mylyn。但是，我还没有设法让它独立。你可以试试我自己的 Bugzilla Java API，它试图满足最紧迫的需求：[http ://techblog.ralph-schuster.eu/b4j-bugzilla-for-java/](http://techblog.ralph-schuster.eu/b4j-bugzilla-for-java/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-03-07T20:20:31.910

Mylyn 可能是您的不错选择。

如果您需要更简单的设置或更好地控制事情的发生方式，您可以编写自己的 XML-RPC 调用到 Bugzilla Web 服务接口。我在我的博客上总结了这个过程：[Chat to Bugzilla from Java using Apache XML-RPC](http://indeadend.com/2011/03/05/chat-to-bugzilla-from-java-using-apache-xml-rpc/)。

把它们加起来：

*   获取 Apache XML-RPC 库
*   从 commons 获取 Apache HTTP 客户端（旧版本）

然后使用以下类作为基类（它处理 cookie 等）并覆盖它：

```
/**
 * @author joshis_tweets
 */
public class BugzillaAbstractRPCCall {

    private static XmlRpcClient client = null;

    // Very simple cookie storage
    private final static LinkedHashMap<String, String> cookies = new LinkedHashMap<String, String>();

    private HashMap<String, Object> parameters = new HashMap<String, Object>();
    private String command;

    // path to Bugzilla XML-RPC interface
    private static final String BZ_PATH = "https://localhost/bugzilla/xmlrpc.cgi";

    /**
     * Creates a new instance of the Bugzilla XML-RPC command executor for a specific command
     * @param command A remote method associated with this instance of RPC call executor
     */
    public BugzillaAbstractRPCCall(String command) {
        synchronized (this) {
            this.command = command;
            if (client == null) { // assure the initialization is done only once
                client = new XmlRpcClient();
                XmlRpcClientConfigImpl config = new XmlRpcClientConfigImpl();
                try {
                    config.setServerURL(new URL(BZ_PATH));
                } catch (MalformedURLException ex) {
                    Logger.getLogger(BugzillaAbstractRPCCall.class.getName()).log(Level.SEVERE, null, ex);
                }
                XmlRpcTransportFactory factory = new XmlRpcTransportFactory() {

                    public XmlRpcTransport getTransport() {
                        return new XmlRpcSunHttpTransport(client) {

                            private URLConnection conn;

                            @Override
                            protected URLConnection newURLConnection(URL pURL) throws IOException {
                                conn = super.newURLConnection(pURL);
                                return conn;
                            }

                            @Override
                            protected void initHttpHeaders(XmlRpcRequest pRequest) throws XmlRpcClientException {
                                super.initHttpHeaders(pRequest);
                                setCookies(conn);
                            }

                            @Override
                            protected void close() throws XmlRpcClientException {
                                getCookies(conn);
                            }

                            private void setCookies(URLConnection pConn) {
                                String cookieString = "";
                                for (String cookieName : cookies.keySet()) {
                                    cookieString += "; " + cookieName + "=" + cookies.get(cookieName);
                                }
                                if (cookieString.length() > 2) {
                                    setRequestHeader("Cookie", cookieString.substring(2));
                                }
                            }

                            private void getCookies(URLConnection pConn) {
                                String headerName = null;
                                for (int i = 1; (headerName = pConn.getHeaderFieldKey(i)) != null; i++) {
                                    if (headerName.equals("Set-Cookie")) {
                                        String cookie = pConn.getHeaderField(i);
                                        cookie = cookie.substring(0, cookie.indexOf(";"));
                                        String cookieName = cookie.substring(0, cookie.indexOf("="));
                                        String cookieValue = cookie.substring(cookie.indexOf("=") + 1, cookie.length());
                                        cookies.put(cookieName, cookieValue);
                                    }
                                }
                            }
                        };
                    }
                };
                client.setTransportFactory(factory);
                client.setConfig(config);
            }
        }
    }

    /**
     * Get the parameters of this call, that were set using setParameter method
     * @return Array with a parameter hashmap
     */
    protected Object[] getParameters() {
        return new Object[] {parameters};
    }

    /**
     * Set parameter to a given value
     * @param name Name of the parameter to be set
     * @param value A value of the parameter to be set
     * @return Previous value of the parameter, if it was set already.
     */
    public Object setParameter(String name, Object value) {
        return this.parameters.put(name, value);
    }

    /**
     * Executes the XML-RPC call to Bugzilla instance and returns a map with result
     * @return A map with response
     * @throws XmlRpcException
     */
    public Map execute() throws XmlRpcException {
        return (Map) client.execute(command, this.getParameters());
    }
} 
```

通过提供自定义构造函数和添加方法来覆盖类：

```
public class BugzillaLoginCall extends BugzillaAbstractRPCCall {

    /**
     * Create a Bugzilla login call instance and set parameters 
     */
    public BugzillaLoginCall(String username, String password) {
        super("User.login");
        setParameter("login", username);
        setParameter("password", password);
    }

    /**
     * Perform the login action and set the login cookies
     * @returns True if login is successful, false otherwise. The method sets Bugzilla login cookies.
     */
    public static boolean login(String username, String password) {
        Map result = null;
        try {
            // the result should contain one item with ID of logged in user
            result = new BugzillaLoginCall(username, password).execute();
        } catch (XmlRpcException ex) {
            Logger.getLogger(BugzillaLoginCall.class.getName()).log(Level.SEVERE, null, ex);
        }
        // generally, this is the place to initialize model class from the result map
        return !(result == null || result.isEmpty());
    }

} 
```

# bash - 无法将 .txt 文件放在另一个 .txt 文件的末尾

> ID：630096
> 
> 赞同：0
> 
> 时间：2009-03-10T13:15:17.093
> 
> 标签：bash, concatenation

如何在不打开文件的情况下将 .Txt 文件 A 放在终端中 .Txt 文件 B 的末尾？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-10T13:17:30.067

你的意思是不用编辑器打开它们？使用`cat`：

```
cat A >> B 
```

将命令的输出（输出文件）`>>`重定向到文件。但它不会覆盖 的内容，而是附加到它。如果您使用单个，它将覆盖.`cat``A``B``B``>``B`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-10T13:17:34.920

```
cat A >> B 
```

应该这样做。不确定您所说的“不打开”是什么意思，当然必须打开文件，在操作系统的意义上，才能发生这种情况。

双箭头是“追加”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T13:20:09.420

我不确定您所说的“打开文件”是什么意思，但是

`$ cat a.txt >> b.txt`

应该做的伎俩。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-10T13:17:57.243

这不是微不足道的吗？

```
cat A >> B 
```

# javascript - Gmail 的 JavaScript 中使用的设计模式？

> ID：630098
> 
> 赞同：9
> 
> 时间：2009-03-10T13:15:25.207
> 
> 标签：javascript, design-patterns, oop, gmail

谁能告诉我在构建 Gmail 时使用了哪些设计模式（如果有）？我理解它背后的概念 - 排队一些请求，在每个完成时增加栏，在所有内容都关闭时初始化显示 - 但我特别感兴趣是否有可以用来模仿这些功能的特定设计模式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:15:11.037

我有一个类似的问题并像这样解决它：数据预加载通过向服务器发送异步请求来工作。当进度条可见时，我为每个请求增加一个计数器。进度条的大小 == 计数器。由于请求发送很快，用户永远不会注意到进度条的最大值发生了变化。

随着请求回答的到来，我每次都会推进进度条一次。就是这样。当最后一个请求到达时，预加载完成。

当回复很小并且连续快速到达时，这看起来会更好，但它适用于所有情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T06:22:07.110

我成功使用的一个技巧是将[Ajax 数据预加载为 JSON](http://blogs.cozi.com/tech/2008/05/preload-ajax-data-as-json.html)：作为初始页面加载的一部分，我将有用的种子数据作为内联 JavaScript 发送。

# oracle - 如何更新oracle异构服务元数据？

> ID：630102
> 
> 赞同：1
> 
> 时间：2009-03-10T13:15:58.433
> 
> 标签：oracle, heterogeneous-services

我正在从 Oracle 连接到不同的数据库（MS Access、MySQL、...）。打开连接时，Oracle 会读取远程数据库中的元数据（表和视图定义）。但是在更新远程对象元数据时（在表上添加列、视图定义......）Oracle 没有被注意到。

我发现刷新元数据的唯一方法是终止异构服务器进程（hsolesql，...）并再次查询。有没有其他方法可以在不终止进程的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T14:07:27.143

也许通过将网关的[HS_DESCRIBE_CACHE_HWM](http://download.oracle.com/docs/cd/B19306_01/server.102/b14232/apa.htm#i634565)初始化参数更改为较小的值 (1)，它将不会继续缓存数据。我相信您会受到性能影响，但如果您无法通过网关执行 DDL（这也应该更新缓存），则可能是必要的。

# opengl - OpenGL 投影矩阵

> ID：630112
> 
> 赞同：1
> 
> 时间：2009-03-10T13:17:50.970
> 
> 标签：opengl, matrix, perspectives

我有一个关于查看查看器及其投影平面以及如何准确计算应该创建的投影点的问题。

前任。原点处的查看器，在负 Z 方向上查看。z = -2 处的投影平面。点 (-6,1,-4)。

我看到一些网站在谈论使用相似的三角形，有些网站有一个矩阵来乘以它。对我来说，问题是我不知道如何设置任何一个。

我猜我的观众的观点是在原点 (0, 0, 0, 1)。当我搜索透视投影矩阵时，我找到了一个设置这样的矩阵的站点。

1 0 0 0
0 1 0 0
0 0 0 0
0 0 1 0

但是，据我所知，我的观察者的观点在 (0, 0, 0, 1) 处，那么投影对于它如何影响等式是没有意义的。该矩阵还需要根据公式进行调整以在此站点上进行设置：
[http ://www.cs.nps.navy.mil/people/faculty/capps/iap/class2/viewing/projection.html](http://www.cs.nps.navy.mil/people/faculty/capps/iap/class2/viewing/projection.html)

我只需要一点帮助来解决这个问题，我们在课堂上讨论的只是使用相似的三角形，这对我来说没有意义......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T23:16:39.490

观察者的位置通常不是通过投影矩阵来处理的，而是通过模型视图矩阵来处理的。投影矩阵只处理从眼睛空间到剪辑空间的转换。

相机变换是通过将相机的逆变换作为模型视图堆栈上的第一个矩阵来实现的。

[使用 openGL 进行高级图形编程](http://books.google.com/books?id=H4eYq7-2YhYC&pg=PA22&lpg=PA22&dq=eye+clip+ndc+space&source=bl&ots=q9XFpR05TZ&sig=Kg319hw-V1ehD4a3SXexEqC0rfE&hl=en&ei=rgukSfe0H4qhtwek99nSBA&sa=X&oi=book_result&resnum=1&ct=result#PPA20,M1)

[OpenGL 转换](http://www.songho.ca/opengl/gl_transform.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T13:20:18.080

考虑读取 OpenGL 的矩阵，使用`glGet...()`函数，并自己通过相关矩阵运行顶点。首先阅读转换管道的详细信息，这样您就知道如何应用矩阵，排序一如既往地很重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-21T01:19:32.887

我在我的网站上详细讨论了（opengl）投影矩阵的推导。你可以看看这里

[http://divineabomination.blogspot.com/2009/12/derivation-of-perspective-matrix-part-1.html](http://divineabomination.blogspot.com/2009/12/derivation-of-perspective-matrix-part-1.html)

第二部分也可以从右侧的菜单中获得。

# javascript - 如何在在线考试期间限制使用其他应用程序？

> ID：630118
> 
> 赞同：8
> 
> 时间：2009-03-10T13:19:45.180
> 
> 标签：javascript, html

我创建了一个在线考试网络应用程序。我希望用户避免使用浏览器（在 Google 中检查答案）。

我应该如何实现这一目标？即使我想限制最小化窗口或使用 Ctrl+Tab，我们是否应该使用全屏模式？

是否可以？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-03-10T13:39:26.350

有一个非常简单的解决方案：设置时间限制。与立即知道答案的学生相比，任何必须浏览网络寻找答案的学生都会浪费很多时间。

另一个解决方案：不在乎。确保学生不了解 Internet 不是您的工作。你的工作是确保他们在开始工作时了解自己的东西。因此，如果学生无法记住某些内容但可以在 Google 上查找？为什么不？我会给她加分，因为她工作得更聪明而不是更努力。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-10T13:23:41.083

作为浏览器用户，我希望这是不可能的，因为这意味着任何网站都可以做同样的事情，从而违背我的意愿控制我的计算机。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-10T13:27:02.620

这是*可能的*，但只能**通过变通方法。**

[您根本不能像unwind 所说](https://stackoverflow.com/questions/630118/restrict-using-other-application-during-online-exam/630138#630138)的那样限制操作系统和正在运行的应用程序的功能。

但是您可以通过添加 Ajax 框架来实现限制。**您可以将其设置为在考试窗口失去焦点**时发送答案，从而迫使您的学生诚实。这也有很多缺点，但这是我能想象的一种实现方式。

## 更新

为了回复评论，我重新思考并改进了这个想法。每当*焦点被盗*时，必须**输入验证码**。这不鼓励为每个问题更改浏览器窗口，并且如果偶尔发生一次也不会令人沮丧。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-10T14:14:55.453

写出问题，以便它们需要原始推理，而不是反刍事实。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-10T13:36:27.353

如果测试在偏远地区进行，则不可能将其锁定。他们总是可以使用单独的笔记本电脑/平板电脑/手机/任何东西。如果您与参与者在同一个房间，那么您可以使用具有单一应用信息亭模式的浏览器：[https ://superuser.com/questions/716426/running-latest-chrome-for-windows-in-kiosk-模式](https://superuser.com/questions/716426/running-latest-chrome-for-windows-in-kiosk-mode)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-10T13:25:26.040

我认为这对于真正的 Web 应用程序来说是不可能的。如果用户在远程位置，他或她可以简单地使用另一台计算机/电话。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-10T15:06:51.943

如果我在家里参加考试，没有办法阻止我在办公桌前用两台计算机（Linux 机器，以及用于 OSX 和 XP 的双启动 Mac Mini）进行考试，而且您无需进行任何锁定操作一台计算机停机将很重要。

许多人可以临时或永久地使用不止一台计算机。如果我没有两台电脑，我可以同时使用我的笔记本电脑和台式机。或者我的 iPhone。或者，我可以与知道该主题或将在网上搜索我的人通电话。

请记住，任何技术封锁都必须被视为公平的。一种不公平的暗示（例如，当出现不相关的弹出窗口时，需要将注意力集中在测试窗口上），学生将更有动力绕过您的控制。

你需要做的是有一些设施让学生去参加考试。他们可以监考并尝试确保没有使用计算机作为外部参考（尽管 iPhone 不难隐藏）。或者，您不能在测试中遇到任何重大问题。或者将测试设计为开源的。

你无能为力。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-10T13:39:09.203

唯一可行的方法是设计在线测试，这样就很难参考其他材料。这是一个设计问题，而不是技术问题。例如，为测试和每个答案设置较短的时间限制。我已经做了很多这样的测试。归根结底，如果他们不在受控的环境中，他们可以拥有任何类型的参考资料——书本、朋友等。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-10T13:24:05.950

您不能通过 HTML 或 javascript 限制浏览器窗口的使用（最小化、浏览其他网站...）。:(

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-10T13:25:01.627

一个基于 Java 的解决方案......

使用带有使用 Web Start 部署的 html 组件的瘦客户端全屏应用程序。这里有两个选择......

1.  Qt 占碑 + WebKit

2.  Swing + xhtmlrenderer

在 Swing/AWT 中，您可以检查是否有多个监视器。我确信其他语言/工具包提供了该功能.......

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-11-29T10:41:32.253

使用安全考试浏览器[http://safeexambrowser.org/news_en.html](http://safeexambrowser.org/news_en.html)。安全考试浏览器是一个网络浏览器环境，可以安全地进行在线考试。该软件将任何计算机变成一个安全的工作站。它管理对系统功能、其他网站和应用程序等资源的访问，并防止在考试期间使用未经授权的资源

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-10T13:26:57.610

你不能用 html/javascript 做到这一点。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-10T13:43:30.987

我知道的唯一方法是：

明确声明事先禁止切换出当前选项卡/窗口。

如果违反规则，请关闭考试并宣布考试无效。（使用 JS 跟踪焦点/窗口调整大小）。

通过 JS 可靠地阻止当前浏览器窗口之外的任何内容是不可能的。用户可以随时使用自己的 JS 引擎启动不同的浏览器，并为所欲为。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-10T13:58:14.337

这和pestaa的回答基本一样，只不过不是在失去焦点的时候提交答案，换个问题怎么样？所以你有一桶 100 个问题，测试中有 40 个。它一次显示一个，如果窗口失去焦点，当窗口再次获得焦点时，问题会从存储桶中变为新的问题......

只是一个想法。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-10T14:30:25.103

从技术的角度来看，这是可能的。您可以使用 JavaScript 的 onblur 事件检测何时失去焦点。您可以记录窗口焦点丢失的次数，或者尝试使用 JavaScrip focus() 方法重新聚焦。

但有几个警告......

1) JavaScript 可能被禁用。2) 他们仍然可以在其他设备上检查答案，例如另一台计算机或手机 3) 他们可以通过非电子方式访问信息。另一个人或一本书。

确保没有外部帮助的唯一方法是在考试条件下设置测试。这意味着对其进行监督，这会破坏偏远的自然。

根据此测试的用途，您可以尝试其他成熟的技术。比如使用远程考试作为入学考试，成功的学生在考试条件下参加第二次考试。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-10T14:34:06.873

如果你不在他们的房间里，你可能完全不走运。因为他们可以在他们旁边有另一台笔记本电脑，它也可以连接到互联网。如果他们在同一个房间，并且您确实拥有计算机，那么您可能可以做很多事情，例如安装仅允许访问测试网站的硬件防火墙。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-10T14:41:30.193

您可以使用开源 gecko 浏览器轻松编写 .net 应用程序。它有一个[很好的 .net 包装器](http://code.google.com/p/geckofx/)，您可以自定义（禁用用户浏览等）。然后，防止用户切换程序变得非常容易。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-11T12:15:26.230

即使有一种可靠的方法可以实现您想要的（我非常怀疑），它也非常非常容易规避。用户只需要使用第二台计算机（或者更简单：在虚拟机中启动测试）。

所以真正的答案是选择一个非技术性的解决方案（比如问需要理解的问题，而不是问容易用谷歌搜索的事实）。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-06-30T01:52:25.923

你不能！Javascript 不允许您限制用户的操作。但是您当然可以有一些解决方法，例如检测文档是否失去焦点。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-04-07T06:08:35.790

我还创建了基于在线考试的学术项目，然后我使用鼠标和键盘禁用选项，并且我成功了，如果学生打开浏览器选项卡，那么他们需要手动输入问题，因为他们无法在手动编写问题时复制问题他们这样的西部时间............所以你也可以使用鼠标和键盘禁用选项............

为此，您使用此编码......

```
<script type="text/javascript">
   function disableRightClick(e)

{

  var message = "Right click disabled";

  if(!document.rightClickDisabled) // initialize

  {

    if(document.layers) 

    {

      document.captureEvents(Event.MOUSEDOWN);

      document.onmousedown = disableRightClick;

    }

    else document.oncontextmenu = disableRightClick;

    return document.rightClickDisabled = true;

  }

  if(document.layers || (document.getElementById && !document.all))

  {

    if (e.which==2||e.which==3)

    {

      alert(message);

      return false;

    }

  }

  else

  {

    alert(message);

    return false;

  }

}

disableRightClick();
</script>
<script type='text/javascript'>
  document.onkeydown = function (e) {
    e.preventDefault();
    alert("Not use keyboard")
  }
</script> 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2009-03-10T15:41:58.113

想不同。黑客方式。

开头显示引用网络信息的人将被取消资格。当您的考试站点加载时，在客户端秘密安装数据包嗅探器代码。从考试开始嗅探数据包并检索信息开始。您将在考试期间从该 IP 获得访问的 url。然后，您可以知道谁作弊，谁没有作弊！

但是，不要这样做。这是违反用户隐私的。你可能会被起诉:-)

# wpf - 强制 WPF 在 ItemsControl 中创建项目

> ID：630124
> 
> 赞同：6
> 
> 时间：2009-03-10T13:21:16.237
> 
> 标签：wpf, itemscontrol

我想验证我的项目在`ListBox`UI 中正确显示。我想一种方法是遍历`ListBox`视觉树中的所有孩子，获取他们的文本，然后将其与我期望的文本进行比较。

这种方法的问题在于内部`ListBox`使用 a`VirtualizingStackPanel`来显示其项目，因此仅创建可见的项目。我最终遇到了这个`ItemContainerGenerator`类，它看起来应该强制 WPF 在可视树中为指定项目创建控件。不幸的是，这对我造成了一些奇怪的副作用。这是我生成所有项目的代码`ListBox`：

```
List<string> generatedItems = new List<string>();
IItemContainerGenerator generator = this.ItemsListBox.ItemContainerGenerator;
GeneratorPosition pos = generator.GeneratorPositionFromIndex(-1);
using(generator.StartAt(pos, GeneratorDirection.Forward))
{
    bool isNewlyRealized;
    for(int i = 0; i < this.ItemsListBox.Items.Count; i++)
    {
        isNewlyRealized = false;
        DependencyObject cntr = generator.GenerateNext(out isNewlyRealized);
        if(isNewlyRealized)
        {
            generator.PrepareItemContainer(cntr);
        }

        string itemText = GetControlText(cntr);
        generatedItems.Add(itemText);
    }
} 
```

`GetItemText()`（如果您愿意，我可以提供代码，但它只是遍历可视化树直到`TextBlock`找到 a。我意识到还有其他方法可以在项目中包含文本，但一旦我得到项目，我会修复一代工作正常。）

在我的应用程序中，`ItemsListBox`包含 20 个项目，前 12 个项目最初可见。前 14 个项目的文本是正确的（可能是因为它们的控件已经生成）。但是，对于第 15-20 项，我根本没有收到任何文本。另外，如果我滚动到底部`ItemsListBox`，第 15-20 项的文本也是空白的。因此，我似乎在干扰 WPF 生成控件的正常机制。

我究竟做错了什么？是否有一种不同/更好的方法可以强制将 an`ItemsControl`中的项目添加到可视化树中？

**更新**：我认为我已经找到了发生这种情况的原因，尽管我不知道如何解决它。我假设调用`PrepareItemContainer()`将生成任何必要的控件来显示项目，然后将容器添加到正确位置的可视化树中。事实证明，它没有做这两件事。直到我向下滚动查看它，容器才被添加到`ItemsControl`，当时只有容器本身（即`ListBoxItem`）被创建 - 它的子级没有被创建（这里应该添加一些控件，其中一个应该是将`TextBlock`显示项目的文本）。

如果我遍历我传递给`PrepareItemContainer()`结果的控件的可视化树是相同的。在这两种情况下，都只`ListBoxItem`创建了 ，而没有创建它的任何子项。

我找不到将其添加`ListBoxItem`到可视化树的好方法。我`VirtualizingStackPanel`在可视化树中找到了 ，但是`Children.Add()`在 an 中调用了它的结果`InvalidOperationException`（不能直接将项目添加到`ItemPanel`，因为它会为其生成项目`ItemsControl`）。作为测试，我尝试`AddVisualChild()`使用反射调用它（因为它受到保护），但这也不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T13:27:40.590

快速浏览一下，如果 ListBox 使用 VirtualizingStackPanel - 也许用 StackPanel 代替它就足够了

```
<ListBox.ItemsPanel>
  <ItemsPanelTemplate>
      <StackPanel/>
  <ItemsPanelTemplate>
<ListBox.ItemsPanel> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-20T12:23:25.380

你可能会以错误的方式解决这个问题。我所做的是连接我的 DataTemplate [内容] 的 Loaded 事件：

```
<DataTemplate DataType="{x:Type local:ProjectPersona}">
  <Grid Loaded="Row_Loaded">
    <!-- ... -->
  </Grid>
</DataTemplate> 
```

...然后在事件处理程序中处理新显示的行：

```
private void Row_Loaded(object sender, RoutedEventArgs e)
{
    Grid grid = (Grid)sender;
    Carousel c = (Carousel)grid.FindName("carousel");
    ProjectPersona project = (ProjectPersona)grid.DataContext;
    if (project.SelectedTime != null)
        c.ScrollItemIntoView(project.SelectedTime);
} 
```

这种方法在第一次显示行时对其进行初始化/检查，因此它不会预先执行所有行。如果您可以忍受，那么也许这是更优雅的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T17:24:01.437

我想我知道如何做到这一点。问题是生成的项目没有添加到可视化树中。经过一番搜索，我能想到的最好办法是`VirtualizingStackPanel`调用`ListBox`. 虽然这并不理想，因为它仅用于测试，我认为我将不得不忍受它。

这对我有用：

```
VirtualizingStackPanel itemsPanel = null;
FrameworkElementFactory factory = control.ItemsPanel.VisualTree;
if(null != factory)
{
    // This method traverses the visual tree, searching for a control of
    // the specified type and name.
    itemsPanel = FindNamedDescendantOfType(control,
        factory.Type, null) as VirtualizingStackPanel;
}

List<string> generatedItems = new List<string>();
IItemContainerGenerator generator = this.ItemsListBox.ItemContainerGenerator;
GeneratorPosition pos = generator.GeneratorPositionFromIndex(-1);
using(generator.StartAt(pos, GeneratorDirection.Forward))
{
    bool isNewlyRealized;
    for(int i = 0; i < this.ItemsListBox.Items.Count; i++)
    {
        isNewlyRealized = false;
        UIElement cntr = generator.GenerateNext(out isNewlyRealized) as UIElement;
        if(isNewlyRealized)
        {
            if(i >= itemsPanel.Children.Count)
            {
                itemsPanel.GetType().InvokeMember("AddInternalChild",
                    BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.InvokeMember,
                    Type.DefaultBinder, itemsPanel,
                    new object[] { cntr });
            }
            else
            {
                itemsPanel.GetType().InvokeMember("InsertInternalChild",
                    BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.InvokeMember,
                    Type.DefaultBinder, itemsPanel,
                    new object[] { i, cntr });
            }

            generator.PrepareItemContainer(cntr);
        }

        string itemText = GetControlText(cntr);
        generatedItems.Add(itemText);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-03T20:24:25.137

Andy 的解决方案是一个非常好的主意，但并不完整。例如，前 5 个容器已创建并在面板中。该列表有 300 > 个项目。我用这个逻辑请求最后一个容器，添加。然后我请求最后一个索引 - 1 个容器，这个 logis ADD！那就是问题所在。面板内子项的顺序无效。

解决方案：

```
 private FrameworkElement GetContainerForIndex(int index)
    {
        if (ItemsControl == null)
        {
            return null;
        }

        var container = ItemsControl.ItemContainerGenerator.ContainerFromIndex(index -1);
        if (container != null && container != DependencyProperty.UnsetValue)
        {
            return container as FrameworkElement;
        }
        else
        {

            var virtualizingPanel = FindVisualChild<VirtualizingPanel>(ItemsControl);
            if (virtualizingPanel == null)
            {
                // do something to load the (perhaps currently unloaded panel) once
            }
            virtualizingPanel = FindVisualChild<VirtualizingPanel>(ItemsControl);

            IItemContainerGenerator generator = ItemsControl.ItemContainerGenerator;
            using (generator.StartAt(generator.GeneratorPositionFromIndex(index), GeneratorDirection.Forward))
            {
                bool isNewlyRealized = false;
                container = generator.GenerateNext(out isNewlyRealized);
                if (isNewlyRealized)
                {
                    generator.PrepareItemContainer(container);
                    bool insert = false;
                    int pos = 0;
                    for (pos = virtualizingPanel.Children.Count - 1; pos >= 0; pos--)
                    {
                        var idx = ItemsControl.ItemContainerGenerator.IndexFromContainer(virtualizingPanel.Children[pos]);
                        if (!insert && idx < index)
                        {
                            ////Add
                            virtualizingPanel.GetType().InvokeMember("AddInternalChild", BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.InvokeMethod, Type.DefaultBinder, virtualizingPanel, new object[] { container });
                            break;
                        }
                        else
                        {
                            insert = true;
                            if (insert && idx < index)
                            {
                                break;
                            }
                        }
                    }

                    if (insert)
                    {
                        virtualizingPanel.GetType().InvokeMember("InsertInternalChild", BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.InvokeMethod, Type.DefaultBinder, virtualizingPanel, new object[] { pos + 1, container });
                    }
                }

                return container as FrameworkElement;
            }
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-08T16:15:48.223

对于其他对此感到疑惑的人，在 Andy 的情况下，将 VirtualizingStackPanel 换成普通的 StackPanel 可能是最好的解决方案。

在 ItemContainerGenerator 上调用 PrepareItemContainer 不起作用的原因是项目必须位于可视树中， PrepareItemContainer 才能工作。使用 VirtualizingStackPanel，在 VirtualizingStackPanel 确定它正在/即将出现在屏幕上之前，该项目不会被设置为面板的可视子项。

另一种解决方案（我使用的那个）是创建您自己的 VirtualizingPanel，这样您就可以控制何时将项目添加到可视化树中。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-05-14T23:05:26.770

就我而言，我发现调用( ,`UpdateLayout()`等) 会启动它，这样生成器的状态就会从“NotStarted”变为“GeneratingContainers”，并且容器不再由and/or返回。`ItemsControl``ListBox``ListView``ItemContainerGenerator``null``ItemContainerGenerator.ContainerFromItem``ItemContainerGenerator.ContainerFromIndex`

例如：

```
 public static bool FocusSelectedItem(this ListBox listbox)
    {
        int ix;
        if ((ix = listbox.SelectedIndex) < 0)
            return false;

        var icg = listbox.ItemContainerGenerator;
        if (icg.Status == GeneratorStatus.NotStarted)
            listbox.UpdateLayout();

        var el = (UIElement)icg.ContainerFromIndex(ix);
        if (el == null)
            return false;

        listbox.ScrollIntoView(el);

        return el == Keyboard.Focus(el);
    } 
```

# javascript - 将 html 输入框中的值保持在设定值以下

> ID：630129
> 
> 赞同：8
> 
> 时间：2009-03-10T13:22:04.423
> 
> 标签：javascript, validation

我在输入框中只能包含数值（使用[此](http://itgroup.com.ph/alphanumeric/)插件）。
现在我希望输入低于，例如 90。如果输入的值超过此最大上限或无法解析，则应插入前一个值。默认情况下，该框将包含“1”。

```
<input id="targetQuantity" name="targetQuantity" type="text" value="1" /> 
```

我想我应该以某种方式捕捉当前值。尝试解析新值。如果是允许值，则继续使用此值，如果不是，则将旧值放回原处。
由于我的 JS 技能非常有限，我什至不知道我可以使用哪些事件，而且我发现我在 intarwebz 上找到的文档相当混乱。

--EDIT--
我最终使用了[Sergei 的](https://stackoverflow.com/questions/630129/keep-value-in-html-input-box-below-set-amount/630228#630228)代码并使用了[Aaron 的](https://stackoverflow.com/questions/630129/keep-value-in-html-input-box-below-set-amount/630192#630192)可用性建议。
我现在正在寻找的只是启用/禁用整个表单的提交。仅仅禁用提交按钮是不够的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-10T13:43:04.203

```
<input id="targetQuantity" name="targetQuantity" type="text" value="1" onkeyup="check(this)" /> 
```

... JavaScript：

```
var v=1;

function check(i) {      
  if(i.value > 100) {
    i.value=v;
    alert("< 100");
  }
  else
    v=i.value;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T13:35:34.063

这应该会有所帮助：[JavaScript 疯狂：键盘事件](http://unixpapa.com/js/key.html)

现在谈谈可用性：永远不要在用户键入时更改值。如果您想知道原因，请尝试一下。

相反，将字段变为红色（设置背景颜色）。提交表单后，再次运行验证以确保用户已修复错误。如果不是，则在字段附近的某处显示*内联*错误消息（“值必须 < 90”）并将焦点设置到该字段。

**不要使用 alert()**。alert() 仅用于调试，在真正的 Web 应用程序中没有用，因为它 a) 会中断用户的工作流程并且 b) 在用户键入时不起作用：最终，用户将点击空格和对话框将关闭，可能与用户注意到有一个对话框或它说什么。

您可能想查看[jQuery](http://jquery.com/)或[Prototype](http://www.prototypejs.org/)之类的库，因为它们已经包含您需要的所有构建块，并且它们为您修复了许多浏览器错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T13:47:02.493

在 javascript 代码块中编写这个 js：

```
var LastGood = 1;
function CheckValue(input, max) {
    var value = Number(input.value);
    if (NaN == value || input.value>max) { //it is not a number or is too big - revert
        input.value = LastGood;
    } else { //it is ok, save it as the last good value
        LastGood = value;
    }
} 
```

将您的输入表单更改为

```
<input id="targetQuantity" name="targetQuantity" type="text" value="1" onkeyup="CheckValue(this, 90)" /> 
```

# pdf - 有什么方法可以阻止用户在本地保存文档？

> ID：630139
> 
> 赞同：6
> 
> 时间：2009-03-10T13:24:02.843
> 
> 标签：pdf, persistence

如果用户在我的网站上查看文档（例如代表一些机密信息的 pdf 文件），我是否可以阻止他们在本地保存文档？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-10T13:25:55.570

一句话—​​—不。

一旦您将数据发送到他们的浏览器，他们就可以用它做他们想做的事。

您可以使用一些 Flash 组件或 Java Applet 来增加保存信息的难度，但他们仍然可以截取浏览器的屏幕截图并将其保存在本地。

唯一实用的方法是确保只有受信任的用户才能访问信息（您可能已经这样做了）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-10T13:35:08.123

一旦用户下载了您的 PDF（到浏览器），他们就可以用它做任何事情。他们可以将其保存到硬盘驱动器的其他位置。即使您以某种方式禁用了此功能，任何人都可以使用第三方应用程序拦截网络流量并以这种方式保存 PDF。

您最好的选择是使用某种数字版权管理工具来阻止用户分发 PDF，即使他或她下载了它。例如，[FileOpen](http://www.fileopen.com/)或 Adob​​e Content Server。如您所见，此类工具可以（技术上）阻止打印、强制内容过期等。

请注意，这对于可能*意外*下载或分发数据的用户最有用。*恶意*用户可能能够绕过这些限制，例如通过截取每个页面的屏幕截图并打印来绕过打印限制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T13:27:33.397

这是非常困难的。我能想到的最有效的事情是部署一个 Java 小程序，通过在运行时下载它来显示信息

但这仍然不会阻止用户截取屏幕截图并保存它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T13:55:20.727

防止这种意外发生的相对简单的方法是在文档打开时隐藏工具栏和菜单。在 Adob​​e 论坛上查看[此问题/答案。](http://www.acrobatusers.com/forums/aucbb/viewtopic.php?id=7845)当然，如果用户知道如何解决这个问题，并且有决心的用户可以规避您对文档设置的任何限制，如果他们有权查看它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T13:27:50.993

如果您对此感到担忧，则不应提供机密数据或至少以可下载的格式提供。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-10T14:48:38.540

如果它在工作网络中，我建议您实施 Active Directory（如果您还没有的话）。使用 Active Directory，您可以轻松配置用户的默认配置文件路径，将该路径放在文件服务器上。这样，默认情况下，所有应用程序都将保存到该路径而不是本地硬盘驱动器中。希望能帮助到你。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-11T01:01:12.373

不是解决方案，而是轶事。几年前，我的一个朋友将大量内部敏感信息编译成Word文档，并在页面上加水印“仅供内部使用”并锁定。

几天后，她接到了销售经理的电话。

“你如何解锁这个 Word 文档？”

“为什么？”

“我想把水印去掉，这样我就可以把它交给客户了……”

头 -> 桌子 - 砰！

这是一个棘手的问题。

# wpf - 在 WPF 中使用单独的活动/禁用图像创建工具栏按钮的最佳方法是什么？

> ID：630152
> 
> 赞同：4
> 
> 时间：2009-03-10T13:25:56.990
> 
> 标签：wpf, wpf-controls

我正在处理 WPF 应用程序的工具栏。我们使用的图标集有正常、悬停和禁用状态的单独图标，我想使用它们。我想知道最简单的解决方案/正常的方法是什么？

我的第一个想法是创建一个具有 NormalImage、ActiveImage、DisabledImage 属性的用户控件“ImageButton”，其中包含 IsMouseOver 和 IsEnabled 的必要触发器。这可行，但不幸的是导致按钮失去工具栏按钮样式，即它们获得标准按钮边框，鼠标悬停时没有蓝色背景并且间隔太近。据我了解，这是因为 WPF 的工具栏控件覆盖了子按钮元素的样式，并且无法重新设置按钮的样式，因为它们位于父 ImageButton 中。

有没有人有任何建议让这个工作？我对 WPF 很陌生，所以我可能只是以一种倒退的方式来处理这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T13:33:20.857

您可以基于`Button`ToolBar.ButtonStyleKey[生成](http://msdn.microsoft.com/en-us/library/system.windows.controls.toolbar.buttonstylekey.aspx)`Style`的样式。例如：

```
<Style TargetType="Button" BasedOn="{StaticResource {x:Static ToolBar.ButtonStyleKey}}">
    <Setter Property="MinHeight" Value="40"/>
</Style> 
```

# c++ - How do you get the ip address from a remote machine?

> ID：630164
> 
> 赞同：1
> 
> 时间：2009-03-10T13:28:05.317
> 
> 标签：c++, windows, linux, sockets, cross-platform

I'm writing c++ code that I need to run on both windows and linux and I'm looking for a function call that will return the ip address of the box the app is running on. Is there such one?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T13:32:22.917

IF you can use boost, take a look at
[How to get IP addresss of boost::asio::ip::tcp::socket?](https://stackoverflow.com/questions/601763/how-to-get-ip-addresss-of-boostasioiptcpsocket/601828#601828)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T13:32:35.710

Call socket(), then getsockname().

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:28:29.600

你可以这样做，但这通常是一个坏主意。

“man netdevice”中描述的 ioctl SIOCGIFCONF 解释了这一点。

这是一个坏主意的原因是你可能不会得到你想要的东西。

该机器可能有多个或多个 IP 地址，您不会知道哪些是公共的。它可能位于 NAT 网关（或多个）后面，在这种情况下，它们都可能不是公共的。

您只是不能特别有用地使用该信息。无论您想要什么，都可能不是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T15:53:35.513

如果您知道您的应用程序运行的机器的名称，只需使用 gethostbyname()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T14:39:50.527

最好的主意是使用网络服务。连接到已知服务器，让它发回您用来联系它的 IP。这将告诉您 PC 在与外界通信时使用的 IP 地址（好的，IP 地址）*。*

可能的例外情况及其无关紧要的原因：

*   您获得了 NAT 设备的地址 - 好吧，在这种情况下，您的 PC 没有 Internet 地址，您打算如何处理您可能拥有的 10.xyz 地址？
*   您根本没有地址，因为您没有连接到 Internet - 如果您无法连接，那么另一台计算机不太可能对您的 IP 地址做任何有用的事情。
*   您确实获得了 IP，但没有人可以连接到它 - 您可能位于拒绝任何传入连接的过滤防火墙后面。防火墙不太可能接受连接到同一台计算机的另一个 IP 地址上的流量。即使是这样，也可能无法发现。这对 FTP 来说简直就是地狱。

# php - 从链接中提取域

> ID：630166
> 
> 赞同：2
> 
> 时间：2009-03-10T13:28:28.327
> 
> 标签：php

我正在寻找一种从任何给定链接中提取域（带有 tld）的防弹方法——`dirname($path)`我们称之为域名（$link）的等价物。

```
echo domainname("http://example.com/index.html?a=123%1231"); 
```

应该打印“example.com”

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-10T13:33:04.057

```
echo parse_url($url, PHP_URL_HOST); 
```

更多信息：[http ://be.php.net/manual/en/function.parse-url.php](http://be.php.net/manual/en/function.parse-url.php)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-10T13:31:41.593

[parse_url](http://php.net/parse_url)返回值有一个`host`键。

# javascript - 如何使用 JQuery 将 blockui 对话框自动调整为可用的可见区域？

> ID：630170
> 
> 赞同：3
> 
> 时间：2009-03-10T13:29:07.950
> 
> 标签：javascript, jquery, blockui

我需要调整在 blockUI 中显示为消息的 div 的大小，以便它填充可见屏幕区域而不是一些硬编码的软糖因子（所以宽度 - 100 说）。前提是我可以在屏幕上显示较小的图像，但如果用户需要放大的图像，那么我只需向他们展示大小适合他们屏幕的块 ui 对话框。

图像是动态生成的，因此可以调整为从应用程序传递给它的任何尺寸。

我已经查看并且只找到了使 div 居中的代码。我正在努力，所以如果我找到答案，我会在这里发布（假设它不会复制其他任何人的答案！）

这是调用标记的一个非常简单的 html 片段：

```
<div>
   <img src="someurl" class="image" height="280px" width="452px" alt="" />
</div>
<div style="text-align: right;">
   <a href="#viewpopup" id="viewpopup">View larger map</a>
</div> 
```

这是弹出标记

```
<div id="popup">
   <div class="titlebar">
      <div class="title left">Map details</div>
      <div class="closebuttons right"><a class="close">x</a></div>
      <div class="clearer"></div>
   </div>
   <div class="popupcontent">
   <!-- auto append content here --> 
   </div>
   <div class="buttonbar">
      <a class="close">Close</a>
   </div>
</div> 
```

我正在使用 JQuery，这是我拥有的当前代码：

```
var popup = $("#popup");
var popupcontent = popup.children(".popupcontent");
var image = $(".image");
$(document).ready(function(){
    $("#viewpopup").click(function(){
        // Fudged indent on the top left corner
        var top = 20;
        var left = 20;

        // Dynamically set the contents
        // popupcontent.empty();
        // popupcontent.append();
        $.blockUI({ message: popup, css : { border : 'none', height: 'auto', 'cursor': 'auto', 'width': 'auto', 'top': top, 'left' : left   } });

    });

    $(".close").live("click",function(){
        $.unblockUI();
    });
}); 
```

我还必须弄清楚如何设置弹出内容高度以自动填充当前可用空间（我在我的 css 中使用 ems）但我不确定这是否是一个单独的问题:)。

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:21:26.170

我已经让它工作了。我已经使用了上面描述的窗口宽度和高度方法。该代码假设一些软糖数字纯粹是为了使其工作:)。

请注意，我正在限制最大宽度和高度。我将转移到我的动态图像生成中，这样我就不会消耗太多资源。

另请注意，我没有包含将新维度传递给动态图像应用程序的代码，我认为这对每个单独的实现都是自定义的。

```
 $("#viewmap").click(function(){
        var width = $(window).width();
        if(width < 200)
            width = 200;
        if(width > 1200)
            width = 1200;

        var height = $(window).height();
        if(height < 200)
            height = 200;
        if(height > 800)
            height = 800;

        var popupwidth = $(window).width() - 100;
        var popupheight = $(window).height() - 100;
        var top = 20;
        var left = (width - popupwidth) / 2 ;
        popup.css("width", popupwidth);
        popup.css("height", popupheight);
        popupcontent.css("height", popupheight - 40) ;

        popupcontent.empty();
        popupcontent.append("<img src=\"someurl\" width=\""+ popupwidth + "\" height=\""+ (popupheight - 40) +"\" />");
        $.blockUI({ message: popup, css : { border : 'none', height: 'auto', 'cursor': 'auto', 'width': 'auto', 'top': top, 'left' : left   } });

    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T13:50:42.920

您只能将对话框的大小调整为窗口的大小，而不是屏幕的大小。

$(窗口).width(); $(窗口).height();

# .net - .Net 2.0 Web 服务中的 SSPI 连接

> ID：630183
> 
> 赞同：2
> 
> 时间：2009-03-10T13:32:15.087
> 
> 标签：.net, sql-server, login, web-config, sspi

我正在尝试测试我在 C# 中创建的 .Net 2.0 Web 服务。我们的其中一台服务器在 windows 2000 上，目前只能支持 .Net 2.0 。我可以在我的机器上本地测试它，它工作正常，但是当我将它移动到目标服务器进行生产时，它会产生错误。

我希望它使用 Windows 身份验证，并在 web.config 中对其进行定义

我收到的错误如下：

> System.Data.SqlClient.SqlException：用户“”登录失败。用户未与受信任的 SQL Server 连接关联。

当我尝试在目标服务器上测试此 Web 服务（在该服务器上本地运行）时，会发生这种情况。

如何将活动目录用户名与 Web 服务正在运行的服务器/位置相关联（我认为这是我需要做的？）

该服务器目前可以通过经典的 ASP 和 ColdFusion 连接到 MSSQL 2005。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T13:42:06.403

如果您在 IIS 中托管，则需要设置运行 Web 应用程序的应用程序池的标识。请注意，您选择的用户需要访问作为服务登录的权限，以及其他一些内容。如果用户配置稍有错误，您可能会得到“500 服务器不可用”，因此请谨慎操作。另请注意，您需要完全回收应用程序池才能重试！

（编辑）-找到我的记事本；-p

*   将帐户添加到“作为服务登录”策略组（本地安全策略（本地安全设置）-> 用户权限分配）
*   将帐户添加到“IIS_WPG”用户组（计算机管理 -> 本地用户和组）
*   授予帐户“读取和执行”、“列出文件夹内容”和“读取”文件结构的权限（资源管理器 -> 属性）
*   创建新的应用程序池，或更新现有池的用户帐户（Internet 信息服务 -> 应用程序池）
*   为站点/应用程序设置应用程序池（Internet 信息服务 -> 网站）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T13:40:06.783

我相信您在托管该网站的应用程序池中为网站（或服务）设置了用户。

打开 compmgmt.msc，然后转到服务和应用程序 -> Internet 信息服务 (IIS)

您可以在此处添加一个新的应用程序池，该应用程序池具有标识。然后，您可以通过右键单击您的站点 -> 主目录，将您的 Web 服务站点与应用程序池相关联，然后选择底部的应用程序池。

我可能忘记了其他一些事情，但我认为应该这样做。

# wiki-engine - 什么是编程教程的好 wiki 软件？

> ID：630184
> 
> 赞同：10
> 
> 时间：2009-03-10T13:32:21.110
> 
> 标签：wiki-engine

我注意到用我的母语（拉脱维亚语）编写的编程教程非常少。最好的之一似乎最近永久离线。因此，我更倾向于开始编写自己的编程教程。

由于我不是作家，空闲时间很少，所以我想把它变成一个 wiki 的东西。这样其他感兴趣的爱好者（我已经知道一些）也可以轻松加入。

问题是 -**哪种 wiki 软件最适合这样的任务？**我想到了一些很高兴拥有的关键功能，我将在此处列出它们：

*   完整的 Unicode 支持，因为拉脱维亚语中有一些非标准字符；
*   修订控制；
*   访问控制（支持匿名访问）；
*   代码语法着色，最好是可扩展的，以便可以制作不同编程语言的教程；
*   从所有页面自动生成 TOC 会很好（但也可以手动完成）；
*   对图表和数学公式的支持会很好（但也可以通过图片上传来完成）；
*   为页面提供“可打印”版本的能力会很好，更不用说在可下载的电子书中编译整个内容的可能性。

我拥有的服务器上有 Linux，所以最好没有 ASP/ASP.NET - 但如果真的需要，也可以安排。

**补充：**嗯，似乎只有两个不错的候选者——DokuWiki 和 MediaWiki。两者都具有拉脱维亚本地化的重要特征。我会选择 MediaWiki，因为它似乎至少有一个主要优势——附件的版本控制。（加上毫无疑问是世界上测试最好的 wiki 系统）但是，对于这样一个小项目，我担心它是否功能过于丰富。对此有何评论？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T13:39:34.803

[DokuWiki](http://www.dokuwiki.org/dokuwiki)满足您的许多要求。

*   统一码
*   修订记录
*   匿名和经过身份验证的访问
*   多种语言的语法高亮，通过[Geshi](http://qbnz.com/highlighter/)
*   自动目录
*   图表和公式（通过插件）
*   PHP，所以它可以在任何地方运行

它最初的目的是作为代码文档 wiki。我不确定是否会自动将整个内容编译成电子书。但是，插件很容易编写。

编辑 - 有用于从您的页面生成 PDF 和其他文档格式的插件，因此一种可能性是使用网络爬虫将内容拼凑在一起。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-10T13:39:43.040

wiki 软件的王者是[MediaWiki](http://www.mediawiki.org/wiki/MediaWiki)。它支持您指定的所有功能，包括：

*   Unicode（维基百科使用Mediawiki，跨越数百个不同的国家和语言）
*   修订控制（包括回滚、查看修订之间的差异等）
*   访问控制（不同用户级别、匿名读/写等）
*   通过[扩展突出显示语法](http://www.mediawiki.org/wiki/Extension:SyntaxHighlight_GeSHi)
*   如果页面中的标题超过 3 个，则生成 TOC
*   通过 LaTex 标记的图表和公式
*   打印 CSS 样式，打印页面选项

此外，我相信该软件在 Wikipedia 上的 Linux 上运行，因此它已经在 Linux 平台上进行了全面测试。安装起来并不难，但可能存在功能*过多*的风险。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-10T13:38:34.353

[听起来像是Dokuwiki](http://www.dokuwiki.org/)的理想工作。

更新：如果您问自己（或我们）Mediawiki 对于您的项目来说是否有点太大，也许您应该简单地考虑所涉及的其他因素。

*   Dokuwiki 应该可以在几乎任何类型的硬件上运行。我很少见过感觉不快速且性能不佳的安装。很难对 Mediawiki 说同样的话。
*   安装 Dokuwiki 轻而易举。您应该在 30 分钟内启动并运行。
*   支持。我不知道 Mediawiki 的情况如何，但 dokuwiki 邮件列表上的人非常乐于助人和友好。

PS：我有偏见？太厉害了！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T13:39:34.367

[MoinMoin](http://moinmo.in/)非常好，并且有幻灯片放映功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T13:40:08.860

我对 Wordpress 有很好的经验，但它需要一些插件。

*   用于漂亮代码片段的 Google-Code 插件
*   语言切换器插件，您可以通过在博客中指定语言标签（如 [lang_en]english language here[/lang_en] [lang_de]deutsche sprache hier[/lang_de]）轻松地用不同的语言编写
*   修订控制

如果您需要一些特殊的，它与其他系统相比并不难扩展或编写一些自己的插件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T13:45:29.033

谢谢你这样做。我相信我们需要更多英语以外的语言资源。

但是，当您使用它时，您还应该提供指向用英语或其他语言撰写的文章的链接，这些链接会详细说明您用拉脱维亚语撰写的文章。这样，您的读者将获得所有可用的拉脱维亚语内容，但仍能找到也可用的非拉脱维亚语内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T15:45:16.890

不幸的是，我不认为有一个 Wiki 特别适合大量源代码的文章。

但是，您可能想前往[Literate Programs Wiki](http://LiteratePrograms.Org/)。Literate Programming 是教授编程的*好*方法，Literate Programs Wiki 结合了 MediaWiki Wiki 软件和 noweb Literate Programming 系统。

也许您可以请他们帮助您设置自己的版本。或者，也许您可​​以只使用他们的 Wiki，毕竟 MediaWiki 支持多种语言。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-19T13:20:27.893

为了支持数学公式，[MoinMoin 提供了乳胶](http://johannes.sipsolutions.net/Projects/new-moinmoin-latex)（该网站以个性化的主题运行 moinmoin）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-06-24T04:32:24.340

[对TWiki](http://twiki.org)有任何评论吗？[Dokuwiki](http://www.dokuwiki.org/)看起来简单易用，而 Twiki 在搜索引擎中排名很高，看起来更有特色，另外，上面提到的[Confluence](http://confluence.atlassian.com/display/DOC)真的很棒！

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-10T13:56:13.873

您可以使用 zoho wiki。[http://wiki.zoho.com](http://wiki.zoho.com)

我们将它用于我们的内部开发文档。它有你想要的一切。[https://zohowikihelp.wiki.zoho.com/](https://zohowikihelp.wiki.zoho.com/)

# iphone - 在 iPhone UIImageView 中，用什么方法来覆盖实例变量 init？

> ID：630194
> 
> 赞同：3
> 
> 时间：2009-03-10T13:35:47.077
> 
> 标签：iphone, uiimageview

我有一个非常简单的应用程序，可以处理 UIImageView 派生视图的触摸。

该视图有一个矩形坐标数组，用作按钮。

由于这是一个简单的应用程序，我在 UIImageView 派生类中处理所有触摸事件。

我需要初始化作为实例变量的图像坐标数组。

我尝试覆盖包括 init 在内的几种方法，但我尝试过的方法都没有被调用。

在 UIImageView 派生类中初始化实例变量的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T13:42:49.180

有几个 init 函数（initWithFrame、initWithCoder 等），调用哪一个将取决于您如何加载图像视图。如果您从 NIB 加载它，请尝试使用 initWithCoder。

或者，您可以始终在控制器中使用 viewDidLoad 方法，并让它在视图上调用自定义初始化方法。在这种情况下，我不建议这样做，除非你真的必须这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T03:50:13.230

如果您的类作为 nib 的一部分加载，则可以使用 AwakeFromNib: 在加载 nib 文件时初始化变量。

# views - When to use database views and when not?

> ID：630200
> 
> 赞同：32
> 
> 时间：2009-03-10T13:37:37.803
> 
> 标签：views, database-agnostic

This question is about database views, **not** materialized-views.

Pros:

*   Query simplification.
*   Avoid repeat the same joins on multiples queries.
*   Avoid magic numbers.

Cons:

*   Hiding real queries (may be you are repeating joins).

What else?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-10T13:42:01.710

Pros: Allows you to change the underlying data structures without affecting the queries applications are using (as long as your view can hide the data structures)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-10T13:42:35.530

Security. Grant access on a view to the users who should be able to see the columns returned from it.

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-10T13:42:18.883

Views are pretty awesome when you don't entirely trust the party sending queries to your database. A good example might be you would create a view on tables for a contractor so that all they can see is the rows pertaining to their project.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-10T15:06:41.100

尽管视图可以隐藏复杂性和多个连接，但无论如何这些都是 SP 中的复杂性。

如果可以优化 SP，则应该优化视图，这将提高所有命中该视图的 SP 的性能。

视图非常强大和有用，原因之一是在所有其他非常好的原因中脱颖而出。它们减少了代码重复。也就是说，在大多数情况下，底线。如果查询将在三个或更多地方使用，那么如果架构或查询参数发生更改，视图将大大简化您的更改。

我曾经不得不编辑 22 个存储过程来更改一些查询逻辑。如果原始架构使用视图，那么我将只有三个更改。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-10T14:06:14.147

现在 SQL Server 具有[公用表表达式](http://msdn.microsoft.com/en-us/library/ms190766.aspx)，我发现自己创建的视图更少。当我创建一个视图时，它通常是用于可用于许多查询的规范化层次结构，而不是替代一个查询的东西。

例如 Region、Market 和 City 可能是三个标准化表（雪花）。我 90% 的查询都需要这些数据，所以我将创建一个视图。该视图永远不会替换单个查询，而是使所有其他查询变得简单和干燥。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-10T15:25:21.930

我不得不多次使用视图来进行奇怪的连接和按别名分组。

通过奇怪的连接，我的意思是选择一个不同日期的列表，然后将它们外部连接到它们来自的表中，以获得空天的空条目。我想不出任何其他方法。

至于按别名分组，似乎取决于别名内公式的复杂程度。如果别名没有引用任何实际的列，或者已经被分组的列，那么一切正常，但是未包含在分组中的列上的别名会引发错误。

我似乎记得在我大学时代的某个地方读到或听到过，从视图中选择比从一堆连接的表中选择要快，但我不知道这是不是真的。

使用视图的最后一个优势：Excel 中的数据透视表。我认为没有加入表格的方法，或者至少在向导界面中没有。在 Microsoft Query 中进行连接可能是可能的，但我还没有尝试过，因为我现在才想到这个想法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T13:42:52.550

I used to use them all the time, now rarely. However, I do all my data access thru stored procedures so the usefulness of a view is somewhat less since the SP can hide the complexity of the join where needed.

I'd still consider using a view if a had a particularly complicated joined of many tables, from which I needed to then build many SP's on top of, but to be honest, I can't think of any I have in production right now.

The other scenario would I would use one would be where my users have access to the database for generating their own reports, and I wanted to hide the underlying complexity for them.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-08-28T04:32:30.787

视图比复杂查询更容易测试。当您想对 SQL 进行单元测试时，视图就是帮助。

# javascript - 嵌套 AJAX 回调函数的可读性

> ID：630215
> 
> 赞同：2
> 
> 时间：2009-03-10T13:41:31.897
> 
> 标签：javascript, refactoring, extjs, readability

请帮我重构这个 Javascript 代码。预定消息发送有很大的形式（发送日期，重复类型，结束日期/数量，信用系统 - 需要在运行时计算预定发送计划的总成本）。我正在为此表单编写 Javascript 验证器。

有一个验证算法 1）检查发送日期时间是否不在过去的时刻 2）检查“结束日期”字段时间是否大于第一次发送日期时间 3）验证调度计划的总成本

（大约有 6 个步骤，但我在这里只写了 3 个 - 我认为这足以掌握问题）

“保存预定计划”按钮在“点击”事件上有一个 JavaScript 监听器。此侦听器调用此函数：

```
ScheduledValidator.checkIfSendDateTimeIsNotInPast(params, form); 
```

这是它的声明：

```
ScheduledValidator.checkIfSendDateTimeIsNotInPast = function (params, form) {
    var conn = new Ext.data.Connection();

    conn.request({
        url: CONST.BASE_URL + 'url',
        params: params,
        callback: function (options, success, response) {
            response = Ext.util.JSON.decode(response.responseText);
            if (response.success == false) {
                // display error messages
            } else { 
                ScheduledValidator.checkIfEndDateIsGreaterThatSendDate(params, form);
            }
        }
    });
} 
```

我们稍后有嵌套请求：

```
ScheduledValidator.checkIfEndDateIsGreaterThatSendDate = function (params, form) {
var conn = new Ext.data.Connection();

conn.request({
    url: CONST.BASE_URL + 'url2',
    params: params,
    messageForm: form,
    callback: function (options, success, response) {
        response = Ext.util.JSON.decode(response.responseText);
        if (response.success == false) {
            // display error messages
        } else {
            ScheduledValidator.validateTotalCost(params, form);
        }
    }
});
} 
```

还有一个在这里：

```
ScheduledValidator.validateTotalCost = function (params, form) {
... 
```

我不喜欢这种方法，乍一看很难理解算法。做很多（大约 6 个）嵌套的 AJAX 查询来验证单个表单可能不好？也许应该将它合并到单个请求中，然后我们将在服务器端进行所有验证活动？我应该如何重构这段代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T00:11:07.890

我建议您在重构代码之前缩小并评估表单流程和用户体验的工作方式。

例如，输入日期时是否需要立即反馈给用户？可以等到她填完表格吗？如果是这样，您可以只使用常规表单发布，验证提交服务器端，并返回反馈。

如果不是，并且体验需要立即反馈，您可能需要考虑围绕您的实现创建一个通用包装器来处理表单验证。这可以手动完成，或者您可以在 Google 上查看表单验证机制，允许您根据需要定义特定的 URL 和回调。

第三种选择可能是在不联系服务器的情况下进行验证客户端。确定您的逻辑是否可以在 Javascript 中完成（很可能，如果它涉及日期计算，这应该不会太难）并尝试添加一个为您执行此操作的层，这样您就不需要联系服务器第一名。奖励：取决于服务器端代码的响应速度，这实际上可以改善用户体验（但是，请记住，服务器端验证仍然是必须的！）。

从您在问题中给出的示例用例中，听起来我以前的建议适用——也就是说，并不完全有必要如此直接地反馈您是否正确填写了表格。如果我对您的情况的理解是正确的，我建议通过删除 AJAX 调用并将其作为正常形式工作来开始重构过程，然后在工作后添加仅客户端验证。

# python - 如何使用 python 的 telnetlib 从设备中获取固定时间段的数据？

> ID：630217
> 
> 赞同：2
> 
> 时间：2009-03-10T13:41:54.563
> 
> 标签：python, telnet

我正在通过 telnet 连接到硬件设备。该设备在 I/O 方面非常简单。所以我向它提交了一个命令，然后设备一次输出一条数据，每秒一次。每行只包含一个数字。

所以我的问题是：如果我使用 python 的 telnetlib 连接到这个设备，我如何在固定的时间段（或固定数量的数据行）内获取数据？

我已经尝试使用所有各种 read_ 命令，但它们似乎都无限期地阻塞，除了 read_until，我不能使用它，因为输出不能用于确定何时停止。

（我在 Cygwin 下运行 python 2.5，顺便说一句）。

编辑：也许真正的问题是，我应该为此使用 telnetlib，还是应该只使用 socket 模块？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T13:51:22.000

根据您的描述，我不清楚您是否正在使用 telnetlib，因为您要连接的设备*需要 telnet 提供的终端设置，*或者因为这似乎是正确的做法。

如果设备像您描述的那样简单——即不协商连接的终端选项——您是否考虑过[asynchat](http://docs.python.org/library/asynchat.html)模块？它适用于您描述的“发送命令，读取行”类型的 IO 模式。

Alternatively, for something lower-level, you could use the [socket](http://docs.python.org/library/socket.html) module to open the connection to the device and then sit in a timed loop and `read()` the incoming data. If the lines are newline-terminated it should be simple for you to identify each individual number. If you are concerned with blocking, stick this loop in its own thread.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T13:50:50.597

以我的经验，大多数此类设备都使用一些提示符，在这种情况下[`Telnet.read_until()`](http://docs.python.org/library/telnetlib.html#telnetlib.Telnet.read_until)是合适的：

> `Telnet.read_until(expected[, timeout])`
> 
> 读取直到遇到预期的给定字符串或直到超时秒数过去。如果找不到匹配项，则返回可用的任何内容，可能是空字符串。如果连接已关闭且没有可用的熟数据，则引发 EOFError。

如果设备没有提供可用（重复）提示，请尝试[`Telnet.read_very_eager()`](http://docs.python.org/library/telnetlib.html#telnetlib.Telnet.read_very_eager)或`Telnet.read_very_lazy()`：

> `Telnet.read_very_eager()`
> 
> 阅读所有可以在 I/O 中不阻塞的内容（渴望）。
> 
> 如果连接关闭且没有可用的熟数据，则引发 EOFError。如果没有可用的熟数据，则返回 ''。除非在 IAC 序列中，否则不要阻塞。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T13:52:11.717

It sounds like blocking isn't really your problem, since you know that you'll only be blocking for a second. Why not do something like:

```
lines_to_read = 10
for i in range(lines_to_read):
    line = tel.read_until("\n") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T13:49:49.787

循环读取行，直到您读取所需的行数或达到时间限制。但是，听起来您实际上并不需要 telnet 库。为什么不直接使用简单的 TCP[套接字](http://docs.python.org/library/socket.html)进行连接？

# prism - 如何让 Prism RegionManager 添加两个视图而不是只添加一个

> ID：630229
> 
> 赞同：0
> 
> 时间：2009-03-10T13:43:18.773
> 
> 标签：prism, composite-application-gu

我正在使用复合应用程序指南（第 2 版，2009 年 2 月）。

我已经用一个区域构建了 Shell，一个 Bootstrapper 和一个具有两个视图的 Employee Module，我希望 RegionManager 将这两个视图都添加到 shell 中的一个区域。

但是，该区域中仅显示添加到 RegionManager 的最后一个视图。

我需要更改什么以便两个视图都显示在 Shell 的区域中？

```
namespace EmployeeModule
{
    public class EmployeeModule : IModule
    {
        private readonly IRegionManager _regionManager;

        public EmployeeModule(IRegionManager regionManager)
        {
            _regionManager = regionManager;
        }

        public void Initialize()
        {
            _regionManager.RegisterViewWithRegion(Infrastructure.RegionNames.MainRegion, typeof(Views.EmployeesView.EmployeesView));
            _regionManager.RegisterViewWithRegion(Infrastructure.RegionNames.MainRegion, typeof(Views.EmployeesListView.EmployeesListView));
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T14:20:53.723

好吧，我不确定您的解决方案是否完全正确；这绝对是丑陋的。我相信您遇到的问题是您将网格或画布标记为区域。这很好，但是在这些情况下元素会自己隐藏起来，除非您能够为 Canvas 指定 X 和 Y 偏移或为 Grid 指定列/行。

Prism 为区域提供了三种类型的适配器。请参阅[MSDN](http://msdn.microsoft.com/en-us/library/cc707908.aspx)。

1.  内容控制区域适配器。此适配器适应 System.Windows.Controls.ContentControl 类型的控件和派生类。
2.  选择器区域适配器。此适配器适配派生自 System.Windows.Controls.Primitives.Selector 类的控件，例如 System.Windows.Controls.TabControl 控件。
3.  项目控制区域适配器。此适配器适应 System.Windows.Controls.ItemsControl 类型的控件和派生类。

这意味着您可以在任何 ContentControl（显示一个 Content 元素的控件）、显示多个内容元素并具有所选项目概念的 Selector 和 ItemsControl 之上使用区域，它只是一个显示多个对象。

我相信您的问题的解决方案是使用 ItemsControl，它会自动调整大小以显示您的所有视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T14:10:55.320

## 请允许我回答我自己的问题：

上面的 RegionManager 代码工作正常。

您必须从视图中的 UserControl 元素中去掉**width**和**height**属性，否则它们会相互覆盖。

# .net - Should I persist this application data?

> ID：630235
> 
> 赞同：0
> 
> 时间：2009-03-10T13:44:05.933
> 
> 标签：.net, data-structures, settings

I have a class in my application that translates path tokens into fully qualified paths. For example: it can take a string like `"%MYAPPDATA%"` and return `C:\Users\user.DOMAIN\AppData\Raoming\MyApp`.

Alternatively, the class has an overload to the function that can take an enum instead of a string. For example: it can take the enum `AppPaths.MyAppData` and return `C:\Users\user.DOMAIN\AppData\Raoming\MyApp`.

I need to store the "lookup table" somewhere, but I'm not sure what the best method or structure is. Should I use a dataset and write the table to disk? Or just keep in it memory?

A single path value can map to a string and an enum. I suppose I can just keep an array in memory whose index maps to the integer value of the enum and do a search through the array when I'm passed a string.

Thoughts?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T13:56:50.363

除非它特别大，否则我只会使用内存中的数组。对于更多功能 - 以及更多开销 - 您可以使用列表或字典。对于很多功能 - 但大量开销 - 您可以使用内存数据集。

同样，除非您拥有超过 250-500 个项目，否则在程序运行期间使用磁盘存储确实没有意义：延迟（检索时间）和编码的开销是不值得的。

当然，您也可以将记录保存在磁盘上作为您的长期存储（例如，在程序启动时加载）。但是，从您的问题来看，如果您从操作系统中提取数据，您甚至可能不需要这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T13:57:38.863

这一切都取决于您想要的性能。

您可以将数据存储在数据库表中（一个用于“原始”数据，两个用于键和枚举之间的关系）并使用简单的 SQL 查询进行查找。不过，这可能不是最快的方法，具体取决于底层数据库和缓存机制。

您还可以使用两个内存映射（字典？）在运行时更快地查找，在启动时初始化它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T13:57:50.627

如果它不可能变大，我会将它保存在内存中 - 否则我会将它存储在数据库/文件中以备后用。

当然，这取决于您的使用情况。据我所知，您想存储用户特定数据的路径。是不是你有一个用户类可以存储数据的路径？

```
if(Directory.Exists(User.Current.AppDataPath)) 
```

所以你可能会摆脱“查找表”，因为每个用户都知道他的 AppData 在哪里 - 只是一个想法......

# c# - 在不影响其他人的情况下更改一个动态创建的 LinkBut ton 的样式？

> ID：630238
> 
> 赞同：0
> 
> 时间：2009-03-10T13:44:37.757
> 
> 标签：c#, asp.net

我有一个方法可以遍历列表并使用 LinkBut​​ton 控件创建链接。出于这个问题的目的，假设它是一个颜色列表，并且我有 5 种颜色：红色、绿色、蓝色、红色和黄色。这是我如何创建链接和添加事件处理程序的代码片段。

```
foreach(color in colors)
{
    LinkButton lb = new LinkButton();
    lb.Text = color.name;
    lb.Click += new System.EventHandler(this.colorClick); 
    lb.CommandName = "CommandName";
    lb.CommandArgument = "CommandArgument";
    lb.ID = color.Id;
} 
```

在偶数处理程序 colorClick 中，我通过执行以下操作将单击的链接加粗：

```
protected void colorClick(object o, EventArgs e)
{
    LinkButton lnk = (LinkButton)o;
    lnk.Style["font-weight"] = "bold";

    //Process clicked link.
} 
```

就加粗当前点击的链接而言，上面的代码工作正常，我遇到的问题是假设点击的链接是红色的，所以红色会是粗体，如果我点击蓝色，我想加粗链接蓝色，但不加粗红色的。我试过了：

```
lnk.Style["font-weight"] = "normal";
lnk.Font.Bold = "false"; 
```

但是，我突然想到，虽然上述可能是正确的，但我在错误的地方做这件事（colorClick）。我在想的是，我可能必须记住先前单击的链接并取消加粗，但我不确定如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T13:46:45.223

你有三个选择：

1.  存储以前粗体和取消粗体的链接。
2.  迭代链接并寻找一个粗体和非粗体的链接。
3.  或者在将链接设置为粗体之前将所有内容取消粗​​体。

删除字体粗细的代码是：

```
lnk.Style.Remove("font-weight") 
```

# wpf - WPF EventTriggers - 无法将属性“RoutedEvent”中的字符串“MouseEnter”转换为“System.Windows.RoutedEvent”类型的对象

> ID：630239
> 
> 赞同：5
> 
> 时间：2009-03-10T13:44:39.020
> 
> 标签：wpf, eventtrigger

我无法让任何事件触发器工作。我正在做的一个简化示例如下 -

```
<Window x:Name="win" x:Class="EventTriggers.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="300" Width="300">
<Window.Resources>
    <ControlTemplate x:Key="buttonT">
        <Border Background="#333">
            <TextBlock Text="{Binding}" HorizontalAlignment="Stretch" Foreground="White"/>
            <Border.Triggers>
                <EventTrigger RoutedEvent="MouseEnter">

                </EventTrigger>
            </Border.Triggers>
        </Border>
    </ControlTemplate>

    <DataTemplate x:Key="lbt">
        <Button Template="{StaticResource buttonT}" Click="Button_Click"></Button>
    </DataTemplate>

</Window.Resources>
<ListBox ItemsSource="{Binding ElementName=win,Path=col}" ItemTemplate="{StaticResource lbt}">
</ListBox> 
```

我知道 Border 上有一个`MouseEnter`事件，因为它是在定义的，`UIElement`但我仍然得到

> 无法将属性“RoutedEvent”中的字符串“MouseEnter”转换为“System.Windows.RoutedEvent”类型的对象

我一运行应用程序。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-10T13:53:47.873

您还必须提供类型，因此：

```
<EventTrigger RoutedEvent="Mouse.MouseEnter"></EventTrigger> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-10T13:54:21.150

完全限定事件名称：

```
<EventTrigger RoutedEvent="Border.MouseEnter">

</EventTrigger> 
```

# wcf - 修改已安装证书的安全性

> ID：630247
> 
> 赞同：1
> 
> 时间：2009-03-10T13:48:17.747
> 
> 标签：wcf, web-services, security, wix, certificate

我们正在为基于 WCF 的 Web 服务创建安装包。该服务通过已安装的证书使用消息级加密。我正在尝试提出一种自动化的方式来安装证书并设置其权限。

目前，我们正在通过 MMC 管理单元手动安装证书。安装完成后，我们需要找到包含已安装证书的文件并修改权限，以便网络服务帐户可以访问它。我知道找到该文件的唯一方法是打开“...\Microsoft\Crypto\RSA\MachineKeys”文件夹（具体路径因平台而异）并识别具有最近修改日期的文件。

我想我们将使用 WIX 来创建安装包。WIX 具有安装证书的特定功能，但我认为权限仍然是一个问题。是否有一些实用程序或 API 或其他方法来获取由主题名称（或类似名称）标识的已安装证书的物理路径。

当然，也许这个问题有更直接的解决方案。

感谢您对此问题的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T03:33:58.900

资料来源：[最小特权](http://www.leastprivilege.com/HowToGetToThePrivateKeyFileFromACertificate.aspx "最小特权")

在托管代码中没有干净的方法可以做到这一点。一般程序是：

1.  选择证书
2.  从证书的 PrivateKey 属性创建一个 RSACryptoServiceProvider 对象
3.  检索 UniqueKeyContainerName 属性。
4.  在存储密钥的各个位置搜索此文件名。用户密钥的 ApplicationData 和机器密钥的 CommonApplicationData 下

如果您想在自定义操作中执行此操作，我建议您在 C++ 中执行此操作。（托管自定义操作大多数时候不是一个好主意。）

如果您只想设置 ACL，有两个工具可以帮您完成：

*   WinHttpCertCfg.exe
*   WSE3 中包含的证书工具

详情见链接，希望对你有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T21:42:27.233

是否需要安装证书？您可以从 PFX 文件或类似文件中引用它，而不需要安装吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T18:43:32.850

证书本身没有权限。它可以在用户的​​证书存储中，例如 MY、CA 或 ROOT 存储。或者它可以在这些商店的计算机版本中。听起来您还安装了私钥和证书。要使服务可以访问私钥，应将其安装到计算机的密钥库中。如果您通过类似 CryptImportKey 的方式手动执行导入，则应在使用 CryptAcquireContext 获取密钥容器时指定 CRYPT_MACHINE_KEYSET。

# html - Generating possible URLs from forms

> ID：630248
> 
> 赞同：1
> 
> 时间：2009-03-10T13:48:39.477
> 
> 标签：html, forms, screen-scraping

I am trying to get all the URLs (and then get the data) that are generated by the form on this page - [http://www.vodafone.in/_layouts/servicecallertunes.aspx](http://www.vodafone.in/_layouts/servicecallertunes.aspx) with little success.

I have installed HTTP Headers(0.14) addon on Firefox 3.0.5, Ubuntu. But the resultant URL is very weird and pretty long. Eg:

```
POST /_layouts/servicecallertunes.aspx __EVENTTARGET=CTTunes1%24ddlTunesSubCategories&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=M0ZAMFvA%2Baq58jd57T84z0fdR%2B1tju00M3YD5nagIHQB48ihJiAoFxS%2B%2Ff8CvaAigdH2a4 
```

(goes on for more than 5000 characters)

What are the possible programmable options to get data from the above form? My only idea currently is to generate all the possible URLs and then get the data.

Thanks in advance. Bart J

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T13:59:43.400

这是一个 ASP.NET 页面，这就是您在其中看到 __VIEWSTATE 的原因。

顾名思义，viewstate 对有关视图状态的信息进行编码，以尝试使创建表单的程序员“感觉”无状态 HTTP 连接是有状态的。

看起来实际上有一个[firefox 插件](http://jalukadev.blogspot.com/2008/09/viewstate-decoder-add-on-for-firefox.html)可以让您解码视图状态并查看其中的信息。您也许可以使用它来确定真正提交的内容并制作您自己的视图状态以获得您想要的行为。

或者您可以只生成所有可能的 URL - 这可能更容易:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T13:34:16.977

您可以在此处获得 250 个连续页面中的相同数据：

[http://www.vodafone.in/existingusers/services/pages/callertunes_searching.aspx?cttrack=1](http://www.vodafone.in/existingusers/services/pages/callertunes_searching.aspx?cttrack=1)

# c# - 通过公共访问器访问本地私有变量是错误的形式吗？

> ID：630249
> 
> 赞同：2
> 
> 时间：2009-03-10T13:48:46.513
> 
> 标签：c#

我正在开发一个多线程应用程序。我正在处理报告并跟踪当前批次中的报告数量以及已处理的报告总数。每当我更新计数器时，我还需要更新 GUI 上的标签，因为该进程位于单独的线程上，因此需要调用委托。其中哪一个是更好的方法？

```
private void UpdateTotalCount(int newValue)
{
    totalCount = newValue;
    if (labelTotalCount.InvokeRequired)
        BeginInvoke((MethodInvoker) delegate() { 
            labelTotalCount.Text = "Total reports:" + totalcount; });
    else
        labelTotalCount.Text = "Total reports:" + totalcount;
} 
```

或者

```
private int totalCount;
public int TotalCount
{
    get { return totalCount; }
    set {
        totalCount = value;
        if (labelTotalCount.InvokeRequired)
            BeginInvoke((MethodInvoker) delegate() { 
                labelTotalCount.Text = "Total reports:" + totalcount; });
        else
            labelTotalCount.Text = "Total reports:" + totalcount;
    }
}
```

**编辑：**好的，第三个选项。

```
 private void UpdateTotalCountLabel()
{
    if (labelTotalCount.InvokeRequired)
        BeginInvoke((MethodInvoker) delegate() { 
            labelTotalCount.Text = "Total reports:" + totalcount; });
    else
        labelTotalCount.Text = "Total reports:" + totalcount;
}
// code elsewhere would look like this
totalCount++;
UpdateTotalCountLabel();
//or
totalCount+= curBatch.Length;
UpdateTotalCountLabel(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T13:56:31.877

我认为使用公共访问器更好，因为它允许更多可维护的代码，以防您以后需要更改总值的计算方式。这样，TotalValue 属性的用户就不必担心您的更改，因为这些更改不会以任何方式影响他们的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T13:57:53.153

我会使用观察者设计模式并将更新逻辑移动到观察者类。
不要混合逻辑和 GUI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:01:51.367

*（更新：我误读了选项的顺序并将它们颠倒了 - EM）*

由于您的代码正在“做某事”（在外部组件上设置计数标签），因此通常认为第一种形式更好。

然而——而且 OOP 纯粹主义者在这点上会强烈反对我——这两个版本都不是非常错误的。我已经完成并看到了两者。我不会仅仅为了它而重写看起来像 #2 的代码。

在某些情况下，第二种选择实际上可能比第一种更明智。例如，如果代码出于其他原因需要跟踪计数器并设置和获取它很多，那么将写入标签视为 View 副作用以及设置/获取 count 属性可能是有意义的作为主神器。在这种情况下，我会选择属性 get/set 对。

更新：关于新的第三种选择：

我实际上不推荐这种想法。现在你已经将两个必须同时发生的动作分成两个独立的代码；这是净损失。您可能会忘记在代码中的某处执行其中之一。#1 或 #2 都比 #3 好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T14:06:55.987

我一直认为 Properties 等同于 get/set 访问器方法。get/set 访问器的经验法则是它们通常应该用于公共接口。如果一个类调用它自己的访问器方法，它们可能应该在另一个类中。

我认为这是一种代码气味。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T14:07:36.373

我更喜欢第一个或

```
private void UpdateTotalCount(int newValue)
{
    totalCount = newValue;
    if (labelTotalCount.InvokeRequired)
        BeginInvoke((MethodInvoker) delegate() { 
            labelTotalCount.Text = "Total reports:" + totalcount; });
    else
        labelTotalCount.Text = "Total reports:" + totalcount;
} 
```

第二个我不喜欢，因为它破坏了封装。我还将修改方法名称以更具描述性，例如“UpdateTotalLabelCountAsync”，因为这就是该方法正在做的事情。

由于您现在正在处理代码，因此您可以将其放入属性设置器中。但是，当其他人甚至您以后去做维护工作时，您可能看不到标签是如何设置的。使用该方法，您至少可以确切地知道标签是如何设置的。还有一个属性用于存储未更新 UI 的数据。您也可以将属性移出 UI 层并存储另一个位置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-10T14:25:04.507

我喜欢选项4：

```
private int totalCount;
public int TotalCount
{
    get { return totalCount; }
    set {
            totalCount = value;
            UpdateTotalCountLabel(totalCount);
        }
} 
```

意图和范围的清晰描述，易于遵循的逻辑——什么是不喜欢的？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T14:06:07.003

我实际上赞成＃1，因为它清楚地表明您正在*做某事*，而不是设置一个字段。

但是，我同意 Mykola 的观点，即您的 UI 交互**不应该与您的支持逻辑属于**同一类。

# .net - 使用检测模型进行性能调优

> ID：630251
> 
> 赞同：2
> 
> 时间：2009-03-10T13:48:55.467
> 
> 标签：.net, profile, instrumentation

如果我使用此处描述的检测模型来分析 .Net 应用程序性能，这意味着分析工具将更改要分析的可执行文件的可执行代码以插入性能测量代码？所以我原来的可执行代码被修改了？

[http://msdn.microsoft.com/en-us/library/ms242753(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms242753(VS.80).aspx)

问候，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T13:56:01.287

是的; 插桩代码与未插桩代码不同。这意味着你必须对结果*稍加*小心——但大多数分析器都会合理地把你的注意力吸引到重要的部分上。我对采样选项从来没有太多的运气——不过，仪器通常很有用。就个人而言，我喜欢[jetBrains](http://www.jetbrains.com/profiler/)产品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T20:37:40.270

是的，在检测时，分析器将使用附加指令修改您的代码，以收集和跟踪必要的性能数据。您永远不想分发程序集的检测版本，并​​且您不想将检测的程序集用于调试目的（因为关键部分/竞争条件/等在附加检测的情况下肯定会表现不同）。

话虽如此，仪器对于分析旨在解决的目标非常有价值。通过收集实际数据并隔离昂贵的操作，可以适当地集中优化工作并准确测量结果 - 避免浪费时间、增加复杂性、降低可维护性以及与过早优化相关的所有其他问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T15:03:16.723

***采样模式***是当您知道代码中的热点区域时，它不会修改您的代码，它只会对所有正在运行的线程的当前调用堆栈进行采样。如果您的线程正在睡觉或等待资源（互斥体、事件等），那么它将被视为热点区域。您想使用此模式来测量负载。
***仪器模式***（跟踪）将测量每种方法花费了多少时间（以周期为单位）。
它需要检测您的代码（使用调试符号），但最终会排除它对系统造成的开销。您想使用此模式来测量单个过程。

# asp.net - 您可以使用 http post 上传多大的文件是否有任何硬性界限？

> ID：630259
> 
> 赞同：1
> 
> 时间：2009-03-10T13:51:56.083
> 
> 标签：asp.net, http, browser

使用 HTTP post 将文件上传到 Web 服务器时，客户端是否有任何限制（例如在流行的浏览器或 HTTP 协议中），这对可以上传文件的大小设置了硬边界？如果您知道任何浏览器施加的限制，最好包括浏览器版本，如果可能，是否和/或如何为该特定浏览器配置边界。

我正在使用 ASP .NET，并且知道我应该正确设置 maxRequestLength 和其他设置。我主要是在寻找有关可能适用的限制的答案，这是我无法控制的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:02:11.130

如果您使用 name 指定隐藏字段`MAX_FILE_SIZE`，大多数浏览器将遵守该限制。HTTP 协议没有施加限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T14:02:54.450

事实上，没有，它可能会受到 int 大小的限制——我在 IE 和 Opera 中使用 POST 上传了大约 1.7GB 的文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T15:54:53.467

我知道没有限制 - 但是，您将在 ASP.NET 中遇到可能需要处理的超时问题。如果您使用 http 上传控件，则需要在代码或 web.config 中覆盖默认的最大 4MB，但这是服务器端问题。

# project-management - 当首席开发人员确信项目将失败时

> ID：630262
> 
> 赞同：7
> 
> 时间：2009-03-10T13:52:18.627
> 
> 标签：project-management

当首席开发人员确信项目将失败时该怎么办？这发生在我最近的一个项目中，我最终失去了工作，因为我说出来了。在一个多月的时间里，我成功地改进了一个原型，使用了一个我之前没有经验的 UI 框架。事实上，当向数百名潜在用户展示时，他们中空前的数量注册了试点。

在演示前不久，添加了一位新开发人员，他主张使用不同的技术。这立即被拒绝了，所以他开始将该技术的概念移植到现有项目中，并且我可能会以一种非常有效的方式添加。确实，当技术经理从演示中回来时，他称赞我们俩做得“很棒”，而另一位开发人员则被命名为领导，大概是因为他最近在底层服务器端技术方面有经验。

然而，与此同时，另一位开发人员告诉我，（我相信，只有我一个人），

*   他坚信当前的项目注定要失败，并且
*   他不喜欢使用当前的技术

该项目立即开始陷入困境。以前我实际上完成的用户故事比 sprint 中要求的要多，但现在我在 sprint 剩下不到一周的时间里被 3 或 4 个故事/任务阻止了。一个失败的 sprint 可能不是世界末日，但我是一名承包商（另一位开发人员也是），还有不到 2 个月的时间，但是*如果*我们继续成功的话，还有延期的可能性，但这在我无法控制，尤其是考虑到领导不喜欢。

所以我说了出来，但请记住，只针对招聘人员。还有很多其他的“桥下之水”，但我决定尝试通过在 dice.com 上重新激活我的简历来保护自己，顺便说一下，招聘人员注意到了。所以，长话短说，招聘人员把我的担忧告诉了客户，客户终止了我的合同。

不用说，我宁愿 7 到 8 周的时间找到新工作，而不是在这个残酷的经济中立即失业；另一种可能性是其他开发人员会在此期间离开，而我的困境会自行解决。

希望这是足够的背景。我有兴趣学习解决我的困境的其他方法。更不用说，工作机会;）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-10T14:07:44.970

我从不“停用”我的简历。如果您将其作为一份活生生的文件保持更新，那么它始终是最新的，没有人会质疑您更新它的动机。即使你不是真的在看。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-10T14:01:38.027

关于我所做的与你所做的唯一不同的事情是，我会以不同的皮条客开始我的求职。正如您所发现的，让您当前的皮条客知道您不开心可以回馈给客户，这可能很糟糕。此外，根据我的经验，他们都一样糟糕，所以对他们中的任何一个都忠诚是没有意义的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-10T14:06:06.940

我在工作场所也遇到过一些冲突。黄金法则是：

1.  如果与上司发生冲突，那就去找另一份工作，你不会赢得这份工作。
2.  如果您是经理，则必须解决它，否则您将遇到麻烦。不要指望任何帮助。
3.  如果与对等方发生冲突，则所有选项都是开放的。但要小心，事情会变脏。公平竞争，但要准备好继续前进。

最重要的是，冲突可能对您的健康有害。如果不能在可接受的时间内解决它们，您必须采取行动。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-10T14:03:56.820

您是否尝试过与其他开发人员交谈？也许你可以帮助激励他。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-10T14:43:39.097

我来过这里。我学到的教训是**永远不要**告诉招聘人员你的意图。

从招聘人员的角度来看。他们正在满足客户的需求。如果您对客户是谁有任何疑问，那就是付费的客户。如果麻烦正在酝酿，招聘人员的工作就是平息它。通常，这意味着找到另一个更顺从的人并将他们安置在您的工作中。

招聘人员甚至询问您事情进展的唯一原因是确定他们是否需要为该职位寻找其他人。

你应该站在付账的人面前。让那个人（以礼貌的方式）了解事情的进展情况。不幸的是，无论你做什么，政治只是在商业世界中工作的一部分。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-10T14:59:44.127

我非常同意 Jon B 写的内容。第一个行动应该是直接与态度与你有冲突的开发人员交谈。如果你照你做的（称赞他你认为他做得很好的工作）并断言你相信这个项目会顺利进行。如果这不起作用，您可能想要更直接地提及您觉得他的态度可能是有害的。做这件事要非常非常非常非常小心，因为有些人可能对此感到非常冒犯和防御。所以一定要先试水。

在您与开发人员交谈了几次之后，觉得您无处可去，那么您应该与项目经理交谈。谁负责你们都在做的项目。请记住，作为一名顾问，您目前正在为该公司工作，因此回去与招聘人员讨论这件事肯定不会解决任何问题。

始终尝试先与此人交谈，看看您是否可以改变他们的态度。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-10T15:03:53.447

是的，我同意不告诉招聘人员。此外，尽可能在团队中努力，保持专业，并确保您的主管了解您眼中的项目进展情况。如果您觉得出现了某些可能会危及项目的问题，那么您有责任说出来，即使这会使其他开发人员处于不利地位。你当然可以这样做，这是一种外交方式，但你应该经常说出来。

是的，始终保持你的简历是最新的。不幸的是，这些天没有忠诚这样的东西......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-10T16:05:16.623

在这种情况下，唯一重要的人是：

*   你的同侪（你的同事），在那里成为一个团队合作者。
*   你的经理（你提到的技术经理），他是付钱给你的人，他应该诚实地评估 HIS 项目的情况。

如果您对项目的可行性有真正的担忧，作为承包商的唯一可能选择是公开处理它（没有一对一的对话），或者只是闭嘴并尽最大努力。

作为一个承包商，你负担不起政治，你每次都会被烧死。

就我个人而言，我只是尝试只关注技术问题，而忽略任何非技术问题。这显然并不总是可能的，但你应该努力，人们只会欣赏你的专业精神。

在这种情况下，您没有提及您的同事认为该项目注定失败的技术原因。也许他有一些有效的观点（你让他的观点听起来很无聊），也许对这些问题的良好评估会帮助你作为一个团队合作提出使这个项目可行的提案。

**顺便问一下，这个项目最后失败了吗？**

哦，招聘人员与此无关。他们不是付钱给你的人，如果他们觉得你变得不可靠并且可能损害他们与付费客户未来业务的潜力，他们会尽一切努力摆脱你。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-10T14:06:11.963

我不知道如何以最好的方式处理这种情况，但有两本书提供了很好地避免这种情况的想法：

[调试开发过程](http://www.amazon.co.uk/Debugging-Development-Process-Steve-Maguire/dp/1556156502)和[软件驱魔](https://rads.stackoverflow.com/amzn/click/com/1590592344)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-11T15:53:56.297

我也遇到过同样的情况，唯一的解决方案是：(a) 支持首席工程师 (b) 更新简历并在其他地方寻找工作

当项目确实失败时，首席工程师希望将责任归咎于任何人和每个人，解雇他们，从而免除他的责任。我在项目终止前大约一个月开始找工作，很幸运。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-10T14:33:11.213

走阻力最小的路。

假设经济回报是你邪恶的根源（通常是）。

消除竞争，争夺（与您的同行）您的雇主/薪酬提供者的批准。这通常是工作场所存在“政治”的原因。钱。

在工作之外与您的朋友/家人没有这样的政治。有没有？

就业场所是一个迫使我们进入等级制度的机构。啊!

解决方案：尝试完全避开雇主或将其作为长期目标而努力。做你自己的雇主。为什么不？产生某种形式的被动收入。

不要只为别人工作而把所有的鸡蛋放在一个篮子里——只为。你正在为跌倒做好准备。这是一个陷阱。谁愿意这样生活？

我们都擅长某些事情……开发人员很有创造力。

确定你擅长什么。创造它。卖掉它。但是为你做。不是雇主。尝试找到可以让您在财务上独立的利基市场。

从小处着手。婴儿步。;)

# c# - C#：比较两个 IEnumerables 的内容

> ID：630263
> 
> 赞同：54
> 
> 时间：2009-03-10T13:52:19.000
> 
> 标签：c#, linq

是否有一个内置的 linq 方法可以用来确定两个序列是否包含相同的项目，而不考虑顺序？

例如：

```
{1, 2, 3} == {2, 1, 3}
{1, 2, 3} != {2, 1, 3, 4}
{1, 2, 3} != {1, 2, 4} 
```

你有 SequenceEquals，但是我必须先订购两个序列，不是吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-10T13:55:38.743

有很多方法。假设 A 和 B 是 IEnumerable。

```
!A.Except(B).Any() && !B.Except(A).Any()
A.Count() == B.Count() && A.Intersect(B).Count() == B.Count()
etc 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-01-11T14:49:29.850

如果您不关心重复项（即您认为`{1, 2, 3}`等于`{1, 2, 3, 2}`），那么：

```
new HashSet<int>(A).SetEquals(B) 
```

（或者任何类型是元素类型而不是`int`）。

除此以外：

```
public static bool SequenceEqualUnordered<T>(IEnumerable<T> first, IEnumerable<T> second)
{
    if (first == null)
        return second == null; // or throw if that's more appropriate to your use.
    if (second == null)
        return false;   // likewise.
    var dict = new Dictionary<T, int>(); // You could provide a IEqualityComparer<T> here if desired.
    foreach(T element in first)
    {
        int count;
        dict.TryGetValue(element, out count);
        dict[element] = count + 1;
    }
    foreach(T element in second)
    {
        int count;
        if (!dict.TryGetValue(element, out count))
            return false;
        else if (--count == 0)
            dict.Remove(element);
        else
            dict[element] = count;
    }
    return dict.Count == 0;
} 
```

记录第一个序列中的每个元素，然后对照它检查第二个元素。当你在第二个序列中有一个太多时，你可以返回 false，否则如果你在计数字典中没有任何内容，那么它们是相等的，或者如果还有任何元素，则返回 false。

而不是两种 O(n log n) 使用，`OrderBy()`然后是 O(n) 比较，您有一个 O(n) 操作来构建计数集，并对其进行 O(n) 检查。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-01-03T13:41:08.927

使用两个 IEnumerables（A 和 B）：

```
bool equal = (A.Count() == B.Count() && (!A.Except(B).Any() || !B.Except(A).Any())) 
```

我认为这比 except(A).Count 更好，因为不会评估整个 Excep。只要在例外中找到一个元素，它就会停止。使用 Count，评估整个 except。最重要的是，我们可以通过首先检查 Count 属性来避免评估这些代价高昂的 except。如果计数不相等，那么我们检查例外。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-10T16:06:30.053

试试 HashSet 类：

```
var enumA = new[] { 1, 2, 3, 4 };
var enumB = new[] { 4, 3, 1, 2 };

var hashSet = new HashSet<int>(enumA);
hashSet.SymmetricExceptWith(enumB);
Console.WriteLine(hashSet.Count == 0); //true => equal 
```

但这只有在值不同的情况下才能正常工作。

例如

```
var enumA = new[] { 1, 1, 1, 2 };
var enumB = new[] { 1, 2, 2, 2 }; 
```

也被认为与上述方法“相等”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-09-08T09:36:20.950

坚持您的示例，您可以将两个 IEnumerable 都设为 List 类型，然后使用 SequenceEqual 作为下面的示例：

```
var first = Enumerable.Range(1, 3);
var second = Enumerable.Range(1, 3);
var areTheyEqual = first.ToList().SequenceEqual(second.ToList());
if (areTheyEqual)
{ /* do something... */} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-10T14:18:28.783

我这样做是为了将新项目合并到一个没有重复的集合中，它需要两个集合并返回所有没有任何重复的项目

```
List<Campaign> nonMatching = (from n in newCampaigns 
where !(from e in Existing select e.Id).Contains<int>(n.Id) 
select n).ToList<Campaign>(); 
```

现在通过删除 ! 对于包含语句

```
List<Campaign> nonMatching = (from n in newCampaigns 
where (from e in Existing select e.Id).Contains<int>(n.Id) 
select n).ToList<Campaign>(); 
```

它将返回重复项

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-07-07T07:39:28.467

为了比较两个对象中的数据，我简单地使用了这个

```
A.Except(B).Any() || B.Except(A).Any() 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T13:53:28.703

我认为排序序列是实现这一目标的最快方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-10T15:51:34.800

如果您真的只是在测试是否有重复项，那么 leppie 的建议应该有效：

```
if (A.Except(B).Count == 0 && B.Except(A).Count == 0) {...} 
```

但是，如果您只需要获得没有重复的 IEnumerable：

```
var result = A.Union(B).Distinct(); 
```

# iphone - iPhone UIView 动画最佳实践

> ID：630265
> 
> 赞同：142
> 
> 时间：2009-03-10T13:52:58.937
> 
> 标签：iphone, ios, cocoa-touch, uiview, core-animation

在 iPhone 上动画视图转换的最佳实践是什么？

例如，`ViewTransitions`apple 的示例项目使用如下代码：

```
CATransition *applicationLoadViewIn = [CATransition animation];
[applicationLoadViewIn setDuration:1];
[applicationLoadViewIn setType:kCATransitionReveal];
[applicationLoadViewIn setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn]];
[[myview layer] addAnimation:applicationLoadViewIn forKey:kCATransitionReveal]; 
```

但也有一些代码片段漂浮在网上，看起来像这样：

```
[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:0.75];
[UIView setAnimationDelegate:self];
[UIView setAnimationTransition:UIViewAnimationTransitionFlipFromRight forView:myview cache:YES];
[myview removeFromSuperview];
[UIView commitAnimations]; 
```

最好的方法是什么？如果您也可以提供一个片段，那将不胜感激。

**注意：**我无法让第二种方法正常工作。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2010-08-09T15:02:30.417

从[UIView 参考](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW14)关于该`beginAnimations:context:`方法的部分：

> 在 iPhone OS 4.0 及更高版本中不鼓励使用此方法。您应该改用基于块的动画方法。

**例如基于 Tom's Comment 的基于块的动画**

```
[UIView transitionWithView:mysuperview 
                  duration:0.75
                   options:UIViewAnimationTransitionFlipFromRight
                animations:^{ 
                    [myview removeFromSuperview]; 
                } 
                completion:nil]; 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-05-04T08:22:52.517

我一直在使用后者来制作很多漂亮的轻量级动画。您可以使用它交叉淡入淡出两个视图，或将一个淡入另一个视图，或将其淡出。您可以像横幅一样拍摄另一个视图，可以拉伸或缩小视图...我从`beginAnimation`/中获得了很多里程`commitAnimations`。

不要以为你能做的就是：

```
[UIView setAnimationTransition:UIViewAnimationTransitionFlipFromRight forView:myview cache:YES]; 
```

这是一个示例：

```
[UIView beginAnimations:nil context:NULL]; {
    [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
    [UIView setAnimationDuration:1.0];
    [UIView setAnimationDelegate:self];
    if (movingViewIn) {
// after the animation is over, call afterAnimationProceedWithGame
//  to start the game
        [UIView setAnimationDidStopSelector:@selector(afterAnimationProceedWithGame)];

//      [UIView setAnimationRepeatCount:5.0]; // don't forget you can repeat an animation
//      [UIView setAnimationDelay:0.50];
//      [UIView setAnimationRepeatAutoreverses:YES];

        gameView.alpha = 1.0;
        topGameView.alpha = 1.0;
        viewrect1.origin.y = selfrect.size.height - (viewrect1.size.height);
        viewrect2.origin.y = -20;

        topGameView.alpha = 1.0;
    }
    else {
    // call putBackStatusBar after animation to restore the state after this animation
        [UIView setAnimationDidStopSelector:@selector(putBackStatusBar)];
        gameView.alpha = 0.0;
        topGameView.alpha = 0.0;
    }
    [gameView setFrame:viewrect1];
    [topGameView setFrame:viewrect2];

} [UIView commitAnimations]; 
```

如您所见，您可以使用 alpha、帧，甚至视图的大小。到处玩。您可能会对它的功能感到惊讶。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2009-03-10T15:24:45.003

不同之处似乎在于您需要对动画进行控制。

该`CATransition`方法为您提供了更多的控制权，因此可以设置更多的东西，例如。计时功能。作为一个对象，您可以将其存储以备后用，重构以将所有动画指向它以减少重复代码等。

类方法是常见动画的`UIView`便捷方法，但比`CATransition`. 例如，只有四种可能的过渡类型（向左翻转、向右翻转、向上卷曲、向下卷曲）。如果你想做一个淡入，你必须要么向下挖掘淡入淡出过渡，要么为你的 alpha`CATransition's`设置一个明确的动画。`UIView`

请注意，`CATransition`在 Mac OS X 上，您可以指定任意`CoreImage`过滤器用作过渡，但就目前而言，您无法在缺少`CoreImage`.

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2012-01-20T09:10:50.820

我们可以使用这个简单的代码在 ios 5 中为图像制作动画。

```
CGRect imageFrame = imageView.frame;
imageFrame.origin.y = self.view.bounds.size.height;

[UIView animateWithDuration:0.5
    delay:1.0
    options: UIViewAnimationCurveEaseOut
    animations:^{
        imageView.frame = imageFrame;
    } 
    completion:^(BOOL finished){
        NSLog(@"Done!");
    }]; 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-10-11T10:19:40.520

在`UIView`文档中，阅读有关**ios4+的此功能**

```
+ (void)transitionFromView:(UIView *)fromView toView:(UIView *)toView duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options completion:(void (^)(BOOL finished))completion 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-03-08T04:12:12.523

无论如何，现在首选“阻止”方法。我将解释下面的简单块。

考虑下面的片段。bug2 和 bug 3 是 imageViews。下面的动画描述了延迟 1 秒后持续时间为 1 秒的动画。bug3 从它的中心移动到 bug2 的中心。动画完成后，将记录“中心动画完成！”。

```
-(void)centerAnimation:(id)sender
{
NSLog(@"Center animation triggered!");
CGPoint bug2Center = bug2.center;

[UIView animateWithDuration:1
                      delay:1.0
                    options: UIViewAnimationCurveEaseOut
                 animations:^{
                     bug3.center = bug2Center;
                 } 
                 completion:^(BOOL finished){
                     NSLog(@"Center Animation Done!");
                 }];
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-07-03T07:19:52.550

这是平滑动画的代码。
[我从本教程中找到了这段代码。](http://www.lafosca.cat/smooth-and-custom-animations-in-ios/)

```
CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"transform.scale"];
[animation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]];
[animation setAutoreverses:YES];
[animation setFromValue:[NSNumber numberWithFloat:1.3f]];
[animation setToValue:[NSNumber numberWithFloat:1.f]];
[animation setDuration:2.f];
[animation setRemovedOnCompletion:NO];

[animation setFillMode:kCAFillModeForwards];
[[self.myView layer] addAnimation:animation forKey:@"scale"];/// add here any Controller that you want t put Smooth animation. 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-03-15T12:50:19.097

让我们尝试检查一下 Swift 3：

```
UIView.transition(with: mysuperview, duration: 0.75, options:UIViewAnimationOptions.transitionFlipFromRight , animations: {
    myview.removeFromSuperview()
}, completion: nil) 
```

# language-agnostic - 在大型项目中拥有超过 65536 个用户定义类型是否合理？

> ID：630266
> 
> 赞同：0
> 
> 时间：2009-03-10T13:53:03.477
> 
> 标签：language-agnostic, class, projects, struct

我正在考虑一些与运行时类型信息相关的东西，我想从从事比我大得多的项目的程序员那里得到一些反馈。期望任何程序在单个项目中拥有超过 65536 (2^16) 个用户定义类型（类和结构）是否完全合理？这并不**意味着**65536 个实例，它意味着 65536 个**类型**。如果编译器在任何一个项目中将您限制为 65536 个类/结构，这在实践中是否重要？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T13:56:43.950

不，因为那时你应该强烈地解耦项目。只有“面向公众”的类型需要跨项目相互交互。然后限制变为：每个项目最多 2^16 种类型，所有项目中最多 2^16 种面向公众的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T14:06:11.167

我认为这是对环境的限制。在某些系统中，类型是自动生成的。在这些情况下，将创建大量类型。即使这些不在 65536 附近，你为什么要施加这样的限制？

在所有现代应用程序/系统中，所有对象的数量仅受系统内存限制。有任何其他限制是一种倒退。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:43:10.597

这是一个优先事项。在当前项目范围内，花费在实现“无限”数量的类型上的时间（和代码量）是否合理？

随着项目/编译器的增长，您还需要考虑可维护性。

我想说的是，如果您没有专门针对这一点，那么像拥有大量类型的特殊情况并不能真正证明将其考虑在内。你的目标受众是谁？

**更新：** 在某些情况下，您可能实际上想要限制自己，以便在其他方面（如内存、执行速度等）变得更有效率。只要有明确的记录，我认为您应该选择适合您特定需求的东西.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T13:56:15.777

谁说类型信息 == 16 位数字？

# c# - 为什么aspx中的这个数据绑定不起作用？

> ID：630269
> 
> 赞同：0
> 
> 时间：2009-03-10T13:53:34.053
> 
> 标签：c#, .net, asp.net, data-binding, .net-2.0

我有以下数据源绑定：

```
MembershipProvider provider = new MembershipProvider();
UserUpdateLogs userUpdateLogs = provider.GetUserUpdateLogs(username);

dgUserUpdateLog.DataSource = userUpdateLogs.Logs;
dgUserUpdateLog.DataBind(); 
```

**Logs**是**UserUpdateLogEntry**的集合。此类拥有**UserData**属性，而 UserData 包含其他属性。我的aspx：

```
<Columns>
<asp:BoundColumn DataField="ChangeDate" Visible="true" HeaderText="Date"/>
<asp:BoundColumn DataField="UserData.Sex" HeaderText="Sex" />
<asp:BoundColumn DataField="UserData.Phone" HeaderText="Phone" />
</Columns> 
```

第一行（**ChangeDate**）似乎运行良好。但是在渲染第二个BoundColumn时，会出现如下错误：

> 在所选数据源上找不到名为“UserData.Sex”的字段或属性。

为什么会这样？Aspx 不能识别诸如 PropertyA.PropertyB 之类的属性的串联吗？

我检查了对象，所有属性都有有效数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T14:08:05.517

您不能以这种方式绑定到子对象的属性。

作为替代方案，您可以使用模板列并使用 Eval 显示子对象的属性，例如：

```
<asp:TemplateColumn HeaderText="Sex" Visible="true">
  <ItemTemplate>
    <asp:Literal runat="server" Text='<%# Eval("UserData.Sex") %>' /> 
  </ItemTemplate>
</asp:TemplateColumn>
<asp:TemplateColumn HeaderText="Phone" Visible="true">
  <ItemTemplate>
    <asp:Literal runat="server" Text='<%# Eval("UserData.Phone") %>' /> 
  </ItemTemplate>
</asp:TemplateColumn> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T14:10:23.607

您可以做的一件事是创建访问器属性：

```
public string UserSex
{
    get { return userUpdateLogs.Logs.UserData.Sex; }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:07:31.790

C# 正在使用反射来查找名为 的属性`UserData.Sex`，它不够聪明，无法搜索`UserData`然后`Sex`。
所以你的问题的答案是“不”。

有几种方法可以解决这个问题，但更优雅的方法是添加属性 UserSex，或者将对象展平到数据表中。目前，我想不出不破坏OO的好方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T14:09:50.923

我不确定要告诉您为什么它不起作用，但编写此代码的解决方法可能是使用一些 linq2objects：

```
dgUserUpdateLog.DataSource = (from n in userUpdateLogs.Logs select new {n.ChangeDate, Sex=n.Userdata.Sex, Phone=n.UserData.Phone}); 
```

然后：

```
<Columns>
<asp:BoundColumn DataField="ChangeDate" Visible="true" HeaderText="Date"/>
<asp:BoundColumn DataField="Sex" HeaderText="Sex" />
<asp:BoundColumn DataField="Phone" HeaderText="Phone" />
</Columns> 
```

# c# - 只能在 C# 中的程序集内部继承

> ID：630272
> 
> 赞同：15
> 
> 时间：2009-03-10T13:53:48.203
> 
> 标签：c#, oop, inheritance

在 C# 中有没有办法指定一个类只能由同一程序集中存在的类继承，而其他程序集的行为应该像公共密封类型。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-10T14:08:49.837

我认为 Eric Lippert 在这里得到了定义性的报价：

*   [防止第三方衍生第一部分](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/preventing-third-party-derivation-part-one)
*   [防止第三方衍生第二部分](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/preventing-third-party-derivation-part-two)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-10T14:01:04.130

语言本身并没有使这变得容易的任何东西，但是您应该能够通过使构造函数内部化来做到这一点。但是，如果这样做，您将无法从外部程序集中对其进行更新，因此您必须添加工厂方法。

```
public class Foo
{
    internal Foo()
    {
    }

    public Foo Create()
    {
        return new Foo();
    }
} 
```

这是一种替代方法，可让您在外部程序集中新建类

```
public sealed class Foo : FooBase
{

}

public class FooBase
{
    internal FooBase() { }
} 
```

但是，您可能会问自己一个问题，这正是您希望课程被密封的*原因。*有时这是不可避免的，但我看到这个`sealed`关键字经常被滥用，所以我想我会提出来。通常，开发人员会密封类，因为他们过度保护自己的代码。 *大多数时候*，如果一个类设计得很好，它就不需要密封。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-10T14:06:01.980

如果你的类是抽象的，有一个非常简单的方法来做到这一点：

```
public abstract class Foo {
    internal abstract void DoNothing();
    // ... other members
} 
```

现在，尽管您的类和大多数成员都是公共的，但内部抽象成员无法从程序集外部的类派生。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-03-13T11:50:10.120

为了在 10 年后回答这个问题（我一直在寻找同样的解决方案，所以我认为写下来以防其他人在未来遇到同样的问题），这个问题已经得到了本地解决（尽管是间接的） )，使用C# 7.2 中引入的“ [private protected ”访问修饰符。](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/private-protected)

此修饰符仅在它位于同一程序集中且从基类派生的情况下才允许访问。将其应用于构造函数，并且不能在当前程序集之外派生。顺便说一句，如果您可以摆脱“内部”和/或元数据，那就去做吧，因为这需要 C# 7.2，这可能会破坏与旧设备或应用程序的兼容性。另请注意，由此产生的错误（由于保护级别而无法访问构造函数）与您尝试派生密封类（无法派生密封类）不同，但最终结果是相同的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T14:08:02.537

你不能用语言结构来做到这一点，但可以尝试反射

```
public class MyClass{
  public MyClass(){
    if(this.GetType().Assembly != typeof(MyClass).Assembly){
        throw new Exception("Can't derive from this type!");
  }
} 
```

检查了它。似乎正在工作。唯一的问题是除非有人阅读文档，否则问题在运行时是已知的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-10T14:08:07.560

我能想到的唯一方法是在内部类上使用公共包装器，可能具有通用接口：

```
public interface IFoo
{
}

internal class Foo : IFoo
{
}

public sealed class PublicFoo : IFoo
{
    private Foo m_Foo = new Foo();
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-10-10T13:29:35.487

我知道这是一篇旧帖子，但我发现了另一种非常有效的方法，我想将它发布给其他人。

1.  使用内部构造函数创建一个基类。
2.  使您的派生类继承自基类并被密封。

````

```
public abstract class LockResult {
    internal LockResult() {

    }
}

public sealed class LockSucceededResult : LockResult {
    //Info for when a lock succeeded
}

public sealed class LockFailedResult : LockResult {
    //Info for when a lock failed
} 
```

````

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T13:57:27.007

没有。C# 语言本身没有这样的规定。然而，变通办法——正如其他人在这里所建议的——可能就足够了。

# javascript - 原型/javascript - 除非焦点在文本框中，否则 firefox 不会触发 keypress/keydown 事件

> ID：630276
> 
> 赞同：3
> 
> 时间：2009-03-10T13:55:01.523
> 
> 标签：javascript, events, prototypejs

以下适用于 IE6、IE7 和 chrome。不适用于 ff 3.0.7。

```
<html><head>
<script src="prototype.js" type="text/javascript" ></script>
<script type="text/javascript">
Event.observe(window, 'load', 
    function(){
        Event.observe(document.body, 'keydown', myEventHandler);
        alert('window load');
    });
function myEventHandler(evt) {
    alert(evt);
}
</script>
</head>
<body >
<input type="text" /><br><br>
</body></html> 
```

编辑：“不工作”是指 myEventHandler 没有在 Firefox 中触发。

EDIT2：此外，当焦点位于输入元素上时它工作正常。我希望它为所有按键触发。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-10T15:15:54.853

~~我不知道为什么你的代码不起作用，但它过于复杂~~- 这应该可以解决问题：

```
document.observe('keydown', myEventHandler); 
```

无需等待，`load`立即`document`可用。

* * *

您的代码不起作用，因为并非所有关键事件都源自文档的正文元素。Opera 的问题与 Firefox 中的问题类似，但原始元素似乎还取决于鼠标光标的位置。

无论如何，解决方法是在`document`级别捕获事件，因为只要没有人阻止它们这样做，所有 DOM 事件`document`最终都会冒泡。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T14:40:02.833

我还发现我的 keydown 事件没有在 Firefox 中触发类似代码。就我而言，我不需要使用除 Safari 和 Firefox 之外的任何东西，所以我没有在 IE 上测试过。尽管如此，观察 'document' 而不是 'document.body' 似乎有效：

```
document.observe('dom:loaded', function() {
    Event.observe(document, 'keypress', function(evt) {
       alert("In Keypress Function");
    });
}); 
```

现在，我意识到这是观察按键，而不是按键。AFAIK，按键是在按键后立即生成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T14:19:03.447

尝试用表单元素包装输入。如果这没有帮助，请将其扭曲到 div 中并将您的处理程序附加到 div。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-24T23:16:07.793

顺便说一句，对于 tab、esc 和类似的，您需要使用 keyup，而不是 keypress。至少对于 Safari，我花了很长时间才弄清楚这一点。

通过添加以下行自己查看：`alert ("Key :" + evt.keyCode);`在 anon. 功能。只有字形响应。

——戴夫

# html - VS2008 中的 HTML 编码 - 好主意？

> ID：630282
> 
> 赞同：0
> 
> 时间：2009-03-10T13:56:28.587
> 
> 标签：html, visual-studio-2008

到目前为止，我一直在使用 Macromedia HomeSite 5 来编写带有干净 HTML 的网页。现在我开始使用 Visual Studio 2008，我想问：扔掉 Homesite 并开始使用 VS 编写 HTML 页面是不是一个好主意？

我不使用任何视觉设计师，我只是手动编码所有 HTML。

**编辑：**感谢所有回复。有没有我应该尝试的免费的简单 HTML 编辑器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T14:00:17.983

是的 :) Visual Studio 有很好的工具来帮助你编写 html (intelisense)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T13:58:10.080

否 - 如果您要构建 ASPX 页面并需要代码集成，请使用 Visual Studio。但是，对于直接的 HTML，我不会这样做（而且，是的，我已经广泛使用了 Homesite 和 VS）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:20:12.960

您可以查看 MS Expression Web。它的 html 编辑器远远优于 VS2008 内置的编辑器。顺便说一句，Expression 是 Sharepoint 团队为构建其网站而选择的同一编辑器。

Expression 支持构建常规 html、编码 php、构建 .net 母版页等。我相信他们将在未来版本的 Visual Studio 中用该产品的引擎替换编辑器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T13:59:46.860

如果您只想直接编写 HTML 代码，我认为 Visual Studio 有点多。除非您打算进行全面的 ASP.NET 开发，否则有很多更轻量级的编辑器会更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T14:00:30.963

几年前我使用过 HomeSite，但我可以说 homesite 的编辑功能比今天的经典 ASP 和 HTML 上的 Visual Studio 更好。

如果您正在开发 asp.net 页面，请使用 Visual Studio 来完全支持 ASP.NET 控件。

但是，如果您只想编辑 HTML 页面。我认为 HomeSite 更好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T14:03:12.843

我一直使用 VS 进行 HTML 编码——尤其是在分屏模式下，我可以看到设计面板和 HTML 代码本身。

此外，HTML 并不像某些 WYSIWYG 编辑器那样臃肿。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T14:04:02.017

如果您正在寻找一个仅用于开发网页而不是 Web 应用程序的 IDE，我建议您使用 VS2008 之外的其他工具。如果您想构建 aspx 页面并使用代码，Vs2008 会好得多。在您的情况下，您正在寻找一个手动开发 html 页面的应用程序，并且可能切换到图形视图以查看它的呈现方式。对于这样的事情，坚持使用 HomeSite、Dreamweaver 或 Aptana。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T14:06:16.330

我非常喜欢 Homesite。到目前为止，它是当时最好的 html 编辑器（早在 97 - 99 年），我仍然认为它是一个非常好的 html 编辑器。它速度快，内存占用小得多，并且易于使用。但是，这将取决于您更喜欢哪种界面，需要哪些工具，以及您是否会考虑将来从事编程工作。如果你认为你可能想学习编程，那么坚持使用 studio，这样你就会非常熟悉它的界面。

hth..

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-10T14:10:56.960

我发现 Visual Studio 是 HTML 编码最糟糕的环境之一，还有 webtools 插件。

HTML/PHP 等编码有很多更好的竞争对手。Visual Studio 在从 Microsoft 开发的语言/框架（.NET、C#、ASP、VB、MFC）方面更有优势，当然还有 C/C++ 和一些非常好的调试工具（恕我直言，最适合 C/C++）。

它同意，Homesite、Dreamweaver、Webuilder、Quanta+ (KDE)... 更好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-10T14:20:35.393

我会使用 Visual Studio 开发一个 .NET 应用程序，但我不会用它来手工制作 html。

如果您想要某些功能，例如颜色编码的 html 块和自动完成，请使用简单的 html 编辑器。有一些非常便宜且免费的，如 Netbeans、Aptana 和 Topstyle。

如果您当前的 HomeSite 应用程序允许您为其他语言添加语法突出显示（更具体地说，当它完成时是 HTML 5），您不需要停止使用它。只有当您想使用 HTML5 时，如果您坚持使用 HTML4 突出显示和自动完成/智能感知，这只会成为一个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-10T14:34:35.873

我通常使用 Dreamweaver 进行页面布局（CSS 和 co），并在 VS 中进行 .net 编码。

css 页面在 VS 中看起来非常扭曲。

# view - Microsoft CRM 4.0 视图：如何创建一个全新的？

> ID：630284
> 
> 赞同：0
> 
> 时间：2009-03-10T13:56:34.467
> 
> 标签：view, dynamics-crm, customization, dynamics-crm-4

我想为 Microsoft CRM 4.0 创建一个全新的视图。我不想创建自定义视图并选择显示哪些列。

我想创建一个视图来表示我的实体和另一个实体之间特定连接的结果。

是否可以创建它？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T14:07:14.207

它总是会询问您要显示哪些列，它是 xml 查询语法的一部分。没有办法解决这个问题。

如果您创建了很多视图，您可以尝试导出自定义 xml 文件并复制 xml 节点，然后导入自定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-10T08:35:42.803

我认为您想通过从高级查找中获取 FetchXML 并在 IFRAME 中显示来创建自定义视图。

# performance - 以编程方式获取 Windows 上的每个进程的网络统计信息？

> ID：630285
> 
> 赞同：14
> 
> 时间：2009-03-10T13:56:38.117
> 
> 标签：performance, winapi, networking

我想知道哪些进程正在使用我的网络。这在 Linux 中很容易，但我不知道如何在 Windows 中做到这一点。

本质上，对于每个进程，我想知道它在一段时间内读取/写入网络的字节数。如果我能知道 IP 地址/端口号等，那就太棒了。

任何指针？Windows Vista/Windows 2008 似乎能够在资源监视器中执行此操作。他们是如何做到的呢？开销是多少？

我想在自己的代码中执行此操作，因此实用程序（TCPView、PerfMon）对我没有用。我还希望有单独的磁盘和网络 I/O 计数器，所以默认的性能计数器是不够的。

Windows XP、2003、Vista、2008 和 7 优先。Win32 或 COM 正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-05T15:50:50.563

经过大量研究，这是我想出的：

1.  各种论坛中有许多帖子要求提供相同的信息。
2.  我看到的唯一**可能的**编程解决方案是使用 Windows 事件跟踪 (ETW)。那需要一本小书来解释/理解。
3.  可以从注册表中获取的 PERF 计数器对 Powershell 不友好。它们使用旨在供 C/C++ 程序使用的数据结构。一个非常完整示例的 URL：http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa372138 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372138(v=vs.85).aspx)
4.  SysInternals 有 TCPVIEW，它按进程显示网络使用情况。当您启动它时，大多数进程不会显示任何使用情况。它似乎只收集它正在运行的时间段的使用信息。这为使用 ETW 的想法提供了支持。
5.  如果我用 IE9 浏览网站，我会看到 TCPVIEW 中正在创建进程。在大多数情况下，进程会在一分钟左右内消失（终止） - 以及进程的统计信息。
6.  与 ProcessExplorer 类似，当创建进程时，它们以绿色突出显示，当它们被销毁时，它们以红色突出显示。
7.  红色突出显示的进程在下一次更新后消失。更新频率可以是 1、2 或 5 秒。但是有一个注册表设置，HKEY_CURRENT_USER\Software\Sysinternals\TCPView\Settings 可以修改以设置其他刷新频率。If 是偏移量 0x98 处的 DWORD，以毫秒为单位。
8.  TCPVIEW 有一个“保存”/“另存为”菜单项。输出是一个空格分隔的文本文件，其中包含当前显示在 GUI 中的每个进程的使用情况统计信息。以下是文件中的示例行。行尾的数字是接收的 pkts/sec、接收的字节/秒、传输的 pkts/sec 和字节/秒，（不一定按此顺序） `iexplore.exe 864 TCP tin 61207 a96-17-203-64.deploy.akamaitechnologies.com http ESTABLISHED 2 12,928 8 9,420`

所以...

一种可能的解决方案是使用 TCPVIEW 并通过从脚本以编程方式生成的击键来控制它。您可以将刷新间隔设置为 1、10、30 等分钟，并让脚本发送击键以使 TCPVIEW 将输出保存在文件中。您可能希望脚本以刷新间隔的一半或三分之一发送击键，以确保您获得的快照至少与刷新间隔的 1/2 或 2/3 一样长。您可以使用 Import-CSV 导入文件，并在脚本中轻松操作它。

或者...

您可能会变得自虐并使用 ETW。

或者...

您可以深入研究并将 Linux 的 proc 文件系统（正如您所指出的那样，从脚本中使用起来更容易）到 Windows :-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T19:20:12.020

我为此写了一个解决方案。

用于收集统计信息的 TDI 过滤器驱动程序，该服务与驱动程序通信并每秒获取一次统计信息。由于过滤器在 TDI 层，我知道哪些套接字属于哪些应用程序。该服务是这些数据的服务器，通过我编写的 API 通过共享内存将其提供给任意第三方客户端。我写了一个 GUI 和一个命令行客户端。

您还可以对发送（每个接口和/或应用程序和/或套接字）进行带宽整形，并在窗口中实时观察通过套接字传递的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:31:05.290

你会惊讶于你可以从 Perfmon 中得到的东西。

调出它，右键单击图形区域，然后选择“添加计数器...”。四处冲浪，看看是否有任何东西可以满足您的需求。

根据我对您所要求的内容的阅读，我会选择“进程”作为我的性能对象，并开始从进程列表中选择可能看起来的罪魁祸首，可能会监视“IO 数据字节/秒”计数器。如果你在那里乱七八糟，你可能会发现一些对你更有用的东西。

**编辑**：我注意到它说“以编程方式”（昨天是这样说的吗？）

好吧，您实际上可以通过 key 获得 Perfmon 从注册表中获取的几乎所有信息`HKEY_PERFORMANCE_DATA`。我认为这就是 Perfmon 枚举和使用的内容，因此您应该能够使用 perfmon 来查看其中的内容并为您工作，然后编写代码在您自己的程序中实时读取它。

这种方法的真正好处之一是，如果您拥有正确的权限，它甚至可以远程工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T18:27:29.557

您将需要使用 IPHelper API。

这是一篇很好的文章，详细介绍了它在 .NET 中的使用：http: [//www.codeproject.com/KB/IP/iphlpapi.aspx](http://www.codeproject.com/KB/IP/iphlpapi.aspx)

享受。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-19T18:07:02.670

使用带有 EVENT_TRACE_FLAG_NETWORK_TCPIP 的 ETW 将完成这项工作。

# ruby - 我在哪里可以找到红宝石宝石系列？

> ID：630294
> 
> 赞同：0
> 
> 时间：2009-03-10T13:57:51.953
> 
> 标签：ruby, rubygems

我在哪里可以找到免费的 Ruby gem 集合？如果已经有可以重复使用的宝石，为什么还要重新发明轮子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T14:00:08.373

[RubyForge](http://rubyforge.org/)是去的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T14:01:45.373

实际上只有两个重要的宝石来源可用：

1.  [红宝石锻造](http://rubyforge.org)
2.  [GitHub](http://github.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:01:14.690

这是 GitHub 上的 RubyGems 列表：

```
http://gems.github.com/list.html 
```

有关如何下载的说明位于页面顶部。虽然不是 CPAN...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T14:01:04.767

维基百科说：

```
gem list -r -d 
```

[http://en.wikipedia.org/wiki/RubyGems](http://en.wikipedia.org/wiki/RubyGems)

# java - java/groovy/python 是否有任何合理的 SSDP 或 DIDL Lib？

> ID：630296
> 
> 赞同：3
> 
> 时间：2009-03-10T13:57:55.837
> 
> 标签：java, python, groovy, upnp

对于未来的项目，我正在寻找一个库来处理 DIDL-Lite xml 方言中的 SSDP 通信和消息。java、groovy或python有没有合理的实现？

我不喜欢使用现有 UPnP 堆栈的实现，例如cybergarage 或 frauenhofer UPnP 堆栈，因为它们高度依赖于这些堆栈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-07-15T13:14:57.060

[http://teleal.org/projects/cling](http://teleal.org/projects/cling)

面向 Java 和 Android 开发人员的开源 DLNA/UPnP 堆栈、库和工具

Cling 是非常模块化的，所以你只能使用它的 SSDP 功能。您可以在任何级别（数据传输、协议执行等）将其与现有代码集成。

Cling Support 包包含一个基于 JAXB 的 DIDL 解析器，用于可独立使用的 UPnP A/V 服务实现者。

# iphone - iPhone REST 客户端

> ID：630306
> 
> 赞同：22
> 
> 时间：2009-03-10T14:00:22.540
> 
> 标签：iphone, web-services, rest

有人知道 iPhone SDK 是否有任何好的库来调用 REST Web 服务。我想要一些简单的东西，比如[Heroku 休息客户端](http://github.com/adamwiggins/rest-client/tree/master)

* * *

谢谢大家的帮助。

我的服务器端在 Rails 上，所以看起来 ObjectiveResource 是我最需要的。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-11T08:11:29.263

我建议使用来自 All-Seeing Interactive 的优秀 ASIHTTPRequest 源：http: [//allseeing-i.com/ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest)。我正在这样做，还有几个已发布的 iPhone 应用程序也是如此，因此您可以确定代码非常可靠。

这是 CFNetwork API 的包装器，它使与 Web 服务器通信的一些更繁琐的方面变得更容易。它是用 Objective-C 编写的，适用于 Mac OS X 和 iPhone 应用程序。

它适用于执行基本的 HTTP 请求并与基于 REST 的服务（GET / POST / PUT / DELETE）进行交互。ASIFormDataRequest 子类使使用 multipart/form-data 提交 POST 数据和文件变得容易。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-10T14:56:22.437

希望[Andrian Kosmaczewski](http://kosmaczewski.net/2009/01/19/objective-c-rest-client-update/)的工作可以节省您重新发明轮子的时间：

[http://github.com/akosma/iphonerestwrapper/tree/master](http://github.com/akosma/iphonerestwrapper/tree/master)

而且，它是公共领域。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-01-10T20:31:09.303

看看 RestKit：[http:](http://restkit.org/) //restkit.org/它提供了一个优秀的 API，用于访问 RESTful Web 服务并将远程资源表示为本地对象，包括将它们持久化到 Core Data。它是完全异步的，并且具有许多其他巧妙的功能

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-11T06:47:57.017

如果您的 REST 服务是在 Ruby on Rails 中实现的，那么开源 ObjectiveResource 项目看起来很有希望。在我的一个相对复杂的项目中，它对我来说非常有用，我什至还为他们贡献了一些代码。

[目标资源](http://iphoneonrails.com/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-07T03:14:00.427

我创建了一篇关于这样做的博客文章。

[http://www.dreamfreeze.net/weblog/restful_webservices.html](http://www.dreamfreeze.net/weblog/restful_webservices.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-28T09:06:31.197

[akosma / iphonerestwrappert] 试试这个来自 github 的包装器

[Caged / httpriot](http://github.com/Caged/httpriot)这是一个非常简单的用于 iPhone 和 Cocoa 项目的 HTTP Rest 库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-11T20:16:23.723

在使用直到 iOS 4 之前您必须使用的超级冗长和痛苦的委托之后，我们转向使用块来实现异步行为。它真的很棒，最近我们的代码实际上是可读的。

我们开源了我们在这里使用的其余客户端：

[https://github.com/jeremylightsmith/RestClient](https://github.com/jeremylightsmith/RestClient)

让我们知道它是如何为您工作的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-29T04:31:17.067

您可以使用 iphone 上的 rest 客户端应用程序检查服务器响应 - [http://itunes.apple.com/us/app/rest-client/id503860664?ls=1&mt=8](http://itunes.apple.com/us/app/rest-client/id503860664?ls=1&mt=8)

这可以帮助您在服务器端调试代码。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-10T14:04:54.087

使用基于 REST 的服务确实不需要“好的库”。

SDK 中包含的 NSURLConnection 和 NSURLRequest 是您真正需要的。

# linq - 如何使用 LINQ2SQL 添加多个依赖记录

> ID：630320
> 
> 赞同：1
> 
> 时间：2009-03-10T14:02:55.247
> 
> 标签：linq, linq-to-sql

我有两张桌子。一个表包含对帖子的评论，另一个包含评论者信息，如昵称、站点等。两个表之间存在 FK 关系 Comment.CommenterId -> Commenter.Id 每当用户发表评论时，我需要同时添加评论和评论者. 问题是我不知道添加后的 Commenter.Id 是什么，以便在添加前将其分配给 Comment.CommenterId。

进行此类插入的最佳做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:17:15.853

你可以这样做：

```
Comment comment = new Comment(); // your constructor here
Commenter commenter = new Commenter(); // use your constructor;

comment.Commenter = commenter; // linq2sql creates this property for you.

datacontext.Commenter.InsertOnSubmit(commenter);
datacontext.Comment.InsertOnSubmit(comment);

datacontext.SubmitChanges(); 
```

此代码尚未在此处以任何方式进行测试，因此可能存在语法或其他错误，但这基本上是您需要做的。

# http - 您如何检索 Web 应用程序的客户端用户的时区？

> ID：630321
> 
> 赞同：5
> 
> 时间：2009-03-10T14:03:03.703
> 
> 标签：http, browser, timezone, client

问题就像听起来一样 - 如何根据浏览器输入检索客户端用户的时区？如果重要的话，服务器端会使用 J2EE——但我认为在这种情况下这并不重要。目前，HTTP 是协议，它上线时可能会使用 HTTPS。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-12-02T14:20:21.690

可能你可以使用一些javascript：http: [//jeoftp.blogspot.com/2009/03/determine-java-timezone-of-your-web.html](http://jeoftp.blogspot.com/2009/03/determine-java-timezone-of-your-web.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T14:08:10.897

似乎有人[破解了一些 javascript](http://devblog.redfin.com/2007/08/getting_the_time_zone_from_a_web_browser.html)来推断这一点，但是是的，最好的方法是让用户决定。但是您可以使用上面的链接为用户选择默认值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:06:16.177

我确定这是重复的。

最好的方法是询问用户。默认情况下，时区不在 HTML 标头中发送。还要考虑来自一个时区的用户可能正在访问另一个时区。您应该使用哪个时区？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T14:27:02.770

您还可以使用 IP 地理定位服务，例如 ip2location。他们[出售数据库订阅](http://www.ip2location.com/ip2location-application.aspx)，该订阅将返回 IP 地址所在的时区。当然，这是有代价的。[Javascript 解决方案](http://devblog.redfin.com/2007/08/getting%5Fthe%5Ftime%5Fzone%5Ffrom%5Fa%5Fweb%5Fbrowser.html)可以工作，但需要客户端支持。

地理位置将支持任何客户端，但可能会提供错误的结果，具体取决于 IP 块的归属方式或客户端是否使用位于不同时区的代理服务器（很可能是异常代理服务）。Javascript 解决方案将支持多种客户端，但将根据计算机设置返回时区，而不是根据实际位置返回时区（旅行用户并不总是更改计算机上的时间）。因此，没有一个单一的解决方案可以涵盖所有这些。

使用这两种方法中的一种进行猜测，然后允许用户进行更正，这将是我认为的最佳方法。如果您想过度使用两者并让用户决定哪个最有意义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T14:42:46.663

正如[Pierre-Luc Simard](https://stackoverflow.com/questions/630321/how-do-you-retrieve-the-client-users-time-zone-for-a-web-application/630460#630460)所说，这是一个非常好的主意，您可以使用 IP 来推断该信息。归功于他，但我将添加另一个链接，指向一个免费的替代品，即[Maxmind 的 Geolite](http://www.maxmind.com/app/geolitecity)。PHP 中还有一个[用于时区的示例代码，](http://geolite.maxmind.com/download/geoip/api/php/timezone/)我很确定您会在他们的[Java API](http://www.maxmind.com/app/java)中找到等效代码。

# language-agnostic - 文档交互 Web 应用程序的最佳框架

> ID：630327
> 
> 赞同：0
> 
> 时间：2009-03-10T14:03:55.137
> 
> 标签：language-agnostic

此 Web 应用程序的要求包括：

1-需要与其他几个不一定有任何类型的 API 的网站进行交互，所以我基本上必须构建一个服务器端 Web 客户端。我在 Java 中使用过 HttpClient，在 Ruby 中使用过类似的东西，但想确保它可以处理下载、cookie 等。

2- 需要解析和修改 Excel（xls 和 csv）文件。

3-需要获取MS Word文件并填写字段（您可以在Word中插入的灰色框类型）。

4-想将Word转换为PDF。

我更喜欢使用 Rails，但目前 Grails 似乎是最好的选择，因为我知道 HttpClient 和 Apache 的 POI 和 HSSF 库。有什么建议或更好的选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:19:56.593

您可能想看看[Open Office Java Api](http://api.openoffice.org/)

在我的公司，我们成功地使用它来生成基于模板的文档，填写字段的值并将 Word 文档转换为 PDF 格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-06T10:23:09.763

Big Blue Button 和 OpenMeeting 已经这样做了（以及更多）

也许看看那里的源代码寻求帮助？

# c# - C# 中的“() =>”是什么意思？

> ID：630330
> 
> 赞同：16
> 
> 时间：2009-03-10T14:04:22.140
> 
> 标签：c#, syntax, lambda

在复合应用程序指南中遇到以下行。

我知道**=>**是一个 lambda，但**()**是什么意思？

还有哪些其他例子？

它叫什么，所以我可以搜索它？

```
this.regionViewRegistry.RegisterViewWithRegion(RegionNames.SelectionRegion
        , () => this.container.Resolve<EmployeesListPresenter>().View); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-10T14:06:36.003

这是一个接受 0 个参数的 lambda 表达式

[http://msdn.microsoft.com/en-us/library/bb397687.aspx](http://msdn.microsoft.com/en-us/library/bb397687.aspx)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-10T14:11:31.687

如果你看`x => x + 1`

它接受一个参数 x 并返回 x 加一。编译器将使用类型推断来推断 x 可能是 int 类型，并将返回另一个 int，因此您有一个 lambda，它采用 int 类型的参数 x 并返回一个整数。

```
() => 3; 
```

相同但不带参数，它将返回一个整数。

```
() => Console.WriteLine("hello"); 
```

将导致没有参数的 void 方法。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-10T14:06:02.510

这是一个空参数列表，这意味着 lambda 表达式不接受任何参数。

# syntax - 使用类似于 Make/Rake 的语法为 .NET 构建系统？

> ID：630332
> 
> 赞同：6
> 
> 时间：2009-03-10T14:05:45.427
> 
> 标签：syntax, msbuild, build

以 .NET 开发人员为主要目标受众的构建系统*没有*纯 XML 语法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-10T14:09:08.023

*   [Boo 构建系统](http://www.google.com/search?q=boo-build-system)（使用 Boo）
*   [Phantom](http://github.com/JeremySkinner/Phantom)（另一个使用 Boo 的）
*   [PSake](https://github.com/psake/psake)（使用 PowerShell）
*   [FAKE](https://github.com/forki/FAKE)（使用 F#）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T19:16:31.613

[FluentBuild](http://code.google.com/p/fluent-build/)

还有[UppercuT](http://code.google.com/p/uppercut/) - 它使用约定来进行构建，因此没有必要查看 XML 语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:08:57.433

我使用实际的 Ruby Rake，只需通过您的 Rake 脚本调用 msbuild 的强大功能。

在我看来，它非常简单并且比 XML 替代方案好得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-09T16:01:29.110

也可以查看 rake-dotnet：http: [//github.com/petemounce/rake-dotnet](http://github.com/petemounce/rake-dotnet)

我正要试一试！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-27T10:24:06.727

您绝对应该尝试**NUBuild**。

我是一名开发人员，我经常使用它，并且我使用大约 75 个项目，我需要在每次代码更改/发布时构建这些项目。它允许我在开发周期的早期而不是在我签入代码之后在本地和很多早期发现构建失败，从而为我节省了大量时间。

NUBuild 速度极快，易于设置（您只需执行一次），并通过让您进行“本地构建”，为您提供触手可及的完整构建服务器的强大功能。您不必编写“密集”xml 脚本。设置时只需创建一个简单的配置文件（请参阅用户指南）。它还具有许多其他高级特性和功能。您可以在项目站点（在 codeplex 上）找到更多详细信息：

[http://nubuild.codeplex.com/](http://nubuild.codeplex.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-12T06:04:01.617

[nRake](http://wiki.github.com/jcrisp/nRake/)是利用 Rake 本身的方式

# c# - 让 DataGridView 直观地反映其 DataSource 中的更改的正确方法

> ID：630343
> 
> 赞同：1
> 
> 时间：2009-03-10T14:06:31.993
> 
> 标签：c#, winforms, ado.net, datagridview

假设 a`DataGridView`将其`DataSource`属性设置为`DataView`实例。

```
DataGridView dgv;
DataTable dt;

// ... dt gets populated.

DataView dv = dt.DefaultView;

dgv.DataSource = dv;

// ... dt gets modified

// The DataGridView needs to update to show these changes visually
// What goes here? 
```

我知道你可以设置`dgv.DataSource`为`null`，然后返回`dv`。但这似乎很奇怪。我敢肯定还有其他几种方法。但是，正确的官方方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T14:12:09.547

*正确*的方法是让数据源实现`IBindingList`、返回和发出`true`事件。但是，AFAIK，*这样做*...`SupportsChangeNotification``ListChanged``DataView`

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T14:42:31.080

我很确定，如果您将 DataGridView 绑定到 DataTable 的 DefaultView，并且 Table 发生更改，则更改会自动反映在 DataGridView 中。你试过这个并且遇到问题吗？发布更新数据表的代码，也许还有其他问题。实际上，这是我刚刚编写的一个小示例应用程序：

```
public partial class Form1 : Form
    {
        private DataTable table;

        public Form1()
        {
            InitializeComponent();
            table = new DataTable();
            this.LoadUpDGV();
        }

        private void LoadUpDGV()
        {
            table.Columns.Add("Name");
            table.Columns.Add("Age", typeof(int));

            table.Rows.Add("Alex", 27);
            table.Rows.Add("Jack", 65);
            table.Rows.Add("Bill", 22);
            table.Rows.Add("Mike", 36);
            table.Rows.Add("Joe", 12);
            table.Rows.Add("Michelle", 43);
            table.Rows.Add("Dianne", 67);

            this.dataGridView1.DataSource = table.DefaultView;
        }

        private void button1_Click(object sender, EventArgs e)
        {
            table.Rows.Add("Jake", 95);
        }
    } 
```

基本上，当表单加载时，它只是用姓名和年龄填充表格。然后它将它绑定到 DGV。单击按钮时，它会向 DataTable 本身添加另一行。我对其进行了测试，果然它毫无问题地出现在网格中。

# c# - 类成员的自定义属性

> ID：630348
> 
> 赞同：8
> 
> 时间：2009-03-10T14:06:59.077
> 
> 标签：c#, reflection, attributes, custom-attributes

我正在使用自定义属性来定义如何将类的成员映射到属性以作为表单发布（支付网关）发布。我的自定义属性工作得很好，并且能够通过“名称”获取属性，但想通过成员本身获取属性。

例如：

```
getFieldName("name"); 
```

对比

```
getFieldName(obj.Name); 
```

计划是编写一个方法来将具有成员的类序列化为可发布的字符串。

这是我此时的测试代码，其中 ret 是一个字符串，PropertyMapping 是自定义属性：

```
foreach (MemberInfo i in (typeof(CustomClass)).GetMember("Name"))
{
    foreach (object at in i.GetCustomAttributes(true))
    {
        PropertyMapping map = at as PropertyMapping;
        if (map != null)
        {
            ret += map.FieldName;
        }
    }
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-10T14:18:34.757

您不能真正做到这一点，除非您使用的是 C# 3.0，在这种情况下您需要依赖 LINQ（嗯，表达式树）。

您所做的是为 lambda 表达式创建一个虚拟方法，让编译器生成表达式树（编译器进行类型检查）。然后你深入那棵树来获取成员。像这样：

```
static FieldInfo GetField<TType, TMemberType>(
    Expression<Func<TType, TMemberType>> accessor)
{
    var member = accessor.Body as MemberExpression;
    if (member != null)
    {
        return member.Member as FieldInfo;
    }
    return null; // or throw exception...
} 
```

给定以下课程：

```
class MyClass
{
    public int a;
} 
```

您可以像这样获取元数据：

```
// get FieldInfo of member 'a' in class 'MyClass'
var f = GetField((MyClass c) => c.a); 
```

通过对该字段的引用，您可以按照通常的方式挖掘任何属性。即反射。

```
static TAttribute GetAttribute<TAttribute>( 
    this MemberInfo member ) where TAttribute: Attribute
{
    return member.GetCustomAttributes( typeof( TAttribute ), false )
        .Cast<TAttribute>().FirstOrDefault<TAttribute>();
} 
```

现在，您可以通过编译器大量检查的内容来挖掘任何字段的属性。它也适用于重构，如果您重命名“a”，Visual Studio 会捕捉到这一点。

```
var attr = GetField((MyClass c) => c.a).GetAttribute<DisplayNameAttribute>();
Console.WriteLine(attr.DisplayName); 
```

那里的代码中没有一个文字字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-10T14:16:22.547

你可以更简单地做一半：

```
 foreach (PropertyMapping attrib in
        Attribute.GetCustomAttributes(i, typeof(PropertyMapping)))
    {
        ret += map.FieldName; // whatever you want this to do...
    } 
```

顺便提一句; 你应该养成用单词结束属性的习惯`Attribute`。即使这会导致重复（参见 参考资料`[XmlAttributeAttribute]`）。

然而——重新序列化；这并不总是微不足道的。大量的代码进入序列化框架，如 Json.NET 等。通常的方法可能是获取类型转换器，但在许多方面，使用`PropertyDescriptor`:

```
 foreach (PropertyDescriptor prop in TypeDescriptor.GetProperties(obj))
    {
        Console.WriteLine("{0}={1}",
            prop.Name, prop.Converter.ConvertToInvariantString(
                prop.GetValue(obj)));
    } 
```

# vba - 统一链接单元格内容

> ID：630362
> 
> 赞同：0
> 
> 时间：2009-03-10T14:08:18.277
> 
> 标签：vba, excel

我有一个大组中的系统列表，这些系统被视为一个系统。它们每个都具有“已评估”状态，但我想以某种方式将组中的所有这些系统链接在一起，这样如果我更改其中任何一个的评估状态，它将更新到组中的所有系统。除了将一个指定为“主”系统并让所有其他系统链接到该系统之外，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T21:40:59.380

如果我没看错，你想要的是

```
 A      B  
------  ------
sys1    Assessed
sys2    Assessed
sys3    Assessed 
```

成为

```
 A      B  
------  ------
sys1    foo
sys2    foo
sys3    foo 
```

如果您在任何“已评估”单元格上键入“foo”。在不使用其他单元格的情况下执行此操作的最简单方法是使用 worksheet_change() 事件。[在这里](http://www.ozgrid.com/VBA/run-macros-change.htm)阅读所有相关信息。

这里有一些东西可以让你继续前进。打开 VBA 编辑器 (ALT+F11) 并双击您的工作表名称。在生成的代码窗格中放置您的 worksheet_change() 代码。也许是这样的：

```
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    If Target.Cells.Count > 1 Or IsEmpty(Target) Then Exit Sub

    Dim startCell As Range
    Set startCell = Range("B1")

    Dim r As Range
    Set r = Range(startCell, startCell.End(xlDown).Address)

    If Not Intersect(Target, r) Is Nothing Then
        r = Target
    End If

End Sub 
```

这将查找从 B1 到其下方最后一个连续单元格的更改。

# bash - 确定执行 BASH 脚本的路径

> ID：630372
> 
> 赞同：124
> 
> 时间：2009-03-10T14:10:22.873
> 
> 标签：bash

> **可能重复：**
> [Bash 脚本可以告诉它存储在哪个目录中吗？](https://stackoverflow.com/questions/59895/can-a-bash-script-tell-what-directory-its-stored-in)

*在 Windows命令*脚本中，可以使用`%~dp0`. 例如：

```
@echo Running from %~dp0 
```

[BASH](http://www.gnu.org/software/bash/)脚本中的等价物是什么？

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2009-03-10T14:12:26.160

对于相对路径（即直接等效于 Windows' `%~dp0`）：

```
MY_PATH=$(dirname "$0")
echo "$MY_PATH" 
```

对于绝对的规范化路径：

```
MY_PATH=$(dirname "$0")            # relative
MY_PATH=$(cd "$MY_PATH" && pwd)    # absolutized and normalized
if [[ -z "$MY_PATH" ]] ; then
  # error; for some reason, the path is not accessible
  # to the script (e.g. permissions re-evaled after suid)
  exit 1  # fail
fi
echo "$MY_PATH" 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-03-10T14:17:55.837

假设您输入 bash 脚本的完整路径，请使用`$0`and `dirname`，例如：

```
#!/bin/bash
echo "$0"
dirname "$0" 
```

示例输出：

```
$ /a/b/c/myScript.bash
/a/b/c/myScript.bash
/a/b/c 
```

如有必要，将`$PWD`变量的结果附加到相对路径。

编辑：添加引号来处理空格字符。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-10T14:58:28.780

由***Stephane CHAZELAS***在 cus 上贡献 假设 POSIX shell：

```
prg=$0
if [ ! -e "$prg" ]; then
  case $prg in
    (*/*) exit 1;;
    (*) prg=$(command -v -- "$prg") || exit;;
  esac
fi
dir=$(
  cd -P -- "$(dirname -- "$prg")" && pwd -P
) || exit
prg=$dir/$(basename -- "$prg") || exit 

printf '%s\n' "$prg" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-05-03T12:24:53.957

Vlad 的代码被高估了。应该：

```
MY_PATH=`dirname "$0"`
MY_PATH=`( cd "$MY_PATH" && pwd )` 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-09-20T03:14:33.000

```
echo Running from `dirname $0` 
```

# stored-procedures - 将值数组发送到存储过程的最佳方法

> ID：630376
> 
> 赞同：1
> 
> 时间：2009-03-10T14:10:44.137
> 
> 标签：stored-procedures

我应该使用 CSV 字符串、XML 字符串还是...？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:13:47.483

哪个数据库和版本？在 SQL Server 2008 中，您可以使用表值参数。2005年，没有那么多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T14:16:05.730

这实际上取决于您使用的数据库。

MS SQL 2005 将 XML 数据类型引入 Microsoft 平台。Oracle9i 引入了 XMLTYPE。MySql 还有ExtractValue 和UpdateXML 等XML 函数。MS SQL 2008 具有表值参数，允许您以表格式传入数据。

问题实际上归结为您希望如何使用这些值。您是将它们撕开以存储在表中还是要存储整个 blob？

如果撕开并且只有几个值，我建议使用常规字符串解析或表值参数。否则做 XML。

请记住，SQL（无论风格如何）并不真正适合字符串解析。因此，如果您走这条路，您可以在数据库中创建一个辅助函数（CLR、UDF 等）来为您处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T14:14:00.713

我通常使用 CSV 字符串，所以我不会超过 varchar 字段的最大长度。为此目的，XML 似乎有点冗长。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T14:14:39.727

有特定的 API 可以做到这一点……在 Java 中，您可以使用对象准备语句并指定数据库类型，JDBC 将处理转换。无论如何，这是非常特定于供应商的。我不建议使用任何一种建议的技术，因为它们“隐藏”了具有危险副作用的参数类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T14:15:19.023

在 2005/2000 年，我们必须创建一个 Xml 字符串，然后使用 Xml Parser (2005) 解析它，或者在 2000 年继续使用。不太好，但它完成了工作。

```
 <ArrayOfGuid><Guid></Guid></ArrayOfGuid> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T14:20:51.960

每当我必须将数组发送到存储过程时，我通常会退后一步考虑“为什么？”。通常，我可以向 sproc 发送一些其他标准，这将允许 sproc 在不需要数组的情况下生成正确的结果。

在某些情况下，我最终不得不传递数组，在这些情况下，我发现传递 xml 在 mssql 中可以正常工作。

# powershell - 如何从 32 位 Powershell 实例访问 64 位注册表？

> ID：630382
> 
> 赞同：19
> 
> 时间：2009-03-10T14:11:09.970
> 
> 标签：powershell, registry, 64-bit

如果您启动 Powershell 的 32 位实例 (%SystemRoot%\syswow64\WindowsPowerShell\v1.0\powershell.exe)，则注册表提供程序只能看到注册表的有限 32 位部分。

```
**32-bit console**
PS> (dir HKLM:\SOFTWARE | measure).count - (dir HKLM:\SOFTWARE\wow6432node | measure).count

0

**64-bit console**
PS> (dir HKLM:\SOFTWARE | measure).count - (dir HKLM:\SOFTWARE\wow6432node | measure).count

-5 
```

有没有办法强制提供者进入 64 位模式？我可以下拉到 [Microsoft.Win32] .Net API，或者 WMI，但我宁愿不这样做。如果这完全扩展了可能性，我正在使用 Powershell v2 CTP3。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-10-15T12:19:44.500

使用 .NET API，您可以读取 64 位值，如下所示：

```
$key = [Microsoft.Win32.RegistryKey]::OpenBaseKey([Microsoft.Win32.RegistryHive]::LocalMachine, [Microsoft.Win32.RegistryView]::Registry64)
$subKey =  $key.OpenSubKey("SOFTWARE\Microsoft\.NETFramework")
$root = $subKey.GetValue("InstallRoot") 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-10T15:30:40.200

当 Powershell 作为 32 位进程运行时，我不知道将其“切换”到 64 位模式的机制。64 位系统中虚拟化支持的全部意义在于让 32 位进程相信它们生活在 32 位操作系统中……

但是，这就是说我过去使用了以下技术，它对我来说效果很好（以下代码在带有 Powershell v1 的 Vista SP1 x64 上进行了测试）。该技术依赖于这样一个事实，即 .NET 的“任何 CPU”可执行文件将作为 64 位进程运行，即使从 32 位进程调用也是如此。我们将执行的步骤：

1.  编译一个简短的 C# 程序，它将启动 powershell（即一个非常简单的“fork”实现 :-)）
2.  运行编译好的 C# 程序
3.  编译后的 C# 程序将启动 Powershell，但因为它是“Any CPU”，它将作为 64 位进程运行，因此它将启动 64 位 Powershell（请注意，因为这只是一个概念验证，我希望 powershell 在你的“路径”）
4.  新的 64 位 Powershell 将运行我们选择的命令行开关

这是上述操作的屏幕截图（注意进程的位数）： [进程树 http://img3.imageshack.us/img3/3248/powershellfork.png](http://img3.imageshack.us/img3/3248/powershellfork.png)

以下程序期望列出的所有文件都驻留在同一目录中。我建议创建一个测试目录，例如 C:\Temp\PowershellTest，并将所有文件存储在那里）。

该程序的入口点将是一个简单的命令行开关：

```
# file "test.ps1"
$basePath = Split-Path -resolve $myInvocation.MyCommand.Path
$exe = Join-Path $basePath test.exe
&"$env:SystemRoot\Microsoft.NET\Framework\v3.5\csc.exe" /nologo /target:exe /out:$exe (Join-Path $basePath test.cs)
&$exe (Join-Path $basePath visibility.ps1) 
```

它运行 csc（32 位，但没关系 :-)），然后运行 ​​csc 编译器的结果，传递一个参数（完整路径）visibility.ps1（这是我们要在 64 位 Powershell 中运行的命令行开关）。

C# 代码也非常简单：

```
// file "test.cs"
using System.Diagnostics;
static class Program {
    static int Main(string[] args) {
        ProcessStartInfo i = new ProcessStartInfo("powershell", args[0]);
        i.UseShellExecute = false;
        using(Process p = Process.Start(i)) {
            p.WaitForExit();
            return p.ExitCode;
        }
    }
} 
```

最后，您的“可见性”脚本：

```
# file "visibility.ps1"
(dir HKLM:\SOFTWARE).count - (dir HKLM:\SOFTWARE\wow6432node).count 
```

现在从 32 位 Powershell 运行入口脚本会产生所需的结果（只是为了表明我没有作弊，我先直接运行可见性脚本，然后使用我们的 fork 技术）：

[程序运行 http://img3.imageshack.us/img3/2766/powershellrunc.png](http://img3.imageshack.us/img3/2766/powershellrunc.png)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-01-10T06:31:05.823

我相信内置的 cmdlet Start-Job 将允许您从 32 位实例检查 64 位注册表。

如果没有，则使用`Invoke-Command`循环回本地机器。64 位机器将有两个端点（64 位和 32 位），并且 64 位端点将是默认值。

示例创建注册表值并确保它位于 64 位路径中，而不是 32 位。

```
Invoke-Command -scriptblock {
    New-ItemProperty -Path HKLM:\SOFTWARE\Acme 
                     -Name NameofNewReg 
                     -PropertyType String -Value "1"
    } -computername . 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-01-05T20:34:33.560

如果环境变量 PROCESSOR_ARCHITEW6432 存在且值为 AMD64，那么您在 64 位机器上运行 32 位。比你必须在虚拟 64 位路径 %windir%\sysnative 中运行 powershell。

```
if ($env:PROCESSOR_ARCHITEW6432 -eq "AMD64") {
    write-warning "changing from 32bit to 64bit PowerShell..."
    $powershell=$PSHOME.tolower().replace("syswow64","sysnative").replace("system32","sysnative")

    if ($myInvocation.Line) {
        &"$powershell\powershell.exe" -NonInteractive -NoProfile $myInvocation.Line
    } else {
        &"$powershell\powershell.exe" -NonInteractive -NoProfile -file "$($myInvocation.InvocationName)" $args
    }

    exit $lastexitcode
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-03-28T14:20:28.993

最简单的方法是使用这个快捷方式：C:\Windows\sysnative，它等同于 C:\Windows\System32——但关键区别在于该进程作为 64 位进程启动。因此，从 32 位 powershell 访问 64 位注册表的最简单方法是通过 C:\Windows\sysnative 调用 reg.exe 例如：

```
C:\Windows\sysnative\reg.exe QUERY HKLM\SOFTWARE\JavaSoft\JDK 
```

来源：[https ://stackoverflow.com/a/25103599](https://stackoverflow.com/a/25103599)

如果出于某种原因，您需要从 64 位命令行访问 32 位注册表，请使用 C:\Windows\syswow64

```
C:\Windows\syswow64\reg.exe QUERY HKLM\SOFTWARE\JavaSoft 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-09T23:21:05.053

根据 Bart De Smet 的[博客](http://community.bartdesmet.net/blogs/bart/archive/2010/07/06/hosting-windows-powershell-2-0-under-clr-4-0.aspx)，米兰的答案略有不同，它是使用 C# 程序托管 powershell 。尽管该博客条目侧重于针对 .NET 4.0 进行编译，但您也可以针对 .NET 3.5 进行相同的编译。结果是一个二进制文件，它是一个 PowerShell 主机，当从 32 位进程调用时，它可以访问 64 位注册表项：

```
using System;
using System.Management.Automation.Runspaces;
using Microsoft.PowerShell;

namespace PSHost
{
    class Program
    {
        static void Main(string[] args)
        {

            var config = RunspaceConfiguration.Create();
            ConsoleShell.Start(
                config,
                "Windows PowerShell - Compiled for ANY CPU",
                "",
                args
            );

        }
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-08-13T08:31:33.020

要扩展 Milan Gardian 的答案，请将此功能用于小代码块：

```
function RunAs-64Bit ([ScriptBlock]$scriptblock)
{
    [string]$code = 'using System.Diagnostics; static class Program { static int Main(string[] args) { ProcessStartInfo i = new ProcessStartInfo("powershell", args[0]); i.UseShellExecute = false; using(Process p = Process.Start(i)) { p.WaitForExit(); return p.ExitCode; } } }'
    [string]$exeName = $env:temp + '\' + [System.IO.Path]::GetRandomFileName() + '.exe';
    $params = New-Object 'System.CodeDom.Compiler.CompilerParameters'; 
    @('mscorlib.dll',  'System.dll', ([System.Reflection.Assembly]::GetAssembly([PSObject]).Location)) | %{ $params.ReferencedAssemblies.Add( $_ ) } | Out-Null
    $params.GenerateExecutable      = $true
    $params.GenerateInMemory        = $false;
    $params.CompilerOptions         = '/optimize';
    $params.OutputAssembly          = $exeName;
    $params.TreatWarningsAsErrors   = $false;
    $params.WarningLevel            = 4;

    $csprovider = New-Object 'Microsoft.CSharp.CSharpCodeProvider'; #disposable
    try {
        $compileResults = $csprovider.CompileAssemblyFromSource($params, $code)
        $errors = $compileResults.Errors | ?{ -not $_.IsWarning }
        if ($errors.Count -gt 0) 
        {
            Write-Host -f red 'Compiler errors are found.'
            foreach ($output in $compileResults.Output) { Write-Host -$output }
            foreach ($err in $errors) { Write-Host -f red $('Compile Error: ' + $err); }            
        }
        else 
        {
            $compileResults.Errors | %{ Abr-Write-UtilLog 'Util Get assembly from code' $('Compile Warning: ' + $_); }            
            $assembly = $compileResults.CompiledAssembly
            $commandParam = '-encodedCommand  ' + [System.Convert]::ToBase64String([System.Text.Encoding]::UNICODE.GetBytes($scriptblock));
            &$exeName $commandParam
        }
        Remove-Item -force $exeName -ErrorAction 'SilentlyContinue';
    } finally{
        $csprovider.Dispose();
        Remove-Variable 'csprovider';
    }
} 
```

现在使用此函数在 64 位模式可用时以 64 位模式运行任何脚本块（只要它不是太大）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-07-02T20:30:34.583

REG.EXE 命令可以写入 64 位注册表，因此以下内容对于来自 powershell 的 32/64 位应该是安全的。

```
&REG.EXE @('ADD','HKLM\YOURPATH\...','/v','KEY','/t','REG_DWORD','/d','12c','/f','/reg:64') 
```

似乎比其他解决方案更简单，更不容易出错。这可能是几年后才出现的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-29T11:56:33.160

试试这个。（REG 查询“HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall”/reg:64）使用您喜欢的任何键。我正在搜索卸载密钥。

我注意到其他类似的答案，但它们不包括 /reg:64 参数。另请注意，HKLM 后没有“：”

# css - 向下碰撞导航 - 使其齐平

> ID：630399
> 
> 赞同：0
> 
> 时间：2009-03-10T14:14:42.473
> 
> 标签：css

在[这个网站上](http://www.catonthecouchproductions.com/fish/)，我试图将导航往中间下拉，你会看到它是如何不匹配的。我已经尝试了 margin/padding/top/ css 属性，但没有。在边缘上看看它是如何关闭大约 3 或 4 像素的，如果我把它撞下来会很好。为什么这样做？

更新：[这是我的 CSS](http://www.catonthecouchproductions.com/fish/css/style.css)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T14:48:20.037

按钮图像的样式在其中没有任何位置。尝试在按钮周围添加一些样式：

```
.btn-fishing-trip 
{
    position:relative; top:3px;
}
.btn-combo
{
    position:relative; top:3px;
}
.btn-guest
{
    position:relative; top:3px;
}
.btn-contact
{
    position:relative; top:3px;
} 
```

# bash - 使用带有 GIMP 的命令行转换 XCF 和其他文件？

> ID：630405
> 
> 赞同：21
> 
> 时间：2009-03-10T14:15:11.130
> 
> 标签：bash, command-line, image, gimp, script-fu

如果我有一个 XCF 文件（或 Gimp 支持的任何其他文件），我如何将其转换为例如 PNG 以进行显示或进一步处理？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2011-06-12T07:59:45.293

我迟到了几年，但我想我会添加我认为迄今为止最好的解决方案：有一个名为[Xcftools](http://henning.makholm.net/software#xcftools)的工具套件（在 Ubuntu 上`apt-get install xcftools`），它有一个名为的实用程序`xcf2png`可以完美地完成这项工作。

```
xcf2png image.xcf -o image.png 
```

这比 a) 使用 ImageMagick（正如我在上面的评论中所说的那样严重损坏）或 b) 使用 Gimp（它具有极其复杂的脚本语言，用于简单地导出图像）要好得多。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-10T14:20:21.430

我猜[ImageMagick](http://www.imagemagick.org)应该做你想做的（甚至更多）

```
convert image.xcf image.png 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-02-06T11:27:05.487

一个很好的解决方案（和解释！）可以在[这里](http://billauer.co.il/blog/2009/07/gimp-xcf-jpg-jpeg-convert-bash-script/)找到。简而言之，gimp 有一个 bash 脚本馈送方案/lisp

```
#!/bin/bash
{
cat <<EOF
(define (convert-xcf-to-jpeg filename outfile)
  (let* (
     (image (car (gimp-file-load RUN-NONINTERACTIVE filename filename)))
     (drawable (car (gimp-image-merge-visible-layers image CLIP-TO-IMAGE)))
     )
    (file-jpeg-save RUN-NONINTERACTIVE image drawable outfile outfile .9 0 0 0 " " 0 1 0 1)
    (gimp-image-delete image) ; ... or the memory will explode
    )
)

(gimp-message-set-handler 1) ; Messages to standard output
EOF

for i in *.xcf; do
  echo "(gimp-message \"$i\")"
  echo "(convert-xcf-to-jpeg \"$i\" \"${i%%.xcf}.jpg\")"
done

echo "(gimp-quit 0)"
} | gimp -i -b - 
```

但是请查看页面以获取完整的故事。这很值得。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T14:21:45.873

除了 GIMP 之外，很少有程序（如果有的话）读取 XCF 文件。这是 GIMP 开发人员的设计，该格式并未真正记录或支持为通用文件格式。

话虽如此，请考虑使用 GIMP 本身，使用命令行参数（尤其是`--batch`选项）。

编辑：[看起来](http://www.imagemagick.org/script/formats.php)ImageMagick 确实支持 XCF，所以如果支持看起来足够好，这可能是一条更简单的路线。我没有测试过，文档也没有说太多。我会有点警惕。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-15T19:47:49.653

如果您想将 .xcf 图像批量转换为 .png，您可能会发现此包装脚本更有用：

```
#! /bin/bash -peux
exec xcf2png $1 -o ${1%.xcf}.png 
```

将它保存在 PATH 中的某个位置`xcftopng`（注意`to`不是`2`）并像这样调用它：

```
ls *.xcf|xargs -l xcftopng 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-08T16:36:15.353

猛击单线器。只需要转换（通常已经从 imagemagick 安装）。

```
convert -alpha on -background none -layers merge t2.xcf t2.png 
```

迭代 xcf 文件以将它们转换为适当名称的脚本：

```
for i in *.xcf; do convert -alpha on -background none -layers merge $i ${i/xcf/png}; done 
```

# mysql - 管理数据库中的客户

> ID：630418
> 
> 赞同：2
> 
> 时间：2009-03-10T14:17:15.370
> 
> 标签：mysql, database

我的同事在管理他的数据库中的客户时遇到问题。问题是当订单通过客户时需要添加到数据库中。但是如果客户存在，我们不想重复客户，我们希望保留相同的客户并添加到他们的销售历史中。他很难弄清楚如何充分证明这一点。同事有时会进入销售，有时输入的信息与以前不完全一样，所以当他的系统检查客户是否已经存在时，它认为它是一个新客户，而实际上客户已经存在，但输入的信息略有不同不同的。

有没有人对如何解决这个问题有任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:22:31.957

在订单完成过程中再添加一个步骤。此步骤应对客户记录进行模糊搜索，以查看是否可以找到客户的全部或部分匹配项。

如果它发现一些接近的东西，显示记录并要求用户选择一个或继续创建新记录。

显然，您不希望将其暴露给最终客户。相反，只需询问他们之前是否订购过并输入他们的登录信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T14:21:14.407

由于输入的数据相似但不完全相同，您想先进行[模糊逻辑](http://www.yvoschaap.com/index.php/weblog/easy_fuzzy_logic_with_mysql_the_end_of_no_results_found/)搜索，然后如果没有找到结果，请插入新客户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:26:39.637

如果可能，让用户登录。

这为您节省了寻找相似客户的麻烦，并且用户不必多次输入他们的地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T14:51:53.507

避免重复数据输入是一个常见问题，可以通过多种方式进行处理。我要关注的关键是，任何成功的解决方案都必须对数据输入人员更容易，否则将不会被遵循（例如，告诉 DP 检查客户是否已经存在是行不通的，因为这需要他们做更多的工作）。我可以想出几种解决这个问题的方法。

第一个解决方案是基于密钥的；对以不同方式输入的可能性很小的独特信息进行一些检查。我见过的最常见的情况是电子邮件地址被简化为小写文本。下一个常见的是电话号码（尽管更常见的是为整个办公室或家庭使用一个电话号码）。如果电子邮件地址存在，则客户必须存在，因此用户无法将其添加为新客户，而是根据与该客户关联的数据自动填写表单。用户喜欢这样，因为他们只需要输入一条数据，其余的就会自动填写。

第二种解决方案，可以补充第一种，基于自动完成（[http://en.wikipedia.org/wiki/Autocomplete](http://en.wikipedia.org/wiki/Autocomplete)）；当用户为客户输入数据时，您的应用程序会自动完成与输入内容相匹配的现有客户数据。这提高了用户选择现有记录而不是输入所有新数据的可能性。例如，这允许某人输入“john sm”并看到“john smith, john smart, john smuck, etc.”。填写的每个字段都会缩小后续字段的自动完成选择范围（例如，马萨诸塞州波士顿的只有这么多 john smith ......）。用户喜欢这样，因为它再次减少了他们必须做的工作量。

第三种解决方案，之前在另一个回复中提到过，是进行模糊搜索。这有点难以实现，但非常强大。许多流行的企业搜索引擎（例如 Autonomy、FAST、Verity 等）都很好地做到了这一点。但聪明的程序员也可以实现内部解决方案。关键点包括不区分大小写的搜索（因此搜索 Lafleur 将匹配 LaFleur）或使用 SoundEx（因此搜索 John 将匹配 Jon）有关更多信息，请参阅[http://en.wikipedia.org/wiki/Soundex](http://en.wikipedia.org/wiki/Soundex)。

祝你好运，

瑞克

# vb.net - 防止表单窃取焦点

> ID：630420
> 
> 赞同：1
> 
> 时间：2009-03-10T14:17:20.313
> 
> 标签：vb.net, winforms

当我运行我的 VB.NET Winforms 应用程序时，我不希望它从其他打开的应用程序中窃取焦点。仅供参考，我的应用程序是从命令行启动的，但这不应该有所作为。我看过问题[577076](https://stackoverflow.com/questions/577076/topmost-window-form-steal-focus)但这似乎不起作用。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T13:12:38.417

这是我为使其正常工作所做的工作：

我将以下代码添加到我的 Form1.vb 文件中：

```
Protected Overloads Overrides ReadOnly Property ShowWithoutActivation() As Boolean  
    Get  
        Return True  
    End Get  
End Property 
```

但仍然没有成功。

然后我取消选中项目属性的应用程序选项卡上的启用应用程序框架复选框。

成功！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-27T12:37:52.833

实际上 ShowWithoutActivation 可以工作，而无需禁用框架。我一直认为我的问题没有解决，直到我意识到隐藏主表单导致弹出表单出现时重新关注它。从而将注意力从我正在使用的其他应用程序上转移开。如果您遇到类似情况，请使用 opacity 而不是 hide。只需设置为 0 即可隐藏表单，设置为 100 可将其恢复。这允许函数按描述工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T16:24:14.533

在您链接的示例中，在方法范围之外声明了一些常量。这是另一个适合您的版本：

```
protected CreateParams CreateParams {
  get {
    CreateParams baseParams = base.CreateParams;
    const int WS_EX_NOACTIVATE = 0x08000000;   
    const int WS_EX_TOOLWINDOW = 0x00000080;    
    baseParams.ExStyle |= (int) (WS_EX_NOACTIVATE | WS_EX_TOOLWINDOW); 
    return baseParams;
  }
}
... 
```

不过，您必须将其翻译成 VB.Net...

# ruby-on-rails - 在activerecord数组中查找和删除

> ID：630421
> 
> 赞同：1
> 
> 时间：2009-03-10T14:17:48.190
> 
> 标签：ruby-on-rails

组有_许多用户。我有 2 个 activerecord 数组： 1\. groups = 包含用户组。2\. users = 包含参加活动的用户。

我首先遍历组。然后我遍历第二个数组中的用户并在第一个数组中搜索该用户（参见代码）。如果找到用户，则显示并从数组中删除。

```
<% groups.each do |group| %> 
<h2><%= group.title %></h2> 
  <% users.each do |user| %> 
    # I want to search for user in group.users 
    # and if present show here and remove the user from 
    # group.users (remove from the array not from the database) 
  <% end %> 
<% end %> 
```

我不知道如何在另一个活动记录数组中搜索用户然后删除他。非常感谢所有帮助。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:32:52.757

**直接回答您的问题**，即从所有组的用户中显示*和删除*感兴趣的用户：

```
<% @groups.collect { |group|
     group.users.delete_if { |user|
       user == my_user
     }
   }.flatten.each do |user| %>

   <%= ((display user)) %>

<% end %> 
```

或者，

```
<% @groups.each do |group| %>
   <% if user = group.delete(my_user) %>
     <%= ((display user)) %>
   <% end %>
<% end %> 
```

# c++ - 在哪里可以找到 C++ 的 ZwCreateFile 示例？

> ID：630432
> 
> 赞同：1
> 
> 时间：2009-03-10T14:20:13.957
> 
> 标签：c++, c, winapi, serial-port

我正在寻找一个示例来读取已经打开的 COM 端口，我发现的唯一东西是一个名为 PORTMON 的应用程序，它引用了一个名为`ZwCreateFile`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:25:28.093

codeproject.com - 是一个查找示例的好网站。

[http://www.codeproject.com/KB/system/chaiyasit_t.aspx](http://www.codeproject.com/KB/system/chaiyasit_t.aspx)

**编辑：** msdn 也有信息 [http://msdn.microsoft.com/en-us/library/aa363424.aspx](http://msdn.microsoft.com/en-us/library/aa363424.aspx)

# jquery - jQuery覆盖点击内的.click事件

> ID：630434
> 
> 赞同：22
> 
> 时间：2009-03-10T14:20:25.407
> 
> 标签：jquery

我有这些功能：

```
TargetWorksheet.toggle_child_locations = function(id){
  $("#location-children-"+id).slideToggle("slow"); 
}

TargetWorksheet.get_child_locations = function(id, lvl){
  //Ajax grab all children and targets, and display children
  $.get('child_locations',{ location_id: id, level: lvl}, function(data){
    $("#location-children-"+id).append(data);
    TargetWorksheet.toggle_child_locations(id);
  });

  //Change onClick to just toggle since child data will now be loaded
  $("#location-toggle-"+id).click(function(){
    TargetWorksheet.toggle_child_locations(id);
  });
} 
```

这个电话：

```
$(function(){
  TargetWorksheet.toggle_child_locations(2);
  $("#location-toggle-2").click(function(){
    TargetWorksheet.get_child_locations(2,1);
  });
}); 
```

所以我将一个点击事件附加到我的“+”链接（#location-toggle-2），它可以切换子数据。在第一次单击时，我想做一个 ajax 调用来检索子数据，但是我只想覆盖 #location-toggle-2 上的 .click 以便它现在只是切换，而不是进行 ajax 调用. 上面的代码不起作用，它似乎没有覆盖.click，并且每次都进行ajax调用。

有谁知道我如何覆盖项目的 .click 事件？我也试过 `$("#location-toggle-"+id).click(TargetWorksheet.toggle_child_locations(id));` 而且它只是出于某种原因不断地递归地切换。

想法？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-03-10T14:25:02.870

您唯一缺少的是 using每次调用时都会*添加一个新的处理程序，而不是覆盖现有的处理程序。****`.click()`***

 *`$("#location-toggle-"+id).`[**`unbind()`**](http://docs.jquery.com/Events/unbind#typefn)在添加新元素之前，您可以使用清除该元素上的处理程序，它应该可以按预期工作。

# c# - 从 C# 中的数据库条目动态加载用户控件

> ID：630448
> 
> 赞同：1
> 
> 时间：2009-03-10T14:23:14.043
> 
> 标签：c#, winforms, dynamic, user-controls

在 C#、Windows 窗体应用程序中，我们有一系列与数据库中的菜单条目记录相关联的用户控件...

```
 ID  Menu Title
    1   User Management
    4   Group Management
    6   System Utilities
    12  Configuration Management 
```

一些用户控制...

*   用户管理.cs
*   组管理器.cs
*   SysUtil.cs
*   ConfigurationMan.cs

我们目前只是打开 ID，但这似乎是一种非常原始的方式来实现这一点，并且有很多硬编码的 ID，我不喜欢这些。

读取数据库条目并加载适当的用户控件的最合适的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:28:00.430

在某些方面，开关（可能是在一个枚举上而不仅仅是一个 id）是相当合理的。您可以将程序集限定名称推送到数据库中，但是数据库关心程序集或类的什么？当你重构时会发生什么？转移到java？需要支持多个 UI 引擎？不，我可能只是切换自己 - 在工厂方法中封装它......

```
public static Control CreateControl(ControlType controlType) {
    switch(controlType) {
        case ControlType.Foo:
            return new blah...
        case ControlType.Bar:
            ...
    }
    throw new ArgumentOutOfRangeException();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T14:26:49.700

您可以将类名存储在数据库中并通过反射实例化它们。他们需要全部实现一个接口或全部派生自一个基类（我假设您正在这样做，扩展 Control），以便在不必以不同方式处理每个单独的类的情况下进行处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T14:30:24.400

您可能可以将类型名称存储在数据库中并使用反射来新建用户控件。

# .net - 加入 MS Word 文档

> ID：630449
> 
> 赞同：1
> 
> 时间：2009-03-10T14:23:44.840
> 
> 标签：.net, ms-word, document, splice

在代码中将一组 MS Word 文档拼接成一个的推荐策略是什么？

干杯

尼克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:27:27.077

去看看各种可用的 SDK。如果您使用的是 Word 2007，这会容易得多，因为该文件实际上是一个包含各种 XML 文档的 zip 文件。MS 甚至有一个名为“ [Open XML Format SDK 1.0](http://www.microsoft.com/downloads/details.aspx?FamilyId=AD0B72FB-4A1D-4C52-BDB5-7DD7E816D046&displaylang=en) ”的 SDK，它提供了用于处理新办公格式的强类型类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T14:33:41.773

[http://www.codeproject.com/KB/aspnet/AppendWordDocuments.aspx](http://www.codeproject.com/KB/aspnet/AppendWordDocuments.aspx)

或其中任何一个： [http ://www.google.com/search?hl=en&q=append+microsoft+word+documents](http://www.google.com/search?hl=en&q=append+microsoft+word+documents)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T21:54:54.377

如果您使用的是 Open XML（即 docx），有两种基本方法可以解决此问题：

首先是做一些必要的事情，以便 id 指向正确的关系（例如图像、超链接），并定义样式等。关于您需要做什么的很好的解释可以在 [http://blogs.msdn 找到。 com/ericwhite/archive/2009/02/05/move-insert-delete-paragraphs-in-word-processing-documents-using-the-open-xml-sdk.aspx](http://blogs.msdn.com/ericwhite/archive/2009/02/05/move-insert-delete-paragraphs-in-word-processing-documents-using-the-open-xml-sdk.aspx)

[PowerTools](http://blogs.msdn.com/ericwhite/archive/2009/03/19/announcing-the-release-of-powertools-for-open-xml-v1-1.aspx)实现了这一点。

第二种是使用altChunk：http: [//blogs.msdn.com/ericwhite/archive/2008/10/27/how-to-use-altchunk-for-document-assembly.aspx](http://blogs.msdn.com/ericwhite/archive/2008/10/27/how-to-use-altchunk-for-document-assembly.aspx)

# http - HTTP中的POST和PUT有什么区别？

> ID：630453
> 
> 赞同：5922
> 
> 时间：2009-03-10T14:25:20.390
> 
> 标签：http, rest, post, put

根据[RFC 2616, § 9.5](https://www.rfc-editor.org/rfc/rfc2616#section-9.5)，`POST`用于*创建*资源：

> POST 方法用于请求源服务器接受请求中包含的实体，作为 Request-Line 中 Request-URI 标识的资源的新下级。

根据[RFC 2616，第 9.6 节](https://www.rfc-editor.org/rfc/rfc2616#section-9.6)，`PUT`用于*创建或替换*资源：

> PUT 方法请求将封闭的实体存储在提供的 Request-URI 下。如果 Request-URI 引用了一个已经存在的资源，封闭的实体应该被认为是在源服务器上的一个修改版本。如果 Request-URI 不指向现有资源，并且该 URI 能够被请求用户代理定义为新资源，则源服务器可以使用该 URI 创建资源。

那么应该使用哪种 HTTP 方法来创建资源呢？还是应该同时支持？

* * *

## 回答 #1

> 赞同：4626
> 
> 时间：2009-03-10T14:29:46.930

**总体：**

PUT 和 POST 都可用于创建。

你必须问，“你在做什么？”，以区分你应该使用什么。假设您正在设计一个用于提问的 API。如果您想使用 POST，那么您可以对问题列表执行此操作。如果您想使用 PUT，那么您将对特定问题执行此操作。

**太好了，两者都可以使用，所以我应该在我的 RESTful 设计中使用哪一个：**

您不需要同时支持 PUT 和 POST。

您使用哪个取决于您。但是请记住根据您在请求中引用的对象来使用正确的对象。

一些考虑：

*   您是明确命名您创建的 URL 对象，还是让服务器决定？如果您命名它们，则使用 PUT。如果您让服务器决定然后使用 POST。
*   PUT 被定义为假定幂等性，所以如果你 PUT 一个对象两次，它应该没有额外的效果。这是一个不错的属性，所以我会尽可能使用 PUT。只需确保 PUT 幂等性实际上在服务器中正确实现。
*   您可以使用具有相同对象 URL 的 PUT 更新或创建资源
*   使用 POST，您可以同时收到 2 个请求来修改 URL，它们可能会更新对象的不同部分。

**一个例子：**

我写了以下内容作为[关于此问题的另一个答案的](https://stackoverflow.com/questions/256349/what-are-the-best-common-restful-url-verbs-and-actions/256359#256359)一部分：

> **邮政：**
> 
> 用于修改和更新资源
> 
> ```
> POST /questions/<existing_question> HTTP/1.1
> Host: www.example.com/ 
> ```
> 
> 请注意，以下是一个错误：
> 
> ```
> POST /questions/<new_question> HTTP/1.1
> Host: www.example.com/ 
> ```
> 
> 如果 URL 尚未创建，则在指定名称时不应使用 POST 创建它。这应该会导致“找不到资源”错误，因为`<new_question>`尚不存在。您应该首先将`<new_question>` 资源放在服务器上。
> 
> 你可以做这样的事情来使用 POST 创建资源：
> 
> ```
> POST /questions HTTP/1.1
> Host: www.example.com/ 
> ```
> 
> 请注意，在这种情况下，未指定资源名称，新的对象 URL 路径将返回给您。
> 
> **放：**
> 
> 用于创建资源或覆盖它。在您指定资源的新 URL 时。
> 
> 对于新资源：
> 
> ```
> PUT /questions/<new_question> HTTP/1.1
> Host: www.example.com/ 
> ```
> 
> 要覆盖现有资源：
> 
> ```
> PUT /questions/<existing_question> HTTP/1.1
> Host: www.example.com/ 
> ```

此外，更简洁一点的是，[RFC 7231 第 4.3.4 节 PUT](https://www.rfc-editor.org/rfc/rfc7231#section-4.3.4)状态（强调添加），

> **4.3.4\. 放**
> 
> PUT 方法请求目标资源的状态是 `created`或`replaced`具有由请求消息有效负载中包含的表示定义的状态。

* * *

## 回答 #2

> 赞同：2392
> 
> 时间：2010-04-22T14:55:54.930

你可以在网上找到断言说

*   [**POST**用于创建资源，**PUT**用于修改资源](http://java.sun.com/developer/technicalArticles/WebServices/restful/)
*   [**PUT**用于创建资源，**POST**用于修改资源](http://awsmedia.s3.amazonaws.com/pdf/RESTandS3.pdf)

两者都不完全正确。

* * *

[更好的是根据动作的幂等](http://en.wikipedia.org/wiki/Idempotent)性在 PUT 和 POST 之间进行选择。

**PUT**意味着放置一个资源——用不同的东西完全替换给定 URL 上可用的任何东西。根据定义，PUT 是幂等的。你喜欢做多少次，结果都是一样的。`x=5`是幂等的。您可以放置​​一个资源，无论它以前是否存在（例如，创建或更新）！

**POST**更新资源、添加辅助资源或导致更改。POST 不是幂等的，以非幂等的方式`x++`。

* * *

通过这个论点，PUT 用于在您知道要创建的事物的 URL 时进行创建。当您知道要创建的事物类别的“工厂”或经理的 URL 时，可以使用 POST 来创建。

所以：

```
POST /expense-report 
```

或者：

```
PUT  /expense-report/10929 
```

* * *

## 回答 #3

> 赞同：784
> 
> 时间：2010-04-07T05:52:52.900

*   **POST**到 URL在*服务器定义的 URL 处***创建子资源**。
**   **PUT** to a URL在*客户端定义的 URL 处***创建/替换整个资源**。**   **对 URL的**PATCH会****更新***该客户端定义的 URL 处的***部分*****资源。*******

 ****PUT 和 POST 的相关规范是[RFC 2616 §9.5ff。](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.5)

**POST 创建一个子资源**，因此 POST`/items`创建一个位于该资源下的`/items`资源。例如。`/items/1`. 两次发送相同的 post 数据包将创建两个资源。

**PUT用于****在客户端已知的 URL**上创建或替换资源。

因此：**PUT**只是 CREATE 的候选者，其中客户端在创建资源之前已经知道 url。例如。`/blogs/nigel/entry/when_to_use_post_vs_put`因为标题被用作资源键

**如果已知 url 处的资源已经存在，则PUT**会替换该资源，因此两次发送相同的请求无效。换句话说，**对 PUT 的调用是幂等的**。

RFC 是这样写的：

> POST 和 PUT 请求的根本区别体现在 Request-URI 的不同含义上。POST 请求中的 URI 标识将处理封闭实体的资源。该资源可能是一个数据接受进程，一个通往其他协议的网关，或者一个接受注释的单独实体。相比之下，PUT 请求中的 URI 标识了请求中包含的实体——用户代理知道 URI 的意图，服务器不得尝试将请求应用于其他资源。如果服务器希望将请求应用于不同的 URI，

**注意：** PUT 主要用于更新资源（通过整体替换它们），但最近出现了使用 PATCH 更新现有资源的趋势，因为 PUT 指定它替换整个资源。[RFC 5789。](https://www.rfc-editor.org/rfc/rfc5789)

**2018 年更新**：有一种情况可以避免 PUT。请参阅[“没有 PUT 的 REST”](https://www.thoughtworks.com/radar/techniques/rest-without-put)

> 使用“没有 PUT 的 REST”技术，其想法是强制消费者发布新的“统一”请求资源。如前所述，更改客户的邮寄地址是对新“ChangeOfAddress”资源的 POST，而不是具有不同邮寄地址字段值的“客户”资源的 PUT。

取自[REST API 设计 - Thoughtworks 的 Prakash Subramaniam 的资源建模](https://www.thoughtworks.com/insights/blog/rest-api-design-resource-modeling)

这迫使 API 避免多个客户端更新单个资源的状态转换问题，并与事件溯源和 CQRS 更好地匹配。当工作异步完成时，发布转换并等待它被应用似乎是合适的。

* * *

## 回答 #4

> 赞同：291
> 
> 时间：2011-10-23T14:27:31.723

`POST`表示“创建新”，如“这是创建用户的输入，为我创建”。

`PUT`表示“插入，如果已存在则替换”，如“这是用户 5 的数据”。

您`POST`访问 example.com/users，因为您还不知道`URL`用户的身份，您希望服务器创建它。

您`PUT`可以访问 example.com/users/id，因为您想替换/创建*特定*用户。

使用相同的数据发布两次意味着创建两个具有不同 ID 的相同用户。使用相同的数据进行两次 PUT 会创建第一个用户，第二次将他更新到相同的状态（无更改）。`PUT`由于无论执行多少次都会以相同的状态结束，因此可以说每次都“同等有效” - 幂等。这对于自动重试请求很有用。当您按下浏览器上的后退按钮时，不再有“您确定要重新发送”。

一般建议是`POST`在您需要服务器控制`URL`资源生成时使用。`PUT`否则使用。更 喜欢`PUT` .`POST`

* * *

## 回答 #5

> 赞同：260
> 
> 时间：2013-08-14T22:47:18.633

# 概括：

## 创造：

可以通过以下方式使用 PUT 或 POST 执行：

> ### 放
> 
> **在**/resources URI 或**collection下以****newResourceId**作为标识符创建新资源。
> 
>  **```
> PUT /resources/<newResourceId> HTTP/1.1 
> ```
> 
> ### 邮政
> 
> 在 /resources URI 或**collection**下创建**一个**新资源。通常标识符由服务器返回。
> 
>  **```
> POST /resources HTTP/1.1 
> ```****

 ****## 更新：

只能通过以下方式使用 PUT 执行**：**

> ### 放
> 
> 在 /resources URI 或**collection下以****existingResourceId**作为标识符更新资源。
> 
>  **```
> PUT /resources/<existingResourceId> HTTP/1.1 
> ```**

 **# 解释：

当一般处理 REST 和 URI时，*左边是***通用**的，右边*是***特定**的。**泛型**通常称为**集合**，更**具体**的项目可以称为**资源**。请注意，**资源**可以包含一个**集合**。

 ********> ## 例子：
> 
> **<-- 通用 -- 具体 -->**
> 
> ```
> URI: website.com/users/john
> website.com  - whole site
> users        - collection of users
> john         - item of the collection, or a resource
> 
> URI:website.com/users/john/posts/23
> website.com  - whole site
> users        - collection of users
> john         - item of the collection, or a resource
> posts        - collection of posts from john
> 23           - post from john with identifier 23, also a resource 
> ```

当你使用 POST 时，你**总是**在引用一个**集合**，所以每当你说：

```
POST /users HTTP/1.1 
```

您正在向*users* **集合**发布新用户。

如果你继续尝试这样的事情：

```
POST /users/john HTTP/1.1 
```

它会起作用，但是从语义上讲，您是说要在*users***集合**下的*john* **集合**中添加资源。

 ***使用 PUT 后，您指的是**资源**或单个项目，可能在**集合**中。所以当你说：

```
PUT /users/john HTTP/1.1 
```

您正在告诉服务器更新，或者如果它不存在，则创建*users***集合**下的*john* **资源**。

 ***## 规格：

让我强调一下规范的一些重要部分：

### 邮政

> **POST**方法用于请求源服务器**接受**请求中包含的实体，作为Request-Line 中 Request-URI 标识的资源的***新*下级**

因此，在**集合上创建一个新****资源**。

 **### 放

> **PUT**方法请求将封闭的实体**存储**在提供的 Request-URI 下。如果 Request-URI 引用了一个**已经存在的**资源，封闭的实体应该被认为是在源服务器上的一个**修改版本**。如果 Request-URI 不**指向现有**资源，并且该 URI**能够**被请求用户代理定义为***新*资源**，则源服务器可以使用该 URI**创建资源。”**

因此，根据**资源**的存在创建或更新。

# 参考：

*   [HTTP/1.1 规范](https://www.rfc-editor.org/rfc/rfc7231#section-4.3.3)
*   [维基百科 - REST](http://en.wikipedia.org/wiki/Representational_state_transfer)
*   [统一资源标识符 (URI)：通用语法和语义](http://www.ietf.org/rfc/rfc2396.txt)

* * *

## 回答 #6

> 赞同：182
> 
> 时间：2011-01-15T19:59:06.533

我想补充一下我的“务实”建议。当您知道可以检索所保存对象的“id”时，请使用 PUT。如果您需要返回一个数据库生成的 id 以供您将来查找或更新，则使用 PUT 将无法很好地工作。

所以：要保存现有用户，或者客户端生成 id 并且已验证 id 是唯一的用户：

```
PUT /user/12345 HTTP/1.1  <-- create the user providing the id 12345
Host: mydomain.com

GET /user/12345 HTTP/1.1  <-- return that user
Host: mydomain.com 
```

否则，使用 POST 初始创建对象，并使用 PUT 更新对象：

```
POST /user HTTP/1.1   <--- create the user, server returns 12345
Host: mydomain.com

PUT /user/12345 HTTP/1.1  <--- update the user
Host: mydomain.com 
```

* * *

## 回答 #7

> 赞同：159
> 
> 时间：2015-09-11T13:12:44.277

两者都用于客户端到服务器之间的数据传输，但它们之间存在细微差别，分别是：

| 放 | 邮政 |
| --- | --- |
| 替换现有资源或在资源不存在时创建。 `www.example.com/com/customer/{customerId} www.example.com/com/customer/123/order/{orderId}`标识符由客户端选择。 | 创建新资源和从属资源，例如，文件从属于包含它的目录，或者行从属于数据库表。`www.example.com/com/customer/ www.example.com/com/customer/123/order/`标识符由服务器返回 |
| 幂等，即如果你`PUT`的资源两次，它没有效果。示例：尽可能多地做它，结果将是相同的。`x=1;` | `POST`既不安全也不幂等。例子：`x++;` |
| 具体工作 | 作为抽象的作品 |
| 如果您使用创建或更新资源`PUT`然后再次进行相同的调用，则该资源仍然存在并且仍然具有与第一次调用相同的状态。 | 发出两个相同`POST`的请求很可能会导致两个资源包含相同的信息。 |

比喻：

*   PUT 即取**放**原处。
*   POST 作为在**邮局**发送邮件。

[![在此处输入图像描述](https://i.stack.imgur.com/AQKrz.jpg)](https://i.stack.imgur.com/AQKrz.jpg)

社交媒体/网络类比：

*   **在社交媒体上发布**：当我们发布消息时，它会创建新帖子。
*   **为我们已经发布的消息放置**（即编辑）。

* * *

## 回答 #8

> 赞同：144
> 
> 时间：2009-03-10T14:28:57.680

使用 POST 创建，使用 PUT 更新。无论如何，Ruby on Rails 就是这样做的。

```
PUT    /items/1      #=> update
POST   /items        #=> create 
```

* * *

## 回答 #9

> 赞同：74
> 
> 时间：2009-03-10T15:27:52.047

REST 是一个*非常*高级的概念。事实上，它甚至根本没有提到 HTTP！

如果您对如何在 HTTP 中实现 REST 有任何疑问，可以随时查看[Atom 发布协议 (AtomPub)](https://www.ietf.org/rfc/rfc5023.txt)规范。AtomPub 是一种使用 HTTP 编写 RESTful Web 服务的标准，由许多 HTTP 和 REST 杰出人士开发，其中一些输入来自 REST 的发明者和 HTTP 本人的（共同）发明者 Roy Fielding。

事实上，您甚至可以直接使用 AtomPub。虽然它来自博客社区，但绝不限于博客：它是一种通用协议，用于通过 HTTP 与任意（嵌套）任意资源集合进行 RESTful 交互。如果您可以将您的应用程序表示为资源的嵌套集合，那么您可以只使用 AtomPub 而不必担心是使用 PUT 还是 POST、返回什么 HTTP 状态代码以及所有这些细节。

这就是 AtomPub 对资源创建的看法（第 9.2 节）：

> 要将成员添加到集合中，客户端将 POST 请求发送到集合的 URI。

* * *

## 回答 #10

> 赞同：69
> 
> 时间：2013-10-29T23:00:55.573

**使用 PUT 还是 POST 在具有 HTTP + REST API 的服务器上创建资源的决定取决于谁拥有 URL 结构。**让客户端知道或参与定义 URL 结构是一种不必要的耦合，类似于 SOA 产生的不希望的耦合。转义类型的耦合是 REST 如此受欢迎的原因。因此，**正确使用的方法是 POST。**此规则也有例外，当客户希望保留对其部署的资源的位置结构的控制权时，就会出现例外情况。这种情况很少见，很可能意味着有其他问题。

此时有些人会争辩说，如果使用*RESTful-URL*，客户端确实知道资源的 URL，因此 PUT 是可以接受的。毕竟，这就是为什么规范化、规范化、Ruby on Rails、Django URL 很重要的原因，看看 Twitter API……等等等等。这些人需要明白**，没有 Restful-URL 这样的东西，**而且**Roy Fielding 自己说**：

> REST API 不得定义固定的资源名称或层次结构（客户端和服务器的明显耦合）。服务器必须可以自由控制自己的命名空间。相反，允许服务器通过在媒体类型和链接关系中定义这些指令来指导客户端如何构建适当的 URI，例如在 HTML 表单和 URI 模板中完成。[这里的失败意味着客户端由于带外信息而假设资源结构，例如特定于域的标准，它是面向数据的等价于 RPC 的功能耦合]。
> 
> [http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)

*RESTful-URL*的想法实际上违反了 REST，因为服务器负责 URL 结构，应该可以自由决定如何使用它以避免耦合。如果这让您感到困惑，请阅读关于 API 设计中自我发现的重要性。

**使用 POST 创建资源需要考虑设计，因为 POST 不是幂等的。**这意味着多次重复 POST 并不能保证每次都具有相同的行为。**这会吓到人们在不应该使用 PUT 来创建资源时使用。**他们知道这是错误的（POST 用于 CREATE），但他们还是这样做了，因为他们不知道如何解决这个问题。这种担忧体现在以下情况：

1.  客户端向服务器发布一个新资源。
2.  服务器处理请求并发送响应。
3.  客户端永远不会收到响应。
4.  服务器不知道客户端没有收到响应。
5.  客户端没有资源的 URL（因此 PUT 不是一个选项）并重复 POST。
6.  POST 不是幂等的，服务器……</li>

第 6 步是人们通常对要做什么感到困惑的地方。但是，没有理由创建一个组合来解决这个问题。相反，可以按照[RFC 2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.10 "RFC 2616 409 冲突")中的规定使用 HTTP，服务器回复：

> 10.4.10 409 冲突
> 
> 由于与资源的当前状态冲突，无法完成请求。仅在预期用户可能能够解决冲突并重新提交请求的情况下才允许使用此代码。响应正文应该包含足够的
> 
> 供用户识别冲突来源的信息。理想情况下，响应实体将包含足够的信息供用户或用户代理解决问题；但是，这可能是不可能的，也不是必需的。
> 
> 响应 PUT 请求时最有可能发生冲突。例如，如果正在使用版本控制并且被 PUT 的实体包含对资源的更改，这些更改与早期（第三方）请求所做的更改相冲突，则服务器可能会使用 409 响应来指示它无法完成请求. 在这种情况下，响应实体可能会以响应 Content-Type 定义的格式包含两个版本之间差异的列表。

**回复状态码 409 Conflict 是正确的方法，因为**：

*   对 ID 与系统中已有资源匹配的数据执行 POST 是“与资源的当前状态发生冲突”。</li>
*   因为重要的部分是让客户端了解服务器拥有资源并采取适当的行动。这是“预期用户可能能够解决冲突并重新提交请求的情况”。</li>
*   包含具有冲突 ID 的资源的 URL 和资源的适当先决条件的响应将为“用户或用户代理解决问题提供足够的信息”，这是 RFC 2616 的理想情况。

**基于 RFC 7231 发布的更新以替换 2616**

[RFC 7231](https://www.rfc-editor.org/rfc/rfc7231)旨在取代 2616，并在[第 4.3.3 节](https://www.rfc-editor.org/rfc/rfc7231#section-4.3.3 "RFC 7231 - 第 4.3.3 节")中描述了以下可能的 POST 响应

> 如果处理 POST 的结果等同于现有资源的表示，则源服务器可以通过在 Location 字段中发送带有现有资源标识符的 303（参见其他）响应来将用户代理重定向到该资源。这样做的好处是为用户代理提供资源标识符并通过更适合共享缓存的方法传输表示，但如果用户代理尚未缓存表示，则会以额外请求为代价。

如果重复 POST，现在可能很想简单地返回 303。然而，事实恰恰相反。仅当多个创建请求（创建不同的资源）返回相同的内容时，返回 303 才有意义。一个例子是客户端不需要每次都重新下载的“感谢您提交请求消息”。RFC 7231 在第 4.2.2 节中仍然坚持 POST 不是幂等的，并继续坚持应该使用 POST 进行创建。

有关这方面的更多信息，请阅读这篇[文章](http://articles.joshcodes.com/?p=5 "POST to PUT to REST 如何在服务器上正确创建资源")。

* * *

## 回答 #11

> 赞同：55
> 
> 时间：2012-01-11T17:18:54.103

我喜欢这个建议，来自[RFC 2616 对 PUT 的定义](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)：

> POST 和 PUT 请求的根本区别体现在 Request-URI 的不同含义上。POST 请求中的 URI 标识将处理封闭实体的资源。该资源可能是一个数据接受进程，一个通往其他协议的网关，或者一个接受注释的单独实体。相比之下，PUT 请求中的 URI 标识了请求中包含的实体——用户代理知道 URI 的意图，服务器不得尝试将请求应用于其他资源。

这与此处的其他建议相吻合，即 PUT 最好应用于已经有名称的资源，而 POST 适合在现有资源下创建新对象（并让服务器为其命名）。

我将这一点以及 PUT 的幂等性要求解释为：

*   POST 适合在集合下创建新对象（并且 create 不需要是幂等的）
*   PUT 有利于更新现有对象（并且更新需要是幂等的）
*   POST 也可用于对现有对象的非幂等更新（尤其是在不指定整个对象的情况下更改对象的一部分——如果您考虑一下，创建集合的新成员实际上是这种类型的特例更新，从集合的角度来看）
*   当且仅当您允许客户端命名资源时，PUT 也可用于创建。但是，由于 REST 客户端不应该对 URL 结构做出假设，因此这不符合预期的精神。

* * *

## 回答 #12

> 赞同：53
> 
> 时间：2016-07-29T11:11:21.423

简而言之：

**PUT**是幂等的，如果执行一次或多次相同的操作，则资源状态将相同。

**POST**是非幂等的，与执行一次相比，如果多次执行操作，资源状态可能会变得不同。

### 类比数据库查询

**PUT**可以想到类似“UPDATE STUDENT SET address = "abc" where id="123";

**POST**你可以想像 "INSERT INTO STUDENT(name, address) VALUES ("abc", "xyzzz");

学生 ID 是自动生成的。

使用 PUT，如果多次或一次执行相同的查询，则 STUDENT 表状态保持不变。

在 POST 的情况下，如果多次执行相同的查询，则会在数据库中创建多个学生记录，并且每次执行“INSERT”查询时数据库状态都会更改。

**注意：** PUT 需要一个需要更新的资源位置（已经资源），而 POST 不需要。因此，直观上 POST 是为了创建新资源，而 PUT 是为了更新已经存在的资源。

*有些人可能会提出可以使用 POST 执行更新。没有硬性规定哪一个用于更新或哪一个用于创建。这些都是惯例，直觉上我倾向于上述推理并遵循它。*

* * *

## 回答 #13

> 赞同：47
> 
> 时间：2013-06-14T18:10:25.177

POST 就像将一封信发送到邮箱或将电子邮件发送到电子邮件队列。PUT 就像你把一个物体放在一个小房间或架子上的一个地方（它有一个已知的地址）。

使用 POST，您将发布到 QUEUE 或 COLLECTION 的地址。使用 PUT，您将放入 ITEM 的地址。

PUT 是幂等的。您可以发送请求 100 次，这无关紧要。POST 不是幂等的。如果您发送请求 100 次，您将在邮箱中收到 100 封电子邮件或 100 封信件。

一般规则：如果您知道项目的 id 或名称，请使用 PUT。如果您希望接收方分配项目的 id 或名称，请使用 POST。

![POST 与 PUT](https://i.stack.imgur.com/ugbjx.png)

* * *

## 回答 #14

> 赞同：45
> 
> 时间：2017-10-15T02:33:32.157

**简短的回答：**

简单的经验法则：使用 POST 创建，使用 PUT 更新。

**长答案：**

邮政：

*   POST 用于向服务器发送数据。
*   当资源的 URL 未知时很有用

放：

*   PUT 用于将状态传输到服务器
*   当资源的 URL 已知时很有用

**更长的答案：**

要理解它，我们需要质疑为什么需要 PUT，PUT 试图解决 POST 无法解决的问题是什么。

从 REST 架构的角度来看，这并不重要。我们也可以没有 PUT。但从客户开发人员的角度来看，这让他/她的生活变得简单多了。

在 PUT 之前，客户端无法直接知道服务器生成的 URL，或者它是否已经生成了任何 URL，或者要发送到服务器的数据是否已经更新。PUT 让开发人员摆脱了所有这些头疼的问题。PUT 是幂等的，PUT 处理竞争条件，PUT 让客户端选择 URL。

* * *

## 回答 #15

> 赞同：44
> 
> 时间：2012-08-01T20:10:42.607

**新答案（现在我更了解 REST）：**

PUT 只是对从现在开始服务应该使用什么内容来呈现客户端标识的资源的表示的声明；POST 是关于从现在开始服务应该包含哪些内容（可能是重复的）的声明，但如何识别该内容取决于服务器。

`PUT x`（如果`x`标识[资源](http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm#sec_5_2_1_1)）：“用`x`我的内容替换由标识的资源的内容。”

`PUT x`（如果`x`没有识别资源）：“创建一个包含我的内容的新资源并用于`x`识别它。”

`POST x`：“存储我的内容并给我一个标识符，我可以使用该标识符来标识包含所述内容（可能与其他内容混合）的资源（旧的或新的）。所述资源应该与所`x`标识的资源相同或从属。” “ *y*的资源从属于*x*的资源”通常但不一定通过使*y成为**x*的子路径（例如*x* =`/foo`和*y* = `/foo/bar`）并修改*x*资源的表示以反映存在的方式来实现新资源，例如带有指向*y的超链接*的资源和一些元数据。只有后者对于良好的设计才是真正必不可少的，因为 URL 在 REST 中是不透明的——无论如何，您应该[使用超媒体](https://stackoverflow.com/a/9194942/972499)而不是客户端 URL 构造来遍历服务。

在 REST 中，不存在包含“内容”的资源。我将服务用于一致呈现表示的数据称为“内容”。它通常由数据库或文件（例如图像文件）中的一些相关行组成。由服务将用户的内容转换为服务可以使用的内容，例如将 JSON 有效负载转换为 SQL 语句。

**原始答案（可能更容易阅读）**：

`PUT /something`（如果`/something`已经存在）：“拿走你所拥有的`/something`，用我给你的来代替。”

`PUT /something`（如果`/something`不存在的话）：“拿走我给你的东西，放在`/something`.”

`POST /something`：“把我给你的东西拿来放在你想要的任何地方`/something`，只要你完成后给我它的 URL。”

* * *

## 回答 #16

> 赞同：39
> 
> 时间：2012-02-26T09:21:30.570

Ruby on Rails 4.0 将使用“PATCH”方法而不是 PUT 来进行部分更新。

RFC 5789 提到了 PATCH（自 1995 年以来）：

> 需要一种新方法来提高互操作性并防止错误。PUT 方法已经定义为用一个完整的新主体覆盖资源，并且不能重用以进行部分更改。否则，代理和缓存，甚至客户端和服务器，可能会对操作的结果感到困惑。POST 已经被使用，但没有广泛的互操作性（例如，没有标准的方法来发现补丁格式支持）。PATCH 在早期的 HTTP 规范中提到过，但没有完全定义。

“ [Edge Rails：PATCH 是用于更新的新的主要 HTTP 方法](http://weblog.rubyonrails.org/2012/2/26/edge-rails-patch-is-the-new-primary-http-method-for-updates/)”解释它。

* * *

## 回答 #17

> 赞同：30
> 
> 时间：2011-03-25T10:17:54.237

冒着重申已经说过的话的风险，记住**PUT**意味着客户端在创建资源时控制*URL最终将成为什么似乎很重要。*因此，在**PUT**和**POST**之间进行选择的一部分将是关于您可以信任客户端提供与您的 URL 方案是什么一致的正确、规范化的*URL的程度。*

当您不能完全信任客户端做正确的事情时，使用**POST**创建一个新项目，然后在响应中将 URL 发送回客户端会更合适。

* * *

## 回答 #18

> 赞同：29
> 
> 时间：2018-09-25T08:28:16.707

除了其他人提出的差异之外，我想再添加一个。

在**POST**方法中，您可以发送正文参数`form-data`

在**PUT**方法中，您必须发送正文参数`x-www-form-urlencoded`

标题`Content-Type:application/x-www-form-urlencoded`

据此，您不能在**PUT**方法中发送文件或多部分数据

**编辑**

> 内容类型“application/x-www-form-urlencoded”对于发送大量二进制数据或包含非 ASCII 字符的文本效率低下。内容类型“multipart/form-data”应用于提交包含文件、非 ASCII 数据和二进制数据的表单。

这意味着如果您必须提交

> 文件、非 ASCII 数据和二进制数据

你应该使用**POST**方法

* * *

## 回答 #19

> 赞同：28
> 
> 时间：2017-02-14T06:55:05.080

以一种非常简单的方式，我以 Facebook 时间线为例。

案例 1：当您在时间轴上发布某些内容时，这是一个全新的条目。所以在这种情况下，他们使用 POST 方法，因为 POST 方法是非幂等的。

案例 2：如果您的朋友第一次对您的帖子发表评论，那也会在数据库中创建一个新条目，因此使用 POST 方法。

案例 3：如果您的朋友编辑了他的评论，在这种情况下，他们有一个评论 ID，因此他们将更新现有评论，而不是在数据库中创建新条目。因此，对于这种类型的操作，请使用 PUT 方法，因为它是幂等的。*

在一行中，使用**POST**在数据库中添加**新条目，并使用****PUT****更新**数据库中的某些内容。

* * *

## 回答 #20

> 赞同：25
> 
> 时间：2012-02-08T16:31:54.340

最重要的考虑是*可靠性*。如果 POST 消息丢失，则系统状态未定义。自动恢复是不可能的。对于 PUT 消息，仅在第一次成功重试之前状态未定义。

例如，使用 POST 创建信用卡交易可能不是一个好主意。

如果您的资源碰巧有自动生成的 URI，您仍然可以通过将生成的 URI（指向空资源）传递给客户端来使用 PUT。

其他一些考虑：

*   POST 使整个包含资源的缓存副本无效（更好的一致性）
*   PUT 响应不可缓存，而 POST 响应可缓存（需要 Content-Location 和过期）
*   PUT 较少受到 Java ME、旧浏览器、防火墙等的支持

* * *

## 回答 #21

> 赞同：19
> 
> 时间：2016-02-18T11:45:38.923

刚接触这个主题的读者会被关于你*应*该做什么的无休止的讨论以及相对缺乏经验教训所震惊。我认为 REST 优于 SOAP 的事实是从经验中学习的高级别的，但是我们一定是从那里取得进步的吧？现在是 2016 年。Roy 的论文是在 2000 年。我们开发了什么？它有趣吗？容易集成吗？支持？它会处理智能手机的兴起和不稳定的移动连接吗？

根据 ME 的说法，现实生活中的网络是不可靠的。请求超时。连接被重置。网络一次中断数小时或数天。火车与移动用户一起进入隧道。对于任何给定的请求（正如在所有讨论中偶尔承认的那样），请求可能在途中落入水中，或者响应可能在返回途中落入水中。**在这种情况下，直接针对实质性资源发出 PUT、POST 和 DELETE 请求总是让我觉得有点野蛮和幼稚。**

HTTP 没有做任何事情来确保请求-响应的可靠完成，这很好，因为这正是网络感知应用程序的工作。开发这样的应用程序，您可以跳过箍以使用 PUT 而不是 POST，然后如果检测到重复请求，则更多箍在服务器上给出某种错误。回到客户端，您必须跳过障碍来解释这些错误、重新获取、重新验证和重新发布。

**或者您可以这样做**：将您的不安全请求视为短暂的单用户资源（我们称它们为操作）。客户端通过对资源的空 POST 请求对实质性资源执行新的“操作”。POST 将仅用于此目的。一旦安全地拥有新生成的操作的 URI，客户端会将不安全的请求发送到操作 URI，*而不是目标资源*。解决操作和更新“真实”资源是您的 API 的正确工作，并且在这里与不可靠的网络分离。

服务器执行业务，返回响应*并将其存储在约定的操作 URI*中。如果出现任何问题，客户端会重复请求（自然行为！），如果服务器已经看到它，它会重复存储的响应*并且不执行任何其他操作*。

您将很快发现与 promise 的相似之处：我们在执行任何操作之前创建并返回结果的占位符。也像一个承诺，一个动作可以成功或失败一次，但它的结果可以重复获取。

最重要的是，我们为发送和接收应用程序提供了将唯一标识的操作与各自环境中的唯一性相关联的机会。我们可以开始要求并强制执行！客户负责任的行为：尽可能多地重复您的请求，但在您拥有现有请求的明确结果之前不要生成新的操作。

这样，许多棘手的问题就消失了。重复的插入请求不会创建重复，并且在我们拥有数据之前我们不会创建真正的资源。（数据库列可以保持不可为空）。重复的更新请求不会达到不兼容的状态，也不会覆盖后续的更改。无论出于何种原因（客户端崩溃、响应丢失等），客户端都可以（重新）获取并无缝处理原始确认。

连续的删除请求可以查看和处理原始确认，而不会遇到 404 错误。如果事情花费的时间比预期的要长，我们可以临时做出回应，并且我们有一个地方可以让客户检查最终结果。这种模式最好的部分是它的功夫（熊猫）属性。我们采取弱点，即客户在不理解响应时重复请求的倾向，并将其转化*为优势*:-)

在告诉我这不是 RESTful 之前，请考虑尊重 REST 原则的多种方式。客户端不构建 URL。API 保持可发现性，尽管在语义上有一些变化。HTTP 动词使用得当。如果您认为这是一个巨大的实施变化，我可以根据经验告诉您事实并非如此。

如果您认为要存储大量数据，让我们来谈谈容量：典型的更新确认只有千字节的一小部分。HTTP 当前给您一两分钟的时间来明确响应。即使您只存储一周的操作，客户也有足够的机会赶上。如果您的容量非常大，您可能需要一个专用的符合 acid 的键值存储或内存解决方案。

* * *

## 回答 #22

> 赞同：17
> 
> 时间：2013-10-10T04:18:51.123

对于 REST 服务何时使用 HTTP POST 与 HTTP PUT 方法，似乎总是有些混淆。大多数开发人员会尝试将 CRUD 操作直接关联到 HTTP 方法。我认为这是不正确的，不能简单地将 CRUD 概念与 HTTP 方法相关联。那是：

```
Create => HTTP PUT
Retrieve => HTTP GET
Update => HTTP POST
Delete => HTTP DELETE 
```

确实，CRUD 操作的 R(etrieve) 和 D(elete) 可以分别直接映射到 HTTP 方法 GET 和 DELETE。然而，混淆在于 C(reate) 和 U(update) 操作。在某些情况下，可以使用 PUT 进行创建，而在其他情况下则需要 POST。歧义在于 HTTP PUT 方法与 HTTP POST 方法的定义。

根据 HTTP 1.1 规范，GET、HEAD、DELETE 和 PUT 方法必须是幂等的，而 POST 方法不是幂等的。也就是说，一个操作是幂等的，如果它可以在一个资源上执行一次或多次并且总是返回该资源的相同状态。而非幂等操作可以将资源的修改状态从一个请求返回到另一个请求。因此，在非幂等操作中，不能保证一定会收到相同的资源状态。

基于上述幂等定义，我对 REST 服务使用 HTTP PUT 方法与使用 HTTP POST 方法的看法是： 在以下情况下使用 HTTP PUT 方法：

```
The client includes all aspect of the resource including the unique identifier to uniquely identify the resource. Example: creating a new employee.
The client provides all the information for a resource to be able to modify that resource.This implies that the server side does not update any aspect of the resource (such as an update date). 
```

在这两种情况下，可以多次执行这些操作并获得相同的结果。也就是说，资源不会因多次请求操作而改变。因此，一个真正的幂等操作。在以下情况下使用 HTTP POST 方法：

```
The server will provide some information concerning the newly created resource. For example, take a logging system. A new entry in the log will most likely have a numbering scheme which is determined on the server side. Upon creating a new log entry, the new sequence number will be determined by the server and not by the client.
On a modification of a resource, the server will provide such information as a resource state or an update date. Again in this case not all information was provided by the client and the resource will be changing from one modification request to the next. Hence a non idempotent operation. 
```

结论

不要直接将 CRUD 操作关联和映射到 REST 服务的 HTTP 方法。HTTP PUT 方法与 HTTP POST 方法的使用应基于该操作的幂等性方面。也就是说，如果操作是幂等的，则使用 HTTP PUT 方法。如果操作是非幂等的，则使用 HTTP POST 方法。

* * *

## 回答 #23

> 赞同：15
> 
> 时间：2014-01-16T07:58:14.947

> 源服务器可以使用该 URI 创建资源

因此，您使用 POST 和可能但不是必需的 PUT 来创建资源。您不必同时支持两者。对我来说，POST 就足够了。所以这是一个设计决定。

正如您的报价所提到的，您使用 PUT 来创建没有分配给 IRI 的资源，并且无论如何您都想创建一个资源。例如，`PUT /users/123/password`通常用新密码替换旧密码，但如果密码不存在，您可以使用它来创建密码（例如，新注册的用户或通过恢复被禁止的用户）。

* * *

## 回答 #24

> 赞同：14
> 
> 时间：2013-10-21T21:16:32.953

我将登陆以下内容：

PUT 指的是由 URI 标识的资源。在这种情况下，您正在更新它。它是指资源的三个动词的一部分——删除和获取是另外两个。

POST 基本上是一个自由格式的消息，其含义被定义为“带外”。如果消息可以解释为向目录添加资源，那没关系，但基本上您需要了解您正在发送（发布）的消息以了解资源会发生什么。

* * *

因为 PUT 和 GET 和 DELETE 指的是一个资源，所以它们在定义上也是幂等的。

POST 可以执行其他三个功能，但是请求的语义会在缓存和代理等中介上丢失。这也适用于为资源提供安全性，因为帖子的 URI 不一定指示它正在应用的资源（尽管它可以）。

一个 PUT 不需要是一个创建；如果资源尚未创建，服务可能会出错，否则更新它。反之亦然——它可以创建资源，但不允许更新。PUT 唯一需要的是它指向一个特定的资源，它的有效负载是该资源的表示。成功的 PUT 意味着（排除干扰）GET 将检索相同的资源。

* * *

编辑：还有一件事——一个 PUT 可以创建，但如果它创建了，那么 ID 必须是一个自然 ID——也就是一个电子邮件地址。这样，当您 PUT 两次时，第二次 put 是第一次的更新。这使它具有*幂等性*。

如果生成了 ID（例如新的员工 ID），则具有相同 URL 的第二个 PUT 将创建一个新记录，这违反了幂等规则。在这种情况下，动词是 POST，消息（不是资源）是使用该消息中定义的值创建资源。

* * *

## 回答 #25

> 赞同：11
> 
> 时间：2013-12-11T22:15:48.673

这是一个简单的规则：

**应使用PUT**到 URL 来更新或创建可位于该 URL 的资源。

**POST**到 URL 应该用于更新或创建位于某个其他（“从属”）URL 或无法通过 HTTP 定位的资源。

* * *

## 回答 #26

> 赞同：10
> 
> 时间：2011-10-23T20:07:55.460

语义应该是不同的，因为“PUT”和“GET”一样应该是幂等的——这意味着，您可以多次执行相同的 PUT 请求，结果就像您只执行了一次一样。

我将描述我认为最广泛使用和最有用的约定：

当您将资源放在特定的 URL 时，会发生这种情况，它应该保存在该 URL 或类似的东西上。

当您发布到特定 URL 的资源时，您通常会将相关信息发布到该 URL。这意味着 URL 处的资源已经存在。

例如，当你想创建一个新流时，你可以把它放到某个 URL 上。但是，当您想将消息发布到现有流时，您需要发布到其 URL。

至于修改流的属性，您可以使用 PUT 或 POST 来完成。基本上，只有在操作是幂等的时候才使用“PUT”——否则使用 POST。

但是请注意，并非所有现代浏览器都支持 GET 或 POST 以外的 HTTP 动词。

* * *

## 回答 #27

> 赞同：10
> 
> 时间：2017-06-21T17:38:44.630

大多数时候，你会像这样使用它们：

*   **将**资源发布到集合中
*   **PUT**由 collection/:id 标识的资源

例如：

*   **发布**/项目
*   **放置** /items/1234

在这两种情况下，请求正文都包含要创建或更新的资源的数据。从路由名称中应该可以看出 POST 不是幂等的（如果你调用它 3 次它会创建 3 个对象），但 PUT 是幂等的（如果你调用它 3 次结果是一样的）。PUT 通常用于“upsert”操作（创建或更新），但如果您只想使用它进行修改，则始终可以返回 404 错误。

请注意，POST 在集合中“创建”一个新元素，而 PUT 在给定 URL 处“替换”一个元素，但使用 PUT 进行部分修改是一种非常常见的做法，即仅使用它来更新现有资源和仅修改正文中包含的字段（忽略其他字段）。这在技术上是不正确的，如果你想成为 REST 纯粹主义者，PUT 应该替换整个资源，你应该使用 PATCH 进行部分更新。只要行为在所有 API 端点中清晰且一致，我个人并不在意。

请记住，REST 是一组让您的 API 保持简单的约定和指南。如果您最终只是为了检查“RESTfull”框而进行了复杂的解决方法，那么您就没有达到目的；）

* * *

## 回答 #28

> 赞同：8
> 
> 时间：2014-07-21T20:02:35.833

虽然可能有一种不可知论的方式来描述这些，但它似乎与来自网站答案的各种陈述相冲突。

让我们在这里非常清楚和直接。如果您是使用 Web API 的 .NET 开发人员，事实是（来自 Microsoft API 文档）， [http://www.asp.net/web-api/overview/creating-web-apis/creating-a-web -api-that-supports-crud-operations](http://www.asp.net/web-api/overview/creating-web-apis/creating-a-web-api-that-supports-crud-operations)：

```
1\. PUT = UPDATE (/api/products/id)
2\. MCSD Exams 2014 -  UPDATE = PUT, there are **NO** multiple answers for that question period. 
```

当然，您“可以”使用“POST”进行更新，但只需按照给定框架为您制定的约定即可。就我而言，它是 .NET / Web API，所以**PUT 用于 UPDATE**没有争议。

我希望这可以帮助任何使用 Amazon 和 Sun/Java 网站链接阅读所有评论的 Microsoft 开发人员。

* * *

## 回答 #29

> 赞同：8
> 
> 时间：2016-06-29T21:13:07.827

如果你熟悉数据库操作，有

1.  选择
2.  插入
3.  更新
4.  删除
5.  合并（如果已经存在则更新，否则插入）

我`PUT`用于合并和更新类似操作并`POST`用于插入。

* * *

## 回答 #30

> 赞同：6
> 
> 时间：2014-10-06T06:51:56.893

在实践中，POST 非常适合创建资源。新创建资源的 URL 应在 Location 响应标头中返回。PUT 应该用于完全更新资源。请理解，这些是设计 RESTful API 时的最佳实践。HTTP 规范本身不限制使用 PUT/POST，但对创建/更新资源有一些限制。查看总结了最佳实践的[http://techoctave.com/c7/posts/71-twitter-rest-api-dissected 。](http://techoctave.com/c7/posts/71-twitter-rest-api-dissected)

* * *

## 回答 #31

> 赞同：4
> 
> 时间：2013-12-12T11:06:52.543

**POST：**使用它来创建新资源。这就像具有自动递增 ID 的 INSERT（SQL 语句）。在响应部分，它包含一个新生成的 Id。

> POST 也用于更新记录。

**PUT：**使用它来创建新资源，但在这里我知道身份密钥。这就像我事先知道身份密钥的 INSERT（SQL 语句）。在响应部分它什么也不发送。

> PUT 也用于更新资源

* * *

## 回答 #32

> 赞同：4
> 
> 时间：2020-12-04T20:56:49.650

## 概括

*   用于使用请求中包含的表示定义`PUT`的状态来创建或替换*目标*资源的状态。这种*标准化*的预期效果是*幂等*的，因此它通知中介他们可以在通信失败的情况下重复请求。
*   以其他方式使用`POST`（包括创建或替换目标资源以外的资源的状态）。它的预期效果*没有标准化*，因此中介不能依赖任何普遍的财产。

## 参考

[RFC 7231](https://datatracker.ietf.org/doc/html/rfc7231) (Roy Fielding, Julian Reschke, 2014)中给出了关于 the`POST`和`PUT`request 方法之间语义差异的最新权威描述：

> `POST`和方法之间的根本区别在于`PUT`封闭表示的不同意图。请求中的目标资源`POST`旨在根据资源自身的语义处理封闭的表示，而`PUT`请求中的封闭表示被定义为替换目标资源的状态。因此，intent 的意图`PUT`是幂等的并且对中介可见，即使确切的效果只有源服务器知道。

换句话说，预期效果`PUT`是*标准化*的（使用请求中包含的表示定义的状态创建或替换*目标*资源的状态），因此对所有目标资源都是通用的，而预期效果`POST`不是*标准化*的，并且所以特定于每个目标资源。因此`POST`可以用于任何事情，包括实现`PUT`和其他请求方法（`GET`、`HEAD`、`DELETE`、`CONNECT`、`OPTIONS`和`TRACE`）的预期效果。

但建议始终使用更专业的请求方法，而不是`POST`在适用的情况下，因为它为中介提供更多信息以自动检索信息（因为`GET`、`HEAD`、`OPTIONS`和`TRACE`被定义为*安全*的）、处理通信故障（因为`GET`、`HEAD`、`PUT`、`DELETE`、`OPTIONS`和`TRACE`被定义为*idempotent*），并优化缓存性能（因为`GET`和`HEAD`被定义为*cacheable*），如[*使用 POST 可以*](https://roy.gbiv.com/untangled/2009/it-is-okay-to-use-post)（Roy Fielding，2009）中所述：

> `POST`只有在其他方法非常适合的情况下使用它才会成为问题：例如，检索应该是某种资源的表示的信息 ( `GET`)、完全替换表示 ( `PUT`) 或任何其他标准化告诉中间人一些比“这可能会改变一些事情”更有价值的方法。其他方法对中介更有价值，因为它们说明了如何自动处理故障以及中间缓存如何优化它们的行为。`POST`没有这些特征，但这并不意味着我们可以没有它。`POST`在 HTTP 中有许多有用的用途，包括“此操作不值得标准化”的一般用途。</p>

* * *

## 回答 #33

> 赞同：4
> 
> 时间：2021-09-17T09:51:46.443

对我来说，理解差异的关键是了解**谁定义了**资源的 ID：

示例（带有一些地址服务）

```
POST (sever creates new resource)

client               server/addresses      // NOTE: no ID in the request
  |                                 |
  | --{POST address data}-->        |
  |                                 |
  | <--{201, created addresses/321} |      // NOTE: resource ID in the reply
  |                                 | 
```

```
PUT (sever sets data of resource, creating it if necessary)

client               server/addresses/321      // NOTE: *you* put the ID here!
  |                                 |
  | --{PUT address data (to 321)}-->|
  |                                 |
  | <--{201, created }              |          // NOTE: resource ID not required here
  |                                 | 
```

下面有很多很棒的答案，里面有很多细节，但这帮助我明白了这一点。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2019-06-26T09:01:14.333

我认为在这个 PUT vs POST 问题上还有一个有趣的观点没有分享：

如果您想要一个无需 JavaScript 的 Web 应用程序（例如，如果有人使用 Lynx 之类的命令行浏览器或 NoScript 或 uMatrix 之类的浏览器插件），您将不得不使用 POST 发送数据，因为 HTML 表单仅支持GET 和 POST HTTP 请求。

基本上，如果您想使用渐进增强 ( [https://en.wikipedia.org/wiki/Progressive_enhancement](https://en.wikipedia.org/wiki/Progressive_enhancement) ) 让您的 Web 应用程序在任何地方都可以工作，无论是否使用 JavaScript，您都不能使用其他 HTTP 方法，例如 PUT 或 DELETE，它们只是在 HTTP 1.1 版中添加。

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2019-09-20T13:31:12.257

除了以上所有答案：

* * *

最常用于专业实践，

* * *

*   **我们在CREATE**操作中使用 PUT over POST 。为什么？因为这里的许多人也说过，响应是不可缓存的，而 POST 是（需要内容位置和过期）。
*   **我们在UPDATE**操作中使用 POST over PUT 。为什么？因为它使整个包含资源的缓存副本无效。这在更新资源时很有帮助。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2018-05-08T02:39:46.850

> 那么，应该使用哪一个来创建资源呢？还是需要两者都支持？

你应该使用`PATCH`. 您修补问题列表，例如

```
PATCH /questions HTTP/1.1 
```

带有一个包含您要创建的对象的列表，例如

```
[
    {
        "title": "I said semantics!",
        "content": "Is this serious?",
        "answer": "Not really"
    }
] 
```

这是一个 PATCH 请求

*   您修改*现有*资源列表*而不提供全新*内容
*   *您在不提供所有数据*的情况下将新问题的状态从不存在更改为存在（服务器很可能会添加一个`id`）。

这种方法的一大优点是您可以使用单个请求创建多个实体，只需在列表中提供它们。

这`PUT`显然是做不到的。您可以`POST`用于创建多个实体，因为它是 HTTP 的厨房接收器，并且基本上可以做所有事情。

一个缺点是可能没有人使用`PATCH`这种方式。恐怕，我只是发明了它，但我希望，我提供了一个很好的论据。

您可以`CREATE`改用，因为允许自定义 HTTP 动词，只是它们可能不适用于某些工具。

关于语义，`CREATE`恕我直言是唯一正确的选择，其他一切都是圆孔中的方钉。不幸的是，我们只有圆孔。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2021-10-11T05:54:05.137

上面和下面的所有答案都是正确的，只是一个小（重要）说明。所有这些“动词”都是建议，它们的效果没有强制执行。服务器可以自由地做他们想做的任何事情，这意味着使用 GET 或服务器想要的任何内容进行编写。这一切都取决于实现后端。

例如 PHP，读取`$_POST`和`$_GET`. 通过从这些数组中读取变量将完成什么完全取决于程序员。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2021-11-21T14:11:14.887

`POST`用于向服务器发送数据。
`PUT`用于将数据存放到服务器上的资源（例如，文件）中。

*[我在HTTP: The Definitive Guide](https://www.oreilly.com/library/view/http-the-definitive/1565925092/)*一书的脚注（第 55 页）中看到了这一点。

# sql-server - 寻找为表中的数据生成 INSERT 语句的应用程序

> ID：630461
> 
> 赞同：4
> 
> 时间：2009-03-10T14:27:19.480
> 
> 标签：sql-server, desktop-application, configuration-management

寻找一个允许我连接到 SQL Server 的应用程序，选择任意数量的表，然后为这些表中包含的数据生成 INSERT 语句。

有人知道这样的应用程序吗？最好是免费软件，但商业版本也可能很有趣。

谢谢，布鲁斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T14:37:33.603

这是一个[有趣的 SPROC](http://vyaskn.tripod.com/code.htm#inserts)，它似乎可以满足您的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T14:35:03.080

您可能想查看 Microsoft SQL Server 数据库发布向导 1.1 ( [http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en) )。从描述：

> SQL Server 数据库发布向导可以将 SQL Server 数据库部署到 SQL Server 2000 或 2005 服务器上的托管环境中。它生成单个 SQL 脚本文件，可用于在共享托管环境中重新创建数据库（模式和数据），其中与服务器的唯一连接是通过带有脚本执行窗口的基于 Web 的控制面板。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T15:11:43.617

试试[SSMS 工具包](http://www.ssmstoolspack.com/)。它是免费的，并为 Sql Server Management Studio 提供了许多其他增强功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T14:35:20.800

[EMS DB Extract for SQL Server](http://www.sqlmanager.net/en/products/mssql/extract)产品是商业产品，您必须查看他们的网站以了解定价，它将使用来自选定表的数据的 INSERT 语句创建 SQL 脚本。

当然，该软件会做更多的事情，但它也会做你想做的事。

# c# - 在“this”方法中注册到“this”对象自己的事件处理程序

> ID：630464
> 
> 赞同：1
> 
> 时间：2009-03-10T14:27:26.607
> 
> 标签：c#, .net, events

我想为“Authenticator”（以下简称“objAuthenticator”）实例生成的事件提供默认实现。

提供这样的方法来注册处理 objAuthenticator 自己的事件以提供默认实现，这是一种可接受的做法吗？

而且，如果这是一种可以接受的做法，我还有两个后续问题。我有两个用于“SendEmailOnAuthenticationFailed”的重载方法。

*   我应该向外界公开哪一个？
*   哪一个会导致类之间的耦合减少？

    ```
    public class Authenticator
    {
            public event EventHandler AuthenticationFailed = delegate { };
            protected virtual void OnAuthenticationFailed()
            {
                var handler = AuthenticationFailed;
                handler(this, EventArgs.Empty);
            }

            public void IsAuthenticated()
            {
                // Some logic...
                // ...
                // Woops authentication failed
                OnAuthenticationFailed();
            }

            // Is this a better option?
            public void SendEmailOnAuthenticationFailed()
            {
                SendEmailOnAuthenticationFailed(EmailSender);
            }

            // Or is this?
            public void SendEmailOnAuthenticationFailed(EventHandler emailSender)
            {
                AuthenticationFailed += emailSender;
            }

            private void EmailSender(object sender, EventArgs e)
            {
                Console.WriteLine("Send email: EmailSender");
            }
        } 
    ```

***[更新]***：回答 Marc Gravell 的问题

> 我对你的代码试图做什么感到很困惑

到目前为止，“SendEmailOnAuthenticationFailed”还没有暴露给外界。我想要做的是（我刚刚添加了 IsAuthenticated）在“IsAuthenticated”中，当身份验证失败时，我想发送一封电子邮件，而不必在任何地方编写相同的事件处理程序。

***[UPDATE2]***：我意识到没有必要公开“AuthenticationFailed”。我会在不暴露事件的情况下尽可能关闭课堂。

为什么我们不能将多个答案标记为“答案”？...

***[UPDATE3]***：最终输出：这是我决定实施的方式。

```
public class Authenticator
{
    private readonly IEmailResponder _EmailResponder;

    public Authenticator(IEmailResponder emailResponder)
    {
        _EmailResponder = emailResponder;
    }

    public void IsAuthenticated()
    {
        // Some logic...
        // ...

        // Woops authentication failed
        SendEmailForAuthenticationFailure();
    }

    private void SendEmailForAuthenticationFailure()
    {
        _EmailResponder.SendEmail(...);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:33:56.453

听你自己的事件是不寻常的；这样的逻辑通常可以进入 OnAuthenticationFailed 方法。也就是说 - 我对你的代码试图做什么感到**非常**困惑，这使得回答有点困难......

我怀疑它是否适用，但另外请注意，如果此代码是高度线程化的（大多数不是），则可能需要考虑一些微妙的[同步问题（在与您自己的事件交谈时）。](http://marcgravell.blogspot.com/2009/02/fun-with-field-like-events.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T14:35:49.693

我想我第一次误解了你的问题......我说你想要一种*可选*的方式是对的吗？我个人怀疑我会在构造函数中使用它：

```
public class Authenticator
{
    public event EventHandler AuthenticationFailed = delegate { };

    public Authenticator(bool sendEmailOnFailure)
    {
         if (sendEmailOnFailure)
         {
             // No need for the no-op delegate any more, so just replace it.
             AuthenticationFailed = EmailSender;
         }
    }
} 
```

或者，将“电子邮件发送”功能与“身份验证”功能分开，以便更好地分离关注点，并让调用者根据需要使用电子邮件处理程序进行订阅。这可能是一个更整洁的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:41:21.597

第一个问题的答案是可以接受。对于您的后续行动，答案是视*情况而*定。第一个将电子邮件流程内部化。如果您选择这样做，请确保您正在注入电子邮件逻辑。如果您选择后者，它允许您注入行为。但是，如果您使用第二个，我建议您更改名称，因为它是电子邮件、MQ 还是 tiddlywinks 都没有关系。事实上，第二种方法并不是真正需要的，因为它们可以直接订阅事件。

如果您担心解耦，则需要考虑 Authenticator 类的单一职责。应该是进行身份验证，而不是发送电子邮件。试试这个：

```
public class Authenticator
{
    public event EventHandler AuthenticationFailed = delegate { };

    protected virtual void OnAuthenticationFailed()
    {
        AuthenticationFailed(this, EventArgs.Empty);
    }
} 
```

现在，使用身份验证器：

```
AuthenticationEmailResponder responder = new AuthenticationEmailResponder(emailAddress, emailServer);
objAuthenticator.AuthenticationFailed += responder.SendFailureMessage; 
```

# wpf - 每个 WPF 文件中的 xmlns 是什么？

> ID：630468
> 
> 赞同：46
> 
> 时间：2009-03-10T14:28:11.940
> 
> 标签：wpf, xml, xaml

是什么`xmlns`？

当我们创建 WPF 项目时，它在 XAML 文件中扮演什么角色？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-10T14:32:25.973

xmlns 是一个 XML（不一定是 XAML）构造，它定义了一个名称空间，在该名称空间中解析 xml 元素名称。因为它是在没有限定符的情况下定义的，所以它定义了解析 XML 元素名称的默认名称空间。

在 XAML 中，您通常会看到以下条目。它将默认命名空间定义为本质上是 WPF，因此所有 XML 元素名称都被解析为 WPF 元素。

```
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
```

如下所示的非默认命名空间也很常见。

```
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
```

这为 XAML 特定元素定义了一个合格的命名空间。如果您希望在此命名空间中解析元素或属性名称，则应使用 x 对其进行限定。例如

```
<StackPanel x:Name="foo" /> 
```

此定义中有 2 个名称解析。

1.  StackPanel - 因为它是一个非限定名称，它将在默认命名空间 WPF 中解析
2.  x:Name - 名称由 x 限定，并将在 XAML 文档中解析。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-10T14:50:54.430

您还可以使用 xmlns 在您的 XAML 中获取对您自己的命名空间的引用。在创建新的 WPF 项目时，我做的第一件事就是添加对项目命名空间的引用：

```
xmlns:local="clr-namespace:MyWpfProject" 
```

现在我可以使用“local:”前缀访问我可能在项目中创建的任何类（如 IValueConverters 和 DataTemplateSelectors）

```
<local:BooleanToColorConverter x:Key="booleanToColorConverter" DefaultBrush="Green" HighlightBrush="Red" /> 
```

当然，您不必使用“本地”，您可以随意命名。您可以以相同的方式添加对您需要的任何其他命名空间的引用。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-12T13:57:25.337

您还可以通过添加`XmlnsDefinitionAttribute`到程序集将多个 CLR 命名空间映射到一个 XML 命名空间。这就是 WPF 团队所做的，通过在 System.Windows 下映射大量命名空间，如下所示：

```
[XmlnsDefinitionAttribute(
    "http://schemas.microsoft.com/winfx/2006/xaml/presentation", 
    "System.Windows.Controls")]
[XmlnsDefinitionAttribute(
    "http://schemas.microsoft.com/winfx/2006/xaml/presentation", 
    "System.Windows.Ink")] 
```

此语法可以简化您的 XAML，但请注意不要在您合并在一起的 CLR 命名空间中拥有同名的类。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-10T14:29:37.867

取自[MSDN](http://msdn.microsoft.com/en-us/library/ms752059.aspx) 根元素还包含属性 xmlns 和 xmlns:x。这些属性向 XAML 处理器指示哪些 XML 命名空间包含标记将引用的元素的元素定义。xmlns 属性专门指示默认的 XML 命名空间。

这种使用 xmlns 来定义使用和映射范围的做法与 XML 1.0 规范一致。

希望这可以帮助。

# sql - 从数字中删除非数字数据+ SQL

> ID：630472
> 
> 赞同：3
> 
> 时间：2009-03-10T14:29:16.807
> 
> 标签：sql, sql-server, tsql, numbers

我正在尝试找到从 SQL 中的 varchar 中删除非数字数据的最佳方法，例如

```
'(082) 000-0000' to '0820000000' or
'+2782 000 0000' to '0820000000' 
```

困难在于我并不总是确定会出现什么数字格式，如上所示，所以我希望本质上不是数字的所有内容都被删除。

**更新：**
从你们所说的来看，这是一个小小的峰值：

```
declare @Num varchar(20)

set @Num = ' + (82) 468 6152 '

--strip nonnumrical data out of @num

print @Num

set @Num = replace(@Num, ' ', '')
set @Num = replace(@Num, '+', '')
set @Num = replace(@Num, '-', '')
set @Num = replace(@Num, '(', '')
set @Num = replace(@Num, ')', '')

print @Num 
```

但是无法正确获取替换 [^0-9] 表达式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T14:52:13.927

如果您使用的是 SQL Server 2005 或更新版本，那么您最好的选择是创建一个[用户定义的 CLR 函数](http://msdn.microsoft.com/en-us/library/ms189876.aspx)并使用正则表达式来删除所有非数字字符。

如果您不想使用 CLR 函数，那么您可以创建一个标准的用户定义函数。这将完成这项工作，尽管它不会那么有效：

```
CREATE FUNCTION dbo.RemoveNonNumerics(@in VARCHAR(255))
RETURNS VARCHAR(255)
AS
BEGIN
    DECLARE @out VARCHAR(255)

    IF (@in IS NOT NULL)
    BEGIN
        SET @out = ''

        WHILE (@in <> '')
        BEGIN
            IF (@in LIKE '[0-9]%')
                SET @out = @out + SUBSTRING(@in, 1, 1)

            SET @in = SUBSTRING(@in, 2, LEN(@in) - 1)
        END
    END

    RETURN(@out)
END 
```

然后像这样从你的表中选择：

```
SELECT dbo.RemoveNonNumerics(your_column) AS your_tidy_column
FROM your_table 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T14:33:52.303

看看[这篇文章](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=27205)（这是第 8 篇文章 - 第一篇 LONG 文章），它详细介绍了如何在 SQL Server 中使用正则表达式。它不是最快的（在你使用 SQL 之前会这样做），但它提供了一种体面的方法来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T14:33:30.290

在业务层处理字符串解析要容易得多。但是，使用 T-SQL REPLACE() 函数（假设 MS SQL）。

您可以使用该函数对传入的参数执行一个循环，以从中删除所有非数字字母。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-19T14:05:17.910

我发现最有效和最灵活的是使用数字/计数表方法，如 2009 年 3 月 10 日 mwigdahl 的回答所示

即允许列表比您在上面问题底部放置的不允许列表更安全。

你没有说的是你如何处理非整数......你如何处理小数点？

# asp.net - Visual Studio 2005：是否有一种简单的方法可以在 ASPX 文件中正确缩进？

> ID：630476
> 
> 赞同：10
> 
> 时间：2009-03-10T14:29:57.087
> 
> 标签：asp.net, visual-studio, visual-studio-2005, indentation, auto-indent

在 Visual Studio 2005 中，有没有办法正确缩进 aspx 文件中的标签（不是在 .cs 文件中，而是在包含 HTML/ASP 代码的 ASPX 文件中）？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-10T14:33:32.663

您可以使用快捷键 Ctrl-K+D 修复缩进

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-10T14:41:41.427

这些击键转换为：

*   *`Ctrl`- `K`, `Ctrl`-`D`* : 编辑/高级/格式化文档
*   *`Ctrl`- `A`, `Ctrl`- `K`, `Ctrl`-`F`*：编辑/全选，编辑/高级/格式选择

出于某种原因，后者似乎更适合我。

请注意，这些也适用于其他文件类型：C#、VB、XML 等...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T14:33:56.453

Ctrl-A（全选），Ctrl-KF 对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T15:02:47.460

XML 编辑器工具栏 -> 格式化整个文档。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-07-16T15:25:16.783

您想要转到工具 > 选项，然后导航到文本编辑器 > 所有语言 > 选项卡。

您需要的设置是： 在缩进下单击“智能”单选框进行智能缩进。在制表符下，您需要制表符大小 4 和缩进大小 4。并选中标记为“插入空格”的单选按钮。

您还可以单独更改每种语言的这些设置。还有一些没有智能缩进，比如html。

# windows - 在 Windows 上获取系统“负载”

> ID：630503
> 
> 赞同：3
> 
> 时间：2009-03-10T14:35:06.230
> 
> 标签：windows, load

我正在寻找一种方法来获取 Windows 上的当前“负载”（如在 Unix 中：[等待 CPU/数据的进程数](http://en.wikipedia.org/wiki/Load_(computing))）。这有可能吗？

背景：默认情况下，Windows 会告诉你 CPU 的使用量或网络流量、RAM 使用量等。从性能的角度来看，这是没有用的。当病毒扫描程序阻止我的 IDE 时，我不在乎 97% 的 CPU 处于空闲状态。我想知道进程是否被阻塞等待某些资源。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T14:49:47.880

`System\Processor Queue Length`计数器会告诉你有多少线程正在等待 CPU 资源。 `LogicalDisk\Current Disk Queue Length`将告诉您有多少请求正在等待磁盘 I/O。

编辑：您可以使用 Vista 中的“可靠性和性能监视器”或 XP 中的“perfmon.exe”绘制这些值。Unix 为您提供不同时间间隔的时间平均值；perfmon 有一个平均计数器（所有计数器的可配置采样间隔），或者您可以获取当前队列的快照。我认为没有办法像 Unix 给你的那样获得 EMA（指数移动平均线）。

# asp.net - 用户（ASP.NET）省略时如何自动添加子域www？

> ID：630512
> 
> 赞同：1
> 
> 时间：2009-03-10T14:36:50.080
> 
> 标签：asp.net, redirect, subdomain

好的，由于某些客户端安全性或其他原因，数据库跟踪仅在子域前面有 www 时才有效。我想阻止用户访问 thewebsite.com 并在以后发现数据库没有为他们记录时提供进一步的支持票。如果他们点击 thewebsite.com，我需要它重定向到 www.thewebsite.com。

PS：我听说人们抱怨 www 应该已经被弃用了，所以请屏住呼吸；）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T14:40:02.320

如果你同时通过 www。和非 www。对 ASP.NET 的请求，您可以检查 Request.Url 对象并检查它是否具有 www，如果没有，您可以 Response.Redirect 到 www。选项。

就我个人而言，我宁愿进入 IIS，创建一个仅接受非 www 的单独网站。请求并使用主页选项卡上的重定向选项将其重定向到 www。网址。这意味着不需要更改代码，任何处理 503 状态消息的应用程序都会自动更新 URL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T15:02:46.010

使用 HttpModule 检查 url；这将帮助您避免在每个页面或基本页面（如果有的话）中测试该条件。此外，如果您重定向，请确保您没有使用 Response.Redirect，因为它出于 SEO 原因发出非永久重定向 (302) 而不是永久重定向 (301)。

对 PS 的回应：实际上 www 前缀总是比根 url 更好，因为它允许您为静态内容使用无 cookie 的域，从而减少浏览器和服务器之间来回发送的数据量。

# database - 在 NHibernate 中处理来自数据库的约束冲突

> ID：630513
> 
> 赞同：0
> 
> 时间：2009-03-10T14:37:04.197
> 
> 标签：database, nhibernate, exception, constraints

我有一个我认为是 NHibernate 相当常见的用例。我创建了一个实体并尝试使用 ISession.Save() 和 Transaction.Commit() 来保存它。在这一点上，我希望违反唯一/主键约束之类的事情会作为例外出现在我面前。然而，我看到的只是一个 GenericADOException。这并不能帮助我区分真正的数据库故障与要求用户为实体选择另一个名称以保持唯一性之类的事情。

目前，我已经实现了首先查询的丑陋解决方法，以确保不会违反约束。这只是一个等待发生的竞争条件，我真的不希望用户看到“糟糕，数据库做了一些有趣的事情！也许你应该再试一次。” 种消息。

有没有一种优雅的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T23:02:03.610

NHibernate 不知道约束（并且一开始就很难强制执行唯一约束），因此处理这在很大程度上取决于您。我认为你在正确的轨道上通过查询检查该值是否不存在，但正如你所提到的，这留下了另一个进程/线程首先插入该值的可能性。该方法的解决方案是独占锁，但当然您必须考虑该锁的含义。我不知道 NHibernate 的锁定方法是如何工作的，但如果它们不能提供您需要的东西，您可以随时访问连接并使用原始 SQL。

# vim - 打开时可以使vi“前进”屏幕吗？

> ID：630519
> 
> 赞同：4
> 
> 时间：2009-03-10T14:38:07.660
> 
> 标签：vim, scroll, gnu-screen

我经常在 vi 中工作，暂停 vi，在 cli 上运行一些东西，然后 fg 回到 vi 以处理结果。例如，修复运行 cli 命令时出现的错误。

但是，当我 fg vi 时，vi “擦除”当前终端缓冲区，并且在回滚缓冲区中看不到终端输出的“最后一屏”。

vi（或屏幕，我使用屏幕）中有一些设置可以帮助我吗？

我在谷歌上搜索了很长时间，没有答案。我也意识到还有其他工作流程可以解决这个问题，但它们并不完美（从 vi 内部运行意味着没有 shell 完成等）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-10T15:07:45.683

如果您正在使用，那么在一个窗口中进行编辑，在另一个窗口中进行编译，然后只使用序列在终端输出和代码屏幕之间`screen`切换肯定是有意义的吗？`^A[n]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-23T00:55:18.170

在您对此[答案](https://stackoverflow.com/questions/630519/can-you-make-vi-advance-the-screen-when-opened/632482#632482)的评论中回答您的问题：它似乎实际上是`t_ti`变量。在您`~/.vimrc`添加一行内容：

```
set t_ti="" 
```

您可以通过在提示符`vim`下输入该命令先从内部进行尝试。`:`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T22:12:45.460

我不能 100% 确定这是否会对您有所帮助，但 vim 会尝试恢复它在启动时找到的屏幕。我喜欢这种行为，并花了相当多的时间在一台机器上“修复”一个 vim 安装，而这不起作用。

我必须设置[t_ti](http://vimdoc.sourceforge.net/htmldoc/term.html#'t_ti')和[t_te](http://vimdoc.sourceforge.net/htmldoc/term.html#'t_te')变量。我的直觉是你应该取消设置 t_te。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T21:57:30.193

我不知道这是否会有所帮助，但是：这些天我使用 mac，但我曾经在 uni 使用 NetBSD 和 Linux。`less`像, `man`,`vi`等这样的程序在退出时会清除屏幕总是让我感到困扰。`less`我可以使用该选项将其关闭`-X`，但这不是其他选项（字面意思）。

我发现一个配置设置`xterm`为我解决了这个问题。恐怕我不记得那个选项了；它可以通过其中一个菜单获得，我认为是通过`-xrw`命令行选项。

显然，这只有在您使用`xterm`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T14:47:38.540

滚动屏幕`Ctrl`+`E`或 `Ctrl`+`Y`也可能起到作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T14:57:40.310

将终端类型更改为 ansi 可以工作：

```
:set term=ansi 
```

但我确信有一些负面影响。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-23T15:24:21.910

这不是一个解决方案，而是一个很好的解决方法，我刚刚开始使用。为 vi 创建以下包装脚本（我将它放在我的 ~/bin/vim-wrapper 中），并可能使用类似以下内容的别名：

```
alias vi='~/bin/vim-wrapper' 
```

内容`vim-wrapper`（有关详细信息，请参阅[此答案](https://stackoverflow.com/questions/1780483/lines-and-columns-environmental-variables-lost-in-a-script/1782909#1782909)）：

```
#!/bin/bash
LINES=$(tput lines)
for i in `seq 1 $LINES`; do
    echo $i
done
vim $@ 
```

这将彻底解决*屏幕消失的*问题。不幸的是，当您在 vim 中编辑长文件时，它并**不能解决***必须向上滚动很多的问题。*但是，如果您在类似 xterm 中设置了足够大的缓冲区（我使用 gnome 终端 2.22.1），您就可以了。

# ms-access - 为什么报告会抛出错误，而相应的查询却没有？

> ID：630520
> 
> 赞同：2
> 
> 时间：2009-03-10T14:38:08.440
> 
> 标签：ms-access

我必须使用 Microsoft Access 应用程序。（至少在我有时间用另一种语言重写之前。）

我收到了一份报告，该报告引发了错误“PARAMETER 子句中的语法错误”。

目前 SQL 看起来像这样：

```
PARAMETERS [Test] Text ( 255 );
SELECT … 
```

如果我删除 PARAMETERS 行，问题就会消失。

奇怪的是，如果我在数据表视图中打开查询，程序会显示对话框。只有当我尝试打开报告时，它才会显示此消息。

任何线索有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T15:24:59.857

这可能是 MS Office Service Pack 1 修复的错误吗？

[http://support.microsoft.com/kb/942378](http://support.microsoft.com/kb/942378)

该文件的大约三分之一：

*在 Access 2007 中执行包含参数的查询时出现错误消息：“参数子句中的语法错误”在 Access 2007 中，当您尝试执行包含参数的查询时，您会收到以下错误消息：*

# c# - 为什么 MSDN 网站上的这个 lambda 示例不起作用？

> ID：630521
> 
> 赞同：2
> 
> 时间：2009-03-10T14:38:08.877
> 
> 标签：c#, lambda

我必须对以下 lambda 示例做什么才能使其正常工作？

错误：*只有赋值、调用、递增、递减和新对象表达式可以用作语句*

[http://msdn.microsoft.com/en-us/library/bb397687.aspx](http://msdn.microsoft.com/en-us/library/bb397687.aspx)

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Linq.Expressions;

namespace TestLambda
{
    class Program
    {
        static void Main(string[] args)
        {
            delegate int del(int i);
            del myDelegate = x => x * x;
            int j = myDelegate(5); //j = 25
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-10T14:40:53.220

在 C# 中将类型定义为方法体语句是不合法的。您需要将委托移到方法之外才能编译。例如

```
 delegate int del(int i);

public static void Main(string[] args) {

    del myDelegate = x => x * x;
    int j = myDelegate(5); //j = 25
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-10T14:41:41.037

您需要在方法之外声明委托：

```
class Program
{
    delegate int del(int i);

    static void Main(string[] args)
    {            
        del myDelegate = x => x * x;
        int j = myDelegate(5); //j = 25
    }

} 
```

# xml - 我可以从 Java 中的 dtd 文件创建 XML 文档吗？

> ID：630522
> 
> 赞同：0
> 
> 时间：2009-03-10T14:38:12.637
> 
> 标签：xml, dom, parsing, dtd, sax

我有一个包含元素和属性规范的简单 DTD 文件。我可以创建一个合适的 XML 文件（带有 DOM），用 Java 解析这个 DTD 而没有外部 API？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:53:59.133

有一些误会。您不能使用 DOM 或 SAX 解析 DTD。DTD 描述文档结构。您可以使用各种工具根据 DTD 验证生成的文档。

只需阅读并理解 DTD 并相应地生成 XML 文档。您可以稍后检查文档是否符合 DTD。

编辑：您不必为解析 DTD 编写代码。首先，您应该阅读有关 DTD 的内容。[从Wikipedia description](http://en.wikipedia.org/wiki/Document_Type_Definition)开始，最后有更多链接。

然后手动阅读 DTD 并了解所需的文档结构。然后只需生成符合 DTD 的 XML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T07:47:37.637

我对您的问题的理解与 Eugene Morozov 不同。告诉我我是否正确：您需要一个程序，它以 DTD 作为输入并**自动**生成根据该 DTD 有效的 XML 文件。是正确的描述吗？

如果是这样，那当然是可能的，这样的程序存在于其他“结构语言”中（参见[abnfgen](http://www.quut.com/abnfgen/)了解 BNF 语法；在 XML 世界中，例如 XMLSpy 似乎可以打开 W3C Schema 文件 - XSD 文件 - 并生成一个示例有效的 XML），但我不知道用于 DTD/XML 的，您必须自己编写。

请注意，根据给定的 DTD ，存在**无限的有效 XML 文件。**您的程序只会生成一个小子集（但它可能足以满足您的目的：它到底是什么？）

# version-control - DBML 更改和源代码控制

> ID：630525
> 
> 赞同：9
> 
> 时间：2009-03-10T14:38:50.200
> 
> 标签：version-control, dbml

我在使用 DBML 时遇到了一些问题。每次团队需要将更改同步到 SVN 时，DBML 都会发生更改，从而产生大量冲突。这似乎与 dbml 编辑器中的一些重新排列有关，因为如果您在编辑器中打开 dbml 文件，.dmbl.layout 中的大多数 associationConnector 部分似乎在开发过程中发生了变化。

您是否有任何最佳实践来避免这些可能需要一个多小时才能轻松修复的布局重新排列？

最好的问候，古斯塔沃

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T14:43:07.163

如果只是 .layout 被更改，那么我实际上会忽略该请求，因为链接所有内容的 GUID 仍然匹配。它们只是不会在我设置它们的同一个地方，这是我可以忍受的。如果 .dbml 也发生了变化，那么我会接受两者而不合并。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-04T22:27:44.387

如果你愿意使用 KDiff3，那么你可以配置一个预处理器命令在合并之前对 dbml 文件进行排序。我在我的博客[http://blog.trumpi.co.za/the-one-tip-that-i-wish-i-knew-years-ago-that-merges-easier/](http://blog.trumpi.co.za/the-one-tip-that-i-wish-i-knew-years-ago-that-merges-easier/)上发布了指南。这些说明是针对 git 的，但我知道 TortoiseSVN 可以以类似的方式配置，以将 dbml 合并路由到 KDiff3。

# bash - 强制 base_profile 运行

> ID：630533
> 
> 赞同：1
> 
> 时间：2009-03-10T14:40:05.017
> 
> 标签：bash, solaris

当我登录太阳盒时： SunOS domain.com 5.8 Generic_117350-57 sun4u sparc SUNW,Sun-Fire-V240

我从 sh shell 开始： SHELL=/bin/sh

我输入 bash 来启动一个 bash shell，然后必须输入 . .bash_profile 加载我的个人资料。有没有办法可以设置自动加载配置文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:43:37.240

放

. ~/.bash_profile

在 ~/.bashrc 中（注意无限循环！）。我自己不使用它，因为我在 .bashrc 中拥有大多数东西（除了，嗯，环境。东西等等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T14:44:12.950

`.bash_profile`仅用于登录 shell，对于非登录 shell（如您的），bash 使用`.bashrc`.

最简单的事情是添加`. .bash_profile`到您的`.bashrc`.

您还必须确保不在非交互式 shell 中打印出任何内容，或者您​​可以破坏 scp/sftp。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T14:45:30.683

像这样运行*bash*会导致它获取源*/etc/bash.bashrc*然后*~/.bashrc*代替*.bash_profile*（和其他文件）。因此，放入`. ~/.bash_profile`~ */.bashrc*，（或*/etc/bash.bashrc*为所有用户执行此操作）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T14:47:30.100

该文件`.bash_profile`在登录时运行。该文件`.bashrc`在从非登录会话运行 bash 时运行。

尝试将此添加到您的`.bashrc`：

```
source ~/.bash_profile 
```

# jquery - 使用 jquery 禁用/启用整个表单的提交

> ID：630535
> 
> 赞同：6
> 
> 时间：2009-03-10T14:40:28.853
> 
> 标签：jquery, validation

当我的表单未通过验证时，我想禁用表单的提交功能。我可以通过禁用提交按钮来做到这一点，但这会使回车键处于未选中状态。
我可以设置 .submit(return false); 但后来我无法重新启用它。

有什么建议么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-29T03:12:14.300

只是 Pim 的简化版（编辑以提取 James 的贡献）：

```
 $('#form').submit(formValidated); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-14T18:55:31.450

我做了以下工作（禁用提交按钮和表单提交）：

```
var condition = true; //check whatever you like
if(condition)
    $('input[type=submit]', this).attr('disabled', 'disabled');
    $('form').bind('submit',function(e){e.preventDefault();});
}else{
    $('input[type=submit]', this).removeAttr('disabled', 'disabled');
    $('form').unbind('submit');
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-10T14:43:23.590

如何在提交方法中进行检查：

```
$('#form').submit (function() {
 if(formValidated())
  return true;
 return false;
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-11T18:09:28.913

只是尼克**原始**答案的简化：

```
$('#form').submit(formValidated); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T22:30:15.090

这是另一种可能的解决方案：

```
$('#form').change(function() {
    (isValid($('#form')) ? $('#submitBtn').attr('disabled',false) : $('#submitBtn').attr('disabled',true)
}); 
```

当然，`isValid()`检查您的所有`$('#form')`元素是否符合您的验证规则。我就是这样做的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T14:43:07.583

而不是直接调用提交函数调用中间函数并在那里进行检查。

IE

```
var isSubmitable = false;

function submitForm() {
   if(isSubmitable) {
       myform.submit();
   }
} 
```

# restful-authentication - 设计 web api：如何进行身份验证？

> ID：630538
> 
> 赞同：5
> 
> 时间：2009-03-10T14:41:15.840
> 
> 标签：restful-authentication, http-authentication

我正在设计一个 web api。我需要让用户进行身份验证。我有点犹豫是否让用户以明文形式传递他们的用户名/密码..类似于：api.mysite.com/auth.php?user=x&pass=y

我读到的另一个选项是对用户名/密码进行 Base64 编码，然后发送 HTTP 请求。那么这是否意味着在服务器端；我会 _GET['user'] 和 _GET['password'] 然后以某种方式解码它们？

这就是 twitter 所做的：[http](http://apiwiki.twitter.com/REST+API+Documentation#Authentication) ://apiwiki.twitter.com/REST+API+Documentation#Authentication吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-10T14:46:58.370

Base64 根本没有保护作用。使用 SSL 实现真正的安全性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-10T14:53:19.103

正如 truppo 所说，首先使用 SSL。

许多 Web 服务所做的是有一个“身份验证”服务，它返回一个稍后使用的令牌，并且可以以明文形式使用，因为它仅在有限的时间内有效。当它过期时，客户端只需进行另一个身份验证。

这样做的主要好处是它减少了 SSL 请求的数量，从而减轻了服务器的负载。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-10T14:52:42.133

就在本周，IETF 发布了一份[新草案](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-security-properties-03)，讨论了 HTTP 中各种身份验证机制的安全属性。您应该在那里找到有用的信息。

就个人而言，我建议至少阅读[摘要身份验证](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-security-properties-03#section-2.2.2)并分析它是否适合您。

使用 SSL 也可能是一种选择。但是，它也以牺牲性能、可缓存性等为代价解决了其他问题。它使有效载荷数据保密。如果这是一个要求，那么这就是你要走的路。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T14:48:21.690

如果这是一个网络服务，您最好使用更安全的身份验证形式。例如，查看 LiveJournal 协议：[Challenge-Response](http://www.livejournal.com/doc/server/ljp.csp.auth.challresp.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T15:16:49.780

请不要对 api 使用常规的用户名/密码身份验证。人们真的不应该被迫将来自外国服务的凭据放入混搭服务中。

请考虑使用 oauth [http://oauth.net/](http://oauth.net/)或至少一些基于挑战-响应的系统，就像 Eugene 建议的那样。

一种简单的方法是让访客服务生成一个连接到他的应用程序和用户的令牌。如果你投入一些工作，你甚至可以使令牌创建安全，只允许具有一些私钥/公钥机制的外部服务。

用户必须先在您的应用程序中授权此令牌，然后访客服务才能使用它进行身份验证。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-26T14:40:39.493

我发现这篇[文章](http://broadcast.oreilly.com/2009/12/principles-for-standardized-rest-authentication.html)令人大开眼界。

简而言之：每个用户使用一对 API 密钥。一种用于客户端身份验证，一种用于参数签名。

# asp.net - 在javascript中设置资源字符串

> ID：630544
> 
> 赞同：8
> 
> 时间：2009-03-10T14:41:43.720
> 
> 标签：asp.net, javascript, .net-3.5, resources

如何在javascript中设置资源字符串？

我有一个资源文件，例如，

```
myResourceFile.resx 
```

在我的代码中并使用我可以使用的文字控件：

```
lblName.Text = Resources.myResourceFile.ajaxRetrievingInformation;

<asp:Literal id="lit" runat="server" 
             Text="<%$ Resources:myResourceFile, ajaxRetrievingInformation%>" /> 
```

但是如果我在javascript中尝试这个，比如：

```
<asp:Button ID="btnImportCompaniesAndEmployees" 
            runat="server" 
            CssClass="myButtonCssClass"
            OnClick="btnImportCompaniesAndEmployees_Click"
            OnClientClick="strLoadingText='<%$ Resources:myResourceFile, ajaxRetrievingInformation%>';return true;"
            ...
/> 
```

或者

```
<script type="text/javascript">
    var strLoadingText = '<%$ Resources:myResourceFile, ajaxRetrievingInformation%>';
</script> 
```

我收到错误...

有谁知道如何管理这个？ **像**：

```
var strLoadingText = Resources.GetString(myResourceFile, ajaxRetrievingInformation); 
```

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-10T14:50:59.033

您应该能够使用：

```
<script type="text/javascript">
    var strLoadingText = "<%= Resources.myResourceFile.ajaxRetrievingInformation %>";
</script> 
```

# linq - 有没有更好的方法来编码这个 LINQ 片段？

> ID：630545
> 
> 赞同：1
> 
> 时间：2009-03-10T14:41:49.087
> 
> 标签：linq, .net-3.5

我有这段代码：

```
SmsDataClassesDataContext dc = new SmsDataClassesDataContext();

        // Get the customer
        Customer currentCustomer = dc.Customers.Single( c => c.Hash1 == forThisHash );

        // Get from Name (LINQ to XML) 
        var q = from c in thisSmsPack.Descendants("from")
                select c;

        string from = q.First().Value;

        foreach ( XElement element in thisSmsPack.Descendants("to") )
        {
            // Create the queue
            SmsQueue sq = new SmsQueue();
            sq.CustomerId = currentCustomer.CustomerId;
            sq.MsgFrom = from;

            sq.MsgTo = element.Attribute("name").Value;
            sq.MsgPhone = element.Attribute("phone").Value;
            sq.MsgBody = element.Attribute("msg").Value;
            sq.Priority = currentCustomer.SendsSmsAtPriority;
            sq.DontSendUntil = GetNextSendDate();

             // sq.TimeCreated = System.DateTime.Now;

            currentCustomer.SmsQueues.Add(sq);
        }
        dc.SubmitChanges(); 
```

我正在创建“SmsQueues”的新实例，填充值，当 foreach 循环完成时，我提交更改。鉴于 .NET 3.5 具有新的 lambda/linq/anonymous 类型，是否有更“现代”的方式来完成上述任务？

作为一个可能相关的附带问题，我可以在 linq 表达式的选择部分返回由不同列组成的现有类型吗？

假设您有三个表：

T1 == T1.Id, T1.Name

T2 == T2.Id, T2.Phone

T3 == T3.Name, T3.Phone, T3.SomethingElse

我可以执行返回的 LINQ 查询：

T1.Name、T2.Phone、SomethingElseNew

并让 .NET 知道它属于 T3 类型（并且它是它的新实例）？这样当我提交更改时，新的 T3 实例会插入数据库中吗？

我不知道我是否说清楚了：S

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T14:50:46.020

我没有可用的系统来测试它，但我认为这（或非常接近的东西）应该可以工作。

```
CustomerId = currentCustomer.CustomerId;
var sqrange = from element in thisSmsPack.Descendants("to") )
              select new SmsQueue
              {
             // Create the queue
                MsgFrom = from,
                MsgTo = element.Attribute("name").Value,
                MsgPhone = element.Attribute("phone").Value,
                MsgBody = element.Attribute("msg").Value,
                Priority = currentCustomer.SendsSmsAtPriority,
                DontSendUntil = GetNextSendDate()
             // TimeCreated = System.DateTime.Now
            };
    currentCustomer.SmsQueues.AddRange(sqrange); 
```

编辑：修复了许多语法错误（如评论中所述）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T14:51:45.597

你可以做这样的事情（语法可能略有偏差，这里没有智能）：

```
var q = T1.Join(T2, t => t.Id, t2 => t2.Id)
    select new T3{Name=t.Name,Phone=t2.Phone,SomethingElseNew="Chickens"}; 
```

# asp.net - 站点地图行为

> ID：630548
> 
> 赞同：0
> 
> 时间：2009-03-10T14:42:15.653
> 
> 标签：asp.net, sitemap

我仔细阅读了大量的 MS 文档，只是为了找到一个树状视图，就像使用站点地图的结构一样。我想没有人知道如何为站点地图导航提供类似文件夹的结构？以如下结构为例

```
Home
   About
      Me.aspx
      MyFamily.aspx
      MyPets.aspx
   Contact
      Telephone.aspx
      Email.aspx
 Disclaimer.aspx 
```

“关于”和“联系方式”将是文件夹，但站点地图永远不会在单个页面上分层。所以，我的根页面会有两个菜单项，一个是“主页”，它就像一个文件夹，可以深入了解关于和联系人菜单，另一个是免责声明页面的链接。我希望能够单击主页，它将重新加载带有“关于”和“联系”链接的菜单，并完全隐藏“主页”和“免责声明”。

```
Home >
Disclaimer 
```

然后点击主页，你会得到

```
About >
Contact > 
```

然后当点击关于你会得到

```
Me
My Family
My Pets 
```

每个菜单都会有一个“向上”菜单来返回一个文件夹。

我看不出有一个简单的解决方案，但目前我们使用静态 html 页面，这些页面位于我们 Web 应用程序的不同文件夹中。正如您可以想象的那样，这是需要改变的。

有任何想法吗？

**编辑**

我不得不想出一个 VB.NET 解决方案

```
<script runat="server">
  Private Function GetSecondaryNavItems() As String
    Dim sRet As String = ""

    Dim oCurrNode As System.Web.SiteMapNode = Nothing
    Dim oCurrParentNode As System.Web.SiteMapNode = Nothing

    'Dim sCurrPage As String = GetURL(Request.ServerVariables("SCRIPT_NAME").ToLower())
    Dim sCurrPage As String = GetURL(HttpContext.Current.Request.ServerVariables("SCRIPT_NAME").ToLower())
    oCurrNode = GetCurrentNode(sCurrPage, SiteMap.RootNode)

    If Not oCurrNode Is Nothing Then
      oCurrParentNode = oCurrNode.ParentNode
    End If

    If Not oCurrParentNode Is Nothing Then
      If Not oCurrParentNode Is SiteMap.RootNode Then
        sRet += "Parent Folder Link"

        If Not oCurrNode Is Nothing Then
          For Each oChild As SiteMapNode In oCurrParentNode.ChildNodes
            sRet += "Link for child"
          Next
        End If
      End If
    End If

    Return sRet
  End Function

  Private Function GetURL(ByVal fullURL As String) As String
    Return fullURL.Substring(fullURL.LastIndexOf("/"))
  End Function

  Private Function GetCurrentNode(ByVal _sCurrentPageURL As String, ByVal _oNode As SiteMapNode) As SiteMapNode
    Dim oNodeRet As SiteMapNode = Nothing

    For Each oNodeCheck As SiteMapNode In _oNode.ChildNodes
      If oNodeCheck.HasChildNodes = True Then
        oNodeRet = GetCurrentNode(_sCurrentPageURL, oNodeCheck)
      End If

      If oNodeRet Is Nothing Then
        Exit For
      End If

      Dim sURL As String = oNodeCheck.Url.ToLower()
      Dim iPos As Integer = sURL.IndexOf("?")

      If iPos > 0 Then
        sURL = sURL.Substring(0, iPos)
      End If

      iPos = sURL.LastIndexOf("/")

      If iPos > 0 Then
        sURL = sURL.Substring(iPos)
      End If

      If sURL = _sCurrentPageURL Then
        oNodeRet = oNodeCheck
        Exit For
      End If
    Next

    Return oNodeRet
  End Function
</script> 
```

这是直接在母版页文件中的（临时的，我稍后会放在模型后面的代码中）。

然后我在身体里得到了这个

```
<div id="sidebar">
  <%= GetSecondaryNavItems() %>
</div> 
```

再次，暂时只是为了测试。它实际上并没有输出任何东西，但是我认为我的 GetURL 定义不正确。我假设它只是获取实际文件？不过我可能错了:)

**编辑编辑**：出于某种原因，我没有得到任何输出，所以我认为这是我的站点地图。我需要调试它，但我现在正在远程处理，所以它很慢；）

```
<?xml version="1.0" encoding="utf-8" ?>
<siteMap xmlns="http://schemas.microsoft.com/AspNet/SiteMap-File-1.0" >
  <siteMapNode url="Accounts/Default.aspx" title="Accounts"  description="Accounts">
    <siteMapNode url="Accounts/Test.aspx" title="Client Balances" description="Client Balances">
      <siteMapNode url="Hello.aspx" title="Hello"  description="rarar" />
      <siteMapNode url="Hiya.aspx" title="Hiya"  description="rarar" />
    </siteMapNode>
    <siteMapNode url="Test.aspx" title="Test"  description="rarar" />
  </siteMapNode>
</siteMap> 
```

这是示例站点地图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T16:36:04.753

您仍然可以使用 Sitemap.sitemap 文件来控制您的导航，但您不会使用 asp.net 中的任何内置控件来实现此目的。我刚刚在我刚刚完成的网站上做了几乎这件事。

使您的所有页面都从基页面类继承（或使用母版页，无论哪种方式，您都只有一份代码副本。）

在每个页面上创建一个 div 或 span，命名为适当的名称（divNav 或 spnNav 或其他）。

在您的基本页面中，在页面加载时，遍历所有站点地图节点以查找当前页面的节点。这需要是一个递归调用。

```
 // Pass the current page url, all the way through the .aspx.  In other words, do NOT pass any kind of 
    // query string.
    private SiteMapNode GetCurrentNode(string _sCurrentPageURL, SiteMapNode _oNode)
    {
        SiteMapNode oNodeRet = null;

        foreach (SiteMapNode oNodeCheck in _oNode.ChildNodes)
        {
            if (oNodeCheck.HasChildNodes == true)
            {
                oNodeRet = GetCurrentNode(_sCurrentPageURL, oNodeCheck);
            }

            if (oNodeRet != null)
                break;

            string sUrl = oNodeCheck.Url.ToLower();
            int iPos = sUrl.IndexOf("?");
            if (iPos > 0)
                sUrl = sUrl.Substring(0, iPos);
            iPos = sUrl.LastIndexOf("/");
            if (iPos > 0)
                sUrl = sUrl.Substring(iPos);

            if (sUrl == _sCurrentPageURL)
            {
                oNodeRet = oNodeCheck;
                break;
            }
        }
        return oNodeRet;
    } 
```

获得当前节点后，获取其父节点。

添加一个链接（您称之为“返回文件夹的向上菜单”）。

然后做一个 foreach(SiteMapNode in parent.ChildNodes)

为每个孩子添加一个链接。

因此，我们在每次页面加载时调用的主要调用是这样的：

```
 public string GetSecondaryNavItems()
    {
        string sRet = "";

        // Get the node that matches most of this url...
        System.Web.SiteMapNode oCurrNode = null;
        System.Web.SiteMapNode oCurrParentNode = null;

        string sCurrPage = GetURL(Request.ServerVariables["SCRIPT_NAME"].ToLower());

        oCurrNode = GetCurrentNode(sCurrPage, SiteMap.RootNode);

        if(oCurrNode != null)
            oCurrParentNode = oCurrNode.ParentNode;

        if(oCurrParentNode != null)
              if(oCurrParentNode != SiteMap.RootNode)
                  sRet += "Parent Folder link";

            if(oCurrNode != null)
            {
            foreach (System.Web.SiteMapNode oChild in oCurrParentNode.ChildNodes)
            {
                    sRet += "Link for child";
              }
        }
    } 
```

我必须告诉你，上面的代码部分是我复制的，部分是我写的。但这应该给你一个好的开始，我想。

编辑：很抱歉！这是 GetURL 过程...

```
 public string GetURL(string _sURL)
    {
        string sRet = _sURL;

        int iPos = sRet.IndexOf("?");
        if (iPos > 0)
            sRet = sRet.Substring(0, iPos);
        iPos = sRet.LastIndexOf("/");
        if (iPos > 0)
            sRet = sRet.Substring(iPos);

        return sRet;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T09:42:21.640

虽然我不应该回应，但实际上我会对此提出进一步的要求。是否可以做完全相同的事情，但使用由简单`<ul>`和`<li>`元素组成的页面？我问的原因是因为我们的“站点地图”实际上在安全性和功能方面都更先进一些。我们运行的菜单实际上具有带有输入框的动态下拉列表，这是在站点地图中无法复制的。

所以，这个想法是做完全相同的事情，除了

```
<ul>
   <li>
      <ul>
         <li></li>
      </ul>
   </li>
   <li></li>
   <li></li>
</ul> 
```

而是结构。根节点上必须有一个 runat="server" ，这样您也许可以遍历所有子元素？这样我就可以在我的`<li>`和`</li>`元素中放置任何东西。

我们的安全性也很零星，站点地图也没有我们正在寻找的那种精细控制。

# sql - SQL日期选择

> ID：630564
> 
> 赞同：3
> 
> 时间：2009-03-10T14:45:24.897
> 
> 标签：sql, mysql, date

我希望能够选择月份和年份与我正在搜索的相同的所有数据库行。由于 DATE 字段有年、月和日，我如何搜索年和月？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-10T14:47:21.303

```
SELECT * 
FROM tblTableName 
WHERE Month(ColumnDate) = Month(MyDate) 
    AND Year(ColumnDate) = Year(MyDate) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T14:48:10.753

```
SELECT *
FROM myTable
WHERE ( YEAR(myfield) = '2009')
  AND ( MONTH(myfield) = '1') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-10T15:06:46.950

最有效的是创建所需范围的开始日期和结束日期，以便将日期作为单个值进行比较，而不是从每个日期中提取年份和月份属性。

例子：

```
select SomeField
from SomeTable
where SomeDate >= ? and SomeDate < ? 
```

（请注意，第一个比较是包含性的，第二个是排除性的。）

创建开始日期和结束日期以用作参数：（C# 中的示例）

```
DateTime start = new DateTime(date.Year, date.Month, 1)
DateTIme end = start.AddMonths(1); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T15:02:54.743

在**MySQL**中：

```
SELECT *
FROM   mytable
WHERE  date >= STR_TO_DATE(CONCAT(EXTRACT(YEAR_MONTH FROM @mydate), '01'), '%Y%m%d')
   AND date < STR_TO_DATE(CONCAT(EXTRACT(YEAR_MONTH FROM @mydate), '01'), '%Y%m%d') + INTERVAL 1 MONTH 
```

这将有效地使用`date`字段上的索引。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T14:49:51.017

这取决于您使用的数据库后端。在 SQL Server 中我会使用

```
where year(datefield) = @year and month (datefield) - @month 
```

去做这个。

或者您可以通过创建日期范围来构建 where 子句

其中 20090101 和 20090201 之间的日期字段

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T14:48:04.560

您将希望在 mysql中使用[MONTH()](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_month)和[YEAR() 。](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_year)

# c# - 将 System.DirectoryServices.AccountManagement.PrincipalContext.ValidateCredentials 与 SAM 一起使用时出现奇怪的错误

> ID：630566
> 
> 赞同：4
> 
> 时间：2009-03-10T14:45:45.643
> 
> 标签：c#, .net-3.5

我正在使用 IIS 6.0 托管 WCF Web 服务。我的应用程序池在本地管理员帐户下运行，并且我定义了其他本地用户来访问 Web 服务。我编写了以下代码来验证用户：

```
 //Any public static (Shared in Visual Basic) members of this type are thread safe
public static PrincipalContext vpc;

//static initializer
static UserManagement()
{
    vpc = new PrincipalContext(ContextType.Machine);
}

//Determines whether the given credentials are for a valid Administrator
public static bool validateAdminCredentials(string username, string password)
{
    using (PrincipalContext principalContext = new PrincipalContext(ContextType.Machine))
    {
        if (vpc.ValidateCredentials(username, password))
        {
            using (UserPrincipal user = UserPrincipal.FindByIdentity(principalContext, IdentityType.SamAccountName, username))
            {
                foreach (GroupPrincipal gp in user.GetGroups())
                {
                    try
                    {
                        if (gp.Name.Equals("Administrators"))
                        {
                            return true;
                        }
                    }
                    finally
                    {
                        gp.Dispose();
                    }
                }
            }
        }

        return false;
    } //end using PrincipalContext
} 
```

...在另一个班级：

```
 //verify the user's password
if (!UserManagement.vpc.ValidateCredentials(username, password))
{
    string errorMsg = string.Format("Invalid credentials received for user '{0}'", username);
    throw new Exception(errorMsg);
} 
```

（注意：我使用公共静态 PrincipalContext (vpc) 仅用于调用 ValidateCredentials 方法；我创建了一个不同的临时 PrincipalContext 来创建、删除和查找用户和组，因为我在尝试使用时遇到了各种与 COM 相关的错误所有事物的全局 PrincipalContext ）。

所以，大多数时候，这段代码运行得非常好。但是，间歇性地，我收到以下错误：

不允许同一用户使用多个用户名与服务器或共享资源建立多个连接。断开与服务器或共享资源的所有先前连接，然后重试。（来自 HRESULT 的异常：0x800704C3）

应用程序：System.DirectoryServices.AccountManagement

堆栈跟踪：在 System.DirectoryServices.AccountManagement.CredentialValidator.Validate(String userName, String password) 在 System.DirectoryServices.AccountManagement.PrincipalContext.ValidateCredentials 的 System.DirectoryServices.AccountManagement.CredentialValidator.BindSam(String target, String userName, String password) （字符串用户名，字符串密码）在 MyNamespace.User..ctor（字符串用户名，字符串密码）

一旦发生错误，我会继续得到它，直到我重新启动我的整个服务器（不仅仅是 IIS）。我尝试重新启动我的应用程序池和/或 IIS，但直到我重新启动机器后错误才会消失。我还尝试为每次调用 ValidateCredentials （我不应该这样做）实例化（通过 using 块）一个新的 PrincipalContext，但我最终仍然得到相同的错误。根据我在 System.DirectoryServices.AccountManagement （msdn docs，articles）上阅读的内容，我相信我使用它是正确的，但是这个错误正在削弱我的应用程序！我需要（并且应该能够）从来自多个客户端的 Web 服务请求中验证本地用户凭据。难道我做错了什么？任何有关解决此问题的帮助将不胜感激...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-01T13:47:53.150

1.  “**这种类型的任何公共静态（在 Visual Basic 中共享）成员都是线程安全的**”这个样板文本让很多人感到困惑。这意味着该类型*公开的*任何静态成员都是线程安全的。这并不意味着*存储在静态成员*中的类型的任何实例都是线程安全的。

2.  您的*validateAdminCredentials*方法会创建一个新的*PrincipalContext*对象，然后继续使用静态*vpc*实例来验证凭据。由于您对静态实例的访问没有锁定，并且实例方法不是线程安全的，因此您最终会得到两个线程试图同时访问同一个实例，这是行不通的。

尝试删除*vpc*字段并使用*principalContext*实例来验证凭据。您需要在每次调用时创建和处置*PrincipalContext 。*

此外，您可以使用*IsMemberOf*方法测试组中的成员资格，而不是手动迭代用户的组。

```
public static bool ValidateCredentials(string username, string password)
{
    using (PrincipalContext principalContext = new PrincipalContext(ContextType.Machine))
    {
        return principalContext.ValidateCredentials(username, password);
    }
}

public static bool validateAdminCredentials(string username, string password)
{
    using (PrincipalContext principalContext = new PrincipalContext(ContextType.Machine))
    {
        if (principalContext.ValidateCredentials(username, password))
        {
            using (UserPrincipal user = UserPrincipal.FindByIdentity(principalContext, IdentityType.SamAccountName, username))
            using (GroupPrincipal group = GroupPrincipal.FindByIdentity(principalContext, IdentityType.SamAccountName, "Administrators"))
            {
                if (null != group && user.IsMemberOf(group))
                {
                    return true;
                }
            }
        }

        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-14T13:46:10.390

我的建议是不要将 ValidateCredentials 与 SAM 提供程序一起使用。我相信它应该可以工作，但我对它遇到问题也不感到惊讶。我认为通过使用网络登录类型对 LogonUser 进行 ap/invoke 以进行编程凭据验证，您会做得更好。

我想看看微软是否有一个已知问题和解决这个问题的方法，但同时我建议只是围绕它进行编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-10T12:20:47.693

我通过使用域上下文解决了同样的问题。可以使用机器上下文委托给域，但看起来您最终将被迫遇到这个问题。

请注意，您应该为每个调用创建新的域上下文，因为它必须使用您要验证的用户的域来创建。

我的应用程序也需要支持机器用户。我发现只要用户是机器用户，域上下文就会抛出异常。如果我捕捉到异常，我会针对机器上下文工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-20T17:26:14.307

如果您需要一个解决方案，即使使用 Windows 2000 并且没有运行代码作为系统，您也可以使用它：

```
public static bool ValidateUser(
    string userName, 
    string domain, 
    string password)
{
    var tcpListener = new TcpListener(IPAddress.Loopback, 0);
    tcpListener.Start();

    var isLoggedOn = false;
    tcpListener.BeginAcceptTcpClient(
        delegate(IAsyncResult asyncResult)
        {
            using (var serverSide = 
                new NegotiateStream(
                     tcpListener.EndAcceptTcpClient(
                        asyncResult).GetStream()))
            {
                try
                {
                serverSide.AuthenticateAsServer(
                    CredentialCache.DefaultNetworkCredentials,
                    ProtectionLevel.None, 
                    TokenImpersonationLevel.Impersonation);
                var id = (WindowsIdentity)serverSide.RemoteIdentity;
                isLoggedOn = id != null;
                }
                catch (InvalidCredentialException) { }
            }
        }, null);

    var ipEndpoint = (IPEndPoint) tcpListener.LocalEndpoint;
    using (var clientSide = 
        new NegotiateStream(
            new TcpClient(
                ipEndpoint.Address.ToString(),
                ipEndpoint.Port).GetStream()))
    {
        try
        {
            clientSide.AuthenticateAsClient(
                new NetworkCredential(
                    userName,
                    password,
                    domain),
                "",
                ProtectionLevel.None,
                TokenImpersonationLevel.Impersonation);
        }
        catch(InvalidCredentialException){}
    }
    tcpListener.Stop();
    return isLoggedOn;
} 
```

# php - UrlRedirect - IIS6 - PHP -> .NET

> ID：630567
> 
> 赞同：0
> 
> 时间：2009-03-10T14:45:45.817
> 
> 标签：php, asp.net, windows, iis-6, windows-server-2003

我希望将现有的 WordPress 安装移动到由基于 .net 的博客以及在 IIS6/Win2k3 下运行的站点上的其他新功能/模块组成的自定义平台。现有 WordPress 站点中有数千个帖子已迁移到新的数据库结构，但是，我想保留旧的 url（为了搜索引擎）。

该应用程序已经在使用 URLRewriting.NET 在整个站点中提供 SEO 友好的链接，所以我知道我可以编写一个规则来解析/重定向入站请求：

[http://mydomain.com/index.php/2008/11/20/my-post/](http://mydomain.com/index.php/2008/11/20/my-post/)

将由以下内容处理： [http ://mydomain.com/blog.aspx?slug=my-post&date=2008-11-20](http://mydomain.com/blog.aspx?slug=my-post&date=2008-11-20)

为此，我需要将 .php 扩展名配置为由 aspnet_isapi.dll 处理。是否可以将一个“网站”配置为通过 aspnet 处理 PHP，而将另一个“网站”配置为使用实际的 php isapi 处理程序处理 PHP？根据通过 IIS 管理器进行的配置，这似乎是可能的，尽管我怀疑整个“Web 服务扩展”位会导致问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:49:30.330

是的，可以根据站点更改处理程序。

# c# - 如何以编程方式检索 html 重定向网页？

> ID：630575
> 
> 赞同：2
> 
> 时间：2009-03-10T14:47:29.103
> 
> 标签：c#, httpwebrequest

我已经完成了这段代码来登录、检索和显示网页：

```
 // login info array
        string postData = "user_name=tler";
        postData += "&user_password=lodvader";
        byte[] data = Encoding.ASCII.GetBytes(postData);

        // web request
        WebRequest req = WebRequest.Create("http://www.lol.com/login.php");
        req.Method = "POST";
        req.ContentType = "application/x-www-form-urlencoded";
        req.ContentLength = data.Length;

        // stream response to string
        Stream newStream = req.GetRequestStream();
        newStream.Write(data, 0, data.Length);
        newStream.Close();
        StreamReader reader = new StreamReader(req.GetResponse().GetResponseStream(), Encoding.GetEncoding("iso-8859-1"));

        string responseString = reader.ReadToEnd();

        // retrieve text within title
        Regex rx = new Regex(@"(?<=<title>).+?(?=</title>)");

        var variable = rx.Matches(responseString);

        // output
        Console.WriteLine(variable[0]);

        Console.ReadLine(); 
```

但是，登录后的以下页面是一个 html 重定向，例如：

```
<meta http-equiv="refresh" content="3; URL="bb.php"> 
```

如何点击此链接并检索下一页？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:53:11.053

只需向 bb.php 文件发送一个新的 WebRequest。确保您使用相同的 CookieContainer，因为我认为 login.php 使用基于 cookie 的会话来记住您。查看[HttpWebRequest.CookieContainer](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.cookiecontainer.aspx)属性。这需要您将 WebRequest 转换为 HttpWebRequest。

补充：（无法在评论中编写示例代码。）

我现在只是在不打样的情况下编写代码......

```
var cookies = new CookieContainer(); 

var firstReq = (HttpWebRequest)WebRequest.Create(".../login.php");
firstReq.CookieContainer = cookies;

var secondReq = (HttpWebRequest)WebRequest.Create(".../bb.php");
secondReq.CookieContainer = cookies 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-22T16:53:47.857

我已经找到时间来完成它，这里是回复（我试图尽可能清楚）：

```
 // Cookie for our session
        var cookieContainer = new CookieContainer();

        // Encode post variables
        ASCIIEncoding encoding=new ASCIIEncoding();
        byte[] loginDataBytes = encoding.GetBytes("user_name=belaz&user_password=123");

        // Prepare our login HttpWebRequest
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://blabla.fr/verify.php");
        request.Method = "POST";
        request.ContentType = "application/x-www-form-urlencoded";
        request.CookieContainer = cookieContainer;
        request.ContentLength = loginDataBytes.Length;

        // Write encoded post variable to the stream
        Stream newStream = request.GetRequestStream();
        newStream.Write(loginDataBytes, 0, loginDataBytes.Length);
        newStream.Close();

        // Retrieve HttpWebResponse
        HttpWebResponse response = (HttpWebResponse)request.GetResponse();

        // Link the response cookie to the domain
        cookieContainer.Add(new Uri("http://blabla.fr/"),response.Cookies);

        // Prepare our navigate HttpWebRequest, and set his cookie.
        HttpWebRequest requestProfile = (HttpWebRequest)WebRequest.Create("http://blabla.fr/bb.php");
        requestProfile.CookieContainer = cookieContainer;

        // Retrieve HttpWebResponse
        HttpWebResponse responseProfile = (HttpWebResponse)requestProfile.GetResponse();

        // Retrieve stream response and read it to end
        Stream st = responseProfile.GetResponseStream();
        StreamReader sr = new StreamReader(st);
        string buffer = sr.ReadToEnd(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T14:56:49.127

HttpWebRequest 有一个名为**AllowAutoRedirects**的属性。将此设置为真。还有一个名为**MaximumAutomaticRedirections**的属性。将其设置为某个允许的值，以确保遵循所有这些值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T14:58:24.630

您不能轻松地做到这一点，因为元标记由客户端读取并执行。

在这种情况下，当您使用 HttpWebRequest 时，请求并不关心文本可能具有的功能。

因此，您需要在 URL 属性 (bb.php) 中对页面进行另一次请求。

-

如果服务器做了重定向，你就不会有问题。

# sql - SQL Server - 有选择地将字段插入临时表

> ID：630584
> 
> 赞同：2
> 
> 时间：2009-03-10T14:48:50.050
> 
> 标签：sql, sql-server

我正在一个 SP 中执行一个 SP。SP 返回说 10 个参数。我只对其中的 5 个感兴趣。如何仅将这 5 个插入临时表中。

我到目前为止的代码：

```
 DECLARE @tmpUnion TABLE
  (
    UnionCode VARCHAR(10),
    UnionDate DATETIME,
    UnionPosition VARCHAR(30),
    UnionInitFees BIT,
    UnionDues BIT
  )

  --getDetails returns 10 params. I need only these 5
  INSERT INTO @tmpUnion
  (UnionCode, UnionDate, UnionPosition, UnionInitFees, UnionDues)
  EXEC getDetails
        @iUserId = @OriginalLoginId 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:51:03.900

将 getDetails 的结果放入包含所有返回值的 tablevar 中，然后从附加表中插入。

您还可以[查看此站点](http://www.sommarskog.se/share_data.html)以获取有关如何在存储过程之间共享数据的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T14:52:04.740

像这样使用 OPENROWSET：

```
Select 
       *
from OPENROWSET('SQLOLEDB','Data Source=Server_name;Trusted_Connection=yes;
      Integrated Security=SSPI','Execute yourdb..get_orders') 
```

现在您可以轻松过滤结果集

```
Select 
employeeid,orderid,orderdate 
from 

OPENROWSET('SQLOLEDB','Data Source=Server_name;Trusted_Connection=yes;
       Integrated Security=SSPI','Execute yourdb..get_orders')

where
       orderdate>='19960101' and orderdate<'19970101' 
```

您不需要创建临时表，也不需要担心过程的结构。

[在这里找到](http://sqlblogcasts.com/blogs/madhivanan/archive/2007/11/26/select-columns-from-exec-procedure-name-is-this-possible.aspx)

编辑：最终解决方案从讨论后的评论中移出。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-10T14:50:55.350

你不能。表变量必须与返回的 waht 的结构完全匹配。

# xml - 如何让远程对象在 E4X 中返回 XML？

> ID：630591
> 
> 赞同：2
> 
> 时间：2009-03-10T14:50:42.963
> 
> 标签：xml, apache-flex, blazeds, e4x, remoteobject

我正在编写一个充分利用 BlazeDS 到 Java 服务器的 Flex 应用程序。我经常使用远程对象，但我遇到过一个实例，接收 XML 比返回对象更干净、更快。

通过 BlazeDS 返回 XML 非常简单。我在 Java 上使用 Dom4j 构建 XML，并通过 BlazeDS 服务返回根元素。BlazeDS 为我将 Dom4j 对象转换为 XML。

在 Flex 端接收这个对象时，都是 ObjectProxy 对象而不是 XML。我之前在 HttpService 调用中看到过这个问题，为了解决这个问题，我将 resultFormat 更改为 E4X。

但是，我无法在 RemoteObject 服务调用上设置 resultFormat。

无论如何我可以将这些 ObjectProxies 转换为 E4X 格式的 XML 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T17:58:09.170

此外，如果您将 XML 作为字符串或某种正式的 XML 类型返回，那么您可以在 Flex 的客户端将其转换为 XML 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T13:22:24.403

要回答您的问题：

> 对于远程服务，您经常使用 AMFChannel。AMFChannel 通过 HTTP 使用二进制 AMF 编码。如果不允许二进制数据，那么您可以使用 HTTPChannel，它是基于 HTTP 的 AMFX（XML 中的 AMF）。

和

[http://livedocs.adobe.com/blazeds/1/javadoc/flex/messaging/io/amfx/package-summary.html](http://livedocs.adobe.com/blazeds/1/javadoc/flex/messaging/io/amfx/package-summary.html)

RemoteObject 的数据格式是二进制 AMF，因此如果您想使用 XML，也许您应该使用 WebService 或 HTTPService 类（AMF 会更快；如果使用 XML，可能会失去速度 - 不确定 AMFX）。

LiveCycle 似乎也有类似的序列化器：

[http://livedocs.adobe.com/livecycle/8.2/programLC/programmer/javadoc/flex/messaging/io/amfx/package-detail.html](http://livedocs.adobe.com/livecycle/8.2/programLC/programmer/javadoc/flex/messaging/io/amfx/package-detail.html)

希望一些混乱的帮助。

# c# - System.IO.StreamWrite and Spanish Characters

> ID：630605
> 
> 赞同：0
> 
> 时间：2009-03-10T14:52:16.517
> 
> 标签：c#, text, encoding, character-encoding

I need to write the following string to a txt a File:

SEGS,AUS1,1,0,0,712205,584,8659094,2,NUÑEZ FELIX ARTURO,584

I when I use:

```
using  (System.IO.StreamWriter sw = new System.IO.StreamWriter(@fileSobrantes, true)) {
       sw.WriteLine("SEGS,AUS1,1,0,0,712205,584,8659094,2,NUÑEZ   FELIX ARTURO,584");
} 
```

I get this in the file

SEGS,AUS1,1,0,0,712205,584,8659094,2,NUÃ‘EZ FELIX ARTURO,584

I try with the Encoding parameters in ASCII, UNICODE and ALL UTF and does not work.

```
System.IO.StreamWriter(@fileSobrantes, true,Encoding.UTF32 )) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:57:14.120

You can't easily (and accurately) represent what you get in the file without giving a hex dump. What are you trying to use to read the file? My guess is that if you try `Encoding.Default` that will work for you, but it's hard to say for sure without knowing what you're trying to use to read it.

The other alternative is that your *source* string is incorrect. If you've really got it as a string literal in your source code, are you sure you've got Visual Studio set up to interpret it correctly?

See my [unicode debugging page](http://pobox.com/~skeet/csharp/debuggingunicode.html) for suggested techniques.

EDIT: By the way, why are you prefixing `fileSobrantes` with `@`? For identifiers you only need to do that if they're keywords. You may be getting confused with verbatim string literals - but this isn't a string literal, it's a variable name.

# c# - 如何向 Infragistics UltraGrid 控件动态添加新波段？

> ID：630607
> 
> 赞同：1
> 
> 时间：2009-03-10T14:52:52.430
> 
> 标签：c#, infragistics, ultrawingrid

我需要在 Winforms UltraGrid 控件上表示分层数据。数据包含在分配给 BindingSource 控件的 BindingList 对象中。集合中包含的对象有一个“Children”属性，它是另一个包含这些对象的 BindingList。由于我们的数据量很大，我只用第一级项目填充网格。到目前为止，一切都很好。然后我想在用户每次点击它时获取一行的子项。我该怎么做？我曾尝试在 MouseUp 事件上这样做，但看起来不太好。此外，应该同时检索和显示子对象，此时我必须单击几次才能使它们显示出来。

非常感谢。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-12-07T13:50:20.807

首先，你不能添加乐队。您可以将子项添加到 Children 集合中，并且会自动创建乐队。

这是名为**BeforeRowExpanded**的特殊事件。当用户点击展开指示器时触发。您可以将数据加载代码放在那里。

查看*SamplesExplorer*解决方案中的 frmAccessView.cs。它在 Infragistics 的 Samples 包中可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T15:24:51.867

我不知道您使用的是哪个版本的 UltraGrid，但请尝试[BeforeCellActivate](http://help.infragistics.com/Help/NetAdvantage/NET/2008.2/CLR2.0/html/Infragistics2.Win.UltraWinGrid.v8.2~Infragistics.Win.UltraWinGrid.UltraGrid~BeforeCellActivate_EV.html)或[BeforeRowActivate](http://help.infragistics.com/Help/NetAdvantage/NET/2008.2/CLR2.0/html/Infragistics2.Win.UltraWinGrid.v8.2~Infragistics.Win.UltraWinGrid.UltraGrid~BeforeCellActivate_EV.html)事件。

# php - PHP：无效字符中断 html

> ID：630612
> 
> 赞同：0
> 
> 时间：2009-03-10T14:53:24.267
> 
> 标签：php, character-encoding

我应该如何清理包含无效字符的字符串，并且在 textarea 中打印后会破坏 html？

PHP`ord()`为所述字符返回0，但我怀疑它不是空的，我认为这并不重要。

当字符串显示在 textarea 中时，无效字符之后的所有文本以及 textarea 之后的所有 html 元素都会消失。

我尝试使用`htmlentities`, `htmlspecialchars`, `mb_convert_encoding`, `iconv('UTF-8', 'UTF-8//IGNORE', $str)`，但它们都不起作用。

`filter_var()`在我们使用的 5.1.2 中还没有引入。

echo 和 var_dump 将字符打印为 </p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:56:46.693

试试`filter_var($string, FILTER_SANITIZE_STRING, FILTER_FLAG_STRIP_LOW)`。

**编辑：**由于 5.1.2 没有 filter_var，你可以试试这个（这几乎是一样的）：

```
preg_replace('/\p{Cc}/u', '', $string); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T16:26:22.000

当 htmlentities, htmlspecialchars, mb_convert_encoding, iconv('UTF-8', 'UTF-8//IGNORE', $str) 不起作用之前，我使用过这个正则表达式。它去掉了控制字符

```
$str = preg_replace( '/[\x00-\x08\x0B-\x0C\x0E-\x1F\x7F-\x9F]/', '', $str ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T22:08:57.050

可能：

```
$str = trim($str, chr(0)); 
```

??

# session - Web 应用程序中的会话超时

> ID：630625
> 
> 赞同：1
> 
> 时间：2009-03-10T14:55:31.890
> 
> 标签：session, timeout

Web 应用程序中的会话超时通常表示空闲时间——即用户不使用应用程序的时间段。

现在，如果编写了一个每 5 分钟发布一次请求的自动脚本会怎样——该用户的会话不会无休止地进行吗？既然如此，从长远来看，这种方法不会给应用程序带来沉重的负担，影响其性能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T15:05:38.437

运行对服务器的自动调用，比如通过 AJAX 请求，*将使*会话保持活动状态。通常这就是重点。这样做的一个有趣的副作用是，如果请求可预测且有规律地发生，您可以将其用作“ping”来确定用户的浏览器是否仍处于打开状态。如果错过一两个 ping，您可以提前关闭会话并实际释放资源，而不是让会话超时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T16:43:07.937

您希望会话尽可能小。也就是说，如果每个人都开始这样做，它当然会加载您的应用程序，并带有（out）会话。如果您认为您的用户被迫这样做，请考虑原因，因为您的应用程序缺少重要功能或强迫他们做某事。

现在，不管怎样，如果您希望有很多用户同时处于活动状态，那么比单个服务器不会做的多得多，那么您最终会导致会话退出进程。如果会话在 Sql Server 中，它只是保存的数据，所以在这种情况下我们不会讨论内存使用情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T15:06:20.993

是的，是的。

这就是为什么如果你要为 web 编写一个应用程序，你真的想找到一种方法来实现它而不使用服务器端会话。通常，您将能够找到使用 cookie 实现相同功能的方法——然后会话数据是客户端的，所以谁在乎它们是否永久保持活动状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T15:43:53.930

我为严重依赖会话数据的应用程序做了类似的事情。

我所做的是将 IIS 超时设置为相对较低的数字，例如 10 分钟，然后进行定时 AJAX 调用，每 5 分钟 ping 一个空白页。

这种开销实际上相当低，因为您所做的只是请求一个空白页面，如果有人关闭他们的浏览器，会话将在 10 分钟内结束。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T15:05:19.933

嗯......我猜“这取决于”你应该问自己的第一个问题是你是否需要会话。

如果你有一个自动化的过程，我猜你真的不需要使用 session.

在这种情况下，要么关闭它，要么不用担心。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T15:06:20.697

我猜你的会话表会大一点，但另一方面你不会拆除并重新创建会话。我看不出这将如何“大量加载”应用程序。我想这取决于应用程序本身以及用于维护会话状态的内存量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T15:31:44.753

只要他们打开浏览器，它就会允许用户的会话无休止地进行。如果需要长时间保持会话活动，您还可以通过数据库而不是内存来跟踪会话。

此外，如果您担心无限期的打开会话，您可以从会话打开时开始实施超时，如果有延长的空闲时间。

# javascript - RJS：检查现有的页面元素？

> ID：630637
> 
> 赞同：3
> 
> 时间：2009-03-10T14:57:41.277
> 
> 标签：javascript, ruby-on-rails, prototype, rjs

我有一个 id 为“foo”的文本字段，有时存在，有时不存在。如果存在，我想填写某个值。

你如何通过使用**RJS**（在*Rails 2.2*中）来做到这一点？

我试过这个，但它不起作用：

```
if page[:foo]
  page[:foo].value = "bar"
end 
```

我明白了

> TypeError：如果文本字段不存在，则为空值

.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-10T21:15:27.470

我已经多次提出这个问题，我有一个条件项，如果它存在就需要对其采取行动。使用 page.select 可以避免 Null Value 错误。

```
 page.select('#dom_object_id').each do |element|
    element.value = "bar"
  end 
```

我把它放在我的 *.js.rjs 文件中。当 select 向 each 发送一个空数组时，它不返回任何内容，而不是当页面上没有具有正确 ID 的 DOM 对象时直接按 id 选择时得到的 TypeError。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T15:06:02.693

我认为您不能从 RJS 获得。作为一种解决方法，您可以简单地从 RJS 调用一个 javascript 方法来检查元素是否存在。

```
page << "update_foo('#{my_value}');" 
```

Javascript ..

```
function update_foo(val)
{
  if( $('foo') != undefined )
  {
    $('foo').value = 'bar';
  } 
} 
```

编辑

修复了红宝石部分..

# xml - XmlValidatingReader 类已过时

> ID：630641
> 
> 赞同：11
> 
> 时间：2009-03-10T14:58:03.400
> 
> 标签：xml, xsd

我正在使用 XmlValidatingReader 对象针对 xsd 架构验证我的对象，但此类在 .NET 2.0 中已过时。有没有人有正确的代码来使用新的 Vaildation 类。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-10T15:01:19.460

是的：

```
XmlReaderSettings settings = new XmlReaderSettings();

settings.ValidationType = ValidationType.Schema;
settings.Schemas.Add ( .... );
settings.ValidationEventHandler += delegate( object sender, ValidationEventArgs e )
{
    Console.WriteLine("invalid: " + e.Message);
};

XmlReader reader = XmlReader.Create (new XmlTextReader(file), settings); 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-03-10T15:02:12.517

检查 XmlValidatingReader 的 MSDN 文档，您将在 [ObsoleteAttribute] 属性中看到：

“使用由 XmlReader.Create() 方法创建的 XmlReader，而是使用适当的 XmlReaderSettings。http: [//go.microsoft.com/fwlink/](http://go.microsoft.com/fwlink/?linkid=14202) ?linkid=14202 ”

# tomcat - 如何为欢迎文件列表中引用的 zip 文件设置内容处置标头？

> ID：630642
> 
> 赞同：0
> 
> 时间：2009-03-10T14:58:05.503
> 
> 标签：tomcat, web-applications, war, web.xml

我想创建一个仅包含 Web 应用程序中包含的单个 zip 文件的 WAR，将该战争部署到 JBoss 并能够通过访问 WAR 的根目录来下载 zip 文件。

所以，目前我有一场战争，里面有 zipfile，还有这个 web.xml：

```
<!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN" "http://java.sun.com/dtd/web-app_2_3.dtd">
<web-app>
    <display-name>Zipfile</display-name>
    <welcome-file-list>
        <welcome-file>file.zip</welcome-file>
    </welcome-file-list>
</web-app> 
```

这场战争有效，我可以下载文件，但我的浏览器不知道文件的名称。那么我在哪里以及如何将该文件的内容处置标头定义为“附件；文件名=文件.zip”？

我知道如何创建一个执行此操作的 servlet，但我可以在没有 servlet 的情况下过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T15:07:24.267

以下方法可以解决问题吗？创建 index.jsp 作为欢迎文件，其中包含将浏览器重定向到 file.zip 的脚本。

# database-design - 重复数据设计

> ID：630649
> 
> 赞同：3
> 
> 时间：2009-03-10T14:59:01.680
> 
> 标签：database-design

我正在设计一个产品数据库，我有一个设计问题。

有几种不同类别的产品，例如书籍、视频游戏、家用电子产品和宠物用品。有一些共同点，比如制造商和价格，而其他一些东西对于每个类别来说都是独一无二的，比如功耗。

个别产品会定期更新，价格可能会波动，而制造商将保持相当稳定（我想制造商可能被另一家公司收购，品牌名称被收购公司吸收）。更新可能每小时发生一次。可以频繁地对每个产品提出请求（取决于客户的数量，因此是无限的）。

我更关心客户端访问数据的速度，而不是我对数据执行更新的速度。

哪个更有意义，为什么？

*   所有类别的一张表，其列允许为空（例如，宠物用品的功耗为空）
*   每个类别都有一个表，列重复（例如价格将在每个表中）
*   一张表用于共同特征（价格、制造商等），一张表用于独特属性

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T15:09:56.210

退后一步，把你的头从数据库中拉出来。你将如何在你的应用程序中解决这个问题？通常，您将使用继承。超类将定义公共属性，而子类将定义特殊特征。

所以你的问题可以改写为：如何在数据库中实现继承？

首先，尽量避免数据重复。如果您在交易（或代码）中犯了一个简单的错误，数据可能会变得不一致，没有人会知道哪个价格是正确的。

一张大桌子可能不是一个好的解决方案，因为您最终会想要添加一个新功能。这会导致数据库中越来越多的空间浪费。另外，您要么必须为每个类构建查询，要么从数据库中检索大量 NULL。

这导致了多表方法。公共基类映射到为实例提供 ID 的中央表。所有子类都使用较小的特殊表，这些表具有从基类填充的 ID 列。

加载数据时，将一个类的所有表连接在一起，一次性加载所有数据（使用所有表中的 ID）。这是非常有效的，因为数据查找会通过唯一的主键并且简单的 ID=ID 连接不会花费太多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T15:02:49.987

我会说一张表用于共同特征，另一张表具有独特的属性。

您可以模拟装饰器模式之类的东西，其中额外的属性只是与产品关联的标签。

您可能需要标签分组，以便更轻松地添加新产品。

使用上述配置，您可能会发现使用新标签进行扩展以及随着分类的变化添加/删除标签会更容易。

* * *

我可以看到其他方法存在以下问题。

如果所有内容都在一个表中，则您必须预先了解所有内容并在想到新字段时不断更改表并将许多字段保留为 NULL。

使用每个类别的表，您最终不得不为每种类型的产品创建许多不同的查询，并且向前推进，它可能难以维护。

# linux - 初学者 bash 脚本上的错误

> ID：630650
> 
> 赞同：0
> 
> 时间：2009-03-10T14:59:02.553
> 
> 标签：linux, bash, cygwin

你能帮帮我吗？我在 cygwin 上以 ./test.sh 运行它，我在第 51 行意外结束文件。有什么想法吗？

提前谢谢

最后编辑：最终版本'在 CygWin 上运行，问题在于换行符，CrLf 而不是 Lf。

```
#!/bin/sh
##################################################
## USAGE
##################################################
if [ $# -ne 1 ]; then
    echo "1>Use Extractor: $0 <MODO DE OPERACAO>"
    echo "2>Use Extractor: $0 <MODO DE OPERACAO> <DATA INICIAL> <DATA FINAL>"
    exit 127
else
    if [ $1 -lt 0 ]; then
        if [ $1 -gt 1 ]; then
            echo "2>Use Extractor: $0 <MODO DE OPERACAO> <DATA INICIAL> <DATA FINAL>"
            exit 127
        fi
    fi
fi
##################################################
## VARS
##################################################

    ##########################################
    ## AUX
    ##########################################
    set java_cmd=""
    set java_cmd_emergencial=""
    set java_cp=""

    ##########################################
    ## JAR
    ##########################################
    set db_user=""
    set db_pwd=""
    set conn_string=""
    set work_dir=""
    set output_dir=""

##################################################
## PARAMETROS
##################################################
set mode=$1
set data_ini=""
set data_fim=""
if [ $# -eq 3 ]; then
    set data_ini    = $2
    set data_fim    = $3
fi

##################################################
## CHAMADA DO JAR
##################################################
java  "$java_cp" "$java_cmd" "$mode" "$db_user" "$db_pwd" "$conn_string" "$work_dir" "$output_dir" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T15:01:17.820

“set”不是 bash 语法。而不是“set foo = bar”，你想要“foo = bar”。

注意：出于某种原因，我写了没有空格的更正表格。*必须*这样写。您更新的问题仍然是错误的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T15:01:57.633

在 MacOS X 10.5.6 上为我运行没有错误，除了这一行：

```
if [ $1 -lt 0 -o gt 1 ]; 
```

应该

```
if [ $1 -lt 0 -o $1 -gt 1 ]; 
```

我不评论脚本的其余部分是否真的做了它应该做的......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T15:12:02.570

您可能希望在最后一行引用必填字段。现在它将是一个空白而不是“”。

例如

```
java  "$java_cp" "$java_cmd" "$mode" "$db_user" "$db_pwd" "$conn_string" "$work_dir" "$output_dir" 
```

编辑为至少在 mysystem 上运行 java：

```
#################################################
#!/bin/sh
##################################################
## USAGE
##################################################
if [ $# -ne 1 ]; then
    echo "1>Use Extractor: $0 <MODO DE OPERACAO>;"
    echo "2>Use Extractor: $0 <MODO DE OPERACAO> <DATA INICIAL> <DATA FINAL>"
    exit 127
else
    if [ $1 -lt 0 -o $1 -gt 1 ]; then
        echo "1>O Parametro <MODO DE OPERACAO> deve ser 0 (Cartorios) ou 1 (Transacoes);"
        exit 127
    fi
fi
##################################################
## VARS
##################################################

    ##########################################
    ## AUX
    ##########################################
    java_cmd=""
    java_cmd_emergencial=""
    java_cp=""

    ##########################################
    ## JAR
    ##########################################
    db_user=""
    db_pwd=""
    conn_string=""
    work_dir=""
    output_dir=""

##################################################
## PARAMETROS
##################################################
mode=$1
data_ini=""
data_fim=""
if [ $# -eq 3 ]; then
    data_ini=$2
    data_fim=$3
fi

##################################################
## CHAMADA DO JAR
##################################################
java  $java_cp $java_cmd $mode $db_user $db_pwd $conn_string $work_dir $output_dir 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T15:15:00.427

如果没有别的，请仔细检查脚本最后一行的末尾是否有换行符。

# .net - XML C# 快速查找节点的方法

> ID：630652
> 
> 赞同：4
> 
> 时间：2009-03-10T14:59:29.917
> 
> 标签：.net, xml

您好我是 XML 和 .NET 的新手。我想知道如何解析以下文件。我希望能够根据我将提供的 ID 获取 XmlNode。例子：

```
<Data>
<Question id="1">
<Answer>ddd</Answer>
</Question>
</Data> 
```

我想以某种方式做到这一点：

```
XmlDocument myDoc = new XmlDocument();
XmlElement myElem = myDoc.GetElementById("1");
Response.Write("Answer: "+myElem.ChildNodes[0].InnerXML); 
```

这应该给我输出：“答案：ddd”。

任何帮助都非常感谢，谢谢。

我也不想使用 LINQ，因为我想先掌握 .NET 的 XML 组件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T15:06:15.143

无需编译即可目测：

XmlNode node = myDoc.SelectSingleNode("Data/Question[@id='1']/Answer"); Response.Write("答案：" + node.InnerText);

当然，如果您想要一些变量，将 1 更改为参数将是理想的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T15:05:11.587

伪代码：myDoc.selectSingleNode("//Question[@id=whatever]")

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T15:10:24.180

在 LINQ 之前，我会使用 SelectSingleNode 和 XPath 查询。在上面的示例中，XPath 类似于`"//Question[@id=1]/Answer"`. 现在，我将使用 LINQ，因为至少据我所知，您不必使用 XmlDocument 对象来节省开销。通过使用 XElement 并使用 LINQ to XML 扩展方法来查询它以查找所需的节点，您可以用一两行代码完成整个事情，并且它会执行得一样好或更好。

这是 LINQ 中使用您的 xml 片段的一个示例，它甚至不需要实例化对象即可使用 xml：

```
string xml = "<Data><Question id=\"1\"><Answer>ddd</Answer></Question></Data>";
string answer = XElement.Parse(xml).Descendants("Question").
    Where(node => node.Attribute("id").Value == "1").
    Descendants("Answer").ElementAt(0).Value; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T15:03:31.343

.Net 的 XML 组件是一团糟。请不要受制于它，只需使用 LINQ to XML。综上所述，它更容易使用并且运行速度更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T15:15:55.040

我认为那些指向 Linq 并远离 XML 组件的人是正确的。您可能想学习或使用 XPath 以实现非 .Net 兼容性，如果您愿意，Linq 允许您这样做。XML 组件使用起来并不有趣。

# passwords - 用户密码更改后如何使 schtasks 工作？

> ID：630670
> 
> 赞同：2
> 
> 时间：2009-03-10T15:02:32.687
> 
> 标签：passwords, scheduling, windows-task-scheduler

在 Windows 机器上，[schtasks](http://support.microsoft.com/kb/308569)是一个类似于 cron 的实用程序，用于安排定期运行的作业。

问题是，当您定义一个 schtask 时，您必须指定帐户的用户 ID*和*密码才能运行该作业。

然后，当用户更改密码时，该 schtask 将不再工作。必须将其删除并使用*新*密码重新安排。

那么，如何设置不受密码更改影响的计划作业（通过 schtasks、at 等）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T15:31:09.857

这并不能*完全*回答您的问题，但一种常见的解决方法是创建一个用户（具有适当的权限）并将该帐户仅用于执行计划任务。

由于用户帐户是使用不会过期的密码创建的，因此创建它的系统管理员应该选择一个适当的强密码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T22:11:37.470

还有一种方法可以更新现有任务。在 cmd 提示符下，您将使用以下内容来帮助您：

```
schtasks /change /tn TaskName [/s computer [/u [domain\]user /p password]] [/tr TaskRun] [/ru [Domain\]User | "System"] [/rp Password] 
```

[http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/schtasks.mspx?mfr=true](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/schtasks.mspx?mfr=true)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-28T19:58:31.653

只需将其添加到您的命令中：

```
/RU "NT AUTHORITY\SYSTEM" /RP * 
```

将作为系统运行并忽略密码。

# sharepoint - 如何更改 SharePoint WSS 网站中的页面布局

> ID：630676
> 
> 赞同：0
> 
> 时间：2009-03-10T15:03:08.643
> 
> 标签：sharepoint, layout, wss

在 SharePoint WSS（不是 MOSS）中，如何更改现有页面的页面布局？

一切顺利

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T10:47:23.743

在页面编辑栏上，从页面菜单项中选择页面设置。从那里，您可以像创建页面时一样选择使用的页面布局。您的所有数据（文本、网络部件等）仍应保留在原位。

如果新的页面布局没有相应的区域，则不确定 Web 部件会发生什么，所以要小心。

**更新 WSS 特定细节**

WSS 不支持页面布局（它们在 MOSS 中被称为），因为它们是作为 MOSS 中 Web 发布功能的一部分安装的。

WSS 页面从C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\TEMPLATE\1033\STS\DOCTEMP\SMARTPGS 中定义的 aspx 页面*模板实例化。*

这些基于站点母版页，并且（有效地）是标准的 aspx 页面。您无法更改所使用的模板 - 该页面一旦创建就存在于网站上。

您可以在文件系统上修改页面，只要页面没有幻影，所有使用该模板的页面都会更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T18:14:14.537

Sharepoint 设计器是编辑页面布局或创建新布局的最佳方式。如果这就是您的意思，这也是创建/编辑母版页的最佳方式。

请注意，在 SharePoint 设计器中，您还可以从页面布局中“分离”发布页面，以便您可以更改其布局，而不会影响使用该页面布局的所有页面。

但是，如果您想将它们打包以便跨系统部署，那么您正在考虑需要 Visual Studio - 或者对 NotePad 非常有信心！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T10:29:57.840

您始终可以使用[SharePoint 设计](http://office.microsoft.com/en-us/sharepointdesigner/FX100487631033.aspx)器来更改现有的 Aspx 页面。

您到底想在页面中更改什么？

# ruby - 删除子按钮单击上的插槽

> ID：630681
> 
> 赞同：0
> 
> 时间：2009-03-10T15:04:39.450
> 
> 标签：ruby, shoes

我一直在尝试从子按钮单击中删除一个插槽，但我似乎无法让它工作。例如

```
flow do
  button("X") {parent.remove}
end 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T00:03:01.233

鞋垫有时很[棘手](http://help.shoooes.net/Rules.html)。这里的关键是问自己，调用的父方法是什么？ `self`， 当然。并且自我引用应用程序（或窗口或对话框），而不是按钮。

有两种类似的方法可以解决这个问题。首先，您可以创建对要在块中使用的按钮的引用：

```
flow do
  a = button("X") {a.parent.remove}
end 
```

或者，您可以只引用插槽本身：

```
b = flow do
  button("X") {b.remove}
end 
```

# c# - .aspx 页面 Response.BinaryWrite IE7 上的图像

> ID：630682
> 
> 赞同：2
> 
> 时间：2009-03-10T15:04:43.447
> 
> 标签：c#, .net, image, internet-explorer-7

我维护一个应用程序，该应用程序有一个 .aspx 页面，该页面从数据库加载图像并使用 Response.BinaryWrite() 将其写回客户端。这在不久前非常有效。有两件事发生了变化，我们将应用程序升级到 .NET 3.5，他们将工作中的所有计算机升级到 IE7。

在 Firefox 上一切正常，但我在 IE7 中得到的只是一个红色 X。所以我认为这个问题与 IE7 有关？是否有安全设置可以阻止它从 .aspx 表单加载图像？它已经设置为基于内容类型而不是扩展名显示。

这是一些代码。就像我说的，我只是维护这个应用程序并没有编写它。我知道使用 Session 不是一个很好的方法，但这是我所拥有的，switch 语句只是一个“wtf？”。

```
<asp:image id="imgContent" runat="server" Visible="true" ImageUrl="ProductContentFormImage.aspx"></asp:image>

    protected void Page_Load(object sender, System.EventArgs e)
    {
        Hashtable hshContentBinary = (Hashtable)Session["hshContentBinary"];
        byte[] content = (byte[]) hshContentBinary["content"];
        string extension = (string) hshContentBinary["extension"];

        string contentTypePrefix = "application";
        switch(extension.ToLower())
        {
            case "gif":
            case "jpg":
            case "bmp":
                contentTypePrefix = "image";
                break;
            case "tif":
                contentTypePrefix = "image";
                break;
            case "tiff":
                contentTypePrefix = "image";
                break;
            case "eps":
                contentTypePrefix = "image";
                break;
            default:
                Response.AppendHeader( 
                    "Content-disposition",
                    "attachment; filename=content." + extension );
                break;
        }
        Response.ContentType = contentTypePrefix + "/" + extension;
        Response.BinaryWrite(content);
    } 
```

编辑：

好的，我遵循了您的建议，并通过更多研究将方法更改为以下方法，但仍然无法正常工作。

```
protected void Page_Load(object sender, System.EventArgs e)
{
    Hashtable hshContentBinary = (Hashtable)Session["hshContentBinary"];
    byte[] content = (byte[]) hshContentBinary["content"];
    string extension = (string) hshContentBinary["extension"];
    string contentType;
    string contentDisposition = "inline; filename=content." + extension;

    Response.ClearContent();
    Response.ClearHeaders();
    Response.Clear();

    switch(extension.ToLower())
    {
        case "gif":
            contentType = "image/gif";
            break;
        case "jpg":
        case "jpe":
        case "jpeg":
            contentType = "image/jpeg";
            break;
        case "bmp":
            contentType = "image/bmp";
            break;
        case "tif":
        case "tiff":
            contentType = "image/tiff";
            break;
        case "eps":
            contentType = "application/postscript";
            break;
        default:
            contentDisposition = "attachment; filename=content." + extension;
            contentType = "application/" + extension.ToLower();
            break;
    }

    Response.Buffer = true;
    Response.Expires = 0;
    Response.ContentType = contentType;
    Response.AddHeader("Content-Length", content.Length.ToString());
    Response.AddHeader("Content-disposition", contentDisposition);
    Response.Cache.SetCacheability(HttpCacheability.NoCache);
    Response.BinaryWrite(content);
    Response.End();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T15:23:08.270

您的 mime 类型不正确。这效果更好，至少对于图像：

```
string contentType = "application/" + extension.ToLower();
switch(extension.ToLower()) {
   case "gif": contentType = "image/gif"; break;
   case "jpg":
   case "jpeg":
   case "jpe": contentType = "image/jpeg"; break;
   case "bmp": contentType = "image/bmp"; break;
   case "tif":
   case "tiff": contentType = "image/tiff"; break;
   case "eps": contentType = "application/postscript"; break;
   default:
      Response.AppendHeader( 
         "Content-disposition",
         "attachment; filename=content." + extension );
      break;
}
Response.ContentType = contentType; 
```

Hera 是 mime 类型和文件扩展名，如果您需要添加更多： [http ://www.w3schools.com/media/media_mimeref.asp](http://www.w3schools.com/media/media_mimeref.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T15:25:57.700

我可以告诉你，这种图像加载方式在 IE7 中运行良好（前段时间刚刚编写了相同的排序代码）。因此，可能存在以下问题：1）尝试在设置 ContentyType 之前执行 Response.Clear() 并在最后执行 response.end。2) 确保会话中的扩展名没有句点 (.)，即 .gifs 应为 gif，.jpg 应为 jpg 等。

小号

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T16:01:13.643

考虑使用一些缓存设置您的页面，包括客户端缓存控制标头。执行此操作时，请确保为每个单独的图像设置不同的文件名

```
contentDisposition = String.Format("attachment; filename=content{0).{1}",fileName, fileExtension); 
```

和客户端缓存头

```
context.Response.Cache.SetMaxAge(TimeSpan.FromSeconds(YourDatabaseImageOrConfigFile.CacheSeconds));
context.Response.Cache.SetOmitVaryStar(true);
context.Response.Cache.SetLastModified(YourDatabaseImage.ModifiedDate); 
```

我也会将此页面制作成 ASHX http 处理程序，以摆脱页面生命周期的开销。

我把这整件事写了几次，如果需要可以提供代码。此图像端点位于每秒处理大约 80 个请求的站点上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T15:09:53.370

你可以试试...

```
Response.ClearContent();
Response.ClearHeaders(); 
```

...就在之前...

```
Response.ContentType = contentTypePrefix + "/" + extension; 
```

我们必须这样做才能在 IE7 中获得正确的文件类型关联。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T15:17:20.047

尝试将您的内容处置设置为内联而不是附件，例如：

```
Response.AppendHeader( 
   "Content-disposition",
   "inline; filename=content." + extension ); 
```

虽然大多数浏览器在这方面都非常灵活，但“附件”旨在要求用户采取进一步行动。[IETF RFC 1806](http://www.ietf.org/rfc/rfc1806.txt)：

> 附件的显示通常被解释为要求接收方采取积极行动，而当查看消息时会自动显示内联消息组件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T15:25:54.347

为自己获取一份[Fiddler](http://www.fiddlertool.com/fiddler/)副本，以便查看对图像 URL 的响应。

如果可能，请将 ASPX 改为 ASHX。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T04:43:56.067

尝试在 IE7 中访问另一个网站。
它是否显示任何其他网站的图像？

如果它不显示图像，我猜您可能有一些设置（例如 Web 开发人员工具栏或提琴手）“不加载图像”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-11T05:02:28.300

你的代码很复杂，为什么不简化一下，让你只设置内容类型？

这是我使用的代码，它适用于所有浏览器。

```
protected void Page_Load(object sender, EventArgs e)
{
  byte[] jpg = .....

  Response.Clear();
  Response.ContentType = "image/jpeg";
  Response.BinaryWrite(jpg);
  Response.End();
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-06T20:30:47.893

图像以 IE7 无法显示的方式损坏，但 Firefox 可以。图像很大，不适合屏幕，我没有看到它被切断的地方。

感谢您的所有建议。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-08T14:24:47.683

我不是 100% 确定 IE7，但是我遇到了与 ie8 类似的问题。我的问题的解决方案是确保我涵盖了“image/pjpeg”的内容类型。不确定您需要多少种不同的覆盖范围，但这一个解决了我的问题。

# c# - 处理多个连接的 System.IO.IOException

> ID：630683
> 
> 赞同：1
> 
> 时间：2009-03-10T15:04:49.980
> 
> 标签：c#, events, error-handling

我想创建一个应用程序来远程监控多台服务器的事件日志，一切都很好，但是服务器可能会不时离线。

当我连接到远程事件日志并且与机器的连接丢失时抛出 System.IO.IOException，我想通过再次连接到远程服务器来处理错误，但由于 EventLog 类没有连接方法我将不得不创建一个新的 EventLog 实例并找出哪个 EventLog 实例引发了异常。

处理这种情况的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T15:37:17.640

您可以从引发异常的 EventLog 实例中获取日志名称和机器名称，然后使用这些详细信息重新初始化该失败实例。

至于存储 EventLog 实例，请使用 List<> 或 Dictionary<>，这将允许您枚举当前正在监视的所有 EventLog。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T15:18:45.940

您可以创建一个 ManagedEventLog 类，在其中存储 eventlog 连接和一个 id，如果连接丢失并且抛出异常，您可以查看哪个 id 属于该连接，并可以在 ManagedEventLog 类上调用 reconnect 方法。

# flash - 如何设置 flash 对象以在新窗口中打开 url？

> ID：630709
> 
> 赞同：2
> 
> 时间：2009-03-10T15:09:30.843
> 
> 标签：flash, url, object, window, new-operator

我有这个代码：

```
<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" width="300" height="250">
  <param name="movie" value="Spotify_premium_300x250.swf" />
  <param name="quality" value="high" />
  <embed src="Spotify_premium_300x250.swf" quality="high" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" width="300" height="250"></embed>
</object> 
```

**编辑：汤姆的代码**

```
<object onclick="javascript: window.open('http://www.stackoverflow.com', _blank, 'width=1024, height=600, menubar=no, resizable=yes');" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" width="300" height="250">
  <param name="movie" value="Spotify_premium_300x250.swf" />
  <param name="quality" value="high" />
  <embed src="Spotify_premium_300x250.swf" quality="high" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" width="300" height="250"></embed>
</object> 
```

我希望当用户单击 Flash 对象时，它会在新窗口中打开一个 URL。我该怎么做呢？

干杯，基思

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T16:12:27.777

您可以在 Flash 对象上放置一个 DIV 以捕获鼠标点击。为此，您需要将 flash 对象的 wmode 设置为不透明，并使用一些 javascript 来定位 div。这是一个完整的例子：

```
<html>
<head>
<script type="text/javascript" src="swfobject.js"></script>
<script type="text/javascript" src="jquery-1.3.2.min.js"></script>
<script type="text/javascript">
    var flashvars = {};
    var params = {
        menu: "false",
        scale: "noScale",
        wMode: "opaque"
    };
    swfobject.embedSWF("MyFlashApp.swf", "swf", "300", "300", "9.0.0",
                       "expressInstall.swf", flashvars, params);

    $(function() {
        var swf = $("#swf");
        $("body").append(
            $("<div onclick=\"window.open('http://www.google.com');\"></div>").
                css({
                    position: 'absolute',
                    top: swf.offset().top,
                    left: swf.offset().left,
                    width: swf.attr('width'),
                    height: swf.attr('height'),
                    zIndex: 1
                })
        );
    });
</script>
</head>
<body>
<div id="swf"></div>
</body>
</html> 
```

注意使用`swf.attr('width')`代替`swf.width()`，后者返回 0，可能是因为现在获取 Flash 对象的尺寸还为时过早。稍后，当手动调用时，它确实返回了正确的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T15:22:34.417

这取决于（不是总是这样吗？）。

如果您希望 flash 对象始终打开同一个站点，您可以为对象标签创建一个点击事件并让它运行一个 JavaScript 弹出窗口：

```
javascript: window.open('http://www.stackoverflow.com', _blank, 'width=1024, 
                        height=600, menubar=no, resizable=yes'); 
```

打开另一个站点。

如果您希望 FLASH 电影打开一个链接，根据您点击的内容，您需要`GoToURL`在 flash 中添加一个动作。您需要告诉该操作在新窗口中打开。

像`GoToURL('www.yahoo.com', true)`where true 是指在新窗口中打开。

但是，由于我没有打开 flash，我的语法可能已关闭。

希望这足以让您入门。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T15:23:00.640

您需要使用 ActionScript 在 Flash 中执行此操作

```
btnMovieClip.onRelease = function(){
    getURL("http://www.yoururl.com");
}; 
```

制作一个填充整个场景的 MovieClip，并将其命名为 btnMovieClip。将上面的代码放在时间轴的一个框架中。

# .net - 使用 MSTest 时模拟对象

> ID：630712
> 
> 赞同：4
> 
> 时间：2009-03-10T15:10:02.573
> 
> 标签：.net, unit-testing, mstest

我刚刚开始使用 MSTest（或者至少是 VS 2008 测试工具，有区别吗？）

我想测试使用会话对象的代码。显然我没有 HttpContext，我不能简单地创建一个，因此代码失败并出现 NullReferenceException。

这段代码是否根本无法测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T15:47:26.527

我不知道您正在尝试测试哪种类型的 Web 项目（MVC 或 WebForms），但您应该能够[使用 Scott Hanselmans 模拟助手模拟 HttpContextBase 类，该助手在](http://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx)[Rhino.Mocks](http://ayende.com/projects/rhino-mocks.aspx)和[Moq](http://code.google.com/p/moq/)中有示例，两者都是免费的.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T15:20:10.507

我不知道不可测试，但肯定很难测试。你可以使用 typemock，它可以创建几乎所有东西的模拟和存根。但它不是免费的。

您还可以尝试将会话内容的调用包装在一个单独的对象中，并将其隐藏在接口后面。然后你可以将该接口注入到你的代码中。对于您的测试，您可以注入一个模拟实现。这将实现两件事，您的代码更容易测试，并且您不再依赖于 Asp.Net 中的会话实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T15:39:43.597

会话对象在您要测试的逻辑中的参与程度如何？例如，如果它只是 asp.net 使用的一个值，您可以实现一种[表示模式](http://codebetter.com/blogs/jeremy.miller/archive/2007/06/10/build-your-own-cab-part-8-model-view-presenter-wrapup.aspx)来抽象它（并使编写测试变得容易）

例如——下面的逻辑很容易通过将会话信息推送到视图实现来测试

```
If UserObject.IsActive() Then
  _View.SessionActive = True
Else
  _View.SessionActive = False
End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-20T20:06:13.287

在 VS 2010 中，[Microsoft Moles](http://research.microsoft.com/en-us/projects/moles/)是一个模拟选项。

在 VS 2012 中，[Microsoft Fakes](http://msdn.microsoft.com/en-us/library/hh549175%28v=vs.110%29.aspx)是一种模拟选项。

# svn - 如何将多个分支类型的目录导入 git-svn，它们不是同一个父级的独占子级？

> ID：630723
> 
> 赞同：1
> 
> 时间：2009-03-10T15:12:40.773
> 
> 标签：svn, git, git-svn

抱歉，标题太长了，但我想弄清楚这个问题和[CaptainPicard 提出的问题之间的区别](https://stackoverflow.com/questions/258590/how-do-i-import-svn-branches-rooted-in-different-directories-into-git-using-git-s)

我有一个像这样的svn结构：

*   树干/
*   分支/*
*   标签/*
*   发布候选/*

出于所有意图和目的，候选版本的使用与分支完全一样。所以，我可以告诉 git-svn 使用 Release Candidates 作为分支，但是我没有得到分支，或者我可以告诉它使用分支，但没有得到 Release Candidates。我可以两者兼得吗？我想要类似的东西

```
 [svn-remote "svn"]
      url = svn://server/repo
      fetch = trunk:refs/remotes/trunk
      branches = branches/*:refs/remotes/*
      branches = Release Candidate/*:refs/remotes/*
      tags = tags/*:refs/remotes/tags/* 
```

工作，但它没有（据我所知）

同样在尝试但它不工作的营地中是这样的

```
[svn-remote "svn"]
  url = svn://svnserve/repo
  fetch = trunk:refs/remotes/trunk
  branches = Release Candidate/*:refs/remotes/RCs/*
  tags = tags/*:refs/remotes/tags/*
[svn-remote "svnbranches"]
  url = svn://svnserve/repo
  fetch = <What the heck do I put here???>
  branches = branches/*:refs/remotes/* 
```

但我不知道为 svnbranches 的 fetch 放什么（复制 svn 的 fetch 会导致 git-svn 错误，将其排除在外或放入不存在的分支会导致 git 错误）

如何将两种类型的分支都拉入 git-svn？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T15:04:28.977

现在，我没有时间调查为什么 git-svn 不处理这个问题。但似乎您可以通过将 Release_Candidates 作为 Branches 的子目录来解决您的问题：

```
trunk/*
branches/
    Release Candidates/*
    other branches
    .
    .
    .
tags/* 
```

然后[您对 CaptainPicard 的回答](https://stackoverflow.com/questions/258590/how-do-i-import-svn-branches-rooted-in-different-directories-into-git-using-git-s/630684#630684)将起作用，如果您的构建需要，您可以使用链接重新创建旧的 svn 结构。

# wpf - ElementName=" 的区别 “和RelativeSource自己？

> ID：630724
> 
> 赞同：12
> 
> 时间：2009-03-10T15:13:00.117
> 
> 标签：wpf, data-binding, relativesource, elementname

通过名称进行绑定自引用与通过 RelativeSource 进行自引用之间有什么区别？

例如：

```
<!-- Self referential via name -->
<Window ...
    x:Name="This"
    DataContext="{Binding Path=Data, ElementName=This}"/> 
```

相对

```
<!-- Self referential via RelativeSource -->
<Window ...
    x:Name="This"
    DataContext="{Binding Path=Data, RelativeSource={RelativeSource Self}}"/> 
```

在我的项目中，它们的行为似乎相同，但我直接在窗口中使用它们。这意味着我立即更喜欢前者，因为它打字更少。

RelativeSource 的唯一优势是它能够在（例如）广泛使用的样式中进行自我引用吗？还是有一些额外的语义差异？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-10T15:30:33.117

警告：不是 WPF 向导

当您像示例中那样直接绑定到 WPF 元素时，没有区别。"This" 是可解析的，将绑定到与 Self 相同的项目。

我怀疑当您通过诸如 Style 之类的构造进行绑定时，区别就在于。在这种情况下，您真正​​想要绑定的是应用样式的元素。在这种情况下，RelativeSource Self 会给你那个元素，其中“this”只会给你一个 Style 实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-15T15:09:00.220

如果您倾向于大量重构控件的名称，那么使用自引用形式可能更可取，否则我会说这是我会根据性能进行的调用。构建一个小测试，看看哪种类型的绑定性能更好，然后选择那个。如果性能差异可以忽略不计，那么我肯定会考虑其他可维护性考虑因素，例如整体外观和输入时间。也不要忘记，当使用自引用表单时，您不必命名元素，因此在比较鼠标和键盘之间的输入和上下文切换时，您必须包括 ElementName 表单的额外命名要求。

就个人而言，我更喜欢引用绑定形式，因为它可以更轻松地重构，并且在设置绑定时我不必在 XAML 文档中移动以添加元素名称。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-10T15:21:04.997

为什么您认为它们之间存在差异？我认为它们应该是相同的，因为它们是指同一元素的两种方式。

# crystal-reports - 在页脚部分下显示详细信息部分

> ID：630755
> 
> 赞同：0
> 
> 时间：2009-03-10T15:20:25.107
> 
> 标签：crystal-reports

我正在使用水晶报表。如果我想在页脚部分下打印详细信息部分，是否有可能在水晶中。我在页脚级别进行了所有计算，之后我想显示所有详细信息记录。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T15:23:56.533

您可以，但您需要创建一个包含您想要显示的所有详细信息的子报告，然后在页脚中导入/嵌入附加报告。

# excel - 使用 Excel 作为 Access 数据库的前端（使用 VBA）

> ID：630766
> 
> 赞同：28
> 
> 时间：2009-03-10T15:23:25.163
> 
> 标签：excel, ms-access, vba

我正在为朋友构建一个小型应用程序，他们希望能够使用 Excel 作为前端。（用户界面基本上是 Excel 中的用户表单）。他们在 Excel 中有一堆数据，他们希望能够查询，但我不想将 excel 用作数据库，因为我认为它不适合该目的并且正在考虑使用 Access。[顺便说一句，我知道 Access 有其缺点，但可用预算为零，而且 Access 已经在朋友的 PC 上]

总而言之，我正在考虑将一堆数据转储到 Access 中，然后使用 Excel 作为前端来查询数据库并在用户窗体样式环境中显示结果。

问题：

1.  使用 ADO/DAO 从 Excel 链接到 Access 有多容易？它在功能方面是否非常有限，或者我可以发挥创意吗？
2.  我是否会支付性能损失（与使用 Access 中的表单作为 UI 相比）？
3.  假设数据库将始终使用 Excel VBA 中的 ADO / DAO 命令更新，这是否意味着我可以让多个 Excel 用户使用一个 Access 数据库而不会遇到任何并发问题等？
4.  还有什么我应该注意的吗？

我有很强的 Excel VBA 技能，我认为我可以很快克服 Access VBA，但以前从未真正完成过 Excel / Access 链接。我可以将数据硬塞到 Excel 中并用作准数据库，但这似乎比它的价值更痛苦（而不是一个强大的长期解决方案）

任何建议表示赞赏。

亚历克斯

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-10T15:43:12.167

我相信你会得到很多“不要这样做”的答案，我必须说，这是有充分理由的。这不是一个理想的解决方案......

话虽如此，我以前也曾走这条路（和类似的路），主要是因为这份工作将其指定为一项硬性要求，而我无法谈论它。

以下是一些需要考虑的事项：

> 使用 ADO/DAO 从 Excel 链接到 Access 有多容易？它在功能方面是否非常有限，或者我可以发挥创意吗？

这是相当严格的。你比使用其他工具做事更受限制，因为 VBA 和 Excel 表单比大多数完整的编程语言更受限制，但没有任何东西可以阻止你。它有效 - 有时它有点难看，但它确实有效。在我上一家公司，我经常不得不这样做 - 偶尔通过 Excel 中的 VBA 从 Access 和 Oracle 中提取数据。

> 我是否会支付性能损失（与使用 Access 中的表单作为 UI 相比）？

我的经验是肯定有一个性能。这样做的惩罚。我从不关心（在我的用例中，事情足够小以至于它是合理的），但是使用 Excel<->Access 比直接在 Access 中工作要慢得多。部分取决于你想做什么......

就我而言，似乎绝对最慢（也是最痛苦）的事情是尝试根据 Access 数据填写 Excel 电子表格。这不好玩，而且通常很慢。如果您必须走这条路，请确保使用隐藏/不可见的 Excel 进行所有操作，否则重绘绝对会杀死您。

> 假设数据库将始终使用 Excel VBA 中的 ADO / DAO 命令更新，这是否意味着我可以让多个 Excel 用户使用一个 Access 数据库而不会遇到任何并发问题等？

您几乎将 Excel 用作客户端 - 与使用 WinForms 应用程序或任何其他工具的方式相同。Access 的 ADO/DAO 客户端非常好，因此您可能不会遇到任何并发问题。

话虽如此，Access 不能很好地扩展。如果您有 2 个或 3 个（甚至 10 个）用户，这将非常有用。如果你打算有 100 个，你可能会遇到问题。此外，我倾向于发现 Access 需要定期维护才能避免出现损坏问题。Access DB 的定期备份是必须的。根据我的经验，定期压缩访问数据库将有助于防止数据库损坏。

> 还有什么我应该注意的吗？

你这样做很难。使用 Excel 来访问 Access 将比直接使用 Access 做更多的工作。

我建议您查看 Access VBA API - 其中大部分与 Excel 相同，因此您的学习曲线会很短。不同的部分只是让这更容易。您还将拥有 Access 报告和表单的所有优势，它们比 Excel 中的更面向数据。报告对于此类事情可能非常有用，从长远来看，拥有宏和报告将使生活更轻松。如果用户将使用表单来管理所有内容，那么在 Access 中执行表单将与在 Excel 中执行非常非常相似，并且看起来几乎相同，但会使一切变得更快、更顺畅。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-10T16:56:32.617

我一直这样做。如果您使用的是 ADO，那么您实际上使用的不是 Access，而是底层数据库 Jet。这意味着任何拥有 Excel 的人都可以使用该应用程序 - 不需要 Access。哦，我应该提一下，我工作的地方买了一堆 Office 小型企业许可证 - 没有访问权限。在这里工作之前，我会假设任何拥有 Excel 的人也会拥有 Access。不是这样。

我为 Access 中的每个表创建一个类。我很少通过 ADO 运行查询，而是将逻辑保留在类模块中。我使用 SELECT 语句读入，并使用 ADODB.Connection 对象的 Execute 方法使用 UPDATE 或 INSERT 写出。

见[http://www.dailydoseofexcel.com/archives/2008/12/21/vba-framework-ii/](http://www.dailydoseofexcel.com/archives/2008/12/21/vba-framework-ii/)

如果你想看看我是如何设置我的代码的。

回答您的问题：如果您已经了解 Excel VBA，这对您来说将是一个小的学习曲线，但会有一些学习要做；您将在 Access 中完成所有操作会付出性能损失，但这并没有那么糟糕，只有您可以决定是否值得；并且您可以让多个人访问数据库。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-10T15:36:12.510

**只需跳过 excel 部分**- excel 用户表单只是更强大的 Access 表单方式的穷人版本。此外，Access VBA 与 Excel VBA 相同——您只需学习 Access 的对象模型。使用简单的应用程序，您无论如何都不需要编写太多的 VBA，因为在 Access 中，您可以很容易地将事物连接在一起。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-10T15:28:01.267

如果最终用户拥有 Access，则在 Access 中开发整个事物可能会更容易。Access 内置了一些所见即所得的表单设计工具。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-10T15:44:01.633

除非在 Excel 中运行您的用户表单有很大的优势，否则我会使用 100% Access 解决方案，该解决方案会临时将报告和数据导出到 Excel。

根据您的描述，Access 似乎是更强大的竞争者，因为它是为*处理数据*而构建的：
您可以使用更多的工具来解决任何数据问题，而不必绕过 Excel 的限制并将其硬塞到 Access 中。 ..

至于你的问题：

1.  很容易。关于这个主题还有其他一些关于 SO 的问题。
    例如看[这个](https://stackoverflow.com/questions/358603/access-table-data-to-excel)和[那个](https://stackoverflow.com/questions/358722/linking-powerpoint-and-access-through-vba/359526#359526)。

2.  不知道，但我猜可能会有一个小处罚。
    我看到的最大困难是尝试获取 Access 为您提供的所有功能并在 Excel 中重新创建其中一些功能。

3.  是的，您可以拥有多个 Excel 用户和一个 Access 数据库。
    同样，使用 Access 作为前端并将数据保存在网络上的链接 Access 数据库中会更有意义，而且非常简单，Access 中甚至还有一个向导可以帮助您做到这一点：[只需单击 1](http://allenbrowne.com/ser-01.html)次即可。

确实，正如大多数其他人所说，花一点时间来熟悉 Access，它将为您节省大量时间和麻烦。
您可能更了解 Excel，但如果您了解 VBA 并熟悉 Office 对象模型，那么您已经完成了 80% 的工作。

在 Access 中执行此操作的其他优点：[Access 2007 运行时是免费](http://www.microsoft.com/downloads/details.aspx?familyid=d9ae78d9-9dc6-4b38-9fa6-2c745a175aed&displaylang=en)的，这意味着如果您要将应用程序部署到 1 或 30 台 PC，它的成本将相同：**没有**。
您的开发工作只需要一个完整版本的 Access（运行时没有设计器）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-18T16:46:28.553

这真的取决于应用程序。对于普通项目，我建议仅使用 Access，但有时，需求是特定的，Excel 电子表格可能更合适。

例如，在我必须为前雇主开发的一个项目中，需要在表格上授予不同人员的访问权限（预先填写了一些数据，每个人都不同）并让他们完成它们，然后重新导入数据。

由于表单使用了大量的数字运算，因此在 Excel 中构建它更有意义。

不同人员的 Excel 工作簿是使用 VBA 从模板构建的，然后保存在适当的位置，并具有文件夹的访问权限。

所有工作簿都使用命名范围作为外部表附加到工作簿。然后我可以从 Access 应用程序中查询工作簿。所有的管理工作都是由数据库制作的，但最终用户只能访问他们各自的工作簿。

以这种方式开发 Excel/Access 应用程序是一种愉快的体验，并且 UI 比使用 Access 时更加用户友好。

我不得不说，在这种情况下，在 Access 中执行此操作要比使用 Excel 花费更多时间。此外，应用程序对象模型在 Excel 中似乎比在 Access 中更好。

如果您打算使用 Excel 作为前端，不要忘记锁定所有单元格，但可编辑的单元格不要害怕使用屏蔽的行和列（为 access 数据库构建输出表，执行中间计算等）。

您还应该在导入数据时关闭自动计算。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-06-02T10:17:28.497

It's quite easy and efficient to use Excel as a reporting tool for Access data. A quick "non programming" approach is to set a List or a Pivot Table, linked to your External Data source. But that's out of scope for Stackoverflow.
A programmatic approach can be very simple:

```
strProv = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & SourceFile & ";"
Set cnn = New ADODB.Connection  
cnn.Open strProv
Set rst = New ADODB.Recordset
rst.Open strSql, cnn
myDestRange.CopyFromRecordset rst 
```

That's it !

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-10T18:01:09.607

鉴于 Access 的易用性，除了导出数据以进行数字运算之外，我没有看到使用 Excel 的令人信服的理由。Access 旨在轻松构建数据表单，并且在我看来，它比使用 Excel 更容易且耗时更少。学习 Access 对象模型的几个小时将在时间和精力方面付出很多倍的代价。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-12-21T17:25:12.027

我在我的一个项目中做到了。我使用 MDB 存储有关账单的数据，并使用 Excel 来呈现它们，让用户可以对其进行调整。

在这种情况下，最好的解决方案是：

1.  **不要在 Excel 中使用任何 ADO/DAO**。我在 MDB 模块中将所有内容都实现为公共函数，并直接从 Excel 中调用它们。通过调用带有必要参数的 MDB 函数，您甚至可以返回复杂的数据对象，如字符串数组等。这类似于现代 Web 应用程序的客户端/服务器架构：您的 Web 应用程序只进行渲染和用户交互，然后数据库和中间层位于服务器端。

2.  使用 Excel 表单进行用户交互和数据可视化。

3.  我通常有最后一张表，其中包含一些用于设置的名称区域：MDB 文件的路径、一些设置（当前用户、密码，如果需要等）——因此您可以轻松地将 Excel 实现调整到您的不同位置“back-结束”数据。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-19T20:59:27.213

使用 VBA 将 Excel 连接到 Access 非常有用，我每天都在我的职业中使用它。我使用的连接字符串是根据下面链接中的程序。该程序可以自动执行多个连接或任务，但基本连接代码看起来相同。祝你好运！

[http://vbaexcel.eu/vba-macro-code/database-connection-retrieve-data-from-database-querying-data-into-excel-using-vba-dao](http://vbaexcel.eu/vba-macro-code/database-connection-retrieve-data-from-database-querying-data-into-excel-using-vba-dao)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-01-09T07:19:21.517

这取决于您对 Excel<->Acess 解决方案的期望功能。在很多情况下，如果您没有预算来获得完整的应用程序解决方案，这些小实用程序确实可以工作。如果项目范围有限，那么我会选择这个解决方案，因为 excel 确实让您可以根据需要灵活地设计电子表格，然后您可以使用这些预先设计的表格供用户使用。在 Access 中设计类似表单的电子表格更加耗时和困难，并且确实需要一些 ActiveX。它对象可能不仅处理数据，而且像甲酸盐一样在电子表格中呈现，那么这个解决方案应该在有限的范围内工作。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2010-02-10T09:43:58.200

你可以尝试类似[XLLoop](http://xlloop.sourceforge.net)的东西。这使您可以在外部服务器上实现 excel 函数 (UDF)（提供了许多不同语言的服务器实现）。

例如，您可以使用 MySQL 数据库和 Apache Web 服务器，然后用 PHP 编写函数来为您的用户提供数据。

顺便说一句，我从事该项目，所以如果您有任何问题，请告诉我。

# wpf - 如何在 WPF 的 DataTemplate 中访问根 DataContext？

> ID：630767
> 
> 赞同：11
> 
> 时间：2009-03-10T15:23:37.660
> 
> 标签：wpf, data-binding, binding

我有一个使用数据绑定填充的项目网格。在网格中，我有一个`DataTemplate`特定的单元格。我需要访问`DataContext`根元素（托管网格的那个），以便我可以访问其他绑定来支持我的数据模板。

所以你有了：

```
Window
    Window.DataContext = TheDataSourceWithItemsAndSupports
    DataGrid.ItemsSource = {Binding Items}
        DataTemplate
            ListBox.ItemsSource = {Binding Supports} 
```

我想要`{Binding Supports}`on `TheDataSourceWithItemsAndSupports`，但我不知道该怎么做。我尝试指定`{Binding}`但总是返回`null`. 我也尝试过使用`RelativeSource FindAncestor`，但这也产生`null`了。

有什么线索吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-10T15:31:55.767

也许试试

```
Window Name="TheWindow"
...
ListBox.ItemsSource = {Binding DataContext.Supports, ElementName=TheWindow} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-07-18T00:20:19.807

绑定到根上下文的另一个小技巧

```
<ListBox ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}, AncestorLevel=1}, Path=DataContext.Supports}"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-21T19:52:52.130

我的解决方案是通过实现这个字段来公开整个 DataContext 类

```
get
{
    return this;
} 
```

然后绑定到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T18:45:38.187

它应该按照您描述的方式工作。只有我看到你的 DataTemplate 不是 ItemTemplate。您还应该查看输出窗口以查看绑定失败的位置。

# javascript - 动态定位弹出“窗口”（div 元素）

> ID：630779
> 
> 赞同：2
> 
> 时间：2009-03-10T15:26:39.697
> 
> 标签：javascript, jquery, html, css

我的页面底部有一个固定的工具栏，用户可以在其中更改他们的在线状态并加载他们最喜欢的列表等。

在工具栏中，我有父 div 元素，单击时会弹出需要直接定位在父元素上方的子 div 元素。

对于在线状态部分，我认为我做得对，因为在线状态弹出窗口的高度始终是相同的高度。

CSS：

```
#toolbar
{
    background:url('/_assets/img/toolbar.gif') repeat-x;
    height:25px;
    position:fixed;
    bottom:0px;
    left:1%;
    right:1%;
    border-left:1px solid #000000;
    border-right:1px solid #000000;
    z-index:100;
    font-size:0.8em;
}   
#toolbar #onlineStatus
{
    float:left;
    width:30px;
    padding-top:5px;
    height:21px;
    text-align:center;
    border-right:1px solid #606060;
}
#toolbar #onlineStatusPopUp
{
    display:none;
    border:1px solid #000000;
    height:50px;
    width:211px;
    background:#2b2b2b;
    float:left;
    position:absolute;
    left:-1px;
    top:-51px;
} 
```

HTML：

```
<div id="toolbar">
   <div id="onlineStatus">
       <a href="javascript:onlineStatusClick();"><img id="onlineStatusIcon" src="/_assets/img/icons/<?php if ($onlinestatus == 0) { echo "online.gif"; } else { echo "hidden.gif"; } ?>" /></a>
       <div id="onlineStatusPopUp">
           <div id="popUpTitleBar">
               <div id="popUpTitle">Online Status</div>
               <div id="popUpAction"><a href="javascript:closeOnlineStatus();">x</a></div>
           </div>
           <div id="onlineStatusMessage">
               <?php if ($onlinestatus == 0) { echo "You're online, <a href=\"javascript:changeOnlineStatus();\">go hide</a>"; } else { echo "You're hidden, <a href=\"javascript:changeOnlineStatus();\">go online</a>"; } ?>
           </div>
       </div>
   </div>
</div> 
```

这是定位弹出元素的正确方法还是我应该以不同的方式进行操作（即位置：相对而不是绝对，并进行一些调整）？

这是它的外观的屏幕截图：

![在线状态截图。](https://i.stack.imgur.com/Z6MIH.jpg)

如果那是正确的，那么我将面临下一个问题，即弹出 div 元素，其大小会根据 AJAX 调用返回的内容而改变。现在我正在根据通过 JavaScript 和 JQuery 返回的项目数来定位元素，这真的很难看。

有更好的方法吗？

首先，这是动态填充的 div 元素的屏幕截图：

![动态填充的 div 元素。](https://i.stack.imgur.com/mPyIW.jpg)

CSS：

```
#toolbar #favoritesOnline
{
    float:left;
    height:21px;
    width:180px;
    padding-top:4px;
    border-right:1px solid #606060;
    text-align:center;
}
#toolbar #favoritesOnline .favoritesOnlineIcon
{
    padding-right:5px;
}
#toolbar #favoritesOnlinePopUp
{
    display:none;
    border:1px solid #000000;
    width:211px;
    background:#2b2b2b;
    float:left;
    position:absolute;
    left:-1px;
}
#toolbar #favoritesOnlineListing
{
    overflow:auto;
} 
```

HTML（注意：它也包含在工具栏 div 中）：

```
 <div id="favoritesOnline" style=" <?php if ($onlinestatus == -1) { echo "display:none;"; } ?> ">
   <img class="favoritesOnlineIcon" src="/_assets/img/icons/favorite-small.gif" /><a href="javascript:favoritesOnlineClick();">Favorites Online (<span id="favoritesOnlineCount"><?php echo $favonlinecount; ?></span>)</a>
   <div id="favoritesOnlinePopUp">
       <div id="popUpTitleBar">
           <div id="popUpTitle">Favorites Online</div>
           <div id="popUpAction"><a href="javascript:closeFavoritesOnline();">x</a></div>
       </div>     
       <div id="favoritesOnlineListing"></div>
   </div> 
```

这是我用来根据列表中的项目数（数组 [0] 是元素数）将其定位在父元素上方的丑陋 JavaScript。

```
$("#favoritesOnlinePopUp").css('top', ((parseInt(array[0]) * 39) - 5 + 1) * -1); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T15:36:22.510

如果你的工具栏有一个固定的高度，你可以绝对从底部定位弹出窗口，工具栏元素作为相对容器。

和CSS：

```
#favoritesOnline {
    position: relative;
}

#favoritesOnlinePopup {
    position: absolute;
    width: 211px;
    bottom: 21px;
} 
```

这应该从 #favoritesOnline 的顶部开始，并随着内容填充 div 向上增长。

# sql-server - 关于 xpath 元素的 xml 路径问题的 MS TSQL

> ID：630782
> 
> 赞同：2
> 
> 时间：2009-03-10T15:27:36.870
> 
> 标签：sql-server, tsql, for-xml

我有以下 TSQL 语句：

```
select 
  tblName     "TblName",
  structure   "TblName/STRUCTURE",
  sqlRetrieve "TblName/SQLRETRIEVE",
  Identifier  "TblName/IDENTIFIER",
  '2'         "TblName/OBJECTTYPE"
from 
  configTable 
for xml path ('') 
```

输出：

```
<TblName>PD_CODE_PRODUCTS
  <STRUCTURE>PD_CODE_PRODUCTS</STRUCTURE>
  <SQLRETRIEVE>BATCHSP</SQLRETRIEVE>
  <IDENTIFIER>DATA_OWNER</IDENTIFIER>
  <OBJECTTYPE>2</OBJECTTYPE>
</TblName>
<TblName>PD_two
  <STRUCTURE>PD_CODE_PRODUCTS</STRUCTURE>
  <SQLRETRIEVE>BATCHSP</SQLRETRIEVE>
  <IDENTIFIER>DATA_OWNER</IDENTIFIER>
  <OBJECTTYPE>2</OBJECTTYPE>
</TblName> 
```

但我想要这个输出（元素名称：

```
<PD_CODE_PRODUCTS>
  <STRUCTURE>PD_CODE_PRODUCTS</STRUCTURE>
  <SQLRETRIEVE>BATCHSP</SQLRETRIEVE>
  <IDENTIFIER>DATA_OWNER</IDENTIFIER>
  <OBJECTTYPE>2</OBJECTTYPE>
</PD_CODE_PRODUCTS>
<PD_two>
  <STRUCTURE>PD_CODE_PRODUCTS</STRUCTURE>
  <SQLRETRIEVE>BATCHSP</SQLRETRIEVE>
  <IDENTIFIER>DATA_OWNER</IDENTIFIER>
  <OBJECTTYPE>2</OBJECTTYPE>
</PD_two> 
```

有人知道如何使用 T-SQL 实现这一目标吗？

谢谢
丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T20:34:16.720

不幸的是，我认为您无法使用 T-SQL 实现这一目标。

你能得到的最接近的是：

```
<TABLE Name="PD_CODE_PRODUCTS">
  <TblName>
    <STRUCTURE>PD_CODE_PRODUCTS</STRUCTURE>
    <SQLRETRIEVE>BATCHSP</SQLRETRIEVE>
    <IDENTIFIER>DATA_OWNER</IDENTIFIER>
    <OBJECTTYPE>2</OBJECTTYPE>
  </TblName>
</TABLE>
<TABLE Name="PD two">
  <TblName>
    <STRUCTURE>PD_CODE_PRODUCTS</STRUCTURE>
    <SQLRETRIEVE>BATCHSP</SQLRETRIEVE>
    <IDENTIFIER>DATA_OWNER</IDENTIFIER>
    <OBJECTTYPE>2</OBJECTTYPE>
  </TblName>
</TABLE> 
```

如果您将查询调整为：

```
select 
  tblName '@Name',
  structure   "TblName/STRUCTURE",
  sqlRetrieve "TblName/SQLRETRIEVE",
  Identifier  "TblName/IDENTIFIER",
  '2'         "TblName/OBJECTTYPE"
from 
  configTable 
for xml path ('TABLE') 
```

抱歉，我在这里无法提供更多帮助 - 猜猜这是微软尚未真正考虑过的功能（到目前为止）！:-)

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T02:38:36.953

如果您对 XML 结构有任何控制权，我请求您不要做您正在尝试做的事情。我遇到过 XML 文档，其中 XML 元素名称会根据数据而变化，而且使用起来很糟糕。XPath 语句很难，XSLT 几乎是不可能的。

按照 marc_s 的建议去做，你以后会感谢他的。

如果您无法控制结构，那么您有我的同情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-03T09:30:48.380

如果我理解正确 - 你想要一个根元素而不是多个主根。

采用：

```
select   tblName '@Name',  structure   "TblName/STRUCTURE",  sqlRetrieve "TblName/SQLRETRIEVE",  Identifier  "TblName/IDENTIFIER",  '2'         "TblName/OBJECTTYPE"from   configTable for xml path (''), root('TABLE'), type 
```

# security - 应用程序内的简单 Active Directory 集成 - 应用程序应存储什么？

> ID：630787
> 
> 赞同：2
> 
> 时间：2009-03-10T15:28:53.713
> 
> 标签：security, authentication, active-directory

我开始一个项目，以允许现有的 Web 应用程序使用活动目录进行身份验证，但在应用程序中保留授权。我想从简单开始，所以我想用户将他们的 AD 用户名/密码输入到我现有的登录表单中，然后我将对 AD 服务器进行 ldap 绑定以验证用户身份。一旦用户通过身份验证，我会从我的数据库中提取该用户，该数据库具有关于用户可以看到哪些功能的所有授权信息。

我的问题是存储在我的表中以建立关联的最佳 AD 元素是什么？过去我使用过用户名，但在查看了 AD 返回的一些元素后，我想知道是否应该使用安全 ID 或 GUID 或其他东西？

当用户名更改（例如员工结婚或离婚）时，我被烧死了……所以我知道这很脆弱。

我的目标是 Windows 2003 AD 及更高版本，如果这有影响的话；这适用于一些客户拥有大型 AD 森林而一些是小型网络的产品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T15:52:49.617

存储 SID 是最可靠的方法；这是所有 Microsoft AD 事物、安全组、权限等使用的唯一 ID。

如果你在 .Net 上构建，你应该认真考虑 .Net 3.5，有一个新的命名空间[System.DirectoryServices.AccountManagement](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx)大大简化**了**这里的代码，并为你提供了很好的整洁对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T15:57:21.620

除非用户共享计算机，否则为什么不使用[Windows 集成登录](http://weblogs.asp.net/scottgu/archive/2006/07/12/Recipe_3A00_-Enabling-Windows-Authentication-within-an-Intranet-ASP.NET-Web-application.aspx)？对用户来说更容易，作为开发人员对你自己更容易，并且更安全（可以嗅探密码的地方更少）。

需要我提一下，允许更改用户身份是糟糕的公司安全策略吗？使可追溯性变得更加困难，允许一些新颖的攻击向量，并让您感到头疼。

正如尼克提到的，SID 是一个稳定的标识符，但不是您应该要求用户自己输入的东西！

# c# - 配置 Windows DNS 解析器缓存

> ID：630790
> 
> 赞同：7
> 
> 时间：2009-03-10T15:29:58.360
> 
> 标签：c#, .net, dns

请注意，我说的是客户端 DNS 解析器缓存。此消息与 Windows DNS 服务器无关。

我有一个执行大量 DNS 解析的 C# 程序。因为 HTTPWebRequest 组件不允许我更改 Host 标头，所以我无法创建自己的内部 DNS 缓存。所以我必须依赖 Windows DNS 缓存，它似乎无法更改。

关于 Windows Server 2003 中的 DNS 缓存注册表设置，有一篇相当不错的[TechNet 文章](http://technet2.microsoft.com/windowsserver/en/library/94d21089-411b-4bce-a823-49a77a46e7661033.mspx?mfr=true)，但我无法证明设置它们有什么作用。我通过谷歌搜索找到的所有其他页面要么引用该页面，要么解释它，有时是错误的。

Windows 的 ipconfig 命令有一个 /displaydns 开关，可以输出缓存的内容。据我所知，这是确定 DNS 缓存大小的唯一方法。在我对具有 2 GB 内存的 32 位 Windows XP 机器进行的实验中，无论我将 DNS 缓存注册表值设置为什么，我最终都会在缓存中得到 30 到 40 个项目——即使在进行了数千次 DNS 解析之后. 在我的具有 16 GB 内存的 64 位 Windows 2008 机器上，我总是在缓存中获得 270 到 300 个项目。

我难住了。我不知道答案是什么，但我认为是以下情况之一：

1.  无法更改 DNS 解析器缓存的大小。
2.  这是可能的，但文档是错误的。
3.  该文档是正确的，但它不完整。
4.  该文档是正确且完整的，但我太笨了，无法理解它。
5.  记录在案的注册表项实际上改变了缓存的大小，但 ipconfig 并未向我显示缓存中的所有条目。

谁能告诉我是否可以在 Windows XP、Vista 或 Server 2008 中配置 DNS 解析器缓存的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T05:41:53.360

有一个“便携式 DNS 缓存”程序，您可以使用它来查看 DNS 缓存、监控 DNS 解析器的活动，并查看通过缓存解析的查询以及转发到 DNS 服务器的查询。在其设置中，您可以配置缓存中的最大项目数。虽然，它似乎强制所有项目保留在缓存中，直到您单击“清除缓存”按钮或达到缓存限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-13T23:57:26.833

使用这些设置，在网络上几分钟后，我看到了 1517 个缓存条目：

REGEDIT4

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Dnscache\Parameters]
"QueryIpMatching"=dword:00000001
"NegativeCacheTime"=dword:00000000
"NegativeSOACacheTime"=dword:00000000
"CacheHashTableBucketSize"=dword:00000001
"CacheHashTableSize"=dword:
00tMaxlLimitEntryT80 "=dword:00000e10
"MaxSOACacheEntryTtlLimit"=dword:0000012c

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters]
"QueryIpMatching"=dword:00000001

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T15:48:55.960

默认情况下，缓存的最小 TTL 为 1 天，我玩过它，但默认情况下我相信注册表项默认情况下不存在。

这是您正在寻找的关键，至少在 XP 中：

`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\DNSCache\Parameters`

您需要添加一个 DWORD **MaxCacheTtl** - 这将更改存储在解析器缓存中的最小 TTL。

由于它默认为 86,400（值以秒为单位，默认 = 1 天），任何比这更短的内容都不会被缓存。如果你把它降低到 300，你会看到更多的缓存在客户端上。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-23T00:57:43.247

您可以使用的一种技巧是将条目添加到 Windows 上的主机文件中，这将使它不会对文件中的所有条目进行 DNS 查询。然后您可以定期再次查询以验证条目。

# sql-server - 多维数据集处理 SQL Server 开发者版

> ID：630792
> 
> 赞同：0
> 
> 时间：2009-03-10T15:30:30.513
> 
> 标签：sql-server, ssis, ssas

这可能吗？似乎当我尝试手动或通过 SSIS 任务执行此操作时，它不起作用，而其他版本则可以。

（我使用本地开发者版本作为测试环境）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T15:57:49.167

与本地工作站上的其他版本一样好吗？

他们说，开发人员应该和企业一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T15:58:39.040

有可能的。Sql Server Developer 版与企业版具有相同的功能您遇到什么错误？本地多维数据集的数据源是否指向正确的数据库？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T10:13:10.313

解决了这个问题。我必须将我的分析服务实例配置为使用我的帐户，而不是 SQL Server 配置管理器中的内置帐户

# c# - 在 C# 中将枚举与字符串相关联

> ID：630803
> 
> 赞同：520
> 
> 时间：2009-03-10T15:33:44.873
> 
> 标签：c#, .net

我知道以下是不可能的，因为枚举的类型必须是 int

```
enum GroupTypes
{
    TheGroup = "OEM",
    TheOtherGroup = "CMB"
} 
```

从我的数据库中，我得到一个包含不全面代码（the`OEM`和`CMB`s）的字段。我想把这个领域变成一个`enum`或其他可以理解的东西。因为如果目标是可读性，那么解决方案应该是简洁的。

我还有什么其他选择？

* * *

## 回答 #1

> 赞同：572
> 
> 时间：2009-08-27T20:12:41.083

我喜欢**在类中使用属​​性**而不是方法，因为它们看起来更像枚举。

这是记录器的示例：

```
public class LogCategory
{
    private LogCategory(string value) { Value = value; }

    public string Value { get; private set; }

    public static LogCategory Trace   { get { return new LogCategory("Trace"); } }
    public static LogCategory Debug   { get { return new LogCategory("Debug"); } }
    public static LogCategory Info    { get { return new LogCategory("Info"); } }
    public static LogCategory Warning { get { return new LogCategory("Warning"); } }
    public static LogCategory Error   { get { return new LogCategory("Error"); } }
} 
```

传入**类型安全的字符串值**作为参数：

```
public static void Write(string message, LogCategory logCategory)
{
    var log = new LogEntry { Message = message };
    Logger.Write(log, logCategory.Value);
} 
```

用法：

```
Logger.Write("This is almost like an enum.", LogCategory.Info); 
```

* * *

## 回答 #2

> 赞同：235
> 
> 时间：2009-03-10T15:53:16.480

您还可以使用扩展模型：

```
public enum MyEnum
{
    [Description("String 1")]
    V1= 1,
    [Description("String 2")]
    V2= 2
} 
```

你的扩展类

```
public static class MyEnumExtensions
{
    public static string ToDescriptionString(this MyEnum val)
    {
        DescriptionAttribute[] attributes = (DescriptionAttribute[])val
           .GetType()
           .GetField(val.ToString())
           .GetCustomAttributes(typeof(DescriptionAttribute), false);
        return attributes.Length > 0 ? attributes[0].Description : string.Empty;
    }
} 
```

用法：

```
MyEnum myLocal = MyEnum.V1;
print(myLocal.ToDescriptionString()); 
```

* * *

## 回答 #3

> 赞同：138
> 
> 时间：2011-04-15T09:16:50.907

使用带有常量的静态类怎么样？

```
static class GroupTypes
{
  public const string TheGroup = "OEM";
  public const string TheOtherGroup = "CMB";
}

void DoSomething(string groupType)
{
  if(groupType == GroupTypes.TheGroup)
  {
    // Be nice
  }  
  else if (groupType == GroupTypes.TheOtherGroup)
  {
    // Continue to be nice
  }
  else
  {
    // unexpected, throw exception?
  }
} 
```

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2009-03-10T15:38:45.877

尝试将常量添加到静态类。你不会得到一个类型，但你会有可读的、有组织的常量：

```
public static class GroupTypes {

    public const string TheGroup = "OEM";
    public const string TheOtherGroup = "CMB";

} 
```

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2009-12-05T15:50:18.660

实际上，您可以很容易地做到这一点。使用以下代码。

```
enum GroupTypes
{
   OEM,
   CMB
}; 
```

然后，当您想获取每个枚举元素的字符串值时，只需使用以下代码行。

```
String oemString = Enum.GetName(typeof(GroupTypes), GroupTypes.OEM); 
```

我过去成功地使用过这种方法，并且我还使用了一个常量类来保存​​字符串常量，两者都工作得很好，但我更喜欢这个。

* * *

## 回答 #6

> 赞同：33
> 
> 时间：2009-03-10T15:37:50.807

您可以将属性添加到枚举中的项目，然后使用反射从属性中获取值。

您必须使用“字段”说明符来应用属性，如下所示：

```
enum GroupTypes
{
    [field:Description("OEM")]
    TheGroup,

    [field:Description("CMB")]
    TheOtherGroup
} 
```

然后，您将反映枚举类型（在本例中为 GroupTypes）的静态字段，并[`DescriptionAttribute`](http://msdn.microsoft.com/en-us/library/system.componentmodel.descriptionattribute(v=vs.110).aspx)使用反射获取您正在寻找的值：

```
public static DescriptionAttribute GetEnumDescriptionAttribute<T>(
    this T value) where T : struct
{
    // The type of the enum, it will be reused.
    Type type = typeof(T);

    // If T is not an enum, get out.
    if (!type.IsEnum) 
        throw new InvalidOperationException(
            "The type parameter T must be an enum type.");

    // If the value isn't defined throw an exception.
    if (!Enum.IsDefined(type, value))
        throw new InvalidEnumArgumentException(
            "value", Convert.ToInt32(value), type);

    // Get the static field for the value.
    FieldInfo fi = type.GetField(value.ToString(), 
        BindingFlags.Static | BindingFlags.Public);

    // Get the description attribute, if there is one.
    return fi.GetCustomAttributes(typeof(DescriptionAttribute), true).
        Cast<DescriptionAttribute>().SingleOrDefault();
} 
```

`DescriptionAttribute`如果您希望能够确定是否应用了该属性，我选择返回上面的本身。

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2019-12-05T21:51:07.753

我使用了先前答案中提到的结构，但消除了任何复杂性。对我来说，这就像创建一个字符串枚举。它的使用方式与使用枚举的方式相同。

```
 struct ViewTypes
    {
        public const string View1 = "Whatever string you like";
        public const string View2 = "another string";
    } 
```

示例使用：

```
 switch( some_string_variable )
   {
      case ViewTypes.View1: /* do something */ break;
      case ViewTypes.View2: /* do something else */ break;
   } 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2009-03-10T15:36:58.657

为您的数据库创建第二个枚举，其中包含以下内容：

```
enum DBGroupTypes
{
    OEM = 0,
    CMB = 1
} 
```

现在，您可以使用 Enum.Parse 从字符串“OEM”和“CMB”中检索正确的 DBGroupTypes 值。然后，您可以将它们转换为 int 并从要在模型中进一步使用的正确枚举中检索正确的值。

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2009-03-10T15:38:39.777

使用一个类。

**编辑：更好的例子**

```
class StarshipType
{
    private string _Name;
    private static List<StarshipType> _StarshipTypes = new List<StarshipType>();

    public static readonly StarshipType Ultralight = new StarshipType("Ultralight");
    public static readonly StarshipType Light = new StarshipType("Light");
    public static readonly StarshipType Mediumweight = new StarshipType("Mediumweight");
    public static readonly StarshipType Heavy = new StarshipType("Heavy");
    public static readonly StarshipType Superheavy = new StarshipType("Superheavy");

    public string Name
    {
        get { return _Name; }
        private set { _Name = value; }
    }

    public static IList<StarshipType> StarshipTypes
    {
        get { return _StarshipTypes; }
    }

    private StarshipType(string name, int systemRatio)
    {
        Name = name;
        _StarshipTypes.Add(this);
    }

    public static StarshipType Parse(string toParse)
    {
        foreach (StarshipType s in StarshipTypes)
        {
            if (toParse == s.Name)
                return s;
        }
        throw new FormatException("Could not parse string.");
    }
} 
```

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2017-12-29T20:16:58.277

处理这个问题的另一种方法是有一个枚举和一个字符串数组，它们会将枚举值与字符串列表映射：

```
public enum GroupTypes
{
    TheGroup  = 0,
    TheOtherGroup 
}

string[] GroupTypesStr = {
    "OEM",
    "CMB"
}; 
```

你可以像这样使用它：

```
Log.Write(GroupTypesStr[(int)GroupTypes.TheOtherGroup]); 
```

会提示招行

优点：

1.  简单而干净的代码。
2.  高性能（特别是与那些使用类的方法相比）

缺点：

1.  编辑时容易弄乱列表，但对于简短的列表来说没关系。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2010-03-15T22:38:51.213

这是我用来将枚举值作为字符串获取的扩展方法。首先是枚举。

```
public enum DatabaseEnvironment
{
    [Description("AzamSharpBlogDevDatabase")]
    Development = 1, 
    [Description("AzamSharpBlogQADatabase")]
    QualityAssurance = 2, 
    [Description("AzamSharpBlogTestDatabase")] 
    Test = 3
} 
```

Description 属性来自 System.ComponentModel。

这是我的扩展方法：

```
public static string GetValueAsString(this DatabaseEnvironment environment) 
{
    // get the field 
    var field = environment.GetType().GetField(environment.ToString());
    var customAttributes = field.GetCustomAttributes(typeof (DescriptionAttribute), false);

    if(customAttributes.Length > 0)
    {
        return (customAttributes[0] as DescriptionAttribute).Description;  
    }
    else
    {
        return environment.ToString(); 
    }
} 
```

现在，您可以使用以下代码将枚举作为字符串值访问：

```
[TestFixture]
public class when_getting_value_of_enum
{
    [Test]
    public void should_get_the_value_as_string()
    {
        Assert.AreEqual("AzamSharpBlogTestDatabase",DatabaseEnvironment.Test.GetValueAsString());  
    }
} 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2019-10-19T06:34:13.007

**.Net Core 3.0/C# 8.0**中的新功能（如果您的工作环境允许您升级项目）是一个简写的 switch 语句，看起来有点枚举。归根结底，这是我们多年来一直在使用的老旧无聊的 switch 语句。

这里唯一真正的区别是 switch 语句有了新的花色。

```
public static RGBColor FromRainbow(Rainbow colorBand) =>
colorBand switch
{
    Rainbow.Red    => new RGBColor(0xFF, 0x00, 0x00),
    Rainbow.Orange => new RGBColor(0xFF, 0x7F, 0x00),
    Rainbow.Yellow => new RGBColor(0xFF, 0xFF, 0x00),
    Rainbow.Green  => new RGBColor(0x00, 0xFF, 0x00),
    Rainbow.Blue   => new RGBColor(0x00, 0x00, 0xFF),
    Rainbow.Indigo => new RGBColor(0x4B, 0x00, 0x82),
    Rainbow.Violet => new RGBColor(0x94, 0x00, 0xD3),
    _              => throw new ArgumentException(message: "invalid enum value", paramName: nameof(colorBand)),
}; 
```

您会注意到我从[此处](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-8#switch-expressions)复制的上述代码实际上是使用枚举作为参数。

这不完全是您想要的（相信我，我一直想要类似于 OP 长期以来要求的东西），但我实际上觉得这有点像 MS 的橄榄枝。JMO。

希望它可以帮助某人！

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-03-10T15:39:55.840

您是否考虑过使用字典的查找表？

```
enum GroupTypes
{
    TheGroup,
    TheOtherGroup
}

Dictionary<string, GroupTypes> GroupTypeLookup = new Dictionary<string, GroupTypes>();
// initialize lookup table:
GroupTypeLookup.Add("OEM", TheGroup);
GroupTypeLookup.Add("CMB", TheOtherGroup); 
```

然后，您可以在读取字符串时使用 GroupTypeLookup.TryGetValue() 来查找它。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2019-07-19T22:55:15.547

取自 @EvenMien 并添加到一些评论中。（也适用于我自己的用例）

```
public struct AgentAction
{
    private AgentAction(string value) { Value = value; }

    public string Value { get; private set; }

    public override string ToString() { return this.Value; }

    public static AgentAction Login = new AgentAction("Login");
    public static AgentAction Logout = new AgentAction("Logout");

    public static implicit operator string(AgentAction action) { return action.ToString(); }
} 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2009-03-10T15:36:49.640

我只想创建一个字典并使用代码作为键。

编辑：要解决有关进行反向查找（查找密钥）的评论，这不会非常有效。如果有必要，我会编写一个新类来处理它。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2018-01-25T10:53:05.713

```
public class DataType
{
    private readonly string value;
    private static readonly Dictionary<string, DataType> predefinedValues;

    public static readonly DataType Json = new DataType("json");
    public static readonly DataType Xml = new DataType("xml");
    public static readonly DataType Text = new DataType("text");
    public static readonly DataType Html = new DataType("html");
    public static readonly DataType Binary = new DataType("binary");

    static DataType()
    {
        predefinedValues = new Dictionary<string, DataType>();
        predefinedValues.Add(Json.Value, Json);
        predefinedValues.Add(Xml.Value, Xml);
        predefinedValues.Add(Text.Value, Text);
        predefinedValues.Add(Html.Value, Html);
        predefinedValues.Add(Binary.Value, Binary);
    }

    private DataType(string value)
    {
        this.value = value;
    }

    public static DataType Parse(string value)
    {
        var exception = new FormatException($"Invalid value for type {nameof(DataType)}");
        if (string.IsNullOrEmpty(value))
            throw exception;

        string key = value.ToLower();
        if (!predefinedValues.ContainsKey(key))
            throw exception;

        return predefinedValues[key];
    }

    public string Value
    {
        get { return value; }
    }
} 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2021-05-12T21:36:17.573

为什么不使用相同的枚举，而只是调用`.ToString()`？

```
using System;

public class EnumSample
{
    enum Holidays
    {
        Christmas = 1,
        Easter = 2
    };

    public static void Main()
    {
        Enum myHolidays = Holidays.Christmas;
        Console.WriteLine("The value of this instance is '{0}'", myHolidays.ToString());
    }
} 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-03-10T15:59:07.870

我的第一个问题 - 您可以访问数据库本身吗？理想情况下，这应该在数据库中进行规范化，否则任何解决方案都容易出错。以我的经验，充满“OEM”和“CMB”的数据字段往往会随着时间的推移而混入“oem”和其他“垃圾数据”之类的东西......如果你可以规范化它，你可以使用密钥在包含元素的表中作为你的枚举，你就完成了，结构更清晰。

如果那不可用，我会创建你的枚举，并创建一个类来为你解析你的字符串到枚举中。与使用 Enum.Parse/Reflection/etc 的任何变通方法相比，这至少会给您在处理非标准条目方面提供一些灵活性，并且在捕获或处理错误方面更加灵活。字典可以工作，但如果您遇到案例问题等，可能会崩溃。

我建议写一堂课，这样你就可以做到：

```
// I renamed this to GroupType, since it sounds like each element has a single type...
GroupType theType = GroupTypeParser.GetGroupType(theDBString); 
```

这保留了您的大部分可读性，而无需更改数据库。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2014-03-05T17:39:16.313

C# 不支持枚举字符串，但在大多数情况下，您可以使用 List 或 Dictionary 来获得所需的效果。

例如打印通过/失败结果：

```
List<string> PassFail = new List<string> { "FAIL", "PASS" };
bool result = true;
Console.WriteLine("Test1: " + PassFail[result.GetHashCode()]); 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2017-01-11T07:59:12.253

在 VS 2015 中，您可以使用 nameof

```
public class LogCategory
{
    public static string Trace;
    public static string Debug;
    public static string Info;
    public static string Warning;
    public static string Error;
} 
```

用法：

```
Logger.Write("This is almost like an enum.", nameof(LogCategory.Info)); 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2017-10-18T13:29:23.873

对 Glennular Extension 方法的一个小调整，因此您可以在 ENUM 之外的其他事物上使用扩展；

```
using System;
using System.ComponentModel;
namespace Extensions {
    public static class T_Extensions {
        /// <summary>
        /// Gets the Description Attribute Value
        /// </summary>
        /// <typeparam name="T">Entity Type</typeparam>
        /// <param name="val">Variable</param>
        /// <returns>The value of the Description Attribute or an Empty String</returns>
        public static string Description<T>(this T t) {
            DescriptionAttribute[] attributes = (DescriptionAttribute[])t.GetType().GetField(t.ToString()).GetCustomAttributes(typeof(DescriptionAttribute), false);
            return attributes.Length > 0 ? attributes[0].Description : string.Empty;
        }
    }
} 
```

或使用 Linq

```
using System;
using System.ComponentModel;
using System.Linq;

namespace Extensions {

public static class T_Extensions {
        public static string Description<T>(this T t) =>
            ((DescriptionAttribute[])t
            ?.GetType()
            ?.GetField(t?.ToString())
            ?.GetCustomAttributes(typeof(DescriptionAttribute), false))
            ?.Select(a => a?.Description)
            ?.FirstOrDefault() 
            ?? string.Empty;  
    }
} 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2019-06-06T17:26:24.750

在@Even Mien 的回答之后，我尝试更进一步并使其通用，我似乎几乎就在那里，但一个案例仍然抵制，我可能可以稍微简化我的代码。
如果有人看到我可以如何改进，尤其是让它工作，我把它贴在这里，因为我无法从字符串中分配它

到目前为止，我有以下结果：

```
 Console.WriteLine(TestEnum.Test1);//displays "TEST1"

        bool test = "TEST1" == TestEnum.Test1; //true

        var test2 = TestEnum.Test1; //is TestEnum and has value

        string test3 = TestEnum.Test1; //test3 = "TEST1"

        var test4 = TestEnum.Test1 == TestEnum.Test2; //false
         EnumType<TestEnum> test5 = "TEST1"; //works fine

        //TestEnum test5 = "string"; DOESN'T compile .... :(:( 
```

魔法发生的地方：

```
public abstract  class EnumType<T>  where T : EnumType<T>   
{

    public  string Value { get; set; }

    protected EnumType(string value)
    {
        Value = value;
    }

    public static implicit operator EnumType<T>(string s)
    {
        if (All.Any(dt => dt.Value == s))
        {
            Type t = typeof(T);

            ConstructorInfo ci = t.GetConstructor(BindingFlags.Instance | BindingFlags.NonPublic,null, new Type[] { typeof(string) }, null);

            return (T)ci.Invoke(new object[] {s});
        }
        else
        {
            return null;
        }
    }

    public static implicit operator string(EnumType<T> dt)
    {
        return dt?.Value;
    }

    public static bool operator ==(EnumType<T> ct1, EnumType<T> ct2)
    {
        return (string)ct1 == (string)ct2;
    }

    public static bool operator !=(EnumType<T> ct1, EnumType<T> ct2)
    {
        return !(ct1 == ct2);
    }

    public override bool Equals(object obj)
    {
        try
        {
            return (string)obj == Value;
        }
        catch
        {
            return false;
        }
    }

    public override int GetHashCode()
    {
        return Value.GetHashCode();
    }

    public static IEnumerable<T> All
     => typeof(T).GetProperties()
       .Where(p => p.PropertyType == typeof(T))
       .Select(x => (T)x.GetValue(null, null));

} 
```

然后我只需要为我的枚举声明这个：

```
public class TestEnum : EnumType<TestEnum> 
{

    private TestEnum(string value) : base(value)
    {}

    public static TestEnum Test1 { get { return new TestEnum("TEST1"); } }
    public static TestEnum Test2 { get { return new TestEnum("TEST2"); } }
} 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-03-10T15:43:11.793

我会把它变成一个类，完全避免枚举。然后使用类型处理程序，您可以在从数据库中获取对象时创建对象。

IE：

```
public class Group
{
    public string Value{ get; set; }
    public Group( string value ){ Value = value; } 
    public static Group TheGroup() { return new Group("OEM"); }
    public static Group OtherGroup() { return new Group("CMB"); }

} 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2014-11-20T19:33:42.933

如果我理解正确，您需要从字符串转换为枚举：

```
enum GroupTypes {
    Unknown = 0,
    OEM = 1,
    CMB = 2
}
static GroupTypes StrToEnum(string str){
    GroupTypes g = GroupTypes.Unknown;
    try {
        object o = Enum.Parse(typeof(GroupTypes), str, true);
        g = (GroupTypes)(o ?? 0);
    } catch {
    }
    return g;
}
// then use it like this
GroupTypes g1 = StrToEnum("OEM");
GroupTypes g2 = StrToEnum("bad value"); 
```

如果您愿意，可以使用枚举类型的泛型使其更加精美。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2017-04-25T14:50:39.340

这是一种将其**用作强类型参数或字符串的**方法：

```
public class ClassLikeEnum
{
    public string Value
    {
        get;
        private set;
    }

    ClassLikeEnum(string value) 
    {
        Value = value;
    }

    public static implicit operator string(ClassLikeEnum c)
    {
        return c.Value;
    }

    public static readonly ClassLikeEnum C1 = new ClassLikeEnum("RandomString1");
    public static readonly ClassLikeEnum C2 = new ClassLikeEnum("RandomString2");
} 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2015-11-19T13:37:43.733

我什至按照@Even（通过`class X`和`public static X`成员）的建议实施了一些枚举，只是为了稍后发现，从.Net 4.5开始，有*正确* [`ToString()`](https://msdn.microsoft.com/en-us/library/c3s1ez6e(v=vs.110).aspx)的方法。

现在我将所有内容重新实现回枚举。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2016-08-05T21:15:10.407

您可以使用两个枚举。一个用于数据库，另一个用于可读性。

您只需要确保它们保持同步，这似乎是一个很小的成本。您不必设置值，只需将位置设置为相同即可，但设置值可以清楚地表明两个枚举是相关的，并防止错误重新排列枚举成员。评论让维护人员知道这些是相关的，并且必须保持同步。

```
// keep in sync with GroupTypes
public enum GroupTypeCodes
{
    OEM,
    CMB
}

// keep in sync with GroupTypesCodes
public enum GroupTypes
{
    TheGroup = GroupTypeCodes.OEM,
    TheOtherGroup = GroupTypeCodes.CMB
} 
```

要使用它，您只需先转换为代码：

```
GroupTypes myGroupType = GroupTypes.TheGroup;
string valueToSaveIntoDatabase = ((GroupTypeCodes)myGroupType).ToString(); 
```

然后，如果您想让它更方便，您可以添加一个仅适用于此类枚举的扩展函数：

```
public static string ToString(this GroupTypes source)
{
    return ((GroupTypeCodes)source).ToString();
} 
```

然后你可以这样做：

```
GroupTypes myGroupType = GroupTypes.TheGroup;
string valueToSaveIntoDatabase = myGroupType.ToString(); 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2018-01-18T21:54:28.363

我基本上是在寻找@ArthurC 的反射答案

只是为了稍微扩展他的答案，您可以通过使用通用函数使其变得更好：

```
 // If you want for a specific Enum
    private static string EnumStringValue(GroupTypes e)
    {
        return EnumStringValue<GroupTypes>(e);
    }

    // Generic
    private static string EnumStringValue<T>(T enumInstance)
    {
        return Enum.GetName(typeof(T), enumInstance);
    } 
```

然后你可以把你有的东西包起来

```
EnumStringValue(GroupTypes.TheGroup) // if you incorporate the top part 
```

或者

```
EnumStringValue<GroupTypes>(GroupTypes.TheGroup) // if you just use the generic 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2019-03-08T17:46:44.080

我想完全避免使用字符串文字，而且我不需要在项目描述中留有空格。更重要的是，我想有一个机制来检查提供的字符串是否是有效的项目，所以我想出了这个解决方案：

```
public class Seasons
{
    public static string Spring { get; }
    public static string Summer { get; }
    public static string Fall { get; }
    public static string Winter { get; }

    public static bool IsValid(string propertyName)
    {
        if (string.IsNullOrEmpty(propertyName))
        {
            return false;
        }

        try
        {           
            return typeof(Seasons).GetProperty(propertyName) != null;
        }
        catch
        {
            return false;
        }       
    }
} 
```

以下是它的工作原理：

```
void Main()
{
    string s = nameof(Seasons.Fall);
    Console.WriteLine($"Fall is valid: {Seasons.IsValid(s)}"); // true

    s = "WrongSeason";
    Console.WriteLine($"WrongSeason is valid: {Seasons.IsValid(s)}"); // false
} 
```

我尝试将 IsValid() 重构为基类并使用反射来读取类型 (MethodBase.GetCurrentMethod().DeclaringType)，但由于我想让它成为静态的，所以它返回基类类型，而不是继承的类型。您对此的补救措施将非常受欢迎！这是我试图实现的目标：

```
public  class Seasons : ConstantStringsBase
{
    // ... same
}

public  class ConstantStringsBase
{
    public static bool IsValid(string propertyName)
    {       
        return MethodBase.GetCurrentMethod().DeclaringType.GetProperty(propertyName) != null;
    }
} 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2019-09-23T06:15:58.383

添加这个类

```
public class DatabasePreference {
    public DatabasePreference([CallerMemberName] string preferenceName = "") {
        PreferenceName = preferenceName;
    }
    public string PreferenceName;
} 
```

这项工作`CallerMemberName`用于最小化编码

使用：

```
//Declare names
public static DatabasePreference ScannerDefaultFlashLight = new DatabasePreference();
public static DatabasePreference ScannerQrCodes = new DatabasePreference();
public static DatabasePreference Scanner1dCodes = new DatabasePreference(); 
```

测试它：

```
Console.WriteLine(ScannerDefaultFlashLight.PreferenceName);
Console.WriteLine(ScannerDefaultFlashLight.Scanner1dCodes); 
```

输出：

```
ScannerDefaultFlashLight
Scanner1dCodes 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2022-02-18T13:10:55.597

这是我对此的看法，使用 C# 9.0 语法来保持整洁。我为枚举定义了一个基类：

```
public class StringEnum
{
    protected StringEnum(string value) { Value = value; }
    public string Value { get; }
    public override string ToString() => Value;
} 
```

然后创建新的枚举样式类型变得简单而紧凑：

```
public class GroupTypes : StringEnum
{ 
    private GroupTypes(string value) : base(value) {}

    public static readonly GroupTypes TheGroup = new("OEM");
    public static readonly GroupTypes TheOtherGroup = new("CMB");
} 
```

像这样使用它：

```
void Example(GroupTypes groupType)
{
    Console.WriteLine(groupType); // Will print "OEM" or "CMB"
    if (groupType == GroupTypes.TheGroup) { ... }
} 
```

您还可以向 中添加更多功能`StringEnum`，然后您的所有子类都可以使用这些功能（例如，实现`IComparable`和覆盖`Equals`and `GetHashCode`）

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2015-02-08T20:54:37.303

根据其他意见，这是我想出的。这种方法避免了必须在要获取常量值的地方键入 .Value。

我有一个所有字符串枚举的基类，如下所示：

```
using System;
using Newtonsoft.Json;

[JsonConverter(typeof(ConstantConverter))]
public class StringEnum: IConvertible
{
    public string Value { get; set; }

    protected StringEnum(string value)
    {
        Value = value;
    }

    public static implicit operator string(StringEnum c)
    {
        return c.Value;
    }
    public string ToString(IFormatProvider provider)
    {
        return Value;
    }

    public TypeCode GetTypeCode()
    {
        throw new NotImplementedException();
    }

    public bool ToBoolean(IFormatProvider provider)
    {
        throw new NotImplementedException();
    }
    //The same for all the rest of IConvertible methods
} 
```

JsonConverter 是这样的：

```
using System;
using Newtonsoft.Json;

class ConstantConverter : JsonConverter
{
    public override bool CanConvert(Type objectType)
    {
        return true;
    }

    public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
    {
        throw new NotImplementedException();
    }

    public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
    {
        if (value == null)
        {
            serializer.Serialize(writer, null);
        }
        else
        {
            serializer.Serialize(writer, value.ToString());
        }
    }
} 
```

一个实际的字符串枚举将是这样的：

```
public sealed class Colors : StringEnum
{
    public static Colors Red { get { return new Catalog("Red"); } }
    public static Colors Yellow { get { return new Catalog("Yellow"); } }
    public static Colors White { get { return new Catalog("White"); } }

    private Colors(string value) : base(value) { }
} 
```

有了这个，您可以只使用 Color.Red 甚至序列化为 json 而无需使用 Value 属性

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2016-07-20T02:34:00.993

我不需要任何强大的东西，比如将字符串存储在属性中。我只需要将类似`MyEnum.BillEveryWeek`“每周账单”或“使用遗留系统”之类的东西`MyEnum.UseLegacySystem`变成“使用旧系统”——基本上将枚举按其驼峰式大小写拆分为单独的小写单词。

```
public static string UnCamelCase(this Enum input, string delimiter = " ", bool preserveCasing = false)
{
    var characters = input.ToString().Select((x, i) =>
    {

       if (i > 0 && char.IsUpper(x))
       {
           return delimiter + x.ToString(CultureInfo.InvariantCulture);
       }
       return x.ToString(CultureInfo.InvariantCulture);

    });

    var result = preserveCasing
       ? string.Concat(characters)
       : string.Concat(characters).ToLower();

    var lastComma = result.LastIndexOf(", ", StringComparison.Ordinal);

    if (lastComma > -1)
    {
       result = result.Remove(lastComma, 2).Insert(lastComma, " and ");
    }

    return result;
} 
```

`MyEnum.UseLegacySystem.UnCamelCase()`输出“使用遗留系统”

如果您设置了多个标志，它将把它变成简单的英语（逗号分隔，除了“and”代替最后一个逗号）。

```
var myCustomerBehaviour = MyEnum.BillEveryWeek | MyEnum.UseLegacySystem | MyEnum.ChargeTaxes;

Console.WriteLine(myCustomerBehaviour.UnCamelCase());
//outputs "bill every week, use legacy system and charge taxes" 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2018-07-06T21:31:54.263

我做过这样的事情；

```
public enum BusinessUnits
{
    NEW_EQUIPMENT = 0,
    USED_EQUIPMENT = 1,
    RENTAL_EQUIPMENT = 2,
    PARTS = 3,
    SERVICE = 4,
    OPERATOR_TRAINING = 5
}

public class BusinessUnitService
{
    public static string StringBusinessUnits(BusinessUnits BU)
    {
        switch (BU)
        {
            case BusinessUnits.NEW_EQUIPMENT: return "NEW EQUIPMENT";
            case BusinessUnits.USED_EQUIPMENT: return "USED EQUIPMENT";
            case BusinessUnits.RENTAL_EQUIPMENT: return "RENTAL EQUIPMENT";
            case BusinessUnits.PARTS: return "PARTS";
            case BusinessUnits.SERVICE: return "SERVICE";
            case BusinessUnits.OPERATOR_TRAINING: return "OPERATOR TRAINING";
            default: return String.Empty;
        }
    }
} 
```

用这个调用它；

```
BusinessUnitService.StringBusinessUnits(BusinessUnits.PARTS) 
```

# php - 在 PHP 中将数据对象传递给工厂

> ID：630804
> 
> 赞同：0
> 
> 时间：2009-03-10T15:34:03.670
> 
> 标签：php, refactoring, factory

请帮我实现该任务的工厂设计模式。

我正在开发预定的消息发送 Web 应用程序。用户可以指定自己的预定发送计划，消息将在需要时发送。用户只能选择 3 种重复类型中的一种：每月、每周、每天。对于这 3 种重复类型算法是相似的：1）选择发送日期和时间（对于第一次交付） 2）根据重复类型选择“每 X 个月/周/天重复一次”中的选项 3）按类型指定结束（日期或按出现次数限制）

每周调度程序有点不同。它还有一个功能 - 重复的工作日（例如：每周一、周五重复）

```
class SchedulerFactory {
    public function create($type) {
        switch ($type) {
            case "monthly" :
                $Scheduler = new MonthlyScheduler();
        break;
            case "weekly" :
                $Scheduler = new WeeklyScheduler();
        break;
            case "daily":
                $Scheduler = new DailyScheduler();
        break;
            default:
                return null;
        }
    }
} 
```

设置方法：

```
$SendScheduler->setSendDateAndTime("{$day}.{$month}.{$year}", time());

switch($end_by_type) {
 case 'by_date':
     $SendScheduler-     >setEndByDate("{$end_by_date_day}.{$end_by_date_month}.{$end_by_date_year}");
    break;
case 'by_occurences_limit':
    $SendScheduler->setOccurencesLimit($occurences_quantity);
    break;                  
}

$SendScheduler->addTaskOccuringEvery($RepeatEveryMonth);// repeat every X months/weeks/days depending on type

// only for weekly type
$SendScheduler->setWeekDayForRepeating($week_day); // repeat every Mon, Fri 
```

我想使用工厂模式进行对象构造（它是最佳匹配吗？），并且不知道如何传递所有这些参数（不仅仅是$type，而是所有其他参数）来构造对象。

我应该创建将它们包装在单个数据对象中，并在 SchedulerFactory 类中创建方法“setOptions”并通过 getter 将此数据对象传递给“创建”构造方法吗？

也许在工厂类中创建这样的 setter 方法违反了工厂设计模式原则？我以前没有看到这样的例子，所以我现在有点困惑。

如果我走错了方向，请告诉我。您会为此任务推荐什么解决方案？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T15:49:55.897

我认为您误解了工厂模式。工厂应该只创建对象实例。至于传递更多参数，您可以这样做：

```
class Scheduler {
    public function factory($type, $paramsArr = array()) {
        switch ($type) {
            case 'monthly' : $className = 'MonthlyScheduler'; break;
            case 'weekly' : $className = 'WeeklyScheduler'; break;
            case 'daily' : $className = 'DailyScheduler'; break;
            default: return null;
        }
        $sched = new ReflectionClass($className);  
        return $sched->newInstanceArgs($paramsArr);  ;
    }
} 
```

`$paramsArr`构造函数参数数组在哪里

因此：

```
$yourSched = Scheduler::factory('weekly',array('Monday')); 
```

相当于：

```
$yourSched = new WeeklyScheduler('Monday'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T15:49:20.653

您可以为调度选项创建一个包装器对象，并将其与类型一起传递给 SchedulerFactory.create() 方法。然后，在您的工厂方法中，您将创建调度程序对象并根据类型设置属性，因此所有内容都封装在调度程序工厂中。我想你也可以做一些乱七八糟的事情并使用 PHP 的变量方法参数而不是对象，但这会变得很难看。

我会避免创建 setOptions 方法，因为这需要一个 SchedulerFactory 实例，其中将选项作为对象传递允许工厂（和创建方法）保持静态。

要添加到 vartec 的帖子，因为从您的设计和使用工厂模式来看，调度程序子类属性仅在创建对象后才被读取，您可能希望通过仅在时间设置属性来使每个调度程序不可变创建对象（在构造函数中）。

# silverlight - Alexandria/Silverlight 3 功能列表？

> ID：630805
> 
> 赞同：4
> 
> 时间：2009-03-10T15:35:52.137
> 
> 标签：silverlight, silverlight-3.0

是否有资源列出 Silverlight 3（目前称为 Alexandria）的特性、功能和潜在发布日期？

我的团队目前正在构建一个使用 Silverlight 2 作为部署平台的产品。我们需要研究/为亚历山大做好准备，看看它是否能解决我们的一些问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T15:38:21.663

[ScottGu](http://weblogs.asp.net/scottgu/archive/2008/11/16/update-on-silverlight-2-and-a-glimpse-of-silverlight-3.aspx)是 Silverlight 的无所不知的来源。据我所见，该贴是关于 SL3 的最新最权威的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T15:41:52.263

大多数主要/很酷的功能预计将在下周的 Mix 上公布。

第 9 频道的视频在以下位置列出了一些功能：[http ://channel9.msdn.com/shows/The+Knowledge+Chamber/Brad-Abrams-Silverlight-30-for-Great-Business-Apps/](http://channel9.msdn.com/shows/The+Knowledge+Chamber/Brad-Abrams-Silverlight-30-for-Great-Business-Apps/)

有一些简洁的功能，包括新的 Web 导航项目类型 支持挂钩到后退/前进按钮和深度链接 详细信息控制 对数据网格的增强

他们还有望支持更多的视频格式。

如果他们能改进使用它的工具，现在就会出现一些很酷的东西！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T14:23:17.723

Alexandria 实际上不是 Silverlight 3 的代号。它是 Silverlight 3 所利用的某些技术的代号，而不是 Silverlight 3 本身。

以下是一些重要的会议：

**Silverlight 3 中的新增功能**

Silverlight 3 中所有新功能的摘要。

[http://sessions.visitmix.com/MIX09/T14F](http://sessions.visitmix.com/MIX09/T14F)

**Silverlight 3 中令人惊叹的以业务为中心的应用程序**

涵盖域服务（将服务器数据连接到 Silverlight 客户端）、数据网格、分页、排序、过滤、数据表单控制、验证等。

[http://sessions.visitmix.com/MIX09/T40F](http://sessions.visitmix.com/MIX09/T40F)  

**数据表单控件介绍**

*不是混合会议*，而是对上述会议的深入跟进。深入了解数据表单控件、相关属性等。

[http://silverlight.net/learn/learnvideo.aspx?video=187317](http://silverlight.net/learn/learnvideo.aspx?video=187317)

# java - 比较Java中的两个基元数组？

> ID：630808
> 
> 赞同：20
> 
> 时间：2009-03-10T15:36:37.270
> 
> 标签：java, arrays, compare, primitive-types

我知道 Arrays.deepEquals(Object[], Object[]) 但这不适用于原始类型（由于数组和自动装箱的限制，请参阅[此相关帖子](https://stackoverflow.com/questions/517751/java-generic-method-but-array-of-primitive-data-types-does-not-autobox)）。

考虑到这一点，这是最有效的方法吗？

```
boolean byteArrayEquals(byte[] a, byte[] b) {
    if (a == null && b == null)
        return true;

    if (a == null || b == null)
        return false;

    if (a.length != b.length)
        return false;

    for (int i = 0; i < a.length; i++) {
        if (a[i] != b[i])
            return false;
    }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-10T15:39:05.843

将您的第一个比较更改为：

```
if (a == b)
    return true; 
```

这不仅捕获了“都为空”的情况，而且还捕获了“将数组与其自身进行比较”的情况。

但是，对于更简单的替代方案 - 使用[`Arrays.equals`](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#equals(byte[],%20byte[]))每个原始类型都有重载。（实现与您的非常相似，除了它将数组长度提升到循环之外。在 .NET 上，这可能是一种反优化，但我猜 JRE 库实现者可能更了解 JVM :)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-10T15:42:04.243

我认为最有效的应该是使用[Arrays](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Arrays.html)类中的辅助方法，因为它们可能会更巧妙地实现。所以在这种情况下，使用

```
Arrays.equals(a, b); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-12T15:03:21.983

我不知道这是否会帮助任何人，但这似乎有效：

```
 if(type == type_BooleanArray) {
            boolean eq = Arrays.equals((boolean[]) thisObj, (boolean[]) thatObj);
            if(!eq) {
                return false;
            }
        } else if(type == type_ByteArray) {
            boolean eq = Arrays.equals((byte[]) thisObj, (byte[]) thatObj);
            if(!eq) {
                return false;
            }
        } else if(type == type_ShortArray) {
            boolean eq = Arrays.equals((short[]) thisObj, (short[]) thatObj);
            if(!eq) {
                return false;
            }
        } else if(type == type_CharArray) {
            boolean eq = Arrays.equals((char[]) thisObj, (char[]) thatObj);
            if(!eq) {
                return false;
            }
        } else if(type == type_IntArray) {
            boolean eq = Arrays.equals((int[]) thisObj, (int[]) thatObj);
            if(!eq) {
                return false;
            }
        } else if(type == type_LongArray) {
            boolean eq = Arrays.equals((long[]) thisObj, (long[]) thatObj);
            if(!eq) {
                return false;
            }
        } else if(type == type_FloatArray) {
            boolean eq = Arrays.equals((float[]) thisObj, (float[]) thatObj);
            if(!eq) {
                return false;
            }
        } else if(type == type_DoubleArray) {
            boolean eq = Arrays.equals((double[]) thisObj, (double[]) thatObj);
            if(!eq) {
                return false;
            }
        } else {
            if(!thisObj.equals(thatObj)) {
                return false;
            }
        } 
```

显然`array.equals(otherArray)`做了 a `array == otherArray`，而不是你所期望的。

# sql - 连接具有不同结构的临时表

> ID：630812
> 
> 赞同：0
> 
> 时间：2009-03-10T15:37:01.370
> 
> 标签：sql, sql-server, sql-server-2005

我有 2 个临时表。一个有数据列。

```
OrderCode   OrderType
ABC         1000 
```

一个有数据行明智

```
FieldName   Value
ORDER_CODE  ABC
ORDER_TYPE  2000 
```

我需要编写一个查询，该查询基本上将它们连接起来并更新值（如果它存在于表 2 中）。

记录集结果需要

```
OrderCode  OrderType
ABC        2000 
```

编辑-

如果表 1 中有 2 个订单具有相同的订单代码：

```
OrderCode   OrderType
ABC         1000
ABC     5000 
```

结果集需要是

```
 OrderCode   OrderType
   ABC         2000
   ABC         2000 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T15:40:22.907

要选择行集：

```
SELECT  tt1.ordercode, tt2_type.Value
FROM    Table2 AS tt2_code
JOIN    Table1 tt1
ON      tt1.orderCode = tt2_code.value
JOIN
        Table2 AS tt2_type
ON      tt2_type.fieldName = 'ORDER_TYPE'
WHERE   tt2_code.fieldName = 'ORDER_CODE' 
```

`Table1`根据来自 的值进行更新`Table2`：

```
WITH q AS
    (
    SELECT  tt1.ordercode, tt2_type.Value
    FROM    Table2 AS tt2_code
    JOIN    Table1 tt1
    ON      tt1.orderCode = tt2_code.value
    JOIN
            Table2 AS tt2_type
    ON      tt2_type.fieldName = 'ORDER_TYPE'
    WHERE   tt2_code.fieldName = 'ORDER_CODE'
    )
UPDATE q
SET    oldvalue = newvalue 
```

这是`JOIN`-less 语法更易读的情况之一。

# mysql - 如何在 where 子句中使用临时列

> ID：630815
> 
> 赞同：10
> 
> 时间：2009-03-10T15:37:45.300
> 
> 标签：mysql, sql, mysql-error-1054

为什么不能在 where 子句中使用临时列？

例如，这个查询：

```
Select 
    product_brand, 
    (CASE WHEN COUNT(product_brand)>50 THEN 1 ELSE 0 END) AS brand_count 
FROM 
    products 
WHERE 
    1 
GROUP BY 
    product_brand 
```

这会产生两列，一列称为`product_brand`，一列称为`brand_count`。`brand_count`是动态创建的，始终为 1 或 0，具体取决于是否有 50 个或具有该品牌的产品。

所有这一切对我来说都很有意义，除了我不能只`brand_count = 1`在下面的查询中选择：

```
Select 
    product_brand, 
   (CASE WHEN COUNT(product_brand)>50 THEN 1 ELSE 0 END) AS brand_count 
FROM 
    products 
WHERE 
   brand_count = 1 
GROUP BY 
   product_brand 
```

这给了我这个错误：

```
#1054 - Unknown column 'brand_count' in 'where clause' 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-10T15:40:44.670

改用`HAVING`：

```
Select
    product_brand,
    (CASE WHEN COUNT(product_brand)>50 THEN 1 ELSE 0 END) AS brand_count
  FROM products
  GROUP BY product_brand
  HAVING brand_count = 1 
```

`WHERE`在. *_* _ 之后进行评估。`GROUP BY``HAVING`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T15:40:50.597

因为在 SQL 中，列首先是“选定的”，然后是“投影的”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T15:41:09.707

您必须使用完整的子句，因此您需要：

```
Select 
  product_brand, 
  (CASE WHEN COUNT(product_brand)>50 THEN 1 ELSE 0 END) AS brand_count 
FROM products 
WHERE 
  (CASE WHEN COUNT(product_brand)>50 THEN 1 ELSE 0 END)  = 1 
GROUP BY product_brand 
```

这对于任何 SQL 语句中的任何计算字段都是相同的。

简化：

```
Select Max(Points) as Highest where Highest > 10 
```

不会工作，但是：

```
Select Max(Points) as Highest where Max(Points) > 10 
```

将要。在你的情况下也是一样的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T15:40:33.453

因为在完成处理之前它不知道该列是什么。

如果您想按该名称访问该列，则必须使用子查询，否则您将不得不在没有您给它的名称的情况下限定该列，重复您的 case 语句。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T15:48:41.780

如果我正确阅读了您的意图，您可以重新编写此查询以读取：

```
Select 
 product_brand,
 COUNT(product_brand) AS brand_count 
FROM 
 products 
GROUP BY 
 product_brand
HAVING 
 COUNT(product_brand) > 50 
```

这将为您提供所有`product_brands`拥有 a 的`count > 50`人，还将向您显示每个人的计数。

# php - 即时创建和存储图像

> ID：630818
> 
> 赞同：0
> 
> 时间：2009-03-10T15:38:04.067
> 
> 标签：php, image

我将如何捕获对不存在的图像的请求并根据需要创建它们以免返回 404？然后这些将存储在服务器上，直到不再需要并被删除。代码最好使用 PHP。删除很可能发生在 cron 作业中。

图像将一次请求 10 个左右的批次，名称为 084a007b0138024f0a.jpg。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T15:40:13.920

编辑您的 htaccess，以便在该文件夹中对任何图像的请求都被重定向到 PHP 脚本。

然后，在您的脚本中，创建图像 ( [http://php.net/image/](http://php.net/image/) ) 并简单地**回**显它。

# vb.net - 不同项目中消息框按钮的不同样式

> ID：630820
> 
> 赞同：0
> 
> 时间：2009-03-10T15:38:20.307
> 
> 标签：vb.net, button, coding-style, messagebox

我对消息框中按钮的样式有疑问。如果我在当前项目中调用以下代码行，按钮将获得一种视觉外观/样式。如果我创建一个新的 VB.NET Windows 应用程序项目，它将获得标准的 Windows 外观/样式。

```
Windows.Forms.MessageBox.Show("Yaay", "Yaay!", Windows.Forms.MessageBoxButtons.OK) 
```

请参阅下面的按钮之间的区别。我怀疑他们从其父级或某些项目设置继承了视觉外观。但我一直无法从哪里找到。

这两个项目都是在 VB.NET 2.0 中创建的，并且都具有相同的 System.Windows.Forms - dll 作为参考（c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Windows.Forms.dll）。

[http://www.freeimagehosting.net/uploads/2a956b0675.jpg](http://www.freeimagehosting.net/uploads/2a956b0675.jpg) 可以在[这里](http://www.freeimagehosting.net/uploads/2a956b0675.jpg)找到截图。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T20:38:51.520

我无法从我所在的位置看到图像，所以我不确定这是否会对您有所帮助。

打开每个解决方案的项目属性并查看应用程序选项卡。

是否勾选了“启用应用程序框架”项？如果是这样，是否也勾选了“启用 XP 视觉样式”项？

这可能是两种解决方案的区别。

# iphone - iPhone，您如何使用 coregraphics 从纹理页面中绘制？

> ID：630825
> 
> 赞同：0
> 
> 时间：2009-03-10T15:38:47.997
> 
> 标签：iphone, rendering, core-graphics, texture-mapping

我正在尝试研究如何使用 CoreGraphics 从 TexturePage 中进行绘制。

给定一个包含多个 64x64 打包纹理的纹理页面 (CGImageRef)，我如何将该页面中的子区域渲染到设备上下文中。

CGContextDrawImage 似乎只需要一个目标矩形。我注意到 CGImageCreateWithImageInRect，但是这会创建一个新图像。我不想要一个新图像，我只想从原始图像中绘制。

我确信这是可能的，但是我是 iPhone 开发的新手。

非常感谢任何帮助。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T20:23:04.787

有什么问题`CGImageCreateWithImageInRect`？

```
CGImageRef subImage = CGImageCreateWithImageInRect(image, srcRect);
if (subImage) {
    CGContextDrawImage(context, destRect, subImage);
    CFRelease(subImage);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T15:55:51.637

编辑：等一下。使用 CGImageCreateWithImageInRect。这就是它的用途。

这是我最初写的想法；我会留下它们以防它们有用。

*   看看您是否可以从另一个图像创建某种子图像，以便它借用原始图像的缓冲区（很像一些子字符串实现）。然后您可以使用子图像进行绘制。
*   可能 Core Graphics 更多地用于合成而不是图像处理，因此您可能必须在应用程序包中使用单独的图像文件。如果 SDK 文档没有特别推荐你正在做的事情，那么我建议你走那条路，因为这似乎是最简单和自然的方式。
*   您可以改用 OpenGLES，在这种情况下，您可以指定多边形顶点的纹理坐标以仅选择大纹理的那一部分。

# c# - Linq to sql：可能为空的属性的属性

> ID：630827
> 
> 赞同：3
> 
> 时间：2009-03-10T15:39:09.510
> 
> 标签：c#, linq-to-sql

简单的 LINQ 查询：

```
from transport in db.Transports
 select new
 {
    Current = transport.CurrentLocation,
    CurrentCarriers = transport.CurrentLocation.Carriers,
  }; 
```

问题：`CurrentLocation`可能为空。如果是，则执行此查询会引发 NullReference。我尝试添加一个像

```
transport.CurrentLocation == null ? null : transport.CurrentLocation.Carriers 
```

但 Linq to sql 似乎无法解析。

任何不涉及为每个传输发送额外查询的好解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T18:47:08.200

我通常只使用“让”。

```
from x in Foo
let y = x.Bar
where y != null
select y.Baz; 
```

更新：

我觉得 ？？运算符确实转换为 SQL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T21:01:08.940

如果 Transports 上的外键可以为空，则必须先检查该列是否为空，然后才能尝试获取 CurrentLocation 对象。

你可以这样做：

```
CurrentLocation = transport.currentLocationId != null ? transport.CurrentLocation : null; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T15:49:40.653

就这样做（你在哪里使用了错误的属性）：

运输.CurrentLocation == null ？空：transport.CurrentLocation.Carriers

**更新 1：**这很奇怪，我使用了一些非常复杂的查询并且没有遇到这个问题。我只是检查了一个，认为这不重要，但我的检查倒置了：

运输.CurrentLocation ！= null ？transport.CurrentLocation.Carriers：空；

你能发布你尝试过的完整查询，它会给你解析异常吗？

# asp.net-mvc - 如何在 ASP.NET MVC RC 1.0 中使用动态母版页

> ID：630833
> 
> 赞同：1
> 
> 时间：2009-03-10T15:40:27.853
> 
> 标签：asp.net-mvc, master-pages

我不知道如何在 ASP.NET MVC RC 1.0 中使用动态母版页。请帮忙！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-28T04:55:27.720

您可以在使用 View() 辅助方法时指定母版页的名称：

```
return View("About", "AlternateMaster", model); 
```

AlternateMaster 将解析为 ~/Views/Shared/AlternateMaster.master

[在这里找到这个](http://forums.asp.net/t/1399132.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-02-17T13:42:35.067

我通过创建一个处理 OnActionExecuted 事件的基本控制器来实现这一点。在 OnActionExecutedevent 中，我分配了母版页。然后我让我所有的其他控制器都从基类继承。

```
public class BaseController : Controller
{
     protected override void OnActionExecuted(ActionExecutedContext filterContext) {
         var action = filterContext.Result as ViewResult;
         if (action != null) {
             action.MasterName = MyApp.Properties.Settings.Default.Theme;
         }  

         base.OnActionExecuted(filterContext);
     }
} 
```

如果您想了解更多详细信息[，我写了一篇关于此的帖子](http://www.codecapers.com/post/Dynamic-Master-Pages-in-MVC.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T05:20:15.233

在[http://forums.asp.net/p/1394235/2991293.aspx](http://forums.asp.net/p/1394235/2991293.aspx)上讨论了一个合理可维护的解决方案，您可以在其中创建一个公共站点主后代并将其用于您自己的所有视图。还有一个看起来很有趣的 CodeProject 条目，它在[http://www.codeproject.com/KB/aspnet/ASPNETMVCDynamicThemes.aspx](http://www.codeproject.com/KB/aspnet/ASPNETMVCDynamicThemes.aspx)使用自定义 ViewEngine 。

我也需要这样做，但我还没有尝试过任何一种解决方案，所以我还没有感觉哪个更好。IMO，动态皮肤是 MVC 的一个关键特性，特别是为了迎合用户个性化。

# .net - HttpContext 与 HttpListenerContext

> ID：630845
> 
> 赞同：5
> 
> 时间：2009-03-10T15:42:38.423
> 
> 标签：.net, http, iis

在将 webapp 从 IIS/asp.net 移植到 HttpListener 时，我觉得有些奇怪。

虽然两者都有上下文、请求和响应的概念，但 HttpListener 变体与 IIS/asp.net 变体没有共同的接口，尽管接口几乎相同。

为了解决这个问题，我创建了自己的通用接口（IContext、IRequest 和 IResponse），并用这些接口的实现包装了相应的服务器生成的对象，这样我就不需要处理程序代码的两个单独的实现了我正在移植。

这导致了包装器（总共 10 个）的类爆炸，只是为了围绕这个缺少的公共接口进行编码。

我是否错过了一个技巧，或者这只是 .net API 的一个缺点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T15:46:24.373

我会说整个HttpContext都有这个缺点。添加单元测试时发生的情况相同，您将它们包装起来以便能够在单元测试中用模拟替换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-19T23:57:19.910

在编写需要与 IIS ( `IHttpAsyncHandler`) 和独立() 兼容的处理程序时，我遇到了相同的 .NET 设计限制`HttpListener`。我采用相同的方法为两者编写通用包装器。这似乎确实是 .NET API 的一个缺点。

# oracle - 搜索 PL/SQL 代码

> ID：630847
> 
> 赞同：15
> 
> 时间：2009-03-10T15:43:09.640
> 
> 标签：oracle, search, plsql

SELECT * from ALL_OBJECTS 返回各种过程/包/表/其他数据库对象的名称。我想在 PL/SQL 代码中查找匹配的字符串。我该怎么做呢？

类似于：（伪代码）SELECT * FROM all_code WHERE line_of_code like '%mytext%'

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-10T15:50:11.917

使用类似的东西：

```
 SELECT * 
      FROM USER_SOURCE 
     WHERE type='PACKAGE' 
       AND NAME='PACKAGE_NAME' 
  ORDER BY type, name, line; 
```

有很多选项，请查看 USER_SOURCE 表。

要搜索字符串的所有代码：

```
 SELECT *
    FROM ALL_SOURCE
   WHERE UPPER(text) LIKE UPPER('%what I am searching for%')
ORDER BY type, name, line 
```

请注意，表中不包含视图代码`_SOURCE`。视图代码存储在`[USER|ALL|DBA]_VIEWS.TEXT`其中是一个长列，难以查询。

# c# - 通过 quickbooks SDK 使用重音字符

> ID：630854
> 
> 赞同：4
> 
> 时间：2009-03-10T15:43:56.347
> 
> 标签：c#, sdk, quickbooks, qbfc

使用 Quickbooks SDK QBFC 7.0。当我尝试在快速手册中获取所有客户的列表时，如果任何客户的名字中有重音字符，例如 è，那么我会得到一个例外：

```
An Exception occurred! Type:UTFDataFormatException, Message: invalid byte 2 (<) 
of a 3-byte sequence. SAXParseException: error ar line 1, column 23 in XML data. 
```

几个 Intuit 论坛说我必须将 XML 更改为 UTF-8（他们只是这么说，他们没有给出真正的解决方案），QBFC 显然确实使用 XML 来发送和接收数据，但我无论如何都找不到覆盖默认编码。

该请求是使用以下代码创建的。异常发生在 DoRequests()

```
IMsgSetRequest req = Session.GetLatestMsgSetRequest();
ICustomerQuery cq = req.AppendCustomerQueryRq();
IMsgSetResponse responseSet = Session.QBSM.DoRequests(req); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-28T14:03:20.730

QBFC 有一个错误，它无法正确编码。没有办法用 QBFC 覆盖编码。您拥有的解决方案是使用 qbXML，或者如果您在创建查询时使用 IncludeRetElementList 选项，它应该正确编码。请记住，如果您使用 IncludeRetElementList，则必须指定要返回的确切字段。

```
ICustomerQuery custQuery = MsgRequest.AppendCustomerQueryRq();
custQuery.IncludeRetElementList.Add("ListID");
custQuery.IncludeRetElementList.Add("Name");
custQuery.IncludeRetElementList.Add("FirstName");
custQuery.IncludeRetElementList.Add("LastName");
custQuery.IncludeRetElementList.Add("ShipAddress"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T20:31:39.923

我不知道 QBFC 中的解决方案，但作为一种解决方法，您可以直接转到 qbXML，并使用 XML 发送和接收此特定消息的响应。听起来您在 QBFC 中有一个限制，它实际上是底层 XML 的包装器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-15T08:04:22.100

当我试图查看试算表报告时出现溢出，一些帐户显示溢出，因为它没有显示任何数字。

你认为是一个问题。

谢谢

理查德

# msbuild - msbuild 和 cruiscontrol.net

> ID：630867
> 
> 赞同：0
> 
> 时间：2009-03-10T15:48:29.830
> 
> 标签：msbuild, cruisecontrol.net

我正在尝试调用一个批处理文件 insdie Cruisecontrol，并且所有批处理文件都在 .sln C# 项目上调用 msbuild。我无法让它工作，我收到以下错误：
“msBuild”不被识别为内部或外部命令有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T15:49:49.717

为什么在有 MSBuild 任务时调用批处理文件？

[http://confluence.public.thoughtworks.org/display/CCNET/MsBuild+Task](http://confluence.public.thoughtworks.org/display/CCNET/MsBuild+Task)

此外 - 您可能希望确保批处理文件在 CruiseControl.Net 之外工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T15:52:10.680

您必须指定 msbuild 的完整路径：

C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T15:50:39.170

听起来“msbuild”不在您的搜索路径中。更新“路径”环境变量或指定 msbuild.exe 文件的完整路径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T16:06:24.763

如果有帮助，这是我的 msbuild 任务之一的示例...

```
<tasks>
  <msbuild>
    <executable>C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe</executable>
    <workingDirectory>D:\INETPUB\wwwroot\CruiseControl\Utilities\</workingDirectory>
    <projectFile>Utilities.csproj</projectFile>
    <timeout>900</timeout>
    <logger>C:\Program Files\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MsBuild.dll</logger>
  </msbuild>
  <artifactcleanup   cleanUpMethod="KeepLastXBuilds"   cleanUpValue="5" />
</tasks> 
```

这应该嵌套在您的项目节点下。 [布兰登乔伊斯](http://blog.sonerdy.com)

# .net - 正则表达式用单个字符替换连续的非 alpha 字符

> ID：630880
> 
> 赞同：1
> 
> 时间：2009-03-10T15:50:49.137
> 
> 标签：.net, regex

我想用加号“+”替换字符串中的所有非字母字符，但要确保一组多个非字母字符只被一个加号替换。

我曾认为以下可能有效，但显然不是：

```
System.Text.RegularExpressions.Regex.Replace(name, @"[^\w]*?", "+") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T15:52:09.993

尝试 System.Text.RegularExpressions.Regex.Replace(name, @"\W+", "+")

为此： "sasa-==[] *&^asdsa2435" 匹配 -==[]* &^

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T15:56:21.387

你不应该禁用贪婪，你想要 1 或更多，而不是 0 或更多。代替 ”*？” 用“+”。

# .net - 用于 oracle 的 Sqlprofiler

> ID：630881
> 
> 赞同：2
> 
> 时间：2009-03-10T15:51:01.133
> 
> 标签：.net, oracle, sql-server-profiler

我最近在 .net 中使用 Oracle 数据库启动了一个新的开发项目。我以前从未使用过 oracle，我想知道是否也有类似 sqlprofiler 的 oracle 工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T15:56:30.577

Oracle 提供[SQLDeveloper](http://www.oracle.com/technology/products/database/sql_developer/index.html)，其中包括`EXPLAIN`工具和`AUTOTRACE`工具等。

如果你买得起PS [TOAD](http://www.toadsoft.com/)就很好（至少这是我最后一次买得起）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T07:41:08.573

与分析相关，更笼统一些，因为涉及*一般性能调整*-[自动性能统计](http://download.oracle.com/docs/cd/B28359_01/server.111/b28274/autostat.htm)。即使您不想使用它，它也会让您了解与系统性能相关的重要视图和事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T14:55:19.800

在 Oracle 中分析您的应用程序的最佳方法是[sql tracking](http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/sqltrace.htm#PFGRF01020)。sql 跟踪为您提供应用程序执行了哪些语句、这些语句经过的时间、它们等待的时间以及等待的时间。我提供的链接是阅读有关 sql 跟踪的良好开端。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-18T23:58:25.763

大多数本机跟踪功能面临的挑战是它们施加的性能负载，因此不适合对大容量、关键任务生产系统进行 24x7 查询监控。

市场上有第三方工具也提供配置文件/跟踪功能。其中一些工具也会给系统带来性能负担，因此通常只会通过轮询 dbms 来获取定期快照；其他工具以非侵入方式监视数据库查询（因此对系统施加零/最小负载）并且可以在“始终在线”的基础上使用。

您需要确定额外的性能负载是否可以接受。如果是这样，那么请使用本机功能或更便宜的第三方工具。如果您使用的是高事务、关键任务生产系统，那么请查看非侵入式工具。

全面披露：我为提供此类工具的供应商之一工作。供应商使用各种机制来确保他们的性能监控是非侵入性的。我们的不会打开与数据库的连接，也不会以任何方式轮询它；相反，我们监听网络流量以被动捕获查询并计算相关的性能指标（例如服务器反应时间、查询响应时间、往返时间等）。我们专注于高事务/大容量生产数据库监控——引用我在其他地方看到的一位博主的话，“你不能让里程表减慢汽车的速度”。有关我们的更多信息，请访问：[http ://www.exact-solutions.com/products/iwatch](http://www.exact-solutions.com/products/iwatch)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T13:07:53.393

除了扩展的 SQL Trace 和 TKPROF，您还可以使用 Oracle 提供的包 DBMS_PROFILER 分析 PL/SQL 代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-19T01:53:48.087

还要看看企业经理。它有很多方便的工具，可以在代码运行时动态检查和调整代码。它必须由您的 DBA 配置。

# vim - 在垂直拆分窗口中打开 Vim 帮助

> ID：630884
> 
> 赞同：121
> 
> 时间：2009-03-10T15:51:26.873
> 
> 标签：vim

有没有办法让 Vim 帮助在垂直拆分窗格而不是水平拆分窗格中打开？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-03-10T15:56:12.980

[`:vertical`( `vert`)](http://vimdoc.sourceforge.net/htmldoc/windows.html#:vertical)作品：

```
:vert help 
```

您还可以使用[`topleft`( `to`)](http://vimdoc.sourceforge.net/htmldoc/windows.html#:topleft)和[`botright`( `bo`)](http://vimdoc.sourceforge.net/htmldoc/windows.html#:botright)控制窗口是在左/上还是右/下拆分。例如，要在垂直拆分的右侧窗口中打开帮助：

```
:vert bo help 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2014-02-18T02:59:09.803

作为 Haroogan 和 Sean 的答案的替代方案，您可以将`FileType`事件用于自动命令，如下所示：

```
autocmd FileType help wincmd L 
```

尽管如果您正在查看的文件发生更改，这将更改任何帮助窗口的位置以及在手动放置后移动窗口。但我相信这是任何解决方案的问题。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-09-14T02:00:30.927

无需重新映射任何命令或引入奇怪的别名，如`:Help`. 这是解决方案。创建`~/.vim/after/ftplugin/help.vim`可以覆盖任何 Vim 设置的位置，特别是在`help`其中添加以下行：

```
autocmd BufWinEnter <buffer> wincmd L 
```

这个钩子将确保任何`help`文件都以垂直拆分方式打开。此外，它没有肖恩的回答中描述的副作用。就个人而言，到目前为止，这对我来说是完美的解决方案。

希望这可以帮助。祝你好运。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-03-10T16:02:36.753

这个命令应该这样做：

```
:vert help 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-01-30T10:30:56.417

把它放在你的`.vimrc`：

```
command -nargs=* -complete=help Help vertical belowright help <args> 
```

现在您可以使用命令打开垂直帮助`:Help`（注意第一个字母是大写的）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-03-19T05:51:50.653

将以下内容放入您的`~/.vim/ftplugin/help.vim`

```
wincmd L 
```

没有比这更简单的了：）

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-01-28T00:14:47.613

要使帮助文件始终在右侧垂直拆分中打开，请将其放入您的 vimrc：

```
augroup helpfiles
  au!
  au BufRead,BufEnter */doc/* wincmd L
augroup END 
```

这将产生在其路径中以垂直拆分打开任何带有“doc”的东西的副作用，但这对您来说可能不是问题。它不适合我。如果您希望它以左垂直拆分或其他任何方式打开，您可以更改`wincmd L`. 您可以通过以下方式了解更多信息`:he wincmd`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-07-17T05:46:37.287

这将帮助窗口移动*一次*。因此，您可以在创建窗口后自由移动它。

```
if has('autocmd')
  function! ILikeHelpToTheRight()
    if !exists('w:help_is_moved') || w:help_is_moved != "right"
      wincmd L
      let w:help_is_moved = "right"
    endif
  endfunction

  augroup HelpPages
    autocmd FileType help nested call ILikeHelpToTheRight()
  augroup END
endif 
```

该函数每个窗口`ILikeHelpToTheRight()`只会运行`wincmd L`一次（这是`w:`前缀的用途）。

每当打开“帮助”文件时都会调用它。这没有 EdJoJob 解决方案的副作用。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-11-20T19:50:50.743

如果当前选项卡中有多个窗口，则在顶部动态打开帮助窗口，如果只有一个窗口，则在右侧打开：

```
if winnr('$') > 2
    wincmd K
else
    wincmd L
endif 
```

您需要将其放入`ftplugin/help.vim`或与 一起使用`autocmd`，例如：

```
augroup my_filetype_settings
autocmd!
autocmd FileType help if winnr('$') > 2 | wincmd K | else | wincmd L | endif
augroup END 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-09-17T22:07:32.510

*这是为了添加到@m42 的答案中，但我还没有 50 个代表在这里添加评论。*

添加`nnoremap <C-H> :vert bo help`到 .vimrc

现在在普通模式下按 Ctrl-H 将跳转到命令模式，前缀是在右侧的垂直拆分窗口中打开帮助。在配置行末尾的 <--之后包含一个尾随空格，`help·`以获得最佳效果。

此映射允许您仍然使用`:help`\`:h`打开水平拆分窗口或循环浏览以前的帮助命令历史记录，而无需提示自动扩展。

# ruby-on-rails - 如何通过SVN提供软件drop？

> ID：630886
> 
> 赞同：4
> 
> 时间：2009-03-10T15:51:34.080
> 
> 标签：ruby-on-rails, svn

交付软件应该快速而简单。否则花时间手动构建包是很烦人的。所以我想使用 SVN 将我的 rails 项目交付到生产环境中。

这个想法是运营人员只需通过执行以下操作来检查初始项目：

```
svn co https://my-server/vs/my-project/tags/1.0.0 
```

之后，这些人可以更改该本地 SVN 工作区中的配置设置的适当文件。

如果有新的软件版本可用，我们只需分发（在自述文件旁边）它的新版本号，例如版本 1.0.1。要更新生产机器，操作团队只需通过执行以下命令切换到适当的工作区：

```
svn switch https://my-server/vs/my-project/tags/1.0.1 
```

（当然，在更新之前必须停止正在运行的服务器，并且在更新之后必须完成一些迁移，等等）。我想指出的是，没有必要交付和提取 TAR 球，并且以前的配置设置保留在原处或将与新的配置行合并（好的，这可能会导致必须解决的冲突）。

是否有任何（进一步的）缺点/陷阱？你有更好的方法使用 SVN 来发布软件吗？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T16:02:00.470

这种方法的一个缺点（您可能还没有遇到）是，当您将应用程序扩展到多个服务器时，这种方法对于操作来说会变得乏味。如果你突然需要 4 台前端服务器和 2 台数据库服务器，你的 Ops 团队将不得不通过 ssh 连接到所有四台机器，配置它们，然后配置数据库机器。

如果这是您在不久的将来会担心的事情，我会考虑使用[Capistrano](http://www.capify.org/)之类的东西，它可以让您一次在多台机器上部署和配置应用程序。

即使在一台服务器上为您的应用程序采用 Capistrano 的优势在于，您可以在一个脚本中从 subversion 获取、配置应用程序和设置数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T16:02:25.070

不要将配置文件保存在 repo 中。我通常将 database.yml 重命名为 database-example.yml 并将其放入我的仓库中。

只要确保他们没有将其添加到存储库中，大概是只授予他们读取权限。

另一种选择是[capistrano](http://www.capify.org)。当你想要他们的服务器而不是他们拉更新时，你可以只推送部署。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T16:03:22.540

查看[Capistrano](http://www.capify.org/)以部署您的 Rails 应用程序。易于与 SVN 集成。使整个事情自动化。我更新了我的稳定分支，发出“cap deploy”命令，就完成了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-27T10:51:35.233

我同意其他人关于使用 Capistrano 自动化您的方法的评论。它工作得很好。如果您想要 Capistrano 的 Web 界面，请查看[Webistrano](http://labs.peritor.com/webistrano/)。这是一个 Ruby on Rails 应用程序，它集中 Capistrano 脚本，并提供日志记录、问责制和一些访问控制。所有这些都通过一个漂亮的网络界面。

We use it to deploy dozens of websites to multiple servers. The initial setup takes a bit of work, since you'll need to setup a way to run the Rails application (for example via Passenger). Webistrano is quite user friendly though, and works well. We've deployed over 2300 times so far.

# c# - SSRS - 最后一页不显示在打印预览中

> ID：630889
> 
> 赞同：0
> 
> 时间：2009-03-10T15:51:55.593
> 
> 标签：c#, vb.net, reporting-services

我们正在使用通过 Win32 VB.net 页面上的 Report Viewer 控件嵌入的 SQL Server Reporting Services。目前针对 .net 2.0，如果它能够解决问题，我们可能会迁移到 3.5。

当您查看报告时，您可以看到整个内容，但是，当按下打印预览时，报告的最后一页无法显示。报告底部的页码将显示“第 1 页，共 2 页”或“第 1 页，共 N”，但您实际上只能看到第 1 页到第 N-1 页。

当您尝试打印报告时也会发生同样的事情。但是如果我去打印预览，回到正常视图，然后再次打印预览，我可以看到整个报告。

我该如何解决？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T16:58:28.400

似乎将 Microsoft.ReportViewer.WinForms 的引用 DLL 从 V8 更改为 V9 是可行的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T16:04:37.200

我遇到了类似的问题。

如果您调用 SetDisplayMode() 方法将报表查看器置于打印布局模式，然后调用 RefreshReport() 方法，则可能会导致此行为。SetDisplayMode() 自动调用 RefreshReport()，因此 RefreshReport 被调用了两次。这可能会导致一些最后的页面不显示。因此，只需调用 SetDisplayMode() 并保留它。

# language-agnostic - 如何检测网络上的设备？

> ID：630894
> 
> 赞同：1
> 
> 时间：2009-03-10T15:52:31.770
> 
> 标签：language-agnostic, networking, plug-and-play

某些打印机包含一张 CD，它能够检测未分配 IP 地址或 LAN 中 IP 无效的设备。

我们正在开发一种设备，希望能够让用户以相同的方式操作：他们将设备连接到网络上，然后从客户端一个微型软件检测配置、启动向导，...

我怎样才能做到这一点？如何编写一些软件来检测网络上的设备并进行配置？有什么指导方针吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T17:19:28.300

听起来您想让您的硬件支持通用即插即用（或类似）技术。在这里查看：[http ://www.upnp.org/resources/default.asp](http://www.upnp.org/resources/default.asp)

通用即插即用实际上是您所描述的场景：硬件可以自己进入网络并宣布自己。如果您的配置软件正在运行，则会看到该公告，您可以从该点完成配置。在大多数情况下，这包括在可能的情况下获取 DHCP 地址（并​​在其加入的子网上广播）或在 DHCP 拒绝新硬件或不存在时获取自动配置地址 (169.254.xx)。

我强烈建议阅读我提供的 URL 上的文档，如果只是为了让您了解如何做事，即使您没有实现完整的 UPnP 协议。

# sql - MSSQL - 将一个字段拆分为 3 个字段

> ID：630907
> 
> 赞同：3
> 
> 时间：2009-03-10T15:54:50.797
> 
> 标签：sql, sql-server, tsql

我有一个包含 1 列的结果集，在这种情况下为 2 行，单列 [ProductDescription] 是一个包含 3 条信息的 varchar 字段（我没有设计它）我需要将这 3 条信息取出到 3使用查询的附加字段

前

```
/------------------------------\
|产品说明 |
|------------------------------------------|
|DB1 - DB2 - DB3 |
|数据位 1 - 数据位 2 - 数据位 3|
\------------------------------------------/

```

后

```
/---------------------------------------------------- --------\
|字段1 |字段2 |字段3 |产品描述|  
|------------------------------------------------- --------|  
|DB1 |DB2 |DB3 |DB1 - DB2 - DB3 |  
|DataBit1|DataBit2|DataBit3|DataBit1 - DataBit2 - DataBit3|  
\-------------------------------------------------- --------/

```

我曾尝试使用 Substring 和 charindex 的组合，但未能完全正确，该字段的每个部分都可以是任意长度，因此使用硬编码偏移量不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T16:54:00.780

这并不漂亮，但它确实有效，并且它确实为您提供了您正在寻找的东西，对于您的具体情况......如果您的 ProductDescription 中有可变数量的令牌，您可能需要创建一个存储的过程来管理解析字符串时的状态，因为这会很快变得难以管理。

```
create table #table(productdescription varchar(255))
go
/* Demonstrate it working in a 'pretty' case */
INSERT INTO #TABLE (ProductDescription) values ('abc - def - ghi')
go

/* Demonstrate it working in a 'ugly' case */
insert into #table (ProductDescription) values ('jklsaf -mnoa-psdfaqr')
go

SELECT RTRIM(LTRIM(SUBSTRING(ProductDescription, 0, CHARINDEX('-', ProductDescription)-1))) as Field1,

RTRIM(LTRIM(SUBSTRING(ProductDescription, CHARINDEX('-', ProductDescription)+1, (CHARINDEX('-', ProductDescription, CHARINDEX('-', ProductDescription)+1)) - (CHARINDEX('-', ProductDescription)+1)))) as Field2,

RTRIM(LTRIM(SUBSTRING(ProductDescription, CHARINDEX('-', ProductDescription, CHARINDEX('-', ProductDescription)+1)+1, LEN(ProductDescription)))) as Field3
FROM #table
go 
```

我希望这有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T17:05:41.877

假设您的列中始终包含三条信息`ProductDescription`并且分隔符始终为“ - ”，那么以下应该可以解决问题：

```
SELECT
    SUBSTRING(ProductDescription, 1,
        CHARINDEX(' - ', ProductDescription) - 1
    ) AS Field1,
    SUBSTRING(ProductDescription,
        CHARINDEX(' - ', ProductDescription) + 3,
        CHARINDEX(' - ', ProductDescription,
            CHARINDEX(' - ', ProductDescription) + 3
        ) - (CHARINDEX(' - ', ProductDescription) + 3)
    ) AS Field2,
    SUBSTRING(ProductDescription,
        CHARINDEX(' - ', ProductDescription,
            CHARINDEX(' - ', ProductDescription) + 3) + 3,
        LEN(ProductDescription)
    ) AS Field3,
    ProductDescription
FROM your_table 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T17:31:38.570

一个带有字符串、分隔符和你想要返回的部分的内联函数怎么样

```
 Create Function dbo.GetPart(@InString as varchar(1000)
     , @Part as int
     , @Delim as varchar(10))
    Returns varchar(1000) as 
    Begin
        Declare @CurrentPart int
        Declare @i int 
        Declare @j int
        Declare @Ret varchar(1000)
        Set @Ret = ''
        Set @i = 0
        Set @InString = Replace(@InString, ' ', '')

        Set @CurrentPart = 1
        while (@CurrentPart <= @Part)
        Begin
            Set @j =  charindex(@Delim, @InString, @i + 1 ) 
            if @j = 0 set @j = len(@InString) + 1
            if ((@j - @i) > 0 and @CurrentPart = @Part)
            Begin   
                Set @Ret =  Substring(@InString, @i , @j - @i) 
                If @Ret = '' set @ret = 'Weird'
                break
            End
            Set @i = charindex(@Delim, @InString, @i) + len(@delim)
            Set @CurrentPart = @CurrentPart + 1
        End
        if @Ret = '' Set @Ret = 'inconveivable'
        Return @Ret
    End
    GO 
    Select dbo.GetPart('DB1 - DB2 - DB3',1, '-') as Field1
    ,dbo.GetPart('DB1 - DB2 - DB3',2, '-') as Field2
    , dbo.GetPart('DB1 - DB2 - DB3',3, '-') as Field3

    Select dbo.GetPart('DataBit1 - DataBit2 - DataBit3',1, '-') as Field1
    ,dbo.GetPart('DataBit1 - DataBit2 - DataBit3',2, '-') as Field2
    , dbo.GetPart('DataBit1 - DataBit2 - DataBit3',3, '-') as Field3 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T17:39:16.340

这是另一个解决方案。假设产品描述中没有句点 (.)：

```
SELECT 
    LTRIM(PARSENAME(REPLACE(ProductDescription,'-','.'),3)) DB1, 
    LTRIM(PARSENAME(REPLACE(ProductDescription,'-','.'),2)) DB2, 
    LTRIM(PARSENAME(REPLACE(ProductDescription,'-','.'),1)) DB3, 
    ProductDescription
FROM #TABLE T 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T17:28:17.203

谢谢卢克，这很接近但不准确。

```
/---------------------------------------------------- ---------------------------\
|DB1 |DB2 |DB3 |产品描述 |
|------------------------------------------------- --------------------------|
|装载 |拖车 |Albert Moving |装载 - 拖车 - Albert Moving |
|卸货 |拖车 - |搬运人员|卸货 - 拖车 - 搬运人员|
\-------------------------------------------------- ---------------------------/

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T09:42:27.650

个人我会检查“ - ”并将其用作我的分隔符而不仅仅是“ - ”，原因很简单，许多条目可以连字符。用逗号替换 3 个字符的组合，基本上生成一个 CSV（第 1 阶段）并将 CSV 字符串解析到您的表中。

将您的流程分为两个特定于结果的操作以实现您需要的操作并没有错。

苹果电脑

# .net - .net HttpCookie 类/会话 cookie 问题

> ID：630910
> 
> 赞同：6
> 
> 时间：2009-03-10T15:55:25.633
> 
> 标签：.net, session, cookies, session-state

我对如何将常规`HttpCookie`对象制作成在会话结束时过期的 cookie 很感兴趣。我对某人不感兴趣`showing me HttpContext.Session`。与普通 cookie 相比，会话 cookie 在响应标头中的外观如何？如何修改 a`HttpCookie`以在会话结束时过期？谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-10T16:04:10.993

会话 cookie 只是没有设置任何到期日期的 cookie。

```
Response.Cookies.Add(new HttpCookie("name", "value")); 
```

或者：

```
Response.Cookies["name"] = "value"; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-10T16:00:06.900

DateTime.MinValue (1/1/0001) 过期的 cookie 将在会话结束时过期。这是 asp.net 中 cookie 的默认到期日期。

您可以通过将过期日期设置为“现在”之前的某个时间（DateTime.Now.AddDays(-1d)）来强制从客户端立即删除 cookie，在这种情况下，它将在到达客户端时被删除。

如果在编码 HttpCookie 时我们有可空类型，我的猜测是空日期将等同于基于会话的 cookie，其他任何内容都将转换为过期值，但事实并非如此。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-10-08T14:31:16.920

cookie 过期：

*   会话 cookie - 到期日期应为 DateTime.MinValue，即 1/1/0001 00:00:00
*   普通 cookie（限时）- 过期日期是等于或大于当前 DateTime.Now 的任何未来日期。
*   已删除的 cookie - DateTime.MinValue 和 DateTime.Now 之间的任何时间。

要将 cookie 更改为会话 cookie，只需分配 MinValue。

```
httpCookie.Expires = DateTime.MinValue; 
```

如果您的 cookie 是新的。DateTime 的默认值应为 DateTime.MinValue，无需设置。

呼叫MeLaNN

# cocoa - 在命令行工具中使用框架

> ID：630911
> 
> 赞同：33
> 
> 时间：2009-03-10T15:55:33.277
> 
> 标签：cocoa, xcode, macos

我使用 Cocoa 在 Xcode 中构建了一个命令行实用程序（基础工具）。该工具利用了第 3 方框架。

在 Xcode 中一切正常，但我该如何部署这个程序呢？

如果我从 Finder 运行应用程序，它找不到库，因为它正在查找`../Frameworks/etc.` 我可以在第 3 方框架中静态链接吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-10T16:10:32.023

不幸的是，没有办法在 OS X 中将框架与命令行实用程序捆绑在一起，我怀疑您要链接到的框架预计会捆绑在应用程序包的 Frameworks/ 目录中。如果您有权访问框架源代码，则可以编译一个静态库并将其静态链接到您的应用程序（或将源代码直接包含在您的应用程序目标中）。如果您没有源代码或出于某种原因不想静态链接库，则还有两个选项：

1.  如果您有权访问系统范围的 /Library/Frameworks 文件夹，则可以在那里安装第 3 方框架。这要求在构建时将框架的安装路径（`INSTALL_PATH`构建设置）设置为`/Library/Frameworks`，或者您使用 将`install_name_tool`框架安装路径更改为`/Library/Frameworks`（如果您没有框架的源代码）。

2.  使用命令行实用程序构建应用程序包（就像构建 GUI 应用程序）作为应用程序包的可执行文件（即在 AppBundle.app/Contents/MacOS/ 中）。然后，您可以将第 3 方框架复制到应用程序包的框架目录。然后，您可以将应用程序包放在您想要的任何位置，并创建指向命令行实用程序的符号链接。

选项 1 绝对是更被接受的方法，但我在有正当理由时使用了选项 2。

[您可以在 Apple 的Frameworks Programming Guide](https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPFrameworks/Frameworks.html#//apple_ref/doc/uid/10000183i)中找到有关构建、链接和安装框架的更多信息。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-10T20:27:49.393

另一种方法是，如果您有框架的源代码，则添加一个静态库目标并从中构建一个静态库。然后您可以将其静态链接到您的命令行工具中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-06-07T21:13:42.800

`Mach-O Type`从 Xcode 9.3.1 开始，我可以通过将框架设置为来将框架添加到命令行工具中`Static Library`。然后在命令行中`target`确保将框架添加到`Target Dependencies`& 中`Link Binary With Libraries` `Build Phases`。然后构建的可执行文件能够毫无问题地运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-09T22:18:02.357

您可以使用 marathon 来管理依赖关系 [https://github.com/JohnSundell/Marathon](https://github.com/JohnSundell/Marathon)

如果您想分发应用程序，这需要更多考虑。（在该用例中，您可能希望安装到 frameworks 文件夹中。）您的里程可能会因此解决方案而异。

# http - Web Dev Helper，例如 IE8 中的 HTTP 请求跟踪

> ID：630915
> 
> 赞同：2
> 
> 时间：2009-03-10T15:56:19.407
> 
> 标签：http, request, trace

很棒的工具 Web Development Helper 允许我查看从浏览器 (IE6/IE7) 到服务器的所有 http 请求。但是，该工具似乎不适用于 IE8-RC1。

1.  IE8 开发者工具是否内置了类似的功能？

2.  如果是，我如何访问它？

TIA 公羊

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T16:09:25.083

我的偏好是[Fiddler](http://www.fiddlertool.com/fiddler/)，它适用于我所知道的所有浏览器。

# c# - 属性类型取决于枚举值

> ID：630919
> 
> 赞同：-1
> 
> 时间：2009-03-10T15:56:44.193
> 
> 标签：c#, properties

我应该如何在 C# 中实现一个类，该类包含具有某物类型的属性，然后是某物示例：

```
public class MyObject{
    public someEnum e { get; set;}
    public Object ObjectDependentOnE { get; set; }
} 
```

我希望能够为我的对象返回正确的类型，这取决于我的枚举。例如，如果 e = 1，我的对象是 T1 类型...

或者我试图做错事

任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T15:59:53.687

我不确定您真正想要做什么，但似乎泛型是您正在寻找的：

```
public class MyObject<T>
{
   public T SomeProperty{get;set;}
} 
```

您可以将 T 约束到实现给定接口的类。

用法是：

```
MyObject<SomethingClass> something = new MyObject<SomethingClass>; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T16:06:30.427

我不确定您的用例是什么 - 更多信息可能有助于更好地回答这个问题，但根据我的猜测，您可能需要考虑创建一个工厂类。就像是：

```
class MyClass
{
    public SomeEnum E { get; set; }
    // This might be better as : public Object GetTheObject(SomeEnum E) and eliminating the above property
    public Object GetTheObject()
    {
         switch(this.E)
         {
         case E.Something:
            return new MySomethingObject(); // Or return an instance that already exists...?
         default:
            return new MyDefaultObject();
         }
    }
} 
```

这也可以是具有 getter 和 setter 的属性，并获取和设置特定的对象类型。

但是，我建议考虑重新考虑这种方法——这似乎是一个非常容易出错的设计，因为它在编译时没有类型安全，并且从消费者的 POV 来看非常令人困惑。

# c++ - 在映射中存储指向成员函数的指针

> ID：630920
> 
> 赞同：8
> 
> 时间：2009-03-10T15:57:14.817
> 
> 标签：c++, design-patterns, callback

我想将字符串映射到实例成员函数，并将每个映射存储在映射中。

做这样的事情的干净方法是什么？

```
class  MyClass
{
   //........
   virtual double GetX();
   virtual double GetSomethingElse();
   virtual double GetT();
   virtual double GetRR();
   //........
};

class Processor
{
 private:
      typedef double (MyClass::*MemFuncGetter)();
      static map<std::string, MemFuncGetter> descrToFuncMap;

 public:
        static void Initialize();
        void Process(Myclass m, string);
};

void Processor::Initialize()
{

     descrToFuncMap["X"]=&MyClass::GetX;
     descrToFuncMap["SomethingElse"]=&MyClass::GetSomethingElse;
     descrToFuncMap["RR"]=&MyClass::GetRR;
     descrToFuncMap["T"]=&MyClass::GetT;
};
void Processor::Process(MyClass ms, const std::string& key)
{
     map<std::string, Getter>::iterator found=descrToFuncMap.find(key);
     if(found!=descrToFuncMap.end())
     {
        MemFuncGetter memFunc=found->second;
        double dResult=(ms).*memFunc();    
        std::cout<<"Command="<<key<<", and result="<<result<<std::end;      
      }
 } 
```

如果您发现这种方法有问题，请告诉我，常见的成语是什么？

**也许，我应该使用 if-else-if 语句链，因为我的成员函数数量有限，而不是混乱的 func 指针映射**

[顺便说一句，我在c++-faq-lite](http://www.parashift.com/c++-faq-lite/pointers-to-members.html)中找到了一些有用的信息

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-10T16:08:58.690

对我来说看起来不错，但是如果您打算从静态函数内部对其进行初始化，则`descrToFuncMap`需要声明这一事实。`static``Initialize()`

如果你想确保它`Initialize()`被调用，并且只被调用一次，你可以使用单例模式。基本上，如果你不做多线程，那只是意味着`descrToFuncMap`用`FuncMap`一个调用`Initialize()`. 然后，您将`static`类型的局部变量添加`FuncMap`到`Processor::Process()`-- 因为该变量是`static`，所以它会持续存在并且只初始化一次。

示例代码（我现在意识到这`friend`并不是真正需要的）：

```
class Processor {
private:
    typedef double (MyClass::*MemFuncGetter)();

    class FuncMap {
    public:
        FuncMap() {
            descrToFuncMap["X"]=&MyClass::GetX;
            descrToFuncMap["SomethingElse"]=&MyClass::GetSomethingElse;
            descrToFuncMap["RR"]=&MyClass::GetRR;
            descrToFuncMap["T"]=&MyClass::GetT;
        }

        // Of course you could encapsulate this, but its hardly worth
        // the bother since the whole class is private anyway.
        map<std::string, MemFuncGetter> descrToFuncMap;
    };

public:
    void Process(Myclass m, string);
};

void Processor::Process(MyClass ms, const std::string& key) {
    static FuncMap fm;      // Only gets initialised on first call
    map<std::string, Getter>::iterator found=fm.descrToFuncMap.find(key);
    if(found!=fm.descrToFuncMap.end()) {
        MemFuncGetter memFunc=found->second;
        double dResult=(ms).*memFunc();    
        std::cout<<"Command="<<key<<", and result="<<result<<std::end;      
    }
} 
```

这不是“真正的”单例模式，因为不同的函数可以创建自己的、单独的实例`FuncMap`，但它足以满足您的需要。对于“真正的”单例，您可以将`FuncMap`的构造函数声明为私有并添加一个静态方法，比如`getInstance()`，它将唯一的实例定义为`static`变量并返回对它的引用。 `Processor::Process()`然后将其与

```
FuncMap& fm = FuncMap::getInstance(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T16:03:47.657

我会改变

```
void Processor::Process(MyClass ms, std::string key) 
```

到

```
void Processor::Process(const MyClass& ms, const std::string& key) 
```

暂时看不到任何不良的副作用。可能使用 boost::function 作为映射值，将来会更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T12:23:58.033

如果您使用函数指针映射，请避免使用“虚拟”。在这种情况下，使用 'virtual' 关键字不会有太大帮助。例如

```
descrToFuncMap["X"]=&MyClass::GetX; 
```

即使*GetX*被 MyClass 的派生类覆盖，也将始终调用“ *MyClass::GetX ”函数。*

 *通常你不会在类中有大量函数，而不是使用 map 你可以创建简单的结构数组并使用 for 循环。如果函数的数量很少，map和array的性能差异不会很大。类似于下面代码的东西会起作用

```
class  MyClass
{
   //........
   double GetX();
   double GetSomethingElse();
   double GetT();
   double GetRR();
   //........
};

typedef double (MyClass::*MemFuncGetter)();

struct FuncTable
{
    const char* m_pFuncName;
    MemFuncGetter m_pFuncPtr;
};

class Processor
{          
 public:
        void Process(Myclass& m, string);
};

static FuncTable descrToFuncMap[]
{
    { "X",  &MyClass::GetX},
    { "SomethingElse", &MyClass::GetSomethingElse },
    { "RR", &MyClass::GetRR},
    { "T", &MyClass::GetT}
};

void Processor::Process(MyClass& ms, const std::string& key)
{
    int functablesize = sizeof(descrToFuncMap)/sizeof(descrToFuncMap[0])

    for(int i=0; i< functablesize; ++i)
    {   
        if( strcmp(key.c_str(), descrToFuncMap[i].m_pFuncName)==0)
        {
            MemFuncGetter memFunc=descrToFuncMap[i].m_pFuncPtr;
            double dResult=(ms).*memFunc();    
            std::cout<<"Command="<<key<<"result="<<result<<std::end;
            break;
        }
    }     
 } 
```

# reporting-services - 对象需要错误

> ID：630936
> 
> 赞同：0
> 
> 时间：2009-03-10T15:59:46.387
> 
> 标签：reporting-services

谁能告诉我报告管理器中出现此错误消息的原因？我的报告在工具中运行良好。我的第二个参数级联（派生自）到第一个参数。

当我第一次运行报告时它可以工作，但是当立即更改任何其他参数并尝试执行它时，结果中没有数据，并且网页显示此错误：

> 线路：13
> 
> 字符：692
> 
> 错误：需要对象
> 
> 代码：0

为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T16:33:54.963

听起来像是 NullReferenceException 的 Javascript 版本。如果是这样的话，有*十亿*种不同的原因导致这种情况发生。

# python - 检测python中是否存在charset

> ID：630938
> 
> 赞同：0
> 
> 时间：2009-03-10T16:00:02.017
> 
> 标签：python, character-encoding

是否可以在 Python 中检查给定的字符集是否存在/已安装。例如：
check('iso-8859-1') -> True
check('bla') -> False

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T16:06:01.597

您可以使用模块`lookup()`中的功能。`codecs`如果编解码器不存在，它会抛出异常：

```
import codecs
def exists_encoding(enc):
    try:
        codecs.lookup(enc)
    except LookupError:
        return False
    return True
exists_encoding('latin1') 
```

# sql - 我应该对多个表的复杂连接使用 sql JOIN 关键字吗？

> ID：630943
> 
> 赞同：9
> 
> 时间：2009-03-10T16:01:02.233
> 
> 标签：sql, join

我有以下要求：

```
select * 
    from tbA A, tbB B, tbC C, tbD D
where 
    A.ID=B.ID and B.ID2= C.ID2 and A.ID=D.ID and C.ID3=D.ID3 and B.ID4=D.ID4
and
    A.Foo='Foo' 
```

我多次听说这种连接语法已被贬低，我应该改用“JOIN”关键字。

如何在如此复杂的连接中做到这一点（在属于不同表的多个列上连接多个表）？您认为这种最佳做法在这里仍然适用吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-10T16:16:31.837

这是一个品味问题，但我更喜欢 JOIN 关键字。它使逻辑更清晰，并且更符合其附带的 LEFT OUTER JOIN 语法。请注意，您也可以使用与 JOIN 同义的 INNER JOIN。

语法是

```
 a JOIN b
    ON expression relating b to all of the tables before 
```

b 可以是连接本身。对于内部连接无关紧要，但对于外部连接，您可以像这样控制连接的顺序：

```
select * from
   a left join
      d join c
      on d.i = c.i
   on a.k = d.k 
```

这里 a 左连接到 d 和 c 之间的内部连接。

这是您的查询：

```
select * 
    from tbA A
    join tbB B on A.ID = B.ID
    join tbC C on B.ID2 = C.ID2
    join tbD D on A.ID = D.ID and C.ID3 = D.ID3 and B.ID4 = D.ID4
where 
    A.Foo='Foo' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-10T16:09:18.097

我发现连接语法更容易理解

```
select *
from tbA A
inner join tbB B on a.id = b.id
inner join tbC C on b.id2 = c.id2
inner join tbD D on a.id = d.id and c.id3 = d.id3 and b.id4 = d.id4
where A.Foo='Foo' 
```

现在您可以清楚地看到数据是如何连接在一起的，而且它完全不是一个非常复杂的连接。

顺便说一句，您示例中的数据库设计强烈缺乏规范化。通常，您应该将一张表连接到多个表（a.bid 上的连接 b = b.bid 连接 a.cid = c.cid 上的 c）或链（a.bid 上的连接 b = b.bid 连接 c b.cid = c.cid）。

编辑。添加了可选关键字 INNER，它不会改变结果，但会使结果更清晰。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T16:12:16.183

```
SELECT * 
FROM tba AS a
    JOIN tbb AS b ON a.id = b.id
    JOIN tbc AS c ON b.id2 = c.id2
    JOIN tbd AS d ON a.id = d.id AND c.id3 = d.id3 AND b.id4 = d.id4
WHERE 
    a.foo = 'Foo' 
```

虽然我很难想象有什么需要。只是举个例子，或者是更具描述性的表名？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T16:15:18.127

`JOIN`语法更清晰（尽管我个人更喜欢`WHERE`简单情况下的语法），而且更重要的是，可以更清晰地处理`INNER`和`OUTER`连接。

`WHERE`没有被弃用，并且可能永远不会被弃用。

仅在不推荐使用不同的`OUTER JOIN`解决方法（例如`(*)`和`(+)`）的情况下才不推荐使用它。

没有什么是你不能做的`JOIN`，你可以做的`WHERE`，反之亦然。

# c++ - 代码中的 C++ 错误

> ID：630946
> 
> 赞同：0
> 
> 时间：2009-03-10T16:01:33.933
> 
> 标签：c++

我有这段代码（考试中的问题），代码中有很多错误，这里是代码：

```
 class A
 {
   int z;
   static int y;
   public:
     A() {(*this).incrementY();}
    int x () { y=y+2; return z;}
    static int getY(){ return z;}
    void incrementY() {y++}
 };
 class B: A
 {
   public:
    B (): A() {(*this).incrementY();};
 };
 class C : public B
 {
   public:
    C(): B() {(*this).incrementY;() }
 };

 int main()
 {
   A::x();
   A a;
   a.getY();
   A::getY();
   B b;
   C c;
   C::getY();
   b.x();
 } 
```

有私有继承。这意味着 B 中的所有方法和变量对于从 B 继承的任何类都变为私有？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T16:47:17.990

有这么多，你不能不累。这里有一些：

```
void incrementY() {y++} 
```

没有`;`之后`y++`。

```
24\.   A::x(); 
```

不能通过类名调用非静态成员。

```
25\.   A a; 
```

没有定义静态成员`y`。如果`y`是`const`这样就好了。这有点棘手，所以我会引用。

> **9.4.2 静态数据成员**
> 
> 2.  在其类定义中声明静态数据成员不是定义，并且可能是除 cv 限定的 void [...]
>     
>     
> 3.  如果一个静态数据成员是 const 有效字面量类型，它在类定义中的声明可以指定一个带有一个整型常量表达式的初始化子句的常量初始化器大括号或相等初始化器。可以使用 constexpr 说明符在类定义中声明有效文字类型的静态数据成员；如果是这样，它的声明应指定一个常量初始化器大括号或相等初始化器，其初始化器子句是一个整数常量表达式。在这两种情况下，成员都可能出现在整型常量表达式中。如果在程序中使用该成员，则该成员仍应在名称空间范围内定义，并且名称空间范围定义不应包含初始值设定项。

```
26\.   a.getY();
27\.   A::getY(); 
```

非法引用非静态成员`A::z`。

通过第一次观察处理。

```
28\.   B b;
29\.   C c;
30\.   C::getY(); 
```

`getY()`是 的私有成员`B`，对 不可见`C`，更不用说公开了。

```
31\.   b.x(); 
```

`x()`继承自的成员函数`A`是私有的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T16:06:53.500

是的，这是正确的，尽管您可以使用任意数量的在线 C++ 编译器对其进行编译以进行验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T16:07:57.397

你在那里是正确的（尽管它实际上意味着所有*A*的方法都变得不可访问）。

但是，还有一些其他问题：

```
A::x() // will not work as x is not static.
a.getY() // will not work as getY() is static.
C::getY() // Cannot access getY() 
```

# api - 需要关于方法的冗长命名的建议

> ID：630947
> 
> 赞同：5
> 
> 时间：2009-03-10T16:01:48.457
> 
> 标签：api, naming-conventions

我正在编写一个用于创建几何形状的 API，并且在命名我的方法时遇到了一些困难。

让我们举一个简单的例子：创建一个圆圈。我们大多数人可能都熟悉类似`graphics.drawEllipse(x, y, w, h)`. 要画一个圆，你需要知道左上角的坐标，以及圆的宽度和高度。

我的 API 旨在使开发人员可以轻松地使用各种信息绘制形状，而无需进行大量数学运算——这对于圆形来说是微不足道的，但对于其他形状来说就更复杂了。例如，您还应该能够根据圆心坐标和半径或左上角和右下角坐标绘制一个圆。

所以我有一个`Circle`带有工厂方法的类，例如：

```
`Circle.createWithCenterAndRadius(cx, cy, r)
Circle.createWithBoundingBox(x1, y1, x2, y2)
Circle.createWithWidthAndHeight(x, y, w, h)` 
```

`我觉得这里可能有“代码气味”，但我不确定。一方面，这些工厂方法必须是描述性的。另一方面，我可以预见这些方法名称会失控。例如，我将如何命名一个 Triangle 工厂方法，该方法在给定一个点、一侧的长度、一个角度和另一侧的长度的情况下创建一个三角形？ `Triangle.createWithPointSideAngleAndSide(x, y, side1, angle, side2)`? 那只是邪恶的吗？`

 `如果你要使用这个 API，这样的方法名称对你来说可以吗？您对如何使方法名称更合理有什么建议吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-10T16:07:12.810

您可以将您的圈子方法更改为

```
Circle.FromCenterAndRadius(...)
Circle.FromBoundingBox(...)
Circle.FromWidthAndHeight(...) 
```

这意味着您正在以一种简洁的方式从它们的不同表示中创建圆圈......

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-10T16:05:09.820

任何不支持命名参数的语言都可以。如果语言支持命名参数，我更喜欢简短的 Create 并且只有明显的参数名称。

对于具有命名参数的语言，您将：

```
Circle.Create(
   centerX = cx, 
   centerY = cy, 
   radius = r
); 
```

另一个更复杂的选择是一个流畅的界面，比如（但这可能太多了）：

```
circleBuilder.Center(cx,cy).Radius(r)
circleBuilder.Center(x,y).Width(w).Height(y)
circleBuilder.BoundWith().Left(x1,y1).Right(x2,y2) 
```

Center 返回一个只允许 Radius 或 Width 的中间类的实例。BoundWith 返回一个只允许 Left 的值。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-10T16:09:35.863

我认为您的描述性方法没有任何问题-它们是紧凑的，并且准确地描述了正在发生的事情。库的用户不会怀疑您的方法的功能，维护程序员也不会怀疑。

如果你真的担心暴露大量的工厂方法，你也可以在这里应用一些设计模式——比如拥有带有属性类的工厂方法。您可以拥有一个具有诸如 CenterX、CenterY、Radius、(bool)UseCenterX、(bool)UseCenterY 等属性的 CircleProperties 类，然后将其传递给公共工厂方法，该方法将确定使用哪个（私有）工厂方法。

假设 C#：

```
var circleProperties = new CircleProperties()
{
   CenterX = 10,
   CenterY = -5,
   Radius = 8,
   UseCenterX = true,
   UseCenterY = true,
   UseCenterRadius = true
};

var circle = Circle.Create(circleProperties); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-10T16:24:45.343

我的第一直觉是拥有更多类型，这将允许更直观的方法重载。

```
// instead of Circle.createWithCenterAndRadius(cx, cy, r)
Circle.create( new Point(cx,xy), r);

// instead of Circle.createWithBoundingBox(x1, y1, x2, y2)
Circle.create( new Point(x1,y1), new Point(x1,y1) );
// or even...
Circle.create( new Box(p1,p2));

// instead of Circle.createWithWidthAndHeight(x, y, w, h)
Circle.create( new Point(x,y), w, h); 
```

除了点之外，您还可以定义距离（允许使用不同的单位）

如果这种风格适合您，请考虑为什么需要工厂方法而不是构造函数。

```
Circle c = new Circle(new Point(cx,xy), r); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T16:08:00.533

对于不支持命名参数的语言，将方法名称设为像**Circle.create**这样非常简单的名称会更简洁，然后只需添加一个额外的输入标志字符串（如“中心”或“边界”）来指示输入的方式对于仅基于输入变量编号和类型难以区分的情况，是否应该解释值？这样做的缺点是它需要方法内部的额外逻辑来处理不同类型的输入参数，并且还需要用户记住标志选项。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-10T16:08:30.280

我会有 CreateTriangle 方法并让重载显示所需的不同信息。

例如

```
Circle.CreateCircle(cx, cy, r)
Circle.CreateCircle(point1, point2)
Circle.CreateCircle(point, width, height) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T16:03:45.957

是的，这更像是一个元答案，但我建议您看一下[Apple 的 Cocoa](http://developer.apple.com/referencelibrary/Cocoa/)中的命名方式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-06T16:56:33.023

你的直觉是正确的——以这种方式创造事物的整个模式是——不确定的。

除非这些只使用一次或两次，否则它们会变得非常混乱。如果您要创建一个包含 5 个圆形和 3 个三角形的形状，那将是一团糟。

除了一个简单的例子之外，任何事情都可能最好通过某种数据驱动的实现来完成。

为此，使用字符串、散列或 XML 来定义形状可能非常有用。

但这一切都取决于您期望如何使用它们。

在 Java 中创建 Swing 控件时，我遇到了同样的问题。您最终会得到一行又一行的“new Button()”，然后是一堆 .set 属性调用以及一行代码将值复制到对象（或添加侦听器），以及一行重置价值..

这种样板文件不应该出现在代码中，所以我通常会尝试找到一种方法来使用数据驱动它，动态地将控件绑定到对象——为此，基于字符串的描述性语言将非常有帮助。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-10T20:42:35.893

我知道我知道。对于 C/C++/Java 人来说，这听起来很疯狂，但是问题中给出的示例以及所有这些答案中的示例清楚地表明了 CamelCaseNaming 真正的糟糕、糟糕的约定。

让我们再看一下原始示例：

```
Circle.createWithCenterAndRadius(cx, cy, r)  
Circle.createWithBoundingBox(x1, y1, x2, y2)
Circle.createWithWidthAndHeight(x, y, w, h) 
```

现在让我们摆脱那种驼峰式表示法

```
Circle.create_with_center_and_radius(cx, cy, r)  
Circle.create_with_bounding_box(x1, y1, x2, y2)
Circle.create_with_width_and_height(x, y, w, h) 
```

这可能看起来非常陌生，但说实话：哪个版本更容易阅读？

# flash - 对于 Flash 项目，PureMVC 是否有更好的替代方案？

> ID：630949
> 
> 赞同：3
> 
> 时间：2009-03-10T16:02:01.933
> 
> 标签：flash, model-view-controller, puremvc

**我在之前的 Flash（不是**Flex）项目中使用了 PureMVC 。在调整到它的要求后，它运行良好，但我觉得它过于设计和繁琐。我注意到[Mate](http://mate.asfusion.com/)因其清晰和简单而获得了很多正面评价，但它仅适用于 Flex 项目，而不适用于 Flash。

如果没有像 Flash 中的 PureMVC 这样的框架，只维护我自己的 MVC 分离会更简单/更清晰，还是有更好的 PureMVC 替代方案？

编辑：我发现的唯一轻量级竞争者是[flashMVC](http://www.jadbox.com/flashmvc/)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-31T19:02:01.433

你需要锤子、木槌还是鞋子？

没有一个答案。一个框架的好坏取决于它的预期用途。

我要说的是，没有一个终极解决方案是可以的。一个项目一个项目。自从 AS 首次出现以来，我一直在编写 AS 代码，并且在这些问题上旋转了我的轮子，却发现除此之外没有一个客观的答案。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T04:44:42.890

实际上，我发现 PureMVC 的工程设计不如大多数框架，并且更好地使用可重用代码在 Flash 和 Flex 之间跳转。如果你真的想要“最好的选择”，你最好的选择是自己推出，但我认为建立在 Pure 之上的“个人”框架可能非常热门（这就是我现在正在使用的）......那里虽然是负载。查看此链接上的 OOP 框架部分：

[http://www.adrianparr.com/?p=83](http://www.adrianparr.com/?p=83)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T18:43:40.747

你可以试试 Gaia ( [http://www.gaiaflashframework.com/](http://www.gaiaflashframework.com/) )。它更像是一个前端框架，但我相信它总比没有好。您可以构建一个非常简单的后端，可以很好地搭配它。

可能值得一试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-12T21:36:17.923

你可以[尽快](http://asapframework.org/wiki/bin/view/ASAP/)试一试。它太酷了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-19T18:28:38.863

虽然我的回答是有偏见的，因为我是 FlashMVC ( [www.flashmvc.com](http://www.flashmvc.com) ) 的作者，但我确实认为它具有最高的灵活性，同时尽可能易于实现。需要一个导入语句，整个框架大约有 3 个类。一个 hello-world 示例可能只是几行代码，而 PureMVC 可能有几十行。我已经将它用于两个非常小的项目到工业规模的构建。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-21T22:33:15.047

看看[斯威兹](http://code.google.com/p/swizframework/)。虽然项目本身声明它是一个 Flex 框架，但实际上只有一个文件依赖于 MXMLC（Beans.mxml 文件）。[可以按照Aral 在其博客上的示例](http://aralbalkan.com/1960)将其重新加工成 ActionScript 文件。

在架构上，Mate 和 Swiz 在提供的方面非常相似。它们都是 MVC 框架，并且共享许多相同的基本思想。关键区别实际上只是实现细节。例如，在 Mate 中，您有一个 Event 映射，而在 Swiz 中，您 [Mediate] 来处理事件。Mate 使用 MXML 标签处理事件，Swiz 通过编写 ActionScript 事件处理方法来处理事件。此外，在 Mate 中，您使用映射内部的注入器进行依赖注入，而在 Swiz 中，您使用 [Autowire]。

# c++ - C++中的纯虚析构函数

> ID：630950
> 
> 赞同：171
> 
> 时间：2009-03-10T16:02:24.650
> 
> 标签：c++, polymorphism, destructor, pure-virtual

写错了吗：

```
class A {
public:
    virtual ~A() = 0;
}; 
```

对于抽象基类？

至少在 MSVC 中编译...它会在运行时崩溃吗？

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2009-03-10T16:04:00.057

是的。您还需要实现析构函数：

```
class A {
public:
    virtual ~A() = 0;
};

inline A::~A() { } 
```

应该足够了。

既然这得到了反对票，我应该澄清一下：如果你从 A 派生任何东西，然后尝试删除或销毁它，`A`最终将调用 's 的析构函数。由于它是纯粹的并且没有实现，因此会出现未定义的行为。在一个流行的平台上，这将调用 purecall 处理程序并崩溃。

编辑：修复声明更符合，编译与[http://www.comeaucomputing.com/tryitout/](http://www.comeaucomputing.com/tryitout/)

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-03-10T16:19:54.340

私有析构函数：当您创建派生类的对象时，它们会给您一个错误——否则不会。但可能会出现诊断。

> **12.4 析构函数**
> 
> 6 析构函数可以声明为虚拟（10.3）或纯虚拟（10.4）；如果在程序中创建了该类或任何派生类的任何对象，则应定义析构函数。

具有纯虚析构函数的类是抽象类。请注意：

> **10.4 抽象类**
> 
> 2 纯虚函数仅在使用或如同使用 (12.4)、qualified-id 语法 (5.1) 调用时才需要定义。
> 
> [*注意*：函数声明不能​​同时提供纯说明符和定义——尾注]

直接取自草稿：

```
struct C {
   virtual void f() = 0 { }; // ill-formed
}; 
```

# c# - 如何正确使用 close 方法实现 dispose 模式（CA1063）

> ID：630955
> 
> 赞同：12
> 
> 时间：2009-03-10T16:03:03.180
> 
> 标签：c#, fxcop

框架设计指南（第 2 版，第 327 页）说：

> 考虑提供方法`Close()`，除了`Dispose()`, if close 是该地区的标准术语。
> 
> 这样做时，重要的是使 Close 实现与明确地`Dispose`考虑实现方法相同。`IDisposable.Dispose`

因此，按照提供的示例，我有这个类：

```
public class SomeClass : IDisposable {
    private SomeDisposable someInnerDisposable;

    public void Open() {
        this.someInnerDisposable = new SomeDisposable();
    }

    void IDisposable.Dispose() {
        this.Close();
    }

    public void Close() {
        this.Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing) {
        if (disposing) {
            this.someInnerDisposable.Dispose();
            this.someInnerDisposable = null;
        }
    }
} 
```

FxCop 似乎不喜欢这样：

> CA1816：Microsoft.Usage：“SomeClass.Close()”调用“GC.SuppressFinalize(object)”，该方法通常仅在“IDisposable.Dispose”的实现中调用。有关详细信息，请参阅 IDisposable 模式。
> 
> CA1816：Microsoft.Usage：将“SomeClass.IDisposable.Dispose()”更改为调用“GC.SuppressFinalize(object)”。这将防止在对象被释放并且超出范围后不必要地完成对象。
> 
> CA1063：Microsoft.Design：修改“SomeClass.IDisposable.Dispose()”，使其调用 Dispose(true)，然后在当前对象实例（Visual Basic 中的“this”或“Me”）上调用 GC.SuppressFinalize，然后返回。
> 
> CA1063：Microsoft.Design：将“SomeClass.IDisposable.Dispose()”重命名为“Dispose”，并确保将其声明为公共和密封。

*   如何正确使用 close 方法实现 dispose 模式？

-或者-

*   如何抑制警告？

我试过

```
[SuppressMessage("Microsoft.Design", "CA1063:ImplementIDisposableCorrectly",
    Justification = "Framework Design Guidelines say it's ok.")]
void IDisposable.Dispose()
{
    this.Close();
} 
```

但 FxCop 1.36 仍会报告它们。

**编辑**：按照建议更改它可以消除除此警告之外的所有内容：

> CA1063：Microsoft.Design：将“SomeClass.IDisposable.Dispose()”重命名为“Dispose”，并确保将其声明为公共和密封。

**编辑 2**：确实缺少 CODE_ANALYSIS。谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-10T16:08:58.453

改变它。

让 Close() 调用 this.Dispose() 并将逻辑放在 Dispose() 方法中，而不是 Close() 方法中。

------------------- 编辑后的更多信息 ---------------

此外，将声明更改为：

```
public void Dispose() 
```

应该摆脱其他错误。由于您已将其声明为：

```
void IDisposable.Dispose() 
```

它没有被标记为公开和密封，FxCop 抱怨道。就个人而言，我更喜欢避免错误而不是压制它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T16:12:22.673

> 如何抑制警告？

SuppressMessage() 仅在您将 CODE_ANALYSIS 标志指定为条件编译符号时才有效。

# wpf - WPF 服务控制应用程序不会生成

> ID：630965
> 
> 赞同：0
> 
> 时间：2009-03-10T16:04:42.613
> 
> 标签：wpf, vb.net, xaml, build

我有以下代码：

[Window1.xaml 的XAML 代码和 Window1.xaml.vb](http://pastebin.com/m209443c9)的[VB.Net 代码](http://pastebin.com/m3fd66115)。

我得到的错误如下：

> “无法创建在程序集'ServiceControl，Version = 0.0.0.0，Culture = Neutral，PublicKeyToken = null'中定义的'Window1'的实例。调用目标引发了异常。标记文件'ServiceControl;component/Window1中的错误.xaml' 第 2 行位置 2。”

我在代码中看不到任何问题，它应该做的是根据服务的状态（在这种情况下为假脱机服务）触发动画。可能是因为我手动引用了 System.ServiceProcess 命名空间，WPF 框架默认没有这个命名空间，但我不确定。有人可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T16:21:40.360

您只查看顶级异常消息。深入研究并查看内部异常。

# c# - 如何开始在 .NET 中创建应用程序 API

> ID：630971
> 
> 赞同：6
> 
> 时间：2009-03-10T16:05:35.390
> 
> 标签：c#, .net, vb.net, api

在我工作的公司中，我们有一个用 .NET 开发的桌面应用程序，我们喜欢为其他软件开发人员开放一些部分。

我认为它就像其他软件可以访问的某种公共方法。是否有任何标准方法、最佳实践或其他经验？

我想你可以通过 Win32 调用、C/C++ 编程等来做到这一点。但我主要是一名 .NET 开发人员，并且在主要是 VB.NET 以及一些 C# 方面有多年的编程经验。我希望在.NET 中找到一种方法来做到这一点。但它应该可以用于以其他语言开发的软件。

最好的问候/马格努斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-10T16:13:59.690

有两种方法可以解决这个问题。第一个涉及使用插件/模块模式。 [从这里开始](http://www.developerfusion.com/article/4371/writing-pluginbased-applications/)。

第二种方法是通过有据可查的程序集简单地公开您的 API 逻辑。

您选择的方式实际上归结为您希望它如何实现。例如，Adobe Photoshop 在很大程度上使用了插件模式。MS Office 使用了这两种插件，并提供了一个对象接口来使用该应用程序。

**更新：** .Net 程序集中的对象只需将对象范围设置为 Public 即可公开以供外部应用程序使用。这包括 Windows 窗体、业务对象、枚举等。

只需从外部开发人员的角度考虑即可。他们需要哪些信息才能成功扩展/控制您的产品？不管是什么，把它放在帮助文件中。

此外，利用 .Net 的自动文档功能。这包括添加 IDE 已经知道如何通过智能感知读取和显示的 xml 文档。例如：

```
/// <summary>
/// Gets all active documents for the specified customer.
/// </summary>
/// <param name="customerId">The Id of the customer.</param>
/// <returns>A list of documents for this customer.</returns>
public static List<Document> GetDocuments(int customerId)
{
    //... do something ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T16:46:20.020

创建一个 API 类，公开您希望人们访问的功能并将其注册到 COM 互操作项目 -> 属性 -> 构建 -> 注册 COM 互操作

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T16:36:22.337

“通过公共 API 公开应用程序”不是详细的需求定义。在设计*任何东西*之前，请获得详细的要求。

对于 API，我建议您从需求开始，然后继续使用用例。由于这是一个 API，因此您实际上应该使用建议的 API 编写一些代码，以了解编写它的感觉。您编写的代码应该涵盖您开始使用的用例。您甚至可以在单元测试中编写该代码，然后通过测试驱动开发和重构创建 API。

但无论如何，由于用例关注用户将如何使用软件，它们将帮助您关注用户直接使用软件的哪些部分。一个用例可能会用到另一个；但是，如果用户不直接使用特定用例，则该用例无需公开。

请注意，这也有助于我开发 Web 服务。用户直接访问的用例成为通过服务公开的操作。用户不直接调用的任何用例将保持隐藏，作为实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T16:13:45.993

开发公共 API 很大程度上取决于程序的功能。如果您想公开其他语言可以访问的 API，XML Web 服务通常是实现此目的的方法。但是，这对于仅限桌面的应用程序可能并不实用。

# internet-explorer - IE 的 jQuery UI 对话框问题

> ID：630984
> 
> 赞同：26
> 
> 时间：2009-03-10T16:07:23.263
> 
> 标签：internet-explorer, jquery-ui, modal-dialog

我正在使用新的 jQuery 1.3.2 和 jQuery-ui-1.7 库以及 UI 对话框。我有一个 div 标签，里面有几个表单元素（文本框、复选框等）。页面加载后，jQuery 将 div 显示为对话框。这在 FF 中工作得非常好，但在 IE 中，div 的高度是错误的。它只是显示标题栏的一些内容。我在创建 div 时明确设置了高度。如果我在打开对话框后设置了高度选项，高度会被纠正，但内容是空白的（显示文本框的前三分之一）。如果我允许调整对话框的大小，如果你在 IE 中调整它的大小，它可以正常工作，但我不想强迫 IE 用户调整大小只是为了查看内容。有任何想法吗？这是我用来创建对话框的代码：

```
$('#dialogDiv').dialog({ 
    bgiframe: true, 
    height: 400, 
    width: 620, 
    modal: true, 
    draggable: true, 
    resizable: false, 
    close: function(event, ui) {
        if($('#agree').val() != '1')
            location.href = 'somepage.html';
    }
}); 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-09-17T20:10:13.827

在做了一些谷歌搜索之后，我找到了这个问题的真正答案。它是由不兼容的 Doctype 引起的。请访问[http://osdir.com/ml/jquery-ui/2009-08/msg00388.html](http://osdir.com/ml/jquery-ui/2009-08/msg00388.html)了解更多信息。

我在我的代码上试过了，这个 URL 中的解决方案确实解决了这个问题。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-03-28T16:28:36.087

我在 IE7 中遇到了同样的问题，并深入研究了症状和解决方案。我注意到，当我创建一个没有内容的虚拟对话框时，高度会正确呈现。因此，我开始尝试各种类型的内容，看看我是否可以用不同的方式编写内容来克服这个问题。没运气。然而，我确实发现，我添加的内容越多，仅在 IE7 中的对话框就越短（即使是隐藏项也会缩短一点）。因此，简单的内容可能不会产生太大的影响（因此，在这个问题上没有更多的抱怨）。我添加的表格和许多表单项产生了非常明显的效果。

将高度设置为 auto 效果不错，但 IE7 仍然将我的内容的高度误算了大约 10 个像素，太短了（可能是对象上的填充高度），因此 jQuery 添加了滚动条。不完美，但考虑到以下内容，可以接受。

由于未能找到另一种解决方法，我开始研究 DOCTYPE 解决方案。我发现我们网站的 DOCTYPE——虽然看起来是正确的——它实际上将所有浏览器都置于“Quirks Mode”，这是问题的真正根源。我怀疑 jQuery 是否支持 quirks 模式问题，所以我怀疑这将永远得到解决。

我目前的文档类型：

`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">`

它应该是什么：

`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">`

甚至这个较旧的 DOCTYPE 也有效：

`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/transitional.dtd">`

因此，不是 DOCTYPE 必须是 的 HTML 5 值`<!DOCTYPE html>`，而是它必须是一个有效的 DOCTYPE（HTML 4 或 5——不确定 XHTML），它将 IE7 设置为 quirks 模式以外的其他东西（Firefox 工作无论哪种方式都可以）。看：

[http://en.wikipedia.org/wiki/Quirks_mode#Comparison_of_document_types](http://en.wikipedia.org/wiki/Quirks_mode#Comparison_of_document_types)

我没有更改我们网站的 DOCTYPE 的选项，因此我必须使用其他解决方案，例如自动高度。我注意到在使用 jQuery 对话框时，怪癖和标准模式之间还有其他差异，因此我也必须处理这些差异（即，IE7 和 Firefox 中字体大小百分比的累积方式不同）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-09-17T17:47:59.040

我也遇到了同样的问题。是的，通过不指定高度，IE 会调整对话框的大小并显示其内容。但是，我不希望模态对话框随着内容变长而不断增长。理想的情况是显示具有指定高度的对话框，用户可以使用滚动条查看内容。这在 FireFox 中完美运行。有人有IE的解决方案吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T17:58:17.793

我已经回答了我自己的问题。我只需要使用对话框的高度属性和对话框中的一些元素。好叫我！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-04T17:27:33.637

我可以通过在这样的高度上给出一个单位来解决这个问题：

```
$(id).dialog({ modal: true, height: h + "px", width: w }); 
```

我不必弄乱文档类型。这是在 IE8、jQuery 1.4.4 和 jQuery UI 1.8.9 上。

——要快点发这个。这在 Firefox 中打破了它。不理我！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-24T17:14:19.270

以像素为单位使用字体大小时，我遇到了类似的问题。字体大小：11px - 字体大小：15px；在 css 中导致了 ie9 中的高度问题。字体大小：16px；和 up 在 ie9 中工作正常

# bash - Bash 历史重新运行：避免使用 !bang! 的可能命令？

> ID：630990
> 
> 赞同：4
> 
> 时间：2009-03-10T16:08:22.263
> 
> 标签：bash, shell, scripting, grep, history

**设想：**

你每天都在做 Bash shell 的事情。你想运行之前的命令，所以你输入：

```
history | grep foocommand 
```

然后你会得到一份`foocommand`你所做的所有事情的列表，不管你的历史记录了多久，在这样的列表中：

```
 585 foocommand --baz --bleet
  750 foocommand | grep quux
  987 history grep | foocommand 
```

你决定要运行命令 585，所以你输入

```
 !585 
```

**问题：**只是出于好奇，有没有办法将最后一步排除在等式之外并仍然获得预期的结果？如果有办法说：

```
 "grep through history and automatically run the first item on the list" 
```

或者

```
"grep through history and let me choose which item to run using the arrow keys" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T16:13:13.857

按`^r`（即`CTLR-r`），键入`foocommand`按 Enter ;）这将搜索历史并显示最新的匹配条目

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-10T16:09:59.653

你试过'！f'吗？'f' 作为 foo 命令的第一个字母。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T06:57:36.900

就个人而言，我使用从 ksh 派生的别名：

```
alias r="fc -e -" 
```

（'r'代表'重新运行'，我想......）

我可以重新运行以 'foo' 开头的最后一个命令：

```
r foo 
```

我可以重新运行命令 46 到 50：

```
r 46 50 
```

我可以重新运行命令 585：

```
r 585 
```

唯一的问题是，如果您键入：

```
$  cd somewhere 
```

然后运行 ​​'r cd' 将不起作用，因为 'cd' 命令前面有一个额外的空格。'fc' 命令是历史的基础，您可以在重新运行命令 46 到 50 之前通过键入：

```
fc 46 50 
```

对于其他变体，依此类推。

（别名中的“-e -”表示“使用 null 编辑器进行编辑”；您可以编写“fc -e vim”来使用 vim 进行编辑，但大多数人设置 VISUAL 或 EDITOR 或 FCEDIT 或全部三个以使其不必要。 )

其余的，作为一个“vim”人（狂热？），我使用“set -o vim”，然后使用搜索工具：ESC 和

```
/grep\ -e\ 'whatever 
```

搜索包含“grep -e 'whatever”的命令的历史记录。我可以重复搜索，在历史上进一步向后移动，或者在超调后反向，或者......我假设 emacs 模式具有等效的搜索机制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T16:14:07.943

语法

```
!foo 
```

将运行以 . 开头的最后一个命令`foo`。

如果做不到这一点，bash 使用 readline 库进行输入，它支持可以绑定到您选择的键的`history-search-forward`和命令。`history-search-backward`我已经编辑了我的`./inputrc`文件以将它们绑定到 F8 和 Shift-F8，这样当我连接 PuTTY 时，它们就可以像控制台中的 Windows 等效功能一样工作：

```
"\e[19~":history-search-backward
"\e[32~":history-search-forward 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T16:21:12.560

> “通过历史记录并自动运行列表中的第一项”

好的。

```
`history | grep foocommand | head -1 | tr -s ' ' | cut -d ' ' -f 3-` 
```

试一试，它就像一个冠军！`*****************************