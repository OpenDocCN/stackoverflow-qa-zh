# StackOverflow 问答 000523000-000523999

# asp.net-mvc - Asp.net MVC 默认登录类是否足够？

> ID：523001
> 
> 赞同：0
> 
> 时间：2009-02-07T02:33:18.613
> 
> 标签：asp.net-mvc, security, membership

它们在安全性方面是否足以在公共场所使用？或者所以我需要进行修改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T05:44:10.600

这实际上取决于您制作的网站类型，但我可能不会按原样部署 AccountController。它是演示使用 MembershipProvider 的机制的示例代码。

例如，需要考虑的一些事项：

1.  您可以在注册中包含验证码
2.  默认模板实际上并不使用 [Authorize] 属性保护任何内容。如果您需要登录，您可能希望拥有需要授权的控制器和操作。

ETC...

始终对自己网站的安全负责。我会做一个威胁模型并弄清楚您的网站需要有多安全。例如，某些站点需要使用 RSA 密钥卡之类的双重身份验证。这不包含在默认模板中。我认为大多数网站不需要那个级别。;) 重点是，这取决于您的具体需求。希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T04:17:12.007

您是在询问成员资格和角色提供者还是骨架控制器操作和视图？成员资格和角色提供者当然支持密码的安全存储，并允许您充分保护您的应用程序。我发现它们对于我所做的事情有点矫枉过正，所以我选择实现我自己的。就控制器操作而言，它们只是骨架，您应该期望修改它们以适应您的身份验证场景。一方面，您可能希望设置在传输密码时需要安全连接。如果您选择之后重定向到非安全连接，则需要手动操作重定向 url，因为默认路由不支持（或至少在 MVC Beta 中不支持）从安全更改回非安全协议。

最重要的是，无论您使用的是 MVC 还是 WebForms，您仍然需要确保安全地处理数据。控制器的布局和基本设置是一个充分的开始，但您需要确保它符合您的安全要求。

# sql - MySQL 不支持子选择中的限制子句，我该怎么做？

> ID：523015
> 
> 赞同：0
> 
> 时间：2009-02-07T02:46:56.730
> 
> 标签：sql, mysql

我在 MySQL 5.1.30 上有下表：

```
CREATE TABLE  article (
  article_id int(10) unsigned NOT NULL AUTO_INCREMENT,
  category_id int(10) unsigned NOT NULL,
  title varchar(100) NOT NULL,
  PRIMARY KEY (article_id)
); 
```

有了这些信息：

```
1, 1, 'foo'
2, 1, 'bar'
3, 1, 'baz'
4, 1, 'quox'
5, 2, 'quonom'
6, 2, 'qox' 
```

对于所有有文章的类别，我需要获取每个类别中的前三篇文章。像这样的东西：

```
1, 1, 'foo'
2, 1, 'bar'
3, 1, 'baz'
5, 2, 'quonom'
6, 2, 'qox' 
```

当然，工会会起作用：

```
select * from articles where category_id = 1 limit 3
union
select * from articles where category_id = 2 limit 3 
```

但是数据库中有未知数量的类别。此外，为了简化，我在示例中省略了 is_sticky 和 ​​published_date 列来指定顺序。

是否可以构建检索此信息的查询？

**更新：**我尝试了以下似乎可行的方法，*只是*MySQL 不支持子选择中的限制子句。您知道那里模拟极限的方法吗？

```
select *
  from articles a
  where a.article_id in (select f.article_id
                      from articles f
                      where f.category_id = a.category_id
                      order by f.is_sticky, f.published_at
                      limit 3) 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T04:07:57.673

SELECT ... LIMIT 恐怕在子查询中不受支持，所以是时候打破自联接魔法了：

```
SELECT article.*
FROM article
JOIN (
    SELECT a0.category_id AS id, MIN(a2.article_id) AS lim
    FROM article AS a0
    LEFT JOIN article AS a1 ON a1.category_id=a0.category_id AND a1.article_id>a0.article_id
    LEFT JOIN article AS a2 ON a2.category_id=a1.category_id AND a2.article_id>a1.article_id
    GROUP BY id
) AS cat ON cat.id=article.category_id
WHERE article.article_id<=cat.lim OR cat.lim IS NULL
ORDER BY article_id; 
```

中间的位是通过尝试按 ID 升序连接同一表的三个副本来计算每个类别的第三低 ID 文章的 ID。如果一个类别的文章少于三篇，左连接将确保限制为 NULL，因此外部 WHERE 也需要选择这种情况。

如果您的“前 3 名”要求可能会在某个时候变为“前 n 名”，这将开始变得笨拙。在这种情况下，您可能需要重新考虑先查询不同类别列表然后合并每个类别查询的想法。

ETA：订购两列：eek，新要求！:-)

这取决于你的意思：如果你只是想订购最终结果，你可以在最后敲击它，没问题。但是，如果您需要使用此排序来选择要挑选哪三篇文章，事情就困难得多。

我们正在使用带有 '<' 的自联接 重现“ORDER BY article_id”的效果。不幸的是，虽然你可以做 'ORDER BY a, b'，但你*不能*做 '(a, b)<(c, d)'……你也不能做 'MIN(a, b)'。另外，您实际上是按三列排序，issticky、published*和*article_id，因为您需要确保每个排序值都是唯一的，以避免返回四行或更多行。

虽然您*可以*通过一些粗略的整数或列的字符串组合来组成自己的可排序值：

```
LEFT JOIN article AS a1
ON a1.category_id=a0.category_id
AND HEX(a1.issticky)+HEX(a1.published_at)+HEX(a1.article_id)>HEX(a0.issticky)+HEX(a0.published_at)+HEX(a0.article_id) 
```

这变得越来越难看，并且计算将破坏使用索引来提高查询效率的任何机会。在这一点上，您最好简单地执行单独的每个类别的 LIMITed 查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T02:56:49.283

您可能应该添加另一个表，其中包含`category_id`类别的和描述。然后，您可以查询该表以获取类别 ID 列表，并使用子查询或附加查询来获取具有适当排序和限制的文章。我现在没有时间完整地写出来，但其他人可能会（或者我会在我回来时没有其他人回应的不太可能的情况下这样做）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T02:57:18.860

这是我不引以为豪的事情（在 MS SQL 中 - 不确定它是否适用于 MySQL）

```
select a2.article_id, a2.category_id, a2.title
from 
    (select distinct category_id
    from article) as a1
    inner join article a2 on a2.category_id = a1.category_id

where a2.article_id <= (
    select top 1 a4.article_id 
    from (
         select top 3 a3.article_id 
         from article a3 
         where a3.category_id = a1.category_id 
         order by a3.article_id asc
    ) a4 
    order by a4.article_id desc) 
```

这将取决于 MySQL 以这种方式支持子查询。基本上，它计算出每个类别的第三大 article_id，并将小于或等于每个类别的所有文章连接起来。

SELECT TOP n * 应该和 SELECT * LIMIT n 一样工作，我希望...

# sql - 你什么时候应该考虑索引你的 sql 表？

> ID：523018
> 
> 赞同：6
> 
> 时间：2009-02-07T02:50:17.940
> 
> 标签：sql, indexing

在我考虑索引我的 sql 表之前应该有多少条记录？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-07T02:54:45.760

我会在创建表时创建索引条目。如果您决定在表增长到 100、1000、100000 个条目后创建索引，则可能会花费大量时间，并且可能会在您执行此操作时使您的数据库不可用。

首先考虑表格，创建您认为需要的索引，然后继续。

在某些情况下，您会发现您应该已经索引了一个列，如果是这样，当您发现它时修复它。

在搜索字段上创建索引不是预优化，它只是应该做的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-07T03:04:12.137

创建表时没有充分的理由放弃明显的索引（FK 等）。在小表上使用不必要的索引永远不会显着影响性能，当您考虑架构设计时，最好先考虑一下。此外，一些索引用于防止重复，无论表大小如何，这都是有用的。

我想您的问题的正确答案是表中的记录数应该与何时创建索引无关。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-07T02:54:03.937

当查询时间不可接受时。更好的是，现在创建一些可能有用的索引，并在您的数据库由代表性数据填充后对您的查询运行 EXPLAIN 或 EXPLAIN ANALYZE。如果索引没有帮助，请删除它们。如果存在可以从更多或不同索引中受益的慢查询，请更改索引。

您不会被锁定在索引的初始选择中。进行实验，并确保您*测量性能*！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-07T03:35:34.837

总的来说，我同意前面的建议。始终声明表（主键、外键）、列约束（不为空，检查）的引用完整性。当应用程序将不良数据放入表中时（即使在开发中），您也可以避免做噩梦。我也会考虑为公共访问列（在 =、<> 测试中使用的 where 子句中的列）添加索引。大多数现代 RDBMS 实现都非常擅长让您的索引保持最新，而不会影响您的性能。因此，拥有索引的成本是最小的。此外，大多数 RDBMS 都有查询计划评估器，它们通过索引或使用某种表扫描来查看数据行的相对成本。因此，再次对性能造成的影响很小。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-07T07:23:45.233

二。

我是认真的。如果现在有两行，并且总是有两行，那么索引成本几乎为零。索引比考虑是否应该更快。优化器很快就会发现扫描表比使用索引更快。

如果现在有两行，但在不久的将来会有 200,000 行，那么不建立索引的成本可能会变得高得令人望而却步。现在是考虑索引的正确时机。

话虽如此，请记住在声明主键时会自动获得索引。在大多数情况下，创建没有主键的表是自找麻烦。所以你真正需要考虑索引的唯一时间是当你想要一个索引而不是主键上的索引时。您需要了解流量以及拨打此电话的预期音量。如果你弄错了，你会知道的，你可以撤销决定。

我曾经看到一个包含 20 行的引用表，它是在没有索引的情况下创建的。由于业务变化，这个表已经增长到大约 900 行，但是应该注意到没有索引的人没有注意到。插入新订单的时间从大约 10 秒增加到 15 分钟。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-07T07:08:10.990

作为例行公事，我**在读取重表上**执行以下操作：

*   **创建表时，在常用连接字段**（例如外键）上创建索引。
*   检查视图或存储过程的查询计划，并**在指示表扫描的地方添加索引**。
*   检查我的应用程序的查询计划，并在指示表扫描的地方添加索引。（并且经常尝试将它们变成存储过程）

在**编写繁重的表**（如活动日志）时，除非绝对必要，否则我会避免使用索引。我也倾向于定期将这些数据归档到索引表中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-07T03:48:29.943

这取决于。

表中有多少数据？多久插入一次数据？很多索引会减慢插入时间。你总是查询表的所有行吗？在这种情况下，索引可能不会有太大帮助。

不过，这些不是常见的用法。在大多数情况下，您知道您将查询数据子集。在哪些领域？是否有始终连接的公共字段？查看常见或典型查询的查询计划，它通常会向您显示它在哪里花费了所有时间。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-07T07:15:38.137

如果表上有唯一约束（并且应该至少有一个），那么通常由唯一索引强制执行。

否则，当查询性能不佳时添加索引，添加索引将明显提高性能。有关于如何在表上创建良好索引集的书籍，包括[关系数据库索引设计和优化器](https://rads.stackoverflow.com/amzn/click/com/0471719994)。它会给你很多想法以及它们为什么好的原因。

也可以看看：

*   [小表上没有索引](https://stackoverflow.com/questions/252865/no-indexes-on-small-tables)
*   [何时创建新的 SQL Server 索引](https://stackoverflow.com/questions/250289/when-to-create-a-new-sql-server-index)
*   [创建索引的最佳实践和反模式](https://stackoverflow.com/questions/351615/best-practices-and-anti-patterns-in-creating-indexes-in-sql-server)

毫无疑问，还有许多其他人。

# windows - 如何找出 Windows 中使用的文件系统？最好在代码中

> ID：523034
> 
> 赞同：0
> 
> 时间：2009-02-07T02:59:45.453
> 
> 标签：windows, filesystems

如何找出 Windows 中使用的文件系统类型？最好在代码中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-07T03:18:46.150

```
function string get_FileSystem( strPath )
  object objFSO, objDrive;
begin
  set objFSO = CreateObject ( "Scripting.FileSystemObject" );
  if ( IsObject (objFSO) ) then
    try
      set objDrive = objFSO.GetDrive( objFSO.GetDriveName( strPath ) );
      if ( IsObject( objDrive ) ) then
        //Available return types include FAT, NTFS, FAT, FAT32, and CDFS
        return objDrive.FileSystem;
      endif;
    catch
      MessageBox( "Unable to determine File System.", INFORMATION );
    endcatch;
  endif;
end; 
```

来自[http://kb.acresso.com/selfservice/viewContent.do?externalID=Q107782](http://kb.acresso.com/selfservice/viewContent.do?externalID=Q107782)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T04:58:47.087

```
Console.WriteLine(new DriveInfo(Environment.SystemDirectory).DriveFormat); 
```

C＃

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T10:51:41.290

只需使用 Win32 api：自 1992 年以来的 Win32 常见问题解答！

（见新闻：//comp.os.ms-windows.programmer.win32）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T03:08:33.627

在资源管理器中右键单击驱动器，选择属性。文件系统应该显示在那里。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-04T12:04:49.920

这是可能对您有所帮助的代码

```
foreach (DriveInfo objDrive in DriveInfo.GetDrives())
{
        Response.Write("</br>Drive Type : " + objDrive.Name);
        Response.Write("</br>Drive Type : " + objDrive.DriveType.ToString());
        Response.Write("</br>Available Free Space : " + objDrive.AvailableFreeSpace.ToString() + "(bytes)");
        Response.Write("</br>Drive Format : " + objDrive.DriveFormat);
        Response.Write("</br>Total Free Space : " + objDrive.TotalFreeSpace.ToString() + "(bytes)");
        Response.Write("</br>Total Size : " + objDrive.TotalSize.ToString() + "(bytes)");
        Response.Write("</br>Volume Label : " + objDrive.VolumeLabel);
        Response.Write("</br></br>");

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T17:27:39.133

如果您指的是 Win32 而不是 .NET，请参阅 WinAPI GetVolumeInformation() 函数。[您可以在http://msdn.microsoft.com](http://msdn.microsoft.com)找到它的文档

# php - php - 根据浏览器链接中的参数自动选择下拉菜单

> ID：523038
> 
> 赞同：0
> 
> 时间：2009-02-07T03:03:30.220
> 
> 标签：php, drop-down-menu

如果在浏览器中我有如下参数：

```
http://localhost/specials.php?year=2009&make=honda&model=civic 
```

下拉列表看起来像这样：

```
<select name="year">
<?php
$query = mysql_query("select distinct year from tbl_content where year = '$year'");
while($row = mysql_fetch_assoc($query)) {

echo "<option value=\"{$row['year']}\">{$row['year']}</option>";
}
?>
</select> 
```

* * *

现在我要做的是在下拉选项值等于浏览器 URL 中的参数 year 时显示选择。

我试过这个：

```
<select name="year">
<?php
$query = mysql_query("select * from tbl_year
while($row = mysql_fetch_assoc($query)) {

#=============================
if(isset($_GET['year'])) {

$year = (int)$_GET['year'];
if($year == $row['year'] { $selected = "selected"; }
else { $selected = "";
}

echo "<option value=\"{$row['year']}\" {$selected}>{$row['year']}</option>";
}
?>
</select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T03:25:14.747

也许尝试`"selected='selected'"`使其有效的xml。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T03:40:48.663

```
<select name="year">
<?php

$selectedYear = NULL;

if(isset($_GET['year']))
    $selectedYear = (int)$_GET['year'];

$query = mysql_query('SELECT year FROM tbl_year GROUP BY year ORDER BY year ASC');

while($row = mysql_fetch_assoc($query)) {
    echo '<option value="' . htmlspecialchars($row['year']) . '"';

    if($selectedYear === (int)$row['year']) {
         echo ' selected="selected"';
    }

    echo '>' . htmlspecialchars($row['year']) . '</option>";
}

?>
</select> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T06:34:12.293

随意分离功能！

```
<?php
function selectList($name,$values,$labels=null,$selected=null){
if($labels==null) $labels=&$values;
    $data="<select name='$name'>";
    foreach($values as $k=>$v){
        $selected=($v==$selected)?'selected="selected"':false;
        $data.="<option value='$v' $selected>".htmlspecialchars($labels[$k])."</option>";
        }
        $data.="</select>";
        return $data;
}

$select=isset($_REQUEST['year'])?(int) $_REQUEST['year']:null;
$query=mysql_query("SELECT DISTINCT `year` FROM `tbl_year` ORDER BY `year`");
while(($row=mysql_fetch_assoc($query))!==false){
    $values[]=$row['year'];
    }
echo selectList("year",$values,null,$select);
?> 
```

# java - Tomcat 5.5 中的 URL 路由和相对链接

> ID：523051
> 
> 赞同：2
> 
> 时间：2009-02-07T03:12:44.897
> 
> 标签：java, jsp, tomcat, url-routing, friendly-url

我正在尝试将 URL 路由添加到在 Tomcat 5.5 中运行的 Web 应用程序。

我想让动态页面 URL 更友好，更改`main.jsp?type=test&group=info`为`main/test/info`风靡一时。

我在 web.xml 中设置了以下内容

```
 <servlet>
    <servlet-name>main</servlet-name>
    <jsp-file>/main.jsp</jsp-file>
  </servlet>
  <servlet-mapping>
    <servlet-name>main</servlet-name>
    <url-pattern>/main/*</url-pattern>
  </servlet-mapping> 
```

在 main.jsp 中，我`request.getPathInfo()`用来获取进行路由所需的数据。所有这一切似乎都很好，当我浏览到时，`http://mytestserver/example/main/test/info`我得到了我期望的 html。

问题是该页面上的任何相对链接、图像、样式表、javascript 等现在都已损坏，因为它们被解释为相对于完整 URL。

我想不出使用静态链接的简单方法，因为测试服务器和生产服务器上的 URL 处于不同的级别：`http://mytestserver/example/`映射到`http://example.com/`生产中，我真的不想编写代码来包装每个内部链接站点或在测试服务器上为每个站点设置一个虚拟服务器。

还有什么我可以做的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T04:03:20.537

我有一个这样的系统在工作。

我们使用一个名为[urlrewrite](http://tuckey.org/urlrewrite/)的包，它基本上是作为 j2ee 过滤器完成的 apache tomcat 重写器。这很酷，但我遇到了同样的问题。

为了解决这个问题，我编写了另一个过滤器，它在重写器*之前*插入到过滤器链中。它的工作是在重写器破坏它之前获取路径信息，并将该信息粘贴到请求属性中。它根据 Web 应用程序根目录的路径信息解析请求的路径信息，以计算出您需要多少个“../”才能到达 Web 应用程序的根目录（从客户端的角度来看）。

然后系统的其他组件使用该属性的内容来构建它们的相对 url。效果很好。

[系统在这里。](http://www.environment.gov.au/biodiversity/abrs/online-resources/fauna/afd/home "澳大利亚动物名录")

寻找任何分类单元（MACROPODIDAE 是一个不错的选择）。url 重新映射器将所有看起来像 REST 的链接变成请求参数。

给我发电子邮件在工作 - Paul.Murray@environment.gov.au 如果你想要一些来源。这不是秘密，但这是工作，所以我需要许可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T04:09:15.423

您可以使用一些方法来让您的生活更轻松：

1.  在文档的头部放置一个[基本元素。](http://www.w3schools.com/TAGS/tag_base.asp)如果添加`<base href="http://myserver/example/main"/>`标签，`<a href="test/info">Hi!</a>`则将链接到`http://myserver/example/main/test/info`.
2.  创建一个将为您生成绝对 url 的 jsp 标记（或函数），例如：`<myserver:a href="test/info">This is a link</myserver:a>`然后您可以在该标记中创建一个绝对 url 的逻辑。大多数应用程序框架（如 struts 和 spring）已经定义了这样的标签。

# sql - 如何在 SQL 中搜索 HTML 格式的文本？

> ID：523066
> 
> 赞同：0
> 
> 时间：2009-02-07T03:27:52.230
> 
> 标签：sql, sql-server-2000

我正在使用 Microsoft SQL Server 2000，但遇到了 3 个问题。

1.  我的网站将一些 HTML 格式的文本保存到一个`ntext`字段中。我如何搜索这个字段？
2.  我之前在这里问过一个问题（[如何从sql中的所有字段中搜索](https://stackoverflow.com/questions/520102)），但我需要知道搜索结果是在哪个字段中找到的。
3.  我保存了一些使用 .NET 加密的字段。如何搜索该字段？有可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T05:17:30.637

您可以使用 LIKE 或[PATINDEX()](http://msdn.microsoft.com/en-us/library/ms188395.aspx)在 ntext（或 nvarchar(max)）列中搜索[通配符表达式。](http://msdn.microsoft.com/en-us/library/ms187489.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T06:02:46.443

我的加密在这里>>

```
public string Encrypt(string strText, string strEncKey)
    {
        Byte[] byKey;
        Byte[] IV ={ 0x12, 0x34, 0x54, 0x78, 0x90, 0xAB, 0xCD, 0xEF };
        byKey = Encoding.UTF8.GetBytes(strEncKey);
        DESCryptoServiceProvider des = new DESCryptoServiceProvider();
        byte[] inputByteArray = Encoding.UTF8.GetBytes(strText);
        MemoryStream ms = new MemoryStream();
        CryptoStream cs = new CryptoStream(ms, des.CreateEncryptor(byKey, IV), CryptoStreamMode.Write);
        cs.Write(inputByteArray, 0, inputByteArray.Length);
        cs.FlushFinalBlock();
        return Convert.ToBase64String(ms.ToArray());
    }
    public string Decrypt(string strText, string strEncKey)
    {
        Byte[] byKey;
        Byte[] IV ={ 0x12, 0x34, 0x54, 0x78, 0x90, 0xAB, 0xCD, 0xEF };
        Byte[] inputByteArray;

        byKey = Encoding.UTF8.GetBytes(strEncKey.Substring(0, 8));
        DESCryptoServiceProvider des = new DESCryptoServiceProvider();
        inputByteArray = Convert.FromBase64String(strText);

        MemoryStream ms = new MemoryStream();
        CryptoStream cs = new CryptoStream(ms, des.CreateDecryptor(byKey, IV), CryptoStreamMode.Write);
        cs.Write(inputByteArray, 0, inputByteArray.Length);
        cs.FlushFinalBlock();

        return System.Text.Encoding.UTF8.GetString(ms.ToArray());
    } 
```

使用 >>

```
Encrypt(value, "&%#@?,:*");
Decrypt(value, "&%#@?,:*"); 
```

# c - 在 solaris 上用 C 语言打开 fopen

> ID：523084
> 
> 赞同：1
> 
> 时间：2009-02-07T03:42:34.213
> 
> 标签：c, file, solaris

我一直试图让这段代码工作几个小时！我需要做的就是打开一个文件，看看它是否真实且可读。我是 C 的新手，所以我确定我缺少一些愚蠢的东西。这是代码（速记，但已复制）：

```
#include <stdio.h>

main() {
    char fpath[200];
    char file = "/test/file.this";
    sprintf(fpath,"~cs4352/projects/proj0%s",file);

    FILE *fp = fopen(fpath,"r");
    if(fp==NULL) {
        printf("There is no file on the server");
        exit(1);
    }
    fclose(fp);
    //do more stuff
} 
```

我还验证了路径是否正确指定了我具有读取权限的真实文件。还有其他想法吗？

**编辑 1：**我知道 fpath 以“~cs4352/projects/proj0/test/file.this”结尾

**编辑2：**我也尝试过使用绝对文件路径。在这两种情况下，我都可以通过 ls 验证路径是否正确构建。

**编辑 3：**有`errno`2...我目前正在尝试跟踪这在谷歌中的含义。

**编辑 4：** 好的，`errno`其中 2 是“没有这样的文件或目录”。当 fopen 中的参考路径是“/home/courses1/cs4352/projects/proj0/index.html”时，我得到了这个，我验证它确实存在并且我拥有它的阅读权限。至于下面列出的 C 代码，其中可能存在一些语义/新手错误，但 gcc 没有给我任何编译时警告，并且代码完全按照它应该的方式工作，只是它说它一直`errno`在吐 2。换句话说，我知道所有的字符串/字符数组都正常工作，但唯一可能成为问题的是`fopen()`调用。

**解决方案：** 好的，access() 过程对我帮助最大（我仍在使用它，因为它的代码更少，更不用说更优雅的方式了）。问题实际上来自于我没有向大家解释过的东西（因为直到我使用 access() 才看到它）。为了导出文件，我使用 strtok() 拆分字符串并且只在“\n”上拆分，但因为这是一个 UNIX 系统，我还需要在其中添加“\r”。一旦我解决了这个问题，一切就都到位了，我确信 fopen() 函数也能正常工作，但我还没有测试过。

感谢大家的有益建议，尤其感谢 Paul Beckingham 找到了这个绝妙的解决方案。

干杯!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T04:24:22.053

1.  "~" 是由 shell 扩展的，而不是由 fopen 扩展的。
2.  要测试文件的存在性和可读性，请考虑使用 POSIX.1 “访问”功能：

```
#include <unistd.h>

if (访问 ("/path/to/file", F_OK | R_OK) == 0)
{
  // 文件存在且可读
}

```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-07T03:59:54.147

首先，`file`需要声明为`char*`or `const char*`，而不是`char`像你写的那样简单。但这可能只是一个错字，编译器至少应该在那里给出警告。

其次，使用绝对路径（或相对于当前目录的路径），而不是带有`~`. 相应主目录的替换`~cs4352`通常由 shell 完成，但您是直接打开文件。所以你试图在`~cs4352`你当前工作目录的子目录中打开一个文件，我猜这不是你想要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T07:05:51.760

其他人可能已经产生了等价物（例如，每个现代 shell），但这里有一些代码可以用 ~ 或 ~user 符号扩展文件名。

```
#if __STDC_VERSION__ >= 199901L
#define _XOPEN_SOURCE 600
#else
#define _XOPEN_SOURCE 500
#endif

#include <assert.h>
#include <limits.h>
#include <pwd.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

char *relfname(const char *name, char *buffer, size_t bufsiz)
{
    assert(name != 0 && buffer != 0 && bufsiz != 0);
    if (name[0] != '~')
        strncpy(buffer, name, bufsiz);
    else
    {
        const char *copy;
        struct passwd *usr = 0;
        if (name[1] == '/' || name[1] == '\0')
        {
            usr = getpwuid(getuid());
            copy = &name[1];
        }
        else
        {
            char username[PATH_MAX];
            copy = strchr(name, '/');
            if (copy == 0)
                copy = name + strlen(name);
            strncpy(username, &name[1], copy - &name[1]);
            username[copy - &name[1]] = '\0';
            usr = getpwnam(username);
        }
        if (usr == 0)
            return(0);
        snprintf(buffer, bufsiz, "%s%s", usr->pw_dir, copy);
    }
    buffer[bufsiz-1] = '\0';
    return buffer;
}

#ifdef TEST
static struct { const char *name; int result; } files[] =
{
    { "/etc/passwd", 1 },
    { "~/.profile", 1 },
    { "~root/.profile", 1 },
    { "~nonexistent/.profile", 0 },
};

#define DIM(x)  (sizeof(x)/sizeof(*(x)))

int main(void)
{
    int i;
    int fail = 0;
    for (i = 0; i < DIM(files); i++)
    {
        char buffer[PATH_MAX];
        char *name = relfname(files[i].name, buffer, sizeof(buffer));
        if (name == 0 && files[i].result != 0)
        {
            fail++;
            printf("!! FAIL !! %s\n", files[i].name);
        }
        else if (name != 0 && files[i].result == 0)
        {
            fail++;
            printf("!! FAIL !! %s --> %s (unexpectedly)\n", files[i].name, name);
        }
        else if (name == 0)
            printf("** PASS ** %s (no match)\n", files[i].name);
        else
            printf("** PASS ** %s -> %s\n", files[i].name, name);
    }
    return((fail == 0) ? EXIT_SUCCESS : EXIT_FAILURE);
}

#endif 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T03:58:49.313

您可以尝试检查`errno`有关您没有获得有效`FILE*`.

顺便说一句——在 unix 中，全局值`errno`是由一些库和系统调用设置的，当它们需要返回更多信息而不仅仅是“它不起作用”时。仅保证在相关调用后立即良好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T03:45:48.980

char file = "/test/file.this";

你可能想要

char *file = "/test/file.this";

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T03:47:07.637

你确定你不是那个意思

~/cs4352/projects/proj0%s"

为您的主目录？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-07T04:35:08.803

总结一下：

1.  使用 char *file=/test/file.this";
2.  不要指望 fopen() 对 ~ 进行 shell 替换，因为它不会。使用完整路径或使用相对路径，并确保当前目录是适当的。
3.  错误 2 表示未找到该文件。由于此列表中的第 2 项，未找到它。

为了获得额外的荣誉，像这样使用 sprintf() 写入分配在堆栈上的缓冲区是一种危险的习惯。至少查找并使用 snprintf()。

正如这里的其他人所提到的，使用 access() 将是一种更好的方式来做你在这里尝试的事情。

# sql - 重写 MySQL 查询

> ID：523087
> 
> 赞同：2
> 
> 时间：2009-02-07T03:47:03.737
> 
> 标签：sql, mysql, subquery, limit

我将尝试在另一个问题上更好地解释这一点。这是我认为应该可以工作的查询，但是，当然，MySQL 不支持这个特定的子选择查询：

```
select *
  from articles a
  where a.article_id in
      (select f.article_id
        from articles f
        where f.category_id = a.category_id
        order by f.is_sticky, f.published_at
        limit 3) /* limit isn't allowed inside a IN subquery */ 
```

我要存档的是：在文章表中，我有几篇文章用于几个类别。我需要为每个类别（任意数量的类别）获得最多三篇文章。

这是数据：

```
CREATE TABLE articles (
  article_id int(10) unsigned NOT NULL AUTO_INCREMENT,
  category_id int(10) unsigned NOT NULL,
  title varchar(100) NOT NULL,
  is_sticky boolean NOT NULL DEFAULT 0,
  published_at datetime NOT NULL,
  PRIMARY KEY (article_id)
);

INSERT INTO articles VALUES
(1, 1, 'foo', 0, '2009-02-06'),
(1, 1, 'bar', 0, '2009-02-07'),
(1, 1, 'baz', 0, '2009-02-08'),
(1, 1, 'qox', 1, '2009-02-09'),

(1, 2, 'foo', 0, '2009-02-06'),
(1, 2, 'bar', 0, '2009-02-07'),
(1, 2, 'baz', 0, '2009-02-08'),
(1, 2, 'qox', 1, '2009-02-09'); 
```

我要检索的是以下内容：

```
1, 1, qox, 1, 2009-02-09
1, 1, foo, 0, 2009-02-06
1, 1, bar, 0, 2009-02-07
1, 2, qox, 1, 2009-02-09
1, 2, foo, 0, 2009-02-06
1, 2, bar, 0, 2009-02-07 
```

请注意“quox”是如何在其类别中跃居首位的，因为它具有粘性。

你能想出一种方法来避免子查询中的 LIMIT 吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T04:18:21.490

这是您的解决方案的简化

```
 select *
  from articles a
  where a.article_id =
      (select f.article_id
        from articles f
        where f.category_id = a.category_id
        order by f.is_sticky, f.published_at
        limit 1) or a.article_id =
      (select f.article_id
        from articles f
        where f.category_id = a.category_id
        order by f.is_sticky, f.published_at
        limit 1, 1) or 
    a.article_id =
      (select f.article_id
        from articles f
        where f.category_id = a.category_id
        order by f.is_sticky, f.published_at
        limit 2, 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T04:29:36.177

看看这个名为[组内配额（每组前 N 个）的](http://www.artfulsoftware.com/infotree/queries.php?&bw=1271#104)代码片段。

根据您的集合的大小，提出了两种解决方案，一种使用计数，另一种使用临时表用于更大的表。

所以基本上，如果你有一个大表，在 MySQL 在子查询或类似的东西中实现 LIMIT 之前，你必须手动（好吧，或者在循环中使用动态查询）将所有类别与此处建议的解决方案之一聚合.

* * *

**// 使用临时表和存储过程的解决方案：**

运行一次：

```
DELIMITER //
CREATE PROCEDURE top_articles()
BEGIN
    DECLARE done INT DEFAULT 0;
    DECLARE catid INT;
    DECLARE cur1 CURSOR FOR SELECT DISTINCT(category_id) FROM articles;
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;
    OPEN cur1;
    # This temporary table will hold all top N article_id for each category
    CREATE TEMPORARY TABLE top_articles (
        article_id int(10) unsigned NOT NULL
    );
    # Loop through each category
    REPEAT
        FETCH cur1 INTO catid;
        INSERT INTO top_articles
        SELECT article_id FROM articles
        WHERE category_id = catid
        ORDER BY is_sticky DESC, published_at
        LIMIT 3;
    UNTIL done END REPEAT;
    # Get all fields in correct order based on our temporary table
    SELECT * FROM articles WHERE article_id 
    IN (SELECT article_id FROM top_articles)
    ORDER BY category_id, is_sticky DESC, published_at;
    # Remove our temporary table
    DROP TEMPORARY TABLE top_articles;
END;
//
DELIMITER ; 
```

然后，尝试一下：

```
CALL top_articles(); 
```

您应该看到您正在等待的结果。它应该适用于每个类别的任意数量的文章，并且很容易适用于任意数量的类别。这就是我得到的：

```
+------------+-------------+-------+-----------+---------------------+
| article_id | category_id | title | is_sticky | published_at        |
+------------+-------------+-------+-----------+---------------------+
|          5 |           1 | qox   |         1 | 2009-02-09 00:00:00 | 
|          1 |           1 | foo   |         0 | 2009-02-06 00:00:00 | 
|          2 |           1 | foo   |         0 | 2009-02-06 00:00:00 | 
|          9 |           2 | qox   |         1 | 2009-02-09 00:00:00 | 
|          6 |           2 | foo   |         0 | 2009-02-06 00:00:00 | 
|          7 |           2 | bar   |         0 | 2009-02-07 00:00:00 | 
+------------+-------------+-------+-----------+---------------------+ 
```

虽然我不知道它会如何翻译性能。它可能可以稍微优化和清理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T04:09:03.553

我找到了一个（可怕的，可怕的）解决方法，我什至可能不应该发布，但是......

```
select *
  from articles a
  where a.article_id =
      (select f.article_id
        from articles f
        where f.category_id = a.category_id
        order by f.is_sticky, f.published_at
        limit 1)
union
select *
  from articles a
  where a.article_id =
      (select f.article_id
        from articles f
        where f.category_id = a.category_id
        order by f.is_sticky, f.published_at
        limit 1, 1)
union
select *
  from articles a
  where a.article_id =
      (select f.article_id
        from articles f
        where f.category_id = a.category_id
        order by f.is_sticky, f.published_at
        limit 2, 1)
order by category_id 
```

由于我每个类别只需要三篇文章，我可以重复查询三次（而不是对每个类别重复）一次用于所有类别中的第一篇文章，一次用于第二篇文章，一次用于所有类别中的第三篇文章和连接它们全部并按类别排序。

似乎不支持 LIMIT 与 IN 结合使用，但一次检索一条记录就可以了。

如果您有更好的方法，我仍然对您的解决方案感兴趣。

谢谢

# apache-flex - 有什么方法可以分析 Flex 中内置的 SWF 的大小？

> ID：523089
> 
> 赞同：4
> 
> 时间：2009-02-07T03:47:22.863
> 
> 标签：apache-flex, optimization, filesize

我有一个看起来比它应该大的 Flex 应用程序。里面有很多代码，但资产不多，而且看起来很大，但我不确定如何弄清楚空间的去向。

我知道 –link-report 选项，但它只提供外部链接库类的大小。我对查看我的应用程序中所有类和资源的大小的报告非常感兴趣，如果我还可以查看它们的依赖关系，那将是一个巨大的好处。不知道代码是如何编译的，我不确定这是否可能，但似乎应该这样做，因为编译器可以给我从其他库链接的各个类的大小。

我做了一些搜索，但找不到任何有用的东西。一切都指向模块化和外部链接库的优化技术，我理解并将实施，但我真的很喜欢我编译的应用程序的一些更详细的报告。

需要明确的是，我对如何减小文件大小的技巧并不感兴趣，只是关于用于什么以及哪些类引用了什么的报告。

有人有什么想法吗？

***更正 - 链接报告确实显示了所有类。我在 Flex Builder 中的特定项目有几个 CSS 文件设置为编译为 swfs。我的主应用程序链接报告被这些 css 编译覆盖了！***

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T06:33:37.287

链接报告实际上包含所有已编译的类，而不仅仅是外部库中的那些（至少对于 Flex 4 SDK）。有一个可用的 xsl 将生成链接报告的 html 文件，因此更易于阅读。

检查这篇文章：[http ://blog.iconara.net/2007/02/25/visualizing-mxmlcs-link-report/](http://blog.iconara.net/2007/02/25/visualizing-mxmlcs-link-report/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T17:56:56.173

有一个名为`flash.swf.tools.SwfxPrinter`in的命令行实用程序`swfkit.jar`，它与 Flex Builder（或插件或 SDK）一起提供，您可以使用它来分析有关类大小的信息。Joe Berkovitz在他的博客中[写了一些](http://joeberkovitz.com/blog/2007/04/08/secret-life-of-swfs/)关于如何使用它的很好的说明，他正在开发一个利用它的基于 AIR 的 GUI 工具，但我不确定他是否曾经发布过该工具。不过，您可以使用他的说明直接从 JAR 中利用该实用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-07T17:18:18.110

我找到了一个方便的小 AIR 应用程序，它确实有助于组织链接报告信息。

[http://www.kahunaburger.com/2008/03/08/air-link-report-visualizer/](http://www.kahunaburger.com/2008/03/08/air-link-report-visualizer/)

它很旧，但仍然很好用。

# sql-server - sql cross join - 有人发现它有什么用处？

> ID：523091
> 
> 赞同：11
> 
> 时间：2009-02-07T03:50:38.567
> 
> 标签：sql-server, database, tsql, cross-join

今天，在使用 sql server 开发 10 年来，我第一次在生产查询中使用了交叉联接。我需要将结果集填充到报告中，并发现使用创造性 where 子句在两个表之间进行交叉连接是一个很好的解决方案。我想知道有人在交叉连接的生产代码中发现了什么用途？

更新：Tony Andrews 发布的代码与我使用交叉连接的代码非常接近。相信我，我理解使用交叉连接的含义并且不会轻易这样做。我很高兴终于使用了它（我真是个书呆子）——有点像我第一次使用完全外连接的时候。

感谢大家的回答！这是我使用交叉连接的方式：

```
SELECT  CLASS, [Trans-Date] as Trans_Date,
SUM(CASE TRANS
     WHEN 'SCR' THEN [Std-Labor-Value]
     WHEN 'S+' THEN [Std-Labor-Value]
     WHEN 'S-' THEN [Std-Labor-Value]
     WHEN 'SAL' THEN [Std-Labor-Value]
     WHEN 'OUT' THEN [Std-Labor-Value]
     ELSE 0
END) AS [LABOR SCRAP],
SUM(CASE TRANS
     WHEN 'SCR' THEN  [Std-Material-Value]
     WHEN 'S+' THEN [Std-Material-Value]
     WHEN 'S-' THEN  [Std-Material-Value]
     WHEN 'SAL' THEN [Std-Material-Value]
     ELSE 0
END) AS [MATERIAL SCRAP], 
SUM(CASE TRANS WHEN 'RWK' THEN [Act-Labor-Value] ELSE 0 END) AS [LABOR REWORK],
SUM(CASE TRANS 
     WHEN 'PRD' THEN  [Act-Labor-Value]
     WHEN 'TRN' THEN  [Act-Labor-Value]
     WHEN 'RWK' THEN  [Act-Labor-Value]
     ELSE 0 
END) AS [ACTUAL LABOR],
SUM(CASE TRANS 
     WHEN 'PRD' THEN  [Std-Labor-Value]
     WHEN 'TRN' THEN   [Std-Labor-Value]
     ELSE 0 
END) AS [STANDARD LABOR],
SUM(CASE TRANS 
     WHEN 'PRD' THEN  [Act-Labor-Value] - [Std-Labor-Value]
     WHEN 'TRN' THEN  [Act-Labor-Value] - [Std-Labor-Value]
     --WHEN 'RWK' THEN  [Act-Labor-Value]
     ELSE 0 END) -- - SUM([Std-Labor-Value]) -- - SUM(CASE TRANS WHEN 'RWK' THEN [Act-Labor-Value] ELSE 0 END) 
AS [LABOR VARIANCE] 
FROM         v_Labor_Dist_Detail
where [Trans-Date] between @startdate and @enddate
    --and CLASS = (CASE @class WHEN '~ALL' THEN CLASS ELSE @class END)
GROUP BY  [Trans-Date], CLASS
UNION  --REL 2/6/09 Pad result set with any missing dates for each class. 
select distinct [Description] as class,  cast([Date] as datetime) as [Trans-Date], 0,0,0,0,0,0 
FROM Calendar_To_Fiscal cross join PRMS.Product_Class
where cast([Date] as datetime) between @startdate and @enddate and
not exists (select class FROM v_Labor_Dist_Detail vl where [Trans-Date] between @startdate and @enddate
                    and vl.[Trans-Date] = cast(Calendar_To_Fiscal.[Date] as datetime)
                    and vl.class= PRMS.Product_Class.[Description]
                GROUP BY [Trans-Date], CLASS)
order by [Trans-Date], CLASS 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-07T11:03:32.203

交叉连接的典型合法用途是显示例如按产品和地区的总销售额的报告。如果区域 R 中的产品 P 没有销售，那么我们希望看到一行为零，而不是不显示一行。

```
select r.region_name, p.product_name, sum(s.sales_amount)
from regions r
cross join products p
left outer join sales s on  s.region_id = r.region_id
                        and s.product_id = p.product_id
group by r.region_name, p.product_name
order by r.region_name, p.product_name; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-09T22:44:37.953

我经常遇到的一种用途是将记录分成几条记录，主要用于报告目的。

想象一个字符串，其中每个字符代表相应小时内的某个事件。

```
ID | Hourly Event Data
1  | -----X-------X-------X--
2  | ---X-----X------X-------
3  | -----X---X--X-----------
4  | ----------------X--X-X--
5  | ---X--------X-------X---
6  | -------X-------X-----X-- 
```

现在您需要一份报告，显示在哪一天发生了多少事件。使用 ID 为 1 到 24 的表交叉连接表，然后施展你的魔法......

```
SELECT
   [hour].id,
   SUM(CASE WHEN SUBSTRING([data].string, [hour].id, 1) = 'X' THEN 1 ELSE 0 END)
FROM
   [data]
CROSS JOIN
   [hours]
GROUP BY
   [hours].id 
```

=>

```
1,  0
2,  0
3,  0
4,  2
5,  0
6,  2
7,  0
8,  1
9,  0
10, 2
11, 0
12, 0
13, 2
14, 1
15, 0
16, 1
17, 2
18, 0
19, 0
20, 1
21, 1
22, 3
23, 0
24, 0 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T04:24:44.457

我有不同的报告预先过滤记录集（按公司内的各种业务线），但有计算需要公司范围内的收入百分比。记录源必须包含公司总数，而不是依赖于计算报告本身中的总和。

示例：记录集包含每个客户的余额以及客户收入来源的业务线。该报告可能只显示“零售”客户。无法获得整个公司的余额总和，但报告显示了公司收入的百分比。

由于有不同的余额字段，我觉得完全联接具有多个余额的视图（我也可以重用该公司总计的视图）而不是多个字段组成子查询并不那么复杂。

另一种是更新语句，其中需要创建多条记录（预设工作流程中的每个步骤都有一条记录）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-20T19:52:09.063

这是一个，CROSS JOIN 代替了 INNER JOIN。当要连接的两个表之间没有相同的值时，这是有用且合法的。例如，假设您有一个表，其中包含某个语句或公司文档的版本 1、版本 2 和版本 3，所有这些都保存在 SQL Server 表中，以便您可以即时重新创建与订单关联的文档，在订单很久之后，并且在您的文档被重写为新版本之后很久。但是您需要连接的两个表（Documents 表）中只有一个具有 VersionID 列。这是一种方法：

```
SELECT DocumentText, VersionID = 
    (
    SELECT d.VersionID                               
    FROM Documents d 
    CROSS JOIN Orders o
    WHERE o.DateOrdered BETWEEN d.EffectiveStart AND d.EffectiveEnd
    )
FROM Documents 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T02:06:17.270

我最近在我们用于销售预测的报告中使用了 CROSS JOIN，该报告需要细分销售人员在每个总帐帐户中所做的销售量。

因此，在报告中，我为此做了一些事情：

```
SELECT gla.AccountN, s.SalespersonN
FROM
    GLAccounts gla
    CROSS JOIN Salesperson s
WHERE (gla.SalesAnalysis = 1 OR gla.AccountN = 47500) 
```

这给了我每个销售人员的每个 GL 帐户，例如：

```
销售Psn AccountN
1000 40100
1000 40200
1000 40300
1000 48150
1000 49980
1000 49990
1005 40100
1005 40200
1005 40300
1054 48150
1054 49980
1054 49990
1078 40100
1078 40200
1078 40300
1078 48150
1078 49980
1078 49990
1081 40100
1081 40200
1081 40300
1081 48150
1081 49980
1081 49990
1188 40100
1188 40200
1188 40300
1188 48150
1188 49980
1188 49990

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-20T14:31:48.593

对于每个分组都必须有记录的图表（报告），即使它为零。（例如 RadCharts）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-11T16:36:58.930

我从源数据中获得了 am insolvency 字段的组合。有 5 种不同的类型，但数据包含其中 2 种的组合。所以我创建了 5 个不同值的查找表，然后使用交叉连接插入语句来填写其余部分。像这样

```
insert into LK_Insolvency (code,value)

select a.code+b.code, a.value+' '+b.value 
from LK_Insolvency a
cross join LK_Insolvency b
where a.code <> b.code <--this makes sure the x product of the value with itself is not used as this does not appear in the source data. 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-02-07T03:57:48.240

我个人尽量避免在我的查询中使用笛卡尔积。我想你的加入的每个组合都有一个结果集可能很有​​用，但通常如果我最终得到一个，我知道我有问题。

# apache-flex - 如何禁用 Flex 中的默认打开菜单效果？

> ID：523096
> 
> 赞同：3
> 
> 时间：2009-02-07T03:56:34.857
> 
> 标签：apache-flex, effect, menubar

默认情况下，在 Flex 3.2 中，单击 MenuBar 导航器中的项目会导致菜单在一小段时间内展开。

我将如何禁用它并使菜单立即弹出？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T05:12:47.573

将`Menu#openDuration`样式设置为 0。

# php - 正则表达式 http/www 到链接

> ID：523104
> 
> 赞同：1
> 
> 时间：2009-02-07T04:04:28.443
> 
> 标签：php, regex

使以 http 或 www 开头的文本可点击的正则表达式看起来如何？

我目前的bbcode：

```
函数 bbcode($text) {
$text = htmlspecialchars($text);
$text = nl2br($text);

$查找 = 数组（
              "'\[b\](.*?)\[/b\]'是",
              "'\[i\](.*?)\[/i\]'i",
              "'\[url\](.*?)\[/url\]'i"
              );

$替换=数组（
              "\\1",
              "\\1",
              “\\1”
                );

$text = preg_replace($find, $replace, $text);

返回$文本；
}

```

如您所见，我将 [url]link[/url] 用于链接 ATM。

提前致谢。

PS替换数组中的html不会显示...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T04:14:17.207

这是一个很好的简单方法：

```
Find: (http://[^ ]+)
Replace: <a href="\\1">\\1</a>

Find: (www\.[a-zA-Z0-9\-]\.[^ ]+)
Replace: <a href="\\1">\\1</a> 
```

# search - 推荐一个基于 linux 的站点搜索引擎？

> ID：523106
> 
> 赞同：0
> 
> 时间：2009-02-07T04:05:10.610
> 
> 标签：search, search-engine

我需要一个站点搜索引擎来搜索我的会员专属内容。我以前使用过[流体动力学搜索引擎](http://www.xav.com/scripts/search/)，但想知道最近是否有任何更新。

需要通过站点抓取而不是文件系统抓取来索引内容，因为所有内容都在数据库中。还需要在 FreeBSD/Linux 下运行。

是的，对不起，不是编程……但这是获得好答案的最佳场所！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T04:40:28.857

您可能会对来自[Apache Lucene项目的](http://lucene.apache.org/)[Solr感兴趣。](http://lucene.apache.org/solr/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T04:57:38.960

另一个优秀的是[Xapian](http://xapian.org/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T04:43:28.817

狮身人面像也应该不错：

[狮身人面像搜索](http://www.sphinxsearch.com/)

# java - 如何通过java代码设置或导出显示变量？

> ID：523107
> 
> 赞同：1
> 
> 时间：2009-02-07T04:06:33.103
> 
> 标签：java

我们需要添加`export DISPLAY=:0.0`tomcat的启动文件和批处理服务器的启动文件。这是为了让 java 在 Unix 上看到 X11 Display 库并运行我们的小程序。如果启动文件中没有此导出，则小程序将引发 Headless Exception。

尽管此显式导出使 java 小程序运行，但它会破坏服务器上运行的其他应用程序。有没有办法让我`export DISPLAY=:0.0`在java代码中运行它而不是将它添加到启动文件中？如果可能，那会是一个好方法吗？

我已经尝试将系统属性设置为`-Djava.awt.headless=true`，但没有成功。正如上面给出的链接[http://java.sun.com/developer/technicalArticles/J2SE/Desktop/headless/](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/headless/)还说设置 headless=true 仅适用于 Canvas、Panel 等少数组件，但不适用于顶部级组件。

所以我觉得留给我的唯一选择是使用`export DISPLAY=:0.0`. 这使我的小程序在启动文件中设置时可以工作，但会导致服务器中运行的其他应用程序出现问题。因此，如果有人可以帮助我进行`export DISPLAY=:0.0`工作，使其不会干扰服务器中的其他应用程序。我认为的一种方法是通过代码导出显示。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T05:35:55.310

我相信您实际上可以设置系统属性，该属性`-Djava.awt.headless=true`将允许访问图形库而无需实际显示。

有关详细信息，请参阅[http://java.sun.com/developer/technicalArticles/J2SE/Desktop/headless/](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/headless/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T07:39:44.610

从您的问题来看，您的配置似乎存在严重问题。Tomcat 应该**始终**能够在没有显示的情况下在服务器端运行。小程序**总是**在浏览器中运行并从浏览器获取 x11 环境。小程序的 jar 可以由 tomcat、apache 或其他东西提供服务，但这无关紧要。

如果您的 applet 与服务器通信，请确保服务器代码与您的 applet 代码完全分开（将它们保存在单独的项目中）并且不使用任何 awt 代码。如果确实如此（用于图像处理等），则使用 -Djava.awt.headless ，如 jdewald 所说。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T13:10:39.807

这对其他应用程序有何影响？您如何在启动脚本中定义环境变量？如果您正确定义变量，它应该只影响由您的启动脚本启动的程序，即Tomcat 和批处理服务器。

此外，您最初的问题并没有真正加起来。您是否在同一台机器上同时运行服务器和客户端（Tomcat 和 Web 浏览器）？

# php - PHP无响应问题

> ID：523113
> 
> 赞同：1
> 
> 时间：2009-02-07T04:09:53.190
> 
> 标签：php, no-response

我有这段代码要显示，但无论我怎么做，我都没有得到任何响应或错误。

```
<?php
$day = array("Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo");
//$month[]= array("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre");

function today(){
    $d = date("N");
    switch ($d){
        case 1: 
            echo $day[1];
            break;
        case 2:
            echo $day[2];
            break;
        case 3:
            echo $day[3];
            break;
        case 4:
            echo $day[4];
            break;
        case 5:
            echo $day[5];
            break;
        case 6:
            echo $day[6];
            break;
        case 7:
            echo $day[7];
            break;
    }
} 
today();
?> 
```

任何人都可以看到我可能犯的任何明显的错误并且没有注意到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T04:16:30.697

您需要添加

```
global $day; 
```

在你的函数的顶部。

查看 PHP 手册[`variable scoping`](http://us3.php.net/global)了解更多信息。除此之外，正如[The.Anti.9 提到](https://stackoverflow.com/questions/523113/php-no-response-issue/523118#523118)的，你可以这样做：

```
$days = array("Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo");
function today() {
    global $days;
    echo $days[date("N")-1];
}
today(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T04:14:40.343

好吧，我看不出有什么错误，但你可以这样做

```
echo $day[date('N')-1]; 
```

你需要记住数组索引从 0 开始而不是 1。所以 $day[7] 会给你索引错误，因为没有 7。

编辑：

正如[paoloa bergantino](https://stackoverflow.com/users/16417/paolo-bergantino)指出的那样。您需要将 $day 变量设为全局变量，或者您可以将它放在函数的范围内。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T04:22:22.013

由于`date('N')`返回星期几（1 - 7），您还可以创建一个基于 1 的索引数组：

```
$day = array(1 => "Lunes","Martes","Miércoles","Jueves",
                  "Viernes","Sábado","Domingo");
echo $day[date('N')]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-07T04:33:58.430

避免使用全局变量（这[通常是个坏主意](http://en.wikipedia.org/wiki/Global_variable)）。您可以将变量传递给函数。

因此将函数声明更改为

```
function today($day) 
```

和最后一个函数调用

```
today($day); 
```

请注意，这两个 $day 是不一样的。

这`function today($day)`只是说此函数中的每个 $day 变量都将包含作为此参数传入的值。它**不是**您声明的数组。因此，您可以将其更改为您想要的任何有效的 php 变量名称，以及函数范围内的所有 $days，结果将保持不变。

`today($day)`就是说将您之前声明的 $day 传递给`Array`function `today`。

# performance - 性能基准测试的最佳实践

> ID：523143
> 
> 赞同：3
> 
> 时间：2009-02-07T04:40:28.107
> 
> 标签：performance, jakarta-ee, benchmarking

我有一个在带有`OpenSolaris/Glassfish`堆栈的 Sun 硬件上运行的 J2EE Web 应用程序。我们正在开始我们的性能基准测试，为以后的可扩展性需求做准备。

任何指南/最佳实践都会非常有用..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T20:01:28.190

对于免费的开源工具，我发现 Apache 的 Jmeter 非常好：http: [//jmeter.apache.org/](http://jmeter.apache.org/)

正如乔所说，您需要弄清楚如何为用户行为建模并模拟用户负载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-09T08:20:49.213

如果您使用的是 JUnit？对于 JUnit 中的简单时间测量，有[JUnitPerf](http://clarkware.com/software/JUnitPerf.html)也支持 LoadTests。JUnit 4 没有得到很好的支持，但它对我有用。ContiPerf 是一种替代方案，它还支持注释以便于配置。我在使用 JMeter 之前使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T01:12:05.047

我确信有很多通用的方法可以在 Web 上找到测试服务器性能的方法。

但是你有没有想过这或许是一个收集[故事](http://www.extremeprogramming.org/rules/userstories.html)和编写测试的机会，以准确地调整你的用户将如何使用服务器？即使它不能完美地反映服务器最终的工作方式，它也会让你开始学习一些东西，而不仅仅是正式的练习。我想这就是[敏捷开发](http://en.wikipedia.org/wiki/Agile_software_development)的精神。

# sql - 是否有高效的 SQL 来查询大表的一部分

> ID：523145
> 
> 赞同：1
> 
> 时间：2009-02-07T04:42:11.957
> 
> 标签：sql, performance

选择数据的典型方法是：

```
select * from my_table 
```

但是如果表包含 1000 万条记录，而您只需要 300,010 到 300,020 条记录怎么办？

有没有办法在 Microsoft SQL 上创建一次只能获取 10 条记录的 SQL 语句？

例如

```
select * from my_table from records 300,010 to 300,020 
```

这比通过网络检索 1000 万条记录、将它们存储在 IIS 服务器中然后计数到所需的记录要高效得多。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T04:47:51.353

`SELECT * FROM my_table`只是冰山一角。假设您正在谈论一个带有主键标识字段的表，您可以说：

```
SELECT * FROM my_table WHERE ID >= 300010 AND ID <= 300020 
```

您还应该知道，在许多圈子中，选择 * 被认为是不好的做法。他们希望您指定确切的列列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T04:49:09.150

尝试查看有关分页的信息。这是[SQL Server](http://www.singingeels.com/Articles/Pagination_In_SQL_Server_2005.aspx)的简短摘要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T04:48:58.200

绝对地。在 MySQL 和 PostgreSQL（我用过的两个数据库）上，语法是

```
SELECT [columns] FROM table LIMIT 10 OFFSET 300010; 
```

在 MS SQL 上，它类似于`SELECT TOP 10 ...`; 我不知道偏移记录列表的语法。

请注意，您永远不想使用`SELECT *`; 如果有任何变化，那将是一场维护噩梦。但是，此查询将非常慢，因为您的数据库必须扫描并丢弃前 300,010 条记录才能获得您想要的 10 条记录。这也是不可预测的，因为您还没有告诉数据库您想要记录的顺序。

这是 SQL 的核心：告诉它你想要哪 10 条记录，由特定范围内的键标识，数据库将尽最大努力以最少的工作获取并返回这些记录。查找有关 SQL 的任何教程以获取有关其工作原理的更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T08:56:28.870

处理大型表时，使用 SQL Server 中可用的分区技术通常是一个好主意。

分区函数的规则通常规定只有一定范围的数据可以驻留在给定的分区中。例如，您可以按日期范围或 ID 拆分分区。

为了从特定分区中进行选择，您将使用类似于以下内容的查询。

```
SELECT <Column Name1>…/* 
FROM <Table Name> 
WHERE $PARTITION.<Partition Function Name>(<Column Name>) = <Partition Number> 
```

有关 SQL Server 2005 中分区的更详细信息，请查看以下白皮书。

[http://msdn.microsoft.com/en-us/library/ms345146.aspx](http://msdn.microsoft.com/en-us/library/ms345146.aspx)

我希望这会有所帮助，但请随时提出进一步的问题。

干杯，约翰

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-04T21:23:03.357

我使用包装查询来选择核心查询，然后只隔离我希望从查询中获取的 ROW 编号 - 这允许 SQL 服务器在核心查询中完成所有繁重的工作，并且只传递少量的表我要求的。您需要做的就是将 [start_row_variable] 和 [end_row_variable] 传递到 SQL 查询中。

注意： order 子句在核心查询 [sql_order_clause] 之​​外指定

w1 和 w2 是由 SQL 服务器创建的 TEMPORARY 表作为包装表。

```
SELECT
    w1.*
FROM(   
    SELECT w2.*, 
    ROW_NUMBER() OVER ([sql_order_clause]) AS ROW
    FROM (

        <!--- CORE QUERY START --->
        SELECT [columns]
        FROM [table_name]
        WHERE [sql_string]
        <!--- CORE QUERY END --->

   ) AS w2
) AS w1
WHERE ROW BETWEEN [start_row_variable] AND [end_row_variable] 
```

这种方法极大地优化了我的数据库系统。它工作得很好。

IMPORTANT: Be sure to always explicitly specify only the exact columns you wish to retrieve in the core query as fetching unnecessary data in these CORE queries can cost you serious overhead

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-02-07T07:45:23.287

使用 TOP 仅选择有限的行数，例如：

SELECT TOP 10 * FROM my_table WHERE ID >= 300010

如果您希望结果按特定顺序添加，请添加 ORDER BY。

为了提高效率，必须在 ID 列上有一个索引。

# c# - 如何转换列表 进入数据集？

> ID：523153
> 
> 赞同：16
> 
> 时间：2009-02-07T04:48:54.190
> 
> 标签：c#, list, dataset, transformation

给定一个对象列表，我需要将其转换为一个数据集，其中列表中的每个项目由一行表示，每个属性是该行中的一列。该数据集随后将被传递给[Aspose.Cells](http://www.aspose.com/categories/file-format-components/aspose.cells-for-.net-and-java/default.aspx)函数，以创建 Excel 文档作为报告。

说我有以下内容：

```
public class Record
{
   public int ID { get; set; }
   public bool Status { get; set; }
   public string Message { get; set; }
} 
```

给定一个 List 记录，我如何将其转换为 DataSet，如下所示：

```
ID Status Message
1  true   "message" 
2  false  "message2" 
3  true   "message3" 
... 
```

目前我唯一能想到的如下：

```
DataSet ds = new DataSet
ds.Tables.Add();
ds.Tables[0].Add("ID", typeof(int));    
ds.Tables[0].Add("Status", typeof(bool));
ds.Tables[0].Add("Message", typeof(string));

foreach(Record record in records)
{
    ds.Tables[0].Rows.Add(record.ID, record.Status, record.Message);
} 
```

但是这种方式让我认为必须有更好的方法，因为至少如果将新属性添加到 Record 中，那么它们不会出现在 DataSet 中......但同时它允许我控制每个的顺序属性被添加到该行。

有谁知道更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-07T04:58:23.903

您可以通过反射和泛型来检查底层类型的属性。

考虑我使用的这种扩展方法：

```
 public static DataTable ToDataTable<T>(this IEnumerable<T> collection)
    {
        DataTable dt = new DataTable("DataTable");
        Type t = typeof(T);
        PropertyInfo[] pia = t.GetProperties();

        //Inspect the properties and create the columns in the DataTable
        foreach (PropertyInfo pi in pia)
        {
            Type ColumnType = pi.PropertyType;
            if ((ColumnType.IsGenericType))
            {
                ColumnType = ColumnType.GetGenericArguments()[0];
            }
            dt.Columns.Add(pi.Name, ColumnType);
        }

        //Populate the data table
        foreach (T item in collection)
        {
            DataRow dr = dt.NewRow();
            dr.BeginEdit();
            foreach (PropertyInfo pi in pia)
            {
                if (pi.GetValue(item, null) != null)
                {
                    dr[pi.Name] = pi.GetValue(item, null);
                }
            }
            dr.EndEdit();
            dt.Rows.Add(dr);
        }
        return dt;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-08-01T15:37:01.783

我在微软论坛上找到了这段代码。这是迄今为止最简单的方法之一，易于理解和使用。这为我节省了几个小时。我已将此自定义为扩展方法，而对实际实现没有任何更改。下面是代码。它不需要太多解释。

您可以使用具有相同实现的两个函数签名

1) public static DataSet ToDataSetFromObject(this **object** dsCollection)

2) public static DataSet ToDataSetFromArrayOfObject(this **object[]** arrCollection)。我将在下面的示例中使用这个。

```
// <summary>
// Serialize Object to XML and then read it into a DataSet:
// </summary>
// <param name="arrCollection">Array of object</param>
// <returns>dataset</returns>

public static DataSet ToDataSetFromArrayOfObject( this object[] arrCollection)
{
    DataSet ds = new DataSet();
    try {
        XmlSerializer serializer = new XmlSerializer(arrCollection.GetType);
        System.IO.StringWriter sw = new System.IO.StringWriter();
        serializer.Serialize(sw, dsCollection);
        System.IO.StringReader reader = new System.IO.StringReader(sw.ToString());
        ds.ReadXml(reader);
    } catch (Exception ex) {
        throw (new Exception("Error While Converting Array of Object to Dataset."));
    }
    return ds;
} 
```

在代码中使用此扩展

```
Country[] objArrayCountry = null;
objArrayCountry = ....;// populate your array
if ((objArrayCountry != null)) {
    dataset = objArrayCountry.ToDataSetFromArrayOfObject();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T04:54:07.330

除了另外使用`Reflection`来确定类的属性`Record`来处理添加新属性之外，差不多就是这样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T21:21:20.843

我自己编写了一个小型库来完成这项任务。它仅在第一次将对象类型转换为数据表时使用反射。它发出一个方法，该方法将完成转换对象类型的所有工作。

它的速度很快。你可以在这里找到它：[GoogleCode 上的 ModelShredder](http://code.google.com/p/modelshredder/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T02:57:33.813

我对 CMS 的扩展方法进行了一些更改，以处理`List`包含原语或`String`元素的情况。在这种情况下，对于列表中的每个值，结果`DataTable`将只有一个`Column`。`Row`

起初我想包括所有值类型（不仅是原始类型），但我不想包括结构（它们是值类型）。

此更改源于我需要将 a`List(Of Long)`或`List<long>`, 转换为 a`DataTable`以将其用作 MS SQL 2008 存储过程中的表值参数。

很抱歉我的代码在 VB 中，即使这个问题被标记为[c#](/questions/tagged/c%23 "显示标记为“c#”的问题")；我的项目在 VB 中（不是我的选择），在 c# 中应用更改应该不难。

```
Imports System.Runtime.CompilerServices
Imports System.Reflection

Module Extensions

    <Extension()>
    Public Function ToDataTable(Of T)(ByVal collection As IEnumerable(Of T)) As DataTable
        Dim dt As DataTable = New DataTable("DataTable")
        Dim type As Type = GetType(T)
        Dim pia() As PropertyInfo = type.GetProperties()

        ' For a collection of primitive types create a 1 column DataTable
        If type.IsPrimitive OrElse type.Equals(GetType(String)) Then
            dt.Columns.Add("Column", type)
        Else
            ' Inspect the properties and create the column in the DataTable
            For Each pi As PropertyInfo In pia
                Dim ColumnType As Type = pi.PropertyType
                If ColumnType.IsGenericType Then
                    ColumnType = ColumnType.GetGenericArguments()(0)
                End If
                dt.Columns.Add(pi.Name, ColumnType)
            Next

        End If

        ' Populate the data table
        For Each item As T In collection
            Dim dr As DataRow = dt.NewRow()
            dr.BeginEdit()
            ' Set item as the value for the lone column on each row
            If type.IsPrimitive OrElse type.Equals(GetType(String)) Then
                dr("Column") = item
            Else
                For Each pi As PropertyInfo In pia
                    If pi.GetValue(item, Nothing) <> Nothing Then
                        dr(pi.Name) = pi.GetValue(item, Nothing)
                    End If
                Next
            End If
            dr.EndEdit()
            dt.Rows.Add(dr)
        Next
        Return dt
    End Function

End Module 
```

# c# - 带有 asp:chart 控件的阶梯饼图

> ID：523163
> 
> 赞同：2
> 
> 时间：2009-02-07T04:57:12.847
> 
> 标签：c#, asp.net, pie-chart

我正在阅读 asp.net 图表控件的示例网站，并在饼图库中发现了一些东西。有 3 个饼图，“阶梯状”相互重叠。我开始将此控件用于金融服务应用程序，并希望复制此效果。它看起来像这样：

[3d 阶梯式饼图 http://www.freeimagehosting.net/uploads/87a5caabca.png](http://www.freeimagehosting.net/uploads/87a5caabca.png)

我会发布一些关于我到目前为止所完成的代码，但我不知道从哪里开始。我猜也许我必须创建 3 个图表，并偏移它们的轴，我在这里偏离基地吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T03:43:19.223

您需要创建 3 个单独的系列并将它们分配给单独的图表区域。

图表区域需要使用 position.x 和 position.y 下移页面

其他技巧包括禁用第二个和后续系列的图例。

要获得透明度影响，您需要在系列中的数据点级别工作。请注意，所有权数据点不透明，但出租和租赁数据点是透明的。

# ruby-on-rails - rails if object.nil? 然后魔术''在意见？

> ID：523164
> 
> 赞同：33
> 
> 时间：2009-02-07T04:57:15.357
> 
> 标签：ruby-on-rails, ruby

这就是其中之一，也许很简单，我永远找不到它，因为其他人都已经知道了。

我有一些对象，我必须在我的视图中检查 nil，所以我不会取消引用 nil：

```
<%= if tax_payment.user; tax_payment.user.name; end %> 
```

或者我可以做这个变体：

```
<%= tax_payment.user ? tax_payment.user.name : '' %> 
```

所以这没关系......对于大多数语言。但我觉得如果这是我能做到的最好的话，我仍然缺少一些闪亮的红宝石或铁轨。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-07T05:02:04.083

关于什么：

```
<%= tax_payment.user.name if tax_payment.user %> 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-02-07T05:31:10.110

您还可以尝试新的 Object.try 语法，请原谅双关语。

这是在闪亮的新 Rails 2.3 中：

```
tax_payment.try(:user).try(:name) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-13T13:51:03.560

Ruby 社区对自动化这个习语给予了极大的关注。这些是我知道的解决方案：

*   在 Ruby on Rails 中[尝试](http://ryandaigle.com/articles/2008/11/20/what-s-new-in-edge-rails-object-try)
*   [再试](http://ruby.tie-rack.org/53/a-better-try-chaining-methods-and-nil/)一次
*   [和和](http://weblog.raganwald.com/2008/01/objectandand-objectme-in-ruby.html)
*   更安全的[安地](http://github.com/raganwald/rewrite_rails/tree/master)
*   [内核::ergo](http://facets.rubyforge.org/quick/rdoc/core/classes/Kernel.html#M000368)
*   [默认发送](http://rhnh.net/2007/10/02/object-send-with-default)
*   [也许](http://weavejester.com/node/10)
*   [_?](http://hobocentral.net/blog/2007/08/25/quiz/)
*   [如果不是零](http://recursive.ca/hutch/2007/11/22/a-little-unnecessary-smalltalk-envy/)
*   [海龟！](http://chalain.livejournal.com/66798.html)
*   Groovy 风格的[method_](http://www.urubatan.info/2008/03/a-better-try-for-ruby-why-not-do-the-groovy-way/)
*   [做或不做](http://www.bencurtis.com/archives/2008/03/do-or-do-not/)

最著名的可能是 Rails 中的[try 方法](http://ryandaigle.com/articles/2008/11/20/what-s-new-in-edge-rails-object-try)。然而，它也受到了[一些](http://blog.lawrencepit.com/2009/01/11/try-as-you-might/) [批评](http://github.com/raganwald/homoiconic/blob/master/2008-12-16/welcome.md)。

无论如何，我认为 Ben 的解决方案是完全足够的。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-09-28T15:18:43.453

我一直更喜欢这种方法：

模型：

```
class TaxPayment < ActiveRecord::Base
  belongs_to :user
  delegate :name, :to=>:user, :prefix=>true, :allow_nil=>true
end 
```

看法：

```
<%= tax_payment.user_name %> 
```

[http://apidock.com/rails/Module/delegate](http://apidock.com/rails/Module/delegate)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-07T06:41:52.713

如需更全面的解决方案，您可以查看[*Introduce Null Object* Refactoring](http://Refactoring.Com/catalog/introduceNullObject.html)。这种重构的基本机制是，通过引入特定于上下文的*空对象*并返回它，而不是`nil`在*客户端*代码中检查，而是确保*提供者*从不产生 a 。`nil`

 *因此，返回一个空字符串、一个空数组、一个空散列或一个特殊的空客户或空用户或其他东西，而不是仅仅返回一个`nil`，然后您将永远不需要首先检查`nil`。

所以，在你的情况下，你会有类似的东西

```
class NullUser < User
    def name
        return ''
    end
end 
```

然而，在 Ruby 中实际上还有另一种非常优雅的方式来实现引入 Null 对象重构：您实际上不需要*引入*Null 对象，因为`nil`它*已经*是一个对象！所以，你可以用猴子补丁`nil`来表现得像一个 NullUser - 然而，所有关于猴子补丁的常见警告和陷阱在这种情况下更加强烈，因为`nil`默默地吞下`NoMethodError`s 或类似的东西会完全搞乱你的调试体验和很难*找到*`nil`不应该存在的情况（而不是`nil`作为空对象的）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-07T14:58:06.020

我只是做

```
<%= tax_payment.user.name rescue '' %> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-14T14:05:41.130

另一种选择，偶尔有意义......

如果 tax_payment.user 返回 nil，则打印 nil.to_s（一个空字符串），这是无害的。如果有用户，它将打印用户名。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-28T14:38:19.777

您可以编写如下所示的辅助方法：

```
def print_if_present(var)
    var ? var : ""
end 
```

然后像这样使用它（在视图中）：

`<%= print_if_present(your_var) %>`

如果 var 为 nil，它只会不打印任何内容而不会引发异常。

# batch-file - CMD.EXE 批处理脚本显示 txt 文件的最后 10 行

> ID：523181
> 
> 赞同：18
> 
> 时间：2009-02-07T05:04:46.920
> 
> 标签：batch-file, scripting, cmd

任何想法如何回显或键入 txt 文件的最后 10 行？

我正在运行一个服务器更改日志脚本来提示管理员说明他们在做什么，这样我们就可以跟踪更改。我试图让脚本显示最后 10 个左右的条目，以了解最近发生的事情。我找到了一个处理最后一行的脚本，如下所示，但无法弄清楚要在其中更改什么以显示最后 10 行。脚本：

```
@echo off
setLocal EnableDelayedExpansion
for /f "tokens=* delims= " %%a in (c:\log09.txt) do (
set var=%%a
)
echo !var! 
```

日志文件示例：

```
06/02/2009, 12:22,Remote=Workstation-9,Local=,
mdb,bouncing box after updates,CAS-08754,
=================
07/02/2009, 2:38,Remote=,Local=SERVER1,
mdb,just finished ghosting c drive,CAS-08776,
=================
07/02/2009, 3:09,Remote=,Local=SERVER1,
mdb,audit of server,CAS-08776, 
```

有什么想法吗？该脚本效果很好，只需要将更多行传输到屏幕上。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-07T15:47:46.933

Hopefully this will save Joel's eyes :)

```
@echo OFF

:: Get the number of lines in the file
set LINES=0
for /f "delims==" %%I in (data.txt) do (
    set /a LINES=LINES+1
)

:: Print the last 10 lines (suggestion to use more courtsey of dmityugov)
set /a LINES=LINES-10
more +%LINES% < data.txt 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-02-12T19:32:57.737

这个答案结合了现有答案的最佳特征，并增加了一些曲折。

解决方案是tail命令的简单批处理实现。

第一个参数是文件名（可能带有路径信息 - 如果路径的任何部分包含空格或其他有问题的字符，请务必用引号引起来）。

第二个参数是要打印的行数。

最后，可以附加任何标准的 MORE 选项：/E /C /P /S /Tn。（有关更多信息，请参阅更多/？）。

此外，可以指定 /N（无暂停）选项以使输出连续打印而不会暂停。

该解决方案首先使用 FIND 快速计算行数。该文件通过重定向输入而不是使用文件名参数传入，以消除 FIND 输出中文件名的打印输出。

使用 SET /A 计算要跳过的行数，但如果它小于 0，它会将数字重置为 0。

最后使用 MORE 在跳过不需要的行后打印出所需的行。MORE 将在每个屏幕的行之后暂停，除非输出被重定向到文件或通过管道传输到另一个命令。/N 选项通过使用匹配所有行的正则表达式将 MORE 输出传递到 FINDSTR 来避免暂停。使用 FINDSTR 而不是 FIND 很重要，因为 FIND 可以截断长行。

```
:: tail.bat File Num [/N|/E|/C|/P|/S|/Tn]...
::
::   Prints the last Num lines of text file File.
::
::   The output will pause after filling the screen unless the /N option
::   is specified
::
::   The standard MORE options /E /C /P /S /Tn can be specified.
::   See MORE /? for more information
::
@echo OFF
setlocal
set file=%1
set "cnt=%~2"
shift /1
shift /1
set "options="
set "noPause="
:parseOptions
if "%~1" neq "" (
  if /i "%~1" equ "/N" (set noPause=^| findstr "^") else set options=%options% %~1
  shift /1
  goto :parseOptions
)
for /f %%N in ('find /c /v "" ^<%file%') do set skip=%%N
set /a "skip-=%cnt%"
if %skip% lss 0 set skip=0
more +%skip% %options% %file% %noPause% 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-07T06:30:21.740

您可能应该只找到一个好的实现`tail`. 但如果你真的坚持使用 CMD 批处理文件，并且想在任何 NT 机器上不受干扰地运行，这将起作用：

```
@echo off
setLocal EnableDelayedExpansion
for /f "tokens=* delims= " %%a in (c:\tmp\foo.txt) do (
set var9=!var8!
set var8=!var7!
set var7=!var6!
set var6=!var5!
set var5=!var4!
set var4=!var3!
set var3=!var2!
set var2=!var1!
set var1=!var!
set var=%%a
)
echo !var9!
echo !var8!
echo !var7!
echo !var6!
echo !var5!
echo !var4!
echo !var3!
echo !var2!
echo !var1!
echo !var! 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-07T05:11:42.257

tail 命令有几个 Windows 实现。它应该正是你想要的。

这个听起来特别好： http: [//malektips.com/xp_dos_0001.html](http://malektips.com/xp_dos_0001.html)

它们的范围从实时监控到文件的最后 x 行。

编辑：我注意到包含的链接是一个包它应该可以工作，但这里有更多版本：

[http://www.lostinthebox.com/viewtopic.php?f=5&t=3801](http://www.lostinthebox.com/viewtopic.php?f=5&t=3801) [http://sourceforge.net/projects/tailforwin32](http://sourceforge.net/projects/tailforwin32)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-16T23:14:58.783

如果文件太大，获取行数可能需要很长时间，另一种方法是使用 find 并将其传递给 nowhere 字符串

```
$find /v /c "%%$%!" yourtextfile.txt 
```

这将导致这样的输出

```
$---------- yourtextfile.txt: 140 
```

然后你可以像这样使用 for 解析输出

```
$for /f "tokens=3" %i in ('find /v /c "%%$%!" tt.txt') do set countoflines=%i 
```

然后你可以从总行中减去十行

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-08-14T19:17:07.500

在尝试了我在此页面上找到的所有答案后，他们都没有在我的文件中使用 15539 ​​行。

但是，我在[这里](https://stackoverflow.com/a/1632394/3993003)找到了很好的答案。为方便起见，复制到这篇文章中。

```
@echo off
for /f %%i in ('find /v /c "" ^< C:\path\to\textfile.txt') do set /a lines=%%i
set /a startLine=%lines% - 10
more /e +%startLine% C:\path\to\textfile.txt 
```

此代码将打印“C:\path\to\textfile.txt”文件中的最后 10 行。

归功于 OP @Peter Mortensen

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-03-18T13:26:33.093

使用单个 powershell 命令：

```
powershell -nologo "& "Get-Content -Path c:\logFile.log -Tail 10" 
```

适用于 powershell 3.0 及更新版本

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-11-23T15:52:40.280

我同意“你应该使用 TAIL”的回答。但它不是默认出现在 Windows 上的。我建议您下载“ [Windows 2003 资源工具包](http://www.microsoft.com/en-us/download/details.aspx?id=17657)”，它适用于 XP/W2003 等。

如果您不想安装在您的服务器上，您可以将资源包安装在另一台机器上，然后只将 TAIL.EXE 复制到您的服务器上。使用起来非常容易。

```
C:\> TAIL -10 myfile.txt 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-01-20T22:13:58.983

[**这**](https://github.com/npocmaka/batch.scripts/blob/master/fileUtils/tailHead.bat)是一个用纯批处理编写的实用程序，可以显示给定范围内的文件行。要显示最后一行使用（这里脚本名为tailhead.bat）：

```
call tailhead.bat -file "file.txt" -begin -10 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-13T20:15:11.290

> Any ideas how to echo or type the last 10 lines of a txt file?

The following 3-liner script will list the last n lines from input file. n and file name/path are passed as input arguments.

```
# Script last.txt
var str file, content ; var int n, count
cat $file > $content ; set count = { len -e $content } - $n
stex -e ("["+makestr(int($count))) $content 
```

The script is in biterscripting. To use, download biterscripting from [http://www.biterscripting.com](http://www.biterscripting.com) , save this script as C:\Scripts\last.txt, start biterscripting, enter the following command.

```
script last.txt file("c:\log09.txt") n(10) 
```

The above will list last 10 lines from file c:\log09.txt. To list last 20 lines from the same file, use the following command.

```
script last.txt file("c:\log09.txt") n(20) 
```

To list last 30 lines from a different file C:\folder1\somefile.log, use the following command.

```
script last.txt file("C:\folder1\somefile.log") n(30) 
```

I wrote the script in a fairly generic way, so it can be used in various ways. Feel free to translate into another scripting/batch language.

# assembly - 如何使用 NASM 获取用户输入？

> ID：523185
> 
> 赞同：2
> 
> 时间：2009-02-07T05:11:37.607
> 
> 标签：assembly, x86, nasm

程序需要从用户那里获取一个简单的字符串并将其显示回来。我已经让程序从用户那里获取输入，但我似乎无法存储它。这是我到目前为止所拥有的：

```
BITS 32
global _main
section .data

prompt db "Enter a string: ", 13, 10, '$'
input resd 1 ; something I can using to store the users input.

name db "Name: ******", 13, 10,'$'
StudentID db "********", 13, 10, '$'
InBoxID db "*************", 13, 10, '$'
Assignment db "************", 13, 10, '$'
version db "***************", 13, 10, '$'

section .text
_main:

mov ah, 9
mov edx, prompt
int 21h
mov ah, 08h
while:
    int 21h
            ; some code that should store the input.
    mov [input], al
    cmp al, 13
    jz endwhile
    jmp while
endwhile:

mov ah, 9
    ; displaying the input.

mov edx, name
int 21h
mov edx, StudentID
int 21h
mov edx, InBoxID
int 21h
mov edx, Assignment
int 21h
mov edx, version
int 21h
ret 
```

我正在使用 NASM 组装它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T05:45:24.327

看起来您没有使用适当的缓冲区来存储用户输入。

这个站点有一个大型的[x86 教程](http://patater.com/gbaguy/x86asm.htm)，分为 23 个部分，你应该每天做一个部分。

在[第 14 天](http://patater.com/gbaguy/day14pc.htm)，他展示了一个从用户读取字符串并将其存储到缓冲区中，然后再次打印出来的示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-07T05:56:16.113

您只是在读取字符而不存储它们。您应该将 AL 直接存储到 StudentID/InBoxID/Assignment/Version 中，而不是存储到那个“输入”中。您可以利用它们在内存中的相对位置并编写一个循环来填充所有它们，就像在一个连续的空间中一样。

它可以是这样的：

```
; For each string already padded with 13, 10, $
; at the end, use the following:
mov ah, 08h
mov edi, string
mov ecx, max_chars
cld
while:
        int 21h
        stosb         ; store the character and increment edi
        cmp ecx, 1    ; have we exhausted the space?
        jz out
        dec ecx
        cmp al, 13
        jz terminate  ; pad the end
        jmp while
terminate:
        mov al, 10
        stosb
        mov al, '$'
        stosb
out:
        ; you can ret here if you wish 
```

我没有测试，所以它可能有错误。

或者您可以使用其他 DOS 功能，特别是[INT21h/0Ah](http://lrs.uni-passau.de/support/doc/interrupt-57/RB-2497.HTM)。它可能更优化和/或更容易。

# c# - C#中的并行迭代？

> ID：523194
> 
> 赞同：7
> 
> 时间：2009-02-07T05:19:02.723
> 
> 标签：c#, loops, foreach, iteration

有没有办法对`foreach`C# 中的并行枚举进行样式迭代？对于可下标列表，我知道可以使用常规循环在索引范围内迭代 int，但出于多种原因`for`，我更喜欢`foreach`这样做。`for`

如果它在 C# 2.0 中工作，则加分

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-11-22T07:21:30.253

.NET 4 的 BlockingCollection 使这非常容易。创建一个 BlockingCollection，在 enumerable 方法中返回它的 .GetConsumingEnumerable()。然后 foreach 简单地添加到阻塞集合中。

例如

```
private BlockingCollection<T> m_data = new BlockingCollection<T>();

public IEnumerable<T> GetData( IEnumerable<IEnumerable<T>> sources )
{
    Task.Factory.StartNew( () => ParallelGetData( sources ) );
    return m_data.GetConsumingEnumerable();
}

private void ParallelGetData( IEnumerable<IEnumerable<T>> sources )
{
    foreach( var source in sources )
    {
        foreach( var item in source )
        {
            m_data.Add( item );
        };
    }

    //Adding complete, the enumeration can stop now
    m_data.CompleteAdding();
} 
```

希望这可以帮助。顺便说一句，我昨晚发布[了一篇关于这个的博客](http://andrevdm.blogspot.com/2009/11/blockingcollection-parallel-yields.html)

安德烈

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-07T05:53:17.930

简短的回答，不。`foreach`一次只对一个可枚举对象起作用。

但是，如果您将并行可枚举项组合成一个单独的枚举项，则可以`foreach`过度组合。我不知道有什么简单的内置方法可以做到这一点，但是以下应该可以工作（尽管我没有测试过）：

```
public IEnumerable<TSource[]> Combine<TSource>(params object[] sources)
{
    foreach(var o in sources)
    {
        // Choose your own exception
        if(!(o is IEnumerable<TSource>)) throw new Exception();
    }

    var enums =
        sources.Select(s => ((IEnumerable<TSource>)s).GetEnumerator())
        .ToArray();

    while(enums.All(e => e.MoveNext()))
    {
        yield return enums.Select(e => e.Current).ToArray();
    }
} 
```

然后你可以`foreach`通过返回的枚举：

```
foreach(var v in Combine(en1, en2, en3))
{
    // Remembering that v is an array of the type contained in en1,
    // en2 and en3.
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-07T07:21:09.203

Zooba 的答案很好，但您可能还想查看[“如何一次迭代两个数组”](https://stackoverflow.com/questions/496704)的答案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-12-18T22:06:22.037

我从 .NET4 Parallel 库中编写了 EachParallel() 的实现。它与 .NET 3.5 兼容： [C# 3.5 中的并行 ForEach 循环](http://blog.robvolk.com/2009/06/parallel-foreach-loop-in-c-35.html) 用法：

```
string[] names = { "cartman", "stan", "kenny", "kyle" };
names.EachParallel(name =>
{
    try
    {
        Console.WriteLine(name);
    }
    catch { /* handle exception */ }
}); 
```

执行：

```
/// <summary>
/// Enumerates through each item in a list in parallel
/// </summary>
public static void EachParallel<T>(this IEnumerable<T> list, Action<T> action)
{
    // enumerate the list so it can't change during execution
    list = list.ToArray();
    var count = list.Count();

    if (count == 0)
    {
        return;
    }
    else if (count == 1)
    {
        // if there's only one element, just execute it
        action(list.First());
    }
    else
    {
        // Launch each method in it's own thread
        const int MaxHandles = 64;
        for (var offset = 0; offset < list.Count() / MaxHandles; offset++)
        {
            // break up the list into 64-item chunks because of a limitiation             // in WaitHandle
            var chunk = list.Skip(offset * MaxHandles).Take(MaxHandles);

            // Initialize the reset events to keep track of completed threads
            var resetEvents = new ManualResetEvent[chunk.Count()];

            // spawn a thread for each item in the chunk
            int i = 0;
            foreach (var item in chunk)
            {
                resetEvents[i] = new ManualResetEvent(false);
                ThreadPool.QueueUserWorkItem(new WaitCallback((object data) =>
                {
                    int methodIndex = (int)((object[])data)[0];

                    // Execute the method and pass in the enumerated item
                    action((T)((object[])data)[1]);

                    // Tell the calling thread that we're done
                    resetEvents[methodIndex].Set();
                }), new object[] { i, item });
                i++;
            }

            // Wait for all threads to execute
            WaitHandle.WaitAll(resetEvents);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-14T23:22:19.893

如果您想坚持基础知识-我以更简单的方式重写了当前接受的答案：

```
 public static IEnumerable<TSource[]> Combine<TSource> (this IEnumerable<IEnumerable<TSource>> sources)
    {
        var enums = sources
            .Select (s => s.GetEnumerator ())
            .ToArray ();

        while (enums.All (e => e.MoveNext ())) {
            yield return enums.Select (e => e.Current).ToArray ();
        }
    }

    public static IEnumerable<TSource[]> Combine<TSource> (params IEnumerable<TSource>[] sources)
    {
        return sources.Combine ();
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T08:15:51.387

这对你有用吗？

```
public static class Parallel
{
    public static void ForEach<T>(IEnumerable<T>[] sources,
                                  Action<T> action)
    {
        foreach (var enumerable in sources)
        {
            ThreadPool.QueueUserWorkItem(source => {
                foreach (var item in (IEnumerable<T>)source)
                    action(item);
            }, enumerable);
        }
    }
}

// sample usage:
static void Main()
{
    string[] s1 = { "1", "2", "3" };
    string[] s2 = { "4", "5", "6" };
    IEnumerable<string>[] sources = { s1, s2 };
    Parallel.ForEach(sources, s => Console.WriteLine(s));
    Thread.Sleep(0); // allow background threads to work
} 
```

对于 C# 2.0，您需要将上面的 lambda 表达式转换为委托。

注意：此实用程序方法使用后台线程。您可能想要修改它以使用前台线程，并且可能您想要等到所有线程完成。如果你这样做，我建议你创建`sources.Length - 1`线程，并将当前正在执行的线程用于最后一个（或第一个）源。

（我希望我可以在我的代码中包含等待线程完成，但很抱歉我还不知道该怎么做。我想你应该使用~~一种`WaitHandle`~~ `Thread.Join()`.)

# tomcat - “主”页面和 dojo 对话框之间的编码差异

> ID：523195
> 
> 赞同：1
> 
> 时间：2009-02-07T05:19:43.863
> 
> 标签：tomcat, encoding, utf-8, dojo, iso-8859-1

我遇到了一种奇怪的编码情况，html 页面本身按应有的方式显示（所有重音字符都正确显示），但所有弹出的 dojo 对话框都无法使用正确的编码。

这是设置：

*   在 Tomcat6.0.18 上运行 Hibernate/Spring/Struts2 的 Java Web 项目；这些页面生成为 JSP tile，由 Tiles2 组装在一起。
*   所有源文件都是 UTF-8 编码的，**除了**ISO-8859-1中的资源属性文件 ( `*.properties`)（根据 Java 规范）。
*   数据库采用 UTF-8 编码。
*   `struts.xml`包含常量的定义：

    ```
    <constant name="struts.i18n.encoding" value="UTF-8"/> 
    ```

*   每个 JSP tile 都以语句开头

    ```
    <%@ page contentType="text/html;charset=UTF-8" language="java" pageEncoding="UTF-8" %> 
    ```

*   每个 JSP 页面（由多个图块组成）都以语句开头

    ```
    <%@ page contentType="text/html;charset=UTF-8" language="java" pageEncoding="UTF-8" %>
    <?xml version="1.0" encoding="UTF-8"?> 
    ```

*   从 JSP 代码生成的每个 HTML 页面都包含以下`<head>`元标记：

    ```
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/> 
    ```

*   Tomcat 编码过滤器将标头设置为`every single request going through Tomcat`以下值：

    ```
    text/html;charset=UTF-8 
    ```

*   dojo 1.2.3 在每个页面上用语句初始化

    ```
    <script type="text/javascript" src="/scripts/dojo/dojo/dojo.js" djConfig="parseOnLoad:true,usePlainJson:true,locale:'fr'"></script> 
    ```

*   A`dijit.Dialog`首先由以下语句创建然后打开（`/votingOptions`action-URL 返回一个 JSP 片段，该片段遵循与以前相同的规范——该 JSP 片段最终嵌入在`<div>`对话框中）：

    ```
    dialog = new dijit.Dialog({title:"My title",loadingMessage:"Loading..."});
    dialog.setHref('/votingOptions');
    dialog.show(); 
    ```

作为所有这些设置的结果，所有“正常”页面（即，撇开 dojo 对话框）都按应有的方式显示所有字符、重音符号和所有字符，无论文本来自数据库还是来自资源文件。

另一方面，任何 dojo 对话框的内容都会被破坏：所有非重音字符都很好，但重音字符会完全显示，就好像有人试图将 UTF-8 字符读取为 ISO-8859-1 字符一样（无论是这些字符来自数据库或资源文件）。

因此，例如，名称“ **Kurt Gödel** ”（它会正确显示在主页上）将在道场对话框中显示为“ **Kurt Gödel** ”！

请注意，Firebug 在两种情况下报告的响应标头与 Tomcat 提供的相同（无论是调用主页，还是在页面上打开一个 dojo 对话框）：

```
Server: Apache/2.2.3 (CentOS)
Content-Language: en-US
Connection: close
Content-Type: text/html;charset=UTF-8 
```

这两种类型的请求（除了 Content-Length）之间的唯一区别是：

```
Transfer-Encoding: chunked 
```

它在请求主页时存在，但在 dojo-dialog 案例中不存在。

谁能弄清楚到目前为止我逃脱了什么？或者，欢迎提出关于我应该进行什么样的调查以查明真相的建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T20:15:14.207

Dojo 中的 Dialog 小部件调用 URL /votingOptions，我假设它由 servlet 或 Struts 操作处理。

因为它是一个 Ajax 调用，所以我还假设如果您使用 struts 操作，那么您将通过`HttpServletResponse`对象发送响应，而不是重定向到视图。

无论哪种方式，请确保使用：

```
String str = "こんにちわ、 Kürt Gödel";
response.getWriter().write(str); 
```

代替：

```
response.getOutputStream().println(str); 
```

我能够重现您在使用这些代码时遇到的行为。第一个正确显示所有字符（甚至是日文字符！），第二个显示乱码。

由于您正在开发 Ajax 应用程序，因此还要确保安装[HttpFox](https://addons.mozilla.org/en-US/firefox/addon/6647)插件，该插件在显示 Http 流量方面比 Firebug 更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-12T15:36:41.190

我有一个类似的问题。
在我的例子中，dojo javascript 文件以 iso-8859-1 格式返回。为了解决这个问题，我必须重写默认 FilterDispatcher 类中的 getContentType() 方法。我将其替换为以下代码（在 Struts 2.0.9 中测试）：

```
 protected String getContentType(String name) {
        if (name.endsWith(".js")) {
            return "text/javascript;charset=\"UTF-8\"";
        } else if (name.endsWith(".css")) {
            return "text/css";
        } else if (name.endsWith(".html")) {
            return "text/html;charset=\"UTF-8\"";
        } else if (name.endsWith(".txt")) {
            return "text/plain";
        } else if (name.endsWith(".gif")) {
            return "image/gif";
        } else if (name.endsWith(".jpg") || name.endsWith(".jpeg")) {
            return "image/jpeg";
        } else if (name.endsWith(".png")) {
            return "image/png";
        } else {
            return null;
        }
} 
```

# c# - 如何从数据绑定到 LINQ 数据源的 DropDownBox 中的选定项目中获取用户 GUID？

> ID：523200
> 
> 赞同：1
> 
> 时间：2009-02-07T05:23:54.853
> 
> 标签：c#, asp.net, visual-studio, linq

这应该很简单，但我似乎无法让我的新手想到它。我有一个 ASP.net 页面，需要根据来自 Web 表单的用户输入创建一个新的数据库条目。

表单中的一个控件是 DropDownBox，它数据绑定到 LinqDataSource，其上下文是 LinqToSQL 数据类。它绑定到的表是默认的 ASP.net aspnet_Users 表。

所以我有这个下拉列表，它显示了存储在该表中的所有用户。我有一个名为 Events 的表，它与 aspnet_Users 具有外键关系（每个 Event 都有一个 aspnet_User），因此我需要该 aspnet_Users UserId 值来创建一个新的 Event 对象。如何从下拉框中的选定项中获取此值？我敢肯定这比我做的要简单得多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T10:36:19.557

你能发布一些你如何绑定它的代码吗？

如果它正确绑定到用户，您应该能够执行以下操作。

```
UserClass user = MyDropDown.SelectedValue as UserClass; 
```

只需将实际的类名替换为用户，并将正确的名称替换为下拉菜单。

# c# - 持久化队列以防止 C# 中的内存不足错误

> ID：523205
> 
> 赞同：1
> 
> 时间：2009-02-07T05:31:03.900
> 
> 标签：c#, .net, data-structures

我有数据结构，特别是一个队列，它变得如此之大以至于导致内存不足异常。这是出乎意料的行为，因为它所持有的相对论简单对象（基本上具有一个字符串字段）。

是否有一种简单的方法或内置的 .NET 方法可以将此集合保存到磁盘上的文件中（没有可使用的数据库），并且它继续作为队列透明地运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T07:29:46.190

也许队列不是适合您的问题的数据结构。您的队列中有多少对象？你真的需要为以后存储所有这些字符串吗？你能用像枚举这样更小的东西或者像[Flyweight 设计模式](http://en.wikipedia.org/wiki/Flyweight_pattern)这样更面向对象的东西来替换字符串吗？

如果您正在处理大量数据，有时重新计算或重新加载原始数据比保存副本以备后用更快。或者，您可以在加载数据时对其进行处理，避免将其保存以供以后处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T07:33:49.973

我会首先调查你*为什么*会得到OOM。

如果您要添加到队列中 - 请检查大小并在超出阈值时执行一些操作。

你能过滤那些项目吗？这些项目是否有很多重复项？在这种情况下，您可以用预缓存的对象替换重复项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T09:02:07.110

我会使用 Sqlite 将数据保存到磁盘。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T14:30:16.457

针对您对该问题的评论，我想您可以将文件收集线程分成两个线程：

*   第一个线程仅计算要处理的文件数，并增加 a `volatile int count`。这个线程只更新计数；它不会在队列中存储任何内容。
*   第二个线程与第一个线程非常相似，只是它不更新计数，而是将数据实际保存到队列中。当队列的大小达到某个阈值时，您的线程应该阻塞一段时间，然后继续向队列中添加数据。这可确保您的队列永远不会大于某个阈值。

我什至猜想你实际上并不需要第二个线程。由于第一个会为您提供所需的计数，因此您可以在主线程中找到实际文件，一次一个文件。这样您就可以避免排队，这将减少您的内存需求。

但是，我怀疑您的队列是您出现内存不足异常的原因。即使您将一百万个条目添加到队列中，也只需要大约 512 MB 内存。我建议你检查你的处理逻辑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T14:37:01.120

具体答案是否定的，没有简单或内置的方法来做到这一点。您必须“自己”将其写入磁盘。

弄清楚为什么你的内存不足，这可能会让你大吃一惊。也许它的字符串保留，也许你正在用所有小对象分配分割 GC。Microsoft的[CLR Profiler](http://www.microsoft.com/downloads/details.aspx?familyid=A362781C-3870-43BE-8926-862B40AA0CD0&displaylang=en)非常适合这一点。

# php - 使用 1MB+ 内存的简单 php 脚本

> ID：523211
> 
> 赞同：1
> 
> 时间：2009-02-07T05:32:25.723
> 
> 标签：php, memory, memory-management

我这里有一个非常简单的 PHP 脚本，它只是加载几个库（6 或 7 个小类）并初始化一些变量，然后生成非常少量的 html 代码。但是从 memory_get_usage() 函数来看，我看到 1.21MB 的内存使用量。

这是正常的还是有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T11:50:02.140

如果您想查看执行 PHP 时实际加载的内容，请使用：[get_defined_vars](http://us3.php.net/manual/en/function.get-defined-vars.php)

PHP 消耗内存的原因可能根本不是您的脚本，而是您的 PHP 配置和 php 执行时加载的其他扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T06:07:25.403

取决于图书馆。只需一段代码即可加载您的记忆。您是否尝试过运行代码分析器？

# c# - 是否有适用于无括号 C# 的 IDE 或 Visual Studio/Mono/SharpDevelop 插件？

> ID：523212
> 
> 赞同：2
> 
> 时间：2009-02-07T05:33:51.197
> 
> 标签：c#, visual-studio, ide, indentation, curly-braces

当我看到[这篇](http://www.guilabs.net/#Screenshots)关于在 C# 中使用类似 python 的 sintax（基于缩进，没有大括号，语法）的文章时，我开始怀疑：我可以有一个 IDE 来解析和编译它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T06:13:02.350

[铁蟒](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)呢？它是用于 dotnet 的 python。

如果您不喜欢大括号，还可以查看[Delphi Prism （作为 Visual Studio 的插件运行）。](http://www.codegear.com/products/delphi/prism)它可以做 C# 做的所有事情，以及一些额外的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T06:19:32.510

> : 我可以有一个 IDE 来解析和编译它吗？

首先，有点迂腐。**IDE**既不解析也不编译。

我会建议使用 Iron Python 或 Delphi Prism（正如 Wouter 建议的更快）或者这样：您使用 Notepad++ 作为 IDE，并编写一个小工具，在编译代码之前根据意图自动添加括号。我认为这可以在一个代码“搜索和替换遍历”中完成：

例如：

```
if true
   for each a in b
       foo();
 foo(); 
```

代码仅扫描每一行并添加一个左括号，如果： 当前行中的代码比上一行中的代码更进一步：

```
if true
   {for each a in b
       {foo();
 foo(); 
```

并在下一行代码的意图低于当前行的地方添加一个右括号。- 存储缩进深度（我会推荐一个基于堆栈的系统）！

```
if true
   {for each a in b
       {foo();}
   }
 foo(); 
```

等等......命名空间和“使用”的问题也可以这样解决。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-09T06:39:58.880

抱歉延迟回复。[我在这里](http://blogs.msdn.com/kirillosenkov/archive/2009/09/08/first-videos-of-the-structured-editor-prototype.aspx)发表了一篇关于结构化编辑器的文章。不幸的是，它仍处于早期原型阶段，但可以让您了解如何构建这样的编辑器。我还在[这里](http://structurededitor.codeplex.com/)发布了源代码和二进制文件。

如果您有任何问题，请告诉我。

# visual-studio - 很棒的 Visual Studio 宏

> ID：523220
> 
> 赞同：67
> 
> 时间：2009-02-07T05:41:33.833
> 
> 标签：visual-studio, visual-studio-macros

对于小型社区讨论，您使用哪些基本的 Visual Studio 宏？

我刚开始了解它们，并想听听你们中的一些人离不开什么。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-12T20:00:36.387

我在工具栏上为以下 3 个宏添加了按钮。每个都将在任何文件中获取当前选定的文本并用谷歌搜索它（或 MSDN-it，或拼写检查）。为工具栏制作一个漂亮的图标以获得额外的样式点。

```
Private Const BROWSER_PATH As String = "C:\Program Files\Mozilla Firefox\firefox.exe"

Sub SearchGoogle()
    Dim cmd As String
    cmd = String.Format("{0} http://www.google.com/search?hl-en&q={1}", BROWSER_PATH, DTE.ActiveDocument.Selection.Text)
    Shell(cmd, AppWinStyle.NormalFocus)
End Sub

Sub SearchMSDN()
    Dim cmd As String
    cmd = String.Format("{0} http://www.google.com/search?hl-en&q={1}+site%3Amsdn.microsoft.com", BROWSER_PATH, DTE.ActiveDocument.Selection.Text)
    Shell(cmd, AppWinStyle.NormalFocus)
End Sub

Sub SpellCheck()
    Dim cmd As String
    cmd = String.Format("{0} http://www.spellcheck.net/cgi-bin/spell.exe?action=CHECKWORD&string={1}", BROWSER_PATH, DTE.ActiveDocument.Selection.Text)
    Shell(cmd, AppWinStyle.NormalFocus)
End Sub 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-01-21T19:26:13.793

**在“输出”窗口中显示构建持续时间**

将此代码放入您的 EnvironmentEvents 模块中。这会将持续时间直接写入构建窗口，以便对解决方案执行任何操作（构建、重建、清理、部署）。

您可以更改 IsBuild 函数以指定要查看此信息的操作。

```
Dim buildStart As Date

Private Function IsBuild(ByVal scope As EnvDTE.vsBuildScope, ByVal action As EnvDTE.vsBuildAction) As Boolean
    Return scope = vsBuildScope.vsBuildScopeSolution
End Function

Private Sub BuildEvents_OnBuildBegin(ByVal Scope As EnvDTE.vsBuildScope, ByVal Action As EnvDTE.vsBuildAction) Handles BuildEvents.OnBuildBegin
    If (IsBuild(Scope, Action)) Then
        buildStart = Date.Now
    End If
End Sub

Private Sub BuildEvents_OnBuildDone(ByVal Scope As EnvDTE.vsBuildScope, ByVal Action As EnvDTE.vsBuildAction) Handles BuildEvents.OnBuildDone
    If (IsBuild(Scope, Action)) Then
        Dim buildTime = Date.Now - buildStart
        WriteToBuildWindow(String.Format("Build time: {0}", buildTime.ToString))
    End If
End Sub

Private Sub WriteToBuildWindow(ByVal message As String)
    Dim win As Window = DTE.Windows.Item(EnvDTE.Constants.vsWindowKindOutput)
    Dim ow As OutputWindow = CType(win.Object, OutputWindow)
    For Each owPane As OutputWindowPane In ow.OutputWindowPanes
        If (owPane.Name.Equals("Build")) Then
            owPane.OutputString(message)
            Exit For
        End If
    Next
End Sub 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-10-09T20:24:08.820

**关闭解决方案后显示起始页（但保持 Visual Studio 打开）**

将此代码放入您的 EnvironmentEvents 模块中：

```
Private Sub SolutionEvents_AfterClosing() Handles SolutionEvents.AfterClosing
    DTE.ExecuteCommand("View.StartPage")
End Sub 
```

**打开解决方案后隐藏起始页**

将此代码放入您的 EnvironmentEvents 模块中：

```
Private Sub SolutionEvents_Opened() Handles SolutionEvents.Opened
    Dim startPageGuid As String = "{387CB18D-6153-4156-9257-9AC3F9207BBE}"
    Dim startPage As EnvDTE.Window = DTE.Windows.Item(startPageGuid)
    If startPage IsNot Nothing Then startPage.Close()
End Sub 
```

当您打开解决方案时，这两者一起将导致您的起始页隐藏自己。当您关闭解决方案时，开始页面会返回。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-07-28T09:26:49.023

我经常使用以下鲜为人知的快捷方式：

*   **Ctrl+Enter**：在当前行上方插入一个空行（并将光标放在那里）
*   **Ctrl+Shift+Enter**：在当前行下方插入一个空行（并将光标放在那里）
*   **Ctrl+Shift+V**：循环[剪贴板环](http://blogs.msdn.com/zainnab/archive/2010/01/02/how-to-cycle-through-the-clipboard-ring-to-paste-different-things.aspx)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-10-09T20:29:40.413

**大纲：折叠到定义但扩展区域**

您是否在那些坚持围绕*所有内容*的区域的商店之一工作，因此当您折叠到定义时，您看不到任何代码？

你真正需要的是一个collapse-to-definitions-but-expand-regions宏，就像这个：

```
Sub CollapseToDefinitionsButExpandAllRegions()
    DTE.ExecuteCommand("Edit.CollapsetoDefinitions")
    DTE.SuppressUI = True
    Dim objSelection As TextSelection = DTE.ActiveDocument.Selection
    objSelection.StartOfDocument()
    Do While objSelection.FindText("#region", 
        vsFindOptions.vsFindOptionsMatchInHiddenText)
    Loop
    objSelection.StartOfDocument()
    DTE.SuppressUI = False
End Sub 
```

把它放在一个普通的宏模块中，把它分配给一个热键，你的代码就回来了。

（除了......如果您与一些将区域*放入*方法中的非常邪恶的人一起工作，不幸的是，这将扩展这些方法。如果有人知道如何编写这个来避免这种情况，请随时编辑。）

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-12T19:45:22.727

插入 GUID，非常适合 WiX 工作，作为按钮或快捷键添加到菜单。

```
Sub InsertGuid()
    Dim objTextSelection As TextSelection
    objTextSelection = CType(DTE.ActiveDocument.Selection(), EnvDTE.TextSelection)
    objTextSelection.Text = System.Guid.NewGuid.ToString.ToUpper(New System.Globalization.CultureInfo("en", False))
End Sub 
```

组织解决方案中所有 .cs 文件的使用 -**原作者：** [djpark](http://blogs.msdn.com/djpark/archive/2008/08/16/organize-usings-across-your-entire-solution.aspx)。

```
Sub OrganizeSolution()
    Dim sol As Solution = DTE.Solution
    For i As Integer = 1 To sol.Projects.Count
        OrganizeProject(sol.Projects.Item(i))
    Next
End Sub

Private Sub OrganizeProject(ByVal proj As Project)
    For i As Integer = 1 To proj.ProjectItems.Count
        OrganizeProjectItem(proj.ProjectItems.Item(i))
    Next
End Sub

Private Sub OrganizeProjectItem(ByVal projectItem As ProjectItem)
    Dim fileIsOpen As Boolean = False
    If projectItem.Kind = Constants.vsProjectItemKindPhysicalFile Then
        'If this is a c# file             
        If projectItem.Name.LastIndexOf(".cs") = projectItem.Name.Length - 3 Then
            'Set flag to true if file is already open                 
            fileIsOpen = projectItem.IsOpen
            Dim window As Window = projectItem.Open(Constants.vsViewKindCode)
            window.Activate()
            projectItem.Document.DTE.ExecuteCommand("Edit.RemoveAndSort")
            'Only close the file if it was not already open                 
            If Not fileIsOpen Then
                window.Close(vsSaveChanges.vsSaveChangesYes)
            End If
        End If
    End If
    'Be sure to apply RemoveAndSort on all of the ProjectItems.         
    If Not projectItem.ProjectItems Is Nothing Then
        For i As Integer = 1 To projectItem.ProjectItems.Count
            OrganizeProjectItem(projectItem.ProjectItems.Item(i))
        Next
    End If
    'Apply RemoveAndSort on a SubProject if it exists.         
    If Not projectItem.SubProject Is Nothing Then
        OrganizeProject(projectItem.SubProject)
    End If
End Sub 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-04-14T15:31:24.077

**折叠**解决方案面板的所有节点，特别适用于大型项目：

```
 Public Module CollapseAllNodes
    Sub RunCollapseAllNodes()
        Dim UIHSolutionExplorer As UIHierarchy
        UIHSolutionExplorer = DTE.Windows.Item(Constants.vsext_wk_SProjectWindow).Object()

        ' Check if there is any open solution 
        If (UIHSolutionExplorer.UIHierarchyItems.Count = 0) Then
            Return
        End If

        ' Get the top node (the name of the solution) 
        Dim UIHSolutionRootNode As UIHierarchyItem
        UIHSolutionRootNode = UIHSolutionExplorer.UIHierarchyItems.Item(1)

        CloseRecursif(UIHSolutionRootNode)

        ' Select the solution node, or else when you click 
        ' on the solution windows scrollbar, it will synchronize the open document 
        ' with the tree and pop out the corresponding node which is probably not 
        ' what you want. 
        UIHSolutionRootNode.Select(vsUISelectionType.vsUISelectionTypeSelect)
    End Sub

    Function CloseRecursif(ByRef element)
        For Each UIHChild In element.UIHierarchyItems()
            CloseRecursif(UIHChild)

            If (UIHChild.UIHierarchyItems.Expanded = True) Then
                UIHChild.UIHierarchyItems.Expanded = False
            End If

        Next
    End Function
End Module 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-12T22:15:50.810

如果我要将代码示例粘贴到博客文章或电子邮件中，我会使用 Jeff 的[FormatToHtml宏。](http://www.codinghorror.com/blog/archives/000429.html)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-03-12T20:10:25.430

我使用双显示器，我发现 Sharon 的布局切换宏（从 1 显示器到 2 显示器布局）非常宝贵。当您需要在键入一些代码时引用网页或其他程序时，Ctrl-Alt-1 可切换到 Visual Studio 窗口的单显示器布局。完成后，按 Ctrl-Alt-2 切换到两个显示器布局并恢复所有窗口。惊人的！

[http://www.invisible-city.com/sharon/2008/06/workstation-hack-visual-studio-on-2.html](http://www.invisible-city.com/sharon/2008/06/workstation-hack-visual-studio-on-2.html)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-10-13T12:05:51.843

本身不是宏，但很有用：

```
Public Sub WriteToOutputWindow(ByVal pane as String, ByVal Msg As String)
    Dim owPane As OutputWindowPane

    Dim win As Window = DTE.Windows.Item(EnvDTE.Constants.vsWindowKindOutput)
    Dim ow As OutputWindow = win.Object
    Try
        owPane = ow.OutputWindowPanes.Item(pane)
    Catch
        owPane = ow.OutputWindowPanes.Add(pane)
    End Try
    If Not owPane Is Nothing Then
        owPane.Activate()
        owPane.OutputString(Msg & vbCrLf)
    End If
End Sub 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-07T05:50:07.497

我将 ctrl-shift-G 映射到以注册表格式生成 GUID 的宏 - 这对于编辑 IDL 很有用

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-01-05T16:04:05.020

我目前正在从事两个具有不同编码标准的不同项目，一个使用制表符作为行首，另一个使用空格。此宏将根据当前活动的环境在使用的标准之间切换：

```
Public Sub ToggleTabs()
  If DTE.ActiveDocument.Language = "CSharp" Then
      Dim currentSetting As Boolean = DTE.Properties("TextEditor", "CSharp").Item("InsertTabs").Value
      DTE.Properties("TextEditor", "CSharp").Item("InsertTabs").Value = Not currentSetting
  End If

  If DTE.ActiveDocument.Language = "SQL" Then
      Dim currentSQLSetting As Boolean = DTE.Properties("TextEditor", "SQL").Item("InsertTabs").Value
      DTE.Properties("TextEditor", "SQL").Item("InsertTabs").Value = Not currentSQLSetting
  End If

  If DTE.ActiveDocument.Language = "HTML" Then
      Dim currentHTMLSetting As Boolean = DTE.Properties("TextEditor", "HTML").Item("InsertTabs").Value
      DTE.Properties("TextEditor", "HTML").Item("InsertTabs").Value = Not currentHTMLSetting
  End If

  If DTE.ActiveDocument.Language = "JScript" Then
      Dim currentJScriptSetting As Boolean = DTE.Properties("TextEditor", "JScript").Item("InsertTabs").Value
      DTE.Properties("TextEditor", "JScript").Item("InsertTabs").Value = Not currentJScriptSetting
  End If

End Sub 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-07T06:22:11.850

我曾经在 VS 2002/2003 中使用过很多宏。一个例子是区域创建——我总是喜欢将我的类划分为以下区域——“私有成员”、“公共属性”、“公共方法”和“私有方法”。所以，我有一个宏映射到一个快捷键，可以在任何新的类文件中创建这些区域。

VS 2005/2008 中的重构支持（以及添加通用代码片段的功能）以及使用 DXCore 和 SlickEdit 等插件让我无需再创建太多宏即可工作。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-12T20:17:22.103

我不能不提[这个](http://www.christophdebaene.com/blog/2006/11/21/visual-studio-net-macro-for-nesting-project-items/)问题就离开这个问题。它甚至有一个视频来展示如何安装和使用它。此宏仅允许您在解决方案资源管理器中创建嵌套文件（如 resources.resx）。

编辑：更新了链接

# c# - 缓存策略

> ID：523221
> 
> 赞同：0
> 
> 时间：2009-02-07T05:41:39.357
> 
> 标签：c#, winforms, memory

我在启动时加载了来自服务器的大量静态数据。我将它加载到 foo 对象的哈希表中。用户有一个下拉菜单，他们可以在其中选择这些对象之一。默认情况下，有 50,000 个对象会占用大量内存。我正在尝试减少记忆

在监测使用情况后，事实证明大多数人只使用了大约 1,000 个。我想要它，所以 gui 只加载那 1000 个，如果他们需要选择 1000 个之外的一个，那么他们可以返回服务器或磁盘。

这样做的最佳方法是什么。.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T06:04:35.317

我假设您正在其他地方过滤此列表......否则那是一个相当多的列表。在访问数据库之前访问新的、更精简的静态缓存的最简单方法是通过一个方法传递所有请求：

```
public yourClass GetDesiredObject(string lkupValue)
{
  if (yourCachedHashtable.ContainsKey(lkupValue))
  {
     return yourCachedHashtable[lkupValue]
  }
  else
  {
     //Hit the db to retrieve the object values.
     yourClass obj = yourDatabaseCode.GetNewObject(lkupValue);
     //Add to the cache if desired.
     yourCachedHashtable.Add(lkupValue, obj);
     return obj;
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-07T06:05:36.280

首先加载1000的问题是

1.  谁会滚动1000？

2.  返回磁盘将导致下拉菜单重置，他们将不得不再次滚动。

解决方案

1.  为什么不实现自动搜索下拉菜单，并尝试缓存应用程序块，它对我有大量数据非常有用。

2.  查看 devexpress 下拉编辑，您需要购买他们的控件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T05:49:03.630

您有一个包含 50000 个项目的下拉列表吗？这似乎有点过分了。也许是列表视图控件？您也可以将列表视图创建为虚拟列表视图 - 在这种模式下，它只会根据需要加载项目，如果其他项目滚动到视图中，则可以加载它们。由于您在列表视图中有这么多项目，我建议您使用某种搜索控件，用户可以使用它来缩小项目列表的范围。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T06:06:18.900

对于下拉菜单项，50,000 个对象似乎有点过多。也许您想查看其他小部件，例如带有分页的表格...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T05:54:38.223

根据您的数据的性质，如何忘记整个事情并将其留给操作系统？将其放入内存映射文件中。

# performance - 编码优先级：性能、可维护性、可重用性？

> ID：523222
> 
> 赞同：9
> 
> 时间：2009-02-07T05:43:58.663
> 
> 标签：performance, maintenance, code-reuse

这主要是由于对 SQL 问题的回答。出于性能考虑，有意省略了 UDF 和子查询。我没有包括可靠性，而不是认为它应该被视为理所当然，但代码必须工作。

性能永远是第一位的吗？以性能为主要优先事项提供了如此多的答案。我的用户似乎更关心代码的修改速度。因此，运行报告需要 15 秒而不是 12 秒。只要我不为不提供解决方案找借口，他们就可以忍受。

显然，如果 15 秒变成 15 分钟，那就有问题了，但用户想要这个功能。他们希望应用程序适应业务规则更改和增强请求。我希望能够在 6 个月后查看代码，并且能够在一个容易识别的位置进行更改，而不是追查所有那些有人复制和粘贴代码的地方，因为他们认为调用另一个函数或子例程或 Udf 会阻碍性能。

说了这么多，我要订购：可维护性（改变是生活中的事实。），性能（没有人喜欢盯着沙漏。），可重用性（很难确定应该再次使用什么代码。）。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-07T06:03:41.700

**1\. 可维护性：**如果代码不可读，不管它有多快，它都是无用的。而且绝对不会被重复使用。

**2\. 可重用性：**并非所有代码都是可重用的，但很多是可重用的。如果可以的话，一定要让你的代码更简单。最简单的就是分而治之。例如，创建您将反复使用的简单组件。UI 小部件是最常见的。但公用事业也是如此。同样，为您的代码创建结构/框架也会有所帮助。错误验证码等

**3\. 性能：**通常大多数代码都足够性能。如果没有，请使用代码分析器。通常，瓶颈会远远超过任何以可读性或可重用性为代价的小代码优化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-07T12:56:38.340

我认为您错过了列表中的一项：可靠性；

所以我的订单是

*   可靠性和准确性
*   可维护性
*   可重用性
*   表现

不正确的代码有多快并不重要，首先代码必须是可靠的。

性能位于列表的底部。永远不要过早优化，只有在性能出现问题时才提高性能。

我曾在包括飞行模拟在内的实时系统上工作过，即使在那种环境下，性能也被考虑在内，但并不是最重要的首要问题¹。

我想说，根据我的经验，我只需要优化不到 1% 的代码。

* * *

¹有时有些东西不够快，当然在设计和编码时会考虑性能，它只是不在列表的顶部。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T05:50:44.143

*2010-03-02 编辑*：问题最初开始：

> 每个人都为 NASA 工作吗？性能永远是第一位的吗？这么多答案...

不，我们大多数人都不为 NASA 工作。

不：可靠性和可维护性高于性能。可重用性也很好。

在广泛的范围内，性能并不重要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-07T05:51:02.910

傻瓜的答案当然是“这取决于”。

在业务线应用程序的情况下，所涉及的活动的响应时间需要与其运行的频率成反比。如果这是一个用户需要每小时访问 4 或 5 次的功能，它最好比提取月末报告更快。

我认为，在某种程度上，你已经回答了你自己的问题，并为此提供了一些非常正当的理由。你唯一错过的是可靠性——这就是 NASA 类比的用武之地。如果你正在为 NASA 或金融机构编写代码，那么它最好是健壮和可靠的......我认为这是第一要务。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-07T08:00:10.903

我是一名 NASA 承包商，主要出于管理目的开发和维护软件，例如运行报告和跟踪项目。

我已经在那里工作了大约 1.5 年，我相信他们主要关心的是**可维护性**以及部署新功能或模块的速度。

就像问题中所说的吉尼斯一样，只要软件不花费大量时间，他们似乎并不介意。

他们似乎关心的另一个主要问题是可用性。该应用程序必须易于使用。

总之，可维护性、可用性和性能似乎是 NASA 对内部报告和跟踪工具的主要关注点。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-07T08:06:31.623

您必须能够根据项目重新安排这些优先级，而当您在项目甚至不同代码部分之间切换时，困难可能是快速改变行为。我在三个具有非常不同配置文件的应用程序上工作。

1.  一个是实时的，并且需要做大量工作来确保其性能是可预测的（不一定是快速闪电），但变化不是主要问题，只有当 IETF 更改/废弃 RFC 并且几乎没有迹象时，它才会发生显着变化那个。（也就是说，我为它的可维护性水平感到自豪）。

    *   另一个应用程序有时需要 16 小时来处理 1 天的数据。毋庸置疑，绝对性能很快成为重中之重。但即使在这个应用程序中，性能的强调也有很大的不同，从每个批处理代码中的“不重要”到每个客户端代码、每个任务代码、每个文件代码、每个记录代码、每个-field-code 在每字节码中“极其重要”。

    *   最终的应用程序包含大部分业务逻辑，性能永远不是问题，可维护性和敏捷性是关键，这个应用程序从所有流行的方法中获益最多，但是，当我刚刚花了数周或数月的时间来重构性能时，这非常困难写“string1 + string2 + string3 + string4”，即使那是最易读的并且性能无关紧要。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-07T14:10:43.370

这是一个有趣的问题，答案也很有趣。优先级取决于实施。我想展示一个用户不会为了可维护性或可重用性而牺牲性能的例子。是的，有一个可靠性因素——应该有任何错误/错误。因此，当我们比较可维护性、性能和可重用性时。

我们的一位客户有在线交易网站。在峰值负载下，在中间件级别完成平均事务大约需要 14 毫秒。一段时间后，应用程序的性能下降（由于某些原因），事务平均时间增加到 24 毫秒。现在，作为一个普通的开发人员，我们会认为 10 毫秒并不是那么关键。但如果我们从商业角度思考，那就令人担忧了。如何？让我们分析一下：

让我们假设在峰值负载下，资源被充分利用，并且我们能够在 14 毫秒内完成 100 个事务。现在随着性能的下降，事务需要额外的 10 毫秒，即 71.42% 的额外时间。现在这意味着我们将只能处理 28.58 个事务，而不是 100 个事务。这意味着业务的严重损失。

事实上，有很多关于应用程序性能重要性的文献。有一本很好的书“计算机体系结构的定量方法”解释了如何在业务/用户方面量化性能、可维护性、可靠性、可用性等因素。

我不会指定重要性顺序，因为它是特定于上下文的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-07T05:52:46.557

> 他们认为调用另一个函数或子例程或 Udf 会影响性能

这是错误的想法。

> 我会订购：可维护性、性能、可重用性。

有时（通常是 IMO）可重用性*是*可维护性：这是因为您重用了某些东西，您“能够在一个容易识别的地方进行更改，而不是追查所有那些曾经复制和粘贴代码的地方”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-07T08:25:39.040

即使在 NASA，性能也不是第一位的！在 NASA，如果代码不正确和不可靠，人们就会死亡。

此外，根据我的经验，即使性能很有价值，也有一定的意义。通常有一个性能水平，在超越时几乎没有附加价值。相比之下，无论一段代码多么可靠，提高正确性都有额外的价值。一段代码不能经常按预期运行。

对我来说，顺序是：

*   **可维护性**：如果它不容易改变，即使它现在是正确的，它也不会长期保持正确。
*   **可重用性**：重用提高了生产力，并且更少的代码通常比更多的代码更可靠。
*   **性能**：有时性能很重要，但你会惊讶于有多少代码不是性能关键的，即使在性能关键的应用程序中也是如此。性能优化只对瓶颈很重要。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-07T13:45:12.563

**在一个孤立的答案中，性能几乎总是第一位的。**

我们不知道您是否会连续敲击这段代码一百万次，因此默认情况下性能是一个问题。我们不知道我们宝贵的代码片段是否会成为您应用程序的瓶颈，因为我们不知道它是如何交互的。（在编写库代码时也会发生同样的情况：我不知道这是如何使用的。IMO 代码重用的一个原因不仅仅是“将类似代码移动到共享实体”。）

**代码如何与我们未知的代码交互对可维护性**的影响更大。答案将在您设置的范围内解决问题：您可以要求或标记为 SQL、SQL Server 或 MySQL。其余的，我们只是不知道：你有多少类似的代码路径？在项目的生命周期中，这段代码多久更改一次？你会坚持使用那个特定的数据库服务器版本十年，还是会经常更新？

解决可维护性在很大程度上是您的工作：您问的问题是否应该隔离的实体？

**可读性**大部分已经完成，剩下的就是你的工作了。在回答时，我们通常对您理解答案感兴趣，因此它至少需要对您来说是可读的。如果您将该片段复制粘贴到您的代码中并对其进行`// That weird query`评论，那么不再是我的问题了。

除此之外，性能更容易理解这一事实：从两个功能相同的答案中，您总是会选择一个说“像 Joes 的答案，但要快一点”的答案，除非它在 ​​M+R 部门犯了大错。

* * *

现在写这个，看起来过早的优化很诱人是有原因的。由于几个原因，这*是错误的优先级。*

但是，优化的低优先级有两个主要原因：

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-07T13:56:51.977

**正确性**比可维护性、可重用性或性能更重要。如果您的目标是正确性，那么您很可能会在讨价还价中获得其他三个。

*   编写不必要的代码。
*   利用标准库。
*   喜欢透明而不是聪明。
*   编写小的、可测试的函数。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-10T16:14:00.420

以下是基于标签计数的结果：

*   性能 - 952
*   可重用性（几个相关标签） - 43
*   可维护性 - 14

这是什么意思：性能一定很重要？性能更难，因此会提出更多问题。性能问题更具体/更适合在本网站上提问？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-07T06:18:06.053

我在 NASA 工作**。**但是，我（目前无论如何）不维护或开发实时代码或任何对性能至关重要的东西。大多数在 NASA 完成的软件可能不是。在我看过一些可怕的代码之后，我也会选择 Jonathan 关于可靠性和可维护性的回答，其次是性能，然后是大多数应用程序的可重用性。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-07T08:29:00.813

我最喜欢的名言之一来自 SICP ...

“计算机程序旨在供人类阅读并由计算机偶然运行。”

我评价我工作的所有这些方面；但是我的代码和与我一起工作的代码的可读性（有些人使用术语表达能力）在我的重要性列表中名列前茅。

就我的2c，周末愉快！

# email - 拦截电子邮件以添加文本

> ID：523227
> 
> 赞同：-1
> 
> 时间：2009-02-07T05:48:57.843
> 
> 标签：email, exchange-server

我需要自动将文本添加到用户发送的电子邮件中。文本不能作为签名添加到 Outlook 中，但必须在用户单击 Outlook 中的“发送”后添加。我的公司使用 Microsoft Exchange Server。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T06:05:26.687

如果这是 Exchange Server 2007，您可以添加一个称为[传输规则](http://technet.microsoft.com/en-us/library/aa996585.aspx)的东西（在 Exchange 管理控制台中）来执行此操作。您要查找的内容称为“免责声明”，因为大多数公司都会这样做，以便他们可以在外发电子邮件的底部添加法律免责声明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T05:54:16.523

如果您有权分发此类内容，我希望这可以通过 Microsoft Outlook 加载项来完成。在客户端添加它作为插件可能比向服务器添加一些东西更容易，并且肯定不太可能导致服务器本身出现问题。

如果没记错的话，Visual Studio 允许您创建 Microsoft Office 插件。

这是 MSDN 文章的链接，该文章介绍了 C# 中的 Outlook 2003 编程 [http://msdn.microsoft.com/en-us/library/aa289167.aspx](http://msdn.microsoft.com/en-us/library/aa289167.aspx)

# c - 如何读入数字作为命令参数？

> ID：523237
> 
> 赞同：22
> 
> 时间：2009-02-07T05:53:21.877
> 
> 标签：c, command-line-arguments

如何使它在程序运行之前读取任何两个整数输入？我希望输出看起来像这样，其中 x 和 y 是输入的任何变量（我使用的是 Cygwin）：

$ ./axy

x 和 y 的乘积

x 和 y 之和

我用过`int main(int argc, char *argv[])`。我试图分配`argv[2]`to`x`和`argv[3]`to `y`，但是当我编译程序时，它说分配从指针中生成整数而不进行强制转换。这是什么意思，我该如何解决？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-02-07T06:12:07.767

假设 C 语言：

*   命令行参数可在 argv 数组中找到 - argv[1]、argv[2] 等。
*   可以使用 atoi 函数将字符串参数转换为整数。
*   可以使用 printf 函数完成输出。

[试图教你钓鱼，而不是提供鱼。祝你好运！]

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-02-07T06:14:59.117

假设您使用的是 bash，您可以对这些参数使用 $1、$2 等。但是，如果您使用的是 C，那么您的代码应该看起来更像这样：

```
#include <stdio.h>
#include <stdlib.h>

main(int argc, char *argv[]) {
    if(argc<=1) {
        printf("You did not feed me arguments, I will die now :( ...");
        exit(1);
     }  //otherwise continue on our merry way....
     int arg1 = atoi(argv[1]);  //argv[0] is the program name
                                //atoi = ascii to int
     //Lets get a-crackin!
 } 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-07T08:01:00.947

首先，如果你运行你的 C 程序

> ./axy

那么 a 是 argv[0]，x 是 argv[1]，y 是 argv[2]，因为 C 数组是基于 0 的（即数组中的第一项索引为 0。

意识到 argv 是一个字符串指针的数组（或者我一直认为它是一个 ARGument 向量，尽管您可能认为它是一个 ARGument 值的数组）。因此，您需要将字符串转换为整数。幸运的是，C 具有将 ASCII 转换为整数的库函数。查看 stdlib.h 文档。

祝你好运！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-10-30T16:33:55.897

我的代码看起来像这样。

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{
    // argc is number of arguments given including a.out in command line
    // argv is a list of string containing command line arguments
    int total = 0;
    int i;
    char *value;
    for(i = 1; i < argc; i++)
    {
        // The integers given is read as (char *)
        value = argv[i];
        printf("Command line index: %d value: %s in ascii: %d\n", i, value, *value);

        // Convert ascii to integer.
        // atoi function is defined in stdlib.h
        total += atoi(value);
    }
    // .2f limits the decimals to two digits after '.'
    printf("Total of given integers is %d\n", total);
} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/rhemI.png)](https://i.stack.imgur.com/rhemI.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-13T14:38:22.347

```
int arg1 = argv[1]; 
```

将不起作用，因为它是一个指针数组，其中包含 的所有地址`argv[0]....argv[n]`以获取 的值`argv[..]`假设`argv[1]`您必须编写：

```
int n=*argv[1]-'0'; // Direct atoi 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-08-05T06:49:29.003

只需使用 atoi() 将 char 类型的控制台输入转换为 int

```
 int main(argc, char* argv[])
   {
      int first = atoi(argv[1]);
      printf("%i", first);
   } 
```

如果你问为什么用 argv[1] 而不是 argv[0]，答案是第一个参数是你的可执行文件的名称。/some 2 int 这种情况下 argv[0] 将指向“some”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-11T20:28:30.200

在命令行参数中，char*argv[] 是字符串类型。我们需要将其转换为整数。我们通过类型转换来做到这一点，但在 oop 中，我们通过 atoi 函数（方法）来做到这一点，它的工作方式类似于类型转换（意味着将一种数据类型转换为另一种数据类型的方法）

# css - 为什么我的 css 在 IE 中呈现错误？

> ID：523243
> 
> 赞同：0
> 
> 时间：2009-02-07T05:56:38.483
> 
> 标签：css, internet-explorer, firefox, xhtml, standards

您会注意到 testing.ksischool.com 站点的主导航区域（徽标下方的灰色条）中链接的 :hover CSS 在 Firefox 中运行良好，但 IE7 会去掉底部的几个填充像素。为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-07T06:26:55.163

我假设您在谈论顶部导航；您正在填充内联元素（`<a>`标签）。在内联元素上放置内边距时，水平内边距会推动其他元素，但垂直内边距只会增加元素的大小，而不会影响其周围的布局。Firefox 可能会在源代码中呈现它们下方元素上方的框，但无论出于何种原因，IE 都将它们呈现在下方，这就是为什么您会看到框的某些部分消失的原因。

要解决此问题，请将所有链接向左浮动（本质上将它们变成块元素）。您需要在其他地方调整您的标记以使其正常工作（如果您只是直接浮动，可能会遇到一些清除问题），但这应该可以解决特定的 IE 问题。

* * *

**编辑以获取更多详细信息：**

如上所述，内联元素上的垂直填充不会像您预期的那样表现（它会增加元素的高度，但由于填充不与其他页面元素交互，内联元素通常会以奇怪的方式重叠事物）。因此，要解决此问题，您需要以某种方式使填充元素（`<a>`标签）具有`display: block`. 为了使所有内容保持在同一条线上，向左浮动是您最好的选择。这是我将使用的标记和样式：

```
<style type="text/css">
.mainnav {
    font-size: 1em;
    color: #999;
    list-style-type: none;
    /* zoom triggers hasLayout on IE, ignored by others
    Necessary for the clearfix */
    zoom: 1;
}

.mainnav:after {
    /* This lets the .mainnav auto-clear its floated contents */
    content: ".";
    display: block;
    height: 0;
    clear: both;
    visibility: hidden;
}

.mainnav li {
    float: left;
    margin: 0 2px;
    /* Place background (disc image) here w/ appropriate padding */
}

.mainnav li.last {
    background: none;
}

.mainnav a:link, .mainnav a:visited {
    display: block;
    color: #fff;
    text-decoration: none;
    padding: 1px 1px 2px;
    border: solid 1px transparent;
}

.mainnav a:hover {
    color: #fff;
    background: #999;
    text-decoration: none;
    padding: 1px 1px 2px;
    border: solid 1px #ccc;
}

.mainnav a.selected, .mainnav a.selected:hover {
    color: #B59B24;
    background: transparent;
    text-decoration: none;
}
</style>

<ul class="mainnav">
    <li><a href="/" class='selected'>Home</a></li>
    <li><a href="/About" >About</a></li>
    <li><a href="/Admissions" >Admissions</a></li>
    <li><a href="/Curriculum" >Curriculum</a></li>
    <li><a href="/Home/VacancyList" >Careers</a></li>
    <li class="last"><a href="/Contact" >Contact</a></li>
</ul> 
```

需要注意的一些事项：我正在使用标准的 clearfix（如果您不知道我在说什么，请使用 Google）来确保 UL 清除其浮动内容。如果用户放大他们的字体，这将允许父导航元素的大小适当地增长。

此外，我删除了分隔符并建议在 CSS 中`&middot;`使用背景图像和类。`.last`这纯粹是个人喜好。（在理想情况下，您会使用 :after 伪类来注入`&middot;`.将它留在标记中是因为它会导致更清晰的标记并且更容易改变（如果您的客户决定他们想要一个管道而不是一个点，比如说）。

此标记/样式背后的逻辑是您需要`<a>`在边框/背景颜色上进行填充，这意味着它必须具有`display: block`. 但是，添加它会将每个链接粘贴在不同的行上，因此您需要浮动它或其父级。由于它是列表的一部分，因此更容易浮动`li`父级并使用 clearfix 来确保`ul`页面上仍然存在一些。

显然，如果您使用此代码，您将需要删除`#nav_banner element`样式表中的大部分内容，并且您可能需要再次调试跨浏览器。即使您不这样做，也希望它能为您提供一些想法，以便将来轻松构建顶部导航。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T06:20:21.120

尝试将 display: inline-block 添加到 a 元素。我不确定它的兼容性如何，但它适用于 IE7 和 FF。

编辑：One Crayon 的解决方案肯定更好，也是更常见的方法。

# c# - 反序列化错误：命名空间“”中的 XML 元素“名称”已存在于当前范围内

> ID：523245
> 
> 赞同：5
> 
> 时间：2009-02-07T05:59:01.163
> 
> 标签：c#, xml, serialization, xml-serialization

这是我第一次使用 XML 序列化，在尝试解决此问题 2 天后，这让我非常**抓狂。**

反序列化开始时出现此错误：

```
The XML element 'name' from namespace '' is already present in the current scope. Use XML attributes to specify another XML name or namespace for the element. 
```

错误发生在我的代码中的这一行：

```
Album album = (Album)serializer.Deserialize(reader); 
```

我不知道为什么。没有 dup "name" 节点，所以我不明白。这是从第 3 方 REST API 的 HttpWebResponse 接收的 XML 文档。

**这是完整的代码：**

**我的专辑类**（我要反序列化的类型）：

```
 public class Album
    {
        #region Constructors

        public Album() 
        { 

        }

        #endregion

        #region ElementConstants

        public static class ElementConstants
        {
            public const string aID = "aid";
            public const string Owner = "owner";
            public const string AlbumName = "name";
            public const string CoverPhotoID = "cover_pid";
            public const string CreateDate = "created";
            public const string LastModifiedDate = "modified";
            public const string Description = "description";
            public const string Location = "location";
            public const string AlbumURL = "link";
            public const string Size = "size";
            public const string Visible = "visible";
        }

        #endregion ElementConstants

        #region Public Properties

        [XmlArray(ElementName = "photos_GetAlbums_response")]
        [XmlArrayItem( "album" )]
        public Album[] Albums { get; set; }

        [XmlElement (ElementName = ElementConstants.AlbumName, DataType = "string")]
        public string AlbumID { get; set; }

        [XmlElement(ElementName = ElementConstants.aID, DataType = "int")]
        public Int32 CoverPhotoID { get; set; }

        [XmlElement(ElementName = ElementConstants.Owner, DataType = "string")]
        public string Owner { get; set; }

        [XmlElement(ElementName = ElementConstants.AlbumName, DataType = "string")]
        public string AlbumName { get; set; }

        [XmlElement(ElementName = ElementConstants.aID, DataType = "DateTime")]
        public DateTime CreateDate { get; set; }

        [XmlElement(ElementName = ElementConstants.LastModifiedDate, DataType = "DateTime")]
        public DateTime LastModifiedDate { get; set; }

        [XmlElement(ElementName = ElementConstants.Description, DataType = "string")]
        public string Description { get; set; }

        [XmlElement(ElementName = ElementConstants.Location, DataType = "string")]
        public string Location { get; set; }

        [XmlElement(ElementName = ElementConstants.AlbumURL, DataType = "string")]
        public string Link { get; set; }

        [XmlElement(ElementName = ElementConstants.Size, DataType = "size")]
        public string Size { get; set; }

        [XmlElement(ElementName = ElementConstants.Visible, DataType = "string")]
        public string Visible { get; set; }

        #endregion
    } 
```

**我的序列化程序类**：

```
 public class Serializer
    {
        public static Album CreateAlbumFromXMLDoc(XmlDocument doc)
        {
            // Create an instance of a serializer
            var serializer = new XmlSerializer(typeof(Album));
            var reader = new StringReader(doc.ToString());

            // Deserialize the Xml Object and cast to type Album
            Album album = (Album)serializer.Deserialize(reader);

            return album;
        }
    } 
```

**我试图反序列化**的 XML（在 VS 中调试时从传递给 CreateAlbumFromXMLDoc 方法的 Xml Doc 对象复制）：

```
<?xml version="1.0" encoding="UTF-8"?>
<photos_GetAlbums_response xsi:schemaLocation="http://api.example.com/1.0/ http://api.example.com/1.0/xxx.xsd" list="true">
<album>
 <aid>3231990241086938677</aid>
 <cover_pid>7031990241087042549</cover_pid>
 <owner>1337262814</owner>
 <name>LA</name>
 <created>1233469624</created>
 <modified>1233469942</modified>
 <description>trip to LA</description>
 <location>CA</location>
 <link>http://www.example.com/album.php?aid=7333&id=1337262814</link>
 <size>48</size>
 <visible>friends</visible>
 </album>
<album>
 <aid>7031990241086936240</aid>
 <cover_pid>7031990241087005994</cover_pid>
 <owner>1337262814</owner>
 <name>Wall Photos</name>
 <created>1230437805</created>
 <modified>1233460690</modified>
 <description/>
 <location/>
 <link>http://www.example.com/album.php?aid=3296&id=1337262814</link>
 <size>34</size>
 <visible>everyone</visible>
 </album>
<album>
 <aid>7031990241086937544</aid>
 <cover_pid>7031990241087026027</cover_pid>
 <owner>1337262814</owner>
 <name>Mobile Uploads</name>
 <created>1231984989</created>
 <modified>1233460349</modified>
 <description/>
 <location/>
 <link>http://www.example.com/album.php?aid=6300&id=1337262814</link>
 <size>3</size>
 <visible>friends</visible>
 </album>
<album>
 <aid>7031990241086936188</aid>
 <cover_pid>7031990241087005114</cover_pid>
 <owner>1337262814</owner>
 <name>Christmas 2008</name>
 <created>1230361978</created>
 <modified>1230362306</modified>
 <description>My Album</description>
 <location/>
 <link>http://www.example.com/album.php?aid=5234&id=1337262814</link>
 <size>50</size>
 <visible>friends</visible>
 </album>
<album>
 <aid>7031990241086935881</aid>
 <cover_pid>7031990241087001093</cover_pid>
 <owner>1637262814</owner>
 <name>Hock</name>
 <created>1229889219</created>
 <modified>1229889235</modified>
 <description>Misc Pics</description>
 <location/>
 <link>http://www.example.com/album.php?aid=4937&id=1637262814</link>
 <size>1</size>
 <visible>friends-of-friends</visible>
 </album>
<album>
 <aid>7031990241086935541</aid>
 <cover_pid>7031990241086996817</cover_pid>
 <owner>1637262814</owner>
 <name>Test Album 2 (for work)</name>
 <created>1229460455</created>
 <modified>1229460475</modified>
 <description>this is a test album</description>
 <location/>
 <link>http://www.example.com/album.php?aid=4547&id=1637262814</link>
 <size>1</size>
 <visible>everyone</visible>
 </album>
<album>
 <aid>7031990241086935537</aid>
 <cover_pid>7031990241086996795</cover_pid>
 <owner>1637262814</owner>
 <name>Test Album (for work)</name>
 <created>1229459168</created>
 <modified>1229459185</modified>
 <description>Testing for work</description>
 <location/>
 <link>http://www.example.com/album.php?aid=4493&id=1637262814</link>
 <size>1</size>
 <visible>friends</visible>
 </album>
 </photos_GetAlbums_response> 
```

**附注：**只是为了它，我将该 XML 粘贴到 XML Notepad 2007 中，它告诉我：

您的 XML 文档不包含 xml-stylesheet 处理指令。要提供 XSLT 转换，请将以下内容添加到文件顶部并相应地编辑 href 属性：

我不认为这真的意味着它格式错误或其他任何东西，只是需要注意。

**所以..**

我的最终目标是显然通过这个该死的错误，并在我可以克服错误后使用上面的代码获取一系列专辑。我还想确保我的代码在尝试使用我的 Album 类中的 Album[] 属性或我可能在这里遗漏的任何其他东西来检索专辑的数组时是正确的。我认为它非常接近并且应该可以工作，但事实并非如此。

* * *

跟进。从那以后我一直在拔头发。

这是最新的。我暂时没有使用一些东西（来自 Marc），比如 Enum 等。我以后可能会改变它。我还拿出了日期时间的东西，因为它看起来很奇怪，而且我没有在没有错误的情况下出现错误……至少现在还没有。现在的主要问题仍然是我该死的 XML。

我猜它的格式似乎仍然存在问题？除非它掩盖了另一个问题，否则没有线索。这让我发疯。

## **当反序列化开始时，我现​​在收到此错误**：

```
Data at the root level is invalid. Line 1, position 1. 
```

错误发生在我的代码中的这一行： GetAlbumsResponse album = (GetAlbumsResponse)serializer.Deserialize(reader);

**我如何获得对 XmL 文档的响应**：

```
public static XmlDocument GetResponseXmlDocument(HttpWebResponse response)
        {
            Stream dataStream = null; // stream from WebResponse
            XmlDocument doc = new XmlDocument();

            if (doc == null)
            {
                throw new NullReferenceException("The web reponse was null");
            }

            // Get the response stream so we can read the body of the response
            dataStream = response.GetResponseStream();

            // Open the stream using a StreamReader for easy access
            StreamReader reader = new StreamReader(dataStream);

            // Load response into string variable so that we can then load into an XML doc
            string responseString = reader.ReadToEnd();

            // Create an XML document & load it with the response data
            doc.LoadXml(responseString);

            // Final XML document that represents the response
            return doc;
        } 
```

## **我的专辑类和根级别类**（感谢 Marc 的帮助......我现在明白了）：

```
namespace xxx.Entities
{

    [Serializable, XmlRoot("photos_GetAlbums_response")]
    public class GetAlbumsResponse
    {
        [XmlElement("album")]
        public List<Album> Albums { get; set; }

        [XmlAttribute("list")]
        public bool IsList { get; set; }
    }

    public class Album
    {
        #region Constructors

        public Album()
        {

        }

        #endregion

        #region ElementConstants

        /// <summary>
        /// Constants Class to eliminate use of Magic Strings (hard coded strings)
        /// </summary>
        public static class ElementConstants
        {
            public const string aID = "aid";
            public const string Owner = "owner";
            public const string AlbumName = "name";
            public const string CoverPhotoID = "cover_pid";
            public const string CreateDate = "created";
            public const string LastModifiedDate = "modified";
            public const string Description = "description";
            public const string Location = "location";
            public const string AlbumURL = "link";
            public const string Size = "size";
            public const string Visible = "visible";
        }

        #endregion ElementConstants

        #region Public Properties

        [XmlElement (ElementName = ElementConstants.aID, DataType = "string")]
        public string AlbumID { get; set; }

        [XmlElement(ElementName = ElementConstants.CoverPhotoID, DataType = "int")]
        public Int32 CoverPhotoID { get; set; }

        [XmlElement(ElementName = ElementConstants.Owner, DataType = "string")]
        public string Owner { get; set; }

        [XmlElement(ElementName = ElementConstants.AlbumName, DataType = "string")]
        public string AlbumName { get; set; }

        public string Created { get; set; }

        public DateTime Modified { get; set; }

        [XmlElement(ElementName = ElementConstants.Description, DataType = "string")]
        public string Description { get; set; }

        [XmlElement(ElementName = ElementConstants.Location, DataType = "string")]
        public string Location { get; set; }

        [XmlElement(ElementName = ElementConstants.AlbumURL, DataType = "string")]
        public string Link { get; set; }

        public string Size { get; set; }

        [XmlElement(ElementName = ElementConstants.Visible, DataType = "string")]
        public string Visible { get; set; }

        #endregion
    }
} 
```

## 我的序列化程序类：

```
namespace xxx.Utilities
{
    public class Serializer
    {
        public static List<Album> CreateAlbumFromXMLDoc(XmlDocument doc)
        {
            // Create an instance of a serializer
            var serializer = new XmlSerializer(typeof(Album));
            var reader = new StringReader(doc.ToString());

            // Deserialize the Xml Object and cast to type Album
            GetAlbumsResponse album = (GetAlbumsResponse)serializer.Deserialize(reader);

            return album.Albums;
        }
    }
} 
```

## 真正的 XML 传入，我试图反序列化（是的，它确实有 xmlns）：

```
<?xml version="1.0" encoding="UTF-8"?>
<photos_GetAlbums_response xmlns="http://api.example.com/1.0/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://api.example.com/1.0/ http://api.example.com/1.0/xxx.xsd" list="true">
  <album>
    <aid>7321990241086938677</aid>
    <cover_pid>7031990241087042549</cover_pid>
    <owner>1124262814</owner>
    <name>Album Test 1</name>
    <created>1233469624</created>
    <modified>1233469942</modified>
    <description>Our trip</description>
    <location>CA</location>
    <link>http://www.example.com/album.php?aid=7733&id=1124262814</link>
    <size>48</size>
    <visible>friends</visible>
  </album>
  <album>
    <aid>231990241086936240</aid>
    <cover_pid>7042330241087005994</cover_pid>
    <owner>1124262814</owner>
    <name>Album Test 2</name>
    <created>1230437805</created>
    <modified>1233460690</modified>
    <description />
    <location />
    <link>http://www.example.com/album.php?aid=5296&id=1124262814</link>
    <size>34</size>
    <visible>everyone</visible>
  </album>
  <album>
    <aid>70319423341086937544</aid>
    <cover_pid>7032390241087026027</cover_pid>
    <owner>1124262814</owner>
    <name>Album Test 3</name>
    <created>1231984989</created>
    <modified>1233460349</modified>
    <description />
    <location />
    <link>http://www.example.com/album.php?aid=6600&id=1124262814</link>
    <size>3</size>
    <visible>friends</visible>
  </album>
</photos_GetAlbums_response> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-07T08:53:15.880

就个人而言，我不会在这里使用常量——它们使发现错误变得困难（而且由于您可能没有重复使用它们，所以不要添加太多）。例如：

```
 [XmlElement (ElementName = ElementConstants.AlbumName, DataType = "string")]
    public string AlbumID { get; set; }
...
    [XmlElement(ElementName = ElementConstants.AlbumName, DataType = "string")]
    public string AlbumName { get; set; } 
```

在我看来很可疑...

一种更简单的方法是将您想要的 xml 写入文件（`foo.xml`例如）并使用：

```
xsd foo.xml
xsd foo.xsd /classes 
```

然后看`foo.cs`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T09:22:10.113

在这里我们开始...注意 xml 无效（`&`应该是`&amp;`；使用未声明的`xsi`命名空间别名）。另请注意，我为可见性添加了一个枚举，添加了将 long 转换为 的处理`DateTime`，并添加了包装器类型：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.IO;
using System.Xml;
using System.Xml.Serialization;

static class Program
{
    const string xml = @"<?xml version=""1.0"" encoding=""UTF-8""?>
<photos_GetAlbums_response
    xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""
    xsi:schemaLocation=""http://api.example.com/1.0/ http://api.example.com/1.0/xxx.xsd""
    list=""true"">
<album>
 <aid>3231990241086938677</aid>
 <cover_pid>7031990241087042549</cover_pid>
 <owner>1337262814</owner>
 <name>LA</name>
 <created>1233469624</created>
 <modified>1233469942</modified>
 <description>trip to LA</description>
 <location>CA</location>
 <link>http://www.example.com/album.php?aid=7333&amp;id=1337262814</link>
 <size>48</size>
 <visible>friends</visible>
 </album>
<album>
 <aid>7031990241086936240</aid>
 <cover_pid>7031990241087005994</cover_pid>
 <owner>1337262814</owner>
 <name>Wall Photos</name>
 <created>1230437805</created>
 <modified>1233460690</modified>
 <description/>
 <location/>
 <link>http://www.example.com/album.php?aid=3296&amp;id=1337262814</link>
 <size>34</size>
 <visible>everyone</visible>
 </album>
<album>
 <aid>7031990241086937544</aid>
 <cover_pid>7031990241087026027</cover_pid>
 <owner>1337262814</owner>
 <name>Mobile Uploads</name>
 <created>1231984989</created>
 <modified>1233460349</modified>
 <description/>
 <location/>
 <link>http://www.example.com/album.php?aid=6300&amp;id=1337262814</link>
 <size>3</size>
 <visible>friends</visible>
 </album>
<album>
 <aid>7031990241086936188</aid>
 <cover_pid>7031990241087005114</cover_pid>
 <owner>1337262814</owner>
 <name>Christmas 2008</name>
 <created>1230361978</created>
 <modified>1230362306</modified>
 <description>My Album</description>
 <location/>
 <link>http://www.example.com/album.php?aid=5234&amp;id=1337262814</link>
 <size>50</size>
 <visible>friends</visible>
 </album>
<album>
 <aid>7031990241086935881</aid>
 <cover_pid>7031990241087001093</cover_pid>
 <owner>1637262814</owner>
 <name>Hock</name>
 <created>1229889219</created>
 <modified>1229889235</modified>
 <description>Misc Pics</description>
 <location/>
 <link>http://www.example.com/album.php?aid=4937&amp;id=1637262814</link>
 <size>1</size>
 <visible>friends-of-friends</visible>
 </album>
<album>
 <aid>7031990241086935541</aid>
 <cover_pid>7031990241086996817</cover_pid>
 <owner>1637262814</owner>
 <name>Test Album 2 (for work)</name>
 <created>1229460455</created>
 <modified>1229460475</modified>
 <description>this is a test album</description>
 <location/>
 <link>http://www.example.com/album.php?aid=4547&amp;id=1637262814</link>
 <size>1</size>
 <visible>everyone</visible>
 </album>
<album>
 <aid>7031990241086935537</aid>
 <cover_pid>7031990241086996795</cover_pid>
 <owner>1637262814</owner>
 <name>Test Album (for work)</name>
 <created>1229459168</created>
 <modified>1229459185</modified>
 <description>Testing for work</description>
 <location/>
 <link>http://www.example.com/album.php?aid=4493&amp;id=1637262814</link>
 <size>1</size>
 <visible>friends</visible>
 </album>
 </photos_GetAlbums_response>";
    static void Main()
    {
        XmlSerializer ser = new XmlSerializer(typeof(GetAlbumsResponse));
        GetAlbumsResponse response;
        using (StringReader reader = new StringReader(xml))
        {
            response = (GetAlbumsResponse)ser.Deserialize(reader);
        }

    }
}

[Serializable, XmlRoot("photos_GetAlbums_response")]
public class GetAlbumsResponse
{
    [XmlElement("album")]
    public List<Album> Albums {get;set;}

    [XmlAttribute("list")]
    public bool IsList { get; set; }
}
public enum AlbumVisibility
{
    [XmlEnum("")]
    None,
    [XmlEnum("friends")]
    Friends,
    [XmlEnum("friends-of-friends")]
    FriendsOfFriends,
    [XmlEnum("everyone")]
    Everyone

}
[Serializable]
public class Album
{
    static readonly DateTime epoch = new DateTime(1970, 1, 1);
    static long SerializeDateTime(DateTime value)
    {
        return (long)((value - epoch).TotalSeconds);
    }
    static DateTime DeserializeDateTime(long value)
    {
        return epoch.AddSeconds(value);
    }
    [XmlElement("aid")]
    public long AlbumID { get; set; }

    [XmlElement("cover_pid")]
    public long CoverPhotoID { get; set; }

    [XmlElement("owner")]
    public long Owner { get; set; }

    [XmlElement("name")]
    public string AlbumName { get; set; }

    [XmlIgnore]
    public DateTime CreateDate { get; set; }

    [XmlElement("created"), Browsable(false)]
    [EditorBrowsable(EditorBrowsableState.Never)]
    public long CreateDateInt64 {
        get {return SerializeDateTime(CreateDate);}
        set {CreateDate = DeserializeDateTime(value);}
    }

    [XmlIgnore]
    public DateTime LastModifiedDate { get; set; }

    [XmlElement("modified"), Browsable(false)]
    [EditorBrowsable(EditorBrowsableState.Never)]
    public long LastModifiedDateInt64
    {
        get { return SerializeDateTime(LastModifiedDate); }
        set { LastModifiedDate = DeserializeDateTime(value); }
    }

    [XmlElement("description")]
    public string Description { get; set; }

    [XmlElement("location")]
    public string Location { get; set; }

    [XmlElement("link")]
    public string Link { get; set; }

    [XmlElement("size")]
    public int Size { get; set; }

    [XmlElement("visible")]
    public AlbumVisibility Visibility { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T10:33:08.783

(08 Feb) First, treating xml as a string (for reading) isn't going to cause errors.

The problem is the namespace (the `xmlns` **without** the `xsi`); this wasn't in the earlier xml, so I couldn't include it... basically, you need to tell the serializer about it:

```
[Serializable, XmlRoot("photos_GetAlbums_response",
    Namespace="http://api.example.com/1.0/")]
public class GetAlbumsResponse { /* code as before */ }

[Serializable, XmlType(Namespace="http://api.example.com/1.0/")]
public class Album { /* code as before */ } 
```

On this occasion, a constant for the namespace *would* make sense (since you are re-using it).

If the xml you are showing is accurate, then the links are still corrupt, though... but maybe this is just copy/paste (i.e. don't apply this change until you know it errors...): you **need** `&amp;` (not `&`). Suggest some "Replace"... at the crudest level:

```
string fixedXml = xml.Replace("&", "&amp;"); 
```

(although something more precise might be better - perhaps a regex)

Note that with the different data I also had to make some of the data strings (rather than long):

```
[XmlElement("aid")]
public string AlbumID { get; set; }

[XmlElement("cover_pid")]
public string CoverPhotoID { get; set; }

[XmlElement("owner")]
public string Owner { get; set; } 
```

With these changes (and mostly my original code) it works.

Of course, by this point you should be thinking "I wish I'd [used xsd](https://stackoverflow.com/questions/523245/523470#523470)".

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T06:20:20.823

[使用 System.Xml.XmlDocument 解析输入。](http://support.microsoft.com/kb/317664) 编写代码自己提取数据的时间应该不会超过一个小时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T17:51:12.347

适用于您当前代码的 Xml 如下所示：

```
<Album><photos_GetAlbums_response>
<Album>
   <photos_GetAlbums_response>
      <Album>
         <photos_GetAlbums_response> .... 
```

一个响应，它有一个专辑数组，其中每个专辑都有一个响应，它是一个专辑数组......等等。

无论如何，我已经在你的另一个问题上帮助了你，甚至不厌其烦地创建了一个完整的工作代码示例。你为什么要为同一个问题创建另一个问题？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T04:40:34.363

出色地，

Microsoft 提供了一个针对您的问题的[链接](http://msdn.microsoft.com/en-us/library/ms946381.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T04:42:56.947

是的 - 专辑绝对不是 XML 中的根节点。

我建议您创建一个包含专辑列表的 GetAlbumsResponse 类，并将您的反序列化代码移动到包装类。

基本上，从您的专辑类定义中删除根元素，并且：

```
 [XmlRoot (ElementName="GetAlbums_response")]
public class GetAlbumsResponse
{
    #region Constructors

    public GetAlbumsResponse()
    {

    }

    #endregion

    [XmlArray(ElementName="album")]
    public List<Album> Albums{get;set;}

    ... deserialization code... 
```

}

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-06T05:29:55.603

好的 - 我编写了一个示例。我查看了 Facebook API，现在这是一个完整的工作示例。尝试这个：

```
[XmlRoot("photos_getAlbums_response", Namespace="http://api.facebook.com/1.0/")]
public class GetAlbumsResponse
{
    public GetAlbumsResponse() 
    {    
    }

    [XmlElement("album")]
    public List<Album> Albums { get; set; }
}

public class Album
{
    [XmlElement("aid")]
    public long Aid{get;set;}

    [XmlElement("cover_pid")]
    public long CoverPid{get;set;}

    [XmlElement("owner")]
    public long Owner{get;set;}

    [XmlElement("name")]
    public string Name{get;set;}

    [XmlElement("created")]
    public long Created{get;set;}

    [XmlElement("modified")]
    public long Modified{get;set;}

    [XmlElement("description")]
    public string Description{get;set;}

    [XmlElement("location")]
    public string Location{get;set;}

    [XmlElement("link")]
    public string Link{get;set;}

    [XmlElement("size")]
    public int Size{get;set;}

    [XmlElement("visible")]
    public string Visible{get;set;}

    public Album()
    {}
}

class XmlUtils
{
    public static T DeserializeFromXml<T>(string xml)
    {
        T result;
        XmlSerializer ser = new XmlSerializer(typeof(T));
        using (TextReader tr = new StringReader(xml))
        {
            result = (T)ser.Deserialize(tr);
        }
        return result;
    }
} 
```

现在.. 使用来自 Facebook API 的 xml photos_getAlbums_response，

您可以像这样反序列化：

```
 GetAlbumsResponse response = XmlUtils.DeserializeFromXml<GetAlbumsResponse>(xmlResponseString); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-07-17T10:10:42.163

这是一个非常古老的线程，但我自己也遇到了同样的问题，同时尝试在同一个类中以相同的 XmlArray 名称序列化两个不同的列表类型，比如

```
 <Root>
       <ArrayNode>
         <SubnodeType1>...</SubnodeType1>
         <SubnodeType1>...</SubnodeType1>
       </ArrayNode>
    </Root>
Or
    <Root>
       <ArrayNode>
         <SubnodeType2>...</SubnodeType2>
         <SubnodeType2>...</SubnodeType2>
       </ArrayNode>
    </Root> 
```

对我有用的是使用类装饰，例如：

```
[XmlRoot(Namespace = "", ElementName = "Root")]
public class Root
{
    [XmlArray(ElementName = "ArrayNode", Namespace = "", IsNullable = false, Order = 1)]
    [XmlArrayItem("SubnodeType1")]
    public List<SubnodeType1> SubnodeType1 { get; set; }
    [XmlArray(ElementName = "ArrayNode", Namespace = "", IsNullable = false, Order = 2)]
    [XmlArrayItem("SubnodeType2")]
    public List<SubnodeType2> SubnodeType2 { get; set; }
} 
```

希望它可以帮助别人:)

# c# - 使用自定义 TTF 字体进行 DrawString 图像渲染

> ID：523246
> 
> 赞同：20
> 
> 时间：2009-02-07T06:00:48.193
> 
> 标签：c#, .net, fonts, gdi+, drawstring

我在服务器端使用 GDI+ 创建一个流式传输到用户浏览器的图像。没有一个标准字体符合我的要求，所以我想加载一个 TrueType 字体并使用这个字体将我的字符串绘制到图形对象：

```
using (var backgroundImage = new Bitmap(backgroundPath))
using (var avatarImage = new Bitmap(avatarPath))
using (var myFont = new Font("myCustom", 8f))
{
    Graphics canvas = Graphics.FromImage(backgroundImage);
    canvas.DrawImage(avatarImage, new Point(0, 0));

    canvas.DrawString(username, myFont,
        new SolidBrush(Color.Black), new PointF(5, 5));

    return new Bitmap(backgroundImage);
} 
```

`myCustom`表示未安装在服务器上的字体，但我有 TTF 文件。

如何加载 TTF 文件以便在 GDI+ 字符串渲染中使用它？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-07T07:31:29.557

我找到了使用自定义字体的解决方案。

```
// 'PrivateFontCollection' is in the 'System.Drawing.Text' namespace
var foo = new PrivateFontCollection();
// Provide the path to the font on the filesystem
foo.AddFontFile("...");

var myCustomFont = new Font((FontFamily)foo.Families[0], 36f); 
```

现在`myCustomFont`可以按预期与 Graphics.DrawString 方法一起使用。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-10-21T21:40:52.250

只是为了给出更完整的解决方案

```
using System;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Drawing;
using System.Drawing.Text;

public partial class Test : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string fontName = "YourFont.ttf";
        PrivateFontCollection pfcoll = new PrivateFontCollection();
        //put a font file under a Fonts directory within your application root
        pfcoll.AddFontFile(Server.MapPath("~/Fonts/" + fontName));
        FontFamily ff = pfcoll.Families[0];
        string firstText = "Hello";
        string secondText = "Friend!";

        PointF firstLocation = new PointF(10f, 10f);
        PointF secondLocation = new PointF(10f, 50f);
        //put an image file under a Images directory within your application root
        string imageFilePath = Server.MapPath("~/Images/YourImage.jpg");
        Bitmap bitmap = (Bitmap)System.Drawing.Image.FromFile(imageFilePath);//load the image file

        using (Graphics graphics = Graphics.FromImage(bitmap))
        {
            using (Font f = new Font(ff, 14, FontStyle.Bold))
            {
                graphics.DrawString(firstText, f, Brushes.Blue, firstLocation);
                graphics.DrawString(secondText, f, Brushes.Red, secondLocation);
            }
        }
        //save the new image file within Images directory
        bitmap.Save(Server.MapPath("~/Images/" + System.Guid.NewGuid() + ".jpg"));
        Response.Write("A new image has been created!");
    } 
} 
```

# .htaccess - .htaccess 中的布尔 AND

> ID：523247
> 
> 赞同：0
> 
> 时间：2009-02-07T06:02:03.997
> 
> 标签：.htaccess

好吧，我正在使用以下代码将没有我 IP 的用户重定向到即将推出的页面：

```
rewritebase /
rewritecond %{REMOTE_HOST} !(^1\.2\.3\.4)
rewritecond %{REQUEST_URI} !/comingsoon\.html$ 
rewriterule .* http://www.andrew-g-johnson.com/comingsoon.html [R=302,L] 
```

我想这样做，以便我有两个允许的 IP，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T06:09:47.427

您可以指定一个正则表达式，如：

```
(1\.2\.3\.4|5\.6\.7\.8) 
```

但是你想要的例外越多，这就越笨拙。

您可能想要做的是使用带有允许和拒绝指令的[mod_access](http://httpd.apache.org/docs/2.0/mod/mod_access.html)（假设您使用的是 Apache）。

```
order deny, allow
deny all
allow from 1.2.3.4
allow from 5.6.7.8
ErrorDocument 403 http://www.andrew-g-johnson.com/comingsoon.html 
```

结合 403 的自定义错误文档，说明即将推出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T06:30:23.690

我实际上会推荐 Cletus 的建议，但如果你想坚持使用 .htaccess ，另一种选择是添加更多的条件行（好处是它比将它们全部连接成一个长的正则表达式更清晰）：

```
rewritebase /
rewritecond %{REMOTE_HOST} !(^1\.2\.3\.4)
rewritecond %{REMOTE_HOST} !(^5\.6\.7\.8)
# and so forth
rewritecond %{REQUEST_URI} !/comingsoon\.html$ 
rewriterule .* http://www.andrew-g-johnson.com/comingsoon.html [R=302,L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T09:04:31.880

`RewriteCond`指令与 AND 隐式组合。所以你只需要添加另一个`RewriteCond`指令来表达这一点：

```
RewriteCond %{REMOTE_HOST} !^1\.2\.3\.4$
RewriteCond %{REMOTE_HOST} !=5.6.7.8
RewriteRule !^comingsoon\.html$ comingsoon.html [R=302,L] 
```

此外，您应该指定使用的地址的开始和结束，`^`或者`$`与 进行字典比较`=`。

# c# - 设计更好的图形用户界面？

> ID：523254
> 
> 赞同：10
> 
> 时间：2009-02-07T06:04:47.563
> 
> 标签：c#, user-interface

我使用 C# 已经有一段时间了，但还没有真正掌握我的 UI 设计技能。在我设计它们的时候，我发现自己很享受这个设计，但后来，我回顾它并看到可怕的工作。我在工作项目中想到了一个例子，我必须使用 127 个按钮来代表我们实验室中的 127 台计算机。：/

我想知道是否有人可以向我推荐一个可以教授优秀 UI 设计的网站或书籍？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-07T06:16:57.367

Joel Spolsky 写了一本名为《程序员用户界面设计》的书，很好读，[网上可以找到](http://www.joelonsoftware.com/uibook/chapters/fog0000000057.html)删节版。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-07T06:23:02.627

我相信**观察**和**直觉**有很大帮助。

玩转应用程序并深入研究它们实现的功能。特别是看看苹果，因为它们围绕着美学。什么有效？什么没有？为什么它起作用了？在修补网站和软件时开始问自己问题。

然后我会玩并设计一些概念。将这些概念展示给技术和非技术的朋友。问他们一些问题，例如“在列表中添加新饮料”或“为我找 x”。看看他们如何反应和彼此不同。有技术背景的人会比非技术人员更快地注意到按钮吗？你应该将元素组合在一起吗？

这东西应该很有趣。毕竟，这就像构建一个完整的乐高积木并将其展示给您的朋友。他/她可以看到、触摸和玩您的创作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-07T06:43:38.343

Donald A. Norman[的日常用品设计](https://rads.stackoverflow.com/amzn/click/com/0385267746)

Jef Raskin[的人性化界面](https://rads.stackoverflow.com/amzn/click/com/0201379376)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-07T09:01:21.060

首先要关注的最重要的是事物的工作流程。尝试找到用户的目标并创建一个模型，以尽可能有效地实现该目标。还阅读了很多关于这本书的最好的书之一是 The [Inmates are running the asylum](https://rads.stackoverflow.com/amzn/click/com/0672316498)

我会在这里建议很多草图。确保您保持简单，专注于放置物品的内容和位置，而不是它们的外观。像[balsamiq](http://www.balsamiq.com/)这样的工具非常适合快速 UI 模型。还通过这里的 UI 模式来提出可行的概念，Tidwells 的书[设计界面](http://designinginterfaces.com/)很棒，Infragistics 新[模式网站](http://quince.infragistics.com/#/Main)也是很好的资源

现在你已经知道你想做什么了，现在是时候把界面放在一起了。从第一个草图到最后一个像素的过程中 - 始终是用户测试。

并且不要总是遵循 UI 指南，如果你有充分的理由，可以打破它们。最后，您将只能在界面中获得一个免费的无关 3D 效果 :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T06:19:57.267

基于 Vinay 的回答，在设计界面时，与您的目标平台集成始终是最重要的。如果您在 Windows 上进行开发，请确保您忠实于该平台的外观、感觉和可用性期望。界面指南总是会成为一个起点，尽管有些比其他的要好。对我来说，[GNOME 人机界面指南](http://library.gnome.org/devel/hig-book/stable/)是一套很好的设计用户友好界面的指南，即使您没有使用 GTK。

更笼统地说，学习好的设计实际上就是学习*识别*好的设计。找到一些真正直观的应用程序，然后模仿它们的布局、样式等。然后，当您为如何实现特定功能而苦恼时，在其他应用程序中找到合适的类似物。您将需要特别注意分组、选项卡、快捷方式、对话框模式等问题。我认为您会发现很少有好的设计原则取决于您正在编程的语言，除非它可能会影响您定位的工具包和平台。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-07T08:16:52.630

我读过 Spolsky 的《*程序员用户界面设计》*一书，以及经典的《软件设计和*Windows 用户体验**的 Windows 界面指南》 。* 后两本是/曾经是很好的参考书。Spolsky 的书是一本非常有趣的读物，它教你如何思考用户界面设计。

 *不过，就我而言，设计桌面应用程序用户界面的最佳方式是复制流行软件的现有解决方案。通过“复制”，我指的是两个不同的方面——机制和美学。

至于**机制**担心的是，请确保您的 UI 以人们期望的方式工作。例如，如果您有一个树视图，请确保键盘箭头适用于导航。如果您的表单有滚动条，请确保它响应鼠标上的滚轮。总的来说，.NET 控件默认提供标准行为，但您可能必须配置一些设计时属性才能完全实现这一点。几年前我有一个控件库，它提供了一个标准的文本框。但是，我发现当我点击控件时，文本并没有自动突出显示。我添加了这种行为，因为这是我（和我的用户）期望控件工作的方式。引用 Spolsky 的话，“一致性导致易用性，而这反过来又会带来良好的感觉......”换句话说，

就**美学**而言，我发现专注于字体、图标、控件之间的间距和对齐、颜色的选择性使用（我喜欢使用渐变）等可以大大增加这种感觉完善您的用户界面。众所周知，我在 Paint 中使用位图屏幕捕获来测量控件之间的填充，以便模仿 Microsoft 应用程序中的填充。当我向同事透露这些信息时，他们中的大多数人都看着我，好像我疯了一样。但是我不能仅仅通过关注其他人认为微不足道的事情来告诉你我在用户界面上取得了多少成功。我将其归结为简单地利用了微软在使他们的应用程序具有视觉吸引力方面所做的所有研究。

所以我的建议是阅读 Spolsky 的书，然后尝试尽可能多地复制 Microsoft 应用程序。对于桌面应用程序，这是最可靠的方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-08T11:42:58.487

花点时间看看*其他*软件产品。每年，像谷歌和微软这样的公司都会在可用性测试中投入数百万美元。把他们学到的关于用户交互的知识应用到你自己的产品/项目中。

Infragistics 还为 UI 设计模式创建了一个很好的参考，可以在[http://quince.infragistics.com/](http://quince.infragistics.com/)找到。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-07T06:09:33.857

您可以参考 Windows UI 指南或 Mac UI 指南。

Mac UI 指南可在[http://developer.apple.com/documentation/userexperience/Conceptual/AppleHIGuidelines/XHIGIntro/chapter_1_section_1.html 获得](http://developer.apple.com/documentation/userexperience/Conceptual/AppleHIGuidelines/XHIGIntro/chapter_1_section_1.html)

Windows UI 指南可在 [http://msdn.microsoft.com/en-us/library/aa511258.aspx获得](http://msdn.microsoft.com/en-us/library/aa511258.aspx)

编辑：每个人都喜欢这里的 Google UI 是[链接](http://googlesystem.blogspot.com/2008/03/googles-design-guidelines.html)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-07T06:32:35.977

我认为最好的办法是练习。我喜欢先在纸上设计窗户（空白纸或方格纸）。使用尺子并确保物品对齐且干净。

> 我在工作项目中想到了一个例子，我必须使用 127 个按钮来代表我们实验室中的 127 台计算机。：/

在这里问自己问题，我不喜欢什么？如何改进？我需要计算机的下拉菜单或列表框吗？

还知道您的[GUI 小部件](http://en.wikipedia.org/wiki/GUI_widget)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-08T12:40:06.360

答案已经给出了一些关于如何专门设计界面的好书。我想提供一些建议，以帮助您改善设计的*鼻子*。其中一些可能是便宜的二手货，或者你可以在当地借的东西（我总是愿意把书借给西澳大利亚珀斯的人）：

*   比尔巴克斯顿的[素描用户体验](https://rads.stackoverflow.com/amzn/click/com/0123740371)- 购买它，阅读故事并开始练习素描
*   纳撒尼尔·博伦斯坦（Nathaniel Borenstein）的（绝版） 《像人一样重要的[编程》](https://rads.stackoverflow.com/amzn/click/com/0691037639) ——一本极好的轶事小书
*   Jeff Johnson 的[GUI Bloopers](https://rads.stackoverflow.com/amzn/click/com/0123706432)将帮助您处理大量实用的设计错误示例，包括桌面和 Web 应用程序设计。

# javascript - 如何从 location.search 获取特定参数？

> ID：523266
> 
> 赞同：68
> 
> 时间：2009-02-07T06:08:27.883
> 
> 标签：javascript, url

如果我有一个 URL，例如

```
http://localhost/search.php?year=2008 
```

我将如何编写一个 JavaScript 函数来获取变量*year*并查看它是否包含任何内容？

我知道它可以完成，`location.search`但我不知道它是如何获取参数的。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2017-01-10T19:00:37.480

您可以使用[`window.URL`](https://developer.mozilla.org/en-US/docs/Web/API/URL)类：

```
new URL(location.href).searchParams.get('year')
// Returns 2008 for href = "http://localhost/search.php?year=2008".
// Or in two steps:
const params = new URL(location.href).searchParams;
const year = params.get('year'); 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-09-10T08:30:36.370

我最喜欢的获取 URL 参数的方法是这种方法：

```
var parseQueryString = function() {

    var str = window.location.search;
    var objURL = {};

    str.replace(
        new RegExp( "([^?=&]+)(=([^&]*))?", "g" ),
        function( $0, $1, $2, $3 ){
            objURL[ $1 ] = $3;
        }
    );
    return objURL;
};

//Example how to use it: 
var params = parseQueryString();
alert(params["foo"]); 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2009-02-07T06:22:22.987

一种非正则表达式方法，您可以简单地按字符“&”拆分并遍历键/值对：

```
function getParameter(paramName) {
  var searchString = window.location.search.substring(1),
      i, val, params = searchString.split("&");

  for (i=0;i<params.length;i++) {
    val = params[i].split("=");
    if (val[0] == paramName) {
      return val[1];
    }
  }
  return null;
} 
```

## 2020年编辑：

如今，在[现代浏览器](https://caniuse.com/#search=URLSearchParams)中，您可以使用[`URLSearchParams`构造函数](https://developer.mozilla.org/en/docs/Web/API/URLSearchParams/URLSearchParams)：

```
const params = new URLSearchParams('?year=2020&month=02&day=01')

// You can access specific parameters:
console.log(params.get('year'))
console.log(params.get('month'))

// And you can iterate over all parameters
for (const [key, value] of params) {
  console.log(`Key: ${key}, Value: ${value}`);
}
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2017-02-18T14:29:28.467

这个问题很老了，并且在 JavaScript 中已经发生了变化。您现在可以这样做：

```
const params = {}
document.location.search.substr(1).split('&').forEach(pair => {
  [key, value] = pair.split('=')
  params[key] = value
}) 
```

你得到`params.year`包含`2008`. 您还将在`params`对象中获得其他查询参数。

* * *

**编辑**：执行此操作的更短/更清洁的方法：

```
const params = new Map(location.search.slice(1).split('&').map(kv => kv.split('='))) 
```

然后，您可以测试`year`参数是否存在：

```
params.has('year')  // true 
```

或使用以下命令检索它：

```
params.get('year')  // 2008 
```

* * *

### 编辑 2020

您可以将 URL 参数转换为对象：

```
const params = location.search.slice(1).split('&').reduce((acc, s) => {
  const [k, v] = s.split('=')
  return Object.assign(acc, {[k]: v})
}, {}) 
```

然后它可以用作常规的 JS 对象：

```
params.year  // 2008 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-09-10T08:20:31.453

以下使用正则表达式并仅搜索 URL 的查询字符串部分。

最重要的是，此方法支持普通和数组参数，如 `http://localhost/?fiz=zip&foo[]=!!=&bar=7890#hashhashhash`

```
function getQueryParam(param) {
    var result =  window.location.search.match(
        new RegExp("(\\?|&)" + param + "(\\[\\])?=([^&]*)")
    );

    return result ? result[3] : false;
}

console.log(getQueryParam("fiz"));
console.log(getQueryParam("foo"));
console.log(getQueryParam("bar"));
console.log(getQueryParam("zxcv")); 
```

**输出：**

```
zip
!!=
7890
false 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-07T06:19:57.720

```
function gup( name ) {
    name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    var regexS = "[\\?&]"+name+"=([^&#]*)";
    var regex = new RegExp( regexS );
    var results = regex.exec( window.location.href );
    if( results == null )
        return "";
    else
        return results[1];
}
var year = gup("year"); // returns "2008" 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-08-14T22:29:14.780

我花了一段时间才找到这个问题的答案。大多数人似乎都在建议正则表达式解决方案。我非常喜欢使用经过尝试和测试的代码，而不是我或其他人即时想到的正则表达式。

我使用此处提供的 parseUri 库：http: [//stevenlevithan.com/demo/parseuri/js/](http://stevenlevithan.com/demo/parseuri/js/)

它允许您完全按照您的要求做：

```
var uri = 'http://localhost/search.php?year=2008';
var year = uri.queryKey['year'];
// year = '2008' 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-04-20T23:53:07.117

最简单的方法是拥有

```
if (document.location.search.indexOf('yourtext=') >= 0) {
    // your code
} else {
    // what happens?
} 
```

## 指数（）

函数`indexOf(text)`返回

*   **当函数中传递的文本不在您要查找的任何变量或字符串中时（在这种情况下），**整数低于 0**`document.location.search`。**
***   **当函数中传递的文本位于您要查找的任何变量或字符串中时，**等于 0 或更高**`document.location.search`的整数 - 在这种情况下。****

 ***** * *

我希望这很有用，*[@gumbo](https://stackoverflow.com/users/53114/gumbo "@秋葵")*

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-06-08T22:59:29.267

一个简单的单线解决方案：

```
let query = Object.assign.apply(null, location.search.slice(1).split('&').map(entry => ({ [entry.split('=')[0]]: entry.split('=')[1] }))); 
```

扩展和解释：

```
// define variable
let query;

// fetch source query
query = location.search;

// skip past the '?' delimiter
query = query.slice(1);

// split source query by entry delimiter
query = query.split('&');

// replace each query entry with an object containing the query entry
query = query.map((entry) => {

   // get query entry key
   let key = entry.split('=')[0];

   // get query entry value
   let value = entry.split('=')[1];

   // define query object
   let container = {};

   // add query entry to object
   container[key] = value;

   // return query object
   return container;
});

// merge all query objects
query = Object.assign.apply(null, query); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-11-15T14:39:38.570

我使用了 Alex 的变体 - 但需要将多次出现的参数转换为数组。似乎有很多选择。我不想依赖另一个库来做这么简单的事情。我想这里发布的其他选项之一可能会更好——因为直截了当，我改编了 Alex 的。

```
parseQueryString = function() {
    var str = window.location.search;
    var objURL = {};

    // local isArray - defer to underscore, as we are already using the lib
    var isArray = _.isArray

    str.replace(
        new RegExp( "([^?=&]+)(=([^&]*))?", "g" ),
        function( $0, $1, $2, $3 ){

            if(objURL[ $1 ] && !isArray(objURL[ $1 ])){
                // if there parameter occurs more than once, convert to an array on 2nd
                var first = objURL[ $1 ]
                objURL[ $1 ] = [first, $3]
            } else if(objURL[ $1 ] && isArray(objURL[ $1 ])){
                // if there parameter occurs more than once, add to array after 2nd
                objURL[ $1 ].push($3)
            }
            else
            {
                // this is the first instance
                objURL[ $1 ] = $3;
            }

        }
    );
    return objURL;
}; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-02-25T19:44:23.193

I played a bit with this problem and at this end I used this:

```
function getJsonFromUrl() {
  return Object.assign(...location.search.substr(1).split("&").map(sliceProperty));
} 
```

*   `Object.assign` to transform a list of object into one object
*   Spread operator `...` to transform an array into a list
*   `location.search.substr(1).split("&")` to get all parameters as array of properties (`foo=bar`)
*   `map` walk each properties and split them into an array (either call `splitProperty` or `sliceProperty`).

`splitProperty`:

```
 function splitProperty(pair) {
    [key, value] = pair.split("=")
    return { [key]: decodeURIComponent(value) }
  } 
```

*   Split by `=`
*   Deconstruct the array into an array of two elements
*   Return a new object with the dynamic property syntax

`sliceProperty`:

```
 function sliceProperty(pair) {
    const position = pair.indexOf("="),
      key = pair.slice(0, position),
      value = pair.slice(position + 1, pair.length);
    return { [key]: decodeURIComponent(value) }
  } 
```

*   Set the position of `=`, key and value
*   Return a new object with the dynamic property syntax

I think `splitProperty` is prettier but `sliceProperty` is faster. Run [JsPerf](https://jsperf.com/slice-vs-substr-vs-substring-vs-split-vs-regexp/2) for more information.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-07-09T21:14:15.850

用一行从 location.search 中获取参数：

```
const params = new Map(this.props.location.search.slice(1).split('&').map(param => param.split('='))) 
```

然后，简单地说：

```
if(params.get("year")){
  //year exists. do something...
} else {
  //year doesn't exist. do something else...
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-10-29T13:00:43.933

这就是我喜欢做的事情：

```
window.location.search
    .substr(1)
    .split('&')
    .reduce(
        function(accumulator, currentValue) {
            var pair = currentValue
                .split('=')
                .map(function(value) {
                    return decodeURIComponent(value);
                });

            accumulator[pair[0]] = pair[1];

            return accumulator;
        },
        {}
    ); 
```

当然，您可以使用现代语法或将所有内容写成一行来使其更紧凑...

我把它留给你。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-08-22T05:20:43.840

ES6 答案：

```
const parseQueryString = (path = window.location.search) =>
  path.slice(1).split('&').reduce((car, cur) => {
   const [key, value] = cur.split('=')
   return { ...car, [key]: value } 
  }, {}) 
```

例如：

```
parseQueryString('?foo=bar&foobar=baz')
// => {foo: "bar", foobar: "baz"} 
```

# subtext - 是否有任何 Subtext IDE 或等效的示例驱动的可视化编程语言/接口发布在 Internet 上？

> ID：523275
> 
> 赞同：3
> 
> 时间：2009-02-07T06:13:23.537
> 
> 标签：subtext, visual-programming

我对这种名为[Subtext](http://www.subtextual.org/)的新的实验性语言感到非常兴奋。但它的作者除了一些论文和视频外，没有发布任何关于它的信息。我应该克隆它吗？有没有类似的替代品？

**更新**我正在寻找一个示例驱动的 VPL，而不仅仅是一个 VPL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T02:04:00.580

正如 Edwards 在他的相关工作部分中所说，自编程语言非常相似。它与潜台词一样强调直接性、统一性和生动性，但不强调表格格式（示意图表）。

Solaris 版本做了很多工作：
[http](http://research.sun.com/self/papers/papers.html)
://research.sun.com/self/papers/papers.html 似乎有 Mac 和 linux 版本，不确定它有多成熟：
[http ://selflanguage.org /](http://selflanguage.org/)

这是一个演示自我的视频，他们强调直接、统一和活泼：
[http ://www.smalltalk.org.br/movies/](http://www.smalltalk.org.br/movies/)

当您说“任何 VPL”时，您的意思是根本没有，或者不是普通的 VPL？从标题问题的措辞来看，我假设后者。这里有一些背后有一些严肃的编程理论：

Morphic 是/曾经是 Self 的 UI 部分，现在移植到 Squeak：
[http ://wiki.squeak.org/squeak/2139](http://wiki.squeak.org/squeak/2139)

Prograph 是一个非常酷的系统，但我不知道有可用的版本。
更远一点的是 Kahn 的 Toontalk，基于 Pictorial Janus：
[http ://www.toontalk.com/](http://www.toontalk.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T23:01:10.013

您没有提供更多关于您期望从这样的 VPL 环境中获得的功能的信息，但我认为“Tersus”可能会很有趣。有许多 VPL，但主要是作为教育工具或特定技术的补充（即 Microsoft Robotics Studio 的 VPL），以简化常见任务编程。“Tersus”是成熟的应用程序开发平台。它是开源的，许多操作系统都可以免费下载。

[http://www.tersus.com](http://www.tersus.com)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T01:04:49.157

我相信您知道[VPL On Wikipedia](http://en.wikipedia.org/wiki/Visual_programming_language)列出了许多不同的 VPL 语言。您尚未提供有关您要达到的目标的信息，但另一个站点是[Synopsis](http://www.codemorphis.com/)。这是一个商业产品。

从他们的网站：

> Synopsis 是一个完全可视化的 Windows RAD 工具，让您不必编写文本代码和学习不必要的编程细节。通过 Synopsis，您可以专注于创建软件，而不是与平凡而复杂的低级开发任务搏斗。

下图显示了此应用程序的外观：

[![替代文字](https://i.stack.imgur.com/MrVzE.jpg)](https://i.stack.imgur.com/MrVzE.jpg)
[（来源：[codemorphis.com](http://www.codemorphis.com/images/visual_programming_example.jpg)）]

当然，我在这个主题上的知识是有限的，我会按照这个来看看是否可以创造出真正强大的东西。我确实在[CodeProject](http://www.codeproject.com/)或[CodePlex](http://www.codeplex.com/)上看到了一个用 C# 编写的允许 VPL 的项目，但我找不到那个 URL。

如果我真的找到了那个应用程序，我会编辑这篇文章！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-24T12:51:09.507

Coherence — 导演剪辑 Coherence 主页位于[http://coherence-lang.org](http://coherence-lang.org)。提交的论文版本在那里，有一个新的介绍和一个出人意料的结尾。

Coherence 声称是一种实验性编程语言，是 Subtext 使用其他方式的延续。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-26T15:18:43.287

有意发货，但它们仍然是 alpha 版，分发和测试有限。您可以制作示例驱动的 DSL，但我不知道环境本身是否以这种方式工作。

[http://lambda-the-ultimate.org/node/3287](http://lambda-the-ultimate.org/node/3287)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-04-23T09:17:54.357

您也可以查看正在发生的前夕工作：

[http://incidentalcomplexity.com/](http://incidentalcomplexity.com/)

# user-interface - 在提供丰富的 UI 体验的同时处理以域为中心的验证的最佳方式是什么？

> ID：523289
> 
> 赞同：0
> 
> 时间：2009-02-07T06:21:07.047
> 
> 标签：user-interface, validation

我的公司正在开发一个 GUI 应用程序，它允许用户查询遗留数据库系统并将结果显示在屏幕上（结果只是以纯文本的形式返回）。我正在努力寻找构建用户界面和域层之间交互的最佳方式，尤其是用户输入的验证。

### 基本用例

1.  用户从应用程序的菜单中选择要运行的查询。
2.  应用程序代码显示所选查询的数据输入表单。
3.  用户输入查询的参数。如果字段包含无效数据，它会立即以红色突出显示，并且其工具提示文本会更改以显示错误消息（即，如果您正在输入 Person 查询，并且您输入未来的出生日期，例如，出生日期字段将立即变为红色）。
4.  当用户点击`Run Query`时，应用程序运行第二次验证；需要第二次验证通过才能运行涉及多个字段的验证检查。如果此验证检查通过，并且所有字段都有效，则发送查询；否则，将提示用户修复任何剩余的错误。

### 我当前的验证/错误报告策略

目前，我正在使用以域为中心的验证，但整体设计对我来说似乎很混乱，而且可能有点过度设计。当前设计的简要概述：

**域层**：每个查询我有一个类。每个查询类都包含一组`IQueryField`对象，这些对象保存用户输入的值。每个查询类都实现一个通用`IQueryMessage`接口，该接口定义（除其他外）一个`Validate`方法。调用此方法以强制执行消息级验证规则（即必须同时检查多个字段状态的规则）。该`IQueryField`接口还定义了一个“Valdate”方法（除其他外）。这是为了支持每个字段的验证规则。

**每字段验证**：为了处理每字段验证和错误报告，数据输入代码将每个输入控件绑定到一个`IQueryField`; 每当用户更改控件的值时，它都会调用相应`IQueryField`的 's`Validate`方法，该方法反过来用`Notification`在用户输入的值中检测到的任何错误填充一个对象（此时只是一个字符串的集合）。然后，用户界面代码检查`Notification`对象并更改用户控件的外观以指示错误情况（如有必要）。

**消息级验证**：当用户尝试发送查询时，应用程序调用与数据输入表单关联`Validate`的实例上的方法`IQueryMessage`（此时，数据绑定代码还确保所有消息的字段都已从输入中填充表单上的控件，并且每个字段的验证代码已运行）。如果有任何验证错误，用户界面会在表单顶部显示它们。如果没有错误，则关闭数据输入表单，并将查询序列化并通过网络发送。

### 这里有什么问题吗？

我觉得这里有些东西不“正确”。我对当前的设计有一些问题：

1.  我希望域级验证代码指示任何错误字段的名称，但我不想将 UI 标签标题硬编码到域类中。我想到的一种可能性是让域级`Validate`方法生成带有字段占位符的消息，例如`"%s cannot be in the future"`，并让 UI 代码使用正确的标签填充占位符。

2.  `IQueryMessage`和`IQueryField`接口都有一个名为 的方法`Validate`。我认为这应该被提取到一个单独的界面中，（`IValidatable`也许），但我想知道我是否让事情变得不必要的复杂。

3.  我使用的是 VB6，所以我不能在我的类中使用继承（VB6 支持类但不支持继承）。我只能定义和实现接口。正因为如此，并且由于我当前接口的设计方式，我在我的实现类中复制了很多样板代码。我正在考虑用一种控制反转的方法来解决这个问题。例如，我正在考虑定义一个具体的`QueryField`类，它可以用一组`IValidationRule`实例来初始化，这些实例定义了要使用的验证规则，然后该`QueryField.Validate()`方法将只收集执行每个规则的结果。这样，验证规则可以针对每个字段进行定制，但`QueryField`该类可以处理所有常见的字段相关内容（字段名称、字段长度、必需/非必需检查等）。

### 我该如何改进？

我对改进当前设计的任何重构建议和提示感兴趣。此外，我不必拘泥于以域为中心的验证；欢迎提出其他建议。使用以域为中心的验证背后的主要动机是不断增加封装，并允许在非 GUI 环境中使用查询消息和字段对象，而无需重写所有验证逻辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T15:57:01.487

1.  When you initialize a QueryField object, pass a label to it from the GUI. Then it's the UI that is responsible for setting the label name which seems reasonable to me.

2.  I don't think this is necessary.

3.  What you are describing doesn't really sound like IoC but rather just plain old composition. Since you can't even use inheritance this improvement seems to make sense. Generally you want to prefer composition to inheritance anyways. However if you are almost done with the work then I wouldn't bother refactoring this late in the game.

# latex - 将表格和其他元素居中的最简单方法是什么？

> ID：523292
> 
> 赞同：1
> 
> 时间：2009-02-07T06:22:20.583
> 
> 标签：latex

使事物正确居中的最佳方法是什么？一旦我开始摆弄桌子，事情就会开始向左或向右移动，破坏平衡。怎样才能使一切始终居中？

现在这将导致桌子被弄乱，并且右边缘离开屏幕。我能做些什么？

这是大部分代码，我删掉了很多无用的功能，因为它们几乎都一样。它用于为学校制作用例，因为我们必须为一个项目做大约 40 个。

```
\documentclass[10pt, a4paper]{article}
\usepackage{booktabs}
\begin{document}
\newcommand{\UCStart}[2]{
    \newpage
    \subsection[UC.#1]{UC.#1}
    \begin{tabular}{|l|m{4in}|c|}
        \hline
        \textbf{UC.#1}
        & \textbf{#2} 
        & \textbf{Traceability} \\ \hline
}

\newcommand{\UCDesc}[2]{
    \textbf{Description} 
    & #1
    & #2 \\ \hline
}

\newcommand{\UCActors}[2]{
    \textbf{External Actors}
    & #1
    & #2 \\ \hline
}

% Snip... 40 odd more functions %

\newcommand{\UCEnd}{
    \end{tabular}
}

\begin{table}[!ht]
    \setlength{\extrarowheight}{2pt}
    % UC 1
    \UCStart{01}{Administrator Starts Server}
    \UCDesc{This describes the process of the administrator starting the server}{\space}
    \UCActors{Administrator}{\space}
    \UCRelated{UC.02}{\space}
    \UCPre{Server is not running}{\space}
    \UCTrigger{Administrator wants to start the server}{\space}
    \UCSeq{
        \begin{enumerate}
            \item Administrator boots up hardware
            \item Administrator starts Administrator console
            \item Administrator logins into Administrator account with the corresponding password
            \item Administrator clicks start
        \end{enumerate}
    }{\space}
    \UCPost{Conditions that must be true, in order for the use case to finish}{\space}
    \UCAltSeq{
        \textbf{Alternative Use Case 01} \newline
        \begin{itemize}
            \item UC.01.ALT.01
            \item If administrator fails authentication in step 3
            \begin{enumerate}
                \item Notify administrator of failed authentication
            \end{enumerate}
        \end{itemize}
    }{\space}
    \UCNonFunc{ ??? }{\space}
    \UCComments{ Comments Go Here }{\space}
    \UCEnd

        \end{table}
    \end{document} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T07:57:13.233

由于几个错误，我无法编译您的示例，而且我不确定您所说的“使事物正确居中的最佳方法”是什么意思。作为一种水晶球式的答案，这就是你要找的吗？

```
 \documentclass[10pt,a4paper]{article}
 \usepackage{array}
 \begin{document}
 \begin{table}
 \centering
 \begin{tabular}{
     | >{\centering\arraybackslash }p{4cm} |
       >{\centering\arraybackslash }p{6cm} |
   }
   \hline
   some centred text in cells & some more centred text in cells \\
   \hline
   centred text in cells & more centred text in cells \\
   \hline
 \end{tabular}
 \end{table}
 \end{document} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T01:21:46.267

It is difficult to see what the problem is when we can't compile your example.

Looking through the code you provided, a table may not actually be appropriate in this situation. Instead, you might try something like the following:

```
\documentclass[10pt,a4paper]{article}
\begin{document}

\subsection{Administrator Starts Server}
\paragraph{Description:} This describes the process of the adminsitrator starting the server.

\paragraph{Actors:} Administrator

\paragraph{Preconditions:} Server is not running.

\paragraph{Sequence:}
\begin{enumerate}
  \item Administrator boots up hardware
  \item Administrator starts Administrator console
  \item Administrator logins into Administrator account with the corresponding password
  \item Administrator clicks start
\end{enumerate}

\end{document} 
```

In the example you provided, I don't see that you ever put any text in the "Traceability" column. To mimic this column, you could either use `\marginpar{my text}` to put text in the margin, or you could use `blahblah\hfill{}my text` to right-align text on the same line as "blahblah". If you want the traceability text to be right-aligned and on its own line, use `\begin{flushright} my text \end{flushright}`.

If this doesn't help solve your problem, please provide us with a minimal example that compiles and demonstrates the problem.

# language-agnostic - 语义差异实用程序

> ID：523307
> 
> 赞同：108
> 
> 时间：2009-02-07T06:37:08.387
> 
> 标签：language-agnostic, diff, semantics

我试图找到一些语义差异/合并实用程序的好例子。比较源代码文件的传统范例是通过比较行和字符来工作的。但是在比较文件时是否有任何实用程序（适用于任何语言）实际考虑代码*结构*？

例如，现有的差异程序将报告“在第 125 行的字符 2 处发现差异。文件 x 包含 void，其中文件 y 包含布尔值”。一个专门的工具应该能够报告“方法的返回类型 doSomething() 从 void 更改为 bool”。

我认为这种类型的语义信息实际上是用户在比较代码时所寻找的，并且应该是下一代编程工具的目标。可用工具中有这方面的例子吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-04-23T07:15:12.793

我们开发了一种能够精确处理这种情况的工具。检查[http://www.semanticmerge.com](http://www.semanticmerge.com)

它基于代码结构进行合并（和差异），而不是使用基于文本的算法，这基本上允许您处理以下情况，涉及强重构。它还能够呈现差异和合并冲突，如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/RTRi1.png)

并且不会对被移动的文本块感到困惑，因为它首先解析，它能够基于每个方法（实际上是每个元素）显示冲突。像以前这样的案例甚至不需要手动解决冲突。

![在此处输入图像描述](https://i.stack.imgur.com/7EVcF.png)

它是一个语言感知的合并工具，最终能够回答这个 SO 问题真是太好了 :-)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-03-07T08:55:45.993

[Eclipse](https://www.eclipse.org)早就有了这个特性。它被称为“结构比较”，非常好。这是 Java 的示例屏幕截图，然后是 XML 文件的示例屏幕截图：

（注意上方窗格中方法上的减号和加号图标。）

![Eclipse 的 Java 结构比较器](https://i.stack.imgur.com/WDk3m.png) ![Eclipse 的 XML 结构比较器](https://i.stack.imgur.com/2Jxlj.png)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-06-17T09:53:09.957

要做好“语义比较”，需要比较语言的语法树，并考虑符号的含义。一个非常好的语义差异会理解语言语义，并意识到一个代码块在功能上与另一个代码块是等价的。走到这一步需要一个定理证明器，虽然它非常可爱，但目前对于真正的工具来说并不实用。

一个可行的近似方法是简单地比较语法树，并根据插入、删除、移动或更改的结构报告更改。更接近“语义比较”，可以报告标识符何时在代码块中一致更改。

请参阅我们的[http://www.semanticdesigns.com/Products/SmartDifferencer/index.html](http://www.semanticdesigns.com/Products/SmartDifferencer/index.html) ，了解可与多种语言一起使用的基于语法树的比较引擎，该引擎执行上述近似。

编辑 2010 年 1 月：可用于 C++、C#、Java、PHP 和 COBOL 的版本。该网站显示了其中大多数的具体示例。

编辑 2010 年 5 月：添加了 Python 和 JavaScript。

编辑 2010 年 10 月：添加了 EGL。

编辑 2010 年 11 月：添加了 VB6、VBScript、VB.net

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-07T08:27:15.937

你正在摸索的是一个“树差异”。事实证明，这比简单的面向行的文本差异更难做好，这实际上只是两个平面序列的比较。

“[一种细粒度的 XML 结构比较方法](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.106.415&rep=rep1&type=pdf)”总结如下：

> 我们的理论研究以及我们的实验评估表明，所提出的方法相对于现有替代方案产生了改进的结构相似性结果，同时具有相同的时间复杂度**(O(N^2))**

（强调我的）

事实上，如果您正在寻找更多关于树差分的示例，我建议您关注 XML，因为这一直在推动该领域的实际发展。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-02-09T16:55:23.230

我自己的项目的无耻插件：

HTML Tree Diff 对 xml 和 html 文档进行结构感知比较，用 python 编写。

[http://pypi.python.org/pypi/html-tree-diff/0.1.0](http://pypi.python.org/pypi/html-tree-diff/0.1.0)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-07T07:41:43.003

对此的解决方案将基于每种语言。也就是说，除非它的设计采用插件架构，将大量的代码解析延迟到树中，并将语义比较与特定语言的插件进行比较，否则将很难支持多种语言。您对拥有这样的工具感兴趣的语言是什么。就我个人而言，我喜欢 C# 的一个。

对于 C#，Reflector 有一个程序集差异插件，但它只对 IL 而非 C# 进行差异。

[您可以在此处](http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=reflectoraddins&DownloadId=7135&FileTime=128165526958930000&Build=14730)下载 diff 插件[zip] 或在[此处](http://reflectoraddins.codeplex.com/)访问 codeplex 站点上的项目。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-01-19T21:09:01.037

一家名为 Zynamics 的公司提供了一种二进制级语义差异工具。它使用一种称为 REIL 的元汇编语言对二进制的 2 个版本进行图论分析，并生成一个颜色编码的图来说明它们之间的差异。我不确定价格，但我怀疑它是免费的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-06-30T20:14:30.990

[http://prettydiff.com/](http://prettydiff.com/)

Pretty Diff 缩小每个输入以删除注释和不必要的空白，然后在 diff 算法之前美化代码。无论如何，我想不出比这更多的代码语义。而且，它编写了 JavaScript，因此它直接在浏览器中运行。

# hook - ExpressionEngine：使用哪些钩子在保存和编辑时重写字段内容？

> ID：523309
> 
> 赞同：0
> 
> 时间：2009-02-07T06:40:41.123
> 
> 标签：hook, expressionengine

ExpressionEngine 论坛中的这个查询不太幸运，而且它对时间很敏感，所以我想我会看看 Stack Overflow 周围是否有任何 EE 瘾君子。

我正在开发一个 EE 扩展，我需要知道在第一次保存自定义字段的内容时使用什么钩子来解析它，在显示以进行编辑之前对其进行解析，并在再次保存编辑的内容时对其进行解析。我的问题是我是 EE 扩展开发的新手，我无法确定我需要使用长长的钩子列表中的哪个。我能说的最好的：

*   `submit_new_entry_end`是首次创建条目时我需要绑定的内容
*   `publish_form_entry_data`是在用户编辑条目之前我需要绑定的解析

而且我必须忽略让我在将条目数据保存回数据库之前编辑条目数据的钩子。有人有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-28T16:28:11.113

经过反复试验，我终于回答了我自己的问题。为了在保存时解析自定义字段的内容并在显示条目之前重新解析它们，您需要的钩子是：

*   `submit_new_entry_start`（每当提交条目时调用；“新”似乎没有意义）
*   `publish_form_entry_data`（我有这个权利）

# javascript - 在 JavaScript 中按顺序触发多个随机超时

> ID：523310
> 
> 赞同：1
> 
> 时间：2009-02-07T06:41:41.123
> 
> 标签：javascript, random, timeout

乍一看（由于标题），我知道这看起来像是“您在发布之前尝试过搜索 Google 吗？”之一。问题，但我似乎无法找到我遇到的具体问题的答案。对不起，如果我是菜鸟....还在学习:)

我需要在 javascript 中模拟暂停，但 setTimeout(function_call, timeout) 函数对我不起作用。原因是......当调用该 setTimeout 函数时，它会异步调用该函数。

一点背景知识：
我正在尝试模拟以随机时间间隔输入 div 的文本。我希望它看起来好像一个人在用户查看页面时实际上正在输入一条消息。由于超时是一个随机间隔并且函数调用是异步进行的，因此文本最终会以随机顺序打印。

这是我到目前为止的一个片段：

```
typeString: function(s)
{
    for(var i=0;i<s.length;i++)
    {                      
        var c = s.charAt(i);
        var temp = setTimeout("MessageType.typeChar('" + c + "')", this.genRandomTime());
    }
} 
```

在此先感谢您的帮助。

CJAM

更新：通过将计时器延迟添加到变量中，它使我能够抵消异步调用的 timeOut。谢谢大家的快速回复。这是更新的代码：

```
typeString: function(s)
{
    var delay = 0;

    for(var i=0;i<s.length;i++)
    {                     
        var c = s.charAt(i);
        setTimeout("GoogleTyper.typeChar('"+c+"')", delay += this.genRandomTime());
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T06:47:07.180

您是否尝试过累积设置超时？在循环之外粘贴一个变量并将其初始化为 0。我们暂时称它为超时。在循环的每次迭代开始时向此变量添加随机时间量，并使其超时工作。这样，您可以确保按顺序调用函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T06:48:08.083

您的问题是您使用的所有时间都从现在开始延迟 - 下一个计时器需要在前一个计时器之后触发。只需将先前的计时器延迟添加到新计时器即可。

```
typeString: function(s)
{
    var delay = 0;
    for(var i=0;i<s.length;i++)
    {                      
        var c = s.charAt(i);
        delay = delay + this.genRandomTime();
        var temp = setTimeout("MessageType.typeChar('" + c + "')", delay );
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T06:49:47.567

不是将要显示的字符传递给每个计时器事件，而是让每个事件处理程序从队列（数组，列表中）中获取下一个字符，以便保持顺序。

# javascript - $.post() 没有时间运行？

> ID：523312
> 
> 赞同：3
> 
> 时间：2009-02-07T06:42:29.640
> 
> 标签：javascript, jquery, ajax, post

`return false;`我试图在提交表单之前将数据从表单发送到外部脚本，但除非我在表单本身上，否则我似乎无法让数据到达外部脚本。

```
$(document).ready(function () {

  // Handle Form-Submission
  $("#mainForm").submit(function () {

    // Reset Error Array
    errors = new Array();

    /* Validation Code Removed - Not Relevant */        

    // Check if errors exist
    if (errors.length > 0) {
      return false;
    } else {
      $("div.errors").html("");
      $.post("post.php",{
        "First Name": name_first.val(),
        "Last Name": name_last.val(),
        "Home State": home_state.val(),
        "Primary Email": email_primary.val()
      });
    }
    return false; /* Remove this line, and the $.post won't work. */
  });
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-07T06:51:11.180

我今天遇到了完全相同的问题。正如 Marc 所说，这是因为 ajax 调用是异步的。最简单的解决方法是使其同步。

在像这样的任何 ajax 调用之前使用 .ajaxSetup() ：

```
$.ajaxSetup({async: false}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-24T07:00:42.667

**发送到两个端点**

我会尝试这样的事情而不是使用`async: true`. 虽然它明显更复杂，但它不会冻结界面。：

```
 $(document).ready(function(){           
  // Handle Form-Submission
 $("#mainForm").submit(function(e){  
    e.preventDefault();
    var $form = $(this);

    if($form.data('submitting')) return; // Avoid double submissions
    $(':submit').attr('disabled','disabled'); // Disable the submit button

    // Reset Error Array
    errors = new Array();

    /* Validation Code Removed - Not Relevant */        

    // Check if errors exist
    if (errors.length > 0) {;
      $(':submit').removeAttr('disabled'); // Enable the submit button
      return false;
    } else {
      $("div.errors").html("");
      $form.data('submitting',true); // Flag that a submission has started
      $.post("post.php",{
        "First Name":name_first.val(),
        "Last Name":name_last.val(),
        "Home State":home_state.val(),
        "Primary Email":email_primary.val()},
        function(){
          // remove our special handler and submit normally
          $form.unbind('submit').submit();
        }
      );
    }
  });
}); 
```

**原始答案**

看来你的挂断是你想在`$.post`启用 JavaScript 的情况下使用，但在禁用 JavaScript 的情况下让表单正常运行。

但是，由于如果*禁用**JavaScript，您的 JavaScript*将不会运行，您不必担心更改函数中的行为。*`submit`*

 *您可以留下您的`return false;`陈述，*或使用*

```
$("#mainForm").submit(function(e){  
  // all your existing code

  e.preventDefault();
} 
```

这将使表单无法正常提交，而是在*启用*`$.post`JavaScript 时使用您的方法。如果它被*禁用*，它将正常提交。

 **`preventDefault``return false`如果您希望事件冒泡正常继续，但保持默认浏览器操作不继续，则首选。`return false`相当于调用`e.preventDefault(); e.stopPropagation();`

# .net - 如何让 Reflection.Emit 程序集访问生成程序集中的内部成员？

> ID：523329
> 
> 赞同：3
> 
> 时间：2009-02-07T06:51:08.623
> 
> 标签：.net, reflection.emit

对于我的一个项目，我需要在运行时生成一些类，我认为使用 Reflection.Emit 会相当简单，但是当我运行一些调用方法的生成代码时，我得到了 MemberAccessExceptions标记在发电机组件内部。有没有办法告诉运行时动态程序集应该能够直接访问我自己的代码？我真的不想将这些成员中的任何一个公开暴露给我图书馆的消费者。

* * *

关于 InternalsVisibleTo，我不确定在动态生成的程序集的情况下如何使用它。这甚至可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T14:13:46.700

`InternalsVisibleTo`通过向其他人打开程序集来工作。因此，如果要使用生成的类型中的程序集，则必须在for`Foo`中指定生成的程序集的名称。`AssemblyInfo.cs``Foo`

如果您使用`AssemblyBuilder`该类发出一个新程序集，您可以指定生成程序集的名称。此名称必须与 assembly 中用于`InternalsVisibleTo`属性的名称相匹配`Foo`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T09:59:05.747

我认为生成程序集中的成员被标记为内部的事实背后是有原因的。

您可以在公共方法中公开必要的功能，或者只剩下两个选择：InternalsVisibleTo（如评论部分中提到的@tuinstoel）或反射（使用反射，您可以访问不同程序集中的非公共成员）。

# latex - LaTeX 中的可折叠 minibox 环境

> ID：523331
> 
> 赞同：1
> 
> 时间：2009-02-07T06:52:21.443
> 
> 标签：latex

我正在尝试学习 LaTeX，因为否则，我的教授将几乎无法阅读我的家庭作业。我遇到了一些我想做但似乎做不到的事情，即。我搜索了谷歌（可能关键字集很差），但没有找到解决方案。

具体情况如下：我想在一个盒子里放一个ams flalign环境，并排有多个这样的环境。我已经使用 minipage 实现了这一点，但 minipage 要求宽度。我想使用 flalign 环境适合的最小宽度。我意识到我可以将宽度设置为 0pt，但我不禁想知道是否有打算这样做的东西。

另外，我应该使用 minipage 吗？还有其他我不知道的命令吗？

感谢您的回复。

编辑：

试图澄清我想要做什么。我想要标准的、已知的、给定的等式，并且左边很短。在这些的右边，我想要相关的推导方程（也许还有它们的推导。更右边，我想要插入实际的计算。

我觉得我想要的是一个有 3 列的表格环境，但我认为我不能将方程式环境放在表格环境中。

这看起来就像我渲染它时想要的。

```
\begin{minipage}[t]{0pt}
\begin{flalign*}
\sigma & = F / A&\\
A & = \pi \left(d/2\right)^2&\\
\epsilon &= \frac{\sigma}{E}&\\
\epsilon_{trans} &= - \nu \epsilon_{longi}& \\
\epsilon &= \frac{\Delta l}{l}&\\
l &= \left( \epsilon + 1 \right) \times l_0&
\end{flalign*}
\end{minipage}
\hspace*{0pt}
\begin{minipage}[t]{0pt}
\begin{flalign*}
d & = \unit[1.8]{mm} = \unit[1.8\e{-3}]{m} &\\
F_T & = \unit[1300]{N}&\\
E_{\text{stainless steel}}&=\unit[193\e9]{Pa}&\\
l_0 & = \unit[.2530]{m}&\\
\nu & = .33&\\
\sigma &= \frac{\unit[1300]{N}}{\pi \times \unit[3.24\e{-6}]{m^2}}&&= \boxed{\unit[127.7\e6]{Pa}}\\
&&&=\boxed{\unit[18,524]{psi}}\\
\epsilon &= \frac{\unit[127.7\e6]{Pa}}{\unit[193\e9]{Pa}} &&= \boxed{6.6\e{-2}}\\
\epsilon_{trans} &= -.33 \times 6.6\e{-2} &&=\boxed{-2.2\e{-2}}\\
l &= \left( 6.6\e{-2} + 1 \right) \times \unit[.2530]{m} &&= \boxed{\unit[.2797]{m}}
\end{flalign*}
\end{minipage} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T17:14:52.327

我不确定你想要达到什么目的，但 amsmath 的 align* 环境可能会做你想做的事（不诉诸 minipages）：

```
\documentclass{article}

\usepackage{amsmath}

\begin{document}

\begin{align*}
x&=y       & X&=Y       & a&=b+c   & mn&=ab\\
x’&amp;=y’     & X’&amp;=Y’     & a’&amp;=b    & m'n'&=a'b'\\
x+x’&amp;=y+y’ & X+X’&amp;=Y+Y’ & a’b&=c’b & m'&=a'
\end{align*}

\end{document} 
```

至于你的 minipage 问题：它需要一个宽度，因为 TeX 需要知道在哪里换行。如果您不想使用换行算法，您可能不想要 minipage。

编辑：

如果您想要多列并且不关心列中材料的垂直对齐，则可以使用`multicols`包轻松获得：

```
\documentclass{article}

\usepackage{multicols}
\usepackage{lipsum}% just for some example text

\begin{document}

% The * version allows the columns to have ragged bottoms.
% The argument 2 is the number of columns.
\begin{multicols*}{2}
\lipsum[1]% one paragraph of Lorem ipsum.. filler text
\vfil% fills the remainder of the column with white space
\columnbreak% force a column break
\lipsum[2]% another paragraph of text
\vfil% fills the remainder of the column with white space
\end{multicols*}

\end{document} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T08:00:37.827

您可能会在 empheq 和 mathtools 包中找到对您有帮助的东西。empheq 允许您将方程式装箱，并且数学工具应该提供一些有用的环境来水平堆叠它们。

# ruby-on-rails - Kdevelop 作为 Rails IDE

> ID：523340
> 
> 赞同：4
> 
> 时间：2009-02-07T06:59:15.877
> 
> 标签：ruby-on-rails, kdevelop

当我使用 Linux 时，我想将 Kdevelep 用作 Ruby on Rails IDE。如何设置 Kdevelop 以启用此功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-02T17:35:15.617

你可以使用 Kdevelop 或 Kate，虽然我不知道有一个庞大的社区支持这些编辑器。如果您在 Linux 上，最好查看 VIM，它是 Ruby/Rails 的第二受欢迎的编辑器（Textmate 排名第一）。

关于如何在以下位置设置 VIM 有一篇非常好的文章：

[http://blog.adamlowe.com/2009/12/vim-destroys-all-other-rails-editors.html](http://blog.adamlowe.com/2009/12/vim-destroys-all-other-rails-editors.html)

如果您将 VIM 与所有各种 tpope 和 NerdTree 插件一起使用，您将几乎可以设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-12T09:08:22.217

“Alexander Dymo 对实验性 Ruby 语言插件做了一些工作，最终使它对他自己有用，希望对其他 Ruby on Rails 开发人员有用。” [http://dot.kde.org/2010/03/08/kate-kdevelop-and-okteta-developers-meet-berlin](http://dot.kde.org/2010/03/08/kate-kdevelop-and-okteta-developers-meet-berlin)

[http://adymo.blogspot.com/2010/03/ruby-language-support-in-kdevelop4.html](http://adymo.blogspot.com/2010/03/ruby-language-support-in-kdevelop4.html) repo 在：gitorious.org 然后 /~adymo/kdevelop/adymo-kdevplatform

# asp.net-mvc - 如何开始使用 ASP.net MVC？

> ID：523343
> 
> 赞同：3
> 
> 时间：2009-02-07T06:59:50.867
> 
> 标签：asp.net-mvc, download

我在 PHP、JSP/servelts 和经典 ASP 方面有经验，我正在尝试学习一些关于 ASP.net MVC 的知识。

我发现 www.asp.net 是开始的网站。

但我有点困惑。

我应该下载哪些东西才能开始？最好的 IDE 是什么？我可以使用 Microsoft 表达网络吗？我应该安装什么其他东西？ASP.net Ajax？等等等等……

我应该在开始使用 asp.net MVC 之前学习 asp.net 还是可以在学习 asp.net MVC 的同时学习 asp.net？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-07T07:05:49.373

[http://www.asp.net/mvc](http://www.asp.net/mvc)是您要坚持的网站的一部分。您无需担心 ASP.NET Webforms 或 ASP.NET Ajax（仅适用于 Webforms，MVC 在主 MVC 下载中包含自己的 Ajax 内容，包括 jQuery）。该站点的 MVC 部分将为您提供所需的所有入门信息。

Visual Web Developer Express 2008 是入门的最佳 IDE。安装它（以及 MVC 的东西和要求）的一种简单方法是[Web Platform Installer](http://www.microsoft.com/web/channel/products/WebPlatformInstaller.aspx)。

开始之后，请阅读[Scott Guthrie 的](http://weblogs.asp.net/scottgu/)MVC 帖子并查看[Phil Haacked 的博客](http://haacked.com)和[Steven Walther 的博客](http://stephenwalther.com/blog/default.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T07:06:57.220

我对 ASP.NET MVC 没有太多想法，但要能够使用它，您需要 .NET 3.0 或更高版本的 .NET 框架（Visual Studio 2008）。[http://www.microsoft.com/downloads/details.aspx?FamilyID=f4e4ee26-4bc5-41ed-80c9-261336b2a5b6&displaylang=en#Requirements](http://www.microsoft.com/downloads/details.aspx?FamilyID=f4e4ee26-4bc5-41ed-80c9-261336b2a5b6&displaylang=en#Requirements)

“我应该在开始使用 asp.net MVC 之前学习 asp.net，还是可以在学习 asp.net MVC 的同时学习 asp.net？” - 我认为在研究 MVC 模式之前，你应该对 ASP.NET 有一些基本的了解。

ASP.NET MVC 有用的链接：

[http://asp.net/mvc](http://asp.net/mvc)

[http://www.asp.net/learn/mvc/](http://www.asp.net/learn/mvc/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T07:05:22.057

您需要一个版本的 Visual Studio 2008 IDE、.NET Framework 3.5 和 ASP.NET MVC Release Candidate。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T07:05:41.137

有大量的截屏视频。Scott Hanselman 做了一些很棒的事情，Stephen Walther 有一个完整的博客来介绍这个框架。

ASP.NET MVC 非常灵活。您可以使用您选择的任何 Javascript 库。jQuery 是一个不错的选择，并且现在与新项目捆绑在一起。

有一些概念可以延续到 ASP.NET MVC（绑定、用户控件）中，但您应该能够独立地了解它们。我认为与 Web 窗体相比，ASP.NET MVC 应该更容易让您简单地“跳入”。

# c# - 如何在 ASP.NET 中使用 DataList 分别显示组数据？

> ID：523345
> 
> 赞同：2
> 
> 时间：2009-02-07T07:00:36.590
> 
> 标签：c#, asp.net, sql, datalist

我有一个包含以下数据的 sql 表，

```
Id   City      Country 
---  ------    ------------
1    Delhi     India
2    New York  United States
3    Karachi   Pakistan
4    Mumbai    India
5    Lahore    Pakistan
6    Kanpur    India
7    Delhi     India
8    Mumbai    India 
```

现在，我想在我的网络应用程序中显示上述数据，如下所示；

```
India
Delhi (2)    Mumbai (2)    Kanpur (1)    

United States
New York (1)

Pakistan
Karachi (1)    Lahore (1) 
```

请告诉我：

*   将根据需要获取数据的 SQL 查询。我想要城市、国家和计数（所有城市的分组）
*   以及如何以我上面在 ASP.NET C# 中给出的格式显示获取的数据。是否有任何控件可以用来显示我想要的数据。或者我们必须编写任何自定义代码，如果是自定义代码，请告诉我此代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T07:14:07.530

你的 SQL 应该是

```
选择国家、城市、计数（城市）
来自 dbo.location
按国家分组，按国家按城市排序

```

然后使用 datarepeter 来显示你的数据。按照这个[链接](http://www.eggheadcafe.com/tutorials/aspnet/d89d1d96-03f1-4784-bbb2-a3db1af393f5/aspnet-datalist-and-data.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T07:21:24.663

您可以使用 DataSet，规范化您的数据库，将两个表读入其中，然后使用两个嵌套的 DataRepeater 显示它，就像两个 for 循环一样。

# jquery - jQuery 动画留下了不必要的样式

> ID：523349
> 
> 赞同：3
> 
> 时间：2009-02-07T07:03:13.403
> 
> 标签：jquery

当我运行以下 jQuery 动画序列时：

```
$('#task').animate({ backgroundColor: fadeColor }, 50)
          .animate({ opacity: 1.0 }, 1000)
          .animate({ backgroundColor: originalBG }, 1000); 
```

完成后，它会在我的表格行上留下不需要的样式（下）

```
<tr id="task29" onclick="TaskEdit('29');" style="background-color: rgb(255, 255, 255); opacity: 1;"> 
```

这些样式与我的 CSS 文件中定义的样式（特别是一些悬停样式）相混淆。有没有人建议删除它们。我正在使用 jQuery 1.3.1。我试过添加一个

```
.attr('style', ''); 
```

到链的末端，但这没有用。还有其他想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T07:11:56.133

[http://docs.jquery.com/UI/Effects/addClass](http://docs.jquery.com/UI/Effects/addClass)

显然 addClass 方法可能需要一段时间。为您的动画制作课程并尝试一下。如果需要，您应该能够删除类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T07:54:51.163

就像 Stuard 所说，使用类似乎是个好主意。

但是如果你想做你所说的：（当然是个坏主意......）

```
$('#task').animate({ backgroundColor: fadeColor }, 50)
      .animate({ opacity: 1.0 }, 1000)
      .animate({ backgroundColor: originalBG }, 1000, function(){
         $(this).removeAttr('style');
      }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T08:38:41.823

对于您想做的事情，我认为使用 jquery UI 和脉动/突出效果更合适:)

# python - Python + Django 页面重定向

> ID：523356
> 
> 赞同：160
> 
> 时间：2009-02-07T07:08:03.673
> 
> 标签：python, django, redirect, location

如何在 Django 中完成一个简单的重定向（例如`cflocation`，在 ColdFusion 中或`header(location:http://)`PHP 中）？

* * *

## 回答 #1

> 赞同：253
> 
> 时间：2009-02-07T07:14:37.563

这很简单：

```
from django.http import HttpResponseRedirect

def myview(request):
    ...
    return HttpResponseRedirect("/path/") 
```

[官方 Django 文档](https://docs.djangoproject.com/en/1.4/ref/request-response/#django.http.HttpResponseRedirect)中的更多信息

**更新：Django 1.0**

现在使用 .django 显然有更好的方法来做到这一点`generic views`。

例子 -

```
from django.views.generic.simple import redirect_to

urlpatterns = patterns('',   
    (r'^one/$', redirect_to, {'url': '/another/'}),

    #etc...
) 
```

[通用视图文档](https://docs.djangoproject.com/en/1.4/ref/generic-views/#django-views-generic-simple-redirect-to)中有更多内容。信用卡 - [Carles Barrobés](https://stackoverflow.com/users/166761/carles-barrobes)。

**更新#2：Django 1.3+**

在 Django 1.5中， *redirect_to*不再存在，已被[RedirectView](https://docs.djangoproject.com/en/1.5/ref/class-based-views/base/#redirectview)取代。[归功于](https://stackoverflow.com/users/221917/yonatan)Yonatan

```
from django.views.generic import RedirectView

urlpatterns = patterns('',
    (r'^one/$', RedirectView.as_view(url='/another/')),
) 
```

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2010-10-01T17:31:30.680

根据您想要的（即，如果您不想进行任何额外的预处理），使用 Django 的`redirect_to`通用视图更简单：

```
from django.views.generic.simple import redirect_to

urlpatterns = patterns('',
    (r'^one/$', redirect_to, {'url': '/another/'}),

    #etc...
) 
```

有关更高级的示例，请参阅[文档](https://docs.djangoproject.com/en/1.4/ref/generic-views/#django-views-generic-simple-redirect-to)。

* * *

对于 Django 1.3+ 使用：

```
from django.views.generic import RedirectView

urlpatterns = patterns('',
    (r'^one/$', RedirectView.as_view(url='/another/')),
) 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2010-01-17T08:07:32.017

实际上，有一种比查看每个重定向更简单的方法 - 您可以*直接*在以下位置进行操作`urls.py`：

```
from django.http import HttpResponsePermanentRedirect

urlpatterns = patterns(
    '',
    # ...normal patterns here...
    (r'^bad-old-link\.php',
     lambda request: HttpResponsePermanentRedirect('/nice-link')),
) 
```

[目标可以是可调用的，也可以是字符串](http://docs.djangoproject.com/en/1.0/topics/http/urls/#passing-callable-objects-instead-of-strings)，这就是我在这里使用的。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2010-09-05T11:09:03.537

从 Django 1.1 开始，您还可以使用更简单的[重定向](http://docs.djangoproject.com/en/dev/topics/http/shortcuts/#redirect)快捷方式：

```
from django.shortcuts import redirect

def myview(request):
    return redirect('/path') 
```

它还需要一个可选的 Permanent=True 关键字参数。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2014-03-10T13:02:02.470

如果要重定向整个子文件夹，则 RedirectView 中的`url`参数[实际上是 interpolated](https://docs.djangoproject.com/en/1.8/ref/class-based-views/base/#redirectview)，因此您可以在以下位置执行以下操作`urls.py`：

```
from django.conf.urls.defaults import url
from django.views.generic import RedirectView

urlpatterns = [
    url(r'^old/(?P<path>.*)$', RedirectView.as_view(url='/new_path/%(path)s')),
] 
```

* * *

您捕获的`?P<path>`内容将被送入`RedirectView`. 然后，这个捕获的变量将在`url`您提供的参数中被替换，`/new_path/yay/mypath`如果您的原始路径是`/old/yay/mypath`.

`….as_view(url='…', query_string=True)`如果您还想复制查询字符串，也可以这样做。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2011-09-14T12:55:33.050

使用 Django 1.3 版，基于类的方法是：

```
from django.conf.urls.defaults import patterns, url
from django.views.generic import RedirectView

urlpatterns = patterns('',
    url(r'^some-url/$', RedirectView.as_view(url='/redirect-url/'), name='some_redirect'),
) 
```

此示例位于 urls.py 中

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-11-06T01:18:20.157

谨防。我在开发服务器上做了这个，以后想改变它。

*   [Firefox 5“缓存”301 重定向](https://stackoverflow.com/questions/6980192/firefox-5-caching-301-redirects)

我必须清除我的缓存才能更改它。为了避免将来出现这种令人头疼的问题，我可以像这样临时设置它：

```
from django.views.generic import RedirectView

url(r'^source$', RedirectView.as_view(permanent=False, 
                                      url='/dest/')), 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-02-20T21:19:33.327

您可以在“管理”部分执行此操作。它在文档中进行了解释。

[https://docs.djangoproject.com/en/dev/ref/contrib/redirects/](https://docs.djangoproject.com/en/dev/ref/contrib/redirects/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-07-12T12:45:36.080

page_path = 在 urls.py 中定义

```
def deletePolls(request):
    pollId = deletePool(request.GET['id'])
    return HttpResponseRedirect("/page_path/") 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-06-12T18:23:52.110

这应该适用于大多数版本的 django，我在 1.6.5 中使用它：

```
from django.core.urlresolvers import reverse
from django.http import HttpResponseRedirect
urlpatterns = patterns('',
    ....
    url(r'^(?P<location_id>\d+)/$', lambda x, location_id: HttpResponseRedirect(reverse('dailyreport_location', args=[location_id])), name='location_stats_redirect'),
    ....
) 
```

在此解决方案中，您仍然可以使用 url 模式的名称而不是硬编码的 url。来自 url 的 location_id 参数被传递给 lambda 函数。

# c# - 基于类 Type 创建泛型

> ID：523359
> 
> 赞同：4
> 
> 时间：2009-02-07T07:10:04.420
> 
> 标签：c#, generics

如果我有通用类：

```
public class GenericTest<T> : IGenericTest {...} 
```

我有一个 Type 的实例，我通过反射得到了它，我怎么能用那个 Type 实例化 GenericType？例如：

```
public IGenericTest CreateGenericTestFromType(Type tClass)
{
   return (IGenericTest)(new GenericTest<tClass>());
} 
```

当然，上述方法不会编译，但它说明了我正在尝试做的事情。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-07T07:15:29.620

您需要使用[Type.MakeGenericType](http://msdn.microsoft.com/en-us/library/system.type.makegenerictype.aspx)：

```
public IGenericTest CreateGenericTestFromType(Type tClass)
{
   Type type = typeof(GenericTest<>).MakeGenericType(new Type[] { tClass });
   return (IGenericTest) Activator.CreateInstance(type);
} 
```

# ajax - 直接爬取Ajax.request url ...权限错误

> ID：523360
> 
> 赞同：0
> 
> 时间：2009-02-07T07:10:46.477
> 
> 标签：ajax, url, request, hostname

我需要抓取一个网络板，它使用 ajax 来动态更新/隐藏/显示评论，而无需重新加载相应的帖子。我被这个评论区屏蔽了。

在 Ajax.request 中，使用没有主机名的路径指定 url，如下所示：

```
new Ajax(**'/bbs/comment_db/load.php'**, {
    update       : $('comment_result'), 
    evalScripts  : true, 
    method       : 'post', 
    data         : 'id=work_gallery&no=i7dg&sno='+npage+'&spl='+splno+'&mno='+cmx+'&ksearch='+$('ksearch').value,
    onComplete   : function() {
        $('cmt_spinner').setStyle('display','none');  
        try { 
            $('cpn'+npage).setStyle('fontWeight','bold'); 
            $('cpf'+npage).setStyle('fontWeight','bold');
        } catch(err) {} 
    }
}).request(); 
```

如果我尝试使用完整的主机名访问 url，那么我只会收到消息：“Permission Error”：

```
new Ajax(**'http://host.name.com/bbs/comment_db/load.php'**, {
    update      : $('comment_result'), 
    evalScripts : true, 
    method      : 'post', 
    data        : 'id=work_gallery&no=i7dg&sno='+npage+'&spl='+splno+'&mno='+cmx+'&ksearch='+$('ksearch').value,
    onComplete  : function() {
        $('cmt_spinner').setStyle('display','none');  
        try { 
            $('cpn'+npage).setStyle('fontWeight','bold'); 
            $('cpf'+npage).setStyle('fontWeight','bold');
        } catch(err) {} 
    }
}).request(); 
```

将导致相同的错误。

即使我像这样在网络浏览器中调用实际的 php url，这也是一样的：http: [//host.name.com/bbs/comment_db/load.php](http://host.name.com/bbs/comment_db/load.php) ?'id=work_gallery&..'

我猜想 php 模块被限制为由同一主机中的 url 调用。

抓取这些数据的任何想法？

提前致谢。

——辛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T09:41:35.033

大多数浏览器都禁止跨站点 XMLHttpRequest。如果要爬取不同的站点，则需要在服务器端脚本中进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T09:44:51.173

As mentioned by darin, the XMLHttpRequest Object (which is the essence of Ajax requests) has security restrictions on calling cross-site HTTP requests, I believe its called the "Same Origin Policy for JavaScript".

While there is a working group within the W3C who have proposed new [Access Control for Cross-Site Requests recommendation](http://dev.w3.org/2006/waf/access-control/) the restriction still remains in effect for most mainstream browsers.

I found some information on the [Mozilla Developer Network](https://developer.mozilla.org/En/HTTP_access_control) that may provide a better explanation.

In your case, it appears that you are using the Prototype JavaScript framework, where Ajax.Request still uses the XMLHttpRequest object for its Ajax requests.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T07:59:58.983

```
method:'post' 
```

很可能是您的问题：提供请求的主机可能会拒绝`get`请求，这是您可以从浏览器地址栏中抛出的所有内容。如果发生这种情况，您将需要找到或安装某种能够完成这项工作的脚本工具（perl 将是我的选择，除非您正在运行 Windows，否则您已经拥有它）。

不过，我确实想知道您尝试做的是否合法：通常不鼓励搜索其他网站的评论数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-04T00:54:48.793

我会通过在本地运行一个 PHP 脚本来解决这个问题，该脚本将从外部页面进行爬网。这样 jQuery 就不必进入外部域。

# python - 如何使用 wxPython 布局 3 窗格窗口？

> ID：523363
> 
> 赞同：5
> 
> 时间：2009-02-07T07:12:13.493
> 
> 标签：python, layout, wxpython, elasticlayout

我正在尝试找到一种使用 wxPython 布局 3 窗格窗口的简单方法。

我想在左窗格中有一个树列表，然后有一个分成两部分的右窗格 - 顶部有一个编辑组件，底部有一个网格组件。

类似于以下内容：

```
--------------------------------------
| | |
| | 编辑 |
| 树 | 控制 |
| 控制 | |
| |-------------------------|
| | |
| | 网格 |
| | |
--------------------------------------

```

我希望窗口可以重新调整大小，并让用户能够通过拖动边框来更改窗口中每个组件的（相对）大小。

我认为我需要一些 sizers 和/或 splitter-window 组件的组合，但在文档或网络上找不到这种窗口的一个像样的例子。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T15:50:22.113

这是一个非常简单的布局，使用 wx.aui 和三个面板。我想您可以轻松地对其进行调整以满足您的需求。

欧阳普...

```
import wx
import wx.aui

class MyFrame(wx.Frame):
    def __init__(self, *args, **kwargs):
        wx.Frame.__init__(self, *args, **kwargs)

        self.mgr = wx.aui.AuiManager(self)

        leftpanel = wx.Panel(self, -1, size = (200, 150))
        rightpanel = wx.Panel(self, -1, size = (200, 150))
        bottompanel = wx.Panel(self, -1, size = (200, 150))

        self.mgr.AddPane(leftpanel, wx.aui.AuiPaneInfo().Bottom())
        self.mgr.AddPane(rightpanel, wx.aui.AuiPaneInfo().Left().Layer(1))
        self.mgr.AddPane(bottompanel, wx.aui.AuiPaneInfo().Center().Layer(2))

        self.mgr.Update()

class MyApp(wx.App):
    def OnInit(self):
        frame = MyFrame(None, -1, '07_wxaui.py')
        frame.Show()
        self.SetTopWindow(frame)
        return 1

if __name__ == "__main__":
    app = MyApp(0)
    app.MainLoop() 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-07T09:08:11.593

首先下载[wxGlade](http://wxglade.sourceforge.net/)一个用于 wxPython 的 gui builder（替代[XRCed](http://xrced.sourceforge.net/)，我更喜欢 wxGlade）。

然后你必须决定是要使用[GridSizer](http://www.wxpython.org/docs/api/wx.GridSizer-class.html)还是[Splitter](http://www.wxpython.org/docs/api/wx.SplitterWindow-class.html)，你就完成了。您可以在下面找到两者（在 Tree 和右侧之间是 GridSizer -> 自动调整大小）。在 Edit 和 GridCtrl 之间是一个 Sizer（手动调整大小）。

问候。

一分钟工作，无需输入任何代码：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
# generated by wxGlade 0.6.3 on Sat Feb 07 10:02:31 2009

import wx
import wx.grid

# begin wxGlade: extracode
# end wxGlade

class MyDialog(wx.Dialog):
    def __init__(self, *args, **kwds):
        # begin wxGlade: MyDialog.__init__
        kwds["style"] = wx.DEFAULT_DIALOG_STYLE|wx.RESIZE_BORDER|wx.THICK_FRAME
        wx.Dialog.__init__(self, *args, **kwds)
        self.window_1 = wx.SplitterWindow(self, -1, style=wx.SP_3D|wx.SP_BORDER)
        self.tree_ctrl_1 = wx.TreeCtrl(self, -1, style=wx.TR_HAS_BUTTONS|wx.TR_LINES_AT_ROOT|wx.TR_DEFAULT_STYLE|wx.SUNKEN_BORDER)
        self.text_ctrl_1 = wx.TextCtrl(self.window_1, -1, "This is the Edit", style=wx.TE_MULTILINE)
        self.grid_1 = wx.grid.Grid(self.window_1, -1, size=(1, 1))

        self.__set_properties()
        self.__do_layout()
        # end wxGlade

    def __set_properties(self):
        # begin wxGlade: MyDialog.__set_properties
        self.SetTitle("dialog_1")
        self.grid_1.CreateGrid(10, 3)
        # end wxGlade

    def __do_layout(self):
        # begin wxGlade: MyDialog.__do_layout
        grid_sizer_1 = wx.FlexGridSizer(1, 2, 3, 3)
        grid_sizer_1.Add(self.tree_ctrl_1, 1, wx.EXPAND, 0)
        self.window_1.SplitHorizontally(self.text_ctrl_1, self.grid_1)
        grid_sizer_1.Add(self.window_1, 1, wx.EXPAND, 0)
        self.SetSizer(grid_sizer_1)
        grid_sizer_1.Fit(self)
        grid_sizer_1.AddGrowableRow(0)
        grid_sizer_1.AddGrowableCol(0)
        grid_sizer_1.AddGrowableCol(1)
        self.Layout()
        # end wxGlade

# end of class MyDialog

class MyApp(wx.App):
    def OnInit(self):
        wx.InitAllImageHandlers()
        mainDlg = MyDialog(None, -1, "")
        self.SetTopWindow(mainDlg)
        mainDlg.Show()
        return 1

# end of class MyApp

if __name__ == "__main__":
    app = MyApp(0)
    app.MainLoop() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-07T07:20:29.360

您应该使用 wxSplitter，[这是](http://wiki.wxpython.org/ProportionalSplitterWindow)一个示例。另一个[在这里](http://www.zetcode.com/wxpython/widgets/#splitterwindow)。还有[一个](http://wiki.wxpython.org/AnotherTutorial)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-07T18:31:34.043

您可以考虑使用[wx.aui](http://docs.wxwidgets.org/stable/wx_wxauioverview.html#wxauioverview)高级用户界面模块，因为它允许您非常轻松地构建这样的 UI。然后，用户可以根据他们认为合适或不合适来最小化、最大化和拖动窗格。它非常灵活。实际上，我发现使用 aui 工具包而不是使用网格和拆分器来布置这种 UI 更容易。加上所有花哨的按钮使应用程序看起来更酷。:)

官方演示中有一个很好的例子，叫做 AUI_DockingWindowMgr。

# c++ - 如何将外部 DLL 限制为一个 CPU？

> ID：523385
> 
> 赞同：2
> 
> 时间：2009-02-07T07:26:10.707
> 
> 标签：c++, multithreading, dll, external-dependencies

我有一个程序，我想只在一个 CPU 上运行，这样它就不会占用太多系统资源。问题是，它调用了一个自动使用所有可用 CPU 内核的外部 DLL。我没有外部 DLL 的源代码。如何将 DLL 限制为仅使用一个 CPU？

编辑：感谢您的帮助，这是我用来限制一个 CPU（Windows）的代码：

```
// Limit the process to only 1 thread so we don't chew up system resources
HANDLE ProcessHandle = GetCurrentProcess();
DWORD ProcessAffinityMask;
DWORD SystemAffinityMask;
if(GetProcessAffinityMask(ProcessHandle,&ProcessAffinityMask,&SystemAffinityMask)
    && SystemAffinityMask != 0)
{
    // Limit to 1 thread by masking all but 1 bit of the system affinity mask
    DWORD NewProcessAffinityMask = ((SystemAffinityMask-1) ^ SystemAffinityMask) & SystemAffinityMask;
    SetProcessAffinityMask(ProcessHandle,NewProcessAffinityMask);
} 
```

编辑：事实证明，Brannon 设置进程优先级的方法更适合我想要的，即防止进程占用资源。这是该代码（Windows）：

```
// Make the process low priority so we don't chew up system resources
HANDLE ProcessHandle = GetCurrentProcess();
SetPriorityClass(ProcessHandle,BELOW_NORMAL_PRIORITY_CLASS); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-07T07:35:12.090

您可以设置程序的 CPU 亲和性。在 Windows 上尝试[SetProcessAffinityMask](http://msdn.microsoft.com/en-us/library/ms686223(VS.85).aspx)函数或在 Linux上尝试[sched_setaffinity 。](http://www.kernel.org/doc/man-pages/online/pages/man2/sched_setaffinity.2.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-07T08:56:14.207

设置处理器亲和性是错误的方法。让操作系统处理调度。

如果机器处于空闲状态，您希望尽可能多地使用处理器。否则你会无缘无故地做更少的工作。如果机器很忙，那么您希望利用“空闲”周期而不会对其他进程产生不利影响。

Windows 内置了此功能。正确的解决方案是设置进程的基本优先级。

有关. [_](http://msdn.microsoft.com/en-us/library/ms686219(VS.85).aspx) _`SetPriorityClass()`

如果您想在不编写任何代码的情况下对此进行测试，请使用任务管理器更改进程的优先级。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T07:39:10.977

通常，dll 与调用它的代码位于同一线程/内存空间中。调用 DLL 本身的行为不应创建线程。如果调用 DLL 似乎会创建更多线程，则意味着 DLL 本身正在其代码的某处创建线程。如果您没有 DLL 的任何源代码或文档，则您无能为力（如果您希望 DLL 完成它的工作，那么您无需为此做太多事情）。

您可以尝试使用应用程序的优先级 - 将其设置为低可能会改变 CPU 使用率，即使它不会改变创建的线程。但是，您真正想要的似乎是获取此野兽的文档。在不知道代码如何工作的情况下，一般来说，您无法改变它的工作方式。没有超级天才可以改变这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T07:36:32.090

呃……为什么？说真的，您为什么要限制能够以这种方式为您提供额外性能的库？您是否尝试访问共享资源或其他东西？有人会认为多线程库能够安全地处理这个问题。

除非您没有提及某些内容，否则我看不出有任何正当理由可以**尝试**将多线程库限制为单个线程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T07:36:52.353

所以你的程序使用一个线程，但你不希望外部DLL使用多个线程？您对外部 DLL 的功能没有太多控制，但一些方法可能是：

*   使用[“Half-Sync/Half-Async: An Architectural Pattern for Efficient and well-structured Concurrent I/O”](http://citeseer.ist.psu.edu/old/schmidt95halfsynchalfasync.html)设计模式将工作项从一个线程排队到外部 DLL。
*   或者，由于另一个 DLL 将在您的进程中加载​​，您可能能够将您的进程或线程的处理器关联设置为仅一个 CPU。请参阅 Raymond Chen 的[“心理调试：为什么您昂贵的四处理器机器忽略了它的三个处理器”](http://blogs.msdn.com/oldnewthing/archive/2005/03/21/399688.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T08:06:02.263

你没有说这是针对什么平台的。我将在这里假设窗户。

创建子进程并将其与[Job Object](http://msdn.microsoft.com/en-us/library/ms684161(VS.85).aspx)关联。然后，您可以将该作业对象的处理器关联设置为仅包含一个可用的 CPU 内核。子进程无法将关联掩码更改为不是作业对象的处理器关联子集的任何内容。此外，您应该记住不要对作业设置限制`JOB_OBJECT_LIMIT_BREAKAWAY_OK`或扩展限制`JOB_OBJECT_LIMIT_SILENT_BREAKAWAY_OK`，否则子进程将能够脱离作业。

此外，您可以设置作业的优先级和调度类。也许以较低的 CPU 和/或 IO 优先级创建子进程就足够了？

# artificial-intelligence - 当今最重要的人工智能发展？

> ID：523399
> 
> 赞同：6
> 
> 时间：2009-02-07T07:42:28.833
> 
> 标签：artificial-intelligence

您认为当今人工智能研究在现实世界应用中最重要的进展/突破是什么？（包括但不限于：机器学习、统计数据处理以及[从人工智能衍生出来的其他学科](http://en.wikipedia.org/wiki/Applications_of_artificial_intelligence#List_of_applications)）。

请备用/不想要：关于 AI 冬天/失望的漫谈；

想要：链接和指向*具体*现实世界应用程序的指针。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T08:47:28.780

我认为最重要的突破是现实世界的消费者应用程序今天实际上经常使用人工智能。它已经变得普遍，不再像十年前那样仅仅是对学术研究和特殊应用的好奇。一些例子：

*   语音和文本识别（例如 iPhone）。
*   数码相机中的人脸识别。
*   搜索引擎。
*   电子邮件垃圾邮件过滤。
*   汽车的自动变速箱。
*   游戏。
*   等等

它就在我们身边！:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T09:56:23.913

我会将像 DARPA 挑战中的那些自主机器人添加到列表中。开车穿过沙漠或农村地区、识别地形、避开障碍物、寻找路径等绝对是棘手的 AI 问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T09:10:55.097

根据@mad-j game bots AI 已经走了很长一段路：[链接到机器人变得聪明](http://www.spectrum.ieee.org/print/7011)

[替代文字 http://www.spectrum.ieee.org/images/dec08/images/bot01.jpg](http://www.spectrum.ieee.org/images/dec08/images/bot01.jpg)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-07T10:24:40.003

实际上，人工智能研究正在复兴，并且在过去 5-8 年左右一直如此。

> 当神经网络在 70 年代和 80 年代风靡一时时，它们在解决简单任务方面表现出巨大的潜力，以至于人们对整个 AI 领域寄予厚望。然后，当事实证明从非常简单的任务转移到语言习得等现实世界的问题变得非常困难时，很多人变得幻想破灭。*直到最近，就是这样。*

我不是最好的人选——我不是人工智能专家——但我相信一些最有前途的领域是：

1.  语义[搜索](http://www.powerset.com/)和数据挖掘（包括文本分类）
2.  [统计机器翻译](http://en.wikipedia.org/wiki/Statistical_machine_translation)
3.  “真正的情报”HTM（阅读[Jeff Hawkins](http://en.wikipedia.org/wiki/Jeff_Hawkins)的《论[情报](http://en.wikipedia.org/wiki/On_Intelligence)》 ）
4.  相关性/推荐引擎（本质上是数据挖掘和网络分析的混合体）
5.  视觉对象识别

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T09:03:49.167

我认为真正/强大的人工智能已经迷失了方向，几十年来，口语/理解计算机将在“未来 5 年内”可用。然后我们最终得到了一个什么都不懂的[Dragon](http://www.google.com.au/aclk?sa=l&ai=C-NM68UyNSbeFFYnbkAWIzei4Ctba62--j4G1Cd62hBYIABABINfC3gMoA1CFkb6fBGClwKOApAGgAZDl2vQDyAEBqgQZT9B281qYgt4IkHCaOb5GpqcrbyRPdkcbqw&sig=AGiWqtzrXavLCjn6XxSY0Z41KX3ox7iV6w&q=https://track.digitalriver.com//si/cm/tracking/clickredirect.aspx%3Fsicontent%3D0%26sicreative%3D2421557206%26sitrackingid%3D58448622)（没有连接），它是一个聪明的麦克风，而且我已经有一段时间没有听说过关于 AI 的任何事情了——它不再是主流，因为它太难了。我认为有一件事已经毫无疑问地被证明是真正的人工智能，就像在思考机器中，通过人工智能的图灵测试——仍然（非常）很长的路要走。不要误会我的意思，有很多很好的研究正在进行，但我们必须等待 200 到 500 年才能得到结果。

我的直觉是，它们将是来自大规模并行系统的一些有趣的东西，尤其是那些用非常简单的节点构建的系统。如果我不得不指出一个单一的人工智能突破，我会关注纳米技术领域的衍生产品，变得非常小，看看大脑中的细胞在做什么——它是科幻小说，但我们会破解的有一天。

# c# - 我可以在 C# 中定义类似 Perl 的绑定运算符 (=~) 吗？

> ID：523403
> 
> 赞同：1
> 
> 时间：2009-02-07T07:46:03.973
> 
> 标签：c#, regex, perl, operator-overloading

我真的很喜欢能够在 Perl 中使用 =~ 和 !~ 来根据正则表达式计算字符串。我想将此功能移植到 C#，但看起来，虽然您可以重载运算符，但您不能创建新的运算符。

我正在考虑扩展字符串类型以提供 Match() 方法，该方法允许我传递正则表达式以进行评估，但我想知道有更好的方法。

有人有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T14:06:56.153

尝试为作为 Regex.Match 的“快捷方式”的字符串类创建一个扩展方法。像这样的东西：

```
public static class RegexExtensions
{
    public static bool Match(this string text, Regex re)
    {
        return Regex.Match(text, re);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T07:50:47.147

根据我的经验，.NET 支持与 Perl 正则表达式相同的功能，但语法要冗长得多，因此需要一点时间来适应。

C# 不支持隐式变量的概念，因此您始终必须同时提供输入字符串和匹配模式。换句话说，.NET 中缺少的是捷径，而不是通过 =~ 和 !~ 进行的显式匹配。

如果您只想查找匹配项，Regex.Match 与 =~ 执行相同的操作。如果要匹配和替换，则必须使用 Replace 方法。对于 !~ 运算符，您只需使用 ! 和相关的正则表达式方法。

它需要更多的输入，但您可以获得您正在寻找的效果。

# c# - 如何在 C#/Win32 中向记事本发送文本？

> ID：523405
> 
> 赞同：33
> 
> 时间：2009-02-07T07:50:02.840
> 
> 标签：c#, winapi

我正在尝试使用 SendMessage 到记事本，这样我就可以在不使记事本成为活动窗口的情况下插入书面文本。

我过去使用 做过类似的事情`SendText`，但这需要给记事本焦点。

现在，首先我要检索 Windows 句柄：

```
Process[] processes = Process.GetProcessesByName("notepad");
Console.WriteLine(processes[0].MainWindowHandle.ToString()); 
```

我已经确认它是记事本的正确手柄，与`Windows Task Manager`.

```
[DllImport("User32.dll", EntryPoint = "SendMessage")]
public static extern int SendMessage(int hWnd, int Msg, int wParam, int lParam); 
```

从这里开始，我无法让 SendMessage 在我所有的实验中工作。我走错方向了吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-07T08:47:17.967

```
 [DllImport("user32.dll", EntryPoint = "FindWindowEx")]
    public static extern IntPtr FindWindowEx(IntPtr hwndParent, IntPtr hwndChildAfter, string lpszClass, string lpszWindow);
    [DllImport("User32.dll")]
    public static extern int SendMessage(IntPtr hWnd, int uMsg, int wParam, string lParam);
    private void button1_Click(object sender, EventArgs e)
    {
        Process [] notepads=Process.GetProcessesByName("notepad");
        if(notepads.Length==0)return;            
        if (notepads[0] != null)
        {
            IntPtr child= FindWindowEx(notepads[0].MainWindowHandle, new IntPtr(0), "Edit", null);
            SendMessage(child, 0x000C, 0, textBox1.Text);
        }
    } 
```

WM_SETTEXT=0x000c

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-07T08:13:28.083

您首先必须找到输入文本的子窗口。您可以通过查找具有窗口类“编辑”的子窗口来完成此操作。一旦你有了那个窗口句柄，使用 WM_GETTEXT 获取已经输入的文本，然后修改该文本（例如，添加你自己的），然后使用 WM_SETTEXT 将修改后的文本发回。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-01-21T19:24:52.280

```
using System.Diagnostics;
using System.Runtime.InteropServices;

static class Notepad
{
    #region Imports
    [DllImport("user32.dll")]
    public static extern IntPtr FindWindowEx(IntPtr hwndParent, IntPtr hwndChildAfter, string lpszClass, string lpszWindow);

    [DllImport("User32.dll")]
    private static extern int SendMessage(IntPtr hWnd, int uMsg, int wParam, string lParam);

    //this is a constant indicating the window that we want to send a text message
    const int WM_SETTEXT = 0X000C;
    #endregion

    public static void SendText(string text)
    {
        Process notepad = Process.Start(@"notepad.exe");
        System.Threading.Thread.Sleep(50);
        IntPtr notepadTextbox = FindWindowEx(notepad.MainWindowHandle, IntPtr.Zero, "Edit", null);
        SendMessage(notepadTextbox, WM_SETTEXT, 0, text);
    }
} 
```

# vb.net - 是否可以强制实体框架生成的属性来实现接口？

> ID：523409
> 
> 赞同：1
> 
> 时间：2009-02-07T07:51:08.533
> 
> 标签：vb.net, entity-framework, domain-driven-design

示例接口：

```
public Interface IEntity
     Property ID() as Integer
end Interface 
```

我希望我的所有 EF 对象都在主键上实现这个接口。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T20:19:45.190

这在 CSharp 中似乎很容易做到，但在 VB 中，您必须明确声明哪些属性/函数/子正在实现接口：

```
public Property Id() as Integer Implements IEntity.Id 
```

不幸的是，我不得不撕掉设计器文件并修改生成的属性。我最终摆脱了生成的文件，现在将我的模型保存在具有所有属性映射的单独类中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T17:41:01.773

是的你可以。设计器生成的类被声明为部分的。在单独的源文件中，您可以为这些类声明其他方法。您还可以声明已由生成的类实现的特定接口。

```
/* This is the interface that you want to have implemented. */
public interface ISomething
{
    void DoSomething();
}

/* This would be part of the generated class */
partial class PartialClass
{
    public void DoSomething()
    {
    }
}

/* This would be your own extension */
partial class PartialClass : ISomething
{
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T10:51:11.430

这些课程是部分的，所以应该很容易做到。

# php - PHP Arrays，将数组项的计数递归地附加到数组中

> ID：523413
> 
> 赞同：2
> 
> 时间：2009-02-07T07:54:48.557
> 
> 标签：php, arrays, recursion, associative-array

**无意义的运球**

* * *

好的，这是我的另一个奇怪的问题，我要感谢[OIS](https://stackoverflow.com/users/36175/ois)帮助我解决了我的最后一个问题……它处理了同样的时髦数组操作……我深入研究了该代码，我觉得它有帮助递归数组操作函数让我变得更好。然而，我再次发现自己处于另一个艰难的境地

**实际问题**

* * *

~~我正在尝试编写一个递归操作函数，例如[this](https://stackoverflow.com/questions/435180/php-arrays-appending-depth-of-array-item-recursively-to-an-array-with-the-key-of)。除了获取每个数组元素的深度。~~***它将为每个具有一定深度的数组元素添加增量计数。***查看我正在尝试做的最简单的方法是查看“样本数组”和“期望的结果数组”......我觉得我在理解这些递归函数方面越来越好。但是这个让我很痛苦，提前感谢你能给我的任何帮助。请忽略示例数组的 [depth] 结果我已经有一个添加它的函数。再次感谢，--YouDontMeanMuch

**样本数组**

* * *

```
 array (
              52 => 
              array (
                'title' => 'Website Navigation',
                'path' => '',
                'type' => '115',
                'pid' => 0,
                'hasChildren' => 1,
                'children' => 
                array (
                  53 => 
                  array (
                    'title' => 'Home',
                    'path' => '',
                    'type' => '118',
                    'pid' => 52,
                    'hasChildren' => 0,
                  ),
                  54 => 
                  array (
                    'title' => 'Features',
                    'path' => 'features',
                    'type' => '374',
                    'pid' => 52,
                    'hasChildren' => 1,
                    'children' => 
                    array (
                      59 => 
                      array (
                        'title' => 'artistic',
                        'path' => 'features/artistic',
                        'type' => '374',
                        'pid' => 54,
                        'hasChildren' => 1,
                        'children' => 
                        array (
                          63 => 
                          array (
                            'title' => 'galleries',
                            'path' => 'features/artistic/galleries',
                            'type' => '374',
                            'pid' => 59,
                            'hasChildren' => 1,
                            'children' => 
                            array (
                              65 => 
                              array (
                                'title' => 'graphics',
                                'path' => 'features/artistic/galleries/graphics',
                                'type' => '118',
                                'pid' => 63,
                                'hasChildren' => 0,
                              ),
                              67 => 
                              array (
                                'title' => 'mixed medium',
                                'path' => 'features/artistic/galleries/mixed-medium',
                                'type' => '118',
                                'pid' => 63,
                                'hasChildren' => 0,
                              ),
                              64 => 
                              array (
                                'title' => 'overview',
                                'path' => 'features/artistic/galleries',
                                'type' => '118',
                                'pid' => 63,
                                'hasChildren' => 0,
                              ),
                              68 => 
                              array (
                                'title' => 'photography',
                                'path' => 'features/artistic/galleries/photography',
                                'type' => '118',
                                'pid' => 63,
                                'hasChildren' => 0,
                              ),
                              66 => 
                              array (
                                'title' => 'traditional',
                                'path' => 'features/artistic/galleries/traditional',
                                'type' => '118',
                                'pid' => 63,
                                'hasChildren' => 0,
                              ),
                            ),
                          ),
                          62 => 
                          array (
                            'title' => 'overview',
                            'path' => 'features/artistic',
                            'type' => '118',
                            'pid' => 59,
                            'hasChildren' => 0,
                          ),
                          69 => 
                          array (
                            'title' => 'tutorials',
                            'path' => 'features/artistic/tutorials',
                            'type' => '374',
                            'pid' => 59,
                            'hasChildren' => 1,
                            'children' => 
                            array (
                              71 => 
                              array (
                                'title' => 'by category',
                                'path' => 'features/artistic/tutorials/by-category/',
                                'type' => '118',
                                'pid' => 69,
                                'hasChildren' => 0,
                              ),
                              72 => 
                              array (
                                'title' => 'by date',
                                'path' => 'features/artistic/tutorials/by-date/',
                                'type' => '118',
                                'pid' => 69,
                                'hasChildren' => 0,
                              ),
                              70 => 
                              array (
                                'title' => 'overview',
                                'path' => 'features/artistic/tutorials',
                                'type' => '118',
                                'pid' => 69,
                                'hasChildren' => 0,
                              ),
                            ),
                          ),
                        ),
                      ),
                      58 => 
                      array (
                        'title' => 'overview',
                        'path' => 'features',
                        'type' => '118',
                        'pid' => 54,
                        'hasChildren' => 0,
                      ),
                      61 => 
                      array (
                        'title' => 'projects / labs',
                        'path' => 'features/projects-labs/',
                        'type' => '374',
                        'pid' => 54,
                        'hasChildren' => 0,
                      ),
                      60 => 
                      array (
                        'title' => 'web development',
                        'path' => 'features/web-development',
                        'type' => '374',
                        'pid' => 54,
                        'hasChildren' => 1,
                        'children' => 
                        array (
                          74 => 
                          array (
                            'title' => 'articles',
                            'path' => 'features/web-development/articles/',
                            'type' => '374',
                            'pid' => 60,
                            'hasChildren' => 0,
                          ),
                          73 => 
                          array (
                            'title' => 'overview',
                            'path' => 'features/web-development',
                            'type' => '118',
                            'pid' => 60,
                            'hasChildren' => 0,
                          ),
                          75 => 
                          array (
                            'title' => 'tutorials',
                            'path' => 'features/web-development/tutorials',
                            'type' => '374',
                            'pid' => 60,
                            'hasChildren' => 0,
                          ),
                        ),
                      ),
                    ),
                  ),
                  55 => 
                  array (
                    'title' => 'Activity',
                    'path' => 'activity',
                    'type' => '374',
                    'pid' => 52,
                    'hasChildren' => 0,
                  ),
                  56 => 
                  array (
                    'title' => 'Blog',
                    'path' => 'blog',
                    'type' => '374',
                    'pid' => 52,
                    'hasChildren' => 0,
                  ),
                  57 => 
                  array (
                    'title' => 'About',
                    'path' => 'about',
                    'type' => '374',
                    'pid' => 52,
                    'hasChildren' => 1,
                    'children' => 
                    array (
                      76 => 
                      array (
                        'title' => 'the author',
                        'path' => 'about/the-author',
                        'type' => '118',
                        'pid' => 57,
                        'hasChildren' => 0,
                      ),
                      77 => 
                      array (
                        'title' => 'the website',
                        'path' => 'about/the-website',
                        'type' => '118',
                        'pid' => 57,
                        'hasChildren' => 0,
                      ),
                    ),
                  ),
                ),
              ),
            ) 
```

**期望的结果数组**
注意 [count] 索引

* * *

```
 Array
            (
                [53] => Array
                    (
                        [title] => Home
                        [path] => 
                        [type] => 118
                        [pid] => 52
                        [mid] => 53
                        [hasChildren] => 0
                        [depth] => 1
                        [count] =>  1
                    )

                [54] => Array
                    (
                        [title] => Features
                        [path] => features
                        [type] => 374
                        [pid] => 52
                        [mid] => 54
                        [hasChildren] => 1
                        [depth] => 1
                        [count] =>  2
                        [children] => Array
                            (
                                [59] => Array
                                    (
                                        [title] => artistic
                                        [path] => features/artistic
                                        [type] => 374
                                        [pid] => 54
                                        [mid] => 59
                                        [hasChildren] => 1
                                        [depth] => 2
                                        [count] =>  1
                                        [children] => Array
                                            (
                                                [63] => Array
                                                    (
                                                        [title] => galleries
                                                        [path] => features/artistic/galleries
                                                        [type] => 374
                                                        [pid] => 59
                                                        [mid] => 63
                                                        [hasChildren] => 1
                                                        [depth] => 3
                                                        [count] =>  1
                                                        [children] => Array
                                                            (
                                                                [65] => Array
                                                                    (
                                                                        [title] => graphics
                                                                        [path] => features/artistic/galleries/graphics
                                                                        [type] => 118
                                                                        [pid] => 63
                                                                        [mid] => 65
                                                                        [hasChildren] => 0
                                                                        [depth] => 4
                                                                        [count] =>  1
                                                                    )

                                                                [67] => Array
                                                                    (
                                                                        [title] => mixed medium
                                                                        [path] => features/artistic/galleries/mixed-medium
                                                                        [type] => 118
                                                                        [pid] => 63
                                                                        [mid] => 67
                                                                        [hasChildren] => 0
                                                                        [depth] => 4
                                                                        [count] =>  2
                                                                    )

                                                                [64] => Array
                                                                    (
                                                                        [title] => overview
                                                                        [path] => features/artistic/galleries
                                                                        [type] => 118
                                                                        [pid] => 63
                                                                        [mid] => 64
                                                                        [hasChildren] => 0
                                                                        [depth] => 4
                                                                        [count] =>  3
                                                                    )

                                                                [68] => Array
                                                                    (
                                                                        [title] => photography
                                                                        [path] => features/artistic/galleries/photography
                                                                        [type] => 118
                                                                        [pid] => 63
                                                                        [mid] => 68
                                                                        [hasChildren] => 0
                                                                        [depth] => 4
                                                                        [count] =>  4
                                                                    )

                                                                [66] => Array
                                                                    (
                                                                        [title] => traditional
                                                                        [path] => features/artistic/galleries/traditional
                                                                        [type] => 118
                                                                        [pid] => 63
                                                                        [mid] => 66
                                                                        [hasChildren] => 0
                                                                        [depth] => 4
                                                                        [count] =>  5
                                                                    )

                                                            )

                                                    )

                                                [62] => Array
                                                    (
                                                        [title] => overview
                                                        [path] => features/artistic
                                                        [type] => 118
                                                        [pid] => 59
                                                        [mid] => 62
                                                        [hasChildren] => 0
                                                        [depth] => 3
                                                        [count] =>  2
                                                    )

                                                [69] => Array
                                                    (
                                                        [title] => tutorials
                                                        [path] => features/artistic/tutorials
                                                        [type] => 374
                                                        [pid] => 59
                                                        [mid] => 69
                                                        [hasChildren] => 1
                                                        [depth] => 3
                                                        [count] =>  3
                                                        [children] => Array
                                                            (
                                                                [71] => Array
                                                                    (
                                                                        [title] => by category
                                                                        [path] => features/artistic/tutorials/by-category/
                                                                        [type] => 118
                                                                        [pid] => 69
                                                                        [mid] => 71
                                                                        [hasChildren] => 0
                                                                        [depth] => 4
                                                                        [count] =>  1
                                                                    )

                                                                [72] => Array
                                                                    (
                                                                        [title] => by date
                                                                        [path] => features/artistic/tutorials/by-date/
                                                                        [type] => 118
                                                                        [pid] => 69
                                                                        [mid] => 72
                                                                        [hasChildren] => 0
                                                                        [depth] => 4
                                                                        [count] =>  2
                                                                    )

                                                                [70] => Array
                                                                    (
                                                                        [title] => overview
                                                                        [path] => features/artistic/tutorials
                                                                        [type] => 118
                                                                        [pid] => 69
                                                                        [mid] => 70
                                                                        [hasChildren] => 0
                                                                        [depth] => 4
                                                                        [count] =>  3
                                                                    )

                                                            )

                                                    )

                                            )

                                    )

                                [58] => Array
                                    (
                                        [title] => overview
                                        [path] => features
                                        [type] => 118
                                        [pid] => 54
                                        [mid] => 58
                                        [hasChildren] => 0
                                        [depth] => 2
                                        [count] =>  2
                                    )

                                [61] => Array
                                    (
                                        [title] => projects / labs
                                        [path] => features/projects-labs/
                                        [type] => 374
                                        [pid] => 54
                                        [mid] => 61
                                        [hasChildren] => 0
                                        [depth] => 2
                                        [count] =>  3
                                    )

                                [60] => Array
                                    (
                                        [title] => web development
                                        [path] => features/web-development
                                        [type] => 374
                                        [pid] => 54
                                        [mid] => 60
                                        [hasChildren] => 1
                                        [depth] => 2
                                        [count] =>  4
                                        [children] => Array
                                            (
                                                [74] => Array
                                                    (
                                                        [title] => articles
                                                        [path] => features/web-development/articles/
                                                        [type] => 374
                                                        [pid] => 60
                                                        [mid] => 74
                                                        [hasChildren] => 0
                                                        [depth] => 3
                                                        [count] =>  1
                                                    )

                                                [73] => Array
                                                    (
                                                        [title] => overview
                                                        [path] => features/web-development
                                                        [type] => 118
                                                        [pid] => 60
                                                        [mid] => 73
                                                        [hasChildren] => 0
                                                        [depth] => 3
                                                        [count] =>  2
                                                    )

                                                [75] => Array
                                                    (
                                                        [title] => tutorials
                                                        [path] => features/web-development/tutorials
                                                        [type] => 374
                                                        [pid] => 60
                                                        [mid] => 75
                                                        [hasChildren] => 0
                                                        [depth] => 3
                                                        [count] =>  3
                                                    ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T08:23:51.137

我认为这应该可以工作...我无法在您的示例数组上进行测试，但它似乎可以在我制作的较小数组上工作。

**编辑：**现在您已经从示例数组中删除了“深度”键，因此更改了函数。现在它自己找到了深度。我还添加了我的测试代码和输出：

```
<?php

function array_depth_count(&$array, $count=array(), $depth=1) {
    foreach ($array as &$value) {
        if (is_array($value)) {
            $value['count'] = ++$count[$depth];
            array_depth_count($value, $count, $depth + 1);
        }
    }
}

$a = array(array(array(array(0),array(0),array(),array()),0,array()));

echo "Before\n";
print_r($a);
array_depth_count($a);
echo "\n\nAfter\n";
print_r($a);

?> 
```

输出：

```
Before
Array
(
    [0] => Array
        (
            [0] => Array
                (
                    [0] => Array
                        (
                            [0] => 0
                        )

                    [1] => Array
                        (
                            [0] => 0
                        )

                    [2] => Array
                        (
                        )

                    [3] => Array
                        (
                        )

                )

            [1] => 0
            [2] => Array
                (
                )

        )

)

After
Array
(
    [0] => Array
        (
            [0] => Array
                (
                    [0] => Array
                        (
                            [0] => 0
                            [count] => 1
                        )

                    [1] => Array
                        (
                            [0] => 0
                            [count] => 2
                        )

                    [2] => Array
                        (
                            [count] => 3
                        )

                    [3] => Array
                        (
                            [count] => 4
                        )

                    [count] => 1
                )

            [1] => 0
            [2] => Array
                (
                    [count] => 2
                )

            [count] => 1
        )

) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T09:16:51.277

我真的想说这会奏效

```
function deep(&$layer)
{
    $count = 1;
    $keys = array_keys($layer);
    foreach($keys as $key)
        if(is_array($layer[$key]))
            deep($layer[$key]);
    $layer['depth'] = $count++;
} 
```

（经过测试，对我来说效果很好）（我误解了这个问题的另一个例子。这应该是你想要的）

# jquery - jQuery ajax 请求未在后续事件中触发

> ID：523415
> 
> 赞同：2
> 
> 时间：2009-02-07T07:55:31.550
> 
> 标签：jquery, asp.net-mvc

我有一个 jQuery 函数，但有一个小问题：

```
$(function() {
  $("a.CompletedCheckBox").click(function() {
    if($(this).hasClass("CheckedCompletedCheckBox")) {
      $(this).removeClass("CheckedCompletedCheckBox");
    } else {
      $(this).addClass("CheckedCompletedCheckBox");
    }
      $.get("/Tasks/Complete/" + this.id, "", function() {});
  });
}); 
```

我第一次单击链接时，事件功能按预期工作。但是，以后每次单击该链接时，该类都会正确切换，但是 $.get 请求不会触发。

知道为什么对服务器的请求只在第一次触发吗？

*编辑：* 这是我正在使用的标记：

```
<table>
  <tr>
    <th>
      Header Text
    </th>
    ... and so on ...
  </tr>
  <% foreach (var item in Model as Item[])
  {%>
  <tr>
    <td>
      <a href="#" 
         class='<%= "CompletedCheckBox " + (item.Complete ? "CheckedCompletedCheckBox" : "") %>' 
         id='<%= item.ID %>'></a>
    </td>
    ... and so on ...
  </tr>
  <% } %>
</table> 
```

*编辑 2：* 这在 FireFox 中运行良好，但在 IE7 中运行良好。我想在我的应用程序中支持 IE，所以我需要想出为什么这不适用于 IE。

我正在从谷歌（[http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js)）加载 jQuery，如果它有什么不同的话。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T06:40:23.310

IE 可能正在缓存 $.get() 请求的结果。尝试在 get 请求的 URL 中添加时间戳，如下所示：

```
var myDate = new Date();
var timestamp = myDate.getTime();
$.get("/Tasks/Complete/" + this.id + '?t=' + timestamp); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T08:04:29.410

只有一件事，您可以简化一个方面：

```
$(function() {
  $("a.CompletedCheckBox").click(function() {
    $(this).toggleClass("CheckedCompletedCheckBox");
    $.get("/Tasks/Complete/" + this.id, "", function() {});
  });
}); 
```

您的 .get() 调用看起来不错。请记住，尽管浏览器倾向于限制同时 Ajax 请求的数量（通常为 2 或更少）。您确定您的电话正在返回吗？您是否考虑过改用 .ajax() 调用并指定超时和/或错误处理程序，以便查看发生了什么？

**编辑：**尝试了以下代码，它运行良好。你还有别的事情发生。

```
<html>
<head>
  <title>Test Get</title>
  <style type="text/css">
    .CompletedCheckBox { background-color: yellow; display: block; }
    .CheckedCompletedCheckBox { border: 2px solid black; }
  </style>
</head>
<body>
</body>
<a id="abcd" class="CompletedCheckBox">Click me</a>
<script src="http://www.google.com/jsapi"></script>
<script>
  google.load("jquery", "1.3.1");
  google.setOnLoadCallback(function() {
      $(function() {
          $("a.CompletedCheckBox").click(function() {
                $(this).toggleClass("CheckedCompletedCheckBox");
                $.get("/test2.php?id=" + this.id, "", function() {});
              });
      });
    });
</script>
</html> 
```

和

```
<?php
error_log("User pressed link for id $id");
?> 
```

好吧，id 没有通过，但每次点击都会出现错误日志。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T08:26:52.940

我在本地执行您的代码没有问题。即使在服务器上设置了 Thread.Sleep 之后，每个 GET 都会返回。

您的“/Tasks/Complete/”网址是否返回任何内容？HTML，纯文本，json？

你使用的是什么浏览器？这个问题是否在所有浏览器中都存在？我会尝试将 FireFox 与[FireBug 插件](https://addons.mozilla.org/en-US/firefox/addon/1843)一起使用，以在其控制台中查看返回的内容。

让我们知道你发现了什么！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T08:00:42.383

这是您执行的确切代码吗？那么 a.CompletedCheckBox 也会有一个 CheckedCompletedCheckBox 类吗？

看起来它应该可以工作......但是如果您在实际代码中使用其他选择器，我可以看到这可能会出错。

你有任何示例标记吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T16:41:46.777

是的，请发布一个演示？

我尝试使用您的代码摘录，但效果很好。

我想这可能是你从 DOM 中删除（） -ing a.CompletedCheckBox ？

我在 1.2.6 中遇到了这个问题，你删除（和添加）一些元素，事件再也不会触发。

这记录在这里：

[http://docs.jquery.com/Manipulation/remove#expr](http://docs.jquery.com/Manipulation/remove#expr)

由于您使用的是 1.3.1，因此您可以尝试使用 live()。

这是一个演示：

[http://waynekhan.com/sandbox/index.php/demo/get](http://waynekhan.com/sandbox/index.php/demo/get)

红框内的链接会一直有效，因为我们不调用remove()。蓝色框中的链接只工作一次，因为我们调用了 remove()。这可能是你的问题。绿色框中的链接有效，因为我们调用了 remove()，但我们使用的是 live()，而不是 click()。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-09T01:15:18.417

我知道他现在是一个老问题了......但是 IE7 过于热衷于缓存 HTTPXML 对象......所以你必须：

*   在您的网址末尾放置一些随机数据（如 rmurphy 所说）
*   改用 $.post() 方法，因为 IE 不缓存 POST
*   在服务器响应中设置缓存超时，以便 IE 不缓存：

```
    缓存控制 = “无缓存”
    Pragma =“无缓存”
    过期=“0”

```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-05T17:40:12.050

这对我有用：Response.Expires = -1;

# java - 使用java声音实时操作音频和绘制波形

> ID：523419
> 
> 赞同：4
> 
> 时间：2009-02-07T08:00:09.250
> 
> 标签：java, waveform, javasound

我目前正在开发一个应用程序，可以帮助用户调整他的吉他并生成吉他效果。这是实时的。我一直在寻找可以提供生成吉他效果（例如过载和延迟）的想法的 Java 应用程序，但我找不到任何东西。还需要实时创建波形的来源。您的评论会很有帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-18T18:15:48.487

[约翰](https://stackoverflow.com/users/58961/john)说：

> 首先，忘记 Java……其次，您将与硬件交互……Java 不支持这种东西。

天哪，这有点苛刻 - 你应该告诉 Sun 在他们发布 API 之前这是不可能的：http: [//java.sun.com/products/java-media/sound/](http://java.sun.com/products/java-media/sound/)。在 Java 中处理了很多声音，我从来没有遇到过延迟或缓冲区的问题，即使在有些破旧的硬件上也是如此。

好例子@http [://www.jsresources.org/examples/index.html](http://www.jsresources.org/examples/index.html)

好帮手[@http://java.sun.com/products/java-media/sound/list.html](http://java.sun.com/products/java-media/sound/list.html)

...话虽如此，John 对学习 DSP 和波形分析的评论是在 $$$。

玩得开心 - 戴夫

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-10T09:27:23.607

这个开源项目对你来说可能是一个很好的参考。有一个构造波形的函数 [http://code.google.com/p/musicg/](http://code.google.com/p/musicg/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-18T09:30:17.203

关于低延迟声音处理的**可行性**：看看这篇关于[Harmonicon 的文章，一个 java 软合成器](http://researcher.watson.ibm.com/files/us-rabbah/Auerbach07Harmonicon.pdf%E2%80%8E)。这是一个完全在 java 中实现的示例播放合成器，使用[Metronome GC](http://researcher.watson.ibm.com/researcher/view_project.php?id=174)，它在实时操作系统上运行时具有 < 2 ms 的较高延迟保证。

关于波形**生成/dsp**，请查看这个问题中的示例，[Java 生成声音](https://stackoverflow.com/questions/1932490/java-generating-sound)，一个非常简单的波形生成示例。

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2009-02-07T08:40:30.977

首先，忘记Java。Java 是一个托管运行时，它进行垃圾收集。发生这种情况时，您会听到关闭的声音，因为您希望将声音缓冲区保持在较小以最小化延迟，

其次，您将与硬件（即声卡）交互，Java 不支持这种东西，因此您要么必须在 JNI 中编写一些硬件抽象，要么找到现有的解决方案，但这样做有问题。您不太可能从 Java 平台获得实时性能。

你想要做的是你想要去做`C++`，你会想要了解更多关于偏微分、DSP、声音合成和波形分析的知识。这是相当多的工作，但如果你开始阅读相关研究，它应该会给你一个很好的方向感......

# c - 如何修复“赋值使整数没有强制转换”**更新**

> ID：523425
> 
> 赞同：2
> 
> 时间：2009-02-07T08:03:53.517
> 
> 标签：c, command-line

好的，这是我输入的程序（stdio.h 也包括在内）：

```
/* function main begins program execution */
int main (int argc, char *argv[])
{
    int x; /*first number input*/
    int y; /*second number input*/
    int sum; /* variable in which sum will be stored */
    int product; /* variable in which product will be stored */
    int quotient; /* variable in which x divided by y will be stored */
    int md; /* variable in which the modulo division of x divided by y */

    x = argv[2]; /*assign total to x*/
    y = argv[3]; /*assign total to y*/

    if (argc ==3) {
       sum = x + y; /* assign total to sum */
       printf("%d\n",sum); /*print sum*/

       product = x * y; /*assign total to product*/
       printf("%d\n", product); /*print product*/

       quotient = x / y; /*assign total to quotient*/
       printf("%d\n", quotient); /*print quotient*/

       md = x % y; /*assign total to md*/
       printf("%d\n", md); /*print md*/
    } /*end if*/

    if (argc !=3) {
       printf("need two integers\n"); /*need two integers*/
    }

    return 0; /*indicate program ran successfully*/
} /*end of main*/ 
```

当我通过编译器运行它时，它在第 15 行和第 16 行（x= 和 y= 行）中说“赋值从指针生成整数而无需强制转换。” 我该如何解决？

**我将其更改为 x=atoi(argv[2]) 和 y=atoi(argv[3]) 并解决了该问题。但与往常一样，现在又搞砸了。现在，当我运行程序时，我得到：

163 [main] a_4312 _cygtls::handle_exceptions：转储状态时出错

分段故障

我读到这意味着我没有为输出或类似的东西分配内存......有人可以帮我吗？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T08:25:18.027

The numbers you get passed are argv[1] and argv[2], not argv[2] and argv[3].

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T08:08:34.753

The compiler error was due to you assigning text to a number. You actually need to call a function to convert between the 2 atoi.

The most important runtime error is the seg fault, this is caused by using the wrong indexes into the array, c has 0 based arrays so the first element is 0, this means the 2 arguments you want are 1 and 2 (since the first argument is the executable's name).

Finally, you may want to check the y value before the divide and mod since if it's 0 you'll get divide by zero problems.

```
x = atoi(argv[1]); /*assign total to x*/
y = atoi(argv[2]); /*assign total to y*/ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T08:09:42.473

Aside from the provided solution, you should also check whether the required arguments are there (move the last if block to before the assignment to to x and y) before trying to pass them to `atoi` or you will get run-time issues.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T08:07:18.377

`argv[2]`给你一个`char *`。您需要转换为`int`：

```
x = atoi(argv[2]); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T08:35:49.940

If your command line is:

prompt>> myprogram 5 6

argv[0] should be the program name (myprogram) argv[1] should be the first parameter ("5") argv[2] should be the second parameter ("6")

I think you're referring to argv[3], which doesn't exist.

# php - 在 MySQL 中检索多列 PK

> ID：523430
> 
> 赞同：0
> 
> 时间：2009-02-07T08:07:30.403
> 
> 标签：php, mysql, primary-key

如何在 MySQL 中检索多列 PK？

例如，我将主键设置为 PRIMARY KEY ( `donor_id`, `country_id`)

现在，如果我想获取主键值而不在选择查询中连接这两个字段，我该怎么做？我想在视图中使用它（或者更好的是，直接在 phpmaker 中）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T08:14:16.803

目前尚不清楚“不连接”是什么意思。一个简单的

```
SELECT donor_id, country_id FROM table WHERE ...; 
```

将检索记录；您不需要应用`CONCATENATE()`功能或类似的东西。这是从表中选择两条记录的正确方法；它们都被声明为主键的一部分这一事实没有任何改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T09:23:38.283

不需要特殊方法从 MySQL 中具有多列 PK 的表中获取记录。如果您使用的是 ORM，情况可能会有所不同。ORM 可能具有或可能具有特殊或不同的语法/功能，用于处理具有多列 PK 的表。

# .net - 确定.Net中两个类之间的属性调用

> ID：523431
> 
> 赞同：0
> 
> 时间：2009-02-07T08:07:33.913
> 
> 标签：.net, reflection, static-analysis

给定两种 .Net 类型，类型 A 和类型 B，如何确定从类型 B 对类型 A（包括类型 A 的子类）的所有属性调用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-07T08:27:21.237

您必须找到所有可执行成员（方法、属性、事件、构造函数）并调用[MethodInfo.GetMethodBody](http://msdn.microsoft.com/en-us/library/system.reflection.methodbase.getmethodbody.aspx)以获取原始 IL。然后解析该 IL 并查找对属性的访问。不要忘记在基类中声明虚方法。

祝你好运 - 6 个月后见！说真的，这并不容易，听起来像是一个不寻常的要求。这里的大局是什么？

如果您不需要在执行时执行此操作，而只是想查看依赖项，您可能会发现[NDepend](http://www.ndepend.com/)会为您提供帮助。（哎呀，也许 NDepend 公开了一个 API，您可以在执行时使用它 - 我想值得检查一下。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T08:50:44.560

根据 Patrick Smacchia 的博客中的这篇博客条目[Mono.Cecil vs. System.Reflection](http://codebetter.com/blogs/patricksmacchia/archive/2008/03/18/mono-cecil-vs-system-reflection.aspx)，NDepend 使用[Mono.Cecil](http://www.mono-project.com/Cecil)来分析程序集。

也许它可能有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T08:11:28.773

您可以使用 StackFrame 和 StackTrace 类来做到这一点，但这通常被认为是一种不好的做法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T17:10:40.527

该解决方案涉及对代码的静态分析——本质上，我们正在寻找类型 B 中类型 A 的依赖关系。开箱即用的 .Net 反射 API 只能带你到目前为止，在你不得不求助于解析 IL 之前——正如 Jon 所说低于此不可掉以轻心。下面的答案导致了一些可能有帮助的库，我将对它们进行调查：

*   [单丝西尔](http://www.mono-project.com/Cecil)
*   [反射器](http://www.red-gate.com/products/reflector/)

# sql-server - 数据库程序的程序员是否负责数据库备份？

> ID：523436
> 
> 赞同：7
> 
> 时间：2009-02-07T08:10:51.443
> 
> 标签：sql-server, database, backup

假设您销售一个将其数据存储在 Microsoft Sql Server 数据库中的应用程序。一些客户是拥有现有 Sql 安装和维护它们的人员的大公司。其他客户是通过安装程序安装 SQLEXPRESS 版本的小公司。

该数据库将很快包含大量重要数据，需要备份。这是谁的责任？

应用程序是否应该包含用于备份数据库的 UI 并在备份未运行时发出警告？

或者应用程序是否应该只在其文档中包含备份说明？

还是这是客户而不是程序员要解决的问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-07T08:19:03.423

在大多数情况下，我希望客户在不涉及程序员的情况下处理备份。当然，如果客户要求您作为程序员在应用程序中构建备份提醒，那当然没有错。

在某些情况下，客户对他们所使用的技术了解甚少或根本不了解，我还认为，作为系统开发人员，我们有责任告知他们在维护方面应该做什么。

即使是专业客户，我也经常在文档中指定最低备份要求，仅仅是因为您得到了您所要求的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-07T08:29:13.027

这是客户的责任。然而，...

我相信你有三个选择：

1.  提到应该备份数据库。
2.  提供有关如何备份数据的建议。
3.  提供您的服务以维护备份程序。

可以使用其中一种或全部三种。这一切都取决于买卖双方对什么感到满意。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-07T08:44:54.430

如果您正在构建安装 SQLExpress 的软件，那么您应该提供备份功能。默认情况下，SQLExpress 不附带 Management Studio，我认为将 Management Studio 作为应用程序的一部分安装（或要求客户这样做）是一个主要的可用性问题。

该`BACKUP DATABASE`命令很容易从您的应用程序中执行。确实没有理由**不**提供此功能。

对于拥有 IT 人员的客户，他们仍然可以使用现有流程自行处理备份。

每个人都赢了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-07T09:50:08.590

### 备份

根据我的经验，很大程度上取决于数据库是如何安装并与应用程序打包的。如果您将应用程序出售给隐藏或抽象了数据库层实现细节的客户，那么典型的客户期望是备份解决方案作为软件的一部分提供。这种期望有多种原因。

在我的脑海中，其中之一是支持应用程序的 IT 部门无法确定应用程序的数据库备份应该如何进行。有时，某些供应商的数据库转储可能会导致锁定问题，从而中断正常的应用程序操作。我敢肯定，您可以想象 IT 部门可能会对捆绑 DB 的应用程序提出其他投诉。

至于连接到现有数据库的安装，我认为这些数据库的数据库管理员处理备份是一个合理的期望。但是，您（应用程序提供商）记录需要备份的内容非常重要。是否存在需要保持其精确顺序的序列和索引？是否创建了 TB 级的数据，如果丢失，这些数据对您的客户可能并不重要？备份期间应用程序的状态如何（如上所述）？应用程序是否需要关闭？

### 恢复

更成问题的是还原。如果需要部分恢复数据怎么办？这怎么会破坏您的数据存储？您的应用程序是否将数据存储在其他任何地方（文件、网络），这些数据可能由于历史备份而处于不可靠/损坏的状态？

无论如何，长话短说 - 当我是客户时，知道应用程序供应商已经对备份/恢复过程进行了 QA 并提供支持，我感觉好多了。实际上，这是我当前项目的一个大客户的要求。他们不仅有能力管理数据库，还希望我们对自己的数据负责，并保证流程完美无缺。

最后，您的里程可能会因您的特定应用程序的实施、要求和行业期望而有所不同。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-07T08:28:39.347

我个人认为，备份数据的说明非常重要。大多数客户应该能够在不需要 GUI 的情况下自己处理备份，而 GUI 将花费一些时间和金钱来开发。

提供备份说明将有助于确保他们知道他们需要做什么，并且知道这是他们的责任。好的说明也会（希望）减少他们需要的支持数量他们自己的数据库。

我认为用于备份的 GUI 仅在特殊情况下才是必不可少的，在这种情况下，用户根本不会精通技术，数据安全性很重要，并且用户无法访问（或不想花钱购买）IT 员工。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-08T03:15:42.787

让应用程序运行备份解决了“如何找回我不小心删除的数据？”的问题，但它不能解决硬盘驱动器崩溃的问题。您的应用程序不会确保备份到磁带并且磁带在异地正确存储。成为迫使他们对自己的数据承担一定责任的最佳解决方案的一部分。不要因为他们收到指示备份完成的消息框而导致他们产生错误的安全感。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-09T23:30:08.390

如果您提供的是 SQL Server Express，那么与您的客户讨论备份的要求是很重要的（当然只有在可能的情况下）。

这里有很多人建议您让 IT 用户来处理这个问题。这当然是完全正确的，但是它确实存在一个固有的问题，即令人担忧的 IT 支持人员不知道数据库管理员，甚至不知道如何实施一个好的备份策略。

仔细考虑您的个人客户的需求，并可能添加自动备份作为补充，或者如果您感觉慷慨，可以免费添加。毕竟这是 SQL Express，许多客户不会期望必须了解有关数据库备份的任何信息。

# asp.net - web.config 中的 ASP.NET 应用程序设置 debug="false" 破坏了 Javascript

> ID：523475
> 
> 赞同：1
> 
> 时间：2009-02-07T08:58:39.147
> 
> 标签：asp.net, javascript

当我们在 Web.config 中有 debug="true" 时，我们有一个可以正常工作的应用程序，当我们将其设置为“false”时，应用程序停止工作。似乎对象继承在 javascript 中不起作用（Microsoft JScript 运行时错误：对象不支持此属性或方法）。有没有人遇到过这个？

更多错误细节：

a.beginUpdate() 不是函数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T12:44:14.917

好吧，这就是它的样子……一些控件在其构造函数中缺少以下内容。好的

`ControlName.initializeBase(this)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T13:29:08.803

首先，不要尝试在 IE 7 或 8 中调试您的 javascript。这是一个失败的提议——您最终只会摸不着头脑，发誓该错误意味着什么。下载 Google Chrome、带有 FireBug 的 Firefox 或 IE9+ 的副本。这将向您显示错误的*真正*位置。从那里开始。

其次，我敢打赌这与 UI 对象在发送回客户端时的名称不同有关，或者某个元素可能由于某种原因不存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T16:53:20.457

我有同样的问题，检查所有属性后，我注意到`AppPool`没有权限读取部署文件夹中的某些文件，所以我创建了一个新的`Application Pool Connected by a User`，授予权限并且它工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T09:12:54.670

没有遇到这个问题，但是如果你在 IE 中启用脚本调试，你可以单步调试你的 javascript 并缩小问题的范围。如果客户端中的 javascript 受到服务器上应用程序设置的影响，我会感到惊讶，但我可能是错的......

# jquery - ASP.NET MVC 场景，类似于 StackOverflow 上的“发布你的答案”

> ID：523479
> 
> 赞同：1
> 
> 时间：2009-02-07T09:02:34.130
> 
> 标签：jquery, asp.net-mvc, ajax

我需要将评论系统添加到页面（类似于任何 SO 问题底部的“发布您的答案”）。实现这一点的最佳方法是什么？我应该使用 Ajax 呈现部分视图还是应该将 Json 数据传递给服务器？在后一种情况下，我不太明白如何将新添加的评论添加到现有评论的底部。

我对 ASP.NET MVC 非常陌生，并且对 ajax 模式不太熟悉。另外，我听说，不显眼的 JavaScript 的支柱是，您的页面应该首先在没有 JavaScript 的情况下开发并且功能齐全，并且只有在该开发人员应该添加 JavaScript 并增强体验之后。这通常是正确的吗？在上述特定情况下是否正确？

谢谢你。

PS。我正在使用 jQuery。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T09:19:04.847

观看 Phil Haack 的 PDC 演示，他在那里构建 HaackOverflow :)

在此处获取视频：http: [//channel9.msdn.com/pdc2008/PC21/](http://channel9.msdn.com/pdc2008/PC21/)

他演示了使用内置的 AJAX 功能来提交问题，并将其自动添加到现有问题的底部。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T09:56:04.193

我通常会使用 JSON 作为我的 AJAX 数据类型。**JSON**（JavaScript 对象表示法）它的工作方式与 XML 非常相似，但它使用**的数据量减少了大约 70%**。您还会发现在您的 javascript 中解析更容易。**您不必从 xml 初始化日期/数字对象！**

```
{ "people": [
  { "firstName": "Brett", "lastName":"McLaughlin", "email": "brett@newInstance.com" },
  { "firstName": "Jason", "lastName":"Hunter", "email": "jason@servlets.com" },
  { "firstName": "Elliotte", "lastName":"Harold", "email": "elharo@macfaq.com" }
]} 
```

[感谢 IBM 提供的示例](http://www.ibm.com/developerworks/xml/library/wa-ajaxintro10/)

```
<people>
  <person>
    <firstName>Brett</firstName>
    <lastName>McLaughlin</lastName>
    <email>brett@newInstance.com</email >
  </person>
  <person>
    <firstName>Jason</firstName>
    <lastName>Hunter</lastName>
    <email>jason@servlets.com</email >
  </person>
  <person>
    <firstName>Elliotte</firstName>
    <lastName>Harold</lastName>
    <email>elharo@macfaq.com</email >
  </person>
</people > 
```

我发现MVC JSON 框架在序列化、反序列化和忽略成员属性方面**存在一些不足。**我在 codeplex 上找到了[Json.NET项目。](http://james.newtonking.com/projects/json-net.aspx)它似乎填补了 MVC JSON 未涵盖的所有功能空白。

所以在你的控制器中，我使用的是 Json.NET，请注意输出是 ContentResult 并且它**没有**视图

```
 public ContentResult ProcessRequestAction(string Email, string Password)
 {
     Product product = new Product();
     product.Name = "Apple";
     product.Expiry = new DateTime(2008, 12, 28);
     product.Price = 3.99M;
     product.Sizes = new string[] { "Small", "Medium", "Large" };
     return Content(JavaScriptConvert.SerializeObject(product));
 } 
```

典型的 JQuery 代码，用于 JSON 请求

```
 $.ajax({
            type: "POST", /* GET OR POST */
            url: "JSON_MVC_URL_HERE", /* your url here */
            dataType: "json", /* json or xml */
            data: null, /* JSON CODE HERE TO SET GET OR POST BACK PARAMS */
            success: function(data){
                alert(data.Name); /* Gets Name Element */
                alert(data.Expiry); /* Gets Expiry Element */
                alert(data.Price); /* Gets Price Element */
                jQuery.each(data.Sizes, function() { /* Get Each Size */
                    alert(this);
                });
            }
        }); 
```

$.getJSON 也可以，但缺少 http 请求类型 POST/GET

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T10:26:38.937

针对第 2 段：

是的，我建议在没有任何 ajax/js 的情况下开发应用程序。确保操作正常运行。然后稍后添加 ajax（用于 UX）。这种方法也可能有助于启发您如何让应用程序回退到非 js 启用用户（如手机）的非 ajax 方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T04:07:45.707

使用 disqus：[http ://www.disqus.com](http://www.disqus.com)

# cocoa - 核心数据与 SQLite 3

> ID：523482
> 
> 赞同：315
> 
> 时间：2009-02-07T09:05:09.117
> 
> 标签：cocoa, macos, core-data, sqlite

我已经非常熟悉关系数据库并且过去使用过[SQLite](http://en.wikipedia.org/wiki/SQLite)（和其他数据库）。然而，[Core Data](http://en.wikipedia.org/wiki/Core_Data)有一定的吸引力，所以我正在考虑花一些时间来学习它，以便在我的下一个应用程序中使用它。

在 SQLite 上使用 Core Data 有很多好处，反之亦然？每个的优点/缺点是什么？

当 Apple 不将 Core Data 用于其许多旗舰应用程序（如 Mail.app 或 iPhoto.app）时，我发现很难证明学习 Core Data 的成本是合理的，而是选择了 SQLite 数据库。SQLite 在 iPhone 上也被广泛使用。

熟悉使用这两种方法的人可以评论他们的经验吗？也许，和大多数事情一样，问题比仅仅使用一个比另一个更深？

* * *

## 回答 #1

> 赞同：283
> 
> 时间：2009-02-07T18:27:29.810

尽管 Core Data 是 Apple 的[Enterprise Object Framework](http://en.wikipedia.org/wiki/Enterprise_Objects_Framework)的后代，这是一种与关系后端紧密相关的对象关系映射器 (ORM)，但 Core Data*不是*ORM。事实上，它是一个对象图管理框架。它管理一个可能非常大的对象实例图，允许应用程序通过在必要时对内存中的对象进行故障排除来处理无法完全放入内存的图。Core Data 还管理对属性和关系的约束并维护引用完整性（例如，当对象被添加到关系中/从关系中删除时，保持前向和后向链接的一致性）。因此，Core Data 是构建 MVC 架构的“模型”组件的理想框架。

为了实现其图形管理，Core Data*碰巧*使用 SQLite 作为磁盘存储。它*可以*使用不同的关系数据库甚至非关系数据库（例如[CouchDB](http://couchdb.apache.org/) ）来实现。正如其他人所指出的，Core Data 还可以使用 XML 或二进制格式或用户编写的原子格式作为后端（尽管这些选项要求整个对象图适合内存）。如果您对如何在 SQLite 后端实现 Core Data 感兴趣，您可能需要查看 OmniGroup 的[OmniDataObjects](http://www.omnigroup.com/developer/)框架，它是 Core Data API 子集的开源实现。BaseTen框架[也是](http://basetenframework.org/)使用 PostgreSQL 作为后端的 Core Data API 的实现。

因为 Core Data 不打算成为 SQLite 的 ORM，所以它不能读取任意 SQLite 模式。相反，您不应该依赖能够使用其他 SQLite 工具读取 Core Data 的 SQLite 数据存储；架构是一个可能会改变的实现细节。

因此，直接使用 Core Data 或 SQLite 之间并没有任何冲突。如果您想要一个关系数据库，请使用 SQLite（直接或通过诸如[FMDB](https://github.com/ccgus/fmdb)之类的 Objective-C 包装器之一）或关系数据库服务器。但是，您可能仍想学习 Core Data 以用作对象图管理框架。结合 Apple 的控制器类和键值绑定兼容的视图小部件，您可以用很少的代码实现完整的 MVC*架构*。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2011-08-21T10:25:57.610

And with iOS 5.0 you get the added benefit of being able to use iCloud file-sync for free if you're using Core Data. If you're using SQLite directly it'll have to be a lot of manual tinkering and implementation to get it to sync across iCloud.

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-02-07T09:30:23.967

Core Data 与其说是一个数据库引擎，不如说它是一个对实际数据存储进行抽象的 API。您可以告诉 Core Data 保存为 sqlite 数据库、plist、二进制文件，甚至是自定义数据存储类型。

我建议学习 Core Data，因为它是一个极好的资源，可以极大地加速可可应用程序开发的许多部分。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-02-07T09:23:04.340

SQLite 是 Core Data 的数据库格式之一。使用 Core Data，您可以更好地与 Cocoa API 的其余部分集成。

# visual-studio-2008 - 在 vc++ 中正确使用 char 数组

> ID：523494
> 
> 赞同：0
> 
> 时间：2009-02-07T09:21:32.983
> 
> 标签：visual-studio-2008, visual-c++, gdi+

我正在尝试使用 GDI+ Bitmap 类将 IStream 转换为 HBITMAP。使用来自 Web 服务的数据填充 IStream 对象。我正在读取部分数据并将其附加到稍后与 Bitmap 类一起使用的对象中。

这是代码的相关部分

```
 char data1[] = "";
        int offset = 0;

        LPTSTR pszString = NULL;
        LPSTREAM lpStream = NULL;

        CreateStreamOnHGlobal(NULL, TRUE, &lpStream);
        StreamStringCopy ((LPSTREAM)lpStream, (LPCTSTR)"");
        while(of->pread(&data1,1023,offset) > 0){
            LPCTSTR tempStr = data1;
            StreamStringCat ((LPSTREAM)lpStream, tempStr);
            offset = offset + strlen(data1);    
        }
        Bitmap bm(lpStream,FALSE);
        bm.GetHBITMAP(Color.Black, &ret); 
```

StreamStringCat 将字符串附加到 LPSTREAM 对象，因此我可以获得单个 LPSTREAM 对象。

循环仅在第一次运行良好。当再次进入 while 循环时，&data1 给出访问冲突异常。

有人可以告诉我应该如何解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T09:29:48.787

首先，要小心字符串文字。像这样的字符串文字`""`是 type `const char*`，所以你不能写它们。我不完全确定您的构造是否`char data1[] = ""`使其可写，但即使是这样，您那里也只有 2 个字符的内存，而您（我想）尝试将 1023 个字节读入`data1`. 试试这个：

```
char* data1 = static_cast<char*> (std::malloc (1024 * sizeof (char));

...

std::free (data1);

// or try this
char data1 [1024] = { 0 }; // Gives you 1024 bytes to write to on the stack 
```

这会分配一些内存，可以写入。我猜在第一次运行之后，您已经覆盖了一些内存，这会导致下一次运行时出现访问冲突。

# python - 如何在不偶尔反转图像的情况下缩放图像（使用 Python 图像库）

> ID：523503
> 
> 赞同：-1
> 
> 时间：2009-02-07T09:29:37.587
> 
> 标签：python, image-processing, python-imaging-library

当沿[此问题](https://stackoverflow.com/questions/400788/resize-image-in-python-without-losing-exif-data)中显示的线条调整图像大小时，有时会反转生成的图像。我调整大小的图像中约有 1% 是倒置的，其余的都很好。到目前为止，我无法找出这些图像有什么不同。

有关示例，请参见[调整大小的示例](http://images.hudora.de/640x480/NIRV2MRR3XJGR52JATL6BOVMQMFSV54I01.jpeg)和[原始图像](http://images.hudora.de/o/NIRV2MRR3XJGR52JATL6BOVMQMFSV54I01.jpeg)。

有关如何追踪该问题的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T19:46:07.330

我终于能够找到在 JPEG 方面有经验的人，并且通过一些额外的知识能够找到解决方案。

1.  JPEG 是一种非常未指定的格式。
2.  第二个图像是有效的 JPEG，但它在 CMYK 颜色空间中，而不是在 RGB 颜色空间中。
3.  具有设计意识的工具（阅读：Apple 的东西）可以处理 CMYK JPEG，其他东西（Firefox、IE）不能。
4.  CMYK JPEG 的指定*非常低*，Adobe Photoshop 将其写入磁盘的方式几乎是错误的。

最重要的是，[有一个补丁](http://mail.python.org/pipermail/image-sig/2006-April/003871.html)可以解决这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T09:39:38.610

您的原始图像不会显示给我；火狐说

```
The image “http://images.hudora.de/o/NIRV2MRR3XJGR52JATL6BOVMQMFSV54I01.jpeg” 
cannot be displayed, because it contains errors. 
```

这表明当您尝试调整损坏的 JPEG 大小时会出现问题，实际上您调整大小的示例显示了我眼中的 JPEG 损坏（曾经打开 JPEG 图像并旋转几位以查看它对输出的影响？我有，我的一些可恶的创作看起来像那样）。那里有一些 JPEG 修复工具，但我从未认真尝试过其中任何一个，也不知道它们是否能帮助您。

# sql - sql左连接并在结果中重复

> ID：523507
> 
> 赞同：0
> 
> 时间：2009-02-07T09:30:27.070
> 
> 标签：sql, join

假设我有 2 个表，A 和 B，每个 A 实体可能有多个 B 实体，在一种情况下，如果我想获取某些 A 的所有 B，我可以使用简单的左连接来完成

```
select A.id aid,B.id bid from A
left join B on B.aid = A.id
where A.id = 1 
```

它会返回一个结果集，如

```
aid   bid
1     1
1     2
1     3 
```

正如您在第一列中看到的那样，所有这些 1 都是重复的。是否可以修改SQL语句让他返回类似的结果

```
aid    bid
 1      1,2,3 
```

换句话说，将所有投标作为一个实体链接在一起？

另外，如果有另一个表 C，并且每个 A 可以有多个 C，我如何让 SQL 返回一个结果集，如

```
 aid    bid    cid
  1     1,2,3   1,2 
```

代替

```
 aid     bid    cid
  1       1      1
  1       2      1
  1       3      1
  1       1      2
  1       2      2
  1       3      2 
```

非常感谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T09:40:15.677

您使用的是什么 DBMS？

我不能为别人说话，但是在 MySQL 中，从 4.1 开始，你可以使用 GROUP_CONCAT

[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)

例如：

```
select A.id aid, GROUP_CONCAT(DISTINCT B.id) bid from A
left join B on B.aid = A.id
where A.id = 1
GROUP BY a.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T09:42:46.327

尝试使用 COALESCE 功能。

[http://www.sqlteam.com/article/using-coalesce-to-build-comma-delimited-string](http://www.sqlteam.com/article/using-coalesce-to-build-comma-delimited-string)

# android - 是否有在 Android 中输入整数的视图？

> ID：523510
> 
> 赞同：23
> 
> 时间：2009-02-07T09:31:31.170
> 
> 标签：android, user-interface, integer

我正在寻找类似于日期选择器对话框的各个部分的内容。允许您输入可以限制（例如 1 到 10 之间）的整数（并且仅限整数）的视图，您可以在其中使用键盘或视图本身中的箭头。它存在吗？

这是一个对话。请求整数的现成对话框也会有所帮助。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-07T17:44:45.463

该**`NumberPicker`**小部件可能是您想要的。不幸的是，它位于`com.android.internal.Widget.NumberPicker`我们无法通过正常方式到达的地方。

有两种使用方法：

1.  从android源代码复制代码
2.  使用反射访问小部件

这是在布局中使用它的 xml：

```
<com.android.internal.widget.NumberPicker
    android:id="@+id/picker"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"/> 
```

这是设置 NumberPicker 设置的反射（我没有测试过）：

```
Object o = findViewById(R.id.picker);
Class c = o.getClass();
try 
{
    Method m = c.getMethod("setRange", int.class, int.class);
    m.invoke(o, 0, 9);
} 
catch (Exception e) 
{
    Log.e("", e.getMessage());
} 
```

由于它是一个内部小部件而不是在 SDK 中，如果您使用反射，将来的兼容性可能会被破坏。从源头上滚动你自己的将是最安全的。

此信息的原始来源在此[Google Group](http://groups.google.com/group/android-developers/browse_frm/thread/65da9820998fddc9/6151cc9800e6a04d#6151cc9800e6a04d)中共享。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-05-15T20:58:00.323

NumberPicker 内部小部件已从 Android 源代码中提取并打包供您使用，您可以在[此处](http://www.quietlycoding.com/?p=5)找到它。效果很好！

**编辑：原始链接已关闭，您可以在**[此处](https://code.google.com/p/tippytipper/source/browse/trunk/Tippy%20Tipper%20Library/src/net/mandaria/tippytipperlibrary/widgets/NumberPicker.java)找到小部件的副本

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-02-01T19:00:37.207

正如其他地方所[提到](https://stackoverflow.com/a/8511907/399105)的，NumberPicker 现在在 Android SDK 中可用，从 API 11（Android 3.0）开始：

[http://developer.android.com/reference/android/widget/NumberPicker.html](http://developer.android.com/reference/android/widget/NumberPicker.html)

对于 Android < 3.0，您可以在此处使用代码：
[https ://github.com/novak/numpicker-demo](https://github.com/novak/numpicker-demo)
[https://github.com/mrn/numberpicker](https://github.com/mrn/numberpicker)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T07:47:00.290

您可以使用 EditText`android:inputType="number"`

```
<EditText android:layout_height="wrap_content" android:id="@+id/editText1" android:inputType="number" android:layout_width="wrap_content"></EditText> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-14T21:14:45.347

您可以简单地使用 an`EditText`并将其定义`inputType`为`number`。例如：

```
 <EditText
            android:id="@+id/etNumberInput"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_margin="8dp"
            android:inputType="number" /> 
```

要将最大值限制为 10，您可以通过编程方式执行以下操作：

```
 final EditText et = findViewById(R.id.etNumberInput);

        et.addTextChangedListener(new TextWatcher() {

            public void afterTextChanged(Editable s) {}

            public void beforeTextChanged(CharSequence s, int start,
                                          int count, int after) {}

            public void onTextChanged(CharSequence s, int start,
                                      int before, int count) {
                if (Integer.parseInt(et.getText().toString()) > 10) {
                    et.setError("***Your error here***");
                    // your logic here; to limit the user from inputting
                    // a value greater than specified limit
                }
            }
        }); 
```

这应该符合您的目标。

# c# - C# & PHP：C# 使用的 PHP Web 服务的简单示例

> ID：523529
> 
> 赞同：5
> 
> 时间：2009-02-07T09:43:17.793
> 
> 标签：c#, php, web-services

谁能给我一个小而简单的例子来说明如何做到这一点？或者一些关于如何开始的好建议。

我想创建一个 C# 客户端，它可以将文件或一些文本或 xml 或其他内容发送到 Web 服务或用 PHP 编写的类似内容，其中 PHP Web 服务将其存储在文件或数据库或类似的东西中。只是不知道如何开始。

我想第一步是创建 php web 服务。然后在 C# 中使用它可能会很容易，因为我可能几乎可以在 vs 中使用“添加 Web 引用”按钮，然后从那里开始？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T09:49:44.503

您可以查看本[教程](http://www.onlamp.com/pub/a/php/2007/07/26/php-web-services.html?page=1)，了解如何使用 php 开发 Web 服务。正如您所提到的，.NET 客户端将非常简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T09:50:52.100

我不精通您打算成为消费者的问题的 C# 方面。但是，如果您不介意使用库来加快启动和运行 Web 服务的过程，您可以使用[Zend Framework](http://framework.zend.com/)快速设置一个。查看设置[Zend_Rest_Server](http://framework.zend.com/manual/en/zend.rest.server.html)的文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T09:55:51.637

只是一个想法......如果服务只需要支持“上传文件”等简单操作，也许一起避免 WSDL？我假设 PHP 可以处理原始请求 - 所以你可以使用 oh-so-complex .NET 客户端：

```
 using (WebClient client = new WebClient())
    {
        client.UploadFile("http://some/upload.php", "foo.bar");
        client.UploadString("http://some/upload.php", "some text");
    } 
```

等等。同样，您通常可以轻松地使用 POX / REST，而无需正式的 Web 服务合同的复杂性。上面的代码只是使用正文中的文件内容/字符串执行一个简单的 HTTP 请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T20:03:46.980

你说的对。您需要做的就是在 PHP 中创建一个简单的 Web 服务，它接受请求/xml/文件，然后将其存储在数据库中。那么您可以使用任何技术使用 Web 服务，当然是 C#。为了用 PHP 编写 Web 服务，我认为最好在第一步中选择您的 Web 服务类型。它可以是 REST Web 服务、SOAP 或 XML-RPC。这取决于您的应用程序的复杂程度。

如果您的应用程序很简单，只需将字符串扔给 Web 服务或文件 URL，那么 Web 服务可以存储该字符串，或者从 URL 中获取文件并将其存储在数据库中，我建议使用 REST。因为它更简单。就像编写一个使用 HTTP 参数作为输入的简单 PHP 脚本一样简单。

但是如果您希望它更安全或有更复杂的需求，在 PHP 中很容易拥有 SOAP 服务。如果您想使用 SOAP，PHP 有一个扩展 (php-soap)，您可以安装并使用 PHP-SOAP 的内置功能。如果您使用的是不支持该扩展的旧版 PHP，或者您的应用程序将托管在未安装 php-soap 的位置，则有 SOAP 协议的纯 PHP 实现，名为 nusoap。它是开源的并且运行良好。

[http://sourceforge.net/projects/nusoap/](http://sourceforge.net/projects/nusoap/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-13T09:06:48.123

我在 PHP NuSOAP webservice 和我的 C# 移动客户端从 web 服务获取数据中工作。下面是链接

[http://khanmubeen.wordpress.com/2010/11/18/web-services-with-php-nusoap-c-mobile-client/](http://khanmubeen.wordpress.com/2010/11/18/web-services-with-php-nusoap-c-mobile-client/)

如果您想从我这里了解更多信息，欢迎在 gmail.com 的 mubeen44us 收件箱我

# java - Java的快速超越/三角函数

> ID：523531
> 
> 赞同：20
> 
> 时间：2009-02-07T09:45:44.637
> 
> 标签：java, optimization, math, trigonometry

由于 java.lang.Math 中的三角函数非常慢：是否有一个库可以进行快速且良好的近似？在不损失太多精度的情况下，似乎可以将计算速度提高几倍。（在我的机器上，乘法需要 1.5ns，java.lang.Math.sin 需要 46ns 到 116ns）。不幸的是，还没有一种方法可以使用硬件功能。

更新：函数应该足够准确，例如 GPS 计算。这意味着您需要至少 7 个十进制数字的准确性，这排除了简单的查找表。它应该比基本 x86 系统上的 java.lang.Math.sin 快得多。否则就没有意义了。

对于超过 pi/4 的值，除了硬件功能之外，Java还会进行[一些昂贵的计算。](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4857011)这样做是有充分理由的，但有时您更关心速度而不是最后一点的准确性。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-07T21:14:49.317

[哈特的计算机近似](https://rads.stackoverflow.com/amzn/click/com/0882756427)。[以不同的精度将一组函数的切比雪夫经济](http://en.wikipedia.org/wiki/Approximation_theory)近似公式制成表格。

**编辑：**把我的书从书架上拿下来，结果发现它是[一本不同的书](https://rads.stackoverflow.com/amzn/click/com/B0000CJASU)，听起来很相似。这是一个使用其表的 sin 函数。（在 C 中测试，因为这对我来说更方便。）我不知道这是否会比 Java 内置更快，但至少可以保证它不那么准确。:) 您可能需要先对参数进行范围缩小；请参阅[约翰库克的建议](https://stackoverflow.com/questions/523531/fast-transcendent-trigonometric-functions-for-java/523777#523777)。这本书还有arcsin和arctan。

```
#include <math.h>
#include <stdio.h>

// Return an approx to sin(pi/2 * x) where -1 <= x <= 1.
// In that range it has a max absolute error of 5e-9
// according to Hastings, Approximations For Digital Computers.
static double xsin (double x) {
  double x2 = x * x;
  return ((((.00015148419 * x2
             - .00467376557) * x2
            + .07968967928) * x2
           - .64596371106) * x2
          + 1.57079631847) * x;
}

int main () {
  double pi = 4 * atan (1);
  printf ("%.10f\n", xsin (0.77));
  printf ("%.10f\n", sin (0.77 * (pi/2)));
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-07T10:52:55.267

[这](http://www.shellandslate.com/computermath101.html)是一组用于快速逼近三角函数的低级技巧。我发现有一些 C 语言示例代码很难理解，但这些技术在 Java 中同样容易实现。

这是我在 Java 中对 invsqrt 和 atan2 的等效实现。

我可以为其他三角函数做类似的事情，但我发现没有必要，因为分析表明只有 sqrt 和 atan/atan2 是主要瓶颈。

```
public class FastTrig
{
  /** Fast approximation of 1.0 / sqrt(x).
   * See <a href="http://www.beyond3d.com/content/articles/8/">http://www.beyond3d.com/content/articles/8/</a>
   * @param x Positive value to estimate inverse of square root of
   * @return Approximately 1.0 / sqrt(x)
   **/
  public static double
  invSqrt(double x)
  {
    double xhalf = 0.5 * x; 
    long i = Double.doubleToRawLongBits(x);
    i = 0x5FE6EB50C7B537AAL - (i>>1); 
    x = Double.longBitsToDouble(i);
    x = x * (1.5 - xhalf*x*x); 
    return x; 
  }

  /** Approximation of arctangent.
   *  Slightly faster and substantially less accurate than
   *  {@link Math#atan2(double, double)}.
   **/
  public static double fast_atan2(double y, double x)
  {
    double d2 = x*x + y*y;

    // Bail out if d2 is NaN, zero or subnormal
    if (Double.isNaN(d2) ||
        (Double.doubleToRawLongBits(d2) < 0x10000000000000L))
    {
      return Double.NaN;
    }

    // Normalise such that 0.0 <= y <= x
    boolean negY = y < 0.0;
    if (negY) {y = -y;}
    boolean negX = x < 0.0;
    if (negX) {x = -x;}
    boolean steep = y > x;
    if (steep)
    {
      double t = x;
      x = y;
      y = t;
    }

    // Scale to unit circle (0.0 <= y <= x <= 1.0)
    double rinv = invSqrt(d2); // rinv ≅ 1.0 / hypot(x, y)
    x *= rinv; // x ≅ cos θ
    y *= rinv; // y ≅ sin θ, hence θ ≅ asin y

    // Hack: we want: ind = floor(y * 256)
    // We deliberately force truncation by adding floating-point numbers whose
    // exponents differ greatly.  The FPU will right-shift y to match exponents,
    // dropping all but the first 9 significant bits, which become the 9 LSBs
    // of the resulting mantissa.
    // Inspired by a similar piece of C code at
    // http://www.shellandslate.com/computermath101.html
    double yp = FRAC_BIAS + y;
    int ind = (int) Double.doubleToRawLongBits(yp);

    // Find φ (a first approximation of θ) from the LUT
    double φ = ASIN_TAB[ind];
    double cφ = COS_TAB[ind]; // cos(φ)

    // sin(φ) == ind / 256.0
    // Note that sφ is truncated, hence not identical to y.
    double sφ = yp - FRAC_BIAS;
    double sd = y * cφ - x * sφ; // sin(θ-φ) ≡ sinθ cosφ - cosθ sinφ

    // asin(sd) ≅ sd + ⅙sd³ (from first 2 terms of Maclaurin series)
    double d = (6.0 + sd * sd) * sd * ONE_SIXTH;
    double θ = φ + d;

    // Translate back to correct octant
    if (steep) { θ = Math.PI * 0.5 - θ; }
    if (negX) { θ = Math.PI - θ; }
    if (negY) { θ = -θ; }

    return θ;
  }

  private static final double ONE_SIXTH = 1.0 / 6.0;
  private static final int FRAC_EXP = 8; // LUT precision == 2 ** -8 == 1/256
  private static final int LUT_SIZE = (1 << FRAC_EXP) + 1;
  private static final double FRAC_BIAS =
    Double.longBitsToDouble((0x433L - FRAC_EXP) << 52);
  private static final double[] ASIN_TAB = new double[LUT_SIZE];
  private static final double[] COS_TAB = new double[LUT_SIZE];

  static
  {
    /* Populate trig tables */
    for (int ind = 0; ind < LUT_SIZE; ++ ind)
    {
      double v = ind / (double) (1 << FRAC_EXP);
      double asinv = Math.asin(v);
      COS_TAB[ind] = Math.cos(asinv);
      ASIN_TAB[ind] = asinv;
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-07-02T23:24:52.943

这可能会成功：http: [//sourceforge.net/projects/jafama/](http://sourceforge.net/projects/jafama/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-07T12:56:33.330

在 x86 上，java.lang.Math sin 和 cos 函数不直接调用硬件函数，因为 Intel 并不总是能很好地实现它们。在错误 #4857011 中有一个很好的解释。

[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4857011](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4857011)

您可能需要认真考虑一个不精确的结果。有趣的是，我经常花时间在其他代码中找到它。

“但是评论说Sin……”

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-07T13:36:55.917

我很惊讶内置的 Java 函数会这么慢。当然，JVM 调用的是 CPU 上的本机三角函数，而不是在 Java 中实现算法。你确定你的瓶颈是调用触发函数而不是一些周围的代码吗？也许一些内存分配？

你能用 C++ 重写你的代码中进行数学运算的部分吗？仅仅调用 C++ 代码来计算三角函数可能不会加快速度，但是将一些上下文（如外循环）移动到 C++ 可能会加快速度。

如果您必须滚动自己的三角函数，请不要单独使用泰勒级数。除非您的论点非常小，否则 CORDIC 算法要快得多。您可以使用 CORDIC 开始，然后使用简短的泰勒级数完善结果。请参阅有关[如何实现](https://stackoverflow.com/questions/345085/how-do-trigonometric-functions-work/345117#345117)三角函数的 StackOverflow 问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-07T10:18:47.893

如果您只需要一些近似值，您可以将您的 sin 和 cos 预先存储在一个数组中。例如，如果要存储 0° 到 360° 的值：

```
double sin[]=new double[360];
for(int i=0;i< sin.length;++i) sin[i]=Math.sin(i/180.0*Math.PI): 
```

然后，您可以使用度数/整数而不是弧度/双精度来使用此数组。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-07T10:01:10.283

我还没有听说过任何库，可能是因为很少能看到触发繁重的 Java 应用程序。使用 JNI（相同的精度，更好的性能）、数值方法（可变精度/性能）或简单的近似表也很容易实现。

与任何优化一样，最好在重新发明轮子之前测试这些功能实际上是一个瓶颈。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-07T11:23:15.873

三角函数是查找表的经典示例。见优秀

*   [维基百科上的查找表文章](http://en.wikipedia.org/wiki/Lookup_table)

如果您正在搜索 J2ME 库，您可以尝试：

*   *定点整数数学* 库[MathFP](http://home.comcast.net/~ohommes/MathFP)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-07T09:55:08.627

java.lang.Math 函数调用硬件函数。您应该可以做出简单的认可，但它们不会那么准确。

在我的实验室上，sin 和 cos 大约需要 144 ns。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-08T21:48:08.613

在 sin/cos 测试中，我对 0 到 100 万的整数进行了测试。我假设 144 ns 对你来说不够快。

您对所需的速度有特定要求吗？

您能否以令人满意的每次操作时间来确定您的要求？

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-02-07T10:02:04.727

如果您想使用现有的东西，请查看[Apache Commons Math 包。](http://commons.apache.org/math/)

如果性能*真的很*重要，那么您可以使用标准数学方法自行实现这些功能 - 泰勒/麦克劳林级数，特别是。

例如，这里有几个可能有用的泰勒级数展开式（取自[维基百科](http://en.wikipedia.org/wiki/Taylor_expansion)）：

![替代文字](https://upload.wikimedia.org/math/d/0/d/d0d68a0e34cc259212ab6e4506e3d99c.png)

![替代文字](https://upload.wikimedia.org/math/7/1/4/714da1fbbf0665e20f9dfc7215fa60a7.png)

![替代文字](https://upload.wikimedia.org/math/1/9/b/19b7a25ece5e84ac94671cb541f38f79.png)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-02-07T20:54:40.137

如果这些例程太慢，您能否详细说明您需要做什么。您可能能够以某种方式提前进行一些坐标转换。

# functional-programming - JUMP 和 CALL 的区别

> ID：523540
> 
> 赞同：25
> 
> 时间：2009-02-07T09:52:18.913
> 
> 标签：functional-programming, recursion, computer-science

JUMP 和 CALL 指令有何不同？它与 GOTO 或过程调用等更高级别的概念有何关系？（我在比较中正确吗？）

这就是我的想法：

JUMP 或 GOTO 是将控件转移到另一个位置，并且控件不会自动返回到调用它的位置。

另一方面，CALL 或过程/函数调用返回到调用它的位置。由于它们本质上的这种差异，语言通常使用堆栈，并且堆栈帧被推送以“记住”每个调用过程返回的位置。这种行为也适用于递归过程。但是，在尾递归的情况下，无需为*每次*调用“推送”堆栈帧。

您的回答和评论将不胜感激。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-07T09:59:17.153

如果您在谈论 x86 程序集中的 CALL/JMP 或类似的东西，那么您基本上是对的。主要区别在于：

*   JMP 执行跳转到某个位置，而不执行任何其他操作
*   CALL 将当前指令指针压入堆栈（而不是：在当前指令之后的一个），然后 JMP 到该位置。使用 RET，您可以回到原来的位置。

通常，CALL 只是一个使用 JMP 实现的便利函数。你可以做类似的事情

```
 movl $afterJmp, -(%esp)
          jmp location
afterJmp: 
```

而不是呼叫。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T09:59:43.343

我想你已经有了大致的想法。

这取决于架构，但通常在硬件级别：

*   跳转指令将更改[程序计数器](http://en.wikipedia.org/wiki/Program_counter)以在程序的不同部分继续执行。

*   一条调用指令会将当前程序位置（或当前位置+1）压入[调用堆栈](http://en.wikipedia.org/wiki/Call_stack)并跳转到程序的另一部分。然后返回指令将从调用堆栈中弹出该位置并跳回原始位置（或原始位置 + 1）。

因此，跳转指令接近于`GOTO`，而调用指令接近于过程/函数调用。

另外，由于在进行函数调用时使用了调用堆栈，因此通过递归将过多的返回地址压入调用堆栈会导致[堆栈溢出](http://en.wikipedia.org/wiki/Stack_overflow)。

在学习汇编时，我发现处理[RISC](http://en.wikipedia.org/wiki/Reduced_instruction_set_computer)处理器比处理 x86 处理器更容易，因为它往往具有更少的指令和更简单的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T10:05:12.553

您对跳转和呼叫之间的区别完全正确。

在具有尾递归的单个函数的示例情况下，编译器可能能够重用现有的堆栈帧。但是，使用相互递归函数可能会变得更加复杂：

```
void ping() { printf("ping\n"); pong(); }
void pong() { printf("pong\n"); ping(); } 
```

考虑 ping() 和 pong() 是采用不同数量参数的更复杂函数的情况。[Mark Probst 的论文](http://www.complang.tuwien.ac.at/schani/diplarb.ps)非常详细地讨论了 GCC 的尾递归实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-18T16:57:36.327

对您的想法的一个更正：不仅使用尾*递归*，而且通常使用尾*调用*，我们不需要堆栈帧，因此可以在那里简单地 JMP（前提是参数已正确设置）。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-08-18T12:34:12.577

根据微处理器，首先检查条件，然后执行跳转操作（转到其他代码）并且不返回。调用操作就像`c`语言中的函数 callig，当函数执行时，它会返回以完成其执行。

# java - java中的模拟

> ID：523541
> 
> 赞同：6
> 
> 时间：2009-02-07T09:53:30.877
> 
> 标签：java, simulation

我是模拟世界的新手，想了解程序员如何用java开发真正的模拟项目。我会使用日食。谁能指出我需要知道的其他事情（例如其他软件包、软件等及其用途）？

我担心这个问题可能看起来有点模糊，因为不清楚我在谈论哪种类型的项目。但作为一个新手，让我说这是开始如何编写模拟项目。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-07T12:26:58.697

如果您正在为[离散事件模拟](http://en.wikipedia.org/wiki/Discrete_event_simulation)或为[衍生品定价的模拟模型构建](http://en.wikipedia.org/wiki/Monte_Carlo_option_model)[Monte-Carlo 模型](http://en.wikipedia.org/wiki/Monte_Carlo_method)，您应该会发现已经有[大量](http://monte-carlo-simulation.qarchive.org/)[框架](http://www.cosc.canterbury.ac.nz/research/RG/net_sim/simulation_group/akaroa/about.chtml)[代码](http://ptolemy.eecs.berkeley.edu/)。如果您正在进行数值模拟，例如[有限元模型](http://en.wikipedia.org/wiki/Finite_element_method)，您的模拟将基于[矩阵](http://math.nist.gov/javanumerics/jama/)[计算](http://ressim.berlios.de/)库。 [存在其他类型的模拟](http://en.wikipedia.org/wiki/Computer_simulation)，但这是最可能的两种情况。

我从来没有写过有限元模型，对这些几乎一无所知，尽管我确实有机会将一个移植到[DEC Visual FORTRAN](http://h21007.www2.hp.com/portal/site/dspp/menuitem.863c3e4cbcdc3f3515b49c108973a801/?ciid=8508092f62f02110092f62f02110275d6e10RCRD)。尽管该程序（[SAFIR，](http://www.argenco.ulg.ac.be/logiciels/SAFIR/downloads-2.html)如果有人关心的话）是用法语注释的，移植练习包括修改两个日期函数，总共 6 行 FORTRAN 代码 - 并编写一个 makefile。

蒙特卡洛模型包括测量一些基本人口以获得一个或多个感兴趣变量的[分布](http://en.wikipedia.org/wiki/Probability_density_function)。然后，您采用具有良好[统计](http://en.wikipedia.org/wiki/Random_number_generation#Post-processing_and_statistical_checks)和[几何](http://random.mat.sbg.ac.at/~charly/server/node3.html)特性的[伪随机数生成器（](http://en.wikipedia.org/wiki/Pseudorandom_number_generator) [Mersenne Twister](http://en.wikipedia.org/wiki/Mersenne_twister)算法被广泛用于此）并编写一个[函数](http://epp.eurostat.ec.europa.eu/cache/ITY_PUBLIC/NTTS2001/46.pdf)将其输出转换为[具有适当分布的随机变量。](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Random.html)除非您的变量具有非常不寻常的分布，否则您 可能会找到执行此操作的[库](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Random.html)[函数。](http://warp.cpsc.ucalgary.ca/Software/SimKit/Documentation/Utility/RandomNumber.html)

然后，您构建或获得一个模拟框架并编写一个例程，该例程采用随机变量并执行您想要为模型执行的任何计算。您运行它，存储每个模拟的结果，直到误差在某个所需的容差范围内。之后，您从模拟模型的所有运行中计算统计数据（均值、分布等）。

网络上有很多资源，还有很多关于模拟建模的书籍，尤其是在衍生品定价领域。你应该四处寻找，看看你能找到什么。

[顺便说一句， Python](http://www.python.org)上的[`random`](http://docs.python.org/library/random.html)模块具有许多发行版的转换功能。如果你想要一个，你可以得到它并将适当的转换函数移植到 java。您可以使用具有相同随机数种子的 python 的输出来测试 java 的正确性。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-07T13:30:25.370

对于可以建模为在特定时间发生的单个事件的问题，离散事件模拟是一个不错的选择。主要活动有：

*   根据经验数据随机生成时间和持续时间，以及
*   在模拟运行时累积统计数据。

例如，您可以将停车场中的活动模拟为汽车的进出以及由于车库已满而无法进入的客户的流失。这可以通过两个模型类，一个 Car 和 Garage，以及三个基础设施类，一个 Event 类（如下所述），一个管理事件的 Schedule 和一个用于积累数据的 Monitor 来完成。

这是它如何工作的简要草图。

## 事件

Event 有一个时间，表示调用特定类的对象的特定方法。

## 日程

Schedule 保留一个事件队列，按事件时间排序。时间表通过一个简单的循环来驱动整个模拟。只要还有剩余的事件（或直到标志着模拟运行结束的事件）：

1.  从队列中取出最早的事件，
2.  将“世界时钟”设置为该事件的时间，并且
3.  调用事件指定的任何操作。

## 车

Car 类包含到达间隔和停留时间的统计信息。

当汽车到达时，它：

1.  用监视器记录它的到来，

2.  查阅世界时钟，确定下一辆车应该在多长时间之前到达，并将该到达事件发布到时间表上。

3.  询问车库是否已满：

    1.  如果满了，汽车会在监视器上记录它的离开作为失去的客户。

    2.  如果没有满，汽车：

        1.  使用监视器记录其条目，

        2.  告诉车库它已经进入（以便车库可以减少其可用容量），

        3.  确定它将停留多长时间，并将其离开事件与时间表一起发布。

当汽车离开时，它：

1.  告诉车库（这样车库可以增加可用容量），并且

2.  用监视器记录它的离开。

## 车库

车库跟踪当前在里面的汽车，并知道它的可用容量。

## 监视器

监控器会跟踪您感兴趣的统计数据：客户数量（成功到达的汽车）、丢失的客户数量（在地段已满时到达的客户）、平均停留时间、收入（基于收取的费率）停车）等。

## 模拟运行

通过将两个事件放入计划中来开始模拟：

1.  第一辆汽车的到来（通过实例化一个汽车对象并调用它的“到达”事件来建模）和

2.  模拟结束。

重复基本的模拟循环，直到遇到模拟结束事件。此时，要求车库报告其当前居住者，并要求监视器报告会话的整体统计数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T09:59:04.297

简短的回答是**视**情况而定。

除非你能把问题说得更具体，否则没有办法给出答案。

你想模拟什么？

例如，如果你想模拟两个数字相加，你可以使用类似的方法：

```
a = b + c; 
```

如果您想模拟球的弹跳，您可以使用一点数学方程式和图形库来实现。

如果你想模拟一个网络浏览器，你也可以这样做。

所以确切的答案取决于你想做什么模拟。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T15:42:11.373

Come up with a problem first.

There's no such things as a generic "simulation". There are lots of techniques out there.

If you're just a gamer who wants to have pseudo-physics, maybe something like [this](https://rads.stackoverflow.com/amzn/click/com/159059472X) would be what you had in mind.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-29T10:15:01.810

这是一个老问题，但对于 Java 中的模拟，我刚刚安装并测试了泰恩河畔纽卡斯尔大学 Mark Little 的 JavaSim。据我所知，如果您有一个可以转换为离散事件模拟的模型，它会非常有效。请参阅 Mark 的网站[http://markclittle.blogspot.com.au/2008/03/csimjavasim.html](http://markclittle.blogspot.com.au/2008/03/csimjavasim.html)。我还尝试使用 Desmo-J，它非常广泛并且具有 2-D 图形模式，但无法在 Mac 上的 JDK 1.6 下运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-24T21:24:13.433

看看 Repast Symphony：[http ://repast.sourceforge.net/repast_simphony.html](http://repast.sourceforge.net/repast_simphony.html)

“Repast Simphony 2.0 Beta 于 2010 年 12 月 3 日发布，是一个紧密集成、丰富交互、跨平台的基于 Java 的建模系统，可在 Microsoft Windows、Apple Mac OS X 和 Linux 下运行。它支持极其灵活的开发用于工作站和小型计算集群的交互代理模型。 

Repast Simphony 模型可以开发成几种不同的形式，包括 Logo 的 ReLogo 方言、点击式流程图、Groovy 或 Java，所有这些都可以流畅交错，也可以导入 NetLogo 模型。

Repast Simphony 已成功应用于许多应用领域，包括社会科学、消费品、供应链、未来可能的氢能基础设施和古代行人交通等。”

# ajax - Comet 与当前技术的兼容性

> ID：523546
> 
> 赞同：5
> 
> 时间：2009-02-07T09:57:13.613
> 
> 标签：ajax, http, comet, server-push

我听说我可以使用[Comet](http://en.wikipedia.org/wiki/Comet_(programming))作为服务器推送技术以及我的 Ajax 代码来提高我的 Web 应用程序的性能。

Comet 技术有多成熟？

所有 Web 服务器、编程语言和浏览器都支持它吗？

使用 Comet 的缺点是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-08T05:37:11.533

它很成熟，尽管我认为您应该将其更多地视为一种技术而不是技术。

据我所知，所有 Web 服务器都支持它，但如果您正在构建 Comet 应用程序，则需要研究和配置您的特定 Web 服务器，因为对资源的需求有点不同。具体来说，将有更多同时打开的连接到您的服务器。在编程语言支持方面，如果您选择的服务器语言有任何阻塞或等待机制，您可以支持 server-push。所有浏览器也都支持它，因为从浏览器的角度来看，这只是一个需要很长时间才能返回的 http(s) 连接。

有几个缺点，在浏览器世界中，最大的可能是某些浏览器将特定 URL 的打开连接数限制为两个。因此，如果您有一个服务器阻塞连接打开等待一些推送的数据，您将只有一个连接可供浏览器从服务器获取数据。这可以通过将您的资源分散到几个二级域以允许浏览器打开更多连接来缓解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-27T21:36:40.010

“所有 Web 服务器都支持”有点奇怪。大多数实现本身就是一个服务器，您需要找到一个与您要使用的语言集成的服务器。

也就是说，我在一家公司工作，该公司构建了一个与服务器集成的服务器，特别是 IIS。

如果您不想费心处理服务器集成（处理不同的语言、处理缩放等），请查看[websync](http://www.frozenmountain.com/websync) - 该服务可让您轻松集成任何语言，因为它是托管的，但支持通过您自己的服务器[代理](http://www.frozenmountain.com/documentation/proxying)请求因此您可以添加自己的业务逻辑、日志记录、权限等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T11:38:52.847

Comet 实际上在 AJAX 大肆宣传之前就已经在使用：它只是一个旧想法的新名称。长期以来，人们一直在使用隐藏的 iframe 来模拟服务器推送而没有问题。

# windows - 检测其他分区上的 Windows 操作系统

> ID：523553
> 
> 赞同：1
> 
> 时间：2009-02-07T10:01:23.840
> 
> 标签：windows, operating-system

检查当前计算机是否配置为双/多启动的好方法是什么。

如果我的活动 Windows 操作系统位于 D 驱动器上，我想检查其他驱动器 C:、E:、F: 等上是否安装了任何其他 Windows

基本上我想要安装的每个操作系统的程序文件和 Windows 文件夹的路径。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T10:18:10.250

我相信您会在一个名为**boot.ini**的文件中找到这些信息，该文件位于活动分区的根目录中。

该文件不包含驱动器号，而是分区号和磁盘号。

Windows Vista 具有 BCD，它是与 Windows 注册表格式相同的文件。

Program Files 文件夹位置可以在 Windows 注册表中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T13:03:24.707

检查维基百科中的这些页面：

*   [Windows Vista 启动过程](http://en.wikipedia.org/wiki/Windows_Vista_startup_process)（也适用于 Windows Server 2008）
*   [Windows NT 启动过程](http://en.wikipedia.org/wiki/Windows_NT_startup_process)（也适用于 Windows 2000、XP 和 Server 2003）

# cocoa-touch - 如何从基于导航的 iPhone 应用程序中删除导航栏？

> ID：523557
> 
> 赞同：2
> 
> 时间：2009-02-07T10:04:02.057
> 
> 标签：cocoa-touch

我是新手 iPhone 开发人员。我正在为 iPhone 开发一个基于导航的应用程序。我不在我的应用程序中使用 Interface Builder。我想从应用程序中删除导航栏。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T10:15:26.417

您可能正在寻找`setNavigationBarHidden:animated:`.`UINavigationController`

# c - 您知道 C 或其他语言的任何在线编译器吗？

> ID：523568
> 
> 赞同：15
> 
> 时间：2009-02-07T10:16:59.690
> 
> 标签：c, online-compilation

您知道的任何**在线 C 编译器都可以执行以下操作：**

*   在线编译执行C程序
*   文件处理
*   系统函数，如`exec()`, `system()`,`fork()`

或者任何不需要安装程序的编译器（我的意思是你可以复制粘贴一个文件夹来**轻松**运行编译器）

注意：请不要建议 Turbo CI 知道[codepad.org](http://codepad.org) (gcc) 上的一些在线编译器。我正在使用[codeide.com](http://www.codeide.com)，但我认为它现在已停止服务。如上所述，在线编译器将是您可以为我提供的最佳建议。

我的环境是Windows ...提前致谢。还邀请了有关其他语言编译器的任何建议

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T10:21:58.790

只需安装类似[tcc](http://bellard.org/tcc/)的东西。如果您要定期编译文件，那么在在线编译站点上搞乱是非常不值得的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T10:37:11.770

**Comeau**有一个[在线 C/C++ 编译器](http://www.comeaucomputing.com/tryitout/)，但主要是评估他们的编译器。

或**cygwin**

我宁愿推荐安装[cygwin](http://www.cygwin.com/)，你会得到一个类似 unix 的环境，带有 gcc。然后设置一个 Makefile - 甚至只是一个 shell 脚本 - 能够编译并不是什么大问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-07T10:45:49.303

您要求其他语言：这是**Lisp**的一种（不是编译器，而是解释器）

[Flash 中的在线 Lisp 解释器](http://www.solve-et-coagula.com/As3Lisp.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-10-24T20:07:23.433

[转机](http://rextester.com/runcode)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-07-28T09:26:58.840

也许我的回答有点晚了，但我们已经创建了一个在线编译器和 IDE，您可以在其中仅使用浏览器运行和创建文件。

目前我们支持几种语言（C、C++、ObjC、Java、Pascal、Fortran）和一个简单的文件系统，但我们将在不久的将来启用更多功能以更好地编码和调试。

目前提供的所有功能都是完全免费的，无需注册（您可以注册以保持文件在线）。

您可以在这里尝试我们的服务：[www.sourcelair.com](http://www.sourcelair.com)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-07T11:46:56.497

[**DJGPP 公共访问交叉编译器**](http://www.delorie.com/djgpp/compile/)（C/C++，DOS32，基于 GCC）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-19T20:27:30.667

另一个在线编译器：

[http://cmpe150-1.cmpe.boun.edu.tr](http://cmpe150-1.cmpe.boun.edu.tr)

它支持语法高亮、缩进等。我把它写成我的硕士论文的一部分

PS：没有测试fork命令

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-10-23T05:39:37.763

我们在这里有另一个 C 和 C++ 编译器：http: [//www.codepad.org/](http://www.codepad.org/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-07T16:02:23.893

I have nothing for C. For other languages, this is a [ruby interpreter](http://tryruby.hobix.com/). But honestly the best online development environment is the browser itself. Javascript is an advanced language. Combined with technologies like CSS and DHTML and frameworks like jQuery or Prototype you can build graphics applications. It is not hard to find debuggers (like Firebug) also.

Of course you can't interact with the file system. To overcome this you could write a plug-in for a browser (notably Firefox). There are many resources available for this and although it is not as straight forward as pure javascript, it is easier than most people believe.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-07T03:05:50.397

C++ 更好的列表之一是[`isocpp Getting Started`](http://isocpp.org/get-started)page。不幸`Cameau's`的是，现在似乎被禁用了。`LiveWorkspace`已经处于维护模式有一段时间了，不清楚什么时候回来，这很不幸，因为它有一个简单的界面，而且它什么时候工作允许你在 之间切换`gcc`，`clang`而且`intel`非常容易。

剩下的那些[`Coliru`](http://coliru.stacked-crooked.com/)是最强大的，你有一个完整的命令行可用，你可以保存文件，因此在你的项目中使用多个文件。

该`isocpp`列表不知何故丢失了[`codepad`](http://codepad.org/)，虽然相当原始，但`Coliru`允许您使用[`boost`](http://www.boost.org/).

`Coliru`，`ideone`并且`codepad`都支持许多其他语言。`ideone`和支持的语言列表`codepad`非常大，在主页上很明显，`Coliru`您没有列表，但除此之外`C`，`C++`它还支持`python`,`perl`和`ruby`.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-10-12T04:09:14.273

对于 Python 和 Sage，请尝试[http://live.codenode.org](http://live.codenode.org)。它也是在 BSD 许可下开源的，因此您可以在自己的计算机上下载并运行它，更多信息在这里：[http ://codenode.org](http://codenode.org)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-07-28T09:34:59.990

只是一个建议。

我不知道你为什么不想简单地安装一个编译器。但是，您是否考虑过使用便携式设备的可能性？

[http://en.wikipedia.org/wiki/Portable_C_Compiler](http://en.wikipedia.org/wiki/Portable_C_Compiler)

最好的，斯特

# apache-flex - 如何使 Canvas 在 Flex 中剪辑其内容？

> ID：523571
> 
> 赞同：6
> 
> 时间：2009-02-07T10:19:34.367
> 
> 标签：apache-flex, canvas, clipping

我使用 moveTo 和 lineTo 图形方法在 Canvas 对象上画了一条线。如果线条的一端位于 Canvas 之外，则线条会溢出并绘制在应用程序中的其他元素之上或之下。

如何使 Canvas 将线条包含在其内部？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T10:57:30.153

前段时间我遇到了类似的问题。您需要在画布中嵌入另一个容器，并在其中绘制原始图形。我相信这是因为 Canvas 组件只剪辑子组件，而不是原始图形。

此处示例：http: [//www.adobe.com/cfusion/webforums/forum/messageview.cfm](http://www.adobe.com/cfusion/webforums/forum/messageview.cfm?forumid=60&catid=585&threadid=1421196) ?forumid=60&catid=585&threadid=1421196 。它在页面的一半左右包含一些示例代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T02:19:49.613

```
<mx:Canvas id="canvas" top="0" right="51" left="0" bottom="32">
<mx:Canvas x="-1" y="0" width="0" height="0"> <!-- This is a HACK to make the canvas clip -->
</mx:Canvas>
</mx:Canvas> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:27:19.207

看起来这可能有用：

[http://forums.adobe.com/message/199071#199071](http://forums.adobe.com/message/199071#199071)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-03T12:22:52.910

推荐答案中的链接已损坏。我通过在我的画布内放置另一个比外部画布大的画布解决了这个问题。

例子：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" applicationComplete="onComplete()">
    <mx:Script><![CDATA[
        private function onComplete():void
        {
            canvas.graphics.lineStyle(1);
            canvas.graphics.moveTo( -100, -100);
            canvas.graphics.lineTo(400, 400);
        }
    ]]></mx:Script>
    <mx:Canvas  id="window"
                height="300" 
                width="300" 
                clipContent="true" 
                horizontalScrollPolicy="off" 
                verticalScrollPolicy="off" 
                backgroundColor="white">
        <mx:Canvas id="canvas" width="301" height="301">
        </mx:Canvas>
    </mx:Canvas>
</mx:Application> 
```

如果要在运行时调整窗口 Canvas 的大小，请添加一个 resize 事件侦听器来调整画布 Canvas 的大小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-08T13:13:50.770

我刚刚开发了一个 Flex Box 组件，它充当了一个常规的组件容器，但绘制了一个圆角矩形背景，另一个圆角矩形表示填充级别。为此，我需要夹住不应填充的上部。由于圆角不匹配，因此无法将填充矩形绘制到填充高度。

我学到的是：

*   我创建了一个 Canvas 组件，仅用于绘制边界为 0/0 和框的宽度/高度的填充级别
*   我通过 addChildAt() 将该画布添加到索引 0 处的 Box
*   我将该画布的 includeInLayout 属性设置为 false，因为它不应该参与 Box 本身的布局，而是充当顶部的一些浮动绘图窗格
*   然后我添加了另一个画布作为该填充画布的遮罩（addChild（），并设置遮罩属性）

这是一些代码：

```
override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
{
    // super
    super.updateDisplayList(unscaledWidth, unscaledHeight);

    // prep
    var g:Graphics = this.graphics;
    var fgColor:int = this.getStyle("fillColor");
    var bgColor:int = this.getStyle("backgroundFillColor");
    var radius:int = this.getStyle("cornerRadius");

    // clear
    g.clear();

    // draw background
    g.beginFill(bgColor, 1);
    g.drawRoundRect(0, 0, unscaledWidth, unscaledHeight, radius, radius);
    g.endFill();

    // draw fill level
    if (this._fillLevel > 0) {
        var fillHeight:int = int(unscaledHeight * this._fillLevel);

        // extra component for drawing fill-level, so we can apply mask just to this
        if (this._fillLevelCanvas == null) {
            this._fillLevelCanvas = new Canvas();
            this._fillLevelCanvas.x = 0;
            this._fillLevelCanvas.y = 0;
            this._fillLevelCanvas.includeInLayout = false;
            this.addChildAt(this._fillLevelCanvas, 0);
        }
        this._fillLevelCanvas.width = unscaledWidth;
        this._fillLevelCanvas.height = unscaledHeight;

        // mask
        if (this._fillLevelMask == null) {
            this._fillLevelMask = new Canvas();
            this._fillLevelMask.x = 0;
            this._fillLevelMask.y = 0;
            this._fillLevelCanvas.addChild(this._fillLevelMask);
            this._fillLevelCanvas.mask = this._fillLevelMask;
        }
        this._fillLevelMask.width = this.width;
        this._fillLevelMask.height = this.height;
        this._fillLevelMask.graphics.beginFill(0xFFFFFF); 
        this._fillLevelMask.graphics.drawRect(0, this.height-fillHeight, this._fillLevelMask.width, this._fillLevelMask.height); 
        this._fillLevelMask.graphics.endFill();                 

        this._fillLevelCanvas.graphics.beginFill(fgColor, 1);
        this._fillLevelCanvas.graphics.drawRoundRect(0, 0, unscaledWidth, unscaledHeight, radius, radius);
        this._fillLevelCanvas.graphics.endFill();
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-02-26T10:14:10.547

将 Canvas 的 ClipToBounds 属性设置为 true：

```
<Canvas ClipToBounds="True">... Content ...</Canvas> 
```

# macos - 如何通过 ftp 传输具有多个子目录的目录？

> ID：523572
> 
> 赞同：9
> 
> 时间：2009-02-07T10:20:54.580
> 
> 标签：macos, ftp, directory

我是一个新手用户，试图弄清楚如何传输包含多个子目录的 48 Gb 目录（从 Mac 终端命令行），这些子目录本身包含多个目录，......我不想确认每个子目录的传输都带有 'y/n' 提示。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-07T10:34:24.477

使用`mput *`或`mget *`。当要求确认时，键入`a`而不是`y`. 这与`y`为一个命令回答每个文件相同。

您还可以使用该`prompt`命令更改提示行为。

您将在手册页中找到更多信息。在终端类型中：`man ftp`

顺便说一句，这不是一个真正的编程问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-07T10:27:57.437

ftp -i 关闭提示。mget * 获取所有文件。

```
    微软视窗 [版本 6.1.7000]
    版权所有 (c) 2006 Microsoft Corporation。版权所有。

    C:\so>ftp -i **主机名**
    连接到主机名。
    220 微软 FTP 服务
    用户（主机名：（无））：**用户名**
    331 用户名需要密码。
    密码：
    230 用户名已登录。
    ftp> **cd 日志**
    250 CWD 命令成功。
    ftp> **ls**
    200 PORT 命令成功。
    150 打开文件列表的 ASCII 模式数据连接。
    meetmap.com
    226 传输完成。
    ftp：在 0.01 秒 11.50 KB/秒内收到 115 个字节。
    ftp> mget *
    200 类型设置为 A。
    200 PORT 命令成功。
    150 打开 meetmap.com/ex090131.log 的 ASCII 模式数据连接
        （5490 字节）。

    226 传输完成。
    ...（一堆更多文件）
    ftp> **退出**
    221

    C:\所以>

```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-20T11:39:14.433

我相信问题是针对 FTP 目录而不是文件；并且据我所知（我根本不是专家）你不能使用 mget/mput 保存 FTP 目录以使用 tar 文件（在 unix ie 下）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T18:17:31.047

我个人喜欢[wget](http://www.gnu.org/software/wget/)和[wput](http://wput.sourceforge.net/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-19T13:57:39.380

您还可以使用 scp 从 shell 提示符传输整个目录。例如：

MyMachine$ scp -r FromMachine:[目录路径] [目标路径]

这会将整个目录及其内容复制到 MyMachine 上的目标路径。有关详细信息，请参阅“man scp”。

恕我直言，用户应该使用 sftp 和 ssh，因为 FTP 以明文形式发送密码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-09-22T19:50:31.440

最快和最有效的方法是 tar 压缩它和 sftp 并在另一端解压它。以下是步骤：

1.  转到终端并 cd 到要移动的目录。
2.  tar -zcvf yourFolder.tar.gz youFolder/
3.  然后 sftp 和 cd 到目录并执行 mget 或 mput yourFolder.tar.gz
4.  tar -zxvf yourFolder.tar.gz

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-07T10:29:22.303

ncftp 应该能够递归地获取文件。或者，使用任何无限图形拖放 ftp 客户端。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-23T20:44:18.150

这对我来说效果很好：

$`ncftp gnu.ftp.org`

$`ncftp /old-gnu/Manuals > get -R -T sharutils`

# java - 有没有办法提高 Java 编译器的多核/多处理器性能？

> ID：523575
> 
> 赞同：22
> 
> 时间：2009-02-07T10:23:52.703
> 
> 标签：java, multicore, javac

我的同事注意到，当 javac 编译时，它只使用一个内核。有没有像 Java 的 gcc 中的 -j 命令一样的东西，可以让我们跨内核或处理器分配编译器工作负载？如果不是，您认为这将成为可能吗，或者由于 Java 的设计而存在某种基本限制？

环境是带有 Sun J2SE 1.6.0.11 jdk 的 Linux。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T11:26:34.403

虽然不完全是您问题的答案，但像[ant](http://ant.apache.org/manual/Tasks/parallel.html)这样的一些构建环境也支持构建的并行化，因此如果您的依赖关系图允许，您可以同时运行多个 javac。

# javascript - 带有 Python 问题的 Google Apps HTTP 流式传输

> ID：523579
> 
> 赞同：0
> 
> 时间：2009-02-07T10:27:18.530
> 
> 标签：javascript, python, streaming

我这里有个小问题：

前段时间我使用 PHP 代码实现了 HTTP 流，类似于此页面上的内容：

[http://my.opera.com/WebApplications/blog/show.dml/438711#comments](http://my.opera.com/WebApplications/blog/show.dml/438711#comments)

我用非常相似的解决方案获得数据。现在我尝试使用此页面中的第二个代码（在 Python 中），但无论我做什么，在一切完成后，我都会从 python 服务器收到 responseText。下面是一些python代码：

```
print "Content-Type: application/x-www-form-urlencoded\n\n"

i=1
while i<4:
 print("Event: server-time<br>")
 print("data: %f<br>" % (time.time(),))
 sys.stdout.flush()
 i=i+1
 time.sleep(1) 
```

这是Javascript代码：

```
ask = new XMLHttpRequest();
ask.open("GET","/Chat",true);
setInterval(function()
{
if (ask.responseText) document.write(ask.responseText);
},200);
ask.send(null); 
```

有人知道我做错了什么吗？我怎样才能一个接一个地收到那些该死的消息，而不仅仅是在while循环结束时收到所有消息？感谢您在这里的任何帮助！

编辑：

我忘记添加的主要内容：服务器是谷歌应用服务器（我不确定谷歌自己的实现），这是一个带有一些解释的链接（我认为嗯）：

[http://code.google.com/intl/pl-PL/appengine/docs/python/gettingstarted/devenvironment.html](http://code.google.com/intl/pl-PL/appengine/docs/python/gettingstarted/devenvironment.html) [http://code.google.com/intl/pl-PL/appengine/docs/whatisgoogleappengine.html](http://code.google.com/intl/pl-PL/appengine/docs/whatisgoogleappengine.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T18:40:55.163

它极有可能是 App Engine 缓冲输出。快速搜索发现： [http ://code.google.com/appengine/docs/python/tools/webapp/buildingtheresponse.html](http://code.google.com/appengine/docs/python/tools/webapp/buildingtheresponse.html)

> 输出流缓冲内存中的所有输出，然后在处理程序退出时发送最终输出。webapp 不支持将数据流式传输到客户端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T17:10:36.720

这看起来像一个 cgi 代码——我想 Web 服务器缓冲来自 cgi 处理程序的响应。因此，选择正确的工具并进行正确的配置实际上是一个问题。

我建议使用 wsgi 服务器并利用 wsgi 的流式支持。

这是您转换为 wsgi 应用程序的示例代码：

```
def app(environ, start_response):
    start_response('200 OK', [('Content-type','application/x-www-form-urlencoded')])
    i=1
    while i<4:
        yield "Event: server-time<br>"
        yield "data: %f<br>" % (time.time(),)
        i=i+1
        time.sleep(1) 
```

有很多 wsgi 服务器，但这里有一个来自 python std lib 的参考示例：

```
from wsgiref.simple_server import make_server

httpd = make_server('', 8000, app)
httpd.serve_forever() 
```

# silverlight-2.0 - 如何提升备受期待的 Silverlight 安装体验？

> ID：523596
> 
> 赞同：8
> 
> 时间：2009-02-07T10:47:56.897
> 
> 标签：silverlight-2.0

我想了解必须安装 Silverlight 才能使用我一直在制作的 Silverlight 应用程序的普通用户体验。

我用干净的浏览器启动了一个虚拟机，并假装“是我爸爸”只是想查看该网站，然后遇到“您必须安装 Silverlight”按钮。我在下面写下了 Firefox 和 Internet Explorer 的所有步骤。

一般来说**，两种浏览器中的 Silverlight 安装都令人困惑、不安和可怕**：由于存在大量安全警告，并且除了中止安装之外没有其他选项，不幸的是，您会误以为 Silverlight 是一种“可能感染并用病毒和恶意代码损害您的计算机”，除了同意安装它并希望获得最好的结果外，没有明显的选择来保护您的计算机。

另外，我发现你必须下载一个文件，然后去找它，然后执行它，这是我家中许多人（我上一代）会感到沮丧的一个步骤，并且可能是一个原因为什么他们从来没有在他们的机器上安装 Silverlight。

问题：

*   作为一名程序员，我有没有办法让这种体验变得更好？
*   未来版本的浏览器会附带 Silverlight 吗？
*   是我们未来对 Flash、Silverlight 和其他第三方浏览器插件的一键式、一次安全消息安装，或者这是我们希望获得的最佳用户体验：

**Silverlight 在 FIREFOX 3 中的安装经验：**

*   请参阅：“安装 Microsoft Silverlight”的图形按钮（我将其放入对象标签中）
*   点击按钮
*   请参阅：“您已选择安装 Silverlight 2.0” [保存文件] [取消]
*   点击[保存文件]
*   点击[保存]
*   （坐在那里想知道发生了什么）
*   ...最终问某人该做什么或幸运并右键单击下载消息并选择“打开”
*   请参阅：“silverlight 2.0.exe”是一个可执行文件...可能包含病毒...恶意代码...损害您的计算机...谨慎使用...您确定吗？... [确定] [取消]
*   尽管担心我的电脑会感染“病毒和恶意代码”，我还是点击了[确定]
*   请参阅：“安全警告...可能会潜在地损害您的计算机...” [运行] [取消]
*   恐惧地点击“运行”
*   说：“提取文件...安装 Silverlight 2” 一键：[立即安装]
*   点击【立即安装】
*   说：“Silverlight 正在您的计算机上安装”，然后显示复选框“启用 microsoft 更新（推荐）......隐私声明......” [下一个]
*   点击下一步]
*   说：“安装成功，您可能需要刷新网页...” [关闭]
*   点击【关闭】
*   返回网页并单击浏览器上的刷新按钮
*   我看到silverlight应用程序，成功。

**Silverlight在INTERNET EXPLORER 6中的安装经验：**

*   请参阅：“安装 Microsoft Silverlight”的图形按钮（我将其放入对象标签中）
*   点击按钮
*   请参阅：“为了帮助保护您的安全...阻止此站点将文件下载到您的计算机”和“您是否注意到信息栏”[OK]
*   点击【确定】
*   （坐在那里不知道该怎么办）
*   最后点击顶部的栏，查看“有什么风险？” 还是点击“下载文件”
*   请参阅：“安全警告...可能会潜在地损害您的计算机...” [运行] [取消]
*   点击【运行】
*   观看下载，15 秒
*   请参阅：“安全警告...可能会损害您的计算机” [运行] [不运行]
*   点击【运行】
*   一键说“安装 Silverlight 2”：[立即安装]
*   点击【立即安装】
*   说：“Silverlight 正在您的计算机上安装”，然后显示复选框“启用 microsoft 更新（推荐）......隐私声明......” [下一个]
*   点击下一步]
*   说：“安装成功，您可能需要刷新网页...” [关闭]
*   点击【关闭】

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T07:06:20.620

好吧，考虑到您现在知道用户将要执行的步骤，您可以为用户创建一个帮助页面。诚然，这不是最好的事情（显然，简化的安装体验会更好），但至少用户可以轻松找到正在发生的事情的步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T15:11:44.743

当我第一次开始我的 Silverlight 体验时，我发现观看[这个](http://silverlight.net/learn/learnvideo.aspx?video=57016)关于“Silverlight 安装体验”的视频非常有趣和有用。它为您提供了一些关于如何改进它并避免一些痛苦的建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-10T21:14:21.693

这是一篇文章，通过自定义安装链接有助于使其更容易：http: [//www.netmag.co.uk/zine/expression/create-a-custom-silverlight-install-experience](http://www.netmag.co.uk/zine/expression/create-a-custom-silverlight-install-experience)

# c# - 需要递归函数来生成唯一的字符串组合

> ID：523597
> 
> 赞同：2
> 
> 时间：2009-02-07T10:48:35.960
> 
> 标签：c#, function, recursion

我有一些来自数据库（A、B、C、D、E、F、G、H）的唯一字符串（比如 9 个，不是不确定的），我想创建这些字段的唯一组合来填充列表框，以便用户可以选择这些字符串字段的单个或不同组合，例如 A,B,C,D,E,F,G,H, AB,AC,AD,AE,AF,AG,AH,AC,AD,AE,AF,AG, AG,AH,... ABC,ABD,ABE,ABF,ABG,ABH,ACD,ACE,ACF,ACG,ACH,.....

在 C# 中（win 应用程序）提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-07T10:54:54.607

我的第一选择是“使用 a`CheckedListBox`并让用户自己选择”——这将节省他们的理智......你想在长长的列表中寻找“ABCEFH”吗？）。

如果你想要字符串：只使用二进制算术怎么样？即使用一个数字（位长根据元素的数量），并简单地保持递增，包括每次设置的位？所以在 C# 中，例如：

```
static void Main()
{
    foreach (string value in GetCombinations(
        "A", "B", "C", "D", "E", "F", "G", "H"))
    {
        Console.WriteLine(value);
    }
}
static IEnumerable<string> GetCombinations(params string[] tokens)
{
    ulong max = (ulong) 1 << tokens.Length;
    StringBuilder builder = new StringBuilder();
    // test all bitwise combinations
    for (ulong value = 0; value < max; value++)
    {
        builder.Length = 0;
        ulong tmp = value;
        // include the tokens for the set bits
        for (int i = 0; i < tokens.Length; i++)
        {
            if ((tmp & (ulong)1) == 1) builder.Append(tokens[i]);
            tmp >>= 1;
        }
        yield return builder.ToString();
    }
} 
```

如果您希望按照示例的顺序排列数据，LINQ 很有帮助：

```
 foreach (string value in GetCombinations(
          "A", "B", "C", "D", "E", "F", "G", "H")
        .OrderBy(s=>s.Length)
        .ThenBy(s=>s))
    {
        Console.WriteLine(value);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T02:54:15.880

公共类组合 { 静态 int 计数 = 0;

```
public static void main(String[] args)
{
    StringBuilder out = new StringBuilder("");
    StringBuilder str = new StringBuilder("aabcbd");

    combination(str, out, 0);
    System.out.println("The Count : " + count);
}

// Recursive
static void combination(StringBuilder in, StringBuilder out, int start)
{
    int len = in.length();

    for (int i = start; i < len; i++)
    {
        if (isAppended(in, out, i))
        {
            continue;
        }

        out.append(in.charAt(i));
        count++;
        System.out.println(out);
        combination(in, out, i + 1);
        out.deleteCharAt(out.length() - 1);
    }
}

static boolean isAppended(StringBuilder in, StringBuilder out, int index)
{
    int inCount = 0;
    int outCount = 0;

    int i = 0;
    int len = out.length();
    char ch = in.charAt(index);

    for (i = 0; i < index; i++)
    {
        if (in.charAt(i) == ch)
        {
            inCount++;
        }
    }

    for (i = 0; i < len; i++)
    {
        if (out.charAt(i) == ch)
        {
            outCount++;
        }
    }

    if (inCount != outCount)
    {
        return true;
    }

    return false;
} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T10:54:08.227

这就像以'n'为底数计算整数......应该不难。

# jquery - Jquery - 在 IE6 上无法正确显示对话

> ID：523598
> 
> 赞同：0
> 
> 时间：2009-02-07T10:49:42.557
> 
> 标签：jquery, html, css

我正在尝试使用 bgiform 但它似乎没有效果。IE 中的文本在显示时被推离对话框的屏幕。它在 FF 中运行良好。有任何想法吗？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Zoleris</title>
<link href="style.css" rel="stylesheet" type="text/css" />
<link href="jquery-ui-themeroller/theme/ui.theme.css" rel="stylesheet" type="text/css" />

<script type="text/javascript" src="jquery-1.3.1.js"></script>
<script type="text/javascript" src="bgiframe_2.1.1/jquery.bgiframe.js"></script>
<script type="text/javascript" src="jquery-ui-personalized-1.5.3.js"></script>
<script type="text/javascript">                                         
  $(document).ready(
  function()
  {
    $("#block").dialog({
    bgiframe: true});
  }
  );
 </script>
<style>
#block {
    width: 150px;
    height: 70px;
    margin: 10px;
}
</style>
</head>
<body>
<div id="block" title="title">blah</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T12:42:03.283

这个[库](http://plugins.jquery.com/project/bgiframe)已经过时了，它被标记为`Metaplugin`

`Metaplugins`具有以下特点：

*   你可以用 jQuery 实现自己
*   **跨浏览器实现可能很困难**
*   用户不会注意到他们

请参阅[发行说明](http://plugins.jquery.com/node/250)

> 现在它适用于 jQuery **1.1.3**

我建议你看看其他这样的插件。

# c# - 如何在安装时设置应用程序设置（通过安装程序类）

> ID：523619
> 
> 赞同：6
> 
> 时间：2009-02-07T11:20:10.203
> 
> 标签：c#, setup-project, appsettings

我有一个具有 Installer 类的 Visual Studio 安装项目。在安装程序类中，我设置如下：

```
MessageBox.Show(Properties.Settings.Default.MySetting);

Properties.Settings.Default.MySetting = "Foo";
Properties.Settings.Default.Save();

MessageBox.Show(Properties.Settings.Default.MySetting); 
```

问题是，即使我知道这段代码正在执行（我正在做其他事情），设置永远不会设置！

消息框确实表明正在设置该值，但是当我转到`.config`文件时，该值仍然是空白的！

任何人有任何想法为什么和/或可能的解决方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T23:05:24.493

我为我的安装人员所做的是使用 App.Config 中的“文件”属性。appSettings 块采用“文件”属性，如下所示：

```
<appSettings file="user.config">
    <add key="foo" value="some value unchanged by setup"/>
</appSettings> 
```

“文件”属性有点像 CSS，因为最具体的设置胜出。如果您在 user.config 和 App.config 中定义了“foo”，则使用 user.config 中的值。

然后，我有一个配置生成器，它使用字典中的值将第二个 appSettings 块写入 user.config（或您想要调用的任何内容）。

```
using System.Collections.Generic;
using System.Text;
using System.Xml;

namespace Utils
{
    public class ConfigGenerator
    {
        public static void WriteExternalAppConfig(string configFilePath, IDictionary<string, string> userConfiguration)
        {
            using (XmlTextWriter xw = new XmlTextWriter(configFilePath, Encoding.UTF8))
            {
                xw.Formatting = Formatting.Indented;
                xw.Indentation = 4;
                xw.WriteStartDocument();
                xw.WriteStartElement("appSettings");

                foreach (KeyValuePair<string, string> pair in userConfiguration)
                {
                    xw.WriteStartElement("add");
                    xw.WriteAttributeString("key", pair.Key);
                    xw.WriteAttributeString("value", pair.Value);
                    xw.WriteEndElement();
                }

                xw.WriteEndElement();
                xw.WriteEndDocument();
            }
        }
    }
} 
```

在您的安装程序中，只需在您的安装方法中添加如下内容：

```
string configFilePath = string.Format("{0}{1}User.config", targetDir, Path.DirectorySeparatorChar);

IDictionary<string, string> userConfiguration = new Dictionary<string, string>();

userConfiguration["Server"] = Context.Parameters["Server"];
userConfiguration["Port"] = Context.Parameters["Port"];

ConfigGenerator.WriteExternalAppConfig(configFilePath, userConfiguration); 
```

我们将它用于我们的测试、训练和生产服务器，所以我们所要做的就是在安装过程中指定机器名称和密码，一切都为我们处理好了。它曾经是一个 3 小时的过程，包括通过多个配置文件来设置密码。现在它几乎完全自动化了。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T11:22:39.013

老实说，我不知道在安装过程中是否支持此功能-但如果支持，请确保您正在调用`Save()`.`Settings.Default`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T09:02:06.200

好吧，最终我放弃了，并在安装应用程序后使用了 RunOnce 类型的方法来执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-13T20:09:31.290

简短的回答是安装程序类不支持它。您只需要了解安装程序类方法是从从系统目录运行的 msiexec.exe 调用的，并且该环境不可能知道您在完全不知道的目录中的某处有一个设置文件。这就是为什么它使用显式转到文件的安装位置并在那里更新它的代码。

# iphone - 在 iPhone 应用程序中存储密码

> ID：523627
> 
> 赞同：25
> 
> 时间：2009-02-07T11:32:17.930
> 
> 标签：iphone, passwords

我有一个基于“实用程序应用程序”模板的简单应用程序。它检索受密码保护的 XML 文件（通过 NSXMLParser）。

我想允许用户在“FlipsideView”中设置用户名和密码，我该怎么做？

我有基础知识，两个 UITextField 框，当视图加载时（使用该方法），其值设置为固定值`viewWillAppear`，并且在视图关闭时设置为 NSLog'd（`NSLog`显然，这只是用于测试，在`viewWillDisappear`方法中）

如何存储数据？我已经查看了开发人员文档，似乎我应该使用`NSUserDefaults`..？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-07T17:19:44.050

我同意本。这*正是*钥匙串的用途。

在任何情况下，我都不会按照 dbr 的建议将密码存储在默认值中。这是非常不安全的。您实际上是在公开存储您的密码。

除了苹果的示例代码，我还推荐 Buzz Anderson 的 Keychain 代码： [iPhone Keychain Code](http://log.scifihifi.com/post/55837387/simple-iphone-keychain-code)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-07T12:22:16.817

这正是 Apple 开发钥匙串的目的。使用钥匙串，您可以以加密形式存储您的密码。看看 Apple 的[GenericKeychain](http://developer.apple.com/iphone/library/samplecode/GenericKeychain/index.html)示例。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-07T11:36:26.940

啊哈，NSUserDefaults 似乎有效，而且使用简单，**但一点也不安全**：

`password`是 UITextField 的 IBOutlet。

```
- (void)viewWillAppear:(BOOL)animated
{
    NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
    NSString *pword = [prefs objectForKey:@"password"];
    password.text = uname;
}

- (void)viewWillDisappear:(BOOL)animated{
    NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
    [prefs setObject:password.text forKey:@"password"];
} 
```

密码以纯文本形式存储在 plist 中，因此其他人很容易访问..但这对于存储非敏感设置很有用。

我最终使用它来存储*用户*名字段，并使用August's answer中的[SFHFKeychainUtils 钥匙串代码存储密码。](http://log.scifihifi.com/post/55837387/simple-iphone-keychain-code)

# php - 关于签名 cookie 而非会话的提示

> ID：523629
> 
> 赞同：12
> 
> 时间：2009-02-07T11:34:57.693
> 
> 标签：php, security, session, cookies

我正在考虑放弃 PHP `$_SESSION`（即服务器端会话处理，以添加一些与语言无关的风格）并改用签名 cookie，因为我听说过很多关于它们的好消息（Flickr 使用它们，所以它们应该很好对我来说也足够了）。

我了解该技术的基本背景：自由使用 cookie 将键值对从客户端传递到服务器，并对其进行签名以确保值不会被篡改。

但是什么是实施签名部分的好方法呢？还; 由于流量可能是 HTTP，有没有一种好方法可以使用这种方法发送敏感数据（例如用户密码），同时防止 cookie 窃取和/或篡改？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-07T11:45:18.547

## 何苦？

我不会将这种技术用于敏感数据。不过，它可以与常规会话结合使用 - 您可以为客户端提供具有正常会话 ID 的 cookie，但也可以在每个页面上包含应用程序所需的所有键/值对。这样，您可以避免为每个页面请求访问会话存储。

您的目标应该是保持数据量非常紧凑，因为它会随每个请求一起发送。

考虑到这一点，接下来...

## 使用哈希对数据进行签名

如果数据不敏感，您可以使用由键/值对和共享机密组合而成的[sha1哈希对值进行签名。](http://php.net/sha1)例如

```
$values=array(
  'user_id'=>1,
  'foo'=>'bar'
);
$secret='MySecretSalt';

$plain="";
foreach($values as $key=>$value)
{
    $plain.=$key.'|'.$value.'|';
}
$plain.=$secret;
$hash=sha1($plain); 
```

现在给客户端一个包含所有值和哈希的 cookie。您可以在显示 cookie 时检查哈希值。如果您根据客户端提供的值计算的哈希值与预期的哈希值不匹配，则您知道这些值已被篡改。

## 加密敏感数据

对于敏感数据，您需要加密这些值。查看[mcrypt](http://uk.php.net/manual/en/book.mcrypt.php)扩展，它提供了很多加密功能。

## 饼干盗窃

关于 cookie 窃取，如果您将用户凭据放入 cookie 并信任它，那么获得该 cookie 的人可以冒充该用户，直到更改密码。一个好的做法是记住您如何对用户进行身份验证，并且仅在用户明确登录时才授予某些权限。例如，对于论坛，您可以让某人发帖，但不能更改他们的帐户详细信息，例如电子邮件地址。

“自动登录”cookie 还有其他技术，包括为此类 cookie 提供一个您只允许使用一次的令牌值。这是一篇关于该技术[的好文章。](http://jaspan.com/improved_persistent_login_cookie_best_practice)

您还可以查看在签名 cookie 中包含客户端 IP，如果它与呈现 cookie 的 IP 不匹配，您可以让他们再次登录。这提供了更多保护，但不适用于明显 IP 地址不断变化的人。您可以将其设为可选功能，并为用户提供选择退出的方式。只是一个无聊的想法，我还没有在实践中看到这样做:)

有关解释会话盗窃、劫持和固定的精彩文章，请参阅[Sessions and Cookies](http://www.devshed.com/c/a/PHP/Sessions-and-Cookies)，其中提供了更多可供尝试的技术，例如使用 User-Agent 标头作为附加签名。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-08T23:38:36.693

我正是为此目的制作了[CookieStorage 。](https://github.com/mrclay/old-misc/blob/master/php/MrClay/CookieStorage.php)所有存储的值都使用您的私钥通过 RIPEMD160 散列进行安全签名（并随时间加盐），并可选择使用 RIJNDAEL256 进行加密。

每个值都与时间戳一起存储，该时间戳是可检索的。

[签名示例](http://mrclay.org/code_trunk/php/MrClay/CookieStorage/test.php)。
[加密示例](http://mrclay.org/code_trunk/php/MrClay/CookieStorage/test2.php)。

如果您愿意，可以使用您选择的散列/加密/解密函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-28T09:03:17.293

**PHP中的签名cookie**

这个问题的其他答案有点过时了。PHP 5.2 向函数添加了`httponly`参数`setcookie`，有效地添加了原生签名 cookie 支持。根据`setcookie`函数[httponly 参数文档](http://php.net/manual/en/function.setcookie.php)：

> “当 [设置为] TRUE 时，cookie 将只能通过 HTTP 协议访问。这意味着 cookie 将无法通过脚本语言（例如 JavaScript）访问。有人建议此设置可以有效地帮助减少身份通过 XSS 攻击进行盗窃（尽管并非所有浏览器都支持），但这种说法经常有争议”

将此参数设置为 true 还将禁用使用其他基于浏览器的工具（例如 Chrome 的 DevTools）编辑此 cookie 的功能。为了使签名的 cookie 更加安全，我强烈建议缩小它使用的路径或域。`path`您可以使用和`domain`参数指定那些。当然，`secure`如果您的网站是通过 HTTPS 加载的，那么使用该参数保护 cookie 永远不会受到伤害。结果将是这样的一行：

```
setcookie('signedCookie','uneditable value here', 0, '/', 'www.example.com', TRUE , TRUE); 
```

**为什么要使用签名 cookie？**

事实上，在某些特定情况下，签名的 cookie 会有所帮助，而其他方法（例如会话）则无济于事。例如，假设有问题的网站/应用程序使用负载均衡器来提高性能。现在我们还假设负载均衡器有多个物理服务器，从中提供文件，并且粘性会话选项不可用。在这种情况下，签名 cookie 实际上是在 PHP 中保存状态的唯一安全方法。

# apache-flex - 从 Flex 访问浏览器 cookie

> ID：523633
> 
> 赞同：13
> 
> 时间：2009-02-07T11:39:20.070
> 
> 标签：apache-flex, session, cookies, vbulletin

我正在为私有 vBulletin 站点构建 Flex 小部件，Flex 小部件需要访问 vBulletin 服务器上的 XML 文件才能显示数据。

出于安全原因，XML URL 需要在来自 Flex 的 URL 请求中传递的 bbsessionhash cookie 中的值。Flex 小部件将嵌入用户已登录的私人区域，因此 Flex 请求将来自 cookie 所在的同一网站。

有什么方法可以直接在 Flex 中访问 c​​ookie？我不希望使用 ExternalInterface 从 JavaScript 中获取 cookie 数据，因为它可能会有点混乱（模板是由完全不同的开发团队开发的）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-07T12:02:54.860

我从来没有尝试过这个，但是[这个库](http://myflex.wordpress.com/2008/11/12/actionscript-cookie-util/)可能只是解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-09T16:11:11.540

根据 flash 或 flex cookie，开发人员可以使用共享对象，这是一种用于 flex 应用程序的 cookie。

示例代码片段如下

```
import flash.net.SharedObject;

// get/create the shared object with a unique name.
// If the shared object exists this grab it, if not
// then it will create a new one
var so: SharedObject = SharedObject.getLocal("UniqueName");

// the shared object has a propery named data, it's
// an object on which you can create, read, or modify
// properties (you can't set the data property itself!)
// you can check to see if it already has something set
// using hasOwnProperty, so we'll check if it has a var
// use it if it does, or set it to a default if it doesn't
if (so.data.hasOwnProperty("theProp"))
{
    trace("already has data! It reads: " + so.data.theProp);
}
else
{
    so.data.theProp = "default value";
    so.flush(); // flush saves the data
    trace("It didn't have a value, so we set it.");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-04T02:19:15.230

访问 Flex SharedObject 与访问浏览器 cookie 不同，要访问浏览器 cookie，您可以使用 ExternalInterface 类，请查看以下参考以查看示例：

[http://livedocs.adobe.com/flex/3/html/help.html?content=passingarguments_4.html](http://livedocs.adobe.com/flex/3/html/help.html?content=passingarguments_4.html)

关于如何使用 JavaScript 使用和控制 cookie 的参考可以在这里找到：

[http://www.quirksmode.org/js/cookies.html](http://www.quirksmode.org/js/cookies.html)

我将使用以下 Flex 代码：

```
var myCookie:String = ExternalInterface.call("getCookie('cookieName')"); 
```

在 HTML 中，我将添加以下 Javascript：

```
function getCookie(c_name) {
  var i,x,y,ARRcookies=document.cookie.split(";");
  for (i=0;i<ARRcookies.length;i++) {
    x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
    y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
    x=x.replace(/^\s+|\s+$/g,"");
    if (x==c_name) return unescape(y);
  }
} 
```

如果您需要更多帮助，还可以查看 Flex 文档。

# asp.net - 尝试在 Goddaddy 上使用 ManagedFusion Rewriter 时出现 System.Web.AspNetHostingPermission SecurityException

> ID：523636
> 
> 赞同：27
> 
> 时间：2009-02-07T11:42:53.853
> 
> 标签：asp.net, iis-7, codeplex

我想知道是否有人可以帮助我解决我在尝试让我的网站在 Goddaddy 上运行时遇到的问题。我正在尝试使用 ManagedFusion Rewriter ( [http://www.codeplex.com/urlrewriter/](http://www.codeplex.com/urlrewriter/) ) 使无扩展名的 url 重写工作 不幸的是，我收到以下错误：

> “/”应用程序中的服务器错误。安全异常描述：应用程序试图执行安全策略不允许的操作。要授予此应用程序所需的权限，请联系您的系统管理员或在配置文件中更改应用程序的信任级别。
> 
> 异常详细信息：System.Security.SecurityException：请求“System.Web.AspNetHostingPermission，System，Version=2.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”类型的权限失败。

源错误：

> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

堆栈跟踪：

```
[SecurityException: Request for the permission of type 'System.Web.AspNetHostingPermission, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.]
System.Security.CodeAccessSecurityEngine.Check(Object demand, StackCrawlMark& stackMark, Boolean isPermSet) +0
System.Security.CodeAccessPermission.Demand() +59
System.Web.Hosting.HostingEnvironment.get_ApplicationID() +61
IIS7Injector.TraceManager.TraceEvent(TraceEventType eventType, String message) +62
IIS7Injector.ConfigManager.IsSkippedUrl(HttpRequest request, String ContentType) +38
IIS7Injector.InjectedContentStream.Write(Byte[] buffer, Int32 offset, Int32 count) +153
ManagedFusion.Rewriter.FormActionFilter.Write(Byte[] buffer, Int32 offset, Int32 count) +485
System.Web.HttpWriter.FilterIntegrated(Boolean finalFiltering, IIS7WorkerRequest wr) +265
System.Web.HttpResponse.FilterOutput() +80
       System.Web.CallFilterExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +54
System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +64 
```

版本信息：Microsoft .NET Framework 版本：2.0.50727.1434；ASP.NET 版本：2.0.50727.1434

我在集成模式下使用 IIS 7 运行。我已按照此处自述文件中的说明修改了我的 web.config 文件：http: [//www.codeplex.com/urlrewriter/Release/ProjectReleases.aspx? ReleaseId=22618](http://www.codeplex.com/urlrewriter/Release/ProjectReleases.aspx?ReleaseId=22618)

非常感谢提前。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-08-16T13:55:20.630

我在新安装时遇到了同样的异常，将应用程序池标识更改为 NetworkService / aspnet 修复了它。

此外，在应用程序池上启用加载用户配置文件也有效。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-12-06T14:27:01.407

尝试以下操作：

应用程序池 -> 高级设置 -> 加载用户配置文件 = True

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-30T16:06:04.347

对我来说是：
1\. 取消阻止所有文件 [http://nicholasrogoff.wordpress.com/2010/09/01/how-to-bulk-unblock-files-in-windows-7-or-server-2008/](http://nicholasrogoff.wordpress.com/2010/09/01/how-to-bulk-unblock-files-in-windows-7-or-server-2008/)
2.重启应用程序池

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-15T11:19:54.390

造成此问题的一个原因是当您通过使用服务器从 Internet 下载应用程序来在服务器上发布您的应用程序这一完全奇怪的事情时。然后这些文件将被标记为来自 Internet，然后安全设置会阻止它们运行。

“从 Internet 下载”标记作为 NTFS 替代数据流存储在文件系统中。使用“流”工具显示和删除标志： [http ://technet.microsoft.com/en-us/sysinternals/bb897440.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897440.aspx)

然后重新启动应用程序池。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-10T16:59:41.590

这实际上是 GoDaddy 的中等信任环境的一个已知问题。然而，随着[URL Rewriter 3.0](http://urlrewriter.codeplex.com/Release/ProjectReleases.aspx)的最新版本，所有这些问题都消失了。请获取最新版本，如果您有任何问题，请告诉我。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-11T02:53:10.697

我对 GoDaddy 也有类似的问题。尽管一开始它似乎并不相关，因为它不在堆栈跟踪中（并且可能不适用于您，因为您使用的是第三方代码），但删除`Response.End()`调用解决了我的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-09T12:08:28.400

由于工作中的网络驱动器，我遇到了这个问题。当我将项目移动到桌面时，它又开始工作了。

# visual-studio - 使用同一 Visual Studio 2005 解决方案的不同版本/分支

> ID：523637
> 
> 赞同：9
> 
> 时间：2009-02-07T11:44:35.910
> 
> 标签：visual-studio, svn, version-control, visual-studio-2005, projects-and-solutions

这是使用 VS2005 的一个可用性问题：我从版本控制中签出了同一 Visual Studio 2005 解决方案的不同分支。解决方案和项目文件也受版本控制。在我的开发工作站上，有时我会在不同版本或分支上打开多个 Visual Studio 实例。它们都以相同的名称出现在窗口标题和任务栏中，因此很难切换到正确的名称等。（启动页面中最近打开的项目列表也是如此，但我很少使用它，反正。）

我试图找到一种方法来仅更改显示的名称，同时不会在源代码管理方面遇到太多麻烦，但 Visual Studio 2005 似乎从 SLN 文件本身的名称中获取解决方案名称，而不是从其中的某些属性中获取解决方案名称。

让 Visual Studio 在标题栏中显示解决方案文件的完整路径已经很有帮助，但我也没有找到这样做的方法。

您如何处理来自同一解决方案的不同版本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-08-17T14:05:12.260

使用（免费）VSCommands 插件：

[http://geekswithblogs.net/deadlydog/archive/2011/04/29/friendly-visual-studio-solution-names-for-branches.aspx](http://geekswithblogs.net/deadlydog/archive/2011/04/29/friendly-visual-studio-solution-names-for-branches.aspx)

我猜它只在为不同的分支使用不同的文件夹（不是 SVN 切换）时才有效，但它仍然是好东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-02T09:27:10.190

这里同样的问题。VS 对不同目录中同名的解决方案的支持不好。

一个有点hacky的解决方法：[http ://www.helixoft.com/blog/archives/32](http://www.helixoft.com/blog/archives/32)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-08T16:04:55.040

您的问题有一个理想的扩展，但您必须至少使用 VS 2010：

[http://visualstudiogallery.msdn.microsoft.com/f3f23845-5b1e-4811-882f-60b7181fa6d6](http://visualstudiogallery.msdn.microsoft.com/f3f23845-5b1e-4811-882f-60b7181fa6d6)

它会更改标题栏，因此不得重命名解决方案或文件。

我知道那是一篇旧文章，但也许​​你现在有一个更新的 VS 版本:-)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-07T11:54:34.347

为什么不重命名分支上的解决方案文件，例如 MySolution-branchXY.sln？

**更新**：

我不确定我是否理解你的评论。

分支解决方案后，每个文件都有两个独立版本：一个在主干（或源分支）上，一个在新分支上。这两个文件只是共享一个共同的历史记录，但您可以在两个分支上自由地独立更改它们。因此，您*可以*重命名分支中的解决方案。

# jquery - 使用一个 .js 文件执行不同操作的 jQuery 不同页面

> ID：523641
> 
> 赞同：1
> 
> 时间：2009-02-07T11:50:49.237
> 
> 标签：jquery, scripting

我的包含不同站点的网页应该只加载一个 .js 文件以进行缓存优化。加载文件时出现问题。它将每个页面上的侦听器应用于表单元素（例如），因此，只有最后一页的表单表现得像它应该的那样，其他的不会导致他们的动作被覆盖。

所以我的问题是，我怎么能说它应该只适用于这个网站的重要听众的脚本。

我正在使用 jQuery 框架。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T12:50:23.220

您针对浏览器进行优化的尝试与您不同的逐页行为相冲突。我不会把它全部塞进一个 js 文件中。考虑可维护性、模块化。

您可以将通用/共享代码放入一个 js 文件中，并将其包含在所有页面中。浏览器仍然会缓存它，它只需要发出一个额外的请求，如果它只是检查自上次获取它以来是否被修改过。但至少你的理智仍然会受到控制。

但无论如何，这是答案：

第 1 页：

```
<body id="page1">...</body> 
```

第2页：

```
<body id="page2">...</body> 
```

等等。现在，`monster.js`当您将行为附加到第 1 页时：

```
$(document).ready(function() {
    if(this.body.id != 'page1')
        return;

    // proceed as before
}) 
```

将行为附加到第 2 页元素的部分相同：

```
$(document).ready(function() {
    if(this.body.id != 'page2')
        return;

    // proceed as before
}) 
```

ETC

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-09T01:17:26.567

您可以通过以下方式划分特定于页面的逻辑`body#id`：[一个 JS 文件用于多个页面](https://stackoverflow.com/q/8410298/583539)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T12:28:01.500

用“page1”和“page2”之类的简单 id 将每个页面包装在不同的 div 中。然后在你的 javascript 中抓取带有 id 的元素：

```
$('#page1 div').show();
$('#page2 div').hide(); 
```

这将显示 page1 上的所有 div 并将它们全部隐藏在 page2 上。

# javascript - JavaScript 中 == 和 === 的区别

> ID：523643
> 
> 赞同：1686
> 
> 时间：2009-02-07T11:53:04.270
> 
> 标签：javascript, comparison-operators, equality-operator, identity-operator

`==`JavaScript和JavaScript有什么区别`===`？我也见过`!=`和`!==`运营商。还有更多这样的运营商吗？

* * *

## 回答 #1

> 赞同：2005
> 
> 时间：2009-02-07T11:57:35.353

看看这里： http: [//longgoldenears.blogspot.com/2007/09/triple-equals-in-javascript.html](http://longgoldenears.blogspot.com/2007/09/triple-equals-in-javascript.html)

3个等号表示“没有类型强制的平等”。使用三等号，值的类型也必须相同。

```
0 == false   // true
0 === false  // false, because they are of a different type
1 == "1"     // true, automatic type conversion for value only
1 === "1"    // false, because they are of a different type
null == undefined // true
null === undefined // false
'0' == false // true
'0' === false // false 
```

* * *

## 回答 #2

> 赞同：1209
> 
> 时间：2009-02-07T11:55:34.547

`===`并且`!==`是严格的比较运算符：

> JavaScript 具有严格的和类型转换的相等比较。为了`strict`相等，被比较的对象必须具有相同的类型并且：
> 
> *   当两个字符串具有相同的字符序列、相同的长度和对应位置的相同字符时，它们是严格相等的。
> *   当两个数字在数值上相等（具有相同的数值）时，它们是严格相等的。`NaN`不等于任何东西，包括`NaN`. 正零和负零彼此相等。
> *   如果两个布尔操作数都为真或都为假，则两个布尔操作数严格相等。
> *   如果两个对象引用相同，则它们是严格相等的`Object`。
> *   `Null`和`Undefined`类型是`==`（但不是`===`）。[即 ( `Null==Undefined`) 是`true`但 ( `Null===Undefined`) 是`false`]

[比较运算符 - MDC](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Operators/Comparison_Operators)

# asp.net-mvc - 哪些模板引擎可用于 ASP.NET MVC 框架？

> ID：523644
> 
> 赞同：3
> 
> 时间：2009-02-07T11:53:34.660
> 
> 标签：asp.net-mvc, template-engine

我在 Coding Horror 博客上阅读了一些关于处理[标签汤的恐怖的](http://www.codinghorror.com/blog/archives/001155.html)[帖子](http://www.codinghorror.com/blog/archives/001223.html)。似乎简化 html 生成的唯一方法是使用模板引擎。

你知道 ASP.NET MVC 框架的任何模板引擎吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T12:17:41.630

asp.net mvc 框架有很多视图引擎：

*   [Razor](https://docs.microsoft.com/en-us/aspnet/web-pages/overview/getting-started/introducing-razor-syntax-c)视图引擎内置于 ASP.NET MVC
*   Web 表单视图引擎（默认）
*   火花视图引擎
*   Nhamle 视图引擎
*   …所有关于 asp.net mvc 框架的社区贡献，包括视图引擎，都可以在

[http://www.codeplex.com/MVCContrib](http://www.codeplex.com/MVCContrib)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T04:25:18.090

StringTemplate 是一个不错的选择。

这是[ViewEngine (with Source)](http://code.google.com/p/string-template-view-engine-mvc/)和一些[教程](http://websitelogic.net/articles/MVC/stringtemplate-viewengine-asp-net-mvc)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T18:01:44.987

[NDjango](http://ndjango.org) - .net 中的 django 模板

# testing - 在 grails 中使用 junit 4

> ID：523662
> 
> 赞同：3
> 
> 时间：2009-02-07T12:08:22.493
> 
> 标签：testing, grails, junit

我想在我的 grails 测试中使用一些 JUnit 4 功能，但目前 grails 测试在 JUnit 3 下运行。JUnit 4 可以从 groovy 中使用，但是用 JUnit 4 替换 grails 中的 JUnit jar 似乎并没有启用我正在寻找的功能。

任何人都知道如何让 grails 使用 junit 4 运行我的测试？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-01-12T16:09:27.397

从 Grails 1.3.6 开始，似乎对 Junit 4 的支持不完全。Junit 4 中的集成测试很好，但扩展 GrailsUnitTestCase 的单元测试仅限于 Junit 3。GrailsUnitTestCase 扩展了仍与 Junit 3 相关联的 GroovyTestCase。

在 Groovy 文档 (http://groovy.codehaus.org/Using+JUnit+4+with+Groovy) 中，它说支持 Junit 4，但请注意声明“目前，JUnit 4 没有特殊的 Groovy 扩展” . 所以你可以使用它，但没有一个 Groovy 测试扩展利用它。

对于需要使用任何 Grails 测试扩展（如 mockDomain）的单元测试来说，这是一个杀手锏。我假设我有效地坚持使用 Junit 3。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-07T13:53:36.930

只要您使用 Groovy 1.5+ 和 Java 5+，就可以将 JUnit 4 与 Grails 一起使用：

[http://groovy.codehaus.org/Using+JUnit+4+with+Groovy](http://web.archive.org/web/20150311212721/http://groovy.codehaus.org/Using+JUnit+4+with+Groovy)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-15T15:14:14.947

从 Grails 1.3M1 开始，JUnit 4 已上线：http: [//www.grails.org/1.3-M1+Release+Notes](http://www.grails.org/1.3-M1+Release+Notes)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-21T17:57:15.530

Grails 不支持 JUnit 4。他们正在[考虑在 Grails 1.3 中支持它](http://jira.codehaus.org/browse/GRAILS-3237)。您可以强制依赖 JUnit 4，但 Grails 工具可能会忽略您的测试、错误地运行它们，或者您可能会看到其他奇怪的副作用。

要强制依赖 JUnit 4（风险自负），请打开**grails-app/conf/BuildConfig.groovy**文件。在该文件中，修改*依赖*项和*继承*部分以包括以下内容：

```
inherits("globals") { 
  excludes "junit" 
}

dependencies { 
  test "junit:junit:4.7" 
} 
```

然后，在 SpringSource Tool Suite 中，右键单击您的项目并选择 Grails Tools -> Refresh Dependencies。这应该用 junit 4.7 替换 Grails 依赖项中的 junit 3.8.1。

# c# - 如何在 C#/Win32 中编写文本并将其发送到 mIRC？

> ID：523669
> 
> 赞同：6
> 
> 时间：2009-02-07T12:14:48.830
> 
> 标签：c#, winapi, irc

在上一个问题中，我询问[了如何将文本发送到记事本](https://stackoverflow.com/questions/523405/how-to-send-text-to-notepad-in-c-win32)。它极大地帮助了我。对于第 2 部分，这是相同应用的 mIRC 的简化版本：

```
[DllImport("User32.dll", EntryPoint = "FindWindow")]
public static extern IntPtr FindWindow(String lpClassName, String lpWindowName);
[DllImport("user32.dll", EntryPoint = "FindWindowEx")]
public static extern IntPtr FindWindowEx(IntPtr hwndParent, IntPtr hwndChildAfter, string lpszClass, string lpszWindow);
[DllImport("User32.dll")]
public static extern int SendMessage(IntPtr hWnd, int uMsg, int wParam, string lParam);

IntPtr mainHandle = FindWindow("mIRC", null);
IntPtr serverHandle = FindWindowEx(mainHandle, new IntPtr(0), "MDIClient", null);
IntPtr chanHandle = FindWindowEx(serverHandle, new IntPtr(0), "mIRC_Channel", null);
IntPtr editHandle = FindWindowEx(chanHandle, new IntPtr(0), "Edit", null);

SendMessage(editHandle, 0x000C, 0, textBox1.Text); 
```

这对我来说似乎是正确的，只是它不起作用！是不是窗口名称不正确（MDIClient、mIRC_Channel 和 Edit）？这些是我通过谷歌搜索“FindWindowEx mIRC”在网站上找到的值。

1.）我在上面做错了什么？

2.) 作为参考，一般来说，有没有一种简单的方法可以找到所有与 Window 一起使用的名称`FindWindowEx()`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T12:29:44.447

此代码适用于我（mirc 6.31）：

```
IntPtr mainHandle = FindWindow("mIRC", null);
IntPtr serverHandle = FindWindowEx(mainHandle, new IntPtr(0), "MDIClient", null);  
IntPtr chanHandle = FindWindowEx(serverHandle, new IntPtr(0), "mIRC_Channel", null);  
IntPtr editHandle = FindWindowEx(chanHandle, new IntPtr(0), "richEdit20A", null);
SendMessage(editHandle, 0x000C, 0, "Hello World"); 
```

注意更改的窗口类（richedit20A 而不是编辑）。刚刚使用 Spy++ 找到了正确的类。

至于窗口句柄，一种可能性是使用[EnumWindows](http://msdn.microsoft.com/en-us/library/ms633497.aspx)或[EnumChildWindows](http://msdn.microsoft.com/en-us/library/ms633494(VS.85).aspx) API。

# entity-framework - 使用 ado.net 将类映射到数据库

> ID：523676
> 
> 赞同：0
> 
> 时间：2009-02-07T12:29:25.943
> 
> 标签：entity-framework, orm, ado.net

我想知道是否有办法使用 ado.net 实体框架从现有类创建数据库或将现有类映射到数据库。

我寻找教程，只找到了使用实体模型设计器创建类的方法。

作为一个例子，我有类 Bird 属性长度和年龄

在数据库中，我有一个名为 Bird 的表，其中包含 Length 和 Age 列

现在我不希望设计者从数据库中创建新类。相反，我想将 Class Bird 直接映射到表 Bird。使用 Linq2Sql，这可以通过手动创建映射来实现。ado.net实体框架中是否有可能？

亲切的问候

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-08T10:49:59.810

将类 C 映射到表 T 或将 T 映射到类 C 有什么区别？

O/R 映射不是关于将类映射到表，而是关于定义实体模型并将其同时投影到表和类。毕竟，您的类和表不会从天而降：它们基于您的定义，例如必须有一个实体客户，具有字段 A、B 和 C，*然后*您正在定义实体具有字段 A、B 和 C 的客户导致表客户具有字段 A、B 和 C 以及具有字段/属性 A、B 和 C 的客户类以及它们之间的映射，因为*它们代表相同的实体*

# javascript - 如何从 html 弹出窗口返回值

> ID：523680
> 
> 赞同：4
> 
> 时间：2009-02-07T12:32:07.670
> 
> 标签：javascript, jquery, asp.net-mvc, popup, modal-dialog

我需要一种简洁、干净的方式在 asp.net mvc（+/- jquery 或 js）中实现它？

用户单击 webform A 中的元素；弹出Webform B；用户与网络表单 B 交互；在关闭 webform B 时，可能通过提交按钮，webform a 中的源元素将使用来自 webform B 的值进行更新

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T12:52:28.783

使用 ASP.NET MVC，我可能会在页面上呈现一个 DIV，最初是隐藏的，如果内容取决于在初始页面上选择的值，则可能通过 AJAX。我会使用 jQuery UI 对话框插件来弹出对话框。该对话框可以包含提交回服务器的表单。您还可以使用对话框的 onclose 处理程序来从对话框中的输入复制值以用于页面的其余部分。如果您通过 AJAX 填充对话框，您可以让服务器生成 HTML——比如通过呈现部分视图并返回它——或者返回 json 并在浏览器中动态生成对话框。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-07T13:16:07.567

我已经求助于使用cookies。我发现这是唯一可靠的方法。我正在为我的对话框使用 GrayBox，所以我在对话框中有一个如下所示的函数：

```
 function selectValue(id, name) {
      SetCookie("_someuniqueprefix_RetID", id);
      SetCookie("_someuniqueprefix_RetValue", name);
      parent.parent.GB_CURRENT.hide();
    } 
```

然后在我的调用页面中，我启动了在 GrayBox 中显示部分的对话框：

```
$(function() {
    var selectUrl = '/_somecontroller/Select';
    // attach a method to the chooseButton to go and get a list of
    // contact persons to select from
    $("#chooseButton").click(function() {
        GB_showCenter('Select My thing', selectUrl, 500, 620, function() {
            var id = GetCookie("_someuniqueprefix_RetID");
            var value = GetCookie("_someuniqueprefix_RetValue");
            DeleteCookie("_someuniqueprefix_RetID", "/", "");
            DeleteCookie("_someuniqueprefix_RetValue", "/", "");
            $("#MyID").val(id);
            $("#MyName").val(value);
        });
    });

}); 
```

此外，您还需要从网络上获取 SetCookie 和 GetCookie 的功能

希望有帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T16:28:06.463

您可以使用弹出窗口中的 javascript 通过 window.opener 调用开启器上的函数。因此，当用户单击提交按钮时，您的弹出窗口可以调用父页面上的函数将数据传回。

我不确定您的要求是什么，但 IMO 使用 ajax 听起来有点矫枉过正。如果您只需要一些来自弹出网络表单的表单数据传递给开启者网络表单，则无需调用服务器。

# cocoa-touch - 简单节拍器 - 每 x 毫秒播放一次 AIF

> ID：523682
> 
> 赞同：0
> 
> 时间：2009-02-07T12:37:06.710
> 
> 标签：cocoa-touch, core-audio

我看过 Apple 提供的节拍器示例，但是，示例太复杂了，并且包含了我项目中不需要的东西。

有没有一种简单的方法可以让系统每隔 x 毫秒播放一次声音？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T13:15:50.937

[查看 NSTimer。](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSTimer_Class/Reference/NSTimer.html "NS定时器")

你会想做这样的事情：

```
[NSTimer scheduledTimerWithTimeInterval:x target:self selector:@selector(yourMethodHere:) userInfo:nil repeats:YES]; 
```

Apple 示例可以帮助编写播放声音文件所需的实际代码，并且 NSTimer 应该很容易学习如何使用。

[另一个好的 NSTimer 资源可以在 CocoaDev 找到。](http://www.cocoadev.com/index.pl?NSTimer)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-05T18:12:08.443

一个警告...... NSTimer 不准确，如果时间很重要或者你试图保持稳定的节拍。

# algorithm - 计算机国际象棋树搜索的最新技术是什么？

> ID：523684
> 
> 赞同：15
> 
> 时间：2009-02-07T12:38:36.613
> 
> 标签：algorithm, search, heuristics, chess

我对提供百分之几速度的微小优化不感兴趣。我对 alpha-beta 搜索最重要的启发式方法很感兴趣。以及评估功能的最重要组成部分。

我对具有最大（改进/代码大小）比率的算法特别感兴趣。（不是（改进/复杂性））。

谢谢。

PS Killer move heuristic 就是一个完美的例子——易于实现且功能强大。启发式数据库太复杂了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-07T12:54:14.100

不确定您是否已经意识到这一点，但请查看[国际象棋编程 Wiki——](https://chessprogramming.wikispaces.com/)这是一个很好的资源，几乎涵盖了现代国际象棋 AI 的各个方面。特别是，关于您的问题，请参阅主页上的“搜索和评估”部分（在“原则主题”下）。您还可以发现[这里](https://chessprogramming.wikispaces.com/Engines)列出的一些程序中使用的一些有趣的技术。如果您的问题仍然没有得到解答，我绝对建议您在[国际象棋编程论坛](https://chessprogramming.wikispaces.com/Computer+Chess+Forums)中提问，那里可能有更多的专家来回答。（并不是说您不一定会在这里得到好的答案，只是更有可能在特定主题的专家论坛上）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-07T19:41:44.807

[MTD(f)](http://www.cs.vu.nl/~aske/mtdf.html)或[MTD 变体之一是对标准](http://sciencelinks.jp/j-east/article/200320/000020032003A0679577.php)[alpha-beta](http://en.wikipedia.org/wiki/Alpha-beta_pruning)的重大改进，前提是您在评估函数中没有非常精细的细节并假设您正在使用[杀手启发式](http://en.wikipedia.org/wiki/Killer_heuristic)。历史[启发式](http://www.frayn.net/beowulf/theory.html#history)也很有用。

最受好评的国际象棋程序[Rybka](http://en.wikipedia.org/wiki/Rybka)显然已经放弃了 MDT(f)，转而支持在非 PV 节点上具有零吸气窗口的[PVS 。](http://www.frayn.net/beowulf/theory.html#pvsearch)

[扩展的无效修剪](http://people.csail.mit.edu/heinz/dt/node18.html)，它结合了正常的无效修剪和深度剃刀，理论上是不合理的，但在实践中非常有效。

[迭代深化](http://www.frayn.net/beowulf/theory.html#iterative)是另一种有用的技术。我[在这里列出了很多很好的国际象棋编程链接](https://stackoverflow.com/questions/494721/what-are-some-good-resources-for-writing-a-chess-engine/502029#502029)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T16:09:42.553

尽管国际象棋编程文献中讨论了许多基于启发式的优化（我的意思是在不实际搜索的情况下增加树深度的方法），但我认为它们中的大多数很少使用。原因是它们在理论上是很好的性能提升器，但在实践中却不是。

有时这些启发式方法也会返回一个糟糕的（我的意思是不是最好的）举动。

与我交谈过的人总是建议优化 alpha-beta 搜索并在代码中实现迭代深化，而不是尝试添加其他启发式方法。

主要原因是计算机的处理能力正在提高，研究[我想需要引用]表明，使用其全部 CPU 时间将 alpha-beta 树强制到最大深度的程序总是跑得比分裂的程序快。他们在一定水平的 alpha-beta 和一些启发式之间的时间。

尽管使用一些启发式方法来扩展树深度可能弊大于利，但您可以将许多性能提升器添加到 alpha-beta 搜索算法中。

我相信你知道要让 alpha-beta 完全按照它的预期工作，你应该有一个移动排序机制（**迭代深化**）。迭代深化可以为您带来大约 10% 的性能提升。

在 alpha beta 中添加**主要变异搜索**技术可能会给您额外的 10% 提升。

也试试**MTD(f** ) 算法。它还可以提高引擎的性能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T01:18:41.343

尚未提及的一种启发式方法是[Null move pruning](http://en.wikipedia.org/wiki/Null-move_heuristic)。

此外，Ed Schröder 有一个很棒的页面解释了他在他的 Rebel 引擎中使用的一些技巧，以及每个技巧对速度/性能的贡献：[Inside Rebel](http://members.home.nl/matador/chess840.htm)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T01:29:54.750

使用带有[zobrist 哈希的转置表](http://en.wikipedia.org/wiki/Zobrist_hashing)

只需要很少的代码来实现[每次移动或取消移动一个 XOR，以及在游戏树中递归之前的一个 if 语句]，并且好处非常好，特别是如果您已经在使用迭代深化，并且它非常可调整（使用更大的表、更小的表、替换策略等）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T16:20:36.743

Killer move 是小代码大小和移动顺序的巨大改进的一个很好的例子。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-07T17:51:47.027

大多数棋盘游戏 AI 算法都基于[http://en.wikipedia.org/wiki/Minmax](http://en.wikipedia.org/wiki/Minmax) MinMax。目标是最大限度地减少他们的选择，同时最大限度地增加您的选择。尽管对于国际象棋，这是一个非常大且代价高昂的运行时问题。为了帮助减少这种情况，您可以将 minmax 与以前玩过的游戏的数据库结合起来。任何具有相似棋盘位置并建立了关于如何为您的颜色赢得该布局的模式的游戏都可以用于“分析”下一步移动的位置。

我对你所说的改进/代码大小有点困惑。您真的是指改进/运行时分析（大 O(n) 与 o(n)）吗？如果是这种情况，请与 IBM 和 big blue 或 Microsoft 的 Parallels 团队联系。在 PDC 上，我和一个人（他的名字现在忘记了我）进行了交谈，他正在使用每个对手使用 8 个核心来演示麻将，他们在游戏算法设计比赛中获得了第一名（他的名字也让我忘记了）。

我认为没有任何“固定”算法可以始终赢得国际象棋并且做得非常快。您必须这样做的方式是在一个非常大的基于字典的数据库中索引每个可能的以前玩过的游戏，并预先缓存每个游戏的分析。在我看来，这将是一个非常复杂的算法，并且将是一个非常糟糕的改进/复杂性问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T01:28:41.350

我可能有点跑题了，但“最先进的”国际象棋程序使用诸如 Deep Blue 之类的 MPI 来获得巨大的并行能力。

试想一下，并行处理在现代国际象棋中扮演着重要的角色

# jquery - jQuery - 当鼠标悬停在图像上时，动态地将 Div 向上滑动到图像上

> ID：523687
> 
> 赞同：0
> 
> 时间：2009-02-07T12:43:47.820
> 
> 标签：jquery, image

当鼠标悬停时，我需要在图像上动态显示 div。我需要对很多图像执行此操作，因此它需要是动态的。我查看了来自[www.foliostars.net](http://www.foliostars.net/)的代码：

```
jQuery.fn.masque = function(classe) {

$(this).hover(function(){
$(this).find(classe).stop().animate({height:'40px',opacity: '0.9'},400);
},function () { 
$(this).find(classe).stop().animate({height:'0',opacity: '0'}, 400);
});
}   
$(document).ready(function(){$('.thumb h2').masque('.masque');}); 
```

有一种方法可以修改它以使用 div 而不是标题？也许有更好的方法来做到这一点？？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T12:53:10.670

当然。给你的 div 一个类`"slider"`：

```
$(document).ready(function(){$('div.slider').masque('.masque');}); 
```

# excel - 使用 c# 在 Excel 工作表中查找和删除一些文本

> ID：523690
> 
> 赞同：3
> 
> 时间：2009-02-07T12:45:00.983
> 
> 标签：excel, cell

我想找到一些文本，例如“Joe”并将其从 Excel 工作表中使用 C# 的位置删除？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-07T13:54:57.690

您将需要使用 Range.Replace 方法，并简单地替换为空字符串。

```
static void ReplaceTextInExcelFile(string filename, string replace, string replacement)
{
    object m = Type.Missing;

    // open excel.
    Application app = new ApplicationClass();

    // open the workbook. 
    Workbook wb = app.Workbooks.Open(
        filename,
        m, false, m, m, m, m, m, m, m, m, m, m, m, m);

    // get the active worksheet. (Replace this if you need to.) 
    Worksheet ws = (Worksheet)wb.ActiveSheet;

    // get the used range. 
    Range r = (Range)ws.UsedRange;

    // call the replace method to replace instances. 
    bool success = (bool)r.Replace(
        replace,
        replacement,
        XlLookAt.xlWhole,
        XlSearchOrder.xlByRows,
        true, m, m, m);

    // save and close. 
    wb.Save();
    app.Quit();
    app = null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-25T11:54:04.893

这适用于`Excel 2016`：

*   在您的 C: 上搜索`Microsoft.Office.Interop.Excel`，将其复制到您的 C# 项目中，并将其作为参考。
*   汇编版本应该是`15.0.0.0`.

代码：

```
Excel.DisplayAlerts = false; // Prevent "Nothing found" dialogs.

var Excel = (Microsoft.Office.Interop.Excel.Application)ExcelDnaUtil.Application;

foreach(Worksheet sheet in Excel.Sheets)
{
    bool success = sheet.Rows.Replace(What: "ABC",Replacement: "DEF");
}

Excel.DisplayAlerts = true; 
```

# asp.net - .Net 自定义库？

> ID：523693
> 
> 赞同：1
> 
> 时间：2009-02-07T12:48:16.857
> 
> 标签：asp.net, database

我在哪里可以获得 ASP .Net 的自定义库？具体来说，我正在寻找现成的数据库访问库，它允许我使用事务来选择、插入和更新数据库。我知道如何创建，但我正在尝试使用一个现有的库来完成所有这些并处理异常和错误，从而免于从头开始创建它并陷入错误的喧嚣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T12:55:23.723

您可以使用 Microsoft 的免费[企业库](http://msdn.microsoft.com/en-us/library/cc467894.aspx)进行数据访问、日志记录、缓存、安全和配置。它非常常用。

您也可以使用免费的[.NET Tiers](http://nettiers.com/)等代码生成器，但如果您想使用它，则需要[CodeSmith 。](http://www.codesmithtools.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T12:55:45.470

我建议查看使用[LINQtoSQL](http://msdn.microsoft.com/en-us/library/bb425822.aspx)和 DBML 设计器将您的数据库表映射到系统中的对象或功能更全的 ORM，如[nHibernate](http://www.hibernate.org/343.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T13:29:41.907

您可能想查看名为[Speedy.net](http://www.openbracketllc.com/products/speedy/Data/Default.aspx)的内容。我从未使用过它，但它看起来很有趣。我使用了这些人编写的其他代码，通常它非常好。对于它花费的少量金钱，它可能值得一试。

# asp.net-mvc - 在 MVC 用户控件及其父视图上调用的 POST 方法

> ID：523695
> 
> 赞同：3
> 
> 时间：2009-02-07T12:51:45.977
> 
> 标签：asp.net-mvc

**重写：**我原来的帖子似乎被误解了。此后，我将其报告为具有以下描述的错误。我对这个问题的原始帖子可以在第二个`<HR`>下面找到。

* * *

我在用户控件中遇到了 POST 的主要问题。

*   我有一个 UserControl，它有一个控制器，其中包含两个名为“ContactForm”的 ActionMethod。第二个有 ActionVerb.POST 以响应回发。用户控件主要通过 AJAX 使用——但这实际上与这里无关。显然，这些操作方法呈现局部视图。

*   我有一个包含“EnterContest”的附加 html 表单的主页。再一次 - 它的控制器有两个称为“EnterContest”的 ActionMethod，其中一个响应 ActionVerb.POST。此视图包含侧栏中的“ContactForm”，其呈现为：

    `<% Html.RenderAction("ContactUsForm", "Company", new { commentsBoxHeader = "Questions" }); %>`

发回“EnterContest”表单（视图上的主表单）时会出现问题。

来自 Fiddler 的 POST 请求仅包含此查询字符串（显然不包含来自联系我们表单的任何 POST 数据，因为那是一个完全独立的 HTTP 操作）。

> matchId=ND09&email=fred&btnEnterContest=提交
> 
> （是的，这看起来像一个 GET 但这也是 Fiddler 为 POST 显示的内容）

*   首先 - （如预期的那样） - 在主控制器中调用 'EnterContest(FormCollection data) 方法。这会处理表单提交以进入比赛 - 调用网络服务等。

*   第二 - （不是预期的） - 'ContactForm' 控制器的 POST 方法被调用。这会立即崩溃，因为它缺少预期的参数——而且我们不希望它被调用。这发生在同一个 Http 请求期间。

如果我看一下堆栈跟踪 - 它是从动态生成的 aspx 页面调用的 - 源自上面显示的 Html.RenderAction 代码行。所以很明显，正在发生的事情是希望部分呈现“ContactUs”操作方法的代码查看请求并看到有一种方法可以处理 POST，因此它将它路由到那里 - 这是非常糟糕的。它可能在框架中这个方法的某个地方：

```
System.Web.Mvc.dll!System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod 
```

这种行为非常令人困惑，并且确实破坏了看似简单的页面。我很确定这是一个错误——因为如果没有一些非常笨拙的检查我的控制器，我就看不到一个优雅的工作。我认为 RenderAction 在未来 - 但我不知道问题是否存在或存在于主框架中。

只是为了澄清没有发生的事情：

*   任何聪明的 jQuery
*   多个 HTTP 请求（在 Fiddler 中验证）
*   嵌套表格

谢谢

* * *

原帖

我`RenderAction`在 ASP.NET MVC 中使用 Html 扩展。

我遇到了一些意想不到的事情，但当我想到它时，这更有意义。

假设我有一个包含“RenderAction”方法的视图，用于为页面的一部分生成联系人。

```
<% Html.RenderAction("ContactUsForm", "Company", 
   new { commentsBoxHeader = "Questions" }); %> 
```

在这种情况下，它生成的部分视图会创建一个 ajax 表单，该表单通过`<%= Html.BeginAjaxForm() %>`.

所以我当然需要一个 actionresult 来处理 AJAX 回发。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult ContactUsForm(FormCollection formdata) 
```

现在，当包含此部分渲染操作的**父视图**具有带有 POST 操作的普通（非 ajax）表单时，就会出现问题。`ContactUsForm`发生的情况是，除了主视图的 POST 操作之外，还调用了该操作的 POST 方法。在此操作中，该`formdata`属性包含父视图的所有属性 - 因此会`ContactUsForm`因空引用或类似的东西而死。

我提出了 3 种可能的解决方案：

1) 为页面上的任何用户控件的回发创建不同的操作名称。这样做的缺点是您必须回发到与创建局部视图不同的函数。通常这可能会更麻烦，但这就是我现在正在做的事情。

2）检查每个 POST 方法（您必须记住在每个用户控件的 POST 操作方法中运行此检查）以查看表单数据是否用于该表单，如果不是则返回默认视图。

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResultContactUsForm(FormCollection formData)
    {
        if (formData["btnSubmitContactUsForm"] == null) {

            // "This form is not for us!";
            // figure out how (if is possible) to return the get default view here
            // and call it with the right arguments
        }
    } 
```

3）将其报告为错误。

我应该在这里做什么？我倾向于认为这是一个错误

**编辑：**我需要强调的一件非常重要的事情是，两个 POST 方法都被调用了——所以它不仅仅是像嵌套表单那样的东西。

**编辑 2：**在 Fiddler 中，我只看到一个请求。`ContactUsForm`问题是，当它在已经为我的主页处理过 POST 之后尝试渲染时，它会点击“ContactUsForm”的“POST”方法，而不是非 post 处理程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T13:02:05.893

**EDIT2**：我刚刚注意到您使用的是 RenderAction 而不是 RenderPartial。我怀疑正在发生的事情是它使用已发布表单的 RequestContext 来选择在调用 RenderAction 时选择哪个 ContactUsForm 方法。这可以说是正确的行为，因为该操作**是**从回发中调用的，而不是您想要的。我会以完全不同的方式处理这个问题。由 ViewUserControl 生成部分，并使用 RenderPartial 将其包含在页面上。删除 GET ContactUsForm 方法，只有 POST 版本。也就是说，表单本身作为 ViewUserControl 生成，带有预先确定的标记或通过 ViewData 传递的参数动态生成的标记。表单响应通过控制器操作处理。

**编辑**：既然您指出嵌套不是问题，那么您是否有可能使用 javascript（比如 jQuery）来触发提交并且您的选择器过于宽泛。例如，如果您有如下代码，这将解释您所看到的行为。

```
$(document).ready( function() {
    $('#mybutton').click( function() {
       $('form').submit();
    });
}); 
```

**原始答案：（**留给上下文）

听起来您的视图中有嵌套表单。尝试将 RenderAction 移到父视图中的表单之外，看看是否能解决您的问题。我对 MVC 视图中的表单的感觉是它们应该是紧凑的，并且只覆盖包含实际输入的标记。这是 WebForms 的一个变化，在 WebForms 中，您通常将所有标记都包含在表单中。如果您需要让表单元素看起来是混合的，请使用 CSS 来控制布局。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-23T06:42:47.950

这实际上是带有 MVC 功能库的 ASP.NET MVC 1.0 和 ASP.NET MVC 2.0 中已确认的错误。当请求为 POST 时，RenderAction 行为不正确。我已在 Codeplex 上的 ASP.NET 问题跟踪器中提交了错误，请为它投票 :) [http://aspnet.codeplex.com/WorkItem/View.aspx?WorkItemId=5847](http://aspnet.codeplex.com/WorkItem/View.aspx?WorkItemId=5847)

# php - 我对 PHP 会话的理解正确吗？

> ID：523703
> 
> 赞同：17
> 
> 时间：2009-02-07T12:57:02.207
> 
> 标签：php, session

我一直对会话如何在内部工作很感兴趣，但我对 C 知之甚少（并且不确定在哪里可以查看 PHP 源代码）。

这是我目前对会话的理解：

1.  当您启动会话时，用户会获得一个存储在 cookie 中的会话 ID。
2.  当会话数据被保存（通过`$_SESSION`）时，它会存储在文件系统中，并带有相关的会话 ID 和到期时间。

它是否正确？另外创建会话ID的方法是什么？我假设它是基于时间的，但是如果两个用户同时发送请求怎么办？内部有哪些方法可以防止它们获得相同的 id？

谢谢，

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-07T13:11:23.677

我对内部会话处理过程的理解如下：

当[`session_start`](http://php.net/session_start)被调用时，PHP 正在从客户端查找通过 POST、GET 或 cookie 发送的参数（取决于配置；参见[*session.use_cookies*](http://php.net/manual/en/session.configuration.php#ini.session.use-cookies)、[*session.use_only_cookies*](http://php.net/manual/en/session.configuration.php#ini.session.use-only-cookies)和[*session.use_trans_sid*](http://php.net/manual/en/session.configuration.php#ini.session.use-trans-sid)），其名称为[*session.name*](http://php.net/manual/en/session.configuration.php#ini.session.name)的值以使用已启动会话的会话 ID。

如果找到有效的会话 ID，它会尝试从存储中检索会话数据（请参阅[*session.save_handler*](http://php.net/manual/en/session.configuration.php#ini.session.save-handler)）以将数据加载到`$_SESSION`. 如果找不到 ID 或其使用被禁止，PHP 会使用哈希函数（请参阅[*session.hash_function*](http://php.net/manual/en/session.configuration.php#ini.session.hash-function)）对生成随机数据的源的数据（请参阅[*session.entropy_file*](http://php.net/manual/en/session.configuration.php#ini.session.entropy-file)）生成一个新 ID。

在运行时结束或被[`session_write_close`](http://php.net/session_write_close)调用时，会话数据`$_SESSION`被存储到指定的存储中。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-07T13:16:44.850

查看php源码中[ext/session/session.c中的php_session_create_id](https://github.com/php/php-src/blob/master/ext/session/session.c#L279)

它是这样的：

*   获取一天中的时间
*   获取远程IP地址
*   使用当前时间的秒数和微秒数以及 IP 地址构建一个字符串
*   将其输入配置的[会话哈希函数](http://uk3.php.net/manual/en/session.configuration.php#ini.session.hash-function)（MD5 或 SHA1）
*   如果已配置，则从[熵文件中提供一些额外的随机性](http://uk3.php.net/manual/en/session.configuration.php#ini.session.entropy-file)
*   生成最终哈希值

所以得到一个副本是相当困难的。但是，您应该熟悉会话固定的概念，它允许攻击者潜在地选择他们的目标将采用的 session_id - 请参阅[会话和 Cookies](http://www.devshed.com/c/a/PHP/Sessions-and-Cookies)以获得良好的入门。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T13:13:23.623

会话 ID 可能只是一个随机的字母和数字字符串。如果 PHP 没有检查它是否是唯一的，因此对于两个用户来说不能相同，这也会很奇怪。至于（1）和（2），我会说你是对的，但我最近没有使用 PHP，所以请不要相信我。

# sql - 联合或使用流控制逻辑来确定要报告哪个表

> ID：523710
> 
> 赞同：0
> 
> 时间：2009-02-07T13:01:06.677
> 
> 标签：sql, stored-procedures, reporting, union, tsqlt

我正在使用无法更改表格的 3rd pary 应用程序。我们使用附加的日期时间列“AsOfDate”构建了自定义匹配的“每月”表，我们在其中转储了月末的数据，并将这些数据标记为当月最后一天的日期。

我希望能够创建单个存储过程（应用程序旨在要求视图或存储过程作为所有报告的来源。）并使用将使用当前数据表的参数（参数可能为 NULL 或 = Today's日期）或使用月末表并按月末日期过滤。这样，我有一个报告，用户可以使用当前或特定月末期间的数据。

你更喜欢哪个（以及为什么）对不起，这不是完全编码的

**解决方案 #1 联合查询**

```
Create Proc Balance_Report (@AsOfDate)
AS

Select Column1
From
    (Select GetDate() as AsOfDate
       , Column1 
     From Current.Balance
    Union 
    Select AsOfDate
       , Column1 From MonthEnd.Balance
    ) AS All_Balances
Where All_Balances.AsOfDate = @AsOfDate 
```

**解决方案 #2 使用 If 语句选择表**

```
Create Proc Balance_Report (@AsOfDate)
AS

If @AsOfDate IS NULL or @AsOfDate = GetDate()
   Select GetDate() as AsOfDate
       , Column1 
     From Current.Balance
Else
    Select AsOfDate
       , Column1 From MonthEnd.Balance
    Where AsOfDate = @AsOfDate 
```

同样，这不是完全编码的，并且与数据库无关（但它是 SQL Server 2005）。

**编辑：使用单独的存储过程对解决方案 #2 的变体**

```
Create Proc Balance_Report (@AsOfDate)
AS

If @AsOfDate IS NULL or @AsOfDate = GetDate()
   Exec Current_Balance_Date -- no param necessary
Else
    exec MonthEnd_Balance_Date @AsOfDate 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T13:08:56.300

我更喜欢非工会的解决方案。从单个表中选择总是比进行联合并从联合中选择单个表的数据要快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T13:41:26.563

您如何设置，第二种方法可能会更快。如果您要使用分区视图，那么您可以设置约束，使优化者知道忽略选择中的一个或多个表，并且您将获得相同的性能。这也可以让您将所有逻辑保存在一个语句中，而不必让两个语句保持同步。根据 SELECT 语句的复杂程度，这对您来说可能是也可能不是问题。

One thing to remember though, is that if you use the second method, be sure to mark your stored procedure as WITH (RECOMPILE) (I can't remember if the parentheses are require or not - check the syntax). That way the optimizer will create a new query plan based on which branch of the IF statement needs to be executed.

# c# - 从 .net 应用程序访问 MS-Exchange 全局访问列表的最佳方式

> ID：523716
> 
> 赞同：2
> 
> 时间：2009-02-07T13:03:42.553
> 
> 标签：c#, .net, exchange-server

从 .net 应用程序访问公司 MS-Exchange GAL（全局访问列表 - 公司 ID/GroupIDS 列表）的最佳方式是什么？我们可以使用 CDO、MAPI、LDAP 等，但我期待一个更快且与 atleast Outlook 2000 及更高版本兼容的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T13:11:49.383

[通过 System.DirectoryServices 访问 GAL](http://www.c-sharpcorner.com/UploadFile/frankalonzo/GlobalAddressList11262005053740AM/GlobalAddressList.aspx?ArticleID=1c1b6bf4-b468-42f6-a40b-b1f1f677dde6)可能会为您指明正确的方向，但这篇文章来自 2005 年。

# c# - C#.net 和 Visual Basic.net 有什么区别？

> ID：523722
> 
> 赞同：8
> 
> 时间：2009-02-07T13:09:53.273
> 
> 标签：c#, .net, vb.net, programming-languages

我在 VB.net 方面有一点经验，我想学习 C#.net

VB.net 和 C#.net 有什么区别？

这两者在性能上有什么区别吗？

除了句法上的差异，还有什么我必须记住的重大变化吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-07T13:16:34.087

[维基百科](http://en.wikipedia.org/wiki/Comparison_of_C_Sharp_and_Visual_Basic_.NET#Language_features)文章的*语言特性*部分提供了很好的概述。据我了解，性能几乎在每个方面都基本相同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-07T13:25:20.420

如果您编写等效代码，则性能是等​​效的，但是 VB.NET 具有用于“向后兼容性”的构造，这些构造永远不应该使用。C# 没有这些东西。我特别想：

*   Microsoft.VisualBasic 命名空间中的函数，它们是其他标准 .NET 类（如 Trim()）的成员。.NET 类通常更快。

*   Redim 和 Redim 保护区。永远不会在 .NET 中使用，但它们在 VB 中。

*   On Error ...而不是异常。呸！

*   后期绑定（有时被戏称为“选项慢”）。从性能角度来看，在非动态 .NET 语言中不是一个好主意。

VB 还缺少诸如自动属性之类的东西，这对我来说非常不受欢迎。不是性能问题，但值得牢记。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T13:20:31.910

我想你会在这篇文章中找到你的问题的答案：

[http://en.wikipedia.org/wiki/Comparison_of_C_sharp_and_Visual_Basic_.NET](http://en.wikipedia.org/wiki/Comparison_of_C_sharp_and_Visual_Basic_.NET)

和

[http://geekswithblogs.net/jmccarthy/archive/2007/01/23/104372.aspx](http://geekswithblogs.net/jmccarthy/archive/2007/01/23/104372.aspx)

编辑：诺多林更快：x

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-07T13:21:52.967

学习C#首先要知道的是它不发音为“C#.net”，它只是C#。Microsoft 将“.NET”附加到 VB，因为以前版本的 VB 不能在 .NET Framework 上运行。C# 是专门针对 .NET 框架创建的，因此“.net”是隐含的且不必要的。另外作为旁注，在简历中添加“C#.NET”确实会提示知识渊博的经理了解您的技能水平，或者缺乏关于 C# 的技能水平。

此外[，这篇 Wikipedia 文章](http://en.wikipedia.org/wiki/Comparison_of_C_Sharp_and_Visual_Basic_.NET)非常适合从高层次上展示 C# 和 VB.NET 之间的优缺点以及差异。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-07T13:25:17.877

按照以下链接给出详细的差异

[http://www.harding.edu/fmccown/vbnet_csharp_comparison.html](http://www.harding.edu/fmccown/vbnet_csharp_comparison.html)

[http://www.codeproject.com/KB/dotnet/vbnet_c__difference.aspx](http://www.codeproject.com/KB/dotnet/vbnet_c__difference.aspx)

[http://support.microsoft.com/kb/308470](http://support.microsoft.com/kb/308470)

尽管在[http://support.microsoft.com/kb/308470](http://support.microsoft.com/kb/308470)中提到了差异，但 C# 和 VB.Net 都是 .Net 世界的一等公民

> 尽管 Visual Basic .NET 和 Visual C# .NET 之间存在差异，但它们都是基于 Microsoft .NET Framework 的一流编程语言，并且功能同样强大。Visual Basic .NET 是一种真正的面向对象的编程语言，包括新的和改进的特性，例如继承、多态性、接口和重载。Visual Basic .NET 和 Visual C# .NET 都使用公共语言运行库。Visual Basic .NET 和 Visual C# .NET 之间几乎没有性能问题。Visual C# .NET 可能具有更多“强大”功能​​，例如处理非托管代码，而 Visual Basic .NET 通过提供后期绑定等功能，可能会稍微倾向于易于使用。但是，Visual Basic .NET 和 Visual C# 之间的差异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-15T12:01:07.777

> 无论您根据个人偏好和过去的经验选择哪种语言，这两种语言都是强大的开发人员工具和一流的编程语言，它们共享 .NET Framework 中的公共语言运行时。

微软说 [https://web.archive.org/web/20061027230435/http://support.microsoft.com/kb/308470](https://web.archive.org/web/20061027230435/http://support.microsoft.com/kb/308470)

# makefile - 编写make文件

> ID：523723
> 
> 赞同：2
> 
> 时间：2009-02-07T13:10:27.437
> 
> 标签：makefile

谁能给我指出一些关于 make 实用程序的好教程。这将带我从初学者到高级，让我编写和理解各种 linux 软件包附带的专业 make 文件。

一些书也可能有所帮助。

我用谷歌搜索了这个，但有很多。我不知道该读哪一本。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T13:18:51.790

您可以尝试阅读 ORielly 出版物的“使用 GNU Make 管理项目（Nutshell 手册）”一书。这是一本了解 Make Utility 的好书。

您可以在以下网址找到详细信息：[http ://www.amazon.com/dp/0596006101?tag=flazx-20&camp=14573&creative=327641&linkCode=as1&creativeASIN=0596006101&adid=0EN45W92PQCA28N8JJW2&](https://rads.stackoverflow.com/amzn/click/com/0596006101)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T13:16:42.590

[GNU Make 手册](http://www.gnu.org/software/make/manual/html_node/index.html)非常完整，包含许多示例。

# c++ - C/C++ 检查是否设置了一位，即 int 变量

> ID：523724
> 
> 赞同：120
> 
> 时间：2009-02-07T13:10:46.953
> 
> 标签：c++, c, bit-manipulation

```
int temp = 0x5E; // in binary 0b1011110. 
```

有没有这样一种方法可以检查 temp 中的第 3 位是 1 还是 0 而无需移位和屏蔽。

只是想知道是否有一些内置功能，或者我是否被迫自己写一个。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2009-02-07T13:16:29.017

在C语言中，如果你想隐藏位操作，你可以写一个宏：

```
#define CHECK_BIT(var,pos) ((var) & (1<<(pos))) 
```

并以这种方式使用它来检查右端的第 n 位^：

```
CHECK_BIT(temp, n - 1) 
```

在 C++ 中，您可以使用[std::bitset](http://www.cppreference.com/wiki/stl/bitset/start)。

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2009-02-07T13:15:09.270

检查是否设置了位 N（从 0 开始）：

```
temp & (1 << N) 
```

没有内置函数。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-02-07T16:23:02.540

如果它是 C++，我只会使用 std::bitset。简单的。直截了当。没有机会犯愚蠢的错误。

```
typedef std::bitset<sizeof(int)> IntBits;
bool is_set = IntBits(value).test(position); 
```

或者这个愚蠢怎么样

```
template<unsigned int Exp>
struct pow_2 {
    static const unsigned int value = 2 * pow_2<Exp-1>::value;
};

template<>
struct pow_2<0> {
    static const unsigned int value = 1;
};

template<unsigned int Pos>
bool is_bit_set(unsigned int value)
{
    return (value & pow_2<Pos>::value) != 0;
} 

bool result = is_bit_set<2>(value); 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2015-08-06T18:55:20.983

选择的答案实际上是错误的。下面的函数将返回位位置或 0，具体取决于该位是否实际启用。这不是海报所要求的。

```
#define CHECK_BIT(var,pos) ((var) & (1<<(pos))) 
```

这是海报最初寻找的内容。如果启用该位而不是位置，则以下函数将返回 1 或 0。

```
#define CHECK_BIT(var,pos) (((var)>>(pos)) & 1) 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-02-07T16:13:10.453

是的，我知道我没有***“必须”***这样做。但我通常会写：

```
 /* Return type (8/16/32/64 int size) is specified by argument size. */
template<class TYPE> inline TYPE BIT(const TYPE & x)
{ return TYPE(1) << x; }

template<class TYPE> inline bool IsBitSet(const TYPE & x, const TYPE & y)
{ return 0 != (x & y); } 
```

例如：

```
IsBitSet( foo, BIT(3) | BIT(6) );  // Checks if Bit 3 OR 6 is set. 
```

除其他外，这种方法：

*   容纳 8/16/32/64 位整数。
*   在我不知情和同意的情况下检测 IsBitSet(int32,int64) 调用。
*   内联模板，因此没有函数调用开销。
*   **const&**引用，因此无需复制/复制任何***内容***。我们保证编译器会发现任何试图改变参数的错字。
*   **0!=**使代码更加清晰和明显。编写代码的主要目的始终是与其他程序员清晰有效地沟通，包括那些技能较低的程序员。
*   虽然不适用于这种特殊情况......一般来说，模板化函数避免了多次评估参数的问题。一些#define 宏的已知问题。
    例如：#define ABS(X) (((X)<0) ? - (X) : (X))
          ABS(i++);

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-02-07T13:20:45.997

根据对[bit-fields 的描述](http://en.wikipedia.org/wiki/Bit_field)，有一种直接定义和访问字段的方法。此条目中的示例如下：

```
struct preferences {
    unsigned int likes_ice_cream : 1;
    unsigned int plays_golf : 1;
    unsigned int watches_tv : 1;
    unsigned int reads_books : 1;
}; 

struct preferences fred;

fred.likes_ice_cream = 1;
fred.plays_golf = 1;
fred.watches_tv = 1;
fred.reads_books = 0;

if (fred.likes_ice_cream == 1)
    /* ... */ 
```

此外，还有一个警告：

> 然而，结构中的位成员有实际的缺点。首先，内存中位的顺序取决于体系结构，并且内存填充规则因编译器而异。此外，许多流行的编译器为读取和写入位成员生成效率低下的代码，并且由于大多数机器无法操作内存中的任意位集，因此存在与位域相关的潜在严重线程安全问题（尤其是在多处理器系统上），但必须改为加载和存储整个单词。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-02-07T13:14:09.630

您可以使用 Bitset - [http://www.cppreference.com/wiki/stl/bitset/start](http://www.cppreference.com/wiki/stl/bitset/start)。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-02-07T16:23:14.427

使用 std::bitset

```
#include <bitset>
#include <iostream>

int main()
{
    int temp = 0x5E;
    std::bitset<sizeof(int)*CHAR_BITS>   bits(temp);

    // 0 -> bit 1
    // 2 -> bit 3
    std::cout << bits[2] << std::endl;
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-05-15T12:51:08.070

我试图读取一个 32 位整数，它定义了 PDF 中对象的标志，但这对我不起作用

什么修复了它改变了定义：

```
#define CHECK_BIT(var,pos) ((var & (1 << pos)) == (1 << pos)) 
```

操作数 & 返回一个整数，其标志都在 1 中，并且它没有正确转换为布尔值，这起到了作用

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-04-09T04:05:45.617

我用这个：

```
#define CHECK_BIT(var,pos) ( (((var) & (pos)) > 0 ) ? (1) : (0) ) 
```

其中“pos”定义为 2^n (ig 1,2,4,8,16,32 ...)

返回： 1 如果为真 0 如果为假

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-07T13:19:35.203

有，即[_bittest](http://msdn.microsoft.com/en-us/library/h65k4tze(VS.80).aspx)内在指令。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-03-05T11:50:09.463

```
#define CHECK_BIT(var,pos) ((var>>pos) & 1) 
```

pos - 从 0 开始的位位置。

返回 0 或 1。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-09T16:35:46.873

对于低级 x86 特定解决方案，请使用 x86 [TEST](http://www.itis.mn.it/linux/quarta/x86/test.htm)操作码。

你的编译器应该把[_bittest](http://msdn.microsoft.com/en-us/library/h65k4tze(VS.80).aspx)变成这个...

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-07T13:16:36.147

您可以“模拟”移位和屏蔽： if((0x5e/(2*2*2))%2) ...

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-10-15T15:37:27.870

为什么不使用这么简单的东西呢？

```
uint8_t status = 255;
cout << "binary: ";

for (int i=((sizeof(status)*8)-1); i>-1; i--)
{
  if ((status & (1 << i)))
  {
    cout << "1";
  } 
  else
  {
    cout << "0";
  }
} 
```

输出：二进制：`11111111`

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-05-25T09:31:51.683

一种方法是在以下条件下进行检查：

```
if ( (mask >> bit ) & 1) 
```

一个解释程序将是：

```
#include <stdio.h>

unsigned int bitCheck(unsigned int mask, int pin);

int main(void){
   unsigned int mask = 6;  // 6 = 0110
   int pin0 = 0;
   int pin1 = 1;
   int pin2 = 2;
   int pin3 = 3;
   unsigned int bit0= bitCheck( mask, pin0);
   unsigned int bit1= bitCheck( mask, pin1);
   unsigned int bit2= bitCheck( mask, pin2);
   unsigned int bit3= bitCheck( mask, pin3);

   printf("Mask = %d ==>>  0110\n", mask);

   if ( bit0 == 1 ){
      printf("Pin %d is Set\n", pin0);
   }else{
      printf("Pin %d is not Set\n", pin0);
   }

    if ( bit1 == 1 ){
      printf("Pin %d is Set\n", pin1);
   }else{
      printf("Pin %d is not Set\n", pin1);
   }

   if ( bit2 == 1 ){
      printf("Pin %d is Set\n", pin2);
   }else{
      printf("Pin %d is not Set\n", pin2);
   }

   if ( bit3 == 1 ){
      printf("Pin %d is Set\n", pin3);
   }else{
      printf("Pin %d is not Set\n", pin3);
   }
}

unsigned int bitCheck(unsigned int mask, int bit){
   if ( (mask >> bit ) & 1){
      return 1;
   }else{
      return 0;
   }
} 
```

输出：

> ```
> Mask = 6 ==>>  0110
> Pin 0 is not Set
> Pin 1 is Set
> Pin 2 is Set
> Pin 3 is not Set 
> ```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-07T14:30:59.380

如果你只是想要一个真正的硬编码方式：

```
 #define IS_BIT3_SET(var) ( ((var) & 0x04) == 0x04 ) 
```

注意这个硬件依赖并假设这个位顺序 7654 3210 和 var 是 8 位。

```
#include "stdafx.h"
#define IS_BIT3_SET(var) ( ((var) & 0x04) == 0x04 )
int _tmain(int argc, _TCHAR* argv[])
{
    int temp =0x5E;
    printf(" %d \n", IS_BIT3_SET(temp));
    temp = 0x00;
    printf(" %d \n", IS_BIT3_SET(temp));
    temp = 0x04;
    printf(" %d \n", IS_BIT3_SET(temp));
    temp = 0xfb;
    printf(" %d \n", IS_BIT3_SET(temp));
    scanf("waitng %d",&temp);

    return 0;
} 
```

结果是：

1 0 1 0

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-07-10T08:59:09.463

虽然现在回答已经很晚了，但是有一种简单的方法可以找到是否设置了第 N 位，只需使用 POWER 和 MODULUS 数学运算符。

假设我们想知道“temp”是否设置了第 N 位。如果设置了位，则以下布尔表达式将为真，否则为 0。

*   （温度模量 2^N+1 >= 2^N）

考虑以下示例：

*   国际温度 = 0x5E；// 二进制 0b1011110 // BIT 0 是 LSB

如果我想知道是否设置了第 3 位，我会得到

*   (94 模数 16) = 14 > 2^3

所以表达式返回真，表示设置了第 3 位。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-09-22T16:23:15.707

为什么所有这些位移操作和需要库函数？如果您有 OP 发布的值：1011110 并且您想知道右侧第三个位置的位是否已设置，只需执行以下操作：

```
int temp = 0b1011110;
if( temp & 4 )   /* or (temp & 0b0100) if that's how you roll */
  DoSomething(); 
```

或者，不需要#include 的代码的未来读者可能更容易解释的东西：

```
int temp = 0b1011110;
_Bool bThirdBitIsSet = (temp & 4) ? 1 : 0;
if( bThirdBitIsSet )
  DoSomething(); 
```

或者，如果您希望它看起来更漂亮：

```
#include <stdbool.h>
int temp = 0b1011110;
bool bThirdBitIsSet = (temp & 4) ? true : false;
if( bThirdBitIsSet )
  DoSomething(); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-09-30T10:23:54.867

先前的答案向您展示了如何处理位检查，但更多情况下并非如此，这都是关于以整数编码的标志，这在任何先例情况下都没有得到很好的定义。

在典型情况下，标志本身被定义为整数，它所指的特定位为 1。在下面的示例中，您可以检查整数是否具有标志列表中的任何标志（连接多个错误标志）或是否每个标志都在整数中（连接多个成功标志）。

以下示例说明了如何处理整数中的标志。

此处提供实时示例： [https ://rextester.com/XIKE82408](https://rextester.com/XIKE82408)

```
//g++  7.4.0

#include <iostream>
#include <stdint.h>

inline bool any_flag_present(unsigned int value, unsigned int flags) {
    return bool(value & flags);
}

inline bool all_flags_present(unsigned int value, unsigned int flags) {
    return (value & flags) == flags;
}

enum: unsigned int {
    ERROR_1 = 1U,
    ERROR_2 = 2U, // or 0b10
    ERROR_3 = 4U, // or 0b100
    SUCCESS_1 = 8U,
    SUCCESS_2 = 16U,
    OTHER_FLAG = 32U,
};

int main(void)
{
    unsigned int value = 0b101011; // ERROR_1, ERROR_2, SUCCESS_1, OTHER_FLAG
    unsigned int all_error_flags = ERROR_1 | ERROR_2 | ERROR_3;
    unsigned int all_success_flags = SUCCESS_1 | SUCCESS_2;

    std::cout << "Was there at least one error: " << any_flag_present(value, all_error_flags) << std::endl;
    std::cout << "Are all success flags enabled: " << all_flags_present(value, all_success_flags) << std::endl;
    std::cout << "Is the other flag enabled with eror 1: " << all_flags_present(value, ERROR_1 | OTHER_FLAG) << std::endl;
    return 0;
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-02-16T18:00:45.473

快速和最佳的宏

```
#define get_bit_status()    ( YOUR_VAR  &   ( 1 << BITX ) )

.
.

if (get_rx_pin_status() == ( 1 << BITX ))
{
    do();
} 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2020-01-16T14:17:43.197

我做这个：

LATGbits.LATG0=((m&0x8)>0); //检查m的bit-2是否为1

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2010-11-23T10:37:56.043

最快的方法似乎是掩码的查找表

# wpf - 为什么 XAML 资源与 CSS 样式不同？

> ID：523727
> 
> 赞同：4
> 
> 时间：2009-02-07T13:12:25.903
> 
> 标签：wpf, xaml, resources, blend

在 Expression Blend 中，您可以创建一个例如 18 的字体大小，然后创建一个“字体大小资源”。

从 HTML/CSS 开始，我想不出什么时候我想为“字体大小”制作一种样式，为“字体样式”制作一种样式，为“字体粗细”制作一种样式。相反，我想制作一个名为“CompanyHeader”的字体，并在其中设置 10 个不同的属性，例如字体粗细、字体样式、字体大小、颜色等。

为什么这在 Expression Blend、XAML 中有所不同，为每个属性制作样式/资源是什么意思？

*此图显示了如何单击每个属性上的小按钮将其更改为资源：* [alt text http://tanguay.info/web/external/blendStyles.png](http://tanguay.info/web/external/blendStyles.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-08T11:58:15.820

我没有使用 Blend 的经验，但是 XAML 中的样式可以包含多个属性，不仅如此，因为与 css 不同，您只能将一种样式应用于无法组合多个单一属性样式的元素。

这是设置多个属性的样式的示例：

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
   <Page.Resources>
      <Style x:Key="MyStyle" TargetType="{x:Type Label}">
         <Setter Property="Width" Value="125"/>
         <Setter Property="Height" Value="25"/>
         <Setter Property="Background" Value="Red"/>
      </Style>
   </Page.Resources>
   <Label Style="{StaticResource MyStyle}"/>
</Page> 
```

请注意，如果我想将样式分成 3 个较小的样式，每个样式都设置一个属性，我无法使用它们，因为 Label 的 Style 属性只能接受一种样式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-07T14:04:01.137

我认为它们可能允许为 FontFamily、FontWeight 等创建单一资源，以允许它们在应用程序中的多种样式中使用。通过在资源中放置单个属性，您可以一次使用该资源来影响所有样式。如果您没有使用资源，而是尝试在整个应用程序（或其中的一部分）中使用一致的 FontFamily，那么您必须一次通过每种样式来更新它。

为了在混合中创建具有多个属性的样式，您可以执行以下操作：

*   选择您想要设置样式的控件（控件的类型将用作样式的 TargetType）
*   从菜单中选择对象->编辑样式->创建空
*   输入您要分配给样式的键（这是您将用来引用样式的名称）
*   转到属性选项卡并开始应用该样式所需的外观/感觉

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-07T13:58:13.597

它允许您在更精细的级别重用字体细节，而不是必须定义字体定义的所有元素。您可能有几种样式都继承自相同的字体大小定义。然后，您的设计师可以更改字体大小，所有使用它的样式都会自动更新外观。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-03T02:44:09.917

字体的每个实例都将使用自己的资源，如果多个这样的定义引用相同的字体并不重要。

在两种不同的样式中使用相同的字体最终会产生两个字体实例（当应用样式时）。Instade，您可以将字体定义为自己的样式，并在其他样式中使用该样式。在这种情况下，两种样式都会使用一次字体资源的运行时实例。

如果您有非常复杂的资源字典（例如，您正在创建一个主题），最好将通用资产（如特定颜色画笔或字体）定义为独立资源（或命名样式）并在其他复杂的样式以节省系统资源。

关于您关于 Blend 的问题，它简单地执行了这种最佳实践。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T15:27:52.800

这可以通过创建一个辅助类来使用和包装您的样式来实现。[这里](http://socialeboladev.wordpress.com/2012/10/04/using-multiple-styles-on-elements-in-xaml-windows-8wp7/)提到的 CompoundStyle展示了如何做到这一点。有多种方法，但最简单的方法是执行以下操作：

```
<TextBlock Text="Test"
    local:CompoundStyle.StyleKeys="headerStyle,textForMessageStyle,centeredStyle"/> 
```

博客文章讨论了 Win8 和 Windows Phone，但同样的代码也适用于 WPF（减去不需要的 Utilies 类）

希望有帮助。

# indexing - 压缩排序整数

> ID：523733
> 
> 赞同：11
> 
> 时间：2009-02-07T13:15:09.910
> 
> 标签：indexing, compression, integer

我正在构建一个索引，它只是连续存储在二进制文件中的几组有序 32 位整数。问题是这个文件变得非常大。我一直在考虑添加一些压缩方案，但这有点超出我的专业知识。所以我想知道，在这种情况下哪种压缩算法效果最好？此外，解压缩必须快速，因为该索引将用于进行查找。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-07T13:41:08.063

如果您要存储靠近在一起的整数（例如：1、3、4、5、9、10 等...）而不是一些随机的 32 位整数（982346...、3487623412...等），您可以这样做一件事：

找到相邻数字之间的**差异，例如 2,1,1,4,1... 等（在我们的示例中），然后****Huffman 对**这些数字进行编码。

如果您直接将它们应用于您拥有的原始数字列表，我认为霍夫曼编码不会起作用。

但是，如果您有一个附近数字的排序列表，那么通过对数字差异进行霍夫曼编码，您将获得非常好的压缩比，这可能比使用 Zip 库中使用的 LZW 算法更好。

无论如何，感谢您发布这个有趣的问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-07T13:34:20.930

整数是以密集方式还是稀疏方式分组？

密集我指的是：

`[1, 2, 3, 4, 42, 43, 78, 79, 80, 81]`

稀疏我指的是：

`[1, 4, 7, 9, 19, 42, 53, 55, 78, 80]`

如果整数以密集方式分组，您可以压缩第一个向量以容纳三个范围：

`[(1, 4), (42, 43), (78, 81)]`

这是 40% 的压缩。当然，这种算法不适用于稀疏数据，因为*压缩*后的数据会比原始数据多占用 100% 的空间。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-18T12:01:52.347

正如您所发现的，N 个 32 位整数的排序序列没有 32*N 位数据。这并不奇怪。假设没有重复，对于每个排序的序列有 N! 包含相同整数的未排序序列。

现在，您如何利用排序序列中的有限信息？许多压缩算法的压缩基于对公共输入值使用较短的位串（Huffman 仅使用此技巧）。一些海报已经建议计算数字之间的差异，并压缩这些差异。他们假设这将是一系列小数字，其中许多是相同的。在这种情况下，大多数算法将很好地压缩差异序列。

但是，采用斐波那契数列。那绝对是排序的整数。F(n) 和 F(n+1) 之间的差异是 F(n-1)。因此，压缩差异序列等同于压缩序列本身 - 它根本没有帮助！

所以，我们真正需要的是输入数据的统计模型。给定序列 N[0]...N[x]，N[x+1] 的概率分布是多少？我们知道 P(N[x+1] < N[x]) = 0，因为序列已排序。提出的基于差分/霍夫曼的解决方案是有效的，因为它们假设 P(N[x+1] - N[x] = d) 对于小的正 d 非常高并且与 x 无关，因此他们可以使用一些位来表示小的差异。如果您可以提供另一个模型，您可以针对它进行优化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-17T13:25:02.610

如果您需要快速随机访问查找，那么差异的霍夫曼编码（如 Niyaz 所建议的）只是故事的一半。您可能还需要某种分页/索引方案，以便轻松提取第 n 个数字。

如果你不这样做，那么提取第 n 个数字是一个 O(n) 操作，因为你必须阅读并 Huffman 解码一半文件才能找到你想要的数字。您必须仔细选择页面大小，以平衡存储页面偏移量与查找速度的开销。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-19T05:51:53.620

MSalters 的回答很有趣，但如果您没有正确分析，可能会分散您的注意力。只有 47 个斐波那契数适合 32 位。

但是他很清楚如何通过分析一系列增量来找到要压缩的模式来正确解决问题。

重要的事情： a) 是否存在重复值？如果有，多久一次？（如果重要的话，让它成为压缩的一部分，如果不让它成为一个例外。） b）它看起来是准随机的吗？这也可能很好，因为可能会找到合适的平均增量。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-07T13:19:50.740

我想[霍夫曼编码](http://en.wikipedia.org/wiki/Huffman_encoding)将非常适合此目的（并且与具有相似压缩比的其他算法相比相对较快）。

编辑：我的回答只是一个一般性的指针。Niyaz 建议对连续数字之间的差异进行编码是一个很好的建议。（但是，如果列表*未*排序或数字间距非常不规则，我认为使用普通 Huffman 编码同样有效。事实上，在这种情况下 LZW 或类似代码可能是最好的，尽管可能仍然不是很好.)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-07T13:52:19.677

整数列表上的条件略有不同，但[针对唯一数据流的压缩](https://stackoverflow.com/questions/274196/compression-for-a-unique-stream-of-data)问题提出了几种可以帮助您的方法。

我建议将数据预过滤为 a`start`和一系列`offset`s。如果您知道偏移量确实很小，您甚至可以将它们编码为 1 或 2 字节数量而不是 4 字节。如果您不知道这一点，每个偏移量仍可能是 4 个字节，但由于它们将是小的差异，您将获得比存储原始整数更多的重复。

预过滤后，通过您选择的压缩方案运行您的输出 - 在字节级别上工作的东西，如 gzip 或 zlib，可能会做得非常好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-07T13:41:01.073

在投资您自己的计划之前，我会使用现成的标准。

例如，在 Java 中，您可以使用[GZIPOutputStream](http://java.sun.com/javase/6/docs/api/java/util/zip/GZIPOutputStream.html)来应用 gzip 压缩。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-07T13:59:00.897

也许您可以将连续 32 位整数之间的*差异*存储为 16 位整数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-29T17:18:37.650

一个可靠且有效的解决方案是 1\. 通过减去连续数字来获取增量（例如`[1, 3, 7, 12] => 1 + [2, 4, 5]`，以您喜欢的任何方式对第一个数字进行编码，然后 2\. 应用分位数压缩（[https://github.com/mwlon/quantile-compression/](https://github.com/mwlon/quantile-compression/)）分位数压缩接近平滑分布的香农熵，所以无论你有多少重复数字或广泛分布的数字，它都会让你接近最优。

# sql - 更新 SQL 2005 中的触发器行为

> ID：523760
> 
> 赞同：1
> 
> 时间：2009-02-07T13:27:23.317
> 
> 标签：sql, sql-server, sql-server-2005

我在过程中使用了 Update 语句来更新具有更新触发器的表。触发器完成后更新语句是否完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T13:29:56.587

触发器作为 UPDATE 语句的一部分运行（在表中的数据更新后）；proc 在此之后恢复。还有*替换*UPDATE 语句的“instead of”触发器。

请参阅[此处](http://msdn.microsoft.com/en-us/magazine/cc164047.aspx)了解更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T13:31:13.747

SQL Server 中有两种类型的触发器。INSTEAD OF 触发器和 AFTER 触发器。默认情况下，触发器是 AFTER 触发器，这意味着会发生这种情况。考虑 TableA，它具有更新 TableB 的 UPDATE AFTER TRIGGER。

*   问题声明：UPDATE TableA set XXX = 5;
*   表 A 得到更新
*   触发器触发，并且 TableB 得到更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T06:45:20.053

触发器附加到触发它们的语句，并且隐含地是触发它们的事务的一部分。

例如：

如果由于 update 触发了触发器，那么它有助于理解数据库将隐式插入围绕该更新 的*begin tran*和*end tran 。*

# java - 如何在 Java 中设置背景图像？

> ID：523767
> 
> 赞同：22
> 
> 时间：2009-02-07T13:30:44.073
> 
> 标签：java, image, background, set

我正在使用 BlueJ 作为 IDE 使用 Java 开发一个简单的平台游戏。现在，我在游戏中使用多边形和简单形状绘制了玩家/敌人精灵、平台和其他项目。最终我希望用实际图像替换它们。

现在我想知道将图像（URL 或来自本地源）设置为我的游戏窗口/画布的“背景”的最简单解决方案是什么？

如果它不是很长或不太复杂，我将不胜感激，因为我的编程技能不是很好，我想让我的程序尽可能简单。请提供带有注释的示例代码来详细说明它们的功能，如果它在它自己的类中，如何调用它在其他类中使用的相关方法。

非常感谢你。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-07T14:08:59.503

[根据应用程序或小程序使用的是AWT](http://java.sun.com/javase/6/docs/technotes/guides/awt/)还是[Swing](http://java.sun.com/docs/books/tutorial/uiswing/index.html)，答案会略有不同。

（基本上，以和开头的类`J`是Swing，和是 A​​WT。）`JApplet``JFrame``Applet``Frame`

无论哪种情况，基本步骤都是：

1.  将图像绘制或加载到`Image`对象中。
2.  在要绘制背景的绘画事件中绘制背景图像`Component`。

**Step 1.**加载图片可以是使用[`Toolkit`](http://java.sun.com/javase/6/docs/api/java/awt/Toolkit.html)类，也可以是[`ImageIO`](http://java.sun.com/javase/6/docs/api/javax/imageio/ImageIO.html)类。

该[`Toolkit.createImage`](http://java.sun.com/javase/6/docs/api/java/awt/Toolkit.html#createImage(java.lang.String))方法可用于`Image`从 a 中指定的位置加载 a `String`：

```
Image img = Toolkit.getDefaultToolkit().createImage("background.jpg"); 
```

同样，`ImageIO`可以使用：

```
Image img = ImageIO.read(new File("background.jpg"); 
```

**步骤 2.**应该获取背景的绘制方法`Component`将需要被覆盖并将 绘制`Image`到组件上。

对于 AWT 来说，要覆盖的方法就是[`paint`](http://java.sun.com/javase/6/docs/api/java/awt/Component.html#paint(java.awt.Graphics))方法，并使用传递给[`drawImage`](http://java.sun.com/javase/6/docs/api/java/awt/Graphics.html#drawImage(java.awt.Image,%20int,%20int,%20java.awt.image.ImageObserver))方法的[`Graphics`](http://java.sun.com/javase/6/docs/api/java/awt/Graphics.html)对象的`paint`方法：

```
public void paint(Graphics g)
{
    // Draw the previously loaded image to Component.
    g.drawImage(img, 0, 0, null);

    // Draw sprites, and other things.
    // ....
} 
```

对于 Swing，要覆盖的方法是 的[`paintComponent`](http://java.sun.com/javase/6/docs/api/javax/swing/JComponent.html#paintComponent(java.awt.Graphics))方法[`JComponent`](http://java.sun.com/javase/6/docs/api/javax/swing/JComponent.html)，并绘制`Image`与在 AWT 中所做的一样的方法。

```
public void paintComponent(Graphics g)
{
　　　　// Draw the previously loaded image to Component.
　　　　g.drawImage(img, 0, 0, null);

　　　　// Draw sprites, and other things.
　　　　// ....
} 
```

**简单组件示例**

这是`Panel`在实例化时加载图像文件并在其自身上绘制该图像的一个：

```
class BackgroundPanel extends Panel
{
    // The Image to store the background image in.
    Image img;
    public BackgroundPanel()
    {
        // Loads the background image and stores in img object.
        img = Toolkit.getDefaultToolkit().createImage("background.jpg");
    }

    public void paint(Graphics g)
    {
        // Draws the img to the BackgroundPanel.
        g.drawImage(img, 0, 0, null);
    }
} 
```

有关绘画的更多信息：

*   [在 AWT 和 Swing 中绘画](http://java.sun.com/products/jfc/tsc/articles/painting/)
*   [课程： Java 教程](http://java.sun.com/docs/books/tutorial/index.html)中的执行自[定义绘画](http://java.sun.com/docs/books/tutorial/uiswing/painting/)可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T19:50:14.613

首先创建一个扩展类的新`WorldView`类。我打电话给我的新班级`Background`。因此，在这个新类中，导入您需要的所有 Java 包以覆盖该`paintBackground`方法。这应该是：

```
import city.soi.platform.*;
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.image.ImageObserver;
import javax.swing.ImageIcon;
import java.awt.geom.AffineTransform; 
```

接下来在类名之后确保它说 extends `WorldView`。像这样的东西：

```
public class Background extends WorldView 
```

然后声明变量 game 类型`Game`和一个 image 类型变量，`Image`如下所示：

```
private Game game;
private Image image; 
```

然后在这个类的构造函数中确保游戏类型`Game`在构造函数的签名中，并且在对你的调用中`super`必须初始化`WorldView`，初始化游戏并初始化图像变量，如下所示：

```
super(game.getCurrentLevel().getWorld(), game.getWidth(), game.getHeight());
this.game = game;
bg = (new ImageIcon("lol.png")).getImage(); 
```

然后，您只需以与在类中覆盖`paintBackground`方法时完全相同的方式覆盖该`paint`方法`Player`。像这样：

```
public void paintBackground(Graphics2D g)
{
float x = getX();
float y = getY();
AffineTransform transform = AffineTransform.getTranslateInstance(x,y);
g.drawImage(bg, transform, game.getView());
} 
```

现在最后你必须声明一个对你刚刚在类中创建的新类的类级引用，并在构造函数`Game`中初始化它，如下所示：`Game`

```
private Background image;

And in the Game constructor:
image = new Background(this); 
```

最后，您所要做的就是将背景添加到框架中！这就是我确定我们都缺少的东西。为此，您必须在`frame`声明变量后执行以下操作：

```
frame.add(image); 
```

确保您在之前添加此代码`frame.pack();`。还要确保使用不太大的背景图像！

现在就是这样！我注意到游戏引擎可以处理 JPEG 和 PNG 图像格式，但也可以支持其他格式。尽管这有助于在您的游戏中包含背景图像，但它并不完美！因为一旦你进入下一个级别，你的所有平台和精灵都是不可见的，你所能看到的只是你的背景图像和你在游戏中包含的任何 JLabels/Jbuttons。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T21:33:08.477

或者试试这个；）

```
try {
  this.setContentPane(
    new JLabel(new ImageIcon(ImageIO.read(new File("your_file.jpeg")))));
} catch (IOException e) {}; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-26T01:56:14.960

如果您真的是 Java 新手，那么路径是您真正需要担心的唯一事情。您需要将图像拖到主项目文件中，它将显示在列表的最底部。

然后文件路径非常简单。此代码进入类的构造函数。

```
 img = Toolkit.getDefaultToolkit().createImage("/home/ben/workspace/CS2/Background.jpg"); 
```

CS2 是我的项目的名称，之前的所有内容都指向工作区。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-04-01T14:21:28.477

```
<script>
function SetBack(dir) {
    document.getElementById('body').style.backgroundImage=dir;
}
SetBack('url(myniftybg.gif)');
</script> 
```

# ruby-on-rails - 为什么我的夹具对象在我的 Rails Test::Unit 测试中不可用？

> ID：523771
> 
> 赞同：3
> 
> 时间：2009-02-07T13:32:41.370
> 
> 标签：ruby-on-rails, testing

根据[这个 Rails 指南](http://guides.rubyonrails.org/testing_rails_applications.html#_the_low_down_on_fixtures)，如果你创建了一个fixture，它就可以在你的测试类中使用。

我有这个夹具`users.yml`：

```
<%
  stan = User.new
  stan.username = 'stan'
  stan.set_hashed_password('mysterio')
  stan.email = 'stan@abc.com'
%>

stan:
  username: <%= stan.username %>
  hashed_password: <%= stan.hashed_password %>
  password_salt: <%= stan.password_salt %>
  email: <%= stan.email %> 
```

按照 Rails 指南，我尝试像这样访问它：

```
class SessionsControllerTest < ActionController::TestCase

  @user = users(:stan)

  # ...

end 
```

我收到此错误：

```
./test/functional/sessions_controller_test.rb:5: undefined method `users' for SessionsControllerTest:Class (NoMethodError)
    from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
    from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
    from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:155:in `require' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-07T13:39:39.237

试着放

```
fixtures :users 
```

在你的班级声明之后

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-07T13:38:43.747

确保你有

```
fixtures :all 
```

在你的 test_helper.rb

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-07T14:06:15.173

谢谢你们的帮助。我意识到我的各种声明和调用结构不正确。这在我引用的指南中没有明确解释，但显然`users(:stan)`只能在`should`块内工作，或者在方法内的纯 Test::Unit 中工作`test_`。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-05-20T11:23:18.330

这是一个非常老的问题，但是我刚才在阅读 rails 教程时遇到了类似的问题。

在我的 UsersLoginTest 集成测试开始时我有一个设置方法，由于某种原因，我在其中引用的夹具似乎没有在测试中工作。我必须在测试的顶部有一行 @user = users(:michael) 才能让它工作。

最后，我发现我已经复制了文件顶部的 Class 声明，通过从教程书中的 LAZY 复制和粘贴。因此，如果其他人在此线程中遇到与固定装置不起作用相关的类似问题，请检查您是否犯了与我一样的愚蠢错误，并复制了文件的顶部！

```
require 'test_helper'

class UsersLoginTest < ActionDispatch::IntegrationTest

  def setup
    @user = users(:michael)
  end 
```

# perl - 如何在 Perl 中找到链接的内容类型？

> ID：523773
> 
> 赞同：0
> 
> 时间：2009-02-07T13:33:18.607
> 
> 标签：perl, content-type

假设您有一个 URL，[http://site.com](http://site.com)。您如何在不下载的情况下找出它的内容类型？Perl 的[WWW::Mechanize](http://search.cpan.org/dist/WWW-Mechanize)或[LWP](http://search.cpan.org/dist/libwww-perl)可以发出 HEAD 请求吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-07T13:38:24.103

您可以通过`head()`以下方式使用 LWP 的方法

```
use LWP::UserAgent;
$ua = LWP::UserAgent->new;
$ua->head('<url>'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T21:40:21.200

这是一个完整的例子：

```
use LWP::UserAgent;

$ua = LWP::UserAgent->new;
my $response = $ua->head( 'http://www.perl.com' );

my $type = $response->content_type;

print "The type is $type\n"; 
```

一些服务器在 HEAD 请求上阻塞，所以当我这样做并得到任何类型的错误时，我会用 GET 请求重试它，并且只请求前几百个字节的资源。

# history - 计算/软件的历史 1995 年至今？

> ID：523783
> 
> 赞同：-1
> 
> 时间：2009-02-07T13:40:09.000
> 
> 标签：history

我刚读完 Mitchell Waldrop 的一本好书，叫做《梦想机器》。作者很好地连接了各个点，并展示了一幅详细的图片，详细说明了不同大学和公司的研究是如何结合在一起的，以及计算机是如何成为家用商品的。我非常喜欢这本书的地方是：

1.  整个故事是如何讲述的，尽管标题暗示是 JCR Licklider（又名“Lick”）的自传，但它的意义远不止于此。它详细介绍了在美国不同角落发生的各种研究，以及它们如何在 Lick 和其他人的远见卓识的指导下共同为我们提供 PC。
2.  故事的人性化角度，Lick 伟大的整体视野以及识别才华横溢的人并推动他们（推动他们）朝着共同目标前进的能力。施乐没有认识到艾伦凯和黑帮的潜力是愚蠢的。

现在来谈谈我的帖子的原因。当这本书的结尾只简短地提到了现代时代、Apple 的诞生以及 PARC 演示对史蒂夫乔布斯的影响时，我感到非常失望。微软的商业头脑和 IBM 看不到会发生什么等等。它一直在继续，我被迷住了，想要更多！！在 Waldrop 先生离开的当前计算发展时期，是否有任何类似的历史记录？类似的东西，只是没有干巴巴地描述这些技术，而是给它背后的人一个高峰。浏览器大战？谷歌？Java的诞生？谷歌？云计算，是未来吗？谁是现代克劳德香农，艾伦凯斯，冯诺依曼？谁是 Licks 和 Bob Taylors 将当前的伟大思想聚集在一起，或者这些事情已经成为过去？我们再也不会看到这种协调一致和有针对性的研究了吗？什么是真正的技术，什么只是营销绒毛？我知道很多这样的信息都在那里，但我已经被梦想机器宠坏了。我正在寻找 Dream Machine redux。我对这篇文章的希望是三个方面：

1.  有人可以给我指一本已经出版的书，这太棒了。
2.  一本书正在制作中，很快就会出版，这会给我一些值得一看的东西。
3.  我可以启发某人写它:)。Waldrop 先生，如果你曾经在 Stackoverflow 停下来阅读这篇文章，怎么样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T13:43:19.650

[这篇关于自 1980 年以来计算领域的重大新发明的](https://stackoverflow.com/questions/432922/significant-new-inventions-in-computing-since-1980)帖子可能对您有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T15:42:25.353

A book that I really enjoyed reading that has a good take on the people as well as the technology involved with the creation of the web is *how the web was born* by Gillies and Cailliau. But this ends in 1999 I think and goes way back as well so probably pretty much duplicates what you have already read, but it does make a good read, can recommend this.

# c# - 文件上传错误

> ID：523793
> 
> 赞同：0
> 
> 时间：2009-02-07T13:46:22.310
> 
> 标签：c#, asp.net, http, file, upload

这是我在客户端和服务器端的代码。我的代码很简单，只需将文件上传到 ASP.Net 网站。

我的客户端代码在 Vista（x64、Enterprise、SP1）上运行时抛出异常，但在 Windows Server 2003 上运行良好。

有任何想法吗？

10.10.12.162 是我的服务器地址。

[代码] 客户：

```
 static void Main(string[] args)
    {
        Console.Write("\nPlease enter the URI to post data to : ");
        String uriString = Console.ReadLine();

        WebClient myWebClient = new WebClient();

        Console.WriteLine("\nPlease enter the fully qualified path of the file to be uploaded to the URI");
        string fileName = Console.ReadLine();
        Console.WriteLine("Uploading {0} to {1} ...", fileName, uriString);

        DateTime begin = DateTime.Now;

        byte[] responseArray = null;
        try
        {
            responseArray = myWebClient.UploadFile(uriString, fileName);
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
            Console.WriteLine(ex.ToString());
        }

        DateTime end = DateTime.Now;

        Console.WriteLine("Elapsed time is: {0}", (end - begin).TotalMilliseconds);
    } 
```

服务器：

```
public partial class FileUploadHandler : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        foreach (string f in Request.Files.AllKeys)
        {
            HttpPostedFile file = Request.Files[f];
            file.SaveAs("D:\\UploadFile\\UploadedFiles\\" + file.FileName);
        }
    }
} 
```

来自客户端的异常：

无法连接到远程服务器 System.Net.WebException：无法连接到远程服务器 ---> System.Net。Sockets.SocketException：无法建立连接，因为目标计算机在 System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure) 的 System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddre ss socketAddress) 处主动拒绝了它, Sock et s4, Socket s6, Socket& socket, IPAddress& address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception& exception)---内部异常堆栈跟踪结束---在 System.Net.WebClient.UploadFile(Uri address, String 方法，String fileName e) at FileUploadClient.Program.Main(String[] args) in D:\UploadFile\FileUploadClient\Program.cs:line 30 [/Code]

问候，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T13:58:34.423

这段代码没有什么能让我太震惊的。

在导致您出现问题的计算机上打开远程桌面。打开命令行。发出命令：

远程登录 10.10.12.162 1031

您是否看到光标，或者 telnet 是否给您一个无法连接的错误？如果您从 telnet 收到错误，您可能遇到了与您的代码无关的 NIC 问题/防火墙问题/路由器问题/其他连接问题。

# php - 检查一个数组的元素是否在 PHP 中的另一个数组中

> ID：523796
> 
> 赞同：149
> 
> 时间：2009-02-07T13:48:53.333
> 
> 标签：php, arrays

我在 PHP 中有两个数组，如下所示：

*人们：*

```
Array
(
    [0] => 3
    [1] => 20
) 
```

*通缉犯：*

```
Array
(
    [0] => 2
    [1] => 4
    [2] => 8
    [3] => 11
    [4] => 12
    [5] => 13
    [6] => 14
    [7] => 15
    [8] => 16
    [9] => 17
    [10] => 18
    [11] => 19
    [12] => 20
) 
```

如何检查是否有**任何***People*元素在*通缉犯*数组中？

在这个例子中，它应该返回`true`，因为`20`它在*Wanted Crimes*中。

* * *

## 回答 #1

> 赞同：238
> 
> 时间：2009-02-07T13:50:48.260

您可以使用[`array_intersect()`](http://www.php.net/array_intersect).

```
$result = !empty(array_intersect($people, $criminals)); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-01-05T00:57:28.127

使用 array_intersect() 和 count() （而不是空的）几乎没有错。

例如：

```
$bFound = (count(array_intersect($criminals, $people))) ? true : false; 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2013-11-12T20:22:48.420

如果 'empty' 不是最好的选择，那该怎么办：

```
if (array_intersect($people, $criminals)) {...} //when found 
```

或者

```
if (!array_intersect($people, $criminals)) {...} //when not found 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2010-07-28T14:40:24.287

该代码无效，因为您只能将变量传递给语言结构。`empty()`是一种语言结构。

您必须分两行执行此操作：

```
$result = array_intersect($people, $criminals);
$result = !empty($result); 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2015-06-18T15:12:46.833

in_array 与 array_intersect 的性能测试：

```
$a1 = array(2,4,8,11,12,13,14,15,16,17,18,19,20);

$a2 = array(3,20);

$intersect_times = array();
$in_array_times = array();
for($j = 0; $j < 10; $j++)
{
    /***** TEST ONE array_intersect *******/
    $t = microtime(true);
    for($i = 0; $i < 100000; $i++)
    {
        $x = array_intersect($a1,$a2);
        $x = empty($x);
    }
    $intersect_times[] = microtime(true) - $t;

    /***** TEST TWO in_array *******/
    $t2 = microtime(true);
    for($i = 0; $i < 100000; $i++)
    {
        $x = false;
        foreach($a2 as $v){
            if(in_array($v,$a1))
            {
                $x = true;
                break;
            }
        }
    }
    $in_array_times[] = microtime(true) - $t2;
}

echo '<hr><br>'.implode('<br>',$intersect_times).'<br>array_intersect avg: '.(array_sum($intersect_times) / count($intersect_times));
echo '<hr><br>'.implode('<br>',$in_array_times).'<br>in_array avg: '.(array_sum($in_array_times) / count($in_array_times));
exit; 
```

结果如下：

```
0.26520013809204
0.15600109100342
0.15599989891052
0.15599989891052
0.1560001373291
0.1560001373291
0.15599989891052
0.15599989891052
0.15599989891052
0.1560001373291
array_intersect avg: 0.16692011356354

0.015599966049194
0.031199932098389
0.031200170516968
0.031199932098389
0.031200885772705
0.031199932098389
0.031200170516968
0.031201124191284
0.031199932098389
0.031199932098389
in_array avg: 0.029640197753906 
```

in_array 至少快 5 倍。请注意，一旦找到结果，我们就会“中断”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-11-05T20:02:03.570

您还可以使用 in_array 如下：

```
<?php
$found = null;
$people = array(3,20,2);
$criminals = array( 2, 4, 8, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20);
foreach($people as $num) {
    if (in_array($num,$criminals)) {
        $found[$num] = true;
    } 
}
var_dump($found);
// array(2) { [20]=> bool(true)   [2]=> bool(true) } 
```

虽然 array_intersect 使用起来肯定更方便，但事实证明它在性能方面并没有真正优越。我也创建了这个脚本：

```
<?php
$found = null;
$people = array(3,20,2);
$criminals = array( 2, 4, 8, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20);
$fastfind = array_intersect($people,$criminals);
var_dump($fastfind);
// array(2) { [1]=> int(20)   [2]=> int(2) } 
```

然后，我分别在[http://3v4l.org/WGhO7/perf#tabs](http://3v4l.org/WGhO7/perf#tabs)和[http://3v4l.org/g1Hnu/perf#tabs](http://3v4l.org/g1Hnu/perf#tabs)运行这两个片段并检查每个片段的性能。有趣的是PHP5.6的总CPU时间，即用户时间+系统时间是一样的，内存也是一样的。在 PHP5.4 下，in_array 的总 CPU 时间比 array_intersect 少，尽管有点少。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-05-03T06:38:34.093

这是我研究了一段时间后的一种方法。我想做一个 Laravel API 端点来检查一个字段是否“正在使用”，所以重要的信息是：1）哪个 DB 表？2）什么数据库列？3) 该列中是否有与搜索词匹配的值？

知道了这一点，我们可以构造我们的关联数组：

```
$SEARCHABLE_TABLE_COLUMNS = [
    'users' => [ 'email' ],
]; 
```

然后，我们可以设置我们要检查的值：

```
$table = 'users';
$column = 'email';
$value = 'alice@bob.com'; 
```

然后，我们可以使用`array_key_exists()`and `in_array()`with eachother 来执行一两步组合，然后根据`truthy`条件采取行动：

```
// step 1: check if 'users' exists as a key in `$SEARCHABLE_TABLE_COLUMNS`
if (array_key_exists($table, $SEARCHABLE_TABLE_COLUMNS)) {

    // step 2: check if 'email' is in the array: $SEARCHABLE_TABLE_COLUMNS[$table]
    if (in_array($column, $SEARCHABLE_TABLE_COLUMNS[$table])) {

        // if table and column are allowed, return Boolean if value already exists
        // this will either return the first matching record or null
        $exists = DB::table($table)->where($column, '=', $value)->first();

        if ($exists) return response()->json([ 'in_use' => true ], 200);
        return response()->json([ 'in_use' => false ], 200);
    }

    // if $column isn't in $SEARCHABLE_TABLE_COLUMNS[$table],
    // then we need to tell the user we can't proceed with their request
    return response()->json([ 'error' => 'Illegal column name: '.$column ], 400);
}

// if $table isn't a key in $SEARCHABLE_TABLE_COLUMNS,
// then we need to tell the user we can't proceed with their request
return response()->json([ 'error' => 'Illegal table name: '.$table ], 400); 
```

我为 Laravel 特定的 PHP 代码道歉，但我会留下它，因为我认为您可以将其视为伪代码。**重要的部分**`if`是同步执行的两条语句。

> `array_key_exists()`并且`in_array()`是 PHP 函数。

来源：

*   [https://php.net/manual/en/function.array-key-exists.php](https://php.net/manual/en/function.array-key-exists.php)

*   [https://php.net/manual/en/function.in-array.php](https://php.net/manual/en/function.in-array.php)

我在上面展示的算法的好处是您可以创建一个 REST 端点，例如`GET /in-use/{table}/{column}/{value}`(where `table`, `column`, and `value`are variables)。

你可以有：

```
$SEARCHABLE_TABLE_COLUMNS = [
    'accounts' => [ 'account_name', 'phone', 'business_email' ],
    'users' => [ 'email' ],
]; 
```

然后您可以发出 GET 请求，例如：

`GET /in-use/accounts/account_name/Bob's Drywall`（您可能需要对最后一部分进行 uri 编码，但通常不需要）

`GET /in-use/accounts/phone/888-555-1337`

`GET /in-use/users/email/alice@bob.com`

另请注意，没有人可以这样做：

`GET /in-use/users/password/dogmeat1337`因为`password`未列在您的允许列列表中`user`。

祝你好运。

# sum - 生成按属性排序的组合

> ID：523800
> 
> 赞同：4
> 
> 时间：2009-02-07T13:52:43.407
> 
> 标签：sum, combinatorics, combinations

我正在寻找一种方法来生成按单个属性排序的对象组合。我不认为字典顺序是我正在寻找的......我会尝试举一个例子。假设我有一个对象 A、B、C、D 的列表，其中我想要按 3、3、2、1 排序的属性值。这给出了 A3、B3、C2、D1 对象。现在我想生成 2 个对象的组合，但它们需要按降序排列：

*   A3 B3
*   A3 C2
*   B3 C2
*   A3 D1
*   B3 D1
*   C2 D1

生成所有组合并对它们进行排序是不可接受的，因为现实世界的场景涉及大集合和数百万个组合。（40 个，8 个订单），我只需要高于特定阈值的组合。

实际上，我需要按给定属性的总和分组的阈值以上的组合计数，但我认为这样做要困难得多 - 所以我会满足于开发高于阈值的所有组合并计算它们。如果有可能的话。

编辑 - 我最初的问题不是很精确......我实际上并不需要订购这些组合，只是认为它有助于隔离高于阈值的组合。更准确地说，在上面的例子中，给定阈值 5，我正在寻找一个信息，即给定集合产生 1 个总和为 6 ( A3 B3 ) 和 2 总和为 5 ( A3 C2, B3 C2)。我实际上并不需要组合本身。

我正在研究子集和问题，但如果我正确理解给定的动态解决方案，它只会给你信息是否有给定的总和，而不是总和的计数。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T15:45:06.533

实际上，我认为您*确实*想要字典顺序，但要降序而不是升序。此外：

*   从您的描述中我不清楚 A，B，... D 在您的答案中扮演任何角色（可能作为值的容器除外）。
*   我认为您的问题示例只是“对于每个至少 5 个整数，最多两个值的最大可能总数，{3, 3, 2, 1} 集合中有多少不同的对具有该整数的总和？”
*   有趣的部分是早期救助，一旦无法达成任何可能的解决方案（剩余可实现的金额太小）。

~~稍后我将发布示例代码。~~

这是我承诺的示例代码，以下是一些注释：

```
public class Combos {

    /* permanent state for instance */
    private int values[];
    private int length;

    /* transient state during single "count" computation */
    private int n;
    private int limit;
    private Tally<Integer> tally;
    private int best[][];  // used for early-bail-out

    private void initializeForCount(int n, int limit) {
        this.n = n;
        this.limit = limit;
        best = new int[n+1][length+1];
        for (int i = 1; i <= n; ++i) {
            for (int j = 0; j <= length - i; ++j) {
                best[i][j] = values[j] + best[i-1][j+1];
            }
        }
    }

    private void countAt(int left, int start, int sum) {
        if (left == 0) {
            tally.inc(sum);
        } else {
            for (
                int i = start;
                i <= length - left
                && limit <= sum + best[left][i];  // bail-out-check
                ++i
            ) {
                countAt(left - 1, i + 1, sum + values[i]);
            }
        }
    }

    public Tally<Integer> count(int n, int limit) {
        tally = new Tally<Integer>();
        if (n <= length) {
            initializeForCount(n, limit);
            countAt(n, 0, 0);
        }
        return tally;
    }

    public Combos(int[] values) {
        this.values = values;
        this.length = values.length;
    }

} 
```

### 前言备注：

这使用了一个名为 Tally 的小助手类，它只是隔离了列表（包括对从未见过的键进行初始化）。我会把它放在最后。

为了保持简洁，我采用了一些对“真实”代码来说不是好的做法的捷径：

*   这不会检查空值数组等。
*   我假设值数组已经按降序排序，这是早期救助技术所必需的。（好的生产代码将包括排序。）
*   我将瞬态数据放入实例变量中，而不是将它们作为参数传递给支持`count`. 这使得这个类是非线程安全的。

### 解释：

的实例`Combos`是使用要组合的（降序）整数数组创建的。该`value`数组为每个实例设置一次，但`count`可以使用不同的人口规模和限制进行多次调用。

该`count`方法触发（大部分）标准递归遍历`n`来自`values`. 该`limit`论点给出了利息总和的下限。

该`countAt`方法检查来自 的整数组合`values`。`left`参数是剩余多少整数来构成`n`总和中的整数，是`start`要`values`搜索的位置，并且`sum`是部分总和。

早期救助机制基于计算`best`，一个二维数组，指定从给定状态可达到的“最佳”总和。in的值是从原始位置开始`best[n][p]`的值的最大总和。`n``p``values`

`countAt`当积累了正确的人口时，触底的递归；这会将当前`sum`（`n`值）添加到`tally`. 如果`countAt`还没有触底，`values`则从`start`-ing 位置扫过增加当前的 partial `sum`，只要：

*   留有足够的职位`values`以达到指定的人口数量，并且
*   剩余的`best`（最大）小计足够大，可以使`limit`.

使用您的问题数据运行的示例：

```
 int[] values = {3, 3, 2, 1};
    Combos mine = new Combos(values);
    Tally<Integer> tally = mine.count(2, 5);
    for (int i = 5; i < 9; ++i) {
        int n = tally.get(i);
        if (0 < n) {
            System.out.println("found " + tally.get(i) + " sums of " + i);
        }
    } 
```

产生您指定的结果：

```
found 2 sums of 5
found 1 sums of 6 
```

这是理货代码：

```
public static class Tally<T> {
    private Map<T,Integer> tally = new HashMap<T,Integer>();
    public Tally() {/* nothing */}
    public void inc(T key) {
        Integer value = tally.get(key);
        if (value == null) {
            value = Integer.valueOf(0);
        }
        tally.put(key, (value + 1));
    }
    public int get(T key) {
        Integer result = tally.get(key);
        return result == null ? 0 : result;
    }
    public Collection<T> keys() {
        return tally.keySet();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T08:07:51.703

我编写了一个类来处理处理二项式系数的常用函数，这是您的问题所属的问题类型。它执行以下任务：

1.  将任何 N 选择 K 的所有 K 索引以良好的格式输出到文件。K-indexes 可以替换为更具描述性的字符串或字母。这种方法使得解决这类问题变得非常简单。

2.  将 K 索引转换为已排序二项式系数表中条目的正确索引。这种技术比依赖迭代的旧已发布技术快得多。它通过使用帕斯卡三角形固有的数学属性来做到这一点。我的论文谈到了这一点。我相信我是第一个发现并发表这种技术的人，但我可能是错的。

3.  将已排序二项式系数表中的索引转换为相应的 K 索引。

4.  使用[Mark Dominus](http://blog.plover.com/math/choose.html)方法计算二项式系数，它不太可能溢出并且适用于更大的数字。

5.  该类是用 .NET C# 编写的，并提供了一种通过使用通用列表来管理与问题相关的对象（如果有）的方法。此类的构造函数采用一个名为 InitTable 的 bool 值，当它为 true 时，将创建一个通用列表来保存要管理的对象。如果此值为 false，则不会创建表。无需创建表即可执行上述 4 种方法。提供了访问器方法来访问表。

6.  有一个关联的测试类，它显示了如何使用该类及其方法。它已经用 2 个案例进行了广泛的测试，并且没有已知的错误。

要了解此类并下载代码，请参阅[制表二项式系数](http://tablizingthebinomialcoeff.wordpress.com/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T14:23:28.617

在stackoverflow中查看这个问题：[返回所有组合](https://stackoverflow.com/questions/127704/algorithm-to-return-all-combinations-of-k-elements-from-n)的算法

我也只是使用下面的 java 代码来生成所有排列，但它可以很容易地用于生成给定索引的唯一组合。

```
public static <E> E[] permutation(E[] s, int num) {//s is the input elements array and num is the number which represents the permutation

    int factorial = 1;

    for(int i = 2; i < s.length; i++)
        factorial *= i;//calculates the factorial of (s.length - 1)

    if (num/s.length >= factorial)// Optional. if the number is not in the range of [0, s.length! - 1] 
        return null;

    for(int i = 0; i < s.length - 1; i++){//go over the array

        int tempi = (num / factorial) % (s.length - i);//calculates the next cell from the cells left (the cells in the range [i, s.length - 1])
        E temp = s[i + tempi];//Temporarily saves the value of the cell needed to add to the permutation this time 

        for(int j = i + tempi; j > i; j--)//shift all elements to "cover" the "missing" cell
            s[j] = s[j-1];

        s[i] = temp;//put the chosen cell in the correct spot

        factorial /= (s.length - (i + 1));//updates the factorial

    }

    return s;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T15:41:13.903

我非常抱歉（在评论中进行了所有这些澄清之后）说我找不到这个问题的有效解决方案。我尝试了过去一个小时没有结果。

原因（我认为）是这个问题与旅行商问题非常相似。除非您尝试所有组合，否则无法知道哪些属性将加起来达到阈值。

似乎没有什么聪明的技巧可以解决这类问题。

您仍然可以对实际代码进行许多优化。

尝试根据属性对数据进行排序。当您发现较高的值不能满足阈值时，您可以避免处理列表中的某些值（因此可以消除所有较低的值）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T15:46:55.220

这是一种计算这些子集数量的递归方法：我们定义一个函数*，*它`count(minIndex,numElements,minSum)`返回大小为 的子集的数量，`numElements`其总和至少为`minSum`，包含具有索引`minIndex`或更大的元素。

在问题陈述中，我们按降序对元素进行排序，例如 [3,3,2,1]，并将第一个索引称为零，元素总数为 N。我们假设所有元素都是非负数。要找到总和至少为 5 的所有 2 子集，我们调用`count(0,2,5)`.

**示例代码**（Java）：

```
int count(int minIndex, int numElements, int minSum)
{
    int total = 0;

    if (numElements == 1)
    {
        // just count number of elements >= minSum
        for (int i = minIndex; i <= N-1; i++)
            if (a[i] >= minSum) total++; else break;
    }
    else
    {
        if (minSum <= 0)
        {
            // any subset will do (n-choose-k of them)
            if (numElements <= (N-minIndex))
                total = nchoosek(N-minIndex, numElements);
        }
        else
        {
            // add element a[i] to the set, and then consider the count
            // for all elements to its right
            for (int i = minIndex; i <= (N-numElements); i++)
                total += count(i+1, numElements-1, minSum-a[i]);
        }
    }

    return total;
} 
```

顺便说一句，我已经用 40 个元素的数组和大小为 8 的子集运行了上述内容，并且始终在不到一秒的时间内获得了结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T15:54:30.040

如果您使用 C#，这里有一个相当不错的泛型[库](http://69.10.233.10/KB/recipes/Combinatorics.aspx)。请注意，尽管某些排列的生成不是按字典顺序

# php - Zend Framework，在没有视图的情况下运行查询？

> ID：523811
> 
> 赞同：7
> 
> 时间：2009-02-07T14:02:49.157
> 
> 标签：php, database, zend-framework, model, controller

我目前正在使用 Zend Framework 为网站构建一个小型管理部分，这只是我第二次使用该框架，所以我对某些事情有点不确定。例如，我是否有新闻文章的存档选项，用户希望在其中单击链接并且文章将被存档，但是我无法弄清楚如何在没有视图的情况下运行它？

这是我的控制器

```
public function archiveNewsAction()
{

    //die(var_dump($this->_request->getParam('news_id')));
    $oNews = new news();
    $this->_request->getParam('news_id');
    $oNews->archiveNewsArticle($news_id);
    //die(var_dump($oNews));
    $this->_redirect('/admin/list-all');
} 
```

这是我的模型

```
public function archiveNewsArticle($news_id)
{
    //die($news_id);
    $db = Zend_Registry::get('db');
    $sql = "UPDATE $this->_name SET live = '0' WHERE news_id = '$news_id' LIMIT 1";
    die($sql);
    $query = $db->query($sql);
    $row = $query->fetch();

    return $row;
} 
```

我将不胜感激任何人可以提供的任何帮助。

谢谢

西科

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-07T15:07:48.277

我将它用于对仅 AJAX 操作的调用，这些操作我要么不想输出，要么正在使用其他输出，例如 XML 或 JSON：

```
// Disable the main layout renderer
$this->_helper->layout->disableLayout();
// Do not even attempt to render a view
$this->_helper->viewRenderer->setNoRender(true); 
```

如果您正在做的事情没有输出/非 HTML 输出，这具有没有重定向开销的额外好处。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-07T18:19:01.573

要在一个动作中禁用视图渲染（把它放在特定的动作中。如果你想要整个控制器把它放在 init 方法中）：

```
$this->_helper->viewRenderer->setNoRender(); 
```

如果您使用的是 ZF 的布局组件，请添加以下内容：

```
$this->_helper->layout->disableLayout(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-07T19:50:38.113

我无法在那里弄清楚你的代码。在您的模型中，您正在调用 die()。为什么？它将停止执行。你确定那条线吗？无论如何，如果您在 Zend Framework 中有一个控制器并且不需要任何视图，您可以通过以下行关闭视图：

```
// code in your controller
$this->_helper->viewRenderer->setNoRender(true);
// the rest of the controller 
```

现在控制器不会搜索要显示给用户的视图脚本。确保你会打电话

```
$this->_redirect() 
```

完成所有控制器工作后。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T14:09:29.050

## 原答案：

您致电：

```
$this->_redirect(); 
```

调用 Redirector 操作助手，它（除非您已将其配置为不这样做）将在写入标题后立即自动退出脚本，因此永远不会调用或呈现视图，不需要视图脚本。

* * *

## 后续回答：

为了在不将用户发送到另一个“页面”的情况下调用该操作，然后再次重定向回来，您需要使用 XMLHttpRequest (AJAX) 调用。这些链接应提供您需要的信息：

[http://developer.mozilla.org/en/AJAX](http://developer.mozilla.org/en/AJAX)
[http://www.ibm.com/developerworks/xml/library/wa-ajaxintro1.html](http://www.ibm.com/developerworks/xml/library/wa-ajaxintro1.html)
[http://www.oracle.com/technology/pub/articles/沙尔克-ajax.html](http://www.oracle.com/technology/pub/articles/schalk-ajax.html)

还可以看看一些让 XMLHttpRequest 跨浏览器更容易使用的 JS 框架：

[http://www.prototypejs.org/](http://www.prototypejs.org/)
[http://mootools.net/](http://mootools.net/)

Zend Framework 实际上已经内置了对 Dojo JS 框架的支持，您可能会发现它更简单：

[http://framework.zend.com/manual/en/zend.dojo.html](http://framework.zend.com/manual/en/zend.dojo.html)
[http://www.dojotoolkit.org/](http://www.dojotoolkit.org/)

# c++ - C++0x 原子模板实现

> ID：523827
> 
> 赞同：9
> 
> 时间：2009-02-07T14:16:03.297
> 
> 标签：c++, synchronization, c++11

我知道英特尔的 TBB 中存在类似的模板，此外我在 google 或 Boost 库中找不到任何实现。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-07T14:22:26.543

您可以在 boost 中找到有关此功能实现的讨论：http: [//lists.boost.org/Archives/boost/2008/11/144803.php](http://lists.boost.org/Archives/boost/2008/11/144803.php)

> > 能否实现 N2427 - C++ 原子类型和操作
> 
> > 没有编译器的帮助？
> 
> 不。
> 
> 如果您可以编写内联汇编程序（或就此而言单独编译的汇编程序），它们不需要是内在函数，那么您可以直接自己编写操作。您甚至可以使用简单的 C++（例如，只是简单的加载或存储分配）。您需要编译器支持的原因是防止不适当的优化：原子操作无法优化，通常不得在任何其他操作之前或之后重新排序。这意味着即使在原子存储之前执行的非原子存储也必须完成，并且不能缓存在寄存器中（例如）。此外，原子操作之后发生的负载不能在原子操作之前提升。在某些编译器上，仅使用内联汇编程序就足够了。在其他情况下，调用外部函数就足够了。MSVC 提供 _ReadWriteBarrier() 来提供编译器排序。其他编译器需要其他标志。

# api - 用于打开计算机的 API

> ID：523829
> 
> 赞同：0
> 
> 时间：2009-02-07T14:19:07.300
> 
> 标签：api, winapi

我正在制作一个小型在线时钟（既是为了好玩，也是为了学习更多的 php 和 javascript）开始它，因为我实际上需要一个闹钟，这比买一个更容易（不要问）

现在我想知道一件事，我知道从浏览器打开/关闭你的电脑是不可能的，但是一个朋友问我是否可以给他做一个小插件/程序来获取他在那里添加的闹钟时间，并且会打开他的电脑，这样如果醒来它就会让

我知道打开肯定是几乎不可能的，但也许从睡眠/休眠状态打开？

任何人都知道任何api来做到这一点？Windows 或 mac，或跨平台。

只是为了好奇，闹钟在这里[http://www.my-clock.net](http://www.my-clock.net)

编辑：

在 wiki 页面上，wake-on-lan 说它需要将 bios 电源转到网络板，有什么办法可以解决这个问题吗？或者今天的计算机是否已经为这种协议做好了准备？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T14:28:14.847

可能有两种解决方案：

1.  按照建议使用[LAN 唤醒](http://en.wikipedia.org/wiki/Wake-on-LAN)。但是您必须在该 LAN 上安装另一台机器，它不能通过 Internet 本身运行。所以它就像你 -> [互联网] -> Waker -> 你的朋友。
2.  您可以在他的机器仍在运行时通过 Internet设置他的[RTC 唤醒警报。](http://en.wikipedia.org/wiki/RTC_Alarm)然后他的电脑会在指定的时间唤醒。

即使计算机完全关闭，两者都可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T14:27:53.850

一旦操作系统进入休眠/睡眠状态，启动它的唯一方法是通过某种内核级硬件驱动程序事件。例如按下电源按钮或打开系统的盖子等。

IMO 在应用程序中对功能进行建模会有点复杂，因为应用程序依赖于操作系统级别的服务，这些服务在睡眠/休眠模式下不可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T14:21:41.007

我不太了解它是如何工作的，但听起来你需要[Wake-on-LAN](http://en.wikipedia.org/wiki/Wake-on-LAN)

> LAN 唤醒（WOL，有时是 WoL）是一种以太网计算机网络标准，允许通过网络消息远程打开或唤醒计算机。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T14:22:17.340

您最好的选择可能是[网络唤醒](http://en.wikipedia.org/wiki/Wake-on-LAN)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T14:27:23.197

正如人们所指出的，网络唤醒是一种可能性。但还有另一种可能适合您的需要。今天的大多数 BIOS 已经提供了在给定时间打开计算机的选项。如果您的目标只是将您的计算机变成一个闹钟，那么这应该可以解决问题。

# html - 样式化 iframe

> ID：523836
> 
> 赞同：1
> 
> 时间：2009-02-07T14:23:49.427
> 
> 标签：html, css, iframe

我正在使用出色的[Jalbum](http://jalbum.net/)为网站创建相册。生成的相册的每一页都是一个完整的网页，因此推荐将相册嵌入网站的方法是使用 iframe。

当我想对嵌入 iframe 中包含的图像进行样式设置时，就会出现问题。如果我添加一条规则，例如：

```
img { 
    -ms-interpolation-mode: bicubic; 
} 
```

对于我的样式表，它不会选择 iframe 中的图像。有没有办法选择嵌入 iframe 中包含的元素？

当然，我可以在嵌入 iframe 之前手动编辑 Jalbum 创建的 CSS 文件，但我需要记住每次重新生成相册时都这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T15:40:16.230

You could use JavaScript code to insert a CSS include into the document of the iframe.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-07T18:49:56.533

根据我的经验，它只是关于制定比 iframe 本身的规则更具体的 CSS 规则。这可以通过例如为 iframe 提供一个 ID 来实现，并使其具有外部元素，使其更加具体（我们在平台上使用的带有直播嵌入的 LESS 示例）：

```
#livestream-iframe-wrapper {
width: 100%;
height: 100%;
    #livestream-viewer {
        width: 100%;
        height: 100%;
        #layout0, #layout1, #layout2, #layout3 {
            #layout4, #layout0-lsplayer, #layout1-lsplayer, #layout2-lsplayer, #layout3-lsplayer, #layout4-lsplayer {
                width: 100%;
                height: 100%;
                #lsplayer {
                    width: 100% ;
                    height: 100%;
                 }
             }
        }
    }
} 
```

我无法提供有关如何针对您的情况执行此操作的任何具体信息，但可以使用浏览器开发工具中的 DOM 检查器来检查 DOM 并找到要覆盖的类。

# php - 多个单独的 switch 语句

> ID：523837
> 
> 赞同：0
> 
> 时间：2009-02-07T14:23:56.133
> 
> 标签：php, default, switch-statement, case, server-side

我在其中一个页面上有多个 switch 语句，以便将不同的变量以及不同的大小写传递给 URL。我需要这些不同的 switch 语句，因为我需要不同的变量。

但是，当我在其中一个 switch 语句中放置“默认值”时，该默认值适用于所有其他 switch 语句，因此当我在 URL 中使用另一个 switch 语句的变量时，另一个 switch 语句的默认情况将出现在屏幕，以及此 switch 语句的大小写。

我所有的 switch 语句都有一个或多个案例，我真的不知道如何解决这个问题。请问有人可以帮我吗？

在此先感谢，卡卢姆。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T14:37:06.857

这可能很遥远，但我认为你需要这样的东西：

```
if (isset($_POST['myvar'])) {
   switch ($_POST['myvar'] {
      case 1:
      ....
      break;
      default:
      ....
      break;
   }
} else if (isset($_POST['myvar2'])) {
   switch ($_POST['myvar2'] {
      case 1:
      ....
      break;
      default:
      ....
      break;
   }
} 
```

那有意义吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T19:44:20.590

确保你有一个“休息”；在每个案例的末尾声明，默认案例是最后一个案例。像这样：

```
switch ($var) {
    case 1: // do stuff 1;
            break;
    case 3: // do stuff 2;
            break;
    // ...
    default: // do default stuff
} 
```

# django - Django + Pydev/Eclipse + Google App Engine - 可能吗？

> ID：523841
> 
> 赞同：17
> 
> 时间：2009-02-07T14:26:03.743
> 
> 标签：django, eclipse, google-app-engine, linker, pydev

有没有人能让 Google App Engine/Django 在 Pydev/Eclipse 中工作？我试过这个，但很难让 Pydev 识别我引用的所有外部链接文件夹（django 插件）。我最终将所有这些文件夹全部复制到项目中，而不是引用它们，从而导致项目文件夹非常臃肿 - 这确实是一个不可行的解决方案，最终让我放弃了整个项目。所以，我想知道是否有人尝试过这个或者知道我可能做错了什么。（请记住，这是我第一次尝试使用 Pydev、Django、App Engine 和 Python ！！）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-08T06:46:07.477

我没有亲自设置它，但我确实看到了这个关于如何做的教程：

[http://code.google.com/appengine/articles/eclipse.html](http://code.google.com/appengine/articles/eclipse.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T15:00:22.603

Pydev 1.4.6（仍然只在夜间版本中可用）有一些特殊的支持来简化配置。请参阅： http: [//pydev.blogspot.com/2009/05/testing-on-pydev-146-google-app-engine.html](http://pydev.blogspot.com/2009/05/testing-on-pydev-146-google-app-engine.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T12:07:41.717

本教程展示了如何将 Aptana（安装了 PyDev）配置为 AppEngine 的编码和调试平台。同样，您也可以将 Django 库添加到 Aptana。

[http://www.alishabdar.com/2009/05/06/develop-google-appengine-with-aptana-studio/](http://www.alishabdar.com/2009/05/06/develop-google-appengine-with-aptana-studio/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-11-29T13:55:03.440

这个问题已经有一段时间没有回复了，事情已经发生了变化，所以我想我会提供和更新。

PyDev 现在包括开箱即用的 Google App Engine 配置，您可以开箱即用地调试和运行 GAE 项目，这包括 Django。

只需在您的机器上安装 GAE 和最新的 Eclipse/PyDev，然后创建一个 GAE 项目并将 PyDev 指向您的 Python 和 Google App Engine 版本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-19T00:30:48.537

我最初链接到[本教程](http://pydev.blogspot.com/2006/09/configuring-pydev-to-work-with-django.html)。Pydev 现在有 Django 支持，所以这可能不太相关。不过，它对于弄清楚如何让它们一起工作可能仍然有用。您也可以尝试查看[此博客文章](http://neonguru.tumblr.com/post/202171669/steps-to-run-google-appengine-with-django-in-windows)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-02-12T21:04:37.103

appengine 1.31
Django 1.1
pydev 1.5.4
操作系统 Ubuntu 9.10

* * *

eclipse .pydevproject 文件：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<?eclipse-pydev version="1.0"?>
<pydev_project>
<pydev_variables_property name="org.python.pydev.PROJECT_VARIABLE_SUBSTITUTION">
<key>GOOGLE_APP_ENGINE</key>
<value>/home/elvis/google_appengine</value>
</pydev_variables_property>
<pydev_pathproperty name="org.python.pydev.PROJECT_SOURCE_PATH">
<path>/pythonleggo</path>
</pydev_pathproperty>
<pydev_pathproperty name="org.python.pydev.PROJECT_EXTERNAL_SOURCE_PATH">
<path>${GOOGLE_APP_ENGINE}</path>
<path>${GOOGLE_APP_ENGINE}/lib/webob</path>
<path>${GOOGLE_APP_ENGINE}/lib/yaml/lib</path>
</pydev_pathproperty>
<pydev_property name="org.python.pydev.PYTHON_PROJECT_VERSION">python 2.6</pydev_property>
<pydev_property name="org.python.pydev.PYTHON_PROJECT_INTERPRETER">Default</pydev_property>
</pydev_project> 
```

* * *

文件：

eclipse 项目文件夹
- app.yaml
- index.yaml
- **init** .py
- main.py
- manage.py
- .project
- .pydevproject
- settings.py（无法加载） - urls.py

* * *

主要.py：

```
from google.appengine.dist import use_library  
use_library('django', '1.1')  

from django.conf import settings

settings.configure(
DEBUG=True,
TEMPLATE_DEBUG=True,
ROOT_URLCONF = 'urls',
PROJECT_NAME = 'pythonleggo',
SETTINGS_MODULE = '.settings',
ADMINS = ('elvis', 'elvis@gmail.com'),
LANGUAGE_CODE = 'en-us',
SITE_ID = 1,
USE_I18N = True,
MEDIA_ROOT = '',
MEDIA_URL = '',
ADMIN_MEDIA_PREFIX = '/media/',
SECRET_KEY = 'shhh',
TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.load_template_source',
    'django.template.loaders.app_directories.load_template_source'),
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware'),

TEMPLATE_DIRS=('/home/jmurphy/workspace/pythonleggo/templates'),
INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites')
)

#os.environ['DJANGO_SETTINGS_MODULE'] = 'settings'

import django.core.handlers.wsgi
from google.appengine.ext.webapp import util

def main():
    # Run Django via WSGI.
    application = django.core.handlers.wsgi.WSGIHandler()
    util.run_wsgi_app(application)
if __name__ == ' __main__':
    main() 
```

* * *

日食运行：
/usr/bin/python2.6 -u /home/elvis/google_appengine/dev_appserver.py

将使用的 PYTHONPATH 是：

/home/elvis/.eclipse/org.eclipse.platform_3.5.0_155965261/plugins/org.python.pydev_1.5.4.2010011921/PySrc/pydev_sitecustomize:/home/elvis/workspace/pythonleggo:/home/elvis/google_appengine:/ home/elvis/google_appengine/lib/webob:/home/elvis/google_appengine/lib/yaml/lib:/usr/lib/pymodules/python2.6:/usr/lib/pymodules/python2.6/gtk-2.0:/ usr/lib/python2.6:/usr/lib/python2.6/dist-packages:/usr/lib/python2.6/dist-packages/PIL:/usr/lib/python2.6/dist-packages/gst -0.10:/usr/lib/python2.6/dist-packages/gtk-2.0:/usr/lib/python2.6/lib-dynload:/usr/lib/python2.6/lib-old:/usr/lib /python2.6/lib-tk:/usr/lib/python2.6/plat-linux2:/usr/local/lib/python2.6/dist-packages

* * *

我无法使用 os.environ['DJANGO_SETTINGS_MODULE'] = 'settings' 加载设置文件。它似乎已从 django 收到的环境中剥离。我使用了似乎可以正常工作的 settings.configure。此时我只有在 apppot 中加载默认的 django 页面。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-29T19:36:43.447

我今天刚开始使用 Python 和 Google App Engine。我认为我们都用外部参考将头撞到了同一堵墙上。

我已经尝试为我的应用部署[google-app-engine-django](http://code.google.com/p/google-app-engine-django/)项目。我已经提取了所有内容，并且在我的根目录下有 /appengine_django 和 /django 文件夹。

我已将它们添加为源文件夹，并将 /google_appengine/google 文件夹添加为外部参考。

通常，这一切对我来说都是有意义的。每个都包含 __ init __.py 模块。尽管如此，当我尝试 ctr+click 任何导入语句时，它都无法解析模块的路径。

引人注目的是，您不会导入包含 __ init __.py 的即时文件夹。要正确引用包，请导入包含包*duh 的父文件夹！*这也意味着，由于我不想使用 /src 文件夹，因此应将实际项目文件夹添加为源引用，以使 /appengine_django 和 /django 被识别为源文件夹。

完成后，一切运行顺利。我想这是为了表明我有更多关于 Py 的阅读工作要做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-12T13:34:05.720

这是另一个可能有帮助的教程。
eclispe 版本可能有点旧，但它应该能让您获得足够的工作项目。

[http://django-appengine.com/contents](http://django-appengine.com/contents)

它具有完整的 Eclipse 设置
[http://django-appengine.com/post/37462709481/](http://django-appengine.com/post/37462709481/)
[http://www.mkyong.com/google-app-engine/google-app-engine-python-hello-world-example-使用-eclipse/](http://www.mkyong.com/google-app-engine/google-app-engine-python-hello-world-example-using-eclipse/)

它具有完整的 gae 设置
[http://django-appengine.com/post/37615321945/](http://django-appengine.com/post/37615321945/)

它具有完整的 django 设置
[http://django-appengine.com/post/37628665099/](http://django-appengine.com/post/37628665099/)

然后解释了如何将这两个项目组合成一个 gae 项目。
[http://django-appengine.com/post/37778427717/](http://django-appengine.com/post/37778427717/)

我希望这对刚开始的其他人有所帮助

# ruby-on-rails - 如何发送带有“DELETE”HTTP 动词的请求？

> ID：523843
> 
> 赞同：5
> 
> 时间：2009-02-07T14:26:42.730
> 
> 标签：ruby-on-rails, rest, routing

我想在执行此操作的 Rails 应用程序中的视图中创建一个链接...

```
DELETE /sessions 
```

我该怎么做。

增加的并发症：

“会话”资源没有模型，因为它代表用户登录会话。`CREATE`表示用户登录，`DESTROY`表示退出。

这就是 URI 中没有 ID 参数的原因。

我正在尝试在 UI 中实现“注销”链接。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-07T14:41:43.243

正确，浏览器实际上不支持发送删除请求。许多 Web 框架接受的约定是发送设置为“DELETE”的 _method 参数，并使用 POST 请求。

这是 Rails 中的一个示例：

```
<%= link_to 'log out', session_path, :method => :delete %> 
```

您可能想看看[Restful Authentication](http://github.com/technoweenie/restful-authentication/tree/master)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T03:30:44.473

我不具体了解 Rails，但我经常使用 Javascript 构建发送 DELETE（和 PUT）请求的网页。我只是使用 XmlHttpRequest 对象来发送请求。

例如，如果您使用 jQuery：

有一个如下所示的链接：

```
<a class="delete" href="/path/to/my/resource">delete</a> 
```

并运行这个 Javascript：

```
$(function(){
    $('a.delete').click(function(){
        $.ajax(
            {
                url: this.getAttribute('href'),
                type: 'DELETE',
                async: false,
                complete: function(response, status) {
                    if (status == 'success')
                        alert('success!')
                    else
                        alert('Error: the service responded with: ' + response.status + '\n' + response.responseText)
                }
            }
        )
        return false
    })
}) 
```

我主要是凭记忆写了这个例子，但我很确定它会起作用....

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T14:34:52.323

如果我错了，请纠正我，但我相信您只能使用浏览器（在 HTML 中）发送 POST 和 GET 请求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-24T20:52:30.533

Rails 的内置链接方法将生成如下内容：

```
<a href="/sessions?method=delete" rel="nofollow">Logout</a> 
```

如果您不想使用 Rails 的内置方法（即不想要`rel="nofollow"`阻止搜索引擎爬虫跟踪链接的 ），**您也可以手动编写链接并添加`data-method`属性，如下所示：**

```
<a href="/sessions" data-method="delete">Logout</a> 
```

浏览器只能发送 GET/POST 请求，所以这会向 Rails 服务器发送一个普通的 GET 请求。Rails 会将其解释为 DESTROY/DELETE 请求并将其路由，并调用适当的操作。

# c# - C# - 什么是组件，它通常如何使用？

> ID：523844
> 
> 赞同：29
> 
> 时间：2009-02-07T14:26:57.703
> 
> 标签：c#, components

什么是组件类，我通常会在哪里使用它？

当我在 VS.NET 2008 中向我的项目添加新项目时，其中一个选项是添加组件。我什至不确定我是否理解组件是什么——但我肯定想了解更多关于它们的信息。

有人可以向我解释一下，或者将我指向一个可以帮助我的在线教程。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-07T14:31:13.187

嗯，一般来说，组件是事物的任何部分。特别是在 .NET 中，组件是实现[`IComponent`接口](http://msdn.microsoft.com/en-us/library/system.componentmodel.icomponent.aspx)的类，这表明类可以与其逻辑容器交互。

通常，您会以设计支持的形式看到这一点，因为类与设计器中的宿主交互，但这不是严格的要求。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-07T14:34:06.550

[组件类](http://msdn.microsoft.com/en-us/library/system.componentmodel.component.aspx)用于在应用程序之间共享对象。

通常用于将 Outlook 电子邮件等对象下拉到应用程序。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-07T14:31:27.103

如果您的意思是继承自 的类`System.ComponentModel.Component`，例如`System.Windows.Forms.BindingSource`强类型数据集，这将允许在 Visual Studio 设计图面上（在设计时的窗体上）拖动实例并使用属性网格设置一些属性。

一旦表单上有此类组件的实例，其他组件/控件就可以发现它。例如，`BindingSource`可以选择 a 作为网格视图或其他控件的数据源。

# windows - 使用免费软件在 Windows 上生成 64 位版本

> ID：523849
> 
> 赞同：3
> 
> 时间：2009-02-07T14:28:16.610
> 
> 标签：windows, visual-studio-2008, 64-bit, visual-studio-express

我有一个在 Microsoft Visual C++ 2008 Express Edition 中开发的 C++ 项目。它已经到了我想移植到 64 位并继续开发的地步。

**使用免费软件做到这一点的最佳方法是什么？**

* * *

*到目前为止我的想法：*

MSVC 的 Express Edition 不附带 64 位编译器，因此我可以安装 Windows SDK 来获得这些。然后我可以将我的项目文件移植到`nmake`IDE，并将 IDE 用作调试和调用我的`nmak`e 脚本的工具。这样做的缺点是`nmake`看起来很差。[本教程](http://web.sau.edu/lilliskevinm/csci240/masmdocs/envtools/26LMAETC16.pdf)末尾的示例表明`nmake`无法确定源文件依赖项本身，而且我不知道[`gcc -M`](http://make.paulandlesley.org/autodep.html#gcc)可以使用的任何等价物。

另一种选择可能是使用`vcbuild`Windows SDK 从我现有的`vcproj`文件生成 64 位版本。初步调查表明这并没有真正起作用，因为我的项目文件没有 64 位配置。（也许我可以通过在文本编辑器中将 64 位配置添加到 vcproj 文件中来捏造这一点。）

最后一个选择可能是放弃 MSVC，并将我的项目移植到[MinGW/MSYS](http://www.mingw.org/)工具链。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T14:42:46.847

您可以使用*makedepend*作为*gcc -M*的替代品。[这](http://make.paulandlesley.org/autodep.html)是有关此方法和其他生成依赖项的方法的入门指南。

您也可以尝试使用*autoconf+automake*组合，尽管它需要一些工作才能使其使用 MSVC 的编译器。[有些](http://www.mail-archive.com/automake@gnu.org/msg10824.html)人已经成功地做到了这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T18:25:28.097

如果您想将 Windows SDK 编译器与 GNU make 或其他构建系统一起使用，您可以编写一个程序/脚本，将输出转换[`cl.exe /showIncludes`](http://msdn.microsoft.com/en-us/library/hdkef6tk.aspx)为与您的构建系统兼容的格式。

# datepicker - jQuery UI 日期选择器翻译

> ID：523850
> 
> 赞同：10
> 
> 时间：2009-02-07T14:28:58.900
> 
> 标签：datepicker, translate, jquery-ui-plugins

如何将 jQuery UI 中的日期选择器翻译成另一种语言（例如德语）？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-07T14:41:06.147

已经有[jQuery Datepicker 的本地化版本](http://ui.jquery.com/demos/datepicker/#localization)。该演示似乎没有按预期工作，但是如果您获取源代码并构建一个页面，您可以看到它可以工作

**编辑：**

您可以在[此处查看工作版本](http://ui.jquery.com/demos/datepicker/localization.html)

# algorithm - 向量的排列

> ID：523861
> 
> 赞同：8
> 
> 时间：2009-02-07T14:41:28.580
> 
> 标签：algorithm, vector, permutation, swap

假设我有一个向量：

```
 0  1  2  3  4  5
[45,89,22,31,23,76] 
```

及其索引的排列：

```
[5,3,2,1,0,4] 
```

有没有一种有效的方法可以根据排列得到：

```
[76,31,22,89,45,23] 
```

最多使用 O(1) 额外空间？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-07T14:50:32.307

是的。从最左边的位置开始，我们通过将元素与该位置 i 处的（其他）错位元素交换，将*元素*放置在其正确的*位置*i。这是我们需要 O(1) 额外空间的地方。我们不断交换元素对，直到该位置的元素正确为止。只有这样我们才能进入下一个位置并做同样的事情。

**例子：**

[5 3 2 1 0 4] 初始状态

[4 3 2 1 0 5] 交换 (5,4)，现在 5 位置正确，但 4 仍然错误

[0 3 2 1 4 5] 交换了 (4,0)，现在 4 和 0 都在正确的位置，移动到下一个位置

[0 1 2 3 4 5] 交换 (3,1)，现在 1 和 3 都在正确的位置，移动到下一个位置

[0 1 2 3 4 5] 所有元素都在正确的位置，结束。

**注意**：

由于每个交换操作都会将至少一个（两个）元素放在正确的位置，因此我们总共需要不超过 N 个这样的交换。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-07T15:30:33.910

Zach 的解决方案非常好。

不过，我想知道为什么需要排序。如果您有索引的排列，请将这些值用作指向旧数组的指针。

这可以消除首先对数组进行排序的需要。这不是可以在所有情况下使用的解决方案，但在大多数情况下都可以正常工作。

例如：

```
a = [45,89,22,31,23,76];
b = [5,3,2,1,0,4] 
```

现在，如果您想遍历 a 中的值**，**可以执行以下操作（伪代码）：

```
for i=0 to 4
{
    process(a[i]);
} 
```

如果要以新顺序遍历值，请执行以下操作：

```
for i=0 to 4
{
    process(a[b[i]]);
} 
```

如前所述，这种解决方案在许多情况下可能就足够了，但在其他一些情况下可能就不够了。对于其他情况，您可以使用 Zach 的解决方案。但是对于可以使用此解决方案的情况，它会更好，因为根本不需要排序。

# java - 连接字符串对象列表的最佳方法？

> ID：523871
> 
> 赞同：165
> 
> 时间：2009-02-07T14:51:23.583
> 
> 标签：java, string, list

连接 String 对象列表的最佳方法是什么？我正在考虑这样做：

```
List<String> sList = new ArrayList<String>();

// add elements

if (sList != null)
{
    String listString = sList.toString();
    listString = listString.subString(1, listString.length() - 1);
} 
```

我不知何故发现这比使用 StringBuilder/StringBuffer 方法更整洁。

有什么想法/意见吗？

* * *

## 回答 #1

> 赞同：364
> 
> 时间：2009-02-08T01:56:06.270

使用Apache Commons Lang 中的[StringUtils.join方法之一。](http://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/StringUtils.html#join%28java.lang.Iterable,%20char%29)

```
import org.apache.commons.lang3.StringUtils;

String result = StringUtils.join(list, ", "); 
```

如果您有幸使用 Java 8，那么它会更容易......只需使用[String.join](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#join-java.lang.CharSequence-java.lang.Iterable-)

```
String result = String.join(", ", list); 
```

* * *

## 回答 #2

> 赞同：191
> 
> 时间：2013-12-03T13:07:34.373

使用 Java 8+

```
String str = list.stream().collect(Collectors.joining()) 
```

甚至

```
String str = String.join("", list); 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2009-02-07T15:11:28.380

您的方法取决于 Java 的 ArrayList#toString() 实现。

尽管 Java API 中记录了该实现并且不太可能更改，但它有可能发生变化。自己实现这个要可靠得多（循环，StringBuilders，递归任何你喜欢的东西）。

当然，这种方法可能看起来“更整洁”或更“太甜”或“钱”，但在我看来，这是一种更糟糕的方法。

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2009-02-07T16:41:15.123

codefin 答案的变体

```
public static String concatStringsWSep(Iterable<String> strings, String separator) {
    StringBuilder sb = new StringBuilder();
    String sep = "";
    for(String s: strings) {
        sb.append(sep).append(s);
        sep = separator;
    }
    return sb.toString();                           
} 
```

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2014-09-24T15:30:15.040

如果您正在为 Android 开发，则有[`TextUtils.join`](http://developer.android.com/reference/android/text/TextUtils.html#join(java.lang.CharSequence,%20java.lang.Iterable))SDK 提供。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2016-07-23T22:26:19.320

这是迄今为止我发现的最优雅、最干净的方式：

```
list.stream().collect(Collectors.joining(delimiter)); 
```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2012-01-02T11:41:29.127

[Guava](http://code.google.com/p/guava-libraries/)是来自 Google 的一个非常简洁的库：

```
Joiner joiner = Joiner.on(", ");
joiner.join(sList); 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2014-09-16T04:16:31.853

我更喜欢 Java 8 中的 String.join(list)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-02-07T15:09:13.110

你看过这个编码恐怖博客条目吗？

[微优化剧场的悲惨悲剧](http://www.codinghorror.com/blog/archives/001218.html)

我不确定它是否“更整洁”，但从性能的角度来看，它可能并不重要。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-02-07T15:09:07.777

`ArrayList`从 继承其`toString()`- 方法[`AbstractCollection`](https://openjdk.dev.java.net/source/browse/openjdk/jdk/trunk/jdk/src/share/classes/java/util/AbstractCollection.java?rev=257&view=markup)，即：

```
public String toString() {
    Iterator<E> i = iterator();
    if (! i.hasNext())
        return "[]";

    StringBuilder sb = new StringBuilder();
    sb.append('[');
    for (;;) {
        E e = i.next();
        sb.append(e == this ? "(this Collection)" : e);
        if (! i.hasNext())
            return sb.append(']').toString();
        sb.append(", ");
    }
} 
```

自己构建字符串会更有效率。

* * *

如果您真的想预先在某种列表中聚合字符串，您应该提供自己的方法来有效地加入它们，例如：

```
static String join(Collection<?> items, String sep) {
    if(items.size() == 0)
        return "";

    String[] strings = new String[items.size()];
    int length = sep.length() * (items.size() - 1);

    int idx = 0;
    for(Object item : items) {
        String str = item.toString();
        strings[idx++] = str;
        length += str.length();
    }

    char[] chars = new char[length];
    int pos = 0;

    for(String str : strings) {
        str.getChars(0, str.length(), chars, pos);
        pos += str.length();

        if(pos < length) {
            sep.getChars(0, sep.length(), chars, pos);
            pos += sep.length();
        }
    }

    return new String(chars);
} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-02-07T16:02:51.537

在我看来，StringBuilder 将快速高效。

基本形式如下所示：

```
public static String concatStrings(List<String> strings)
{
    StringBuilder sb = new StringBuilder();
    for(String s: strings)
    {
        sb.append(s);
    }
    return sb.toString();       
} 
```

如果这太简单了（可能是这样），您可以使用类似的方法并添加如下分隔符：

```
 public static String concatStringsWSep(List<String> strings, String separator)
{
    StringBuilder sb = new StringBuilder();
    for(int i = 0; i < strings.size(); i++)
    {
        sb.append(strings.get(i));
        if(i < strings.size() - 1)
            sb.append(separator);
    }
    return sb.toString();               
} 
```

我同意其他回答这个问题的人的观点，他们说你不应该依赖 Java ArrayList 的 toString() 方法。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-02-07T14:56:51.217

> 我不知何故发现这比使用 StringBuilder/StringBuffer 方法更整洁。

我想这取决于你采取了什么方法。

AbstractCollection#toString() 方法简单地遍历所有元素并将它们附加到 StringBuilder。因此，您的方法可能会节省几行代码，但代价是额外的字符串操作。这种权衡是否合适取决于您。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2016-06-22T21:35:37.603

`ArrayList.toString()`如果您使用的是 java 8，您可以编写一个单行代码，而不是依赖于实现：

```
String result = sList.stream()
                     .reduce("", String::concat); 
```

如果您更喜欢使用`StringBuffer`而不是 String，因为`String::concat`它的运行时为`O(n^2)`，您可以将 every 转换`String`为`StringBuffer`first。

```
StringBuffer result = sList.stream()
                           .map(StringBuffer::new)
                           .reduce(new StringBuffer(""), StringBuffer::append); 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2013-11-11T14:41:53.620

彼得劳里的答案的下一个变体，没有在每个循环转弯时初始化一个新字符串

```
String concatList(List<String> sList, String separator)
{
    Iterator<String> iter = sList.iterator();
    StringBuilder sb = new StringBuilder();

    while (iter.hasNext())
    {
        sb.append(iter.next()).append( iter.hasNext() ? separator : "");
    }
    return sb.toString();
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-03-04T09:45:36.837

假设仅移动指针/将字节设置为 null（或者 Java 实现 StringBuilder#setLength）更快，而不是每次通过循环检查条件以查看何时附加分隔符，您可以使用此方法：

```
public static String Intersperse (Collection<?> 集合，字符串分隔符)
{
    StringBuilder sb = new StringBuilder ();
    对于（对象项目：集合）
    {
        if (item == null) 继续；
        sb.append (item).append (分隔符);
    }
    sb.setLength(sb.length() - delimiter.length());
    return sb.toString();
}
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-07T14:59:32.053

根据对性能的需要和要添加的元素数量，这可能是一个不错的解决方案。如果元素的数量很高，那么`Arraylist`s 的内存重新分配可能会比 s 慢一点`StringBuilder`。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-08T02:49:33.790

使用[函数式 Java](http://functionaljava.org)库，导入这些：

```
import static fj.pre.Monoid.stringMonoid;
import static fj.data.List.list;
import fj.data.List; 
```

...那么你可以这样做：

```
List<String> ss = list("foo", "bar", "baz");
String s = stringMonoid.join(ss, ", "); 
```

或者，通用方式，如果您没有字符串列表：

```
public static <A> String showList(List<A> l, Show<A> s) {
  return stringMonoid.join(l.map(s.showS_()), ", ");
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-04-28T16:16:06.027

如果您的依赖项中有 json。您可以使用`new JSONArray(list).toString()`

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-01-06T15:16:11.493

在 java 8 中，您还可以使用减速器，例如：

```
public static String join(List<String> strings, String joinStr) {
    return strings.stream().reduce("", (prev, cur) -> prev += (cur + joinStr));
} 
```

# c++ - 如何在 C++ 中序列化对象？

> ID：523872
> 
> 赞同：99
> 
> 时间：2009-02-07T14:51:43.240
> 
> 标签：c++, serialization, marshalling, c++-faq

我有一个小的对象层次结构，我需要通过套接字连接对其进行序列化和传输。我需要序列化对象，然后根据它的类型反序列化它。有没有一种简单的方法可以在 C++ 中做到这一点（就像在 Java 中一样）？

有没有 C++ 序列化在线代码示例或教程？

**编辑：**为了清楚起见，我正在寻找将对象转换为字节数组，然后再转换回对象的方法。我可以处理套接字传输。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-02-07T14:57:04.210

说到序列化，我想到了[boost 序列化 API 。](http://www.boost.org/doc/libs/1_37_0/libs/serialization/doc/index.html)至于通过网络传输序列化数据，我会使用 Berkeley 套接字或[asio 库](http://tenermerx.com/Asio/)。

**编辑：**
如果要将对象序列化为字节数组，可以按以下方式使用 boost 序列化程序（取自教程站点）：

```
#include <boost/archive/binary_oarchive.hpp>
#include <boost/archive/binary_iarchive.hpp>
class gps_position
{
private:
    friend class boost::serialization::access;
    template<class Archive>
    void serialize(Archive & ar, const unsigned int version)
    {
        ar & degrees;
        ar & minutes;
        ar & seconds;
    }
    int degrees;
    int minutes;
    float seconds;

public:
    gps_position(){};
    gps_position(int d, int m, float s) :
    degrees(d), minutes(m), seconds(s)
    {}
}; 
```

实际的序列化非常简单：

```
#include <fstream>
std::ofstream ofs("filename.dat", std::ios::binary);

    // create class instance
    const gps_position g(35, 59, 24.567f);

    // save data to archive
    {
        boost::archive::binary_oarchive oa(ofs);
        // write class instance to archive
        oa << g;
        // archive and stream closed when destructors are called
    } 
```

反序列化以类似的方式工作。

还有一些机制可以让您处理指针的序列化（复杂的数据结构，如树等没有问题），派生类，您可以在二进制和文本序列化之间进行选择。此外，所有 STL 容器都支持开箱即用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-07T15:17:36.027

在某些情况下，在处理简单类型时，您可以这样做：

```
object o;
socket.write(&o, sizeof(o)); 
```

这可以作为概念验证或初稿，因此您团队的其他成员可以继续处理其他部分。

**但是迟早，*通常会更早*，这会让你受伤！**

您遇到以下问题：

*   虚拟指针表将被损坏。
*   指针（指向数据/成员/函数）将被损坏。
*   不同机器上填充/对齐的差异。
*   Big/Little-Endian 字节排序问题。
*   浮动/双精度实现的变化。

（另外，您需要知道在接收方要拆包的内容。）

您可以通过为每个类开发自己的编组/解组方法来改进这一点。（理想情况下是虚拟的，因此它们可以在子类中扩展。）一些简单的宏可以让您以大/小端中立的顺序非常快速地写出不同的基本类型。

[但是，通过boost 的序列化库](http://www.boost.org/doc/libs/1_37_0/libs/serialization/doc/index.html)处理这种繁重的工作要好得多，也更容易。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2018-05-06T23:10:55.863

有一个通用模式可用于序列化对象。基本原语是您可以从迭代器中读取和写入的这两个函数：

```
template <class OutputCharIterator>
void putByte(char byte, OutputCharIterator &&it)
{
    *it = byte;
    ++it;
}

template <class InputCharIterator>
char getByte(InputCharIterator &&it, InputCharIterator &&end)
{
    if (it == end)
    {
        throw std::runtime_error{"Unexpected end of stream."};
    }

    char byte = *it;
    ++it;
    return byte;
} 
```

然后序列化和反序列化函数遵循以下模式：

```
template <class OutputCharIterator>
void serialize(const YourType &obj, OutputCharIterator &&it)
{
    // Call putbyte or other serialize overloads.
}

template <class InputCharIterator>
void deserialize(YourType &obj, InputCharIterator &&it, InputCharIterator &&end)
{
    // Call getByte or other deserialize overloads.
} 
```

对于类，您可以使用友元函数模式来允许使用 ADL 找到重载：

```
class Foo
{
    int internal1, internal2;

    // So it can be found using ADL and it accesses private parts.
    template <class OutputCharIterator>
    friend void serialize(const Foo &obj, OutputCharIterator &&it)
    {
        // Call putByte or other serialize overloads.
    }

    // Deserialize similar.
}; 
```

然后在你的程序中，你可以序列化和对象到这样的文件中：

```
std::ofstream file("savestate.bin");
serialize(yourObject, std::ostreambuf_iterator<char>(file)); 
```

然后阅读：

```
std::ifstream file("savestate.bin");
deserialize(yourObject, std::istreamBuf_iterator<char>(file), std::istreamBuf_iterator<char>()); 
```

* * *

我的旧答案在这里：

序列化意味着将您的对象转换为二进制数据。而反序列化意味着从数据中重新创建一个对象。

序列化时，您将字节推入`uint8_t`向量中。反序列化时，您正在从`uint8_t`向量中读取字节。

在序列化内容时，您当然可以使用一些模式。

每个可序列化类都应该有一个`serialize(std::vector<uint8_t> &binaryData)`或类似的签名函数，它将其二进制表示写入提供的向量。然后这个函数可以把这个向量传递给它的成员的序列化函数，这样他们也可以把他们的东西写进去。

因为数据表示在不同的架构上可能不同。您需要找出如何表示数据的方案。

让我们从基础开始：

### 序列化整数数据

只需按小端顺序写入字节即可。如果大小很重要，或者使用 varint 表示。

以小端顺序序列化：

```
data.push_back(integer32 & 0xFF);
data.push_back((integer32 >> 8) & 0xFF);
data.push_back((integer32 >> 16) & 0xFF);
data.push_back((integer32 >> 24) & 0xFF); 
```

从小端顺序反序列化：

```
integer32 = data[0] | (data[1] << 8) | (data[2] << 16) | (data[3] << 24); 
```

## 序列化浮点数据

据我所知，IEEE 754 在这里拥有垄断地位。我不知道任何主流架构会使用其他东西作为浮动。唯一可以不同的是字节顺序。一些体系结构使用小端，另一些使用大端字节顺序。这意味着您需要小心在接收端大声播放字节的顺序。另一个区别可能是处理非正规和无穷大和 NAN 值。但只要你避免这些值，你应该没问题。

序列化：

```
uint8_t mem[8];
memcpy(mem, doubleValue, 8);
data.push_back(mem[0]);
data.push_back(mem[1]);
... 
```

反序列化是向后做的。注意架构的字节顺序！

## 序列化字符串

首先，您需要就编码达成一致。UTF-8 很常见。然后将其存储为长度前缀的方式：首先使用我上面提到的方法存储字符串的长度，然后逐字节写入字符串。

## 序列化数组。

它们与字符串相同。您首先序列化一个表示数组大小的整数，然后序列化其中的每个对象。

## 序列化整个对象

正如我之前所说，他们应该有一种`serialize`将内容添加到向量的方法。要反序列化一个对象，它应该有一个接受字节流的构造函数。它可以是一个`istream`但在最简单的情况下它可以只是一个引用`uint8_t`指针。构造函数从流中读取它想要的字节并设置对象中的字段。如果系统设计良好并按对象字段顺序序列化字段，您只需将流传递给初始化列表中的字段构造函数，并以正确的顺序对它们进行反序列化。

## 序列化对象图

首先，您需要确定这些对象是否真的是您想要序列化的东西。如果目标上存在这些对象的实例，则不需要序列化它们。

现在您发现需要序列化指针指向的对象。仅在使用它们的程序中才有效的指针问题。您不能序列化指针，您应该停止在对象中使用它们。而是创建对象池。这个对象池基本上是一个包含“盒子”的动态数组。这些框有一个引用计数。非零引用计数表示一个活动对象，零表示一个空槽。然后创建类似于 shared_ptr 的智能指针，它不存储指向对象的指针，而是存储数组中的索引。您还需要就表示空指针的索引达成一致，例如。-1。

基本上我们在这里所做的是将指针替换为数组索引。现在在序列化时，您可以像往常一样序列化这个数组索引。您无需担心对象将在目标系统的内存中的什么位置。只要确保它们也具有相同的对象池。

所以我们需要序列化对象池。但哪些？好吧，当您序列化一个对象图时，您不仅仅是在序列化一个对象，而是在序列化整个系统。这意味着系统的序列化不应从系统的某些部分开始。这些对象不应该担心系统的其余部分，它们只需要序列化数组索引就可以了。您应该有一个系统序列化程序来编排系统的序列化并遍历相关的对象池并序列化所有对象池。

在接收端，所有数组和其中的对象都被反序列化，重新创建所需的对象图。

## 序列化函数指针

不要在对象中存储指针。有一个静态数组，其中包含指向这些函数的指针并将索引存储在对象中。

由于这两个程序都将该表编译到它们的架子中，因此仅使用索引应该可以工作。

## 序列化多态类型

既然我说过你应该避免使用可序列化类型的指针，而应该使用数组索引，那么多态性就无法工作，因为它需要指针。

您需要使用类型标签和联合来解决这个问题。

## 版本控制

在所有上述之上。您可能希望不同版本的软件互操作。

在这种情况下，每个对象都应该在其序列化的开头写一个版本号来指示版本。

在另一侧加载对象时，较新的对象可能能够处理较旧的表示，但较旧的对象无法处理较新的表示，因此它们应该对此抛出异常。

每次发生变化时，您都应该增加版本号。

* * *

所以总结一下，序列化可能很复杂。但幸运的是，您不需要序列化程序中的所有内容，通常只序列化协议消息，这些消息通常是普通的旧结构。所以你不需要我上面经常提到的复杂技巧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-09-09T00:31:19.313

通过学习，我编写了一个简单的 C++11 序列化程序。我尝试了其他各种重量级的产品，但想要一些我能真正理解的东西，当它出错或无法用最新的 g++ 编译时（这发生在我使用 Cereal 时；一个非常好的库但很复杂，我无法理解编译器在升级时抛出的错误。）无论如何，它只是标题并处理 POD 类型、容器、地图等......没有版本控制，它只会从保存它的同一个拱门加载文件。

[https://github.com/goblinhack/simple-c-plus-plus-serializer](https://github.com/goblinhack/simple-c-plus-plus-serializer)

示例用法：

```
#include "c_plus_plus_serializer.h"

static void serialize (std::ofstream out)
{
    char a = 42;
    unsigned short b = 65535;
    int c = 123456;
    float d = std::numeric_limits<float>::max();
    double e = std::numeric_limits<double>::max();
    std::string f("hello");

    out << bits(a) << bits(b) << bits(c) << bits(d);
    out << bits(e) << bits(f);
}

static void deserialize (std::ifstream in)
{
    char a;
    unsigned short b;
    int c;
    float d;
    double e;
    std::string f;

    in >> bits(a) >> bits(b) >> bits(c) >> bits(d);
    in >> bits(e) >> bits(f);
} 
```

# open-source - 何时合并开源项目？

> ID：523873
> 
> 赞同：1
> 
> 时间：2009-02-07T14:52:13.630
> 
> 标签：open-source, merge

示例：我们的前 3 名用户中有 2 名正在从事几乎相同的项目（我不深入了解他们，也许我错了）：

[Marc Gravell](https://stackoverflow.com/users/23354/marc-gravell)的[Protobuf-Net](http://code.google.com/p/protobuf-net/)

[Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)的[DotNet-Protobuf](http://github.com/jskeet/dotnet-protobufs/tree/master)

关于 Jon Skeet 的笑话分开，梦想着一个无耻的理想世界（对不起，我不是在指责你傲慢，这是每个程序员都必须捍卫自己的代码的事实），这不是一个很好的合作机会吗？ ?

我并不是说社区应该决定一个人必须做什么，我只是想让你提出合并项目的利弊，以及哪些项目必须成为这种分析的主题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T16:18:01.320

在没有对可用解决方案进行彻底研究并且没有认真考虑加入现有项目的可能性的情况下开始一个新项目，是社区应该更加强烈反对的事情。也许程序员的教育应该包括一些关于重复工作成本的讨论。

话虽如此，尝试不同的方法来解决同一个问题是健康的，一旦程序员有了一些玩具代码，我们应该感谢他将其提供给公众，无论是否存在类似的项目。

我认为作者应该认真考虑合并，如果：

*   一种设计已被证明明显优于另一种
*   一个社区比另一个社区更活跃
*   两个项目在未来方向上有着相同的想法
*   合并两个代码库所需的工作是可行的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T16:53:33.353

合并应该在总体有利时进行。例如，如果其中一个或两个项目：

*   太弱而无法靠自己生存（没有足够的积极发展来跟上技术的变化）；或者...
*   可以通过重叠（即不完全相同）的功能提供良好的协同作用。

然而，拥有两个做同样事情的强大项目并没有什么问题——这有助于鼓励创新，因为它们试图比对方更好。

# ruby - 您如何使用 test/spec（不是特定文件，而是给定文件中的规范）运行特定测试？

> ID：523874
> 
> 赞同：1
> 
> 时间：2009-02-07T14:52:22.847
> 
> 标签：ruby

使用 Test::Unit，我可以运行：

```
ruby path/to/test.rb --name=test_name_that_i_want_to_run 
```

到目前为止，我还无法弄清楚如何使用测试/规范规范来做到这一点。我想知道自动命名规范的方式是否不允许我做这样的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T00:45:35.257

以以下规范为例：

```
 require 'rubygems'  
  require 'spec'  

  describe 'tests' do  
    it 'should be true' do  
      1.should == 1  
    end

    it 'should be false' do  
      1.should_not == 2  
    end  
  end 
```

您可以通过使用 -e 标志并提供由 it 块指定的部分来执行单个规范。例如`ruby my_spec.rb -e 'should be false'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T02:16:10.433

在联系了 gem 维护者 Christian Neukirchen 之后，我发现了如何做到这一点，所以我在这里记录下来以备将来参考。

```
specrb path/to/test.rb --name ".*should behave this way.*" 
```

我需要使用 specrb 测试运行器，一个扩展版本的 Test::Unit 的测试运行器，而不仅仅是 ruby​​ 命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T03:56:07.117

您也可以使用 ruby​​ 命令执行此操作：

ruby path/to/test.rb -n "/应该这样做/"

# c# - 在哪里放 try catch

> ID：523875
> 
> 赞同：21
> 
> 时间：2009-02-07T14:54:39.723
> 
> 标签：c#, .net

考虑这种情况：我有 3 层应用程序，当用户单击按钮时，按钮事件处理程序调用 biz 层中的一个方法，该方法对我的按钮事件处理程序提供的数据执行任何操作，然后将该数据传递给发送数据的访问层他们到后端数据库。问题是在哪里放置try catch？在数据层，在商务层，在表示层，或者可能把它放在所有这些层？在这种情况下，表示异常处理的最佳策略是什么？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-02-07T15:00:07.777

我们跟随

> 如果您不知道如何处理异常，请不要捕获异常。

我们从不处理任何我们无法处理或默认的异常。它会冒泡，我们在应用程序级别处理它。

假设您可以为业务对象默认一个值，那么您可以在业务层中处理它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-07T14:58:02.213

一定要在离用户最近的地方放一个try catch——因为在那个位置你可以把它翻译成对你的用户有意义的东西。

仅当您打算对它们执行某些操作时，才需要更深入的尝试捕获——例如，处理异常，或者可能记录并重新抛出异常。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-07T17:03:26.033

异常处理的口号是：“早扔，晚抓”。您想在可能的最后时刻捕获异常，但您想立即抛出它们（不要在确定有问题后执行更多处理然后抛出异常）。如果您无法“处理”异常，请不要捕获它。

在大多数情况下，Try...Finally 块在您的代码中应该比 Try...Catch 更常见。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-07T15:02:58.833

可能最好在所有层中使用 try catch，但仅在 UI 层中静默捕获异常。在商业和数据访问层中，您可能应该在重新抛出之前捕获异常并记录信息

```
try
{
    //do something 
}
catch(Exception ex)
{
    LogFile.WriteLine(ex.ToString());
    throw;
} 
```

注意：不要写：

```
throw ex; 
```

因为这将从异常中清除所有有用的堆栈信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-07T15:14:26.453

始终在顶层或控制器级别尝试/捕获。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-07T16:31:07.297

将 try-catch 放在您确定不会吞下异常的地方。如果您可以确保一致性，则各个层中的多个 try-catch 块可能是可以的。

例如，您可以在数据访问层中放置一个 try-catch 以确保正确清理连接。但是因为你不能在那里做更多的事情，你可能应该重新抛出异常。

转移到业务层，您可以将 try-catch 放在您希望以原子方式进行的多个数据库操作中。在这种情况下，您可能应该回滚所有内容或将事物置于一致状态，在某处记录异常。应根据具体情况决定吞咽或重新投掷。

您的表示层应始终捕获所有异常，无论是某些 Web 应用程序、在浏览器中运行的脚本还是某些富客户端应用程序。您可能无法完全理解异常，但至少您可以确保您的应用程序不会在用户面前死掉。

当然，这只是一个建议。YMMV。:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-07T15:00:56.420

这仅取决于您实际上想在哪里做某事。通常我在业务层捕获它，然后记录它并可能调用一些 ui 函数向用户显示消息。

我认为如何处理错误是一种业务规则。它应该与数据层或ui层分开。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-07T15:01:31.457

一般的答案是：随时抓住你可以处理抛出的东西。也就是说，决定很简单。例如，捕获在创建所需对象时出现的异常。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-07T15:17:19.787

UI 仅用于演示。您不会在那里捕获异常，因为弄清楚如何处理它意味着逻辑。这属于业务或控制器层。在最坏的情况下，您会捕获异常并将其映射到适当的、用户友好的错误消息，然后将其发送到演示文稿进行显示。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-07T16:36:10.207

当我有这样的多层架构（很多）时，我经常会在不止一层上尝试/捕获。例如，持久层中的 try/catch 捕获 SQLException，执行持久层需要执行的操作（例如通知管理员）然后抛出一个新异常，该异常对调用持久层的某些代码有意义. 一个例子可能是 PersistenceException。下一层并不关心应该通知谁重新启动数据库，但它确实关心它无法保存用户状态，因此它可能会捕获 PersistenceException 并告诉用户他的新电话号码是' t 存储在数据库中。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-02-07T17:17:48.263

您只想使用 try catch 来管理未处理的代码。一个例子是我有一个正在与之通信的 COM 对象，我不希望它保持打开状态并造成内存泄漏。另一个可接受的替代方法是在允许异常继续之前捕获数据库中事件的错误。

您永远不想使用 try catch 来处理您不确定代码是否可以工作并需要备份计划的情况。

那么，当应用程序崩溃时，您会遇到什么问题，使用自定义错误页面来指示您的 Web 应用程序中出现了问题，并且对于胖客户端来说，将代码解析到工作线程中，这样它们就不会在失败时破坏您的主线程。祝你好运！

# bash - 如何从 bash 脚本终止 Cygwin bash 中脚本的进程树

> ID：523878
> 
> 赞同：4
> 
> 时间：2009-02-07T14:55:54.150
> 
> 标签：bash, process, scripting, cygwin, terminate

我有一个 Cygwin bash 脚本，我需要在某些条件下监视和终止它 - 特别是在创建某个文件之后。但是，我很难弄清楚如何以与 Ctrl+C 相同的完整性级别来终止脚本。

这是一个简单的脚本（称为**`test1`**），它只是等待被终止。

```
#!/bin/bash

test -f kill_me && rm kill_me

touch kill_me
tail -f kill_me 
```

如果此脚本在前台运行，Ctrl+C 将终止`tail`脚本本身和脚本本身。如果脚本在后台运行，a `kill %1`（假设它是作业 1）也将终止`tail`脚本。

但是，当我尝试从脚本做同样的事情时，我发现只有`bash`运行脚本的进程被终止，而`tail`挂起与它的父进程断开连接。这是我尝试的一种方法（**`test2`**）：

```
#!/bin/bash

test -f kill_me && rm kill_me

(
    touch kill_me
    tail -f kill_me
) &

while true; do
    sleep 1
    test -f kill_me && {
        kill %1
        exit
    }
done 
```

如果运行它，后台运行的 bash 子shell 会正常终止，但`tail`仍会挂起。

如果我像这样使用显式单独的脚本，它仍然不起作用（**`test3`**）：

```
#!/bin/bash

test -f kill_me && rm kill_me

# assuming test1 above is included in the same directory
./test1 &

while true; do
    sleep 1
    test -f kill_me && {
        kill %1
        exit
    }
done 
```

`tail`运行此脚本后仍在徘徊。

在我的实际情况下，创建文件的过程并不是特别有用，所以我不能让它自行终止；但是，通过找出它何时创建特定文件，我可以知道终止它是可以的。不幸的是，我不能使用简单的`killall`或等效的，因为可能有多个实例正在运行，我只想杀死特定的实例。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T02:38:23.220

/bin/kill（程序，而不是内置的 bash）将*负*PID 解释为“杀死进程组”，这也将获取所有子进程。

改变

```
kill %1 
```

到

```
/bin/kill -- -$$ 
```

为我工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T19:04:55.413

亚当的链接使我朝着可以解决问题的方向前进，尽管并非没有一些小警告。

该脚本在 Cygwin 下未经修改无法正常工作，因此我重写了它，并提供了更多选项。这是我的版本：

```
#!/bin/bash

function usage
{
    echo "usage: $(basename $0) [-c] [-<sigspec>] <pid>..."
    echo "Recursively kill the process tree(s) rooted by <pid>."
    echo "Options:"
    echo "  -c        Only kill children; don't kill root"
    echo "  <sigspec> Arbitrary argument to pass to kill, expected to be signal specification"
    exit 1
}

kill_parent=1
sig_spec=-9

function do_kill # <pid>...
{
    kill "$sig_spec" "$@"
}

function kill_children # pid
{
    local target=$1
    local pid=
    local ppid=
    local i
    # Returns alternating ids: first is pid, second is parent
    for i in $(ps -f | tail +2 | cut -b 10-24); do
        if [ ! -n "$pid" ]; then
            # first in pair
            pid=$i
        else
            # second in pair
            ppid=$i
            (( ppid == target && pid != $$ )) && {
                kill_children $pid
                do_kill $pid
            }
            # reset pid for next pair
            pid=
        fi
    done

}

test -n "$1" || usage

while [ -n "$1" ]; do
    case "$1" in
        -c)
            kill_parent=0
            ;;

        -*)
            sig_spec="$1"
            ;;

        *)
            kill_children $1
            (( kill_parent )) && do_kill $1
            ;;
    esac
    shift
done 
```

唯一真正的缺点是 bash 在收到致命信号时会打印出有点难看的消息，即“终止”、“已终止”或“中断”（取决于您发送的内容）。但是，我可以在批处理脚本中接受它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T15:18:48.380

[这个脚本](http://unix.derkeiler.com/Newsgroups/comp.unix.shell/2004-05/1108.html)看起来可以完成这项工作：

```
#!/bin/bash
# Author: Sunil Alankar

##
# recursive kill. kills the process tree down from the specified pid
#

# foreach child of pid, recursive call dokill
dokill() {
    local pid=$1
    local itsparent=""
    local aprocess=""
    local x=""
    # next line is a single line
    for x in `/bin/ps -f | sed -e '/UID/d;s/[a-zA-Z0-9_-]\{1,\}
\{1,\}\([0-9]\{1,\}\) \{1,\}\([0-9]\{1,\}\) .*/\1 \2/g'`
    do
        if [ "$aprocess" = "" ]; then
            aprocess=$x
            itsparent=""
            continue
        else
            itsparent=$x
            if [ "$itsparent" = "$pid" ]; then
                dokill $aprocess
            fi
            aprocess=""
        fi
    done
    echo "killing $1"
    kill -9 $1 > /dev/null 2>&1
}

case $# in
1) PID=$1
        ;;
*) echo "usage: rekill <top pid to kill>";
        exit 1;
        ;;
esac

dokill $PID 
```

# .net - 需要帮助 NGen 恢复工作状态

> ID：523879
> 
> 赞同：7
> 
> 时间：2009-02-07T14:56:12.247
> 
> 标签：.net, clr, ngen

NGen 对我的电脑不满意，我找不到深入了解问题所在的方法。

每次启动后，ngen 都会记录以下消息：

> .NET 运行时优化服务 (clr_optimization_v2.0.50727_32) - 服务达到瞬时错误的限制。将关闭。从服务管理器返回的最后一个错误：0x8000ffff。

当我尝试在命令行启动优化服务时，我再次记录了同样的错误。

我设法启动了 ngen 服务并立即暂停队列（通过编写一个两行批处理文件，如下所示：

> 净启动 clr_optimization_v2.0.50727_32
> 
> ngen 队列暂停

所以现在我尝试通过执行不同状态级别的项目来清除队列，如下所示：

> ngen executequeueditems 3 /nologo /verbose

但结果总是：

> 灾难性故障（HRESULT 异常：0x8000FFFF (E_UNEXPECTED)）

...一路上我已经卸载/重新安装了 Visual Studio 2008。我已经卸载了 SQL Server 2005，并且我已经运行了“系统文件检查器”：sfc /scannow

缺乏想法，希望得到 ngen 专家的帮助。

我如何获得诸如“导致这些灾难性故障的原因是什么？”之类的信息。（请注意，/verbose 选项不会增加我发现的信息量。“要生成的队列中有哪些文件？”——我可以删除其中的一些文件，或者将责任归咎于特定文件。 ..

卸载和重新安装 .net framework 2.0 并不容易，因为这是 vista，它是操作系统的受保护部分。

更新：我也尝试过[这里](http://social.msdn.microsoft.com/Forums/en-US/netfxsetup/thread/f56cc6e4-c2bf-490c-b87b-3e22b1e6b935/)提供的建议（并在第一个回复中提到）——但我只是得到同样的灾难性失败消息。

> C:\Windows\Microsoft.NET\Framework\v2.0.50727>ngen executequeueditems /nologo 灾难性故障（来自 HRESULT 的异常：0x8000FFFF (E_UNEXPECTED)）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T13:31:57.513

在回答这部分问题时：

> “是什么导致了这些灾难性的失败？”

有两个日志文件可以帮助回答这个问题：

```
C:\Windows\Microsoft.NET\Framework\v2.0.50727\ngen.log
C:\Windows\Microsoft.NET\Framework\v2.0.50727\ngen_service.log 
```

（以及通常的应用程序日志，虽然它不太有用）

回答：

> “要生成的队列中有哪些文件？”

通常的答案是，这可以通过运行来查看：

```
ngen.exe display 
```

（虽然在我的情况下它只返回

```
NGEN Roots:    
Catastrophic failure (Exception from HRESULT: 0x8000FFFF (E_UNEXPECTED)) 
```

)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T19:03:48.050

从此：[_](http://social.msdn.microsoft.com/Forums/en-US/netfxsetup/thread/f56cc6e4-c2bf-490c-b87b-3e22b1e6b935/)

> 当 .NET 运行时优化服务遇到它认为是暂时性错误时，它会尝试重新尝试编译程序集；示例包括 RPC 错误、内存不足错误等。但是，在尝试编译相同的程序集 20 次但仍然失败后，它会输出上述消息并关闭。我看到您已经尝试从您的计算机上卸载 .NET Framework 2.0 并重新安装它，但您仍然遇到此错误。我猜想尝试修复安装也无济于事。您可以尝试从 %WINDIR%\Microsoft.NET\Framework\v2.0.50727\ 运行“ngen.exe ExecuteQueuedItems”，然后运行“ngen.exe Update”吗？这将尝试编译所有不' 尚未通过优化服务同步任何/最新的 32 位 NGen 图像。更新命令完成后，您能否再次尝试启动服务并检查系统日志中是否仍然收到相同的消息？如果此问题不是特定于服务的，我希望您也会在命令行输出中看到编译错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-02T13:43:33.637

我有同样的问题（安装 Asp MVC 1.0）。寻找答案时，我发现[了 Haacked 博客](http://haacked.com/archive/2009/03/05/troubleshooting-installers.aspx)，其中解释了一些原因。花了 2 个小时试图解决这个问题后，我感到非常沮丧，以至于我使用过

```
ngen /delete * 
```

有效。但我不确定这是否不会造成小灾难；/

也许这会有所帮助..

# python - 安装 Python 3.0 后写入 self.wfile 时 BaseHTTPRequestHandler 冻结

> ID：523885
> 
> 赞同：0
> 
> 时间：2009-02-07T14:57:29.593
> 
> 标签：python, sockets

我开始对这个失去理智了。

我有一个扩展 BaseHTTPRequestHandler 的类。它在 Python 2.5 上运行良好。昨天我很好奇并决定在我的 Mac 上安装 Python 3.0（我按照本教程进行操作，以确保我没有搞砸： http: [//farmdev.com/thoughts/66/python-3-0-on -mac-os-x-alongside-2-6-2-5-etc-/](http://farmdev.com/thoughts/66/python-3-0-on-mac-os-x-alongside-2-6-2-5-etc-/) ）。我在 Python 3.0 上尝试了我的应用程序，代码刚刚冻结在这一行：

```
self.wfile.write(f.read()) 
```

我搜索并找到了这个错误[http://bugs.python.org/issue3826](http://bugs.python.org/issue3826)。我不明白是否已经有解决方案。但是，最奇怪的是，当我在 2.5 上尝试我的应用程序时，它开始在同一个地方冻结！然后我删除了我从 3.0 安装的所有内容，修复了路径，但它仍然给我错误。我不知道还能做什么。

该应用程序在 2.5 上运行良好，因为我在另一台计算机上尝试过。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-07T15:03:53.713

我建议开发一个简单的页面，该页面将转储 perl 环境的版本详细信息，并确认您现在回到了 2.5。大多数情况下，会遗漏一些环境条目或二进制文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T11:14:51.553

`(mac <-> router <-> router <-> ISP)`对不起，家里的路由器之间的设置似乎很奇怪。

小文件（ < 100kB ）完全没有问题，但大文件被卡住了。我在格式化我的 mac 后发现了它，并意识到它仍在发生。我试图将路由器中的一个移开，它现在确实可以工作。导致它的真正原因，以及为什么它在安装 Python 3.0 之前工作并且在安装 Python 3.0 之后突然停止工作（肯定是巧合）对我来说仍然是隐姓埋名。

感谢读者。

# .net - .Net-我应该使用拆分功能还是拆分方法？

> ID：523890
> 
> 赞同：0
> 
> 时间：2009-02-07T14:59:12.773
> 
> 标签：.net, vb.net, windows-mobile, compact-framework

背景：

我需要将一串多个单词拆分成一个数组，该数组为我分隔单词，以便稍后在我的代码中进一步使用。但是，我需要删除字符串中可能存在的任何数字，因此我声明了一个包含字符的字符串，我想将其用作分隔符/定界符，如下所示：

```
dim Separators As String = " 1234567890" 
```

所以我的代码或多或少如下：

```
''//USING SPLIT-FUNCTION
dim MyTestString as String = "This is 9 a 567 test" 
dim Separators As String = " 1234567890"
dim ResultWithNoNumbers() as String

ResultWithNoNumbers = Split(MyTestString,Separators.ToCharArray)
Messagebox.Show(ResultWithNoNumbers.Length.ToString)
''//Result is 1 and no split was performed 
```

这不起作用，因为拆分功能没有将我的分隔符视为单个字符

然而这有效..

```
''//USING SPLIT-METHOD
dim MyTestString as String = "This is 9 a 567 test" 
dim Separators As String = " 1234567890"
dim ResultWithNoNumbers() as String

ResultWithNoNumbers = MyTestString.Split(Separators.ToCharArray,
                                    _StringSplitOptions.RemoveEmptyEntries)
Messagebox.Show(ResultWithNoNumbers.Length.ToString)
''//Result is 4 and split was performed 
```

到目前为止，一切都很好 - 因为与拆分功能相比，拆分方法有更多选择，所以我设法解决了我的问题。

现在我的问题是，假设我只需要标准的空格字符（“”）作为分隔符（并且不需要像上面的例子那样去掉数字），那么两种方式都可以。那么你会用哪一个呢？除了可用的各种选项外，使用特定选项有什么好处吗？也许一个更快，更少的内存消耗？

编辑：我正在为 Windows Mobile 开发，这就是速度和内存问题变得重要的原因。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T15:15:16.187

这是为两者执行的代码；自己决定。我更喜欢 string.split() 。

**这是调用string.split()**时执行的代码：

```
Private Function InternalSplitKeepEmptyEntries(ByVal sepList As Integer(), ByVal lengthList As Integer(), ByVal numReplaces As Integer, ByVal count As Integer) As String()
    Dim startIndex As Integer = 0
    Dim index As Integer = 0
    count -= 1
    Dim num3 As Integer = IIf((numReplaces < count), numReplaces, count)
    Dim strArray As String() = New String((num3 + 1)  - 1) {}
    Dim i As Integer = 0
    Do While ((i < num3) AndAlso (startIndex < Me.Length))
        strArray(index++) = Me.Substring(startIndex, (sepList(i) - startIndex))
        startIndex = (sepList(i) + IIf((lengthList Is Nothing), 1, lengthList(i)))
        i += 1
    Loop
    If ((startIndex < Me.Length) AndAlso (num3 >= 0)) Then
        strArray(index) = Me.Substring(startIndex)
        Return strArray
    End If
    If (index = num3) Then
        strArray(index) = String.Empty
    End If
    Return strArray
End Function 
```

**以下是调用Split() 函数**时执行的代码：

```
Private Shared Function SplitHelper(ByVal sSrc As String, ByVal sFind As String, ByVal cMaxSubStrings As Integer, ByVal [Compare] As Integer) As String()
    Dim invariantCompareInfo As CompareInfo
    Dim num2 As Integer
    Dim ordinal As CompareOptions
    Dim length As Integer
    Dim num5 As Integer
    Dim num6 As Integer
    If (sFind Is Nothing) Then
        length = 0
    Else
        length = sFind.Length
    End If
    If (sSrc Is Nothing) Then
        num6 = 0
    Else
        num6 = sSrc.Length
    End If
    If (length = 0) Then
        Return New String() { sSrc }
    End If
    If (num6 = 0) Then
        Return New String() { sSrc }
    End If
    Dim num As Integer = 20
    If (num > cMaxSubStrings) Then
        num = cMaxSubStrings
    End If
    Dim strArray As String() = New String((num + 1)  - 1) {}
    If ([Compare] = 0) Then
        ordinal = CompareOptions.Ordinal
        invariantCompareInfo = Strings.m_InvariantCompareInfo
    Else
        invariantCompareInfo = Utils.GetCultureInfo.CompareInfo
        ordinal = (CompareOptions.IgnoreWidth Or (CompareOptions.IgnoreKanaType Or CompareOptions.IgnoreCase))
    End If
    Do While (num5 < num6)
        Dim str As String
        Dim num4 As Integer = invariantCompareInfo.IndexOf(sSrc, sFind, num5, (num6 - num5), ordinal)
        If ((num4 = -1) OrElse ((num2 + 1) = cMaxSubStrings)) Then
            str = sSrc.Substring(num5)
            If (str Is Nothing) Then
                str = ""
            End If
            strArray(num2) = str
            Exit Do
        End If
        str = sSrc.Substring(num5, (num4 - num5))
        If (str Is Nothing) Then
            str = ""
        End If
        strArray(num2) = str
        num5 = (num4 + length)
        num2 += 1
        If (num2 > num) Then
            num = (num + 20)
            If (num > cMaxSubStrings) Then
                num = (cMaxSubStrings + 1)
            End If
            strArray = DirectCast(Utils.CopyArray(DirectCast(strArray, Array), New String((num + 1)  - 1) {}), String())
        End If
        strArray(num2) = ""
        If (num2 = cMaxSubStrings) Then
            str = sSrc.Substring(num5)
            If (str Is Nothing) Then
                str = ""
            End If
            strArray(num2) = str
            Exit Do
        End If
    Loop
    If ((num2 + 1) = strArray.Length) Then
        Return strArray
    End If
    Return DirectCast(Utils.CopyArray(DirectCast(strArray, Array), New String((num2 + 1)  - 1) {}), String())
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T16:03:05.593

我会使用正则表达式

```
Dim MyTestString As String = "This is 9 a 567 test 23424234 this is 
23 another test 23 and 3 again and one 34234 more"
Dim reg_exp As New Text.RegularExpressions.Regex("\d")
Dim reg_exp2 As New Text.RegularExpressions.Regex("\s{2,}")

MyTestString = reg_exp.Replace(MyTestString, String.Empty)
MyTestString = reg_exp2.Replace(MyTestString, " ")

Dim strArr() As String
strArr = MyTestString.ToString.Split(" ")

Console.WriteLine(MyTestString)
Console.ReadLine() 
```

输出：

这是一个测试，这是另一个测试，又是一个又一个

# c++ - 重载。-> 和 :: 用于多平台类

> ID：523894
> 
> 赞同：0
> 
> 时间：2009-02-07T15:00:47.713
> 
> 标签：c++, operator-overloading, multiplatform

假设我有三个窗口类，一个用于我想要支持的每个操作系统：

*   窗口窗口
*   OSX窗口
*   Linux窗口

它们都继承自**Window**类。这也是您实例化的类。Window 类具有 . -> 和 :: 运算符重载，并且根据运行的操作系统（基于 IFDEF），它会将 this 指针转换为相关类。

我想要做的只是创建一个 Window 实例，而不知道正在运行什么操作系统。这种想法是不是很错误？沮丧是危险的吗？有没有更好的方法来做到这一点？

我知道有图书馆可以做到这一点，但我想自己尝试一下。

我想最简单的方法是创建一个工厂。但是这样的事情可以做到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T15:08:43.737

您根本不能重载范围解析运算符 :: 。您可以重载 -> 运算符，但是当您调用该运算符时，您已经必须拥有一个必需类型的对象。要创建您的窗口，只需使用一个简单的工厂方法：

```
class Window
{
public:
    static Window *CreateWindow(...)
    {
#ifdef _WIN32
        return new Win32Window(...);
#elif defined(/** whatever is defined for Linux */)
        return new X11Window(...);
#elif defined(/** whatever is defined for Mac */)
        return new CocoaWindow(...);
#else
#error "Bad platform!"
#endif
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T15:05:52.447

您可能应该做的是有一个工厂方法，并使用 PIMPL 成语。您的工厂创建了 2 个类 - 一个 Window 类和一个 WindowImpl 类。Window 类只是将方法调用转发给 WindowImpl 类。客户端代码向工厂询问窗口，工厂知道（基于配置、平台检查等）要使用哪个实现类。

# c# - 登录方式使用 GINA 进行定制

> ID：523912
> 
> 赞同：0
> 
> 时间：2009-02-07T15:10:12.203
> 
> 标签：c#, .net, windows-services, login, ipc

我知道在 GINA 中找到大师并不容易，但我的问题最接近进程间通信（IPC），我在非托管 C++ 中编写了我的自定义 GINA，我将它包括一个检查指纹有效性的方法，供用户尝试登录时，该函数会调用c#编写的正在运行的系统windows服务中的一些方法，代码如下：

在 GINA 中，非托管 c++

```
if(Fingerprint.Validate(userName,finerprintTemplate)
{
    //perform login
} 
```

在 Windows 服务中，C#

```
public class Fingerprint
{
   public static bool Validate(string userName, byte[] finerprintTemplate)
   {
      //Preform Some code to validate fingerprintTemplate with userName
      //and retuen result
   }
} 
```

有谁知道如何在 GINA 和 windows 服务之间进行这种通信，或者只是在 c++ 编写的服务和 C# 编写的服务之间进行通信。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T15:41:20.270

与服务（或大多数可能需要跨越会话/桌面边界的 IPC）进行通信的规范方法是命名管道。您也可以使用邮槽，但是您必须处理重复问题，因为邮槽消息会在所有已安装的协议中被复制，因此您需要某种标记系统……有点混乱。

请参阅 CreateNamedPipe 的文档并从那里着手。我已经使用管道在 C++ 和 C# 之间进行了交谈：互操作有点混乱（二进制消息），但它是可行的。[这里](http://www.switchonthecode.com/tutorials/interprocess-communication-using-named-pipes-in-csharp)有一些 C# 管道的示例代码（来自双方）。

为特定服务使用管道来服务通信问题的好处是，如果需要，您可以稍后扩展设计以支持 UI。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T15:37:39.357

[NISGINA](ftp://ftp.eng.auburn.edu/pub/cartegw/nisgina/nigel/nigel.html)是一个开源 GINA 插件，用于对 NIS 目录进行身份验证。如果您还没有看到这个，这是我所知道的开源 GINA 插件的唯一示例。如果您还没有，您可能会发现阅读源代码是值得的。

请注意，从 Windows Vista 开始，[GINA 已被弃用](http://technet.microsoft.com/en-us/magazine/2007.03.vistakernel.aspx)，并被另一个名为[Credential Provider Architecture 的 API 取代。](http://msdn.microsoft.com/en-us/magazine/cc163489.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T15:29:06.033

我强烈建议您使用命名管道。如果您使用的是 .Net 3.5 或更高版本，它们在 C# 方面快速、易于使用，并且在 C++ 方面相对容易（提供大量示例）。最重要的是，通过应用简单的安全描述符非常容易保护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-21T01:08:20.657

我很好奇您是否遵循建议的“答案”并尝试了命名管道路线？根据[此链接](http://www.codeguru.com/forum/showthread.php?t=52381)和我自己的经验，GINA 在预身份验证（会话 0）上下文中运行，任何从非托管 C++ GINA dll 访问命名管道的尝试都将导致错误 #5“访问被拒绝”。

我相信 Mailslots 可能是在该级别实际可用的唯一可用的 Windows IPC 机制，但我什至不确定它是否会起作用（还没有尝试过。）

# c# - 登录方式使用 GINA 进行定制

> ID：523929
> 
> 赞同：0
> 
> 时间：2009-02-07T15:16:21.303
> 
> 标签：c#, .net, windows-services, login, ipc

**DUPLICATE** :[使用 GINA 自定义登录方法](https://stackoverflow.com/questions/523912/login-method-customization-using-gina)

* * *

大家好，

我知道在 GINA 中找到大师并不容易，但我的问题最接近进程间通信（IPC），我在非托管 C++ 中编写了我的自定义 GINA，我将它包括一个检查指纹有效性的方法，供用户尝试登录时，该函数会调用c#编写的正在运行的系统windows服务中的一些方法，代码如下：

在 GINA 中，非托管 c++

```
if(Fingerprint.Validate(userName,finerprintTemplate)
{
    //perform login
} 
```

在 Windows 服务中，C#

```
public class Fingerprint
{
   public static bool Validate(string userName, byte[] finerprintTemplate)
   {
      //Preform Some code to validate fingerprintTemplate with userName
      //and retuen result
   }
} 
```

有谁知道如何在 GINA 和 windows 服务之间进行这种通信，或者只是在 c++ 编写的服务和 C# 编写的服务之间进行通信。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-07T15:30:35.737

与服务（或大多数可能需要跨越会话/桌面边界的 IPC）进行通信的规范方法是命名管道。您也可以使用邮槽，但您必须处理重复问题，因为邮槽消息会在所有已安装的协议中被复制，因此您需要某种标记系统……有点混乱。

请参阅 CreateNamedPipe 的文档并从那里着手。我已经使用管道在 C++ 和 C# 之间进行了交谈：互操作有点混乱（二进制消息），但它是可行的。[这里](http://www.switchonthecode.com/tutorials/interprocess-communication-using-named-pipes-in-csharp)有一些 C# 管道的示例代码（来自双方）。

为特定服务使用管道来服务通信问题的好处是，如果需要，您可以稍后扩展设计以支持 UI。

# c# - C# 中的套接字：如何获取响应流？

> ID：523930
> 
> 赞同：11
> 
> 时间：2009-02-07T15:16:21.957
> 
> 标签：c#, sockets, httpwebrequest, httpwebresponse

我正在尝试替换它：

```
void ProcessRequest(object listenerContext)
{
    var context = (HttpListenerContext)listenerContext;
    Uri URL = new Uri(context.Request.RawUrl);
    HttpWebRequest.DefaultWebProxy = null;
    HttpWebRequest httpWebRequest = (HttpWebRequest)WebRequest.Create(URL);
    httpWebRequest.Method = context.Request.HttpMethod;
    httpWebRequest.Headers.Clear();
    if (context.Request.UserAgent != null) httpWebRequest.UserAgent = context.Request.UserAgent;
    foreach (string headerKey in context.Request.Headers.AllKeys)
    {
        try { httpWebRequest.Headers.Set(headerKey, context.Request.Headers[headerKey]); }
            catch (Exception) { }
    }

    using (HttpWebResponse httpWebResponse = (HttpWebResponse)httpWebRequest.GetResponse())
    {
        Stream responseStream = httpWebResponse.GetResponseStream();
        if (httpWebResponse.ContentEncoding.ToLower().Contains("gzip"))
            responseStream = new GZipStream(responseStream, CompressionMode.Decompress);
        else if (httpWebResponse.ContentEncoding.ToLower().Contains("deflate"))
                responseStream = new DeflateStream(responseStream, CompressionMode.Decompress);

        MemoryStream memStream = new MemoryStream();

        byte[] respBuffer = new byte[4096];
        try
        {
            int bytesRead = responseStream.Read(respBuffer, 0, respBuffer.Length);
            while (bytesRead > 0)
            {
                memStream.Write(respBuffer, 0, bytesRead);
                bytesRead = responseStream.Read(respBuffer, 0, respBuffer.Length);
            }
        }
        finally
        {
            responseStream.Close();
        }

        byte[] msg = memStream.ToArray();

        context.Response.ContentLength64 = msg.Length;
        using (Stream strOut = context.Response.OutputStream)
        {
            strOut.Write(msg, 0, msg.Length);
        }
    }
    catch (Exception ex)
    {
        // Some error handling
    }
} 
```

带插座。这是我到目前为止所拥有的：

```
void ProcessRequest(object listenerContext)
{
    HttpListenerContext context = (HttpListenerContext)listenerContext;
    Uri URL = new Uri(context.Request.RawUrl);
    string getString = string.Format("GET {0} HTTP/1.1\r\nHost: {1}\r\nAccept-Encoding: gzip\r\n\r\n",
                context.Request.Url.PathAndQuery,
                context.Request.UserHostName);

    Socket socket = null;

    string[] hostAndPort;
    if (context.Request.UserHostName.Contains(":"))
    {
        hostAndPort = context.Request.UserHostName.Split(':');
    }
    else
    {
        hostAndPort = new string[] { context.Request.UserHostName, "80" };
    }

    IPHostEntry ipAddress = Dns.GetHostEntry(hostAndPort[0]);
    IPEndPoint ip = new IPEndPoint(IPAddress.Parse(ipAddress.AddressList[0].ToString()), int.Parse(hostAndPort[1]));
    socket = new Socket(ip.AddressFamily, SocketType.Stream, ProtocolType.Tcp);
    socket.Connect(ip); 
```

**开始新代码**

```
Encoding ASCII = Encoding.ASCII;
Byte[] byteGetString = ASCII.GetBytes(getString);
Byte[] receiveByte = new Byte[256];
string response = string.Empty;
socket.Send(byteGetString, byteGetString.Length, 0);
Int32 bytes = socket.Receive(receiveByte, receiveByte.Length, 0);
response += ASCII.GetString(receiveByte, 0, bytes);
while (bytes > 0)
{
bytes = socket.Receive(receiveByte, receiveByte.Length, 0);
strPage = strPage + ASCII.GetString(receiveByte, 0, bytes);
}
socket.Close();

string separator = "\r\n\r\n";
string header = strPage.Substring(0,strPage.IndexOf(separator));
string content = strPage.Remove(0, strPage.IndexOf(separator) + 4);

byte[] byteResponse = ASCII.GetBytes(content);
context.Response.ContentLength64 = byteResponse .Length;
context.Response.OutputStream.Write(byteResponse , 0, byteResponse .Length);
context.Response.OutputStream.Close(); 
```

**结束新代码**

连接到套接字后，我不知道如何让 Stream 响应解压，并发送回**context.Response.OutputStream**

任何帮助将不胜感激。谢谢。干杯。

**编辑 2：** 现在这个编辑似乎工作正常（至少与 HttpWebRequest 相同）。你发现这里有什么错误吗？

**编辑 3：** 误报...仍然无法正常工作

**编辑 4：** 我需要在 Scott 的代码中添加以下几行......因为并非总是第一个字节 reponseStream 是 gzip 幻数。顺序似乎是：0x0a（10），0x1f（31），0x8b（139）。最后两个是 gzip 幻数。在我的测试中，第一个数字总是在前面。

```
if (contentEncoding.Equals("gzip"))
{
    int magicNumber = 0;
    while (magicNumber != 10)
        magicNumber = responseStream.ReadByte();
    responseStream = new GZipStream(responseStream, CompressionMode.Decompress);
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-08T23:13:35.210

这是一些对我有用的代码。

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.IO.Compression;

namespace HttpUsingSockets {
    public class Program {
        private static readonly Encoding DefaultEncoding = Encoding.ASCII;
        private static readonly byte[] LineTerminator = new byte[] { 13, 10 };

        public static void Main(string[] args) {
            var host = "stackoverflow.com";
            var url = "/questions/523930/sockets-in-c-how-to-get-the-response-stream";

            IPHostEntry ipAddress = Dns.GetHostEntry(host);
            var ip = new IPEndPoint(ipAddress.AddressList[0], 80);
            using (var socket = new Socket(ip.AddressFamily, SocketType.Stream, ProtocolType.Tcp)) {
                socket.Connect(ip);
                using (var n = new NetworkStream(socket)) {
                    SendRequest(n, new[] {"GET " + url + " HTTP/1.1", "Host: " + host, "Connection: Close", "Accept-Encoding: gzip"});

                    var headers = new Dictionary<string, string>();
                    while (true) {
                        var line = ReadLine(n);
                        if (line.Length == 0) {
                            break;
                        }
                        int index = line.IndexOf(':');
                        headers.Add(line.Substring(0, index), line.Substring(index + 2));
                    }

                    string contentEncoding;
                    if (headers.TryGetValue("Content-Encoding", out contentEncoding)) {
                        Stream responseStream = n;
                        if (contentEncoding.Equals("gzip")) {
                            responseStream = new GZipStream(responseStream, CompressionMode.Decompress);
                        }
                        else if (contentEncoding.Equals("deflate")) {
                            responseStream = new DeflateStream(responseStream, CompressionMode.Decompress);
                        }

                        var memStream = new MemoryStream();

                        var respBuffer = new byte[4096];
                        try {
                            int bytesRead = responseStream.Read(respBuffer, 0, respBuffer.Length);
                            while (bytesRead > 0) {
                                memStream.Write(respBuffer, 0, bytesRead);
                                bytesRead = responseStream.Read(respBuffer, 0, respBuffer.Length);
                            }
                        }
                        finally {
                            responseStream.Close();
                        }

                        var body = DefaultEncoding.GetString(memStream.ToArray());
                        Console.WriteLine(body);
                    }
                    else {
                        while (true) {
                            var line = ReadLine(n);
                            if (line == null) {
                                break;
                            }
                            Console.WriteLine(line);
                        }
                    }
                }
            }
        }

        static void SendRequest(Stream stream, IEnumerable<string> request) {
            foreach (var r in request) {
                var data = DefaultEncoding.GetBytes(r);
                stream.Write(data, 0, data.Length);
                stream.Write(LineTerminator, 0, 2);
            }
            stream.Write(LineTerminator, 0, 2);
            // Eat response
            var response = ReadLine(stream);
        }

        static string ReadLine(Stream stream) {
            var lineBuffer = new List<byte>();
            while (true) {
                int b = stream.ReadByte();
                if (b == -1) {
                    return null;
                }
                if (b == 10) {
                    break;
                }
                if (b != 13) {
                    lineBuffer.Add((byte)b);
                }
            }
            return DefaultEncoding.GetString(lineBuffer.ToArray());
        }
    }
} 
```

您可以用它代替 Socket/NetworkStream 并节省一些工作。

```
using (var client = new TcpClient(host, 80)) {
      using (var n = client.GetStream()) {
     }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-07T15:46:56.420

Socket，顾名思义，是访问网络的底层。您甚至可以将数据报协议与套接字一起使用。在这种情况下，流根本没有意义。

虽然我不确定您为什么要做 HttpWebRequest 轻松完成的工作，但要将数据读/写到套接字，您可以使用 Send/Receive 方法。如果你想像访问 TCP 套接字一样有流，你应该使用 TcpClient/TcpListener 类来包装套接字并为其提供网络流。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-07T18:05:37.107

还有以 Socket 作为参数的 NetworkStream 类。;)

# database - 我应该在应用程序级别之间传递 UserID 吗？

> ID：523937
> 
> 赞同：0
> 
> 时间：2009-02-07T15:21:45.270
> 
> 标签：database, asp.net-membership

当 userID 不是正在传递的对象中的字段时向数据层提交数据，但在提交数据时仍需要使用 userID 交叉引用表，我应该调用成员资格类来获取数据层的 UserID，还是应该将 UserID 作为参数从一个级别传递到另一个级别？（即从业务层到数据层？）（或者不管哪种方式都无所谓？）

控制器或业务层：

```
 MembershipUser user = Membership.GetUser();
 Guid userID = (Guid)user.ProviderUserKey;
 DL.SaveObject (Object, userID); 
```

或者

在 DataLayer 中执行此操作：

```
SaveObject(Object)
{ 

 MembershipUser user = Membership.GetUser();
                Guid userID = (Guid)user.ProviderUserKey;
 ...
 ...

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T15:55:39.100

Whilst this is indeed a cross-cutting concern, my personal preference is that code such as:

```
MembershipUser user = Membership.GetUser();
Guid userID = (Guid)user.ProviderUserKey; 
```

should NOT be in the data layer.

I like to see this kind of code in a layer higher than the data layer, usually the business layer, simply because I want my data layer to be entirely agnostic as where the data it will read/write/process has come from. I want my data gathering to be done primarily in the UI layer (in the case of user supplied data/input) and perhaps a little more data gathering within the business layer (such as gathering a UserID or retrieving a user's roles/authorisation).

Putting code such as this in the business layer can potentially lead to duplication of this code across many different domain objects, however, this can be alleviated by abstracting this code away into it's own object, and using object composition to allow other domain objects to access it.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T16:08:34.427

Passing input to the DataAccessLayer should be done by the controller or BL. I prefer not to include anything other than Data read / write in DAL. (in this case, DAL is given the task of determining the currently logged in user)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T15:30:22.803

In general I'd prefer to see GetUser() in SaveObject(), since that would allow the business layer to be abstracted away from it and should reduce the amount of code that is calling GetUser(). But it depends on the requirements. If you needed to apply business rules based on who the user is, then (also) putting it in the business layer might make more sense.

Authorization/authentication is one of those cross-cutting concerns that AOP (aspect oriented programming) is best suited to handle.

**Update:** CraigTP makes a valid point wrt having the data layer be agnostic about where its data comes from. In general I would agree. In this scenario there is a requirement where user identity is needed by the data persistence mechanism, probably for security and/or auditing purposes. So in this case I'd prefer to put the user identity access call under the control of the layer that needs it. I'd abstract away the details of the GetUser() implementation behind another call, so the data layer doesn't have a dependency on System.Web.Security.

# project - 当您使用的库不再维护时，您会怎么做？

> ID：523939
> 
> 赞同：5
> 
> 时间：2009-02-07T15:22:45.127
> 
> 标签：project

我一直觉得令人沮丧的一件事是当我使用的库不再维护时。即使事先查看更新历史和社区，我也遇到过这样的情况，我稍后再查看时发现我正在使用的版本是最后一个版本。

通常，直到几个月过去，或者发现了一些错误/限制，才会注意到这一点。我在用 Python 编码时经常遇到这种情况，因为我想要升级到新版本的解释器很容易在以前运行良好的库中引入问题。我的问题是：对这种情况最好的反应是什么？

*   你成为老图书馆的维护者了吗？即使您只是修复您关心的错误，这仍然是很多工作。尤其是如果库很大、很复杂，并且代码记录不充分（这种情况经常发生）。

*   您是否切换到不同的库（如果有）？这也是一项重要的工作，有可能引入新的错误，特别是如果唯一的替代方案从不同的角度解决问题。即使您有远见为旧库的功能编写抽象层也是如此。

*   你自己滚吗？它最终的代码可能比旧库少，因为您只编写您关心的部分。因此，将来更容易维护。但是现在您已经浪费了几天/几周/几个月的时间来生产可能功能较少的东西，并且肯定会引入大量新错误。

我意识到答案取决于具体情况：库的大小、源是否可用、它的可维护性、您的代码使用了多少、您的代码对它的依赖程度等等。我正在寻找答案在一系列案例中。你对这个问题有什么经验？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-07T15:36:10.607

好吧，您已经找到了一个减少外部依赖项数量的论据……

我在审计过的几个 Java 项目中遇到过这种情况；似乎人们倾向于将在 Web 上某个地方找到的 Jar 放入其中，以便尽可能少地重用它。结果是一堆依赖关系，最终破坏了代码库。我更喜欢谨慎使用外部组件。

询问您*之前*可以做什么可能最有用。在开始使用外部组件之前，请务必评估它的未来寿命。研究一下它的开发者社区和用户社区有多大。此外，更喜欢使用具有一个或两个您也可以使用的“较小”替代品的组件。

如果您很想使用某些东西，但只有一两个人在使用它，并且在他们自己的项目之外没有太多使用，那么您可能应该自己动手 - 或者与组件的维护者合作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T15:46:01.867

我认为您真正的答案是如何选择第三方库以包含在您的代码中。

如果您碰巧喜欢不断将代码升级到该语言的最新版本，那么默认情况下，您只能使用背后有活跃社区的库

事实上，我想说的是，你想要使用第三方开源库的唯一时间是它背后的社区很大（比如至少有 40 多个用户）并且它已经发布了几个版本。

对于商业图书馆，同样的事情也适用于公司将存在多长时间以及有多少其他客户使用它。

如果您在这个位置找不到库，请确保从代码中抽象出第三方库，以便将来替换不难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T15:27:20.517

当我的雇主选择的 Java EE 框架破产时，我们找到了一个更新、更好的框架。幸运的是 Spring 可用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T15:34:28.893

如果源可用，许可证是开放的，并且库做得很好，你可以选择分叉库。通过这样做，您还可以为其添加新功能。如果库有很多东西要修复并且代码是一团糟，那么最好找到其他可以使用的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T15:47:54.017

出于这个原因，我们更喜欢自己动手。我们最终可以完全控制它，完全了解它是如何工作的，并且我们可以以任何我们想要的方式改变它。当我们的屁股在玩指责游戏时，我们更愿意降低风险并自己做。

我们曾经遇到过使用外部库的情况，它被作者重写和重新利用，不再符合我们的预期。我们推翻了这一点，编写了我们自己的版本，然后安全地继续。

底线是安全和风险最小化。

# winapi - 检测 CControlBar 的停靠状态何时发生变化

> ID：523942
> 
> 赞同：1
> 
> 时间：2009-02-07T15:23:34.500
> 
> 标签：winapi, mfc, docking

我正在使用 CControlBar 派生类，我想检测 CControlBar 的停靠状态何时发生变化（即，从垂直停靠到水平或进入浮动模式）。

当然，我可以处理 WM_SIZE ，但每次触发 WM_SIZE 消息而不是仅在停靠状态发生变化时执行任务似乎是浪费资源。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T16:46:09.937

您可以覆盖`CControlBar::OnBarStyleChange`虚拟功能以检测控制栏样式的更改（`CBRS_XXX`值 - 查看`<afxres.h>`头文件以获取详细信息）。

要确定控制栏是否浮动/停靠，请检查`CBRS_FLOATING`样式。要检查水平/垂直方向，请使用`CBRS_ORIENT_HORZ`和`CBRS_ORIENT_VERT`样式。

因此，使用`CToolBar`（派生自`CControlBar`）作为示例：

```
class CMyToolBar : public CToolBar {
public:
    virtual void OnBarStyleChange(DWORD dwOldStyle, DWORD dwNewStyle);
};

void CMyToolBar::OnBarStyleChange(DWORD dwOldStyle, DWORD dwNewStyle)
{
    // Call base class implementation.
    CToolBar::OnBarStyleChange(dwOldStyle, dwNewStyle);

    // Use exclusive-or to detect changes in style bits.
    DWORD changed = dwOldStyle ^ dwNewStyle;

    if (changed & CBRS_FLOATING) {
        if (dwNewStyle & CBRS_FLOATING) {
            // ToolBar now floating
        }
        else {
            // ToolBar now docked
        }
    }

    if (changed & CBRS_ORIENT_ANY) {
        if (dwNewStyle & CBRS_ORIENT_HORZ) {
            // ToolBar now horizontal
        }
        else if (dwNewStyle & CBRS_ORIENT_VERT) {
            // ToolBar now vertical            
        }
    }
} 
```

我希望这有帮助！

# mysql - 在 MySQL 中存储二进制数组

> ID：523949
> 
> 赞同：4
> 
> 时间：2009-02-07T15:28:32.277
> 
> 标签：mysql

我有一个名为 A、B...X、Y、Z 的值数组。虽然表格中有 26 列很有趣，但我不禁觉得有更好的方法。我考虑过创建第二个表，其中第一个表中的行的 id 值、数组中项目的 id 和布尔值，但它看起来笨重且令人困惑。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T16:27:44.513

简短的回答，不。长答案，这取决于。

您可以通过多种方式存储二进制数据 - 滥用数字、使用 BINARY 或 VARBINARY、使用 BLOB 或 TINYBLOB 等。 BINARY 类型通常比 BLOB 类型快，前提是您的数据大小已知。

但是，关系数据库并非设计用于对二进制数据进行智能处理。在我曾经从事的一个项目中，有一个表，其中每条记录都有特定的二进制模式——存储为某种整数——并且搜索需要大量的 AND、OR、XOR 和 NOT。它从来没有真正运作得很好，性能很差，而且它拖累了整个项目。回想起来，我会采取完全不同的方法。

因此，如果您只想将数据放入并再次将其取出，那就太好了。如果您想将它用于任何智能、艰难的事情。

其他数据库供应商的情况可能有所不同。事实上，您是否考虑过使用其他东西来代替数据库？某种对象持久性？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T17:06:03.187

您可能的数组值是静态的吗？

如果是这样，请尝试使用 MySQL 的 SET 数据类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T15:32:03.720

您可以尝试将其存储为 TINYBLOB，甚至是 UNSIGNED INT，但您必须在代码中进行位掩码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T15:38:32.083

您可以将其存储为字符串并使用文本操作函数来（重新）创建您的数组。

# tree - 关于树和前缀（波兰语）表示法？

> ID：523957
> 
> 赞同：4
> 
> 时间：2009-02-07T15:31:35.407
> 
> 标签：tree, mips, traversal, prefix, notation

我的 MIPS 汇编课程要求我将未知大小的表达式读入解析树。我从来不用处理树，所以这就是我存储值的方式：

假设用户输入了表达式 1 + 3 - 4（每个操作数只能是数字 1-9）

我最左边的子节点将是起点并包含 2 条数据

```
1\. The operand
2\. Pointer to the next node (operator) 
```

这就是我构建树的方式。我会从操作数指向运算符，再指向下一个操作数，再指向下一个运算符，直到没有更多值要读入。

我的下一个任务是递归地遍历树并以中缀/前缀/后缀表示法输出值。

考虑到我是如何构建树的，中缀遍历没有问题。

我被困在前缀上。首先，我并不完全理解它。

当我在前缀中输出我们的表达式 (1 + 3 - 4) 时，它应该出现 - + 1 3 4 吗？我无法按照在线示例进行操作。

您还认为我的树构造正确吗？我的意思是，我无法从当前节点转到前一个节点，这意味着我总是必须从最左边的子节点开始遍历，尽管我的 TA 说这是要走的路，但本能地听起来并不正确。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T15:51:54.227

您的解析树应如下所示：

```
        '-'
         |
     +---+---+
     | |
    '+' '4'
     |
 +---+---+
 | |
'1' '3'

```

每个节点有两个指针。一个给它的左孩子，一个给它的右孩子。当使用递归遍历时，不需要指向父节点的指针。

这是一些伪代码：

**中缀符号**的遍历：

```
void traverse(Node *node) {
    if (node->leftChild != 0) {
        traverse(node->leftChild);
    }

    print(node->value);

    if (node->rightChild != 0) {
        traverse(node->rightChild);
    }
} 
```

**前缀符号**的遍历：

```
void traverse(Node *node) {
    print(node->value);

    if (node->leftChild != 0) {
        traverse(node->leftChild);
    }

    if (node->rightChild != 0) {
        traverse(node->rightChild);
    }
} 
```

**后缀符号**的遍历：

```
void traverse(Node *node) {
    if (node->leftChild != 0) {
        traverse(node->leftChild);
    }

    if (node->rightChild != 0) {
        traverse(node->rightChild);
    }

    print(node->value);
} 
```

You would call the `traverse` method with the root node of your tree.

Your `Node` data structure would need three members:

```
struct Node {
    char value;
    Node *leftChild;
    Node *rightChild;
} 
```

The leaves of the tree would contain null pointers for `leftChild` and `rightChild`.

Sometimes it helps to write this stuff in a higher level language (whatever you feel comfortable with) to understand the problem and then "translate" this code to assembler. I remember programming a [blocks world](http://en.wikipedia.org/wiki/Blocks_world) simulation in MIPS assembler like this.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T15:43:34.117

一般来说，您应该以这样一种方式构造一棵树，即所有叶节点（没有子节点的节点）都是操作数，而内部节点（其他所有节点）都是运算符。这应该使得操作符节点的子节点是它的操作数，或者本身就是具有操作数的操作符。如果你可以用这种方式构造一棵树，那么形成各种符号（前缀、后缀、中缀）就相当简单——你只需遵循树的前序、后序和中序遍历，这有众所周知的算法。

据我所知，您不是在构建树，而是在构建链表，这对您没有好处。你有 2 个不同的实体——操作数和运算符——你必须区别对待它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T15:51:13.383

我同意sykora所说的。我想补充一点，在这种情况下您也可以使用堆栈。如果您的任务要求您专门使用一棵树，那么 sykora 的建议效果最好。但是，堆栈可能更容易为简单的表达式求值编程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T15:59:35.973

This is an instance of the general problem of compiling, which is a solved problem. If you do a google on compiling techniques, you will find out all kinds of information relating to your problem.

Your library should have a copy of *Compilers: Principles, Techniques, and Tools* by Aho, Sethi, and Ullman. If it doesn't have it, request it for purchase(it's the Standard Work in the field). The first part of it should help you.

[Third edition link](https://rads.stackoverflow.com/amzn/click/com/0321486811)

# c# - ASP.NET：您最常用的 httpmodules

> ID：523990
> 
> 赞同：13
> 
> 时间：2009-02-07T15:47:09.853
> 
> 标签：c#, asp.net, .net, windows, httpmodule

对您最常用的 ASP.NET httpmodules 的描述感兴趣，这些 httpmodules 解决了您的 webapp 的特定问题。
欢迎使用最佳实践和现场使用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-07T15:56:51.347

[ELMAH](http://msdn.microsoft.com/en-us/library/aa479332.aspx)对于 ASP.NET 应用程序中的异常日志记录非常流行和有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-07T15:57:56.897

使用了一个模块来检查给定用户的授权。因此，当请求任何资源时，它会检查用户是否有权访问它，如果没有，它会将用户带到友好的页面。

ACL 可以在 Authz DB 或 xml 文件中，并使用角色进行区分。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-07T16:32:18.887

[MBCompression](http://www.codeplex.com/MbCompression)：用于压缩 Css 文件、JavaScript 文件、页面和 WebResource.axd 的处理程序和模块。

我在无法完全控制服务器且无法进行本地 IIS 压缩的环境中使用它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-07T19:05:09.717

当您无权访问服务器的操作系统时[运行后台服务（在共享主机环境中就是这种情况）。](http://blogs.telerik.com/kevinbabcock/posts/08-07-24/Using_an_HttpModule_to_Run_a_Background_Service.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-07T20:02:58.087

我有一个 SSL 模块，它检查被请求的页面是否需要通过 SSL 访问，并相应地重定向。必须通过 SSL 连接访问的页面或文件夹列表存储在 XML 文件中。当通过 SSL 请求不需要的页面时，模块会将它们重定向到非 SSL 版本，反之亦然。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-07T16:10:00.040

一个 HttpModule，它通过将人类可读的 URL 转换为程序在每个请求的幕后使用的 URL 来支持友好的 URL。它还驱动我的 CMS。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-07T16:17:19.323

对我来说，最常用的 http 模块是表单身份验证模块。

我们用它来保护我们使用的几乎每个网站。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-02-18T17:08:57.830

我使用了一套 http 模块和 http 处理程序：

[http://code.google.com/p/talifun-web/](http://code.google.com/p/talifun-web/)

**静态文件处理程序**

一个 http 处理程序，它将以缓存、压缩和可恢复的方式提供静态文件。

它生成一致的 etag 和正确的元标记，用于在代理和本地缓存。当您无法控制网络服务器的配置时，这尤其有用。

它还可以绕过硬盘驱动器从内存中提供缓存请求和压缩缓存请求。

它支持以下 http 标头标签：

*   接受范围
*   电子标签
*   过期
*   最后修改
*   范围
*   如果范围
*   如果匹配
*   如果无匹配
*   If-Modified-Since
*   If-Unmodified-Since
*   除非-修改-自

**破碎机模块**

将 js 压缩成单个文件，并将 css 压缩成单个文件的模块。

它还监视任何被监视的 css 或 js 文件的更改并重新生成粉碎的文件。它为粉碎的文件生成一个唯一的哈希，并将其附加到 css url 和 js url。因此，无论缓存如何，您都可以确保获得正确的内容。

**CssSpriteModule**

将组件图像组合成单个精灵图像文件并生成将精灵图像切割成其组件图像所需的css精灵文件的模块。

**RegexUrlAuthorizationModule**

基于匹配正则表达式的 url 提供授权的模块。

**日志网址模块**

一个非常简单的模块，可以轻松挂钩匹配正则表达式的 Web 请求。

**页面压缩模块**

为 webforms 和 mvc 压缩动态页面的模块。

# ruby - 你如何降级红宝石？

> ID：523993
> 
> 赞同：100
> 
> 时间：2009-02-07T15:47:53.080
> 
> 标签：ruby, rubygems

我安装了 ruby​​gems 1.3.1，但我想回到 1.2.0。降级 ruby​​gems 的命令是什么？

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2011-02-14T13:55:11.917

由于旧的 rails 版本，从 1.5.2 降级到 1.4.2 这对我有用：

```
sudo gem update --system 1.4.2 
```

有关降级/升级 ruby​​gems 的更多信息：[https ://github.com/rubygems/rubygems/blob/master/UPGRADING.md](https://github.com/rubygems/rubygems/blob/master/UPGRADING.md)

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-02-07T21:33:39.527

2011 年 11 月更新：现在 RVM 出来了，尝试运行`rvm install rubygems <version>`.

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2011-03-09T05:14:01.353

如果您使用的是 RVM，那么您可以这样做以删除当前的 ruby​​ gem，然后升级/降级 ruby​​gems：

```
rvm install rubygems 1.4.2 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2011-02-01T03:33:43.263

这对我在 OSX 上从 1.5.0 回到 1.4.2 有效

```
sudo gem uninstall -v '1.5.0' rubygems-update
sudo gem update --system --local 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-14T03:44:35.383

我在旧的 Rails 3 堆栈中遇到了类似的问题。当这些类型的问题发生时，我的建议是进入应用程序当前正在运行的生产服务器并检查它正在使用哪个 ruby​​gems 版本：

```
gem -v 
```

对我来说，它使用的是 1.8.24。所以我需要做的就是降级我当前的 ruby​​gems，它是在我为这个应用程序安装旧的 ruby​​ 时从“rvm install 1.9.3”生成的。我运行了以下命令：

```
 $ rvm install rubygems 1.8.24 --force 
```

它奏效了。注意我运行的是 Ubuntu 14.04，我使用的服务器也是 Ubuntu。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-09-16T16:28:55.833

我使用此命令返回到我的 ruby​​ 版本所需的 gem 版本：

```
rvm rubygems current 
```

如果它给出校验和错误，请尝试

```
rvm rubygems current --verify-downloads 1 
```

这对我有用。*********