# StackOverflow 问答 000766000-000766999

# c - 在C中生成[0，n）范围内的随机数？

> ID：766005
> 
> 赞同：0
> 
> 时间：2009-04-19T20:13:01.980
> 
> 标签：c, random, numbers

希望在 C 中创建一个非常简单的随机数生成器方法。数字应该在 0 到 24 之间，例如可以是 14.5f。

任何帮助都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-19T20:17:39.673

```
float getRand() {
  float rnd = rand();
  rnd /= RAND_MAX;
  return rnd * 24.0f;
} 
```

确保`srand`在使用前为随机数生成器播种。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-19T20:24:53.730

Mersenne_twister[不仅](http://en.wikipedia.org/wiki/Mersenne_twister)非常简单，而且非常强大。

请参阅链接上的代码。

但是，如果您可以使用[GPL License](http://en.wikipedia.org/wiki/GNU_General_Public_License)，请使用[The GNU Scientific Library (GSL)](http://www.gnu.org/software/gsl/) specific check [Random-Number-Generator-Examples](http://www.gnu.org/software/gsl/manual/html_node/Random-Number-Generator-Examples.html) from [Random-Number-Generation part of the manual](http://www.gnu.org/software/gsl/manual/html_node/Random-Number-Generation.html)

那里有很多东西，从简单的均匀随机数到其他分布。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-19T20:16:30.783

看看[线性同余生成器](http://en.wikipedia.org/wiki/Linear_congruential_generator)，即使我的数学知识较差，它们也很容易实现。

*看起来我误解了最初的问题，我以为你想推出自己的发电机（用于家庭作业、娱乐等）*

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-19T20:19:36.363

您可以使用 C 的内置随机数生成器来获取 0 到 30,000 之间的整数，如下所示：

```
`srand(时间(NULL));
    诠释 x = 兰德（）；`
```

您只需要进行一些除法即可获得十进制数而不是整数。

# internet-explorer - Internet Explorer 8 能否解决许多浏览器不兼容问题？

> ID：766010
> 
> 赞同：4
> 
> 时间：2009-04-19T20:16:22.563
> 
> 标签：internet-explorer, internet-explorer-8, coding-style

IE 6 和 7 没有遵循许多 w3 标准，例如事件处理，因此有必要为符合标准的浏览器编写代码，然后为 Internet Explorer 编写更多代码。IE 8 会带我们走出这个黑暗时代并稳定 Web 开发吗？编写一组所有浏览器都以相同（ish）方式显示的代码会更容易吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T20:20:58.560

IE 的每一个新版本都让我们离我们更近一点，但更多的是放弃旧浏览器而不是发布新浏览器。IE35 可能是可用的，但如果 IE6 仍有 20% 的市场份额，我们实际上并没有取得进展。像[这样](http://ie6update.com/)有助于教育和升级的活动将最终解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T20:22:30.817

IE8 修复了很多东西——但仍然达不到标准。

*   没有[W3C 事件侦听器/处理程序](http://www.w3.org/TR/DOM-Level-2-Events/events.html)
*   [选择列表](http://webbugtrack.blogspot.com/search/label/Select%20List)/[表格](http://webbugtrack.blogspot.com/search/label/Table)元素仍然存在错误的样式/操作

然而，随着[jQuery](http://jquery.com/)等库的流行，许多 IE 错误都可以解决。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T20:54:58.523

新的浏览器并不能解决兼容性问题，它们只会让问题变得更糟。现在有一种新的浏览器，在某些情况下，它的处理方式与其他浏览器不同。为了解决兼容性问题，旧的浏览器版本需要淘汰，不再需要支持。但这需要很长很长的时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T20:26:59.823

当然，Internet Explorer 8 向标准合规性迈出了重要的一步。然而，我怀疑它本身能否稳定 Web 开发。HTML 和相关的“标准”是固有的不稳定过程的一部分。

一方面，我们有浏览器供应商希望将他们的产品与其他产品区分开来，另一方面，我们有标准委员会，他们需要很长时间才能建立标准，因此在任何此类标准被批准时，他们已经落后于当前的功能需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-19T20:22:13.937

只要浏览器在优越的特性和功能上竞争，它们之间就会存在差异。并且总是存在不同版本的问题——旧版本的浏览器、旧版本的 HTML（版本 5 即将推出）。

解决您的困境的一种方法是使用为您处理此问题的 Web 开发工具。例如，Microsoft 的 ASP.Net 会自动为您处理浏览器兼容性，因此您不必为它编写任何代码，包括 Ajax 功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-19T20:54:46.903

虽然 IE8 在 CSS2 和 CSS2.1 兼容性方面向前迈出了一大步，但请注意它仍然在[ACID3 测试](http://acid3.acidtests.org/)中惨遭失败，所以如果在一方面它会比它的前辈（尤其是 IE6）好得多，它仍然会困扰我们（太）太多了……

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-19T21:08:47.600

IE8 将改善这种情况，使其市场份额从 IE6 手中夺走。IE7 还不错。

There are some folks that don't mind being one version behind but also don't want to be two versions behind. Maybe some of these folks will move to IE7 or leapfrog over it to IE8.

# cookies - 保存时间最长的饼干

> ID：766031
> 
> 赞同：2
> 
> 时间：2009-04-19T20:25:36.877
> 
> 标签：cookies, login

我想让用户尽可能长时间地登录。我应该使用什么？

*   普通饼干
*   持久性cookie
*   闪光饼干
*   IP地址
*   会议

或这些的某种组合？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T20:33:46.797

我认为 Flash cookie 可能会停留最长时间，原因很简单，大多数人不会经常清除它们。它们不会出现在通常的浏览器对话框中，也不会被通常的“清除 cookie”功能清除。

如果您试图让人们保持登录状态，那么尝试将用户绑定到 IP 地址是没有用的，而且完全不安全。IP 地址经常变化，您不应该依赖它来处理任何严重的事情。

我想最好的办法是同时使用普通浏览器 cookie*和*Flash cookie。这样，您就可以捕获所有没有 Flash 的用户（或默认阻止 Flash 的用户）以防万一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T20:35:05.733

不清楚“尽可能长”是什么意思。永远，即使用户在他们的 PC 上循环电源？或者只要浏览器进程正在运行（假设浏览器在这里）？

对于后者，只需使用易失性（会话）cookie。

对于前者，请使用具有非常未来期限的持久性 cookie。

# c# - 使用远程管理员凭据将文件复制到远程计算机

> ID：766033
> 
> 赞同：12
> 
> 时间：2009-04-19T20:25:58.563
> 
> 标签：c#, .net, copy, remote-access

我正在使用 C#...

我需要能够将一组文件复制到大约 500 台不同的计算机上。我已经成功地能够使用 LogonUser() 方法来模拟具有复制文件所需权限的域帐户。文件的目标路径类似于：

**\\RemoteComputer\C$\SomeFolder**

我的问题是......有没有办法做到这一点而不必使用全能的域帐户（这些计算机将来可能不会加入域）？我有每台计算机的本地管理员帐户...是否有一种简单的方法可以使用本地管理员帐户而不是域帐户将文件复制到计算机？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-19T21:00:48.150

如果我错了，请纠正我，但您可以使用[LogonUser](http://msdn.microsoft.com/en-us/library/aa378184.aspx)来模拟本地组，而不仅仅是域帐户。

[来自网络：](http://social.msdn.microsoft.com/forums/en-US/vblanguage/thread/b9906632-5cad-4972-9103-3e864a71a0c2/)

```
Imports System 
Imports System.Runtime.InteropServices 
Imports System.Security.Principal 
Imports System.Security.Permissions 
Public Class Form1 
    <DllImport("advapi32.DLL", SetLastError:=True)> _ 
    Public Shared Function LogonUser(ByVal lpszUsername As String, ByVal lpszDomain As String, _ 
        ByVal lpszPassword As String, ByVal dwLogonType As Integer, ByVal dwLogonProvider As Integer, _ 
        ByRef phToken As IntPtr) As Integer 
    End Function 
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click 
        Dim admin_token As IntPtr 
        Dim wid_current As WindowsIdentity = WindowsIdentity.GetCurrent() 
        Dim wid_admin As WindowsIdentity = Nothing 
        Dim wic As WindowsImpersonationContext = Nothing 
        Try 
            MessageBox.Show("Copying file...") 
            If LogonUser("Local Admin name", "Local computer name", "pwd", 9, 0, admin_token) <> 0 Then 
                wid_admin = New WindowsIdentity(admin_token) 
                wic = wid_admin.Impersonate() 
                System.IO.File.Copy("C:\right.bmp", "\\157.60.113.28\testnew\right.bmp", True) 
                MessageBox.Show("Copy succeeded") 
            Else 
                MessageBox.Show("Copy Failed") 
            End If 
        Catch se As System.Exception 
            Dim ret As Integer = Marshal.GetLastWin32Error() 
            MessageBox.Show(ret.ToString(), "Error code: " + ret.ToString()) 
            MessageBox.Show(se.Message) 
        Finally 
            If wic IsNot Nothing Then 
                wic.Undo() 
            End If 
        End Try 
    End Sub 
End Class 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T20:36:42.607

[WNetAddConnection2](http://msdn.microsoft.com/en-us/library/aa385413(VS.85).aspx)可以解决问题。只需使用空字符串作为本地设备名称，以避免映射驱动器。完成后，您还需要确保并[关闭连接](http://msdn.microsoft.com/en-us/library/aa385427(VS.85).aspx)。我将它包装到实现 IDisposable 的 NetworkConnection 类中。

# nhibernate - 休眠,集合和复合

> ID：766046
> 
> 赞同：0
> 
> 时间：2009-04-19T20:33:12.227
> 
> 标签：nhibernate, collections, composite

我有下表：

```
Bucket(
 bucketId smallint (PK)
 name varchar(50)
)

BucketUser(
 UserId varchar(10) (PK) 
 bucketId smallint (PK)
) 
```

复合键不是问题，我知道如何解决这个问题，但我希望我的存储桶类包含 BucketUser 的 IList。我阅读了在线参考，并认为我已经破解了它，但还没有。两个映射如下

- 桶 -

```
<class name="Bucket,Impact.Dice.Core" table="Bucket">
  <id name="BucketId" column="BucketId" type="Int16" unsaved-value="0">
    <generator class="native"/>
  </id>

  <property column="BucketName" type="String" name="BucketName"/>

  <bag name="Users" table="BucketUser" inverse="true" generic="true" lazy="true">
    <key>
      <column name="BucketId" sql-type="smallint"/>
      <column name="UserId" sql-type="varchar"/>
    </key>
    <one-to-many class="Bucket,Impact.Dice.Core" not-found="ignore"/>
  </bag>
</class> 
```

-- 桶用户 --

```
<class name="BucketUser,Impact.Dice.Core" table="BucketUser">
  <composite-id>
    <key-many-to-one name="BucketUser" class="Bucket,Impact.Dice.Core" column="BucketId"/>
    <key-property name="UserId" column="UserId" type="string"></key-property>
  </composite-id>
</class> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T08:47:21.650

键是包含实体的外键，而不是主键。

你有两个选择：

*   该类表示一个独立的实体，具有自己的 id。它可以从其他类中引用，始终在同一个表中，并且可以独立加载。
*   或者它是另一个没有独立身份的实体的一部分。如果被其他类引用，它总是在一个单独的表中。它不能（轻松）独立于其父实体加载。

**Bucketuser 是一个独立的实体**。它有自己的映射定义，您可以使用一对多来引用它。在您的情况下，您会得到一个复合键，但我会避免这种情况。

```
<!-- reference to BucketUser. There is not table attribute needed. -->
<bag name="Users" inverse="true" generic="true" lazy="true">
  <key>
    <!-- foreign key -->
    <column name="BucketId" sql-type="smallint" />
  </key>
  <one-to-many class="Bucket,Impact.Dice.Core" not-found="ignore"/>
</bag>

<!-- BucketUser mapped as an independent entity -->
<class name="BucketUser" ... >
  <!-- here is the composite id, try to avoid this -->
  <composite-id>
    <key-property name="BucketId">
    <key-property name="UserId">
  </composite-id>
</bag> 
```

**Bucketuser 是 Bucket 的依赖部分。**Bucket的外键同时也是主键：

```
<!-- The table is defined on the fly by the table attribute -->
<bag name="Users" table="BucketUser" inverse="true" generic="true" lazy="true">
  <key>
    <column name="BucketId" sql-type="smallint" />
  </key>
  <!-- use composite-element to define the contents of the table -->
  <composite-element>
    <!-- define the contents of the BucketUser here -->
    <property name="UserId" sql-type="varchar"/>
  </composite-element>
</bag> 
```

这取决于您的情况，哪种策略是合适的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T23:09:26.110

你遇到了什么错误？如果您真的剪切并粘贴了该映射，那么解决方案可能就像替换逗号一样简单

```
<one-to-many class="Bucket,Impact.Dice.Core" not-found="ignore"/> 
```

有句号。

# .net - 将图像存储在数据库中还是系统文件中？

> ID：766048
> 
> 赞同：9
> 
> 时间：2009-04-19T20:34:21.693
> 
> 标签：.net, sql, database

**完全重复：** [用户图像：数据库或文件系统存储？](https://stackoverflow.com/questions/585224/user-images-database-vs-filesystem-storage)
**完全重复：** [在数据库中存储图像：是还是不是？](https://stackoverflow.com/questions/3748/storing-images-in-db-yea-or-nay)
**完全重复：** [我应该将图像存储在数据库还是文件夹中？](https://stackoverflow.com/questions/713243/should-i-store-my-images-in-the-database-or-folders/713292%5C)
**完全重复：** [您会将二进制数据存储在数据库还是文件夹中？](https://stackoverflow.com/questions/662488/would-you-store-binary-data-in-database-or-in-file-system)
**完全重复：** [将图片存储为文件或网络应用程序的数据库？](https://stackoverflow.com/questions/561447/store-pictures-as-files-or-in-the-database-for-a-web-app)
**完全重复：** [存储少量图像：blob 还是 fs？](https://stackoverflow.com/questions/325126/storing-a-small-number-of-images-blob-or-fs)

我必须存储用户的个人资料图片（100px * 100px）存储它的最佳方式是什么？数据库或系统文件？哪一个更好、更快、更安全……？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-19T20:44:18.767

SQL Server 2008 提供了[两全其美的优势](http://technet.microsoft.com/en-us/library/bb933993.aspx)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-19T20:40:00.307

**始终**将图像、音乐文件等存储在磁盘上的系统文件中，然后将它们的 url:s 存储在数据库中。那会让它

1) 更快

2) 更容易配置安全设置

3）在我能想象的任何方面都更好

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-19T20:42:10.193

我将提出第三种选择，即 Amazon S3 或 Mosso Cloud Files 之类的第三方场所。两者都提供了可用于上传文件的 API，并且都提供了 CDN 功能，因此文件加载速度比从服务器上或从数据库中提取的速度更快。

这是一个不错的选择，因为它是两全其美的选择。将图像存储在数据库中的缺点是它会给您的应用程序和数据库服务器（定位文件并拉取文件）带来额外的压力，并且还会导致数据库的大小增加，这可能意味着您将需要更早的硬件。

将它们存储在文件系统中的缺点是您现在遇到了缩放问题，就好像您想添加额外的 Web 服务器一样，它们每个都需要一个映像副本，或者您需要为这些映像创建一个专用服务器。此外，文件系统访问可能是未来需要担心的瓶颈。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-19T20:37:45.350

数据库使备份和恢复更容易，并且比文件系统存储小图像更有效。微软曾就此主题发表过一篇研究论文：[To BLOB or Not To BLOB](http://research.microsoft.com/pubs/64525/tr-2006-45.pdf)。

# user-experience - 您应该采取哪些步骤来保护您的创新外观和感觉？

> ID：766059
> 
> 赞同：-3
> 
> 时间：2009-04-19T20:40:05.643
> 
> 标签：user-experience

我一直在研究[stack](http://ra-ajax.org/stacked-an-open-source-implementation-of-stackoverflow-com.blog)，它似乎正在边缘化 Stackoverflow 本身的创建者所做的大量财务和智力投资。[我因为提出这个话题](https://stackoverflow.com/questions/722350/should-your-opensource-project-attempt-to-mimic-commercial-products-closed)而受到了很大的打击，但我认为这是程序员、设计师和投资者需要考虑的一个重要问题。我真的很想下载堆叠并推出，但我认为这是正确的做法。您应该采取哪些法律措施来保护您的产品免受开源盗版？我相信 Stackoverflow 的大部分内容都是创新的，并且对于具有编程艺术技能的人来说并不明显。您会寻求专利或其他保护您的投资的方法吗？你会采取什么措施来阻止这种做法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T21:54:34.170

> 您应该采取哪些法律措施来保护您的产品免受开源盗版？

如前所述，它并不特定于开源。如果 Stacked 的源代码不可用，则完全相同的注释将适用。

> 我相信 Stackoverflow 的大部分内容都是创新的，并且对于具有编程艺术技能的人来说并不明显。

我不同意，至少在“非显而易见”的部分。不想从乔尔和杰夫那里拿走任何东西，它与其他任何东西并没有完全不同。它比它的直接竞争对手（例如expertsexchange）要好，而且通常非常漂亮和做得很好，但是在其他地方也使用了相同的技术。

无论如何，对实际问题的简短回答：比他们更好。对于大多数公司来说，专利等根本不值一提——它们的注册成本很高，而且保护起来更贵，而且 AFAIK 有一个强有力的论点，即外观无论如何都不能申请专利。但是如果你的产品比你的竞争对手更好，人们就会使用它。

总会有人对你做类似的事情，这叫“竞争”，也不是坏事。因此，不要花时间试图为您的软件想出某种“保护”——相反，要花时间使该软件成为市场上最好的软件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T21:05:21.480

大型团队通常会申请专利——实际上 Mac OS X 中的每个 UI 都受到一些正在申请的专利的保护。由于获得专利的成本很高，而且在侵权的情况下强制执行它们需要更高的投资（法律费用可能*很大*），我建议您在尝试申请专利之前仔细评估您的情况......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T21:22:58.830

> 您应该采取哪些法律措施来保护您的产品免受开源盗版？

您应该采取同样的法律措施来防止*任何人*敲诈您。开源项目没有什么特别的东西可以让他们更容易违法；事实上，通过开放源代码，他们有效地使检测公然侵犯版权的过程变得容易且便宜（无论如何与为闭源项目获取源代码的过程相比）。

> 我相信 Stackoverflow 的大部分内容都是创新的，并且对于具有编程艺术技能的人来说并不明显。

我认为您是 Internet 新手... ;-P
说真的，环顾四周 - 从古老的[Everything2](http://everything2.com)和[C2 Wiki](http://c2.com/cgi/wiki)到[Wikipedia](http://www.wikipedia.org)和 Digg，SO 所站立的肩膀随处可见。SO 中的创新是其底层设计的目的，而不是设计本身。

顺便说一句... Stacked 看起来几乎不像 SO；我得假设你在谈论网站的机制，而不是外观......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T20:55:23.420

谷歌对他们的 CSS 和 javascript 文件所做的可能是一个好的开始。但是，我不太确定除了商标和版权保护之外，您还能做些什么。

顺便说一句，我认为专利是一个可怕的想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-19T21:21:13.453

保护您的创新外观和感觉的最佳方式是将所有内容作为 FOSS 发布。这样，如果您出于某种原因无法或不愿继续开发它，或者您不再是开发它的最佳人选，那么其他人可以接管而无需与您妥协以获得许可。它甚至不受你的保护，因为它不会因你未来的失败而受苦。

还是您的意思是利用您的创新外观和感觉赚钱的最佳方式是什么；-)

穿上防火裤。

[顺便说一句，如果你担心使用堆叠在你自己看来是不道德的，你可以给 Jeff Atwood 发邮件询问。如果他对此没有问题，那么无论一般情况下是否存在垄断创新界面设计的案例，这个特殊案例都得到了解决。]

# asp.net-mvc - 存在哪些 ASP.NET MVC 示例项目？

> ID：766066
> 
> 赞同：8
> 
> 时间：2009-04-19T20:44:24.697
> 
> 标签：asp.net-mvc

我知道的唯一示例 ASP.NET MVC 项目是来自[http://asp.net/mvc](http://asp.net/mvc)的以下项目。还有其他人吗？

*   [书呆子网](http://www.codeplex.com/nerddinner)
*   [临晚餐](http://prodinner.codeplex.com)
*   [Stephen Walther 的联络经理](http://www.asp.net/learn/mvc/tutorial-26-cs.aspx)
*   [Rob Conery 的 MVC 店面](http://blog.wekeroad.com/mvc-storefront/)
*   [代码营地服务器](http://code.google.com/p/codecampserver/)
*   [Suteki Shop电子商务应用程序](http://code.google.com/p/sutekishop/)
*   [斯蒂芬·瓦尔特的电影资料库](http://www.asp.net/learn/mvc-videos/video-395.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T20:54:29.010

Rob Conery's StoreFront application includes an excellent walk-through so you can build the project with him from scratch. I highly recommend it for learning MVC

[http://blog.wekeroad.com/mvc-storefront/](http://blog.wekeroad.com/mvc-storefront/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T20:46:14.957

[氧化物](http://oxite.codeplex.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T20:49:31.657

**[KiGG](http://www.codeplex.com/Kigg)**, a Digg clone, has been updated to ASP.NET MVC 1.0 RTM.

[alt text http://download.codeplex.com/Download?ProjectName=kigg&DownloadId=54867&Build=18207](http://download.codeplex.com/Download?ProjectName=kigg&DownloadId=54867&Build=18207)

Some features it includes:

**Microsoft Tooling:**

*   ASP.NET MVC
*   Linq To SQL
*   MS Patterns & Practices – Enterprise Library (Logging & Caching)
*   MS Patterns & Practices - Unity
*   jQuery

**Other Third party:**

*   xUnit.net
*   Moq
*   HtmlAgilityPack
*   DotNetOpenId
*   jQuery UI & Markitup

**External Service Integration:**

*   PageGlimpse, WebSnapr - For thumbnail generation.
*   Akismet, TypePad and Defensio. - Spam Protection.
*   reCaptcha
*   Gravatar
*   OpenID & Id Selector
*   Url shrinking services ([http://tinyurl.com](http://tinyurl.com) & [http://is.gd](http://is.gd))

**Open Standard implementation:**

*   hAtom, hReview, hVote, xFolk etc.
*   OpenSearch
*   SiteMap (Standard, Mobile, News)
*   RSS/Atom

There are several live websites using the MVC KiGG demo as the base for their website:

*   [DotNetShoutout.com](http://dotnetshoutout.com/)
*   [progg.ru](http://progg.ru/)
*   [dotnetomaniak](http://dotnetomaniak.pl/)
*   [PimpThisBlog](http://www.pimpthisblog.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T21:36:29.343

Microsoft also release a resource kit for developing web 2.0 apps called Kobe. It has a sample asp.net mvc app in it.

# delphi - 支持 RegEx 搜索的 Rich Edit Delphi 控件

> ID：766073
> 
> 赞同：2
> 
> 时间：2009-04-19T20:51:45.927
> 
> 标签：delphi

对于在 Delphi 中使用支持正则表达式搜索的 Rich Edit 控件有经验的任何人，我将不胜感激。

我玩弄了基于 RichEdit.dll V3 的控件，结果发现 MS 的 ITextSelection.FindText[实现](http://msdn.microsoft.com/en-us/library/bb787783(VS.85).aspx)使用了一些 MS Mickey Mouse 正则表达式的变体（即 ^p 表示段落）等等。

由于隐藏的 RTF 格式，针对 TRichEdit1.text 的正则表达式搜索返回不匹配的 SelStart 位置。

我想这排除了任何基于 RichEdit.dll 的控件/组件，除非有人可以提出解决方法？

我也看过[Dream Rich Editor](http://www.dreamcompany.com/richeditor.html)，但我担心它的维护时间更长（截至 2005 年）。否则，这看起来很理想，但找不到任何联系信息来询问支持哪种 ReGex 语法（即 PCRE？）

另一个选项是[ProfHTMLEdit](http://www.profgrid.com/dhtmledit.html)，但它阻塞了我测试它的 2MB HTML 文件。编辑对大文件也没有响应。耻辱，因为控制看起来很有希望。

另一个组件是[TRichView](http://www.trichview.com/resources/actions/)，但遗憾的是它似乎不支持使用正则表达式进行搜索。

简单地说，我的要求是一个允许简单编辑（即粗体、斜体、选择对齐）的 Delphi 7 控件，最重要的是，能够使用正则表达式进行搜索（最好是 PCRE.. 但不一定）。不太在意底层存储机制（rtf、html、xyz）是什么。

非常感谢任何帮助或指针/提示/提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T22:18:38.120

[此链接](http://www.regular-expressions.info/delphi.html)可能会有所帮助。我不能从那里提到的组件的经验中说出来，但作为一个多年的 HelpScribble 用户，我可以说 Jan Goyvaert 对他的产品的支持一直很出色。你可以尝试联系他——他可能知道一个有用的组件。我确实想到，如果您将文本从 RichEdit 控件复制到字符串变量（不带格式），您可能能够搜索该位置，然后将该位置映射回控件中的文本。只是一个想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T06:08:54.167

这很奇怪，但是 Delphi 的大多数正则表达式组件列表都没有提到我几乎一直使用的那个：

```
VBScript_RegExp_55_TLB.pas 
```

通过导入“Microsoft VBScript Regular Expressions 5.5”类型库获得。它获得了 VBScript 标签，因为它是与 VBScript/Javascript 5.5 和 Internet Explorer 5.5 一起引入的，这意味着如果您要求用户拥有 IE5.5 或更高版本，您可以确定最终用户客户端拥有该库。不过，我还没有将它与丰富的编辑控件结合起来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T22:30:56.110

我使用 TRichView，尽管正如您所说，它不支持使用正则表达式进行搜索，但您可以通过完整的源代码获得它。

我已经为我自己的软件对包进行了各种自定义，并且更改搜索功能的内部结构以支持正则表达式在我的估计中不会太难。

对于您拥有源代码的任何 RichEdit 控件，这可能都是正确的。

那么请看一下：[“……在 Delphi 中使用正则表达式？”](http://www.swissdelphicenter.ch/en/showcode.php?id=1478) 了解如何自己添加它。

* * *

而且我确实找到了一个实现正则表达式的 TRichView 用户。[他描述了一些他是如何做到](http://www.trichview.com/forums/viewtopic.php?t=732&highlight=regex)的，他使用的包是 TRegEx。我自己对 TRegEx 并不熟悉，但也许他指的[是这个](http://www.uptime.it/delphi/old/delphiregex.html)，或者您可以尝试使用[TRegExpr](http://regexpstudio.com/TRegExpr/TRegExpr.html)。

您可以在 About.com 上找到一个很好的 Delphi 正则表达式库列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T09:11:02.577

基于对这个问题的出色反馈，我对 TRichEdit 和 RichEd20.dll 进行了更多研究。

一些背景。我想使用 TPerlRegEx 搜索 TRichEdit 控件内容并突出显示匹配的结果。以前使用 RichEdit1.Lines.Text 作为搜索主题的尝试导致 RegEx MatchedExpressionOffset 和 RichEdit1.SelStart 不匹配。

我原以为这是由于 RTF 格式造成的.. 但这只是我在放屁！

仔细研究后，在不使用 RichEdit.FindText 时需要考虑两个问题：

1.  如果使用 RichEdit.Text 或 RichEdit.Lines.Text，请注意它们包含额外的 #$D 和 #$A 回车符和换行符。
2.  如果使用 TPerlRegex.MatchedExpressionOffset 那么这是基于 1 而 TRichEdit.SelStart 是基于 0。

在确定 SelStart 时，需要考虑使用 TPerlRegex 回车和换行符正确找到 SelStart。

# haskell - 定义一个看似简单的 Foldable 实例

> ID：766074
> 
> 赞同：1
> 
> 时间：2009-04-19T20:53:55.297
> 
> 标签：haskell, typeclass

这种数据类型的 Foldable 实例会是什么样子？

```
data X t = X t [X t] 
```

我试过这个：

```
instance Foldable X where
    foldMap f (X x xs) = f x `mappend` foldMap f xs 
```

但是得到了这个错误：

```
Occurs check: cannot construct the infinite type: a = X a
When generalising the type(s) for `foldMap'
In the instance declaration for `Foldable X' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T21:20:12.253

`xs`是项目列表，`foldMap`需要应用于单个项目，而不是列表本身。这样做`map`会给出一个可以结合的结果列表`mconcat`：

```
instance Foldable X where
  foldMap f (X x xs) = f x `mappend` mconcat (map (foldMap f) xs) 
```

# c++ - 为什么 Valgrind 说我的 std::map 实现 产生内存泄漏？

> ID：766080
> 
> 赞同：3
> 
> 时间：2009-04-19T20:55:47.600
> 
> 标签：c++, valgrind

Valgrind 正在输出以下内容：

```
==14446== 2,976 (176 direct, 2,800 indirect) bytes in 2 blocks are definitely lost in loss record 23 of 33
==14446==    at 0x4C2506C: operator new(unsigned long) (in /usr/lib64/valgrind/amd64-linux/vgpreload_memcheck.so)
==14446==    by 0x41C487: __gnu_cxx::new_allocator<std::_Rb_tree_node<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> > >::allocate(unsigned long, void const*) (new_allocator.h:92)
==14446==    by 0x41C4AB: std::_Rb_tree<unsigned, std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn>, std::_Select1st<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> >, std::less<unsigned>, std::allocator<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> > >::_M_get_node() (stl_tree.h:357)
==14446==    by 0x41C915: std::_Rb_tree<unsigned, std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn>, std::_Select1st<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> >, std::less<unsigned>, std::allocator<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> > >::_M_create_node(std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> const&) (stl_tree.h:366)
==14446==    by 0x5036E9A: std::_Rb_tree<unsigned, std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn>, std::_Select1st<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> >, std::less<unsigned>, std::allocator<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> > >::_M_insert_(std::_Rb_tree_node_base const*, std::_Rb_tree_node_base const*, std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> const&) (stl_tree.h:852)
==14446==    by 0x5037027: std::_Rb_tree<unsigned, std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn>, std::_Select1st<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> >, std::less<unsigned>, std::allocator<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> > >::_M_insert_unique(std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> const&) (stl_tree.h:1148)
==14446==    by 0x5037227: std::_Rb_tree<unsigned, std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn>, std::_Select1st<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> >, std::less<unsigned>, std::allocator<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> > >::_M_insert_unique_(std::_Rb_tree_const_iterator<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> >, std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> const&) (stl_tree.h:1188)
==14446==    by 0x50375CD: std::map<unsigned, vimrid::imaging::ImageMatrixColumn, std::less<unsigned>, std::allocator<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> > >::insert(std::_Rb_tree_iterator<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> >, std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> const&) (stl_map.h:496)
==14446==    by 0x50376DE: std::map<unsigned, vimrid::imaging::ImageMatrixColumn, std::less<unsigned>, std::allocator<std::pair<unsigned const, vimrid::imaging::ImageMatrixColumn> > >::operator[](unsigned const&) (stl_map.h:419)
==14446==    by 0x5036A43: vimrid::imaging::ImageMatrixRow::operator[](unsigned) (ImageMatrixRow.cpp:10)
==14446==    by 0x5034BBB: vimrid::imaging::ImageMatrix::_getRotatedCopy(double, vimrid::imaging::ImageMatrix&) (ImageMatrix.cpp:151)
==14446==    by 0x503350A: vimrid::imaging::processing::ImageFilter& vimrid::imaging::ImageMatrix::GetRotatedCopy<vimrid::imaging::processing::ImageFilter>(double) (ImageMatrix.h:48) 
```

这可能意味着什么？

```
//ImageMatrixRow.cpp:8-11
ImageMatrixColumn &ImageMatrixRow::operator[](VUInt32 columnIndex)
{
    return columns[columnIndex];
}

//ImageMatrix.cpp:151
target[x][y][0] = source[roundX][roundY][0];

//ImageMatrix.h:48
return *(T*)&_getRotatedCopy(degrees, CopyDimensions()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-19T21:10:57.283

这可能是因为池分配器。来自 Valgrind 常见问题解答：

> 我的程序使用 C++ STL 和字符串类。Valgrind 在程序退出时报告涉及这些类的“仍然可以访问”的内存泄漏，但应该没有。
> 
> 首先：放松，它可能不是一个错误，而是一个特性。C++ 标准库的许多实现都使用它们自己的内存池分配器。许多被破坏对象的内存不会立即释放并返回给操作系统，而是保留在池中以供以后重用。在程序的 exit() 处未释放池的事实导致 Valgrind 报告此内存仍可访问。但是，在 exit() 处不释放池的行为可以称为库的错误。

阅读更多： [Valgrind 常见问题](http://valgrind.org/docs/manual/faq.html#faq.reports)

我可能错了，因为我很着急，无法分析您的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T02:59:01.037

该错误似乎不是来自您的代码，而是来自您正在使用的库。

Valgrind 带有一些默认的错误抑制，但这可能不包括您正在使用的库。

> 错误检查工具可检测基本库中的大量问题，例如 GNU C 库和 X11 客户端库，这些库预装在您的 GNU/Linux 系统上。你不能轻易地修复这些，但你不想看到这些错误（是的，有很多！）所以 Valgrind 读取错误列表以在启动时抑制。构建系统时，./configure 脚本会创建一个默认抑制文件。

您可以创建自己的[错误抑制](http://valgrind.org/docs/manual/manual-core.html#manual-core.suppress)，您知道这些错误抑制与您的代码无关。

查看类似的 SO 问题[为什么 Valgrind 不喜欢我使用 glutCreateWindow？](https://stackoverflow.com/questions/766303/why-does-valgrind-not-like-my-usage-of-glutcreatewindow)

# asp.net-mvc - 未记录 ELMAH 和 ASP.NET MVC 自定义错误

> ID：766082
> 
> 赞同：3
> 
> 时间：2009-04-19T20:56:10.300
> 
> 标签：asp.net-mvc, elmah

我正在尝试使用 ELMAH 进行错误记录，并且我尝试了其他几个

当启用 ASP.NET 中的自定义错误功能时，这两个似乎都不会记录错误

我在所有控制器中都使用了 [HandleError] 属性，起初我认为这是问题所在，但不仅仅是当我启用自定义错误页面时它不会记录任何错误，即使这些错误日志库中有一半说他们应该这样做。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-19T20:59:53.833

需要检查的几件事是您已为 ELMAH 注册了 HttpModule。您没有任何其他进程拦截错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-15T11:12:35.247

出于某种原因，删除页面级别的 ErrorPage 重定向为我解决了这个问题。web.config 中的重定向（cUstomErrors 标记）有效，但页面级别的重定向会阻止 elmah 记录错误。只是一些快速和容易检查的东西。希望对我的情况有所帮助。

# java - 如何在 CTabFolder 中隐藏 CTabItem

> ID：766088
> 
> 赞同：4
> 
> 时间：2009-04-19T21:01:51.300
> 
> 标签：java, swt, jface

我找不到任何使选项卡在 SWT/JFace 应用程序中不可见或以其他方式隐藏的方法 --- 我希望根据用户设置的其他一些偏好设置第二个选项卡可用（或不可用）。

弄清楚这一点应该不难！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T21:59:22.457

我知道的唯一方法是为要隐藏的选项卡配置 CTabItem，然后在要显示时创建一个新的 CTabItem。有点，

```
 CTabFolder folder = new CTabFolder(parent, SWT.NONE);
 Label label = new Label(folder, SWT.NONE);
 label.setText("Hello");
 CTabItem item = new CTabItem(folder);
 item.setControl(label);
 // Hide it
 item.dipose();
 // show it again
 CTabItem item = new CTabItem(folder);
 item.setControl(label); 
```

如果您想在中间隐藏一个选项卡，您需要在您处理的选项卡之后重新创建所有选项卡。如果您创建一个包含控件的类和一个可用于切换可见性的字段，这可能是最简单的。然后，如果可见性字段为真，您可以处理所有 CTabItems 并重新创建。

# php - Timezone issue PHP 5.2 Windows (WAPP stack)

> ID：766089
> 
> 赞同：0
> 
> 时间：2009-04-19T21:02:35.993
> 
> 标签：php, windows, datetime, timezone

On a Win2k server, using a WAPP stack (Windows,Apache,PostgreSQL,PHP). Running a PHP web application. Also tested using PHP interactive console.

The datetime is reported correctly, but for some strange reason the timezone is reported incorrectly:

```
php -a
<?php
echo date('c');
2009-04-19T16:52:35-04:00 
```

* * *

```
C:\WAPP\php>time /t
17:06

C:\WAPP\php>date /t
Sun 04/19/2009 
```

The server's OS timezone is actually set to GMT-5\. I used an (unofficial) DST fix and also tried to use php_timezonedb.dll extension, but the problem persists.

This server is also running other applications (not under my control), so I can't just change the time. I could also just temporarily set everyone to GMT-4 in the PHP application, but I feel that there should be a less hackish solution.

Does anyone have any suggestions, or can give a more in depth explanation of what is happening? I suspect that it has something to do with the recent changes in DST and Windows, and it is causing PHP to detect the timezone improperly.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T09:10:37.850

您可以使用以下方法避免很多与时区相关的问题：

```
gmdate  ( string $format  [, int $timestamp  ] ); 
```

它与`date()`函数相同，只是返回的时间是 GMT（格林威治标准时间）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T02:57:22.227

除非您有权访问 php.ini 文件（您可以在那里设置服务器的时区），否则您必须在脚本中设置时区。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T09:17:35.227

You can set the timezone php is using by setting the php [date.timezone](http://www.php.net/manual/en/datetime.configuration.php#ini.date.timezone) variable in a .htaccess in the application directory.

```
php_value date.timezone "America/Bahia" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T09:24:02.013

You have to set the timezone (either from the PHP.ini or with [`date_default_timezone_set()`](http://is.php.net/manual/en/function.date-default-timezone-set.php))

I'm guessing if you turn on Strict error notification, you'd get an error about not setting the default timezone.

> Every call to a date/time function will generate a `E_NOTICE` if the time zone is not valid, and/or a `E_STRICT` message if using the system settings or the TZ environment variable. See also [`date_default_timezone_set()`](http://is.php.net/manual/en/function.date-default-timezone-set.php)

# sql - 寻找 SQL 查询以显示来自 2 个表的数据，这些表在表之间不常见

> ID：766096
> 
> 赞同：0
> 
> 时间：2009-04-19T21:07:04.097
> 
> 标签：sql

我有两个具有完全相同结构的表。

表 MasterList Acct_id(9) 姓名 (25) 地址 (35) 城市(15) 州(2) 邮政编码(5)

和

表 NewMasterList Acct_id(9) 姓名 (25) 地址 (35) 城市(15) 州(2) 邮政编码(5)

我需要一个查询来显示每个表中不在两个表中的所有记录的 Acct_ID 和名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T21:11:23.570

假设`acct_ID`是主键：

```
SELECT COALESCE(ml.acct_ID, nml.acct_ID) AS AccountID
     , COALESCE(ml.name, nml.name) AS Name 
FROM MasterList ml
    FULL OUTER JOIN NewMasterList nml ON nml.Acct_ID=ml.Acct_ID
WHERE nml.acct_ID IS NULL OR ml.acct_ID IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T21:12:25.300

我认为以下查询应该有所帮助-

```
select Acct_id,Name 
from MasterList 
where Acct_id not in (select distinct Acct_id from NewMasterList) 

union 

select Acct_id,Name 
from NewMasterList 
where Acct_id not in (select distinct Acct_id from MasterList) 
```

干杯

# database - 如何使用 LINQ 获取表中当前使用的最高 ID 号？

> ID：766104
> 
> 赞同：0
> 
> 时间：2009-04-19T21:12:52.163
> 
> 标签：database, linq

我有一张包含姓名列表的表格。此表有一个 ID 列，它是一个自动递增的数字。我想在我的网站上显示类似的东西，

“迄今为止创建了 6,523,213 个名字。”

因此，我需要从我的名称表中获取当前最高的索引/ID 号。

我可以想到几种方法，我可以通过 desc OrderBy ID 并选择第一个。但这可能不是最快的方法。我还可以在某个地方粘贴一个字段，并在每次将新名称插入数据库时​​递增它。

有没有更简单/快速的 LINQ express 来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T21:24:42.603

您可以简单地使用 LINQ 的 COUNT 或 MAX 方法：

假设该名称的 DataContext 和一个名为“Names”的实体具有一个名为“Id”的主键。这些中的任何一个都可以工作：

```
DataContext db = new DataContext();
var nameCount = db.Names.Count();

var nameCount = db.Names.Select(n => n.Id).Max(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T21:24:13.897

我认为您真正想要做的是*计算行数*- 而不是获得最高索引。考虑一下删除记录时会发生什么 - 注册名称的数量减少了 1，但最高索引没有......

在普通 SQL 中，您可以使用以下命令：

```
 SELECT COUNT(ColumnName) FROM TableName 
```

如果你真的想用 LINQ 来做，我认为[这](http://msdn.microsoft.com/en-us/vbasic/bb737922.aspx#countsimp)会起作用。

# java - 测试对象是否实现接口

> ID：766106
> 
> 赞同：156
> 
> 时间：2009-04-19T21:14:14.657
> 
> 标签：java

以前可能有人问过这个问题，但是快速搜索只找到了针对 C# 提出的相同问题。[看这里。](https://stackoverflow.com/questions/410227/test-if-object-implements-interface)

我基本上想做的是检查给定对象是否实现给定接口。

我想出了一个解决方案，但这还不足以在 if 或 case 语句中频繁使用它，我想知道 Java 是否没有内置解决方案。

```
public static Boolean implementsInterface(Object object, Class interf){
    for (Class c : object.getClass().getInterfaces()) {
        if (c.equals(interf)) {
            return true;
        }
    }
    return false;
} 
```

* * *

编辑：好的，谢谢你的回答。尤其是对 Damien Pollet 和 Noldorin，你让我重新思考了我的设计，所以我不再测试接口了。

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2009-04-19T21:36:18.533

[`instanceof`](http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#15.20.2)操作员以[`NullPointerException`](https://docs.oracle.com/javase/8/docs/api/java/lang/NullPointerException.html)安全的方式完成工作。例如：

```
 if ("" instanceof java.io.Serializable) {
     // it's true
 } 
```

产生真实的。自从：

```
 if (null instanceof AnyType) {
     // never reached
 } 
```

产生错误，`instanceof`运算符是空安全的（您发布的代码不是）。

**instanceof是**[Class#isInstance(Object)](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#isInstance(java.lang.Object))的内置编译时安全替代方案

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-04-19T21:19:57.030

这应该这样做：

```
public static boolean implementsInterface(Object object, Class interf){
    return interf.isInstance(object);
} 
```

例如，

```
 java.io.Serializable.class.isInstance("a test string") 
```

评估为`true`。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-20T14:51:38.873

我更喜欢`instanceof`：

```
if (obj instanceof SomeType) { ... } 
```

这比`SomeType.isInstance(obj)`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-19T21:20:26.793

那很简单 ：

```
 interf.isInstance(object) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-01T10:10:15.697

如果要测试接口：

```
public List<myType> getElement(Class<?> clazz) {
    List<myType> els = new ArrayList<myType>();
    for (myType e: this.elements.values()) {
        if (clazz.isAssignableFrom(e.getClass())) {
            els.add(e);
        }
    }
    return els; 
```

}

clazz 是一个接口，而 myType 是您定义的可以实现多个接口的类型。使用此代码，您只能获得实现已定义接口的类型

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-22T02:53:35.050

今晚我在使用 android 时遇到了这个问题，在查看了 javadoc 解决方案之后，我想出了这个真正可行的解决方案，只为像我这样需要的不仅仅是 javadoc 解释的人。

这是一个使用 android java 的实际界面的工作示例。在尝试强制转换 AboutDialogListener 字段之前，它会检查调用实现 AboutDialogListener 接口的活动。

```
public class About extends DialogFragment implements OnClickListener,
    OnCheckedChangeListener {

public static final String FIRST_RUN_ABOUT = "com.gosylvester.bestrides.firstrunabout";

public interface AboutDialogListener {
    void onFinishEditDialog(Boolean _Checked);
}

private AboutDialogListener adl;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    Activity a = this.getActivity();
    if (AboutDialogListener.class.isInstance(a)) {
        adl = (AboutDialogListener) a;
        }
} 
```

...稍后我在调用接口之前检查字段 adl 是否为 !null

```
@Override
public void onStop() {
    super.onStop();
    sharedPref.edit().putBoolean(About.FIRST_RUN_ABOUT, _Checked).commit();
    // if there is an interface call it.
    if (adl != null) {
        adl.onFinishEditDialog(is_Checked());
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-20T10:35:02.610

使用 Apache commons-lang ArrayUtils，查看你需要的接口是否包含在你对象的接口中

```
public static Boolean implementsInterface(Object object, Class interf){
    return ArrayUtils.contains(object.getClass().getInterfaces(), interf);
} 
```

# javascript - Javascript 悬停效果删除预定义样式

> ID：766107
> 
> 赞同：0
> 
> 时间：2009-04-19T21:14:57.430
> 
> 标签：javascript, coding-style

我正在使用[Imar Spaanjaars 网站上的教程](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=312)来使整个表格行可点击并对其产生悬停效果。一旦用户将鼠标悬停在表格行上，它就会删除该行的预定义背景颜色。我想让它不会覆盖这种风格。我该怎么做？

```
 <script type="text/javascript">
    function ChangeColor(tableRow, highLight)
    {
    if (highLight)
    {
      tableRow.style.backgroundColor = '#dcfac9';
    }
    else
    {
      tableRow.style.backgroundColor = 'white';
    }
  }

  function DoNav(theUrl)
  {
  document.location.href = theUrl;
  }
  </script> 
```

如果您有任何更好的建议来完成这项任务，我很想听听他们的意见！

我的 tr 标签中有一个 bgcolor 标签，如果该特定邮件已被阅读，则由我的 php 设置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-19T21:29:19.923

如果原始背景颜色是通过样式表或（如您的情况）遗留`bgcolor`属性指定的，那么您可以在完成后清除元素上的样式，它会恢复：

```
function ChangeColor(tableRow, highLight)
{
  if (highLight)
  {
    tableRow.style.backgroundColor = '#dcfac9';
  }
  else
  {
    tableRow.style.backgroundColor = '';
  }
} 
```

也就是说，您最好使用 CSS 类和相关规则来表示行的突出显示状态并根据需要添加/删除它：

```
tr { backgroundColor: <whatever> }
tr.highlighted { backgroundColor: #dcfac9 } 
```

然后你的Javascript变成

```
function ChangeColor(tableRow, highLight) {
    if(highLight) 
    {
        tableRow.className = 'highlighted';
    } 
    else 
    {
        tableRow.className = '';
    }
} 
```

除了将特定样式排除在脚本*和*标记之外（随着时间的推移它们变得难以维护），这还允许您添加或更改悬停样式（例如，粗体文本或边框），而不会增加代码的复杂性。

如果您可以访问诸如[Prototype](http://www.prototypejs.org)、[Ext.js](http://extjs.com)或[Dojo](http://dojotoolkit.org)之类的 Javascript 库，那么您可以改用它们的类操作函数，这将处理您想要保留现有类名或使用多个类的情况单个元素。

# asp.net - 如何在 ASP.NET ListView 的 ItemUpdated 事件处理程序中获取 PK 值？

> ID：766108
> 
> 赞同：1
> 
> 时间：2009-04-19T21:15:23.343
> 
> 标签：asp.net, listview

我有一个绑定到 LINQDatasource 控件的 ListView，需要在 ItemUpdated 事件处理程序中获取表的主键值。

我从 ItemUpdating 事件处理程序中获取值没有问题，因为 ListViewUpdateEventArgs 参数提供对键集合的访问。

密钥集合似乎不能作为 ItemUpdated 事件处理程序中 ListViewUpdateEventArgs 参数的一部分。我也尝试从 NewValues 和 OldValues 集合中获取值，但它不可用。

我应该怎么做？

更新后，密钥集合可作为 GridViewUpdateEventArgs 的一部分使用，为什么不是 ListView？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T02:10:44.130

传递给 ListView 的 ItemUpdated 事件处理程序的 ListViewUpdatedEventArgs 对象没有像传递给 GridView 的 RowUpdated 事件处理程序的 GridViewUpdatedEventArgs 对象那样的 Keys 集合。

我最终使用 ListView 的 EditIndex 从 DataKeys 集合中检索更新项的键值。

```
ActivityListView.DataKeys[ActivityListView.EditIndex].Value 
```

# php - file_get_contents (or curl, or fopen) problem with session data

> ID：766109
> 
> 赞同：2
> 
> 时间：2009-04-19T21:17:00.250
> 
> 标签：php, session, curl, fopen, file-get-contents

i have a page that shows a value from session, lets call it www.domain-a.com/master.php and if i type it directly from the browser, it shows me the session value.

but when i try to download it with file_get_contents (or other method) from another domain, like www.domain-b.com/slave.php, it is not retrieving the content protected by the session, just a blank page.

i know it is because the server-b is trying to retrieve the content, not the user...

anyone knows how to tell the domain-a that who is retrieving the information is the user? there is a way to retrieve the session value?

regards,

josé

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-06-04T16:04:59.293

有一个有用的解决方案。

将 PHPSESSID 发送到另一台服务器没有意义，因为会话数据存储在服务器上的文件中，这就是 file_get_contents 阻止 http 服务的原因。很简单。客户端使用 http 连接到服务器，服务器当然会打开带有会话数据的文件以进行写入。file_get_contents 创建连接到同一服务器的另一个连接（另一个线程）。如果设置了会话 ID，则服务器会打开包含会话数据的相同文件，但该文件已打开。

所以这是一个很好的解决方案，可以防止这种碰撞：

```
$opts = array( 'http'=>array( 'method'=>"GET",
              'header'=>"Accept-language: en\r\n" .
               "Cookie: ".session_name()."=".session_id()."\r\n" ) );

$context = stream_context_create($opts);
session_write_close();   // this is the key
$obsah = file_get_contents( 'http://blablabla.cz', false, $context); 
```

它工作正常。对对对

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-19T21:58:53.707

您可能需要将用户的会话 ID 与请求一起发送到 cookie 中。

如果要使用该`file_get_contents`功能，则必须[创建一个上下文](http://docs.php.net/manual/en/function.stream-context-create.php)来设置 cookie：

```
$opts = array(
    'http' => array(
        'method' => 'GET',
        'header' => 'Cookie: PHPSESSID=0123456789abcdef0123456789abcdef'
    )
);
$context = stream_context_create($opts);
echo file_get_contents('http://master.example.com/master.php', 0, $context); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-29T19:28:31.850

if you have control over the www.domain-a.com/master.php

then you can have it programmed in a way that you could send it the username in encrypted fashion and like master.php?user=zxcvert2324 or whatever and it would decrypt and know who is sending the request.

Otherwise you would need to look into CURL and have the session created by first having curl login to that site and then on the next request goto that master.php page.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T16:29:19.707

请记住，如果您的会话代码针对客户端 IP 地址进行验证，那么您可能仍然会遇到问题，因为发布到您的页面的客户端 IP 将是请求服务器（使用 curl 或 file_get_contents）而不是客户端浏览器的 IP。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-19T21:23:22.730

Your PHP configurations are probably prohibiting you to retrieve files over HTTP.

Possible culprits:

*   [Safe mode](http://php.net/manual/en/ini.sect.safe-mode.php#ini.safe-mode)
*   [Open basedir](http://php.net/manual/en/ini.sect.safe-mode.php#ini.open-basedir)
*   [`allow_furl_open`](http://fi2.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-19T21:36:55.897

You should be able to retrieve the content with curl. See [this answer](https://stackoverflow.com/questions/692962/how-to-use-php-to-get-a-webpage-into-a-variable/692966#692966) (you can probably drop the browser spoof option).

# objective-c - Multiple recessed NSButtonCells in a custom control

> ID：766111
> 
> 赞同：0
> 
> 时间：2009-04-19T21:17:40.497
> 
> 标签：objective-c, cocoa

I'm experimenting with creating a custom scope bar that uses recessed-style NSButtonCell objects. However, I'm having trouble drawing the bezel when the mouse is hovering. I can make it work by creating tracking areas and setting showsBorderOnlyWhileMouseInside to NO while the mouse is inside, and YES when it moves outside, but this feels like a hack to me, especially since NSButtonCell will do the tracking on its own.

If I use the control's setCell method, the button cell will call the control's addTrackingRect:owner:userData:assumeInside: and set up its own tracking to draw the bezel when the mouse is hovering. However, if I want to use multiple button cells in the same control, I try to set each cell's controlView to the custom control using the button cell's setControlView method, but it doesn't prompt the cell to set up tracking areas like setCell does.

The technique must be possible since NSMatrix does this, but after reading every API and forum available, I haven't found a way to initiate NSButtonCell's tracking behavior without using its control's setCell method. My forehead is bloody from beating against the desk - help would be appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T19:40:43.560

后来我回到这个，发现如果你将自定义子类更改为 NSControl 而不是 NSView，addTrackingRect 方法将由单元自动处理。只需根据需要调用单元格的 mouseEntered/mouseExited 方法来实现单元格的悬停模式。希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T23:06:02.157

首先，创可贴可能是第一个可以提供帮助的东西。;)

您是否尝试过使用 NSButtonCell 的 -updateTrackingAreaWithFrame:inView: 方法？它没有记录，但显示在 Leopard 上 class-dump 生成的 NSButtonCell 标头中。我不确定关于使用不以下划线开头的非文档化方法的官方用词或普遍共识是什么，因此请谨慎购买。

另一个注意事项：您可能希望 - 而不是使用多个 buttonCells - 查看在视图中使用多个按钮来完成此任务。在像 NSMatrix 这样的现有类之后为自己的类建模是令人钦佩的，但是对于像您正在寻找的复杂行为，稍微偏离一点通常会更有成效。*使用多个视图而不是使用带有一堆单元格的单个视图*的概念仍然很昂贵，但如果走这条路需要一个 hacky 实现，我会走另一条路。

# java - Jersey in Tomcat+Spring environment can't find ComponentProvider. Why?

> ID：766114
> 
> 赞同：3
> 
> 时间：2009-04-19T21:20:08.073
> 
> 标签：java, spring, tomcat, jersey

I've deployed Jersey on Tomcat and everything works perfectly (when I use the com.sun.jersey.spi.container.servlet.ServletContainer), but as soon as I change it to the com.sun.jersey.spi.spring.container.servlet.SpringServlet (according to all the tutorials I can find), I get a nasty exception:

```
Apr 19, 2009 5:07:35 PM org.apache.catalina.core.ApplicationContext log
INFO: Marking servlet ServletAdaptor as unavailable
Apr 19, 2009 5:07:35 PM org.apache.catalina.core.StandardContext loadOnStartup
SEVERE: Servlet /myservice threw load() exception
java.lang.ClassNotFoundException: com.sun.jersey.spi.service.ComponentProvider 
```

Any idea what package/distribution it can reside? What am I missing?

May be I don't need it at all. I'm trying to make sure that when my resource class is loaded it'll be Autowired and initialized with the rest of the Beans it depends on. Can it be done differently?

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T22:38:17.463

com.sun.jersey.spi.service.ComponentProvider 接口是 jersey-core JAR 的一部分，所以奇怪的是你得到了那个异常。

确保一起使用相同版本的 jersey 库（即，您使用的是 Jersey 1.0.1 库，而不是混合 1.0 和 1.0.1，因为 Spring 类在这两个版本之间被重命名）。

还要确保您的 web.xml 中有一个 ContextLoaderListener，如下所示：

```
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener> 
```

# c# - ADO.Entities fulltext support

> ID：766117
> 
> 赞同：0
> 
> 时间：2009-04-19T21:20:57.680
> 
> 标签：c#, ado.net

I was using Linq to SQL and it didn't have any FULL-TEXT support. I went back to Stored procedure.

The second reson was because stored procedure is almost 3 times slower.

I would like to know if the performance is better for ADO.Entities and if has support for fulltext search

* * *

I mean that Stored procedure is 3 times faster then Linq to SQL

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T21:32:38.527

Linq to SQL and ADO.Entities won't be faster than using the equivalent Stored Procedures, although the performance difference will probably be negligible in most instances. ADO.Entities generally won't perform faster than LINQ to SQL either, but once again, in most instances, it won't be slower.

ADO.Entities does not support FullText search yet. I would continue to use Stored Procedures for that functionality if I were you.

# c++ - WinDbg 中 wchar_t 和 char 的表示

> ID：766126
> 
> 赞同：4
> 
> 时间：2009-04-19T21:26:04.267
> 
> 标签：c++, winapi, x86, windbg

**笔记：**

```
/*
* Trivial code
*/
wchar_t *greeting = L"Hello World!";
char *greeting_ = "Hello World!"; 
```

**WinDbg：**

```
0:000> ?? greeting
wchar_t * 0x00415810
"Hello World!"
0:000> ?? greeting_
char * 0x00415800
"Hello World!"

0:000> db 0x00415800
00415800  48 65 6c 6c 6f 20 57 6f-72 6c 64 21 00 00 00 00  Hello World!....
00415810  48 00 65 00 6c 00 6c 00-6f 00 20 00 57 00 6f 00  H.e.l.l.o. .W.o.
00415820  72 00 6c 00 64 00 21 00-00 00 00 00 00 00 00 00  r.l.d.!......... 
```

**问题：**

*   **NULL**字符的用途是什么：`00`在[`wchar_t`](http://en.wikipedia.org/wiki/Wide_character)- **Win32**中的 ASCII 字符之间？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-19T21:30:31.293

`wchar_t`是一个宽字符串，因此每个字符占用 2 个字节的存储空间。'H' 为`a wchar_t`0x0048。由于 x86 是 little-endian，因此您会看到内存中的字节顺序为 48 00。

windbg 中的 db 将转储字节并提供如何将其视为 ASCII 字符串，因此您会看到 HEL ... 输出。您可以使用“du”将内存转储为 unicode 字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T21:31:22.757

答案是 wchar_t 字符是 16 位数量，因此每个需要两个字节。每个代表一个[UTF-16](http://en.wikipedia.org/wiki/UTF-16)字符。由于您使用的字母在 ASCII 范围内，它们的值 < 256，因此每个 2 字节对的高字节为零。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T21:30:09.937

wchar_t 用于[unicode](http://en.wikipedia.org/wiki/Unicode)，而 char 用于标准 8 位 ascii

在 wchar_t 中，每个字符都用 16 位表示，但“标准”字符位于图表的下半部分。例如，对于这些字节，[繁体中文将具有除 00 之外的其他值。](http://en.wikipedia.org/wiki/List_of_Unicode_characters)

# c++ - 获取当前 ModelView 矩阵

> ID：766127
> 
> 赞同：11
> 
> 时间：2009-04-19T21:27:28.633
> 
> 标签：c++, opengl, matrix, translation

在 OpenGL 中，如何读取模型视图矩阵中的当前 x/y 转换？我知道您必须将当前矩阵加载到数组中并从那里读取浮点数，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-19T21:34:59.287

为了检索当前的模型视图矩阵，您必须使用参数调用[glGetFloatv](http://linux.die.net/man/3/glgetfloatv)函数`GL_MODELVIEW_MATRIX`。

```
GLfloat matrix[16]; 
glGetFloatv (GL_MODELVIEW_MATRIX, matrix); 
```

从文档中：

> `GL_MODELVIEW_MATRIX`
> 
> params 返回十六个值：模型视图矩阵堆栈顶部的模型视图矩阵。最初这个矩阵是单位矩阵。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-19T21:38:55.393

使用[glGlet](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/get.html)

```
GLfloat matrixf[16];
glGetFloatv(GL_MODELVIEW_MATRIX, matrixf);

GLdouble matrixd[16];
glGetDoublev(GL_MODELVIEW_MATRIX, matrixd);

GLint matrixi[16];
glGetIntegerv(GL_MODELVIEW_MATRIX, matrixi); 
```

# javascript - Javascript Canvas Serialization/Deserialization?

> ID：766137
> 
> 赞同：13
> 
> 时间：2009-04-19T21:33:29.820
> 
> 标签：javascript, html, canvas

Can you serialize/deserialize a canvas object in javascript?

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-20T00:00:02.963

除了该`getImageData`方法，您还可以使用`canvas.toDataURL()`获取数据 URL 编码的 PNG。如果您需要序列化为字符串，则无需手动将原始数据转换为字符串。您可以通过创建图像并将 src 设置为数据 URL，然后将其绘制到画布来反序列化。

[编辑以考虑异步加载（由 olliej 建议）。]

```
function serialize(canvas) {
    return canvas.toDataURL();
}

function deserialize(data, canvas) {
    var img = new Image();
    img.onload = function() {
        canvas.width = img.width;
        canvas.height = img.height;
        canvas.getContext("2d").drawImage(img, 0, 0);
    };

    img.src = data;
} 
```

如果我没记错的话，一些旧版本的 Safari，也许 Opera 不支持`toDataURL`，但更新的版本支持。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-19T22:02:36.410

您可以使用 canvas.getImageData() 和 .putImageData() 直接访问像素。您还可以使用 canvas.toDataURL() 将图像序列化为数据 URL，以发布到服务器。

这仅适用于较新的浏览器。

# python - 通过切片了解字符串反转

> ID：766141
> 
> 赞同：41
> 
> 时间：2009-04-19T21:35:54.917
> 
> 标签：python, string, slice

我一直在寻找一种向后打印字符串的方法，在谷歌上快速搜索后，我发现了这种方法：

假设`a`是一个字符串变量。这将`a`向后返回字符串：

```
a[::-1] 
```

谁能解释它是如何工作的？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-04-19T21:43:46.627

当然，`[::]`是[扩展切片](https://docs.python.org/whatsnew/2.3.html#extended-slices)运算符。它允许您获取子字符串。基本上，它通过将您想要的元素指定为 [begin:end:step] 来工作，它适用于所有序列。关于它的两件事：

*   您可以省略一个或多个元素，它会做“正确的事情”
*   begin、end 和 step 的负数有意义

对于begin和end，如果你给一个负数，则表示从序列的末尾开始计数。例如，如果我有一个列表：

```
l = [1,2,3] 
```

然后`l[-1]`是 3，`l[-2]`是 2，然后`l[-3]`是 1。

对于`step`参数，负数意味着在序列中*向后工作。*所以对于一个列表::

```
l = [1,2,3,4,5,6,7,8,9,10] 
```

您可以编写`l[::-1]`这基本上意味着在阅读列表时使用 -1 的步长。Python 在填写 start 和 stop 时会“做正确的事”，因此它会向后遍历列表并为您提供`[10,9,8,7,6,5,4,3,2,1]`.

我已经给出了带有列表的示例，但字符串只是另一个序列并且以相同的方式工作。所以`a[::-1]`意味着通过加入你通过字符串向后走得到的字符来构建一个字符串。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-19T21:43:30.513

“-1”部分表示切片的“步长”部分——在这种情况下，它一次遍历字符串 1 个字符，但向后（负步长表示从字符串末尾开始）。例如，如果您将 step 指定为 2，您将获取字符串的所有其他字符，从第一个字符开始。如果您指定步长 -2，那么您将获得字符串的每个其他字符，从最后一个字符开始并向后工作。

所以，简而言之，如果`a = '12345'`：

*   `a[::2]`变成`135`
*   `a[::-1]`变成`54321`
*   `a[::-2]`变成`531`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-19T22:48:09.547

我认为以下内容对于反向打印字符串更有意义，但也许这只是我：

```
for char in reversed( myString ):  
  print( char, end = "" ) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-19T21:43:04.710

这是[扩展切片符号](https://docs.python.org/whatsnew/2.3.html#extended-slices)：

```
sequence[start:end:step] 
```

在这种情况下，步骤 -1 表示向后，省略开头和结尾表示您想要整个字符串。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-06-04T19:33:28.450

我会这样做：

```
variable = "string"
message = ""
for b in variable:
    message = b+message
print (message) 
```

它打印：gnirts

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-19T21:42:52.653

它在 Python 中称为 Slice Notation，您可以在此处阅读更多关于它的工作原理：

[解释 Python 的切片符号](https://stackoverflow.com/questions/509211/good-primer-for-python-slice-notation)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-19T21:43:36.317

它使用扩展切片——字符串是 Python 中的序列，并与其他序列（即列表和元组）共享一些方法。切片分为三个部分 - 开始、停止和步进。它们都有默认值 - start 默认为 0，stop 默认为 len(sequence)，step 默认为 1。通过指定 [::-1] 你是说“序列 a 中的所有元素，从头开始, 到最后一次倒退一个。

此功能是在 Python 2.3.5 中引入的，您可以在[What's New 文档](http://www.python.org/doc/2.3.5/whatsnew/section-slices.html)中阅读更多内容。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-19T21:44:01.447

[::-1] 给出字符串 a 的切片。完整的语法`a[begin:end:step]` 给出了 a[begin], a[begin+step], ... a[end-1]。当 step 为负时，您从 end 开始并移动到 begin。

最后，begin 默认为序列的开头，end 为 end，step 为 -1。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-19T21:44:29.030

字符串本质上是一个字符序列，因此切片操作对其进行。你正在做的实际上是：

-> 从开始到结束以 1 的步长向后获取一片“a”。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-05-03T19:09:18.923

这是基本的步骤符号，请考虑以下功能：

一个[2:4:2]

发生的情况是索引在位置 2 和 4 之间被分割，第三个变量的作用是从第一个值开始设置步长。在这种情况下，它将返回 a[2]，因为 a[4] 是一个上限，因此只返回两个值，并且不会进行第二步。(-) 减号运算符只是反转步进输出。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-11-18T20:50:00.210

使用扩展切片语法

```
word = input ("Type a word which you want to reverse: ")
def reverse(word):
  word = word[::-1]
  return word
print (reverse(word)) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-03-22T17:46:18.767

考虑下面的列表

```
l=[12,23,345,456,67,7,945,467] 
```

反转列表的另一个技巧可能是：

```
l[len(l):-len(l)-1:-1] [467, 945, 7, 67, 456, 345, 23, 12]

l[:-len(l)-1:-1] [467, 945, 7, 67, 456, 345, 23, 12]

l[len(l)::-1] [467, 945, 7, 67, 456, 345, 23, 12] 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-03-05T06:27:26.513

您可以使用 reversed() 函数。例如

```
x = "abcd"
for i in reversed(x):
        print(i, end="")
print("\n")
L = [1,2,3]
for i in reversed(L):
        print(i, end="") 
```

印刷品`dcba`和`321`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-06-01T19:08:16.837

前两个边界默认为 0 和序列的长度，如前所述，-1 的步幅表示切片应该从右到左而不是通常的从左到右。因此，效果是颠倒顺序。

```
name="ravi"
print(name[::-1]) #ivar 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2014-08-26T03:39:09.557

我们可以使用 append 和 pop 来做到这一点

```
def rev(s):
    i = list(s)
    o = list()
    while len(i) > 0:
        o.append(t.pop())

    return ''.join(o) 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2017-09-29T03:20:59.147

在不使用 reversed 或 [::-1] 的情况下，这是一个基于递归的简单版本，我认为它是最易读的：

```
def reverse(s):

  if len(s)==2:
    return s[-1] + s[0]

  if len(s)==1:
    return s[0]

  return s[-1] + reverse(s[1:len(s)-1]) + s[0] 
```

# ruby - 在 Ruby 中自动记录异常

> ID：766147
> 
> 赞同：5
> 
> 时间：2009-04-19T21:37:50.217
> 
> 标签：ruby, logging, exception-handling

是否有一个库或简单的方法来捕获 Ruby 程序中抛出的异常并将其记录到文件中？我查看了[log4r](http://log4r.sourceforge.net/)和[logger](http://www.ruby-doc.org/stdlib/libdoc/logger/rdoc/index.html)，但是两者的文档都没有提供任何关于我将如何做到这一点的示例。如果这些信息有帮助的话，我远程运行这个程序并失去对 stdout 和 stderr 的句柄。

你会推荐什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-19T22:59:43.543

如果你想在野外散步，试试这个：

```
class Exception
  alias real_init initialize
  def initialize(*args)
    real_init *args
    # log the error (self) or its args here
  end
end 
```

这将在创建时拦截新异常对象的创建。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-19T22:14:50.423

从中营救`Exception`。这样的事情可能是有道理的：

```
begin
  # run your code here ..
rescue Exception => exception
  # logger.error(...) ....
  raise exception
end 
```

这将记录异常，并重新引发它，以便应用程序在记录之外实际引发错误。

`exception`是 的一个实例`Exception`，请查看[文档](http://ruby-doc.org/core/classes/Exception.html)以获取有关您可以使用此对象做什么的信息（例如访问回溯）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T23:02:41.523

如果您正在运行 Rails 应用程序，[异常通知](http://github.com/rails/exception_notification/tree/master)插件非常方便。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-09T15:31:51.033

如果我做这样的事情会起作用吗：

```
begin
  main()
rescue Exception => e
  myCustomErrorLogger(e)
end

def main()
  # All the application code comes here.
end 
```

我需要的是让我所有未捕获的异常移动到最顶层，并在那里被捕获并随后由错误日志记录功能记录。

我现在正在尝试这个，但如果有你的建议会很棒。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-06T20:01:20.693

您可以在将原因和回溯放入标准输出的部分中调整 Exception 类的代码。

不要忘记检查记录器是否可以为空，异常可以在记录器创建之前（或同时）抛出。

# java - 是否可以将 HTML/CSS 布局与 GWT 逻辑完全分开？

> ID：766149
> 
> 赞同：5
> 
> 时间：2009-04-19T21:38:13.647
> 
> 标签：java, html, web-applications, gwt

我想让我们的 Web 开发人员继续使用纯 HTML 工作，并让开发人员编写 GWT Java-only 代码来编写其余的业务逻辑。

甚至可能吗？

有没有人尝试在 GWT 环境中与 Web 开发人员合作？

您如何将 Web 开发人员纳入 GWT 开发流程？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T14:14:28.797

本质上，我正在寻找类似 DeclarativeUI ( [http://code.google.com/p/google-web-toolkit/wiki/DeclarativeUi](http://code.google.com/p/google-web-toolkit/wiki/DeclarativeUi) ) 或 UIBinder ( [http://code.google.com/p/ google-web-toolkit-incubator/wiki/UiBinder](http://code.google.com/p/google-web-toolkit-incubator/wiki/UiBinder)）。

根据 GWT 博客，UIBinder 刚刚进入孵化器阶段，在 GWT 1.6 时间范围内将不可用，但要晚得多。

目前还有其他办法吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T04:48:43.363

如果通过 HTML，您只是指布局和样式（而不是小部件本身的内容），那么是的，我会说这是完全可能的。

GWT 使得将 HTML 代码（具有自己的 ID、类和关联的 CSS）与 GWT 小部件无缝结合变得相当容易。许多 GWT 小部件本身是对普通 HTML 控件的相当薄的包装器，因此可以轻松地自行设置样式。

从本质上讲，Web 开发人员会为您提供 HTML/CSS 文件，并且您要确保交互部分上有 id。然后，您的 Java GWT 代码使用这些 id 调用 RootPanel.get() 并添加交互式内容。

如果不了解您的更多具体要求，很难更具体地了解这种方法的可能性和可能性。

# c# - .net - Array.Sort 和 Array.BinarySearch 的问题 - 文化和全球化

> ID：766150
> 
> 赞同：1
> 
> 时间：2009-04-19T21:38:28.450
> 
> 标签：c#, .net, vb.net, windows-mobile, compact-framework

我需要对包含单词列表的数组进行排序并使用二进制搜索进行搜索。由于某些原因，必须始终使用“en-US”的排序规则对单词列表进行排序，即美国区域设置。代码将在各种国际操作系统下运行，当然，这意味着单词列表将根据使用的本地区域设置进行不同的排序。在使用立陶宛区域设置运行的计算机/设备上可能会出现一个问题。为什么？因为字母“ **Y** ”在大多数语言中的排序方式是 X- **Y** -Z ，而在立陶宛语中，排序顺序是 I- **Y** - J。这种行为会对我的程序造成严重破坏。

在台式电脑上，我可以使用以下命令将区域设置暂时更改为美式英语：

Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture("en-US")

但是，由于我正在为 Windows Mobile (CF.NET) 进行开发，因此无法实现这段代码。

我发现了一些黑客可以让我以编程方式更改设备上的区域设置，但它们不是“官方的”并且被认为是有风险的，所以我更喜欢避免这些。

所以我的问题是：无论设备上设置的区域设置如何，我如何强制 Array.Sort 和 Array.BinarySearch 在排序和搜索时使用 CultureInfo = "en-US"？

我相信我可以使用：

```
Public Shared Function BinarySearch(Of T) ( _
    array As T(), _
    value As T, _
    comparer As IComparer(Of T) _
) As Integer 
```

并实施 Comparer 以考虑 CultureInfo（并将其设置为“en-US”），但我不知道如何做到这一点，尽管我很努力。如果有人可以在 VB.Net 或 C# 中发布一些示例代码或解释如何做到这一点，我将不胜感激。

如果您知道任何可在 CF.Net 中使用的替代解决方案，那么当然，我会全神贯注。

谢谢。

编辑：

我会将 Twanfosson 的回答视为已接受的解决方案，因为我的问题清楚地表明我想与英语保持联系。

但是，在灵活性方面，我相信 Guffa 的答案是最好的。为什么？让我们再举一个例子：在德语中，字母**Ö**排序为**Ö** -XZ，而在瑞典语和芬兰语中，顺序为 XZ- **Ö**。在爱沙尼亚语中，排序顺序是 Z **-Ö-** X。很复杂，不是吗？Guffa 的解决方案将让我在德国区域设置下运行的设备上强制使用瑞典语排序顺序（更改 CultureInfo）。在这种情况下，使用**Comparer.DefaultInvariant**及其与英语的关联不会有帮助，可能字母**Ö**会以 O 结尾。因此我的投票将投给 Guffa。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T22:06:40.287

好吧，两者的答案都是实现一个比较器。创建一个实现`IComparer(Of String)`接口的类，并拥有自己的`CultureInfo`对象，用于比较字符串：

```
Public Class StringComparerEnUs
   Implements IComparer(Of String)

   Private _culture As CultureInfo

   Public Sub New()
      _culture = New CultureInfo("en-US")
   End Sub

   Public Function Compare(ByVal x As String, ByVal y As String)
      Return String.Compate(x, y, false, _culture)
   End Function

End Class 
```

现在您可以使用它对字符串进行排序：

```
Array.Sort(theArray, New StringComparerEnUs()) 
```

并找到它们：

```
pos = BinarySearch(theArray, "Dent, Arthur", new StringComparerEnUs()) 
```

（当然，可以通过在构造函数中接受文化字符串来使该类更通用，并且您还可以添加一个变量以`ignoreCase`在调用中使用参数`String.Compare`。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-19T22:02:05.773

不能使用[不变](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.invariantculture.aspx)文化吗？

> InvariantCulture 检索不变文化的实例。它与英语相关，但与任何国家/地区无关。

使用不变的文化将使这变得微不足道。

```
Array.Sort( myArray, Comparer.DefaultInvariant );

Array.BinarySearch( myArray, myString, Comparer.DefaultInvariant ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T22:02:38.970

试试这个：

```
class EnglishComparer : IComparer<string>
{
  static CultureInfo __english = new CultureInfo("en-US");

  public int Compare(string x, string y)
  {
    return string.Compare(x, y, __english, CompareOptions.None);
  }
} 
```

# java - Java：从我的应用程序按需运行 HTTP 服务器？

> ID：766154
> 
> 赞同：1
> 
> 时间：2009-04-19T21:39:42.223
> 
> 标签：java, http, jakarta-ee, p2p

我想编写一个使用 HTTP 作为底层协议的**简单 P2P测试应用程序。**
应用程序必须根据需要**决定是**充当**HTTP 服务器**还是充当**HTTP 客户端**。

我知道的经典方法是将应用程序部署在一些**现有的**HTTP 服务器上。但这对我的意图来说是错误的。它必须是另一种方式：服务器由应用程序启动（并且只有当它决定时）。

有没有办法**按需**执行 HTTP 服务器部分 （无需在服务器上部署应用程序本身）？

我可以通过链接 Glassfish 或 Tomcat 库并调用一些“主要”方法来做到这一点吗？

**编辑：它工作！**
我现在成功地尝试了**Jetty**和**JAX-RS (Jersey)**！
谢谢你们。

（REST 类是微不足道的，被忽略了）

包我的.p2p；

```
import com.sun.jersey.spi.container.servlet.*;
import org.mortbay.jetty.*;
import org.mortbay.jetty.servlet.*;

public class Main {
  public static void main(String[] args)
      throws Exception {

    ServletHolder holder = new ServletHolder(ServletContainer.class);

    holder.setInitParameter("com.sun.jersey.config.property.resourceConfigClass",
      "com.sun.jersey.api.core.PackagesResourceConfig");
    holder.setInitParameter("com.sun.jersey.config.property.packages", "my.p2p.rest");

    Server server = new Server(8000);

    Context context = new Context(server, "/", Context.SESSIONS);
    context.addServlet(holder, "/*");
    server.start();
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T21:49:14.837

除了其他答案之外，还有[NanoHTTPD](http://elonen.iki.fi/code/nanohttpd/)。它非常小，只有一堂课，如果您不需要更多或只是想保持最小化，这也许是正确的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T21:54:14.870

您可以使用[Jetty](http://www.mortbay.org/jetty/)或其他一些可嵌入的 HTTP 服务器。来自 Jetty 的网站：

> Jetty 是一个提供 HTTP 服务器、HTTP 客户端和 javax.servlet 容器的开源项目。这些 100% java 组件功能齐全、基于标准、占用空间小、可嵌入、异步和企业可扩展。Jetty 在 Apache License 2.0 和/或 Eclipse Public License 1.0 下获得双重许可。根据任一许可条款，Jetty 可免费用于商业用途和分发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T21:42:48.080

看看[restlet](http://www.restlet.org)项目。它们提供了一个可嵌入的、独立的服务器和一个客户端，两者都使用相同的 Java API（著名的统一接口）。

Glassfish、Tomcat 或 servlet API 对我来说似乎有点矫枉过正。我的 0.02 美元 :)

**编辑**

*客户*

```
 Client client = new Client(Protocol.HTTP);  
 client.get("http://127.0.0.1").getEntity().write(System.out); 
```

*服务器*

```
Restlet sayHello = new Restlet() {  
    @Override  
    public void handle(Request request, Response response) {  
        response.setEntity("Hello World!", MediaType.TEXT_PLAIN);  
    }  
};  

new Server(Protocol.HTTP, 80, sayHello).start(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T22:43:36.203

Java 6 包括一个内置的 Web 服务器。你可以像这样使用它：

```
 HttpServer server = HttpServer.create(new InetSocketAddress(8000), 0);
    server.createContext("/", new HttpHandler() {
        @Override
        public void handle(HttpExchange xchange) throws IOException {
            String response = "This is the response";
            xchange.sendResponseHeaders(200, response.length());
            OutputStream os = xchange.getResponseBody();
            os.write(response.getBytes());
            os.close();
        }
    });
    server.setExecutor(null);
    server.start(); 
```

然后访问[http://localhost:8000](http://localhost:8000)以查看您的响应。

[HttpServer 包](http://java.sun.com/javase/6/docs/jre/api/net/httpserver/spec/com/sun/net/httpserver/package-summary.html "HttpServer package documentation")的 JavaDoc 中有更多示例

如果你不能保证Java 6，看看[embedding Jetty 6](http://docs.codehaus.org/display/JETTY/Embedding+Jetty "嵌入码头")，它很简单而且相当轻巧，也就是说你不需要一个完整的webapp。

# erlang - Erlang 是专为在单个多核机器上运行而设计的，还是可以分发进程？

> ID：766155
> 
> 赞同：2
> 
> 时间：2009-04-19T21:41:09.177
> 
> 标签：erlang, distributed, cluster-computing, multiprocessor

我的应用程序在我的四核机器上运行良好。它是“令人尴尬的并行”，大约有 10 万个进程，因此非常适合在机器集群上运行。但是，我很难找到有关如何将所有这些进程分散到集群中所有可用节点上的文档。

分布式 Erlang 的文档似乎侧重于服务器-客户端应用程序，其中每个节点都是运行单个应用程序的客户端，您可以手动指定哪个节点运行哪个进程。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-19T21:45:42.520

您当然可以在集群中的多个内核和计算机上[分发Erlang 程序。](http://erlang.org/doc/reference_manual/distributed.html)它是为这种事情而设计的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T23:09:02.663

在描述 Erlang 进程时，我喜欢使用“透明”这个词。如果您决定在另一台主机上运行该进程，则无需更改任何代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T22:27:10.597

> Erlang 是否完全支持在分布式处理器内核上运行单个并行应用程序？

当然！但这取决于您如何设计应用程序。一个“理想的”可分发 Erlang 应用程序实际上是由许多独立的（Erlang）进程构建的，这些进程通过消息传递系统相互通信，以执行计算。

# emacs - 从正则表达式中查找并返回匹配的函数

> ID：766157
> 
> 赞同：4
> 
> 时间：2009-04-19T21:42:22.670
> 
> 标签：emacs, elisp

我正在寻找一个函数，它将尝试查找并返回与正则表达式匹配的任何内容，`\\(\\S-\\)`如果没有找到任何内容，可能会返回 nil。搜索应该从文档开始`(point)`并搜索到文档的结尾。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-19T22:18:13.597

使用`re-search-forward`和`match-string`：

```
(when (re-search-forward "\\(\\S-\\)" nil t)
  (match-string 1)) 
```

如果您不想移动点，请将其包装在`save-excursion`：

```
(save-excursion
  (when ... 
```

# c++ - 将像素传递到 glTexImage2D() 后会发生什么情况？

> ID：766167
> 
> 赞同：10
> 
> 时间：2009-04-19T21:45:39.010
> 
> 标签：c++, opengl, glteximage2d

例如，如果我创建一个像素数组，如下所示：

```
int *getPixels()
{
    int *pixels = new int[10];
    pixels[0] = 1;
    pixels[1] = 0;
    pixels[1] = 1;
    // etc...
}

glTexImage2D(..., getPixels()); 
```

glTexImage2D 是使用该引用还是将像素复制到它自己的内存中？

如果答案是前者，那么我应该执行以下操作吗？

```
int *p = getPixels();
glTexImage2D(..., p);

/* Just changed to delete[], because delete
 * would only delete the first element! */
delete[] p; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-19T21:52:25.343

从[手册页](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/teximage2d.html)中的这句话来看，听起来 glTexImage2D 分配了自己的内存。这是有道理的，理想情况下，OpenGL API 会发送数据以存储在显卡本身上（如果驱动程序/实现/等允许）。

> 在 GL 版本 1.1 或更高版本中，像素可能是空指针。在这种情况下，纹理内存被分配以容纳宽度宽度和高度高度的纹理。然后，您可以下载子纹理来初始化此纹理内存。如果用户尝试将纹理图像的未初始化部分应用于图元，则图像未定义。

所以是的，我想一旦你生成了你的纹理，释放内存并没有什么坏处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T22:21:08.410

是的，在调用`geTexImage2D()`返回之后，丢弃传递给它的数据是安全的。事实上，如果你不这样做，你就会有内存泄漏，就像在这段代码中一样：

```
int *getPixels()
{
    int *pixels = new int[10];
    pixels[0] = 1;
    pixels[1] = 0;
    pixels[1] = 1;
    // etc...
}

glTexImage2D(..., getPixels()); 
```

您将指向缓冲区的指针传递给调用，但随后指针丢失并且很可能泄漏。您应该做的是存储它并在调用 retuns 后将其删除：

```
int *pbuf = getPixels();
glTexImage2D(..., pbuf);
delete[] pbuf; 
```

或者，如果纹理的大小是恒定的，则可以将指针传递给堆栈上的数组：

```
{
    int buf[10];
    ...
    glTexImage2D(..., pbuf);
} 
```

最后，如果不想担心指针和数组，可以使用 STL：

```
vector<int> buf;
fillPixels(buf);
getTexImage2D(..., buf.begin()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-15T21:42:38.160

我认为你需要在绘制完像素后调用 glDeleteTextures() 来释放内存。

# c# - Asp.Net 处理程序是否将数据传递回 HttpResponse？

> ID：766169
> 
> 赞同：0
> 
> 时间：2009-04-19T21:47:20.300
> 
> 标签：c#, .net, asp.net, httphandler

Q1：

A）我假设 Web 表单将呈现的 html 传递给 HttpResponse 对象，然后 HttpResponse 对象将这些呈现的数据传递回 IIS？

B）我还假设无论哪个 Asp.Net http 处理程序处理请求，所有 Http 处理程序最终都会将数据传回 HttpResponse？

Q2 - 当 Asp.Net 应用程序收到请求时，在该请求的生命周期中，HttpResponse 和 HttpRequest 对象何时可用？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T21:50:48.530

*   Q1.A：是的
*   Q1.B：是的
*   Q2：立即，它们在生命周期中无处不在。

# silverlight-3.0 - Silverlight 3 beta 中是否存在任何实际问题？

> ID：766170
> 
> 赞同：0
> 
> 时间：2009-04-19T21:47:42.063
> 
> 标签：silverlight-3.0

在我的 silverlight 应用程序中，我试图获取加载到图像控件中的 png 图像的实际尺寸。

在网上浏览了一段时间后，我了解到在 silverlight 3 中有一个名为 PixelHeight 和 PixelWidth 的属性。

所以我想知道升级到 Silverlight 3 是否可行，因为它处于测试阶段，不希望我的应用程序突然充满错误。

请注意，我正在为学校作业做这个项目，所以 silverlight 的版本控制并不重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T22:03:40.293

尽管 Silverlight 3 预计将向后兼容 Silverlight 2，但预计会遇到一些问题。转换向导做得很好，但您不能完全信任它。

您为什么不尝试一下，看看您的情况是否看起来很完美？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T04:41:55.170

从 Silverlight 3 和 Expression Blend 3 可用之日起（现在大约一个月），我一直在使用它们，并且没有遇到任何实际问题。我什至能够在紧要关头将一些 Silverlight 3 应用程序转换为 Silverlight 2 应用程序。

请注意，一旦升级到 Silverlight 3，您将无法再在您的计算机上创建 Silverlight 2 应用程序。这意味着您创建的任何应用程序只能由运行 Silverlight 3 测试版的其他人查看。

> 安装适用于 Visual Studio 的 Silverlight 3 Beta 工具后，您的开发环境将成为 Silverlight 3 Beta 环境。Visual Studio 2008 SP1 不支持 Silverlight 应用程序的多目标，因此一旦安装了这些工具，您将无法开发 Silverlight 2 应用程序。如果您仍需要开发 Silverlight 2 应用程序的能力，我们建议您在单独的环境中安装 Silverlight 3 Beta 工具。
> 
> 确保您已安装 Visual Studio 2008 SP1 或 Visual Web Developer Express 2008 SP1，因为它是适用于 Visual Studio 的 Silverlight 3 Beta 工具的先决条件。以下是您想要开始使用的其他工具：
> 
> [http://silverlight.net/getstarted/silverlight3/default.aspx](http://silverlight.net/getstarted/silverlight3/default.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T15:58:02.223

我发现了一个真正的问题： - ItemsControl 中的模板属性无法按预期工作。

我试图在运行时更改它。像这样的东西：

```
private void OnClickTemplate1(object sender, RoutedEventArgs e)
{
    ResourceDictionary rd = this.LayoutRoot.Resources;
    if (rd != null)
    {
        ControlTemplate ct = rd["Template1"] as ControlTemplate;
        if (ct != null)
        {
            this.itemscontrol.Template = ct;
        }
    }
} 
```

之后，所有项目都从 ItemsControl 中消失。Silverlight 2 中没有这样的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-05T07:55:22.503

看起来 Silverlight 3 将在下个月中旬（已提到 7 月 10 日）进入 RTW，因此您可能要等到那时再拿起已发布的版本。

就我而言，我发现测试版完全稳定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T14:25:34.757

我已经使用 SL3 几个星期了，没有遇到任何实际问题。我遇到的一些问题是，浏览器应用程序不支持程序集缓存，并且 ADO.NET 数据服务在浏览器之外不起作用（改用 .NET RIA 服务）。到目前为止，一切都很好！

# c++ - 如何使这个 Matrix 类更容易在调试器中使用

> ID：766172
> 
> 赞同：1
> 
> 时间：2009-04-19T21:49:32.760
> 
> 标签：c++, xcode, debugging, math

我写了一个 C++ 矩阵模板类。它由其尺寸和数据类型参数化：

```
template<int NRows, int NCols, typename T>
struct Mat {
    typedef Mat<NRows, NCols, T> MyType;

    typedef T value_type;
    typedef const T *const_iterator;
    typedef T *iterator;

    enum { NumRows = NRows };
    enum { NumCols = NCols };

    T m_data[NRows * NCols];

    // ... Lot's of operations and functions ...

// Some overloads
typedef Mat<2, 1, int> Vec2i;
typedef Mat<2, 1, float> Vec2f;
typedef Mat<3, 1, float> Vec3f;
typedef Mat<4, 1, unsigned char> Vec4ub;
typedef Mat<4, 4, float> Mat44f;
typedef Vec3f Vector;
typedef Vec4ub Color;
typedef Vec2f LonLat; 
```

这是一个很棒的小类，可以处理大量的向量算术和线性代数。此外，它能够轻松地与低级代码（OpenGL）和高级代码（PID 和卡尔曼滤波器）交互。

它的设计对我来说似乎是合理的，但这不是这个问题的意义所在。这个类有一个可怕的缺陷：**在调试器中使用它是一个可怕的问题**。

因为它是一个包含数组的结构，所以在 Xcode 中检查变量时总是存在一个烦人的间接级别（我假设在 VisualStudio 中）。Xcode 有时无法正确跟踪指针链并且我根本无法检查这些值，这一事实进一步加剧了这种情况。如果我有`vector`这些对象中的一个，就会发生这种情况。

我意识到我也许可以自定义调试器以某种方式与我的类型一起工作。但我想知道是否有

**存储矩阵数据的不同方式，使其具有更好的“可调试性”**？

这更像是一个“发挥你的想象力”类型的问题，而不是寻找最佳实践设计的问题。我只是好奇可以使用哪些替代类布局，同时仍保持代码的通用性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T22:16:30.183

这类 Matrix 类总是很难调试。与 Rick 不同，我更喜欢按照您拥有的方式构建数据（即 T m_data[NRows*NCols]），但您可能希望添加一些方法以使测试更容易一些；例如，自动打印矩阵的方法和在特定行和列查找数据的方法可以让您的生活更轻松：

```
void printMat() const;
void printMatToFile( const char *fileName ) const;
T &get(int row, int col); 
```

我通常使用 gdb 调试器，它允许您在调试时调用方法。我不知道你的调试器是否支持这个，所以你可能想尝试使用 g++/gdb 进行测试，或者一些在调试时支持函数调用的调试器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T02:08:48.753

XCode 允许您创建[自定义数据格式化程序](http://developer.apple.com/documentation/DeveloperTools/Conceptual/XcodeDebugging/600-Viewing_Variables_and_Memory/variables_and_memory.html#//apple_ref/doc/uid/TP40007057-CH9-SW24)，以便以您想要的任何方式格式化调试器中的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T21:54:04.683

你可以从改变这个开始：

```
T m_data[NRows * NCols]; 
```

对此：

```
T m_data[NRows][NCols]; 
```

这可能会对您有所帮助，因为它为调试器提供了有关数据结构的更多线索。请注意，如果您实施此修改，您可能会做一些需要更改/消失的数组索引数学运算。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T02:03:38.080

VisualStudio 为您的问题提供了一个很好的解决方案，[AutoExp.dat](http://www.codeguru.com/cpp/v-s/debug/article.php/c1281) 显然这对您没有帮助，因为您似乎没有使用 VisualStudio，但是对于那些使用 VS 的人，他们可以创建自定义表达式甚至函数来在调试器中显示数据。

# c# - 如何在 c#.net 中清除控制台？

> ID：766173
> 
> 赞同：5
> 
> 时间：2009-04-19T21:50:33.850
> 
> 标签：c#, wpf, console

只是。我在这里发现了一个类似的问题：[c#console, Console.Clear 问题](https://stackoverflow.com/questions/377927/c-console-console-clear-problem)

但这并没有回答问题。

更新 ：

Console.Clear() 抛出：IOException（句柄无效）

该应用程序是一个 WPF 应用程序。然而，写入控制台完全没有问题，读取也没有问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T22:24:35.843

`Console.Clear()`在控制台应用程序中工作。

`Console.Clear()`在 ASP.NET 网站项目或 Windows 窗体应用程序中调用时，您将收到 IOException。

你有什么样的应用程序？

更新：

我不确定这是否会有所帮助，但正如您在[此论坛帖子](http://www.eggheadcafe.com/conversation.aspx?messageid=31733751&threadid=31733751)中所读到的，如果控制台输出被重定向，`Console.Clear()`则会引发 IOException。也许这是 WPF 应用程序的情况？本文介绍如何检查控制台是否被重定向。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T21:52:21.740

尝试

```
Console.Clear(); 
```

**编辑**

您是否在非控制台应用程序上尝试此方法？如果是这样，那将解释错误。其他类型的应用程序、ASP.Net 项目、WinForms 等……实际上并不创建用于编写的控制台。所以 Clear 没有什么可以操作并抛出异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T21:52:35.703

Console.Clear() - 这相当于“cls”命令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T21:52:42.410

试试[`Console.Clear()`](http://msdn.microsoft.com/en-us/library/system.console.clear(VS.80).aspx)- 从 .NET 2.0 开始就可以使用它了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-25T00:25:06.617

你真的需要清除它吗？您还可以创建自己的“cls”命令，将 100 个空白行打印到控制台并使其“看起来”已清除。只是一个想法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-19T22:15:08.580

Console.Clear() 可以解决问题。它不应该抛出 IOException。如果是的话，还有其他事情你没有告诉我们，在这种情况下，你应该给我们看一些代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T02:42:46.723

[您是否使用了一些人为的方法，例如此处](https://stackoverflow.com/questions/160587/no-output-to-console-from-a-wpf-application)描述的显示控制台窗口的方法？我尝试创建一个 WPF 应用程序，然后在其属性 Project-> 中更改应用程序输出类型*属性...到控制台应用程序。一旦我这样做了，当我启动我的应用程序时会弹出一个控制台窗口，我可以写入它并调用 Console.Clear() 没有任何异常。[（这里](http://wpfwonderland.wordpress.com/2009/03/01/adding-console-window-to-wpf-application/)解释了基本思想，虽然我的属性 UI 与描述的略有不同）*

 *# sql - oracle计数语句问题

> ID：766189
> 
> 赞同：0
> 
> 时间：2009-04-19T21:55:56.880
> 
> 标签：sql, oracle10g

希望有人可以帮助解决我在 oracle 中构建查询时遇到的问题。

我是oracle的新手，尽管我对sql知之甚少-

这是一个电影院预订系统场景 - 我试图让下面的 sql 输出一行，这是在特定电影院中为特定表演售出的门票总数。虽然它列出了所有 12 次出现，但我已经得到了如下信息，当我想说 12 票已售出等时。

我最初在查询生成器中构建了它，然后手动添加了计数和分组。

任何想法都非常感谢我如何实现这一目标，或者我可能会出错的地方。

感谢您的关注。

```
select count(ticket.ticket_id) as tickets_sold, "PERFORMANCE"."PERFORMANCE_DATE" as "PERFORMANCE_DATE",
     "FILM"."FILM_TITLE" as "FILM_TITLE",
     "TICKET"."TICKET_ID" as "TICKET_ID",
     "CINEMA"."LOCATION" as "LOCATION",
     "PERFORMANCE"."PERFORMANCE_TIME" as "PERFORMANCE_TIME" 
 from    "TICKET" "TICKET",
     "RESERVATION" "RESERVATION",
     "PERFORMANCE" "PERFORMANCE",
     "RUN" "RUN",
     "SCREEN" "SCREEN",
     "CINEMA" "CINEMA",
     "FILM" "FILM" 
 where   "PERFORMANCE"."PERFORMANCE_ID"="RESERVATION"."PERFORMANCE_ID"
 and     "PERFORMANCE"."RUN_ID"="RUN"."RUN_ID"
 and     "RUN"."FILM_ID"="FILM"."FILM_ID"
 and     "RUN"."SCREEN_ID"="SCREEN"."SCREEN_ID"
 and     "SCREEN"."CINEMA_ID"="CINEMA"."CINEMA_ID"
 and     "TICKET"."RESERVATION_ID"="RESERVATION"."RESERVATION_ID"
  and    "PERFORMANCE"."PERFORMANCE_DATE" ='1-mar-09' 
   and   "FILM"."FILM_TITLE" ='PIRATES OF THE CARIBBEAN - AT WORLDS END' 
   and   "CINEMA"."LOCATION" ='bradfordeast' 
   and   "PERFORMANCE"."PERFORMANCE_TIME" ='20:00' group by reservation.performance_id, performance.performance_date, film.film_title, ticket.ticket_id,cinema.location, performance.performance_time order by tickets_sold DESC; 
```

输出：

```
TICKETS_SOLD PERFORMANCE_DATE FILM_TITLE TICKET_ID LOCATION PERFORMANCE_TIME 

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 485 bradfordeast 20:00

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 488 bradfordeast 20:00

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 484 bradfordeast 20:00 

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 491 bradfordeast 20:00

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 493 bradfordeast 20:00 

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 495 bradfordeast 20:00

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 489 bradfordeast 20:00

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 487 bradfordeast 20:00 

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 490 bradfordeast 20:00 

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 492 bradfordeast 20:00 

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 494 bradfordeast 20:00 

1 01-MAR-09 PIRATES OF THE CARIBBEAN - AT WORLDS END 486 bradfordeast 20:00 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T23:08:20.823

`ticket_id`同时包含和`COUNT(ticket_id)`when you是没有意义的`GROUP BY ticket_id`。

我推断您的架构具有如下关系：

```
TICKETS --> RESERVATION --> PERFORMANCE --> RUN --> SCREEN --> CINEMA
                                   FILM --> RUN 
```

看起来您想要的报告可以描述如下：

> 计算每部电影的门票、演出日期和时间以及电影院的位置。

在使用-list 中的列与列表中的列匹配的任何查询中，这一点很重要`GROUP BY`（聚合函数中的列除外，例如）。这称为**单值规则**，它在标准 SQL 中强制执行。这些将是报告描述中“per”之后的列。`SELECT``GROUP BY``COUNT()`

 **这是我编写查询的方式：

```
SELECT COUNT(t."TICKET_ID") AS tickets_sold, 
 f."FILM_TITLE",
 c."LOCATION",
 p."PERFORMANCE_DATE",
 p."PERFORMANCE_TIME",
FROM "TICKET" t,
 JOIN "RESERVATION" r ON (r."RESERVATION_ID" = t."RESERVATION_ID") 
 JOIN "PERFORMANCE" p ON (p."PERFORMANCE_ID" = r."PERFORMANCE_ID")
 JOIN "RUN" run ON (run."RUN_ID" = p."RUN_ID")
 JOIN "SCREEN" s ON (s."SCREEN_ID" = run."SCREEN_ID")
 JOIN "CINEMA" c ON (c."CINEMA_ID" = s."CINEMA_ID")
 JOIN "FILM" f ON (f."FILM_ID" = run."FILM_ID")
WHERE p."PERFORMANCE_DATE" ='1-mar-09'
 AND f."FILM_TITLE" ='PIRATES OF THE CARIBBEAN - AT WORLDS END' 
 AND c."LOCATION" ='bradfordeast' 
 AND p."PERFORMANCE_TIME" ='20:00'
GROUP BY f."FILM_TITLE", c."LOCATION", p."PERFORMANCE_DATE", p."PERFORMANCE_TIME" 
ORDER BY tickets_sold DESC; 
```

请注意，我使用了标准`JOIN`语法，将连接条件移动到`ON`子句中。该`WHERE`子句仅包括查询限制。从逻辑上讲，查询的结果没有区别，但为了清楚起见，我更喜欢让连接条件靠近`FROM`子句中的各个表。

我还使用单字母表别名来使内容更具可读性（除了`r`因为`run`它们都以 r 开头）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T22:07:09.927

您需要从组子句中排除“ticket.ticket_id”（这个唯一值使不必要的组 - 结果字符串）：

```
select count(ticket.ticket_id) as tickets_sold, "PERFORMANCE"."PERFORMANCE_DATE" as "PERFORMANCE_DATE",
         "FILM"."FILM_TITLE" as "FILM_TITLE",
         "TICKET"."TICKET_ID" as "TICKET_ID",
         "CINEMA"."LOCATION" as "LOCATION",
         "PERFORMANCE"."PERFORMANCE_TIME" as "PERFORMANCE_TIME" 
     from    "TICKET" "TICKET",
         "RESERVATION" "RESERVATION",
         "PERFORMANCE" "PERFORMANCE",
         "RUN" "RUN",
         "SCREEN" "SCREEN",
         "CINEMA" "CINEMA",
         "FILM" "FILM" 
     where   "PERFORMANCE"."PERFORMANCE_ID"="RESERVATION"."PERFORMANCE_ID"
     and     "PERFORMANCE"."RUN_ID"="RUN"."RUN_ID"
     and     "RUN"."FILM_ID"="FILM"."FILM_ID"
     and     "RUN"."SCREEN_ID"="SCREEN"."SCREEN_ID"
     and     "SCREEN"."CINEMA_ID"="CINEMA"."CINEMA_ID"
     and     "TICKET"."RESERVATION_ID"="RESERVATION"."RESERVATION_ID"
      and    "PERFORMANCE"."PERFORMANCE_DATE" ='1-mar-09' 
       and   "FILM"."FILM_TITLE" ='PIRATES OF THE CARIBBEAN - AT WORLDS END' 
       and   "CINEMA"."LOCATION" ='bradfordeast' 
       and   "PERFORMANCE"."PERFORMANCE_TIME" ='20:00'
group by reservation.performance_id, performance.performance_date,
film.film_title, ticket.ticket_id,cinema.location, performance.performance_time
order by tickets_sold DESC; 
```

# html - 将 SWF 添加到基于 HTML 的 AIR 应用程序

> ID：766190
> 
> 赞同：0
> 
> 时间：2009-04-19T21:57:47.453
> 
> 标签：html, actionscript-3, air, adobe, flash

我正在玩一个基于 HTML 的小 Adob​​e AIR 项目，我想将现有的 SWF 添加到项目中。现在，我可以看到它通过来自 SWF 的跟踪/日志消息运行，但我似乎无法调用 SWF 中的任何函数。我读到 ExternalInterface 函数在 Air 容器中不可用，如果在浏览器中使用，它看起来是正确的。

Adobe 站点上的大多数示例都是 HTML，或者都是 Flex/ActionScript。有没有人试图成功地将这些组合在一起，无论是作为源代码还是通过编译的 SWF？

非常感谢

罗比

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T22:53:44.807

使用已编译的 swf 存在沙盒问题。

也许您可以使用LocalConnection？[这是一个例子](http://blog.everythingflex.com/2008/01/11/more-fun-with-air-localconnection-source-included/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T22:11:05.603

这基本上是我需要的：

[http://help.adobe.com/en_US/AIR/1.5/devappshtml/WS5b3ccc516d4fbf351e63e3d118666ade46-7ed9.html](http://help.adobe.com/en_US/AIR/1.5/devappshtml/WS5b3ccc516d4fbf351e63e3d118666ade46-7ed9.html)

但是，我的情况很复杂，因为事实证明我的 SWF 有一个嵌入式 SWF，而我试图访问嵌入式 SWF 中的一个类。一旦我尝试访问包装 SWF 中的一个类，一切都很顺利。

干杯

罗比

# batch-file - 使用批处理脚本安装 nant

> ID：766191
> 
> 赞同：1
> 
> 时间：2009-04-19T21:58:48.027
> 
> 标签：batch-file, nant, environment-variables

我有一个 nant 构建文件，许多用户必须在本地运行。有没有一种简单的方法可以自动化在 Windows 系统上安装 nant/nantcontrib 和更新匹配的环境变量的过程。

我想出了一个解决方案，将包含 nant/contrib 文件和批处理脚本的文件夹复制到每个站。执行批处理脚本时，应将 nant dll 复制到有意义的完整位置，并且应更新 env varialbes。

这是解决这个问题的正确方法吗？

谢谢/礼服

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T22:29:23.990

我通常将 NAnt 与源代码一起检查到存储库中，然后将几个批处理文件用于各种目标。我知道这并不能完全回答您的问题，但它可能解决了根本问题。

编辑回复：评论

我的目录结构如下所示：

```
/src
/lib
/tools/nant
/project.sln
/project.build
/build.bat
/deploy.bat 
```

# c# - 如果有多个满足委托标准的方法，委托将指向哪个函数？

> ID：766195
> 
> 赞同：0
> 
> 时间：2009-04-19T22:01:40.470
> 
> 标签：c#

委托是一个函数指针。所以它指向一个满足条件（参数和返回类型）的函数。

这就引出了一个问题（无论如何对我来说），如果有多个方法具有完全相同的返回类型和参数类型，那么委托将指向什么函数？是类中最先出现的函数吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T22:03:55.877

创建委托时会指定确切的方法。

```
public delegate void MyDelegate();

private void Delegate_Handler() { }

void Init() {
  MyDelegate x = new MyDelegate(this.Delegate_Handler);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T22:12:46.230

正如 Henk 所说，该方法是在您创建委托时指定的。现在，满足要求的方法可能不止一种，原因有二：

*   委托是变体，例如，您可以使用带有`Object`参数的方法来创建`Action<string>`
*   您可以通过使它们泛型来重载方法，例如

    ```
    static void Foo() {}
    static void Foo<T>(){}
    static void Foo<T1, T2>(){} 
    ```

规则变得相当复杂，但它们在 C# 3.0 规范的第 6.6 节中有规定。请注意，继承也使事情变得棘手。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T22:32:21.193

> 所以它指向一个满足条件（参数和返回类型）的函数。

没有。

为 Henk 的回答添加一些背景知识：
就像`int x`一个可以包含整数的变量一样，委托是一个可以包含函数的变量。

它指向您告诉它指向的任何功能。
例如：

```
// declare the type of the function that we want to point to
public delegate void CallbackHandler(string); // 

...

// declare the actual function
public void ActualCallbackFunction(string s){ ... }

...
// create the 'pointer' and assign it
CallbackHandler functionPointer = ActualCallbackFunction;
// the functionPointer variable is now pointing to ActualCallbackFunction 
```

# c# - 在标签中显示百分比

> ID：766196
> 
> 赞同：2
> 
> 时间：2009-04-19T22:01:44.837
> 
> 标签：c#, label, rounding

我正在开发一个 C# Windows 应用程序。我的表单上有一个标签，我想显示一个计算。这是我的代码：

```
this.lblPercent.Text = (Convert.ToString(totalPercent)); 
```

我将变量 totalPercent 定义为双精度，如何将此数字四舍五入到小数点后 2 位？

当我运行我的程序时，86.8245614 显示在我的应用程序中，我希望它显示 86.82。

苏珊

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T22:11:43.817

或者：`String.Format("{0:0.00}", totalPercent);`

有关如何以不同方式格式化数字的一些示例，请参见[此处](http://www.csharp-examples.net/string-format-double/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T22:03:01.840

这里是四舍五入的方法。

[http://msdn.microsoft.com/en-us/library/75ks3aby.aspx](http://msdn.microsoft.com/en-us/library/75ks3aby.aspx)

`lblPercent.Text = Math.Round(totalPercent, 2).ToString();`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T22:11:07.077

您可能正在寻找[这个](http://msdn.microsoft.com/en-us/library/aa331875(VS.71).aspx)：

```
public static string Format(string format, object arg0) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T22:33:12.343

你可以试试这个

' 获取与 en-US 区域性关联的 NumberFormatInfo。
Dim nfi As NumberFormatInfo = New CultureInfo("en-US", False).NumberFormat

this.lblPercent.Text = totalPercent.ToString("P", nfi)

[http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.numbergroupseparator(vs.71).aspx](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.numbergroupseparator(vs.71).aspx)

# subsonic - 在哪里提交 Subsonic 补丁？

> ID：766197
> 
> 赞同：1
> 
> 时间：2009-04-19T22:01:55.213
> 
> 标签：subsonic, patch

我刚刚为 Subsonic 2.1 发现了一个问题，我为其创建了一个补丁。我该去哪里提交补丁？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T22:08:15.977

[http://code.google.com/p/subsonicproject/issues/list](http://code.google.com/p/subsonicproject/issues/list)

确保它仍然是 2.2 中的错误。

编辑：一年多过去了，我的回答已经过时了。谷歌代码站点不再使用，尽管它可能永远存在...... Subsonic 2.2 在[github 上](http://github.com/subsonic/SubSonic-2.0)，但提交错误报告或尝试接受分支拉取请求确实没有意义。这是一个死项目......只是一个观察，而不是火焰。真的没有社区了，这是一种耻辱。

# subsonic - 亚音速 REST 404 错误

> ID：766201
> 
> 赞同：0
> 
> 时间：2009-04-19T22:02:45.227
> 
> 标签：subsonic, rest

我正在尝试将 REST 接口与 Subsonic 一起使用，但没有任何运气。

我在 web.config 中有这个

```
<httpHandlers>
      <add type="SubSonic.WebUtility.RESTHandler, Subsonic" path=".xml" verb="*"/>
</httpHandlers> 
```

并且只是为了测试我有一个具有此功能的 Subsonic 版本，它工作正常（没有做任何事情，但我得到了 Intellisense 并且它编译得很好）：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    Dim dr As New SubSonic.WebUtility.RESTHandler

End Sub 
```

但是当我尝试像[http://localhost:59271/CBVA35/schedule/list.xml](http://localhost:59271/CBVA35/schedule/list.xml)这样的 URL 时，我收到 404 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T23:15:22.790

您需要将“xml”路由到其余处理程序：

```
<httpHandlers>
<add verb="*" path="*.xml" type="SubSonic.WebUtility.RESTHandler, Subsonic"/> 
```

[http://subsonicproject.com/tips-and-tricks/webcast-using-subsonic-s-rest-handler/](http://subsonicproject.com/tips-and-tricks/webcast-using-subsonic-s-rest-handler/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T14:31:44.083

我遇到了同样的问题——使用 ASP.NET 开发 Web 服务器运行良好，但在 IIS 中无法运行。除了 Rob 提到的之外，我还必须配置 IIS 映射以接受其他文件类型。有关详细信息，请参阅此处的评论：

[http://www.swindelles.com/ed/2008/07/22/creating-rest-web-services-in-c-sharp-2/](http://www.swindelles.com/ed/2008/07/22/creating-rest-web-services-in-c-sharp-2/)

# bash - 如何通过 bash shell 转义 SQLite 中的字符？

> ID：766207
> 
> 赞同：7
> 
> 时间：2009-04-19T22:04:11.087
> 
> 标签：bash, sqlite, shell, command-line, escaping

我正在尝试使用 bash 从命令行向 SQLite 发送查询。我需要同时转义单引号和双引号，并转义它们，以便 bash 不会误解它们。这是一个典型的查询：

```
select * from contacts where source = "Nancy's notes"; 
```

如何从命令行发送此查询？基本语法是这样的：

```
sqlite3.bin contacts.db 'select * from contacts where source = "Nancy's notes"' 
```

但在这种情况下，shell 会误解单引号或双引号。我尝试使用双斜杠和三斜杠进行转义，但这不起作用。我很困惑。有什么建议么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-19T22:53:28.677

MarkusQ 解决方案的问题在于知道双引号中哪些字符是特殊的——它们有很多，包括反引号、美元开括号、美元变量等。

我建议最好将字符串括在单引号内；然后，字符串中的每个单引号都需要替换为序列引号、反斜杠、引号、引号：

```
sqlite3.bin contacts.db 'select * from contacts
      where source = "Nancy'\''s notes"' 
```

替换中的第一个引号终止当前的单引号字符串；反斜杠引号代表一个文字单引号，最后一个引号开始一个新的单引号字符串。此外，这通常适用于 Bourne、Korn、Bash 和 POSIX shell。（C Shell 及其衍生版本有更复杂的规则，需要反斜杠来转义换行符，等等。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T22:27:20.703

如果 bash 是您唯一的问题，请将整个内容用双引号括起来，然后用一个反斜杠转义 bash 双引号中的任何特殊内容。例如：

```
sqlite3.bin contacts.db "select * from contacts where source = \"Nancy's notes on making \$\$\$\"" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T15:41:34.293

在这里，我使用了两个单引号，sqlite 将其解释为一个。

```
sqlite3.bin contacts.db "select * from contacts where source = 'Nancy''s notes on making \$\$\$'" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-21T21:31:58.263

```
foo_double_single_quote=`echo ${foo_with_single_quote} | sed "s/\'/\'\'/"g`

sqlite3 "INSERT INTO bar_table (baz_colname) VALUES ('${foo_double_single_quote}');" 
```

如果您有一个变量`foo_with_single_quote`，其内容要插入到数据库中，您可以`sed`像这样使用创建一个变量，该变量`'`根据需要复制字符。

# asp.net-mvc - 我应该如何在 ASP.NET MVC 中命名我的模型？对书呆子晚餐感到困惑

> ID：766212
> 
> 赞同：3
> 
> 时间：2009-04-19T22:07:53.777
> 
> 标签：asp.net-mvc, business-logic, nerddinner

我正在学习 ASP.NET MVC，我喜欢它。但是，我对为模型命名空间的正确方法感到非常困惑。

在剖析 NerdDinner 示例应用程序时，我注意到 Models 文件夹中的所有内容都属于 Models 命名空间。数据映射类、存储库、错误规则管理等属于同一个命名空间级别。

我知道这个文件夹的灵感来自于 Rails 和朋友等框架，并且需要证明 MVC 标题中的 M 是正确的，但是；自动模型命名空间不会破坏编写可跨不同系统和实现可拆卸和可移植的业务逻辑的任何机会吗？

我应该在此模型命名空间下命名我的业务逻辑，还是应该完全忽略它并以更独立于框架的方式对我的类进行分类？

是否有任何复杂而优秀的 ASP.NET MVC 示例应用程序可以证明这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T01:56:55.490

我会以对你最有意义的方式对你的类进行分类，我怀疑他们在 Nerd Dinner 示例应用程序中使用了该命名空间，因为从学习的角度来看，开发人员总是看到它们在模型中是件好事应用程序的一部分。

就我个人而言，我不会在 Model 文件夹中放置任何东西，而是为我的实体 (App.Domain) 和域服务 (App.Services) 创建单独的项目。我还为这两个项目创建了 .Tests 项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T17:07:56.253

我的开发意识告诉我，我们应该将我们的数据模型完全重构到另一个项目中。有些甚至在另一个项目中创建您的业务实体，并让它们由 Linq-Sql 类构成。

我认为 Scott 和 Co. 会采取至少将数据模型与表示层分离的方式。我们都知道关注点分离的好处，但他们将数据模型保存在 MVC 应用程序中的方式让我感到困惑。

关于更分层的方式还有更多建议吗？

# css - 有没有办法在 CSS 中指定溢出？

> ID：766213
> 
> 赞同：0
> 
> 时间：2009-04-19T22:07:58.957
> 
> 标签：css, html, scroll, positioning

我在我的设计中使用了很多`position:relative;`，我只是发现它是把所有东西放在我需要的地方最简单的方法。

但是，我在我的网站上添加的项目越多（每个项目都有自己的`div`)，每个项目最终都会在我的页面底部越来越远，所以我必须手动将它们定位得更高。

这在底部留下了很多空白空间，我认为添加`height: 1000px;`会限制滚动，但这种方法似乎不起作用。

我什至尝试添加`height: 1000px;`到包装器中，但它仍然无法正常工作。

如何将垂直滚动限制为我选择的像素数？

提前非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T22:13:38.007

等等，所以你正在创建一个 div，使用相对位置将 div 的内容移动到正确的位置，问题是 div 标签本身仍然在同一个地方并创建一个垂直滚动，即使没有内容那里？

如果是这样，您应该研究浮动。

这里有一些教程。

*   [浮动教程](http://css.maxdesign.com.au/floatutorial/)
*   [十步学习 CSS 定位](http://www.barelyfitz.com/screencast/html-training/css/positioning/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T22:13:25.247

您可以指定高度和溢出：

```
.someClass
{
    height:1000px;
    overflow:scroll;
} 
```

最常见的溢出值是滚动、自动和隐藏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T22:13:47.820

为了限制某人可以滚动的距离，我认为您需要使用 JavaScript。我不知道怎么做，但我想不出 CSS 中有什么可以做到这一点。

如果您希望设置何时应该滚动而不是仅仅被切断或扩展标签，请使用`overflow:auto;`.

# air - 它如何制作.air，我已经尝试过adl和adt，但它对我不起作用

> ID：766219
> 
> 赞同：1
> 
> 时间：2009-04-19T22:11:05.423
> 
> 标签：air, adobe

我下载了最后一个 AIR SKD，我使用的是 Windows Vista。我试图在 Adob​​e air 中创建一个 helloworld，但它不工作//

我应该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T07:02:00.763

只是一个提示，使用[Aptana](http://www.aptana.com/)进行 AIR 开发，它具有调试、打包、徽章创建等功能，而且最重要的是，它是免费的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T22:45:19.727

[这是相关文档。](http://help.adobe.com/en_US/AIR/1.5/devappsflex/WS5b3ccc516d4fbf351e63e3d118666ade46-7fd6.html)

使用**广告**。

# flash - flash cs3组件问题

> ID：766222
> 
> 赞同：0
> 
> 时间：2009-04-19T22:12:14.283
> 
> 标签：flash, components, cs3, swc

我一直在为我的新 Flash 游戏使用基于自定义 swc 的组件。当我决定更新一些占位符图形时，我几乎完成了引擎开发。我做了必要的更改，却发现我的组件无法编译。我觉得这很奇怪，因为我只是更新了图形和显示新图形所需的一些非必要代码。也许我改变了一个设置......？我修复了编译器报告的问题并导出了新的 swc 文件。成功。我重新加载了组件面板并将其拖到舞台上……结果却发现了一个空组件！该组件甚至没有在我的库中注册。它只是消失了！有什么建议么？顺便说一句，它在as3中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T15:13:38.410

我解决了这个问题。我使用 FLINT 来显示一些粒子，包含这个库导致我的组件编译不正确。我不知道为什么会这样，这似乎是 flash cs3 的一个小故障。好像cs3里面的组件很匆忙，因为我之前也遇到过类似的问题。我只希望这是我遇到的最后一个...

# c# - C#语音识别VISTA问题

> ID：766223
> 
> 赞同：0
> 
> 时间：2009-04-19T22:12:41.753
> 
> 标签：c#, speech-recognition

尝试运行项目时出现以下错误：

```
A timeout occurred starting the SAPI Server.

System.InvalidOperationException was unhandled
Message="A timeout occurred starting the SAPI Server."
Source="System.Speech"
StackTrace:
at System.Speech.Internal.SapiInterop.SapiRecognizer..ctor(RecognizerType type)
at System.Speech.Recognition.SpeechRecognizer..ctor()
at testdan.Form1..ctor() in C:\Users\Dany\Documents\Visual Studio 2008\Projects\testdan\testdan\Form1.cs:line 17
at testdan.Program.Main() in C:\Users\Dany\Documents\Visual Studio 2008\Projects\testdan\testdan\Program.cs:line 18
at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
at System.Threading.ThreadHelper.ThreadStart() 
```

表格 1 代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Speech.Recognition;
using System.Threading;

namespace testdan
{
    public partial class Form1 : Form
    {
        SpeechRecognizer rec = new SpeechRecognizer();

        public Form1()
        {
            InitializeComponent();
            rec.SpeechRecognized += new EventHandler<SpeechRecognizedEventArgs>(rec_SpeechRecognized);
        }

        void rec_SpeechRecognized(object sender, SpeechRecognizedEventArgs e)
        {

            lblLetter.Text = e.Result.Text;
            MessageBox.Show(e.Result.Text);
        }

        void Form1_Load(object sender, EventArgs e)
        {
            var c = new Choices();
            c.Add("close");
            c.Add("stop");
            c.Add("pause");
            var gb = new GrammarBuilder(c);
            var g = new Grammar(gb);
            rec.LoadGrammar(g);
            rec.Enabled = true;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-05T18:24:49.343

WSR UI 需要多长时间才能显示出来？我怀疑可能发生的情况是 WSR UI 的显示时间比平时要长，并且代理正在超时。

您可以尝试捕获异常并重试构造函数。幸运的是，WSR UI 仍然会启动，您将能够完成构造函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-10T23:23:29.183

我也看到了。如果我从开始菜单手动启动桌面识别器然后运行它工作正常的代码，但它似乎没有自动加载共享识别器 - 我不知道为什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T06:50:31.370

也许缺少 SAPI 使用的驱动程序？这可能会导致它在加载期间超时。

# java - Java中的“else if”是一个完整的关键字还是两个单独的关键字？

> ID：766238
> 
> 赞同：5
> 
> 时间：2009-04-19T22:18:15.953
> 
> 标签：java

我碰巧阅读了[SCJP](http://www.sun.com/training/certification/java/scjp.xml)认证的练习材料，我刚刚翻阅了 flow control et al 的一章，他们给人的印象是“ `else if`”本身就是一个关键字。我一直认为它只是一个普通的`else`，只包含一个`if`块，省略了大括号。

那么，它是什么？

*编辑：*我想强调的是，这个问题更多地属于“激起我的兴趣”类别，而不是“严肃的业务”类别。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-19T22:24:30.477

是的，它们是两个独立的关键字[——Java 语言规范](http://java.sun.com/docs/books/jls/)没有指定`else if`关键字。正如这里的其他海报所说，它实际上是`if`包含在声明中的`else`声明。

编辑：许多培训/教育材料似乎暗示这`else if`实际上是一个关键字（实际上，它通常被视为关键字），但我倾向于认为这更多是为了清晰/简单，与牺牲精度的后果。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-19T22:20:52.170

这将是两个单独的关键字，由两个单词之间的空格表示。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-19T22:21:58.127

它实际上说

```
else {
    if { ... }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-19T22:26:57.693

是两个关键词。

**else**后面可以跟一个块或单个语句。

在**else if**的情况下。该语句是另一个**if**语句。

**更新**

值得一提的是**else if**是深度嵌套**if**语句的常见样式选择，并且使这种情况比嵌套更具可读性。除非我需要**switch**语句可能的失败行为，否则我使用**else if**代替。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T22:26:30.473

我相信两个单独的关键字。但我很肯定，如果没有 if ，你就不能**拥有****else**。

 **[Java 词法结构](http://java.sun.com/docs/books/jls/third_edition/html/lexical.html#229308)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-09T18:29:00.343

虽然某些语言确实将“elsif”、“elseif”或“else if”作为单独的语句（有点像“case”语句），但 Java 不是其中之一。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-19T22:23:38.873

我不是 Java 专家，但在 C 中它肯定被定义为两个不同的关键字，Java 从 C 语法的那部分偷走了相当多的东西。

无论如何，除了考试中的愚蠢问题之外，它永远不会在实践中产生影响。无论哪种方式，效果都是相同的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-19T22:26:13.033

如果你用调试器打开你的程序集，你会认出它是一个“if”语句。

# c# - 专业开发人员通常应该避免使用 .Net 框架的哪些组件？

> ID：766257
> 
> 赞同：8
> 
> 时间：2009-04-19T22:27:10.970
> 
> 标签：c#, .net, vb.net

.Net 是一个巨大的框架，具有一些功能，这些功能似乎针对初学者，如果涉及大量定制，就会出现问题。那么，您认为专业开发人员应该避免使用 .Net 框架中的哪些功能，为什么？

例如，.Net 有一个用于常用用户管理功能的向导。使用此功能是否适合专业用途或仅限初学者？

**请每个答案一个组件/功能/类等，**因此投票特定于单个项目。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-19T22:29:17.283

类型化数据集
ASP.NET *View 控件
ASP.NET *DataSource 控件

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-19T23:13:20.813

微软阿贾克斯

jquery 和其他 js 框架（如原型等）是更轻量级和更灵活的替代方案。MS Ajax 控件最初可能看起来很棒，直到您确实需要超出控件范围的自定义行为。

微软自己在某种程度上已经认识到这一点，因为 jquery 将与即将推出的 Visual Studio 版本捆绑在一起，并提供智能感知支持。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-19T22:42:28.343

我认为通常大多数“在幕后”做大量工作的控件/功能都会造成很多麻烦。*如果该布局正是*您想要的，那么使用 GridView 没问题- 但它很少是这样的，Repeater 可能是更好的选择。如果您希望网站具有 ajaxy 的感觉，UpdatePanels 可以为您节省大量工作，但与 jQuery AJAX 调用相比，它们 - 抱歉这么说 - 很糟糕。您提到的用户向导在开发过程中非常有用，但如果项目中需要成员资格功能，则应将其构建为项目的集成部分。

总而言之：专业程序员应该自己完成工作并编写专门满足客户需求的代码，并且仅在他们确实需要时才采用 .Net 框架的现成部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T23:22:16.190

链接到 XML

XmlDocument/Xpath 更易于使用，如果您想使用强类型来解析文档，请使用[xsd.exe](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.71).aspx)或[Xsd2Code](http://www.codeplex.com/Xsd2Code)。

***编辑***

你更倾向哪个 ？

```
IEnumerable<XElement> partNos =
    from item in purchaseOrder.Descendants("Item")
    where (int) item.Element("Quantity") *
        (decimal) item.Element("USPrice") > 100
    orderby (string)item.Element("PartNumber")
    select item; 
```

或者，使用 XmlDocument 和 XPath

```
var nodes = myDocument.SelectNodes("//Item[USPrice * Quantity > 100]"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T22:38:50.863

线程中止

这是 Ian Griffiths 撰写的一篇关于[为什么 Thread.Abort 是邪恶](http://www.interact-sw.co.uk/iangblog/2004/11/12/cancellation)的优秀文章以及一些更好的替代方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T03:51:20.397

远程处理通常是一个很好的避免，至少如果您的目标是 3.0 或更高版本，因此可以轻松地在进程中托管消息传递端点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T06:03:59.420

There is lots to avoid in the WinForms library.

Avoid DataBinding to most standard WinForms controls. There are many bugs in that area which will lead to lots of head scratching. Or at least that has been my experience. NumericUpDown is a good example of this buggy mess.

Also avoid the standard WinForms controls when dealing with large datasets. They do a lot of data copying and can't deal well with large datasets.

Avoid ListView in "Virtual" mode as it is full of bugs.

In general I just recommend staying away from WinForms. If you have the option go for WPF or at least buy a good, well supported (and hopefully less buggy) 3rd party forms library.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T02:27:55.883

> .Net 是一个巨大的框架，具有一些功能，这些功能似乎针对初学者，如果涉及大量定制，就会出现问题。

真正的问题是“似乎针对初学者”。

类型化数据集就是一个很好的例子。VS 为功能提供了一个很好的简单 UI，只有构建极其简单的演示应用程序的初级初学者和了解 ADO.NET 对象模型的每一个细微差别以及类型化数据集实际在做什么的经验丰富的专业人员才能使用。介于这两个极端之间的任何人都不应触及它，因为有一种很好的方法可以了解 ADO.NET 对象模型和类型化数据集的每一个细微差别，不是吗。

或者采取 LINQ。如果没有很好地理解`IEnumerable<T>`. 但是如果没有这些知识，编写可维护的 LINQ 代码并不是那么容易。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-20T03:41:48.810

您可以将 .NET 视为具有多层的洋葱。例如，.NET[紧凑框架](http://msdn.microsoft.com/en-us/netframework/aa497273.aspx)是完整 .NET 的子集。此外，在 .NET 上还有以“扩展”形式存在的“额外”层，它们是尚未成为 .NET 的一部分的新功能的可选安装。这方面的一个例子是微软发布的[ASP.NET 3.5 Extensions](http://weblogs.asp.net/scottgu/archive/2007/12/09/asp-net-3-5-extensions-ctp-preview-released.aspx)现在已经被整合到 .NET 3.51 中。

将 .NET 视为一组可以使用的“库”的另一种方式。例如，有一组或例程支持 RegEx。如果您想要或需要正则表达式，那么您可以使用这些函数，如果没有，您可以简单地忽略它们。类似三角函数或安全性的函数。

所以我想这真的归结为你的应用程序需要什么？如果您正在进行科学编程，您可能需要三角函数。图形应用程序需要控制台应用程序不需要的功能。Web 应用程序可能不需要使用剪贴板功能等。

我真的不认为 .NET 中有任何不好的 API，只是程序员以不恰当的方式使用它们。

# asp.net-mvc - ASP.NET MVC - 通过传递一些数据重定向到控制器/动作

> ID：766258
> 
> 赞同：1
> 
> 时间：2009-04-19T22:27:15.573
> 
> 标签：asp.net-mvc

我在不同的控制器中有操作，需要在执行前检查某些条件。如果不满足条件，我希望用户被重定向到另一个页面，其中包含有关下一步操作的说明（说明将包含用户必须遵循的链接）。

例如 SendMessage() 动作位于消息控制器中：

```
public ActionResult SendMessage()
{
    // check if user has enough credit
    if (!hasEnoughCredit(currentUser))
    {
        // redirect to another page that says:

        // "You do not have enough credit. Please go to LinkToAddCreditAction
        // to add more credit."
    }

    // do the send message stuff here 
} 
```

我想在需求控制器中有一个名为 ShowRequirements() 的通用操作。

在 SendMessage() 操作中，我想设置要显示给用户的消息，然后将用户转发到 ShowRequirements() 操作。我只是不希望消息出现在 ShowRequirements 操作的 URL 中。

有没有办法将此数据传达给 ShowRequirements() 操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T22:31:13.457

你可以把它放在 TempData["message"] 中，它被传递给被重定向到的新动作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T23:59:02.310

好吧，我想我弄错了。正如 John 和 Andrew 提到的，我只需通过 ViewData 将数据传递给视图。

所以我在/views/Shared 中做了一个RequirementsPage.aspx。现在，无论我采取何种行动，我都会填写 ViewData 字典并将其传递给 RequirementsPage.aspx，如下所示：

```
public ActionResult SendMessage()
{
    // check if user has enough credit
    if (!hasEnoughCredit(currentUser))
    {
        // redirect to another page that says:
        ViewData["key1"] = "some message";
        ViewData["key2"] = "UrlToTheAction";
        return View("RequirementsPage");
    }

    // do the send message stuff here 
} 
```

# windows - 为开发团队升级工作站的技巧？

> ID：766271
> 
> 赞同：2
> 
> 时间：2009-04-19T22:32:58.320
> 
> 标签：windows

我已经获得了升级个人工作站和笔记本电脑的预算。虽然更新、更大的屏幕受到热烈欢迎，但一想到重新安装工具和设置，他们中的大多数人就脸色发白，我得到了一个“我真的必须这样做吗？”。

当您迁移到新机器时，您通常有多少停机时间？

您是否使用工具或脚本专门为 Windows 环境设置开发环境、工具、数据库、调试器等？

您是否保留了一个标准图像，然后让开发人员进入并根据需要调整机器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T02:49:52.650

我的公司基本上是虚拟化的，以便停止在升级/系统故障上浪费这么多时间。

每当台式机/笔记本电脑出现故障时，我们都必须花费一天的大部分时间来修复它并重新加载软件。

所以，我们出去，为每个人买了 iMac，并在上面加载了[Parallels](http://www.parallels.com)（一种适用于 OSX 的类似 VMware 的产品）。然后我们为每个人制作了一个标准的开发镜像，然后将它复制到每个人的机器上。

本质上，如果有人的配置搞砸了，我们只需加载一个新的图像并继续使用卡车。节省了很多时间。

一些额外的好处：

1.  当新软件发布时，我们只需制作一个新图像并分发它。不是操作系统重新安装或类似的东西。
2.  如果硬件发生变化，没关系，只需移动图像即可。
3.  您可以同时运行多个操作系统进行测试
4.  您可以在当前图像中拍摄“快照”，如果您真的搞砸了，可以恢复。
5.  在同一台机器上进行多个构建......因为您可以运行多个操作系统。

令人惊讶的是，虚拟化系统的开销非常低。

我们仅在真机上运行该软件以进行性能调整/测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T22:38:52.673

上次升级到新机器时，我认为重新安装了大部分必要的工具大约需要 4 个小时。随着时间的推移，我不得不重新安装更多的工具，但我认为这是值得的。

如果您可以获得默认工具集（Visual Studio 2003-2008、Eclipse、NetBeans 或您正在使用的任何工具）和所有主要服务包的幻影/图像，这将对初始设置有很大帮助。

我认为停机时间绝对值得，一台新的、更快的机器将使任何人的工作效率更高。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T22:53:30.657

通过让两台机器都可用，您可以实现 0 停机时间。你不会有那么多的生产力。

这取决于开发团队需要的工具数量。诸如 Rational Software Architect 之类的工具可能需要数小时才能自行安装。让开发人员在搬入之前列出他们需要的应用程序可以帮助您优化策略以有效部署。两台机器都应该在固定的时间内可用，并且让它们可用可以让开发人员同时工作和启动长时间运行的安装。

根据提供给您的列表创建标准镜像可以提高效率。共享相关软件还可以让他们根据需要进行挑选，并让开发团队觉得他们可以在必要时返回。

存在帮助捕获用户设置的工具。我只接触过[Doctor Mover](http://www.drmover.com/index.php)。如果您有 100 名或更多的开发人员要迁移，那么这笔费用可能是值得的。我不能抱怨太多，但它并不完美。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-19T23:08:10.467

一天通常足以升级。我确实保留了 VS.NET 的数字副本，因此安装起来要容易得多。

当涉及到其他工具时，通常最好去网站并安装最新版本。

此外，最好在需要时安装工具，而不是尝试同时安装所有工具。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T23:23:31.507

我从来没有遇到过获取特定用户使用的所有软件的列表的问题。事实上，我从来没有发现基本安装是个大问题。我倾向于花费最多时间的部分是重新配置所有用户自定义设置（我发现开发人员很常见）。这是让旧机器在身边一段时间非常有价值的地方，这样用户至少可以远程桌面访问它并查看他们是如何设置的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T02:58:18.853

根据您团队的工作方式，我强烈建议让每个收到新计算机的用户从您的源代码控制存储库中获取最新的源代码树，而不是复制整个目录。而且，我还建议在将旧工作站实际发送到其他地方甚至断开它*之前这样做。*

CVS 和 SVN 等工具的一大优点是，开发人员很容易从没有正确签入、合并等的东西中得到一个非官方的“个人分支”。

虽然如果事情没有正确同步，处理这种转变会花费时间，但在它们以后困扰你之前抓住这些事情是一个非常宝贵的机会。

# programming-languages - mint.com 编程技术

> ID：766283
> 
> 赞同：7
> 
> 时间：2009-04-19T22:42:39.140
> 
> 标签：programming-languages

有谁知道[mint.com](http://www.mint.com)的编程语言/技术是什么？他们在使用 Java 吗？。网？Python？红宝石？

他们的网站非常好，我只是想知道他们选择什么来开发他们的网站。

谢谢。

PS MINT.COM 是个人财务管理在线应用程序。PS 2：感谢大家的回答。我真的发现每一个答案都非常有帮助。我也很高兴我发现了马特的博客。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-19T22:50:01.617

我在 mint.com 上找到了一个职位发布，这可能会让您了解他们正在使用的技术：

[http://mint.jobscore.com/jobs/mint/softwareengineerfulltime/c1owZqeQOr3OM4aaWP50_m](http://mint.jobscore.com/jobs/mint/softwareengineerfulltime/c1owZqeQOr3OM4aaWP50_m)

好像：

*   Linux 或 Unix 服务器
*   爪哇
*   休眠
*   MySql 数据库

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-19T22:52:02.033

我猜Java

他们的前端营销网站是 X-Powered-By: PHP/5.2.9

但是登录页面是由服务器驱动的：Apache-Coyote/1.1

[Coyote](http://tomcat.apache.org/tomcat-4.1-doc/config/coyote.html)用于基于 Java 的系统。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-19T22:48:54.647

通过查看职位空缺，我猜是 Java。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-19T23:05:21.660

我猜“看起来非常好”部分来自基于[马特](http://mattsnider.com/)博客的[YUI 。](http://developer.yahoo.com/yui/)在他的博客上还有一些非常好的片段和示例，这些片段和示例在 mint.com 上使用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-19T22:54:51.310

我猜他们没有使用 .net，因为他们的服务器都在运行 F5 Big-IP 或 CentOS。[这](http://toolbar.netcraft.com/site_report?url=http://www.mint.com)是 Netcraft 的报告。但是很难说他们的服务是基于什么开发的——尽管职位空缺肯定是一个潜在的指标。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-02-03T16:05:59.393

根据关于创始人 Aaron Patzer 的 Wikipedia 文章，alpha 版本是使用 J2EE 和 mySQL 构建的。

[http://en.wikipedia.org/wiki/Aaron_Patzer](http://en.wikipedia.org/wiki/Aaron_Patzer)

# jquery - 如何在 jQuery 中忽略子元素上的鼠标事件？

> ID：766286
> 
> 赞同：24
> 
> 时间：2009-04-19T22:43:58.123
> 
> 标签：jquery

我有一个无序列表，其中 li 元素附加了 mouseover 和 mouseout 事件。每个都包含一个链接，并且 li 中有一些填充。当我将鼠标悬停在 li 上时，会触发 mouseover 事件，但是当我将鼠标悬停在 li 中*包含*的链接上时，mouseout 和 mouseover 事件都会按顺序触发。似乎子元素正在触发它们的父元素鼠标事件......我该如何停止呢？我希望它在将鼠标悬停在链接上时保持鼠标悬停，而不是每次将鼠标悬停在链接上时都激活动画。这是我的代码；

```
 jQuery(document).ready(function(){
      jQuery('#menu li ul').hide();
      jQuery('#menu li').mouseover( function() {
           jQuery(this).children("ul").show('fast').stop;
           return false;
      });
      jQuery('#menu li').mouseout( function() {
           jQuery(this).children("ul").hide('fast').stop;
           return false;
      });
 });

 <ul id="menu">
      <li><a href="">Some link</a>
           <ul>Sub content</ul>
      </li>
 </ul> 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-20T00:17:35.387

看来我已经找到了自己问题的答案。对于任何可能有同样问题的人；试试这个代码。似乎悬停不会像其他鼠标事件那样冒泡到子元素中。

```
jQuery('#menu li').hover(
    function() {
        jQuery(this).children('ul').show('fast');
        return false;
    },
    function() {
        jQuery(this).children('ul').hide('fast');
        return false;
    }
); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-19T22:57:38.900

使用“ **[event.stopPropagation](http://docs.jquery.com/Events/jQuery.Event#event.stopPropagation.28.29)** ()”来阻止事件向上冒泡：

```
 jQuery('#menu li a').mouseover( function(evt) {
       evt.stopPropagation();
       return false;
  });
  jQuery('#menu li a').mouseout( function(evt) {
       evt.stopPropagation();
       return false;
  }); 
```

或者使用**[mouseenter](http://docs.jquery.com/Events/mouseenter#fn)**和**[mouseleave](http://docs.jquery.com/Events/mouseleave#fn)**事件而不是 mouseover/out。jQuery 规范了它们跨浏览器的行为，这些事件的好处是不会冒泡......

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-06-15T17:21:06.763

我正在寻找 JS 中的等效行为，您可以在 AS3 中放置：

```
object.mouseenabled = false; 
```

我发现效果很好的方法是使用 CSS 并输入：

```
.element { pointer-events: none; } 
```

（但我想这只有在您根本不需要该元素的情况下才有效。我将它用于悬停时弹出的工具提示，但不希望它在您将鼠标移开时表现得怪异）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-10T11:54:32.800

你可以试试这个

```
$('#menu li').live('mouseenter mouseleave', function (e) {
    if (e.type == 'mouseenter') {
        //Show ul
    } else {
        //Hide ul
    }
}); 
```

优点是使用了事件委托。祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T22:53:05.713

使用 css 类来区分不同的菜单级别。然后，您可以轻松地在 jQuery 选择器中搜索一个或另一个类。

# asp.net - IIS 5 会话和 Asp.Net 会话

> ID：766288
> 
> 赞同：1
> 
> 时间：2009-04-19T22:47:01.423
> 
> 标签：asp.net, session, iis-5

如果我们打开 IIS 5 Manager 并右键单击虚拟目录 --> 选择*Properties*以便打开新窗口 --> 单击*Home Directory 选项卡*--> 单击*Configuration*，以便再次打开新窗口 --> 如果在这个新窗口中窗口我们选择*选项选项卡*，然后我们会看到*启用会话状态*选项。

由于 Asp.Net 已经支持会话，我想知道 IIS 5 会话和 Asp.Net 会话如何相互关联？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T22:48:41.573

这适用于经典的 ASP 会话状态。

它们不兼容。

# asp.net-mvc - 如何在 MVC 中显示数据库中的图像

> ID：766295
> 
> 赞同：1
> 
> 时间：2009-04-19T22:50:35.000
> 
> 标签：asp.net-mvc

我有一个带有图像的数据库我可以在浏览器中显示图像标签但没有图像是否有文章或教程将展示如何在 MVC 中显示图像来自数据库我的表有 GUID userId

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T23:33:10.563

渲染一个具有类似图像链接的视图

```
<img src="http://www.yourwebsite.com/mycontroller/renderimageaction/imageid"> 
```

在mycontroller的代码中，创建一个renderimageaction，在其中去数据库中查找图像“imageid”，读取图像数据，并将数据作为内容类型“image/jpg”或其他合适的类型返回给浏览器取决于您将图像存储在数据库中的内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T08:18:24.183

生成指向 Web url 的图像源点，该 URL 将查询数据库并将它们放入具有正确 MIME 类型的响应流中。

使用 Asp.NET 路由，您甚至可以执行类似`http://somehost/image/logo.jpg`where " `image`" 实际上是从 DB 中提取图像的操作。这样，用户可以在将图片保存到本地驱动器时保留图片名称。

# c# - Assert.ReferenceEquals() 在 Visual Studio 测试中传递 Object.ReferenceEquals() 返回“false”的位置

> ID：766297
> 
> 赞同：23
> 
> 时间：2009-04-19T22:51:44.687
> 
> 标签：c#, visual-studio, unit-testing, equals, assertions

在尝试在 Visual Studio Professonal 2008 的测试功能中创建初始失败的单元测试时，当对象实例*不*等于空引用时，我似乎`Assert.ReferenceEquals()`无法正确失败。请注意，对于相同的比较，它正确返回。*`object.ReferenceEquals()``false`*

 *这是我的课程代码：

```
public static class Project
{
    public static object TheObject { get; set; }

    public static void Startup(object theObject)
    {
        // ToDo: Project.Startup(): Test.
        // ToDo: Project.Startup(): Implement.
    }
} 
```

然后这里是我的测试课的关键方面：

```
[TestClass()]
public class ProjectTest
{
    [TestMethod()]
    public void StartupTest()
    {
        object obj = "hello";
        Project.Startup(obj);    
        Assert.ReferenceEquals(obj, Project.TheObject); // Test Passes!?!
    }
} 
```

请注意，该`static void Startup(object)`方法是空的，因此该`static object TheObject`属性永远不会设置并保持不变`null`。所以，显然，`Assert.ReferenceEquals(obj, Project.TheObject)`应该失败，但不知何故，这个测试通过了。

注意改变

`Assert.ReferenceEquals(obj, Project.TheObject)`

到

`Assert.IsTrue(object.ReferenceEquals(obj, Project.TheObject))`

导致此测试*正确*失败。

这似乎太简单了，但我看不出这里出了什么问题。如果有人能以我的方式指出错误，我将不胜感激。

提前致谢，

麦克风

**詹姆斯艾弗里回答的更新：**

啊，我现在感觉多么愚蠢。我*知道*它必须是这样的。哇。

果然，“GoToDefinition”将我带到“Object.ReferenceEquals()”。所以键入“Assert.ReferenceEquals()”实际上是 System.Object.ReferenceEquals()，在我的例子中它悄悄地返回“false”。当然，这与实际失败的断言无关，因此测试*通过*。惊人的。

谢谢詹姆斯。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-19T23:54:26.563

您调用的 ReferenceEquals 方法是所有引用对象上可用的静态方法，它不是测试框架的一部分。如果你看它返回一个布尔值，而正常的断言将是无效的。这绝对令人困惑， .AreSame() 是您正在寻找的断言。

# mysql - MySQL Enum 性能优势？

> ID：766299
> 
> 赞同：57
> 
> 时间：2009-04-19T22:52:05.420
> 
> 标签：mysql, enums

在一个字段只有 5-10 个不同的可能值的情况下使用枚举是否有性能优势？如果不是，有什么好处？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-04-19T23:14:17.707

用于以下操作会带来巨大的性能*损失*`ENUM`：

*   查询 中的允许值列表`ENUM`，例如填充下拉菜单。您必须从中查询数据类型`INFORMATION_SCHEMA`，并从返回的 BLOB 字段中解析列表。

*   更改允许值集。它需要一个`ALTER TABLE`语句，该语句锁定表并可能进行重组。

我不是 MySQL 的粉丝`ENUM`。我更喜欢使用查找表。另请参阅我对“[如何处理数据库中没有枚举字段的枚举？](https://stackoverflow.com/questions/761211/how-to-handle-enumerations-without-enum-fields-in-a-database/761343#761343) ”的回答。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-04-19T22:58:30.800

ENUM 在内部由 1 或 2 个字节表示，具体取决于值的数量。如果您存储的字符串大于 2 个字节并且很少更改，那么 ENUM 就是要走的路。使用枚举进行比较会更快，并且它们占用的磁盘空间更少，这反过来又会导致更快的寻道时间。

缺点是枚举在添加/删除值时不太灵活。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-10-25T12:26:31.333

在这篇文章中[，使用 ENUM 数据类型来提高性能](http://fernandoipar.com/2009/03/09/using-the-enum-data-type-to-increase-performance/)Fernando 研究了 ENUM 类型的查询性能。

结果是，虽然从设计的角度来看，使用 ENUM 可能看起来不那么优雅（如果您的 ENUM 值有时会发生变化），但对于大型数据集，性能提升是显而易见的。

> 好吧，很明显，虽然从设计的角度来看，使用 ENUM 似乎不太优雅（如果我在不止一个表中使用类型会发生什么？如果我想添加一个类型怎么办？我必须更改表！），性能优势，如果我要处理大量数据（我的测试是少量的，但我没有服务器，只是一个非常简陋的笔记本）可能是值得的。

有关详细信息，请参阅他的文章。你同意？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T22:55:07.783

不，看[这里的比较](http://www.mysqlperformanceblog.com/2008/01/24/enum-fields-vs-varchar-vs-int-joined-table-what-is-faster/)

优势在于代码的可读性。

# c++ - 为什么 Valgrind 不喜欢我对 glutCreateWindow 的使用？

> ID：766303
> 
> 赞同：1
> 
> 时间：2009-04-19T22:53:34.387
> 
> 标签：c++, valgrind, glutcreatewindow

我正在使用以下代码...

```
169: const char *title = Title.c_str();
170: glutCreateWindow(title); 
```

... Valgrind 给了我以下...

```
==28841== Conditional jump or move depends on uninitialised value(s)
==28841==    at 0x6FF7A4C: (within /usr/lib64/libGLcore.so.180.44)
==28841==    by 0x6FF81F7: (within /usr/lib64/libGLcore.so.180.44)
==28841==    by 0x7289B36: (within /usr/lib64/libGLcore.so.180.44)
==28841==    by 0x728A757: _nv000133gl (in /usr/lib64/libGLcore.so.180.44)
==28841==    by 0x4EAB9E9: (within /usr/lib64/libGL.so.180.44)
==28841==    by 0x4EAEA81: (within /usr/lib64/libGL.so.180.44)
==28841==    by 0x4EB1D81: (within /usr/lib64/libGL.so.180.44)
==28841==    by 0x4EA782B: glXCreateNewContext (in /usr/lib64/libGL.so.180.44)
==28841==    by 0x54DF9AA: fgOpenWindow (in /usr/lib64/libglut.so.3.8.0)
==28841==    by 0x54DE062: fgCreateWindow (in /usr/lib64/libglut.so.3.8.0)
==28841==    by 0x54DF300: glutCreateWindow (in /usr/lib64/libglut.so.3.8.0)
==28841==    by 0x4146CE: vimrid::glut::GlutApplication::Init() (GlutApplication.cpp:170) 
```

但是什么是未初始化的？title 变量用 Title.c_str() 的值初始化，Title 是一个类成员，在构造函数成员初始化列表中初始化......

```
class VimridApplication
{
    // ...

public:
    std::string Title;

    // ...
}

VimridApplication::VimridApplication() :
    Title("Untitled VimridApplication")
{
    // ...
}

class GlutApplication : public VimridApplication
{
    // ...
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T02:55:24.133

Valgrind 带有一些默认的错误抑制，但这可能不包括 libCLcore。

> 错误检查工具可检测基本库中的大量问题，例如 GNU C 库和 X11 客户端库，这些库预装在您的 GNU/Linux 系统上。你不能轻易地修复这些，但你不想看到这些错误（是的，有很多！）所以 Valgrind 读取错误列表以在启动时抑制。构建系统时，./configure 脚本会创建一个默认抑制文件。

您可以创建自己的[错误抑制](http://valgrind.org/docs/manual/manual-core.html#manual-core.suppress)，您知道这些错误抑制与您的代码无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T23:02:32.367

忽略这个；如您所见，未初始化的值在 OpenGL 库中的代码下方使用，可能不是您的数据未初始化。你可能想深入研究它（它可能仍然是一个误报），但你最好不要管它。

# php - 使用 PHP SoapClient 调用 Web 服务 - 如何？

> ID：766305
> 
> 赞同：2
> 
> 时间：2009-04-19T22:54:15.850
> 
> 标签：php, web-services, soap

从 Web 服务开始，我快疯了。我正在尝试使用 PHP 调用以下 WSDL 并且一直无处可去：

[http://webservices.sabre.com/wsdl/sabreXML1.0.00/usg/SessionCreateRQ.wsdl](http://webservices.sabre.com/wsdl/sabreXML1.0.00/usg/SessionCreateRQ.wsdl)

我在网上找到了以下代码，来自有类似问题的人，但我也无法让它工作：

`$soap = new SoapClient('[http://webservices.sabre.com/wsdl/sabreXML1.0.00/usg/SessionCreateRQ.wsdl](http://webservices.sabre.com/wsdl/sabreXML1.0.00/usg/SessionCreateRQ.wsdl)', array( 'trace' => true, 'soap_version' => SOAP_1_2, "exceptions" => 0));`

 `$eb = new EbXmlMessage();
$sec = new Security();
$scrq = new SessionCreateRQ();` 

`try {
$omg = $soap->SessionCreateRQ($scrq, $sec,$eb);
}
catch (Exception $e)
{
print_r($e);
}
//debug
print "Request: \n".
htmlspecialchars($soap->__getLastRequestHeaders()) ."\n";
print "Request: \n".
htmlspecialchars($soap->__getLastRequest()) ."\n";
print "Response: \n".
$soap->__getLastResponseHeaders()."\n";
print "Response: \n".
$soap->__getLastResponse()."\n";

print_r($omg);
//the first envelope headers
class EbXmlMessage
{
public $From = array('PartyId' => 'mysite.com');
public $To = array('PartyId' => 'myprovider.com');
public $CPAId = 'ZZZZ';
public $ConversationId = 'myconv@id.com';
public $Service = 'Session';// or SessionCreate?
public $Action = 'SessionCreateRQ';
public $MessageData = array( 'MessageId' => 'messageid', 'Timestamp' => '2009-04-18T15:15:00Z');

}
//the security token
class Security {
public $Username = "xxxxx";
public $Password = "yyyyy";
public $Organization = "ZZZZ";
public $Domain = "DEFAULT";
}
//this is suppoused to be the payload, or the xml i need to send at the end
class SessionCreateRQ
{
public $POS = array(
'Source' => array(
'_'=>"",
'PseudoCityCode'=>'ZZZZ'
));
}` 
我不断收到以下错误：

响应：HTTP/1.1 500 内部服务器错误 SOAPAction：“”内容类型：text/xml；charset=utf-8 日期：2009 年 4 月 19 日星期日 22:21:34 GMT 连接：关闭服务器：SWS

回复：

> soap-env:Client.InvalidEbXmlMessageUnable to internalize messagejavax.xml.soap.SOAPException: Unable to internalize message at com.sun.xml.messaging.saaj.soap.MessageImpl.(MessageImpl.java:135) at com.sun.xml. com.sabre.universalservices.gateway.control.SoapProcessor.getRequest(SoapProcessor.java:263) 上 com.sabre.universalservices.gateway.control.WSGateway 上的消息传递.saaj.soap.MessageFactoryImpl.createMessage(MessageFactoryImpl.java:32)。 handleRequest(WSGateway.java:380) at com.sabre.universalservices.gateway.control.WSGateway.doPost(WSGateway.java:306) at javax.servlet.http.HttpServlet.service(HttpServlet.java:710) at javax.servlet .http.HttpServlet.service(HttpServlet.java:803) 在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290) 在 org.apache。catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 在 org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233) 在 org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java: 175) 在 org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) 在 org.apache.catalina.valves.AccessLogValve 的 org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128) .invoke(AccessLogValve.java:563) 在 org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) 在 org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:263) 在 org. org.apache.coyote.http11 上的 apache.coyote.http11.Http11AprProcessor.process(Http11AprProcessor.java:852)。Http11AprProtocol$Http11ConnectionHandler.process(Http11AprProtocol.java:584) at org.apache.tomcat.util.net.AprEndpoint$Worker.run(AprEndpoint.java:1508) at java.lang.Thread.run(Thread.java:595)引起：javax.xml.soap.SOAPException：无效的 Content-Type:application/soap+xml at com.sun.xml.messaging.saaj.soap.MessageImpl.verify(MessageImpl.java:159) at com.sun.xml .messaging.saaj.soap.MessageImpl.(MessageImpl.java:91) ... 还有 19 个(MessageImpl.java:91) ... 19 更多(MessageImpl.java:91) ... 19 更多
> 
> SoapFault 对象（[message:protected] => 无法内部化消息 [string:private] => .....

该服务应该在系统上验证我并返回一个安全对象以在以后的调用中使用 - 一个字符串（？），然后我可以将其存储在会话变量中以用于以下调用。

非常感谢任何帮助！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-15T20:28:47.590

我注意到的一件事是SoapFault 对象中有一个故障代码值**：**

```
[faultcode] => soap-env:Client.InvalidEbXmlMessage 
```

所以这可能是开始调试的有用途径。

我尝试将您的 EbXmlMessage 的结构与[XSD](http://www.oasis-open.org/committees/ebxml-msg/schema/msg-header-2_0.xsd)和[架构文档](http://www.buldocs.com/xnsdoc/samples/docs/oasis/ebxml/message-2.0/msg-header-2_0.xsd/index.html)进行比较，但我看不出它被宣布为无效的任何明显原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-23T10:02:03.887

尝试使用**wsdl2php**。它从 wsdl 文件中生成 php 类。它使用 php 的 SoapClient 来发送数据。

这是一个很好的帖子，解释了如何做到这一点：

[http://itworkarounds.blogspot.com/2011/10/simple-soap-client-with-wsdl2php-using.html](http://itworkarounds.blogspot.com/2011/10/simple-soap-client-with-wsdl2php-using.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-28T19:02:02.690

您是否尝试过将 Content-type 标头更改为 text/xml？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-18T12:53:55.370

Just use nuSOAP. I don't like PHP native SoapClient. nuSoap generates for you a wsdl so you don't have to worry about how to make one.. Here's [nuSOAP](http://sourceforge.net/projects/nusoap/) and here's a simple example code or you can download whole working code [here](https://mega.co.nz/#!eEdiTDIA!WUezp088c13IMA5TKnWh63E89jBGyaKRiqYLvBL5b3g) :

**Server** :

```
<?php
// include the SOAP classes
require_once('nuSOAP/lib/nusoap.php');

function HelloWorld(){
return 'HelloWorld'; // Returns HelloWorld string
}

function Hello($name){
return 'Hello '.$name; // Returns Hello with name string parameter
}

// create the server object
$server = new nusoap_server();

// Initialize WSDL support
$server->configureWSDL('webservicenamespace', 'urn:webservicenamespace');

$server->register('HelloWorld',             array(), array('result' => 'xsd:string')); //xsd:string; xsd:boolean; xsd:integer and so on..
$server->register('Hello',                  array('name' => 'xsd:string'), array('result' => 'xsd:string')); // array('parametername' => 'parametertype'),array('result' => 'returntype');

if (isset($error))
{
    $fault =
            $server->fault('soap:Server','',$error);
}

// send the result as a SOAP response over HTTP $HTTP_RAW_POST_DATA
$post = file_get_contents('php://input');
$server->service($post);
?> 
```

**Client** :

```
<?php
// Pull in the NuSOAP code
require_once('nuSOAP/lib/nusoap.php');

// Create the client instance

$client = new nusoap_client('http://pathtourl/sample_webservice.php?wsdl', true);

// Check for an error
$err = $client->getError();
if ($err) {
    // Display the error
    echo '<h2>Constructor error</h2><pre>' . $err . '</pre>';
    // At this point, you know the call that follows will fail
}

// Call the SOAP method
$result = $client->call('Hello', array('name' => 'Scott')); // Call function name, parameters;

// Check for a fault
if ($client->fault) {
    echo '<h2>Fault</h2><pre>';
    print_r($result);
    echo '</pre>';
} else {
    // Check for errors
    $err = $client->getError();
    if ($err) {
        // Display the error
        echo '<h2>Error</h2><pre>' . $err . '</pre>';
    } else {
        // Display the result
        echo '<h2>Result</h2><pre>';
        print_r($result);
    echo '</pre>';
    }
}
// Display the request and response
echo '<h2>Request</h2>';
echo '<pre>' . htmlspecialchars($client->request, ENT_QUOTES) . '</pre>';
echo '<h2>Response</h2>';
echo '<pre>' . htmlspecialchars($client->response, ENT_QUOTES) . '</pre>';
// Display the debug messages
echo '<h2>Debug</h2>';
echo '<pre>' . htmlspecialchars($client->debug_str, ENT_QUOTES) . '</pre>';
?> 
```

Now when you want to make a client you need your wsdl you can simply get it by adding *?wsdl* on your link i.e( *webservice.php?wsdl* )

Hope this helps :) Good luck with your web service.

# validation - struts2 验证

> ID：766309
> 
> 赞同：2
> 
> 时间：2009-04-19T22:55:09.967
> 
> 标签：validation, struts

我在表单中有一个文本字段和一个选择框（用户可以通过 ctrl 选择多个值）。

我正在阅读 struts2 提供的验证：http: [//struts.apache.org/2.x/docs/validation.html](http://struts.apache.org/2.x/docs/validation.html)

但是，它似乎没有我需要的验证。

仅当从选择框中选择某些字符串时，我才想让文本字段成为必填字段。

我是否必须为此目的编写自定义验证器，或者是否有更简单的方法在 struts2 中实现此目的。

谢谢！

PS：我想知道其他语言/框架如何处理这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T23:20:42.683

[表达式](http://struts.apache.org/2.x/docs/expression-validator.html)或[字段表达式](http://struts.apache.org/2.x/docs/fieldexpression-validator.html)适合检查依赖于其他字段的字段。例如，要检查确认的电子邮件地址，您可以执行以下操作：

```
<field name="confirmAddress">
    <field-validator type="fieldexpression">
        <param name="expression">address == confirmAddress</param>
        <message key="nomatch"/>
    </field-validator>
</field> 
```

不过，创建自定义验证器很简单，而且易于重用。

# c# - 类设计：公共构造函数或带有静态工厂和 COM 对象的私有构造函数

> ID：766317
> 
> 赞同：2
> 
> 时间：2009-04-19T22:59:21.313
> 
> 标签：c#, constructor

我有一点类设计问题。我将概述我正在考虑的三种模式。

**示例 1：**

```
Class MyObject
{
    public MyObject(IWrapper wrapper,string name)
    {//set properties.}

    public Void Declare()
    {
        //Some COM stuff with IWrapper
     } 
} 
```

*使用*：

```
MyObject testobj = new MyObject(fakewrapper,"test");
testobj.Declare(); 
```

**示例 2：**

```
Class MyObject
{
    public MyObject(IWrapper wrapper,string name)
    { //set properties.}

    public MyObject Declare()
    {
        //Some COM stuff with IWrapper
        return this;
     } 
} 
```

*使用*：

```
MyObject testobj = new MyObject(fakewrapper,"Test");
testobj = testobj.Declare(); 
```

**示例 3：使用私有构造函数**

```
Class MyObject
{
    private MyObject(IWrapper wrapper,string name)
    {//set properties.}

    public static MyObject Declare(IWrapper wrapper,string name)
    {
        //Some COM stuff with IWrapper
        return new MyObject(wrapper,name);
     } 
} 
```

*使用*：

```
MyObject testobj = MyObject.Declare(fakewrapper,"Test"); 
```

我的主要问题是；你觉得哪一个设计更好？
隐藏构造函数以支持静态工厂方法是不好的做法吗？

我也试图使这个尽可能可测试。我似乎无法下定决心的唯一原因是因为 MyObject 类是 COM 应用程序中另一个对象的包装器。

问题是这个对象必须在 COM 应用程序中声明，这是在可以调用任何其他方法之前*声明*方法正在执行的操作，但是如果我隐藏构造函数然后向 Declare 方法添加更多工作，我认为它会使类的其余部分很难测试，因为我必须先通过 Declare 方法。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T23:38:44.417

选项 3 对我来说似乎是您的班级最干净的 API。如果在调用 Declare 之前您不能真正使用 MyObject，对我来说，将 new 和 Declare 包装到工厂方法中是有意义的，以确保您的类的用户在没有先调用 Declare 的情况下不会尝试使用 MyObject。工厂方法还可以帮助进行后续维护。

帮助可测试性的一种方法可能是将 Declare 操作包装在类中的可插入“IDeclarer”接口中。您的生产应用程序将使用调用 COM 应用程序的 IDeclarer 实现，而您的测试代码可以插入模拟 IDeclarer。也许是这样的（你可能不得不调整这个......）：

```
class MyObject
{
    public IDeclarer Declarer { get; set; }

    private MyObject(IWrapper wrapper,string name)
    {
        // set properties
    }

    public static MyObject Declare(IWrapper wrapper,string name)
    {
        //Some COM stuff with IWrapper
        MyObject newMyObject = new MyObject(wrapper,name);
        return Declarer.Declare(newMyObject);
    } 
}

public interface IDeclarer
{
    MyObject Declare(MyObject obj);
}

public class ComDeclarer : IDeclarer
{
    public MyObject Declare(MyObject obj)
    {
        // do COM work
        return comObj;
    }
}

public class TestDeclarer : IDeclarer
{
    public MyObject Declare(MyObject obj)
    {
        // do nothing... or whatever
        return testObj;
    }
} 
```

# sql-server - 扩展 MS SQL Server 2008 数据库

> ID：766319
> 
> 赞同：3
> 
> 时间：2009-04-19T22:59:47.350
> 
> 标签：sql-server, scalability

我试图找出扩展我的网站的最佳方式，我对 mssql 将如何扩展有疑问。

目前表的方式是：

> cache_id - int - 标识符
> cache_name - nvchar 256 - 与 event_id 一起用于查找
> cache_event_id - int - 基本上是一种分组方式
> cache_creation_date - datetime
> cache_data - varbinary(MAX) - 数据大小从 2k 到 5k

存储的数据是一个字节数组，这基本上是我网站上页面的缓存实例（压缩）。

我看到存储的不同方式是：
1）1个大表，它将包含数千万条记录，并且很容易变成几千兆字节的大小。
2) 包含上述数据的多个表，这意味着每个表将包含 200k 到一百万条记录。

该表中的数据将用于显示网页，因此任何超过 200 毫秒的记录在我看来都是不好的（我知道有些人认为 1-2 秒的页面加载是可以的，但我认为这很慢并且想要做我最好保持较低）。

**所以归结为，是什么降低了 SQL 服务器的速度？**
是表的大小（磁盘空间）
还是行数
在什么时候使用多个数据库服务器不再具有成本效益？

如果几乎不可能预测这些事情，我接受它作为回复。我不是 DBA，我基本上是在尝试设计我的数据库，所以当它包含大量数据时，我不必在以后重新设计它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T00:44:35.883

```
所以归结为，是什么降低了 SQL 服务器的速度？
是否是表的大小（磁盘空间）
是行数
在什么时候使用多个不再具有成本效益
       数据库服务器？

```

这都是“经验法则”的观点；数据库的负载（因此在相当大的程度上是性能）在很大程度上是两个问题数据量和事务负载的因素，恕我直言，第二个通常更相关。

关于数据量，可以通过规范化、索引、分区、快速 IO 系统、适当的缓冲区高速缓存大小等方式保存数 GB 的数据并获得可接受的访问时间。其中许多，例如规范化是人们考虑的问题数据库设计时间，系统调整期间的其他时间，例如增加/减少索引，缓冲区缓存大小。

事务负载很大程度上是代码设计和用户总数的一个因素。代码设计包括正确处理事务大小等因素（总体目标是小而快，但像大多数事情一样，有可能把它带到很远并且事务太小而无法保持完整性或太小以至于本身会增加负载） .

在扩展时，我建议先扩展（更大、更快的服务器）然后扩展（多台服务器）。多服务器实例的管理问题非常重要，我建议只对具有操作系统、网络和 DBA 技能和流程匹配的站点进行考虑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T23:16:53.097

规范化和索引。

如何，我们不能告诉你，因为你还没有告诉 use 你的表试图建模什么或者你试图如何使用它。

100 万行并不罕见。同样，在没有上下文的情况下，我们无法告诉您太多信息，只有您可以但不能提供。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T23:31:47.257

唯一可能的答案是设置它，并为长期迭代的学习过程做好准备，只有你会知道，因为只有你会生活在你的领域中。您在此处看到的任何技术建议都将是幼稚的，并且在您有一些实际经验可以分享之前，信息不足。

测试你的每一个猜测，比较结果，看看什么是有效的。并继续寻找更多可测试的想法。（并且不要害怕退出最终无济于事的更改。有任何持续简单的希望是基本要求。）

并接受您的数据库设计将不断发展的事实。它并不像您的评论所暗示的那样可怕。更改数据库比使用它的软件要容易得多。

# c# - 反射相关 我牺牲了多少速度？

> ID：766331
> 
> 赞同：3
> 
> 时间：2009-04-19T23:07:54.087
> 
> 标签：c#, reflection, performance

```
private Equipment GenerateDirtyPropertiesOnEntity(Equipment updatedEntity)
    {
        updatedEntity.DirtyProperties.Clear();
        Equipment originalEntity = GetEquipmentByGuid(updatedEnitity.Guid.Value);
        Type myType = updatedEntity.GetType();
        System.Reflection.PropertyInfo[] properties = myType.GetProperties();
        foreach (System.Reflection.PropertyInfo p in properties)
        {
            if (p.GetValue(originalEntity, null) == null)
            {
                if (p.GetValue(updatedEntity, null) != null)
                    updatedEntity.DirtyProperties.Add(p.Name);
            }
            else
            {
                if (!(p.GetValue(originalEntity, null).Equals(p.GetValue(updatedEntity, null))))
                    updatedEntity.DirtyProperties.Add(p.Name);
            }
        }
        return updatedEntity;
    } 
```

使用它时我牺牲了多少速度？有谁知道更好的方法来做到这一点？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T23:49:30.150

你在问2个问题：

1.  你损失了多少速度？
2.  有没有更快的方法来做到这一点

**问题一：**

第一个问题的答案是：视情况而定。手动编写属性检查代码可能比反射代码快几倍。但是，这实际上可能不是问题，具体取决于代码被调用的频率。如果代码不是很频繁地调用，那么优化它的麻烦就不会太多。但是，如果它被大量调用，那么优化它可能会给您带来很大的速度提升。我会在分析器下运行您的应用程序（我个人喜欢 Jet Brain 的 Dot Trace），以查看实际花费的时间。在“GenerateDirtyPropertiesOnEntity”中花费的时间百分比将为您提供通过优化方法可以获得的理论上的最大性能增益。如果这最终只是一小部分，那么我会保持代码不变。

**问题2**

我可以想到 2 种简单的方法来加快速度：

1.  手写属性比较代码。
2.  使用 DynamicMethod 类生成比较代码

我假设你不想做#1。我将在稍后发布一些显示#2 的代码。

**更新：**

这是生成动态方法的代码

```
class Util
{
    public static Func<T,T, List<string>> CreateDitryChecker<T>()
    {
        var dm = 
            new DynamicMethod
            (
                "$dirty_checker", 
                typeof(List<string>), 
                new[] { typeof(T), typeof(T) }, 
                typeof(T)
            );

        var ilGen = dm.GetILGenerator();

        //var retVar = new List<string>();
        var retVar = ilGen.DeclareLocal(typeof(List<string>));
        ilGen.Emit(OpCodes.Newobj, typeof(List<string>).GetConstructor(new Type[0]));
        ilGen.Emit(OpCodes.Stloc, retVar);

        var properties = typeof(T).GetProperties(BindingFlags.Public | BindingFlags.Instance);

        MethodInfo objEqualsMehtod = typeof(object).GetMethod("Equals", new[] { typeof(object) });
        MethodInfo listAddMethod = typeof(List<string>).GetMethod("Add");

        foreach (PropertyInfo prop in properties)
        {
            //Inject code equivalent to the following into the method:

            //if (arg1.prop == null)
            //{
            //     if (arg2.prop != null)
            //     {
            //         retVar.Add("prop")
            //     }
            //}
            //else
            //{
            //    if (! arg1.prop.Equals(arg2))
            //    {
            //        retVar.Add("prop")    
            //    }
            //}
            Label endLabel = ilGen.DefineLabel();
            Label elseLabel = ilGen.DefineLabel();

            //if arg1.prop != null, goto elseLabel
            ilGen.Emit(OpCodes.Ldarg_0);
            ilGen.Emit(OpCodes.Call, prop.GetGetMethod());
            ilGen.Emit(OpCodes.Brtrue, elseLabel);

            //if arg2.prop != null, goto endLabel
            ilGen.Emit(OpCodes.Ldarg_1);
            ilGen.EmitCall(OpCodes.Call, prop.GetGetMethod(), null);
            ilGen.Emit(OpCodes.Brfalse, endLabel);

            //retVar.Add("prop");
            ilGen.Emit(OpCodes.Ldloc, retVar);
            ilGen.Emit(OpCodes.Ldstr, prop.Name);
            ilGen.EmitCall(OpCodes.Callvirt, listAddMethod, null);
            ilGen.Emit(OpCodes.Br, endLabel);

            //elseLabel:
            ilGen.MarkLabel(elseLabel);

            //if (arg0.prop.Equals(arg1.prop), goto endLabel
            ilGen.Emit(OpCodes.Ldarg_0);
            ilGen.EmitCall(OpCodes.Call, prop.GetGetMethod(), null);
            ilGen.Emit(OpCodes.Ldarg_1);
            ilGen.EmitCall(OpCodes.Call, prop.GetGetMethod(), null);
            ilGen.EmitCall(OpCodes.Callvirt, objEqualsMehtod, null);
            ilGen.Emit(OpCodes.Brtrue, endLabel);

            //retVar.Add("prop")
            ilGen.Emit(OpCodes.Ldloc, retVar);
            ilGen.Emit(OpCodes.Ldstr, prop.Name);
            ilGen.EmitCall(OpCodes.Callvirt, listAddMethod, null);

            //endLAbel:
            ilGen.MarkLabel(endLabel);
        }

        ilGen.Emit(OpCodes.Ldloc, retVar);
        ilGen.Emit(OpCodes.Ret);

        return (Func<T, T, List<string>>) dm.CreateDelegate(typeof(Func<T, T, List<string>>));
    }
} 
```

它接受一个泛型参数 T 并返回一个委托，当给定 2 个 T 实例时，该委托将返回所有已更改属性的列表。

为了提高性能，最好调用一次方法并将结果存储在只读静态字段中。像这样的东西会起作用：

```
class FooBar
{
   static readonly Func<FooBar,FooBar, List<string>> s_dirtyChecker;

   static FooBar()
   {
       s_dirtyChecker = Util.CreateDirtyChecker<FooBar>();
   }

   public List<string> GetDirtyProperties(Foobar other)
   {
       return s_dirtyChecker(this, other);
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T23:51:08.897

通过使用 INotifyPropertyChanged 接口进行尝试，您***可能会***获得更好的性能。您可以使用基于事件的建模来完成相同的事情，而不是使用反射。

[CSLA.NET](http://www.lhotka.net/cslanet/)就是采用这种方法的框架示例。

**例子**

```
T SomeProperty()
{
    get
    {
       return _someProperty;
    }
    set
    {
       if (_someProperty <> value)
       {
          _someProperty = value;
          OnPropertyChanged("SomeProperty");
       }
    }
} 
```

然后 OnPropertyChanged 看起来像

```
OnPropertyChanged(object params)
{
   DirtyProperties.Add(params);
} 
```

请记住，这是总空气代码。我不记得参数是如何构造的，但它实际上不是对象类型，并且包含属性的名称，这就是您确定要添加到 DirtyProperties 列表中的属性的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T23:44:52.657

毫无疑问，唯一知道您要牺牲多少速度的方法就是对此进行分析。

一般来说，根据我的经验，反映属性似乎最多只有直接访问它们的速度的 1/50。在最坏的情况下，它可能会慢 200 倍。根据此操作的频率和属性的数量，这可能是也可能不是显着的差异，但这也是为什么我建议对其进行分析以判断您是否需要不同的解决方案的原因。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T23:17:21.553

我正在考虑使用[PostSharp](http://www.postsharp.org/)做类似的事情，然后在设置旧属性值和新属性值时比较它，并将对象标记为脏。在财产层面上做同样的事情应该不会太难。

# python - Python速度测试 - 时差 - 毫秒

> ID：766335
> 
> 赞同：166
> 
> 时间：2009-04-19T23:08:27.627
> 
> 标签：python, datetime, time, time-measurement

为了加速测试一段代码，在 Python 中比较 2 次的正确方法是什么？我尝试阅读 API 文档。我不确定我是否理解 timedelta 的事情。

到目前为止，我有这个代码：

```
from datetime import datetime

tstart = datetime.now()
print t1

# code to speed test

tend = datetime.now()
print t2
# what am I missing?
# I'd like to print the time diff here 
```

* * *

## 回答 #1

> 赞同：230
> 
> 时间：2009-04-19T23:31:01.863

[`datetime.timedelta`](http://docs.python.org/3.2/library/datetime.html#timedelta-objects)只是两个日期时间之间的差异......所以它就像一段时间，以天/秒/微秒为单位

```
>>> import datetime
>>> a = datetime.datetime.now()
>>> b = datetime.datetime.now()
>>> c = b - a

>>> c
datetime.timedelta(0, 4, 316543)
>>> c.days
0
>>> c.seconds
4
>>> c.microseconds
316543 
```

请注意，`c.microseconds`仅返回 timedelta 的微秒部分！出于计时目的，请始终使用`c.total_seconds()`.

您可以使用 datetime.timedelta 进行各种数学运算，例如：

```
>>> c / 10
datetime.timedelta(0, 0, 431654) 
```

不过，查看 CPU 时间而不是挂钟时间可能更有用……尽管这取决于操作系统……在类 Unix 系统下，请查看“时间”命令。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2014-06-17T22:38:54.230

从 Python 2.7 开始，就有了 timedelta.total_seconds() 方法。因此，要获得经过的毫秒数：

```
>>> import datetime
>>> a = datetime.datetime.now()
>>> b = datetime.datetime.now()
>>> delta = b - a
>>> print delta
0:00:05.077263
>>> int(delta.total_seconds() * 1000) # milliseconds
5077 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-04-20T00:18:10.703

您可能想改用[timeit 模块](http://docs.python.org/library/timeit.html)。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2014-05-16T16:32:34.930

我知道这已经很晚了，但我真的很喜欢使用：

```
import time
start = time.time()

##### your timed code here ... #####

print "Process time: " + (time.time() - start) 
```

`time.time()`自纪元以来给你几秒钟。因为这是一个以秒为单位的标准化时间，您可以简单地从结束时间中减去开始时间来获得处理时间（以秒为单位）。`time.clock()`对基准测试很有用，但如果你想知道你的过程花了多长时间，我发现它有点没用。例如，说“我的进程需要 10 秒”比说“我的进程需要 10 个处理器时钟单元”更直观

```
>>> start = time.time(); sum([each**8.3 for each in range(1,100000)]) ; print (time.time() - start)
3.4001404476250935e+45
0.0637760162354
>>> start = time.clock(); sum([each**8.3 for each in range(1,100000)]) ; print (time.clock() - start)
3.4001404476250935e+45
0.05 
```

在上面的第一个示例中， time.clock() 显示的时间为 0.05，而 time.time() 显示的时间为 0.06377

```
>>> start = time.clock(); time.sleep(1) ; print "process time: " + (time.clock() - start)
process time: 0.0
>>> start = time.time(); time.sleep(1) ; print "process time: " + (time.time() - start)
process time: 1.00111794472 
```

在第二个示例中，即使进程休眠了一秒钟，处理器时间也以某种方式显示为“0”。`time.time()`正确显示多于 1 秒。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2009-04-19T23:38:06.387

您还可以使用：

```
import time

start = time.clock()
do_something()
end = time.clock()
print "%.2gs" % (end-start) 
```

或者你可以使用[python profilers](http://docs.python.org/library/profile.html)。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-19T23:17:51.550

下面的代码应该显示时间detla ...

```
from datetime import datetime

tstart = datetime.now()

# code to speed test

tend = datetime.now()
print tend - tstart 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-19T23:16:09.603

您可以简单地打印差异：

```
print tend - tstart 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-19T23:17:18.870

我不是 Python 程序员，但[我确实知道如何使用 Google](http://pleac.sourceforge.net/pleac_python/datesandtimes.html)，这就是我发现的：您使用“-”运算符。要完成您的代码：

```
from datetime import datetime

tstart = datetime.now()

# code to speed test

tend = datetime.now()
print tend - tstart 
```

此外，您似乎可以使用 strftime() 函数来格式化时间跨度计算，以便渲染时间，但会让您感到高兴。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-19T23:41:17.423

您可能需要查看[配置文件](http://docs.python.org/library/profile.html)模块。您将更好地了解减速的位置，并且您的大部分工作将完全自动化。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-02-12T14:35:27.453

箭头：Python 更好的日期和时间

```
import arrow
start_time = arrow.utcnow()
end_time = arrow.utcnow()
(end_time - start_time).total_seconds()  # senconds
(end_time - start_time).total_seconds() * 1000  # milliseconds 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-19T23:19:26.400

time.time() / datetime 适合快速使用，但并不总是 100% 精确。出于这个原因，我喜欢使用其中一个 std lib[分析器](http://docs.python.org/library/profile.html)（尤其是 hotshot）来找出什么是什么。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-10-20T17:54:51.573

这是一个模仿 Matlab/Octave 函数的自定义`tic` `toc`函数。

**使用示例：**

```
time_var = time_me(); # get a variable with the current timestamp

... run operation ...

time_me(time_var); # print the time difference (e.g. '5 seconds 821.12314 ms') 
```

**功能 ：**

```
def time_me(*arg):
    if len(arg) != 0: 
        elapsedTime = time.time() - arg[0];
        #print(elapsedTime);
        hours = math.floor(elapsedTime / (60*60))
        elapsedTime = elapsedTime - hours * (60*60);
        minutes = math.floor(elapsedTime / 60)
        elapsedTime = elapsedTime - minutes * (60);
        seconds = math.floor(elapsedTime);
        elapsedTime = elapsedTime - seconds;
        ms = elapsedTime * 1000;
        if(hours != 0):
            print ("%d hours %d minutes %d seconds" % (hours, minutes, seconds)) 
        elif(minutes != 0):
            print ("%d minutes %d seconds" % (minutes, seconds))
        else :
            print ("%d seconds %f ms" % (seconds, ms))
    else:
        #print ('does not exist. here you go.');
        return time.time() 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-11-04T12:41:01.847

您需要`time.time()`改用它，它以高精度输出 unix 时间。

使用此代码：

```
from time import time

tstart = time()
doSomething()
tend = time()
difference = tend - tstart
print("The doSomething function took {} seconds to execute".format(difference)) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-09-27T08:41:52.347

您可以像这样使用 timeit 来测试名为 module.py 的脚本

```
$ python -mtimeit -s 'import module' 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-02-24T04:18:09.237

```
start = datetime.now() 

#code for which response time need to be measured.

end = datetime.now()
dif = end - start
dif_micro = dif.microseconds # time in microseconds
dif_millis = dif.microseconds / 1000 # time in millisseconds 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-10-29T21:35:49.007

如果有人需要这样的东西来分析日志条目之间的延迟，例如......等。

```
def get_time_diff_between_timestruct_tuples(timestruct_tuples):
    """
    expecting input like:
    [(0, datetime.datetime(2021, 10, 27, 16, 6, 8, 590892)),
    (1, datetime.datetime(2021, 10, 27, 16, 6, 8, 591833)),
    (2, datetime.datetime(2021, 10, 27, 16, 6, 9, 434053)),
    (3, datetime.datetime(2021, 10, 27, 16, 6, 9, 878021)), ...]

    output like:
    [0.941, 0.84222, 0.443968, ...]
    """

    def seconds_mms_diff(t0, t1):
        diff = t1 - t0
        s = diff.seconds
        mms = diff.microseconds
        return float(f"{s}.{mms}")

    timediffs = []
    init = timestruct_tuples[0][1]
    idx = 0
    while idx < (len(timestruct_tuples)-1):
        timediffs.append(seconds_mms_diff(init, timestruct_tuples[idx+1][1]))
        idx += 1
        init = timestruct_tuples[idx][1]
    return timediffs 
```

# c# - 适用于 Windows 窗体的可停靠自动隐藏面板控件

> ID：766336
> 
> 赞同：6
> 
> 时间：2009-04-19T23:08:51.510
> 
> 标签：c#, winforms

我正在创建一个 Windows 窗体应用程序，我希望拥有与 SQL Server 的 Management Studio 相似的外观和感觉，即左侧有一个很好的自动隐藏和可停靠面板。

一个类似的控件是 Visual Studio 的“工具箱”。

Management Studio 的对象资源管理器是什么类型的控件？我在哪里可以买到？我在 Windows 窗体项目中使用 .NET 3.5。

谢谢

-马特

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-19T23:40:30.810

基类库不提供这种类型的控件。您可以做一些事情来使窗口看起来像那些（更改边框样式）或具有停靠面板，但自动隐藏/可移动停靠/等功能超出了 BCL 的功能。

但是，可以购买许多第三方解决方案。

以下是五个相当常见的：

[Devexpress XtraBars](http://www.devexpress.com/Products/NET/Controls/WinForms/Bars/)

[Telerik RadDock](http://www.telerik.com/products/winforms/dock.aspx)

[Actipro UIStudio 对接](http://www.actiprosoftware.com/products/dotnet/WindowsForms/UIStudio/DockDefault.aspx)

[基础设施 WinDockManager](http://www.infragistics.com/dotnet/netadvantage/winforms/windockmanager.aspx#Overview)

[Janus UIPanelManager](http://www.janusys.com/controls/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-10-13T20:24:38.010

这是一个我发现非常好的开源版本。 [http://sourceforge.net/projects/dockpanelsuite/](http://sourceforge.net/projects/dockpanelsuite/)

# ruby-on-rails - 在最后一个 has_many :through 记录被删除后销毁关联

> ID：766339
> 
> 赞同：9
> 
> 时间：2009-04-19T23:10:33.940
> 
> 标签：ruby-on-rails, activerecord, has-many-through

使用常规`has_many`，可以选择`:dependent => :destroy`在删除父记录时删除关联。使用`has_many :through`，可能有其他父母与子记录相关联，因此`:dependent => :destroy`没有任何影响。

您如何确保子记录在上一次 HMT 关联中被孤立后被删除？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-19T23:33:41.717

我找到的解决方案似乎是一个`after_destroy`回调，例如：

```
class Parent < ActiveRecord::Base
  has_many :children, :through => :parentage
  after_destroy :destroy_orphaned_children

  private

  def destroy_orphaned_children
    children.each do |child|
      child.destroy if child.parents.empty?
    end
  end

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T23:35:52.450

在连接模型上，使用“belongs_to :model,dependent: :destroy”

例如，如果您想在医生被销毁后销毁患者，并且医生通过约会拥有_many 个患者

```
Class Appointment
  belongs_to :doctor
  belongs_to :patient, dependent: :destroy

Class Doctor
  has_many :appointments, dependent: :destroy
  has_many :patients, through: :appointments

Class Patient
  has_many :appointments
  has_many :doctors, through: :appointments 
```

# java - 自 2001 年以来，了解 Java 语法变化的最佳方式是什么？

> ID：766346
> 
> 赞同：1
> 
> 时间：2009-04-19T23:14:31.183
> 
> 标签：java, syntax

**重复：** [我如何才能最好地赶上 Java 的最新发展？](https://stackoverflow.com/questions/638192/how-do-i-best-catch-up-with-the-latest-developments-in-java)

我一直在研究一个在 2001 年左右被冻结的 Java 代码库。因此，从那时起我就没有费心去学习任何新的 Java 语法。

今天看到这段代码，认出它是近十年来一定要引入的语法。

```
private ArrayList<String> colors = new ArrayList<String>(); 
```

哪个版本的 Java 引入了这种尖括号表示法？

以及了解自 2001 年以来该语言的其他重大变化的好方法是什么？在那个日期之前，我对所有事情都有很好的把握。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T23:24:52.080

在最近的所有 Java 版本中，Java 5 对该语言进行了最大和最明显的更改。 [摘要](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html)列出了所有新功能。简单来说：

*   [自动装箱](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html#boxing)
*   [枚举](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html#enums)，例如，`enum Season { WINTER, SPRING, SUMMER, FALL }`
*   [泛型](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html#generics)，例如，`Collection<String> coll;`而不是`Collection coll;`
*   [增强 for 循环](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html#forloop)，例如，`for (String str : coll)`
*   [可变参数](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html#varargs)，例如，`private void function(Object... arguments);`
*   [静态导入](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html#static_import)
*   [注释](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html#annotations)，例如，`@Override`或`@Deprecated`
*   `String.format`像 Java 版本的`printf()`

Java 4 也引入了一些新特性，主要是[断言](http://java.sun.com/j2se/1.4.2/docs/guide/lang/assert.html)。

[如果您喜欢书籍，可以从Java 5.0 Tiger: A Developer's Notebook 一](http://oreilly.com/catalog/9780596007386/)书中了解 Java 5 的变化。这不是您能找到的最全面的书，但它很好且快速地介绍了 Java 5 的所有新特性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T23:19:36.150

您指的是 Java SE 1.5（或 Java 5）中引入的泛型。枚举在 Java 5 版本以及 Java 自动装箱和拆箱、注释等方面变得更加令人兴奋。

[http://java.sun.com/j2se/1.5.0/docs/guide/language/generics.html](http://java.sun.com/j2se/1.5.0/docs/guide/language/generics.html)

[http://java.sun.com/j2se/1.5.0/docs/guide/language/enums.html](http://java.sun.com/j2se/1.5.0/docs/guide/language/enums.html)

概述：http: [//java.sun.com/j2se/1.5.0/docs/guide/language/](http://java.sun.com/j2se/1.5.0/docs/guide/language/)

如果您想快速了解 Java 6，请查看[http://java.sun.com/javase/6/features.jsp](http://java.sun.com/javase/6/features.jsp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T23:17:02.630

为了回答您的部分问题，自动装箱是在 1.5 中引入的

[http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T23:17:03.753

<> 符号与泛型（如模板）有关。与大多数重大更改一样，Java 5 中引入了这一点，以及许多其他语言特性。

以下是 Java 5 的更新：http: [//java.sun.com/j2se/1.5.0/docs/relnotes/features.html](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html)

您可以在 Java 教程中找到有关特定更改的详细信息。

据我所知，更高版本（例如1.6）的变化并不大：http: [//java.sun.com/developer/technicalArticles/J2SE/Desktop/javase6/beta2.html](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/javase6/beta2.html)

# c# - 即使 ODBC 数据源已更改，连接也相同

> ID：766350
> 
> 赞同：0
> 
> 时间：2009-04-19T23:16:42.740
> 
> 标签：c#, caching, windows-services, odbc

我有一个 .Net 服务，它有一个包含 ODBC 连接的字符串列表，我在循环中使用这些来检查多个数据库以查找要处理的任务（例如轮询）。

但是，如果我更改 ODBC 连接指向的位置..由于某种原因更改其默认数据库，即使我只存储 ODBC 连接的字符串名称，在我重新启动应用程序之前它不会接受更改。

.net 是否以某种方式在启动时缓存所有 odbc 连接？

我该如何解决这个问题？

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T23:20:28.503

如果您的设置存储在 app.config 中，这里有一个问题可能会有所帮助：

[可以在运行时切换 app.config 吗？](https://stackoverflow.com/questions/436700/is-switching-app-config-at-runtime-possible)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T04:37:33.233

检查`Connection Pooling`您在控制面板窗口中使用的 ODBC 驱动程序是否启用`ODBC Data Sources`（这不是 .NET 问题）。成功的连接将保留在池中，而不会刷新其新的连接属性。

# java - 如何用java将汉字保存到文件中？

> ID：766361
> 
> 赞同：10
> 
> 时间：2009-04-19T23:20:19.097
> 
> 标签：java, file, character-encoding, cjk

我使用下面的代码将汉字保存到一个.txt文件中，但是当我用写字板打开它时，我无法阅读它。

```
StringBuffer Shanghai_StrBuf = new StringBuffer("\u4E0A\u6D77");
boolean Append = true;

FileOutputStream fos;
fos = new FileOutputStream(FileName, Append);
for (int i = 0;i < Shanghai_StrBuf.length(); i++) {
    fos.write(Shanghai_StrBuf.charAt(i));
}
fos.close(); 
```

我能做些什么 ？我知道如果我将汉字剪切并粘贴到写字板中，我可以将其保存为 .txt 文件。我如何在 Java 中做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-20T10:14:02.207

这里有几个因素在起作用：

*   文本文件没有用于描述其编码的内在元数据（关于尖括号税的所有讨论，XML 流行是有原因的）
*   Windows 的默认编码仍然是 8 位（或双字节）“ [ANSI](http://blogs.msdn.com/oldnewthing/archive/2004/05/31/144893.aspx) ”字符集，值范围有限 - 以这种格式编写的文本文件不可移植
*   为了从 ANSI 文件中区分 Unicode 文件，Windows 应用程序依赖于文件开头是否存在[字节顺序标记](http://unicode.org/faq/utf_bom.html#bom4)（[严格来说并非如此 - Raymond Chen 解释](http://blogs.msdn.com/oldnewthing/archive/2007/04/17/2158334.aspx)道）。从理论上讲，BOM 可以告诉您数据的[字节顺序](http://en.wikipedia.org/wiki/Endianness)（字节顺序）。对于 UTF-8，即使只有一个字节顺序，Windows 应用程序也依赖标记字节来自动确定它是 Unicode（尽管您会注意到记事本在其打开/保存对话框中有一个编码选项）。
*   说 Java 坏了是错误的，因为它不会自动编写 UTF-8 BOM。例如，在 Unix 系统上，将 BOM 写入脚本文件是错误的，并且许多 Unix 系统使用 UTF-8 作为其默认编码。有时您也不希望在 Windows 上使用它，例如将数据附加到现有文件时：`fos = new FileOutputStream(FileName,Append);`

这是一种可靠地将 UTF-8 数据附加到文件的方法：

```
 private static void writeUtf8ToFile(File file, boolean append, String data)
      throws IOException {
    boolean skipBOM = append && file.isFile() && (file.length() > 0);
    Closer res = new Closer();
    try {
      OutputStream out = res.using(new FileOutputStream(file, append));
      Writer writer = res.using(new OutputStreamWriter(out, Charset
          .forName("UTF-8")));
      if (!skipBOM) {
        writer.write('\uFEFF');
      }
      writer.write(data);
    } finally {
      res.close();
    }
  } 
```

用法：

```
 public static void main(String[] args) throws IOException {
    String chinese = "\u4E0A\u6D77";
    boolean append = true;
    writeUtf8ToFile(new File("chinese.txt"), append, chinese);
  } 
```

注意：如果文件已经存在并且您选择附加并且现有数据*不是*UTF-8 编码的，那么代码将创建的唯一东西就是一团糟。

这是`Closer`此代码中使用的类型：

```
public class Closer implements Closeable {
  private Closeable closeable;

  public <T extends Closeable> T using(T t) {
    closeable = t;
    return t;
  }

  @Override public void close() throws IOException {
    if (closeable != null) {
      closeable.close();
    }
  }
} 
```

此代码对如何根据字节顺序标记读取文件进行了 Windows 风格的最佳猜测：

```
 private static final Charset[] UTF_ENCODINGS = { Charset.forName("UTF-8"),
      Charset.forName("UTF-16LE"), Charset.forName("UTF-16BE") };

  private static Charset getEncoding(InputStream in) throws IOException {
    charsetLoop: for (Charset encodings : UTF_ENCODINGS) {
      byte[] bom = "\uFEFF".getBytes(encodings);
      in.mark(bom.length);
      for (byte b : bom) {
        if ((0xFF & b) != in.read()) {
          in.reset();
          continue charsetLoop;
        }
      }
      return encodings;
    }
    return Charset.defaultCharset();
  }

  private static String readText(File file) throws IOException {
    Closer res = new Closer();
    try {
      InputStream in = res.using(new FileInputStream(file));
      InputStream bin = res.using(new BufferedInputStream(in));
      Reader reader = res.using(new InputStreamReader(bin, getEncoding(bin)));
      StringBuilder out = new StringBuilder();
      for (int ch = reader.read(); ch != -1; ch = reader.read())
        out.append((char) ch);
      return out.toString();
    } finally {
      res.close();
    }
  } 
```

用法：

```
 public static void main(String[] args) throws IOException {
    System.out.println(readText(new File("chinese.txt")));
  } 
```

（System.out 使用默认编码，因此它是否打印任何合理的内容取决于您的平台和[配置](http://illegalargumentexception.blogspot.com/2009/04/java-unicode-on-windows-command-line.html)。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-19T23:34:02.150

如果您可以相信默认字符编码是 UTF-8（或其他一些 Unicode 编码），则可以使用以下内容：

```
 Writer w = new FileWriter("test.txt");
    w.append("上海");
    w.close(); 
```

最安全的方法是始终明确指定编码：

```
 Writer w = new OutputStreamWriter(new FileOutputStream("test.txt"), "UTF-8");
    w.append("上海");
    w.close(); 
```

PS 如果 javac 的 -encoding 参数配置正确，您可以在 Java 源代码中使用任何 Unicode 字符，甚至作为方法和变量名称。这使得源代码比转义`\uXXXX`形式更具可读性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T00:39:19.530

对建议的方法要非常小心。甚至指定文件的编码如下：

Writer w = new OutputStreamWriter(new FileOutputStream("test.txt"), "UTF-8");

如果您在 Windows 等操作系统下运行，则无法正常工作。即使将 file.encoding 的系统属性设置为 UTF-8 也不能解决问题。这是因为 Java 无法为文件写入字节顺序标记 (BOM)。即使您在写入文件时指定了编码，在写字板等应用程序中打开同一个文件也会将文本显示为垃圾，因为它不会检测 BOM。我尝试在 Windows 中运行这些示例（使用 CP1252 的平台/容器编码）。

存在以下错误来描述 Java 中的问题：

[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508058](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508058)

暂时的解决办法是自己写字节序标记，以确保文件在其他应用程序中正确打开。有关 BOM 的更多详细信息，请参见此处：

[http://mindprod.com/jgloss/bom.html](http://mindprod.com/jgloss/bom.html)

对于更正确的解决方案，请参见以下链接：

[http://tripoverit.blogspot.com/2007/04/javas-utf-8-and-unicode-writing-is.html](http://tripoverit.blogspot.com/2007/04/javas-utf-8-and-unicode-writing-is.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T23:42:24.097

这是众多方法中的一种。基本上，我们只是指定在将字节输出到 FileOutputStream 之前完成到 UTF-8 的转换：

```
String FileName = "output.txt";

StringBuffer Shanghai_StrBuf=new StringBuffer("\u4E0A\u6D77");
boolean Append=true;

Writer writer = new OutputStreamWriter(new FileOutputStream(FileName,Append), "UTF-8");
writer.write(Shanghai_StrBuf.toString(), 0, Shanghai_StrBuf.length());
writer.close(); 
```

我针对[http://www.fileformat.info/info/unicode/char/](http://www.fileformat.info/info/unicode/char/)上的图像手动验证了这一点。将来，请遵循 Java 编码标准，包括小写变量名。它提高了可读性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T00:01:20.213

试试这个，

```
StringBuffer Shanghai_StrBuf=new StringBuffer("\u4E0A\u6D77");
    boolean Append=true;

    Writer out = new BufferedWriter(new OutputStreamWriter(
        new FileOutputStream(FileName,Append), "UTF8"));
    for (int i=0;i<Shanghai_StrBuf.length();i++) out.write(Shanghai_StrBuf.charAt(i));
    out.close(); 
```

# python - Python 非贪婪正则表达式

> ID：766372
> 
> 赞同：207
> 
> 时间：2009-04-19T23:24:03.487
> 
> 标签：python, regex, regex-greedy

`"(.*)"`给定`"a (b) c (d) e"`python 匹配`"b"`而不是 ，如何制作这样的 python 正则表达式`"b) c (d"`？

我知道我可以使用`"[^)]"`而不是`"."`，但我正在寻找一个更通用的解决方案，让我的正则表达式更简洁。有没有办法告诉python“嘿，尽快匹配这个”？

* * *

## 回答 #1

> 赞同：303
> 
> 时间：2009-04-19T23:27:21.917

你寻求全能者`*?`

来自文档，[贪婪与非贪婪](http://docs.python.org/3/howto/regex.html#greedy-versus-non-greedy)

> 非贪婪限定符`*?`, `+?`, `??`, 或`{m,n}?`[...] 匹配尽可能*少的* 文本。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-04-19T23:31:33.343

```
>>> x = "a (b) c (d) e"
>>> re.search(r"\(.*\)", x).group()
'(b) c (d)'
>>> re.search(r"\(.*?\)", x).group()
'(b)' 
```

[根据文档](http://docs.python.org/library/re.html#regular-expression-syntax)：

> ' `*`'、' `+`' 和 ' `?`' 限定符都是贪婪的；它们匹配尽可能多的文本。有时这种行为是不希望的；如果 RE`<.*>`与 ' `<H1>title</H1>`' 匹配，它将匹配整个字符串，而不仅仅是 ' `<H1>`'。在限定符之后添加 ' `?`' 使其以非贪婪或最小方式执行匹配；将匹配尽可能少的字符。`.*?`在前面的表达式中使用将只匹配 ' `<H1>`'。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-19T23:28:04.240

行不通`\\(.*?\\)`？那是非贪婪的语法。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-21T18:01:15.117

使用不贪婪的匹配是一个好的开始，但我也建议您重新考虑使用`.*`-- 这个怎么样？

```
groups = re.search(r"\([^)]*\)", x) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-19T23:54:55.907

你想让它匹配“（b）”吗？按照 Zitrax 和 Paolo 的建议去做。你想让它匹配“b”吗？做

```
>>> x = "a (b) c (d) e"
>>> re.search(r"\((.*?)\)", x).group(1)
'b' 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-21T18:06:23.437

正如其他人所说，使用 ? * 量词上的修饰符将解决您的直接问题，但要小心，您开始误入正则表达式停止工作的区域，而您需要一个解析器。例如，字符串 "(foo (bar)) baz" 会给你带来麻烦。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-26T11:38:48.720

首先，我不建议在正则表达式中使用“*”。是的，我知道，它是最常用的多字符分隔符，但它仍然是个坏主意。这是因为，虽然它确实匹配该字符的任何重复次数，但“任何”包含 0，这通常是您想要抛出语法错误而不是接受的东西。相反，我建议使用`+`与长度 > 1 的任何重复匹配的符号。此外，据我所知，您正在处理固定长度的括号表达式。因此，您可能可以使用`{x, y}`语法来专门指定所需的长度。

但是，如果你真的需要非贪婪的重复，我建议咨询全能的`?`. 这，当放置在任何正则表达式重复说明符的末尾时，将强制正则表达式的该部分找到尽可能少的文本。

话虽这么说，我会非常小心`?`，就像 Dr. Who 中的 Sonic 螺丝刀一样，如果不仔细校准，我应该怎么说，“有点”不受欢迎的东西。例如，要使用您的示例输入，它会将`((1)`（注意缺少第二个 rparen）标识为匹配项。

# css - 好的 CSS 设计和 IE6 / IE7 支持是互斥的吗？

> ID：766381
> 
> 赞同：3
> 
> 时间：2009-04-19T23:30:33.987
> 
> 标签：css, internet-explorer, standards-compliance

像每个 Web 开发人员一样，我通常每周至少诅咒 IE6 的创建者一次犯规和过早死亡。然而，我的公司要求我继续支持最讨厌的浏览器。

我今天的问题是想首先在我的 CSS 中使用通配符，然后尝试使用“继承”属性。IE7-都不支持这两者。

我真的，真的很想拥有良好的、结构良好的、适当继承的 CSS（面向对象的 CSS，如果你喜欢这个流行词），但我有一种在我的胃里迟早会下沉的感觉是自定义目的和基于位置的类。

这就提出了一个问题：考虑到 IE 在处理许多 CSS 概念方面是多么糟糕，是否不可能在拥有结构良好的 CSS 文档的同时充分支持该浏览器？

澄清一下：我知道有很多方法（一些合法，一些不太合法）来解决 IE6 和 7 中发现的错误和缺点。我真正要问的是“如果你想要一个，正确继承的编写良好的样式表，你必须在它和在所有浏览器中保持一致的外观之间做出选择吗？”。希望这是有道理的。

换句话说，我应该坚持我的原则并编写一个好的样式表，还是我应该接受 IE6 仍然享有非常高的市场份额（最后统计为 20%）并让自己支持它？或者是否有一些快乐的媒介可以让我最小化我的 HTML 和 CSS 上的科学怪人手术，同时仍然在 IE 中取得一些可观的结果？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-20T00:33:17.203

公平地说，你不能把这一切都归咎于 IE（尽管微软肯定是迄今为止最糟糕的违规者）。如此庞大且快速发展的标准的部分问题在于，它是一个移动的目标，无法及时完美地实施。不幸的是，Web 浏览器的发布周期与新 Web 规范的发布不一致。因此，所有浏览器开发人员所能做的就是尝试从最新的 W3C 建议中实现尽可能多的特性，选择*他们认为*最常用的特性来首先实现。

然而，事情显然在改善，支持 IE6/7 并且仍然使用正确的 CSS 设计*是可能的。*只是……很难。看看[这个布局引擎和 CSS 支持的比较](http://en.wikipedia.org/wiki/CSS_support)。如果您查看总体趋势，您会发现大多数浏览器（甚至 IE）从长远来看确实倾向于遵守既定标准，只是一些浏览器在引入标准后比其他浏览器需要更长的时间来实施标准。

有时并不是一个浏览器比另一个浏览器“更少”符合标准。对于新标准，问题通常是不同的开发团队选择采用新规范的*不同部分*。因此，尽管大多数浏览器已经开始实现 CSS3，但我们可能必须等到 CSS4 发布后才能看到所有主要渲染引擎的一致支持。如果您现在尝试使用最新的 CSS3 功能，您将很难在所有主流浏览器之间建立兼容性。但是如果你使用的是 CSS1 中引入的特性，那完全没有问题。

因此，除了使用丑陋的 CSS hack 之外，唯一的选择是坚持使用完善的*旧*规范。那么问题就不再是***在支持特定浏览器的同时尝试符合 web 标准了***。相反，问题只是***试图抵制使用最新和最伟大的 CSS 功能的冲动***。

除此之外，对于这种反复出现的情况，我看到的唯一永久解决方案是 W3C 对新引入规范的不同部分进行**优先级排序**，以便新功能可以在所有主要浏览器同步的离散阶段中实现。因此，例如，语法规则可能被赋予最高优先级以及其实施的设定期限。之后将进入第二阶段，可能是元素和属性选择器，依此类推。

这需要 W3C 和开发团队之间的高度合作，但这是值得的。毕竟，IE 实现 CSS3 的一个功能子集对用户和 Web 开发人员没有好处，而 Firefox 实现了不同的子集，而 Webkit 浏览器又实现了另一个子集。在所有主要渲染平台真正*标准化*之前，“标准”并不好。**每个浏览器都支持较少的新功能，但它们都具有*相同的功能*，这比它们单独引入大量不被普遍支持的自己的功能要好。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T23:50:16.077

[一点也不——您可以通过条件注释](http://www.positioniseverything.net/articles/cc-plus.html)和 IE 特定样式表来弥补 IE 的缺点，同时将您的“漂亮”样式表提供给其他浏览器。

我发现有帮助的其他方法是使用[CSS reset](http://developer.yahoo.com/yui/reset/)。虽然这并不能解决 IE 的所有问题，但它确实为您提供了一个很好的工作基准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T00:03:08.213

最讨厌的 IE6*功能*是它的盒子模型处理。在定位框时，您应该坚持使用边距，并尝试使用相对字体大小来允许在 IE 上调整字体大小。其余的怪癖有[据可查](http://www.quirksmode.org/css/quirksmode.html)。

使用[条件注释](http://www.quirksmode.org/css/condcom.html)是为表现良好的浏览器提供干净的样式表并在 IE 上仍然使用美观的最干净的方式。这就是我使用的，只需要几行的 1 个 css 文件来修复我的网站外观。

跨浏览器一致外观和感觉的*黑暗*路径是[css hacks](http://www.webdevout.net/css-hacks)，但我强烈反对使用它，特别是现在有一段时间我们必须针对三个不同的 IE（6、7 和 8）

通常，如果您使该样式在 FF 和 Chrome/Safari 中都可以使用，那么 IE 只需进行几次更正即可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T00:25:18.127

有一个很棒的网站[Position Is Everything](http://www.positioniseverything.net/)详细说明了 FF、IE 和 Safari 如何符合标准 CSS。在该站点上，您将找到大多数针对 IE 的变通方法/解决方法，它们将减轻您为 CSS 编写如此多条件代码的需要。

您还需要查看[A List Apart](http://www.alistapart.com/)以了解有关 CSS 和 IE 的更多信息。也有很棒的文章关于使用 CSS 的无表格布局、处理 IE 中的高度错误等。祝你好运 - IE 6 在 CSS 方面真的很糟糕。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T10:10:20.390

当然不是。如果您确保它们以“标准”模式而不是“怪癖”模式呈现页面，那么许多常见的 IE CSS 问题都会得到解决。为此，您必须在页面顶部提供有效的 doctype 语句，例如

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

正如其他人所指出的那样，另一个好主意是从您的样式表开始，使用一个删除所有填充和边距的片段，如下所示：

```
*,html {
margin: 0;
padding: 0;
} 
```

最后，IE 中基于 CSS 的布局的一个常见问题是浮动的清除不会在您期望的时候发生。这与 IE 中名为“hasLayout”的隐藏对象属性有关；只有“具有布局”的对象才能正确环绕并包围浮动的子对象。只需为容器指定至少一个维度，即可轻松确保容器“具有布局”：

```
height: 1%;
width: 100%;
zoom: 1; 
```

我个人不使用条件 IE 样式表，除了一件事：在 IE < 7 中用 GIF 替换 PNG 背景 - 使用它们没有任何问题，我只是发现当您必须定义相同的外观时，它会使事情变得不必要地复杂化对象在两个不同的地方。有了上面的三个技巧和一点耐心，您应该能够使用单个样式表创建基于 CSS 的布局，该样式表在 IE 6/7 中的渲染效果与在 Mozilla/Webkit 中一样好。

快乐编码！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-21T00:28:17.570

IE 6 确实限制了我们的能力。

正是缺乏对高级选择器的支持（并且继承——IE 7 也不支持）这让我很感动。仅仅拥有子选择器和属性选择器就很好了，这确实减少了我们必须编写和维护的代码量。您只能通过复制样式来解决对它们缺乏支持的问题，因此您最终不得不像它们不存在一样编写代码。

叹。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-20T00:02:48.353

仅遵循使用 IE6 和 Chrome（或 Webkit）正确呈现的在线 CSS 教程。如果它在两者中看起来都正确，那么它可能在（几乎）所有浏览器中看起来都正确。

# c - 为什么这允许从 (char *) 提升到 (const char *)？

> ID：766386
> 
> 赞同：4
> 
> 时间：2009-04-19T23:31:51.843
> 
> 标签：c

鉴于 scanf 在[Microsoft 的文档中有 (const char *) 以及对](http://msdn.microsoft.com/en-us/library/zkx076cy.aspx)[这个问题](https://stackoverflow.com/questions/766290/shouldnt-it-be-permissible-to-convert-from-char-to-const-char)的回答，当我将 (char **) 提升为 (const char **) 时，到底发生了什么？

基本上为什么会编译？

```
#include <stdio.h>
int main(int argc, char **argv)
{   
    char szArray[50];
    int  i = 0;
    strcpy(szArray,"10");
    /* the following code is upcasting the (char *) to (const char *) */
    sscanf(szArray,"%d",&i);
    return 0;  
} 
```

为什么不能编译？

```
#include <stdio.h>
void processargs(const char **p)
{ 
}
int main(int argc, char **argv)
{
    processargs(argv);          
    return 0;  
} 
```

两者似乎都对指针做同样的事情！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-19T23:39:30.920

`char** -> const char **`很危险，因为您最终可能会意外修改底层`const`对象。

写你想要的正确方法是：

```
void processargs(const char * const *p)
{ 
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T23:36:27.590

您可以增加访问限制，但不能减少它。从普通指针到 const 指针很好，从 const 指针到普通指针则不行。

第二个示例无法编译，因为您没有将指针转换为 const 指针，而是将指针从一种类型 ( `char*`) 转换为另一种 ( `const char*`)。例如，您可以将 a 更改`char**`为 a `char* const*`，但不能将 a更改为`const char**`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T00:00:53.787

检查这是否为您澄清：

```
char * a_mutable = /*...*/;
const char * a_constant = /*...*/;

char **pointer_to_mutable = &a_mutable;   /* ok */

const char **pointer_to_constant = &a_constant;   /* ok */

pointer_to_constant = pointer_to_mutable;   /* oops, are you sure? */

*pointer_to_constant = a_mutable;   /* valid, but will screw things around */ 
```

最后一行是有效的，因为`pointer_to_constant`它是一个指向常量字符的可变指针的可变指针，但它会破坏事情，因为你`a_constant`指向`a_mutable`. 这就是为什么您不允许`pointer_to_constant`接收`pointer_to_mutable`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T23:51:23.263

您的第一个示例有效，因为您正在将*rvalues*`char*`转换为，`const char*`这没关系（基本上是因为您不能分配给 rvalues）。第二个没有，因为（非常量）指针的目标始终是左值。

只需尝试（也许在编译器的帮助下）您可以使用哪些操作`char**`，哪些可以使用`const char**`，并考虑是否以及哪些类型可以互换。

# regex - 多项式时间内可能最长的正则表达式是多少？

> ID：766389
> 
> 赞同：0
> 
> 时间：2009-04-19T23:33:10.827
> 
> 标签：regex, complexity-theory

[正则表达式替换的复杂性](https://stackoverflow.com/questions/21669/complexity-of-regex-substitution)问题接近问题，但并不相同。根据theprise的回复，（DFA引擎的）复杂度是：

> O(2^m + n) [其中 m 是正则表达式的长度，n 是字符串的长度]

红皮书《算法设计手册》第15-16页讨论了不同算法的时间。据此，当算法长度超过 1,000,000 时，O(m^2) 的算法就没有希望了。处理时间为 16.7 分钟，假设运算时间为 1 纳秒。

书中的陈述增加了我的兴趣。你能在 16.7 分钟的处理时间内完成 1,000,000 个字符的正则表达式吗？你能做一个灾难性的正则表达式并且处理时间仍然存在吗？我真的很怀疑。

> 多项式时间内运算时间为一纳秒的最长可能正则表达式是多少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T00:45:48.517

这是一个毫无意义的问题。正则表达式不是一种算法，它们是一种语言。这种语言的许多实现都有自己的性能特征，每个单独的正则表达式都有自己的成本。例如，交替`/(a|b|c)/`是一个可并行化的问题，因此并行执行表达式的引擎将比那些不并行执行的引擎具有更好的性能。

This is similar to asking what is the best case for sorting. Some people will tell you `O(n log n)`, but they would be wrong. There answer depends on the algorithm used. There are some sorts (such as [radix sort](http://en.wikipedia.org/wiki/Radix_sort)) that have a worst case of `O(n)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T23:49:59.010

实际的复杂性可能取决于特定的正则表达式。1000000 'a 的简单匹配大约需要 10 秒：

```
import re

expr = 'a' * 1000000
re.match(expr, expr) 
```

这种情况下的复杂度似乎约为 O(m)，但更复杂的表达式肯定会花费更长的时间。

# java - Prim算法的实现

> ID：766393
> 
> 赞同：2
> 
> 时间：2009-04-19T23:34:55.970
> 
> 标签：java, algorithm, priority-queue, prims-algorithm

对于我的 CS 类，我需要在 Java 中实现 Prim 算法，并且我在优先级队列步骤中遇到问题。我有优先级队列的经验，并且了解它们通常可以工作，但我在某个特定步骤时遇到了麻烦。

```
Prim(G,w,r)
  For each u in V[G]
    do key[u] ← ∞ 
       π[u] ← NIL  
  key[r] ← 0
  Q ← V[G]  
  While Q ≠ Ø
    do u ← EXTRACT-MIN(Q)
       for each v in Adj[u]
            if v is in Q and w(u,v) < key[v]
                 then π[v] ← u
                       key[v] ← w(u,v) 
```

我创建了一个包含键值（我假设它是连接到节点的最轻的边缘）和父节点的节点类。我的问题是我不明白将节点添加到优先级队列中。当父节点设置为 NIL 并将键设置为 ∞ 时，将所有节点添加到优先级队列对我来说没有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T00:27:38.233

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T12:21:59.017

如果你不想使用 PriorityQueue，[这里](https://stackoverflow.com/a/23504707/1277373)是我在 Java 中的 Heap 实现。你可以用 MinHeap 替换 PriorityQueue。

```
package algo2;

import java.io.DataInputStream;
import java.io.InputStream;
import java.util.HashMap;
import java.util.Map;
import java.util.PriorityQueue;

public class Prims {

private static final class GNode implements Comparable<GNode> {
    // unique id of the node
    int id;

    // map of child nodes and their respective distance from current node 'id'
    Map<GNode, Integer> children = new HashMap<GNode, Integer>();

    // used in future computation, to store minimal/optimal updated distance
    int distFromParent=0;

    public GNode(int i) {
        this.id=i;
    }

    @Override
    public int compareTo(GNode o) {
        return this.distFromParent-o.distFromParent;
    }

    @Override
    public String toString() {
        return "GNode [id=" + id + ", distFromParent=" + distFromParent
                + "]";
    }
}

static long findLengthOfMST(GNode[] nodes) {
    PriorityQueue<GNode> pq = new PriorityQueue<GNode>();
    boolean[] visited = new boolean[nodes.length];
    boolean[] exited = new boolean[nodes.length];
    pq.add(nodes[1]);
    visited[1] = true;
    long sum = 0;
    int count = 0;
    while (pq.size() > 0) {
        GNode o = pq.poll();
        if (!exited[o.id]) {
            for (GNode n : o.children.keySet()) {
                if (exited[n.id]) {
                    continue;
                }
                if (visited[n.id]) {
                    if (n.distFromParent >= o.children.get(n)) {
                        n.distFromParent = o.children.get(n);
                    }
                } else {
                    visited[n.id] = true;
                    n.distFromParent = o.children.get(n);
                    pq.add(n);
                }
            }
            sum += o.distFromParent;
            exited[o.id] = true;
            count++;
        }
        if (pq.size() == 0) {
            for (int i = 1; i < nodes.length; i++) {
                if (!exited[i]) {
                    pq.add(nodes[i]);
                }
            }
        }
    }
    System.out.println(count);
    return sum;
}

public static void main(String[] args) {
    StdIn s = new StdIn(System.in);
    int V = s.nextInt();
    int E = s.nextInt();
    GNode[] nodes = new GNode[V+1];
    for (int i = 0; i < E; i++) {
        int u = s.nextInt();
        int v = s.nextInt();
        GNode un = nodes[u];
        GNode vn = nodes[v];
        if (un == null) {
            un = new GNode(u);
            nodes[u] = un;
        }
        if (vn == null) {
            vn = new GNode(v);
            nodes[v] = vn;
        }

        int w = s.nextInt();
        un.children.put(vn, w);
        vn.children.put(un, w);
    }
    long len = findLengthOfMST(nodes);
    System.out.println(len);
}

private static class StdIn {
    final private int BUFFER_SIZE = 1 << 17;
    private DataInputStream din;
    private byte[] buffer;
    private int bufferPointer, bytesRead;
    public StdIn(InputStream in) {
    din = new DataInputStream(in);
    buffer = new byte[BUFFER_SIZE];
    bufferPointer = bytesRead = 0;
    }
    public int nextInt() {int ret = 0;byte c = read();while (c <= ' ')c = read();boolean neg = c == '-';if (neg)c=read();do{ret=ret*10+c-'0';c = read();} while (c>' ');if(neg)return -ret;return ret;}
    private void fillBuffer(){try{bytesRead=din.read(buffer,bufferPointer=0,BUFFER_SIZE);}catch(Exception e) {}if(bytesRead==-1)buffer[0]=-1;}
    private byte read(){if(bufferPointer == bytesRead)fillBuffer();return buffer[bufferPointer++];}
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T00:02:32.067

您不必担心将所有节点添加到优先级队列中，即使它们具有无限键；它们最终会在伪代码的最后一行被 DECREASE_KEY 降低。无论如何你都需要这个操作，所以没有理由不简化你的生活并一次性插入它们。

我只看到您的伪代码存在一个问题，即它在断开连接的图形上会表现得很奇怪。

# java - Java 泛型主要是在集合元素上强制使用静态类型的一种方式吗？

> ID：766394
> 
> 赞同：5
> 
> 时间：2009-04-19T23:35:12.180
> 
> 标签：java, generics

```
private ArrayList<String> colors = new ArrayList<String>(); 
```

查看上面的示例，似乎泛型的主要目的是在集合上强制类型。因此，我没有将“对象”数组（需要由程序员自行决定转换为字符串），而是在 ArrayList 中的集合上强制使用“字符串”类型。这对我来说是新的，但我只想检查我是否正确理解它。这种解释正确吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-20T06:52:03.813

到目前为止，这不是泛型的**唯一**用途，但它绝对是最明显的一种。

泛型可以（并且正在）在许多不同的地方使用，以确保静态类型安全，而不仅仅是集合。

我只想提一下，因为您会遇到泛型可能有用的地方，但是如果您坚持使用泛型/集合关联，那么您可能会忽略这一事实。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T23:38:09.083

是的，你的理解是正确的。该集合被指定为任何类型的强类型，这具有各种优点 - 包括不再进行运行时强制转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T23:38:23.840

是的。保持类型安全并删除运行时强制转换是正确的答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-19T23:40:06.800

是的，基本上就是这样。在泛型之前，必须创建一个对象的 ArrayList。这意味着可以将*任何*类型的对象添加到列表中——即使您只想让 ArrayList 包含字符串。

所有泛型所做的就是添加类型安全。也就是说，现在 JVM 将确保列表中的任何对象都是字符串，并阻止您将非字符串对象添加到列表中。更好的是：这个检查是在编译时完成的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-19T23:52:33.340

您可能想查看[Java 站点](http://java.sun.com/docs/books/tutorial/extra/generics/index.html)中的教程。它在介绍中给出了很好的解释。

**没有泛型：**

```
List myIntList = new LinkedList(); // 1
myIntList.add(new Integer(0)); // 2
Integer x = (Integer) myIntList.iterator().next();  // 3 
```

**使用泛型**

```
List<Integer> myIntList = new LinkedList<Integer>(); // 1'
myIntList.add(new Integer(0)); // 2'
Integer x = myIntList.iterator().next(); // 3' 
```

我认为这是类型安全，也可以节省铸件。阅读有关[自动装箱](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)的更多信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T06:48:17.630

您可以使用 Collections 实用程序类添加运行时检查。

[http://java.sun.com/javase/6/docs/api/java/util/Collections.html#checkedCollection(java.util.Collection,%20java.lang.Class)](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#checkedCollection(java.util.Collection,%20java.lang.Class))

另见checkedSet、checkedList、checkedSortedSet、checkedMap、checkedSortedMap

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T08:18:22.407

是的，你是对的。泛型为您的程序添加了编译时类型安全性，这意味着编译器可以检测您是否将错误类型的对象放入您的`ArrayList`.

我想指出的一件事是，尽管它删除了可见的运行时转换并使源代码变得杂乱无章，但 JVM 仍然在后台进行转换。

泛型在 Java 中实现的方式只是隐藏了转换并且仍然产生非泛型字节码。`ArrayList<String>`静止是`ArrayList`字节码中的对象。这样做的好处是它使字节码与早期版本兼容。不好的是，这错过了一个巨大的优化机会。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T11:06:07.027

您可以在需要*类型参数*的任何地方使用泛型，即在某些代码中应该相同的类型，但或多或​​少未指定。

例如，我的一个玩具项目是用 Java 以通用方式编写计算机代数算法。这对数学算法很有趣，但也对 Java 泛型进行压力测试。

在这个项目中，我有各种用于代数结构的接口，例如环和域及其各自的元素，以及具体的类，例如整数或环上的多项式，其中环是类型参数。它有效，但在某些地方变得有些乏味。到目前为止的记录是一个变量前面的类型，该变量跨越了两行 80 个字符的完整行，用于测试多项式的不可约性的算法。罪魁祸首是你不能给一个复杂的类型起自己的名字。

# c - sched_setaffinity() 是如何工作的？

> ID：766395
> 
> 赞同：12
> 
> 时间：2009-04-19T23:35:44.550
> 
> 标签：c, linux, kernel, multicore, system-calls

我试图了解 linux 系统调用 sched_setaffinity() 的工作原理。[这是我的问题here](https://stackoverflow.com/questions/663958/how-to-control-which-core-a-process-runs-on)的后续内容。

我有[这个指南](http://www.ibm.com/developerworks/linux/library/l-affinity.html)，它解释了如何使用系统调用并且有一个非常简洁（工作！）的例子。

所以我下载了 Linux 2.6.27.19[内核源代码](ftp://ftp.kernel.org/pub/linux/kernel/v2.6/)。

我对包含该系统调用的行进行了“grep”，得到了 91 个结果。没有希望。

最终，我试图了解内核如何*为特定内核*（或处理器）设置指令指针。

我熟悉单核单线程程序的工作原理。有人可能会发出“jmp foo”指令，这基本上将 IP 设置为“foo”标签的内存地址。但是当一个有多个内核时，必须说“在内存地址 foo 处获取下一条指令，并将指令指针设置为*2 号内核*开始执行”。

在汇编代码中，我们在哪里指定执行该操作的内核？

回到内核代码：这里重要的是什么？文件 'kernel/sched.c' 有一个名为 sched_setaffinity() 的函数，但返回类型“long” - 这与它的[手册页](http://linux.die.net/man/2/sched_setaffinity)不一致。那么这里重要的是什么？这些模块中的哪些显示了发出的汇编指令？什么模块正在读取“task_struct”，查看“cpus_allowed”成员，然后将其转换为指令？（我还翻阅了 glibc 源代码——但我认为它只是调用内核代码来完成这项任务。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-20T00:22:51.393

`sched_setaffinity()`只需告诉调度程序允许在哪些 CPU 上运行进程/线程，然后调用重新调度。

调度程序实际上在每个 CPU 上运行，因此它有机会决定接下来在该特定 CPU 上执行什么任务。

如果您对如何在其他 CPU 上实际调用某些代码感兴趣，我建议您查看`smp_call_function_single()`. 如果我们想在另一个 CPU 上调用某些东西，它会调用`generic_exec_single()`. [后者只是简单地将函数添加到目标 CPU 的调用队列，并通过一些IPI](http://en.wikipedia.org/wiki/Interprocessor_Interrupt)内容强制重新调度（如果队列为空）。

底线是：该`_jmp_`指令没有实际的 SMP 变体。相反，在其他 CPU 上运行的代码会相互协作以完成任务。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T00:40:15.907

我认为您不理解的是内核正在*所有*CPU 内核上运行。在每次定时器中断（每秒约 1000 次）时，调度程序在每个 CPU 上运行并选择要运行的进程。没有一个 CPU 会以某种方式告诉其他 CPU 开始运行一个进程。`sched_setaffinity()`只需在进程上设置标志即可工作。调度程序读取这些标志，如果设置为不运行，则不会在其 CPU 上运行该进程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T00:29:16.123

> 在汇编代码中，我们在哪里指定执行该操作的内核？

这里不涉及组装。每个任务（线程）一次被分配给一个 CPU（或您的术语中的核心）。要停止在给定 CPU 上运行并在另一个 CPU 上恢复，任务必须“[迁移](http://lxr.linux.no/linux+v2.6.27.19/kernel/sched.c#L2828)”（也是[this](http://lxr.linux.no/linux+v2.6.27.19/kernel/sched.c#L5934)）。当任务从一个 CPU 迁移到另一个 CPU 时，调度程序会在 允许的 CPU 中[选择](http://lxr.linux.no/linux+v2.6.27.19/kernel/sched.c#L2088)更空闲的 CPU `sched_setaffinity()`。

没有发布任何神奇的组装指令。内核对硬件有一个更底层的视图，每个 CPU 都是一个单独的对象，与用户空间进程的外观非常不同（在用户空间，CPU 几乎是不可见的）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-12-03T15:24:26.060

看看这个：[B 操作系统编程指南](http://developer.intel.com/design/pentium/datashts/24201606.pdf)

# java - 如何轻松编辑 JTextPane 中选定文本的样式？

> ID：766396
> 
> 赞同：6
> 
> 时间：2009-04-19T23:35:50.180
> 
> 标签：java, swing, jtextpane

如何轻松编辑 JTextPane 中选定文本的样式？这方面的资源似乎不多。即使你能指导我找到一个很好的资源，我也会非常感激。

另外，如何获取所选文本的当前样式？我试过`styledDoc.getLogicalStyle(textPane.getSelectionStart());`了，但似乎没有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T01:01:54.407

这是插入格式化的“Hello World！”的代码片段。a 中的字符串`JEditorPane`：

```
Document doc = yourEditorPane.getDocument();

StyleContext sc = new StyleContext();
Style style = sc.addStyle("yourStyle", null);

Font font = new Font("Arial", Font.BOLD, 18);

StyleConstants.setForeground(style, Color.RED);
StyleConstants.setFontFamily(style, font.getFamily());
StyleConstants.setBold(style, true);

doc.insertString(doc.getLength(), "Hello World!", style); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T01:00:28.293

看看这个 pastebin 中的以下代码：

[http://pbin.oogly.co.uk/listings/viewlistingdetail/d6fe483a52c52aa951ca15762ed3d3](http://pbin.oogly.co.uk/listings/viewlistingdetail/d6fe483a52c52aa951ca15762ed3d3)

该示例来自此处：

[http://www.java2s.com/Code/Java/Swing-JFC/JTextPaneStylesExample3.htm](http://www.java2s.com/Code/Java/Swing-JFC/JTextPaneStylesExample3.htm)

看起来您可以在动作侦听器中使用以下内容更改样式：

```
final Style boldStyle = sc.addStyle("MainStyle", defaultStyle);
StyleConstants.setBold(boldStyle, true);   

doc.setCharacterAttributes(0, 10, boldStyle, true); 
```

它将给定偏移量和长度之间的文本样式设置为特定样式。

有关更多详细信息，请参阅完整的 pastebin。不过，这应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T12:41:51.660

操作文本面板的最简单方法是使用[编辑器工具包](http://java.sun.com/javase/6/docs/api/javax/swing/text/EditorKit.html)及其相关[操作](http://java.sun.com/javase/6/docs/api/javax/swing/text/DefaultEditorKit.CutAction.html)。您可以在[JDK](http://java.sun.com/javase/downloads/index.jsp)示例（在*jdk\demo\jfc\Stylepad*下）中找到它的演示。

安装[StyledEditorKit](http://java.sun.com/javase/6/docs/api/javax/swing/text/StyledEditorKit.html)并使用[FontSizeAction](http://java.sun.com/javase/6/docs/api/javax/swing/text/StyledEditorKit.FontSizeAction.html)操作文本的示例代码：

```
 public static void main(String[] args) {
    // create a rich text pane
    JTextPane textPane = new JTextPane();
    JScrollPane scrollPane = new JScrollPane(textPane,
        JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED,
        JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
    // install the editor kit
    StyledEditorKit editorKit = new StyledEditorKit();
    textPane.setEditorKit(editorKit);
    // build the menu
    JMenu fontMenu = new JMenu("Font Size");
    for (int i = 48; i >= 8; i -= 10) {
      JMenuItem menuItem = new JMenuItem("" + i);
      // add an action
      menuItem
          .addActionListener(new StyledEditorKit.FontSizeAction(
              "myaction-" + i, i));
      fontMenu.add(menuItem);
    }
    JMenuBar menuBar = new JMenuBar();
    menuBar.add(fontMenu);
    // show in a frame
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(600, 400);
    frame.setJMenuBar(menuBar);
    frame.setContentPane(scrollPane);
    frame.setVisible(true);
  } 
```

*（提示：如果您想使用[FontFamilyAction](http://java.sun.com/javase/6/docs/api/javax/swing/text/StyledEditorKit.FontFamilyAction.html)，请查看[GraphicsEnvironment.getAvailableFontFamilyNames()](http://java.sun.com/javase/6/docs/api/java/awt/GraphicsEnvironment.html#getAvailableFontFamilyNames())和[逻辑字体系列名称](http://java.sun.com/javase/6/docs/api/java/awt/Font.html)。）*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T00:48:02.927

我建议看一下 Sun 的关于编辑器窗格的[Java 教程。](http://java.sun.com/docs/books/tutorial/uiswing/components/editorpane.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T04:52:54.323

好的，哇。难以回答的问题。所以我还没有找到一种方法来获得给定角色的风格。但是，您可以获取给定字符的 MutableAttributeSet，然后测试样式是否在该属性集中。

```
 Style s; //your style
   Element run = styledDocument.getCharacterElement( 
       textPane.getSelectionStart() );
   MutableAttributeSet curAttr =
       ( MutableAttributeSet )run.getAttributes();
   boolean containsIt = curAttr.containsAttributes( s ); 
```

获取一系列字符的样式的一个问题是，可能有多个样式应用于该范围（例如：您可以选择一些为粗体而一些不是粗体的文本）。

要更新所选文本，您可以：

```
 Style s; //your style
  JTextPane textPane; //your textpane
  textPane.setCharacterAttributes( s, false ); 
```

哦，似乎函数 getLogicalStyle 不起作用，因为它返回包含 p 的段落的默认样式（或者可能只是样式），而不是 p 处字符的样式。

# linux - 如何在 linux 中将 Perl 脚本作为系统守护进程运行？

> ID：766397
> 
> 赞同：59
> 
> 时间：2009-04-19T23:35:59.400
> 
> 标签：linux, perl, startup, daemon, shutdown

什么是让 Perl 脚本在 linux 中作为守护进程运行的简单方法？

目前，这是在 CentOS 上。我希望它随系统启动并随系统关闭，所以一些`/etc/rc.d/init.d`集成也很好，但我总是可以在`/etc/rc.d/rc.local`.

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-04-19T23:41:55.080

最简单的方法是使用[Proc::Daemon](http://search.cpan.org/dist/Proc-Daemon/lib/Proc/Daemon.pod)。

```
#!/usr/bin/perl

use strict;
use warnings;
use Proc::Daemon;

Proc::Daemon::Init;

my $continue = 1;
$SIG{TERM} = sub { $continue = 0 };

while ($continue) {
     #do stuff
} 
```

或者，您可以执行 Proc::Daemon 所做的所有事情：

1.  fork 一个子进程并退出父进程。
2.  成为会话负责人（将程序与控制终端分离）。
3.  fork 另一个子进程并退出第一个子进程。这防止了获取控制终端的可能性。
4.  将当前工作目录更改为`"/"`.
5.  清除文件创建掩码。
6.  关闭所有打开的文件描述符。

与运行级别系统集成很容易。`XXXXXXXXXXXX`在. _ `YYYYYYYYYYYYYYYYYYY`_ `/path/to`_ `/etc/init.d`由于您使用的是 CentOS，一旦您将脚本放入 中`/etc/init.d`，您就可以使用 chkconfig 在各种运行级别中将其关闭或打开。

```
#!/bin/bash
#
# XXXXXXXXXXXX This starts and stops XXXXXXXXXXXX
#
# chkconfig: 2345 12 88
# description: XXXXXXXXXXXX is YYYYYYYYYYYYYYYYYYY
# processname: XXXXXXXXXXXX
# pidfile: /var/run/XXXXXXXXXXXX.pid
### BEGIN INIT INFO
# Provides: $XXXXXXXXXXXX
### END INIT INFO

# Source function library.
. /etc/init.d/functions

binary="/path/to/XXXXXXXXXXXX"

[ -x $binary ] || exit 0

RETVAL=0

start() {
    echo -n "Starting XXXXXXXXXXXX: "
    daemon $binary
    RETVAL=$?
    PID=$!
    echo
    [ $RETVAL -eq 0 ] && touch /var/lock/subsys/XXXXXXXXXXXX

    echo $PID > /var/run/XXXXXXXXXXXX.pid
}

stop() {
    echo -n "Shutting down XXXXXXXXXXXX: "
    killproc XXXXXXXXXXXX
    RETVAL=$?
    echo
    if [ $RETVAL -eq 0 ]; then
        rm -f /var/lock/subsys/XXXXXXXXXXXX
        rm -f /var/run/XXXXXXXXXXXX.pid
    fi
}

restart() {
    echo -n "Restarting XXXXXXXXXXXX: "
    stop
    sleep 2
    start
}

case "$1" in
    start)
        start
    ;;
    stop)
        stop
    ;;
    status)
        status XXXXXXXXXXXX
    ;;
    restart)
        restart
    ;;
    *)
        echo "Usage: $0 {start|stop|status|restart}"
    ;;
esac

exit 0 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-04-20T14:15:36.353

如果您没有Chas 建议的[Proc::Daemon 。](http://search.cpan.org/dist/Proc-Daemon/Daemon.pm "进程::守护进程")欧文斯，这是你手工操作的方法：

```
sub daemonize {
   use POSIX;
   POSIX::setsid or die "setsid: $!";
   my $pid = fork() // die $!; #//
   exit(0) if $pid;

   chdir "/";
   umask 0;
   for (0 .. (POSIX::sysconf (&POSIX::_SC_OPEN_MAX) || 1024))
      { POSIX::close $_ }
   open (STDIN, "</dev/null");
   open (STDOUT, ">/dev/null");
   open (STDERR, ">&STDOUT");
 } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-20T00:31:43.010

我认为最简单的方法是使用[daemon](http://libslack.org/daemon/)。它允许您将任何进程作为守护进程运行。这意味着，例如，如果您决定改用 python，则不必担心库。要使用它，只需使用：

```
daemon myscript args 
```

这应该在大多数发行版上都可用，但默认情况下可能不会安装。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-08T11:23:47.867

我使用主管来运行 perl 脚本。

作为系统管理员，我喜欢尽量减少服务器之间的变化和变化，并喜欢坚持核心服务或最低限度。

Supervisor 已安装并可用于在同一机器上运行的 python-flask 应用程序。所以，我只是为我想作为服务运行的 perl 脚本添加了一个 conf 文件。现在，我可以做到

```
supervisorctl start/stop/restart my_perl_script_supervisor_service_name 
```

# domain-driven-design - DDD：在一个实体上组织 100 个属性

> ID：766400
> 
> 赞同：3
> 
> 时间：2009-04-19T23:37:24.123
> 
> 标签：domain-driven-design

您将如何组织一个拥有 100 多个属性的实体？甚至可以说 100 多个属性，以及一些值对象（因为一些属性有 2 或 3 个自己的属性）。但关键是，如何处理大量属性。

我正在使用 DDD 从头开始​​重新创建我们的模型，当前的问题是如何组织一个被分解为许多子集的主要实体。目前它被编写为具有大约十几个属性子集。比如 CarInfo() 有 50+ 个属性，CarRankings() 有 80+ 个属性，CarStats()，CarColor() 等等。

将其视为存储在单个实体根上的海量数据。

为了对大量属性进行分组的简单目的而提供服务是否合适？就像 CarInfoService 一样，它会返回一个 Car() 对象，以及一个大型集合或排序。

另一个想法是查看数据的显示方式。没有一种视图可以显示所有这些数据。相反，他们是根据他们的主观问题来分裂的。像 CarInfo 显示有关汽车的所有信息。另一个是显示汽车所有统计数据的 CarStats。所以从这个意义上说，应用层可以构建 UI 所需的底层细节。但是，我仍然需要一种将其存储在域中的方法。

我打算在上面放一些 xml 属性包并在当天打电话。哈哈

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-26T02:55:28.950

这是一个棘手的问题。你有一个有很多分支的聚合根。但听起来好像您的用户只在特定时间使用特定集合。你可以试着修剪一下树。

例如，在您的汽车示例中，如果您的用户正在比较不同汽车的排名，您可以将其视为自己的模块或子系统。如果具体任务是找出哪些排名比其他排名更好，则无需加载与每个排名相关的详细汽车数据。

请记住，即使数据可能存储在数据库中的父子层次结构中，但这并不一定意味着您的域将以相同的方式构造。

通过查看用户将对您的数据执行的任务或功能，您可能会发现有助于将庞大的聚合分解为更易于管理的块的概念。

如果您确实需要组装完整的根及其所有分支，我认为您肯定需要某种服务来将所有内容组合在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T10:44:39.497

我认为您应该考虑将这样的实体拆分为通过[共享标识符相关的不同](http://epic.tesio.it/doc/manual/shared_identifiers.html)[有界上下文](http://en.wikipedia.org/wiki/Domain-driven_design#Bounded_context)。因此，您将在不同的 BC 中拥有不同的 s（因此也有不同的命名空间），并且每个 s 将仅处理与该特定方面相关的信息。`Car`

这样，如果有更深入的了解，您可能只需要重构一个 BC 而不会影响其他的。

# c# - 通过 HTTP 上传文件并在 C# 中读取结果

> ID：766417
> 
> 赞同：0
> 
> 时间：2009-04-19T23:44:20.847
> 
> 标签：c#, http, upload, response

这个问题的标题应该是不言自明的，但基本上我有这个代码（工作）

```
 progfrm = new progressform();
        System.Net.WebClient ahwebclient = new System.Net.WebClient();
        progfrm.Show();
        ahwebclient.UploadProgressChanged += new System.Net.UploadProgressChangedEventHandler(ahwebclient_UploadProgressChanged);
        ahwebclient.UploadFileCompleted += new System.Net.UploadFileCompletedEventHandler(ahwebclient_UploadFileCompleted);
        ahwebclient.UploadFileAsync(new Uri("http://upload.anyhub.net/bin/demovu_upload.php"), "C:/install.exe");
        while (ahwebclient.IsBusy)
        {
            Application.DoEvents();
        } 
```

一旦完成，我将如何阅读此请求的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T23:49:56.153

您可以从 UploadFileCompletedEventArgs ( [http://msdn.microsoft.com/en-us/library/system.net.uploadfilecompletedeventargs_members(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.net.uploadfilecompletedeventargs_members(VS.80).aspx) ) 的 Result 属性中获得它。您已经有一个 UploadFileCompletedEventHandler，因此您只需要修改实现该委托的方法，

# javascript - 在 Firefox 扩展中包含图像

> ID：766420
> 
> 赞同：1
> 
> 时间：2009-04-19T23:47:16.800
> 
> 标签：javascript, html, css, firefox

我想在我正在开发的 Firefox 扩展中使用图像。有人可以告诉我如何包含图像。我使用了以下，但它没有工作。

```
 var divTag = content.document.createElement("img");                 
    divTag.id = "div1";
    divTag.src="chrome://ff_extension/content/image1.gif";
    divTag.setAttribute("align","center");
    divTag.style.margin = "0px auto";
    divTag.style.position="fixed";
    divTag.style.bottom="0px";
    divTag.style.height="22px";
        divTag.style.width="100%";
            content.document.getElementsByTagName('body')[0].appendChild(divTag); 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T03:24:08.603

你不能只使用相对路径吗？

```
divTag.src="image1.gif"; 
```

我刚刚查看了一些已安装的插件，它们使用与您使用的相同的**chrome://**语法。

*   您是否仔细检查了文件路径？
*   您确定可以嵌入 GIF 吗？如果你不能，那将是荒谬的，但值得仔细检查。我看到的都是png。

# asp.net - 处理程序尚未确定错误

> ID：766430
> 
> 赞同：1
> 
> 时间：2009-04-19T23:51:08.523
> 
> 标签：asp.net, iis, iis-7

我对部署网站一无所知，所以我可能犯了一些愚蠢的错误。

无论如何，我打开了 IIS 7 管理器，创建了新的虚拟目录（通过 Add Application ）并将其指向 Visual Studio 保存我的 Web 项目的物理目录。但是当我尝试请求一个 .aspx 页面时，浏览器报告了以下错误（我不会发布整个错误，只发布有趣的部分）：

> 处理程序：尚未确定
> 配置错误：由于权限不足，无法读取配置文件
> 登录用户：尚未确定

A) 为什么处理程序尚未确定？据我所知，IIS7 确实注册了 Asp.Net 处理程序？！

B) 为什么 IIS 没有足够的权限？这是否意味着我应该给 IIS 更高的权限？还是 Asp.Net 运行时权限不足？

C）错误是否也可能是由于它可能期望用户对自己进行身份验证？我假设这是由于尚未确定*登录用户？*

D）最后，任何想法如何使它工作？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-09T01:22:49.127

> 错误代码：0x8007000d

我开始使用权限和所有关于访问 web.config 或 applicationhost.config 的问题，无论如何这些并没有改变错误。

当我在玩我的 web.config 时，我从我的配置文件中删除了重写标签并改变了错误。然后我安装了“Web 平台安装程序”并为 IIS 安装了 url 重写模块，并使用了一些配置，现在我的网站正在运行。花了大约一天的时间才发现这个问题，希望对某人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-07T01:33:18.247

您的 IIS 应用程序池的身份是否有足够的权限来访问托管您的站点的文件夹？

# multiple-inheritance - 多重继承的优缺点是什么？

> ID：766441
> 
> 赞同：3
> 
> 时间：2009-04-19T23:55:04.067
> 
> 标签：multiple-inheritance

多重继承的优缺点是什么？

**为什么**我们在 C# 中没有多重继承？

**更新** 好的，因此目前避免了因为冲突解决正在调用哪个父方法等问题。当然这是程序员要解决的问题。或者，这可以像 SQL 一样解决，其中存在冲突需要更多信息，即 ID 可能需要变为 Sales.ID 才能解决查询中的冲突。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T00:03:51.860

这是关于多重继承陷阱的一个很好的讨论：

[为什么我应该避免 C++ 中的多重继承？](https://stackoverflow.com/questions/406081/why-should-i-avoid-multiple-inheritance-in-c)

以下是 C# 团队关于为什么他们决定不允许多重继承的讨论：

*   [http://blogs.msdn.com/csharpfaq/archive/2004/03/07/85562.aspx](http://blogs.msdn.com/csharpfaq/archive/2004/03/07/85562.aspx)
*   [http://dotnetjunkies.com/WebLog/unknownreference/archive/2003/09/04/1401.aspx](http://dotnetjunkies.com/WebLog/unknownreference/archive/2003/09/04/1401.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T00:20:29.933

我将根据我一直在[转换为 REALbasic](http://code.google.com/p/rbrw-core/)（它具有接口但只有单一继承）的 C++ 报告编写器提供一个专业人士。

多重继承使得从实现功能并具有记住状态的属性的小型 mixin 基类组合类变得更加容易。如果做得好，您可以大量重用小代码，而无需复制和粘贴类似的代码来实现接口。

幸运的是，REALbasic 具有*扩展*方法，类似于最近在 C# 3.0 中添加到 C#的*扩展方法。*这些有助于解决这个问题，特别是因为它们可以应用于数组。由于折叠了以前多重继承的类，我仍然得到了一些更深的类层次结构。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T00:29:27.557

It's just another tool in the toolbox. Sometimes, it is exactly the right tool. If it is, having to find a workaround because the language actually prohibits it is a pain and leads to good opportunities to screw it up.

Pros and cons can only be found for a concrete case. I guess that it's quite rare to actually fit a problem, but who are the language designers to decide how I am to tackle a specific problem?

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T00:10:08.837

主要缺点是如果两个类有一个同名的方法，新的子类不知道调用哪一个。

在 C# 中，您可以通过在子对象中包含每个父对象的实例来进行多重继承。

```
class MyClass
{
    private class1 : Class1;
    private class2: Class2;

    public MyClass
    {
        class1 = new Class1;
        class2 = new Class2;
    }
    // Then, expose whatever functionality you need to from there.
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T00:24:36.867

当您从某个东西继承时，您在以各种方式断言您的类属于该（基本）类型，除了您可能会稍微不同地实现某些东西或*向其添加*某些东西，实际上您的类*同时是*2 个东西是极其罕见的。通常它只是对 2 个或更多事物具有共同的行为，而更好的描述方式通常是让您的类实现多个接口。（或可能封装，取决于您的情况）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T00:27:12.243

这是那些帮助我不要拍自己的脚怪癖之一，就像在 Java 中一样。

尽管从多个来源扩展字段和方法是件好事（想象一个现代手机，它继承自 MP3 播放器、相机、卫星导航和简陋的老式手机），但仅靠编译器无法解决冲突。

# jakarta-ee - 多少个 EJB 太多了？

> ID：766446
> 
> 赞同：6
> 
> 时间：2009-04-19T23:58:48.957
> 
> 标签：jakarta-ee, glassfish, ejb

我目前正在开发一个基于 JavaEE 的大型软件。我们遵循 JavaEE 的一般准则，即每组相关的操作都应该进入它们自己的 EJB。我们目前有超过 275 个不同的 EJB 类（无状态会话 bean）。这个数字很可能会增长到至少两倍。

我想知道 EJB 容器是否设计为容纳这么多不同类型的 EJB。我很想知道我们是否会因为拥有太多这样的类而导致一些糟糕的性能损失，以及一些应用程序服务器级别的调整是否可以帮助缓解这些假设性问题。

我们在 sun 的 Java 6 上使用带有 JavaEE 5 的 Glassfish v2，因此非常感谢有关此特定平台的建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T02:33:28.053

EJB 应该是细粒度的，因此如果您在设计中保持一致，那么您所做的事情就没有问题。

EJB 只是类，所以除了一般负载之外没有什么可担心的，这与您部署的 EJB 的数量正交。

如果您担心性能，请输入一些监控或其他性能指标，并在添加新功能时查看情况如何。

归根结底，你宁愿维护更少的类和很多方法，还是维护很多类和更少的方法？我知道我会选哪一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T02:38:16.810

*（有没有办法我可以说“任何”而不会被否决？）*

严肃地说，尽可能多地使用。我的经验法则是（对于一般的 EJB 和类），如果你不能用大约三个词的类名来完全描述事物的作用，那么你就做得太多了。

就性能而言，我怀疑如果系统开始遭受“太多 EJB”的困扰，那么您在某个地方就会遇到更大的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T02:42:23.783

EJB 是组件而不是类，您应该在这个术语中考虑它们并适当地表达您的系统设计。

组件的粒度显然取决于域。

假设您正在使用 EJB 对（相当老式的）计算机进行建模。电阻器、晶体管、线圈等：这些都是 pojos。芯片和电路板是组件。组件是 EAR。

接口粒度应反映组件功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-11T14:47:43.840

EJB 不仅仅是普通的类实例。它需要在容器、实例池等方面进行额外维护。许多 EJB 需要服务器中的大量资源。

我不认为一个系统确实需要数百个 EJB。虽然我还参与了一个包含 90 个 EJB 的应用程序，但这是一场噩梦：< 没有可测试性，部署也是一项艰巨的任务。

# jquery - scrollTo 不滚动到正确的位置

> ID：766450
> 
> 赞同：1
> 
> 时间：2009-04-19T23:59:49.280
> 
> 标签：jquery, accordion, scrollto

我正在尝试将 jQuery.scrollTo 插件与手风琴一起使用（其中一个块在单击它和另一个合同后展开），但它不会滚动到正确的位置。

这是一个演示：[pelmeshkin.com/temp/scrolltoaccoridon](http://www.pelmeshkin.com/temp/scrolltoaccoridon/)

如您所见，第一次点击滚动正确，但每下一次点击都超出预期。

它似乎使用了目标的初始位置（在扩展/收缩之前的位置），这是有道理的，因为这两个事件是同时启动的，但即使我尝试暂停 scrollTo 并等到 slideUp/slideDown 过渡结束，它的行为仍然相同。:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T00:14:41.430

因为它是根据动画发生之前的位置来计算位置的。老实说，不知道你将如何处理这个问题，除非可能修补内部计算，这可能不是一件简单的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T22:35:50.927

好的，我自己解决了。我首先使用 offset() 找到页面加载上所有可点击元素的位置，将它们放入数组中，然后将它们作为像素值提供给 click 事件时的 scrollTo。

这样我们就可以在页面上为 scrollTo 提供精确的像素位置，而不是依靠它自己从元素 ID 计算它。这是它最终的样子：[pelmeshkin.com](http://www.pelmeshkin.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-29T16:03:57.183

老兄。 **NSFW**

在对 Effect.ScrollTo 进行了一些修改之后：

```
Effect.LazyScrollTo = function(element) { try {
  var options = arguments[1] || { };
  scrollOffsets = document.viewport.getScrollOffsets();
  elementOffsets = $(element).cumulativeOffset();

  if (options.offset) elementOffsets[1] += options.offset;

  return new Effect.Tween(null,
    scrollOffsets.top,
    elementOffsets[1],
    options,
    function(p){
      try {
        this.lazy_offset = this.lazy_offset || $(element).cumulativeOffset();
        scrollTo(scrollOffsets.left, (p.round() - (elementOffsets[1] - this.lazy_offset[1])));
      } catch(e) {
        alert(e);
      }
    }.bind(this)
  ); 
} catch(e) { alert(e); }} 
```

然后在别处...

```
new Effect.SlideDown('tab1-body', {queue: 'end'});
new Effect.LazyScrollTo('tab1-heading', {queue: 'end'}); 
```

新年快乐。

# django - Django / mod_wsgi / postgresql_psycopg2: can't connect authentication failed (但设置在django runserver或dbshel l下工作正常)

> ID：766464
> 
> 赞同：0
> 
> 时间：2009-04-20T00:04:38.193
> 
> 标签：django, postgresql, apache2, mod-wsgi

我正在从头开始设置的 Ubuntu 8.10 服务器上部署我的 django 站点。我对此完全陌生，所以可能有很多我错过的东西，但很高兴我找到了部署网站的方法。

我的最后一个障碍：

我在使用 postgresql 时遇到身份验证错误

```
[Sun Apr 19 18:44:05 2009] [error] [client 124.254.102.127] 
 mod_wsgi (pid=30304): Exception occurred processing WSGI script '/home/acacian/webapps/acacian/deploy/acacian.wsgi'.
 Traceback (most recent call last):
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/core/handlers/wsgi.py", line 241, in __call__
     response = self.get_response(request)
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/core/handlers/base.py", line 73, in get_response
     response = middleware_method(request)
   File "/home/acacian/webapps/pinax-env/src/django-openid/django_openid/consumer.py", line 383, in process_request
     if self.session_key in request.session:
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/contrib/sessions/backends/base.py", line 43, in __contains__
     return key in self._session
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/contrib/sessions/backends/base.py", line 172, in _get_session
     self._session_cache = self.load()
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/contrib/sessions/backends/db.py", line 16, in load
     expire_date__gt=datetime.datetime.now()
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/db/models/manager.py", line 120, in get
     return self.get_query_set().get(*args, **kwargs)
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/db/models/query.py", line 269, in get
     num = len(clone)
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/db/models/query.py", line 68, in __len__
     self._result_cache = list(self.iterator())
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/db/models/query.py", line 207, in iterator
     for row in self.query.results_iter():
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/db/models/sql/query.py", line 262, in results_iter
     for rows in self.execute_sql(MULTI):
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/db/models/sql/query.py", line 2288, in execute_sql
     cursor = self.connection.cursor()
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/db/backends/__init__.py", line 81, in cursor
     cursor = self._cursor()
   File "/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg/django/db/backends/postgresql_psycopg2/base.py", line 98, in _cursor
     self.connection = Database.connect(**conn_params)
 OperationalError: FATAL:  Ident authentication failed for user "acacian" 
```

笔记：

*   相同的设置在 runserver 和 dbshel​​l 下工作正常
*   mod_wsgi 一直在使用 sqlite3（我正在切换）

acacian.wsgi（有点乱）

```
# basic_project.wsgi is configured to live in projects/basic_project/deploy.

import os
import sys
import site

sys.stdout = sys.stderr

from os.path import abspath, dirname, join
from site import addsitedir

# the project path & pinax src paths
sys.path.insert(0, abspath(join(dirname(__file__), "../../")))
sys.path.insert(0, abspath(join(dirname(__file__), "../../pinax-env/src/pinax")))
sys.path.insert(0, abspath(join(dirname(__file__), "../../pinax-env/src")))

sys.path = ['/home/acacian/webapps/acacian/apps', '/home/acacian/webapps/pinax-env/src/pinax/pinax/apps', '/home/acacian/webapps/acacian', '/home/acacian/webapps/pinax-env/lib/python2.5/site-packages/setuptools-0.6c9-py2.5.egg', '/home/acacian/webapps/pinax-env/lib/python2.5/site-packages/pip-0.3.1-py2.5.egg', '/home/acacian/webapps/pinax-env/src/pinax', '/home/acacian/webapps/pinax-env/src/django-openid', '/home/acacian/webapps/pinax-env/src/atom-format', '/home/acacian/webapps/pinax-env/src/django-app-plugins', '/home/acacian/webapps/pinax-env/src/diff-match-patch', '/usr/lib/python2.5/site-packages/Django-1.0.2_final-py2.5.egg', '/usr/lib/python2.5/site-packages/pip-0.3.1-py2.5.egg', '/home/acacian/webapps/pinax-env/lib/python2.5', '/home/acacian/webapps/pinax-env/lib/python2.5/plat-linux2', '/home/acacian/webapps/pinax-env/lib/python2.5/lib-tk', '/home/acacian/webapps/pinax-env/lib/python2.5/lib-dynload', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/home/acacian/webapps/pinax-env/lib/python2.5/site-packages', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/PIL', '/var/lib/python-support/python2.5'] + sys.path

# A version of activate_this from the mod_wsgi documentation site.
ALLDIRS = ['/home/acacian/webapps/acacian/pinax-env/lib/python2.5/site-packages']

# Remember original sys.path.
prev_sys_path = list(sys.path) 

# Add each new site-packages directory.
for directory in ALLDIRS:
    site.addsitedir(directory)

# Reorder sys.path so new directories at the front.
new_sys_path = [] 
for item in list(sys.path): 
    if item not in prev_sys_path: 
        new_sys_path.append(item) 
        sys.path.remove(item) 
sys.path[:0] = new_sys_path

#print sys.path

from django.conf import settings
os.environ["DJANGO_SETTINGS_MODULE"] = "acacian.settings"

sys.path.insert(0, join(settings.PINAX_ROOT, "apps"))
sys.path.insert(0, join(settings.PROJECT_ROOT, "apps"))

from django.core.handlers.wsgi import WSGIHandler
application = WSGIHandler() 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T03:55:58.497

错误：

```
Ident authentication failed for user "acacian" 
```

就是这个意思。

当您使用 runserver 或 dbshel​​l 时，Django 进程以您的用户 ID 作为进程所有者运行。

当您在 mod_wsgi 下运行 Django 时，在守护程序模式下，它以`WSGIDaemonProcess`指令中指定的用户身份运行。如果您在嵌入式（非守护程序）模式下运行 mod_wsgi，则用户 ID 将匹配 Apache 进程`User`指令。

因此，您需要做的是将您的用户`acacian`作为用户添加到 postgresql `createuser`，就像您使用自己的用户名一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-06T01:11:43.770

这可能是您的 postgres 连接设置。我认为 postgres 默认使用 unix 用户 ID 进行身份验证，但在这种情况下，您可能希望使用标准的用户名/密码身份验证（因为这是您硬编码到 django 设置中的内容）。所以你可以试试：

```
sudo vi /etc/postgresql/8.4/main/pg_hba.conf 
```

（或emacs或nano等）。然后更改以下行：

```
local   all         all                               ident 
```

到：

```
local   all         all                               password 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T04:45:01.467

您可能会发现这篇博文很有帮助[http://www.depesz.com/index.php/2007/10/04/ident/](http://www.depesz.com/index.php/2007/10/04/ident/) - 它试图解释“身份验证失败”错误、它的来源以及你能做些什么它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T03:52:29.987

我的猜测是您的问题出在数据库连接设置（settings.py）中。我假设您已经创建了数据库和同步数据库等？

这篇文章非常适合在 Ubuntu 8.10 上设置 Django/Postgres/etc（我已经按照它设置了几个虚拟机）： http: [//lethain.com/entry/2009/feb/13/the-django-和-ubuntu-intrepid-almanac/](http://lethain.com/entry/2009/feb/13/the-django-and-ubuntu-intrepid-almanac/)

# java - 自动装箱：所以我可以写：Integer i = 0; 而不是：整数 i = new Integer(0);

> ID：766468
> 
> 赞同：13
> 
> 时间：2009-04-20T00:16:02.317
> 
> 标签：java, autoboxing

自动装箱似乎归结为我可以写的事实：

```
Integer i = 0; 
```

代替：

```
Integer i = new Integer(0); 
```

因此，编译器可以自动将原语转换为对象。

是这个主意吗？为什么这很重要？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-20T00:20:23.337

你有点过于简化了。

**使用集合时，自动装箱也会发挥作用。正如 sun 的 java 文档中所解释的：**

> 集合只能保存对象引用，因此您必须将原始值装箱到适当的包装类中。**...**当您从集合中取出对象时，您将获得放入的 Integer；如果需要 int，则必须使用 intValue 方法对 Integer 进行拆箱。所有这些装箱和拆箱都是一种痛苦，并且会使您的代码混乱。自动装箱和拆箱功能使过程自动化，消除了痛苦和混乱。
> 
> 那么什么时候应该使用自动装箱和拆箱呢？仅当引用类型和原语之间存在“阻抗不匹配”时才使用它们，例如，当您必须将数值放入集合中时。对于科学计算或其他对性能敏感的数字代码，不适合使用自动装箱和拆箱。Integer 不能替代 int；自动装箱和拆箱模糊了原始类型和引用类型之间的区别，但它们并没有消除它。

[自动装箱的伟大概述](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-20T06:51:42.130

顺便提一句

```
Integer i = 0; 
```

相当于

```
Integer i = Integer.valueOf(0); 
```

区别在于 valueOf() 不会为 -128 和 127 之间的值创建新对象（显然，如果 Java 6u14，这将是可调的）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-20T10:53:21.707

它的存在是为了让您可以编写类似的代码

```
List<Integer> is = new ArrayList<Integer>();
is.add(1); // auto-boxing
is.add(2);
is.add(3);

int sum = 0;
for (int i : is)  // auto-unboxing
{
    sum += i;
} 
```

对于单个整数，您应该默认使用 int 类型，而不是 Integer。整数主要用于集合。

请注意，Long 与 Integer 的值不同（使用 equals()），但 long 等于 int（使用 ==）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-20T00:24:22.000

就是这个想法，是的。不过，将 Integer 分配给 int 会更方便。

有人可能会争辩说，自动装箱解决的是症状而不是原因。混淆的真正根源在于 Java 的类型系统是不一致的：对原语和对象引用的需求是人为的和笨拙的。自动装箱在一定程度上缓解了这一点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-20T00:22:11.070

戴上我愤世嫉俗的帽子：弥补原始 Java（我指的是 Oak）规范的限制。不只是第一次。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T00:19:03.137

使代码更易读、更整洁。特别是如果您正在执行操作（因为 Java 没有运算符重载）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-20T00:24:49.940

根据我在阅读 Joshua Bloch 的 Effective Java 时的记忆，您应该考虑原语而不是盒装对应物。不考虑副作用的自动装箱可能会产生问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-20T00:29:30.740

添加到 Lim 的评论中，原语存储在堆栈中，而原语包装器作为对象存储在堆中......因此有一些微妙的含义。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-20T00:39:52.867

主要优点是可读性，基本上是语法糖。Java 已经非常冗长，Sun 正在尝试各种方法来缩短语法。

# ruby - 在 Mac OS X 上设置 RDoc Ruby Gem 默认

> ID：766469
> 
> 赞同：2
> 
> 时间：2009-04-20T00:16:21.240
> 
> 标签：ruby, macos, rubygems, rdoc

我最近通过 Ruby gems 安装了 RDoc 版本（2.4.3）来替换 Mac OS X（版本 1.0.1）附带的版本。不幸的是，当我在命令行中调用 run "rdoc" 时，我仍然只能使用 RDoc 1.0.1。rdoc -v 返回：

```
RDoc V1.0.1 - 20041108 
```

我尝试修改 $PATH 变量以将第一个条目指向 RDoc 2.4.3 文件夹，但没有运气。我在网上也找不到任何关于这个的东西，所以我想我会在这里问。

干杯!

更新：

运行“ `gem list -d --version 1.0.1 rdoc`”返回：

```
*** LOCAL GEMS ***

rdoc (2.4.3)
    Authors: Eric Hodel, Dave Thomas, Phil Hagelberg, Tony Strauss
    Rubyforge: http://rubyforge.org/projects/rdoc
    Homepage: http://rdoc.rubyforge.org
    Installed at: /usr/local/lib/ruby/gems/1.8

    RDoc is an application that produces documentation for one or more
    Ruby source files 
```

因此，肯定是 Mac OSX 版本的 RDoc 干扰了 Gems 版本。

更新 2：

我发现，使用：

```
`bash --debugger rdoc` 
```

旧版本的 RDoc 在 /opt/local/bin 中。我删除它并将我的 gems 目录添加到我的 $PATH

```
`export PATH=/usr/local/lib/ruby/gems/1.8/gems/` 
```

我现在有了最新 RDoc 的新工作副本！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T02:36:50.900

这个问题告诉您，您的两个版本安装在不同的 gem 存储库中。

尝试这个：

```
gem list -d --version 1.0.1 rdoc
gem list -d --version 2.4.3 rdoc 
```

这将为您提供有关 gem 安装位置的详细信息。如果可以，请卸载旧版本。

```
gem uninstall --install-dir /old/gem/repository --version 1.0.1 rdoc 
```

如果您将新版本安装在非标准位置，则可能需要将该存储库的 bin 目录添加到您的路径，并将该目录添加到您的`GEM_PATH`环境变量中。所以在你的`.login`或`.bash_profile`其他的：

```
PATH = $PATH:/new/gem/repository/bin
export PATH

GEM_PATH = $GEM_PATH:/new/gem/repository
export GEM_PATH 
```

您也可以`GEM_PATH`在`~/.gemrc`文件中进行设置，但这并不总是由命令行工具读取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-16T22:14:31.543

我在运行 Instant-Rails 的 Windows 上遇到了类似的问题。最后，我只是重命名了我的`ruby/lib/ruby/1.8/rdoc`目录，`rdoc.bak`从那时起，我的 rake 任务使用新的 gem rdoc 正确运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-21T03:20:30.680

只是一个想法……在 Linux 中，我们通常会创建一个链接（即 /opt/local/bin/rdoc），该链接指向现有路径中缺少的二进制文件。在你的情况下，我们会做这样的事情： ln -s /opt/local/bin/rdoc /usr/local/lib/ruby/gems/1.8/gems/rdoc

这样，$PATH 变量就不会那么杂乱，而且您可以更好地控制正在使用的二进制文件。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-24T08:49:41.713

使用 RVM（Ruby 版本管理器）为我开箱即用

# regex - Perl 当前（5.8 和 5.10）是否对将使用的顺序交替做出任何承诺？

> ID：766474
> 
> 赞同：2
> 
> 时间：2009-04-20T00:18:16.633
> 
> 标签：regex, perl

考虑到 Perl 5.8 或 5.10 之类的替代方案，`/(foo|foobar|foobaz)/`是否对将首先使用这三个中的哪一个做出任何承诺，如果它在文档中的哪个位置做出承诺？

请参阅相关问题[Perl 6 是否对将使用的顺序交替做出任何承诺？](https://stackoverflow.com/questions/766480)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T03:57:40.113

[http://perldoc.perl.org/perlre.html#Combining-RE-Pieces](http://perldoc.perl.org/perlre.html#Combining-RE-Pieces)：

> 如果我们将正则表达式 a|ab 与 "abc" 匹配，它会匹配子字符串 "a" 还是 "ab" ？描述实际匹配哪个子字符串的一种方法是回溯的概念（请参阅“回溯”）。然而，这个描述太低级了，让你从一个特定的实现角度来思考。
> 
> 另一种描述以“更好”/“更差”的概念开头
> 
> 同样，对于基本棋子，不存在这样的问题，因为在给定位置最多可以进行一次匹配。本节描述组合运算符的更好/更差的概念。在下面的描述中，S 和 T 是正则子表达式。
> 
> ...
> 
> *   S|T
> 
> 当 S 可以匹配时，它比只有 T 可以匹配时更好。

（在上下文中，仅当使用 S 的匹配在字符串中与使用 T 的匹配至少早于匹配时才有资格。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T00:28:04.580

[perldoc perlrequick](http://perldoc.perl.org/perlrequick.html)似乎有一个承诺：

> 为了匹配`dog` or `cat`，我们形成了正则表达式`dog|cat`。和以前一样，perl 将尝试在字符串中尽可能早的点匹配正则表达式。在每个字符位置，perl 将首先尝试匹配第一个替代项，`dog`. 如果`dog` 不匹配，perl 将尝试下一个替代方案，`cat`. 如果`cat` 两者都不匹配，则匹配失败并且 perl 移动到字符串中的下一个位置。

[perldoc perlretut](http://perldoc.perl.org/perlretut.html)似乎以更强大的方式做出了承诺（但有一个警告）：

```
"cats"          =~ /c|ca|cat|cats/; # matches "c"
"cats"          =~ /cats|cat|ca|c/; # matches "cats" 
```

> 在这里，所有备选方案都在第一个字符串位置匹配，所以第一个备选方案是匹配的。如果某些替代方案是其他替代方案的截断，则将最长的替代方案放在首位，以使它们有机会匹配。

```
"cab" =~ /a|b|c/ # matches "c"
                 # /a|b|c/ == /[abc]/ 
```

> 最后一个例子指出，字符类就像字符的交替。在给定的字符位置，允许正则表达式匹配成功的第一个替代方案将是匹配的那个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T17:26:38.173

通常，Perl 中的默认正则表达式引擎尝试按该顺序进行最左边和最长的匹配。如果它可以匹配最左边的交替可能性并且仍然满足正则表达式的其余部分，它会。

但是，您可以更改正则表达式引擎。

# objective-c - Objective-C 中的匿名委托实现？

> ID：766475
> 
> 赞同：25
> 
> 时间：2009-04-20T00:18:29.470
> 
> 标签：objective-c, delegates, anonymous-class

是否可以在 Objective-C 中声明诸如 Delegates 之类的匿名实现。我认为我的术语是正确的，但这是一个 java 示例：

```
myClass.addListener(new FancyInterfaceListener({
    void onListenerInterestingAction(Action a){
        ....interesting stuff here
    }
}); 
```

因此，例如要处理 UIActionSheet 调用，我必须在同一个类中声明另一个方法，如果我想向它传递数据，这似乎有点愚蠢，因为我必须将该数据存储为全局变量。这是一个使用确认对话框删除某些内容的示例，询问您是否确定：

```
-(void)deleteItem:(int)indexToDelete{
    UIActionSheet *confirm = [[UIActionSheet alloc] initWithTitle:@"Delete Item?" delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:@"Delete" otherButtonTitles:nil];
    [confirm showInView:self.view];
    [confirm release];
} 
```

和同一类中的 UIActionSheetDelegate：

```
- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex{
    if (buttonIndex == 0){
        [[Settings sharedSettings] removeItemAtIndex:/*need index variable here*/];
        [drinksTable reloadData];
    }
} 
```

我想要做的是内联声明它，就像我在顶部的 java 示例中所做的那样。这可能吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-20T16:09:22.507

目前在 Objective-C 中没有办法做到这一点。Apple 已经发布了一些关于向语言添加块（实际上更像 lambda 闭包而不是匿名类）的工作。您可能可以用这些做类似于匿名委托的事情。

同时，大多数 Cocoa 程序员将委托方法添加到委托类的单独类别中。这有助于使代码更有条理。在您示例中的类的 .m 文件中，我会执行以下操作：

```
@interface MyClass (UIActionSheetDelegate)
- (void)actionSheet:(UIActionSheet*)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex;
@end

@implementation MyClass
//... normal stuff here
@end

@implementation MyClass (UIActionSheetDelegate)
- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex{
    if (buttonIndex == 0){
        [[Settings sharedSettings] removeItemAtIndex:/*need index variable here*/];
        [drinksTable reloadData];
    }
}
@end 
```

Xcode 在编辑器窗口中弹出的方法会将类别的声明和实现与主类分开。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T00:22:26.247

Objective-C 没有像 Java 那样的匿名类的概念，所以你不能像在 Java 代码中那样创建一个“内联”类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-17T14:03:24.943

当我遇到这个问题时，我一直在寻找不同的东西，但是如果你搜索 UIALERTVIEW+BLOCKS，你会发现做内联 UIALERTVIEWs 的几个命中。这是我一直在使用的：[ALERTVIEW w/blocks](http://gkoreman.com/blog/2011/02/15/uialertview-with-blocks/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-01T00:03:14.320

我相信匿名类可以在Objective-C中实现，但这需要大量的`NSProxy`魔法和`IMP`疯狂。这是我目前的项目之一。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T21:08:59.763

一个实现委托接口的类怎么样。在初始化时它会占用一个块。在委托定义中，它调用此块。

这允许多个 UIActionSheets 同时存在，而无需比较身份。

# c++ - 是否有在不同平台上预读的等价物？

> ID：766477
> 
> 赞同：6
> 
> 时间：2009-04-20T00:19:44.227
> 
> 标签：c++, file, file-io, cross-platform

我正在用 C++ 编写一个并发的、持久的消息队列，它需要在不使用内存映射 io 的情况下对文件进行并发读取访问。简短的故事是几个线程将需要从文件的不同偏移量中读取。

最初我有一个具有典型读/写方法的文件对象，线程将获取一个互斥锁来调用这些方法。但是，碰巧我没有在某处正确获取互斥锁，导致一个线程在读/写期间移动文件偏移量，而另一个线程将开始读/写文件的不正确部分。

因此，偏执的解决方案是每个线程有一个打开的文件句柄。现在我对同一个文件有很多文件句柄，我认为这不是很好。

我想使用类似[pread](http://linux.about.com/library/cmd/blcmdl2_pread.htm)的东西，它允许将当前偏移量传递给读/写函数。

但是，该功能仅在 linux 上可用，我需要在 windows、aix、solaris 和 hpux 上等效的实现，有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-20T00:41:12.910

在 Windows 上，[ReadFile()](http://msdn.microsoft.com/en-us/library/aa365467(VS.85).aspx)函数可以做到这一点，请参阅[async IO 上](http://msdn.microsoft.com/en-us/library/ms686358(VS.85).aspx)`lpOverlapped`的参数和此信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T00:33:46.220

对于 NIO，`java.nio.channels.FileChannel`有一个`read(ByteBuffer dst, long position)`方法，它在内部使用`pread`.

哦等等，你的问题是关于 C++，而不是 Java。好吧，我只是查看了 JDK 源代码，看看它是如何在 Windows 上完成的，但不幸的是，在 Windows 上它不是原子的：它只是搜索，然后读取，然后再搜索。

对于 Unix 平台，关键`pread`是任何支持 XSI（显然是 X/开放系统接口）操作系统的标准：[http ://www.opengroup.org/onlinepubs/009695399/functions/pread.html](http://www.opengroup.org/onlinepubs/009695399/functions/pread.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T22:56:48.433

根据另一个答案，我能想到的最接近的是这个。但是有一个bug：ReadFile 会改变文件偏移量，而pread 保证不会改变文件偏移量。没有真正的方法可以解决这个问题，因为代码可以在没有锁的情况下同时执行普通的 read() 和 write()。有人找到不会改变偏移量的电话吗？

```
unsigned int FakePRead(int fd, void *to, std::size_t size, uint64_offset) {
  // size_t might be 64-bit.  DWORD is always 32.
  const std::size_t kMax = static_cast<std::size_t>(1UL << 31);
  DWORD reading = static_cast<DWORD>(std::min<std::size_t>(kMax, size));
  DWORD ret;
  OVERLAPPED overlapped;
  memset(&overlapped, 0, sizeof(OVERLAPPED));
  overlapped.Offset = static_cast<DWORD>(off);
  overlapped.OffsetHigh = static_cast<DWORD>(off >> 32);
  if (!ReadFile((HANDLE)_get_osfhandle(fd), to, reading, &ret, &overlapped)) {
    // TODO: set errno to something?
    return -1;
  }
  // Note the limit to 1 << 31 before.
  return static_cast<unsigned int>(ret);
} 
```

# raku - Perl 6 是否对将使用的顺序交替做出任何承诺？

> ID：766480
> 
> 赞同：5
> 
> 时间：2009-04-20T00:21:07.920
> 
> 标签：raku, rules

考虑到 Perl 6 之类的替代方案，`/(foo|foobar|foobaz)/`是否会承诺首先使用这三个中的哪一个，如果它确实在文档中的哪个位置做出了承诺？

请参阅相关问题[Perl 当前（5.8 和 5.10）是否对将使用的顺序交替做出任何承诺？](https://stackoverflow.com/questions/766474).

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-20T06:24:04.443

简而言之：备选方案应该（至少在名义上）并行匹配，最长的匹配获胜。如果你想要顺序交替，你可以使用双杠 ||，它保证从左到右的顺序就像 | 在 Perl 5 正则表达式中执行。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-20T02:05:54.580

[S05](http://perlcabal.org/syn/S05.html)说

> 为此，Perl 6 中的每个正则表达式都需要能够将其“纯”模式与其动作区分开来，并返回其初始标记模式列表（传递性地包括由“纯”部分调用的任何子规则的标记模式）该正则表达式，但不包括任何子规则超过一次，因为这将涉及自我引用，这在传统正则表达式中是不允许的）。使用 | 的逻辑交替 然后获取两个或多个这些列表并分派到与最长标记前缀匹配的替代项。这可能是也可能不是首先出现在词汇上的替代方案。
> 
> 但是，如果两个备选方案以相同的长度匹配，则首先通过特异性打破平局。以最长固定字符串开头的替代方案获胜；也就是说，精确匹配比使用字符类进行的匹配更接近。如果这不起作用，则通过两种方法之一打破平局。如果备选方案采用不同的语法，标准 MRO（方法解析顺序）将确定首先尝试哪一个。如果备选方案在同一个语法文件中，则文本上较早的备选方案优先。（如果一个文法的规则在多个文件中定义，则顺序未定义，如果首先尝试错误的，则必须使用显式断言来强制失败。）

这似乎是一个与 Perl 5 中的承诺截然不同的承诺。

# c# - XNA如何存储和绘制二维地图？

> ID：766484
> 
> 赞同：1
> 
> 时间：2009-04-20T00:23:31.830
> 
> 标签：c#, xna

我有一个问题，我不确定如何解决。我需要为我的 XNA 应用程序创建一个 2D 地图编辑器，其中包含一定数量的图块。假设地图将是 50x100 的图块。

我不确定地图、图块使用什么数据结构以及如何将其存储在硬盘驱动器上以供以后加载。

我现在想的是这个。我会将地图存储在一个文本文件中，如下所示：

```
//x, y, ground_type, object_type
0, 0, 1, 0
0, 1, 2, 1 
```

其中 0 = 草，1 = 河流等地面地形，0 = 无，1 = 物体类型的墙。

然后我将有一个游戏组件映射类，它可以读取该文件或从头开始创建一个新文件：

```
class Map : DrawableGameComponent {
      //These are things like grass, whater, sand...
      Tile ground_tiles[,];
      //These are things like walls that can be destroyed
      Tile object_tiles[,];

      public Map(Game game, String filepath){
          for line in open(filepath){
               //Set the x,y tile to a new tile
               ground_tiles[line[0], line[1]] = new Tile(line[3])
               object_tiles[line[0], line[1]] = new Tile(line[4])
          }
      }

      public Map(Game game, int width, int heigth){
        //constructor
        init_map()
      }
      private void init_map(){
          //initialize all the ground_tiles
          //to "grass"
          for i,j width, heigth{
              ground_tiles[i,j] = new Tile(TILE.GRASS)
          }

      public override Draw(game_time){
            for tile in tiles: 
                sprite_batch.draw(tile.texture, tile.x, tile.y etc..)

      } 
```

我的 Tile 类可能不是游戏组件。我仍然不太确定如何处理碰撞检测，例如来自玩家的子弹与地图对象之间的碰撞检测。这应该由 Map 类还是某种超级 Manager 类来处理？

欢迎任何提示。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T00:27:58.433

为什么不将其存储为：

```
Height 
Width
GroundType * (Height * Width) 
```

给予类似的东西

```
4 
4
0 0 0 0 
0 0 0 0
0 0 0 0
0 0 0 0 
```

它既简单又紧凑。:) 至于游戏内存储，2D 阵列非常适合，除非您有其他特定需求。一种典型的碰撞检测技术是由物理子系统完成一个广泛的阶段，例如使用边界球或轴对齐的边界框，然后计算可能发生碰撞的对象对是否确实存在碰撞。

您的 tile 类可能不应该是一个组件，除非您有非常令人信服的理由。

编辑：忘记了那里的对象类型，但也很容易集成它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T19:08:33.840

谢谢，但我决定使用 (ground_type, object_type) 对。所以像这样的输入文件

```
0, 1
0, 0,
0, 0,
1, 1 
```

使用如下映射：GROUND = {0:grass, 1:road} OBJECTS = {0:none, 1:crate} 并且 map 的 width=2 和 height=2 将产生以下结果：

```
grass+crate  |   grass 
grass        |   road+crate 
```

当然，我必须知道地图的宽度/高度才能理解文件。我也可以把它放在输入文件中。

# postgresql - B-Tree 和 GiST 索引方法（在 PostgreSQL 中）有什么区别？

> ID：766488
> 
> 赞同：17
> 
> 时间：2009-04-20T00:24:39.783
> 
> 标签：postgresql, indexing, b-tree, gist-index

我最近一直在优化我的 Postgres 数据库，而传统上，我只使用过 B-Tree 索引。但是，我在 Postgres 8.3 文档中看到 GiST 索引支持非唯一的多列索引。

但是，我看不出它们之间的实际区别是什么。我希望我的程序员同事能够解释它们之间的优缺点，更重要的是，为什么我会使用其中一个而不是另一个？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-20T00:33:17.843

简而言之：B-Tree 索引性能更好，但 GiST 索引更灵活。通常，如果 B-Tree 索引适用于您的数据类型，则需要它们。PG 列表上最近有一篇关于使用 GiST 索引对性能造成巨大影响的帖子；预计它们会比 B-Trees 慢（这就是灵活性的代价），但不会*慢*很多……正如您所料，工作正在进行中。

来自PostgreSQL 核心开发人员[Tom Lane 的帖子：](http://archives.postgresql.org/pgsql-performance/2009-04/msg00272.php)

> GIST 的要点是能够索引在 btree 中根本不可索引的查询。...人们完全期望 btree 在 btree 可索引案例中击败 GIST。我认为这里重要的一点是它赢了几百倍。这非常糟糕，并且可能指向一些实现问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-20T04:52:47.550

基本上每个人都是对的 - btree 是默认索引，因为它执行得非常好。GiST 有点不同——它更像是一个“编写索引类型的框架”，而不是一个索引类型。您必须添加自定义代码（在服务器中）才能使用它，但另一方面 - 它们非常灵活。

通常 - 您不使用 GiST，除非您使用的数据类型告诉您这样做。使用 GiST 的数据类型示例：ltree（来自 contrib）、tsvector（contrib/tsearch 直到 8.2，自 8.3 开始在核心）等。

众所周知，PostgreSQL 的地理扩展速度非常快 - PostGIS ( [http://postgis.refractions.net/](http://postgis.refractions.net/) )，它使用 GiST 来实现其目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T00:30:34.043

GiST 索引在一定程度上是有损的，这意味着 DBMS 必须处理误报/误报，即：

> GiST 索引是有损的，因为每个文档在索引中都由固定长度的签名表示。签名是通过将每个单词散列成 n 位字符串中的一个随机位生成的，所有这些位 OR-ed 一起产生一个 n 位文档签名。当两个单词散列到相同的位位置时，将出现错误匹配。如果查询中的所有单词都匹配（真或假），则必须检索表行以查看匹配是否正确。b-trees 没有这种行为，因此根据被索引的数据，两者之间可能存在一些性能差异。

有关文本搜索行为，请参见[http://www.postgresql.org/docs/8.3/static/textsearch-indexes.html](http://www.postgresql.org/docs/8.3/static/textsearch-indexes.html)和[http://www.postgresql.org/docs/8.3/static/indexes-types.html](http://www.postgresql.org/docs/8.3/static/indexes-types.html)通用比较。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T00:31:11.157

GiST 是更通用的索引。您可以将它们用于与 B-Tree 一起使用的更广泛的用途。包括使用 GiST 构建 B-Tree 的能力。

IE：您可以使用 GiST 对地理点或地理区域进行索引，这是您无法使用 B-Tree 索引做的事情，因为 B-Tree 上唯一重要的是您的键（或键）正在建立索引。

# java - 使用 css 的 java servlet 的某种母版页

> ID：766492
> 
> 赞同：1
> 
> 时间：2009-04-20T00:25:56.020
> 
> 标签：java, css, web-applications, master-pages

我正在使用 Netbeans 和 servlet 创建一个 Web 应用程序。我在我的页面中使用了一些 CSS。有没有一种方法可以将每个 servlet 将拥有的横幅和菜单放在一个地方，这样我就不需要在每个 servlet 中重写它？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T00:32:03.727

有了facelets，这将是蛋糕。由于您使用的是 servlet，因此请尝试创建一个仅包含标题、菜单等代码的基本 Servlet 类。

然后，让每个孩子覆盖，比如 getBody：

这是父级（伪代码）：

```
class Template extends HttpServlet {
    doGet()
    {
        write getHeader();
        write getMenu();
        write getBody();
    }
}

class SamplePage extends Template {
    getBody()
    {
        //put body HTML here
    }
} 
```

然后每个孩子将被模板模板化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T00:29:28.197

包括一个包含公共片段的 JSP 文件，例如

```
<%@include page="..." /> 
```

您还可以设置一个通用的页眉/页脚排列，并在每个文件的开头和结尾包含顶部和底部位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T01:01:00.680

好吧，我只是定义了一个基础 servlet 类，我的所有单独的 servlet 类都将覆盖它。然后，我将我的公共元素放入从我的 servlet 读取的文件中，并在必要时调用我的“带有页眉和页脚的输出页面”方法。没有 facelets 或任何标题中带有“X”或“EE”的东西——只是有点好的 ole'Java ......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T05:13:45.860

我建议在标准 JSP @include 功能上使用[Apache Tiles](http://tiles.apache.org/)或[SiteMesh之类的东西。](http://www.opensymphony.com/sitemesh/)这些库更强大、更灵活，并且会产生更易于维护的 JSP 代码。

# java - Java 代码使用检查器

> ID：766493
> 
> 赞同：5
> 
> 时间：2009-04-20T00:26:47.080
> 
> 标签：java, code-coverage, static-analysis

我正在开发一个库，我们想确定我们的库有多少被使用。IE 我们想知道我们的库中有多少方法是公开的，但从未被调用。

目标：静态分析 确定当前项目中有多少行代码调用包A中的每个公共方法。如果调用次数为零，则应报告该方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T02:28:06.727

我相信你正在寻找这个 Eclipse 插件 --> [UCDetector](http://www.ucdetector.org/)

从文档（注意第二个要点）

*   不必要的（死）代码
*   **可见性可以更改为受保护、默认或私有的代码**
*   字段的方法，可以是最终的

在更大的范围内，如果您想进行对象级静态分析，请查看 IBM 提供的这个工具 --> [Structural Analysis for Java](http://www.alphaworks.ibm.com/tech/sa4j)。它对库、API 等的对象分析非常有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T00:38:44.163

不完全是您正在寻找的东西，但是：

使用代码覆盖工具（如[Cobertura](http://cobertura.sourceforge.net/)）可以完成类似的操作。他们不对源代码进行静态检查，而是检测字节码以在运行时收集指标。当然，您需要以一种练习所有使用模式的方式来驱动应用程序，并且可能会错过更罕见的代码路径。

在静态分析方面，也许这些工具可以帮助您（Apache 项目使用它们来检查新版本的 API 兼容性，似乎该任务与您正在尝试做的事情有些相关）：

*   [Clirr](http://clirr.sourceforge.net/)是一个检查 Java 库与旧版本的二进制和源代码兼容性的工具。基本上你给它两组 jar 文件，Clirr 会转储出公共 api 中的更改列表。
*   [JDiff](http://jdiff.sourceforge.net/)是一个 Javadoc doclet，当比较两个 API 时，它会生成所有已被删除、添加或更改的所有包、类、构造函数、方法和字段的 HTML 报告，包括它们的文档。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T03:03:34.580

客户端使用反射调用是静态分析中需要考虑的一个漏洞。因为没有办法确定某个特定的方法没有通过一些奇怪的反射方案被调用。所以，也许运行时和静态分析的结合可能是最好的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T08:48:59.150

我认为您无法衡量需要一个类或一个函数的“频率”。
有一些简单的问题：

*   什么定义，如果您的游戏库的使用统计是“正常”或“异常值”？经常在游戏中杀死自己是错误的吗？你会像一个优秀的游戏玩家一样更频繁地使用“killScreen”类。
*   什么定义了“很多”？时间或使用次数？POJO 会消耗很少的时间，但会非常频繁地使用。

结论：
我不知道您要完成什么。
如果你想显示你的代码依赖关系，还有其他[工具](https://stackoverflow.com/questions/100372/good-tool-to-generate-dependency-diagram)可以做到这一点。如果您尝试测量代码执行情况，可以使用 Java[分析器或基准测试](https://stackoverflow.com/search?q=%5Bjava%5D+profiler)。[如果您是统计极客，您会对RapidMiner](http://rapid-i.com/)感到满意；）

祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T13:42:45.933

我建议 JDepend 向您展示包和类之间的依赖关系，非常适合找到循环依赖关系！ [http://clarkware.com/software/JDepend.html](http://clarkware.com/software/JDepend.html) （它有一个 Eclipse 插件：[http ://andrei.gmxhome.de/jdepend4eclipse/](http://andrei.gmxhome.de/jdepend4eclipse/)

以及其他指标的 PMD [http://pmd.sourceforge.net/](http://pmd.sourceforge.net/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-06T09:42:21.400

IntelliJ 有一个工具来检测方法、字段、类，这些可以有更多的限制修饰符。它还可以快速修复应用这些更改，这也可以为您节省大量工作。如果您不想为此付费，您可以获得 30 天的 eval 许可证，这足以更改您的代码，这不是您应该经常做的事情。

顺便说一句：IntelliJ 有大约 650 次代码检查来提高代码质量，大约一半有自动修复，所以我建议花几天时间使用它来重构/整理你的代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-08T07:17:55.090

请看一下[死代码检测器](https://dcd.dev.java.net/)。它声称可以满足您的需求：使用静态分析查找未使用的代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T00:32:52.463

以下是一些 Java 代码覆盖率工具列表。我没有亲自使用过这些，但它可能会让你开始：

*   [http://java-source.net/open-source/code-coverage](http://java-source.net/open-source/code-coverage)
*   [http://www.codecoveragetools.com/index.php/coverage-process/code-coverage-tools-java.html](http://www.codecoveragetools.com/index.php/coverage-process/code-coverage-tools-java.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-04T22:50:43.497

Proguard 也可能是一种选择（[http://proguard.sourceforge.net/](http://proguard.sourceforge.net/)）：

“ProGuard 的一些用途是：

*   ...
*   ***列出死代码，因此可以从源代码中删除。***
*   ……”

另请参阅[http://proguard.sourceforge.net/manual/examples.html#deadcode](http://proguard.sourceforge.net/manual/examples.html#deadcode)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-05T22:44:21.483

[您可以使用 ASM 字节码分析库 ( http://asm.ow2.org](http://asm.ow2.org) )为此编写自己的实用程序（阅读本文后一小时内）。您需要实现 ClassVisitor 和 MethodVisitor。您将使用 ClassReader 解析库中的类文件。

*   您的 ClassVisitor 的 visitMethod(..) 将为每个声明的方法调用。
*   您的 MethodVisitor 的 visitMethodInsn(..) 将为每个调用的方法调用。

维护一张地图来进行计数。键代表方法（见下文）。这是一些代码：

```
class MyClassVisitor {
    // ...
    public void visit(int version, int access, String name, ...) {
        this.className = name;
    }
    public MethodVisitor visitMethod(int access, String name, String desc, ...):
        String key = className + "." + name + "#" + desc;
        if (!map.containsKey() {
            map.put(key, 0);
        }
        return new MyMethodVisitor(map);
    }
    // ...
}

void class MyMethodVisitor {
    // ...
    public visitMethodInsn(int opcode, String name, String owner, String desc, ...) {
        String key = owner + "." + name + "#" + desc;
        if (!map.containsKey() {
            map.put(key, 0);
        }
        map.put(key, map.get(key) + 1);
    }
    // ...
} 
```

基本上就是这样。你的节目是这样开始的：

```
Map<String,Integer> map = new HashMap<String,Integer>();
for (File classFile : my library) {
    InputStream input = new FileInputStream(classFile);
    new ClassReader(input).accept(new MyClassVisitor(map), 0);
    input.close();
}
for (Map.Entry<String,Integer> entry : map.entrySet()) {
    if (entry.getValue() == 0) {
        System.out.println("Unused method: " + entry.getKey());
    }
} 
```

享受！

# ruby-on-rails - 如何设置新添加的 ActiveRecord 计数器缓存的值？

> ID：766515
> 
> 赞同：1
> 
> 时间：2009-04-20T00:33:58.403
> 
> 标签：ruby-on-rails, activerecord

我有一个模型对象，它之前没有计数器缓存，我通过迁移添加了它。问题是，我尝试根据迁移中已经拥有的子对象的数量设置计数器缓存的起始值，但失败了。任何更新缓存值的尝试都没有写入数据库。我什至试图从控制台做到这一点，但它永远不会发生。任何直接写入父级上的值的尝试都将被忽略。

更改子项的数量会更新计数器缓存（应该如此），并从子项中删除“:counter_cache => true”可以让我更新父项的值。但那是欺骗。我需要能够添加计数器缓存，然后将其起始值设置为迁移中的子节点数，这样我就可以从显示它的页面的正确值开始。

这样做的正确方法是什么，以便 ActiveRecord 不会覆盖我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T00:45:48.000

您想使用 update_counters 方法，这篇博文有更多详细信息：

[josh.the-owens.com 将计数器缓存添加到现有数据库表](https://web.archive.org/web/20090928054732/http://josh.the-owens.com/archives/2007/11/03/rails-edge-change-how-to-add-a-counter-cache-to-an-existing-db-table/)

这个关于该主题的 RailsCasts 也是一个很好的资源：

[http://railscasts.com/episodes/23-counter-cache-column](http://railscasts.com/episodes/23-counter-cache-column)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-16T12:18:03.317

规范的方法是使用`reset_counter_cache`，即：

```
Author.find_each do |author|
  Author.reset_counter_cache(author.id, :books)
end 
```

...如果这些表大小适中，即 <= 1,000,000 行，您应该这样做。

**但是：**对于任何大的事情，这将花费几天的时间，因为它需要对每一行进行两次查询，并完全实例化一个模型等。

这是一种将速度提高约 5 个数量级的方法：

```
Author
  .joins(:books)
  .select("authors.id, authors.books_count, count(books.id) as count")
  .group("authors.id")
  .having("authors.books_count != count(books.id)")
  .pluck(:id, :books_count, "count(books.id)")
  .each_with_index do |(author_id, old_count, fixed_count), index| 
    puts "at index %7i: fixed author id %7i, new books_count %4i,  previous count %4i" % [index, author_id, fixed_count, old_count] if index % 1000 == 0
    Author.update_counters(author_id, books_count: fixed_count - old_count)
  end 
```

也可以使用单个查询直接在 SQL 中执行此操作，但以上对我来说已经足够好了。请注意它使用先前计数与正确计数的差异的有点复杂的方式：这是必要的，因为`update_counters`不允许设置绝对值，而只能增加/减少它。该列被标记为只读。

# c - 在 scanf 中使用 [^ 符号的目的是什么？

> ID：766516
> 
> 赞同：9
> 
> 时间：2009-04-20T00:35:03.643
> 
> 标签：c, scanf, format-specifiers

我遇到了一些代码，想知道原始开发人员在做什么。下面是一个使用这种模式的简化程序：

```
 #include <stdio.h>

      int main()  {     

      char title[80] = "mytitle";      
      char title2[80] = "mayataiatale";      
      char mystring[80]; 

      /* hugh ? */
      sscanf(title,"%[^a]",mystring);
      printf("%s\n",mystring); /* Output is "mytitle" */

      /* hugh ? */
      sscanf(title2,"%[^a]",mystring); /* Output is "m" */
      printf("%s\n",mystring);

      return 0;  
  } 
```

scanf的[手册页](https://linux.die.net/man/3/scanf)有相关信息，但我无法阅读它。使用这种符号的目的是什么？它试图完成什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-20T02:55:16.020

字符类的主要原因是 %s 符号在第一个空白字符处停止，即使您指定了字段长度，而且您通常不希望它这样做。在这种情况下，字符类表示法会非常有用。

考虑此代码以读取最多 10 个字符的行，丢弃任何多余的字符，但保留空格：

```
#include <ctype.h>
#include <stdio.h>

int main(void)
{
    char buffer[10+1] = "";
    int rc;
    while ((rc = scanf("%10[^\n]%*[^\n]", buffer)) >= 0)
    {
            int c = getchar();
            printf("rc = %d\n", rc);
            if (rc >= 0)
                    printf("buffer = <<%s>>\n", buffer);
            buffer[0] = '\0';
    }
    printf("rc = %d\n", rc);
    return(0);
} 
```

这实际上是关于 comp.lang.c.moderated（大约 2004 年 6 月）与`getline()`变体相关的讨论的示例代码。

* * *

至少出现了一些混乱。第一个格式说明符 ,`%10[^\n]`最多读取 10 个非换行符并将它们分配给缓冲区，以及尾随的 null。第二个格式说明符`%*[^\n]`包含赋值抑制字符 ( `*`) 并从输入中读取零个或多个剩余的非换行符。当`scanf()`函数完成时，输入指向下一个换行符。循环体读取并打印该字符，因此当循环重新开始时，输入正在查看下一行的开头。然后重复该过程。如果该行短于 10 个字符，则将这些字符复制到缓冲区，并且“零个或多个非换行符”格式处理零个非换行符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T00:45:19.843

类似`%[a]`和`%[^a]`存在的结构`scanf()`可以用作一种词法分析器。这些有点像`%s`，但它们不是收集尽可能多的“字符串”字符，而是只收集字符类描述的字符范围。在某些情况下，编写`%[a-zA-Z0-9]`可能有意义，但我不确定我是否看到了具有`scanf()`.

恕我直言，`scanf()`根本不是这项工作的正确工具。每次我开始使用它的一个更强大的功能时，我最终都会把它撕掉并以不同的方式实现该功能。`strtok()`在某些情况下，这意味着使用 lex 编写真正的词法分析器，但通常一次执行 I/O 并在进行值转换之前将其粗略地分解为标记就足够了。

**编辑：**我结束了删除`scanf()`通常是因为当面对用户坚持提供不正确的输入时，它只是不擅长帮助程序对问题提供良好的反馈，并且让汇编程序打印“错误，终止”。因为它唯一有用的错误信息并没有被我的用户接受。（我，在那种情况下。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T00:40:38.340

这就像正则表达式中的字符集；`[0-9]`匹配一串数字，`[^aeiou]`匹配任何不是小写元音的东西，等等。

有各种各样的用途，例如提取数字、标识符、空格块等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-08T16:13:07.907

[您可以在在线提供的ISO/IEC9899 标准](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)中了解它。

这是我从文件中引用的一段`[`（第286页）：

> 匹配一组预期字符中的非空字符序列。
> 
> 转换说明符包括格式字符串中的所有后续字符，直到并包括匹配的右括号 (])。括号之间的字符（扫描列表）组成扫描集，除非左括号之后的字符是一个抑扬符 (^)，在这种情况下，扫描集包含所有未出现在抑扬符和右括号之间的扫描列表中的字符。如果转换说明符以 [] 或 [^] 开头，则右括号字符在扫描列表中，并且下一个右括号字符是结束说明的匹配右括号；否则后面的第一个右括号字符是结束规范的字符。如果 - 字符在扫描列表中并且不是第一个字符，也不是第一个字符是 ^ 的第二个字符，也不是最后一个字符，

# oop - OO 语言中的动态绑定实现

> ID：766528
> 
> 赞同：0
> 
> 时间：2009-04-20T00:42:16.310
> 
> 标签：oop, dynamic

在 OO 语言中用于实现动态绑定的两种方式是什么。就像 Smalltalk 这样的纯 OOL 与 C++ 这样的混合 OOL 如何实现动态绑定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T00:53:13.897

不知道有没有两种方式，也不知道是纯面向对象语言还是混合面向对象语言。

基本上，C++ 使用虚拟表调度 - 每个实例都带有一个函数表（在 C++ 的情况下，它带有一个指向该表的指针，但这在调度机制中没有任何作用），当你调用时`x.my_method()`，编译器知道它的例子。对象的第二个方法，因此它发出代码以跳转到虚拟方法表中的第二个指针。

在动态语言（和 ObjC）中，它通常通过在某个地方有一个方法字典来解决，在运行时`my_method`查找名称并执行找到的任何函数。

有多种方法 - 在 COM 中，您通过标识符查找接口；然后你从它的 vtable 中执行一个方法。

有时，会生成一些类似 switch 语句的代码（例如，根据对象的类型进行 switch）以加速第二种方法。

# php - 显示最后 100 个条目的随机行？

> ID：766530
> 
> 赞同：1
> 
> 时间：2009-04-20T00:42:28.197
> 
> 标签：php, mysql

我目前正在从所有条目中显示一个随机行，并且效果很好。

```
SELECT * FROM $db_table where live = 1 order by rand() limit 1 
```

现在，我想将其限制为数据库中的最后 100 个条目。

数据库中的每一行都有一个 ID 和一个时间戳。

它是一个小型数据库，因此开销最小化不是优先事项。

谢谢！

编辑：

仍然无法让它运行.. 我得到一个 mysql_fetch_array 错误：

```
"Warning: mysql_fetch_array(): supplied argument is not a valid MySQL result resource 
```

这是我的所有代码：

```
<?php $sql = "SELECT * FROM
(SELECT * FROM $db_table ORDER BY $datetime DESC LIMIT 100)
ORDER BY rand() LIMIT 1";
$query = mysql_query($sql);
while($row = mysql_fetch_array($query)) {

echo "".$row['familyname']."";

} ?> 
```

再次感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T00:44:55.367

这就是我想到的。我已经对其进行了测试，它可以在 SQLite 中运行，所以你不应该对 MySQL 有太大的麻烦。唯一的变化是 SQLite 的随机函数是 random() 而不是 rand()：

```
SELECT * FROM
  (SELECT * FROM $db_table ORDER BY $timestamp DESC LIMIT 100)
ORDER BY rand() LIMIT 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T02:40:08.477

[这个页面](http://jan.kneschke.de/projects/mysql/order-by-rand/)有一个关于如何优化`ORDER BY RAND()`-type 查询的非常详细的文章。对于我来说，对 SO 进行充分解释实际上太复杂了（此外，我并不完全理解使用的一些 SQL 命令，尽管一般概念是有道理的），但最终优化的查询使用了几个优化：

1.  首先，删除对整个表`ORDER BY RAND()`使用算法的 。`filesort`相反，构造查询以简单地生成单个随机 id。
2.  在这个阶段，`index scan`正在使用 an，在许多情况下它的效率甚至低于 a `filesort`，因此使用子查询对其进行了优化。
3.  该`WHERE`子句被替换为 a`JOIN`以将外部获取的行`SELECT`数和子查询的执行次数减少到仅 1。
4.  为了解决 id 中的漏洞（来自删除）并确保均匀分布，创建了一个映射表来将行号映射到 id。
5.  触发器用于自动更新和维护映射表。
6.  最后，创建存储过程以允许一次选择多行。（在这里，`ORDER BY`重新引入，但仅用于结果行。）

以下是性能数据：

*   Q1。兰德订购（）
*   Q2。兰德() * 最大值(ID)
*   Q3。RAND() * MAX(ID) + 按 ID 排序

```
   100 1.000 10.000 100.000 1.000.000
Q1 0:00.718s 0:02.092s 0:18.684s 2:59.081s 58:20.000s
Q2 0:00.519s 0:00.607s 0:00.614s 0:00.628s 0:00.637s
第三季度 0:00.570s 0:00.607s 0:00.614s 0:00.628s 0:00.637s

```

# c# - 实体框架/LINQ to SQL 数据绑定是否使用反射？

> ID：766540
> 
> 赞同：8
> 
> 时间：2009-04-20T00:47:07.280
> 
> 标签：c#, vb.net, linq-to-sql, entity-framework, reflection

如果以前有人问过这个问题，请原谅我；我进行了搜索，但找不到任何专门回答此问题的内容，但我很乐意被推荐。

我正在查看实体框架和 LINQ to SQL，虽然我喜欢这些系统（当然还有 LINQ 集成），但我对数据绑定方面有点怀疑。我已经获取查询结果并检查了它们，它们似乎没有实现标准的 .NET 列表绑定接口（`IBindingList`更重要的是`ITypedList`），这让我相信将它们绑定到网格（或其他任何东西）正在发生使用反射来获取/设置我的实体属性。这似乎是一个相对昂贵的操作，尤其是当所有代码都生成并且可以实现接口时。

有没有人对此有任何见解？反射是否用于获取/设置属性的值？如果是，这是否会对性能产生明显影响，是否有人知道他们为什么要走这条路？

**编辑**

我实际上专注于是否在`ITypedList`某个地方实现，因为它有能力提供一种明确的机制来定义属性并与属性交互而不诉诸反射。虽然我没有启动 LINQ to SQL 项目，但我确实检查了一个简单的 Entity Framework 实体查询结果，但它似乎没有实现`ITypedList`. 有谁知道我是否只是看错了东西，或者如果不是，为什么会这样？

**编辑 2**

接受 Marc 的回答后，我认为如果我发布一些用于无缝实现他的解决方案的简单代码，可能对其他人有帮助。我将以下内容放入我的类的静态构造函数中：

```
public static ContextName()
{
    foreach(Type type in System.Reflection.Assembly.GetExecutingAssembly()
        .GetTypes())
    {
        if (type.GetCustomAttributes(typeof(System.Data.Linq.Mapping
            .TableAttribute), true) != null)
        {
            System.ComponentModel.TypeDescriptor.AddProvider(
                new Hyper.ComponentModel.HyperTypeDescriptionProvider(
                    System.ComponentModel.TypeDescriptor.GetProvider(
                        type)), 
                type);
        }
    }
} 
```

虽然这是针对 LINQ to SQL 的，但我确信可以为实体框架编写等效版本。这将扫描程序集以查找具有该`Table`属性的任何类型，并为每个类型添加一个自定义提供程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T12:39:13.417

支持 LINQ 等的 Expression API 是基于反射（`MemberInfo`），而不是组件模型（`PropertyDescriptor`等） - 所以对`ITypedList`. 相反，内容是从in`T`等`IQueryable<T>`推断出来的。`IEnumerable<T>``IList<T>`

您可能得到的最接近的是`IListSource`，但这仍然只是正确类型列表的浅包装。

如果运行时绑定 (to `PropertyDescriptor`) 的性能是关键，您可能需要查看[HyperDescriptor](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx) - 它使用`Reflection.Emit`并`TypeDescriptionProvider`包装组件模型。

重新“为什么”等；请注意，在几乎所有使用 LINQ-to-SQL 和 EF 的情况下，`Expression`（或“创建和设置成员”部分）将在调用之前编译为委托 - 因此在运行时没有巨大的反射成本。同样，使用 LINQ-to-Objects 一切都*已经*编译（由 C# 编译器）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T12:27:36.800

根据我使用 LINQ to SQL 的经验，我得出的结论是 LINQ 使用反射来设置和获取实体类实例中的字段值。我不知道我是否能记住所有的原因，但我可以告诉你。

1.  如果我没记错的话，LINQ 不调用任何属性过程，而是直接设置和直接读取所有私有字段值，据我所知，这只能通过反射来完成。
2.  MetaData 提供的名称（在实体类属性的属性中）以字符串形式提供字段名称信息（例如，如果数据库列和属性名称不同）。您可以由此得出结论，LINQ 必须使用反射来查找成员以访问它。

我认为这样做是为了实现简单性——您可以依赖实体类中字段中的值直接镜像数据库列值，并且从数据库中检索对象没有太多开销（填充一个新创建的实体以对应从数据库中检索到的值不应通过属性过程进行路由）。例如，我为表示从数据库中检索到的枚举值所做的一件事是将一些 LINQ 生成的属性设为私有，并将它们包装在读取和写入 LINQ 属性的部分类中的手动编码属性中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T02:15:47.193

从查看[MSDN](http://msdn.microsoft.com/en-us/library/bb546190.aspx)关于 LINQ to SQL 数据绑定的内容来看，它似乎确实使用了 IListSource 或 IBindingList。

顺便说一句，LINQ 使用[Expression Trees](http://msdn.microsoft.com/en-us/library/bb397951.aspx)，这不像元编程那样反射。性能应该比反射好得多。Charlie Calvert 在这篇[文章](http://blogs.msdn.com/charlie/archive/2008/01/31/expression-tree-basics.aspx)中稍微介绍了这一点。

# resources - 如何在 CLR 程序集中添加、删除和更新资源？

> ID：766544
> 
> 赞同：0
> 
> 时间：2009-04-20T00:48:54.110
> 
> 标签：resources, clr, ilmerge

我环顾四周，找不到任何有关更改程序集中托管资源的信息（请注意，我已经熟悉 Win32 资源和更改这些资源的 API）。

我的应用程序具有最终用户需要更新的资源，并且该应用程序将作为单个可执行文件分发（因此我不能只使用附属程序集）。

我看到了一些可能的解决方法，但它们看起来很老套：

第一种是使用 ILMerge：我将在内存中创建一个新的程序集，其中包含新资源，并使用 ILMerge 将其与原始程序集组合以形成新程序。唯一的缺点是无法更新或删除资源。

第二个有点相似：会有一个 .netmodule（从 C# 编译器发出），它使用 /embed 开关针对 al.exe 运行，以添加资源以形成新的程序集。缺点是原始程序集中的任何资源都不存在。

我倾向于 ILMerge 选项，但重新分配的条款是模棱两可的。EULA 没有提及再分配权（所以我认为在这个负面自由社会中是允许的）但微软研究页面说不允许再分配（但它的措辞模棱两可，据我所知，它可能指的是商业再分配，这不适用于我，因为这是一个非盈利的 GPL 项目）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T06:59:17.587

恕我直言，我不认为这样做是个好主意。如果这些资源实际上是用户数据，即使有“预装”的一组，它也不属于嵌入式资源。

你的程序集签名了吗？您必须在更改后辞职，您的私钥被公开，每个人都可以签署您的应用程序。因此，不值得签署它，而且无论如何您都有安全风险。

将您的资源移动到外部文件。您仍然可以嵌入“预定义”资源。**第一次启动应用程序时，您会创建外部文件并将嵌入的资源复制到外部文件中。**如果外部文件存在，您就不再关心嵌入的资源。

# python - Python Collections.DefaultDict 排序 + 输出 Top X 自定义类对象

> ID：766546
> 
> 赞同：0
> 
> 时间：2009-04-20T00:49:15.700
> 
> 标签：python

问题：我需要输出由发布的消息数量决定的 TOP X Contributors。

数据：我收集了已发布的消息。这不是下面示例查询的数据库/SQL 问题，只是给出了代码的概述。

```
tweetsSQL = db.GqlQuery("SELECT * FROM TweetModel ORDER BY date_created DESC") 
```

我的模型：

```
class TweetModel(db.Model):
# Model Definition
# Tweet Message ID is the Key Name
to_user_id = db.IntegerProperty()
to_user = db.StringProperty(multiline=False)
message = db.StringProperty(multiline=False)
date_created = db.DateTimeProperty(auto_now_add=False)
user = db.ReferenceProperty(UserModel, collection_name = 'tweets') 
```

从 SO 上的示例中，我可以通过执行以下操作找到 TOP X 贡献者：

```
 visits = defaultdict(int)
    for t in tweetsSQL:
        visits[t.user.from_user] += 1 
```

现在我可以使用以下方法对其进行排序：

```
c = sorted(visits.iteritems(), key=operator.itemgetter(1), reverse=True) 
```

但是现在检索原始对象的唯一方法是遍历对象 c，找到 KeyName，然后在 TweetsSQL 中查找它以获取 TweetModel 对象。

有没有更好的办法？

*** 对不起，我应该补充说 Count(*) 由于使用谷歌应用引擎而不可用

[编辑 2]

总之，给定一个消息列表，我如何按用户的消息计数对它们进行排序。

在 SQL 中，它将是：

SELECT * FROM TweetModel GROUP BY 用户 ORDER BY Count(*)

但我不能在 SQL 中做到这一点，需要在代码中复制这个功能。我的出发点是“SELECT * FROM TweetModel”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T02:35:08.970

使用 heapq.nlargest() 而不是 sorted()，以提高效率；这就是它的用途。我不知道您问题的数据库部分的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T02:07:59.177

如果您将 SQL 查询更改为以下内容，我认为您的工作会容易得多：

```
SELECT top 100 userId FROM TweetModel GROUP BY userId ORDER BY count(*) 
```

如果您只需要数据来解决所述问题，我不会打扰 TweetModel 类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T03:16:49.837

为什么不反转字典，一旦你构建了它，键是消息计数，值是用户？然后您可以对密钥进行排序并轻松获取用户。

# java - 你什么时候在 Java 中使用可变参数？

> ID：766559
> 
> 赞同：204
> 
> 时间：2009-04-20T00:54:23.613
> 
> 标签：java, variadic-functions

我害怕可变参数。我不知道用它们做什么。

另外，让人们随意传递尽可能多的论点感觉很危险。

什么是使用它们的好地方的上下文示例？

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-04-20T00:59:20.887

*Varargs*对于需要处理*不确定数量的对象*的任何方法都很*有用*。一个很好的例子是。格式字符串可以接受任意数量的参数，因此您需要一种机制来传入任意数量的对象。*[`String.format`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#format%28java.lang.String,%20java.lang.Object...%29)*

 *```
String.format("This is an integer: %d", myInt);
String.format("This is an integer: %d and a string: %s", myInt, myString); 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2009-04-20T04:06:10.313

一个好的经验法则是：

**“将可变参数用于需要 T 数组（无论 T 可能是什么类型）作为输入的任何方法（或构造函数）”。**

这将使对这些方法的调用更容易（无需这样做`new T[]{...}`）。

您可以扩展此规则以包含带有`List<T>`参数的方法，前提是此参数仅用于输入（即，该方法不修改列表）。

此外，我会避免使用`f(Object... args)`，因为它会滑向 API 不明确的编程方式。

示例方面，我在[DesignGridLayout](https://designgridlayout.java.net/)中使用过，一次调用可以添加多个`JComponent`：

```
layout.row().grid(new JLabel("Label")).add(field1, field2, field3); 
```

在上面的代码中，add() 方法被定义为`add(JComponent... components)`.

最后，这些方法的实现必须注意它可能被一个空的可变参数调用！如果您想强加至少一个论点，那么您必须使用一个丑陋的技巧，例如：

```
void f(T arg1, T... args) {...} 
```

我认为这个技巧很难看，因为该方法的实现不如仅`T... args`在其参数列表中简单。

希望这有助于澄清关于可变参数的观点。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2012-01-02T01:23:21.737

I use varargs frequently for outputting to the logs for purposes of debugging.

Pretty much every class in my app has a method debugPrint():

```
private void debugPrint(Object... msg) {
    for (Object item : msg) System.out.print(item);
    System.out.println();
} 
```

Then, within methods of the class, I have calls like the following:

```
debugPrint("for assignment ", hwId, ", student ", studentId, ", question ",
    serialNo, ", the grade is ", grade); 
```

When I'm satisfied that my code is working, I comment out the code in the debugPrint() method so that the logs will not contain too much extraneous and unwanted information, but I can leave the individual calls to debugPrint() uncommented. Later, if I find a bug, I just uncomment the debugPrint() code, and all my calls to debugPrint() are reactivated.

Of course, I could just as easily eschew varargs and do the following instead:

```
private void debugPrint(String msg) {
    System.out.println(msg);
}

debugPrint("for assignment " + hwId + ", student " + studentId + ", question "
    + serialNo + ", the grade is " + grade); 
```

However, in this case, when I comment out the debugPrint() code, the server still has to go through the trouble of concatenating all the variables in every call to debugPrint(), even though nothing is done with the resulting string. If I use varargs, however, the server only has to put them in an array before it realizes that it doesn't need them. Lots of time is saved.

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-09-25T07:25:01.510

Varargs can be used when we are unsure about the number of arguments to be passed in a method. It creates an array of parameters of unspecified length in the background and such a parameter can be treated as an array in runtime.

If we have a method which is overloaded to accept different number of parameters, then instead of overloading the method different times, we can simply use varargs concept.

Also when the parameters' type is going to vary then using "Object...test" will simplify the code a lot.

For example:

```
public int calculate(int...list) {
    int sum = 0;
    for (int item : list) {
        sum += item;
    }
    return sum;
} 
```

Here indirectly an array of int type (list) is passed as parameter and is treated as an array in the code.

For a better understanding follow this link(it helped me a lot in understanding this concept clearly): [http://www.javadb.com/using-varargs-in-java](http://www.javadb.com/using-varargs-in-java)

P.S: Even I was afraid of using varargs when I didn't knw abt it. But now I am used to it. As it is said: "We cling to the known, afraid of the unknown", so just use it as much as you can and you too will start liking it :)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-10-13T17:09:32.907

Varargs is the feature added in java version 1.5.

**Why to use this?**

1.  What if, you don't know the number of arguments to pass for a method?
2.  What if, you want to pass unlimited number of arguments to a method?

**How this works?**

It creates an array with the given arguments & passes the array to the method.

Example :

```
public class Solution {

    public static void main(String[] args) {
        add(5,7);
        add(5,7,9);
    }

    public static void add(int... s){
        System.out.println(s.length);
        int sum=0;
        for(int num:s)
            sum=sum+num;
        System.out.println("sum is "+sum );
    }

} 
```

Output :

2

sum is 12

3

sum is 21

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-21T01:03:45.673

我也有与可变参数相关的恐惧：

If the caller passes in an explicit array to the method (as opposed to multiple parameters), you will receive a shared reference to that array.

If you need to store this array internally, you might want to clone it first to avoid the caller being able to change it later.

```
 Object[] args = new Object[] { 1, 2, 3} ;

 varArgMethod(args);  // not varArgMethod(1,2,3);

 args[2] = "something else";  // this could have unexpected side-effects 
```

While this is not really different from passing in any kind of object whose state might change later, since the array is usually (in case of a call with multiple arguments instead of an array) a fresh one created by the compiler internally that you can safely use, this is certainly unexpected behaviour.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-20T01:09:01.127

我经常将可变参数用于可以采用某种过滤器对象的构造函数。例如，我们基于 Hadoop 的系统的很大一部分是基于一个 Mapper，它处理项到 JSON 的序列化和反序列化，并应用多个处理器，每个处理器获取一个内容项并修改并返回它，或者返回 null拒绝。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-03T22:38:48.207

In Java doc of Var-Args it is quite clear the usage of var args:

[http://docs.oracle.com/javase/1.5.0/docs/guide/language/varargs.html](http://docs.oracle.com/javase/1.5.0/docs/guide/language/varargs.html)

about usage it says:

"So when should you use varargs? As a client, you should take advantage of them whenever the API offers them. Important uses in core APIs include reflection, message formatting, and the new printf facility. As an API designer, you should use them sparingly, only when the benefit is truly compelling. Generally speaking, you should not overload a varargs method, or it will be difficult for programmers to figure out which overloading gets called. "

# language-agnostic - 基于网络的商业应用程序的好例子？

> ID：766562
> 
> 赞同：4
> 
> 时间：2009-04-20T00:58:54.397
> 
> 标签：language-agnostic

我想获得更多灵感和想法来创建基于 Web 的业务应用程序。这些应用程序具有树视图、选项卡、网格、表单、面板..等。我开发应用程序，但想提高我的设计技能。所以我想看看非常漂亮的在线商业应用程序，它们很好地利用了文本和背景颜色，很好地利用了整个网站的一般主题，很好地利用了空白、分组和干净的布局。

我不是在寻找网页设计模板或如何使用 CSS 和列设计网页。

我想设计一个看起来优雅而专业的商业应用程序（半大量使用控件）。

因此，如果您遇到喜欢的商业应用网站或模板，请分享。

商业应用程序意味着类似 mint.com 或 salesforce.com。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T01:59:30.867

这些应用程序值得一试（您可以注册所有这些应用程序的免费帐户）

发票：

*   [Freshbooks.com](http://Freshbooks.com) - 流行
*   [Invoicemachine.com](http://Invoicemachine.com) - 精美的用户界面
*   [Cannybill.com](http://Cannybill.com) - 精美的用户界面
*   [Blinksale.com](http://Blinksale.com)
*   [GetBallpark.com](http://GetBallpark.com) - 非常漂亮和新，几天前在 reddit 上看到过

会计：

*   [Xero.com](http://Xero.com) - 精致的 UI，他们还使用了很多[ExtJS](http://extjs.com)控件（很少见）
*   [LessAccounting.com](http://LessAccounting.com)

项目管理：

*   [Basecamphq.com](http://Basecamphq.com) - 流行

[**feedmyapp.com**](http://www.feedmyapp.com/)上还有更多内容[](http://www.feedmyapp.com/)

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T01:02:01.957

查看[Salesforce](http://www.salesforce.com)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T01:59:54.890

看看 Web 应用程序的巅峰之作：[gmail](http://www.gmail.com)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T01:04:32.760

[Terracotta](http://www.terracotta.org/)网站给我留下了深刻的印象，它有很多很好的信息，而且不会太杂乱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T02:02:05.633

[Zoho Suite](http://www.zoho.com/)非常可爱。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T02:51:57.340

借调 gmail，以及 Google 的所有其他应用程序。*对谷歌日历的额外关注，那是经典桌面应用程序在网络上做得更好*的一个很好的例子。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-02T11:44:13.890

您还可以在这里查看示例： [http ://www.sencha.com/products/js/](http://www.sencha.com/products/js/)

# ruby - optpase 在 cmd 行参数中提供字符串时返回 true 类

> ID：766563
> 
> 赞同：1
> 
> 时间：2009-04-20T00:59:09.997
> 
> 标签：ruby, optparse

我陷入了一个完全愚蠢的境地。当我使用下面的代码片段时，尽管我的命令行是“./the_script.rb -s serv”并且我检查了代码中服务变量的值，但它总是被 optparse 视为布尔类。所以我无法从命令行获取我的字符串......

有任何想法吗 ？

```
opt = OptionParser.new do |opt|

 opt.on('-s','--service','twitter (tw) or identica (id)') do |val| 
   service = val.to_s 
 end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T02:32:48.603

我是一名 Python 程序员，而不是一名 Ruby 程序员，但为此浏览[Ruby 文档](http://www.ruby-doc.org/stdlib/libdoc/optparse/rdoc/)中的示例，我会说你所拥有的默认行为是充当布尔值。您需要为其指定更多参数才能实际*存储*该值。

```
opts.on("-s", "--service [SERVICE]", [:twitter, :identica], "Select a service (Twitter or Identica)" do |service|
    options.service = service
end 
```

然后`options.service`应该有指定的服务。我想...嘿，是鲁比。;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T02:26:17.947

我想你想`opt.parse!`在某个地方打电话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-10T21:51:23.413

正如您在`optparse.rb`(in `/usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/optparse.rb`for me)的代码文档中看到的那样`==== Using Built-in Conversions`，您必须为方法指定第二个参数的字符串`on`：

```
 173 # ==== Using Built-in Conversions
 174 #
 175 # As an example, the built-in +Time+ conversion is used. The other built-in
 176 # conversions behave in the same way.
 177 # OptionParser will attempt to parse the argument
 178 # as a +Time+. If it succeeds, that time will be passed to the
 179 # handler block. Otherwise, an exception will be raised.
 180 #
 181 #   require 'optparse'
 182 #   require 'optparse/time'
 183 #   OptionParser.new do |parser|
 184 #     parser.on("-t", "--time [TIME]", Time, "Begin execution at given time") do |time|
 185 #       p time
 186 #     end
 187 #   end.parse!
 188 # 
```

因此

```
opt.on('-s','--service [String]','twitter (tw) or identica (id)') do |val| 
```

# javascript - 无法在使用 ajax 调用加载的 DOM 中聚焦输入字段

> ID：766566
> 
> 赞同：3
> 
> 时间：2009-04-20T00:59:53.600
> 
> 标签：javascript, javascript-events, jquery

我已经疯了，试图弄清楚如何使这项工作。代码大致如下：

```
function onDropDownChanged() {
  $("#updatePanel").load(
    "myUrl",
    { id: $("#myDropDown option:selected").val() },
    onPanelLoaded
  );
}
function onPanelLoaded() {
  $("#theTextInput").focus();
}
$(document).ready(function() {
  $("#myDropDown").change(onDropDownChanged);
} 
```

第一次触发更改处理程序时，它执行 ajax 更新，并且文本框获得焦点。

但是，在随后的更改中，它会继续进行 ajax 更新，但文本框永远不会再次聚焦。

我发现如果在ajax 调用之前`onDropDownChanged`添加，文本框将始终获得焦点。`$("#updatePanel").empty()`问题是整个表格消失了一秒钟，导致丑陋的闪光。鉴于 ajax 应该让这样的事情变得很好，这不是我想要使用的解决方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T02:29:37.470

看起来它应该可以工作，但我想知道调用回调时 DOM 是否没有更新。您可能想看看引入延迟是否有帮助。

```
function onPanelLoaded() {
     setTimeout( function() { $("#theTextInput").focus(); }, 500 );
} 
```

如果这不起作用，包括页面上的 HTML 以及通过 load() 返回的内容会很有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-30T01:14:36.173

我在 IE6 和 IE7 上遇到了类似的问题，但`setTimeout()`不是一个可靠的解决方案。有时它有效，有时它没有。它在某些机器上根本不起作用，而且 500ms 值无论如何都是完全任意的。当然，该`focus()`功能在 Firefox 和 Chrome 中完全按预期工作，没有任何超时。

我的解决方案是为 IE调用`focus()` *两次：*

```
function onPanelLoaded() {
    var panel = $('#theTextInput');
    panel.focus();
    panel.focus();
} 
```

现在，这就是我最初想要的。

# silverlight - 在 Silverlight 中使用 Web 客户端

> ID：766574
> 
> 赞同：2
> 
> 时间：2009-04-20T01:05:15.007
> 
> 标签：silverlight

我从 silverlight 中调用 RESTful 服务有一段很长的时间。我遇到了这个错误：

```
{System.Security.SecurityException ---> System.Security.SecurityException: Security error.
   at System.Net.BrowserHttpWebRequest.InternalEndGetResponse(IAsyncResult asyncResult)
   at System.Net.BrowserHttpWebRequest.<>c__DisplayClass5.<EndGetResponse>b__4(Object sendState)
   at System.Net.AsyncHelper.<>c__DisplayClass2.<BeginOnUI>b__0(Object sendState)
   --- End of inner exception stack trace ---
   at System.Net.AsyncHelper.BeginOnUI(SendOrPostCallback beginMethod, Object state)
   at System.Net.BrowserHttpWebRequest.EndGetResponse(IAsyncResult asyncResult)
   at System.Net.WebClient.GetWebResponse(WebRequest request, IAsyncResult result)
   at System.Net.WebClient.OpenReadAsyncCallback(IAsyncResult result)} 
```

使用 webclient 时，这似乎是一个流行的错误。我已经制定了一个 clientaccesspolicy.xml

```
<?xml version="1.0" encoding="utf-8" ?> 
  <access-policy>
    <cross-domain-access>
      <policy>
        <allow-from http-request-headers="*">
           <domain uri="*" /> 
        </allow-from>
        <grant-to>
          <resource path="/" include-subpaths="true" /> 
        </grant-to>
     </policy>
   </cross-domain-access>
  </access-policy> 
```

我已经在 fiddler 中看到了 silverlight，它确实向网站发出了请求，并且确实得到了 200 状态。

```
public void login(string userName, string password)
        {
            WebClient client = new WebClient();
            Uri uri = new Uri(serverURI + "/clientaccesspolicy.xml");
            client.OpenReadCompleted += new OpenReadCompletedEventHandler(login_Complete);
            client.OpenReadAsync(uri);
        }

        private void login_Complete(object sender, OpenReadCompletedEventArgs e)
        {
            byte[] buffer = new byte[e.Result.Length]; //crashes here with exception
            ...
        } 
```

我或多或少没有想法。有人知道我在做什么错吗？直接从 file:// uri 运行 silverlight 有问题吗？

**更新：** 我删除了 clientaccesspolicy.xml 文件，只保留了 crossdomain.xml 文件，宾果游戏一切正常。这让我相信错误在 clientaccesspolicy 文件中，但我直接从[microsoft](http://msdn.microsoft.com/en-us/library/cc197955(VS.95).aspx)复制了它。是什么赋予了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T21:55:29.423

我只花了 3 个小时研究这个问题。跨域访问策略和客户端访问策略文件对我来说是一条死胡同。什么都行不通。最后，我在 Silverlight.net 论坛上遇到了一位微软员工的帖子，帮助我解决了这个问题。

至少在我的情况下，答案是 Visual Studio 在您创建新的 Silverlight 应用程序时生成的测试网页。

基本上，当您启动 Silverlight 项目时，您有两个选择。第一个选项将在您运行应用程序时动态生成一个 html 页面。第二个选项将创建一个单独的 ASP.NET 项目来承载您的 Silverlight 应用程序。如果您选择第一个选项（动态测试页面），您将无法执行任何跨域请求，即使您的两个项目都在同一个盒子上，它也会以某种方式认为这是一个跨域调用并失败（我不知道为什么)

创建另一个 Silverlight 项目，选择第二个选项，然后将 XAML 文件移入。这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T01:56:10.640

如果您的 Silverlight 应用程序从 file:// URL 运行，则您不能从网站请求内容。

有关详细信息，请参阅[Silverlight 中的 URL 访问限制](http://msdn.microsoft.com/en-us/library/cc189008(VS.95).aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T18:40:37.153

嗯……

试试这个跨域文件

```
<?xml version="1.0" encoding="utf-8" ?>
<access-policy>
    <cross-domain-access>
        <policy>
            <allow-from http-request-headers="SOAPAction" >
                <domain uri="*"/>
            </allow-from>
            <grant-to>
                <resource include-subpaths="true" path="/"/>
            </grant-to>
        </policy>
    </cross-domain-access>
</access-policy> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-07T15:52:56.183

X-Cubed 是正确的，您不能从 file:// 进行跨域请求，正如 Adam Berent 指出的那样，这意味着如果您使用 Visual Studio 生成的 TestPage，您的网络请求将失败。

一种解决方法是使用 Chiron（通常用于动态语言）启动 TestPage 以提供服务（因为访问是在 http:// 上）或关闭开发 Web 服务器。

问题是您实际上必须手动将调试器附加到浏览器才能通过网络进行调试（您不能只按 F5。）

# java - 注释主要是关于记录代码还是由编译器强制执行？

> ID：766576
> 
> 赞同：2
> 
> 时间：2009-04-20T01:08:09.897
> 
> 标签：java, annotations

```
@Deprecated public class Betamax { ... } 
```

在上面的例子中，@Deprecated 有什么作用？它是纯粹的文档吗？或者它是否改变了编译器如何处理这个类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T01:52:04.847

编译器强制执行（如检查和 croaks on）一些注释（如`@Override`）。

但最有用的部分是库可以提供自己的注解（如`@Entity`或`@PersistenceAware`），Java 语言（JDK 核心）对此一无所知。这有点像在语言中添加特定领域的语法糖。

`@Deprecated`用于文档。当您使用不推荐使用的方法（或类）时，它还会创建编译器警告，就像旧的 JavaDoc`@deprecated`标记一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T01:58:28.623

纯粹出于文档目的。

如果您将某些内容标记为已弃用，那么您通过生成的 Javadoc 向用户指示不应使用此方法/类，例如

> 日期（整数年，整数月，整数日期）：已弃用。从 JDK 版本 1.1 开始，由 Calendar.set(year + 1900, month, date) 或 GregorianCalendar(year + 1900, month, date) 取代。

如果您将某些内容标记为已弃用，最好向用户说明他们应该使用什么来代替此方法。

# iphone - iPhone开发：有哪些数据结构可用？

> ID：766581
> 
> 赞同：8
> 
> 时间：2009-04-20T01:09:23.593
> 
> 标签：iphone, objective-c, cocoa, data-structures

这是一个非常新手的问题，但 iPhone API 是否提供任何数据结构可以使用（即链表、哈希映射等）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-20T01:56:39.047

您可以通过 iPhone SDK 使用在 C 或 C++ 上实现的**任何数据结构。**

例如，我经常使用[标准库](http://en.cppreference.com/w/cpp)。

除此之外，您还可以使用 Cocoa 的复杂数据结构，例如：

1.  NSArray
2.  NSDictionary（哈希）
3.  NSSet（集合）

[您可以在此处](http://developer.apple.com/documentation/cocoa/conceptual/collections/index.html)获得有关它们的配套文件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-15T19:46:44.993

Cocoa（Mac 和 iOS 上都可用的框架）实现[了几种常见的集合类型](http://developer.apple.com/documentation/Cocoa/Conceptual/Collections/)，包括`NSArray`、`NSDictionary`和`NSSet`，以及它们的可变变体。（Leopard 还引入了`NSPointerArray`, `NSHashMap`, 和`NSHashTable`, 一个数组/字典/集合，带有额外的选项（比如使用弱引用），这使得它们在垃圾收集环境中使用起来相当方便。但是，这些类目前在 iPhone 上不可用，并且目前没有什么意义，因为 iOS 不支持垃圾回收。）这些类非常快，适合在任何 Cocoa 应用程序中通用。

除了这些提供的结构之外，您还有多种选择：(1) 使用这些作为构建块创建更复杂的结构，(2) 利用现有的第三方代码，或 (3) 从头开始​​构建您自己的数据结构。

一种选择是[CHDataStructures.framework](http://cocoaheads.byu.edu/code/CHDataStructures)，这是我维护的一个开源 Objective-C 框架。它实现了其他几种常见的数据结构，例如堆栈/队列/双端队列、链表、排序集等。这些结构采用[NSCoding](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Protocols/NSCoding_Protocol)和[NSCopying](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Protocols/NSCopying_Protocol)（加上[10.5+](http://developer.apple.com/documentation/Cocoa/Reference/NSFastEnumeration_protocol/)上的 NSFastEnumeration），因此它们可以与本机 Objective-C 代码无缝协作。该项目还允许您构建一个静态库以在 iPhone 上使用。由于此框架是开源的，如果需要，您甚至可以直接在项目中仅包含相关代码。

虽然您**可以**使用 C++ 和 STL 结构，但我发现混合使用 Objective-C 和 C++ 往往会更加混乱并导致令人烦恼的错误，尤其是对于新手而言。这不是对 C++ 的抨击，只是“在罗马时”的原则。在使用 C++ 时，STL 当然是首选方法。如果您已经在使用 C++，那么您可能对它感到满意，因此 STL 可能是一个不错的选择；即便如此，我发现使用原生 Cocoa 集合会产生更不言而喻、可读性更强的代码。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-04-20T02:19:50.053

Objective-C 语言不提供任何固有的数据结构，如链表等。但是，由于它基于 C/C++ 代码库，任何可以用 C 或 C++ 实现的东西都可以直接在 Objective-C 中完成，包括链表和其他数据结构。

# iphone - iPhone：随机“每日形象”类型的服务？

> ID：766587
> 
> 赞同：0
> 
> 时间：2009-04-20T01:56:43.853
> 
> 标签：iphone, xml, image, rss, random

iPhone 让从网络上抓取图片变得非常简单；您可以将 URL 转换为`UIImage`一行代码。所以我想让我的应用程序（一个教育益智游戏......我的第一个！）下载一些随机图像，使其更有趣和动态。

我考虑过使用[柯达当天的](http://feeds2.feedburner.com/KodakPictureOfTheDay)RSS 提要图像，但我花了很多时间弄清楚如何解析它。它似乎不是一个简单的图像 URL 列表，而是引用了一堆“jhtml” URL，这些 URL 运行 Javascript 以在您的 RSS 阅读器中显示图像。这是故意混淆的，还是我错过了解析这个的一些基本步骤？

我还通过[这个](http://feed://www.acme.com/jef/apod/rss.xml)RSS 提要尝试了[每日天文图片](http://antwrp.gsfc.nasa.gov/apod/)，但它只是原始页面的 HTML 填充到 CDATA 中......呃。

所以我想这真的是两个问题：

1.  有没有一种简单的方法来解析这些提要以实际获取 iPhone 上的 JPG URL？
2.  是否有更好的“每日图片”类型图像来源？

PS：我正在使用 NSXMLParser，我在[这里](http://codesofa.com/blog/archive/2008/07/23/make-nsxmlparser-your-friend.html)学会了使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T02:12:35.220

我建议使用具有 API 的东西，也许是 Flickr “Interestingness” 提要：

[http://www.flickr.com/services/api/flickr.interestingness.getList.html](http://www.flickr.com/services/api/flickr.interestingness.getList.html)

编写了一个 Objective-C 库来帮助访问 Flickr，但不确定是否包含此 API 调用：

[http://github.com/lukhnos/objectiveflickr/tree/master](http://github.com/lukhnos/objectiveflickr/tree/master)

# java - 数字格式中的空字符串

> ID：766590
> 
> 赞同：0
> 
> 时间：2009-04-20T01:58:45.547
> 
> 标签：java, arrays, file-io, casting

[这](http://img99.imageshack.us/img99/1398/assignment.jpg)是我的任务：

以下是我的问题：

1.  我该如何解决这个错误：

> 线程“主”java.lang.NumberFormatException 中的异常：extracredit.Main.readData 处 java.lang.Double.parseDouble(Double.java:527) 处 sun.misc.FloatingDecimal.readJavaFormatString(FloatingDecimal.java:1012) 处的空字符串(Main.java:72) 在 extracredit.Main.main(Main.java:27)

2.  这个程序还有其他问题吗？

到目前为止，这是我的代码：

```
 import java.io.*;
            import javax.swing.JOptionPane;
            import java.util.*;
            import java.util.StringTokenizer;

            public class Main {
     public static void main(String[] args) throws IOException {
     String fname = "data.txt"; //Read in the data file for use in the array
     String pass= JOptionPane.showInputDialog("Please enter the " +
             "password to continue:"); /*Have the user enter the password to 
     access the file. */

     checkPass(pass); // Verify that the password is correct before continuing.
     readData (fname); // Read data, print output and save output file.

  }

    private static void checkPass (String pass)
    {
     String password= "INF260";
     int passCount= 0;   
       if (pass.equals(password)) {
         System.out.println("The password is correct. Continuing...");
       }
       else {
        do {
           pass= JOptionPane.showInputDialog("Please re-enter the" +
                   "password:");
           passCount++;
        } while (!pass.equals(password) && passCount < 2);
           if (!pass.equals(password)) {
            System.out.println("You have tried to enter the " +
                   "password too many times. Exiting...");
            System.exit(0);
           }
           else {
               System.out.println("The password is correct. Continuing...");
           }
       }
    }
       public static void readData (String data) throws IOException{           
            FileReader inputData= new FileReader (data);
            BufferedReader findNum= new BufferedReader (inputData);
            String str= findNum.readLine ();

            int count=-1;
            int countNum= 0; 
            double total= 0;
            double min= 0;
            double max= 0;
            double average= 0;

            FileWriter writeFile = new FileWriter("sales.txt");
            PrintWriter printFile = new PrintWriter(writeFile);

            while (str != null)
             {
             double num= Double.parseDouble (str);
             if (count == 0){
               countNum++; // counter of Reciepts to use
              }
            str = findNum.readLine();
        }
           double [][] input = new double [countNum][10];
            total= getCurrentTotal(input); /*This will get the total 
             from the method getCurrentTotal.*/
            min= getCurrentMin(input); /*This will get the minimum value from
            the method getCurrentMin.*/
            max= getCurrentMax (input);  /*This will get the maximum value from
            the method getCurrentMax.*/

            average= (total / countNum);   //Calculate the average.     
            System.out.println("The List of Today's Sales:");
                for (int row = 0; row < input.length; row++){
                    System.out.println ();
                    System.out.println("Customer " + row + "\t");
                    for (int column = 0; column < input[row].length; column++){
                       if (input [row].length < 10){        
                        System.out.println(input[row][column] + "\t");
                        str = findNum.readLine();
                    }              
                    else{ 
                        System.out.println ("There are too many receipts" +
                                " for one Customer.\n");
                        System.exit (0);
                    }
                }

            }

    System.out.println ("There are " + countNum + "receipts in the list."); 
        /*This will print the total of receipts in the list.*/                      
    System.out.println ("The total of today's sales is $" + total); /*
        This will print the total of the sales for the day.*/
    System.out.println ("The average of today's sales is $" + average); /*  
        This will print the average sale total.*/
    System.out.println ("The highest receipt is $" + max); /* This will print 
         the highest sale.*/
    System.out.println ("The lowest receipt is $" + min); /* This will print 
        the lowest sale.*/
    Date date = new Date();
        System.out.println ("\n The current time is:" + date.toString()); /* This 
         will print the current date and time */

       }

    public static double getCurrentTotal (double [][] input){
        double totalAmount = 0;
        for (int row = 0; row < input.length; row++){
            for (int column = 0; column < input [row].length; column++){
                totalAmount += input [row][column];
            }
        }
        return totalAmount;    
    }

    public static double getCurrentMin (double [][] input) {    
        double currentMin = input[0][0]; 
        for (int row = 0; row < input.length; row++){
            for (int column = 0; column < input [row].length; column++){
                if (currentMin > input[row][column])
                    currentMin = input[row][column];
                }    
        }
        return currentMin;
    }

    public static double getCurrentMax (double [][] input){    
        double currentMax = input[0][0];
        for (int row = 0; row < input.length; row++){
            for (int column = 0; column < input [row].length; column++){
                if (currentMax < input[row][column]){
                    currentMax = input[row][column];
                }
            }    
        }
        return currentMax;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T02:32:35.217

最好的解决方案是：

*   学习你的课程材料
*   从问题的一个子集开始，比如读取文件。
*   测试一下
*   循环：
    *   继续改进和增强程序，直到它满足所有要求。
    *   测试一下
*   交上去

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T02:42:56.800

```
// from your main method
String fname = "data.txt";
readData (fname);

// the method being called
public static void readData (String data[][]){           
   BufferedReader br = new BufferedReader(new FileReader(data)); 
```

我们这里有一个不兼容的地方。

*   fname 是一个字符串
*   该方法将 String[] 作为参数。
*   构造函数 newFileReader() 接受一个字符串，而不是二维数组。

所有这三个应该是相同的数据类型。

> 如何将每个“收据”与零分开（如上面的图片链接所示）？

你不必。您必须从该文件中读取零。
我建议你编写一个类似这样的方法：

public double[] readOneReceipt(BufferedReader reader);

这种方法应该

*   逐行读取，直到遇到 0 条目
*   对于它读取的每个条目，将值转换为数字（双精度？）
*   将号码存储在临时结构中。
*   当您遇到“0”时，创建一个正确大小的新数组并将读取的值复制到其中。

> 如何将输出写入单独的文件？

使用 java.io.FileWriter

The hardest bit of this IMO is the fact that you are told to store the data in a 2d array, but you don't exactly what size to make the array until you've read the data. Which means that you either use a temporary dynamic structure, or read the file twice - once to find out how many receipts there are so that you can make the array, and then again to actually read the receipt data.

# performance - 在VB6中计时功能/测量性能的最佳方法是什么？

> ID：766596
> 
> 赞同：4
> 
> 时间：2009-04-20T02:03:22.107
> 
> 标签：performance, optimization, vb6

如果我只想快速测量特定功能需要多长时间，我可以调用什么来获得准确的时间？鉴于 VB6 计时函数的精度不高，是否有您调用的 Windows API 函数？

您还以哪些其他方式衡量应用程序性能？有没有推荐的第三方工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T02:09:42.120

我通常使用 Windows 高分辨率性能计数器。查看[QueryPerformanceCounter](http://msdn.microsoft.com/en-us/library/ms644904(VS.85).aspx)和[QueryPerfomanceFrequency](http://msdn.microsoft.com/en-us/library/ms644905(VS.85).aspx)

通常，我有一个简单的类，它的构造函数和析构函数调用 QueryPerformanceCounter，然后将差值添加到运行总计中。

有关工具，请查看[devpartner](http://www.compuware.com/products/devpartner/default.htm)。虽然它运行良好，但检测大量代码会使我的应用程序运行缓慢。我通常发现我希望只对一两个函数进行精确计时，因此我经常最终使用性能计数器函数而不是使用 devpartner。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T15:14:58.303

我使用高性能多媒体计时器。这是调试分析库的片段。

```
Private Declare Function timeGetTime Lib "winmm.dll" () As Long
Private Declare Function timeBeginPeriod Lib "winmm.dll" (ByVal uPeriod As Long) As Long
Private Declare Function timeEndPeriod Lib "winmm.dll" (ByVal uPeriod As Long) As Long

Private mlTimeStarted As Long

Public Sub StartTimer(Optional lPeriod As Long = 1)
10        Call timeBeginPeriod(lPeriod)
20        mlTimeStarted = timeGetTime()
End Sub

Public Function GetTimeElapsed() As Long
10        GetTimeElapsed = timeGetTime() - mlTimeStarted
End Function

Public Sub EndTimer(Optional lPeriod As Long = 1)
    Debug.Assert lPeriod < 10
10        Call timeEndPeriod(lPeriod)
20        mlTimeStarted = 0
End Sub

Public Sub DebugProfileStop()
10        Call EndTimer
End Sub

Public Sub DebugProfileReset()

10        If mlTimeStarted > 0 Then
20            EndTimer
30        End If
40        Call StartTimer

End Sub

Public Sub DebugProfile(sText As String)
10        Debug.Print "Debug " & sText & " : " & CStr(GetTimeElapsed)
End Sub 
```

用法：

```
 DebugProfileReset
   DebugProfile("Before Loop")
   For index = 0 to 10000
       DebugProfile("Before Call To Foo")
       Foo
       DebugProfile("Before Call To Bar")
       Bar
       DebugProfile("Before Call To Baz")
       Baz
   Next index
   DebugProfile("After Loop")
   DebugProfileStop 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T03:38:05.433

[VB Watch](http://www.aivosto.com/vbwatch.html)是您可能要考虑的另一个工具。

当您可以隔离代码的可疑区域时，这些东西是最通用的。这种类型的许多工具允许您将代码检测的覆盖范围限制为模块或单个过程，或者将监视限制在过程而不是语句级别。这可以帮助减少与整个程序的逐行检测相关的一些痛苦。

# javascript - 在 JavaScript (jQuery) 中为模板使用 HTML 片段

> ID：766597
> 
> 赞同：5
> 
> 时间：2009-04-20T02:03:27.113
> 
> 标签：javascript, jquery, html

我目前正在开发一个从我的服务器请求用户信息并使用特殊模板显示它们的小应用程序。

起初，我只是在 jQuery 中硬编码了这个小片段：

```
 $("<li><div class='outer'><table><tr><td rowspan=2 class='imgcontainer'><img class='thumb'/></td><td><span class='username'/></td></tr><tr><td><span class='name'/></td></tr></table></div></li>") 
```

我克隆了好几次。

它很难看，我希望它具有语法突出显示和诸如此类的功能，因此将它包含在 HTML 文件本身中会更好。

此外，它将使合并更容易，因此有人可以更改一两行。

有这种模式吗？我可以将它放入包含此 JS 的 HTML 文件中（只有一个），并使用 CSS 将其隐藏。

我想到的第三个选项是创建一个单独的 HTML 文件，并从服务器发出 jQuery 请求以使其保持独立。这种技术用的多吗？

另外，有什么术语可以用来描述我在做什么吗？（对于我不知道名称的概念提出问题更难）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T02:25:22.677

[我今天早些时候在 SO](https://stackoverflow.com/questions/765963/creating-a-menu-from-the-server-side/766092#766092)上给出了类似的答案。您正在寻找的是所谓的微模板。John Resig[在他的博客上发布了这个](http://ejohn.org/blog/javascript-micro-templating/)。本质上，您可以获取 json 数据集并将模板应用于数据以创建 html 并更新 DOM。

# jquery - dojo、原型和jquery

> ID：766599
> 
> 赞同：5
> 
> 时间：2009-04-20T02:04:34.473
> 
> 标签：jquery, dojo, prototypejs, aptana

我已经用 PHP 编程有一段时间了，我想开始学习如何使用 AJAX 创建更多动态网站。

问题是——我从哪里开始？这是我正在考虑的：

*   原型 + script.aculo.us
*   dojo（有/没有 Zend 框架）
*   jQuery

我应该买什么书？这些不同的库，还是相同的？另外，我应该使用什么 IDE？（我在 OSX 上）。阿普塔纳？科莫多？我目前正在使用 Zend Studio，是否有更多所见即所得的编辑器？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T02:11:37.047

它们是不同的，但本质上或多或少做相同的事情......抽象出浏览器的不一致，添加额外的有用功能等......

我会选择 jQuery，因为它似乎是使用最广泛的并且接近*标准库*。如果有帮助的话，微软和诺基亚已经采用了它。

Visual Studio 有 jQuery 的智能感知，但我不能评论它，因为我不是 .net 开发人员。否则我的 IDE 只是 Mac 的 Coda，它没有 jQuery 智能感知，但只需点击几下即可获得文档。

jQuery的[在线文档](http://docs.jquery.com)非常好，但我知道那里有一些书。我没有读过，所以我不能推荐。[这似乎是一个有用的入门网站。](http://learningjquery.com)

如果您只使用 AJAX（不是动画或任何其他功能），您可能想尝试仅使用 AJAX 的库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T05:52:47.713

其他一些 SO 主题解决了同样的问题：

*   [哪个 Javascript 框架（jQuery vs Dojo vs ...）？](https://stackoverflow.com/questions/394601/which-javascript-framework-jquery-vs-dojo-vs)
*   [我应该选择什么？jQuery、MooTools、YUI、script.aculo.us 还是 Prototype？](https://stackoverflow.com/questions/798840/what-should-i-choose-jquery-mootools-yui-scriptaculous-or-prototype)
*   [为什么每个人都喜欢 jQuery 而不是 Prototype/script.aculo.us 或 MooTools 之类的？](https://stackoverflow.com/questions/176324/why-does-everyone-like-jquery-more-than-prototype-script-aclo-us-or-mootools-or-w)

我对此[的看法如下](https://stackoverflow.com/questions/798840/what-should-i-choose-jquery-mootools-yui-scriptaculous-or-prototype/799035#799035)：

> 说真的，没有人能告诉你哪个框架最适合你。只有一种方法可以找出答案：尝试使用您正在考虑的所有不同库。这是个人喜好的问题。
> 
> 请参阅这个出色的[JavaScript 库概述](http://www.slideshare.net/jeresig/javascript-library-overview-presentation)，John Resig（他恰好是 jQuery 的首席开发人员）的演示文稿。它包含所有列出的框架的小代码示例。在查看了这些之后，您可能会知道选择哪个框架，具体取决于您喜欢哪种编码风格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T00:49:44.560

我不想引发一场激烈的战争，但我会完全避免使用 Prototype 和 MooTools，尽管两者都有好处。（披露：我使用的第一个 Ajax 库是 Prototype。）一些非常聪明和深思熟虑的程序员在使用做出不安全假设的库时遇到了大麻烦。一个明显的不安全假设是某些变量不会被其他脚本定义。（我想到的例子是一个媒体网站，它集成了许多不同的 3rd 方脚本。）许多库，尤其是 Prototype 的最大罪行是假设修改像 Array（或 Object！ ）。当我将原型添加到我的项目时，*噗*我的 for-each 循环遍历数组，因为突然间它们都有十几个额外的函数，每个函数都被认为是一个成员（对象只是散列）。

我和其他人一样喜欢面向对象的语法，但是修改核心对象根本不安全。[$是邪恶的。:-)](http://knol.google.com/k/glen-ford/is-evil-javascript-library-integration/27lm3zg1hrg7v/5#)

所以对我来说，YUI 是唯一真正安全的图书馆。jQuery 将是我的第二选择。

# python - mod_wsgi 强制重新加载模块

> ID：766601
> 
> 赞同：15
> 
> 时间：2009-04-20T02:04:53.303
> 
> 标签：python, module, mod-wsgi, reload

有没有办法让 mod_wsgi 在每次加载时重新加载所有模块（可能在特定目录中）？

在处理代码时，每次更改时重新启动 apache 非常烦人。到目前为止我发现的唯一选择是放在`modname = reload(modname)`每个导入下面.. 但这也很烦人，因为这意味着我将不得不在以后将它们全部删除..

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-24T11:59:02.080

链接：

[http://code.google.com/p/modwsgi/wiki/ReloadingSourceCode](http://code.google.com/p/modwsgi/wiki/ReloadingSourceCode)

应该强调。还应该强调的是，在 UNIX 系统上必须使用 mod_wsgi 的守护程序模式，并且您必须实现文档中描述的代码监视器。整个进程重新加载选项不适用于 UNIX 系统上 mod_wsgi 的嵌入式模式。尽管在 Windows 系统上唯一的选择是嵌入式模式，但通过从代码监控脚本触发 Apache 的内部重新启动，可以通过一些技巧来做同样的事情。这也在文档中进行了描述。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-05-27T03:52:03.343

以下解决方案仅针对 Linux 用户，并且已经过测试可在 Ubuntu Server 12.04.1 下运行

要在守护程序模式下运行 WSGI，您需要在 Apache 配置文件中指定`WSGIProcessGroup`和`WSGIDaemonProcess`指令，例如

```
WSGIProcessGroup my_wsgi_process
WSGIDaemonProcess my_wsgi_process threads=15 
```

[http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives](http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives)中提供了更多详细信息

如果您在同一台服务器下运行多个 WSGI 站点，则额外的好处是额外的稳定性，可能使用 VirtualHost 指令。在不使用守护进程的情况下，我发现两个 Django 站点相互冲突，并且交替出现 500 内部服务器错误。

此时，您的服务器实际上已经在监视您的 WSGI 站点的更改，尽管它只监视您使用 指定的文件`WSGIScriptAlias`，例如

```
WSGIScriptAlias / /var/www/my_django_site/my_django_site/wsgi.py 
```

这意味着您可以通过更改 WSGI 脚本来强制 WSGI 守护进程重新加载。当然，您不必更改其内容，而是，

```
$ touch /var/www/my_django_site/my_django_site/wsgi.py 
```

会成功的。

通过使用上述方法，您可以在生产环境中自动重新加载 WSGI 站点，而无需重新启动/重新加载整个 Apache 服务器，或修改您的 WSGI 脚本来进行生产不安全的代码更改监控。

当您有自动部署脚本并且不想在部署时重新启动 Apache 服务器时，这特别有用。

在开发过程中，您可以使用文件系统更改观察程序`touch wsgi.py`在您站点下的模块每次更改时调用，例如，[pywatch](https://github.com/cmheisel/pywatch)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-20T02:50:17.093

[关于代码重新加载](http://code.google.com/p/modwsgi/wiki/ReloadingSourceCode)的 mod_wsgi文档是您最好的答案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-08-23T07:31:25.803

我知道这是一个旧线程，但这可能会对某人有所帮助。要在写入某个目录中的任何文件时终止您的进程，您可以使用以下内容：

# 监视器.py

```
import os, sys, time, signal, threading, atexit
import inotify.adapters

def _monitor(path):

    i = inotify.adapters.InotifyTree(path)

    print "monitoring", path
    while 1:
        for event in i.event_gen():
            if event is not None:
                (header, type_names, watch_path, filename) = event
                if 'IN_CLOSE_WRITE' in type_names:
                    prefix = 'monitor (pid=%d):' % os.getpid()
                    print "%s %s/%s changed," % (prefix, path, filename), 'restarting!'
                    os.kill(os.getpid(), signal.SIGKILL)

def start(path):

    t = threading.Thread(target = _monitor, args = (path,))
    t.setDaemon(True)
    t.start()

    print 'Started change monitor. (pid=%d)' % os.getpid() 
```

在您的服务器启动中，将其称为：

# 服务器.py

```
import monitor

monitor.start(<directory which contains your wsgi files>) 
```

如果您的主服务器文件位于包含所有文件的目录中，您可以像这样：

```
monitor.start(os.path.dirname(__file__)) 
```

添加其他文件夹留作练习......

你需要'pip install inotify'

这是从这里的代码抄录而来的：[https ://code.google.com/archive/p/modwsgi/wikis/ReloadingSourceCode.wiki#Restarting_Daemon_Processes](https://code.google.com/archive/p/modwsgi/wikis/ReloadingSourceCode.wiki#Restarting_Daemon_Processes)

这是我在这里重复的问题的答案：[WSGI process reload modules](https://stackoverflow.com/questions/33845985/wsgi-process-reload-modules)

# c++ - 你可以在 C++ 中嵌入 for 循环（相互）吗

> ID：766605
> 
> 赞同：2
> 
> 时间：2009-04-20T02:07:46.383
> 
> 标签：c++, pointers, vector, loops, iterator

我正在研究合并排序功能。我得到了排序 - 我正在尝试完成我的合并部分。假设我正在学习 C++，对指针有粗略的了解，并且不了解 std::vector::iterator（或 std::vector，就此而言）的所有规则。

假设 num 是从大小为“int ar[num]”的数组复制 (std::copy) 值的原始 std::vector 的大小。假设 fray 的值是 (0 到 (num / 2))，sarray 的值是 ((num / 2) 到 num)。

```
int num = original.size();
std::vector<int> final(num);

for (std::vector<int>::iterator it = farray.begin(); it != farray.end(); ++it) {
     for (std::vector<int>::iterator iter = sarray.begin(); iter != sarray.end(); ++iter) {
         if (*it > *iter) final.push_back(*it);
          else
               final.push_back(*iter);
     }
} 
```

这段代码可以编译，我最新的 Bloodshed Dev-C++ 稳定版本不会引发任何警告或错误。我不知道这是否有效，我仍然需要尝试找出 final 的所有值。我只想知道这是否常见，容易出错，或者只是风格不好。如果是这样，你会如何

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T02:18:46.717

它是有效的......但 for 循环可能不是你想要的。当您使用两个 for 循环时，每次外循环循环时，您的内循环都会不断回到起点。因此，如果您的向量包含：

```
farray: 10 9 8 4 3
sarray: 7 6 4 3 1 
```

然后你的最终数组将包含如下内容：

```
10 10 10 10 10 9 9 9 9 9 8 8 8 8 8 7 6 4 4 4 7 6 4 3 3 
```

因为您正在测试每一个组合，并将较大的组合添加到最终列表中。更好的解决方案可能是为每个列表记住一个迭代器，并且只使用一个循环。与其遍历一个列表，不如一起遍历它们——如果 sarray 有更大的数字，那么增加你的 sarray 迭代器，并将它与旧的 farray 迭代器进行比较。当 sarray 和 farray 都为空时停止循环。

```
vector<int> fiter = farray.begin();
vector<int> siter = sarray.begin();
vector<int> final;

// Let's traverse both farray and sarray.
// We'll want to stop this loop once we've traversed both lists.
while (fiter != farray.end() && siter != sarray.end())
{
    if (fiter == farray.end())
    {
        // we must have gone right through farray - 
        // so use the value from sarray, and go to the next one
        final.push_back(*siter);
        siter++;
    }
    else if (siter == sarray.end())
    {
        // we must have gone right through sarray - 
        // so use the value from farray, and go to the next one
        final.push_back(*fiter);
        fiter++;
    }
    else if (*siter > *fiter)
    {
        // siter is the bigger of the two - add it to the final list, and
        // go to the next sarray entry
        final.push_back(*siter);
        siter++;
    }
    else // *fiter >= *siter
    {
        // fiter is the bigger of the two - add it to the final list, and
        // go to the next farray entry
        final.push_back(*fiter);
        fiter++;
    }
} 
```

我还没有测试过——如果这是为了家庭作业，那么*请*试着理解我做了什么，走开自己写，而不是复制+粘贴。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T02:14:29.397

*除了合并排序算法之外，带有迭代器的嵌套 for 循环与带有两个变量i*和*j*的嵌套 for 循环一样有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T02:11:48.387

只要不重用循环变量，就可以嵌套任何类型的循环（for、while、do while）。如果您尝试它会编译，但在运行时可能会失败。尽管技术上允许在现代 C 和 C++ 中对嵌套循环变量使用相同的名称，但它会造成混淆，应该避免使用。

除了已经提到的循环变量重用问题之外，它不会比单个循环更容易出错。

阅读更多关于嵌套循环的[限制](https://stackoverflow.com/questions/764307/what-limits-the-number-of-nested-loops-in-c)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T02:48:51.403

嵌套 for 循环是一种完全合法的做事方式。例如，这是遍历 2D 数组的经典“老派”方式——一个循环沿着 y 轴，另一个循环沿着 x 轴。

如今，对于这些孩子和他们的 for each 循环、迭代器和映射函数，可以说有*“更好”*的方法来做到这一点，（对于更好的一些定义）但嵌套循环工作得很好。使用 C++ 或指针不会改变这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T02:14:15.667

是的，你可以这样做。是的，它经常容易出错。事实上，编写循环本身就容易出错，这是在 STL 中使用 for_each、copy 和 transform 等算法的一个论据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T02:15:39.597

是的，您可以将循环或其他语句嵌套到几乎任何您想要的深度（在合理范围内；有限制，如另一个答案中所述，但它们远高于您应该需要的）。

# ms-access - Access 的自动编号（增量）是否保证增加？

> ID：766607
> 
> 赞同：1
> 
> 时间：2009-04-20T02:08:07.147
> 
> 标签：ms-access, auto-increment, autonumber

对于特定表，我将 ID 字段设置为自动编号（增量）。如果我快速连续向该表添加 5 行，是否保证每行的 ID 都比上一个大？例如，如果一些较早的值已被删除，自动编号是否会从 1 重新开始？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T02:31:01.650

我唯一遇到过 Access 自动编号问题的情况是，我错误地使用附加查询将自动编号键字段的值设置为低于当前最大值的数字。记录删除在编号中造成了空白。Access 允许您将一个值强制输入自动编号字段，有时（并非总是如此，我不知道为什么）自动编号​​会重置为较小的数字。最终，随着记录的添加，我遇到了“重复键”错误。除此之外，我多年来从未遇到过麻烦。

这个问题有几个关于增量值的答案。据我所知，Access自动编号字段只能设置为'Increment'（1）或'Random'，并且没有设置除1以外的数字增量。如果我对此有误，请指教我。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T02:40:51.093

可悲的是，即使是微软的应用程序也不是万无一失的。但这就是它的工作方式，我还没有看到它失败。也没有听说过它没有故意或偶然的颠覆。

不过，不要指望它对每个整数值都有一行。除了删除的行之外，它还会用完失败的追加操作的数字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T01:53:03.853

语句“如果删除了一些记录并且压缩了数据库，则下一个身份将重置为使用的最低数字 + 1”是不正确的。这发生在 Access 97 中使用的 Jet 3.5 中，但在 Access 2000 中使用的 Jet 4.0 中没有。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-22T10:13:15.857

David W. Fenton 写道：“Jet Autonumber 字段不是身份字段。它只是一个具有特殊默认值的长整数字段。该默认值可以是 INCREMENT 或 RANDOM，但由于它只是一个默认值，因此您可以只要不违反索引，就将任何长整数值附加到该字段。”

这有点困惑。ACE/Jet SQL 语法有一个`IDENTITY`关键字 ( `COUNTER`, `AUTOINCREMENT`) 但没有 AUTONUMBER 关键字。显然 ACE/Jet`IDENTITY`是`IDENTITY`!

但我想在这里解决的问题（评论太长）是关于它是“只有一个具有特殊默认值的长整数字段”的错误陈述。

考虑这个 ACE/Jet SQL DDL（ANSI-92 查询模式语法）：

```
CREATE TABLE Test2_IDENTITY
(
   ID_identity_1 IDENTITY NOT NULL, 
   ID_identity_2 IDENTITY NOT NULL, 
   data_column INTEGER
); 
```

执行时，它会失败并显示消息“结果表不允许有多个自动编号字段”。很明显，这里发生的不仅仅是“特殊默认值”。

关键字是使用`IDENTITY`递增算法创建一个自动编号（因为需要更好的术语）来生成值。`IDENTITY`不能用于使用随机算法或自动编号的 GUID（复制 ID）风格创建自动编号。对于这些其他情况，您确实需要使用“特殊默认值”，例如

```
CREATE TABLE TestAutonumbers 
(
   ID_identity IDENTITY NOT NULL, 
   ID_random INTEGER DEFAULT GenUniqueID() NOT NULL, 
   ID_guid UNIQUEIDENTIFIER DEFAULT GenGUID() NOT NULL, 
   data_col INTEGER
); 
```

如果您使用诸如 ADOX 之类的技术来检查该表的属性（信息模式），您会发现只有使用 IDENTITY 关键字创建的列的 Autoincrement 属性设置为 true，并且该列的 COLUMN_HASDFAULT 为 false，COLUMN_DEFAULT 为 null。因此，如果 IDENTITY 列确实具有“特殊默认值”，那么引擎不会告诉您。

不同`IDENTITY`的是，对于这些其他风格的自动编号，每个表都没有明确的限制，例如这很好用：

```
CREATE TABLE Test2_Autonumbers
(
   ID_random_1 INTEGER DEFAULT GenUniqueID() NOT NULL, 
   ID_random_2 INTEGER DEFAULT GenUniqueID() NOT NULL, 
   ID_guid_1 UNIQUEIDENTIFIER DEFAULT GenGUID() NOT NULL, 
   ID_guid_2 UNIQUEIDENTIFIER DEFAULT GenGUID() NOT NULL, 
   data_col INTEGER
); 
```

我不知道是否存在与使用和不使用关键字（或其同义词）创建自动增量列等效的“特殊`GenUniqueID()`默认值” `GenGUID()`。如果有人知道其中一种方法，请告诉我。`DEFAULT``IDENTITY`

顺便说一句，上述错误消息表明我对“自动编号”作为访问术语是错误的。似乎在 ACE/Jet 引擎级别“自动编号”是（即自动增量风格自动编号）的非关键字同义词，`IDENTITY`但不是其他自动编号风格的同义词。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T08:14:30.327

首先，您的`IDENTITY`(Autonumber in Access) 列必须是`INTEGER`(Long Integer in Access) 而不是`UNIQUEIDENTIFIER`(Replication ID in Access)，必须使用增量算法而不是随机算法来生成新值并分别假设您的种子和增量值都是默认值 1，那么如果您删除表中的所有行并压缩数据库，则该`IDENITTY`列应重新设置为 1。如果不是，则您可能需要安装 Jet 服务包（[http:// support.microsoft.com/kb/287756](http://support.microsoft.com/kb/287756)）。

请注意，当 (Long Integer in Access) 的最大正值`INTEGER`被下一个自动生成的值超过时，它将“换行”到负`INTEGER`范围内，并将继续在正负范围之间循环，生成重复值，其中必要的（除非该列另外被唯一约束覆盖）。实际上，如果增量值足够大，您可以保证这些值将在大于和小于先前自动生成的值之间交替，例如（ACE/Jet ANSI-92 查询模式语法）：

```
CREATE TABLE Test 
(
   ID INTEGER IDENTITY (0, 2147483647), 
   data_col INTEGER NOT NULL UNIQUE
)
;
INSERT INTO Test (data_col) VALUES (1)
;
INSERT INTO Test (data_col) VALUES (2)
;
INSERT INTO Test (data_col) VALUES (3)
;
INSERT INTO Test (data_col) VALUES (4)
;
INSERT INTO Test (data_col) VALUES (5)
;
INSERT INTO Test (data_col) VALUES (6)
;
INSERT INTO Test (data_col) VALUES (7)
;
INSERT INTO Test (data_col) VALUES (8)
; 
```

自动生成的值为 0、2147483647、-2、2147483645、-4、2147483643、-6、2147483641 等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T12:14:15.303

我有一个以前在复制数据库中使用的表。有些自动编号是负数，有些非常大。这对于复制表来说是正常的，因此您不能确定自动编号是否会大于先前的数字，它可能是负数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-20T20:36:06.703

Jet Autonumber 字段不是身份字段。它只是一个具有特殊默认值的长整数字段。该默认值可以是 INCREMENT 或 RANDOM，但由于它只是一个默认值，您可以将任何长整数值附加到该字段，只要它不违反索引。

递增的自动编号永远不会恢复为 1，除非您已删除所有记录并进行了压缩，或者在种子值损坏的情况下。后者在 Jet 4 的早期版本（Service Pack 6 之前）中经常发生，其中种子值会被重置，这会导致各种问题，包括损坏的 PK 索引。幸运的是，这个问题最终得到了解决，而且因为 Jet 是一个 Windows 组件，所以几乎没有任何计算机会比 Jet 4 service pack 8 少。

正如 onedaywhen 所说，如果递增的自动编号超过长整数的最大正值，您可以获得负值，但这向我表明您的表中可能有足够的记录，您需要不同的数据库引擎，或者您不正确将您的表视为临时表（即追加和删除大量记录）。

正如其他人所说，唯一性不是由自动编号数据类型控制，而是由索引控制。如果您创建了非唯一索引，则可以附加重复值。我无法想象你为什么想要一个具有重复值的自动编号字段，但关键是如果你不添加唯一索引，你可以做到这一点。由于大部分 Autonumber 字段都用作代理主键，因此它们将具有唯一的 PK 索引，并且数据表将按 PK 顺序（聚集）写入。关于唯一性，如果您使用自动编号作为代理 PK，并且表中有任何应该唯一的自然键（并且*可以*是唯一的，即不允许 Null），则您还应该在自然键字段（单个字段或复合索引）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-12-19T13:03:42.390

我的答案是 3 串 VBA 代码！

```
Set db = CurrentDb
Set tbl = db.TableDefs("your_tbl")
Set current_index = tbl.Indexes.Item("PrimaryKey").DistinctCount 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-20T15:24:34.473

如果删除了一些记录并且压缩了数据库，则下一个标识将重置为使用的最低数字 + 1 - 如果表被清空，则在压缩后下一个标识将设置回 1。

# asp.net-mvc - 如何让 ELMAH 与 ASP.NET MVC [HandleError] 属性一起使用？

> ID：766610
> 
> 赞同：570
> 
> 时间：2009-04-20T02:09:11.140
> 
> 标签：asp.net-mvc, logging, elmah

我正在尝试使用 ELMAH 在我的 ASP.NET MVC 应用程序中记录错误，但是当我在控制器上使用 [HandleError] 属性时，ELMAH 在发生错误时不会记录任何错误。

正如我猜测的那样，因为 ELMAH 只记录未处理的错误，而 [HandleError] 属性正在处理错误，因此无需记录它。

我如何修改或如何修改属性，以便 ELMAH 可以知道存在错误并记录它..

**编辑：**让我确保每个人都明白，我知道我可以修改属性，这不是我要问的问题......使用 handleerror 属性时，ELMAH 被绕过，这意味着它不会看到有错误，因为它已被处理已经由属性...我要问的是有没有办法让 ELMAH 看到错误并记录它，即使属性处理了它...我四处搜索，没有看到任何方法可以调用来强制它记录错误....

* * *

## 回答 #1

> 赞同：508
> 
> 时间：2009-04-23T01:28:36.377

您可以子类化[`HandleErrorAttribute`](http://msdn.microsoft.com/en-us/library/system.web.mvc.handleerrorattribute.aspx)并覆盖其[`OnException`](http://msdn.microsoft.com/en-us/library/system.web.mvc.handleerrorattribute.onexception.aspx)成员（无需复制），以便它使用 ELMAH 记录异常，并且仅当基本实现处理它时。您需要的最少代码如下：

```
using System.Web.Mvc;
using Elmah;

public class HandleErrorAttribute : System.Web.Mvc.HandleErrorAttribute
{
    public override void OnException(ExceptionContext context)
    {
        base.OnException(context);
        if (!context.ExceptionHandled) 
            return;
        var httpContext = context.HttpContext.ApplicationInstance.Context;
        var signal = ErrorSignal.FromContext(httpContext);
        signal.Raise(context.Exception, httpContext);
    }
} 
```

首先调用基本实现，使其有机会将异常标记为正在处理。只有这样才会发出异常信号。`HttpContext`上面的代码很简单，如果在测试等可能不可用的环境中使用，可能会导致问题。因此，您将需要更具防御性的代码（以稍长一些为代价）：

```
using System.Web;
using System.Web.Mvc;
using Elmah;

public class HandleErrorAttribute : System.Web.Mvc.HandleErrorAttribute
{
    public override void OnException(ExceptionContext context)
    {
        base.OnException(context);
        if (!context.ExceptionHandled       // if unhandled, will be logged anyhow
            || TryRaiseErrorSignal(context) // prefer signaling, if possible
            || IsFiltered(context))         // filtered?
            return;

        LogException(context);
    }

    private static bool TryRaiseErrorSignal(ExceptionContext context)
    {
        var httpContext = GetHttpContextImpl(context.HttpContext);
        if (httpContext == null)
            return false;
        var signal = ErrorSignal.FromContext(httpContext);
        if (signal == null)
            return false;
        signal.Raise(context.Exception, httpContext);
        return true;
    }

    private static bool IsFiltered(ExceptionContext context)
    {
        var config = context.HttpContext.GetSection("elmah/errorFilter")
                        as ErrorFilterConfiguration;

        if (config == null)
            return false;

        var testContext = new ErrorFilterModule.AssertionHelperContext(
                              context.Exception, 
                              GetHttpContextImpl(context.HttpContext));
        return config.Assertion.Test(testContext);
    }

    private static void LogException(ExceptionContext context)
    {
        var httpContext = GetHttpContextImpl(context.HttpContext);
        var error = new Error(context.Exception, httpContext);
        ErrorLog.GetDefault(httpContext).Log(error);
    }

    private static HttpContext GetHttpContextImpl(HttpContextBase context)
    {
        return context.ApplicationInstance.Context;
    }
} 
```

第二个版本将首先尝试使用来自 ELMAH 的[错误信号](http://code.google.com/p/elmah/wiki/DotNetSlackersArticle#Error_Signaling)，这涉及到完全配置的管道，如日志记录、邮件、过滤和你有什么。如果做不到这一点，它会尝试查看是否应该过滤错误。如果不是，则简单地记录错误。此实现不处理邮件通知。如果可以发出异常信号，则如果配置为发送邮件，则会发送邮件。

您可能还必须注意，如果多个`HandleErrorAttribute`实例生效，则不会发生重复日志记录，但上述两个示例应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：303
> 
> 时间：2011-05-09T12:27:32.847

抱歉，但我认为接受的答案是矫枉过正。您需要做的就是：

```
public class ElmahHandledErrorLoggerFilter : IExceptionFilter
{
    public void OnException (ExceptionContext context)
    {
        // Log only handled exceptions, because all other will be caught by ELMAH anyway.
        if (context.ExceptionHandled)
            ErrorSignal.FromCurrentContext().Raise(context.Exception);
    }
} 
```

然后在 Global.asax.cs 中注册它（顺序很重要）：

```
public static void RegisterGlobalFilters (GlobalFilterCollection filters)
{
    filters.Add(new ElmahHandledErrorLoggerFilter());
    filters.Add(new HandleErrorAttribute());
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-01-24T18:10:41.373

NuGet 中现在有一个 ELMAH.MVC 包，其中包括 Atif 改进的解决方案以及处理 MVC 路由中的 elmah 接口的控制器（不再需要使用该 axd）
该解决方案的问题（以及此处的所有问题） ) 是 elmah 错误处理程序实际处理错误的一种或另一种方式，而忽略了您可能希望设置为 customError 标记或通过 ErrorHandler 或您自己的错误处理程序设置的内容
恕我直言，最好的解决方案是创建一个过滤器，它将在所有其他过滤器的末尾起作用并记录已经处理的事件。elmah 模块应该负责记录应用程序未处理的其他错误。这也将允许您使用运行状况监视器和可以添加到 asp.net 的所有其他模块来查看错误事件

我用反射器在 elmah.mvc 中的 ErrorHandler 上写了这个

```
public class ElmahMVCErrorFilter : IExceptionFilter
{
   private static ErrorFilterConfiguration _config;

   public void OnException(ExceptionContext context)
   {
       if (context.ExceptionHandled) //The unhandled ones will be picked by the elmah module
       {
           var e = context.Exception;
           var context2 = context.HttpContext.ApplicationInstance.Context;
           //TODO: Add additional variables to context.HttpContext.Request.ServerVariables for both handled and unhandled exceptions
           if ((context2 == null) || (!_RaiseErrorSignal(e, context2) && !_IsFiltered(e, context2)))
           {
            _LogException(e, context2);
           }
       }
   }

   private static bool _IsFiltered(System.Exception e, System.Web.HttpContext context)
   {
       if (_config == null)
       {
           _config = (context.GetSection("elmah/errorFilter") as ErrorFilterConfiguration) ?? new ErrorFilterConfiguration();
       }
       var context2 = new ErrorFilterModule.AssertionHelperContext((System.Exception)e, context);
       return _config.Assertion.Test(context2);
   }

   private static void _LogException(System.Exception e, System.Web.HttpContext context)
   {
       ErrorLog.GetDefault((System.Web.HttpContext)context).Log(new Elmah.Error((System.Exception)e, (System.Web.HttpContext)context));
   }

   private static bool _RaiseErrorSignal(System.Exception e, System.Web.HttpContext context)
   {
       var signal = ErrorSignal.FromContext((System.Web.HttpContext)context);
       if (signal == null)
       {
           return false;
       }
       signal.Raise((System.Exception)e, (System.Web.HttpContext)context);
       return true;
   }
} 
```

现在，在您的过滤器配置中，您想要执行以下操作：

```
 public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        //These filters should go at the end of the pipeline, add all error handlers before
        filters.Add(new ElmahMVCErrorFilter());
    } 
```

请注意，我在那里留下了一条评论以提醒人们，如果他们想要添加一个将实际处理异常的全局过滤器，它应该在最后一个过滤器之前进行，否则您会遇到 ElmahMVCErrorFilter 忽略未处理异常的情况，因为它还没有被处理，它应该由 Elmah 模块记录，但是下一个过滤器将异常标记为已处理并且模块忽略它，导致异常永远不会进入 elmah。

现在，确保你的 webconfig 中 elmah 的 appsettings 看起来像这样：

```
<add key="elmah.mvc.disableHandler" value="false" /> <!-- This handles elmah controller pages, if disabled elmah pages will not work -->
<add key="elmah.mvc.disableHandleErrorFilter" value="true" /> <!-- This uses the default filter for elmah, set to disabled to use our own -->
<add key="elmah.mvc.requiresAuthentication" value="false" /> <!-- Manages authentication for elmah pages -->
<add key="elmah.mvc.allowedRoles" value="*" /> <!-- Manages authentication for elmah pages -->
<add key="elmah.mvc.route" value="errortracking" /> <!-- Base route for elmah pages --> 
```

这里重要的是“elmah.mvc.disableHandleErrorFilter”，如果这是 false，它将使用 elmah.mvc 中的处理程序，该处理程序将通过使用默认的 HandleErrorHandler 来实际处理异常，该处理程序将忽略您的 customError 设置

此设置允许您在类和视图中设置自己的 ErrorHandler 标签，同时仍通过 ElmahMVCErrorFilter 记录这些错误，通过 elmah 模块将 customError 配置添加到 web.config，甚至编写自己的错误处理程序。您唯一需要做的就是记住不要在我们编写的 elmah 过滤器之前添加任何实际处理错误的过滤器。我忘了提：elmah 中没有重复项。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-07-28T00:19:15.273

您可以通过引入将 HandleErrorWithElmah 属性注入每个控制器的自定义控制器工厂来更进一步地执行上面的代码。

有关更多信息，请查看我关于登录 MVC 的博客系列。第一篇文章介绍了如何为 MVC 设置和运行 Elmah。

文末有可下载代码的链接。希望有帮助。

[http://dotnetdarren.wordpress.com/](http://dotnetdarren.wordpress.com/)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-04-20T01:40:02.977

我是 ASP.NET MVC 的新手。我遇到了同样的问题，以下是我在 Erorr.vbhtml 中可行的（如果您只需要使用 Elmah 日志记录错误，它就可以工作）

```
@ModelType System.Web.Mvc.HandleErrorInfo

    @Code
        ViewData("Title") = "Error"
        Dim item As HandleErrorInfo = CType(Model, HandleErrorInfo)
        //To log error with Elmah
        Elmah.ErrorLog.GetDefault(HttpContext.Current).Log(New Elmah.Error(Model.Exception, HttpContext.Current))
    End Code

<h2>
    Sorry, an error occurred while processing your request.<br />

    @item.ActionName<br />
    @item.ControllerName<br />
    @item.Exception.Message
</h2> 
```

简直了！

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-08-01T07:32:20.520

一个完全替代的解决方案是不使用 MVC `HandleErrorAttribute`，而是依靠 Elmah 设计的 ASP.Net 错误处理。

您需要`HandleErrorAttribute`从 App_Start\FilterConfig（或 Global.asax）中删除默认全局，然后在您的 Web.config 中设置错误页面：

```
<customErrors mode="RemoteOnly" defaultRedirect="~/error/" /> 
```

注意，这可以是一个 MVC 路由 URL，所以上面的内容会`ErrorController.Index`在发生错误时重定向到操作。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-01-26T09:11:26.723

对我来说，让电子邮件记录正常工作非常重要。一段时间后，我发现在 Atif 示例中只需要多两行代码。

```
public class HandleErrorWithElmahAttribute : HandleErrorAttribute
{
    static ElmahMVCMailModule error_mail_log = new ElmahMVCMailModule();

    public override void OnException(ExceptionContext context)
    {
        error_mail_log.Init(HttpContext.Current.ApplicationInstance);
        [...]
    }
    [...]
} 
```

我希望这会对某人有所帮助:)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-11-06T22:35:52.310

这正是我的 MVC 站点配置所需要的！

`OnException`根据 Atif Aziz 的建议，我对处理多个`HandleErrorAttribute`实例的方法进行了一些修改：

> 请记住，您可能必须注意，如果多个`HandleErrorAttribute`实例有效，则不会发生重复日志记录。

我只是`context.ExceptionHandled`在调用基类之前检查，只是想知道其他人是否在当前处理程序之前处理了异常。
它对我有用，我发布代码以防其他人需要它，并询问是否有人知道我是否忽略了任何东西。

希望有用：

```
public override void OnException(ExceptionContext context)
{
    bool exceptionHandledByPreviousHandler = context.ExceptionHandled;

    base.OnException(context);

    Exception e = context.Exception;
    if (exceptionHandledByPreviousHandler
        || !context.ExceptionHandled  // if unhandled, will be logged anyhow
        || RaiseErrorSignal(e)        // prefer signaling, if possible
        || IsFiltered(context))       // filtered?
        return;

    LogException(e);
} 
```

# java - Javabat 子串计数

> ID：766611
> 
> 赞同：1
> 
> 时间：2009-04-20T02:09:30.170
> 
> 标签：java, substring

```
public boolean catDog(String str)
{
   int count = 0;

   for (int i = 0; i < str.length(); i++)
   {
      String sub = str.substring(i, i+1);

      if (sub.equals("cat") && sub.equals("dog"))
         count++;
   }

   return count == 0;
} 
```

有我的 catDog 代码，已经研究了一段时间，但无法找出问题所在。帮助将不胜感激！*/

**编辑**- 如果字符串“cat”和“dog”在给定字符串中出现的次数相同，我想返回 true。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T02:14:59.910

一个问题是这永远不会是真的：

```
if (sub.equals("cat") && sub.equals("dog")) 
```

&& 表示和。|| 意味着或。

但是，另一个问题是您的代码看起来像是在随机地试图让它工作。每个人在他们的第一个编程课上都会在某种程度上这样做，但这是一个坏习惯。在编写任何代码之前，试着在脑海中想出一个如何解决问题的清晰图景，然后编写代码，然后验证代码确实做了你认为它应该做的事情，并且你的初始解决方案是正确的。

编辑：既然你已经澄清了你的功能应该做什么，我所说的就会加倍。您解决问题的方法不正确，因此您需要重新考虑如何解决问题，而不是与实施无关。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T03:35:07.393

这是一个批评，因为我不相信为家庭作业提供代码。但是你至少尝试过哪个比大多数在这里发布作业的小丑更好。

*   您需要两个变量，一个用于存储猫的出现，一个用于存储狗，或者一种区分差异的方法。
*   您的子字符串没有获得足够的字符。
*   一个字符串*不可能*既是猫又是狗，你需要独立检查它们并更新正确的计数。
*   如果 catcount 等于 dogcount，则您的 return 语句应该返回 true，尽管如果您存储了猫和狗之间的差异，您的版本将起作用。

除此之外，我会使用字符串搜索而不是检查*每个*位置，但这可能是你的下一个任务。您选择的方法完全适合 CS101 类型的作业。

如果您解决了我上面给出的几点，那么让您的工作应该相当容易。您可能想尝试的一件事是在代码中的重要位置插入调试语句，例如：

```
System.out.println(
    "i = " + Integer.toString (i) +
    ", sub = ["+sub+"]" +
    ", count = " + Integer.toString(count)); 
```

紧接在`for`循环的右大括号之前。这对于找出您的代码做错了什么非常宝贵。

这是我的 ROT13 版本，如果您遇到太多麻烦并想要与它进行比较，但请不要在没有先使用它的情况下使用它。从长远来看，这对您没有帮助。而且，几乎可以肯定，您的教育工作者正在跟踪 StackOverflow 以检测抄袭，因此它在短期内甚至不会帮助您。

并不是我真正关心，就业池中的愚蠢编码员越多，对我来说就越好:-)

```
choyvp obbyrna pngQbt(Fgevat fge) {
    vag qvssrerapr = 0;
    sbe (vag v = 0; v < fge.yratgu() - 2; v++) {
        Fgevat fho = fge.fhofgevat(v, v+3);
        vs (fho.rdhnyf("png")) {
            qvssrerapr++;
        } ryfr {
            vs (fho.rdhnyf("qbt")) {
                qvssrerapr--;
            }
        }
    }
    erghea qvssrerapr == 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T07:36:24.067

我这样做的代码：

```
public boolean catDog(String str) {

    if ((new StringTokenizer(str, "cat")).countTokens() ==
        (new StringTokenizer(str, "dog")).countTokens()) {

        return true;
    }
    return false;
} 
```

希望对你有帮助

**编辑：**抱歉，此代码将不起作用，因为您的字符串中可以并排放置 2 个标记。最好使用[StringUtils](http://commons.apache.org/lang/api-release/org/apache/commons/lang/StringUtils.html) Apache commons library 中的[countMatches](http://commons.apache.org/lang/api-release/org/apache/commons/lang/StringUtils.html#countMatches(java.lang.String,%20java.lang.String))。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T03:39:28.787

这里要注意的另一件事是，Java 内置 String 类中的子字符串在上限上是独占的。

也就是说，对于 String str = "abcdefg"，str.substring(0, 2) 检索的是 "ab" 而不是 "abc"。要匹配 3 个字符，您需要获取从**i 到 i+3**的子字符串。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-20T02:16:55.317

```
String sub = str.substring(i, i+1); 
```

上面的行只得到一个 2 个字符的子字符串，所以不是得到“cat”，而是得到“ca”，它永远不会匹配。通过将“i+1”更改为“i+2”来解决此问题。

**编辑：**现在您已经在评论中澄清了您的问题：您应该有两个计数器变量，一个用于计算“狗”，一个用于计算“猫”。然后最后返回 true if `count_cats == count_dogs`。

# java - 哪种 Java 数据结构/解决方案最适合这些要求？

> ID：766622
> 
> 赞同：4
> 
> 时间：2009-04-20T02:14:45.587
> 
> 标签：java, data-structures, collections, concurrency

我需要一个满足这些要求的 java 数据结构/解决方案。什么最适合这些？

1）必须保持对象的插入顺序

2) 对象必须是唯一的（这些是由 UUID 唯一标识的数据库对象）。

3) 如果添加了具有相同 ID 的较新对象，则应覆盖/删除旧版本的对象

4）解决方案应该可以被许多线程访问。

5）当第一个添加到结构的对象被读取/使用时，它应该从数据结构中删除

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-20T02:34:03.357

这里有几种可能性。最简单的可能是从[LinkedHashSet](http://java.sun.com/j2se/1.5.0/docs/api/java/util/LinkedHashSet.html)开始。这将为您提供所需的唯一性和可预测的排序。然后，您可以包装结果集以使其成为线程安全的：

```
Set<T> s = Collections.synchronizedSet(new LinkedHashSet<T>(...)); 
```

注意：由于 Set 并没有真正定义从中检索项目的方法，因此您的代码必须手动调用 Set.remove(Object)。

或者，您可以包装一个[LinkedHashMap](http://java.sun.com/j2se/1.5.0/docs/api/java/util/LinkedHashMap.html)，它确实为您需要的读取时删除语义提供了一个钩子：

```
class DeleteOnReadMap<K, V> implements Map<K, V> {

    private Map<K, V> m = new LinkedHashMap<K, V>();

    // implement Map "read" methods Map with delete-on-read semantics
    public V get(K key) {
        // ...
    }
    // (other read methods here)

    // implement remaining Map methods by forwarding to inner Map
    public V put(K key, V value) {
        return m.put(key, value);
    }
    // (remaining Map methods here)
} 
```

最后，包装自定义 Map 的一个实例以使其成为线程安全的：

```
Map<K, V> m = Collections.synchronizedMap(new DeleteOnReadMap<K, V>(...)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T02:30:43.817

我的想法是这样的：

```
 Collections.synchronizedMap(new LinkedHashMap<K, V>()); 
```

我认为这可以解决除要求 5 之外的所有问题，但您可以使用`remove()`方法而不是`get()`.

这不会像以前那样有效`ConcurrentMap`- 同步会在每次访问时锁定整个地图，但我认为`ConncurrentMap`实现可以仅在地图的一部分上使用读写锁和选择性锁定，以允许进行多个非冲突访问同时开启。如果您愿意，您可能可以通过编写自己的某些现有`Map`实现的子类来获得更好的性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T02:58:00.633

> 1）必须保持对象的插入顺序

这是任何“正常”的数据结构——数组、arrayList、树。因此，请避免自平衡或自排序数据结构：堆、哈希表或移至前端树（例如，展开树）。再说一次，您*可以*使用其中一种结构，但随后您必须跟踪它在每个节点中的插入顺序。

> 2) 对象必须是唯一的（这些是由 UUID 唯一标识的数据库对象）。

保留与每个对象关联的唯一标识符。如果这是一个 C 程序，那么指向该节点的指针是唯一的（我想这也适用于 Java。）如果节点的指针不足以保持“唯一性”，那么您需要向每个节点添加一个字段你保证有一个独特的价值。

> 3) 如果添加了具有相同 ID 的较新对象，则应覆盖/删除旧版本的对象

你想把节点放在哪里？是否要*替换*现有节点？还是要删除旧节点，然后将新节点添加到末尾？这很重要，因为它与您的要求 #1 相关，其中必须保留插入顺序。

> 4）解决方案应该可以被许多线程访问。

我能想到的唯一方法是实现某种锁定。Java 允许您将结构和代码包装在一个`synchronized`块中。

> 5）当第一个添加到结构的对象被读取/使用时，它应该从数据结构中删除

有点像“出队”操作。

似乎 ArrayList 是一个很好的选择：仅仅因为#5。唯一的问题是搜索是线性的。但是，如果您的数据量相对较少，那么这并不是什么大问题。

否则，就像其他人所说的那样：HashMap 甚至某种树都可以工作——但这​​取决于访问的频率。（例如，如果“最近”元素最有可能被访问，我会使用线性结构。但如果访问是“随机”元素，我会使用 HashMap 或 Tree。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-21T11:25:30.437

讨论 LinkedHashSet 的解决方案将是一个很好的起点。

但是，您必须覆盖要放入集合中的对象上的 equals 和 hashcode 方法，以满足您的要求 3。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T02:22:10.033

听起来您必须创建自己的数据结构，但这听起来像是一个非常简单的课堂作业。

基本上，您可以从 Array 或 Stack 之类的任何东西开始，但随后您必须为其余功能扩展它。

您可以根据需要查看“包含”方法。

# c# - C# 中是否有更好的方法将 DateTime 舍入到最接近的 5 秒？

> ID：766626
> 
> 赞同：20
> 
> 时间：2009-04-20T02:16:21.777
> 
> 标签：c#, algorithm, datetime, performance

我想将 DateTime 舍入到最接近的 5 秒。这是我目前正在这样做的方式，但我想知道是否有更好或更简洁的方式？

```
DateTime now = DateTime.Now;
int second = 0;

// round to nearest 5 second mark
if (now.Second % 5 > 2.5)
{
    // round up
    second = now.Second + (5 - (now.Second % 5));
}
else
{
    // round down
    second = now.Second - (now.Second % 5);
}

DateTime rounded = new DateTime(now.Year, now.Month, now.Day, now.Hour, now.Minute, second); 
```

请注意，我已经找到了[这](https://stackoverflow.com/questions/152774/is-there-a-better-way-to-trim-a-datetime-to-a-specific-precision) [两个](https://stackoverflow.com/questions/166145/whats-the-best-way-to-round-a-net-date-object-to-the-nearest-minute-closed)先前的问题，但是它们会*截断*而不是*舍*入时间。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2010-11-05T18:26:55.950

（很抱歉复活；我知道这是一个古老且已回答的问题 - 只是为了 Google 的缘故添加了一些额外的代码。）

我从[JayMcClellan 的回答](https://stackoverflow.com/questions/766626/is-there-a-better-way-in-c-to-round-a-datetime-to-the-nearest-5-seconds/766652#766652)开始，但后来我希望它更通用，四舍五入到任意间隔（不仅仅是 5 秒）。因此，我最终将 Jay 的方法留给了`Math.Round`在刻度上使用的方法，并将其放入可以采用任意间隔的扩展方法中，并且还提供了更改舍入逻辑的选项（银行家的舍入与远离零的舍入）。我在这里发帖以防这对其他人也有帮助：

```
 public static TimeSpan Round(this TimeSpan time, TimeSpan roundingInterval, MidpointRounding roundingType) {
        return new TimeSpan(
            Convert.ToInt64(Math.Round(
                time.Ticks / (decimal)roundingInterval.Ticks,
                roundingType
            )) * roundingInterval.Ticks
        );
    }

    public static TimeSpan Round(this TimeSpan time, TimeSpan roundingInterval) {
        return Round(time, roundingInterval, MidpointRounding.ToEven);
    }

    public static DateTime Round(this DateTime datetime, TimeSpan roundingInterval) {
        return new DateTime((datetime - DateTime.MinValue).Round(roundingInterval).Ticks);
    } 
```

它不会因为简单的效率而赢得任何奖项，但我发现它易于阅读且使用直观。示例用法：

```
new DateTime(2010, 11, 4, 10, 28, 27).Round(TimeSpan.FromMinutes(1)); // rounds to 2010.11.04 10:28:00
new DateTime(2010, 11, 4, 13, 28, 27).Round(TimeSpan.FromDays(1)); // rounds to 2010.11.05 00:00
new TimeSpan(0, 2, 26).Round(TimeSpan.FromSeconds(5)); // rounds to 00:02:25
new TimeSpan(3, 34, 0).Round(TimeSpan.FromMinutes(37); // rounds to 03:42:00...for all your round-to-37-minute needs 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-04-20T02:27:54.603

DateTime 的 Ticks 计数表示 100 纳秒的间隔，因此您可以通过四舍五入到最接近的 50000000 滴答间隔来四舍五入到最接近的 5 秒，如下所示：

```
 DateTime now = DateTime.Now;
  DateTime rounded = new DateTime(((now.Ticks + 25000000) / 50000000) * 50000000); 
```

这更简洁，但不一定更好。这取决于您是否更喜欢简洁和速度而不是代码清晰。你的可以说更容易理解。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T02:24:44.720

就像你提到的，截断相当容易。因此，只需添加 2.5 秒，然后截断。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T02:31:36.890

我想不出更好的方法，尽管我可能会考虑使用圆形方法：

```
static int Round(int n, int r)
{
    if ((n % r) <= r / 2)
    {
        return n - (n % r); 
    }
    return n + (r - (n % r));
} 
```

此外，% 返回一个 int，因此将其与 2.5 进行比较让我觉得有点奇怪，即使它是正确的。我会使用> = 3。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T02:38:32.690

我无法识别 C# 和一块肥皂之间的区别（好吧，当我最初写这个答案时我无法识别，从那以后的几年里情况发生了很大变化）但是，如果你正在寻找更*简洁*的解决方案，我只是把整个东西放在一个函数中——在你的代码中没有什么比简单地调用所说的函数更简洁了：

```
DateTime rounded = roundTo5Secs (DateTime.Now); 
```

然后你可以在函数中放任何你想要的东西并记录它是如何工作的，例如（假设这些都是整数运算）：

```
secBase = now.Second / 5;
secExtra = now.Second % 5;
if (secExtra > 2) {
    return new DateTime(now.Year, now.Month, now.Day, now.Hour, now.Minute,
        secBase + 5);
}
return new DateTime(now.Year, now.Month, now.Day, now.Hour, now.Minute,
    secBase); 
```

如果 secBase 达到 60，您可能还需要一些额外的检查（除非 C# DateTime 对象足够聪明，可以提高分钟（如果分钟达到 60，则小时，等等）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T03:42:42.427

这个怎么样（将几个答案混合在一起）？我认为它很好地传达了含义，并且应该优雅地处理边缘情况（四舍五入到下一分钟），因为`AddSeconds`.

```
// truncate to multiple of 5
int second = 5 * (int) (now.Second / 5);
DateTime dt = new DateTime(..., second);

// round-up if necessary
if (now.Second % 5 > 2.5)
{
    dt = dt.AddSeconds(5);
} 
```

Jay 展示的`Ticks`方法更简洁，但可能不太可读。如果你使用这种方法，至少参考`TimeSpan.TicksPerSecond`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-22T19:00:43.637

从技术上讲，您永远无法正确舍入到仅给出几秒钟的奇数间隔。

2, 4, 6, 8, 10 <--没问题

如果您按间隔“分配”时间并且抖动很低，则截断更容易处理。

如果您可以通过毫秒并在 500mS 标记处舍入，您将能够达到奇数秒，并且还可以降低或完全消除抖动的影响。

# iphone - UIWebView - stringByEvaluatingJavaScriptFromString - 不改变文本框的值

> ID：766627
> 
> 赞同：4
> 
> 时间：2009-04-20T02:16:44.023
> 
> 标签：iphone

为什么这段代码不起作用？它显示 Google 屏幕，但不会更改文本框的值。我确认 JS 通过在 Safari 中运行它确实可以工作，并且这段代码似乎可以正常工作，因为运行 alert('hi') 确实有效。

```
NSURL *web_url = [NSURL URLWithString:@"http://www.google.com"];
NSURLRequest *web_request = [NSURLRequest requestWithURL:web_url];
[web_screen loadRequest:web_request];
NSString *js_result = [web_screen stringByEvaluatingJavaScriptFromString:@"document.getElementsByTagName('input')[1].value='test';"]; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-11-11T16:03:14.050

只是扩展上一个答案。您需要通过设置 UIWebView 的委托属性来遵守 UIWebViewDelegate 协议，如下所示：

```
 web_screen.delegate = self; 

```

然后，您可以实现其中一种委托方法，以了解请求何时完成加载并因此准备好让脚本运行，如下所示：

```
 - (void)webViewDidFinishLoad:(UIWebView *)webView {
  NSString *js_result = [webView stringByEvaluatingJavaScriptFromString:@"document.getElementsByTagName('input')[1].value='test';"];
 }

```

有关 UIWebViewDelegate 协议的更多信息，请访问 Apple 网站[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-08-02T07:32:16.237

加载 URL 操作异步发生。在您的方法结束之前，它甚至不会开始。所以你的 javascript 被推入一个空的 UIWebView，然后你的方法结束，然后加载发生。

你需要让你的方法在 js 被推入之前结束。标准的方法是使用一个 Delegate 对象，它会在加载完成时调用一个方法。只有这样，推送 javascript 才有意义。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-20T07:16:11.260

如果您先等待页面完成加载，它会起作用吗？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-20T07:50:41.257

考虑查看`NSURLConnection`及其委托方法。您可以使用这些来检查下载的状态。

```
@interface 
...
NSURLConnection *connectionInProgress;
NSData *googleRequestResponseData;
NSURL *googleURL;
...

@implementation
...
- (void) setUpRequest {
  googleURL = [[NSURL URLWithString:@"http://www.google.com/"] retain];
  googleRequestResponseData = [[NSMutableData data] retain];
  NSURLRequest *request = [NSURLRequest requestWithURL:url cachePolicy:NSURLRequestReturnCacheDataElseLoad timeoutInterval:30.0];
  connectionInProgress = [[NSURLConnection alloc] initWithRequest:request delegate:self startImmediately:YES];
}

#pragma mark NSURLConnection delegate methods

- (void) connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
   [googleRequestResponseData appendData:data];
}

- (void) connectionDidFinishLoading:(NSURLConnection *)connection {
   [web_screen loadData:googleRequestResponseData MIMEType:@"application/octet-stream" textEncodingName:@"utf-8" baseURL:googleURL];
   NSString *js_result = [web_screen stringByEvaluatingJavaScriptFromString:@"document.getElementsByTagName('input')[1].value='test';"];
   NSLog (js_result);

   [googleURL release];
   [googleRequestResponseData release];
   [connectionInProgress release];
   connectionInProgress = nil;
}

- (void) connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
   NSLog (@"Connection failed to load data from Google!");
   [googleURL release];
   [googleRequestResponseData release];
   [connectionInProgress release];
   connectionInProgress = nil;
} 
```

或者，查看 Ben Copsey 的[ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/)包装器，其中包括一种简化的异步下载方法（`ASINetworkQueue`具体请参见 参考资料）。

`ASINetworkQueue`一旦请求下载完成，您就可以使用运行您选择的方法（例如运行 Javascript 代码）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-09T13:38:40.643

在您搜索的内容之后添加“.innerHTML”
在您的情况下，请执行以下操作

```
- (void)webViewDidFinishLoad:(UIWebView *)webView {
  NSString *js_result = [webView stringByEvaluatingJavaScriptFromString:@"document.getElementsByTagName('input')[1].value='test'.innerHTML"];
 } 
```

这对我有用。

[在这里](https://stackoverflow.com/questions/4560576/uiwebview-stringbyevaluatingjavascriptfromstring)查看更多信息

# java - 我正在寻找不使用 Groovy 的 Java 过度冗长的解决方案

> ID：766629
> 
> 赞同：4
> 
> 时间：2009-04-20T02:17:01.667
> 
> 标签：java, groovy, verbosity

我喜欢 Groovy 如何使您的所有实例变量和类变量公开，并代表您编写 getter 和 setter。这节省了很多不必要的编码。另一方面，我的老板讨厌它，让我很伤心:(

有没有办法在 Java 中实现 Groovy 的简洁性，而无需使用 Groovy 或其他一些框架/附加组件？

我有一种感觉，当权者不会善待在我工作的地方引入这个外国框架。

因此，我正在寻找一种解决 Java 过于冗长的方法，而无需使用 Groovy 或类似的东西。

是否可以仅在 Java 中完成 - 例如通过简单地公开所有内容？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-20T02:25:43.457

Java 语言就是这样。如果不迁移到新语言（如 groovy），您不会发现太多可以更改核心语言。获得管理层的支持可能并不像你想象的那么难转向 groovy。几年前，我和你处于类似的位置。您可以开始将 groovy 引入软件的一些有意义的领域。

一个很好的起点是开始使用它进行单元测试。本质上，当您在 groovy 中编写一个类时，它会编译为 Java 字节码。只要您的类路径中有 groovy jar，其他人甚至可能不知道它是 groovy 代码。通过使用它进行测试，您可以演示它如何简化您的代码并使事情变得更容易。你应该可以把它卖给管理层。

从那里开始，继续在其他新领域引入它，动态语言可以为您节省一些工作。Groovy 和 Java 很好地结合在一起，因为它们使用相同的核心库集。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-20T02:27:14.653

在这种情况下，可以为您编写 getter 和 setter 的 IDE 可以成为您的朋友。

我发现必须编写 getter 和 setter 是编写新类中最重复和最无趣的部分。使用像[Eclipse](http://www.eclipse.org/)这样的 IDE ，它可以[自动为您生成 getter 和 setter](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/ref-dialog-gettersetter.htm)，它可以减少编写冗余代码的痛苦。

当然，它不会减轻使用`getX`and`setX`方法的需要，但至少它使类的实现更容易一些，负担更少。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T02:39:26.807

使用不可变的数据结构。没有吸气剂，没有二传手，没有麻烦。

您可能想尝试一下[函数式 Java](http://functionaljava.org)。它只是一个常规的 Java 库，但带有强大的抽象和有用的（不可变的）数据结构，可以让您用更少的代码说更多。例如，翻译这个：

```
List<String> s = new ArrayList<String>();
  for (String x : xs) {
    for (String y : ys) {
      for (String z : zs) {
        s.add(doSomething(x, y, z));
      }
    }
  } 
```

...对此：

```
List<String> s = xs.bind(ys, zs, doSomething); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T02:32:08.043

您可以使用 AOP 来帮助消除一些冗长的内容。

例如，如果您有一个属性：字符串名称；

然后您可以定义：@GetterSetter public String Name(String name) { };

然后有一个寻找注释的方面，并在其上放置一个周围，以便任何读取，即当参数为空或写入（参数不为空）时完成，然后它将采取适当的行动。

这将很容易编写，但是您必须获得 AOP 的支持，这可能具有挑战性。

但是，正如其他人提到的，Eclipse 和 Netbeans 将轻松创建 getter/setter，因此如果您不必对它们做任何特别的事情，那么它应该很容易。

我倾向于将我的属性放在他们自己的类中，这只是 getter/setter，然后我不必查看冗长性，以及如果需要的 equals 和 hash 方法，然后在我的其他类中我只使用它，并隐藏无聊的额外编码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T02:26:40.113

除了针对特定任务（JPA、Swing 等）的更有效框架之外，我不知道有什么可以使您的源代码更小。

这种功能通常来自您的 IDE。

我使用 Netbeans，它具有编写 getter/setter、自动实现抽象方法和各种其他快捷方式的工具。当然，源代码仍然很冗长。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T14:36:52.043

试试我的 bean 注释：[http ://code.google.com/p/javadude/wiki/Annotations](http://code.google.com/p/javadude/wiki/Annotations)

注释处理器为您生成一个超类，其中包含您通常必须编写的许多典型样板：

```
@Bean(
    properties={
        @Property(name="name", bound=true),
        @Property(name="age", type=int.class, bound=true)
    }
)
public class Person extends PersonGen {
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-26T23:09:28.550

通过使用特定领域的框架，您可以大大提高 Java 的有效抽象级别。例如，当您编写 RESTful Web 服务时，Restlet 会处理大部分无聊的细节。或者，如果您需要在 XML 或 JSON 之间映射 POJO，XStream 或 JAXB 等包会自动生成映射逻辑。为避免繁琐的 JDBC 编程，请尝试使用 iBatis 或 Hibernate 等持久性管理器。Freemarker 和 Velocity 等模板系统使生成标记变得更加容易。

即使在没有工具支持的情况下，您也经常可以找到将低级细节分解为通用方法和类的方法，以便您的顶级代码感觉更抽象。

（您可能会考虑询问您的老板，您是否可以评估 Groovy 作为您项目的支持角色，例如编写一些单元测试。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-16T19:03:29.163

You can label any property or method with any of the standard access modifiers or type declarations in Groovy.

Remember, Groovy is a superset of Java.

# python - 为什么不切换到 Python 3.x？

> ID：766636
> 
> 赞同：18
> 
> 时间：2009-04-20T02:21:12.827
> 
> 标签：python, deployment, python-3.x

我问这个是出于可部署的原因。例如，如果我用 python 编写解决方案，由于没有采用 python 3，我觉得一定要写到 2.x。这是我日常关心的主要问题，我想弄清楚发生了什么。

对于这里的许多基于 python 的问题，人们提供的解决方案**在 python 3.x 中根本不起作用**。

所以，我问一个问题：是什么阻止了你在个人或工作环境中切换到 python 3.x？转换脚本存在，但程序员（通常是所有事物的最早采用者）似乎拒绝升级。

为什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-20T02:28:15.337

**[编辑 03/10/2014：这个答案现在已经过时了。Django 支持 Python 3 已经有一段时间了。]**

**【不过也必须注意，很多Django项目中使用的django第三方包和扩展，都处于Python 3兼容性实现的各个阶段。可以在跟踪各种项目状态的[Django 包网站中找到更多详细信息。]](https://www.djangopackages.com/python3/)**

Django 尚未迁移到 3.0。这就是我需要知道的。

> ## 相关问题
> 
> *   [Python 3.0 的向后不兼容会影响采用吗？](https://stackoverflow.com/questions/340530/will-python-30s-backwards-incompatibility-affect-adoption)
> *   [当您想学习 Python 时，Python 3 是一个很好的起点吗？](https://stackoverflow.com/questions/352312/is-python-3-a-good-starting-point-when-you-want-to-learn-python)
> *   [如果我要学习 Python，我应该学习 2.x 还是直接跳到 3.0？](https://stackoverflow.com/questions/410609/if-im-going-to-learn-python-should-i-learn-2-x-or-just-jump-into-3-0)
> *   [谁在使用 Python 3.0？](https://stackoverflow.com/questions/533510/whos-using-python-3-0)
> *   [新手的 Python 版本](https://stackoverflow.com/questions/345255/python-version-for-a-newbie)
> *   [3.0 即将到来的 Python 2.6 值得学习吗？](https://stackoverflow.com/questions/282819/is-it-worth-learning-python-26-with-30-coming)

这些问题中的大多数答案都反映了相同的观点。除了 Django，太多的框架/库——WxPython、PyGame、Django 等——仍然没有采用它。我敢肯定，除非他们这样做，否则不会采取行动。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-20T02:28:48.783

因为我的代码库所依赖的主要库还没有发布 3.x 版本。（wxPython、matplotlib、numpy 等）

所以从我的角度来看，责任是上游。

如果我所有的依赖项都与 3.x 兼容，那么我现在可能已经切换了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-20T02:25:48.823

1.  编译的第 3 方模块尚未更新。
2.  不同的语法
3.  较慢的整数。
4.  freenode 上的#python IRC 频道在其标题中显示切换为时尚早。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-20T02:40:21.050

3rd 方工具和库。我无法让某些事情在 2.6 下工作（不是很多麻烦，请注意，但有些麻烦。）

在我看来，生态系统是 Python 的最大优势之一，而此时升级到 3.0 时，其中的很多东西都被抛在了脑后。（一年后，我相信故事会完全不同。）

（很明显，这里有先有鸡还是先有蛋的问题，不过幸好不是我要解决的问题，所以我还是在 2.6 待会儿吧。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-20T02:27:07.557

> 对于这里的许多基于 python 的问题，人们提供的解决方案在 python 3.x 中根本不起作用。

我想你在这里回答了你自己的问题。缺乏向后兼容性使得 3.0 比无缝升级更难销售，因为您必须调整思维并放弃一些编程技术才能使用新版本。

当他们有我的大脑升级脚本时给我回电话。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T10:51:39.667

如果您有兴趣迁移到 Py3k，一种有趣的方法是在 Py3k 中编写代码并使用 3to2 脚本，该脚本现在作为 Google Summer of code 项目的一部分在 2to3 脚本的行上编写。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-20T09:34:45.017

Because the default installation of 2.5 on Mac OSX Leopard works just fine. I have no need to upgrade and I see no advantage to upgrading except an end to the woes of unicode.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-20T12:11:37.417

我使用最多的操作系统 Debian 没有 Python 3 包，甚至在“不稳定”（全新）分支中也没有。除非我自己编译它（那是相当 20 世纪），否则它对我来说意味着没有 Python3。

我敢打赌，许多操作系统都存在同样的问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-11T07:58:12.377

不幸的是，出于与大多数其他人所说的相同的原因 - 3rd 方库仍然没有与 3.0 兼容。由于这个原因，以及一些 GNU/Linux 发行版（在我的例子中是 Ubuntu）仍然带有 Python 2.6，我还不能完全放弃 2.x。

但是，对 3.0 的更改并不是 IMO 的一项重大更改。除了“print”是一个函数和新的字符串格式化系统之外，它实际上或多或少与以前相同。

事实上，我发现我的大部分旧脚本（那些不依赖于 3.0 不兼容的 3rd 方库的脚本）在我更新所有打印和字符串格式后在 3.0 中可以完美运行。在某些情况下，我还必须更改一些模块名称（特别是“电子邮件”模块中的内容），但除此之外没什么大不了的。

此外，到目前为止，我为 3.x 兼容性更新的所有脚本在 2.6 中似乎仍然可以完美运行（但当然不是旧的 2.x，因为它们缺少新的 3.x 语法）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-07-06T01:40:34.563

我不切换的主要原因是很多书籍和编码挑战网站仍然是 2.x。我安装了 3.x 并很快意识到我必须卸载并转到 2.x。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-11T08:04:57.200

由于缺乏向后兼容性，切换很困难，尤其是在涉及 C 代码的情况下。虽然我知道 unicode/string 可能对某些人非常有用，但我自己当然不在乎。

基本上，Py3k 并没有解决我关心的许多问题（分发问题、模块版本控制、简化的导入模型）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-07-06T02:05:56.897

Python 3+ 不支持 numpy。 **更正：**现在可以了。因为它现在支持 mathplotlib。

# nhibernate - 来自同一表中的字段的 NHibernate 映射实体

> ID：766650
> 
> 赞同：1
> 
> 时间：2009-04-20T02:27:20.877
> 
> 标签：nhibernate

我有一个成员表，其中包含字段
MemID - 主键
Business_Name
Business_Address
Business_Phone

我需要创建一个具有来自同一个成员表的属性的雇主类。
EmployerName
EmployerAddress
EmployerPhone

这是我的雇主映射

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" auto-import="true">
<class name="Employer, Entities" lazy="true" table="Members" dynamic-update="true">
        <id name="MemberID" column="MemID" type="Int64">
            <generator class="native" />
        </id>
        <many-to-one name="EmployerAddress" column="Business_Address" class="Address, Entities" lazy="proxy" />
        <many-to-one name="EmployerPhone" column="Business_Phone" class="Phone, Entities" lazy="proxy"/>
        <property name="EmployerName" column="Business_Name" not-null="false" />
    </class>
</hibernate-mapping> 
```

我以为我可以像这样映射成员类，但我得到一个“System.Collections.Generic.KeyNotFoundException：给定的键不在字典中”。

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" auto-import="true">
<class name="Member, Entities" lazy="true" table="Members" dynamic-update="true">
<id name="MemberID" column="MemID" type="Int64">
<generator class="native" />
</id>
<one-to-one name="EmployerInformation" class="Employer, Entities"  lazy="false"/>
    </class>
</hibernate-mapping> 
```

也请注意。由于当前系统的限制，我无法将业务信息移动到另一个表。Business_Address 和 Business_Phone 是另一个表的 FK，这就是它们是多对一映射的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T02:35:07.660

我不确定这是否是您要查找的内容，但您可以尝试“组件”映射。这允许您在同一个表中拥有一个嵌套类。

在 google 中搜索“nhibernate 组件” - hibernate.org 站点似乎仍然关闭（！），但您可能能够从 google 缓存中获取页面“第 7 章 - 组件映射”的组件信息。

# wpf - 尝试读取或写入受保护的内存

> ID：766651
> 
> 赞同：1
> 
> 时间：2009-04-20T02:27:39.440
> 
> 标签：wpf, xaml

我正在尝试学习 WPF。我正在阅读一本书（24 小时内的 WPF），偶尔会出现以下错误：

尝试读取或写入受保护的内存。这通常表明其他内存已损坏。

当我单击“确定”时，应用程序继续运行，就好像没有任何问题一样。到目前为止，我只使用了 XAML，没有输入任何其他代码。到目前为止，我在 SO 和 google 中找到的示例参考了特定的代码问题。任何朝着正确方向的推动都会受到赞赏。

哦……我用的是VS2008 Pro

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T04:54:20.773

我在声明样式而不指定 TargetType 时遇到了这个问题。我不记得那是在 WPF 还是 Silverlight2 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-03T13:57:22.253

老问题，但万一它对某人有帮助……我在 Template10、MVVM UWP 应用程序的 XAML 文件中将此错误作为构建错误。
原因似乎是因为我引用了一个单独的 .dll 中的 ViewModel。
将引用的 ViewModel 移动到应用程序中，构建错误消失了。

# postgresql - 如何在简单的 PostgreSQL 脚本中使用变量？

> ID：766657
> 
> 赞同：125
> 
> 时间：2009-04-20T02:28:52.123
> 
> 标签：postgresql, variables

例如，在 MS-SQL 中，您可以打开一个查询窗口并运行以下命令：

```
DECLARE @List AS VARCHAR(8)

SELECT @List = 'foobar'

SELECT *
FROM   dbo.PubLists
WHERE  Name = @List 
```

这是如何在 PostgreSQL 中完成的？可以做到吗？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2011-08-09T00:08:59.863

完整答案位于[官方 PostgreSQL 文档](http://www.postgresql.org/docs/9.1/interactive/plpgsql-structure.html)中。

您可以使用新的 PG9.0 匿名代码块功能 ( [http://www.postgresql.org/docs/9.1/static/sql-do.html](http://www.postgresql.org/docs/9.1/static/sql-do.html) )

```
DO $$
DECLARE v_List TEXT;
BEGIN
  v_List := 'foobar' ;
  SELECT *
  FROM   dbo.PubLists
  WHERE  Name = v_List;
  -- ...
END $$; 
```

您还可以获得最后一个[插入](http://www.postgresql.org/docs/9.1/static/sql-insert.html)ID：

```
DO $$
DECLARE lastid bigint;
BEGIN
  INSERT INTO test (name) VALUES ('Test Name') 
  RETURNING id INTO lastid;

  SELECT * FROM test WHERE id = lastid;
END $$; 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2016-03-31T06:04:01.780

```
DO $$
DECLARE  
   a integer := 10;  
   b integer := 20;  
   c integer;  
BEGIN  
   c := a + b;
    RAISE NOTICE'Value of c: %', c;
END $$; 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2013-04-28T18:35:48.030

您可以使用：

```
\set list '''foobar'''
SELECT * FROM dbo.PubLists WHERE name = :list; 
```

那会做

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-12T13:30:46.890

这是在 plpgsql 中使用变量的示例：

```
create table test (id int);
insert into test values (1);
insert into test values (2);
insert into test values (3);

create function test_fn() returns int as $$
    declare val int := 2;
    begin
        return (SELECT id FROM test WHERE id = val);
    end;
$$ LANGUAGE plpgsql;

SELECT * FROM test_fn();
 test_fn 
---------
       2 
```

查看[plpgsql 文档](http://www.postgresql.org/docs/8.3/static/plpgsql.html)以获取更多信息。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-07-29T04:26:44.613

我遇到了一些其他文档，它们用于`\set`声明脚本变量，但该值似乎就像常量值，我正在寻找可以像变量而不是常量变量一样的方式。

前任：

```
\set Comm 150

select sal, sal+:Comm from emp 
```

这`sal`是表“emp”中存在的值，并且`comm`是常量值。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-08-22T11:07:36.573

例如在 alter table 中使用变量：

```
DO $$ 
DECLARE name_pk VARCHAR(200);
BEGIN
select constraint_name
from information_schema.table_constraints
where table_schema = 'schema_name'
      and table_name = 'table_name'
      and constraint_type = 'PRIMARY KEY' INTO name_pk;
IF (name_pk := '') THEN
EXECUTE 'ALTER TABLE schema_name.table_name DROP CONSTRAINT ' || name_pk; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-09-26T13:51:23.207

以@nad2000 的答案和@Pavel 的答案[为](https://stackoverflow.com/a/12333544/939860)基础，这就是我最终获得 Flyway 迁移脚本的地方。处理手动修改数据库架构的情况。

```
DO $$
BEGIN
    IF NOT EXISTS(
        SELECT TRUE FROM pg_attribute 
        WHERE attrelid = (
            SELECT c.oid
            FROM pg_class c
            JOIN pg_namespace n ON n.oid = c.relnamespace
            WHERE 
                n.nspname = CURRENT_SCHEMA() 
                AND c.relname = 'device_ip_lookups'
            )
        AND attname = 'active_date'
        AND NOT attisdropped
        AND attnum > 0
        )
    THEN
        RAISE NOTICE 'ADDING COLUMN';        
        ALTER TABLE device_ip_lookups
            ADD COLUMN active_date TIMESTAMP;
    ELSE
        RAISE NOTICE 'SKIPPING, COLUMN ALREADY EXISTS';
    END IF;
END $$; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-12-31T01:45:42.457

Postgresql 没有裸变量，您可以使用临时表。变量仅在代码块中或作为用户界面功能可用。

如果您需要一个裸变量，您可以使用一个临时表：

```
CREATE TEMP TABLE list AS VALUES ('foobar');

SELECT dbo.PubLists.*
FROM   dbo.PubLists,list
WHERE  Name = list.column1; 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-12-30T18:39:06.200

我不得不做这样的事情

```
CREATE OR REPLACE FUNCTION MYFUNC()
RETURNS VOID AS $$
DO
$do$
BEGIN
DECLARE
 myvar int;
 ...
END
$do$
$$ LANGUAGE SQL; 
```

# visual-studio - 如何在#light 模式下在 Visual Studio 2008 中缩进 F# 代码

> ID：766662
> 
> 赞同：5
> 
> 时间：2009-04-20T02:31:26.547
> 
> 标签：visual-studio, f#, indentation

在#light 模式下按**空格键**是缩进 F# 的唯一方法吗？

在使用#light 模式时，这似乎是一个严重的障碍。
有没有比在 VS 2008 中继续按空格键更好的方法？

![替代文字](https://farm4.static.flickr.com/3568/3457340817_669bf150e8_o.png)

**[答案]** by Brian ([答案](https://stackoverflow.com/questions/766662/how-to-indent-f-code-in-visual-studio-2008-in-light-mode/766677#766677))
1\. 转到`Tools -> Options -> Text Editor -> F# -> Tabs`
2\. 选择插入空格

![替代文字](https://farm4.static.flickr.com/3632/3458809921_1c9a94f6ff_o.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-20T02:37:29.870

看这里

[http://www.pandamonial.com/2008/04/f-vs-option.html](http://www.pandamonial.com/2008/04/f-vs-option.html)

# ruby-on-rails - Ruby on Rails - 如何以我需要的格式显示日期？从 YYYY-MM-DD HH:MM:SS UTC 转换为 MM/DD/YYYY

> ID：766674
> 
> 赞同：19
> 
> 时间：2009-04-20T02:37:09.450
> 
> 标签：ruby-on-rails, ruby, formatting

我是一个 RoR 新手。我尝试了很多东西，最后得出以下结论：

```
<td>
 <%= Date.strptime(request.baseline_start_date, "%Y-%M-%D %H:%M:%S %Z").strftime("%M/%D/%Y")%>
</td> 
```

但这也给了我一个错误：

```
$_ value need to be String (nil given) 
```

但我知道 request.baseline_start_date 给了我价值（尝试单独打印）。我不知道它说的是哪一个，因为没有给出。

关于如何实现格式转换的任何建议？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-17T21:47:47.407

在 Rails 中，您可以使用`to_time`字符串上的函数将其转换为 Date 对象：

```
'2012-11-14 14:27:46'.to_time.strftime('%B %e at %l:%M %p')

#=> "November 14 at 2:27 PM" 
```

如需方便的交互式参考指南，请参阅[http://www.foragoodstrftime.com/](http://www.foragoodstrftime.com/)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-04-24T18:38:06.927

```
Date.strptime(
  "2009-04-24 18:33:41 UTC",
  "%Y-%m-%d %H:%M:%S %Z"
).strftime("%m/%d/%Y")
# => "04/24/2009" 
```

我想也许你只是把格式字符串的大小写弄错了。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-10-17T21:50:49.537

查看活动支持文档和示例： [http ://apidock.com/rails/ActiveSupport/CoreExtensions/DateTime/Conversions/to_formatted_s](http://apidock.com/rails/ActiveSupport/CoreExtensions/DateTime/Conversions/to_formatted_s)

例子

```
datetime = DateTime.civil(2007, 12, 4, 0, 0, 0, 0)   # => Tue, 04 Dec 2007 00:00:00 +0000

datetime.to_formatted_s(:db)            # => "2007-12-04 00:00:00"
datetime.to_s(:db)                      # => "2007-12-04 00:00:00"
datetime.to_s(:number)                  # => "20071204000000"
datetime.to_formatted_s(:short)         # => "04 Dec 00:00"
datetime.to_formatted_s(:long)          # => "December 04, 2007 00:00"
datetime.to_formatted_s(:long_ordinal)  # => "December 4th, 2007 00:00"
datetime.to_formatted_s(:rfc822)        # => "Tue, 04 Dec 2007 00:00:00 +0000" 
```

或者，如果您真的想自定义它，请定义帮助程序，例如：

```
def custom_format(time)
  Time::DATE_FORMATS[:w3cdtf] = lambda { |time| time.strftime("%Y-%m-%dT%H:%M:%S# {time.formatted_offset}") }
end 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-21T21:24:14.817

您可以使用 ActiveSupport 中的 String#to_time（或 Date#to_time）函数将字符串转换为时间（或日期）对象。然后像你已经使用的那样使用 strftime 。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-12-28T08:56:36.623

我写了一个非常好的 gem，它简化了整个过程，并使日期格式化 DRY。

在以下位置查看：http: [//github.com/platform45/easy_dates](http://github.com/platform45/easy_dates)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T02:54:25.650

我所做的是在 config/initializer 中添加一个名为 conversions.rb 的初始化程序，然后添加如下一行：

```
ActiveSupport::CoreExtensions::Time::Conversions::DATE_FORMATS.update(:<name> => '<formatting>') 
```

从那里您可以使用您的格式呈现您的日期时间：

```
dateVar.to_s(:<name>) 
```

[这里](http://snippets.dzone.com/posts/show/2255)有一个方便的格式化标记列表

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T11:49:04.333

非常感谢您的回复。我的问题是，输出似乎已经是字符串，我必须将字符串中的日期转换为另一种格式。

当我查看存储在数据库 (Oracle) 中的日期时，它是 mm/dd/yy，但是当我显示它时，它会添加时间戳和时区。

我尝试将 Configuration\environment.rb 中的默认设置为 ActiveSupport::CoreExtensions::Date::Conversions::DATE_FORMATS.merge!( :default => '%d %b %Y' ) 但这似乎也没有帮助。

最后，如果我只是将字符串从时区格式转换为 mm/dd/yyyy，这就足够了。

# php - 是否可以使用 WordPress 会话对 CakePHP 应用程序进行身份验证？

> ID：766675
> 
> 赞同：1
> 
> 时间：2009-04-20T02:37:10.527
> 
> 标签：php, wordpress, cakephp

使用成功的 WordPress 登录尝试对 CakePHP 应用程序进行身份验证的最佳方法是什么？如果可能的话，我不想使用密码同步。我更愿意将所有用户详细信息保留在 WordPress 数据库表中。这个周末我一直在想这个问题，想不出一个好的解决方案。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T16:05:48.523

有时这是无法避免的，但是入侵需要定期修补的应用程序的核心肯定会造成大量痛苦。我会建议像 OPENID 这样的替代方案。

您可以使用这个 Wordpress 插件： [http](http://wordpress.org/extend/plugins/openid/) : //wordpress.org/extend/plugins/openid/ 允许在您的 Wordpress 博客中登录 OPENID。

然后，您只需要将 OPENID 支持安装到您的 CakePHP 应用程序身份验证例程中。这是我找到的教程： http: [//cakebaker.42dh.com/2008/02/06/new-version-of-the-openid-component/](http://cakebaker.42dh.com/2008/02/06/new-version-of-the-openid-component/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T05:35:18.430

假设您在这里谈论的是您自己的 Wordpress 安装，而不是托管的 Wordpress。

如果您精通 WordPress，则可以破解 WP 身份验证机制。我敢打赌，您可以从 WP auth 方法中调用 Cakephp URL，将必要的登录信息发布到 Cakephp。您还必须设置 Auth 机制字段属性，以便 Cake::Auth 知道从 Wordpress 数据库中提取用户信息。

它可以工作。

# service - Windows 服务故障排除、恢复设置？

> ID：766687
> 
> 赞同：0
> 
> 时间：2009-04-20T02:40:28.507
> 
> 标签：service, recovery, restart

现在我在 windows server 2003 上有某种服务应用程序，用于将设备中的数据输入数据库。

有时服务因数据错误或其他任何事情（数据库连接问题、互联网连接中断等）而失败，我必须重新启动服务，现在我为这个问题提供的解决方案是使用 NET START/STOP 命令的简单批处理命令每1小时安排一次。

然后我看一下服务属性上的恢复选项卡，有一个重新启动服务的选项，我想知道如何测试它？比如，Windows 怎么知道服务失败了？最重要的是如何知道发生故障时服务是否成功重启（基于恢复设置）？

PS：我无法访问代码

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T02:50:03.880

当服务因未处理的异常而崩溃时，服务控制台会自动重启。（您的代码的某些部分引发了异常，但没有任何东西捕获它，并且它一直冒泡并从主函数中冒出。）

如果您可以控制代码，最好在容易导致问题的区域周围放置一些 try/catch 块并更优雅地处理错误。您还可以在应用程序的主入口点周围放置一个 try/catch，以捕获并尝试处理代码中任何未处理的异常。

如果您无法控制代码，您可以通过强制发生这些错误之一来测试自动服务恢复。如果您在出现连接问题时服务崩溃，您可以通过拔下计算机上的网络电缆来强制执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-11T21:04:03.857

测试恢复选项的最简单方法是从任务管理器中终止服务进程。Windows 将检测到它并运行第一次故障恢复选项。后续杀死将测试第二次失败和后续失败选项。事件日志将记录退出和采取的措施。

根据您的环境和您的服务，这对您来说可能是也可能不是一个可行的选择，因为您*正在*终止服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-20T09:40:36.857

您可以将其恢复到较早的时间点，恢复 Surface 不会更改您的个人文件，但可能会删除最近安装的应用程序和驱动程序。

1.从屏幕右边缘向内滑动，然后点击搜索。（如果您使用鼠标，请指向屏幕的右上角，向下移动鼠标指针，然后单击搜索。）

2.在搜索框中输入控制面板，然后点击或单击控制面板。

3.在控制面板搜索框中输入恢复，然后点击或单击恢复。

4.点击或单击打开系统还原，然后按照说明进行操作。

# c# - 扫描Windows进程列表的最有效方法？

> ID：766694
> 
> 赞同：3
> 
> 时间：2009-04-20T02:42:50.917
> 
> 标签：c#, java, windows, process, tasklist

所以我目前正在研究一个需要在某些进程运行时计时的项目。我试图找出扫描进程列表的最有效方法，然后根据支持的程序列表检查进程列表可执行名称。

本质上，问题是两个部分：

1）从进程列表中获取进程可执行名称的最有效方法

2）将此列表与另一个列表进行比较的最有效方法

对于 (1)，其他开发人员之一正在使用 tasklist 命令并解析可执行文件名称。我还发现 C# 有一个 System.Diagnostic 进程列表，它会自动执行此操作。我们仍在尝试在 Java 和 C# 之间做出决定，因此我可能会倾向于语言中立的解决方案，但这可能是 C# 的决定性因素。

对于 (2)，支持的进程列表平均可能很小（1-10 个进程名称）。我们可以只通过列表运行每个进程，但我们认为这对于旧 PC 来说可能太多了，所以我们折腾了使用按字母顺序排列的 AVL 树的想法，该树包含应用程序启动时的初始进程列表，并检查所有内容首先对照它，然后检查我们支持的进程名称列表（如果它不在树中）。

非常感谢任何建议。

*编辑：显然您可以按进程可执行名称过滤任务列表，因此我们可以为支持的进程列表中的每个进程执行此操作。*

*编辑 2：是否有适用于 Windows XP Home 的等效任务列表？*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T03:14:12.903

如果您使用任务列表，实际上只运行一次命令并取回所有结果可能会更快，而不是为每个可执行文件名称运行它。执行进程和获取输出有一些开销。（当你得到结果时，你必须在代码中循环它们，但这可能会更快。通常一次运行的进程不会超过 100 个，所以不会太糟糕。）你应该编写一个测试并检查是否属实。

在 C# 中，Process.GetProcesses() 是最好的方法。

在 Java 中，实际上并没有等效的类/方法。获取进程列表是非常特定于操作系统的，因此 Java 设计者必须决定不将此功能集成/抽象到基本 Java 类中。您可能必须 Runtime.getRuntime().exec("tasklist.exe") 在 Windows 上获得结果，或在 Unix/Linux 上获得 exec("ps")。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T03:23:31.350

希望我能正确理解你的问题。您是否只是想将进程列表与 Windows 上运行的活动进程进行比较？C＃

```
static void Main(string[] args)
{
    // Approved processes.
    List<string> approvedProcesses = new List<string>();
    approvedProcesses.Add("chrome");
    approvedProcesses.Add("svchost");

    // LINQ query for processes that match your approved processes.
    var processes = from p in System.Diagnostics.Process.GetProcesses()
                    where approvedProcesses.Contains(p.ProcessName)
                    select p;

    // Output matching processes to console.
    foreach (var process in processes)
        Console.WriteLine(process.ProcessName + " " + process.Id.ToString());

    Console.ReadLine();

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T03:30:28.573

你多久做一次这个检查？除非它基本上是恒定的，否则我不会担心过早优化（SO 的常见主题）。

一个系统通常运行的进程少于 100 个，即使它有几千个，优化数据结构和设计最有效的算法也不会为您节省太多时间。

话虽如此，我建议您获取所有正在运行的进程并将该列表与您在内存中批准的列表进行比较。任何瓶颈都可能与调用 Windows 来询问进程有关，因此这样做一次而不是重复将是有益的。

# postgresql - Postgresql：是“公共的”。在 Postgresql 中完全限定表名的标准方法？

> ID：766698
> 
> 赞同：3
> 
> 时间：2009-04-20T02:45:20.210
> 
> 标签：postgresql, namespaces

如果我没有资格成为“公众”。在 account_category 表上，*out account_category*会与 account_category 表名冲突。

做“公开”。也适用于其他 rdbms？

```
CREATE OR REPLACE FUNCTION X_RAIN(x VARCHAR, OUT user_id VARCHAR, out account_category varchar, out depth int) returns setof record
AS 
$$
BEGIN
     return query 
     select uar.account_id, c.account_category, c.depth
     from account_with_types_chart_of_account uar
     inner join public.account_category c using(account_category_id);
END;
$$ LANGUAGE 'plpgsql'; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T03:22:06.487

关于 PostgreSQL 中的 public，当没有指定 schema 名称时，public 被定义为默认的 schema 名称。但是，这可以在 search_path = xxx 行的 postgresql.conf 文件中进行更改。要查看您当前的默认模式设置为发出以下 SQL 命令：

```
SHOW_ search_path; 
```

如果要在打开的查询会话中更改默认模式路径，请发出以下 SQL 命令：

```
SET search_path = new_path; 
```

但是，在您发布的示例中，我认为您遇到的命名冲突不是架构名称，而是函数**参数名称**account_category 和表名称 account_category。您可以重命名参数名称以避免这种冲突。在具有许多模式的数据库中，为了清楚起见，我经常在数据库对象名称的开头明确指定 public。

关于你的第二个问题，我不认为 PostgreSQL 在公共使用方面是独一无二的，但我知道许多其他数据库以不同的方式执行它们的模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T02:58:42.020

Public 是默认架构名称。

例如，在 MySQL 中它没有模式（如果我记得的话）。此外，如果您使用其他架构而不是公共架构，您的代码将会中断。

[http://www.postgresql.org/docs/8.3/interactive/ddl-schemas.html](http://www.postgresql.org/docs/8.3/interactive/ddl-schemas.html)

我建议使用另一个变量名。应该还有别的办法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T04:56:44.327

发生冲突是因为您为变量和表名使用了相同的名称。

这是一个非常糟糕的命名选择，并且会导致很多问题。

例如：

```
create function x (somename TEXT) returns bool as $$
declare
  tempbool int4;
begin
  select true INTO tempbool from some_table where somename = somename;
  return tempbool;
end;
$$ language plpgsql; 
```

这段代码基本上没有任何意义，因为解析器无法分辨“somename = somename”的含义。表名也是如此（在某种程度上）。

通常，您希望您的标识符（表名、列名、变量名）是唯一的。

我更喜欢对参数使用“in_”前缀，但您选择的命名模式可能会有所不同。

# vb.net - 独立可执行

> ID：766704
> 
> 赞同：3
> 
> 时间：2009-04-20T02:50:54.737
> 
> 标签：vb.net, deployment, executable

我正在 VB.NET 中开发一个相对简单的程序。我试图让用户的安装过程尽可能简单。

我知道可以将调试目录中的可执行文件用作独立的可执行文件，但是这种方法有什么缺点吗？例如，如果用户的机器上没有 .NET，程序将不会运行。

有没有办法发布程序，使其独立于单个可执行文件中？

感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T02:57:04.440

我认为 ClickOnce 部署可执行文件是实现这一目标的最接近的选择。这是关于如何做到这一点的一个很好的教程：[ClickOnce Deployment](http://www.15seconds.com/issue/041229.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-04T18:48:05.093

正如我提到的，Microsoft 提供了 ILMerge，但如果您不想使用 3rd 方应用程序，您可以自己编写代码。您的客户仍然需要 .Net 框架，但它允许您隐藏依赖项。如果您还想包含 .Net dll，则必须在引用设置中将引用设置为“复制本地”。

该程序要求您将 dll 添加为资源。每当您的程序需要该 dll 时，它将通过使用程序集解析挂钩按需加载它。如果您有多个 dll，您将不得不根据 ResolveEventArgs.Name 加载正确的 dll 的 switch case 或列表查找。

```
Module Program
    ''//Entry Point add dependency resolver hook
    Sub Main()
        AddHandler AppDomain.CurrentDomain.AssemblyResolve, _
                   AddressOf AssemblyReslover
    End Sub

    Private Function AssemblyReslover(ByVal sender As Object, _
                                  ByVal e As ResolveEventArgs) _
                                  As Assembly
       ''//ReferenceAssembly
        Dim ra As Assembly
        ra = Assembly.Load(My.Resources.MyDLL)
        Return ra
    End Function

End Module 
```

[http://support.microsoft.com/kb/837908](http://support.microsoft.com/kb/837908)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-02T21:10:36.680

Red Gate Smart Assembly 可以将 .NET 程序集编译为独立的可执行文件。它可以将所有依赖项嵌入到可执行文件中。

它不是免费的，但它确实带有其他非常有用的工具。我们最近开始使用它，到目前为止它非常有用。

[https://www.red-gate.com/products/smartassembly/index.htm](https://www.red-gate.com/products/smartassembly/index.htm)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-20T03:00:14.527

我不认为 .NET 程序通常可以制作成独立的程序，因为 .NET 框架被设计为与程序分开。但是，您是否考虑过在安装过程中使用可分发的 .NET 包[安装框架？](http://msdn.microsoft.com/en-us/netframework/aa731542.aspx)这将确保用户拥有最新版本的 .NET（如果他们还没有的话）。

（我在这里链接到 2.0 包，您可能需要更新的版本。）

# ruby - 使对象表现得像一个数组，以便在 ruby 中进行并行分配

> ID：766712
> 
> 赞同：5
> 
> 时间：2009-04-20T02:53:58.363
> 
> 标签：ruby, variable-assignment

假设您在 Ruby 中执行此操作：

```
ar = [1, 2]
x, y = ar 
```

然后，x == 1 和 y == 2。我可以在我自己的类中定义一种能产生相同效果的方法吗？例如

```
rb = AllYourCode.new
x, y = rb 
```

到目前为止，我能做的就是让 x == rb 和 y = nil。Python 有这样一个特性：

```
>>> class Foo:
...     def __iter__(self):
...             return iter([1,2])
...
>>> x, y = Foo()
>>> x
1
>>> y
2 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T13:15:59.413

是的。定义`#to_ary`. 这将使您的对象被视为分配的数组。

```
irb> o = Object.new
=> #<Object:0x3556ec>
irb> def o.to_ary
       [1, 2]
     end
=> nil
irb> x, y = o
=> [1,2]
irb> x
#=> 1
irb> y
#=> 2 
```

`#to_a`和之间的区别在于`#to_ary`用于`#to_a`尝试将给定对象转换为数组，而`#to_ary`如果我们可以将给定对象视为数组，则可用。这是一个微妙的区别。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T03:50:57.103

几乎：

```
class AllYourCode
   def to_a
     [1,2]
   end
end

rb = AllYourCode.new
x, y = *rb
p x
p y 
```

Splat 将尝试调用`to_ary`，然后尝试调用`to_a`。不过，我不确定您为什么要这样做，这实际上是一个恰好`Array`在其实现中使用的语法功能，而不是`Array`.

换句话说，多重赋值的用例如下：

```
# swap
x, y = y, x

# multiple return values
quot, rem = a.divmod(b)

# etc.
name, age = "Person", 100 
```

换句话说，大多数时候从 (the `Array`) 分配的对象甚至都不明显。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T03:21:49.157

你不能重新定义赋值，因为它是一个操作符而不是一个方法。但是，如果您的 AllYourCode 类要从 Array 继承，那么您的示例将起作用。

当 Ruby 遇到赋值时，它会查看右侧，如果有多个右值，它会将它们收集到一个数组中。然后它查看左侧。如果那里有一个左值，则为其分配数组。

```
def foo 
  return "a", "b", "c" # three rvalues
end

x = foo # => x == ["a", "b", "c"] 
```

如果有多个左值（更具体地说，如果它看到一个逗号），它会连续分配右值并丢弃多余的右值。

```
x, y, z = foo # => x == "a", y == "b", z == "c"
x, y = foo    # => x == "a", y == "b"
x, = foo      # => x == "a" 
```

正如您所发现的，如果返回一个数组，您也可以进行并行赋值。

```
def bar
  ["a", "b", "c"]
end

x = bar       # => x == ["a", "b", "c"]
x, y, z = bar # => x == "a", y == "b", z == "c"
x, y = bar    # => x == "a", y == "b"
x, = bar      # => x == "a" 
```

因此，在您的示例中，如果 rb 是一个数组或从数组继承，则 x 和 y 将被分配其前 2 个值。

# c - 抛弃指向 const 的指针数组中的 const-ness 以及有关 C 的其他问题

> ID：766713
> 
> 赞同：0
> 
> 时间：2009-04-20T02:54:04.557
> 
> 标签：c, arrays, pointers, casting, constants

我正在运行一些代码来测试 MATLAB mex 函数中的多线程（我知道 MATLAB 不是线程安全的……我只是想看看会发生什么）。MATLAB C 代码函数的入口点在帖子底部的代码中具有 mexFunction 函数的签名。由于我想将参数从这个函数传递到另一个使用 pthreads 创建的线程中，因此我需要将所有内容捆绑到一个结构中。mexFunction 的签名（我无法更改）包括指向 mxArray 的指针数组，但是我不能直接在结构定义中包含指向 mxArray 的指针数组，因为那时我无法分配给结构的该字段（不能分配给数组）。例如，这不起作用：

```
typedef struct MexFunArgs {
  int nrhs;
  const mxArray *prhs[];
} MexFunArgs;

/* ... now within the mexFunction ... */

MexFunArgs mfa;

mfa.prhs = prhs; 
```

解决此问题的第一个想法是将结构定义更改为：

```
typedef struct MexFunArgs {
  int nrhs;
  const mxArray **prhs;
} MexFunArgs; 
```

但是，当我在另一个线程中使用这个结构时，我需要转换回一个指针数组以便将它传递给 mexCallMATLAB 函数，据我所知这是无法完成的（如果我错了！）。

所以，我想改为将结构定义更改为：

```
typedef struct MexFunArgs {
  int nrhs;
  const mxArray *(*prhs)[];
} MexFunArgs; 
```

即，指向mxArray 的指针数组的指针。这解决了分配问题（尽管由于我不明白的原因，编译器仍然抱怨指针类型不兼容）。然而，事实证明 mexCallMATLAB 函数不采用指向 const mxArrays 的指针数组，而是采用指向非 const mxArrays 的指针数组。所以现在我想知道是否有一种方法可以将我的指针的 const 方面转换为指向 const mxArrays 的指针数组。我不知道该怎么做......以下是不合法的：

```
(mxArray *(*)[]) 
```

可以做到吗？如果不是，我正在尝试做的事情（将这些参数传递给另一个线程毫发无伤，这样它们就可以在编译器不抱怨的情况下使用）可能以其他方式在 C 中？

以下是我目前正在使用的完整代码，它按预期运行，但在编译时会产生警告。我讨厌警告，并希望它消失。实现这一目标的正确方法是什么？

```
#include <pthread.h>
#include <unistd.h>
#include <mex.h>

typedef struct MexFunArgs {
  int nrhs;
  mxArray *(*prhs)[];
} MexFunArgs;

void *do_thread(void *args) {
  MexFunArgs *mfa = (MexFunArgs*) args;

  mexCallMATLAB(0, NULL, mfa->nrhs, *mfa->prhs, "disp");

  pthread_exit(NULL);
}

void mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[]) {
  int num;

  if (nrhs < 1)
    mexErrMsgTxt("not enough input arguments");
  else
    num = mxGetScalar(prhs[0]);

  MexFunArgs mfa;

  mfa.nrhs = nrhs;
  mfa.prhs = &prhs[1]; /* <-- threads.c:29: warning: assignment from incompatible pointer type */

  pthread_t threads[num];

  int rc, t;
  for (t = 0; t < num; t++) {
    mexPrintf("In main: creating thread %d\n", t);
    rc = pthread_create(&threads[t], NULL, do_thread, (void *) &mfa);
    if (rc)
      mexErrMsgTxt("Problem with return code from pthread_create()");
  }
  return;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T04:30:15.777

警告是由于分配

> `mxArray`指向 const的指针数组（名称）

到

> 指向非 const 指针数组的指针`mxArray`。

请记住，您只能安全地分配给更合格的类型。

这些是不同的类型。您要么禁用该特定行的警告，要么使用强制转换——两者同样危险。

另请注意，如果您使用基于 C99 的编译器进行编译，`[]`则 mxArray 声明中的结构为空，声明一个可变长度数组。这是你想要的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T07:21:03.107

想出了一个让一切都愉快地工作的方法。因为数组和指针在函数签名中的处理方式相同，所以我只是将 mexFunction 更改为采用 mxArray ** 而不是 mxArray *thing[]。那么转换就没有问题了，因为不需要转换为数组类型（非法）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T03:34:23.540

根据您的标题进行疯狂的猜测，我假设您还没有掌握指针的常量与它所指向的对象的常量之间的区别。

请参阅[为什么这允许从 (char *) 提升到 (const char *)？](https://stackoverflow.com/questions/766386/why-does-this-allow-promotion-from-char-to-const-char/766406#766406)一个可以指导你的例子。

对于*和其他问题*部分，你为什么不把它们分成单独的问题。这可能有助于获得您寻求的答案。

# asp.net - 我的 JSON 数组会是什么样子？

> ID：766726
> 
> 赞同：0
> 
> 时间：2009-04-20T02:59:47.743
> 
> 标签：asp.net, javascript, json

我正在进行 ajax 调用，后端正在返回一个 JSON 数组。

有人可以给我一个示例，说明我的 json 数组应该是什么样子，以便我可以在 javascript 中执行以下操作吗？

```
if(myJSON.ErrorCode == 100)
{        
    alert(myJSON.Response.Message);

    for(var x = 0; x < myJSON.Response.Values.Count; x++)
             alert(myJSON.Response.Values[x];
}
else
{
       if(myJSON.ErrorCode == 250)
       {

           alert(myJSON.ErrorMessage);
       }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T03:08:28.250

第一种情况：

```
{ ErrorCode: 100, Response: { Message : "some message", Values : [0, 1, 2, ... ] } } 
```

第二种情况：

```
{ ErrorCode: 250, ErrorMessage: "error message" } 
```

# c# - 面向前端开发人员的 C# 资源

> ID：766731
> 
> 赞同：-1
> 
> 时间：2009-04-20T03:01:32.700
> 
> 标签：c#, resources

我主要是一名前端开发人员，我需要熟悉我正在从事的项目的 C# 开发。什么是学习 C# 的好资源/链接，因为我之前没有 C# 经验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T03:06:00.020

这将是您最好的起点

[http://msdn.microsoft.com/en-us/beginner/default.aspx](http://msdn.microsoft.com/en-us/beginner/default.aspx)

选择你喜欢的东西，web，windows，随便什么......他们有一个学习轨道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T03:11:48.307

您可以从这样的轻量级教程[开始](http://www.csharp-station.com/Tutorial.aspx)。当然，有关详细信息，您将不得不阅读有关该主题的书。[此页面](http://www.amazon.com/s?ie=UTF8&tag=mozilla-20&index=blended&link_code=qs&field-keywords=c%23&sourceid=Mozilla-search)上列出的任何一个都可以。

只有一件重要的事情：当你阅读并尝试编写和编译他们在书/教程中谈论的大部分内容时，一定要坐在电脑旁边。单纯的阅读是行不通的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T03:12:10.490

其他一些可能有用的链接：

*   [http://msdn.microsoft.com/en-us/vcsharp/aa336766.aspx](http://msdn.microsoft.com/en-us/vcsharp/aa336766.aspx)
*   [http://www.programmersheaven.com/2/Les_CSharp_0](http://www.programmersheaven.com/2/Les_CSharp_0)
*   [http://www.bitwisemag.com/copy/csharp/cshp1.html](http://www.bitwisemag.com/copy/csharp/cshp1.html)

如果金钱不是对象，我还建议查看培训课程。让一个真实的人来回答问题是非常宝贵的。

关于 SO 的其他一些问题与您的要求有些重叠。看一下：

*   ~~[https://stackoverflow.com/questions/632571/c-book-for-the-casual-beginner-c-programmer](https://stackoverflow.com/questions/632571/c-book-for-the-casual-beginner-c-programmer)~~
*   ~~[https://stackoverflow.com/questions/287927/best-way-to-learn-c](https://stackoverflow.com/questions/287927/best-way-to-learn-c)~~
*   ~~[https://stackoverflow.com/questions/52926/beginning-c](https://stackoverflow.com/questions/52926/beginning-c)~~

链接不再有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T03:15:57.360

我作为 C# 开发实习生工作了一段时间，发现这些网站非常有用。它们可能不是最好的，但确实包含足够的代码示例来完成足够的常见任务，您应该能够从中学到一些东西。

[http://www.csharpcorner.com/](http://www.csharpcorner.com)

[http://www.csharphelp.com/](http://www.csharphelp.com)

一般来说，谷歌搜索教程会产生不同的结果（但仍然值得）。如果您可以接触到更有经验的开发人员作为想法的共鸣板，这可以为您节省大量时间并帮助您更快地学习。正如其他人所指出的，编写和编译代码示例和修补有助于巩固您对语言细微差别的理解。

# svn - 管理源代码控制系统中程序所有权的有效方法是什么？

> ID：766732
> 
> 赞同：0
> 
> 时间：2009-04-20T03:01:37.363
> 
> 标签：svn, git, version-control

使用 SVN 或 Git 时，我想到了使用目录结构作为元数据占位符。每个团队都会在共享存储库中为他们的代码创建一个目录。我想得越多，这个想法就越糟糕。对我来说这似乎是个坏主意的原因是团队不是静态实体。团队可以消失、分裂、重组，甚至获得新名称。我知道我正在考虑使用唯一标识符，可能还有一个外部数据库。我什至可能面临每个团队存储库来适当地管理访问权限。在拥有 200 个或更多团队的情况下，我是否最好在外部数据库中维护所有权，或者是否有一些我可以学习的工具和实践？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T17:21:37.550

这是我为您指明正确方向的最佳尝试。一般来说：

以通常的方式根据系统的组件组织您的源代码。确保每个组件都可以独立配置访问控制（例如，在 git 中，这意味着每个组件都有单独的存储库，正如 Makis 所说）。

如今，管理访问权限通常与 LDAP 一起完成。配置您的工具以以通常的方式利用您组织的 LDAP 目录。（对于 git，这通常使用系统上的现有帐户来完成，这些帐户可能由 LDAP 支持，也可能不支持）。

以通常的方式使用您的版本控制系统的内置访问控制机制，以允许每个团队酌情读取或写入每个组件。如果此权限矩阵变得过于繁琐而无法手动管理，请构建自定义机制以在更高级别对其进行控制和/或自动进行大规模更新。

如果您的 VCS 没有组件架构、集中式用户帐户或访问控制，那么请放弃这个问题，直到解决更重要的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T03:29:36.377

以下是我看到的完成方式。将目录结构与相关技术线对齐。现在这可能是基于团队的。使用数据库或其他东西将二进制文件（或源文件）映射到团队成员。然后，当事情发生变化时，您所要做的就是更新数据库。

如果你把根做得很宽，那么你以后要做的重组就会比把它做得小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-15T07:57:46.653

Git 的访问权限不是很好。要开始处理它，您需要使用 gitosis，然后将一些代码写入 git 挂钩。我对此有[疑问](https://stackoverflow.com/questions/824990/git-gitosis-how-to-check-validity-of-user-name-and-email)。

然后，正如您所说，您将需要一个数据库来处理有关哪些用户可以访问哪个存储库的信息。即，您需要在 git 中将这些内容拆分为单独的存储库，因为您无法保护 git 中的单个文件或目录。前段时间我写了一篇关于这个的简短[博客笔记。](http://blog.sofistes.net/2009/05/why-not-to-git.html)超级项目可能会在未来有所帮助，但这个概念仍在建设中，并且没有很好的定义。

在诸如 Rational ClearCase 之类的更高级（且昂贵）的 SCM 工具中，您可以使用更好的工具来实现这一点。例如，您可以创建组件并定义每个组件的用户权限。不幸的是，如果情况发生很大变化，即使这些工具也需要手动进行大量更新。但是，如果您只需要用户权限，那么编写自己的工具比购买这些怪物中的一个更划算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T15:58:46.887

阅读您的问题，我有一个想法，这对您可能有用（或者不是，这只是我脑海中突然出现的一个想法;-)：

1.  与 linux 'devtodo' 工具一样，您可以在每个目录中为元数据创建一个文件。（对于 devtodo，该文件称为“.todo”）
2.  该元数据文件可能是一个[nosql](http://www.strozzi.it/cgi-bin/CSA/tw7/I/en_US/NoSQL/Home%20Page)数据库文件，当时团队的成员。
3.  该元数据文件可能在控制版本中。
4.  该元数据文件可以与其他文件（即团队中的所有成员）连接（作为 sql 连接操作）。
5.  可以定义一组脚本或 shell 别名来编写更常用的 nosql 命令行。

几行：你的 git 或 svn 中的关系数据库文件与你的元数据；并且没有数据库服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-15T07:28:08.347

您要存储的元数据将保存有关文件和使用资源的团队成员的信息。假设您在存储库中具有成熟的资源处理语义，例如签入注释等，一种策略可能是识别您正在查看的元数据并使用某些索引工具/api 对其进行索引。可以从存储库元数据中获取大量信息，这些信息可以被检索和索引。如果您需要更好的控制，您可以使用自定义的预提交挂钩来强制团队成员在签入时放置所需的信息。您拥有的元数据存储库将为查询/搜索用户和资源提供良好的控制。可以通过脚本每天/每周执行索引。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T19:04:53.073

为每个团队提供自己的存储库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-20T12:45:13.920

好的，如果我正确理解了您的问题，那么您有
1\. 多个程序
2\. 多个团队处理源代码
3\. 需要跟踪哪些团队正在处理哪些代码

您没有指定每次是否只处理一个程序，或者该程序是否可以由多个团队协作处理。

我不是 GIT 或 SVN 用户，我的主要经验是 perforce，但我将尝试概述一些适用于任何大型企业级 SCM 系统的最佳实践

1.  有一个主线代码分支 - 这将是您的“干净”区域。
2.  为每个团队创建一个沙箱分支
3.  使用清晰的命名约定

每个团队沙盒都将拥有对该沙盒的完全访问权限，但不能访问任何其他团队的沙盒。

所以就存储库布局而言，有这样的东西

*   *代码*
    *   *主线*
        *   *程序1*
        *   *程序2*
    *   *团队*
        *   *A队*
            *   *程序1*
        *   *B队*
            *   *程序2*

然后，每个团队都会将他们想要工作的东西的代码分支到他们的团队沙箱中，并可以自由地签入他们喜欢的任何东西。如果他们弄脏了自己的分支，那很好，他们的问题是在他们之间进行整理并按照他们认为合适的方式运行。

一旦团队对他们的代码的下一次迭代感到满意，那么**团队负责人只有** 将更改推广和集成到主线的权限

任何体面的 SCM 都会向您显示集成历史记录，因此对于提升到主线的每个更改，您都会知道哪个团队集成了以及何时集成。

如果团队解散，那么您可以根据需要放弃分支如果
团队名称更改，则为新团队创建新的沙箱分支，然后将旧团队沙箱中的更改集成到新沙箱

在 perforce 上，您可以做一些时髦的事情，例如反向集成，这非常好，因为您可以将主线拉入您的分支，进行任何合并然后集成回主线。只要代码上没有其他任何变化，那么集成就变成了直接的副本。这样做的好处是将“损坏”的主线向下推入沙箱并保持主线干净

无论如何，这是我的一些想法。SCM 管理本身就是整个领域，我相信很多其他人会有一些更好的解决方案，但上述方法对我有用

关于这个复杂领域的一些有用链接 :)
[软件生命周期建模](http://www.perforce.com/perforce/papers/life.html)
[SCM 中的高级最佳实践](http://www.perforce.com/perforce/papers/bestpractices.html)
[SCM 介绍 - 存储库](http://www.ericsink.com/scm/scm_repositories.html)
[SCM 介绍 - 分支](http://www.ericsink.com/scm/scm_branches.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-20T14:12:44.433

如果它是一个单独的项目，只需给它一个自己的存储库。

# python - Django auth 中间件的一些内部结构

> ID：766733
> 
> 赞同：4
> 
> 时间：2009-04-20T03:02:36.377
> 
> 标签：python, django

在 django.contrib.auth 中间件中，我看到了代码：

```
class AuthenticationMiddleware(object):
    def process_request(self, request):
        assert hasattr(request, 'session'), "requires session middleware"
        request.__class__.user = LazyUser()
        return None 
```

请告诉我为什么使用这样的表单 request._ *class* _.user = LazyUser() ？为什么不只是 request.user = LazyUser() ？

我知道 _ *class* _ 属性的含义，但正如我所理解的那样，直接分配给实例变量会更好。我哪里错了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-20T07:52:51.250

`LazyUser`是描述符类。根据[文档](http://docs.python.org/reference/datamodel.html#invoking-descriptors)，它只能是类属性而不是实例一：

> 例如，有一个以, then`a.x`开头的查找链，并继续通过排除元类的基类。`a.__dict__['x']``type(a).__dict__['x']``type(a)`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-20T03:10:28.263

这将影响`request`s 的创建方式。所有此类实例都将具有其`user`特定属性，`LazuUser`而无需在`request`实例化每个个体后进行更改。

# java - 自动生成包装器以防止“恶意向下转换”？

> ID：766738
> 
> 赞同：2
> 
> 时间：2009-04-20T03:06:02.047
> 
> 标签：java, delegates, code-generation

如果您在 Java 中实现了一个接口，则没有什么可以阻止调用者查看您提供的具体实现、转换为该类并调用不在接口中的方法。我相信这被称为“恶意向下转换”。

防止这种情况的一种方法是创建一个仅包含接口方法且不公开其委托的实现实例的包装器。缺少对私有变量的反射，您应该是安全的。

有没有办法自动创建这些包装器（在运行时，不使用 IDE 中的代码创建向导，因为这仍然会创建需要维护的源文件）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-20T03:09:51.633

另一种防止这种情况的方法是使用工厂类，并让实现成为工厂的私有内部类。只有工厂可以看到它，它只会返回接口类型，所以没有具体的实现可以强制转换。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-20T03:23:44.643

我喜欢詹姆斯布莱克的回答，但为了多样性，我会发布另一种方法。

您可以使用它`java.lang.reflect.Proxy`来执行此操作。有关我编写的一些代码（针对不同的问题），请参阅[这篇文章](https://stackoverflow.com/questions/743288/java-synchronization-utility)`Proxy`；如果你去掉同步的东西，你可以使用类似的代码。

# php - 下载前将文件重定向为简单格式

> ID：766739
> 
> 赞同：0
> 
> 时间：2009-04-20T03:08:24.570
> 
> 标签：php, pdf, .htaccess, redirect, rewrite

嗨，我正在尝试将指向我网站中任何 pdf 文件的所有链接重定向到一个页面，其中包含一个表单，该表单在用户继续下载/查看 pdf 之前收集用户信息。

例如

我想将网站中的 *.pdf 文件重定向到 request.php?file=name_of_pdf_being_redirected

其中 request.php 是带有表单的页面，在继续之前要求提供一些详细信息。

站点中的所有 pdf 文件都保存在 /pdf 文件夹中。

有任何想法吗？

编辑：对不起，我在服务器上使用 Apache。

好的，我要到了：我现在可以使用：

RewriteRule 上的 RewriteEngine ^pdf/(.+.pdf)$ request.php?file=/$1 [R]

但是现在当它进入下载页面时，当我想让这个人实际下载文件时，我的新规则是将下载链接吐回表格：-P 哈哈，所以一旦表格有，无论如何让它下载文件已提交并且您在 download.php 上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T03:22:13.367

想法？您可以先告诉我们您正在使用哪个网络/应用服务器，这可能会有所帮助:-)

在 Apache 中，您应该能够使用 RewriteRule 将请求转换为不同的形式。例如，`/pub/docs/x.pdf`变成`request.php?file=/pub/docs/x.pdf`可以通过以下方式完成：

```
RewriteRule ^/pdf/(.*)\.pdf/  request.php?file=/$1.pdf 
```

请记住，这是凭记忆（我接触 Apache 已有六年了，仍然干净:-)，格式可能略有不同。

**更新：**

现在你已经整理好了，这里有几个选项可以解决你的下一个问题。

1/ 重命名 PDF 以具有不同的扩展名，以便它们不会被重写规则捕获。它们应该配置为向客户端推送相同的 MIME 类型，以便它们在客户端选择的查看器中打开。

2/ 也将下载作为脚本的一部分，而不是直接访问 PDF。由于表单的提交是一个 HTTP 请求，因此您应该能够立即使用 PDF 内容来回答它，而不是再次将它们*重定向*到下载页面。

第二个选项将是我的选择，因为它：

*   阻止人们弄清楚他们可以通过请求 xx.pdfx 而不是 xx.pdf 来获取 PDF。
*   使人们可以更快地获取 PDF（他们不必再次单击链接）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T03:23:03.753

请注意，我的回答是针对 .NET 网站的，但我确信 PHP 中的某处存在相同的结构。

我将有一个带有 *.pdf 路径的 HTTPModule，它只是对 request.php?...etc 执行 Response.Redirect（在我的情况下为 request.aspx）然后在按钮的事件处理程序中单击该页面，当您知道要显示哪个 pdf 并且它们已获得授权时，只需执行 Response.ContentType = [PDF 的 MIME 类型]，然后执行 Response.WriteFile(pdfFile)，最后执行 Response.End()。

您可以添加其他内容以使其更好，例如文件大小等。但在最小的情况下，这会起作用。如果你想要 C# 中的代码，我可以在大约 3 分钟内想出一些东西，但在 PHP 中我很迷茫。我会开始寻找 HTTPModules 以及如何用 PHP 编写它们。

谷歌搜索“PHP HTTPModule”会导致：[Equivalent of ASP.NET HttpModules in PHP](https://stackoverflow.com/questions/570833/equivalent-of-asp-net-httpmodules-in-php)所以，我可能有点错误，但希望这是一个起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T03:23:23.177

如果您使用的是 Apache Web 服务器，请使用 .htaccess 文件。您需要确保您启用了 mod_rewrite，但是一旦您这样做了，您就可以使用以下两个简单的行重写所有文件：

RewriteEngine On RewriteRule ^.pdf$ /rewrite.php [NC,L]

如果您使用的是 IIS，则可以使用 ISAPI_Rewrite 完成类似的操作。

您的另一种选择是将您的 pdf 文件放在不可公开访问的目录中，然后对 pdf 资源的任何请求都将返回拒绝访问错误，并且只能通过适当的下载脚本访问文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T04:45:18.347

你可以试试这个：

*   将文件移动到 Web 根目录“外部”的文件夹中，这样任何人都无法通过浏览器访问它
*   使用会话来检测一个人是否已完成表单
*   使用 php 驱动的文件下载脚本。在其最天真的形式中，它可能看起来像这样：

```
    if ( isset( $_SESSION[ 'OK_TO_DOWNLOAD' ] ) == false )
    {
        header("位置：must_fill_this_first.php");
        退出（0）；
    }

    header("内容类型：应用程序/pdf");
    //仔细检查上面的内容，谷歌它，因为我不确定

    echo file_get_contents( 'some_directory_inaccessible_thru_www/' . $_GET[ 'pdf_name' ] );
    // 理想情况下，上面需要使用二进制安全函数

```

这是我在网站上使用的一种久经考验的技术。代码示例是一个草稿大纲，需要改进。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T05:05:46.317

```
if($user==authenticated){
 //set pdf headers
 echo file_get_contents('actual.pdf'); 
```

no mod re-writes, hides actual source and is what i normally do - hope this helps

# java - 使用 function-java 向 Java 生产项目添加闭包有多安全？

> ID：766745
> 
> 赞同：6
> 
> 时间：2009-04-20T03:11:10.773
> 
> 标签：java, functional-programming, closures, functional-java

我很想在 Java 中使用闭包。[我已经读到它们可能会或可能不会进入 Java 7。但是一个名为functional-java](http://code.google.com/p/functionaljava/)的开源项目已经实现了包括闭包在内的功能特性。

在企业生产应用程序中使用这样的库有多安全？

目前有没有更好的方法向 Java 添加闭包？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T04:33:32.773

由于对单一实现缺乏共识，闭包肯定不会进入 Java 7。[看这里。](http://hamletdarcy.blogspot.com/2008/12/java-7-update-from-mark-reinhold-at.html)

函数式 Java 库经过全面测试和积极开发。如果您浏览源代码，您会发现它只是简单的沼泽标准 Java，并没有太多可能出错的地方。我知道至少有一个在生产中使用它的关键任务企业应用程序。该应用程序拥有超过一百万的用户。

去吧。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T04:54:35.593

函数式 Java 不需要您使用闭包——源代码可以使用任何 Java 1.5 编译器进行编译。函数式 Java 比 Google 集合要完整得多，并且恰好允许您将它与 BGGA 很好地结合使用。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-09-13T00:09:41.443

我认为您从错误的角度看待这个问题。

> 我很想在 Java 中使用闭包。...在企业生产应用程序中使用这样的库有多安全？

您对在企业生产应用程序中使用何种技术的决策应基于长期对企业最有利的技术。你应该问这样的问题：

*   从功能的角度来看，添加该技术是否会显着改进应用程序？
*   当前项目有哪些风险？
*   该技术是否声称已“准备好生产”？
*   是否支持技术。在 5 到 10 年的时间里，它是否仍可能得到支持？
*   如果你离开公司，其他人会接管你的代码吗？
*   使用该技术对培训/招聘有何影响？

一般来说，诸如“我愿意使用 Xxx”之类的陈述在企业决策中不应占有一席之地。（有反例；例如，初创公司将公司押在某些新技术上，但真正的成功率是……嗯……可以猜测。）

总而言之，如果你正在构建企业生产应用程序，你需要保持保守，抵制使用闪亮的新技术“为了好玩”的诱惑。试着像 IT 经理一样思考。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-12T07:30:59.347

如果您正在寻找一个更轻量级的解决方案来在纯 Java 中使用闭包，请查看 lambdaj 项目：

[http://code.google.com/p/lambdaj/](http://code.google.com/p/lambdaj/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T03:29:46.233

BGGA 仍然是一个原型实现，不确定您将原型代码投入生产的舒适程度。查看[谷歌收藏](http://code.google.com/p/google-collections/)，它让你更接近目标，尽管更冗长

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-19T16:13:58.810

太老的问题无法回答。在这里，我们在 java8 中有 lambda，让您的生活更轻松。

# visual-studio - 在 Visual Studio (2008) 中，我可以作为 Web 根目录启动网站调试会话吗？

> ID：766751
> 
> 赞同：1
> 
> 时间：2009-04-20T03:14:29.953
> 
> 标签：visual-studio, debugging, cassini

我的解决方案中有一个网站，假设它位于名为 /Solution/Website1 的文件夹中。当我在 Visual Studio 中调试它时，它会显示为[http://localhost:someport/Website1](http://localhost:someport/Website1)。我希望它以[http://localhost:someport 开头](http://localhost:someport)。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T03:21:07.520

如果您单击 Website1 项目，然后转到属性窗口（F4），您应该在此处看到一个属性，`Virtual path`尝试将其设置为“/”

[![网站属性](https://i.stack.imgur.com/uWkhJ.png)](https://i.stack.imgur.com/uWkhJ.png)
[（来源：[bendewey.com](http://www.bendewey.com/code/stackoverflow/WebSiteProperties.png)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T03:19:31.220

如果您使用的是 Visual Studio 2008：

R-单击解决方案资源管理器中的项目标题。单击属性。转到 Web 选项卡，将有一个服务器部分，您可以在其中指定端口。

# php - 使用 php 上传文件 - 显示文件列表

> ID：766756
> 
> 赞同：0
> 
> 时间：2009-04-20T03:18:59.210
> 
> 标签：php

我正在制作一个脚本来通过 php 上传文件。我想知道的是如何显示已上传的文件，以及在单击它们时打开它们以供下载。我应该将名称和路径存储在数据库中，还是仅使用 php 列出目录的内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T03:31:15.873

查看[在 PHP 中处理文件上传](http://us3.php.net/features.file-upload)。几点：

*   理想情况下，您希望允许用户同时上传多个文件。只需为此使用 Javascript 动态创建额外的文件输入；
*   当您获得上传时，请确保使用[is_uploaded_file](http://us3.php.net/manual/en/function.is-uploaded-file.php)检查它是否是上传；
*   使用[move_uploaded_file()](http://us3.php.net/manual/en/function.move-uploaded-file.php)将文件复制到您要存储的任何位置；
*   不要依赖客户端告诉您的 MIME 类型是什么；
*   将它们发送回客户端可以使用 PHP 脚本轻松完成，但您需要知道正确的 MIME 类型；
*   尝试验证你得到的是你所期望的（例如，如果它是一个 PDF 文件，请使用库来验证它是），特别是如果你将该文件用于任何事情或将其发送给其他任何人；和
*   我建议您存储来自客户端计算机的文件的文件名并将其显示给他们，无论您将其存储为什么。用户更容易认识到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T03:29:28.763

根据您的特定应用程序，在数据库中存储路径可能没问题，但请考虑将文件名存储在数据库中，并在 PHP 中在一个地方构建这些文件的路径。这样，如果您稍后移动所有上传的文件，您的代码中只需要更改路径生成的一个地方，并且您可以避免对数据库中的“路径”字段进行大量数据转换。

例如，对于文件 1234.txt，您可以将其存储在：

```
/your_web_directory/uploaded_files/1/2/3/1234.txt 
```

您可以使用配置文件，或者如果您愿意，可以使用全局文件来定义上传文件的存储路径（/您的网络目录/上传的文件/），然后从文件名中拆分字符（在数据库中）以确定哪个子目录该文件实际驻留在其中。

至于显示文件，您可以简单地从数据库中加载文件列表，并使用路径生成功能根据文件名获取每个文件的下载路径。如果要对文件列表进行分页，请尝试使用 START 0, LIMIT 50; 在 mySQL 中。只需在上传结果的每个连续页面中传入一个新的起始编号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-18T18:10:31.273

也许你应该使用文件，从这个意义上说：

*我的文件.txt*

```
My Uploaded File||my_upload_dir/my_uploaded_file.pdf
Other Uploaded File||my_upload_dir/other_uploaded.html 
```

并像这样遍历它们：

```
<?php
    $file = "myfile.txt";
    $lines = file($file);
    $files = array();
    for($i=0;$i<=count($lines)-1;$i++) {
        $parts = explode($lines[$i]);
        $name = parts[0];
        $filename = parts[1];
        $files[$i][0] = $name;
        $files[$i][1] = $filename;
    }
    print_r($files);
?> 
```

希望这可以帮助。:)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-20T08:44:36.930

我一直在做的（过去时，我已经很久没有写过上传脚本了）是，我会将上传脚本（任何上传脚本）链接到一个简单的数据库。

这提供了一些优势；

*   您没有让用户直接了解您的文件系统（如果您的“浏览”脚本中存在泄漏并且您暴露了整个硬盘驱动器怎么办？*   您可以以简单有效的方式存储额外的信息和元数据*   您实际上可以查询文件/元数据，而不仅仅是遍历所有文件*   您可以启用“安全删除”，在其中删除行，但保留文件（例如）*   您可以更轻松地启用日志记录方式*   在页面中显示文件更容易*   您可以“屏蔽”文件。使用数据库使您能够存储“掩码”文件名​​和“真实”文件名。

显然，也有一些缺点；

*   迁移有点困难，因为您的文件系统和数据库必须同步*   如果操作失败（在两端之一），您有一个“损坏”的数据库或文件系统

如前所述（但恐怕我们不能提及足够多）；_确保您的上传安全！_

MIME 类型/扩展名问题已经持续了很长时间。我认为现在大多数网络都是可靠的，但曾经有一段时间，开发人员会检查 MIME 类型或扩展名，但从不会同时检查两者（为什么要麻烦？ ）。这导致网站非常非常泄漏。

如果没有正确编写，上传脚本是您安全的大漏洞。一个很好的例子是我不久前“入侵”的一个网站（当然是根据他们的要求）。他们支持将图像上传到相册，但他们只检查文件扩展名。所以我上传了一个 GIF，里面有一个目录扫描器。这让我可以扫描他们的整个系统（因为它不是专用服务器；我可以看到更多）。

希望我有所帮助；）

# git - 什么是被子补丁集？

> ID：766759
> 
> 赞同：15
> 
> 时间：2009-04-20T03:20:07.803
> 
> 标签：git, quilt

有一个名为[git-quiltimport](http://www.kernel.org/pub/software/scm/git/docs/git-quiltimport.html)的 git 命令。它的手册页说它“将被子补丁集应用于当前的 git 分支，保留被子补丁集中存在的补丁边界、补丁顺序和补丁描述。”

但是，它没有定义什么是“被子补丁集”。什么是“被子补丁集”？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-20T03:27:39.577

Quilt 是一个[补丁管理工具](http://mybravenewworld.wordpress.com/2007/11/13/quilt-patch-management/)。这个想法是，它使您可以更轻松地在单个源客户端中维护多个离散的更改集，即使它们涉及相同的文件。

[官方网站](http://savannah.nongnu.org/projects/quilt)的详细信息很少，但如果您正在考虑使用它，则值得。

如果您不使用 quilt，您可能只需要创建另一个客户端来维护单独的更改集，但是您必须来回修补对两个客户端源代码树都有利的更改。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-20T03:28:59.577

quilt patchset 是一个特殊的补丁系列，设计用于 Quilt 工具包。

**被子**

> Quilt 本质上是一个补丁管理工具包。它与 git 的不同之处在于它没有永久历史记录：补丁本身可以有一个描述字段，该字段通常等同于 git 中的提交元数据。quilt 与 git 的不同之处在于补丁集的锚定（quilt 只是提取的源库之上的一系列补丁，没有任何确定的实际源库被修补的标识）。

[Git、Quilt 和其他内核维护工具 (PDF)](https://www.ukuug.org/events/linux2007/2007/papers/Bottomley.pdf)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-20T04:17:01.800

quilt 补丁集是一组由 quilt 管理和组合的补丁。

补丁集是一组可以应用于一组文件的补丁——这些文件可能是代码、文档、数据或其他任何东西，通常是某种文本。实际的补丁是一个文本文件，它定义了要对原始版本进行的更改以创建新版本，通常使用程序“diff”生成。补丁集是这些差异输出的集合，每个输出通常都是更改过程中的一个逻辑步骤。

Quilt 是一个可以管理大量文件的许多补丁的程序。它可用于创建补丁文件、选择要应用的补丁文件、导出这些补丁供其他人使用以及从其他地方导入补丁。

有关使用补丁和差异的更多信息，请查看此处： [差异和补丁十分钟指南](http://stephenjungels.com/jungels.net/articles/diff-patch-ten-minutes.html)

有关被子信息，请尝试以下方法： [被子、补丁管理系统](https://www.wzdftpd.net/blog/quilt-a-patch-management-system-how-to-survive-with-many-patches.html)、 [被子手册页](http://linux.die.net/man/1/quilt)和 [被子项目页面](http://savannah.nongnu.org/projects/quilt/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-02-08T22:27:36.783

[Quilt](http://savannah.nongnu.org/projects/quilt)是一个非常轻量级的 SCM 工具，就像 Git、Subversion 或 Mercurial。`quiltimport`允许您从 Quilt 导入 Git。

很少有人使用被子。除非你有遗留的被子补丁，否则你可能不需要`quiltimport`. 具体来说，如果您对 Git 感到满意，那么没有理由采用 Quilt。

（Quilt 文档中的 quilt.pdf 建议如果您不想支付更重量级版本控制系统的“开销”，而您只需要它的一小部分功能，那么您可能更喜欢 Quilt。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-07T10:13:27.517

如果您将补丁集视为要应用的补丁集，那么 git 2.7 将更好地区分补丁集（带有补丁的文件夹）与文件“系列”（提供有序补丁列表的文件）申请）。

请参阅Juerg Haefliger 的[提交 ff60ffd](https://github.com/git/git/commit/ff60ffdc05fe8e2d26c488ab18c66b7fa746fcc6)（2015 年 8 月 31 日）。

^(（由[Junio C Hamano 合并 -- `gitster`--](https://github.com/gitster)在[提交 db9789a](https://github.com/git/git/commit/db9789ab4ea05c42c08d7c77f87875476eb78d0d)中，2015 年 10 月 5 日）)

> # `git-quiltimport`: 添加命令行选项`--series <file>`
> 
> 被子系列文件不必与补丁位于同一目录中，也可以与“ `series`”命名不同。
> 此补丁添加了一个命令行选项以允许使用非标准系列文件名和位置。

新选项是：

```
--series <file>: 
```

> 被子系列文件。
> 
> 系列文件的默认`<patches>/series`值是 $QUILT_SERIES 环境变量的值。

* * *

注意：使用 Git 2.21（2019 年第一季度）添加了“ `--keep-non-patch`”选项。
请参阅[Laura Abbott ( ) 的](https://github.com/labbott)[提交 1eaadaa3](https://github.com/git/git/commit/1eadaa3978fb8f9e9d062379fc95a65fb5ff6f8b)（2018 年 12 月 12 日[）](https://github.com/labbott)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 9c51ad5](https://github.com/git/git/commit/9c51ad58533445719f288f109d90787d99563ec5))^(中，2019 年 1 月 18 日）)[`labbott`](https://github.com/labbott)
^([`gitster`](https://github.com/gitster))

> [`git am`可以`--keep-non-patch`选择](https://git-scm.com/docs/git-am#git-am---keep-non-patch)传递[`-b`给以`gi mailinfo`](https://git-scm.com/docs/git-mailinfo#git-mailinfo--b) **保持主题前缀不变**。
> 也允许使用此选项`quiltimport`。

# sql - SQL Server 2005/2008 中的异步触发器

> ID：766761
> 
> 赞同：36
> 
> 时间：2009-04-20T03:21:14.897
> 
> 标签：sql, sql-server, sql-server-2005, triggers

我有触发器操作并将大量数据插入到**更改跟踪**表中，以便在每次插入、更新和删除时进行审计。

这个触发器很好地完成了它的工作，通过使用它，我们能够根据每个事务的业务需求记录所需的旧值/新值。

但是，在*某些*源表有很多列的情况下，事务可能需要长达 30 秒才能完成，这是不可接受的。

*有没有办法让触发器异步运行？*任何例子。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-20T04:19:31.357

您不能使触发器异步运行，但可以让触发器将消息同步发送到[SQL Service Broker](http://msdn.microsoft.com/en-us/library/ms345108(SQL.90).aspx)队列。然后可以由存储过程异步处理队列。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-20T10:07:49.897

这些文章展示了如何使用服务代理进行异步审计，应该很有用：

[使用 Service Broker 进行集中式异步审计](http://weblogs.sqlteam.com/mladenp/archive/2007/07/16/60258.aspx)

[Service Broker 好东西：跨服务器多对一（一对多）方案以及如何对其进行故障排除](http://weblogs.sqlteam.com/mladenp/archive/2007/08/21/Service-Broker-goodies-Cross-Server-Many-to-One-One-to.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-03-21T05:54:37.157

SQL Server 2014 引入了一个非常有趣的特性，称为[延迟持久](https://msdn.microsoft.com/en-us/library/dn449490.aspx?f=255&MSPPError=-2147217396)性。如果您可以容忍在发生灾难性事件（例如服务器崩溃）时丢失几行，那么您可以真正提高在像您这样的方案中的性能。

> 延迟事务持久性是使用异步日志写入磁盘来实现的。事务日志记录保存在缓冲区中，并在缓冲区填满或发生缓冲区刷新事件时写入磁盘。延迟事务持久性减少了系统内的延迟和争用

必须首先更改包含该表的数据库以允许延迟持久性。

```
ALTER DATABASE dbname SET DELAYED_DURABILITY = ALLOWED 
```

然后，您可以在每个事务的基础上控制持久性。

```
begin tran

insert into ChangeTrackingTable select * from inserted

commit with(DELAYED_DURABILITY=ON) 
```

如果事务是跨数据库的，则事务将作为持久事务提交，因此仅当您的审计表与触发器位于同一数据库中时，这才有效。

也有可能将数据库更改为强制而不是允许。这会导致数据库中的所有事务都变得延迟持久。

```
ALTER DATABASE dbname SET DELAYED_DURABILITY = FORCED 
```

> 对于延迟的持久性，SQL Server 的意外关闭和预期的关闭/重新启动之间没有区别。与灾难性事件一样，您应该为数据丢失做好准备。在计划的关闭/重启中，一些尚未写入磁盘的事务可能会首先保存到磁盘，但您不应该对此进行计划。计划关闭/重启，无论是计划内还是计划外，都会像灾难性事件一样丢失数据。

这个奇怪的缺陷有望在未来的版本中得到解决，但在此之前，确保在 SQL Server 重新启动或关闭时自动执行“sp_flush_log”过程可能是明智之举。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-21T09:43:12.900

要执行异步处理，您可以使用 Service Broker，但这不是唯一的选择，您还可以使用 CLR 对象。

以下是异步调用另一个过程 (SyncProcedure) 的存储过程 (AsyncProcedure) 的示例：

```
using System;
using System.Data;
using System.Data.SqlClient;
using System.Data.SqlTypes;
using Microsoft.SqlServer.Server;
using System.Runtime.Remoting.Messaging;
using System.Diagnostics;

public delegate void AsyncMethodCaller(string data, string server, string dbName);

public partial class StoredProcedures
{
    [Microsoft.SqlServer.Server.SqlProcedure]
    public static void AsyncProcedure(SqlXml data)
    {
        AsyncMethodCaller methodCaller = new AsyncMethodCaller(ExecuteAsync);
        string server = null;
        string dbName = null;
        using (SqlConnection cn = new SqlConnection("context connection=true"))
        using (SqlCommand cmd = new SqlCommand("SELECT @@SERVERNAME AS [Server], DB_NAME() AS DbName", cn))
        {
            cn.Open();
            using (SqlDataReader reader = cmd.ExecuteReader())
            {
                reader.Read();
                server = reader.GetString(0);
                dbName = reader.GetString(1);
            }
        }
        methodCaller.BeginInvoke(data.Value, server, dbName, new AsyncCallback(Callback), null);
        //methodCaller.BeginInvoke(data.Value, server, dbName, null, null);
    }

    private static void ExecuteAsync(string data, string server, string dbName)
    {
        string connectionString = string.Format("Data Source={0};Initial Catalog={1};Integrated Security=SSPI", server, dbName);
        using (SqlConnection cn = new SqlConnection(connectionString))
        using (SqlCommand cmd = new SqlCommand("SyncProcedure", cn))
        {
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.Parameters.Add("@data", SqlDbType.Xml).Value = data;
            cn.Open();
            cmd.ExecuteNonQuery();
        }
    }

    private static void Callback(IAsyncResult ar)
    {
        AsyncResult result = (AsyncResult)ar;
        AsyncMethodCaller caller = (AsyncMethodCaller)result.AsyncDelegate;
        try
        {
            caller.EndInvoke(ar);
        }
        catch (Exception ex)
        {
            // handle the exception
            //Debug.WriteLine(ex.ToString());
        }
    }
} 
```

它使用异步委托来调用 SyncProcedure：

```
CREATE PROCEDURE SyncProcedure(@data xml)
AS
  INSERT INTO T(Data) VALUES (@data) 
```

调用 AsyncProcedure 的示例：

```
EXEC dbo.AsyncProcedure N'<doc><id>1</id></doc>' 
```

不幸的是，该程序集需要 UNSAFE 许可。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T04:00:18.690

我想知道您是否可以通过插入“too process”表（包括谁进行了更改等）来标记更改跟踪的记录。

然后另一个进程可能会出现并定期复制其余数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T04:07:52.273

显然，“做得很好”和“不可接受”之间存在基本冲突。

在我看来，您尝试使用触发器的方式与您在 OO 程序应用程序中使用事件的方式相同，恕我直言，没有映射。

我会将任何需要 30 秒（不，超过 0.1 秒）的触发逻辑称为功能失调。我认为您确实需要重新设计功能并以其他方式进行。我会说“如果你想让它异步”，但我认为这种设计在任何形式上都没有意义。

至于“异步触发器”，基本的基本冲突是你永远不能在 BEGIN TRAN 和 COMMIT TRAN 语句之间包含这样的东西，因为你已经忘记了它是否成功。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-20T09:36:23.297

创建历史表。在更新（/删除/插入）主表时，将记录的旧值（触发器中删除的伪表）插入历史表；还需要一些额外的信息（时间戳、操作类型、可能是用户上下文）。无论如何，新值都保留在实时表中。

这种方式触发器运行得很快（er），您可以将慢速操作转移到日志查看器（过程）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-12-31T12:26:31.287

从 sql server 2008 开始，您可以使用`CDC`功能自动记录更改，这完全是异步的。[在此处](https://www.sqlshack.com/change-data-capture-for-auditing-sql-server/)查找更多详细信息

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-20T03:44:22.533

我不知道，但是您是否将值插入到基表中也存在的审计表中？如果是这样，您可以考虑仅跟踪更改。因此，插入将跟踪更改时间、用户、额外和一堆 NULL（实际上是之前的值）。更新将仅具有更改时间、用户等以及更改列的先前值。删除具有更改等和所有值。

此外，您是否有每个基表的审计表或数据库的一个审计表？当然，后者更容易导致等待，因为每个事务都尝试写入一个表。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-20T04:25:28.067

我怀疑您的触发器属于这些通用 csv/文本生成触发器，旨在将所有表的所有更改记录在一个地方。理论上很好（也许......），但在实践中难以维护和使用。

如果您可以异步运行（这仍然需要将数据存储在某个地方以便稍后再次记录），那么您就没有进行审计，也没有历史可以使用。

也许您可以查看触发器执行计划，看看哪个位花费的时间最长？

你能改变你的审计方式吗？比如说，每张桌子？您可以将当前日志数据拆分到相关表中。

# c# - 类似于 WPF ItemsControl 的用户控件列表

> ID：766772
> 
> 赞同：8
> 
> 时间：2009-04-20T03:24:25.093
> 
> 标签：c#, winforms, list, user-controls

我有两个数据列表。为了表示一个“项目”，我有一个自定义的用户控件（因为项目有多个字段，我想在用户控件上正确布局）。

我希望这些用户控件而不是字符串在某种类型的 ListBox 上填充列表。

我见过人们在 WPF 中使用 ItemsControl 或一些转发器来执行此操作。您知道在 WinForms 中是否有任何方法可以做到这一点？

如果用户控件的数量大于容器，我想确保获得正确的垂直滚动。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T04:38:39.487

[`FlowLayoutPanel`](http://msdn.microsoft.com/en-us/library/system.windows.forms.flowlayoutpanel.aspx)似乎完成了这项工作

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-20T03:31:47.773

在 .NET 3.5 SP1 中，[DataRepeater](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.powerpacks.datarepeater.aspx)组件作为 WinForms 的一部分添加到框架中（而不是作为 VB PowerPack 可下载附加组件的一部分）。如果您在该版本的框架上运行，那么它可能会满足您的需求。

# sql - 如何在 SQL 数据库中查询很多没有任何共同标准的结果？

> ID：766773
> 
> 赞同：2
> 
> 时间：2009-04-20T03:26:39.767
> 
> 标签：sql, sql-server

我有一个包含大约 2,600 条记录的 MS SQL 数据库（每条记录都在计算机上。）我需要编写一个 SELECT 语句来选择其中大约 400 条记录。

当他们没有任何共同标准时，最好的方法是什么？它们都是不同的随机数，所以我不能使用通配符或类似的东西。我只需要手动在查询中包含所有 400 个数字吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T03:33:09.813

**如果您需要 400 个特定行，并且它们的列与某个数字匹配：**

是的，包括使用 IN 子句的所有 400 个数字。根据我的经验（通过代码分析），使用 IN 子句比使用 where column = A or column = B or ...

400真的不是很多。

```
SELECT * FROM table WHERE column in (12, 13, 93, 4, ... ) 
```

**如果您需要 400 个随机行：**

```
SELECT TOP 400 * FROM table
ORDER BY NEWID() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T03:37:43.143

与其执行多个查询或选择整个行集并自行过滤，不如创建一个临时表或永久表，在其中为每个 ID 插入临时行。`join`在您的临时表上的主要查询中。

例如，如果您的源表是...

```
person:
    person_id
    name 
```

你有 400 个不同`person_id`的你想要的，假设我们有一个用于临时行的永久表，就像这样......

```
person_query:
   query_id
   person_id 
```

你将你的行插入`person_query`，然后像这样执行你的查询..

```
select
    *

from person p

join person_query pq on pq.person_id = p.person_id

where pq.query_id = @query_id 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T03:36:16.267

也许你发现了数据库设计的不足。也就是说，您想要的 400 条记录中有一些共同点，您需要的是数据库中的另一列来指示这种共同点。然后，您可以针对这个新列进行选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T16:04:38.743

正如上面 Brian Bondy 所说，使用 IN 语句可能是最好的方法

```
SELECT * FROM table WHERE column in (12, 13, 93, 4, ... )
```

一个很好的技巧是从电子表格中粘贴 ID，如果您有...

如果您想要的行的 ID 在电子表格中，那么您可以在电子表格中添加一个额外的列，在 ID 的末尾用逗号连接（），以便电子表格中的列如下所示：

```
12,
13,
93,
4、

```

然后将此列数据复制并粘贴到您的查询中，如下所示：

```
SELECT * FROM table WHERE 列在 (
12,
13,
93,
4、
...
)

```

它看起来并不漂亮，但它是获取所有数字的快速方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T03:30:43.267

您可以创建一个 XML 列表或类似的东西来跟踪您需要查询的内容，然后您可以编写一个查询来遍历该列表，将所有这些都返回。

[这](http://vyaskn.tripod.com/passing_arrays_to_stored_procedures.htm)是一个网站，其中有许多示例，可以通过多种不同的方法（#4 是 XML 方法）执行您正在寻找的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T03:36:38.917

您可以使用这 400 多个随机标记创建一个表，然后在这些标记上进行选择。例如，

```
SELECT * FROM inventory WHERE inventory_id IN (SELECT id FROM inventory_ids WHERE tag = 'foo') 
```

您仍然需要维护另一个表，但至少您没有一个巨大的查询。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T03:37:35.217

我会用你的选择标准建立一个单独的表，然后将这些表连接在一起或类似的东西，当然假设你的标准是静态的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T18:04:39.783

只需选择前 n 行，然后随机排序。

以下是返回 10 个随机员工姓名的假设示例：

```
 SELECT TOP 10
     EMP.FIRST_NAME
    ,EMP.LAST_NAME
   FROM  
     Schema.dbo.Employees EMP
   ORDER BY
     NEWID() 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-20T03:32:42.123

对于这种特定情况（不一定是通用解决方案），最快和最简单的方法可能是将整个 SQL 表读入内存并在程序代码中找到匹配项，而不是让数据库解析巨大的 where 子句。

# c - 在 GEdit 中创建自己的语法高亮显示？

> ID：766775
> 
> 赞同：25
> 
> 时间：2009-04-20T03:27:07.927
> 
> 标签：c, linux, gnome, gedit

如何将“关键字”添加到 GEdit 关键字列表中？我基本上想让 printf 函数看起来像一个关键字。

```
printf("Hello World\n"); 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-20T03:36:21.180

GEdit 使用[GtkSourceView](http://projects.gnome.org/gtksourceview/)进行语法高亮。您应该能够`c.lang`通过键入如下命令找到它用于突出显示 C 代码的文件：

```
$ locate gtksourceview | grep /c.lang 
```

找到 lang 文件后，在文本编辑器中打开它（它是一个 XML 文件），在底部附近您会看到一个关键字列表，您应该可以添加这些关键字`printf`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-02-08T10:16:59.303

感谢 Jeremy 的帖子，我找到了这个页面：[Projects/GtkSourceView - GNOME Wiki！](https://wiki.gnome.org/Projects/GtkSourceView)或[GtkSourceView - 文档（来自 Wayback Machine）](https://web.archive.org/web/20111207025517/http://projects.gnome.org/gtksourceview/documentation.html)

在这里，您将找到指向语言定义文件的教程和官方参考的链接。

更新：另一个有用的链接[Gedit/NewLanguage - GNOME Live！（来自 Wayback 机器）](https://web.archive.org/web/20111227080157/http://live.gnome.org/Gedit/NewLanguage)

# jquery - 是否可以在 jQuery UI 中模拟相交的“droppables”？

> ID：766777
> 
> 赞同：1
> 
> 时间：2009-04-20T03:27:54.397
> 
> 标签：jquery, jquery-ui

假设我有一个宽度为 2x 的可拖动对象，需要将其放在宽度为 3x 的区域上，无论是在最左端还是最右端（在另一侧留下 x 的间隙）。因此，例如，我有一个可拖动的 div，它被放置在具有三个子 td 的 tr 上，并且可以同时放置在第一个和第二个 td 上，或者第二个和第三个 td 上。任何人都可以想出一种在 jQuery UI 上使用某种技巧来实现这种效果的方法，还是我需要在较低级别工作？用户反馈在这里很重要——悬停在第一个和第二个 tds 上应该以某种不同于悬停在第二个和第三个 tds 上的方式传达给用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T15:21:11.110

由于您只有 3 个单元格，因此这个问题很容易解决。您可以简单地将最左边和最右边的单元格设为可放置元素。现在，当可拖动鼠标悬停在其中一个单元格上时，您可以将其背景颜色和中间的颜色更改为不同的颜色。

因此，例如，如果您的 HTML 是：

```
<div id="draggable_thing"><!-- who knows... (probably you...) --></div>
<tr>
    <td class="left"></td>
    <td class="mid"></td>
    <td class="right"></td>
</tr> 
```

然后，您可以执行以下操作：

```
$(function() {
    $("#draggable_thing").draggable();
    $(".right").droppable({
        over: function(event, ui) {
            $(this).toggleClass('over-right-cell');
            $(this).parent().find('.mid').toggleClass('over-right-cell');
        }
        out: function(event,ui) {
           $(this).toggleClass('over-right-cell');
           $(this).parent().find('.mid').toggleClass('over-right-cell'); 
        }
    });
    $(".left").droppable({
        over: function(event, ui) {
            $(this).toggleClass('over-left-cell');
            $(this).parent().find('.mid').toggleClass('over-left-cell');
        }
        out: function(event,ui) {
           $(this).toggleClass('over-left-cell');
           $(this).parent().find('.mid').toggleClass('over-left-cell'); 
        }
    });
}); 
```

然后你只需要几个不同的 CSS 类来让用户知道动作是不同的。像这样丑陋的东西足以用于演示目的：

```
.over-right-cell { background-color: blue; }
.over-left-cell  { background-color: green; } 
```

祝你好运！

# c - Windows 和 Lighttpd 上的 FastCGI

> ID：766779
> 
> 赞同：2
> 
> 时间：2009-04-20T03:29:09.730
> 
> 标签：c, windows, cgi, fastcgi, lighttpd

我希望使我的 CGI 论坛软件 FastCGI 兼容。论坛软件由一些用 C 和 x86 汇编语言编写的 dll 和 .exe (.cgi) 文件组成。我也有一个 SQlite3 数据库。

Lighttpd 将所有这些 cgi 脚本作为子进程运行，我经常说整个事情运行得非常好。

但我想试验 FastCGI。但是，示例很差，文档很差，而且看起来确实是为 Linux 设计的。有人让 FastCGI 在 Windows 上工作吗？如果有人有代码示例和 lighttpd 配置行，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T17:28:57.067

我已经在 Windows 上使用 fastcgi 完成了一些工作。底线是它不是很有趣 - 你是 100% 正确的，没有很多样本，而且文档很差。但是，我在这方面提供帮助的开发人员与编写 iis 和 fastcgi 规范的人取得了联系，并且能够让他的软件正常工作。一些改变正在进行中以提供帮助。这是一些信息的链接：

[http://blogs.iis.net/ksingla/archive/2009/04/20/fastcgi-isapi-1-5-beta-for-winxp-and-win2k3.aspx](http://blogs.iis.net/ksingla/archive/2009/04/20/fastcgi-isapi-1-5-beta-for-winxp-and-win2k3.aspx)

我应该补充一点，与我一起工作的那个人对 libfcgi.dll 有很多问题，以至于他最终重写了它（请参阅上面链接的文章中对 libfcgi2.dll 的引用。）

最好的问候，唐

# java - 您使用函数式 Java 项目的经验是什么？

> ID：766792
> 
> 赞同：11
> 
> 时间：2009-04-20T03:34:46.083
> 
> 标签：java, functional-programming, functional-java

我正在阅读以下问题 -[*使用功能 Java 向 Java 生产项目添加闭包有多安全？*](https://stackoverflow.com/questions/766745/how-safe-would-it-be-to-use-functional-java-to-add-closures-to-a-java-production)我一直在考虑在我当前的项目中使用[Functional Java项目。](http://functionaljava.org/)我想知道 Stack Overflow 的用户使用 Functional Java 项目的体验如何？特别是，我对其中一些细节感到好奇：

*   它是否提高了代码质量或清晰度？
*   提高生产力？
*   减少潜在的故障点？
*   影响性能？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-20T05:33:43.020

我一直在一个使用 FJ 库的团队中，我知道其他人。在一个团队中，它被用来替代一个不太完善的本土图书馆，在另一个团队中，它取代了 Google Collections。我也知道有些人抄袭 FJ 的源代码来推出自己的实现。

在我看来，如果你必须使用 Java，你应该使用函数式 Java 之类的东西来让你的生活更轻松。

> 它是否提高了代码质量或清晰度？

以函数式风格编写的代码更简洁，因此更清晰。该库附带并鼓励使用不可变数据结构，从而提高质量。该库还鼓励组合而不是继承，这提高了代码的可重用性。

> 提高生产力？

确实。拥有更强大工具的开发人员效率更高。以我的经验，开发人员认为一流的功能使编程更容易和更愉快。快乐的程序员是高效的程序员。

> 减少潜在的故障点？

更实用的编程风格不鼓励可变状态，这消除了一大类错误。此外，更强大的抽象会导致更少的重复，从而减少出现问题的地方的数量。

> 影响性能？

没有理由相信性能会以某种方式受到影响。提供的数据结构是为易用性和表达性而非性能而设计的，但它们的编写是针对它们的本质而优化的。与其他任何事情一样，您如何驾驶比您驾驶的内容更重要。例如， fj.data.List 是一个链表，因此它具有 O(n) 随机访问和连接，因此出于这些目的您应避免使用它。相比之下，fj.data.Stream 具有 O(1) 级联。

# apache - Apache 拒绝连接

> ID：766802
> 
> 赞同：0
> 
> 时间：2009-04-20T03:39:32.483
> 
> 标签：apache, freebsd, httpd.conf

我最近在我的 FreeBSD 机器上安装了 Apache。一切正常；通过本地机器的 telnet 和通过我的 XP 机器上的 Firefox（通过我的 DSL 路由器连接）上的 http 获得“它可以工作！” 页。然后，我重新启动了我的 BSD 机器，现在 telnet（通过 su 和我的普通帐户）和 Firefox 都不允许连接——我一直都得到 403 错误。我已经检查了权限并多次查看了 httpd.conf，但我无法弄清楚这一点。我的 httpd.conf 文件如下：

```
ServerRoot "/usr/local"

Listen 80

LoadModule authn_file_module libexec/apache22/mod_authn_file.so
LoadModule authn_dbm_module libexec/apache22/mod_authn_dbm.so
LoadModule authn_anon_module libexec/apache22/mod_authn_anon.so
LoadModule authn_default_module libexec/apache22/mod_authn_default.so
LoadModule authn_alias_module libexec/apache22/mod_authn_alias.so
LoadModule authz_host_module libexec/apache22/mod_authz_host.so
LoadModule authz_groupfile_module libexec/apache22/mod_authz_groupfile.so
LoadModule authz_user_module libexec/apache22/mod_authz_user.so
LoadModule authz_dbm_module libexec/apache22/mod_authz_dbm.so
LoadModule authz_owner_module libexec/apache22/mod_authz_owner.so
LoadModule authz_default_module libexec/apache22/mod_authz_default.so
LoadModule auth_basic_module libexec/apache22/mod_auth_basic.so
LoadModule auth_digest_module libexec/apache22/mod_auth_digest.so
LoadModule file_cache_module libexec/apache22/mod_file_cache.so
LoadModule cache_module libexec/apache22/mod_cache.so
LoadModule disk_cache_module libexec/apache22/mod_disk_cache.so
LoadModule dumpio_module libexec/apache22/mod_dumpio.so
LoadModule include_module libexec/apache22/mod_include.so
LoadModule filter_module libexec/apache22/mod_filter.so
LoadModule charset_lite_module libexec/apache22/mod_charset_lite.so
LoadModule deflate_module libexec/apache22/mod_deflate.so
LoadModule log_config_module libexec/apache22/mod_log_config.so
LoadModule logio_module libexec/apache22/mod_logio.so
LoadModule env_module libexec/apache22/mod_env.so
LoadModule mime_magic_module libexec/apache22/mod_mime_magic.so
LoadModule cern_meta_module libexec/apache22/mod_cern_meta.so
LoadModule expires_module libexec/apache22/mod_expires.so
LoadModule headers_module libexec/apache22/mod_headers.so
LoadModule usertrack_module libexec/apache22/mod_usertrack.so
LoadModule unique_id_module libexec/apache22/mod_unique_id.so
LoadModule setenvif_module libexec/apache22/mod_setenvif.so
LoadModule version_module libexec/apache22/mod_version.so
LoadModule ssl_module libexec/apache22/mod_ssl.so
LoadModule mime_module libexec/apache22/mod_mime.so
LoadModule dav_module libexec/apache22/mod_dav.so
LoadModule status_module libexec/apache22/mod_status.so
LoadModule autoindex_module libexec/apache22/mod_autoindex.so
LoadModule asis_module libexec/apache22/mod_asis.so
LoadModule info_module libexec/apache22/mod_info.so
LoadModule cgi_module libexec/apache22/mod_cgi.so
LoadModule dav_fs_module libexec/apache22/mod_dav_fs.so
LoadModule vhost_alias_module libexec/apache22/mod_vhost_alias.so
LoadModule negotiation_module libexec/apache22/mod_negotiation.so
LoadModule dir_module libexec/apache22/mod_dir.so
LoadModule imagemap_module libexec/apache22/mod_imagemap.so
LoadModule actions_module libexec/apache22/mod_actions.so
LoadModule speling_module libexec/apache22/mod_speling.so
LoadModule userdir_module libexec/apache22/mod_userdir.so
LoadModule alias_module libexec/apache22/mod_alias.so
LoadModule rewrite_module libexec/apache22/mod_rewrite.so

<IfModule !mpm_netware_module>
<IfModule !mpm_winnt_module>

User www
Group www

</IfModule>
</IfModule>

ServerAdmin gvkv@gvCorp.com

ServerName 192.168.2.12:80

DocumentRoot /home/prosperity/html

<Directory />
    AllowOverride None
    Order deny,allow
    Deny from all
</Directory>

<Directory /home/prosperity/html>

    Options Indexes FollowSymLinks

    AllowOverride None

    Order allow,deny
    Allow from all

</Directory>

<IfModule dir_module>
    DirectoryIndex index.html
</IfModule>

<FilesMatch "^\.ht">
    Order allow,deny
    Deny from all
    Satisfy All
</FilesMatch>

ErrorLog "/var/log/httpd-error.log"

LogLevel warn

<IfModule log_config_module>

    LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
    LogFormat "%h %l %u %t \"%r\" %>s %b" common

    <IfModule logio_module>
      # You need to enable mod_logio.c to use %I and %O
      LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %I %O" combinedio
    </IfModule>

    CustomLog "/var/log/httpd-access.log" combined
</IfModule>

<IfModule alias_module>

    ScriptAlias /cgi-bin/ "/usr/local/www/apache22/cgi-bin/"

</IfModule>

<IfModule cgid_module>

</IfModule>

<Directory "/usr/local/www/apache22/cgi-bin">
    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
</Directory>

DefaultType text/plain

<IfModule mime_module>

    TypesConfig etc/apache22/mime.types

    AddType application/x-compress .Z
    AddType application/x-gzip .gz .tgz

</IfModule>

<IfModule ssl_module>
SSLRandomSeed startup builtin
SSLRandomSeed connect builtin
</IfModule>

Include etc/apache22/Includes/*.conf 
```

编辑：克里斯要求提供一些日志文件数据，所以就在这里。

一、httpd-error.log

```
[Sun Apr 19 22:37:35 2009] [notice] Digest: done
[Sun Apr 19 22:37:36 2009] [notice] Apache/2.2.9 (FreeBSD) mod_ssl/2.2.9 OpenSSL/0.9.8e DAV/2 configured -- resuming normal operations
[Mon Apr 20 00:00:28 2009] [notice] caught SIGTERM, shutting down
[Mon Apr 20 00:01:18 2009] [warn] Init: Session Cache is not configured [hint: SSLSessionCache]
[Mon Apr 20 00:01:19 2009] [notice] Digest: generating secret for digest authentication ...
[Mon Apr 20 00:01:19 2009] [notice] Digest: done
[Mon Apr 20 00:01:20 2009] [notice] Apache/2.2.9 (FreeBSD) mod_ssl/2.2.9 OpenSSL/0.9.8e DAV/2 configured -- resuming normal operations
[Mon Apr 20 00:01:26 2009] [error] [client 192.168.2.10] (13)Permission denied: access to / denied
[Mon Apr 20 00:01:54 2009] [error] [client 192.168.2.12] (13)Permission denied: access to / denied
[Mon Apr 20 00:02:12 2009] [error] [client 192.168.2.12] (13)Permission denied: access to /home/prosperity/html/index.html denied 
```

二、httpd-access.log：

```
192.168.2.12 - - [19/Apr/2009:21:31:40 -0400] "GET / " 403 202 "-" "-"
192.168.2.10 - - [19/Apr/2009:21:51:07 -0400] "GET / HTTP/1.1" 403 202 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.8) Gecko/2009032609 Firefox/3.0.8 (.NET CLR 3.5.30729)"
192.168.2.12 - - [19/Apr/2009:22:00:29 -0400] "GET / " 403 202 "-" "-"
192.168.2.12 - - [19/Apr/2009:22:00:54 -0400] "GET /home/prosperity/test.html" 403 227 "-" "-"
192.168.2.12 - - [19/Apr/2009:22:01:13 -0400] "GET /home/prosperity/index.html" 403 228 "-" "-"
127.0.0.1 - - [19/Apr/2009:22:07:00 -0400] "GET / HTTP/1.0" 403 202 "-" "-"
192.168.2.12 - - [19/Apr/2009:22:13:12 -0400] "GET /home/prosperity/html/test.html" 403 232 "-" "-"
192.168.2.10 - - [20/Apr/2009:00:01:26 -0400] "GET / HTTP/1.1" 403 202 "-" "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.8) Gecko/2009032609 Firefox/3.0.8 (.NET CLR 3.5.30729)"
192.168.2.12 - - [20/Apr/2009:00:01:54 -0400] "GET /" 403 202 "-" "-"
192.168.2.12 - - [20/Apr/2009:00:02:12 -0400] "GET /home/prosperity/html/index.html" 403 233 "-" "-" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T04:14:55.690

看起来**/home/prosperity/html**从错误日志中获得了错误的权限。

它应该可以按组读取：**www**和用户：http.conf 中定义的**www**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T03:54:00.590

启动时是否启用了 PF？

您可以检查**/etc/rc.conf**中的以下内容：

```
pf_enable="YES" 
```

如果是这样，那么它可能会阻止 telnet 和 http 传入连接。您可以在**/etc/pf.rules**中为 telnet/apache 添加规则，也可以将上述设置更改为**"NO"**。

您还确定两个守护程序都在启动时重新启动吗？根据您安装和配置 telnet 和 Apache 的方式，它们可能缺少正确的设置以在启动时自动启动。

再次检查**/etc/rc.conf**是否有类似的内容：

```
apache_enable="YES" 
```

或者

```
apache22_enable="YES" 
```

正如克里斯在评论中所说，如果不从日志中了解更多信息，很难猜测。

还要仔细检查您是否**确实**有一个 IP 地址。嘿，你永远不知道。

# c# - 在 C# 中填充文本表单和可点击的文本表单

> ID：766804
> 
> 赞同：0
> 
> 时间：2009-04-20T03:40:17.287
> 
> 标签：c#, winforms

我有一个 Windows 窗体应用程序我有一个打开 SaveFileFrom 对话框的按钮

```
private void button1_Click(object sender, EventArgs e)
{
  SaveFileDialog savefileDialog1 = new SaveFileDialog();
  savefileDialog1.ShowDialog();
} 
```

我想知道如何将选择的文件放在文本框中，即使这样

```
private void textBox1_TextChanged(object sender, EventArgs e)
{

} 
```

UPDATE* 好的，因为用户可能想要打开多个文件来保存我想取消我的按钮 SaveFileFrom 并在单击时使文本框通过 OpenFileDialog 运行。另外，他们是制作文本链接而不是按钮的方法吗？就像我想要一个文本链接来添加另一个文本框/

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T03:44:19.553

尝试这个

```
private void button1_Click(object sender, EventArgs e)
{
  SaveFileDialog savefileDialog1 = new SaveFileDialog();
  if (savefileDialog1.ShowDialog() == DialogResult.OK)
  {
    textBox1.Text = savefileDialog1.Filename;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T03:46:54.557

选择的文件名将保存在 SaveFileDialog.FileName

例子：

```
private void button1_Click(object sender, EventArgs e)
{

SaveFileDialog SvDlg = new SaveFileDialog();

  if (SvDlg.ShowDialog() == DialogResult.OK)
  {
      textBox1.Text = SvDlg.FileName;
  }
  else 
  {
      MessageBox.Show("No file selected.");
  }

} 
```

# mysql - utf8_general_ci 和 utf8_unicode_ci 有什么区别？

> ID：766809
> 
> 赞同：1226
> 
> 时间：2009-04-20T03:43:49.213
> 
> 标签：mysql, unicode, utf-8, collation, character-set

`utf8_general_ci`和之间`utf8_unicode_ci`，在性能方面有什么区别吗？

* * *

## 回答 #1

> 赞同：1837
> 
> 时间：2009-04-20T05:19:47.703

**对于那些在 2020 年或之后仍会遇到这个问题的人，有可能比*这两个*更好的新选项。例如，`utf8mb4_0900_ai_ci`。**

所有这些排序规则都用于 UTF-8 字符编码。不同之处在于文本的排序和比较方式。

`_unicode_ci`并且`_general_ci`是根据我们期望的方式对文本进行排序和比较的两组不同的规则。较新版本的 MySQL 也引入了新的规则集，例如`_0900_ai_ci`基于 Unicode 9.0 的等效规则 - 并且没有等效`_general_ci`变体。现在阅读本文的人可能应该使用这些较新的排序规则之一，而不是使用`_unicode_ci`or `_general_ci`。下面对那些较旧的排序规则的描述仅供参考。

*MySQL 目前正在从旧的、有缺陷的 UTF-8 实现过渡。现在，您需要使用`utf8mb4`而不是`utf8`字符编码部分，以确保您获得的是固定版本。有缺陷的版本仍然是为了向后兼容，尽管它已被弃用。*

**主要区别**

*   `utf8mb4_unicode_ci`基于官方 Unicode 规则进行通用排序和比较，可在多种语言中准确排序。

*   `utf8mb4_general_ci`是一组简化的排序规则，旨在尽其所能，同时采取许多旨在提高速度的捷径。它不遵循 Unicode 规则，并且在某些情况下会导致不希望的排序或比较，例如在使用特定语言或字符时。

    在现代服务器上，这种性能提升几乎可以忽略不计。它是在服务器的 CPU 性能只有当今计算机的一小部分时设计的。

**`utf8mb4_unicode_ci`超过的好处`utf8mb4_general_ci`**

`utf8mb4_unicode_ci`，它使用 Unicode 规则进行排序和比较，采用相当复杂的算法在各种语言中以及在使用各种特殊字符时正确排序。这些规则需要考虑特定语言的约定；不是每个人都按照我们所说的“字母顺序”对他们的字符进行排序。

就拉丁语（即“欧洲”）语言而言，Unicode 排序和 MySQL 中的简化排序没有太大区别`utf8mb4_general_ci`，但仍有一些区别：

*   例如，Unicode 排序规则将“ß”排序为“ss”，将“Œ”排序为“OE”，因为使用这些字符的人通常需要这些字符，而将`utf8mb4_general_ci`它们排序为单个字符（大概分别像“s”和“e”） .

*   一些 Unicode 字符被定义为可忽略，这意味着它们不应该计入排序顺序，并且比较应该转到下一个字符。 `utf8mb4_unicode_ci`妥善处理这些。

在非拉丁语言中，例如亚洲语言或具有不同字母表的语言，Unicode 排序和简化排序之间可能存在*更多*差异`utf8mb4_general_ci`。will的适用性在`utf8mb4_general_ci`很大程度上取决于所使用的语言。对于某些语言，这将是非常不充分的。

**你应该用什么？**

几乎可以肯定没有理由再使用`utf8mb4_general_ci`了，因为我们已经忽略了 CPU 速度足够低以至于性能差异很重要的点。您的数据库几乎肯定会受到除此之外的其他瓶颈的限制。

过去，有些人建议使用，`utf8mb4_general_ci`除非准确排序足够重要以证明性能成本是合理的。如今，这种性能成本几乎消失了，开发人员正在更加认真地对待国际化。

有一个论点是，如果速度对您来说比准确性更重要，那么您可能根本不进行任何排序。如果您不需要准确的算法，那么使算法更快是微不足道的。因此，`utf8mb4_general_ci`出于速度原因可能不需要妥协，也可能出于准确性原因也不适合。

我要补充的另一件事是，即使您知道您的应用程序只支持英语，它可能仍需要处理人名，这些人名通常包含其他语言中使用的字符，在这些语言中正确排序同样重要. 对所有事情都使用 Unicode 规则有助于让您更加安心，因为非常聪明的 Unicode 人员已经非常努力地工作以使排序正常工作。

**零件是什么意思**

首先，`ci`用于*不区分大小写的*排序和比较。这意味着它适用于文本数据，大小写并不重要。其他类型的排序规则是`cs`（区分大小写）对于大小写很重要的文本数据`bin`，对于需要匹配编码的情况，逐位匹配，这适用于真正编码二进制数据的字段（包括，例如， Base64）。区分大小写的排序会导致一些奇怪的结果，区分大小写的比较可能会导致重复值仅在字母大小写上有所不同，因此区分大小写的排序规则对文本数据不受欢迎 - 如果大小写对您很重要，那么标点符号就可以忽略等等可能也很重要，二进制排序规则可能更合适。

接下来，`unicode`or`general`指的是具体的排序和比较规则——特别是文本被规范化或比较的方式。utf8mb4 字符编码有许多不同的规则集，其中有`unicode`两个规则`general`试图在所有可能的语言中都很好地工作，而不是一种特定的语言。这两组规则之间的差异是此答案的主题。请注意，`unicode`使用 Unicode 4.0 中的规则。MySQL 的最新版本`unicode_520`使用 Unicode 5.2 中的规则添加规则集，并且`0900`（删除“unicode_”部分）使用 Unicode 9.0 中的规则。

最后，`utf8mb4`当然是内部使用的字符编码。在这个答案中，我只谈论基于 Unicode 的编码。

* * *

## 回答 #2

> 赞同：192
> 
> 时间：2013-03-02T02:53:57.277

我想知道使用`utf8_general_ci`和之间的性能差异是什么`utf8_unicode_ci`，但我没有在互联网上找到任何基准，所以我决定自己创建基准。

我创建了一个包含 500,000 行的非常简单的表：

```
CREATE TABLE test(
  ID INT(11) DEFAULT NULL,
  Description VARCHAR(20) DEFAULT NULL
)
ENGINE = INNODB
CHARACTER SET utf8
COLLATE utf8_general_ci; 
```

然后我通过运行这个存储过程用随机数据填充它：

```
CREATE PROCEDURE randomizer()
BEGIN
  DECLARE i INT DEFAULT 0;
  DECLARE random CHAR(20) ;
  theloop: loop
    SET random = CONV(FLOOR(RAND() * 99999999999999), 20, 36);
    INSERT INTO test VALUES (i+1, random);
    SET i=i+1;
    IF i = 500000 THEN
      LEAVE theloop;
    END IF;
  END LOOP theloop;
END 
```

然后我创建了以下存储过程来对 simple `SELECT`、`SELECT`with`LIKE`和排序（`SELECT`with `ORDER BY`）进行基准测试：

```
CREATE PROCEDURE benchmark_simple_select()
BEGIN
  DECLARE i INT DEFAULT 0;
  theloop: loop
    SELECT *
    FROM test
    WHERE Description = 'test' COLLATE utf8_general_ci;
    SET i = i + 1;
    IF i = 30 THEN
      LEAVE theloop;
    END IF;
  END LOOP theloop;
END;

CREATE PROCEDURE benchmark_select_like()
BEGIN
  DECLARE i INT DEFAULT 0;
  theloop: loop
    SELECT *
    FROM test
    WHERE Description LIKE '%test' COLLATE utf8_general_ci;
    SET i = i + 1;
    IF i = 30 THEN
      LEAVE theloop;
    END IF;
  END LOOP theloop;
END;

CREATE PROCEDURE benchmark_order_by()
BEGIN
  DECLARE i INT DEFAULT 0;
  theloop: loop
    SELECT *
    FROM test
    WHERE ID > FLOOR(1 + RAND() * (400000 - 1))
    ORDER BY Description COLLATE utf8_general_ci LIMIT 1000;
    SET i = i + 1;
    IF i = 10 THEN
      LEAVE theloop;
    END IF;
  END LOOP theloop;
END; 
```

在上面的存储过程`utf8_general_ci`中使用了排序规则，但当然在测试期间我同时使用了`utf8_general_ci`和`utf8_unicode_ci`.

我为每个排序规则调用了每个存储过程 5 次（5 次 for`utf8_general_ci`和 5 次 for `utf8_unicode_ci`），然后计算平均值。

我的结果是：

**`benchmark_simple_select()`**

*   与`utf8_general_ci`：9,957 毫秒
*   : 10,271`utf8_unicode_ci`毫秒

在这个基准测试中，使用`utf8_unicode_ci`速度比`utf8_general_ci`3.2% 慢。

**`benchmark_select_like()`**

*   与`utf8_general_ci`：11,441 毫秒
*   与`utf8_unicode_ci`：12,811 毫秒

在这个基准测试中，使用`utf8_unicode_ci`速度比`utf8_general_ci`12% 慢。

**`benchmark_order_by()`**

*   : 11,944`utf8_general_ci`毫秒
*   与`utf8_unicode_ci`：12,887 毫秒

在这个基准测试中，使用`utf8_unicode_ci`速度比`utf8_general_ci`7.9% 慢。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2010-01-01T00:31:31.277

[这篇文章](http://forums.mysql.com/read.php?103,187048,188748#msg-188748)很好地描述了它。

简而言之：`utf8_unicode_ci`使用 Unicode 标准中定义的 Unicode 排序算法，然而`utf8_general_ci`是一种更简单的排序顺序，导致“不太准确”的排序结果。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-20T04:09:58.073

请参阅 mysql 手册，[Unicode 字符集](http://dev.mysql.com/doc/refman/5.0/en/charset-unicode-sets.html)部分：

> 对于任何 Unicode 字符集，使用 _general_ci 归类执行的操作都比使用 _unicode_ci 归类执行的操作快。例如，utf8_general_ci 排序规则的比较比 utf8_unicode_ci 的比较更快，但正确性稍差。原因是 utf8_unicode_ci 支持扩展等映射；也就是说，当一个字符比较等于其他字符的组合时。例如，在德语和其他一些语言中，“ß”等于“ss”。utf8_unicode_ci 还支持缩写和可忽略的字符。utf8_general_ci 是不支持扩展、收缩或可忽略字符的传统排序规则。它只能在字符之间进行一对一的比较。

总而言之， utf_general_ci 使用比*应该*实现整个标准的 utf_unicode_ci 更小且更不正确（根据标准）的比较集。general_ci 集会更快，因为要做的计算更少。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-03-06T11:51:10.697

**简而言之：**

如果您需要更好的排序顺序 - 使用`utf8_unicode_ci`（这是首选方法），

但如果你对性能使用完全感兴趣`utf8_general_ci`，但知道它有点过时了。

性能方面的差异非常小。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2018-11-20T08:00:37.837

## 一些细节（PL）

正如我们[在这里](https://bugs.mysql.com/bug.php?id=9604%20%E2%80%93%20user3399549%20Mar%209%20%2714%20at%2021:15)所读到的（**Peter Gulutzan**），在排序/比较波兰字母“Ł”（带有笔划的 L - html esc: `&#321;`）（小写：“ł” - html esc: `&#322;`）方面存在差异 - 我们有以下假设：

```
utf8_polish_ci      Ł greater than L and less than M
utf8_unicode_ci     Ł greater than L and less than M
utf8_unicode_520_ci Ł equal to L
utf8_general_ci     Ł greater than Z 
```

在波兰语中，字母`Ł`是在字母之后`L`和之前`M`。这种编码没有一个更好或更坏 - 这取决于您的需求。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-12-06T18:31:40.897

排序和字符匹配有两个很大的区别：

**排序**：

*   `utf8mb4_general_ci`删除所有重音并一一排序，这可能会产生错误的排序结果。
*   `utf8mb4_unicode_ci`排序准确。

**字符匹配**

它们以不同的方式匹配字符。

例如， in `utf8mb4_unicode_ci`you have `i != ı`，但 in `utf8mb4_general_ci`it 持有`ı=i`。

例如，假设您有一排`name="Yılmaz"`. 然后

```
select id from users where name='Yilmaz'; 
```

如果 collocation is 将返回该行`utf8mb4_general_ci`，但如果它与之并置`utf8mb4_unicode_ci`则**不会**返回该行！

另一方面，我们有那个，`a=ª`而`ß=ss`在`utf8mb4_unicode_ci`其中不是这种情况`utf8mb4_general_ci`。所以想象你有一行`name="ªßi"`，然后

```
select id from users where name='assi'; 
```

如果 collocation 是 将返回行`utf8mb4_unicode_ci`，但如果 collocation 设置为 则**不会**返回行`utf8mb4_general_ci`。

可以在[此处](http://mysql.rjweb.org/utf8_collations.html)找到每个搭配的完整匹配列表。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-22T23:59:17.920

根据这篇文章，当使用 utf8mb4_general_ci 而不是 utf8mb4_unicode_ci 时，MySQL 5.7 有相当大的性能优势： [https ://www.percona.com/blog/2019/02/27/charset-and-collat​​ion-settings-impact -关于-mysql-性能/](https://www.percona.com/blog/2019/02/27/charset-and-collation-settings-impact-on-mysql-performance/)

# php - 当我尝试使用 --with-gd 制作 php 时，我收到“configure: error: libpng.(a|so) not found”的错误消息。怎么了？

> ID：766810
> 
> 赞同：2
> 
> 时间：2009-04-20T03:44:02.253
> 
> 标签：php, gd, libpng

到目前为止，我已经确定我已经使用 DarwinPorts 安装了 libpng 和 libjpeg（我在 OS X Leopard 上运行），但这似乎并没有奏效。我已经在许多地方读到了您需要开发文件（即 libpng-devel 等）来完成这项工作。我有点失落。有人可以帮我理解我应该做什么吗？我很乐意提供更多必要的信息。

我的 PHP 配置如下：

```
./configure '--with-png-dir=/usr/local' '--with-jpeg-dir=/usr/local' '--with-gd'
```

我正在尝试安装 PHP 5.2.9。如果没有“--with-gd”选项，我就可以正常工作。我也一直在复制我在各个网站上找到的内容，所以我可能做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T05:31:29.920

此错误表示找不到 libpng.so 或 libpng.a 文件。这些文件是在编译 libpng 时创建的。

我不太了解 Mac OS X 的安装方式，但如果你想以 Mac OS X 的方式安装，你可能需要找到并安装 libpng-devel 包。

否则，您需要获取 libpng 的源代码并自行编译。它取决于 zlib，您可能已经拥有共享库，但如果没有，您也必须获得它。

[这是在 Mac OS X 上编译 libpng 的指南](http://kenno.wordpress.com/2006/04/20/compiling-libpng-for-mac-os-x/)。它有一个特定于达尔文的 Makefile（不知道为什么需要它，但值得一试）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-23T05:51:27.477

我相信 MacPorts 默认安装到 /opt/local 而不是 /usr/local？也许尝试 /opt/local 代替？

如果你有 fink，这就是我目前正在使用的（所以我知道它有效）

这是我安装的 fink 软件包。

```
 i  libpng3 1:1.2.29-1  PNG image format handling library
 i  libpng3-shlibs  1:1.2.29-1  Shared libraries for libpng3 package

 i  libjpeg 6b-17   JPEG image format handling library
 i  libjpeg-bin 6b-17   Executables for libjpeg package
 i  libjpeg-shlibs  6b-17   Shared libraries for libjpeg package 
```

然后配置我使用的 php 的那些部分

```
'--with-gd' \
'--with-jpeg-dir=/sw' \
'--with-png-dir=/sw' \ 
```

# php - 用现有数据填充文本区域/字段

> ID：766815
> 
> 赞同：1
> 
> 时间：2009-04-20T03:45:55.760
> 
> 标签：php, html

我有一个编辑用户信息的页面，我希望显示当前信息并允许对其进行编辑，以避免覆盖现有信息。

目前，我正在获取数据并将其显示在文本区域中，如下所示：

```
$usernameQuery = "select username, firstname from USERS where username = '" . $con->escape_string($username) . "'";     

$xblah = $con->query($usernameQuery);
  while ($row = mysqli_fetch_assoc($xblah))
  {
    $checkUsername = $row['username'];
    $checkFirstName = $row['firstname'];
   }

echo "<form name=\"userForm\">
<h1>Editing information for: ".$username."</h1>
<p>
First name:
<textarea rows=\"1\" id=\"firstname\">".$checkFirstName."</textarea>
<br />
</form>" 
```

由于指定一行时显示两行的[错误](https://bugzilla.mozilla.org/show_bug.cgi?id=33654)，此文本区域在 Firefox 中无法正确显示。有没有办法用输入类型=文本做同样的事情？

另外，目前，数据库中 firstname 的内容是我的测试记录的 john，但 var_dump($checkFirstName) 仅显示 s。我必须做什么才能获得该字段的实际内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T04:04:27.757

> 有没有办法用输入类型=文本做同样的事情？

```
<input type="text" name="firstname" value="<?= $checkFirstName ?>" /> 
```

至于您的其他问题，是否有另一个用户的名字为“s”，但也与名字为“john”的用户具有相同的用户名？我这么说的原因是您使用`while`循环来获取数据，因此如果有多个匹配项，您将留下与您的查询匹配的最后一行。

解决此问题的可能方法包括不使用`while`循环（这意味着您要获取/处理多行数据）并确保所有用户名都是唯一的。

除此之外，我不明白为什么从中获取的值`'firstname'`与数据库中的值不匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T04:02:24.707

使用输入标签的“值”属性。

```
First name: <input type=\"text\" name=\"name\" value=\"$checkFirstName\"/><br /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T04:04:12.110

如果你使用 input type=text 输入，那么你在 value 属性中输入的任何东西都会默认显示出来。

```
echo '<input type="text" value="' . $checkFirstName . '">'; 
```

当然，您需要确保在将 $checkFirstName 输出到该字段之前对其进行一些清理，以防万一。

至于获取字段的值，请在您的 while 循环之前尝试 var_dumping $row ，看看您是否可以找出问题所在。如果它没有显示任何有用的信息，也许 var_dump 在你的 while 循环中，在每次迭代之间有一个很好的 < hr > ？这应该让您全面了解从查询中完整返回的内容。另外，如果 var_dump 对您来说信息太多，请查看：

```
print_r($var) 
```

[print_r 文档](http://us.php.net/print_r "打印 r 文档")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T08:42:59.257

textareas 旨在显示带有换行符的多行文本。用户名和名字通常不包含这些，因此最好使用该`input`元素

```
<?php
    echo '<input type="text" name="name" value="' . htmlentities($checkFirstName) . '">';
?> 
```

不要忘记`htmlentities`or `htmlspecialchars`（取决于编码 - 如果您的编码是 unicode，htmlspecialchars 应该就足够了，否则它的 htmlentities）。不要`htmlentities`只用于表单字段，而是在打印用户提供的数据时使用。否则有人可能会`cross site scripting`通过提供类似的用户名来注入 xss ( ) 攻击或至少生成错误的 html

```
<script type="text/javascript">execute_evil_code();</script> 
```

至于只显示一个字符而不是一个完整的字符串：通常，如果你认为你正在使用一个数组而不是一个字符串，就会发生这种情况。用于`var_dump($variable);`查看变量的类型。

另外，正如 htw 所说，检查是否`$username`真的是独一无二的，并且你得到了正确的行。在 phpmyadmin（或您正在使用的任何工具）中运行生成的查询 ( `echo $usernameQuery;`)。如果返回多行，则您的用户名不是唯一的（可能本身就是一个错误），并且您获得的行也不是第一行，而是最后一行。这很奇怪，因为 's' 不是“john”的一部分，所以也许 mysql 结果集是完全不同的东西。在更高级别进行调试，以及`var_dump`整个 $row.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-05T06:08:51.710

试着把你所有的 php 代码放在这里：

```
 <textarea id="firstname" rows="1">
        <?php
              //connect to database
              //Select data
            if(mysql_num_rows($sql)) {
                 $row = mysql_fetch_row($sql);
                  echo nl2br($row['0']);
            }
        ?>
   </textarea> 
```

# c++ - 为什么这在 C 中编译而不是 C++（sigaction）？

> ID：766816
> 
> 赞同：3
> 
> 时间：2009-04-20T03:46:27.723
> 
> 标签：c++, c, g++

尝试使用 g++ 编译以下代码时出现以下错误。当我使用 gcc 编译它时，它工作正常（除了一些警告）。任何帮助表示赞赏。

```
g++ ush7.cpp
ush7.cpp: In function ‘int signalsetup(sigaction*, sigset_t*, void (*)(int))’:
ush7.cpp:93: error: expected unqualified-id before ‘catch’
ush7.cpp:95: error: expected primary-expression before ‘catch’
ush7.cpp:95: error: expected `;' before ‘catch’
ush7.cpp:97: error: expected primary-expression before ‘catch’
ush7.cpp:97: error: expected `;' before ‘catch’
ush7.cpp:100: error: expected primary-expression before ‘catch’
ush7.cpp:100: error: expected `)' before ‘catch’
ush7.cpp:108: error: expected `)' before ‘;’ token
ush7.cpp:108: error: expected `)' before ‘;’ token
ush7.cpp: In function ‘int makeargv(const char*, const char*, char***)’:
ush7.cpp:137: error: invalid conversion from ‘void*’ to ‘char*’
ush7.cpp:145: error: invalid conversion from ‘void*’ to ‘char**’ 
```

* * *

```
int signalsetup(struct sigaction *def, sigset_t *mask, void (*handler)(int))
{
   struct sigaction catch;

   catch.sa_handler = handler;  /* Set up signal structures  */
   def->sa_handler = SIG_DFL;
   catch.sa_flags = 0;
   def->sa_flags = 0;
   if ((sigemptyset(&(def->sa_mask)) == -1) ||
       (sigemptyset(&(catch.sa_mask)) == -1) ||
       (sigaddset(&(catch.sa_mask), SIGINT) == -1) ||
       (sigaddset(&(catch.sa_mask), SIGQUIT) == -1) ||
       (sigaction(SIGINT, &catch, NULL) == -1) ||
       (sigaction(SIGQUIT, &catch, NULL) == -1) ||
       (sigemptyset(mask) == -1) ||
       (sigaddset(mask, SIGINT) == -1) ||
       (sigaddset(mask, SIGQUIT) == -1))
       return -1;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-20T03:48:22.897

`catch`是 C++ 中的关键字，但不是 C 中的关键字。

请参阅我的相关答案 C 不是 C++ 的适当子集[，](https://stackoverflow.com/questions/304088/is-c-code-still-considered-c/304091#304091)甚至更好[。](https://stackoverflow.com/questions/145096/is-c-actually-a-superset-of-c#145098)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T04:12:39.703

如果您不想更改其余代码，您应该可以使用#define。

```
#define catch _catch 
```

# ruby - Ruby 和 Groovy 中的块之间有什么显着差异吗？

> ID：766822
> 
> 赞同：5
> 
> 时间：2009-04-20T03:49:53.363
> 
> 标签：ruby, groovy

我在 Ruby 中使用块，并希望在 Java 中使用它们。Groovy 似乎提供了类似的功能，但我对 Groovy 的了解还不够，无法理解在语法和功能上是否存在任何显着差异。

Ruby 块是否等同于 Groovy 块？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T03:52:46.943

不是100%。Ruby 块要求您命名所有参数（据我所知）。Groovy 中未指定参数的块有一个隐含参数`it`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T11:30:10.027

块在某种意义上只是一个任意函数。我从未编写过 java，但这里有一些其他语言的代码示例，向您展示块类似于传递匿名函数。

红宝石：

```
def add_5
  puts yield + 5
end

add_5 { 20 }
# => 25 
```

Javascript：

```
var add_5 = function(callback){
  return callback.call() + 5;
}

add_5(function(){ return 20 });
// returns 25 
```

卢阿：

```
local function add_5(callback)
  print(callback() + 5);
end

add_5(function()
  return 20;
end)
-- returns 25 
```

换句话说，如果 Java 支持这样的匿名函数，那么你就给自己一个障碍！由于它们是函数，它们可以接受参数，就像块一样。这是另一个 Lua 示例：

```
local function add_something(callback)
  callback(5 / 2);
end

add_something(function(a)
  print(a + 5);
end)
-- 7.5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T19:53:45.917

我不是 100% 熟悉 Ruby，但我认为答案是否定的。看看[文档](http://groovy.codehaus.org/JN2515-Closures)。

# apache-flex - Flex 文本控制撤消

> ID：766823
> 
> 赞同：3
> 
> 时间：2009-04-20T03:50:00.150
> 
> 标签：apache-flex, undo, rich-text-editor

我无法找到任何资源来将 ctrl-z 撤消功能添加到 Flex RichTextEditor 控件（它显然与其他 Flex 文本控件共享的缺失）。我很困惑它不是原生形式，因为它是如此基本的功能，我相信甚至可以在标准浏览器文本控件中使用。

Flex 网站上的任何提及此问题的（有几个）冲突；有人说问题是“已解决”，而解决方案是“外部”（无论这意味着什么）。

有没有人可以提供任何见解？我有一个需要大量文本编辑的应用程序。Flex 通常运行良好，但正如任何人想象的那样，这种微不足道的缺陷几乎是致命的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T02:42:15.467

可以在此处找到使用 Flight Framework 轻松实现撤消/重做的示例：[http ://www.xtyler.com/code/163](http://www.xtyler.com/code/163)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T04:16:01.193

Flex 3 控件本身不支持撤消/重做。以下是您可能感兴趣的几个库：

*   [屈曲多雷多](http://code.google.com/p/flexundoredo/)
*   [as3取消历史](http://code.google.com/p/as3undohistory/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T14:11:19.530

我在其他地方读到过——事实上，在我关于 SO 的问题之一的答案中——这个问题不会在 Flex 3 中得到解决。这似乎是正确的，因为我们处于 3.2 甚至更高版本，并且看不到撤消。

我很勇敢/愚蠢地自己在这个组件中实现了撤消重做。那时我在 Windows 上工作。现在我在 OSX 上，我意识到我的解决方案是多么的非跨平台。问题的陈述（添加 ctrl-z 撤消功能）是问题的很大一部分（OSX 具有控制和这个 Apple 关键的东西）。现在我必须检查要让这个东西跨平台需要多少工作......可能是微不足道的。

巧合的是，就在今天，我一直在考虑不使用 RichTextEditor 而是使用外部的东西（想到 FckEditor），因为 RTE 有很多不足之处（因此我遇到了你的问题）。我已经与 RTE 合作了很多，并让它做很多我想做的事情，但我仍然想知道为什么他们没有“完成”这个组件......

# c - 如何在本地管理 C 手册？

> ID：766830
> 
> 赞同：0
> 
> 时间：2009-04-20T03:52:58.737
> 
> 标签：c

我的谷歌搜索会导致大量不必要的 C 搜索结果。我希望在本地获得最好的 C 手册。我发现这里的参考很有用[。](http://www.acm.uiuc.edu/webmonkeys/book/c_guide/)我想自己做笔记并删除手册。

> 我可以像本地手册一样管理它吗？

**对担心法律的回复者的反馈**

请阅读[这篇](https://stackoverflow.com/questions/1009815/iframes-and-law/1072208#1072208)关于一些法律哲学的文章：

1.  商业法
2.  物权法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T03:59:29.953

我不确定作者是否希望您复制他们的作品。所以我的回答不适用于您关于在本地管理手册的问题。您可以做的一件事是使用[网络注释工具](http://www.makeuseof.com/tag/web-annotation-tools-research-annotate-collaborate/)来管理您自己的笔记。请注意顶部那个讨厌的小通知“ **© 版权所有 1997 Eric Huss** ”，请尊重它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T04:00:18.453

您可以使用 wget 之类的工具来获取站点并将其存储在本地。

然后，您可以自己编辑页面，添加/删除您认为合适的内容。

这对我有用：

```
 wget --mirror -w 2 -p --convert-links http://www.acm.uiuc.edu/webmonkeys/book/c_guide/ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T06:14:05.247

大多数答案都提出了事物的合法性或缺乏合法性。

实际上，我不太确定将网站的本地副本严格用于个人使用是否构成侵犯版权。

首先，没有提及此人所在的位置，因此我们甚至不知道适用哪些版权法。例如，加拿大和澳大利亚对个人使用合法获得的财产有一些明确的立场，我相信美国也有一些类似的裁决。

其次，通过访问网站，您会自动使用称为浏览器的软件制作个人副本。我相信这不是侵犯版权。

如果用户使用某种离线浏览器（如 wget）来访问该网站并将其存储在他的硬盘上，我不明白为什么无论如何都会禁止这样做。

前因和背景也很重要。如果您认为大多数网站都已存档并由 Wayback 机器公开提供（请参阅[http://web.archive.org/web/](http://web.archive.org/web/) */ [http://www.acm.uiuc.edu/webmonkeys/book/c_guide](http://www.acm.uiuc.edu/webmonkeys/book/c_guide)） ，这是一种没有受到质疑的用法（archive.org 位于美国），很难对旨在作为个人参考的私人副本提出有效的论据。

简而言之，我认为制作网站的个人副本供严格私人使用并不违反大多数国家/地区的现行版权法。

另一方面，分发上述副本将是完全不同的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T04:00:08.253

查看[http://www.acm.uiuc.edu/webmonkeys/book/](http://www.acm.uiuc.edu/webmonkeys/book/)，您将看到 ac guide tar 文件。我怀疑你可以下载那个文件，在你的本地系统上展开它，然后随意注释。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-20T04:01:46.440

是的，要做到这一点，请使用您的浏览器、wget 或您可用的任何工具下载整个手册。接下来为硬盘上的文件创建一个书签，或者安装一个本地网络服务器以链接到。最后，您可以通过编辑文件或使用 ojblas 建议的注释来添加注释。

另外，还有一个我觉得很方便的，一些[comp.lang.c](http://c-faq.com/index.html)帖子的存档。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T04:00:14.383

好吧，首先，您可以购买[Harbison 和 Steele](http://www.careferencemanual.com/)。

你链接的那个被标记为版权 1997，所以我建议你写信给作者 e-huss@uiuc.edu 并征求许可。但是没有什么可以阻止您使用[wget](http://linuxreviews.org/man/wget/)下载副本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T04:00:04.353

您可以将网页（“保存网页完成”）保存到本地驱动器。

还有很多 C 手册的 PDF 版本。在 google 上搜索“c manual pdf”——第一个结果是 Dennis Ritchie 的。

（但请注意侵犯版权，我不清楚您何时可以在“合理使用”下制作个人副本。）

如果你在 Unix 上，很多 C 库都可以作为手册页使用。例如“man memcpy”、“man malloc”等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T04:02:30.227

大多数 C 函数已在您的系统的联机帮助页中进行了描述。例如，`man floor`将为您提供 floor 函数的文档。有时函数和命令行程序之间存在冲突。一个很好的例子就是为您提供命令 ( )`man printf`的联机帮助页。在页面的末尾，您通常会找到一个列出其他地方的部分。在这种情况下，您应该看到. 您可以通过说显示该页面。`printf``printf(1)``SEE ALSO``printf(3)``man 3 printf`

# c# - .NET C# 应用程序中 DataGridViewRow 的性能缓慢

> ID：766844
> 
> 赞同：4
> 
> 时间：2009-04-20T04:01:25.003
> 
> 标签：c#, datagridview

我试图找出我支持的应用程序中的一些行为。片段是：

```
foreach (DataGridViewRow pGridRow in grdEmail.Rows)
{
    pGridRow.Cells[0].Value = chkSelectAll.Checked;
    pCount = pGridRow.Index + 1;
} 
```

这实际上是在单击全选复选框时尝试选择网格中的所有行（选中一个框）。

当网格有几行（一百左右）时，它工作得很好。但是，当我有大约 5000 行时，这个东西就会爬行。该`pGridRow.Cells[0].Value = chkSelectAll.Checked`命令需要一秒钟左右（通过将 Console.prints 放在其上方和下方来计时）。

在解决这个问题时，任何想法都会受到赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T08:53:25.603

尝试设置属性：

```
grdEmail.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.None;
grdEmail.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.None; 
```

因为对于这两个属性的其他值，DataGridView 似乎正在尝试调整行和列的大小，即使您只检查了网格中的一些复选框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T16:51:21.423

一次显示数千行是浪费的，并且使用户很难找到他们需要的数据。我肯定会推荐分页。您的用户会感谢您。（除非他们特别要求立即查看 5000，这似乎很愚蠢。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T05:58:06.487

Try modifying the underlying datasource (if any) directly instead of setting the value of the cell.

```
//assuming datasetFoo.Tables(0) is the DataSource of the DataGridView
foreach (DataRow rowFoo in datasetFoo.Tables(0) { 
        rowFoo ("Sel") = chkSelectAll.Checked; 
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T04:07:30.747

一次显示 5000 行有什么意义？

这个不能分页吗？
不能默认发送复选框吗？

# java - 使用 Scanner 读取文件：为什么在 java 中使用 Scanner 读取文件时出现错误？

> ID：766846
> 
> 赞同：1
> 
> 时间：2009-04-20T04:01:49.637
> 
> 标签：java, file, java.util.scanner

这个例子演示了使用Scanner逐行读取文件（它不执行写操作）我不知道为什么我尝试编译时会出错。有人可以向我解释原因吗？我正在使用 jcreatorLE 和 JDK 1.6 来运行我的程序：

```
import java.io.*;
import java.util.Scanner;

public final class File_read {

  public static void main(String... aArgs) throws FileNotFoundException {
    ReadWithScanner parser = new ReadWithScanner("C:\\Temp\\test.txt");
    parser.processLineByLine();
    log("Done.");
  }

  /**
  * @param aFileName full name of an existing, readable file.
  */
  public ReadWithScanner(String aFileName){
    fFile = new File(aFileName);  
  }

  /** Template method that calls {@link #processLine(String)}.  */
  public final void processLineByLine() throws FileNotFoundException {
    Scanner scanner = new Scanner(fFile);
    try {
      //first use a Scanner to get each line
      while ( scanner.hasNextLine() ){
        processLine( scanner.nextLine() );
      }
    }
    finally {
      //ensure the underlying stream is always closed
      scanner.close();
    }
  }

  /** 
  * Overridable method for processing lines in different ways.
  *  
  * <P>This simple default implementation expects simple name-value pairs, separated by an 
  * '=' sign. Examples of valid input : 
  * <tt>height = 167cm</tt>
  * <tt>mass =  65kg</tt>
  * <tt>disposition =  "grumpy"</tt>
  * <tt>this is the name = this is the value</tt>
  */
  protected void processLine(String aLine){
    //use a second Scanner to parse the content of each line 
    Scanner scanner = new Scanner(aLine);
    scanner.useDelimiter("=");
    if ( scanner.hasNext() ){
      String name = scanner.next();
      String value = scanner.next();
      log("Name is : " + quote(name.trim()) + ", and Value is : " + quote(value.trim()) );
    }
    else {
      log("Empty or invalid line. Unable to process.");
    }
    //(no need for finally here, since String is source)
    scanner.close();
  }

  // PRIVATE //
  private final File fFile;

  private static void log(Object aObject){
    System.out.println(String.valueOf(aObject));
  }

  private String quote(String aText){
    String QUOTE = "'";
    return QUOTE + aText + QUOTE;
  }
} 
```

这是运行它的结果：

```
--------------------Configuration: <Default>--------------------
C:\Users\administrador\Documents\File_read.java:15: invalid method declaration; return type required
  public ReadWithScanner(String aFileName){
         ^
1 error

Process completed. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T04:07:29.810

当您从[此处](http://www.javapractices.com/topic/TopicAction.do?Id=42)提取该代码时:-)，您重命名了类，但没有重命名构造函数。只有构造函数被允许没有返回类型。

我建议您将类重命名或重命名构造函数。

我希望这不是家庭作业。就目前而言，您的教育者将很容易证明抄袭。您至少需要更改变量名和类名，您可能还需要重新格式化它，包括更改类中方法的顺序。

那是如果它是家庭作业。这不是，对吧？:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T04:06:21.700

您的“ReadWithScanner”构造函数需要匹配类的名称（“File_read”）

```
public File_read(String aFileName){
    fFile = new File(aFileName);  
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T04:07:13.400

你的类被命名`File_read`，你的构造函数被命名`ReadWithScanner`。警告是您的构造函数需要与类命名相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T04:05:44.900

类的名称是 File_read，因此构造函数名称应该是 File_read，但您将名称命名为 ReadWithScanner，这就是它抱怨的原因。编译器认为它是一个方法名称，因此期望返回类型。

# c# - 将用户控件从一个 flowlayoutpanel 拖到另一个

> ID：766859
> 
> 赞同：3
> 
> 时间：2009-04-20T04:07:57.063
> 
> 标签：c#, drag-and-drop, flowlayoutpanel

如何从 2 个 flowlayoutpanels 添加自定义用户控件的拖放功能？

Usercontrol 在下面的以下代码行中一直为空

```
 private void flowLayoutPanel1_DragDrop(object sender, DragEventArgs e)
    {
        UserControl userControl = e.Data.GetData(typeof(UserControl)) as UserControl; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T04:35:02.803

您所做的问题是，要提取存储在拖动中的数据，您必须指定**确切的**类型。

```
control.DoDragDrop(new Label(), DragDropEffects.Move);

e.Data.GetDataPresent(typeof(Control)) // = false
e.Data.GetDataPresent(typeof(Label)) // = true 
```

您需要做的是创建一个包装器并将其用于您的拖放代码。

```
class ControlWrapper
{
  public Control Control { get; private set; }
  public ControlWrapper(Control control) { Control = control; }
}

control.DoDragDrop(new ControlWrapper(new Label()), DragDropEffects.Move);

e.Data.GetDataPresent(typeof(ControlWrapper)) // = true 
```

你的代码现在变成了

```
ControlWrapper controlWrapper = e.Data.GetData(typeof(ControlWrapper)) as ControlWrapper;
UserControl userControl = controlWrapper.Control as UserControl; 
```

并且尽量不要听起来太说教，但您应该首先检查数据是否以您想要的形式存在。`e.Data.GetDataPresent(typeof(ControlWrapper))`会告诉你是否是那种格式。

# button - NHAML 单选按钮语法

> ID：766860
> 
> 赞同：1
> 
> 时间：2009-04-20T04:08:26.127
> 
> 标签：button, radio-button, nhaml

有谁知道 NHAML 中选定单选按钮的正确语法？

这是我当前的 NHAML 代码：%input{type="radio", name="Relocation", value="Yes"}

非常感谢您的帮助。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T01:03:12.400

最新版本的 NHaml ( [2.0 Beta 2](http://code.google.com/p/nhaml/) ) 改变了它处理属性的方式。不要使用逗号：

```
%input{type="radio" name="Relocation" value="Yes"} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T12:46:46.910

NHaml 2.0 Beta 1 语法

```
%input{type="radio", name="Relocation", checked="true"} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-06T11:15:45.477

```
%input {type="radio" name="Relocation" checked="checked" value="TrueOrWhatever"} 
```

OR just use HtmlHelper

# unit-testing - 不变测试可以代替单元测试吗？

> ID：766867
> 
> 赞同：34
> 
> 时间：2009-04-20T04:14:35.660
> 
> 标签：unit-testing, quickcheck

作为一名程序员，我全心全意地接受 TDD 哲学，并努力为我编写的任何重要代码进行广泛的单元测试。有时这条路可能会很痛苦（行为变化导致级联多个单元测试更改；需要大量的脚手架），但总的来说，我拒绝在没有测试的情况下进行编程，每次更改后我都可以运行，而且我的代码作为结果。

最近，我一直在玩 Haskell，它是常驻测试库 QuickCheck。以一种与 TDD 截然不同的方式，QuickCheck 强调测试代码的不变量，即包含所有（或实质性子集）输入的某些属性。一个简单的例子：如果我们运行两次，一个稳定的排序算法应该给出相同的答案，应该有增加的输出，应该是输入的排列等等。然后，QuickCheck 生成各种随机数据以测试这些不变量。

在我看来，至少对于纯函数（即没有副作用的函数——如果你正确地模拟，你可以将脏函数转换为纯函数），不变测试可以取代单元测试作为这些功能的严格超集. 每个单元测试都由一个输入和一个输出组成（在命令式编程语言中，“输出”不仅是函数的返回，还包括任何更改的状态，但这可以被封装）。可以想象创建一个随机输入生成器，它足以覆盖您手动创建的所有单元测试输入（然后是一些，因为它会生成您不会想到的案例）；如果由于某些边界条件而在程序中发现错误，则可以改进随机输入生成器，以便它也生成这种情况。

那么，挑战在于是否有可能为每个问题制定有用的不变量。我想说的是：一旦你有一个答案来看看它是否正确，这比首先计算答案要简单得多。考虑不变量也有助于阐明复杂算法的规范，这比 ad hoc 测试用例更好，后者鼓励对问题进行逐个案例的思考。您可以使用以前版本的程序作为模型实现，或者使用另一种语言的程序版本。等等。最终，您可以覆盖所有以前的测试用例，而无需显式编码输入或输出。

我是不是疯了，还是我在做某事？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2010-09-06T02:39:02.883

一年后，我现在想我对这个问题有了答案：**不！**特别是，单元测试对于回归测试总是必要和有用的，其中测试附加到错误报告并存在于代码库中以防止该错误再次出现。

但是，我怀疑任何单元测试都可以替换为输入是随机生成的测试。即使在命令式代码的情况下，“输入”也是您需要制作的命令式语句的顺序。当然，是否值得创建随机数据生成器，是否可以使随机数据生成器具有正确的分布是另一个问题。单元测试只是一种退化的情况，随机生成器总是给出相同的结果。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-20T04:24:59.613

您提出的观点非常好——仅适用于函数式编程。你陈述了一种用命令式代码完成这一切的方法，但你也谈到了为什么它没有完成——这并不是特别容易。

我认为这正是它不会取代单元测试的原因：它不适合命令式代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-19T13:48:34.433

# 疑

我只听说过（未使用过）这类测试，但我看到了两个潜在问题。我很想对每一个发表评论。

## 误导性结果

我听说过这样的测试：

*   `reverse(reverse(list))`应该等于`list`
*   `unzip(zip(data))`应该等于`data`

很高兴知道这些适用于广泛的输入。**但是如果函数只返回它们的输入，这两个测试都会通过。**

在我看来，您想要验证，例如，在至少一种情况下证明正确的行为，然后`reverse([1 2 3])`使用随机数据**添加一些测试。**`[3 2 1]`

 **## 测试复杂性

完全描述输入和输出之间关系的不变测试可能比函数本身更复杂。如果它很复杂，它可能是错误的，但你没有测试你的测试。

相比之下，一个好的单元测试太简单了，读者不会搞砸或误解。只有拼写错误才会在“期望`reverse([1 2 3])`等于`[3 2 1]`”中产生错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-20T01:03:15.653

您在原始帖子中写的内容让我想起了这个问题，这是一个关于循环不变量是什么来证明循环正确的悬而未决的问题......

无论如何，我不确定您在正式规范中阅读了多少，但您正在沿着这条思路前进。david gries 的书是这方面的经典著作之一，但我还没有很好地掌握这个概念，无法在我的日常编程中快速使用它。对正式规范的通常反应是，它既困难又复杂，只有在您从事安全关键系统工作时才值得付出努力。但我认为有类似于可以使用的快速检查暴露的信封技术。

# blackberry - Blackberry - 在模拟器上运行 JAD 文件

> ID：766870
> 
> 赞同：1
> 
> 时间：2009-04-20T04:16:28.667
> 
> 标签：blackberry, blackberry-simulator

我有一个要在模拟器上运行的 BB 应用程序的 jad 文件。当我执行“加载 Java 程序”时，它会查找 cod 文件。

如何在 BB 模拟器上运行 JAD 文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T15:46:50.390

打开 BlackBerry 浏览器，在其中输入指向 JAD 文件的 Web 链接，您的应用程序将安装在您的 BlackBerry 模拟器上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-06T10:00:53.973

我有一个要在模拟器上运行的 BB 应用程序的 jad 文件。当我执行“加载 Java 程序”时，它会查找 cod 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T15:43:00.607

JAD 文件是与具有软件的 COD 文件一起使用的信息文件。您应该能够从获得 JAD 的同一位置获得 COD 文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T13:33:36.560

对于使用[PhoneGap Build](https://build.phonegap.com/apps)的任何人，如果他们发现只有 .jad 文件，而没有 .cod 文件，您需要...

1.  在记事本中查看此文件，因为它会列出您需要的所有 .cod 文件的名称（可能有 40 到 50 个）
2.  请注意 .jad 文件位于，`http://s3.amazonaws.com/blackberry.phonegap/slicehost-production/apps/123456/YourAppName.jad`因此将您自己的 URL 的最后一位更改为`.cod`（或`-1.cod`依此类推）以将 40 多个其他文件下载到同一文件夹
3.  在模拟器中，选择 File > Load 然后多选**所有**.cod 文件
4.  耐心等待，您的应用将出现在模拟屏幕菜单的底部

# mysql - MySQL 错误 2013

> ID：766876
> 
> 赞同：17
> 
> 时间：2009-04-20T04:23:04.843
> 
> 标签：mysql

在 MySQL 中，如何解决以下错误？

```
2013: Lost connection to MySQL server at 'reading authorization packet', system error: 0 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-20T09:13:48.000

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T09:48:40.993

添加`skip-name-resolve`为`my.cnf`我解决了这个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-13T23:55:24.253

我今天遇到了同样的问题，结果证明是 mysql 5.6.* 的问题。卸载它并安装 5.5.36 后，我不再收到此错误。

编辑：在另一台计算机上，我一直收到这个错误，直到我在 my.cnf 中设置它：

```
[mysqld]
max_allowed_packet = 32M 
```

好吧，从技术上讲，我的错误略有不同：

> _mysql_exceptions.OperationalError: (2013, "Lost connection to MySQL server at 'sending authentication information', system error: 32")

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-11T08:47:39.753

我也遇到了这个问题。对我来说，解决方案是注释掉这一行：

```
skip_networking 
```

我只是添加了注释#，如下所示：

```
#skip_networking 
```

然后我重新启动了mysql，一切都很好！

请注意，这将禁用与 MySQL 建立网络连接的所有功能。如果您仅用作本地主机，应该没问题，否则请注意！:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-25T03:50:02.610

如果您使用的是 Mac OS X 和 MySQL 5.6.6 或更高版本，则默认值`innodb_file_per_table`已更改为`ON`. 设置`innodb_file_per_table = OFF`可能会解决您的问题。请参阅[Mac OSX 上的 Mysql 5.6 头痛](https://stackoverflow.com/questions/17813630/mysql-5-6-headaches-on-mac-osx)和[http://bugs.mysql.com/bug.php?id=71960](http://bugs.mysql.com/bug.php?id=71960)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-06T23:32:19.467

检查您的 my.cnf 文件。将绑定地址设置为服务器的实际 IP 地址。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-11T20:54:23.350

看看你的 mysqld 日志文件——“显示状态”很有可能因为某种原因导致 MySQL 崩溃。

# open-source - 使一门语言成功需要什么？

> ID：766881
> 
> 赞同：2
> 
> 时间：2009-04-20T04:25:57.147
> 
> 标签：open-source, programming-languages, project-management

我对一种新的编程语言有一个有趣的想法。它基于一种新的编程范式，我已经在脑海中研究了一段时间。几周前，我终于开始为它开发一个基本的解析器和解释器。

我希望我的新语言能够成功，并且我希望最终在它准备好发布时围绕它创建一个社区。它背后的想法是相当创新的，所以我不希望它在商业世界中获得很大的进展，但看到少数初创公司使用它或开源项目使用它，我最激动的是。

因此，考虑到这些目标，我能做些什么来帮助我的语言取得成功？语言项目如何取得成功？我应该不惜一切代价避免什么？我很想听听关于其他语言的意见或故事——无论成功与否——所以我可以在继续发展的过程中思考它们。

到目前为止，我最关心的两个问题是寻找市场、访问现有库、拥有令人惊叹的工具支持。我还可以在这个列表中添加什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T04:31:22.780

虽然不是针对新的编程语言，但 Karl Fogel 的《[生产开源软件](http://producingoss.com/)》一书（可在线阅读）可能包含一些关于围绕您的新编程语言建立社区的问题。

总体而言，就编程语言的采用而言，最近的趋势似乎是拥有丰富的库以缩短开发时间。

由于没有关于您的语言是什么样的详细信息，因此很难确定该语言的采用是否将取决于丰富库的可用性。也许您的语言将能够填补被其他语言忽视的利基，并能够获得用户。或者它有一个漂亮的名字会吸引人们——有很多因素会影响语言的采用。

以下是在考虑最近成功的语言时会想到的一些因素：

*   能够以新语言利用现有库。

    *   有一个以其他语言编写的外部库的适配器。
        *   [Python允许通过](http://python.org)[Python/C API](http://www.python.org/doc/2.5.2/ext/intro.html)访问用 C 编写的代码。
    *   针对已经有大量库可供使用的平台。
        *   [Groovy](http://groovy.codehaus.org/)和[Scala](http://www.scala-lang.org/)以 Java 平台为目标，因此允许在现有 Java 代码之间使用和互操作。
*   语言设计和语法可提高生产力。

    *   许多动态类型语言已经流行起来，例如[Ruby](http://www.ruby-lang.org/)和 Python 等等。
    *   可以用 Groovy 等语言编写更简洁明了的代码，而不是 Java 等冗长的语言。
    *   提供诸如作为[一等对象的函数](http://en.wikipedia.org/wiki/First-class_function)和[闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))之类的特性，这些特性在 C 和 Java 等更“传统”的语言中是不提供的。
*   一个由敬业用户组成的社区，他们也愿意向新手教授一种语言的好处

    *   在对一种语言的广泛支持中，人为因素将是很大的——如果人们从未开始使用你的语言，它就不会获得更多的用户。

另外，我可以补充的另一个建议是开放您的语言开发——让您的用户随时了解您的语言的开发情况，并允许人们给您反馈。更好的是，如果您认为合适，让您的用户参与决策过程。

我相信，通过提供参与语言培养的方式，更多的人会觉得他们与新语言的成功息息相关，因此它更有可能获得更多的支持。

祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T06:11:43.023

真正的答案是留胡子。

[http://blogs.microsoft.co.il/blogs/tamir/archive/2008/04/28/computer-languages-and-facial-hair-take-two.aspx](http://blogs.microsoft.co.il/blogs/tamir/archive/2008/04/28/computer-languages-and-facial-hair-take-two.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T05:29:00.503

大多数最终迅速起飞的语言都是通过杀手级应用程序实现的。对于 C，它是 Unix。Ruby 有 Rails。JavaScript 是没有第三方插件的大多数浏览器通用的唯一可用编程系统。

另一种成功的方式是通过法令。这只有在你有很大影响力的情况下才有效。例如，如果微软没有像现在这样努力推动它，C# 就不会像现在这样流行。Objective-C 是 MacOS X 的语言，仅仅是因为 Apple 这么说。

然而，绝大多数缺乏单一杀手级应用程序或主要企业支持者的语言都通过各自创造者的长期投资获得了成功。Perl 和 Python 就是最好的例子。C++ 背后没有单一实体，但它随着开发人员需求的变化而发展。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T04:32:39.033

不要担心试图让语言成功；担心用它来解决实际问题并赚钱。

你要么通过使用这种语言赚很多钱，要么不。一旦你有很多钱，别人可能会关心你是怎么做到的。或者不是，不管怎样，你有很多钱。

如果你不赚很多钱，没人会想知道你是怎么做到的。

**根据评论编辑：**我将成功定义为人们使用它，人们使用语言来解决问题，大多数是为了利润，因此成功 == 有利可图。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T05:17:27.037

除了使语言易于使用（具有多种含义）之外，您还应该**开发一个全面的库**，涵盖并提供良好的抽象水平（以下最重要的领域）：
* 数据结构和操作
* 文件 I/ O 支持
* XML 处理
* 网络（加上基于 Web 的技术，如 HTTP/HTTPS）
* 数据库支持
* 同步和异步 I/O
* 进程和线程
* 数学

一个**经过深思熟虑的框架**可以使快速开发更快（并且更易于维护）将是一个很好的补充。为此，您应该熟悉当前流行的框架。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T06:32:11.803

请记住，这需要很多时间。我认为python花了大约10年的时间（如果我错了，请有人纠正我）。

因此，即使您的社区在 5 年后看起来仍然很小，但这并不是故事的结局。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-22T15:00:00.193

“它基于一种新的编程范式，我已经在脑海中研究了一段时间。”

虽然值得称赞，但很有可能有人已经用你的“新”范式做了一些事情。

为了使一种语言可用，**它必须建立在现有技术**的基础上。全新的并不是通往成功的好途径。我最喜欢的例子是 Algol 68。

Algol 60 广受欢迎（不可否认，这是不久前的一天）。

专家们希望在这一成功的基础上再接再厉。他们提出了一些新的范式，努力分裂成派别。纯粹主义者将新范式放入 Algol 68；它消失得无影无踪。有些人创建了一个不同版本的 Algol，称为 PL/I。它没有任何真正的新范式。它实际上去了某个地方并被大量使用。另一个小组创建了 Pascal——它没有太多新东西——它丢弃了 Algol 60 中的东西。它实际上去了某个地方并且被大量使用。

你的新范式必须有**一个清晰简洁的总结**，这样人们才能将它融入到语言可用、如何使用、使用它的成本和收益的上下文中。

“新的编程范式”让一些人说“为什么要学习一个全新的范式，而我的范式工作得这么好？” 你必须非常清楚拥有一个新范式有什么帮助。

语言和库**必须工作**，并且工作得非常非常好。不坚如磐石的语言一文不值。为了坚如磐石，**它必须非常简单**。

它必须有**一个教程，可以帮助任何人开始**使用您的语言。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T05:40:57.277

常见任务的良好框架

易于安装/部署

好的文档

调试器/IDE 和其他工具

**使用您的语言的流行旗舰产品！**

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-20T05:41:29.710

*   良好的文档，包括详细的参考手册**以及**让人们快速入门的简单示例。

*   良好的库支持，使人们可以实际编写有用的程序。

大多数流行的语言似乎在其中一个或两个或两个方面都非常强大。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-20T06:21:33.140

使用特洛伊木马方法 [C++ - The Forgotten Trojan Horse](http://ejohnson.blogs.com/software/2004/11/i_find_c_intere.html)

一篇有趣的文章，讲述了为什么 C++ 能够成功抓住程序员的心。

# c# - C# 构造函数

> ID：766883
> 
> 赞同：1
> 
> 时间：2009-04-20T04:26:56.440
> 
> 标签：c#, constructor

我最近看到一个看起来像这样的 C# 构造函数......

```
public Class foo
{
    public foo() : this(new bar())
    {}
} 
```

有人可以帮我解释一下吗？bar() 在哪里适合？
如果您可以通过在适当的位置插入 bar() 来帮助我完成课程，以便我可以编译/调试并查看整个图片。

提前致谢。

尼科斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T04:29:03.347

foo 类应该包含另一个构造函数，它将一个 bar 对象作为参数。

```
public class foo
{
    public foo()
        : this(new bar())
    { }
    public foo(bar b)
    {
    }
}
public class bar
{
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T04:29:00.540

类 foo 上将有第二个构造函数，其签名如下

```
public foo(bar Bar)
{
     ... do something with bar here;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T04:40:19.047

这是确保所有构造函数都经过一个点的常用技术，因此您只需更改该点（它可能有其他用途，但我不知道它们）。

我在使用默认参数的事情中看到了它，例如：

```
class Rational {
    private:
        long numerator;
        long denominator;
    public:
        void Rational (long n, long d) {
            numerator = n;
            denominator = d;
        }
        void Rational (long n): Rational (n,1) {}
        void Rational (void): Rational (0,1) {}
        void Rational (String s): Rational (atoi(s),1) {}
} 
```

忍受语法，我在这里没有现成的编译器访问权限，但基本意图是在第一个构造函数中集中尽可能多的代码。

因此，例如，如果您添加一个检查以确保分母大于零，或者使用最大公约数方法减少分子和分母，那么*它只*需要在您的代码中的一个点发生。

# c# - C# 嵌套空检查 if 语句

> ID：766885
> 
> 赞同：1
> 
> 时间：2009-04-20T04:27:52.180
> 
> 标签：c#, coding-style, null, language-features

我有一个关于编程风格和 C# 语言设计的问题，我很想知道是否有更好的方法来做我正在做的事情。

如果您有一个复杂的数据对象，其属性可以为空，但您想检查或操作数据（如果存在），则不能编写这样的行

```
if(Myobject.MyNestedObject != null || Myobject.MyNestedObject.Property != null)
{
   //code
} 
```

因为编译器实际上会调用两行代码来评估 if 语句。

相反，您必须（我相信）写：

```
if(Myobject.MyNestedObject != null)
{
   if(Myobject.MyNestedObject.Property != null)
   {
      //code
   }
} 
```

还有比这更好的风格吗？我正在尝试考虑如何使用 null coalesce (??) 但如果您尝试在同一语句中使用 MyNestedObject 的任何内容，它仍然会抛出。

更多信息：

```
 L_01b4: ldarg.1 
    L_01b5: callvirt instance class [Myassembly]MyClass.MyObject [MyAssembly]MyClass::get_MyObject()
    L_01ba: brtrue.s L_01cc
    L_01bc: ldarg.1 
    L_01bd: callvirt instance class [MyAssembly]MyClass.MyObject [MyAssembly]MyClass::get_MyObject()
    L_01c2: callvirt instance class [MyAssembly]MyClass.MyNestedObject [MyAssembly]MyClass.MyNestedObject::get_MyNestedObject()
    L_01c7: ldnull 
    L_01c8: ceq 
    L_01ca: br.s L_01cd
    L_01cc: ldc.i4.0 
    L_01cd: stloc.2 
    L_01ce: ldloc.2 
    L_01cf: brtrue L_0285
    L_01d4: nop 
```

据我了解，在 L_01ba 处，如果调用返回 true、不为 null 或非 0（即，如果对象为 null，则不采用分支，然后控制流线性继续）。这当然会执行 L_01c2 ，它会抛出一个空引用异常，因为 Myclass.MyObject 是空的。

我是不是错过了什么。这是 .net 3.5 C# 编译器。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-20T04:37:27.633

结合@Chris 和@aJ 答案：

我认为您需要 && 运算符，而不是 ||。

```
if (Myobject.MyNestedObject != null &&
    Myobject.MyNestedObject.Property != null)
{
    //code
} 
```

并且 C# 的 && 运算符使用短路求值，因此如果第一个表达式返回 false，则不会对第二个表达式求值。

...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T04:31:36.447

```
if( Myobject.MyNestedObject != null && 
             Myobject.MyNestedObject.Property != null)
{
//code
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T04:29:58.180

C# 使用惰性检查，所以你的第一个代码应该没问题（当然 || 更改为 &&！）

更新 - 这里是：http: [//msdn.microsoft.com/en-gb/library/6373h346.aspx](http://msdn.microsoft.com/en-gb/library/6373h346.aspx) “操作

x || 是的

对应操作

x | 是的

除了如果 x 为真，则不计算 y（因为无论 y 的值是什么，OR 运算的结果都是真）。这称为“短路”评估。"

再次更新 - 应该使用 &&!

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T08:32:18.067

我将添加强制性建议，即必须挖掘公共属性层通常意味着您暴露了太多内部状态，并且您正在遍历的类应该为您完成这项工作。我还希望一个对象首先确保其属性不返回 null。

当然有边缘情况，但这些都是很好的经验法则。

# ruby-on-rails - Windows XP 上的 Ruby on Rails 控制台中的 CTRL+C 不会停止杂种

> ID：766890
> 
> 赞同：24
> 
> 时间：2009-04-20T04:30:25.357
> 
> 标签：ruby-on-rails, ruby, console, windows-xp

我目前正在学习 Ruby on Rails。我一直在关注[Learning Rails](http://buildingwebapps.com/course)播客和截屏视频。

我遇到了一个问题，更多的是烦恼。每次截屏视频让我杀死杂种服务器时，我都被迫关闭控制台窗口，因为 CTRL+C 没有按应有的方式杀死它。然后我必须打开一个新的控制台窗口，导航到我的 rails 应用程序并发出“ruby 脚本/服务器”命令来重新启动它。

我正在寻找的可能是一个原因，一种修复它的方法或其他建议，以使这个过程更快和/或更少烦人。甚至可能是一个批处理文件或快捷方式，可以在我需要的地方打开一个 cmd 窗口？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-28T06:50:36.030

请改用`Ctrl`+ `Pause/Break`。它将停止服务器。

![在此处输入图像描述](https://i.stack.imgur.com/TJ4WE.jpg)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-15T05:24:27.020

`Ctrl`+`Pause/Break`强制关闭服务器。这不正常。反正我的戴尔笔记本没有钥匙。

所以使用这个：
而不是`rails s`使用`ruby script/rails s`.
`Ctrl`+`C`将与此完美配合。测试了它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-18T13:26:08.120

这是一个已知问题，这里是补丁：[https ://rails.lighthouseapp.com/projects/8994/tickets/2088-mongrel-not-being-stopped-with-ctrl-c-under-windows](https://rails.lighthouseapp.com/projects/8994/tickets/2088-mongrel-not-being-stopped-with-ctrl-c-under-windows)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T17:32:18.580

我相信如果你捕捉到异常而不是重新提出它，这可能会发生。SIG-INT 将被捕获并最终不会终止该进程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-09T09:54:55.317

如果一切都失败了，点击`Ctrl`++ ，打开任务管理器并杀死 ruby​​ 进程； `Alt`）`Delete`![红宝石工艺](https://i.stack.imgur.com/KInRZ.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T00:33:37.537

我在 Windows 上也有同样的问题，所以无法帮助您解决 Ctrl+C 问题。但是，我可以将您指向[Windows PowerToys 的 Open Command Window Here](http://www.microsoft.com/windowsxp/Downloads/powertoys/Xppowertoys.mspx "Windows PowerToys") - 它在您的资源管理器窗口中添加了“Open Command Window Here”，这是在 Windows 机器上进行开发（任何类型）的要求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-21T11:07:58.857

如果你像这样开始 mongrel 有点不同：

```
$ cd myrailsapp
$ mongrel_rails start 
```

然后你可以像这样停止它：

```
$ mongrel_rails stop 
```

[您可以在此处](http://mongrel.rubyforge.org/web/mongrel/files/README.html)获取更多信息。这可能很有趣：[Mongrel as a service](http://mongrel.rubyforge.org/wiki/Win32)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-10T06:52:38.957

检查您的 Rails 版本并使用

`ctrl`+ `c`+ `pause/break` 2.3.2
`ctrl`+ `c` 2.1.2

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-14T00:12:05.303

点击`Ctrl`+后`c`，通过刷新打开它的浏览器页面向服务器发送请求。命令提示符现在将显示`Exiting`并让您返回命令行。

# java - 如何以编程方式调整 mod_jk 负载均衡器配置中的禁用指令？

> ID：766891
> 
> 赞同：3
> 
> 时间：2009-04-20T04:31:11.220
> 
> 标签：java, apache, tomcat, mod-jk

我们有一个设置，我们有一个带有 mod_jk 的 httpd (apache)，在负载平衡设置中与三个 tomcat 服务器通信。我们必须每三个小时回收每个 tomcat 实例。所以tomcat1会在1点重启，tomcat2会在2点重启……直到tomcat1在4点重启。

我们想要配置一个脚本或一种程序来禁用正在经历循环的工作节点，以最大限度地减少使用我们应用程序的用户的会话错误。

有什么建议么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T11:50:37.683

mod_jk 在“apachectl graceful”上重新读取workers.properties，所以如果您的workers.properties 看起来像这样：

```
worker.loadbalancer.type=lb
worker.loadbalancer.balanced_workers=tomcat1, tomcat2, tomcat3

... 
```

你可以写一个脚本，用你想要的替换balanced_workers列表，然后优雅的apache

*更新*这里是一个脚本来做到这一点，我从周围的一些地方拼凑而成。我不建议在生产中使用它，但它可能会给你一些关于你自己版本的想法。

```
#!/bin/bash

# set some paths
WORKERS_PROPERTIES="./workers.properties"
APACHECTL="/usr/sbin/apache2ctl"

# what does the loadbalancer config line look like?
WORKER_LINE_START="worker.loadbalancer.balanced_workers="
# full list of workers
ALL_WORKERS="tomcat1 tomcat2 tomcat3"

# first command line arg is the worker to remove. 
remove=$1

# build up the new line listing the active workers
worker_line=$WORKER_LINE_START
sep=""
for worker in $ALL_WORKERS
do
  if [ ${remove} != ${worker} ]
  then
     worker_line="${worker_line}$sep $worker"
     sep=","
  fi
done

# sed hackery to replace the current line with the one we just built.
# needs gnu sed (or another one that supports in-place editing)
sed -i.bak "s/^$WORKER_LINE_START.*$/$worker_line/" $WORKERS_PROPERTIES

# restart apache
$APACHECTL graceful 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T18:34:38.290

克里斯谢谢或你的回答。我确信它会起作用，但我想在运行时触发更改，即使优雅重启非常相似。我能够通过以下方式完成我的描述任务。

在您的 httpd.conf 文件中，您应该添加以下行来为 mod_jk 模块启用 jkmanager。

```
<Location /jkmanager/>
JkMount jkstatus
order deny,allow
allow from <your ip address>
allow from 127.0.0.1
deny from all
</Location>

<IfModule mod_jk.c>
...
JkMount  /jkmanager/* jkstatus
...
</IfModule> 
```

“workers.properties”文件的变化是：

```
 worker.list=router,tomcat1,tomcat2,...,tomcatn,jkstatus
 worker.jkstatus.type=status 
```

完成这些更改后，您可以通过在最后输入您的 url 和 /jkmanager/ 来查看 jkmanager。你应该得到类似于下图的东西。

[![jkmanager 截图](https://i.stack.imgur.com/I21Pz.png)](https://i.stack.imgur.com/I21Pz.png)

为了在运行时禁用工作人员，只需对 jkmanger 运行以下 URL。您甚至可以读取 xml 格式的状态。

要禁用tomcat1，只需点击：

```
http://your.web.server/jkmanager/?cmd=update&w=router&opt=256&from=list&att=vwa&val0=1&val1=0&val2=0 
```

要启用 tomcat1 回击：

```
http://your.web.server/jkmanager/?cmd=update&w=router&opt=256&from=list&att=vwa&val0=0&val1=0&val2=0 
```

我在我的博客中发布了一篇完整的文章，解释了设置，以防有人需要知道。

[云计算博客](http://www.kiragiannis.com/cloud-computing/growing-and-shrinking-tomcat-workers-in-the-cloud/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-08T05:49:29.757

gkiragiannis，您的回答很有趣，但似乎对我不起作用。我想一次只禁用我的一个子工作人员。

假设我们正在使用“agent-lb”负载平衡器。

要使用此 url 查看工作人员状态：

```
server-name/jkmanager/?cmd=list&w=agent-lb 
```

要禁用“agent-n1”子工作人员，请使用以下网址：

```
server-name/jkmanager/?cmd=update&w=agent-lb&sw=agent-n1&vwa=1 
```

为确保工作人员被禁用，请等待重定向到工作人员状态页面，并在“Act”字段中查找子工作人员“agent-n1”

要启用“agent-n1”子工作人员，请使用以下网址：

```
server-name/jkmanager/?cmd=update&w=agent-lb&sw=agent-n1&vwa=0 
```

# c - 如何修改已传递给 C 函数的指针？

> ID：766893
> 
> 赞同：68
> 
> 时间：2009-04-20T04:31:27.007
> 
> 标签：c, function, pointers, parameters, pass-by-value

所以，我有一些代码，有点像下面，将结构添加到结构列表中：

```
void barPush(BarList * list,Bar * bar)
{
    // if there is no move to add, then we are done
    if (bar == NULL) return;//EMPTY_LIST;

    // allocate space for the new node
    BarList * newNode = malloc(sizeof(BarList));

    // assign the right values
    newNode->val = bar;
    newNode->nextBar = list;

    // and set list to be equal to the new head of the list
    list = newNode; // This line works, but list only changes inside of this function
} 
```

这些结构定义如下：

```
typedef struct Bar
{
    // this isn't too important
} Bar;

#define EMPTY_LIST NULL

typedef struct BarList
{
    Bar * val;
    struct  BarList * nextBar;
} BarList; 
```

然后在另一个文件中我执行以下操作：

```
BarList * l;

l = EMPTY_LIST;
barPush(l,&b1); // b1 and b2 are just Bar's
barPush(l,&b2); 
```

但是，在这之后，l 仍然指向 EMPTY_LIST，而不是在 barPush 内部创建的修改版本。如果我想修改它，我是否必须将列表作为指向指针的指针传递，或者是否需要其他一些黑暗的咒语？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-04-20T04:35:11.040

如果你想这样做，你需要传入一个指向指针的指针。

```
void barPush(BarList ** list,Bar * bar)
{
    if (list == NULL) return; // need to pass in the pointer to your pointer to your list.

    // if there is no move to add, then we are done
    if (bar == NULL) return;

    // allocate space for the new node
    BarList * newNode = malloc(sizeof(BarList));

    // assign the right values
    newNode->val = bar;
    newNode->nextBar = *list;

    // and set the contents of the pointer to the pointer to the head of the list 
    // (ie: the pointer the the head of the list) to the new node.
    *list = newNode; 
} 
```

然后像这样使用它：

```
BarList * l;

l = EMPTY_LIST;
barPush(&l,&b1); // b1 and b2 are just Bar's
barPush(&l,&b2); 
```

Jonathan Leffler 建议在评论中返回列表的新负责人：

```
BarList *barPush(BarList *list,Bar *bar)
{
    // if there is no move to add, then we are done - return unmodified list.
    if (bar == NULL) return list;  

    // allocate space for the new node
    BarList * newNode = malloc(sizeof(BarList));

    // assign the right values
    newNode->val = bar;
    newNode->nextBar = list;

    // return the new head of the list.
    return newNode; 
} 
```

用法变为：

```
BarList * l;

l = EMPTY_LIST;
l = barPush(l,&b1); // b1 and b2 are just Bar's
l = barPush(l,&b2); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-21T00:43:59.043

通用答案：将指针传递给您要更改的内容。

在这种情况下，它将是指向要更改的指针的指针。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-04-20T04:33:38.030

请记住，在 C 中，一切都是按值传递的。

你传入一个指向指针的指针，像这样

```
int myFunction(int** param1, int** param2) {

// now I can change the ACTUAL pointer - kind of like passing a pointer by reference 

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-20T04:35:49.523

这是一个经典的问题。返回分配的节点或使用指针的指针。在 C 中，您应该将指向 X 的指针传递给您希望修改 X 的函数。在这种情况下，由于您希望修改指针，因此您应该将指针传递给指针。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-20T04:33:27.890

是的，您必须传入一个指向该指针的指针。C 通过值而不是引用传递参数。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-06-02T16:08:17.083

在另一个函数中修改指针需要一个称为多重间接的概念，我将在后面解释它，由于@geofftnz 使用多重间接的剧透解决方案。我想做的是尽我所能解释C中的多重间接。

考虑以下两个程序，我将遍历代码。

下面的程序没有使用多重间接，所以它失败了。

有错误的程序：

```
// filename: noIndirection.c
#include <stdio.h>
#include <stdlib.h>

void allocater(int *ptrTempAllctr)
{
    ptrTempAllctr = malloc(sizeof(int));
    if (ptrTempAllctr == NULL) {
        perror("in allocater() memory allocation error");
        exit(EXIT_FAILURE);
    }
}

int main() 
{
    int *ptrMain = NULL;
    allocater(ptrMain);
    if (ptrMain == NULL) {
        printf("ptrMain is points to NULL\n");
        return 1;
    }
    //free(ptrMain);  // we don't have to free because it will be invalid free.
    return 0;
} 
```

考虑上面的 program( `noIndirection.c`)，它有一个变量`ptrMain`，它是一个指向 int 的指针。如果它被传递给函数，则在函数范围（主体）中创建一个临时指针变量，因为函数的参数是临时变量，当它们超出范围时它们会被删除。

临时指针变量`ptrTempAllctr`（它是一个参数）将指向 caller( `main`) 函数的变量`ptrMain`（它指向`NULL`）在它作为参数传递给函数时所指向的东西。

如果我们使用`malloc()`或分配另一个指向临时变量的指针，`ptrTempAllctr`那么它将指向它，但是`main`作为参数传递给 to 函数的 caller() 函数中的指针变量仍然指向它之前`allocater()`指向的相同数据（即）`NULL`函数调用。

当被调用的 ( `allocater()`) 函数超出范围时，临时指针变量会从堆栈中弹出，并且内存未分配，我们最终会导致内存泄漏。为了绕过这个限制，我们需要使用多重间接。

**多方向：**

```
Multiple indirection when we use of pointer/s to pointer/s in varying level(with multiple `*`) eg: `int **pp, int ***ppp`, etc. 
```

`&`我们使用 address-of( ) 运算符分配它们。

多重间接指针类型变量所做的是，允许我们制作一个指向指针变量本身的指针，用于修复上述程序。这允许我们 使用此调用将地址传递`ptrMain`给`allocater()`

`allocater(&ptrMain);`

因此上面的程序`noIndirection.c`不允许我们这样做，请参阅`withIndirection.c`实现这种多重间接的程序。

在这种情况下，我们需要指向 int 指针（`int **ptrMain`）的指针作为函数的函数参数`allocater()`来解决上述错误程序（noIndirection.c）。

这在以下程序中使用。

以下程序使用**多重间接**来解决之前程序中的错误。

```
// filename: withIndirection.c
#include <stdio.h>
#include <stdlib.h>

void trueAllocater(int **ptrTrueAllocater)
{
    *ptrTrueAllocater = (int *) malloc(sizeof(int));
    if (ptrTrueAllocater == NULL) {
        perror("in trueAllocater() memory allocation error");
        exit(EXIT_FAILURE);
    }
}

int main(void) 
{
    int *ptrMain = NULL;
    trueAllocater(&ptrMain);
    if (ptrMain == NULL) {
        printf("memory not allocated\n");
        return EXIT_FAILURE;
    }

    printf("memory allocated and assigned to ptrMain");
    printf(" from trueAllocater\n");

    free(ptrMain);
    return EXIT_SUCCESS;
} 
```

从现在开始查看程序`withIndirection.c`以供参考。

为了解决我们的问题，我们需要将指针变量`ptrMain`（间接的，即在我目前对传递的变量的理解中，将另一个 * 添加到参数声明中。`trueAllocater(&ptrMain);``ptrMain``trueAllocater()`

通过这种方式，我们需要将`trueAllocater()`函数参数设置为`int **`from `int *`in`withIndirection.c`而不是`noIndirection.c` 这样才能统计间接级别。

当调用者的参数变量`ptrMain`的实际地址被传递给函数时。函数中的临时参数变量指向调用者（）函数`ptrTrueAllocater`中指针变量的地址，而不是函数（）中的指针变量（在程序中）指向的地址。`ptrMain``main``ptrMain``NULL``main`

如果我们取消引用变量，指向`ptrTrueAllocater`的地址将被显示，因为临时变量指向 caller( )变量本身，而不是它的内容。`ptrMain``ptrTrueAllocater``main``ptrMain`

解引用`ptrTrueAllocater`变量的内容将是调用者（`main`）的变量（`ptrMain`）所指向的数据的地址，因此我们必须进行一次额外的解引用才能获得最终数据。

所以我们必须取消引用一次以获得`ptrMain`它指向的地址，以便更改`ptrMain`需要指向的位置并取消引用两次以获得由`ptrMain`which is指向的实际数据`NULL`。

@PaulWicks 您打算更改，因此您必须取消引用一次才能分配或更改其指向的位置。

使用指针进行多重间接的目的是创建多维数组并传递需要指向某物的指针参数。

我们需要根据我们必须操作的类型来更改变量，如下所示，

在声明中每次添加 * 都会增加指针间接级别，每次取消引用都会降低接近数据的指针间接级别。

我们可以通过将地址返回给分配给所需指针变量的调用函数来解决这个问题。

是的，我们可以使用这种多间接变量语法来创建一维或多维数组。这首先会使初学者感到困惑，如果他们花时间阅读大量代码，他们将能够找到它们之间的区别。

如果我错了，请纠正我，请提供反馈并让我知道多个间接指针的其他用途是什么。为我糟糕的英语道歉。这些是帮助我理解多种间接方式的资源。 [https://boredzo.org/pointers/#function_pointers](https://boredzo.org/pointers/#function_pointers) [https://cseweb.ucsd.edu/~ricko/rt_lt.rule.html](https://cseweb.ucsd.edu/%7Ericko/rt_lt.rule.html)

# c# - 更改节点元素的 InnerText

> ID：766902
> 
> 赞同：0
> 
> 时间：2009-04-20T04:34:39.637
> 
> 标签：c#, xml

```
<MyXmlType>
   <MyXmlElement>Value</MyXmlElement>
</MyXmlType> 
```

我在这里需要一点帮助。我试图改变这里的内部文本值。在我更改值并使用 Xmldocument 对象保存它之后。当我打开文件时，我发现它已经以这种格式保存了。

```
<MyXmlType>
   <MyXmlElement>Value</MyXmlElement>
</MyXmlType>> 
```

请注意这个`</MyXmlType>>`“>>”。我不知道发生了什么。请帮忙...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T05:24:29.580

我的猜测是，您将内部文本更改为短一个字符的内容，然后将文件覆盖*在适当*的位置，而不是用全新的文件覆盖它。这意味着额外`>`的文件是从文件的先前版本中留下的。

如果您可以显示用于编写文件的代码，那将有很大帮助。

如果你写入一个新文件，你会遇到同样的问题吗？

# sharepoint - 跨多个域的 SharePoint (WSS) 身份验证

> ID：766904
> 
> 赞同：4
> 
> 时间：2009-04-20T04:35:08.293
> 
> 标签：sharepoint, active-directory, wss, windows-authentication

首先，一些背景知识：我们有一个基于 WSS 3.0 的 Intranet 站点，它托管在***DOMAIN_A.LOCAL***中的服务器上，并设置为使用集成 Windows 身份验证来针对***DOMAIN_A.LOCAL***的 Active Directory 用户帐户对用户进行身份验证。

此设置适用于使用***DOMAIN_A.LOCAL的 AD 帐户登录 Windows 的用户，但是当用户尝试从使用不同域（即******DOMAIN_B.LOCAL***）的AD 帐户登录 Windows 的 PC 访问该站点时，出现以下问题：

1.  用户必须手动将其凭据输入为***DOMAIN_A\UserName***而不仅仅是***UserName***，否则 Internet Explorer 会自动插入***DOMAIN_B***并导致身份验证失败。

2.  登录后，如果用户执行需要浏览器将其身份验证传递给客户端应用程序的操作，例如单击文档库中的 Microsoft Office 文档以将其打开以进行编辑，则显示无效凭据（大概***DOMAIN_B*** ) 被自动传递，从而迫使用户再次手动输入他们的***DOMAIN_A***凭据。

那么我的问题是这样的：

有没有办法在使用集成 Windows 身份验证时实现“默认域”类型的行为（使用基本明文身份验证时可以这样做），以便如果***DOMAIN_B***上的用户没有在其用户名之前输入域，则***DOMAIN_A***是为他们自动插入？

当然，我意识到这种部署可能存在致命缺陷，因此我也愿意接受不同实施的建议。

总之，主要问题源于两种不同类型的用户需要访问一个 SharePoint 网站上的相同内容。***DOMAIN_A***中的用户都有自己的全职工作站，他们在其中以自己的身份登录 Windows。***不幸的是， DOMAIN_B***中的用户必须使用共享计算机，这些计算机使用在 SharePoint 中没有权限的通用“信息亭”类型帐户登录——因此要求***DOMAIN_B***用户在访问 SharePoint 中的给定页面时必须按需提供其凭据。我想为***DOMAIN_A***的“静态”用户保留集成 Windows 身份验证的便利性，同时最大限度地减少“信息亭”用户的手动身份验证量***DOMAIN_B***必须忍受。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T16:32:20.213

*DOMAIN_A.LOCAL*必须信任*DOMAIN_B.LOCAL*，否则来自*DOMAIN_B.LOCAL*的用户将收到凭据提示，因为他们的*DOMAIN_B.LOCAL*帐户在*DOMAIN_A.LOCAL*中是未知的。

鉴于*DOMAIN_B.LOCAL*适用于 kisok 用户，您可能不想信任此域。

您需要将 Web 应用程序扩展到一个新区域并实施基于表单的身份验证，或者使用带有反向代理（如 ISA 服务器）的 Windows 身份验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-20T21:31:30.910

我在 Internet 上搜索具有多个域的 SharePoint 用户帐户，并遇到了一个名为 Microsoft Front End Identity Manager 的有趣工具。你听说过吗？

所以……如果您使用多林部署，其中用户帐户分布在两个或更多林中。当两个组织合并并需要访问两个组织的域时，通常会出现这种情况。您可以使用用户对象中的可分辨名称 (ms-ds-Source-Object-DN) 属性来创建用户帐户之间的关联。在此关联中，一个帐户被视为主帐户，其他帐户是主帐户的备用帐户。有一个名为 Microsoft Front End Identity Manager 的工具可以在用户帐户对象之间创建这种关系。Microsoft Front End Identity Manager 的一项功能是 SharePoint 服务器可以维护一个备用帐户列表，通过这些帐户识别配置文件。当您使用任一帐户查找用户的个人资料时，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T11:51:31.473

可能不是您想听到的，但您可能想诉诸基于表单的身份验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T16:50:44.320

不幸的是，如果您想保留 Microsoft Office 集成（这似乎是您想要的），您将不得不坚持使用 Windows 身份验证。使用表单身份验证将删除您似乎热衷于保留的大部分功能，这里有更多[信息](http://msdn.microsoft.com/en-us/library/bb977430.aspx)。

理想情况下，您想使用 Jason 提到的建议，这将是某种反向代理。但是，如果您还没有像 ISA 服务器这样的东西，可能会产生成本影响，因此实际上 DOMAIN_B 最好学会在他们的用户名之前输入 DOMAIN_B\。

# c# - 您如何支持向嵌套的 flowlayoutpanels 添加项目？

> ID：766910
> 
> 赞同：0
> 
> 时间：2009-04-20T04:38:11.810
> 
> 标签：c#, flowlayoutpanel

我在一个表单上有一个 flowlayoutpanel (flowParent)，它承载了一个 flowlayoutpanels 列表（flowchild1、flowchild2 等）。

从表单级别，如何将项目添加到 flowchild1。本质上，我如何引用子 flowlayoutpanel？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T06:06:30.430

You can either retain the reference when you add that panel to the outer panel, or use Container.getComponent(int).

# windows - 使用 Winsock 的原始以太网帧

> ID：766912
> 
> 赞同：6
> 
> 时间：2009-04-20T04:39:54.803
> 
> 标签：windows, linux, networking, winsock, porting

我正在将一个通信库从 Linux 移植到 Windows。我知道我的方法在很大程度上是什么。该库使用所有原始以太网级帧进行所有通信。

我要移植的库使用了 PF_PACKET 系列和 struct sockaddr_ll。浏览 MSDN winsock 站点后，我没有找到等效的族/结构。我的方法应该是什么？

我有一些想法，但我不确定它们是否是好想法，我可以使用 PF_UNSPEC，未指定。我可以只传递 PF_PACKET 代表的数字（它是一个无符号短）我也可以在 Windows 中创建自己的 sockadddr_ll 结构。

这些想法对我来说似乎都不好，它们只是看起来不太可能奏效的黑客。

如果有人有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T05:26:19.403

我假设您指的是原始套接字（您必须在其中编写网络层、传输层和应用程序层信息）。新的 Windows 版本（XP SP2 和更高版本）对原始套接字的支持非常有限，并且有很多限制。

[更多信息](http://msdn.microsoft.com/en-us/library/ms740548.aspx)（向下滚动到“原始套接字的限制”）

我相信解决方案是使用[WinPcap](http://www.winpcap.org/)，它允许您在这些系统上[发送原始数据包。](http://www.winpcap.org/docs/docs_40_2/html/group__wpcap__tut8.html)

# java - 升级还是不升级

> ID：766917
> 
> 赞同：2
> 
> 时间：2009-04-20T04:42:42.907
> 
> 标签：java, .net

我倾向于认为与最新版本保持同步是一件好事。这并不意味着产品一发布就升级——而是在之后相对较短的时间内（3-6 个月）。

升级可针对应用服务器、.NET Framework、Java SDK、数据库、第三方组件等。

我发现供应商通常会提供从一个版本到另一个版本的相当简单的升级路径，如果升级必须跳过几个版本（例如 .NET Framework 1.1 -> 3.5 sp1），升级就会变得更加成问题

如果应用程序在生产中运行良好且没有任何问题，我可以理解不进行任何更改并避免回归测试开销的愿望。但是，随着自动化单元测试的广泛采用，如果新版本在性能和/或功能方面提供显着优势，是否值得升级？

根据我的经验，我发现产品通常不会保持最新，并且当产品的特定版本不再受支持时，升级到最新版本的任务往往非常耗时且成本高昂。

我的问题是：

及时了解主要系统组件（如操作系统、应用程序服务器、数据库、框架等）的最新版本是否是个好主意？

**编辑**

目前，我们拥有经认证可使用 Java SDK 1.4.2 的 Oracle Application Server 10.1.2.x。Java 的最新版本现在是 1.6（目前正在开发 1.7），Oracle 应用服务器最高到 10.1.3（已通过 SDK 1.5+ 认证）。

通过升级到 SDK 1.5（至少），它为正在开发的新应用程序提供了可能性，以使用现有基础设施来使用更新版本的支持框架，例如 Hibernate 3.3 或 iBATIS 2.3.4 以及 JSP、JSF 的更高标准， ETC。

如果不进行这些升级，正在开发的新应用程序将仅限于使用旧版本，因此会增加未来升级的时间和成本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T05:03:35.447

我凭经验发现，在个人 linux 机器上对整个操作系统进行增量升级通常是不值得的。在进行系统范围的升级时，在 yum 或 apt-get 多次破坏我的系统之后，我通常会限制自己只升级那些我需要的软件包。特别是对于非 GUI 用户，我不记得上一次 Ubuntu 本身有一个杀手级功能而不是（比如）R 或 gcc。

服务器是另一回事——至少在安全补丁上你需要保持领先。

在软件方面，立即升级到新版本并没有像人们想象的那样让您领先一步。当您处理新版本引入的各种损坏时，您将使用砍刀清理并清理灌木丛，在 Stackoverflow 和其他地方发布答案。

然后其他人在 3 个月后跟随，并从你和其他人已经削减的路径中受益，所有早期采用者在网上发布的答案。您的有效潜在客户（可能）只有 1 个月。

（例外情况可能是 iPhone 平台或 Facebook 平台，其中开发时间以天为单位衡量，先发优势巨大。）

具有硬件的 IMO 可能更重要的是等待一段时间，直到您获得步进功能跳转。等到你达到相当于“四分之一油箱”的油量后再升级，因为你等待的时间越长，你的应用程序的阶跃函数跳跃就越大。第一代英特尔 Mac 可能是少数几个需要提前升级的机型之一，因为一夜之间升级如此明显。

尽管如此，我认为成为*概念*（尤其是数学）的早期采用者是至关重要的（显然）。软件可以在本地机器上使用，但 IMO 肯定在发布后至少等待 2-3 个月才能将其投入生产。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T06:02:49.783

Upgrade on a test system first. Validate. Wash rinse and repeat.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T06:14:41.313

A good reason to upgrade is that old systems will become unsupported. Java 1.4.2 for example is already at it's [end of service life](http://java.sun.com/j2se/1.4.2/) and while there's [Java SE for Business](http://www.sun.com/software/javaseforbusiness/index.jsp) (which is basically the same product, but with longer, paid support), it's a good idea to upgrade.

There are few worse things than having a major security problem found in an unsupported product that you require and not having any update path, because newer versions aren't tested.

I've seen a few companies pay major bucks to get support for some products (OS, hardware, ...) after the end of life of those products, just because they didn't have any upgrade strategy at hand.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T04:49:30.240

老实说，这个问题的“正确”答案取决于您正在谈论的确切软件包/系统，以及您如何配置它。此外，一些升级可能会破坏向后兼容性 - 所以问题是：“会破坏多少以及修复它需要多长时间？”

老实说，根据经验，我更喜欢在开发环境中尝试升级，然后部署到测试环境中，看看会有多少工作量。

我更喜欢将所有内容保留在当前版本的真正原因是：

> 产品通常不会保持最新，并且当产品的特定版本不再受支持时，升级到最新版本的任务往往非常耗时且成本高昂。

我同意，因此，每次可以升级某些东西时，我宁愿做一些工作，而不是等待并在以后对所有内容进行整理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T05:11:23.400

保持与当前版本相当接近绝对是一个好主意。通过不升级，您可以节省任何直接的问题，但您可以为项目/应用程序生命周期的后期节省大量工作。通常情况下，那些今天做出保守决定的人，等到绝对关键的升级需求出现时，他们就会“逍遥法外”。在那里，作为技术资源，我们有责任指出短期的痛苦总比以后彻底的项目崩溃要好。

我最好的例子是在 Oracle 8.0 上编写的大型系统，今天仍然在 Oracle 8.0 上 - 它经常失败，几乎不可能修补，因为该版本太旧了，一旦有人拥有它就会被丢弃政治cajones做到这一点。目前不升级的成本将超过 100 万美元/年，包括停机时间、专家支持以及与其他技术缺乏兼容性。

底线不是今天升级，意味着以后要花大笔钱。

# c# - 在没有OverflowException的情况下将“1.79769313486232E+308”转换为double？

> ID：766918
> 
> 赞同：15
> 
> 时间：2009-04-20T04:43:13.470
> 
> 标签：c#, .net, double

我有这个字符串“1.79769313486232E+308”并试图将其转换为 .NET 数值（双精度值？），但出现以下异常。我正在使用`Convert.ToDouble()`. 进行这种转换的正确方法是什么？

> 溢出异常：对于 Double 而言，值太大或太小

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-20T05:28:28.087

不幸的是，这个值大于`double.MaxValue`，因此例外。

正如 codekaizen 建议的那样，您可以对字符串的测试进行硬编码。如果您是首先*生成*字符串的人，那么更好的（IMO）替代方法是使用“r”格式说明符。然后您生成的字符串将改为“1.7976931348623157E+308”，然后正确解析：

```
string s = double.MaxValue.ToString("r");
double d = double.Parse(s); // No exception 
```

显然，如果您无法控制数据，那将无济于事——但您应该明白，在这种情况下，您可能已经丢失了数据。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-20T05:25:37.110

问题可能是由于`Double.MaxValue`转换为字符串，输出字符串时，并不是所有的数字都输出，而是四舍五入。解析这个值会溢出双精度值。

在失败的情况下使用`Double.TryParse`并随后检查字符串“1.79769313486232E+308”的相等性`Double.MaxValue`，如果您需要保持字符串原样，则替换应该是一种快速的解决方法。

编辑：当然，如果您不需要将字符串保持原样，请使用[Round Trip 格式说明符](https://docs.microsoft.com/en-us/dotnet/standard/base-types/standard-numeric-format-strings#RFormatString)首先生成字符串，正如[Jon 在他的回答中所描述的那样](https://stackoverflow.com/a/767011/58391)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T04:51:23.387

您可以尝试`double.Parse()`or`double.TryParse()`而不是`Convert.ToDouble()`，但我不确定您会得到更好的结果。顺便说一句，您提供的字符串等于`double.MaxValue`，这（当然）是双精度中可以包含的最大值，因此这很可能是您的错误来自哪里。浮点数字类型很挑剔，所以我假设正在发生某种舍入并将其推到类型的范围之外。

您也可以尝试`decimal`数据类型。在那里你可能会有更好的运气。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T07:29:12.243

这是我想出的。感谢 Jon Skeet 和 codekaizen。

```
private double convertToDouble(string str)
{
    double dbl;

    if (double.TryParse(str, out dbl))
        return dbl;

    if (str == "1.79769313486232E+308")
        return double.MaxValue;

    return double.MinValue;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-17T16:28:19.807

演示问题和解决方案：

```
var s = double.MaxValue.ToString();
double d;
if (!double.TryParse(s, out d)) {
    d = s.Equals(double.MaxValue) ? double.MaxValue : double.MinValue;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-13T09:12:57.543

Here a more generic implementation which representing different formatting and cultures and is more tolerant:

```
#region MatchDoubleMinMaxValuesRegex
/// <summary>
/// This regex matches strings which represents either a <see cref="double.MinValue"/> or a <see cref="double.MaxValue"/>.
/// If it is a <see cref="double.MinValue"/> then the group "isNegative" will be matched as <see cref="Group.Success"/>.
/// </summary>
private static readonly Regex MatchDoubleMinMaxValuesRegex = new Regex(
    @"
        ^
        (?>(?<isNegative>-)|\+?)
        1
        (?>[,.]?)
        79769313486232
        (?>
            [eE]\+308|
            0{294}(?>[,.]|$)
        )
    ",
    RegexOptions.Compiled | RegexOptions.IgnorePatternWhitespace
);
#endregion

/// <summary>
/// Converts the string representation of a number in a specified culture-specific format to its double-precision floating-point number equivalent.
/// <para>This implementation is more tolerant compared to the native double.Parse implementation:
/// strings representing <see cref="double.MinValue"/> and <see cref="double.MaxValue"/> can be parsed without <see cref="OverflowException"/>.</para>
/// </summary>
/// <param name="s">A string that contains a number to convert.</param>
/// <param name="cultureInfo">For some type conversions optional culture information that shall be used to parse the value.
/// If not specified, then the Current Culture will be used.</param>
/// <param name="numberStyles">For some type conversions optional number style configuration that shall be used to parse the value.
/// If not specified, then the default will be used.</param>
/// <returns>A double-precision floating-point number that is equivalent to the numeric value or symbol specified in <paramref name="s"/>.</returns>
/// <exception cref="ArgumentNullException"><paramref name="s"/> is <c>null</c>.</exception>
/// <exception cref="FormatException"><paramref name="s"/> does not represent a number in a valid format.</exception>
/// <exception cref="OverflowException"><paramref name="s"/> represents a number that is less than <see cref="double.MinValue"/> or greater than <see cref="double.MaxValue"/>.</exception>
public static double ParseDoubleEx(string s, CultureInfo cultureInfo = null, NumberStyles? numberStyles = null)
{
    // Try parse
    double tempValue;
    bool parseSuccess = (numberStyles != null)
        ? double.TryParse(s, numberStyles.Value, cultureInfo, out tempValue)
        : double.TryParse(s, NumberStyles.Any, cultureInfo, out tempValue);

    // If parsing failed, check for Min or Max Value (by pattern)
    if (parseSuccess == false)
    {
        Match match = MatchDoubleMinMaxValuesRegex.Match(s);
        if (match.Success == true)
            tempValue = (match.Groups["isNegative"].Success == false)
                ? double.MaxValue
                : double.MinValue;
        else
            throw new OverflowException("A double-precision floating-point number that is equivalent to the numeric value or symbol specified in s.");
    }

    return tempValue;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-06-05T14:35:21.620

我有时会收到相同的号码。这是我如何解决它的。

var str = "1.79769313486232E+308"; var dbl = double.Parse(str.Replace("E+", ""));

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-04-20T04:53:15.830

正如例外所说，这个数字对于双倍来说太大了。您将不得不找到一个大数字库来为您处理这个问题，因为我所知道的 .Net 库中没有任何东西可以处理非常大的数字。

# c# - 如何扩展 Bitmap 类

> ID：766923
> 
> 赞同：3
> 
> 时间：2009-04-20T04:45:18.737
> 
> 标签：c#, inheritance, bitmap

我正在尝试扩展 Bitmap 类，以便我可以将自己的效果应用于图像。当我使用此代码时：

```
namespace ImageEditor
{
    public class Effects : System.Drawing.Bitmap

    {
        public void toBlackAndWhite()
        {
            System.Drawing.Bitmap image = (Bitmap)this;
            AForge.Imaging.Filters.Grayscale filter = new AForge.Imaging.Filters.Grayscale();
            this = filter.Apply(this);
        }
    }
} 
```

我收到以下错误：

```
'ImageEditor.Effects': cannot derive from sealed type 'System.Drawing.Bitmap' 
```

那么有没有办法解决这个问题，或者根本不可能扩展类？

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-20T04:55:56.653

您不能从 Bitmap 派生，因为它是密封的。

如果要为 Bitmap 类添加方法，请编写扩展方法：

```
// Class containing our Bitmap extension methods.
public static class BitmapExtension
{
    public static void ToBlackAndWhite(this Bitmap bitmap)
    {
        ...
    }
} 
```

然后像这样使用它：

```
Bitmap bitmap = ...;
bitmap.ToBlackAndWhite(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T05:38:42.337

+1 犹大的回答。

此外，请考虑返回应用了过滤器的新位图，而不是修改原始位图。从长远来看，这将为您的应用程序提供更多选项（撤消等）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T04:54:04.097

密封类意味着作者明确规定任何类都不能从它继承。真的没有办法解决。如果您希望向 Bitmap 类添加功能，您可以查看[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。

当然，您可以编写一个包装类或实用程序类，但扩展方法会给您提供最类似于从`Bitmap`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T05:51:57.407

以前的答案很好 - 扩展方法在这里很好地适用。另外，我的第一个想法是继承不是一个很好的选择，因为您并没有真正创建不同类型的位图（是关系），您只是想打包一些代码来操作一个。换句话说，不需要将位图派生类传递给某个东西，您只需传递修改后的位图来代替原始位图。

如果您真的打算用您自己的方法覆盖 Bitmap 的某些方法，我会再次仔细查看您要完成的工作 - 对于像图像处理这样复杂的事情，您可能会更好地通过提供与原始方法一起提供的功能而不是来取代他们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-24T10:13:30.043

如果您移至 WPF，则可以扩展 BitmapSource 类，并且添加一个 toblackandwhite 方法很容易 - 但代价是必须使用 WPF 来读取位图。请参阅[自定义 BitmapSource](http://www.i-programmer.info/programming/wpf-workings/822-custom-bitmapsource.html)

# php - PHP/MYSQL - 将其推向极限？

> ID：766924
> 
> 赞同：5
> 
> 时间：2009-04-20T04:45:25.477
> 
> 标签：php, mysql, database

我已经编写 php 代码有一段时间了，并且非常牢牢地掌握它，MySQL，好吧，我可以说我可以让它工作。

我想制作一个统计脚本来跟踪其他网站的统计信息，例如明显的统计计数器、谷歌分析、薄荷等。

当然，我想正确地编写代码，而且我看不到 MySQL 每天喜欢 20,000,000 到 80,000,000 次插入（“大约 **”每秒 925 次插入）。

我一直在做一些研究，看起来我应该将每次访问“条目”存储到 csv 或其他形式的平面文件中，然后从中导入我需要的数据。

我在正确的轨道上吗？我只需要朝着正确的方向推动，该方向是一种每秒吸入 1,000 个伪“MySQL”插入的方法以及正确的方法。

示例插入：IP、time()、http_referer 等。

我需要收集这一天的这些数据，然后在一天结束时，或者在特定的时间间隔内，更新数据库中的一行，例如，我们获得了多少额外的唯一命中。我当然知道该怎么做，只是想给出一个可视化，因为我在解释事情方面很糟糕。

如果有人可以帮助我，我是一个很棒的程序员，我非常愿意回报你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T05:01:40.553

我们在去年夏天一直在工作的地方解决了这个问题。我们不需要太多的信息粒度，所以对我们来说非常有效的是按不同时间段合并数据。例如，我们将拥有一天的实时统计数据，然后将其推入一些每日总和，然后进入月度表。

这显然有一些巨大的缺点，即粒度损失。我们当时考虑了很多不同的方法。例如，正如您所说，CSV 或一些类似的格式可能会成为一次处理一个月数据的一种方式。然而，最大的问题是插入。

首先根据您需要保留哪些信息来设置一些示例模式，在这样做的过程中，您将引导自己（通过修订）找到适合您的信息。

大量插入的另一个注意事项：我们可能已经讨论了将实时统计信息转储到一个小守护程序的想法，该守护程序可以存储长达一个小时的数据，然后是非实时的，在下一次之前将其注入数据库时间到了。只是一个想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T06:06:23.317

对于您正在查看的那种活动，您需要从一个新的角度来看待问题：解耦。也就是说，您需要弄清楚如何解耦数据记录步骤，这样延迟和问题就不会在生产线上传播。

您有正确的想法将命中记录到数据库表中，只要保证按顺序、非竞争访问。这是数据库提供的东西。不幸的是，它是有代价的，其中之一是数据库`INSERT`在返回给您之前完成。因此，命中的记录与命中的调用相结合。记录命中的任何延迟都会减慢调用速度。

MySQL 提供了一种解耦的方法；它被称为`INSERT DELAYED`。实际上，你告诉数据库“插入这一行，但我不能在你这样做的时候留下来”，而数据库说“好的，我得到了你的行，有时间我会插入它”。可以想象，这减少了锁定问题，因为它允许 MySQL 中的一个线程进行插入，而不是您连接的任何一个线程。不幸的是，它只适用于 MyISAM 表。

另一种解决方案是对问题更通用的解决方案，它是有一个日志守护进程，它接受您的日志信息并将其排入队列到它必须去的任何地方。使这个快速的诀窍是排队步骤。这是 syslogd 将提供的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T06:20:02.767

在我看来，坚持使用 MySQL 来注册访问是一件好事，因为它提供了分析数据的工具。为了减少负载，我有以下建议。

*   制作一个快速收集表，除了主键、myisam 之外没有索引，每次点击一行
*   为命中建立一个标准化的数据结构，并每天将记录移动一次到该数据库。

这使您对日志记录的性能影响更小，并为查询/分析提供了良好索引的规范化结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T05:02:50.427

假设您的 MySQL 服务器与您的 Web 服务器位于不同的物理机器上，那么是的，将命中记录到本地文件系统上的文件然后定期将它们推送到数据库可能会更有效率。

不过，这会增加一些复杂性。您是否测试过或考虑过使用常规查询对其进行测试？即，使用 UPDATE 查询增加一个计数器（因为您不需要单独的行中的每个条目）。您可能会发现这并没有像您想象的那样减慢速度，但很明显，如果您每天推送 80,000,000 次页面浏览量，您可能根本没有太多回旋余地。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T06:18:23.193

只要您明智地做一些事情，您应该能够很容易地获得那种音量。这里有一些想法。

1.  您将需要定期（每小时，每天？）对审计表进行分区，如果没有别的，那么您可以删除旧分区以明智地管理空间。删除 10M 行并不酷。
2.  您的 Web 服务器（因为您将运行一个相当大的农场，对吗？）可能希望以异步方式大批量进行插入。您将拥有一个守护进程，它读取每个 Web 服务器机器上的平面文件日志并将它们批量处理。这对于 InnoDB 性能和避免审计减慢 Web 服务器很重要。此外，如果您的数据库不可用，您的 Web 服务器需要继续为 Web 请求提供服务并仍然对其进行审核（最终）
3.  当您收集大量数据时，需要进行一些总结，以便以合理的速度进行报告——如何做到这一点在很大程度上取决于您的喜好。做出明智的总结。
4.  InnoDB 引擎调整 - 您将需要非常显着地调整 InnoDB 引擎 - 特别是查看控制其使用磁盘刷新的变量。在每次提交时写出日志不会很酷（也许除非它在 ​​SSD 上 - 如果您需要性能和耐用性，请考虑为日志使用 SSD）:) 确保您的缓冲池足够大。就我个人而言，我会使用 InnoDB 插件和每表文件选项，但如果您完全了解 MyISAM 的特性和限制，您也可以使用它。

我不会进一步解释上述任何内容，就好像您的团队拥有开发人员技能来构建这种规模的应用程序一样，您要么知道它的含义，要么能够找到它。

如果您没有太多索引，那么 1000 行/秒对于现代硬件上的数据大小来说并非不现实；我们有时会插入那么多（并且可能有更多的索引）。

记得在生产规格的硬件上进行性能测试（我真的不需要告诉你，对吧？）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-20T06:06:05.797

我认为对于收集日志和总结日志的任务来说，使用 MySQL 是多余的。在你的情况下，我会坚持使用普通的日志文件。它没有提供关系数据库管理的全部功能，但足以生成摘要。现代操作系统上的简单锁定-追加-解锁文件操作是无缝且即时的。相反，使用 MySQL 进行相同的简单操作会增加 CPU 的负载，并可能导致交换和其他可扩展性的地狱。

还要注意存储。考虑到当前的硬盘价格/容量比和纯文本日志的可压缩性，使用纯文本文件，您将能够存储高负载网站多年的日志

# c# - sql server 中的文件流和用于 aspx 的 C#

> ID：766926
> 
> 赞同：3
> 
> 时间：2009-04-20T04:47:44.643
> 
> 标签：c#, sql-server-2008, filestream

我正在开发一个教育领域的网站。我想`Filestream`在 SQL Server 2008 中使用二进制格式将文档（MS Word 或文本文件）存储在数据库中。但我无法在文本框中检索文档。

我的代码如下：

```
string path = reader.GetString(0);
SqlFileStream stream1 = new SqlFileStream(path, (byte[])reader.GetValue(1), FileAccess.Read, FileOptions.SequentialScan, 0);   
StreamReader fs = new StreamReader(stream1);

fs = File.OpenText(path);
string s = fs.ReadToEnd();

txtInput.Text = s;
//lblStatus.Text = "File Succesfully Read!"
fs.Close(); 
```

此代码仅适用于存储在文件系统而不是数据库中的文档。所以我尝试了以下代码：

```
string path = reader.GetString(0);
SqlFileStream stream1 = new SqlFileStream(path, (byte[])reader.GetValue(1), FileAccess.Read, FileOptions.SequentialScan, 0);   
StreamReader fs = new StreamReader(stream1);

fs = File.OpenText(path);
string s = fs.ReadToEnd();

txtInput.Text = s;
//lblStatus.Text = "File Succesfully Read!"
fs.Close(); 
```

在此代码中，它在线给出错误`fs = File.OpenText(path);` 为“拒绝访问路径”。

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T05:47:52.300

查看这篇[文章](http://www.aghausman.net/dotnet/saving-and-retrieving-file-using-filestream-sql-server-2008.html)- 它详细展示了 SQL Server 2008 的文件流操作是如何工作的。

马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-30T08:00:13.453

您应该使用 stream1 读取数据。StreamReader 和 File.OpenText 方法不起作用，您只能使用 T-SQL 或 SqlFileStream 对象读取文件流数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T06:33:25.997

As per my understanding, you need to connect to the server Via Windows Authentication. It will not work with SQL Server Authentication. And the Windows User should able access the Shared folder created by SQL Server for storing the Data.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-08T05:36:40.553

在这两个示例中，您都没有使用 SqlFileStream 或 StreamReader，而只是使用 File.OpenText。

```
StreamReader fs = new StreamReader(stream1);

fs = File.OpenText(path);
string s = fs.ReadToEnd(); 
```

由于 File.OpenText 仅适用于磁盘上的文件，而不适用于 SQL 文件流，因此您需要使用流阅读器。这应该可以解决问题：

```
StreamReader fs = new StreamReader(stream1);

string s = fs.ReadToEnd(); 
```

# mysql - MySQL - 重复表

> ID：766928
> 
> 赞同：52
> 
> 时间：2009-04-20T04:49:24.233
> 
> 标签：mysql

我需要在 MySQL 中复制一个表，使新表为空。也就是说，我只需要将现有表的结构复制到新表中。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-04-20T04:55:04.983

尝试创建表 LIKE 语法。

```
create table users2 like users; 
```

这应该为您提供一个与原始表（用户）具有相同结构的空表（用户 2）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-05-21T20:25:18.897

还有另一种方法可以将空表创建为现有表，您也可以使用以下命令

```
create table a select * from users2 limit 0, 0; 
```

# c# - .NET Remoting：监视服务器上的事件

> ID：766936
> 
> 赞同：2
> 
> 时间：2009-04-20T04:52:43.213
> 
> 标签：c#, .net, remoting

首先，对不起我的英语。这不是我的母语。

这是问题所在：我正在编写基于.net 远程处理的客户端-服务器应用程序。该应用程序是某种计算器。

客户端应用程序有一些字段（数字 A 和数字 B，以及结果标签）和一些可能的操作，由按钮表示：加、减、乘、除等。

服务器应用程序是一个控制台应用程序，应该具有以下功能：

*   做这个计算
*   检测，特定客户端执行了哪些操作。

例如输出：

```
Server started
Client A(IP: 192.168.0.133) connected<br>
Client A Add 18 to 12<br>
Client A disconnected 
```

主要问题是 - 如何在服务器上获取操作以及我如何检测客户端做什么。谢谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T10:33:05.733

我知道使用 .NET Remoting 进行跟踪的 2种*常用*方法：

*   在 app.config 中开启跟踪
*   使用来自 Codeproject.com 的开源项目[Remoting Analyzato​​r Studio。](http://www.codeproject.com/KB/IP/remotingprobe.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-03T04:29:24.427

这可能并不理想，但您可以创建一个自定义接收器，该接收器连接到记录所有远程处理流量的远程处理通道。[您可以从 Ingo Rammer 的Advanced .NET Remoting](https://rads.stackoverflow.com/amzn/click/com/1590594177)一书中了解如何创建自定义接收器。

我过去曾用他的书创建自定义水槽。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-09T18:57:05.353

为此，我们修改了 Mono TCP 远程处理通道。这大约需要 30 分钟，您可以添加有关正在调用的方法调用、执行时间等信息。事实证明，它是衡量真实服务器性能的极好工具。您可以解析输出并了解哪些方法需要更多时间，发送或接收更多数据等等。真的很有帮助。

# loops - 寻找具有多个嵌套循环的 Big-O？

> ID：766939
> 
> 赞同：6
> 
> 时间：2009-04-20T04:53:32.647
> 
> 标签：loops, nested, big-o

```
int num = n/4;
for (int i = 1; i <= num; i++) {
    for (int j = 1; j <= n; j++) {
        for (int k = 1; k <= n; k++) {
            int count = 1;
        }
    }
} 
```

根据我读过的书，这段代码应该是O((n^3)/4)。但显然不是。要找到嵌套循环的 Big-O，你应该乘以界限吗？所以这个应该是 num *n *n 或 n/4 *n *n。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-20T04:57:07.553

`O((n^3)/4)`就大 O 表示法而言没有意义，因为它旨在将复杂性衡量为参数的比率。除以 4 没有任何效果，因为这会改变比率的值，但不会改变其性质。

所有这些都是等价的：

```
O(n^3)
O(n^3/4)
O(n^3*1e6) 
```

其他术语仅在包含术语时才有意义`n`，例如：

```
O(n^3 / log(n))
O(n^3 * 10^n) 
```

正如 Anthony Kanago 正确指出的那样，惯例是：

*   只保留总和增长率最高的项：`O(n^2+n) = O(n^2)`.
*   摆脱产品的常量：`O(n^2/4) = O(n^2)`.

顺便说一句，我并不总是在所有情况下都同意第一条规则。这是决定函数最大增长率的好规则，但对于算法比较^((a))之类的事情，您可以智能地对输入参数设置限制，类似`O(n^4+n^3+n^2+n)`的事情明显比`O(n^4)`.

在这种情况下，应包括*任何依赖于输入参数的术语。*事实上，即使是常数项在那里也可能有用。例如，比较一下`O(n+1e100)`-`O(n^2)`后者将在相当长一段时间内优于前者，直到`n`变得足够大以对常数项产生影响。

* * *

^((a))当然，有些人会说不应该以这种方式使用它，但实用主义通常会在现实世界中克服教条主义 :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T05:02:54.623

从[http://en.wikipedia.org/wiki/Big_O_notation](http://en.wikipedia.org/wiki/Big_O_notation)您可以看到像 1/4 这样的常量对于确定 Big-O 表示法没有任何作用。唯一有趣的事实是它是 n^3，因此是 O(N^3)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-17T21:54:07.180

形式上，时间复杂度可以如下推导：

![在此处输入图像描述](https://i.stack.imgur.com/Y3qqW.png)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-20T05:41:29.443

一个小技术。大 O 表示法旨在根据输入的“大小”而不是数值来描述复杂性。如果您的输入是一个数字，那么输入的大小就是您的数字的位数。唉，您的算法是 O(2^N^3) ，其中 N 是位数。

[有关此主题的更多信息](http://en.wikipedia.org/wiki/Pseudo-polynomial_time)

# ruby - C++ 常量的 Ruby 等价物？

> ID：766952
> 
> 赞同：1
> 
> 时间：2009-04-20T04:59:30.777
> 
> 标签：ruby, variables, constants, mutable

我在业余时间学习 Ruby，我有一个关于常量语言结构的问题。Ruby 是否有等效的 C++ const 关键字来防止变量被修改？这是一些示例代码：

```
first_line   = f.gets().chomp()
column_count = first_line.split( %r{\s+} ).size()
print column_count, "\n" 
```

我想将 column_count 声明为 const，因为我在下面的程序中使用它，我真的不想错误地修改它。Ruby 是否为此提供了一种语言结构，还是我应该接受它并意识到我的变量总是可变的？

回复评论：

“我猜，变量“意外”覆盖的最可能原因是长代码块。我同意你的观点的精神，但不同意这封信。您关于避免长代码块和不必要状态的观点是一个很好的观点，但对于常量也可以用于描述实现内部的代码设计。我的代码中 const 的很大一部分价值来自于注释哪些变量我应该更改，哪些我不应该更改，因此如果我明年回到我的代码，我不会想更改它们。这与暗示由于良好的变量名和清晰的缩进而使用简短注释的代码比由详细注释解释的笨拙编写的代码更好的观点相同。

另一个选项似乎是 Ruby 的 #freeze 方法，我也喜欢它的外观。感谢大家的回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T08:18:21.813

Ruby*变量*通常是可变的。

除了 Jeremy 的回答，虽然完全准确，但不会引导您使用非常“主流”或惯用语的 Ruby 风格，我不建议采用它。Ruby 不像 C++ 那样工作，并且通常不太适合 C++ 最适合使用的东西。操作系统，文字处理器，诸如此类。

我猜，变量“意外”覆盖的最可能原因是长代码块。毕竟，如果您在五行方法中更改变量的值，那将是相当明显的！如果您习惯性地编写超过 10 行的代码块，那么这些代码块可能做的事情太多，我强烈建议您努力将它们分解（增加[凝聚力](http://en.wikipedia.org/wiki/Cohesion_(computer_science))）。尽可能本地化变量，以尽量减少意外副作用的机会（减少[耦合](http://en.wikipedia.org/wiki/Coupling_(computer_science))）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T14:40:24.953

按照惯例，ruby 中的常量一般都是大写的，比如 COLUMN_COUNT。但正如所指出的，所有以大写字母开头的变量都是常量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T05:02:45.340

以大写字母开头的变量是 Ruby 中的常量。因此，您可以将代码更改为：

```
first_line   = f.gets().chomp()
Column_count = first_line.split( %r{\s+} ).size()
print Column_count, "\n" 
```

现在，如果您尝试修改`Column_count`.

# java - 如何在 Java Swing 中创建右键单击上下文菜单？

> ID：766956
> 
> 赞同：115
> 
> 时间：2009-04-20T05:01:07.437
> 
> 标签：java, swing, contextmenu, jpopupmenu

我目前正在通过`JMenu`在右键单击时实例化一个新的并将其位置设置为鼠标位置来创建右键单击上下文菜单......有更好的方法吗？

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2009-04-20T07:32:13.577

您可能`setVisible(true)`在菜单上手动调用。这可能会导致菜单中出现一些令人讨厌的错误行为。

该`show(Component, int x, int x)`方法处理您需要发生的所有事情（在鼠标悬停时突出显示内容并在必要时关闭弹出窗口），其中使用`setVisible(true)`仅显示菜单而不添加任何其他行为。

要制作右键单击弹出菜单，只需创建一个[`JPopupMenu`](http://java.sun.com/javase/6/docs/api/javax/swing/JPopupMenu.html).

```
class PopUpDemo extends JPopupMenu {
    JMenuItem anItem;
    public PopUpDemo() {
        anItem = new JMenuItem("Click Me!");
        add(anItem);
    }
} 
```

然后，您需要做的就是为[`MouseListener`](http://java.sun.com/javase/6/docs/api/java/awt/event/MouseListener.html)您希望弹出菜单的组件添加一个自定义项。

```
class PopClickListener extends MouseAdapter {
    public void mousePressed(MouseEvent e) {
        if (e.isPopupTrigger())
            doPop(e);
    }

    public void mouseReleased(MouseEvent e) {
        if (e.isPopupTrigger())
            doPop(e);
    }

    private void doPop(MouseEvent e) {
        PopUpDemo menu = new PopUpDemo();
        menu.show(e.getComponent(), e.getX(), e.getY());
    }
}

// Then on your component(s)
component.addMouseListener(new PopClickListener()); 
```

当然，教程有[更深入的](http://docs.oracle.com/javase/tutorial/uiswing/components/menu.html#popup)解释。

**注意：**如果您发现弹出菜单与用户单击的位置相去甚远，请尝试对 x 和 y 坐标使用`e.getXOnScreen()`and`e.getYOnScreen()`方法。

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2011-11-08T15:47:12.600

这个问题有点老 - 答案也是如此（以及教程）

当前在 Swing 中设置 popupMenu 的 api 是

```
myComponent.setComponentPopupMenu(myPopupMenu); 
```

这样，鼠标和键盘触发器都会自动显示（后者取决于 LAF）。此外，它支持在容器的子项中重复使用相同的弹出窗口。要启用该功能：

```
myChild.setInheritsPopupMenu(true); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-04-20T05:03:46.557

[The Java Tutorials](http://java.sun.com/docs/books/tutorial/index.html)的[How to Use Menus](http://java.sun.com/docs/books/tutorial/uiswing/components/menu.html#popup)文章中有一个关于[弹出弹出菜单](http://java.sun.com/docs/books/tutorial/uiswing/components/menu.html#popup)的部分解释了如何使用该类。[`JPopupMenu`](http://java.sun.com/javase/6/docs/api/javax/swing/JPopupMenu.html)

教程中的示例代码展示了如何将`MouseListener`s 添加到应该显示弹出菜单的组件中，并相应地显示菜单。

（您描述的方法与教程介绍在组件上显示弹出菜单的方式非常相似。）

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-02-02T17:51:08.297

下面的代码实现了一个默认的上下文菜单，可以从`Windows`复制、剪切、粘贴、全选、撤消和重做功能中得知。它也适用于`Linux`和`Mac OS X`：

```
import javax.swing.*;
import javax.swing.text.JTextComponent;
import javax.swing.undo.UndoManager;
import java.awt.*;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.DataFlavor;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

public class DefaultContextMenu extends JPopupMenu
{
    private Clipboard clipboard;

    private UndoManager undoManager;

    private JMenuItem undo;
    private JMenuItem redo;
    private JMenuItem cut;
    private JMenuItem copy;
    private JMenuItem paste;
    private JMenuItem delete;
    private JMenuItem selectAll;

    private JTextComponent textComponent;

    public DefaultContextMenu()
    {
        undoManager = new UndoManager();
        clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();

        addPopupMenuItems();
    }

    private void addPopupMenuItems()
    {
        undo = new JMenuItem("Undo");
        undo.setEnabled(false);
        undo.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_Z, Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()));
        undo.addActionListener(event -> undoManager.undo());
        add(undo);

        redo = new JMenuItem("Redo");
        redo.setEnabled(false);
        redo.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_Y, Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()));
        redo.addActionListener(event -> undoManager.redo());
        add(redo);

        add(new JSeparator());

        cut = new JMenuItem("Cut");
        cut.setEnabled(false);
        cut.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_X, Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()));
        cut.addActionListener(event -> textComponent.cut());
        add(cut);

        copy = new JMenuItem("Copy");
        copy.setEnabled(false);
        copy.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_C, Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()));
        copy.addActionListener(event -> textComponent.copy());
        add(copy);

        paste = new JMenuItem("Paste");
        paste.setEnabled(false);
        paste.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_V, Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()));
        paste.addActionListener(event -> textComponent.paste());
        add(paste);

        delete = new JMenuItem("Delete");
        delete.setEnabled(false);
        delete.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_DELETE, Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()));
        delete.addActionListener(event -> textComponent.replaceSelection(""));
        add(delete);

        add(new JSeparator());

        selectAll = new JMenuItem("Select All");
        selectAll.setEnabled(false);
        selectAll.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_A, Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()));
        selectAll.addActionListener(event -> textComponent.selectAll());
        add(selectAll);
    }

    private void addTo(JTextComponent textComponent)
    {
        textComponent.addKeyListener(new KeyAdapter()
        {
            @Override
            public void keyPressed(KeyEvent pressedEvent)
            {
                if ((pressedEvent.getKeyCode() == KeyEvent.VK_Z)
                        && ((pressedEvent.getModifiersEx() & Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()) != 0))
                {
                    if (undoManager.canUndo())
                    {
                        undoManager.undo();
                    }
                }

                if ((pressedEvent.getKeyCode() == KeyEvent.VK_Y)
                        && ((pressedEvent.getModifiersEx() & Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()) != 0))
                {
                    if (undoManager.canRedo())
                    {
                        undoManager.redo();
                    }
                }
            }
        });

        textComponent.addMouseListener(new MouseAdapter()
        {
            @Override
            public void mousePressed(MouseEvent releasedEvent)
            {
                handleContextMenu(releasedEvent);
            }

            @Override
            public void mouseReleased(MouseEvent releasedEvent)
            {
                handleContextMenu(releasedEvent);
            }
        });

        textComponent.getDocument().addUndoableEditListener(event -> undoManager.addEdit(event.getEdit()));
    }

    private void handleContextMenu(MouseEvent releasedEvent)
    {
        if (releasedEvent.getButton() == MouseEvent.BUTTON3)
        {
            processClick(releasedEvent);
        }
    }

    private void processClick(MouseEvent event)
    {
        textComponent = (JTextComponent) event.getSource();
        textComponent.requestFocus();

        boolean enableUndo = undoManager.canUndo();
        boolean enableRedo = undoManager.canRedo();
        boolean enableCut = false;
        boolean enableCopy = false;
        boolean enablePaste = false;
        boolean enableDelete = false;
        boolean enableSelectAll = false;

        String selectedText = textComponent.getSelectedText();
        String text = textComponent.getText();

        if (text != null)
        {
            if (text.length() > 0)
            {
                enableSelectAll = true;
            }
        }

        if (selectedText != null)
        {
            if (selectedText.length() > 0)
            {
                enableCut = true;
                enableCopy = true;
                enableDelete = true;
            }
        }

        if (clipboard.isDataFlavorAvailable(DataFlavor.stringFlavor) && textComponent.isEnabled())
        {
            enablePaste = true;
        }

        undo.setEnabled(enableUndo);
        redo.setEnabled(enableRedo);
        cut.setEnabled(enableCut);
        copy.setEnabled(enableCopy);
        paste.setEnabled(enablePaste);
        delete.setEnabled(enableDelete);
        selectAll.setEnabled(enableSelectAll);

        // Shows the popup menu
        show(textComponent, event.getX(), event.getY());
    }

    public static void addDefaultContextMenu(JTextComponent component)
    {
        DefaultContextMenu defaultContextMenu = new DefaultContextMenu();
        defaultContextMenu.addTo(component);
    }
} 
```

用法：

```
JTextArea textArea = new JTextArea();
DefaultContextMenu.addDefaultContextMenu(textArea); 
```

现在，`textArea`当它被右键单击时将有一个上下文菜单。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-25T07:22:23.420

我将更正@BullyWillPlaza 建议的该方法的用法。原因是，当我尝试将 textArea 添加到仅 contextMenu 时，它是不可见的，如果我将它添加到 contextMenu 和某个面板，它会遇到：如果我尝试切换到设计编辑器，则会出现不同的父双重关联。

```
TexetObjcet.addMouseListener(new MouseAdapter() {
        @Override
        public void mouseClicked(MouseEvent e) {
            if (SwingUtilities.isRightMouseButton(e)){
                contextmenu.add(TexetObjcet);
                contextmenu.show(TexetObjcet, 0, 0);
            }
        }
    }); 
```

为您需要弹出的文本对象制作这样的鼠标侦听器。这将做的是当您右键单击您的文本对象时，它将添加该弹出窗口并显示它。这样您就不会遇到该错误。@BullyWillPlaza 制作的解决方案非常好，丰富且快速地在您的程序中实施，因此您应该尝试一下，看看您喜欢它。

# c# - 突出显示 flowlayoutpanel 中的选定项目

> ID：766957
> 
> 赞同：3
> 
> 时间：2009-04-20T05:01:11.337
> 
> 标签：c#, winforms, flowlayoutpanel

如何在 flowlayoutpanel 中突出显示所选项目（在我的情况下是自定义用户控件）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T05:08:13.597

FlowLayoutPanel 纯粹用于布局 - 它没有“选定项目”的概念。您可能可以向 UserControl 添加一些逻辑，当它接收到焦点时会更改其颜色（并在失去焦点时更改回来），但这将独立于托管它的布局控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-17T02:38:08.803

检查这个实现，[通过事件处理](http://www.daniweb.com/software-development/csharp/threads/228060/how-to-select-particular-control-from-flowlayout-panel)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-09T16:46:09.470

我创建了一个 Bindable FlowLayoutPanel，其中包括设置选定的索引（突出显示取决于选定的控件。我将它发布在[代码审查](https://codereview.stackexchange.com/questions/8816/binding-flowlayoutpanel)网站上。检查一下，让我知道这是否适合你。

# linux - 抑制 gcc 警告：“警告：这是先前定义的位置”

> ID：766964
> 
> 赞同：3
> 
> 时间：2009-04-20T05:03:40.113
> 
> 标签：linux, gcc-warning, include-guards

我需要一组围绕标准系统调用的包装器——open、listen 等。对于这些，我有一些“#define”，如：

```
#define open(a,b,c) JCL_Open(a,b,c) 
```

但是当我编译头文件和相关的 .c 文件时，我收到以下警告：

/jcl_wrappers.h:114:1: warning: "open" redefined
/jcl_wrappers.h:113:1: warning: 这是之前定义的位置

我怎样才能抑制这些警告？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T05:07:45.657

在你的头文件中[加入包含守卫](http://en.wikipedia.org/wiki/Include_guard)。

基本上你需要把这两行放在你的头文件的开头

```
#ifndef _yourincludefilename_h_
#define _yourincludefilename_h_ 
```

和

```
#endif /* _yourincludefilename_h_ */ 
```

最后包含文件。

编辑：
rascher 是对的，open 对宏来说不是一个好名字，因为它会与库函数冲突。通常将宏全部大写是很好的 C 约定，所以我建议将宏更改为

```
#define OPEN(a,b,c) JCL_Open(a,b,c) 
```

甚至更好

```
#define XYZ_OPEN(a,b,c) JCL_Open(a,b,c) 
```

其中 XYZ 是特定于您的代码的前缀。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-20T05:09:04.140

保留标准函数并重命名函数：

```
#define myopen(a,b,c) JCL_Open(a,b,c) 
```

以后有人会感谢你的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T05:10:18.647

您可以尝试使用编译防护。像：

my_headers.h：

```
#ifndef __MY_HEADERS
#define __MY_HEADERS

  #define open(a,b,c) JCL_Open(a,b,c)

#endif 
```

如果已经定义了“__MY_HEADERS”宏，这只会执行#ifndef 和#endif 之间的操作。因此，您的 .h 文件中的所有内容都只会被声明一次。

您可以使用相同的构造来查看是否已经定义了“open”宏。

另请注意，已经有一个名为 open() 的 C 函数：http: [//www.manpagez.com/man/2/open/](http://www.manpagez.com/man/2/open/)。为宏使用相同的名称可能不是一个好主意！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T05:08:00.180

将定义包装在：

```
#ifndef JCL_WRAPPERS_H
#define JCL_WRAPPERS_H

... your macro's

#endif 
```

如果您在多个位置包含标题，这可以确保您的宏只定义一次。

对于标题中的所有原型，这通常也是一件明智的事情。

# find - HTML 遍历和查找最佳实践

> ID：766979
> 
> 赞同：0
> 
> 时间：2009-04-20T05:10:01.640
> 
> 标签：find, traversal

嘿，我正在考虑制作一些爬虫，以便我可以获取 URL 并遍历 html 并获取我可能需要/想要的某些东西。我正在考虑使用 Php + xPath，但我不确定这可能是最好的方法。你们有什么感想？是否有任何最佳实践、建议或其他内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T19:28:38.373

重用 Fit/Fitnesse 中的 Parse 类从 html 表中获取数据，我得到了一些很好的结果。

# sql - 编写 sql 查询的方式会影响性能吗？

> ID：766981
> 
> 赞同：4
> 
> 时间：2009-04-20T05:10:20.550
> 
> 标签：sql, linq

说我有一张桌子

```
Id int
Region int
Name nvarchar

select * from table1 where region = 1 and name = 'test'

select * from table1 where name = 'test' and region = 1 
```

性能会有差异吗？假设没有索引

与LINQ一样吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T05:16:42.203

因为您的限定词本质上实际上是相同的（放置 where 子句的顺序无关紧要），所以不，它们之间没有区别。

至于 LINQ，您将需要知道 LINQ to SQL 实际发出的查询（您可以使用 SQL Profiler 来查找）。有时查询将是您能想到的最简单的查询，有时由于对 FK 的依赖或其他此类约束等原因，它会在您没有意识到的情况下变得复杂。LINQ 也不会使用 * 进行选择。

唯一真正了解的方法是找出两个查询的 SQL Server 查询执行计划。要阅读有关该主题的更多信息，请访问此处：

[SQL Server 查询执行计划分析](http://www.sql-server-performance.com/tips/query_execution_plan_analysis_p1.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T05:15:35.090

应该是？不。SQL 是一种关系代数，DBMS 应该优化而不考虑语句中的顺序。

可以？可能。一些 DBMS 可能会以某种顺序存储数据（例如，维护某种密钥），尽管他们被告知了什么。但是，关键是：你不能依赖它。

您可能需要在将来的某个时候切换 DBMS。*即使是同一*DBMS的更高版本也可能会改变其行为。您唯一应该依赖的是 SQL 标准中的内容。

关于给出的查询：在所讨论的两个字段上没有索引或主键，您应该假设您需要对这两种情况进行全表扫描。因此它们应该以相同的速度运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T05:19:41.523

我不推荐 *，因为引擎应该在执行查询之前查找表方案。而是使用您想要避免不必要开销的表字段。

是的，引擎优化了您的查询，但帮助他:)。

最好的祝福！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T15:51:57.963

对于简单的查询，可能几乎没有差异，但是确实，您编写查询的方式会对性能产生巨大影响。

在 SQL Server 中（性能问题是非常特定于数据库的），与在派生表的联接中执行相同操作相比，相关子查询的性能通常较差。

查询中可能影响性能的其他事情包括使用 SARGable ¹ where 子句而不是非 SARGable 子句，仅选择您需要的字段并且从不使用 select *（尤其是在执行连接时，因为至少重复了一个字段），使用一个基于集合的查询而不是游标，避免使用通配符作为 aa like 子句中的第一个字符，等等。有很多非常大的书专门用章节来介绍更有效的查询编写方法。

¹ “SARGable”，对于那些不知道的人来说，是 DB2 用语中的第 1 阶段谓词（可能还有其他 DBMS）。第 1 阶段的谓词效率更高，因为它们是索引的一部分，而 DB2 首先使用它们。

# .htaccess - .htaccess 重定向主域？

> ID：766985
> 
> 赞同：2
> 
> 时间：2009-04-20T05:14:35.047
> 
> 标签：.htaccess

如何将请求重定向`mydomain.tld/somepage.ext`到`mydomain.tld/mydomain/somepage.ext`？我有这样的子域`subdomain.mydomain.tld`，我不想受此影响。

我似乎无法让它正常工作。我正在尝试这个：

```
RewriteEngine on

RewriteCond %{HTTP_HOST} mysite.com
RewriteCond %{REQUEST_URI} !^/mysite
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule (.*) /mysite/$1 
```

但它根本没有重定向任何东西。

我还想从这条规则中排除一两个文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T06:52:38.213

这似乎工作......

```
RewriteEngine on

RewriteCond %{HTTP_HOST} mysite\.com$ [NC]
RewriteCond %{REQUEST_URI} !^/mysite/         # but I don't see why this line is needed when I've used [L] below
RewriteCond %{REQUEST_URI} !^/ignored_folder/
RewriteRule .* /mysite/$0 [QSA,L] 
```

至少现在。

# javascript - 统一Prototype和JQuery的$函数

> ID：766986
> 
> 赞同：-1
> 
> 时间：2009-04-20T05:15:22.487
> 
> 标签：javascript, jquery, prototypejs, conflict

是否有任何 JavaScript 函数可以统一 Prototype 和 jQuery 中的 $ 函数？

是的，这是我现在面临的真正用例。我发现 Prototype 中的 $ 函数和 jQuery 中的 $ 相互冲突。我知道我们可以使用 jQuery.noConflict() 将 $ 重新分配回 Prototype，但是这样做，我将不得不重写使用该 $ 函数的 jquery 特定的 javacript 代码，或者在代码块中具有 jquery 特定的代码（例如。匿名函数）。

有没有更简单的方法，而不必重写两个库中的现有代码并将它们放在一页中？

可以回答这个问题的代码可能如下所示，非常感谢您的反馈：

```
<script type="text/javascript" src="/path/to/prototype.js"></script>
<script type="text/javascript" src="/path/to/jquery.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var $j = jQuery.noConflict();
var $p = $; // reference to prototype's $
var $ = function(E, F){
  var isJQuery = true;

  //TODO: logic to determine which $ to use here YOUR SUGGESTION HERE ;-)

  var result = null;
  if(isJQuery){
    result = $j(E, F);
  } else { // prototype
    //TODO: code to delegate prototype $
  }

  return result;
}
/* ]]>*/
</script>

// ... any existing javacode jQuery and Prototype using $ function. 
```

谢谢。

**更新**：重写问题更清楚。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T05:40:38.527

好吧，首先，我很少能找到两个库必须包含在同一页面中的有用案例。所以你可能会考虑删除一个。
我猜这是因为使用了插件，但是看看对手的插件列表，我很确定还有一个替代品。

其次，对于您的 jQuery 特定代码，使用匿名函数技巧很容易重写它：

```
(function($){
  ... your code here ...
})(jQuery); 
```

这适用于大多数不放置全局变量或方法而不是将它们绑定到事件的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T05:43:50.967

我一直养成将所有 jQuery 代码放入函数的习惯，类似于 gizmo 的示例：

```
jQuery(function($) {
    // jQuery code here, using $
}); 
```

这与 document.ready 事件处理程序相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T13:41:20.477

jQuery 在确保它们与 Prototype 良好配合方面做得很好。查看此页面了解详细信息，[避免与其他库发生冲突](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)。

我之前在同一个页面中看到过这两个库，这通常是因为您的页面中的第三方应用程序使用一个库，而您的页面使用另一个库。但是，如果您自己进行所有开发，我建议坚持使用其中一个。

# database - 在维护历史和当前数据时如何获得性能？

> ID：766987
> 
> 赞同：2
> 
> 时间：2009-04-20T05:15:29.507
> 
> 标签：database, performance, database-design, postgresql

我想将过去十年的股市数据保存在一个表中。某些分析只需要最近一个月的数据。当我做这个短期分析时，完成操作需要很长时间。

为了克服这个问题，我创建了另一个表来单独保存当年的数据。当我从这张表中执行分析时，它比上一张快 20 倍。

现在我的问题是：

1.  这是为此类问题设置单独表格的正确方法吗？（或者我们使用单独的数据库而不是表）
2.  如果我有单独的表有没有办法自动更新辅助表。
3.  或者我们可以使用非物质化视图之类的东西来获得性能。

注意：我使用的是 Postgresql 数据库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T08:39:13.963

你想要[表分区](http://www.postgresql.org/docs/8.3/interactive/ddl-partitioning.html)。这将自动在多个表之间拆分数据，并且通常比手动操作要好得多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T19:21:42.420

我正在研究完全相同的问题。
表分区绝对是这里的方法。不过，我会按一年以上进行分段，这会给你更大程度的控制。只需设置您的分区，然后按月（或其他日期）限制它们。在您的 postgresql.conf 中，您需要打开 constraint_exclusion=on 才能真正获得好处。这里的另一个好处是您只能索引您真正想要从中提取信息的确切表。如果您将大量数据批量导入此表中，则规则与触发器的结果可能会稍好一些，对于分区，我发现规则更易于维护。但是对于较小的事务，触发器要快得多。postgresql 手册中有一个关于通过继承进行分区的重要部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T21:40:34.413

坦率地说，在采取更激进的步骤之前，您应该检查您的执行计划并尝试修复您的查询或索引。

索引的成本非常低（除非您进行大量插入），并且您现有的代码会更快（如果您正确索引）而无需修改它。

之后还有其他措施，例如分区……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T05:19:25.067

我不确定 PostgreSQL，但我可以确认您走在正确的轨道上。在处理大数据量时，将数据分区到多个表中，然后使用某种查询生成器来构建查询绝对是正确的方法。这种方法在数据仓库中得到了很好的建立，特别是在您的案例股票市场数据中。

但是，我很好奇你为什么需要更新你的历史数据？如果您正在处理股票分割，通常使用单独的乘数表来实现这一点，该乘数表与原始历史数据结合使用以提供准确的价格/份额。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T09:41:10.773

1.  对历史记录使用单独的表格是完全明智的。单独的数据库问题更大，因为编写跨数据库查询并不简单
2.  自动更新 - 它是 cronjob 的工具
3.  你可以对这些事情使用部分索引——它们做得很好

# excel - 从 Windows Scripting Host 操作 Excel 文件

> ID：766992
> 
> 赞同：2
> 
> 时间：2009-04-20T05:17:28.050
> 
> 标签：excel, vbscript, ado, wsh

有没有一种快速的方法可以从 Windows Scripting Host 操作**现有**XLS 文件的内容？

我们有从客户那里收到的 Excel 模板。我们的任务是用我们从 Oracle 数据库中获取的数据填充这些模板。

当前的方法是使用 Windows Scripting Host 和 VBScript：

1.  使用 ADODB 从 Oracle 获取数据：

    ```
    Set db = CreateObject("ADODB.Connection")
    SQL = "SELECT ..."
    Set rs=db.execute(SQL) 
    ```

2.  使用 VBScript 在 Windows Scripting Host 中创建 Excel 对象：

    ```
    Set objExcel = CreateObject("Excel.Application")  
    Set objWorkbook = objExcel.Workbooks.Open(xls_final)  
    Set objSheet = objWorkBook.Sheets(1) 
    ```

3.  然后像这样逐个单元格地填写模板：

    ```
    If rs.EOF = False Then
       rs.MoveFirst
       Do Until rs.EOF
          objSheet.Cells(RowNumber, 1).Value = rs("COLUMN1")
          objSheet.Cells(RowNumber, 2).Value = rs("COLUMN2")
          objSheet.Cells(RowNumber, 3).Value = rs("COLUMN3")
          rs.MoveNext
       Loop
    End If
    objWorkbook.Save 
    rs.Close 
    ```

问题是其中一些文件包含大量数据，并且像这样填充它们需要几个小时。有更快的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T08:09:09.480

我认为你在这里很好：

```
Set db = CreateObject("ADODB.Connection")
SQL = "SELECT ..."
Set rs=db.execute(SQL)

Set objExcel = CreateObject("Excel.Application")  
Set objWorkbook = objExcel.Workbooks.Open(xls_final)  
Set objSheet = objWorkBook.Sheets(1) 
```

但正如您所发现的，其余的将会非常缓慢。与工作表的交互具有很高的开销，您需要为每一行中的每一列付费。有一些方法可以解决这个问题。

最简单的是

```
objSheet.Cells(1,1).CopyFromRecordset rs 
```

我建议你先试试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T17:34:53.847

看看这个。
[http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=49926](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=49926)
如果您使用 ADODB 连接到 excel，而不是操作 Excel，它也可能会有所帮助。如果您需要帮助，请阅读这篇文章。
[http://support.microsoft.com/kb/257819](http://support.microsoft.com/kb/257819)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T05:22:22.080

一种可能性是使其成为一个两阶段的过程，但这取决于瓶颈在哪里。

如果是 Excel，则只需将记录集行转换为 CSV 类型的文件，然后在完成后创建 Excel 对象并将整个文件导入到固定位置。

这可能会比逐个单元的操作更快。

如果您无法将 CSV 导入工作表上的固定位置（单元格不在连续的行或列中），我会将 CSV 导入新工作表，然后从那里大量复制到您的模板工作表。

移动范围也应该比逐个单元格的操作更快。

批量导入和批量复制应该会给您带来一些不错的改进。当您使用更复杂的 Excel 功能（想想使用 =sum(a1..a999) 而不是在 VBA 中添加每个单独的单元格并将该值放在某处时，我有处理单个单元格的工作表，这些单元格的速度提高了 10 倍）。

至于如何从 VBA 导入，我总是依靠该`"Record Macro"`功能来获得可以修改的基线（对于那些我不熟悉的人）。这一个导入`c:\x.csv`到当前工作表中`C7`：

```
With ActiveSheet.QueryTables.Add(Connection:="TEXT;C:\x.csv", _
    Destination:= Range("C7"))
    .Name = "x"
    .FieldNames = True
    .RowNumbers = False
    .FillAdjacentFormulas = False
    .PreserveFormatting = True
    .RefreshOnFileOpen = False
    .RefreshStyle = xlInsertDeleteCells
    .SavePassword = False
    .SaveData = True
    .AdjustColumnWidth = True
    .RefreshPeriod = 0
    .TextFilePromptOnRefresh = False
    .TextFilePlatform = 850
    .TextFileStartRow = 1
    .TextFileParseType = xlDelimited
    .TextFileTextQualifier = xlTextQualifierDoubleQuote
    .TextFileConsecutiveDelimiter = False
    .TextFileTabDelimiter = True
    .TextFileSemicolonDelimiter = False
    .TextFileCommaDelimiter = True
    .TextFileSpaceDelimiter = False
    .TextFileColumnDataTypes = Array(1, 1, 1)
    .TextFileTrailingMinusNumbers = True
    .Refresh BackgroundQuery:=False
End With 
```

现在我确信那里的大部分垃圾都可以删除，但明智的做法是一次删除一个，以确保不会出现任何问题。

您还可以使用以下内容对其进行修改以使用不同的工作表。

```
dim ws as worksheet
dim savealert as boolean
set ws = Sheets.Add
ws.select
' Put all that other code above in here. '
' Move all that data just loaded into a real sheet. '
savealert = Application.DisplayAlerts
Application.DisplayAlerts = False
ws.delete
Application.DisplayAlerts = savealert 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T22:04:41.937

您可以通过 OLEDB 连接访问它，而且速度无限快。

这是我用来将数据从电子表格导入数据库的脚本中的一些代码。显然，您会想要更改游标类型和锁定类型，但您明白了。

```
strExcelConn = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & objFile.Path & ";Extended Properties=""Excel 8.0;HDR=Yes"""
strSQL = "SELECT * FROM [RegistrationList$] ORDER BY DateToRegister DESC"

objExcel.Open strSQL, strExcelConn, adOpenForwardOnly, adLockReadOnly, adCmdText 
```

# backup - 离线同步自动后台

> ID：766995
> 
> 赞同：0
> 
> 时间：2009-04-20T05:19:45.720
> 
> 标签：backup, background, offline

我正在笔记本电脑上处理一些文件，这些文件有时会离线（它运行 winXP）。我想自动将文档备份到远程位置的文件夹中，以便它在后台运行。

我想编辑文档而忘记备份，一旦在线 - 将其全部备份到远程位置，甚至更好 - 到 svn 服务器或支持版本控制的东西。

我想要的东西是：1.免费 2.不会使网络过载太多，而只发送差异。3\. 工作 100%

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T05:33:34.363

DropBox 可以满足您的所有要求。[http://www.getdropbox.com/](http://www.getdropbox.com/)

此外，它完全跨平台、Windows、Mac、Linux。

最多可释放 2GB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T06:02:41.967

I like [IDrive Online](http://www.idrive.com/) personally. It's Windows/Mac (no Linux), 2 GB free, and here's the important bit: **it stores the last 30 revisions of files**. And the history for a file isn't counted against your space either; only the most recent version counts. None of the other free online backup solutions I've seen handle versioning as well. It supports continuous backup too. Oh, and they handle being offline beautifully -- even losing connection in the middle of the backup process doesn't bother it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-21T20:35:23.120

Dropbox 还保留以前的修订，包括已删除文件的修订。

# vb.net - 创建用户表单

> ID：766998
> 
> 赞同：-1
> 
> 时间：2009-04-20T05:21:35.967
> 
> 标签：vb.net, user-controls

我在 vb.net txtbox、按钮、名称列表编辑网格和用户窗体中创建用户控件。所有控制正常工作。但用户表单不起作用。如何使用这个用户表单。请给出任何想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T05:54:54.810

您不使用工具箱来创建新表单。使用菜单：

`Project`|`Add Windows Form...`

**[替代品](http://msdn.microsoft.com/en-us/library/y2xxdce3.aspx)**。

* * *

1.  您正在运行 VB.NET 2005。
2.  您有一个带有“ `Form1`”表单的项目。
3.  您可以看到一个菜单：`File`, `Edit`, `View`, `Project`, ...
4.  菜单中`Project`是一个菜单项`Add Windows Form...`。

告诉我哪个步骤不起作用。

# c++ - 编译时常量索引是编译时常量数组本身的编译时常量吗？

> ID：766999
> 
> 赞同：2
> 
> 时间：2009-04-20T05:21:59.477
> 
> 标签：c++, compiler-construction, metaprogramming, standards-compliance

我正在尝试玩让 C++ 编译器在编译时合成常量字符串的哈希值的花哨游戏。这将让我用单个标识符替换字符串，从而大大节省代码大小和复杂性。

为了编程的清晰性和易用性，如果我可以在编译时使用简单的内联字符串（如“Hello”）检查和计算，那将是非常棒的，这些字符串是指向编译时常量字符的编译时常量指针。

如果我可以在编译时索引这些，我可以制作一个模板元程序来做我想做的事。但尚不清楚 C++ 标准是否将 ct-constant 数组的 ct-constant 索引本身视为 ct-constant。

换个方式问，

```
 const char v="Hello"[0]; 
```

是非常有效的 C++（和 C）。但是**va 的值是编译时间常数吗？**

我已经相信答案是否定的，但实际上一些编译器在没有任何警告的情况下接受它，更不用说错误了。例如，下面的编译和运行甚至没有来自英特尔的 C++ 编译器的一个警告：

```
#include <iostream>
const char value="Hello"[0];
template<char c>  void printMe()
{
  std::cout << "Template Val=" << c << std::endl;
}

int main()
{
  const char v='H';
  printMe<'H'>();
  printMe<v>();
  printMe<value>(); // The tricky and interesting case!
} 
```

然而，微软的编译器根本不会编译，给出一个合理连贯的错误信息，关于使用带有内部链接的对象的模板。

我怀疑我的问题的答案是“不，即使对具有常量索引的常量数组的任何数组引用在编译时也是常量”。这是否意味着英特尔编译器的成功执行是英特尔编译器中的一个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T05:32:52.787

它也不适用于 GCC。

*但是*，在语言兼容的观点之外，编译器优化器确实将其视为字符常量，这很好。我利用这一事实来允许预处理器生成字符常量（通过使用`*#foo`）。请参阅文件中的[http://cvs.openbsd.org/cgi-bin/query-pr-wrapper?full=yes&numbers=1652](http://cvs.openbsd.org/cgi-bin/query-pr-wrapper?full=yes&numbers=1652)`hdr.h`。使用该宏，您可以编写

```
DECR(h, e, l, l, o) 
```

而不是

```
DECR('h', 'e', 'l', 'l', 'o') 
```

在我看来，更具可读性。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T07:03:27.860

好问题，是的，这是可以做到的，而且符合标准，它适用于 Microsoft、GCC 和 Intel，问题是你的语法错误:)

一秒钟我会做一个样品... 好的，就在这里。这个示例是有效的 C++，我经常使用它，但实际上大多数程序员不知道如何正确使用它。

```
template<char* MSG>
class PrintMe
{
public:
    void operator()()
    {
        printf(MSG);
    }
};

char    MyMessage[6] = "Hello"; //you can't use a char*, but a char array is statically safe and determined at compiletime

int main(int argc, char* argv[])
{
    PrintMe<MyMessage> printer;
    printer();
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T09:01:13.957

这里的相关区别是“积分常量表达式”和单纯的编译时常量之间的区别。“3.0”是一个编译时常量。“int(3.0)”也是一个编译时常量。但只有“3”是 ICE。[见 5.19]

[更多详情请访问 boost.org](http://www.boost.org/development/int_const_guidelines.html)***********