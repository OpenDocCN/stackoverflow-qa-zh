# StackOverflow 问答 000305000-000305999

# unit-testing - 如何使用与远程 Web 服务器交互的代码测试错误条件？

> ID：305003
> 
> 赞同：0
> 
> 时间：2008-11-20T11:23:47.927
> 
> 标签：unit-testing, language-agnostic

我有一个小项目，基本上是网站 API 的 Python 包装器。

它经过了很好的测试，但在某些情况下我无法确定如何轻松测试：远程 API 无法访问或以其他方式损坏时。

更具体地说，我非常希望对以下各项进行测试：

*   当站点无法访问时（连接超时）
*   当站点可访问，但返回 HTTP 错误代码（例如，错误 404 或 500）时
*   内容格式不正确。该站点有一个 XML 接口。前段时间网站出现问题，应该是 XML 文件的页面是 HTML 页面，这破坏了 XML 解析

我将如何测试这些案例？我唯一能想到的是将 API 的 URL 更改为不存在的服务器（对于无法访问的情况），以及错误 500/404/格式错误数据的本地 Web 服务器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T11:40:57.957

另一个答案是模拟实际调用网站的代码，并让它返回您需要的错误条件。我想这意味着在 python 中模拟 urllib 或 httplib

# wcf - 将异常映射到 REST Web 服务中的 HTTP 状态代码

> ID：305015
> 
> 赞同：6
> 
> 时间：2008-11-20T11:32:56.583
> 
> 标签：wcf, http, rest

在 .NET 中构建 REST Web 服务时，将**System.ArgumentNullException**和**System.ArgumentException**映射到 HTTP 状态代码的最“RESTful”方式是什么？我的第一个猜测是使用带有适当描述的**HTTP 400/Bad Request 。**

将异常映射到 HTTP 状态代码时，推荐的最佳实践是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-21T06:12:21.597

通常，4xx 状态码告诉客户端请求失败，但如果请求被修改，可能会成功。5xx 代码通知客户有关客户没有影响的问题。

因此，您必须首先区分 4xx 和 5xx 代码，即告诉客户端是否应该重试。

如果请求确实在语法上不正确、不完整、矛盾或其他基本错误，则应使用 HTTP 400“错误请求”。此外，它可能是 4xx 范围内的有效默认状态，如果没有其他状态似乎合适并且您认为客户端只需修改请求即可成功。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T13:29:10.530

这取决于上下文。例如，ArgumentNullException 可能源于违反前提条件或内部服务器错误。

问候，坦伯格

# delphi - 升级到 D2009（Unicode 除外）的主要动机是什么？

> ID：305016
> 
> 赞同：9
> 
> 时间：2008-11-20T11:33:12.370
> 
> 标签：delphi, delphi-2009, upgrade

在开发工具方面，我是一个犹豫不决的升级者。对于我大约一半的产品，我仍然使用 D7，而对于其他产品，我仍然使用 D2006。

事实是，虽然 Unicode 支持非常受欢迎并且非常有用，但它可能给我带来的麻烦多于我当前项目的收益（它们或多或少已经准备好 Unicode）。如果每个字符串占用的内存是以前的两倍，那么其中一个性能会受到很大影响的情况尤其如此。

那么，除了 Unicode，还有哪些其他主要的升级激励措施？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-20T13:16:54.173

为了正确看待事物，请查看在 Delphi 7 和 Delphi 2007 之间添加的内容。这是一个显着的高水位标记。

[http://blogs.codegear.com/nickhodges/2007/03/28/33579](http://blogs.codegear.com/nickhodges/2007/03/28/33579)

[http://www.stevetrefethen.com/blog/VCLAndRTLEnhancementsSinceDelphi7D7.aspx](http://www.stevetrefethen.com/blog/VCLAndRTLEnhancementsSinceDelphi7D7.aspx)

Delphi 2009 设定了更高的标准。

[http://blogs.codegear.com/pawelglowacki/2008/11/03/38527](http://blogs.codegear.com/pawelglowacki/2008/11/03/38527)

[http://blogs.codegear.com/chrispattinson/2008/09/19/38897](http://blogs.codegear.com/chrispattinson/2008/09/19/38897)

以下是我最喜欢的一些：

*   RTL 中的泛型（自然）和泛型集合。

*   改进了从通用基本配置继承的构建配置。

*   DataSnap 改进，包括删除 COM 依赖项。

*   比 Delphi 2007 更快、更稳定的 IDE，这毫不逊色。

我不确定我将如何在生产中使用它们，但你必须承认匿名方法真的很酷。我很想知道人们如何最终将它们与线程一起使用。

关于 Unicode 支持只有两件事（我最喜欢的另一件事）。

*   当您转换现有的 Unicode 项目时，您可能会看到显着的性能改进。我知道我做到了。

*   您需要小心转换任何对字符大小做出假设的代码。如果您现有的代码支持 Unicode，您可能不会看到很多问题。

[http://dn.codegear.com/article/38437](http://dn.codegear.com/article/38437)

[http://dn.codegear.com/article/38498](http://dn.codegear.com/article/38498)

[http://dn.codegear.com/article/38693](http://dn.codegear.com/article/38693)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-20T11:41:55.503

首先，我认为您不会注意到性能上的影响。

看看[这个](http://compaspascal.blogspot.com/2008/10/delphi-2009-string-type-performance.html)

我会说只是泛型使它值得升级。其次是匿名方法。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-21T00:38:28.230

我最近从 Delphi 4 升级到 Delphi 2009，主要是因为 Unicode，但也因为自从我的版本以来，Delphi 到处都有许多改进。

但是升级时最让我高兴的意想不到的改进是新的IDE（集成开发环境）。Delphi 7 和以前的版本有一个非停靠的布局，让我抓狂。现在它是一种可以轻松调整大小和移动的停靠形式。更不用说它的许多改进，使每一个编程任务变得更容易。请记住，您将所有的编程时间都花在了 IDE 上，因此每件小事都变得更容易，从而节省了时间。

在调试和单步执行代码时，默认情况下会监视所有局部变量。这非常有帮助。

FastMM 内存管理器是内置的。

我现在安装了 Delphi 4 和 Delphi 2009，我可以运行其中一个，甚至同时运行两个。这在转换我的程序时非常有用，因为我可以一起调试和单步调试，以确保转换后的程序正常工作。

此外，Embarcadero 仍然提供 Borland 和 Code Gear 为所有以前版本所有者所做的特殊升级价格。他们不必这样做，但这是他们将 Delphi 的早期采用者视为他们的 VIP 的一个伟大举措。

我不喜欢什么？嗯，Delphi 4 2 秒就启动了。Delphi 2009 大约需要 15 个。但在那之后它很快。单步执行代码也更频繁地进入 CPU 代码，因为它通常是内联的，我认为没有任何办法解决这个问题。

如果您需要 Unicode，请不要三思而后行升级。

如果您不需要 Unicode，Delphi 7 及更早版本仍有足够的改进，最终值得一试。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-20T11:49:05.210

正如史蒂夫所说，主要的语言添加是一个很大的优势。但还有另一件事。

过去几年，德尔福一直处于暴风雨天气中。版本反映了这一点。7 是最后一个好版本，2006 年是合理的，但仍然低于平均水平。但现在随着 2009 年的到来，一个新的时代已经开始。德尔福找到了新家。重点又回到了成为最好的开发工具上。仍有一些积压的工作需要解决，但就我而言，Delphi 正在重新崛起。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-20T13:12:20.127

事实证明，Delphi 2009 比 Delphi 2007 稳定得多，仅对我来说升级就足够了，delphi 2007 的错误和崩溃非常烦人且压力很大。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-26T00:38:01.457

2 件事。稳定性比 2006 年和 2007 年要好得多。（更不用说它的安装速度更快，运行速度更快，并且不会出现占用数百兆 RAM 的令人讨厌的内存泄漏。）仅此一项就值得放弃最后两个中的任何一个的版本。但是关于语言的改进，有很多要谈的，而且已经谈了很多了，但对我来说最重要的是通用支持，尤其是新的内置 Generics.Collections 单元。最后，不再使用我们都熟悉的这种丑陋的成语：

```
for i := 0 to myObjectList.Count - 1 do
begin
  currentObject := myObjectList[i] as TMyObjectType;
  currentObject.WhateverYoureDoingWithIt;
  ...
end; 
```

相反，如果您将 MyObjectList 声明为基于泛型的`TObjectList<TMyObjectType>`，它会为您处理类型转换，并作为包的一部分抛出一个免费的枚举器（AKA 迭代器）。你的循环现在看起来像这样：

```
for currentObject in myObjectList do
begin
  currentObject.WhateverYoureDoingWithIt;
  ...
end; 
```

Unicode 和匿名方法很好，尤其是 Unicode 对某些人来说可能是必不可少的，但我个人最喜欢的改进是丑陋的列表访问的终结。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-17T07:23:29.107

尼克霍奇斯发布：

[从 Delphi 7 升级的十大理由](http://dn.codegear.com/article/39136)

它们包括：

1.  实时模板
2.  历史标签
3.  可停靠/可定制的 IDE
4.  VCL 设计师指南
5.  新工具调色板
6.  重构
7.  泛型
8.  匿名方法（闭包）
9.  Unicode 支持
10.  功能区控件

在他的结论中，他说：“写这篇文章最困难的部分是将它限制在十个以内”

然后他列出了其他 24 件事情（不算 Intellimouse 两次）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-04T11:07:36.940

我只是给了通用集合和增强的 For-loop 一个旋转（不要介意代码的视觉丑陋（例如 if-then-else 在一行上））：

```
program genericTList;

{$APPTYPE CONSOLE}

uses
  SysUtils,
  Generics.Collections;

var
  myList : TList<string>;
  s: string;

begin
  myList := TList<string>.create;
  try
    myList.Add('Peter');
    writeln('Inviting Peter');
    myList.Add('Barbie');
    writeln('Inviting Barbie');
    if myList.Contains('Bob') then writeln('Bob has managed to sneak in...') else writeln('Bob is not invited!');
    writeln('List of invited people:');
    for s in myList do writeln(s); //feels sooo goood X-)
    readln;
  finally
    FreeAndNil(myList);
  end;
end. 
```

离开当时似乎快要死去的德尔福三年后，我想我可能会回到这个可爱的世界。

我[最伟大的 Delphi 项目](https://stackoverflow.com/questions/763464/whats-the-hardest-program-youve-written/763502#763502)似乎没有为 Unicode 做好准备，但 Unicode 也是很棒的东西，所以我只需要在几个地方修复代码。昨天我还设法让它在没有错误的情况下构建和执行（似乎涉及某种 D2007->D2009 转换技巧），我注意到 D2009 非常快！它在（几乎*）各个方面都比旧版本好。

*我还没有发现回归。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-17T13:39:04.353

到目前为止，对我来说最重要的激励因素是 IDE 与 Delphi 2006 和同一个项目相比的整体速度。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-04T16:55:04.873

重构——提取方法、移动类、提取接口、可以提高代码和设计质量的操作，在新版本的 IDE 中是一个非常好的功能。

# c# - C# 使用 PGP -ka 命令重定向标准输入

> ID：305023
> 
> 赞同：0
> 
> 时间：2008-11-20T11:37:25.187
> 
> 标签：c#

我遇到了一个看起来很愚蠢的问题。我一定错过了一些愚蠢的事情。我们在其中一台生产服务器上有一个 PGP 密钥环。为了安全起见，它所属的用户帐户不允许以交互方式登录。我们的问题是我们有时需要添加新的密钥并且不能轻易做到这一点。所以我们认为我们可以创建一个快速控制台应用程序，该应用程序将作为其 ID 运行并通过命令行调用 PGP 命令。

该命令被调用，但它要求输入以确认我们正在做什么。我们的问题是我们发送到标准输入的“y”永远不会显示，并且密钥没有经过验证。

这是代码：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.IO;
using System.Text.RegularExpressions;
using System.DirectoryServices;
using System.Threading;

namespace TestConsoleApp
{
    class RegExValidator
    {
        private System.Diagnostics.Process myProcess;

        public RegExValidator()
        {
        }

        public static void Main(string[] args)
        {
            RegExValidator myValidator = new RegExValidator();
            myValidator.InstallKeys("C:\\Test\\batch.asc", "batch.asc");
        }

        private void InstallKeys(string keyPath, string keyName)
        {
            myProcess = new System.Diagnostics.Process();
            myProcess.StartInfo.RedirectStandardInput = true;
            myProcess.StartInfo.CreateNoWindow = false;
            myProcess.StartInfo.UseShellExecute = false;
            myProcess.StartInfo.FileName = "pgp";
            myProcess.StartInfo.Arguments = "-ka " + keyPath + "";
            myProcess.Start();

            StreamWriter myInput = myProcess.StandardInput;
            myInput.AutoFlush = true;
            Thread.Sleep(3000);

            myInput.WriteLine("y");

            myInput.WriteLine(Environment.NewLine);

        }

    }

} 
```

这是我们在命令行上得到的输出。

```
 C:\Test>TestConsoleApp.exe
    Pretty Good Privacy(tm) Version 6.5.2
    (c) 1999 Network Associates Inc.
    Uses the BSafe(tm) Toolkit, which is copyright RSA Data Security, Inc.
    Export of this software may be restricted by the U.S. government.

    WARNING: Environmental variable TZ is not       defined, so GMT timestamps
            may be wrong.  See the PGP User's Guide to properly define TZ

    Looking for new keys...
    DSS  2048/1024 0xDE053A3D 2007/05/29 Batch Interface <batch@netgiro.com>
    sig?           0xDE053A3D             (Unknown signator, can't be checked)

    keyfile contains 1 new keys. Add these keys to keyring ? (Y/n)
    C:\Test> 
```

任何人都可以帮忙吗？

谢谢

**编辑**

我们尝试了这个过程，但我们只是移动了一个文件而不是 PGP，然后我们得到了 Y/N 框，并且工作正常。看来您可能无法使用 PGP 来做到这一点。不知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T11:59:40.523

讯息

```
keyfile contains 1 new keys. Add these keys to keyring ? (Y/n) 
```

建议用**大写 Y**回复。尝试将您的电话更改为：

```
myInput.WriteLine("Y"); 
```

（我没有安装PGP进行检查，但遇到过其他坚持大小写的命令行界面。）

要尝试的另一件事是[刷新流缓冲区](http://msdn.microsoft.com/en-us/library/system.io.stream.flush.aspx)，它会清除流的所有缓冲区并导致将任何缓冲数据写入底层设备：

```
myInput.WriteLine("Y");
myInput.Flush(); 
```

# svn - 在颠覆中标记存储库的一部分

> ID：305027
> 
> 赞同：1
> 
> 时间：2008-11-20T11:40:42.620
> 
> 标签：svn, cvs

我来自 CVS 背景。我目前正在研究将 SVN 用于项目。我处理的代码往往位于以下目录结构中。

> 项目\库\lib1
> 
> 项目\库\lib1\测试
> 
> 项目\库\lib1\模拟
> 
> 项目\库\lib2

等等

当我在 CVS 中标记发布时，我倾向于创建两个标记，一个是“project-release-1”，一个是“project-release-1-with-tests”。“project-release-1”标签不包括测试目录和模拟目录以及可能的其他一些文件。我们的想法是，我们通常不将测试源发送给客户，通过导出“project-release-1”标签，我们可以获得客户的一组源，我们可以将其发送给他们，并通过在“project-release-1-with-tests”标签我们得到了所有可以用于分支的东西，如果需要进行持续开发的话。

我如何用 SVN 做类似的事情？理想情况下是可以编写脚本的形式；使用 SVN，我们每个项目都有一个脚本，它将应用两个标签并通过简单地从测试和模拟目录中删除标签等来创建客户端标签......

我猜在SVN中我会创建“with tests”标签，然后（不知何故）检查出来，删除测试和模拟目录并创建客户端发布标签？

**更新**：

我决定改变我做事的方式......而不是每个项目都有一个脚本来设置我的旧式双标签，我现在每个项目都有一个脚本，它采用标记版本（其中包括我没有的东西运送给客户）并删除我不运送给客户的东西。工作完成，只需要一个标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T12:14:01.600

我不知道这是否是“正确”的答案，但我可以想到两个选择。

A. 标记和删除：

1.  将您的 /project/libs 目录标记为 project-release-1；
2.  从 project-release-1 中删除“test”和“mock”目录。或者，首先创建一个包含所有内容的 project-release-1-with-tests 标记，然后**将该**目录标记（复制）为 project-release-1 并重复上面的#2。

B. 使用“外部”：

1.  在标签下创建一个空的 project-release-1 目录。不要真正标记，只需创建目录。
2.  编辑该目录的属性，添加一个名为“svn:externals”的属性。在该属性的值中输入： lib1 -r $REV url:to/project/libs/lib1 lib2 -r $REV url:to/project/libs/lib2

其中 $REV 是标记源代码的修订号。稍后，当您检查“无测试”目录时，您将获得两个“标记”目录。

我相信第一个选项更好，因为分析分支和标签的工具将更好地理解您所做的事情。

在旁注中，我想知道您为什么想要无测试标签；为什么标签中有测试会让您感到困扰？

*   诺姆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-22T07:10:54.413

标签只是一个副本，就像任何其他副本一样。因此，您可以在标签中创建一个空目录来标记该版本，然后在其中创建两个目录——一个用于带有测试的版本，另一个用于不带测试的版本。

# c# - 在 C# 中反序列化 SOAP 数组

> ID：305029
> 
> 赞同：2
> 
> 时间：2008-11-20T11:41:20.357
> 
> 标签：c#, soap, serialization

在与另一家公司合作时，我正在尝试编写一个 SOAP 客户端来与他们的服务对话。该服务本身没有 wsdl 文件，但我成功地编写了自己的代理类，继承自 SoapHttpClientProtocol。只返回一个整数或单个值的基本方法不是问题，但是当我尝试创建一个需要解析数组中返回的结果的方法时，我无法让它工作。部分问题可能是 SOAP 结果引用了一个不再存在但设置

```
 [SoapRpcMethodAttribute("Action", Use = SoapBindingUse.Literal)] 
```

关于方法似乎忽略了命名空间问题。但是，每当我尝试将结果解析为数组时，我只会得到一个空结果。

```
[SoapRpcMethodAttribute("Action", Use = SoapBindingUse.Literal)]
[return: XmlArrayAttribute("Result")]
public ComplexType[] getArray(int customerId, int subCustomerId, int subscriptionId, int type)
{
    object[] result;
    result = Invoke("getArray", new object[] { id });
    return ((ComplexType[])(result[0]));
 } 
```

我完全错误地认为上述方法应该有效吗？

来自服务器的 XML 结果如下所示（在正文中）：

```
<getArray SOAP-ENC:root="1">
    <Result SOAP-ENC:arrayType="ns1:SOAPStruct[1]" xsi:type="SOAP-ENC:Array" xmlns:ns1="http://soapinterop.org/xsd">
        <item>
            <id xsi:type="xsd:integer">60</id>
            <name xsi:type="xsd:string">John</name>
            <type xsi:type="xsd:string">1</type>
        </item>
        <item>
            <id xsi:type="xsd:integer">99</id>
            <name xsi:type="xsd:string">Jane</name>
            <type xsi:type="xsd:string">1</type>
        </item>
    </Result>
</getArray> 
```

命名空间问题是[http://soapinterop.org/xsd](http://soapinterop.org/xsd)似乎不再存在，但这不是主要问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T20:22:47.370

该 SOAP 数组是 rpc/encoded 响应，您需要确保在客户端类/方法上设置所有属性，以便堆栈知道它处理 rpc/encoded 响应。（Use=...Literal 肯定是错误的）。

您对 ComplexType 的 c# 定义是什么样的？您可能需要在其上设置类型命名空间，例如 [System.Xml.Serialization.SoapTypeAttribute(Namespace="http://soapinterop.org/xsd")]

# shell - 如何使用 SSH 在远程机器上运行本地 shell 脚本？

> ID：305035
> 
> 赞同：1326
> 
> 时间：2008-11-20T11:44:25.997
> 
> 标签：shell, ssh, sysadmin, remote-execution

我必须在远程机器上运行本地 shell 脚本（windows/Linux）。

我在机器 A 和 B 上都配置了 SSH。我的脚本在机器 A 上，它将在远程机器机器 B 上运行我的一些代码。

本地和远程计算机可以是基于 Windows 或 Unix 的系统。

有没有办法使用 plink/ssh 来运行？

* * *

## 回答 #1

> 赞同：1290
> 
> 时间：2010-04-28T20:41:04.347

如果机器 A 是 Windows 机器，您可以使用带有 -m 参数的 Plink（[PuTTY](http://www.chiark.greenend.org.uk/~sgtatham/putty/)的一部分），它将在远程服务器上执行本地脚本。

```
plink root@MachineB -m local_script.sh 
```

如果机器 A 是基于 Unix 的系统，您可以使用：

```
ssh root@MachineB 'bash -s' < local_script.sh 
```

您不必将脚本复制到远程服务器来运行它。

* * *

## 回答 #2

> 赞同：703
> 
> 时间：2010-10-06T13:11:02.417

这是一个老问题，杰森的回答很好，但我想补充一点：

```
ssh user@host <<'ENDSSH'
#commands to run on remote host
ENDSSH 
```

这也可以与 su 和需要用户输入的命令一起使用。（注意`'`转义的heredoc）

编辑：由于这个答案不断获得流量，我会为heredoc的这个精彩使用添加更多信息：

您可以使用这种语法嵌套命令，这是嵌套似乎起作用的唯一方式（以一种理智的方式）

```
ssh user@host <<'ENDSSH'
#commands to run on remote host
ssh user@host2 <<'END2'
# Another bunch of commands on another host
wall <<'ENDWALL'
Error: Out of cheese
ENDWALL
ftp ftp.secureftp-test.com <<'ENDFTP'
test
test
ls
ENDFTP
END2
ENDSSH 
```

您实际上可以与一些服务进行对话，如 telnet、ftp 等。但请记住，heredoc 只是将标准输入作为文本发送，它不会等待行之间的响应

编辑：我刚刚发现**如果**你使用`<<-END`!

```
ssh user@host <<-'ENDSSH'
    #commands to run on remote host
    ssh user@host2 <<-'END2'
        # Another bunch of commands on another host
        wall <<-'ENDWALL'
            Error: Out of cheese
        ENDWALL
        ftp ftp.secureftp-test.com <<-'ENDFTP'
            test
            test
            ls
        ENDFTP
    END2
ENDSSH 
```

（我认为这应该有效）

另见 [http://tldp.org/LDP/abs/html/here-docs.html](http://tldp.org/LDP/abs/html/here-docs.html)

* * *

## 回答 #3

> 赞同：263
> 
> 时间：2008-11-20T12:25:35.323

此外，如果您想从目标主机获取变量，请不要忘记转义变量。

这在过去让我感到困惑。

例如：

```
user@host> ssh user2@host2 "echo \$HOME" 
```

打印出 /home/user2

尽管

```
user@host> ssh user2@host2 "echo $HOME" 
```

打印出 /home/user

另一个例子：

```
user@host> ssh user2@host2 "echo hello world | awk '{print \$1}'" 
```

正确打印出“你好”。

* * *

## 回答 #4

> 赞同：164
> 
> 时间：2011-09-09T15:00:27.700

这是 YarekT 的答案的扩展，将内联远程命令与将 ENV 变量从本地计算机传递到远程主机相结合，以便您可以在远程端参数化脚本：

```
ssh user@host ARG1=$ARG1 ARG2=$ARG2 'bash -s' <<'ENDSSH'
  # commands to run on remote host
  echo $ARG1 $ARG2
ENDSSH 
```

通过将所有内容保存在一个脚本中，我发现这非常有用，因此它非常易读和可维护。

为什么这有效。ssh 支持以下语法：

> ssh user@host remote_command

在 bash 中，我们可以在单行上运行命令之前指定要定义的环境变量，如下所示：

> ENV_VAR_1='value1' ENV_VAR_2='value2' bash -c 'echo $ENV_VAR_1 $ENV_VAR_2'

这使得在运行命令之前定义变量变得容易。在这种情况下， echo 是我们正在运行的命令。echo 之前的所有内容都定义了环境变量。

因此，我们将这两个功能和 YarekT 的答案结合起来得到：

> ssh 用户@主机 ARG1=$ARG1 ARG2=$ARG2 'bash -s' <<'ENDSSH'...

在这种情况下，我们将 ARG1 和 ARG2 设置为本地值。将 user@host 之后的所有内容作为 remote_command 发送。当远程机器执行命令 ARG1 和 ARG2 时，设置本地值，这要归功于本地命令行评估，它定义远程服务器上的环境变量，然后使用这些变量执行 bash -s 命令。瞧。

* * *

## 回答 #5

> 赞同：112
> 
> 时间：2008-11-20T11:53:18.273

```
<hostA_shell_prompt>$ ssh user@hostB "ls -la" 
```

这将提示您输入密码，除非您已将 hostA 用户的公钥复制到用户 .ssh 目录主目录上的 authorized_keys 文件中。这将允许无密码身份验证（如果被接受为 ssh 服务器配置上的身份验证方法）

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2011-01-26T16:17:56.223

我已经开始使用[Fabric](http://docs.fabfile.org/)进行更复杂的操作。Fabric 需要 Python 和其他一些依赖项，但仅在客户端计算机上。服务器只需是 ssh 服务器。我发现这个工具比交给 SSH 的 shell 脚本强大得多，而且非常值得费心去设置（特别是如果你喜欢用 Python 编程的话）。Fabric 处理在多个主机（或特定角色的主机）上运行的脚本，有助于促进幂等操作（例如在配置脚本中添加一行，但如果它已经存在则不会），并允许构建更复杂的逻辑（例如 Python语言可以提供）。

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2019-08-11T23:28:54.647

```
cat ./script.sh | ssh <user>@<host> 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-12-18T21:16:13.800

尝试运行`ssh user@remote sh ./script.unx`。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2020-12-01T13:30:23.803

```
chmod +x script.sh    
ssh -i key-file root@111.222.3.444 < ./script.sh 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2008-11-20T12:10:10.877

假设您的意思是要从“本地”机器自动执行此操作，而无需手动登录“远程”机器，您应该查看一个名为 Expect 的 TCL 扩展，它正是为这种情况而设计的。我还提供了一个脚本链接，用于通过 SSH 登录/交互。

[https://www.nist.gov/services-resources/software/expect](https://www.nist.gov/services-resources/software/expect)

[http://bash.cyberciti.biz/security/expect-ssh-login-script/](http://bash.cyberciti.biz/security/expect-ssh-login-script/)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2018-11-10T20:06:26.420

我使用这个在远程机器上运行 shell 脚本（在 /bin/bash 上测试）：

```
ssh deploy@host . /home/deploy/path/to/script.sh 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2019-08-14T12:54:45.980

```
ssh user@hostname ".~/.bashrc;/cd path-to-file/;.filename.sh" 
```

强烈建议获取环境文件（.bashrc/.bashprofile/.profile）。在远程主机上运行某些东西之前，因为目标主机和源主机的环境变量可能有所不同。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-09-21T03:31:48.207

`temp=`ls -a` echo $temp` 如果你想在 `` 中执行这样 的命令会导致错误。

下面的命令将解决这个问题 `ssh user@host ''' temp=`ls -a` echo $temp '''`

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-05-30T09:22:42.060

这个 bash 脚本 ssh 到目标远程机器，并在远程机器上运行一些命令，不要忘记在运行它之前安装期望（在 mac 上`brew install expect`）

```
#!/usr/bin/expect
set username "enterusenamehere"
set password "enterpasswordhere"
set hosts "enteripaddressofhosthere"
spawn ssh  $username@$hosts
expect "$username@$hosts's password:"
send -- "$password\n"
expect "$"
send -- "somecommand on target remote machine here\n"
sleep 5
expect "$"
send -- "exit\n" 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-09-01T17:09:16.170

您可以使用[runoverssh](https://github.com/yuriescl/runoverssh)：

```
sudo apt install runoverssh 
```

```
runoverssh -s localscript.sh user host1 host2 host3... 
```

`-s`远程运行本地脚本

* * *

**有用的标志：**
`-g`对所有主机使用全局密码（单一密码提示）
`-n`使用 SSH 而不是 sshpass，对公钥认证很有用

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-04-21T00:44:35.667

如果您尝试使用或在远程 linux 机器上运行脚本，这里的答案（[https://stackoverflow.com/a/2732991/4752883](https://stackoverflow.com/a/2732991/4752883) ）非常有用。如果脚本上有多行，它将起作用。`plink``ssh``linux`

**但是，如果您尝试运行位于本地 `linux/windows`计算机上的批处理脚本，而您的远程计算机是`Windows`，并且它由使用 ** 的多行组成

`plink root@MachineB -m local_script.bat`

不会工作。

只会执行脚本的第一行。这可能是一个限制`plink`。

## 解决方案1：

要运行多行批处理脚本（特别是如果它相对简单，由几行组成）：

如果你原来的批处理脚本如下

```
cd C:\Users\ipython_user\Desktop 
python filename.py 
```

您可以使用 `local_script.bat`文件中的“&&”分隔符将这些行组合在一起，如下所示： [https](https://stackoverflow.com/a/8055390/4752883) ://stackoverflow.com/a/8055390/4752883 ：

```
cd C:\Users\ipython_user\Desktop && python filename.py 
```

进行此更改后，您可以运行@JasonR.Coombs 在此处指出的脚本：[https](https://stackoverflow.com/a/2732991/4752883) ://stackoverflow.com/a/2732991/4752883 ，其中：

```
`plink root@MachineB -m local_script.bat` 
```

## 解决方案2：

如果您的批处理脚本相对复杂，最好使用封装 plink 命令的批处理脚本以及@Martin [https://stackoverflow.com/a/32196999/4752883](https://stackoverflow.com/a/32196999/4752883)在此处指出的以下内容：

```
rem Open tunnel in the background
start plink.exe -ssh [username]@[hostname] -L 3307:127.0.0.1:3306 -i "[SSH
key]" -N

rem Wait a second to let Plink establish the tunnel 
timeout /t 1

rem Run the task using the tunnel
"C:\Program Files\R\R-3.2.1\bin\x64\R.exe" CMD BATCH qidash.R

rem Kill the tunnel
taskkill /im plink.exe 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-02-07T09:45:39.983

如果脚本很短并且打算嵌入到您的脚本中并且您在`bash`shell 下运行并且`bash`shell 在远程端可用，您可以使用`declare`将本地上下文传输到远程。定义包含将被传输到远程的状态的变量和函数。定义一个将在远程端执行的函数。然后在此处读取的文档中，`bash -s`您可以使用它`declare -p`来传输变量值并用于`declare -f`将函数定义传输到远程。

因为`declare`负责引用并将由 remote 解析`bash`，所以变量被正确引用并且函数被正确传输。您可能只是在本地编写脚本，通常我会在远程端完成我需要做的工作的一个长功能。必须手动选择上下文，但以下方法对于任何短脚本都“足够好”并且是安全的 - 应该正确处理所有极端情况。

```
somevar="spaces or other special characters"
somevar2="!@#$%^"
another_func() {
    mkdir -p "$1"
}
work() {
    another_func "$somevar"
    touch "$somevar"/"$somevar2"
}
ssh user@server 'bash -s' <<EOT
$(declare -p somevar somevar2)    # transfer variables values
$(declare -f work another_func)   # transfer function definitions
work                              # call the function
EOT 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-01-24T23:34:10.393

不清楚本地脚本是否使用本地设置的变量、函数或别名。

如果这样做应该可以：

myscript.sh：

```
#!/bin/bash

myalias $myvar
myfunction $myvar 
```

它使用`$myvar`、`myfunction`和`myalias`。让我们假设它们是在本地而不是在远程机器上设置的。

创建一个包含脚本的 bash 函数：

```
eval "myfun() { `cat myscript.sh`; }" 
```

设置变量、函数和别名：

```
myvar=works
alias myalias='echo This alias'
myfunction() { echo This function "$@"; } 
```

和 "export" `myfun`, `myfunction`, `myvar`, 和`myalias`to`server`使用`env_parallel`GNU Parallel：

```
env_parallel -S server -N0  --nonall myfun ::: dummy 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-07-28T09:01:34.487

如果它是一个脚本，则可以使用上述解决方案。

我会设置**Ansible**来完成这项工作。它以相同的方式工作（Ansible 使用 ssh 在远程机器上执行 Unix 或 Windows 的脚本）。

它将更加结构化和可维护。

* * *

## 回答 #20

> 赞同：-23
> 
> 时间：2008-11-20T12:00:53.687

首先，使用 scp 将脚本复制到机器 B

> [user@machineA]$ scp /path/to/script user@machineB:/home/user/path

然后，只需运行脚本

> [user@machineA]$ ssh user@machineB "/home/user/path/script"

如果您已授予脚本可执行权限，这将起作用。

# sharepoint - 在 SharePoint 中设置警报

> ID：305036
> 
> 赞同：1
> 
> 时间：2008-11-20T11:44:30.303
> 
> 标签：sharepoint, moss

我`MOSS 2007`在一个`Windows 2003`盒子上跑。我需要知道必须进行哪些配置才能使警报正常工作。`SMTP settings`等等......当我创建我的警报时，它会被创建，但它不会发送电子邮件来告诉我我的文档库或任何特定文档中的某些内容发生了变化。我错过了什么？

我确实在 Windows 组件下安装了电子邮件服务，在`IIS`. 在我的 SharePoint Central Admin 中，我确实更改了传出和传入电子邮件的设置（在拓扑和服务部分下）。

我还缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-20T11:50:34.957

您是否在管理中心中设置了 Web 应用程序外发电子邮件设置？是

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T17:09:34.340

SMTP 服务器是否已配置为允许 MOSS 服务器向其中继邮件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T09:27:00.187

通过配置帐户并关联到邮件客户端 Outlook，确保您已正确配置 SMTP 服务器。首先检查来自邮件客户端的服务器发送和接收功能。

确保您已在列表中正确订阅警报

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-20T12:55:26.043

我不认为这个问题真的适合 StackOverflow - 它不是一个编程问题，请参阅常见问题解答。

但无论如何 - 可能是防病毒或 smtp 中继规则阻止 sharepoint 将 smtp 发送到您的邮件服务器。试试这个工具来诊断。

[http://www.simplecomtools.com/smtptesttool.html](http://www.simplecomtools.com/smtptesttool.html)

如果这不起作用，那么它的 MS 支持 - 新闻组中到处都是试图解决警报电子邮件问题的人的尸体！

# windows-services - (SC) 删除服务失败 1072

> ID：305037
> 
> 赞同：109
> 
> 时间：2008-11-20T11:44:31.817
> 
> 标签：windows-services, websphere

上次我创建 WAS 配置文件和 WASService 时，我尝试配置并运行许多脚本来学习如何配置 WAS，最后它崩溃了，所以我使用 wasprofile 删除此配置文件并忘记删除 WASService。

现在我在 services.msc 列表中找到了 IBM Webphere Application Server 服务显示，所以我尝试使用`WASService.exe`-remove 命令和 windows`SC`命令删除它，但我收到了消息

```
C:\Program Files\IBM\WebSphere\AppServer\bin>sc delete "IBMWAS61Service - DEV"
[SC] DeleteService FAILED 1072:
The specified service has been marked for deletion. 
```

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2008-11-20T12:02:36.740

确保服务已停止，服务控制面板已关闭，并且该服务未打开任何打开的文件句柄。

还要确保 ProcessExplorer 没有运行。

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2011-08-26T09:43:31.593

我遇到了类似的问题，我为克服它所做的工作如下：

1.  停止服务：**net stop "ServiceName"**
2.  确保：“mmc.exe”进程不存在（“服务”列表窗口）：**taskkill /F /IM mmc.exe**
3.  删除服务：**sc delete "ServiceName"**

    ```
    C:\server>sc delete "ServiceName"

    [SC] DeleteService SUCCESS 
    ```

现在，如果我执行另一个 sc 命令，我得到的是以下内容：

```
C:\server>sc delete "ServiceName"

[SC] OpenService FAILED 1060:

The specified service does not exist as an installed service. 
```

但不是 1072 错误消息

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2010-05-10T15:49:41.343

我所做的是去这个位置`regedit`：

`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services`

从这里，您将看到机器上每个服务的文件夹。只需删除所需服务的文件夹，即可完成。

注意：在尝试之前停止服务。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2018-04-24T06:30:06.883

`refresh`由于某些错误的原因，当您告诉它们时，Event Viewer 和/或 Services.msc 都不会正常工作！

关闭它们并重新启动，无论如何该服务都会被删除。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-04-05T17:48:08.407

我遇到过同样的问题。在我关闭并重新打开“计算机管理”窗口后，该服务已从列表中删除。我正在运行 Windows 7

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-08-27T13:39:35.300

在 Windows 7 中，确保在删除之前关闭事件查看器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-27T23:18:44.733

我也有这个错误，请确保服务指向的 exe 已停止。还要确保在其他窗口后面没有任何 Windows 对话框。这就是为什么我的没有删除。它后面有一条 Windows 消息，说此服务已被删除或类似的东西.. 只需单击确定，就可以了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-24T15:40:59.807

由于服务名称中的拼写错误，我遇到了同样的错误，我试图删除服务显示名称而不是服务名称。一旦我使用了正确的服务名称，它就可以正常工作

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-06-10T16:06:03.277

第 3 方应用程序卸载程序已删除该服务的文件，然后将该服务置于此待删除状态。

在尝试关闭所有应用程序，识别服务 PID（无法）以进行终止，注销所有其他用户并注销并重新登录后，重新启动是唯一对我有用的修复程序。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-01-08T19:17:39.533

注销并再次登录会关闭所有阻止的应用程序，从而解决问题。

# .net - 如何在我的 ASP.NET 应用程序中避免 SQL 注入攻击？

> ID：305044
> 
> 赞同：21
> 
> 时间：2008-11-20T11:49:07.423
> 
> 标签：.net, asp.net, sql, security, sql-injection

我需要避免在我的 ASP.NET 应用程序中容易受到 SQL 注入的影响。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-20T12:03:06.430

即使您的问题非常笼统，但始终适用一些规则：

*   使用参数化查询（`SqlCommand`with `SqlParameter`）并将用户输入放入参数中。
*   不要根据未经检查的用户输入构建 SQL 字符串。
*   不要假设您可以构建一个可以检查用户输入的各种格式错误的清理程序。边缘情况很容易被遗忘。检查数字输入可能很简单，可以保证您的安全，但对于字符串输入，只需使用参数。
*   检查二级漏洞 - 如果这些值包含用户输入，则不要从 SQL 表值构建 SQL 查询字符串。
*   使用存储过程来封装数据库操作。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-20T11:57:59.373

使用[准备](http://msdn.microsoft.com/en-us/library/7a9swst5(VS.80).aspx)好的语句（链接到在“为产品添加节点”部分中使用准备好的语句的 ASP.NET 教程）。这里的所有都是它的。

好吧，或者使用 ORM，例如[Linq to SQL](http://msdn.microsoft.com/en-us/data/cc298428.aspx)或[NHibernate](http://www.nhibernate.org/)，它们在内部使用预准备语句。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-20T14:18:04.923

使用参数！真的就是这么简单:-)

像这样创建您的查询（对于使用 C# 的 MS Sql 服务器）：

```
SqlCommand getPersons = new SqlCommand("SELECT * FROM Table WHERE Name = @Name", conn); 
```

这里@Name 是要避免sql 注入的参数，conn 是一个SqlConnection 对象。然后要添加参数值，请执行以下操作：

```
getPersons.Parameters.AddWithValue("@Name", theName); 
```

这里 theName 是一个变量，其中包含您要搜索的名称。

现在应该不可能对该查询进行任何 sql 注入。

因为它很简单，所以没有理由不使用参数。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-08-06T07:58:28.353

**从不信任用户输入** - 使用验证控件、正则表达式、代码等验证所有文本框条目

**永远不要使用动态 SQL** - 使用参数化 SQL 或存储过程

**永远不要使用管理员级别的帐户连接到数据库**- 使用受限访问帐户连接到数据库

**不要以纯文本形式存储秘密**- 加密或散列密码和其他敏感数据；您还应该加密连接字符串

**异常应该泄露最少的信息**——不要在错误消息中透露太多信息；在发生未处理的错误时使用 customErrors 显示最少的信息；将调试设置为 false

MSDN 上的有用链接[Stop SQL Injection](http://msdn.microsoft.com/en-us/magazine/cc163917.aspx)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-20T14:10:06.703

发生 SQL 注入是因为对数据库的查询是实时构建的，例如：

```
SELECT * From Table1 WHERE " + UserInput 
```

`UserInput`可能是恶意的并包含您不希望的其他陈述。

为避免这种情况，您需要避免将查询连接在一起。

您可以通过使用参数化查询来完成此操作 - 检查`DBCommand`对象是否适合您的特定数据库风格。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-08-06T07:46:26.600

Scott Guthrie 不久前[发表了一篇](http://weblogs.asp.net/scottgu/archive/2006/09/30/Tip_2F00_Trick_3A00_-Guard-Against-SQL-Injection-Attacks.aspx)关于这方面的不错的小文章。在其中，他提出了 5 条保护自己的建议：

> 1.  **不要在不使用类型安全参数编码机制的情况下构造动态 SQL 语句。** *[...]*
>     
>     
> 2.  **始终在将应用程序投入生产之前对其进行安全审查，并建立正式的安全流程以在您进行更新时审查所有代码。** *[...]*
>     
>     
> 3.  **切勿在数据库中以明文形式存储敏感数据。** *[...]*
>     
>     
> 4.  **确保您编写自动化单元测试，专门验证您的数据访问层和应用程序免受 SQL 注入攻击。** *[...]*
>     
>     
> 5.  **锁定您的数据库，只授予访问它的 Web 应用程序运行所需的最小权限集。** *[...]*

他很好地解释*了为什么*这些很重要，并链接到其他几个资源......

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-08-06T07:52:11.020

使用参数化查询和/或存储过程并通过 SQL 参数解析您的参数。**永远不要**通过连接字符串来生成 SQL 代码。还要阅读有关 SQL 注入和编写安全代码的知识，因为防止 SQL 注入只是安全性的一小部分。还有更多（例如 XSS - 跨站点脚本）。如果黑客想要破坏您的站点/应用程序，他会寻找更多而不仅仅是 SQL 注入。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-08-06T07:48:08.283

永远不要相信用户输入，总是验证它，并使用 sql 参数。应该有足够的基础来防止 SQL 注入。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-01T05:26:59.020

希望这会有所帮助：

[http://www.codersbarn.com/post/2008/11/01/ASPNET-Data-Input-Validation.aspx](http://www.codersbarn.com/post/2008/11/01/ASPNET-Data-Input-Validation.aspx)

简短的回答是使用参数化查询。

安东尼:-) www.codersbarn.com

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-08-06T07:47:09.703

始终只使用参数化查询。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-08-06T19:58:18.127

正如其他人所说，不要连接用户输入来创建动态 sql 语句；使用动态 SQL 时始终使用参数化 SQL。但是**我要指出，在存储过程中创建动态 sql 时，该规则也适用**。这个事实是人们经常忽略的。他们认为他们是安全的，因为他们正在“使用存储过程”。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-06T07:51:21.817

“构建安全的 ASP.NET 应用程序”指南这本书有一个关于这个主题的[部分。](http://msdn.microsoft.com/en-us/library/aa302392.aspx "部分")

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-01-17T10:39:19.557

使用 Microsoft.Security.Application.AntiXss.UrlEncode 使用 XSS Secured UrlEncode 和 SQL 注入将不起作用。或者您可以使用 ASP.NET – JSON – 序列化和反序列化

还可以使用 Macfee Fre Tool 中的 SiteDigger 测试您的应用程序。

更多来自[这里](http://www.mcafee.com/in/downloads/free-tools/index.aspx)

.NET 安全工具包 v1.0 .NETMon v1.0 Validator.NET v1.0

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-02-09T10:29:54.090

每个人都说“使用参数”。如果不是那么困难，我们就不得不少说。

使用[QueryFirst](https://marketplace.visualstudio.com/items?itemName=bbsimonbb.QueryFirst)。连接的诱惑被消除，正确的方法成为最简单的方法。您只需在 SQL 中键入 @myParam 即可创建参数，其余的由该工具完成。

免责声明：我写了 QueryFirst

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2009-08-06T07:48:54.660

了解 SQL 注入到底是什么，然后永远不要编写任何易受其攻击的东西。

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2008-11-20T11:52:39.413

尝试使用存储过程，并验证数据的输入。不要使用任何直接的 SQL，例如 INSERT INTO ...

# parallel-processing - 并行编程中当前的“热门”话题？

> ID：305046
> 
> 赞同：4
> 
> 时间：2008-11-20T11:49:25.723
> 
> 标签：parallel-processing

我希望这是提问的正确地方[1]，但我在这里阅读了很多关于其他主题的好评，所以我只是问问。目前我正在为我的论文寻找一个主题（我认为在非德国国家攻读博士学位），它必须与并行性或并发性等有关，但否则我可以自由选择我的'我很感兴趣。此外，使用 GPU 的一切都是不合理的，因为我的一位同事已经研究过这个主题，我们想为我提供一些其他的东西 :)

所以，神奇的问题是：你认为这个领域有哪些有趣的话题？我个人对并行函数式编程语言和一般的虚拟机很感兴趣，但我想说很多工作已经在那里完成或正在积极研究（例如在 Haskell 社区中）。

我非常感谢任何帮助我指出其他有趣的话题。

最好的问候，迈克尔

PS：我已经看过[https://stackoverflow.com/questions/212253/what-are-the-developments-going-on-in-all-languages-in-parallel-programming-area](https://stackoverflow.com/questions/212253/what-are-the-developments-going-on-in-all-languages-in-parallel-programming-area)但没有很多答案。

[1] 我已经在[http://lambda-the-ultimate.org](http://lambda-the-ultimate.org)上询问过，但不幸的是，回复没有预期的那么多。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-30T01:57:09.850

[软件事务内存](http://en.wikipedia.org/wiki/Software_transactional_memory)?

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-20T12:22:25.093

另一个研究领域是自动并行化。也就是说，给定一个指令序列 S0..Sn，想出多个序列以更少的步骤执行相同的工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-20T12:01:20.503

二郎编程！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-08-08T11:29:54.297

从我的头顶：

1.  负载平衡以及如何实现最佳并行化水平。我认为这可能是攻读博士学位的一个很好的起点，因为您可以在这里提出新方法并将其与手头的实际值（步骤数 - 已经提到过，CPU 使用率，内存使用率等）进行比较，或者针对特定算法或一组任务（例如图像处理）。

2.  并行垃圾收集。有很多算法用于收集，有很多算法可以在内存中呈现对象。例如，Haskell 社区最近有一篇关于 Parallel GC 的工作：[http](http://research.microsoft.com/en-us/um/people/simonpj/papers/parallel-gc/index.htm) : //research.microsoft.com/en-us/um/people/simonpj/papers/parallel-gc/index.htm展示您的结果并将其与其他人进行比较的好方法，它最终为您提供了灵活性 - 您可以稍后专注于并发数据结构，或同步原语或算法等。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-11T23:07:06.363

可能您现在已经获得了博士学位；）。无论如何：我想到了大规模并行系统的容错。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-30T03:56:41.043

并行友好的通用应用程序功能。目前，并行性主要集中在科学计算和编程语言上，而不是消费者应用程序或消费者应用程序友好的特性/数据结构/设计模式，这些在多核世界中将非常重要。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-20T13:27:48.753

并行处理和规则引擎都是商业/工业计算领域的高知名度主题。那么，如何查看 Rete 算法的并行实现（[这里](http://en.wikipedia.org/wiki/Rete_algorithm)和[这里](http://www.ddj.com/184405218)的介绍性描述），这是许多商业业务规则引擎的基础？是否有构建更适合并行化的 Rete 网络的技术？一个“普通”的 Rete 网络能否重构为多个可以更有效地并行执行的网络？等等。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-08-08T10:53:06.707

您提到了 Haskell，您肯定偶然发现了[Data Parallel Haskell](http://www.haskell.org/haskellwiki/GHC/Data_Parallel_Haskell)。由于大数据分析最近是一个热门词，并且考虑到 Map/Reduce 领域人满为患，我认为 DPH 是一个很好的研究领域。

# blackberry - 以编程方式拒绝 BlackBerry 上的呼叫

> ID：305053
> 
> 赞同：7
> 
> 时间：2008-11-20T11:52:39.740
> 
> 标签：blackberry, call

我正在尝试使用 Java + JDE 以编程方式拒绝黑莓上的呼叫。我正在拦截该`callIncoming`事件，并且在那里我需要做一些事情来拒绝来自特定号码的呼叫。

有谁知道这是怎么做到的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T19:36:33.767

我找不到直接拒绝正在进行的呼叫的 API。但是，您可以探索一个 hack，您可以在其中注入挂断/断开连接按钮的按键（请参阅 参考资料`EventInjector`）。

至于确定电话号码，您可以使用`Phone.getCall(callId).getDisplayPhoneNumber()`或`Phone.getActiveCall().getDisplayPhoneNumber()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T16:22:55.797

没有别的办法了`EventInjector`。BlackBerry API 的“安全”布局不允许挂断/拒绝通话。我们试图为这个问题找到一个解决方案 2 年。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-06T19:38:12.437

使用传入呼叫侦听器和通知 API，您可以以编程方式拒绝呼叫。

黑莓开发者论坛上有一个讨论它的话题，你可以在[这里找到它](http://supportforums.blackberry.com/rim/board/message?board.id=java_dev&message.id=40388&query.id=776291#M40388)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-28T18:24:20.830

尝试这个

[如何在黑莓中断开通话](http://blog.vimviv.com/blackberry/how-to-disconnect-a-call-in-blackberry/)

# jsp - 什么是好的 Jsp IDE

> ID：305056
> 
> 赞同：8
> 
> 时间：2008-11-20T11:53:27.133
> 
> 标签：jsp, ide

我是 ac# 开发人员，但有一份涉及一些 jsp 代码的工作。我一直在使用记事本++，它在突出显示方面做得很好，但我缺少智能感知，并且很难找到我需要的方法。

对于具有智能感知的 C# 的人来说，什么是好的 jsp IDE？

**更新**

我尝试了eclipse和idea，但两个界面都非常不同且不熟悉。所以我最终在记事本++中完成了它。

**更新 - Netbeans 完成了这项工作**

谢谢基比。我有更多时间，我尝试了 netbeans，它与 JSP 配合得很好。让它工作起来真的很容易。我[下载了它](http://www.netbeans.org/downloads/index.html)，安装了 jsp 插件，然后就可以运行了。它具有智能感知功能并且非常轻巧。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-22T19:37:33.330

您可能想查看[Netbeans](http://www.netbeans.org/)。根据我对 Java 应用程序的记忆，它有很好的智能感知支持。虽然我从未将它用于 JSP。从仅仅阅读他们的网站来看，他们似乎确实有很好的智能感知功能，比如 JSP 和 J2EE Web 开发类型的东西。这绝对值得一试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T13:02:28.150

我喜欢[Intellij 的 IDEA——](http://www.jetbrains.com/idea/)但我是从 Java 方面进入 C#...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T12:00:59.803

这不会是您问题的答案，但不要期望 Java 世界中有类似 VS 的功能。我并不是说没有好的系统，我是说一旦你习惯了 VS，就很难改变你对 IDE 应该做什么的想法。只需尝试不同的 IDE，看看哪种最适合您——这始终是个人选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-09T15:55:24.023

我认为 Neatbeans 比其他支持 JSP 的 IDE 更好，特别是对于在 MS Visual Studio 上工作的用户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T12:01:17.587

IBM 的 Eclipse 似乎是市场领导者之一，但对于您正在做的事情来说，它可能是一个企业应用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-20T12:12:51.340

试试myEclipse，它至少有一个集成的设计视图，看看有没有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-22T20:12:13.197

我们在工作中使用[JBuilder](http://www.codegear.com/products/jbuilder)，它做得很好。它也有智能感知。

# c++ - 构建没有 CRT 和默认标题的控制台应用程序？

> ID：305064
> 
> 赞同：7
> 
> 时间：2008-11-20T11:59:00.587
> 
> 标签：c++, windows, visual-studio-2008, visual-c++

我正在尝试在不使用 CRT 或任何其他导入而不使用 kernel32.lib 的情况下构建控制台应用程序。我让我的代码编译，但无法围绕一些问题包装链接器：

```
unresolved external symbol @__security_check_cookie@4
unresolved external symbol "int __cdecl FreeLibrary(void *)" (?FreeLibrary@@YAHPAX@Z)
unresolved external symbol "void * __cdecl LoadLibraryW(wchar_t *)" (?LoadLibraryW@@YAPAXPA_W@Z)
unresolved external symbol "int (__cdecl*__cdecl GetProcAddress(void *,char *))(void)" (?GetProcAddress@@YAP6AHXZPAXPAD@Z)
unresolved external symbol _wmainCRTStartup 
```

我已经明确引入了 FreeLibrary、LoadLibraryW 和 GetProcAddress，而不是使用 windows.h：

```
#pragma comment(lib, "kernel32.lib")

typedef int(*FARPROC)();

void* LoadLibraryW( wchar_t* lpLibFileName );
FARPROC GetProcAddress( void* hModule, char* lpProcName );
int FreeLibrary( void* hLibModule ); 
```

我想我的原型有问题。然而，更大的问题是`__security_check_cookie`和`_wmainCRTStartup`，这显然与 CRT 有关。所以我想知道我将如何覆盖`int wmain(int argc, wchar_t* argv[])`入口点的默认值，以及如何摆脱任何安全 cookie。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T12:26:07.507

_wmainCRTStartup 是调用 wmain() 的函数

IIRC 它应该在您可以链接的某些 .o 文件中可用，请查看您的 lib 目录。

也许这也是有用的阅读：[使用 LIBCTINY.LIB 减少 EXE 和 DLL 大小](http://msdn.microsoft.com/en-us/magazine/cc301696.aspx)（和 Matt Pietrek 摇滚 :-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T13:00:15.893

好吧，在这里回答自己总结一下，以防其他人发现此页面寻找信息。

正如 MSalters 建议的那样，可以从 CRT 源中窃取安全 cookie 代码，但这样做我发现`/GS-`编译器标志可以用来完全避免安全问题。

正如 SoapBox 所说，API 函数必须是`__stdcall`，入口点也是如此。我用链接器命令行标志修复了入口点问题`/entry:wmain`。

最后，正如 Tomek 指出的，API 函数必须在 extern C 中！

所以：

```
#pragma comment(lib, "kernel32.lib")

typedef int(*FARPROC)();

extern "C" {
  void* __stdcall LoadLibraryW( wchar_t* lpLibFileName );
  FARPROC __stdcall GetProcAddress( void* hModule, char* lpProcName );
  int __stdcall FreeLibrary( void* hLibModule );
  typedef int (__stdcall *f_MessageBoxW_t)( unsigned long hWnd, wchar_t* lpText, wchar_t* lpCaption, unsigned long uType);
  f_MessageBoxW_t fnMsg;
  void* hUser;
};

int __stdcall wmain(int argc, wchar_t* argv[])
{
  hUser = LoadLibraryW( L"user32.dll" );
  fnMsg = (f_MessageBoxW_t)GetProcAddress( hUser, "MessageBoxW" );
  fnMsg( 0, L"foo", L"bar", 0 );
  FreeLibrary( hUser );
  return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-27T20:01:27.380

更正确的入口点声明将是：

```
int __stdcall wmain(PVOID ThreadParam) 
```

没有由 BaseThreadInitThunk 直接调用的 CRT 入口点。它传递指向某物的指针，但不传递 argc+argv。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T12:05:39.480

您可以在 Windows.h 中查看您的 kernel32 导入所需的原型。一般来说，windows 函数被定义`WINAPI`为实际`__stdcall`和非`__cdecl`. 这至少可以解决这个问题。

至于您的其他问题，您需要探索链接器命令行参数，看看是否有办法让它不从 CRT 中查找内容。我不知道是否有办法做到这一点。但是您将不得不自己找到一种方法或定义这些功能（您可能不想这样做）。

我建议只使用不同的编译器/链接器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T12:49:43.993

您需要将 windows.h 函数声明为 extern "C"。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-20T12:19:53.213

正确的入口点是`main()`, not `wmain()`（因为您正在编译控制台应用程序）。可以从 CRT 源代码中截取安全 cookie 代码；无需链接它。

# c# - 何时使用激活器，何时使用工厂方法？

> ID：305068
> 
> 赞同：4
> 
> 时间：2008-11-20T12:00:14.483
> 
> 标签：c#

我学习了工厂方法设计模式，同时，通过阅读教程，我遇到了 Activator 对象以及如何使用它（我在智能感知中遇到过很多这个对象）。

Activator 允许后期绑定，这非常有用。但这是因为我们不知道要实例化什么类。同样，工厂方法处理软件工程中的相同问题。

简单来说，一堆 if 或 case 语句，然后根据 if 条件实例化一个对象是工厂方法的实现，对吧？

在一个相关主题上，我读到多态性可以通过消除 case 语句来减少对象之间的耦合。有这样的例子吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-20T12:49:26.337

如果您在编译时知道您想要实例化的所有潜在类，请使用工厂模式，它会更快并让编译器检查您的类型安全性。

另一方面，如果您不知道可能需要实例化的所有类（例如，如果您尝试提供插件架构），那么您唯一的选择是使用`Activator`.

这里的简单经验法则是：`Activator`只要场景允许，选择工厂而不是 using（或任何其他类型的运行时绑定）。

# c++ - 我可以将 Visual Studio 2005 设置为在调试时忽略特定代码区域中的断言吗

> ID：305077
> 
> 赞同：5
> 
> 时间：2008-11-20T12:03:49.283
> 
> 标签：c++, c, debugging, visual-studio-2005, assert

这是场景。我正在调试我自己的应用程序（C/C++），它使用了公司另一个团队开发的一些库。当我的代码生成一些极端情况时，断言失败。这很痛苦，因为断言没有正确制定，所以库函数工作正常，但我得到了所有这些中断，我只需要继续（很多因为它在一个循环中），所以我可以得到我真正感兴趣的东西. 由于其他原因，我在调试时必须使用调试版本的库。另一个团队在下一个版本之前不会修复这个问题（嘿，它可以在我们的机器上运行）。

我可以告诉调试器忽略这部分代码断言的断点吗（即它可以为我自动继续）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T12:27:32.603

如果代码自行触发断点（通过 __debugbreak 或 int 3），则不能使用条件断点，因为 Visual Studio 根本不知道断点。但是，您可以通过修改调试器中的代码来禁用您不感兴趣的任何此类断点。可能不是您想要的，因为您需要在每个调试会话中重复此操作，但总比没有好。有关更多信息，请阅读[如何禁用编程断点/断言？](https://stackoverflow.com/questions/115237/how-to-disable-a-programmatical-breakpoint-assert).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T12:28:11.277

在调试库中没有自动忽略 ASSERT() 失败的好方法。如果这是你必须使用的，你只需要说服其他团队现在需要修复它，或者如果你有这个库的源代码，你可以自己修复或删除断言只是为了得到你的工作在此期间完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T12:48:37.283

您可以在对库的调用周围添加一个异常处理程序，捕获 EXCEPTION_BREAKPOINT 异常并且什么都不做。

以下链接中的示例 2 似乎是您想要做的：

[http://msdn.microsoft.com/en-us/library/ms681409(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms681409(VS.85).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T12:11:29.563

您可以使用条件断点。一些链接：

[http://support.microsoft.com/kb/308469](http://support.microsoft.com/kb/308469)
[http://dotnettipoftheday.org/tips/conditional_breakpoint.aspx](http://dotnettipoftheday.org/tips/conditional_breakpoint.aspx)

# xml - 如何验证兼容的 XML 站点地图？

> ID：305081
> 
> 赞同：9
> 
> 时间：2008-11-20T12:06:13.660
> 
> 标签：xml, sitemap

对于以下标题，我在所有站点地图上都遇到了相同的两个错误。这很令人困惑，因为如果 Google 无法读取我的站点地图，那么他们怎么能说每个 URL 具有相同的优先级？在 XML 声明之后，标头算作第 2 行。谷歌声称只索引了地图中大约 2% 的 URL。请帮忙。

> 更新：我认为问题在于我不知道如何针对模式进行验证。怎么做？

```
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd">

==Parsing error
We were unable to read your Sitemap. It may contain an entry we are 
unable to recognize. Please validate your Sitemap before resubmitting.

==Notice
All the URLs in your Sitemap have the same priority... 
```

更新：请耐心等待，第一次验证 XML。我不明白错误。

```
Errors in the XML document:
    4:  80  SchemaLocation: schemaLocation value = 'http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd' must have even number of URI's.
    4:  80  cvc-elt.1: Cannot find the declaration of element 'urlset'.

XML document:
1   <?xml version="1.0" encoding="UTF-8"?>
2   <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
3     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
4     xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd">
5     <url>
6       <loc>http://nutrograph.com/1-butter-salted</loc>
7       <changefreq>monthly</changefreq>
8       <priority>0.8</priority>
9     </url>
10    <url>
11      <loc>http://nutrograph.com/2-butter-whipped-with-salt</loc>
12      <changefreq>monthly</changefreq>
13      <priority>0.8</priority>
14    </url>
15  </urlset> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-20T12:11:04.337

您是否根据此处给出的架构验证了您的 XML：[http ://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd](http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd)

如果是，结果如何？

如果不是，您的站点地图的 URL 是什么？

如果您不知道如何根据架构验证 XML，请使用[http://www.xmlvalidation.com/](http://www.xmlvalidation.com/)

将站点地图 XML 粘贴到那里，单击“根据外部 XML 模式验证”并在单击“验证”按钮后粘贴模式。

这将告诉您 XML 有什么问题。如果您不知道如何解释结果，请相应地修改您的原始问题。

编辑：错误是 schemaLocation 中缺少命名空间 URL。第一个标签必须如下所示：

```
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd"> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-20T12:13:20.793

打击以上。查看 Google 的站点，他们的站点地图标题似乎比您的要长一点。

它在这个页面上：[https ://www.google.com/webmasters/tools/docs/en/protocol.html](https://www.google.com/webmasters/tools/docs/en/protocol.html)

```
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9
http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T20:19:42.160

注意 schemaLocation 有 2 个 URI...（必须有偶数个 URI）

它应该如下所示：**

> xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9 [http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd](http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd) "

**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-05T14:05:10.427

我在这种语法中也遗漏了一些东西

> xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
> xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xs">

你错过了这个语法吗？！

只是在 url 扩展名末尾的字母“d”（[http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xs](http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xs)）

添加字母“d”后解决我的这个问题

# c# - c# WPF维护加载器的单个实例

> ID：305088
> 
> 赞同：1
> 
> 时间：2008-11-20T12:09:28.617
> 
> 标签：c#, wpf, single-instance

我有一个带有 Main() 的 loader.exe，它在 WPF 中加载“UI”，问题是我只想要一个 loader.exe 的实例，我该如何实现呢？

有没有办法让用户点击 loader.exe 它应该检查现有的 loader.exe 是否正在运行并且什么都不做。

目前我有

加载程序

和

```
main() 
....
..
Load UI
... 
```

加载器不知道它的加载等等，所以我不能用加载器项目做很多事情......

非常感谢任何帮助代码

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T12:50:48.750

看一下：

[http://yogesh.jagotagroup.com/blog/post/2008/07/03/Ways-of-making-a-WPF-application-Single-Instance.aspx](http://yogesh.jagotagroup.com/blog/post/2008/07/03/Ways-of-making-a-WPF-application-Single-Instance.aspx)

此外，您可能会在 StackOverflow 上的以下帖子中找到更详细的答案：

[创建单实例应用程序的正确方法是什么？](https://stackoverflow.com/questions/19147/what-is-the-correct-way-to-create-a-single-instance-application)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T13:38:07.297

我们使用以下 C# 代码来检测应用程序是否已在运行：

```
using System.Threading;

string appSpecificGuid = "{007400FE-003D-00A5-AFFE-DA62E35CC1F5}";    
bool exclusive;
Mutex m = new Mutex(true, appSpecificGuid, out exclusive);
if (exclusive) {
    // run
} else {
    // already running
} 
```

问候，坦伯格

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-22T17:23:44.813

这是我简单而有用的解决方案：http: [//blogs.microsoft.co.il/blogs/maxim/archive/2010/02/13/single-instance-application-manager.aspx](http://blogs.microsoft.co.il/blogs/maxim/archive/2010/02/13/single-instance-application-manager.aspx)

# .net - 哪种方法性能更好：.Any() 与 .Count() > 0？

> ID：305092
> 
> 赞同：662
> 
> 时间：2008-11-20T12:11:19.003
> 
> 标签：.net, linq, performance, .net-3.5, extension-methods

在`System.Linq`命名空间中，我们现在可以扩展我们的[IEnumerable](https://docs.microsoft.com/en-us/dotnet/api/system.collections.ienumerable?view=netframework-3.5)以拥有[Any()](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.any?view=netframework-3.5)和[Count()](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.count?view=netframework-3.5) *扩展方法*。

最近有人告诉我，如果我想检查一个集合中是否包含 1 个或多个项目，我应该使用`.Any()`扩展方法而不是`.Count() > 0`扩展方法，因为`.Count()`扩展方法必须遍历所有项目。

其次，一些集合有一个*属性*（不是扩展方法）是`Count`or `Length`。使用它们而不是`.Any()`or会更好`.Count()`吗？

是的/不？

* * *

## 回答 #1

> 赞同：804
> 
> 时间：2008-11-20T12:37:04.550

如果您从具有`.Length`or的东西开始`.Count`（例如`ICollection<T>`, `IList<T>`,`List<T>`等） - 那么这将是最快的选择，因为它不需要通过检查非空序列所需的`GetEnumerator()`//序列.`MoveNext()``Dispose()``Any()``IEnumerable<T>`

对于 just `IEnumerable<T>`， then*通常*`Any()`会更快，因为它只需要查看一次迭代。但是，请注意，LINQ-to-Objects 的实现确实会检查（用作优化） - 因此，如果您的基础数据源**直接**是列表/集合，则不会有很大的不同。不要问我为什么不使用非泛型...*`Count()``ICollection<T>``.Count`**`ICollection`***

 ***当然，如果您使用 LINQ 对其进行过滤等（`Where`等等），您将拥有一个基于迭代器块的序列，因此这种`ICollection<T>`优化是无用的。

通常使用`IEnumerable<T>`: 坚持使用`Any()`;-p

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2012-06-14T23:22:06.993

**注意：**我在 Entity Framework 4 实际出现时写了这个答案。这个答案的重点不是要进行微不足道的`.Any()`与`.Count()`性能测试。关键是要表明 EF 远非完美。较新的版本更好......但是如果您有部分代码很慢并且它使用 EF，请使用直接 TSQL 进行测试并比较性能，而不是依赖假设（`.Any()`总是比 更快`.Count() > 0`）。

* * *

虽然我同意大多数赞成的答案和评论 - 特别是在这一点上`Any`表明*开发人员的意图*比`Count() > 0`- 我遇到过 Count 在 SQL Server（EntityFramework 4）上快一个数量级的情况。

这是带有`Any`超时异常的查询（在〜200.000条记录上）：

```
con = db.Contacts.
    Where(a => a.CompanyId == companyId && a.ContactStatusId <= (int) Const.ContactStatusEnum.Reactivated
        && !a.NewsletterLogs.Any(b => b.NewsletterLogTypeId == (int) Const.NewsletterLogTypeEnum.Unsubscr)
    ).OrderBy(a => a.ContactId).
    Skip(position - 1).
    Take(1).FirstOrDefault(); 
```

`Count`以毫秒为单位执行的版本：

```
con = db.Contacts.
    Where(a => a.CompanyId == companyId && a.ContactStatusId <= (int) Const.ContactStatusEnum.Reactivated
        && a.NewsletterLogs.Count(b => b.NewsletterLogTypeId == (int) Const.NewsletterLogTypeEnum.Unsubscr) == 0
    ).OrderBy(a => a.ContactId).
    Skip(position - 1).
    Take(1).FirstOrDefault(); 
```

我需要找到一种方法来查看两个 LINQ 生成的确切 SQL - 但很明显`Count`，`Any`在某些情况下，两者之间存在巨大的性能差异，不幸的是，您似乎不能`Any`在所有情况下都坚持下去。

编辑：这里是生成的 SQL。如您所见的美女；）

`ANY`：

```
exec sp_executesql N'SELECT TOP (1)
[Project2].[ContactId] AS [ContactId],
[Project2].[CompanyId] AS [CompanyId],
[Project2].[ContactName] AS [ContactName],
[项目 2].[全名] 作为 [全名]，
[Project2].[ContactStatusId] AS [ContactStatusId],
[项目2].[已创建] AS [已创建]
FROM ( SELECT [Project2].[ContactId] AS [ContactId], [Project2].[CompanyId] AS [CompanyId], [Project2].[ContactName] AS [ContactName], [Project2].[FullName] AS [FullName] , [Project2].[ContactStatusId] AS [ContactStatusId], [Project2].[Created] AS [Created], row_number() OVER (ORDER BY [Project2].[ContactId] ASC) AS [row_number]
    从（选择
        [Extent1].[ContactId] AS [ContactId]，
        [Extent1].[CompanyId] AS [CompanyId],
        [Extent1].[ContactName] AS [ContactName]，
        [Extent1].[FullName] AS [FullName]，
        [Extent1].[ContactStatusId] AS [ContactStatusId],
        [Extent1].[已创建] AS [已创建]
        FROM [dbo].[Contact] AS [Extent1]
        WHERE ([Extent1].[CompanyId] = @p__linq__0) AND ([Extent1].[ContactStatusId] <= 3) AND ( 不存在 (SELECT
            1 作为 [C1]
            FROM [dbo].[NewsletterLog] AS [Extent2]
            WHERE ([Extent1].[ContactId] = [Extent2].[ContactId]) AND (6 = [Extent2].[NewsletterLogTypeId])
        ))
    ) 作为 [项目2]
) 作为 [项目2]
WHERE [Project2].[row_number] > 99
ORDER BY [Project2].[ContactId] ASC',N'@p__linq__0 int',@p__linq__0=4

```

`COUNT`：

```
exec sp_executesql N'SELECT TOP (1)
[Project2].[ContactId] AS [ContactId],
[Project2].[CompanyId] AS [CompanyId],
[Project2].[ContactName] AS [ContactName],
[项目 2].[全名] 作为 [全名]，
[Project2].[ContactStatusId] AS [ContactStatusId],
[项目2].[已创建] AS [已创建]
FROM ( SELECT [Project2].[ContactId] AS [ContactId], [Project2].[CompanyId] AS [CompanyId], [Project2].[ContactName] AS [ContactName], [Project2].[FullName] AS [FullName] , [Project2].[ContactStatusId] AS [ContactStatusId], [Project2].[Created] AS [Created], row_number() OVER (ORDER BY [Project2].[ContactId] ASC) AS [row_number]
    从（选择
        [Project1].[ContactId] AS [ContactId],
        [Project1].[CompanyId] AS [CompanyId],
        [Project1].[ContactName] AS [ContactName]，
        [项目 1].[全名] 作为 [全名]，
        [Project1].[ContactStatusId] AS [ContactStatusId],
        [Project1].[已创建] AS [已创建]
        从（选择
            [Extent1].[ContactId] AS [ContactId]，
            [Extent1].[CompanyId] AS [CompanyId],
            [Extent1].[ContactName] AS [ContactName]，
            [Extent1].[FullName] AS [FullName]，
            [Extent1].[ContactStatusId] AS [ContactStatusId],
            [Extent1].[Created] AS [Created],
            （选择
                计数(1) 作为 [A1]
                FROM [dbo].[NewsletterLog] AS [Extent2]
                WHERE ([Extent1].[ContactId] = [Extent2].[ContactId]) AND (6 = [Extent2].[NewsletterLogTypeId])) 作为 [C1]
            FROM [dbo].[Contact] AS [Extent1]
        ) 作为 [项目1]
        WHERE ([Project1].[CompanyId] = @p__linq__0) AND ([Project1].[ContactStatusId] <= 3) AND (0 = [Project1].[C1])
    ) 作为 [项目2]
) 作为 [项目2]
WHERE [Project2].[row_number] > 99
ORDER BY [Project2].[ContactId] ASC',N'@p__linq__0 int',@p__linq__0=4

```

似乎使用 EXISTS 的纯 Where 比计算 Count 然后使用 Count == 0 进行 Where 效果差得多。

如果你们在我的发现中发现一些错误，请告诉我。不管任何与计数的讨论如何，从这一切中可以得出的结论是，任何更复杂的 LINQ 在重写为存储过程时会更好;)。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2015-05-28T08:14:57.683

由于这是一个相当受欢迎的话题并且答案不同，我不得不重新审视这个问题。

**测试环境：** EF 6.1.3、SQL Server、300k 条记录

**表型号**：

```
class TestTable
{
    [Key]
    public int Id { get; set; }

    public string Name { get; set; }

    public string Surname { get; set; }
} 
```

**测试代码：**

```
class Program
{
    static void Main()
    {
        using (var context = new TestContext())
        {
            context.Database.Log = Console.WriteLine;

            context.TestTables.Where(x => x.Surname.Contains("Surname")).Any(x => x.Id > 1000);
            context.TestTables.Where(x => x.Surname.Contains("Surname") && x.Name.Contains("Name")).Any(x => x.Id > 1000);
            context.TestTables.Where(x => x.Surname.Contains("Surname")).Count(x => x.Id > 1000);
            context.TestTables.Where(x => x.Surname.Contains("Surname") && x.Name.Contains("Name")).Count(x => x.Id > 1000);

            Console.ReadLine();
        }
    }
} 
```

**结果：**

任何（）〜3毫秒

Count() ~ 230ms 第一次查询， ~ 400ms 第二次

**评论：**

就我而言，EF 没有像@Ben 在他的帖子中提到的那样生成 SQL。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2020-08-24T22:41:39.007

.NET Framework 与 .NET Core 的具体细节略有不同，但也取决于您在做什么：如果您使用的是`ICollection`or`ICollection<T>`类型（例如 with `List<T>`），则有一个`.Count`访问成本较低的属性，而其他类型可能需要枚举。

## TL;博士：

**如果属性存在则使用`.Count > 0`，否则使用`.Any()`。**

使用*从来都不*`.Count() > 0`是最好的选择，在某些情况下可能会慢很多。

 *这适用于 .NET Framework 和 .NET Core。

* * *

现在我们可以深入了解细节..

## 列表和集合

让我们从一个非常常见的情况开始：使用`List<T>`（也是`ICollection<T>`）。

该`.Count`属性实现为：

```
 private int _size;

    public int Count {
        get {
            Contract.Ensures(Contract.Result<int>() >= 0);
            return _size; 
        }
    } 
```

这就是说`_size`由 等维护`Add()`，`Remove()`并且由于它只是访问一个字段，这是一个非常便宜的操作——我们不需要迭代值。

`ICollection`并且`ICollection<T>`两者都有`.Count`并且*大多数*实现它们的类型都可能以类似的方式这样做。

## 其他 IEnumerables

任何其他不需要`IEnumerable`的类型也`ICollection`需要开始枚举以确定它们是否为空。影响性能的关键因素是我们最终是枚举单个项目（理想）还是整个集合（相对昂贵）。

如果集合实际上导致了 I/O，例如通过从数据库或磁盘读取，这可能会对性能造成很大影响。

* * *

## .NET 框架`.Any()`

在 .NET Framework (4.8) 中，`Any()`实现是：

```
public static bool Any<TSource>(this IEnumerable<TSource> source) {
    if (source == null) throw Error.ArgumentNull("source");
    using (IEnumerator<TSource> e = source.GetEnumerator()) {
        if (e.MoveNext()) return true;
    }
    return false;
} 
```

这意味着无论如何，它将获得一个新的枚举器对象并尝试迭代一次。这比调用`List<T>.Count`属性更昂贵，但至少它没有迭代整个列表。

## .NET 框架`.Count()`

在 .NET Framework (4.8) 中，`Count()`实现是（基本上）：

```
public static int Count<TSource>(this IEnumerable<TSource> source)
{
    ICollection<TSource> collection = source as ICollection<TSource>;
    if (collection != null)
    { 
        return collection.Count;
    }
    int num = 0;
    using (IEnumerator<TSource> enumerator = source.GetEnumerator())
    {
        while (enumerator.MoveNext())
        {
            num = checked(num + 1);
        }
        return num;
    }
} 
```

如果可用，`ICollection.Count`则使用，否则枚举集合。

* * *

## .NET 核心`.Any()`

.NET Core 中的 LINQ`Any()`实现要智能得多。您可以在[此处查看完整的源代码，](https://github.com/dotnet/runtime/blob/master/src/libraries/System.Linq/src/System/Linq/AnyAll.cs)但可以查看与此讨论相关的部分：

```
 public static bool Any<TSource>(this IEnumerable<TSource> source)
    {
        //..snip..

        if (source is ICollection<TSource> collectionoft)
        {
            return collectionoft.Count != 0;
        }

        //..snip..

        using (IEnumerator<TSource> e = source.GetEnumerator())
        {
            return e.MoveNext();
        }
    } 
```

因为 a`List<T>`是 an `ICollection<T>`，这将调用`Count`属性（虽然它调用另一个方法，但没有额外的分配）。

## .NET 核心`.Count()`

.NET Core 实现（[source](https://github.com/dotnet/runtime/blob/master/src/libraries/System.Linq/src/System/Linq/Count.cs)）与 .NET Framework（见上文）基本相同，因此`ICollection.Count`如果可用，它将使用，否则枚举集合。

* * *

## 概括

### .NET 框架

*   与`ICollection`：

    *   `.Count > 0`是最好的
    *   `.Count() > 0`很好，但最终只是打电话`ICollection.Count`
    *   `.Any()`会变慢，因为它枚举单个项目
*   与非`ICollection`（无`.Count`财产）

    *   `.Any()`最好，因为它只枚举单个项目
    *   `.Count() > 0`不好，因为它会导致完整的枚举

### .NET 核心

*   `.Count > 0`最好，如果有的话 ( `ICollection`)
*   `.Any()`很好，并且会做`ICollection.Count > 0`或枚举单个项目
*   `.Count() > 0`不好，因为它会导致完整的枚举

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-01-03T16:32:26.523

**编辑：**它已在 EF 版本 6.1.1 中修复。这个答案不再实际

对于 SQL Server 和 EF4-6，Count() 的执行速度大约是 Any() 的两倍。

当你运行 Table.Any() 时，它会生成类似（*警告：不要伤害大脑试图理解它*）

```
SELECT 
CASE WHEN ( EXISTS (SELECT 
    1 AS [C1]
    FROM [Table] AS [Extent1]
)) THEN cast(1 as bit) WHEN ( NOT EXISTS (SELECT 
    1 AS [C1]
    FROM [Table] AS [Extent2]
)) THEN cast(0 as bit) END AS [C1]
FROM  ( SELECT 1 AS X ) AS [SingleRowTable1] 
```

这需要根据您的情况对行进行 2 次扫描。

我不喜欢写作`Count() > 0`，因为它隐藏了我的意图。我更喜欢为此使用自定义谓词：

```
public static class QueryExtensions
{
    public static bool Exists<TSource>(this IQueryable<TSource> source, Expression<Func<TSource, bool>> predicate)
    {
        return source.Count(predicate) > 0;
    }
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-12-22T23:43:13.713

这取决于数据集有多大以及您的性能要求是什么？

如果没什么大不了的，请使用最易读的形式，对我来说是任何形式，因为它更短，更易读，而不是等式。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-01-20T17:15:51.127

你可以做一个简单的测试来解决这个问题：

```
var query = //make any query here
var timeCount = new Stopwatch();
timeCount.Start();
if (query.Count > 0)
{
}
timeCount.Stop();
var testCount = timeCount.Elapsed;

var timeAny = new Stopwatch();
timeAny.Start();
if (query.Any())
{
}
timeAny.Stop();
var testAny = timeAny.Elapsed; 
```

检查 testCount 和 testAny 的值。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-03-11T05:05:40.123

如果您使用的是实体框架并且有一个包含许多记录的巨大表，那么**Any()**会快得多。我记得有一次我想检查一张表是否为空，是否有数百万行。Count() > 0 需要 20-30 秒才能完成。**Any()**是即时的。

**Any()**可以提高性能，因为它可能不必迭代集合来获取事物的数量。它只需要击中其中一个。或者，对于 LINQ-to-Entities，生成的 SQL 将是 IF EXISTS(...) 而不是 SELECT COUNT ... 甚至 SELECT * ...。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-03-28T17:35:36.180

关于**Count()**方法，如果**IEnumarable**是**ICollection**，那么我们不能遍历所有项目，因为我们可以检索 ICollection 的**Count****字段**，如果**IEnumerable**不是**ICollection**我们必须使用**while**遍历所有项目一个**MoveNext**，看看 .NET Framework 代码：

 ******```
public static int Count<TSource>(this IEnumerable<TSource> source)
{
    if (source == null) 
        throw Error.ArgumentNull("source");

    ICollection<TSource> collectionoft = source as ICollection<TSource>;
    if (collectionoft != null) 
        return collectionoft.Count;

    ICollection collection = source as ICollection;
    if (collection != null) 
        return collection.Count;

    int count = 0;
    using (IEnumerator<TSource> e = source.GetEnumerator())
    {
        checked
        {
            while (e.MoveNext()) count++;
        }
    }
    return count;
} 
```

参考：[参考源可枚举](https://referencesource.microsoft.com/#System.Core/System/Linq/Enumerable.cs,6a1af7c3d17845e3)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-11-18T13:31:54.393

使用`Count()`测试空性有效，但使用`Any()`使意图更清晰，代码更具可读性。但是，有些情况需要特别注意：

如果集合是 EntityFramework 或其他 ORM 查询，则调用`Count()`将导致执行潜在的大量 SQL 查询，并可能给应用程序数据库带来大量开销。调用`Any()`也将连接到数据库，但会生成更高效的 SQL。

如果集合是包含`Select()`创建对象的语句的 LINQ 查询的一部分，则可能会不必要地分配大量内存。调用`Any()`会更有效率，因为它将执行更少的可枚举迭代。

使用示例`Any()`：

```
private static bool IsEmpty(IEnumerable<string> strings)
{
  return !strings.Any();
} 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2021-06-15T05:02:19.770

我使用 IList 创建了一个示例应用程序，其中包含 100 个元素到 100 万个项目，以查看最好的 Count vs Any。

**代码**

```
class Program
{
    static void Main()
    {

        //Creating List of customers
        IList<Customer> customers = new List<Customer>();
        for (int i = 0; i <= 100; i++)
        {
            Customer customer = new Customer
            {
                CustomerId = i,
                CustomerName = string.Format("Customer{0}", i)
            };
            customers.Add(customer);
        }

        //Measuring time with count
        Stopwatch stopWatch = new Stopwatch();
        stopWatch.Start();
        if (customers.Count > 0)
        {
            Console.WriteLine("Customer list is not empty with count");
        }
        stopWatch.Stop();
        Console.WriteLine("Time consumed with count: {0}", stopWatch.Elapsed);

        //Measuring time with any
        stopWatch.Restart();
        if (customers.Any())
        {
            Console.WriteLine("Customer list is not empty with any");
        }
        stopWatch.Stop();
        Console.WriteLine("Time consumed with count: {0}", stopWatch.Elapsed);
        Console.ReadLine();

    }
}

public class Customer
{
    public int CustomerId { get; set; }
    public string CustomerName { get; set; }
} 
```

结果 ： [![在此处输入图像描述](https://i.stack.imgur.com/rGQ9Q.png)](https://i.stack.imgur.com/rGQ9Q.png)

任何都比计数好。

# java - 阅读源代码

> ID：305094
> 
> 赞同：4
> 
> 时间：2008-11-20T12:11:43.430
> 
> 标签：java, design-patterns, discovery

如果您阅读其他人的源代码，您如何处理代码？您在寻找什么模式（数据类型、循环、控制流的使用……）？你能读多久别人的代码而不感到无聊？到目前为止，您发现的最令人兴奋的模式是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-20T12:38:02.863

起初，我忽略了更改代码的冲动。这有时很难做到。但是先了解后改变可以为自己节省很多讨厌的“学习经历”。

接下来如果格式不好，重新格式化。如果有，请使用代码格式化程序。这是因为您倾向于查看缩进，如果这很糟糕，那么您对代码的理解也是有问题的。

然后，如果有复杂的数据结构，我喜欢画一个小图。这里的挑战是让它尽可能简单。大图挂在墙上很有趣，但大多数时候，它们看起来很麻烦。所以这是浪费时间。

如果你最终理解了一段代码的作用，请写评论。这是必不可少的，否则下次您来这里时您将无法理解它。

下一步是创建单元测试。现在您不仅可以测试代码，还可以测试您对代码的理解。

最后，如果你理解它并且你知道它可以（并且需要）更好，改变它。但一定要运行测试。除非您从每个已解决的错误中获得报酬。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T12:41:56.570

一个时髦的新术语是[Code Spelunking](http://www.codespelunking.org/pages/cs_definition.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T12:37:41.163

谢谢，如果我理解正确，第一步是识别上下文，第二步是识别 API，然后将 API 放在上下文中。我只是意识到这有点像看一座建筑或一件艺术品，你可以专注于使用的材料，或者部件的功能，尝试不同的视角，判断部件如何融入整体......关于发现的过程：[这里——数学家是如何思考的](http://press.princeton.edu/chapters/i8386.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T13:12:55.883

除了明显的“自上而下”的一般方法之外，这取决于我阅读它的原因：代码审查、尝试理解一些可用的代码以适应我自己的使用、尝试学习新技术**等**.

它还很大程度上取决于语言。如果是 OOPL，我可能会这样做：

1.  首先寻找主要的类关系，并尝试了解每个类的主要职责。
2.  查看类之间的交互以了解它们如何协作。
3.  查看关键类的接口，了解它们为合作者提供了哪些“服务”。
4.  **如果重要的是了解它们是如何**工作的而不是它们负责**什么**，那么请查看这些非平凡的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T12:23:41.003

这完全取决于您正在阅读的代码类型。它是 Web 应用程序、服务还是桌面应用程序？当我开始阅读其他人的代码时，我通常会开始寻找使用的设计模式。或者对于特定于框架的东西。但是，如果您要进行审查，这也是如此。如果您是为了自己的兴趣而阅读并学习一些东西，那真的没有答案 - 您应该彻底阅读并理解代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-20T12:48:10.520

在最终产品中选择一个你理解的项目，看看它是如何组合在一起的。如果你有单元测试，那么它们是一个很大的帮助。

# sql-server - 创建无限制的 SqlServer 跟踪

> ID：305105
> 
> 赞同：1
> 
> 时间：2008-11-20T12:16:31.317
> 
> 标签：sql-server, trace, sql-server-profiler

在我的应用程序上，我正在创建实时跟踪（不知道如何，但我是！），在 SQlServer 中的 sp_trace_create 函数上，我知道@maxfilesize 默认为 5，但在我的应用程序上，它会在用户停止时停止想要阻止它......有什么想法可以做到这一点吗？

* * *

因为我不想保存文件……我不确定翻转是如何工作的？现在我把它放在一个计时器循环上，用它上面的所有指定事件查询数据库，最大文件大小为 1（通常不会超过大约 2 秒），与我的 dgview 中的旧数据合并并删除原始文件。这会一直循环下去，直到用户告诉它停止，这将停止计时器查询数据库。这不是一个可靠的方法，但我想这是一个开始！我现在需要的是找出列的数据类型，因为当我在过滤器中设置我的值时，它们需要作为与列匹配的数据类型进入......任何人都有任何线索我可以在哪里获得数据类型的列表? msdn 有列表但没有类型...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T12:19:21.043

要使用文件翻转开始跟踪，而不是在最大大小处停止，请像这样开始跟踪：

```
exec @rc = sp_trace_create @TraceID output, 2, N'InsertFileNameHere', @maxfilesize, NULL 
```

其中@maxfilesize 将定义在创建新的翻转文件之前达到的大小。

**警告**：在执行无限跟踪时要非常小心。如果你填满一张生产光盘，那是你的头，不是我的！

您可以像这样停止正在运行的跟踪：

```
EXEC sp_trace_setstatus @ID, 0

EXEC sp_trace_setstatus @ID, 2 
```

其中@ID 是您要停止的跟踪的ID。

看到这个[帖子](https://stackoverflow.com/questions/257906/ms-sql-server-2008-how-can-i-log-and-find-the-most-expensive-queries#257944)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T15:13:19.727

根据文档，您想要做的事情是不可能的：

[ @maxfilesize = ] max_file_size 以兆字节 (MB) 为单位指定跟踪文件可以增长的最大大小。max_file_size 为 bigint，默认值为 5。

如果在没有 TRACE_FILE_ROLLOVER 选项的情况下指定此参数，则当使用的磁盘空间超过 max_file_size 指定的数量时，跟踪将停止记录到文件。

我不明白为什么您不能循环浏览文件并将它们加载到表格或您的应用程序中。不应该那么难。

# delphi - FreeMM 与 ShareMem

> ID：305107
> 
> 赞同：4
> 
> 时间：2008-11-20T12:17:17.180
> 
> 标签：delphi, memory-management, fastmm

我们有很多用 delphi 和 c++ builder 编写的 dll 库，并使用 sharemem 和 borlndmm.dll。

3thparty 库中的对齐问题迫使我们转向 delphi 2007 中的新内存管理器。

有人可以为我解释一下“共享内存管理器”吗？
SimpleShareMem 是 ShareMem 的替代品吗？
那么我们可以停止部署borlndmm.dll 吗？
我们是否也必须对 c++ 库做一些事情？
一些库可以使用 ShareMem 和一些 SimpleShareMem 吗？

谢谢，-素食主义者

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T13:05:31.700

我想我在这个线程中找到了我大部分问题的答案：[borland.public.delphi.language.basm](http://groups.google.com/group/borland.public.delphi.language.basm/browse_frm/thread/8b70a36f331f137e?ie=UTF-8&oe=utf-8&q=Re:+FastMM+questions "borland.public.delphi.language.basm")：

> 使用
> (a) SimpleShareMem.pas/FastMM4.pas，或使用
> (b) ShareMem.pas（即 borlndmm.dll）
> 您不能混合使用两种不同的共享方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T12:27:09.907

只需查看[https://forums.codegear.com/thread.jspa?threadID=6608 即可](https://forums.codegear.com/thread.jspa?threadID=6608)获得有关此主题的有趣讨论。

# web-services - Axis 1.4 的 WS-ReliableMessaging 实现

> ID：305109
> 
> 赞同：0
> 
> 时间：2008-11-20T12:18:56.460
> 
> 标签：web-services, axis, ws-reliablemessaging

您知道您使用了 Axis 1.4 的 WS-ReliableMessaging 实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-21T17:36:27.147

有[Apache Sandesha](http://ws.apache.org/sandesha/sandesha1.html)但我没用过。

# newline - Document.xml 属性的 MSXML 和换行规范化（？）

> ID：305124
> 
> 赞同：3
> 
> 时间：2008-11-20T12:24:18.727
> 
> 标签：newline, msxml

我创建了以下简单的 xml（使用了 C 转义序列）“ `<A>\n</A>`”当`MSXML`（v4 和 v6）使用 IXMLDOMDocument2.xml 序列化 DOM 文档时，它将换行符更改为 dos 格式并返回：“ `<A>\r\n</A>`”。

当我使用 DOM 仅检索`<A>`元素内的字符串节点时，我得到正确的单个`("\n")`字符串。

当然我已经`preserveWhiteSpace`设置为`VARIANT_TRUE`

`XML.Net`Xerces 解析器工作正常，并且在序列化 xml 文档时不会修改存储的字符串。

这是 msxml 中的错误吗？任何想法？

谢谢吉里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-26T16:43:15.317

Microsoft 从 MSXML 4 开始更改了换行序列化的处理方式，以符合 w3wc 标准（请参阅[http://support.microsoft.com/kb/261293](http://support.microsoft.com/kb/261293)）

我不知道为什么 .Net 中的 xml 实现没有这样做，但.Net 2.0 中的 Web 服务**也是如此。**

当我上次遇到这个问题时，我得出的结论是，您要么需要考虑换行符可能会不可预测地序列化（例如通过替换`\r\n`为`\n`），要么您需要对文本进行 base-64 编码（或等效）

# c# - 将项目属性名称动态分配给类中的变量

> ID：305125
> 
> 赞同：1
> 
> 时间：2008-11-20T12:24:31.067
> 
> 标签：c#, dynamic, properties, variable-assignment

我创建了一个类来动态地将项目中的 SQL 函数语句组合在一起。我发现这个类非常有用，并希望将其纳入未来的项目中

命名空间连接类

{

```
 public class connClass

 {      

     NpgsqlConnection conn = new NpgsqlConnection(projectName.Properties.Settings.Default.ConnString);  

 } 
```

}

我希望能够动态输入项目名称，而不必为每个不同的班级自己做！连接字符串将在 VS 的属性设置中定义。

任何帮助将不胜感激：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T23:08:32.653

或者简单地使用配置管理器连接字符串属性：

```
String connStr = ConfigurationManager.ConnectionStrings["DefaultConnStr"].ConnectionString; 
```

然后像这样设置你的 app.config：

```
<configuration>
    <connectionStrings>
         <add name="DefaultConnStr" connectionString="Data Source=127.0.0.1..."/>
    </connectionStrings>
</configuration> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T12:49:30.190

一种选择是让连接类使用 ConfigurationManager 从 App.Config 文件中获取名称 - 但这仍然意味着在其中设置名称。就像是

```
ConfigurationManager.AppSettings["PROJECT_NAME"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T12:49:56.803

或者重构您的通用代码以不需要项目名称......

# unicode - Base64ing Unicode 字符

> ID：305140
> 
> 赞同：19
> 
> 时间：2008-11-20T12:29:30.167
> 
> 标签：unicode, base64

[Unicode](http://en.wikipedia.org/wiki/Unicode)字符可以用[Base64](http://en.wikipedia.org/wiki/Base64)编码和解码吗？

我试图对字符串'الله'进行编码，但是当我解码它时，我得到的只是'????'。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-20T12:40:16.993

Base64 将*二进制*转换为文本。如果您想将文本转换为 base64 格式，您需要先使用一些适当的编码（例如 UTF-8、UTF-16）将文本转换为二进制。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-20T12:36:20.963

他们当然可以。这取决于您的语言或 Base64 例程如何处理 Unicode 输入。例如，Python 的`b64`例程需要一个编码字符串（因为 Base64 将二进制编码为文本，而不是将 Unicode 代码点编码为文本）。

```
Python 2.5.1 (r251:54863, Jul 31 2008, 22:53:39)
[GCC 4.1.2 (Ubuntu 4.1.2-0ubuntu4)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> a = 'ûñö'
>>> import base64
>>> base64.b64encode(a)
'w7vDscO2'
>>> base64.b64decode('w7vDscO2')
'\xc3\xbb\xc3\xb1\xc3\xb6'
>>> print '\xc3\xbb\xc3\xb1\xc3\xb6'
ûñö
>>>     
>>> u'üñô'
u'\xfc\xf1\xf4'
>>> base64.b64encode(u'\xfc\xf1\xf4')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.5/base64.py", line 53, in b64encode
    encoded = binascii.b2a_base64(s)[:-1]
UnicodeEncodeError: 'ascii' codec can't encode characters in position
0-2: ordinal not in range(128)
>>> base64.b64encode(u'\xfc\xf1\xf4'.encode('utf-8'))
'w7zDscO0'
>>> base64.b64decode('w7zDscO0')
'\xc3\xbc\xc3\xb1\xc3\xb4'
>>> print base64.b64decode('w7zDscO0')
üñô
>>> a = 'الله'
>>> a
'\xd8\xa7\xd9\x84\xd9\x84\xd9\x87'
>>> base64.b64encode(a)
'2KfZhNmE2Yc='
>>> b = base64.b64encode(a)
>>> print base64.b64decode(b)
الله 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T13:04:24.090

您没有指定您正在使用哪种语言，但尝试将字符串转换为字节数组（但是这是用您选择的语言完成的），然后对该字节数组进行 base64 编码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-28T19:48:50.347

在 .NET 中，你可以试试这个（编码）：

```
byte[] encbuf;

encbuf = System.Text.Encoding.Unicode.GetBytes(input);
string encoded = Convert.ToBase64String(encbuf); 
```

...并解码：

```
byte[] decbuff;

decbuff = Convert.FromBase64String(this.ToString());
string decoded = System.Text.Encoding.Unicode.GetString(decbuff); 
```

# svn - TortoiseSVN 识别修改后的文件 - 那么为什么 svn diff 报告没有差异？

> ID：305152
> 
> 赞同：3
> 
> 时间：2008-11-20T12:34:35.787
> 
> 标签：svn, tortoisesvn, winmerge

我有一个使用 TortoiseSVN 签出的文件夹。如果我在现有版本文件上复​​制文件的较新版本，TortoiseSVN 会正确识别该文件已被修改。但是，当我执行“与以前版本的差异”时，它会报告“没有差异”。

如果我使用 WinMerge，我可以看到文件不同。

有谁知道为什么 TortoiseSVN 差异会失败？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T15:31:28.787

Diff with previous 是一个不同于查看工作副本中更改内容的命令。

上一个被定义为您在工作副本中拥有的版本之前的版本：

```
 A revision argument can be one of:
                    NUMBER       revision number
                    '{' DATE '}' revision at start of the date
                    'HEAD'       latest in repository
                    'BASE'       base rev of item's working copy
                    'COMMITTED'  last commit at or before BASE
                    'PREV'       revision just before COMMITTED 
```

如果您没有看到针对 PREVIOUS 的更改，则您的工作副本恢复了 COMMITTED 的更改

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T12:38:20.633

这可能是您的“忽略空白”设置。如果一个设置为 true，而另一个不是，则会发生此行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T13:25:53.780

文件名有任何变化吗？

我们有一个案例，有人将在工作目录之外编辑的较新版本复制到工作目录。TortiseSVN 标记文件已更改，但无法区分它。结果原来的工作副本被命名为“configfile.txt”，他重命名了他的“ConfigFile.txt”以使其更具可读性。当他将他的文件重新命名为“configfile.txt”并将其复制过来时，一切都恢复了。

# c# - 检查是否为 DateTime 变量分配了值

> ID：305154
> 
> 赞同：151
> 
> 时间：2008-11-20T12:36:12.710
> 
> 标签：c#, datetime

在 C# 中是否有一种简单的方法来检查 DateTime 实例是否已被赋值？

* * *

## 回答 #1

> 赞同：329
> 
> 时间：2008-11-20T12:40:42.327

你的意思是这样的：

```
DateTime datetime = new DateTime();

if (datetime == DateTime.MinValue)
{
    //unassigned
} 
```

或者你可以使用 Nullable

```
DateTime? datetime = null;

 if (!datetime.HasValue)
 {
     //unassigned
 } 
```

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2008-11-20T12:39:00.257

在 C# 中没有为变量赋值的唯一方法是让它成为一个局部变量——在这种情况下，在编译时你可以通过尝试读取它来判断它不是绝对赋值的： )

我怀疑你真的想要`Nullable<DateTime>`（或`DateTime?`使用 C# 语法糖） - 让它`null`开始，然后分配一个正常值`DateTime`（将被适当地转换）。然后你可以比较`null`（或使用`HasValue`属性）来查看是否设置了“真实”值。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2015-07-28T13:57:33.497

把这个放在某个地方：

```
public static class DateTimeUtil //or whatever name
{
    public static bool IsEmpty(this DateTime dateTime)
    {
        return dateTime == default(DateTime);
    }
} 
```

然后：

```
DateTime datetime = ...;

if (datetime.IsEmpty())
{
    //unassigned
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-07T18:24:06.033

我刚刚发现未分配日期时间的 GetHashCode() 始终为零。我不确定这是否是检查空日期时间的好方法，因为我找不到任何关于为什么显示此行为的文档。

```
if(dt.GetHashCode()==0)
{
    Console.WriteLine("DateTime is unassigned"); 
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-20T12:39:18.773

`Nullable<DateTime>`尽可能使用。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-20T12:39:51.033

DateTime 是值类型，所以它不能永远为空。如果你认为日期时间？( Nullable ) 你可以使用：

```
DateTime? something = GetDateTime();
bool isNull = (something == null);
bool isNull2 = !something.HasValue; 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-05-21T13:12:00.030

我会说默认值 always `new DateTime()`。所以我们可以写

```
DateTime datetime;

if (datetime == new DateTime())
{
    //unassigned
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-11-14T22:14:29.823

如果您不想担心 Null 值问题，例如每次使用时检查 null 或将其包装在某些逻辑中，并且您也不想担心偏移时间问题，那么这是我是如何解决这个问题的：

```
startDate = startDate <= DateTime.MinValue.AddSeconds(1) ? keepIt : resetIt 
```

我只是检查默认值是否在时间开始后不到一天。奇迹般有效。

编辑 2021：如果您需要检查时间开始的毫秒数，则只需添加刻度，但也可能碳测年是您真正想要的。如果您需要精确到刻度，仍然不确定碳测年是否会像您需要的一样准确。

2022年编辑：

[https://docs.microsoft.com/en-us/archive/msdn-magazine/2016/august/data-points-ef-core-change-tracking-behavior-unchanged-modified-and-added](https://docs.microsoft.com/en-us/archive/msdn-magazine/2016/august/data-points-ef-core-change-tracking-behavior-unchanged-modified-and-added)

```
IsKeySet: Added
The EntityEntry object, which holds the tracking information for each entity, has a new property called IsKeySet. IsKeySet is a great addition to the API. It checks to see if the key property in the entity has a value. This eliminates the guessing game (and related code) to see if an object already has a value in its key property (or properties if you have a composed key). IsKeySet checks to see if the value is the default value of the particular type you specified for the key property. So if it’s an int, is it 0? If it’s a Guid, is it equal to Guid.Empty (00000000-0000-0000-0000-000000000000)? If the value is not the default for the type, IsKeySet returns true.

If you know that in your system you can unequivocally differentiate a new object from a pre-existing object by the value of its key property, then IsKeySet is a really handy property for determining the state of entities. 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-20T16:53:24.657

在可能的情况下，我通常更喜欢使用值类型的默认值来确定它们是否已被设置。这显然不可能一直存在，尤其是对于整数 - 但对于 DateTimes，我认为保留 MinValue 以表示它没有被更改是足够公平的。与 nullables 相比，这样做的好处是少了一个地方会出现 null 引用异常（可能还有很多地方在访问之前不必检查 null ！）

# iphone - 向 Apple Store 提交 iPhone 应用程序并为其定价

> ID：305158
> 
> 赞同：5
> 
> 时间：2008-11-20T12:37:56.000
> 
> 标签：iphone, submission

我曾在 iPhone 应用程序上工作，但不知道将其提交到 Apple Store 的手续。请有人帮我解决以下问题：

他们是否需要支付任何提交费用？以及向 Apple Store 提交申请的程序。

谢谢和问候， Khushi

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T13:07:29.233

付费加入开发者计划后，实际提交申请无需支付额外费用。

当您使用您的开发者帐户登录后，应该可以通过 Rhys 提供的链接获得提交申请的说明。

我的建议是在提交之前**仔细阅读它们**，因为一旦你提交了你的 iPhone 应用程序，有些东西就无法更改 - 例如：你的应用程序的名称，以及它是否也可以在 iPod Touch 上运行等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T12:41:31.640

[iPhone 开发者计划](http://developer.apple.com/iphone/program/)拥有您需要的所有信息。目前售价 99 美元。

> iPhone 开发者标准计划让您可以访问 App Store，您可以在其中将免费或商业应用程序分发给数百万 iPhone 和 iPod touch 客户。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T06:41:19.907

你也可以试试这个---- [http://adeem.me/blog/2009/04/04/list-guideline-for-submitting-iphone-application-to-apple-store/](http://adeem.me/blog/2009/04/04/list-guideline-for-submitting-iphone-application-to-apple-store/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T21:44:36.863

如果你是一名注册开发者，Apple 提供了一段非常精彩且相当详尽的关于 App Store 提交过程的视频。我建议你看。事实上，我建议所有从事 iPhone 开发的人观看 iPhone Dev Center 上的所有视频。他们是无价的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T09:41:02.343

iPhone 开发者标准计划不是仅限于 100 台 iPhone 设备吗？尽管您在 App Store 上分发您的应用程序，但您不能将其分发到 100 多个设备上吗？如果我错了，请纠正我...

# .net - Process.Start() 在 .DOC 文件上抛出间歇性“没有关联的应用程序..”

> ID：305161
> 
> 赞同：2
> 
> 时间：2008-11-20T12:38:34.580
> 
> 标签：.net, ms-word, explorer, windows-shell

System.Diagnostics.Process.Start() 正在抛出间歇性 System.ComponentModel.Win32Exception：没有应用程序与此操作的指定文件关联。

该文件是一个 .doc 文件。他们总是能够手动打开它（双击）。

可能是什么问题呢？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-26T00:24:29.910

我怀疑您系统上的文件关联有些损坏。

打开 Windows 资源管理器，检查工具->文件夹选项->文件类型->DOC->高级->打开->编辑下定义的内容。

您应该具有以下值：

*   操作：&打开
*   应用程序（相应调整路径）：“C:\Program Files\Microsoft Office\Office12\WINWORD.EXE”/n /dde
*   必须检查使用 DDE
    *   DDE 消息：[REM _DDE_Direct][FileOpen("%1")]
    *   应用程序：WinWord
    *   DDE 应用程序（无价值）：
    *   主题：系统

*选择 DOC 时，文件类型*对话框上可能没有*高级*按钮，而是出现了一个*恢复*按钮。如果用户使用.doc 文件的上下文菜单中的“*打开方式...”选项手动更改了文件关联，就会出现这种情况。*尝试单击还原是否可以解决您的问题。

 ***# delphi - delphi 7如何将unicode字符转换为ascii码？

> ID：305162
> 
> 赞同：4
> 
> 时间：2008-11-20T12:38:40.210
> 
> 标签：delphi, unicode, ascii

是的，我们谈论的是 ASCII 码。我的道歉我不是这里的德尔福开发人员。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-21T01:04:10.487

对于 Delphi 7，我将获得由Virtual Treeview 的作者[Mike Lischke 提供的免费 Unicode 库。](http://www.soft-gems.net/index.php/libs/unicode-library)

该库包含许多往返于 Unicode 的转换函数，因此您可以使用在您的应用程序中最有意义的函数。

[或者您可以升级到](https://stackoverflow.com/questions/305016/what-are-major-incentives-to-upgrade-to-d2009-unicode-excluded#307419)具有内置编码例程和自己的转换函数库的 Delphi 2009。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T03:19:19.300

让我们把一些事情弄清楚。字符集（charset）和字符编码是两个相关但不同的概念。字符集是与某种整数字符代码相关联的字符的抽象列表。然后是字符编码，它基本上是一种描述字符如何以字节表示的算法。

[ASCII](http://en.wikipedia.org/wiki/ASCII)既充当字符集又充当编码。它使用 7 位来表示 128 个字符（94 个可打印）。另一方面，[Unicode是一个字符集，表示 1,114,112 个代码点。](http://en.wikipedia.org/wiki/Unicode)有几种编码可以表示 Unicode 字符串，但最值得注意的是 UTF-8、UTF-16、UTF-16LE 和 UTF-32。换句话说，单个 Unicode 字符可以根据编码以不同的方式表示。

> delphi 7如何将unicode字符转换为ascii码？

我认为这个问题可以用两种方式来解释。

1.  我有一些编码的 Unicode 字符串，它只包含 ASCII 可打印字符。如何将字符串转换为 ASCII 编码的字节数组？

2.  我有一些编码的 Unicode 字符串，其中还包括非 ASCII 可打印字符，例如中文字符。如何在不丢失信息的情况下将字符串编码为 ASCII 编码，然后将其解码回原始的 Unicode 字符串？

如果您的意思是第一个，您可以像 Osman 所说的那样将 Unicode 字符串加载到 WideString 中

```
var
  original: WideString;
  s: AnsiString;
begin
  s := AnsiString(original); 
```

如果你指的是第二种，你需要一个通用的编码算法，比如[Base64](http://en.wikipedia.org/wiki/Base64)编码。您可以使用David Barton 的 DCPcrypt v2 Beta 3 中包含[的](http://www.koders.com/delphi/fid42782E3C5F9863B82003C7F35105F7034BE8EC45.aspx)[DCPBase64.pas](http://www.cityinthesky.co.uk/cryptography.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T12:42:09.580

这取决于您对转换的定义是什么。如果要将 127 个最低字符映射到等效的 Unicode，可以使用显式转换。但是，如果字符串包含更高的字符，这会产生垃圾。

如果您想要 ë -> e 和 û -> u 之类的映射，您可以编写自己的代码。但请注意，始终存在无法转换的字符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T21:20:21.453

例如，字母 A 在 unicode 中表示为 U+0041，在 ansi 中表示为 41。因此转换它非常简单，但您必须了解 unicode 字符是如何编码的。最常见的是 UTF-16 和 UTF-8。UTF 16，基本上是每个字符两个字节，但即使这样也过于简单化了，因为一个字符可能有更多字节。UTF-8 听起来好像它意味着每个字符 1 个字节，但可以是 2 或 3。更复杂的是，UTF-16 可以是小端或大端。（U+0041 或 U+4100）。

您的问题没有意义的地方是，例如，如果您想在英语语言环境中将阿拉伯字母 ain U+0639 转换为 ansi。你不能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T21:45:48.687

“ASCII”是字符到数字的特定映射的名称，但有些人说“ASCII 码”根本不是 ASCII 的意思；他们只想要一个字符的数值，无论当时的映射是什么。该描述是否适用于您？

如果是这样，那么您可以使用`Ord`标准函数来获取您拥有的任何 Unicode 字符的 Unicode 代码点值。

```
var
  wc: WideChar;
  ws: WideString;
  x: Word;

x := Ord(wc);
x := Ord(ws[1]); 
```

但是，如果您真的指的是 ASCII，那么您必须更具体地说明您所考虑的转换类型。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-21T11:28:24.097

请参阅有关从 Unicode 转换为 ASCII 的相关问题：

*   [如何在 Java 中将 UTF-8 转换为 US-Ascii](https://stackoverflow.com/questions/285228/how-to-convert-utf-8-to-us-ascii-in-java)
*   [如何将 Unicode 字符转换为其 ASCII 等效字符](https://stackoverflow.com/questions/138449/how-to-convert-a-unicode-character-to-its-ascii-equivalent)
*   [如何使用 Python 将文件格式从 Unicode 转换为 ASCII？](https://stackoverflow.com/questions/175240/how-do-i-convert-a-files-format-from-unicode-to-ascii-using-python)

一般来说，数十万条目的字符集不能转换为 127 条目的字符集，而不会丢失一些信息或编码方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-22T20:31:49.553

您可以使用[http://swissdelphicenter.ch/en/showcode.php?id=1692](http://swissdelphicenter.ch/en/showcode.php?id=1692)
中的函数 它使用指定的代码页将 Unicode 字符串转换为 Ansi 字符串。
如果您想使用默认系统代码页（在区域选项中定义为非 unicode 代码页）进行转换，您可以简单地执行以下操作：

```
var
  ws: widestring;
  s: string;
begin
  s:=string(ws) 
```

# filesystems - 基于网络的轻量级开源共享文件系统

> ID：305176
> 
> 赞同：4
> 
> 时间：2008-11-20T12:43:05.943
> 
> 标签：filesystems, cluster-computing, high-availability

我们有两个具有负载平衡功能的 Web 服务器。我们需要在这些服务器之间共享一些文件。这些将是上传的文件、会话文件、php 应用程序创建的各种文件。

我们不想使用重量级的、不再维护的或商业的解决方案。我们正在寻找一些可以作为共享文件系统工作的轻量级开源软件。它应该很容易设置，必须是 HA 可用，必须非常快。它应该适用于 RedHat Linux。

我们查看了诸如带有同步文件共享的 drbd 之类的解决方案，但我们不能使用它们，因为它不能在像 ext3 这样的底层文件系统上工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-21T20:22:21.727

OCFS 现在可能已经达到了顶峰；至少值得一试。它在主线 linux 内核树中， http: [//oss.oracle.com/projects/ocfs2/](http://oss.oracle.com/projects/ocfs2/)有一些信息。我以前设置过，很容易上手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T12:52:43.520

DRBD 非常适合通过网络进行同步（如果可能的话，直接交叉连接），但 EXT3 的设计并不是为了在块设备级别了解其下方发生的更改。出于这个原因，您需要一个为此目的而设计的文件系统，例如全局文件系统 (GFS)。据我所知，Red Hat 支持 GFS。

DRBD 手册将概述如何将 GFS 与 DRBD 一起使用。

[http://www.drbd.org/users-guide/ch-gfs.html](http://www.drbd.org/users-guide/ch-gfs.html)

不要将此作为最终答案——我之前没有研究或使用过多主系统，但至少这可能会给你一些继续下去的机会。

理想情况下，您只会同步网络服务器之间共享的部分数据。

# javascript - javascript没有被调用

> ID：305177
> 
> 赞同：1
> 
> 时间：2008-11-20T12:43:53.927
> 
> 标签：javascript, html, ajax

我正在使用这个 HTML

```
<html>
    <head>
        <Title>EBAY Search</title>
    </head>
    <script language="JavaScript" src="ajaxlib.js"></script>
    <body>
        Click here <a href="#" OnClick="GetEmployee()">link</a> to show content
        <div id="Result"><The result will be fetched here></div>
    </body>
</html> 
```

有了这个 Javascript

```
var xmlHttp

function GetEmployee()

{

xmlHttp=GetXmlHttpObject()

if(xmlHttp==null)

{

alert("Your browser is not supported")

}

var url="get_employee.php"

url=url+"cmd=GetEmployee"

url=url+"&sid="+Math.random()

xmlHttp.open("GET",url,true)

xmlHttp.send(null)

}

function FetchComplete()

{

if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete")

{

document.getElementById("Result").innerHTML=xmlHttp.responseText

}

if(xmlHttp.readyState==1 || xmlHttp.readyState=="loading")

{

document.getElementById("Result").innerHTML="loading"

}

}

function GetXmlHttpObject()

{

var xmlHttp=null;

try

{

xmlHttp=new XMLHttpRequest();

}

catch (e)

{

try

{

xmlHttp =new ActiveXObject("Microsoft.XMLHTTP");

}

}

return xmlHttp;

} 
```

但是它没有被调用。当我自己调用 get_employee.php 时，它可以正常工作，所以这不是问题。我的代码中有什么错误会阻止它被调用吗？我无法使用任何 Firefox 扩展进行测试，我没有访问权限，所以请不要将其作为答案。

编辑：问题是根本没有调用javascript。我修复了问号问题，但即使只是一个带有警报的简单 javascript 也没有被调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T12:56:44.777

```
var url="get_employee.php?" 
```

需要“？”。

最好使用此标记来包含您的脚本：

```
<script type="text/javascript" src="ajaxlib.js"></script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T13:00:27.967

改变这个

```
var url="get_employee.php"

url=url+"cmd=GetEmployee"

url=url+"&sid="+Math.random() 
```

对此：

```
var url="get_employee.php?cmd=GetEmployee&sid="+Math.random(); 
```

你错过了“？” 并且不需要所有的连接（但我想这只是个人风格）。

此外，如果您的 html 中确实有“<结果将在此处获取>”，则应将其删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T13:23:58.200

使用像firebug这样的javascript调试工具，这会让你的生活更简单。

您的代码中有语法错误，导致错误“未定义 GetEmployee”

在“GetXmlHttpObject()”中最后一次尝试之后，这是一个丢失的“捕获”。添加缺少的“catch”后，这是相同的功能。

```
function GetXmlHttpObject()
{
    var xmlHttp=null;
    try
    {
        xmlHttp=new XMLHttpRequest();
    }catch (e)
    {

        try
        {
            xmlHttp =new ActiveXObject("Microsoft.XMLHTTP");
        } 
        catch (e) {}

    }
return xmlHttp;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T13:30:45.487

`<script>`对于将标签放入头部和身体之间的无人区，我有点困惑。这有什么特殊含义吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T12:56:19.643

var url="get_employee.php" ***+ "?"***

（回答评论）

*报什么*错误？您仍然必须将 FetchComplete 函数附加到 xmlHttp 的“onreadystatechange”属性，但不这样做应该不是错误。

确保确实加载了 ajaxlib.js，并且它就是您的意思的文件。放一些警报，看看它们是否弹出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-20T12:57:13.557

`getcommand.php`和部分之间不应该有问号或和号`cmd=`吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-20T12:59:03.103

我不认为它像url中的missinq问号那样愚蠢

```
var url="get_employee.php"
url=url+"cmd=GetEmployee"
url=url+"&sid="+Math.random() 
```

我本来希望看到 `"?cmd=GetEmployee"`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-20T13:00:06.953

您可以使用`alert(url)`来检查正在发送的确切网址。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-20T13:08:44.440

确保您没有放错位置或命名文件。您也可以将 OnClick 更改为全部小写。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-20T13:35:57.600

如果您不能使用适当的调试器，您可以在各处添加警报语句以查看是否发生了任何事情（是的，这是一个糟糕的解决方案，但只要您不使用一个好的工具，您就有一个糟糕的解决方案）。

此外，确保 OnClick() 返回 false，以防止浏览器重新加载页面。

`<a href="#" OnClick="GetEmployee()">link</a>`

变成

`<a href="#" OnClick="GetEmployee(); return false;">link</a>`

# php - 有没有办法查看准备好的查询，因为它将在数据库上执行？

> ID：305179
> 
> 赞同：5
> 
> 时间：2008-11-20T12:44:29.667
> 
> 标签：php, mysql, mysqli

> **可能重复：**
> [PDO 准备好的语句](https://stackoverflow.com/questions/210564/pdo-prepared-statements)

我在 PHP 中使用 mysqli 扩展，我想知道，是否有任何方法可以查看准备好的查询，因为它将在服务器上执行，例如查询是这样的

```
select * from table1 where id = ? and name = ? 
```

但我想在填写值后查看查询，如下所示：

```
select * from table1 where id = 20 and name = "John" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T14:30:56.350

打开[mysql 查询日志](http://dev.mysql.com/doc/refman/5.0/en/query-log.html)，它会将所有查询记录到一个文本文件中供您查看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T15:10:42.040

**[PDO 准备好的声明](https://stackoverflow.com/questions/210564/pdo-prepared-statements)的副本**

简短的回答：没有。准备好的查询永远不会转换为您期望的查询。它由数据库服务器直接执行。您可以使用 mysql 的查询日志或 PDO 的未记录函数`debugDumpParams`，但两者都只是近似值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T13:00:51.053

在哪里看？如果它是您的代码，您有查询并且您有准备好的参数，请单独记录它们或替换原始查询字符串。如果绑定失败，您将收到错误消息，否则您应该期望“填充”与您指定的值相同的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T15:16:45.117

大多数时候我调试mysql查询的方式是：

$q = "select * from table1 where id = ".$id." and name = ".$name; 回声 $q;

输出生成分配给查询的所有变量。

希望我完全理解你，你想要什么。

# c++ - 来自内存缓冲区的 CreateProcess

> ID：305203
> 
> 赞同：42
> 
> 时间：2008-11-20T12:51:54.067
> 
> 标签：c++, winapi, visual-c++

我可以使用 CreateProcess 来启动一个 EXE。我想在内存缓冲区中拥有 EXE 的内容并对其执行 CreateProcess（或等效项），而不必将其写入文件。有没有办法做到这一点？

背景故事：我们制作游戏。我们将一个普通的 EXE 发送给我们的分销商，然后他们使用他们最喜欢的 DRM 对其进行包装并将其出售给他们的用户。曾有用户发现崩溃的情况。大多数崩溃需要 5 分钟才能修复，但补丁必须通过分销商，并且可能需要几天甚至几周的时间。我不能只将修补的 EXE 发送给播放器，因为它没有发行商的 DRM。我正在考虑将真正的游戏 EXE 分发到加密的数据文件中，这样被包装的（外部 EXE）只是解密并启动真正的 EXE。这样我就可以在不禁用 DRM 的情况下安全地分发修复程序。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-11-20T13:39:27.467

这实际上很容易。我在 3 年前读过的一篇论文中描述了类似的技术。

Windows 允许您使用**CREATE_SUSPENDED标志调用**[CreateProcess](http://msdn.microsoft.com/en-us/library/ms682425.aspx)函数，该标志告诉 API 在[调用 ResumeThread](http://msdn.microsoft.com/en-us/library/ms685086(VS.85).aspx)函数之前保持进程挂起。

 **[这让我们有时间使用GetThreadContext](http://msdn.microsoft.com/en-us/library/ms679362(VS.85).aspx)函数来获取挂起线程的上下文，然后 EBX 寄存器将保存指向[PBE(Process Enviroment Block)](http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/NT%20Objects/Process/PEB.html)结构的指针，我们需要确定基地址。

从 PBE 结构的布局中我们可以看到 ImageBaseAddress 存储在第 8 个字节，因此 [EBX+8] 将为我们提供被挂起进程的实际基地址。

现在我们需要内存中的 EXE，如果内存和内存中的 EXE 的对齐方式不同，请进行适当的对齐。

如果挂起的进程和内存中的exe的基地址匹配，加上如果内存中的exe的imageSize小于或等于挂起的进程'我们可以简单地使用[WriteProcessMemory](http://msdn.microsoft.com/en-us/library/ms681674.aspx)将内存中的exe写入内存空间暂停的过程。

但如果不满足上述条件，我们需要更多的魔法。首先，我们需要使用[ZwUnmapViewOfSection 解](https://msdn.microsoft.com/en-us/library/ff567119.aspx)映射原始图像，然后使用[VirtualAllocEx](http://msdn.microsoft.com/en-us/library/aa366890.aspx)在挂起进程的内存空间内分配足够的内存。[现在我们需要使用WriteProcessMemory](http://msdn.microsoft.com/en-us/library/ms681674.aspx)函数将内存中的 exe 写入挂起进程的内存空间。

接下来，将内存中 exe 的 BaseAddress 修补到挂起进程的 PEB->ImageBaseAddress 中。

线程上下文的EAX寄存器保存EntryPoint地址，我们需要用内存中exe的EntryPoint地址重写。现在我们需要使用[SetThreadContext](http://msdn.microsoft.com/en-us/library/ms680632.aspx)函数保存更改后的线程上下文。

瞧！我们准备在挂起的进程上调用[ResumeThread](http://msdn.microsoft.com/en-us/library/ms685086(VS.85).aspx)函数来执行它！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-20T13:10:10.710

您可以将游戏编译为 DLL，并将 DLL 放入加密的数据文件中。可以从内存中加载 DLL 而无需将其写入磁盘。请参阅本教程（最后附有示例代码）：[Loading a DLL From Memory](http://www.joachim-bauch.de/tutorials/loading-a-dll-from-memory/ "从内存中加载 DLL")

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-20T13:07:06.643

你想做的事情需要 NtCreateProcess，但它没有记录，因此很脆弱。 [这本书](https://rads.stackoverflow.com/amzn/click/com/1578701996)显然涵盖了它的使用。

也许你可以建立一个补丁系统？例如，在启动时，程序会检查同一目录中的补丁 DLL，如果存在则加载它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-20T13:01:43.923

为什么需要创建新流程？我原以为您可以在进行解包/解密的进程的上下文中运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T13:05:22.963

你想要的东西可以用一个叫做“Packer”的东西来实现。实际上从内存中启动 exe 可能是可能的，但它比打包程序要困难得多；）

最著名的打包程序之一是 UPX（google it）。有一些工具可以解密它，但它至少应该给你一个开始工作的起点。我也相当肯定 UPX 是开源的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T17:07:25.540

看看[BoxedAppSDK](http://boxedapp.com/boxedappsdk/)

它支持从内存缓冲区启动 exe。

希望能帮助到你。

# wpf - WPF：我可以重新设置复选框模板的样式，以便检查指示符改为红十字

> ID：305220
> 
> 赞同：2
> 
> 时间：2008-11-20T13:00:18.887
> 
> 标签：wpf, templates, checkbox

我找不到重新设计复选框的 IsChecked 指示器的方法。正如我从复选框模板中看到的那样，没有可能重新设置指示器的样式，只有复选框的“框”。有谁知道是否可以重新设计 IsChecked 指标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-20T14:08:52.587

您将不得不替换整个 CheckBox 控件模板。

[从http://msdn.microsoft.com/en-us/library/ms752319.aspx](http://msdn.microsoft.com/en-us/library/ms752319.aspx)上的 ChekcBox ControlTemplate MSDN 示例开始

在示例中，您将看到此元素：

```
<Path 
Width="7" Height="7" 
x:Name="CheckMark"
SnapsToDevicePixels="False" 
Stroke="{StaticResource GlyphBrush}"
StrokeThickness="2"
Data="M 0 0 L 7 7 M 0 7 L 7 0" /> 
```

这是指示器，在此示例中，指示器已经是 X，因此将 Stroke 更改为 Red，您就完成了。

要更改指示器的形状，请更改 Path 的 Data 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T13:10:19.867

您可能会发现以下讨论很有帮助：

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/f8e3c903-5c82-46ec-a065-9a75d9f79b75/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/f8e3c903-5c82-46ec-a065-9a75d9f79b75/)

人们描述了提取或查看标准 WPF 控件模板的各种方法。

# java - setter 方法是否必须有一个参数？

> ID：305239
> 
> 赞同：5
> 
> 时间：2008-11-20T13:07:41.273
> 
> 标签：java, setter

setter 方法是否必须有一个参数？通常 setter 方法接受一个参数作为对象的某个属性的值。如果我想首先测试取决于另一个布尔参数的有效性怎么办，如果为真，首先验证，否则只需设置值。

我通过 ftp 服务器从客户端获取值。有时这些文件包含垃圾值。例如，#3432838#9 之类的电话号码。所以在我设置值之前，我需要删除那些垃圾字符。我可以在 setter 方法中做到这一点吗？这是一种有效的方法吗？

提前致谢！

**编辑：**

这是否有效：

```
public void setSomething(String strValue){ 
     if(checkValidity(strValue)){ 
         // set the value 
     } else { 
         // set the value to an empty string
     }  
  } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-20T13:12:02.373

在 java bean 框架模型中是特别需要的，但一般不是强制的。

当 setter 旨在“交换”一个值时，您可以使用不带参数的 setter。

```
void setCheck() 
```

例如，可能意味着将“检查”布尔属性设置为 true。

因此，即使它不是 java bean 术语意义上的“setter”，您也可以想象 setter 用于其他目的。

另外，根据 JavaBean 规范的第 7 节，setter 可以有**多个参数**，例如对于索引属性（索引属性支持一系列值。每当读取或写入属性时，您只需指定一个索引来标识哪个值你要。）

```
void setter(int index, PropertyType value); // indexed setter
void setter(PropertyType values[]); // array setter 
```

* * *

在您的情况下，一种有效的方法是将**[运行时异常](https://stackoverflow.com/questions/27578/when-to-choose-checked-and-unchecked-exceptions#73355)****添加**到我们函数的签名中。
这样，您就不会对已经调用您的 setter 的所有其他类进行任何不必要的编译时异常检查。

或者您可以将您的属性视为**约束属性**并添加非运行时异常。

支持 PropertyVetoException 需要受约束的属性设置器方法。对试图更新的受约束财产的用户来说，该文件可能会被否决。所以一个简单的约束属性可能看起来像：

```
PropertyType getFoo();
void setFoo(PropertyType value) throws PropertyVetoException; 
```

如果需要，它允许添加 VetoableChangeListener。

* * *

关于您的代码段，它是“有效的”，但可能不是最佳的，因为（如[本问题](https://stackoverflow.com/questions/2750/data-verifications-in-gettersetter-or-elsewhere#2754)所述）：

*   **验证应该与验证方法中的**getter 或 setter 分开捕获。**这样，如果需要跨多个组件重用验证，它是可用的。**
***   最好**快速失败**（因此我建议向 setter 添加异常）。**

 *** * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-20T13:11:41.703

通过 Java Bean 规范 setter 有一个参数。如果您添加另一个，无论出于何种原因，它不再被视为 setter。

Setter 完全可以“清理”其参数，如果无效则抛出异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T13:14:45.300

为什么不。验证和验证输入是包含在设置器中的一个很好的变体。这里的问题是，如果您想允许在没有验证的情况下设置成员。

对于您使用的某些框架（用作 bean），您可能需要标准形式的设置器。但如果你不受这种限制，你可以试试这个。

如果您认为其他代码应该进行验证但永远不应该设置错误的值，您也可以在 setter 中使用断言。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T16:18:19.253

在 Joshua Bloch (ISBN-13: 978-0-321-35668-0) 的“Effective Java 2nd Edition”一书中说，最好使用构建器模式而不是 bean 约定来创建对象。

例如（豆模式）：

```
NutritionFacts cocaCola = new NutritionFacts();
cocaCola.setServingSize(240);
cocaCola.setServings(8);
cocaCola.setCalories(100);
cocaCola.setSodium(35);
cocaCola.setCarbohydrate(27); 
```

与构建器模式一起使用：

```
NutritionFacts cocaCola = new NutritionFacts.Builder(240, 8).
   calories(100).
   sodium(35).
   carbohydrate(27).
   build(); 
```

建造者模式的实现：

```
// Builder Pattern
public class NutritionFacts {
    private final int servingSize;
    private final int servings;
    private final int calories;
    private final int fat;
    private final int sodium;
    private final int carbohydrate;
    public static class Builder {
        // Required parameters
        private final int servingSize;
        private final int servings;
        // Optional parameters - initialized to default values
        private int calories = 0;
        private int fat = 0;
        private int carbohydrate = 0;
        private int sodium = 0;
        public Builder(int servingSize, int servings) {
            this.servingSize = servingSize;
            this.servings = servings;
        }
        public Builder calories(int val)
        { calories = val; return this; }
        public Builder fat(int val)
        { fat = val; return this; }
        public Builder carbohydrate(int val)
        { carbohydrate = val; return this; }
        public Builder sodium(int val)
        { sodium = val; return this; }
        public NutritionFacts build() {
            return new NutritionFacts(this);
        }
    }
    private NutritionFacts(Builder builder) {
        servingSize = builder.servingSize;
        servings = builder.servings;
        calories = builder.calories;
        fat = builder.fat;
        sodium = builder.sodium;
        carbohydrate = builder.carbohydrate;
    }
} 
```

当需要前两个参数时。
对于验证，您可以使用早期验证（在每个`<field>`方法中）或延迟验证（在 build() 方法中）。格式是一种python键值初始化。

# c# - 堆栈跟踪中方法名称末尾的“+n”值是什么意思？

> ID：305244
> 
> 赞同：20
> 
> 时间：2008-11-20T13:10:39.350
> 
> 标签：c#, .net

读取堆栈跟踪时，例如：

```
[FormatException: Input string was not in a correct format.]
   System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal) +2755599
   System.Number.ParseInt32(String s, NumberStyles style, NumberFormatInfo info) +112
   System.Convert.ToInt32(String value) +68 
```

+68、+112 等数字是什么意思。我猜它们是某种东西的偏移量。如果是这样，是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-20T13:14:46.223

我相信它们是方法代码的偏移量 - 无论是 IL 还是 JIT 编译的汇编字节，我都不确定......

（基本上它们正在取代行号，如果没有 pdb，它们当然是不可用的。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-03-23T02:05:58.523

它的意思是：

> 它是该方法的本机指令的偏移量。

阅读[本文](http://odetocode.com/blogs/scott/archive/2005/01/24/funny-numbers-in-my-stack-trace.aspx)了解更多详情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T13:19:51.063

它是本机代码的字节偏移量。

有了 ILDASM，您就知道为什么了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-02T05:58:58.833

简单地说，堆栈跟踪是流中函数/方法的反向时间列表，直到当前代码。也就是说，直到断点被命中或发生异常。

在堆栈跟踪列表的顶部，是当前方法及其详细信息，例如类、程序集、文件名等。

以下几行，列出调用前一个方法（上一行中的一个）的方法。从列表往下看，这继续显示调用堆栈，一直到程序的开头。

Stack Trace 中的所有这些细节都是有益的，因为它列出了方法调用的起源和中间方法/函数，直到它到达当前代码行。这非常有帮助，因为如果有多种方法可以访问当前方法，Stack Track 会列出所遵循的确切流程。

# java - 哪个是最好的 Maven Eclipse 插件？

> ID：305250
> 
> 赞同：64
> 
> 时间：2008-11-20T13:12:17.257
> 
> 标签：java, eclipse, maven-2, eclipse-plugin

Maven 有两个可用的 Eclipse 插件：

*   [Eclipse IAM](http://www.eclipse.org/proposals/iam/)（旧名称是 Q4E）
*   [m2eclipse](http://m2eclipse.codehaus.org/)

m2eclipse 似乎是最古老但更强大的。两者之间有什么关键区别吗？

从今天开始的项目应该选择哪一个，为什么？

**更新：** m2eclipse 将移至 eclipse.org，并将包含在 Indigo 发布系列 (Eclipse 3.7) 中。在 Eclipse 上查看[m2e：这对您意味着什么？](http://www.sonatype.com/people/2010/12/m2e-at-eclipse-what-will-this-mean-for-you/)m2eclipse[正在迁移到 eclipse.org！](http://www.eclipse.org/m2e/). 因此，接受的答案更加正确。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-11-20T13:16:27.747

我选择**m2eclipse**是因为它很稳定并且拥有我需要的一切。特别是解决工作空间内的依赖关系的能力。

前段时间我试过另一个，但不喜欢它。这是越野车，所以我很快就放弃了。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-07-03T20:52:49.873

并排比较移至[http://web.archive.org/web/20150526230611/http://docs.codehaus.org/display/MAVENUSER/Eclipse+Integration](http://web.archive.org/web/20150526230611/http://docs.codehaus.org/display/MAVENUSER/Eclipse+Integration)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-07T18:59:11.420

对于我作为一个完整的 Maven 新手来说，**m2eclipse**插件工作得很好。我们用它管理大约 15 个项目。嵌套的 Maven 项目在 Eclipse 中将是平坦的（因为它不支持嵌套项目），但所有这些项目都是自动以正确的方式设置的，所以一切正常。到目前为止，我从来不需要手动调用 Maven 命令，因为我使用预配置的“运行方式”启动配置做得很好。

对我来说，m2eclipse 的质量可以通过这个简单的例子来判断：如果你在 JRE 而不是 JDK 上运行 Eclipse，m2eclipse 会显示一个警告，它的某些功能依赖于 JDK。尽管如此，它仍然适用于 JRE。警告对话框包含指向有关命令行参数的 Eclipse 文档和“已安装的 JRE”首选项的超链接，因此您可以轻松修复错误的 Java VM。

那就是说我不能代表或反对 IAM，因为由于 m2eclipse 的良好体验，我从未使用过它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T01:25:50.230

[Eclipse 的 Maven 插件的并排比较](http://docs.codehaus.org/display/MAVENUSER/Eclipse+Integration)。它尚未更新为最近添加的功能。例如，请参阅m2eclipse 的[New and Noteworthy](http://docs.codehaus.org/display/M2ECLIPSE/New+and+Noteworthy)页面。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-12-01T11:56:25.257

m2eclipse 还可以（比 1-2 年前可靠得多），但 m2eclipse 的附加功能（WTP 集成所需的 - WTP 使您能够在 IDE 中运行服务器）是另一回事 - 不受支持由 Codehaus 提供。每周有几次你会发现它没有将资源复制到应用服务器，或者你得到一个 NPE，或者其他一些问题。

我没有使用过 Eclipse IAM，但由于这些 WTP 问题，我在寻找 m2e 的替代品时发现了这个页面。我想，Intellij 正在打电话。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-05-19T06:46:56.583

m2eclipse 适用于小型项目。但它在大型企业项目中表现很差。即使是 POM 中最小的变化也会导致这个插件在几个小时内“更新依赖项”......

自从我们切换到 IAM 后，问题几乎消失了。即使它需要一段时间来应对 POM 的变化，与小时 (m2e) 相比，它仍然像分钟一样。

选择：

*   m2e - 如果您的项目很小并且您喜欢依赖树等花哨的功能
*   iam - 如果您需要性能

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-20T13:47:31.507

我使用了 m2eclipse。但是我从来没有设法从 Eclipse 中启动测试或整个项目（该项目有各种子模块的嵌套文件夹）。当我使用它时，他们说对此的支持是实验性的。我能得到的最多的是语法检查等。其余的我使用控制台。

完全不喜欢这种体验*。*

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-17T10:50:26.917

多模块项目呢？，m2eclipse插件无效。特别是如果我们使用 war 模块。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-04-14T16:01:23.817

我正在使用 m2eclipse ......那也是最好的和有据可查的......

# c - 加载路径和 Ruby C 扩展

> ID：305261
> 
> 赞同：2
> 
> 时间：2008-11-20T13:16:46.187
> 
> 标签：c, ruby, rubygems

您如何允许使用 C 扩展来`rb_f_require`要求来自目录外部的`ext`文件（例如要求`lib/foo/foo.rb`from `ext/foo.so`）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-26T22:48:15.330

不太确定为什么它没有像其他已翻译的 ruby​​ 黑客指南那样转换为 html，但也许其中的某些部分会有所帮助？

[http://rhg.rubyforge.org/svn/en/chapter18.txt](http://rhg.rubyforge.org/svn/en/chapter18.txt)

鉴于 rb_f_require 似乎进行了正常的加载路径搜索，如果它在搜索路径中，它似乎会搜索到 lib/foo 中。但是，如果您正在寻找另一个 foo.rb，我想如果 foo.so 首先出现，您会遇到名称问题。也许为 foo.rb 使用不同的名称可以解决问题？

# java - 不是的 Spring AOP 代理

> ID：305263
> 
> 赞同：3
> 
> 时间：2008-11-20T13:16:59.477
> 
> 标签：java, spring, aop

我设置了两个 Spring 代理：

```
 <bean id="simpleBean" class="org.springframework.aop.framework.ProxyFactoryBean">
    <property name="target">
        <ref local="simpleBeanTarget"/>
    </property>
    <property name="interceptorNames">
        <list>
            <value>cacheInterceptor</value>
        </list>
    </property>
</bean>   

 <bean id="springDao" class="org.springframework.aop.framework.ProxyFactoryBean">
        <property name="target" ref="springDaoTarget"/>
        <property name="interceptorNames">
            <list>
                <value>daoInterceptor</value>
            </list>
        </property>

    </bean> 
```

simpleBean 工作得很好—— springDao 没有。

SpringDao 类如下所示：

```
public class SpringDao extends JdbcDaoSupport {

private SimpleJdbcTemplate simpleJdbcTemplate;

public SimpleJdbcTemplate getSimpleJdbcTemplate() {

    if (simpleJdbcTemplate==null) {
        simpleJdbcTemplate= new SimpleJdbcTemplate(getDataSource());
    }
    return simpleJdbcTemplate;
}
    ... 
```

我的单元测试是这样自动装配的：

```
@Autowired
@Qualifier("springDao")
protected SpringDao springDao; 
```

出现问题的第一个迹象是我收到此错误：

> 无法自动装配字段: 。. . 嵌套异常是 java.lang.IllegalArgumentException

如果我注释掉 @Qualifier 注释并再次运行我的单元测试，我会得到：

> 没有唯一的 bean 类型...预期单个匹配 bean 但找到 2：[springDaoTarget, springDao]

这就是我所期望的。

所以我将自动装配更改为

```
@Autowired
@Qualifier("springDaoTarget")
protected SpringCustomerCapacityDao springDao; 
```

并将以下内容添加到我的单元测试中：

```
 Object proxy = applicationContext.getBean("springDao");

    Assert.assertNotNull(proxy);
    Assert.assertTrue(proxy instanceof SpringDao); 
```

并且 instanceof 测试失败，这（对我而言）意味着我的代理不是我的代理。

所以我很困惑。这是怎么回事？我怎样才能解决这个问题？

**编辑** 这里是请求的 springDaoTarget 定义，这会让很多人失望：

```
<bean id="springDaoTarget" class="com.company.SpringDao"> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-29T07:28:58.243

如果你的代理的目标实现了至少一个接口，那么 Spring 的默认行为是创建一个 JDK 代理来实现目标的所有接口。这意味着它不会是目标类的子类。您可以通过强制创建 CGLIB 代理来覆盖它，而这些代理是目标的动态子类。

作为一般规则，如果您要使用 AOP 但仅以有限的方式使用接口，您将需要强制 CGLIB。否则，您的容器中将有许多与您加载的 bean 实现不同类型的 JDK 代理。

请参阅 Cliff Meyers 博客：[Spring AOP：CGLIB 还是 JDK 动态代理？](http://cliffmeyers.com/blog/2006/12/29/spring-aop-cglib-or-jdk-dynamic-proxies.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T16:51:54.597

一旦我弄清楚了，这很容易解决。SpringDao 不再从 JdbcDaoSupport 继承，现在它可以工作了。

# php - 如何在 Utf-8 -> php 脚本 -> mysql 中进行 HTTP POST

> ID：305265
> 
> 赞同：1
> 
> 时间：2008-11-20T13:19:27.617
> 
> 标签：php, delphi, unicode

我正在使用 Delphi 7 和 ICS 组件与 php 脚本通信并在 mysql 数据库中插入一些数据...

如何使用 http post 发布 unicode 数据？

从 tnt 控件使用 utf8encode 后，我将其发布到 PHP 脚本

```
<?php
echo "Note = ". $_POST['note'];

if($_POST['action'] == 'i')
 {
    /*
     *  This code will add new notes to the database
     */
    $sql = "INSERT INTO app_notes VALUES ('', '" . mysql_real_escape_string($_POST['username']) . "', '" . mysql_real_escape_string($_POST['note']) . "', NOW(), '')";
    $result = mysql_query($sql, $link) or die('0 - Ins');
    echo '1 - ' . mysql_insert_id($link);
?> 
```

德尔福代码：

```
 data := Format('date=%s&username=%s&password=%s&hash=%s&note=%s&action=%s',
                   [UrlEncode(FormatDateTime('yyyymmddhh:nn',now)),
                    UrlEncode(edtUserName.Text),
                    UrlEncode(getMd51(edtPassword.Text)),
                    UrlEncode(getMd51(dataHash)),UrlEncode(Utf8Encode(memoNote.Text)),'i'
                    ]);

//  try  function StrHtmlEncode (const AStr: String): String; from IdStrings

    HttpCli1.SendStream := TMemoryStream.Create;
    HttpCli1.SendStream.Write(Data[1], Length(Data));
    HttpCli1.SendStream.Seek(0, 0);
    HttpCli1.RcvdStream := TMemoryStream.Create;
    HttpCli1.URL := Trim(ActionURLEdit.Text);
    HttpCli1.PostAsync; 
```

但是当我发布的 unicode 值与我在 Tnt 备忘录中看到的原始值完全不同时

有什么我想念的吗？！

还有人知道如何用 Indy 做到这一点吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T21:37:54.740

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T13:23:27.030

在 application/x-www-form-urlencoded 中编码 UTF-8 数据。这将确保服务器可以通过 http 连接读取数据

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T13:22:22.837

我希望（不确定）你必须将它们输出为 &#nnnnn 实体（数字是十进制而不是十六进制......我认为）

# svn - 检查颠覆更新

> ID：305275
> 
> 赞同：13
> 
> 时间：2008-11-20T13:23:00.543
> 
> 标签：svn

我正在组建一个构建系统，并想知道是否有可靠的方法来确定签出的 SVN 文件夹是否需要更新（即它是否与存储库不同步）。我想避免每晚构建，除非有什么改变。我可以编写一个脚本来解析`svn update`我猜想的命令的结果，但我想知道是否有一个命令可以告诉我是否真的需要更新？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-20T13:28:16.740

使用status 命令的[show updates 选项：](http://www.visualsvn.com/support/svnbook/ref/svn/#svn.ref.svn.sw.show_updates)

```
svn status -u 
```

或者

```
svn status --show-updates 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T09:32:11.740

[flolo](https://stackoverflow.com/a/305294/1184842)的答案对 subversion externals 不起作用（这也在[Don't show svn:externals in svn status 中](https://stackoverflow.com/questions/2789344/dont-show-svnexternals-in-svn-status)讨论）。如果您只需要当前文件夹需要更新的信息（不确切地说是哪些文件本身），这是一个更好的解决方案，[这个解决方案](http://beerpla.net/2008/07/23/how-to-check-if-the-local-svn-revision-is-up-to-date/)更好：

```
cd somedir;
svn info -r HEAD | grep -i "Last Changed Rev"
Last Changed Rev: 8544
svn info | grep -i "Last Changed Rev"
Last Changed Rev: 8531 
```

如果这些数字不相同，则需要更新。

# neural-network - 贝叶斯和神经网络有什么关系？

> ID：305279
> 
> 赞同：10
> 
> 时间：2008-11-20T13:24:13.877
> 
> 标签：neural-network, bayesian-networks

我正在寻找用 CUDA 实现的计算量大的任务，并想知道神经网络或贝叶斯网络是否适用。不过，这不是我的问题，而是两种网络类型之间的关系。它们似乎非常相关，特别是如果您查看具有学习能力的贝叶斯网络（维基百科上的文章提到）。乍一看，贝叶斯网络有点像一种特定类型的神经网络。任何人都可以总结他们的关系，以及是否有任何超越明显相似之处的联系？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-26T03:22:23.810

贝叶斯网络表示变量之间的独立（和依赖）关系。因此，链接代表概率意义上的条件关系。一般来说，神经网络没有这种直接的解释，事实上大多数神经网络的中间节点都是被发现的特征，而不是有任何与它们本身相关的谓词。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T13:58:35.510

据悉[，](http://research.microsoft.com/research/pubs/view.aspx?msr_tr_id=MSR-TR-95-06)贝叶斯网络更能抵抗某些神经网络中出现的“过度训练”。换句话说，一些神经网络对训练中使用的观察测量变得如此“训练”，以至于它们对一般情况没有用处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T13:53:33.197

他们确实是。我将贝叶斯网络视为大规模应用贝叶斯定理的神经网络，但我不记得细节了。我知道你在哪里可以找到它们，为此我推荐[这](https://rads.stackoverflow.com/amzn/click/com/0471056693)本书。

# c# - 获取 sqlcmd 输出到 GridView

> ID：305284
> 
> 赞同：0
> 
> 时间：2008-11-20T13:24:49.027
> 
> 标签：c#, asp.net, xml, parsing, sqlcmd

我正在设计一个 ASP.NET 网站，它将运行 sqlcmd，获取一些输出并将其放入屏幕上的网格中。

我想知道是否有一种方法可以将来自 sqlcmd 的查询结果读取为某种我可以使用的格式、XML、DataSet 等。

sqlcmd 中是否有一个友好的开关可以以很好的格式输出它，还是我必须自己解析它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T07:57:28.433

您可以使用 SqlCommand.ExecuteXmlReader() 函数。它将返回 XmlReader 类型的对象。 [您可能在这里](http://www.java2s.com/Tutorial/CSharp/0560__ADO.Net/SqlCommandExecuteXmlReader.htm)得到的关于 ExecuteXmlReader()
的帮助很少。

# java - Servlet 容器和类路径

> ID：305285
> 
> 赞同：12
> 
> 时间：2008-11-20T13:25:02.973
> 
> 标签：java, servlets, jakarta-ee

Servlet 容器集的类路径是什么？

据我了解，涉及三个组件。`lib`Servlet 容器目录中的JAR 文件，然后是目录中的类`WEB-INF/classes`和 JAR 文件`WEB-INF/lib`。Servlet 容器目录中的类`lib`被添加到系统类路径中，动态类路径包括目录中的 JAR 文件和`lib`目录中的类`classes`。

动态类路径集是什么？动态类路径是否指向`WEB-INF`或包含所有单独的类和 JAR 文件下的所有目录`WEB-INF/lib`和`WEB-INF/classes`或仅指向两个目录`WEB-INF/classes`和`WEB-INF/lib`？假设我有一个名为`foo`in的目录，`WEB-INF`其中包含`bar.properties`. 现在`bar.properties`也是在类路径中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-20T16:24:53.060

“动态”类路径将列出`WEB-INF/classes`每个 JAR 文件`WEB-INF/lib`作为单独的条目。*不*包括下`WEB-INF`的其他文件夹。

 *在您的示例中，`bar.properties`不会在类路径中。将其移至`WEB-INF/classes`. 或将其放入`WEB-INF/lib`.

其余类路径中的内容取决于您的 servlet 容器。它是特定于实现的，但大多数容器还有另外两个放置类的地方。一个是容器可见但应用程序不可见的目录，另一个是容器和所有应用程序可见的目录。由于第二个类加载器对所有应用程序都是可见的，因此这些类的静态成员可用于在应用程序之间共享信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T13:31:49.480

在您的示例中， bar.properties 需要位于类目录下才能位于类路径中。

# windows - 如何查看 Windows 库 (*.lib) 的内容

> ID：305287
> 
> 赞同：215
> 
> 时间：2008-11-20T13:25:10.100
> 
> 标签：windows, static-libraries, libraries

我有一个二进制文件 - Windows 静态库 (*.lib)。
有没有一种简单的方法可以从该库中找出函数的名称及其接口？

类似于`emfar`和`elfdump`实用程序的东西（在 Linux 系统上）？

* * *

## 回答 #1

> 赞同：224
> 
> 时间：2008-11-20T14:31:02.167

假设您在谈论静态库，`DUMPBIN /SYMBOLS`则显示库中的函数和数据对象。如果您正在谈论导入库（`.lib`用于引用从 DLL 导出的符号），那么您需要`DUMPBIN /EXPORTS`.

请注意，对于与“C”二进制接口链接的函数，这仍然不会让您返回值、参数或调用约定。该信息根本没有编码`.lib`。您必须提前知道（例如通过头文件中的原型）才能正确调用它们。

对于与 C++ 二进制接口链接的函数，调用约定和参数被编码在函数的导出名称中（也称为“名称修改”）。 `DUMPBIN /SYMBOLS`将向您显示“损坏的”函数名称以及解码的参数集。

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2014-11-01T13:16:41.323

打开 Visual Studio 命令提示符

```
dumpbin /ARCHIVEMEMBERS openssl.x86.lib 
```

或者

```
lib /LIST openssl.x86.lib 
```

或者**只是用 7-zip 打开它**:) 它是一个 AR 存档

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2011-01-20T20:35:36.483

我想要一个像`ar t libfile.a`unix一样的工具。
Windows 等价物是`lib.exe /list libfile.lib`.

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2017-02-10T20:12:34.393

“dumpbin -exports”适用于 dll，但有时可能不适用于 lib。对于 lib，我们可以使用“dumpbin -linkermember”或仅使用“dumpbin -linkermember:1”。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-11-20T14:16:50.900

LIB.EXE 是 VS 的图书管理员

[http://msdn.microsoft.com/en-us/library/7ykb2k5f(VS.80).aspx](http://msdn.microsoft.com/en-us/library/7ykb2k5f(VS.80).aspx)

（如 Unix 上的 libtool）

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-11-20T13:46:02.943

[DUMPBIN](https://docs.microsoft.com/en-us/cpp/build/reference/dumpbin-reference?view=vs-2019) /EXPORTS 将获得大部分信息，点击 MSDN 将获得其余信息。

获取 Visual Studio 软件包之一；C++

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-02-11T13:54:54.467

1）打开VS 2017（或您机器上的任何版本）的开发人员命令提示符（它应该位于：开始菜单->所有程序-> Visual Studio 2017（或您机器上的任何版本） --> Visual Studio 工具 --> VS 2017 的开发人员命令提示符。

2) 输入以下命令：

`dumpbin /EXPORTS my_lib_name.lib`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-01-31T12:47:38.103

就像在其他答案中可以看到的那样，您必须打开您的 Visual Studio 版本中提供的开发人员命令提示符才能`dumpbin.exe`在您的执行路径中使用。否则，您可以手动设置必要的环境变量。

`dumpbin /EXPORTS yourlibrary.lib`通常只会显示一小部分符号。在许多情况下，它不会显示库导出的函数。

`dumpbin /SYMBOLS /EXPORTS yourlibrary.lib`将显示这些符号，但也会显示大量其他符号。因此，您必须过滤它们，可能使用管道`findstr`（如果您想要 MS-Windows 工具）或`grep`.

使用这些工具之一搜索`Static`关键字似乎是一个很好的提示。

# .net - 在设置和部署中嵌入 SMO dll

> ID：305291
> 
> 赞同：2
> 
> 时间：2008-11-20T13:26:50.113
> 
> 标签：.net, deployment, installation

我有一个 .NET 设置和部署项目，它必须在安装过程中执行一组非常长的 SQL 脚本。我使用 SMO dll 来调用 .sql 脚本文件。这些 SMO dll 不是 .NET 框架的一部分，但它们与 SQL Server 2005 或 2008 捆绑在一起。现在，如果安装程序在一台机器上运行未安装 SQL Server 2005/2008 SQL 脚本执行失败。这对于我的设置来说是一个完全有效的用例，因为用户可能在他的本地计算机上没有 SQL 服务器，但在网络服务器上。我如何将 SMO dll 与 setup .msi 一起嵌入，以便它不必依赖正在运行的机器上的任何 SMO dll？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T14:06:41.793

对不起，我第一眼没看懂这个问题。我会做以下事情：

1.  创建自定义安装程序项目（类库）
2.  添加对 SMO DLL 的引用（我认为您必须设置 Copy Local = True）
3.  使用您的 sql 部署逻辑向其添加安装程序类
4.  将此项目的输出添加到您的设置项目
5.  设置必要的自定义操作

[本文](http://www.codeguru.com/Csharp/.NET/net_security/encryption/article.php/c9601/)解释了一个类似的过程（减去 SMO 调用），它基于[这篇 msdn 文章](http://msdn.microsoft.com/en-us/library/49b92ztk.aspx)。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T14:15:10.123

一种简单的方法是将这些文件添加到部署项目中。

如果您在解决方案资源管理器中右键单击项目，然后选择查看 > 文件系统，您可以将这些文件添加到目标计算机的应用程序文件夹下。

如果您需要注册 dll，我认为您可以添加自定义操作来执行此操作，但我不确定。

希望有帮助！

# c - C中的常量数组类型，标准中的缺陷？

> ID：305293
> 
> 赞同：15
> 
> 时间：2008-11-20T13:28:10.423
> 
> 标签：c, standards

C99 规范的第 6.7.3.8 段指出

> 如果数组类型的规范包括任何类型限定符，则元素类型是限定的，而不是数组类型。如果函数类型的规范包含任何类型限定符，则行为未定义。

在[基本原理](http://www.open-std.org/jtc1/sc22/wg14/www/C99RationaleV5.10.pdf)（逻辑页 87，物理页 94）中，给出了将平面指针转换为（可变长度）数组指针的示例。

```
void g(double *ap, int n)
{
    double (*a)[n] = (double (*)[n]) ap;
    /* ... */ a[1][2] /* ... */
} 
```

当然，如果数组`ap`没有在函数内修改，它应该被标记为 const，但是在

```
void g(const double *ap, int n)
{
    const double (*a)[n] = (const double (*)[n]) ap;
    /* ... */
} 
```

不保留`const`限定符，因为（根据 6.7.3.8）它适用于目标的元素，而不是目标本身，它具有数组类型`double[n]`。这意味着如果给定适当的标志（`-Wcast-qual`对于 GCC），编译器会正确地抱怨。没有办法`const`在 C 中表示数组类型，但这种转换非常有用且“正确”。该`-Wcast-qual`标志可用于识别数组参数的滥用，但误报会阻止其使用。请注意，索引`a[i][j]`既更具可读性，而且与许多编译器相比，生成的机器代码比前者更好，`ap[i*n+j]`因为前者允许将一些整数算术从内部循环中提升出来，而分析更少。

编译器是否应该将其视为一种特殊情况，有效地将限定符从元素提升到数组类型，以确定给定的强制转换是否删除了限定符，或者是否应该修改规范？没有为数组类型定义赋值，因此与 6.7.3.8 相比，限定符总是应用于数组类型而不仅仅是元素会不会有伤害？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-20T14:45:56.880

这是一个已知问题，在过去 10 年中，comp.std.c 已多次讨论过该问题。最重要的是，您提出的具体案例目前在标准 C 中是不合法的；您需要删除限定符或避免使用指向数组的指针来引用数组中的限定元素。

如果您认为自己有解决问题的好主意，可以将其发布到`news:comp.std.c`讨论。如果其他人同意这是一个好主意，您或其他人可以提交缺陷报告以改变行为（有几个委员会成员经常使用 comp.std.c，因此可能会审查 DR 的人的反馈会在提交之前很有用）。我认为您提出的让限定符影响数组本身的提议可能存在一些问题，但我必须多考虑一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T13:46:49.277

C 程序员（但不是编译器设计者）可能的解决方法：

gcc with`-Wcast-qual`不会对此抱怨：

```
void g(const double *ap, int n)
{
    int i;
    struct box 
    {
      double a[n];
    };
    const struct box *s = (const struct box *)ap;

    for (i=0; i<n; ++i)
    {
       doStuffWith(s->a[i]);
       /* ... */
    }
} 
```

即使它不是很优雅。尾随数组成员`a`在 C89 和 C99 之间的含义也略有不同，但至少你得到了预期的效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T13:44:13.510

指针（即数组）的情况很尴尬，但这是我对细节的回忆：

`const double *ap`是一个指向双精度常量的指针；

`double *const ap`是一个指向双精度的常量指针；

`const double *const ap`是一个指向常量双精度的常量指针；

因此，我相信可以按照您的要求进行操作，尽管我已经很多年没有尝试过了——`gcc`您使用的选项在我上次执行此操作时不可用！

编辑：这个答案对于这个问题是不正确的——我把它留下来保留下面的评论，这为普通人（或生锈的 C 开发人员......）澄清了这个问题

# mysql - 访问不同数据库类型的单一数据库工具？

> ID：305304
> 
> 赞同：4
> 
> 时间：2008-11-20T13:32:22.940
> 
> 标签：mysql, database, postgresql, derby

我想要一个可视化数据库工具，它允许我从同一个程序访问多种数据库类型。我正在寻找任何支持 Mysql、PostgreSQL 和 Derby 的东西。它支持的任何其他内容都是奖励。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T14:07:49.033

如果您可以获得数据库的 ODBC 驱动程序（应该可以从 DB 供应商处获得），您可以使用 MS Access。如果你想要免费的东西，我推荐[SQuirrel SQL Client](http://www.squirrelsql.org/)。它是用 Java 实现的，因此您需要为您使用的每个数据库提供 JDBC 驱动程序（通常也可以免费获得）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T13:35:30.813

也许[DbVisualizer](http://www.minq.se/products/dbvis/)？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T13:49:59.660

我想您可能对[Sparx Enterprise Architect](http://www.sparxsystems.com.au/products/index.html#EA)感兴趣。它可以帮助进行逆向工程和创建精美的图表。它适用于您可以获得驱动程序的所有内容，但您的数据库是本机支持的。

企业架构师的愿景也可以做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T21:27:10.100

我知道支持 Derby 的人很少，但他们支持 MySQL、PostgreSQL、Firebird 等...

检查这个：

*   [SQL 大师](http://www.sqlmaestro.com/)
*   [SQL 管理器](http://www.sqlmanager.net/)
*   [数据库工作台](http://www.upscene.com)（不适用于 PostgreSQL）
*   [Navicat](http://www.navicat.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T21:59:34.657

查看[AquaFold](http://www.aquafold.com/)的 Datastudio。它是用 Java 编写的，因此它可以访问任何具有 JDBC 驱动程序的数据库，并且它们向开源开发人员提供免费许可证。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-31T15:38:21.440

来自 Sybase 的“SQL Anywhere”。

# sql - Informix SQL 查询：返回不同结果的两个相似查询

> ID：305306
> 
> 赞同：1
> 
> 时间：2008-11-20T13:33:10.367
> 
> 标签：sql, database, informix

我有一个返回一组行的 Informix SQL 查询。它针对我们一直在开发的新版本网站进行了轻微修改，我们的 QA 注意到新版本返回不同的结果。经过调查，我们发现两个查询之间的唯一区别在于返回的字段数量。

FROM、WHERE 和 ORDER BY 子句是相同的，SELECT 部分中的列名不影响结果。只是导致问题的字段数量。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T13:35:25.400

添加`--+ ORDERED`join-order 指令通过允许您每次都以可预测的顺序获得结果来解决问题。

链接指向指令如何工作的描述 [http://publib.boulder.ibm.com/infocenter/idshelp/v10/index.jsp?topic=/com.ibm.sqls.doc/sqls1144.htm](http://publib.boulder.ibm.com/infocenter/idshelp/v10/index.jsp?topic=/com.ibm.sqls.doc/sqls1144.htm)

> 使用 ORDERED 连接顺序指令强制优化器按照它们在查询的 FROM 子句中出现的顺序连接表或视图。

```
SELECT --+ ORDERED
   name, title, salary, dname
FROM dept, job, emp WHERE title = 'clerk' AND loc = 'Palo Alto' 
   AND emp.dno = dept.dno 
   AND emp.job= job.job; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T13:46:25.877

Informix SQL 引擎根据我们要检索的列使用表上的索引。在检索不同的列时，我们使用不同的索引，因此以不同的顺序获得结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-21T23:33:32.120

我认为“字段”是指输出数据的行数？根据我的经验，人们使用“字段”和“列”作为同义词。鉴于选择列表中的名称没有更改，您可能只是在返回的行数上有所不同。

给定相同的表、输入数据和查询，无论查询计划或服务器版本如何，结果集的大小和内容都应该相同。结果集的顺序可能不同，除非您对结果施加顺序，但这在任何 DBMS 中都是合法的。

如果您获得不同大小的结果集，您可能应该联系 IBM 技术支持。至少有一个结果集是错误的，错误的结果总是很严重的。

尽管提示可能有助于提高性能，并且“运行 UPDATE STATISTICS（使用适当的选项集）”的标准建议通常会有所帮助，但是当基础数据稳定时，无论是否存在索引都不应改变结果集。（如果数据正在发生变化，则需要担心各种问题和并发症。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T02:29:31.373

我只能想到两种解释：

1.  正在使用聚合函数，例如 COUNT(DISTINCT column)，或
2.  选择的其他列来自外部联接的表

我了解您不希望发布 SQL 和表定义，但这确实使诊断变得困难。

# wxwidgets - wxWidget 多行笔记本 - 看不到第二行

> ID：305307
> 
> 赞同：1
> 
> 时间：2008-11-20T13:34:36.727
> 
> 标签：wxwidgets

此代码完美运行

```
myNotebook = new wxNotebook( this, IDC_NOTEBOOK, wxDefaultPosition, wxSize(500, 500) );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 1" );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 2" );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 3" );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 4" );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 5" );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 6" ); 
```

但是，选项卡名称又长又多，必须水平滚动。

使用 wxNB_MULTILINE 样式无法正常工作：第二行选项卡被遮挡且不可读

```
myNotebook = new wxNotebook( this, IDC_NOTEBOOK, wxDefaultPosition, wxSize(500, 500), wxNB_MULTILINE );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 1" );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 2" );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 3" );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 4" );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 5" );
myNotebook->AddPage( new wxNotebookPage( myNotebook, -1 ), L"TEST RECOMMENDATIONS 6" ); 
```

如何正确使用多线样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T16:57:33.870

经过实验，我发现是这样的：

在所有 AddPage() 调用之后添加一行

```
 myNotebook->Layout(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-21T19:53:47.433

问题似乎是保存笔记本页面的面板覆盖了第二行选项卡。

我可以通过处理`EVT_NOTEBOOK_PAGE_CHANGED`事件并添加这行代码来强制面板移开

```
myNotebook->GetPage( event.GetSelection() )->Move(0,40); 
```

丑陋，但它的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-04T13:54:32.703

最后，找到了一个优雅的解决方案。调整大小后我需要强制刷新。

```
void MyFrame::OnSize(wxSizeEvent& )
{
    if( myNotebook ) {
        myNotebook->SetSize( GetClientRect() );
        myNotebook->Refresh();
    }
} 
```

# windows - 我的 Windows 批处理 (.bat) 文件有什么问题？

> ID：305313
> 
> 赞同：0
> 
> 时间：2008-11-20T13:36:14.727
> 
> 标签：windows, batch-file

我创建了一个简单的批处理文件 (.bat)，其中包含一堆要在命令窗口中自动触发的命令。批处理如下所示：

```
mmd dll1.dll -mf -aW
mmd dll2.dll -mf -aW
mmd dll3.dll -mf -aW 
```

如果我将一堆 cmd 复制并粘贴到命令窗口中，它们都会正确执行。但是，如果我尝试直接将批处理文件拖到命令窗口中并执行它，则第一个命令会启动并最终无法成功执行。为什么？

我运行命令的命令窗口需要设置很多环境变量才能成功运行命令。当我拖动批处理文件（使用绝对路径）时，看起来我从未设置过这些变量。批处理文件中的命令是否与宿主命令窗口在相同的上下文中运行？那我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T13:40:31.943

它正在使用相对于 .bat 文件的路径执行拖入的文件（而不是那些 dll 的实际位置）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T13:46:59.793

您的命令中可能包含影响批处理文件的特殊字符，例如 %. 您需要转义/删除这些。

否则，这可能与您正在运行的程序弄乱终端或非常依赖其环境有关。你有这方面的信息吗？尝试只运行批处理文件中的第一行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T13:47:27.513

您是否尝试在“.bat”中的命令之前添加“呼叫”？

通过在您的 cmd 行之前添加“调用”，您可以保证父进程在子进程结束时继续工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T13:40:24.033

您是否在要调用的文件名周围加上引号？文件名是否在不同的行上？（如果没有，他们应该是）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T13:41:50.427

您的 PATH 设置是否正确？执行批处理时是否在正确的目录中？您是否检查过批处理文件中的不可见、无效字符？

# actionscript-3 - 从 AS2 到 AS3 的 _root 等价物是什么？

> ID：305320
> 
> 赞同：2
> 
> 时间：2008-11-20T13:39:30.710
> 
> 标签：actionscript-3, migration, actionscript-2

我正在尝试使用 AS2 学习 Actionscript 2 或 3，我最终通过反复试验发现我可以获取任何命名实例并使用其名称使用的字符串对其进行修改

```
var theinstance = "titletext"; // actually exctracted from an array
_root[theinstance].htmlText = "New text with <b>HTML!</b>"; 
```

但是当试图将代码转换为 AS3 时`_root`不再存在。根据[迁移文档](http://livedocs.adobe.com/flex/3/langref/migration.html)，它以某种方式被替换，`flash.display.DisplayObject.stage`但显然这不是如何做到的：

```
flash.display.DisplayObject.stage[theinstance].htmlText = "New text with <b>HTML!</b>"; 
```

这也不是：

```
flash.display.DisplayObject.stage.getChildByName(theinstance).htmlText = "New text with <b>HTML!</b>"; 
```

如何*在*actionscript 3 中按名字获取孩子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T14:28:36.993

只需使用“root”（无下划线）或“stage”，具体取决于您想要做什么。

但是 - 为什么不只在数组中存储对 textField 的引用而不是字符串？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T13:47:57.857

“flash.display.DisplayObject”实际上并不是您调用的实际代码的一部分。相反，文档告诉您 stage 属性可用于*DisplayObject 类的任何实例*——例如，movieClip 或 sprite。

例如，如果您有一个名为 foo 的电影剪辑，您可以使用以下命令引用舞台：

```
foo.stage 
```

然后从那里去。

```
foo.stage.someRootLevelObject.htmlText = "Pretty <b>easy</b>"; 
```

# data-structures - 您将使用多路搜索树构建什么。

> ID：305324
> 
> 赞同：2
> 
> 时间：2008-11-20T13:40:22.050
> 
> 标签：data-structures, multiway-tree

我目前正在自学各种数据结构，并且对各种类型的树有点沮丧。我可以理解将某些东西组织成二叉搜索树的目的，但看不到多路搜索树的任何实际应用。有人可以举一些他们使用多路搜索树实现的问题的例子吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T16:38:40.413

多路树用于在磁盘上实现数据结构，例如关系数据库表。

与连续读取相比，磁盘上的查找操作非常慢。因此，为了提高效率，将寻道次数降至最低的结构是最好的。对于相同元素，多路树的深度远小于二叉树，这意味着只需很少的磁盘寻道即可定位节点。

# html - 在一个层中浮动图像，在另一个层内

> ID：305328
> 
> 赞同：1
> 
> 时间：2008-11-20T13:41:42.050
> 
> 标签：html

我有以下 HTML 将图层中的图像和链接居中：

编辑：一个更好的例子

```
<style> body  { 
background-color:#000; 

color: #FFF; 

}  a  { font-family: "Broadway",
Broadway,monospace;  font-size:
14px; color:

#FFF; }

#images a {

 width: 24.99%;  display: block; 
float: left;  text-align: center;  }

#container; { top: 30%; left: 15%; }
#main { position: absolute; width: 800px; height: 600px; }
#logo { float:left; background-image:url("1.jpeg"); 
width: 104; height: 100; }

 </style> <div id="main">  <div
id="logo"> </div> <div
id="container">  <div id="images">
<a href="1.html" >
    <img src="1.gif" alt="x" width="181" height="173" border="0"
/><br />
    One </a> <a href="2.html" >
    <img src="2.gif" alt="x" width="181" height="173" border="0"
/><br />
    Two </a> <a href="3.html" >
    <img src="3.gif" alt="x" width="181" height="173" border="0"
/><br />
    Three </a> <a href="4.html" >
    <img src="4.gif" alt="x" width="181" height="173" border="0"
/><br />
    Four </a> </div></div></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-20T15:35:22.380

1.  主 div 的宽度为 800px，所以浮动 logo div (104px) + 4 张图片（每张 25%）对于一行来说太大了，所以最终图片会换行到下一行。取消浮动徽标 div 将在最左侧的新行上开始图像。

2.  默认情况下，位置是静态的 - 所以 left 和 top 无效。

3.  在容器 div 上设置`position:relative;`- 不过要小心使用 IE6，因为如果我没记错的话， position:relative 有点有趣。

# oop - 说明类层次结构的图表叫什么？

> ID：305330
> 
> 赞同：4
> 
> 时间：2008-11-20T13:42:33.467
> 
> 标签：oop, uml

所以我有一个 UML 类型图表，它记录了开发的类和层次结构。只是不知道你会怎么称呼它？

有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-20T13:43:21.517

[类图](http://www.developer.com/design/article.php/2206791)是一个不错的开始；-)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T13:54:19.403

静态结构是整个图表套件的另一个名称。

# java - 当 URL 具有重定向时，如何使用 iText 检索图像？

> ID：305337
> 
> 赞同：4
> 
> 时间：2008-11-20T13:45:58.623
> 
> 标签：java, pdf-generation, itext

我正在使用 iText 为 J2EE Web 应用程序生成 PDF 发票，页面上包含从请求 URL 构造的 URL 读取的图像。在开发和测试环境中这工作正常，但在生产中我得到一个 java.io.IOException: is not a Recognized imageformat。

如果我将 url 粘贴到浏览器中，则会返回正确的图像，但是请求会从 http 重定向到 https。在我的代码中，如果我对重定向 URL 进行硬编码，则图像会正确显示。

因此，似乎在使用 com.lowagie.text.Image.getInstance(URL) 检索图像时，没有遵循 URL 上的重定向。如何使用 iText 从重定向的 URL 输出图像？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-28T00:02:36.990

好，

如果您从 URL 请求图像，它必须实际指向该图像。如果 URL 指向的网页然后重定向到另一个 URL（或 URL 的返回码是重定向），那么它将失败。

这本质上是由于 getInstance() 方法了解如何使用 HTTP 位置协议获取文件，但对 HTTP 协议的了解不足以成为 HTTP 客户端。

您可以只使用“https”地址，或者您可以将图像存储在您的程序中并按照 CFreiner 的建议定位。如果这些选项都不可行，那么您唯一真正的解决方案是实现代码来查询 URL，检查它是否是重定向以及是否遵循重定向。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-21T03:36:54.517

您是否有理由必须使用 URL 来获取它？您是否必须匹配 url 指向的图像？如果它改变或被删除怎么办？

我不确定您的要求，但从 url 保存图像并将其放置在项目中的某个位置可能更容易。然后你可以将它添加到你的pdf中：

```
Image.getInstance("yourimage.gif"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-24T04:38:42.497

当您有多个重定向时，您不能使用 url。代替 url，您可以在`Image.getInstance("path")`. 您可以将 gif 文件放在部署包中。

# c# - 起订量多接口问题

> ID：305345
> 
> 赞同：3
> 
> 时间：2008-11-20T13:47:28.853
> 
> 标签：c#, .net, unit-testing, moq

这可能是也可能不是多接口问题，但我正在做这样的事情：

```
var mockInterface1 = new Mock<IInterface1>();
var mockInterface2 = mockInterface1.As<IInterface2>();
mockInterface1.Expect( foo => foo.Foo(It.IsAny<IInterface3>() ) );

...

otherObject.DoSomething( (IInterface1)mockInterface2.Object ); 
```

在运行时的 DoSomething 行上，我得到：

MyTest (TestFixtureSetUp): System.Reflection.TargetInvocationException : 调用目标引发了异常。

----> System.TypeInitializationException : 'IInterface1Proxy184f83d417624e05b450fa40c2c5d35c' 的类型初始化程序引发了异常。

----> System.BadImageFormatException : 试图加载格式不正确的程序。（来自 HRESULT 的异常：0x8007000B）

这是否与我没有正确的 Expect 代码有关，还是与我的 mock 中的多个接口或其他原因有关？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-21T14:12:27.573

我找到了这个链接： [城堡项目主题](http://forum.castleproject.org/viewtopic.php?p=14322&sid=6327e0e0b3a61cff948bf2d35a9e923d)

这似乎表明这是 Moq（和 RhinoMocks）使用的 Castle 的 DynamicProxy 中的一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T16:48:23.903

我知道这不是一个答案，但听起来确实像 MOQ 中的一个错误。你用的是什么版本？我刚刚使用 2.6 (2.6.1014.1) 尝试了您的示例，但没有出现异常。

# c++ - PL/SQL - 设置空值

> ID：305349
> 
> 赞同：2
> 
> 时间：2008-11-20T13:49:10.567
> 
> 标签：c++, sql, oracle, plsql

我已经看到有一个用于 PL/SQL 的 NVL 函数，它在遇到 null 时替换一个值。
但是如果我想将一个字段设置为 NULL，例如

```
EXEC SQL UPDATE mytable SET myfield=NULL WHERE otherValue=1; 
```

当我在 HPUX 上使用 C++ 运行它时，0L 用于 null 而在 Linux 上，语句失败并显示`illegal value`.

是否有我可以使用的通用 Oracle 空值/方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T14:13:57.773

哦，现在我意识到一定会发生什么。C++ 系统标头具有`#define NULL 0L`（在 HPUX 中），因此硬编码的 NULL 将被预处理器替换为该值。

几个想法：

*   只需在 SQL 语句中更改 NULL 的大小写。Oracle 不关心这种情况，如果它与定义的版本不完全匹配，它将不会被替换。当然，他们可能已经将 NULL、Null、null 等都定义为相同的值。
*   找到一种方法来禁用围绕该代码行的 NULL 定义。我认为有一种方法可以做到这一点，但我对预处理器指令知之甚少
*   尝试使用空字符串而不是文字 NULL。Oracle 应将其转换为 NULL。
*   将语句的文本存储在配置文件中并将其读入字符串。这样它实际上不会在代码中，因此预处理器不会修改它。
*   在 Oracle 中编写一个只返回 NULL 的函数，并在语句中使用该函数而不是 NULL 文字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T13:54:18.373

NULL 是 Oracle 中的正确值。我没有从 C++ 调用 Oracle 的经验，所以我不知道您的问题的原因是什么，但这一定是客户端的问题。如果您要通过 Oracle 的 SQLPlus 运行该语句，它应该会执行您想要的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T14:13:14.480

NULL 应该按原样工作，但您可以尝试使用指示变量，如下所述：http: [//download.oracle.com/docs/cd/B10500_01/appdev.920/a97269/pc_06sql.htm#424](http://download.oracle.com/docs/cd/B10500_01/appdev.920/a97269/pc_06sql.htm#424)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T14:03:32.737

是的 - 问题是 NULL 在 C++ 中的扩展方式。对于 informix，有 rsetnull 将变量设置为适当的值。oracle有这样的东西吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-12T00:29:19.270

您使用 EXECUTE SQL 语句的事实表明您在 C 或 C++ 程序中使用 Oracles Pro*C。

如果预处理器正在对 NULL 进行一些翻译，那么您就错过了一段编译过程。

在编译之前，您需要通过 Pro*C 预处理器运行源代码。它将 EXEC SQL 语句转换为一系列结构和函数调用，供 c/c++ 编译器编译。

[这个链接](http:///usr/vacpp/bin/xlc++%20-o%20ut.10g%20-bnoipath%20all_neocore_stage_checkUnitTest_10g.o%20BitterUnitTest_10g.o%20MatchingAlgorithmUnitTest_10g.o%20OracleClassesUnitTest_10g.o%20../common_10g.o%20../MatchingAlgorithm_10g.o%20-lclntsh%20-lDFDDL%20-lDFErrorManager%20-lDFMisc%20-lDFSPVLoader%20-lstrng%20-lErrorEngine%20-lExpCompiler%20-lcore_components%20-ldfoci%20-lstrng%20-L/lib/%20-L/usr/lib%20-L/dfact/common/library/common_libs%20-L/dfact/common/library/common_shared_objects%20-L.%20-L/ix810/ora_gcy/orasoft/app/oracle/product/10.2.0/rdbms/rdbms/lib%20-L/ix810/ora_gcy/orasoft/app/oracle/product/10.2.0/precomp/lib/%20-L/ix810/ora_gcy/orasoft/app/oracle/product/10.2.0/plsql/lib/%20-L/lib/%20-L/ix810/ora_gcy/orasoft/app/oracle/product/10.2.0/lib)应该有助于一些概念。

# c++ - 擦除一个字符[]

> ID：305357
> 
> 赞同：2
> 
> 时间：2008-11-20T13:52:05.693
> 
> 标签：c++, c, arrays, string, char

好的，我正在研究别人的代码。他们做了很多这样的事情：

```
char description[256];
description[0]=0; 
```

我知道这会将 \0 放在字符数组的第一个位置。但这甚至是擦除字符串的安全方法吗？

Visual Studio 也不断报告内存泄漏，我几乎将这与使用的字符串联系起来。

附言。是的，我知道 std::string，是的，我使用它。这不是我的代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-20T14:17:24.113

要将字符串*初始化为 0，您可以执行以下操作：*

```
char description[256] = {0}; 
```

这将为数组的每个元素分配 0。

仅将第一个元素设置为`0`( `'\0'`) 不会删除其内容。它甚至不保证将整个字符串设置为空字符。

正如其他人所说，您不能“擦除”静态创建的对象，直到函数关闭，当它被放弃时。从技术上讲，当函数被放弃时它也不会被删除——堆栈指针只是被改变了。如果您对正在删除的数据感到疑虑，您应该遍历数组，将每个条目设置为`0`( `'\0'`)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-20T15:20:20.383

将 char 数组的第一个元素设置为 \0 足以确保 'description' 是格式正确的实际字符串。元素 1 到 255 都可以是垃圾，只要元素 0 为 0，描述就是零长度字符串。

您不必担心上面发布的代码中的内存泄漏，因为数组是在堆栈上分配的。一旦它从堆栈中掉下来（超出范围），char 数组就会被释放。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-20T13:54:59.120

该字符串是在堆栈上分配的，因此在调用它的函数返回之前（当它自动发生时），无法释放它使用的内存。除非您以递归方式调用此函数*，否则这最终不会成为内存泄漏，因为一旦函数返回，空间将用于未来的堆栈帧。如果您担心安全性，您应该循环并清零字符串的元素。

如果你想要一个 free()-able 内存块，你可以执行以下操作并在堆上分配数组：

```
char *str = malloc(256*sizeof(char)); // str now is a pointer to a 256-char array
...
// some code here
...
free(str); // free the memory 
```

*这不是真正的内存泄漏，但有些人说“内存泄漏”的意思是“内存不足”。在任何情况下，堆栈空间都比堆空间更有限，所以你必须注意你在那里使用的内存块的大小。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-20T18:26:23.097

为了澄清迄今为止​​给出的好的答案：

*   是的，description[0]=0 从 strxxx 函数 POW 中清除字符串：strlen(description) == 0、strcmp(description, "") == 0 和 std::string(description) == "" 都是真的。

*   不，description[0]=0 与 free(description) 或 memset(description, 0, sizeof description) 不同。但你已经知道了。

*   您引用的那段代码不可能导致内存泄漏。内存不是在堆上分配的，内存泄漏是堆的事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-20T13:56:04.580

放入`\0`字符串的第一个元素是*清除*字符串的安全方法，但这与删除字符串不同，并且不会防止内存泄漏。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-20T13:57:15.810

如果它是一个 char[] 字符串，并且对它执行的唯一操作是字符串函数，那很好。当然，这对于受保护的数据来说还不够好。

至于内存泄漏，可能值得更改为字符串函数的安全版本，但您不能泄漏静态或基于堆栈的字符串，因此它可能是您的字符串传递出去的地方。

为了清楚起见，我将其更改为“\ 0”。

# java - 是否有合并的迭代器实现？

> ID：305358
> 
> 赞同：2
> 
> 时间：2008-11-20T13:52:33.760
> 
> 标签：java, iterator

是否有合并多个迭代器的迭代器实现？

```
class MergedIterator<T> implements Iterator<T>
{
     MergedIterator(Iterator<T>... iters)
     ....
} 
```

下一个方法应该转到`iters[1]`when`!iters[0].hasNext()`等

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-20T13:54:14.347

我自己称之为 ConcatenatedIterator - MergedIterator 应该合并几个迭代器的结果，例如基于排序

撇开命名不谈，我确信在某个地方的 3rd 方库中会有一个实现。刚去检查[谷歌收藏](http://code.google.com/p/google-collections/)...

编辑：宾果 - [Iterators.concat](http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/Iterators.html#concat(java.util.Iterator...))

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T13:55:32.130

公共集合[迭代器链](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/iterators/IteratorChain.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T13:59:55.163

在 groovy 中有一个：http: [//groovy.codehaus.org/Iterator+Tricks](http://groovy.codehaus.org/Iterator+Tricks) - 你可以用几行代码像这样卷起一个。

# python - 检测序列参数的正确方法？

> ID：305359
> 
> 赞同：18
> 
> 时间：2008-11-20T13:52:44.490
> 
> 标签：python, types, sequences

我想编写一个接受参数的函数，该参数可以是序列或单个值。值的类型是 str、int 等，但我**不**希望它被限制为硬编码列表。换句话说，我想知道参数 X 是序列还是我必须转换为序列以避免以后出现特殊情况的东西。我可以做

`type(X) in (list, tuple)`

但可能还有其他我不知道的序列类型，也没有通用的基类。

-N。

**编辑**：请参阅下面的“答案”，了解为什么大多数这些答案对我没有帮助。也许你有更好的建议。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-20T17:52:46.520

从 2.6 开始，使用[抽象基类](http://docs.python.org/library/abc.html#module-abc)。

```
>>> import collections
>>> isinstance([], collections.Sequence)
True
>>> isinstance(0, collections.Sequence)
False 
```

此外，可以自定义 ABC 以解决例外情况，例如不将字符串视为序列。这里有一个例子：

```
import abc
import collections

class Atomic(object):
    __metaclass__ = abc.ABCMeta
    @classmethod
    def __subclasshook__(cls, other):
        return not issubclass(other, collections.Sequence) or NotImplemented

Atomic.register(basestring) 
```

注册后，**原子**类可以与**isinstance**和**issubclass**一起使用：

```
assert isinstance("hello", Atomic) == True 
```

这还是比硬编码列表好很多，因为你只需要注册规则的例外，代码的外部用户可以注册自己的。

请注意，在**Python 3**中，用于指定元类的语法发生了变化，并且`basestring`抽象超类被删除了，这需要使用类似以下的东西来代替：

```
class Atomic(metaclass=abc.ABCMeta):
    @classmethod
    def __subclasshook__(cls, other):
        return not issubclass(other, collections.Sequence) or NotImplemented

Atomic.register(str) 
```

如果需要，可以编写同时兼容 Python 2.6+*和*3.x 的代码，但是这样做需要使用稍微复杂一点的技术来动态创建所需的抽象基类，从而避免由于元类语法差异而导致的语法错误. 这与本杰明彼得森的[六个](http://pythonhosted.org/six/)模块的[`with_metaclass()`](http://pythonhosted.org/six/#six.with_metaclass)功能基本相同。

```
class _AtomicBase(object):
    @classmethod
    def __subclasshook__(cls, other):
        return not issubclass(other, collections.Sequence) or NotImplemented

class Atomic(abc.ABCMeta("NewMeta", (_AtomicBase,), {})):
    pass

try:
    unicode = unicode
except NameError:  # 'unicode' is undefined, assume Python >= 3
    Atomic.register(str)  # str includes unicode in Py3, make both Atomic
    Atomic.register(bytes)  # bytes will also be considered Atomic (optional)
else:
    # basestring is the abstract superclass of both str and unicode types
    Atomic.register(basestring)  # make both types of strings Atomic 
```

`operator`在 2.6 之前的版本中，模块中有类型检查器。

```
>>> import operator
>>> operator.isSequenceType([])
True
>>> operator.isSequenceType(0)
False 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T19:35:43.250

> 上述所有方式的问题在于 str 被认为是一个序列（它是可迭代的，具有**getitem**等），但它通常被视为单个项目。
> 
> 例如，一个函数可以接受一个参数，该参数可以是文件名或文件名列表。函数从后者中检测第一个的最 Pythonic 方式是什么？

根据修改后的问题，听起来您想要的更像是：

```
def to_sequence(arg):
    ''' 
    determine whether an arg should be treated as a "unit" or a "sequence"
    if it's a unit, return a 1-tuple with the arg
    '''
    def _multiple(x):  
        return hasattr(x,"__iter__")
    if _multiple(arg):  
        return arg
    else:
        return (arg,)

>>> to_sequence("a string")
('a string',)
>>> to_sequence( (1,2,3) )
(1, 2, 3)
>>> to_sequence( xrange(5) )
xrange(5) 
```

这不能保证处理*所有*类型，但它可以很好地处理您提到的情况，并且应该为大多数内置类型做正确的事情。

使用它时，请确保接收到它的输出的任何东西都可以处理迭代。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-20T15:12:49.137

此处描述了序列： [https ://docs.python.org/2/library/stdtypes.html#sequence-types-str-unicode-list-tuple-bytearray-buffer-xrange](https://docs.python.org/2/library/stdtypes.html#sequence-types-str-unicode-list-tuple-bytearray-buffer-xrange)

所以序列与可迭代对象不同。我认为序列必须实现 `__getitem__`，而可迭代对象必须实现`__iter__`。因此，例如 string 是序列并且不实现`__iter__`，xrange 对象是序列并且不实现`__getslice__`。

但是从你看到的想要做的事情来看，我不确定你想要序列，而是可迭代的对象。所以去`hasattr("__getitem__", X)`你想要的序列，但`hasattr("__iter__", X)`如果你不想要字符串，那就去吧。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-01T18:59:11.283

恕我直言，python 方法是将列表作为 *list 传递。如：

```
myfunc(item)
myfunc(*items) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-20T14:52:34.247

在这种情况下，我更喜欢始终采用序列类型或始终采用标量。字符串不会是唯一在此设置中表现不佳的类型。相反，任何具有聚合使用并允许对其部分进行迭代的类型都可能行为不端。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-20T15:39:32.700

最简单的方法是检查是否可以将其转换为迭代器。IE

```
try:
    it = iter(X)
    # Iterable
except TypeError:
    # Not iterable 
```

如果您需要确保它是可重新启动或随机访问序列（即不是生成器等），那么这种方法是不够的。

正如其他人所指出的，字符串也是可迭代的，因此如果您需要排除它们（如果递归通过项目尤其重要，因为 list(iter('a')) 再次给出 ['a'] ，那么您可能需要专门排除他们与：

```
 if not isinstance(X, basestring) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-23T10:32:51.570

我是新来的，所以我不知道正确的方法是什么。我想回答我的答案：

上述所有方式的问题在于，它**`str`**被认为是一个序列（它是可迭代的、具有`__getitem__`等），但它通常被视为单个项目。

例如，一个函数可以接受一个参数，该参数可以是文件名或文件名列表。函数从后者中检测第一个的最 Pythonic 方式是什么？

我应该将此作为新问题发布吗？修改原版？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-20T14:05:04.280

我想我要做的是检查对象是否有某些方法表明它是一个序列。我不确定是否有关于什么构成序列的官方定义。我能想到的最好的是，它必须支持切片。所以你可以说：

```
is_sequence = '__getslice__' in dir(X) 
```

您还可以检查您将要使用的特定功能。

正如 pi 在评论中指出的那样，一个问题是字符串是一个序列，但您可能不想将其视为一个序列。您可以添加一个类型不是 str 的显式测试。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-04T14:43:24.013

如果字符串是问题，检测一个序列并过滤掉字符串的特殊情况：

```
def is_iterable(x):
  if type(x) == str:
    return False
  try:
    iter(x)
    return True
  except TypeError:
    return False 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-20T14:18:29.853

**修改后的答案：**

我不知道您对“序列”的想法是否与 Python 手册中所说的“[序列类型](https://docs.python.org/library/stdtypes.html#sequence-types-str-unicode-list-tuple-bytearray-buffer-xrange)”相匹配，但如果确实如此，您应该寻找 __Contains__ 方法。这就是 Python 用来实现检查“如果对象中有东西：”的方法

```
if hasattr(X, '__contains__'):
    print "X is a sequence" 
```

**我原来的答案：**

我会检查您收到的对象是否实现了迭代器接口：

```
if hasattr(X, '__iter__'):
    print "X is a sequence" 
```

对我来说，这是与您对序列的定义最接近的匹配，因为这将允许您执行以下操作：

```
for each in X:
    print each 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-20T16:46:48.213

你问错问题了。您不要尝试在 Python 中检测类型；你检测行为。

1.  编写另一个处理单个值的函数。（我们称之为_use_single_val）。
2.  编写一个处理序列参数的函数。（我们称之为_use_sequence）。
3.  编写调用上述两个的第三个父函数。（称之为 use_seq_or_val）。用异常处理程序包围每个调用以捕获无效参数（即不是单个值或序列）。
4.  编写单元测试以将正确和不正确的参数传递给父函数，以确保它正确捕获异常。

```
 def _use_single_val(v):
        print v + 1  # this will fail if v is not a value type

    def _use_sequence(s):
        print s[0]   # this will fail if s is not indexable

    def use_seq_or_val(item):    
        try:
            _use_single_val(item)
        except TypeError:
            pass

        try:
            _use_sequence(item)
        except TypeError:
            pass

        raise TypeError, "item not a single value or sequence" 
```

编辑：修改为处理问题中询问的“序列或单个值”。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-11-20T14:08:25.053

您可以在内置 len() 函数中传递参数并检查这是否会导致错误。正如其他人所说，字符串类型需要特殊处理。

根据文档， len 函数可以接受序列（字符串、列表、元组）或字典。

您可以使用以下代码检查对象是否为字符串：

```
x.__class__ == "".__class__ 
```

# python - 使用 Python sqlite3 API 的表、数据库模式、转储等列表

> ID：305378
> 
> 赞同：187
> 
> 时间：2008-11-20T14:00:23.947
> 
> 标签：python, sqlite, dump

出于某种原因，我找不到一种方法来获得 sqlite 的交互式 shell 命令的等价物：

```
.tables
.dump 
```

使用 Python sqlite3 API。

有这样的吗？

* * *

## 回答 #1

> 赞同：305
> 
> 时间：2012-05-24T22:15:42.380

在 Python 中：

```
con = sqlite3.connect('database.db')
cursor = con.cursor()
cursor.execute("SELECT name FROM sqlite_master WHERE type='table';")
print(cursor.fetchall()) 
```

注意我的其他[答案](https://stackoverflow.com/a/33100538/236830)。使用 pandas 有一种更快的方法。

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2008-11-20T15:26:39.637

您可以通过查询 SQLITE_MASTER 表来获取表和模式列表：

```
sqlite> .tab
job         snmptarget  t1          t2          t3        
sqlite> select name from sqlite_master where type = 'table';
job
t1
t2
snmptarget
t3

sqlite> .schema job
CREATE TABLE job (
    id INTEGER PRIMARY KEY,
    data VARCHAR
);
sqlite> select sql from sqlite_master where type = 'table' and name = 'job';
CREATE TABLE job (
    id INTEGER PRIMARY KEY,
    data VARCHAR
) 
```

* * *

## 回答 #3

> 赞同：89
> 
> 时间：2015-10-13T10:38:59.810

在 python 中执行此操作的最快方法是使用 Pandas（0.16 及更高版本）。

转储一张表：

```
db = sqlite3.connect('database.db')
table = pd.read_sql_query("SELECT * from table_name", db)
table.to_csv(table_name + '.csv', index_label='index') 
```

转储所有表：

```
import sqlite3
import pandas as pd

def to_csv():
    db = sqlite3.connect('database.db')
    cursor = db.cursor()
    cursor.execute("SELECT name FROM sqlite_master WHERE type='table';")
    tables = cursor.fetchall()
    for table_name in tables:
        table_name = table_name[0]
        table = pd.read_sql_query("SELECT * from %s" % table_name, db)
        table.to_csv(table_name + '.csv', index_label='index')
    cursor.close()
    db.close() 
```

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2008-11-20T14:07:20.437

我不熟悉 Python API，但您始终可以使用

```
SELECT * FROM sqlite_master; 
```

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2016-12-07T00:02:14.503

这是一个简短的 python 程序，用于打印这些表的表名和列名（python 2.python 3 下面）。

```
import sqlite3

db_filename = 'database.sqlite'
newline_indent = '\n   '

db=sqlite3.connect(db_filename)
db.text_factory = str
cur = db.cursor()

result = cur.execute("SELECT name FROM sqlite_master WHERE type='table';").fetchall()
table_names = sorted(zip(*result)[0])
print "\ntables are:"+newline_indent+newline_indent.join(table_names)

for table_name in table_names:
    result = cur.execute("PRAGMA table_info('%s')" % table_name).fetchall()
    column_names = zip(*result)[1]
    print ("\ncolumn names for %s:" % table_name)+newline_indent+(newline_indent.join(column_names))

db.close()
print "\nexiting." 
```

（编辑：我一直在定期对此进行投票，所以这里是寻找这个答案的人的 python3 版本）

```
import sqlite3

db_filename = 'database.sqlite'
newline_indent = '\n   '

db=sqlite3.connect(db_filename)
db.text_factory = str
cur = db.cursor()

result = cur.execute("SELECT name FROM sqlite_master WHERE type='table';").fetchall()
table_names = sorted(list(zip(*result))[0])
print ("\ntables are:"+newline_indent+newline_indent.join(table_names))

for table_name in table_names:
    result = cur.execute("PRAGMA table_info('%s')" % table_name).fetchall()
    column_names = list(zip(*result))[1]
    print (("\ncolumn names for %s:" % table_name)
           +newline_indent
           +(newline_indent.join(column_names)))

db.close()
print ("\nexiting.") 
```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2020-02-01T16:29:52.283

如果有人想对 Pandas 做同样的事情

```
import pandas as pd
import sqlite3
conn = sqlite3.connect("db.sqlite3")
table = pd.read_sql_query("SELECT name FROM sqlite_master WHERE type='table'", conn)
print(table) 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2009-03-02T03:47:31.020

显然 Python 2.6 中包含的 sqlite3 版本具有此功能：[http ://docs.python.org/dev/library/sqlite3.html](http://docs.python.org/dev/library/sqlite3.html)

```
# Convert file existing_db.db to SQL dump file dump.sql
import sqlite3, os

con = sqlite3.connect('existing_db.db')
with open('dump.sql', 'w') as f:
    for line in con.iterdump():
        f.write('%s\n' % line) 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2021-01-19T22:57:55.677

如果您只想打印出数据库中的所有表和列，有些人可能会发现我的函数很有用。

在循环中，我使用 LIMIT 0 查询每个 TABLE，因此它只返回没有所有数据的标题信息。您从中制作一个空的 df ，并使用可迭代的 df.columns 打印每个列名。

```
conn = sqlite3.connect('example.db')
c = conn.cursor()

def table_info(c, conn):
    '''
    prints out all of the columns of every table in db
    c : cursor object
    conn : database connection object
    '''
    tables = c.execute("SELECT name FROM sqlite_master WHERE type='table';").fetchall()
    for table_name in tables:
        table_name = table_name[0] # tables is a list of single item tuples
        table = pd.read_sql_query("SELECT * from {} LIMIT 0".format(table_name), conn)
        print(table_name)
        for col in table.columns:
            print('\t' + col)
        print()

table_info(c, conn) 
```

```
Results will be:

table1
    column1
    column2

table2
    column1
    column2
    column3 

etc. 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2014-12-10T03:01:18.127

经过大量的摆弄，我在[sqlite docs](http://www.sqlite.org/pragma.html#pragma_table_info)找到了一个更好的答案，用于列出表的元数据，甚至是附加的数据库。

```
meta = cursor.execute("PRAGMA table_info('Job')")
for r in meta:
    print r 
```

关键信息是给 table_info 加上前缀，而不是在 my_table 前面加上附件句柄名称。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-20T20:38:33.767

在[这里](http://svn.python.org/projects/python/trunk/Lib/sqlite3/dump.py)查看转储。似乎库 sqlite3 中有一个转储函数。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-10-25T14:38:19.537

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

if __name__ == "__main__":

   import sqlite3

   dbname = './db/database.db'
   try:
      print "INITILIZATION..."
      con = sqlite3.connect(dbname)
      cursor = con.cursor()
      cursor.execute("SELECT name FROM sqlite_master WHERE type='table';")
      tables = cursor.fetchall()
      for tbl in tables:
         print "\n########  "+tbl[0]+"  ########"
         cursor.execute("SELECT * FROM "+tbl[0]+";")
         rows = cursor.fetchall()
         for row in rows:
            print row
      print(cursor.fetchall())
   except KeyboardInterrupt:
      print "\nClean Exit By user"
   finally:
      print "\nFinally" 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-04-14T02:57:17.433

我已经在 PHP 中实现了一个 sqlite 表模式解析器，你可以在这里查看：[https ://github.com/c9s/LazyRecord/blob/master/src/LazyRecord/TableParser/SqliteTableDefinitionParser.php](https://github.com/c9s/LazyRecord/blob/master/src/LazyRecord/TableParser/SqliteTableDefinitionParser.php)

您可以使用此定义解析器来解析定义，如下面的代码：

```
$parser = new SqliteTableDefinitionParser;
$parser->parseColumnDefinitions('x INTEGER PRIMARY KEY, y DOUBLE, z DATETIME default \'2011-11-10\', name VARCHAR(100)'); 
```

# c# - 在实体框架的 EdmItemCollection 中定位 getter 和 setter 访问修饰符

> ID：305382
> 
> 赞同：1
> 
> 时间：2008-11-20T14:03:06.500
> 
> 标签：c#, xml, linq, entity-framework, linq-to-entities

我一直在为我的实体的存储库模式创建一个不错的 T4 模板。我没有手动解析 edmx 文件中的 xml，而是使用 EdmItemCollection 为概念模型创建对象图表示。

我已经能够从这个模型中获得很多信息。但是我找不到 Getter 和 Setter 访问修饰符的位置。它们存在于 edmx 文件的 CSDL 部分。

例子：

```
<Property Name="CustomerID" Type="String" Nullable="false" MaxLength="5" Unicode="true" FixedLength="true" 
    a:SetterAccess="Public" xmlns:a="http://schemas.microsoft.com/ado/2006/04/codegeneration" /> 
```

我应该在对象图中的哪个位置查找此信息？

这是我如何解析对象树的示例。

```
EdmItemCollection edmItems = new EdmItemCollection(new XmlReader[] { csdlReader });
var ownEntities = from item in edmItems
                  where item.BuiltInTypeKind == BuiltInTypeKind.EntityType
                  select item as EntityTypeBase;

Entities = (from ent in ownEntities // Entities is a property, therefore no declaration
            select new Entity
            {
                Name = ent.Name,
                SetName = (from entSet in entityContainer.BaseEntitySets
                           where (entSet.ElementType == ent) || (ent.BaseType != null && (entSet.ElementType.FullName.Equals(ent.BaseType.FullName)))
                           select entSet.Name).FirstOrDefault(),
                Keys = (from keys in ent.KeyMembers
                        select new Entity.Member
                        {
                            Name = keys.Name,
                            Type = keys.TypeUsage.EdmType.Name 
                        }).ToList(),
                Properties = (from prop in ent.Members
                              select new Entity.Member
                              {
                                  Name = prop.Name,
                                  Type = prop.TypeUsage.EdmType.Name,
                                  IsCollection = prop.TypeUsage.EdmType.BuiltInTypeKind == BuiltInTypeKind.CollectionType
                              }).ToList()
            }).ToList(); 
```

我希望很清楚我要去的方向。

在通过 EdmItemCollection 的代码进行大量反射后，它不会加载[http://schemas.microsoft.com/ado/2006/04/codegeneration](http://schemas.microsoft.com/ado/2006/04/codegeneration)架构，因此它只是忽略了这些属性。

但我希望有人可以帮助我找出如何找到这些信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-21T10:12:52.407

感谢来自 Microsoft 的 Noam Ben-Ami，他向我[介绍了 CSDL 中的注释](http://blogs.msdn.com/adonet/archive/2008/01/11/annotations-in-csdl.aspx)博客文章，我能够回答我自己的问题。

Edm 类型中没有直接呈现在对象模型中的所有内容仍然可以在 MetadataProperties 中找到（它包含元素的每个 xml 属性，即使是表示为类型化属性的那些）。

我只需要查找名称以“ [http://schemas.microsoft.com/ado/2006/04/codegeneration](http://schemas.microsoft.com/ado/2006/04/codegeneration) :”开头的 MetadataProperty 并且我找到了它。

回答我的代码示例：

```
String codeGenerationXmlns = "http://schemas.microsoft.com/ado/2006/04/codegeneration";
EdmItemCollection edmItems = new EdmItemCollection(new XmlReader[] { csdlReader });
var ownEntities = from item in edmItems
                  where item.BuiltInTypeKind == BuiltInTypeKind.EntityType
                  select item as EntityTypeBase;
var entityContainer = (from item in edmItems
                       where item.BuiltInTypeKind == BuiltInTypeKind.EntityContainer
                       select item as EntityContainer).FirstOrDefault();
Entities = (from ent in ownEntities
            select new Entity
            {
                Name = ent.Name,
                SetName = (from entSet in entityContainer.BaseEntitySets
                           where (entSet.ElementType == ent) || (ent.BaseType != null && (entSet.ElementType.FullName.Equals(ent.BaseType.FullName)))
                           select entSet.Name).FirstOrDefault(),
                IsPublic = ((from metaProps in ent.MetadataProperties
                             where metaProps.Name.Equals(codeGenerationXmlns + ":TypeAccess")
                             select metaProps.Value).FirstOrDefault() ?? "Public").Equals("Public"),
                Keys = (from keys in ent.KeyMembers
                        select new Entity.Member
                        {
                            Name = keys.Name,
                            Type = keys.TypeUsage.EdmType.Name
                        }).ToList(),
                Properties = (from prop in ent.Members
                              select new Entity.Member
                              {
                                  Name = prop.Name,
                                  Type = prop.TypeUsage.EdmType.Name,
                                  IsCollection = prop.TypeUsage.EdmType.BuiltInTypeKind == BuiltInTypeKind.CollectionType,
                                  PrivateGetter = ((from metaProps in prop.MetadataProperties
                                                    where metaProps.Name.Equals(codeGenerationXmlns + ":GetterAccess")
                                                    select metaProps.Value).FirstOrDefault() ?? "Public").Equals("Private"),
                                  PrivateSetter = ((from metaProps in prop.MetadataProperties
                                                    where metaProps.Name.Equals(codeGenerationXmlns + ":SetterAccess")
                                                    select metaProps.Value).FirstOrDefault() ?? "Public").Equals("Private"),
                              }).ToList()
            }).ToList(); 
```

# mercurial - tortoisehg 日志窗口中的奇怪输出

> ID：305386
> 
> 赞同：4
> 
> 时间：2008-11-20T14:03:59.680
> 
> 标签：mercurial, merge, tortoisehg

我有两个分支，主分支（黑色）和一个功能分支（黄色）。

如您所见，由于功能分支是分叉的，因此它会保持最新状态，从 main 获取更改：

[替代文字 http://azkotoki.org/images/stackoverflow/tgh-reintegrate1.gif](http://azkotoki.org/images/stackoverflow/tgh-reintegrate1.gif)

当我将功能分支重新集成回主分支时，日志窗口会显示这个丑陋的图表：

[替代文字 http://azkotoki.org/images/stackoverflow/tgh-reintegrate2.gif](http://azkotoki.org/images/stackoverflow/tgh-reintegrate2.gif)

它将每个合并点显示为与功能分支合并的新分支。如果我有几个功能分支，这将变得几乎不可能阅读。我也试过了`hg view`，结果更奇怪。

不管上面显示的图片，最终的合并结果都很好，但是重新集成的分支的图表让我很恼火。

我是否因为合并到功能分支太多次而做错了什么？或者我对 tortoisehg 的日志窗口期望过高 :) ？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T09:21:11.543

该图看起来像这样，因为修订是按其修订号排序的。主存储库的修订排序和编号如下：

```
0 Imported initial repo.
1 Trivial change to also echo b.
2 Added another echo for c.
3 Echo for d.
4 Echo for e. 
```

这反映了将变更集添加到存储库的顺序。功能分支存储库具有以下顺序：

```
0 Imported initial repo.
1 Trivial change to also echo b.
3 Added another echo for c.
4 Automatic merge...
5 Echo for d.
6 Automatic merge...
7 Echo for e.
8 Automatic merge... 
```

再一次，一切都很好地订购了。但是，当您将功能分支拉入主存储库时，只会添加缺少的变更集。因此 main 中的结果是：

```
0 Imported initial repo.
1 Trivial change to also echo b.
2 Added another echo for c.
3 Echo for d.
4 Echo for e.
5 Refactored echos to print.
6 Automatic merge...
7 Automatic merge...
8 Automatic merge... 
```

图表反映了这一点。

正如您所注意到的，存储库很好——这只是变更集如何在磁盘上排序的工件。如果需要，您可以将存储库与漂亮的图形交换为具有丑陋图形的存储库，因为它们现在包含相同的变更集。只需记住从中移动任何重要设置`.hg/hgrc`（从带有丑陋图形的克隆中复制文件）。

顺便说一句，当我查看我的[http://hg.intevation.org/mercurial/crew/（Mercurial](http://hg.intevation.org/mercurial/crew/)的开发分支）克隆中的图表并将其与[https://的新克隆中的图表进行比较时www.mercurial-scm.org/repo/hg（Mercurial](https://www.mercurial-scm.org/repo/hg)的主要分支）我看到了同样的现象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-25T22:35:49.403

获得“更好”图形的一种方法是使用具有紧凑图形模式的 pre 2.0 TortoiseHg。在这种模式下，您的第二个存储库将只有两列行，类似于您的第一个屏幕截图中的内容。

不幸的是，这个特性还没有从 GTK 移植到 Qt，所以它在 TortoiseHg 的当前版本（2.1.2）中不存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T19:16:05.610

当您仔细观察时，您会发现这两个图表（几乎）相同，但呈现方式不同。那看起来像是 3 个不同的分支，实际上是一个分支，但呈现方式略有不同。

我写“几乎”是因为修订号已重新排序。而这真的很奇怪……

# reporting-services - 有没有办法在 SSRS 参数窗口中有一个重置按钮？

> ID：305392
> 
> 赞同：4
> 
> 时间：2008-11-20T14:06:16.010
> 
> 标签：reporting-services, button, report, reset

有没有办法在 SSRS 参数窗口中有一个重置按钮？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T08:05:11.000

用户可以通过单击网络浏览器中的“刷新”按钮来重置参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-21T11:47:09.083

不，或者我还没有听说过如何做到这一点。但是你可以模拟它。

做到这一点的一种方法是创建一个文本框，该文本框具有一个设置为跳转到自身的操作。您可以或跳转到默认值，或跳转到已经分配了一些参数的自身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-24T10:32:52.110

Modify the ReportViewer.aspx...

I came across this article on how to do it but didn't try it as I was only looking into whether it can be done/has been done before and need confirmation before I can develop it:

[https://github.com/MagnusJohansson/CustomSSRSReportViewer](https://github.com/MagnusJohansson/CustomSSRSReportViewer)

# c# - 迭代另一个范围内的匿名变量，而不是创建它的位置

> ID：305393
> 
> 赞同：1
> 
> 时间：2008-11-20T14:07:05.070
> 
> 标签：c#, .net, asp.net-mvc, unit-testing

我正在为 mvc Web 应用程序编写一个单元测试，检查返回的匿名变量列表（在 jsonresult 中）是否正确。因此我需要遍历该列表，但我似乎找不到这样做的方法。

所以我有两种方法

1) 返回一个 json 结果。在该 json 结果中有一个名为 data 的属性。该属性是对象类型，但在内部它是匿名变量的列表

2）方法调用方法1，检查返回的jsonresult是否正常。

如果我运行测试并且我破坏了调试器，我可以将鼠标悬停在结果上并查看其中的项目。我只是在代码中找不到这样做的方法。（仅使用 foreach 是不可能的，因为此时我需要它，我不在创建匿名方法的方法中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T14:15:26.457

我认为您的意思是在您说过“匿名变量”的任何地方都是“匿名类型”-但是您仍然可以使用 迭代列表`foreach`，只需将迭代变量声明为 type `object`：

```
foreach (object o in myList)
{
    // Not sure what you're actually trying to do in here...
} 
```

`ToString`如果您需要检查内容，您可以使用匿名类型以一种有用的方式覆盖这一事实。您的测试可以检查将每个元素投影到字符串的结果。实际上，您可以很容易地将结果对象转换为字符串序列：

```
var strings = ((IEnumerable) result).Cast<object>.Select(x => x.ToString()); 
```

然后测试`strings`可能使用[`SequenceEqual`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.sequenceequal.aspx).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T14:30:58.440

创建一组与您期望的对象相同的对象，然后序列化它和单元测试下操作的 result.Data。最后，比较流以查看它们是否相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T14:31:48.080

好的，我发现它是您解决方案的一部分:) 显然我可以将其转换为 IEnumerable，然后我可以遍历结果。谢谢！

```
 var objects= ((IEnumerable)result.Data);
    foreach (object obj in objects)
    {
       //inhere i can use reflection to get the properties out of it
    } 
```

# text - SSRS 中的文本换行

> ID：305419
> 
> 赞同：2
> 
> 时间：2008-11-20T14:18:43.580
> 
> 标签：text, reporting-services, field, report, word-wrap

如何在 SSRS 报表中完成表格字段的文本换行，以及在将报表呈现为 PDF 格式时进行适当的美化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-30T14:27:31.207

将 CanGrow 属性设置为 True 将允许换行，并且文本框将在垂直方向变大以包含其值中的所有字符。

为确保 PDF 导出的正确景观，请相应地设置报表对象的 PageSize（设置 Width=11" x Height=8.5" 将生成横向 PDF）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T14:23:20.390

为确保正确插入换行符，请使用

```
=Replace(Fields!MyField.Value, vbLf, Environment.NewLine) 
```

设置 CanGrow = True。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-17T04:10:34.177

这是一种愚蠢的方法，但如果您没有太多字段，请尝试使用空间将文本推送到下一行。

# python - Python 打印单词

> ID：305422
> 
> 赞同：1
> 
> 时间：2008-11-20T14:20:16.557
> 
> 标签：python

如果有人可以帮助我编写 Python 代码：如果我输入一个字母，如何打印所有以该单词开头的单词？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T14:30:06.023

```
print [word for word in words if word.startswith(letter)] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T14:25:30.137

有很多方法可以做到这一点，例如：

```
words = ["zwei", "peanuts", "were", "walking", "down", "the", "strasse"]
letter = "w"
output = [x for x in words if x[0] == letter] 
```

将的内容`output`是：

```
['were', 'walking'] 
```

一些注意事项：

*   如果代码需要*快速*，您应该将单词列表放在某种树中。
*   如果您需要更大的灵活性，您应该构建一个正则表达式进行匹配

# continuous-integration - 产品线工程

> ID：305423
> 
> 赞同：4
> 
> 时间：2008-11-20T14:21:07.447
> 
> 标签：continuous-integration, project-management, configuration-management

我们在我公司所做的一些工作正在慢慢向一个产品系列发展，在同一个系列中包含不同的产品，每个产品中都有不同的口味（或功能集）。我正在寻找一些可能对我们有所帮助的产品线工程技术。网络搜索导致大量资源和大量不同的信息来源和不同的方法。在深入了解其中任何一个之前，我认为从以前做过类似事情的人那里获得一些实用建议会很有用。有人在这方面有任何建议/智慧吗？我特别在寻找更好的方法来在产品线环境中执行以下操作：

1.  配置和构建管理
2.  易于开发周期
3.  测试

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-21T05:14:50.887

三大秘诀。自动化，自动化，自动化。

阅读[持续集成](http://martinfowler.com/articles/continuousIntegration.html)。在过去，制作“构建”曾经是一个有点大的仪式。用“那个家伙”找到“机器”和“文件”，只有他知道如何打包所有东西等等......使用[CruiseControl](http://cruisecontrol.sourceforge.net/)及其表亲，运行单元测试，创建开发版本，并自动打包安装程序. 任何工具都没有什么神奇之处，但是花时间设置每个组件并维护它们会极大地奖励团队。自动化构建成为生活中平凡的一部分。

当您从事一系列相关项目时，我建议您采用强大的编码约定和策略，以便开发人员可以阅读和共享彼此的代码。部分策略应该是防止可能降低代码可修改性的事情；并促进重构、单元测试和[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)。

我不会重复 Fowler 所写的内容，但是自动化部署也值得您花时间和精力（当然，一旦您有东西要部署）。从 SQL 脚本到创建服务用户，一切都必须自动化，并且最好包含在一个简单的网站中，您的测试人员可以按需部署。同样，通过自动化，部署 QA 构建以进行测试成为事实。

# c++ - AIX：为什么抛出异常会中止多线程代码？

> ID：305424
> 
> 赞同：0
> 
> 时间：2008-11-20T14:22:17.177
> 
> 标签：c++, exception, gcc, aix

当运行使用 -pthread 编译的代码时抛出 C++ 异常时，我们会中止。

平台：AIX 5.3 技术级别 8 编译器：gcc 3.4.6 链接器：AIX 链接器 1.65.2.4

测试代码：

```
// exception.cpp
#include <iostream>

class MyException
{
public:
        MyException(){}
        virtual ~MyException(){};
};

void gTest()
{
        throw MyException();
}

int main()
{
        try
        {
                gTest();
        }
        catch(MyException const & ex)
        {
                std::cout << "exception was caught" << std::endl;
        }

        return 0;
}

$ g++ exception.cpp
$ ./a.out
exception was caught
$ g++ -pthread exception.cpp
$ ./a.out
terminate called after throwing an instance of 'MyException'
IOT/Abort trap (core dumped)
$ gdb a.out
GNU gdb 6.0
Copyright 2003 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB. Type "show warranty" for details.
This GDB was configured as "powerpc-ibm-aix5.1.0.0"...
(gdb) run
Starting program: /home/leeder/except/a.out
terminate called after throwing an instance of 'MyException'

Program received signal SIGABRT, Aborted.
Switching to Thread 1
0xd0124834 in pthread_kill () from /usr/lib/libpthreads.a(shr_xpg5.o)
(gdb) bt
#0 0xd0124834 in pthread_kill () from /usr/lib/libpthreads.a(shr_xpg5.o)
#1 0xd01242a8 in _p_raise () from /usr/lib/libpthreads.a(shr_xpg5.o)
#2 0xd0359bdc in raise () from /usr/lib/libc.a(shr.o)
#3 0xd03b7efc in abort () from /usr/lib/libc.a(shr.o)
#4 0xd0ca1800 in __gnu_cxx::__verbose_terminate_handler() () at ../../.././libstdc++-v3/libsupc++/vterminate.cc:96
#5 0xd0ca1220 in __cxxabiv1::__terminate(void (*)()) (handler=0)
at ../../.././libstdc++-v3/libsupc++/eh_terminate.cc:43
#6 0xd0ca128c in std::terminate() () at ../../.././libstdc++-v3/libsupc++/eh_terminate.cc:53
#7 0xd0ca7cfc in __cxa_throw (obj=0x200084e8, tinfo=0xffffffff, dest=Cannot access memory at address 0xffffffff
)
at ../../.././libstdc++-v3/libsupc++/eh_throw.cc:80
#8 0x100008dc in gTest() ()
#9 0x100009f0 in main ()
(gdb) 
```

有没有人见过类似的东西？

你认为升级到 gcc 4 会有帮助吗？

切换到 IBM 的 xl 编译器怎么样？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T17:16:05.313

在 AIX 上尝试了您的程序：

> 操作系统级别 -r
> 
> 5200-08

与 g++ --version

> g++ (GCC) 3.3.2
> 
> g++ -o ex -pthread ex.cpp

将导致在运行时找不到符号 (pthread_mutex_t)

但是，如果您像这样构建它：

> g++ -o ex -lpthread ex.cpp

效果很好。我想这可能是正确的 pthread 库的链接问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T13:31:38.693

g++ 4.3.2 似乎可以解决这个问题。xlC v10 也有效。

# coding-style - 在 XHTML 中关闭一个空元素之前是否仍然需要放置一个空格？

> ID：305431
> 
> 赞同：8
> 
> 时间：2008-11-20T14:25:30.883
> 
> 标签：coding-style, xhtml

[W3C 建议在 XHTML 中的结束标记之前放置一个空格](http://www.w3.org/TR/xhtml1/#C_2)，因为这样可以为某些浏览器提供更好的向后兼容性，例如 write`<br />`而不是`<br/>`. 但是那里还有浏览器，不能容忍你省略了空间？（W3C 没有提及哪些浏览器会导致问题。）

我知道这并没有太大的区别。我只是更喜欢较短的版本。因此，除非有充分的理由，否则我现在将在关闭空标记之前开始编写不带空格的 XHTML。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-20T14:36:41.517

它适用于网景 4。

我仍然出于习惯将其包含在内，无论如何我的模板库都会为我提供它们，但它在今天是否真的那么重要值得怀疑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T17:42:46.447

我会说不...这是为了支持 Netscape 4，正如 bobince 所说，我相信真正使用的此类浏览器的数量非常接近于零，幸运的是！
与文森特所说的不同，我认为 IE4 没有这样的问题。而且我相信我们无论如何都可以将 IE3/4/5/5.5 归类为已死（至少没有 Web 统计数据），并且不耐烦地等待对 IE6 做同样的事情！:-D

愚蠢的事情，这影响了很多人，有时我`x="foo" />`什至会看到纯 XML 文件！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T14:30:00.297

如果仍有依赖空间的浏览器使用它。

节省的字节数并不能证明可能出现的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T14:34:20.570

向后兼容的要点是仍然支持不支持短符号的浏览器。那里可能还有很多。

我想您的选择可能取决于网站的目标受众（例如，技术网站将有更多使用最新浏览器的访问者，而不是使用 Win 95 和 IE 4 的人访问的senior.net）。

# c# - 在 ASP.NET 中查询许多数据库的好方法

> ID：305434
> 
> 赞同：0
> 
> 时间：2008-11-20T14:27:49.630
> 
> 标签：c#, asp.net, gridview, multiple-databases

我要做的是在许多 Oracle 数据库（至少十几个）上运行相同的 SQL 选择，并在 Gridview 中显示输出。

我已经拼凑了一些可行的东西，但不幸的是它很慢。我认为，十几个数据库中至少有一个总是无法访问或处于错误状态的事实加剧了这种情况。

除了很慢，我不禁认为这不是最好的方法，也不是很像“.NET”。

我在过去写过类似的东西，作为 PHP 中的一个简单循环，它只是依次连接到每个数据库，运行 sql 并写入另一个`<tr>`，对于给定的查询，它的运行速度至少快两倍。但我对此并不满意，我想提高我的知识！

我正在学习 C# 和 ASP.NET，所以请原谅可怕的代码 :)

```
public void BindData(string mySQL)
    {
        OracleConnection myConnection;
        OracleDataAdapter TempDataAdapter;
        DataSet MainDataSet = new DataSet();
        DataTable MainDataTable = new DataTable();
        DataSet TempDataSet;
        DataTable TempDataTable;
        string connectionString = "";
        Label1.Visible = false;
        Label1.Text = "";

        foreach (ListItem li in CheckBoxList1.Items)
        {
            if (li.Selected)
            {
                connectionString = "Data Source=" + li.Text + "";
                connectionString += ";Persist Security Info=True;User ID=user;Password=pass;Unicode=True";
                myConnection = new OracleConnection(connectionString);
                try
                {
                    TempDataAdapter = new OracleDataAdapter(mySQL, myConnection);
                    TempDataSet = new DataSet();
                    TempDataTable = new DataTable();
                    TempDataAdapter.Fill(TempDataSet);
                    TempDataTable = TempDataSet.Tables[0].Copy();
                    /* If the main dataset is empty, create a table by cloning from temp dataset, otherwise
                     copy all rows to existing table.*/
                    if (MainDataSet.Tables.Count == 0)
                    {
                        MainDataSet.Tables.Add(TempDataTable);
                        MainDataTable = MainDataSet.Tables[0];
                    }
                    else
                    {
                        foreach (DataRow dr in TempDataTable.Rows)
                        {
                            MainDataTable.ImportRow(dr);
                        }
                    }
                }
                catch (OracleException e)
                {
                    Label1.Visible = true;
                    Label1.Text = Label1.Text + e.Message + " on " + li.Text + "<br>";

                }
                finally
                {
                    if (myConnection != null)
                    {
                        myConnection.Close();
                        myConnection = null;
                    }
                    TempDataSet = null;
                    TempDataAdapter = null;
                    TempDataTable = null;

                }
            }
        }
        GridView1.DataSourceID = String.Empty;
        if (MainDataSet.Tables.Count != 0)
        {
        GridView1.DataSource = MainDataSet;
            if (GridView1.DataSource != null)
            {
                GridView1.DataBind();
            }
        }
    }
    protected void Button1_Click(object sender, EventArgs e)
    {
        BindData(TextBox1.Text);
    } 
```

谢谢！

更新：SQL 代码各不相同，为了测试，我使用了非常简单的查询，例如`select sysdate from dual`or `select name from v$database`。在最终使用中，它会复杂得多，我的想法是我应该能够运行几乎任何东西，因此`BindData(TextBox1.Text)`

更新：从 ASP.NET 代码连接到许多数据库而不是一个或所有数据库上的存储过程或复制到一个数据库的原因是双重的。首先，有问题的数据库是几个类似生产环境（通常是开发、测试和支持每个客户端）的频繁更新副本，因此对实际数据库所做的任何事情都必须定期更新或重做，因为它们无论如何都会重新加载。其次，我事先不知道可能会运行什么样的查询，这种形式让我只需`select count (name) from dbusers`针对十几个数据库键入例如，而无需首先考虑将 dbusers 表复制到主数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T19:58:26.720

如果您在 DataTable 对象上运行 DataAdapter.Fill 方法，则该表将使用查询结果进行更新。因此，无需创建新的 DataTable 和 DataSet 对象，然后手动复制 DataRows，您只需将行添加到同一个表中即可。

尝试这样的事情（在未经测试的 C# 代码中）：

```
public void BindData(string mySQL)
{
  OracleConnection myConnection;
  // Empty connection string for now
  OracleDataAdapter MainDataAdapter = new OracleDataAdapter(mySQL, ""); 
  DataTable MainDataTable = new DataTable();
  string connectionString = "";
  Label1.Visible = false;
  Label1.Text = "";

  foreach (ListItem li in CheckBoxList1.Items)
  {
    if (li.Selected)
    {
      connectionString = "Data Source=" + li.Text + "";
      connectionString += ";Persist Security Info=True;User ID=user;Password=pass;Unicode=True";
      MainDataAdapter.SelectCommand.Connection.ConnectionString = connectionString
      try
      {
        MainDataAdapter.Fill(MainDataTable);
      }
      catch (OracleException e)
      {
        Label1.Visible = true;
        Label1.Text = Label1.Text + e.Message + " on " + li.Text + "<br>";
      }
    }
  }
  GridView1.DataSourceID = String.Empty;
  GridView1.DataSource = MainDataTable;
  GridView1.DataBind();
} 
```

我做了以下更改：

*   创建了一个数据适配器并使用您的 mySQL 查询为其分配了一个选择命令
*   给连接一个空的连接字符串
*   创建了一个数据表对象并删除了数据集（只有在查询返回多行时才需要它们）
*   将循环更改为仅设置 SelectCommand 的连接字符串（您可能必须将其更改为将 SelectCommand 替换为新的）
*   删除了 connection.Close() 调用。DataAdapter 会自动执行此操作。

就是这样。如果您的数据库处于脱机状态，您仍然会遇到速度变慢的情况，但至少代码更简单、更快，因为您不必在表之间复制所有行。

还有一件事。您可能可以在连接字符串中为连接设置超时。尝试降低这个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T19:33:42.557

可能有很多因素导致它变慢。正在执行的运行缓慢的 sql 语句是什么？

如果有人阅读这篇文章正在使用 sql server，Scott Mitchell 刚刚写了一篇很好的文章来帮助在 sql server 中解决这个问题： **[对多个数据库运行相同的查询](http://scottonwriting.net/sowblog/posts/13587.aspx)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T20:34:52.043

为什么不在一个 oracle 数据库上运行单个存储过程，并让 sproc 调用其他数据库？这是使用链接数据库的正确方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T20:42:53.663

Why not use replication to do this...you know, one central database which is pooling for new data from the other databases and just execute your queries over this set of data which is *never* going to be down.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T20:33:16.757

听起来您可能对获得这个更通用问题的答案更感兴趣：**如何在不挂起 UI**（ASP 或 WinForms）的情况下执行长时间运行的任务？

该问题的答案是使用多个[Threads](http://msdn.microsoft.com/en-us/library/system.threading.thread.aspx)。我会在一个单独的线程上执行这样一个长时间运行的任务，并向用户显示一个包含当前结果的页面（自动刷新或使用 ajax 等）。您甚至可以为每个可用的处理器获得幻想并创建任务，以充分利用您的机器（使用类似[Parallel Extensions](http://blogs.msdn.com/pfxteam/)之类的东西）；但是，这会显着增加复杂性，并且很难正确处理。

如果您没有在 .Net 中使用过 Threads，可以在[这里](http://www.yoda.arachsys.com/csharp/threads/)找到一个很棒的教程（由唯一的[Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)提供）

# java - Java SE 6 中的 JPA/Hibernate，数据访问的最佳实践

> ID：305436
> 
> 赞同：7
> 
> 时间：2008-11-20T14:29:37.523
> 
> 标签：java, hibernate, jpa

我正在开始一个普通的 Java SE 项目，我打算使用 JPA/Hibernate。我想知道是否有人能告诉我在这种环境（数据访问层）中与 Hibernate 交互的最佳方式是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-20T14:55:20.760

我不确定什么是最好的方法，但在我的工作场所，我们的大部分 Hibernate 交互都基于这些文章：

[不要让 Hibernate 窃取您的身份](http://www.onjava.com/pub/a/onjava/2006/09/13/dont-let-hibernate-steal-your-identity.html) 和[通用数据访问对象](http://www.hibernate.org/328.html)

它们向您展示了如何以一种智能的方式制作映射类，以及如何实现一个可重用于任何持久类的通用 DAO。这对我们来说效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-18T19:27:11.680

[这是将JPA 与 Hibernate](http://www.skill-guru.com/blog/2009/08/06/hibernate-tutorial-continued-using-annotations/)一起使用的指南

1.5 年前，我们在我们的应用程序中使用了这种方法，我认为 SE6 中没有与此相关的任何新内容。我们曾使用 JDK 5 使用大量使用的注解。

# linux - 通过 inode 获取文件详细信息

> ID：305438
> 
> 赞同：4
> 
> 时间：2008-11-20T14:29:46.150
> 
> 标签：linux

当我知道 inode 时，我需要在 bash 脚本中获取有关文件的详细信息。系统是 Linux。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-21T15:02:13.290

如果您专门处理 ext2/3 文件系统，则可以使用 debugfs 进行 inode 到文件查找，这比使用 find 用于具有许多文件的大型文件系统要快得多。

```
debugfs -R "ncheck $inode" /dev/device 2> /dev/null | tail -1 | awk '{print $2}' 
```

Find 仍然是您最好的选择，但我所知道的其他任何东西都与文件系统无关。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-20T14:45:17.287

像这样：

```
find $SEARCHPATH -maxdepth $N -inum $INUM -exec ls -l {} \; 
```

由于文件名链接到 inode，反之亦然，您需要以蛮力方式执行此操作。如果您对它应该在哪里有所了解， -maxdepth 将缩小范围。如果您搜索包含多个文件系统的树，您还可以添加 -xdev。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T14:43:05.683

您可以使用和`find`的组合。这为您提供了文件的名称（它可以有多个名称），您可以从中找到所需的任何信息。`-inum``-xdev`

# asp.net - 在开发和生产环境中使用不同的 Web.config

> ID：305447
> 
> 赞同：204
> 
> 时间：2008-11-20T14:31:35.473
> 
> 标签：asp.net, visual-studio, configuration, web-config

我需要在我的 ASP.NET 应用程序中使用不同的数据库连接字符串和 SMTP 服务器地址，具体取决于它在开发或生产环境中运行。

[应用程序通过WebConfigurationManager.AppSettings](http://msdn.microsoft.com/en-us/library/system.web.configuration.webconfigurationmanager.appsettings.aspx)属性从 Web.config 文件中读取设置。

我使用 Build/Publish 命令通过 FTP 将应用程序部署到生产服务器，然后手动将远程 Web.config 替换为正确的。

是否有可能以某种方式简化部署过程？谢谢！

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2010-06-17T18:46:19.823

在 Visual Studio 2010 及更高版本中，您现在可以根据构建配置对 web.config 应用转换。

创建 web.config 时，您可以在解决方案资源管理器中展开该文件，您将看到两个文件：

*   Web.Debug.Config
*   Web.Release.Config

它们包含可用于

*   更改连接字符串
*   删除调试跟踪和设置
*   注册错误页面

有关详细信息，请参阅MSDN 上[的 Web 应用程序项目部署的 Web.config 转换语法。](http://msdn.microsoft.com/en-us/library/dd465326(VS.100).aspx)

尽管官方不支持，也可以将相同类型的转换应用于非 Web 应用程序`app.config`文件。请参阅[Phil Bolduc 博客](http://philbolduc.blogspot.com/2010/03/using-config-transforms-outside-web.html)，了解如何修改项目文件以向 msbuild 添加新任务。

这是[对 Visual Studio Uservoice 的长期要求](https://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2043217-support-web-config-style-transforms-on-any-file-in)。

[Visual Studio 2010](http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5)及更高版本的扩展“ [SlowCheetah](http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5) ”可用于为任何配置文件创建转换。从 Visual Studio 2017.3 开始，[SlowCheetah 已集成到 IDE](https://blogs.msdn.microsoft.com/visualstudio/2017/08/15/updates-in-visual-studio-2017-based-on-your-uservoice-suggestions/)中，代码库由 Microsoft 管理。这个新版本还支持 JSON 转换。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2008-11-20T15:55:36.083

web.config 中的`<appSettings>`标签支持文件属性，该属性将使用自己的一组键/值加载外部配置。这些将覆盖您在 web.config 中的任何设置或添加到它们。

我们通过在安装时使用与站点安装环境相匹配的文件属性修改我们的 web.config 来利用这一点。我们通过安装程序的开关来做到这一点。

例如;

```
<appSettings file=".\EnvironmentSpecificConfigurations\dev.config">

<appSettings file=".\EnvironmentSpecificConfigurations\qa.config">

<appSettings file=".\EnvironmentSpecificConfigurations\production.config"> 
```

笔记：

*   对属性指定的 .config 的更改不会触发 asp.net 工作进程的重新启动

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-11-20T14:36:50.207

您是否查看过 Web 部署项目？

[http://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)

如果您不在 2008 上，也有一个适用于 VS2005 的版本。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-11-20T14:38:53.167

我也想知道。这有助于为我隔离问题

```
<connectionStrings configSource="connectionStrings.config"/>

```

然后我保留一个 connectionStrings.config 以及一个“{host} connectionStrings.config”。这仍然是一个问题，但是如果您对两个环境中不同的部分执行此操作，您可以部署和版本相同的 web.config。

（而且我不使用VS，顺便说一句。）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-20T14:54:44.023

我使用 NAnt 构建脚本来部署到我的不同环境。我让它通过 XPath 修改我的配置文件，具体取决于它们被部署到的位置，然后它使用[Beyond Compare](http://www.scootersoftware.com)自动将它们放入该环境中。

设置需要一两分钟，但您只需执行一次。然后批处理文件接管，而我去拿另一杯咖啡。:)

[这是](http://codeclimber.net.nz/archive/2007/02/21/Change-config-file-with-NAnt.aspx)我在上面找到的一篇文章。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-20T15:24:55.960

在一个项目中，我们有 4 个环境（开发、测试、登台和生产），我们开发了一个系统，应用程序根据部署到的机器名称选择适当的配置。

这对我们有用，因为：

*   管理员可以在不涉及开发人员的情况下部署应用程序（要求），也不必摆弄配置文件（他们讨厌）；
*   机器名称遵循约定。我们使用正则表达式匹配名称并部署到环境中的多台机器上；和
*   我们对连接字符串使用了集成安全性。这意味着我们可以在设计时将帐户名保留在配置文件中，而不会泄露任何密码。

在这种情况下，它对我们很有效，但可能不会在任何地方都有效。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-20T14:45:14.993

企业库配置编辑器可以帮助您做到这一点。它允许您创建一个基本配置文件，然后为每个环境创建增量。然后，您可以合并基本配置和增量以创建特定于环境的 web.config。看看[这里](http://msdn.microsoft.com/en-us/library/dd139945.aspx)的信息，它比我能更好地帮助你完成它。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-20T14:52:53.200

您也可以将其作为后期构建步骤。除了调试和发布之外，设置一个“部署”的新配置，然后将构建后的步骤复制到正确的 web.config 上。

我们对所有项目都使用自动构建，并且构建脚本会更新 web.config 文件以指向正确的位置。但是，如果您从 VS 做所有事情，那将无济于事。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-20T15:13:03.270

这是使用 machine.config 的巨大好处之一。在我上一份工作中，我们有开发、测试和生产环境。我们可以将 machine.config 用于连接字符串（到适当的 dev/test/prod SQL 机器）之类的东西。

如果您无法访问实际的生产机器（例如，如果您在共享主机上使用托管公司），这可能不是您的解决方案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-12-04T08:58:45.237

您还可以使用扩展“配置转换”的工作方式与“SlowCheetah”相同，

# c# - WINMOBILE 将文件从 C# 上传到 php webservice

> ID：305449
> 
> 赞同：3
> 
> 时间：2008-11-20T14:31:49.997
> 
> 标签：c#, php, windows-mobile, compact-framework

我需要使用 C# 将文件从 Windows 移动应用程序上传到网站。它在另一端将 PHP 作为 web 服务运行，但我想如果有另一种方法可以将文件放在那里，它真的不必这样做。但是，没有服务器端 ASP 支持。我的问题真的不是 PHP，而是移动 C# 代码。

此外，紧凑框架中不存在**System.net.WebClient ，所以不幸的是，那个简单的解决方案已经不存在了。**

让我提前道歉，因为我知道这是一个比较常见的问题，但我似乎无法找到答案。我在这个没有解决方案的特定问题上花费了不合时宜的时间，所以任何帮助都将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T14:40:36.423

查看这篇文章[使用 MSDN 中的 HttpWebRequest 和自定义 ASP.NET 提供程序改进 .NET Compact Framework HTTP 通信](http://msdn.microsoft.com/en-us/library/aa446517.aspx)。它特定于 ASP 技术，但 Compact Framework 保持不变。基本上它使用带有 PUT 方法的 HttpWebRequest。如果服务器不允许这样做，则需要自己创建一系列 POST 请求并相应地处理它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-19T07:33:34.133

下面的代码片段可能有助于解决我们在这里讨论的问题。如果它与本主题无关，请忽略它。

简要说明如何使用文章或代码。类名、方法和属性、任何技巧或提示。

代码块应设置为“格式化”样式，如下所示：

示例代码

```
using System.Data;
using System.Data.Sql
using System.Data.SqlClient;
using System.Web;
using System.Web.Services;

public class FileUploader: System.Web.Services.WebService {
     SqlConnection myConnection = new SqlConnection("Data Source=server name ;Initial Catalog=database name; User ID=username; Password='password';");
     SqlCommand myCommand = new SqlCommand();
     string queryString = "";

public string UploadFile(byte[] f, string fileName)
  {
             // the byte array argument contains the content of the file
            // the string argument contains the name and extension
           // of the file passed in the byte array

string nm = data[0];
string sn =data[1];
string bn =data[2];
string st = data[3];
byte img = Convert.Tobyte(img);
myConnection.Open();
queryString = "INSERT INTO tablename(Name,SchemeName,BeneficiarName,Status,Photo)"

+ "VALUES('" + nm + "','" + sn + "','"+ bn +"','" + st + "',@img,')";

myCommand.Parameters.AddWithValue("@img",f);
myCommand.Connection = myConnection;
myCommand.CommandType = CommandType.Text; myCommand.CommandText = queryString; int res = myCommand.ExecuteNonQuery(); myConnection.Close();

if (res > 0)
{
   strres = "File Uploaded successfully"; }

else
{ 
   strres = "File not uploaded";
}
 return strres;
} 
```

要求

视觉工作室.Net 2005

.Net 框架 2.0

MS SQL Server 2000 数据库或 MS SQL Server 2005 数据库。

# ssas - 如何查看 MS SSAS 2005 会话和查询

> ID：305457
> 
> 赞同：3
> 
> 时间：2008-11-20T14:34:41.723
> 
> 标签：ssas, mdx, olap, msas

在 Microsoft SQL Server Analysis Services 2005 中浏览多维数据集时，我想看看由 Excel 等客户端访问工具生成的 MDX（据说）查询。有没有一种工具或方法可以让我做到这一点？

我真的在寻找像 Oracle 的 v$sessions 之类的东西——我知道 sp_who 和 sp_who2 用于关系 SQL Server，但是否有用于 MSAS 的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-21T15:33:07.690

使用 SQL Server Profiler - 它可以连接到 Analysis Services... 创建跟踪时，请确保单击“显示所有事件”并捕获“执行 MDX”事件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T05:40:30.550

如果您想查看会话，您可以进行 DISCOVER_SESSIONS xmla 调用，但这会发回 XML 结果。要获得表格结果，您可以使用[ASStoredProcedure 项目中的 DMV 函数](http://www.codeplex.com/asstoredprocedures)

然后您可以执行以下操作：

```
call ASSP.DMV("SELECT * FROM $System.DISCOVER_SESSIONS"); 
```

SSAS 2008 具有对 DMV 的本机支持，因此您可以执行以下操作：

```
SELECT * FROM $System.DISCOVER_SESSIONS 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T14:26:45.623

我记得几年前在这些方面做了一些事情。我不确定 Analysis Services 是否会实际记录它使用的 MDX，但它确实会记录一些内容。我相信您可以右键单击 AS 中的服务器属性，并且有一个选项卡可以告诉它要记录查询的文件。

（对不起，我不能更具体，那是很久以前的事了，现在我还没有AS摆在我面前！）

# language-agnostic - 如何创建站点地图/列表

> ID：305458
> 
> 赞同：0
> 
> 时间：2008-11-20T14:34:43.143
> 
> 标签：language-agnostic, sitemap, depth-first-search

我需要创建一个站点地图/列表，但我也需要显示链接名称。

我的意思是，例如 www.google.com，我需要创建以下列表。

```
Google - www.google.com
Images - http://images.google.com/imghp?hl=en&tab=wi
...
My Account - http://images.google.com/imghp?hl=en&tab=wi
    Personal Information Edit - https://www.google.com/accounts/EditUserInfo
    ...
    My Products - https://www.google.com/accounts/EditServices
...
Privacy - http://www.google.com/intl/en/privacy.html
... 
```

该列表需要绑定到域，例如 us.example.com。

我尝试使用 python 脚本进行深度优先搜索，并使用 Beautiful Soup 来解析链接。这是不成功的。

有人对他们将如何做有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-11-15T22:09:42.170

一个非常简单的站点地图可以是一个名为

```
sitemap.txt

http://website.com/index.php
http://website.com/about.php
http://website.com/blog.php 
```

如果您需要为所有链接“抓取”您自己的网站，您可能以错误的方式设置您的网站:(

在大多数语言中，您可以尝试文件/方向迭代，如果您使用数据库，它应该更容易，因为您可以通过稍微调整创建 url 的方式来一次重现所有链接以输出 sitemap.txt (或者如果你有超过 50 / 100 个 URL，你可能想要生成一个 XML）

如果您在创建文件迭代器方面需要帮助，您可能想提供更多关于哪种语言最适合您的信息，因为如果您用 python 编写所有内容，一个体面的 PHP 解决方案可能根本没有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T23:59:33.097

1.  转到 XML 站点地图构建器
2.  输入您网站的主页路径（例如 www.mydomain.com）
3.  输入您网站的更改频率（说实话；）
4.  其余部分保持原样，然后单击开始让该工具制作您的站点地图
5.  完成后，下载压缩的 XML 站点地图版本 (.gz) 并将其复制到您的根文件夹
6.  您可以使用您选择的文本编辑器打开文件并更改您认为的文档的优先级。您可以使用 0.1 到 0.9 之间的值，但请注意，只为真正重要的站点赋予更高的值。
7.  以下内容非常重要，以便所有搜索引擎机器人都知道您拥有站点地图。创建一个名为的新文件

[来源：[如何在 5 分钟内创建 Google 站点地图]](http://www.knowtebook.com/seo-how-to-create-a-google-sitemap-in-5-minutes-1022.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-28T15:40:33.580

如果您正在寻找一个自动化的网络服务来为您创建站点地图，您可以使用以下一些：

1.  [http://www.web-site-map.com/xml_sitemap.php](http://www.web-site-map.com/xml_sitemap.php)
2.  www.xml-sitemaps.com
3.  www.sitemapdoc.com

您也可以在这里找到服务列表： [https ://code.google.com/p/sitemap-generators/wiki/SitemapGenerators](https://code.google.com/p/sitemap-generators/wiki/SitemapGenerators)

祝你好运！

# java - Java（桌面）应用程序的“自动更新”？

> ID：305461
> 
> 赞同：28
> 
> 时间：2008-11-20T14:35:16.467
> 
> 标签：java, plugins, desktop-application, auto-update

你推荐什么系统来为一些java（桌面）应用程序实现“自动更新”？我还想要模块/插件安装和更新。想想 Eclipse 和 Firefox。

我知道 Eclipse RCP 的 OSGi 东西，而且 NetBeans RCP 也有一些东西。是否必须完全购买他们各自的 RCP 产品才能使用他们的模块和自动更新系统？

还有其他选择吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-20T14:42:32.317

您看过[Java Web Start](http://docs.oracle.com/javase/1.5.0/docs/guide/javaws/developersguide/faq.html)吗？它检查服务器上的更新模块并仅在需要时下载它，否则内容会缓存在客户端 PC 上本地并从那里开始。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-20T16:49:37.380

我相信 install4J 现在提供此功能作为其安装构建器的一部分（[http://www.ej-technologies.com/products/install4j/overview.html](http://www.ej-technologies.com/products/install4j/overview.html)）我们一直想检查它但还没有机会然而。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-20T15:49:23.010

如果您不经常更新和良好的带宽，Web Start 非常棒。

如果没有，但是，你需要别的东西。我在一个项目中工作，我们经常更新和可怕的带宽。我们推出了自己的类文件服务器；启动代码将与服务器对话，以查看是否需要基于每个类进行更新。如果是这样，则下载更改的类并且应用程序正常继续。

它实际上并不是非常复杂，所以如果现有工具不起作用，请不要害怕自己推出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T12:09:09.077

看看[Equinox p2](http://wiki.eclipse.org/Equinox_p2)，这可能是您所说的“Eclipse RCP 的 OSGi 东西”的意思... AFAIK，您*需要*OSGi 化您的应用程序才能使用 p2 （这至少意味着使您的整个应用程序成为一个大捆绑包）。

# sql - 在 SQLServer 2005 中设置和重置 DATEFORMAT

> ID：305462
> 
> 赞同：6
> 
> 时间：2008-11-20T14:35:16.747
> 
> 标签：sql, sql-server, sql-server-2005, tsql, datetime

有没有办法查询当前 DATEFORMAT SQLServer 2005 当前与 T-SQL 一起使用？

我有一个应用程序可以读取预先生成的 INSERT 语句并针对数据库执行它们。为了使插入的数据与文化无关，我存储了以不变文化 (月/日/年...) 表示的日期时间值。数据库服务器可能在不同的语言环境下运行，具体取决于系统语言环境（可能使用日/月/年），因此插入可能会因为无法解析日期时间而崩溃。

我知道 T-SQL 中有“SET LANGUAGE”和“SET DATEFORMAT”语句来设置要使用的语言环境。
我不想使这些更改永久化（它们是永久的吗？），所以我正在寻找一种从数据库中读取 DATEFORMAT 的方法，将其存储，将格式更改为我喜欢的格式，然后将其重置为存储的值数据已插入。

有什么想法可以在服务器中找到该值吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-01-20T13:19:53.587

以下语句将使用给定的日期格式（@dateFormat 变量）执行日期解析操作，然后重新启用原始日期格式。

```
declare @dateFormat nvarchar(3);
set @dateFormat = 'dmy';

declare @originalDateFormat nvarchar(3);
select @originalDateFormat = date_format from sys.dm_exec_sessions where session_id = @@spid;

set dateformat @dateFormat;

--Returns 1.
select isdate('31/12/2010');

set dateformat @originalDateFormat; 
```

请注意，日期格式更改仅适用于当前连接。重新启用原始日期格式只是为了确保以后在同一连接上执行的语句不受此更改的影响。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-20T14:45:40.453

Set Language 和 Set DateFormat 仅影响当前会话。如果您从数据库断开连接并再次连接，则语言和日期格式将设置回它们的默认值。

您可以使用一个“技巧”来确定 DateFormat 是 m/d/y 还是 d/m/y。

```
Select DatePart(Month, '1/2/2000') 
```

无论哪种方式，这个日期都是有效的。现在是 1 月 2 日或 2 月 1 日。如果此查询返回 1，那么您有 MDY。如果它返回 2，则您有 DMY。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-21T05:00:25.907

sys.dm_exec_sessions 中的 date_format 列呢？

您始终可以查看自己的会话，因此不需要服务器级别的权限

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T14:46:23.510

如果还不算太晚，请将您的日期作为 YYYYMMDD 提交到 SQL Server，无论 DMY 或 MDY 日期格式设置如何，它们都将始终正确插入

SET DATEFORMAT 也不是永久性的。以我的经验，它会影响那个特定的连接。有人说只有会话，但我发现如果连接返回到池并在丢失之前重新使用，那么它会保留以前用户设置的日期格式设置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-17T14:31:21.287

我找到了一种在其他地方的用户选项表中获取此信息的方法，并将其转换为仅获取日期格式。它可能对其他人有用（注意它们是同一张表中的各种其他设置，因此您可以检查是否设置了 ansi_nulls 以及其他各种相同的方式）：

```
create table #temp (SetOption nvarchar(50),Val nvarchar(50))

insert into #temp
exec sp_executesql N'dbcc useroptions'

select val from #temp where setoption='dateformat'

drop table #temp 
```

# asp.net - 有没有办法让 DetailsView 控件在单元格中呈现其 HeaderText？

> ID：305464
> 
> 赞同：1
> 
> 时间：2008-11-20T14:35:38.353
> 
> 标签：asp.net

由于 DetailsView 对标题文本和数据都使用 <td> 单元格，我想知道是否可以覆盖控件的行为以呈现 <th> 单元格中每一行的 HeaderText？

* * *

@Joel Coehoorn 感谢您的快速回复，但我有点希望我不必走那条路。

我想知道是否可以覆盖其中一种控件渲染方法来实现这一点？

有人似乎[已经成功渲染了 <th> 单元格](http://forums.asp.net/p/985785/1270559.aspx)，但似乎没有透露细节 - 任何其他建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T15:20:46.000

我设法通过使用 ItemCreaed 事件处理程序并将 <td> 单元格交换为 <th> 单元格来解决此问题，如下所示：

```
if (view.Rows.Count > 0) {
    // swap each header <td> cell for a <th> cell
    foreach (DetailsViewRow row in view.Rows) {
        if (row.RowType == DataControlRowType.DataRow) {
            DataControlFieldCell td = row.Cells[0] as DataControlFieldCell;
            // skip the last row that contains our command controls
            if (td.Controls.Count > 0) {
                continue;
            }

            DataControlFieldHeaderCell th = new DataControlFieldHeaderCell(td.ContainingField);
            th.Text = td.Text;
            th.Attributes.Add("scope", "row");

            // add the new th and remove the old td
            row.Cells.RemoveAt(0);
            row.Cells.AddAt(0, th);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T14:38:55.117

控件本身没有内置选项。但是，您可以使用[Control Adapter](http://msdn.microsoft.com/en-us/library/system.web.ui.adapters.controladapter.aspx)完全覆盖任何控件（包括 DetailsView）的呈现行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T15:21:30.630

您还可以从 DetailsView 继承您自己的自定义控件，然后覆盖 render 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-19T20:26:28.557

从 DetailsView 继承并粘贴代码。这消除了重新创建标题单元格的需要（如 Ian 的回答中所建议的）

```
protected override void InitializeRow(DetailsViewRow row, DataControlField field)
{
        if (row.RowType == DataControlRowType.DataRow && field.ShowHeader)
        {
            DataControlFieldCell cell = new DataControlFieldHeaderCell(field);
            field.InitializeCell(cell, DataControlCellType.Header, row.RowState, DataItemIndex);
            row.Cells.Add(cell);
            cell = new DataControlFieldCell(field);
            field.InitializeCell(cell, DataControlCellType.DataCell, row.RowState, DataItemIndex);
            row.Cells.Add(cell);
        }
        else base.InitializeRow(row, field);
} 
```

# smtp - 为 Windows 构建基本 SMTP 服务器的高级要求是什么？

> ID：305475
> 
> 赞同：0
> 
> 时间：2008-11-20T14:38:42.620
> 
> 标签：smtp

我知道 Windows 在 IIS 下具有 SMTP 功能，但我认为基本的 SMTP 将是学习 Windows 应用程序开发的好项目。我不要中继。我想要一个真正的 SMTP 服务器，它将匿名从本地主机发送电子邮件。显然，它仅用于路由在开发过程中发送的电子邮件，我真的很想知道我遇到了什么。

1.  VB.net 会是最常见的方法吗？
2.  是否可以匿名路由电子邮件（没有用户名/密码）？
3.  我需要考虑哪些细节？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T14:41:49.883

您需要了解 SMTP 协议（​​或至少是其中的一个合理子集）。如果您熟悉 C++，您可以获取[Blat](http://sourceforge.net/projects/blat)的源代码以了解如何创建一个简单的邮件系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T14:42:22.660

你应该读一本关于网络协议的书。如果你想从头开始，你需要保留一个外发邮件队列，你需要解析电子邮件地址以找到它们的主机名，查找这些域的 DNS MX 记录，在端口 25 上联系服务器，然后使用 SMTP。

# c# - 如何保存 C# 应用程序的状态以便以后加载

> ID：305486
> 
> 赞同：3
> 
> 时间：2008-11-20T14:42:06.560
> 
> 标签：c#, .net

我有一个程序，用户在其中将多个对象添加到场景中。这些对象都表示为一个类。现在我希望用户能够保存场景，以便再次加载它。

是否有一些我可以使用的通用保存方法，或者我是否必须编写自己的方法来保存所有属性的值等，然后创建新对象并在用户再次加载场景时将保存的值插入其中。

/P

编辑：感谢您的快速回复。我现在实际上正在将对象的默认值存储在 SQL compact 3.5 数据库中。因此，如果有人知道如何序列化为 SQL，那将是很好的信息。

编辑2：再次感谢！我将序列化为 xml，然后将其作为字符串存储到 SQL 数据库中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-20T14:45:58.347

假设您的对象具有可用作公共属性的所有值，您可以使用 XMLSerializer 将对象转换为 XML 字符串，然后使用 XMLDeserializer 重新创建对象。

[这里](https://stackoverflow.com/questions/271398/post-your-extension-goodies-for-c-net-codeplexcomextensionoverflow#271423)有一个扩展方法来完成这个。

如果您有私有变量，您仍然可以编写自己的自定义序列化/反序列化方法。

编辑以响应原始问题编辑：

您可以使用任何这些序列化技术将字符串存储到数据库中。另一种选择是使用 ORM（对象关系映射器）来弥合对象和数据库之间的差距。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T14:45:13.980

通常人们会使用数据库来做这种事情。这可能是推荐的做法。

但是，如果您想要一个快速而肮脏的方法，您可以使用相对较少的代码序列化为 Xml 或 Binary。查看 System.Runtime.Serialization 的东西。Xml 或二进制的权衡是版本控制很费时间。

考虑一组 xml 文件，其中包含来自 1.0 应用程序的对象。如果您从 1.0 开始向这些对象添加字段，那么它们将与任何新的 1.1 对象不兼容。要解决这个问题，您必须从类型 1.0 -> 1.1 编写手动更新序列。更糟糕的是，如果您使用自动发现代码（自动序列化），例如 xml 或二进制序列化程序，您甚至可能必须为您的对象命名不同的名称 Product1 / Product1.1 / 等等，要么就是这样，要么编写您自己的序列化代码。

如果您的应用程序开始接近任何严重程度，我会说您可能想要使用数据库。SqlLite 对于 1 个用户的应用程序来说非常好和简单，任何更大的应用程序，你都需要一个合适的 RDBMS。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T14:46:38.610

您需要查看 .NET 序列化，这是一个很大的话题。[这是一个入门教程。](http://blog.paranoidferret.com/index.php/2007/04/27/csharp-tutorial-serialize-objects-to-a-file/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T14:49:52.737

您还可以查看[db4o](http://www.db4o.com/about/productinformation/)，它是一个简单的对象数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-18T23:26:29.440

.NET 序列化是执行此操作的最简单方法，尽管如前所述，版本控制可能是一个问题。这可能不是一个大问题，具体取决于您的对象有多复杂。您的序列化/反序列化逻辑需要足够智能，以处理缺少属性的情况，或者对旧版本序列化的序列化对象中不存在的新属性具有默认行为。主要是通过捕获 SerializationExceptions 并在那里处理它们来处理。

我认为您也会遇到数据库的这个问题 - 除了我猜它会通过您用来将现有数据库迁移到最新版本的任何方法来处理（即向 RDBMS 表添加新列或向 ODBMS 对象添加新列） .

# c# - 如何以编程方式在 Access 中附加 DBF 文件？

> ID：305487
> 
> 赞同：2
> 
> 时间：2008-11-20T14:42:11.600
> 
> 标签：c#, ms-access, dbf

Access 可以打开 DBF (dBase) 文件，但不是将数据物理转换为 MDB 格式，而是能够链接到 DBF 表本身。这样，DBF 就“链接”到了 MDB。

是否可以使用 C# 以这种方式附加 DBF 文件？

**编辑**：我想使用 Jet 并避免直接使用 MS Access。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T15:14:47.383

[可能来自如何在 C# 项目中将表从 ODBC 源快速复制到 MS Access 中的](http://cookingwithcsharp.blogspot.com/2007/11/how-to-quickly-copy-tables-from-odbc.html)这段代码可能会有所帮助：

> 您需要放入 MS Access 的 VB 函数非常简单，基本上通过传递 DSN（指向源数据库）、源表名和目标表名来调用 TransferDatabase 方法。代码如下：

```
Public Function Import(dsnName As String, sourceTableName As String, targetTableName As String)
‘ if the table already existsm, delete it.
   On Error GoTo CopyTable
   DoCmd.DeleteObject acTable, targetTableName
CopyTable:
   DoCmd.TransferDatabase _
   acImport, _
   "ODBC Database", _
   "ODBC;DSN=" + dsnName, _
   acTable, _
   sourceTableName, _
   targetTableName
End Function 
```

将 VBA 更改为读取 acLink 而不是 acImport 应该允许链接。

> 然后是 C# 代码：

```
object accessObject = null;
try
{
   accessObject = Activator.CreateInstance(Type.GetTypeFromProgID("Access.Application"));

   accessObject.GetType().InvokeMember(
      "OpenCurrentDatabase",
      System.Reflection.BindingFlags.Default  System.Reflection.BindingFlags.InvokeMethod,
      null,
      accessObject,
      new Object[] { "AccessDbase.mdb" });

   accessObject.GetType().InvokeMember(
      "Run",
      System.Reflection.BindingFlags.Default  System.Reflection.BindingFlags.InvokeMethod,
      null,
      accessObject,
      new Object[] { "Import", "DSN Name", "Source table name", "Target table name" });

   accessObject.GetType().InvokeMember(
      "CloseCurrentDatabase",
      System.Reflection.BindingFlags.Default  System.Reflection.BindingFlags.InvokeMethod,
      null,
      accessObject,
      null);

   MessageBox.Show("Copy succeeded.");
}
catch (Exception ex)
{
   string message = ex.Message;
   while (ex.InnerException != null)
   {
      ex = ex.InnerException;
      message += "\r\n----\r\n" + ex.Message;
   }
   MessageBox.Show(message);
}
finally
{
   if (accessObject != null)
   {
      System.Runtime.InteropServices.Marshal.ReleaseComObject(accessObject);
      accessObject = null;
   }
} 
```

**编辑重新评论**

我对 c# 无能为力，但这里有一些 VBScript 将表从一个 MDB 链接到另一个。

```
strLinkFile = "C:\Docs\Link.mdb"
strAccessFile = "C:\Docs\LTD.mdb"

'Create Link... '
Set cn = CreateObject("ADODB.Connection")
cn.Open "Provider=Microsoft.Jet.OLEDB.4.0;" & _
       "Data Source=" & strAccessFile & ";" & _
       "Persist Security Info=False"

Set adoCat = CreateObject("ADOX.Catalog")
Set adoCat.ActiveConnection = cn

Set adoTbl = CreateObject("ADOX.Table")

Set adoTbl.ParentCatalog = adoCat
adoTbl.Name = "LinkTable"

adoTbl.properties("Jet OLEDB:Link Datasource") = strLinkFile
adoTbl.properties("Jet OLEDB:Link Provider String") = "MS Access"
adoTbl.properties("Jet OLEDB:Remote Table Name") = "Table1"
adoTbl.properties("Jet OLEDB:Create Link") = True

'Append the table to the tables collection '
adoCat.Tables.Append adoTbl 
```

修改自： http: [//support.microsoft.com/kb/240222](http://support.microsoft.com/kb/240222)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-21T04:36:59.027

这只是一个建议，但是如何从 Access 链接到 DBF，然后查看 Access 用于获取数据的连接字符串。为此，要单独使用 Jet，您必须拥有 Access 用于访问 xBase 数据的 ISAM。不过，我不确定这是 Access 组件还是 Jet 组件。

这是我在使用 Access 97 链接到 DBF 时得到的连接字符串（结果与 Access 2003 相同）：

```
dBase IV;HDR=NO;IMEX=2;DATABASE=C:\Path 
```

在 MSysObjects 表中，它位于 CONNECT 列中，而 dbf 文件名位于 DATABASE 列中。指向 Jet 数据的链接在 CONNECT 列中没有任何内容，并且仅在 DATABASE 列中，但是作为指向另一个 MDB 中 Jet 表的链接的 tabledef 的 .Connect 属性与 Database 列中的相同。

因此，我不确定您将提供什么作为连接字符串，但[ConnectionStrings.com](http://www.connectionstrings.com/?carrier=dbffoxpro)有建议。但是，那些不使用 Jet 来访问数据，所以我只是不确定你会使用什么。

# linq - 有行时使用 LINQ 从列名中获取列值？

> ID：305491
> 
> 赞同：0
> 
> 时间：2008-11-20T14:42:55.577
> 
> 标签：linq, dataset

我正在尝试将一些使用数据集的代码转换为 LINQ。一些代码将列名作为字符串传递给其他函数。

无论如何我可以轻松地将其重写为 LINQ 吗？

```
string s = getElement(tr, elementName);

private string getElement (tableRow re, string elementName){
    if(tr[elementName] != null){
       return tr[elementName].toString()
    }
} 
```

或者：

```
private void copy (tableRow trFrom, tableRow trTo){
   foreach (DataColumn c in trFrom.Table.Columns) {
        trTo[c.ColumnName] = trFrom[c.ColumnName];
   }
} 
```

对 GVS 的回答：转换为 LINQ 的原因是因为它在许多情况下更容易编写 LINQ 并获得更好的性能。它与stackoverflow上的另一个问题有关： [使用类型化数据集的编程模式](https://stackoverflow.com/questions/295291/programming-pattern-using-typed-datasets-in-vs-2008)

我需要将列名用作字符串的原因主要是因为列名作为输入字段的 ID 传递，然后使用 AJAX (jquery) 将它们发送回程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T15:06:52.767

1.  **简单的方法**

    1.1。**使用 IEnumerable**（Linq to Objects 或类似）更改 Func 的 elementName 参数并改为传递 lambda（您还将获得编译时检查！）

    1.2\. **使用 IQueryable** (Linq to SQL 或类似) 相同，但使用 Expression> 代替。

2.  **复杂方式：** 如果由于某种原因需要将参数保留为字符串（可能是用户引入的）您可以使用反射在运行时构建表达式树[http://msdn.microsoft.com/en-us/library/ system.linq.expressions.expression.aspx](http://msdn.microsoft.com/en-us/library/system.linq.expressions.expression.aspx)。

    2.1。**使用 IEnumerable**然后编译，并将其用作 where 中的参数，选择...

    2.2\. **使用 IQueryable**将其用作 where、select、

如果您需要将 lambda 与其他 lambda 组合使用这个很酷的技术[http://tomasp.net/blog/linq-expand.aspx](http://tomasp.net/blog/linq-expand.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T11:47:36.280

答案是使用反射。

获得价值

```
private string getElement (tableRow tr, string element){
    string val = "";
    try
    {
        val = tr.GetType().GetProperty(element).GetValue(tr, null).ToString();
    }
    catch //NULL value
    {
        val = "";
    }
} 
```

或者复制场景：

```
foreach (PropertyInfo c in tr.GetType().GetProperties())
{
    thr.GetType().GetProperty(c.Name).SetValue(thr,
         tr.GetType().GetProperty(c.Name).GetValue(tr, null), null);
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-20T15:06:32.237

为什么要使用 LINQ 将工作和清晰的代码转换成某种东西？

编辑：LINQ 很好，很酷。但是不要像许多 XML 爱好者（特别是第一适配器）那样犯同样的错误，把它应用到所有东西上。

# dns - 是否可以找到给定域名的所有 DNS 子域？

> ID：305495
> 
> 赞同：21
> 
> 时间：2008-11-20T14:44:49.380
> 
> 标签：dns

> 这个问题的存在是因为它具有历史意义，但它不被认为是本网站的一个好的、主题性的问题，所以请不要将它作为你可以在这里提出类似问题的证据。
> 
> 更多信息：[https ://stackoverflow.com/faq](https://stackoverflow.com/faq)

任何人都知道是否可以找到为域名配置的所有 A 记录、CNAME 或子区域记录？

例如，domain.com：

```
www IN CNAME domain.com.
subdomain1 IN CNAME domain.com.
subdomain2 IN CNAME domain.com. 

subdomain1 IN A 123.4.56.78.
subdomain2 IN A 123.4.56.79\. 
```

我想保持一个子域私有，我将在其中运行一个管理应用程序（它将受密码保护并在一个特殊的端口上，但我希望尽可能保持私有）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-20T15:00:26.400

正如其他人所说，您想要的是所谓的区域转移。如果它是您自己的域，您可以配置 DNS 服务器以将其提供给您。如果它是针对其他域的，您可能不会得到它，因为大多数 DNS 管理员认为它是一种安全威胁。

即使单个记录不是问题（因此 DNS 就是这样），如果一个邪恶的人获得了您所有记录的列表，它也可能是一个问题：它可以简化攻击。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-20T14:49:07.763

使用区域传输，即：（在 nslookup 中）

ls -d google.com

如果您有自己的 DNS 服务器，则会有区域传输安全设置（通常通过 IP）。否则，只需尝试一下，看看它是否有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T14:45:41.653

它曾经是可能的：

```
host -a -l domain.com 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-26T15:59:52.813

防止区域传输是服务器管理的一项功能，正如其他人所说，这些天出于安全原因通常禁用。

添加 DNSSEC 时，请确保使用新`NSEC3`格式记录（来自[RFC 5155](http://tools.ietf.org/rfcmarkup?doc=5155)）而不是原始`NSEC`格式，因为后者允许区域枚举。

请注意，防止区域枚举实际上只是安全性通过默默无闻。如果有人找到您的子域，您仍然需要在应用程序层提供额外的安全性。

至于您的示例记录：

```
www IN CNAME domain.com.
subdomain1 IN CNAME domain.com.
subdomain2 IN CNAME domain.com. 
subdomain1 IN A 123.4.56.78.
subdomain2 IN A 123.4.56.79. 
```

1.  您不能在同一实体中混合 CNAME 记录和其他 RRtypes
2.  A 记录中的尾随点无效
3.  最好不要使用 CNAME 回域进行 WWW 记录

你需要：

```
$ORIGIN domain.com
@      IN SOA ...
       IN A   123.4.56.78
www    IN A   123.4.56.78
sub1   IN A   123.4.56.79 
```

（`sub1.domain.com`隐藏站点在哪里）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-10-04T17:24:15.220

如果名称服务器允许区域传输，您可以使用此页面[http://www.magic-net.info/dns-lookup.dnslookup](http://www.magic-net.info/dns-lookup.dnslookup)查找给定区域中的所有子域。

10 月 15 日 我已经修改了我的工具。现在它会检查前 6 个名称服务器的区域传输，如果没有人允许区域传输，则使用搜索引擎[反向查找和子域搜索](http://www.magic-net.info/dns-and-ip-tools.dnslookup)

# c# - 在gridview的查询字符串中传递“calendar.selectedvalue”

> ID：305509
> 
> 赞同：1
> 
> 时间：2008-11-20T14:46:32.637
> 
> 标签：c#, asp.net

我想将一页中的 from 传递到另一页中的另一页`calendar1.Selecteddate`（`query string`我已经写过）。如下面的代码所示，我尝试传递它，但这不起作用。谁能告诉我如何从in传递选定的日期`gridview``gridview``sqlquery``gridview``calendar``query string`

```
 <asp:HyperLinkField DataNavigateUrlFields="LocalIP" 
                DataNavigateUrlFormatString="DailyResults.aspx?
           Terms={0}&column=LocalIP&    
               startdate=Calendar1.SelectedDate.Date.Date.ToShortDateString()
                DataTextField="LocalIP" HeaderText="User" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T18:47:14.710

一种解决方案是在代码隐藏中构建您的 URL 字符串，而不是在标记中构建它。

覆盖 GridView 上的 RowDataBound 方法并以编程方式构建超链接：

```
protected override gv1_RowDataBound(object sender, GridViewRowEventArgs e)
{
  HyperLink hl = new Hyperlink();
  hl.NavigateUrl = string.Format("DailyResults.aspx?Terms={0}&column=LocalIP&startdate={1}", localIp, Calendar1.SelectedDate.Date.Date.ToShortDateString());
  .. set other hyperlink fields ..
  e.Row.Cells[1].Controls.Add(hl);
} 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T15:21:38.133

在您提供的示例中，它将字符串的日历部分视为文字并传递您输入的确切值。为了使用您获取数据，您需要执行以下操作：

```
<asp:HyperLinkField DataNavigateUrlFormatString="<%=GetSelectedDate()%>.... 
```

这是在代码后面的类（或者您可以使用属性）上创建您想要的字符串的方法，包括 LocalIP 绑定数据字段的 {0} 占位符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T15:26:27.487

我假设自从呈现 gridview 以来，日历选择的值没有改变。

```
<asp:HyperLinkField DataNavigateUrlFields="LocalIP" 
     DataNavigateUrlFormatString='<%# "DailyResults.aspx?Terms={0}&column=LocalIP&startdate=" + Calendar1.SelectedDate.Date.Date.ToShortDateString() %> DataTextField="LocalIP" HeaderText="User" /> 
```

# servlets - 未注入时如何关闭 EnityManager？

> ID：305514
> 
> 赞同：1
> 
> 时间：2008-11-20T14:48:25.190
> 
> 标签：servlets, jpa, jakarta-ee, ejb

我有一个在 Oracle OCCAS 服务器中运行的 servlet。目前，我使用@Entity 注释将数据库中的一些数据映射到我的应用程序中的实体类。不过，我无法注入 EntityManager (@PersistenceContext)，据我了解，这是因为它在我的 servlet 上下文中运行，而不是作为单独的实体 EJB 运行。但是，通过 EntityManagerFactory 创建管理器是可行的，所以这就是我目前使用的。

现在，在多次重新启动应用程序后，我得到了 PermGen 空间不足的错误。我认为这与某种持久性有关。在我的 finalize 方法中有一个对 EntityManager.close() 的调用，但它从未出现在日志中。

这是一种糟糕的做事方式 - 我是否“需要”拥有一个单独的实体 Bean，或者我应该如何清理 EntityManager？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T15:45:14.263

我有一个类似的问题，并使用 ThreadLocal 和一个 servlet 过滤器解决了它。

[这是我博客上的一篇文章，详细说明了您需要做什么](http://www.naildrivin5.com/daveblog5000/?p=39)；基本上，您的 servlet 过滤器设置实体管理器，然后在 servlet 调用完成后将其关闭；它使实体管理器可用作线程局部变量（根据休眠的建议）。您还需要在过滤器中捕获异常并进行回滚。

顺便说一句，finalize 不能保证以您认为的方式调用。 `finalize` *应该*在 JVM 退出之前调用，但除此之外，可能需要很长时间。

# .net - 在单独的进程中运行 .net 代码

> ID：305519
> 
> 赞同：2
> 
> 时间：2008-11-20T14:49:15.407
> 
> 标签：.net, concurrency, process

在与 Sharepoint 相关的模拟场景中，我需要在单独的进程中执行一些代码（该进程将在某个用户的上下文中运行）。我不想启动一个单独的应用程序，基本上我只想在一个方法上做一个“运行方式”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T15:03:45.520

我自己没有尝试过，但这[似乎](http://michiel.vanotegem.nl/Permalink,guid,36633846-2eca-40fe-9957-2859d8a244dc.aspx)可以解决问题。

如果您对模拟方法阻止直到它完成它应该工作。所以你的代码会是这样的：

```
...
WrapperImpersonationContext context = new WrapperImpersonationContext(domain, username, password);
context.Enter();

Results res = MyImpersonatedMethod(data);

context.Leave();
... 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T14:54:58.937

“在单独的进程中执行代码”=“启动单独的应用程序”。

我的意思是，你可以启动一个进程，然后向它发出请求以运行特定的方法……但不清楚这是否是你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T15:15:34.963

如果您有适当的用户、密码和域，Process.Start 方法具有启动进程的重载。

您要做的是创建一个 ProcessStartInfo 对象并在启动进程时指定正确的用户名和密码。所以你可以做这样的事情：

```
Dim psiNewProcess As New ProcessStartInfo("Notepad.exe")

psiNewProcess.UserName = "MyUserName"
psiNewProcess.Password = "MyPassword"

Process.Start(psiNewProcess) 
```

哦，如果尚未为您的项目导入 Process，则它位于 System.Diagnostics 命名空间中。

编辑：快速旁注，密码字段实际上是 SecureString 类型的对象，因此 MSDN 建议以这种方式填充值：

```
Dim instance As ProcessStartInfo
Dim value As SecureString

value = instance.Password

instance.Password = value 
```

# linux - 在 QT 应用程序中嵌入应用程序（在本例中为终端）

> ID：305523
> 
> 赞同：6
> 
> 时间：2008-11-20T14:50:42.457
> 
> 标签：linux, qt, x11, kde, xterm

我正在编写一个 QT 应用程序，我需要在 QDialog 中嵌入一个终端（我们说，xterm），就像一些 KDE 应用程序（参见 kdevelop/kate/...）。

我一直在尝试： - QX11EmbedContainer 放入我的 QDialog 的 QLayout - 我想要执行的程序的 QProcess

我希望 QProcess 在 QX11EmbedContainer 中运行，但它不起作用。

问题是我无法将 xterm 放入 QX11EmbedContainer，我唯一获得的是一个 xterm 窗口（不幸的是与我的 QDialog 分离）。有人遇到同样的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-21T21:42:05.667

抱歉，我在发布这个网站之前已经尝试过您的解决方案，但它不起作用。我已经解决了切换到 kdelibs 并使用这些导入和这段代码的问题

```
#include <kparts/part.h>
#include <assert.h>
#include <kde_terminal_interface.h>
#include <kpluginfactory.h>
#include <klibloader.h> 
```

* * *

```
KLibFactory* factory = KLibLoader::self()->factory( "libkonsolepart" );
KParts::Part* p = static_cast<KParts::Part*>(factory->create( this,"tralala",         
QStringList() << "dio") );

assert(p);
setCentralWidget( p->widget() );
TerminalInterface *t = qobject_cast<TerminalInterface*>(p);
t->showShellInDir( QDir::home().path() ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-21T03:34:06.813

您需要将容器的窗口 ID 传递给 xterm。

如果您查看 QX11EmbedContainer 的 Qt 帮助中的示例，它只是将窗口 id 传递给 QProcess。将此更改为

```
 QProcess process(&container);
 QString executable(app.arguments()[1]);
 QStringList arguments;
 arguments << "-into" << QString::number(container.winId());
 process.start(executable, arguments); 
```

其中“-into”已添加到参数中。从 XTerm 手册页：

> -进入windowId
> 
> 给定一个 X 窗口标识符（一个十进制整数），xterm 会将其顶级 shell 小部件重新设置为该窗口。这用于在其他应用程序中嵌入 xterm。

# sql-server-2005 - 为什么 SQL Server 2005 动态管理视图报告缺失索引而不报告缺失索引？

> ID：305524
> 
> 赞同：3
> 
> 时间：2008-11-20T14:50:47.713
> 
> 标签：sql-server-2005

我正在使用 SQL Server 2005 和 Dynamic Management View `sys.dm_db_missing_index_details`。它继续告诉我 Table1 确实需要 ColumnX 和 ColumnY 上的索引，但该索引已经存在！我什至放弃并重新创建了几次，但无济于事。

更多细节：视图列出 Column1 下`equality_columns`。Column2 列在 下`inequality_columns`，所以我创建的索引是：

```
create index IndexA on Table1 (Column1 asc, Column2 asc) 
```

这不正是索引`sys.dm_db_missing_index_details`告诉我我需要的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-15T12:31:17.770

随机想法：如果将其中一列更好地声明为“DESC”怎么办？

这对于 ORDER BY 子句很有用，我已经看到逻辑 IO 减少了一半。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-13T17:51:01.820

Though this is quite an old post, I found a useful article on this here [http://www.simple-talk.com/sql/database-administration/fine-tuning-your-database-design-in-sql-2005/](http://www.simple-talk.com/sql/database-administration/fine-tuning-your-database-design-in-sql-2005/) which references a good Microsoft article on the limitations of DMVs [http://msdn.microsoft.com/en-us/library/ms345485.aspx](http://msdn.microsoft.com/en-us/library/ms345485.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-25T01:13:34.257

如果您已经删除并创建了索引， sp_update_stats 不应该影响它（问题不在于统计信息）

也许是因为 DMV 数据已经过时 实际执行计划是否也暗示了 SSMS 中的缺失索引？

来自[在线书籍](http://msdn.microsoft.com/en-us/library/ms345434(SQL.90).aspx)

> sys.dm_db_missing_index_details 返回的信息在查询优化器优化查询时更新，而不是持久化。丢失的索引信息仅保留到 SQL Server 重新启动。如果数据库管理员希望在服务器回收后保留丢失的索引信息，则应定期对丢失的索引信息进行备份。
> 
> 要确定特定缺失索引属于哪些缺失索引​​组，您可以通过基于 index_handle 列将其与 sys.dm_db_missing_index_details 等值连接来查询 sys.dm_db_missing_index_groups 动态管理视图。

# java - 如何在 Swing 中禁用容器及其子项

> ID：305527
> 
> 赞同：16
> 
> 时间：2008-11-20T14:52:50.563
> 
> 标签：java, swing

我想不出在 Swing 中禁用容器及其子项的方法。Swing 真的缺少这个基本功能吗？

如果我在容器上执行 setEnabled(false)，它的子级仍处于启用状态。

我的 GUI 结构非常复杂，遍历容器下方的所有元素不是一种选择。容器顶部也不是 GlassPane（容器不是整个窗口）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-20T15:13:13.487

要添加到[mmyers 的答案](https://stackoverflow.com/questions/305527#305551)，禁用儿童并非易事（请参阅此[线程](http://forums.java.net/jive/thread.jspa?threadID=13758)）

> 在一般情况下，这个问题几乎是无法解决的。这就是为什么它不是核心 Swing 的一部分。
> 
> 从技术上讲，禁用并存储旧状态，然后是启用并恢复到旧状态可能看起来很有吸引力。在特殊情况下，它甚至可能是一个不错的选择。但是有（至少，可能更多）两个问题。
> 
> **复合组件**
> 
> 递归必须在“复合组件”（或“单个实体”）上停止。然后组件负责保持依赖的状态。没有通用的方法来检测这样的组件 - 示例是 JComboBox、JXDatePicker（作为相关[问题](https://swingx.dev.java.net/issues/show_bug.cgi?id=275)）
> 
> 为了使事情变得更加复杂，依赖项不需要位于“复合组件”的层次结构下，fi JXTable 负责 ColumnControl（和标题）的启用状态。
> 
> 试图解决这两个问题都需要
> 
> a) 大院的财产：“不要碰我的孩子”和
> b) 未收容的家属的财产：“不要碰我”
> 
> **绑定到启用**
> 
> 如果启用状态绑定到（演示文稿或其他）模型属性并且该属性同时更改，则启用和更新到旧可能会破坏应用程序状态 - 现在旧状态无效。
> 
> 试图解决这个问题需要
> 
> c) 一个“真实的”stored-old-enabled-due-to-view-concerns 属性
> d) 将表示模型属性绑定到启用和存储旧启用
> 
> JXRadioGroup 有这个问题的一个变种：在禁用时 - 组本身或通用控制器 - 跟踪每个按钮的旧启用。按钮的启用由动作控制 - 如果有动作。所以启用的控制器需要恢复到旧的启用或动作的启用。在组禁用（作为组）期间，如果操作的启用在存储时为假并更改为真，则会出现问题。另一个如果添加了操作。
> 
> 现在想象一下重载时状态转换的复杂性 a)-- d)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-20T15:00:33.777

[根据这篇文章，](http://weblogs.java.net/blog/alexfromsun/archive/2007/06/_enablingdisabl_1.html) [JXLayer](https://jxlayer.dev.java.net/)可能是您正在寻找的东西：

> 用 JXLayer 包裹你的容器，然后调用`JXLayer.setLocked(true)`- 里面的所有组件都将被禁用

[替代文字 http://www.java.net/download/javadesktop/blogs/alexfromsun/2007.06.25/LayerDemo.PNG](http://www.java.net/download/javadesktop/blogs/alexfromsun/2007.06.25/LayerDemo.PNG)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-12-08T12:21:54.327

这是我使用的代码。它递归地访问组件树，为每个组件维护一个计数器。组件上只保留弱引用，防止任何内存泄漏。

你说遍历所有元素不是一种选择，但我的经验是这段代码适用于相当复杂的 GUI。顺便说一句，如果 Swing 本身就有这个特性，那么无论如何，除了遍历组件树之外别无他法。

示例用法（括号表示禁用）：

```
 a
    / \
   b   c
      / \
     d   e

setMoreDisabled(c)

     a
    / \
   b  (c)
      / \
    (d) (e)

setMoreDisabled(a)

    (a)
    / \
   b  (c)
      / \
    (d) (e)

setMoreEnabled(a)

     a
    / \
   b  (c)
      / \
    (d) (e) 
```

现在代码：

```
import java.awt.Component;
import java.awt.Container;
import java.util.Map;
import java.util.WeakHashMap;

public class EnableDisable {

    private static final Map<Component, Integer> componentAvailability = new WeakHashMap<Component, Integer>();

    public static void setMoreEnabled(Component component) {
        setEnabledRecursive(component, +1);
    }

    public static void setMoreDisabled(Component component) {
        setEnabledRecursive(component, -1);
    }

    // val = 1 for enabling, val = -1 for disabling
    private static void setEnabledRecursive(Component component, int val) {
        if (component != null) {
            final Integer oldValObj = componentAvailability.get(component);
            final int oldVal = (oldValObj == null)
                    ? 0
                    : oldValObj;
            final int newVal = oldVal + val;
            componentAvailability.put(component, newVal);

            if (newVal >= 0) {
                component.setEnabled(true);
            } else if (newVal < 0) {
                component.setEnabled(false);
            }
            if (component instanceof Container) {
                Container componentAsContainer = (Container) component;
                for (Component c : componentAsContainer.getComponents()) {
                    setEnabledRecursive(c,val);
                }
            }
        }
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-06T21:05:55.913

这就是我想出的。

```
Component[] comps = myPanel.getComponents();
for (Component comp:comps){
    comp.setEnabled(false);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-26T03:11:56.630

正如 VonC 的回答，不存在简单的解决方案。因此，我建议您从一开始就使用支持基础设施进行编程。

例如，一个简单的基础设施可能是使用委托侦听器，在实际事件响应之前从超级容器的标志执行“事件启用”检查：

```
class ControlledActionListener extends ActionListener {
    ...
    public void actionPerformed( ActionEvent e ) {
        if( !container.isEnabled() ) return;

        doYourBusinessHere();
    }
} 
```

或者更好的是，您可以使用 APT 自动为您注入样板代码。

这一直很好用。这是一次阻止**用户交互和编程调用**的干净方式。尽管支持底层功能需要花费一些代码，但作为回报，您会得到简单性、可用性和稳定性。

*PS。我希望看到这个问题的更好解决方案。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-08T12:13:04.057

我建议您编写一个递归方法，该方法在您的 java.awt.Container 中查找所有 java.awt.Container 实例并将其组件设置为启用/禁用。这就是我在扩展的 JFrame 类中解决此类问题的方法：

```
@Override
public void setEnabled(boolean en) {
    super.setEnabled(en);
    setComponentsEnabled(this, en);
}

private void setComponentsEnabled(java.awt.Container c, boolean en) {
    Component[] components = c.getComponents();
    for (Component comp: components) {
        if (comp instanceof java.awt.Container)
            setComponentsEnabled((java.awt.Container) comp, en);
        comp.setEnabled(en);
    }
} 
```

# wpf - 如何在 WPF 应用程序中更新 appSettings？

> ID：305529
> 
> 赞同：9
> 
> 时间：2008-11-20T14:54:16.740
> 
> 标签：wpf, appsettings

祝福大家！这是我在stackoverflow上的第一个问题。我有一个 WPF 应用程序，正在为我部门的其他开发人员编写，有几个设置需要在启动时检查并在未设置时更新（一个是用户可执行文件的位置电脑，我们都有，只是不在同一个地方）。所以当我的应用程序第一次启动时，我需要弹出一个文件选择器让他们选择位置。

我需要做的就是将它的位置写到 appSettings 中，但我似乎无法得到它，我昨晚非常努力地搜索了谷歌，试图找到一种方法。我看到的大多数答案都涉及将 app.config 文件作为直接 XML 读取，这似乎不对。

所以，我只需要一种方法来更新我的应用程序的 appSettings 中的值。我可以很好地阅读它们，只是还没弄清楚如何给它们写信。非常感谢！

詹姆士

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-20T14:59:30.287

您是否查看过 ConfigurationManager 类？它为 app.config 文件提供了更强大的接口，您可以执行以下操作：

```
Configuration oConfig = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
oConfig.AppSettings.Settings["PreferenceToRemember"].Value = "NewValue";
oConfig.Save(ConfigurationSaveMode.Full);
ConfigurationManager.RefreshSection("appSettings"); 
```

请记住导入`System.Configuration`到您的项目中。默认情况下不添加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T15:05:48.743

看看配置类和[企业库](http://msdn.microsoft.com/en-us/library/cc467894.aspx)。[您可以在此处](http://geekswithblogs.net/akraus1/articles/64871.aspx)找到详细说明。

# java - 将 PNG 转换为双色 TIFF

> ID：305535
> 
> 赞同：2
> 
> 时间：2008-11-20T14:56:08.280
> 
> 标签：java, image-manipulation, javax.imageio

-编辑-仅供参考..我正在将扫描的黑白文档转换为灰度或彩色。

1）第一个解决方案有效，它只是颠倒了黑白（黑色背景，白色文本）。也花了将近10分钟。
2）第二个答案中的 JAI 解决方案对我不起作用。我在这里发布之前尝试过。

有没有人免费使用其他库或付费处理图像处理？

-Original- 我正在尝试使用 Java ImageIO 将 PNG 转换为双色调 TIFF。有没有人幸运地做到这一点？我已经把它从PNG转换为TIFF。我不确定是否需要转换读入的 BufferedImage (PNG) 或在写入时在 TIFF 上进行转换。我已经搜索和搜索但似乎没有任何效果？有没有人建议在哪里看？

这是转换的代码...

```
public static void test() throws IOException {

    String fileName = "4848970_1";
    // String fileName = "color";
    String inFileType = ".PNG";
    String outFileType = ".TIFF";

    File fInputFile = new File("I:/HPF/UU/" + fileName + inFileType);
    InputStream fis = new BufferedInputStream(new FileInputStream(fInputFile));
    ImageReaderSpi spi = new PNGImageReaderSpi();
    ImageReader reader = spi.createReaderInstance();
    ImageInputStream iis = ImageIO.createImageInputStream(fis);
    reader.setInput(iis, true);
    BufferedImage bi = reader.read(0);

    int[] xi = bi.getSampleModel().getSampleSize();

    for (int i : xi) {
        System.out.println("bitsize " + i);
    }

    ImageWriterSpi tiffspi = new TIFFImageWriterSpi();
    TIFFImageWriter writer = (TIFFImageWriter) tiffspi.createWriterInstance();

    // TIFFImageWriteParam param = (TIFFImageWriteParam) writer.getDefaultWriteParam();
    TIFFImageWriteParam param = new TIFFImageWriteParam(Locale.US);
    String[] strings = param.getCompressionTypes();
    for (String string : strings) {
        System.out.println(string);
    }

    param.setCompressionMode(ImageWriteParam.MODE_EXPLICIT);
    param.setCompressionType("LZW");

    File fOutputFile = new File("I:\\HPF\\UU\\" + fileName + outFileType);
    OutputStream fos = new BufferedOutputStream(new FileOutputStream(fOutputFile));
    ImageOutputStream ios = ImageIO.createImageOutputStream(fos);

    writer.setOutput(ios);
    writer.write(null, new IIOImage(bi, null, null), param);

    ios.flush();
    writer.dispose();
    ios.close();

} 
```

我尝试将压缩更改为“CCITT T.6”类型，因为这似乎是我想要的，但我收到一个错误“T6 压缩每个样本的位数必须为 1！”任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T15:14:32.860

最有可能的是，您希望在使用 CCITT 压缩保存到 TIFF 之前将[此类](http://image4j.sourceforge.net/javadoc/net/sf/image4j/util/ConvertUtil.html)内容转换为 1 位。

稍微解释一下 - 请注意，从其他位深度转换为 1 位并非易事。您正在执行数据缩减操作，并且有几十种特定领域的解决方案，它们的输出质量差异很大（盲阈值、自适应阈值、抖动、局部阈值、全局阈值等）。它们都不是特别适合所有图像类型（例如，自适应阈值对于文档来说非常好，但对于照片来说很糟糕）。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-11-20T17:04:04.200

正如 plinth 所说，你必须进行转换，Java 不会为你神奇地做到这一点......如果 PNG 图像已经是黑白的（看起来，看你的评论），使用阈值可能是最好的解决方案。

有人似乎有同样的问题：[帮助：如何压缩 tiff](http://forums.java.net/jive/thread.jspa?threadID=17031 "帮助：如何压缩 tiff")。线程上给出了解决方案（未经测试！）。

# c++ - 这一小段互斥代码有什么问题？

> ID：305536
> 
> 赞同：2
> 
> 时间：2008-11-20T14:56:31.540
> 
> 标签：c++, mutex, critical-section

```
// A Mutex allows threads mutually exclusive access to a resource.
//-----------------------------------------------------------------------

class Mutex
{
private:
    CRITICAL_SECTION m_mutex;

public:
     Mutex() { InitializeCriticalSection(&m_mutex); }
    ~Mutex() { DeleteCriticalSection(&m_mutex);     }

    void acquire() { EnterCriticalSection(&m_mutex); }
    void release() { LeaveCriticalSection(&m_mutex); }
}; 
```

使用Entrek Codesnitch软件调试和测试是否有内存泄漏等，报如下错误：

```
InitializeCriticalSection Error: lpCriticalSection (0x000387d4) points to an invalid 
  memory location (0x00018984) Mutex::Mutex in lockmutex.h, line 29 
```

也许我所有的不眠之夜终于来到了我身边。但我不明白它到底在抱怨什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-20T15:41:34.180

CodeSnitch 显然不够聪明，无法知道 InitializeCriticalSection()*期望*在包含未初始化指针的结构上工作。

从 CodeSnitch 的角度来考虑。你在做什么和这个有什么区别：

```
struct Customer {
    char * name;
};

extern void greetCustomer(Customer* c);

class CheckoutLine {
  private:
    Customer m_customer;
  public CheckoutLine() {
    greetCustomer(&m_customer);
  }
}; 
```

*这对人*眼来说看起来更可疑，因为我们推断 greetCustomer 可能会依赖于 m_customer 被初始化，但显然不是。但从语义上讲，这与您的代码完全相同。

可能值得向 Entrek 提交错误；InitializeCriticalSection() 是“结构应在将其传递给函数之前进行初始化”规则的合理例外。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-20T15:45:43.390

我敢打赌你可以用 ::memset ( & m_mutex, 0, sizeof ( m_mutex ) ) 伪造告密者；在调用它之前调用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T15:05:39.213

我看不出你的类*定义*有什么问题。但是它在哪里使用？一个特定的实例仍然可能被错误地使用。

CRITICAL_SECTION 的 Win32 定义包括指向“struct _RTL_CRITICAL_SECTION *”的指针。操作系统*可能*会以使工具混淆的方式巧妙地处理此结构。

# java - 将 Eclipse 项目编译成 jar

> ID：305537
> 
> 赞同：0
> 
> 时间：2008-11-20T14:56:32.100
> 
> 标签：java, eclipse, deployment, jar

我从我正在处理的当前项目中引用了另一个 Eclipse 项目。

一切工作正常，除了当我尝试 jar 引用的项目并使用 jar 而不是 eclipse 项目时，我的项目无法正常运行。

我知道这有点含糊，但是当我只是将项目添加为参考时，在 Eclipse 处理的引用的 Eclipse 项目中，我可能做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T15:43:35.827

我发现了问题所在。

我引用的项目有一组参​​考库，当我引用该项目时，它们被添加为对我的项目的引用，但是当我将项目编译为 jar 时，这些项目不再被我的项目引用，所以它没有工作

解决方案是将引用的项目添加到我的项目的引用中。

# ssl - 如何确定网页的哪些部分已加密，哪些未加密？

> ID：305538
> 
> 赞同：11
> 
> 时间：2008-11-20T14:57:14.457
> 
> 标签：ssl

我正在使用一个我没有完全设置好的网络服务器，我试图找出网页的哪些部分被加密发送，哪些不是。Firefox 告诉我该页面的某些部分已加密，但我想知道具体是什么内容是加密的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-10-07T17:55:10.557

问题并不总是页面中的错误链接。

如果您使用 https:// 链接到外部站点上的 iresources，然后外部站点将自己的 HTTP 重定向到非 SSL 页面，这将打破您页面上的 SSL 锁定。

但是，当您在媒体选项卡中查看来源或信息时，您不会看到任何 http://，因为您的页面仅正确使用了 https:// 链接。

如上所述，firebug Net 选项卡将显示此问题和任何其他问题。跟着这些步骤：

1.  如果您还没有 Firebug 插件，请将其安装到 firefox 中，并在出现提示时重新启动 FF。
2.  打开 Firebug（F12 或搜索框右侧的小昆虫菜单）。
3.  在 firebug 中，选择“Net”选项卡。点击“启用”（文本链接）将其打开
4.  通过点击 Ctrl-Shift-R（或 OSX 中的 Command-shift-R）刷新问题页面而不使用缓存。您将看到 firefox 中的“Net”选项卡填满了每个 HTTP 请求的列表。
5.  页面加载完成后，将鼠标悬停在 net 选项卡中显示的每个 HTTP 请求的左侧列上。将出现一个工具提示，向您显示实际使用的链接。很容易发现任何 http:// 而不是 https://。
6.  如果您的任何链接导致 HTTP 重定向，您将在 HTTP 状态列中看到“301 Moved Permanently”，并且另一个 HTTP 请求将在新位置的下方。如果问题是由于外部重定向引起的，那么证据就在那里——新位置的请求将是 HTTP。
7.  如果您的问题是由于来自外部站点的重定向，您将看到将它们指向新位置的请求的“301 永久移动”状态代码。
8.  使用左侧的加号扩展这些 301 重定位中的任何一个，并查看响应标头以查看发生了什么。Location: 标头将告诉您外部服务器请求浏览器使用的新位置。
9.  在重定向中记下此信息，然后向有问题的外部站点发送一封友好的礼貌电子邮件，并要求他们为您删除 https:// -> http:// 重定向。解释它是如何破坏您网站上的 SSL 的，如果可能的话，最好包含一个指向被破坏页面的链接，以便他们自己看到错误。（这将比您告诉他们错误更快地采取行动）。

这是 Firebug 针对外部重定向问题的示例输出。在我的情况下，我发现一个调用 https:// 数据提要的页面正在让外部服务器将提要重写为 http://。

我已将我的站点重命名为“mysite.example.com”，将外部站点重命名为“external.example.com”，但除此之外保持原样。请求标头显示在响应标头下方的底部。请注意，我正在从我的网站请求 https:// 链接，但被重定向到 http:// 链接，这就是破坏我的 SSL 锁定的原因：

```
Response Headers  
Server  nginx/0.8.54
Date    Fri, 07 Oct 2011 17:35:16 GMT
Content-Type    text/html
Content-Length  185
Connection  keep-alive
Location    http://external.example.com/embed/?key=t6Qu2&width=940&height=300&interval=week&baseAtZero=false

Request Headers
Host    external.example.com
User-Agent  Mozilla/5.0 (Windows NT 6.1; WOW64; rv:7.0.1) Gecko/20100101 Firefox/7.0.1
Accept  */*
Accept-Language en-gb,en;q=0.5
Accept-Encoding gzip, deflate
Accept-Charset  ISO-8859-1,utf-8;q=0.7,*;q=0.7
Connection  keep-alive
Referer https://mysite.example.com/real-time-data
Cookie  JSESSIONID=B33FF1C1F1B732E7F05A547A9CB76ED3
Pragma  no-cache
Cache-Control   no-cache 
```

因此，需要注意的重要一点是，在响应标头（上图）中，**您会看到一个 Location: 以 http:// 开头，而不是 https://**。您的浏览器在确定锁定是否有效时会考虑到这一点，并仅报告部分加密的内容！（这实际上是一个重要的浏览器安全功能，可以提醒用户注意潜在的 XSRF 和/或网络钓鱼攻击）。

这种情况下的解决方案不是您可以在您的网站上解决的问题 - 您必须要求外部网站停止重定向到 http。通常这是为了方便而在他们这边完成的，而没有意识到这个后果，而一封写得好、礼貌的电子邮件可以解决这个问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-20T14:59:06.730

对于页面中加载的每个元素，检查它们的方案：

*   它以 HTTPS 开头：它是加密的。
*   它以 HTTP 开头：它没有加密。

（您可以通过右键单击页面并选择“查看页面信息”然后选择“媒体”选项卡来查看 Firefox 上相对完整的列表。

编辑：FF 只显示图像和多媒体元素。它们也是必须检查的 javascript 文件和 CSS 文件。Firebug 是查找所需内容的好工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T19:02:34.133

某些元素可能没有列出 http 或 https，在这种情况下，无论用于页面的哪个都将用于这些项目，即如果页面请求在 SSL 下，则这些图像将被加密，而如果页面请求不在 SSL 下，则这些将未加密。Internet Explorer 中的 Fiddler 也可能有助于跟踪其中的一些信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T15:01:00.237

嗅探数据包——这会很快告诉你。 [WireShark](http://www.wireshark.org/)是完成此类任务的好程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T15:12:33.597

萤火虫可以这样做吗？

编辑：看起来萤火虫也将使用“网络”面板执行此操作，它还为您提供了一些其他有趣的统计数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T08:53:50.247

我发现用于检测 https 连接上的 http 链接的最佳工具是[Fiddler](http://fiddler2.com/fiddler2/version.asp)。它也适用于许多其他故障排除工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-12T17:57:55.213

我为此使用 FF 插件 HTTPFox。

[https://addons.mozilla.org/en-us/firefox/addon/httpfox/](https://addons.mozilla.org/en-us/firefox/addon/httpfox/)

# database - LLBL Gen Pro 2.6 和审计

> ID：305543
> 
> 赞同：0
> 
> 时间：2008-11-20T14:58:27.043
> 
> 标签：database, llblgenpro, auditing

我正在使用 LLBL Gen Pro v2.6 并试图创建一种审计对数据库所做更改的方法。现在，我知道 LLBL Gen 使用 AuditorBase 和依赖注入内置了审计功能。我的问题是；我不仅需要跟踪 LLBL Gen 公开为可审计的内容，还需要跟踪进行更改的用户。据我所见，没有一种内置的方式来收集这些信息。有没有人使用过 LLBL Gen 的内置审计并确定了一种方法来做到这一点？

韦恩·E·普费弗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T17:18:34.937

我使用了 LLBLGens 审计类。确定用户确实是您必须处理的事情。LLBLGen 的变量太多，实际上无法为您执行此操作。您的用户是如何处理的？这是一个 winforms 或 asp.net 应用程序吗？

最好的解决方案是将 UserId 存储在会话变量或静态变量中，具体取决于哪个更适合您的应用程序。在审计类的实现中，您可以从其存储位置中提取 UserId。

另一种可能的解决方案是覆盖实体类或数据适配器类并将 UserId 传递给您的保存方法。然而，这将是更多的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-12T20:41:12.953

In my WinForms app, I accomplish this by creating a custom IPrincipal and stick that on System.Threading.Thread.CurrentPrincipal when a user logs into the application. Then, I can easily grab that from inside my LLBLGen auditing classes.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T14:47:26.557

我们还将对数据库的更改实施审计，并且将 user_id 添加到审计日志中也有同样的问题。我可以看到您可以执行拉取方法，例如从 Web 会话中获取 user_id（我们正在构建 Web 应用程序），但这会完全打乱应用程序的分层，正如我所看到的那样！？

即，如果 DAL 从表示层（网络会话）中提取数据信息，我将无法在其他上下文中使用 DAL？

此致，

——托马斯

# .net - 找到 Pattern 字母 I 后跟一个空格，然后是三个字母数字，后跟一个空格

> ID：305552
> 
> 赞同：0
> 
> 时间：2008-11-20T15:00:34.230
> 
> 标签：.net, vb.net, regex

需要定位到以下模式：

字母 I 后跟一个空格，然后是三个字母数字，后跟一个空格

“我 ALN” “我 H21” “我 31M”

这些项目后面还跟着一个被这个表达式捕获的纬度/经度：

Dim regex As New Regex("\d{6} \d{7}")

可以组合表达式以返回如下所示的匹配：

“H21 ###### #######”

谢谢，

戴夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T15:08:12.827

/I ([0-z]{3} \d{6} \d{7})/

我不知道 VB，但是那个正则表达式可以与 perl 一起使用。

**更新：**
鉴于提供的新字符串..这样的事情*可能会*起作用（取决于对我的问题的回答）

`/^[A-z] ([0-z]{3}) [A-z] [0-z]{3} L (\d{6} \d{7})/`

然后将加入匹配项（匹配 1 包含 AAA，匹配 2 包含 Lat/Long）。

**更新#2：**
来自 OP：*模式上没有。唯一的模式是 I AAA 然后在同一行上 4000931 0892006。你能在表达式中添加 OR 语句吗*

你可以添加一个 OR，有点，但我不确定这真的是你想要的吗？这个新的正则表达式将匹配 I，后跟一个空格，后跟 3 个字母数字字符，然后是“anything”，以及 lat/long。请注意，如果文件中有数据或您正在解析的任何内容与这样的行匹配（因为它是“其他”数据，但遵循类似的模式），您可能也会抓住它。

`/^I ([0-z]{3}) .* (\d{6} \d{7})/`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T15:04:38.810

```
I ([a-zA-Z\d]{3} \d{6} \d{7}) 
```

匹配组 1 将包含三个字母数字加上您已经使用其他正则表达式捕获的数字。

编辑：不起作用，因为问题中描述的模式并未反映作者最初的意思。真正的意思首先在评论中澄清。

# c++ - C++：静态原语在程序退出时是否无效？

> ID：305554
> 
> 赞同：4
> 
> 时间：2008-11-20T15:01:01.017
> 
> 标签：c++, memory-management, static

假设我有这样的功能：

```
MyClass &MyFunction(void)
{
  static MyClass *ptr = 0;
  if (ptr == 0)
    ptr = new MyClass;
  return MyClass;
} 
```

问题是在程序退出时，ptr 变量是否会变得无效（即该 ptr 的内容被退出进程清除）？我意识到这个函数会泄漏，但这只是一个简单的例子。

除了指针之外，同样的问题也适用于其他原语。如果我有一个静态整数，该整数的值是在整个退出过程中始终保持不变还是由于静态销毁顺序问题而可变？

编辑：

澄清一下，我想知道静态指针（或任何其他原始类型，如 int 或 float）的内容实际发生了什么，而不是它指向的内存。例如，假设 ptr 指向某个内存地址，我想在其他静态类的析构函数中检查该地址。我可以依赖 ptr 的内容不会改变的事实（即在静态销毁过程中不会清除指针值）吗？

谢谢，乔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-20T15:09:43.103

当您进程退出时，分配给它的所有内存页面将被操作系统释放（其他人可能正在使用的模共享内存页面）。

但是，正如其他人指出的那样，从未调用 MyClass 的析构函数。ptr 指向的值也不会改变。如果你有一个值为 123 的静态 int，那么它的值将保持 123 直到进程生命周期的最后。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-20T15:06:45.043

在现代操作系统中，应用程序的所有内存都分配在特定于该应用程序的“堆”上。当应用程序退出时，该堆中的所有内存都将被释放。

因此，内存将被释放，**但是**：`MyClass`永远不会调用析构函数。如果析构函数负责释放任何非内存资源（文件系统锁是一个常见的例子），这可能是一个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-20T15:16:07.380

要回答您更新的问题，我会说是的：您可以依靠在整个静态销毁过程中剩余的静态指针的*值。*它指向的内存可能已被释放，但指针本身的值应保持不变，除非另一个静态类的析构函数对其进行更改。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-20T16:50:12.730

要回答您的问题：

```
'imagine that the ptr points to some memory address which I want to check in the destructor of some other static class' 
```

答案是肯定的。
您可以看到指针的值（地址）。
如果您没有在指针上调用 delete，您可以查看内容。

静态函数变量的行为方式与静态类变量和全局变量（**也称为**非本地静态变量）的行为方式相同，因为其中的析构函数将以相反的创建顺序被调用。整数、浮点数和**指针**(POD) 没有析构函数，因此在删除进程之前它们不会发生任何事情。

POD 对象：数据可以安全地从其他对象（甚至是全局对象）的析构函数中引用。

其他静态对象（即具有析构函数的对象）：在一般情况下，在 main() 退出后访问这些对象是不安全的，因为不知道销毁顺序（它与创建顺序相反，但是创建顺序很复杂，请参阅：[构造顺序](https://stackoverflow.com/questions/294270/how-do-you-call-a-constructor-for-global-objects-for-arrays-of-objects-and-for#294308)）。可以这样做，但您必须采取明确的预防措施以确保对象仍然存在。

### 注意：非本地静态：

内存将永远存在，在调用析构函数后对象将无效（注意 POD 没有析构函数）。

### 注意：堆栈：

仅在离开声明它们的范围之前有效。
弹出堆栈后，如果您尝试访问它，它所在的内存页面可能会被丢弃，从而导致 SEG 错误。

### 注意：堆：

在您对分配它的指针调用 delete 之前有效。
一旦指针被删除，该值可能是随机的，因为它可能会被重复使用。内存所在的页面也可能被删除。对已丢弃页面的任何访问都将导致 SEG 故障。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T15:18:41.293

简短的回答是“否”：您的指针在程序退出时不会“变得无效”。即指针值不会自动重置为null，并且不会自动调用它指向的MyClass对象的析构函数。

这是因为指针是“原始类型”，即不是对象。

如果你有一个非局部（即全局或静态）变量，它是一个对象，那么规则是不同的：当程序通过调用 exit() 或从主函数返回时，将调用对象的析构函数。如果程序通过调用 abort() 终止，它将不会被调用。

# .net - 如何获取多选列表框中的最后一个选定项？

> ID：305555
> 
> 赞同：4
> 
> 时间：2008-11-20T15:01:23.010
> 
> 标签：.net, winforms, listbox

如何获取 .Net Forms 多选列表框中的最后一个选定项目？显然，如果我在列表框中选择一个项目，然后再选择 10 个，则所选项目是第一个。

我想获得我选择/取消选择的最后一个元素。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-20T15:15:35.743

我会采用这种一般方法：

每次监听`SelectedIndexChanged`事件并扫描集合。`SelectedIndices`

保留所有选定索引的单独列表，附加未在列表中的索引，删除已取消选择的索引。

单独的列表将按用户选择的时间顺序包含索引。最后一个元素始终是最近选择的索引。

```
// for the sake of the example, I defined a single List<int>
List<int> listBox1_selection = new List<int>();

private void listBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    TrackSelectionChange((ListBox)sender, listBox1_selection);
}

private void TrackSelectionChange(ListBox lb, List<int> selection)
{
    ListBox.SelectedIndexCollection sic = lb.SelectedIndices;
    foreach (int index in sic)
        if (!selection.Contains(index)) selection.Add(index);

    foreach (int index in new List<int>(selection))
        if (!sic.Contains(index)) selection.Remove(index);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-20T15:15:13.950

不确定我是否理解这个问题，但最后一个选定的项目将是 SelectedItems 数组中的最后一个，所以这样的事情应该可以工作：

```
ListItem i = list.SelectedItems[list.SelectedItems.Length-1]; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-05T10:48:38.430

在列表框的鼠标单击事件中使用以下代码：

```
private void ListBox1_MouseClick(object sender, MouseEventArgs e)
{
    string s = ListBox1.Items[ListBox1.IndexFromPoint(e.Location)].ToString();

    MessageBox.Show(s);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-25T12:08:57.483

试试这个

```
 private void listBox1_MouseUp(object sender, MouseEventArgs e)
    {
        int jj = listBox1.IndexFromPoint(e.X, e.Y);
        object Test = listBox1.Items[jj];
        object LatestItemSelected;
        if(listBox1.SelectedItems.Contains(Test))
            LatestItemSelected = Test;
    } 
```

显然， *LatestItemSelected*是多余的，是为了强调您已经找到了您的项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-11T11:43:20.633

使用一些反射来获取 FocusedIndex 的值，这是 ListBox 的内部属性，您可以获得最后一个关注的项目。

```
int lastSelectedIndex = (int)typeof(ListBox).GetProperty("FocusedIndex",BindingFlags.NonPublic|BindingFlags.Instance).GetValue(myListBox,null);
SelectedItemType mySelectedItem = myListBox.Items[lastSelectedIndex] as SelectedItemType; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-14T08:14:28.957

使用 FocusManager.GetFocusedElement(listbox) 或 Keyboard.FocusedElement 返回您选择的最后一项。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-21T21:10:55.277

我在 VBA 中遇到了完全相同的问题...想法是在隐藏标签中记录以前的选择...然后将列表框中的所有选定项目与记录的以前的选择进行比较...如果它不存在在标签中，这是最后一个选定的项目。我已经对其进行了测试，并且可以正常工作……您将不得不稍微调整一下代码，但这个想法对我有用。

```
Private Sub ListBox2_Change()

    'Preview Doc
    Previous_Selections = Me.Label2.Caption

    'This logic figures out the last selected item if you already have existing selections
    For i = 0 To ListBox2.ListCount - 1
         If ListBox2.Selected(i) Then
            MyItem = ListBox2.List(i)

            'Check if this is a new selection or and old one
            If IsIn(MyItem, Previous_Selections) = False Then

                'This is a new selection
                'Record new selection for as 'previous' for next time
                For n = 0 To ListBox2.ListCount - 1
                    If ListBox2.Selected(n) Then Selections = Selections & ListBox2.List(n) & ", "
                Next

                'Preview last selected item
                FullPath = Me.ListBox1.Value & "\" & MyItem
                Me.Label2.Caption = Selections
                Call Preview_Document(FullPath)
                Exit Sub
            End If
         End If
    Next i

End Sub 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-08-23T20:11:26.433

这是我在VB中完成的方式。

当您刷新列表框时，您必须重新调整数组的尺寸。

```
 Dim SelectedAry(-1) As Integer

  Private Sub ListBox1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ListBox1.SelectedIndexChanged
        Dim LastOne As Integer = -1
        ' First time there no elements in the preserved array
        If SelectedAry.Length = 0 Then
              If ListBox1.SelectedIndex <> -1 Then
                    LastOne = 0
              End If
        Else
              'If the SelectedIndices array is larger than the preserved SelectedAry - means that another one had been selected
              If ListBox1.SelectedIndices.Count >= SelectedAry.Length Then
                    For i = 0 To ListBox1.SelectedIndices.Count - 1
                          'Go through both arrays comparing the values until there is a mismatch
                          'This means that the value in the  SelectesIndices is the last one to be added
                          If ListBox1.SelectedIndices(i) <> SelectedAry(i) Then
                                LastOne = i
                                Exit For
                          End If
                    Next
              End If
        End If
        ' Copy the Listbox selectedindices array into the SelectedAry which is preserved for the next selected index change
        ReDim SelectedAry(ListBox1.SelectedIndices.Count)
        For i = 0 To ListBox1.SelectedIndices.Count - 1
              SelectedAry(i) = ListBox1.SelectedIndices(i)
        Next
        ' Display the last one added
        If LastOne >= 0 Then
              Dim FileName As String = txtFolder.Text & "\" & ListBox1.Items(ListBox1.SelectedIndices(LastOne)).ToString
              Display_File(FileName)
        Else
        End If
  End Sub 
```

# vb.net - .NET 中 dll 的配置信息

> ID：305557
> 
> 赞同：2
> 
> 时间：2008-11-20T15:03:18.267
> 
> 标签：vb.net, configuration-files

我继承了一个项目，该项目具有用 VB.NET 编写的类库，其中一些具有“.settings”文件，另一些具有“.dll.config”文件来存储连接字符串。这两种方法有什么区别？

编辑：在什么情况下我更喜欢其中一种？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T15:37:17.900

无论如何，它们基本上是同一件事-或密切相关。设置文件使您可以对 app.config 文件中的条目进行强类型访问，并使它们保持同步。编译时，app.config 文件将复制到带有程序集名称的 bin 文件夹中。

请注意，如果您手动修改 .config 文件，如果设置文件覆盖它们，您可能会丢失更改。在VS2008中它会提示你，所以你可以选择同步它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T15:15:23.297

我认为 .settings 是应用程序范围的，而 .dll.config 文件特定于它们命名的程序集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T16:12:29.420

“.config”文件是.NET 配置系统的核心。它们存储实际的配置数据。在早期的 .NET 框架中，如果您想扩展配置系统来处理您的自定义配置数据，您必须手动执行此操作。“设置”文件是一项功能，允许您直观地定义配置选项并使用它们来创建强类型类。然后可以将此类用作在运行时读取和操作在应用程序的“.config”文件中指定的配置数据的方法。它们还自动提供了一些简洁的功能，例如定义每个用户或每个应用程序的配置选项。它们大大减少了手动扩展配置系统的麻烦。

# sql - Oracle 错误：ORA-00905：缺少关键字

> ID：305568
> 
> 赞同：24
> 
> 时间：2008-11-20T15:06:34.607
> 
> 标签：sql, oracle, ora-00905

执行 SQL 行：

```
SELECT * 
  INTO assignment_20081120 
  FROM assignment ; 
```

针对 oracle 中的数据库备份名为 assignment 的表给我以下 ORACLE 错误：ORA-00905：缺少关键字

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-20T15:12:28.513

除非表中有一行`ASSIGNMENT`并且`ASSIGNMENT_20081120`是类型为 的本地 PL/SQL 变量，`ASSIGNMENT%ROWTYPE`否则这不是您想要的。

假设您正在尝试创建一个新表并将现有数据复制到该新表

```
CREATE TABLE assignment_20081120
AS
SELECT *
  FROM assignment 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-09-28T06:34:04.270

首先，我想：

> “......在 Microsoft SQL Server 中， `SELECT...INTO`自动创建新表，而 Oracle 似乎要求您在执行`SELECT...INTO` 语句之前手动创建它......”

但是手动生成表格后还是不行，依旧显示“缺少关键字”的错误。

所以我放弃了这次，先手动创建表，然后使用“经典”`SELECT`语句解决：

```
INSERT INTO assignment_20081120 SELECT * FROM assignment; 
```

哪个按预期工作。如果有人想出如何`SELECT...INTO`正确使用的解释，我会很高兴！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-28T10:51:32.077

您可以在 PLSQL 块中使用 select into，如下所示。

```
Declare
  l_variable assignment%rowtype
begin
  select *
  into l_variable
  from assignment;
exception
  when no_data_found then
    dbms_output.put_line('No record avialable')
  when too_many_rows then
   dbms_output.put_line('Too many rows')
end; 
```

此代码仅在分配中恰好有 1 行时才有效。通常，您将使用这种代码来选择由键号标识的特定行。

```
Declare
  l_variable assignment%rowtype
begin
  select *
  into l_variable
  from assignment
  where ID=<my id number>;
exception
  when no_data_found then
    dbms_output.put_line('No record avialable')
  when too_many_rows then
   dbms_output.put_line('Too many rows')
end; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-10T20:27:06.007

虽然这与 OP 的确切问题没有直接关系，但我刚刚发现在查询中使用 Oracle 保留字（在我的情况下为 alias `IN`）会导致相同的错误。

例子：

```
SELECT * FROM TBL_INDEPENTS IN
JOIN TBL_VOTERS VO on IN.VOTERID = VO.VOTERID 
```

或者，如果它在查询本身中作为字段名称

```
 SELECT ..., ...., IN, ..., .... FROM SOMETABLE 
```

这也会引发该错误。我希望这可以帮助别人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-10T14:14:23.183

迟到的答案，但我今天才出现在这个名单上！

```
CREATE TABLE assignment_20101120 AS SELECT * FROM assignment; 
```

做同样的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-11-02T10:25:07.077

如果您备份 Oracle 数据库中的表。你试试下面的说法。

```
CREATE TABLE name_table_bk
AS
SELECT *
  FROM name_table; 
```

我正在使用 Oracle 数据库 12c。

# php - 我可以阻止 vimrc 中的设置被插件覆盖吗？

> ID：305574
> 
> 赞同：5
> 
> 时间：2008-11-20T15:09:04.743
> 
> 标签：php, plugins, vim

这个问题来自[这个 vim 搜索问题](https://stackoverflow.com/questions/299114/can-i-search-for-php-class-members-and-methods-with-vim-star-search)

我的 .vimrc 中有一个设置，它不包括 $ 作为单词的有效部分：

```
set iskeyword-=$ 
```

这适用于大多数文件，但不适用于 PHP。我假设它被一个 php 插件覆盖，但由于插件是在 .vimrc 之后加载的，我无法弄清楚如何覆盖这个设置。我宁愿不用打字

```
:set isk-=$ 
```

每次我加载一个 PHP 文件。

有什么建议么？

（Ubuntu 8.04 / Vim 7.1.138 如果重要的话）

**概括**

两个很好的答案，谢谢！

我选择了[tomalak](https://stackoverflow.com/users/18771/tomalak)，因为它省力，并将以下内容添加到我的 ~/.vimrc

```
autocmd FileType php setlocal isk-=$ 
```

但也要感谢[Luc Hermitte](https://stackoverflow.com/questions/305574/can-i-stop-settings-in-vimrc-from-being-overwritten-by-plugins#305820)。将设置放在 ~/vim/after/ftplugin/php.vim 文件中也可以。

*:help autocmd*和*:help after-directory*也都有帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-20T16:05:48.607

添加一个 {rtp}/after/ftplugin/php.vim 包含`:setlocal isk-=$`

`:verbose set isk`否则，您将不得不使用或播放来跟踪上次更改的位置`:scriptnames`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-20T15:23:54.463

我可能只是在`set isk-=$`语法中添加突出显示自动命令的`$VIMRUNTIME\filetype.vim`. 不过，不知道这是否是最好的方法。

考虑一下...我认为在您的`vimrc`.

```
au   FileType php    set isk-=$ 
```

这在设置 FileType 后执行。自动命令按照它们给出的顺序执行，所以当你把它放在你的后面时`vimrc`，它会在 PHP 文件中最后执行。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-20T23:29:55.293

复制你的 .vimrc，例如 .vimrc.ref

在另一个目录中制作副本。

然后找出为什么插件作者真的需要破坏你的 .vimrc 没有：

1.  让你知道他们正在破坏它，并且
2.  保存 .vimrc 文件的副本，以便您轻松回滚。

编辑：让[http://www.vim.org/](http://www.vim.org/)知道那些会在不让你知道的情况下接触到你的人！

# project-management - 您如何有效地跟踪技术债务？

> ID：305579
> 
> 赞同：7
> 
> 时间：2008-11-20T15:10:42.930
> 
> 标签：project-management, technical-debt

在您的实践中，您如何有效地跟踪和管理技术债务？

是否有您使用的特定指标，例如[SLOC](http://jamesshore.com/Blog/An-Approximate-Measure-of-Technical-Debt.html)？

您如何向利益相关者和管理层直观地展示您的结果？

你在这个过程中看到了什么好处？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T15:20:08.950

我们为技术债务写故事卡。它们是黑色的，上面有大大的黄色警告标志。在墙上贴太多，这很明显。

路过的人都能看到 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-22T03:26:03.663

我们使用`@todo`评论。

在 Python 中，[epydoc](http://epydoc.sourceforge.net/)工具可以`@todo`很好地格式化。

我们有一个提取`@todo`注释行的小代码扫描器。我们将它们作为待完成的工作推入积压工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-12T17:44:33.047

我在下面的博客文章中谈了一些用于识别技术债务的指标。技术债务不仅仅意味着代码中 TODO 语句突出显示的代码清理项。跟踪机制将根据您关注的风险指标而变化。

[http://blog.acrowire.com/technical-debt/technical-debt-part-2-identification/](http://blog.acrowire.com/technical-debt/technical-debt-part-2-identification/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-17T15:11:49.600

Sonar有一个[插件，](http://www.sonarsource.org/evaluate-your-technical-debt-with-sonar/)可以将技术债务转换为美元。

我自己还没有使用它，但它看起来很有希望。

# asp.net - 从 asp.net gridview 模板列中的复选框获取数据

> ID：305591
> 
> 赞同：2
> 
> 时间：2008-11-20T15:13:38.867
> 
> 标签：asp.net, data-binding, gridview

这似乎很简单，但我似乎无法弄清楚！我试图让 2-way 数据绑定在 ASP.net 页面上工作，其中一个复选框作为列之一。如何从 gridview 中获取更新的值（来自复选框）？？？？？？

这是我的数据类型：

```
[Serializable]
public class UserRequirements 
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string UserId { get; set; }
    public string Email { get; set; }

    public bool ThingRequired { get; set; }
} 
```

我的标记看起来像这样：

```
<form id="form1" method="post" runat="server" >
    <asp:GridView ID="UserTable" runat="server" AutoGenerateColumns="false" >
    <Columns>
        ...
        <asp:TemplateField HeaderText="Required ?">
            <ItemTemplate>
                <asp:CheckBox id="chkBox1" runat="server"  on
                Text ="Required"
                checked='<%# DataBinder.Eval(Container.DataItem,"ThingRequired")  %>'>
                </asp:CheckBox>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
    </asp:GridView>
    <asp:Button id="thebutton" Text="Save Changes" OnClick="UpdateRequirements" runat="server"  CausesValidation=false  />  
</form> 
```

我背后的代码如下所示：

```
 List<UserRequirements > _userList = new List<UserRequirements >();

    protected void Page_Load(object sender, EventArgs e)
    {
        _userList = data_layer.GetUserRequirments();

        this.UserTable.DataSource = _userList;
        this.UserTable.DataBind();      
    } 
```

最终，我会调用这样的东西，但我不知道应该去哪里或者如何从 gridview 中取回值：

```
void UpdateRequirements(object sender, EventArgs e)
{
    _userList = ???????????? // How do I get the data?
    data_layer.UpdateUserRequirements( _userList );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T15:20:21.350

foreach (GridViewRow di in GridView1.Rows) { HtmlInputCheckBox chkBx = (HtmlInputCheckBox)di.FindControl("chkBox1");

```
 if (chkBx != null && chkBx.Checked)
        {
             /// put your code here
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T15:27:50.947

尝试这样的事情来获得改变的价值：

```
protected void OnCheckedChanged(object sender, EventArgs e)
{    
   CheckBox c = (CheckBox)sender as CheckBox;    
   string checkBoxId = c.ID;    
   bool checkBoxValue = c.Checked;
   //update database
} 
```

**[编辑]**

如果您想一次性从网格中的行中获取所有值，则需要使用 UserRequirements 列表中行或项目的 Id 绑定复选框，因此在您的网格中执行以下操作：

```
<asp:CheckBox ID="<%# Eval('Id') %>" /> 
```

然后在回发时，遍历 UserRequirements 列表中的项目，将对象/项目 Id 与网格中复选框的 Id 匹配.. 像这样：

```
 foreach (UserRequirement item in Requirements)
        {
            Control c = grid.FindControl(item.Id);
            CheckBox cbx = c as CheckBox;
            if (cbx != null)
            {
                bool value = cbx.Checked;
                //update db
            }
        } 
```

注意：您可能需要递归地使用 FindControl 来搜索子控件，或者对网格中的每个 GridViewRow 对象执行一次 foreach 以获取您正在寻找的复选框。

# scope - .bat 文件中的奇怪范围问题

> ID：305605
> 
> 赞同：18
> 
> 时间：2008-11-20T15:16:42.043
> 
> 标签：scope, batch-file

我正在编写一个简单的 .bat 文件，但遇到了一些奇怪的行为。有几个地方我必须做一个简单的 if/else，但块内的代码似乎不能正常工作。

这是一个演示错误的简单案例：

```
@echo off

set MODE=FOOBAR

if "%~1"=="" (
  set MODE=all
  echo mode: %MODE%
) else (
  set MODE=%~1
  echo mode: %MODE%
)
echo mode: %MODE% 
```

我得到的输出是：

```
C:\>test.bat test
mode: FOOBAR
mode: test 
```

为什么代码块内的回显没有得到变量的新值？在我正在编写的实际代码中，我需要构建一些变量并在 if/else 的范围内引用它们。我可以将其切换为使用标签和 goto 而不是 if/else，但这似乎并不那么干净。

是什么导致了这种行为？代码块中的变量是否有某种限制？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-20T15:26:58.077

您遇到了 cmd 的静态变量扩展问题。MODE 变量只计算一次。如果您省略 @echo 离线，您可以看到这一点。

从集/？文档：

> 最后，添加了对延迟环境变量扩展的支持。默认情况下始终禁用此支持，但可以通过 /V 命令行开关到 CMD.EXE 启用/禁用。见 CMD /?
> 
> 延迟的环境变量扩展对于绕过当前扩展的限制很有用，这种限制发生在读取一行文本时，而不是在执行时。以下示例演示了立即变量扩展的问题：
> 
> ```
>  set VAR=before
>  if "%VAR%" == "before" (
>      set VAR=after
>      if "%VAR%" == "after" @echo If you see this, it worked
>  ) 
> ```
> 
> 永远不会显示该消息，因为 BOTH IF 语句中的 %VAR% 在读取第一个 IF 语句时被替换，因为它在逻辑上包括 IF 的主体，这是一个复合语句。因此，复合语句中的 IF 实际上是将“之前”与“之后”进行比较，这永远不会相等。同样，以下示例将无法按预期工作：
> 
> ```
> set LIST=
> for %i in (*) do set LIST=%LIST% %i
> echo %LIST% 
> ```
> 
> 因为它不会在当前目录中建立文件列表，而是将 LIST 变量设置为找到的最后一个文件。同样，这是因为在读取 FOR 语句时 %LIST% 只扩展了一次，而此时 LIST 变量为空。所以我们正在执行的实际 FOR 循环是：
> 
> ```
> for %i in (*) do set LIST= %i 
> ```
> 
> 它只是将 LIST 设置为找到的最后一个文件。
> 
> 延迟环境变量扩展允许您在执行时使用不同的字符（感叹号）来扩展环境变量。如果启用了延迟变量扩展，则上述示例可以编写如下以按预期工作：
> 
> ```
> set VAR=before
> if "%VAR%" == "before" (
>     set VAR=after
>     if "!VAR!" == "after" @echo If you see this, it worked
> )
> 
> set LIST=
> for %i in (*) do set LIST=!LIST! %i
> echo %LIST% 
> ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-10T19:01:55.217

setlocal EnableDelayedExpansion

将启用 /v 标志

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-05T14:11:40.170

另外这里已经回答了。

## 长篇回答文章：

[https://rsdn.org/article/winshell/NTCommandProcessor.xml](https://rsdn.org/article/winshell/NTCommandProcessor.xml)

谷歌翻译的变体很糟糕，但你至少可以阅读原始文本：

[https://translate.google.com/?sl=ru&tl=en&text=https%3A%2F%2Frsdn.org%2F%3Farticle%2Fwinshell%2FNTCommandProcessor.xml&op=translate](https://translate.google.com/?sl=ru&tl=en&text=https%3A%2F%2Frsdn.org%2F%3Farticle%2Fwinshell%2FNTCommandProcessor.xml&op=translate)

`Conditional block`从章节开始阅读。

## 简短的回答：

块运算符`(...)`阻止 %-variable 扩展直到最上面的范围。您必须退出范围才能按原样使用 %-variable：

```
@echo off

set "MODE="
(
  (
    set MODE=all
    echo MODE=%MODE%
  )
  echo MODE=%MODE%
)
echo MODE=%MODE% 
```

或者使用`call`前缀重新评估它：

```
@echo off

set "MODE="
(
  (
    set MODE=all
    call echo MODE=%%MODE%%
  )
) 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-11-20T15:30:09.787

看起来读写使用不同的范围规则。

如果你消除这条线

```
set MODE=FOOBAR 
```

它将按预期工作。因此，如果 if/elses 可以根据需要填充变量，您可能需要有一个复杂的系列。

# c - C 的容器类/库

> ID：305611
> 
> 赞同：79
> 
> 时间：2008-11-20T15:19:24.753
> 
> 标签：c, containers

有人知道任何 C 容器库吗？我正在寻找能够提供链表、数组、哈希表等标准实现的东西，与 C++ STL 所做的方式非常相似。主要问题是：

1.  客户端代码应该能够为多种不同的数据类型创建容器，而无需修改库。
2.  创建和使用容器的界面应该是直观的。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-20T19:03:15.333

我在寻找地图/字典容器的 C 实现时遇到了 SGLIB。不幸的是，没有地图，但它似乎包括您询问的容器。我不知道它有多好。

[http://sglib.sourceforge.net](http://sglib.sourceforge.net)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-24T02:46:51.317

[Sglib](http://sglib.sourceforge.net/)是一个优秀的通用数据结构库。该库目前提供以下通用实现：

*   排序数组
*   链表
*   排序的链表
*   双链表
*   红黑树
*   散列容器

它非常快。更快的油嘴滑舌。它的灵感来自标准模板库。[在这里下载](http://freshmeat.net/projects/sglib/)

另一种解决方案是[Attractive Chaos 软件](http://attractivechaos.wordpress.com/programs/)。C 宏库：
kbtree.h：C 中的高效 B-tree 库。
khash.h：C 中的快速和轻量级哈希表库。
kvec.h：C 中的简单向量容器。

[Kulesh Shanmugasundaram](http://isis.poly.edu/kulesh/)提供了通用的 Linux 内核链接列表和基于 Linux 内核链接列表的通用哈希表。

Sglib 和 Attractive Chaos 软件和 Linux Kernel Linked List 是 C 宏库。用于在C`void*`中实现通用容器可能效率低下。C 宏模仿 C++ 模板，并且与 C++ 模板一样高效。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-20T15:45:10.833

[Chuck Falconer](http://cbfalconer.home.att.net/download/)有一个不错的用 C 编写的哈希库，其中包括一个 C++ 接口，点击网页上的 hashlib.zip 下载。

[Ben Pfaff](http://www.stanford.edu/~blp/avl/)有非常好的和非常好的文档化的二叉树和平衡树库，[GNU libavl](http://savannah.gnu.org/projects/avl)，它实现了大多数主要的树结构，包括二叉搜索树、AVL 树、红黑树和每个树的线程版本。

libavl 在 LGPL 下获得许可（从 2.0.3 版开始），hashlib 是 GPL。

我不确定你在寻找什么数组和链表，因为前者是由语言直接支持的，而后者通常是微不足道的，可以在不需要库的情况下实现。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-05-06T02:05:41.273

ccl怎么样？这是一个 C 的容器库。也许它最适合你。你可以看到[https://code.google.com/p/ccl/](https://code.google.com/p/ccl/)。好好享受。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-22T16:04:09.983

我一直在使用我从 Hanson 的“C 接口和实现”一书中发展而来的库。他的源代码可在以下位置下载

[cii 图书网站](http://www.cs.princeton.edu/software/cii/)

一切都是抽象数据类型。有List、Set、Table（地图）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-24T02:19:37.907

`#include "queue.h"`访问单链表、单链尾队列、列表和尾队列的实现。

[我发现 DJ Bernstein ( http://cr.yp.to/djbdns.html](http://cr.yp.to/djbdns.html) ) 为在内存中存储任意对象的通用缓存既干净、简单又超快。在 djdns tarball 中查找 cache.h 和 cache.c。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-05-22T04:55:15.007

我听说过（但从未使用过）的一些是

*   油嘴滑舌
*   iMatix 标准函数库
*   Linux 内核头文件中的不同元素（例如列表）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-11-11T00:55:13.577

这似乎涵盖了大部分容器和一些算法。也没有许可，所有标题都包含 - '代码可以不受限制地使用。[http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=13867&lngWId=3](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=13867&lngWId=3)

# c++ - 测量延迟的计时器

> ID：305615
> 
> 赞同：5
> 
> 时间：2008-11-20T15:20:15.267
> 
> 标签：c++, winapi, timer, latency

在通过 TCP 测量任何协议中的网络延迟（收到的时间 - 发送的时间消息）时，您建议使用什么计时器，为什么？它有什么分辨率？其他优点/缺点是什么？

可选：它是如何工作的？

可选：你不会使用什么计时器，为什么？

我主要在寻找 Windows / C++ 解决方案，但如果您想评论其他系统，请随时这样做。

（目前我们使用 GetTickCount()，但它不是一个非常准确的计时器。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-20T17:15:21.760

这是我的答案的副本：[C++ Timer function to provide time in nano seconds](https://stackoverflow.com/questions/275004/c-timer-function-to-provide-time-in-nano-seconds#275231)

对于 Linux（和 BSD），您想使用[clock_gettime()](http://opengroup.org/onlinepubs/007908799/xsh/clock_gettime.html)。

```
#include <sys/time.h>

int main()
{
   timespec ts;
   // clock_gettime(CLOCK_MONOTONIC, &ts); // Works on FreeBSD
   clock_gettime(CLOCK_REALTIME, &ts); // Works on Linux
} 
```

对于要使用[QueryPerformanceCounter](http://support.microsoft.com/kb/172338)的窗口。这里有更多关于[QPC](http://msdn.microsoft.com/en-us/library/ms979201.aspx)

显然，某些芯片组上的 QPC 存在已知[问题](http://support.microsoft.com/kb/274323)，因此您可能需要确保您没有这些芯片组。此外，一些双核 AMD 也可能导致[问题](http://forum.beyond3d.com/showthread.php?t=47951)。请参阅 sebbbi 的第二篇文章，他在其中指出：

> QueryPerformanceCounter() 和 QueryPerformanceFrequency() 提供了更好的分辨率，但有不同的问题。例如，在 Windows XP 中，所有 AMD Athlon X2 双核 CPU “随机”返回任一内核的 PC（PC 有时会向后跳一点），除非您专门安装 AMD 双核驱动程序包来解决此问题。我们没有注意到任何其他双核 CPU 有类似问题（p4 dual、p4 ht、core2 dual、core2 quad、phenom quad）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T15:21:59.710

您提到您使用 GetTickCount()，所以我将建议您看一下 QueryPerformanceCounter()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-08T22:16:39.060

确实没有 rdtsc 指令的替代品。您无法确定 QueryPerformanceCounter 将支持什么分辨率。有些具有非常大的粒度（低增量率/频率），有些则根本不返回任何内容。

相反，我建议您使用 rdtsc 指令。它不需要任何操作系统实现，并返回自计算机/处理器/内核启动以来经过的 CPU 内部时钟周期数。对于每秒 30 亿次增量的 3 GHz 处理器来说，没有比这更精确的了，是吗？此指令适用于从 Pentium 或 Pentium MMX 开始的 x86-32 和 -64。因此，它也应该可以从 x86 Linux 访问。

在 stackoverflow.com 上有很多关于它的帖子。我自己写了几...

# project-management - 如何创建准确的小时估算？

> ID：305618
> 
> 赞同：23
> 
> 时间：2008-11-20T15:20:33.783
> 
> 标签：project-management, project-planning, estimation

*   您在项目规划和为新项目创建工时估算方面有何经验？

*   您使用的方法是什么，为什么对您有效或无效？

*   是否有任何最佳实践需要考虑？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-20T17:00:14.050

## 估计任务

我尝试使用的原则（我并不总是有机会）是：

*   逐步细化
*   3点估计
*   风险分析

### 逐步细化

在进行估算时，重要的是要以正确的粒度进行估算，并不断分解和添加任务，直到您对估算有信心为止。很多时候，估计会突出一个冗长的关键路径任务，可能需要更多的细化和风险分析。

### 风险分析

尝试找出每项任务的风险所在（是否有某件事的提前期？是否缺乏知识？竞争对手能打败你吗？等等）有助于确定您对估算的信心，这使您可以以确定如何处理这些估计。风险分析还有助于确定是否需要进一步逐步完善。

### 3 点估计

为每项任务（包括设计、开发、测试和错误修复）指定最佳、可能和最坏情况估计有助于风险分析和规划。估计值可用于计算达到该任务特定百分比成功的最可能持续时间。结合其他相关任务和风险分析的信息，项目经理可以将风险和其他已知元素（如系统测试）纳入估计，以获得更可靠的估计。

当然，估计的粒度也很重要。对于大多数任务，以小时为单位进行估算是没有意义的。在软件中，几天通常是最好的，但有时可能是几周或几个月（例如，如果您将工作块外包）。选择一个对项目中所有任务都有意义的时间粒度（我通常在需求捕获和功能规范阶段使用几天，然后在我了解有关任务及其子任务的更多信息时使用半天）。

## 结论

所有这三个项目都相互影响，因此您通常必须多次改进每个步骤。例如，您可能会在需求阶段进行一次尝试，然后在功能规范期间再次尝试，然后在设计规范期间再次尝试。

估计是一种习得的技能。你做的越多，你就越好。风险分析随着您对未知事物的了解越多而改进，三点估计随着您对已知事物的了解越多而改进，而逐步细化随着您完成设计过程的每个步骤而得到改进。

如果您有时间，请在完成一项任务后重新审视您的原始估算，看看实际时间与您的 3 点估算和项目计划相比如何。如果有所不同，请查看在哪里浪费或获得了时间，并尝试了解您可以从中获得什么以用于未来的项目。

估算不应该是一项艰巨的任务——我总觉得估算后我对自己的工作比以前了解更多。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-20T15:25:00.077

我强烈推荐史蒂夫·麦康奈尔（Steve McConnell）的[《软件估计：揭秘黑色艺术》](https://rads.stackoverflow.com/amzn/click/com/0735605351)一书。它确实很好地涵盖了这个问题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-20T15:26:59.200

[The Pragmatic Programmer](https://rads.stackoverflow.com/amzn/click/com/020161622X)中有一些很好的信息。他们建议您使用适当的时间单位而不是估计 130 天估计 6 个月。他们还建议集中精力完成最关键的任务。并避免根据子估计进行估计。

就我个人而言，我发现将任务分解为可理解的块以正确估计它们是有用的。如果任务很大，那么有太多的角落和缝隙会隐藏未曾想到的问题。通过专注于较小块的细节，您可以更成功地评估潜在问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-20T15:59:18.027

您的问题是一个 NP-Complete 问题:) 有许多算法用于提出估计，但它们总是只是猜测，永远不准确，而且许多算法需要很长时间才能执行。忘记时间估算，使用 scrum 或其他一些敏捷框架。在一开始就在几个小时内对一个项目进行估算简直是在欺骗人们。

在构建功能之前不要进行基于小时的估计，并随着功能的进展不断更新这些估计。

不要忘记在您的估计中包括测试时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T16:05:20.167

练习，练习，练习。为了安全起见，在您完善自己的估计能力时，请高估。当然，如果你是一名顾问，这可能会让你付出代价。如果您害怕失去业务，估计不足，但请注意，您将从空闲时间/底线中弥补额外的时间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-29T22:56:48.090

回复： *如果您害怕失去业务，估计不足，但请注意，您将从空闲时间/底线中弥补额外的时间。*

你最好减少你的小时费率，而不是搞乱你向客户展示的时间。至少通过这种方式，您可以向客户展示附加值的外观。

LM

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-20T18:57:30.740

记录您在实际项目中花费的时间，这将帮助您计划下一个项目，[PSP](http://es.wikipedia.org/wiki/Personal_Software_Process) / [TSP](http://en.wikipedia.org/wiki/Team_Software_Process)提供了一种方法来做到这一点

# eclipse - 如何在自定义 RCP 应用程序中使用网页编辑器？

> ID：305619
> 
> 赞同：3
> 
> 时间：2008-11-20T15:20:34.720
> 
> 标签：eclipse, rcp, eclipse-wtp

我想在我自己的 RCP 应用程序中使用作为 Web 工具平台一部分的“Web 工具编辑器”。我想我现在对 RCP 平台有了一些了解，但是在将它作为依赖项添加到我的项目后，我仍然不知道如何访问 pagedesigner (org.eclipse.jst.pagedesigner) 的功能。有没有人将 Web 工具平台的组件添加到 RCP 应用程序中的经验，可以给我一些提示或什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T18:41:07.463

这类请求有一个困难（我自己经常尝试包含我在 Eclipse IDE 中看到的这个或那个特性）。

诀窍是尝试识别您要引入的组件，然后尝试将其拉入您的项目，而不会引入太多依赖项。

第一步过去相当困难，但从 3.4 开始，它是使用插件间谍的问题 -`Alt-Shift-F1`当您所需的组件处于焦点时按住不放应该会给您一个工具提示，显示您的类、捆绑包等。

第二步更加棘手，我通常无法获得任何结果：

*   如果你很幸运，那么你可以在你的应用程序的启动配置/.product 中包含捆绑包。一旦您点击 Add Required Bundles，您就不会剩下 3000 个捆绑包（即您的 RCP 现在是 Eclipse）。
*   通常情况并非如此，因为 Eclipse 团队没有将您感兴趣的代码重构到 RCP 安全包中。如果是这样，那么你将不得不自己做。
*   同样，如果你很幸运，那么这将意味着将一些类从 eclipse 包中移到你自己的包中，包括内部类，这将是它的结束 - 即你想要的功能的依赖关系都在包中。
*   如果你不走运，那么你需要隔离/重新实现所需的功能，并更改复制代码的版本。

它很费力，而且很难升级。我意识到这些都不是你想听到的。

# asp.net - Windows 服务与带有线程/计时器的 asp.net Application_BeginRequest 事件

> ID：305624
> 
> 赞同：2
> 
> 时间：2008-11-20T15:22:32.907
> 
> 标签：asp.net, multithreading, windows-services, timer

使用以下方式运行基于时间的作业有哪些优点/缺点：

1.  窗口服务

2.  Application_BeginRequest 启动单独的线程/计时器。

在 asp.net web 应用程序的上下文中运行作业的一个缺点是在 .net 回收过程中必须重新设置，还有其他的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T14:51:01.953

在我看来，在网络应用程序中做基于时间的事情并没有真正的好处。直接去windows服务。您知道该过程应该一直启动并运行。

ASP.NET 站点可能会简单地卸载，并且只有在有人开始浏览时才会再次运行。生命周期全错了——它比服务更“不稳定”。

最后，服务并不难创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-10T01:22:44.477

如果您对服务器具有管理访问权限，我会根据您要实现的目标运行 Windows 服务或计划的 SQL 作业。

能够独立于您的 Web 应用程序来停止/启动和记录这些作业真是太好了。此外，如果您在工作中遇到问题或错误，可能会对您的网站产生不利影响。

最后，您将强制 Web 应用程序在**每次**请求时检查代码以查看计时器是否已过，这是不必要的开销。

正如我所说的，实施取决于工作是什么。如果只是更新一些数据库记录，我会在 SQL Server 中使用计划作业。如果您需要文件 I/O 或访问外部服务，那么 Windows 服务可能更合适。

值得注意的是，您需要将自己的调度和线程安全构建到 Windows 服务中。另一种方法是构建控制台应用程序并使用[FireDaemon](http://www.firedaemon.com/)之类的应用程序进行调度。

# daemon - 获取远程 rsync 仓库的路径

> ID：305628
> 
> 赞同：0
> 
> 时间：2008-11-20T15:24:50.953
> 
> 标签：daemon, rsync

我知道你是否在 rsync 中运行

`rsync some.domain.com::`

它会返回给我一个 rsync 仓库的列表。有没有办法让它返回仓库的详细信息，特别是路径。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T15:29:38.213

不，rsyncd 专门设计为不显示模块的物理路径。现在，如果您对 rsyncd 服务器具有 shell 访问权限，则可以阅读`/etc/rsyncd.conf`该信息。

（但是，如果`use chroot`设置关闭，可能有一些方法可以利用 rsyncd 来显示路径。不过，不要引用我的话。）

# .net - .net 中的 res://*/ 是什么？

> ID：305635
> 
> 赞同：2
> 
> 时间：2008-11-20T15:25:58.873
> 
> 标签：.net

我在 MSDN 上看到了这段代码：

```
entityBuilder.Metadata = @"res://*/AdventureWorksModel.csdl|
                            res://*/AdventureWorksModel.ssdl|
                            res://*/AdventureWorksModel.msl"; 
```

这是什么`res://*/`意思，它是如何工作的？我认为它与资源文件有关，但我不确定。

由于标点符号，谷歌没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T15:31:28.350

你有正确的想法：

[资源协议](http://msdn.microsoft.com/en-us/library/aa767740.aspx "资源协议")

编辑：顺便说一句，你应该检查[searchdotnet](http://searchdotnet.com/ "搜索点网")的技术搜索，它仍然使用谷歌但过滤 .net 的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-20T12:19:58.430

“res”协议只允许访问非托管的 win32 资源，对于托管的 .net 程序集使用新的“resx”协议：[MSDN](http://social.msdn.microsoft.com/forums/en-US/csharpgeneral/thread/097794c5-6acd-4563-8237-5e385ca7e563)

# sql-server - 从 SQL Server 触发器发送消息

> ID：305637
> 
> 赞同：3
> 
> 时间：2008-11-20T15:26:24.210
> 
> 标签：sql-server

当 SQL Server (2005) 中发生某些事情时，我需要发出正在运行的应用程序（Windows 服务）的信号。是否有可能将消息从触发器发送到同一系统上的外部应用程序？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-21T04:28:02.463

您可以使用[SQL Service Broker](http://msdn.microsoft.com/en-us/library/ms345108.aspx)队列来做您想做的事情。触发器可以创建对话并在队列上发送消息。启动时，外部进程应连接到数据库并在此队列上发出 WAITFOR (RECEIVE) 语句。当触发器发送消息时，它将接收消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T15:31:32.170

不确定 DBA 是否会同意这一点，但有一种方法可以使用[xp_cmdshell运行命令](http://msdn.microsoft.com/en-us/library/aa260689(SQL.80).aspx)

“将给定的命令字符串作为操作系统命令 shell 执行，并将任何输出作为文本行返回。授予非管理用户执行 xp_cmdshell 的权限。”

来自 MS 网站的示例：

```
CREATE PROC shutdown10
AS
EXEC xp_cmdshell 'net send /domain:SQL_USERS ''SQL Server shutting down 
   in 10 minutes. No more connections allowed.', no_output
EXEC xp_cmdshell 'net pause sqlserver'
WAITFOR DELAY '00:05:00'
EXEC xp_cmdshell 'net send /domain: SQL_USERS ''SQL Server shutting down 
   in 5 minutes.', no_output
WAITFOR DELAY '00:04:00'
EXEC xp_cmdshell 'net send /domain:SQL_USERS ''SQL Server shutting down 
   in 1 minute. Log off now.', no_output
WAITFOR DELAY '00:01:00'
EXEC xp_cmdshell 'net stop sqlserver', no_output 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T15:31:04.403

您可以从触发器发送电子邮件，但这不是推荐的做法，因为如果电子邮件系统已关闭，则无法对表进行任何数据更改。

就个人而言，如果你能忍受不到实时的情况，我会把你感兴趣的事件的信息放到另一个表中（这样即使电子邮件由于某种原因而关闭，数据的真正更改也可以顺利进行。）然后我会有一份工作每 5-10 分钟检查一次该表是否有任何新条目并将其通过电子邮件发送出去。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T18:51:08.757

您可以使用 dbmail 电子邮件消息。如果邮件服务器关闭，它不应该减慢触发器的速度，因为消息已排队，然后由外部（到 sql）进程发送。

如果应用程序可以访问 sql server，表的想法听起来不错。

您还可以通过 sql 2005 native XML Services 访问同一个表 - 它通过 xml 公开 procs。 [http://msdn.microsoft.com/en-us/library/ms345123(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms345123(SQL.90).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T19:10:38.610

根据您要发送的消息类型，您可以使用 CLR 存储过程连接到正在运行的进程上的套接字并将消息写入其中。如果您无法控制该过程（即无法修改它），您可以构建一个桥梁或使用可以以合适格式发出消息的库。

为了可靠传递，您可以使用 MSMQ 传递消息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-21T04:38:18.150

提醒一下，触发器对于这样的事情可能会有问题，因为它们嵌入在集合操作中。并且与表相关联，它们对它们被触发的上下文不是很敏感。问题可能在于它们是否触发了涉及多行的操作，因为很难避免调用与操作中的记录一样多的操作实例。例如，数百封电子邮件并非不可能。

希望“发生的事情”可以在与它们发生的上下文更紧密的关联中被检测到（尝试从触发器回溯也可能很有趣。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-22T05:53:15.350

任何一个：

*   使用 RAISERROR（严重性 10）触发 SQL 代理警报和作业。

*   加载一个单独的表，该表由单独的邮件处理进程定期轮询。（正如 HLGEM 建议的那样）

*   使用存储过程发送消息并写入表。

每个解决方案都将事务触发器与潜在的长消息调用分离。

# version-control - TFS 的多个自定义签入策略可以在同一个程序集中吗？

> ID：305644
> 
> 赞同：2
> 
> 时间：2008-11-20T15:27:42.910
> 
> 标签：version-control, tfs, customization

我正在为 TFS 实现多个自定义签入策略，我想知道它们是否都需要在同一个程序集中，或者我是否必须将每个策略都放在自己的程序集中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T08:34:32.777

没关系。只要他们实现适当的基类并实现接口。

请参阅[创建自定义签入策略](http://msdn.microsoft.com/en-us/library/bb668980.aspx)

# python - 我的应用程序在 Windows 上的缓存的适当位置

> ID：305647
> 
> 赞同：3
> 
> 时间：2008-11-20T15:28:27.433
> 
> 标签：python, windows

我的应用程序在磁盘上缓存了一些数据。由于缓存可能很大，因此不应将其存储在网络驱动器上。它应该在应用程序的调用之间持续存在。我有一种供用户选择位置的机制，但希望默认设置对平台来说是明智的和“正确的”。

这种缓存的合适位置是什么？是否有用于确定适当位置的 API？我如何从 Python 中调用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T15:40:21.217

有很多地方可以将应用程序文件放在 Windows 中。 [此页面](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)显示一个列表（此枚举是 .Net 特定的，但大多数特殊文件夹通常是 Windows 上的标准文件夹）。基本上，您需要决定是否需要每个用户的缓存，仅用于本地计算机，每个应用程序或共享等。

我对 python 没有太多经验，所以我不能专门帮助如何获得这些路径，但我相信这里有更多知识渊博的人可以。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T15:53:15.560

Windows 应用程序存储其（永久）应用程序数据的标准位置由`%APPDATA%`（当前用户）或`%ALLUSERSPROFILE%`（所有用户）环境变量引用。您可以使用例如（仅基本且不是非常优雅的错误检查！）来访问它们：

```
import os
app_path = os.getenv("APPDATA") + "\\MyApplicationData"
try:
    os.mkdir(app_path)
except WindowsError:
    # already exists 
```

现在您拥有自己的应用程序目录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T15:58:00.200

看看这里：[http](http://en.wikipedia.org/wiki/Environment_variable#User_management_variables) ://en.wikipedia.org/wiki/Environment_variable#User_management_variables 。用户目录下的任何内容都很好。如果它适用于所有用户，那么它应该是：%ALLUSERSPROFILE%。如果它针对特定用户，请确保权限正确。

查看 MSDN 以了解有关其他 Windows 版本的更多信息。环境变量可能因系统而异。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T15:31:47.957

也许该[`tempfile`](http://docs.python.org/library/tempfile.html)模块提供了您需要的东西。它使用 Windows Temp 目录（可能不在网络驱动器上），但您可以根据需要指定一个目录。同样出于安全原因，该模块应该是正确的工具 - 如果您使用`tempfile.mkstemp()`该文件，则该文件只能由创建用户 ID 读写。

哦。我看到您刚刚编辑了您的问题，并且您需要在应用程序调用之间保持文件持久性。然后`tempfile`不是那么理想（即使您可以选择在调用之间不删除缓存）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T16:46:38.260

该[`wx.StandardPaths`](http://wxpython.org/docs/api/wx.StandardPaths-class.html)模块包含返回文件系统中各种标准位置的方法，并透明地尝试在 Unix、Mac OS X 和 Windows 下做“正确的事情”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-06-22T01:09:03.770

一个方便的包是[appdirs](https://github.com/ActiveState/appdirs)，它支持 Windows 和大多数其他操作系统。例如，为“Author”发布的“MyApp”1.0 版创建缓存目录为：

```
import os
from appdirs import user_cache_dir

dirname = user_cache_dir("AppName", "Author", "v1.0")
# C:\Users\username\AppData\Local\Author\AppName\Cache\v1.0

# create it, if it doesn't exist
os.makedirs(dirname, exist_ok=True) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-20T15:36:00.057

应用程序是否有用户可以指定的任何偏好、设置或选项？如果是这样，请添加一个选项，用户可以在其中指定数据的位置，默认为当前 Windows 临时目录。

他们总是有可能在临时目录的驱动器上没有足够的空间，并且需要使用不同的驱动器/目录。

# c# - 方法是什么 意思是？

> ID：305651
> 
> 赞同：46
> 
> 时间：2008-11-20T15:29:57.977
> 
> 标签：c#, class, oop, generics, syntax

我已经看过几次这种语法了，我开始担心了，

例如：

```
iCalendar iCal = new iCalendar();
Event evt = iCal.Create<Event>(); 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-20T15:31:11.500

它是一个通用方法，使用类型参数声明 Create，并查看此链接以获取更多信息：

*   [C# 泛型简介](http://msdn.microsoft.com/en-us/library/ms379564(vs.80).aspx)
*   [泛型（C# 编程指南）](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/generics/)
*   [通用方法](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/generics/generic-methods)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-11-20T15:30:40.783

它正在调用一个通用方法 - 所以在你的情况下，该方法可以这样声明：

```
public T Create<T>() 
```

您可以在尖括号中指定类型参数，就像创建泛型类型的实例一样：

```
List<Event> list = new List<Event>(); 
```

这有帮助吗？

*泛型方法*和泛型*类型*之间的一个区别是编译器可以尝试推断类型参数。例如，如果您的`Create`方法是：

```
public T Copy<T>(T original) 
```

你可以打电话

```
Copy(someEvent); 
```

并且编译器会推断出您的意思是：

```
Copy<Event>(someEvent); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T15:35:06.923

这是您在 C# 中提到泛型方法的方式。

当你定义一个泛型方法时，你的代码如下：

```
return-type MethodName<type-parameter-list>(parameter-list) 
```

当您调用泛型方法时，编译器通常会从指定的参数推断类型参数，如下例所示：

```
Array.ForEach(myArray, Console.WriteLine); 
```

在这个例子中，如果“myArray”是一个字符串数组，它将调用 Array.ForEach<string>，如果它是一个 int 数组，它将调用 Array.ForEach<int>。

有时，编译器不可能从参数中推断出类型（就像您的示例一样，根本没有参数）。在这些情况下，您必须像这样手动指定它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T15:44:42.177

它是实现[工厂方法](http://en.wikipedia.org/wiki/Factory_method_pattern)模式的通用方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T15:35:30.913

这种语法只是将泛型应用于方法。它通常用于您想要控制方法的返回类型的场景。你会在使用 IoC 框架的代码中发现很多这种语法。

# c++ - 2个SQL连接产生的死锁，每个使用事务，不同的表，两个表之间的外键约束

> ID：305664
> 
> 赞同：4
> 
> 时间：2008-11-20T15:32:33.387
> 
> 标签：c++, sql, sql-server, sqlncli

# 环境

我正在开发一个使用 SQL Native Client 9.0 与 SQL Server 2000 数据库通信的 C++ 应用程序。

# 设想

*   2 个连接打开到 DBMS
*   每个连接都设置为使用事务
*   关于`Connection1`作品的查询`TableA`
*   关于`Connection2`作品的查询`TableB`
*   `TableB``key_id`对中的字段有外键约束`TableA`

我构造了执行以下操作的函数：

```
begin a transaction on Connection1 & Connection2
prepare a query in TableA on Connection1
prepare a query on TableB on Connection2

begin loop over some_data
   (1) insert into key_id on TableA

   begin loop over some_other_data
      (2) insert into TableB using same key_id as in Table A
   end loop
end loop

commit on Connection1
commit on Connection2 
```

我遇到的是查询`(1)`成功执行，但只要调用 SQLExecute 进行查询`(2)`，调试器就会在永不着陆。

# 问题

我是否正确地将正在发生的事情诊断为死锁问题？

我收集到，因为`Connection`1 正在创建一个键`TableA`但没有提交它，然后由于外键约束，它`Connection2`试图向其中添加信息`TableB`，因此该键必须存在于`TableA`. 因此，`SQLExecute`查询阻塞，等待事务完成，由于代码的编写方式，在完成写入`TableA`之前它无法执行此操作。`TableB`

# 补充笔记

我可以并且已经围绕这个问题进行了编码，但我想确保我对这个问题的理解是正确的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T16:16:30.193

TableB 对 TableA 的外键约束必须检查以确认键的存在。然后它将接受或拒绝 TableB 记录。

因为包含键的 TableA 记录（在不同的连接上）尚未提交，所以外键约束必须等待 - 插入不会返回，直到 TableA 记录被提交或回滚。

因为第一个连接上的提交等待 TableB 插入返回......你有死锁。

换句话说，你是对的。

# c# - 您如何为 MDI 客户区域中的拖动/拖放事件设置处理程序？

> ID：305665
> 
> 赞同：0
> 
> 时间：2008-11-20T15:32:51.607
> 
> 标签：c#, .net, winforms, drag-and-drop, mdi

使用 C# 和 .Net 框架 2.0。我有一个 MDI 应用程序，需要处理拖动/拖放事件。我有一个停靠在我的应用程序左侧的列表，并且希望能够从列表中拖动一个项目并将其放在 MDI 客户区域中，并为该项目打开正确的 MDI 子项。我似乎无法弄清楚在哪里附加处理程序。我已经尝试附加到主窗体的事件和作为窗体一部分的 MdiClient，但是当我期望它们调用时，似乎都没有调用事件处理程序。

我也在使用 Infragistics 选项卡式 MDI 管理器，所以我不确定这是否会影响它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T16:16:51.690

我有一个实现 Infragistics MDI DockManager（不是 Tabbed MDI）的应用程序，但我认为它们非常相似。当您处理 MDI 表单事件时，它应该可以工作。

*   MDIForm.AllowDrop 设置为真？
*   您尝试拖动的对象是否可序列化？
*   尝试 DragEnter 事件而不是 DragOver

作为最后的手段：如果一切都失败了，请尝试联系 Infragistics 支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-25T10:08:53.040

这段代码对我有用。它会在 MDI 父窗体上放置一些文本时打开一个新的 MDI 子级。

```
...
using System.Linq;
...

public partial class Form1 : Form
{
    MdiClient mdi_client;
    public Form1()
    {
        InitializeComponent();
        mdi_client = this.Controls.OfType<MdiClient>().FirstOrDefault();
        mdi_client.AllowDrop = true;
        mdi_client.DragEnter += Form1_DragEnter;
        mdi_client.DragDrop += Form1_DragDrop;
    }

    private void Form1_DragDrop(object sender, DragEventArgs e)
    {
        myForm m = new myForm();
        m.Text = (string)e.Data.GetData(typeof(string));
        m.MdiParent = this;
        m.Show();
        m.Location = mdi_client.PointToClient(new Point(e.X, e.Y));
    }

    private void Form1_DragEnter(object sender, DragEventArgs e)
    {
        e.Effect = DragDropEffects.All;
    }
} 
```

# sql - NVARCHAR(3000) 会导致什么问题

> ID：305668
> 
> 赞同：4
> 
> 时间：2008-11-20T15:33:15.257
> 
> 标签：sql, sql-server, sql-server-2005

我有一张已经很大的桌子，我的客户要求我延长备注字段的长度。notes 字段已经是 NVARCHAR(1000)，我被要求将其扩展为 3000。长期解决方案是将便笺移出表并创建一个使用仅连接的 NVARCHAR(max) 字段的便笺表在必要时。我的问题是关于短期的。知道该字段将来会被移出，如果我现在将该字段增加到 NVARCHAR(3000)，我会遇到什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T19:23:25.680

不推荐使用 text 和 ntext 以支持 varchar(max) 和 nvarchar(max)。所以 nvarchar(3000) 应该没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T15:47:04.557

您可能已经知道这一点，但只要确保增加的长度不会使您的总记录长度超过 8000。我很确定这仍然适用于 2005/2008 年。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T15:51:12.070

对于临时解决方案，您应该可以使用 nvarchar(3000) 。您最多可以使用 nvarchar(4000)。正如 km.srd.myopenid.com 之前发布的那样，确保行的整个长度不超过 8000（请记住，nvarchar 是常规 varchar 大小的 2 倍——这就是为什么你只能使用 nvarchar(4000 )，但您可以使用 varchar(8000))。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T18:01:38.763

我建议将列更改为 NTEXT。您对数据量几乎没有限制，并且数据不会与其余的行数据一起存储。这有助于防止您达到最大行大小限制。

唯一的缺点是您只能在该列上执行“LIKE”搜索，并且不能对其进行索引。但是，如果它是一个注释字段，我猜你根本没有对其进行任何搜索。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T21:24:18.137

您可能还会遇到更慢的情况，因为您的数据页面可能会被拆分以适应更大的字段。通过这样做，您可以创建一个允许超过 8060 字节的记录的结构，但请注意，如果您尝试添加实际包含的数据记录多于该数据记录，则会出现问题。

# data-structures - 用于平面文件处理的适当数据结构？

> ID：305673
> 
> 赞同：3
> 
> 时间：2008-11-20T15:34:27.330
> 
> 标签：data-structures, flat-file

本质上，我必须将平面文件放入数据库。平面文件的每行前两个字符指示它是哪种类型的记录。

我是否为每个记录类型创建一个类，其属性与记录中的字段匹配？我应该只使用数组吗？

我想在将数据保存到数据库之前将数据加载到某种数据结构中，以便我可以使用单元测试来验证数据是否正确加载。

这是我必须使用的示例（BAI2 银行对账单）：

```
01,121000358,CLIENT,050312,0213,1,80,1,2/

02,CLIENT-STANDARD,BOFAGB22,1,050311,2359,,/

03,600812345678,GBP,fab1,111319005,,V,050314,0000/

88,fab2,113781251,,V,050315,0000,fab3,113781251,,V,050316,0000/

88,fab4,113781251,,V,050317,0000,fab5,113781251,,V,050318,0000/

88,010,0,,,015,0,,,045,0,,,100,302982205,,,400,302982205,,/

16,169,57626223,V,050311,0000,102 0101857345,/

88,LLOYDS TSB BANK PL 779300 99129797

88,TRF/REF 6008ABS12300015439

88,102 0101857345 K BANK GIRO CREDIT

88,/IVD-11 MAR

49,1778372829,90/

98,1778372839,1,91/

99,1778372839,1,92 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T15:38:55.183

我建议创建类（或结构，或您的语言支持的任何值类型），如

```
record.ClientReference 
```

比

```
record[0] 
```

而且，如果您使用的是（很棒的！）[FileHelpers Library](http://www.filehelpers.com/)，那么您的条款几乎是为您规定的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T15:47:43.933

验证逻辑通常至少有 2 个级别，较粗的级别是“格式良好的”，而较细的级别是“正确的数据”。

这里有几个单独的问题。一个问题是简单地验证数据，或编写测试以确保您的解析是准确的。一个简单的方法是解析成一个接受给定范围值的类，如果不是，则抛出适当的错误，例如

public void setField1(int i) { if (i>100) throw new InvalidDataException... }

如果不同代码的解析逻辑显着不同，那么您可能需要为每种记录类型创建不同的类，因此您没有像这样的条件逻辑

```
 public void setField2(String s)
   {
         if (field1==88 && s.equals ...

         else if (field2==22 && s 
   } 
```

耶赫。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T15:55:32.387

过去当我不得不加载此类数据时，我将它们全部放入工作表中，前两个字符在一个字段中，其余字符在另一个字段中。然后我根据前两个字符将其解析为适当的其他工作表。然后我在将第二组工作表中的数据插入数据库之前进行了任何清理和验证。

在 SQL Server 中，您可以通过 DTS (2000) 或 SSIS 包并使用 SSIS 来执行此操作，您可以先存储在工作表中来动态处理数据，但过程很简单，使用前两个字符确定要使用的数据流分支，然后将记录的其余部分解析为某种类型的保存机制，然后在插入之前进行清理和验证。我确信其他数据库也有某种类型的数据导入机制，并且会使用类似的过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T16:02:04.200

我同意，如果您的数据格式有任何复杂性，您应该创建一组自定义类来解析和保存数据、执行验证并执行任何其他适当的模型任务（例如，返回人类可读的描述，尽管有些会认为这会更好地放入单独的视图类中）。这可能是使用继承的好情况，您有一个父类（可能是抽象的）定义所有类型记录共有的属性和方法，并且每个子类可以覆盖这些方法以在必要时提供自己的解析和验证，或者添加自己的属性和方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T16:09:28.863

为每种类型的行创建一个类将是比使用数组更好的解决方案。

然而，这就是说，在过去我使用 Hashtables 的 Arraylists 来完成同样的事情。arraylist 中的每一项都是一行，hashtable 中的每一项都是一个键/值对，表示列名和单元格值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-20T16:52:52.413

为什么不从设计将保存数据的数据库开始，然后您可以使用实体框架为您生成类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-20T18:50:25.967

这是一个古怪的想法：

如果您在 Perl 中工作，则可以使用[DBD::CSV](http://search.cpan.org/dist/DBD-CSV/lib/DBD/CSV.pm)从平面文件中读取数据，前提是您为其提供了正确的分隔符和 EOL 字符值。然后，您将通过 SQL 语句从平面文件中读取行；DBI 将为您将它们变成标准的 Perl 数据结构，并且您可以运行任何您喜欢的验证逻辑。一旦每一行都通过了所有验证测试，您就可以使用 DBD::whatever 将其写入目标数据库。

-史蒂夫

# database - 当浏览器重新加载/返回时，如何防止再次写入数据库？

> ID：305684
> 
> 赞同：5
> 
> 时间：2008-11-20T15:36:54.733
> 
> 标签：database, perl, cgi, idempotent

我正在组合一个写入数据库（Perl CGI 和 MySQL）的小型 Web 应用程序。CGI 脚本从表单中获取一些信息并将其写入数据库。然而，我注意到，如果我在网络浏览器上点击“重新加载”或“返回”，它会再次将数据写入数据库。我不想要这个。

在这种情况下，防止数据被重写的最佳方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-20T15:47:31.890

不要使用 GET 请求进行修改！RESTful ; [_](http://en.wikipedia.org/wiki/Representational_State_Transfer) 使用 POST（或 PUT）代替浏览器应该警告用户不要重新加载请求。在 POST/PUT 请求之后使用普通的 GET 请求重定向（[使用 HTTP 重定向）到收据页面，这样就可以刷新页面而不会收到有关重新提交的警告。](http://en.wikipedia.org/wiki/URL_redirection#HTTP_status_codes_3xx)

*编辑：*

我假设用户以某种方式登录，因此您已经有了一些跟踪用户的方法，例如会话或类似的。

您可以在显示表单时制作时间戳（或随机哈希等），并将其存储为隐藏字段（*除了反跨站点请求令牌之外，我确信您已经拥有了*）和会话变量（它安全地存储在您的服务器上），当您收到此表单的 POST/PUT 请求时，您检查时间戳是否与会话中的时间戳相同。如果是这样，您将会话中的时间戳设置为变量且难以猜测（例如时间戳与一些秘密字符串连接），然后您可以保存表单数据。如果有人现在重复请求，您将不会在会话变量中找到相同的值并拒绝该请求。

这样做的问题是，如果用户单击返回以更改某些内容，则该表单无效，并且可能有点苛刻，除非您要更新的是钱。因此，如果您遇到“愚蠢”用户刷新并单击后退按钮从而意外重新发布某些内容的问题，那么仅使用 POST 会提醒他们不要这样做，并且重定向会降低这种可能性。如果您遇到恶意用户的问题，您也应该使用时间戳，尽管它有时会使用户感到困惑，尽管如果用户故意一遍又一遍地发布相同的消息，您可能需要找到一种方法来禁止他们。使用 POST，有一个时间戳，甚至对整个数据库进行全面比较以检查重复的帖子，都不会 如果恶意用户只是编写一个脚本来加载表单并自动提交随机垃圾，那根本没有帮助。（但是跨站点请求保护使这变得更加困难）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-20T15:57:43.897

使用 POST 请求将导致浏览器尝试阻止用户再次提交相同的请求，但我建议使用某种基于会话的事务跟踪，这样如果用户忽略来自浏览器的警告并重新提交他的查询您的应用程序将防止对数据库的重复更改。您可以在提交表单中包含一个隐藏输入，并将值设置为加密哈希，并在请求被提交和处理时记录该哈希。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-20T15:57:37.873

我发现跟踪用户在会话中提交的表单数量很方便。然后在呈现表单时，我创建一个包含该数字的隐藏字段。如果用户然后通过按下后退按钮重新提交表单，它将提交旧的 # 并且服务器可以通过检查会话中的内容和表单所说的内容来判断用户已经提交了表单。

只是我的2美分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-21T02:05:03.313

如果您还没有使用某种会话管理（它可以让您记录和跟踪表单提交），一个简单的解决方案是在表单中包含某种唯一标识符（作为隐藏元素），它是任何一部分主数据库事务本身，或在单独的数据库表中跟踪。然后，当您提交表单时，您会检查唯一 ID 以查看它是否已被处理。每次呈现表单本身时，您只需要确保您有一个唯一的 ID。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-22T03:46:48.520

首先，你不能信任浏览器，所以任何关于使用 POST 而不是 GET 的讨论大多都是书呆子 flim-flam。是的，客户可能会收到类似“您是否打算再次重新提交此数据？”的警告，但他们很可能会说“是的，现在别管我了，愚蠢的计算机”。

正确的是：如果您不想重复提交，那么要解决的是您的问题，而不是用户的问题。

您大概知道重复提交意味着什么。可能是几秒内的同一个IP，也可能是同一个博文标题或者最近提交的URL。也许它是值的组合——例如，IP 地址、电子邮件地址和联系表单提交的主题标题。无论哪种方式，如果您在数据中手动发现了一些重复项，您应该能够找到一种在提交时以编程方式识别重复项的方法，或者将其标记为手动批准（如果您不确定），或者只是告诉提交者“你双击了吗？” （如果信息不是非常机密，您可以出示您为他们提供的现有记录并说“这是您要发送给我们的吗？如果是这样，您已经完成了 - 万岁”）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-22T11:14:12.660

我不会依赖来自浏览器的 POST 警告。用户只需单击“确定”即可使消息消失。

任何时候你都会有一个只需要一次的请求，例如“付款”，发送一个唯一的令牌，它会与请求一起提交回来。令牌返回后将其扔掉，因此您现在可以判断某事何时是有效提交（任何具有非“活动”令牌的事）。在 X 时间后过期活动令牌，例如当用户会话结束时。

（交替跟踪已返回的令牌，如果您之前收到过，则无效。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-12T15:25:05.123

每次更改数据时执行 POST，但永远不要从帖子返回 HTML 响应...而是返回重定向到 GET，该 GET 将更新的数据作为确认页面检索。这样，就不用担心他们刷新页面了。如果它们刷新，将发生的只是另一次检索，而不是更改数据的操作。

# asp-classic - 您可以关闭 VBScript 字符串中的大小写敏感吗？

> ID：305688
> 
> 赞同：2
> 
> 时间：2008-11-20T15:38:30.177
> 
> 标签：asp-classic, vbscript

我很确定这个问题的答案是否定的。我知道我会写

> 如果 lcase(strFoo) = lcase(request.querystring("x")) 那么...

或使用 inStr，但我只是想检查注册表中或某处是否存在使 VBScript 字符串的内容与脚本语言的其余部分一致的地方是否存在一些未记录的设置！

谢谢丹

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-22T00:44:03.337

有一个[`StrComp`](http://msdn.microsoft.com/en-us/library/ya4w6fwy(VS.85).aspx)函数允许通过`vbTextCompare`作为第三个参数传递来对两个字符串进行不区分大小写的比较。主要文档并没有说明这一点，但在这篇“[嘿，脚本专家](http://www.microsoft.com/technet/scriptcenter/resources/qanda/jun05/hey0622.mspx "无论字母大小写如何比较两个字符串值？")”文章中对其进行了讨论。

例如：

```
If StrComp(strFoo, Request.QueryString("x"), vbTextCompare) = 0 Then ... 
```

然而，在实践中，我使用`LCase`or`UCase`方式比`StrComp`不区分大小写的字符串比较更多，因为它对我来说更明显。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-20T15:51:10.617

不。根据功能，选项可能作为可选参数存在（例如 InStr），但对于直接比较，没有全局选项。

一个鲜为人知的方便的选项是，如果您有一个字符串列表并且您想查看一个字符串是否在该列表中：

```
Dim dicList : Set dicList = CreateObject("Scripting.Dictionary")
Dim strTest

dicList.CompareMode = 0 ' Binary ie case sensitive
dicList.Add "FOO", ""
dicList.Add "BAR", ""
dicList.Add "Wombat", ""

strTest = "foo"
WScript.Echo CStr(dicList.Exists(strTest))

Set dicList = CreateObject("Scripting.Dictionary")
dicList.CompareMode = 1 ' Text ie case insensitive
dicList.Add "FOO", ""
dicList.Add "BAR", ""
dicList.Add "Wombat", ""

strTest = "foo"
WScript.Echo CStr(dicList.Exists(strTest)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T15:50:11.057

我怀疑这种选项的存在，因为如果有类似的东西并且你使用它，你将失去以区分大小写的方式比较字符串的能力。

# c# - C#中如何判断一个字符串是否为数字

> ID：305690
> 
> 赞同：11
> 
> 时间：2008-11-20T15:38:39.597
> 
> 标签：c#, .net, string, value-type

我正在开发一个工具，我需要将字符串值转换为正确的对象类型。例如，将字符串转换`"2008-11-20T16:33:21Z"`为`DateTime`值。`"42"`像和这样的数值`"42.42"`必须分别转换为一个`Int32`值和一个`Double`值。

检测字符串是整数还是数字的最佳和最有效的方法是什么？是`Int32.TryParse`或`Double.TryParse`要走的路吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-20T15:41:50.153

`Int.TryParse`并`Double.TryParse`有实际返回号码的好处。

类似的东西`Regex.IsMatch("^\d+$")`的缺点是您仍然必须再次解析字符串才能获取值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-20T15:40:52.400

就效率而言，是的，TryParse 一般是首选路线。

如果您可以提前知道（例如，通过反射）目标类型 - 但不想使用`switch`大块，您可能有兴趣使用`TypeConverter`- 例如：

```
 DateTime foo = new DateTime(2008, 11, 20);
        TypeConverter converter = TypeDescriptor.GetConverter(foo);
        string s = converter.ConvertToInvariantString(foo);
        object val = converter.ConvertFromInvariantString(s); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T15:46:23.793

我会亲自推荐 .TryParse() 。反正我就是这么用的。那就是如果您的数据不时出现错误。如果您确定传入的字符串能够毫无障碍地转换为整数或双精度数，那么 .Parse() 会更快。

这是一个有趣的[链接](http://dotnetperls.com/Content/Int-Parse-Conversion.aspx)来支持这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T16:08:54.577

保持转换器跳过开关块的想法，您可以使用 Duck Typing 的概念。基本上，您想将字符串转换为 X，因此您创建了一个方法，如果 X 上有 TryParse，则该方法将调用 X.TryParse(string, out X x) ，否则您就不用费心了（或者我想您可以抛出一个错误）。你会怎么做？反射和泛型。

基本上，您将拥有一个接收类型并使用反射来查看它是否具有 TryParse 的方法。如果您找到这样的方法，然后调用它并返回 TryParse 设法获得的任何内容。这适用于几乎任何值类型，例如 Decimal 或 DateTime。

```
public static class ConvertFromString
{
  public static T? ConvertTo<T>(this String numberToConvert) where T : struct
  {
    T? returnValue = null;

    MethodInfo neededInfo = GetCorrectMethodInfo(typeof(T));
    if (neededInfo != null && !numberToConvert.IsNullOrEmpty())
    {
      T output = default(T);
      object[] paramsArray = new object[2] { numberToConvert, output };
      returnValue = new T();

      object returnedValue = neededInfo.Invoke(returnValue.Value, paramsArray);

      if (returnedValue is Boolean && (Boolean)returnedValue)
      {
        returnValue = (T)paramsArray[1];
      }
      else
      {
        returnValue = null;
      }    
    }

    return returnValue;
  }
} 
```

GetCorrectMethodInfo 看起来像这样：

```
private static MethodInfo GetCorrectMethodInfo(Type typeToCheck)
{

  MethodInfo returnValue = someCache.Get(typeToCheck.FullName);

  if(returnValue == null)
  {
    Type[] paramTypes = new Type[2] { typeof(string), typeToCheck.MakeByRefType() };
    returnValue = typeToCheck.GetMethod("TryParse", paramTypes);
    if (returnValue != null)
    {
      CurrentCache.Add(typeToCheck.FullName, returnValue);
    }
  }

  return returnValue;
} 
```

用途是：

```
decimal? converted = someString.ConvertTo<decimal>(); 
```

我讨厌堵住自己，但我在这里充分解释了这一点：

[获取正确方法信息](http://byatool.com/?p=89)

[其余的](http://byatool.com/?p=94)

# java - Java 开发的最佳 Eclipse 版本

> ID：305708
> 
> 赞同：4
> 
> 时间：2008-11-20T15:41:50.480
> 
> 标签：java, eclipse, ide

用于 Java 开发的 Eclipse 有很多版本。我正在试用 MyEclipse，并且对开箱即用的体验印象深刻。在我适应它之前，我想知道它是否是最好的版本。随意列出免费或商业包，但为了其他读者，请提及是否有费用。

## 注意事项

我最关心的是代码编辑体验。以下列出了*一些*会影响我的决定的因素：

*   对重构的广泛支持
*   代码建议（例如建议重构）
*   易于配置的键盘快捷键
*   易于配置的颜色（我使用深色方案，使用 MyEclipse 进行设置简直就是地狱；也就是说，我真的只需要这样做一次）
*   出色的调试支持
*   源代码控制插件（SVN 或 git，如果存在）
*   不关心 GUI 设计师

我知道有一个线程讨论 Java 开发的最佳 IDE；但是，大多数回复都没有详细说明 Eclipse 的推荐版本。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-20T15:48:30.123

我总是只下载**经典**版并添加我需要的插件。这样我就可以使 Eclipse 尽可能精简。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T15:50:16.657

除了颜色之外的所有内容都适用于**香草 Eclipse 3.4 + Subclipse**。如果您发现在 Eclipse 中自定义颜色的简单方法，请告诉我们。

在那之前，您不得不手动更改每种颜色。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T15:50:46.203

实际上，您提到的几乎所有内容都存在于 eclipse.org 上的普通旧版“面向 Java 开发人员的 Eclipse IDE”(85MB) 中。它的占用空间比 MyEclipse 等其他一些小得多。不过，您需要安装一个 SVN 插件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T16:29:43.723

同意[Marko](https://stackoverflow.com/questions/305708/best-eclipse-version-for-java-development#305743)和[Epaga](https://stackoverflow.com/questions/305708/best-eclipse-version-for-java-development#305749)

我有带有以下附加插件的 Eclipse 3.4 (Ganymede)（链接是更新站点 URL）：

*   [颠覆](http://subclipse.tigris.org/update_1.4.x)的子剪辑
*   [Spring 的Spring IDE](http://springide.org/updatesite)。最喜欢的功能：高级 spring xml 完成和 bean 可视化。
*   [Maven 的m2eclipse](http://m2eclipse.sonatype.org/update/)。最喜欢的功能：传递依赖树和图形可视化。

# https - 在一个 apache 实例上仅禁用一个 URL 的非安全访问

> ID：305738
> 
> 赞同：2
> 
> 时间：2008-11-20T15:47:30.423
> 
> 标签：https, apache2

例如，一个 apache 实例正在管理

> www.site.com/folder1/a.html
> 
> www.site.com/folder2/b.html
> 
> www.site.com/folder3/c.html

我需要确保 `www.site.com/folder3/c.html` 只能访问 https。

所有这些文件夹都在同一个文档根目录中。

这可能吗？如果没有，您推荐什么作为获得我想要的所需的最小更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-20T16:30:07.577

你可以试试这个解决方案：

```
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule ^/folder3/c.html$ https://www.site.com/folder3/c.html$1 [R,L] 
```

使用此解决方案，您还可以定义应用哪种重定向。而且，最重要的是，该规则只会在 HTTP 方案中运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T15:54:36.243

我相信您可以在 Apache 配置中执行以下操作：

```
RedirectMatch /folder3/(.*) https://www.site.com/folder3/$1 
```

不确定这是否正确。

希望有帮助...

# generics - 向下转换对性能有何影响？

> ID：305755
> 
> 赞同：5
> 
> 时间：2008-11-20T15:51:17.357
> 
> 标签：generics, c#-2.0

只是想通过阅读[Juval Lowy 的这篇富有启发性的文章来了解泛型](http://msdn.microsoft.com/en-us/library/ms379564.aspx)

释义.. 当您定义一个 Generic 类定义时，它会被编译成 IL。

*   对于值类型，只要您请求特定的值类型，它就会用您的特定值类型替换 T 以获得该特定配置的 IL，例如`MyList<int>` **好处：没有装箱和拆箱处罚。**
*   很好.. 对于引用类型，编译器用 Object 替换定义中的所有 T 实例，并创建用于所有 ref 类型的 IL。然而，实例是根据实际请求的 ref 类型分配的，例如`MyList<String>`

现在，我们可以编写带有参数的预泛型方法`Object`。泛型声称 100% 的性能改进，因为“*它避免了当你想使用它时将对象类型向下转换为特定类型时所招致的性能损失”*

```
 // assume GetItem returns an Object
 string sMyPreciousString = (string) obList.GetItem(); 
```

当您从 Object 向下转换为特定的引用类型时，这种性能会受到什么影响？此外，向上转换对象（甚至泛型也会这样做）似乎不会影响性能。为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T15:53:23.343

向上转换到对象不需要执行时间检查 - 它总是可以工作，并且基本上只是一个无操作。

例如，向下转换需要执行时间检查以确保您没有将 Stream 转换为 String。这是一个很小的惩罚，而且不太可能成为瓶颈——但避免它只是泛型的一个额外好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T15:55:33.637

性能损失来自对运行时类型检查的需要。如果 B 是 A 的子类，那么当您将 B 转换为 A 时，您在编译时就知道它是安全的，因为所有 B 都是 As。因此，您不需要生成任何运行时代码来检查类型。

但是，当您将 A 转换为 B 时，您在编译时不知道 A 是否实际上是 B。它可能只是一个 A，也可能是 C 类型，是 A 的不同子类型。因此，您需要生成运行时代码，以确保对象实际上是 B，如果不是，则抛出异常。

泛型没有这个问题，因为编译器在编译的时候就知道数据结构中只有Bs，所以当你拉出一些东西时，编译器知道它会是B，所以不需要在运行时进行类型检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T16:04:03.883

阅读生成的 IL（[本文](http://www.hanselman.com/blog/BackToBasicsThisIsNotTheObjectYoureLookingwaitOhItIsTheObject.aspx)提到了它）......啊哈 - isinst。

如果您没有垂头丧气，则不必致电[isinst](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.isinst.aspx)。

# licensing - 您如何对可再发行控件库实施许可？

> ID：305759
> 
> 赞同：2
> 
> 时间：2008-11-20T15:52:17.433
> 
> 标签：licensing, redistributable, control-library

如果您有一个想要授权给开发人员的 WPF 控件库，如何强制执行许可证限制，以便该库可以在他们自己的应用程序中使用和分发，同时防止最终用户重用该 .dll？

我从严格的商业角度来处理这个问题，所以我试图找到一个解决方案，它不会允许不分青红皂白的用户做一些简单的事情，比如用密钥传递 .dll 并能够共享它。

对此的任何想法都是绝对受欢迎的，并且可以随意提出哲学观点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T16:01:43.060

严格来说，这类问题真的很难完全解决，而且无论你做什么，都有可能（尽管它可能已经够难了）改变验证许可证的 IL 代码并完全绕过检查。但是，如果您对它真的很满意，您可以强制您的客户将其应用程序的编译版本提交给您，以便对其应用强名称（使用您的私钥）。这样，您可以对照只有您拥有的特定密钥检查调用程序集的公钥令牌。我绝不建议将这种方法用于通用，但如果确实有必要这样做，这可能会奏效。请记住，在您的程序集中找到许可证检查代码并将其完全删除可能需要几个小时。这将使任何许可限制无效！

# svn - 提交挂钩失败

> ID：305769
> 
> 赞同：2
> 
> 时间：2008-11-20T15:54:44.603
> 
> 标签：svn, visualsvn-server

我正在尝试实现一些钩子，但是前后都失败了。当我尝试提交时，我收到相同的错误消息：

```
'*-commit' 挂钩失败（没有完全退出：apr_exit_why_e 为 2，exitcode 为
-1073741515）。没有输出。

```

退出代码 -1073741515 看起来很奇怪，快速搜索一下 google-fu 让我明白了这一点：

> 被视为十六进制 DWORD，您看到的错误代码是 0xC0000135。
> 
> 即 Sev=11, C=0, R=0, Facility=0, Code=0x0135。
> 
> 值 0xC0000135 可以在 NtStatus.h 中找到，定义如下

```
//
// MessageId: STATUS_DLL_NOT_FOUND
//
// MessageText:
//
//  {Unable To Locate Component}
//  This application has failed to start because %hs was not found.
// Re-installing the application may fix this problem.
//
#define STATUS_DLL_NOT_FOUND             ((NTSTATUS)0xC0000135L) 
```

好吧，dll没找到，应该不会太难吧？我有一个带有 svn 的虚拟机，它对这些钩子很平静。所以我在两台机器上运行 Filemon.exe 和 Depends.exe。

我仍在苦苦浏览两台服务器的 filemon 日志，并且对于任何我认为被 Commit Hook 命中的可执行文件都没有给我任何独特的问题。

我决定快速浏览一下事件日志，哦，天哪！

> 'pre-commit' 挂钩失败（没有完全退出：apr_exit_why_e 为 2，exitcode 为 -1073741515）。没有输出。[409, #165001]

额外的信息，这个 [409, #165001] 遍布谷歌，但我并没有真正找到任何有用的东西。

该钩子显式调用具有三个参数的可执行文件。

> C:\SubversionNotify\SubversionNotify.exe %1 %2 -pre

我什至也尝试过使用变量。

```
SET REPOS=%1
SET REV=%2
C:\SubversionNotify\SubversionNotify.exe %REPOS% %REV% -pre 
```

查看 filemon 日志显示它永远不会进入 SubversionNotify.exe

它已经到了我不能花更多时间尝试实现这一点的地步，请帮助我，你是我唯一的希望。

服务器规格：

> Windows XP，运行 VisualSVN 服务器，最新版本。

编辑：似乎 SubversionNotify 正在抛出异常，返回 Depends.exe 以检查哪些 dll 失败。

错误如下：

> 应用程序未能正确初始化 (0xc0000135)。

那个 0xC0000135 之前看到过，dll 狩猎啊！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T16:01:14.827

通常，提交挂钩的问题是绝对没有环境（因此没有路径），所以所有引用都必须非常明确。我通常最终会制作一个小批处理文件，将目录更改为正确的目录并执行命令。

编辑：

尝试将目录更改为 C:\SubversionNotify

也许您缺少运行程序所需的一些运行时 dll。记住：没有路径。您可以通过在命令行窗口中将路径设置为 NOTHING 来模拟这一点。设置路径=。

验证像记事本这样的简单命令不起作用。那你的exe能用吗？找出丢失的 dll 在哪里，并在批处理文件的开头构建一个路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T17:41:46.790

我想我会在这里分享解决方案，因为我笑得很开心。

SubversionNotify 是用 .NET 编写的。
服务器没有安装 .NET Framework。
虚拟机做到了。

我现在戴着一顶傻帽。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-06T02:46:03.333

感谢您发布您的答案。如果你不这样做，我会花更多的时间试图解决这个问题，并且感觉比现在更愚蠢。刚刚吹出一个盒子并安装了 VisualSVN 和 SubversionNotify，但无法弄清楚为什么它不起作用。

# video - 如果您必须添加对一种视频文件格式和编解码器的支持，您会选择哪一种？

> ID：305773
> 
> 赞同：2
> 
> 时间：2008-11-20T15:55:34.417
> 
> 标签：video, file-io, file-format, codec

我希望在我的应用程序中添加对读取和写入视频文件的支持。如果您必须选择一种能够满足大多数用户的文件格式和编解码器组合，您会选择哪种：

1) MPEG-4/H.264 (.mp4) 2) AVI/DiVX (.avi) 3) Ogg/Theora (.ogg) 4) Windows Media Video (.wmv)

我倾向于 MPEG-4/H.264，因为它在 Linux、Mac OS X、Flash 播放器、iPod、Playstation 3、XBox360 中得到支持，并且即将在 Microsoft Silverlight 和 Windows Media Player 12 中得到支持。

我错过了什么吗？我可以选择更好的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T16:17:33.637

这取决于您的应用程序在做什么。如果您想处理从视频采集卡录制的视频，您可能需要能够读取嵌入了 mpeg2 的 .mpg 文件。大量视频使用 .avi 或 .wmv 容器。微软正在推动 .wmv，但 .avi 在免费工具中得到了更好的支持。在 Windows 上支持 .mp4 容器的工具并不多（Mac 可能不同）。H.264、mpeg2 和 mpeg4 是我最喜欢的编解码器。H.264 在质量/比特率方面非常出色，但难以实现精确和快速的搜索，并且 CPU 密集度极高。mpeg4 在质量/比特率方面几乎与 h.264 一样好，但它的 CPU 密集度要低得多。mpeg2 需要更多位才能达到相同的质量，但几乎所有地方都支持它，并且在这些文件中解码和查找非常容易。

如果您不介意使用 LGPL 代码，我建议您查看[ffmpeg](http://ffmpeg.mplayerhq.hu/)的 libavcodec 和 libavformat。它会让你在所有平台上做你提到的所有事情（虽然我不确定 Ogg 和 Theora——我没有使用过它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T16:31:55.747

我想你的第一个选择是我的选择。我认为大多数应用程序都可以读取这种格式，而且灵活性较差。

如果我是正确的，AVI/DIVX 文件实际上可以包含不同类型的媒体，wmv 也是如此。这使得使用这些格式变得更加困难，因为您需要支持所有编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-24T16:27:15.873

首先，您的视频中也会有声音吗？如果是的话，我会选择mp3。

现在，考虑视频编解码器和视频容器。我认为出于各种原因，您不应该考虑选项 3 和 4。Theora 真的不受欢迎（我还没有看到过 Theora 视频），而且 WMV 是 Microsoft 技术，所以您的选择有点有限。

现在，关于前两个：我会在 Avi 容器中使用 DivX（Mpeg4 第 2 部分）视频。它非常受欢迎，因为大多数计算机和许多 DVD 都能够播放此类视频。此外，还有一个很棒的开源 DIVX 编解码器 XVID。最后，DIVX 在编码和解码方面需要的资源都比 H.264 少得多。最后一个很重要，因为根据编码参数，甚至可能不支持实时 H.264 编码。

许多平台缺乏对 AVI/DIVX 的支持不是问题，因为使用开源工具可以很容易地转码为任何格式。

# javascript - 不使用 IFrame 的 Comet 应用程序

> ID：305776
> 
> 赞同：3
> 
> 时间：2008-11-20T15:57:06.720
> 
> 标签：javascript, ajax, comet, server-push

我刚刚开始使用服务器端推送创建 AJAX 应用程序。我在 Glassfish V2 上使用灰熊彗星。几乎所有示例应用程序都使用 IFrame 在客户端更新内容。我想坚持**只使用 JavaScript**。有没有这样的示例应用程序（最好是不使用 JavaScript 库的应用程序）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T16:13:44.817

关于推送的要点是 HTTP 请求永远不会结束。并非所有客户端实现都能正确处理。正如我所看到的，可以使用 Firefox 中的纯 javascript 及其广泛的 API 来执行此操作，但是 XMLHTTPRequest 对象会超时并且无法向您传输内容。

IFrame 很好，如果它符合标准，您也可以尝试使用 object 标签。

在 XMLHTTPRequest 和 Ajax 没有名字之前，我们曾经通过 IFrames 从服务器获取数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-10T20:18:38.037

这就是我想出如何仅使用 javascript 和 php 进行推送的方法。

让 javascript 进行初始调用并将内容加载到 div 中。然后让 javascript 回调到 php 并让 php 休眠，直到它看到有新的更新。然后把数据发给大家，然后回调php，再次sleep。

这允许长时间轮询和更少的背靠背调用。我个人在 php 脚本上设置了 5 分钟到 30 分钟的时间。

# sql - Access 中的日期时间平均值

> ID：305780
> 
> 赞同：2
> 
> 时间：2008-11-20T15:57:53.023
> 
> 标签：sql, sql-server, tsql, ms-access

我正在将一些查询从 Access 移植到 T-SQL，编写查询的人在 datetime 列上使用了 Avg 聚合函数。这在 T-SQL 中不受支持，我可以理解为什么 - 它没有意义。什么是平均化？

因此，我正要开始逆向工程，当 Access 使用 Avg 聚合日期时间时，它会做什么，但我想我会先在这里提出这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T16:17:44.433

我想 Access 正在平均日期的数字表示。您可以在 T-SQL 中使用以下方法进行类似操作...

```
select AverageDate = cast(avg(cast(MyDateColumn as decimal(20, 10))) as datetime)
from    MyTable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T19:07:51.237

我对非 MS DBMS 更熟悉，但是……由于您不能添加两个 DATETIME 值，因此通常不能对它们进行平均。但是，您可以执行以下操作：

```
SELECT AVG(datetime_column - TIMESTAMP '2000-01-01 00:00:00.000000') +
              TIMESTAMP '2000-01-01 00:00:00.000000'
    FROM table_containing_datetime_column; 
```

这将计算 2000 年开始与实际日期时间值之间的平均间隔，然后将该间隔添加到 2000 年开始。“2000 年开始”的选择是任意的；只要将 AVG() 函数中减去的日期时间加回来，您就会得到一个合理的答案。

这确实假设使用的 DBMS 支持 SQL 标准“时间戳”表示法，并适当地支持 INTERVAL 类型。两个 DATETIME 或 TIMESTAMP 值之间的差异应该是一个 INTERVAL（实际上，INTERVAL DAY(9) TO SECOND(6) 是适度准确的，尽管 '9' 有点值得商榷）。

当对我使用的 DBMS 进行适当修改时，表达式“有效”：

```
CREATE TEMP TABLE table_containing_datetime_column
(
    datetime_column DATETIME YEAR TO FRACTION(5) NOT NULL
);

INSERT INTO table_containing_datetime_column VALUES('2008-11-19 12:12:12.00000');
INSERT INTO table_containing_datetime_column VALUES('2008-11-19 22:22:22.00000');

SELECT AVG(datetime_column - DATETIME(2000-01-01 00:00:00.00000) YEAR TO FRACTION(5)) +
    DATETIME(2000-01-01 00:00:00.00000) YEAR TO FRACTION(5)
FROM table_containing_datetime_column; 
```

回答：

```
2008-11-19 17:17:17.00000 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-11T10:05:46.363

@David W. Fenton：“Jet 日期字段是当天的整数值加上时间的十进制值” - 不，ACE/Jet`DATETIME`列是`FLOAT`（同义词`DOUBLE`, `FLOAT8`, `IEEEDOUBLE`, `NUMBER`）有限制，例如最大值`DATETIME`是#9999-12-31:23:59:59# 虽然`FLOAT`可以转换的最大值`DATETIME`会更大一些，例如

```
SELECT CDBL(CDATE('9999-12-31 23:59:59')) 
```

但是返回 2958465.99998843

```
SELECT CDATE(CDBL(2958465.9999999997)) 
```

不会出错，而

```
SELECT CDATE(CDBL(2958465.9999999998)) 
```

会出错。

因此，为了保留 SQL Server 中的功能，我建议将`DATETIME`列转换为`FLOAT`例如

```
SELECT CAST(AVG(CAST(MyDateTimeColumn AS FLOAT)) AS DATETIME)
  from MyTable 
```

# .net - 确定 .NET 程序集的依赖关系的最简单方法是什么

> ID：305781
> 
> 赞同：1
> 
> 时间：2008-11-20T15:57:57.907
> 
> 标签：.net, visual-studio, dependencies

考虑到具有数百个程序集的大型系统，当无法创建包含所有项目的单个 Visual Studio 解决方案时，确定大型系统中哪些其他项目依赖于特定程序集的最简单方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T16:06:36.750

我会说[NDepend 是确定 .Net Assembly 依赖项的最简单方法](http://www.ndepend.com/)，无论复杂性如何：

> NDepend 是一种简化复杂 .NET 代码库管理的工具。架构师和开发人员可以通过比较不同版本的代码来分析代码结构、指定设计规则、计划大规模重构、进行有效的代码审查和掌握进化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T16:06:24.300

您可以使用诸如[ndepend 之](http://www.ndepend.com/)类的工具。它将分析已编译的程序集并生成一个漂亮的图表，其中箭头指向和指向您的程序集。我在 VS2010 中看到过类似的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T16:00:04.283

配置操作系统以索引您的源代码并在内容中搜索指示引用的尖括号。问题是参考中的路径可能会有所不同，具体取决于参考项目相对于您要查找的项目所在的位置，因此某些正则表达式可能是有序的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-23T22:45:29.080

我将第三个 NDepend 建议，它非常适合这个问题。您无需更改任何有关您的 Visual Studio 解决方案或项目的内容即可使用它。

JB

# java - 如何在 Eclipse 之外构建 Eclipse 插件？

> ID：305787
> 
> 赞同：10
> 
> 时间：2008-11-20T15:58:53.253
> 
> 标签：java, eclipse, build-process

我有一系列 Eclipse 项目，其中包含许多已检入 CVS 的插件和功能。我现在需要运行这些插件的自动构建。理想情况下，我希望不必手动对大量 Eclipse 库位置进行硬编码，这是 Eclipse 提供的自动生成的 Ant 文件的问题。该构建还需要无头运行。

有没有人有过这种 Eclipse 设置的经验，以及如何实现它的建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T23:32:26.583

您可以查看几个选项，具体取决于您使用的构建脚本语言：

*   对于[Maven2](http://books.sonatype.com/maven-book/reference/multimodule.html)，前进的道路似乎是 Spring Dynamic Modules。其他选项是[Pax Construct](http://www.ops4j.org/projects/pax/maven/)、[m2eclipse](http://m2eclipse.codehaus.org/)、[Maven BND](http://felix.apache.org/site/maven-bundle-plugin-bnd.html)
*   对于 Ant/Gant，[Eclipse PDE](http://wiki.eclipse.org/index.php/PDEBuild)构建，[Ant4Eclipse](http://ant4eclipse.sourceforge.net/)
*   对于命令行或以上两者，[Buckminster](http://www.eclipse.org/buckminster/)。

在我目前的客户中，我们使用包装 PDE-Build 的 Buckminster，并从 Ant/CruiseControl 调用它。我们有来自多个存储库的代码，它们都被构建到单个 RCP 产品中。

此外，[这些](https://stackoverflow.com/questions/27818/how-can-i-manage-osgi-build-dependencies) [问题](https://stackoverflow.com/questions/121244/using-custombuildcallbacksxml-in-an-eclipse-rcp-headless-build)可能会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-21T15:05:04.253

制作 Eclipse Build 的标准方法是使用 PDE Build Plugin。

[http://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.pde.doc.user/guide/tasks/pde_feature_build.htm](http://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.pde.doc.user/guide/tasks/pde_feature_build.htm)

[http://wiki.eclipse.org/index.php/PDEBuild](http://wiki.eclipse.org/index.php/PDEBuild)

PDU 插件通常包含在 Eclipse IDE 中，并包含一系列模板。这些模板可帮助您设置一个系统，该系统将：

*   fetch：使用包含插件位置的地图文件检查所有插件和功能
*   generate：为每个签出的插件创建一个构建过程
*   过程：编译插件
*   assamble：罐子和打包插件
*   postBuild：允许设置自动测试和部署

从理论上讲，您需要做的就是修改 customTargets.xml 文件，编写一个映射文件，其中包含对您需要签出的每个插件的引用，并修改 build.properties 文件以指示诸如 cvs 服务器位置之类的属性。

我遇到了与您遇到的类似的问题。构建机制分为几个步骤。您可以自定义 customTargets.xml 文件的 preFetch 目标，以便从存储库中的特定树导入一些“批量”库并将它们添加到构建目录，因此您不必指定映射中的每个插件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T16:04:38.157

您可以编写某种脚本，为您找到这些库并将它们转换为 Ant 可以理解的格式。

例如，它可以构建一个 eclipse.lirbaries.properties 文件，然后您可以使用以下命令读取该文件：

```
<property file="eclipse.libraries.properties" /> 
```

您还可以使用 FileSet 属性：

[http://ant.apache.org/manual/Types/fileset.html](http://ant.apache.org/manual/Types/fileset.html)

甚至两者兼而有之。

1) 调用 Ant 脚本
2) Ant 脚本调用构建 eclipse.libraries.properties 的 bash（或任何脚本语言）脚本
3) Ant 加载 eclipse.libraries.properties
4) Ant 继续构建

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-25T18:40:06.797

您可以使用 Tycho 通过 Maven 构建您的 eclipse 插件。这就是 M2eclipse 插件的构建方式。[在http://m2eclipse.sonatype.org](http://m2eclipse.sonatype.org)了解更多信息

# version-control - 为什么要将版本控制插件与 IDE 捆绑在一起？

> ID：305790
> 
> 赞同：10
> 
> 时间：2008-11-20T15:59:38.760
> 
> 标签：version-control, ide

我一直想知道为什么在 IDE 中支持版本控制很重要。

我一直更喜欢使用版本控制的命令行/独立版本，但从未发现 IDE 集成有帮助。

我知道它有时会有所帮助，例如自动跟踪重命名，但我被版本控制插件咬了几次（尤其是[ClearCase](https://en.wikipedia.org/wiki/Rational_ClearCase) [Eclipse](https://en.wikipedia.org/wiki/Eclipse_%28software%29)插件），我现在发现它与命令相比适得其反 -线版，我有更好的控制。

你有什么意见？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-20T16:09:46.993

集成源代码控制还有助于仅将重要文件保留在源代码控制之下。例如，当我在 Visual Studio 中添加新文件时，插件 (visualSVN) 将允许我轻松添加它，而无需记住离开我的 IDE 并运行命令将其添加到存储库。另一方面，它会自动忽略临时文件，如 obj/ 和 bin/ 文件夹。

本质上：实际工作的集成版本控制是保持存储库清洁和完整的好方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-20T16:05:38.623

我喜欢**一些**IDE 的实现方式。[用于 Visual Studio 的Ankh-SVN](http://ankhsvn.open.collab.net/)不是那么好，而且有一点问题，但是当我使用 Eclipse 时，我发现[Subeclipse工作得非常好。](http://subclipse.tigris.org/)

我认为这实际上取决于您使用的 IDE 以及该插件的质量。它适用于某些设置，而对其他设置则很糟糕。

这就是为什么我非常喜欢带有 Tortoise SVN 的 Subversion。我可以选择在有意义的时间和地点使用 IDE 集成，否则，就像你说的，我可以简单地使用命令行，或者在我的情况下，使用基于 Windows 资源管理器的客户端！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T16:06:09.510

其中很多只是用户的偏好和舒适度。有些人对命令行很满意。有些人更喜欢 GUI。

我不会根据对存在问题的特定插件的经验做出一般性假设，即 IDE 中的所有版本控制都是坏的或有问题的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-20T16:23:47.587

IDE 与版本控制的集成，尤其是[软件变更管理](https://en.wikipedia.org/wiki/Version_control)(SCM)，有助于将 IDE 的理念与源代码控制系统结合在一起。

一个例子是临时文件和二进制文件，它们不应该被签入，例如在 Visual Studio 中，如果您没有仔细创建具有非默认目录配置的新项目和解决方案模板，它们最终会出现在源目录中。

另一个可能是跟踪工作项目和复杂的错误修复。

它还可以在编辑文件时节省一些仪式和上下文切换。

高级集成还可以允许将变更管理系统的“配置”（“分支”、“标记”、“视图”）概念推入 IDE。

然而，ClearCase 集成显然不是“先进的”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-20T17:44:43.727

为什么还要有 IDE？为什么不用命令行来做所有事情呢？;)

答案是，将其与 IDE 集成是“更好的”。

我的第一个原因：您可以直观地查看文件是否已签出，如果您需要编辑文件，您可以在您工作的地方执行操作。

还有更多，但这是最大的一个。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-20T16:07:53.470

这取决于您的 IDE 以及您使用 VCS 的方式。

我和我的团队在 Delphi IDE 中使用 VSS 插件，它在协同工作时提供了很多灵活的功能，例如，当您开始写信或移动组件时，我们所有的表单都会签入它询问您是否要检查-out 代码文件或表单。

此外，当有人更改其他形式的任何代码时，它会弹出并告诉您它已经被其他人更新并要求您更新 HD 中的当前文件

当您在 IDE 中时，您只需获取所有内容，您无需移动到其他外部文件或命令提示符来执行简单任务。

我发现大多数喜欢处理命令提示符的人主要在没有 GUI IDE 的代码中工作，或者我可能错了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-20T16:08:09.350

几乎我所有的颠覆需求都可以通过 IDE 接口来处理。执行 2 次快速单击比弹出命令行、cd 到正确的位置、发出命令等要快得多。

命令行有它的位置，但是对于当前的 IDE，这个位置继续缩小。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-20T16:20:08.203

我因使用 IDE/VCS 集成的错误实现而留下了战痕。老实说，如果它不是越野车，那就太好了。只要有像 TortoiseSVN 这样的好工具，我认为不需要 IDE/VCS 集成。我宁愿拥有更多能很好地完成工作的工具，而不是一些有缺陷的工具。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-20T16:35:50.917

IDE 中的版本控制支持通常为您提供更好的视图。IDE 在进行 diff 时实际上知道您正在查看的文件类型，这意味着它可以进行上下文突出显示并帮助您更有效地进行合并。

我还认为它可以节省设置时间。开发人员无需安装各种工具，而是可以下载 IDE，进行结帐，然后就可以使用了。如果项目中的每个开发人员都使用相同的 IDE，他们可以互相帮助。

“适得其反”是一个大词。如果您可能每月遇到一次严重的 CVS/SVN 问题，那么在您的所有开发机器上安装复杂的客户端仍然很少。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-20T18:21:28.303

我有两个系统，其中有一个集成的 IDE（Microsoft FrontPage 针对一个 IIS 开发网站，所有 Web 内容都具有 Visual Source Safe）和没有（java 命令行开发，Visual Studio Express Editions）。我使用的一个中间案例是通过插件与 VSS 集成的 jEdit 4.x。

我认为集成案例之所以有价值，是因为它始终如此——您不必离开应用程序来与源代码控制功能进行交互，也不必担心记住添加新文件和签出文件在编辑它们之前。就我而言，拥有顺畅的工作流程并最大程度地减少疏忽风险的能力是强大的。即使 IDE 插件集成不够完美（jEdit 4.x 案例），我仍然更喜欢它而不是没有它。

我也同意，在 Windows 上集成资源管理器（Tortoise SVN 的例子）也是一项很棒的功能，即使 IDE 集成可用。这允许在无需启动 IDE 的情况下进行方便的操作，同时还可以在 Windows 资源管理器中操作时从资源管理器窗口启动到 IDE（取决于文件类型）或编辑器或 make 或其他任何东西。

是的，命令行界面仍然很有价值，特别是对于递归操作模式的脚本。

我在许多情况下工作。在所有这些中具有低壁垒和操作流动性是值得珍视的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-20T18:27:52.220

我不确定我是否理解这个问题。根据定义，IDE 是集成的，这意味着它们应该可以帮助您避免因任何与项目相关的事情而脱离环境的需要。版本控制显然符合要求。

如果您正在寻找更实际的原因，一个是 IDE 可以通过其图形表示的性质为您提供意识。例如，Eclipse 将显示已更改的文件和目录。借助其他插件或套件，您可以在其他用户编辑同一文件时立即获得实时感知，帮助您在合并冲突发生之前预测它。我不熟悉基于命令行的机制。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-20T22:14:38.380

我定期使用与 cvs 集成的 intellij，到目前为止，在 IDE 中集成版本控制的最佳功能是逐行指示添加、编辑或删除的内容以及轻松访问（鼠标悬停/工具提示）到预编辑更改。

这一切都以不显眼的方式在源代码中。

对于版本控制的具体细节（签入/签出/更新/等），我有时使用 IDE，有时使用命令行。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-20T22:18:18.607

将 SCM 与 IDE 集成的第 1 个原因是它使用起来更加轻松，并且无需记住检查内容。根据我的经验，我发现开发人员认为无关紧要的步骤（通常包含编写代码以外的任何内容）并没有完成。让他们做额外的步骤会增加开发人员不会打扰它并且将围绕源代码控制系统工作的可能性

# c++ - 我可以进行异步 ODBC 调用吗？有什么参考资料吗？

> ID：305795
> 
> 赞同：5
> 
> 时间：2008-11-20T16:00:32.173
> 
> 标签：c++, sql, database, asynchronous, odbc

ODBC 是否支持异步调用？如果是这样，那么你能告诉我任何参考资料吗？

我的首选语言是 C++。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-21T01:39:38.760

这篇 MSDN 文章可能是您的起点：[执行语句 ODBC：异步执行](http://msdn.microsoft.com/en-us/library/ms713563.aspx)

来自文章：

> Windows 7 SDK 中的 ODBC 3.8 引入了对连接相关操作的异步执行……应用程序使用轮询方法确定异步操作已完成。从 Windows 8 SDK 开始，您可以使用通知方法确定异步操作是否完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T18:50:12.893

我想知道完全相同的事情。一个明显的解决方法是维护一个线程池，每个线程池都执行同步的 ODBC 调用并异步发出信号（和返回信号）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-21T02:01:22.150

通常，这些东西似乎是在应用程序的另一个抽象级别实现的，或者您自己滚动。几乎任何涉及可阻塞“打开”动作的东西都可以产生一个线程，用于管理打开并在发生时在全局某处发出信号或设置标志。

一些框架非常适合提供两种风格。想到了 Flex，它有助于它使用单个浏览器/javascript/swf 线程来发挥作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T06:25:45.257

异步 ODBC 函数是 ODBC 驱动程序提供的功能。

在 ODBC3.8 之前，只有与语句相关的调用可以启用异步。启动 ODBC3.8 连接相关的函数调用也可以启用异步。

当然，我们可以在应用程序端实现任何缺少的功能，但是在驱动程序中实现它可以减少应用程序端的痛苦。

我正在寻找一个完整的驱动程序列表，其中清楚地说明驱动程序是否支持开箱即用的异步调用。如果有人知道，请指给我这样的清单。

# c# - 为具有抽象复杂类型的模式生成类

> ID：305796
> 
> 赞同：4
> 
> 时间：2008-11-20T16:00:43.750
> 
> 标签：c#, .net, xml, xsd, schema

我正在使用一些定义抽象复杂类型的模式，例如。

```
<xs:complexType name="MyComplexType" abstract="true"> 
```

然后，此类型被架构中的另一个复杂类型引用：

```
<xs:complexType name="AnotherType">
  <xs:sequence>
    <xs:element name="Data" type="MyComplexType" maxOccurs="unbounded"/>
  </xs:sequence>
</xs:complexType> 
```

当我运行“xsd.exe /d /l:CS MySchema.xsd”时，我收到此错误：

> 错误：处理 MySchema.xsd 时出错。- 为 DataSet '' 生成代码时出错。- 无法将输入的 xml 文件内容转换为 DataSet。DataSet 不能为节点 Data 实例化一个抽象的 ComplexType。- DataSet 不能为节点 Data 实例化一个抽象的 ComplexType。

它似乎不是无效的架构。有没有其他人遇到过这个问题？

谢谢

缺口

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T14:55:18.413

在评估了几种不同的模式到代码工具之后，我们发现唯一能够处理我们的模式（非常大且极其复杂）的是 Liquid XML ( [http://www.liquid-technologies.com/](http://www.liquid-technologies.com/) )。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T16:06:43.643

我从来没有遇到过这个问题，但是我很快了解到xsd.exe有很多缺点。我们很久以前就开始使用[CodeXS 。](http://www.bware.biz/CodeXS/)该产品是一种 Web 服务，但代码可作为命令行工具使用。

它有自己的缺点，但它生成的代码要好得多，而且是免费的。此外，它是可扩展的，并且为它添加​​自己的插件实际上非常容易。

也许，它不会有同样的限制？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-09-21T14:50:04.520

我知道这是一个老问题，但本周我需要这个问题的答案。我按照@ng5000 的建议尝试了 Liquid Studios，发现该软件非常笨拙。此外，cs 输出非常复杂，它为具有 12 个简单属性的单个实体提供了超过 800 行代码。

我强烈推荐[Xml2CSharp](http://xmltocsharp.azurewebsites.net/)，这是一个使用 XML 属性装饰器生成漂亮、简单的 POCO 的 Web 工具。

# oracle - Oracle 从主表填充备份表

> ID：305797
> 
> 赞同：3
> 
> 时间：2008-11-20T16:01:00.457
> 
> 标签：oracle, copy

我当前分配到的程序要求在实际处理之前将表的内容复制到备份表。

在代码审查期间，一位同事指出

```
INSERT INTO BACKUP_TABLE
SELECT *
FROM PRIMARY_TABLE 
```

风险太大，因为表可能具有不同的列和不同的列顺序。

我也受到不创建/删除/重命名表的约束。~叹气~

表中的列预计会发生变化，因此简单地对列名进行硬编码并不是我正在寻找的解决方案。

我正在寻找一种合理的、无风险的方式来完成这项工作的想法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T16:08:55.667

备份表是否保留？它是永久保留数据，还是只是当前值的副本？

无法创建/删除/重命名/复制太糟糕了。否则，如果它是短期的，只是在出现问题时使用，那么您可以在处理开始时将其删除并执行类似的操作

```
create table backup_table as select * from primary_table; 
```

您最好的选择可能是使选择明确，如

```
insert into backup_table (<list of columns>) select <list of columns> from primary_table; 
```

您可以通过从数据字典构建一个 SQL 字符串来生成它，然后立即执行。但是，如果 backup_table 不包含 primary_table 中的所有重要列，您仍然会面临风险。

可能只想使其明确，如果 backup_table 不存在，或者 primary_table 中的任何列不在 backup_table 中，则会引发重大错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T16:11:27.177

您多久更改一次表格的结构？如果结构没有改变，您的方法应该可以正常工作。我个人认为您的 DBA 应该为您提供删除备份表并重新创建它的机制，例如存储过程。在我上一份工作中，我们在截断某些表时遇到了类似的情况，因为截断通常比`DELETE FROM TABLE;`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T16:07:16.047

您是否有理由不能只列出表格中的列？所以

```
INSERT INTO backup_table( col1, col2, col3, ... colN )
  SELECT col1, col2, col3, ..., colN
    FROM primary_table 
```

当然，这需要您在更改其中一个表的定义时重新访问代码以确定是否需要进行代码更改，但这通常是为了使自己免受列顺序差异、列差异的影响而付出的小代价名称，以及表定义中不相关的差异。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-16T13:47:47.727

如果我遇到这种情况，我会在问题开始时检索两个表的列定义。然后，如果它们相同，我将继续进行简单的操作：

```
INSERT INTO BACKUP_TABLE
SELECT *
FROM PRIMARY_TABLE 
```

如果它们不同，我只会在备份表中没有缺少关键列的情况下继续。在这种情况下，我将使用此表单作为备份副本：

```
INSERT INTO BACKUP_TABLE (<list of columns>) 
SELECT <list of columns> 
FROM PRIMARY_TABLE 
```

但是我也担心如果我只是因为错误而停止程序会发生什么，所以我什至可能有一个备份计划，我会为两个表中的列使用第二种形式，并转储一个文本文件与 PK 和备份中缺少的任何列。即使程序似乎正常完成，也要记录一个错误。这样，如果发生最坏的情况，您可以恢复数据。

确实，这是应该解决的不良流程的症状，但是防御性编程可以帮助使其成为其他人的问题，而不是您的问题。如果他们没有注意到日志错误消息告诉他们有关缺少列的文本转储，那么这不是您的错。

但是，如果您不进行防御性编码，并且最坏的情况发生了，那部分原因将是您的错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T16:04:37.533

您可以尝试以下方法：

```
CREATE TABLE secondary_table AS SELECT * FROM primary_table; 
```

不确定这是否会自动复制数据。如果不：

```
CREATE TABLE secondary_table AS SELECT * FROM primary_table LIMIT 1;
INSERT INTO secondary_table SELECT * FROM primary_table; 
```

编辑：

抱歉，没有完全阅读您的帖子：尤其是约束部分。恐怕我不知道怎么做。我的猜测是在创建冗长的插入/选择查询之前使用一个首先描述两个表并比较它们的过程。

不过，如果您使用的是备份表，我认为它与原始表完全匹配非常重要。

# ruby-on-rails - 使用 Github 和多台计算机的最佳方式是什么？

> ID：305805
> 
> 赞同：12
> 
> 时间：2008-11-20T16:02:37.897
> 
> 标签：ruby-on-rails, git, github

我正在开发一些学校评分软件，并决定使用 Github 来托管该项目。在我的 Ubuntu 机器上构建一些代码后，我将其推送到 Github，然后将其克隆到我的 MacBook Pro。在 MBP 上编辑完代码后，我将其推送回 Github。第二天早上，我尝试用 a 更新我在 Ubuntu 机器上的存储库`git pull`，但它给了我各种麻烦。

在这种情况下最好的工作方式是什么？我不想分叉我自己的仓库，也不想给自己发邮件或拉取请求。为什么我不能像对待大师一样对待 Github 并从它推/拉到我在不同计算机上的所有个人存储库中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-21T03:27:49.387

`git pull`我假设您的问题是当您尝试发出命令时，您首次创建 repo 的机器出现故障。

当您克隆现有的 git 存储库时（就像您在第二台机器 MacBook Pro 上所做的那样），您会自动设置为，因此您的`git pull`命令将自动将远程与本地更改合并。

但是，当您最初创建一个 repo 然后在远程存储库上共享它时，您必须发出一些命令来使事情像克隆 repo 一样自动化。

```
# GitHub gives you that instruction, you've already done that
# git remote add origin git@github.com:user_name/repo_name.git

# GitHub doesn't specify the following instructions
git config branch.master.remote origin
git config branch.master.merge refs/heads/master 
```

最后几条指令配置了 git，所以`git pull`这个 repo 中的 future 将自动合并所有远程更改。

以下是有点无耻的自吹自擂。如果您使用 Ruby，我已经创建了一个基于 Ruby 的工具，可以让您使用 git 远程分支处理所有这些类型的事情。毫不奇怪，该工具被称为[git_remote_branch](http://grb.rubyforge.org/) :-)

如果你不使用 Ruby，我的工具安装起来可能会很麻烦。您可以做的是查看[我博客上的一篇旧帖子](http://programblings.com/2008/06/23/git-remote-branches/)，其中明确显示了 grb 可以为您做的大部分内容。拿出你的 git 笔记文件 :-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-21T13:57:26.230

您还可以[添加多个 SSH 公钥](https://github.com/account)。

# .net - 将 OpenFileDialog 设置为默认为缩略图视图

> ID：305809
> 
> 赞同：5
> 
> 时间：2008-11-20T16:04:12.603
> 
> 标签：.net

我正在使用 OpenFileDialog 类，因此用户可以选择图像文件。我想将对话框默认为缩略图视图模式。不幸的是，该类没有任何方法来设置默认视图模式。

除了创建自己的自定义对话框（我可能必须这样做）之外，有没有办法实现我的目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T16:08:52.127

这篇代码项目文章是我前一段时间用来扩展 OFD 和 SFD 的，它还链接到其他一些有更详细解释的文章

[扩展打开和保存文件对话框](http://www.codeproject.com/KB/dialog/CustomizeFileDialog.aspx)
[更深入的文章](http://www.codeproject.com/KB/dialog/OpenFileDialogEx.aspx)

# c++ - C ++在特定行号的文件中插入一行

> ID：305817
> 
> 赞同：1
> 
> 时间：2008-11-20T16:05:34.693
> 
> 标签：c++, algorithm, file-io

我希望能够从未排序的源文本文件（每行一条记录）中读取，并通过指定应插入的行号将行/记录插入目标文本文件。

将通过将传入文件中的传入行与目标文件中已排序的列表进行比较来确定将行/记录插入目标文件的位置。（目标文件将作为一个空文件开始，当程序遍历传入的文件行时，数据将被排序并一次插入一行。）

传入文件示例：

```
1 10/01/2008 line1data
2 11/01/2008 line2data
3 10/15/2008 line3data 
```

所需的目标文件示例：

```
2 11/01/2008 line2data
3 10/15/2008 line3data
1 10/01/2008 line1data 
```

我可以通过链表或类似方法在内存中执行排序来做到这一点，但我想让它扩展到非常大的文件。（而且我很高兴尝试解决这个问题，因为我是 C++ 新手 :)。）

执行此操作的方法之一可能是打开 2 个文件流`fstream`（1 输入和 1 输出，或仅 1 输入/输出流），但后来我遇到了很难找到和搜索文件位置的困难，因为它似乎取决于文件开头的绝对位置而不是行号:)。

我确信以前已经解决过这样的问题，我希望能得到有关如何以良好实践方式进行的建议。

我正在使用 Visual Studio 2008 Pro C++，而我只是在学习 C++。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T16:24:31.300

如果该文件只是一个纯文本文件，那么恐怕找到特定编号的行的唯一方法是走文件计数行。

通常的“非内存”方法是将文件从原始文件复制到临时文件，在正确的位置插入数据，然后重命名/替换原始文件。

显然，一旦你完成了插入，你就可以将文件的其余部分复制一大块，因为你不再关心计算行数了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T16:47:23.657

[distinctly-no-c++] 解决方案是使用 *nix`sort`工具，对第二列数据进行排序。它可能看起来像这样：

```
cat <file> | sort -k 2,2 > <file2> ; mv <file2> <file> 
```

它并不完全就地，并且它未能满足使用 C++ 的要求，但它确实有效:)

甚至可以做到：

```
cat <file> | sort -k 2,2 > <file> 
```

不过，我还没有尝试过这条路线。
* [http://www.ss64.com/bash/sort.html](http://www.ss64.com/bash/sort.html) - 排序手册页

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T18:58:12.720

一种方法不是保持文件排序，而是使用单独的索引，使用 berkley db ( [BerkleyDB](http://www.oracle.com/database/berkeley-db/index.html) )。数据库中的每条记录都有排序键和主文件的偏移量。这样做的好处是您可以有多种排序方式，而无需复制文本文件。您还可以通过在末尾附加更改的行并更新索引以忽略旧行并指向新行来更改行而不重写文件。我们成功地将其用于需要对其进行许多小改动的多 GB 文本文件。

编辑：我为此开发的代码是一个更大的包的一部分，可以在[这里](http://transims-opensource.org/dmdocuments/transims3_2_2.zip)下载。具体代码在 source/IO 下的 btree* 文件中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T21:08:29.587

基本问题是在普通操作系统下，文件只是字节流。在文件系统级别没有行的概念。这些语义必须作为附加层添加到操作系统提供的设施之上。虽然我从未使用过它，但我相信 VMS 有一个面向记录的文件系统，它可以让你想做的事情变得更容易。但是在 Linux 或 Windows 下，你不能在不重写文件的其余部分的情况下插入文件的中间。它类似于内存：在最高级别，它只是一个字节序列，如果您想要更复杂的东西，例如链表，则必须将其添加到顶部。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T16:41:22.827

我认为这个问题更多的是关于实现而不是特定的算法，特别是处理非常大的数据集。

假设源文件有 2^32 行数据。什么是对数据进行排序的有效方法。

这是我的做法：

1.  解析源文件并提取以下信息：排序键、文件中行的偏移量、行的长度。此信息被写入另一个文件。这会生成一个易于索引的固定大小元素的数据集，称为索引文件。

2.  使用修改后的归并排序。递归地划分索引文件，直到要排序的元素数量达到某个最小值 - 真正的合并排序递归到 1 或 0 个元素，我建议停止在 1024 或其他地方，这需要微调。将索引文件中的数据块加载到内存中并对其执行快速排序，然后将数据写回磁盘。

3.  对索引文件执行合并。这很棘手，但可以这样做：从每个源加载一个数据块（例如 1024 个条目）。合并到一个临时输出文件并写入。当一个块被清空时，重新填充它。当找不到更多源数据时，从头开始读取临时文件并覆盖正在合并的两个部分 - 它们应该是相邻的。显然，最终的合并不需要复制数据（甚至创建一个临时文件）。考虑到这一步，可能可以为合并的索引文件设置一个命名约定，这样数据就不需要覆盖未合并的数据（如果你明白我的意思的话）。

4.  读取排序后的索引文件并从源文件中提取该行数据并写入结果文件。

读取和写入所有文件肯定不会很快，但应该非常有效 - 真正的杀手是在最后一步中随机查找源文件。到目前为止，磁盘访问通常是线性的，因此应该相当有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-20T19:23:23.247

尝试修改后的[Bucket Sort](http://en.wikipedia.org/wiki/Bucket_sort)。假设 id 值很适合它，您将获得更有效的排序算法。您可以通过在扫描时实际写出存储桶（使用小存储桶）来提高 I/O 效率，从而可能减少您需要的随机文件/io 的数量。或不。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-20T20:15:55.123

> 希望有一些很好的代码示例说明如何将基于行号的记录插入到目标文件中。

您不能将内容插入文件的中间（即，不覆盖之前的内容）；我不知道支持它的生产级文件系统。

# asp.net - Cassini（又名 VS 开发服务器）的堆栈限制是多少？

> ID：305830
> 
> 赞同：2
> 
> 时间：2008-11-20T16:07:10.303
> 
> 标签：asp.net, iis-6, stack-overflow, cassini

我在限制为 256k 的 IIS6/2k3 中遇到了 StackOverflowException（请不要问，这不是我的错），但在 VS 调试器*中不会发生异常。*

作为一个理解问题，我很想知道，但未能通过谷歌搜索 Cassini 的堆栈限制是什么......如果它确实有一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T15:38:28.473

你有没有尝试过堆栈溢出卡西尼，看看它在什么时候崩溃？我想堆栈是巨大的，尽管我希望 Cassini 尽可能地复制 IIS。令人惊讶的是，在 VS 中运行的东西不会在 IIS 中运行，我什至会考虑[向 Microsoft 提交 VS 错误](http://blogs.msdn.com/astebner/articles/451329.aspx)，因为似乎 Cassini 的全部意义在于复制 IIS 的功能并提供理想的调试环境，因为您在 VS 中编写的任何 Web 项目本质上都将针对 IIS 进行部署。

我不确定[这个论坛帖子](http://forums.iis.net/t/1153323.aspx)是否是您发布的，或者您是否看过，但他似乎有完全相同的问题，以防您仍然遇到它。

# c# - C# Assembly.Load 与 Assembly.ReflectionOnlyLoad

> ID：305835
> 
> 赞同：49
> 
> 时间：2008-11-20T16:08:39.710
> 
> 标签：c#, reflection, assembly.load, assembly.reflectiononly

我试图了解 Assembly.Load 和 Assembly.ReflectionOnlyLoad 之间的区别。

在下面的代码中，我试图查找给定程序集中从给定接口继承的所有对象：

```
var myTypes = new List<Type>();

var assembly = Assembly.Load("MyProject.Components");

foreach (var type in assembly.GetTypes())
{
   if (type.GetInterfaces().Contains(typeof(ISuperInterface)))
   {
      myTypes.Add(type);
   }
} 
```

这段代码对我来说很好，但我正在研究其他可能更好的替代方案，并遇到了 Assembly.ReflectionOnlyLoad() 方法。

我假设由于我没有加载或执行任何对象，基本上只是查询它们的定义，我可以使用 ReflectionOnlyLoad 来稍微提高性能......

但事实证明，当我将 Assembly.Load 更改为 Assembly.ReflectionOnlyLoad 时，它调用 assembly.GetTypes() 时出现以下错误：

> ```
> System.Reflection.ReflectionTypeLoadException: 
> ```
> 
> 无法加载一种或多种请求的类型。检索 LoaderExceptions 属性以获取更多信息。

我假设上面的代码只是在做反射和“查看”库......但这是否是海森堡不确定性原则的某种实例，即查看库和其中的对象实际上是试图在某些情况下实例化它们方式？

谢谢，马克斯

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-20T17:14:51.917

根据乔恩的回复，了解`LoaderExceptions`. 代替这些信息，我想我可以冒险猜测一下。来自[MSDN](http://msdn.microsoft.com/en-us/library/ms172331(VS.80).aspx)：

> 如果程序集具有依赖项，则 ReflectionOnlyLoad 方法不会加载它们。如果您需要检查它们，您必须自己加载它们。

您需要附加一个处理程序`AppDomain.ReflectionOnlyAssemblyResolve`来帮助 CLR 加载您正在加载的程序集的任何依赖项。你做过吗？

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-20T20:02:54.540

ReflectionOnly 方法是您可以在磁盘上加载特定程序集以进行检查的唯一方法，而无需通过通常的 Load/LoadFrom 规则。例如，您可以加载与 GAC 中具有相同标识的基于磁盘的程序集。如果您尝试使用 LoadFrom 或 LoadFile，则始终会加载 GAC 程序集。

此外，您可能不会在返回的程序集实例上调用 GetCustomAttributes(...)，因为这将尝试实例化程序集上的属性，这些属性是 ReflectionOnly。为此，您必须使用 CustomAttributeData 类的静态方法。

不能实例化通过 ReflectionOnly 加载的程序集中的任何类型。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-20T18:12:16.573

我相信您对 Load 和 ReflectionOnlyLoad 之间差异的一般理解是正确的。这里的问题（我认为）是，即使只是加载一个类型，CLR 也需要从定义类型本身的程序集中读取元数据，*并从定义类型的祖先的每个程序集中加载元数据*。因此，您需要在所有定义类型的程序集上调用 Assembly.ReflectionOnlyLoad，这些类型是您正在加载的类型的祖先。

举个例子，假设您在程序集 A.dll 中定义了以下类。

```
public class MyBase
{
   public void Foo() { }
} 
```

以及在程序集 B.dll 中定义的以下类。

```
public class MySubclass : MyBase
{
} 
```

当您在程序集 B.dll 上调用 Assembly.GetTypes 时，CLR 将尝试加载类型 MySubclass 及其所有成员。因为方法 Foo 是在程序集 A.dll 的 MyBase 中定义的（并且不存在于 B.dll 的元数据中），如果程序集 A.dll 尚未加载，CLR 将抛出类型加载异常。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-19T13:44:27.767

没有方法可以从程序集中执行，加载`ReflectionOnlyLoad()`，你会得到`InvalidOperationException`. 所以这是使用反射确定程序集内容的安全方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-13T10:24:17.293

两者之间的另一个很大区别是`Assembly.Load`将程序集添加到`AppDomain`where 中，`Assembly.ReflectionOnlyLoad`而不会将程序集添加到`AppDomain`

代码来详细展示。

```
public void AssemblyLoadTest(string assemblyToLoad)
{
    var initialAppDomainAssemblyCount = AppDomain.CurrentDomain.GetAssemblies().Count(); //4

    Assembly.ReflectionOnlyLoad(assemblyToLoad);
    var reflectionOnlyAppDomainAssemblyCount = AppDomain.CurrentDomain.GetAssemblies().Count(); //4

    //Shows that assembly is NOT loaded in to AppDomain with Assembly.ReflectionOnlyLoad
    Assert.AreEqual(initialAppDomainAssemblyCount, reflectionOnlyAppDomainAssemblyCount); // 4 == 4

    Assembly.Load(assemblyToLoad);
    var loadAppDomainAssemblyCount = AppDomain.CurrentDomain.GetAssemblies().Count(); //5

    //Shows that assembly is loaded in to AppDomain with Assembly.Load
    Assert.AreNotEqual(initialAppDomainAssemblyCount, loadAppDomainAssemblyCount); // 4 != 5
} 
```

# c# - IIS SMTP：超出存储分配响应

> ID：305837
> 
> 赞同：8
> 
> 时间：2008-11-20T16:08:47.523
> 
> 标签：c#, iis, iis-6, smtp

大家好。我们使用 IIS6 SMTP 服务发送了相当多的电子邮件（大约 23k），每次都会收到大约 7-8 条错误消息。堆栈跟踪是：

```
System.Net.Mail.SmtpException: Exceeded storage allocation. The server response was: 4.3.1 Session size exceeds fixed maximum session size
   at System.Net.Mail.DataStopCommand.CheckResponse(SmtpStatusCode statusCode, String serverResponse)
   at System.Net.Mail.DataStopCommand.Send(SmtpConnection conn)
   at System.Net.Mail.SmtpConnection.OnClose(Object sender, EventArgs args)
   at System.Net.ClosableStream.Close()
   at System.Net.Mail.MailWriter.Close()
   at System.Net.Mail.SmtpClient.Send(MailMessage message) 
```

我们的 SMTP 配置是：

```
Limit message size: 2048k
Limit session size: 20240k
Limit # of messages per connection: 20
Limit # of recipients per message: 100 
```

是否像调整会话大小一样简单？如果是这样，有什么推荐的？我们是否应该取消选中限制会话大小？

我并不声称自己是 SMTP 设置方面的专家，但如果我能消除这些错误消息，那似乎是向前迈出了一步。

谢谢

吉姆

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T22:50:07.833

吉姆，这似乎是存储所有要发送的临时队列文件的磁盘空间不足。这就是为什么您只看到几次错误的原因。当它发送消息时，我确信它会清理临时文件，为更多内容腾出空间。请记住，您发送电子邮件的速度比 SMTP 服务器向世界发送电子邮件的速度快很多很多倍，因此，您可以创建一个地狱般的队列。

失败的交付也无济于事......

我会查看一个配置选项，该选项设置允许用于临时文件的驱动器空间的限制。

会话限制可能仅适用于与您的 SMTP 服务器的所述连接，并且只允许在 SMTP 服务器说“哇，伙计..”之前将这么多数据注入您的 SMTP 服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-21T13:33:15.110

我在 Windows Server 机器上收到了完全相同的错误消息，将“限制消息大小”更改为更大的大小解决了该错误。

在 Windows Server 2012 机器上，您可以使用搜索魅力找到 IIS SMTP 服务器设置并搜索 IIS。在点击消息上，您可以更改消息大小。

# vb.net - 确定哪个进程锁定了文件

> ID：305843
> 
> 赞同：5
> 
> 时间：2008-11-20T16:09:22.470
> 
> 标签：vb.net, file-io, teamcity

我有一个在本地运行良好的单元测试，但是当上传到 TeamCity 构建服务器时失败并显示“该进程无法访问该文件，因为它正被另一个进程使用。”

1.  在我在测试中做任何事情之前，我会检查设置是否存在文件，如果存在，请尝试删除它。这失败并显示与上述相同的错误消息
2.  在编写文件时，我关闭了编写器，然后将其处理掉，我认为这应该摆脱任何资源。

所以我有几个疑问

1.  有没有人遇到过类似的问题并设法绕过它们
2.  如何通过程序找出是什么进程自私地锁定了文件！！！

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T16:11:15.290

Sysinternals [handle.exe](http://live.sysinternals.com/handle.exe)是第一步。或使用[Process Explorer](http://live.sysinternals.com/procexp.exe)的`Find Handle or DLL`. **不过，杀死进程**总是比关闭句柄更安全。

以编程方式，这是编写读取 Windows 句柄表的内核驱动程序的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T16:13:50.977

[ProcessMon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)（用于查找）和[Unlocker](http://www.emptyloop.com/unlocker/)（至少用于解锁）也很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T16:19:36.893

Sysinternals [FileMon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)提供了一些关于他们如何在旧 Windows 版本中完成此操作的信息（向下滚动）。

[进程监视器](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)是他们的最新版本，但它并没有提供很多关于他们如何做到这一点的线索。但是，那里链接了一些知识库文章，它们应该会引导您访问此信息。

-亚当

# mysql - 使用 CTL 从 oracle 导入到 mysql

> ID：305846
> 
> 赞同：0
> 
> 时间：2008-11-20T16:10:47.270
> 
> 标签：mysql, database, oracle, import, ctl

如何使用 CTL 文件（使用 Toad for oracle 生成）将数据从 oracle 数据库导入 mysql 数据库？提前感谢安德里亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-20T16:20:22.587

CTL 文件似乎暗示您正在尝试使用 SQL *Loader 加载数据。但是， SQL* Loader 是一个特定于 Oracle 的工具。它只支持将数据加载到 Oracle，它没有将数据加载到 MySQL 的功能。所以我怀疑 Toad 生成的控制文件是否有用。

但是，如果您有一个控制文件，这意味着您有一个要加载的平面数据文件（即数据库中每个表的逗号分隔或制表符分隔的平面数据文件）。是这样吗？如果是这样，几乎每个数据库都有用于导入平面文件的实用程序。我不是 MySQL 专家，但我认为 MySQL 有这样的实用程序。当然，您也可以相对轻松地编写一个小型应用程序来使用您熟悉的任何语言进行加载。

# c++ - 当您不想 #include 时替代转发声明

> ID：305849
> 
> 赞同：10
> 
> 时间：2008-11-20T16:11:39.983
> 
> 标签：c++, physical-design, forward-declaration

我通常几乎不加思索地使用前向声明，这样我就不必包含标题。这个例子中的一些东西：

```
//-----------------------
// foo.h
//-----------------------
class foo
{
   foo();
   ~foo();
};

//-----------------------
// bar.h
//-----------------------

class foo; // forward declaration

class bar
{
   bar();
   ~bar();

   foo* foo_pointer;
}; 
```

一些开发人员喜欢使用这种方法来避免包含圈的问题。我宁愿用它来最小化广泛包含层次结构中的开销，这是物理设计的重要部分（特别是对于较大的项目）。

但是，在某些情况下，我真的很喜欢将成员声明为普通对象而不是指针，以从自动构造/销毁机制中受益。这导致不能再使用前向声明的问题，因为在这种情况下编译器需要类定义，例如：

```
//-----------------------
// foo.h
//-----------------------
class foo
{
   foo();
   ~foo();
};

//-----------------------
// bar.h
//-----------------------

class foo;       // Not enough given the way we declare "foo_object"..
#include "foo.h" // ..instead this is required

class bar
{
   bar();
   ~bar();

   foo foo_object;
}; 
```

所以，如果有人知道可以在这里使用的替代语言结构，我会很高兴，这样我就可以声明“foo_object”，如示例中所示，但不包括其标题。

问候

/罗伯特

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-20T16:17:30.860

你不能。编译器在声明类时需要知道对象的大小。

引用是一种替代方法，尽管它们必须在构造时实例化，所以它并不总是可行的。

另一种选择是智能指针，但我想这在技术上仍然是一个指针。

很高兴知道为什么您不想使用指针来建议其他一些构造...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-20T16:38:46.153

只需使用智能指针 - 在这种情况下您甚至可以使用 auto_ptr。

```
//-----------------------
// bar.h
//-----------------------

#include <memory>
class foo;       // Not enough given the way we declare "foo_object"..

class bar
{
public:
   bar();
   ~bar();

   foo &foo_object() { return *foo_ptr; }
   const foo &foo_object() const { return *foo_ptr; }

private:
   auto_ptr<foo> foo_ptr;
}; 
```

您可以获得自动内存管理的所有好处，而无需了解 bar.h 中的 foo。有关 Herb Sutter 的建议，请参阅[包装指针数据成员](http://www.gotw.ca/publications/using_auto_ptr_effectively.htm)。

如果您真的希望默认构造自动发生，请尝试以下操作：

```
#include <iostream>
using namespace std;

class Foo;

template <typename T>
class DefaultConstuctorPtr
{
    T *ptr;
    void operator =(const DefaultConstuctorPtr &);
    DefaultConstuctorPtr(const DefaultConstuctorPtr &);

public:
    DefaultConstuctorPtr() : ptr(new T()) {}
    ~DefaultConstuctorPtr() { delete ptr; }

    T *operator *() { return ptr; }
    const T *operator *() const { return ptr; }
};

class Bar
{
    DefaultConstuctorPtr<Foo> foo_ptr;
public:
    Bar() {} // The compiler should really need Foo() to be defined here?
};

class Foo
{
public:
    Foo () { cout << "Constructing foo"; }
};

int main()
{
    Bar bar;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-20T16:21:04.910

你想要的东西不能在 C++ 中完成。为了为一个对象生成代码，你的编译器需要知道它的类需要多少存储空间。为了知道这一点，它必须知道类的每个成员需要多少存储空间。

如果你想用 foo 类型的成员创建一个 bar 类型的类，编译器必须知道 foo 有多大。它知道的唯一方法是它是否具有可用的 foo 定义（通过#include）。否则，您唯一的选择是使用 foo 的前向声明和指针或引用，而不是实际的 foo 对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-20T16:53:29.773

正如其他人所说，由于他们所说的原因，您不能这样做:) 然后您说您不想关心包含它们的类中的成员构造/破坏。您可以为此使用模板。

```
template<typename Type>
struct member {
    boost::shared_ptr<Type> ptr;
    member(): ptr(new Type) { }
};

struct foo;
struct bar {
    bar();
    ~bar();

    // automatic management for m
    member<foo> m;
}; 
```

我认为代码是不言自明的。如果出现任何问题，请打扰我。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T16:34:14.790

没有办法解决这个问题。

最好的办法是限制包含的数量，但您必须在类声明中包含文件。您可以将类声明拆分为一个单独的标头，希望它不包含其他任何内容。那么是的，你必须有一个#include，但你仍然保持你的包含层次结构有点浅。毕竟，包括一个文件很便宜，只有当层次结构扩展到数百或数千个文件时，它才会开始受到伤害......;）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-20T16:36:32.010

几乎你唯一能做的就是通过[使用 pImpl 习惯用法](https://stackoverflow.com/questions/188449/what-are-some-techniques-for-limiting-compilation-dependencies-in-c-projects)来最小化影响，这样当你包含 foo.h 时，你只包含 foo 的接口。

你无法避免包含 foo.h，但你可以让它尽可能便宜。您养成的使用 foward 声明而不是#inlcudes 的习惯使您在这条道路上做得很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-20T16:16:47.243

如果您能够使用引用，则可以保留相同的使用语法。但是，您的引用必须立即在构造函数中初始化，因此您的 ctor 绝对必须离线定义。（您还需要在析构函数中释放对象。）

```
// bar.h
class foo;

class bar {
    foo& foo_;

public:
    bar();
    ~bar();
};

// bar.cc
bar::bar() : foo_(*new foo)
{
    // ...
}

bar::~bar()
{
    // ...
    delete &foo_;
} 
```

你的旅费可能会改变。:-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-20T16:49:59.907

您可以使用自动创建和销毁实例的自定义“智能指针”类。这将实现您所追求的自动构建和破坏。

为了避免需要另一个#include，您可以`myAuto`在项目的前缀标头中包含此类，或者您可以将其复制并粘贴到每个标头中（这不是一个好主意，但它会起作用）。

```
template<class T>
class myAuto
{
    private:
        T * obj;

    public:
        myAuto() : obj(new T) {  }
        ~myAuto() { delete obj; }
        T& object() { return *obj; }
        T* operator ->() { return obj; }
};
```

以下是您将如何使用它：

```
// foo.h:
class foo
{
    public:
        foo();
        ~foo();
        void some_foo_func();
};
```

```
//bar.h:
class foo;
class bar
{
    public:
       bar();
       ~bar();
       myAuto<foo> foo_object;
}; 
```

```
//main.cc:
#include "foo.h"
#include "bar.h"

int main()
{
    bar a_bar;

    a_bar.foo_object->some_foo_func();

    return 0;
}
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-20T18:13:36.180

您也可以使用 pImpl 成语，例如：

```
//-----------------------
// foo.h
//-----------------------
class foo
{
    foo();
    ~foo();
};

//-----------------------
// bar.h
//-----------------------

class foo;

class bar
{
private:
    struct impl;
    boost::shared_ptr<impl> impl_;
public:
    bar();

    const foo& get_foo() const;
};

//-----------------------
// bar.cpp
//-----------------------
#include "bar.h"
#include "foo.h"

struct bar::impl
{
    foo foo_object;
    ...
}

bar::bar() :
impl_(new impl)
{
}

const foo& bar::get_foo() const
{
    return impl_->foo_object;
} 
```

您仍然可以获得前向声明的好处，而且您隐藏了您的私有实现。对 bar 实现的更改不一定需要编译 #include bar.h 的所有源文件。实现结构本身在 .cpp 文件中是自包含的，在这里您可以根据自己的喜好声明对象。

由于 pImpl 本身，您对性能的影响很小，但取决于应用程序，这可能不是什么大问题。

我在大型项目中使用了 pImpl 习语，它对编译时间有很大影响。可惜该语言无法处理真正私有的实现，但是您已经拥有了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-21T10:33:44.893

实际上只有三种选择可以关联两个对象。您已经发现了两个：将 Foo 嵌入 Bar 中，或者将 Foo 放在堆上并在 Bar 中放入 Foo*。第一个需要在定义类 Bar 之前定义类 Foo；第二个只需要你转发声明类Foo。

确实存在第三个选项，我只提到它是因为您在问题中明确排除了先前的两个选项。您可以（在您的 .cpp 中）创建静态 std::map。在每个 Bar 构造函数中，您将 Foo 添加到此地图，键入`this`. `this`然后，每个酒吧成员都可以通过在地图中查找来找到相关的 Foo 。Bar::~Bar 将调用`erase(this)`销毁 Foo。

虽然这使 sizeof(Bar) 保持不变，但实际内存使用量高于在 Bar 中包含 Foo*。但是，如果二进制兼容性是一个紧迫的问题，您仍然可以这样做。

# networking - “网络上存在重复名称”错误对虚拟机有什么影响？

> ID：305856
> 
> 赞同：1
> 
> 时间：2008-11-20T16:14:31.523
> 
> 标签：networking, environment, virtual-pc

我有一个项目，其中多个开发人员正在使用相同的 Windows Virtual PC 映像 (W2K3 SE SP2) 的副本。因为我们的解决方案与机器名称相关联（我知道不太理想）所有开发人员都具有相同的机器名称。

我们使用 VPN 连接到远程系统，连接后出现“Windows 错误：网络上存在重复名称”错误。

由于所有开发都在本地进行，我们不依赖于连接到我们的其他机器——只依赖于出站连接。

我知道更改机器名称是最佳做法，但这背后的原因是什么？这会有什么影响？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-20T16:20:47.377

在这种情况下，机器名称主要用于 SMB/CIFS 文件共享目的。重复名称的问题是，如果您尝试共享文件，则无法识别哪个主机是哪个主机。

可能还有一些其他相关的影响，但我认为如果你只是在本地工作，你应该没有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T16:20:57.110

如果您在 VM 上本地完成所有工作，则机器名称没有理由需要保持不变。

我在工作的地方也遇到过类似的情况。我们使用的是 Microsoft 的 SharePoint 2007 VM 试用版。同样的错误，开发没有问题。我唯一遇到的情况是，当我打开 Internet Explorer 通过键入[http://servername/page.aspx](http://servername/page.aspx)查看服务器上的页面时，我会访问另一个开发人员的 VM。我不得不使用[http://ipaddress/page.aspx](http://ipaddress/page.aspx)来访问我自己的机器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T16:23:02.223

好吧，除了搞砸 AD、DNS、Netbios 或 Netbeui ......什么都没有。

重复的机器名称不是最佳做法。它可能会干扰文件共享、ping、组策略等。

您必须首先问自己为什么他们要这样做。

# iphone - 您将如何构建像数独板这样的网格并与之交互？

> ID：305860
> 
> 赞同：7
> 
> 时间：2008-11-20T16:16:26.870
> 
> 标签：iphone, objective-c, cocoa-touch

您认为为原生 iPhone 应用程序实现类似于数独板的交互式网格的最佳方式是什么？我没有在 SDK 中看到满足这一需求的对象。

我是否应该为单个单元格制作自定义控件，然后以网格形式初始化尽可能多的单元格？

[![数独网格](https://i.stack.imgur.com/o9CSk.jpg)](https://i.stack.imgur.com/o9CSk.jpg)
[（来源：[4thewww.com](http://www.sudoku.4thewww.com/Grids/grid.jpg)）]

欢迎任何和所有的评论。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T17:33:14.517

对于这样一个完全统一的网格，我将创建一个子类，`UIView`并让它使用简单的计算来确定用户触摸了哪一行和哪一列：

```
int touchRow = 9 * touch.x / [self bounds].width;
int touchCol = 9 * touch.y / [self bounds].width;
```

当一个对象就足够时，我认为在内存中创建 81 个单独的对象并没有多大好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T17:49:18.320

我以前玩过数独游戏，我在一个视图中绘制了网格线和数字绘图。不是因为内存限制（使用单个控件和可重复使用的单元内存应该不是什么大问题），而是因为只需要一些简单的数学来计算网格和数字的位置，并且对视图进行编程一开始会更容易。如果稍后您开始对视图类中的绘图和事件处理代码的数量感到不知所措，您可能希望创建一个可重复使用的单元对象来完成大部分工作，类似于 UITableView。

如果您需要动画，核心动画当然也可以在这里工作。数独板可能不会有太多动画，但如果你有（可能是滑动“选择”框？）这可能是更好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T07:31:58.140

我一直使用[这段代码（来源：this blog）](http://skuggdev.wordpress.com/2008/10/01/calayer-grid-with-caconstraintlayoutmanager/)。这是进入制作网格的乐趣和不幸的一个很好的“入口”。我将此与一种算法结合起来，该算法查看“所需”对象的数量和可用的“框架”，并告诉我最佳的列/行数。考虑模数.. `int % int`...</p>

```
- (void)awakeFromNib {
    self.wantsLayer = YES;
    CALayer *grid = self.layer;
    grid.backgroundColor = CGColorCreateGenericRGB(0.1, 0.1, 0.4, .8);
    grid.layoutManager = [CAConstraintLayoutManager layoutManager];   
    int rows = 8;    int columns = 8;
    for (int r = 0; r < rows; r++) {
        for (int c = 0; c < columns; c++) {
            CALayer *cell = [CALayer layer];
            cell.borderColor = CGColorCreateGenericGray(0.8, 0.8);
            cell.borderWidth = 1;  cell.cornerRadius = 4;
            cell.name = [NSString stringWithFormat:@"%u@%u", c, r];
            [cell addConstraint:
            [CAConstraint constraintWithAttribute: kCAConstraintWidth
                relativeTo: @"superlayer"
                attribute: kCAConstraintWidth
                scale: 1.0 / columns  offset: 0]];
            [cell addConstraint:
            [CAConstraint constraintWithAttribute: kCAConstraintHeight
                relativeTo: @"superlayer"
                attribute: kCAConstraintHeight
                scale: 1.0 / rows   offset: 0]];
            [cell addConstraint:
            [CAConstraint constraintWithAttribute: kCAConstraintMinX
                relativeTo: @"superlayer"
                attribute: kCAConstraintMaxX
                scale: c / (float)columns   offset: 0]];
            [cell addConstraint:
            [CAConstraint constraintWithAttribute: kCAConstraintMinY
                relativeTo: @"superlayer"
                attribute: kCAConstraintMaxY
                scale: r / (float)rows    offset: 0]];
        [grid addSublayer:cell];
}   }   } 
```

![在此处输入图像描述](https://i.stack.imgur.com/r88WR.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-10T13:37:33.997

它非常简单。我使用 gridView 作为 UiViewController 类并在 gridView.m 中添加以下代码

```
#import "SudokuClass.h"
#import "GridView.h"

@interface GridView ()

@end

@implementation GridView

-(void)createNumberButton {

    int cellWidth = 34;
    int cellHeight = 34;
    int xSta = 7 - cellWidth;
    int ySta = 50 - cellHeight;
    //NSMutableDictionary *buttonTable = [[NSMutableDictionary alloc] initWithCapacity:81];
    for (int i = 1; i < 10; i++) {
        xSta = xSta + cellWidth;
        for (int j = 1 ; j < 10; j++) {
            ySta = ySta + cellHeight;
            CGRect pos = CGRectMake(xSta, ySta, cellWidth, cellHeight);
            UIButton *b = [SudokuClass createSudokuButtonForView:self atPos:pos 
                                                           withTag:j*10+i forAction:@selector(numButtonPressed:)];
            NSString *picName = @"ButtonPic.jpg";
            [b setBackgroundImage:[[UIImage imageNamed:picName] stretchableImageWithLeftCapWidth:0 topCapHeight:0]  forState:0];
            [self.view addSubview:b];
            //[numButtons addObject:b];
        }
        ySta = 50 - cellHeight;
    }}
-(void)viewDidLoad
{

    [self createNumberButton];
    [super viewDidLoad];
}
@end 
```

这里的数独类是我的 nsobject 类和方法

```
+(UIButton *)createSudokuButtonForView:(UIViewController *)view atPos:(CGRect)position withTag:(int)tag forAction:(SEL)action {
UIButton *b = [UIButton buttonWithType:UIButtonTypeCustom];
[b setFrame:position];
[b.titleLabel setFont:[UIFont boldSystemFontOfSize:15]];
[b setTag:tag];
[b addTarget:view action:action forControlEvents:UIControlEventTouchDown];
[b setTitle:@"" forState:0];
[b setTitleColor:[UIColor blackColor] forState:0];
//b.layer.frame = CGRectMake(xSta-1, ySta-1, 31, 31);
//[b.layer setBorderWidth:borderWidth];

b.userInteractionEnabled = YES;
return b;} 
```

希望任何人都觉得它有用..:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T16:46:53.423

网格是查看内容的一种方式，而不是存储表示的方式。最终，您的网格由具有内容的单元格组成，因此您的底层模型对象可能最好由单元格体现。为数独游戏设计底层存储的方法有很多种，更大的挑战肯定在于谜题的生成。但是，从中得到的建议是不要根据模型在屏幕上的显示方式来确定模型 - 视图层是完全独立的，因此像将板存储为二维数组这样的操作将是一个坏主意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-20T17:05:18.970

您可以使用 UIViews 或 CALayers 作为主超级视图的子视图来执行此操作。您至少需要 81 个（数独网格中的每个数字一个）。图层重量更轻，资源消耗更少，但视图具有更多功能。你选择哪一个取决于你想要做什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-20T17:32:18.713

某处有一篇关于如何实现数独求解器的文章。我认为它使用了这样的数据结构：

*   一个网格有 81 个单元格
*   一个单元格具有三个组成员身份：一列、一行和一个框
*   一个组有 9 个单元格（参考）

单元格具有更多属性，具体取决于您要对结构执行的操作：

*   一个值
*   一面旗帜（用于`hidden`游戏）
*   一组可能的值（用于求解器）

# asp.net - 如何从 refcursor 填充更新面板中的网格

> ID：305864
> 
> 赞同：0
> 
> 时间：2008-11-20T16:17:03.407
> 
> 标签：asp.net, oracle

我正在使用 ASP.NET 2.0 和 VS 2005。用户单击按钮后，我需要从 Oracle refcursor 填充更新面板上的网格。我有一个来自另一个项目的例子，但它非常复杂。有没有一种简单的方法可以在更新面板的网格中显示数据？我们不希望在第一次打开选项卡时显示数据，就在用户单击按钮之后。

TIA，特蕾莎

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-20T20:20:59.730

我在这里发布了一些代码，因为这些东西很难弄清楚和研究。这是使用 Microsoft Oracle 数据提供程序（我更喜欢[ODP.NET](http://www.oracle.com/technology/tech/windows/odpnet/index.html)）的一种简单方法：

```
<%@ Page Language="C#" AutoEventWireup="true" %>
<%@ Import Namespace="System.Data" %>
<%@ Import Namespace="System.Data.OracleClient" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title>GridView w/ Oracle Ref Cursor</title>
<style type="text/css">
    body {padding:25px;}
    .Button1 {margin:35px 0;}
</style>
<script runat="server" type="text/C#">
    protected void Page_Load(object sender, EventArgs e) {
    }

    protected void Button1_Click(object sender, EventArgs e) {
        var dataSet = new DataSet();
        // get connection string from web.config
        var connStr = ConfigurationManager.ConnectionStrings["ConnStr1"].ConnectionString;
        // create connection
        using (var conn = new OracleConnection(connStr)) {
            // create & define the parameter
            var refCursorParam = new OracleParameter();
            refCursorParam.ParameterName = "RET";
            refCursorParam.OracleType = OracleType.Cursor;
            refCursorParam.Direction = ParameterDirection.Output;
            // create & define the command
            var cmd = new OracleCommand();
            cmd.CommandText = "GET_ALL_EMPS";
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.Parameters.Add(refCursorParam);
            cmd.Connection = conn;
            // use data adapter to fill dataset
            using (var adapter = new OracleDataAdapter(cmd))
                adapter.Fill(dataSet);
        }
        // set some gridview properties
        GridView1.AllowPaging = true;
        GridView1.PageSize = 5;

        // bind dataset to grid
        GridView1.DataSourceID = null;
        var dv = dataSet.Tables[0].AsDataView();
        // save dataview to session so gridview can be re-bound later
        Session["dataView"] = dv;
        GridView1.DataSource = dv;
        GridView1.DataBind();

        pCount.InnerText = "Total Row Count: " + dataSet.Tables[0].Rows.Count.ToString();

        // dispose of dataset
        dataSet.Dispose();
    }

    void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e) {
        // get dataview from session
        var dv = (DataView)Session["dataView"];
        GridView1.DataSource = dv;
        GridView1.PageIndex = e.NewPageIndex;
        GridView1.DataBind(); // re-bind data
    }
</script>
</head>
<body>
<form id="form1" runat="server">
<asp:ScriptManager ID="ScriptManager1" runat="server" />
<div>
    <asp:UpdatePanel id="updatepanel1" runat="server">
        <ContentTemplate>
            <asp:Button ID="Button1"
                runat="server"
                Text="Refresh GridView"
                OnClick="Button1_Click" />
            <p id="pCount" runat="server" />
            <asp:GridView ID="GridView1"
                          runat="server"
                          OnPageIndexChanging="GridView1_PageIndexChanging" />
        </ContentTemplate>
    </asp:UpdatePanel>
</div>
</form>
</body>
</html> 
```

试试这个，如果您有任何问题，请告诉我。这里有一些很好的参考：

*   [http://msdn.microsoft.com/en-us/library/system.data.oracleclient.oracledataadapter.aspx](http://msdn.microsoft.com/en-us/library/system.data.oracleclient.oracledataadapter.aspx)
*   [http://msdn.microsoft.com/en-us/library/0e39s2ck.aspx](http://msdn.microsoft.com/en-us/library/0e39s2ck.aspx)

-加布

# c# - 从 Windows 服务访问环境变量

> ID：305870
> 
> 赞同：31
> 
> 时间：2008-11-20T16:17:45.917
> 
> 标签：c#, windows-services, permissions

我正在尝试用 C# 编写 Windows 服务。我需要找到某个文件的路径，该文件存储在环境变量中。在常规的 C# 控制台应用程序中，我可以使用以下行来实现：

```
string t = System.Environment.GetEnvironmentVariable("TIP_HOME"); 
```

如果我将其写入控制台，我会看到它是成功的。

现在，如果我在 Windows 服务中尝试相同的代码，则字符串`t`为空。

知道为什么吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2010-04-28T10:22:05.427

我不知道这是否有用，但我发现对于每个服务，都可以选择将环境变量直接添加到服务中。

它是通过注册表完成的。

说您的服务的关键是...

HKLM\SYSTEM\CurrentControlSet\Services\YourService

创建一个名为 Environment 的 REG_MULTI_SZ。

现在您可以添加条目，例如...

```
Var1=Value1
Var2=Value2 
```

这些将可用于服务代码。

如果您使用 Windows 资源工具包将脚本安装为服务（instsrv.exe 和 srvany.exe），那么您可以再次选择为服务设置环境变量，但很可能是错误的，因为这些将用于 srvany.exe。

相反，您使用密钥...

HKLM\SYSTEM\CurrentControlSet\Services\YourService\Parameters

并创建一个名为 AppEnvironment 的 REG_MULTI_SZ

以相同的方式设置条目。

现在您的脚本服务拥有自己的环境变量。

我将这些技术与 PHP+WinCache 一起使用，以允许我为每个服务设置唯一的 APP_POOL_ID，这允许 WinCache 为所有“线程”（使用 WShell 启动非阻塞子“线程”共享中央缓存（基于 APP_POOL_ID） "并且仍然与启动器共享相同的 WinCache，允许简单的进程间通信）。

反正。我希望这会有所帮助。

我认为，主要是，您不会向全局环境添加不必要的 env_vars。当您拥有超过 1 个时，您可以使它们具有针对性和独特性。

问候，

理查德。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-11-20T17:03:49.503

您的问题似乎与我们经历过的类似，并且很难弄清楚发生了什么。

发生的情况是，当环境变量被添加/删除/更改时，*服务环境*在“重新启动”之前不会识别这一点。这是因为这些环境变量存储在注册表中，并且该注册表**仅被服务环境读取一次**......在**系统启动**时。

这意味着为了让服务获取环境变量的变化，需要重新启动系统。

查看有关此的[Microsoft KB](http://support.microsoft.com/kb/887693)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-20T16:19:58.907

该服务可能在不同的帐户下运行，并且没有获得相同的环境变量。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-20T17:21:49.170

您是否在本地系统帐户下运行该服务？

添加 TIP_HOME 变量后是否重新启动了机器？

在本地系统下运行的服务从 services.exe 服务启动，该服务仅在启动时读取其环境：http: [//support.microsoft.com/kb/821761](http://support.microsoft.com/kb/821761)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T16:36:51.913

您知道**系统**和**用户**环境变量吗？默认情况下，Windows 服务在**系统**帐户下运行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-20T17:13:42.947

好的，我不太明白这一点，但这是我发现的..

在同一个服务中，我首先尝试我之前描述的内容，字符串返回空。

然后，如果我枚举每个系统级环境变量，它会找到我正在寻找的变量。

这是一个代码片段，根据 MSDN 上的一些示例代码稍作修改：

```
foreach(DictionaryEntry de in Environment.GetEnvironmentVariables(tgt))
{
    key   = (string)de.Key;
    value = (string)de.Value;

    if(key.Equals("TIP_HOME") && value != null)
        log.WriteEntry("TIP_HOME="+value, EventLogEntryType.Information);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-15T10:34:51.340

试试这个代码字符串 getsyspath = System.Environment.GetEnvironmentVariable("TIP_HOME",EnvironmentVariableTarget.Machine);

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-06-16T06:56:01.440

您需要检查变量的存储方式。Set/GetEnvironmentVariable 有重载方法：

[Environment.GetEnvironmentVariable 方法（字符串，EnvironmentVariableTarget）](http://msdn.microsoft.com/en-us/library/y6k3c7b0.aspx)

[问题是，存储环境变量（ EnvironmentVariableTarget](http://msdn.microsoft.com/en-us/library/system.environmentvariabletarget.aspx) ）有三种类型：

*   机器（适用于所有用户）
*   用户（当前用户可用）
*   进程（仅适用于当前进程 [不推荐顺便说一句]）

如果您将信息存储为机器或用户，那么您可以在运行时对其进行测试 Run (Win + R): %TIP_HOME%

希望能帮助到你 ：）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-03-21T00:19:44.030

服务通常在三个服务帐户之一下运行，`Local Service` `Local System`并且`Network Service`. 对于所有这些，您的典型环境变量将为**null**。

* * *

**去弄清楚**

* * *

我通过让服务写入事件日志条目并打印它在 HOMEPATH 变量中存储的内容来进行测试。对于服务帐户，它返回为空。在 C# 中：

```
protected override void OnStart(string[] args)
{
    EventLog.WriteEntry("The HomePath for this service is '" + Environment.GetEnvironmentVariable("HOMEPATH") + "'", EventLogEntryType.Information);
} 
```

* * *

**可能的解决方案**

* * *

您可以在服务属性窗口或服务安装配置中设置服务使用的帐户（例如您的用户帐户）。当我使用我的用户帐户进行测试时，会显示事件日志条目`The HomePath for this service is '\Users\Admin-PC'`。如果它使用您的用户帐户，它将可以访问您通常可以访问的所有环境变量。
![在此处输入图像描述](https://i.stack.imgur.com/RKLYm.png). ![在此处输入图像描述](https://i.stack.imgur.com/iEyhD.png)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-20T16:40:50.377

我将那行代码修改为：

字符串 t = System.Environment.GetEnvironmentVariable("TIP_HOME", EnvironmentVariableTarget.Machine);

我可以查看我的注册表并查看 TIP_HOME 是否已设置。

这来自 MSDN：机器：环境变量是从 Windows 操作系统注册表中的 HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment 键存储或检索的。

用户变量存储在注册表中的其他位置。

但是，当我使用此更改运行服务时，字符串仍然显示为空。

# virtual-pc - SysPrep 和 NewSid 有什么区别？

> ID：305872
> 
> 赞同：4
> 
> 时间：2008-11-20T16:18:31.170
> 
> 标签：virtual-pc

我正在设置一些虚拟 PC 映像。我想用一些预装的工具来定制机器，然后以此为基础来创建新机器。

准备机器以供使用的最佳做法是什么？

我应该使用 SysPrep 还是 NewSid？什么时候使用比较合适，它们之间的对比是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-21T14:26:10.727

Sysprep 包括 NewSID 的功能。它通过从安装中剥离特定于机器的内容（例如机器名称和 SID）来“准备”用于映像的 WIndows 安装。如果您没有使用 Sysprep，则在部署映像后，您肯定需要在每台 PC 上运行像 NewSID 这样的程序。

——史蒂夫·奥尔森

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-21T14:32:18.047

NewSid 似乎有一些问题。我知道使用 Windows Sharepoint Services 3.0 和基于它们构建的技术（Sharepoint Server 2007、Project Server 2007），您可能会遇到此处列出的问题：

[NewSID 和 SharePoint 2007](http://forum.sysinternals.com/forum_posts.asp?TID=6260)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T11:23:11.760

除了这里已经发布的答案之外，还需要注意的是 SysPrep 得到 Microsoft 的完全支持，而 NewSID 则不支持。

# visual-studio - 如何取回我的 SVN 客户端删除的文件？

> ID：305874
> 
> 赞同：1
> 
> 时间：2008-11-20T16:19:28.423
> 
> 标签：visual-studio, svn, visualsvn

我刚刚从 SVN 更新，我的一个文件现在已经消失了......当然它没有提交，因为我知道我需要先更新+合并。我想也许那个人重命名了文件，这意味着我的 SVN 客户端删除了我的文件。

我正在使用 VC++ 2008 和 Visual SVN。

帮助......并作为参考，应该如何避免这种事情？你不应该在提交之前更新吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T20:21:53.677

如果您在 VS 中查找该文件，则该文件很可能仍然存在于您的目录中，但只是不再在项目中引用（因为 VS 只会显示您项目中的文件）。如果文件被重命名，这很可能是您无法在 Visual Studio 中找到它的原因。我会检查文件曾经存在的实际目录。

如果它不存在，您可以通过单击包含目录并恢复到包含该文件的先前修订版从存储库中检索旧文件（文件删除是对目录的操作）。

如果有修改，则不应删除文件的本地副本。这种事情很烦人，但希望不会经常发生（你多久重命名一次文件？）。当然，这也正是您应该在提交之前更新的原因。在这种情况下，您需要手动将您对旧文件所做的更改合并到新文件中，并确保它仍然可以编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-22T00:15:21.490

这正是几周前发生在我身上的。当我做“更新”而不是“提交”时，我很累。我的工作不见了，我可以用[Undelete tool](http://ntfsundelete.com/)恢复其中的一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T16:54:07.917

如果您更改了文件，SVN 应该备份文件。检查是否有以“.”开头的文件 并且在您更改的文件应该位于的目录中的名称中的某处进行了修订。

如果不是这种情况，请检查 Visual SVN 中的设置。或者也许 Visual SVN 不这样做。改用[TortoiseSVN](http://tortoisesvn.tigris.org/)。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-11-22T00:05:55.160

答案向您展示了如何恢复文件，但更重要的是您问题的第二部分：如何避免此类事情？

为此，您可以锁定文件。这意味着您希望不受干扰地处理此文件。SVN 将不允许任何其他用户提交锁定文件。这也包括删除。

# java - Hibernate 注释放置问题

> ID：305880
> 
> 赞同：24
> 
> 时间：2008-11-20T16:20:45.473
> 
> 标签：java, hibernate, annotations

我有一个我认为很简单的问题。我已经看到了两种方式的例子。问题是 - “为什么我不能将我的注释放在字段上？”。让我给你举个例子....

```
@Entity
@Table(name="widget")
public class Widget {
 private Integer id;

 @Id
 @GeneratedValue(strategy=GenerationType.AUTO)
 public Integer getId() { return this.id; }
 public Integer setId(Integer Id) { this.id = id;}
} 
```

上面的代码工作正常（假设那里没有错字）。当注释放在属性的 getter 上时，一切都很完美。

然而，这对我来说似乎很尴尬。在我看来，将注释放在字段上会更干净，就像这样 -

```
@Entity
@Table(name="widget")
public class Widget {
 @Id
 @GeneratedValue(strategy=GenerationType.AUTO)
 private Integer id;

 public Integer getId() { return this.id; }
 public Integer setId(Integer Id) { this.id = id;}
} 
```

我已经看到了这两种方式的例子。但是，当我运行第二个示例时，我得到以下...

```
java.lang.NullPointerException
    在 com.widget.util.hibernate.HibernateSessionFactory$ThreadLocalSession.initialValue(HibernateSessionFactory.java:25)
    在 com.widget.util.hibernate.HibernateSessionFactory$ThreadLocalSession.initialValue(HibernateSessionFactory.java:1)
    在 java.lang.ThreadLocal$ThreadLocalMap.getAfterMiss（未知来源）
    在 java.lang.ThreadLocal$ThreadLocalMap.get（未知来源）
    在 java.lang.ThreadLocal$ThreadLocalMap.access$000（未知来源）
    在 java.lang.ThreadLocal.get（未知来源）
    在 com.widget.util.hibernate.HibernateSessionFactory.get(HibernateSessionFactory.java:33)
    在 com.widget.db.dao.AbstractDao.(AbstractDao.java:12)
    在 com.widget.db.dao.WidgetDao.(WidgetDao.java:9)
    在 com.widget.db.dao.test.WidgetDaoTest.findById(WidgetDaoTest.java:17)
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 sun.reflect.NativeMethodAccessorImpl.invoke（未知来源）
    在 sun.reflect.DelegatingMethodAccessorImpl.invoke（未知来源）
    在 java.lang.reflect.Method.invoke（未知来源）
    ...

```

`HibernateSessionFactory`这是（标记第 25 行）的骨架......

```
protected Session initialValue() {
    SessionFactory sessionFactory = null;
    try {
        Configuration cfg = new AnnotationConfiguration().configure();
        String url = System.getProperty("jdbc.url");
        if (url != null) {
            cfg.setProperty("hibernate.connection.url", url);
        }
        sessionFactory = cfg.buildSessionFactory();
    }
    catch (Exception e) {
    }

    Session session = sessionFactory.openSession();  // LINE 25
    return session;
} 
```

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-11-20T23:05:26.810

从性能和设计的角度来看，在 getter 上使用注解比成员变量更好，因为如果将 getter setter 放在字段上，则使用反射而不是方法调用。此外，如果您计划使用 hibernate 的验证和其他功能，您将在一个地方拥有所有注释，而不是将它们分散在一个地方。

我的建议是使用方法而不是成员变量。

从文档

> 根据您是否注释字段或方法，Hibernate 使用的访问类型将是字段或属性。EJB3 规范要求您在将被访问的元素类型上声明注释，即，如果您使用属性访问，则为 getter 方法，如果您使用字段访问，则为字段。应避免在字段和方法中混合使用 EJB3 注释。Hibernate 会从@Id 或@EmbeddedId 的位置猜测访问类型。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-20T17:49:16.353

你让我走上了正确的轨道工具包。谢谢。这是交易......当然，我人为的例子并没有包括整个故事。我的 Widget 类实际上比我给出的示例大得多。我有几个额外的字段/吸气剂，我正在***混合***我的注释。所以我在字段上注释了@Id，但其他人在getter上被注释了。

所以这个故事的寓意是你不能混合注释位置。所有注释都在字段上，或者它们在 getter 方法上。长期使用 Java 和 Hibernate，是 Annotations 的新手。每天学习一些东西。

一旦我知道谷歌需要什么，我就会发现这很有帮助 - [http://chstath.blogspot.com/2007/05/field-access-vs-property-access-in-jpa.html](http://chstath.blogspot.com/2007/05/field-access-vs-property-access-in-jpa.html)

当然，这现在提出了一个问题，即从设计和性能的角度来看哪个更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T17:20:25.070

一个很长的范围，但是你有一个旧`*.hbm.xml`文件吗？

也许它可能会选择错误的设置`default-access`并使用`property`而不是`field`？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-27T17:29:52.047

这是一个非常好的链接，可以帮助您了解访问类型和相关的最佳实践！

在 Hibernate 中理解[@AccessType](http://javaprogrammingtips4u.blogspot.com/2010/04/field-versus-property-access-in.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T16:26:22.950

如果您执行以下操作，它是否有效：

```
@Entity
@Table(name="widget")
public class Widget {
    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)

    private Integer id;

    public Integer getId() { return this.id; }
    public Integer setId(Integer Id) { this.id = id;}
} 
```

# mysql - 将数据从 My Sql 导入 Sql Server 的最简单方法

> ID：305886
> 
> 赞同：7
> 
> 时间：2008-11-20T16:22:31.990
> 
> 标签：mysql, sql-server, import

对于一个新项目，我必须从 MySql 导入预先存在的数据。

在[这个站点](http://www.connectionstrings.com/?carrier=mysql)中，我找到了许多选项，其中一些包括驱动程序的安装。最快和最简单的方法是什么？

更新：这只是一次导入

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-06-21T09:38:34.850

```
-- Create Link Server

EXEC master.dbo.sp_addlinkedserver 
@server = N'MYSQL', 
@srvproduct=N'MySQL', 
@provider=N'MSDASQL', 
@provstr=N'DRIVER={MySQL ODBC 5.1 Driver}; SERVER=localhost; _
     DATABASE=tigerdb; USER=root; PASSWORD=hejsan; OPTION=3'

-- Import Data

SELECT * INTO testMySQL.dbo.shoutbox
FROM openquery(MYSQL, 'SELECT * FROM tigerdb.shoutbox') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T13:35:33.670

要转换`MySQL to MS SQL Server`数据库，您可以使用[Microsoft SQL Server 数据库迁移助手](http://www.microsoft.com/sqlserver/en/us/product-info/migration-tool.aspx#MySQL)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-21T21:59:01.280

My team recently did the opposite, SqlServer to MySql, using the MySql Migration Toolkit (for moving a Fogbugz install from Windows to Linux) and it worked very well. We had trouble with a tool called MSSQL2MySql, it didn't work so well. I'm not sure if the migration toolkit handles the opposite direction, but it might be worth a look.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T16:43:28.703

如果您有权访问 phpMyAdmin，则可以运行整个数据库的导出。它将生成一长串 SQL 命令来创建所有模式，并可选择将所有数据插入到它们各自的位置。

也可以从命令行执行所有这些操作。

如果您有大量数据，您可能希望将所有数据分段完成，每个表的单个 SQL 脚本和插入到每个表中。

然后在 M$ SQL 端创建数据库，使用 SQL 查询分析器或 SQL Management Studio 连接到它，将您的 SQL 脚本复制粘贴到窗口中并执行。

您的大部分 MySQL 代码很有可能只能在 M$SQL 中运行。如果遇到问题，您可以在 MySQL 导出上设置兼容级别，以更好地适应您的目标环境。

如果您只是在做数据，只要架构匹配，您所要做的就是编写数据导入/导出脚本，不要编写架构脚本，当然不要脚本丢失！！！

编辑：如果您必须进行任何转换，我相信您可以导出到 M$ Excel，当然也可以导出到 CSV，然后在 M$SQL 导入上进行映射等。

# c# - 如何在 Linq 实体上延迟加载单个属性？

> ID：305892
> 
> 赞同：2
> 
> 时间：2008-11-20T16:23:45.373
> 
> 标签：c#, linq, linq-to-sql

我正在将 Linq 手动编码为 SQL 实体，并且有一个大型 XML 列，我不希望每次加载该实体时都加载该列，因为它不经常使用。在我搜索的任何地方，我都看到 Linq to SQL 设计器提供了“延迟加载”属性，但 ColumnAttribute 类没有任何关于如何实现的提示。

我已经收集到它与 System.Data.Linq.Link 类有关，但我还没有找到让它工作的魔法咒语。

有谁知道如何在手动编码的 Linq to SQL C# 类中实现延迟加载的属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T16:33:05.587

我已经剖析了设计师生成的代码的结果。

第 1 步：使用 System.Data.Linq.Link 类型创建一个私有成员：

```
private System.Data.Linq.Link<String> _columnName; 
```

第二步：将Column属性的Storage参数设置为此成员名，并填写属性getter和setter：

```
[Column(Name = "column_name", Storage = "_columnName"...]
public String ColumnName 
{
    get
    {
        return _columnName.Value;
    }
    set
    {
        _columnName.Value = value;
    }
} 
```

# ajax - 检测 AJAX/XmlHttpRequestSupport 的最佳实践

> ID：305894
> 
> 赞同：0
> 
> 时间：2008-11-20T16:24:04.187
> 
> 标签：ajax, xmlhttprequest

我正在尝试更新用于检测 AJAX 支持的旧 JavaScript 函数（即 XmlHttpRequest 对象）。我在网上查看（包括 SO）并找到了各种解决方案，但我不确定哪种方法对于简单地检测支持最有效。

目前的功能是：

```
 function IsSyncAJAXSupported()
    {
        var isSyncAJAXSupported = true;

        var xmlHttp = null;
        var clsids = ["Msxml2.XMLHTTP.4.0", "MSXML2.XMLHTTP", "Microsoft.XMLHTTP"];
        for(var i=0; i<clsids.length && xmlHttp == null; i++) {
            try {
                    xmlHttp = new ActiveXObject(clsids[i]);
            } catch(e){}
        }

        if(xmlHttp == null && MS.Browser.isIE)
        {
            isSyncAJAXSupported = false;
        }
        return isSyncAJAXSupported;
    } 
```

在 Firefox 3 中，上面给出了错误，因为 MS 未定义。

我意识到使用图书馆会更好，但这不是短期的选择。我们仅支持 IE6 及以上版本 + 最新版本的 Firefox、Safari/WebKit 和 Opera。

获得 XmlHttpRequest 支持的真/假的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T16:29:05.690

**不！**

或者更确切地说，不要浪费时间做许多其他人做得更好的事情。

尝试获取 jQuery 或类似的源代码并“借用”他们的方法；他们已经投入了时间来支持尽可能多的浏览器（尤其是在 jQuery 的情况下），所以节省自己的时间。

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T16:30:47.357

我的首选代码是：

```
function CreateXMLHttpRequest()
{
  // Firefox and others
  try { return new XMLHttpRequest(); } catch (e) {}
  // Internet Explorer
  try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch (e) {}
  try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) {}
  //alert("XMLHttpRequest not supported");
  // No luck!
  return null;
} 
```

您可以轻松地为 Microsoft 对象的变体添加测试...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T17:09:21.367

我想出了这个：

```
var xhr = null;
try { xhr = new XMLHttpRequest(); } catch (e) {}
try { xhr = new ActiveXObject("Microsoft.XMLHTTP"); } catch (e) {}
try { xhr = new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) {}
return (xhr!=null); 
```

它似乎有效，所以我想分享它。

# linux - 如何用 Perl 杀死整个进程树？

> ID：305905
> 
> 赞同：7
> 
> 时间：2008-11-20T16:27:20.983
> 
> 标签：linux, perl, process, solaris, kill

从 Perl 脚本中杀死一个进程及其所有子进程的最佳方法是什么？它至少应该在 Linux 和 Solaris 下运行，并且不需要安装任何额外的软件包。

我的猜测是通过解析 /proc 中的文件或解析`ps`（在 Linux 和 Solaris 之间似乎都不可移植）的输出来获取所有进程及其父进程的列表；然后杀死树中的所有进程（这似乎容易出现竞争条件）。

在这种特殊情况下，我可以忍受竞争条件，但我如何便携地获取进程列表？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-20T16:29:23.833

如果您可以忍受终止进程组，则可以使用以下命令：

```
kill -$signum, $pgid; 
```

其中`$signum`是信号编号，`$pgid`是进程组 ID。但是，信号编号​​不是很便携，在这种情况下，您可以（在某些平台上；阅读`perlfunc`说明）执行以下操作（`SIGTERM`例如，发送）：

```
kill 'TERM', -$pgid; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-20T16:35:08.767

CPAN 有一个答案。是的，我知道你不想安装额外的模块，但至少你可以看看实现，看看他们在做什么......

[https://metacpan.org/pod/Proc::ProcessTable](https://metacpan.org/pod/Proc::ProcessTable)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-08T12:04:08.080

我改编并破解了“rkill”来完成这项工作，这很容易。

[https://gitlab.com/pslist/pslist/blob/master/pslist](https://gitlab.com/pslist/pslist/blob/master/pslist)

这是 ubuntu 中“pslist”包的一部分。

# agile - 对于 Scrum 流程，你喜欢什么，不喜欢什么？

> ID：305907
> 
> 赞同：0
> 
> 时间：2008-11-20T16:27:38.220
> 
> 标签：agile, scrum

我所在的团队在我们的开发过程中使用 scrum。我们目前正在尝试改进我们流程的某些方面，以解决我们最近注意到的一些问题。在这样做的过程中，我们正在探索我们对 Scrum 流程的总体喜欢和不喜欢的地方，以帮助我们确定我们作为一个团队在工作中的价值观。我们认为，如果我们能够确定我们重视什么，那么我们就可以提出围绕这些价值观的实施，以帮助新的解决方案在团队中坚持下去。

话虽如此，我真的很感兴趣其他人如何看待 Scrum 过程。你真正喜欢它的哪一点？什么是令人沮丧的，感觉开销太大或没有生产力？成功和失败的具体例子很好，但我感兴趣的是一个更大的观点，讨论围绕 scrum 的陷阱或 scrum 真正闪耀的地方。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T16:40:16.807

我不喜欢管理者将 Scrum 流程作为快速发布周期来实现，而所有其他方面都与瀑布流相同或更糟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T23:25:30.323

我认为根据我的经验，关键是要了解业务和管理人员如何选择实施 Scrum 和/或敏捷的部分内容，或者换句话说，他们对流行语的解释。

我喜欢每日站立的想法，每个人都说他们昨天做了什么，他们今天计划做什么以及他们有什么障碍，因为这会产生责任感，假设没有更好的术语来表达尊重和荣誉。

任务卡及其演变对于其他人了解正在发生的事情以及让某人了解他们是否确定了某些事情很有用。卡片在某种程度上确实为自己的沟通渠道做出了贡献，这取决于您如何看待它，这可能是好是坏。

回顾和迭代计划会议通常有助于让每个人都进入同一页面，并允许对流程进行反馈，以帮助从人们看到的任何角度改进流程。我认为在这里有一个好的领导者是必不可少的，因为如果团队一两次切线，这些会议的效率可能会降低。

我发现回顾与我在以前的工作场所进行的验尸非常相似。我发现它们对几件事非常有用：

1.  看看别人认为通常是好是坏。测试是个大问题吗？当项目只有 2 周或更短时间时，新员工进来是否有帮助？

2.  让每个人都有发言权。这有助于培养归属感和团队合作精神，当您希望有人在夜里熬夜或在这里和那里工作到很晚时，这会很有用。

保持每日站立的速度是一个挑战，但如果完成了一定数量的练习，它就会变得更加自然。在某种程度上，围绕 Scrum 的过程可以放大好习惯和坏习惯，具体取决于它的使用方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-21T09:06:19.310

这是一个相当广泛的问题！这是我的看法。

我认为 Scrum 真正擅长的是教会组织热爱敏捷/迭代/增量/精益软件开发。对于习惯于项目管理的命令和控制层次结构的公司而言，团队成功地真正适应客户需求所必需的授权是一种巨大的文化转变。Scrum 使所有这些对于组织来说都是平易近人的，具有明确定义的角色和流程。

基本上，对我来说，它为程序员团队购买了他们在大公司的所有政治和官僚机构中继续进行 XP 所需的空间。

然而，随着这种授权而来的是责任。Scrum 不强制要求任何 XP 工程实践，但如果没有 CI、TDD 和重构等核心实践，任何 Scrum 团队都会在几次迭代后陷入停顿。我个人认为在 scrum 的“规则”中不明确这一点是非常不负责任的，这将是我的批评之一。

我的另一个批评是任务卡和任务计划。我还没有看到一个团队这样做真的很有效：通常会有一个非常累人的一天，你试图考虑在整个迭代中你将要做的所有事情，然后你开始工作并发现你实际上需要做一些不同的事情。通过任务燃尽来衡量进度感觉像是让团队协作和团结的好方法（特别是如果您否认任务所有权），但最终它不是跟踪团队进度的可靠方法。

我更加强调价值或故事点的**燃尽**，而这些天通常会让团队每天更新一个大的[累积流程图](http://bdn1.borland.com/borcon2004/article/paper/0,1963,32096,00.html)，而不是我们所处的位置。这些任务保留在人们的待办事项清单上，但它们不会出现在董事会或由任何人管理。

当然，关键的做法是回顾。Mike Cohn 对我之前关于 XP 实践的观点的反驳是，通过回顾，团队最终会发明/采用 XP，这确实有一定的道理。当然，定期自省是确保您的团队尽可能有效并继续有效的最佳方式。

# c# - 对属性的字段或属性进行分配时会发生什么

> ID：305911
> 
> 赞同：1
> 
> 时间：2008-11-20T16:28:24.083
> 
> 标签：c#, properties, get, set

假设您有如下属性：

```
Person person1;

public Person Captin{
    get{
        return person1;
    }
    set{
        person1 = value;
    }
}

public void SomeFunction(){
    Captin.name = "Hook"
} 
```

在这种情况下，如果您在属性上设置名称，我们知道 Hook 的新名称将应用于 person1 的基础值。如果我们的实现有点不同怎么办？

```
public Person Captin{
    get{
        return ReadCaptinFromDisk();
    }
    set{
        WriteCaptinToDisk(value);
    }
}

public void SomeFunction(){
    Captin.name = "Hook"
} 
```

在这种情况下，为了正确设置基础值，我们需要调用 Captin 的设置代码作为对 Captin.name 的赋值的一部分。

我有兴趣知道参数集代码是否会调用属性引用上的字段分配或方法调用集。特别是对于需要将值传播到磁盘（等）的这种情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T16:33:50.033

每次您访问您的属性 Captin 时，它都会从磁盘读取。但是，如果您更改属性“名称”，它将不会写入磁盘。如果您执行类似的操作，它只会写入磁盘

```
public void SomeFunction() {
   Person p = Captin;
   p.name = "Hook";
   Captin = p;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T16:41:24.370

正如@Joe 所说，它不会写入磁盘。我只是想补充一点，这是因为您只使用了 getter，而不是 setter。@Joe 的示例同时使用了两者。

在我看来，这既是对 getter 的非常糟糕的使用，又违反了关注点分离。您应该有一个数据层来处理持久化数据。这个逻辑不应该在您的业务对象中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T17:15:14.160

只有当有人实际直接分配给它时，才会调用该属性的 setter。

至于您的代码是否可以：这是文档问题。

每当你有一个属性返回可变的东西时，你应该指出它是否会发生什么突变。您是返回“真实”数据的副本，还是返回真实数据本身？当一个属性（或普通方法）返回某种集合时，这经常出现——它是可变的？如果我改变它会发生什么？

如果您记录您的属性​​并解释返回的数据只是一个副本，并且更改不会反映在任何地方，那很好。如果你让它模棱两可，那就是你遇到问题的时候。

当然，不变性消除了这些担忧......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T18:42:10.857

类类型变量、参数、字段、返回值或其他此类存储位置应被视为持有“对象 ID”。如果某个对象`Foo`有一个`Bar`由 field 支持的某个类类型的属性`_Bar`，并`_Bar`持有“object id#24601”，那么该语句`Foo.Bar.Text = "George"`将调用`Text`对象#24601 上的setter，其值为“George”。请注意，此语句不会修改对象`Foo`本身（其字段`_Bar`在语句执行之前将保留“object id#24601”，并且在执行后仍将保留）；但是，它可能会影响对象 #24601。

结构类型的存储位置应被视为保存其所有字段（公共和私有）的内容。如果`Foo.Boz`是 type 的属性`Rectangle`（它是一个结构）和支持 field `_Boz`，则访问`Foo.Boz`将创建一个新的 type 临时实例`Rectangle`，其所有字段都将从`Foo._Boz`. 尝试读取`Foo.Boz.X`会将 的所有字段复制`_Boz`到临时实例，然后访问`X`该实例的字段。

请注意，一些非常古老和邪恶的 C# 编译器会将代码解释为`Foo.Boz.X = 5;`as `Rectangle temp; temp.X = 5;`，丢弃 temp 的结果值但不发出任何警告。这样的编译器行为导致一些人声明结构应该是“不可变的”，以确保这样的代码会产生编译器错误而不是产生虚假行为。不幸的是，这种信念一直持续到今天，尽管任何体面的编译器都会禁止这样的代码，即使`X`是可变字段。

请注意，更新可变结构类型的属性的正确惯用方法是：

```
  矩形温度 = MyListOFRectangles[5];
  温度 X = 5;
  MyListOFRectangles[5] = temp;

```

如果`Rectangle`已知有一个名为`X`, 并且`MyListOfRectangles`是 a的公共整数字段，则`List<Rectangle>`无需了解 的任何`Rectangle`其他属性、构造函数等，即可知道上述代码将更改`MyListOfRectangles[5].X`但不会影响任何其他属性的`MyListOfRectangles[5]`，也不是 的任何属性`MyListOfRectangles[4]`。很好，清晰，简单。与任何其他类型的数据类型不同，暴露字段结构允许以清晰一致的方式对值进行分段编辑。

# asp.net-mvc - Html.DropDownList 和模型绑定

> ID：305913
> 
> 赞同：3
> 
> 时间：2008-11-20T16:28:55.567
> 
> 标签：asp.net-mvc, selectlist

**为什么模型绑定不能在 DropDown 上工作？**
我究竟做错了什么？
为了说明我的问题，我做了以下事情：

创建了一个新的 asp.net MVC 项目（beta1） 创建了以下类：

```
HomeViewData : ViewDataDictionary  
+List : SelectList 
```

向 HomeController 类添加了一个视图数据，如下所示

```
Homecontroller: Controller
+HomeViewData vd = new HomeViewData 
```

将以下行添加到我的 Home.Index() 方法中

```
vd.list = new SelectList(new List<string>(){"test", "test1", "test2"});
return View("Index", vd); 
```

并复制了相同的方法，但使用不同的签名来捕获回发调用

```
[AcceptVerps(HttpVerbs.Post)]
public ActionResult Index(HomeViewdata d) 
```

这里我在第一行代码中添加了一个断点。
然后我将以下代码添加到我的 Index.aspx

```
<%Html.BeginForm();%>
    <%=Html.DropDownList("List")%>
<%Html.EndForm();%> 
```

结果，我得到了一个包含值 test、test1 和 test2 的漂亮下拉列表的页面。
然后在选择一个值后，我按下回车键（不用提交按钮），看看我的断点是如何停止代码的。我检查 HomeViewData 的值... **NULL**

如果我做同样的练习，但例如使用文本框，一切都很好......
**--EDIT--**
自从这篇文章以来我尝试过的事情：

*   按照 Phil 的建议，在我的操作中添加 [Bind(Prefix="")] 属性
*   添加 [Bind(Prefix=" ")] 以查看这是否会消除“不允许使用空名称”的错误
*   在我的控件名称中添加我的操作参数的名称

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-21T17:15:45.580

啊，这里的问题是，按照惯例，模型绑定器正在寻找“d.PropertyName”形式的值，因为您的 Index 操作方法的参数是“d”。

由于一个动作方法可以有多个参数，我们默认使用参数名称作为前缀。

解决这个问题很容易，只需使用 Bind 属性告诉 MVC 不要使用前缀。

```
[AcceptVerps(HttpVerbs.Post)]
public ActionResult Index([Bind(Prefix="")]HomeViewdata d) 
```

# c# - WinForms - 如何从 WebBrowser 控件内部执行 C# 应用程序代码？

> ID：305915
> 
> 赞同：4
> 
> 时间：2008-11-20T16:29:00.573
> 
> 标签：c#, winforms, webbrowser-control

我有一个包含 Web 浏览器控件的表单。此浏览器控件将从磁盘加载一些 HTML 并显示它。我希望能够在我的表单中的 HTML 访问 C# 代码中有一个按钮。

例如，HTML 中的按钮可能会调用表单上的 Close() 方法。

目标平台：C# 和 Windows 窗体（任何版本）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-04T06:24:23.597

我过去在一些应用程序中实现了这一点，方法如下：（注意：下面的示例尚未准备好生产，应仅用作指南）。

首先创建一个普通的 .NET 类（公共），其中包含您希望从运行在 Web 浏览器控件中的 Javasvcipt 调用的公共方法。

最重要的是，它必须使用 System.Runtime.InteropServices 命名空间中的 ComVisible(true)] 属性进行修饰（IE 中的 Javascript 是基于 COM 的）。它可以被称为任何东西，我称它为“外部”以使事情更清楚。

```
using System.Runtime.InteropServices;

[ComVisible(true)]
public class External
{
    private static MainWindow m_mainWindow = null;

    public External(MainWindow mainWindow)
    {
        m_mainWindow = mainWindow; 
    }

    public void CloseApplication()
    {
        m_mainWindow.Close();
    }

    public string CurrentDate(string format)
    {
        return DateTime.Now.ToString(format);  
    }
} 
```

接下来在包含 Web 浏览器控件的 .NET 表单中创建 COMVisible 类的实例，然后将 Web 浏览器控件 ObjectForScripting 设置为该实例：

```
 private void MainWindow_Load(object sender, EventArgs e)
    {
         m_external = new External(this);

         browserControl.ObjectForScripting = m_external; 
    } 
```

最后，在 Web 浏览器控件中运行的 Javascript 中，您可以通过 window.external 对象访问 .NET 方法。在这种情况下 window.external 实际上引用（间接通过 COM 互操作包装器）上面创建的“外部”对象：

```
// Javascript code
function CloseButton_Click()
{
    if (window.external)
    {
        window.external.CloseApplication();
    }
} 
```

请注意，从 Javascript 到 .NET 的调用通过 COM 互操作层，因此必须查询默认接口、编组参数等。换句话说，它可能相对较慢，因此如果您计划在循环中进行多次调用，请进行一些性能测试。

另外，为了将来参考，从 .NET 调用 Javascript 代码更简单，只需使用 Document.InvokeScript 方法：

```
 browserControl.Document.InvokeScript("jScriptFunction", new object[] { "param1", 2, "param2" }); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-20T16:43:25.147

查看[WebBrowser.ObjectForScripting](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.objectforscripting.aspx)属性。设法让谷歌地图使用它与 Windows 窗体应用程序对话。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T16:42:24.743

我在 VB6 中做了什么：

*   在 HTML 文档中添加一堆自定义 < A > 标签，将它们的 href 设置为对您有意义的东西，例如 '#closeform'
*   在 BeforeNavigate 方法中，检查浏览器尝试访问的地址并采取相应措施。然后取消浏览器导航。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T16:34:08.130

这是可能的，但我还没有在.NET 中做到这一点。几年前，我有一个托管 Web 浏览器控件 (ActiveX) 的 C++ 应用程序。从控件中的 HTML，可以调用 ActiveX 控件并使其执行操作。

尽管 HTML DOM/JavaScript 不了解 C#，但在 .NET 中应该也是如此。但是，如果您将 .NET 功能包装在 COM 对象中，您应该能够调用 COM/ActiveX 对象上的方法，这些方法又会调用您的 C# 代码。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T16:41:43.700

您所要做的就是为 WebBrowser 的 Navigating 事件添加一个事件处理程序。

在浏览器导航到下一页之前触发此事件。它允许你中断进程并做任何你想做的事情，包括取消导航和调用你的代码。

很容易使用。我遇到的唯一警告是您无法查看 PostData - 请在此处查看我的问题： [PostData Question](https://stackoverflow.com/questions/141626/how-can-i-access-postdata-from-webbrowsernavigating-event-handler "无法访问 PostData")

这是一些示例代码：

```
 private void MyMethod()
    {
        // do something
    }

    private void webBrowser1_Navigating(object sender, WebBrowserNavigatingEventArgs e)
    {
        MyMethod();
        e.Cancel = true;
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-06T21:11:26.010

几年前我这样做了，并在这里写了博客：

[http://matthewskelton.wordpress.com/2007/04/21/calling-javascript-from-c/](http://matthewskelton.wordpress.com/2007/04/21/calling-javascript-from-c/)

具体来说，您可以使用`Type.InvokeMember()`从 C# 调用 JavaScript。

# python - 在 Python 中，如何获取成员函数类的名称？

> ID：305924
> 
> 赞同：19
> 
> 时间：2008-11-20T16:30:30.740
> 
> 标签：python, reflection, metaprogramming

我有一个将另一个函数作为参数的函数。如果函数是类的成员，我需要找到该类的名称。例如

```
def analyser(testFunc):
    print testFunc.__name__, 'belongs to the class, ... 
```

我想

```
testFunc.__class__ 
```

会解决我的问题，但这只是告诉我 testFunc 是一个函数。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2016-12-03T22:12:23.567

从 python 3.3 开始，`.im_class`已经消失了。你可以`.__qualname__`改用。这是相应的 PEP：[https ://www.python.org/dev/peps/pep-3155/](https://www.python.org/dev/peps/pep-3155/)

```
class C:
    def f(): pass
    class D:
        def g(): pass

print(C.__qualname__) # 'C'
print(C.f.__qualname__) # 'C.f'
print(C.D.__qualname__) #'C.D'
print(C.D.g.__qualname__) #'C.D.g' 
```

使用嵌套函数：

```
def f():
    def g():
        pass
    return g

f.__qualname__  # 'f'
f().__qualname__  # 'f.<locals>.g' 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-20T16:42:42.697

```
testFunc.im_class 
```

[https://docs.python.org/reference/datamodel.html#the-standard-type-hierarchy](https://docs.python.org/reference/datamodel.html#the-standard-type-hierarchy)

> `im_class`是`im_self`绑定方法的类或请求未绑定方法的方法的类

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-20T16:35:16.287

我不是 Python 专家，但这行得通吗？

```
testFunc.__self__.__class__ 
```

它似乎适用于绑定方法，但在您的情况下，您可能正在使用未绑定的方法，在这种情况下，这可能会更好：

```
testFunc.__objclass__ 
```

这是我使用的测试：

```
Python 2.5.2 (r252:60911, Jul 31 2008, 17:31:22) 
[GCC 4.2.3 (Ubuntu 4.2.3-2ubuntu7)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import hashlib
>>> hd = hashlib.md5().hexdigest
>>> hd
<built-in method hexdigest of _hashlib.HASH object at 0x7f9492d96960>
>>> hd.__self__.__class__
<type '_hashlib.HASH'>
>>> hd2 = hd.__self__.__class__.hexdigest
>>> hd2
<method 'hexdigest' of '_hashlib.HASH' objects>
>>> hd2.__objclass__
<type '_hashlib.HASH'> 
```

哦，是的，还有一件事：

```
>>> hd.im_class
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'builtin_function_or_method' object has no attribute 'im_class'
>>> hd2.im_class
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'method_descriptor' object has no attribute 'im_class' 
```

因此，如果您想要防弹的东西，它也应该可以`__objclass__`处理`__self__`。但是您的里程可能会有所不同。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-20T16:53:50.180

实例方法将具有属性 .im_class .im_func .im_self

[http://docs.python.org/library/inspect.html#types-and-members](http://docs.python.org/library/inspect.html#types-and-members)

您可能想查看函数是否具有 .im_class，并从那里获取类信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-02T21:12:18.667

请使用以下函数获取类中的方法名称

```
def getLocalMethods(clss):
import types
# This is a helper function for the test function below.
# It returns a sorted list of the names of the methods
# defined in a class. It's okay if you don't fully understand it!
result = [ ]
for var in clss.__dict__:
    val = clss.__dict__[var]
    if (isinstance(val, types.FunctionType)):
        result.append(var)
return sorted(result) 
```

# c# - 如何使控件透明地覆盖 DirectShow 视频？

> ID：305929
> 
> 赞同：0
> 
> 时间：2008-11-20T16:31:27.853
> 
> 标签：c#, .net, directshow

我有一个控件 VideoControl，它使用 DirectShow 显示视频 - 它被设置为 IVideoWindow 的所有者。我有另一个控件，AreaControl，它应该在视频控件上显示一个虚线矩形。使用 SetStyle(ControlStyles.SupportsTransparentBackColor, true) 将 AreaControl 设置为透明。如果我将 AreaControl 放在任何其他控件上，它会按预期工作，在其后面的控件上显示一个虚线矩形。但是，当我将虚线矩形控件放在视频控件上时，AreaControl 会被 VideoControl 的 BackColor 填充。

我需要做什么才能通过 AreaControl 显示视频，并在其上覆盖虚线矩形？有没有办法让 VideoControl 用视频绘制自己，而不仅仅是绘制它的 BackColor？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T14:03:33.650

据我所知，没有办法做，你想直接做什么。问题是，一个控件的透明样式的实现。具有此样式属性的控件基本上只是绘制，它背后的东西使它看起来透明。（实际上它根本不是真正透明的）。

我想到的唯一解决方案是使用窗口（窗体）并将控件放入其中。可以通过将其 Opacity 属性设置为小于 1.0 的值来使窗体透明。值 0.0 将完全透明（阅读：不可见）。虚线边框应该是全黑的。不透明度为 fe 0.4，它将显示为灰色。

或者，您可能对表单的 TransparencyKey 属性有一些运气。将此设置为白色可能会产生预期的效果，但我还没有测试过这个。

在任何一种情况下，表格都应该是完全无边界的。当视频表单移动时，您可能需要添加一些代码来重新定位表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T11:03:15.183

最后，这个问题的答案是使用 AreaControl 的 Region 属性，因为我们不需要部分透明度。

# c# - Winforms - 如何创建自定义窗口边框和关闭/最小化按钮？

> ID：305937
> 
> 赞同：2
> 
> 时间：2008-11-20T16:33:04.760
> 
> 标签：c#, windows, winforms, ownerdrawn

我希望能够创建一个黑色自定义窗口（带有边框和控件），就像作为表达式混合、Twirl 或 Adob​​e Lightroom 的一部分提供的那样。

如何创建所有者绘制的窗口？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-20T17:09:12.007

如果自定义 chrome 工具不能为您提供您想要的外观，这种事情很容易在 C# 中自己完成。基本上，您创建一个无边框表单 (FormBorderStyle = None)，然后自己创建所有控件和边框，方法是将控件放置在您需要的位置（标题栏的标签、关闭和最小化的命令按钮等）和/或绘图使用 Graphics 对象直接在表单的表面上。

您还必须实现代码以允许通过其“假”标题栏拖动表单（有关如何执行此操作的示例，请参见此[答案）。](https://stackoverflow.com/questions/302680/custom-dialog-with-a-text-field-in-winmobile#305732)您可能还必须实现自己的调整大小机制（如果您需要调整表单大小）。

最后，虽然自定义表单代码可能有点笨拙，但您可以在单个表单上实现它，然后让应用程序中的所有其他表单继承此表单，这使其成为自定义整个皮肤的非常有用的技术应用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T11:44:34.143

我的任务是让活动窗口比其他应用程序的非活动窗口更引人注目、更明亮。应用程序有许多打开的窗口，一些模式，一些无模式 - 和 MDI 父窗口。

您可以使用非边框之类的东西 - 客户区域内的框架。这是代码片段，是基类的一部分（可以直接在表单中使用）：

```
 #region Кастомизированное поведение - рамки, активность и т.д.
    private bool isCurrentlyActive = false;
    private bool childControlsAreHandled = false;
    private Pen activeWindowFramePen, inactiveWindowFramePen;
    private Point[] framePoints;

    private void AddControlPaintHandler(Control ctrl)
    {
        ctrl.Paint += DrawWindowFrame;
        if (ctrl.Controls != null)
        {
            foreach (Control childControl in ctrl.Controls)
            {
                AddControlPaintHandler(childControl);
            }
        }
    }

    protected override void OnActivated(EventArgs e)
    {
        base.OnActivated(e);
        if ((this.childControlsAreHandled == false)
            && (WindowFrameType != Forms.WindowFrameType.NoFrame)
            && (this.MdiParent == null))
        {
            RecalculateWindowFramePoints();
            AddControlPaintHandler(this);
            this.childControlsAreHandled = true;
        }

        this.isCurrentlyActive = true;
        if (InactiveWindowOpacity < 1)
        {
            base.Opacity = 1;
        }
        base.Invalidate(true);
    }

    protected override void OnDeactivate(EventArgs e)
    {
        base.OnDeactivate(e);
        this.isCurrentlyActive = false;
        if (InactiveWindowOpacity < 1)
        {
            base.Opacity = InactiveWindowOpacity;
        }
        base.Invalidate(true);
    }

    protected override void OnResizeEnd(EventArgs e)
    {
        base.OnResizeEnd(e);
        this.framePoints = null;
        RecalculateWindowFramePoints();
        this.Invalidate(true);
    }

    private Pen ActivePen
    {
        get
        {
            if (this.isCurrentlyActive)
            {
                if (this.activeWindowFramePen == null)
                {
                    this.activeWindowFramePen = new Pen(Color.FromArgb((int)(WindowFrameOpacity*255), WindowFrameActiveColor), WindowFrameSize * 2);
                }
                return this.activeWindowFramePen;
            }
            else
            {
                if (this.inactiveWindowFramePen == null)
                {
                    this.inactiveWindowFramePen = new Pen(Color.FromArgb((int)(WindowFrameOpacity*255), WindowFrameInactiveColor), WindowFrameSize * 2);
                }
                return this.inactiveWindowFramePen;
            }
        }
    }

    private Point[] RecalculateWindowFramePoints()
    {
        if ((WindowFrameType == Forms.WindowFrameType.AllSides)
            && (this.framePoints != null)
            && (this.framePoints.Length != 5))
        {
            this.framePoints = null;
        }
        if ((WindowFrameType == Forms.WindowFrameType.LeftLine)
            && (this.framePoints != null)
            && (this.framePoints.Length != 2))
        {
            this.framePoints = null;
        }
        if (this.framePoints == null)
        {
            switch (WindowFrameType)
            {
                case Forms.WindowFrameType.AllSides:
                    this.framePoints = new Point[5]
                    {
                        new Point(this.ClientRectangle.X, this.ClientRectangle.Y),
                        new Point(this.ClientRectangle.X + this.ClientRectangle.Width, this.ClientRectangle.Y),
                        new Point(this.ClientRectangle.X + this.ClientRectangle.Width, this.ClientRectangle.Y + this.ClientRectangle.Height),
                        new Point(this.ClientRectangle.X, this.ClientRectangle.Y + this.ClientRectangle.Height),
                        new Point(this.ClientRectangle.X, this.ClientRectangle.Y)
                    };
                    break;
                case Forms.WindowFrameType.LeftLine:
                    this.framePoints = new Point[2]
                    {
                        new Point(this.ClientRectangle.X, this.ClientRectangle.Y),
                        new Point(this.ClientRectangle.X, this.ClientRectangle.Y + this.ClientRectangle.Height)
                    };
                    break;
            }
        }
        return this.framePoints;
    }

    private void DrawWindowFrame(object sender, PaintEventArgs e)
    {
        if (WindowFrameType == Forms.WindowFrameType.NoFrame)
        {
            return;
        }
        if ((this.framePoints == null) || (this.framePoints.Length == 0))
        {
            return;
        }
        Control ctrl = (Control)(sender);
        // пересчитаем точки в координатах контрола.
        List<Point> pts = new List<Point>();
        foreach (var p in this.framePoints)
        {
            pts.Add(ctrl.PointToClient(this.PointToScreen(p)));
        }
        e.Graphics.DrawLines(ActivePen, pts.ToArray());
    }

    public static int WindowFrameSize = 2;
    public static WindowFrameType WindowFrameType = Forms.WindowFrameType.NoFrame;
    public static Color WindowFrameActiveColor = Color.YellowGreen;
    public static Color WindowFrameInactiveColor = SystemColors.ControlDark;
    public static double InactiveWindowOpacity = 1.0;
    public static double WindowFrameOpacity = 0.3;
    #endregion 
```

类的静态字段从应用程序设置表单（类）初始化 - 因此，应用程序中的所有表单具有相同的行为。

希望对某人有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T16:34:54.227

[WinForms 应用程序中的自定义标题栏/镶边](https://stackoverflow.com/questions/42460/custom-titlebarschrome-in-a-winforms-app)

# c# - 使用 SharpDevelop 进行本地化

> ID：305946
> 
> 赞同：1
> 
> 时间：2008-11-20T16:34:58.470
> 
> 标签：c#, localization, sharpdevelop

我正在开发一个在 SharpDevelop 中开发的本地化应用程序。根据[教程](http://www.devhood.com/tutorials/tutorial_details.aspx?tutorial_id=211)，我遇到了一个错误：

> 在磁盘上找不到适合指定区域性（或中性区域性）的任何资源。基地名称：

我使用 Project | 创建了资源文件 添加 | 新项目各自的“空资源文件”（我找不到“程序集资源文件”）。此外，我将“构建操作”设置为“EmbeddedResource”。

在程序中，我有一个执行以下操作的类

```
// load the resource file once
resourceManager = ResourceManager.CreateFileBasedResourceManager(file, filePath, null);

// depending on user selection, I set the CultureInfo in the code behind the form, i.e.
Thread.CurrentThread.CurrentUICulture = locales[0];   // which contains "en"

// and that's the method of the same class used to lookup the values
public string getValue ( string key )
{
    return resourceManager.GetString(key);
} 
```

SharpDevelop 3.0.0.3437 .NET 版本 2.0.50727.3053

即使仔细浏览了评论并在谷歌上搜索了很长时间，我也找不到示例或解决方案。因此，问题：

*   如何将文化添加到资源文件本身？
*   你能提供一个例子或链接吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T17:39:09.463

CreateFileBasedResourceManager 将只处理二进制 .resources 文件（不是 .resx 文件）。

如果您坚持从外部文件加载资源而不是将资源嵌入到程序集中，则需要运行 resgen 命令行实用程序来生成 .resources 文件。因此，如果您还没有这样做，请为每种支持的文化生成一个。

否则看起来没问题。

但是，如果您希望将资源嵌入到程序集中，请在属性窗口中，将 Build Action 设置为 Embedded Resource。

如果您还希望生成一个处理所有脏活的强类型类，请将*基本文件*上的自定义工具（不变的）设置为 ResXFileCodeGenerator，如果需要，则将其设置为 PublicResXFileCodeGenerator（在创建附属程序集时很好）。

然后你就不需要自己加载本地化的资源了。生成的类会为您完成所有这些工作。

对于资源中的每个键，在生成的类中都会生成一个静态属性，您只需调用此属性，它非常干净，也是迄今为止最简单的方法。

除非有特殊原因从 .resources 文件加载资源，否则我总是建议将它们嵌入到 (an) 程序集中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T16:46:17.777

我不确定您使用的是哪个版本的 .NET，但这篇关于[运行时如何定位程序集的](http://msdn.microsoft.com/en-us/library/yx7xezcf.aspx)MSDN 文章可能对您有用。

# email - ASP 表单收件人错误

> ID：305967
> 
> 赞同：1
> 
> 时间：2008-11-20T16:40:46.743
> 
> 标签：email, asp-classic, vbscript

我有一个表格，填写并提交后，效果很好。但是，当收件人回复发件人时，电子邮件实际上是发给他而不是预期的一方。

下面是表格。帮助！

```
<%
Dim roomsanswer, fashionsanswer, commentsanswer, nameanswer, addressanswer, citystateanswer, zipanswer, phoneanswer, phone2answer, emailanswer, bccaddress, toaddress
If Request.Form("SendButton") <> "Send" Then
%>  
    <form action="<%=Request.ServerVariables("URL")%>" method="post" id="contactform">
      <h2>I am thinking about the windows in these rooms: (Please check as many answers as you like)</h2>
      <p>
        <input type="checkbox" name="rooms" value="living Room" />
        Living Room
        <input type="checkbox" name="rooms2" value="Dining Room" />
        Dining Room
        <input type="checkbox" name="rooms2" value="Family Room" />
        Family Room
        <input type="checkbox" name="rooms2" value="Bonus or Recreation Room" />
        Bonus or Recreation Room </p>
      <p>
        <input type="checkbox" name="rooms2" value="Kitchen and/or Bathrooms" />
        Kitchen and/or Bathrooms
        <input type="checkbox" name="rooms2" value="Bedroom(s) " />
        Bedroom(s)</p>
      <h3>&nbsp;</h3>
      <h2>I am most interested in these window fashions:</h2>
      <p>
        <input type="checkbox" name="fashions" value="Blinds" />
        Blinds
        <input type="checkbox" name="fashions" value="Shades" />
        Shades
        <input type="checkbox" name="fashions" value="Shutters" />
        Shutters
        <input type="checkbox" name="fashions" value="Window Shadings" />
        Window Shadings (Silhouette, etc.)
        <input type="checkbox" name="fashions" value="Draperies &amp; Top Treatments" />
      Draperies &amp; Top Treatments 
      <input type="checkbox" name="fashions" value="Decorative Hardware &amp; Controls" />
      Decorative Hardware &amp; Controls
      <input type="checkbox" name="fashions" value="Sun &amp; Light Control Products" />
      Sun &amp; Light Control Products</p>
      <p>&nbsp;</p>
      <h2>Here's what I'd like to do, or talk with the decorator about:&nbsp;<br />
          <textarea name="comments" cols="47" rows="9" wrap="physical" id="comments"></textarea>
      </h2>
      <p><strong>My Name:</strong>&nbsp;
          <input type="text" name="name" size="45" maxlength="50" />
      </p>
      <p><strong>My Address:</strong>&nbsp;
          <input name="address" type="text" id="address" size="45" maxlength="50" />
      </p>
      <p><strong>My City &amp; State:</strong>&nbsp;
          <input name="citystate" type="text" id="citystate" size="45" maxlength="50" />
      </p>
      <p><strong>My Zipcode:</strong>&nbsp;
          <input name="zip" type="text" id="zip" size="10" maxlength="5" />
      </p>
      <h2>&nbsp;</h2>
      <h2>My Telephones </h2>
      <p><strong>Daytime Telephone:</strong>&nbsp;
          <input type="text" name="phone" size="12" maxlength="15" />
      </p>
      <p><strong>Evening Telephone:</strong>&nbsp;
          <input type="text" name="phone2" size="12" maxlength="15" />
      </p>
      <p><strong>Email address:</strong>&nbsp;
          <input type="text" name="email" size="45" maxlength="50" />
      </p>
      <p><br />
          <input type="submit" value="Send" name="SendButton" />
        &nbsp;
        <input type="reset" value="Clear" name="ClearButton" class="form" />
      </p>
    </form>
<%

'*** If the SendButton was clicked
'*** and there is a message to send,
'*** process the email and send it.
Else

'*** Create the message object.
Set Message = Server.CreateObject("CDO.Message")

'*** Validate Input
commentsanswer = Request.Form("comments")
If commentsanswer = "" then
commentsanswer = "(No Additional Comments Given)"
End If

roomsanswer = Request.Form("rooms")
If roomsanswer = "" then
roomsanswer = "(No Rooms Given)"
End If

fashionsanswer = Request.Form("fashions")
If fashionsanswer = "" then
fashionsanswer = "(No Fashions Given)"
End If

nameanswer = Request.Form("name")
If nameanswer = "" then
nameanswer = "(No name given)"
End If

addressanswer = Request.Form("address")
If addressanswer = "" then
addressanswer = "(No address given)"
End If

citystateanswer = Request.Form("citystate")
If citystateanswer = "" then
citystateanswer = "(No city and state given)"
End If

zipanswer = Request.Form("zip")
If zipanswer = "" then
zipanswer = "(No zipcode given)"
End If

phoneanswer = Request.Form("phone")
If phoneanswer = "" then
phoneanswer = "(No phone number given)"
End If

phone2answer = Request.Form("phone2")
If phone2answer = "" then
phone2answer = "(No phone number given)"
End If

emailanswer = Request.Form("email")
If emailanswer <> "" then
toaddress = Request.Form("email")
bccaddress = "xxxxxx@aol.com"
End If

If emailanswer = "" then
emailanswer = "(No email address given)"
toaddress = "xxxxxx@aol.com"
bccaddress = ""
End If

'*** Set the from, to, and
'*** subject fields.

Message.From = "xxxxxx@aol.com"
Message.To = toaddress
Message.bcc = bccaddress & "," & ""
Message.Subject = "Customer Contact Information from Website"
Message.TextBody = vbcrlf & "Date and Time: " & Now() & vbcrlf & vbcrlf & " I am thinking about the windows in these rooms: " & roomsanswer & vbcrlf & vbcrlf & "I am most interested in these window fashions: " & fashionsanswer & vbcrlf & vbcrlf & "Here's what I'd like to do, or talk with the decorator about: " & commentsanswer & vbcrlf & vbcrlf & " My Name:" & vbcrlf & nameanswer & vbcrlf & vbcrlf & "My Address:" & vbcrlf & addressanswer & vbcrlf & vbcrlf & "My City & State:" & vbcrlf & citystateanswer & vbcrlf & vbcrlf & "My Zipcode:" & vbcrlf & zipanswer & vbcrlf & vbcrlf & "My Daytime Phone:" & vbcrlf & phoneanswer & vbcrlf & vbcrlf & "My Evening Phone:" & vbcrlf & phone2answer

'*** If there is an error, 
'*** continue with the script.
On Error Resume Next

'*** Send the email message.
Message.Send

'*** If sending the message caused
'*** an error, then display the 
'*** message, else display a
'*** success message (or redirect
'*** to a different page).
If Err.Number = 0 Then
Response.Redirect("thankyou.html")
Else
Response.Write "Error: " & Err.Description
End If

'*** Clear out the message variable
Set Message = Nothing

'*** End of If for checking
'*** SendButton and message
'*** to send.
End If

%> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T16:53:00.960

这是你想要的[http://support.microsoft.com/kb/181408吗？](http://support.microsoft.com/kb/181408)

# php - 您应该什么时候开始使用 Memcached？

> ID：305973
> 
> 赞同：7
> 
> 时间：2008-11-20T16:41:40.860
> 
> 标签：php, caching, memcached

我开始学习将 Memcached 与 PHP 一起使用，我想知道；您是否应该开始使用它？缓存数据总是更有效，还是只有在您的网站获得一定数量的点击后才会生效？大概有与 Memcached 相关的开销，那么速度优势何时超过此？

提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-20T16:45:42.380

当不使用 memcached 开始影响您的站点/服务器时，您应该开始使用它。

因此，当您每天只有 100 位访问者并且您的网站仍能快速响应时，请不要费心使用它。

但是，当您每页的运行时间接近 200 毫秒或更多时，并且网站感觉也很慢时，您应该使用一些 PHP 分析器（XDebug 集成了一个可以与 WinCacheGrind 或 KCacheGrind 结合使用的分析器）来寻找瓶颈。特别是缓存数据库请求应该可以节省一些加载时间。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-20T19:15:35.837

性能优化的第一条规则是：在需要之前不要优化！

如果你没有性能问题，那么你不需要优化。其他好的规则包括：

*   在完成应用程序编写之前不要进行优化。您很少知道在开发过程中会在哪里出现现实世界的性能问题，并且只会让您的代码更加草率，并且在您需要进行更改时更难修改。

*   使用分析器或其他测量特定代码块的方法来实际测量需要很长时间的内容，并优化这些部分。不要只是猜测什么需要很长时间。实际测量一下。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-20T20:17:00.863

如果您使用 MySQL 作为数据库，请在高峰时间在 MySQL 控制台上运行 show processlist 命令。如果有许多来自 PHP 端的查询等待超过 500 毫秒，那么是时候使用 memcached。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T11:38:43.267

在考虑是否应该使用 Memcached 进行缓存之前，首先考虑要缓存的**内容/时间/是否。**

当您有一些“对象”用于响应需要**大量**数据库读取来创建的**大量请求时。**由于重新创建该“对象”，您的网站无法跟上其负载。您还需要为正在缓存的项目提供一个定义良好的良好键。

 **您正在缓存的“对象”必须被更频繁地读取，然后用于创建它的数据库行被更改，否则缓存的好处可能会减少在更改一些数据后管理缓存的成本。

缓存单个数据库行不会给您带来匹配的好处。

# .net-3.5 - 有没有办法免点击安装 .NET 3.5 SP1？

> ID：305976
> 
> 赞同：0
> 
> 时间：2008-11-20T16:42:05.787
> 
> 标签：.net-3.5, installation

基本上我想让我们的安装程序也安装 .NET 框架和任何其他必要的先决条件将最小化用户交互，所以理想情况下，只需运行，接受许可协议，其他一切都会自动处理。这可能吗？最有可能使用引导程序或某种形式的 WiX。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T16:57:30.657

尝试在安装程序中使用 /quiet 或 /passive 开关。

# .net - 实体框架的多个后端

> ID：305985
> 
> 赞同：4
> 
> 时间：2008-11-20T16:43:45.550
> 
> 标签：.net, entity-framework

我可以为 .net 实体框架项目使用两个不同的后端吗？

如果可用，我需要支持 SQL 服务器上存储过程的完整可编程性支持。当 SQL Server 不可用时，我只需要支持 .mdb 文件中的表结构。

实体框架之上的所有业务逻辑都使用实体抽象，而不是直接进入数据库。实体模型可以使用存储过程调用或动态 sql 来读取/写入数据库表。

是否可以创建两个逻辑相同的实体模型，每个模型与数据库的映射不同（一个由框架管理，一个由存储过程管理），并在运行时根据后端存储机制提供的功能在它们之间切换?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T19:23:59.627

你应该看到[这个类似的 SO question](https://stackoverflow.com/questions/75959/how-to-implement-database-independence-with-entity-framework)。我不确定您是否可以在运行时执行此操作，但我发现在部署后这是可能的。当心，肯定有陷阱。

不同数据库后端之间生成的 EDMX 文件之间的主要区别是 MSL 和 SSDL。我所做的是从每个数据库中分别生成 EDMX 文件。它们都具有相同的逻辑数据模型 (CSDL)。然后我提取 MSL 和 SSDL 文件并将其保存到单独的文件中。完成后，您可以在连接字符串中指定这些文件的确切位置（如图所示）：

```
<add name="DBConnection" connectionString="metadata=C:\sqlServerEntities.csdl|C:\sqlServerEntities.ssdl|C:\sqlServerEntities.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=[machinename];Initial Catalog=[databasename];Persist Security Info=True;User ID=[user];Password=[password];MultipleActiveResultSets=True&quot;" providerName="System.Data.EntityClient" />

<add name="DBConnection" connectionString="metadata=C:\mdbEntities.csdl|C:\mdbEntities.ssdl|C:\mdbEntities.msl;provider=[mdb provider namespace];provider connection string=[DB connection string]" providerName="System.Data.EntityClient" /> 
```

您必须根据要连接的数据库在运行时使用适当的连接字符串。我担心您可能难以在一种情况下使用存储过程，而在另一种情况下使用基于表的映射。

另一个注意事项：您不能将两个 EDMX 模型都保留在项目中，否则您将创建编译器错误（基于重复的类定义）。但是，您必须在项目中保留一个，以便编译器知道生成的逻辑类。

# asp.net-mvc - MVC 设计模式/架构模式可以用于桌面应用程序开发吗？

> ID：305988
> 
> 赞同：4
> 
> 时间：2008-11-20T16:44:39.653
> 
> 标签：asp.net-mvc, winforms, model-view-controller, desktop-application

我刚刚了解了 ASP.NET MVC 是什么，我想知道这种模式是否曾经用于 Windows 桌面应用程序开发？

我特别关注可能尝试在桌面 .NET 应用程序中使用它。

如果就假设如何使用 MVC 而言，这个问题在左侧领域中存在问题，请原谅我。我仍然在努力思考它的细节。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-20T16:47:54.140

[模型-视图-控制器](http://en.wikipedia.org/wiki/Model-view-controller)模式就像“桌面”应用程序的梦想一样工作，因为您不必担心处理状态信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-20T16:47:10.257

明确地。这是[MVC GUI 框架](http://en.wikipedia.org/wiki/Model-view-controller#Implementations_of_MVC_as_GUI_frameworks)的列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T16:54:20.007

MVC 有多种形式，Marting Fowler 在[http://martinfowler.com/eaaDev/uiArchs.html讨论](http://martinfowler.com/eaaDev/uiArchs.html)

谷歌还为[windows 窗体 mvc](http://www.google.com/search?q=windows+forms+mvc)返回了很多有趣的东西

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T17:50:09.597

我不记得在哪里看到了用于桌面应用程序的 MVC 的一个很好的例子。
大约是一个温度计。
该模型是它自己的温度计。具有当前温度状态的简单 POJO。
这些应用程序具有温度计的多个视图和控制器。
控制器调用setter，视图调用getter。
要同步应用程序，请使用观察者模式。视图订阅模型。
并且模型通知每个 setter 中订阅的所有视图。

这是理解 MVC 的一个非常有用的例子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-21T22:02:52.943

**对于其他可能感兴趣的人：**

[http://dotnetslackers.com/articles/aspnet/BuildingModelViewPresenterAapplicationsWithMVCFramework.aspx](http://dotnetslackers.com/articles/aspnet/BuildingModelViewPresenterAapplicationsWithMVCFramework.aspx)

[http://www.mvcsharp.org/Getting_started_with_MVCSharp/Default.aspx](http://www.mvcsharp.org/Getting_started_with_MVCSharp/Default.aspx)

# reporting-services - SSRS 2005 异常未公开

> ID：305989
> 
> 赞同：0
> 
> 时间：2008-11-20T16:44:47.890
> 
> 标签：reporting-services, reportviewer, reportingservices-2005

我们正在使用 SSRS 2005 SP1 和最新的 Reportviewer 控件。
我们遇到某些报告基础设施异常没有暴露于任何异常处理例程的情况。

一个具体示例是 SQL Server Reporting Services Windows 服务由于 VM 问题而意外停止。在这种情况下，报表正确呈现，但当在报表查看器 Web 控件中显示给用户时，用户会看到以下消息而不是报表：

```
An error has occurred during report processing. 

The Report Server Windows service 'ReportServer$MSSQL2005' is not
running. The service must be running to use Report Server. 
```

问题是我们在所有可能的位置捕获异常：所有页面后面的方法、 ReportViewer`OnReportError`和应用`OnError`程序处理程序。我们在任何时候都没有看到客户端代码出现异常。在调试器中运行，异常在执行期间被抛出，但不会永远引发到消费者客户端代码。

有没有人见过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T15:58:04.160

感谢您的回复鲍勃。SSRS 正在吃掉这些例外，这令人惊讶和失望。我们可能会远离破解 dll，并尝试找出一种方法来监视和从 SSRS 内部日志发出警报。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-23T05:28:58.313

我在 Reporting Services 2008 中看到了类似的情况，我试图捕获某些类型的异常。[也没有人回答我的问题。](https://stackoverflow.com/questions/188373/custom-error-pages-in-reporting-services-2008)

然而，我在提出这个问题后学到的东西可能对你有帮助。我去使用反射器并在某些 DLL 周围戳了一下。我搜索了我看到的特定字符串，发现 Reporting Services 似乎捕获了它自己的异常并且只是将字符串抛出，所以除了破解 DLL 本身之外，你对这类问题无能为力。除了您必须删除强名称验证并使其完全无法维护之外，这还有效。

# regex - 正则表达式中的点是危险的

> ID：305991
> 
> 赞同：2
> 
> 时间：2008-11-20T16:45:21.117
> 
> 标签：regex

我的印象是 Dot '.' （通配符）字符使用起来很危险。我的恐惧是没有根据的吗？谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-20T16:48:38.117

这并不危险，只要你明白它的意思。它通常会匹配输入文本的任何字符。根据正则表达式的风格，它可能匹配也可能不匹配行尾字符。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-20T16:47:46.447

钠是危险的，但它是生命所必需的。Dot 就像任何其他工具一样，只有你做的那么危险。如果没有它，我不想尝试编写 99% 的正则表达式。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-20T16:59:32.477

我看到的唯一棘手的部分是“。” 是在匹配多行字符串时：使用错误的选项，它可以匹配比需要的更多，并且它可以引入 bacjtracking 问题（由于非贪婪匹配）。

从[正则表达式教程](http://www.regular-expressions.info/dot.html)

点匹配单个字符，而不关心该字符是什么。唯一的例外是换行符。

在大多数正则表达式风格中，点默认情况下不会匹配换行符。因此，默认情况下，点是否定字符类 [^\n]（UNIX 正则表达式）或 [^\r\n]（Windows 正则表达式）的缩写。

这种例外的存在主要是由于历史原因。第一个使用正则表达式的工具是基于行的。他们将逐行读取文件，并将正则表达式分别应用于每一行。效果是使用这些工具，字符串永远不会包含换行符，因此点永远不会匹配它们。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-21T10:56:42.240

[VonC](https://stackoverflow.com/questions/305991/is-dot-in-regex-dangerous#306047) beated me to pointing out [my article](http://www.regular-expressions.info/dot.html). The section "use the dot sparingly" answers your question.

The problem isn't with the dot. The problem is with people using it in situations where it isn't appropriate.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-20T17:01:56.903

我不会说“危险”，至少一般来说不会。然而：

*   .* 应尽可能避免，因为它会在尝试找到最佳匹配时通过大量回溯来破坏正则表达式的性能，并且如果在输入中多次出现它之后的令牌，您可能不会得到你想要的匹配，因为它正在寻找最长的匹配。.*? 有助于解决回溯问题并消除“匹配太长”的问题，但不使用 . 总之往往更有效。

*   因为 。可以匹配任何东西（通常除了行尾），它可能匹配你不想要/不期望的东西。在具有安全意识的环境中，这可能很危险。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-20T17:34:01.423

不要忘记您可以经常使用`[^x]*`来代替`.*?x`. 如果需要，后者可以消耗 x 来完成匹配，但前者不能。这 。如果您的正则表达式被允许匹配多行字符串，则更可能是危险的。能够代表换行符。`.*`无论如何，你真的应该只在使用or时才关心它`.*?`，尽管在很多情况下你会想要它。 `.{0,10}`等不太容易导致您的正则表达式开始运行异常缓慢。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-20T20:52:15.987

点本身并不危险，但人们确实倾向于过度依赖它。事实上，不久前我突然想到，提高你的正则表达式技能的一个好方法是停止使用点——或者至少，尝试尽可能少地使用它。这将迫使您考虑正则表达式匹配的工作原理，并探索您从未学习过的其他更高级的功能。

与许多其他工具一样，很容易陷入中等水平的 regex-fu 并且永远无法真正掌握它们。这让我觉得这是一个让自己越过那个驼峰的好方法。请注意，我并不是说您永远不应该再使用该点。在您了解正则表达式还提供什么的同时，让它休息几个月。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-20T17:15:42.337

这取决于使用情况。`.*`例如，在搜索文件时非常有用。如果你有这样的正则表达式可能会很糟糕：

```
.*<one>.*<two>.*<three>.*</three>.*</two>.*</one>.* 
```

由于其他人所说的原因，取决于这些括号之间的内容，这可能会导致很多回溯并且非常慢。

# asp.net - jQuery 自动完成和 ASP.NET

> ID：305994
> 
> 赞同：50
> 
> 时间：2008-11-20T16:46:01.257
> 
> 标签：asp.net, jquery, subsonic, autocomplete

我在整个网站和网络上搜索了一个使用 jQuery 和 ASP.NET 的自动完成的**简单**示例。我想通过 web 服务公开自动完成使用的数据（接下来可能会这样做）。与此同时，我得到了这个工作，但它似乎有点hacky......

在我的页面中，我有一个文本框：

```
<input id="txtSearch" type="text" /> 
```

我正在使用 jQuery 自动完成功能，按照他们的示例进行设置：

```
<link rel="stylesheet" href="js/jquery.autocomplete.css" type="text/css" />
<script type="text/javascript" src="js/jquery.bgiframe.js"></script>
<script type="text/javascript" src="js/jquery.dimensions.pack.js"></script>
<script type="text/javascript" src="js/jquery.autocomplete.js"></script> 
```

这是它开始变得棘手的地方......我调用一个页面而不是一个网络服务：

```
 <script type="text/javascript">
    $(document).ready(function(){
        $("#txtSearch").autocomplete('autocompletetagdata.aspx');
    });      
  </script> 
```

在页面中，我删除了所有的 html，只保留了这个（否则，自动完成下拉菜单中会显示各种 HTML 位）：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="autocompletetagdata.aspx.cs" Inherits="autocompletetagdata" %> 
```

在我的 autocompletetagdata.aspx 中，我使用 SubSonic 从数据库中查询、格式化和返回数据（每行一个数据项）：

```
protected void Page_Load(object sender, EventArgs e)
{
    // Note the query strings passed by jquery autocomplete:
    //QueryString: {q=a&limit=150&timestamp=1227198175320}

    LookupTagCollection tags = Select.AllColumnsFrom<LookupTag>()
        .Top(Request.QueryString["limit"])
        .Where(LookupTag.Columns.TagDescription).Like(Request.QueryString["q"] + "%")
        .OrderAsc(LookupTag.Columns.TagDescription)
        .ExecuteAsCollection<LookupTagCollection>();

    StringBuilder sb = new StringBuilder();

    foreach (LookupTag tag in tags)
    {
        sb.Append(tag.TagDescription).Append("\n");
    }

    Response.Write(sb.ToString());
} 
```

如果您不执行 LIKE 查询，则它会返回包含与您键入的字符匹配的所有内容——例如，键入“a”将包括“Ask”和“Answer”以及“March”和“超级大。” 我只是想让它从比赛开始。

无论如何，它可以工作并且很容易设置，但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-20T16:56:57.270

我最近刚刚实现了自动完成功能，它看起来非常相似。我使用的是 ashx（通用处理程序）而不是 aspx，但它与后面的代码中的代码基本相同。

使用 ashx，它看起来像这样：

```
<script type="text/javascript">
  $(document).ready(function(){
      $("#txtSearch").autocomplete('autocompletetagdata.ashx');
  });      
</script>

[WebService(Namespace = "http://www.yoursite.com/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
public class AutocompleteTagData : IHttpHandler
{
    public void ProcessRequest(HttpContext context)
    {
        // Note the query strings passed by jquery autocomplete:
        //QueryString: {q=a&limit=150&timestamp=1227198175320}

        LookupTagCollection tags = Select.AllColumnsFrom<LookupTag>()
            .Top(context.Request.QueryString["limit"])
            .Where(LookupTag.Columns.TagDescription).Like(context.Request.QueryString["q"] + "%")
            .OrderAsc(LookupTag.Columns.TagDescription)
            .ExecuteAsCollection<LookupTagCollection>();

        foreach (LookupTag tag in tags)
        {
            context.Response.Write(tag.TagDescription + Environment.NewLine);
        }
    }

    public bool IsReusable
    {
        get
        {
            return false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-27T19:03:26.983

我刚刚在另一个问题上发布了这个，但是您可以覆盖 jQuery 自动完成插件上的解析函数以使其支持任何输出。

例子：

```
 $("#<%= TextBox1.ClientID %>").autocomplete("/Demo/WebSvc.asmx/SuggestCustomers", {
        parse: function(data) {
            var parsed = [];

            $(data).find("string").each(function() {
                parsed[parsed.length] = {
                    data: [$(this).text()],
                    value: $(this).text(),
                    result: [$(this).text()]
                };
            });
            return parsed;
        },
        dataType: "xml"
    }); 
```

所有这一切都需要一个字符串数组到 XML... 很容易做到... 如果您使用 SubSonic，您应该查看 RESTHandler（它是一个隐藏的 GEM ！！！），它支持对所有对象的基本查询，并且可以返回 JSON/XML。这是使用它的示例查询...

/Demo/services/Customers/list.xml?CustomerName=JOHN

如果将 list.xml 更改为 list.json，它会将结果更改为 JSON。上面的请求将返回一个强类型的“客户”实体。您可以更改参数以支持 LIKE、NOT LIKE 等......非常强大，所有管道都已经完成......

这是一个视频： [http ://subsonicproject.com/tips-and-tricks/webcast-using-subsonic-s-rest-handler/](http://subsonicproject.com/tips-and-tricks/webcast-using-subsonic-s-rest-handler/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-20T17:09:07.327

Web 服务或 WCF 服务将为您提供更好的界面。两者也可以设置为进行 Json 序列化。

由于我在写作时正在学习 WCF 课程（我真的在休息！），我将画出 WCF 方法的草图。

```
[OperationContract]
[WebInvoke(RequestFormat=WebMessageFormat.Json,
           ResponseFormat=WebMessageFormat.Json)]
public LookupTagCollection LookupTags( int limit, string q )
{
     return Select.AllColumnsFrom<LookupTag>()
                  .Top(limit)
                  .Where(LookupTag.Columns.TagDescription)
                  .Like(q+ "%")
                  .OrderAs(LookupTag.Columns.TagDescription)
                  .ExecuteAsCollection<LookupTagCollection>();    
} 
```

LookupTagCollection 需要可序列化。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-01-10T02:35:47.590

Jquery 1.8 Autocomplete 使用“term”而不是“q”作为查询字符串参数。这是我实现的简短而甜蜜的版本。希望这可以帮助某人。

Javascript：

```
$(function () {
    $("#autocomplete").autocomplete({
        source: "/pathtohandler/handler.ashx",
        minLength: 1,
        select: function (event, ui) {
            $(this).val(ui.item.value);
        }
    });
}); 
```

ASHX 处理程序：

```
public class SearchHandler : IHttpHandler
{
    public void ProcessRequest(HttpContext context)
    {
        var term = context.Request.QueryString["term"].ToString();

        context.Response.Clear();
        context.Response.ContentType = "application/json";

        var search = //TODO implement select logic based on the term above

        JavaScriptSerializer jsSerializer = new JavaScriptSerializer();
        string json = jsSerializer.Serialize(search);
        context.Response.Write(json);
        context.Response.End();
    }

    public bool IsReusable
    {
        get
        {
            return false;
        }
    }
} 
```********************