# StackOverflow 问答 000242000-000242999

# c# - 如何在我的列表中形成一个好的谓词委托来查找（）某些东西 ?

> ID：242012
> 
> 赞同：25
> 
> 时间：2008-10-28T01:57:29.683
> 
> 标签：c#, list, delegates, find, predicate

在查看 MSDN 之后，我仍然不清楚我应该如何使用 T 的成员变量（其中 T 是一个类）在 List 中使用 Find() 方法形成一个正确的谓词

例如：

```
public class Car
{
   public string Make;
   public string Model;
   public int Year;
}

{  // somewhere in my code
   List<Car> carList = new List<Car>();
   // ... code to add Cars ...

   Car myCar = new Car();

   // Find the first of each car made between 1980 and 2000
   for (int x = 1980; x < 2000; x++)
   {
       myCar = carList.Find(byYear(x));
       Console.Writeline(myCar.Make + myCar.Model);
   }
} 
```

我的“byYear”谓词应该是什么样的？

（MSDN 示例只讨论恐龙列表，只搜索不变的值“saurus”——它没有显示如何将值传递到谓词中......）

编辑：我正在使用 VS2005/.NET2.0，所以我认为 Lambda 符号对我不可用......

EDIT2：在示例中删除了“1999”，因为我可能想根据不同的值以编程方式“查找”。示例更改为使用 for-do 循环从 1980 年到 2000 年的汽车范围。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-28T02:09:11.950

您可以按如下方式使用 lambda 表达式：

```
myCar = carList.Find(car => car.Year == 1999); 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-10-28T02:15:32.827

好的，在 .NET 2.0 中，您可以使用委托，如下所示：

```
static Predicate<Car> ByYear(int year)
{
    return delegate(Car car)
    {
        return car.Year == year;
    };
}

static void Main(string[] args)
{
    // yeah, this bit is C# 3.0, but ignore it - it's just setting up the list.
    List<Car> list = new List<Car>
    {
        new Car { Year = 1940 },
        new Car { Year = 1965 },
        new Car { Year = 1973 },
        new Car { Year = 1999 }
    };
    var car99 = list.Find(ByYear(1999));
    var car65 = list.Find(ByYear(1965));

    Console.WriteLine(car99.Year);
    Console.WriteLine(car65.Year);
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-28T02:28:38.963

或者您可以使用匿名委托：

```
Car myCar = cars.Find(delegate(Car c) { return c.Year == x; });

// If not found myCar will be null
if (myCar != null)
{
     Console.Writeline(myCar.Make + myCar.Model);
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-28T04:57:36.730

由于您不能使用 lambda，您可以将其替换为匿名委托。

```
myCar = carList.Find(delegate(Car car) { return car.Year == i; }); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-28T02:06:18.790

唔。仔细考虑一下，您可以使用柯里化来返回谓词。

```
Func<int, Predicate<Car>> byYear = i => (c => c.Year == i); 
```

现在您可以将此函数的结果（它是一个谓词）传递给您的 Find 方法：

```
my99Car = cars.Find(byYear(1999));
my65Car = cars.Find(byYear(1965)); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-07T13:48:49.450

你也可以使用这个：

```
var existData =
    cars.Find(
     c => c.Year== 1999); 
```

# oracle - 使用 nHibernate 映射 Oracle 布尔字段

> ID：242016
> 
> 赞同：4
> 
> 时间：2008-10-28T02:03:03.260
> 
> 标签：oracle, nhibernate, mapping

我有一个 Oracle 数据库，布尔字段是 CHAR(1)，存储了 Y/N。如何使用 nHibernate 将其映射到布尔类型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T02:05:11.867

在字段的休眠属性定义中设置 type="YesNo"。

有关详细信息，请参阅[本文档](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/mapping.html)中的表 5.3，该表将 .NET 类型映射到 DB 类型。

# nhibernate - nHibernate 映射到自定义类型

> ID：242022
> 
> 赞同：13
> 
> 时间：2008-10-28T02:07:53.903
> 
> 标签：nhibernate, mapping

我有一个 Oracle 数据库，其中一个字段是日期范围字段。它基本上只是作为 VARCHAR(40) 以 YYYY/MM/DD-YYYY/MM/DD 格式存储在数据库中。我想在 nHibernate 中将它映射到我这样创建的自定义类

```
public class DateTimeRange
{
    public DateTimeRange(DateTime fromTime, DateTime toTime)
    {
        FromTime = fromTime;
        ToTime = toTime;
    }

    public override string ToString()
    {
        return String.Format("{0} to {1}", FromTime.ToString("HH:mm:ss"), ToTime.ToString("HH:mm:ss"));
    }

    public DateTime FromTime { get; set; }

    public DateTime ToTime { get; set; }
} 
```

如何映射到这样的自定义类？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-28T02:28:15.937

您需要实现自己的 IUserType。

有关详细信息，请参阅此[博客文章](http://blogs.msdn.com/howard_dierking/archive/2007/04/23/nhibernate-custom-mapping-types.aspx)。如果博客消失，我还将粘贴下面的相关部分。

在 NHibernate 中，自定义映射类型是派生自 IUserType 或 ICompositeUserType 接口的类。这些接口包含几个必须实现的方法，但为了我们这里的目的，我们将重点关注其中的两个。考虑以下。

```
 public class TypeClassUserType : IUserType
  {

    object IUserType.NullSafeGet(IDataReader rs, 
      string[] names, 
     object owner) {

     string name = NHibernateUtil.String.NullSafeGet(rs, 
     names[0]) as string;

     TypeClassFactory factory = new TypeClassFactory();
     TypeClass typeobj = factory.GetTypeClass(name);
     return typeobj;
   }

    void IUserType.NullSafeSet(IDbCommand cmd, 
    object value, 
     int index) {

      string name = ((TypeClass)value).Name;
     NHibernateUtil.String.NullSafeSet(cmd, name, index);
    }
  } 
```

创建了这个类后，我现在可以将 ActualClass 和 TypeClass 之间的关联显式映射为 ActualClass 映射上的一个简单属性。

```
<property
  name="Type"
  column="TypeName"
  type="Samples.NHibernate.DataAccess.TypeClassUserType, 
        Samples.NHibernate.DataAccess" /> 
```

由于 NHibernate 正在保存一个 ActualType 的实例，它会加载并创建一个新的 TypeClassUserType 实例并调用 NullSafeSet 方法。从方法体中可以看出，我只是从映射属性中提取名称（作为 value 参数传入）并将提取的名称设置为要在数据库中设置的参数的值。最终结果是，尽管 ActualClass 的 Type 属性是域模型中的 TypeClass，但只有 TypeClass 对象的 Name 属性被存储在数据库中。反之亦然。当 NHibernate 从数据库加载 ActualType 的实例并找到我的自定义映射类型的属性时，它会加载我的自定义类型并调用 NullSafeGet 方法。如您所见，我的方法从返回的数据中获取名称，调用我的享元工厂以获取正确的 TypeClass 实例，然后实际返回该实例。类型解析过程对我的数据访问类是透明的（甚至对 NHibernate 本身也是如此）。

# java - Eclipse 插件如何访问项目目录？

> ID：242032
> 
> 赞同：7
> 
> 时间：2008-10-28T02:13:48.573
> 
> 标签：java, eclipse, plugins, workspace

有没有办法在 Eclipse 中获取项目的目录？我们正在编写一个插件，允许用户选择文件，然后在这些文件上运行一些进程。理想情况下，我希望能够获取具有特定扩展名的所有文件，但这不是必需的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-28T02:40:58.940

当然：

```
ResourcesPlugin.getWorkspace().getRoot().getProjects() 
```

将为您提供工作区中所有项目的列表。您可以轻松地迭代以找到您想要的那个。此时，您可以通过扩展名等查找某些文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T12:02:18.633

如果您想让您的用户能够选择具有特定扩展名的 eclipse 工作区中的文件，您可以查看**org.eclipse.ui.dialogs.ElementTreeSelectionDialog**类（org.eclipse.ui.dialogs 插件）作为开始。

然后，要举例说明如何使其过滤扩展，您可以查看**org.eclipse.jdt.internal.ui.viewsupport.FilteredElementTreeSelectionDialog**类（org.eclipse.jdt.ui 插件）以了解它们是如何做到的然后重新实现这些东西。

与手动将文件扔到项目中并重新实现对话框相比，这应该为您提供更高级别的操作。

# python - OpenGL 与 Python

> ID：242059
> 
> 赞同：15
> 
> 时间：2008-10-28T02:29:24.920
> 
> 标签：python, opengl, fedora

我目前正在学习使用 OpenGL 的课程，到目前为止，我一直在使用 C 语言编写所有程序。我在 Fedora 和 OpenGL 上安装了 Python，但是在我的 Python 代码中调用 OpenGL 命令的那一刻，我得到了一个**分段错误**。我不知道为什么会这样。

只是为了避免“只使用 C”注释，这就是我想使用 Python 的原因：

我想从 C 切换到 Python 有几个原因，但主要是因为我们即将开始编写光线追踪器，我想使用类来让我更轻松。因为我讨厌 C++ 中的类，而 C 中的结构似乎有点疯狂，所以我想我会尝试一下 Python。我也一直在寻找再次使用 Python 的理由，因为它已经有一段时间了。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-29T13:58:22.847

您可能还想考虑使用[Pyglet](http://www.pyglet.org/)而不是 PyOpenGL。它是本地平台上原生 OpenGL 库的 ctypes-wrapper，以及窗口支持（应该处理您想要使用 GLUT 的大部分内容。）[pyglet-users](http://groups.google.com/group/pyglet-users)列表非常活跃且非常有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-22T13:16:15.637

好吧，我不知道这些是否是原始海报使用的库，但我在使用 PyOpenGL 的宠物项目（使用 C++ 和 Python 的图形引擎）中看到了相同的问题。

如果 PyOpenGL 是在加载 python 脚本之后创建的（我先加载脚本，然后从我的 C++ 代码中调用其中的 Python 方法），则 PyOpenGL 没有正确获取渲染上下文。

如果您在加载 Python 脚本之前初始化显示并创建 OpenGL 渲染上下文，则不会出现此问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T02:34:02.010

您使用的是什么 OpenGL 库？什么窗口库？什么版本的 Python？

我能想到的最可能的原因是您的窗口库（SDL 或您正在使用的任何东西）在您开始调用它之前没有初始化 OpenGL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T06:12:11.633

我们对随机分段错误都没有想法。没有足够的信息。你为opengl使用了哪些python库？你如何使用它们？你能告诉我们你的代码吗？这可能是微不足道的事情，但我的上帝技能最终只能告诉我。

python中的光线追踪器？我更喜欢在 C 中使用这些结构来执行此操作。但是，我假设你不打算做一个实时光线追踪器，所以这可能没问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-29T14:06:59.663

也许您正在调用一个需要活动 OpenGL 上下文的 OpenGL 函数，而没有一个？这不一定会崩溃，但我想它可能会崩溃。如何设置这样的上下文取决于平台，自从我使用 Python 中的 GL 以来已经有一段时间了（当我这样做时，我还使用了 GTK+，这使事情变得复杂）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-17T21:14:47.140

脚本永远不会导致分段错误。但首先看看你的内核和 kmod 视频驱动程序是否工作属性......扩展模块可能会导致“分段错误”。

# python - Python + Leopard + Fink + Mac Ports + Python.org + Idiot = broken Python - fresh start?

> ID：242065
> 
> 赞同：2
> 
> 时间：2008-10-28T02:34:19.140
> 
> 标签：python, python-2.6, python-install

I have been enjoying learning the basics of python, but before I started reading things I tried to install various python versions and modules clumsily. Now that I have some ideas of what I want to do and how to do it I'm finding that various aspects are broken. For instance, 2.6 IDLE won't launch, and when I try to import modules they usually don't work.

My question is, how would you recommend I clean this up and start fresh? I have read information about modifying the 2.6 install, but I still can't get it to work.

IDLE 2.4 works, and when I launch python from the terminal I am running python 2.4.4.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T03:28:57.907

I had this problem so much when I first got my Mac. The best solution I found was to delete everything I'd installed and just go with the [pythonmac.org](http://pythonmac.org) version of Python (2.6). I then installed setuptools from the same site, and then used easy_install to install every other package.

Oh, and I got the GNU C Compiler from the Xcode developer tools CD (which you can download from Apple's website), so that I can compile C extensions.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T00:08:53.457

Macports 应该很容易摆脱；只需删除 /opt/local/。我认为芬克做了类似的事情。

您可以`which python`查看默认的python是什么。系统python应该在/System/Library/Frameworks/Python.framework/Versions/2.5/bin/python

您可能已经下载的 MacPython 位于 /Library/Frameworks/Python.framework 中。您也可以删除它。

此外，MacPython 和 MacPorts 都会编辑您的 ~/.profile 并更改 PYTHONPATH，确保对其进行编辑并删除那里的额外路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-13T06:24:42.223

重新开始使用 Mac Ports 或 Fink 的最简单方法是简单地删除文件夹`/sw/`（对于 fink）或`/opt/`对于 MacPorts。

要完全删除它们，您必须删除`~/.profile`文件中的一行：

对于芬克：

```
test -r /sw/bin/init.sh && . /sw/bin/init.sh 
```

..对于 MacPorts，我目前没有安装它，但会有一些类似的东西：

```
export PATH=$PATH:/opt/local/bin
export PATH=$PATH:/opt/local/sbin 
```

* * *

至于安装 Python，目前最干净的方法是从源代码构建它。

我在[这里](http://neverfear.org/blog/view/Installing_Python_2_6_3_0_without_breaking_stuff/)写了我是如何在 Leopard 上安装 Python 2.6 的。它是针对 2.6 beta 版本之一的，所以将`curl -O`行更改为最新版本！

简而言之，下载并解压缩最新的[python 2.6 源代码 tarball](http://python.org/ftp/python/2.6/Python-2.6.tgz)，然后（在终端中）`cd`到您解压缩 tarball 的位置，并运行以下命令。

```
./configure --prefix=/usr/local/python2.6
make
sudo make install 
```

这会将python2.6安装到`/usr/local/python2.6/`（最后一行需要sudo，所以会询问你的密码）

最后添加`/usr/local/python2.6`到 $PATH，通过在文件中添加以下行`~/.profile`

```
export PATH=$PATH:/usr/local/python2.6 
```

然后，您将能够运行该`python2.6`命令。

理想情况下，您只需安装[MacPython](http://wiki.python.org/moin/MacPython/Leopard)，但它似乎还没有像样的 Python 2.6 安装程序。

# html - 如何通过搜索和替换验证大量文件？

> ID：242066
> 
> 赞同：4
> 
> 时间：2008-10-28T02:35:35.847
> 
> 标签：html, perl, unix, omittag

我目前正在验证客户的 HTML 源代码，并且我收到很多没有 Omittag 的图像和输入文件的验证错误。我会手动完成，但这个客户端实际上有数千个文件，其中很多实例不是 .

这个客户已经验证了一些 img 标签（无论出于何种原因）。

只是想知道是否有一个 unix 命令我可以运行来检查是否没有 Omittag 来添加它。

我已经完成了简单的搜索并用以下命令替换：

```
find . \! -path '*.svn*' -type f -exec sed -i -n '1h;1!H;${;g;s/<b>/<strong>/g;p}' {} \; 
```

但从来没有这么大的东西。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T06:15:29.520

试试这个。它将遍历您的文件，`.orig`对每个文件（perl 的运算符）进行备份，并用and`-i`替换`<img>`and`<input>`标记。`<img />``<input >`

```
find . \! -path '*.svn*' -type f -exec perl -pi.orig -e 's{ ( <(?:img|input)\b ([^>]*?) ) \ ?/?> }{$1\ />}sgxi' {} \; 
```

给定输入：

```
<img>  <img/>  <img src="..">  <img src="" >
<input>  <input/>  <input id="..">  <input id="" > 
```

它将文件更改为：

```
<img />  <img />  <img src=".." />  <img src="" />
<input />  <input />  <input id=".." />  <input id="" /> 
```

这是正则表达式正在做的事情：

```
s{(<(?:img|input)\b ([^>]*?)) # capture "<img" or "<input" followed by non-">" chars
  \ ?/?>}                     # optional space, optional slash, followed by ">"
{$1\ />}sgxi                  # replace with: captured text, plus " />" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T06:16:18.847

请参阅我在顶部评论中提出的问题。

假设您使用的是 GNU sed，并且您正在尝试**将**尾随添加`/`到您的标签以使 XML 兼容`<img />`and `<input />`，然后用这个替换命令中的 sed 表达式，它应该可以解决问题：`'1h;1!H;${;g;s/\(img\|input\)\( [^>]*[^/]\)>/\1\2\/>/g;p;}'`

这是一个简单的测试文件（SO的着色器做古怪的事情）：

```
$ cat test.html
This is an <img tag> without closing slash.
Here is an <img tag /> with closing slash.
This is an <input tag > without closing slash.
And here one <input attrib="1" 
    > that spans multiple lines.
Finally one <input
  attrib="1" /> with closing slash.

$ sed -n '1h;1!H;${;g;s/\(img\|input\)\( [^>]*[^/]\)>/\1\2\/>/g;p;}' test.html
This is an <img tag/> without closing slash.
Here is an <img tag /> with closing slash.
This is an <input tag /> without closing slash.
And here one <input attrib="1" 
    /> that spans multiple lines.
Finally one <input
  attrib="1" /> with closing slash. 
```

这是[GNU sed 正则表达式语法](http://www.gnu.org/software/sed/manual/sed.html#Regular-Expressions)以及[缓冲如何进行多行搜索/替换](http://www.ilfilosofo.com/blog/2008/04/26/sed-multi-line-search-and-replace/)。

或者，您可以使用类似[Tidy](http://tidy.sourceforge.net/)之类的东西，它是为清理不良 HTML 而设计的——如果我做的事情比几个简单的搜索/替换更复杂，我就会这样做。Tidy 的选项很快就会变得复杂，因此通常最好用您选择的脚本语言（Python、Perl）编写一个脚本来调用`libtidy`和设置您需要的任何选项。

# javascript - 在浏览器中修改 XML 文档

> ID：242069
> 
> 赞同：1
> 
> 时间：2008-10-28T02:39:18.333
> 
> 标签：javascript, xml

是否可以在没有任何服务器端代理（例如 php 或 asp 脚本）的情况下将数据修改/写入 XML 文件？这可以通过javascript完成吗？XSLT？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T03:17:28.053

您可以在浏览器中加载和修改 xml，但写回文件是另一回事。

如果没有某种服务器端机制将数据写入磁盘，我不知道有任何可行的方法将数据写回服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T03:17:58.910

使用 XMLHTTPRequest 对象，您可以使用 XSLT 修改 XML 文档。这是入门的[示例文章。](http://aspalliance.com/1067_Creating_a_Menu_Using_XSLT_XML_and_JavaScript)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-10-28T02:43:51.023

是的，有可能。您可以使用纯 javascript 或使用[jquery之类的库来完成](http://jquery.com/)

# sql - MySQL -- mark all but 1 matching row

> ID：242073
> 
> 赞同：2
> 
> 时间：2008-10-28T02:40:20.017
> 
> 标签：sql, mysql

This is similar to [this question](https://stackoverflow.com/questions/18932/sql-how-can-i-remove-duplicate-rows), but it seems like some of the answers there aren't quite compatible with MySQL (or I'm not doing it right), and I'm having a heck of a time figuring out the changes I need. Apparently my SQL is rustier than I thought it was. I'm also looking to change a column value rather than delete, but I think at least **that** part is simple...

I have a table like:

```
rowid SERIAL
fingerprint TEXT
duplicate BOOLEAN
contents TEXT
created_date DATETIME
```

I want to set duplicate=true for all but the first (by created_date) of each group by fingerprint. It's easy to mark *all* of the rows with duplicate fingerprints as dupes. The part I'm getting stuck on is keeping the first.

One of the apps that populates the table does bulk loads of data, with multiple workers loading data from different sources, and the workers' data isn't necessarily partitioned by date, so it's a pain to try to mark these all as they come in (the first one inserted isn't necessarily the first one by date). Also, I already have a bunch of data in there I'll need to clean up either way. So I'd rather just have a relatively efficient query I can run after a bulk load to clean up than try to build it into that app.

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T20:47:41.117

MySQL needs to be explicitly told if the data you are grouping by is larger than 1024 bytes (see [this link](http://dev.mysql.com/doc/refman/5.1/en/blob.html) for details). So if your data in the fingerprint column is larger than 1024 bytes you should use set the `max_sort_length` variable (see [this link](http://dev.mysql.com/doc/refman/5.1/en/server-system-variables.html#sysvar_max_sort_length) for details about values allowed, and [this link](http://dev.mysql.com/doc/refman/5.0/en/set-option.html) about how to set it) to a larger number so that the group by wont silently use only part of your data for grouping.

Once you're certain that MySQL will group your data properly, the following query will set the duplicate flag so that the first fingerprint record has duplicate set to FALSE/0 and any subsequent fingerprint records have duplicate set to TRUE/1:

```
 UPDATE mytable m1
INNER JOIN (SELECT fingerprint
                 , MIN(rowid) AS minrow 
              FROM mytable m2 
          GROUP BY fingerprint) m3 
        ON m1.fingerprint = m3.fingerprint
       SET m1.duplicate = m3.minrow != m1.rowid; 
```

Please keep in mind that this solution does not take NULLs into account and if it is possible for the fingerprint field to be NULL then you would need additional logic to handle that case.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T05:43:26.513

这是一个有趣的方法：

```
SET @rowid := 0;

UPDATE mytable
SET duplicate = (rowid = @rowid), 
    rowid = (@rowid:=rowid)
ORDER BY rowid, created_date; 
```

*   首先将用户变量设置为零，假设它小于表中的任何 rowid。
*   然后使用 MySQL`UPDATE...ORDER BY`功能确保行按顺序更新`rowid`，然后按`created_date`.
*   对于每一行，如果当前`rowid`不等于用户变量`@rowid`，则设置`duplicate`为 0（假）。只有在遇到给定值的第一行时才会如此`rowid`。
*   然后将一个虚拟集合添加`rowid`到它自己的值，设置`@rowid`为该值作为副作用。
*   作为您`UPDATE`的下一行，如果它是上一行的副本，`rowid`将等于用户变量`@rowid`，因此`duplicate`将设置为 1（真）。

**编辑：**现在我已经对此进行了测试，并纠正了设置行中的一个错误`duplicate`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T02:55:22.640

How about a two-step approach, assuming you can go offline during a data load:

*   Mark every item as duplicate.
*   Select the earliest row from each group, and clear the duplicate flag.

Not elegant, but gets the job done.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T06:22:12.207

我不知道 MySQL 语法，但在 PLSQL 中你只需要：

```
UPDATE t1
SET duplicate = 1
FROM MyTable t1
WHERE rowid != (
  SELECT TOP 1 rowid FROM MyTable t2
  WHERE t2.fingerprint = t1.fingerprint ORDER BY created_date DESC
) 
```

这可能有一些语法错误，因为我只是在袖口打字/无法测试它，但这就是它的要点。

* * *

MySQL 版本（未测试）：

```
UPDATE t1
  SET duplicate = 1
FROM MyTable t1
WHERE rowid != (
  SELECT rowid FROM MyTable t2
  WHERE t2.fingerprint = t1.fingerprint
  ORDER BY created_date DESC
  LIMIT 1
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T18:23:59.733

这是另一种方法，使用 MySQL 的多表`UPDATE`语法：

```
UPDATE mytable m1
  JOIN mytable m2 ON (m1.rowid = m2.rowid AND m1.created_date < m2.created_date)
SET m2.duplicate = 1; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T01:06:04.713

未经测试...

```
UPDATE TheAnonymousTable
   SET duplicate = TRUE
 WHERE rowid NOT IN
       (SELECT rowid
          FROM (SELECT MIN(created_date) AS created_date, fingerprint
                  FROM TheAnonymousTable
                 GROUP BY fingerprint
               ) AS M,
               TheAnonymousTable AS T
         WHERE M.created_date = T.created_date
           AND M.fingerprint  = T.fingerprint
       ); 
```

逻辑是最里面的查询返回`created_date`每个不同指纹的最早的作为表别名 M。中间的查询确定每一行的 rowid 值；必须这样做（但必要）很麻烦，并且代码假定您不会获得相同指纹和时间戳的两条记录。这为您提供了每个单独指纹的最早记录的 rowid。然后外部查询（UPDATE）在所有那些 rowid 不是最早行之一的行上设置“重复”标志。

一些 DBMS 可能对正在更新的表上执行（嵌套）子查询不满意。

# ruby-on-rails - 为什么 Searchgasm 页面链接不起作用？

> ID：242076
> 
> 赞同：1
> 
> 时间：2008-10-28T02:41:16.177
> 
> 标签：ruby-on-rails, ruby, plugins

我正在使用 Searchgasm 插件进行搜索和分页。一切似乎都很好，但页面链接似乎根本不起作用。以前有人在 Searchgasm 上遇到过这个问题吗？

控制器代码：

```
class ArtistsController < ApplicationController
  # GET /artists
  # GET /artists.xml
  def index
    @search = Artist.new_search
    @search.per_page = 10
    @search.page = 2

    @artists = @search.all

    respond_to do |format|
      format.html # index.html.erb
      format.xml  { render :xml => @artists }
    end
  end
end 
```

查看代码：

```
<h1>Listing artists</h1>

<table>
  <tr>
    <th><%= :name %></th>
  </tr>

<% for artist in @artists %>
  <tr>
    <td><%= link_to artist.name, artist %></td>
    <td><%= link_to 'Edit', edit_artist_path(artist) %></td>
    <td><%= link_to 'Destroy', artist, :confirm => 'Are you sure?', :method => :delete %></td>
  </tr>
<% end %>
</table>

<br />

Per page: <%= per_page_select %>
<br />
<br />
<% if @search.page_count > 1 %>
    <div class="pages"><%= page_links :spread => 1 %></div>
<% end %>

<%= link_to 'New artist', new_artist_path %> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T17:49:23.910

控制器应该是：

```
class ArtistsController < ApplicationController
  # GET /artists
  # GET /artists.xml
  def index
    @search = Artist.new_search(params[:search])
    @artists = @search.all

    respond_to do |format|
      format.html # index.html.erb
      format.xml  { render :xml => @artists }
    end
  end
end 
```

该行：

```
@search = Artist.new_search(params[:search]) 
```

从页面链接中获取参数单击以执行搜索。

# java - Java 中是否有可扩展的对象引用列表？

> ID：242079
> 
> 赞同：1
> 
> 时间：2008-10-28T02:43:10.683
> 
> 标签：java, arrays, object-reference

在 Java 中，我们总是可以使用数组来存储对象引用。然后我们有一个 ArrayList 或 HashTable 可以自动扩展来存储对象。但是有谁知道拥有一个可自动扩展的对象引用数组的原生方式？

编辑：我的意思是我想知道 Java API 是否有一些类能够存储对对象的引用（但不存储像 XXXList 或 HashTable 这样的实际对象）以及自动扩展的能力。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T02:49:43.773

根据定义，Java 数组是固定大小的。如果您需要自动增长，请使用 XXXList 类。

编辑 - 问题已经澄清了一点

当我第一次开始学习 Java（来自 C 和 C++ 背景）时，这可能是最先让我绊倒的事情之一。希望我能有所启发。

与 C++ 不同，Java 中的对象数组*不*存储对象。它们存储对象引用。

在 C++ 中，如果您声明类似以下内容：

```
String myStrings[10]; 
```

你会得到 10 个 String 对象。此时，执行类似 println(myStrings[5].length); 之类的操作是完全合法的。- 你会得到 '0' - String 的默认构造函数会创建一个长度为 0 的空字符串。

在 Java 中，当你构造一个新数组时，你会得到一个可以容纳 10 个字符串引用的空容器。所以调用：

```
String[] myStrings = new String[10];
println(myStringsp[5].length); 
```

会抛出空指针异常，因为您实际上还没有将 String 引用放入数组中。

如果您来自 C++ 背景，请将 new String[10] 视为等同于 C++ 中的 new (String *)[10]。

因此，考虑到这一点，应该很清楚为什么 ArrayList*是*自动扩展对象数组的解决方案（事实上，ArrayList 是使用简单数组实现的，内置增长算法，可以根据需要分配新的扩展数组，并且将旧内容复制到新内容）。

在实践中，实际上我们使用数组的情况相对较少。如果您正在编写一个容器（类似于 ArrayList 或 BTree），那么它们很有用，或者如果您正在执行大量低级字节操作 - 但在大多数开发发生的级别上，使用 Collections 类之一是目前首选的技术。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T07:19:44.243

所有实现 Collection 的类都是可扩展的并且只存储引用：你不存储对象，你在一些数据空间中创建它们并且只操作对它们的引用，直到它们超出范围而不引用它们。

您可以将一个对象的引用放在两个或多个集合中。这就是您可以对哈希表进行排序的方式......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T02:54:16.090

“本地”方式是什么意思？如果你想要一个可扩展的 f 对象列表，那么你可以使用 ArrayList。使用 List 集合，您可以使用 get(index) 方法，该方法允许您通过索引访问列表中的对象，这为您提供了与数组类似的功能。在内部，ArrayList 是用一个数组实现的，ArrayList 会自动为您处理扩展它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T03:08:55.700

直接来自sun 网页上的[Array Java 教程：](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/arrays.html)

-> 数组是一个容器对象，它包含***固定***数量的单一类型的值。

因为数组的大小是在创建的时候就声明的，所以后面其实是没办法扩展的。声明一个特定大小的数组的全部目的是只分配程序执行时可能使用的内存。您*可以*做的是声明第二个数组，它是一个基于原始大小的函数，将所有原始元素复制到其中，然后添加必要的新元素（尽管这不是很“自动”:)） . 否则，正如您和其他一些人所提到的，列表集合是最有效的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T10:43:40.993

在 Java 中，所有对象变量都是引用。所以

```
Foo myFoo = new Foo();
Foo anotherFoo = myFoo; 
```

意味着两个变量都引用同一个对象，而不是两个单独的副本。同样，当您将对象放入 a`Collection`时，您只是存储对该对象的引用。因此使用`ArrayList`或类似方法是拥有自动扩展存储的正确方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T02:46:03.670

我知道没有一流的语言结构可以做到这一点，如果那是您正在寻找的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-28T03:04:03.760

它不是很有效，但如果你只是追加到一个数组，你可以使用[Apache Commons ArrayUtils.add()](http://tinyurl.com/5jvhod)。它返回原始数组的副本，其中包含附加元素。

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2008-10-28T02:48:27.567

如果您可以用 javascript 编写代码，是的，您可以这样做。javascript数组是稀疏数组。它将以您想要的任何方式扩展。

你可以写

一[0] = 4;
一个[1000] = 434;
a[888] = "一个字符串";

# asp.net-mvc - Get MultiView like behavior with ASP.NET MVC

> ID：242080
> 
> 赞同：1
> 
> 时间：2008-10-28T02:43:18.467
> 
> 标签：asp.net-mvc, ajax

I am trying to build a generic form submission system using ASP.NET MVC. I'd like to make it as easy as possible to create forms with a form view and a "success" view. Using the WebForms method, this was easy and could be accomplished with templates or multiviews. With MVC, I'm a bit stuck.

Here's what I'd like to emulate:

```
<% if (formNotSubmitted) { %>
    <% Html.BeginForm(...); %>
        <%= Html.TextBox("FirstName") %>
        <%= Html.TextBox("LastName") %>
        <input id='submit' type='submit' value='Submit' />
        <%= Html.ValidationSummary %>
    <% Html.EndForm(); %>
<% } else { %>
    <p>Thank you!</p>
    <p><img src='thanks.jpg' /></p>
    <p>Other items here maybe.</p>
<% } %> 
```

Ideally, I'd like to use Ajax, but also have it work with a straight POST. I'd also like to wrap this somehow to avoid the "if..else" code. What makes this harder than a typical ASP.NET MVC Ajax form is that the controller won't know what the success message/content is supposed to be. Most demos I've seen have the controller send back a message, but I need that code in the view.

Any guidance is appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T04:53:22.243

你可以用控制器

```
[AcceptVerbs("GET")]
public ActionResult Signup( )
{
    // somecode that builds an html string
        ViewData["form"] = htmlStringYouBuilt;
}

[AcceptVerbs("POST")]
public ActionResult Login( string username, string password )
{
     // etc
}

then in the view
<%= ViewData["form"] %> 
```

我已经能够成功地使用这种技术。

# ruby - 为什么 Ruby 的项目似乎比其他编程语言少？

> ID：242094
> 
> 赞同：3
> 
> 时间：2008-10-28T02:50:18.687
> 
> 标签：ruby, programming-languages

我发现 Ruby 非常有吸引力。我喜欢一切都是对象的事实，它的语法非常吸引人。

我希望它今年能大受欢迎，但我没有看到 Ruby 有很多活动。

例如，如果我们计算在 SO 中添加的标签数量，则只有大约 700 个问题被标记为“ruby”。这可能是因为：

1.  Ruby 如此简单，没有人有任何疑问。
2.  这个站点从 .Net 社区吸引了更多的人，而 Ruby 开发人员忽略了它的存在。
3.  Ruby 项目没有其他编程语言的项目那么多。

其他资源显示 Ruby 不像其他编程语言那样流行。

您认为这背后的原因是什么？

链接：

[2008 年 10 月 TIOBE 编程社区指数](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)

[StackOverflow 标签](https://stackoverflow.com/tags)

[哦哦](http://www.ohloh.net/)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-28T03:36:08.843

您错误地将某些东西归因于 Ruby。[仅RubyForge](http://rubyforge.org/)就报告了 1,000 多个开源项目，更不用说所有现有的 Ruby on Rails 应用程序，以及托管在 Github、Sourceforge 和其他地方的项目。

除非您在其他网站上花费大量时间（Reddit 是一个很好的例子），否则您将不知道以 .NET/Oracle/SQL Server/等为中心的 Stack Overflow 是如何的。（我使用 Greasemonkey 插件来隐藏大量这些以 Windows 和“企业”为中心的技术，因为我不感兴趣。）

实际上，我对您有互补的体验：我开始在 Stack Overflow 上花费时间，当我意识到有多少人每天都在使用 ASP.NET 时，我有点“哇”的感觉。那不是我在其中度过的任何时间的世界，所以我低估了它的规模。

互联网的某些部分（例如 Reddit）主要关注自由软件及其相关语言：Perl、Python、Ruby、PHP。

某些部分（例如[Lambda the Ultimate](http://lambda-the-ultimate.org/)）与更深奥的语言有关：Haskell、Lisp、Joy、Coq。

其他部分（例如 Stack Overflow）更为主流：Java、.NET。

您无法通过仅对这些“池”中的一个进行抽样来得出任何关于语言流行度的结论。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T03:03:58.690

Ruby 在 2005 年至 2006 年大放异彩，当时 Rails 在社区中大行其道，而 Apple 决定将其与 OS X 打包在一起。因此，选择 2008 年作为 Ruby 大受欢迎的一年似乎有点不对劲我。

正如您所说，Ruby 语言本身非常有吸引力。它的语法和 OOP 模型使其受到开发人员的欢迎。你得到的产品与使用另一种语言时所得到的产品模棱两可，但感觉在内部结构上浪费的时间更少。

Rails 确实是我认为现在使 Ruby 成为主流的原因，或多或少是因为它的易用性和数据库处理能力。Web 开发人员因此而喜欢它。

如果你真的想看到有很多 Ruby(on Rails) 的网站，你可以查看[http://refactormycode.com](http://refactormycode.com)或[http://pastie.org](http://pastie.org)。这些网站是建立在 RoR 之上的，并且经常被 Ruby（on Rails）用户使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-28T12:18:41.223

不管有多少实数，我确实知道一件事：当我为我正在研究的东西寻找一个 Ruby 库时，90% 以上的时间我都能找到令人满意的东西。对于剩下的 10% 中的一些人来说，自己写东西并不难。我相信未来几年这个数字也会上升 90%。

如果我得到了我需要的东西，我真的不在乎 PHP、Python 或 C# 是否有 60 亿个应用程序和为它们编写的库。:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-31T17:20:17.910

我发现 Ruby 在几个方面都非常有吸引力，但它也存在一些阻碍它的问题。

我认为最大的一点是 Python 已经涵盖了很多相同的领域，拥有更大的项目库，并且性能更好。

我遇到的另一个主要问题也是让它如此受欢迎的原因：Rails。我认为有很多人甚至不认为 Ruby 是一门独立的语言。虽然我很欣赏 Rails 应该非常棒，但它不是我处理的任何事情，因此我很恼火，因为我不得不费力地对 Rails 进行如此多的讨论，才能在 Ruby 作为独立语言中找到问题的答案。

最后一件让我感到不安的事情是它与 Perl 共享的“不止一种方法”的理念。我不喜欢那个。

这实际上是他们已经成为一些锤子的问题，而目前大多数人吹捧的 Ruby 的主要区别特征是 Rails。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-28T03:04:16.847

2 - 没有多少红宝石爱好者来这里。我看有很多 Ruby 项目。只是这里不多。

看看 Github、rubyforge 等上发生了什么。我的意思是，Rails 对于初学者来说是巨大的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-28T03:04:48.220

Ruby 在基于 Web 的开发中有很多活动。您只需加入正确的社区和列表。

我认为它永远不会像 C/C++（因为已经部署的代码和开发人员基础的存在）或 Java（因为我认为它一开始并不那么容易理解）那样流行。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-28T03:07:01.803

这是我的理论：

*   行业采用 - 尽管 ruby​​ 在[现实世界](http://wiki.rubyonrails.org/rails/pages/RealWorldUsage)中使用，但其他语言（例如 Java、C++、C# 等）已被接受为“安全语言”。从来没有人因为选择 Java 或 C# 而被解雇，但众所周知，当提到 ruby​​ 时，CIO 会扬起眉毛。
*   人才库 - 选择语言时，您想知道可以找到一个好的人才库。语言越流行，人才库就越大，专家的数量就越多（统计上）（统计数据确实存在 50% 的时间；））。

我的希望：

*   我相信 ruby​​ 的人才库会随着时间的推移而增长，而 ruby​​ 提供的生产力将为它的采用提供巨大的动力。
*   越来越多的大学将教授它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-28T04:12:17.553

请不要把 TIOBE 看得太重。检查搜索引擎中的“语言名称编程”实例作为某种流行度指标并不是很有意义。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-28T03:05:25.503

很可能是因为它比许多其他语言更年轻，而且在 Web 方面，它不像 PHP 和 Python 那样容易实现。由于 Rails 的出现，Ruby 作为一种 Web 脚本语言也声名狼藉，这可能会让一些正在寻找基于客户端的语言的开发人员望而却步。

Ruby不受欢迎吗？我认为是，但它还没有真正达到被广泛接受的临界质量。

# c# - 基于 Typeof 的工厂或者是

> ID：242097
> 
> 赞同：4
> 
> 时间：2008-10-28T02:52:16.390
> 
> 标签：c#, factory

在下面的代码中，我想根据另一个类的类型返回派生类，这是一种更优雅的方式。

```
 if (option_ is Rectangle)
            {
                modelInputs = new Foo();
            }
            else if (option_ is Circle)
            {
                modelInputs = new Bar();
            }
            else if (option_ is Triangle)
            {
                modelInputs = new Bar2();
            } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-28T02:57:41.200

让 Rectangle、Circle 和 Triangle 实现 IHasModelInput：

```
interface IHasModelInput
{
    IModelInput GetModelInput();
} 
```

那么你可以做

```
IModelInput modelInputs = option_.GetModelInput(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-28T03:49:07.570

我的意见：你的“不优雅”的方式很好。它简单，易读并且可以完成工作。

让 Rectangle、Circle 和 Triangle 通过*IHasModelInput*实现必要的工厂函数是可行的，但它有设计成本：您现在已经将这组类与 IModelInput 类集（Foo、Bar 和 Bar2）耦合。他们可能在两个完全不同的图书馆，也许他们不应该知道彼此。

下面是一个更复杂的方法。它为您提供了能够在运行时配置工厂逻辑的优势。

```
 public static class FactoryMethod<T>  where T : IModelInput, new()
    {
        public static IModelInput Create()
        {
            return new T();
        }
    }

    delegate IModelInput ModelInputCreateFunction();

    IModelInput CreateIModelInput(object item)
    {

        Dictionary<Type, ModelInputCreateFunction> factory = new Dictionary<Type, ModelInputCreateFunction>();

        factory.Add(typeof(Rectangle), FactoryMethod<Foo>.Create);
        factory.Add(typeof(Circle),    FactoryMethod<Bar>.Create);
        // Add more type mappings here

        IModelInput modelInput;
        foreach (Type t in factory.Keys)
        {
            if ( item.GetType().IsSubclassOf(t) || item.GetType().Equals(t))
            {
                modelInput = factory[t].Invoke();
                break;
            }
        }
        return modelInput;
    } 
```

但接着问一个问题：你更愿意读哪一本？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T04:02:12.160

您可以将输入和输出放在哈希表中，或者将创建每个类的类型存储在您创建的每个类中，然后使用 Activator.CreateInstance 进行工厂操作：

```
Hashtable ht = new Hashtable();
ht.Add(typeof(Rectangle), typeof(Bar));
ht.Add(typeof(Square), typeof(Bar2));

modelInputs = Activator.CreateInstance(ht[option.GetType()]); 
```

无论哪种方式，Activator.CreateInstance 都是使工厂在 .NET 中工作的一种非常酷的方式。享受并明智地使用我赋予你的力量，孩子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T02:56:05.930

如果允许，您可以将类型与“option_”相关联，然后创建它的实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T04:05:55.680

当我想在运行时将字符串转换为类型时，我通常使用这样的工厂方法，我使用将字符串映射到类型的字典。

就像最近的一个项目中的这样：

```
public class TaskFactory
{
    private Dictionary<String, Type> _taskTypes = new Dictionary<String, Type>();

    public TaskFactory()
    {
        // Preload the Task Types into a dictionary so we can look them up later
        foreach (Type type in typeof(TaskFactory).Assembly.GetTypes())
        {
            if (type.IsSubclassOf(typeof(CCTask)))
            {
                _taskTypes[type.Name.ToLower()] = type;
            }
        }
    }

    public CCTask CreateTask(XmlElement task)
    {
        if (task != null)
        {
            string taskName = task.Name;
            taskName =  taskName.ToLower() + "task";

            // If the Type information is in our Dictionary, instantiate a new instance of that task
            Type taskType;
            if (_taskTypes.TryGetValue(taskName, out taskType))
            {
                return (CCTask)Activator.CreateInstance(taskType, task);
            }
            else
            {
                throw new ArgumentException("Unrecognized Task:" + task.Name);
            }                               
        }
        else
        {
            return null;
        }
    }
} 
```

# regex - Is it safe to read regular expressions from a file?

> ID：242118
> 
> 赞同：12
> 
> 时间：2008-10-28T03:04:07.957
> 
> 标签：regex, perl, security

Assuming a Perl script that allows users to specify several text filter expressions in a config file, is there a safe way to let them enter regular expressions as well, without the possibility of unintended side effects or code execution? Without actually parsing the regexes and checking them for problematic constructs, that is. There won't be any substitution, only matching.

As an aside, is there a way to test if the specified regex is valid before actually using it? I'd like to issue warnings if something like `/foo (bar/` was entered.

Thanks, Z.

* * *

EDIT:
Thanks for the very interesting answers. I've since found out that the following dangerous constructs will only be evaluated in regexes if the `use re 'eval'` pragma is used:

```
(?{code})
(??{code})
${code}
@{code} 
```

The default is `no re 'eval'`; so unless I'm missing something, it should be safe to read regular expressions from a file, with the only check being the eval/catch posted by Axeman. At least I haven't been able to hide anything evil in them in my tests.

Thanks again. Z.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-28T04:40:54.970

根据您要匹配的内容以及您正在运行的 Perl 版本，可能会有一些正则表达式通过使用过多的前瞻、后视和其他断言来充当有效的拒绝服务攻击。

您最好只允许一小部分众所周知的正则表达式模式子集，并在您和您的用户学习如何使用该系统时谨慎地扩展它。就像许多博客评论系统只允许一小部分 HTML 标记一样。

如果您需要对正则表达式进行复杂的分析，最终 Parse::RecDescent 可能会变得有用。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-28T03:14:08.980

This

```
eval { 
    qr/$re/;
};
if ( $@  ) { 
    # do something
} 
```

compiles an expression, and lets you recover from an error.

You can watch for malicious expression, since you're only going to do matching, by looking for these patterns, which would allow arbitrary code to be run:

```
(?: \( \?{1,2} \{  # '(' followed by '?' or '??', and then '{'
|   \@ \{ \s* \[   # a dereference of a literal array, which may be arbitrary code.
) 
```

Make sure you compile this with the `x` flag.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-28T03:06:42.960

You will probably have to do some level of sanitisation. For example, the [perlre](http://perldoc.perl.org/perlre.html) man page describes the following construct:

```
(?{ code }) 
```

which allows executable code inside a pattern match.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-28T08:30:50.200

我建议不要相信用户的任何正则表达式。如果你真的决定这样做，请在污点 (-T) 模式下运行 perl。在这种情况下，您将需要某种形式的验证。而不是像另一个答案所建议的那样使用 Parse::RecDescent 来编写自己的正则表达式解析器，您应该使用现有的[YAPE::Regex](http://search.cpan.org/dist/YAPE-Regex)正则表达式解析器，它可能更快，由专家编写并且像魅力一样工作。

最后，从 perl 5.10.0 开始，您可以将不同的正则表达式引擎插入 perl（从词法上讲！）。您可以检查是否有一个功能较弱的正则表达式引擎可用，其语法更容易验证。如果您想走这条路，请阅读[API 描述](http://search.cpan.org/perldoc?perlreapi)、[Avar 的 re::engine::Plugin](http://search.cpan.org/perldoc?re::engine::Plugin)或一般检查任何[Avar 的插件引擎](http://search.cpan.org/~avar)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T18:01:42.980

[Safe](http://perldoc.perl.org/Safe.html "安全的")模块在编译/执行不受信任的正则表达式方面是否有用？

# wcf - Does WCF support any kind of resume functionality?

> ID：242143
> 
> 赞同：3
> 
> 时间：2008-10-28T03:22:39.103
> 
> 标签：wcf, resume

I am using WCF to upload data to a server.

If the communication fails, is there any way to resume the upload?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T05:50:20.023

分块通道适合您的场景，尤其是在发送大消息时。

[http://msdn.microsoft.com/en-us/library/aa717050.aspx](http://msdn.microsoft.com/en-us/library/aa717050.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:30:31.733

是的，wsHttpBinding 协议支持所谓的“可靠会话”，可以捕获和处理间歇性网络中断。发件人可能需要重新发送某些信息，但基本上，这将为您提供一定程度的安全性。

查看 Michele Leroux Bustamante 的 15 部分系列“ [WCF 自上而下](http://www.dasblonde.net/WCFWebcastSeries.aspx)”了解更多信息 - 第 1 期。12 专门处理[可靠消息传递](http://www.dasblonde.net/ct.ashx?id=c639724e-3ae5-4e8b-9d3f-d4e42dea41e6&url=http%3a%2f%2fmsevents.microsoft.com%2fCUI%2fEventDetail.aspx%3fEventID%3d1032344353%26Culture%3den-US)。

或者查看 MSDN[对 WCF 中可靠消息传递的介绍](http://msdn.microsoft.com/en-us/library/aa480191.aspx)。

马克

# iphone - 我如何告诉我的应用程序关闭？

> ID：242147
> 
> 赞同：2
> 
> 时间：2008-10-28T03:25:48.023
> 
> 标签：iphone, cocoa-touch

我刚刚发现了可可触摸的漂亮的未处理异常处理程序。

现在我可以优雅地通知用户任何可能使我的应用程序崩溃的未处理异常，我想在通知用户发生崩溃后关闭我的应用程序。

有谁知道如何以编程方式关闭应用程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-28T03:48:05.513

您可以调用 [[UIApplication sharedApplication] terminate]; - 但是，这不会构建 Springboard 用于为应用程序的退出设置动画的屏幕截图，因此屏幕只会变黑，直到图标移入。似乎没有公开的方法可以做到这一点；UIApplication 标头甚至没有提到 -terminate 方法，因此您可能根本不打算这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T06:23:34.030

```
exit(0); 
```

会成功的...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T05:51:32.423

苹果的文档说没有“正常”的关闭方式。在您的情况下 - 一个未处理的异常 - 无论如何立即终止都是有意义的。

# silverlight - Silverlight 将如何在未来几年改变互联网？

> ID：242153
> 
> 赞同：0
> 
> 时间：2008-10-28T03:27:46.520
> 
> 标签：silverlight

Silverlight 将如何在未来 10 年内改变互联网？

这将是一个场景改变还是只是另一个昙花一现？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-28T03:50:39.610

人们经常低估微软。我不知道它是否会改变 Internet，但 Silverlight 可能会得到相当广泛的应用，尤其是在需要丰富界面的基于 Web 的业务应用程序中。Flash 很好，但是能够使用 .NET 和 WPF 开发丰富的 Web 界面要好得多，尤其是在那个领域。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-28T03:33:47.537

这将是另一个亮点。与 Flash 或其他任何竞争对手不同，它并不是真正的跨平台，而且似乎没有人对它特别感兴趣。它可能是整洁而有光泽的，但我还没有看到任何真正的理由去玩它。

换句话说，这是一个很酷的玩具，但仅此而已。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T03:34:54.337

除非 Silverlight 在其他操作系统（阅读：OS X 和 Linux）中实现了可观的实现，并且它可以显着区别于 Flash，否则它永远不会在富内容网络应用程序市场 IMO 中占据很大比例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T03:43:11.717

我个人认为 Silverlight 会很受欢迎，作为开发人员，它对 IMO 有很好的“感觉”。

随着 Mono 继续快速增长，跨平台问题将很快得到解决。

但我认为，要让 Flash/Flex 在 RIA 开发平台上脱颖而出，还需要很长时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T04:02:56.480

Silverlight 允许开发人员使用 C# 等本地语言将一些处理卸载到客户端上的 CLR，提供不限于浏览器之间的 HTML/CSS/DOM 差异的丰富接口，并可能减少对 javascript 脚本的需求。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-28T04:31:11.867

虽然我在这里可能看起来很矛盾，但我真的完全不喜欢 Silverlight，我也不喜欢 Flash。

现在浏览器的渲染和处理速度真的很快，它们不再带来任何东西。您可以使用纯 Javascript 和 HTML/CSS 完成大部分相同的操作。而你不能做的事情，你将能够用 HTML 5.0 做。我们需要的不是更多的专有框架，而是我们已经拥有的更好的工具。

所以我的猜测是 10 年后，Silverlight 和 Flash 不会超过维基百科的文章。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-03T21:28:25.490

我觉得虽然您可以使用 Javascript 和 CSS 完成大部分所需的工作，但 Silverlight 编程对我来说更加流畅和快速。在轻松构建带有大量动画的丰富设计时尤其如此。设计师和开发人员团队在 Silverlight 和 WPF 项目上进行协作非常容易，而且效率很重要。Visual Studio 是一个出色的 IDE，让许多开发人员留在了 Microsoft 牧场。Expression 套件感觉就像是允许您的 IDE 为您完成大量工作的下一个重大进步。

Deep Zoom 是 Silverlight 的另一个大赢家 - 查看[Hard Rock Memorabilia 系列](http://www.sfmoma.org/projects/artscope/index.html#r=73&zoom=4&artwork=16429)的 Silverlight 实施。现在看看[SF Moma 的艺术收藏](http://www.sfmoma.org/projects/artscope/index.html#r=73&zoom=4&artwork=16429)的 Flash 实现。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-03T21:35:22.120

在您尝试之前不要敲击 Silverlight。我不是微软的粉丝，但它很容易使用。没用过微软技术开发的人不知道好的IDE是什么意思。

我主要使用 PHP 进行开发，我使用 Aptana 进行开发。VS200x 在几乎所有方面都领先于任何其他 IDE。

唯一阻碍 Silverlight 得到更广泛使用的是更好的跨平台支持。这将是一件非常了不起的事情，我根本看不到发生。如果微软可以稍微放松一下，它会为它创造奇迹。再说一次，微软已经开始免费提供一些非常好的工具：Express VS 工具、Dreamspark 套件等。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-03T21:40:02.457

Silverlight 将流行的一个领域是业务应用程序。随着架构模型转向面向服务的领域，将会有许多公司希望移植他们的旧客户端/服务器应用程序。Silverlight 使他们能够维护表单应用程序的丰富 UI，同时提供与服务通信所需的消息传递功能。此外，部署范围比他们使用严格的 WPF 和 xbapps 获得的范围更广。Flash 在这个领域并没有真正的竞争，直接的 asp.net 或其他 web 技术前端，虽然与 Ajax 和所有有趣的东西一起变得更好，但不会支持你可以从 silverlight 中获得的丰富性。

# logging - 分析与日志记录有何不同？

> ID：242160
> 
> 赞同：8
> 
> 时间：2008-10-28T03:30:49.463
> 
> 标签：logging, profiling

分析与日志记录有何不同？

是否只是将分析用于性能测量以查看每个功能需要多长时间？还是我下班了？

通常，如何使用分析库？

通过分析获得哪些类型的统计信息？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-28T03:33:42.687

日志记录告诉你发生了*什么*。它非常适合取证和调试。

分析量化了这一点：它告诉您代码在每个区域花费了多少时间，或者代码体执行了多少次。它可以帮助您提高代码的性能。

分析通常在代码行、函数调用或有时是文件的级别上运行。对于每个级别，它通常可以告诉您：

*   *该单元执行了*多少次。*优化很少使用的代码通常不如优化执行数百万次的代码重要。一个例外是使用户（或另一个进程）等待它完成的代码。*

**   *一个分支*被占用了多少次，比如在一个`if`or`switch`语句中。同样，您通常最关心优化常用代码。

    *   **在特定功能*上花费了*多少时间*。 **警告：**即使是经验丰富的开发人员也常常对这些结果感到惊讶。很难预测你的“时间沉没”在哪里。*

    **   *在函数中花费了*多少时间以及在该函数中**调用的所有函数*。也许需要优化的不是函数本身，而是它的子函数。*

    **   **每个呼叫者呼叫*该单元的*次数*。你可能会发现一个特定的函数主要是从一个意想不到的地方调用的。**** 

 **借助来自良好分析器的数据，您通常可以以相对较少的努力获得显着的性能改进。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-28T03:37:19.747

**分析**是关于确定函数/方法调用的性能，例如

*   花在函数上的时间
*   在函数中花费的时间 + 在子函数中花费的时间
*   调用特定函数的次数

概要分析的整个想法是对系统有一个很好的概述，以确定可以在哪里进行优化。如果您知道某个特定函数的调用次数比调用次数第二多的函数多 20 次，那么您就知道何时应该集中精力进行优化。

它还向您展示了*不*应该在哪里度过您的时间。您不想花一天时间优化一个*每小时只调用一次*的函数。您希望将时间集中在优化那些*每秒被调用多次*的函数上。

**在我的理解中， Logging**只是跟踪调用的内容（但没有与每个调用相关的详细元数据）。

诸如 Rational Quantify 之类的分析库通过检测代码在运行时收集统计信息来工作。这将产生隐含的性能影响，但在整个系统中都是相对的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T03:34:39.750

分析用于确定程序的运行时效率。它可用于测量内存使用情况或 CPU 使用情况。您可以使用它来优化您的代码。

另一方面，日志记录是一种审计功能。您想查看程序在运行时做了什么。它更多地用于调试而不是性能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T03:32:32.610

我将分析视为性能测量，您不必分析运行的每一段代码，有时针对特定区域会更好。

日志记录是存储信息以供以后使用，这些信息可能与分析有关，但不一定。它可能只是记录发生的事情。

我曾经使用过的所有分析工具基本上都允许您存储“事务”的开始时间和结束时间，然后再操作数据以查看花费最多的时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T03:32:49.117

日志记录是为了审计或故障排除而记录所做的事情。我想说，剖析是衡量性能的技术。分析可以通过记录性能指标来完成，也可以通过使用专门的工具或实用程序来检查系统运行时的状态来完成。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-28T03:34:42.043

日志语句通常写在源代码本身中，而通过[分析](http://en.wikipedia.org/wiki/Performance_analysis)，您可以在代码编译*后*对其进行修改，然后仅针对分析会话进行**检测**（即，在构建本身的*任何*版本中都不存在分析代码。）和实时测量性能，也可以对其**进行采样**，以便以更精细但侵入性更小的方式跟踪性能。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-28T11:05:26.720

**日志记录**告诉你*有多少*问题发布到 stackoverflow。

**分析**会告诉您发布每个问题需要多*长时间*，以及您在这里花费了*多少工作日。*

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-04T16:20:44.033

前面的答案是对的。

然而，恕我直言，分析器比枪更烟雾，我敢打赌这会导致一些箭头被点击。

如果您想知道一个函数负责多少时间，您需要知道它被调用了多少次以及调用它需要多长时间。其中一个没有另一个是没有用的。

即使它告诉你这两个，它也不会告诉你函数内部的哪些语句对时间负责。它们会告诉你很多东西，比如带注释的调用图等等，但它仍然以许多线索的形式出现，你必须对其进行解谜，让你的猜测听起来更“有根据”。

然后他们谈论这些数字有多“准确”。进行了很好的演示，但没有解决问题。

他们*能做*的（他们没有做的）是指着特定的陈述或指示说

> 如果您可以摆脱它，这里的这个精确语句将为您节省 X% 的总执行时间。

并按 X 排序。

如果您确实需要解决性能问题，那就是您所需要的，您可以自己轻松搞定。看这里：
        [如何优化程序的性能](http://www.wikihow.com/Optimize-Your-Program%27s-Performance#Steps)

# c++ - 这个用于原子浮点的 C++ 实现安全吗？

> ID：242172
> 
> 赞同：15
> 
> 时间：2008-10-28T03:36:46.033
> 
> 标签：c++, thread-safety, atomic, tbb

> **编辑：**这里的代码仍然有一些错误，它可以在性能部门做得更好，但是我没有尝试修复这个问题，而是将问题提交给英特尔讨论组并得到了很多很好的反馈，如果一切顺利，Atomic float 的抛光版本将包含在英特尔线程构建模块的近期版本中

好的，这是一个艰难的，我想要一个原子浮点数，不是为了超快的图形性能，而是作为类的数据成员常规使用。而且我不想为在这些类上使用锁付出代价，因为它没有为我的需求提供额外的好处。

现在有了英特尔的 tbb 和我见过的其他原子库，支持整数类型，但不支持浮点。所以我继续实施了一个，它有效......但我不确定它是否真的有效，或者我很幸运它有效。

这里的任何人都知道这是否不是某种形式的线程异端？

```
typedef unsigned int uint_32;

  struct AtomicFloat
  {
    private:
    tbb::atomic<uint_32> atomic_value_;

    public:
    template<memory_semantics M>
    float fetch_and_store( float value ) 
    {
        const uint_32 value_ = atomic_value_.tbb::atomic<uint_32>::fetch_and_store<M>((uint_32&)value);
        return reinterpret_cast<const float&>(value_);
    }

    float fetch_and_store( float value ) 
    {
        const uint_32 value_ = atomic_value_.tbb::atomic<uint_32>::fetch_and_store((uint_32&)value);
        return reinterpret_cast<const float&>(value_);
    }

    template<memory_semantics M>
    float compare_and_swap( float value, float comparand ) 
    {
        const uint_32 value_ = atomic_value_.tbb::atomic<uint_32>::compare_and_swap<M>((uint_32&)value,(uint_32&)compare);
        return reinterpret_cast<const float&>(value_);
    }

    float compare_and_swap(float value, float compare)
    {
        const uint_32 value_ = atomic_value_.tbb::atomic<uint_32>::compare_and_swap((uint_32&)value,(uint_32&)compare);
        return reinterpret_cast<const float&>(value_);
    }

    operator float() const volatile // volatile qualifier here for backwards compatibility 
    {
        const uint_32 value_ = atomic_value_;
        return reinterpret_cast<const float&>(value_);
    }

    float operator=(float value)
    {
        const uint_32 value_ = atomic_value_.tbb::atomic<uint_32>::operator =((uint_32&)value);
        return reinterpret_cast<const float&>(value_);
    }

    float operator+=(float value)
    {
        volatile float old_value_, new_value_;
        do
        {
            old_value_ = reinterpret_cast<float&>(atomic_value_);
            new_value_ = old_value_ + value;
        } while(compare_and_swap(new_value_,old_value_) != old_value_);
        return (new_value_);
    }

    float operator*=(float value)
    {
        volatile float old_value_, new_value_;
        do
        {
            old_value_ = reinterpret_cast<float&>(atomic_value_);
            new_value_ = old_value_ * value;
        } while(compare_and_swap(new_value_,old_value_) != old_value_);
        return (new_value_);
    }

    float operator/=(float value)
    {
        volatile float old_value_, new_value_;
        do
        {
            old_value_ = reinterpret_cast<float&>(atomic_value_);
            new_value_ = old_value_ / value;
        } while(compare_and_swap(new_value_,old_value_) != old_value_);
        return (new_value_);
    }

    float operator-=(float value)
    {
        return this->operator+=(-value);
    }

    float operator++() 
    {
        return this->operator+=(1);
    }

    float operator--() 
    {
        return this->operator+=(-1);
    }

    float fetch_and_add( float addend ) 
    {
        return this->operator+=(-addend);
    }

    float fetch_and_increment() 
    {
        return this->operator+=(1);
    }

    float fetch_and_decrement() 
    {
        return this->operator+=(-1);
    }
   }; 
```

谢谢！

**编辑：**按照 Greg Rogers 的建议将 size_t 更改为 uint32_t，这样它更便携

**编辑：**为整个事物添加了列表，并进行了一些修复。

**更多编辑：**在我的机器上使用锁定浮点数进行 5.000.000 += 操作（在我的机器上使用 100 个线程）需要 3.6 秒，而我的原子浮点数即使是愚蠢的 do-while 也需要 0.2 秒才能完成相同的工作。因此，> 30 倍的性能提升意味着它是值得的，（这就是问题所在）如果它是正确的。

**更多编辑：**正如 Awgn 指出的那样，我的`fetch_and_xxxx`部分都错了。修复了这个问题并删除了我不确定的部分 API（模板化内存模型）。并在运算符 += 方面实现了其他操作，以避免代码重复

**添加：**添加了运算符 *= 和运算符 /=，因为没有它们，浮点数就不会是浮点数。感谢 Peterchen 的评论，这被注意到了

**编辑：**最新版本的代码如下（我将保留旧版本以供参考）

```
 #include <tbb/atomic.h>
  typedef unsigned int      uint_32;
  typedef __TBB_LONG_LONG       uint_64;

  template<typename FLOATING_POINT,typename MEMORY_BLOCK>
  struct atomic_float_
  {
    /*  CRC Card -----------------------------------------------------
    |   Class:          atmomic float template class
    |
    |   Responsability: handle integral atomic memory as it were a float,
    |                   but partially bypassing FPU, SSE/MMX, so it is
    |                   slower than a true float, but faster and smaller
    |                   than a locked float.
    |                       *Warning* If your float usage is thwarted by
    |                   the A-B-A problem this class isn't for you
    |                       *Warning* Atomic specification says we return,
    |                   values not l-values. So  (i = j) = k doesn't work.
    |
    |   Collaborators:  intel's tbb::atomic handles memory atomicity
    ----------------------------------------------------------------*/
    typedef typename atomic_float_<FLOATING_POINT,MEMORY_BLOCK> self_t;

    tbb::atomic<MEMORY_BLOCK> atomic_value_;

    template<memory_semantics M>
    FLOATING_POINT fetch_and_store( FLOATING_POINT value ) 
    {
        const MEMORY_BLOCK value_ = 
            atomic_value_.tbb::atomic<MEMORY_BLOCK>::fetch_and_store<M>((MEMORY_BLOCK&)value);
        //atomic specification requires returning old value, not new one
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    FLOATING_POINT fetch_and_store( FLOATING_POINT value ) 
    {
        const MEMORY_BLOCK value_ = 
            atomic_value_.tbb::atomic<MEMORY_BLOCK>::fetch_and_store((MEMORY_BLOCK&)value);
        //atomic specification requires returning old value, not new one
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    template<memory_semantics M>
    FLOATING_POINT compare_and_swap( FLOATING_POINT value, FLOATING_POINT comparand ) 
    {
        const MEMORY_BLOCK value_ = 
            atomic_value_.tbb::atomic<MEMORY_BLOCK>::compare_and_swap<M>((MEMORY_BLOCK&)value,(MEMORY_BLOCK&)compare);
        //atomic specification requires returning old value, not new one
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    FLOATING_POINT compare_and_swap(FLOATING_POINT value, FLOATING_POINT compare)
    {
        const MEMORY_BLOCK value_ = 
            atomic_value_.tbb::atomic<MEMORY_BLOCK>::compare_and_swap((MEMORY_BLOCK&)value,(MEMORY_BLOCK&)compare);
        //atomic specification requires returning old value, not new one
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    operator FLOATING_POINT() const volatile // volatile qualifier here for backwards compatibility 
    {
        const MEMORY_BLOCK value_ = atomic_value_;
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    //Note: atomic specification says we return the a copy of the base value not an l-value
    FLOATING_POINT operator=(FLOATING_POINT rhs) 
    {
        const MEMORY_BLOCK value_ = atomic_value_.tbb::atomic<MEMORY_BLOCK>::operator =((MEMORY_BLOCK&)rhs);
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    //Note: atomic specification says we return an l-value when operating among atomics
    self_t& operator=(self_t& rhs) 
    {
        const MEMORY_BLOCK value_ = atomic_value_.tbb::atomic<MEMORY_BLOCK>::operator =((MEMORY_BLOCK&)rhs);
        return *this;
    }

    FLOATING_POINT& _internal_reference() const
    {
        return reinterpret_cast<FLOATING_POINT&>(atomic_value_.tbb::atomic<MEMORY_BLOCK>::_internal_reference());
    }

    FLOATING_POINT operator+=(FLOATING_POINT value)
    {
        FLOATING_POINT old_value_, new_value_;
        do
        {
            old_value_ = reinterpret_cast<FLOATING_POINT&>(atomic_value_);
            new_value_ = old_value_ + value;
        //floating point binary representation is not an issue because
        //we are using our self's compare and swap, thus comparing floats and floats
        } while(self_t::compare_and_swap(new_value_,old_value_) != old_value_);
        return (new_value_); //return resulting value
    }

    FLOATING_POINT operator*=(FLOATING_POINT value)
    {
        FLOATING_POINT old_value_, new_value_;
        do
        {
            old_value_ = reinterpret_cast<FLOATING_POINT&>(atomic_value_);
            new_value_ = old_value_ * value;
        //floating point binary representation is not an issue becaus
        //we are using our self's compare and swap, thus comparing floats and floats
        } while(self_t::compare_and_swap(new_value_,old_value_) != old_value_);
        return (new_value_); //return resulting value
    }

    FLOATING_POINT operator/=(FLOATING_POINT value)
    {
        FLOATING_POINT old_value_, new_value_;
        do
        {
            old_value_ = reinterpret_cast<FLOATING_POINT&>(atomic_value_);
            new_value_ = old_value_ / value;
        //floating point binary representation is not an issue because
        //we are using our self's compare and swap, thus comparing floats and floats
        } while(self_t::compare_and_swap(new_value_,old_value_) != old_value_);
        return (new_value_); //return resulting value
    }

    FLOATING_POINT operator-=(FLOATING_POINT value)
    {
        return this->operator+=(-value); //return resulting value
    }

    //Prefix operator
    FLOATING_POINT operator++()
    {
        return this->operator+=(1); //return resulting value
    }

    //Prefix operator
    FLOATING_POINT operator--() 
    {
        return this->operator+=(-1); //return resulting value
    }

    //Postfix operator
    FLOATING_POINT operator++(int)
    {
        const FLOATING_POINT temp = this;
        this->operator+=(1);
        return temp//return resulting value
    }

    //Postfix operator
    FLOATING_POINT operator--(int) 
    {
        const FLOATING_POINT temp = this;
        this->operator+=(1);
        return temp//return resulting value
    }

    FLOATING_POINT fetch_and_add( FLOATING_POINT addend ) 
    {
        const FLOATING_POINT old_value_ = atomic_value_;
        this->operator+=(addend);
        //atomic specification requires returning old value, not new one as in operator x=
        return old_value_; 
    }

    FLOATING_POINT fetch_and_increment() 
    {
        const FLOATING_POINT old_value_ = atomic_value_;
        this->operator+=(+1);
        //atomic specification requires returning old value, not new one as in operator x=
        return old_value_; 
    }

    FLOATING_POINT fetch_and_decrement() 
    {
        const FLOATING_POINT old_value_ = atomic_value_;
        this->operator+=(-1);
        //atomic specification requires returning old value, not new one as in operator x=
        return old_value_; 
    }
  };

  typedef atomic_float_<float,uint_32> AtomicFloat;
  typedef atomic_float_<double,uint_64> AtomicDouble; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T03:55:25.247

我会认真建议不要公开继承。我不知道原子实现是什么样的，但我假设它具有将其用作整数类型的重载运算符，这意味着在许多（也许是大多数？）情况下，将使用这些提升而不是你的浮点数。

我看不出有什么不可行的理由，但像你一样，我必须证明...

注意：您的`operator float()`例程没有加载获取语义，不应该将其标记为 const volatile （或绝对至少是 const ）吗？

编辑：如果你要提供 operator--() 你应该提供前缀/后缀形式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-28T03:40:30.380

看起来您的实现假设`sizeof(size_t) == sizeof(float)`. 对于您的目标平台，这是否总是正确的？

而且我不会说是异端邪说，*而是说异端**邪说*。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T05:31:33.900

这是在英特尔板上讨论后的代码状态，但仍未经过彻底验证以在所有情况下都能正常工作。

```
 #include <tbb/atomic.h>
  typedef unsigned int      uint_32;
  typedef __TBB_LONG_LONG       uint_64;

  template<typename FLOATING_POINT,typename MEMORY_BLOCK>
  struct atomic_float_
  {
    /*  CRC Card -----------------------------------------------------
    |   Class:          atmomic float template class
    |
    |   Responsability: handle integral atomic memory as it were a float,
    |                   but partially bypassing FPU, SSE/MMX, so it is
    |                   slower than a true float, but faster and smaller
    |                   than a locked float.
    |                       *Warning* If your float usage is thwarted by
    |                   the A-B-A problem this class isn't for you
    |                       *Warning* Atomic specification says we return,
    |                   values not l-values. So  (i = j) = k doesn't work.
    |
    |   Collaborators:  intel's tbb::atomic handles memory atomicity
    ----------------------------------------------------------------*/
    typedef typename atomic_float_<FLOATING_POINT,MEMORY_BLOCK> self_t;

    tbb::atomic<MEMORY_BLOCK> atomic_value_;

    template<memory_semantics M>
    FLOATING_POINT fetch_and_store( FLOATING_POINT value ) 
    {
        const MEMORY_BLOCK value_ = 
            atomic_value_.tbb::atomic<MEMORY_BLOCK>::fetch_and_store<M>((MEMORY_BLOCK&)value);
        //atomic specification requires returning old value, not new one
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    FLOATING_POINT fetch_and_store( FLOATING_POINT value ) 
    {
        const MEMORY_BLOCK value_ = 
            atomic_value_.tbb::atomic<MEMORY_BLOCK>::fetch_and_store((MEMORY_BLOCK&)value);
        //atomic specification requires returning old value, not new one
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    template<memory_semantics M>
    FLOATING_POINT compare_and_swap( FLOATING_POINT value, FLOATING_POINT comparand ) 
    {
        const MEMORY_BLOCK value_ = 
            atomic_value_.tbb::atomic<MEMORY_BLOCK>::compare_and_swap<M>((MEMORY_BLOCK&)value,(MEMORY_BLOCK&)compare);
        //atomic specification requires returning old value, not new one
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    FLOATING_POINT compare_and_swap(FLOATING_POINT value, FLOATING_POINT compare)
    {
        const MEMORY_BLOCK value_ = 
            atomic_value_.tbb::atomic<MEMORY_BLOCK>::compare_and_swap((MEMORY_BLOCK&)value,(MEMORY_BLOCK&)compare);
        //atomic specification requires returning old value, not new one
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    operator FLOATING_POINT() const volatile // volatile qualifier here for backwards compatibility 
    {
        const MEMORY_BLOCK value_ = atomic_value_;
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    //Note: atomic specification says we return the a copy of the base value not an l-value
    FLOATING_POINT operator=(FLOATING_POINT rhs) 
    {
        const MEMORY_BLOCK value_ = atomic_value_.tbb::atomic<MEMORY_BLOCK>::operator =((MEMORY_BLOCK&)rhs);
        return reinterpret_cast<const FLOATING_POINT&>(value_);
    }

    //Note: atomic specification says we return an l-value when operating among atomics
    self_t& operator=(self_t& rhs) 
    {
        const MEMORY_BLOCK value_ = atomic_value_.tbb::atomic<MEMORY_BLOCK>::operator =((MEMORY_BLOCK&)rhs);
        return *this;
    }

    FLOATING_POINT& _internal_reference() const
    {
        return reinterpret_cast<FLOATING_POINT&>(atomic_value_.tbb::atomic<MEMORY_BLOCK>::_internal_reference());
    }

    FLOATING_POINT operator+=(FLOATING_POINT value)
    {
        FLOATING_POINT old_value_, new_value_;
        do
        {
            old_value_ = reinterpret_cast<FLOATING_POINT&>(atomic_value_);
            new_value_ = old_value_ + value;
        //floating point binary representation is not an issue because
        //we are using our self's compare and swap, thus comparing floats and floats
        } while(self_t::compare_and_swap(new_value_,old_value_) != old_value_);
        return (new_value_); //return resulting value
    }

    FLOATING_POINT operator*=(FLOATING_POINT value)
    {
        FLOATING_POINT old_value_, new_value_;
        do
        {
            old_value_ = reinterpret_cast<FLOATING_POINT&>(atomic_value_);
            new_value_ = old_value_ * value;
        //floating point binary representation is not an issue becaus
        //we are using our self's compare and swap, thus comparing floats and floats
        } while(self_t::compare_and_swap(new_value_,old_value_) != old_value_);
        return (new_value_); //return resulting value
    }

    FLOATING_POINT operator/=(FLOATING_POINT value)
    {
        FLOATING_POINT old_value_, new_value_;
        do
        {
            old_value_ = reinterpret_cast<FLOATING_POINT&>(atomic_value_);
            new_value_ = old_value_ / value;
        //floating point binary representation is not an issue because
        //we are using our self's compare and swap, thus comparing floats and floats
        } while(self_t::compare_and_swap(new_value_,old_value_) != old_value_);
        return (new_value_); //return resulting value
    }

    FLOATING_POINT operator-=(FLOATING_POINT value)
    {
        return this->operator+=(-value); //return resulting value
    }

    //Prefix operator
    FLOATING_POINT operator++()
    {
        return this->operator+=(1); //return resulting value
    }

    //Prefix operator
    FLOATING_POINT operator--() 
    {
        return this->operator+=(-1); //return resulting value
    }

    //Postfix operator
    FLOATING_POINT operator++(int)
    {
        const FLOATING_POINT temp = this;
        this->operator+=(1);
        return temp//return resulting value
    }

    //Postfix operator
    FLOATING_POINT operator--(int) 
    {
        const FLOATING_POINT temp = this;
        this->operator+=(1);
        return temp//return resulting value
    }

    FLOATING_POINT fetch_and_add( FLOATING_POINT addend ) 
    {
        const FLOATING_POINT old_value_ = atomic_value_;
        this->operator+=(addend);
        //atomic specification requires returning old value, not new one as in operator x=
        return old_value_; 
    }

    FLOATING_POINT fetch_and_increment() 
    {
        const FLOATING_POINT old_value_ = atomic_value_;
        this->operator+=(+1);
        //atomic specification requires returning old value, not new one as in operator x=
        return old_value_; 
    }

    FLOATING_POINT fetch_and_decrement() 
    {
        const FLOATING_POINT old_value_ = atomic_value_;
        this->operator+=(-1);
        //atomic specification requires returning old value, not new one as in operator x=
        return old_value_; 
    }
  };

  typedef atomic_float_<float,uint_32> AtomicFloat;
  typedef atomic_float_<double,uint_64> AtomicDouble; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T08:41:03.097

尽管*uint32_t*的大小可能等同于给定拱上的*浮点数*，但通过将一个强制转换重新解释为另一个，您隐含地假设原子增量、减量和所有其他位操作在两种类型上在语义上是等效的，这在现实中是不存在的。我怀疑它是否按预期工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T09:42:10.883

我强烈怀疑您是否在 fetch_and_add 等中获得了正确的值，因为浮点加法不同于 int 加法。

这是我从这些算术中得到的：

```
1   + 1    =  1.70141e+038  
100 + 1    = -1.46937e-037  
100 + 0.01 =  1.56743e+038  
23  + 42   = -1.31655e-036 
```

所以，是的，线程安全，但不是你所期望的。

无锁算法（运算符+等）应该在原子性方面起作用（尚未检查算法本身..）

* * *

其他解决方案：由于都是加法和减法，您可以为每个线程提供自己的实例，然后将多个线程的结果相加。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-01T19:18:36.063

只是对此的说明（我想发表评论，但显然不允许新用户发表评论）：在引用上使用 reinterpret_cast 会产生不正确的代码与 gcc 4.1 -O3。这似乎在 4.4 中得到修复，因为它在那里工作。将 reinterpret_casts 更改为指针，虽然稍微难看，但在这两种情况下都有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-28T04:00:07.657

从我对那段代码的阅读来看，我真的会对这样一个编译器感到愤怒，以至于为此推出了非原子的程序集。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-28T04:39:19.090

让您的编译器生成汇编代码并查看它。如果操作不仅仅是一条汇编语言指令，那么它就*不是*原子操作，并且需要锁才能在多处理器系统中正常运行。

不幸的是，我不确定反之亦然——单指令操作*保证*是原子的。我不知道多处理器编程的细节到那个级别。我可以为任何一个结果提出理由。（如果其他人对此有一些明确的信息，请随时加入。）

# aop - 什么是面向方面编程？

> ID：242177
> 
> 赞同：252
> 
> 时间：2008-10-28T03:39:46.200
> 
> 标签：aop, paradigms

我了解面向对象的编程，并且已经编写了很长时间的 OO 程序。人们似乎在谈论面向方面的编程，但我从未真正了解它是什么或如何使用它。什么是基本范式？

这个问题是相关的，但并不完全问它：

[面向方面编程与面向对象编程](https://stackoverflow.com/questions/232884/aspect-oriented-programming-vs-object-oriented-programming)

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2008-10-28T03:46:05.267

AOP 解决了横切关注点的问题，*横切关注点*可以是任何类型的代码，它以不同的方法重复，并且通常不能完全重构到自己的模块中，例如日志记录或验证。因此，使用 AOP，您可以将这些内容从主代码中删除并垂直定义它，如下所示：

```
function mainProgram()
{ 
   var x =  foo();
   doSomethingWith(x);
   return x;
}

aspect logging
{ 
    before (mainProgram is called):
    { 
       log.Write("entering mainProgram");
    }

    after (mainProgram is called):
    { 
       log.Write(  "exiting mainProgram with return value of "
                  + mainProgram.returnValue);
    }
 } 

aspect verification
{ 
    before (doSomethingWith is called):
    { 
       if (doSomethingWith.arguments[0] == null) 
       { 
          throw NullArgumentException();
       }

       if (!doSomethingWith.caller.isAuthenticated)
       { 
          throw Securityexception();
       }
    }
 } 
```

然后使用*aspect-weaver*将代码编译成这样：

```
function mainProgram()
{ 
   log.Write("entering mainProgram");

   var x = foo();   

   if (x == null) throw NullArgumentException();
   if (!mainProgramIsAuthenticated()) throw Securityexception();
   doSomethingWith(x);   

   log.Write("exiting mainProgram with return value of "+ x);
   return x;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-28T04:07:36.517

不幸的是，要让 AOP 在正常的中大型组织中真正有用似乎非常困难。（编辑支持、控制感、从导致代码腐烂的不那么重要的事情开始的事实、人们回家回家等等）

我把希望寄托在**面向复合的编程**上，这是越来越现实的东西。它连接了许多流行的想法，并为您提供了一些非常酷的东西。

在此处查看即将推出的实现：[qi4j.org/](http://www.qi4j.org/)

PS。实际上，我认为 AOP 的优点之一也是它的致命弱点：它的非侵入性，让人们尽可能忽略它，因此在大多数组织中它会被视为次要关注点。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-09-15T09:27:49.497

复制自 Spring in Action

> AOP 通常被定义为一种促进软件系统中关注点分离的技术。系统由几个组件组成，每个组件负责一个特定的功能。但这些组件通常还承担超出其核心功能的额外职责。诸如日志记录、事务管理和安全性之类的系统服务通常会进入其核心职责是其他方面的组件中。这些系统服务通常被称为横切关注点，因为它们倾向于跨越系统中的多个组件。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-26T04:28:23.910

为了完整起见，从副本中复制（爱因斯坦）：

经典的例子是安全和日志记录。不是在应用程序中编写代码来记录 x 的出现或检查对象 z 以进行安全访问控制，而是有一个普通代码的“带外”语言装置，它可以系统地注入安全性或登录到没有它们的例程中这样即使您的代码不提供它 - 它也会得到照顾。

一个更具体的例子是操作系统提供对文件的访问控制。软件程序不需要检查访问限制，因为底层系统会为它工作。

如果您认为根据我的经验需要 AOP，那么您实际上需要投入更多的时间和精力在系统内进行适当的元数据管理，重点是经过深思熟虑的结构/系统设计。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-26T04:27:50.450

为了完整起见，从副本中复制（蜂鸣器）：

.NET 中的类和方法属性是一种面向方面的编程形式。你用属性装饰你的类/方法。在幕后，这会将代码添加到执行属性的特定功能的类/方法中。例如，将类标记为可序列化允许它自动序列化以存储或传输到另一个系统。其他属性可能会将某些属性标记为不可序列化，并且这些属性将自动从序列化对象中省略。序列化是一个方面，由系统中的其他代码实现，并通过应用“配置”属性（装饰）应用于您的类。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-28T03:52:12.680

AOP 是一种更好地模块化应用程序以实现跨越多个边界的功能的方法。AOP 是封装这些特性并遵循单一职责的另一种方式，将这些横切关注点（日志记录、错误处理等）移出应用程序的主要组件。如果使用得当，AOP 可以随着时间的推移在您的应用程序中带来更高级别的可维护性和可扩展性。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-04-24T15:23:42.027

有一个AOP的例子，它以spring AOP为例。这个例子很容易理解。

Spring AOP（面向切面编程）框架用于模块化切面中的横切关注点。简单来说，它只是一个拦截器，用来拦截一些进程，比如当一个方法执行时，Spring AOP可以劫持正在执行的方法，并在方法执行之前或之后添加额外的功能。

参考：[http ://www.mkyong.com/spring/spring-aop-examples-advice/](http://www.mkyong.com/spring/spring-aop-examples-advice/)

# php - 将复选框值插入数据库

> ID：242181
> 
> 赞同：1
> 
> 时间：2008-10-28T03:41:47.943
> 
> 标签：php, sql, mysql

我有一个带有几个复选框的表单，这些复选框的值是从数据库中提取的。我设法在表单中显示它们，为每个分配一个适当的值，但不能将它们的值插入其他数据库。

这是代码：

```
<form id="form1" name="form1" method="post" action="">
<?php
$info_id = $_GET['info_id'];
$kv_dodatoci = mysql_query("SELECT * FROM `dodatoci`") or die('ERROR DISPLAYING: ' . mysql_error());
while ($kol = mysql_fetch_array($kv_dodatoci)){
    $id_dodatoci = $kol['id_dodatoci'];
    $mk = $kol['mk'];

    echo '<input type="checkbox" name="id_dodatoci[]" id="id_dodatoci" value="' . $id_dodatoci . '" />';
    echo '<label for="' . $id_dodatoci.'">' . $mk . '</label><br />';
  }
?>
<input type="hidden" value="<?=$info_id?>" name="info_id" />
<input name="insert_info" type="submit" value="Insert Additional info" />
</form>
<?php
if (isset($_POST['insert_info']) && is_array($id_dodatoci)) {
    echo $id_dodatoci . '<br />';
    echo $mk . '<br />';

    // --- Guess here's the problem  ----- //
    foreach ($_POST['id_dodatoci'] as $dodatok) {
         $dodatok_kv = mysql_query("INSERT INTO `dodatoci_hotel` (id_dodatoci, info_id) VALUES ('$dodatok', '$info_id')") or die('ERROR INSERTING: '.mysql_error());
     }
} 
```

我的问题是遍历所有复选框，并为每个选中的复选框在数据库中填充单独的记录。其实我不知道如何识别哪个框被选中，并将适当的值放入db中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T03:58:35.523

你可以判断一个复选框是否被选中，因为它会有一个值。如果没有被选中，它根本不会出现在 PHP 中的 request/get/post 中。

您可能想要做的是检查它的价值并在此基础上工作。默认情况下，该值是字符串 'on'，但可以通过 HTML 中的 value='' 属性进行更改。

以下是一些可能有帮助的代码片段（不完全是生产质量，但它有助于说明）：

**HTML：**

```
<input type='checkbox' name='ShowCloseWindowLink' value='1'/> Show the 'Close Window' link at the bottom of the form. 
```

PHP：

```
if (isset($_POST["ShowCloseWindowLink"])) {
    $ShowCloseWindowLink=1;
} else {
    $ShowCloseWindowLink=0;
}

        .....

$sql = "update table set ShowCloseWindowLink = ".mysql_real_escape_string($ShowCloseWindowLink)." where ..." 
```

（假设一个带有 ShowCloseWindowLink 列的表将接受 1 或 0）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T08:31:30.307

好吧，正如 Eli 所写，当未选中复选框时，未设置 POST。

我有时会使用一个额外的隐藏字段（-array）来确保我有一个页面上所有复选框的列表。

例子：

```
<input type="checkbox" name="my_checkbox[<?=$id_of_checkbox?>]">
<input type="hidden" name="array_checkboxes[<?=$id_of_checkbox?>]" value="is_on_page"> 
```

所以我进入了 $_POST：

```
array(2){
 array(1){"my_checkbox" => array(1){[123]=>"1"}}
 array(1){"array_checkboxes" => array(1){[123]=>"is_on_page"}}
} 
```

我什至得到第二行，当未选中复选框时，我可以使用以下内容遍历所有复选框：

```
foreach ($_POST["array_checkboxes"] as $key => $value)
{
  if($value=="is_on_page")
  {
    $value_of_checkbox[$key] = $_POST["my_checkbox"][$key];
    //Save this value
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T10:24:47.957

额外说明：您对 ID 和`<label>`. `<label>`的“for”属性应该指向一个ID，而不是一个值。您还需要每个元素的唯一 ID。您发布的代码将无法验证。

此外，您根本没有验证您的代码。至少，在输出之前对输入执行`htmlspecialchars()`or操作，在将数据插入数据库之前执行操作。`htmlentities()`[`mysql_real_escape_string()`](http://php.net/mysql_real_escape_string)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T01:54:50.450

这是我需要的循环。我意识到我需要一个循环遍历每个带有`$i`变量的键。

```
if(isset($_POST['id_dodatoci'])){
    $id_dodatoci=$_POST['id_dodatoci'];
    $arr_num=count($id_dodatoci);
    $i=0;
    while ($i < $arr_num)
    {
        $query="INSERT INTO `dodatoci_hotel`(id_dodatoci,info_id) 
            VALUES ('$id_dodatoci[$i]','$info_id')";
        $res=mysql_query($query) or die('ERROR INSERTING: '.mysql_error());
        $i++;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T19:32:25.277

**第二个答案：**

你可能会做这样的事情：

HTML：

```
echo '<input type="checkbox" name="id_dodatoci[]" value="'.$id_dodatoci.'" />'; 
```

PHP：

```
if ( !empty($_POST["id_dodatoci"]) ) {
    $id_dodatoci = $_POST["id_dodatoci"];
    print_r($id_dodatoci);
    // This should provide an array of all the checkboxes that were checked.
    // Any not checked will not be present.
} else {
    // None of the id_dodatoci checkboxes were checked.
} 
```

这是因为您对所有复选框使用相同的名称，因此它们的值将作为数组传递给 php。如果您使用不同的名称，那么每个名称都有自己的发布键/值对。

这也可能有帮助：

[http://www.php-mysql-tutorial.com/php-tutorial/using-php-forms.php](http://www.php-mysql-tutorial.com/php-tutorial/using-php-forms.php)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-28T21:33:44.317

还有一些很少有人使用但在 HTML 中非常好的东西，你可以拥有：

```
<input type="hidden" name="my_checkbox" value="N" />
<input type="checkbox" name="my_checkbox" value="Y" /> 
```

瞧*！*- 复选框的默认值...！

# javascript - 如何使用 Javascript 弹出打印对话框？

> ID：242182
> 
> 赞同：176
> 
> 时间：2008-10-28T03:42:39.157
> 
> 标签：javascript

我有一个带有“打印”链接的页面，该链接将用户带到对打印机友好的页面。客户希望在用户到达打印友好页面时自动出现一个打印对话框。我怎么能用javascript做到这一点？

* * *

## 回答 #1

> 赞同：268
> 
> 时间：2008-10-28T03:44:54.363

```
window.print(); 
```

除非您的意思是自定义外观的弹出窗口。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-10-28T03:45:35.407

你可以做

```
<body onload="window.print()">
...
</body> 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-06-27T20:26:53.480

我喜欢这个，这样你就可以添加你想要的任何字段并以这种方式打印。

```
function printPage() {
    var w = window.open();

    var headers =  $("#headers").html();
    var field= $("#field1").html();
    var field2= $("#field2").html();

    var html = "<!DOCTYPE HTML>";
    html += '<html lang="en-us">';
    html += '<head><style></style></head>';
    html += "<body>";

    //check to see if they are null so "undefined" doesnt print on the page. <br>s optional, just to give space
    if(headers != null) html += headers + "<br/><br/>";
    if(field != null) html += field + "<br/><br/>";
    if(field2 != null) html += field2 + "<br/><br/>";

    html += "</body>";
    w.document.write(html);
    w.window.print();
    w.document.close();
}; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-28T03:50:35.290

我这样做是为了确保他们记得打印横向，这对于许多打印机上的许多页面都是必需的。

```
<a href="javascript:alert('Please be sure to set your printer to Landscape.');window.print();">Print Me...</a> 
```

或者

```
<body onload="alert('Please be sure to set your printer to Landscape.');window.print();">
etc.
</body> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-05-24T16:43:40.773

如果您只有一个没有点击事件处理程序的链接：

```
<a href="javascript:window.print();">Print Page</a> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-11-05T01:30:07.317

您可以将其绑定到按钮或页面加载。

```
window.print(); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-11-14T07:56:30.733

我知道答案已经给出。但我只是想详细说明在 Blazor 应用程序（剃刀）中执行此操作......

您需要注入 IJSRuntime，以执行 JSInterop（从 C# 运行 javascript 函数）

在您的剃须刀页面中：

```
@inject IJSRuntime JSRuntime 
```

注入后，创建一个带有单击事件的按钮，该事件调用 C# 方法：

```
<MatFAB Icon="@MatIconNames.Print" OnClick="@(async () => await print())"></MatFAB> 
```

（或者如果你不使用 MatBlazor 更简单的东西）

```
<button @onclick="@(async () => await print())">PRINT</button> 
```

对于 C# 方法：

```
public async Task print()
{
    await JSRuntime.InvokeVoidAsync("printDocument");
} 
```

现在在您的 index.html 中：

```
<script>
    function printDocument() {
        window.print();
    }
</script> 
```

需要注意的是，onclick 事件是异步的原因是因为 IJSRuntime 等待它的调用，例如 InvokeVoidAsync

PS：如果您想在 asp net core 中显示消息框，例如：

```
await JSRuntime.InvokeAsync<string>("alert", "Hello user, this is the message box"); 
```

要有一个确认消息框：

```
bool question = await JSRuntime.InvokeAsync<bool>("confirm", "Are you sure you want to do this?");
    if(question == true)
    {
        //user clicked yes
    }
    else
    {
        //user clicked no
    } 
```

希望这可以帮助 ：）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-10T01:35:22.870

```
<script>
    const _print = () => {
        window.print();
    }
</script> 
```

或者

```
<body onload="window.print();"></body> 
```

在此处查看文档：[https ://developer.mozilla.org/en-US/docs/Web/API/Window/print](https://developer.mozilla.org/en-US/docs/Web/API/Window/print)

* * *

## 回答 #9

> 赞同：-7
> 
> 时间：2016-07-28T11:40:15.157

如果有问题：

```
 mywindow.print(); 
```

替代使用：

```
'<scr'+'ipt>print()</scr'+'ipt>' 
```

满的：

```
 $('.print-ticket').click(function(){

        var body = $('body').html();
        var ticket_area = '<aside class="widget tickets">' + $('.widget.tickets').html() + '</aside>';

        $('body').html(ticket_area);
        var print_html = '<html lang="tr">' + $('html').html() + '<scr'+'ipt>print()</scr'+'ipt>' + '</html>'; 
        $('body').html(body);

        var mywindow = window.open('', 'my div', 'height=600,width=800');
        mywindow.document.write(print_html);
        mywindow.document.close(); // necessary for IE >= 10'</html>'
        mywindow.focus(); // necessary for IE >= 10
        //mywindow.print();
        mywindow.close();

        return true;
    }); 
```

# html - 拖放块编辑就地html

> ID：242187
> 
> 赞同：1
> 
> 时间：2008-10-28T03:44:26.300
> 
> 标签：html, edit-in-place

我需要编写一个小型 Web 应用程序，允许客户在 html 中选择预定义的布局模板并能够对其进行修改。该应用程序需要允许客户将块文本添加到预定义的区域和图像。块文本需要能够根据客户需要重新排序。例如。上移、下移或移至侧边栏。由于电子邮件程序不喜欢 div 和 css，因此完整的布局将能够转换为表格布局和内联 css。我不知道我应该在哪里寻找信息来实现这一点，谁能告诉我如何做到这一点。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T04:10:54.623

当然，我可能误会你了。您可以考虑使用标准的内容管理系统，例如：

基于linux的

*   [joomla](http://www.joomla.org/)
*   [曼波](http://mamboserver.com)

基于 Windows

*   [点网核弹](http://www.dotnetnuke.com/)
*   [共享点](http://www.microsoft.com/Sharepoint/default.mspx)

这些系统具有您所描述的内置功能，并具有额外的好处，即它们中的大多数都是免费和开源的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T04:06:25.350

我不确定为什么有人对你投了反对票，但请查看[script.aculo.us](http://script.aculo.us/)或[Yahoo 的 YUI 之类的 JavaScript 框架](http://developer.yahoo.com/yui/)

这些将大大有助于创建您需要的界面。他们也有很多例子。

Yahoo 框架有一个就地 html 编辑器（我认为这就是您所要求的）。另一个编辑是[fckeditor](http://www.fckeditor.net/)。

# sql - SQL Server 中 Cursor Auto Fetch 的用途是什么？

> ID：242223
> 
> 赞同：0
> 
> 时间：2008-10-28T04:02:44.157
> 
> 标签：sql, sql-server

SQL Server 中 Cursor Auto Fetch 的用途是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T04:10:06.967

这不是你经常遇到的事情。我相信这是一个 ADO 选项，它告诉 SQL Server 在您打开游标后立即开始获取结果。但是，[文档](http://technet.microsoft.com/en-us/library/aa173487(SQL.80).aspx)并没有太大帮助！

# java - Java有什么好处？

> ID：242225
> 
> 赞同：9
> 
> 时间：2008-10-28T04:03:16.713
> 
> 标签：java

我总是听说程序员试图为工作选择合适的工具。我从来没有用过Java编程，所以我想知道它有什么好处？为什么这么受欢迎？我应该用它做什么？

我只是休闲地编程。有什么让它特别有趣的吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-28T04:05:20.937

我认为在 12 年左右之后，“一次编写，随处运行”的口头禅*几乎*是正确的。编写 Java 代码几乎可以将您与部署它的系统的平台相关方面隔离开来。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-28T04:05:04.400

*   可移植性
*   令人难以置信的图书馆广度
*   自下而上的安全性
*   表现
*   鲁棒性

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-28T04:08:56.360

庞大的社区、大量的帮助、库、IDE 是巨大的（这是一件好事）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-28T04:18:13.157

对于一个普通的程序员来说，Java 可以教授很多关于面向对象编程的知识，并且通常会鼓励良好的编程习惯，而无需像 C++ 那样担心许多“杂乱”的细节（指针、内存管理）。

调试“灾难性”错误也更容易一些。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-28T04:30:07.160

Java*非常擅长*集成——有一些规范和实现可以与您可能在“企业”环境中遇到的多种系统集成。

相对于流行的高级语言，它并不是一种真正“有趣”的语言。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-28T06:24:04.433

这似乎得到了健康的答案，但您可能还想看看[“人们为什么使用 Java？”](https://stackoverflow.com/questions/213757/why-do-people-use-java)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-28T04:04:46.023

在我看来，跨平台是最相关的好处。

Java 的主要目标是创建一种可以在任何地方运行的编程语言。目标是 GUI 应用程序。然而这从未发生过，因为一开始环境太慢（现在已经改进了），但在服务器端证明是正确的，因为产品开发可以在 PC 中完成，并且部署非常容易，因此开发成本降低了很多。昂贵的硬件。

它也很容易开发，因为它被设计为具有类似 C++ 的语法，但在虚拟平台上运行以避免特定于平台的代码。最初的惩罚是执行速度，因为它是解释的，但是一个又一个版本的解释器变得越来越快，甚至 MS 都在 java 之后建模它的下一代开发并称之为 .net

**此外**，您可以在[此处阅读 Java 设计目标](http://java.sun.com/docs/white/langenv/Intro.doc2.html)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-28T07:23:02.147

Java 是一门很好的语言，但它的标准库的重要性是次要的。jdk 可能不是有史以来最优雅的套件，但它广泛、强大且可靠。用Java编程语言很简单。适当重用 jdk 的编程就是它的全部意义所在。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-09T20:10:15.490

我想补充一点：Java 对早期版本保持良好的兼容性。这意味着，您的 Java 项目在大多数情况下都可以编译和运行，在新版本上没有任何问题。这似乎是一个小问题，但 API 和语言的这种稳定性有助于围绕 Java 建立一个大型社区，包括良好的工具支持。

其他人已经提到了其他要点：

*   便携性好
*   几乎任何东西都有很多图书馆
*   易于调试和容易发现问题

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-28T04:17:28.370

使用 Java 的原因只有两个：

*   Java 虚拟机（热点）。
*   大量可用的库和工具。

[但是，还有其他语言可以在 JVM 上运行，并且比 Java 更好地利用 Java 库。](http://scala-lang.org)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-28T18:14:23.343

使用 Java 一段时间后，我得出的结论是，它写起来很有趣，在一些非常令人讨厌的方面受到限制，而且它的性能很好，尽管看起来很多程序都因为糟糕的设计而瘫痪。

我不确定后者是Java的功能，还是Java的效果。

在任何一种情况下，除了上述所有好处之外，它对于做“网络”相关的事情都非常有用。使用简化的界面处理资源，而不管特定资源在“哪里”，等等......

它绝不是万能的锤子。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-10-28T05:20:13.613

oop 提供了传统编程中不具备的封装、继承、多态性。oop 更接近于现实生活中的编程表示 1\. 关系可以使用继承来表示 2\. 由于增加了模块化，程序开发变得容易

# css - 使用像“正确”这样的类名被认为是不好的做法吗？

> ID：242255
> 
> 赞同：4
> 
> 时间：2008-10-28T04:25:50.850
> 
> 标签：css, xhtml, semantics

如果我有诸如“left”、“right”、“clear”和 xhtml 之类的类名

```
<a href="index.php" class="right continueLink">Continue</a> 
```

像 CSS 一样

```
.right {
float: right;
} 
```

我知道这不是一个语义名称，但有时它确实让事情变得更容易。

无论如何，你的想法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-28T04:50:13.407

我不认为这是一个很好的主意。现在，当您（或未来的维护者）去更改您的网站布局时，您要么必须更改`.right`为`{float:left;}`（显然是个坏主意），要么浏览所有 HTML 文件并更改`right`为`left`.

为什么您希望该特定链接正确浮动，而其他链接不浮动`.continueLink`？使用该问题的答案为该链接选择一个更具描述性的类名。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-28T05:14:38.817

css 是关于html 页面***结构的展示。***

这意味着它的类应该代表文档的结构（'article'、'extra-links'、'glossary'、'introduction'、'conclusion'，...）。

你应该避免任何与*物理*表示相关的类（'left'、'right'、'footnotes'、'sidenotes'...），因为正如[Zen Garden](http://www.csszengarden.com/)清楚地说明的那样，你可以决定将任何 div 放在非常不同和不同的方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T05:35:19.710

纯粹主义者会说不要这样做，实用主义者会说没关系。但是纯粹主义者会定义`.right`为`float: left`吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T04:28:33.997

建议避免使用与 CSS 规范中的值相同的名称以避免混淆。特别是在多个开发人员在同一个应用程序上工作的情况下。

除此之外，我认为没有问题。我会像这样限定右侧或左侧名称：menuleft、menuright 等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T07:46:01.413

作为一个纯粹主义者，我说不，不要这样做。由于前面提到的原因。

作为一个实用主义者，我只想说，我从来没有见过涉及没有 css 的纯 html 更改或没有 html 的纯 css 的网站返工，仅仅是因为这两个部分都是在考虑另一个部分的情况下开发的。因此，实际上，如果其他人需要更改页面，我敢打赌我的薪水他们会同时更改 html 和 css。

以上是周围的同事纯粹主义者经常倾向于忽略的事情，即使这是现实。但底线；不，避免使用诸如“right”之类的类名。:-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T09:55:53.257

.right 和其他类似的类，当然可以快速编写一个`float:right`附加规则的标签，但我认为这种方法的缺点多于优点：

通常带有单个的类样式`float:right;`会缺少某些东西，如果另一个类规则中包含 a，您的示例只会向右浮动`display:block`，因为“a”标签不是块级元素。浮动元素也经常需要附加宽度和高度。这意味着您的示例中的代码需要额外的代码来完成它所说的，并且当您必须更改您的 css 时，您必须在两个地方进行搜索。

我倾向于通过将页面划分为具有唯一 id 的不同 div 标签来设置我的 html 样式，然后像这样通过继承来设置这些 div 中的元素样式。

```
div#sidebar { float:right; width:200px; }
div#sidebar ul { list-style-type:none; } 
```

这使得对我的 css 文件进行分区成为可能，因此很容易找到样式化特定标记的 css 代码，但是如果您引入 .right 和其他类，您开始将规则分散到 css 文件的不同区域，使网站更难维护。

我认为拥有一个非常通用的类的想法源于希望通过更改样式表中的一些规则来更改网站的整个布局，但我必须说，在我 8 年的网站开发中30 多个不同的网站，我从未更改过网站的布局并重用 HTML。

我无数次所做的就是对页面区域进行小幅调整，这可能是由于设计上的微小变化，也可能是由于新浏览器的引入。所以我完全赞成将我的 css 分成整齐的块，这样可以很容易地找到我正在寻找的规则，而不是将代码放在不同的地方来实现更短的样式表。

问候杰斯珀豪格

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-28T10:09:05.337

是的，从语义上讲这是错误的，但是，例如，有时我将图像定位在正文块中，我会给它们“正确”的类。

也许“alt”是一个更合适的类名。

# c# - 使用 LINQ 执行更新

> ID：242264
> 
> 赞同：2
> 
> 时间：2008-10-28T04:32:49.743
> 
> 标签：c#, linq

我正在研究 LINQ——试图理解基本模型（对我来说这似乎很酷）。下面的代码是在提交更新之前要执行的代码。

```
 Linq01.Account acc = context.Accounts.Single( pc => pc.AccountID == AccountID );
   acc.Name = textboxAccountNameRead.Text.Trim();
   context.SubmitChanges(); 
```

到现在为止还挺好。但是如果 Single() 方法失败——如果没有找到帐户 ID，你会怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-28T04:35:30.753

你应该使用`SingleOrDefault`，如果查询没有返回值，你可以检查它是否为空：

```
var acc = context.Accounts.SingleOrDefault(pc => pc.AccountId == AccountId);
if(acc != null)
{
  acc.Name = textboxAccountNameRead.Text.Trim();
  context.SubmitChanges();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T06:27:26.190

添加到 Slace 的答案中，如果您调用 Single，然后找不到帐户 ID，它将引发异常。在*某些*情况下，这比返回 null 并显式处理它更合适。

# html - 如何嵌入不显眼的闪光灯？

> ID：242276
> 
> 赞同：2
> 
> 时间：2008-10-28T04:44:26.240
> 
> 标签：html, flash

我有一个透明的嵌入式闪光灯，所以它看起来像是背景的一部分。我通过将 wmode 设置为透明来实现这一点。

我的问题是闪光灯下方的区域变得无法访问，即使闪光灯是透明的。因此，我无法单击 flash 对象下的任何链接或按钮。

如何让闪光灯不显眼？

说明：
- 闪光灯是透明的，但它有一个动画显示在背景中。
- wmode 设置为透明允许您在 IE 中单击下面的内容，但不能在 Firefox 中单击。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-28T05:24:17.517

问题是在您的文档中，包含 Flash 动画的`object`/`embed`位于您需要访问的元素之上。您需要将这些元素放在 Flash 动画之上，而不是相反。

做到这一点的方法是将对象设置`wmode`为不透明，并使用 CSS`z-index`属性将其设置为`z-index`低于`z-index`您想要浮动在其上的任何元素的值——您可以在 CSS 中或仅使用内联`style=""`属性来执行此操作。

这是[一个使用 SWFObject](http://www.pipwerks.com/lab/swfobject/z-index/2.0/index.html)创建`object`/`embed`标记的示例，但如果您只是将它们硬编码到 HTML 中，同样的原则也适用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T04:56:02.083

我不知道会有不显眼的闪光灯这样的东西。

更严肃的一点是：无论如何，你想用一层闪存来完成什么？

我建议退后一步，将页面作为一个整体来查看。如果需要 Flash 下面的东西，则将 Flash 放到其他地方或用页面中的实际元素替换它以达到相同的目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T04:59:04.323

闪电侠的目的是什么？如果它没有做任何可见的事情，那么您可以将其设置为 1 像素大小和/或将其放入绝对位于屏幕之外的 div 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T05:20:14.953

我想我可能已经找到了自己问题的答案。

有一个名为[Unobtrusive Flash Objects (UFO)](http://www.bobbyvandersluis.com/ufo/index.html)的 javascript 库，它已被弃用，现在是[swfobject](http://code.google.com/p/swfobject/)。

我会试一试并报告。

# asp.net-mvc - ASP.NET MVC 的任何页面导航助手？

> ID：242282
> 
> 赞同：6
> 
> 时间：2008-10-28T04:58:25.683
> 
> 标签：asp.net-mvc, navigation

是否有任何用于页面导航的 html 助手。例如。如果我有 1000 条记录要显示，我想显示过滤后的集合下的 Previous 1 2 3 4 ... etc Next 链接内容。

有人知道那里有什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T15:45:42.507

如果您从 JSON 数据创建数据表，我强烈推荐 YUI（雅虎 UI 库）DataTable 组件（[http://developer.yahoo.com/yui/datatable/](http://developer.yahoo.com/yui/datatable/)）。它的分页非常好，您可以选择返回整个记录集以开始，然后在所有客户端分页或从服务器返回分页集。

可能不适合您的情况，但只是想我会提到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T10:23:02.377

Checkout [Paging with ASP.NET MVC](http://blogs.taiga.nl/martijn/Default.aspx) , [PageList Strikes Back](http://www.squaredroot.com/post/2008/07/08/PagedList-Strikes-Back.aspx) and [Create a Page HTML Helper](http://weblogs.asp.net/stephenwalther/archive/2008/09/18/asp-net-mvc-tip-44-create-a-pager-html-helper.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T05:29:03.357

我的[Dynamic Data for MVC 示例应用程序](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=18764)中有一个分页网格，但该网格是手工渲染的。数据使用 PagedList，它来自 Rob Conery（我认为他是从 ScottGu 那里得到的）。

我一直在考虑 MVC 的分页网格助手可能是什么样的......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T05:44:12.827

到目前为止，我为分页所做的是创建一个 Pager 控件，它需要一个分页 url、用于更新的 html 元素 id、页码、页面大小和总数。

分页 url 的形式为控制器/动作，其中动作返回一个 html 字符串（呈现的数据页面）

寻呼机附加页面的 javascript 链接列表。这些链接调用一个基于 jQuery 的 ajax 函数，该函数会点击分页 url。每次页面单击都会将 html 元素的当前内容替换为 ajax 调用的结果。像这样的东西：

```
public string Render()
{
    var buffer = new StringBuilder( 1000 );
    buffer.AppendLine( @"<ul class=""datatable_pager"">" )
        .AppendLine( "\t<li>Additional Pages:</li>" );
    int numberOfPages = TotalItemCount % PageSize == 0 ? TotalItemCount / PageSize : TotalItemCount / PageSize + 1;

    for( int i = 0; i < numberOfPages; i++ )
    {
        AppendPageLink( buffer, i );
    }

    buffer.AppendLine( "\t</ul>" );
    AppendPagingJS( buffer );

    return buffer.ToString( );
}

private void AppendPageLink( StringBuilder buffer, int i )
{
    buffer.Append( "\t\t<li><a href=\"" )
    .Append( PagingLink.Replace( "$PAGE$", i.ToString( ) ) )
    .Append( "\">" )
    .Append( i.ToString( ) )
    .Append( "</a>" )
    .AppendLine( "\t\t</li>" );
}

private void AppendPagingJS( StringBuilder buffer )
{
    buffer.AppendLine( @"
        <script type=""text/javascript"">
        function page( page, size, updateElement )
        {
            $.post( '" + PagingUrl + @"',
                {
                    pageNumber: page, 
                    pageSize: size,
                },
                function(response) 
                {
                    $(""#"" + updateElement).html(response);
                },
                ""html""
            );
        }
        </script>" );
} 
```

javascript 发布到分页 url，因此该操作需要执行以下操作：

int.TryParse(Request.Params["pageNumber"], out page) int.TryParse(Request.Params["pageSize"], out size))

并将结果与​​您的数据访问组件一起使用以获取数据页面，将其呈现为 html 并返回它。

希望有帮助，如果需要，我可以扩展它。

# vim - 你用 vim 做过的最能帮助你编程的事情是什么？

> ID：242284
> 
> 赞同：8
> 
> 时间：2008-10-28T05:01:32.977
> 
> 标签：vim

上网的时候，我知道有人用 vim 做了河内塔。哇！！！

你们能分享一下你在 vim 中所做的所有很酷的事情吗？

编辑：不确定使用 vim 的河内塔解决方案是否有用。但我认为应该重新打开这个问题，让人们评论他们使用 vim 所做的任何有用的事情。为了我？请看下面我的回答。（-：

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-29T06:37:07.433

`vim`具有一组与开发工具集成的命令，例如`make`、`gcc`和`ctags`. 您可以构建您的项目，导航到警告和错误，并跳转到函数/变量定义，而无需离开编辑器：

*   `:make`构建项目。
*   `:cl`列出警告和错误。
*   `:cc`将您带到生成当前错误的源代码中的 to 行。
*   `:cn`导航到下一个错误。
*   `:cp`导航到上一个错误。
*   `:tag name`导航到令牌的定义`name`。（请参阅`man ctags`生成标记索引；有时`make tags`会自动执行此操作。）
*   按下`Ctrl+]`导航到光标下标记的定义。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-29T00:05:10.517

我在我的[博客](http://www.spinellis.gr/blog)和[讲义](http://www.dmst.aueb.gr/dds/enotes.html)中使用 vim 对代码进行语法着色。单个 Perl 行

```
system  "$vimrt\\gvim.exe", qq{ 
  -c "edit /tmp/tmpcode.$ext " 
  -c "source $vimrt/syntax/2html.vim" 
  -c "write! /tmp/tmpcode.html" 
  -c "qa!"}; 
```

将代码转换为颜色漂亮的 HTML。我知道有独立的工具可以做到这一点，但是我的系统上已经安装了 vim，所以这是一个少安装的工具。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-05T15:20:21.107

与其他非模态文本编辑器相比，我发现自己在 vim 中努力提高效率，直到我了解了“文本对象”。理解这个概念确实提高了我的工作效率，也给了我一种看待文本的新方式，这反过来又让我更容易深入理解我以前只是短暂理解的其他 vim 概念。

:help 文本对象

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-28T23:58:47.050

我在一个有大量日志文件的系统上工作。我们说的是 30,000 条 10MB 日志。

每天！

区分来自中间件（同一家公司但自定义滚动）的日志消息和我们的应用程序变得乏味。

直到我写了一些自定义的 vim 语法解析，所以任何以绿色显示的 vim 都来自中间件（由戛纳附近 Sophia Antipolis 的人完成），而不是任何以蓝色显示的 vim 来自我们坐在上面的应用程序软件SA 代码的顶部。

我还添加了突出显示以真正使异常在阅读背景上以白色字体突出！

让生活变得如此轻松！这并不难做到！

谢谢vim！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-29T00:11:25.293

几个月前，我编写了一个 vim 脚本来[保存我所有编辑的完整历史记录](http://www.spinellis.gr/blog/20080825/)，这样我就可以检查和测量我的编程性能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-29T01:41:42.693

我最近经常使用 vim 来编辑 XML 文件。我得到了用于 vim 工作的[xmledit插件。](http://www.vim.org/scripts/script.php?script_id=301)现在 vim 为我创建了结束标记，我可以将突出显示的文本包含在 XML 标记中，并跳转到平衡 XML 标记。它节省了大量重复输入，减少了错误，并提高了我的工作效率。

# css - 在您花费数小时尝试修复 IE6 中的错误之前，您希望知道什么

> ID：242286
> 
> 赞同：16
> 
> 时间：2008-10-28T05:03:49.290
> 
> 标签：css, xhtml, internet-explorer-6

我的必须是浮动和边距错误......

如果你浮动一个元素，然后为它指定一个边距，它会使边距加倍。

解决方案是添加`display: inline`到元素中。这将停止双边距，所有其他浏览器将忽略它，因为只有块级对象可以浮动。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-28T05:06:43.917

我希望我知道我会花费数小时来一次又一次地修复 IE 6 中的一个错误，而且我真的会更乐意提供比萨饼。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-28T06:53:33.360

我希望我知道[quirksmode.org](http://www.quirksmode.org/)。兼容性表、错误报告、javascript 示例都非常有用。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-28T14:02:45.473

不要先为 IE6 编码。这就是疯狂的道路。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-11T00:48:44.693

我希望我知道许多 IE 6 错误行号减一。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-28T06:18:35.770

第一件事：hasLayout 如果我从一开始就知道这一点，我的大部分担忧都会得到解决。我什至认为它是比 IE6 的愚蠢盒子模型更糟糕的问题。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-28T10:12:09.590

我希望我知道[Position is Everything](http://www.positioniseverything.net/explorer.html)，但特别[是 peekaboo 错误](http://www.positioniseverything.net/explorer/peekaboo.html)一直困扰着我。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-10-28T14:00:36.070

如果你真的肛门并在它上面花费大量时间它会得到回报，然后你就会成为一个 IE 大师，除了你已经成为的悲伤的自我之外什么都不怕......

虽然用你惊人的 IE 错误修复能力给人们留下深刻印象是件好事......

1.  大多数 IE 错误可以通过使用不同的（通常更好的）CSS 方法和超级干净的逻辑 xhtml 来避免
2.  始终使用隐藏的溢出清除浮动（或仅用于 IE 的 hasLayout）
3.  了解 hasLayout 是什么（基本上是一个让 IE 大吃一惊的 CSS 属性）
4.  当您开始开发网站时，请始终检查 IE6，直到您成为专业人士；¬P

不幸的是，我确实培训了一个由 6 名开发人员组成的小团队，经验是唯一能真正帮助解决这些问题的因素之一，保持冷静，在谷歌上进行良好的研究，如果你真的遇到了一个好的问题，你可以将你的问题发布到社区问题的演示。

不错的链接>

1.  [http://css-tricks.com/ie-css-bugs-thatll-get-you-every-time/](http://css-tricks.com/ie-css-bugs-thatll-get-you-every-time/)（虽然我推荐 Bob Osola 的 PNG 修复*/-0*）
2.  [http://www.gtalbot.org/BrowserBugsSection/](http://www.gtalbot.org/BrowserBugsSection/)（惊人而有趣……太棒了！）

祝你好运！

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-11-11T00:18:40.747

我希望我知道为什么微软如此讨厌我。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-10-28T10:01:32.887

我希望我知道

*   包含仅适用于 IE 的样式表的条件注释
*   xhtml 标头使 IE 以兼容模式呈现
*   盒子模型问题，让我知道在我的 IE 样式表中放什么

在了解了这些东西之后，我并没有真正花很多时间修复 IE6 中的问题

.豪格

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-10-28T05:08:52.510

应该支持[透明PNG ...](http://entropymine.com/jason/testbed/pngtrans/)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-11-11T01:02:29.847

下划线技巧

如果你在 css 属性前面放了一个 _，它只会被 ie6 读取。

IE。_border: 1px 实心#000000; 仅在 ie6 中创建边框

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-28T05:34:32.210

可能 SELECT 元素不会以正确的 z 顺序呈现。

例如，如果您有一个浮动 DIV，其 z 顺序较高，覆盖在 select 顶部 - SELECT 元素仍将呈现在 DIV 顶部。

真气。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-12-11T01:06:02.863

如果在 img 标签的结尾和结束的 td 标签之间有任何空白，则渲染怪癖会导致表格单元格中的图像下方有一个小空白。

这呈现正确：

```
<td><img src="myimage.jpg"></td> 
```

这会导致错误：

```
<td>
<img src="myimage.jpg">
</td> 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-28T12:32:52.957

我希望我知道我的代码没有验证。或者 XHTML 中的 XML 声明将 IE 置于怪异模式。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-28T14:26:43.350

我们遇到的主要问题是安排足够的“在 IE6 中修复”时间。这一点，以及设计师倾向于想出在 Flash 中容易实现而在 CSS 中难以实现的东西，这让我们花费了很多天的额外工作。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-28T05:42:25.110

[http://www.pushuptheweb.com/](http://www.pushuptheweb.com/)或许多其他推动放弃 IE6 支持的网站之一。我知道为 IE6 访问者正确呈现网页是许多 Web 业务的核心，但迟早要付出一些代价。我只是不明白为什么 MS 不强制更新>.<

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-29T10:10:35.707

即使有世界上所有的 PNG hack，如果您在 div 中使用 PNG 作为背景（例如，制作一个带有圆形边框的面板），您将面临一个痛苦的世界。（链接和其他元素不可点击，IE6 在早期版本的 png dll 中崩溃等）

总之：如果您希望它在 IE6 中工作，请不要使用透明背景 PNG。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-11-10T23:50:08.040

DOCTYPES 在 IE 中的重要性，以及

[网络错误跟踪](http://webbugtrack.blogspot.com/search/label/IE)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-11-11T01:20:17.190

我希望我知道**Internet Explorer 是新的 Netscape Navigator 4.7.x**

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-12-17T18:11:51.807

# 1

hasLayout 和这个很好的解释： http: [//www.satzansatz.de/cssd/onhavelayout.html](http://www.satzansatz.de/cssd/onhavinglayout.html)

一旦我把头缠住，我就有了新的生命！确保包含元素 hasLayout 解决了我的绝大多数问题。

# 2

jQuery！！编写特定于 IE 的 CSS 已经够糟糕了，所以我很高兴我不再需要担心 JS。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-12-16T06:26:23.753

我希望我知道诸如[Firebug Lite](http://getfirebug.com/lite.html)和[HttpWatch 之](http://www.httpwatch.com/)类的开发工具，它们使调试变得更加容易。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-11-01T15:59:25.157

除了上面 Ross 和 Loque 给出的其他 IE 错误列表（gtalbot.com，多么漂亮的网站！

[http://css-discuss.incutio.com/?page=InternetExplorerWinBugs](http://css-discuss.incutio.com/?page=InternetExplorerWinBugs)

[http://webbugtrack.blogspot.com/search/label/IE7](http://webbugtrack.blogspot.com/search/label/IE7)

[http://www.enhanceie.com/ie/bugs.asp](http://www.enhanceie.com/ie/bugs.asp)

[http://channel9.msdn.com/wiki/internetexplorerprogrammingbugs/](http://channel9.msdn.com/wiki/internetexplorerprogrammingbugs/) （就像 gtalbot，你需要几个小时才能通过这个

* * *

还有，嘿，IE 8 beta 2

[http://css-class.com/test/bugs/ie/ie-bugs.htm](http://css-class.com/test/bugs/ie/ie-bugs.htm)

* * *

最后，IE 巫毒娃娃！

[http://www.flickr.com/photos/chisa/1349759901/](http://www.flickr.com/photos/chisa/1349759901/)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2010-12-31T08:00:13.830

*{边距：0; 填充：0；边框：无}

我向上帝发誓，这条线改变了一切。快！一切都是一样的大小！然后我钻进了你现在会找到我的兔子洞。奇妙。

# python - 如何将 svn 存储库内部版本号添加到 Python 代码？

> ID：242295
> 
> 赞同：3
> 
> 时间：2008-10-28T05:10:33.893
> 
> 标签：python, svn

> **编辑**：这个问题重复[了如何访问当前的 Subversion 内部版本号？](https://stackoverflow.com/questions/110175/how-to-access-the-current-subversion-build-number#111173)（感谢您的提醒，查尔斯！）

你好呀，

这个问题类似于[Getting the subversion repository number into code](https://stackoverflow.com/questions/16248/getting-the-subversion-repository-number-into-code)

区别在于：

1.  我想将修订号添加到 Python

2.  我想要存储库的修订版（不是签出的文件）

即我想从'svn info'的返回中提取修订号，如下所示：

$ svn信息

```
Path: .
URL: svn://localhost/B/trunk
Repository Root: svn://localhost/B
Revision: 375
Node Kind: directory
Schedule: normal
Last Changed Author: bmh
Last Changed Rev: 375
Last Changed Date: 2008-10-27 12:09:00 -0400 (Mon, 27 Oct 2008) 
```

我想要一个 375（修订版）的变量。将 $Rev$ 放入变量中以跟踪文件的更改很容易。但是，我想跟踪存储库的版本，并且我理解（并且似乎基于我的测试）$Rev$ 仅在文件更改时更新。

我最初的想法是使用 Python 内置的 svn/libsvn 模块，尽管我找不到任何关于如何使用它们的文档或示例。

或者，我想过调用“svn info”并将代码正则表达式，尽管这看起来相当残酷。:)

帮助将不胜感激。

谢谢和干杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T07:57:08.863

有一个名为`svnversion`subversion 的命令，旨在解决这类问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-28T12:28:20.533

直接从django窃取：

```
def get_svn_revision(path=None):
    rev = None
    if path is None:
        path = MODULE.__path__[0]
    entries_path = '%s/.svn/entries' % path

    if os.path.exists(entries_path):
        entries = open(entries_path, 'r').read()
        # Versions >= 7 of the entries file are flat text.  The first line is
        # the version number. The next set of digits after 'dir' is the revision.
        if re.match('(\d+)', entries):
            rev_match = re.search('\d+\s+dir\s+(\d+)', entries)
            if rev_match:
                rev = rev_match.groups()[0]
        # Older XML versions of the file specify revision as an attribute of
        # the first entries node.
        else:
            from xml.dom import minidom
            dom = minidom.parse(entries_path)
            rev = dom.getElementsByTagName('entry')[0].getAttribute('revision')

    if rev:
        return u'SVN-%s' % rev
    return u'SVN-unknown' 
```

酌情调整。您可能想要更改 MODULE 以获取您的代码模块之一的名称。

即使目标系统没有安装 subversion，此代码也能正常工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T07:52:08.217

Python 直接绑定到 libsvn，因此您根本不需要调用命令行客户端。有关更多详细信息，请参阅[此博客文章](http://jtauber.com/python_subversion_binding/)。

编辑：你基本上可以做这样的事情：

```
from svn import fs, repos, core
repository = repos.open(root_path)
fs_ptr = repos.fs(repository)
youngest_revision_number = fs.youngest_rev(fs_ptr) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T05:38:35.553

我使用了一种与此非常相似的技术，以便在我的 shell 中显示当前的颠覆修订号：

```
svnRev=$(echo "$(svn info)" | grep "^Revision" | awk -F": " '{print $2};')
echo $svnRev 
```

它对我来说效果很好。

为什么每次整个存储库的版本号递增时都希望 python 文件更改？如果一个来自 repo，另一个来自 tarball，这将使两个文件之间的差异变得烦人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T09:21:22.983

如果您想在一个源文件中有一个可以设置为当前工作副本修订版的变量，并且不会在 subversion 上重播并且在您运行程序时实际可用的工作副本，那么[SubWCRev](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-subwcrev.html)我是您的解决方案。

似乎还有一个名为[SVNWCRev的 linux 端口](http://svnwcrev.tigris.org/)

两者都使用工作副本的最高提交级别执行 $WCREV$ 替换。也可以提供其他信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T01:32:14.693

根据 CesarB 的回复和查尔斯提供的链接，我做了以下事情：

```
try:
  from subprocess import Popen, PIPE
  _p = Popen(["svnversion", "."], stdout=PIPE)
  REVISION= _p.communicate()[0]
  _p = None # otherwise we get a wild exception when Django auto-reloads
except Exception, e:
  print "Could not get revision number: ", e
  REVISION="Unknown" 
```

Golly Python 很酷。:)

# .net - 我应该从哪里下载 CorFlags.exe？

> ID：242304
> 
> 赞同：22
> 
> 时间：2008-10-28T05:19:14.157
> 
> 标签：.net, sdk, corflags

我正在运行 Windows Server 2008 64 位“工作站”，并且想要获取[corflags.exe](http://msdn.microsoft.com/en-us/library/ms164699%28v=vs.80%29.aspx)。我需要下载哪个 SDK？

我知道[.NET Framework 2.0 软件开发工具包 (SDK) (x64)](http://www.microsoft.com/downloads/details.aspx?FamilyId=1AEF6FCE-6E06-4B66-AFE4-9AAD3C835D3D&displaylang=en#Overview)和[适用于 Windows Server 2008 和 .NET Framework 3.5 的 Windows SDK，](http://www.microsoft.com/downloads/details.aspx?FamilyId=F26B1AA4-741A-433A-9BE5-FA919850BDBF&displaylang=en)但我希望能找到更小的东西，因为这些下载量很大。

另外关于 2.0 SDK 的注释似乎建议下载 3.5 的，我应该遵循吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-29T22:56:40.023

当前的正式版本在“ [Windows SDK for Windows Server 2008 and .NET Framework 3.5](http://www.microsoft.com/downloads/details.aspx?familyid=E6E1C3DF-A74F-4207-8586-711EBE331CDC&displaylang=en) ”中。（需要 XP 或更高版本。）

您只需要安装 .NET 开发工具子组件（开发者工具 -> Windows 开发工具 -> .NET 开发工具）。

这应该将 corflags.exe 放在 Program Files\Microsoft SDKs\Windows\v6.1\Bin

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-28T05:22:42.483

如果您安装 .NET 框架（您应该已经拥有它），它将位于 C:\Program Files (x86)\Microsoft.NET\SDK\v2.0\Bin\corflags.exe

想一想，您可能需要从*[.NET Framework 2.0 软件开发工具包 (SDK) (x64)](http://www.microsoft.com/downloads/details.aspx?familyid=1AEF6FCE-6E06-4B66-AFE4-9AAD3C835D3D&displaylang=en)*安装 Microsoft .NET 2.0 SDK——首先检查该文件。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-03-16T17:39:11.003

正如 rakslice 已经指出的那样，现在*[Microsoft Windows SDK for Windows 7 和 .NET Framework 3.5 SP1](http://www.microsoft.com/downloads/details.aspx?FamilyID=c17ba869-9671-4330-a63e-1fd44e0e2505&displaylang=en)*提供了最新版本的“适用于 Windows 7 和 .NET Framework 3.5 SP1 的 SDK” 。

这也可以在 Windows XP 和更高版本下运行，并且仍然包含 corflags.exe。

请注意，如果纯粹对 .NET 开发工具感兴趣，则`coreflags.exe`选择仅安装“.NET 开发工具”子组件，大约 75 MB 将被扔到硬盘上。这样做之后，我在`C:\Program Files\Microsoft SDKs\Windows\v7.0\Bin\CorFlags.exe`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T17:10:26.010

请参阅*[适用于 Windows Server 2008 和 .NET Framework 3.5 的 Windows SDK](http://www.microsoft.com/downloads/details.aspx?familyid=E6E1C3DF-A74F-4207-8586-711EBE331CDC&displaylang=en)*。.NET SDK 已与 Windows SDK 捆绑在一起。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-10T19:54:44.307

最新版本是 10.1。

从这里下载并安装[http://msdn.microsoft.com/windows/bb980924.aspx](http://msdn.microsoft.com/windows/bb980924.aspx)，

或者，像我一样，使用巧克力（[https://chocolatey.org/install](https://chocolatey.org/install)）：

```
choco install windows-sdk-10.1 
```

32位`CorFlags.exe`文件在

`C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.6 Tools`,

64位版本在

`C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.6 Tools\x64`.

# xml - 根元素缺失错误

> ID：242307
> 
> 赞同：0
> 
> 时间：2008-10-28T05:23:00.873
> 
> 标签：xml, xmlhttprequest

这是我在 JavaScript 中创建的 XML：

```
<root>
<GradeValueSet>
<GradeValueSetMaster SetId="0" SetName="wrwr" SetComments="werwrwr" mode="add"/>
<DetailInfo>
   <ChildInfo Name="This sfsf" Weightage="24"/>
   <ChildInfo Name="45654" Weightage="67"/>
 </DetailInfo>
</GradeValueSet>
</root> 
```

我将其发送到 .aspx 页面并执行以下操作：

```
 XmlDocument objXmlDoc = new XmlDocument();
            Request.InputStream.Position = 0;
            objXmlDoc.Load(Request.InputStream);
            objXmlDoc.Save("MyXML.xml"); 
```

它显示异常“缺少根元素”

我的 XML 格式不正确吗？我想我有一个有效的根元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T05:41:43.053

您可能想尝试将数据保存为 aspx 页面中的纯文本，以确保只有 xml 可以通过。

根据您将数据发送到页面的方式，可能会有不属于 xml 的额外信息。将数据保存为纯文本只是为了测试这将准确显示您获得的数据。

此外，在 XML 中，您实际上并不需要名为“root”的元素，它只是指结构中的顶级元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T05:25:15.160

抱歉忘记在上一篇文章中添加发送 XML

<root> <GradeValueSet> <GradeValueSetMaster SetId="0" SetName="wrwr" SetComments="werwrwr" mode="add"/> <DetailInfo> <ChildInfo Name="This sfsf" Weightage="24"/> <ChildInfo Name="45654" Weightage="67"/> </DetailInfo> </GradeValueSet> </root>

# scripting - 从 gnuplot 中的不同行获取特定元素的值

> ID：242314
> 
> 赞同：6
> 
> 时间：2008-10-28T05:28:53.950
> 
> 标签：scripting, graph, plot, gnuplot

使用 gnuplot 4.2，是否可以获取特定列/行的值并以某种方式使用该值？

例如，假设我的数据文件包含以下内容

```
#1  2
7  13
5  11
23 17
53 12 
```

对于一个简单的图，其中第 1 列是 x 轴，第 2 列是 y 轴，我会：-

```
plot 'datafile' using 1:2 
```

我要做的是通过该列中的第一个元素 (13) 对第 2 列中的所有数据进行规范化。有没有办法在 gnuplot 本身中做到这一点（即，不求助于脚本语言或其他东西来首先预处理数据）？

干杯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-02-06T07:55:52.963

使用运行平均值演示，我设法实现了一个标准化为第二列的第一个值的图。

`base`变量用于存储参考值，函数在第一行`first`初始化`base`。

```
first(x) = ($0 > 0 ? base : base = x)
plot file.dat u 1:(first($2), base/$2) 
```

应该提到的是，这不是使用 gnuplot 4.2 完成的。

**编辑：**使用 Christoph 的建议进行了更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-20T09:35:59.870

如果您的基值（例如 13）在数据集的第一行，您应该能够使用 CVS 版本的 gnuplot 做您想做的事情。

看看[运行平均值演示](http://gnuplot.sourceforge.net/demo_4.3/data_feedback.html)。沿着这些思路，您可以编写一个自定义函数，在第一次调用时将基值存储在自定义变量中，并在后续调用时返回该变量。

（由于该演示仅针对 CVS 版本列出，我假设所需的功能在当前版本中不可用。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-02-22T08:38:03.690

您可以使用`stats`命令获取第二列的第一个值并将其存储在`reference`变量中，如下所示，

```
stats 'datafile' using (reference=$2) every ::0::0 nooutput 
```

您可以替换`$2`为您想要的任何其他列。中的零`every ::0::0`表示该列的第一个条目，您也可以使用它`every ::n::n`来获取该列的第 n 个条目。`nooutput`用于避免混乱的控制台。

然后，您可以使用以下方法获得归一化图，

```
plot 'datafile' using 1:($2/reference) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-20T09:00:07.390

广告一个充满 13 的新列，然后使用：

使用 1:($2/$3) 绘制“数据文件”

# php - 如何保持 PHP stream_socket 活着？

> ID：242316
> 
> 赞同：5
> 
> 时间：2008-10-28T05:29:16.167
> 
> 标签：php, tcp

我有一个使用 stream_socket_client() 的 Php 应用程序，通过 tcp 从后端服务器获取数据，但希望在池中保持连接活动甚至更好，或者避免连接/断开连接。

但我不是 PHP 大师，所以我不知道该怎么做。虽然我可能会在几个小时内弄清楚，但我的时间可能会更好地花在挖掘每个人的大脑上，所以有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-28T07:14:20.930

在创建流时设置`STREAM_CLIENT_PERSISTENT`标志可防止连接空闲。在内部，该标志`stream_socket_client()`调用`pfsockopen()`（[doc](http://www.php.net/pfsockopen)）而不是`fsockopen()`（[doc](http://www.php.net/fsockopen)）。

连接持久性仅限于打开连接的服务器进程。当您的脚本结束并再次调用它时，可能无法保证同一进程处理您的请求 - 在这种情况下将打开另一个连接。将连接放入`$_SESSION`共享它将不起作用。

# visual-studio - 如何加快具有大量项目的视觉工作室？

> ID：242318
> 
> 赞同：14
> 
> 时间：2008-10-28T05:31:01.543
> 
> 标签：visual-studio, visual-studio-2005

Visual Studio 2005 的解决方案非常慢，有 21 个项目。任何想法如何加快它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T07:55:29.740

这个问题有很多建议：[Visual Studio 上的编译时间非常慢](https://stackoverflow.com/questions/55517/very-slow-compile-times-on-visual-studio)。其中一些的组合肯定会在一定程度上有所帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-29T06:52:39.930

[ScottGu 曾表示](http://weblogs.asp.net/scottgu/archive/2007/11/01/tip-trick-hard-drive-speed-and-visual-studio-performance.aspx)，硬盘速度是 VS 性能最重要的因素之一。当我们最近在工作中获得新计算机时，我要求他们拥有第二个顶级硬盘驱动器。我的 Development 文件夹在我的 D: 驱动器上，VS 在几秒钟内加载和编译 20 多个项目解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T06:01:26.880

我现在没有在我面前打开 VS ......但它大致是这个......

去..

工具 > 选项 > 构建和发布选项。

选择 - 仅构建启动项目和依赖项。

这将显着加快这一进程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T07:39:43.343

我对构建速度进行了一些性能测试（尽管是 VS2008）。

我尝试使用 RAM 驱动器。与 RAID 1+0 几乎没有区别。

四核似乎没有多大帮助，因为 CPU 从来没有达到 100%（好吧，我猜其中一个是 100%）。CPU频率似乎有所帮助。不知道内存速度。

因此，为了加快速度，合并一些项目（因为如果它们在单独的项目中，相同数量的 .cs 文件构建速度会变慢）或创建子解决方案 - 仅对当前工作项目具有依赖关系的解决方案。因此，假设您有 Web 应用程序和管理应用程序以及某种 WPF UI 客户端，创建 3 个解决方案，一个带有 Web 应用程序，一个带有管理员，一个用于客户端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T05:52:03.640

a) 购买更多内存 b) 分解成不同的解决方案 c) 升级到 VS 2008 d) [http://geekswithblogs.net/Ahmed_Hussein_blog/archive/2007/11/12/116791.aspx](http://geekswithblogs.net/Ahmed_Hussein_blog/archive/2007/11/12/116791.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T06:10:47.970

这里有一些提高 VS 编译速度的好技巧：

*   禁用 StyleCop、FxCop 或任何其他代码分析工具
*   创建多个构建配置，一个用于您执行的每个任务，并且只编译您在每个特定配置中需要的内容
*   删除不需要的 MSBuild 任务

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-01T02:38:59.437

对于您的情况，升级到 2008 是值得的。在我的上一份工作中，我们有 50 个项目，而 VS 2005 非常缓慢。另外，调试（带多线程）很痛苦。IDE 不断向我们发起攻击。一旦我们升级到 VS 2008，一切都变得更快了，编译也更快了（部分是因为 MS 从外观上看实现了智能并行化算法），它使用更少的 RAM，并且更加稳定。

我们对 2008 年的唯一遗憾是在 C++ 方面（我们的大部分应用程序是 VB.Net、一些 C# 和一些 C++）。新版本的 C++ 不支持我们需要做的 Windows NT。解决方法是使用旧的编辑箱并将版本设置为 4.0 的 postevent。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-22T17:39:45.853

[Visual Studio 2005 的修补程序 947315](http://support.microsoft.com/kb/947315)。

这是对以下内容的累积修复：

*   **KB947315：**当您使用 Visual C++ 项目时，Visual Studio 2005 IDE 停止响应
*   **KB943969：**当您使用 IntelliSense 功能时，Visual Studio 2005 停止响应或性能变慢
*   **KB916769：**当您在 Visual Studio 2005 中使用大型 Visual C++ .NET 解决方案时，Visual Studio 2005 IDE 停止响应

# .net - 多列列表框

> ID：242320
> 
> 赞同：2
> 
> 时间：2008-10-28T05:31:42.917
> 
> 标签：.net, vb.net, winforms, listbox-control

有没有办法将通用列表绑定到多列列表框，是的列表框...我知道，但这就是我所坚持的，无法添加网格或列表视图。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T06:41:08.237

您可以像这样将列表绑定到列表框：

```
List<int> list = new List<int> { 1, 2, 4, 8, 16 };
listBox1.DataSource = list; 
```

至于多列列表框文档说[ListBox.MultiColumn](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.multicolumn.aspx)仅将项目放入所需的列中，以使垂直滚动变得不必要。

如果要显示将选择整行的多列信息，可以使用Chris Rickard 的[多列列表框](http://www.codeproject.com/KB/combobox/multicolumnlistbox.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-03T08:47:08.290

对于 .NET 2.0 ，如果需要在 .NET 中支持多列，可以使用`UseCustomTabOffsets`and 。了解[如何使用 C# 在 ListBox 中制作超过 2 列？](https://stackoverflow.com/questions/1365973/how-to-make-more-than-2-columns-in-listbox-using-c/1372212#1372212)使用示例。`CustomTabOffsets``ListBox`

# asp.net - 在动态数据自定义页面中，如何检索刚刚更新的对象？

> ID：242329
> 
> 赞同：0
> 
> 时间：2008-10-28T05:39:50.920
> 
> 标签：asp.net, dynamic-data

我正在使用 ASP.NET 动态数据并有一个自定义页面。

在这个页面中，我有一个 DetailsView 插入事件的句柄，我想根据最近更新的对象的值做一些事情。但是，我不能将事件处理放在相应对象的模型类中，因为它也是基于自定义页面中自定义（未绑定）表单元素的值。

如何检索刚刚由 DetailsView 更新的对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T23:22:18.933

一种至少可以为您提供通过表单控件更新的字段（不是新的 id 或类似的东西）的半解决方案是访问 DetailsViewInsertedEventArgs 的“Values”属性，如下所示：

```
protected void DetailsView1_ItemInserted(object sender, DetailsViewInsertedEventArgs e)
{
    if (e.Exception == null || e.ExceptionHandled)
    {
            String value = (string)e.Values["FIELDNAME"];
            Response.Redirect(table.ListActionPath);
    }
} 
```

# licensing - 允许客户修改的许可证

> ID：242333
> 
> 赞同：1
> 
> 时间：2008-10-28T05:41:05.800
> 
> 标签：licensing

我为客户编写了一些软件，我想根据许可将其发布给他们，该许可允许他们为自己的内部使用进行修改，但在我之后仍然禁止他们销售或以其他方式重新分发软件已经给了他们。有人可以指出一个具有这种效果或稍作修改的许可证吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T07:42:40.967

我知道没有这样的许可证，并且在谷歌上搜索许可证会在 GPL 和开源许可证上获得大量点击...

您可以尝试查看[有关非自由许可证的 Free Software Foundations 概要](http://www.fsf.org/licensing/licenses/index_html#NonFreeSoftwareLicense)，看看是否与您想要实现的目标相匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T10:12:41.897

我认为包含源代码的组件开发人员使用的许可证可能就足够了。我猜这是您正在寻找的商业许可证，而不是 GPL 或类似许可证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T09:59:52.673

为什么不直接编写自己的专有许可证？

我不认为您将能够使用任何现有的已发布和解释的许可证，因为这些是面向共享的，而这正是您要避免的。

# continuous-integration - Team City 与 CruiseControl.net - 哪个更好？

> ID：242339
> 
> 赞同：18
> 
> 时间：2008-10-28T05:45:10.517
> 
> 标签：continuous-integration, cruisecontrol.net, teamcity

是否存在真正的明显差异，还是只是品味问题？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-28T07:30:32.520

获得巡航控制设置和维护比 TeamCity 需要更多的时间（您可以在几分钟内设置自动化项目 (sln) 构建）。TeamCity 还有一些非常好的功能，例如立即报告构建失败（通过电子邮件、jabber、网站），因此您不必等待 x 分钟。

版本 4（当前为 EAP）还有一个功能，即首先运行失败的测试，因此您知道是否快速修复了构建。

所以...我的票投给了teamcity，除非您的团队如此庞大，否则您必须为此付费...在那种情况下，我不知道。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-29T13:53:04.883

[在 TeamCity 网站http://www.jetbrains.com/teamcity/documentation/featureMatrix.html](http://www.jetbrains.com/teamcity/documentation/featureMatrix.html)上有一个 TeamCity 与 CruiseControl 和 CruiseControl.NET 的比较。显然它会有点偏向于 TeamCity，但认为无论如何它可能会有所帮助。

对我来说，我不得不选择 CruiseControl.NET，因为它支持 SourceGear Vault 而 TeamCity 不支持。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-01T17:04:34.963

TeamCity 也很容易使用和维护。如果您是新手，请使用 TeamCity。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-28T07:30:28.637

TeamCity 的[预测试或延迟提交](http://www.jetbrains.com/teamcity/delayed_commit.html)可能是一个不错的功能，具体取决于您的特定需求。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-29T13:56:58.917

我个人在 CC.NET 上，因为我可以自定义它，我们将它用于各种事情，例如运行 Red Stone 的 EggPlant、生成本地化报告、在许多不同的框架和 3 个操作系统上运行单元测试使用单声道。我真的发现它很容易设置，并且只需对单个解决方案进行简单编译，不到 5 分钟就完成了。但是，我查看了 Team City，它看起来很酷，我只需要自定义的能力。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-28T06:03:26.753

Team city 没有 PHP 支持，所以它对我来说并不有趣。我认为这是个人选择。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-28T06:04:48.030

个人选择，但 TeamCity 安装和查看都非常愉快。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-22T14:34:07.707

[Team city](http://www.jetbrains.com/teamcity/documentation/featureMatrix.html)支持 Source Gear

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-30T09:18:41.540

TeamCity 可以有 PHP 支持，请查看以下 URL：

[http://www.waltercedric.com/joomla-mainmenu-247/370-continuous-build/1552-configuring-teamcity-maven-for-php-for-joomla-continuous-build.html](http://www.waltercedric.com/joomla-mainmenu-247/370-continuous-build/1552-configuring-teamcity-maven-for-php-for-joomla-continuous-build.html)

# c# - 将 XHTML 文档转换为纯文本的 C# 代码

> ID：242341
> 
> 赞同：0
> 
> 时间：2008-10-28T05:45:45.447
> 
> 标签：c#, xhtml, text, escaping

我正在编写一个实用程序来按计划将印象笔记笔记导出到 Outlook 中。Outlook API 需要纯文本，Evernote 输出纯文本笔记的 XHTML 文档版本。我需要的是去掉所有标签，并取消嵌入在 Evernote 导出文件中的源 XHTML 文档。

基本上我需要转；

```
<note>
  <title>Test Sync Note 1</title> 
  <content>
  <![CDATA[ <?xml version="1.0" encoding="UTF-8"?>
   <!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml.dtd">

<en-note bgcolor="#FFFFFF">
<div>Test Sync Note 1</div>
<div>This i has some text in it</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>and a second line</div>
</en-note>

  ]]> 
  </content>
  <created>20081028T045727Z</created> 
  <updated>20081028T051346Z</updated> 
  <tag>Test</tag> 
</note> 
```

进入

```
    测试同步注 1
    这个我有一些文字

    和第二行

```

我可以轻松地解析出 CDATA 部分并仅获取 4 行文本，但我需要一种可靠的方法来剥离 div、取消转义并处理可能潜入其中的任何额外 HTML。

我假设有一些 MS API 组合可以完成这项工作，但我不知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T07:15:59.913

我会使用正则表达式来去除所有的 HTML 标签，这个非常基本，我相信如果它不能完全按照你的意愿工作，你是否可以调整它。

`Regex.Replace("<div>your html in here</div>",@"<(.|\n)*?>",string.Empty)`;

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T07:42:24.540

您还可以使用 xslt 转换将 xml 转换为文本文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T15:36:29.950

您可以使用[HTML 敏捷包](http://www.codeplex.com/htmlagilitypack)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T05:55:02.307

据我所知，没有什么可以做这项特定的工作，但您可能想看看使用 XSLT 或浏览 IXPathNavigable。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T06:18:56.720

```
 string xml = @"<note>
          <title>Test Sync Note 1</title> 
          <content>
          <![CDATA[ <?xml version=""1.0"" encoding=""UTF-8""?>
           <!DOCTYPE en-note SYSTEM ""http://xml.evernote.com/pub/enml.dtd"">

        <en-note bgcolor=""#FFFFFF"">
        <div>Test Sync Note 1</div>
        <div>This i has some text in it</div>
        <div> </div>
        <div> </div>
        <div>and a second line</div>
        </en-note>

          ]]> 
          </content>
          <created>20081028T045727Z</created> 
          <updated>20081028T051346Z</updated> 
          <tag>Test</tag> 
        </note>
        ";
        XPathDocument doc = new XPathDocument(new StringReader(xml));
        XPathNavigator nav = doc.CreateNavigator();

        // Compile a standard XPath expression

        XPathExpression expr;
        expr = nav.Compile("/note/content");
        XPathNodeIterator iterator = nav.Select(expr);

        // Iterate on the node set

        try
        {
            while (iterator.MoveNext())
            {
                //Get the XML in the CDATA
                XPathNavigator nav2 = iterator.Current.Clone();
                XPathDocument doc2 = new XPathDocument(new StringReader(nav2.Value.Trim()));

                //Parse the XML in the CDATA
                XPathNavigator nav3 = doc2.CreateNavigator();
                expr = nav3.Compile("/en-note");
                XPathNodeIterator iterator2 = nav3.Select(expr);
                iterator2.MoveNext();
                XPathNavigator nav4 = iterator2.Current.Clone();

                //Output the value directly, does not preserve the formatting
                Console.WriteLine("Direct Try:");
                Console.WriteLine(nav4.Value);

                //This works, but is ugly
                Console.WriteLine("Ugly Try:");
                Console.WriteLine(nav4.InnerXml.Replace("<div>","").Replace("</div>",Environment.NewLine));
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        } 
```

# asp.net - 转发 URL 并在 ASPX 中仍然返回 200 而不是 302

> ID：242344
> 
> 赞同：0
> 
> 时间：2008-10-28T05:49:45.143
> 
> 标签：asp.net, http, url, http-headers, http-status-code-302

我希望此页面返回 200，同时仍发送重定向...

```
<script>
    sub page_load
        'Get the parameters
         dim content As String
         content = request.querystring("text")
         response.redirect ("http://100.200.100.10/test1/Default.aspx?CommandParm=" + content)
    end sub
</script>
<html>
    <head>
    </head>
    <body>
        <form runat="server">
        </form>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T10:00:38.990

@无眼睑@

我同意这似乎是一个糟糕的可用性选择，但我希望这是解决无法直接修复的问题的一种解决方法。

鉴于此，请尝试[META refresh](http://en.wikipedia.org/wiki/Meta_refresh)，例如，

```
<meta http-equiv="refresh" content="5;url=http://example.com/"/> 
```

并嵌入一条消息，向登陆此页面的不幸用户解释正在发生的事情。

> 发布问题时我可能没有解释自己。这实际上是一个 B2B 交易。没有最终用户使用浏览器。第三方发送 HTTP GET。我们要做的就是将其作为合法交易转发。

然后你应该发送一个 301 或 302——这正是他们设计处理的目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T06:10:49.017

你可以让这个页面被javascript重定向

首先，通过制作以下字符串来创建动态javascript

```
<script type"text/javascript">
<!--
function redirect()
{
   window.location = "http://100.200.100.10/test1/Default.aspx?CommandParm=" + content
}
//-->
</script> 
```

其次，将javascript添加到当前页面的标题中。

然后，将javascript添加到正文

```
mybody.Attributes.Add("onload", "redirect()"); 
```

当您浏览当前页面时，它将返回 HTTP 200，并且在 onload 事件触发后，浏览器将调用 redirect() 并且您的浏览将在目标页面中。

只是好奇你为什么需要这个？！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T20:12:11.570

你不能同时拥有它：重定向和状态 200。

[RFC2616](http://www.greenbytes.de/tech/webdav/rfc2616.html)说关于[状态码 200](http://www.greenbytes.de/tech/webdav/rfc2616.html#status.200)：

> **10.2.1 200 正常**
> 
> 请求已成功。响应返回的信息取决于请求中使用的方法，例如：
> 
> *   **GET** : 在响应中发送对应于请求资源的实体；
> *   **HEAD**：请求资源对应的实体头字段在响应中发送，不带任何消息体；
> *   **POST**：描述或包含动作结果的实体；
> *   **TRACE**：包含由终端服务器接收到的请求消息的实体。

因此，除了发送一些由用户代理解释的内容（例如 JavaScript）到浏览器之外，没有重定向的空间。

这[是](http://www.greenbytes.de/tech/webdav/rfc2616.html#status.3xx)规范中关于使用状态码 301、302 或 303 进行重定向的部分：

> **10.3.2 301 永久移动**
> 
> 请求的资源已被分配一个新的永久 URI，并且任何将来对该资源的引用都应该使用返回的 URI 之一。如果可能，具有链接编辑功能的客户端应该自动将对 Request-URI 的引用重新链接到服务器返回的一个或多个新引用。除非另有说明，否则此响应是可缓存的。
> 
> 新的永久 URI 应该由响应中的 Location 字段给出。除非请求方法是 HEAD，否则响应的实体应该包含一个简短的超文本注释，其中包含指向新 URI 的超链接。
> 
> 如果收到 301 状态代码以响应 GET 或 HEAD 以外的请求，除非用户可以确认，否则用户代理不得自动重定向请求，因为这可能会改变发出请求的条件。
> 
> 注意：当收到 301 状态码后自动重定向 POST 请求时，一些现有的 HTTP/1.0 用户代理会错误地将其更改为 GET 请求。
> 
> **10.3.3 302 找到**
> 
> 请求的资源临时驻留在不同的 URI 下。由于重定向有时可能会改变，客户端应该继续使用 Request-URI 来处理未来的请求。此响应仅在由 Cache-Control 或 Expires 标头字段指示时才可缓存。
> 
> 临时 URI 应该由响应中的 Location 字段给出。除非请求方法是 HEAD，否则响应的实体应该包含一个简短的超文本注释，其中包含指向新 URI 的超链接。
> 
> 如果收到 302 状态代码以响应 GET 或 HEAD 以外的请求，除非用户可以确认，否则用户代理不得自动重定向请求，因为这可能会改变发出请求的条件。
> 
> 注意：RFC 1945 和 RFC 2068 指定不允许客户端更改重定向请求的方法。然而，大多数现有的用户代理实现将 302 视为 303 响应，无论原始请求方法如何，都对 Location 字段值执行 GET。状态码 303 和 307 已被添加用于希望明确明确期望客户端做出何种反应的服务器。
> 
> **10.3.4 303 见其他**
> 
> 可以在不同的 URI 下找到对请求的响应，并且应该使用该资源上的 GET 方法来检索。此方法的存在主要是为了允许 POST 激活脚本的输出将用户代理重定向到选定的资源。新的 URI 不是原始请求资源的替代引用。303 响应不能被缓存，但对第二个（重定向）请求的响应可能是可缓存的。
> 
> 不同的 URI 应该由响应中的 Location 字段给出。除非请求方法是 HEAD，否则响应的实体应该包含一个简短的超文本注释，其中包含指向新 URI 的超链接。
> 
> 注意：许多 HTTP/1.1 之前的用户代理不理解 303 状态。当与此类客户端的互操作性是一个问题时，可以使用 302 状态代码代替，因为大多数用户代理对 302 响应做出反应，如此处针对 303 所述。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T06:00:04.623

没办法`Response.Redirect()`。我认为。也许`Response.Status = "200 OK"`调用后设置`Redirect()`有效，我从未尝试过。

您可以通过在其他空响应中手动设置“位置”标头来伪造它。不过，不确定这有什么好处。;-)

```
Response.AddHeader("Location", "http://100.200.100.10/test1/Default.aspx?CommandParm=" + content)
Response.End() 
```

*（并且，为了记录：您将产生一个无效的 HTTP 标头星座。不应该破坏任何东西，但仍然。）*

# wpf - 如何在不创建滚动条的情况下在添加项目时自动扩展选项卡控件？

> ID：242356
> 
> 赞同：3
> 
> 时间：2008-10-28T05:59:17.290
> 
> 标签：wpf, tabcontrol

我正在使用 WPF 用户控件（选项卡控件）在下面的简化代码中动态添加选项卡项：

```
....
foreach (string id in ids)
{
    TabControl.Items.Add(CreateTabItem(id));
}

private TabItem CreateTabItem(string name)
{
    StackPanel txtBlock = new TextBlock();
    txtblock.Text = name;
    txtBlock.HorizontalAlignment = Horizontalalignment.Center;
    panel.Children.Add(txtBlock);

    TabItem item = new TabItem();
    item.Header = panel;

    <SomeControl> control = new <SomeControl>();
    item.Content = control;
    return item;
 } 
```

在 xaml 文件中，我指定了以下内容以将所有选项卡项堆叠到左列：

```
MinWidth="100" MinHeight="300" TabStripPlacement="Left" 
```

如何使我的选项卡控件自动扩展（即拉伸）它的高度以在我添加它们时显示所有选项卡项？现在，我必须手动扩展显示窗口的高度才能看到所有选项卡项。非常感谢您的见解/提示。

PS：如果您知道如何在选项卡项超过窗口高度时立即显示垂直滚动条（不向我的控件添加滚动条），如果我的初衷没有答案，我可以解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T20:37:54.380

```
 <ScrollViewer>
    <TabControl
        TabStripPlacement="Left"
        x:Name="Tab"
    >
    </TabControl>
</ScrollViewer> 
```

为您提供将在需要时启用的滚动条。

# apache-flex - 如何在 flex 中的画布组件周围创建像浮动效果一样的阴影？

> ID：242363
> 
> 赞同：4
> 
> 时间：2008-10-28T06:04:15.003
> 
> 标签：apache-flex, shadow

我想在 flex 中的画布组件周围创建一个阴影。从技术上讲，它不会是阴影，因为我希望它环绕组件，使组件具有浮动外观。我也许可以用发光来做到这一点，但任何人都可以放弃一两行已经做过的人吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T06:14:04.313

我实际上通过这样做解决了它：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" 
        width="780" height="100%" borderStyle="solid" borderColor="gray"
            creationComplete="init();" backgroundColor="white">

  <mx:Script>
        <![CDATA[
            import mx.styles.StyleManager;

            private function init():void {
                var glow:GlowFilter = new GlowFilter();
                glow.color = StyleManager.getColorName("gray");
                glow.alpha = 0.8;
                glow.blurX = 4;
                glow.blurY = 4;
                glow.strength = 6;
                glow.quality = BitmapFilterQuality.HIGH;

                this.filters = [glow];
            }
        ]]>
    </mx:Script>

</mx:Canvas> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T06:25:34.523

您可以使用`DropShadowFilter`，但它看起来或多或少是一样的：

```
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" 
    width="780" height="100%" borderStyle="solid" borderColor="gray"
    creationComplete="init();" backgroundColor="white" dropShadowEnabled="true">
    <mx:filters>
        <mx:DropShadowFilter
            quality="1"
            color="gray"
            alpha="0.8"
            distance="0"
            blurX="4"
            blurY="4"
            strength="6"
        />
    </mx:filters>
</mx:Canvas> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-30T21:07:00.370

在 flex 4 中，我使用以下内容。我只是想发布这个，因为过滤器属性应该如下图所示。（是的，我知道我在 mx 对象上使用火花过滤器）

```
 <fx:Declarations>
    <s:GlowFilter
        id="glowBlack"
        alpha=".6"
        color="0x000000"
        inner="false"
        blurX="10"
        blurY="10"
        quality = "2"

        /> 
```

```
 <mx:Image id="rssIcon"
              height="70"
              filters="{[glowBlack]}"
              source="assets/rss/icon_rss.png"
              styleName="rssIconStyle"
              width="70"
              scaleContent="true"
              click="openRssSite(event)"
              "/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T20:22:32.150

如果你想在画布之外定义它，你可以这样做：

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
        width="780" height="100%">

   <mx:Canvas filters="[dropShadow]" width="200" height="200" backgroundColor="white"/>
   <mx:DropShadowFilter id="dropShadow" distance="0"/>

</mx:Application> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T01:06:14.427

你也许可以用[degrafa](http://www.degrafa.com/)和 skinning 来做到这一点。他们的文档有限，但您可以观看其中一个关于如何创建皮肤的教程视频。或者看看他们的示例代码。只需将 degrafa 编程皮肤分配给画布的边框，您就可以添加各种时髦的渐变、路径、形状等等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-09T05:53:56.500

根据您的需要，您可能能够摆脱：

```
<mx:Canvas ... dropShadowEnabled="true" shadowDirection="right"> 
```

有一些警告..[这里概述](http://livedocs.adobe.com/flex/3/html/help.html?content=styles_11.html)

# iphone - 如何将从网络检索到的图像存储到应用程序包中？

> ID：242367
> 
> 赞同：0
> 
> 时间：2008-10-28T06:05:53.517
> 
> 标签：iphone, image, cocoa-touch, sqlite

我正在开发 iPhone 应用程序，在那个应用程序中我有一个`TableViewController`，它`TableViewController`由自定义表格单元格组成。
进入那些我从 URL 加载图像的单元格，但`scrolling`不是那么顺利，（因为每个单元格在每次滚动时都会加载图像）。

所以我决定将这些图像存储到应用程序的文件夹中，但是当应用程序处于运行状态时，我不知道如何在 iPhone 中使用文档文件夹。

有什么建议吗？

在其他论坛上，我发现 SQLITE 具有 blob 数据类型来存储二进制数据，

哪种方法有效，文件夹或sqlite存储图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T09:47:28.093

将图像存储在设备上可能会有所改善，但不会使滚动真正流畅。滚动变得不稳定的原因是单元格代码中的同步函数意味着您阻塞了运行循环，从而阻止了动画。如果你想加快滚动，你需要摆脱阻塞事件，通过使其异步（尽管如果你异步回调需要大量 CPU 时间，这仍然可能导致它滚动），或者移动阻塞代码主线程。

如果您将负载移出主线程，则单个文件或 sqlite3 数据库都可以正常工作。您会发现的另一个大问题是单元格在滚动时不会更新。这意味着如果您执行异步图像加载以响应单元格加载，则图像将不会出现在单元格中，直到用户完成滚动，这通常不是所需的体验。为了避免这种情况，您需要在用户滚动图像之前预测性地将图像加载到 ram 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T08:14:00.047

您可以使用`NSFileManager`'s`createFileAtPath`将任何内容保存`NSData`到文件中。

要获取 Documents 目录，请使用以下命令：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0]; 
```

# svn - 本地删除文件后SVN提交错误

> ID：242376
> 
> 赞同：58
> 
> 时间：2008-10-28T06:16:09.737
> 
> 标签：svn, version-control, netbeans, commit

我有一个使用 Netbeans 6.1 构建的项目，并且正在使用 SVN。我删除了本地机器上的一些文件，然后尝试将我的更改提交到 SVN 存储库。提交失败并显示错误消息

> 'C:\path\to\project\myfile' 的条目没有 URL

其中 myfile 是已删除的文件。

有什么方法可以告诉 SVN 该文件已从项目中删除，并且应该从存储库中删除？

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2008-10-28T06:22:12.503

一个 svn update 将把文件带回来，修复你的本地仓库。

然后，您应该能够对该文件执行“svn delete”，这会告诉您的本地存储库该文件将被删除，并从文件系统中删除它。

然后，您应该能够将更改提交回 repo。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T07:01:42.687

如果您正在提交一个包含已删除文件的文件夹，并假设您使用的是最新版本的 Tortoise SVN（SVN GUI 客户端），它会将特定文件识别为丢失并尝试从 SVN 存储库中删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-02T17:04:31.313

我有同样的问题，原因是我从外部删除了文件。如果您使用 NetBeans 将其删除，则提交工作正常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-27T15:51:01.017

在本地删除项目，从 SVN 重新签出并提交更改为我修复了它。确保在删除项目之前备份您的更改。

# spring - 是否可以部分自动装配弹簧豆？

> ID：242383
> 
> 赞同：2
> 
> 时间：2008-10-28T06:21:16.827
> 
> 标签：spring

我想部分地自动装配一个 bean - 也就是说，我希望一些 args 被自动装配，但其他的被显式设置。例如：

public MyClient(Service svc, boolean b)

在这个构造函数的情况下，我想在我的 xml 中指定 b 的值，但是让 svc 自动装配。那可能吗？

谢谢，洛厄尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T07:12:56.533

我不认为构造函数是可能的，但是对于显式设置器肯定是。只需使用 @Autowired 注释您想要自动装配的那些，然后在您的配置文件中设置其他

就像是：

```
public MyClient() {}

@Autowired
public setService (Service svc) {...}

public setBoolean (boolean b) {...} 
```

然后在你的配置中

```
<context:annotation-config />

<bean id="service">...</bean>

<bean id="yourbean" class="MyClient">
    <property name="b" value="true"/>
</bean> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T00:13:46.740

我自己想出来的，万岁！

我这样做的方式是在我的 xml 中添加以下内容：

```
<bean class="MyClient" autowire="constructor">
   <constructor-arg index="1">...</constructor-arg>
<bean> 
```

# c# - COM 互操作是否尊重程序集加载的 .NET AppDomain 边界？

> ID：242391
> 
> 赞同：9
> 
> 时间：2008-10-28T06:25:17.893
> 
> 标签：c#, com, interop, com-interop, appdomain

这是核心问题：我有一个在单独的 AppDomain中使用[COM 互操作的 .NET 应用程序。](http://en.wikipedia.org/wiki/COM_Interop)COM 东西似乎正在将程序集加载回默认域，而不是从中调用 COM 东西的 AppDomain。

我想知道的是：这是预期的行为，还是我做错了什么导致这些与 COM 相关的程序集被加载到错误的 AppDomain 中？请参阅下面对情况的更详细描述...

该应用程序由 3 个程序集组成： - 主 EXE，应用程序的入口点。- common.dll，只包含一个接口 IController（IPlugin 样式） - controller.dll，包含一个实现 IController 和 MarshalByRefObject 的 Controller 类。此类完成所有工作并使用 COM 互操作与另一个应用程序进行交互。

主 EXE 的相关部分如下所示：

```
AppDomain controller_domain = AppDomain.CreateDomain("Controller Domain");
IController c = (IController)controller_domain.CreateInstanceFromAndUnwrap("controller.dll", "MyNamespace.Controller");
result = c.Run();
AppDomain.Unload(controller_domain); 
```

common.dll 仅包含以下两件事：

```
public enum ControllerRunResult{FatalError, Finished, NonFatalError, NotRun}
public interface IController
{
    ControllerRunResult Run();
} 
```

并且 controller.dll 包含这个类（它也调用 COM 互操作的东西）：

```
public class Controller: IController, MarshalByRefObject 
```

首次运行应用程序时，Assembly.GetAssemblies() 看起来与预期一样，common.dll 加载到两个 AppDomains 中，而 controller.dll 仅加载到控制器域中。但是，在调用 c.Run() 之后，我看到与 COM 互操作相关的程序集已加载到默认的 AppDomain 中，而不是在发生 COM 互操作的 AppDomain 中。

为什么会发生这种情况？

如果你有兴趣，这里有一点背景：

最初这是一个 1 AppDomain 应用程序。它与之交互的 COM 东西是一个服务器 API，长期使用并不稳定。当 COM 发生 COMException（没有关于其原因的有用诊断信息）时，必须重新启动整个应用程序，然后 COM 连接才能再次工作。简单地重新连接到 COM 应用程序服务器会再次立即导致 COM 异常。为了解决这个问题，我尝试将 COM 互操作的东西移动到一个单独的 AppDomain 中，这样当神秘的 COMExceptions 发生时，我可以卸载它发生的 AppDomain，创建一个新的并重新开始，而无需手动重新启动应用程序. 反正就是这个理论...

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-11-06T04:43:45.260

不幸的是，COM 组件是在进程空间中加载的，而不是在 AppDomain 的上下文中。因此，您将需要手动拆除（释放和卸载）您的本机 DLL（适用于 COM 和 P/Invoke）。简单地破坏一个应用程序域对你没有好处，但是重新生成整个过程不应该是重置 COM 状态所必需的（简单地重新创建 COM 对象也应该正常工作，这听起来像是组件提供程序代码中的一个错误，也许他们可以解决吗？）

**参考**

[(TechNet) 进程地址空间](http://msdn.microsoft.com/en-us/library/vstudio/kt21t9h7(v=vs.100).aspx)

[(MSDN) 应用程序域](http://msdn.microsoft.com/en-us/library/2bh4z9hs(v=vs.110).aspx)

[(MSDN) 边界：进程和 AppDomains](http://technet.microsoft.com/en-us/library/ms189334(v=sql.105).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T17:26:37.437

这是肖恩威尔逊的答案是正确的证据

![Com 应用域](https://i.stack.imgur.com/BbYrE.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T15:52:43.070

不要让你的控制器 MBR。创建一个小型代理，它将控制器加载到第二个域中并启动它。这样控制器 dll 将不会在第一个域中加载。

# c# - 获取泛型参数的类型

> ID：242393
> 
> 赞同：2
> 
> 时间：2008-10-28T06:26:49.840
> 
> 标签：c#, generics

我有以下课程

```
public interface InterfaceBase
{
}

public class ImplementA:InterfaceBase
{
}

public class ImplementB:InterfaceBase
{
}

public void TestImplementType<T>(T obj) where T: InterfaceBase
{
} 
```

如何推断T是ImplementA还是ImplementB？我试着用

```
typeof(T) is ImplementA 
```

但是这个表达式总是被评估为假。

编辑：我将如何将 obj 转换为 ImplementA 或 ImplementB？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-28T06:35:31.320

严格来说，您应该避免在泛型中进行过多的专业化。将任何专门的逻辑放在接口上的成员中会更干净，这样任何实现都可以以不同的方式完成。但是，有多种方法：

您可以测试“obj”（假设它是非空的）

```
 bool testObj = obj is ImplementA; 
```

您可以测试 T 是否为 typeof(ImplementA)：

```
 bool testEq = typeof(T) == typeof(ImplementA); 
```

同样，您可以测试它是 ImplementA 还是子类：

```
 bool testAssign = typeof(ImplementA).IsAssignableFrom(typeof(T)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T06:29:12.597

`obj is ImplementA`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-28T06:29:39.837

`typeof(T)`返回`Type`of `T`- 并且`System.Type`不实现`ImplementA`. 你想要的是：

```
if (typeof(ImplementA).IsAssignableFrom(typeof(T))
{
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T06:29:19.337

怎么样：

```
 if(obj.GetType().Equals(typeof(ImplementA)))
 {
   // ...
 } 
```

# c - 我需要一个标准包来通过网络连接移动键、值对：有什么提示吗？

> ID：242399
> 
> 赞同：0
> 
> 时间：2008-10-28T06:30:40.037
> 
> 标签：c, networking, open-source

由于我讨厌重新发明轮子，我想知道是否有任何常用的封装用于在两个网络端点之间进行简单的数据对（键、值）通信（可能 TCP/IP 是最有可能的载体）。我想要可以在任何环境中工作的东西，对我来说，这意味着用 C 或 C++ 编写的 Unix/Linux 风格的套接字 API。Java 很好，但只有 Java 很难集成到二进制程序中。由于需要移植到 Linux 主机，C# 等已被淘汰。

有这样的野兽吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T07:34:42.450

考虑使用[JSON](http://en.wikipedia.org/wiki/JSON)吗？大多数编程语言都有可用的库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T07:45:53.207

Google 有一种称为[Procotol Buffers](http://code.google.com/p/protobuf/)的数据交换格式，您可能需要考虑一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T15:48:04.370

如果您希望开销最小，[netstrings是一个旧的解决方案。](http://cr.yp.to/proto/netstrings.txt)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T07:31:17.557

如果您想要完全的可移植性，那么套接字级别的 API 是可行的方法。我想每种语言都有一些包可以在两个方向上进行适当的位成型，但我不知道有任何单个包可以移植到所有这些语言。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T15:37:44.783

还有[编码](http://en.wikipedia.org/wiki/Bencode)。可能有一些库（torrent 库）可以很容易地解析它。

# social - 哪些功能使网站具有“社交性”？

> ID：242400
> 
> 赞同：1
> 
> 时间：2008-10-28T06:30:57.960
> 
> 标签：social

如果您试图将您的 Web 应用程序定位为“社交”（或 Web 2.0），那么您应该实现哪些主要功能？

一个不错的起点是[this page](http://www.marketingeric.com/12/10-features-every-social-website-should-have/)，但即使这样也可能有点过分（我认为标准可能更低）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-28T07:08:32.720

这让我觉得本末倒置。找出对用户有用的功能，并实施这些功能。如果人们认为结果是“社交的”，那就这样吧。如果他们不这样做，但它仍然有用且受欢迎，那有什么问题？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-28T08:05:51.637

首先，“Web 2.0”！=“社交”——这是一个包含新的/更好的网络内容品种的术语。虽然协作是其中的一部分，但安全性、性能，当然还有用户界面也是其中的一部分。

[Jon Skeet 说得很好。](https://stackoverflow.com/questions/242400/what-features-make-a-site-social#242436)

像这样想，是什么让你去当地的酒吧/酒吧“社交”？

你可以一个人去那里，喝上最好的啤酒和所有你能吃的花生和薯条，但它是社交的吗？你可以和一群好朋友一起去一个绝对的潜水酒吧，那里供应蹩脚的淡化啤酒，但仍然玩得很开心。

为什么你会选择一个而不是另一个？也许一个播放更好的音乐，也许一个更接近，也许一个更便宜，也许一个有更多的女人？谁知道？

选择你的市场，让它对市场有利。看看 StackOverflow。它面向程序员，由程序员。繁荣。许多程序员出现了，你就有了一个社区。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-28T07:08:14.313

用户驱动的内容；现在你只需要找到最理想的方式来吸引人们创造它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T19:15:01.710

社交网站是一个在使用您的网站的人之间引发互动的网站。

如果你想建立一个社交网站，我建议：

1.  找到你的利基受众。确保你的团队围绕着共同的兴趣。音乐、约会、艺术，任何人们喜欢的东西。

2.  创建简单的方式，让您的用户可以立即和公开地留下他们的印记。人们喜欢看到自己出现在版块、评论等中。最重要的是，它应该快速、简单且自由地留下您的印记。

3.  人们喜欢发表自己的意见并观察其他人对此的反应，因此请赋予他们这种能力。

4.  创建您的网站，以便当您越来越了解他们喜欢什么工具以及他们喜欢如何使用它们时，它可以适应用户的兴趣。不要试图驱赶他们或带领他们，让他们带领你。只需为他们提供尽可能多的门供他们穿过，并扩大他们穿过最多的门。

社交网站是社区定义的。让您的社区告诉您它喜欢什么，他们会不断回来。

# algorithm - 按顺时针顺序排列四个点

> ID：242404
> 
> 赞同：29
> 
> 时间：2008-10-28T06:36:24.597
> 
> 标签：algorithm, graphics, sorting, geometry

数组中的四个二维点。我需要按顺时针顺序对它们进行排序。我认为只需一次交换操作即可完成，但我无法正式将其放下。

~~编辑：在我的例子中，这四个点是一个凸多边形。~~

编辑：这四个点是凸多边形的顶点。他们不必井井有条。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-28T22:15:07.603

如果你想从更数学的角度来看，我们可以考虑 4 个点的排列

在我们的例子中，有 4 个按顺时针排列的排列

```
A B C D
B C D A
C D A B
D A B C 
```

所有其他可能的排列都可以通过 0 或 1 次交换转换为其中一种形式。（我只会考虑以 A 开头的排列，因为它是对称的）

1.  ABCD - 完成
2.  ABDC - 交换 C 和 D
3.  ACBD - 交换 B 和 C
4.  ACDB - 交换 A 和 B
5.  ADBC - 交换 A 和 D
6.  ADCB - 交换 B 和 D

因此，只需要一次交换——但可能需要一些工作来确定是哪一个。

通过查看前三个点，并检查 ABC 符号区域的符号，我们可以确定它们是否是顺时针方向。如果它们是顺时针的，那么我们就是情况 1 2 或 5

为了区分这些情况，我们必须再检查两个三角形——如果 ACD 是顺时针的，那么我们可以将其缩小到情况 1，否则我们必须是情况 2 或 5。

要在案例 2 和 5 之间进行选择，我们可以测试 ABD

我们可以类似地检查 ABC 逆时针的情况。

在最坏的情况下，我们必须测试 3 个三角形。

如果您的点不是凸点，您会找到内部点，对其余点进行排序，然后将其添加到任何边缘。请注意，如果四边形是凸的，则 4 个点不再唯一确定四边形，则有 3 个同样有效的四边形。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-28T07:53:44.783

这里有几个值得考虑的想法；

*   顺时针仅对原点有意义。我倾向于将原点视为一组点的重心。例如顺时针相对于四个点的平均位置上的一个点，而不是可能非常遥远的原点。

*   如果您有四个点 a、b、c、d，则这些点在您的原点周围存在多个顺时针顺序。例如，如果 (a,b,c,d) 形成顺时针顺序，则 (b,c,d,a)、(c,d,a,b) 和 (d,a,b,c)

*   你的四个点是否已经形成一个多边形？如果是这样，则需要检查和反转绕组，而不是对点进行排序，例如 a,b,c,d 变为 d,c,b,a。如果不是，我将根据 Wedges 响应根据每个点和原点之间的连接方位进行排序。

**编辑：**关于您对交换哪些点的评论；

**在三角形 (a,b,c) 的情况下，如果第三个点c位于线****ab**的右侧，我们可以说它是顺时针的。我使用以下辅助函数根据点的坐标来确定这一点；

```
int side(double x1,double y1,double x2,double y2,double px,double py)
{
 double dx1,dx2,dy1,dy2;
 double o;

 dx1 = x2 - x1;
 dy1 = y2 - y1;
 dx2 = px - x1;
 dy2 = py - y1;
 o = (dx1*dy2)-(dy1*dx2);
 if (o > 0.0) return(LEFT_SIDE);
 if (o < 0.0) return(RIGHT_SIDE);
 return(COLINEAR);
} 
```

如果我有一个四点凸多边形 (a,b,c,d)，我可以将其视为两个三角形 (a,b,c) 和 (c,d,a)。如果 (a,b,c) 是逆时针方向，我将绕组 (a,b,c,d) 更改为 (a,d,c,b) 以将整个多边形的绕组更改为顺时针方向。

我强烈建议用几个样本点画这个，看看我在说什么。请注意，您有很多例外情况需要处理，例如凹多边形、共线点、重合点等...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-11T16:55:18.047

如果有人感兴趣，这是我对类似问题的快速而肮脏的解决方案。

我的问题是按以下顺序排列我的矩形角：

> 左上>右上>右下>左下

基本上它是从左上角开始的顺时针顺序。

该算法的思想是：

**按行对角进行排序，然后按列对角对进行排序。**

```
// top-left = 0; top-right = 1; 
// right-bottom = 2; left-bottom = 3;
List<Point> orderRectCorners(List<Point> corners) {    
    if(corners.size() == 4) {    
        ordCorners = orderPointsByRows(corners);

        if(ordCorners.get(0).x > ordCorners.get(1).x) { // swap points
            Point tmp = ordCorners.get(0);
            ordCorners.set(0, ordCorners.get(1));
            ordCorners.set(1, tmp);
        }

        if(ordCorners.get(2).x < ordCorners.get(3).x) { // swap points
            Point tmp = ordCorners.get(2);
            ordCorners.set(2, ordCorners.get(3));
            ordCorners.set(3, tmp);
        }               
        return ordCorners;
    }    
    return empty list or something;
}

List<Point> orderPointsByRows(List<Point> points) {
    Collections.sort(points, new Comparator<Point>() {
        public int compare(Point p1, Point p2) {
        if (p1.y < p2.y) return -1;
        if (p1.y > p2.y) return 1;
        return 0;
        }
    });
    return points;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-29T07:41:23.667

奥利弗是对的。此代码（社区维基化）生成并排序 4 点数组的所有可能组合。

```
#include <cstdio>
#include <algorithm>

struct PointF {
    float x;
    float y;
};

// Returns the z-component of the cross product of a and b
inline double CrossProductZ(const PointF &a, const PointF &b) {
    return a.x * b.y - a.y * b.x;
}

// Orientation is positive if abc is counterclockwise, negative if clockwise.
// (It is actually twice the area of triangle abc, calculated using the
// Shoelace formula: http://en.wikipedia.org/wiki/Shoelace_formula .)
inline double Orientation(const PointF &a, const PointF &b, const PointF &c) {
    return CrossProductZ(a, b) + CrossProductZ(b, c) + CrossProductZ(c, a);
}

void Sort4PointsClockwise(PointF points[4]){
    PointF& a = points[0];
    PointF& b = points[1];
    PointF& c = points[2];
    PointF& d = points[3];

    if (Orientation(a, b, c) < 0.0) {
        // Triangle abc is already clockwise.  Where does d fit?
        if (Orientation(a, c, d) < 0.0) {
            return;           // Cool!
        } else if (Orientation(a, b, d) < 0.0) {
            std::swap(d, c);
        } else {
            std::swap(a, d);
        }
    } else if (Orientation(a, c, d) < 0.0) {
        // Triangle abc is counterclockwise, i.e. acb is clockwise.
        // Also, acd is clockwise.
        if (Orientation(a, b, d) < 0.0) {
            std::swap(b, c);
        } else {
            std::swap(a, b);
        }
    } else {
        // Triangle abc is counterclockwise, and acd is counterclockwise.
        // Therefore, abcd is counterclockwise.
        std::swap(a, c);
    }
}

void PrintPoints(const char *caption, const PointF points[4]){
    printf("%s: (%f,%f),(%f,%f),(%f,%f),(%f,%f)\n", caption,
        points[0].x, points[0].y, points[1].x, points[1].y,
        points[2].x, points[2].y, points[3].x, points[3].y);
}

int main(){
    PointF points[] = {
        {5.0f, 20.0f},
        {5.0f, 5.0f},
        {20.0f, 20.0f},
        {20.0f, 5.0f}
    };

    for(int i = 0; i < 4; i++){
        for(int j = 0; j < 4; j++){
            if(j == i)  continue;
            for(int k = 0; k < 4; k++){
                if(j == k || i == k) continue;
                for(int l = 0; l < 4; l++){
                    if(j == l || i == l || k == l) continue;
                    PointF sample[4];
                    sample[0] = points[i];
                    sample[1] = points[j];
                    sample[2] = points[k];
                    sample[3] = points[l];

                    PrintPoints("input: ", sample);
                    Sort4PointsClockwise(sample);
                    PrintPoints("output: ", sample);
                    printf("\n");
                }
            }
        }
    }

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-20T11:35:18.883

对于每个点排列，使用鞋带公式从坐标计算面积（没有绝对值，因此面积可以为正或负）。最大面积值似乎对应于直接简单四边形：[使用鞋带公式找到的简单直接四边形](http://dip4fish.blogspot.fr/2012/12/simple-direct-quadrilaterals-found-with.html)

![在此处输入图像描述](https://i.stack.imgur.com/cohEb.png)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-28T07:30:07.357

解决它很长的路要走，然后优化它。

一个更具体的问题是通过减小相对于正 x 轴的角度来对坐标进行排序。这个角度（以弧度为单位）将由以下函数给出：

```
x>0
    AND y >= 0
       angle = arctan(y/x)
    AND y < 0
       angle = arctan(y/x) + 2*pi
x==0
    AND y >= 0
       angle = 0
    AND y < 0
       angle = 3*pi/2
x<0
    angle = arctan(y/x) + pi 
```

然后，当然，这只是按角度对坐标进行排序的问题。请注意，当且仅当 x > z 时 arctan(w) > arctan(z)，因此您可以优化一个非常容易地相互比较角度的函数。

排序使得角度在一个窗口上单调递减（或者它最多增加一次）有点不同。

代替广泛的证明，我将提到我验证了单个交换操作将按顺时针顺序对 4 个 2D 点进行排序。当然，确定需要哪个交换操作是诀窍。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-30T21:08:17.690

我有一个进一步的改进要添加到我之前的答案中

记住 - 这些是我们可以遇到的情况。

1.  A B C D
2.  ABDC
3.  生物多样性公约
4.  数据库
5.  中国农业银行
6.  ADCB

如果 ABC 是逆时针方向（有负符号区域），那么我们处于第 3、4、6 种情况。如果我们在这种情况下交换 B 和 C，则剩下以下可能性：

1.  A B C D
2.  ABDC
3.  A B C D
4.  ABDC
5.  中国农业银行
6.  中国农业银行

接下来我们可以检查 ABD 并在逆时针方向交换 B 和 D（案例 5、6）

1.  A B C D
2.  ABDC
3.  A B C D
4.  ABDC
5.  ABDC
6.  ABDC

最后，我们需要检查 ACD，如果 ACD 是逆时针方向，则交换 C & D。现在我们知道我们的观点都是有序的。

这种方法不如我之前的方法效率高——这需要每次检查 3 次，并且需要多次交换；但代码会简单得多。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-27T11:56:39.160

```
var arr = [{x:3,y:3},{x:4,y:1},{x:0,y:2},{x:5,y:2},{x:1,y:1}];
var reference = {x:2,y:2};
arr.sort(function(a,b)  {
    var aTanA = Math.atan2((a.y - reference.y),(a.x - reference.x));
    var aTanB = Math.atan2((b.y - reference.y),(b.x - reference.x));
    if (aTanA < aTanB) return -1;
    else if (aTanB < aTanA) return 1;
    return 0;
});
console.log(arr); 
```

参考点位于多边形内的位置。

更多信息在这个[网站](http://social.msdn.microsoft.com/Forums/en/csharplanguage/thread/c4c0ce02-bbd0-46e7-aaa0-df85a3408c61)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-05-15T07:26:10.640

如果您只需要处理 4 个点，那么有一种最简单的方法可以做到这一点

1.  按 y 值排序

2.  顶行是前两点，底行是其余 2 点

3.  对于顶行和底行，按 x 值排序

.

```
corners.sort(key=lambda ii: ii[1], reverse=True)
topRow = corners[0:2]
bottomRow = corners[2:]

topRow.sort(key=lambda ii: ii[0])
bottomRow.sort(key=lambda ii: ii[0])
# clockwise
return [topRow[0], topRow[1], bottomRow[1], bottomRow[0]] 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-28T06:45:14.547

我相信您是对的，单次交换可以确保由平面中的四个点表示的多边形是凸的。仍有待回答的问题是：

*   这组四个点是凸多边形吗？
*   如果不是，那么需要交换哪两点？
*   哪个方向是顺时针？

进一步思考，我认为上面第二个问题的唯一答案是“中间两个”。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-28T07:27:38.423

这个怎么样？

```
// Take signed area of ABC.
// If negative,
//     Swap B and C.
// Otherwise,
//     Take signed area of ACD.
//     If negative, swap C and D. 
```

想法？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-28T10:09:11.920

如果我们假设点 x 大于点 y 如果它与点 (0,0) 的夹角更大，那么我们可以在 c# 中以这种方式实现

```
 class Point : IComparable<Point>
    {
        public int X { set; get; }
        public int Y { set; get; }

        public double Angle
        {
            get
            {
                return Math.Atan2(X, Y);
            }
        }

        #region IComparable<Point> Members

        public int CompareTo(Point other)
        {
            return this.Angle.CompareTo(other.Angle);
        }

        #endregion

        public static List<Point>  Sort(List<Point> points)
        {
            return points.Sort();
        }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-29T03:05:01.667

```
if AB crosses CD
   swap B,C
elif AD crosses BC
   swap C,D

if area (ABC) > 0
   swap B,D

(I mean area(ABC) > 0 when A->B->C is counter-clockwise).
Let p*x + q*y + r = 0 be the straight line that joins A and B.
Then AB crosses CD if  p*Cx + q*Cy + r  and  p*Dx + q*Dy + r
have different sign, i.e. their product is negative. 
```

第一个“if/elif”以顺时针*或*逆时针顺序带来四个点。（因为你的多边形是凸的，唯一的“交叉”选项是“AC 与 BD”，这意味着这四个点已经排序。）最后一个“if”在逆时针方向反转。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-29T03:25:58.927

你应该看看格雷厄姆的扫描。当然，您需要对其进行调整，因为它会逆时针找到指向。

ps：这对于4分来说可能有点过分了，但是如果点数增加它可能会很有趣

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-10-28T08:10:20.863

Wedge 的回答是正确的。

为了轻松实现它，我认为与 smacl 相同：您需要找到边界的中心并将您的点转换到该中心。

像这样：

```
centerPonintX = Min(x) + (  (Max(x) – Min(x)) / 2  )
centerPonintY = Min(y) + (  (Max(y) – Min(y)) / 2  ) 
```

然后，从每个点减少 centerPointX 和 centerPointY 以将其转换为边界的原点。

最后，只需一个转折即可应用 Wedge 的解决方案：获取每个实例的 arctan(x/y) 的绝对值（这样对我有用）。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-10-28T09:57:28.183

```
if( (p2.x-p1.x)*(p3.y-p1.y) > (p3.x-p1.x)*(p2.y-p1.y) )
    swap( &p1, &p3 ); 
```

'>' 可能面对错误的方向，但你明白了。

# ruby-on-rails - 通过 gmail 从不同帐户发送电子邮件

> ID：242406
> 
> 赞同：2
> 
> 时间：2008-10-28T06:37:52.220
> 
> 标签：ruby-on-rails, email, gmail

所以我有 action_mailer_optional_tls （[http://svn.douglasfshearer.com/rails/plugins/action_mailer_optional_tls](http://svn.douglasfshearer.com/rails/plugins/action_mailer_optional_tls)），这在我的 enviroment.rb

```
ActionMailer::Base.server_settings = {
  :tls => true,
  :address => "smtp.gmail.com",
  :port => "587",
  :domain => "www.somedomain.com",
  :authentication => :plain,
  :user_name => "someusername",
  :password => "somepassword"
} 
```

但是现在如果我想从不同的电子邮件帐户发送电子邮件怎么办？如何即时覆盖用户名和密码字段？

我正在寻找的是一种允许在帐户之间动态切换的解决方案。例如以下场景：10 个“管理员”可以向我们的客户发送通知。每个人都有自己的 gmail 帐户，当他们在网站上填写表格时，rails 使用他们的帐户连接并发送邮件。

提前致谢！

阿里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T18:36:30.507

我现在无法验证这是否有效，但您应该尝试即时修改这些设置。即在发送电子邮件之前从用户帐户中设置用户名/密码。您甚至可以在控制器上设置一个前置过滤器来加载该信息。

```
before_filter :load_email_settings

def load_email_settings
  ActionMailer::Base.server_settings.merge!(:user_name => current_user.email, :password => current_user.email_password)
end

def current_user
   @current_user ||= User.find(session[:user_id])
end 
```

请注意，将用户电子邮件密码存储为纯文本是非常危险的，我不知道是否有任何方法可以使用 Google 帐户的 [第三方身份验证](http://code.google.com/apis/accounts/docs/AuthForWebApps.html)方案来执行您想要的操作，但您可能想检查一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T08:42:58.023

如果您想为目标接收者的回复使用不同的电子邮件地址，您可以为 SMTP 协议指定 Reply-To: otheremail@example.com 并仍然使用 google smtp 服务的现有帐户。

但是，您需要转到 Gmail 设置以将 otheremail@example.com 添加到“发送电子邮件为”列表中，这还需要您通过发送指向该收件箱的链接来确认 otheremail@example.com 是您的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-14T07:03:09.657

从 Rails 2.3 开始，`action_mailer_optional_tls`插件不是必需的。相反，您应该将以下内容放入您的`environment.rb`:

```
config.action_mailer.delivery_method = :smtp 
config.action_mailer.smtp_settings = { 
  :enable_starttls_auto => :true, 
  :address => "smtp.gmail.com", 
  :port => 587, 
  :domain => "mydomain.example.com", 
  :authentication => :plain, 
  :user_name => "myaddress@example.com", 
  :password => "xxxxxxx", 
  :tls => :true 
} 
config.action_mailer.perform_deliveries = :true 
config.action_mailer.raise_delivery_errors = :true 
config.action_mailer.default_charset = "utf-8" 
```

# apache - 在 Apache Tomcat 5.5 上播放 FLV 时出现问题

> ID：242415
> 
> 赞同：0
> 
> 时间：2008-10-28T06:49:04.197
> 
> 标签：apache, tomcat, flv

我在播放 FLV 文件时遇到问题，当我将它放在服务器上时，它 id 嵌入到我的 swf 中，swf 可以正确播放但 FLV 不能播放

任何解决方案都将受到高度赞赏。

* * *

感谢所有回复，它现在可以在除 IE 6 之外的所有浏览器中使用，

我将把 flv 的代码粘贴到 chk 中。

```
var videopath:String;
var flvtime:String;
var vidPlaying:Boolean = false;
var audio_sound:Sound = new Sound(vflvPlayback);

videopath = "/public/ANS/test/flash/Price_video.flv";

flvtime = ":00/:17";
time_txt.text = flvtime;

endClip_mc.moreabout_btn.enabled = false;
endClip_mc.send_btn.enabled = false;
endClip_mc.replay_btn.enabled = false;

import mx.video.*;
vflvPlayback.contentPath = videopath;
vflvPlayback.stopButton = my_stopbttn;
vflvPlayback.playPauseButton = my_playbttn;
vflvPlayback.seekBar = my_scrubber;
vflvPlayback.playheadUpdateInterval = 17;
var vid_time:Number;
var listenerObject:Object = new Object();
listenerObject.playheadUpdate = function(eventObject:Object):Void  {
    if (eventObject.playheadTime == undefined || vflvPlayback.totalTime == undefined || vflvPlayback.totalTime == 0) {
        return;
    }
    vid_time = Math.floor(eventObject.playheadTime);
    vid_mins = Math.floor(vid_time/60);
    vid_secs = Math.floor(vid_time%60);
    if (vid_secs<10) {
        vid_secs = "0"+vid_secs;
    }
    if (vid_mins<10) {
        vid_mins = "0"+vid_mins;
    }
    time_txt.text = ":"+vid_secs+"/:17";
    var percentPlayed:Number = eventObject.playheadTime/vflvPlayback.totalTime*100;

    if (percentPlayed>=2) {
        this.placeHolder._visible = false;
    }

    vflvPlayback.complete = function(eventObject:Object):Void  {

        vidComplete();
    };

    bar_mc._xscale = (vflvPlayback.totalTime == undefined || isNaN(percentPlayed)) ? 0 : percentPlayed;
};

vflvPlayback.addEventListener("playheadUpdate",listenerObject);

function vidComplete():Void {
    this.attachMovie("gfxFlash","flashFade",1000,{_x:-2, _y:10.5});
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T21:50:06.717

As said before check the mime type on the server.

If the FLV is playing in some browsers and not in others there is probably an issue with the Flash Player. First in all browsers go the URL where the FLV lives on the server so see if you actually access the file from a browser. Then check for each browser separately what Flash player version installed. E.g. If you're trying to play H264 video on Flash Player 8 it's not going to work.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T07:02:10.567

*“阿帕奇 5.5”*？Apache httpd 仅适用于 2.x，所以我们可以假设您的意思是 Apache Tomcat 5.5？或者？？？ **需要更多信息。** 如果可以的话，甚至可能是一个链接。Flash 播放器非常适合通过 HTTP 播放有效的 FLV 视频文件，即使是错误的 mime 类型标头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T09:07:58.097

在 IIS 中，您需要将 .flv 扩展名添加到已知的 mime 类型，否则文件将被阻止。也许Tomcat需要类似的东西。

FLV mime = '视频/x-flv'

# c# - 一次循环遍历 2 个列表

> ID：242417
> 
> 赞同：23
> 
> 时间：2008-10-28T06:51:50.837
> 
> 标签：c#, list

我有两个长度相同的列表，是否可以一次遍历这两个列表？

我正在寻找正确的语法来执行以下操作

```
foreach itemA, itemB in ListA, ListB
{
  Console.WriteLine(itemA.ToString()+","+itemB.ToString());
} 
```

你认为这在 C# 中是可能的吗？如果是，与此等效的 lambda 表达式是什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-28T06:54:23.327

[编辑]：澄清；**这在不能使用**`IEnumerable<T>`索引器的通用 LINQ/上下文中很有用，因为 a：它不存在于可枚举对象中，并且 b：您不能保证可以多次读取数据。由于 OP 提到了 lambda，因此 LINQ 可能不会太远（是的，我确实意识到 LINQ 和 lambda 并不完全相同）。

 **听起来您需要缺少的`Zip`运算符；你可以欺骗它：

```
static void Main()
{
    int[] left = { 1, 2, 3, 4, 5 };
    string[] right = { "abc", "def", "ghi", "jkl", "mno" };

    // using KeyValuePair<,> approach
    foreach (var item in left.Zip(right))
    {
        Console.WriteLine("{0}/{1}", item.Key, item.Value);
    }

    // using projection approach
    foreach (string item in left.Zip(right,
        (x,y) => string.Format("{0}/{1}", x, y)))
    {
        Console.WriteLine(item);
    }
}

// library code; written once and stuffed away in a util assembly...

// returns each pais as a KeyValuePair<,>
static IEnumerable<KeyValuePair<TLeft,TRight>> Zip<TLeft, TRight>(
    this IEnumerable<TLeft> left, IEnumerable<TRight> right)
{
    return Zip(left, right, (x, y) => new KeyValuePair<TLeft, TRight>(x, y));
}

// accepts a projection from the caller for each pair
static IEnumerable<TResult> Zip<TLeft, TRight, TResult>(
    this IEnumerable<TLeft> left, IEnumerable<TRight> right,
    Func<TLeft, TRight, TResult> selector)
{
    using(IEnumerator<TLeft> leftE = left.GetEnumerator())
    using (IEnumerator<TRight> rightE = right.GetEnumerator())
    {
        while (leftE.MoveNext() && rightE.MoveNext())
        {
            yield return selector(leftE.Current, rightE.Current);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-28T06:56:19.343

只是在一个普通的旧 for 循环中执行它会更简单......

```
for(int i=0; i<ListA.Length; i++)
{
    Console.WriteLine(ListA[i].ToString() + ", " + ListB[i].ToString());
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-28T07:06:38.887

你可以明确地做到这一点。

```
IEnumerator ListAEnum = ListA.GetEnumerator();
IEnumerator ListBEnum = ListB.GetEnumerator();

ListBEnum.MoveNext();
while(ListAEnum.MoveNext()==true)
{
  itemA=ListAEnum.getCurrent();
  itemB=ListBEnum.getCurrent();
  Console.WriteLine(itemA.ToString()+","+itemB.ToString());
} 
```

至少这个（或类似的东西）是编译器为 foreach 循环所做的。我还没有测试过它，我猜枚举器缺少一些模板参数。

只需从 List 和 IEnumerator-Interface 中查找 GetEnumerator()。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-28T08:34:47.023

我建议使用普通的 for 循环，但您应该考虑不同的数组长度。所以

```
for(int i=0; i<ListA.Length; i++)
{
    Console.WriteLine(ListA[i].ToString() + ", " + ListB[i].ToString());
} 
```

可以变成

```
for(int i = 0; i < Math.Min(ListA.Length, ListB.Lenght); i++)
{
    Console.WriteLine(ListA[i].ToString() + ", " + ListB[i].ToString());
} 
```

甚至进入

```
 for(int i = 0; i < Math.Max(ListA.Length, ListB.Lenght); i++)
    {
        string valueA = i < ListA.Length ? listA[i].ToString() : "";
        string valueB = i < ListB.Length ? listB[i].ToString() : "";

        Console.WriteLine(valueA+ ", " + valueB);
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-29T18:57:43.140

我遇到了同样的问题，但是使用其中包含列表的对象列表..对于它的价值，这可能会帮助遇到同样问题的人。

由于 IndexOf 为 O(n)，因此它的运行时间不是很好，但当时，我处理的内部 foreach 循环比本示例中的要多得多，所以我不想处理迭代器变量。

在这样的时候，我非常想念 PHPs foreach($arrayList as $key => $value) 表示法......也许我在 C# 中遗漏了一些东西，必须有一种方法可以在 O(c) 时间内获取索引！（遗憾的是这篇文章说不：[在'foreach'循环中获取数组键](https://stackoverflow.com/questions/60032/getting-the-array-key-in-a-foreach-loop)）

```
class Stock {
   string symbol;
   List<decimal> hourlyPrice; // provides a list of 24 decimals
}

// get hourly prices from yesterday and today
List<Stock> stockMondays = Stocks.GetStock("GOOGL,IBM,AAPL", DateTime.Now.AddDay(-1));
List<Stock> stockTuesdays = Stocks.GetStock("GOOGL,IBM,AAPL", DateTime.Now);

try {
    foreach(Stock sMonday in stockMondays) {
        Stock sTuesday = stockTuesday[stockMondays.IndexOf(sMonday)];

        foreach(decimal mondayPrice in sMonday.prices) {
            decimal tuesdayPrice = sTuesday.prices[sMonday.prices.IndexOf(mondayPrice)];
            // do something now
        }

    }
} catch (Exception ex) { // some reason why list counts aren't matching? } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-06-22T18:28:00.690

# 现代答案

LINQ 现在有一个[内置的 Zip 方法](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.zip)，因此您无需创建自己的方法。结果序列与最短输入一样长。Zip 目前（从 .NET Core 3.0 开始）有 2 个重载。更简单的返回一个元组序列。它让我们可以生成一些非常接近原始请求的非常简洁的代码：

```
int[] numbers = { 1, 2, 3, 4 };
string[] words = { "one", "two", "three" };

foreach (var (number, word) in numbers.Zip(words))
    Console.WriteLine($"{number}, {word}");

// 1, one
// 2, two
// 3, three 
```

或者，同样的事情，但没有元组解包：

```
foreach (var item in numbers.Zip(words))
    Console.WriteLine($"{item.First}, {item.Second}"); 
```

另一个重载（出现在 Core 3.0 之前）采用映射函数，让您可以更好地控制结果。这个例子返回一个字符串序列，但你可以返回一个任意序列（例如一些自定义类）。

```
var numbersAndWords = numbers.Zip(words, (number, word) => $"{number}, {word}");

foreach (string item in numbersAndWords)
    Console.WriteLine(item); 
```

如果您在常规对象上使用 LINQ（而不是使用它来生成 SQL），您还可以查看[MoreLINQ](https://github.com/morelinq/MoreLINQ)，它提供了几种压缩方法。这些方法中的每一个都需要最多 4 个输入序列，而不仅仅是 2 个：

*   `EquiZip`- 如果输入序列的长度不同，则会引发异常。

*   `ZipLongest`- 结果序列将始终与最长的输入序列一样长，其中每个较短序列元素类型的默认值用于填充。

*   `ZipShortest`- 生成的序列与最短的输入序列一样短。

请参阅他们的[示例](https://github.com/morelinq/examples)和/或使用[测试](https://github.com/morelinq/MoreLINQ/tree/master/MoreLinq.Test)。似乎 MoreLINQ 的压缩比普通的 LINQ 早，所以如果你坚持使用旧版本的 .NET，它可能是一个不错的选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-08T09:06:28.817

我有这个小函数可以帮助我遍历这两个列表对象。schema 是 SqlData 类型，它是一个包含三个属性的类。data 是一个包含动态类型值的列表。首先，我遍历模式集合，而不是使用项目的索引来遍历数据对象。

```
public List<SqlData> SqlDataBinding(List<SqlData> schema, List<dynamic> data)
{
    foreach (SqlData item in schema)
    {
        item.Values = data[schema.IndexOf(item)];
    }
    return schema
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-28T07:38:07.810

[Senthil Kumar 的技术博客](http://msmvps.com/blogs/senthil/default.aspx)有一系列涵盖**C# 的 (Python) Itertools 的实现**，包括[`itertools.izip`](http://docs.python.org/library/itertools.html#itertools.izip).

从[Itertools for C# - Cycle 和 Zip](http://msmvps.com/blogs/senthil/archive/2008/04/26/itertools-for-c-cycle-and-zip.aspx)，您可以找到任意数量的*可迭代*对象（不仅是*List<T>*）的解决方案。请注意，每次迭代都会`Zip`产生一个：`Array`

```
public static IEnumerable<T[]> Zip<T>(params IEnumerable<T>[] iterables)
{
IEnumerator<T>[] enumerators = Array.ConvertAll(iterables, (iterable) =>   iterable.GetEnumerator());

while (true)
{
   int index = 0;
   T[] values = new T[enumerators.Length];

   foreach (IEnumerator<T> enumerator in enumerators)
   {
       if (!enumerator.MoveNext())
          yield break;

        values[index++] = enumerator.Current;
   }

   yield return values;
} 
```

}

> 代码获取所有可迭代对象的枚举器，将所有枚举器向前移动，将它们的当前值累积到一个数组中并生成数组。它会这样做，直到任何一个枚举器用完元素。

# sql-server - 为什么我不能在 Windows 身份验证模式下使用 SQL Express 从桌面上的 .BAK 文件中读取

> ID：242421
> 
> 赞同：1
> 
> 时间：2008-10-28T06:54:45.993
> 
> 标签：sql-server, windows-authentication

我正在尝试在 SQL Express 中恢复 .BAK 文件之前执行此 SQL 查询。最初，我在我的用户帐户的桌面上有该文件。我以管理员身份登录。

当我尝试像这样访问桌面上的 .BAK 文件时

```
RESTORE FILELISTONLY FROM DISK= 'C:\Documents and Settings\Administrator\Desktop\file.bak' 
```

我得到一个错误。

```
消息 3201，第 16 层，状态 2，第 1 行
无法打开备份设备“C:\Documents and Settings\Administrator\Desktop\file.bak”。操作系统错误 5（拒绝访问。）。
消息 3013，第 16 级，状态 1，第 1 行
RESTORE FILELIST 异常终止。
```

但是，当我将 .BAK 文件移动到`C:\temp`，并执行此

```
RESTORE FILELISTONLY FROM DISK= 'C:\temp\file.bak' 
```

它工作得很好。

我无法弄清楚发生了什么。有没有办法使用带有 SQL Express 的 Windows 身份验证访问桌面上的文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-28T07:02:22.157

尝试在策略编辑器中授予**用户**或**本地服务**对文件夹 C:\Documents and Settings\Administrator\Desktop\ 的读取权限（右键单击该文件夹，然后在安全选项卡中单击添加...，然后单击高级...|立即查找

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T10:37:56.480

当您运行恢复脚本时，它是在运行 SQL Express 的服务帐户的上下文中执行的。转到服务管理控制台（或运行 Services.msc）并找到 SQL Express 服务并查看它配置为在哪个帐户下运行，然后查看桌面上文件的权限并确保该帐户具有读取权限.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-28T12:38:06.890

在 SQL Server 2008R2 SP1 之后，您无需转到服务管理控制台（或运行 Services.msc）来查找运行 sql server 服务的帐户。

只需使用以下代码：

```
select * from
sys.dm_server_services

SELECT  DSS.servicename,
        DSS.startup_type_desc,
        DSS.status_desc,
        DSS.last_startup_time,
        DSS.service_account,
        DSS.is_clustered,
        DSS.cluster_nodename,
        DSS.filename,
        DSS.startup_type,
        DSS.status,
        DSS.process_id
FROM    sys.dm_server_services AS DSS; 
```

# iphone - 如何“旋转”图层/视图（例如，就像在 enigmo 中一样）

> ID：242424
> 
> 赞同：11
> 
> 时间：2008-10-28T07:00:21.067
> 
> 标签：iphone, objective-c, cocoa-touch

我知道如何根据触摸移动图层。但我也希望能够旋转图像。

是否有任何示例代码显示如何执行此操作？或者谁能​​给我一些建议？

谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-28T10:48:22.950

最简单的方法是使用图层的变换属性：

```
float   angle = M_PI;  //rotate 180°, or 1 π radians
layer.transform = CATransform3DMakeRotation(angle, 0, 0.0, 1.0); 
```

CATransform3DMakeRotation 函数的第一个参数是旋转量，以弧度为单位。接下来的三个描述了要围绕其旋转的向量。这是描述 z 轴上的矢量，因此有效地垂直于屏幕。这将旋转图层，使其上下颠倒。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-28T20:31:56.470

我最终这样做了：

```
CGAffineTransform transform = CGAffineTransformMakeRotation(angle);
[[self viewWithTag:999] setTransform:transform]; 
```

请注意，角度以弧度为单位。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T09:10:24.190

您将使用视图的变换属性。iPhone OS Programming Guide 中有一些旋转视图的示例代码，在[Launching in Landscape Mode 下](https://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/chapter_3_section_6.html#//apple_ref/doc/uid/TP40007072-CH7-SW18 "以横向模式启动")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T09:32:49.280

您应该查看 Apple 的[MoveMe](https://developer.apple.com/iphone/library/samplecode/MoveMe/index.html)示例，了解如何根据触摸在图层中移动。它还会在您执行此操作时应用一些缩放变换，因此这应该作为应用旋转变换的合理示例。

# active-directory - Active Directory 林信任是否可传递？

> ID：242426
> 
> 赞同：2
> 
> 时间：2008-10-28T07:01:36.323
> 
> 标签：active-directory, trust, transitivity

我正在对正在开发的应用程序进行故障排除，该应用程序在多林环境中使用来自 Active Directory 的信息，我目前的问题是确定林信任是否是可传递的，如果是在什么条件下传递。

设置：使用 Active Directory 2003，**ForestA与****ForestB**具有双向林信任。 **ForestB与****ForestC**具有双向森林信任。

 ******在这种情况下，ForestA 和 ForestC 之间是否存在某种信任关系？我发现了一些相互矛盾的信息；第一个链接清楚地表明森林信任不传递到其他森林：

[森林信托](http://technet.microsoft.com/en-us/library/cc755700.aspx)

林信任只能在两个林之间创建，不能隐式扩展到第三个林。这意味着，如果在林 1 和林 2 之间创建了林信任，并且在林 2 和林 3 之间也创建了林信任，则林 1 将不会与林 3 建立隐式信任。

但是，我还可以在信任类型列表中找到森林信任是可传递的指示：

[信任类型](http://technet.microsoft.com/en-us/library/cc775736.aspx)

信任类型：森林传递性：传递性

当通过“管理域和信任”查看时，在此林信任的顶部，在 Active Directory 信任列表中显示为“可传递”

这是否意味着森林信任在信任森林内是可传递*的*，但不能传递到其他森林？所以在前面提到的场景中：

**森林A** <->**森林**B <->**森林C**

子域将通过传递性获得森林信任（因此 subdom1\. **ForestA**将信任 office7\. **ForestB ）但****ForestA**和**ForestB**之间将共享访问权限。这是正确的，还是我对微软发布的相当混乱的信息感到困惑？有没有人有这方面的亲身经历可以分享？

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T04:24:00.367

三个域的测试表明来自[林信任](http://technet.microsoft.com/en-us/library/cc755700.aspx)的信息是正确的；当我在配置 ForestA <-> ForestB <-> ForestC 中设置三个森林时，ForestA 无法从 ForestC 中看到任何凭据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T05:06:38.190

具体来说，我相信微软的传递林信任中的“传递”是针对每个林内的域，而不是林到林到林。

例如

具有根域 A 和两个子域 B 和 C 的林 1 具有根域 X 和两个子域 Y 和 Z 的林 2

使用传递林信任域 Z 将自动信任域 C，而无需创建直接信任链接（快捷信任）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-25T21:14:31.710

跨森林信任是不可传递的。父/子域/树信任是...

[http://technet.microsoft.com/en-us/library/cc773178(WS.10).aspx](http://technet.microsoft.com/en-us/library/cc773178(WS.10).aspx)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-28T07:27:55.460

NT 4 域信任不是以这种方式传递的。不确定AD。

# java - 在循环中重用 StringBuilder 会更好吗？

> ID：242438
> 
> 赞同：104
> 
> 时间：2008-10-28T07:09:37.790
> 
> 标签：java, performance, string, stringbuilder

我有一个关于使用 StringBuilder 的性能相关问题。在一个很长的循环中，我正在操作 a`StringBuilder`并将其传递给另一个方法，如下所示：

```
for (loop condition) {
    StringBuilder sb = new StringBuilder();
    sb.append("some string");
    . . .
    sb.append(anotherString);
    . . .
    passToMethod(sb.toString());
} 
```

`StringBuilder`在每个循环周期实例化是一个好的解决方案吗？并且调用删除更好，如下所示？

```
StringBuilder sb = new StringBuilder();
for (loop condition) {
    sb.delete(0, sb.length);
    sb.append("some string");
    . . .
    sb.append(anotherString);
    . . .
    passToMethod(sb.toString());
} 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-10-28T07:17:45.183

在我的迷你基准测试中，第二个大约快 25%。

```
public class ScratchPad {

    static String a;

    public static void main( String[] args ) throws Exception {
        long time = System.currentTimeMillis();
        for( int i = 0; i < 10000000; i++ ) {
            StringBuilder sb = new StringBuilder();
            sb.append( "someString" );
            sb.append( "someString2"+i );
            sb.append( "someStrin4g"+i );
            sb.append( "someStr5ing"+i );
            sb.append( "someSt7ring"+i );
            a = sb.toString();
        }
        System.out.println( System.currentTimeMillis()-time );
        time = System.currentTimeMillis();
        StringBuilder sb = new StringBuilder();
        for( int i = 0; i < 10000000; i++ ) {
            sb.delete( 0, sb.length() );
            sb.append( "someString" );
            sb.append( "someString2"+i );
            sb.append( "someStrin4g"+i );
            sb.append( "someStr5ing"+i );
            sb.append( "someSt7ring"+i );
            a = sb.toString();
        }
        System.out.println( System.currentTimeMillis()-time );
    }
} 
```

结果：

```
25265
17969 
```

请注意，这适用于 JRE 1.6.0_07。

* * *

基于 Jon Skeet 在编辑中的想法，这里是第 2 版。虽然结果相同。

```
public class ScratchPad {

    static String a;

    public static void main( String[] args ) throws Exception {
        long time = System.currentTimeMillis();
        StringBuilder sb = new StringBuilder();
        for( int i = 0; i < 10000000; i++ ) {
            sb.delete( 0, sb.length() );
            sb.append( "someString" );
            sb.append( "someString2" );
            sb.append( "someStrin4g" );
            sb.append( "someStr5ing" );
            sb.append( "someSt7ring" );
            a = sb.toString();
        }
        System.out.println( System.currentTimeMillis()-time );
        time = System.currentTimeMillis();
        for( int i = 0; i < 10000000; i++ ) {
            StringBuilder sb2 = new StringBuilder();
            sb2.append( "someString" );
            sb2.append( "someString2" );
            sb2.append( "someStrin4g" );
            sb2.append( "someStr5ing" );
            sb2.append( "someSt7ring" );
            a = sb2.toString();
        }
        System.out.println( System.currentTimeMillis()-time );
    }
} 
```

结果：

```
5016
7516 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-06-22T06:20:33.010

更快：

```
public class ScratchPad {

    private static String a;

    public static void main( String[] args ) throws Exception {
        final long time = System.currentTimeMillis();

        // Pre-allocate enough space to store all appended strings.
        // StringBuilder, ultimately, uses an array of characters.
        final StringBuilder sb = new StringBuilder( 128 );

        for( int i = 0; i < 10000000; i++ ) {
            // Resetting the string is faster than creating a new object.
            // Since this is a critical loop, every instruction counts.
            sb.setLength( 0 );
            sb.append( "someString" );
            sb.append( "someString2" );
            sb.append( "someStrin4g" );
            sb.append( "someStr5ing" );
            sb.append( "someSt7ring" );
            setA( sb.toString() );
        }

        System.out.println( System.currentTimeMillis() - time );
    }

    private static void setA( final String aString ) {
        a = aString;
    }
} 
```

在编写可靠代码的哲学中，方法的内部工作对客户端对象是隐藏的。因此，无论您重新声明`StringBuilder`循环内还是循环外，从系统的角度来看都没有区别。由于在循环之外声明它更快，并且不会使代码变得更加复杂，因此重用该对象。

即使它要复杂得多，并且您确定对象实例化是瓶颈，也请对其进行注释。

三个运行这个答案：

```
$ java ScratchPad
1567
$ java ScratchPad
1569
$ java ScratchPad
1570 
```

三个运行与另一个答案：

```
$ java ScratchPad2
1663
2231
$ java ScratchPad2
1656
2233
$ java ScratchPad2
1658
2242 
```

虽然不重要，但设置`StringBuilder`的初始缓冲区大小以防止内存重新分配，将带来小的性能提升。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-10-28T07:14:30.150

在编写可靠代码的哲学中，将 StringBuilder 放在循环中总是更好。这样它就不会超出其预期的代码。

其次，StringBuilder 最大的改进来自于给它一个初始大小以避免它在循环运行时变得更大

```
for (loop condition) {
  StringBuilder sb = new StringBuilder(4096);
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-10-28T08:18:59.460

好的，我现在明白发生了什么，这确实有道理。

我的印象是`toString`只是将底层传递给了一个*不*带副本`char[]`的 String 构造函数。然后将在下一个“写”操作（例如）中进行复制。我相信在以前的某些版本中*就是*这种情况。（现在不是。）但是没有 -只是将数组（以及索引和长度）传递给获取副本的公共构造函数。*`delete`*`StringBuffer``toString``String`**

 **因此，在“重用`StringBuilder`”的情况下，我们真正为每个字符串创建了一个数据副本，始终在缓冲区中使用相同的 char 数组。显然，`StringBuilder`每次创建一个新的缓冲区都会创建一个新的底层缓冲区 - 然后在创建新字符串时复制该缓冲区（在我们的特定情况下有点毫无意义，但出于安全原因这样做）。

所有这一切导致第二个版本肯定更有效率——但同时我仍然会说它是更丑陋的代码。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-30T13:07:51.450

由于我认为还没有被指出，由于 Sun Java 编译器内置的优化，当它看到字符串连接时会自动创建 StringBuilders（StringBuffers pre-J2SE 5.0），问题中的第一个示例相当于：

```
for (loop condition) {
  String s = "some string";
  . . .
  s += anotherString;
  . . .
  passToMethod(s);
} 
```

哪个更具可读性，IMO，更好的方法。您的优化尝试可能会在某些平台上带来收益，但可能会在其他平台上造成损失。

但是，如果您确实遇到了性能问题，那么当然可以优化。不过，根据 Jon Skeet，我将从显式指定 StringBuilder 的缓冲区大小开始。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-28T07:12:29.093

现代 JVM 对这类事情非常聪明。我不会再猜测它并做一些难以维护/可读性较差的骇人听闻的事情......除非你对生产数据进行适当的基准测试，以验证非平凡的性能改进（并记录它;）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-28T07:17:24.777

根据我在 Windows 上开发软件的经验，我会说在循环期间清除 StringBuilder 比在每次迭代中实例化 StringBuilder 具有更好的性能。清除它可以释放该内存以立即覆盖，而无需额外分配。我对 Java 垃圾收集器不够熟悉，但我认为释放和不重新分配（除非你的下一个字符串增长 StringBuilder）比实例化更有益。

（我的观点与其他人的建议相反。嗯。是时候对它进行基准测试了。）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-09-29T07:03:22.653

最快的方法是使用“setLength”。它不会涉及复制操作。**新建 StringBuilder 的方式应该是彻底淘汰了**。StringBuilder.delete(int start, int end) 的缓慢是因为它将再次复制数组以调整大小。

```
 System.arraycopy(value, start+len, value, start, count-end); 
```

之后， StringBuilder.delete() 会将 StringBuilder.count 更新为新的大小。虽然 StringBuilder.setLength() 只是简化了将*StringBuilder.count*更新为新大小。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-16T01:22:08.923

执行“setLength”或“delete”提高性能的原因主要是代码“学习”正确的缓冲区大小，而不是进行内存分配。通常，[我建议让编译器进行字符串优化](http://www.theeggeadventure.com/wikimedia/index.php/String_Concatenation_optimization)。但是，如果性能很关键，我通常会预先计算缓冲区的预期大小。默认 StringBuilder 大小为 16 个字符。如果您超出此范围，则必须调整大小。调整大小是性能丢失的地方。这是另一个说明这一点的迷你基准：

```
private void clear() throws Exception {
    long time = System.currentTimeMillis();
    int maxLength = 0;
    StringBuilder sb = new StringBuilder();

    for( int i = 0; i < 10000000; i++ ) {
        // Resetting the string is faster than creating a new object.
        // Since this is a critical loop, every instruction counts.
        //
        sb.setLength( 0 );
        sb.append( "someString" );
        sb.append( "someString2" ).append( i );
        sb.append( "someStrin4g" ).append( i );
        sb.append( "someStr5ing" ).append( i );
        sb.append( "someSt7ring" ).append( i );
        maxLength = Math.max(maxLength, sb.toString().length());
    }

    System.out.println(maxLength);
    System.out.println("Clear buffer: " + (System.currentTimeMillis()-time) );
}

private void preAllocate() throws Exception {
    long time = System.currentTimeMillis();
    int maxLength = 0;

    for( int i = 0; i < 10000000; i++ ) {
        StringBuilder sb = new StringBuilder(82);
        sb.append( "someString" );
        sb.append( "someString2" ).append( i );
        sb.append( "someStrin4g" ).append( i );
        sb.append( "someStr5ing" ).append( i );
        sb.append( "someSt7ring" ).append( i );
        maxLength = Math.max(maxLength, sb.toString().length());
    }

    System.out.println(maxLength);
    System.out.println("Pre allocate: " + (System.currentTimeMillis()-time) );
}

public void testBoth() throws Exception {
    for(int i = 0; i < 5; i++) {
        clear();
        preAllocate();
    }
} 
```

结果显示重用对象比创建预期大小的缓冲区快约 10%。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-12-17T05:05:00.933

大声笑，我第一次看到人们通过在 StringBuilder 中组合字符串来比较性能。为此，如果您使用“+”，它可能会更快；D。使用 StringBuilder 的目的是为了加快对整个字符串的检索，作为“局部性”的概念。

在需要频繁检索String值而不需要频繁更改的场景下，Stringbuilder可以提供更高的字符串检索性能。这就是使用 Stringbuilder 的目的.. 请不要 MIS-Test 的核心目的..

有人说，飞机飞得更快。因此，我用我的自行车测试它，发现飞机移动得更慢。你知道我是如何设置实验设置的吗；D

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-06-05T13:53:05.123

没有明显更快，但从我的测试来看，使用 1.6.0_45 64 位平均快几毫秒：使用 StringBuilder.setLength(0) 而不是 StringBuilder.delete()：

```
time = System.currentTimeMillis();
StringBuilder sb2 = new StringBuilder();
for (int i = 0; i < 10000000; i++) {
    sb2.append( "someString" );
    sb2.append( "someString2"+i );
    sb2.append( "someStrin4g"+i );
    sb2.append( "someStr5ing"+i );
    sb2.append( "someSt7ring"+i );
    a = sb2.toString();
    sb2.setLength(0);
}
System.out.println( System.currentTimeMillis()-time ); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-30T00:32:23.457

第一个对人类更好。如果第二个在某些 JVM 的某些版本上更快一些，那又如何呢？

如果性能如此关键，请绕过 StringBuilder 并编写自己的。如果你是一个优秀的程序员，并且考虑到你的应用程序是如何使用这个函数的，你应该能够让它更快。值得吗？可能不是。

为什么这个问题被盯着“最喜欢的问题”？因为性能优化非常有趣，不管它是否实用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-10-22T11:41:30.150

我认为尝试像这样优化性能是没有意义的。今天（2019 年）这两个语句在我的 I5 笔记本电脑上运行 100.000.000 次循环大约 11 秒：

```
 String a;
    StringBuilder sb = new StringBuilder();
    long time = 0;

    System.gc();
    time = System.currentTimeMillis();
    for (int i = 0; i < 100000000; i++) {
        StringBuilder sb3 = new StringBuilder();
        sb3.append("someString");
        sb3.append("someString2");
        sb3.append("someStrin4g");
        sb3.append("someStr5ing");
        sb3.append("someSt7ring");
        a = sb3.toString();
    }
    System.out.println(System.currentTimeMillis() - time);

    System.gc();
    time = System.currentTimeMillis();
    for (int i = 0; i < 100000000; i++) {
        sb.setLength(0);
        sb.delete(0, sb.length());
        sb.append("someString");
        sb.append("someString2");
        sb.append("someStrin4g");
        sb.append("someStr5ing");
        sb.append("someSt7ring");
        a = sb.toString();
    }
    System.out.println(System.currentTimeMillis() - time); 
```

==> 11000 毫秒（循环内声明）和 8236 毫秒（循环外声明）

即使我正在运行具有数十亿个循环的地址重复数据消除程序，也相差 2 秒。1 亿次循环没有任何区别，因为程序运行了几个小时。另请注意，如果您只有一个附加语句，情况会有所不同：

```
 System.gc();
    time = System.currentTimeMillis();
    for (int i = 0; i < 100000000; i++) {
        StringBuilder sb3 = new StringBuilder();
        sb3.append("someString");
            a = sb3.toString();
    }
    System.out.println(System.currentTimeMillis() - time);

    System.gc();
    time = System.currentTimeMillis();
    for (int i = 0; i < 100000000; i++) {
        sb.setLength(0);
        sb.delete(0, sb.length());
        sb.append("someString");
        a = sb.toString();
    }
    System.out.println(System.currentTimeMillis() - time); 
```

==> 3416 msec(inside loop), 3555 msec(outside loop) 在这种情况下，在循环内创建 StringBuilder 的第一条语句更快。而且，如果您更改执行顺序，它会更快：

```
 System.gc();
    time = System.currentTimeMillis();
    for (int i = 0; i < 100000000; i++) {
        sb.setLength(0);
        sb.delete(0, sb.length());
        sb.append("someString");
        a = sb.toString();
    }
    System.out.println(System.currentTimeMillis() - time);

    System.gc();
    time = System.currentTimeMillis();
    for (int i = 0; i < 100000000; i++) {
        StringBuilder sb3 = new StringBuilder();
        sb3.append("someString");
            a = sb3.toString();
    }
    System.out.println(System.currentTimeMillis() - time); 
```

==> 3638 毫秒（外循环），2908 毫秒（内循环）

问候，乌尔里希

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-10-28T13:52:05.153

声明一次，每次分配。这是一个比优化更实用和可重用的概念。

# java - 用于演示 Web 应用程序的 Slim 应用程序服务器？

> ID：242444
> 
> 赞同：3
> 
> 时间：2008-10-28T07:13:02.633
> 
> 标签：java, application-server

我有一个小宠物 web 应用程序项目，我想向自己没有应用程序服务器的人展示（并且对应用程序服务器一无所知）。

什么是他们让我的 WAR 文件以零配置运行的最简单和最快的方法，最好是我可以随 WAR 文件一起发送或捆绑的东西？例如，是否有精简版的 Jetty？还有什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T07:30:35.330

您可以轻松地自己创建精简版。

[http://docs.codehaus.org/display/JETTY/Embedding+Jetty](http://docs.codehaus.org/display/JETTY/Embedding+Jetty)

[http://jetty.mortbay.org/xref/org/mortbay/jetty/example/LikeJettyXml.html](http://jetty.mortbay.org/xref/org/mortbay/jetty/example/LikeJettyXml.html)

要运行嵌入式 Jetty，您只需要类路径中的以下 jar：

```
* servlet-api-2.5-6.x.jar
* jetty-util-6.x.jar
* jetty-6.x.jar

/usr/local/jetty-6.1.4/lib> ls -la servlet-api-2.5-6.1.4.jar jetty-*
-rw-rw-r--  1 wwwrun admin 476213 2007-06-15 08:42 jetty-6.1.4.jar
-rw-rw-r--  1 wwwrun admin 128026 2007-06-15 08:40 jetty-util-6.1.4.jar
-rw-rw-r--  1 wwwrun admin 131977 2007-06-15 08:40 servlet-api-2.5-6.1.4.jar 
```

很轻...

或者，Maven[插件](http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin)也可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T07:20:44.880

如果您使用的是 maven，那么有一个 jetty maven 插件可以将您的战争部署到 jetty 的嵌入式实例。

但即便如此，取决于你的应用需要什么样的东西，jetty 甚至 tomcat 会做什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T02:28:06.600

如果您不知道或不想与 maven 混淆，您可以尝试 Jetty-runner

[https://svn.codehaus.org/jetty-contrib/trunk/jetty-runner](https://svn.codehaus.org/jetty-contrib/trunk/jetty-runner)

jetty-runner.jar 是一个可以从命令行运行的 jar 文件，如下所示：

java -jar jetty-runner.jar my.war

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T07:32:30.333

我肯定会创建一个嵌入码头并使用你的战争的可执行jar。maven 的东西可能没问题，但是自己编写单个 main 函数很容易。

# asp.net - Java脚本中的十进制比较

> ID：242453
> 
> 赞同：0
> 
> 时间：2008-10-28T07:17:20.083
> 
> 标签：asp.net, javascript, scripting

我正在尝试比较 Java 脚本中的两个十进制值。我有两个对象作为一个分配值“3”，另一个作为“3.00”。当我说 if (obj1 == obj2) 它没有像字符串比较那样通过条件。

相反，我希望它在 3 = 3.00 的情况下进行十进制比较。请让我知道如何做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T07:20:55.660

[本页](http://www.javascripter.net/faq/convert2.htm)介绍如何将字符串转换为浮点数；我相信这就是你想要的。这可以让您将数字作为数字进行比较，我认为这就是您所说的“十进制”。请注意，在两个浮点数之间进行精确比较通常被认为有点“危险”，因为存在精度问题可能会导致您认为“相等”的两个数字无法进行比较。例如，参见[What Every Computer Scientist Should Know About Floating-Point Arithmetic](http://docs.sun.com/source/806-3568/ncg_goldberg.html)，这是关于该主题的经典文本。也许有点高级，但在这种情况下尝试寻找更基本的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T07:24:27.010

您还可以进行类型转换：

```
var a = "3.00";
var b = "3";

Number(a) == Number(b) // This will be true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T07:21:54.427

```
if(parseFloat(obj1) == parseFloat(obj2)) { // ... 
```

但请注意 unwind 的回答。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T07:22:24.067

也许您可以像这样尝试 parseFloat() ：

```
if(parseFloat(obj1) == parseFloat(obj2)) 
```

parseFloat() 音乐会要浮动的字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T07:37:36.220

作为字符串，它们不相等。作为整数，它们是，但您的示例暗示浮点数，这是一个问题。由于它们的性质，请避免对浮点数进行相等比较：它们的精度是有限的，在杂项算术之后，您最终可能会比较像 1.0 和 .99999999999 这样的数字并得到“不相等”。

# php - 我需要帮助在 Facebook 应用程序中创建改装系统

> ID：242463
> 
> 赞同：1
> 
> 时间：2008-10-28T07:22:08.527
> 
> 标签：php, facebook

我正在尝试创建一个基本系统，只允许特定用户查看和使用修改链接，如“删除”和“编辑”。我似乎在 Facebook 应用程序中找不到任何有关角色管理的信息，而且在我看来，使用我自己的外部 SQL 表或 XML 文件非常愚蠢，考虑到我只是试图将某些用户分类为管理员而没有硬编码他们的 UID 进入系统。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-28T08:01:43.847

我认为公平地说，这需要更多关于如何将该人归类为管理员的信息？

他们需要被提名吗？由其他管理员添加？什么？

如果它是自动确定的，那么您已经有了答案，如果您希望某些人成为管理员，但不想硬编码，请创建一个允许您选择一个人的界面，并将他们添加到显示“此人是管理员”的数据库列表 - 我不相信 facebook 有自己的内部系统来说“此人是管理员”...

另一个想法是在 Facebook 上创建一个群组，并且只允许群组中的人成为该群组的成员，然后您可以使用 FQL 或 API 的 Group.getMembers 检查他们是否是该群组的成员组，如果是，让他们成为应用程序中的管理员。

# asp.net - ConfigurationManager ConnectionStrings 的价值在哪里？

> ID：242468
> 
> 赞同：2
> 
> 时间：2008-10-28T07:24:34.420
> 
> 标签：asp.net, configuration, connection-string, configurationmanager

在我的 ASP.NET 应用程序中，我有一个 web.config 文件。在 web.config 文件中，我有一个连接字符串...

```
<connectionStrings>
    <add name="HRDb" connectionString="xxxxx" providerName="System.Data.SqlClient" />
</connectionStrings> 
```

然而，当我使用 检索这个值时`ConfigurationManager.ConnectionStringsp["HRDb"]`，我得到的是旧的连接字符串，而不是新的。

`ConfigurationManager`读取连接字符串值来自哪里（除了 web.config） ？

我正在从 VS.NET 运行应用程序（未部署到 IIS）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T07:45:47.967

我弄清楚出了什么问题。

所以回答我自己的问题...... ConfigurationManager 只从 web.config 中读取。

我的问题是项目配置为在运行项目时使用 IIS Web 服务器，而不是使用 Visual Studio 开发服务器。所以我实际上正在运行我的应用程序的旧版本。愚蠢的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T07:38:32.770

尽管不太可能，您也有可能在当前文件夹上方的文件夹甚至 machine.config 中的“父”web.config 中定义了连接字符串。尝试在`<clear />`元素之前添加一个`<add>`元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T07:33:12.547

“旧”值存储在哪里？它在不同的配置文件中吗？配置管理器应该只从配置文件中提取，但一个应用程序可以有多个文件。您的构建过程的一部分是否复制到旧文件中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-18T21:12:00.683

我遇到了类似的问题，解决方案是我持有错误的 web.config，这是在添加文件时由 Visual Studio 生成的。

# c# - 打开相对于服务器文件夹的文件

> ID：242478
> 
> 赞同：0
> 
> 时间：2008-10-28T07:31:42.800
> 
> 标签：c#, asp.net-mvc, web-applications

当我尝试打开一个文件时，它会尝试使用“C:\Program Files\Common Files\Microsoft Shared\DevServer\9.0”作为基本目录。

如何获取 Web 应用程序的工作目录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T07:41:16.947

```
string path = Server.MapPath("~"); 
```

# python - 出错时自动启动 python 调试器

> ID：242485
> 
> 赞同：259
> 
> 时间：2008-10-28T07:37:15.893
> 
> 标签：python, debugging

这是我一直想知道的一个问题，但我从未找到合适的解决方案。如果我运行一个脚本并且遇到了一个 IndexError，python 会打印错误的行、位置和快速描述并退出。遇到错误时是否可以自动启动pdb？我不反对在文件顶部添加额外的 import 语句，也不反对添加几行额外的代码。

* * *

## 回答 #1

> 赞同：568
> 
> 时间：2010-03-13T15:20:52.367

```
python -m pdb -c continue myscript.py 
```

如果您不提供`-c continue`标志，那么您需要在执行开始时输入“c”（表示继续）。然后它将运行到错误点并让您在那里控制。如[eqzx 所述](https://stackoverflow.com/questions/242485/starting-python-debugger-automatically-on-error#comment73725114_2438834)，此标志是 python 3.2 中的新增功能，因此早期 Python 版本需要输入“c”（请参阅[​​ https://docs.python.org/3/library/pdb.html](https://docs.python.org/3/library/pdb.html)）。

* * *

## 回答 #2

> 赞同：149
> 
> 时间：2008-10-28T07:56:24.077

您可以使用[traceback.print_exc](http://docs.python.org/library/traceback.html#traceback.print_exc)打印异常回溯。然后使用[sys.exc_info](http://docs.python.org/library/sys#sys.exc_info)提取回溯，最后使用该回溯调用[pdb.post_mortem](http://docs.python.org/library/pdb#pdb.post_mortem)

```
import pdb, traceback, sys

def bombs():
    a = []
    print a[0]

if __name__ == '__main__':
    try:
        bombs()
    except:
        extype, value, tb = sys.exc_info()
        traceback.print_exc()
        pdb.post_mortem(tb) 
```

如果你想用[code.interact](http://docs.python.org/library/code#code.interact)启动一个交互式命令行，使用异常产生的帧的本地变量，你可以这样做

```
import traceback, sys, code

def bombs():
    a = []
    print a[0]

if __name__ == '__main__':
    try:
        bombs()
    except:
        type, value, tb = sys.exc_info()
        traceback.print_exc()
        last_frame = lambda tb=tb: last_frame(tb.tb_next) if tb.tb_next else tb
        frame = last_frame().tb_frame
        ns = dict(frame.f_globals)
        ns.update(frame.f_locals)
        code.interact(local=ns) 
```

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2008-10-28T08:14:56.660

使用以下模块：

```
import sys

def info(type, value, tb):
    if hasattr(sys, 'ps1') or not sys.stderr.isatty():
    # we are in interactive mode or we don't have a tty-like
    # device, so we call the default hook
        sys.__excepthook__(type, value, tb)
    else:
        import traceback, pdb
        # we are NOT in interactive mode, print the exception...
        traceback.print_exception(type, value, tb)
        print
        # ...then start the debugger in post-mortem mode.
        # pdb.pm() # deprecated
        pdb.post_mortem(tb) # more "modern"

sys.excepthook = info 
```

命名它`debug`（或任何你喜欢的名字）并将它放在你的 python 路径中的某个位置。

现在，在脚本的开头，只需添加一个`import debug`.

* * *

## 回答 #4

> 赞同：58
> 
> 时间：2012-10-21T23:49:51.960

**Ipython**有一个用于切换此行为的命令：**%pdb**。它完全符合您的描述，甚至可能更多（通过语法突出显示和代码完成为您提供更多信息回溯）。绝对值得一试！

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2008-10-28T07:51:45.067

这不是调试器，但可能同样有用（？）

我知道我听到 Guido 在某处的演讲中提到了这一点。

我刚刚检查了 python -?，如果你使用 -i 命令，你可以在脚本停止的地方进行交互。

所以给定这个脚本：

```
testlist = [1,2,3,4,5, 0]

prev_i = None
for i in testlist:
    if not prev_i:
        prev_i = i
    else:
        result = prev_i/i 
```

你可以得到这个输出！

```
PS D:\> python -i debugtest.py
Traceback (most recent call last):
  File "debugtest.py", line 10, in <module>
    result = prev_i/i
ZeroDivisionError: integer division or modulo by zero
>>>
>>>
>>> prev_i
1
>>> i
0
>>> 
```

老实说，我没有使用过这个，但我应该使用它，似乎非常有用。

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2016-01-27T13:49:16.320

IPython 在命令行上使这变得简单：

```
python myscript.py arg1 arg2 
```

可以改写为

```
ipython --pdb myscript.py -- arg1 arg2 
```

或者，类似地，如果调用模块：

```
python -m mymodule arg1 arg2 
```

可以改写为

```
ipython --pdb -m mymodule -- arg1 arg2 
```

请注意`--`阻止 IPython 将脚本的参数作为自己的参数读取。

这还具有调用增强型 IPython 调试器 (ipdb) 而不是 pdb 的优点。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2018-06-26T20:26:30.210

如果您正在使用`ipython`, 启动类型后`%pdb`

```
In [1]: %pdb
Automatic pdb calling has been turned ON 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-01-14T23:45:10.447

如果您使用的是 IPython 环境，则可以只使用 %debug ，shell 会将您带回带有 ipdb 环境的违规行进行检查等。上面指出的另一个选项是使用 iPython 魔术 %pdb ，它有效地做到了相同。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-01-12T00:54:16.310

要让它运行而不必在开始时键入 c 使用：

```
python -m pdb -c c <script name> 
```

Pdb 有自己的命令行参数：-cc 将在执行开始时执行 c(ontinue) 命令，并且程序将不间断地运行，直到出现错误。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-06-22T20:32:15.473

python2.7中的python -m pdb script.py按继续启动，它将运行到错误并在那里中断以进行调试。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-02-02T10:57:45.203

您可以将此行放入您的代码中：

```
import pdb ; pdb.set_trace() 
```

更多信息：[在任意行启动 python 调试器](http://www.technomancy.org/python/debugger-start-line/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-02-18T18:11:21.907

如果您正在运行一个模块：

```
python -m mymodule 
```

现在你想`pdb`在发生异常时输入，执行以下操作：

```
PYTHONPATH="." python -m pdb -c c mymodule/__main__.py 
```

（或*扩展*你的`PYTHONPATH`）。`PYTHONPATH`需要 以便在路径中找到模块，因为您现在正在运行该模块`pdb`。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-01-10T12:51:17.613

[`ipdb`](https://pypi.org/project/ipdb/)有一个很好的上下文管理器来实现这种行为，这使得意图在语义上更清晰：

```
from ipdb import launch_ipdb_on_exception

with launch_ipdb_on_exception():
    ... 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-04-16T15:23:22.010

在层次结构中最顶层的异常类的构造函数中放置一个断点，大多数时候您会看到引发错误的位置。

放置断点意味着您想要的任何含义：您可以使用 IDE，或`pdb.set_trace`，或其他任何东西

# ms-access - 访问：如何生成记录集的报告？

> ID：242504
> 
> 赞同：2
> 
> 时间：2008-10-28T07:49:35.417
> 
> 标签：ms-access, report, recordset

如何使用来自记录集（而不是查询或表）的数据在访问中生成报告。我有记录集的更新，也必须在报告中显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T14:30:41.347

在[Access Web](http://www.mvps.org/access/reports/rpt0014.htm)中，您可以使用记录集的“名称”属性。您生成的代码将如下所示：

*在报告中*

```
Private Sub Report_Open(Cancel As Integer)
    Me.RecordSource = gMyRecordSet.Name
End Sub 
```

*在调用对象（模块、表单等）中*

```
Public gMyRecordSet As Recordset
'...
Public Sub callMyReport()
    '...
    Set gMyRecordSet = CurrentDb.OpenRecordset("Select * " & _
                                               "from foo " & _
                                               "where bar='yaddah'")
    DoCmd.OpenReport "myReport", acViewPreview  
    '...
    gMyRecordSet.Close  
    Set gMyRecordSet = Nothing
    '...
End Sub 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-10-28T09:02:27.577

请更详细地解释。例如，您是否希望展示该领域曾经是什么以及现在是什么？如果是这样，您将需要审计跟踪。这是来自 Microsoft 的示例：http: [//support.microsoft.com/kb/q197592/](http://support.microsoft.com/kb/q197592/)

你说的报告是什么意思？如果您的意思是打印的纸质文档，Access 有一个很好的报告生成器。如果您的意思是要查看数据，可以使用表单。如果您不熟悉构建报告和表单，可以使用向导。

研究每个 Access 版本附带的 Northwind 示例数据库总是明智的。

# c# - 带有 C# 属性的非常奇怪的错误

> ID：242517
> 
> 赞同：0
> 
> 时间：2008-10-28T07:59:00.933
> 
> 标签：c#, .net, properties

在将新信息与旧信息进行比较后，我有一个将信息输入对象的应用程序。它就像

```
set
{
    oldval=_value;
    _value=value;
    if (some comparison logic)
        raiseEvent();
} 
```

这一切都发生在后台线程上，处于无限循环中，间歇性休眠 100 毫秒。真正奇怪的部分是它第一次工作，比较逻辑变为真，并且引发了事件。之后，信息不断流动，不断进入对象，我知道这一点是因为我设置 MessageBoxes 一直显示新旧值，但它好像以某种方式绕过了 set 子句！我在子句的开头设置了一个消息框，它只是没有弹出！这真的很奇怪，因为我确信该值会不断更新。

有什么想法吗？

* * *

是的，我知道，但不幸的是，我无法展示更多内容......让我再次尝试解释整体结构：我有一个单独的后台线程运行一个无限循环。这个循环不断地从 Data 对象中提取数据，该对象由另一组线程更新。当然，所有这些都与 Monitor.Enter 和 Exit 同步。然后将从 Data 对象中提取的数据输入到 Comparer 对象中。

```
while(true)
{
    Thread.Sleep(100);
    Monitor.Enter(Data);
    Comparer.Value = Data.Value;
    Monitor.Exit(Data);
} 
```

Comparer.Value 是我在第一篇文章中提到的属性。这真的很奇怪，因为我在循环结束时设置了一个 MessageBox：

```
MessageBox.Show(Comparer.Value + " - " + Data.Value); 
```

并且值确实更新了，它似乎以某种方式绕过了 set 子句，这是不可能的......这真的很奇怪。

Rob，循环不做任何检查，它只是将信息流模拟到 Comparer.Value 中；它的 set 子句包含比较逻辑。

bh213，我很漂亮，但我不知道，因为比较在任何有意义的检查完成之前就停止了。

* * *

好吧，我已经解决了问题，显然我的问题是错误的，问题出在另一个地方。感谢所有帮助，问题可能已关闭。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T08:04:59.567

没有一些有意义的代码，我们只能猜测。特别是，如果在 Set 的开头添加 MessageBox 没有出现，那么问题很可能出在调用代码上（不是这个）。

不过，有些想法 - 特别是因为您有多个线程：

*   某处有线程竞赛吗？一些代码应该同步吗？
*   工人是否获得了非易失性值的陈旧副本？
*   **线程亲和性**：是否涉及工作人员和 UI 的事情？
*   你确定你有正确的实例（即触发事件的对象是否可能不是你正在监听的对象）？

这些都不是。如果没有一些示例代码，我们真的无能为力。

我用粗体标记了**线程亲和性**，因为如果您的工作人员正在（通过事件）UI 正在侦听的更改，这很可能是一个问题；UI 事件处理程序*必须*切换到 UI 线程来更新 UI：

```
void SomeHandler(object sender, EventArgs args)
{
    this.Invoke((MethodInvoker)delegate {
       this.Text = "Something happened";
    });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T08:15:48.403

以前的答案完全正确，因为您需要提供更多信息。

但我能问一下你*为什么*这样做吗？当然，您的业务模型只会在设置值时引发一个事件，为什么会有一个后台线程运行来间歇性地检查？

也许我只是遗漏了一些东西，但似乎这里可能存在导致*真正*问题的设计缺陷。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T08:42:31.720

垃圾邮件 System.Diagnostic.Debug.WriteLine 而不是消息框。这些不会（或至少它们只在最低限度内）改变指令流并且没有线程问题（除了可能的错误输出）。

此外，从描述中，似乎带有一些精心放置的断点的简单调试会话可能会有所帮助。

第三，什么是“（一些比较逻辑）”？

如果它是一个简单的 (oldval != _value) 将其重写为

```
set
{
 if (_value != value)
 {
  _value=value;
  RaiseSomeEvent();
 }
} 
```

它更干净，如果没有引发事件（除了没有订阅的处理程序......），你就没有机会改变 _value 。

否则，“（一些比较逻辑）”表达式可能是错误的位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T08:00:58.683

你真的需要提供更多信息。我们在这里得到的只是一些伪代码。尝试提出一个[简短但完整的程序](http://pobox.com/~skeet/csharp/complete.html)来演示该问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T08:19:13.717

由于事件是在后台线程上引发的，因此您的所有事件处理程序都在该（后台）线程上运行。您的代码是否正确处理此问题？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T08:30:34.427

正如其他人所说，您确实需要创建一个小的工作示例来显示问题。

在创建此示例应用程序时，您甚至可能会自己注意到问题的根源。

# visual-studio - 您对 Visual Studio 2010 CTP 的体验？

> ID：242529
> 
> 赞同：5
> 
> 时间：2008-10-28T08:14:07.817
> 
> 标签：visual-studio, visual-studio-2010

我今天刚看到[Visual Studio CTP](http://www.microsoft.com/downloads/details.aspx?FamilyId=922B4655-93D0-4476-BDA4-94CF5F8D4814&displaylang=en)的公告，目前正在等待所有这些文件下载...

您是否已经尝试过 CTP，或者可能是以前的版本？你觉得呢？你有没有什么想法？还有一个问题[，您最希望在 Visual Studio 2010 中看到哪些功能](https://stackoverflow.com/questions/206943/what-features-would-you-most-like-to-see-in-visual-studio-2010)，现在在这里，您怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T11:33:16.907

下载、运行、查看演练，这是我目前看到的一些内容。

*   XAML 中的可自定义起始页（不知道我是否会打扰）
*   可缩放的代码编辑器（我敢打赌这是 MS 传道者提出的功能要求）
*   在编辑器中突出显示当前行（是的！SlickEdit 插件严重减慢了我的机器速度。但是，我还没有设法让它在 CTP 中工作）
*   用于连接到编辑器并添加您自己的格式、突出显示、智能感知、智能标签等的东西。（不要认为我很快就会需要它）
*   调用层次结构 - 谁调用你的方法和你的方法调用谁的树视图
*   静态类型 'dynamic' - 严格来说这是 C#4.0，而不是 VS2010（观看 Anders 的[PDC Future of C#](http://channel9.msdn.com/pdc2008/TL16/)谈话，了解一些令人惊叹的因素）
*   从使用中生成：这太酷了，您编写测试，然后使用 VS 重构为您的代码创建所有样板类/属性/方法定义。（您可以从匿名类生成整个类！）
*   快速搜索 - （相当于 Code Rush Ctrl Shift Q）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T09:00:01.483

[我昨天](http://ayende.com/Blog/archive/2008/10/27/visual-studio-2010.aspx)还没有但[ayende](http://ayende.com/)发布了这个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T09:21:21.430

I've downloaded it, but didn't have enough space to unpack it :-)

But I've heard rumors [that VS2010 gets a WCF interface](http://www.heise-online.co.uk/news/PDC-Visual-Studio-2010-gets-a-new-WPF-interface--/111833). That would be awesome, but it would also antiquate the 7 GIGs I just downloaded a couple of days ago :-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T02:58:08.213

我已经玩了一段时间了；一些想法：

*   （ide）新的 WPF 界面，虽然闪亮，但在我的虚拟机上使用远程桌面玩得很开心......我希望在 RTM 之前优化（或选项等）
*   （语言/框架）喜欢新的`dynamic`支持；遗憾的是它不完整（它不提供运营商支持，而 .NET 4.0 旨在提供）
*   （框架）有趣的[新`Expression`支持](http://marcgravell.blogspot.com/search/label/expression)- 可惜语言没有直接提供它，但对`Expression`粉丝来说非常强大

我没有时间玩 COM 的东西（no-PIA/no-ref），但看起来很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T02:49:53.177

IMO VS2010 中最令人惊奇的东西是[历史调试器](http://channel9.msdn.com/posts/VisualStudio/Historical-Debugger-and-Test-Impact-Analysis-in-Visual-Studio-Team-System-2010/)。自 MSVS2003 以来，我一直梦想着这样的工具。集成代码分析也是一个非常好的功能。

# c# - 常量的 C# 命名约定？

> ID：242534
> 
> 赞同：490
> 
> 时间：2008-10-28T08:16:45.360
> 
> 标签：c#, naming-conventions, constants

```
private const int THE_ANSWER = 42; 
```

或者

```
private const int theAnswer = 42; 
```

我个人认为对于现代 IDE，我们应该使用 camelCase，因为 ALL_CAPS 看起来很奇怪。你怎么看？

* * *

## 回答 #1

> 赞同：584
> 
> 时间：2008-10-28T08:25:35.687

推荐的命名和大小写约定是使用[**P** ascal **C** asing](https://en.wikipedia.org/wiki/Camel_case)作为常量（Microsoft 有一个名为[StyleCop](https://github.com/StyleCop)的工具，它记录了所有首选约定，并且可以检查您的源代码是否合规 - 尽管对于许多人的口味来说它有点*过于*固执） . 例如

```
private const int TheAnswer = 42; 
```

Pascal 大小写约定也记录在 Microsoft 的[框架设计指南](https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/capitalization-conventions)中。

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2014-05-21T15:34:27.137

在视觉上，大写是要走的路。那样就很有辨识度了。为了唯一性，不留任何猜测的机会，我投票支持 UPPER_CASE！

```
const int THE_ANSWER = 42; 
```

**注意**：当常量要在页面顶部的同一文件中使用并用于智能感知时，大写将很有用；但是，如果要将它们移动到一个独立的类，使用大写不会有太大的区别，例如：

```
public static class Constant
{
    public static readonly int Cons1 = 1;
    public static readonly int coNs2 = 2;
    public static readonly int cOns3 = 3;
    public static readonly int CONS4 = 4;
}

// Call constants from anywhere
// Since the class has a unique and recognizable name, Upper Case might lose its charm
private void DoSomething(){
var getCons1 = Constant.Cons1;
var getCons2 = Constant.coNs2;
var getCons3 = Constant.cOns3;
var getCons4 = Constant.CONS4;
 } 
```

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2008-10-28T08:23:12.820

其实是

```
private const int TheAnswer = 42; 
```

至少如果您查看 .NET 库，IMO 是确定命名约定的最佳方式 - 因此您的代码不会显得格格不入。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2008-10-28T08:21:42.277

我仍然使用大写的 const 值，但这不是出于任何特定原因，而是出于习惯。

当然，它很容易立即看出某事是 const。我的问题是：我们真的需要这些信息吗？它是否以任何方式帮助我们避免错误？如果我为 const 赋值，编译器会告诉我我做了一些愚蠢的事情。

我的结论是：选择骆驼壳。也许我也会改变我的风格;-)

**编辑：**

*IMO，闻起来*有匈牙利风味的东西并不是一个真正有效的论点。问题应该始终是：它有帮助还是有害？

在某些情况下，匈牙利人会提供帮助。现在没有那么多了，但它们仍然存在。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-10-28T10:37:47.277

首先，匈牙利表示法是使用前缀来显示参数的数据类型或预期用途的做法。微软的命名约定对匈牙利表示法说不 [http://en.wikipedia.org/wiki/Hungarian_notation](http://en.wikipedia.org/wiki/Hungarian_notation) [http://msdn.microsoft.com/en-us/library/ms229045.aspx](http://msdn.microsoft.com/en-us/library/ms229045.aspx)

不鼓励使用 UPPERCASE，如此处所述：Pascal Case 是可接受的约定和 SCREAMING CAPS。 [http://en.wikibooks.org/wiki/C_Sharp_Programming/Naming](http://en.wikibooks.org/wiki/C_Sharp_Programming/Naming)

微软在此还声明，如果与现有方案匹配，则可以使用 UPPERCASE。 [http://msdn.microsoft.com/en-us/library/x2dbyw72.aspx](http://msdn.microsoft.com/en-us/library/x2dbyw72.aspx)

这几乎概括了它。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2014-01-02T19:42:58.587

Microsoft在其文章[Constants (C# Programming Guide)](http://msdn.microsoft.com/en-us/library/ms173119.aspx)中给出了以下示例：

```
class Calendar3
{
    const int months = 12;
    const int weeks = 52;
    const int days = 365;

    const double daysPerWeek = (double) days / (double) weeks;
    const double daysPerMonth = (double) days / (double) months;
} 
```

因此，对于常量，微软*似乎*建议使用[`camelCasing`](http://msdn.microsoft.com/en-us/library/ms229043.aspx). 但请注意，这些常量是**在本地**定义的。

可以说，外部可见常量的命名更有趣。实际上，Microsoft 将其在 .NET 类库中的**公共常量记录为****fields**。这里有些例子：

*   [Int32.MaxValue](http://msdn.microsoft.com/en-us/library/system.int32.maxvalue%28v=vs.110%29.aspx)
*   [String.Empty](http://msdn.microsoft.com/en-us/library/system.string.empty%28v=vs.110%29.aspx) *（实际上，* `static readonly`*）*
*   [数学.PI](http://msdn.microsoft.com/en-us/library/system.math.pi%28v=vs.110%29.aspx)
*   [数学.E](http://msdn.microsoft.com/en-us/library/system.math.e%28v=vs.110%29.aspx)

前两个是 的例子[`PascalCasing`](http://msdn.microsoft.com/en-us/library/ms229043.aspx)。第三个似乎遵循 Microsoft 的两个字母首字母缩写词的[大写约定](http://msdn.microsoft.com/en-us/library/ms229043.aspx)（尽管[pi](http://en.wikipedia.org/wiki/Pi)不是首字母缩写词）。第四个似乎表明，双字母缩写词的规则扩展到单字母缩写词或标识符，例如`E`（代表数学常数[*e*](https://en.wikipedia.org/wiki/E_(mathematical_constant))）。

此外，在其大写约定文档中，Microsoft 非常直接地声明字段标识符应通过以下方式命名，并为[MessageQueue.InfiniteTimeout](http://msdn.microsoft.com/en-us/library/system.messaging.messagequeue.infinitetimeout%28v=vs.110%29.aspx)和[UInt32.Min](http://msdn.microsoft.com/en-us/library/system.int32.minvalue%28v=vs.110%29.aspx)`PascalCasing`提供以下示例：

```
public class MessageQueue
{
    public static readonly TimeSpan InfiniteTimeout;
}

public struct UInt32
{
    public const Min = 0;
} 
```

**结论：`PascalCasing`用于公共常量**（记录为`const`或`static readonly`字段）。

最后，据我所知，Microsoft 不提倡**私有**标识符的特定命名或大写约定，如问题中提供的示例所示。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-10-28T08:19:47.693

把匈牙利语留给匈牙利人。

在这个例子中，我什至会省略最终的文章，然后继续

```
private const int Answer = 42; 
```

是那个答案还是那个答案？

*按照帕斯卡的规定进行了严格正确的编辑，但我认为这个问题是在寻找更多关于[生命、宇宙和一切](http://en.wikipedia.org/wiki/Life,_the_Universe_and_Everything)的答案。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-10-28T08:21:11.763

ALL_CAPS 取自我相信的 C 和 C++ 工作方式。本文[在这里](http://blogs.msdn.com/sourceanalysis/archive/2008/05/25/a-difference-of-style.aspx)解释了风格差异是如何产生的。

在诸如 Visual Studio 之类的新 IDE 中，很容易识别类型、范围以及它们是否是常量，所以这不是绝对必要的。

[FxCop](http://en.wikipedia.org/wiki/FxCop)和 Microsoft [StyleCop](http://en.wikipedia.org/wiki/StyleCop)软件将帮助您提供指导并检查您的代码，以便每个人都以相同的方式工作。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2008-10-28T08:27:45.870

我实际上倾向于在这里更喜欢 PascalCase - 但出于习惯，我对 UPPER_CASE 感到内疚......

# shell - Unix shell script 找出脚本文件所在的目录？

> ID：242538
> 
> 赞同：627
> 
> 时间：2008-10-28T08:19:24.870
> 
> 标签：shell, unix

基本上我需要使用与 shell 脚本文件位置相关的路径运行脚本，如何将当前目录更改为与脚本文件所在的目录相同的目录？

* * *

## 回答 #1

> 赞同：687
> 
> 时间：2008-10-28T08:26:03.767

在 Bash 中，你应该得到你需要的东西：

```
#!/usr/bin/env bash

BASEDIR=$(dirname "$0")
echo "$BASEDIR" 
```

* * *

## 回答 #2

> 赞同：463
> 
> 时间：2009-10-28T16:28:27.023

原始帖子包含解决方案（忽略响应，它们没有添加任何有用的东西）。有趣的工作是由上面提到的`readlink`带有 option的 unix 命令完成的`-f`。当脚本被绝对路径和相对路径调用时工作。

对于 bash、sh、ksh：

```
#!/bin/bash 
# Absolute path to this script, e.g. /home/user/bin/foo.sh
SCRIPT=$(readlink -f "$0")
# Absolute path this script is in, thus /home/user/bin
SCRIPTPATH=$(dirname "$SCRIPT")
echo $SCRIPTPATH 
```

对于 tcsh，csh：

```
#!/bin/tcsh
# Absolute path to this script, e.g. /home/user/bin/foo.csh
set SCRIPT=`readlink -f "$0"`
# Absolute path this script is in, thus /home/user/bin
set SCRIPTPATH=`dirname "$SCRIPT"`
echo $SCRIPTPATH 
```

另请参阅：[https ://stackoverflow.com/a/246128/59087](https://stackoverflow.com/a/246128/59087)

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2013-04-05T02:35:57.347

先前对答案的评论说，但在所有其他答案中很容易错过。

使用 bash 时：

```
echo this file: "$BASH_SOURCE"
echo this dir: "$(dirname "$BASH_SOURCE")" 
```

[Bash 参考手册，5.2 Bash 变量](http://www.gnu.org/software/bash/manual/html_node/Bash-Variables.html)

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2008-10-28T08:29:17.817

假设您正在使用 bash

```
#!/bin/bash

current_dir=$(pwd)
script_dir=$(dirname "$0")

echo $current_dir
echo $script_dir 
```

这个脚本应该打印你所在的目录，然后是脚本所在的目录。例如，当`/`使用 in 中的脚本调用它时`/home/mez/`，它会输出

```
/
/home/mez 
```

请记住，从命令的输出中分配变量时，将命令包装在`$(`and `)`- 中，否则您将无法获得所需的输出。

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2017-06-20T05:59:47.357

这个问题的最佳答案在这里得到了回答：
[Getting the source directory of a Bash script from inside](https://stackoverflow.com/a/246128/1781470)

它是：

```
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )" 
```

无论从哪里调用脚本，它都会为您提供脚本的完整目录名称。

要了解它是如何工作的，您可以执行以下脚本：

```
#!/bin/bash

SOURCE="${BASH_SOURCE[0]}"
while [ -h "$SOURCE" ]; do # resolve $SOURCE until the file is no longer a symlink
  TARGET="$(readlink "$SOURCE")"
  if [[ $TARGET == /* ]]; then
    echo "SOURCE '$SOURCE' is an absolute symlink to '$TARGET'"
    SOURCE="$TARGET"
  else
    DIR="$( dirname "$SOURCE" )"
    echo "SOURCE '$SOURCE' is a relative symlink to '$TARGET' (relative to '$DIR')"
    SOURCE="$DIR/$TARGET" # if $SOURCE was a relative symlink, we need to resolve it relative to the path where the symlink file was located
  fi
done
echo "SOURCE is '$SOURCE'"
RDIR="$( dirname "$SOURCE" )"
DIR="$( cd -P "$( dirname "$SOURCE" )" && pwd )"
if [ "$DIR" != "$RDIR" ]; then
  echo "DIR '$RDIR' resolves to '$DIR'"
fi
echo "DIR is '$DIR'" 
```

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2010-03-18T20:09:00.470

如果你正在使用 bash....

```
#!/bin/bash

pushd $(dirname "${0}") > /dev/null
basedir=$(pwd -L)
# Use "pwd -P" for the path without links. man bash for more info.
popd > /dev/null

echo "${basedir}" 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2011-06-06T16:26:21.943

正如 theMarko 所建议的：

```
BASEDIR=$(dirname $0)
echo $BASEDIR 
```

除非您从脚本所在的同一目录执行脚本，否则此方法有效，在这种情况下，您将获得 '.' 的值。

要解决该问题，请使用：

```
current_dir=$(pwd)
script_dir=$(dirname $0)

if [ $script_dir = '.' ]
then
script_dir="$current_dir"
fi 
```

您现在可以在整个脚本中使用变量 current_dir 来引用脚本目录。但是，这可能仍然存在符号链接问题。

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2019-04-02T10:23:10.790

如果您想获取实际的脚本目录（无论您是使用符号链接还是直接调用脚本），请尝试：

```
BASEDIR=$(dirname $(realpath "$0"))
echo "$BASEDIR" 
```

这适用于 linux 和 macOS。我看不到这里有人提到`realpath`. 不确定这种方法是否有任何缺点。

在 macOS 上，您需要安装`coreutils`才能使用`realpath`. 例如：`brew install coreutils`。

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2011-01-14T16:50:23.590

```
cd $(dirname $(readlink -f $0)) 
```

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2018-09-12T11:14:54.750

```
BASE_DIR="$(cd "$(dirname "$0")"; pwd)";
echo "BASE_DIR => $BASE_DIR" 
```

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2017-05-11T14:58:04.000

让我们把它变成一个 POSIX oneliner：

```
a="/$0"; a=${a%/*}; a=${a#/}; a=${a:-.}; BASEDIR=$(cd "$a"; pwd) 
```

在许多与 Bourne 兼容的 shell 上进行了测试，包括 BSD 的。

据我所知，我是作者，我把它放到了公共领域。有关更多信息，请参阅： [https ://www.jasan.tk/posts/2017-05-11-posix_shell_dirname_replacement/](https://www.jasan.tk/posts/2017-05-11-posix_shell_dirname_replacement/)

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2018-04-22T09:53:43.073

**介绍**

这个答案***纠正***了这个线程的非常破碎但令人震惊的最高投票答案（由 TheMarko 撰写）：

```
#!/usr/bin/env bash

BASEDIR=$(dirname "$0")
echo "$BASEDIR" 
```

**为什么在它自己上使用 dirname "$0" 不起作用？**

***dirname $0***仅在用户以非常特定的方式启动脚本时才有效。我能够找到几种这种答案失败并导致脚本崩溃的情况。

首先，让我们了解这个答案是如何工作的。他通过做得到脚本目录

```
dirname "$0" 
```

**$0**表示调用脚本的命令的第一部分（它基本上是不带参数的输入命令：

```
/some/path/./script argument1 argument2 
```

$0="/some/path/./script"

dirname 基本上在字符串中找到最后一个 / 并在那里截断它。所以如果你这样做：

```
 dirname /usr/bin/sha256sum 
```

你会得到：/usr/bin

此示例运行良好，因为 /usr/bin/sha256sum 是格式正确的路径，但是

```
 dirname "/some/path/./script" 
```

效果不好，会给你：

```
 BASENAME="/some/path/." #which would crash your script if you try to use it as a path 
```

假设您与脚本在同一个目录中，然后使用此命令启动它

```
./script 
```

在这种情况下 $0 将是 ./script 并且 dirname $0 将给出：

```
. #or BASEDIR=".", again this will crash your script 
```

使用：

```
sh script 
```

不输入完整路径也会给出一个 BASEDIR="."

使用相对目录：

```
 ../some/path/./script 
```

给出一个目录名 $0：

```
 ../some/path/. 
```

如果您在 /some 目录中并以这种方式调用脚本（请注意开头没有 /，再次是相对路径）：

```
 path/./script.sh 
```

您将获得 dirname $0 的值：

```
 path/. 
```

和 ./path/./script （相对路径的另一种形式）给出：

```
 ./path/. 
```

***basedir $0***起作用的唯一两种情况是用户使用 sh 或 touch 启动脚本，因为两者都会导致 $0：

```
 $0=/some/path/script 
```

这将为您提供可以与 dirname 一起使用的路径。

**解决方案**

您将考虑并检测上述每一种情况，并在出现时对其进行修复：

```
#!/bin/bash
#this script will only work in bash, make sure it's installed on your system.

#set to false to not see all the echos
debug=true

if [ "$debug" = true ]; then echo "\$0=$0";fi

#The line below detect script's parent directory. $0 is the part of the launch command that doesn't contain the arguments
BASEDIR=$(dirname "$0") #3 situations will cause dirname $0 to fail: #situation1: user launches script while in script dir ( $0=./script)
                                                                     #situation2: different dir but ./ is used to launch script (ex. $0=/path_to/./script)
                                                                     #situation3: different dir but relative path used to launch script
if [ "$debug" = true ]; then echo 'BASEDIR=$(dirname "$0") gives: '"$BASEDIR";fi                                 

if [ "$BASEDIR" = "." ]; then BASEDIR="$(pwd)";fi # fix for situation1

_B2=${BASEDIR:$((${#BASEDIR}-2))}; B_=${BASEDIR::1}; B_2=${BASEDIR::2}; B_3=${BASEDIR::3} # <- bash only
if [ "$_B2" = "/." ]; then BASEDIR=${BASEDIR::$((${#BASEDIR}-1))};fi #fix for situation2 # <- bash only
if [ "$B_" != "/" ]; then  #fix for situation3 #<- bash only
        if [ "$B_2" = "./" ]; then
                #covers ./relative_path/(./)script
                if [ "$(pwd)" != "/" ]; then BASEDIR="$(pwd)/${BASEDIR:2}"; else BASEDIR="/${BASEDIR:2}";fi
        else
                #covers relative_path/(./)script and ../relative_path/(./)script, using ../relative_path fails if current path is a symbolic link
                if [ "$(pwd)" != "/" ]; then BASEDIR="$(pwd)/$BASEDIR"; else BASEDIR="/$BASEDIR";fi
        fi
fi

if [ "$debug" = true ]; then echo "fixed BASEDIR=$BASEDIR";fi 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2018-06-09T08:41:37.273

这个单行代码告诉你 shell 脚本在哪里，*不管你是运行它还是采购它*。此外，如果是这种情况，它还会解析所涉及的任何符号链接：

```
dir=$(dirname $(test -L "$BASH_SOURCE" && readlink -f "$BASH_SOURCE" || echo "$BASH_SOURCE")) 
```

顺便说一句，我想你正在使用*/bin/bash*。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-07-29T18:58:12.917

如此多的答案，都是合理的，每个都有优点和缺点以及略有不同的目标（可能应该为每个人说明）。`readlink`这是另一个解决方案，它满足了在所有系统上、在所有 bash 上都清晰和工作的主要目标（不对 bash 版本或选项进行假设`pwd`），并且可以合理地执行您期望发生的事情（例如，解析符号链接是有趣的问题，但通常不是您真正想要的），处理路径中的空格等边缘情况，忽略任何错误并在有任何问题时使用合理的默认值。

每个组件都存储在一个单独的变量中，您可以单独使用：

```
# script path, filename, directory
PROG_PATH=${BASH_SOURCE[0]}      # this script's name
PROG_NAME=${PROG_PATH##*/}       # basename of script (strip path)
PROG_DIR="$(cd "$(dirname "${PROG_PATH:-$PWD}")" 2>/dev/null 1>&2 && pwd)" 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-12-19T18:30:58.063

灵感来自[**blueyed 的回答**](https://stackoverflow.com/a/4693587)

```
read < <(readlink -f $0 | xargs dirname)
cd $REPLY 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-04-06T04:40:38.480

使用 tcsh，您可以使用`:h`变量修饰符来检索路径。

一个警告是，如果脚本执行为`tcsh myscript.csh`，那么您将只能获得脚本名称。一种解决方法是验证路径，如下所示。

```
#!/bin/tcsh

set SCRIPT_PATH = $0:h
if ( $SCRIPT_PATH == $0 ) then
        set SCRIPT_PATH = "."
endif

$SCRIPT_PATH/compile.csh > $SCRIPT_PATH/results.txt 
```

有关变量修饰符的更多信息，请访问[https://learnxinyminutes.com/docs/tcsh/](https://learnxinyminutes.com/docs/tcsh/)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-11-30T18:42:49.983

基础版：

```
dir=$(dirname $0) 
```

如果可以通过 调用脚本`$PATH`，则：

```
dir=$(dirname $(which $0)) 
```

如果脚本可以这样调用：`bash script.sh`，那么：

```
dir=$(dirname $(which $0 2>/dev/null || realpath ./$0)) 
```

如果你感到极度不安全，那么：

```
dir="$(dirname -- "$(which -- "$0" 2>/dev/null || realpath -- "./$0")")" 
```

* * *

## 回答 #18

> 赞同：-4
> 
> 时间：2009-01-14T19:32:14.807

这应该够了吧：

```
echo `pwd`/`dirname $0` 
```

它可能看起来很难看，具体取决于它的调用方式和 cwd，但应该可以让你到达你需要去的地方（或者如果你关心它的外观，你可以调整字符串）。

# active-directory - 我可以使用来自单个主机的两个 Kerberos Keytabs 吗？

> ID：242546
> 
> 赞同：0
> 
> 时间：2008-10-28T08:23:57.890
> 
> 标签：active-directory, ldap, kerberos

我的应用程序允许定义多个 LDAP 服务器来使用。可能想要定义对多个 LDAP 服务器的 Kerberos 访问。可以做到吗？单个主机可以在 Active Directory 服务器之间使用 Kerberos 作为连接方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-17T23:07:51.437

是的。您只需要自己管理您的密钥表。

基本上只需从 MIT Kerberos kinit 获取代码，看看它是如何创建凭证缓存并设法加载其密钥的。只需在每次连接之前初始化适当的票证，它应该可以工作。

# web-applications - “beta”对于不断发展的 Web 应用程序意味着什么？

> ID：242547
> 
> 赞同：4
> 
> 时间：2008-10-28T08:24:12.757
> 
> 标签：web-applications, terminology

我曾经将“测试版”理解为“功能完整”。Web 应用程序很少是功能完整的，而是随着时间的推移缓慢发展。那么“beta”对它们有什么特定含义还是只是一个噱头？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-28T08:35:10.330

这是一个先发制人的免责声明。“来吧，使用它，但如果有什么东西坍缩成一个黑洞，我们就放轻松。”

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-28T08:31:34.643

在 web 2.0 中，它似乎毫无意义。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-28T08:28:03.573

当你是谷歌时，它的意思是“为公众做好准备，但一直在修修补补”

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-28T08:37:56.083

我们有一些开发人员，但没有支持人员。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-28T08:27:18.943

我通常认为它的意思是“越野车”

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-28T08:27:00.550

如果我想说某事关于特定里程碑或任何其他类型的预先宣布的功能集是“功能完整的”，我会使用该术语。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-28T09:11:46.390

这有点像Windows。“作为一项特别优惠，我们将让您为我们完成所有测试”

更严肃一点：当网站是“新的”并且核心功能正在运行时，我倾向于使用它。很多时候，附加功能需要在实现中进行重大更改。一旦基本实现稳定，即。附加功能不需要对现有功能进行重大更改，我会删除它。

这些天来，营销和法律部门似乎不愿意取消 beta 状态。碰巧的是，我的“商业”网站项目都没有摆脱 beta 状态。即使我会剥离它。正如其他人已经回答的那样，有点使测试状态变得毫无意义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-28T10:33:48.237

发布网站的 BETA 版本，允许了解用户是否喜欢您正在使用界面制作的混乱，或者只是看到它失败了。

其他示例：对于社区或类似站点，它允许建立第一人口本身，即使不是完全功能。

# iphone - 在视图之间传递值

> ID：242565
> 
> 赞同：0
> 
> 时间：2008-10-28T08:34:48.740
> 
> 标签：iphone, cocoa-touch

我让 MainViewController 调用 WebViewController（来自 UICatalog 示例应用程序）像 WebViewController targetViewController ... targetViewController.setValue(value) 之类的东西，它说：“**错误：在不是结构或联合的东西中请求成员'setValue'** ”...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T09:24:58.733

如果您有一个名为“value”的属性，并使用@sythesize 为您创建一个方法，在这种情况下您可以使用该“.”来调用。符号：

```
targetViewController.value = whatever; 
```

或者，您可以直接调用 setter，无论您或 @synthesize 是否编写该方法：

```
[targetViewController setValue:whatever]; 
```

属性语法（class.property = 不管）实际上只是调用“setValue:”方法的快捷方式，而作为回报，属性的@property 和@synthesize 机制只是为您编写了一些有用的代码。

编辑：我之前说过，如果你只是写了一个“setValue：”方法，你可以使用“class.value = newValue”表示法来调用它，但这是不正确的——你必须定义一个@property才能使用“。” 符号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T10:42:09.310

我相信

```
targetViewController.value = whatever; 
```

仅当您已经声明了 @property 时才有效；如果没有，您将需要使用完整的方法调用语法：

```
[targetViewController setValue: whatever]; 
```

否则，Kendall 关于使用 setter 和 @synthesize 是正确的。

您的语法也是使用过程 C 编写的

```
targetViewController.setValue(value); 
```

这*绝对*行不通。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T13:47:11.557

您还需要确保 #import 您的 targetViewController.h 文件。

# c# - 是否可以在运行时为 .NET 应用程序切换应用程序配置文件？

> ID：242568
> 
> 赞同：9
> 
> 时间：2008-10-28T08:37:06.817
> 
> 标签：c#, .net, configuration

默认情况下，.NET 应用程序的配置文件以“exe 文件名”.config 命名。我想知道是否可以动态指定一个应用程序的配置。

例如，构建的应用程序是“foo.exe”。在运行时，配置文件是“foo.exe.config”。是否可以让它接受命令行参数以使用其他配置文件。因此，应用程序可以使用其他配置，如下所示。

> foo.exe /config:bar.config

bar.config 用作配置文件，而不是 foo.exe.config。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-20T15:42:29.340

如果您只需要替换 AppSettings 部分，上述所有方法都可以正常工作。

如果您必须使用不同的配置文件（所有部分）运行，您可能需要考虑使用主机启动应用程序，该主机为您的主应用程序创建应用程序域并根据您传入的参数设置不同的配置文件。

这是对我有用的代码：

```
 AppDomainSetup setup = new AppDomainSetup();
        setup.ApplicationBase = "file://" + System.Environment.CurrentDirectory;
        setup.DisallowBindingRedirects = true;
        setup.DisallowCodeDownload = true;

        if (args.Length != 0 && args[0].Equals("-test"))
        {
            setup.ConfigurationFile = "PATH_TO_YOUR_TEST_CONFIG_FILE";
        }
        else {
            setup.ConfigurationFile = "PATH_TO_YOUR_LIVE_CONFIG_FILE";
        }

        AppDomain domain = AppDomain.CreateDomain("FRIENDLY_NAME", null, setup);
        domain.ExecuteAssembly("YourMainApp.exe"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T09:04:38.570

来自 MSDN 的代码

```
static void DisplayMappedExeConfigurationFileSections()
{
    // Get the application configuration file path.
    string exeFilePath = System.IO.Path.Combine(
        Environment.CurrentDirectory, "ConfigurationManager.exe.config");
    // HERE !!!     
    // Map to the application configuration file.
    ExeConfigurationFileMap configFile = new ExeConfigurationFileMap();
    configFile.ExeConfigFilename = exeFilePath;

    Configuration config =
        ConfigurationManager.OpenMappedExeConfiguration(configFile,
        ConfigurationUserLevel.None);

    // Display the configuration file sections.
    ConfigurationSectionCollection sections = config.Sections;

    Console.WriteLine();
    Console.WriteLine("Sections in machine.config:");

    // Loop to get the sections machine.config.
    foreach (ConfigurationSection section in sections)
    {
        string name = section.SectionInformation.Name;
        Console.WriteLine("Name: {0}", name);
    }

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-28T09:05:23.373

从[如何使用 Configuration.GetSection() 和 ConfigurationManager.OpenMappedExeConfiguration() 中获得](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/ec237df4-f05e-4711-a230-fb089c395c73/)

```
ExeConfigurationFileMap fileMap = new ExeConfigurationFileMap();
fileMap.ExeConfigFilename = @"C:\Inetpub\Test\Config\Dev.config";
Configuration config = ConfigurationManager.OpenMappedExeConfiguration(fileMap, ConfigurationUserLevel.None);
AppSettingsSection section = (AppSettingsSection)config.GetSection("appSettings");
string ConfigVersion = section.Settings["ConfigVersion"].Value; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T08:52:19.050

是的，您将需要使用 ExeConfigurationFileMap

# c - 从 XP 中的隐藏或剪切窗口复制内容？

> ID：242570
> 
> 赞同：10
> 
> 时间：2008-10-28T08:39:44.503
> 
> 标签：c, windows, user-interface

我需要将隐藏的窗口（BitBlt）的内容复制到另一个窗口。问题是，一旦我隐藏了源窗口，我得到的设备上下文就不再绘制了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-28T10:41:42.993

您需要的是自 Windows XP 以来在 Win32 API 中可用的[PrintWindow](http://msdn.microsoft.com/en-us/library/ms535695.aspx)函数。如果您需要它与旧版本的 Windows 一起使用，您可以尝试[WM_PRINT](http://msdn.microsoft.com/en-us/library/ms534856(VS.85).aspx)，尽管我一直无法使其工作。

[这里](http://msdn.microsoft.com/en-us/library/ms997649.aspx)有一篇不错的文章展示了如何使用 PrintWindow，下面是该文章的相关代码片段：

```
// Takes a snapshot of the window hwnd, stored in the memory device context hdcMem
HDC hdc = GetWindowDC(hwnd);
if (hdc)
{
    HDC hdcMem = CreateCompatibleDC(hdc);
    if (hdcMem)
    {
        RECT rc;
        GetWindowRect(hwnd, &rc);

        HBITMAP hbitmap = CreateCompatibleBitmap(hdc, RECTWIDTH(rc), RECTHEIGHT(rc));
        if (hbitmap)
        {
            SelectObject(hdcMem, hbitmap);

            PrintWindow(hwnd, hdcMem, 0);

            DeleteObject(hbitmap);
        }
        DeleteObject(hdcMem);
    }
    ReleaseDC(hwnd, hdc);
} 
```

我应该有一些使用 wxPython 来实现相同目的的 Python 代码。如果需要，请给我留言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T09:04:14.140

在关闭/隐藏窗口之前将源位图复制到内存位图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T10:33:44.367

`WM_PRINT`您可以尝试向窗口发送消息。对于许多窗口（包括所有标准窗口和常用控件），这将导致它绘制到提供的 DC 中。

此外，如果您将 HDC 作为 WM_PAINT 消息的 wparam 传递，许多窗口（例如公共控件）将绘制到该 DC 而不是屏幕上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T08:47:42.863

也许您可以使用 InvalidateRect 在窗口上触发重绘操作？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T10:38:13.547

不幸的是，我认为你会遇到真正的问题来让它可靠地工作。您没有确切说明您在做什么，但我假设，给定窗口句柄，您通过调用 GetWindowDC() 获取与窗口关联的设备上下文，然后使用生成的设备上下文。

当窗口可见时，这在 XP 上可以正常工作。但是，在 Vista 上，如果启用了桌面合成，那么它甚至无法正常工作：您将从 GetWindowDC() 返回 0。从根本上说，抓取窗口设备上下文不会可靠地工作。

如果您尝试从中复制的窗口是您自己的应用程序的一部分，我建议修改您的代码以支持 WM___PRINT 消息：这类似于 WM_PAINT，但允许您提供一个设备上下文来绘制。

如果窗口不是来自您的应用程序，那么您基本上就不走运了：如果窗口是隐藏的，那么如果它是可见的，它将显示的图像在任何地方都不存在。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T11:38:42.503

PrintWindow 函数似乎不适用于隐藏窗口，仅适用于可见窗口。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-18T14:50:44.000

对于隐藏在另一个窗口后面的窗口，您可以将其设置为透明（使用高 alpha 使其看起来不透明）。然后应该可以使用 BitBlt 捕获整个窗口。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-28T23:03:00.143

从不同的角度处理事情，你确定这真的是你想做的吗？例如，您不想使用 CreateCompatibleDC 和 CreateCompatibleBitmap 来创建不可见的绘图表面，在其上绘图然后使用 BitBlt？

有关您所从事工作的背景的更多信息可能使某人能够提出解决方案或一些横向思考...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-04T14:44:00.837

我刚刚在 Windows 7 中对此进行了测试，从 XP 开始应该可以正常工作。

在捕获它之前，它会将窗口带到前台而不给它焦点。这不是完美的，但如果你不能让 PrintWindow() 工作，这是你要做的最好的事情。

这是一个静态方法，所以你可以像这样简单地调用它：

```
Orwellophile.TakeScreenShotOfWindow("window.jpg", Form.Handle); 
```

没有混乱，没有大惊小怪。它来自一个更大的班级，所以希望没有遗漏任何东西。原件是：

[http://sfinktah.trac.cvsdude.com/vhddirector/browser/main/VHD%20Director/UnhandledExceptionManager.cs](http://sfinktah.trac.cvsdude.com/vhddirector/browser/main/VHD%20Director/UnhandledExceptionManager.cs) 和[http://sfinktah.trac.cvsdude.com/vhddirector/browser/main/CSharp.cc/Win32Messaging。 cs](http://sfinktah.trac.cvsdude.com/vhddirector/browser/main/CSharp.cc/Win32Messaging.cs)虽然它们没有我在下面粘贴的示例那么整洁。

```
using System;
using System.Drawing;
using System.Threading;
using System.Runtime.InteropServices;
using System.Windows.Forms;

public class Orwellophile {
    public static void TakeScreenshotOfWindow(String strFilename, IntPtr hTargetWindow)
    {
        Rectangle objRectangle;
        RECT r;
        IntPtr hForegroundWindow = GetForegroundWindow();

        GetWindowRect(hTargetWindow, out r);
        objRectangle = r.ToRectangle();

        if (hTargetWindow != hForegroundWindow)
        {
            ShowWindow(hTargetWindow, SW_SHOWNOACTIVATE);
            SetWindowPos(hTargetWindow.ToInt32(), HWND_TOPMOST, r.X, r.Y, r.Width, r.Height, SWP_NOACTIVATE);
            Thread.Sleep(500);
        }

        TakeScreenshotPrivate(strFilename, objRectangle);
    }

    private static void TakeScreenshotPrivate(string strFilename, Rectangle objRectangle)
    {
        Bitmap objBitmap = new Bitmap(objRectangle.Width, objRectangle.Height);
        Graphics objGraphics = default(Graphics);
        IntPtr hdcDest = default(IntPtr);
        int hdcSrc = 0;

        objGraphics = Graphics.FromImage(objBitmap);

        hdcSrc = GetDC(0);                  // Get a device context to the windows desktop and our destination  bitmaps
        hdcDest = objGraphics.GetHdc();     // Copy what is on the desktop to the bitmap
        BitBlt(hdcDest.ToInt32(), 0, 0, objRectangle.Width, objRectangle.Height, hdcSrc, objRectangle.X, objRectangle.Y, SRCCOPY);
        objGraphics.ReleaseHdc(hdcDest);    // Release DC
        ReleaseDC(0, hdcSrc);

        objBitmap.Save(strFilename);
    }

    [DllImport("gdi32.dll", SetLastError = true)]
    static extern IntPtr CreateCompatibleDC(IntPtr hdc);
    [DllImport("user32.dll")]
    static extern IntPtr GetWindowDC(IntPtr hWnd);
    [DllImport("gdi32.dll")]
    static extern IntPtr CreateCompatibleBitmap(IntPtr hdc, int nWidth, int nHeight);
    [DllImport("gdi32.dll", ExactSpelling = true, PreserveSig = true, SetLastError = true)]
    static extern IntPtr SelectObject(IntPtr hdc, IntPtr hgdiobj);
    [DllImport("User32.dll", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    static extern bool PrintWindow(IntPtr hwnd, IntPtr hDC, uint nFlags); // To capture only the client area of window, use PW_CLIENTONLY = 0x1 as nFlags
    [DllImport("gdi32.dll")]
    static extern bool DeleteObject(IntPtr hObject);
    [DllImport("user32.dll")]
    static extern bool ReleaseDC(IntPtr hWnd, IntPtr hDC);

    [DllImport("user32.dll", EntryPoint = "SetWindowPos")]
    static extern bool SetWindowPos(
         int hWnd,           // window handle
         int hWndInsertAfter,    // placement-order handle
         int X,          // horizontal position
         int Y,          // vertical position
         int cx,         // width
         int cy,         // height
         uint uFlags);       // window positioning flags
    [DllImport("user32.dll")]
    static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool GetWindowRect(IntPtr hwnd, out RECT lpRect);
    [DllImport("user32.dll", CharSet = CharSet.Auto, ExactSpelling = true)]
    static public extern IntPtr GetForegroundWindow();
    private const int SW_SHOWNOACTIVATE = 4;
    private const int HWND_TOPMOST = -1;
    private const uint SWP_NOACTIVATE = 0x0010;
    private const int SRCCOPY = 0xcc0020;
} 
```

请注意，您可以实现自己的轻量级 RECT 类/结构，但这是我使用的。由于它的大小，我已单独附加它

```
[StructLayout(LayoutKind.Sequential)]
public struct RECT
{
    private int _Left;
    private int _Top;
    private int _Right;
    private int _Bottom;

    public RECT(System.Drawing.Rectangle Rectangle)
        : this(Rectangle.Left, Rectangle.Top, Rectangle.Right, Rectangle.Bottom)
    {
    }
    public RECT(int Left, int Top, int Right, int Bottom)
    {
        _Left = Left;
        _Top = Top;
        _Right = Right;
        _Bottom = Bottom;
    }

    public int X
    {
        get { return _Left; }
        set { _Left = value; }
    }
    public int Y
    {
        get { return _Top; }
        set { _Top = value; }
    }
    public int Left
    {
        get { return _Left; }
        set { _Left = value; }
    }
    public int Top
    {
        get { return _Top; }
        set { _Top = value; }
    }
    public int Right
    {
        get { return _Right; }
        set { _Right = value; }
    }
    public int Bottom
    {
        get { return _Bottom; }
        set { _Bottom = value; }
    }
    public int Height
    {
        get { return _Bottom - _Top; }
        set { _Bottom = value - _Top; }
    }
    public int Width
    {
        get { return _Right - _Left; }
        set { _Right = value + _Left; }
    }
    public Point Location
    {
        get { return new Point(Left, Top); }
        set
        {
            _Left = value.X;
            _Top = value.Y;
        }
    }
    public Size Size
    {
        get { return new Size(Width, Height); }
        set
        {
            _Right = value.Height + _Left;
            _Bottom = value.Height + _Top;
        }
    }

    public Rectangle ToRectangle()
    {
        return new Rectangle(this.Left, this.Top, this.Width, this.Height);
    }
    static public Rectangle ToRectangle(RECT Rectangle)
    {
        return Rectangle.ToRectangle();
    }
    static public RECT FromRectangle(Rectangle Rectangle)
    {
        return new RECT(Rectangle.Left, Rectangle.Top, Rectangle.Right, Rectangle.Bottom);
    }

    static public implicit operator Rectangle(RECT Rectangle)
    {
        return Rectangle.ToRectangle();
    }
    static public implicit operator RECT(Rectangle Rectangle)
    {
        return new RECT(Rectangle);
    }
    static public bool operator ==(RECT Rectangle1, RECT Rectangle2)
    {
        return Rectangle1.Equals(Rectangle2);
    }
    static public bool operator !=(RECT Rectangle1, RECT Rectangle2)
    {
        return !Rectangle1.Equals(Rectangle2);
    }

    public override string ToString()
    {
        return "{Left: " + _Left + "; " + "Top: " + _Top + "; Right: " + _Right + "; Bottom: " + _Bottom + "}";
    }

    public bool Equals(RECT Rectangle)
    {
        return Rectangle.Left == _Left && Rectangle.Top == _Top && Rectangle.Right == _Right && Rectangle.Bottom == _Bottom;
    }
    public override bool Equals(object Object)
    {
        if (Object is RECT)
        {
            return Equals((RECT)Object);
        }
        else if (Object is Rectangle)
        {
            return Equals(new RECT((Rectangle)Object));
        }

        return false;
    }

    public override int GetHashCode()
    {
        return Left.GetHashCode() ^ Right.GetHashCode() ^ Top.GetHashCode() ^ Bottom.GetHashCode();
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-09-20T22:59:51.310

[http://msdn.microsoft.com/en-us/library/dd144909.aspx（getPixel](http://msdn.microsoft.com/en-us/library/dd144909.aspx)）可能会有所帮助...

# c# - .NET 互操作：使用当前目录中的程序集

> ID：242572
> 
> 赞同：4
> 
> 时间：2008-10-28T08:41:09.943
> 
> 标签：c#, .net, vb6, interop, com-interop

我正在尝试通过互操作使用 VB6 中的 .NET 程序集，而不将其放置在 GAC 中，并且不使用 regasm.exe 的 /codebase 参数。

据我了解，当我在 .NET 类库上运行 regasm.exe 时，它​​会为类库中的每个类创建一个注册表项，告诉 COM 客户端他们应该加载 mscoree.dll，它充当包装 .NET 对象的代理COM 使用。Mscoree.dll 使用类的注册表中的 InprocServer32/Assembly 键来确定哪个类库包含该类的实现。

如果我将 /codebase 与 regasm.exe 一起使用或将我的类库放在 GAC 中，一切正常；但据我从分散的文档中可以看出，如果 /codebase 尚未使用，mscoree.dll 应该在当前目录和路径中查找程序集（因此注册表中没有 CodeBase 条目类）并且在 GAC 中找不到它。

C# 代码尽可能简单：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.InteropServices;

namespace myinterop
{
    [Guid("B1D6B9FE-A4C7-11DD-B06B-E93056D89593")]
    [ClassInterface(ClassInterfaceType.AutoDual)]
    [ComVisible(true)]
    public class MyServer
    {
        public int Add(int a, int b)
        {
            return a + b;
        }
    }
} 
```

并且这个问题通过我放在与编译的 DLL 相同的目录中的 VBScript 一行来重现：

```
object = CreateObject("myinterop.MyServer") 
```

我在这里想念什么？mscoree.dll 在某处查找程序集的方式是否有明确的描述？

顺便说一句，我使用的是 .NET 2.0，是的，我知道我应该将我的程序集放在 GAC 中，我只是想知道为什么这不像宣传的那样工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T08:58:46.337

来自[MSDN](http://msdn.microsoft.com/en-us/library/tzat5yw6(VS.80).aspx)：

> **/Codebase**：在注册表中创建一个 Codebase 条目。Codebase 条目指定未安装在全局程序集缓存中的程序集的文件路径。如果您随后将注册的程序集安装到全局程序集缓存中，则不应指定此选项。使用 /codebase 选项指定的 assemblyFile 参数必须是强名称程序集。

看来它确实像宣传的那样工作。如果您不将程序集放在 GAC 中，则需要使用 /codebase 以便可以访问文件路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T09:16:08.750

为了实现您想要的，我认为您需要为您的 .NET 程序集和 VB6_App.EXE（引用 .NET 程序集）创建 .manifest 文件。检查谷歌的免注册 COM。

# c# - c# - 在字符串中使用二进制数据时数据是否“丢失”？

> ID：242577
> 
> 赞同：1
> 
> 时间：2008-10-28T08:43:53.463
> 
> 标签：c#, string

我尝试使用返回字符串的`StreamReader`类方法读取 JPG 文件。`ReadToEnd()`

但是由于某种原因，当我将此字符串写入文件时，它不会打开。

将数据读入字符串时会丢失一些东西吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-28T08:49:55.573

字符串用于*文本*数据。它们不适用于二进制数据——如果你以这种方式使用它们，你*会*丢失数据（如果幸运的话，你可以使用一些不会丢失数据的编码，但是有一些微妙的问题仍然使它成为一个非常糟糕的主意.)

如果您实际上是在处理一个文件，那么读取整个文件的最简单方法是调用[File.ReadAllBytes](http://msdn.microsoft.com/en-us/library/system.io.file.readallbytes.aspx)。如果您必须处理任意流，请查看[“从流中创建字节数组”](https://stackoverflow.com/questions/221925/creating-a-byte-array-from-a-stream)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-28T08:48:21.350

String 是为保存 unicode 字符而设计的；不是二进制的。对于二进制，使用 a`byte[]`或`Stream`。或`Image`用于更专业的图像处理的等。

尽管有这个名字，但`StreamReader`实际上是一个专门的`TextReader`- 即它是`TextReader`从 a 读取的 a `Stream`。图片不是文字，所以这不是正确的选择。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-28T09:48:14.130

正如所有真正的程序员所知道的，唯一有用的数据结构是数组。字符串、列表、结构、集合——这些都是数组的特殊情况，可以很容易地以这种方式处理，而不会因各种复杂情况而弄乱你的编程语言。花哨的数据类型最糟糕的是你必须声明它们，而众所周知，真正的编程语言具有基于（六个字符）变量名的第一个字母的隐式类型。

此外，坚定的Real Programmer 可以用任何语言编写Fortran 程序。

* * *

显然，修改此内容的人要么没有幽默感，要么不了解民间传说。以上内容摘自泰克公司的 Ed Post 于 1983 年致 Datamation 编辑的一封非常著名的信。这封信的标题是*[Real Programmers Don't Use Pascal](http://www.pbm.com/~lindahl/real.programmers.html)*。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-28T23:02:44.900

永远记住，*文本数据* **是** *二进制数据*，但*二进制数据* **不是** *文本数据*。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T08:49:32.533

不幸的是，System.IO 命名空间中的类名存在严重问题。StreamReader 旨在从文本文件读取\写入。您应该按照@goodwill 的建议将 FileStream 用于二进制文件

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T08:45:26.567

你不能这样做......改用 FileStream 。

您不能使用字符串来读取二进制文件，据我所知，有些字符不会出现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-28T08:50:48.757

字符串用于表示文本。他们擅长表示文本。非常好，事实上，因为它们支持 Unicode 并保护您免受各种典型的字符串处理错误。

它们不擅长表示二进制数据，因为这不是它们的设计目的。正如您所提到的，字节数组对此要好得多。

这不是一个比另一个更好的问题，它只是适合目的和理解何时选择一个或另一个。文本 = 字符串，二进制 = 字节数组或流。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-28T23:07:43.317

我注意到没有人回答实际问题。

## 将数据读入字符串时会丢失一些东西吗？

JPEG 文件包含图片而不是文字。该图片具有作为字节序列的二进制表示。其中一些字节的值 0x00 也表示为 NUL。在字符串中，包含此值的字节被解释为标记字符串的结尾。超过字符串末尾的数据被视为未使用的缓冲区并被忽略。

当您将字符串写入文件时，不包括第一个 NUL 之后的任何内容。因此，该文件不是一个完整的二进制图像，并被试图将其解释为 JPEG 的软件的验证逻辑拒绝。

因此，当您加载包含非文本数据的字符串时，数据通常*会丢失。*这里的问题是您有效地进行了无效的类型转换，但编译器和运行时都没有阻止您，结果是数据损坏。

## 它到底有什么用？

几件事。正如其他人所说，字符串旨在包含文本。在 .NET 中，字符串支持普通旧 ASCII 以外的编码。还广泛支持文本操作。在帮助中查找*格式说明符*以获取字符串操作的壮观示例。

## 为什么 C# 字符串使用 NUL 作为字符串结尾？

这是一个遗产。NUL 对其他任何事情都没有多大好处，这样做可以简化将字符串编组进出托管代码的过程。BSTR 出于同样的原因做同样的事情。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-08T00:41:20.073

字符串默认使用 Unicode 编码，unicode 使用 NUL 字符作为控制字符，双 NUL 用于终止，单 NUL 用于表示它之前的 ASCII 字符。

由于这个原因，二进制数据无法加载到字符串中。

# java - “rundll32 url.dll,FileProtocolHandler”的 URL 长度限制？

> ID：242579
> 
> 赞同：4
> 
> 时间：2008-10-28T08:46:45.347
> 
> 标签：java, windows, url

我有一个带有大量参数的长 URL，我想在 Windows 系统上使用 Java 在默认浏览器中打开这些参数

```
Runtime.getRuntime().exec("rundll32 url.dll,FileProtocolHandler "+url) 
```

[对于像“ http://www.google.com](http://www.google.com) ”这样的短网址，这很好用。但是对于长 URL（比如 2000 个字符），这根本就没有任何作用：没有例外或类似的东西，它只是被忽略了。

a) Runtime.exec 命令或 b) rundll32 url.dll 命令是否有字符限制？如果是这样，限制是多少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T09:41:11.320

您将遇到[这个（存档的）](https://web.archive.org/web/20190902193246/https://boutell.com/newfaq/misc/urllength.html)操作系统/浏览器特定的最大 URL 长度问题：

对于“rundll32 url.dll”（即 Microsoft IE），您将被限制为 2,083 个字符（包括 http://）。

从我坐的位置来看，您有两种选择：

1.  构建（或使用）一个 TinyURL 风格的服务，将你的长 URL 变成短的、重定向的。然而，即使在这里，您也会遇到相同的 URL 长度问题，只是在浏览器本身而不是您的 Runtime() 语句中。例如，浏览器窗口将打开，转到将执行重定向到长 URL 的短 URL 并失败。

2.  使用 POST 请求并将您的部分或全部 URL 参数隐藏在其中。您可以在 HTTP POST 请求的正文中提供很长的参数，而不是使用 GET 调用。这不会像您的示例代码那么简单。事实上，这对于 rundll32 url.dll 组合可能非常棘手（或不可能）（我不熟悉它）......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T12:12:25.070

顺便说一句，我建议使用跨平台`Desktop.open()`或`Desktop.browse()`仅代替 Windows `rundll32`。如果它无法打开写入应用程序，这会给你一个 IOException。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T18:36:25.623

它还取决于 Windows 的版本，因为您可能`MAX_PATH`在命令行上超出了操作系统的长度？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T20:56:11.707

您也可以尝试 Runtime.exec(String []) 版本，使用它可能会更好。只需将所有空格分隔的参数作为单独的字符串传递：

`Runtime.getRuntime().exec(new String [] {"rundll32", "url.dll,FileProtocolHandler", "urlarg1", "urlarg2"});`

# algorithm - 算法：航程规划

> ID：242580
> 
> 赞同：5
> 
> 时间：2008-10-28T08:47:05.470
> 
> 标签：algorithm, math

我需要计划一个航程，将海中的 n 个地点与指定的起点和指定的目的地连接起来，并具有以下约束。
航程必须触及所有地点。
如果有从 A 到 B 的预订，则必须在 B 之前触摸 a
。每个位置花费的时间各不相同（取决于对该位置的预订）
每个位置都有一个工作窗口。如果船只在工作窗口之前到达，则必须等待。
注意：“最小生成树”算法可能不是因为每个端口所需的时间取决于先前的路由（由于工作窗口）
是否有任何算法可用于此？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T08:53:47.923

参见[旅行推销员问题](http://en.wikipedia.org/wiki/Travelling_salesman_problem)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T11:45:59.743

[蚁群优化](http://en.wikipedia.org/wiki/Ant_colony_optimization)似乎是最知名的解决方案。请注意，这是一个[NP 问题](http://en.wikipedia.org/wiki/Nondeterministic_polynomial_time)，实际上甚至是一个 NP 完全问题。这意味着验证解决方案是否正确是“容易的”，但要找到它是“困难的”。找到“最佳”解决方案的唯一方法是尝试所有可能的解决方案，比较结果并选择最好的解决方案。当然，如果您想在合理的时间范围内解决它，这是不可接受的。

ACO 算法将找到一个很好的解决方案，接近最优。我说很接近，因为 AFAIK 不能保证总能找到最好的。可能存在更好的解决方案。但是，通常没有必要真正找到可能的最佳解决方案，“非常好”的解决方案就可以解决问题，而 ACO 正是您正在寻找的。它可以在合理的时间间隔内找到解决方案，并且解决方案肯定是好的。

在您的情况下，您需要对其进行一些修改。通常它只会尝试找到最短路径，只考虑路径。在您的情况下，它必须考虑您的工作窗口、预订和在某个位置花费的时间。但这些只是对“蚂蚁如何旅行”的修改，基本算法保持不变，并且仍然可以正常工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T18:41:57.767

这是一个旅行商问题，通过修改添加了工作窗口约束......这意味着这个问题的解决方案将比标准的旅行商问题更难找到。

我有几种方法可以很好地提供近似解决方案。

1.  [遗传算法](http://en.wikipedia.org/wiki/Genetic_algorithm)
2.  [禁忌搜索](http://en.wikipedia.org/wiki/Tabu_search)
3.  [随机算法](http://en.wikipedia.org/wiki/Randomized_algorithm)（例如，随机游走）

我不知道是否适用于您的问题，我说它不适用，但[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)有时可以用于处理棘手的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T21:06:41.717

关于这个问题有很多工作。它有不同的名字

1.  具有时间窗和优先约束的旅行推销员（车辆路线）问题。
2.  提货和发货问题。

有很多关于这个问题的研究，其中很多都在运筹学[期刊](http://pubsonline.informs.org/)上。这个问题通常是 NP-Hard，因此您描述的问题的一般精确解决方案是不切实际的，但您的特定问题可能有好的、精确或近似的解决方案。最好的算法将是您数据的函数。

*   你的数据集有多大。如果“n”相对较小（30-100），则可能有可能通过[数学编程获得精确的解决方案。](http://www.coin-or.org/projects/SYMPHONY.xml)
*   时间窗口和优先约束有多紧。如果在任何时间窗口中可能访问的位置数量很少，那么动态规划之类的解决方案是可能的。
*   如果您找不到特殊情况，那么您可能希望将启发式构造算法与本地搜索后处理器结合起来。一个简单的替代方法是所谓的[GRASP](http://www.me.utexas.edu/~bard/Bard_Papers/GRASP%20VRP%20(ORSA%20JOC).pdf)启发式，您可以在其中
*   采用现有的构造启发式方法，
*   随机化是为了让多次运行会给你多种解决方案，
*   多次运行随机版本
*   采取结果的最佳解决方案。

# exception - 异常处理架构

> ID：242587
> 
> 赞同：14
> 
> 时间：2008-10-28T08:50:24.293
> 
> 标签：exception, architecture

有人有异常处理的最佳实践吗？

在网上搜索时，我发现了很多代码级别的最佳实践（不要捕获一般异常，不要重新抛出新异常等）。我正在寻找的是更高级别的最佳实践，例如：

*   在应用程序中捕获 ui 级别的异常。
*   记录尽可能多的细节，显示友好的错误消息
*   在更多类似 SOA 的应用程序中，区分功能异常（您要求特定客户并希望找到一个，但找不到）和技术异常（数据库离线）
*   不要将异常用于功能异常
*   区分致命和非致命异常
*   区分使重试成为可能或使重试完全无用的异常
*   提醒维护人员的模式

非常感谢任何想法和帮助，谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-28T10:17:58.423

@伊利亚：

这可能是 Joel 写过的最糟糕的文章之一（对于那些没有阅读链接的人，他认为“例外被认为是有害的”，所以不要使用它们）。

Joel 有两个异常问题：

1.  它们在源代码中是不可见的。

    *   但未处理的状态返回也是如此。正确处理的状态返回会使方法的正常流程变得混乱，使它们更难阅读。
2.  它们为函数创建了太多可能的退出点。

    *   那又怎样？处理故障几乎总是需要您提前返回。明确退出点只会使代码混乱。

[Ned Batchelder在这里](http://nedbatchelder.com/text/exceptions-vs-status.html)对 Joel 有一个出色的（而且更长的）回复。[Joel在这里](http://www.joelonsoftware.com/items/2003/10/15.html)有一个简短的回复，Ned[在这里](http://nedbatchelder.com/text/exceptions-in-the-rainforest.html)再次回复。

[Brad Abrams 在这里](http://blogs.msdn.com/brada/archive/2003/09/30/50403.aspx)也有一篇关于异常价值的非常好的文章。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-28T08:55:57.170

.NET 特定但绝对有一些有价值的信息。

[http://www.codeproject.com/KB/architecture/exceptionbestpractices.aspx](http://www.codeproject.com/KB/architecture/exceptionbestpractices.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T08:55:36.763

我也喜欢区分：

*   由于函数调用者导致的异常
*   由于函数内部错误导致的异常。

这对我来说是一种明确的分离方式：

*   动态异常（可以发生，但不需要明确捕获，类似于非法参数）
*   静态异常（必须明确处理，因为应用程序内部存在缺陷）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T09:41:16.873

您可以做的比查看 Microsoft 的[Exception Management Application Block](http://www.microsoft.com/downloads/details.aspx?FamilyID=8CA8EB6E-6F4A-43DF-ADEB-8F22CA173E02&displaylang=en)的代码和文档更糟糕。对于很多场景来说，这可能有点矫枉过正，但它肯定是全面的。

# c# - 如何在 DirectX 中绘制橡皮筋矩形？

> ID：242588
> 
> 赞同：2
> 
> 时间：2008-10-28T08:50:42.343
> 
> 标签：c#, directx

如何在 DirectX 中绘制 2D 橡皮筋矩形？最好使用 C#。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T09:44:30.597

做橡皮筋的经典方法是：

*   绘制常规场景，即“背景”
*   切换到“XOR 模式”，您的笔将对帧缓冲区中已有的像素进行 XOR。这里的模式是 XOR 很重要，因为 XOR 是无损“可恢复的”，这与加法运算不同。
*   在“橡皮筋”时：
    *   在其当前坐标中绘制橡皮筋矩形
    *   在下一帧，再次绘制矩形，仍然使用 XOR，使用它之前的坐标。这将删除矩形，使帧缓冲区完好无损。
    *   更新矩形的坐标

有关如何“使用 DirectX”执行此操作的详细信息有点困难……我相信 DirectDraw，在 DirectX 中进行 2D 的“老派”方式已经过时，所以我猜你一定是在使用 Direct3D。不幸的是，我不确定那里的细节。可能是您没有找到预定义的功能来进行 XOR 绘图，并且需要自己动手。希望有人可以提供更好的细节。抱歉，如果您已经了解橡皮筋理论本身的速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-01T12:42:27.317

您需要两个点变量（每个变量都保存 x 和 y 坐标）。我们称它们为 FirstPoint 和 SecondPoint。

在 mousedown 时，将当前鼠标位置存储到 FirstPoint 和 SecondPoint。只要鼠标按下，只要它移动，就用新的鼠标位置更新 SecondPoint。

然后每一帧如果鼠标按下，根据两个角FirstPoint和SecondPoint绘制一个矩形。你需要一点点数学来检测它们是左上/右下还是右上/左下以及哪个是哪个，但是你只需在它们之间画一个矩形，或者两个三角形。您当然必须在绘图之前切换到正交 (2D) 模式。

我不确定 unwind 的答案，我什至不知道如何进行 XOR 操作，而且它似乎过于复杂，除非您特别希望矩形成为背景的负数（这就是 XOR 操作会做的事情，我相信）。此外，如果您在每一帧都重新绘制场景，则没有理由来回执行一些愚蠢的异或操作来擦除前一个矩形；它已经通过绘制新框架被覆盖了。

我个人更喜欢画一个带有实心轮廓和半透明填充的矩形；为此，将当前颜色设置为 alpha 值可能为 128（或 0.5f）并在两点之间绘制矩形，然后将多边形绘制模式更改为线条并将颜色设置为纯色，然后绘制另一个矩形。

最后，我确定您会想对橡皮筋做出反应；释放鼠标后，根据 FirstPoint 和 SecondPoint 变量执行您需要的任何操作。此外，您的绘制代码应该只在鼠标按下时绘制矩形，因此它将停止绘制。

# asp.net - 在页面渲染时显示 Ajax Loader

> ID：242600
> 
> 赞同：2
> 
> 时间：2008-10-28T08:58:40.190
> 
> 标签：asp.net, vb.net, ajax, page-lifecycle

这可能是一个简单的问题，但是如何在构建页面时最好地使用 ASP.NET 中的 AJAX 加载器来提供加载对话框？

我目前有一个带有关联 UpdateProgressPanel 的 UpdatePanel，其中包含 ProgressTemplate 中的加载消息和 gif。

目前我有一个页面，onLoad() 去获取业务实体，然后显示它们。在执行此操作时，我想显示一个 AJAX 加载程序。

在页面加载中没有任何内容并有一个触发 onLoadComplete 或 unLoad() 的隐藏按钮会更好吗？然后等待按钮单击方法完成显示 UpdateProgressPanel？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-28T18:52:02.690

您可以在 .Net 之外的 HTML 中执行此操作。在您的 ASPX 页面中，您有如下代码：

```
<div id="loading"> 

<!-- 动画 GIF 或其他指示正在发生的事情 -->

</div>

```

在页面的最底部，就在前面，您可以有一个如下所示的代码段：

```
<script language="javascript"> 

  document.getElementById("loading").style.display = "none";

</脚本>

```

图形——只要它位于页面顶部——将首先呈现。然后你所有的 onLoad 东西都会发生，最后内联 JavaScript 会发生在最后，因为它位于页面底部。

很多时候，我会禁用处于未加载状态的按钮并在底部的 JavaScript 中启用它们。这可以防止用户在页面准备好之前获得点击快乐并触发事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T15:42:03.557

我用 Timer 控件做了类似的事情。您的 OnLoad 只是打开计时器，页面完成渲染。然后计时器（具有一些最小的间隔值）会做脏活，正确显示进度面板。请记住关闭计时器作为该过程的最后一步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-23T11:19:46.320

如果你真的想要细粒度的控制，你可以使用基于进度条的 AJAX 预加载器。您可以将其配置为在每次状态更改时完成。即从 0 到 4（5 个就绪状态），每个状态进展 20%。创建一个非常简单。有一个容器`div`可以容纳另一个容器，每个容器`div`的`width`每个状态都以 20% 的步长从 0 到 100% 变化。向内部添加背景颜色`div`（例如：蓝色），使其看起来像在进步。我猜 GMail 的 Pre-loader 使用了类似的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-16T12:35:14.727

帖子很旧，但您可以查看[http://ajax.net-tutorials.com/controls/updateprogress-control/](http://ajax.net-tutorials.com/controls/updateprogress-control/)

# ruby - 如何使用 open-uri 发出 POST 请求？

> ID：242602
> 
> 赞同：30
> 
> 时间：2008-10-28T08:58:48.833
> 
> 标签：ruby, open-uri

是否可以使用 open-uri 从 Ruby 发出 POST 请求？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-28T09:24:34.133

不幸`open-uri`的是只支持`GET`动词。

您可以下拉一个级别并使用`net/http`，或使用`rest-open-uri`，它旨在支持`POST`和其他动词。你可以`gem install rest-open-uri`安装它。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-12-13T20:02:31.803

```
require 'open-uri'
require 'net/http'
params = {'param1' => 'value1', 'param2' => 'value2'}
url = URI.parse('http://thewebsite.com/thepath')
resp, data = Net::HTTP.post_form(url, params)
puts resp.inspect
puts data.inspect 
```

它对我有用:)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-29T12:43:17.833

我也真的推荐[rest-client](https://github.com/rest-client/rest-client)。它是编写 API 客户端的绝佳基础。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-26T23:41:52.553

就这么简单：

```
require 'open-uri'
require 'net/http'

response = Net::HTTP.post_form(URI.parse("https://httpbin.org/post"), { a: 1 })

puts response.code
puts response.message
puts response.body 
```

我建议使用`response.methods - Object.methods`来查看所有可用的方法，例如`message`，`header,`

**奖励**：POST / DELETE 请求：

```
puts Net::HTTP.new("httpbin.org").post("/post", "a=1").body
puts Net::HTTP.new("httpbin.org").delete("/delete").body 
```

# javascript - 禁用浏览器垂直和水平滚动条

> ID：242608
> 
> 赞同：118
> 
> 时间：2008-10-28T09:03:04.270
> 
> 标签：javascript, jquery

是否可以使用 jQuery 或 javascript 禁用浏览器的垂直和水平滚动条？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2008-10-28T09:44:48.130

如果您需要动态隐藏和显示滚动条，您可以使用

```
$("body").css("overflow", "hidden"); 
```

和

```
$("body").css("overflow", "auto"); 
```

在您的代码中的某处。

* * *

## 回答 #2

> 赞同：129
> 
> 时间：2012-05-30T07:18:58.187

```
function reloadScrollBars() {
    document.documentElement.style.overflow = 'auto';  // firefox, chrome
    document.body.scroll = "yes"; // ie only
}

function unloadScrollBars() {
    document.documentElement.style.overflow = 'hidden';  // firefox, chrome
    document.body.scroll = "no"; // ie only
} 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2008-10-28T09:07:32.963

试试 CSS

```
<body style="overflow: hidden"> 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2008-10-28T10:32:42.467

到目前为止，我们已经溢出：隐藏在身体上。但是 IE 并不总是尊重这一点，您还需要在 body 元素上放置 scroll="no" 和/或在 html 元素上放置 overflow:hidden。

当您需要“控制”视口时，您可以更进一步，您可以这样做：-

```
<style>
 body {width:100%; height:100%; overflow:hidden; margin:0; }
 html {width:100%; height:100%; overflow:hidden; }
</style> 
```

在 body 中被授予高度 100% 的元素具有窗口视口的完整高度，并且使用 bottom:nnPX 绝对定位的元素将设置为窗口底部边缘上方的 nn 个像素，依此类推。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-12-14T12:49:57.127

试试 CSS。

如果要删除水平

```
overflow-x: hidden; 
```

如果你想删除 Vertical

```
overflow-y: hidden; 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2013-12-27T12:56:13.137

在现代版本的 IE（IE10 及更高版本）中，可以使用[`-ms-overflow-style`属性](http://msdn.microsoft.com/en-us/library/ie/hh771902(v=vs.85).aspx)隐藏滚动条。

```
html {
     -ms-overflow-style: none;
} 
```

在 Chrome 中，滚动条可以设置样式：

```
::-webkit-scrollbar {
    display: none;
} 
```

如果您想在 Web 应用程序中使用“默认”正文滚动，这非常有用，这比`overflow-y: scroll`.

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2010-08-05T20:20:38.703

如果您还需要对 Internet Explorer 6 的支持，只需溢出**html**

```
$("html").css("overflow", "hidden"); 
```

和

```
$("html").css("overflow", "auto"); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-04-18T11:34:33.557

IE 的滚动条有一些错误。所以如果你想要两者中的任何一个，你必须包括以下内容来隐藏水平滚动条：

`overflow-x: hidden;`
`overflow-y:scroll;`

并隐藏垂直：

`overflow-y: hidden;`
`overflow-x: scroll;`

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-09-25T11:41:51.877

（我还不能发表评论，但想分享一下）：

Lyncee 的代码在桌面浏览器中为我工作。但是，在 iPad（Chrome、iOS 9）上，它使应用程序崩溃。为了解决它，我改变了

```
document.documentElement.style.overflow = ... 
```

至

```
document.body.style.overflow = ... 
```

这解决了我的问题。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-04-26T00:21:58.877

因为 Firefox 有一个方向键快捷键，你可能想`<div>`用 CSS 样式在它周围加上一个：`overflow:hidden;`.

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-05-08T10:33:38.360

使用 JQuery，您可以使用以下代码禁用滚动条：

```
$('body').on({
    'mousewheel': function(e) {
        if (e.target.id == 'el') return;
        e.preventDefault();
        e.stopPropagation();
     }
}); 
```

您也可以使用以下代码再次启用它：

```
 $('body').unbind('mousewheel'); 
```

# windows - 上下文菜单的捕获窗口（Alt-Print 屏幕）

> ID：242609
> 
> 赞同：36
> 
> 时间：2008-10-28T09:03:26.420
> 
> 标签：windows, screenshot, bug-tracking, screen-capture, printscreen

众所周知，有时开发人员必须记录一些东西。或者捕获一些东西来提交错误报告。

我的问题是在 MS Windows 中。

我正在尝试捕获应用程序的多个区域的上下文菜单（右键单击项目后出现的弹出菜单）。按下`Alt`启动`Alt`+`PrintScreen`进程将关闭上下文菜单。

（只有按下`PrintScreen`有帮助，但每次都删除非窗口区域很痛苦）。

奖励：对于捕获菜单，`Alt`也会关闭菜单。但是，如果您首先使用`Alt`键打开菜单，则可以：

1.  按`Alt`+ `F`（用于打开“文件”菜单），不要松开`Alt`
2.  按`PrintScreen`
3.  多田！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-28T11:04:38.237

您无法单独获取菜单，但您可以通过与您在主菜单中发现的类似的技巧来获取它来捕获父窗口 + 上下文菜单：

1.  按住`Shift`
2.  按`F10`
3.  按住`Alt`（你还在按住`Shift`）
4.  按`PrintScreen`
5.  发布`Shift`+`Alt`

至少您不必安装任何软件！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-26T00:10:07.553

使用 Windows 7，我同时使用**`Ctrl`**和**`PrntScr`**。

这捕获了整个屏幕。**`Ctrl`然后我将 ( +`V`** )粘贴到图像编辑器中，并裁剪掉除上下文菜单之外的所有内容。

我确实在我的计算机上禁用了 Windows*高对比度辅助功能模式（***控制面板 -> 轻松访问中心 -> 使计算机更易于查看 -> 取消选中“打开或关闭高对比度...”**）。我不确定这是否有必要。

* * *

**注意：**如果您的键盘没有`PrntScr`作为主键（它可能以蓝色小字体显示），那么显然您必须对此进行调整（例如，您可能需要按`Alt`才能获得该`PrntScr`功能，这意味着总键序列键盘上的`Ctrl`++ `Alt`） 。`PrntScr`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-09-10T13:20:30.273

只需按`Print Screen`。它将捕获整个屏幕。然后将绘画打开到新窗口，然后按`Ctrl`+`V`粘贴然后裁剪。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-08-20T21:54:54.793

对于 Snipping Tool 的用户来说，实际上有一个稍微简单的方法。我从 Microsoft 网站本身提取了这个。它来自这个网站： http: [//windows.microsoft.com/en-us/windows/use-snipping-tool-capture-screen-shots#1TC=windows-7](http://windows.microsoft.com/en-us/windows/use-snipping-tool-capture-screen-shots#1TC=windows-7)

如果要捕获菜单的片段，例如“开始”菜单，请执行以下步骤：

通过单击“开始”按钮的“开始”按钮的图片来打开“截图工具”。在搜索框中，键入截图工具，然后在结果列表中单击截图工具。

打开截图工具后，按`Esc`，然后打开要捕获的菜单。

按`Ctrl`+`PrtScn`

单击新建按钮旁边的箭头，从列​​表中选择自由格式截图、矩形截图、窗口截图或全屏截图，然后选择要捕获的屏幕区域。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-05-03T15:30:51.003

有更简单的方法，简单

1.  使用截图工具，但有延迟选项（比如说 3 秒）
2.  点击“新建”
3.  做任何你想做的事（右键单击下拉菜单等）
4.  保存输出。

:)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-28T09:59:25.590

试试[SnagIT](http://www.techsmith.com/screen-capture.asp)。像黄油中的热刀一样工作！另请参阅：[https ://stackoverflow.com/questions/26183/screenshot-taking-tools](https://stackoverflow.com/questions/26183/screenshot-taking-tools)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-28T09:29:52.263

您可以尝试一下[FastStone Capture](http://www.faststone.org/FSCaptureDetail.htm)，它是此类错误归档/文档制作的最佳工具。

使用此应用程序，只需右键单击鼠标以显示上下文菜单，点击打印屏幕，等等！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-02-17T12:35:15.000

按`Ctrl`+ `Alt`+ `Print Screen`。

`Ctrl`不会做任何事情，但会阻止关闭`Alt`上下文菜单。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-07-18T03:40:21.387

这是我的解决方案（2019/07/18 在 Windows 10 上测试）。

*   对于右键单击上下文菜单：（并非适用于所有情况。）

    1.  鼠标右键单击任何你想要的地方，它会显示一个上下文菜单。
    2.  在上下文菜单上鼠标向左按下（不向上！！）。
    3.  做`ALT`+ `PrintScreen`。
    4.  释放鼠标左键。
*   对于工具栏菜单：

    1.  鼠标向左按下（不向上！！）任何你喜欢的菜单。
    2.  您甚至可以突出显示您喜欢的任何子菜单。
    3.  做`ALT`+ `PrintScreen`。
    4.  释放鼠标左键。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-28T10:41:41.073

您可以使用[Screenshot Captor](http://www.donationcoder.com/Software/Mouser/screenshotcaptor/index.html)（免费）。

您可以执行 Windows 对象捕获以*仅*获取上下文菜单（也可以与菜单捕获一起使用），或者仅使用普通的 printscreen 键来捕获整个屏幕。

-mouser

[免责声明——我是 Screenshot Captor 的作者]

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-28T10:42:08.717

我尝试使用我最喜欢的免费截屏软件：[MWSnap](http://www.mirekw.com/winfreeware/mwsnap.html "MWSnap")。我激活了窗口/菜单捕获功能的快捷键 ( `Ctrl`++ `Shift`) `Z`，当它在后台时，我在此页面上调用了 Firefox 的上下文菜单并使用了快捷键。MWSnap 突出显示菜单，点击后完美捕捉。

可能适用于其他屏幕捕获软件。PrintScreen 已经过时了... :-P

（奖励：没有要打开的画图，以您想要的任何常见格式（PNG、Jpeg）保存，如果需要，自动保存和自动捕获数量等）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-01-18T23:32:38.113

你可以试试[PicPick](http://picpick.wiziple.net/features)

1.  选择截屏-> 捕获windows控件
2.  做任何你想做的事，比如右键单击以显示上下文菜单
3.  现在你可以看到菜单（这是一个windows控件）是活动控件（被红色矩形包围），`PrtSc`按键捕获它。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-04-09T10:26:02.417

作为 Microsoft 回答网站对 Windows 7+ 用户的回答对这篇文章的更新

[如何右键打印屏幕？](http://answers.microsoft.com/en-us/windows/forum/windows_7-files/how-to-print-screen-a-right-click/f86441ef-00fa-4caf-82be-4854727c255f)

如果您使用内置的“截图工具”（在您的开始菜单中找到它），您可以截取一个菜单：

*   打开截图工具后，按 Esc 取消当前截图，然后打开要捕获的菜单。
*   按`Ctrl`+ `PrtScn`。
*   `New`单击按钮旁边的箭头，从列​​表中选择*自由格式截图*、*矩形截图*、*窗口*截图或*全屏截图*，然后选择您要捕获的屏幕区域。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-10-30T20:37:54.730

在 Windows 7 中：

1.  左键单击要捕获的相应右键菜单的文件夹。
2.  按住`Shift`+ `F10`。
3.  点击`PrintScreen`按钮。
4.  如果需要，请使用系统随附的截图工具来裁剪图像。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-02-06T09:01:18.660

我无法得到可接受的工作答案（尽管禁用了高对比度），但这样做：

1.  右键单击上下文菜单（显然），如果要突出显示特定条目，请使用箭头键（这样它就不会被关闭）
2.  按`Ctrl`+`PrintScreen`
3.  您将整个屏幕都放入剪贴板，包括上下文菜单。

（唯一的区别是既不按 F10 也不按 alt）

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-06-10T00:40:17.667

为了响应 OP 的“BONUS”部分，我有时只想从菜单中捕获“下拉菜单”的内容（我可能没有使用确切的命名法）。现在功能区已经取代了许多应用程序中的菜单，要从功能区（例如 Excel、主页、查找和选择）中捕获“下拉菜单” - 请执行以下操作：

*   单击 Excel 功能区：主页、查找和选择（应出现“下拉菜单”）
*   将鼠标移动到要选择/突出显示的项目
*   按住`Ctrl`键
*   按住`Alt`键
*   按键`PrintScreen`_
*   释放所有键
*   将捕获的功能区“下拉”框粘贴到您想要的位置

这也捕获了所选项目的突出显示。

这适用于我在 Win7、Office 2010 上。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-28T11:01:34.857

20/20 还可以捕获上下文菜单 [http://www.sofotex.com/20/20-download_L230.html](http://www.sofotex.com/20/20-download_L230.html)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-02-07T21:23:11.733

至于捕获上下文菜单，例如右键单击菜单或其他按下 Alt 键会导致菜单消失的菜单，至少在 Windows 7 上，请查看：http: [//blogs.technet.com/b/migreene/ archive/2007/05/12/how-to-use-the-snipping-tool-to-capture-context-menus.aspx](http://blogs.technet.com/b/migreene/archive/2007/05/12/how-to-use-the-snipping-tool-to-capture-context-menus.aspx)以及 Uwa 的评论。

基本上，打开截图工具（它应该内置在 Windows 7 中，可以使用“开始”菜单搜索）并单击“取消”按钮，但不要关闭截图工具。然后打开上下文菜单并按（在桌面键盘上）Ctrl+PrintScreen。这将切换回截图工具，您可以在捕获之前选择选项，但保持上下文菜单处于打开状态。

使用截图工具，您可以截取全屏、窗口、矩形或自由格式的截图。如果您只想捕获上下文菜单而不是父窗口，则矩形片段可能最适合您的需求。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-09-27T12:51:38.413

Linux 或 BSD 上的用户可以尝试 scrot：

```
scrot -d 5 'contextmenuincluded.png' -e 'mv $f ~' 
```

这将在五秒钟后截取屏幕截图并将其放在您的主目录中。确保在 5 秒结束之前单击打开的上下文菜单。之后，使用您喜欢的图像编辑器（例如 GIMP）编辑屏幕截图以仅保留上下文菜单。

在 Ubuntu 上，您可以像这样安装 scrot：

```
sudo apt-get install scrot 
```

在 Arch 上是这样的：

```
sudo pacman -S scrot 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-06-23T08:14:51.993

我使用更简单的按键顺序（对于主菜单，而不是上下文菜单）：

1.  长按`Alt`显示菜单
2.  使用鼠标或光标显示菜单，因为我想快照/屏幕截图
3.  按下并按住不动`Shift`
4.  按下并释放`PrintScreen`
5.  现在您可以释放`Shift`和`Alt`键。

对于上下文菜单，我使用以下顺序：

1.  显示上下文菜单
2.  使用鼠标或光标显示菜单，因为我想要快照/屏幕截图
3.  按下并按住不动`Shift`
4.  按下并释放`PrintScreen`
5.  现在您可以释放`Shift`和`Alt`键。

全部在 Windows 10 上测试。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-06-23T11:46:06.993

我尝试了很多（超过 25 个应用程序）声称可以将 ScreenShot 保存到文件中。

他们做到了，但做得不好。

您可以尝试这个简单的逐步测试：

1.  如果其中任何一个都没有活动，请按 Alt+Printscreen 拍摄快照
2.  将剪贴板图像粘贴到绘画应用程序（Paint.Net 可以）上作为图层
3.  在其中一个此类应用程序（屏幕截图）处于活动状态时，按 Alt+Printscreen 拍摄快照，以便将其保存为 PNG 或所需的任何松散格式
4.  现在打开保存的文件并查看像素大小，将其与您在步骤 1 和 2 中获得的大小进行比较，惊讶：它们不匹配！

当窗口边框不是（我将使用 Delphi 常量名称）“bsSizeable”，如果它是“bsDialog”，“bstoolWindow”等时，最糟糕的情况也是，大多数使用 snapshops 的应用程序会丢失左侧和顶部的某些部分窗户的；就像他们在哪里种植一样。

所以，我必须问：

是否有任何应用程序可以捕获 Alt+Printscreen 以自动保存剪贴板？而不是他们自己制作屏幕截图！

换句话说，当我不使用任何工具时，我会在剪贴板上粘贴正确的大小/区域，但是当使用应用程序使屏幕截图更容易时，对于某些类型的窗口，我会在窗口边框周围获得更多像素，或者最糟糕的是，丢失了部分窗户。

所有这些应用程序都有这个问题，并且在它们上很容易看到它（还有很多问题，但我把最知名/最受欢迎的应用程序按字母顺序排列）：Cropper 1.9.4，FSCaptureSetup53 , GreenShot, Lightscreen, PrtScrAssistant, ScreenshotCaptor, ...等。

顺便说一句，他们为什么要自己制作屏幕截图？当按下 Alt+Printscreen 时（没有任何钩子，没有运行屏幕捕获应用程序等），Windows 将正确的区域放在剪贴板上；但是当任何此类应用程序正在运行时，剪贴板/文件/等会得到一个不正确的区域。

请注意，我说的是“标准”窗口，没有主题，都带有矩形边框，没有个人 GUI，等等...... Windows 标准形式。

某些应用程序会在窗口的矩形边框周围放置一个额外的边距。其他应用程序，切掉了矩形窗口的一部分，所以有些部分丢失了，以至于标题标题的第一个字母（当没有显示系统菜单图标时）丢失了。

哪一个能像 Windows 标准的 Alt+Printscreen 一样工作（保存相同的区域）？我还不知道任何人，那时我测试的所有东西都失败了。

我知道的唯一解决方案是让 Paint.Net 打开并使用：

1.  Alt+打印屏幕
2.  Alt+Tad 转到 Paint.Net
3.  Ctrl+Alt+V 粘贴为新图像
4.  Ctrl+S 保存（它要求输入路径、名称和类型等）

在我尝试过的所有应用程序中，其中一些不会自动保存为 PNG；大多数创建PNG的保存错误区域（有些区域较大，有些区域不足）；总是谈论拍摄标准矩形窗口的快照。

测试平台：Windows XP、7、8、8.1 和 10

PD：如果您不是可以为您的表单设置 BorderStyle 和 BorderIcons 的开发人员，请尝试使用任何显示不可调整大小的工具窗口、对话框等的应用程序......很容易看出做 windows 屏幕截图之间的区别windows，然后将结果粘贴到任何可以自动保存的应用程序中；记住你需要使用 Alt+PrintScreen（只需要活动矩形窗口的区域，不多也不少）。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-06-24T06:54:51.540

发现一个像魅力一样工作的人：[free_clipboard_manager](http://www.myportablesoftware.com/freeclipboardmanager.aspx)

概念有所不同：每次剪贴板更改时，将剪贴板复制到文件中。

它还将复制到剪贴板的文本保存在 TXT 文件中。

由于它保存了复制到剪贴板的内容，因此它会像 windows 一样保存屏幕截图，包括`Alt`-`PrintScreen`当窗口边框不同时等。

它是便携式的，无需安装，无需提升等，它在普通用户帐户中运行。

它创建一个名为的文件夹`clipboard`，将复制到剪贴板的每个内容（仅使用图像和文本测试）存储到文件中，每次剪贴板更改时创建一个文件，文本为 .TXT，图像为 .PNG（可以在选项中更改为 .JPG（90% 和 80%）。

我已经在 Windows 10 上对其进行了测试，因此它也适用于 Windows 10。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-04-05T19:04:47.397

如果您想轻松打印菜单和子菜单 轻松一步！W10 上的 Ctrl + Fn+ PrntScrn 粘贴到画图或写字板中

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2009-06-23T03:02:48.227

[您可以使用录屏软件DemoCreator](http://www.sameshow.com/demo-creator.html#107)录制整个过程。您可以在录音中添加多个标注。

* * *

## 回答 #25

> 赞同：-2
> 
> 时间：2008-10-28T13:53:07.880

你什么都不需要。只需挂钩菜单窗口。

# mfc - 如何更改 CScrollBar 的滚动框（拇指）的大小？

> ID：242610
> 
> 赞同：1
> 
> 时间：2008-10-28T09:03:31.990
> 
> 标签：mfc, scrollbar

我找不到任何改变它的方法。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T09:49:27.170

滚动框的大小由滚动条的范围和页面大小控制。您可以使用该[`CScrollBar::SetScrollInfo`](http://msdn.microsoft.com/en-us/library/092c3690.aspx)函数来控制这些设置，特别是结构的`nMin`、`nMax`和`nPage`成员[`SCROLLINFO`](http://msdn.microsoft.com/en-us/library/bb787537.aspx)。

[您可以在 MSDN 的此页面](http://msdn.microsoft.com/en-us/library/bb787527.aspx)上找到有关滚动条的更多信息- 阅读“滚动框位置和滚动范围”部分。

# asp.net - ASP.NET 性能瓶颈之谜

> ID：242614
> 
> 赞同：4
> 
> 时间：2008-10-28T09:07:10.110
> 
> 标签：asp.net, performance, profiling

一个经典的 ASP.NET 应用程序 - AppSrv + MS SQL DB。两台服务器都是 8 核、20 GB RAM 的重型服务器。在负载测试时，吞吐量达到 400 个虚拟用户（根据 LoadRunner），CPU 使用率约为 30%，数据库服务器主要处于空闲状态 - 响应时间急剧增加，达到无响应的程度。

通常的怀疑，例如 Max Pool 被耗尽和 ASP.NET 设置的 conn 限制没有问题：Max Pool 设置为 200，使用了大约 80 个 conn；conn 限制设置为 0。

我用 ANTS profiler 运行了代码，它表明线程阻塞没有显着贡献。

非常欢迎提出想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T09:28:52.063

当没有 CPU 被占用并且页面往往变得无响应时，我的第一个预感是数据库锁定。当不释放表上的锁时，一个线程可以保留其余的线程，这会导致在空闲数据库服务器时页面无响应。

您可以使用 sql 监控工具来验证数据库机器上的正确使用，并查看是否所有用户都正确获取了他们的数据？

另一件事；您可以提供有关内存使用的哪些信息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T09:31:42.930

使用一些适当的唯一请求 ID 将日志记录添加到您的应用程序，以便您可以有效地跟踪页面加载中的每个操作需要多长时间。例如，每次数据库调用之前和之后的日志记录将显示数据库调用是否需要很长时间。

正如其他人所建议的那样，在数据库端添加日志记录/分析将显示这是否是死锁的（或类似的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T11:47:27.527

我们最近使用以下[IIS 性能设置](http://technet.microsoft.com/en-us/magazine/cc160755.aspx)指南调整了我们的 Web 应用程序，该指南非常成功。

我们更改了两个特定于服务器的设置；

**工作集内存使用**- 运行 Windows Server™ 2003 的服务器默认配置为在分配内存时优先考虑文件系统缓存而不是工作集。Microsoft 这样做是因为 Windows 受益于拥有大型文件系统缓存。由于 IIS 位于 Windows 操作系统之上，因此它还受益于拥有大型文件系统缓存。但是，如果您的服务器是专用的 IIS 服务器，则如果您将优先级转移到工作集，您可能会看到更好的性能。这背后的原因是，如果优先考虑文件系统缓存，可分页代码通常会写入虚拟内存。下次需要此信息时，必须将其他内容分页到虚拟内存，并且必须先将先前分页的信息读入物理内存，然后才能使用它。这导致处理非常缓慢。

**网络吞吐量**- 默认情况下，运行 Windows Server 2003 的服务器配置为在分配内存时优先使用文件系统缓存而不是进程的工作集（通过服务器属性最大化文件共享的数据吞吐量）。尽管基于 IIS 6.0 的服务器受益于大型文件系统缓存，但提供文件系统缓存首选项通常会导致 IIS 6.0 可分页代码写入磁盘，从而导致长时间的处理延迟。要避免这些处理延迟，请设置服务器属性以最大化网络应用程序的数据吞吐量。

专用 Web 服务器上不需要以下服务：

*   警报器
*   剪贴簿
*   电脑浏览器
*   DHCP 客户端
*   DHCP 服务器
*   传真服务
*   文件复制
*   红外线监视器
*   Internet 连接共享
*   信使
*   NetMeeting 远程桌面共享
*   网络 DDE
*   网络 DDE DSDM
*   NWLink NetBIOS
*   NWLink IPX/SPX
*   打印后台处理程序
*   TCP/IP NetBIOS 帮助服务
*   电话
*   远程登录
*   不间断电源供应

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T14:06:05.857

问题可能在您的`machine.config`文件中。

您应该检查以下配置参数：

*   `maxconnection`
*   `maxIoThreads`
*   `maxWorkerThreads`
*   `minFreeThreads`
*   `minLocalRequestFreeThreads`

简短描述检查： [IIS 6.0 Tuning for Performance](http://www.eggheadcafe.com/articles/20050613.asp)

ASP.NET 1.1 和 ASP.NET 2.0 之间存在一些差异

**ASP.NET 1.1**

您可以在以下位置找到有关一些实用价值的指南：

*   [微软知识库文章 821268](http://support.microsoft.com/?id=821268)
*   MSDN 文章[“第 6 章 - 提高 ASP.NET 性能 - 线程解释”](http://msdn.microsoft.com/en-us/library/ms998549.aspx#scalenetchapt06_topic8 "线程解释章节")

默认值对于任何实际使用来说都太低了，应该根据链接文章中的建议进行更正。

**ASP.NET 2.0**

参数被移动到`processModel`部分并且参数被自动配置。除了自动配置，您还可以手动设置参数值，因此您应该检查是否：

*   `processModel`已启用
*   `autoConfig`设置为 `true`
    或
*   参数设置为正确的值

详细描述检查：[ASP.Net 2.0 processModel](http://msdn.microsoft.com/en-us/library/7w2sway1.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T09:16:57.203

主机是否使用应用程序池？

您是否尝试将数字增加到 5 到 10

```
An Application Pool -> Performance -> 
Web Garden -> Max Number of worker processes 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T10:47:44.370

还要检查网络饱和度。确保您的负载测试机器和 Web 服务器之间的网络连接没有达到极限。此外，如果您在 Web 和数据库服务器之间返回大量繁重的文本/二进制数据，请监控该网络连接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-28T13:26:10.243

这可能是一个很长的尝试，但您可以尝试通过[模式和实践检查器](http://www.codeplex.com/PracticesChecker)运行您的代码，看看它是否找到了任何容易实现的目标。

# ruby - 如何增加 ruby 应用程序的堆栈大小。递归应用程序获取：堆栈级别太深（SystemStackError）

> ID：242617
> 
> 赞同：39
> 
> 时间：2008-10-28T09:08:57.597
> 
> 标签：ruby, recursion

在 stackoverflow.com 上发布堆栈溢出问题，多么有趣:-)

我正在运行一些递归 Ruby 代码，我得到：`"Stack level too deep (SystemStackError)"`

（我很确定代码有效，我没有处于无限递归的死亡螺旋中，但这不是重点）

无论如何可以更改我的 Ruby 应用程序允许的堆栈深度/大小？

如果这是 Ruby 中的限制，我不太明白，因为错误显示“堆栈级别”，这给我的印象是 Ruby 以某种方式计算堆栈的“级别”，或者它只是意味着堆栈已满。

我试过在 Vista 和 Ubuntu 下运行这个程序，结果相同。在 Ubuntu 下，我尝试使用 'ulimit -s' 将堆栈大小从 8192 更改为 16000，但这并没有改变任何东西。

编辑：感谢您的反馈。
我确实意识到使用递归函数可能不是最可靠的方法。但这也不是重点。我只是想知道是否有办法增加堆栈大小......期间。正如我所提到的，我确实在运行 ruby​​ 脚本之前尝试运行 ulimit -s 16000 ..没有任何改进..我用错了吗？

Edit2：实际上，我在代码的边缘情况下进行了无限递归。
收到错误时截断的 ruby​​ 堆栈跟踪`"Stack level too deep"`有点误导。
当具有涉及多个函数的递归行为时，您会得到递归数量比实际数量少得多的印象。在此示例中，可能会在超过 190 次调用后崩溃，但实际上大约是 15000 次调用

```
tst.rb:8:in `p': stack level too deep (SystemStackError)
        from tst.rb:8:in `bar'
        from tst.rb:12:in `bar'
        from tst.rb:19:in `foo'
        from tst.rb:10:in `bar'
        from tst.rb:19:in `foo'
        from tst.rb:10:in `bar'
        from tst.rb:19:in `foo'
        from tst.rb:10:in `bar'
         ... 190 levels...
        from tst.rb:19:in `foo'
        from tst.rb:10:in `bar'
        from tst.rb:19:in `foo'
        from tst.rb:22 
```

-安德烈亚斯

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-12-16T17:29:04.320

这个问题及其答案似乎可以追溯到使用 C 堆栈的 Ruby 1.8.x。Ruby 1.9.x 及更高版本使用具有自己堆栈的 VM。在 Ruby 2.0.0 及更高版本中，VM 堆栈的大小可以通过`RUBY_THREAD_VM_STACK_SIZE`环境变量进行控制。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-28T18:38:35.323

如果您确定没有无限递归情况，那么您的算法可能不适合 Ruby 以递归方式执行它。将算法从递归转换为不同类型的堆栈非常容易，我建议您尝试一下。这是你如何做到的。

```
def recursive(params)
  if some_conditions(params)
     recursive(update_params(params))
  end
end

recursive(starting_params) 
```

将转变为

```
stack = [starting_params]
while !stack.empty?
  current_params = stack.delete_at(0)
  if some_conditions(current_params)
    stack << update_params(current_params)
  end
end 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-28T09:32:15.817

Yukihiro Matsumoto 在[这里写](http://groups.google.com/group/comp.lang.ruby/browse_thread/thread/d4d50fb6127933ec?pli=1)

> Ruby 使用 C 堆栈，因此您需要使用 ulimit 来指定堆栈深度的限制。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-28T09:35:38.383

Ruby 使用 C 堆栈，因此您的选项包括使用 ulimit 或使用一些编译器/链接器堆栈大小标志编译 Ruby。尾递归尚未实现，Ruby 当前对递归的支持不是很好。由于递归很酷且优雅，您可能需要考虑应对语言的限制并以不同的方式编写代码。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-28T11:50:53.650

想想代码发生了什么。正如其他海报所提到的，可以破解解释器的 C 代码。然而。结果将是您正在使用更多的 RAM，并且无法保证您不会再次破坏堆栈。

真正好的解决方案是为您尝试做的事情提出一个迭代算法。有时记忆会有所帮助，有时你会发现你没有使用你正在压栈的东西，在这种情况下，你可以用可变状态替换递归调用。

如果您对这类东西不熟悉，请在[此处](http://mitpress.mit.edu/sicp/)查看 SICP以获得一些想法...

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-11-14T09:43:16.310

刚遇到同样的问题，在 Linux 或 Mac 上很容易修复。如其他答案所述，Ruby 使用系统堆栈设置。您可以通过设置堆栈大小在 Mac 和 Linux 上轻松更改此设置。狐狸示例：

```
ulimit -s 20000 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-05-08T00:31:27.537

从[Ruby 1.9.2](http://blog.tdg5.com/tail-call-optimization-in-ruby-background/)开始，您可以通过以下方式打开尾调用优化：

```
RubyVM::InstructionSequence.compile_option = {
  tailcall_optimization: true,
  trace_instruction: false
}

RubyVM::InstructionSequence.new(<<-EOF).eval
  def me_myself_and_i
    me_myself_and_i
  end
EOF
me_myself_and_i # Infinite loop, not stack overflow 
```

`SystemStackError`如果递归调用位于方法的末尾并且*仅位于方法*的末尾，这将避免错误。当然，这个例子会导致一个无限循环。在进行深度递归之前，最好使用浅递归（并且不进行优化）进行调试。

# perl - 如何使用 Perl 的 Net::LDAP 进行复杂查询？

> ID：242621
> 
> 赞同：5
> 
> 时间：2008-10-28T09:10:53.770
> 
> 标签：perl, ldap

我在对我们公司的 LDAP 服务器运行复杂查询时遇到问题。我正在使用以下 Perl 脚本：

```
use Data::Dumper;
use Net::LDAP;

die "Can't connect to LDAP-Server: $@\n" 
    unless $ldap = Net::LDAP->new( 'xLDAPx' );

foreach my $filter ( 'ou=Personal', 'ou=BAR', 'ou=Personal,ou=BAR', 'ou=Personal,ou=FOO,o=FOO,dc=foo,dc=com' )
{ 
    $mesg = $ldap->search( base => "o=FOO,dc=foo,dc=com", filter => $filter );
    print Dumper($mesg), "\n\n";
} 
```

虽然前两个过滤器有效（如返回预期值），但最后一个复杂的过滤器无效。它返回一个空数组。真正让我感到困惑的是，当我将它与像 Softerra LDAP 浏览器这样的工具一起使用时，完全相同的查询字符串会起作用。

我也尝试过使用 PHP 的`ldap_search`& co 进行相同的查询，但无济于事。

有人可以对此有所了解吗？

谢谢阅读

霍利

编辑：这是服务器的结构：

```
Server
    ou=FOO
        ou=...
        ou=Personal
            uid=something 
```

我需要一个 uid 列表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T10:23:17.977

我想你希望它更像`(&(ou=Personal)(ou=FOO)(o=FOO)(dc=foo)(dc=com))`. 但是您根本不清楚您到底想要什么，所以我无法为您制作过滤器。

编辑添加：我猜这是你想要做的：`(|(ou=Personal)(ou=FOO))`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T09:31:34.400

原因是您没有提供语法正确的过滤器字符串，而是 DN 的一部分。我无法想象这在 Ldap 浏览器中有效 - 我只是尝试了自己但没有成功。

前两个是正确的过滤器字符串。它们以“({attribute}={value})”的方式过滤单个对象属性。第一个 ("ou=Personal") 将在您的搜索库中返回任何名为“Personal”的 OU。

如果您更详细地解释您要查找的内容，我可能会告诉您您需要什么过滤器表达式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T11:23:15.563

编写一个符合[RFC 2254](http://www.faqs.org/rfcs/rfc2254.html)的过滤器， 然后看看会发生什么。您不需要复杂的查询，您希望一个分支下的每个条目都有一个属性。查看搜索方法的 attrs 参数。

# c# - 从客户端到服务器的计划数据备份

> ID：242622
> 
> 赞同：0
> 
> 时间：2008-10-28T09:11:44.157
> 
> 标签：c#, java, client-server, backup

谁能指出哪些技术最适合将数据从客户端备份到服务器的应用程序？

> 客户端应选择要备份的文件夹并将备份安排到服务器

我也对您将如何开始开发/设计感兴趣，您将如何在尽可能短的时间内构建应用程序的基本版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T09:30:58.707

窗户上的快速和肮脏的方式？

共享文件夹 / [Robocopy](http://www.microsoft.com/downloads/details.aspx?displaylang=en&familyid=9D467A69-57FF-4AE7-96EE-B18C4790CFFD) / 计划任务（或由您的应用触发）

最好的方式？

使用 FTP 服务器进行 Cobian 备份

你确定要开发自己的东西吗？是否必须在您的应用程序中使用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T09:36:05.233

如果我想进行一次备份，我会使用免费的备份工具，使用 Google 找到适合您需求的工具

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T15:09:10.787

有许多备份应用程序，从简单的 xcopy 到 Symantec。我同意 Vinzz 的观点，真的有理由开发自己的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T21:43:41.037

我只需要开发这种应用程序。

# windows - How to reset Performance objects in perfmon?

> ID：242626
> 
> 赞同：6
> 
> 时间：2008-10-28T09:13:39.740
> 
> 标签：windows, perfmon

When I launch perfmon and try to add a counter, the displayed performance objects are all numbers. How can I reset these Performance objects?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-28T11:04:02.450

I found a way to solve the problem:

*   copy C:\WINDOWS\system32\PerfStringBackup.INI from a PC where perfmon works correctly
*   cd C:\WINDOWS\system32
*   lodctr /R:PerfStringBackup.INI

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T10:56:13.870

What do you mean my "reset"? What's the behavior you're expecting?

The perfmon "System Monitor" view shows the (near) real time value of the counter. Since these measurements are always being taken there will (almost) always be a number there.

If you want to be able to control the collection of these measurements, you need to create a Counter Log. Additionally, you can use the logman command to manage the log from the command line or a script.

# javascript - 为什么 Date.parse 不返回 Date 对象？

> ID：242627
> 
> 赞同：18
> 
> 时间：2008-10-28T09:13:51.627
> 
> 标签：javascript

```
today1 = new Date();
today2 = Date.parse("2008-28-10"); 
```

要比较这些时间（毫秒）值，我必须执行以下操作，因为 today2 只是一个数字。

```
if (today1.getTime() == today2) 
```

为什么是这样？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-28T09:44:05.637

回答标题中的问题：因为他们在创建 JavaScript 语言时就这样决定了。可能是因为 Java 的`java.util.Date`parse 函数在做同样的事情，他们想模仿它的行为来让语言感觉更熟悉。

要回答文中的问题... 使用此构造获取两个日期对象：

```
var today2 = new Date(Date.parse("2008-10-28")); 
```

* * *

编辑：一个简单的

```
var today2 = new Date("2008-10-28"); 
```

也有效。

* * *

注意：旧的 Internet Explorer 版本（9 之前的任何版本）不理解日期字符串中的破折号。但它适用于斜杠：

```
var today2 = new Date("2008/10/28"); 
```

斜线似乎被新旧浏览器普遍理解。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T09:17:13.633

如果我没记错的话，Date 给你的值是你创建 Date 对象的毫秒数。因此，除非此代码在 2008 年 28 月 10 日 00:00:00:000 完全运行，否则它们将不一样。

只是一个补充： Date.parse() 根据定义返回一个 long 值，表示 Date 的毫秒值，而不是 Date 对象本身。如果您想保存 Date 对象本身，只需像这样构建它：

```
var newDate = new Date();
newDate.setFullYear(2008,9,28); 
```

如需更多参考，请查看：[Date 类参考](http://www.w3schools.com/jsref/jsref_obj_date.asp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T10:26:12.400

我无法代替语言设计者回答，但您可以在 Date 构造函数中使用 Date.parse 或 Date.UTC 的结果来获取此类对象。

请注意，您的代码示例不正确：它不是有效的日期格式，不是 ISO (yyyy-mm-dd) 也不是 IETF (Mon, 25 Dec 1995 13:30:00 GMT+0430)。所以你会得到一个NaN。Date.parse 仅了解 IETF 格式，来自我在[MDC](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Global_Objects/Date/Parse "Mozilla 开发者中心")上阅读的内容。

如果您需要比较两个日期，您可以比较 .getFullYear()、.getMonth() 和 .getDay() 的结果，或者只比较所需级别的字符串表示。

```
var d1 = new Date();
var n = Date.parse("28 Oct 2008");
var d2 = new Date(n);
var d3 = new Date("28 october 2008");

alert(d1.toDateString() == d2.toDateString());
alert(d2.toDateString() == d3.toDateString()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T09:44:30.160

Data.parse 返回的是一个 NaN。从根本上说，这是一个不确定的数字。这是大多数实现在无法将字符串转换为日期时返回的内容。一些实现只处理符合[RFC 1123](https://www.rfc-editor.org/rfc/rfc1123)的日期字符串（这是规范所要求的全部内容）。

**编辑**：对此答案的评论指出 Date.parse 不返回 NaN。但是规范说 parse 应该返回一个数字。当给定一个无法解析为日期的字符串时，它应该返回什么数字？它不能使用 0 或 -1 或其他一些这样的“流氓”值，因为这些是从 1970 年 1 月 1 日开始的有效毫秒偏移量。Mozilla 和 IE 都返回 NaN，这是非常明智的做法。

虽然规范不排除将诸如“2008-28-10”之类的字符串解析为有效日期，但它不需要它。我没有遇到任何超出规范要求的实现。因此，“2008 年 10 月 10 日”是您最接近上面将正确解析的字符串。

# .net - 表 NewRow() 导致内存泄漏

> ID：242629
> 
> 赞同：9
> 
> 时间：2008-10-28T09:15:47.770
> 
> 标签：.net, memory-leaks, datatable

在调查内存泄漏时，我发现它是由在循环内多次调用 Table 上的 NewRow() 引起的。但是，创建的 DataRow 从未添加到 Table Rows 集合中，并且 Table Rows Count 从未超过零。

我的问题是为什么每次调用 NewRow 时都会占用更多内存，即使新创建的 DataRow 从未添加到 Rows 集合中，并且从 NewRow 返回的 DataRow 总是分配给相同的局部变量（从而显然丢弃了最后一个新行）。

请忽略为什么代码会创建未添加到表中的 DataRows 的问题！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-28T09:39:54.380

DataTable.NewRow() 将创建的行添加到 DataTable 的 RecordManager。我不完全确定为什么会发生这种情况，但这就是为什么它没有被 GC 释放。

似乎只有两种方法可以摆脱 DataRow：

1.  将其添加到表中，然后将其删除。
2.  调用 DataTable.Clear()。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-28T09:35:17.370

DataRow 从 DataTable 继承架构，因此存在从 DataRow 到生成行的表架构的引用。新行在表中处于分离状态。
这就是为什么 GC 不理会新的未使用行的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T09:26:40.150

我认为你的两个问题是相关的。

Table.NewRow 创建一个与初始表具有相同列格式的新数据行。

需要使用 table.Rows.Add(newRow) 将此新行添加到表中。您的循环将创建从未使用过的对象，因此会占用内存。有关详细信息，请参阅本文 [http://msdn.microsoft.com/en-us/library/system.data.datatable.newrow.aspx](http://msdn.microsoft.com/en-us/library/system.data.datatable.newrow.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-12T06:57:23.323

如果你创建 newRow = table.NewRow() 然后在下面的代码中决定你不需要这个 newRow。1) 在表中添加 if 行。2）删除，它将防止内存泄漏。

```
 var table = new DataTable();
    while (true)
    {
        var newRow = table.NewRow();
        table.Rows.Add(newRow);   //Without this 2 rows you will have memory leak.
        table.Rows.Remove(newRow);//
    } 
```

# .net - 是否可以为 Zune 构建电子邮件阅读器？

> ID：242639
> 
> 赞同：3
> 
> 时间：2008-10-28T09:25:45.003
> 
> 标签：.net, xna, zune, xna-3.0

是否可以通过 XNA 为 Zune 构建电子邮件阅读器？

版本 3.0 允许我们连接到市场并直接从 Zune 下载音乐，因此我的问题的性质。

编辑：购买 ZuneHD

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T18:14:53.887

不。

Zune 的 XNA 3.0 确实提供了一些网络类，但似乎它们专门用于与其他设备（用于多人游戏）对话。

因此，虽然您可能能够制作点对点聊天程序或其他东西，但您将无法使用电子邮件等服务器端资源。

[这是一个](http://forums.xna.com/forums/t/11797.aspx)链接到一些网络示例的线程：

编辑：我找到了[官方常见问题解答](http://forums.xna.com/forums/p/8911/46553.aspx)：

* * *

问：无线支持如何工作？

A：Zune 设备可以支持多个已开启无线且在彼此范围内的 Zune。如果所有 Zune 都部署了游戏，并且游戏被编写为在多人模式下运行，那么您可以加入并与其他 Zune 一起玩游戏。

**问：我们可以通过无线连接与网络服务器或 RSS-feed 交谈吗？**

**A: Zune 无线连接不支持互联网。它只允许您与附近的其他 Zune 一起玩游戏，以及其他标准 Zune 功能（即音乐共享等）**

# ruby-on-rails - Rails 元插件安装脚本？

> ID：242640
> 
> 赞同：0
> 
> 时间：2008-10-28T09:26:07.497
> 
> 标签：ruby-on-rails, plugins

我想看看是否有一种方法可以将几个插件打包在一起作为一个元插件自动安装所有东西，就像一个项目模板一样工作。

为什么不是脚本？因为我想把它放在 github 中，所以当我不使用自己的 PC 时我不必担心它：) 但是因为基于脚本的解决方案也受到欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T13:35:29.820

我的解决方案（红宝石脚本）：

```
plugins = %w{
  http://url_to_plugin_1
  http://url_to_plugin_2
  http://url_to_plugin_3
  http://url_to_plugin_4
  http://url_to_plugin_5
}
plugins.each do | p |
  `ruby script/plugin install -x #{p}`
end 
```

从项目根目录运行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T13:00:17.507

如果你真正想要的是一个项目模板，你可以试试[模板](http://m.onkey.org/2008/12/4/rails-templates)，这是 2.3 的一个新特性

# algorithm - 数学：因式分解

> ID：242643
> 
> 赞同：2
> 
> 时间：2008-10-28T09:26:44.003
> 
> 标签：algorithm, math, methodology, primes

*省略计算素数的方法和分解方法的细节。*

### 为什么要分解？

### 它的应用有哪些？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-28T11:21:00.513

哇，在这个线程中战斗如此之多。

具有讽刺意味的是，这个问题有一个主要的有效答案。

因式分解实际上在加密/解密算法中被大量使用，以至于 RSA 定期进行比赛，其中的任务是分解某些大数，这些大数是非常大的素数的倍数。

反过来，这是因为几种加密/解密算法是基于分解需要很长时间的前提，假设黑客/破解者无权访问公钥/私钥。

然后可以使用分解算法来验证任何给定的加密/解密算法的强度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T11:53:30.853

作为 RSA/DAS 的非对称加密基于这样一个事实，即分解是一件非常困难的事情。如果我给你一个数字，打印出来的时候有整张报纸那么大，然后告诉你“这个数字是由两个质数相乘产生的。现在请分解它”......你认为你可以吗？相信我，任何已知的方法都需要很长时间。如果不需要大量的 CPU 时间（几个世纪）或大量的内存（比世界上所有 Internet 服务器的总存储量还要多），就没有有效的方法可以做到这一点。如果您找到一种简单的方法来分解这么大的数字，例如，您会破坏电子邮件签名和 SSL (HTTPS)。

但是，还有其他与因式分解相关的任务。因式分解不仅与数字有关。有时它是关于“为什么多项式是另一个多项式的因数”。因此，数学任务可能依赖于因式分解，因此可以解决许多问题。因此，有效的因式分解具有很大的价值。甚至矩阵也可以分解。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-29T05:50:50.070

它可用于破解某些类型的加密（如果它们的密钥足够小）。

对于某些类型的科学软件，您还需要它。

另一项应用是回答[ProjectEuler](http://projecteuler.net/)问题。

# vim - 将 vimdiff 与 diff 文件一起使用

> ID：242646
> 
> 赞同：46
> 
> 时间：2008-10-28T09:27:25.623
> 
> 标签：vim, vimdiff

如何使用 vimdiff 查看 diff 文件中描述的差异？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-10-28T20:34:51.360

而不是使用`/usr/bin/vimdiff`命令，试试这个：

```
$vim 文件
:vertical diffpatch path/to/diff
```

（`:vert diffpa`简称。）
这相当于调用`vimdiff`原始文件和随后的修补文件，但为您`vim`调用`patch`一个临时文件。

## 编辑

如果您希望`vim`自动输入 diff-mode，请使用以下命令：

```
$ vim file +'vert diffpa path/to/diff'
```

where`+command`要求`vim`执行“命令”。（`+123`跳到第 123 行，`+/abc`跳到“abc”的第一个匹配项，这一切都记录在案了。）

关于 Ken 的查询：如果 diff 文件包含应用于您当前正在编辑的文件以外的文件的块，不用担心；`vim`调用`patch`下面的可执行文件，它将询问这些神秘丢失文件的位置，您可以告诉您`patch`跳过这些大块。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T16:39:14.550

来自另一个方向。我编写了一个 Vim 插件，它显示了自上次以 vimdiff 或统一差异格式保存以来对文件所做的更改。

在这里获取：[diffchanges.vim](http://www.vim.org/scripts/script.php?script_id=2158)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T09:44:25.887

制作原始文件的副本，应用差异，然后

```
vimdiff original_file patched_file 
```

您还可以查看[vim.org 脚本](http://www.vim.org/scripts/script.php?script_id=2090)，这些脚本是为处理 svn diff 输出而编写的。如果您从版本控制系统生成差异，请查看 [vcscommand.vim：CVS/SVN/SVK/git integration plugin](http://www.vim.org/scripts/script.php?script_id=90)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-12T22:35:22.743

您能否详细说明为什么要为此使用 vimdiff ？

例如，您想[在（统一的）差异文件中可视化每个字符的差异吗？](https://stackoverflow.com/questions/3231759/how-can-i-visualize-per-character-differences-in-a-unified-diff-file). 如果是这样，有人回答[了我的问题](https://stackoverflow.com/questions/3231759/how-can-i-visualize-per-character-differences-in-a-unified-diff-file)，[建议](https://stackoverflow.com/questions/3231759/how-can-i-visualize-per-character-differences-in-a-unified-diff-file/3509992#3509992)基本上只是在 diff 上启动 emacs 并点击`ALT-n`循环浏览大块，很好地突出显示沿途的每个单词或每个字符的变化（类似于 vimdiff）。它工作得很好，但是仅仅为了做到这一点就启动 emacs 是一件很糟糕的事情。我只知道足够多的 emacs 来做到这一点，然后退出而不破坏补丁。:)

无论如何，emacs的回答给了我一些想法。我确信 Vim 可以被哄骗为 diff 文件提供更好的突出显示，也许更像是 ediff。我不久前研究了这个问题，vim 用户列表中的某个人提出了[合并 google-diff-match-patch](http://thread.gmane.org/gmane.editors.vim/89542/focus=91342)的极好建议。例如，可以从 Python Vim ftplugin 使用 Python 接口。

很抱歉在这可能不是一个很好的答案时使用“答案”来回复，“添加评论”的格式对于我想说的话来说太有限了。

对于后代，[这里是对另一个类似问题的参考](https://stackoverflow.com/questions/704707/viewing-unified-diff-with-meld-vimdiff-other-tools)（也已经在这里链接）。

# asp.net - 访问控制、ajax、asp.net

> ID：242647
> 
> 赞同：0
> 
> 时间：2008-10-28T09:28:15.577
> 
> 标签：asp.net, ajax, controls

我有一个带有一些控件的 aspx 页面。我还有一个 DIV，它是从 AJAX 调用动态填充的。此 AJAX 调用返回几个控件，例如 HtmlInputText1 和 HtmlInputText2。

提交页面后，我可以通过 Request.Form 从此控件中获取值。如果可能的话，在pege代码后面（例如HtmlInputText1.Height等）上访问这个控件的属性。

我认为这是不可能的，但我不确定。我可以使用隐藏字段。有没有别的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T09:48:31.463

您希望服务器知道的数据可以由表单中的 javascript 设置。然后您可以手动处理目标值的回发数据。

您可以编写一些 javascript 来修改浏览器中服务器控件的值。

```
<script language="javascript" type="text/javascript">
function changeValue() {
    var txtControlClient = document.getElementById('<%= txtControl.ClientID %>');
    txtControlClient.value = "modified text";
}
</script> 
```

在预期的事件中，您在回发之前调用 changeValue() 函数，然后您可以使用服务器控件对象 txtControl 来获取您已更改的值或属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T13:56:22.680

> 您希望服务器知道的数据可以由表单中的 javascript 设置。然后您可以手动处理目标值的回发数据。

这个怎么做？

# .net - .NET 框架中最安全的哈希算法是什么？

> ID：242648
> 
> 赞同：2
> 
> 时间：2008-10-28T09:28:50.050
> 
> 标签：.net, security, encryption, hash

生成的哈希大小和算法的速度并不重要。我真的只对它是最安全的选择感兴趣。我也不想使用任何第三方库。

我使用的 .NET 框架的版本如果 3.5 有什么不同的话。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-28T09:33:03.740

我认为[SHA512](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha512.aspx)将是内置哈希算法的最佳选择。它是一种非常安全的算法的最大散列形式。

另外，不要忘记使用盐来帮助保护哈希免受[字典攻击](http://en.wikipedia.org/wiki/Dictionary_attack)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-06T13:09:03.733

您说算法的*速度*并不重要，但实际上它很重要。

很大程度上取决于“安全”的定义，`SHA512`（几乎）不可能逆转，但实际上[蛮力攻击它相当容易](http://www.troyhunt.com/2012/06/our-password-hashing-has-no-clothes.html)。

这是因为它*很快*——您可以将其视为 SHA“家族”的基本设计缺陷，因为它们的设计速度非常快。

这是一个问题 -`SHA512`实现了非常快的设计目标（它并不比 慢很多`SHA1`），但如果你是一个尝试暴力破解密码的黑客，那么它更容易破解。10 甚至 5 年前，严重的暴力攻击是不可能的，现在是几个花哨的显卡或一些云时间。

这就是密钥扩展算法的用武之地——它们*故意使构建密码哈希的过程变慢*。速度足够慢，以至于用户检查单个哈希不会注意到，但蛮力攻击将花费太长时间。

密钥拉伸算法的一个很好的例子是 RFC2898 或[PBKDF2](http://en.wikipedia.org/wiki/PBKDF2) - 它使用长盐并执行 SHA 算法数千次来创建一个复制速度很慢的哈希。

.Net 有一个本机实现：[`Rfc2898DeriveBytes`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes.aspx)

他们将其用于[`System.Web.Crypto.HashPassword`](http://msdn.microsoft.com/en-us/library/system.web.helpers.crypto.hashpassword%28v=vs.99%29.aspx)，但您可以轻松[查看他们的来源](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/89b9166ca722#src/System.Web.Helpers/Crypto.cs)以在其他地方使用它。

现在在我的机器上（一台相当垃圾的旧笔记本电脑）一个具有 1000 次迭代（默认）的单个 .Net`Rfc2898DeriveBytes`哈希大约需要 50 毫秒，而我可以在一秒钟内暴力破解大约 250,000 个 SHA512 哈希。

**So in .Net right now the most secure option is to use `Rfc2898DeriveBytes`.**

However RFC2898/PBKDF2 does have a weakness - while it is slow parallel computing is getting cheaper and cheaper and it doesn't take much memory to build each hash. Right now it's pretty un-brute-forceable, but in 5 or 10 years?

So the next generation are algorithms like [bcrypt](http://en.wikipedia.org/wiki/Bcrypt)/[scrypt](http://en.wikipedia.org/wiki/Scrypt) that are designed to use a lot of memory for each hash, making parallel executions expensive. While there are .Net implementations there isn't a native one (yet) and I'd be wary of using one until there is - using these will affect loads of things like concurrent log-ons (if used for passwords) and so introduce a lot of risk for early adopters.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T05:51:40.400

User asked what is most secure Hashing algorithm in .NET, PBKDF2 is not a hashing algorithm, it is a method of deriving encryption keys and yes the underlying pseudo random function MAY be a hashing algorithm however in Rfc2898DeriveBytes it is actually HMACSHA1 over x passes with each byte of each hash value from each pass XORed with the next (know as key stretching).

So to answer the question currently HMACSHA512 is the most secure hashing algorithm in .NET currently.

If you wish to "hash" passwords, (And I say hash because it is not a direct hash function output) here is an API that takes PBKDF2 and uses HMACSHA512 to derive bytes rather than the Rfc2898DeriveBytes MS implemented using HMACSHA1: [https://sourceforge.net/projects/pwdtknet](https://sourceforge.net/projects/pwdtknet)

# unit-testing - 突变测试在实践中有用吗？

> ID：242650
> 
> 赞同：48
> 
> 时间：2008-10-28T09:29:02.843
> 
> 标签：unit-testing, testing, code-coverage, mutation-testing

你有突变测试在现实生活中应用的例子吗？它比简单的测试覆盖工具更好用吗？还是没用？

现实世界中突变测试的优点/缺点是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-03-09T13:29:50.737

单元测试的用处不再讨论。它们在质量应用程序的概念中是必不可少的。但是，我们如何评估它们的相关性？代码覆盖率指标高达 100% 并不意味着代码经过 100% 测试。这只是单元测试执行期间执行代码的视图。突变测试将使您对测试更有信心。

这是一个两步过程：

1.  生成突变体。
2.  检查测试是否发现了突变。

我写了一篇关于这个过程的整篇[文章](http://blog.octo.com/en/mutation-testing-a-step-further-to-the-perfection/)，包括一些具体的案例。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-28T12:11:43.233

前段时间，我将突变测试作为一种检查自动化回归测试脚本有效性的方法。基本上，这些脚本中有许多缺少检查点，因此当他们正确执行正在测试的应用程序时，他们并没有根据基线数据验证结果。我发现比更改代码更简单的方法是编写另一个应用程序来对基线副本进行修改，然后根据修改后的基线重新运行测试。在这种情况下，任何通过的测试要么是错误的，要么是不完整的。

这不是真正的突变测试，而是一种使用类似范例来测试测试脚本功效的方法。实现起来很简单，IMO 做得很好。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-06-22T13:37:28.007

我知道这是一个老问题，但最近 Bob 叔叔写了一篇关于变异测试非常有趣的博客文章，可以帮助理解这种测试的有用性：

[鲍勃叔叔变异测试博客文章](http://blog.cleancoder.com/uncle-bob/2016/06/10/MutationTesting.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-10T09:04:34.847

我已经为一个小的、做作的应用程序玩了 Pitest：

[http://pitest.org/](http://pitest.org/)

这是一个自动化突变生成的java工具。您可以针对您的测试套件运行它，它会为您生成 HTML 报告，表明有多少突变体被杀死。看起来很有效，不需要太多的努力来设置。实际上，Java 世界中有很多不错的工具可用于此类事情。也可以看看：

[http://www.eclemma.org/](http://www.eclemma.org/)

为了覆盖。

* * *

我认为突变测试背后的概念是合理的。这只是工具支持和意识的问题。您正在努力在传统代码覆盖率指标的简单性和该技术的额外复杂性之间进行权衡 - 它实际上只是归结为工具。如果您可以生成突变体，那么它将*有助于*暴露您的测试用例中的弱点。与您已经进行的测试相比，是否值得稍微增加努力？使用pitest，我确实发现它出现了似乎不明显的测试用例。

突变测试是一种攻击角度，与单元/功能/集成测试方法完全不同。

1.  你测试你的测试套件——它是你整个测试程序的元测试。
2.  它激发了您可能没有考虑过的其他测试用例。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-12-01T15:57:59.537

变异测试帮助我发现了测试用例断言的问题。

例如，当您收到一份报告说“测试用例 x 没有杀死任何突变体”时，您查看一下，结果发现断言已被注释掉。

根据[这篇论文](https://homes.cs.washington.edu/~rjust/publ/industrial_mutation_icst_2018.pdf)，谷歌的开发人员使用变异测试作为代码审查和拉取请求检查的补充。他们似乎对结果很满意：

> 开发人员已决定重新设计大量代码以使其可测试，以便杀死突变体，他们在查看突变体的复杂逻辑表达式中发现了错误，他们决定删除具有等效突变体的代码，因为他们认为这是过早的优化，他们声称突变体为他们节省了数小时的调试时间，甚至是生产中断，因为没有测试用例正确地覆盖了突变下的逻辑。突变测试被称为多年来代码审查验证中最好的改进之一。虽然这种反馈很难量化，但再加上成千上万的开发人员愿意在他们的代码更改上检查浮出水面的突变体，这就是一个声明。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-07-11T17:24:58.077

我最近对突变测试做了一些调查。结果在这里：

[http://abeletsky.blogspot.com/2010/07/using-of-mutation-testing-in-real.html](http://abeletsky.blogspot.com/2010/07/using-of-mutation-testing-in-real.html)

简而言之：突变测试可以提供一些关于源代码和测试质量的信息，但它并不是直接使用的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-17T09:46:10.690

由于上述突变，第一个测试用例的行为不同，现在引发了一个异常。所以它不会返回 {6,3} 的预期数组。但是，我们的第二个测试用例保持不变，因为它也包含正数。因此，它也对正数给出了例外。现在，如果我们必须编写一个成功的测试用例 Input ={-6,-6,-7,-3,-4} Expected = {-6,-3}

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-17T22:07:11.713

覆盖率与突变测试。一个老问题，但我最近遇到了有关该主题的最新博客。很有主见。但是覆盖率和突变测试之间的区别是明确的。

[https://pedrorijo.com/blog/intro-mutation/](https://pedrorijo.com/blog/intro-mutation/)

我自己的经验表明 Pitest 非常有用，但由于运行时爆炸，它只能运行一个非常快速的测试集。在实践中，这限制了我应用突变测试的地方。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-22T05:26:26.007

[我使用https://stryker-mutator.io/docs/stryker-js/guides/angular/](https://stryker-mutator.io/docs/stryker-js/guides/angular/)在 Angular 上设置突变测试只是为了进行实验，并且花了 2 个小时来获得单个代码文件的报告。也就是说，我对在 .NET 中使用 Stryker 的体验非常满意。我必须承认我对突变测试相当陌生，可能有更好的工具可以与 Angular/karma 一起使用，但性能是需要牢记的，特别是如果你打算将它与 TDD 结合使用。

# c - 了解 OpenSSL 中的引擎初始化

> ID：242665
> 
> 赞同：11
> 
> 时间：2008-10-28T09:35:10.443
> 
> 标签：c, openssl

我正在尝试设置 HMAC-SHA-256 散列的基本测试，但我遇到了引擎设置问题。理想情况下，我只想设置 HMAC-SHA 算法，但到目前为止，我什至还没有得到加载所有算法工作的一般情况。目前，我在尝试设置默认摘要的行上遇到了段错误。

另外，我经常使用 Java，因此请随时指出代码中的任何错误。

```
#include <openssl/hmac.h>
#include <openssl/evp.h>
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main() {
  unsigned char* key = (unsigned char*) "0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b";
  unsigned char* data = (unsigned char*) "4869205468657265";
  unsigned char* expected = (unsigned char*) "b0344c61d8db38535ca8afceaf0bf12b881dc200c9833da726e9376c2e32cff7";
  unsigned char* result;
  HMAC_CTX* ctx;
  ENGINE* e;

  ENGINE_load_builtin_engines();
  ENGINE_register_all_complete();
  ENGINE_set_default_digests(e);

  HMAC_CTX_init(ctx);
  HMAC_Init_ex(ctx, key, 40, EVP_sha256(), e);
  result = HMAC(NULL, NULL, 40, data, 16, NULL, NULL);
  HMAC_CTX_cleanup(ctx);

  ENGINE_finish(e);
  ENGINE_free(e);

  if (strcmp((char*) result, (char*) expected) == 0) {
    printf("Test ok\n");
  } else {
    printf("Got %s instead of %s\n", result, expected);
  }
} 
```

编辑：该程序现在已经发展到以下，但我仍然在 segfaulting `HMAC_Init_ex`：

```
unsigned char* key = (unsigned char*) "0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b";
unsigned char* data = (unsigned char*) "4869205468657265";
unsigned char* expected = (unsigned char*) "b0344c61d8db38535ca8afceaf0bf12b881dc200c9833da726e9376c2e32cff7";
unsigned char* result;
unsigned int result_len = 64;
HMAC_CTX ctx;
ENGINE* e;

result = (unsigned char*) malloc(sizeof(char) * result_len);
e = (ENGINE*) ENGINE_new();

ENGINE_load_builtin_engines();
ENGINE_register_all_complete();
ENGINE_set_default_digests(e);

HMAC_CTX_init(&ctx);
HMAC_Init_ex(&ctx, key, 16, EVP_sha256(), e); 
HMAC_Update(&ctx, data, 40);
HMAC_Final(&ctx, result, &result_len);
HMAC_CTX_cleanup(&ctx);

ENGINE_finish(e);
ENGINE_free(e); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-29T00:08:01.367

正如马丁所说，您最初建议的问题是您需要初始化 ENGINE。您编辑的代码的问题在于您正在执行 ENGINE_new，这将为您提供一个全新的 ENGINE，然后您需要为其提供密码方法、摘要方法等。事实上，对于您想要的（以及几乎每个人都想要），完全忽略所有 ENGINE 的东西是正确的选择。

一些附属问题：

*   你的字符串是十六进制的，但你需要一个 \x 每个字符才能在字符串中的那个位置实际获得那个十六进制字节，我怀疑这就是你想要的。
*   您试图从“数据”中散列 40 个字节，这并不长（实际效果：您最终会部分散列结果字符串）
*   你的预期结果是（据我所知）不正确
*   您可以将随机字符打印到终端，因为 HMAC 函数将生成 32 字节的随机二进制数据，而不是可打印的内容。

以下代码编译、运行并通过了测试。它与您找到的示例代码有点不同（因为它仍然使用单独的 HMAC_* 函数 - 如果您想使用 HMAC_Update 一点一点地进行散列，这很有用）：

```
#include <openssl/engine.h>
#include <openssl/hmac.h>
#include <openssl/evp.h>
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(void)
{
        unsigned char* key = (unsigned char*) "\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b";
        unsigned char* data = (unsigned char*) "\x48\x69\x20\x54\x68\x65\x72\x65";
        unsigned char* expected = (unsigned char*) "\x49\x2c\xe0\x20\xfe\x25\x34\xa5\x78\x9d\xc3\x84\x88\x06\xc7\x8f\x4f\x67\x11\x39\x7f\x08\xe7\xe7\xa1\x2c\xa5\xa4\x48\x3c\x8a\xa6";
        unsigned char* result;
        unsigned int result_len = 32;
        int i;
        HMAC_CTX ctx;

        result = (unsigned char*) malloc(sizeof(char) * result_len);

        ENGINE_load_builtin_engines();
        ENGINE_register_all_complete();

        HMAC_CTX_init(&ctx);
        HMAC_Init_ex(&ctx, key, 16, EVP_sha256(), NULL);
        HMAC_Update(&ctx, data, 8);
        HMAC_Final(&ctx, result, &result_len);
        HMAC_CTX_cleanup(&ctx);

        for (i=0; i!=result_len; i++)
        {
                if (expected[i]!=result[i])
                {
                        printf("Got %02X instead of %02X at byte %d!\n", result[i], expected[i], i);
                        break;
                }
        }
        if (i==result_len)
        {
                printf("Test ok!\n");
        }
        return 0;
} 
```

当然，它并没有回答您关于如何初始化 ENGINE 的原始问题，但是如果没有更多上下文，确实没有正确的答案，而哪个上下文与您的情况无关......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T18:25:28.313

好的，事实证明您不必使用引擎，但我完全误解了如何不使用显式引擎。我也误解了如何正确格式化测试向量。最后，我查看了 hmactest.c ，它几乎完成了我想做的所有事情，我只是不明白代码。

我试图做的最终解决方案如下所示：

```
int main() {
  unsigned char* key = (unsigned char*) "Jefe";
  unsigned char* data = (unsigned char*) "what do ya want for nothing?";
  unsigned char* expected = (unsigned char*) "5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843";
  unsigned char* result;
  unsigned int result_len = 32;
  int i;
  static char res_hexstring[32];

  result = HMAC(EVP_sha256(), key, 4, data, 28, NULL, NULL);
  for (i = 0; i < result_len; i++) {
    sprintf(&(res_hexstring[i * 2]), "%02x", result[i]);
  }

  if (strcmp((char*) res_hexstring, (char*) expected) == 0) {
    printf("Test ok, result length %d\n", result_len);
  } else {
    printf("Got %s instead of %s\n", res_hexstring, expected);
  }
} 
```

但是由于我问的是完全不同的东西，所以我不确定如何处理原始问题。建议？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T09:46:12.123

看起来好像什么都没有分配引擎，所以第一次使用`e`是 segfaulting。我想你需要先打电话`ENGINE *ENGINE_new(void)`。

（请注意，我使用过 OpenSSL，但`ENGINE`之前没有使用过这些功能。）

**更新**：我对自己的答案并不满意（之前我不得不冲去喝茶）。所以我的进一步说明是：

1.  我已经看了一下函数的（长）[手册页](http://www.manpagez.com/man/3/engine/)，但`ENGINE`我不太确定调用`ENGINE_new`是否足够。

2.  我没有注意到对`HMAC_CTX_*`函数的调用正在使用未初始化的指针，而不是指向已分配结构的指针。`HMAC_CTX_init`将尝试写入其参数指向的内存`ctx`，这将出现段错误。您需要`ctx`像这样声明和使用：

    ```
    HMAC_CTX ctx;
    HMAC_CTX_init(&ctx);
    HMAC_Init_ex(&ctx, key, 40, EVP_sha256(), e);
    ... 
    ```

    这样，您就在堆栈上分配结构，然后将指针传递给它。

3.  该`HMAC`函数根本不需要指向 a 的指针`CTX`，因此除了全局或线程本地存储之外，我不确定它与 is 的连接`CTX`是什么。我认为你可以通过调用`HMAC_Update`一次或多次来绕过它，然后`HMAC_Final`得到结果。您需要为该结果分配空间，因此以下内容适用：

    ```
    unsigned int len;
    HMAC_Final(&ctx, result, &len); 
    ```

# php - SharePoint SSO 与不同服务器上的 PHP 应用程序？

> ID：242669
> 
> 赞同：1
> 
> 时间：2008-10-28T09:36:52.670
> 
> 标签：php, sharepoint, single-sign-on

我需要在 SharePoint 站点和驻留在不同域中的基于 PHP 的自定义站点之间实现 SSO。我需要使用 SharePoint 用户帐户登录 PHP 站点。（我将完全控制 PHP 源代码）

这可能吗？有什么提示和技巧吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T15:20:46.127

我的假设是您可以完全控制您的 php 应用程序/域，但另一个团队正在管理共享点服务器。还假设您可以要求 sharepoint 团队为您的 SSO 功能创建一个简单的 Web 部件。

如果是这种情况，您可以要求 sharepoint 团队创建一个 Web 部件，其中包含指向您网站的链接。当用户单击链接时，请求将返回到共享点服务器，共享点服务器获取用户的登录名，使用您的公钥对其进行加密，并将其添加到您的 php 站点上的 url，然后将其作为重定向发送回到浏览器。所以位置看起来像这样：

[https://your.php.domain/sso.php?logon=encrypted_users_logon_name&api_key=some_token](https://your.php.domain/sso.php?logon=encrypted_users_logon_name&api_key=some_token)

您的 sso.php 脚本将验证 api_key 是来自您的 sharepoint 合作伙伴的有效令牌，然后解密尝试进入的用户的登录名。您可以更花哨，并在 sharepoint 站点上进行回调以确认登录请求在某个时间窗口内是合法的，或者将其烘焙到加密的登录名中，但这是一种简单的方法，假设您信任来自共享点合作伙伴的请求。

sharepoint .net 开发人员可能能够进行您想要的任何加密，因此请选择一种您可以在 php 和 .net 端使用的算法，并为他们提供用于加密的密钥，以及要加密的信息格式。类似 n=logon_name;expire=timestamp; 那么当你解密时，如果它是在过期时间之后，那么你拒绝登录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T11:07:50.710

我对这个领域了解不多，但希望这可能有助于为您指明正确的方向。

**调查 LDAP...**

您可以设置 PHP 以使用 LDAP 凭据。如果您的 SharePoint 站点使用 Active Directory，那么您可以将此目录公开为 LDAP 源并在 PHP 应用程序中使用它。

**自动登录...**

在每个站点之间自动登录是完全不同的事情。例如，我已经登录到 MOSS，单击指向 PHP 应用程序的链接，发现我也已经登录了那里。为此，您需要使用 Kerberos 密钥/身份验证之类的东西进行调查。这是一个混乱而困难的领域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-24T06:31:27.900

好吧，我们一直处于同样的情况，但是我们将 asp.net 与 php 结合使用进行 SSO。asp.net 代码执行 windows 身份验证，并在 mysql 数据库中创建一条记录，其中包含用户名和唯一键，并将这些值分配给 cookie。然后，将用户重定向到 PHP 应用程序。

php 应用程序读取这些 cookie 值并将它们与数据库值进行比较，以确保请求是真实的。这就是在 PHP 中进行单点登录并与 PHP 一起使用共享点的解决方法。但我仍然建议在 php 中使用 Kerb_auth_mod 进行 SSO。我们最终做到了。

# javascript - ASP.NET TreeView 控件中出现奇怪的 javascript 错误

> ID：242688
> 
> 赞同：0
> 
> 时间：2008-10-28T09:46:45.320
> 
> 标签：javascript, treeview, asp.net-2.0

我在 Web 控件中使用 Treeview Control (ASP.NET 2.0)。有趣的是，一切工作正常：展开、折叠、选择节点等，但每次点击后，萤火虫都会显示一个错误：未定义 TreeView_SelectNode [Break on this error] HelpFile.aspx (line 1)

错误来了每次我选择一个节点时。我一直在浏览 System.Web.UI.WebControls 程序集，发现有两个地方正在使用 TreeView_SelectNode。

```
if ((((this._owner.Page != null) && this._owner.Page.SupportsStyleSheets) && (this.SelectAction == TreeNodeSelectAction.Select)) || (this.SelectAction == TreeNodeSelectAction.SelectExpand))
{
  firstScript = Util.MergeScript(firstScript, "TreeView_SelectNode(" + this._owner.ClientDataObjectID + ", this,'" + this.SelectID + "');");
} 
```

和

```
if (this._owner.RenderClientScript)
{
  list.Add("onclick");
  list.Add("TreeView_SelectNode(" + this._owner.ClientDataObjectID + ", this,'" + this.SelectID + "');");
} 
```

任何人都有线索，或想法还有什么要做的，还有哪里可以看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-29T18:16:30.033

唉，我无法重现您的错误。这是我用于在 Firefox 中不引发任何 JavaScript 错误的简单示例树视图的代码。

```
 <asp:TreeView ID="TreeView1" runat="server" EnableClientScript="true">
        <Nodes>         
            <asp:TreeNode Text="Node One">
                <asp:TreeNode Text="Node One A" />
            </asp:TreeNode>
            <asp:TreeNode Text="Node Two" />
        </Nodes>
    </asp:TreeView> 
```

你能分享你用来帮助进一步调试这个问题的代码吗？

# c++ - 带有换行符的长字符串

> ID：242695
> 
> 赞同：6
> 
> 时间：2008-10-28T09:50:40.117
> 
> 标签：c++, string

我见过 C# 代码使用`@`来告诉编译器字符串中有换行符，并且应该全部在一行中。C/C++ 有类似的东西吗？

就像我想放一些类似的东西：

73167176531330624919225119674426574742355349194934 96983520312774506326239578318016984801869478851843 85861560789112949495459501737958331952853208805511 12540698747158523863050715693290963295227443043557 66896648950445244523161731856403098711121722383113 62229893423380308135336276614282806444486645238749 30358907296290491560440772390713810515859307960866 70172427121883998797908792274921901699720888093776 65727333001053367881220235421809751254540594752243 52584907711670556013604839586446706324415722155397 53697817977846174064955149290862569321978468622482 83972241375657056057490261407972968652414535100474 82166370484403199890008895243450658541227588666881 16427171479924442928230863465674813919123162824586 17866458359124566529476545682848912883142607690042 24219022671055626321111109370544217506941658960408 07198403850962455444362981230987879927244284909188 84580156166097919133875499200524063689912560717606 05886116467109405077541002256983155200055935729725 71636269561882670428252483600823257530420752963450

在一个字符串中，我不想将它全部放在一行中，而只是这样放置，让编译器知道那只是一行。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-28T09:55:04.570

在首次编写此答案时，C 和 C++ 没有像 C# 逐字字符串文字这样的东西。你能做的最接近的是：

```
"73167176531330624919225119674426574742355349194934"
"96983520312774506326239578318016984801869478851843" 
"85861560789112949495459501737958331952853208805511"  
"12540698747158523863050715693290963295227443043557" 
"66896648950445244523161731856403098711121722383113" 
"62229893423380308135336276614282806444486645238749" 
"30358907296290491560440772390713810515859307960866" 
"70172427121883998797908792274921901699720888093776" 
"65727333001053367881220235421809751254540594752243"  
"52584907711670556013604839586446706324415722155397" 
"53697817977846174064955149290862569321978468622482" 
"83972241375657056057490261407972968652414535100474" 
"82166370484403199890008895243450658541227588666881" 
"16427171479924442928230863465674813919123162824586"  
"17866458359124566529476545682848912883142607690042"
"24219022671055626321111109370544217506941658960408" 
"07198403850962455444362981230987879927244284909188" 
"84580156166097919133875499200524063689912560717606" 
"05886116467109405077541002256983155200055935729725"     
"71636269561882670428252483600823257530420752963450" 
```

但是请注意，即使在 C# 中，它也不会像你想要的那样做。如果你有：

```
string foo = @"x
y"; 
```

在 C# 中，字符串实际上将包含换行符。

在 C++11 中，根据注释，`R`前缀表示*原始字符串文字*，例如

```
string x = R"(First line
second line)"; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-28T09:56:25.643

在 C 和 C++ 中，您可以这样做：

```
const char* str = "73167176531330624919225119674426574742355349194934"
                  "96983520312774506326239578318016984801869478851843"; 
```

并且编译器会自动将它们连接成一个字符串。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-28T09:57:26.360

C 和 C++ 具有相邻引号字符串的自动连接。这意味着

```
const char *a = "a" "b"; 
```

和

```
const char *b = "ab"; 
```

将生成`a`并`b`指向相同的数据。您当然可以扩展它，但是当字符串包含引号时会变得很麻烦。你的例子似乎不是，所以它可能是实用的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-28T16:18:04.563

另一种选择是用 \ 结束一行，在看到哪个预处理器将删除以下换行符时：

```
const char *str = "Hello,\
 World!"; 
```

它不像上面所说的依赖相邻字符串文字的自动连接那么漂亮；但无论如何都应该提及。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-28T11:54:05.657

当然，你可以这样做：

```
char *x = "73167176531330624919225119674426574742355349194934\n"
          "96983520312774506326239578318016984801869478851843\n"
                     <lines removed for brevity>
          "71636269561882670428252483600823257530420752963450"; 
```

这将完全模拟 @"" 行为（包括换行符）。

如果您真的希望它作为没有换行符的一行，请不要放入“\n”换行符，但这与 C# 中 @"" 的工作方式略有不同。

# linux - 以特定速度输出标准输出

> ID：242697
> 
> 赞同：6
> 
> 时间：2008-10-28T09:51:34.170
> 
> 标签：linux, performance, limit, dd

对于我的应用程序的负载测试（在 Linux 下），我正在寻找一种以特定速率（如 100 字节/秒）在标准输出上输出数据的工具，以便我可以将输出通过管道传输到 netcat，然后将其发送到我的应用。dd 的一些选项是理想的，但到目前为止我没有找到任何东西。打印什么样的数据并不重要（NUL 字节是可以的）。有什么提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T10:30:28.990

`A`我写了一个快速程序，它接受一个参数，即每秒打印多少个字符到标准输出（负参数意味着没有速率限制）。希望这可以帮助！:-) （在 GNU libc 上，您需要将程序与 . 链接`-lrt`。）

编辑：修改为默认打印点，除非指定第二个参数，在这种情况下使用第一个字符。（这意味着，如果你想打印 NUL 字符，只需指定一个空字符串作为第二个参数。:-)）

```
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <unistd.h>

int
sleeptill(const struct timespec *when)
{
    struct timespec now, diff;

    clock_gettime(CLOCK_REALTIME, &now);
    diff.tv_sec = when->tv_sec - now.tv_sec;
    diff.tv_nsec = when->tv_nsec - now.tv_nsec;
    while (diff.tv_nsec < 0) {
        diff.tv_nsec += 1000000000;
        --diff.tv_sec;
    }
    if (diff.tv_sec < 0)
        return 0;
    return nanosleep(&diff, 0);
}

int
main(int argc, char **argv)
{
    double rate = 0.0;
    char *endp;
    struct timespec start;
    double offset;

    if (argc >= 2) {
        rate = strtod(argv[1], &endp);
        if (endp == argv[1] || *endp)
            rate = 0.0;
        else
            rate = 1 / rate;

        if (!argv[2])
            argv[2] = ".";
    }

    if (!rate) {
        fprintf(stderr, "usage: %s rate [char]\n", argv[0]);
        return 1;
    }

    clock_gettime(CLOCK_REALTIME, &start);
    offset = start.tv_nsec / 1000000000.0;

    while (1) {
        struct timespec till = start;
        double frac;
        double whole;

        frac = modf(offset += rate, &whole);
        till.tv_sec += whole;
        till.tv_nsec = frac * 1000000000.0;
        sleeptill(&till);
        write(STDOUT_FILENO, argv[2], 1);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T14:04:54.990

我认为这是您真正想要的：[Pipe Viewer](http://www.ivarch.com/programs/pv.shtml)

使用`<fast input> | pv -qL <rate>[k|m|g|t] | <rate-limited output>`会将管道限制为请求的速率。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T09:55:30.590

如果您可以一次获取所有一百个字节，那么您至少可以在 shell 中执行一个循环`sleep`并使用普通的旧`echo`版本作为第一次尝试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T10:19:05.380

好吧，我现在使用 nuttcp 来进行“真正的”负载测试。它的开销似乎很低，因此测试系统并没有受到太多干扰。

# c# - 正则表达式匹配除给定列表之外的所有单词

> ID：242698
> 
> 赞同：18
> 
> 时间：2008-10-28T09:51:47.273
> 
> 标签：c#, .net, regex

我正在尝试编写一个替换正则表达式来将所有单词括在引号中，除了单词 AND、OR 和 NOT。

我为表达式的匹配部分尝试了以下内容：

```
(?i)(?<word>[a-z0-9]+)(?<!and|not|or) 
```

和

```
(?i)(?<word>[a-z0-9]+)(?!and|not|or) 
```

但两者都不起作用。替换表达式很简单，目前包含所有单词。

```
"${word}" 
```

所以

> 这个和这个不是那个

变成

> “这个”和“这个”不是“那个”

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-28T09:59:30.287

这有点脏，但它有效：

```
(?<!\b(?:and| or|not))\b(?!(?:and|or|not)\b) 
```

在简单的英语中，这匹配任何前面没有“and”、“or”或“not”的单词边界。它只匹配整个单词，例如单词“sand”之后的位置不会因为它前面有“and”而匹配。

零宽度后视断言中“或”前面的空格是必要的，以使其成为固定长度的后视。试试这是否已经解决了您的问题。

编辑：应用于字符串“除了单词 AND、OR 和 NOT”。作为单引号的全局替换，这将返回：

```
'except' 'the' 'words' AND, OR and NOT. 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-02T10:16:46.970

约翰，

您问题中的正则表达式几乎是正确的。唯一的问题是您将前瞻放在正则表达式的末尾而不是开头。此外，您需要添加单词边界以强制正则表达式匹配整个单词。否则，它将匹配“and”中的“nd”、“or”中的“r”等，因为“nd”和“r”不在您的否定前瞻中。

> (?i)\b(?!and|not|or)(?[a-z0-9]+)\b

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-28T10:03:34.037

说我疯了，但我不喜欢与正则表达式作斗争；我将我的模式限制在我能理解的简单事物上，并经常在其余部分作弊 - 例如通过`MatchEvaluator`：

```
 string[] whitelist = new string[] { "and", "not", "or" };
    string input = "foo and bar or blop";
    string result = Regex.Replace(input, @"([a-z0-9]+)",
        delegate(Match match) {
            string word = match.Groups[1].Value;
            return Array.IndexOf(whitelist, word) >= 0
                ? word : ("\"" + word + "\"");
        }); 
```

（编辑为更简洁的布局）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-28T12:09:43.907

基于Tomalaks的回答：

```
(?<!and|or|not)\b(?!and|or|not) 
```

这个正则表达式有两个问题：

1.  `(?<! )`仅适用于固定长度的后视

2.  以前的正则表达式只查看周围单词的结尾/开头，而不是整个单词。

> `(?<!\band)(?<!\bor)(?<!\bnot)\b(?!(?:and|or|not)\b)`

这个正则表达式解决了上述两个问题。首先通过将后视分成三个独立的。其次，`\b`在环视中添加单词边界 ( )。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T18:56:02.160

```
(?!\bnot\b|\band\b|\bor\b|\b\"[^"]+\"\b)((?<=\s|\-|\(|^)[^\"\s\()]+(?=\s|\*|\)|$)) 
```

我使用这个正则表达式来查找不在双引号内的所有单词，或者是单词“not”“and”或“or”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-13T23:47:39.123

要匹配任何*由字母、数字或下划线组成的“单词”（包括在[`\w`速记字符类](https://docs.microsoft.com/en-us/dotnet/standard/base-types/character-classes-in-regular-expressions#word-character-w)中定义的任何其他单词字符）*，您可以使用**单词边界**，例如

```
\b(?!(?:word1|word2|word3)\b)\w+ 
```

如果*“单词”是一大块非空白字符，字符串开头/结尾或两端有空白，则*使用**空白边界**，如

```
(?<!\S)(?!(?:word1|word2|word3)(?!\S))\S+ 
```

在这里，这两个表达式看起来像

```
\b(?!(?:and|not|or)\b)\w+
(?<!\S)(?!(?:and|not|or)(?!\S))\S+ 
```

请参阅[regex 演示](http://regexstorm.net/tester?p=%5Cb%28%3F!%28%3F%3Aand%7Cnot%7Cor%29%5Cb%29%5Cw%2B&i=This%20and%20This%20not%20That&r=%22%24%26%22)（或流行的[regex101 演示](https://regex101.com/r/px5CwO/1)，但请注意 PCRE`\w`的含义与 .NET 的`\w`含义不同。）

**图案说明**

*   `\b`-[单词边界](https://stackoverflow.com/a/1324784/3832970)
*   `(?<!\S)`- 一个否定的lookbehind，它匹配一个不是紧跟在空格之前的字符的位置，它需要一个字符串位置的开始或一个空格字符就在当前位置之前
*   `(?!(?:word1|word2|word3)\b)`- 如果紧跟在当前位置的右侧有 `word1`,`word2`或`word3`char 序列后跟单词边界（或者，如果使用`(?!\S)`空格右侧边界，则必须有空格或结尾当前位置右侧的字符串）
*   `\w+`- 1+[字字符](https://docs.microsoft.com/en-us/dotnet/standard/base-types/character-classes-in-regular-expressions#word-character-w)
*   `\S+`- 除[空格外的 1+ 个字符](https://docs.microsoft.com/en-us/dotnet/standard/base-types/character-classes-in-regular-expressions#whitespace-character-s)

在 C# 和任何其他编程语言中，您可以通过使用管道字符连接数组/列表项来动态构建模式，[请参见下面的演示](https://ideone.com/bVgt2f)：

```
var exceptions = new[] { "and", "not", "or" };
var result = Regex.Replace("This and This not That", 
        $@"\b(?!(?:{string.Join("|", exceptions)})\b)\w+",
        "\"$&\"");
Console.WriteLine(result); // => "This" and "This" not "That" 
```

如果您的“单词”可能包含特殊字符，则空白边界方法更合适，并确保使用以下命令转义“单词” `exceptions.Select(Regex.Escape)`：

```
var pattern = $@"(?<!\S)(?!(?:{string.Join("|", exceptions.Select(Regex.Escape))})(?!\S))\S+"; 
```

**注意**：如果要搜索的单词太多，最好用它们构建一个**正则表达式树**。

# sql - 哪个 SQL 语句更快？

> ID：242701
> 
> 赞同：1
> 
> 时间：2008-10-28T09:54:35.677
> 
> 标签：sql, performance

哪个 SQL 语句更快？

```
SELECT TOP 2 c1.Price, c2.Price, ..... c49.Price, c50.Price
FROM Table1 AS c1, Table2 AS c2, ..... Table49 AS c49, Table50 AS c50
WHERE c1.Date = c2.Date AND c2.Date = c3.Date ..... c49.Date = c50.Date
ORDER BY c1.ID DESC

        OR

SELECT TOP 2 c1.Price, c2.Price, ..... c49.Price, c50.Price
FROM (Table1 AS c1 
 INNER JOIN (Table2 AS c2 
    ........
  INNER JOIN (Table49 AS c49
   INNER JOIN Table50 AS c50
  ON c49.Date = c50.Date)
    ........
 ON c2.FullDate__ = c3.FullDate__)
ON c1.FullDate__ = c2.FullDate__)
ORDER BY c1.ID DESC"; 
```

基本上我需要从每个表中提取 2 行以定期生成摘要。哪个语句更快？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-28T10:00:47.740

更快的是没有 50 个表开始。加入 50 个表可能没问题，但这是一个非常违反直觉的设计，可能不是最可维护的解决方案。

您不能将数据存储在单个（或更少）表而不是 50 个表的行（或列）中吗？？！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-28T09:56:18.793

WHERE 通常会更好，但最好的方法是**逐案**并将其放入分析器中，或者更简单但**显示执行计划**。人们通常对哪种方法在理论上最快/最好有非常强烈的意见，但是根据您实际处理的数据进行实际调整是无法替代的，因为适用的理论会根据您的数据负载而变化。

如果您的应用程序中还没有**真实数据**，请尝试创建一些真实的压力数据。这将继续对测试有用。然后在应用程序上线后安排时间进行调整。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-28T09:58:51.783

您可能会发现 SQL 优化引擎会生成相同的内部查询（如果逻辑相同），结果不会有任何差异。

正如其他人所提到的，通过分析器（例如查询分析器）运行它以确定差异（如果有的话）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T22:34:57.873

所有关于减少桌子的讨论让我思考（感谢 MarkR）。在过去的几个小时里，我一直在浏览 MySQL 文档，并意识到更好的解决方案是创建一个新的汇总表来保存初始结果。此后，我将创建一个触发器，该触发器将在始终被触及的表之一上发生插入时更新新表。

我想到的另一个想法是创建查询视图。但是，似乎 MySQL 每次调用时都会对视图运行底层查询。我对吗？有没有办法让 MySQL 存储预执行视图的结果表，然后使用触发器告诉视图何时更新表？有没有这样做的RDBMS？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T10:04:22.383

通常数据库会优化这两个语句，因此差异不会那么大。但是您可以通过比较两个查询的解释计划来验证这一点。

可以使用连接优化查询的一件事（我尚未验证这一点）是在连接语句中具有额外的约束（非连接约束）。虽然这不是推荐的样式，因为它没有明确区分连接条件和其他条件。

例如：

```
select *     
   from A a 
       join B b on b.x = a.y    
       where b.z = 'ok'; 
```

可以写成

```
select * 
   from A a 
       join B b on b.x = a.y and b.z = 'ok'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T11:08:38.773

如果您附上查询计划和 Profiler 跟踪的屏幕截图，我很乐意让您知道哪个更快。否则真的没有足够的信息来回答这个问题。

我的直觉是两者在 SQL Server 中的性能非常相似，并且 SQL Server 优化了两者以使用相同的查询计划，但谁知道呢，五十个表连接可能会让优化器有点疯狂。

我通常会坚持 JOIN 语义，因为我发现它更易于阅读和维护。交叉连接很容易出错并且极少见。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-28T12:40:09.493

谢谢你们的回答。

我无法访问查询分析器，因为我目前正在将该数据库从我正在做一个快速原型的 MS Access 移动到 MySQL。我相信查询分析器仅在 SQL Server 上可用，但我可能错了，所以我无法附加我的 Profiler 跟踪。

每个表都是不同的（即，即使列名可能相同，其中的值也是唯一的）并且单独用于生成其他对象，但我偶尔需要运行一个从每个表中收集行的摘要。所以，我相信我需要 50 张桌子，尽管我还没有充实整个计划，因此会研究它。（ps 我是数据库和 SQL 的新手，但对编程并不陌生）。我还需要考虑对内存大小的影响，如果我要将所有信息放入一个表中，而一次只使用其中的一小部分。

但是，从我收集到的信息来看，区别应该不是那么大，因为这 2 个语句可能会被编译为相同的内部查询。我问了一个问题，想知道内部结构是否会有所不同。将对实际数据进行测试以找出答案。

顺便说一句，如果我们考虑到多个用户的并发查询等式，那么 2 个语句的性能会很重要吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-28T13:06:04.637

您没有指定表的预期数量，但请注意，如果查询确实针对不同的查询计划进行了优化，那么表中 100 行的最快速度可能与 100,000 行或更多行的速度不同。

事实上，只要您有合理合理地设计索引和查询，对使用少于 10,000 条记录的表的查询进行痴迷优化通常不会有什么好处。但是，在大约 100,000 条记录中，优化不佳的查询的性能将开始下降，通常是灾难性的。确切的数字取决于服务器中的行大小和内存量，但是对于表大小翻倍，性能下降一个数量级或更多的情况并不罕见。

一般来说，最好的策略是不要花时间在较小的表上进行次要查询，通常可以将精力花在其他地方更有利可图。但是，如果预计这些查询将增长超过 10,000 行，则积极优化针对您的主表运行的任何查询。通常，这意味着使用 QA 实例并加载 10 倍于预期的体积来检查实际行为。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-28T22:41:38.873

优化连接顺序需要指数级的时间。每个数据库引擎只是简单地挑选少量可能的连接顺序，然后估计其中最好的一个。

似乎你总是想`join ... on c*1*.Date = c*n*.Date`为所有`n`。

您还希望摆脱您拥有的极其奇怪的数据库模式。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-28T23:08:05.310

当你尝试时发生了什么？

我的意思是说，查询分析器有一个小计时器是有原因的。不同的查询结构有时会给出完全不同的执行时间，而这背后往往没有直观的原因。

编写两个查询。测试它们。然后回来回答你自己的问题。

* * *

## 回答 #11

> 赞同：-8
> 
> 时间：2008-10-28T09:58:23.313

尽可能忽略 JOIN。在性能方面，Join 语句根本没有效率。

# algorithm - 三角矩阵系数的索引号算法

> ID：242711
> 
> 赞同：26
> 
> 时间：2008-10-28T09:58:14.907
> 
> 标签：algorithm

我认为这一定很简单，但我无法正确...

我有一个 MxM 三角矩阵，其系数逐行存储在一个向量中。例如：

```
M =   [ m00 m01 m02 m03 ] 
      [     m11 m12 m13 ]
      [         m22 m23 ]
      [             m33 ] 
```

存储为

```
coef[ m00 m01 m02 m03 m11 m12 m13 m22 m23 m33 ] 
```

现在我正在寻找一种非递归算法，它可以为我提供矩阵大小`M`和系数数组索引`i`

```
unsigned int row_index(i,M) 
```

和

```
unsigned int column_index(i,M) 
```

它所指的矩阵元素。因此， 如果索引计数是从零开始的`row_index(9,4) == 3`，等等。`column_index(7,4) == 2`

编辑：已经给出了几个使用迭代的答复。有人知道代数表达式吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-28T19:34:55.880

此回复末尾的单行字，解释如下:-)

系数数组具有：第一行（第 0 行，在您的索引中）的 M 个元素，第二行（第 1 行）的 (M-1)，依此类推，总共 M+(M-1)+…+ 1=M(M+1)/2 个元素。

从最后开始工作会稍微容易一些，因为系数数组的最后一行（M-1 行）*总是*有 1 个元素，倒数第二行（M-2 行）有 2 个元素，M-3 行有 3 个元素， 等等。最后 K 行占据了系数数组的最后 K(K+1)/2 个位置。

现在假设在系数数组中给定一个索引 i。在大于 i 的位置有 M(M+1)/2-1-i 个元素。拨打这个号码 i'; **你想找到最大的 k 使得 k(k+1)/2 ≤ i'**。这个问题的形式是你痛苦的根源——据我所知，你无法避免取平方根:-)

不管怎样，让我们​​这样做：k(k+1) ≤ 2i' 意味着 (k+1/2) ² - 1/4 ≤ 2i'，或者等效地 k ≤ (sqrt(8i'+1)-1)/2。让我把最大的 k 称为 K，那么后面有 K 行（总共 M 行），所以 row_index(i,M) 是 M-1-K。至于列索引，i'中的K(K+1)/2个元素在后面的行中，所以这行后面的元素有j'=i'-K(K+1)/2个（有总共K+1个元素），所以列索引是Kj'。[或者等价地，这一行从末尾开始是(K+1)(K+2)/2，所以我们只需要从i中减去这一行的起始位置：i-[M(M+1)/2 -(K+1)(K+2)/2]。令人振奋的是，两种表达方式都给出了相同的答案！]

（伪）代码[使用 ii 而不是 i'，因为某些语言不允许名称像 i' ;-)] 的变量：

```
row_index(i, M):
    ii = M(M+1)/2-1-i
    K = floor((sqrt(8ii+1)-1)/2)
    return M-1-K

column_index(i, M):
    ii = M(M+1)/2-1-i
    K = floor((sqrt(8ii+1)-1)/2)
    return i - M(M+1)/2 + (K+1)(K+2)/2 
```

当然，您可以通过将表达式替换 ii 和 K 将它们变成单行。您可能必须小心精度误差，但有一些方法可以找到整数平方根，而无需浮点计算。另外，引用 Knuth 的话：“当心上述代码中的错误；我只是证明它是正确的，没有尝试过。”

如果我可以冒昧地做进一步的评论：简单地将所有值保存在 M×M 数组中最多会占用两倍的内存，并且根据您的问题，与算法改进相比，2 的因子可能微不足道，并且可能是值得用可能昂贵的平方根计算来换取更简单的表达式。

[编辑：顺便说一句，您可以证明 floor((sqrt(8ii+1)-1)/2) = (isqrt(8ii+1)-1)/2 其中 isqrt(x)=floor(sqrt(x))是整数平方根，除法是整数除法（截断；C/C++/Java 等中的默认值）——所以如果你担心精度问题，你只需要担心实现正确的整数平方根。]

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-28T13:38:03.183

这是一个代数（主要）解决方案：

```
unsigned int row_index( unsigned int i, unsigned int M ){
    double m = M;
    double row = (-2*m - 1 + sqrt( (4*m*(m+1) - 8*(double)i - 7) )) / -2;
    if( row == (double)(int) row ) row -= 1;
    return (unsigned int) row;
}

unsigned int column_index( unsigned int i, unsigned int M ){
    unsigned int row = row_index( i, M);
    return  i - M * row + row*(row+1) / 2;
} 
```

编辑：固定 row_index()

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-01-23T18:36:07.547

ShreevatsaR 的解释非常好，帮助我解决了我的问题。但是，为列索引提供的解释和代码给出的答案与问题要求的答案略有不同。

重申一下，在 i 之后的行中有 j' = i' - K(K+1)/2 个元素。但是该行与其他行一样，有 M 个元素。因此（从零开始的）列索引是 y = M - 1 - j'。

对应的伪代码为：

```
column_index(i, M):
  ii = M(M+1)/2-1-i
  K = floor((sqrt(8ii+1)-1)/2)
  jj = ii - K(K+1)/2
  return M-1-jj 
```

ShreevatsaR 给出的答案，K - j'，是从矩阵的对角线开始计数（为零）时的列索引。因此，他的计算得出 column_index(7,4) = 0，而不是问题中指定的 column_index(7,4) = 2。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-28T11:09:52.327

必须是这样

```
i == col + row*(M-1)-row*(row-1)/2 
```

所以找到 col 和 row 的一种方法是遍历可能的行值：

```
for(row = 0; row < M; row++){
  col = i - row*(M-1)-row*(row-1)/2
  if (row <= col < M) return (row,column);
} 
```

这至少是非递归的，我不知道你是否可以在没有迭代的情况下做到这一点。

从这个答案和其他答案中可以看出，您几乎必须计算行才能计算列，因此在一个函数中同时完成这两项工作可能是明智的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-28T11:11:18.533

这些可能有一个聪明的衬线，但是（减去任何错误检查）：

```
unsigned int row_index( unsigned int i, unsigned int M ){
    unsigned int row = 0;
    unsigned int delta = M - 1;
    for( unsigned int x = delta; x < i; x += delta-- ){
        row++;
    }
    return row;
}

unsigned int column_index( unsigned int i, unsigned int M ){
    unsigned int row = 0;
    unsigned int delta = M - 1;
    unsigned int x;
    for( x = delta; x < i; x += delta-- ){
        row++;
    }
    return M + i - x - 1;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-30T10:41:09.453

我想了一下，得到了以下结果。请注意，您可以在一次拍摄中同时获得行和列。

假设：行从 0 开始。列从 0 开始。索引从 0 开始

符号

N = 矩阵大小（在原始问题中是 M）

m = 元素的索引

伪代码是

```
function ind2subTriu(m,N)
{
  d = 0;
  i = -1;
  while d < m
  {
    i = i + 1
    d = i*(N-1) - i*(i-1)/2
  }
  i0 = i-1;
  j0 = m - i0*(N-1) + i0*(i0-1)/2 + i0 + 1;
  return i0,j0
} 
```

还有一些 octave/matlab 代码

```
function [i0 j0]= ind2subTriu(m,N)
 I = 0:N-2;
 d = I*(N-1)-I.*(I-1)/2;
 i0 = I(find (d < m,1,'last'));
 j0 = m - d(i0+1) + i0 + 1; 
```

你怎么看？

到 2011 年 12 月，非常好的代码被添加到 GNU/Octave 中。他们可能会扩展 sub2ind 和 ind2sub。该代码暂时可以作为私有函数[ind2sub_tril](http://octave.svn.sf.net/viewvc/octave/trunk/octave-forge/main/mechanics/inst/core/private/sub2ind_tril.m?view=log)和[sub2ind_tril 找到](http://octave.svn.sf.net/viewvc/octave/trunk/octave-forge/main/mechanics/inst/core/private/ind2sub_tril.m?view=log)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-28T11:09:32.220

我花了一些时间来了解您需要什么！:)

```
unsigned int row_index(int i, int m)
{
    int iCurrentRow = 0;
    int iTotalItems = 0;
    for(int j = m; j > 0; j--)
    {
        iTotalItems += j;

        if( (i+1) <= iTotalItems)
            return iCurrentRow;

        iCurrentRow ++;
    }

    return -1; // Not checking if "i" can be in a MxM matrix.
} 
```

抱歉忘记了其他功能.....

```
unsigned int column_index(int i, int m)
{
    int iTotalItems = 0;
    for(int j = m; j > 0; j--)
    {
        iTotalItems += j;

        if( (i+1) <= iTotalItems)
            return m - (iTotalItems - i);
    }

    return -1; // Not checking if "i" can be in a MxM matrix.
} 
```

# email - 实施通知电子邮件

> ID：242713
> 
> 赞同：4
> 
> 时间：2008-10-28T09:58:49.070
> 
> 标签：email, spam

我的客户想为客户发送电子邮件公告和报告。现在。python 端的代码似乎并不难，但故事的其余部分。

为了发送不会被电子邮件服务器和客户端阻止的此类电子邮件，我需要什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T10:11:42.353

您的程序与 sendmail 服务器建立 SMTP 连接。如果您拥有该服务器，则您可以控制它的配置。出门什么都不会堵。

然而，垃圾邮件就是垃圾邮件。您的客户可能认为他们的电子邮件是黄金，但他们的客户可能认为这是垃圾邮件。那好吧。

首先，您必须让您的电子邮件活动“选择加入”。如果客户想要电子邮件通知，他们会要求。如果他们不请求，他们就不会收到电子邮件。

其次，您必须记录从提供的电子邮件地址收到的退回邮件。硬弹回以各种形式返回“没有这样的地址”类型的回复。软退回是“我们仍在尝试或邮箱已满”。您必须判断如何处理反弹。

这是你能做的最好的事情。你不能让人们认识到你客户的电子邮件真的很重要，但其他垃圾邮件只是垃圾邮件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T10:09:52.340

没有确切的方法，因为电子邮件过滤器可以随心所欲，但有一些建议：

*   使用真正的 SMTP 服务器，通常是您客户的（如果需要，进行身份验证）。真正的我的意思是一个真正使用的，而不是一个只发送电子邮件的特殊的。
*   从能够接收响应的真实帐户发送。
*   如果可能，请避免使用 HTML，如果不可能，请发送[多部分消息](http://www.python.org/doc/2.5.2/lib/module-email.mime.text.html)。
*   发送所有强制标头以及一些通常由常见 MUA 发送的标头。

通常，检查常见的垃圾邮件[检测规则](http://www.rulesemporium.com/rules.htm)以了解垃圾邮件的共同点。

# c# - 如何将字符串拆分为多个值？

> ID：242718
> 
> 赞同：3
> 
> 时间：2008-10-28T10:00:32.453
> 
> 标签：c#, asp.net, visual-studio, string, listbox

你如何分割一个字符串？

假设我有一个字符串“狗，猫，老鼠，鸟”

我的实际目标是将这些动物中的每一个插入到列表框中，这样它们就会成为列表框中的项目。

但我想如果我知道如何拆分字符串，我就会知道如何插入这些项目。或者有人知道更好的方法吗？

我使用asp c#

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-28T10:02:02.963

```
 string[] tokens = text.Split(',');

    for (int i = 0; i < tokens.Length; i++)
    {
          yourListBox.Add(new ListItem(token[i], token[i]));
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T10:03:28.437

你试过[String.Split](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)吗？如果您希望 "a, b, c" 以 {"a", "b", "c"} 结尾但 "ab, c" 以 {"a b “， “C”}。

例如：

```
private readonly char[] Delimiters = new char[]{','};

private static string[] SplitAndTrim(string input)
{
    string[] tokens = input.Split(Delimiters,
                                  StringSplitOptions.RemoveEmptyEntries);

    // Remove leading and trailing whitespace
    for (int i=0; i < tokens.Length; i++)
    {
        tokens[i] = tokens[i].Trim();
    }
    return tokens;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-28T11:51:57.767

不需要的 Linq 版本；

```
from s in str.Split(',')
where !String.IsNullOrEmpty(s.Trim())
select s.Trim(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-28T10:16:20.813

或者简单地说：

```
targetListBox.Items.AddRange(inputString.Split(',')); 
```

或者这样做以确保修剪字符串：

```
targetListBox.Items.AddRange((from each in inputString.Split(',')
    select each.Trim()).ToArray<string>()); 
```

哎呀！正如评论指出的那样，错过了它是 ASP.NET，所以不能从字符串数组初始化 - 需要这样做：

```
var items = (from each in inputString.Split(',')
    select each.Trim()).ToArray<string>();

foreach (var currentItem in items)
{
    targetListBox.Items.Add(new ListItem(currentItem));
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T10:02:54.227

它通过 strVar.Split 为您提供一个字符串数组

```
"dog, cat, mouse,bird".Split(new[] { ',' }); 
```

# c++ - 轻量级 C++ 编码标准中最关键的元素

> ID：242728
> 
> 赞同：31
> 
> 时间：2008-10-28T10:03:22.790
> 
> 标签：c++, coding-style

我一直参与开发非常复杂的编码标准。我自己的经验是，如果您没有适当的流程来维护它和维护它的策略，就很难执行。

现在我在一个环境中工作并领导，在相当长的一段时间内更不可能有流程和后续策略。我仍然想坚持一些最低限度的可敬代码。所以我想我会在这里得到很好的建议，我们可能会一起为最重要的编码标准实践生成一个合理的轻量级子集，供其他人用作参考。

所以，在这里强调本质：

## **C++ 编码标准的哪些元素是最需要维护的？**

*   ## 回答/投票规则

    *   每个答案 1 名候选人，最好有**简短**的动机。

    *   **否决**关注风格和主观格式指南的候选人。这并不是说它们不重要，只是表明它们在这种情况下不太相关。

    *   **否决**候选人，重点关注如何评论/记录代码。这是一个更大的主题，甚至可能值得拥有自己的职位。

    *   **投票**选出明显有助于更安全代码的候选人，从而最大限度地减少神秘错误的风险，从而提高可维护性等。

    *   **不要对你不确定的候选人**投票。**即使它们听起来合理和聪明，或者相反“肯定没人会使用的东西”，你的投票也应该基于清晰的理解和经验。**

 *** * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-10-28T10:58:49.590

更喜欢[RAII](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)。

STL 的自动（并在 boost 和 C++0x 中共享）指针可能会有所帮助。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-10-28T12:49:35.043

默认使用`const`标识符。它们为读者/维护者提供保证，并且比之后插入更容易构建。

成员变量和方法`const`以及函数参数都将被声明。 `const`成员变量强制正确使用初始化列表。

此规则的副作用：避免使用具有副作用的方法。

- - - 编辑

`const`成员*变量*似乎是个好主意；情况并非总是如此：它们有效地使*任何*对象不可变。这对于例如对向量进行排序变得有问题。

```
struct A {
    const int i;
};

bool operator<(const A& lhs, const A& rhs) {
    return lhs.i < rhs.i;
}

int main() {
    std::vector<A> as;
    as.emplace_back(A{1});
    std::sort(begin(as), end(as));
} 
```

错误信息：

```
... note: copy assignment operator of 'A' is implicitly deleted because
field 'i' is of const-qualified type 'const int'
...
in instantiation of function template specialization 'std::sort<...>'
requested here

    std::sort(begin(as), end(as)); 
```

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2008-10-28T13:09:16.363

## 使用 C++ 强制转换而不是 C 强制转换

利用：

*   `static_cast`
*   `const_cast`
*   `reinterpret_cast`
*   `dynamic_cast`

但绝不是 C 风格的演员表。

**它如何清楚地促进更安全的代码，从而最大限度地减少神秘错误的风险，从而提高可维护性等。**

每个演员都有有限的权力。例如，如果您想删除一个 const（无论出于何种原因），`const_cast`不会同时更改类型（这可能是一个很难找到的错误）。

此外，这使审阅者能够搜索它们，然后编码人员在需要时对其进行证明。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2008-10-28T11:00:51.987

尽可能使用引用而不是指针。这可以防止持续的防御性 NULL 检查。

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2008-10-28T10:43:59.837

确保您的编译器的警告级别设置得足够高（最好是 /Wall），以便它能够捕捉到以下愚蠢的错误：

```
if (p = 0) 
```

当你真正的意思是

```
if (p == 0) 
```

这样您就无需诉诸更愚蠢的技巧，例如：

```
if (0 == p) 
```

这会降低代码的可读性。

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2008-10-28T13:16:39.453

## 使用向量和字符串而不是 C 样式的数组和 char *

每当您需要创建数据缓冲区时，请使用**std::vector**，即使大小是固定的。

每当您需要一个字符串时，请使用**std:: string。**

**它如何清楚地促进更安全的代码，从而最大限度地减少神秘错误的风险，提高可维护性等？**

**std::vector：向量**的用户总是可以找到它的大小，并且可以根据需要调整向量的大小。它甚至可以（通过 (&(myVector[0])) 符号）提供给 C API。当然，向量会自行清理。

**std::string：**几乎与上面相同的原因。事实上它总是会被正确初始化，它不能被溢出，它会优雅地处理修改，如连接、分配等，并且以一种自然的方式（使用运算符而不是函数）

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2008-10-28T10:35:18.077

将函数保持在合理的大小。就个人而言，我喜欢将函数保持在 25 行以下。当您可以将一个功能作为一个单元纳入时，可读性会得到增强，而不必上下扫描试图弄清楚它是如何工作的。如果您必须滚动阅读它，事情就会变得更糟。

* * *

## 回答 #8

> 赞同：31
> 
> 时间：2008-10-28T10:45:20.083

[断言](http://en.wikipedia.org/wiki/Assert#Usage)所有假设，包括临时假设，例如未实现的行为。如果不平凡，则断言函数进入和退出条件。断言所有非平凡的中间状态。如果没有断言首先失败，您的程序永远不会崩溃。您可以自定义您的断言机制以忽略未来发生的情况。

> 对您期望发生的情况使用错误处理代码；对不应该发生的情况使用断言。错误处理通常检查错误的输入数据；断言检查代码中的错误。
> 
> 如果错误处理代码用于处理异常情况，错误处理将使程序能够优雅地响应错误。如果针对异常情况触发断言，纠正措施不仅仅是优雅地处理错误——纠正措施是更改程序的源代码、重新编译并发布新版本的软件。将断言视为可执行文档的一个好方法是——您不能依赖它们来使代码工作，但它们可以比程序语言注释更积极地记录假设 [1]。

1.  麦康奈尔，史蒂夫。代码完成，第二版。Microsoft Press © 2004。第 8 章 - 防御性编程

* * *

## 回答 #9

> 赞同：29
> 
> 时间：2008-10-28T13:35:53.530

## 知道谁是*该*内存的所有者。

*   尽可能在栈上创建对象（没有无用的new）
*   除非确实需要，否则避免转让所有权
*   使用 RAII 和智能指针
*   如果强制转让所有权（没有智能指针），那么，清楚地记录代码（函数应该有一个明确的名称，始终使用相同的名称模式，如“char * allocateMyString()”和“void deallocateMyString(char * p)"。

**它如何清楚地促进更安全的代码，从而最大限度地减少神秘错误的风险，提高可维护性等？**

没有明确的内存所有权理念会导致有趣的错误或内存泄漏，并且浪费时间想知道该函数返回的 char * 是否应该由用户释放，或者返回给特殊的释放函数等。

尽可能分配内存的函数/对象必须是释放它的函数/对象。

* * *

## 回答 #10

> 赞同：27
> 
> 时间：2008-10-28T13:15:04.667

旁注：不要强加SESE（*Single Entry Single Exit*）（即禁止多于一个`return`，使用`break`// `continue`...）

在 C++ 中，这是一个乌托邦，`throw`也是另一个返回点。SESE 在 C 语言和无异常语言中具有两个优势：

*   现在由 C++ 中的 RAII 习语巧妙地处理资源的确定性释放，
*   使功能更易于维护，这不应该是一个问题，因为功能**必须**保持简短（如“一个功能，一个责任”的规则所指定）

* * *

## 回答 #11

> 赞同：26
> 
> 时间：2008-10-28T13:30:30.173

## 过早的优化是万恶之源

首先编写安全正确的代码。

然后，如果您有性能问题，并且如果您的分析器告诉您代码很慢，您可以尝试对其进行优化。

永远不要相信你会比编译器更好地优化代码片段。

在寻找优化时，请研究使用的算法以及可能更好的替代方案。

**它如何清楚地促进更安全的代码，从而最大限度地减少神秘错误的风险，提高可维护性等？**

通常，“优化”（或所谓的优化）代码不太清晰，并且倾向于通过原始的、接近机器的方式来表达自己，而不是更面向业务的方式。一些优化依赖于开关、if 等，然后由于多条代码路径将更难测试。

当然，分析之前的优化通常会导致零性能增益。

* * *

## 回答 #12

> 赞同：23
> 
> 时间：2008-10-28T10:48:39.267

任何控制语句的花括号。（感谢自己的经验，并通过阅读 Code Complete v2 得到加强）：

```
// bad example - what the writer wrote
if( i < 0 ) 
    printf( "%d\n", i );
    ++i; // this error is _very_ easy to overlook!  

// good example - what the writer meant
if( i < 0 ) {
    printf( "%d\n", i );
    ++i;
} 
```

* * *

## 回答 #13

> 赞同：15
> 
> 时间：2008-10-28T19:18:53.277

首选符合标准的代码。更喜欢使用标准库。

* * *

## 回答 #14

> 赞同：12
> 
> 时间：2008-10-28T10:36:48.573

只是琐碎的使用？: 运算符，即

```
float x = (y > 3) ? 1.0f : -1.0f; 
```

可以，但这不是：

```
float x = foo(2 * ((y > 3) ? a : b) - 1); 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2008-10-28T12:17:32.753

使用 lint 工具 - 即 PC-Lint。这将捕获许多“结构性”编码指南问题。意思是阅读实际错误而不是样式/可读性问题的东西。（并不是说可读性不重要，但不如实际错误那么重要）。

示例，而不是要求这种风格：

```
if (5 == variable) 
```

作为防止“意外分配”错误的一种方法，让 lint 找到它。

* * *

## 回答 #16

> 赞同：9
> 
> 时间：2008-10-28T13:19:36.403

## 永远不要使用没有适当构造函数的结构

结构是合法的 C++ 结构，用于将数据聚合在一起。尽管如此，数据仍应始终正确初始化。

所有 C++ 结构都应该至少有一个默认构造函数，它将其聚合数据设置为默认值。

```
struct MyStruct // BAD
{
   int i ; bool j ; char * k ;
}

struct MyStruct // GOOD
{
   MyStruct() : i(0), j(true), k(NULL) : {}

   int i ; bool j ; char * k ;
} 
```

如果它们通常以某种方式初始化，请提供一个构造函数以使用户能够避免 C 风格的结构初始化：

```
MyStruct oMyStruct = { 25, true, "Hello" } ; // BAD
MyStruct oMyStruct(25, true, "Hello") ;      // GOOD 
```

**它如何清楚地促进更安全的代码，从而最大限度地减少神秘错误的风险，提高可维护性等？**

没有适当构造函数的结构使该结构的用户承担初始化它的任务。因此，以下代码将从函数复制粘贴到函数：

```
void doSomething()
{
   MyStruct s = { 25, true, "Hello" } ;
  // Etc.
}

void doSomethingElse()
{
   MyStruct s = { 25, true, "Hello" } ;
  // Etc.
}

// Etc. 
```

这意味着，在 C++ 中，如果您需要在 struct 中添加一个字段，或者更改内部数据的顺序，您必须通过所有这些初始化来验证每个是否仍然正确。使用适当的构造函数，修改结构的内部与它的使用是分离的。

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2008-10-28T13:26:52.770

不要将类型或函数添加到全局命名空间。

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2008-10-28T14:40:58.750

**[最小意外原则](http://en.wikipedia.org/wiki/Principle_of_least_astonishment)**。

也许这不是您正在寻找的规则的“味道”，但我肯定会把它放在第一位。

它不仅是对格式和注释指南等所有无聊内容的根本、原因和完整性检查，而且——对我来说更重要的是——将重点放在阅读和理解的代码上，而不仅仅是编译。

它还涵盖了我遇到过的唯一合理的代码质量衡量标准[——WTF's per minute](http://www.osnews.com/story/19266/WTFs_m)。

我会用第一点来强调清晰、一致的代码的重要性和价值，并激励编码标准中的以下项目。

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2008-10-28T13:08:33.853

Forbid`t[i]=i++;` `f(i++,i);`等，因为对于首先执行的内容没有（便携式）保证。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2008-11-05T21:12:13.400

总是，总是，总是对对象构造进行适当的数据成员初始化。

我遇到了一个问题，其中对象构造函数依赖于其数据成员的一些“默认”初始化。在两个平台（Windows/Linux）下构建代码给出了不同的结果和一个难以发现的内存错误。结果是数据成员没有在构造函数中初始化，而是在初始化之前使用。在一个平台（Linux）上，编译器将其初始化为代码编写者认为合适的默认值。在 Windows 上，该值被初始化为一些东西——但是垃圾。在使用数据成员时，一切都变得混乱。一旦初始化被修复 - 没有更多的问题。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2008-10-28T10:06:51.677

如果正在使用（或计划使用）的工具链对*异常*的实现效率低下，那么避免使用它们可能是明智之举。我曾在这样的条件下工作过。

更新：[这](http://www.caravan.net/ec2plus/rationale.html)是其他人对“嵌入式 C++”的基本原理，它似乎排除了异常。它提出以下几点：

*   很难估计从发生异常到将控制权传递给相应的异常处理程序之间的时间。
*   很难估计异常处理的内存消耗。

该页面上有更详细的文字，我不想全部复制。另外，它已经有 10 年历史了，所以它可能不再有用了，这就是为什么我包括关于工具链的部分。也许这也应该读作“如果内存不被认为是一个主要问题”和/或“如果不需要可预测的实时响应”等等。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2008-10-28T10:14:18.993

通用命名方案中的方法和变量名称以保持一致性；在阅读源代码时，我不会被其他任何事情打扰。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2008-10-28T13:25:40.977

公共继承必须模仿 Liskov 替换原则 (LSP)。

当非常强的耦合有意义时，必须使用私有继承来实现没有可替换性的代码重用/导入，否则必须使用聚合来实现。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2008-10-28T13:28:01.923

## 小心 C API

C API 可以非常高效，但需要暴露的原始数据（即指针等），这无助于代码的安全性。请改用现有的 C++ API，或使用 C++ 代码封装 C API。

例如：

```
// char * d, * s ;
strcpy(d, s) ; // BAD

// std::string d, s ;
d = s ;        // GOOD 
```

## 从不使用 strtok

strtok 不可重入。这意味着如果一个 strtok 启动而另一个 strtok 没有结束，一个将破坏另一个的“内部数据”。

**它如何清楚地促进更安全的代码，从而最大限度地减少神秘错误的风险，提高可维护性等？**

使用 C API 意味着使用原始类型，当 sprintf 走得太远（或使用 snprintf 时的字符串裁剪，这是一种数据损坏）时，可能会导致有趣的错误，例如缓冲区溢出（和潜在的堆栈损坏）。即使在处理原始数据时，malloc 也很容易被滥用，如以下代码所示：

```
int * i = (int *) malloc(25) ; // Now, I BELIEVE I have an array of 25 ints!
int * j = new int[25] ;        // Now, I KNOW I have an array of 25 ints! 
```

等等等等。

至于 strtok：C 和 C++ 是支持堆栈的语言，这使用户无需关心堆栈上自己的哪些函数，以及堆栈上自己的下面会调用哪些函数。strtok 消除了这种“不关心”的自由

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2009-08-11T18:15:10.847

默认情况下避免使用生成的复制构造函数和 operator=。

*   如果您希望您的对象是可复制的。
    *   如果可以轻松复制每个属性，请清楚地注释您正在使用隐式复制构造函数和 operator= 故意。
    *   否则，编写自己的构造函数，使用初始化字段来初始化属性并遵循标题顺序（这是真正的构造顺序）。
*   如果仍然不知道（*默认选项*）或者您认为您不想复制某个类的对象，请将其复制构造函数和 operator= 声明为私有。这样编译器会在你做你不想做的事情时让你知道。

```
    类 foo
    {
       //...
    私人的：
       foo( 常量 foo& );
       const foo& 运算符=( const foo& );
    };

```

或者，如果您使用的是 boost，则以[更简洁的方式：](http://www.boost.org/doc/libs/1_39_0/libs/utility/utility.htm#Class_noncopyable)

```
    类 foo : 私有 boost::noncopyable
    {
      ...
    };

```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2008-10-28T12:47:56.077

无论指南如何，都可以很**容易**地识别适用性：您拥有的选择越少，您选择的时间就越少。并且大脑解析代码变得越容易。

“难以识别”的示例：

*   如果条件主体中只有一行，则没有大括号
*   对命名空间使用 K&R 大括号放置，但将大括号放在函数定义代码中的条件下方
*   ...

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2010-08-09T06:53:23.653

通过 const 引用传递输入参数，并通过指针传递输出或输入输出参数。这是从 Google 样式指南中借用的规则。

我曾经对指针有绝对的反感，并且更喜欢尽可能使用引用（正如该线程中的一位海报所建议的那样）。但是，采用这种 output-arg-as-pointer 约定使我的函数更具可读性。例如，

```
SolveLinearSystem(left_hand_side, right_hand_side, &params); 
```

清楚地表明正在写入“参数”。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2008-10-28T13:19:38.197

应该专门用一点来解释值语义和实体语义之间的区别。它可以提供有关如何处理各种情况的典型代码片段。

另请参阅[在 C++ 中编写复制构造函数和赋值运算符的清单](https://stackoverflow.com/questions/214891/checklist-for-writing-copy-constuctor-and-assignment-operator-in-c#214966)

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2008-12-17T11:10:02.923

可能很简单，但仍然是一个重要的规则：

避免未定义的行为。

在 C++ 中有很多这样的东西，并且可能无法编写一个不依赖于它的非平凡应用程序，但一般规则仍然应该是“未定义的行为是不好的”。（因为可悲的是，有些 C++ 程序员觉得“它在我的机器/编译器上工作”就足够了）。

如果您必须依赖它，请向每个人说明是什么、为什么、在哪里以及如何。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2009-08-18T22:14:40.620

计算机编程艺术大部头{1,2,3}

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2008-10-28T10:35:04.643

如果您有多个缩进步骤，则需要大括号：

```
if (bla) {
  for (int i = 0; i < n; ++i)
    foo();
} 
```

这有助于使缩进与编译器如何看待代码保持一致。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2008-10-29T18:10:11.433

我认为编码标准文档不是解决这个问题的方法。解决方案是激励您的劳动力学习/关心编码的人性化方面 - “首先为人编码，最后为计算机编码”。

显然，不可能只解雇那些不在乎的人——但标准文件也不会对他们有太大帮助。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2008-10-29T18:23:13.247

我建议只要求开发人员阅读大量指南，以及 Meyers 的有效 C++ 和更有效的 C++ 书籍。

如果你想要轻量级，你将不得不依靠常识和共同的理想。

代码审查也有助于执行这一点。

为了保持轻量级，我会避免使用文档和代码警察。公开赞美好的代码。

编辑 - 我从这里开始评论，但为了便于查看，会将其放在回复中：

正确完成的评论会产生奇迹 - 但您不能允许在评论中报告层次结构，并且评论结果中不能包含人员姓名的统计信息。

确保文档保持小，并确保给出“规则”/指南的原因。没有那个，那么你只是要求盲目服从。有了基本原理和理由，您就可以进行教育，以便不需要实际发布/编写“规则”。（因为这个概念将被内化）

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2011-04-08T16:25:14.667

根据“C++ 编码标准”（Sutter/Alexandrescu）建立你的编码风格，并且只记录你偏离它的地方。我不能认真对待任何没有的“C++ 编码标准”。

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2011-08-17T07:16:01.240

**规则 0 应始终为：**

## **记录与本标准的任何偏差**

有些问题可能需要不遵守特定标准。

这些案例**必须**记录在案并证明其合理性，因为它们表明与代码库中的预期习语有偏差。

不记录它们可能会导致错误，因为：

1.  未来的维护者可能会在不了解代码不合规的情况下使代码合规。

2.  未来的开发人员可能期望代码符合要求，因此对其含义做出不正确的假设。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-12-17T11:35:13.793

确保将析构函数定义为***virtual***：

```
 class GoodClass {
 public:
   GoodClass();
   virtual ~GoodClass()
 };

 class BadClass {
 public:
   BadClass();
   ~BadClass()
 }; 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2008-10-28T13:31:06.817

最好的标准是那些小而专注于编写高质量代码的真正重要的标准。他们不尝试教授编码，也不尝试强制使用特定的编码方式。他们通常坚持一致性功能和主观评论（例如，如果您团队的其他成员认为一段代码可读、符合一致性规则并被评论，那么它总是会是好的代码）

所以再次强调：一致性——命名约定、空白管理、注释块、目录结构。没有其他事情*真正*重要

为达斯汀编辑：标准的大问题伴随着例外。如果您的标准是“每行 1 条语句”，则您不能编写以下虚构示例：

```
SetColText(1,"col1"); SetColWidth(1, 10);
SetColText(2,"col1"); SetColWidth(2, 10);
...
SetColText(9,"col1"); SetColWidth(9, 10); 
```

但我会说这更具可读性，因此将它们分开更不容易出错。（我相信你能想出更好的例子）。

这就是我的观点——告诉人们如何编写代码，以及如何将其格式化为严格的规则，总是会以你没有预料到的方式和地方失败。因此，在执行了一些规则之后，相信您的编码人员会立即执行此操作要好得多。如果他们有一些规则要遵循，他们会编写好的、有纪律的代码，这样你就不需要其余的蹩脚规则了。

您会看到一些适用于页面和页面的标准。（飞利浦 C# 有 48 页长！）

那么，鉴于您拥有一支高素质的编码人员团队，您需要做些什么才能更轻松地使用他们的代码？答案始终是他们将代码放在“哪里”的一致性，而不是他们如何编写代码。例如。你总是有一个 bin，你的项目中的 obj 目录是一个很好的标准。您可以选择任何项目并知道事情在哪里......不像有人在他的 c:/mybin 目录中构建他的所有二进制文件，因为这对他来说更容易。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2008-10-28T13:41:07.873

## 限制您使用的类型

如果您需要使用整数类型，请选择一个并保留它。这将避免与混合 short、int、long 等类型相关的问题。

```
// BAD
int i ;
long j ;
short k ;

// GOOD (if you choose the "int" as integer)
int i ;
int j ;
int k ; 
```

真实类型也是如此：选择一个（例如 double），不要使用另一个。

等等。

注意：仍然存在有符号/无符号的问题，这不能总是避免，而且 STL 使用自己的整数类型（即 std::vector::size_type），但所有剩余代码不应混合。

注意 2：您可以使用 typedef 为有符号整数和实数“选择”您喜欢的类型。如果需要，这将实现低成本的改变。

**它如何清楚地促进更安全的代码，从而最大限度地减少神秘错误的风险，提高可维护性等？**

一些错误是通过将无符号类型与有符号类型进行比较、神秘的精度损失或整数下溢/溢出而产生的。

编译器通常在编译时发送警告，但通常的答案是“抛弃”警告，这有助于隐藏错误。

### 编辑

plinth 做了一个有用的评论，我将在这里复制粘贴：

> 在编写了许多必须在硬件级别与事物交互的代码之后，我不能对这个指南说太多。对于这个级别的工作，我更喜欢将整数类型抽象为包含精度的名称（即 int16、uint16、int32、uint32 等）– plinth 8 月 18 日 20:50

当然，底座是对的。有时您必须处理 int16、uint8 和其他“精确定义”的类型。

这不会使上面的帖子无效，只需完成它。

错误的来源是混合不同的类型（例如将 unsigned char 转换为 int），因此必须避免这种混合。因此适用以下规则：

*   选择一种泛型整数类型（例如 int），并在处理泛型整数时坚持使用它（对于实数也可以这样说）
*   如果（且仅当）您需要精确的类型（如 uint8 或 int16），请使用它们
*   切勿混合不同的类型。
*   如果你**真的**必须混合不同的类型，那么非常非常谨慎。

下面是一个会破坏的代码示例：

```
void * doAllocate(uint32 i)
{
   // try to allocate an array of "i" integers and returns it
}

void doSomething()
{
   uint32 i0 = 225 ;
   int8   i1 = 225 ;  // Oops...

   doAllocate(i0) ;   // This will try to allocate 255 integers
   doAllocate(i1) ;   // This will TRY TO allocate 4294967265
                      // integers, NOT 225
} 
```

* * *

## 回答 #39

> 赞同：-2
> 
> 时间：2008-10-28T10:15:02.517

没有标签（允许更好地使用外部/其他工具）和为标签插入的固定空间。

* * *

## 回答 #40

> 赞同：-7
> 
> 时间：2008-10-28T10:38:15.840

按名称对类声明和定义中的函数进行排序。这样可以更轻松地在 .cpp 文件中找到它们。此外，它可以解放您的思想，因为您不必考虑将新功能放在哪里。

# bug-tracking - 您最喜欢的错误/问题跟踪系统是什么？为什么？

> ID：242733
> 
> 赞同：2
> 
> 时间：2008-10-28T10:05:12.770
> 
> 标签：bug-tracking

您最喜欢的错误/问题跟踪系统是什么？为什么？

（请仅在您使用至少三种不同的[错误跟踪](http://en.wikipedia.org/wiki/Bug_tracking_system)系统很长时间后才回答此问题。请同时提及这些系统。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-28T10:07:36.917

[FogBugz](http://www.fogcreek.com/FogBugz)实际上很棒，因为它是：

*   使用简单
*   直觉的
*   集成良好
*   有特色的

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-28T10:20:46.920

[追踪！](http://trac.edgewall.org)[它与SVN](http://en.wikipedia.org/wiki/Apache_Subversion)很好地集成在一起。我们只是喜欢它。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-28T11:19:50.530

[Jira](http://www.atlassian.com/software/jira/)得到了我的投票。它灵活快速，与源代码控制有很好的集成。它还具有子任务、良好的分类和可配置的工作流程。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-28T13:04:09.727

[红米](http://en.wikipedia.org/wiki/Redmine)。这是：

1.  开源

2.  启用[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)

3.  电子邮件界面

4.  [单片机](http://en.wikipedia.org/wiki/Software_configuration_management)集成

5.  综合维基

6.  可配置的跟踪器、工作流和角色

7.  RSS 和电子邮件通知

我用过[JIRA](http://en.wikipedia.org/wiki/JIRA)（太难了）、[Bugzilla](http://en.wikipedia.org/wiki/Bugzilla)（太垃圾）和[FogBugz](http://en.wikipedia.org/wiki/FogBugz)（太贵了），我认为 Redmine 很棒。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-28T12:31:19.480

我们刚刚经历了一个相当耗时的过程，审查了许多（可能是十个？）问题跟踪系统，以取代[GForge](http://en.wikipedia.org/wiki/GForge)，它不仅提供了帮助，还阻碍了我们的工作。我们考虑了免费和商业系统。

坦率地说，我对我们审查的*所有系统感到失望。*在这个领域有很大的改进空间。

他们中的许多人的界面很差（[OnTime](http://en.wikipedia.org/wiki/OnTime)、[JIRA](http://en.wikipedia.org/wiki/JIRA)、[Bugzilla](http://en.wikipedia.org/wiki/Bugzilla)）。一般来说，我们的工程师对此表示满意，但对于我们的项目经理、系统集成商和*客户*而言，重要的是要呈现一个清晰且美观的界面。

我惊讶地发现*很少*支持嵌套子问题。当然，在软件世界中，将任务（问题或新功能）分解成更小的组件并将它们分配给不同的人是很常见的。然而，大多数系统无法做到这一点——或者做得不好。

有些系统非常强大且可配置，但实际上*需要*第三方扩展或插件才能使它们有用。例如，我真的很喜欢 JIRA 和[Trac](http://en.wikipedia.org/wiki/Trac)的灵活性，但我们必须投入大量时间来配置系统以使其更美观或更实用。

当然，它们不是我们关心的唯一功能，但这篇文章已经变得太长了！

当然，您的要求将与我们的不同 - 我鼓励您弄清楚您的要求并彻底调查。

[FogBugz](http://en.wikipedia.org/wiki/FogBugz)、[JIRA](http://en.wikipedia.org/wiki/JIRA)和[Trac](http://en.wikipedia.org/wiki/Trac)都在我们的候选名单上，它们都有一些很棒的功能。但最终他们被一种对我来说以前不为人知的产品打败了：[VisionProject](http://www.visionproject.se/)。

VisionProject 很有吸引力，在功能强大和易于使用之间取得了很好的平衡。我们目前看到的唯一缺点是他们新的（自 v4.0 起）Ajax-y 界面有一些错误。然而，我们已经在一夜之间，有时在几个小时内修复了多个错误 - 感谢他们的超响应开发团队。

我们仍在对该系统进行试验，虽然并不完美，但与所有其他竞争者相比，它的表现非常出色。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-28T10:07:44.310

[Team Foundation Server](http://en.wikipedia.org/wiki/Team_Foundation_Server)，尽管它不仅仅是一个错误跟踪器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-28T10:29:26.670

[Trac](http://en.wikipedia.org/wiki/Trac)或[FogBugz](http://en.wikipedia.org/wiki/FogBugz)看起来不错。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-28T11:36:35.630

我们采用[Trac](http://en.wikipedia.org/wiki/Trac)是因为：

1.  它相当容易安装：如果您完全按照安装说明进行操作，它就可以工作，而且这种情况并不常见！
2.  使用非常简单
3.  它是每个项目可定制的（组件、票证类型、严重性、版本......）
4.  具有灵活/可定制的报告部分
5.  有一个集成的 wiki

但是对我们来说它有一个很大的不足：CVS 支持。但我们采用了它，因为这不是强制性的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-28T12:41:57.523

我们已经使用[Bugtracker.net](http://ifdefined.com/bugtrackernet.html)有一段时间了。

这很好，价格（免费）是正确的。

我最喜欢的一些功能（来自网站）：

*   发送和接收电子邮件与跟踪器集成在一起，因此有关错误的电子邮件线程与错误一起被跟踪。

*   允许将传入的电子邮件记录为错误。因此，例如，来自您客户的电子邮件可能会自动变成跟踪器中的错误/票证。

*   允许您将文件和屏幕截图附加到错误。甚至还有一个自定义屏幕捕获实用程序 [screenshot]，您只需单击几下即可截取屏幕截图、对其进行注释并将其发布为错误。（灵感来自 Fogbugz）

*   添加您自己的自定义字段。

*   订阅电子邮件通知，在添加或更改任何错误时通知您。或者更改您的设置，以便您只收到有关您关心的错误的通知。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-28T13:34:52.160

我有[一页这样的讨论链接](http://ifdefined.com/blog/post/2007/10/Links-to-other-comparisons-of-issue-trackers.aspx)，人们在其中并排比较错误/问题跟踪器，然后选择他们最喜欢的一个。没有单一的追踪器能够始终如一地赢得这些比赛。

在开源软件中，[Trac](http://en.wikipedia.org/wiki/Trac) ( [Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29) )、[Redmine](http://en.wikipedia.org/wiki/Redmine) ( [Ruby](http://en.wikipedia.org/wiki/Ruby_%28programming_language%29) )、[Mantis](http://en.wikipedia.org/wiki/Mantis_Bug_Tracker) ( [PHP](http://en.wikipedia.org/wiki/PHP) ) 和我自己的[BugTracker.NET](http://en.wikipedia.org/wiki/BugTracker.NET) ( [C#](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29) ) 都有自己的粉丝，但我认为开源软件有选择的趋势技术和应用。[FogBugz](http://en.wikipedia.org/wiki/FogBugz)和[JIRA](http://en.wikipedia.org/wiki/JIRA)似乎是最受欢迎的商业软件。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-10-21T11:05:13.127

[关键跟踪器](http://www.pivotaltracker.com/)

它是免费使用的，非常简单易用。强制执行敏捷开发周期，而不是因为“配置一切以符合您的开发过程”而变得臃肿。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-28T11:01:48.803

我喜欢 VersionOne (www.versionone.com)。如果您正在使用其中一种敏捷流程（例如 Scrum），那就太好了。除了管理所有缺陷之外，您还可以管理所有功能和任务。定义了一个不错的缺陷生命周期，它有一个可用的 API，可以与 CVS 集成，并且存在一个 Outlook 插件。它还有很多可以改进的地方，但总的来说，如果您使用敏捷方法，它是一个很好的缺陷管理系统。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-28T10:06:56.260

[Bugzilla](http://en.wikipedia.org/wiki/Bugzilla)还不错。

Bugzilla 非常适应各种情况。目前已知的用途包括 IT 支持队列、系统管理部署管理、芯片设计和开发问题跟踪（制造前和制造后），以及 Red Hat、NASA、Linux-Mandrake 和 VA 等知名企业的软件和硬件错误跟踪系统。结合[CVS](http://en.wikipedia.org/wiki/Concurrent_Versions_System)、Bonsai 或[Perforce](http://en.wikipedia.org/wiki/Perforce) SCM 等系统，Bugzilla 为配置管理和复制问题提供了一个强大、易于使用的解决方案。

Bugzilla 可以通过提供记录在案的工作流程和积极的反馈来显着提高每个员工的工作效率和责任感，以获得良好的绩效。你有多少次早上醒来，记得你今天应该做某事，但你就是不记得了？把它放在 Bugzilla 中，你就有了它的记录，你可以从中推断里程碑，预测产品版本以进行集成，并跟踪导致关键决策的讨论线索。

最终，Bugzilla 将权力交到您手中，以提高您对雇主或企业的价值，同时为您对细节的自然关注和知识存储的蓬勃发展提供一个可用的框架。

# svn - 使用 SVN 锁定文档以进行编辑和更新通知

> ID：242744
> 
> 赞同：2
> 
> 时间：2008-10-28T10:10:48.390
> 
> 标签：svn, locking

最近开发人员强调，他们很难跟踪哪个文档已更新。因此他们建议使用 SVN 来跟踪文档更改会更好，因为他们将能够在签出项目时知道文档是否被更新。

但我也强调了可能发生的几个缺点

*   每次word都会占用大量磁盘空间的二进制文件，提交excel文档
*   签出一个项目将花费更多时间，尽管我们可以将文档分离到存储库中的另一个项目中
*   教人员如何使用 SVN 需要时间。

另一个特点是，对于这类功能性文档，在编辑时应该锁定。

有人知道如何去做吗？或者它的优点和缺点是什么。请随时与我分享。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-28T10:15:51.610

我们在工作中使用 Subversion 进行文档管理。它工作得很好。

*   不用担心磁盘空间。无论如何，修订都是压缩存储的。
*   签出一个有文档的项目并不比没有文档花费更多的时间。除非您的文档绝对庞大，否则这应该不是问题。
*   训练时间是一个考虑因素。幸运的是，TortoiseSVN 让这一切变得简单。

要管理 Word 文档以使它们一次只能由一个人编辑，请使用该[`svn:needs-lock`](http://svnbook.red-bean.com/en/1.2/svn.advanced.locking.html)属性。这将使文件在正常结帐时显示为只读，而在开发人员锁定它们以进行编辑时显示为读写。提交后，文件将被解锁并再次只读。

TortoiseSVN 的另一个好处是它可以对 Word 文档进行差异分析并在 Word 本身中呈现差异。仅此一项对我来说就是一个杀手级功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T10:29:46.543

我认为这个问题比“如何使用 SVN”方面更广泛。

首先，SVN 可能是面向技术人员的合适工具，但对于艺术或管理人员来说可能非常麻烦。我认为所有与项目相关的文档都应该保存在一个所有参与者都可以访问的地方。

此外，版本控制不能替代适当的流程和良好的沟通。您需要找到一种方法将更改和新要求等传达给所有相关方。

我认为您可能需要一个文档管理系统。[露天](http://www.alfresco.com/ "露天")或类似的可能是一个不错的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T23:22:05.423

Greg 和 kauppi 都在这里提出了重要的问题。Subversion 是一个很棒的工具，但它并不适合所有人。一年多来，我一直试图让我的开发团队完全采用它，但我仍然发现自己经常与他们谈论基础知识。

如果您花时间了解和欣赏版本控制系统，那么它们是您永远不想缺少的工具之一。但是，对于某些人来说，使用它们的过程和纪律似乎很麻烦。

这又回到了沟通和良好的团队合作上。有时这些工具可以在这方面提供帮助，但遗憾的是，它们无法解决我们所有的问题。

Greg 建议使用 svn:needs-lock 作为一种控制二进制对象编辑的方法，如果你最终走上了这条路，这是一个很好的建议。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-28T10:31:51.907

Subversion**只**存储版本之间的差异，这使得它非常高效。我不知道这是否适用于二进制文件（例如 Word 或 Excel 文件），但我相信它可能是。如果没有，如果可能，使用 CSV 文件而不是 .XLS 文件和 RTF 文件而不是 .DOC 文件可能对您有利。

# c# - 有没有办法在 Visual Studio 调试器中查看 TextBox TextChanged 事件的所有事件处理程序？

> ID：242745
> 
> 赞同：2
> 
> 时间：2008-10-28T10:11:24.257
> 
> 标签：c#, .net

当我将 textBox.TextChanged 添加到监视列表时，我收到一条消息说

```
事件“System.Windows.Forms.Control.TextChanged”
只能出现在 += 或 -= 的左侧
```

有什么方法可以检查在文本更改时调用了哪些事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T10:17:58.220

在调试器中，打开控件并找到包含[EventHandlerList](http://msdn.microsoft.com/en-us/library/system.componentmodel.eventhandlerlist.aspx)的私有变量。然后找到事件添加/删除代码，`TextChanged`以便查看使用了哪个键 - 并检查事件处理程序列表中该键的条目。

这很痛苦，但它应该有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T10:18:50.713

并不真地; 根据设计，事件是一个封闭的盒子。有一些很老套的方法来解决它，但它们都需要对实现的乱伦知识（无论是类似字段的事件，还是 EventHandlerList 等）。

你为什么需要这个？

另一种方法可能是从[MS 符号服务器](http://weblogs.asp.net/scottgu/archive/2008/01/16/net-framework-library-source-code-now-available.aspx)获取 TextBox pdb，这样您就可以添加断点 (to `OnTextChanged`) 并单步执行 TextBox 代码，然后单步执行委托调用......再次，并不理想。

# sql-server - 什么 SQL 命令授予安全管理员访问数据库的权限？

> ID：242749
> 
> 赞同：1
> 
> 时间：2008-10-28T10:12:31.587
> 
> 标签：sql-server, sql-server-2005, security

我的帐户是 securityadmin 角色，我无法授予自己 sysadmin 权限。我希望获得对数据库的访问权限，以便可以将我的帐户添加到其中的特定角色。
由于我还没有访问数据库的权限，所以我无法使用 UI。

有谁知道这是否可能以及在 SQL Server 2005 中哪些 SQL 命令可以实现这一点？
谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T12:48:11.520

这里有两个安全管理员角色在起作用。

在这种情况下 db_securityadmin （数据库角色）对你没有多大好处，这个角色的成员资格有利于将用户添加到自定义数据库角色（不是内置的 db_* 角色）

在线图书对此有点误导。

securityadmin（服务器角色）将允许您执行重置密码之类的操作，但您可能需要 sysadmin 将您的用户帐户授予数据库。

另一件事是，如果您能够使用管理员组中的帐户登录到运行 SQL Server 的计算机，则在使用受信任的身份验证运行 Management Studio 时，您将被映射到 sysadmin。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T21:35:53.923

不，当您处于 securityadmin 角色时，您不能将自己添加到 SYSADMIN 角色，您需要 SYSADMIN 权限，请记住 SYSADMIN 是 SQL Server 中最强大的角色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T10:23:11.830

**sysadmin 角色**，顾名思义，可以在 SQL Server 中执行任何操作。它对 SQL Server 拥有完全的权利。它是唯一可以将其他人添加到 sysadmin 角色的角色。SQL Server 中没有任何事情是系统管理员角色成员不能做的。

您可以使用系统存储过程**add_srvrolemember**将用户分配给该角色。

**例子：**

```
EXEC sp_addsrvrolemember 'BUILTIN\Administrators', 'sysadmin' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T10:26:31.650

您将使用 sp_addrolemember [ @rolename = ] 'role' ， [ @membername = ] 'security_account'

# .net - 强制应用程序关闭 (.net)

> ID：242752
> 
> 赞同：7
> 
> 时间：2008-10-28T10:13:36.263
> 
> 标签：.net, shutdown

我希望强制我的应用程序关闭，并返回一个退出代码。查看 MSDN，我可以看到在 WPF 中，应用程序有一个 Shutdown 方法，该方法将错误代码作为参数，但 System.Windows.Forms.Application 似乎没有。

我可以看到 Application.Exit() 但不是传回错误代码的方法。

有没有人知道这是否可能？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-28T10:16:08.613

您可以使用 System.Environment.Exit(yourExitCode)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T10:17:23.743

在 System.Environment 类和退出时设置 ExitCode 属性。例如

```
System.Environment.ExitCode = 1
Application.Exit() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T10:24:50.390

将 ExitCode 属性（或类似的东西）添加到您的表单类：

```
class MyForm : Form {
  public int ExitCode { get; set; }

  void ShutDownWithError(int code) {
    ExitCode = code;
    Close();
  }
} 
```

在您的代码中的某处，您有：

```
static void Main() {
  // ...
  MyForm form = new MyForm();
  Application.Run(myForm);
} 
```

将其更改为：

```
static void Main() {
  // ...
  MyForm myForm = new MyForm();
  Application.Run(myForm);
  Environment.Exit(myForm.ExitCode);
} 
```

当在表单上调用 ShutdownWithError 方法时，您将关闭主表单。这将跳出以 Application.Run 开始的循环。然后，您只需获取退出代码并使用 Environment.Exit 终止该进程。

# javascript - DIV的相对定位

> ID：242756
> 
> 赞同：0
> 
> 时间：2008-10-28T10:15:46.603
> 
> 标签：javascript, jquery

有一个名为“dvUsers”的 div。有一个锚标签“lnkUsers”。

当单击anchortag 时，div 必须像弹出式div 一样在其下方打开。

此外，div 的相对位置应保持在窗口调整大小和所有位置。如何使用 javascript/jquery 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T15:15:01.383

也许您应该寻找像**overLIB**这样的预制脚本：http : [//www.bosrup.com/web/overlib/](http://www.bosrup.com/web/overlib/)！-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T19:15:36.980

我的偏好是将它们都放在父 div 中，如下所示：

```
<div id="container">
    <a id="lnkUsers" href="#">Users</a>
    <div id="dvUsers" style="display: none;">
        <!-- user content... -->
    </div>
</div> 
```

这些元素的 CSS 将是：

```
#container{
    /* ensure that #dvUsers is positioned relatively to this element */
    position: relative;
}
#dvUsers{
    position: absolute;
    /* this value should be based on the font-size of #lnkUsers */
    top: 30px;
    left: -10px;
} 
```

这可确保 div 相对于链接正确定位。（为了这个问题，我假设父 div 是“文本对齐：左”或浮动）

javascript 看起来像这样：

```
$(function(){
    $('#lnkUsers').click(function(){
        $('#dvUsers').slideToggle();
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T10:26:37.203

```
$(document).ready(function(){ $("#lnkUsers").click(function(){ $("#dvUser").show("slow"); }); 
```

style="display: none" 应该首先应用于 dvUser 以使其不可见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-25T08:56:58.983

您可以使用 jQuery 插件[PositionCalculator](https://github.com/tlindig/position-calculator)。

HTML：

```
 <p><a class="lnkUsers" href="javascript:void(0)">Users Link1</a></p>
  <p><a class="lnkUsers" href="javascript:void(0)">Users Link 2</a></p>
  <p><a class="lnkUsers" href="javascript:void(0)">Users Link 3</a></p>
  <p><a class="lnkUsers" href="javascript:void(0)">Users Link 4</a></p>
  <p><a class="lnkUsers" href="javascript:void(0)">Users Link 5</a></p>
  <p><a class="lnkUsers" href="javascript:void(0)">Users Link 6</a></p>
  <p><a class="lnkUsers" href="javascript:void(0)">Users Link 7</a></p>
  <p><a class="lnkUsers" href="javascript:void(0)">Users Link 8</a></p>
  <p><a class="lnkUsers" href="javascript:void(0)">Users Link 9</a></p>

  <div id="dvUsers" style="display:none; position:absolute; padding:10px; background:rgba(0,0,0,0.8); color:#ffffff">
    I am the popup. <b>Click me to close</b>
    <div class="dynamicInfo"></div>
  </div> 
```

JavaScript：

```
jQuery(function($) {
    var $popup = $('#dvUsers');
    var $infoField = $popup.find('.dynamicInfo');

    function showPopup(event) {

        // set content
        $infoField.text('clicked link: ' + $(this).text());

        // reset position
        $popup.show().css({top: 0, left: 0});

        // calculate new position
        var calculator = new $.PositionCalculator({
            item: $popup,
            itemAt: "top left",
            target: this,
            targetAt: "bottom left",
            flip: "both"
        });
        var posResult = calculator.calculate();

        // set new position
        $popup.css({
            top: posResult.moveBy.y + "px",
            left: posResult.moveBy.x + "px"
        });

        // window resize handler
        $(window).off('resize.dvUsers');
        $(window).on('resize.dvUsers', function(event) {
            $popup.css({top: 0, left: 0});
            var newResult = calculator.resize().calculate();
            $popup.css({
                top: newResult.moveBy.y + "px",
                left: newResult.moveBy.x + "px"
            });
        });
    }

    // add click handler for show and hide
    $('.lnkUsers').on('click', showPopup);
    $popup.on('click', function() {
        $popup.hide();
        $(window).off('resize.dvUsers');
    });
}); 
```

这是[JSBin 的示例](http://jsbin.com/kefux/1/edit?html,js,output)

# asp.net - 动态重新分配过滤的文本框扩展器

> ID：242761
> 
> 赞同：0
> 
> 时间：2008-10-28T10:16:46.273
> 
> 标签：asp.net, vb.net, ajaxcontroltoolkit

我有一个包含 8 个文本字段的页面，所有这些文本框在接受字符/无效字符方面都需要相同的规则。

我的问题是，我是否应该为每个文本字段设置单独的过滤文本框扩展器，或者我是否可以拥有一个重新分配 TargetControl 的过滤文本框扩展器。

你能做这个客户端，即 TextBoxX.onBlur() 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-31T15:46:00.893

不幸的是，您需要 8 个扩展器，尽管您的想法更优雅。

# html - 对 HTML 属性使用单引号是否正确？

> ID：242766
> 
> 赞同：73
> 
> 时间：2008-10-28T10:18:33.617
> 
> 标签：html, syntax, coding-style, apostrophe

最近看到很多这样的：

```
<a href='http://widget-site-example.com/example.html'>
    <img src='http://widget-site-example.com/ross.jpg' alt='Ross&#39;s Widget' />
</a> 
```

在 HTML 中使用单引号是否有效？正如我在上面强调的那样，这也是有问题的，因为您必须避开撇号。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-10-28T10:22:22.563

使用单引号当然是有效的（[HTML 4.01，第 3.2.2 节](http://www.w3.org/TR/html4/intro/sgmltut.html#h-3.2.2)）。我没有注意到这种趋势，但也许有一些框架可以为您访问过的网站提供支持，而这些网站恰好使用单引号进行引用。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-10-28T10:25:54.820

我发现在使用使用双引号字符串文字的编程语言动态生成 HTML 时，使用单引号很方便。

例如

```
String.Format("<a href='{0}'>{1}</a>", Url, Desc) 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-28T10:28:02.163

使用 PHP 生成 HTML 时，可以更轻松地执行以下操作：

```
$html = "<img src='$url' />"; 
```

而不是将字符串与变量与字符串连接起来，因为 PHP 会解析双引号字符串中的变量。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-28T13:17:43.957

有人可能会在 PHP 中使用它来避免转义 " 如果他们使用双引号字符串来解析其中的变量，或者避免使用字符串连接运算符。

例子：

```
echo "<input type='text' value='$data'/>"; 
```

代替

```
echo "<input type=\"text\" value=\"$data\" />"; 
```

或者

```
echo '<input type="text" value="' . $data . '" />'; 
```

现在我总是坚持对 HTML 使用双引号，对 Javascript 使用单引号。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-28T10:32:01.173

当您想嵌入双引号时会更容易。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-28T10:51:04.783

在 ASP.NET 中，如果您在属性中使用[数据绑定表达式，则使用单引号会更容易：](http://msdn.microsoft.com/en-us/library/ms178366.aspx)

```
<asp:TextBox runat="server" Text='<%# Bind("Name") %>' /> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-12-04T14:24:29.337

您可能希望使用单引号的另一种情况：将 JSON 数据存储在数据属性中：

```
<tr data-info='{"test":true}'></tr> 
```

JSON 对象键必须用双引号括起来，因此属性本身不能。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-14T18:49:00.073

单引号在 (X)HTML 中是完全合法的。另一方面，使用反斜杠来逃避它们不是。是带有替代文本“Ross\”的图像，以及空和/属性。在 HTML 中转义撇号的正确方法是.`<img src='[http://widget-site-example.com/ross.jpg](http://widget-site-example.com/ross.jpg)' alt='Ross\'s Widget' />``s``Widget``Widget'``&#39;`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-07-27T18:05:36.670

在 PHP 中，echo 有多个参数。因此，如果想省略连接运算符，他们可以做类似的事情并且仍然使用双引号：

```
echo '<input type="text" value="', $data, '" />'; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-10-10T12:56:02.073

单引号生成更简洁的页面，更简洁。你不应该在 HTML 字符串中转义它们，使用哪个是你的选择......我的偏好通常是单引号，如果我需要在字符串中包含单引号（例如，作为字符串中字符串的分隔符），我对一个使用双引号，对另一个使用单引号。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-10-30T16:18:11.880

如果您希望[html](/questions/tagged/html "显示标记为“html”的问题")成为有效的[html4](/questions/tagged/html4 "显示标记为“html4”的问题")或[xhtml](/questions/tagged/xhtml "显示标记为“xhtml”的问题")，那么[单引号](/questions/tagged/single-quotes "显示标记为“单引号”的问题")或[双引号](/questions/tagged/double-quotes "显示标记为“双引号”的问题")都适用于属性。HTML4 可以在这里验证：[https ://validator.w3.org/](https://validator.w3.org/)

如果您只[支持现代浏览器](http://html5readiness.com/)（[ie10](/questions/tagged/ie10 "显示标记为“ie10”的问题")和更高版本），那么您可以使用允许单引号、双引号和无引号的[html5](/questions/tagged/html5 "显示标记为“html5”的问题")语法（只要属性值中没有特殊字符）。HTML5 可以在这里验证：[https ://validator.w3.org/nu](https://validator.w3.org/nu)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-28T10:31:40.673

什么是反对单引号？

只要您在当前标签内保持相同的引用样式，您就可以毫无问题地在您的 html 代码中使用单引号/双引号（许多浏览器甚至不会抱怨这一点，并且如果您从一个引用，以相同的结尾，在相同的礼节内）

免费支持随机引用风格！！！（耶；D）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-02-02T06:26:18.050

我知道这是一个旧线程，但仍然非常相关。

如果您想控制生成的 HTML 中的引号，可以使用 PHP 中的[sprintf()](http://php.net/manual/en/function.sprintf.php)函数（以及许多其他语言中可用的类似调用）：

```
$html = sprintf('<a href="%s">%s</a>', $url, $text); 
```

使用 sprintf() 可以通过从数据库或配置文件中检索格式字符串或通过翻译机制轻松修改格式字符串。

它非常易读，并且允许在生成的 HTML 中使用双引号或单引号，几乎不需要更改，并且从不转义：

```
$html = sprintf("<a href='%s'>%s</a>", $url, $text); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-07-29T17:23:40.873

为什么不保存`SHIFT`按键。相同里程减少一次击键。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-03-17T12:50:49.460

## 让我们永远解决这个争论

* * *

1.  **双引号**没问题
2.  **单引号**没问题
3.  **没有引号**是可以的，只要您没有以下字符之一：
    *   空间（显然）
    *   “<”或“>”（有意义）
    *   等号（不知道为什么，但可以）
    *   任何类型的引用：双引号、单引号、反引号（再次，有意义）

有趣的是，即使在今天，有些人仍然坚持“仅双引号”标准，这从来都不是真正的标准，而是一种惯例。此外，如果您的语言将撇号作为自然元素（英语，任何人？），它会更方便，但在我看来，增加 PHP 字符串组合的复杂性是太高的代价，无法为此付出代价。

* * *

## 回答 #16

> 赞同：-6
> 
> 时间：2014-10-17T18:56:00.977

# 你应该完全避免引用。

在您的示例中，只有一个带引号的属性实际上需要引号。

```
<!-- best form -->
<a href=http://widget-site-example.com/example.html>
  <img src=http://widget-site-example.com/ross.jpg alt='Ross&#39;s Widget' />
</a> 
```

如果您确实使用引号，则没有硬性规定，但我见过最常见的单引号，必要时在内部使用双引号。

使用双引号不会通过某些验证器。

# oracle - 带有 IN 子句参数的 Oracle 存储过程

> ID：242771
> 
> 赞同：16
> 
> 时间：2008-10-28T10:19:53.927
> 
> 标签：oracle, stored-procedures, input, plsql

如何创建一个 Oracle 存储过程，它接受用于提供 IN 子句的可变数量的参数值？

这就是我想要达到的目标。我不知道如何在 PLSQL 中声明以传递我要更新的行的主键的变量列表。

```
FUNCTION EXECUTE_UPDATE
  ( <parameter_list>
   value IN int)
  RETURN  int IS
BEGIN 
    [...other statements...]
    update table1 set col1 = col1 - value where id in (<parameter_list>) 

    RETURN SQL%ROWCOUNT ;
END; 
```

此外，我想从 C# 调用此过程，因此它必须与 .NET 功能兼容。

谢谢，罗伯特

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-28T11:52:53.707

使用 CSV 可能是最简单的方法，假设您可以 100% 确定您的元素本身不会包含字符串。

另一种可能更健壮的方法是创建一个自定义类型作为字符串表。假设您的字符串永远不会超过 100 个字符，那么您可以：

```
CREATE TYPE string_table AS TABLE OF varchar2(100); 
```

然后，您可以将这种类型的变量传递到您的存储过程中并直接引用它。在你的情况下，是这样的：

```
FUNCTION EXECUTE_UPDATE(
    identifierList string_table,
    value int)
RETURN int
IS
BEGIN

    [...other stuff...]

    update table1 set col1 = col1 - value 
    where id in (select column_value from table(identifierList));

    RETURN SQL%ROWCOUNT;

END 
```

该`table()`函数将您的自定义类型转换为具有单列“COLUMN_VALUE”的表，然后您可以将其视为任何其他表（连接或在本例中为子选择）。

这样做的好处是 Oracle 会为您创建一个构造函数，因此在调用您的存储过程时，您可以简单地编写：

```
execute_update(string_table('foo','bar','baz'), 32); 
```

我假设您可以从 C# 以编程方式构建此命令。

顺便说一句，在我的公司，我们有许多自定义类型被定义为字符串、双精度、整数等列表的标准。我们还利用[Oracle JPublisher](http://www.oracle.com/technology/oramag/oracle/04-jan/o14dev_jpublisher.html)能够直接从这些类型映射到相应的 Java 对象。我快速浏览了一下，但看不到 C# 的任何直接等效项。只是想我会提到它，以防 Java 开发人员遇到这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T11:42:54.477

我认为没有直接的方法可以创建具有可变数量参数的程序。[然而，这里](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14251/adfns_packages.htm)描述了一些，至少是部分的问题解决方案。

1.  如果有一些典型的调用类型，过程重载可能会有所帮助。
2.  如果参数的数量有上限（并且它们的类型也是预先知道的），参数的默认值可能会有所帮助。
3.  最好的选择可能是使用游标变量，它们是指向数据库游标的指针。

不幸的是，我没有使用 .NET 环境的经验。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-11T15:19:18.660

我找到了 Mark A. Williams 的以下文章，我认为这将是对该主题的有用补充。这篇文章给出了一个使用关联数组（TYPE myType IS TABLE OF mytable.row%TYPE INDEX BY PLS_INTEGER）将数组从 C# 传递到 PL/SQL procs 的好例子：

[Mark A. Williams 的精彩文章](http://www.oracle.com/technetwork/issue-archive/2007/07-jan/o17odp-093600.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-05T16:11:53.673

为什么不直接使用长参数列表并将值加载到表构造函数中？这是这个技巧的 SQL/PSM

```
UPDATE Foobar
   SET x = 42
 WHERE Foobar.keycol
      IN (SELECT X.parm
            FROM (VALUES (in_p01), (in_p02), .., (in_p99)) X(parm)
           WHERE X.parm IS NOT NULL); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-28T10:22:55.513

我还没有为 Oracle 做过，但是使用 SQL Server，您可以使用函数将 CSV 字符串转换为表，然后可以在 IN 子句中使用该表。为 Oracle 重写这个应该是直截了当的（我认为！）

```
CREATE Function dbo.CsvToInt ( @Array varchar(1000)) 
returns @IntTable table 
    (IntValue nvarchar(100))
AS
begin

    declare @separator char(1)
    set @separator = ','

    declare @separator_position int 
    declare @array_value varchar(1000) 

    set @array = @array + ','

    while patindex('%,%' , @array) <> 0 
    begin

      select @separator_position =  patindex('%,%' , @array)
      select @array_value = left(@array, @separator_position - 1)

        Insert @IntTable
        Values (Cast(@array_value as nvarchar))

      select @array = stuff(@array, 1, @separator_position, '')
    end

    return
end 
```

然后你可以传入一个 CSV 字符串（例如'0001,0002,0003'）并执行类似的操作

```
UPDATE table1 SET 
       col1 = col1 - value 
WHERE id in (SELECT * FROM csvToInt(@myParam)) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-28T11:26:34.137

AskTom 网站上有一篇文章展示了如何创建一个函数来解析 CSV 字符串，并以与给出的 SQL Server 示例类似的方式在您的语句中使用它。

见[Asktom](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:139812348065 "阿斯克汤姆")

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-10-28T10:26:39.077

为什么它必须是一个存储过程？您可以以编程方式构建准备好的语句。

# linux - 使用 iptables 更改目标端口

> ID：242772
> 
> 赞同：19
> 
> 时间：2008-10-28T10:20:17.467
> 
> 标签：linux, iptables

是否可以使用 iptables 更改 UDP 数据包的目标端口？

我正在尝试让 SNMP 代理在 1620 而不是 162 上发送陷阱。不幸的是，到目前为止，我只设法更改了源端口：

> iptables -t nat -A POSTROUTING -p udp --dport 162 -j SNAT --to :1620

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-28T12:35:20.283

假设您知道要发送到哪台机器：

```
iptables -t nat -A OUTPUT -p udp --dport 162 -j DNAT --to-destination <dest-ip>:1620 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-13T08:54:54.930

您可以将 162 重定向到 1620

```
iptables -t nat -A PREROUTING -p UDP --dport 162 -j REDIRECT --to-port 1620 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-31T05:57:44.733

显然不支持这种用法。取自[http://www.netfilter.org/documentation/HOWTO/NAT-HOWTO.txt](http://www.netfilter.org/documentation/HOWTO/NAT-HOWTO.txt)：

> 6.3.7\. 更改本地生成连接的目的地
> 
> NAT 代码允许您在 OUTPUT 链中插入 DNAT 规则，但这
> 在 2.4 中并不完全支持（可以，但它需要一个新的
> 配置选项、一些测试和相当多的编码，所以除非有人签约 Rusty写它，我不希望它很快）。
> 
> 当前的限制是您只能将目的地更改为
> 本地机器（例如，`j DNAT --to 127.0.0.1'），不能更改为任何其他机器，否则回复将无法正确翻译。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T11:38:10.367

@PiedPiper 是对的。使用 DNAT，您必须指定一个 IP 地址，但我们只想进行端口重定向，因此 -j REDIRECT 在这种情况下可能会起作用。

见[http://www.netfilter.org/documentation/HOWTO//NAT-HOWTO-6.html#ss6.2](http://www.netfilter.org/documentation/HOWTO//NAT-HOWTO-6.html#ss6.2)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T11:04:05.350

尝试使用 DNAT，而不是制作 SNAT。源端口会更改，因为 SNAT 意味着 SourceNAT，因此 DNAT 将为您工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T12:39:46.623

您可以设置转移规则，然后使用修改后的端口重新注入数据包。

我在 Mac OS X 上做过一段时间，但在 Linux 上的原理相同： [http ://blog.dv8.ro/2006/08/using-divert-sockets-on-mac-os-x.html](http://blog.dv8.ro/2006/08/using-divert-sockets-on-mac-os-x.html)

您基本上需要创建一个非常简单的透明代理。

# user-interface - Intranet 和 Internet 的 UI 设计不同的原因？

> ID：242781
> 
> 赞同：2
> 
> 时间：2008-10-28T10:23:56.773
> 
> 标签：user-interface

我们目前有两种用于 Internet 和 Intranet 的 UI 设计，其根本原因是它们都服务于不同的目的，因此它们具有不同的 UI 设计。

但是，用户希望在 Internet 和 Intranet 之间拥有更同步的外观和感觉。

大家能想到的互联网和内联网用户界面/外观不同的原因是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T10:47:47.427

在 Intranet 上，人们倾向于共享更多的商业敏感信息。因此，保持 UI 略有不同（和区别）可以帮助用户轻松意识到他们在不同的区域/站点。

另一个问题是 Intranet 的功能和使用通常与公共网站的功能和使用非常不同。公共网站*通常*以营销为重点。帮助人们为公司获得可信赖的“感觉”的 UI 设计在这里很重要。

然而，Intranet 通常信息更加密集，甚至可以成为工作场所。具有较低的营销类型风格，而不是类似于应用程序的风格是关键。

本质上，非常不同的用途会导致不同的 UI 设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T10:29:37.603

访问网页的浏览器可能是一个原因。虽然（大型）企业内部网可能由 Windows 主导，因此 Internet Explorer 可能是一个安全的假设，但在（狂野、狂野）互联网中，人们无法确定并且必须设计更多可互操作的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T10:26:19.187

Intranet 上可能有**更多信息**。此外，消息的语气可能会针对不同的目标，但您需要询问营销人员。对 Intranet 的“销售”可能较少。

通常**身份验证**会有所不同，甚至与域集成。

Intranet 的最大区别在于，您通常不需要设计到**最低公分母**，即适用于许多浏览器的内容。您甚至可以推测您在互联网上永远无法做到的有关用户环境的其他事情，因此能够针对**已知目标**进行开发。例如，您可以假设每个用户都运行 linux、FF 3 并拥有 flash 或 windows vista、IE8 和 silverlight。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T10:50:45.830

执行不同任务的不同用户通常需要不同的方法来执行这些任务。这就是为什么他们可能需要不同的 UI

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T10:55:20.003

如果受众和功能相同，则应尝试使用相同的 UI。如果存在完全相同的 UI 的技术限制，您应该确保它是*一致*的，即两者都遵循相同的设计原则，如果事情是，常见的工作流程工作相同的路线。当从一个界面移动到另一个界面时，用户不必重新学习一些东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T12:17:51.693

一致的 UI 是一回事，但应该承认用户之间存在差异。

浏览内网的员工（通常）有一个非常明确的访问目的，他们之前也使用过该网站（并且会再次使用它，无论他们喜欢与否）。对于互联网，它可能完全不同（取决于您的客户）。有些人可能只是碰巧通过寻找您的产品来浏览（因此销售是一个重点，这不适用于您的员工）以及他们不会那么熟练地浏览您的信息这一事实。他们不知道可以找到什么，而您的员工却经常这样做。他们只需要找到“它”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-28T10:28:37.217

如果两者的功能有明显的不同，那么我相信 UI 也一定是不同的。

您可以通过使用颜色、菜单定位、主题等使两者相似。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-28T10:29:23.470

设计预算，面向互联网的门户可能需要更多预算，以使其在公众面前看起来更好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-28T10:32:30.220

如果目标人群不同，您应该相应地设计您的 UI。如果外网用户不会使用内网，反之亦然，那么由于业务需求不同，UI自然也会不同。

例如，Extranet 可能有更多面向 AJAX/web 2.0 的设计，而 Intranet 用户则希望专注于功能。如果内网不需要 AJAX，那么 UI 实现肯定会更容易。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-28T12:41:57.290

有时我们会在 Intranet 站点中提供**更强大的用户体验**。

例如，我们可以显示特定业务实体的结果网格，比如客户。

在互联网站点上，我们可能只允许最终用户对列表进行排序，使用简单的 html 表格来显示结果。

在 Intranet 站点上，我们可以使用更**强大**的网格控件，在我们的例子中是 DevExpress 网格控件，这允许用户对列进行排序、分组、过滤和添加/删除，而不会给开发人员带来过多的编程负担，但提供在处理数据时提供更好的用户体验。

此外，我们不必担心 Intranet 站点的带宽和页面大小。

# java - 正则表达式中的转义路径分隔符

> ID：242792
> 
> 赞同：12
> 
> 时间：2008-10-28T10:28:16.220
> 
> 标签：java, regex, escaping

我需要编写一个正则表达式来查找匹配的 javascript 文件

```
<anypath><slash>js<slash><anything>.js 
```

例如，它应该适用于两者：

*   c:\mysite\js\common.js (Windows)
*   /var/www/mysite/js/common.js (UNIX)

问题是 Windows 中的文件分隔符没有被正确转义：

```
pattern = Pattern.compile(
     "^(.+?)" + 
     File.separator +
     "js" +
     File.separator +
     "(.+?).js$" ); 
```

投掷

```
java.util.regex.PatternSyntaxException: Illegal/unsupported escape sequence 
```

有什么方法可以使用在 Windows 和 UNIX 系统中都可以使用的通用正则表达式？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-28T10:32:10.783

行得通吗`Pattern.quote(File.separator)`？

编辑：这在 Java 1.5 或更高版本中可用。对于 1.4，您需要简单地转义文件分隔符字符：

```
"\\" + File.separator 
```

转义标点字符不会破坏任何内容，但无条件转义字母或数字会将它们更改为特殊含义或导致[PatternSyntaxException](http://java.sun.com/j2se/1.4.2/docs/api/java/util/regex/PatternSyntaxException.html)。*（感谢[Alan M](https://stackoverflow.com/users/20938/alan-m)在评论中指出这一点！）*

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-28T15:08:07.277

> 有什么方法可以使用在 Windows 和 UNIX 系统中都可以使用的通用正则表达式？

是的，只需使用匹配这两种分隔符的正则表达式。

```
pattern = Pattern.compile(
    "^(.+?)" + 
    "[/\\\\]" +
    "js" +
    "[/\\\\]" +
    "(.+?)\\.js$" ); 
```

这是安全的，因为 Windows 和 Unix 都不允许在文件或目录名称中使用这些字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T10:33:02.043

你不能像这样使用反斜杠来转义路径分隔符：

```
pattern = Pattern.compile(
     "^(.+?)\\" + 
     File.separator +
     "js\\" +
     File.separator +
     "(.+?).js$" ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T10:34:44.193

你为什么不逃跑`File.separator`：

```
... +
"\\" + File.separator +
... 
```

符合`Pattern.compile`要求？我希望将“/”（unix 大小写）作为单个“/”处理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T10:45:12.330

我已经在 Unix 系统上测试了 gimel 的答案 -`"\\" + File.separator`效果很好 - 结果`"\/"`模式正确匹配单个`"/"`

# c# - 如何在 C# 中检索单选按钮的名称属性

> ID：242812
> 
> 赞同：4
> 
> 时间：2008-10-28T10:34:21.620
> 
> 标签：c#, javascript, asp.net

我在 C# 中创建了一系列单选按钮控件。`(radCompany, radProperty etc.)`
我已将它们的组名设置为相同 (282_Type)，因此它们用作单选按钮列表。

如何`(like: ct100$m$dfgadjkfasdghasdkjfg$282_Type)`在 c# 中检索名称，以便可以在我正在创建的 Javascript 方法中使用它？

输出的值是：

```
Radion Button 1  
id="ct223423432243_radCompany" name="ct100$sdfsdf$sdfsdf$282_Type"  
Radion Button 2  
id="ct223423432243_radProperty" name="ct100$sdfsdf$sdfsdf$282_Type" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T10:40:46.863

需要引用控件的[ClientID](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientid.aspx)；这是最终 html 中的 id。

当然，另一种方法可能是使用一些其他属性（例如 css 等），并使用[jQuery](http://jquery.com/)来查找它；jQuery 从 javascript 中消除了很多 DOM 的痛苦。有趣的是，现在 VS2008 甚至支持 jQuery（带有智能感知等）。

我目前正在阅读[jQuery in Action](http://www.manning.com/bibeault/)，并且非常喜欢它。直接从书中举一个例子（关于收音机的主题）：

```
var x = $('[name=radioGroup]:checked').val(); 
```

它返回组中单个选中的单选按钮的值，或者`undefined`如果没有选择。

重新获得名称；它使用了内部`UniqueGroupName`属性，它做了很多修改。一个选项（但不是一个有吸引力的选项）是使用反射来阅读`UniqueGroupName`. 或者，使用一些简单的东西，比如文字控件。天哪，我讨厌 ASP.NET 表单模型……在 MVC 上滚动……

Fianlly - 我目前正在查看公开的[VS2010 CTP](http://www.microsoft.com/downloads/details.aspx?familyid=922b4655-93d0-4476-bda4-94cf5f8d4814&displaylang=en&tm)图像；ASP.NET 的新增功能之一是 static `ClientID`，通过在控件上设置 ClientIdMode = Static。有点晚了，但不是不受欢迎。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-15T03:09:12.007

[http://reflector.webtropy.com/default.aspx/Net/Net/3@5@50727@3053/DEVDIV/depot/DevDiv/releases/whidbey/netfxsp/ndp/fx/src/xsp/System/Web/ UI/WebControls/RadioButton@cs/2/RadioButton@cs](http://reflector.webtropy.com/default.aspx/Net/Net/3@5@50727@3053/DEVDIV/depot/DevDiv/releases/whidbey/netfxsp/ndp/fx/src/xsp/System/Web/UI/WebControls/RadioButton@cs/2/RadioButton@cs)

```
internal string UniqueGroupName {  
        get { 
            if (_uniqueGroupName == null) {  
                // For radio buttons, we must make the groupname unique, but can't just use the  
                // UniqueID because all buttons in a group must have the same name.  So 
                // we replace the last part of the UniqueID with the group Name.  
                string name = GroupName; 
                string uid = UniqueID; 

                if (uid != null) {  
                    int lastColon = uid.LastIndexOf(IdSeparator); 
                    if (lastColon >= 0) {  
                        if (name.Length > 0) {  
                            name = uid.Substring(0, lastColon+1) + name; 
                        }  
                        else if (NamingContainer is RadioButtonList) { 
                            // If GroupName is not set we simply use the naming 
                            // container as the group name 
                            name = uid.Substring(0, lastColon);  
                        } 
                    }  

                    if (name.Length == 0) { 
                        name = uid;  
                    } 
                } 

                _uniqueGroupName = name;  
            } 
            return _uniqueGroupName;  
        }  
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-15T03:31:19.680

您需要 UniqueID 属性：

> *   **UniqueID** — 由 ASP.NET 页面框架分配给控件的分层限定唯一标识符。
>     
>     
> *   **ClientID** — 由 ASP.NET 页面框架分配给控件并呈现为客户端上的 HTML ID 属性的唯一标识符。ClientID 与 UniqueID 不同，因为 UniqueID 可以包含无效的冒号 (:)在 HTML ID 属性中（并且不允许在客户端脚本中的变量名中使用）。

（[从这里](http://msdn.microsoft.com/en-us/library/aa720435%28v=vs.71%29.aspx)）

# javascript - 什么时候应该在 JavaScript 中使用双引号或单引号？

> ID：242813
> 
> 赞同：2170
> 
> 时间：2008-10-28T10:34:35.097
> 
> 标签：javascript, string, conventions

`console.log("double");`对比`console.log('single');`

我看到越来越多的 JavaScript 库在处理字符串时使用单引号。使用其中一种的原因是什么？

我认为它们几乎可以互换。

* * *

## 回答 #1

> 赞同：1354
> 
> 时间：2008-10-28T10:40:18.597

在不同的库中使用 single 和 double 最可能的原因是程序员的偏好和/或 API 一致性。除了保持一致之外，使用最适合字符串的那个。

使用其他类型的引号作为文字：

```
alert('Say "Hello"');
alert("Say 'Hello'"); 
```

这可能会变得复杂：

```
alert("It's \"game\" time.");
alert('It\'s "game" time.'); 
```

ECMAScript 6 中新增的另一个选项是使用*反引号字符的*[模板文字](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals)：

 *```
alert(`Use "double" and 'single' quotes in the same string`);
alert(`Escape the \` back-tick character and the \${ dollar-brace sequence in a string`); 
```

模板文字为变量插值、多行字符串等提供了简洁的语法。

请注意，[JSON](https://jsonlint.com/)被正式指定为使用双引号，这可能值得考虑，具体取决于系统要求。

* * *

## 回答 #2

> 赞同：653
> 
> 时间：2011-01-06T07:59:46.687

如果你在处理 JSON，应该注意严格来说，JSON 字符串必须是双引号。当然，许多库也支持单引号，但在我意识到单引号字符串实际上不符合 JSON 标准之前，我在我的一个项目中遇到了很大的问题。

* * *

## 回答 #3

> 赞同：380
> 
> 时间：2013-08-04T08:36:01.427

**没有更好的解决方案**；但是，我想争辩说，有时双引号可能更可取：

*   **新手已经熟悉他们的语言中的双引号**。在英语中，我们必须使用双引号`"`来标识一段引用的文本。如果我们使用单引号`'`，读者可能会将其误解为缩写。由 包围的文本段落的另一个含义`'`表示“口语”含义。与预先存在的语言保持一致是有意义的，这可能会简化代码的学习和解释。
*   **双引号消除了转义撇号的需要**（如在收缩中）。考虑字符串: `"I'm going to the mall"`, 与其他转义的版本: `'I\'m going to the mall'`.
*   **双引号在许多其他语言中表示字符串**。当您学习一门新语言（如 Java 或 C）时，总是使用双引号。在 Ruby、PHP 和 Perl 中，单引号字符串意味着没有反斜杠转义，而双引号支持它们。

*   **JSON 表示法是用双引号编写的。**

尽管如此，正如其他人所说，保持一致是最重要的。

* * *

## 回答 #4

> 赞同：122
> 
> 时间：2008-10-28T20:56:12.520

[规范](https://www.ecma-international.org/publications/standards/Ecma-262.htm)的第 7.8.4 节描述了文字字符串表示法。唯一的区别是 DoubleStringCharacter 是“SourceCharacter 但不是双引号”，而 SingleStringCharacter 是“SourceCharacter 但不是单引号”。因此，**唯一**的区别可以这样证明：

```
'A string that\'s single quoted'

"A string that's double quoted" 
```

因此，这取决于您要转义多少引号。显然，这同样适用于双引号字符串中的双引号。

* * *

## 回答 #5

> 赞同：118
> 
> 时间：2015-08-07T17:28:46.347

# 单引号

我希望双引号是标准，因为它们[更有意义](https://stackoverflow.com/questions/242813/when-to-use-double-or-single-quotes-in-javascript#18041188)，但我一直使用单引号，因为它们在场景中占主导地位。

单引号：

*   [爱彼迎](https://github.com/jscs-dev/node-jscs/blob/master/presets/airbnb.json)
*   [Facebook](https://github.com/facebook/fbjs/blob/8d447780c6f4df0ef92fa3d2987d9c4f96eb0100/packages/eslint-config-fbjs-opensource/index.js#L249)
*   [谷歌](https://github.com/jscs-dev/node-jscs/blob/master/presets/google.json)
*   [咕噜声](https://github.com/jscs-dev/node-jscs/blob/master/presets/grunt.json)
*   [Gulp.js](https://github.com/gulpjs/gulp/blob/master/.jscsrc)
*   [节点.js](https://github.com/jscs-dev/node-jscs/blob/master/presets/node.json)
*   [npm](https://github.com/npm/npm/blob/master/lib/npm.js)（虽然[作者指南](https://docs.npmjs.com/misc/coding-style)中没有定义）
*   [维基媒体](https://github.com/jscs-dev/node-jscs/blob/master/presets/wikimedia.json)
*   [WordPress](https://github.com/jscs-dev/node-jscs/blob/master/presets/wordpress.json)
*   [Yandex](https://github.com/jscs-dev/node-jscs/blob/master/presets/yandex.json)

没有偏好：

*   [三.js](https://github.com/jscs-dev/node-jscs/blob/master/presets/mdcs.json)

双引号：

*   [打字稿](https://github.com/microsoft/TypeScript/blob/main/.eslintrc.json)
*   [道格拉斯·克罗克福德](https://plus.google.com/+DouglasCrockfordEsq/posts/EBky2K9erKt)
*   [D3.js](https://github.com/d3/d3-format/blob/master/src/locale.js)（虽然没有在 中定义[`.eslintrc`](https://github.com/d3/d3-shape/blob/master/.eslintrc)）
*   [jQuery](https://github.com/jscs-dev/node-jscs/blob/master/presets/jquery.json)

* * *

## 回答 #6

> 赞同：62
> 
> 时间：2009-05-02T07:48:16.733

我想说这种区别纯粹是风格上的，但我真的很怀疑。考虑以下示例：

```
/*
    Add trim() functionality to JavaScript...
      1\. By extending the String prototype
      2\. By creating a 'stand-alone' function
    This is just to demonstrate results are the same in both cases.
*/

// Extend the String prototype with a trim() method
String.prototype.trim = function() {
    return this.replace(/^\s+|\s+$/g, '');
};

// 'Stand-alone' trim() function
function trim(str) {
    return str.replace(/^\s+|\s+$/g, '');
};

document.writeln(String.prototype.trim);
document.writeln(trim); 
```

在 Safari、Chrome、Opera 和 Internet Explorer（在[Internet Explorer 7](https://en.wikipedia.org/wiki/Internet_Explorer_7)和[Internet Explorer 8](https://en.wikipedia.org/wiki/Internet_Explorer_8)中测试）中，这将返回以下内容：

```
function () {
    return this.replace(/^\s+|\s+$/g, '');
}
function trim(str) {
    return str.replace(/^\s+|\s+$/g, '');
} 
```

但是，Firefox 会产生稍微不同的结果：

```
function () {
    return this.replace(/^\s+|\s+$/g, "");
}
function trim(str) {
    return str.replace(/^\s+|\s+$/g, "");
} 
```

单引号已被双引号代替。（还要注意缩进空格是如何被四个空格替换的。）这给人的印象是，至少有一个浏览器在内部解析 JavaScript，就好像所有内容都是使用双引号编写的一样。*有人可能会想，如果一切都已经按照这个“标准”编写，那么 Firefox 解析 JavaScript 所需的时间就会减少。*

顺便说一句，这让我很伤心，因为我认为单引号在代码中看起来更好。另外，在其他编程语言中，它们通常比双引号使用起来更快，所以只有在同样适用于 JavaScript 时才有意义。

**结论：**我认为我们需要对此做更多的研究。

这或许可以解释[Peter-Paul Koch](http://lists.evolt.org/pipermail/javascript/2003-November/006155.html)早在 2003 年的测试结果。

> 似乎在资源管理器 Windows中单引号*有时更快（我的测试中大约 1/3 确实显示出更快的响应时间），但如果 Mozilla 完全显示出差异，它处理双引号的速度会稍微快一些。*我发现 Opera 完全没有区别。

**2014：**现代版本的 Firefox/Spidermonkey 不再这样做了。

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2009-07-24T18:50:09.500

如果你正在做内联 JavaScript（可以说是一个“坏”的事情，但避免讨论）**单**引号是字符串文字的唯一选择，我相信。

例如，这很好用：

```
<a onclick="alert('hi');">hi</a> 
```

但是您不能通过我知道的任何转义方法将“hi”用双引号引起来。即使**`&quot;`**这是我最好的猜测（因为你在 HTML 的属性值中转义引号）在 Firefox 中对我不起作用。 **`"`**也不起作用，因为此时您正在转义 HTML，而不是 JavaScript。

因此，如果游戏的名称是一致性，并且您将在应用程序的某些部分中执行一些内联​​ JavaScript，我认为单引号是赢家。如果我错了，请有人纠正我。

* * *

## 回答 #8

> 赞同：32
> 
> 时间：2012-05-02T21:11:41.147

从技术上讲没有区别。这只是风格和惯例的问题。

[Douglas Crockford](https://en.wikipedia.org/wiki/Douglas_Crockford)建议对内部字符串使用单引号，对外部字符串使用双引号（外部是指要显示给应用程序用户的字符串，例如消息或警报）。

我个人遵循这一点。

*更新：克罗克福德先生似乎[改变了主意](https://plus.google.com/+DouglasCrockfordEsq/posts/EBky2K9erKt)，现在建议在整个过程中使用双引号:)*

* * *

## 回答 #9

> 赞同：30
> 
> 时间：2008-10-28T15:15:07.700

严格来说，意思上没有区别；所以选择归结为方便。

以下是可能影响您选择的几个因素：

*   房屋风格：一些开发人员团体已经使用了一种约定或其他约定。
*   客户端要求：您会在字符串中使用引号吗？（见[艾迪的回答](https://stackoverflow.com/questions/242813/when-should-i-use-double-or-single-quotes-in-javascript/242833#242833)。）
*   服务器端语言：VB.NET 的人可能会选择对 JavaScript 使用单引号，这样脚本就可以在服务器端构建（VB.NET 对字符串使用双引号，因此 JavaScript 字符串使用单引号很容易区分）引号）。
*   库代码：如果您正在使用使用特定样式的库，您可能会考虑自己使用相同的样式。
*   个人偏好：您可能认为一种或另一种风格看起来更好。

* * *

## 回答 #10

> 赞同：20
> 
> 时间：2012-07-24T15:16:11.270

让我们看看引用的作用。

在 jquery.js 中，每个字符串都是双引号。

所以，从现在开始，我将使用双引号字符串。（我用的是单人！）

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2015-09-08T16:37:59.240

**只要保持你使用的一致性。但不要降低你的舒适度。**

```
"This is my string."; // :-|
"I'm invincible."; // Comfortable :)
'You can\'t beat me.'; // Uncomfortable :(
'Oh! Yes. I can "beat" you.'; // Comfortable :)
"Do you really think, you can \"beat\" me?"; // Uncomfortable :(
"You're my guest. I can \"beat\" you."; // Sometimes, you've to :P
'You\'re my guest too. I can "beat" you too.'; // Sometimes, you've to :P 
```

**ECMAScript 6 更新**

使用*模板文字语法*。

```
`Be "my" guest. You're in complete freedom.`; // Most comfort :D 
```

* * *

## 回答 #12

> 赞同：16
> 
> 时间：2012-05-07T19:25:17.233

我希望我没有添加一些明显的东西，但我一直在努力使用[Django](http://en.wikipedia.org/wiki/Django_%28web_framework%29)、[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)和 JSON 来解决这个问题。

假设在您的 HTML 代码中确实使用了双引号（通常应该如此），我强烈建议在 JavaScript 中对其余部分使用单引号。

所以我同意[ady](https://stackoverflow.com/questions/242813/when-should-i-use-double-or-single-quotes-in-javascript/242833#242833)，但要小心。

我的底线是：

在 JavaScript 中这可能无关紧要，但是一旦将其嵌入 HTML 或类似内容中，您就会开始遇到麻烦。您应该知道实际上是在转义、读取、传递您的字符串的内容。

我的简单案例是：

```
tbox.innerHTML = tbox.innerHTML + '<div class="thisbox_des" style="width:210px;" onmouseout="clear()"><a href="/this/thislist/'
                   + myThis[i].pk +'"><img src="/site_media/'
                   + myThis[i].fields.thumbnail +'" height="80" width="80" style="float:left;" onmouseover="showThis('
                   + myThis[i].fields.left +','
                   + myThis[i].fields.right +',\''
                   + myThis[i].fields.title +'\')"></a><p style="float:left;width:130px;height:80px;"><b>'
                   + myThis[i].fields.title +'</b> '
                   + myThis[i].fields.description +'</p></div>' 
```

您可以在 showThis 的第三个字段中发现 '。

双引号不起作用！

很清楚为什么，但也很清楚为什么我们应该坚持使用单引号......我猜......

这个案例是一个非常简单的 HTML 嵌入，错误是由“双引号”JavaScript 代码的简单复制/粘贴生成的。

所以回答这个问题：

尝试在 HTML 中使用单引号。它可能会节省一些调试问题......

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2012-05-20T21:48:17.083

这主要是风格和偏好的问题。其他答案中有一些相当有趣和有用的技术探索，所以我可能唯一要补充的就是提供一些世俗的建议。

*   *如果*您在公司或团队中编码，*那么*遵循“house style”可能是一个好主意。

*   *如果*你一个人在做一些业余项目，*那么*看看社区中的一些杰出领导者。例如，假设您进入[Node.js](https://en.wikipedia.org/wiki/Node.js)。看看核心模块，例如[Underscore.js](https://en.wikipedia.org/wiki/Underscore.js)或 express，看看它们使用什么约定，并考虑遵循它。

*   *如果*两种约定均等使用，*则*遵从您的个人喜好。

*   *如果*您没有任何个人喜好，请*掷*硬币。

*   *如果*你没有硬币，*那么*啤酒就在我身上；）

* * *

## 回答 #14

> 赞同：14
> 
> 时间：2012-11-01T03:49:09.590

我不确定这在当今世界是否相关，但双引号过去用于需要处理控制字符的内容，而单引号用于不需要处理的字符串。

编译器将对双引号字符串运行字符串操作，同时保持单引号字符串字面上不变。这曾经导致“优秀”开发人员选择对不包含控制字符的字符串使用单引号，例如`\n`or `\0`（不在单引号内处理），并在需要解析字符串时使用双引号（在 CPU 周期中花费少许处理字符串）。

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2014-02-27T15:20:56.077

如果您使用的是[JSHint](http://www.jshint.com/)，那么如果您使用双引号字符串，它将引发错误。

我通过 AngularJS 的 Yeoman 脚手架使用它，但也许有某种方式可以配置它。

顺便说一句，当您将 HTML 处理为 JavaScript 时，使用单引号会更容易：

```
var foo = '<div class="cool-stuff">Cool content</div>'; 
```

并且至少 JSON 使用双引号来表示字符串。

没有任何简单的方法可以回答您的问题。

* * *

## 回答 #16

> 赞同：11
> 
> 时间：2009-07-26T10:40:45.993

JavaScript 中的单引号和双引号没有任何区别。

规范很重要：

也许存在性能差异，但它们绝对是最小的，并且可以根据浏览器的实现随时更改。除非您的 JavaScript 应用程序有数十万行长，否则进一步讨论是徒劳的。

这就像一个基准，如果

```
a=b; 
```

比

```
a = b; 
```

（额外的空格）

今天，在特定的浏览器和平台等。

* * *

## 回答 #17

> 赞同：11
> 
> 时间：2013-11-19T15:20:05.740

谈论性能，报价永远不会成为您的瓶颈。但是，两种情况下的性能是相同的。

谈到编码速度，如果您`'`用于分隔字符串，则需要转义`"`引号。您更有可能需要`"`在字符串内部使用。例子：

```
// JSON Objects:
var jsonObject = '{"foo":"bar"}';

// HTML attributes:
document.getElementById("foobar").innerHTML = '<input type="text">'; 
```

然后，我更喜欢用它`'`来分隔字符串，所以我必须转义更少的字符。

* * *

## 回答 #18

> 赞同：11
> 
> 时间：2013-11-22T03:59:33.477

使用单引号的一个（愚蠢的）原因是它们不需要您按 shift 键来键入它们，而双引号则需要。（我假设平均字符串不需要转义，这是一个合理的假设。）现在，假设我每天编写 200 行代码。也许在这 200 行中，我有 30 个引号。输入双引号可能比输入单引号多花 0.1 秒的时间（因为我必须按下 shift 键）。然后在任何一天，我都会浪费 3 秒。如果我以这种方式编码每年 200 天，持续 40 年，那么我浪费了我生命中的 6.7 小时。深思熟虑。

* * *

## 回答 #19

> 赞同：11
> 
> 时间：2016-03-08T14:51:54.507

> 检查利弊

**赞成单引号**

*   减少视觉混乱。
*   生成 HTML：HTML 属性通常由双引号分隔。

```
elem.innerHTML = '<a href="' + url + '">Hello</a>';
```

但是，单引号在 HTML 中同样合法。

```
elem.innerHTML = "<a href='" + url + "'>Hello</a>";
```

此外，内联 HTML 通常是一种反模式。首选模板。

*   生成 JSON：JSON 中只允许使用双引号。

```
myJson = '{ "hello world": true }';
```

同样，您不必以这种方式构造 JSON。JSON.stringify() 通常就足够了。如果没有，请使用模板。

**赞成双引号**

*   如果您没有颜色编码，则更容易发现双打。就像在控制台日志或某种查看源设置中一样。
*   与其他语言的相似之处：在 shell 编程（Bash 等）中，存在单引号字符串文字，但在其中不解释转义。C 和 Java 对字符串使用双引号，对字符使用单引号。
*   如果您希望代码是有效的 JSON，则需要使用双引号。

**赞成双方**

两者在 JavaScript 中没有区别。因此，您可以使用目前方便的任何东西。例如，以下字符串文字都产生相同的字符串：

```
 "He said: \"Let's go!\""
    'He said: "Let\'s go!"'
    "He said: \"Let\'s go!\""
    'He said: \"Let\'s go!\"'
```

内部字符串用单引号，外部字符串用双引号。这使您可以将内部常量与要显示给用户（或写入磁盘等）的字符串区分开来。显然，您应该避免将后者放入您的代码中，但这并不总是可以做到的。

* * *

## 回答 #20

> 赞同：9
> 
> 时间：2012-04-12T01:20:53.857

作为从双引号转换为单引号的原因，您可能要考虑的另一件事是服务器端脚本的流行度增加。使用 PHP 时，您可以使用 PHP 中的字符串和变量传递变量和解析 JavaScript 函数。

如果您编写一个字符串并为您的 PHP 使用双引号，您将不必转义任何单引号，PHP 将自动为您检索变量的值。

示例：我需要使用服务器中的变量运行 JavaScript 函数。

```
public static function redirectPage( $pageLocation )
{
    echo "<script type='text/javascript'>window.location = '$pageLocation';</script>";
} 
```

这为我在处理连接字符串时节省了很多麻烦，并且我可以有效地从 PHP 调用 JavaScript。这只是一个例子，但这可能是程序员在 JavaScript 中默认使用单引号的几个原因之一。

[引用 PHP 文档](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.double)：

> 双引号字符串最重要的特性是变量名将被扩展。有关详细信息，请参阅字符串解析。

* * *

## 回答 #21

> 赞同：8
> 
> 时间：2015-02-11T09:28:30.570

使用[CoffeeScript](https://en.wikipedia.org/wiki/CoffeeScript)时，我使用双引号。我同意你应该选择其中一个并坚持下去。CoffeeScript 在使用双引号时为您提供插值。

```
"This is my #{name}" 
```

[ECMAScript 6](https://en.wikipedia.org/wiki/ECMAScript#6th_Edition_-_ECMAScript_2015)对模板字符串使用反引号 (`)。这可能有一个很好的理由，但是在编码时，将字符串文字字符从引号或双引号更改为反引号以获取插值功能可能很麻烦。CoffeeScript 可能并不完美，但在任何地方使用相同的字符串文字字符（双引号）并且始终能够进行插值是一个不错的功能。

```
`This is my ${name}` 
```

* * *

## 回答 #22

> 赞同：7
> 
> 时间：2008-10-28T10:43:19.450

有些人声称看到了性能差异：[旧邮件列表线程](http://lists.evolt.org/pipermail/javascript/2003-November/006168.html)。但我找不到任何一个可以确认的。

主要是查看您在字符串中使用了哪种引号（双引号或单引号）。它有助于保持较低的转义次数。例如，当您在字符串中处理 HTML 内容时，使用单引号会更容易，这样您就不必转义属性周围的所有双引号。

* * *

## 回答 #23

> 赞同：7
> 
> 时间：2010-04-29T15:30:29.563

我一直在运行以下大约 20 次。而且双引号的速度似乎快了 20%。

有趣的是，如果你改变第 2 部分和第 1 部分，单引号会快 20% 左右。

```
//Part1
var r='';
var iTime3 = new Date().valueOf();
for(var j=0; j<1000000; j++) {
    r+='a';
}
var iTime4 = new Date().valueOf();
alert('With single quote : ' + (iTime4 - iTime3));  

//Part 2                
var s="";
var iTime1 = new Date().valueOf();
for(var i=0; i<1000000; i++) {
    s += "a";
}
var iTime2 = new Date().valueOf();
alert('With double quote: ' + (iTime2 - iTime1)); 
```

* * *

## 回答 #24

> 赞同：6
> 
> 时间：2009-07-24T18:55:51.953

当不能使用单引号时，我会使用双引号，反之亦然：

```
"'" + singleQuotedValue + "'"
'"' + doubleQuotedValue + '"' 
```

代替：

```
'\'' + singleQuotedValue + '\''
"\"" + doubleQuotedValue + "\"" 
```

* * *

## 回答 #25

> 赞同：6
> 
> 时间：2020-01-13T02:04:56.483

现在是 2020 年，我们应该考虑 JavaScript 的第三种选择：所有内容的单个反引号。

这可以在任何地方使用，而不是单引号或双引号。

它可以让你做所有的事情！

1.  **在其中嵌入单引号：** `这很棒！`

2.  **在其中嵌入双引号：** `它“真的”很棒！`

3.  **使用字符串插值：** `It's "${better}" than great!`

4.  **它允许多行：** `

    这

    使

    JavaScript

    更好的！

`

替换其他两个字符串时也不会造成任何性能损失： *[反引号 (``) 是否比 JavaScript 中的其他字符串慢？](https://medium.com/javascript-in-plain-english/are-backticks-slower-than-other-strings-in-javascript-ce4abf9b9fa)*

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2011-09-18T05:22:02.083

在阅读了所有说它可能更快或可能有优势的答案之后，我会说双引号更好或者也可能更快，因为[Google Closure 编译器](http://closure-compiler.appspot.com/home)将单引号转换为双引号。

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2013-07-21T06:58:28.360

如果您在 JavaScript 和 C# 之间来回切换，最好训练您的手指以适应双引号的常见约定。

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2008-10-28T12:49:22.067

严格来说没有区别，因此保持转义数较低主要取决于品味和字符串中的内容（或者 JavaScript 代码本身是否在字符串中）。

速度差异图例可能来自 PHP 世界，其中两个引号具有不同的行为。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2014-06-05T07:06:12.737

如果您的 JavaScript 源代码是

```
elem.innerHTML="<img src='smily' alt='It\'s a Smily' style='width:50px'>"; 
```

HTML 源代码将是：

```
<img src="smiley" alt="It's a Smiley" style="width:50px"> 
```

或者对于 HTML5

```
<img src=smiley alt="It's a Smiley" style=width:50px> 
```

JavaScript 允许这样的数组：

```
var arr=['this','that']; 
```

但是如果你把它串起来，那将是出于兼容性的原因：

```
JSON=["this","that"] 
```

我确信这需要一些时间。

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2014-06-12T19:47:04.357

只是为了增加我的[两分钱](https://en.wiktionary.org/wiki/two_cents#Noun)：几年前在使用 JavaScript 和 PHP 时，我已经习惯于使用单引号，因此我可以键入转义字符 ('') 而不必将其转义。我通常在输入带有文件路径等的[原始字符串时使用它。](http://en.wikipedia.org/wiki/String_literal#Raw_strings)

无论如何，我的约定最终变成了在标识符类型的原始字符串上使用单引号，例如`if (typeof s == 'string') ...`（其中永远不会使用转义字符 - 永远），以及*文本*的双引号，例如“嘿，怎么了？”。我还在注释中使用单引号作为印刷约定来显示标识符名称。这只是一个经验法则，我只在需要时才中断，例如在键入 HTML 字符串时`'<a href="#"> like so <a>'`（尽管您也可以在此处反转引号）。我也知道，在 JSON 的情况下，名称使用双引号 - 但除此之外，我个人更喜欢单引号，因为引号之间的文本*从*`document.createElement('div')`不需要转义 - 比如.

底线是，正如一些人提到/暗示的那样，选择一个约定，坚持它，并且只在必要时偏离。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2014-09-10T17:11:01.253

您可以使用单引号或双引号。

例如，这使您可以轻松地将 JavaScript 内容嵌套在 HTML 属性中，而无需转义引号。当您使用 PHP 创建 JavaScript 时也是如此。

总体思路是：如果可能，请使用不需要转义的引号。

更少的转义 = 更好的代码。

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2016-10-27T11:38:03.767

对我来说只是*时间*问题。每次我必须`Shift`在每次能够键入之前按下键时，我的生命都会损失几毫秒`"`。

我更喜欢`'`仅仅是因为你不必这样做！

除此之外，您可以`'`使用反斜杠转义内部单引号`\'`。

`console.log('Don\'t lose time'); // "Don't lose time"`

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2008-10-28T20:49:48.320

区别纯粹是风格上的。我曾经是一个双引号纳粹。现在我几乎在所有情况下都使用单引号。除了您的编辑器如何突出显示语法之外，没有任何实际区别。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2012-08-17T13:57:41.180

对我来说，如果我在[Vim](https://en.wikipedia.org/wiki/Vim_%28text_editor%29)编辑器中编写代码并且某些内容用单引号括起来，我可以双击以*仅*选择引号内的文本。另一方面，双引号包括引号，当我想做一些快速复制和粘贴时，我觉得很烦人。

例如，在 Vim 编辑器中双击 'myVar' 复制： >myVar< "myVar" 字面意思是复制： >"myVar"< 并且当我粘贴时，我必须删除两边的引号。

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2017-08-10T11:23:43.630

我大部分时间都使用单引号，因为在 PHP 中开发时，单引号字符串绝不会改变，这正是我想要的。当我使用

```
echo "$xyz"; 
```

在 PHP 中，$xyz 被评估，这*不是*我想要的。因此，当涉及到 Web 开发时，我总是使用`'`而不是。`"`因此，当涉及到 PHP/JavaScript 时，我至少要确保字符串的一致性。

不幸的是，这不能在 Java 或[Objective-C](https://en.wikipedia.org/wiki/Objective-C)中完成，其中`''`代表字符并`""`代表字符串。但这是另一个问题。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2009-05-02T10:59:10.457

我认为重要的是不要忘记，虽然 Internet Explorer 可能安装了零扩展/工具栏，但 Firefox 可能安装了一些扩展（例如，我只是想[Firebug](https://en.wikipedia.org/wiki/Firebug_%28software%29)）。这些扩展将对基准测试结果产生影响。

这并不重要，因为浏览器 X 在获取元素样式方面更快，而浏览器 Y 在渲染画布元素方面可能更快（因此浏览器“制造商”总是拥有最快的 JavaScript 引擎）。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2018-02-09T10:36:34.157

如果您使用 PHP 生成 JavaScript 代码，您应该使用以下声明。

```
let value = "<?php echo 'This is my message, "double quoted" - \'single quoted\' ?>"; 
```

输出将是：

```
This is my message, "double quoted" - 'single quoted' 
```

由于某些原因，建议在 PHP 中使用单引号而不是双引号。

对于 JavaScript 中的正常行为，建议使用单引号。

```
var value = 'This is my message';
document.getElementById('sample-text').innerHTML = value;
```

```
<span id="sample-text"></span>
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2020-01-30T00:05:47.920

我更喜欢使用单引号，`'`. 它更容易打字，看起来更好。

另外，让我们记住，直引号（单引号和双引号）在良好的排版中是一个错误。弯引号更可取，因此我更喜欢使用正确的字符，而不是转义直引号。

```
const message = 'That\'s a \'magic\' shoe.' // This is wrong
const message = 'That’s a ‘magic’ shoe.' // This is correct 
```

[https://practicaltypography.com/straight-and-curly-quotes.html](https://practicaltypography.com/straight-and-curly-quotes.html)

请问有人可以在 Visual Studio Code 中添加智能引用功能吗？

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2013-11-14T21:33:27.947

我认为这完全是方便/偏好的问题。

我更喜欢双引号，因为它与 C# 相匹配，这是我通常工作的环境：C# + JavaScript。

双引号超过单引号的一个可能原因是（我在我的项目代码中发现）：法语或其他一些语言大量使用单引号（实际上就像英语一样），所以如果由于某种原因你最终从服务器端（我知道这是不好的做法），那么单引号将错误地呈现。

在常规语言中使用双引号的可能性很低，因此我认为它更有可能不破坏某些东西。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2019-07-02T22:04:16.840

为了可读性，我个人更喜欢单引号。如果我整天盯着代码看，那么用单引号而不是双引号更容易看到单词。

更容易阅读，如下所示：

'易于阅读'

“更难阅读”

""最难读""

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2021-12-19T20:27:11.337

此外，规范（目前在[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript)中提到）似乎没有说明单引号和双引号之间的任何区别，除了关闭和一些未转义的几个字符。但是，模板文字 (`) 假定需要额外的解析/处理。

> 字符串文字是用单引号或双引号括起来的 0 个或多个 Unicode 代码点。Unicode 代码点也可以由转义序列表示。**除了结束引号代码点**、`U+005C (REVERSE SOLIDUS)`、`U+000D (CARRIAGE RETURN)`和`U+000A (LINE FEED)`. 任何代码点都可能以转义序列的形式出现。字符串文字评估为 ECMAScript 字符串值...

来源：[https ://tc39.es/ecma262/#sec-literals-string-literals](https://tc39.es/ecma262/#sec-literals-string-literals)

* * *

## 回答 #42

> 赞同：-1
> 
> 时间：2012-08-30T09:33:13.237

正如其他答复所述，它们几乎相同。但我会尝试添加更多。

1.  一些高效的算法使用字符数组来处理字符串。这些算法（浏览器编译器等）会在 (#39)`"`之前先看到 (#34)，`'`因此根据您的数据结构节省几个 CPU 周期。
2.  `"`被反[XSS](https://en.wikipedia.org/wiki/Cross-site_scripting)引擎逃脱

* * *

## 回答 #43

> 赞同：-2
> 
> 时间：2012-05-06T17:41:19.460

对于跨不同语言使用 JavaScript 代码，我发现单引号始终需要较少的代码调整。

双引号支持多行字符串。

* * *

## 回答 #44

> 赞同：-4
> 
> 时间：2013-09-27T15:32:53.123

最佳做法是在需要时先使用双引号 ("")，然后使用单引号 ('')。原因是，如果您曾经使用服务器端脚本，如果您使用单引号而不是双引号，您将无法从服务器中提取内容（例如来自数据库的 SQL 查询）。

# xcode - Xcode 预处理器宏

> ID：242817
> 
> 赞同：3
> 
> 时间：2008-10-28T10:35:24.473
> 
> 标签：xcode, macros, preprocessor

在 Xcode 中，我可以在项目设置中编辑我的预处理器宏。我想创建一个引用环境变量的宏。基本上，我希望能够在我的代码中引用 $SRC_ROOT。我目前在宏中拥有的是：

```
SRC_ROOT=${SRC_ROOT} 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-28T23:43:40.387

在 Xcode 构建设置中，您实际上并没有引用环境变量值。相反，您指的是*构建设置*值。其语法是 Makefile 样式`$(SETTING_NAME)`，而不是您在上面使用的 shell 样式`${SETTING_NAME}`。

所以你想要做的是添加

```
SRC_ROOT="$(SRCROOT)" 
```

到您的**预处理器宏**构建设置。

作为额外的好处，如果您知道您的宏不会影响预编译前缀文件的内容，那么您应该使用**Preprocessor Macros Not Used in Precompiled Headers而不是****Preprocessor** Macros 。

 **这样，您可以改进`pch`项目中不同目标甚至不同项目之间预编译前缀标头（由文件定义）的共享。 [Technical Note 2190: Speeding your Xcode Builds](http://developer.apple.com/technotes/tn2007/tn2190.html "加速您的 Xcode 构建")对此进行了更详细的说明：如果您使用相同的前缀文件名和内容，并在多个项目中使用相同的构建设置进行构建，您可以获得显着的构建性能改进，因为 Xcode 将识别何时可以重用现有的预编译前缀文件。

# sql - 为什么有人会使用 WHERE 1=1 AND 在 SQL 子句中？

> ID：242822
> 
> 赞同：292
> 
> 时间：2008-10-28T10:37:04.780
> 
> 标签：sql, dynamic-sql

为什么有人会`WHERE 1=1 AND <conditions>`在 SQL 子句中使用（无论是通过连接字符串获得的 SQL，还是视图定义）

我在某处看到这将用于防止 SQL 注入，但这似乎很奇怪。

如果有注入`WHERE 1 = 1 AND injected OR 1=1`将有相同的结果`injected OR 1=1`。

稍后编辑：视图定义中的用法如何？

* * *

谢谢您的回答。

不过，我不明白为什么有人会使用这种结构来定义视图，或者在存储过程中使用它。

以此为例：

```
CREATE VIEW vTest AS
SELECT FROM Table WHERE 1=1 AND table.Field=Value 
```

* * *

## 回答 #1

> 赞同：381
> 
> 时间：2008-10-28T10:39:59.423

如果条件列表在编译时未知，而是在运行时构建，则您不必担心是否有一个或多个条件。你可以像这样生成它们：

```
and <condition> 
```

并将它们连接在一起。在`1=1`开头，首字母`and`有一些关联。

我从未见过它用于任何类型的注射保护，正如你所说，它似乎没有多大帮助。我*已经*看到它被用作实现便利。SQL 查询引擎最终会忽略它，`1=1`因此它应该不会影响性能。

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2008-10-28T10:53:21.270

只需在 Greg 的答案中添加示例代码：

```
dim sqlstmt as new StringBuilder
sqlstmt.add("SELECT * FROM Products")
sqlstmt.add(" WHERE 1=1") 

''// From now on you don't have to worry if you must 
''// append AND or WHERE because you know the WHERE is there
If ProductCategoryID <> 0 then
  sqlstmt.AppendFormat(" AND ProductCategoryID = {0}", trim(ProductCategoryID))
end if
If MinimunPrice > 0 then
  sqlstmt.AppendFormat(" AND Price >= {0}", trim(MinimunPrice))
end if 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-10-28T10:43:05.503

我已经看到当条件的数量可以变化时使用它。

您可以使用“AND”字符串连接条件。然后，不是计算您传入的条件的数量，而是在您的股票 SQL 语句的末尾放置一个“WHERE 1=1”并抛出连接的条件。

基本上，它使您不必对条件进行测试，然后在它们之前添加一个“WHERE”字符串。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2008-10-28T10:40:05.493

总是知道您的 WHERE 子句已定义并允许您继续添加条件而无需检查它是否是第一个条件，这似乎是一种懒惰的方式。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2013-02-20T14:37:24.097

间接相关：当使用 1=2 时：

```
CREATE TABLE New_table_name 
as 
select * 
FROM Old_table_name 
WHERE 1 = 2; 
```

这将创建一个与旧表具有相同架构的新表。（如果您想加载一些数据进行比较，非常方便）

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2008-10-28T10:40:46.833

1 = 1 表达式常用于生成的 sql 代码中。该表达式可以简化 sql 生成代码，减少条件语句的数量。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2016-05-18T21:57:00.807

当我在数据库上测试或仔细检查事物时，我发现这种模式很有用，因此我可以非常快速地评论其他条件：

```
CREATE VIEW vTest AS
SELECT FROM Table WHERE 1=1 
AND Table.Field=Value
AND Table.IsValid=true 
```

变成：

```
CREATE VIEW vTest AS
SELECT FROM Table WHERE 1=1 
--AND Table.Field=Value
--AND Table.IsValid=true 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-10-28T12:13:03.183

实际上，我已经在 BIRT 报告中看到过这种东西。传递给 BIRT 运行时的查询格式如下：

```
select a,b,c from t where a = ? 
```

和“？” 在运行时被从下拉框中选择的实际参数值替换。下拉列表中的选项由以下方式给出：

```
select distinct a from t
union all
select '*' from sysibm.sysdummy1 
```

这样您就可以获得所有可能的值加上“ `*`”。如果用户`*`从下拉框中选择“”（意味着应选择 a 的所有值），则必须在运行之前（通过 Javascript）修改查询。

自从“？” 是一个位置参数，必须保留在那里才能让其他事情正常工作，Javascript 将查询修改为：

```
select a,b,c from t where ((a = ?) or (1==1)) 
```

这基本上消除了 where 子句的影响，同时仍然保留了位置参数。

我还看到了惰性编码器在动态创建 SQL 查询时使用的 AND 案例。

`select * from t`假设您必须动态创建一个以检查开头的查询：

*   名字是鲍勃；和
*   薪水> 20,000美元

有些人会用 WHERE 添加第一个，然后用 AND 添加后续的：

```
select * from t where name = 'Bob' and salary > 20000 
```

懒惰的程序员（这不一定是一个*坏*特性）不会区分添加的条件，他们会从`select * from t where 1=1`添加 AND 子句开始，然后添加子句。

```
select * from t where 1=1 and name = 'Bob' and salary > 20000 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2009-09-14T05:38:29.543

其中 1=0，这样做是为了检查表是否存在。不知道为什么使用 1=1。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2010-01-07T16:00:12.790

虽然我可以看到 1=1 对于生成的 SQL 很有用，但我在 PHP 中使用的一种技术是创建一个子句数组，然后执行

```
implode (" AND ", $clauses); 
```

从而避免出现前导或尾随 AND 的问题。显然，这仅在您知道您将拥有至少一个子句时才有用！

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2011-11-17T09:33:42.587

这是一个密切相关的示例：使用 SQL`MERGE`语句使用源表中的所有值更新目标表，其中没有要加入的公共属性，例如

```
MERGE INTO Circles
   USING 
      (
        SELECT pi
         FROM Constants
      ) AS SourceTable
   ON 1 = 1
WHEN MATCHED THEN 
  UPDATE
     SET circumference = 2 * SourceTable.pi * radius; 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2014-12-23T14:53:02.013

> 为什么有人会使用 WHERE 1=1 AND`<proper conditions>`

我[见过](https://stackoverflow.com/a/11329871/314291)朴素的框架做这样的事情（*blush*），因为这允许将惰性解析实践应用于 the`WHERE`和`AND`Sql 关键字。

例如（我在这里使用 C# 作为示例），考虑在 Sql 查询中对以下谓词进行条件解析`string builder`：

```
var sqlQuery = "SELECT * FROM FOOS WHERE 1 = 1"
if (shouldFilterForBars)
{
    sqlQuery = sqlQuery + " AND Bars > 3";
}
if (shouldFilterForBaz)
{
    sqlQuery = sqlQuery + " AND Baz < 12";
} 
```

的“好处”`WHERE 1 = 1`意味着不需要特殊代码：

*   对于**AND** - 是否应应用零、一个或两个谓词（Bars 和 Baz's），这将确定是否`AND`需要第一个。由于我们已经至少有一个带有 的谓词`1 = 1`，这意味着`AND`总是可以的。
*   对于根本没有谓词 - 如果谓词为零，则`WHERE`必须删除。但同样，我们可以偷懒，因为我们再次保证了至少一个谓词。

这显然是个坏主意，建议使用已建立的数据访问框架或[ORM](https://stackoverflow.com/a/11330095/314291)以这种方式解析可选和条件谓词。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2016-04-05T13:06:56.470

如果您来这里搜索`WHERE 1`，请注意`WHERE 1`和`WHERE 1=1`是相同的。`WHERE 1`很少使用，因为某些数据库系统考虑到它`WHERE 1`不是真正的布尔值而拒绝它。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-03-16T15:05:16.383

查看所有答案后，我决定进行一些实验，例如

```
SELECT
*
FROM MyTable

WHERE 1=1 
```

然后我检查了其他号码

```
WHERE 2=2
WHERE 10=10
WHERE 99=99 
```

ect 完成所有检查后，查询运行城镇是相同的。即使没有 where 子句。我不喜欢语法

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-02-16T07:22:40.707

这在您必须使用动态查询的情况下很有用，其中在 where 子句中您必须附加一些过滤器选项。就像如果您包含选项 0 状态为非活动状态，1 为活动状态。根据选项，只有两个可用选项（0 和 1），但如果要显示所有记录，可以方便地包含在 where close 1=1 中。请参见下面的示例：

```
Declare @SearchValue    varchar(8) 
Declare @SQLQuery varchar(max) = '
Select [FirstName]
    ,[LastName]
    ,[MiddleName]
    ,[BirthDate]
,Case
    when [Status] = 0 then ''Inactive''
    when [Status] = 1 then ''Active''
end as [Status]'

Declare @SearchOption nvarchar(100)
If (@SearchValue = 'Active')
Begin
    Set @SearchOption = ' Where a.[Status] = 1'
End

If (@SearchValue = 'Inactive')
Begin
    Set @SearchOption = ' Where a.[Status] = 0'
End

If (@SearchValue = 'All')
Begin
    Set @SearchOption = ' Where 1=1'
End

Set @SQLQuery = @SQLQuery + @SearchOption

Exec(@SQLQuery); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-03-19T05:43:36.750

我通常在为具有许多用户可以选择的下拉值的报表构建动态 SQL 时这样做。由于用户可能会或可能不会从每个下拉列表中选择值，因此我们最终很难确定哪个条件是第一个 where 子句。所以我们最后用 a 填充查询，`where 1=1`然后添加所有 where 子句。

就像是

```
select column1, column2 from my table where 1=1 {name} {age}; 
```

然后我们将像这样构建 where 子句并将其作为参数值传递

```
string name_whereClause= ddlName.SelectedIndex > 0 ? "AND name ='"+ ddlName.SelectedValue+ "'" : ""; 
```

由于我们在运行时不知道 where 子句的选择，所以这有助于我们确定是否包含`'AND' or 'WHERE'.`

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-12-19T14:25:08.937

使“where 1=1”成为所有查询的标准还可以通过将其替换为 where 1 = 0 来轻松验证 sql，这在您有成批的命令/文件时很方便。

还可以很容易地找到任何查询的 from/join 部分的结尾。如果缩进正确，即使是带有子查询的查询。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-05T18:44:14.893

我第一次遇到这个是用 ADO 和经典的 asp，我得到的答案是：**性能。** 如果你做一个直线

`Select * from tablename`

并将其作为 sql 命令/文本传递，您将获得显着的性能提升

`Where 1=1`

补充说，这是一个明显的差异。与第一个条件满足后立即返回表头有关，或者其他一些疯狂的事情，无论如何，它确实加快了速度。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-08-10T15:50:14.400

使用谓词 like`1=1`是一种正常的提示，有时用于强制访问计划使用或不使用索引扫描。使用它的原因是当您在 where 子句中使用具有许多谓词的多嵌套联接查询时，有时即使使用所有索引也会导致访问计划读取每个表 - 全表扫描。这只是 DBA 用来欺骗 dbms 使用更有效路径的众多提示之一。只是不要扔进去；您需要一个 dba 来分析查询，因为它并不总是有效。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-06-12T02:31:31.113

这是一个用例......但是我不太关心为什么我应该使用或不使用 1 = 1 的技术细节。我正在编写一个函数，使用 pyodbc 从 SQL Server 检索一些数据。我正在寻找一种`where`在我的代码中的关键字之后强制填充的方法。这确实是一个很好的建议：

```
if _where == '': _where = '1=1'
...
...
...
cur.execute(f'select {predicate} from {table_name} where {_where}') 
```

原因是我无法在 _where 子句变量中同时实现关键字“where”。所以，我认为使用任何评估为 true 的虚拟条件都可以作为填充物。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-04-16T17:41:41.307

在生产代码中看到这个，请前辈帮忙。

他们的回答：

- 我们使用 1=1 所以当我们必须添加一个新条件时，我们可以输入

```
and <condition> 
```

继续做下去。

# javascript - JavaScript for...in 与 for

> ID：242841
> 
> 赞同：467
> 
> 时间：2008-10-28T10:42:10.480
> 
> 标签：javascript

你认为 for...in 和 for 循环有很大的不同吗？您更喜欢使用哪种“for”，为什么？

假设我们有一个关联数组：

```
var myArray = [{'key': 'value'}, {'key': 'value1'}]; 
```

所以我们可以迭代：

```
for (var i = 0; i < myArray.length; i++) 
```

和：

```
for (var i in myArray) 
```

我看不出有什么大的不同。是否存在性能问题？

* * *

## 回答 #1

> 赞同：550
> 
> 时间：2008-10-28T11:01:17.383

选择应该基于哪个成语最容易理解。

使用以下方法迭代数组：

```
for (var i = 0; i < a.length; i++)
   //do stuff with a[i] 
```

用作关联数组的对象使用以下方法迭代：

```
for (var key in o)
  //do stuff with o[key] 
```

除非您有惊天动地的理由，否则请坚持既定的使用模式。

* * *

## 回答 #2

> 赞同：163
> 
> 时间：2008-10-28T15:39:08.103

Douglas Crockford 在[JavaScript: The Good Parts](http://oreilly.com/catalog/9780596517748/) (page 24) 中建议避免使用该`for in`语句。

如果您使用`for in`循环对象中的属性名称，则结果没有排序。更糟糕的是：你可能会得到意想不到的结果；它包括从原型链继承的成员和方法的名称。

除了属性之外的所有内容都可以使用 过滤掉`.hasOwnProperty`。此代码示例执行您最初可能想要的操作：

```
for (var name in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, name)) {
        // DO STUFF
    }
} 
```

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2009-08-04T17:57:22.203

## 仅供参考 - jQuery 用户

* * *

jQuery 的`each(callback)`方法`for( ; ; )`默认使用循环，`for( in )` *只有*长度为`undefined`.

因此，我会说在使用此功能时假设正确的顺序是安全的。

**示例**：

```
$(['a','b','c']).each(function() {
    alert(this);
});
//Outputs "a" then "b" then "c" 
```

使用它的缺点是，如果您正在执行一些非 UI 逻辑，您的函数将不太适合其他框架。该`each()`函数可能最好保留用于 jQuery 选择器，`for( ; ; )`否则可能是可取的。

* * *

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-10-28T11:03:14.697

根据您使用的循环类型和浏览器，存在性能差异。

例如：

```
for (var i = myArray.length-1; i >= 0; i--) 
```

在某些浏览器上几乎快两倍：

```
for (var i = 0; i < myArray.length; i++) 
```

但是，除非您的阵列非常庞大，或者您不断循环它们，否则它们都足够快。我严重怀疑数组循环是您项目中的瓶颈（或任何其他项目）

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2011-06-22T15:59:24.933

请注意，本机 Array.forEach 方法现在已[得到广泛支持](http://kangax.github.com/es5-compat-table/)。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2012-01-11T21:03:09.847

**所有主要浏览器的 2012 当前版本的更新答案**- Chrome、Firefox、IE9、Safari 和 Opera 支持 ES5 的本机 array.forEach。

除非你有某些理由原生支持 IE8（记住 ES5-shim 或 Chrome 框架可以提供给这些用户，这将提供适当的 JS 环境），否则简单地使用语言的正确语法会更干净：

```
myArray.forEach(function(item, index) {
    console.log(item, index);
}); 
```

[array.forEach() 的完整文档位于 MDN。](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach)

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2008-10-28T15:33:02.000

我的第二意见是您应该根据需要选择迭代方法。我建议您实际上**永远**不要循环遍历`Array`具有`for in`结构的本机。它慢得多，**而且**正如 Chase Seibert 刚才指出的那样，它与 Prototype 框架不兼容。

[如果您使用 JavaScript，则绝对应该看看不同循环样式](http://blogs.oracle.com/greimer/entry/best_way_to_code_a)的出色基准。不要做早期的优化，但你应该把这些东西放在脑后的某个地方。

我会`for in`用来获取对象的所有属性，这在调试脚本时特别有用。例如，当我探索不熟悉的对象时，我喜欢使用这条线：

```
l = ''; for (m in obj) { l += m + ' => ' + obj[m] + '\n' } console.log(l); 
```

它将整个对象的内容（连同方法主体）转储到我的 Firebug 日志中。**非常**方便。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2011-06-22T16:05:13.787

数组稀疏时，两者不一样。

```
var array = [0, 1, 2, , , 5];

for (var k in array) {
  // Not guaranteed by the language spec to iterate in order.
  alert(k);  // Outputs 0, 1, 2, 5.
  // Behavior when loop body adds to the array is unclear.
}

for (var i = 0; i < array.length; ++i) {
  // Iterates in order.
  // i is a number, not a string.
  alert(i);  // Outputs 0, 1, 2, 3, 4, 5
  // Behavior when loop body modifies array is clearer.
} 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2012-03-12T15:14:36.867

**使用 forEach 跳过原型链**

[只是对上面@nailer 答案](https://stackoverflow.com/a/8826575/648802)的快速补充，将 forEach 与 Object.keys 一起使用意味着您可以避免迭代原型链，而无需使用 hasOwnProperty。

```
var Base = function () {
    this.coming = "hey";
};

var Sub = function () {
    this.leaving = "bye";
};

Sub.prototype = new Base();
var tst = new Sub();

for (var i in tst) {
    console.log(tst.hasOwnProperty(i) + i + tst[i]);
}

Object.keys(tst).forEach(function (val) {
    console.log(val + tst[val]);
}); 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-07-24T08:44:47.977

这是我做的事情。

```
function foreach(o, f) {
 for(var i = 0; i < o.length; i++) { // simple for loop
  f(o[i], i); // execute a function and make the obj, objIndex available
 }
} 
```

这就是你将如何使用它
这将适用于数组和对象（例如 HTML 元素列表）

```
foreach(o, function(obj, i) { // for each obj in o
  alert(obj); // obj
  alert(i); // obj index
  /*
    say if you were dealing with an html element may be you have a collection of divs
  */
  if(typeof obj == 'object') { 
   obj.style.marginLeft = '20px';
  }
}); 
```

我刚做了这个，所以我愿意接受建议:)

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-10-28T10:55:55.587

我会根据我想要引用这些项目的方式使用不同的方法。

如果您只想要当前项目，请使用 foreach。

如果您需要索引器进行相对比较，请使用 for。（即，这与上一个/下一个项目相比如何？）

我从未注意到性能差异。我会等到出现性能问题后再担心。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-28T10:54:53.857

使用*for (var i in myArray)*您也可以遍历对象，*i*将包含键名，您可以通过*myArray[i]*访问该属性。此外，您将添加到对象的任何方法也将包含在循环中，即，如果您使用任何外部框架（如 jQuery 或原型），或者如果您直接向对象原型添加方法，在某一点上*我*会指出那些方法。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2012-05-08T18:13:32.860

小心！

例如，如果您有多个脚本标签，并且您正在搜索标签属性中的信息，则必须将 .length 属性与 for 循环一起使用，因为它不是一个简单的数组，而是一个 HTMLCollection 对象。

[https://developer.mozilla.org/en/DOM/HTMLCollection](https://developer.mozilla.org/en/DOM/HTMLCollection)

如果您使用 foreach 语句 for(var i in yourList) 它将在大多数浏览器中返回 HTMLCollection 的属性和方法！

```
var scriptTags = document.getElementsByTagName("script");

for(var i = 0; i < scriptTags.length; i++)
alert(i); // Will print all your elements index (you can get src attribute value using scriptTags[i].attributes[0].value)

for(var i in scriptTags)
alert(i); // Will print "length", "item" and "namedItem" in addition to your elements! 
```

即使 getElementsByTagName 应该返回一个 NodeList，大多数浏览器也会返回一个 HTMLCollection： [https ://developer.mozilla.org/en/DOM/document.getElementsByTagName](https://developer.mozilla.org/en/DOM/document.getElementsByTagName)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-28T15:16:55.513

数组上的 for in 循环与 Prototype 不兼容。如果您认为将来可能需要使用该库，那么坚持使用 for 循环是有意义的。

[http://www.prototypejs.org/api/array](http://www.prototypejs.org/api/array)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-28T15:45:53.003

我已经看到使用对象、原型和数组的“for each”问题

我的理解是 for each 用于对象的属性而不是数组

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2010-06-26T00:20:24.280

如果你真的想加速你的代码，那又如何呢？

```
for( var i=0,j=null; j=array[i++]; foo(j) ); 
```

这有点像在 for 语句中包含 while 逻辑，而且它的冗余度较低。Firefox 也有 Array.forEach 和 Array.filter

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2015-05-09T13:05:03.353

根据 jsperf 的更短和最好的代码是

```
keys  = Object.keys(obj);
for (var i = keys.length; i--;){
   value = obj[keys[i]];// or other action
} 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-02-09T13:42:10.493

**for(;;)**用于**数组**：[20,55,33]

**for..in**用于**对象**：{x:20,y:55:z:33}

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2012-04-28T13:55:26.130

使用 Array().forEach 循环来利用并行性

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-10-09T18:51:07.867

当心！！！我在 Mac OS 中使用 Chrome 22.0，但对于每种语法都有问题。

我不知道这是浏览器问题、javascript 问题还是代码中的一些错误，但这很奇怪。在对象之外它完美地工作。

```
var MyTest = {
    a:string = "a",
    b:string = "b"
};

myfunction = function(dicts) {
    for (var dict in dicts) {
        alert(dict);
        alert(typeof dict); // print 'string' (incorrect)
    }

    for (var i = 0; i < dicts.length; i++) {
        alert(dicts[i]);
        alert(typeof dicts[i]); // print 'object' (correct, it must be {abc: "xyz"})
    }
};

MyObj = function() {
    this.aaa = function() {
        myfunction([MyTest]);
    };
};
new MyObj().aaa(); // This does not work

myfunction([MyTest]); // This works 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-11-21T15:12:14.900

两者之间有一个重要的区别。for-in 迭代对象的属性，因此当 case 是一个数组时，它不仅会迭代其元素，还会迭代它具有的“删除”函数。

```
for (var i = 0; i < myArray.length; i++) { 
    console.log(i) 
}

//Output
0
1

for (var i in myArray) { 
    console.log(i) 
} 

// Output
0 
1 
remove 
```

您可以将 for-in 与`if(myArray.hasOwnProperty(i))`. 尽管如此，在遍历数组时，我总是更喜欢避免这种情况，而只使用 for(;;) 语句。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-01-02T15:19:02.373

尽管它们都非常相似，但还是有一点区别：

```
var array = ["a", "b", "c"];
array["abc"] = 123;
console.log("Standard for loop:");
for (var index = 0; index < array.length; index++)
{
  console.log(" array[" + index + "] = " + array[index]); //Standard for loop
} 
```

在这种情况下，输出是：

循环标准：

数组[0] = A

数组[1] = B

数组[2] = C

```
console.log("For-in loop:");
for (var key in array)
{
  console.log(" array[" + key + "] = " + array[key]); //For-in loop output
} 
```

而在这种情况下，输出是：

FOR-IN 循环：

数组[1] = B

数组[2] = C

数组[10] = D

数组[ABC] = 123

# c# - 使用 Soap 标头处理错误

> ID：242847
> 
> 赞同：1
> 
> 时间：2008-10-28T10:45:11.207
> 
> 标签：c#, .net, web-services, soap, error-handling

我们正在开发一种新的 Web 服务，并正在研究在肥皂响应中返回错误的“最佳实践”。

我们正在研究创建一个错误响应对象，每个响应都将包含一个属性。然而，这似乎有点重，想知道是否可以使用 SOAP 标头来携带这些信息？您通常如何使用 SOAP 处理自定义错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T10:57:03.120

Soap 已经使用自定义标头来获取错误信息，您需要做的就是在服务器端抛出异常，并在客户端作为[SoapException](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soapexception.aspx)引发异常。

如果您想更好地控制异常消息/信息，可以在服务器端抛出 SoapExceptions。

编辑：有关请求的额外信息，可以使用自定义肥皂标题。这是[CodeProject 上的示例文章，](http://www.codeproject.com/KB/webservices/SOAPHeaderAuthentication.aspx)它使用自定义soap 标头进行身份验证，但自定义soap 标头可用于其他目的，例如发送不一定是错误条件的额外信息（可以是业务逻辑信息）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T10:57:55.143

SOAPFault 用于保存错误和状态信息，服务器在 HTTP 标头中返回 500 以将其声明为错误。

请参阅 W3.org 的规范

[http://www.w3.org/TR/2000/NOTE-SOAP-20000508/#_Toc478383507](http://www.w3.org/TR/2000/NOTE-SOAP-20000508/#_Toc478383507)

您可以设计自己的信息令牌，方法是把它放在soap 标题中，甚至放在返回结果的一个元素中，只要您为第三方清楚地记录它。但是，这不是引发错误的标准方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T10:59:06.623

我过去曾使用类似的技术进行复杂的操作。特别是当您需要（多个？）错误描述以及错误代码时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T16:27:21.333

Soap 标头用于带外信息，不应用于错误消息。此外，soap 标头不应在soap 响应中使用，因为：

*   如果 mustUnderstand 缺失或为 0，客户端可以安全地忽略它们。
*   如果 mustUnderstand 为 1，则客户端无法表示它不理解它（因为它是响应）。

是的，我知道一些 WS-* 标准在响应中描述了肥皂标题......

所以，

对严重到没有响应对象的错误使用肥皂故障。将状态标记添加到警告和信息消息的响应中。

# .net - 起订量 - 好的示例应用程序

> ID：242868
> 
> 赞同：7
> 
> 时间：2008-10-28T10:53:41.970
> 
> 标签：.net, testing, ado.net, mocking, moq

我知道有几个关于起订量教程的问题。但我想知道是否有任何示例应用程序在使用 ado.net 的 n 层业务应用程序的上下文中使用 moq。

我觉得 tutes 很好，但它们似乎并没有把所有东西都放在一起。因此，我正在寻找一个能够将全貌结合在一起的示例应用程序。

另外，我认为缺少专门处理模拟和测试数据访问层中的逻辑的示例。

干杯安东尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T17:13:17.507

*编辑 5/5/09：起订量已从此代码库中删除，因此您必须下载较旧的修订版 (140) 才能查看起订量内容。*

试用[SutekiShop](http://code.google.com/p/sutekishop/) - 使用 .NET 3.5、MVC、LINQ、Windsor 和 Moq。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T22:27:01.603

Moq, like all unit testing frameworks, should not have much a concept of n-tier-ness about it.

One would typically use unit testing to test each individual class one-at-a-time. When a particular class is a little more complex and relies on having references to component classes and calling methods on these component classes, one might use a mocking framework such as Moq to create these constituent components, and to have the class-under-test use these mocked components instead of the real deals.

It looks like you are looking for how to use Moq in integration testing, where you bring all the components together and test the whole shebang all at once, including the data-access components. For doing whole-shebang tests, typically you need the real components, not mocked versions of them.

# sql-server - 如何使应用程序与 SQL Server 2005 完全兼容？

> ID：242875
> 
> 赞同：0
> 
> 时间：2008-10-28T10:56:46.520
> 
> 标签：sql-server, sql-server-2005, smo, sqldmo

我们有一个使用 MSSQL 的应用程序，当我们移到 2005 年时，基本上我们建议我们的客户应用向后兼容包，仅此而已，但有人问我要在 2005 年做到 100% 兼容。我在想 1 . 兼容级别：SQL Server 2005 (90) 2\. 删除任何DMO引用，并替换为SMO 3\. 使用ADO连接

我不确定这是否是正确的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T11:20:10.997

其实你说的是两种不同的东西。

一种是将数据库更新到 SQL 2005 级别，以便能够使用只有那里可用的功能。通过设置兼容性级别可以轻松完成。但是，在这种情况下，SQL 2000 客户端可能会遇到问题。

其次是升级您的应用程序以仅使用 SQL 2005 相关库。这也很简单，基本上就是你写的步骤。在这种情况下，您的应用程序也可以使用 SQL 2000 数据库（除非您使用某些 SQL 2005 特定功能），因为这些库是向后兼容的。

结束语：无论哪种方式都与 SQL 2005*兼容*，唯一的区别是您可以使用或不使用 SQL 2005 的*特定功能*。

为什么不改成 SQL 2008 呢？[这是一个](https://stackoverflow.com/questions/189831/should-we-upgrade-to-sql-server-2005-or-2008)关于这个主题的线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T11:34:54.510

要查看您是否真的兼容，唯一的方法是在没有向后兼容包的 SQL 2005 服务器上运行您的应用程序。如果您有一个详尽的测试套件，它将有很大帮助，但您需要确保您的所有后端代码都能正常运行。

我曾在一个使用 SQL 2000 和 SQL 2005 的应用程序上工作过，该应用程序中唯一需要版本切换的部分是一些毛茸茸的反射代码，需要使用 SQL Server 的系统表在运行时动态发现表。我们的解决方案是使用动态 SQL，但您需要为您的应用程序和用户做出正确的选择。

如果您的应用程序可以在“开箱即用”的 SQL 2005 配置上正确运行，而无需应用任何向后兼容性修复程序，那么您的应用程序就是 100% SQL 2005 兼容的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T13:43:38.650

如果您有任何 DTS 包，则需要将它们转换为 SSIS 包才能完全兼容。

如果您真的想确保完全兼容，请在文档中查看哪些功能正在被弃用，如果您正在使用其中任何一个，请立即修复它们。

您还可以查看您拥有的任何可以使用 2000 年没有的枢轴功能的代码。旧代码可以工作，但枢轴代码将是更好的选择，并且可能更有效。其他新功能也是如此，请检查您如何解决它们并进行修复。要考虑的一个重要问题是，您是否可以使用新数据类型 varchar (max) 摆脱文本文件。然后在代码中查找要转换为 varchar 的位置以进行比较。

# c# - 如何解锁被 .NET 中的进程锁定的文件

> ID：242882
> 
> 赞同：16
> 
> 时间：2008-10-28T10:59:31.803
> 
> 标签：c#, temporary-files, file-locking

我希望我的应用程序清理它使用的所有临时文件，问题是并非所有临时文件都在我的控制之下，所以我只想“粗暴地”解锁它们以便以编程方式删除它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T11:14:04.410

看看[这篇](http://www.codeguru.com/Cpp/W-P/files/fileio/article.php/c1287/#more)文章。我认为您将很难在 C# 中本地执行此操作，即使使用互操作，但编写 C++/CLI 包装程序集可能是一个很好的折衷方案。另请注意，用户需要拥有 SE_DEBUG 权限才能使其正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-28T12:26:36.213

我也一直在为此苦苦挣扎，最终只好使用 Unlocker 的命令行实现。就我而言，它必须每天运行多次，最终每天解锁数千个文件而没有任何问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T11:09:15.153

当然，您的应用程序想要清理它拥有的临时文件，然后您可以完全控制解锁这些文件并删除它们！

如果您想删除所有 TEMP 文件，无论是属于您的应用程序还是其他文件，您都应该非常小心。原始应用程序可能应用了锁，因为它想使用该文件！

如果你真的需要，你总是可以生成一个命令行应用程序，而不是试图复制现有工具的功能，这在 C# 中是很困难的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T13:19:42.723

在 MSDN 论坛上查看此[线程。](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/9e2044c5-ae5d-4552-a335-01cc567dfc58/)有足够的信息来做你想做的事，但不推荐。

# windows - 需要注册的DLL，用于不同的程序

> ID：242884
> 
> 赞同：0
> 
> 时间：2008-10-28T10:59:45.563
> 
> 标签：windows, dll, installation

**如果这些程序使用需要注册**的相同 DLL，您如何组织安装不同的程序。

问题：如果用户卸载稍后安装的程序，其他程序将停止工作，因为注册表项现在指向丢失的 DLL。

一种可能的解决方案是将公共 DLL 放在一个公共文件夹中 - 可能在 Application Data 或 Program Files\Company Name\ 下，然后使用 Windows 的共享文件计数机制。

你怎么处理这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T11:22:19.417

它通常按照您已经描述的方式进行处理：将 DLL 放入程序文件文件夹中公共文件下方的公共文件夹中。

我主要创建一个包含此类 DLL 的合并模块，并在为不同程序创建设置时包含它。这样，DLL 将保持安装状态，直到最后一个使用它们的程序被卸载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T09:44:52.947

使用并排程序集的新 XP 部署模型。它支持独立的 COM 组件。

[http://msdn.microsoft.com/en-us/library/aa369732(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa369732(VS.85).aspx)

# c# - CUDA 驱动程序 API 与 CUDA 运行时

> ID：242894
> 
> 赞同：45
> 
> 时间：2008-10-28T11:03:26.880
> 
> 标签：c#, c++, cuda, gpgpu, cuda.net

编写 CUDA 应用程序时，您可以在驱动程序级别或运行时级别工作，如图所示（库是 CUFFT 和 CUBLAS 用于高级数学）：

[![CUDA层模型](https://i.stack.imgur.com/TD51p.jpg)](https://i.stack.imgur.com/TD51p.jpg)
[（来源：[tomshw.it](https://www.tomshw.it/guides/hardware/graphic/20080618/images/nvidia-CUDA,Q-7-111103-13.jpg)）]

我假设两者之间的权衡是提高低级 API 的性能，但以增加代码复杂性为代价。具体的区别是什么？有什么重要的事情是你不能用高级 API 做的？

我正在使用 CUDA.net 与 C# 进行互操作，它是作为驱动程序 API 的副本构建的。这鼓励在 C# 中编写大量相当复杂的代码，而使用运行时 API 的 C++ 等效代码会更简单。这样做有什么好处吗？我可以看到的一个好处是更容易将智能错误处理与其他 C# 代码集成。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-10-31T18:55:14.147

CUDA 运行时可以将您的 CUDA 内核编译和链接到可执行文件中。这意味着您不必将 cubin 文件与您的应用程序一起分发，或者处理通过驱动程序 API 加载它们。正如您所指出的，它通常更易于使用。

相比之下，驱动程序 API 更难编程，但提供了对 CUDA 使用方式的更多控制。程序员必须直接处理初始化、模块加载等。

显然，通过驱动程序 API 可以查询到比运行时 API 更详细的设备信息。例如，设备上可用的空闲内存只能通过驱动程序 API 查询。

来自 CUDA 程序员指南：

> 它由两个 API 组成：
> 
> *   称为 CUDA 驱动程序 API 的低级 API，
> *   在 CUDA 驱动程序 API 之上实现的称为 CUDA 运行时 API 的更高级别的 API。
> 
> 这些 API 是互斥的：应用程序应该使用其中一个或另一个。
> 
> CUDA 运行时通过提供隐式初始化、上下文管理和模块管理来简化设备代码管理。nvcc 生成的 C 主机代码基于 CUDA 运行时（参见第 4.2.5 节），因此链接到此代码的应用程序必须使用 CUDA 运行时 API。
> 
> 相比之下，CUDA 驱动程序 API 需要更多代码，更难编程和调试，但提供更好的控制级别并且与语言无关，因为它只处理 cubin 对象（参见第 4.2.5 节）。特别是，使用 CUDA 驱动程序 API 配置和启动内核更加困难，因为必须使用显式函数调用而不是第 4.2.3 节中描述的执行配置语法来指定执行配置和内核参数。此外，设备模拟（参见第 4.5.2.9 节）不适用于 CUDA 驱动程序 API。

API 之间没有明显的性能差异。你的内核如何使用内存以及它们在 GPU 上的布局方式（在扭曲和块中）将产生更明显的效果。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-03-25T22:48:36.430

我发现对于在多线程应用程序中部署库，驱动程序 API 提供的对 CUDA 上下文的控制至关重要。我的大多数客户都希望将 GPU 加速集成到现有应用程序中，而如今，几乎所有应用程序都是多线程的。由于我不能保证所有的 GPU 代码都会在同一个线程中被初始化、执行和释放，所以我不得不使用驱动 API。

我最初尝试在运行时 API 中进行各种变通方法都导致失败，有时以惊人的方式失败 - 我发现我可以通过从不同线程执行错误的 CUDA 调用集来反复、立即重启机器。

自从我们通过 Driver API 迁移所有内容后，一切都很好。

Ĵ

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-01T14:21:54.810

需要注意的几个重要事项：

首先，API 之间的差异仅适用于主机端代码。内核完全相同。在主机端，驱动程序 api 的复杂性非常微不足道，根本区别是：

在驱动程序 api 中，您可以访问运行时 api 中不可用的功能，例如上下文。

模拟器仅适用于为运行时 api 编写的代码。

哦，目前 cudpp 是一个非常方便的库，仅适用于运行时 api。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T16:39:48.810

参数对齐和驱动程序 API 存在一些实际问题。查看 CUDA 2.2 beta（或更高版本）文档以获取更多信息。

# java - Macintosh 上的 Swing GUI 问题

> ID：242896
> 
> 赞同：1
> 
> 时间：2008-10-28T11:03:36.380
> 
> 标签：java, macos, swing, netbeans

我是 Swing 的新手。

是否有与在 Mac 上自定义绘画操作相关的任何具体问题？

我在 Windows 上使用 NetBeans + Swing 开发了一个示例应用程序。它工作正常。但是如果我在 Mac 上运行相同的应用程序，面板的按钮标签不会出现在屏幕上。只有在特定组件上执行鼠标悬停操作时，它才会显示在屏幕上。

任何人都可以帮助我解决这个问题吗？

提前致谢。萨基哈里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T11:32:58.303

由于 Swing 自己绘制了所有 UI，因此它并没有真正受到 Mac OS 的影响。不过也有例外。如果您允许 Java 使用原生菜单，该菜单的行为将与任何其他 Swing 菜单一样，但实际上它被转换为原生菜单功能（因此它将显示在屏幕顶部并表现得像原生 Mac OS X 菜单。 .. 作为程序员，您无需关心任何事情，但对于讨厌菜单出现在其他地方的 Mac 用户来说非常棒）。

我想您的问题可能是其他问题，但是如果我没有可使用的代码，则很难猜测。你能把问题分解成一个超最小的测试用例吗？例如，您是否可以只绘制一个 JFrame，在其中添加一个自定义按钮，以显示有问题的行为，并使用尽可能多的代码来绘制这个最小的 UI 并暴露问题？如果您在此处发布此代码，我会仔细研究它并尝试找出导致问题的原因以及如何解决它（我是一名毕业的 Java 程序员，但我也有多年的 Mac OS X 开发经验；所以这是我应该非常了解的两个知识领域，但我通常不会将它们结合起来，因为我不使用 Java 为 Mac OS X 开发）。

# project-management - 您如何报告您的项目状态？

> ID：242903
> 
> 赞同：7
> 
> 时间：2008-10-28T11:05:46.703
> 
> 标签：project-management

目前，我使用[“一页项目管理器”Excel 模板](http://www.onepageprojectmanager.com/oppm/resource.html)进行项目状态报告。它包含对上周工作的总结和对下周的预测。对于我们跟踪的所有重要任务，无论它们是否完成。一切都在一页上。我每周都会向所有参与者/利益相关者发送这份报告。（提示：我不在敏捷环境中工作）

您如何报告您的项目状态？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-28T11:06:45.283

状态报告应该简短（没有人喜欢坐在那里很长时间，而团队中的每个成员都在不断地谈论他们的状态）所以我是 SOFT 报告的忠实粉丝：

*   **成功**- 自上次状态会议以来您取得了什么成就：直接超出项目计划的任务。如果可能的话，我尽量避免报告 x% 完成——要么完成，要么没有完成。按 % 报告意味着任务将在*数周内*保持在 95% 。这也鼓励项目经理/技术主管将工作分解结构分解为不超过几天的任务。
*   **机会**- 您是否发现了任何机会：尚未考虑的对项目有帮助的事情（例如：找到了更好的编写脚本的方法，一个可以避免项目自己实现某些东西的库等）
*   **未来**的工作——从现在到下一次状态会议，你在做什么：同样，直接脱离项目计划。
*   **威胁**- 您是否发现任何会影响您完成预定工作的能力？例如：需求中以前未识别的漏洞，支持电话占用了您的大量时间，实现某些东西比预期的要难，等等。

理想情况下，我会尽量避免在大型项目会议上做这些事情，因为 90% 的材料与房间里一半的人无关。我喜欢在会前收集 SOFT 报告，在会前花一些时间查看它们，然后在实际会议期间讨论可能与每个人相关的具体问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-03T02:58:15.513

我的隔间外面有一块白板。上面是一张笑脸。当项目中的状态发生变化时，它会在皱眉、担忧的曲线、严峻的决心、微笑和咧嘴笑之间切换。旁边是一个箭头，表示最后一次更改。

虽然一开始只是个玩笑，但它实际上是让非技术同事了解项目所在位置的好方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-02T09:18:46.570

您为自己维护的项目管理信息是一回事，您向高级管理人员和客户展示的信息是另一回事。

如果您的客户从事食品运输业务，并让您为他们构建一个 ERP 应用程序，那么他们很可能不会理解敏捷/scrum 或prince2 的概念。

他们会明白什么？百分比和简单的英语。

这是我每周（通常在星期五下午）发送给客户和高级管理人员的“项目进度更新”（或“重点报告”）的示例。

===

2008 年 12 月 2 日重点报告

*   您的项目已完成 65%。
*   设计/模型阶段的所有任务已完成 100%。
*   编码阶段的任务完成了70%。
*   项目管理阶段已完成 45%。
*   到目前为止，质量控制阶段已完成 10%。
*   已完成35%的辅助任务

*   我们的错误日志目前包含 3 个未修复的错误（其中 1 个被标记为高优先级）。

*   错误日志还包含 3 个待批准的功能添加。

我们刚刚将最新作品上传到我们的暂存位置供您查看。

我们接下来要做的是照片库组件，我们的目标是在下周末之前完成（下周中确认）。

我们仍在等待信用卡网关提供商确认您的帐户，以便您可以接收在线付款。我们已将此标记为风险，因为我们仍在等待您的互联网商家帐户获得银行的批准。

如果您有任何问题，请告诉我，我很乐意尽我所能回答。

===

这很简单。它确实错过了许多有用的指标，您可以从燃尽图和 Scrum 方法中获得。但这些不是直接呈现给客户（或管理层）的好数字。

哦，我应该说明一下列出错误。高级管理人员喜欢不同程度的披露。就个人而言，我很透明。但是您应该与您的经理核实您可以向客户透露多少“坏东西”。

如果您有兴趣，我有一篇更深入的博客文章：[项目状态报告每个人都可以理解](http://pm4web.blogspot.com/2008/12/project-status-reports-everyone-can.html)

LM

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-28T11:24:48.913

我不喜欢单独的状态报告。我希望项目状态报告成为我们使用的项目管理软件的一项功能。节省时间并向每个人（团队、管理层、利益相关者、客户）提供相同信息的最佳方法之一是拥有一个整合的信息/数据管理系统，并将其用于您的所有需求。即使您必须向公司外部发送单独的报告，它最好应该是来自该管理系统的报告。

我们处于敏捷环境中并使用 VersionOne。Team 管理其上的所有任务和活动，而公司中的其他所有人都可以使用它来查看进度、查看燃尽图和许多其他属于 VersionOne 固有一部分的报告。

[http://www.VersionOne.com](http://www.VersionOne.com)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-07T01:10:47.457

My company uses VersionOne to get information such as percentage of backlog items completed, deferred items from previous sprints, and overall project completion percentage. When we want to present this information to the customer, we create a power point presentation and include the info. For internal use, we just look it up on VersionOne's site or put it in an excel file for non-technical employees who don't have access to it.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-28T11:50:50.093

即使您不使用敏捷，您仍然可以通过跟踪功能而不是任务的进度来获胜。

您的利益相关者很可能不知道“*重构 t_sec_name 表以向标识列添加自动增量*”是什么意思，并且很可能不会关心它是否完成。

但是，如果您报告“提高向应用程序添加新用户的性能”的进度，您将能够将有关进度的信息传达给您的读者。

所以我会报告：

*   您在功能级别上的更改/修复/增强的进度，
    *   工作完成
    *   工作正在进行中
    *   计划的工作
*   企业/客户需要解决的决策/问题
*   风险（创建报告是更新风险登记册的好时机）
*   团队问题（假期、病假、培训）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-28T20:33:57.197

我工作的地方有多种“强制”格式。

我的日常状态分为三类：

*   完成的事情
*   未完成的事情（以及为什么）
*   客户意见
    *   包括对功能/添加的请求
    *   坦诚的感谢、投诉等
    *   其他

项目状态将每日状态与时间表连接起来，以显示未来/落后的情况。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-07T05:37:44.083

我使用了我以前的项目经理开发的出色的项目状态报告。自从与各种赞助商一起成功使用它以来，我已经成功地使用了它，他们喜欢关注问题、风险、里程碑和预算。

我已经把 XLS 文件和一堆其他的[PM 模板](http://officeadd.in/pm_tools/pm_templates.aspx)放在了一起。最后我会在它周围加上描述如何有效使用它的文字。但是，如果您坚持使用非情感语言，请关注您应该设置的问题/风险的影响。

我也看过 OPPM 的书，并没有留下深刻的印象。相比之下，我们的[项目状态报告](http://officeadd.in/files/pmtools/XYZ%20Project%20-%20Project%20Status%20-%20Template%20V1.1.xls "这将在未来更新，如果是这样，请点击第一个链接")通常需要 15 分钟的时间来学习如何使用而不是整本书。

注意：这不是为了让团队成员报告他们的状态，而是为了让 PM 向忙于多个项目的发起人和项目经理报告他们的项目状态。

# c# - 静态属性在 Web 上下文中的影响

> ID：242904
> 
> 赞同：1
> 
> 时间：2008-10-28T11:05:56.347
> 
> 标签：c#, asp.net

我需要更改 Web 应用程序中对象的静态属性。该属性具有硬编码到对象中的默认值。如果我更改 Application_Start 中的静态属性，那么更改是否会生效：

A）永远（嗯，直到应用程序被回收）

B）直到对象被GC'd然后由下一个访问器重新初始化

C) 取决于

请注意，我要设置的属性只是一个字符串

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T11:08:08.993

静态变量的范围是它的 AppDomain。所以不，它不会被垃圾收集 - 但是如果 AppDomain 被回收（这在 ASP.NET 中可能会发生相当多的情况），那么您最终将有效地得到一个“新”静态变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T11:09:22.860

根据我在这里使用我们的 Web 应用程序的经验，答案是 A。据我所知，静态类永远不会被 GC，它在进程的整个生命周期中都存在（在这种情况下，是 ASP.NET 工作进程）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T11:09:46.417

去 A) 应用程序实例变量

上下文存储参考httpContext。

# log4net - 如何让 log4net 的 SmtpPickupDirAppender 使用 IIS 拾取目录？

> ID：242908
> 
> 赞同：0
> 
> 时间：2008-10-28T11:07:18.213
> 
> 标签：log4net

由于我部署到的实时服务器的性质，我的邮件设置使用 deliveryMethod="PickupDirectoryFromIis"。我正在使用 log4net 通过电子邮件发送日志，我需要找到一种让它做同样事情的方法。

我可以从文档中看到有一个 SmtpPickupDirAppender，它有一个pickupDir 设置。如果我将此设置为 IIS 使用的任何拾取目录，我确信一切都会正常工作。但是我真正想要的只是告诉 log4net 使用 IIS 的设置并将其留在那里。这样，如果它发生变化，我们也不必更改 log4net 配置，我们可能会忘记这一点。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T11:17:37.103

AFAIK，这是不可能的。虽然这听起来是个好主意。

log4net 最大的优点之一是您可以更改配置而无需重新启动或重新编译应用程序（查看[常见问题解答](http://logging.apache.org/log4net/release/faq.html)），因此您无需担心日志记录会停机。

我不知道您是否可以查询 IIS 以获取 SMTP 提取目录，也许如果可能的话，您可以添加一些后台作业来查询 IIS 以获取此信息？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T11:30:52.147

很遗憾，因为该[`SmtpClient.DeliveryMethod`](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.deliverymethod.aspx)属性支持 的值[`PickupDirectoryFromIis`](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpdeliverymethod.aspx "SmtpDeliveryMethod 枚举")。

# windows - Windows 'dir' 命令，按名称排序和

> ID：242913
> 
> 赞同：5
> 
> 时间：2008-10-28T11:08:44.997
> 
> 标签：windows, cmd, directory

我们可以在 Windows 资源管理器中看到按名称排序的目录文件。

如果我在 Windows 命令提示符下尝试相同的操作，它会按不同的名称排序 -*正确*：

```
dir *.jpg /ON /B

cubierta.jpg
pag00.jpg
pag06.jpg
pag08.jpg
pag09.jpg
pag100.jpg
pag101.jpg
pag102.jpg
pag103.jpg
pag104.jpg
pag105.jpg
pag106.jpg
pag107.jpg
pag108.jpg
pag109.jpg
pag11.jpg, etc, etc, etc, ... 
```

有没有办法`dir`按名称订购，它可以像人类一样读取数字？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-28T11:13:47.953

您最好的选择（如果可能）是在较小的数字中添加足够多的前导零（在这种情况下为两个），以便排序按预期进行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-28T11:42:15.680

Windows 资源管理器使用特殊的排序函数[StrCmpLogicalW](https://docs.microsoft.com/en-us/windows/win32/api/shlwapi/nf-shlwapi-strcmplogicalw)，*cmd.exe*不使用该函数，因此输出存在差异。不过，您可以用它编写自己的排序程序。

您可能还对 Michael Kaplan 关于[这个](http://www.siao2.com/2005/01/05/346933.aspx) [主题](http://www.siao2.com/2006/10/02/783066.aspx)的条目感兴趣（来自 Raymond Chen 的[意见箱](https://web.archive.org/web/20100508052411/http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-16T10:29:23.443

这称为[自然排序](https://en.wikipedia.org/wiki/Natural_sort_order)。目前没有可以自然排序的内置命令行工具。如果你愿意，请[投票支持](https://aka.ms/AA21wr4)让微软改变主意的功能

然而，这可以通过正则表达式替换来模拟，以填充零以使数字具有相同的长度。这样，[字典排序](https://en.wikipedia.org/wiki/Lexicographic_order)就等同于自然排序。在 Windows 上，您可以使用 Jscript 和 VBS 来执行此操作。但最简单的方法是使用 powershell。您可以像这样从 cmd.exe 调用它

```
powershell -Command "(Get-ChildItem | Sort-Object { [regex]::Replace($_.Name, '\d+', { $args[0].Value.PadLeft(20) }) }).Name" 
```

当然，`PadLeft(20)`如果您的文件包含更长的数字系列，您需要更改数字

[如何像 Windows Explorer 一样按文件名排序？](https://stackoverflow.com/q/5427506/995714)

如果您的文件末尾只有一个数字，则可以[在批量自然排序文件中](https://stackoverflow.com/q/19297935/995714)找到本机批处理解决方案

```
@echo off
setlocal enabledelayedexpansion
for %%a in (*.txt) do (
    set num=00000000000000000000%%a
    set num=!num:~-20!
    set $!num!=%%a
)
for /f "tokens=1,* delims==" %%a in ('set $0') do echo %%b 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T08:15:35.103

嘿嘿嘿。大家想知道我的解决方案吗？

我正在使用一个名为 ImageMagick 的程序将我的 200MB PDF 文件转换为 JPG。在漫长的过程结束时，它按数字顺序序列化所有文件......所以基本上文件创建日期的值随着每个文件被写入硬盘驱动器而略有增加。因此，以下两个批处理文件命令中的任何一个都将以“正确”顺序写入文件：

```
dir *.jpg /ODN /B > files.txt

for /f "tokens=*" %%a in ('dir *.jpg /ODN /B') do (
    echo ^<page^>%%a^</page^> >>pages.xml.fragment
) 
```

因此，该`dir *.jpg /OD`命令按升序（创建？）日期对目录内容进行排序，我们可以完全忽略实际的文件名。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-28T14:40:38.237

[JPSoft](http://jpsoft.com)的4NT/TCC/TC默认使用自然排序。或者，如果您可以访问 GNU`sort`程序，例如[Cygwin 工具](http://cygwin.org)，您可以执行类似`ls -1 | /<cygwin>bin/sort -g`或`dir /b | \cygwin\bin\sort -g`；这将以自然排序顺序为您提供文件名。

如果您受限于 Windows 原生的工具，您可以尝试使用[Windows 脚本工具](http://msdn.microsoft.com/en-us/library/ms950396.aspx)并执行一些操作，例如使用[FileSystemObject](https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/filesystemobject-object)来获取文件名，并使用正则表达式来提取文件名的数字部分以用作 Dictionary 对象中的键. 我将把实际的编码作为练习留给读者:)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-10-28T11:12:29.407

不，没有办法做到这一点。Windows 资源管理器使用不同的方法来处理此问题。

# java - JPA 复合键 + 序列

> ID：242914
> 
> 赞同：17
> 
> 时间：2008-10-28T11:08:56.590
> 
> 标签：java, hibernate, jpa, composite-key

是否可以在普通 JPA 或 JPA+Hibernate 扩展中声明复合键，其中复合键的元素是序列？

这是我的复合类：

```
@Embeddable
public class IntegrationEJBPk implements Serializable {

    //...

    @ManyToOne(cascade = {}, fetch = FetchType.EAGER)
    @JoinColumn(name = "APPLICATION")
    public ApplicationEJB getApplication() {
        return application;
    }

    @Column(name = "ENTITY", unique = false, nullable = false, insertable = true, updatable = true)
    public String getEntity() {
        return entity;
    }

    @GeneratedValue(strategy = GenerationType.AUTO, generator = "INTEGRATION_ID_GEN")
    @SequenceGenerator(name = "INTEGRATION_ID_GEN", sequenceName = "OMP_INTEGRATION_CANONICAL_SEQ")
    @Column(name = "CANONICAL_ID", unique = false, nullable = false, insertable = true, updatable = true)
    public String getCanonicalId() {
        return canonicalId;
    }

    @Column(name = "NATIVE_ID", unique = false, nullable = false, insertable = true, updatable = true)
    public String getNativeId() {
        return nativeId;
    }

    @Column(name = "NATIVE_KEY", unique = false, nullable = false, insertable = true, updatable = true)
    public String getNativeKey() {
        return nativeKey;
    }

    //...
} 
```

我已经提供了`application`、`entity`和`nativeId`的值`nativeKey`。我想构建一个如下所示的实体：

```
IntegrationEJB i1 = new IntegrationEJB();
i1.setIntegrationId(new IntegrationEJBPk());
i1.getIntegrationId().setApplication(app1);
i1.getIntegrationId().setEntity("Entity");
i1.getIntegrationId().setNativeId("Nid");
i1.getIntegrationId().setNativeKey("NK"); 
```

当我调用`em.persist(i1`) 时，我希望`canonicalId`生成并插入集成。

这可能吗？如果是这样，简单的方法是什么？（我不喜欢使用应用程序提供的密钥或本机 sql）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T20:49:43.110

我相信这对于普通的 JPA 是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T02:16:57.627

JPA 2 规范未指定将 @GeneratedValue 用于复合 PK。

从 JPA 规范：

> 11.1.17 GeneratedValue注解
> 
> GeneratedValue 注释提供了主键值生成策略的规范。GeneratedValue 注释可以与 Id 注释一起应用于实体或映射超类的主键属性或字段。 [97] 仅需要简单主键支持使用 GeneratedValue 注释。派生的主键不支持使用 GeneratedValue 注释。

请注意，在不同的情况下，您可以拥有一个具有使用 @GeneratedValue 的简单 PK (@Id) 的父实体，然后拥有一个具有复合 PK 的子实体，该复合 PK 包括从父级生成的 Id 以及另一列。

*   为子实体提供与父实体的 @ManyToOne 关系，以便它继承 FK 列中生成的 ID。
*   然后通过针对实体指定的@IdClass 以及实体中的两个@Id 列，为子项提供一个复合PK。

> ```
> @Entity
> public class ParentEntity { 
> ```

```
 @Id
       @GenerateValue(IDENTITY) // If using DB auto-increment or similar
       int id;

       // ...
} 
```

> ```
> @Entity
> @IdClass(ChildId.class)
> public class ChildEntity {
>    // The child table will have a composite PK:
>    // (parent_ID, child_name)
>        @Id 
>        @ManyToOne
>        int parentEntity; 
> ```

```
 @Id
       String childName;

       String favoriteColor;  // plus other columns

       // ...

} 
```

> ```
> // child Id attributes have the same name as the child entity
> // however the types change to match the underlying PK attributes 
> // (change ParentEntity to int)
>  public class ChildId implements Serializable { 
> ```

```
 int parentEntity;
        String childName;

        public ChildId() { //... }

        // Add extra constructor & remove setter methods so Id objects are immutable
        public ChildId(int parentEntity, String childName) { //... }

        public int getParentEntity() { //... }
        // make Id objects immutable:
        //  public void setParentEntity(int parentEntity) { //... }
        public String getChildName() { //... }
        //  public void setChildName(String childName) { //... }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T17:00:18.173

试试这样：

```
@TableGenerator(name = "canonicalKeys", allocationSize = 1, initialValue = 1)
@GeneratedValue(strategy = GenerationType.TABLE, generator = "canonicalKeys")
@Column(name = "CANONICAL_ID", unique = false, nullable = false, insertable = true, updatable = true)
public String getCanonicalId() {
    return canonicalId;
} 
```

通过这种方式，您可以使用表格而不是使用序列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T15:00:28.873

我注意到您似乎在构建一个像此[示例](http://boris.kirzner.info/blog/archives/2008/07/19/hibernate-annotations-the-many-to-many-association-with-composite-key/)一样的复合主键。当我在自己的数据库中解决类似的问题时，我想知道您是否可以像这样直接调用 sql：

`select nextval ('hibernate_sequence')`

我想那会作弊;-)

# content-management-system - Terminalfour 站点管理器 - 内容管理系统

> ID：242916
> 
> 赞同：1
> 
> 时间：2008-10-28T11:09:14.000
> 
> 标签：content-management-system, content-management

我即将开始一个项目，实际上在接下来的 2 年内我们作为一个组织将实施[TerminalFour 站点管理器](http://www.terminalfour.com/content-management-system/)

如果有人使用过这个软件，我基本上是在寻求任何建议或支持，以及他们对它的看法。

到目前为止，除了它显然不是最漂亮的界面外，它似乎确实可以很好地处理大多数基本的网站编辑等。

不过，当涉及到自定义构建的模板以及与外部数据、RSS、MySQL 表等链接时，我确实看到了限制。

如前所述，如果其他人已经使用或将要使用它，您的想法是什么？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-11T15:21:20.237

英国的许多大学都在使用 TerminalFour，因此建立同事网络应该不难。（到底有谁能比大学里的人更平易近人、更愿意交流思想？..）认为自己很幸运！

有一个关于 TerminalFour 实施和维护的开放博客：http: [//scottishwebfolkt4.wordpress.com/](http://scottishwebfolkt4.wordpress.com/)

这是由斯特拉斯克莱德大学和圣安德鲁斯大学的网络开发人员发布的。我不知道有任何开放的讨论组或论坛，所以这是你开始一个并进一步发展你的个人级网络的机会。

加快使用新软件的另一个自然步骤是使用供应商自己的咨询。从 TerminalFour 获取有关您需要一起设置/配置小型（-ish）飞行员的时间量的报价。尽可能多地参与这个过程，但让他们指导你——这样你会学到很多东西，否则你会在三个月后发现。TerminalFour 提供一些咨询和培训作为其标准套餐的一部分，因此您甚至可能不需要在早期花费任何额外的钱。

此外，请记住照顾和发展您在组织内的关系。CMS 项目的技术方面只是您组织目标的一小部分，文化变革是主要障碍。因此，请与项目经理、网络作者、部门负责人和整个组织中其他有影响力的人保持联系。两年的时间对于建立良好的人际关系来说并不长，所以越早开始越好！

顺便说一句 - 非常好奇你对界面不漂亮的意思。我的印象是 TerminalFour 以非常漂亮和整洁（但可能不是最直接或清晰）的界面而闻名......

希望这对您的项目有所帮助并祝您好运！

问候，玛丽安。

# c++ - C++单元测试框架比较

> ID：242926
> 
> 赞同：326
> 
> 时间：2008-10-28T11:13:01.480
> 
> 标签：c++, unit-testing, cppunit, googletest, boost-test

我知道已经有一些关于 C++ 单元测试框架建议的问题，但所有答案都没有帮助，因为他们只是推荐了其中一个框架，但没有提供任何关于（功能）比较的信息。

我认为最有趣的框架是 CppUnit、Boost 和新的 Google 测试框架。有人做过比较吗？

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2010-08-25T12:16:14.097

一个新的播放器是[Google Test](http://code.google.com/p/googletest/)（也称为*Google C++ 测试框架*），它非常好。

```
#include <gtest/gtest.h>

TEST(MyTestSuitName, MyTestCaseName) {
    int actual = 1;
    EXPECT_GT(actual, 0);
    EXPECT_EQ(1, actual) << "Should be equal to one";
} 
```

主要特点：

*   **便携的**
*   致命和**非致命断言**
*   简单的断言信息性**消息**：`ASSERT_EQ(5, Foo(i)) << " where i = " << i;`
*   Google Test会**自动**检测您的测试，并且不需要您枚举它们即可运行它们
*   轻松**扩展**您的断言词汇
*   **死亡测试**（见高级指南）
*   `SCOPED_TRACE`for 子程序循环
*   您可以决定**运行哪些测试**
*   **XML**测试报告生成
*   **夹具**/**模拟**/**模板**...

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2010-12-28T03:14:31.410

我刚刚推出了我自己的框架[CATCH](http://www.levelofindirection.com/journal/2010/12/28/unit-testing-in-c-and-objective-c-just-got-easier.html)。它仍在开发中，但我相信它已经超越了大多数其他框架。不同的人有不同的标准，但我试图在没有太多权衡的情况下涵盖大部分内容。请查看我的链接博客条目以供品酒师使用。我的前五个功能是：

*   仅标题
*   基于功能和方法的测试的自动注册
*   将标准 C++ 表达式分解为 LHS 和 RHS（因此您不需要一整套断言宏）。
*   支持基于功能的夹具中的嵌套部分
*   使用自然语言命名测试 - 生成函数/方法名称

它还具有 Objective-C 绑定。该项目托管在[Github上](https://github.com/philsquared/Catch)

* * *

## 回答 #3

> 赞同：108
> 
> 时间：2008-10-28T11:19:14.523

[请参阅此问题](https://stackoverflow.com/questions/91683/how-do-you-implement-unit-testing-in-large-scale-c-projects)进行一些讨论。

他们推荐以下文章： [探索 C++ 单元测试框架丛林](http://gamesfromwithin.com/?p=29)，作者 Noel Llopis。最新的：[C++ 测试单元框架](http://accu.org/index.php/journals/1326)

我还没有找到一篇将 googletest 与其他框架进行比较的文章。

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2010-08-25T12:24:23.750

**[Boost Test Library](http://www.boost.org/doc/libs/release/libs/test/doc/html/index.html)**是一个非常好的选择，特别是如果您已经在使用 Boost。

```
// TODO: Include your class to test here.
#define BOOST_TEST_MODULE MyTest
#include <boost/test/unit_test.hpp>

BOOST_AUTO_TEST_CASE(MyTestCase)
{
    // To simplify this example test, let's suppose we'll test 'float'.
    // Some test are stupid, but all should pass.
    float x = 9.5f;

    BOOST_CHECK(x != 0.0f);
    BOOST_CHECK_EQUAL((int)x, 9);
    BOOST_CHECK_CLOSE(x, 9.5f, 0.0001f); // Checks differ no more then 0.0001%
} 
```

它支持：

*   **自动**或手动测试注册
*   许多断言
*   自动比较**集合**
*   各种输出格式（包括**XML**）
*   **夹具**/**模板**...

PS：我写了一篇关于它的文章，可以帮助你入门：[C++ Unit Testing Framework: A Boost Test Tutorial](http://www.beroux.com/english/articles/boost_unit_testing/)

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2009-06-26T20:50:44.997

Wikipedia 有一个完整[的单元测试框架列表](http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks)，其中包含标识支持与否的功能的表格。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2012-10-25T04:58:28.697

我最近发布了[xUnit++](https://bitbucket.org/moswald/xunit)，专门作为 Google Test 和 Boost Test Library 的替代品（查看[比较](https://bitbucket.org/moswald/xunit/wiki/Compare.wiki)）。如果您熟悉 xUnit.Net，那么您已经准备好使用 xUnit++。

```
#include "xUnit++/xUnit++.h"

FACT("Foo and Blah should always return the same value")
{
    Check.Equal("0", Foo()) << "Calling Foo() with no parameters should always return \"0\".";
    Assert.Equal(Foo(), Blah());
}

THEORY("Foo should return the same value it was given, converted to string", (int input, std::string expected),
    std::make_tuple(0, "0"),
    std::make_tuple(1, "1"),
    std::make_tuple(2, "2"))
{
    Assert.Equal(expected, Foo(input));
} 
```

主要特点：

*   难以置信的快：测试**同时**运行。
*   **便携的**
*   **自动**测试注册
*   **许多**断言类型（Boost 在 xUnit++ 上没有任何东西）
*   本机比较**集合**。
*   断言分为**三个**级别：
    *   致命错误
    *   非致命错误
    *   警告
*   简单**的断言**记录：`Assert.Equal(-1, foo(i)) << "Failed with i = " << i;`
*   **测试**记录：`Log.Debug << "Starting test"; Log.Warn << "Here's a warning";`
*   夹具
*   **数据驱动**测试（理论）
*   **选择要运行的测试**基于：
    *   属性匹配
    *   名称子串匹配
    *   测试套件

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-06-07T18:40:12.703

[CppUTest](http://www.cpputest.org/) - 非常漂亮的轻量级框架，带有模拟库。值得仔细看看。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-07-15T16:47:27.233

CPUnit ( [http://cpunit.sourceforge.net](http://cpunit.sourceforge.net) ) 是一个类似于 Google Test 的框架，但它对 macos 的依赖较少（断言是函数），并且为宏添加前缀以避免通常的宏陷阱。测试看起来像：

```
#include <cpunit>

namespace MyAssetTest {
    using namespace cpunit;

    CPUNIT_FUNC(MyAssetTest, test_stuff) {
        int some_value = 42;
        assert_equals("Wrong value!", 666, some_value);
    }

    // Fixtures go as follows:
    CPUNIT_SET_UP(MyAssetTest) {
        // Setting up suite here...
        // And the same goes for tear-down.
    }

} 
```

他们会自动注册，因此您不需要更多。然后它只是编译和运行。对于那些不得不花一些时间编写 Java 的人来说，我发现使用这个框架非常像使用 JUnit。非常好！

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-11-16T14:56:51.830

[http://www.progweap.com/resources.html](http://www.progweap.com/resources.html)上有一些相关的 C++ 单元测试资源

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-01-25T15:28:15.623

[API Sanity Checker](http://lvc.github.io/api-sanity-checker/) — C/C++ 库的测试框架：

> 用于共享 C/C++ 库的基本单元测试的自动生成器。它能够为参数生成合理的（在大多数情况下，但不幸的是不是所有情况下）输入数据，并通过分析标题中的声明为 API 中的每个函数编写简单（“健全”或“浅薄”质量）的测试用例文件。
> 
> 生成测试的质量允许检查简单用例中是否存在严重错误。该工具能够构建和执行生成的测试并检测崩溃（段错误）、中止、各种发出的信号、非零程序返回码和程序挂起。

与 CppUnit、Boost 和 Google Test 相比的独特功能：

*   自动生成测试数据和输入参数（即使是复杂的数据类型）
*   现代且高度可重用的[专用类型](http://lvc.github.io/api-sanity-checker/Specialized-Type.html)，而不是固定装置和模板

# c# - 如何回滚对绑定 DataGridView 所做的更改？

> ID：242927
> 
> 赞同：5
> 
> 时间：2008-10-28T11:13:40.777
> 
> 标签：c#, data-binding

我有一个 DataGridView，其数据源设置为自定义对象的通用列表。随着用户更改值（在这种情况下选中/取消选中复选框），对象中的基础布尔字段会更改。

我应该为绑定创建列表的“副本”，然后在用户提交时手动更新（如果是这样，您如何创建此副本），或者是否有一种简单的方法来回滚对数据源所做的更改。

（我正在使用 C#）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T13:35:34.827

从技术上讲，除非您告诉它，否则它不会更新您的实际数据源，只是您绑定到网格的列表。您仍然可以随意处理此列表并重新查询您的源以将其刷新回之前的状态。

您可能只需为用户添加一个提交选项，以将他们所做的所有更改提交回实际数据源。

像这样处理它会容易得多，而且可能会少得多。然后，您可以简单地使用“取消更改”或某些此类选项，这些选项将再次刷新并从其源重新绑定列表，而无需执行更新。

希望这可以帮助！

干杯!

# c# - 普遍使用 Int64 而不是 int (C#) 的缺点

> ID：242930
> 
> 赞同：3
> 
> 时间：2008-10-28T11:14:06.750
> 
> 标签：c#, .net-2.0

我们使用具有诸如版本（NHibernate 所需的日期时间）和 guid（作为键）等属性的基本实体。

它还有一个具有两个功能的 Id (int) 字段。首先与遗留应用程序密钥相关（如果有的话）。其次作为速记代码：例如文件有时是基于这些文件创建的，使用我们的 guid 键看起来很难看而且很长。我的问题不是关于基本实体的优缺点，而是关于将这个 Id 输入到 Int64？

它不会影响它在我们的 MS SQL Server 数据库中的存储方式。它会在我们的缓存和内存中增加成本吗？这真的有那么大的担心吗？

我有兴趣听到除了性能之外的其他缺点。还要考虑这些值也可能会通过 Web 服务及时暴露给第三方。

另一种方法是处理出现的较大整数的异常，并在派生实体中专门实现它们。不利的一面是，这需要在代码中完成，当我们在生成较大整数时发现某些情况时，我们会怎么做？当然会有输入验证来阻止实际错误，但它可能会限制扩展数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T11:23:32.817

如果您的应用程序在 64 位 CPU 上运行，那么可能根本没有太大区别。

在 32 位 CPU 上，64 位整数在执行计算时会占用更多处理器资源。

还有明显的内存使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-28T11:25:23.733

好吧， int64 使用 8 字节的内存存储，而 int 使用 4 字节......但是，您已经指出了大部分缺点。当然在很多系统上执行的计算也会比较慢（运行在 64 位模式下的 64 位系统在 64 位上执行操作的速度与在 32 位上一样快，但是 32 位系统需要执行额外的工作，这意味着添加两个 64位数由两个 32 位加法加上一些额外的代码执行 - 其他数学运算将同样分解为 32 位运算）。但是，除非您存储数百万个这些数字并使用它们执行大量操作，否则我怀疑您会看到任何性能差异，但无论是在 CPU 时间还是在内存中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T11:25:03.500

只有您可以回答缓存中的空间有多大问题。如果那是缓存键并且您有一些巨大的 blob 作为值，那么向键添加额外的 4 个字节不会有太大的不同。如果您存储*的*只是 ID，那么显然它会产生更显着的影响。

目前有多少内存用于存储您的 ID？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T11:16:00.320

可移植性...尽管如果您要进行可移植性，C# 并不真正被称为通用语言，所以这对您来说可能没有实际意义？

# apache-flex - FLEX3，点击和事件捕获，特殊情况

> ID：242941
> 
> 赞同：0
> 
> 时间：2008-10-28T11:18:49.160
> 
> 标签：apache-flex, events, canvas, click

我在面板中有一个主画布“黑板”，这个画布本身有几个孩子，如工具栏（图块）、标签和一些皮肤。

问题是，当我移动到矩形工具并开始绘制矩形时，如果我想在单击其他工具（例如“圆形”或“选择”）时更改工具，则按钮不会捕获单击事件，而是画布将抓住鼠标并开始绘图。

就像图片上一样。因此，一旦开始绘图，我就无法更换工具。

[替代文字 http://www.freeimagehosting.net/uploads/397a7cd49e.png](http://www.freeimagehosting.net/uploads/397a7cd49e.png)

我怎么能让画布在工具上时不做出反应，或者我怎么能让按钮先捕捉到点击并告诉画布不画任何东西。

当然，我可以将工具栏放在画布上以外的其他地方，但由于空间很重要，我希望按钮位于画布上。

我愿意接受任何建议。

=== 这里有一些代码来展示它是如何在内部工作的。===

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml" 
          xmlns:degrafa="http://www.degrafa.com/2007"
          xmlns:comp="org.foo.bar.view.components.*"
          layout="absolute"
          title="Tableau">

    <mx:Script>
    <![CDATA[
        import org.edorado.edoboard.ApplicationFacade;
    ]]>
    </mx:Script>

    <mx:Canvas id="blackBoard">

        <degrafa:Surface id="boardSurfaceContainer">
             skinning      
     </degrafa:Surface>

        <!-- Tool bar -->
        <comp:ToolbarView 
           id = "toolbar"
           name = "toolbar"
           verticalScrollPolicy="off" 
           horizontalScrollPolicy="off"
           bottom="5"
           right="5"
           top="5"
           direction="vertical"
           width="30" />   

        <mx:Label x="10" y="10" text="Label"  color="#FFFFFF" id="lbl"/>

    </mx:Canvas>

</mx:Panel> 
```

工具栏是包含在磁贴中的按钮列表。画布“黑板”链接到几个事件处理，特别是鼠标上下移动以绘制形状。

```
...
boardCanvas.addEventListener(MouseEvent.MOUSE_DOWN, handleMouseDown);
            boardCanvas.addEventListener(MouseEvent.MOUSE_UP, handleMouseUp);
...
        private function handleMouseDown(event:MouseEvent):void {
            // Get the current mouse location which may be adjusted to the grid
            var selectPoint:Point = boardCanvas.globalToLocal(new Point(event.stageX, event.stageY));
            startPoint = snapPoint(selectPoint.x, selectPoint.y);
            boardView.lbl.text = '(' + startPoint.x +',' + startPoint.y + ')';
.... 
```

工具栏也听点击

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Tile xmlns:mx="http://www.adobe.com/2006/mxml">

    <mx:Script>
        <![CDATA[
            import mx.charts.BubbleChart;
            import org.edorado.edoboard.view.components.shapes.*; 

            public static const TOOL_CHANGE:String  = "toolChange";
            public static const TEXT_TOOL:String  = "textTool";
            public static const SELECT_TOOL:String  = "selectTool";
            public static const RECTANGLE_TOOL:String  = "rectangleTool";

            private var b:Button = null;

            private function handleButtonClick(event:MouseEvent):void {
                trace("CLICKED  TOOL");
                // selectButton.dispatchEvent(new Event(TOOL_CHANGE, true, true)) 
                b = event.target as Button;
                b.dispatchEvent(new Event(TOOL_CHANGE, true, true));
            }

        ]]>
    </mx:Script>

          <!-- Use class facotry ? -->
          <mx:Button id="selectButton"
                     name="{SELECT_TOOL}"
                     selectedUpSkin="assets.skins.ToolButtonSkin"
                     width="30" 
                     height="30" 
                     styleName="selectButton" 
                     toolTip="selection" 
                     click="handleButtonClick(event); " />

          <mx:Button id="textButton"
                     name = "{TEXT_TOOL}"
                     selectedUpSkin="assets.skins.ToolButtonSkin"
                     width="30" 
                     height="30" 
                     styleName="textButton"  
                     toolTip="text"
                     click="handleButtonClick(event);" />

          <mx:Button id="rectButton" 
                     name = "{RECTANGLE_TOOL}"
                     selectedUpSkin="assets.skins.ToolButtonSkin"
                     width="30"
                     height="30"
                     styleName="rectButton"
                     toolTip="rectButton"
                     click="handleButtonClick(event);" />
</mx:Tile> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T11:40:11.127

当单击来自工具栏时，您可以使用[MouseEvent的](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/events/MouseEvent.html)[目标](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/events/Event.html#target)属性来区分行为。只需在 LiveDocs 上搜索一下即可了解目标属性是什么。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T11:46:11.117

谢谢，我发现了一些类似的帖子，实际上我只是在我的工具栏中听了鼠标按下并停止了事件传播，这样画布就不会捕捉到它。

# c# - nHibernate 会话和多线程

> ID：242961
> 
> 赞同：12
> 
> 时间：2008-10-28T11:27:33.947
> 
> 标签：c#, multithreading, nhibernate, session

我有一个使用 nHibernate 会话的具有大量持久性调用的方法，它有效，没问题。但是出于多线程的原因，我需要重构这个方法，从循环内的内容中提取一个方法。然后我用这个方法创建了一个类。这就像一个正常的重构，但是这个方法调用中的 nHibernate 会话被破坏了，没有上下文，我没有任何时候完成它。**多线程有 nHibernate 问题吗？**即使我只执行了一个线程，我也遇到了同样的问题。

我通过 SessionFactory 和 Façade 模式使用 nHibernate Session，这意味着，会话不是这些对象的字段，它在 SessionFactory 是全局的。

* * *

让它更清楚一点：

**前：**

```
Method()
{
... persistence calls
foreach(Thing..)
{
...persistence calls for each thing (1)
}
...
} 
```

**后：**

```
Method()
{
... persistence calls
foreach(Thing..)
{
create a thingResolver object with some data
open a new thread with thingResolver.Method (1)
starts this thread
}
.. waits for finishing threads and continues
} 
```

* * *

我们的 nHibernate 会话工厂是线程感知的，并且每个线程存储/检索 nHibernate 会话。它现在运行良好；）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-28T11:40:42.767

在 NHibernate 中，会话在**设计上****不是线程安全**的。因此，只要您的*会话仅由一个线程使用*就可以了。

 ***我不确定你是 thingResolver 做了什么，但如果它对你在原始线程中创建*的同一个*会话进行一些持久性调用 - 这很可能是你的问题的原因，你可以在你的新会话中创建一个单独的会话线程，这样如果我的假设是真的，这将是每个线程的会话。

NHibernate 参考在第 10.2 节中有它

[http://nhibernate.info/doc/nh/en/index.html#transactions](http://nhibernate.info/doc/nh/en/index.html#transactions)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-08T21:06:34.807

只要每个线程都有一个单独的 NHibernate 会话，就可以为多个线程使用一个 NHibernate SessionFactory。

这是一个示例，它会给出异常，因为它为每个线程使用相同的会话：

[https://forum.hibernate.org/viewtopic.php?p=2373236&sid=db537baa5a57e3968abdda5cceec2a24](https://forum.hibernate.org/viewtopic.php?p=2373236&sid=db537baa5a57e3968abdda5cceec2a24)

解决方案是将会话存储在 LocaldataStoreSlot 上，这样您就可以拥有一个会话每个请求的模型。

# java - XFire SOAP 服务器可以向客户端发送 HTTP 301 REDIRECT 吗？

> ID：242962
> 
> 赞同：1
> 
> 时间：2008-10-28T11:28:52.367
> 
> 标签：java, http, soap, redirect

是否可以从 XFire SOAP 服务器内部发送 HTTP REDIRECT 响应而不是常规响应？

我需要这个以便基于对方法参数的一些检查将客户端重定向到另一台服务器。

此外，重定向处理是主要 SOAP 客户端支持的吗？我知道 HttpClient 可以，但我不确定 .NET 客户端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T19:43:42.457

许多soap客户端不会遵循重定向，因为您不应该在没有用户确认的情况下遵循POST上的重定向。（并且所有 SOAP 请求都是 POST）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-23T15:35:46.173

WS-BasicProfile 1.1 和 1.2 声明使用 HTTP 临时重定向 307 可以工作：

[http://www.ws-i.org/Profiles/BasicProfile-1_2%28WGAD%29.html#HTTP_Redirect_Status_Codes](http://www.ws-i.org/Profiles/BasicProfile-1_2%28WGAD%29.html#HTTP_Redirect_Status_Codes)

# mfc - 为什么 OnVScroll() 方法只输入一次？

> ID：242963
> 
> 赞同：1
> 
> 时间：2008-10-28T11:29:11.947
> 
> 标签：mfc, scrollbar

我在基于对话框的 MFC 应用程序中设计了一个派生自 CScrollBar 的类。在对话框类（MyScrollbarDlg）中，我设置了**ON_WM_VSCROLL**消息，并在头文件中声明了**OnVSCroll方法。**我还在相应的 .cpp 文件中实现了 OnVScroll() 方法。但令我惊讶的是，当我单击滚动条底部的箭头时，它只在第一次起作用。

我想调试我的代码，所以我在 OnVScroll 方法中设置了一个断点。然后奇怪的事情发生了。断点仅在第一次单击时到达。当我继续时，滚动条从对话框中消失了！我不知道这怎么会发生。谁能帮我解决这个烦人的错误？非常感谢！

我已将滚动范围设置如下：

```
 SCROLLINFO scrllInfo;
  m_scrollbar.GetScrollInfo(&scrllInfo, SIF_ALL);
  scrllInfo.nMax = 15;
  scrllInfo.nMin = 0;
  scrllInfo.nPage = 0;
  scrllInfo.nPos = 0;
  m_scrollbar.SetScrollInfo(&scrllInfo, TRUE); 
```

顺便说一句，我不使用对话框的嵌入式滚动条，而是使用设置为对话框成员的滚动条控件。

我做了一些实验，发现我提到的问题只发生在我点击滚动条控件底部的箭头时。当我单击另一个箭头或拖动滚动框时效果很好。单击我不知道的滚动条的底部箭头时有什么不同吗？

我发现当滚动消息不是 THUMBPOSITION 或 THUMBTRACK 时，不使用方法的参数`nPos`。`OnVScroll()`所以我像这样更改了我的代码：

```
 int currPos = m_scrollbar.GetScrollPos(); m_scrollbar.SetScrollPos(currPos + 1,  TRUE); 
```

这次它表现正常，但如果我设置断点，滚动条又消失了。你知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T13:05:38.367

确保您已设置滚动范围。如果你不设置这个，你的方法只会被调用一次。

到过那里...

* * *

{edit} 我的运气更好

```
m_ScrollBar.SetScrollRange(min, max); 
```

比设置滚动信息。

您可能需要在保存之前检查 flags 字段以查看它是否设置正确。

另外，请仔细检查您是否致电

```
m_ScrollBar.SetScrollPos(CurPos); 
```

单击按钮后设置位置

# internet-explorer - 将电子邮件作为“批量执行作业”发送

> ID：242967
> 
> 赞同：0
> 
> 时间：2008-10-28T11:32:55.013
> 
> 标签：internet-explorer, firefox

我没有任何基于 Web 的开发经验（无论是客户端还是服务器端代码）。很长一段时间以来，我一直在想是否可以执行以下操作：

1.) 我的桌面上有 10 个附件 1.zip 到 10.zip。

2.）我需要使用任何基于网络的电子邮件将所有这些作为附件发送（我需要使用我的 gmail 发送这些邮件）

3.) 一次可以说我只能附加 1 个文件。每封电子邮件 1.zip（附件大小限制）

4.) 目前，我必须执行将这些文件作为附件发送的任务，反复进行大量手动干预，即附加一个文件，输入发件人电子邮件 ID，然后单击发送。等到邮件发送（发送邮件大约需要 4-5 分钟）然后附加第二个文件，并重复上述步骤。

5.）所以我想知道是否可以通过某种插件/代码扩展来自动化这个过程： -

a.) 互联网浏览器

b.) Mozilla firefox（基于greasemonkey的扩展）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T11:34:56.100

这将由您使用的网络邮件客户端负责。

多个上传是可能的，但前提是您使用的网络应用程序可以处理它们。如果您使用的是 Gmail，我会向他们提交功能请求。

最好的方法是使用 IMAP 电子邮件客户端（thunderbird、outlook express）而不是网络邮件来发送您的电子邮件。

# mysql - 自动访问 DB5 到 MySQL

> ID：242975
> 
> 赞同：3
> 
> 时间：2008-10-28T11:37:30.870
> 
> 标签：mysql, windows, ms-access, powershell, wsh

我有一个问题，并希望我可以依靠这里的一些经验来寻求建议并朝着正确的方向前进。我有一个由专有软件制作的 MS Access 文件。我只想从这个表中取出一半的列，然后导入新的（尚未设置）mysql 数据库。

我不知道如何做到这一点或最好的方法是什么。每晚都会获取新数据，然后作为自动任务再次导入。

access 数据库中的一列是 jpeg 文件的 url，我想下载此文件并自动作为 BLOB 类型导入数据库。

有没有办法自动做到这一点？这将在 Windows 机器上，所以也许它可以用 WSH 编写脚本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T12:21:46.020

这是一个 bash 脚本***linux***示例，使用[mdbtools](http://mdbtools.sourceforge.net/)从 mdb 文件自动提取和导入到 mysql。

```
#!/bin/bash

MDBFILE="Data.mdb"

OPTIONS="-H -D %y-%m-%d"
mdb-export $OPTIONS $MDBFILE  TableName_1 >  output_1.txt
mdb-export $OPTIONS $MDBFILE  TableName_2 >  output_2.txt

mdb-export $OPTIONS $MDBFILE  TableName_n >  output_n.txt

MYSQLOPTIONS=' --fields-optionally-enclosed-by=" --fields-terminated-by=, -r '
mysqlimport $MYSQLOPTIONS -L -uuser -ppasword database output_1.txt
mysqlimport $MYSQLOPTIONS -L -uuser -ppasword database output_2.txt
mysqlimport $MYSQLOPTIONS -L -uuser -ppasword database output_n.txt 
```

您可以使用其他一些 mysqlimport 选项： --delete：从目标 mysql 表中删除以前的数据。--ignore: 忽略重复 --replace: 如果发现重复则替换

这不是 Windows 解决方案，但我希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T12:30:42.213

[http://www.dbtalk.net/mailing-database-mysql-win32/what-quickest-way-convert-access-136837.html](http://www.dbtalk.net/mailing-database-mysql-win32/what-quickest-way-convert-access-136837.html)

搜索 Kofler（他写了一本德语书，其中一部分是 mdb2sql 转换器）

这是一个较新的版本。 [http://www.amazon.de/Definitive-Guide-MySQL/dp/1590595351/ref=sr_1_3?ie=UTF8&s=books-intl-de&qid=1225197012&sr=8-3](http://www.amazon.de/Definitive-Guide-MySQL/dp/1590595351/ref=sr_1_3?ie=UTF8&s=books-intl-de&qid=1225197012&sr=8-3)

# cryptography - 将明文添加到密文中

> ID：242976
> 
> 赞同：1
> 
> 时间：2008-10-28T11:38:08.200
> 
> 标签：cryptography

如何将明文添加到加密的密文中？

例如，我想将数字 4 添加到 encrypted(5)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T12:29:24.320

有些方案允许您对加密数据执行算术运算，但无法解密数据。此类方案对于例如电子投票很有用（您可以将投票制成表格，但无法查看个人投票）。

如果您想了解详细信息，请查找[同态加密](http://en.wikipedia.org/wiki/Homomorphic_encryption)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T12:08:58.013

@Bill the lizard：好吧，如果您使用的是 ECB 或任何其他块模式，其中 n+1 块不需要太多关于块 n 的知识，您可以链接一个额外的块（或者甚至插入一个块，如欧洲央行的情况）。

然而，这会让你对 mitm-attacks 等持开放态度......

# eclipse - 在文件搜索中排除 Eclipse / Aptana 中的文件类型

> ID：242982
> 
> 赞同：50
> 
> 时间：2008-10-28T11:40:23.703
> 
> 标签：eclipse, editor, aptana

有没有办法排除 Aptana 或 Eclipse 文件搜索中的图像类型？我想搜索所有不是图像的文件，而不是指定我要搜索的所有文件类型。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2008-10-29T01:30:34.807

试着放一个“！” 在您不想匹配的模式前面标记 - 放置

```
!*.cgi, !*.pm, !*.sql 
```

在文件名模式部分中正在执行我正在使用 Eclipse 3.4.1 进行的测试中的工作（当模式只是 * 每种类型都有一个文件，使用该模式，它只返回 js 和 pl 文件） .

我担心模式会有点幼稚，只允许匹配其中一个的任何东西成功（即 sql 文件将匹配！*.cgi），但情况似乎并非如此。

# .net - 在设计、实施和维护 CRUD 上所付出的努力

> ID：242988
> 
> 赞同：3
> 
> 时间：2008-10-28T11:43:13.430
> 
> 标签：.net, database, orm

您在数据访问层中实现和维护简单的创建、读取、更新和删除 (CRUD) 方法上花费了多少百分比的开发工作？

迁移到像 Hibernate 或 Entity Framework 这样的 ORM 会带来显着的节省吗？当您的数据访问层迁移到 ORM 是一个不错的选择时，是否有任何设计异味让您知道？

亲切的问候，阿希什

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T12:21:47.957

最近花了荒谬的小时数（可能大约 40%）来复制 ORM 在几分钟内完成的工作，我不得不说，只要您可以允许经过良好测试的框架生成（并维护！）基本的 CRUD 操作，让它做它！

让框架做它擅长的事情。将时间花在真正增加价值的应用程序部分，即您正在解决的业务问题上。只有当框架不足时，您才真正考虑解决它。“功亏一篑”可能包括性能，但通常框架内有“钩子和旋钮”让你做你需要完成的事情。

实现/设计气味：当您第 40 次编写“StoredProcedureWrapper”或通过捕获 DAO 输出实现查询结果缓存时，您可以/应该使用 ORM

对于 Ruby/Rails 或 Groovy/Grails 类型的框架，我看不出*不*从 ORM 层开始的真正理由，因为这两种环境都会为您生成域。

使用 Spring/Hibernate 会稍微复杂一些，但仍然省去了很多非常相似的小类的手工编码。

在过去 10 年左右的时间里，我还在几个项目中发现，如果我们没有开始使用 ORM，我们最终会开发或“窃取”JDBC 框架或其他脚手架代码，这些代码再次复制了 ORM 的很多功能我懂了。

# javascript - HTML选择事件的名称是什么？HTML“选择”元素是否有选择事件？事件的具体名称是什么？onchange 是您要找的吗？无论输入类型如何，每当表单输入更改值时，都应始终引发 onchange 事件。（按钮除外，因为它们本身并不是真正的输入设备。）它是 onchange 事件。jQuery 将它包装在 .change 帮助器中。如果使用纯 Javascript，则使用 addEventListner('change', function...): <html> <head&

> ID：242992
> 
> 赞同：40
> 
> 时间：2008-10-28T11:45:10.823
> 
> 标签：javascript, jquery, html, html-select

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-10-28T11:45:56.263

是[`onchange`](http://www.w3.org/TR/html401/interact/scripts.html#adef-onchange)你要找的吗？

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-27T02:49:04.810

还值得一提的是，如果选择没有改变，这不会触发（似乎不言自明）。据我所知，当用户下拉选择框然后重新选择原始值时，不会触发任何事件。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-10-28T12:06:53.523

这是[onchange 事件](http://msdn.microsoft.com/en-us/library/ms536912(VS.85).aspx)。

jQuery 将它包装在`.change`帮助程序中。如果使用纯 Javascript，则使用`addEventListner('change', function...)`：

```
<html>
<head>
    <script type="text/javascript" src="jquery-1.2.6.js"></script>
    <script type="text/javascript">

// If using jQuery
$(document).ready( function() {
    $("#list").attr( "selectedIndex", -1 );
    $("#list").change( function() {
        $("#answer").text( $("#list option:selected").val() );
    });
});
    </script>

    <script type="text/javascript">

// Plain Javascript:
document.addEventListener('DOMContentLoaded', function(event) {
    var selectList = document.getElementById("list");
    var divAnswer  = document.getElementById("answer");
    selectList.addEventListener("change", function(changeEvent) {
        divAnswer.textContent = selectList.value;
    });
});
    </script>

</head>
<body>
    <div id="answer">No answer</div>
    <form>
        Answer
        <select id="list">
            <option value="Answer A">A</option>
            <option value="Answer B">B</option>
            <option value="Answer C">C</option>
        </select>
    </form>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-28T11:48:07.853

无论输入类型如何，每当表单输入更改值时，`onchange`都应始终引发事件。（按钮除外，因为它们本身并不是真正的输入设备。）

# c# - 强类型资源导致问题？

> ID：242998
> 
> 赞同：1
> 
> 时间：2008-10-28T11:47:39.367
> 
> 标签：c#, .net, asp.net, .net-2.0, resources

在一些重构过程中，我将资源文件从一个项目移动到另一个项目。我想我点击了一个警告，告诉我在某一时刻强烈键入资源文件，现在我得到：

> 找不到适合指定区域性或中性区域性的任何资源。确保“MyProject.Common.ResourceManagement.resources”在编译时正确嵌入或链接到程序集“MyProject.Common”中，或者所有所需的附属程序集都是可加载的并且完全签名。

这是来自我相信的 MissingManifestResourceException 。

[http://msdn.microsoft.com/en-us/library/system.resources.missingmanifestresourceexception.aspx](http://msdn.microsoft.com/en-us/library/system.resources.missingmanifestresourceexception.aspx)

我查找了几个解决方案：

*   [http://weblogs.asp.net/ngur/archive/2003/12/28/46219.aspx](http://weblogs.asp.net/ngur/archive/2003/12/28/46219.aspx)
*   [http://jameswho.blogspot.com/2004/06/missingmanifestresourceexception.html](http://jameswho.blogspot.com/2004/06/missingmanifestresourceexception.html)
*   [http://support.microsoft.com/kb/318603](http://support.microsoft.com/kb/318603)

但它们似乎都与我的情况无关。

有任何想法吗？这几天一直困扰着我。

我在做傻事吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T11:08:08.797

您确定这些资源文件已嵌入程序集中吗？也许您在移动文件时丢失了“嵌入式资源”设置。此外，资源名称可能已更改。资源的完全限定名称是 AssemblyName + 物理子文件夹 + 资源名称

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T14:29:20.740

您可以将它们从原始项目导出到文本文件并将它们导入到新项目中吗？如果它只是键/值对，它应该很简单。**********************