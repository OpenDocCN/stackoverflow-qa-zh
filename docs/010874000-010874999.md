# StackOverflow 问答 10874000-10874999

# design-patterns - 如何将适配器模式与更多适配器一起使用？

> ID：10874003
> 
> 赞同：0
> 
> 时间：2012-06-03T21:14:43.650
> 
> 标签：design-patterns

我只是想知道如何将适配器模式与更多适配器一起使用？

```
class MainApp
{
    static void Main()
    {
        Target target = new Adapter();
        target.Request();

        Console.ReadKey();
    }
}

class Target
{
    public virtual void Request()
    {
        Console.WriteLine("Called Target Request()");
    }
}

class Adapter : Target
{
    private Adaptee _adaptee = new Adaptee();

    public override void Request()
    {
        _adaptee.SpecificRequest();
    }
}

class Adaptee
{
    public void SpecificRequest()
    {
        Console.WriteLine("Called SpecificRequest()");
    }
} 
```

正如您在这种情况下所看到的，我们只有一个适配者，但如果我们有多个没有任何相似之处的适配者，我不确定如何使用该模式。

感谢任何可以提出建议的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T21:28:30.697

装饰适配器并实现一个通用接口来表示装饰适配器的集合？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T21:29:29.883

适配器使某些适配器适应给定的接口。因此，如果您想与更多的适配器共享**一个**适配器，那么只有当它们共享相同的接口时才有意义。所以你总是必须“有一些相似之处”。

# wpf - 如何在 Visual Studio 2012 中使用 WPF 项目设计动画？

> ID：10874005
> 
> 赞同：1
> 
> 时间：2012-06-03T21:14:48.293
> 
> 标签：wpf, visual-studio

更新：

Visual Studio 2012 RTM 仍然不支持开箱即用地创建/编辑动画（通过对象和时间线）......无论是在随附的 Expression Blend for Visual Studio（不支持 WPF）中还是在 Visual Studio IDE 本身中。

但是，现在有一个名为“Blend + SketchFlow Preview for Microsoft Visual Studio 2012”的东西可以用于 WPF 和 Silverlight 项目。

*   [http://expression.microsoft.com/en-us/jj154135](http://expression.microsoft.com/en-us/jj154135)

但它仅在 Windows 7 SP1 和 Windows 8 上受支持。

它的版本号是 5.2.30810.0。

* * *

在 Windows 8 RC 32 位上安装的 Visual Studio 2012 RC 中，似乎没有任何地方的对象和时间线窗口。

并尝试 Blend 5.0.30514.0 它不允许您创建或打开 WPF 项目并获得设计师支持....什么给了？

应该如何使用 Visual Studio 2012 在 .NET 4.5 中正确执行 WPF（即执行动画/视觉状态的能力）？

更新：除非其他人知道得更好，否则您必须使用多个版本的 Blend。

*   对 WPF 使用 Blend 4 (4.0.20525 + SP1 4.0.20901)
*   仅对 Silverlight 5 使用 Silverlight 5 (4.1.20402) 的混合预览
*   仅对 Metro 使用 Blend for Visual Studio 2012 (5.0.30514)

此外，当您在 Blend 4.0.20525 中打开 Visual Studio 2012 项目时，会出现警告。

我想如果您在 Visual Studio 2012 发布时购买它，您将不得不尝试购买 Blend 的旧副本才能正确进行 WPF 开发。

# python - sphinx-quickstart 在 WinXP 上不起作用

> ID：10874011
> 
> 赞同：1
> 
> 时间：2012-06-03T21:15:25.337
> 
> 标签：python, python-sphinx

我在 winxp 上安装了 Python(x,y) 发行版，其中包括用于制作文档的 sphinx 模块。

设置 sphinx 的第一步是在提示符下运行“sphinx-quickstart”命令。它只是没有响应。当我输入时没有任何反应。

我检查了模块。它似乎安装正确。我是否缺少在 DOS 提示符下运行它所需的一些工具。我也尝试在 cygwin 终端中执行此操作，但它也无法在那里工作。

谢谢

PS：Sphinx 可以作为 Python shell 中的模块导入。是否可以完全通过 Python shell 使用 sphinx？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T00:15:41.070

事实证明，Python/Scripts 文件夹中的一些文件是应用程序，而不仅仅是脚本。而且这些应用程序中的大多数都不适用于 DOS 模式。

因此，我不得不通过专门针对 Windows 的发行版重新安装一些软件包，包括 setuptools 和 sphinx，而当我安装 Python(x,y) 发行版中的所有内容时，情况并非如此。

这工作正常，但有一些扭结。

# java - 这种位操作在 Java 中是如何工作的？

> ID：10874012
> 
> 赞同：8
> 
> 时间：2012-06-03T21:15:35.413
> 
> 标签：java, integer, bit-manipulation

我正在研究 Java 如何计算 int 的位集。
我脑子里有这样简单的事情（我认为这是正确的）：

```
public static int bitCount(int number){  
        final int MASK = 0x1;  
        int count = 0;  

        for(int i = 0; i < 32; i++){  
            if(((number >>> i) & MASK) == MASK){  
                count++;  
            }  
        }  
        return count;  
    } 
```

相反，我找到了一种我完全不知道在做什么的方法（对我来说似乎很神奇）：

```
 i = i - ((i >>> 1) & 0x55555555);  
 i = (i & 0x33333333) + ((i >>> 2) & 0x33333333);  
 i = (i + (i >>> 4)) & 0x0f0f0f0f;  
 i = i + (i >>> 8);  
 i = i + (i >>> 16);  
 return i & 0x3f; 
```

有人可以帮助理解它的作用以及为什么像我最初想到的那样简单的功能是/可能是坏的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-03T22:30:56.960

当然

```
i = i - ((i >>> 1) & 0x55555555); 
```

5 的位模式是`0101`（四位），所以掩码是位模式的`01`16 次重复。该行计算数字的每个两位对中的位数。如果考虑两位对，`(i >>> 1) & 0x1`则在低位获得高位。现在，有四种可能的两位模式

```
00 ~> 00 - 00 = 00
01 ~> 01 - 00 = 01
10 ~> 10 - 01 = 01
11 ~> 11 - 01 = 10 
```

现在每个两位对都包含原始在这些位置中的位数。

```
i = (i & 0x33333333) + ((i >>> 2) & 0x33333333); 
```

接下来，我们计算每个四位组中的位（也称为半字节）。通过用 屏蔽一个半字节`0x3 = 0011(b)`，我们可以得到该半字节低位两位的位数，并`(i >>> 2) & 0x3`从该半字节的高位两位中获得计数。现在添加了这些计数。由于每个计数最多为 2，因此总和最多为 4，因此不会离开半字节。

```
i = (i + (i >>> 4)) & 0x0f0f0f0f; 
```

现在计算每个八位字节中的位。每个半字节都包含在该位置原始设置的位数。右移四位将计数从每个位置的高位半字节移动到低位半字节，这些相加。然后我们还将计数从低位半字节移动到相邻八位字节的高阶半字节，这被`& 0x0f0f0f0f`. 由于每个八位字节最多可以设置八位，因此计数不会离开八位字节的低位半字节。

```
i = i + (i >>> 8); 
```

现在我们添加相邻八位字节对的计数。

```
i = i + (i >>> 16); 
```

现在我们将高位两个八位字节和低位两个八位字节的总数相加。

```
return i & 0x3f; 
```

最后，除了最低阶八位位组之外的所有八位位组都被屏蔽掉，因为高阶八位位组仍然包含中间计数。

您的简单实现可能被认为不好的原因是性能。复杂的 bit-hack 使用更少的操作并且没有分支，所以它更快。然而，犯错要容易得多。

`int`另一种计算（或`long`）中设置位的巧妙方法是

```
public static int bitCount(int n) {
    int count = 0;
    while(n != 0) {
        ++count;
        n = n & (n-1);
    }
    return count;
} 
```

之所以有效，是因为`n = n & (n-1)`清除了最后一个设置位`n`并保持其他所有内容不变。如果位模式`n`以

```
...100...0 
```

的位模式`n-1`是

```
...011...1 
```

并且最后一位之前的位`n`是相同的。在 Java 中，这保证也适用于负数，因为整数溢出具有环绕语义，所以如果`n = Integer.MIN_VALUE`，位模式是`100...0`并且`n - 1`变成`Integer.MAX_VALUE`位模式`011...1`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T22:26:01.443

cool 方法仅适用于计算机具有有限范围的 int 值。对于无限范围（如 BigInteger），它不会那么容易工作（以及其他很酷的位算法），因为您需要在计算之前知道所有需要的掩码。

无论如何，您可以通过以下方式阅读它的工作原理：http: [//graphics.stanford.edu/~seander/bithacks.html#CountBitsSetParallel](http://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetParallel)

它在本章的底部。

# python - OperationalError：无法打开数据库文件

> ID：10874013
> 
> 赞同：3
> 
> 时间：2012-06-03T21:15:35.327
> 
> 标签：python, database, sqlite, flask, database-connection

我正在浏览一个简单的博客/cms 的 Flask 教程，但我似乎无法打开/创建数据库。

我目前在 Windows 7 上，当我查看应用程序时，我得到一个 sqlite3.OperationalError OperationalError：无法在网页上打开数据库文件错误。我试过用谷歌搜索这个问题，但我无法解决它。我认为这与我使用的是 Windows 有关。任何人都可以帮忙吗？

```
DATABASE = 'C:\Users\Brad\Documents\flaskr\flaskr.db'

def connect_db():
return sqlite3.connect(app.config['DATABASE'])

def init_db():
    with closing(connect_db()) as db:
       with app.open_resource('schema.sql') as f:
        db.cursor().executescript(f.read())
    db.commit() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-03T21:29:41.670

正确转义你的字符串：

```
DATABASE = 'C:\\Users\\Brad\\Documents\\flaskr\\flaskr.db' 
```

# mongodb - OCaml 的 MongoDB 客户端

> ID：10874015
> 
> 赞同：3
> 
> 时间：2012-06-03T21:15:48.923
> 
> 标签：mongodb, ocaml

我找不到 OCaml 的 MongoDB 客户端库，有吗？我在 github 上找到[了一些东西](https://github.com/kiyoto/caml_mongo)，但看起来没有维护。

我认为下一个最佳选择是使用 camlidl 尝试包装 C mongo 客户端（libmongo-client），但想知道是否有人已经这样做了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T04:55:03.070

Philippe Veber[在邮件列表](http://permalink.gmane.org/gmane.comp.lang.caml.inria/51429)中说他正在寻找一些东西，但显然还没有发布代码。你应该联系他询问他的反馈。

我会选择您指向的现有绑定，然后扩展它。一些繁重的工作已经完成，它的优点是不强迫您与 C 代码交互（恕我直言，这绝不是一种好的体验）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-30T15:01:15.587

看看似乎正在获得关注的[Mongo.ml](https://github.com/MassD/mongo)，它甚至出现在[MongoDB 社区支持的驱动程序页面](http://docs.mongodb.org/ecosystem/drivers/community-supported-drivers/)中。

# c# - 在不依赖行状态准确性的情况下将 DataTable 中的行保存/合并到数据库？

> ID：10874018
> 
> 赞同：3
> 
> 时间：2012-06-03T21:16:39.437
> 
> 标签：c#, .net, vb.net, datatable

我需要在 C# 中编写一个方法来将给定数据表中的所有行保存回数据库，但我不能依赖每一行的行状态。如果没有大量循环数据库表数据或不断的数据库查询，我想不出如何最好地做到这一点。

我想基本上对数据表中的每一行执行以下插入/更新，但更有效：

```
INSERT INTO table
(   col1,
    col2    )
SELECT
    'value1',
    'value2'
FROM dual
WHERE NOT EXISTS ( SELECT * FROM table WHERE col1 = 'value1' );

UPDATE table
SET col2 = 'value2'
WHERE col1 = 'value1'; 
```

我在想这样的结构将是最有效的：

```
private void SaveDataTable(DataTable dataTable)
{
    //Remove data from the dataTable where it already exists in the database

    //Determine if the values are to be inserted or updated

    //Save relevant data
} 
```

关于如何最好地做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T01:26:22.367

我强烈建议您让数据库管理它，而不是从应用程序的角度来处理它。SQL Server 针对集合操作进行了优化，您基本上想要执行两个集合操作：

*   更新表中存在的所有记录，这些记录与您的表中也存在的记录不同[`DataTable`](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)
*   插入`DataTable`表中不存在的所有记录

为此，我建议创建一个新表`tableStaging`：

```
create table tableStaging (
    batchId uniqueidentifier not null, col1 int not null, col2 int not null) 
```

几个重要的点：

*   该`batchId`列允许您识别应用程序的不同调用者同时执行的多个操作。您希望为正在执行此操作的每个集合而不是每条记录生成*一次此值。*
*   该`batchId`列是一个[`uniqueidentifier`](http://msdn.microsoft.com/en-us/library/ms187942.aspx)，因为它转换为一个[`Guid`结构](http://msdn.microsoft.com/en-us/library/system.guid.aspx)，并且可以通过调用在客户端轻松生成[`Guid.NewGuid`](http://msdn.microsoft.com/en-us/library/system.guid.newguid.aspx)。
*   您可能希望有一个复合主键，它由表`batchId`的主键和任何主键组成，`table`以使即将进行的操作更高效。

完成此操作后，您可以使用[`SqlBulkCopy`该类](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)批量插入您的记录`DataTable`（[有一个重载`WriteToServer`需要一个`DataTable`实例](http://msdn.microsoft.com/en-us/library/ex21zs8x.aspx)）。

最后，一旦记录在`tableStaging`类中，您可以调用一个存储过程，该过程只需对两个表之间存在列和主键[`update`](http://msdn.microsoft.com/en-us/library/ms177523.aspx)的所有项目执行一个[插入](http://msdn.microsoft.com/en-us/library/ms174335)操作，对临时表中存在的项目而不是在目标表。或者，如果您使用的是 SQL Server 2008，则可以使用该[语句](http://technet.microsoft.com/en-us/library/bb510625.aspx)并一次性完成这两项操作。`batchId`[`merge`](http://technet.microsoft.com/en-us/library/bb510625.aspx)

然后，只需清理临时表即可。由于您有`batchId`调用存储过程/运行命令的时间，因此您可以在完成更新主表时删除记录，或者，您可以等到您知道没有人会使用它并[`truncate table`](http://msdn.microsoft.com/en-us/library/ms177570.aspx)调用表（临时表不应该*有*外键，所以`truncate table`应该可以正常工作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:22:12.047

虽然我无法避免查询给定数据表中的每一行，但我认为这暂时可行。感谢您的回复；他们都非常有帮助。

（Oracle 特定）：

```
internal override bool RecordExists(DataRow row)
{
    string query = string.Concat("SELECT 1 FROM ", row.Table.TableName, " ", GetDbTableFilter(row, row.Table.PrimaryKey), " AND ROWNUM = 1");

    using(OracleCommand cmd = new OracleCommand(query, (OracleConnection)_connectionLibrary.CurrentConnection))
        using(OracleDataReader reader = cmd.ExecuteReader())
            return (reader != null && reader.Read());
}

internal override string GetDbTableFilter(DataRow row, DataColumn[] columns)
{
    string filter = "";

    foreach (DataColumn column in columns)
    {
        if (!string.IsNullOrEmpty(filter))
            filter += " AND ";

        if (string.IsNullOrEmpty(row[column].ToString()))
        {
            filter += string.Concat("(", column.ColumnName, " IS NULL OR TRIM(", column.ColumnName, ") = '')");
            continue;
        }

        if (column.DataType.Equals(typeof(DateTime)))
        {
            filter += string.Concat(column.ColumnName, " = TO_DATE('", row[column].ToString(), "')");
            continue;
        }

        filter += string.Concat(column.ColumnName, " = '", row[column].ToString(), "'");
    }

    return string.Concat("WHERE ", filter);
}

public override void SaveDataTable(DataTable dataTable)
{
    dataTable.AcceptChanges();

    foreach (DataRow row in dataTable.Rows)
        if(RecordExists(row))
            row.SetModified();
        else
            row.SetAdded();

    using (OracleDataAdapter adapter = new OracleDataAdapter(string.Format("SELECT * FROM {0}", dataTable.TableName), (OracleConnection)_connectionLibrary.CurrentConnection))
        using (OracleCommandBuilder commandBuilder = new OracleCommandBuilder(adapter))
        {
            commandBuilder.SetAllValues = true;
            commandBuilder.ConflictOption = ConflictOption.OverwriteChanges;

            adapter.InsertCommand = commandBuilder.GetInsertCommand(true);
            adapter.UpdateCommand = commandBuilder.GetUpdateCommand(true);

            adapter.Update(dataTable);
        }
} 
```

# objective-c - 如何制作类似于 QuickTweet Mac 应用程序的圆形浮动窗口

> ID：10874019
> 
> 赞同：2
> 
> 时间：2012-06-03T21:16:57.157
> 
> 标签：objective-c, xcode, macos, geometry

应用程序链接： http: [//itunes.apple.com/en/app/quick-tweet/id505987287](http://itunes.apple.com/en/app/quick-tweet/id505987287?mt=12)
?mt=12我怎样才能做出这样的圈子？那是一个透明的窗口，还是……？我想在我的应用程序中创建类似的东西。一个可以拖动到桌面任何位置的圆圈（即使在任何应用程序的前面，无论是否全屏），当用户单击按钮时会出现一个弹出窗口。
如果有一些代码可以做到这一点，我将非常感激。
谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T21:34:58.890

查看 Apple 的[RoundTransparentWindow 示例代码](https://developer.apple.com/library/mac/#samplecode/RoundTransparentWindow/Introduction/Intro.html)。

您基本上制作了一个无边框窗口，设置为不透明，并将其背景颜色设置为清晰。然后，无论其内容的形状如何——无论在其内容视图中绘制什么——都是窗口的形状。

# perl - 下载失败如何不退出？

> ID：10874021
> 
> 赞同：1
> 
> 时间：2012-06-03T21:17:21.657
> 
> 标签：perl, mechanize

如何下载文件`WWW::Mechanize`而不退出失败的下载？

```
#!/usr/bin/perl

use strict;
use WWW::Mechanize;

my $mech = WWW::Mechanize->new();

$mech->get("http://google.com/test", ':content_file' => "tmp");

print "done"; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-03T22:36:51.593

您可以`autocheck => 0`在构造函数中使用：

```
#!/usr/bin/perl

use strict;
use WWW::Mechanize;

my $mech = WWW::Mechanize->new(
    # perldoc WWW::Mechanize | less +/autocheck
    autocheck => 0
);

$mech->get("http://google.com/test", ':content_file' => "tmp");

# Now, need to check errors manually :
# test on the HTTP return code see :
# http://en.wikipedia.org/wiki/List_of_HTTP_status_codes
my $retcode = $mech->status();
if ($retcode >= 400) {
    warn("error getting url, HTTP code: [$retcode]\n");
}

print "done\n"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-03T22:32:44.643

使用[Try::Tiny](http://search.cpan.org/perldoc?Try%3a%3aTiny)

```
#!/usr/bin/perl

use strict;
use WWW::Mechanize;
use Try::Tiny;

my $mech = WWW::Mechanize->new();

try {
    $mech->get("http://google.com/test", ':content_file' => "tmp");
}
catch {
    print "failed: $_";
}; # <-- do not forget the semicolon

print "done"; 
```

`catch`如果您只想消除错误，请忽略该块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T21:36:48.953

它会因下载失败而死吗？`eval`如果是这样，请尝试用..将该调用包装为“获取”

# c - 嵌入式编译不喜欢 char *var[]={"data","data"};

> ID：10874022
> 
> 赞同：2
> 
> 时间：2012-06-03T21:17:44.557
> 
> 标签：c, embedded, char

我正在使用 MPLabs [C18 C 编译器开发](http://abarry.org/pic/C18_User_Guide_51288j.pdf)[PIC 18f4685](http://www.robokits.co.in/datasheets/PIC18F4685.pdf)，当我尝试创建一组要打印到 LCD 上的短语时遇到问题。

如果我将 Codeblocks 与 gcc 一起使用并输入此代码，它会打印出我对控制台的期望... `test1 test2 test3 test4`：

```
char *test[]={"test1","test2","test3","test4"};
printf("%s %s %s %s\n",test[0],test[1],test[2],test[3]); 
```

但是，如果我在 C18 中使用此代码：

```
 char *phrase[]={"test1","test2"}; 
```

我收到警告说`type qualifier mismatch in assignment`，当我对芯片进行编程时，它会向 LCD 吐出垃圾，我有点期待它会这样做。

什么是声明我的短语的正确方法，因为某些东西显然是不正确的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T21:27:57.417

显然字符串文字`rom const char[N]`在 MPLab C 中。所以你需要像这样声明你的对象：

```
rom const char *rom test[]={"test1","test2","test3","test4"}; 
```

在[MPLAB C18 C 编译器用户指南](http://ww1.microchip.com/downloads/en/devicedoc/51288f.pdf)中，有一章名为 ISO DIVERGENCES (2.7)，2.7.3 指的是字符串文字。

从 2.7.3 开始：

> 使用 MPLAB C18 时，程序存储器中的字符串表可以声明为：
> 
> ```
> rom const char table[][20] =   { "string 1", "string 2",  
>                                  "string 3", "string 4" }; 
> rom const char *rom table2[] = { "string 1", "string 2", 
>                                  "string 3", "string 4" }; 
> ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T21:29:42.783

我认为@awoodland（现已删除）的答案基本上是正确的想法。

声明：

```
char *phrase[] = {"test1", "test2"}; 
```

是完全有效的 C，但它可能存在问题。C 字符串文字不是`const`，但尝试修改它们具有未定义的行为。（它们实际上是`const`在 C++ 中，这会使上述声明非法。）

C18 很可能正在强制执行`const`字符串文字。如果是这样，您应该能够通过添加`const`关键字来避免错误：

```
const char *phrase[] = {"test1", "test2"}; 
```

无论如何，在此处添加`const`是一个好主意，因为没有它，编译器将无法诊断修改其中一个字符串的尝试。

请注意，gcc 的`-Wwrite-strings`选项启用了类似的非标准功能。

**编辑 ：**

见 ouah 的回答。标准 C中`const`不需要 ，但无论如何使用它是个好主意。对于这个特定的实现，您还需要添加一个系统特定的`rom`关键字。

# php - 关于使用 codeigniter 的 base_url() 的最佳实践/优化

> ID：10874023
> 
> 赞同：1
> 
> 时间：2012-06-03T21:17:54.383
> 
> 标签：php, codeigniter, optimization

我的问题是指base_url()，它是codeigniter 的辅助函数。这个想法是它抓取我的应用程序的 base_url 并允许我在任何视图页面上的任何位置回显它。

下面是我将使用 base_url() 的示例。

```
<script type="text/javascript" language="javascript" src="<?php echo base_url(); ?>assets/js/jquery.js"></script> 
```

我有时会在 DOM 加载中多次调用它，并且想知道将其存储到 php 变量中是否是个好主意，而不是每次都调用 base_url 函数。像这样：

```
<?php 
  $this->load->helper('url'); 
  $base_url = base_url(); // Set to variable, so we don't method call each time
?>

<script type="text/javascript" language="javascript" src="<?php echo $base_url; ?>assets/js/jquery.js"></script> 
```

我知道这是一个相当新手的问题，但我对优化一直很强迫症，我想知道添加代码是否值得。我必须两次添加变量的定义，因为我在头部和身体中都使用了 base_url()。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T21:30:33.550

从性能的角度来看，这两种方式都无关紧要。做任何使您的代码更易于阅读/维护的事情。但是不要将它放在会话中。

附带说明一下，如果您担心微优化，则不应首先使用 PHP，因为就原始处理能力而言，它是最慢的事情之一。

# java - 圆形图的数据结构和算法

> ID：10874024
> 
> 赞同：2
> 
> 时间：2012-06-03T21:18:07.087
> 
> 标签：java, algorithm, tree

我需要为 Web 客户端定义和使用`Data Structure`。 在服务器端，数据将以 2 列 CSV 格式（例如发送方、接收方）提供。 最终输出将以格式呈现并发送到 Web 请求。 我已经看到了一些可以帮助建立亲子关系的例子。但就我而言，我有一个递归关系；当我陷入无限循环时，这让生活变得有点困难。`Algorithm``Circular Data Graph`

`JSON`
`Tree``i.e. A Parent's grand child can also be used as a Parent`

**数据：**

```
Sender,Receiver
A,B
A,H
B,C
B,D
D,E
E,F
F,G
G,C
H,I
H,J
J,K
K,L
L,M
M,K
L,N
N,O
N,P
P,A
N,Q 
```

客户端可能会这样渲染（我只关心 Java 结构）：
客户端可以请求任何节点，我必须生成整个树并发送响应，即 A、K 或 N。

![在此处输入图像描述](../Images/a2417237e95ccbaf254d364ffccb1716.png)

**问题：**

1.  什么是最`Data Structure`适合这个要求的？例如`Tree`喜欢或任何其他？
2.  我应该编写自己的逻辑来读取数据并设置，`Tree`还是有任何标准算法？
3.  避免递归的最佳方法是什么？

任何工作示例都会在这里真正有所帮助:)

另请参阅下面的我的工作解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-03T22:04:39.110

我确信您已经找到的树示例在如何实现树状结构方面是正确的。在您的情况下，您有一个额外的复杂性，即递归循环可能存在，因为某些子级将是对其祖先之一的精确对象引用。（正确的？）

由于这种复杂性，任何试图通过遍历每个节点的子节点来遍历树的进程都会循环这些递归连接，直到发生堆栈溢出。

在这种情况下，您不再是真正处理一棵树。在数学上，树被定义为[没有环的图](http://en.wikipedia.org/wiki/Tree_%28graph_theory%29)。在您的情况下，您有[循环](http://en.wikipedia.org/wiki/Closed_walk)，因此不是树，而是[圆形图](http://en.wikipedia.org/wiki/Cycle_graph)。

我过去处理过这种情况，我认为你可以通过两种方式处理这种情况。

1.  打破循环（在对象级别），返回树。在这些递归连接之一发生的地方，不要放置对祖先的真实对象引用，而是放置一个存根，指示它连接到哪个对象，而不是对该项目*的*对象引用。

2.  接受您有一个圆形图，并确保您的代码在遍历该图时可以处理这个问题。确保与您的图形交互的任何客户端代码都可以检测到它何时位于递归分支中并适当地处理它。

恕我直言，选项 2 不是很有吸引力，因为您可能会发现很难保证约束，并且通常会导致错误。只要您可以为树中的每个项目分配一个唯一标识符，选项 1 就可以很好地工作，尽管客户端仍然需要意识到这种可能性的发生，以便他们可以处理解耦链接并正确表示它（例如在树中查看用户界面）。您仍然想要为圆形图建模，但将使用树在对象级别表示它，因为它简化了代码（和表示）。

选项 1 的完整示例：

```
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

public class CyclicGraphTest 
{   
    public static void main(String[] args) 
    {       
        new CyclicGraphTest().test();           
    }

    public void test()
    {
        NodeManager manager = new NodeManager();
        Node root = manager.processNode("ZZZ");
        root.add(manager.processNode("AAA"));
        manager.get("AAA").add(manager.processNode("BBB"));
        manager.get("AAA").add(manager.processNode("CCC"));
        manager.get("AAA").add(manager.processNode("DDD")); 
        manager.get("DDD").add(manager.processNode("EEE"));
        manager.get("EEE").add(manager.processNode("FFF"));
        manager.get("FFF").add(manager.processNode("AAA"));
        manager.get("AAA").add(manager.processNode("JJJ")); 
        root.add(manager.processNode("EEE"));
        GraphWalker walker = new GraphWalker(manager, root, 1);
        System.out.println(walker.printGraph());        
    }

    /**
     * Basic Node
     */
    public class Node implements Iterable<Node>
    {
        private String id;
        private List<Node> children = new ArrayList<Node>();

        public Node(String id) {            
            this.id = id;
        }

        public boolean add(Node e) {
            return children.add(e);
        }

        public String getId() {
            return id;
        }

        @Override
        public Iterator<Node> iterator() {          
            return children.iterator();
        }           
    }

    /**
     * Cyclical Reference
     * 
     */
    public class ReferenceNode extends Node
    {
        private String refId;

        public ReferenceNode(String id, String refId) {
            super(id);
            this.refId = refId;
        }

        @Override
        public boolean add(Node e) {
            throw new UnsupportedOperationException("Cannot add children to a reference");
        }

        public String getRefId() {
            return refId;
        }           
    }   

    /**
     * Keeps track of all our nodes. Handles creating reference nodes for existing
     * nodes.
     */
    public class NodeManager
    {
        private Map<String, Node> map = new HashMap<String, Node>();

        public Node get(String key) {
            return map.get(key);
        }

        public Node processNode(String id)
        {
            Node node = null;
            if(map.containsKey(id))
            {
                node = new ReferenceNode(getRefId(id), id);
                map.put(node.getId(), node);                
            }
            else
            {
                node = new Node(id);
                map.put(id, node);
            }
            return node;
        }

        private String getRefId(String id) {
            int i = 0;
            String refId = null;
            while(map.containsKey(refId = id + "###" + i)) { i++; }
            return refId;
        }

        public Node resolve(ReferenceNode node) {
            return map.get(node.getRefId());
        }
    }

    /**
     * Walks a tree representing a cyclical graph down to a specified level of recursion
     */
    public class GraphWalker
    {
        private NodeManager manager;
        private Node root;
        private int maxRecursiveLevel;

        public GraphWalker(NodeManager manager, Node root, int recursiveLevel) {
            super();
            this.manager = manager;
            this.root = root;
            this.maxRecursiveLevel = recursiveLevel;
        }

        public String printGraph()
        {
            return printNode(root, 0, "   ").toString();
        }

        private StringBuilder printNode(Node node, int recursionDepth, String prefix) {
            Node resolvedNode = resolveNode(node, recursionDepth);
            if(resolvedNode != node) {
                recursionDepth ++;
                node = resolvedNode;
            }
            StringBuilder sb = new StringBuilder(node.getId());
            int i = 0;
            for(Node child : node)
            {
                if(i != 0) sb.append("\n").append(prefix);
                sb.append(" -> ").append(printNode(child, recursionDepth, prefix + "       "));             
                i++;
            }
            return sb;
        }

        /**
         * Returns a resolved reference to another node for reference nodes when the 
         * recursion depth is less than the maximum allowed
         * @param node
         * @param recursionDepth
         * @return
         */
        private Node resolveNode(Node node, int recursionDepth) 
        {           
            return (node instanceof ReferenceNode) && (recursionDepth < maxRecursiveLevel) ? 
                    manager.resolve((ReferenceNode) node) : node;
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T21:43:17.507

将您的示例存储在内存中？既然你描述的是一个Graph，那就看看这个：[在内存中存储一​​个graph的三种方式，优点和缺点](https://stackoverflow.com/questions/3287003/three-ways-to-store-a-graph-in-memory-advantages-and-disadvantages)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:42:12.637

我自己的解决方案：

```
public class MyTree 
{
    static Set<String> fileDataList = new HashSet<String>();
    static
    {
        fileDataList.add("A,B");
        fileDataList.add("A,B");
        fileDataList.add("A,H");
        fileDataList.add("B,C");
        fileDataList.add("B,D");
        fileDataList.add("D,E");
        fileDataList.add("E,F");
        fileDataList.add("F,G");
        fileDataList.add("G,C");
        fileDataList.add("H,I");
        fileDataList.add("H,J");
        fileDataList.add("J,K");
        fileDataList.add("K,L");
        fileDataList.add("L,M");
        fileDataList.add("M,K");
        fileDataList.add("L,N");
        fileDataList.add("N,O");
        fileDataList.add("N,Q");
        fileDataList.add("O,P");
        fileDataList.add("P,A");
    }

    static Map<String, Set<String>> dataMap =new HashMap<String, Set<String>>();
    static Map<String, Set<Node>> nodeMap =new HashMap<String, Set<Node>>();

    public static void main(String args[]) throws IOException
    {
        //String fileName= "data.csv";
        //fileDataList = JSSTest.getFileData(fileName);        
        //String lineageFor="100";
        String lineageFor="A";

        //Build map
        for(String kv : fileDataList)
        {
            String arr[] = kv.split(",");
            String p = arr[0];
            String c = arr[1];
            if(dataMap.containsKey(p))
            {
                dataMap.get(p).add(c);
            }
            else
            {
                Set<String> list = new HashSet<String>();
                list.add(c);
                dataMap.put(p, list);
            }
        }

        //Get the lineage for Application
        Node lineage = getLineage(lineageFor);
        print(lineage, "");
    }

    private static void print(Node node, String space) 
    {
        System.out.println(space + node.getName());

        if(node.getInNode() != null && node.getInNode().size() > 0)
        {
            for(Node child:node.getInNode())
            {
                if(child.getRecursive() == null)
                {
                    print(child, space+".");
                }
                else
                {
                    System.out.println(space + child.getName());
                    System.out.println(space  + "."+ child.getRecursive().getName());
                }
            }
        }
    }

    /**
     * Get Lineage
     * @param appName
     * @return
     */
    private static Node getLineage(String appName) 
    {
        Node node = new Node(appName);
        Set<String> allInNodes = new HashSet<String>();
        setInnerNodes(node, dataMap.get(appName), allInNodes);
        return node;
    }

    private static void setInnerNodes(Node node, Set<String> childrenList, Set<String> allInNodes) 
    {
        if(childrenList == null) return;

        for(String child:childrenList)
        {
            Node containedNode = nodeContains(node, child);
            if(containedNode != null)
            {
                node.setRecursive(new Node(child));
                continue;
            }

            Node childNode = new Node(child);            
            node.addNode(childNode);
            if(dataMap.containsKey(child))
            {
                setInnerNodes(childNode, dataMap.get(child), allInNodes);
            }
        }
    }

    static int nodeCounter=1;
    private static Node nodeContains(Node node, String child) 
    {
        if(node.getName().equals(child)) return node;

        if(node.getParent() != null)
        {
            if(node.getParent().getName().equals(child)) return node.getParent();

            if(node.getParent().getParent() != null && nodeContains(node.getParent().getParent(), child) != null)
            {
                return node.getParent();
            }
        }

        return null;
    }
}
class Node
{
    private String name;
    private Node parent;
    private Node recursive;

    public Node getParent() 
    {
        return parent;
    }

    public void setParent(Node parent) {
        this.parent = parent;
    }

    private Set<Node> inNode = new LinkedHashSet<Node>();

    public Node(String name) 
    {
        this.name=name;
    }

    public void addNode(Node child)
    {
        child.parent=this;
        this.inNode.add(child);
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Set<Node> getInNode() {
        return inNode;
    }

    public void setInNode(Set<Node> inNode) {
        this.inNode = inNode;
    }

    public Node getRecursive() {
        return recursive;
    }

    public void setRecursive(Node recursive) {
        this.recursive = recursive;
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-03T21:21:04.643

使用递归并提供一个深度参数，该参数告诉每个输出元素前面有多少个空格。

类似于以下内容：

```
private final int INDENTSIZE = 4;

public void printNodes() {
    for (Node n : roots) {
        System.out.print("- " + n.getName());
        printNode(n, 1);
    }
}

private void printNode(Node n, int depth) {
    List<Node> children = n.getChildren();

    for (Node child : children) {
        printIndent(depth);
        System.out.print("- " + child.getName());
        printNode(child, depth + 1);
    }
}

private void printIndent(int depth) {
    System.out.println();
    for (int i = 0; i < depth * INDENTSIZE; i++) {
        System.out.print(" ");
    }
} 
```

当然，`getChildren()`你必须自己实现。如果您有地图或树，应该不会那么难。

但是，此示例不处理循环引用，然后将永远循环。

# c# - 正则表达式与 C# 的工作方式不同吗？

> ID：10874029
> 
> 赞同：2
> 
> 时间：2012-06-03T21:19:03.270
> 
> 标签：c#, regex, entity-framework

我正在尝试验证电子邮件字符串，似乎我在 C# 中使用的所有公共选项都不起作用一个示例，使用[http://www.regular-expressions.info/email中的正则表达式.html](http://www.regular-expressions.info/email.html)，我创建了一个具有以下属性的模型：

```
[RegularExpression(@"\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b", ErrorMessage = "Please enter a valid email address.")]
    [Required]
    [DataType(DataType.EmailAddress)]
    [Display(Name = "The Email address where we can reach you:")]
    public string Email { get; set; } 
```

出于某种原因，这总是会引发错误，即使它只是该网站的直接副本。我在正则表达式前面有 @ 参数，但是为了在 C# 中进行这项工作，我还需要考虑其他因素吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T21:23:29.567

您还需要允许小写字母。每次你有`A-Z`你都可以把它改成`A-Za-z`.

另请注意，此正则表达式拒绝某些有效的电子邮件地址，如网站上所述。例如，它拒绝来自[`.museum`顶级域](http://en.wikipedia.org/wiki/.museum)的电子邮件地址，仅举一个例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T02:30:16.720

正如您已经提供的链接中所引用的：

[http://www.regular-expressions.info/email.html](http://www.regular-expressions.info/email.html)

据称将针对任何 RFC2822 电子邮件地址进行验证的正则表达式是：

```
(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\]) 
```

请注意，此正则表达式将允许不存在的 TLD，但除非您想从事与新 TLD 保持同步的业务，否则我建议您继续使用此正则表达式。

# mongodb - 在 MongoDB 中完全复制 Capped Collections

> ID：10874031
> 
> 赞同：0
> 
> 时间：2012-06-03T21:19:17.947
> 
> 标签：mongodb, replication, database, nosql

我可以在机器 A 上设置上限集合，并在机器 B 上设置该集合的非上限复制（以便机器 B 拥有机器 A 上写入的所有数据）吗？

**背后的原因：**
机器 A 上的数据填充得非常快（每天超过 10GB），我想确保这些数据不会耗尽磁盘空间并导致整个服务器宕机。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:54:57.090

最近在 MongoDB 用户列表上提出并回答了这个问题，所以我将链接到那里的答案[，](https://groups.google.com/d/topic/mongodb-user/6NDCKa4sp1E/discussion)但对于地方性，我将总结一下：

“不，没有选择。复制的目标是在所有节点上拥有*相同的数据。”*

那里的答案还包括一种可能的方法，但它完全不受支持（也不建议）。

# java - 将 java 写入文件时产生特定读数的问题

> ID：10874032
> 
> 赞同：0
> 
> 时间：2012-06-03T21:19:23.203
> 
> 标签：java, image, swing, user-interface, jinternalframe

我正在尝试将特定`jInternalFrame`文件保存为图片。内部框架位于 a`jFrame`中的 a`jTabbedPane`中`jTabbedPane`。读数很好，除了内部框架的 50%。它不想显示读数的其余部分，因此没有错误。我想扩大图像的视图......有人可以帮助我吗？

这是通过点击监听器激活的方法：

```
private void tallennus() {
  setContentPane(jInternalFrame1); 
  this.pack();

  Dimension size = jInternalFrame1.getSize();
  BufferedImage image = new BufferedImage(size.width, (int)PageSize.A4.getHeight()+(int)PageSize.A4.getHeight(),
  BufferedImage.TYPE_INT_RGB);
  Graphics2D g2 = image.createGraphics();
  g2.setBackground(Color.WHITE);
  g2.clearRect(jInternalFrame1.getX(),jInternalFrame1.getY(),size.width,(int)PageSize.A4.getHeight() + (int)PageSize.A4.getHeight());
  g2.fillRect(jInternalFrame1.getX(),jInternalFrame1.getY(),size.width,(int)PageSize.A4.getHeight() + (int)PageSize.A4.getHeight());
  g2.scale(1, 0.75);

  super.setPreferredSize(size);
  super.paintComponents(g2); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T21:38:04.437

*   不要使用`paintComponents(`) 使用`paintComponent()`

*   不要直接使用[paintComponent()将背景绘制到](http://docs.oracle.com/javase/tutorial/2d/images/index.html)[JInternalFrame](http://docs.oracle.com/javase/tutorial/uiswing/components/internalframe.html)

*   放在那里[JPanel](http://docs.oracle.com/javase/tutorial/uiswing/components/panel.html)或`JComponent`

*   如果您只想显示图像，请将图像加载为JLabel[的](http://docs.oracle.com/javase/tutorial/uiswing/components/label.html)[Icon](http://docs.oracle.com/javase/tutorial/uiswing/components/icon.html)

*   使用[CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)而不是`JInternalFrames`

*   对于真正的分析者，请尽快使用[SSCCE编辑您的问题](http://sscce.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T13:39:59.033

非常感谢您的想法...给了我解决问题所需的所有帮助..我意识到其中一些代码是多余的，但我仍然会发布它。

```
 private void tallennus(){

  JPanel drawingPanel = new JPanel();
  drawingPanel.setSize(new Dimension((int)PageSize.A4.getWidth(),(int)PageSize.A4.getHeight()));

 jPanel11.setBackground(Color.WHITE);
 jScrollPane27.setBackground(Color.WHITE);
 jPanel11.setBackground(Color.WHITE);
 jTabbedPane1.setBackground(Color.WHITE);
 jPanel10.setBackground(Color.WHITE);
  drawingPanel.setBackground(Color.WHITE);
  drawingPanel.setForeground(Color.WHITE);
  add(drawingPanel);

 Container cont = jInternalFrame1;
jInternalFrame1.pack();
String Ifra = jInternalFrame1.getComponents().toString();

 BufferedImage sama = (BufferedImage) cont.createImage((int)PageSize.A4.getWidth(),(int)PageSize.A4.getHeight()+(int)PageSize.A4.getHeight());
 drawingPanel.add(cont);
  setContentPane(drawingPanel);

 this.pack();

Dimension size = drawingPanel.getSize();
  BufferedImage image = new BufferedImage(size.width, (int)PageSize.A4.getHeight()+400,
  BufferedImage.TYPE_INT_RGB);
  Graphics2D g2 = image.createGraphics();
   g2.setBackground(Color.WHITE);
  g2.clearRect(0,0,size.width,(int)PageSize.A4.getHeight() + 400);
 g2.clipRect(40, 90, 1200, 1450);

  g2.drawString(Ifra, TOP_ALIGNMENT, TOP_ALIGNMENT);
  g2.drawImage(sama, null, cont);
  g2.clipRect(40, 90, 1200, 1450);

  this.pack();

  paint(g2);

  try{
  ImageIO.write(image,"jpeg",new File("snap.jpg"));
  }
  catch(Exception e){}
    } 
```

# php - 使用 AJAX / jQuery 的表单通过下拉菜单设置会话

> ID：10874039
> 
> 赞同：0
> 
> 时间：2012-06-03T21:21:03.133
> 
> 标签：php, jquery, ajax, session

我相信这个问题会涉及到 AJAX、jQuery、PHP 和会话。我已经尝试了几天，但无法破解这个。多次散步后重新开始。

我只是想要一个带有不刷新/重新加载屏幕的下拉框的表单。将选择保存为 SESSION 并根据他们刚刚设置的会话“选择”或突出显示下拉选项。

所以简而言之... - 客户端选择选项（必须使用 onchange 事件而不是单击提交） - 使用 jQuery / AJAX 这有助于防止页面重新加载（正确吗？） - 下拉选择是“记住的”，因为它使用会话进行比较并“选择”它。- 还能够在同一页面上回显/打印会话。

我将在使用复选框、收音机、输入框和下拉菜单的订购表单的多个步骤中使用这个简单的示例。

如果有人知道使用下拉框的简单示例，那会让我开始。

我之前的尝试只会使用下拉列表的第一个或最后一个而不是选择的一个来设置会话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T21:37:48.653

我过去做类似事情的方式是让用户会话（作为后端的一个类）在每次页面加载时都被初始化。这样我可以保存上述变量。

但这也允许您在后台拥有一个从该用户类产生的对象数组，并可用于替换其他项目。

1）对于简单页面，您需要构建一个控件，该控件读取数组会话中选择框的默认值。

2）编写一个非常简单的PHP页面来处理更改值（我假设你只是将它存储到会话而不是数据库）

```
<?php
session_start();
$client = $_GET['cc'];
$_SESSION['package']['overrideClient'] = $client; 
echo $_SESSION['package']['overrideClient'];
?> 
```

3）绑定更改到您的下拉 var change= { changeValue : function(obj){ var val = $(obj).val(); $.ajax({ url:"path.php?Page="+val, success:function(){ //在这里做点什么 }});}};

4）现在这个项目在会话中，任何其他页面都可以使用 $_SESSION['package']['overrideClient'] 动态调用；或者通过使用会话包初始化一个类来为用户构建更复杂的处理。

这应该让你指出正确的方向:)

# asp.net-mvc - asp.net mvc - Ajax 刷新视图的 foreach 元素

> ID：10874044
> 
> 赞同：2
> 
> 时间：2012-06-03T21:22:03.593
> 
> 标签：asp.net-mvc, asp.net-mvc-3, jquery-ui, jquery

希望在退出 jquery 对话框后 ajax/刷新当前页面。

我有一个包含 foreach 循环的视图，数据是从模型中提取的，每个循环有 2 个按钮编辑/删除。当我单击“编辑按钮”时，会打开一个 jquery UI Dialog 进行编辑，当我保存 Jquery Dialog 时，我想要的是在退出对话框后 Ajax/Refresh View 的数据（当然尤其是编辑过的数据）。

我怎样才能实现它？

谢谢

这是我的观点：

```
@{
    foreach (var item in Model) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.IdPhoto)
            </td>
            <td>
                @Html.TextAreaFor(modelItem => item.Date)
            </td>
            <td>
                @Html.TextAreaFor(modelItem => item.Nom)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Category)
            </td>
            <td>
                @Html.CheckBoxFor(modelItem => item.Actif)
            </td>
            <td>

            <button class="Edit" value="@item.IdPhoto">Edit</button> 
            <button class="Delete" value="@item.IdPhoto">Delete</button> 

            </td>
        </tr>
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T21:52:58.143

我的建议是使用 jQuery 从局部视图中加载要编辑/删除的信息。然后您可以从 jQuery 对话框中编辑/删除，完成后，只需再次使用 jQuery 重新加载该部分视图。

您视图上的代码将类似于以下内容：

```
$(document).ready(function () {

    LoadInfo(); //Loads partial view

});

function LoadInfo() {

    $.get("MyAction", { param1 : myParameter }, function (data) {

        $("#mydata").empty();
        $("#mydata").html(data);
    });
} 
```

在你的控制器中：

```
 [HttpGet]
    public virtual ActionResult MyAction(parameters)
    {
        var query = GetMyDataModel();

        return PartialView("_MyPartialViewName", query);
    } 
```

当您完成编辑/删除后，您可以再次调用 LoadInfo()，它会重新加载页面的该部分。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-17T21:32:02.197

我在同一条线上尝试一些东西。由于我没有在一个地方找到完整的答案，这应该会有所帮助。

**问题**：如何在**编辑时避免回发 | 删除**视图中的行，尤其是那些由模型上的**foreach**循环生成的行。

以下是几个关键点：

*   确保这个视图是一个部分视图，它是其他视图的一部分（对于初学者，它类似于在“_Layout”视图中调用“_LoginPartial”的方式）并且最好放置在具有唯一 ID 的分区中

> ```
> <div id="PartialView">
>     @Html.Partial("PartialView", Model) 
> </div> 
> ```

*   例如，不要使用 @Html.ActionLink() 使用任何 HTML 标记：

从：

> ```
> @Html.ActionLink("DisplayText", "Method", "Controller", new { Var1=
> @model.element1, var2=@Model.Element}) 
> ```

到 ：

> ```
> <input type="button" class="UniqueClassName" value="Delete"
> Var1="@item" var2="@Model.Element"> 
> ```

//控制器方法调用会在AJAX函数调用中处理

*   如果@item 或@Model.Element 是多字变量，如“AB(2)”、“A_D_2-3.csv”等，请确保它们位于上面标签中的双引号之间
*   在主视图中编写 Jquery 函数调用（包含 Ajax 调用）（在“_Layout”视图中使用前面的类比）

*   下面是AJAX函数

    > ```
    > $(document).ready(function () {
    > // $(document) in teh below line is the KEY. 
    > //It tells any button click that has classname equals UniqueClassName
    >             $(document).on('click', '.UniqueClassName', function () {
    >                 var formData = new FormData();
    >                 var FuncParam1 = $(this).attr('Var1');
    >                 var FuncParam2 = $(this).attr('Var2');
    >                 formData.append("MethodParamName1", FuncParam1 );
    >                 formData.append("MethodParamName2", FuncParam2 );
    >                 $.ajax({
    >                      data: formData,
    >                     type: "POST",
    >                     url: '/Controller/Method',
    >                     contentType: false,
    >                     processData: false,
    >                     success: function (response) {
    >                         $('#PartialView').html(response); 
    >  // Make sure the name after # is same as id of <div> where partila view is placed
    >                     },
    >                     error: function (error) {
    >                         alert("errror");
    >                     }
    >                 });
    >             });
    >         }); 
    > ```

    *   控制器

> ```
> public ActionResult Method(string MethodParamName1, string MethodParamName2)
>   {
>      \\ Write your logic
>      \\ Construct your object to return to partial view
>      return View(Model);
>   } 
> ```

*   局部视图

> ```
> <table class="table">
>     @foreach (var item in Model)
>     {
>         <tr>
>             <td>
>                 @Html.DisplayFor(modelItem => item)
>             </td>
>             <td>
>                 <input type="button" class="buttonDelete" value="Delete File" Fname="@item" ProjectName="@Model.ProjectName">
>             </td>
>                  .....
>             </td>
>         </tr>
>     }
> </table> 
> ```

*   使用 AJAX 调用渲染视图

> ```
> <html>
> <head>
>     <title>Upload Example</title>
>     <script src="~/Scripts/jquery-1.10.2.intellisense.js"></script>
>     <script src="~/Scripts/jquery-1.10.2.js"></script>
>     <script src="~/Scripts/jquery-1.10.2.min.js"></script>
>     <script>
>        $(document).ready(function () {
> // $(document) in teh below line is the KEY. It tells any button click that has classname equals UniqueClassName
>             $(document).on('click', '.UniqueClassName', function () {
>                 var formData = new FormData();
>                 var FuncParam1 = $(this).attr('Var1');
>                 var FuncParam2 = $(this).attr('Var2');
>                 formData.append("MethodParamName1", FuncParam1 );
>                 formData.append("MethodParamName2", FuncParam2 );
>                 $.ajax({
>                      data: formData,
>                     type: "POST",
>                     url: '/Controller/Method',
>                     contentType: false,
>                     processData: false,
>                     success: function (response) {
>                         $('#PartialView').html(response); 
>                    // Make sure the name after # is same as id
>                    // of <div> where partila view is placed
>                     },
>                     error: function (error) {
>                         alert("errror");
>                     }
>                 });
>             });
>         });
> 
>     </script>
> 
> </head>
> <body>
>     <div id="PartialView">
>         @Html.Partial("PartialView", Model)
>     </div>
> ......
> ......
>  EXTRA FEILDS IF ANY
> ......
> ......
> 
> </body>
> </html> 
> ```

# php - 调试器扩展问题 - MAMP 和 PHPStorm

> ID：10874045
> 
> 赞同：2
> 
> 时间：2012-06-03T21:22:09.320
> 
> 标签：php, mamp, xdebug, phpstorm

每当我尝试调试 php 时，我都会不断收到以下两个错误...</p>

1.  “未建立与 Zend Debugger 的连接”，带有指向“验证安装”的链接
2.  “未安装 Zend Debugber 扩展。” 带有指向“显示 phpinfo”的链接。</li>

在过去 2 天的挖掘之后，我觉得我已经非常接近解决这个问题，但我似乎无法克服这最后一个障碍。我现在被困在 xdebug.org 站点上，它要求我运行 phpinfo 并将内容粘贴到浏览器中，这样它就可以帮助我解决 xdebug 问题。我这样做了，它给了我以下信息……</p>

* * *

1.  Xdebug 安装：2.1.0
2.  服务器 API：Apache 2.0 处理程序
3.  窗户：没有
4.  Zend 服务器：没有
5.  PHP版本：5.3.6
6.  Zend API 编号：220090626
7.  PHP API 编号：20090626
8.  调试构建：否
9.  线程安全构建：否
10.  配置文件路径：/Applications/MAMP/bin/php/php5.3.6/conf
11.  配置文件：/Library/Application Support/appsolute/MAMP PRO/conf/php.ini
12.  扩展目录：/Applications/MAMP/bin/php/php5.3.6/lib/php/extensions/no-debug-non-zts-20090626

* * *

它还通过 9 个非常简单的步骤给了我一些说明。从第 4 步开始，我做了更多的故障排除，告诉我运行“phpize”，我确实这样做了。它说，“<em>可能在路径上发现了错误的 'phpize' 二进制文件，您可以按如下方式运行 configure”</p>

1.  “/full/path/to/php/bin/phpize”
2.  “./configure --with-php-config=/full/path/to/php/bin/php-config”

'phpize' 的结果给了我“/usr/include/php/...”的目录，在我的情况下它应该是...“./configure --with-php-config=/Applications/MAMP /bin/php/php5.3.6/bin/php-config”。但是，当我运行 './configure...' 时，我收到以下错误...<br>“configure: error: cannot find install-sh, install.sh, or shtool in config "."/config”</p >

我的 Mac 上没有“install.sh”，但有一个“shtool”和一个 install-sh。install-sh 位于“python”目录中，所以我假设它不是我需要的“install-sh”？所以我尝试从与 shtool 相同的目录中运行“配置”命令，但它仍然给我“找不到...”错误。

我尝试查找该错误，但一直遇到障碍，主要是在不同的环境中。

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T13:38:55.673

两天前我遇到了同样的问题，虽然最后我得到了一个稍微不同的错误。问题是双重的：使用了错误的 PHP，以及缺少 phpize 需要的头文件。

这是修复：

*   更改 ~/.profile 中的 PATH 变量以首先使用 MAMP PHP 目录，如下所示：[如何覆盖 PHP 的路径以使用 MAMP 路径？](https://stackoverflow.com/questions/4145667/how-to-override-the-path-of-php-to-use-the-mamp-path). 然后您应该会发现“which php”会显示 MAMP 版本（您需要关闭并重新打开终端）。
*   您需要获取 MAMP PHP 标头并安装它们，按照此处接受的答案：[xdebug not loading。apache重启后在phpinfo（）中找不到](https://stackoverflow.com/questions/3144485/xdebug-not-loading-not-found-in-phpinfo-after-apache-restart)
*   然后，您需要从 php headers 目录中运行 ./configure

Phpize 和其余的 xdebug 指令应该可以工作。

您还需要告诉 PHPStorm 您正在使用此解释器而不是系统解释器，您可以通过设置的 PHP 部分来执行此操作。

# c# - 在 C# 应用程序中操作 QL 500 P-Touch 标签打印机

> ID：10874047
> 
> 赞同：0
> 
> 时间：2012-06-03T21:22:12.477
> 
> 标签：c#, .net, printing, label

我正在使用 C# 在 Windows 窗体中制作 POS 系统。项目完成，除了一件事。我必须在 QL 500 P-Touch 标签打印机上打印每笔销售。但我真的不知道如何从应用程序中操作它。我对这种标签打印很陌生。我用谷歌搜索但没有找到令人满意的教程或文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T21:28:29.720

下载[b-PAC SDK](http://www.brother.com/product/dev/label/bpac/index.htm)。

包括示例 C# 项目；这实际上很容易。

```
bpac.DocumentClass doc = new DocumentClass();
if (doc.Open("templateFile.lbx"))
{
    doc.GetObject("field1").Text = "...";
    doc.GetObject("field2").Text = "...";

    doc.StartPrint("", PrintOptionConstants.bpoDefault);
    doc.PrintOut(1, PrintOptionConstants.bpoDefault);
    doc.EndPrint();
    doc.Close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-04T19:15:20.980

我不得不手动编辑 project.csproj 文件以进行正确的引用。

```
<ItemGroup>
    <COMReference Include="bpac">
      <Guid>{90359D74-B7D9-467F-B938-3883F4CAB582}</Guid>
      <VersionMajor>1</VersionMajor>
      <VersionMinor>0</VersionMinor>
      <Lcid>0</Lcid>
      <WrapperTool>tlbimp</WrapperTool>
      <Isolated>False</Isolated>
    </COMReference>
  </ItemGroup> 
```

# algorithm - 从毫秒到小时、分钟、秒和毫秒

> ID：10874048
> 
> 赞同：48
> 
> 时间：2012-06-03T21:22:32.400
> 
> 标签：algorithm, date, pseudocode

我需要从毫秒到代表相同时间量的（小时，分钟，秒，毫秒）的元组。例如：

10799999ms = 2h 59m 59s 999ms

以下伪代码是我唯一能想到的：

```
# The division operator below returns the result as a rounded down integer
function to_tuple(x):
    h = x / (60*60*1000)
    x = x - h*(60*60*1000)
    m = x / (60*1000)
    x = x - m*(60*1000)
    s = x / 1000
    x = x - s*1000
    return (h,m,s,x) 
```

我确信它必须可以做得更聪明/更优雅/更快/更紧凑。

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-06-03T21:38:44.833

以下是我在 Java 中的做法：

```
int seconds = (int) (milliseconds / 1000) % 60 ;
int minutes = (int) ((milliseconds / (1000*60)) % 60);
int hours   = (int) ((milliseconds / (1000*60*60)) % 24); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-03T21:39:50.897

好问题。是的，可以更有效地做到这一点。您的 CPU 可以在一次操作中提取两个整数之比的商和余数。在`<stdlib.h>`中，调用公开此 CPU 操作的函数`div()`。在你的伪代码中，你会像这样使用它：

```
function to_tuple(x):
    qr = div(x, 1000)
    ms = qr.rem
    qr = div(qr.quot, 60)
    s  = qr.rem
    qr = div(qr.quot, 60)
    m  = qr.rem
    h  = qr.quot 
```

一个效率较低的答案将分别使用`/`and`%`运算符。但是，无论如何，如果您需要商和余数，那么您不妨调用更高效的`div()`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-07-23T14:59:24.943

也许可以更短更优雅。但我做到了。

```
public String getHumanTimeFormatFromMilliseconds(String millisecondS){
    String message = "";
    long milliseconds = Long.valueOf(millisecondS);
    if (milliseconds >= 1000){
        int seconds = (int) (milliseconds / 1000) % 60;
        int minutes = (int) ((milliseconds / (1000 * 60)) % 60);
        int hours = (int) ((milliseconds / (1000 * 60 * 60)) % 24);
        int days = (int) (milliseconds / (1000 * 60 * 60 * 24));
        if((days == 0) && (hours != 0)){
            message = String.format("%d hours %d minutes %d seconds ago", hours, minutes, seconds);
        }else if((hours == 0) && (minutes != 0)){
            message = String.format("%d minutes %d seconds ago", minutes, seconds);
        }else if((days == 0) && (hours == 0) && (minutes == 0)){
            message = String.format("%d seconds ago", seconds);
        }else{
            message = String.format("%d days %d hours %d minutes %d seconds ago", days, hours, minutes, seconds);
        }
    } else{
        message = "Less than a second ago.";
    }
    return message;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-03T21:43:10.723

不是很优雅，但会更短一些

```
function to_tuple(x):
   y = 60*60*1000
   h = x/y
   m = (x-(h*y))/(y/60)
   s = (x-(h*y)-(m*(y/60)))/1000
   mi = x-(h*y)-(m*(y/60))-(s*1000)

   return (h,m,s,mi) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-04T14:26:42.453

```
milliseconds = 12884983  // or x milliseconds
hr = 0
min = 0
sec = 0 
day = 0
while (milliseconds >= 1000) {
  milliseconds = (milliseconds - 1000)
  sec = sec + 1
  if (sec >= 60) min = min + 1
  if (sec == 60) sec = 0
  if (min >= 60) hr = hr + 1
  if (min == 60) min = 0
  if (hr >= 24) {
    hr = (hr - 24)
    day = day + 1
  }
} 
```

我希望我的简短方法对您有所帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-02T12:17:28.483

Kotlin 示例，其前导零的小时/分钟/秒小于 10。因此，如果您想在 UI 中将该值用作字符串，那么您最终会得到相同的持续时间。

这给出了 01:57:01 而不是 1:57:1，这可能会使 hh:mn:ss 注释感到困惑。

```
val timeInMilliSec = 45600030

val hours = timeInMilliSec.div(3600).rem(24)
val minutes = timeInMilliSec.div(60).rem(60)
val seconds = timeInMilliSec.rem(60)

val hoursFormatted = if (hours < 10) "0$hours" else "$hours"
val minutesFormatted = if (minutes < 10) "0$minutes" else "$minutes"
val secondsFormatted = if (seconds < 10) "0$seconds" else "$seconds"

"$hoursFormatted:$minutesFormatted:$secondsFormatted" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-04T14:11:43.200

```
milliseconds = x
total = 0
while (milliseconds >= 1000) {
  milliseconds = (milliseconds - 1000)
  total = total + 1
}
hr = 0
min = 0
while (total >= 60) {
  total = total - 60
  min = min + 1
  if (min >= 60) hr = hr + 1
  if (min == 60) min = 0
}
sec = total 
```

这是常规的，但我认为这对你来说不是问题。方法工作完美。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-05T19:47:20.073

基于 Valentinos 答案的 Arduino (c++) 版本

```
unsigned long timeNow = 0;
unsigned long mSecInHour = 3600000;
unsigned long TimeNow =0;
int millisecs =0;  
int seconds = 0;
byte minutes = 0;
byte hours = 0;

void setup() {
Serial.begin(9600);
Serial.println (""); // because arduino monitor gets confused with line 1
Serial.println ("hours:minutes:seconds.milliseconds:");
}

void loop() {
TimeNow = millis(); 
hours = TimeNow/mSecInHour;
minutes = (TimeNow-(hours*mSecInHour))/(mSecInHour/60);
seconds = (TimeNow-(hours*mSecInHour)-(minutes*(mSecInHour/60)))/1000;
millisecs = TimeNow-(hours*mSecInHour)-(minutes*(mSecInHour/60))-       (seconds*1000);

Serial.print(hours);  
Serial.print(":");
Serial.print(minutes);
Serial.print(":"); 
Serial.print(seconds); 
Serial.print("."); 
Serial.println(millisecs); 
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-13T21:38:38.983

只是另一个java示例：

```
long dayLength = 1000 * 60 * 60 * 24;
long dayMs = System.currentTimeMillis() % dayLength;
double percentOfDay = (double) dayMs / dayLength;
int hour = (int) (percentOfDay * 24);
int minute = (int) (percentOfDay * 24 * 60) % 60;
int second = (int) (percentOfDay * 24 * 60 * 60) % 60; 
```

一个优点是你可以模拟更短的日子，如果你调整`dayLength`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-09-28T14:15:40.697

```
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.concurrent.TimeUnit;

public class MyTest {

    public static void main(String[] args) {
        long seconds = 360000;

        long days = TimeUnit.SECONDS.toDays(seconds);
        long hours = TimeUnit.SECONDS.toHours(seconds - TimeUnit.DAYS.toSeconds(days));

        System.out.println("days: " + days);
        System.out.println("hours: " + hours);
    }
} 
```

# objective-c - 使用 AVAsset 播放 .ts 文件？-> 不支持媒体格式

> ID：10874049
> 
> 赞同：1
> 
> 时间：2012-06-03T21:22:48.757
> 
> 标签：objective-c, ios, avfoundation, mpeg2-ts

我正在完成我的最后一个大学项目，并为 iOS 5 开发一个应用程序，以演示 HTTP 实时流协议的工作原理。

应用程序获取要播放的不同 HLS 源的列表。它们可以是使用内部 iOS 机制的播放器：将 m3u8 直接传递给 MPMoviePlayerViewController，或者使用我自己正在开发的逐步执行协议的播放器。

这个想法是演示它是如何工作的，下载 .ts 文件并根据此时的下载速度选择正确的流。

第一个选项，简单的选项，效果很好。MPMoviePlayerViewController 完成了这项工作。但是，当我使用自己的播放器时，我下载了 .ts 文件，但是当我尝试在 AVAsset 中使用它时，它说我不支持媒体格式？怎么会发生？如果系统能够使用 .m3u8 文件，则意味着系统能够播放 .ts 文件。

你能帮帮我吗？或给出解决方案？

谢谢。

还有一个类似的问题：[可以强制 AVFoundation 播放本地的 .ts 文件吗？](https://stackoverflow.com/questions/5642248/can-avfoundation-be-coerced-into-playing-a-local-ts-file) 但还没有答案。

PD：请原谅我糟糕的英语。我希望你能理解我。我来自西班牙，我必须提高我的英语水平。

# php - 使用 while 循环回显 mysql_fetch_row 超过 1 行？

> ID：10874051
> 
> 赞同：0
> 
> 时间：2012-06-03T21:23:29.413
> 
> 标签：php, javascript, mysql, ajax

```
while($dustData = mysql_fetch_row($dustLog))
{
    for($i = 0; $i < count($dustData); $i++)
    {
        $dustRow = ";".$dustData[$i];
        echo $dustRow;
    }
} 
```

我正在使用它来将每一行返回到`.responseText`我的主文件中。我正在尝试将表从数据库传输到`<table>`.

我在我的 javascript 控制台中说

```
["<br />
<font size='1'><table class='xdebug-error' dir='ltr' border='1' cellspacing='0' cellpadding='1'>
<tr><th align='left' bgcolor='#f57900' colspan="5"><span style='background-color: #cc0000", " color: #fce94f", " font-size: x-large", "'>( ! )</span> Warning: mysql_fetch_row() expects parameter 1 to be resource, boolean given in C:\wamp\www\Final\loglog.php on line <i>6</i></th></tr>
<tr><th align='left' bgcolor='#e9b96e' colspan='5'>Call Stack</th></tr>
<tr><th align='center' bgcolor='#eeeeec'>#</th><th align='left' bgcolor='#eeeeec'>Time</th><th align='left' bgcolor='#eeeeec'>Memory</th><th align='left' bgcolor='#eeeeec'>Function</th><th align='left' bgcolor='#eeeeec'>Location</th></tr>
<tr><td bgcolor='#eeeeec' align='center'>1</td><td bgcolor='#eeeeec' align='center'>0.0005</td><td bgcolor='#eeeeec' align='right'>673672</td><td bgcolor='#eeeeec'>{main}(  )</td><td title='C:\wamp\www\Final\loglog.php' bgcolor='#eeeeec'>..\loglog.php<b>:</b>0</td></tr>
<tr><td bgcolor='#eeeeec' align='center'>2</td><td bgcolor='#eeeeec' align='center'>0.0117</td><td bgcolor='#eeeeec' align='right'>680760</td><td bgcolor='#eeeeec'><a href='http://www.php.net/mysql_fetch_row' target='_new'>mysql_fetch_row</a>
(  )</td><td title='C:\wamp\www\Final\loglog.php' bgcolor='#eeeeec'>..\loglog.php<b>:</b>6</td></tr>
</table></font>
"] 
```

我不知道那条消息是什么意思。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T21:35:35.350

隐藏在大量文本中的是以下内容：

```
Warning: mysql_fetch_row() expects parameter 1 to be resource, boolean given 
```

这意味着您的查询失败（返回 false）。否则，这应该工作。

# ruby-on-rails - Activerecord：无法通过 => 工作

> ID：10874054
> 
> 赞同：0
> 
> 时间：2012-06-03T21:23:37.500
> 
> 标签：ruby-on-rails, ruby, activerecord

我正在从事一个人们组织游戏会议的项目。（删节）模型如下。

```
class User < ActiveRecord::Base
  has_many :events, dependent: :destroy      #events organized by user
  has_many :reservations, dependent: :destroy
end

class Event < ActiveRecord::Base
  belongs_to :user
  has_many :reservations, dependent: :destroy
end

class Reservation < ActiveRecord::Base
  belongs_to :events
  belongs_to :users
end 
```

这样，当我使用时`@user.events`，正如预期的那样，我得到了用户组织的事件列表。

但我想要一个用户预订的事件列表，（使用类似的东西`@user.reserved_events`，所以我将它添加到用户模型中：

```
has_many :reserved_events, :class_name => 'Event',:through => reservations 
```

这打破了一切，我得到了一个神秘的

```
undefined local variable or method `reservations' for #<Class:0x00000003681048> 
```

***编辑***

感谢 Christopher Manning，我改成`reservations`了`:reservations`，从而消除了小错误。但是，如果我现在尝试使用`@user.reserved_events`o `@user.reservations.count`，我会得到

```
Could not find the source association(s) :reserved_event or :reserved_events in model Reservation. Try 'has_many :reserved_events, :through => :reservations, :source => <name>'. Is it one of :events or :users? 
```

遵守请求让我无处可去：如果我使用`:source => :users`，我得到

```
SQLite3::SQLException: no such column: reservations.users_id: SELECT COUNT(*) FROM "events" INNER JOIN "reservations" ON "events"."id" = "reservations"."users_id" WHERE "reservations"."user_id" = 1 
```

using`:source => :events`使它在另一个缺失的列上犹豫不决

我的临时解决方案是使用直接 SQL：

`@reserved_events = Event.find_by_sql("select events.* from events,reservations where events.id=reservations.event_id AND reservations.user_id="+@user.id.to_s)`

更好的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T01:27:12.313

尝试这个：

```
class User < ActiveRecord::Base
  has_many :events, dependent: :destroy
  has_many :reservations, :through => :events
end

class Event < ActiveRecord::Base
  belongs_to :user
  has_many :reservations, dependent: :destroy
end

class Reservation < ActiveRecord::Base
  belongs_to :events
end 
```

这应该允许你说：

```
@user.reservations 
```

事件应该有一个 user_id 字段。预订应该有一个 event_id 字段。让我知道您对此有什么问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T22:16:29.933

换成`reservations`行`:reservations`内

```
has_many :reserved_events, :class_name => 'Event',:through => reservations 
```

修复未定义的局部变量或方法错误。

# c - 如何定位特定的 Mac OS X 版本？

> ID：10874059
> 
> 赞同：6
> 
> 时间：2012-06-03T21:24:18.350
> 
> 标签：c, macos, version

如果我想针对所有 iOS 设备版本 4.3 或更高版本，我可以使用：

```
#if __IPHONE_OS_VERSION_MIN_REQUIRED >= __IPHONE_4_3 
```

此外，如果我想以一般 iOS 设备为目标，我可以使用：

```
#if TARGET_OS_IPHONE 
```

Mac OS X 有类似的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T21:27:46.227

`NSAppKitVersionNumber`是您在 OS X 上的朋友。以例如为目标。10.5 及更高版本，您可以这样做：

```
#if NSAppKitVersionNumber >= NSAppKitVersionNumber10_5

// ...

#endif 
```

**编辑：**刚刚看到在 OS X 上也有`__MAC_OS_X_VERSION_MAX_ALLOWED`和`__MAC_OS_X_VERSION_MIN_REQUIRED`，它可能工作得更好，并且在`Availability.h`不依赖 Cocoa 的情况下可用。

# symfony - 多个表的相同主键

> ID：10874063
> 
> 赞同：0
> 
> 时间：2012-06-03T21:25:04.507
> 
> 标签：symfony, doctrine-orm

我正在尝试在 Symfony2 中创建一个基于另一个表的主键的实体，但是在尝试运行数据固定装置时出现以下错误。

> [学说\ORM\ORM异常]
> 
> Ofdan\SearchBundle\Entity\CacheHeader 类型的实体缺少分配的 ID。此实体的标识符生成策略要求在调用 EntityManager#persist() 之前填充 ID 字段。如果您想要自动生成标识符，则需要相应地调整元数据映射。

```
/**
 * @ORM\Entity
 * @ORM\Table(name="cacheHeader")
 * @ORM\HasLifecycleCallbacks
 */
class CacheHeader
{
    /**
     * @ORM\ManyToOne(targetEntity="Domain", inversedBy="domains")
     * @ORM\JoinColumn(name="domainId", referencedColumnName="id")
     * @ORM\Id
     */
    private $domain;

...

} 
```

我正在使用的数据夹具在域中加载，它应该设置 domainId，这应该意味着有一个 Id。

```
class CacheHeaderFixtures extends AbstractFixture implements OrderedFixtureInterface
{
    public function load(ObjectManager $manager)
    {
        $cacheHeader1 = new CacheHeader();
        $cacheHeader1->setDomain($manager->merge($this->getReference('bbc-domain')));
        $cacheHeader1->setDate(new \DateTime());
        $cacheHeader1->setPage(10); // CacheHeader::Page_Index
        $cacheHeader1->setHeader('');
        $manager->persist($cacheHeader1);
    }
} 
```

如何让我的 CacheHeader 实体与 domainId 一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T21:43:52.267

答案是上面的作品。

我遇到问题的原因是我有第二个夹具，但在错误的对象上调用了 setDomain。

# iphone - 应用关闭时的位置监控

> ID：10874065
> 
> 赞同：0
> 
> 时间：2012-06-03T21:25:25.717
> 
> 标签：iphone, objective-c, ios, ios5, location

> **可能重复：**
> [替代 startMonitoringSignificantLocationChanges？](https://stackoverflow.com/questions/4881975/alternative-to-startmonitoringsignificantlocationchanges)

我正在开发一个应用程序，只要用户的位置改变了 3 公里，我就需要调用 Web 服务。它需要在应用程序关闭时工作（不是在后台，而是关闭）。

我已经尝试过这种`startMonitoringSignificantLocationChanges`方法，但它太不准确了，因为它会在用户从一个网络单元移动到另一个网络单元时触发（正如我在搜索时所理解的那样）。

据我所知，只有`startMonitoringForRegion`和`startMonitoringSignificantLocationChanges`方法会在位置更改（或进入/退出区域）时将应用程序重新启动到后台以执行一些代码。

关于如何克服这个问题的任何解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T09:07:29.303

好的，我通过执行以下操作解决了这个问题。

*   当应用程序第一次启动时，创建一个具有所需直径的新区域（在我的例子中是 3 公里）。
*   当用户退出该区域时，创建另一个区域，其中心点为当前位置，直径为 3 KM（同样，在我的情况下）。

等等...

这些地区可能会有一些重叠，但它仍然可以发挥作用。

如果有人有更好的解决方案，请分享。:)

# c# - 任务线程中抛出的异常，未被 UnobservedTaskException 捕获

> ID：10874068
> 
> 赞同：3
> 
> 时间：2012-06-03T21:27:03.217
> 
> 标签：c#, multithreading, exception-handling, task-parallel-library

我无法理解 TPL 中如何处理异常。以下代码应该说明我的问题。

```
using System;
using System.Collections.Generic;
using System.Net;
using System.Threading;
using System.Threading.Tasks;

namespace WebDLApp
{
    class Program
    {
        static void Main(string[] args)
        {
            TaskScheduler.UnobservedTaskException += TaskScheduler_UnobservedTaskException; // Not catching exception

            List<string> sites = new List<string>{ "http://microsoft.com", "http://yahoo.com", "http://facebook.com", "http://amazon.com", "http://foooo", "http://aol.com", "http://ask.com", "http://wikipedia.org" };
            List<Task<string>> tasks = new List<Task<string>>();

            foreach (string site in sites)
            {
                tasks.Add(Task.Factory.StartNew<string>((wsite) =>
                    {
                        using (WebClient wc = new WebClient())
                        {
                            wc.DownloadString((string)wsite); // Thrown here, always
                            return (string)wsite;
                        }
                    }, site)
                );
            }

            Task.WaitAll(tasks.ToArray()); // Can't catch here

            int counter = 1;
            foreach (var task in tasks)
            {

                Console.WriteLine(counter.ToString() + task.Result); // Can't catch here either
                counter++;
            }

            Console.ReadLine();
        }

        static void TaskScheduler_UnobservedTaskException(object sender, UnobservedTaskExceptionEventArgs e) // Never called
        {
            Console.WriteLine(e.Exception.Message);
            e.SetObserved();
        }
    }
} 
```

据我了解，使用 TaskScheduler.UnobservedTaskException 事件对象是帮助处理来自棘手的第三方库的异常的好方法。但是，异常似乎总是在任务中抛出。它看起来好像永远不会被TaskScheduler（或任何处理TaskExceptions的设施）捕获。

为了代码简洁，我省略了可能的 try/catch 位置并用注释标记了它们。

我期待 TaskScheduler_UnobservedTaskException 事件处理程序打印到控制台并观察异常。但是，一旦执行到达任务的 Result，就会从 Task 中抛出 WebException。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:13:15.113

[这里（How to handle exceptions with TaskScheduler.UnobservedTaskException?）](http://social.msdn.microsoft.com/Forums/lv/parallelextensions/thread/bcb2b3fa-9fcd-4a90-9f9c-9ef24332451e)是解释。只需更换

```
Task.WaitAll(tasks.ToArray()); // Can't catch here 
```

和

```
Task.Factory.StartNew(() =>
{
    while (true)
    {
        Thread.Sleep(1000);
        GC.Collect();
    }
});
return; 
```

看到消息`TaskScheduler_UnobservedTaskException`

# php - wp e-commerce - 如何判断用户是否购买了产品？

> ID：10874071
> 
> 赞同：1
> 
> 时间：2012-06-03T21:27:37.530
> 
> 标签：php, wordpress

到目前为止，我一直在使用以下代码，它一直运行良好，直到我为特定产品添加变体：

```
<?php if ( is_user_logged_in() ) if ( wpsc_has_purchases() )    if ( wpsc_bought_product(wpsc_the_product_id()) ) $bought_product = true; else $bought_product = false; ?> 
```

稍后在代码中我会使用购买的产品变量来查看产品是否已被购买，这样我就可以打印一条特殊消息。

**我的问题：**由于为许多产品添加了变体，此代码不再适用，它仅适用于没有变体的产品......我做错了什么？（顺便说一句，如果您正在考虑使用 wp 电子商务，请不要 - 这是垃圾）

这是 wpsc_bought_product 的代码：

```
function wpsc_bought_product($prodid) {
    global $wpdb, $user_ID, $wpsc_purchlog_statuses, $gateway_checkout_form_fields, $purchase_log, $col_count;

    do_action( 'wpsc_pre_purchase_logs' );

    foreach ( (array)$purchase_log as $purchase ) {

        // 2 = order received, 3 = accepted payment
        if ($purchase['processed'] == 2) {

            $cartsql = $wpdb->prepare( "SELECT * FROM `" . WPSC_TABLE_CART_CONTENTS . "` WHERE `purchaseid`= %d", $purchase['id'] );
            $cart_log = $wpdb->get_results( $cartsql, ARRAY_A );
            if ( $cart_log != null ) {
                foreach ( (array)$cart_log as $cart_row ) {

                    //if product is in the order
                    if ($prodid == $cart_row['prodid'])
                        return true;

                }
            }

        }
    }

    return false;
} 
```

**通过查看数据库，我发现产品的每个变体都有一个不同的 ID，所以这就是它没有注册为已购买的原因。那么我如何判断是否购买了任何变体？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:43:40.707

如果有人偶然发现这个问题，我已经找到了答案。

```
function wpsc_bought_product($prodid) {
    global $wpdb, $user_ID, $wpsc_purchlog_statuses, $gateway_checkout_form_fields, $purchase_log, $col_count;

    $prod_children_sql = $wpdb->prepare( "SELECT `id` FROM `wp_posts` WHERE `post_parent`= %d", $prodid );
    $prod_children_result = $wpdb->get_results( $prod_children_sql, ARRAY_A );

    $i=0;
    foreach($prod_children_result as $inner) {
        $prod_children[$i] = current($inner);
        $i++;        
    }

    do_action( 'wpsc_pre_purchase_logs' );

    foreach ( (array)$purchase_log as $purchase ) {

        // 2 = order received, 3 = accepted payment - probably 3 should be here
        if ($purchase['processed'] == 2) {

            $cartsql = $wpdb->prepare( "SELECT * FROM `" . WPSC_TABLE_CART_CONTENTS . "` WHERE `purchaseid`= %d", $purchase['id'] );
            $cart_log = $wpdb->get_results( $cartsql, ARRAY_A );
            if ( $cart_log != null ) {
                foreach ( (array)$cart_log as $cart_row ) {

                    //if product is in the order
                    if ($prod_children != null) {
                        if (in_array($cart_row['prodid'],$prod_children)) {
                            return true;
                        }
                    } else if ($prodid == $cart_row['prodid']) {                    
                        return true;
                    }

                }
            }

        }
    }

    return false;
} 
```

# android - 使用 R.drawable.myimagename 添加图像时出错

> ID：10874077
> 
> 赞同：0
> 
> 时间：2012-06-03T21:28:46.927
> 
> 标签：android, live-wallpaper

这是错误，“myimagename”无法解析或不是字段。

ps：

myimagename.jpg 存在于可绘制文件夹中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T22:23:28.073

只需清理您的项目。

在 Eclipse 中，单击顶部菜单中的 Project，单击 Clean...，选择您的项目并单击“OK”。

# ruby-on-rails - ActiveRecord 可以设置为自动限制二级关联吗？

> ID：10874079
> 
> 赞同：0
> 
> 时间：2012-06-03T21:28:57.507
> 
> 标签：ruby-on-rails, activerecord, associations

假设我有一个`User`模型`has_many :posts`，而`Post` `has_many :comments`.

如果我这样做，`@user.posts.map {|post| post.comments}.flatten`我将获得用户帖子的*所有*评论。是否有地方可以配置`Post`or`Comment`模型以检测它在特定用户的上下文中被引用并只返回特定用户的评论？

也就是说，`@user.posts.map {|post| post.comments}.flatten`并且`@posts.map {|post| post.comments}.flatten`（假设相同的帖子）不会返回相同数量的评论（假设多个用户正在评论）。

从[之前的 SO question's answers](https://stackoverflow.com/questions/778241/complex-associations-in-activerecord-models)中，听起来我想要某种[嵌套的 has_many through](https://github.com/ianwhite/nested_has_many_through)。那是对的吗？Rails 3 中是否有任何简单的方法来检测“源”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:42:01.113

更新的答案：

这是一种获取帖子作者评论的方法

```
class Post < ActiveRecord::Base
  belongs_to :user   # So, there's a user_id attribute
  has_many :comments

  def authors_comments
    comments.where("user_id = ?", user_id)
  end
end 
```

那应该让你这样做：

```
@user.posts.each { |post| puts post, post.authors_comments } 
```

但是，它不如其他方法有效；*n*个帖子将导致*n 个*SQL 查询以获取评论。但这与下面评论中的描述非常接近。

* * *

*原始答案（为后代）*

它不是最漂亮的，但你可以做类似的事情

```
class User < ActiveRecord::Base
  has_many :posts    # All the user's posts
  has_many :comments # All the user's comments on all posts

  # All comments made on any of user's posts
  has_many :replies, :through => :posts, :source => :comments

  def replies_to_self
    replies.where("comments.user_id = ?", id)
  end
end 
```

调用`@user.replies_to_self`以获取用户对他/她自己的帖子的评论

你最终会得到这样的 SQL：

```
SELECT
    "comments".*
FROM
    "comments"
INNER JOIN
    "posts"
ON
    "comments"."post_id" = "posts"."id"
WHERE
    "posts"."user_id" = X AND "comments"."user_id" = X 
```

（`X`用户ID在哪里）

# java - HMAC SHA-256 和 Facebook 签名请求

> ID：10874081
> 
> 赞同：1
> 
> 时间：2012-06-03T21:29:08.917
> 
> 标签：java, facebook, sha256

因此，我正在努力使用 Java 验证 Facebook 的 signed_request。不幸的是，我一直在验证过程中遇到问题。我查看了[这个文档](http://developers.facebook.com/docs/authentication/signed_request/)，并模拟了他们的算法，但没有成功。我也跟着[这个教程](http://www.sergiy.ca/how-to-implement-facebook-oauth-2.0-app-authorization-process-in-java/)，并继续想出我计算的签名与 Facebook 发送的签名不同。

或者至少，这就是 String.equals() 告诉我的。

所以我决定再戳一下。

我将其设置为迭代计算签名和提供的签名中的字节。瞧，我签名的前 32 个字节与他们的完全匹配。它只是丢失了另外 400 多个字节的数据。

那时，我决定我应该更好地了解到底发生了什么。我查找了 SHA-256，发现它确实[只创建了 32 个字节的信息](http://en.wikipedia.org/wiki/SHA-2#Comparison_of_SHA_functions)。所以我留下了超过 400 字节的数据，Facebook 声称这些数据是使用 HMAC SHA-256 算法生成的。我想我应该将 SHA-256 的最大长度与我正在散列的数据的长度进行比较，但这只是表明有很多空间可供使用（消息大小：575 字节；最大大小：2.305843009213694 x 10^18 字节）。

Facebook 是在造谣吗？还是我错过了什么？

*编辑*

这是我用来散列数据的函数。我传入我的 facebook 密码（用于密钥）和 base64url 编码的 JSON 对象（用于数据）。它始终返回一个长度为 32 的字节数组，其中的数据与 facebook 提供的签名的前 32 个字节相匹配。

```
private byte[] hmacSHA256(String data, String key) throws Exception {
    SecretKeySpec secretKey = new SecretKeySpec(key.getBytes("UTF-8"), "HmacSHA256");
    Mac mac = Mac.getInstance("HmacSHA256");
    mac.init(secretKey);
    mac.update(data.getBytes("UTF-8"));
    byte[] hmacData = mac.doFinal();
    return hmacData;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T16:44:49.637

因为我也来这里寻找类似问题的答案。这是对我有用的代码：

```
import org.apache.commons.codec.binary.Base64;
import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

private JSONObject parseFBSignedRequest(String signedRequest, String secret) throws UnsupportedEncodingException, Exception {
    //split request into signature and data
    String[] signedRequests = signedRequest.split("\\.", 2);
    //parse signature
    String sig = signedRequests[0];

    //parse data and convert to json object
    String data = signedRequests[1];

    //I assumed it is UTF8
    JSONObject jsonData = new JSONObject(new String(Base64.decodeBase64(data), "UTF-8"));
    //check signature algorithm
    if(!jsonData.getString("algorithm").equals("HMAC-SHA256")) {
        //unknown algorithm is used
        return null;
    }

    //check if data is signed correctly
    if(!hmacSHA256(signedRequests[1], secret).equals(sig)) {
        //signature is not correct, possibly the data was tampered with
        return null;
    }
    return jsonData;
}

//HmacSHA256 implementation 
private String hmacSHA256(String data, String key) throws Exception {
    SecretKeySpec secretKey = new SecretKeySpec(key.getBytes("UTF-8"), "HmacSHA256");
    Mac mac = Mac.getInstance("HmacSHA256");
    mac.init(secretKey);
    byte[] hmacData = mac.doFinal(data.getBytes("UTF-8"));
    return new String(Base64.encodeBase64URLSafe(hmacData), "UTF-8");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T21:40:56.843

# postgresql - 连接到我的 RoR 的 Heroku Postgres 数据库？

> ID：10874083
> 
> 赞同：3
> 
> 时间：2012-06-03T21:29:22.647
> 
> 标签：postgresql, heroku, amazon-ec2, database-connection

我在 Heroku 上运行 Ruby on Rails 应用程序。它使用 Postgres 数据库。我想从我在本地编写和运行的一些脚本连接到数据库。

使用 ENV['DATABASE_URL'] 我发现我的连接网址是：

**postgres://zugzagcaht:h-HebaxOz1_H-5uq_Olv@ec2-25-25-209-55.compute-1.amazonaws.com/zugzagcaht**

（我修改了字符，所以这不是真正的字符串！）

现在我正在运行一个应该连接到数据库的 Python 脚本，但是在连接中发现超时：

```
import psycopg2

DB_NAME = 'zugzagcaht'
DB_USER = 'zugzagcaht'
DB_HOST = 'ec2-25-25-209-55.compute-1.amazonaws.com'
DB_PASSWORD = 'h-HebaxOz1_H-5uq_Olv'
TIMEOUT = 5 # seconds

conn = None
try:
  conn = psycopg2.connect("connect_timeout=%i dbname='%s' user='%s' host='%s' password='%s'" % (TIMEOUT, DB_NAME, DB_USER, DB_HOST, DB_PASSWORD))
except:
  print "I am unable to connect to the database"

if conn:
  cur = conn.cursor()
  cur.execute("SELECT datname from pg_database")
  rows = cur.fetchall()
  print "Here's the databases:\n"
  for row in rows:
      print "   ", row[0] 
```

知道为什么这不起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T07:51:37.240

您无法连接到 Heroku 共享数据库实例，但是他们最近推出了一个允许入口的新开发实例 - 在[https://postgres.heroku.com/blog/past/2012/4/26/heroku_postgres_development_plan/](https://postgres.heroku.com/blog/past/2012/4/26/heroku_postgres_development_plan/)阅读更多信息- 我怀疑这就是问题。

# android - 返回不区分大小写的sqlite DB

> ID：10874084
> 
> 赞同：3
> 
> 时间：2012-06-03T21:29:28.900
> 
> 标签：android, sqlite

我坐在这里想知道如何在不区分大小写的情况下对我的数据库进行排序。假设我有'A'，'a'，'B'，'b'。它将像这样打印：'A'，'B'，'a'，'b'。但我希望它以更人性化的方式排序。这是我的光标功能：

```
/**
* Return a Cursor over the list of all brands in the database
* 
* @return Cursor over all brands sorted alphabetically 
+ TODO: doesn't sort alphabetically because it's case sensitive
*/
public Cursor fetchAllBrands() {

return mDb.query(Constants.DATABASE_TABLE, 
    new String[] { 
        Constants.KEY_ROWID, Constants.KEY_BRAND, Constants.KEY_STOCK 
    }, 
    null, null, null, null, Constants.KEY_BRAND);
} 
```

我注意到 Java 有`CASE_INSENSITIVE_ORDER`，但如果这是解决这个问题的方法，我不知道如何实现它。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T21:42:37.823

它在[这里](https://stackoverflow.com/questions/5958039/sqlite-query-in-non-case-sensitive-alphabetical-order)得到了回答。不幸的是，您似乎必须使用该`rawQuery()`方法而不是使用`query()`包装器方法。此方法允许您输入将像这样执行的原始 SQL 代码...

```
db.rawQuery("SELECT " + Constants.KEY_ROWID + "," + Constants.KEY_BRAND + "," +
             Constants.KEY_STOCK +
           " FROM " + Constants.DATABASE_TABLE +
           " ORDER BY " + Constants.KEY_BRAND + " COLLATE NOCASE ASC;", null); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T21:41:40.180

尝试`rawQuery(...)`使用`COLLATE NOCASE`. 例子...

```
return mDb.rawQuery("SELECT " + Constants.KEY_ROWID + ","
              + Constants.KEY_BRAND + ","
              +  Constants.KEY_STOCK
              + " FROM " + Constants.DATABASE_TABLE
              + " ORDER BY " + Constants.KEY_BRAND + " COLLATE NOCASE", null); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-08T12:14:40.027

Try like this

```
public Cursor fetchAllBrands() {

return mDb.query(Constants.DATABASE_TABLE, 
new String[] { 
    Constants.KEY_ROWID, Constants.KEY_BRAND, Constants.KEY_STOCK 
}, 
null, null, null, null, Constants.KEY_BRAND + " COLLATE NOCASE ASC");
} 
```

# ios - 如何在iOS上将两个标签一个接一个地放在表格视图单元格中？

> ID：10874090
> 
> 赞同：0
> 
> 时间：2012-06-03T21:30:09.277
> 
> 标签：ios, uitableview, label, cell

我有两个标签，并试图在表格视图单元格上显示它们。但是第二个标签不是一个接一个地显示，而是显示在第一个标签上，而第一个标签永远不会显示...如何在第一个标签之后显示第二个标签？这是我的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tv cellForRowAtIndexPath:(NSIndexPath *)indexPath {

UITableViewCell *cell;
UILabel *label=nil , *secondLabel = nil;

cell = [tv dequeueReusableCellWithIdentifier:@"Cell"];
if (cell == nil)
{
    cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:@"Cell"] autorelease];
    //cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:@"Cell"] autorelease];

    label = [[UILabel alloc] initWithFrame:CGRectZero]; 
    [label setLineBreakMode:UILineBreakModeWordWrap];
    [label setMinimumFontSize:FONT_SIZE];
    [label setNumberOfLines:0];
    [label setFont:[UIFont boldSystemFontOfSize:FONT_SIZE]];
    [label setTag:1];

    //[[label layer] setBorderWidth:2.0f];

    [[cell contentView] addSubview:label];

    secondLabel = [[UILabel alloc] initWithFrame:CGRectZero];
    [secondLabel setLineBreakMode:UILineBreakModeWordWrap];
    [secondLabel setMinimumFontSize:FONT_SIZE];
    [secondLabel setNumberOfLines:0];
    [secondLabel setFont:[UIFont systemFontOfSize:FONT_SIZE]];
    [secondLabel setTag:2]; 

    [[cell contentView] addSubview:secondLabel];    
}

//NSString *text = [items objectAtIndex:[indexPath row]];
int storyIndex = [indexPath indexAtPosition: [indexPath length]-1];
NSString *text1 = [[stories objectAtIndex: storyIndex] objectForKey: @"title"];  
NSString *text2 = [[stories objectAtIndex: storyIndex] objectForKey: @"summary"];

CGSize constraint = CGSizeMake(CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), 20000.0f);

CGSize size1 = [text1 sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];
CGSize size2 = [text2 sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];    

if (!label)
    label = (UILabel*)[cell viewWithTag:1];
if (!secondLabel)
    secondLabel = (UILabel*)[cell viewWithTag:2];    

//[label setText:text1];
//[secondLabel setText:text2];

label.text = text1;
secondLabel.text = text2;

//cell.textLabel.text = text1;
//cell.detailTextLabel.text = text2;

[label setFrame:CGRectMake(CELL_CONTENT_MARGIN, CELL_CONTENT_MARGIN, CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), MAX(size1.height, 44.0f))];
[secondLabel setFrame:CGRectMake(CELL_CONTENT_MARGIN, CELL_CONTENT_MARGIN, CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), MAX(size2.height, 44.0f))]; 

return cell;  } 
```

和：

```
-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {

int storyIndex = [indexPath indexAtPosition: [indexPath length] - 1];
NSString *text1 = [[stories objectAtIndex: storyIndex] objectForKey: @"title"];
NSString *text2 = [[stories objectAtIndex: storyIndex] objectForKey: @"summary"];    

CGSize constraint = CGSizeMake(CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), 20000.0f);

CGSize size1 = [text1 sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];
CGSize size2 = [text2 sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];    
CGFloat height = MAX(size1.height + size2.height, 44.0f);

return height + (CELL_CONTENT_MARGIN * 2);} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T09:55:18.103

问题是您对两个标签使用相同的框架。使用不同的框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T21:43:36.063

您永远不会为两个 UILabel 设置框架。对于 label 和 secondLabel，您都在调用 initWithFrame:CGRectZero，因此在这两种情况下，它们的帧的 origin.x 和 origin.y 都是 0。

secondLabel 默认标记为不透明，这就是它完全遮盖第一个标签的原因。

为了解决这个问题，你应该在标签被添加到 UITableViewCell 后实际调用 setText:。一旦你有了标签的大小，你就可以将 secondLabel 的框架设置在它之下。

# ruby-on-rails - selected-rails 错误选择不是函数

> ID：10874093
> 
> 赞同：1
> 
> 时间：2012-06-03T21:30:18.620
> 
> 标签：ruby-on-rails, ruby-on-rails-3, asset-pipeline, jquery-chosen

我正在使用 selected-rails 将 selected.js 与 rails 资产管道集成

我已包含在我的 Gemfile 中

```
gem 'chosen-rails' 
```

然后

```
bundle install 
```

在我的 application.js 我有

```
//= require jquery
//= require jquery_ujs
//= require chosen-jquery
//= require_self 
```

在我的 application.css 我有

```
 *= require chosen 
```

页面根据需要加载js

```
/assets/jquery.js?body=1
/assets/jquery_ujs.js?body=1
/assets/lib/select-parser.js?body=1
/assets/chosen.jquery.js?body=1 
```

但是我尝试使用函数 selected() 它给出的错误选择不是函数

```
$('#whatever').chosen(); 
```

我已经在页脚中尝试了上述内容。在 Jquery 里面准备好了.. 在萤火虫控制台里面.. 似乎没有任何工作。可能是什么问题？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-22T08:12:41.313

我的问题是 jQuery 既包含在`application.js`(v1.11.1) 中，也包含在我通过 CDN (v2.1.4) 的布局中。

```
<script src="//cdn.jsdelivr.net/jquery/2.1.4/jquery.min.js"></script> 
```

我将 CDN 版本保留在我的标题开头，从中删除`//= require jquery`，`application.js`它工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T02:20:24.743

我遇到了同样的问题，它把我带到了这里。对我来说，我在我的应用程序中同时包含了 jquery 并选择了两次。双重包括任何一个都可能导致此错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T12:51:14.143

我意识到问题不在于 jQuery 或资产管道或 selected-rails gem，而是服务器配置问题，并且由于 nginx 配置错误而提供了错误的文件。

# jquery - 滚动条插件并不总是有效，是否有预加载或我可以做些什么？

> ID：10874096
> 
> 赞同：0
> 
> 时间：2012-06-03T21:30:28.003
> 
> 标签：jquery

所以这里是网站： http: [//graysonearle.com/newtest/#prettyPhoto/6/](http://graysonearle.com/newtest/#prettyPhoto/6/) 这会将您带到一个带有侧边栏的小窗口，其中包含一些图像。我正在使用 lionbar，这很棒，但它只有 50% 的时间有效。根据我的经验，这不是典型的网络问题。什么会导致脚本随机无法运行？有没有我可以放在那里确保脚本正确加载的标签？只需重新加载它，直到你看到它工作/不工作。它也与我调用插件的方式有关吗？

```
<script>
$('#sidebar').lionbars();
</script> 
```

就在 /body 标签之前。如果我用另一种方式做会更可靠吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:21:57.117

出现的问题是由于在加载图像之前初始化了脚本。

由于插件检查滚动条的“需要”：

**lionbars.js 的第 371 行**

```
// check for vertical scrollbars
if (el.get(0).scrollHeight > el.get(0).clientHeight) {
  addVScroll = true;
  // setVScrollbarWidth(el);
} 
```

您需要确保在调用脚本之前加载图像。

我会建议一个来自 stackoverflow 用户的脚本，该脚本将在加载图像后运行 lionbars 函数：

[jQuery waitForImages 的 GitHub 页面链接！](https://github.com/alexanderdickson/waitForImages)

**例如，**

```
$('#sidebar').waitForImages(function() {

    // All images are loaded, initialize the scroll bar plug-in
    $('#sidebar').lionbars();
}); 
```

**笔记：**

脚本有时会起作用的原因是，有时图像已经被浏览器缓存，并且在脚本初始化之前它们被放置在文档中。

# c++ - C++ 类 this-> 错误

> ID：10874099
> 
> 赞同：1
> 
> 时间：2012-06-03T21:31:27.417
> 
> 标签：c++, oop, class

```
class Bot{
private:
       char *serveradr;
public:
       char *get_serveradr(); 
       char set_serveradr(char *server);
       void servcon();                
       };

char Bot::set_serveradr(char *server)
 {
 serveradr = server;
 }

 char *Bot::get_serveradr()
 {
 return serveradr;

 void servcon()
 {
  sin.sin_addr.s_addr           = inet_addr(this.get_serveradr());

  } 
```

> 在非成员函数中无效使用“this”

很抱歉提出这样的问题，但我已经搜索并知道这是应该如何完成的，但我不确定我做错了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T21:33:14.460

您需要完全限定成员函数定义的名称：

```
void Bot::servcon()
{
    sin.sin_addr.s_addr = inet_addr(this->get_serveradr()); // Note use of ->

} 
```

否则，它被视为没有`this`指针的独立函数。

因为这是 C++，所以使用 a`std::string`而不是`char*`. 传递给`Bot::set_serveradr()`方法的参数必须比`Bot`容易出错的参数更有效（谁负责`delete[]`处理它？）。您可以访问`char*`using`std::string::c_str()`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T21:34:43.383

你需要更换

```
 void servcon()
    {
       ... 
    } 
```

和

```
 void Bot::servcon()
    {
       ... 
    } 
```

就像您对其他成员函数定义所做的那样

# iphone - Testflight SDK 缺少报告

> ID：10874100
> 
> 赞同：3
> 
> 时间：2012-06-03T21:31:43.223
> 
> 标签：iphone, objective-c, ios, sdk, testflight

我已经为我的 iOS 应用程序安装了 Testflight SDK。在每个步骤中都遵循手册。问题是 - 我没有从应用程序中得到任何报告。没有会话报告、错误、反馈——什么都没有。我检查了 Team Token - 一切都匹配。

这是我的代码：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{   

    //bla bla bla some initialization code

    [TestFlight takeOff:@"my team token"];
    [TestFlight setDeviceIdentifier:[[UIDevice currentDevice] uniqueIdentifier]];

    TFLog(@"Test message");

    return YES;
} 
```

我想念什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T11:44:19.613

我不知道这是否会解决您的问题，或者您是否已经自己解决了。文档说明您必须先`setDeviceIdentifier`致电`takeOff`。如果这对 API 至关重要，那么它永远不会知道是谁启动了应用程序，因为标识符是未知的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T00:17:07.713

您的日志应打印出“已启动会话”或“已识别团队令牌”消息。如果是这样并且它仍然无法正常工作，那么这可能是 TestFlight 方面的问题。我就类似的问题联系了他们，他们迅速回应说他们正试图将所有错误从他们的系统中清除，这将导致一段时间内的一些不稳定。我有时会收到消息，有时不会。希望他们能尽快修复它。我不认为 uniqueIdentifier 与它有太大关系，但我想删除它并没有什么坏处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T23:01:44.483

尝试删除设备标识符设置。

# php - Codeigniter 使用时区获取本地时间

> ID：10874104
> 
> 赞同：0
> 
> 时间：2012-06-03T21:32:33.090
> 
> 标签：php, codeigniter, date, time

我只是想使用以下代码显示我在迈阿密的当地时间：

```
date_default_timezone_set('America/New_York'); //is added in library 
$timestamp = time();
$timezone = 'UM5'; //(UTC - 5:00) Eastern Time, Bogota, Lima, Quito
$daylight_saving = TRUE;
$miamitime = gmt_to_local($timestamp, $timezone, $daylight_saving);

echo unix_to_human($miamitime); // U.S. time, no seconds 
```

我得到的时间比实际当地时间提前 1 天和 1 小时。我正在使用 WAMP 在本地服务器上测试该站点（不确定这是否会导致问题）。在我看来，我把一切都设置好了。我不确定是什么原因造成的。请告知如何正确显示我的当地时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T07:32:56.440

在您的 htaccess 文件中，您可以插入它（就在文件的最顶部）

```
# Set PHP Time Zone:
SetEnv TZ America/New_York 
```

它将强制您的服务器设置为您想要的任何时区。当服务器的本地时间实际上不是“您的”本地时间时，适用于托管解决方案。

# objective-c - 如何使用 JSONKit 将数据传输到 Xcode 中的服务器？

> ID：10874106
> 
> 赞同：-1
> 
> 时间：2012-06-03T21:32:38.113
> 
> 标签：objective-c, ios5, nskeyedarchiver, data-transfer-objects, jsonkit

我基本上是在尝试将数据发送到包含对象的服务器，并且同行告诉我使用 JSONKit。

到目前为止，我已经实现了*NSCoding*协议并使用*NSKeyedArchiver*序列化了我的对象。但我找不到任何关于如何发送数据的资源。

我的代码：导入

JSONKit.h

```
Art* art = [[Art alloc] initWithArt:@"test"]; // Object that implemented NSCoding
NSError *err = nil;
NSData *data = [NSKeyedArchiver archivedDataWithRootObject:art]; 
```

这就是混乱开始的地方。

```
JSONDecoder *jsonDecoder = [[JSONDecoder alloc] init];
[jsonDecoder objectWithData:data error:&err]; 
```

我现在需要使用以下命令将数据发送到服务器：

```
[server sendData:finalData error:&err]; 
```

但我不知道如何获得*finalData*。

非常感谢任何帮助，在此先感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T21:52:35.350

## [你](https://stackoverflow.com/questions/936855/file-upload-to-http-server-in-iphone-programming) [不](https://stackoverflow.com/questions/2323709/send-image-to-server-as-binary-data) [知道](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSURLRequest_Class/Reference/Reference.html) [如何](http://allseeing-i.com/ASIHTTPRequest/)[发送](http://ios-blog.co.uk/articles/tutorials/parsing-json-on-ios-with-asihttprequest-and-sbjson/)[服务器](https://stackoverflow.com/questions/5537297/ios-how-to-perform-a-http-post-request)[请求](https://stackoverflow.com/questions/8576741/json-data-from-ios-into-php-script)？？？？[_](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/nsurlconnection_Class/Reference/Reference.html) [_](http://www.raywenderlich.com/5492/working-with-json-in-ios-5) [_](https://stackoverflow.com/questions/9883081/post-data-in-objective-c-using-json)

# java - a4j:mediaOutput 与大型 mp3 文件

> ID：10874107
> 
> 赞同：0
> 
> 时间：2012-06-03T21:32:39.203
> 
> 标签：java, ajax, richfaces, seam

不知道我做错了什么。我补充说：

```
<h:form id="media">
<a4j:mediaOutput id="aud"  element="object" cacheable="false" session="true"
    title="canYouSeeMe"
    width="300"
        createContent="#{mediaPlay.play}"
        value="#{sdh:storeDataAndGetKey(mediaPlay.selectedFileData)}"
        mimeType="audio/x-mpeg" />
</h:form> 
```

当我第一次在 Firefox 中打开该页面时，我收到一条消息，我需要安装 QuickTime 插件。但没有别的。我看不到在 FF 或 IE 中播放音频的链接或方式。我从这里的教程中获得的递归 storeDataAndGetKey 方法： [https](https://community.jboss.org/wiki/A4jmediaOutputAndLargeObjectsAsValue) ://community.jboss.org/wiki/A4jmediaOutputAndLargeObjectsAsValue 用于大对象。

```
private static DataHolder getGraphDataHolder() {
        FacesContext fc = FacesContext.getCurrentInstance();

        ExternalContext externalContext = fc.getExternalContext();
        Map<String, Object> sessionMap = externalContext.getSessionMap();
        Object session = externalContext.getSession(true);
        DataHolder holder;
        synchronized (session) {
            holder = (DataHolder) sessionMap.get(DATA_HOLDER_ATTRIBUTE_NAME);
            if(holder == null){
                holder = new DataHolder();
                sessionMap.put(DATA_HOLDER_ATTRIBUTE_NAME, holder);
            }
        }
        return holder;
    }

    public static Object getDataByKey(Object key) {
        DataHolder holder = getGraphDataHolder();

        return holder.getDataByKey(key);
    } 
```

媒体播放.play:

```
public synchronized void play (OutputStream stream, Object object) throws IOException {
     Object restoredData = SessionDataHelper.getDataByKey(object);
     byte[] soundData = ((Data) restoredData).getFileData();
     stream.write(soundData);
} 
```

我可以在页面源中看到该组件，但在呈现的页面中看不到。我什至不确定我应该看到什么。

**页面加载后**编辑以添加原始 HTML****

 **```
<form id="j_id18:media" name="j_id18:media" method="post" action="/home.seam" enctype="application/x-www-form-urlencoded">
<input type="hidden" name="j_id18:media" value="j_id18:media" />
<object id="j_id18:media:aud" data="/a4j/s/3_3_1.GAorg.ajax4jsf.resource.UserResource/n/s/-1007594989/DATA/eAFlUs9rE0EUfl0stv4Aa6ziQai1KIiZmGS3UWpBUFEhsWJsQT297L4ks8zurDOz6WrRmxcFL169edWL!gVeC176NwgiIoggXp2dFKV1DgNv-N73fe978!Y7TGoFZ6UaMIyx8GPdZ4q0zFVIbFWTurNdLKwqfhUNQnkqwTcP9rThYKgIDV2RqaHUGDjcjnGENYHpoLbSiyk0S23YS0XGLedDeAoTbZhKZMT7nKLtenKEIidXFJn1crqkKFgfQ9IslEkmU8vNusYK3ZAiItXFEal7mx-WX73-1PHAa8N0KFDrW5jQTg9do3g6sB72adsTOQ4DR8cuuax1SXEU!DH2BC0VWSl!xkoynafOgCCjGQl2FwcdMkMZXSsyO4nmMnU5AEwcACgUHB-bttDduPe1zReff!svPYer!MX9Y3rz7Hn35!2tSyWidHCyXEbck9pJ7-a7mWSi9-PYr!0fZzqldhnc1PoszJzaSCjieFvgI5bZ6wlArqDywA3LypXYDF0c77bWvnw9sXHdCdo5PANHSl-MS7aSmyw3FkiYGDjknl3veJ1ZVqwvgl8byoRYMTSJmLvcWDzXDOZ2!ITl-f!czNt4DSy0ggZSE!1qENYvVP3zF6mKjSCq9lutRp2CZt0Pmn8A3l!elQ__" title="canYouSeeMe" width="300"></object><input type="hidden" name="javax.faces.ViewState" id="javax.faces.ViewState" value="j_id2" />

</form> 
```

这是Seam 2.2，RichFaces 3.3.3。在 JBoss 5.1 上运行**

# c++ - 在不更改代码的情况下拆分 .cpp 文件

> ID：10874112
> 
> 赞同：4
> 
> 时间：2012-06-03T21:33:45.890
> 
> 标签：c++, file-management

我有一个 .cpp 变得相当大，为了便于管理，我想将它分成几个文件。但是，有许多全局变量，我想避免在不同文件中管理一堆 extern 声明。有没有办法让多个 .cpp 文件充当一个文件？从本质上讲，我想要一种方法来划分代码，而编译器不会识别这种划分。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-03T21:48:49.720

> 有没有办法让多个 .cpp 文件充当一个文件？

是的。这就是 的定义`#include`。当您`#include`创建一个文件时，您可以对包含的文件进行文本替换来代替`#include`指令。因此，多个包含的文件共同作用以形成一个翻译单元。

在您的情况下，将文件切成几位。准确地做到这一点——不要添加或减少任何文本行。不要添加标题保护或其他任何东西。您几乎可以在任何方便的位置破坏您的文件。限制是：中断不能出现在注释内，也不能出现在字符串内，并且必须出现在逻辑行的末尾。

根据某种约定命名新创建的部分文件。它们不是完整的翻译单元，所以不要命名它们`*.cpp`。它们不是正确的头文件，所以不要命名它们`*.h`。相反，它们是部分完整的翻译单元。也许你可以命名它们`*.pcpp`。

至于basename，选择原始文件名，后缀为： `MyProg01.pcpp`，，`MyProg02.pcpp`等。

最后，用一系列`#include`语句替换您的原始文件：

```
#include "MyProg01.pcpp"
#include "MyProg02.pcpp"
#include "MyProg03.pcpp" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-03T21:37:23.047

当然，您总是可以将各种 CPP 文件 #include 到一个主文件中，这是编译器看到的那个。不过，这是一个非常糟糕的主意，而且您最终会遇到比正确重构文件更糟糕的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T21:49:15.803

虽然您可以在许多 cpp 文件中声明相同的全局变量集，但当编译器编译每个文件时，您将获得每个单独的实例，然后在它们组合时将无法链接。

唯一的答案是将所有全局变量放在自己的文件中，然后将它们剪切并粘贴到包含 extern 声明的头文件中（这可以很容易地自动化，但我发现使用箭头键将“extern”粘贴到它们前面是快速简单）。

您可以重构所有内容，但通常不值得付出努力（除非您出于其他原因需要更改某些内容）。

您可以尝试拆分文件，然后使用编译器告诉您每个新文件需要哪些全局变量，然后将这些全局变量直接重新引入每个文件，分别保留真正的全局变量。

如果您不想这样做，只需#include cpp 文件。

# python - 不小心在系统范围内安装了烧瓶和 sqlalchemy

> ID：10874113
> 
> 赞同：5
> 
> 时间：2012-06-03T21:33:58.047
> 
> 标签：python, sqlalchemy, flask

我不小心在系统范围内安装了烧瓶和 sqlalchemy。我“sudo pip install”了他们两个，现在我想知道如何从我的系统中卸载这两个。我已经设置了所有 virtualenv，所以我不想将烧瓶或 sqlalchemy 连接到我的系统。我读到直接安装它可能会在使用不同的框架和不同版本的框架时导致问题。

我在系统范围内安装这些软件包是否有问题？

![在此处输入图像描述](../Images/0dc059e93749a3896a85b095d65621b2.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-03T21:38:32.803

`sudo pip uninstall flask`应该做的伎俩。是的，如果您使用不同版本的其他软件包，全局安装可能会导致问题。

# ruby-on-rails - Rails 形成内联错误

> ID：10874114
> 
> 赞同：0
> 
> 时间：2012-06-03T21:34:10.070
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation

我有一个包含很多字段的大型表单，我们在 rails 中获取错误的方式是它们驻留在模型对象中。我想要一种干净的方式来显示每个字段之外的错误，而不是单独显示。是否有可以做到这一点的宝石，如果现在是最好的方法。

我希望每个错误都显示在错误所在的字段之外。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T13:09:53.867

假设您使用的是 Rails 3+ 和 Rails 表单助手，您不需要任何 gem，也不需要遍历错误集合。

好吧，这并不完全正确，但 Rails 为您做到了。你只需要提供一个过程。

我将以下内容添加到 .../config/application.rb：

```
# wrap each form field that has an error with the following. 
# note, condition for arrays and singletons.
config.action_view.field_error_proc = Proc.new do |html_tag, instance|
  if instance.error_message.kind_of?(Array)
    %(<span class="validation-error">#{html_tag}</span>).html_safe
  else
    %(#{html_tag}<span class="validation-error">&nbsp;</span>).html_safe
  end
end 
```

确保定义 CSS 类验证错误。这应该让它工作，然后你可以调整它以满足你的需要。请注意，您的 CSS 可以特定于每个字段类型，例如输入、文本区域、选择等。

当然，重新启动 Rails 应用程序。

我实际上是在 SO 的另一个线程中学到的，但我现在找不到它，所以我无法提供参考。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T23:56:32.877

尝试`simple_form`或`formtastic`使这更容易。有了这些，它会自动做你正在寻找的东西。

如果你想让你的视图真的很长，或者只是不想使用 gem，你也可以这样做：

`<span class="help-inline"><%= @object.errors[:field] %></span>`

但这会很快变得恶心。

# ruby-on-rails - 无法配置搜索字段以将搜索值传递给函数

> ID：10874117
> 
> 赞同：0
> 
> 时间：2012-06-03T21:34:51.793
> 
> 标签：ruby-on-rails, ruby, forms, input

我对 Ruby on Rails 很陌生，最近表单给我带来了各种各样的麻烦，所以你在这里的帮助和支持将非常有价值。

在我的`home.html.erb`文件中，我有以下代码：

```
 <%= form_tag({:controller => "pages", :action => "search"}, :method => "get", :class => "grabTweets") do %>
    <%= text_field_tag(:tweets)%>   
    <% end %> 
```

我正在尝试获取用户在该搜索字段中输入的值，并将其传递给一个名为的函数，该函数`grabTweets`包含以下代码：

```
 def grabTweets(mySearch)
    @tweet = Twitter.search(mySearch + "[pic] "+" instagr.am/i/", :rpp => 2, :result_type => "recent").map do |status|
    @tweet = "#{status.text}" #class = string
    urls = URI::extract(@tweet, "http") #returns an array of strings
    end
  end 
```

我的表单代码`home.html.erb`正确呈现，但不与 grabTweets 函数通信。像我一样在谷歌上搜索和修补，我似乎无法找出答案。home.html.erb 中的代码将此添加到我的 localhost URL: 的末尾`/assets?utf8=✓&amp;tweets=google`，因此搜索未正确路由。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T10:02:29.427

有两件事：首先你需要确保你的 url 被路由到写控制器

```
match '/search', :to "pages#search" 
```

应该这样做。

然后在 PagesController 的搜索操作中，调用

```
grabTweets(params[:tweets]) 
```

并对结果做一些有趣的事情。显然，如果`grabTweets`不是您的控制器上的实例方法，那么您需要调整调用它的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T00:10:22.350

你的网址很好。对于搜索，您应该将参数作为 GET 参数传入（就像您目前所做的那样）

问题在于您如何访问搜索参数。而不是像这样尝试读取函数中的参数：

```
def grabTweets(mySearch)
  @tweet = Twitter.search(mySearch + "[pic] "+" instagr.am/i/", :rpp => 2, :result_type => "recent").map do |status|
  @tweet = "#{status.text}" #class = string
  urls = URI::extract(@tweet, "http") #returns an array of strings
  end
end 
```

读取参数哈希：

```
def grabTweets
  @tweet = Twitter.search(params[:tweets] + "[pic] "+" instagr.am/i/", :rpp => 2, :result_type => "recent").map do |status|
  @tweet = "#{status.text}" #class = string
  urls = URI::extract(@tweet, "http") #returns an array of strings
  end
end 
```

这就是鲁比。请不要使用 CamelCase 变量。

# java - 删除时出现“org.hibernate.TransactionException：不支持嵌套事务”错误

> ID：10874119
> 
> 赞同：8
> 
> 时间：2012-06-03T21:35:01.457
> 
> 标签：java, mysql, hibernate

运行 removeUserFromConference 方法时出现此异常：

```
04/06/2012 00:20:48 org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet [ConferenceServlet] in context with path [/conf4u] threw exception
org.hibernate.TransactionException: nested transactions not supported
    at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.begin(AbstractTransactionImpl.java:152)
    at org.hibernate.internal.SessionImpl.beginTransaction(SessionImpl.java:1396)
    at sun.reflect.GeneratedMethodAccessor39.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.hibernate.context.internal.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:352)
    at $Proxy12.beginTransaction(Unknown Source)
    at daos.ConferenceDao.isConferenceNameExists(ConferenceDao.java:129)
    at servlets.ConferenceServlet.removeUser(ConferenceServlet.java:232)
    at servlets.ConferenceServlet.processRequest(ConferenceServlet.java:79)
    at servlets.ConferenceServlet.doPost(ConferenceServlet.java:433)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:928)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:539)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:298)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
04/06/2012 00:27:15 org.apache.catalina.core.StandardContext reload
INFO: Reloading Context with name [/conf4u] has started
04/06/2012 00:27:15 org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc
SEVERE: The web application [/conf4u] registered the JDBC driver [com.mysql.jdbc.Driver] but failed to unregister it when the web application was stopped. To prevent a memory leak, the JDBC Driver has been forcibly unregistered.
04/06/2012 00:27:15 org.apache.catalina.core.StandardContext reload
INFO: Reloading Context with name [/conf4u] is completed 
```

道法：

```
public void removeUserFromConference(Conference conference, User user) {
    ConferencesUsers conferenceUser = getConferenceUser(conference, user);

    Session session = HibernateUtil.getSessionFactory().getCurrentSession();
    session.beginTransaction();

    session.delete(conferenceUser);

    session.getTransaction().commit();
} 
```

模型类：

```
@Entity
@Table( name = "Conferences_Users" )
public class ConferencesUsers implements Serializable {
    private static final long serialVersionUID = -3401337605668111437L;
    private Conference conference;
    private User user; 
    private int userRole;
    private UserAttendanceStatus attendanceStatus;
    private boolean notifiedByMail;

    ConferencesUsers() {}  //not public on purpose!

    public ConferencesUsers(Conference conf, User user, int userRole) {
         this.conference = conf;
         this.user = user;
         this.userRole = userRole;
         this.attendanceStatus = null;
         this.notifiedByMail = false;
    }

    public ConferencesUsers(Conference conf, User user, int userRole, UserAttendanceStatus attendanceStatus, boolean notifiedByMail) {
         this.conference = conf;
         this.user = user;
         this.userRole = userRole;
         this.attendanceStatus = attendanceStatus;
         this.notifiedByMail = notifiedByMail;
    }

    @Id
    @ManyToOne(cascade = CascadeType.ALL)
    public Conference getConference() {
         return conference;
    }

    public void setConference(Conference conference) {
         this.conference = conference;
    }

    @Id
    @ManyToOne(cascade = CascadeType.ALL)
    public User getUser() {
         return user;
    }

    public void setUser(User user) {
         this.user = user;
    }

    @Enumerated(EnumType.STRING)
    public int getUserRole() {
         return userRole;
    }

    public void setUserRole(int userRole) {
         this.userRole = userRole;
    }

    @Nullable
    public boolean isNotifiedByMail() {
         return notifiedByMail;
    }

    public void setNotifiedByMail(boolean notifiedByMail) {
         this.notifiedByMail = notifiedByMail;
    }

    public UserAttendanceStatus getAttendanceStatus() {
         return attendanceStatus;
    }

    public ConferencesUsers setAttendanceStatus(UserAttendanceStatus attendanceStatus) {
         this.attendanceStatus = attendanceStatus;
         return this;
    }
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-03T21:46:13.093

您可能已经开始了一个事务，并试图在没有提交或回滚前一个事务的情况下开始另一个事务。使用程序化事务划分时的习惯用法如下：

```
try {
    sess.getTransaction().begin();

    // do some work

    sess.getTransaction().commit()
}
catch (RuntimeException e) {
    sess.getTransaction().rollback();
    throw e;
} 
```

这既麻烦又容易出错，这也是使用 EJB 或 Spring 进行声明性事务如此有用的原因之一。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-25T11:42:42.480

首先，你应该注入 hibernateProperties，hibernate.current_session_context_class，

```
<property name="hibernateProperties">
    <props>
        <prop key="hibernate.dialect">org.hibernate.dialect.MySQL5Dialect</prop>
        <prop key="hibernate.show_sql">true</prop>
        <prop key="hibernate.format_sql">true</prop>
        <prop key="hibernate.hbm2ddl.auto">update</prop>
        <prop key="hibernate.current_session_context_class">thread</prop>
    </props>
</property> 
```

那么您可以使用 getCurrentSession() 来获取 CurrentSession。

```
Session session = sessionFactory.getCurrentSession();
session.beginTransaction();
long count = (Long) session
        .createQuery("select count(*) from User u where u.name = :name")
        .setString("name", name).uniqueResult();
session.getTransaction().commit(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-06T04:04:15.887

我以前也有同样的问题。第一次运行：

```
session.beginTransaction();
session.save(something);
session.getTransaction().commit(); 
```

当通过以下方式查询某些内容时：

```
session.beginTransaction();
session.query ... 
```

在 second 引发了同样的异常`beginTranscation`。我通过使用解决了它

```
session.getTransaction().begin(); 
```

代替

```
session.beginTransaction(); 
```

在查询和保存中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-02T07:58:26.370

你在这里做了什么：

```
Session session = HibernateUtil.getSessionFactory().getCurrentSession(); 
```

实际上是在尝试使用打开的会话而不关闭它。

它发生在我身上，我面临同样的问题，我所做的是：

```
Session session = HibernateUtil.getSessionFactory().openSession();

// Hibernate bla bla bla transaction or rollback
// then always  close your session :

if (session.isOpen()) {
            session.close();
        } 
```

并且没有再次引发“不支持休眠嵌套事务错误”...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-22T09:07:08.793

这一行“session.beginTransaction();” 防止多个事务，因此删除此行并尝试，因为在选择查询中它不是必需的，但在删除此代码后它的代码不起作用，然后在此代码的末尾添加“session.rollback();”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-01T19:21:54.823

我解决了这个问题，创建了不同的会话

```
Session session = factory.openSession();
session.beginTransaction();

//your code here

session.getTransaction().commit(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-22T12:32:17.820

尝试使用 finally 关闭您的 Hibernate 会话，如下所示：

```
try {
    session.getTransaction().begin();

    // YOUR CODE

    session.getTransaction().commit();
} catch (RuntimeException e) {
    try{
        session.getTransaction().rollback();
    } catch(RuntimeException rbe) {
        log.error("Couldn’t roll back transaction", rbe);
    }
    throw e;
} finally {
    if (session != null && session.isOpen()) {
        session.close();
    }
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-02-01T15:01:02.137

我可以用以下代码解决它：

```
public class UserDaoImpl implements UserDao {  

    Session session = null;

    public UserDaoImpl() {
        this.session = HibernateUtil.getSessionFactory().openSession();
    }

    @Override
    public List<TblUsuario> getAllUsers() {

        List<TblUsuario> listUsuarios = null;

        try {
            org.hibernate.Transaction tx = this.session.getTransaction();
            Query query = this.session.createQuery("....");
            listUsuarios = query.list();
        } catch (Exception e) {
            e.printStackTrace();
        } 

        return listUsuarios;
   }

...

} 
```

# android - 具有自定义布局的 ListView 多选

> ID：10874120
> 
> 赞同：1
> 
> 时间：2012-06-03T21:35:10.640
> 
> 标签：android, android-listview

我正在尝试制作类似 gmail 的列表视图。That is, initially, the listview is in single choice mode, but when a checkbok is selected, it becomes multiple choice.

这是我到目前为止所拥有的：

```
 SimpleCursorAdapter dataSource = new SimpleCursorAdapter(this, R.layout.listitem, cursor,
             new String[]{"_id","a","b","c","d","e","f","g","h"}, 
             new int[] { R.id.checkBox1, R.id.a, R.id.b, R.id.c, R.id.d, R.id.e}
// all of these are a part of my list item custom layout.
             );

    dataSource.setViewBinder(new SimpleCursorAdapter.ViewBinder() {

@Override
public boolean setViewValue(View aView, final Cursor c, int i) {

    String s=c.getString(i);
    String toset="";
    TextView tv = i==0?null: (TextView) aView;
    if (i==0){
        if(chkL==null){
            chkL=new OnCheckedChangeListener() {
                @Override
                public void onCheckedChanged(CompoundButton cb1, boolean isChecked) {
                    CheckBox cb=(CheckBox) cb1;
                    chkid[c.getPosition()]=isChecked;

                    if(lv.getChoiceMode()!=lv.CHOICE_MODE_MULTIPLE){
                        lv.setChoiceMode(lv.CHOICE_MODE_MULTIPLE);
                    }
                    lv.setItemChecked(c.getPosition()+1,isChecked);
                    log(isChecked+" selected "+(c.getPosition()+1));
                }

        };
        }

        CheckBox cb= (CheckBox) aView;
        cb.setOnCheckedChangeListener(chkL);

        return (i==0);
    }}; 
```

目前，我正在尝试通过按下复选框来至少使该项目“被选中”。我正在使用`c.getPosition()+1`(cursor's position) 来获取被点击的列表项的位置。但这似乎总是返回`1`或有时返回随机值。

**更新：** 看起来它总是返回 1，但是当我遍历 getCheckedItemPositions() 时，我看到那个项目没有。10人被选中。点击另一个复选框，光标位置再次为 1，但第 11 项将被选中，依此类推。但是，如果我在复选框之外点击，则会选择正确的项目。

此外，在选择一个复选框时，如果向下滚动，您会看到其他几个复选框已被选中。（我的列表中有大约 255 项）。我认为这是由于android重用相同复选框的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T22:08:44.990

我会尝试一种稍微不同的方法：

*   将 ListView 保持为`SINGLE_CHOICE`，但使用侦听器设置每行的 CheckBox，该侦听器将行添加/删除`id`到名为 List的`checkedRows`（例如）。

*   当您想要删除、移动、加注星标等选中的行时：迭代`checkedRows`并执行必要的操作。

我相信这比在多种类型的默认状态和功能之间来回切换更简单。

**添加**

我从来没有覆盖`setViewValue()`，但这应该工作：

```
CheckBox cb= (CheckBox) aView;
cb.setOnCheckedChangeListener(chkL);
cb.setTag(c.getLong(c.getColumnIndex("_id"))); // Add this 
```

在你的`onClickListener()`：

```
long id = (Long) cb1.getTag(); 
```

# php - 使用按钮单击或表单提交禁用注册按钮，两种方式都会阻止表单提交

> ID：10874122
> 
> 赞同：0
> 
> 时间：2012-06-03T21:36:04.737
> 
> 标签：php, javascript, forms, double-click, submission

我一直在研究这个问题，它让我发疯！

所以我有一个注册 POST 表单，提交后，它会重定向到同一页面，尽管我有以下内容：

```
 if (isset($_POST['submit']))
{
  //include validation and executing code... (another page)
} 
```

现在代码完美运行，一切都很好，但我有一个问题。

当用户连续单击两次时，他会收到一条消息，指出已注册具有相同电子邮件的用户（第一次单击已注册他并将信息插入数据库）

现在我尝试在按钮标签中使用：禁用按钮`Onclick="this.RegisterBtn.disabled=1;"`，我也尝试`onSubmit="this.RegisterBtn.disabled=1;"`在表单标签中使用：。

两者都停止提交表单，不知道为什么。我也试过这个：

```
onClick="this.RegisterBtn.disabled=1; this.form1.submit();" 
```

现在我想出了一个假设，当一个按钮被禁用时，“isset”函数将返回 false，如果这里有经验的人可以确认或帮助我解决这个问题，我将非常感激，我只是对 php 有点陌生这个 ：） ，

非常感谢提前

编辑：表单操作为空（重定向到同一页面），包含的代码位于表单上方。

编辑：当我禁用按钮时，isset($_POST['submit']) 总是返回 false。

解决方案：好的，我确实解决了它，以防有人越过我的帖子遇到同样的问题，这就是我解决它的方法：

首先，当您禁用按钮时，isset($_POST['buttonname']) 将始终返回 false。所以我做了以下事情：

而不是我使用的这个条件： if (!empty($_POST)) ..... 包含代码

我使用了 onsubmit （在表单标签中）.. this.button1.disabled=1; ，现在一切正常:-)，表单不能提交两次 :D。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T21:45:10.617

尝试

```
<input type="submit" name="submit" value="Submit" onclick="this.disabled = true;" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T23:20:02.443

忘记弄乱表格。在服务器端使用这些简单的检查：

*   如果出现第二次注册完全相同的电子邮件地址的请求，请忽略它。
*   如果出现不同的电子邮件地址，请更新它。
*   如果之前没有，那么添加它。

# c - 为什么我的正则表达式会在 Makefile 中中断？

> ID：10874124
> 
> 赞同：1
> 
> 时间：2012-06-03T21:37:20.277
> 
> 标签：c, regex, bash, makefile

我有一堆按顺序命名的 C 源文件（比如`f1.c`,`f2.c`等`f3.c`）。

在我的 Makefile 中，我有一个`clean:`过去看起来像这样的定义：

```
rm -f f1
rm -rf f1.dSYM
rm -f f2
rm -rf f2.dSYM
# etc 
```

所以我想用一个正则表达式替换它，如果我直接将它输入到命令行中效果很好：

```
ls | grep -P ^f[0-9]+(|\.dSYM)$ | xargs rm -rf 
```

但是，如果我将该命令放在我的干净定义中，当我运行时`make clean`，我会得到：

```
$ make clean
ls | grep -P ^f[0-9]+(|\.dSYM)| xargs rm -rf
/bin/sh: -c: line 0: syntax error near unexpected token `('
/bin/sh: -c: line 0: `ls | grep -P ^ex[0-9]+(|\.dSYM)| xargs rm -rf'
make: *** [clean] Error 2 
```

我猜我的正则表达式中有一些特殊字符会导致语法错误......我试过引用和转义东西，但没有任何帮助，有谁知道我如何在我的 Makefile 中让它工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T22:05:04.283

另一个解决方案，使用`$(wildcard)`查找 C 源代码和模式替换来获取派生文件名：

```
SOURCES := $(wildcard f[0-9]*.c)

clean :
    rm -f $(SOURCES:.c=)
    rm -rf $(SOURCES:.c=.dSYM) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-03T21:44:39.370

```
ls | grep 
```

是无用的使用`ls`。[http://porkmail.org/era/unix/award.html#ls](http://porkmail.org/era/unix/award.html#ls)

```
rm -rf f[0-9] f[0-9]*[0-9] f[0-9]*.dSYM 
```

在明确的情况下，使用**globing**。请参阅[http://mywiki.wooledge.org/glob](http://mywiki.wooledge.org/glob)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T21:50:42.917

直接解决方案：引用您的正则表达式。更好的解决方案：glob、大括号扩展和/或`find ... -delete`.

```
rm -rf f{1,2}{,.dSYM}
rm -rf f? f?.dSYM
ffind . -regex '.*/f[0-9]' -o -regex '.*/f[0-9].dSYM' -delete 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T21:45:07.700

您的命令行 shell 可能与`make`使用的 shell 不同。我猜你`/bin/bash`在命令行使用，但`/bin/sh`默认使用。您可以通过预先设置来更改它

```
SHELL=/bin/bash 
```

到 Makefile。

在竖线和括号周围添加引号总是比不加引号更安全。另请注意，美元符号必须在 Makefile 中加倍，而不被视为特殊字符。

# .net - 具有强类型的模型继承

> ID：10874125
> 
> 赞同：1
> 
> 时间：2012-06-03T21:37:21.860
> 
> 标签：.net, inheritance, object, model

我有一个棘手的建模问题，我想有另一个观点。

我正在处理一个被某些引擎作为一个整体对待的模型。看起来像这样（名称不是我们使用的名称）：

```
public class Container{
  // Some other specific properties and methods, ctor etc

  public IList<Group> Groups {get; private set;}

  // For convenience, we need that
  public IList<Element> Elements {get; private set;}
}

public class Group{
  // Specific stuff here      

  public IList<Element> Elements{get; private set;}

  public Container Container{get; set;}
}

public class Element{
  public Group Group {get; set;}
} 
```

在整个模型中，我们都有那些双重引用，因为模型被引擎视为一个整体。

现在，棘手的部分：我需要创建 2 个特定模型，共享这个组织。

目前，我有一个包含三个类的模型：Container - Group - Element。

我需要创建共享相同结构的特定模型，但在整个模型中都有特定的类。

*   BaseContainer、BaseGroup、BaseElement（父级）
*   ContainerFoo - GroupFoo - ElementFoo（第一个孩子）
*   ContainerBar - GroupBar - ElementBar（第二个孩子）

**而且，要完整，最重要的是我需要强类型集合。例如，我需要 ContainerFoo 中的 GroupFoo 列表，而不是父类型的列表。**

我探索了两种方法来实现这一点：泛型和创建新属性。

例如：

```
public class BaseContainer<TGroup, TElement>{
  public IList<TGroup> Groups {get; private set;}

  public IList<TElement> Elements{get; private set;}  
}

public class BaseGroup<TContainer, TElement>{
  public TContainer Container {get; set;}

  public IList<TElement> Elements {get; private set;}
}

public class BaseElement<TGroup>{

  public TGroup Group{get; set;}

}

public class ContainerFoo: BaseContainer<GroupFoo, ElementFoo>{
  // Specific stuff here
}

public class GroupFoo: BaseGroup<ContainerFoo, ElementFoo>{
}

public class ElementFoo: BaseElement<ContainerFoo>{
} 
```

此解决方案在这种情况下有效，但：

*   容器中的类型列表可以很长，因为容器实际上是整个模型的入口点（这里简化了）
*   我们实际上不能将它与用于序列化和反序列化的 protobuf-net 一起使用。

第二种解决方案：

```
 public abstract class BaseContainer{

  public abstract IList<BaseGroup> Groups {get;}

  public abstract IList<BaseElement> Elements{get;}  
}

public abstract class BaseGroup{
  public abstract BaseContainer Container {get; set;}
}

public abstract class BaseElement{

  public abstract BaseGroup Group{get; set;}
}

public ContainerFoo : BaseContainer{

  public override IList<BaseGroup> Groups {
    get{
      // We are using .Net 4, and we can do that.
      return (IList<BaseGroup>)this.GroupsFoo;
    }
  }

 public IList<GroupFoo> GroupsFoo{ get; private set;}

 // Same thing for elements
}

// You see the point, I don't want to create other classes here. 
```

我认为您显然可以看到我不喜欢第二种解决方案的地方！

还有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T21:53:10.670

`abstract/override`您可以`new`在派生类的属性上使用修饰符，而不是使用：

```
class Container {
  public IList<Group> Groups { get; private set; }
}

class ContainerFoo : Container {
  public new IList<GroupFoo> Groups { get { return (IList<GroupFoo>)base.Groups; } }
} 
```

或者，在这里使用继承有什么真正的好处吗？`IContainer<T>`定义一个通用接口并取消基类会更好吗？

```
interface IContainer<TGroup> where T : Group {
  IList<TGroup> Groups { get; }
}

class ContainerFoo : IContainer<GroupFoo> {
  public IList<GroupFoo> Groups { get; private set; }
}

class ContainerBar : IContainer<GroupBar> {
  public IList<GroupBar> Groups { get; private set; }
} 
```

# jquery - $.ajax(this) 在被 setTimeout 调用时不起作用

> ID：10874134
> 
> 赞同：2
> 
> 时间：2012-06-03T21:38:53.550
> 
> 标签：jquery

这是 的误差函数`$.ajax`。为什么我不能延迟通话 `$.ajax(this)`？

这有效：

```
error: function (req, status, error) {
                    $.ajax(this);
                    return;
                } 
```

但这并不

```
error: function (req, status, error) {
                    var retry = function () { $.ajax(this); };
                    setTimeout(retry, 100);
                    return;
                } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T21:40:55.467

因为`setTimeout`回调在全局对象的上下文中运行。
因此，`this`is `window`，不是 AJAX 设置。

您需要存储`this`在变量中。

# iphone - 在 uiviewcontroller 中添加 uitableviewcontroller 作为子视图时出错

> ID：10874135
> 
> 赞同：3
> 
> 时间：2012-06-03T21:38:54.263
> 
> 标签：iphone, ios5, xcode4.3

我正在做一个简单的应用程序来查看来自 json 服务器的项目

我在一个 UIViewController 中使用 UISegment 添加不同的子视图

```
 - (IBAction)segmentSwitch:(id)sender {
    UISegmentedControl *segmentedControl = (UISegmentedControl *) sender;
    NSInteger selectedSegment = segmentedControl.selectedSegmentIndex;

    if (selectedSegment == 0) {
        instantiateViewControllerWithIdentifier:@"prestige"] animated:NO];

        UIViewController *subController = [self.storyboard instantiateViewControllerWithIdentifier:@"prestige"];
        [mainView addSubview:subController.view];

    }
    else if(selectedSegment == 1)
    {
        instantiateViewControllerWithIdentifier:@"latest"]];
        //[self setView: [self.storyboard instantiateViewControllerWithIdentifier:@"latest"]];
        //UIViewController *subController = [self.storyboard instantiateViewControllerWithIdentifier:@"latest"];
        //[mainView addSubview:subController.view];

        UITableViewController *tableVC =[self.storyboard instantiateViewControllerWithIdentifier:@"latest"];

        [self.view addSubview:tableVC.tableView];

    }
    else if (selectedSegment == 2)
    {
        instantiateViewControllerWithIdentifier:@"contactUs"]];
        UIViewController *subController = [self.storyboard instantiateViewControllerWithIdentifier:@"contactUs"];
        [mainView addSubview:subController.view];
    }
} 
```

当我选择选择段 2 以查看 uitableviewcontroller 作为子视图 x 代码时出现我的错误给我以下错误

> exc_bad_access (code=1 address=0x110ff210 on line NSDictionary *latests = [latestArray objectAtIndex:indexPath.row];

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"latestCell1";

    latestCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    NSDictionary *latests = [latestArray objectAtIndex:indexPath.row];

    NSString *latest_name_En = [latests objectForKey:@"title_en"];
    NSString *logo1 = [latests objectForKey:@"logo"];
    NSString *img1 = [latests objectForKey:@"img1"];

    NSData *latestsImg1 = [NSData dataWithContentsOfURL:[NSURL URLWithString:img1]];
    NSData *latestsLogo1 = [NSData dataWithContentsOfURL:[NSURL URLWithString:logo1]];    

    cell.latest_name_en1.text = latest_name_En;

    dispatch_async(dispatch_get_main_queue(), ^{

        cell.latest_img1.image = [UIImage imageWithData:latestsImg1];
        cell.latest_logo1.image = [UIImage imageWithData:latestsLogo1];

    });

    return cell;
} 
```

我确信 UITableViewController 工作正常，因为我试图单独运行它，它也可以在没有自定义单元格的情况下尝试它，它也可以工作，但是使用自定义单元格作为子视图它会给出上述错误。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-04T08:27:35.343

谢谢您的帮助

我终于弄清楚我用过

```
[self addChildViewController:subController];
[mainView addSubview:subController.view]; 
```

将 tableview 作为子视图添加到 viewcontroller

它奏效了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T22:49:14.620

latestArray 未正确初始化。

任何时候你得到 EXEC_BAD_ACCESS，通过 Zombies Instrument 运行你的代码。这将指向任何有问题的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T01:18:06.330

对象 latestsImg1 和 latestsLogo1 在初始化时不会被保留。因此，当 dispatch_async 中执行的异步代码块运行时，这些值可能已经被释放并且不再有效。因此，当异步块执行时，这两个指针会被遗忘。我建议要么不要通过 GrandCentral 调度执行这两个任务，要么如果您必须异步执行它们，则在创建后保留它们并在 async 块中释放它们。

就像是：

NSData *latestsImg1 = [NSData dataWithContentsOfURL:[NSURL URLWithString:img1]]; [latestImg1 保留]; NSData *latestsLogo1 = [NSData dataWithContentsOfURL:[NSURL URLWithString:logo1]];
[latestsLogo1 保留]; cell.latest_name_en1.text = latest_name_En;

```
dispatch_async(dispatch_get_main_queue(), ^{

    cell.latest_img1.image = [UIImage imageWithData:latestsImg1];

cell.latest_logo1.image = [UIImage imageWithData:latestsLogo1];
[latestsImg1 release];
    [latestLogo1 release];

}); 
```

# wxpython - 动态改变 wx.Dialog wx.CLOSE_BOX 风格

> ID：10874138
> 
> 赞同：1
> 
> 时间：2012-06-03T21:39:44.423
> 
> 标签：wxpython

我想创建一个 wx.Dialog 窗口，我可以在其中动态地使窗口具有 wx.CLOSE_BOX 样式，但能够暂时禁用它并让它在不可用时看起来被禁用。我知道在控件的消息处理程序中，我需要注意 wx.EVT_CLOSE 事件，并根据我所处的状态跳过、忽略或否决它，但我希望标题栏中的小 X 能够直观地反映我的州也。

目前，当我想关闭 CLOSE_BOX 时，我会这样做：

```
 style = self.GetWindowStyle()
    self.SetWindowStyle(style & (~wx.CLOSE_BOX)) 
```

当我想重新打开它时我会这样做：

```
 style = self.GetWindowStyle()
    self.SetWindowStyle(style | wx.CLOSE_BOX) 
```

即使我可以看出样式整数 DO 的更新似乎正在发生，但似乎没有禁用实际对话框窗口的 X 按钮。有谁知道做我想做的事情的简单方法？这是我试图在对话框中动态进行的更改的屏幕截图：

![在此处输入图像描述](../Images/26e63d2ae85ef13d722f0f3023fef2a5.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T05:41:08.183

您的问题对您要执行的操作有点含糊，但我假设您想阻止人们在您的应用程序执行某些任务时关闭您的对话框。

`wx.CLOSE_BOX`只是一种风格。我尝试创建有和没有的对话框，`wx.CLOSE_BOX`它所做的只是改变对话框底部的按钮。即使我没有设置`wx.CLOSE_BOX`，仍然有一个确定按钮可以关闭窗口。除此之外，X 按钮呢？Alt+F4 呢？

你最好的选择可能是制作你自己的自定义面板，创建你自己的“关闭”按钮，然后调用`Enable(False)`，直到你完成你的过程。但是，这仍然不会阻止用户单击 X 按钮或按 Alt+F4。为此，您需要抓住`wx.EVT_CLOSE`. 看这个例子：

```
class CustomDialog(wx.Dialog):
    def __init__(self, parent, title):
        wx.Dialog.__init__(self, parent=parent, title=title)

        self.closeButton = wx.Button(self,wx.ID_CLOSE,"Close")
        self.closeButton.Enable(False) #initialize the button as disabled

        self.Bind(wx.EVT_BUTTON, self.onClose, id=wx.ID_CLOSE)
        self.Bind(wx.EVT_CLOSE, self.onClose)
        #wx.EVT_CLOSE is triggered by the X button or Alt+F4

    def onClose(self, event):
        if self.closeButton.IsEnabled():
            #if we want to allow the user to close the dialog

            #do something

            event.Skip() #allow this event to close the window

    def reenableButtom(self):
        self.closeButton.Enable(True) 
```

然后，您可以在流程结束时手动调用`self.reenableButton()`，也可以将其绑定到事件。

检查非常重要，`self.closeButton.IsEnabled()`因为请记住它`self.onClose()`不仅仅绑定到按钮。无论用户单击“关闭”按钮、单击 X 按钮还是按下 Alt+F4，我们都希望确保对话框的行为相同。`event.Skip()`让偶数向上传播。允许`wx.EVT_CLOSE`传播将关闭对话框。因此，除非我们想关闭窗口，否则不要调用此行，这一点非常重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T14:41:24.160

据我所知，创建窗口后无法更改该样式。根据文档：

> 另外，请注意，并非所有样式都可以在控件创建后更改。

[http://docs.wxwidgets.org/stable/wx_wxwindow.html#wxwindowtogglewindowstyle](http://docs.wxwidgets.org/stable/wx_wxwindow.html#wxwindowtogglewindowstyle)

这是我使用的一个简单测试：

```
import wx

def toggle(window):
    print window.ToggleWindowStyle(wx.CLOSE_BOX)
    window.Refresh()
    wx.CallLater(2000, toggle, window)

def main():
    app = wx.App(None)
    window = wx.Dialog(None)
    toggle(window)
    window.ShowModal()
    window.Destroy()
    app.MainLoop()

if __name__ == '__main__':
    main() 
```

# .htaccess - .htaccess 不适用于 $_GET

> ID：10874140
> 
> 赞同：0
> 
> 时间：2012-06-03T21:40:14.593
> 
> 标签：.htaccess

我在 .htaccess 文件中有一行：

```
RewriteRule ^(.*)$ index.php?page=$1 [NC,L] 
```

和 index.php 中的一行：

```
$page = $_GET['page']; echo $page; 
```

如果我去[http://www.example.com/test-page](http://www.example.com/test-page)，它会返回 index.php。

我发现修复它的唯一方法是：

```
RewriteRule ^(.*)/$ index.php?page=$1 [NC,L] 
```

如果我去[http://www.example.com/test-page/](http://www.example.com/test-page/)它可以工作并输出测试页。

但是，我不希望网页使用[http://www.example.com/test-page/](http://www.example.com/test-page/)，我希望它使用[http://www.example.com/test-page](http://www.example.com/test-page)。

我该如何解决这个问题，最好不要在内部重写中添加将 / 添加到 url 末尾的规则......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T21:45:06.643

尝试

```
RewriteRule ^(.*)$ /index.php?page=$1 [NC,L] 
```

或尝试这样的事情

```
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

这会将所有流量重定向到 index.php。您可以使用 eg`$_SERVER[REQUEST_URI]`来获取您的路径。

# facebook - 在 iphone 应用程序中响应 Facebook 请求

> ID：10874141
> 
> 赞同：1
> 
> 时间：2012-06-03T21:40:24.007
> 
> 标签：facebook, facebook-graph-api

我正在使用它向 Facebook 上的朋友发送请求。我希望收到请求的人能够打开它并获得接受请求的奖金。我将如何去确认接收端的请求？

```
-(IBAction)sendRequest:(id)sender
{
NSMutableDictionary* params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                               @"Come check out my app.",  @"message",
                               nil]; 

AppDelegate *aDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate]; 
[aDelegate.facebook dialog:@"apprequests" andParams:params andDelegate:self]  

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T22:18:56.340

您应该查看[Android 和 iOS：Discovery via Requests Best Practices](http://developers.facebook.com/blog/post/2012/04/26/android-and-ios--discovery-via-requests-best-practices/)官方博客文章。

它讨论（除其他事项外）如何发送用户请求以及一些相关数据，然后如何识别请求并获取相关数据。

# javascript - 如何将自定义 javascript 添加到谷歌网站？

> ID：10874147
> 
> 赞同：8
> 
> 时间：2012-06-03T21:40:59.770
> 
> 标签：javascript, jquery, jquery-ui, google-sites, html-box-gadget

如何获得在 google 站点上添加/编辑 JS 的能力？这样，我想使用 jQuery 和 jQuery UI 来操作网站的外观。

需要说明的是，我并不是在谈论所有的谷歌网站，只是谷歌创建的创建你自己的系统，称为“谷歌网站”-> [https://sites.google.com/](https://sites.google.com/)。

在[howto页面上](https://support.google.com/sites/bin/answer.py?hl=en&answer=2500646)，有这样的：不支持的功能

> HTML 框工具目前不支持以下功能：
> 
> iframes JavaScript 代码不能创建任何脚本、图像或链接标签文档/窗口 onload 和 onready 函数。您可以将任何 JavaScript 放在需要在文档加载后加载的代码的末尾。

这是否意味着 HTML 工具无法创建标签？即使他们在上面的演示中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-03T22:02:00.383

[Google 协作平台帮助解释了如何添加自定义 HTML/CSS/JS 内容](https://support.google.com/sites/bin/answer.py?hl=en&answer=2500646)：

> 1.  转到您要在其中嵌入 HTML 的 Google 协作平台页面。
> 2.  转到插入菜单并选择 HTML 框。
> 3.  在打开的对话框中，添加 HTML、CSS 和/或 Javascript 代码。
> 4.  完成后，单击保存。
> 5.  要预览嵌入的 HTML，请单击 Google 站点页面上的保存。

它继续指出“来自一个 HTML 框的代码不能与 HTML 框之外的代码交互或引用，包括其他 HTML 框”——大概每个“HTML 框”都是一个单独的沙盒 iframe 元素。因此，您使用 JS 来“操纵网站的外观和感觉”的能力将非常有限。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-02-04T23:17:57.387

另一种选择是编写自己的小工具

“小工具是可以添加到网页中的小型 Web 应用程序。小工具是通常包装 HTML 和 JavaScript 的 XML 文件”，正如名为 Mori 的 Google 协作平台专家所解释的那样。 [https://sites.google.com/site/mori79/html-gadgets](https://sites.google.com/site/mori79/html-gadgets)

您还可以在 Google Developers 网站上找到更多信息： [https ://developers.google.com/google-apps/sites/gadgets/site_gadgets?hl=en](https://developers.google.com/google-apps/sites/gadgets/site_gadgets?hl=en)

希望能帮助到你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-03T21:55:28.267

Google 站点有[很好的文档](http://support.google.com/sites/bin/answer.py?hl=en&answer=2500646)，您不能使用任何违反其[程序政策](http://support.google.com/docs/bin/answer.py?hl=en&answer=148505)的 JavaScript 。

请阅读文档，它列出了插入自定义 CSS、JavaScript 和一般 HTML 的步骤的详细信息。

# git - Git 章鱼与不相关的存储库合并

> ID：10874149
> 
> 赞同：23
> 
> 时间：2012-06-03T21:41:39.693
> 
> 标签：git, git-merge

我有一堆 git 存储库，每个都包含一个文件。我想将它们全部合并在一起，最好是一步完成。我的目标是这张图：

```
*----¬ mergedrepo/master
| \ \ \
| | | * repoA/master
| | * repoB/master
| | |
| | * repoB/...
| * repoC/master
* repoD/master
|
* repoD/... 
```

我试过了`git merge`，但似乎章鱼策略不适用于不相交的树

```
$ git merge a/master b/master c/master d/master
Unable to find common commit with a/master
Automatic merge failed; fix conflicts and then commit the result. 
```

我也被告知这`git merge --squash`会有所帮助，但这给出了同样的错误。

这会生成正确的图表，但会丢失所有文件：

```
$ git merge -s ours a/master b/master c/master d/master 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2015-07-02T14:02:35.157

我已经设法解决了不相关分支的章鱼合并问题。不幸的是，以下仅适用于不存在真正合并冲突的相当简单的情况。

1.  按照 OP 中的描述进行合并。

    `git merge --allow-unrelated-histories a/master b/master c/master d/master`

    它将“失败”声称冲突。但是已经执行了合并并记录了这一事实，尽管索引没有变化。

2.  `read-tree`使用以下命令将分支的内容添加到索引中：

    `git read-tree a/master b/master c/master d/master`

    这不会影响工作树，只会更新索引。（您可能希望将当前分支添加到末尾。您需要在一个命令中添加所有分支。）

    如果分支不是完全独立的，则调整它们的顺序，记住后者将覆盖前分支的内容。

3.  正常提交。( `git commit -m "octopus-merged remote 'a', 'b', 'c', 'd'"`)
4.  执行硬重置 ( `git reset --hard`) 以获得一致的工作树。

我想以后可以编辑和修改这个提交，但我个人没有尝试过。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T06:23:39.463

创建一个空提交

```
git commit -m "Common commit" --allow-empty 
```

查看它的哈希`log -1`并将其添加到没有任何父母的移植文件中

```
echo HASH_OF_COMMON_COMMIT >> .git/info/grafts 
```

然后找到所有其他根，`log --max-parents=0`并将它们的哈希添加到嫁接文件中，并将上述哈希作为父级

```
each HASH_OF_ROOT HASH_OF_COMMON_COMMIT >> .git/info/grafts 
```

现在，合并！

移植文件是一种更改提交的父级的方法，一旦您的所有存储库都有一个共同的提交，您的存储库应该接受合并。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-03-05T13:41:00.390

我有很多不相关的分支要从旧版 SVN 结构合并到新初始化的 Git 存储库中。[Vertigo](https://stackoverflow.com/users/393672/vertigo)的回答让我大部分时间到达那里，但`git read-tree`一次最多只能读取 8 棵树。

我的解决方案是在每次读取后编写一棵新树，然后在下一次读取时使用该新树：

```
tree_head=HEAD
to_merge="a/master ... z/master"

# If you're using a variable here you want word splitting, so don't use quotes.
git merge --allow-unrelated-histories $to_merge

for merging in $to_merge; do
    git read-tree "$tree_head" "$merging"
    tree_head=$(git write-tree)
done

git checkout-index -fua
git commit -m "All repos merged." 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-07-09T16:01:19.070

虽然它看起来更复杂，但我认为@akuhn 的解决方案是唯一真正按照 Git 预期的方式工作的解决方案。同样对我来说，其他解决方案仅在我合并一次不相关的分支时才有效。在我的用例中，我想对不相关分支的不同版本进行连续合并。其他解决方案不会引发错误，但文件状态会变得混乱。

`git replace`自从引入命令的 Git 1.6.5 以来，概述的解决方案实际上变得容易得多。不过这个想法还是一样的：你让 Git 认为你的提交有一个共同的提交来使合并工作。为此，您需要找出当前分支初始提交的 SHA-1：

```
common_commit=$(git rev-list --max-parents=0 HEAD) 
```

一旦你有了它，你告诉 git 你想要合并的每个分支都来自那个提交：

```
for branch in a/master b/master c/master d/master
do
  branch_initial_commit=$(git rev-list --max-parents=0 $branch)
  git replace --graft $branch_initial_commit $common_commit
done 
```

之后，您可以简单地运行合并命令。Git 不会抱怨，因为所有分支现在都源自同一个共同提交。

```
git merge a/master b/master c/master d/master 
```

# http - http请求分叉

> ID：10874152
> 
> 赞同：1
> 
> 时间：2012-06-03T21:42:15.137
> 
> 标签：http, reverse-proxy, staging

我有一个运行我的 web 服务的 http 服务器和一个运行我最新版本的登台服务器。我想通过“*复制*”所有请求来对我的登台环境进行性能测试，并将它们转发到我的测试服务器和生产服务器。测试服务器给出的响应应该被丢弃，另一个应该被传递到服务器。

我的第一种方法是搜索提供这种功能的 http 代理。但我只找到了[node-http-proxy](https://github.com/nodejitsu/node-http-proxy)。正如我在测试运行中发现的那样，它会泄漏内存。

还有其他解决方案吗？或者至少这项工作有更稳定的http代理吗？

谢谢，

马克尔

# html - CSS 全角水平滚动

> ID：10874153
> 
> 赞同：3
> 
> 时间：2012-06-03T21:42:35.050
> 
> 标签：html, css, scroll, width

我刚刚完成了以下[网站](http://dev.jzm.co.nz/)，但是当我加载它时，我似乎有多余的滚动。

您能否就我为什么以及如何解决此问题给我反馈。

我可以在这里发布代码，但大多数人在过去几天里遇到的以前的问题就像一个工作示例

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T22:04:23.923

因此，页脚中的 NAV 元素有一个负的右边距，这导致了水平溢出，进而导致出现滚动条。我猜，您的意图是将导航项进一步向右移动。

要摆脱滚动条，只需删除负边距，而是将 NAV 的宽度设置为适当的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T21:49:54.757

尝试将以下行添加到您的包装器中

```
overflow-x: hidden; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T21:50:57.370

尝试将此 css 属性添加到您的`<div id="wrapper">`元素：

```
overflow-x: hidden; 
```

检查此[链接](http://www.w3schools.com/cssref/css3_pr_overflow-x.asp)以获取 overflow-x 属性的官方文档。

你的 CSS 应该是这样的：

```
#wrapper {
     width: 100%;
     height: 100%;
     min-height: 100%;
     position: absolute;
     overflow-x: hidden;
} 
```

我已经在 Mac OS 上的 Safari（5.1.7 版）、Firefox（11.x）和 Google Chrome（19.x）中尝试过它，它就像一个魅力。

希望能帮助到你！

# php - 如何强制 SimpleXML 忽略 HTML 标签？

> ID：10874156
> 
> 赞同：3
> 
> 时间：2012-06-03T21:43:03.657
> 
> 标签：php, html, xml, parsing, simplexml

我尝试通过 SimpleXML 开始使用 xml 解析。而且我找不到如何做一件基本的事情：
我有一个包含 HTML 标记的 XML 文件，如下所示：

```
<root>
<title>some text</title>
<content>some <span>text</span></content>
</root> 
```

所以我只需要解析 xml 标签`root` `title` `content`，而忽略 .html 标签`span`。我也需要忽略诸如`&nbsp`.
我确信有一种简单的方法可以做到这一点。但找不到怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:59:20.653

尝试使用 CDATA 包围`content`标记的文本。

例如：

```
<root>
  <title>some text</title>
  <content><![CDATA[some <span>text</span>]]></content>
</root> 
```

所以这：

```
$xml = new SimpleXMLElement({the above XML});
echo htmlspecialchars($xml->content); 
```

会产生`some <span>text</span>`. 这也将允许使用诸如此类的东西`&amp;`。

# mysql - 从嵌套规则生成器生成 MySQL 查询

> ID：10874159
> 
> 赞同：4
> 
> 时间：2012-06-03T21:43:22.923
> 
> 标签：mysql, join

我已经构建了一个 UI 小部件，它允许我创建一组嵌套规则。例如，我可以指定以下规则：

```
Match ALL of these rules
  - Document Status == Open
  - Has Tag = 'sales'
  - Has Tag = 'question'
  - Match ANY of these rules
    - Has Tag = 'important'
    - Has Tag = 'high-priority'
    - Has Tag = 'critical-priority' 
```

在英语中，这将转化为这个查询：

```
Find Documents where status = Open AND has tag 'sales' AND has tag 'question' 
    AND has at least one of these tags: 'important', 'high-priority', 'critical-priority' 
```

表结构与此类似。

```
Documents {id, title, status}
Tags {document_id, tag_value} 
```

现在，此时我需要将这组规则转换为 SQL 查询。使用子查询可以很容易地完成，但出于性能原因，我宁愿避免使用它们。Documents 和 tags 表可能各自包含数百万条记录。

```
SELECT 
    d.id
FROM
    Documents d
WHERE
    d.status = 'open'
    AND EXISTS (SELECT * FROM Tags t WHERE t.doc_id = d.id AND t.value = 'sales') 
    AND EXISTS (SELECT * FROM Tags t WHERE t.doc_id = d.id AND t.value = 'question') 
    AND (
        EXISTS (SELECT * FROM Tags t WHERE t.doc_id = d.id AND t.value = 'important')
        OR EXISTS (SELECT * FROM Tags t WHERE t.doc_id = d.id AND t.value = 'high-priority')
        OR EXISTS (SELECT * FROM Tags t WHERE t.doc_id = d.id AND t.value = 'critical-priority')   
    ) 
```

如何重写此查询以使用更有效的联接？

我可以将前两个标记规则添加为 INNER 连接，但是如何处理规则集的后半部分？如果有进一步的规则要求存在标签才能显示文档怎么办？

请记住，可以将规则集设置为匹配其中的所有或任何规则，并且理论上它可以嵌套多次。

关于解决这个问题的一般方向的任何想法？

**更新：**

我已经优化了我的表，并找到了一种查询表的方法，看起来非常快（除了 COUNTing 匹配记录的数量，这是另一个问题）。我一次不会选择超过 100 个文档，并且文档集包含约 600k 和约 200 万个标签，此解决方案在约 0.02 秒内返回结果，这比以前好得多。

有问题的表...

```
CREATE TABLE `app_documents` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `account_id` int(11) NOT NULL,
  `status_id` int(11) DEFAULT NULL,
  `subject` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `created` datetime NOT NULL,
  `updated` datetime NOT NULL,
  PRIMARY KEY (`id`),
  KEY `IDX_B91B1DB99B6B5FBA` (`account_id`),
  KEY `IDX_B91B1DB96BF700BD` (`status_id`),
  KEY `created_idx` (`created`),
  KEY `updated_idx` (`updated`),
  CONSTRAINT `FK_B91B1DB96BF700BD` FOREIGN KEY (`status_id`) REFERENCES `app_statuses` (`id`),
  CONSTRAINT `FK_B91B1DB99B6B5FBA` FOREIGN KEY (`account_id`) REFERENCES `app_accounts` (`id`),
) ENGINE=InnoDB AUTO_INCREMENT=500001 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci

CREATE TABLE `app_tags` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `value` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY (`id`),
  KEY `value_idx` (`value`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci

CREATE TABLE `app_documents_tags` (
  `document_id` int(11) NOT NULL,
  `tag_id` int(11) NOT NULL,
  PRIMARY KEY (`document_id`,`tag_id`),
  KEY `IDX_A849587A700047D2` (`document_id`),
  KEY `IDX_A849587ABAD26311` (`tag_id`),
  CONSTRAINT `FK_A849587ABAD26311` FOREIGN KEY (`tag_id`) REFERENCES `app_tags` (`id`) ON DELETE CASCADE,
  CONSTRAINT `FK_A849587A700047D2` FOREIGN KEY (`document_id`) REFERENCES `app_documents` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci 
```

我正在测试的查询...

此查询查找同时具有“蓝色”和“绿色”标签但不具有“红色”标签的所有文档及其标签。

```
SELECT
    d.*
FROM 
    app_documents d
LEFT JOIN
    app_documents_tags dtg ON ttg.document_id = d.id
LEFT JOIN
    app_tags tg ON tg.id = dtg.tag_id
WHERE
    d.account_id = 1
    AND EXISTS (
        SELECT
            *
        FROM 
            app_tags t1 
        CROSS JOIN 
            app_tags t2
        CROSS JOIN
            app_tags t3
        INNER JOIN
            app_documents_tags dtg1 ON t1.id = ttg1.tag_id
        INNER JOIN
            app_documents_tags dtg2 ON dtg1.ticket_id = dtg2.ticket_id AND dtg2.tag_id = t2.id
        LEFT JOIN
            app_documents_tags dtg3 ON dtg2.ticket_id = dtg3.ticket_id AND dtg3.tag_id = t3.id
        WHERE
            t1.value = 'blue' AND t2.value = 'green' AND t3.value = 'red' AND dtg3.ticket_id IS NULL AND dtg2.document_id = t.id
    )
ORDER BY
    d.created
LIMIT 45 
```

我确信这可以使用更好的索引来改进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T23:29:03.820

论坛化问题中的查询如下：

*   收集具有销售和问题标签的文档 ID（子查询 AA）
*   收集具有标签之一的文档 ID（重要、高优先级、关键优先级）（子查询 BB）
*   合并 AA 和 BB 得到子查询 DocsWithValidTagRules
*   将 DocsWithValidTagRules 与 Documents 表连接以获得打开状态
*   执行你的分页

鉴于该描述，以下是结果查询：

```
SELECT Documents.id
FROM
(
    SELECT AA.document_id
    (
        SELECT B.document_id,COUNT(1) tagcount FROM
        (
            SELECT id FROM app_tags
            WHERE `value` IN ('sales','question')
        ) A
        INNER JOIN app_documents_tags B
        ON A.id = B.tag_id
        GROUP BY B.document_id
        HAVING COUNT(1) = 2
    ) AA
    INNER JOIN
    (
        SELECT B.document_id,COUNT(1) tagcount FROM
        (
            SELECT id FROM app_tags
            WHERE `value` IN ('important','high-priority','critical-priority')
        ) A
        INNER JOIN app_documents_tags B
        ON A.id = B.tag_id
        GROUP BY B.document_id
    ) BB
) DocsWithValidTagRules
INNER JOIN Documents
ON DocsWithValidTagRules.document_id = Documents.id
WHERE Documents.status = 'open'
LIMIT page_offset,page_size; 
```

确保您在文档上有此索引

```
ALTER TABLE Documents ADD INDEX status_id_index (status,id); 
```

试试看 ！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T00:53:02.353

它必须是纯sql解决方案吗？

您可以使用类似这样的方法缩小数据集，它有一个单一的连接，然后使用您检索数据时使用的任何语言来过滤较小的数据集并使用适当的逻辑。

```
SELECT 
    d.id,
    t.value
FROM
    Documents d 
    JOIN Tags t_required ON t.doc_id=d.id
WHERE
    d.status = 'open'
    and t.value IN ('sales', 'question', 'important', 'high-priority', 'critical-priority' ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:02:21.587

你考虑过 Lucene/Solr

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T20:10:26.440

这是我为这个问题所做的。除了上面的关系模型，我将创建另一个只有两列的表`"DocumentID"|"MetadataXML"`。当我创建/更新任何文档时，我将创建一个准确包含每个文档的所有元数据的 XML 文档（最好是 Schema 验证）。然后我将使用 XPATH 表达式来搜索文档。

它可能不会很快，甚至不会很快。但是这个想法最大的好处是，你的数据模型和索引和工作流程是稳定的。所有出现的复杂性都将被 XML 模式抽象出来。

此外，我将在此基础上实现 Lucene/Solr 以提供快速的基本搜索。

```
Fast basic full text search -> Lucene/Solr
Advanced Search -> XML/XPATH expression search
Federated Searches, Rest APIs etc -> SQL 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T22:17:02.060

它可能不会很快，甚至不会很快。但是这个想法最大的好处是，你的数据模型和索引和工作流程是稳定的。所有出现的复杂性都将被 XML 模式抽象出来。

此外，我将在此基础上实现 Lucene/Solr 以提供快速的基本搜索。

# php - Symfony2.0.15 Doctrine-Fixtures Windows 命令行致命错误

> ID：10874165
> 
> 赞同：1
> 
> 时间：2012-06-03T21:44:05.743
> 
> 标签：php, windows, symfony, doctrine-orm

最近开始玩S2，很棒的东西！前段时间开始了一个在线 Symfony2[博客教程](http://tutorial.symblog.co.uk/docs/doctrine-2-the-blog-model.html)，但是我卡在了 Doctrine Data Fixtures 生成页面上，

这是我`php app/console doctrine:fixtures:load`在控制台中执行时收到的消息：

> 致命错误：第 40 行 C:\xampp\htdocs\blog-sf2\vendor\bundles\Doctrine\Bundle\FixturesBundle\Command\LoadDataFixturesDoctrineCommand.php 中找不到类 'Doctrine\Bundle\DoctrineBundle\Command\DoctrineCommand'

我真的坚持它并且我正在运行**Windows 7**，所以不能真正使用 deps 文件从旧版本中提取依赖项（或者我可以以某种方式吗？？），

我已经下载了最新版本的 FixtureBundles 和 DoctrineFixtures。

非常感谢对此的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T21:48:58.847

我认为您需要阅读[2.0 分支的此捆绑包的安装文档](http://symfony.com/doc/current/bundles/DoctrineFixturesBundle/index.html) 您并没有真正“使用 deps”文件。bin/vendors 脚本使用它，并使用 git。所以你需要做的是“使用deps”安装git（顺便说一句，安装git-bash，你会得到一个更好的终端）。

# c# - 所有者绘制的组合

> ID：10874166
> 
> 赞同：1
> 
> 时间：2012-06-03T21:44:29.683
> 
> 标签：c#, winforms

我做了一个所有者绘制的组合框。这就是它在表格上的显示方式。在附件上，它是“确定”按钮旁边的组合框。请参阅附件。我需要将实线图像显示为第一个选择，而不是“实线文本”作为第一个选择。

![图片](../Images/092510799e83bdcfac01ce6c7fac00a8.png)

这是我的代码：

```
 public partial class comboBoxLineStyle : ComboBox
{
    public comboBoxLineStyle()
    {
        InitializeComponent();
        this.DrawMode = DrawMode.OwnerDrawFixed;

    }
    protected override void OnDrawItem(DrawItemEventArgs e)
    {
        base.OnDrawItem(e);

        if (e.Index < 0) { return; }
        e.DrawBackground();
        ComboBoxItem item = (ComboBoxItem)this.Items[e.Index];
       e.Graphics.DrawImage(item.Picture,new Point(e.Bounds.X, e.Bounds.Y));

    }
    public new Image SelectedItem
    {
        get
        {
            return (Image)base.SelectedItem;
        }
        set
        {
            base.SelectedItem = value;
        }
    }
    public new Image SelectedValue
    {
        get
        {
            return (Image)base.SelectedValue;
        }
        set
        {
            base.SelectedValue = value;
        }
    }

}

public class ComboBoxItem
{
    public string text;
    public Image Picture;
    public Color foreColor;
    public override string ToString()
    {
        return text;
    }

    public ComboBoxItem() { }
    public ComboBoxItem(string pText, Image pValue)
    {
        text = pText;
        Picture = pValue;
    }
    public ComboBoxItem(string pText, Image pValue, Color pColor)
    {
        text = pText; Picture = pValue; foreColor = pColor;
    }

} 
```

在 windows 窗体上：

```
 private void DlgGraphOptions_Load(object sender, EventArgs e)
    {
        ComboBoxItem item1Solid = new ComboBoxItem("Solid Line",Properties.Resources.Solidline);
        ComboBoxItem item1dash = new ComboBoxItem("Dashed Line", Properties.Resources.dashedline);
        ComboBoxItem item1dashed = new ComboBoxItem("Dashed Line", Properties.Resources.dashdash);

        comboBoxLineStyle1.Items.Add(item1Solid);
        comboBoxLineStyle1.Items.Add(item1dash);
        comboBoxLineStyle1.Items.Add(item1dashed);
        comboBoxLineStyle1.SelectedIndex = 0;

    } 
```

我有comboBoxLineStyle1.SelectedIndex = 0，这意味着它应该将“itemsolid1-solidline-image.”设置为选定值。

但相反，它显示“实线文本”

请建议 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:48:16.407

设置`ComboBoxStyle`为`DropDownList`。这将禁用在`ComboBox`. 我想那时将显示图片而不是文本。

# c# - System.IO 中没有“目录”或“文件”

> ID：10874167
> 
> 赞同：3
> 
> 时间：2012-06-03T21:44:34.597
> 
> 标签：c#, .net

我刚刚开始使用新的 VS2012 和 Windows 8 并创建 C# Metro 风格的项目。我想获取目录中的文件列表，但字符串“Directory.GetFiles(path)”调用一个错误，说它在当前上下文中不存在。但我使用 System.IO。我在 System.IO 中唯一有用的是“路径”——那里没有“目录”或“文件”。哪里有问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T21:46:26.930

Windows 8 Metro 风格应用程序不支持文件系统。

相反，请使用[新的 Metro API](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh758319%28v=win.10%29.aspx)。

# inheritance - JPA 单表继承 getType()

> ID：10874171
> 
> 赞同：0
> 
> 时间：2012-06-03T21:45:02.833
> 
> 标签：inheritance, jpa, eclipselink, single-table-inheritance

如何从父类中检索类型参数以确定正在引用哪个子类。我有一个`Person`带有鉴别器的简单表格示例，`Student, Teacher..`但我找不到该`type`列的吸气剂？数据库中是否存在但 api 中缺少。我可以通过其他任何方式获取我引用的 Person 对象的类型吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T21:57:21.430

在一个理想的世界里，你不应该关心被引用的人的类型，你应该只多态地访问它。

如果您绝对确定被引用的人不是代理，您可以简单地使用`instanceof`操作符。或者，您可以修改人员实体以提供鉴别器列的吸气剂。或者，您可以覆盖`getType()`所有子类中的方法，以便对象返回其类型。

# ios - 如何让子 MOC 看到父 MOC 的变化以及如何解决它们之间的冲突？

> ID：10874176
> 
> 赞同：2
> 
> 时间：2012-06-03T21:45:11.437
> 
> 标签：ios, core-data

似乎新的基于队列的 MOC 与 iOS 5 中引入的嵌套 MOC 一起作为一个更简单、更干净的并发模型，所以我现在很高兴使用它。但是有几件事我不清楚：

1.  子 MOC 会自动拉取父 MOC 的更改吗？还是我还需要手动协调它们？如果是后者，如何手动刷新子项以合并父项更改？（我知道事情是如何反过来的——当孩子保存时，父 MOC 会从子 MOC 获得更改。）
2.  如果 child 的变化和 parent 的变化之间存在冲突，保存 child MOC 会发生什么？是否`mergePolicy`还负责解决子 MOC 和父 MOC 之间的冲突？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T02:02:47.110

1.  是和否，取决于您对“自动拉动 parentMOC 更改”的定义。如果您的意思是，下一次孩子获取时，它将获得更新的数据，那么是的。如果您的意思是对象会自动更改，那么不会。原因是 MOC 是一个暂存器，不改变它就不会改变。

2.  是的，如果您要从多个位置更改相同的对象/关系，则必须解决合并冲突。这是一个复杂的问题，在 SO 答案中无法充分回答。你真的应该阅读核心数据编程指南，尤其是关于变更管理的部分。

**编辑**

> 1.  假设我在子 MOC 中持有对象 A，并在父 MOC 中添加关系 B 到 A。如果我访问 AB，我会得到什么？零？如果我想在儿童 MOC 中看到 AB，我该怎么办？使用 refreshObject:mergeChanges: 刷新 A，还是使用 objectWithID: 再次获取 A？有没有办法刷新整个孩子MOC？我在子 MOC 中有一个非常复杂的对象网络，我不想（或不能）一一刷新/重新获取每个对象。

通过子 MOC 查看对象 A 时，您将不会看到父 MOC 中的更改，直到您从子 MOC 重新获取。如果您想查看父项中的内容，可以通过 MOC 上的另一个 fetch 或通过任何方法从存储中获取特定对象来实现。但是，我必须强调您需要阅读有关每次提取的文档，因为它们可能有副作用。确切的答案取决于您选择哪种方法。

通常，如果您正在进行持续更改，您希望在子项中进行更改，并将它们推送给父项，或者处理 DidChange 通知以使更改看起来“自动”。

> 2.  mergePolicy 在这里工作吗？

是的。

同样，我可以在 SO 上给您的最佳答案是指向“核心数据编程指南”。请特别注意这两个部分：

[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFetching.html#//apple_ref/doc/uid/TP40002484-SW1](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFetching.html#//apple_ref/doc/uid/TP40002484-SW1)

[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdChangeManagement.html#//apple_ref/doc/uid/TP30001201-CJBDBHCB](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdChangeManagement.html#//apple_ref/doc/uid/TP30001201-CJBDBHCB)

# php - 为了创建类似于 Windows 窗体的界面，我需要使用哪些 Web 技术？

> ID：10874179
> 
> 赞同：0
> 
> 时间：2012-06-03T21:46:10.877
> 
> 标签：php, javascript, mysql, user-interface

我将在一个封闭的社区中开始一个基于网络的翻译项目；客人只能查看它（仅供他们阅读）。翻译将逐字逐句。每个单词的翻译都会显示在它下面。翻译将包含图标，以指示有关已翻译单词的来源和形态的信息。社区成员可以对翻译进行投票，他们还可以对任何翻译发表评论（评论将显示在页面底部）。

这是我正在尝试做的一个简单示例：

![桂示例](../Images/d0c1e906b3387c8826ad40e1e5accf83.png)

在此屏幕截图中，日语只是一个示例。翻译文本可以是任何语言；也许是法语、俄语、阿拉伯语或韩语。

本项目将使用 PHP、Javascript 和 MySQL。这些网络技术是否足以实现这个项目？文本的长度和字数不固定。我必须动态创建这个接口。这对我来说将是一个很大的挑战。
另外，我希望界面尽可能用户友好。例如，当用户投票或评论翻译时，它不应该刷新页面。

在这些情况下，我应该使用哪些网络技术？纯 PHP、Javascript 和 MySQL 的强大功能是否足以满足此要求？如果不是，我应该使用哪些其他技术/语言？我需要一些建议才能有一个好的开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T21:56:48.310

就服务器端而言，仅 PHP 和 MySQL 就足够了。它们都可以处理 UTF-8（因此也可以处理外来字符）以及该项目将创建的查询。

Javascript 是向翻译器添加交互性的最有效选择。但是要与服务器实时通信，您需要在其上添加 AJAX 或 jQuery（或类似技术）。

# java - 如何实现用我的 java 程序打开文件？

> ID：10874185
> 
> 赞同：5
> 
> 时间：2012-06-03T21:47:06.423
> 
> 标签：java, file, file-io, drag-and-drop

我有一个基本的、简单的、也许是愚蠢的问题，但是我如何实现可以将文件拖到我的 java 程序上并打开它？我为这个基本问题搜索了很久......

只要我发现您无法将其拖到 .jar 上，因为它不可执行。您必须创建一个 .exe，它也会打开您的 .jar，但仅此而已！我真的很想知道如何:)

如果我可以通过搜索这个关键字得到答案，一个关键字就足够了。

谢谢，利安德

//编辑：我可能表达的东西有点复杂。后来我想在桌面上有一个快捷方式，例如，我可以在快捷方式上拖动任何文件，并且程序打开文件（此时它将）只将它移动到一个特殊位置。

*我不知道这个代码是怎样的，我什至不知道如何用谷歌搜索这个（我只得到问题如何用答案 Desktop.open(File f) 实现“打开方式”）。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T22:26:44.543

仅适用于窗户：

**选项1：**

将批处理文件放入 jar 文件的目录中（或任何您喜欢但需要调整路径的地方，您也可以从批处理文件中创建快捷方式）。

```
@ECHO OFF
start java -jar %~dp0MYAPP.jar %1 
```

**选项2：**

*   制作快捷方式（右键-新建-快捷方式）
*   输入位置“java -jar C:\path\to\myapp.jar”

如果您的 jar 接受文件名作为参数，则拖放将起作用

```
public class Main {

    public static void main(String[] args) {
        if (args.length == 0)
            System.out.println("No arguments");
        else
            System.out.println("1st argument: " + args[0]);
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T21:49:55.410

开始阅读的地方是[有关拖放的 JDK 6 文档](http://docs.oracle.com/javase/6/docs/technotes/guides/dragndrop/index.html)。或者，您可以直接从[拖放教程](http://docs.oracle.com/javase/tutorial/uiswing/dnd/index.html)开始。

如果您想创建一个桌面图标，当您在其上放置文件时将打开您的应用程序，这取决于操作系统。我认为[Launch4j](http://launch4j.sourceforge.net/)会支持这一点，虽然我没有以这种方式使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T22:22:46.217

在窗口上，您可以创建 .bat 文件，如果您对该文件进行 DnD，您将获得文件名作为第一个参数

所以代码

```
echo %1
pause 
```

写出文件名，这样你就可以启动你的java程序了

```
java -jar myApp.jar MyAppClass %1 
```

# c++ - 当它不在调试器中运行时，我的窗口无法正确绘制

> ID：10874186
> 
> 赞同：0
> 
> 时间：2012-06-03T21:47:24.833
> 
> 标签：c++, visual-studio-2010, winapi

`F5`我有一个Win32程序（桌面应用程序`Ctrl + F5`），在调试（由 这怎么可能？我正在使用 VS 2010。

编辑：在 Release 构建中，代码可以在没有调试的情况下正常工作，但在调试器中却不行，这与 Debug 构建中发生的情况完全相反。

新编辑：

经过几个小时的研究，我发现问题与使用其 reset() 成员函数初始化静态 std::auto_ptr 对象有关。

记住我上面所说的，窗口标题不会显示在应用程序窗口上，并且这个标题是在 WM_CREATE 消息处理结束时使用 SetWindowText(hwnd, L"Any Title") 设置的。然后我开始在 WM_CREATE 中向后移动这个函数调用，以查看它未能显示窗口标题的确切位置。这发生在静态 std::auto_ptr 对象的第一次初始化之后，如下面的伪代码：

```
class A{};

LRESULT CALLBACK WndProc (HWND hwnd, UINT message, UINT wParam, LONG lParam)
{
    static std::auto_ptr<A> a;
    switch ( message )
    {
        case WM_CREATE:
        {
            ...
            a.reset(new A);
            SetWindowText(hwnd, L"Any Title");
            ...
        }
        break;

        case WM_PAINT:

        ...

        break;

        case WM_DESTROY:

        PostQuitMessage(0);
        break;

        default:

        return DefWindowProc(hwnd, message, wParam, lParam);
    }
    return 0;
} 
```

这意味着，如果我在变量初始化之前调用 SetWindowText() `a`，则窗口标题会正确显示，尽管当窗口被绘制时它不会在其客户区显示任何文本。我知道窗户正在涂漆，因为我插入了一个`MessageBeep(-1)`in `WM_PAINT`，我可以听到声音。

值得一提的是，WM_PAINT 中打印的所有内容都来自`class A`堆上分配的对象，其地址封装在`std::auto_ptr`对象中。

当然，这一切都是在使用`Ctrl + F5`. 当程序启动时`F5`一切正常。

新编辑：

我将`std::auto_ptr`变量更改`unique_ptr`为无济于事。问题还在继续。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T06:17:45.793

这可能是时间问题（可能是任何事情，但无法解释的行为往往是某种竞争条件）。在相关事件/覆盖上添加调试跟踪以查看发生了什么。

# java - 根上下文上的 JAX-RS 应用程序 - 怎么做？

> ID：10874188
> 
> 赞同：40
> 
> 时间：2012-06-03T21:47:40.220
> 
> 标签：java, jax-rs

我想让我的 JAX-RX 应用程序在根上下文中启动，这样我的 URL 将是

[http://example.com/restfullPath](http://example.com/restfullPath)

并不是

[http://example.com/rest/restfullPath](http://example.com/rest/restfullPath)

我从这里切换了我的应用程序的注释

```
@ApplicationPath("/rest/*") 
```

对此

```
@ApplicationPath("/*") 
```

但似乎它接管了诸如 /index.html 之类的服务文件

有没有办法在根应用程序上下文上运行 JAX-RS 但仍然提供静态页面？

好像[之前在JBOSS论坛上问过](https://community.jboss.org/thread/199069)这个问题，但解决方案不是很实用

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-05-25T06:57:58.250

它可能不是一个错误，而是 Servlet 规范的限制。如何处理 JAX-RS 的细节`@ApplicationPath`是特定于实现的，我不能代表所有实现，但我猜典型的方法是简单地将其用作 servlet URL 模式。以 Jersey 的 ServletContainerInitializer 实现为例，您会发现该[`addServletWithApplication()`方法](https://github.com/jersey/jersey/blob/8565bb138969cdcf7a74dd14f1d68ca5aaf91a06/containers/jersey-servlet/src/main/java/org/glassfish/jersey/servlet/init/JerseyServletContainerInitializer.java#L198)负责创建 servlet 和映射以处理请求，您可以看到它确实使用来自`@ApplicationPath`Jersey ServletContainer 的映射的路径小路。

不幸的是，自远古以来，Servlet 规范只允许少数几种将 servlet 映射到 URL 路径的方法。Servlet 3.0 的当前选项，[在规范的第 12.2 节中](http://download.oracle.com/otndocs/jcp/servlet-3.0-fr-eval-oth-JSpec/)给出——遗憾的是只能作为 PDF 提供，因此不能按部分链接——是：

*   `/.../*`其中初始`/...`是零个或多个路径元素
*   `*.<ext>``<ext>`匹配的扩展名在哪里
*   空字符串，仅映射到空路径/上下文根
*   `/`，单斜杠，表示上下文中的“默认”servlet，它处理与其他任何内容不匹配的任何内容
*   任何其他字符串，它被视为要匹配的文字值

规范的同一部分也对匹配规则的应用顺序有特定的规则，但简短的版本是这样的：为了让你的资源类在上下文根处响应请求，你必须使用`/`或`/*`作为路径。如果您使用`/`，那么您将替换容器的默认 servlet，它通常负责处理静态资源。如果您使用`/*`，那么您就太贪心了，并说它应该始终匹配所有内容，并且永远不会调用默认的 servlet。

因此，如果我们接受我们处于 servlet URL 模式的限制所决定的范围内，那么我们的选择就相当有限。以下是我能想到的：

1）使用`@ApplicationPath("/")`，并通过名称或扩展名将静态资源显式映射到容器的默认servlet（在Tomcat和Jetty中命名为“default”，不确定其他）。在 web.xml 中，它看起来像

```
<!-- All html files at any path -->
<servlet-mapping>   
    <servlet-name>default</servlet-name>
    <url-pattern>*.html</url-pattern>
</servlet-mapping>
<!-- Specifically index.html at the root -->
<servlet-mapping>   
    <servlet-name>default</servlet-name>
    <url-pattern>/index.html</url-pattern>
</servlet-mapping> 
```

或使用[ServletContextInitializer](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContainerInitializer.html)，例如

```
public class MyInitializer implements ServletContainerInitializer {
    public void onStartup(Set<Class<?>> c, ServletContext ctx) {
        ctx.getServletRegistration("default").addMapping("*.html");
        ctx.getServletRegistration("default").addMapping("/index.html");
    }
} 
```

由于匹配规则的编写方式，扩展模式胜过默认 servlet，因此您只需要为每个静态文件扩展添加一个映射，只要它们与可能出现的任何“扩展”之间没有重叠你的 API。这与您链接的论坛帖子中提到的不受欢迎的选项非常接近，我只是为了完整性而提到它并添加 ServletContextInitializer 部分。

2) 将您的 API 映射到`/rest/*`，并使用过滤器来识别对 API 的请求并将它们转发到该路径。这样，您就可以打破 servlet URL 模式框，并且可以以任何您想要的方式匹配 URL。例如，假设您的所有 REST 调用都指向以“/foo”开头或恰好是“/bar”的路径，并且所有其他请求都应该转到静态资源，那么类似于：

```
import javax.servlet.*;
import javax.servlet.annotation.WebFilter;
import javax.servlet.http.HttpServletRequest;
import java.io.IOException;
import java.util.regex.Pattern;

@WebFilter(urlPatterns = "/*")
public class PathingFilter implements Filter {
    Pattern[] restPatterns = new Pattern[] {
            Pattern.compile("/foo.*"),
            Pattern.compile("/bar"),
    };

    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
            FilterChain chain) throws IOException, ServletException {
        if (request instanceof HttpServletRequest) {
            String path = ((HttpServletRequest) request).getServletPath();
            for (Pattern pattern : restPatterns) {
                if (pattern.matcher(path).matches()) {
                    String newPath = "/rest/" + path;
                    request.getRequestDispatcher(newPath)
                        .forward(request, response);
                    return;
                }
            }
        }
        chain.doFilter(request, response);
    }

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {}

    @Override
    public void destroy() {}
} 
```

有了上述内容，您基本上可以将请求翻译如下：

```
http://example.org/foo          -> http://example.org/rest/foo
http://example.org/foox         -> http://example.org/rest/foox
http://example.org/foo/anything -> http://example.org/rest/foo/anything
http://example.org/bar          -> http://example.org/rest/bar
http://example.org/bart         -> http://example.org/bart
http://example.org/index.html   -> http://example.org/index.html 
```

3) 意识到前面的选项基本上是 URL 重写并使用现有的实现，例如[Apache 的 mod_rewrite](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)、[Tuckey 重写过滤器](http://tuckey.org/urlrewrite/)或[ocpsoft Rewrite](http://ocpsoft.org/rewrite/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-12T23:13:19.293

我找到了另一个涉及内部 Jersey 类的解决方案，我认为它可能还不是 JAX-RS 规范的一部分。（基于：[http](http://www.lucubratory.eu/simple-jerseyrest-and-jsp-based-web-application/) ://www.lucubratory.eu/simple-jerseyrest-and-jsp-based-web-application/ ）

**web.xml**

```
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
  <display-name>jersey-rest-jsp-frame-1</display-name>

  <filter>
    <filter-name>jersey</filter-name>
    <filter-class>
      com.sun.jersey.spi.container.servlet.ServletContainer
    </filter-class>
    <init-param>
      <param-name>
        com.sun.jersey.config.property.JSPTemplatesBasePath
      </param-name>
      <param-value>/WEB-INF/jsp</param-value>
    </init-param>
    <init-param>
      <param-name>
        com.sun.jersey.config.property.WebPageContentRegex
      </param-name>
      <param-value>
        (/(image|js|css)/?.*)|(/.*\.jsp)|(/WEB-INF/.*\.jsp)|
        (/WEB-INF/.*\.jspf)|(/.*\.html)|(/favicon\.ico)|
        (/robots\.txt)
      </param-value>
    </init-param>
  </filter>
  <filter-mapping>
    <filter-name>jersey</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>
</web-app> 
```

**WEB-INF/jsp/index.jsp**

```
<%@ page contentType="text/html; charset=UTF-8" language="java" %>

<html>
<body>
<h2>Hello ${it.foo}!</h2>
</body>
</html> 
```

**索引模型.java**

```
package example;

import com.sun.jersey.api.view.Viewable;

import javax.servlet.http.HttpServletRequest;
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.Context;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;
import java.net.URI;
import java.util.HashMap;

@Path("/")
@Produces(MediaType.TEXT_HTML)
public class IndexModel {

    @GET
    public Response root() {
      return Response.seeOther(URI.create("/index")).build();
    }

    @GET
    @Path("index")
    public Viewable index(@Context HttpServletRequest request) {
      HashMap<String, String> model = new HashMap<String, String>();
      model.put("foo","World");
      return new Viewable("/index.jsp", model);
    }
} 
```

这似乎可行，但我想知道它是否/将成为 JAX-RS 规范/实现的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-04T11:18:21.510

您可以尝试查找`DefaultServlet`您的 servlet 容器并手动为其添加 servlet-mapping`web.xml`以处理页面文件，例如 *.html、*.jsp 或任何其他文件。

例如，对于 Tomcat 5.5，它在此处进行了描述：http: [//tomcat.apache.org/tomcat-5.5-doc/default-servlet.html](http://tomcat.apache.org/tomcat-5.5-doc/default-servlet.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-26T22:02:00.670

从另一篇文章中引用 @damo for Jersey 2.0

“或者，您可以通过某种重定向来完成某些事情。例如，使用[预匹配过滤器](https://jersey.java.net/documentation/latest/user-guide.html#d0e6461)。我从未做过这样的事情，但文档建议“您甚至可以修改请求 URI”。 "

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-06T17:19:18.717

改为使用`@ApplicationPath("/")`（不带星号）。这将对您的情况有所帮助。

这是一个示例 REST Web 服务：

`1\. JaxRsActivator.java`

```
package com.stackoverflow;

import javax.ws.rs.ApplicationPath;
import javax.ws.rs.core.Application;

@ApplicationPath("/")
public class JaxRsActivator extends Application {
} 
```

`2\. HelloService.java`

```
package com.stackoverflow;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

@Path("/hello")
public class HelloService {
    @GET
    @Produces(MediaType.TEXT_HTML)
    public String hello() {
        return "hello";
    }
} 
```

我使用 Eclipse 将此动态 Web 项目导出到名为 as 的 WAR 文件中，`helloservice.war`并将其部署到在我的本地计算机上运行的 WildFly。它的网址：`http://localhost:8080/helloservice/hello`.

访问此链接时，它返回：

```
hello 
```

# php - 无法从 shell 运行的 php 连接到 mysql

> ID：10874194
> 
> 赞同：0
> 
> 时间：2012-06-03T21:49:23.907
> 
> 标签：php, mysql, shell, mamp

运行以下批处理文件时出现“连接被拒绝”错误：

```
#!/usr/bin/php
<?php
    mysql_connect('127.0.0.1', 'root', '*******');
?> 
```

其中*******是工作密码。

我也尝试过 localhost ，但我遇到了同样的问题。

我知道密码很好，因为我可以使用以下方式正常连接：

```
> /Applications/MAMP/Library/bin/mysql -u root -p 
```

当我从浏览器运行脚本时，我也可以连接（但我必须将 127.0.0.1 更改为 localhost）。

我在 Mac OS Lion 上使用 MAMP v1.8。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T21:55:48.247

尝试改用这条线

```
$sqlcon = mysql_connect("localhost", "root", "password") OR die("Could not connect to database: " . mysql_error()); 
```

它应该显示有关错误的更多信息，如果不检查以确保在 phpmyadmin（或 SQLbuddy）中用户可以访问数据库（应该是因为默认的“root”应该。还要确保 MAMP 设置为在线模式.

此外，您似乎错过了一个“；” 在第 2 行的末尾（带有连接的行）。另外，你有 )) 在它应该在的最后 ); 将其添加到行尾，它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T21:56:16.040

```
mysql_connect('127.0.0.1', 'root', 'password') OR DIE(mysql_error()); 
```

# javascript - 为什么主干不发送删除？

> ID：10874202
> 
> 赞同：3
> 
> 时间：2012-06-03T21:50:22.793
> 
> 标签：javascript, backbone.js

我有一个非常基本的主干（示例）应用程序，它只是创建和销毁模型项。创建模型时，对象会通过 POST 持久化到 Web 服务器，但是当模型被销毁时，没有 DELETE 发送到服务器？知道为什么会这样吗？

非常基本的模型：

```
window.User = Backbone.Model.extend({
  urlRoot: 'users'
}); 
```

我的测试代码只是为了创建和删除模型：

```
var model = null;

$(".add").click(function(){
  if (model == null) {
    model = new window.User;
    model.set({name: 'meeee'});
    model.save();
  }
});

$(".remove").click(function(){
  if (model != null) {
    model.destroy();
  }
}); 
```

创建模型时的 JSON 响应似乎也不错：

![在此处输入图像描述](../Images/b21f683a8d9e04ced597ae5c534e762e.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-03T22:35:23.393

Backbone 不知道 _id 是您用于 id 字段的名称，除非您以某种方式修改了 Backbone.js 的副本（请不要）。为了告诉 Backbone 你的 id 字段的名称对于某些特定的模型，你的模型定义中的[idAttribute](http://documentcloud.github.com/backbone/#Model-idAttribute)。否则，它默认为常规`id`.

如果没有设置“身份”字段，Backbone 将考虑模型实例“ [isNew](http://documentcloud.github.com/backbone/#Model-isNew) ”（尚未持久化到服务器的模型实例），因此当没有“身份”时（如您的情况，如相反，它不知道您的身份是`_id`) 没有必要在服务器上销毁它。

# c# - 如何在运行时添加 wcf 服务

> ID：10874203
> 
> 赞同：0
> 
> 时间：2012-06-03T21:50:27.923
> 
> 标签：c#, .net, wcf, visual-studio-2010

如何在运行时在我的 winform UI 中添加 wcf 服务。我创建了一个 wcf 服务，它返回托管机器的运行进程。我想在我的 winform 应用程序中添加托管机器服务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T00:55:21.253

您需要在运行时动态更改端点，因此您需要[WCF Discovery](http://msdn.microsoft.com/en-us/library/dd456782)。

**结构 ：**

```
WCF Consumer(s) <---> WCF Discovery Service <---> WCF Service(s) 
```

**执行 ：**

1.  [如何：实现发现代理](http://msdn.microsoft.com/en-us/library/dd456787)
2.  [如何：实现向发现代理注册的可发现服务](http://msdn.microsoft.com/en-us/library/dd456798)
3.  [如何：实现使用发现代理查找服务的客户端应用程序](http://msdn.microsoft.com/en-us/library/dd456785)

**拓扑：**

*   启动发现服务 [ 结构 BackBone ]
*   启动服务 [每个服务都将向发现服务**宣布**其启动]
*   启动客户端 [每个客户端都会从发现服务中**发现**（**查找**和**解决**）服务的端点]

**备注：**

*   发现过程使用**UDP**（检查您的防火墙，它可以阻止连接）
*   服务必须宣布它们的启动，因此**自托管**服务是可以的，但**IIS 托管**的 5/6 服务不是因为它们在第一次调用发生时自动启动！

解决 IIS 托管的 5/6 问题：

*   通过[使用 ServiceHostFactory 扩展托管](http://msdn.microsoft.com/en-us/library/aa702697)

这样您就可以手动启动 IIS-Hosted 5/6 服务而无需第一次调用

* * *

您还可以使用[WCF 路由服务](http://msdn.microsoft.com/en-us/library/ee517421.aspx)。

**兄弟提示：**
不要为无服务器（No-BackBone、No-BootleNeck、完全分布式等）理想拓扑走得太远，这会让你大吃一惊，让你发疯：D

对于初学者，我建议您阅读本教程 [ [WCF 教程](http://wcftutorial.net)]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T22:26:57.857

不知道你想在这里做什么。但是你需要知道两件事来调用 WCF 服务 1) 服务契约 2) 端点。现在没有逃避服务合同，因为您需要知道您可以使用的所有操作。但是，在 WCF 4 中，有一个称为 WCF 发现的新功能，它可以帮助您动态确定终点，即在运行时。请参阅以下链接[http://msdn.microsoft.com/en-us/library/dd456791.aspx](http://msdn.microsoft.com/en-us/library/dd456791.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T01:17:48.610

如果我正确理解您的问题，您需要一些代码来在运行时添加服务，而无需使用 *.config 文件和 *.svc 文件中的任何配置。

请参阅该示例：

```
 Uri baseAddress = new Uri("http://localhost:8080/hello");
    // Create the ServiceHost.
    using (ServiceHost host = new ServiceHost(typeof(HelloWorldService), baseAddress))
    {
        // Enable metadata publishing.
    ServiceMetadataBehavior smb = new ServiceMetadataBehavior();
    smb.HttpGetEnabled = true;
    smb.MetadataExporter.PolicyVersion = PolicyVersion.Policy15;
    host.Description.Behaviors.Add(smb);

    // Open the ServiceHost to start listening for messages. Since
    // no endpoints are explicitly configured, the runtime will create
    // one endpoint per base address for each service contract implemented
    // by the service.
    host.Open();

    Console.WriteLine("The service is ready at {0}", baseAddress);
    Console.WriteLine("Press <Enter> to stop the service.");
    Console.ReadLine();

    // Close the ServiceHost.
    host.Close();
} 
```

它在控制台应用程序中创建自托管服务。

[http://msdn.microsoft.com/en-us/library/ms731758.aspx](http://msdn.microsoft.com/en-us/library/ms731758.aspx)

那是你问的吗？

# jquery - 在 fadeIn() 之后使按钮可点击

> ID：10874204
> 
> 赞同：1
> 
> 时间：2012-06-03T21:50:40.670
> 
> 标签：jquery

我有一个功能，当您将鼠标悬停在具有“评论”类的 div 上时，它会淡入回复按钮。

我遇到的问题是使按钮在淡入时可点击。

```
$(".comment").hover(
        function() {
            $(this).children(".commentOptions").fadeIn();
            $(this).children("#reply").live('click',function(){
                alert('clicked'); 
            });
        },
        function() {
            $(this).children(".commentOptions").fadeOut();
        });

<div id="comment" class="comment">
      <div class="commentOptions">
          <div class="reply">
             <div class="button" id="reply">Reply</div>
          </div>
      </div>
</div> 
```

对此的任何帮助都会非常学徒，谢谢。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T21:53:25.887

根据您的标记，`#reply`它不是 的子元素`.comment`，因此为了解决它，`.comment`您必须使用类似`$("#reply", this)`或更简单的东西`$("#reply")`（因为 ID 应该是唯一的）。`click`而且，每次悬停元素时都不需要绑定事件，你可以做一次。这是一个例子：

```
$(".comment").hover(function() {
    $(this).children(".commentOptions").fadeIn();
}, function() {
    $(this).children(".commentOptions").fadeOut();
});

$("#comment").on("click", "#reply", function() {
    alert('clicked');
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T21:54:42.713

```
$(".comment").hover(
    function() {
        $(this).children(".commentOptions").fadeIn(1000, function(){
           $("#reply").on("click", replyClicked);
        });
    },
    function() {
        $(this).children(".commentOptions").fadeOut(1000, function(){
          $("#reply").off("click", replyClicked);
        });
});

function replyClicked(){
  alert("Clicked");
} 
```

[http://jsfiddle.net/S7rxh/](http://jsfiddle.net/S7rxh/)

# jsf - web.xml 文件的 jsf 和 url 模式

> ID：10874207
> 
> 赞同：0
> 
> 时间：2012-06-03T21:51:08.790
> 
> 标签：jsf

我正在使用 jsf 技术开发一个网络应用程序。我希望在显示我的应用程序主页时调用我的支持 bean 的方法。通常，当用户单击链接或按钮时，会涉及支持 bean 方法。

简而言之，我希望我的支持 bean 从数据库中获取一些数据并将其发送到 jsf 页面，并且我希望在用户调用我的应用程序的主页链接时发生这种情况。

以下是我想要解决问题的方法：使用在调用预期链接时执行的 servlet，并从该 servlet 调用支持 bean；但问题是我在使用 web.xml 文件中的 servlet 的 url 模式时遇到了一些困难。我的应用程序的主页链接是：home.jsf。我的 servlet 的名称是 HomeServlet，这是我在 web.xml 文件中配置它的方式：

```
 <servlet>
       <servlet-name>HomeServlet</servlet-name>
       <servlet-class>utils.HomeServlet</servlet-class>
       <load-on-startup>1</load-on-startup>
   </servlet>
   <servlet-mapping>
       <servlet-name>HomeServlet</servlet-name>
       <url-pattern>/home.jsf</url-pattern>
   </servlet-mapping> 
```

所以当我运行应用程序时，servlet 被执行，但我的 home.jsf 页面是空的（完全空白）。我不知道为什么。

所以我想知道的是：

*   我是否对这个问题使用了正确的方法？

*   如果是，我应该使用哪个 url 模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:13:57.717

不，这绝对不是正确的做法。您正在围绕 JSF 工作。您应该只在`@PostConstruct`请求的构造函数或方法或与视图关联的视图范围的 JSF 托管 bean 中完成这项工作。

例如

```
@ManagedBean
@RequestScoped
public class Home {

    public Home() {
        // Here.
    }

    @PostConstruct
    public void init() {
        // Or here. This will be invoked *after* any dependency injections,
        // such as @EJB, @ManagedProperty, @Inject, @Resource, etc.
    }

    // ...
} 
```

每当 JSF 第一次遇到(or ) 中的`#{home.someproperty}`引用时，就会构造 bean。`home.xhtml``home.jsp`

使用 JSF 进行开发时，您应该不需要开发其他 servlet。在 JSF 中，这`FacesServlet`是唯一的 servlet，它已经完成了所有必要的请求/响应和模型/视图控制工作。

# node.js - 全局安装 NPM 包时行为不一致

> ID：10874208
> 
> 赞同：6
> 
> 时间：2012-06-03T21:51:12.247
> 
> 标签：node.js, npm

我正在尝试在 Ubuntu (12.04) 上安装 NPM 包。我已经通过[Chris Lea 的 PPA 存储库](https://launchpad.net/~chris-lea/+archive/node.js)安装了 Node.js 和 NPM 。

我正在尝试将[Uptime 项目](https://github.com/fzaninotto/uptime)部署到我的服务器。我已经从 GitHub 克隆了应用程序，然后尝试以 root 用户身份安装应用程序依赖项：

```
root@dev:/web/my-application# npm install -g
npm http GET https://registry.npmjs.org/mongoose/2.5.11
npm http GET https://registry.npmjs.org/express/2.5.0
npm http GET https://registry.npmjs.org/ejs/0.6.1
npm http GET https://registry.npmjs.org/config/0.4.11
npm http GET https://registry.npmjs.org/async/0.1.18
npm http GET https://registry.npmjs.org/socket.io/0.9.2
npm http 304 https://registry.npmjs.org/ejs/0.6.1
npm http 304 https://registry.npmjs.org/async/0.1.18
npm http 304 https://registry.npmjs.org/mongoose/2.5.11
npm http 304 https://registry.npmjs.org/express/2.5.0
npm http 304 https://registry.npmjs.org/config/0.4.11
npm http 304 https://registry.npmjs.org/socket.io/0.9.2
npm http GET https://registry.npmjs.org/mime
npm http GET https://registry.npmjs.org/connect
npm http GET https://registry.npmjs.org/mkdirp/0.0.7
npm http GET https://registry.npmjs.org/qs
npm http GET https://registry.npmjs.org/policyfile/0.0.4
npm http GET https://registry.npmjs.org/redis/0.6.7
npm http GET https://registry.npmjs.org/socket.io-client/0.9.2
npm http GET https://registry.npmjs.org/yaml
npm http GET https://registry.npmjs.org/vows
npm http GET https://registry.npmjs.org/coffee-script
npm http GET https://registry.npmjs.org/hooks/0.2.0
npm http GET https://registry.npmjs.org/mongodb/0.9.9-5
npm http 304 https://registry.npmjs.org/mime
npm http 304 https://registry.npmjs.org/connect
npm http 304 https://registry.npmjs.org/mkdirp/0.0.7
npm http 304 https://registry.npmjs.org/qs
npm http 304 https://registry.npmjs.org/policyfile/0.0.4
npm http 304 https://registry.npmjs.org/redis/0.6.7
npm http 304 https://registry.npmjs.org/socket.io-client/0.9.2
npm http 304 https://registry.npmjs.org/vows
npm http 304 https://registry.npmjs.org/yaml
npm http 304 https://registry.npmjs.org/coffee-script
npm http 304 https://registry.npmjs.org/hooks/0.2.0
npm http 304 https://registry.npmjs.org/mongodb/0.9.9-5
npm http GET https://registry.npmjs.org/eyes

> mongodb@0.9.9-5 install /usr/lib/node_modules/node-uptime/node_modules/mongoose/node_modules/mongodb
> node install.js

npm http 304 https://registry.npmjs.org/eyes
================================================================================
=                                                                              =
=  To install with C++ bson parser do <npm install mongodb --mongodb:native>   =
=                                                                              =
================================================================================
npm http GET https://registry.npmjs.org/uglify-js/1.2.5
npm http GET https://registry.npmjs.org/ws
npm http GET https://registry.npmjs.org/xmlhttprequest/1.2.2
npm http GET https://registry.npmjs.org/active-x-obfuscator/0.0.1
npm http 304 https://registry.npmjs.org/active-x-obfuscator/0.0.1
npm http 304 https://registry.npmjs.org/uglify-js/1.2.5
npm http 304 https://registry.npmjs.org/xmlhttprequest/1.2.2
npm http 304 https://registry.npmjs.org/ws
npm http GET https://registry.npmjs.org/zeparser/0.0.5
npm http GET https://registry.npmjs.org/commander
npm http GET https://registry.npmjs.org/options
npm http 304 https://registry.npmjs.org/zeparser/0.0.5
npm http 304 https://registry.npmjs.org/options
npm http 304 https://registry.npmjs.org/commander

> ws@0.4.16 install /usr/lib/node_modules/node-uptime/node_modules/socket.io/node_modules/socket.io-client/node_modules/ws
> node install.js

================================================================================
=                                                                              =
=  To install WS with blazing fast native extensions, use                      =
=       <npm install ws --ws:native>                                           =
=                                                                              =
================================================================================
node-uptime@1.2.0 /usr/lib/node_modules/node-uptime
├── async@0.1.18
├── ejs@0.6.1
├── express@2.5.0 (mkdirp@0.0.7, mime@1.2.5, qs@0.5.0, connect@1.7.3)
├── mongoose@2.5.11 (hooks@0.2.0, mongodb@0.9.9-5)
├── config@0.4.11 (yaml@0.2.3, coffee-script@1.3.3, vows@0.5.13)
└── socket.io@0.9.2 (policyfile@0.0.4, redis@0.6.7, socket.io-client@0.9.2) 
```

一切看起来都不错，这些软件包似乎已成功安装。但是，当我检查是否满足 NPM 包依赖项时，我会列出一堆未满足的依赖项，就像我一秒钟前甚至没有安装它们一样：

```
root@dev:/web/my-application# npm list
npm WARN mongoose 2.5.11 Unmet dependency in /web/my-application
npm WARN active-x-obfuscator 0.0.1 Unmet dependency in /web/my-application/node_modules/socket.io/node_modules/socket.io-client
npm WARN uglify-js 1.2.5 Unmet dependency in /web/my-application/node_modules/socket.io/node_modules/socket.io-client
npm WARN ws 0.4.x Unmet dependency in /web/my-application/node_modules/socket.io/node_modules/socket.io-client
npm WARN xmlhttprequest 1.2.2 Unmet dependency in /web/my-application/node_modules/socket.io/node_modules/socket.io-client
node-uptime@1.2.0 /web/my-application
├── async@0.1.18 
├─┬ config@0.4.11 
│ ├── coffee-script@1.3.3 
│ ├─┬ vows@0.5.13 
│ │ └── eyes@0.1.7 
│ └── yaml@0.2.3 
├── ejs@0.6.1 
├─┬ express@2.5.0 
│ ├── connect@1.7.3 
│ ├── mime@1.2.5 
│ ├── mkdirp@0.0.7 
│ └── qs@0.5.0 
├── UNMET DEPENDENCY mongoose 2.5.11
└─┬ socket.io@0.9.2 
  ├── policyfile@0.0.4 
  ├── redis@0.6.7 
  └─┬ socket.io-client@0.9.2 
    ├── UNMET DEPENDENCY active-x-obfuscator 0.0.1
    ├── UNMET DEPENDENCY uglify-js 1.2.5
    ├── UNMET DEPENDENCY ws 0.4.x
    └── UNMET DEPENDENCY xmlhttprequest 1.2.2 
```

据我所知（但如果我错了，请纠正我）NPM 在`NODE_PATH`全局安装包时尊重环境变量。有趣的是，如果您查看上面的包安装输出，您可以看到 NPM 将依赖包全局安装到`/usr/lib/node_modules`. 如果我仔细检查`NODE_PATH`环境变量，事实证明该`NODE_PATH`变量的设置不同：

```
root@dev:/web/my-application# echo $NODE_PATH
/usr/lib/nodejs:/usr/share/javascript 
```

需要澄清的一件事：我不知道`NODE_PATH`变量是如何设置的，我自己没有设置它，当我安装 Node 和 NPM 时，我感觉它是随 Ubuntu 包一起提供的。

然后我决定显式设置`NODE_PATH`变量并仔细检查依赖项：

```
root@dev:/web/my-application# export NODE_PATH=/usr/lib/node_modules
root@dev:/web/my-application# npm list
npm WARN mongoose 2.5.11 Unmet dependency in /web/my-application
npm WARN active-x-obfuscator 0.0.1 Unmet dependency in /web/my-application/node_modules/socket.io/node_modules/socket.io-client
npm WARN uglify-js 1.2.5 Unmet dependency in /web/my-application/node_modules/socket.io/node_modules/socket.io-client
npm WARN ws 0.4.x Unmet dependency in /web/my-application/node_modules/socket.io/node_modules/socket.io-client
npm WARN xmlhttprequest 1.2.2 Unmet dependency in /web/my-application/node_modules/socket.io/node_modules/socket.io-client
node-uptime@1.2.0 /web/my-application
├── async@0.1.18 
├─┬ config@0.4.11 
│ ├── coffee-script@1.3.3 
│ ├─┬ vows@0.5.13 
│ │ └── eyes@0.1.7 
│ └── yaml@0.2.3 
├── ejs@0.6.1 
├─┬ express@2.5.0 
│ ├── connect@1.7.3 
│ ├── mime@1.2.5 
│ ├── mkdirp@0.0.7 
│ └── qs@0.5.0 
├── UNMET DEPENDENCY mongoose 2.5.11
└─┬ socket.io@0.9.2 
  ├── policyfile@0.0.4 
  ├── redis@0.6.7 
  └─┬ socket.io-client@0.9.2 
    ├── UNMET DEPENDENCY active-x-obfuscator 0.0.1
    ├── UNMET DEPENDENCY uglify-js 1.2.5
    ├── UNMET DEPENDENCY ws 0.4.x
    └── UNMET DEPENDENCY xmlhttprequest 1.2.2 
```

仍然没有成功，但是当我尝试使用节点运行应用程序时，它成功初始化并运行：

```
root@dev:/web/my-application# node app.js 
Monitor origin started
   info  - socket.io started
Express server listening on port 8082 in development mode
Mongoose: pings.ensureIndex({ timestamp: -1 }) {}  
Mongoose: checkevents.ensureIndex({ timestamp: -1, check: 1 }) {}  
Mongoose: checkhourlystats.ensureIndex({ timestamp: -1, check: 1 }) { unique: true }  
Mongoose: checkdailystats.ensureIndex({ timestamp: -1, check: 1 }) { unique: true }  
Mongoose: checkmonthlystats.ensureIndex({ timestamp: -1, check: 1 }) { unique: true }  
Mongoose: checks.find({ '$where': 'function () {\n if (this.isPaused) return false;\n if (!this.firstTested) return true;\n var delay = (this.lastTested.getTime() - this.firstTested.getTime()) % this.interval;\n return (Date.now() - this.lastTested.getTime() + delay) >= (this.interval || 60000);\n}' }) { fields: { qos: 0 }, safe: true }  
Mongoose: taghourlystats.ensureIndex({ timestamp: -1, name: 1 }) { unique: true }  
Mongoose: tagdailystats.ensureIndex({ timestamp: -1, name: 1 }) { unique: true }  
Mongoose: tagmonthlystats.ensureIndex({ timestamp: -1, name: 1 }) { unique: true }  
Mongoose: tags.ensureIndex({ name: 1 }) { unique: true } 
```

这看起来从现在开始就可以了，但是我绝对不会以 root 身份运行应用程序，所以当我以专用用户身份运行应用程序时，我需要识别全局 NPM 包。

我感觉 NPM 在安装包时有某种不一致的行为。全局安装时，它运行成功，但之后无法检索它们。

我能做什么，以及**一个人的`NODE_PATH`环境变量是什么样**的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T08:15:36.650

你必须安装它只是`npm install -d`，没有`-g`。包的要求对于每个包都是本地的（所以`node_modules\a`当你依赖时你有`a`，`node_modules\a\node_modules\b`当`a`依赖时你有`b`）。

有关更多详细信息，请参阅[http://npmjs.org/doc/faq.html#I-installed-something-globally-but-I-can-t-require-it](http://npmjs.org/doc/faq.html#I-installed-something-globally-but-I-can-t-require-it)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-25T23:19:07.240

清除缓存对我有用

```
npm cache clean 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-08-30T15:14:33.653

对我来说，它是通过使用以下命令解决的 -

npm install -d kanso@0.3.4 --registry [http://registry.npmjs.org/](http://registry.npmjs.org/)

# c - 在嵌套结构中查找相对偏移

> ID：10874211
> 
> 赞同：10
> 
> 时间：2012-06-03T21:51:58.070
> 
> 标签：c

因此，`offsetof(struct, field)`返回普通结构中字段的相对偏移量。但是有没有办法获得嵌套结构内字段的相对偏移量。

例如

```
struct my_struct {
   int a;
   struct {
      int b;
      int c;
   } anonymous_struct;
} 
```

有没有办法获得（在运行时）的偏移量`b`和`c`相对于`my_struct`（在运行时）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-03T21:55:02.197

是的，您仍然可以使用`offsetof`.

例如

```
size_t boff = offsetof(struct my_struct, anonymous_struct.b); 
```

的要求`offsetof`是*type*和*member-designator*必须是给定的`static`*type*`t;`，`&(t.`*member-designator*`)`评估为地址常量。*member-designator*不必是一个简单的标识符。

# node.js - 猫鼬 find().all()

> ID：10874212
> 
> 赞同：0
> 
> 时间：2012-06-03T21:52:04.110
> 
> 标签：node.js, mongoose

Windows 7 x64，node.js，来自 npm 的猫鼬。

```
var sys = require('util');
var mongoose = require('mongoose');
mongoose.connect('mongodb://localhost:28960/test_mongoose');
var Schema = mongoose.Schema;

//Model

var UserSchema = new Schema({

    username    : String,
    uid         : String,
    messaged_on : Date
});

mongoose.model('User', UserSchema);
var User = mongoose.model('User');

// create a new user

var user = new User({

    uid         : '54321',
    username    : 'Bob',
    messaged_on : Date.now()
});

user.save( function (err) {

    if (err)
        return;
    console.log('Saved');

    User.find().all(function(user) {
        console.log('beep');
    });
}); 
```

接受与 mongod 的连接，创建数据库“test_mongoose”。

控制台打印“已保存”，但没有“哔”。我是猫鼬的新手，但是，什么是问题？为什么 User.find().add() 不回调函数（用户）？对不起，我的英语不好。

也许是正常的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T01:37:38.807

你应该打电话`User.find(...`而不是`User.find().all(...`. 该`all`方法调用[`$all`](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24all)仅在匹配数组时使用的运算符。

# c++ - 在 C++ 中使用 char *s 和 strcmp 函数

> ID：10874213
> 
> 赞同：0
> 
> 时间：2012-06-03T21:52:05.357
> 
> 标签：c++

我有两个 char* 引用，我试图找出哪个更少。我的代码是：

```
bool stringComparison::lessThan(char *s1, char* s2) {
  int result = strcmp(*s1,*s2);
  return result < 0;
}; 
```

结果是不会产生小于 0 的结果。我如何需要更改“int result”行才能使其工作？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T21:55:41.253

strcmp 用于比较字符串；*s1​​ 和 *s2 是字符。您应该使用 s1 和 s2 调用 strcmp （没有星号）。

**编辑：**

这是[strcmp的参考](http://linux.die.net/man/3/strcmp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T22:10:07.350

`s1`并且`s2`是字符串。所以你的代码

```
int result = strcmp(*s1,*s2); 
```

应该读

```
int result = strcmp(s1,s2); 
```

请参阅 的在线参考`strcmp`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T22:36:26.237

你有更多的问题，或者不同的问题，比你告诉我们的要多。

在您向我们展示的代码中，`s1`和`s2`参数的类型为`char*`。该`strcmp()`函数需要类型的参数`char*`（实际上是`const char*`）。

如果您调用`strcmp(*s1,*s2)`，则尝试`strcmp`使用两个类型的参数进行调用`char`。正如您所描述的那样，这不会给您不正确的结果；它不会编译。至少，您的编译器应该抱怨类型不匹配。

如果您没有声明函数的标头`#include`for`<string.h>`或，则编译器可能无法识别不匹配 - 但在 C++ 中调用未声明的函数是无效的。`<cstring>``strcmp`

确实，正如其他两个答案所说，您应该打电话`strcmp(s1, s2)`而不是打电话`strcmp(*s1, *s2)`- 但这并不能解释您所描述的症状。更正调用`strcmp()`本身并不能解决您遇到的所有问题。

我能想到几个可能的解释：

1.  您使用的是旧编译器，它不会抱怨对未声明函数的调用。获取更新的编译器，或使用使其更符合语言标准的选项调用编译器。

2.  您的编译器正在产生警告（诊断不一定是致命的）并且您忽略了它们。不要忽视警告。

3.  出于某种原因，您决定添加自己的`strcmp()`函数声明，可能类似于`int strcmp(char s1, char s2);`. 不要那样做。如果您需要标准函数的声明，请`#include`为相应的标头添加指令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T22:47:06.057

我可以建议您的功能的（可能）改进版本吗？这修复了对 的调用`strcmp`，删除了不需要的`result`变量，并增加了 const 正确性。

```
bool stringComparison::lessThan(const char *s1, const char *s2)
{
    return strcmp(s1, s2) < 0;
} 
```

如果`stringComparison`是一个类，我会`const`在函数定义的末尾添加另一个类。

# c++ - 在 C++ OpenMP 代码中测量执行时间

> ID：10874214
> 
> 赞同：35
> 
> 时间：2012-06-03T21:52:09.943
> 
> 标签：c++, time, parallel-processing, openmp

我正在运行 .cpp 代码 (i) 以顺序样式和 (ii) 使用 OpenMP 语句。我正在尝试查看时差。为了计算时间，我使用这个：

```
#include <time.h>
.....
main()
{

  clock_t start, finish;
  start = clock();
  .
  .
  .
  finish = clock();

  processing time = (double(finish-start)/CLOCKS_PER_SEC);

 } 
```

时间在代码的顺序（以上）运行中非常准确。运行它大约需要 8 秒。当我在代码中插入 OpenMP 语句并计算时间时，我会减少时间，但在控制台上显示的时间约为 8-9 秒，而实际上它只是实时的 3-4 秒！

这是我的代码的抽象外观：

```
#include <time.h>
.....
main()
{

  clock_t start, finish;
  start = clock();
  .
  .
  #pragma omp parallel for
  for( ... )
     for( ... )
       for (...)
    {           
      ...;      
    }
  .
  .
  finish = clock();

  processing time = (double(finish-start)/CLOCKS_PER_SEC);

 } 
```

当我运行上面的代码时，我得到了时间的减少，但显示的时间在实时方面并不准确。在我看来，clock () 函数似乎正在计算每个线程的单独时间并将它们加起来并显示它们。

有人可以告诉我这样做的原因或建议我使用任何其他计时功能来测量 OpenMP 程序中的时间吗？

谢谢。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-06-03T22:20:23.217

> 在我看来，clock () 函数似乎正在计算每个线程的单独时间并将它们加起来并显示它们。

这*正是*它所做`clock()`的——它测量进程使用的 CPU 时间，至少在 Linux 和 Mac OS X 上，这意味着自启动以来进程中曾经存在的所有线程的累积 CPU 时间。

OpenMP 应用程序的实时时钟（又名挂钟）计时应使用高分辨率 OpenMP 计时器调用来完成，该调用`omp_get_wtime()`返回`double`自过去任意点以来的秒数值。它是一个可移植的功能，例如存在于 Unix 和 Windows OpenMP 运行时中，与`gettimeofday()`仅 Unix 不同。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-06-03T22:21:30.233

我见过 clock() 报告 CPU 时间，而不是实时。

你可以使用

```
struct timeval start, end;
gettimeofday(&start, NULL);

// benchmark code

gettimeofday(&end, NULL);

delta = ((end.tv_sec  - start.tv_sec) * 1000000u + 
         end.tv_usec - start.tv_usec) / 1.e6; 
```

改为计时

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2020-08-27T17:32:05.410

您可以使用 omp 库本身中的内置`omp_get_wtime`函数。以下是找出执行时间的示例代码片段。

```
#include <stdio.h>
#include <omp.h>

int main(){

    double itime, ftime, exec_time;
    itime = omp_get_wtime();

    // Required code for which execution time needs to be computed

    ftime = omp_get_wtime();
    exec_time = ftime - itime;
    printf("\n\nTime taken is %f", exec_time);

} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-03T22:20:13.013

嗯，是的，这`clock()`就是应该做的，告诉你程序使用了多少处理器时间。

如果要查找经过的实时时间，而不是 CPU 时间，请使用返回挂钟时间的函数，例如`gettimeofday()`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-12-09T14:06:18.077

```
#include "ctime"

std::time_t start, end;
long delta = 0;
start = std::time(NULL);

// do your code here

end = std::time(NULL);
delta = end - start;

// output delta 
```

# mysql - Django unique_together 不工作

> ID：10874222
> 
> 赞同：0
> 
> 时间：2012-06-03T21:53:07.977
> 
> 标签：mysql, django

我无法让 Django (1.5)`UNIQUE`在 3 列上创建 MySQL 索引，即使我已经遵循了我在 SO 上找到的每一个建议。这是我的模型的样子：

```
class Loc(models.Model):
    rand = models.IntegerField()
    sectiune = models.ForeignKey(Sectiune)
    numar = models.IntegerField()
    pret = models.FloatField()

    def __unicode__(self):
        return str(self.sectiune.nume) + ': R' + str(self.rand) + ' L' +     str(self.numar)

    class Meta:
        unique_together = (("rand","sectiune","numar"),) 
```

我真的不明白怎么了。我看到了一个`unique_together`不适用于外键的错误报告，但我也看到它已得到修复。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:49:48.560

原来 Django 毕竟不是那么聪明......它不知道如何`ALTER`创建一个表来创建`UNIQUE`约束。我只需要删除表，`syncdb`再次运行，约束就在那里:)

# wpf - 如何在 WPF 中对一个特定的 3d 对象执行命中测试？

> ID：10874224
> 
> 赞同：1
> 
> 时间：2012-06-03T21:53:11.497
> 
> 标签：wpf, 3d, hittest, visualtreehelper

我的 WPF 3D 场景中有一个 SphereMesh（从 MeshGeneratorBase 继承，作为 Petzold.Media3D.dll 的一部分）。我在那个球体上也有数千个 ScreenSpaceLines3D 对象。我想忽略场景中除 SphereMesh 之外的所有内容，并仅找出鼠标光线与球体相交的 XYZ 坐标。即使球体和鼠标之间还有另一个物体 X，我仍然想知道鼠标会在哪里撞击球体，就好像物体 X 不存在一样。

我已经使用 HitTest 尝试了下面的代码，但是当我在我的场景/世界中添加数千/数百万个其他对象时，它变得非常慢。对象阻塞问题是我无法解决的另一个问题。

你有什么建议吗？

当前代码：

```
Point mousePos = new Point(x, y);
PointHitTestParameters hitParams = new PointHitTestParameters(mousePos);
VisualTreeHelper.HitTest(
    viewPort,null,
    delegate(HitTestResult hr)
    {
        RayMeshGeometry3DHitTestResult rayHit = hr as RayMeshGeometry3DHitTestResult;
    if(rayHit != null)
    {
        // Mouse hits something
        Console.WriteLine("Point: " + rayHit.PointHit);
    }
    return HitTestResultBehavior.Continue;
}, hitParams); 
```

有什么帮助吗？

谢谢。

# objective-c - 接口被声明了两次？- 目标-C

> ID：10874227
> 
> 赞同：4
> 
> 时间：2012-06-03T21:53:35.683
> 
> 标签：objective-c, c, interface, objective-c-category

我是 Objective-C 的新手，并且正在查看许多示例来了解它。我遇到了这段代码：

```
@interface ImagePickerHelper : NSObject <UIImagePickerControllerDelegate, UIPopoverControllerDelegate, UINavigationControllerDelegate>
  //Blah Blah
@end

@interface ImagePickerHelper ()
  //Blah Blah
@end 
```

在谷歌搜索时，我知道他们在接口名称之后指定了超类和委托（顺便说一下，我知道 zilch）。

但是为什么接口在这里声明了两次呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:02:22.873

不，它没有被声明两次，它是一个 Class 接口（一个匿名类别），它被创建用于保存您希望在您的类中保持私有的方法，用于您不希望其他类看到或看到的方法与。。。相互作用 ..

人们经常用一个名称（通常是“private”）来声明一个标准类别来保存私有方法，但是 **使用匿名类别而不是命名类别的主要优点是，如果您不实现在匿名中声明的方法，编译器会报错类别。**

我注意到它是从 XCode 4.3 开始默认创建的。

*将方法放入此扩展类中就像在 Java 或 C++ 中声明私有方法...*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T21:57:18.060

您看到的第二个“@interface”（可能在 .m 文件中）是一个类扩展，可能意味着私有方法（好吧，私有的意思是编译器将生成“可能不响应”警告）。

# ajax - 将 Google Chart 放入 Jquery Dialog 窗口（使用 AJAX）

> ID：10874230
> 
> 赞同：2
> 
> 时间：2012-06-03T21:54:26.097
> 
> 标签：ajax, jquery-ui-dialog, visualization, google-visualization

我有一个页面；让我们称它为 somepage.phtml，原始 PHP 值以 json 编码并作为值添加到 drawVisualization 函数（数据在那里，很好），该函数也在此页面上初始化。

然后这应该包含图表。

```
<div  id="visualization" style="width: 500px; height: 400px; display:block"></div> 
```

然后我有中央 javascript 文件，其中包含使用 Jquery 编写的应用程序的函数。对于 Jquery、gVis，所有必需的脚本都已初始化。api。一切。

我想单击主页上的某个链接，并使 Jquery 对话框出现，其中包含从页面 somepage.phtml 加载的 Google 图表。

我试图加载图像、文本、其他 javascript、php vaules，一切正常，但不是这个图。

我在 Jquery 中的功能是这样的：

```
$('#shop-offers td.offer-graph a').click(function() {       
    var url = $(this).attr("href");     
    $.get(url, function(data) {
         $('<div></div>').html(data).dialog({
            modal: true,                
            minHeight: 350,
            minWidth: 550                       
                });
        });
    return false;
}); 
```

第一次单击后，没有触发对话框，没有任何反应。

第二次点击后，加载空白页面，不断从谷歌获取数据。

我也用谷歌操场上的图表尝试了这个，效果相同 - 没用。

对于示例图表，此时 Firebug 在脚本中输出：

```
function drawVisualization() {
var data = google.visualization.arrayToDataTable([["Name", "Height", "Smokes"],["Tong  Ning mu", 174, true], ["Huang Ang fa", 523, false], ["Teng nu", 86, true]]);
(new Google.visualization.ImageLineChart(document.getElementById("visualization"))).draw(data, null);
}

function drawVisualization() {
var data = google.visualization.arrayToDataTable([["Name", "Height", "Smokes"], ["Tong Ning mu", 174, true], ["Huang Ang fa", 523, false], ["Teng nu", 86, true]]);
(new google.visualization.ImageLineChart(document.getElementById("visualization"))).draw(data, null);
}

google.setOnLoadCallback(drawVisualization); 
```

# ext4 - “cp：无法创建...没有剩余空间”——ext4 inode 和组

> ID：10874234
> 
> 赞同：0
> 
> 时间：2012-06-03T21:55:02.433
> 
> 标签：ext4

*   cp 在单个目录中的 11,328,692 KB / 802,322 个文件处失败

*   在这个目录之外创建仍然是可能的，因为只有 2% 的驱动器的 inode 被用完了

**如何正确格式化驱动器以在单个目录中存储多达 2000 万个 ~15kb 文件？我很难理解 inode/groups**

源文件系统最初是通过较旧的内核创建的：

```
Block size:               4096
Blocks per group:         32768
Fragments per group:      32768
Inodes per group:         8192
Inode blocks per group:   512 
```

dest 文件系统是使用“-b 1024”作为 Ubuntu 12.04 上 ext4 的唯一标志创建的：

```
Block size:               1024
Blocks per group:         8192
Fragments per group:      8192
Inodes per group:         512
Inode blocks per group:   128 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:05:35.537

您实际上可以使用 -N 指定自己的 inode 数量

```
mkfs.ext4 -N 250000000 <device> 
```

制作一个包含 2.5 亿个文件的文件系统

# ide - 在 Sublime Text 2 中是否存在相当于“选定代码的格式缩进”的 Textmate？

> ID：10874239
> 
> 赞同：1
> 
> 时间：2012-06-03T21:55:53.343
> 
> 标签：ide, textmate, text-editor, sublimetext, sublimetext2

在 Textmate 中，键盘快捷键`⌘⌥[`可以正确缩进所选代码上的所有嵌套。

Sublime Text 2 中是否有类似的选项？这是唯一让我无法切换的事情，我已经检查了所有文档以尝试找到类似的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:28:10.870

我不确定 Sublime Text 2 是否有一个通用的代码格式化程序，但是有很多非常好的包可以为不同的语言提供各种格式。

看看 Package Control（用于管理 Sublime 的插件）。 [http://wbond.net/sublime_packages/community](http://wbond.net/sublime_packages/community)

对于格式化 Ruby，有一个非常好的包 BeautifyRuby。[https://github.com/CraigWilliams/BeautifyRuby](https://github.com/CraigWilliams/BeautifyRuby)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-04T18:26:36.380

你真正要找的是“reindent”。它在 Edit -> Line -> Reindent 选项下。奇怪的是，它不受击键的约束。简单地安装代码语法包不会导致它们将格式应用于现有代码。

# iphone - 数据模型中的 Char* 内存被回收？

> ID：10874248
> 
> 赞同：0
> 
> 时间：2012-06-03T21:57:32.930
> 
> 标签：iphone, objective-c, ios

我有以下代码从文本字段中读取信用卡号并将其存储在数据模型中。卡号在存储时是正确的，但后来当我尝试从中读取时，它变得乱码。现在我猜这是因为内存被回收并且不再有意义。

从标签设置卡号的代码：

```
 [cardInfo setCardNumber: [textField.text cStringUsingEncoding:[NSString defaultCStringEncoding]]]; 
```

数据模型中的代码：

```
 - (void) setCardNumber:(char *)number{
            cardNumber = number;
            //Value of cardNumber here is correct
    } 
```

在我稍后使用该属性检索该值之前，一切看起来都是正确的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:15:08.920

从[文档中`-[NSString cStringUsingEncoding:]`](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/uid/20000154-BAJHJHHD)：

> 保证返回的 C 字符串仅在接收器被释放或当前自动释放池被清空之前有效，以先发生者为准。您应该复制 C 字符串或使用 getCString:maxLength:encoding: 如果它需要存储超过此时间的 C 字符串。

此外，您永远不应该使用`+[NSString defaultCStringEncoding]`. 它完全不可靠，通常不能表示任意字符串。从文档：

> 一般来说，这种编码应该很少使用，如果有的话

# django - 保持查询的最佳方式是什么？

> ID：10874250
> 
> 赞同：0
> 
> 时间：2012-06-03T21:58:43.050
> 
> 标签：django

我对django很穷。

我有一个项目，项目有一个应用程序

在我的应用程序中，我有一个 models.py 并包括

```
from django.db import models
from taggit.managers import TaggableManager

class Post(models.Model):
    title = models.CharField(max_length=100)
    body = models.TextField()
    created = models.DateTimeField()
    tags = TaggableManager()    

    def __unicode__(self):
     return self.title 
```

我还添加了这个 models.py

帖子 = Post.objects.all().order_by("-created")[:2]

把它放在这里是正确的方法吗？

一些例子表明 models.py 中的一些查询在 views.py 中？

我也可以在我的网站/模板中使用帖子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:03:23.827

最好的方法是[创建一个自定义管理器](https://docs.djangoproject.com/en/dev/topics/db/managers/#custom-managers)，该管理器具有在调用时执行查询的方法。这样您就不必担心它被缓存、回收等。

# jquery - 从 div 获取/设置值

> ID：10874251
> 
> 赞同：1
> 
> 时间：2012-06-03T21:58:49.643
> 
> 标签：jquery

我有 2 个 div：

```
<div id="1">
    First name: <input type="text" name="FirstName" value="Mickey" /><br />
    Last name: <input type="text" name="LastName" value="Mouse" /><br />
    <input type="submit" value="Submit" />
</div>

<div id="2">
    First name: <input type="text" name="FirstName" value="Mickey" /><br />
    Last name: <input type="text" name="LastName" value="Mouse" /><br />
    <input type="submit" value="Submit" />
</div> 
```

您将如何获取/设置 div 编号 div 1 或 2 的名字和姓氏？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:00:32.420

您可以使用`find`和`val`：

```
// Get
var firstName = $("#1").find("[name='FirstName']").val();

// Set
$("#1").find("[name='LastName']").val("New Last Name"); 
```

**演示：http:** [//jsfiddle.net/EknLw/](http://jsfiddle.net/EknLw/)

# jquery - 如何激活链接（jQuery）？

> ID：10874252
> 
> 赞同：0
> 
> 时间：2012-06-03T21:59:03.780
> 
> 标签：jquery, hyperlink

我试图一次激活一个链接。在我拥有的代码上，如果我单击所有链接，它们都会被激活。我正在使用图像，一个用于默认，另一个用于悬停，另一个用于活动（三个不同的图像）不需要背景颜色。这三个图像的大小不同。我还需要激活第一个链接。我怎样才能做到这一点？

HTML：

```
<ul id="navStandard">    
<li class="a"><a href="#"></a></li>
</ul>

<ul id="navQuick">
<li class="a"><a href="#"></a></li>
</ul> 

<ul id="navSurvey">
<li class="a"><a href="#"></a></li>
</ul> 
```

jQuery：

```
$('#navStandard li').append('<div class="hover" />');
$('#navStandard li').hover(function() {
    $(this).children('div').stop(true, true).fadeIn('1000');
}, function() {
    $(this).children('div').stop(true, true).fadeOut('1000');
}).click(function() {
    $(this).addClass('selectedStandard');
});

$('#navQuick li').append('<div class="hover" />');
$('#navQuick li').hover(function() {
    $(this).children('div').stop(true, true).fadeIn('1000');
}, function() {
    $(this).children('div').stop(true, true).fadeOut('1000');
}).click(function() {
    $(this).addClass('selectedQuick');
});

$('#navSurvey li').append('<div class="hover" />');
$('#navSurvey li').hover(function() {
    $(this).children('div').stop(true, true).fadeIn('1000');
}, function() {
    $(this).children('div').stop(true, true).fadeOut('1000');
}).click(function() {
    $(this).addClass('selectedSurvey');
}); 
```

CSS：

```
#navStandard {
width: 115px;
height: 72px;
margin-right: 0px;
margin-bottom: 0px;
    margin-top: 1px;
padding: 0px;
 }
#navQuick {
width: 100px;
height: 73px;
margin-right: 0px;
margin-bottom: 0px;
margin-top: 1px;
padding: 0px;

}
#navSurvey {
width: 110px;
height: 73px;
margin-right: 0px;
margin-bottom: 0px;
margin-top: 1px;
padding: 0px;

}

#navStandard li{
float:left;
 width:115px;
height:72px;
    position:relative;
   background-image: url(standard-img.jpg); 
background-repeat: no-repeat;
background-position: center center;
display: inline;
 }
 #navStandard li a{
  z-index:20; 
display:block;
width: 120px;          
height:72px;        
position:relative;
}
#navStandard li .hover {
position:absolute;
width:115px;
height:72px;
z-index:0;
left:0;
top:0;

display:none;
background-image: url(over-standard.jpg);
background-repeat: no-repeat;
background-position: center center;

 }
#navStandard li.selectedStandard {
background-image: url(active-standard.jpg);
background-repeat: no-repeat;
background-position: center center; 
}

#navQuick li{
 float:left; 
 width:100px;
 height:72px;     
    position:relative;
    background-image: url(quick-img.jpg); 
background-repeat: no-repeat;
background-position: center center;
display: inline;
}
#navQuick li a{
z-index:20; 
display:block;
width: 100px;          
height:72px;        
position:relative;
}
#navQuick li .hover {
position:absolute;
width:100px;
height:72px;
z-index:0;
left:0;
top:0;
display:none;
background-image: url(over-quick.jpg);
background-repeat: no-repeat;
background-position: center center;

}
#navQuick li.selectedQuick {
background-image: url(active-quick.jpg);
background-repeat: no-repeat;
background-position: center center; 
}

#navSurvey {
width: 110px;
height: 72px;
margin-right: 0px;
margin-bottom: 0px;
margin-top: 1px;
padding: 0px;

}
#navSurvey {
width: 110px;
height: 72px;
margin-right: 0px;
margin-bottom: 0px;
margin-top: 1px;
padding: 0px;

}

#navSurvey li{
float:left; 
 width:110px;
height:72px;    
    position:relative;
    background-image: url(survey-img.jpg); 
background-repeat: no-repeat;
background-position: center center;
display: inline;
}
#navSurvey li a{
z-index:20;
   display:block;
   width: 110px;          
   height:72px;        
   position:relative;
   }
#navSurvey li .hover {
position:absolute;
width:110px;
height:72px;
z-index:0;
left:0;
top:0;
display:none;
background-image: url(over-survey.jpg);
background-repeat: no-repeat;
background-position: center center;

}
#navSurvey li.selectedSurvey {
background-image: url(active-survey.jpg);
background-repeat: no-repeat;
background-position: center center; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:08:59.413

如果您尝试仅激活一个链接，则需要先从所有其他 li 元素中删除选定状态，然后再将选定状态添加到单击的一个用户。

类似的东西

```
$('#navSurvey li').hover(function() {
    $(this).children('div').stop(true, true).fadeIn('1000');
}, function() {
    $(this).children('div').stop(true, true).fadeOut('1000');
}).click(function() {
    $("#navStandard li").removeClass('selectedStandard');
    $("#navQuick li").removeClass('selectedQuick');
    $(this).addClass('selectedSurvey');
}); 
```

但是，我建议您有一个通用的选定状态，而不是每个元素的特定状态。在您的 CSS 中，您将能够使用 Id 来定位它们，但它会使您的 JS 更简洁，更少重复。例如

```
$('ul li').hover(function() {
    $(this).children('div').stop(true, true).fadeIn('1000');
}, function() {
    $(this).children('div').stop(true, true).fadeOut('1000');
}).click(function() {
    $("ul li").removeClass('selected');
    $(this).addClass('selected');
}); 
```

您将能够使用 JQuery 触发器触发锚点单击

```
$("#navStandard li a").trigger("click"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T22:08:19.420

`$('#navStandard li a').click()`将模拟对该链接的点击。这就是你的意思“激活”吗？

# objective-c - NSArray initWithContentsOfFile 返回 nil

> ID：10874254
> 
> 赞同：2
> 
> 时间：2012-06-03T21:59:16.257
> 
> 标签：objective-c, ios5, xcode4, xcode4.2

我正在尝试按照[此处](http://mobiledevelopertips.com/data-file-management/reading-a-plist-into-an-nsarray.html)所述将 plist 文件读入`NSArray`使用`initWithContentsOfFile`

我的代码看起来像这样

```
 NSBundle *bundle = [NSBundle mainBundle];
    NSString *plistPath = [bundle pathForResource:
                           @"routes" ofType:@"plist" ];
    routes = [[NSArray alloc] initWithContentsOfFile:plistPath ];
    NSLog:(@"contents of myArray %@", routes); 
```

`routes.plist`内部有一个非常简单的数组结构和 2 个字符串值

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>Root</key>
    <array>
        <string>1</string>
        <string>2</string>
    </array>
</dict>
</plist> 
```

![这就是它在 xcode 中的样子](../Images/e6817b0485c7f65ba0b917fc12750d1a.png)

一切似乎都很好。`plistPath`用正确的值初始化，这意味着文件被复制到包中并且可以读取。但`routes = [[NSArray alloc] initWithContentsOfFile:plistPath ];`返回`0x0`值。我认为这等于`nil`

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-03T22:02:03.887

实际上，您的 plist 是一本字典。

改变这个：

```
<dict>
    <key>Root</key>
    <array>
        <string>1</string>
        <string>2</string>
    </array>
</dict> 
```

对此：

```
<array>
    <string>1</string>
    <string>2</string>
</array> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T22:02:21.500

我想你想做这样的事情：

```
NSBundle *bundle = [NSBundle mainBundle];
NSString *plistPath = [bundle pathForResource:
                       @"routes" ofType:@"plist"];

NSDictionary *dictionary = [NSDictionary dictionaryWithContentsOfFile:plistPath];
NSArray *routes = [dictionary objectForKey:@"Root"]; 
```

# android - tabwidget 中自定义的 textview 颜色

> ID：10874255
> 
> 赞同：0
> 
> 时间：2012-06-03T21:59:17.070
> 
> 标签：android, android-tabhost, tabwidget

我想`TabWidget`在 android 中创建一个自定义，我已经对选项卡的背景和选定的背景颜色进行了更改，但是我想`textview`在选择`tab`. 如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T22:03:15.890

您可以像这样创建一个选择器并将其值分配给 TextView

```
<TextView 
..
...
..
android:textColor="@color/bright_text_dark_focused"/> 
```

# for-loop - for循环的运行时间

> ID：10874257
> 
> 赞同：4
> 
> 时间：2012-06-03T22:00:04.200
> 
> 标签：for-loop, runtime

这个以大 O 表示法嵌套的 for 循环的运行时间是多少？

```
for(i = 1 to k)
{
    for(j = i+1 to k)
    {}
} 
```

它小于 O(k^2) 但我无法弄清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T22:08:24.757

您的问题与系列总和*S(k) = 0 + 1 + 2 + ... + (k-2) + (k-1)*密切相关。可以证明*S(k) = (k*(k-1))/2 = (k*k)/2 - k/2。* [如何？将总和重新排序为*S(k) = {0+(k-1)} + {1+(k-2)} + {2+(k-3)} + ...。* 这说明了如何。]

因此，*算法*阶数是否小于*O(k*k)？* 请记住，像*1/2*这样的常数系数不会影响大 O 表示法。

*问题：* 所以它相当于替换`j = i+1 to k`为`j = 1 to k`?

*答：* 对。这很棘手，所以让我们考虑一下。对于`i == 1`，内循环的动作运行了多少次？答：它运行`k-1`时间。同样，对于`i == 2`，内部循环的动作运行了多少次？答：它运行`k-2`时间。最终， for `i == k`，内部循环的动作运行了多少次？答：它运行零次。因此，在 的所有值中`i`，内循环的动作运行了多少次？答案：`(k-1) + (k-2) + ... + 0`，就是前面提到的和*S(k)*。

# c - C编程中非常大的矩阵

> ID：10874258
> 
> 赞同：2
> 
> 时间：2012-06-03T22:00:13.790
> 
> 标签：c, matrix

今天是个好日子，

我是 C 编程新手，我对如何在 C 中处理非常大的矩阵知之甚少。例如，矩阵大小为 30.000 x 30.000。

我的第一种方法是动态存储内存：

```
int main()
{      int **mat;
    int j;
    mat = (int **)malloc(R*sizeof(int*));
    for(j=0;j<R;j++)
        mat[j]=(int*)malloc(P*sizeof(int));
} 
```

处理 8.000 x 8.000 的 +/- 矩阵是个好主意。但是，不是更大。所以，我想请任何*灯*来处理这种巨大的矩阵，拜托。

正如我之前所说：我是 C 新手，所以请不要期望太多经验。

**提前感谢您的任何建议，**

大卫亚历杭德罗。

PD：我的笔记本电脑配置是 linux ubuntu、64 位、i7 和 4gb 内存。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T22:17:51.083

对于这么大的矩阵，我会尽量避免所有对`malloc`. 这将减少设置数据结构的时间并消除动态内存的内存开销（`malloc`存储有关块大小的附加信息）

只需使用`malloc`一次 - 即：

```
#include <stdlib.h>
int *matrix = malloc(R * P * sizeof(int)); 
```

然后将索引计算为

```
index = column + row * P; 
```

还按顺序访问内存，即首先按列。更好的缓存性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T22:25:35.640

`30000 * 30000` `ints`好吧，假设每个 4 个字节，一个 的二维数组（大致类似于矩阵的 C 表示）`int`将占用`3.6 * 10^9`字节，或约 3.35 GB。没有传统系统允许您在编译时分配那么多静态虚拟内存，我不确定您是否可以成功地动态分配它`malloc()`。如果您只需要表示一个小的数值范围，那么您可以通过使用大幅（即，4 倍）减少程序的内存消耗`char`. 如果您需要执行类似的操作，例如，将布尔值分配给与数组索引对应的特定数字，您也许可以使用位集并进一步减少内存消耗（减少 32 倍）。否则，唯一可行的方法是使用矩阵的较小子集，如有必要，可能会将中间结果保存到磁盘。

如果您能详细说明您打算如何使用这些海量矩阵，我们或许可以提供一些更具体的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T11:19:21.090

我不知道如何添加评论，所以在这里放弃答案。

我能想到的一件事是，您不会在运行程序中获得这些值。这些将仅来自某些文件。因此，取而代之的是所有值，继续一一读取 30,000x2，这样就不会进入记忆。

对于 30k*30k 矩阵，如果所有元素的初始值为 0（或相同），您可以做的是创建整个矩阵，而是创建一个 60k*3 的矩阵（3 列将是：行号、列号和值）。这是因为您将有最多 60k 个不同的位置会受到影响。

我知道这会有点慢，因为您总是需要查看元素是否已添加。因此，***如果您不关心速度***，这将起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T22:08:49.407

假设您将值声明为`float`而不是`double`，则您的数组大小约为 3.4 GB。只要您只需要一个，并且您的 Ubuntu 系统上有虚拟内存，我认为您可以用显而易见的方式编写代码。

如果您需要多个这么大的矩阵，您可能需要考虑：

*   将更多的 RAM 放入您的计算机。

*   在计算集群上租用时间，并使用基于集群的处理来计算您需要的值。

*   重写代码以处理数据的子集，并将每个子集写入磁盘并释放内存，然后再读取下一个子集。

您可能想在 Google 上搜索“处理大型数据集”

# python-3.x - 使用 while 循环

> ID：10874262
> 
> 赞同：1
> 
> 时间：2012-06-03T22:00:48.040
> 
> 标签：python-3.x

我正在为一门课做一些家庭作业，作业在codingbat.com上。问题如下：

返回数组中数字的总和，对于空数组返回 0。除了数字 13 非常不吉利，因此它不算数，紧跟在 13 之后的数字也不算数。

到目前为止，我有这个：

```
def sum13(nums):  
    sum = 0  
    i = 0  
    while i in range(len(nums)):  
        if i == 13:  
            i += 2  
        else:  
            i += 1  
    return sum 
```

另外，我有这个更好的代码：

```
def sum13(nums):
   sum = 0
   for i in range(len(nums)):
   if nums[i] != 13:
     sum += nums[i]
   return sum 
```

我知道我应该使用 while 循环，但我就是不明白。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:03:36.297

看起来你快到了；您只需要在适当的位置实际添加`nums[i]`to的值。`sum`还要重新考虑行的缩进`return sum`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T17:06:17.310

更常见的是使用`for`循环而不使用`range()`. 这种循环（在 Python 中）通常用于循环遍历元素值，而不是遍历索引值。当您需要索引时，使用该`enumerate()`函数同时获取索引和元素值，如下所示（但在这种情况下您不需要它）：

```
...
for i, e in enumerate(nums):
    do something with index and/or the element
... 
```

该问题与索引值无关。这样，`for`/`while`解决方案的不同之处仅在于访问数组的元素。您需要使用索引，`while`但不需要使用`for`.

您的方法的问题`while`还在于您不能简单地跳过值 13 之后的索引，因为下一个元素也可以包含 13。您需要存储前一个元素的值并使用它来决定是否应该添加当前值到`sum`与否。`for`在和解决方案中都是一样的`while`。像这样的东西：

```
last = 0  # init; whatever value different from 13
sum = 0
the chosen kind of loop:
    e ... # current element from nums
    if e != 13 bool_operator_here last != 13:  # think about what boolean operator is
        add the element to the sum
    remember e as the last element for the next loop
sum contains the result 
```

[稍后编辑]好吧，你放弃了。这是解决问题的代码：

```
def sumNot13for(nums):
    last = 0  # init; whatever value different from 13
    sum = 0
    for e in nums:
        if e != 13 and last != 13:
            sum += e        # add the element to the sum
        last = e            # remember e as the last element for the next loop
    return sum

def sumNot13while(nums):
    last = 0  # init; whatever value different from 13
    sum = 0
    i = 0     # lists/arrays use zero-based indexing
    while i < len(nums):
        e = nums[i]         # get the current element
        if e != 13 and last != 13:
            sum += e        # add the element to the sum
        last = e            # remember e as the last element for the next loop
        i += 1              # the index must be incremented for the next loop
    return sum

if __name__ == '__main__':
   print(sumNot13for([2, 5, 7, 13, 15, 19]))
   print(sumNot13while([2, 5, 7, 13, 15, 19]))

   print(sumNot13for([2, 5, 7, 13, 13, 13, 13, 13, 13, 15, 19]))
   print(sumNot13while([2, 5, 7, 13, 13, 13, 13, 13, 13, 15, 19])) 
```

# unicode - Gtk TextBuffer get_iter_at_offset

> ID：10874263
> 
> 赞同：0
> 
> 时间：2012-06-03T22:00:55.687
> 
> 标签：unicode, gtk, gedit, gedit-plugin

我正在为 Gedit 编写一个插件，它根据正则表达式对某些单词进行更改。在某些情况下，这会将标签应用到预期单词之外的几个字符。

因此 match.start() 和 match.end() 返回的值在 get_iter_at_offset 中使用无效。

```
def on_save(self, doc, location, *args, **kwargs):
    """called when document is saved"""
    for match in WORD_RE.finditer(get_text(doc)):
        if not self._checker.check(match.group().strip()):
            self.apply_tag(doc, match.start(), match.end())

def apply_tag(self, doc, start, end):
    """apply the tag to the text between start and end"""
    istart = doc.get_iter_at_offset(start)
    iend = doc.get_iter_at_offset(end)
    doc.apply_tag(self._spell_error_tag, istart, iend) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T06:37:21.717

我最后想通了，这应该很明显。文档中的文本包含一些非 ascii 字符，因此正则表达式无法正确确定位置，将文档字符串解码为 un​​icode 解决了该问题。

所以：

```
get_text(doc).decode('utf-8') 
```

# css - 允许用户使用下拉菜单更改 CSS 设计元素？

> ID：10874265
> 
> 赞同：3
> 
> 时间：2012-06-03T22:01:35.127
> 
> 标签：css, drop-down-menu, themes

所以，由于我在为我的网站决定一个绝对主题时遇到问题，我想让用户从下拉菜单中选择一个主题，当点击一个选项时，它会改变背景图像、背景颜色和背景定位。

例如。如果用户选择“马里奥兄弟 3”主题，他们会得到

```
background-image:url('smb3.jpg');
background-repeat:repeat-x;
background-position:left bottom;
background-attachment: fixed;
background-color: #6899f8; 
```

如果你选择“Zelda LTTP”主题，你会得到

```
background-image:url('zeldalttp.jpg');
background-repeat:no-repeat;
background-position:left bottom;
background-attachment: fixed;
background-color: Black; 
```

我希望它出现在下拉菜单中，并让它记住您的选择，以便每次都适用。

我几乎不知道该怎么做，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-03T22:09:24.407

我会按身体上的不同类别选择主题，如下所示：

```
body.smb2{
    background-image:url('smb3.jpg');
    background-repeat:repeat-x;
    background-position:left bottom;
    background-attachment: fixed;
    background-color: #6899f8;
}
body.zelda{
    background-image:url('zeldalttp.jpg');
    background-repeat:no-repeat;
    background-position:left bottom;
    background-attachment: fixed;
    background-color: Black;
} 
```

然后使用 javascript（或服务器端）设置 body 类并将选择保存在 cookie 中。

* * *

确切地说，将 css 放在 css 文件中，然后您可以像这样更改它：

HTML：

```
<select id="select">
    <option value=""></option>
    <option value="smb2">SMB 2</option>
    <option value="zelda">Zelda</option>
</select> 
```

纯JS：

```
var sel = document.getElementById('select');
sel.onchange = function(){
    document.body.className = sel.value;
}; 
```

或者如果你喜欢[jQuery ：](http://jquery.com/)

```
$('select').change(function(){
    $('body').prop('class',$(this).val());    
}); 
```

* * *

好的，您网站上的问题是，正文已经有很多其他类。并且 className 会覆盖所有这些。一种解决方案是保存旧类，然后像这样添加新类：

```
var saveclass = null;
var sel = document.getElementById('select');
sel.onchange = function(){
    saveclass = saveclass ? saveclass : document.body.className;
    document.body.className = saveclass + ' ' + sel.value;
}; 
```

或 jQuery：

```
var currentclass = null;
$('select').change(function(){
    $('body').removeClass(currentclass).addClass($(this).val());
    currentclass = $(this).val();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T23:05:34.137

如果您查看 WordPress 或众多留言板的主题架构，它们通常会根据用户选择提供单独的 css 文件。但是，如果您在两个主题的样式上有显着差异（即多于一行背景差异）以确保客户端不会收到多余的 css，那将是合理的。

如果差异很小，安迪的回答会很好。是的，*将选择保存在 cookie 中*- 这将允许即使没有在服务器上存储配置文件也可以保存他们的偏好，这意味着他们不必在每次访问该站点时重新选择正确的主题。

# apache - CDN 和 mod_proxy

> ID：10874276
> 
> 赞同：0
> 
> 时间：2012-06-03T22:02:46.983
> 
> 标签：apache, cdn, mod-proxy

我已经在我的堆栈上启用了 mod_proxy 并且我有一个电话（如下）。我正在尝试确定对 CDN 和计费的影响。

例如：

[http://domain.com/ID/SIZE/my-super-lengthy-SEO-url.jpg](http://domain.com/ID/SIZE/my-super-lengthy-SEO-url.jpg)

```
 RewriteRule ^scan/([^/]+)/(s|l|xl)/(.*)$ http://cdn.domain.com/$1_$2.jpg [P,L] 
```

基于上面的例子：

1.  是否仍在使用 CDN 的好处（即 TTL/缓存）？
2.  当使用云服务（即 Rackspace/Amazon/etc）时，上述调用会导致重复的带宽费用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:27:05.387

我为 Cloud CDN 提供商 (Incapsula) 工作，所以我的回答仅基于我对这个特定产品的经验。

话说回来：

1.  图片将由 CDN 缓存。（即所有相关的加速优势仍然适用）
2.  不，因为只加载了一个资源。（301 请求需要接近 0 的带宽）

我很确定 (99%) 我的第二个答案将适用于所有 Cloud CDN 提供商。

最好的，伊格尔。

# image - 上传后JavaScript在浏览器中加载用户的本地图像

> ID：10874281
> 
> 赞同：0
> 
> 时间：2012-06-03T22:03:24.167
> 
> 标签：image, html, file, load, src

我需要让用户将她的本地文​​件系统中的一张图像加载到浏览器中进行一些编辑。

我不想使用闪光灯或其他。只有 HTML 和 JavaScript。

所以我要做的是让用户将图像上传到服务器，服务器返回文件的内容（使用 php file_get_contents）。

现在我将图像文件的内容作为 JavaScript 中的字符串。我希望将此字符串分配给图像元素的 src 并显示出来。但是当我将它分配给 src 时，什么也没有发生。

怎么了？解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:09:46.400

`src`表示 URL。

将其设置为服务器上的 URL，或使用 Base64 编码的图像：

**PHP：**

```
$imagedata = file_get_contents($file);
$encoded = base64_encode($imagedata);
echo $encoded; 
```

**JavaScript：**

```
var imageElem = document.getElementById('image');
var filetype = 'png'; // Set file type here
imageElem.src = 'data:image/' + filetype + ';base64,' + image; 
```

# javascript - 基于 HAML 的视图的 JavaScript 模板

> ID：10874285
> 
> 赞同：1
> 
> 时间：2012-06-03T22:03:54.167
> 
> 标签：javascript, ruby-on-rails, ruby, haml

我有一个使用基于 HAML 的模板视图的 Ruby on Rails 应用程序。我需要删除一个简单的：

`alert('Hello World');`我可以为页面加载的 JavaScript 摘录模板。

如果我的控制器名称是`Foo`并且我的操作名称是`bar`，我将一个`bar.js.haml`放入`app/views/foo/`其中，当我加载页面时它似乎没有加载任何 JS。

我可以做些什么来调试它并将 JavaScript 嵌入到我的 haml 视图中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:49:05.587

是的，它不会为您自动包含或自动引用另一个脚本。如果您想使用 HAML 将 javascript 添加到页面：

```
:javascript
  alert('Hellooooooooooo'); 
```

更新链接到 app/assets/javascripts 中名为“bar.js”的 javascript 文件的方法

```
= javascript_include_tag "bar" 
```

# c++ - FTP 文件夹同步 c / obj c

> ID：10874288
> 
> 赞同：0
> 
> 时间：2012-06-03T22:04:16.477
> 
> 标签：c++, objective-c, ios, ftp, synchronization

我在远程服务器上有文件夹（有很多子文件夹和文件），并且只支持 FTP 协议。

每次用户按下“SYNC”按钮时，我都应该在我的设备上同步复制。内容大小超过 1gb - 每次下载都不是好主意 :)

我正在尝试获取文件夹结构（通过 LIST 和 CWD 递归）并获取要分析的文件修改日期 - 我应该下载这个文件还是不下载。这是一种正确的方法还是我错过了更好的解决方案？目前仅获取文件结构可能需要大约 4 分钟 :(

是否可以使用文件自定义字段（如修改日期）获取所有文件夹结构？

我在 objC（iOS）上并使用 SimpleFTPSample（来自 Apple）的 CFNetwork 示例。

更新：我找到了**dir -R**命令 - 这个命令是标准的（如 LIST）还是没有？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T13:14:18.257

我已经将库替换为 libCURL，现在它可以在 1 秒内运行......我很震惊！

# django - 多对多关系和中间模型（新手指导）

> ID：10874294
> 
> 赞同：0
> 
> 时间：2012-06-03T22:05:00.640
> 
> 标签：django, django-models, dry

我非常感谢有关如何构建以下模型的一些指导。我想确保我以理想的方式做到这一点。

我想跟踪一些有关我工作中员工的信息。基本上，过去的教育和过去的工作经验

所以这是我能想到的关系

*   教育
    *   一个员工可以去过几所学校，每所学校可以有很多学生（m2m）
    *   学生上学一段时间
    *   一个学生可以从同一所学校获得多个学位，并且该学校提供多个学位 (m2m)
*   工作（几乎和教育一样）
    *   m2m 与员工和公司的关系
    *   员工在公司工作到设定的时间
    *   员工可以在一家公司从事多项工作 (m2m)

基本上遵循上面的内容，这是我制定的代码：

```
#make a list of numbers in a tuple
START_DATE_CHOICES = dict((str(x),str(x)) for x in range(date.today().year-30,date.today().year+1))
END_DATE_CHOICES = START_DATE_CHOICES
START_DATE_CHOICES = START_DATE_CHOICES.items()
START_DATE_CHOICES.sort()
START_DATE_CHOICES.reverse()
START_DATE_CHOICES = tuple(START_DATE_CHOICES)

END_DATE_CHOICES['current'] = 'current'
END_DATE_CHOICES = END_DATE_CHOICES.items()
END_DATE_CHOICES.sort()
END_DATE_CHOICES.reverse()
END_DATE_CHOICES = tuple(END_DATE_CHOICES)

#both schools and companies
class Institution(models.Model):
    name = models.CharField(max_length = 75)

class Education(models.Model):
    DEGREE_CHOICES = (
                      ('A.A.', 'Associate'),
                      ('Minor', 'Minor'),
                      ('B.A.', 'Bachelor of Arts'),
                      ('B.S.', 'Bachelor of Science'),
                      ('Masters', 'Masters'),
                      ('Ph. D.', 'Doctor of Philosophy'),
                      )
    school = models.ManyToManyField(Institution, through='Dates')
    degree = models.CharField(max_length = 5, choices = DEGREE_CHOICES, null = True)
    subject = models.CharField(max_length = 20, null = True)

class Work(models.Model):
    company = models.ManyToManyField(Institution, through='Dates')
    position = models.CharField(max_length = 50, null = True)
    jobDescription = models.TextField(null = True)

class Dates(models.Model):
    education = models.ForeignKey(Education, null = True)
    work = models.ForeignKey(Work, null = True)
    institution = models.ForeignKey(Institution)

    start = models.CharField(max_length = 4, choices = START_DATE_CHOICES)
    end = models.CharField(max_length = 7, choices = END_DATE_CHOICES)

class Person(models.Model):
    ....
    school = models.ManyToManyField(Institution, blank=True)
    education = models.ManyToManyField(Education, blank = True)
    company = models.ManyToManyField(Institution, blank = True, related_name="%(app_label)s_%(class)s_related")
    work = models.ManyToManyField(Work, blank=True)
    .... 
```

**所以我的问题是：**这是一种可以接受的方式吗？我是新手，我不确定我是否只是在滥用人际关系

另外，我敢肯定有一种更简单的方法来完成整个开始/结束日期的事情......虽然无法弄清楚

任何指点将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T00:31:54.040

对于多对多字段，您应该使用复数形式。因为`Person`那将是`educations`，`jobs`例如。

也习惯于写`job_description`而不是`jobDescription`在模型字段中。

在`Person`字段中`school`和`company`是多余的，因为可以分别通过`educations`(currently `education`) 和`jobs`(currently `work`) 访问这些信息。

我认为您不需要`company`. `Work`一个简单的`ForeignKey`就足够了。我认为在给定的时间内，您在 ONE 公司只有一份特定的工作。您可以在多家公司同时从事多项工作，但每份工作仍然在一个雇主处。还是我错了？

也是如此`Education`。即使您在此教育过程中去了几所学校，您也只有一所学校的特定学科学位。或者你想准确地模拟这种情况？

所有日期的命名有点误导，因为它们都是 acually 年。您也可以`NULL`在年底使用 as`'current'`并使用`PositiveIntegerField`s。

现在我会有这个代码：

```
#both schools and companies
class Institution(models.Model):
    name = models.CharField(max_length = 75)

class Education(models.Model):
    DEGREE_CHOICES = (
                      ('A.A.', 'Associate'),
                      ('Minor', 'Minor'),
                      ('B.A.', 'Bachelor of Arts'),
                      ('B.S.', 'Bachelor of Science'),
                      ('Masters', 'Masters'),
                      ('Ph. D.', 'Doctor of Philosophy'),
                      )
    school = models.ForeignKey(Institution)
    degree = models.CharField(max_length = 5, choices = DEGREE_CHOICES, null = True)
    subject = models.CharField(max_length = 20, null = True)
    start_year = models.PositiveIntegerField()
    end_year = models.PositiveIntegerField(null=True)

class Job(models.Model):
    company = models.ForeignKey(Institution)
    position = models.CharField(max_length = 50, null = True)
    job_description = models.TextField(null = True)
    start_year = models.PositiveIntegerField()
    end_year = models.PositiveIntegerField(null=True)

class Person(models.Model):
    ....
    educations = models.ManyToManyField(Education, blank = True)
    jobs = models.ManyToManyField(Work, blank=True)
    .... 
```

当然，如果你想拥有多年的选择权，你可以拥有它们

```
YEAR_CHOICES = ((year, str(year)) for year in range(...)) 
```

或者，您可以为您的年份字段[编写自定义验证器。](https://docs.djangoproject.com/en/1.4/ref/validators/)

# c - gdb反汇编一行

> ID：10874298
> 
> 赞同：6
> 
> 时间：2012-06-03T22:06:29.307
> 
> 标签：c, gcc, gdb

我只想反汇编 gdb 中的某一行代码；为此，我需要所述行的内存地址。如何获取 gdb 中特定代码行的地址？或者更好的是，gdb 中是否有按行号反汇编的命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:24:47.603

在要反汇编的行上放一个断点，然后，您可以尝试获取当前指令。

```
disp/i $pc 
```

当我调试没有调试信息的二进制文件时，这总是对我有用。也可以简单地`pc`通过`print $pc`或`info registers`简单地使用`x`指令来获取电流。例如：

```
x/10i address  //displays the first 10 instructions in assembly starting from address 
```

或者

```
x/10i register //displays the first 10 instructions starting from address stored in register 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T22:43:00.060

您可以使用：`set disassemble-next-line on`按行号进行反汇编。然后使用任何你想在你想查看的特定行设置断点的技术。

# javascript - 在 Internet Explorer 8 中加载道场失败

> ID：10874299
> 
> 赞同：1
> 
> 时间：2012-06-03T22:06:49.517
> 
> 标签：javascript, internet-explorer-8, dojo, xmlhttprequest, typeerror

执行此操作后失败：

```
<script type="text/javascript" src="/js/dojo-release-1.7.2-src/dojo/dojo.js"></script> 
```

在语句上抛出错误（在这个版本中，1.7.2，它是第 260 行）

```
return new XMLHttpRequest(); 
```

是：“TypeError：对象不支持此方法或属性”

愚蠢的是，这条线执行了很多次（甚至可能超过 100 次）而没有任何问题，而且它似乎不依赖于任何变量。不幸的是，在某些时候它失败了。我换了行：

```
try{ 
    foo = new window.XMLHttpRequest();
    return foo;
} catch(e)  {
    console.log("OUCH, ERROR.");
    console.log(typeof window.XMLHttpRequest);
    console.log(e);
} 
```

输出：

```
OUCH ERROR.
object
TypeError: Object doesn't support this method or property 
```

我很迷茫，因为 window.XMLHttpRequest 似乎是一个对象，为什么我不能“新建”它？欢迎任何有关如何调试的建议。

我发现绝对令人困惑的是，仅当我使用链接访问此页面时才会发生此错误。当我使用 F5 刷新页面时，一切正常，没有错误，什么都没有。

此外，它在 internet explorer 9、firefox 和 chrome 中运行完美。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T10:47:01.930

1.  在浏览器中完全清除缓存
2.  删除您拥有的任何非本机组件（activex）
3.  如果仍然有问题
    *   在您的 HTML 上运行 xml-validation
    *   确保 DOCTYPE 正确
    *   检查自闭合/非闭合标签

# java - 将带条件的正则表达式翻译成Java

> ID：10874300
> 
> 赞同：2
> 
> 时间：2012-06-03T22:07:36.863
> 
> 标签：java, regex

我正在尝试将这个正则表达式翻译成 Java：

```
^(\s*([<>]=?)?\s*!?(?:(2)[0-9]{1,5}|[0-9\*]{1,5})\s*(&|$))* 
```

我当然知道不支持条件。直接翻译会导致异常。因此，我想了解如何解决问题。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T02:58:40.217

首先，我认为您的模式中有一个错误：

```
^(\s*([<>]=?)?\s*!?(?:(2)[0-9]{1,5}|[0-9\*]{1,5})\s*(&|$))* 
```

您的第 2 组测试前似乎有一个冒号，这不会做您想要的。那将需要是：

```
^(\s*([<>]=?)?\s*!?(?(2)[0-9]{1,5}|[0-9\*]{1,5})\s*(&|$))* 
```

但是还有其他一些奇怪的东西对我来说没有多大意义。我将在 mode 中重写您的模式，`(?x)`以便我们可以解开它并尝试理解它。哦，我会在你的条件语句的 or 分支中去掉那个多余的反斜杠`[0-9\*]`，因为它应该是 just `[0-9*]`。

这产生了这个：

```
(?x)                       # enable comments and whitespace
^                          # anchor to beginning of string
(                          # begin GROUP #1 {
    \s *                   #     any amount of whitespace, including none
    (                      #     begin GROUP #2 {
        [<>]               #        exactly one of either kind of pointy bracket
        = ?                #        optional equals sign
    ) ?                    #     } end GROUP #2, make optional
    \s *                   #     any amount of whitespace, including none
    ! ?                    #     optional exclamation point
    (?(2)                  #     if GROUP#2 is defined {
          [0-9]   {1,5}    #         then: 1-5× ASCII digits
     |    [0-9*]  {1,5}    #         else: 1-5× of either star or ASCII digit
    )                      #     } end ifdef GROUP#2
    \s *                   #     any amount of whitespace, including none
    (                      #     begin GROUP#3 {
        &                  #        either:  an ampersand
      | $                  #        or else: end of string
    )                      #     } end GROUP#3
) *                        # } end GROUP #1, make optional but allow repeats 
```

据我所知，这就是你真正想要做的。你为什么这样做，我不知道，因为那里有些东西看起来很奇怪。

例如，为什么将重复运算符应用于第一个捕获组？它不会*包含所有*的重复，只有最后一个。

另一个问题是为什么允许第一组的零重复？就像 **所有可能的字符串*都与 pattern 匹配 一样`^a*`，所有可能的字符串也与您的 pattern 匹配。这似乎不太有用。

最后，在结尾处有一个＆符号***或***字符串结尾是非常奇怪的。

如果原始发帖人能阐明他的意图，我会将其翻译成适用于 Java 正则表达式的东西，它不支持您在此处使用的条件构造，Perl、PHP、PCRE 和 C ^(♯</sup> 全部支持但不支持Java。（无论如何，这是从什么语言产生的？）您必须这样做的方法是使用或分支展开条件，其中涵盖了两种情况。)

我对整个模式有点怀疑，因为它似乎不明智。一些应该匹配的示例输入将不胜感激。

我不能足够强调的一件事是`/x`，我提供的正则表达式的扩展版本是你应该永远写这些东西的唯一方法。没有空格、缩进、逻辑组和注释的乱码是完全不能接受的。像这样的事情永远不应该通过代码审查。他们是可憎的。

他们不必如此。我恳求您始终始终将`/x`模式用于任何长度和复杂性非平凡的正则表达式，例如这个。试着想想那些会追随你的人，希望在他们这样做之前。

最后，我想知道为什么它使用编号组而不是更容易记忆的命名组，后者更健壮。此外，Java 7 最终支持命名组，因此您不必在此妥协。

# android - 我的 Android XML 文件找不到 ActionBarSherlock 主题

> ID：10874303
> 
> 赞同：6
> 
> 时间：2012-06-03T22:08:26.363
> 
> 标签：android, android-manifest, actionbarsherlock

我正在尝试使用 ActionBarSherlock 开发一个应用程序，除了主题之外一切正常。具体来说，我可以`import com.actionbarsherlock.app.*`扩展`SherlockActivity`，但我的清单中总是有这个错误：

```
Error: No resource found that matches the given name (at 'theme' with value
'@style/Theme.Sherlock'). 
```

我知道有很多关于这个的问题，但它们对我没有用。我试过了

*   刷新工作区
*   清理我所有的项目
*   将线放在 the`<activity>`和 the`<application>`
*   在我的清单和 ABS 中将我的 targetSdkVersion 和 minSdkVersion 设置为各种值

我尝试了以下变体，可能还有其他变体：

*   `android:theme="@style/Theme.Sherlock"`
*   `android:theme="@android:style/Theme.Sherlock"`
*   `theme="@style/Theme.Sherlock"`
*   `theme="@android:style/Theme.Sherlock"`
*   `theme="@theme/Theme.Sherlock"`
*   `theme="@android:theme/Theme.Sherlock"`

值得注意的是，我键入后的自动完成`"@style/"`没有显示任何内容，因此我尝试制作自己的样式，`styles.xml`然后出现了，但 ActionBarSherlock 仍然没有。

另外，在 中`styles.xml`，我尝试将自己的主题扩展为`Theme.Sherlock`，`@style/Theme.Sherlock`当我尝试将其添加为父级时也没有找到。

我尝试加载样本但得到 JAR 不匹配。

我的结论是，不知何故我的 xml 文件无法访问 ABS 库，但我不知道如何修复它。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-03T22:30:22.633

在您项目的 Properties > Android 中，您是否包含对该`com_actionbarsherlock`项目的引用？ ![具有库引用的属性](../Images/59738a1895d1dc9f6e90b78f2dba8a0c.png)

# profiling - 如何使用谷歌性能工具

> ID：10874308
> 
> 赞同：13
> 
> 时间：2012-06-03T22:09:09.217
> 
> 标签：profiling, gperftools

我刚开始使用谷歌性能工具（`google-perftools`和`libgoogle-perftools4`ubuntu 中的包），我发誓我在谷歌上搜索了大约一天，但没有找到答案！问题是我没有通过 CPU 分析获得所有函数的结果。这是我的代码：

```
#include "gperftools/profiler.h"
#include <iostream>
#include <math.h>
using namespace std;
void bar()
{
        int a,b,c,d,j,k;
        a=0;
        int z=0;
        b = 1000;
        while(z < b)
        {
                while (a < b)
                {
                        d = sin(a);
                        c = cos(a);
                        j = tan(a);
                        k = tan(a);
                        k = d * c + j *k;
                        a++;
                }
                a = 0;
                z++;
        }
}
void foo()
{
        cout << "hey " << endl;
}

int main()
{
        ProfilerStart("/home/mohammad/gperf/dump.txt");

        int a = 1000;
        while(a--){foo();}
        bar();
        ProfilerFlush();
        ProfilerStop();
} 
```

编译为`g++ test.cc -lprofiler -o a.out`

这就是我运行代码的方式：

```
CPUPROFILE=dump.txt ./a.out 
```

我也试过这个：

```
CPUPROFILE_FREQUENCY=10000 LD_PRELOAD=/usr/local/lib/libprofiler.so.0.3.0 CPUPROFILE=dump.txt ./a.out 
```

这就是我从中得到的`google-pprof --text a.out dump.txt`：

```
Using local file ./a.out.
Using local file ./dump.txt.
Total: 22 samples
8  36.4%  36.4%        8  36.4% 00d8cb04
6  27.3%  63.6%        6  27.3% bar
3  13.6%  77.3%        3  13.6% __cos (inline)
2   9.1%  86.4%        2   9.1% 00d8cab4
1   4.5%  90.9%        1   4.5% 00d8cab6
1   4.5%  95.5%        1   4.5% 00d8cb06
1   4.5% 100.0%        1   4.5% __write_nocancel
0   0.0% 100.0%        3  13.6% __cos 
```

但是没有关于 foo 函数的信息！

我的系统信息：ubuntu 12.04 g++ 4.6.3

就这样！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-06-01T18:28:28.483

TL;DR：`foo`是为了快速而小规模地获取分析事件，再运行 100 次。频率设置有错字，`pprof`不会比 CONFIG_HZ（通常为 250）更频繁地采样。最好切换到更现代的 Linux`perf`分析器（[其作者的教程](https://perf.wiki.kernel.org/index.php/Tutorial)，[维基百科](http://en.wikipedia.org/wiki/Perf_%28Linux%29)）。

长版：

你的`foo`函数太短太简单了——只需调用两个函数。用 编译测试`g++ test.cc -lprofiler -o test.s -S -g`，过滤`test.s`with`c++filt`程序以使 c++ 名称可读：

```
foo():
.LFB972:
        .loc 1 27 0
        pushq   %rbp
        movq    %rsp, %rbp
        .loc 1 28 0
        movl    $.LC0, %esi
        movl    std::cout, %edi
        call    std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*)
        movl    std::basic_ostream<char, std::char_traits<char> >& std::endl<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&), %esi
        movq    %rax, %rdi
        call    std::basic_ostream<char, std::char_traits<char> >::operator<<(std::basic_ostream<char, std::char_traits<char> >& (*)(std::basic_ostream<char, std::char_traits<char> >&))
        .loc 1 29 0
        popq    %rbp
        ret
.LFE972:
        .size   foo(), .-foo() 
```

因此，要在配置文件中看到它，您应该运行`foo`更多次，将`int a = 1000;`main 更改为更大的值，例如 10000 或更好的 100000（就像我在测试中所做的那样）。

您也可以修复不正确的“ `CPUPROFILE_FREQUENC=10000`”来更正`CPUPROFILE_FREQUENCY`（注意`Y`）。我应该说 10000 对 CPUPROFILE_FREQUENCY 的设置太高了，因为它通常每秒只能生成 1000 或 250 个事件，具体取决于内核配置`CONFIG_HZ`（大多数 3.x 内核有 250，检查`grep CONFIG_HZ= /boot/config*`）。pprof 中 CPUPROFILE_FREQUENCY 的默认设置为 100。

我在 Ubuntu 14.04 上使用 bash 脚本测试了 CPUPROFILE_FREQUENCY: 100000、10000、1000、250 的不同值

```
for a in 100000 100000 10000 10000 1000 1000 300 300 250 250; do 
   echo -n "$a "; 
   CPUPROFILE_FREQUENCY=$a CPUPROFILE=dump$a.txt ./test >/dev/null;
done 
```

结果是相同的 120-140 个事件和每个 ./test 大约 0.5 秒的运行时间，因此来自 google-perftools 的 cpuprofiler 不能为单线程每秒执行比内核中设置的 CONFIG_HZ 更多的事件（我有 250 个）。

```
100000 PROFILE: interrupts/evictions/bytes = 124/1/6584
100000 PROFILE: interrupts/evictions/bytes = 134/0/7864
10000 PROFILE: interrupts/evictions/bytes = 125/0/7488
10000 PROFILE: interrupts/evictions/bytes = 123/0/6960
1000 PROFILE: interrupts/evictions/bytes = 134/0/6264
1000 PROFILE: interrupts/evictions/bytes = 125/2/7272
300 PROFILE: interrupts/evictions/bytes = 137/2/7984
300 PROFILE: interrupts/evictions/bytes = 126/0/7216
250 PROFILE: interrupts/evictions/bytes = 123/3/6680
250 PROFILE: interrupts/evictions/bytes = 137/2/7352 
```

使用原始 a=1000`foo`并且 cout 的函数运行速度太快，无法在每次运行时获得任何分析事件（即使是 250 个事件/秒），因此您没有`foo`，也没有任何输入/输出函数。在少量运行中，`__write_nocancel`可能会得到采样事件，然后`foo` 和来自 libstdc++ 的 I/O 函数将被报告（不在最顶部的地方，所以使用or`--text`选项），自身事件计数为零，子事件非零数数：`pprof``google-pprof`

```
 ....
   1   0.9%  99.1%        1   0.9% __write_nocancel
 ....
   0   0.0% 100.0%        1   0.9% _IO_new_file_overflow
   0   0.0% 100.0%        1   0.9% _IO_new_file_write
   0   0.0% 100.0%        1   0.9% __GI__IO_putc
   0   0.0% 100.0%        1   0.9% foo
   0   0.0% 100.0%        1   0.9% new_do_write
   0   0.0% 100.0%        1   0.9% std::endl
   0   0.0% 100.0%        1   0.9% std::ostream::put 
```

使用`a=100000`， foo 仍然太短太快无法获得自己的事件，但 I/O 函数有几个。这是我从长`--text`输出中提取的列表：

```
 34  24.6%  24.6%       34  24.6% __write_nocancel

   1   0.7%  95.7%       35  25.4% __GI__IO_fflush
   1   0.7%  96.4%        1   0.7% __GI__IO_putc
   1   0.7%  97.8%        2   1.4% std::operator<< 
   1   0.7%  98.6%       36  26.1% std::ostream::flush
   1   0.7%  99.3%        2   1.4% std::ostream::put
   0   0.0% 100.0%       34  24.6% _IO_new_file_sync
   0   0.0% 100.0%       34  24.6% _IO_new_file_write
   0   0.0% 100.0%       40  29.0% foo

   0   0.0% 100.0%       34  24.6% new_do_write

   0   0.0% 100.0%        2   1.4% std::endl 
```

只有通过读取调用链的能力才能看到​​具有零自身计数器`pprof`的函数（如果没有省略帧信息，它知道谁调用了获得样本的函数）。

我还可以推荐更现代、功能更强大（软件和硬件事件，频率高达 5 kHz 或更高；用户空间和内核分析）和更好支持的分析器，Linux`perf`分析器（[其作者的教程](https://perf.wiki.kernel.org/index.php/Tutorial)，[维基百科](http://en.wikipedia.org/wiki/Perf_%28Linux%29)）。

有来自`perf`with的结果`a=10000`：

```
$ perf record  ./test3  >/dev/null
 ... skip some perf's spam about inaccessibility of kernel symbols 
 ... note the 3 kHz frequency here VVVV
Lowering default frequency rate to 3250\. 
Please consider tweaking /proc/sys/kernel/perf_event_max_sample_rate.
[ perf record: Woken up 1 times to write data ]
[ perf record: Captured and wrote 0.078 MB perf.data (~3386 samples) ] 
```

要从`perf.data`输出文件中查看文本报告，我将使用 less（因为`perf report`默认情况下会启动交互式配置文件浏览器）：

```
$ perf report |less
... skip some extra info about the machine, kernel, and perf starting command
# Samples: 1K of event 'cycles'
# Event count (approx.): 1155264208
# Overhead   Command   Shared Object          Symbol
    41.94%    test3  libm-2.19.so         [.] __tan_sse2                                                                                                                                                                    
    16.95%    test3  libm-2.19.so         [.] __sin_sse2    
    13.40%    test3  libm-2.19.so         [.] __cos_sse2                                                                                                                                                                    
     4.93%    test3  test3                [.] bar()                                                                                                                                                                         
     2.90%    test3  libc-2.19.so         [.] __GI___libc_write    
....
     0.20%    test3  test3                [.] foo() 
```

或`perf report -n | less`查看原始事件（样本）计数器：

```
# Overhead       Samples  Command        Shared Object 
    41.94%           663    test3  libm-2.19.so         [.] __tan_sse2                                                                                                                                                                    
    16.95%           268    test3  libm-2.19.so         [.] __sin_sse2   
    13.40%           212    test3  libm-2.19.so         [.] __cos_sse2                                                                                                                                                                    
     4.93%            78    test3  test3                [.] bar()                                                                                                                                                                         
     2.90%            62    test3  libc-2.19.so         [.] __GI___libc_write     
 ....
     0.20%             4    test3  test3                [.] foo() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-14T17:31:55.440

尝试将 LD_PRELOAD 设置为

> LD_PRELOAD=/usr/local/lib/libprofiler.so

传递不以后缀 .so 结尾的共享库时似乎[存在问题。](https://github.com/gperftools/gperftools/issues/487)

# c++ - 什么是 Qt for boost::promise ?

> ID：10874311
> 
> 赞同：5
> 
> 时间：2012-06-03T22:09:44.787
> 
> 标签：c++, multithreading, qt, boost

我看到 Qt 具有直接模拟[boost::future的](http://www.boost.org/doc/libs/1_49_0/doc/html/thread/synchronization.html#thread.synchronization.futures)[未来类，但是](http://doc.qt.nokia.com/4.7-snapshot/qfuture.html)[boost::promise](http://www.boost.org/doc/libs/1_49_0/doc/html/thread/synchronization.html#thread.synchronization.futures.reference.promise)的 qt 是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-03-05T17:59:07.960

如接受的答案所示构建我自己的 QFuture 对我不起作用。起初它似乎在工作，但在我的测试中，我意识到它并没有阻止调用者。哎呀！因此，我进一步深入研究了代码，发现 QFutureInterface 是您想要用作“承诺”的东西。与 boost::promise 一样，QFutureInterface 是您在工作线程中与之交互的对象，它是 QFutures 的工厂。

所以这就是我在 Qt 4.8 中所做的（不确定这是否适用于更高版本）。

```
QFutureInterface<QVariant> promise;
promise.reportStarted();
...
promise.reportResult(someVariant);
promise.reportFinished(); 
```

然后在客户端线程中，假设您可以访问 QFutureInterface 'promise'

```
QVariant result = promise.future().result(); 
```

该`future()`调用是用于创建绑定到 QFutureInterface 的 QFuture 的工厂方法。如果需要，您应该能够获得 QFuture 并`result()`稍后调用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-04T13:59:47.680

boost::promises 是在期货中设置值的方法。在 Qt 中，你*不能*设置期货，你*只能*返回它们。这是未来“设置”数据的唯一方法。

所以，为了设置未来的数据，你必须从一个被调用的函数中返回它`QtConcurrent::run`。为此，您将使用 Qt 的任何机制在线程之间进行通信——事件、互斥保护变量等。您必须告诉运行将返回未来的代码的线程，将返回给定的未来。这是实现承诺的唯一方法。

唉，如果您想进入无证领域，那么以下代码`boost::promise::setValue`将执行以下操作：

```
QFuture<int> f;
int i = 1;
...
f.d.reportResult(&i);
// or
f.d.reportFinished(&i); 
```

我还没有费心检查它是否有效（还）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-21T21:10:52.120

没有官方的 Qt 模拟，但有一些社区库实现了 Promise（或类似模式）：

*   Ben Lau 的 AsyncFuture ( [benlau/asyncfuture](https://github.com/benlau/asyncfuture) )
    基于[其他答案之一中](https://stackoverflow.com/a/22205495/490560)`QFutureInterface`提到的未记录内容。 它不完全是一个承诺模式，而是一个观察者模式。

*   Benoit Walter 的 QtPromise ( [bwalter/qt-promise](https://github.com/bwalter/qt-promise) )
    部分基于 Ben Lau 的 AsyncFuture。
*   西蒙布鲁内尔的 QtPromise ( [simonbrunel/qtpromise](https://github.com/simonbrunel/qtpromise) )
*   我的 QtPromise ( [julrich/QtPromise](https://gitlab.com/julrich/QtPromise) )
    免责声明：我是作者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-26T08:08:11.627

Qt 的 Promise 现在也可以通过 QML/JavaScript 获得：[https ://v-play.net/updates/release-2-18-1-javascript-promises-for-rest-services-tinder-swipe-material-cards -qml-qsortfilterproxymodel-qml-youtube-player](https://v-play.net/updates/release-2-18-1-javascript-promises-for-rest-services-tinder-swipe-material-cards-qml-qsortfilterproxymodel-qml-youtube-player)

这是一些示例代码：

```
import VPlayApps 1.0
import QtQuick 2.0

App {
  Component.onCompleted: {
    var p1 = Promise.resolve(3);
    var p2 = 1337;
    var p3 = HttpRequest
    .get("http://httpbin.org/get")
    .then(function(resp) {
      return resp.body;
    });

    var p4 = Promise.all([p1, p2, p3]);

    p4.then(function(values) {
      console.log(values[0]); // 3
      console.log(values[1]); // 1337
      console.log(values[2]); // resp.body
    });
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-19T18:35:25.997

我创建了这个**与 Qt 高度集成**并实现*类似 javascript 的*承诺的库：

[https://github.com/juangburgos/QDeferred](https://github.com/juangburgos/QDeferred)

它允许创建一个线程安全的异步 API，如下所示：

```
multiplyNumbersInThread(3, 4)
.fail([](int res) {
    Q_UNUSED(res);
    qDebug() << "multiplyPositiveNumbers failed!";
})
.done([](int res) {
    qDebug() << "multiplyPositiveNumbers succeded! Result :" << res;
}); 
```

希望你觉得它有用。

# python - GAE 数据存储 python - fetch() 与 run()

> ID：10874312
> 
> 赞同：1
> 
> 时间：2012-06-03T22:09:52.690
> 
> 标签：python, google-app-engine, google-cloud-datastore

我看到有两种从数据存储区获取数据的方法： fetch() 和 run() 关于 fetch 文档说： 注意：您应该很少需要使用此方法；改用 run() 几乎总是更好。

我不明白两者之间的区别。我是 GAE 和 Python 的新手，请帮助我理解。谢谢

它说 run() 是异步的，我不明白原因与 JavaScript 不同，一旦您为该站点运行 Python 脚本，html 就会被冻结，对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-04T14:43:00.213

初学者的建议：在您意识到差异之前，请坚持使用 fetch()。在这种微妙的区别困扰您之前，您可能应该先熟悉许多其他事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T23:44:36.607

您可以并行运行（运行）多个数据存储查询以改善延迟。这与您生成的 HTML 无关。生成的 HTML 应该是相同的。

# c++ - 指令缓存和条件语句

> ID：10874315
> 
> 赞同：0
> 
> 时间：2012-06-03T22:10:11.543
> 
> 标签：c++, cache-control, data-oriented-design

我试图使用面向数据的设计来定位我的代码以尽可能有效地使用缓存，这是我第一次考虑这样的事情。我想出了一种方法来循环在屏幕上绘制精灵的相同指令，发送到函数的向量包括所有游戏实体的位置和精灵。

我的问题是条件语句是否摆脱了指令缓存中的绘图函数并因此破坏了我的计划？或者我在做什么通常是疯了？

```
struct position
{
    position(int x_, int y_):x(x_), y(Y_)
    int x,y;
};

vector<position> thePositions;
vector<sprite> theSprites;
vector<int> theNoOfEntities; //eg 3 things, 4 thingies, 36 dodahs
int noOfEntitesTotal;

//invoking the draw function
draw(&thePositions[0], &theSprites[0], &theNoOfEntities[0], noOfEntitesTotal)

void draw(position* thepos, sprite* thesp, int* theints, int totalsize)
{
    for(int j=0;int i=0;i<totalsize;i++)
    {
        j+=i%size[j]?1:0;
        thesp[j].draw(thepos[i]);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T12:21:39.290

您是否验证了条件在汇编中仍然是条件？通常使用上面介绍的简单条件，表达式可以优化为无分支序列（在机器级别使用机器特定指令，或在 IR 级别使用一些花哨的位数学）。

在您的情况下，您有条件地在 x86 上很好地折叠成一个平面序列（并且 AFAIK，这也将发生在大多数非 x86 平台上，因为它是一种数学优化，而不是特定于机器的优化）：

```
IDIV DWORD PTR SS:[ARG.1]
MOV EAX,EDX
NEG EAX                                  ; Converts EAX to boolean
SBB EAX,EAX
NEG EAX 
```

因此，这意味着除了遵循模式的外部循环之外，没有任何要预测的分支，这意味着它不会导致任何错误预测（它可能会在退出时错误预测，具体取决于生成的程序集，但它的退出，所以没关系）。

这提出了第二点，永远不要*假设*，总是分析和测试（汇编知识有很大帮助的情况之一），这样您就可以花时间优化**真正**重要的地方（并且您可以了解您的内部和内部工作原理）目标平台上的代码也更好）。

如果您真的担心分支错误预测和所招致的惩罚，请使用您的目标架构制造商提供的资源（不同的架构对分支错误预测的行为非常不同），例如英特尔的[this](http://software.intel.com/en-us/articles/avoiding-the-cost-of-branch-misprediction/)和[this](http://software.intel.com/en-us/articles/quantify-the-penalty-of-branch-misprediction-on-64-bit-architecture/)。AMD 的 CodeAnalyst 是检查分支错误预测及其可能造成的惩罚的绝佳工具。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-04T11:25:07.280

哇，伙计！没有冒犯，但看起来你在没有完全理解它的方式和原因的情况下阅读了有关 DOD 的内容。现在，您只需遵循有关 DOD 的文章中设置的指南，就像它们很重要一样。他们不是，在 DOD 中重要的是理解数据、理解计算机架构以及理解你的代码如何使用你对架构的知识尽可能高效地操作数据。国防部文章中列出的指导方针只是提醒人们要考虑的常见问题。

想知道何时以及为何需要使用 DOD？了解您正在使用的架构。你知道一次缓存未命中的代价吗？真的真的真的真的很低。算一算。我是认真的，你自己算一下，我可能会给你一些数字，但那样你就不会学到很多东西。因此，找出有关体系结构、处理器如何工作、内存和缓存如何工作、汇编语言如何工作以及编译器生成的汇编是什么样子的信息。一旦你了解并理解了所有这些，DOD 只不过是陈述一些几乎显而易见的指导方针来编写真正有效的代码。

# c++ - 同一个类的一个类的静态成员对象

> ID：10874317
> 
> 赞同：6
> 
> 时间：2012-06-03T22:11:01.843
> 
> 标签：c++, static, constructor

假设我们有一个类

```
class Egg
{
    static Egg e;
    int i;
    Egg(int ii):i(ii) {}
    Egg(const Egg &);    //Prevents copy-constructor to be called
  public:
    static Egg* instance() {return &e}
};

Egg Egg::e(47); 
```

这段代码保证我们不能创建任何对象，而只能使用静态对象。但是我们如何在类中声明同一个类的静态对象。

还有一件事，因为e是一个静态对象，而静态对象只能调用静态成员函数，那么这里怎么会调用静态对象e的构造函数，它的构造函数也是私有的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-03T22:35:25.477

> 但是我们如何在类中声明同一个类的静态对象。

`static`成员变量不存储在类的每个对象中。因此，如果您在定义类之后在类中声明`static`成员变量或作为命名空间级别的对象，则仅在访问（`Class::var`和`var`）和对成员的访问`protected`方面`private`有所不同。

> 还有一件事，因为`e`是静态对象，静态对象只能调用静态成员函数

我认为您正在混合`static`功能和`static`对象。在`static`函数内部，您只能调用`static`函数（除非您在对象上调用它们）。

> 那么如何在这里为静态对象调用构造函数`e`

与其他所有对象一样，也必须为`static`对象调用构造函数。

> 它的构造函数也是私有的

在 C++ 中的类级别上检查访问控制。因此，由于`static`对象在类内部，它可以访问`private`成员。

与其他一些语言不同，以下在 C++ 中是合法的，因为对私有成员的访问是从类内部进行的——即使是在另一个对象上（`other`在这种情况下）：

```
 class Test {
 private:
      int i;
 public:
      Test(const Test &other)
      : i(other.i)
      {}
 }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T23:47:53.967

> 但是我们如何在类中声明同一个类的静态对象。

通常你需要一个前向引用，但由于 Egg e 是静态的，它实际上是在类定义*之外定义的。*如果 e 不是静态的，你会得到一个错误（类似于“*字段 Egg e 的类型不完整*”）。

> 还有一件事，因为e是一个静态对象，而静态对象只能调用静态成员函数，那么这里怎么会调用静态对象e的构造函数呢。

这并不完全正确。类中的静态成员*函数*只能访问静态成员数据。**static Egg e**是 Egg 的一个*实例*，因此它可以访问常规 Egg 可以访问的所有成员和数据。

> 它的构造函数也是私有的。

任何私有成员都可以在类中使用。由于**静态 Egg e**被声明为 Egg 的成员，它可以使用私有构造函数。e 的定义在类*之外*，因为它是静态的，但它仍然是类成员。

最后，您的代码无法编译，因为您在这里遗漏了分号：

```
static Egg* instance() {return &e;} 
```

# r - R 绘图，x 轴和 y 轴接触

> ID：10874318
> 
> 赞同：6
> 
> 时间：2012-06-03T22:11:06.970
> 
> 标签：r, plot, axis, smooth, curve

我的问题涉及为 R 中的出版物制作图表。我使用了如下 plot 函数：

```
plot(x=data$SL, y=data$BD, xlab = "SL (mm)", ylab = "BD (mm)", pch=data$pch) 
```

SL 范围从 51.7 到 73.7，BD 范围从 13.5 到 20.4。不幸的是，我还不允许发布图片。

但是，想摆脱我使用“axes = F”的框。现在的问题是缺乏对轴功能的控制。我用了：

```
axis(side=1, lwd=3, xpd=TRUE, at=c(min(data$SL):max(data$SL)))
axis(side=2, lwd=3, xpd=TRUE, at=c(min(data$BD):max(data$BD))) 
```

问题是我无法让 y 轴和 x 轴在与方框图中相同的点上聚集在一起。如何让x轴和y轴相互接触？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T15:36:08.300

尝试`box(bty='L')`仅绘制框的左侧和底部。您也可以使用 、 或 自己绘制线条`lines`，`segments`并`abline`使用`grconvertX`and`grconvertY`函数来查找绘制线条的位置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-04T11:38:49.130

最有可能设置 xaxs = "i" 和 yaxs = "i" 将帮助您获得所需的行为。

```
plot(c(1,2,3),c(2,4,6),axes=F,xaxs = "i",yaxs="i",xlim=c(0,3),ylim=c(0,6))
axis(side=1, lwd=3, xpd=TRUE, at=0:3)
axis(side=2, lwd=3, xpd=TRUE, at=seq(0,6,2)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-24T13:08:37.800

我建议您按照您概述的程序，然后使用：

`box(which = "plot", bty = "l")`

例如：

```
plot.new()
plot.window(xlim = c(1, 18), ylim = c(2, 20))
points(1:18, 2:19, pch = 1, col = "#FF7F24", cex = 1.2)
lines(1:18,  2:19, col = "#FF7F24", lwd = 2)
axis(side      = 1,
     lwd       = 0,
     lwd.ticks = 1,
     at        = 1:18,
     cex.axis = 0.9)
title(main = "Plot",
      ylab = "Y-Axis")
legend("top",
       legend = c("Legend"),
       col = c("#FF7F24"),
       text.col = c("#FF7F24"),
       pch    = 1,
       bty    = "n",
       cex    = 1.2)
axis(side      = 2,
     lwd       = 0,
     lwd.ticks = 1)
box(which = "plot", bty = "l") 
```

您应该将选项传递给单独的调用`lwd = 0`，以防止轴的某些部分看起来比轴的其他部分更胖，因为有些部分会被您的调用覆盖而有些则不会。`lwd.ticks = 1``axis()``box()`

我认为，最后使用的解决方案`box()`更通用，因为您可以在例如您不能或不想传递`bty = "l"`您的`plot.default`or`plot.window`呼叫时使用它。

# c# - 递归迭代器

> ID：10874320
> 
> 赞同：0
> 
> 时间：2012-06-03T22:11:59.787
> 
> 标签：c#, recursion, iterator

我在制作可以遍历以下类型数据结构的迭代器时遇到了一些麻烦。

我有一个名为 的类`Expression`，它有一个数据成员`a List<object>`.

此列表可以有任意数量的子项，其中一些子项可能是其他 Expression 对象。

我想遍历这个结构，并打印出每个非列表对象（但我当然想打印出列表的元素），但在进入列表之前，我想返回“开始嵌套”，然后我只是退出列表，我想返回“结束巢”。

如果我尽可能忽略该类，我就可以做到这一点，如果我想要一个子表达式，我只拥有`List<object>`带有`List<object>`项目的对象，但我宁愿取消这个，而是将一个`Expression`s 作为子列表（这样更容易对对象进行操作。我知道我可以在对象上使用扩展方法，`List<object>`但这不合适（谁想要`Evaluate`在他们的列表中使用不带参数的方法？）。

我用来生成原始迭代器（有效）的代码是：

```
 public IEnumerator GetEnumerator(){
        return theIterator(expr).GetEnumerator();
    }
    private IEnumerable theIterator(object root) {
        if ((root is List<object>)){
            yield return " begin nest ";
            foreach (var item in (List<object>)root){
                foreach (var item2 in theIterator(item)){
                    yield return item2;
                }
            }
            yield return " end nest ";
        }
        else
            yield return root;
    } 
```

for 表达式的类型交换`List<object>`不起作用，并导致 stackOverflow 错误。迭代器应该如何实现？

**更新：**这是交换的代码：

```
 public IEnumerator GetEnumerator() {
        return this.GetEnumerator();
    }
    private IEnumerable theIterator(object root) {
        if ((root is Expression)) {
            yield return " begin nest ";
            foreach (var item in (Expression)root) {
                foreach (var item2 in theIterator(item))
                    yield return item2;
            }
            yield return " end nest ";
        }
        else
            yield return root;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:36:01.023

你得到一个的原因`StackOverflowException`是

```
foreach (var item in (Expression)root) 
```

…内部原因：

```
((Expression)root).GetEnumerator() 
```

`item`…被调用——这是 CLR 枚举在循环的每次迭代期间必须分配给变量的对象的方式`foreach`。

在您的情况下，`GetEnumerator()`调用将导致`theIterator`再次执行相同的`root`，从而进入无限递归。

要解决您的问题，您需要更换：

```
foreach (var item in (Expression)root) 
```

…和：

```
foreach (var item in ((Expression)root).expr) 
```

…物业`expr`名称在哪里。`List<object>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T22:37:55.533

为什么改`GetEnumerator()`回来了`this.GetEnumerator()`？

在我看来，这就是您的堆栈溢出的来源。

尝试让它返回`theIterator(this).GetEnumerator()`？

# qt - 自扩展小部件，鼠标悬停

> ID：10874326
> 
> 赞同：5
> 
> 时间：2012-06-03T22:13:01.633
> 
> 标签：qt

I want to implement a widget (with some edit boxes and sliders) that would open beneath or next to a button ("Opener") when I hover it. The key is it's a temporary widget - as soon as it loses focus, I want it gone. Also, I want it to pop up right next to the Opener, ideally pointing an arrow to Opener.

So, it's basically a tooltip. But it needs to be a widget with buttons and sliders and stuff like that. Is there a clever way to implement it without making a custom widget and writing handlers for all the mouse and focus events and recomputing its ideal position every time I open it or the Opener moves?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-04T04:36:14.797

```
class OpenerButton : public QPushButton
{
public:
    OpenerButton(QWidget * parent = 0);
protected:
    void enterEvent(QEvent *e);
    void leaveEvent(QEvent *e);
};

OpenerButton::OpenerButton(QWidget * parent)
      : QPushButton(parent)
{
   //Do necessary initializations For ex:set a menu for opener button 
}

void OpenerButton::leaveEvent(QEvent * e)
{
          //hide the popup_menu
}

void OpenerButton::enterEvent(QEvent * e)
{
    //Show the menu
    //You can use animation for ex:
     Popup_menu=new Popup_Dialog(this);//Popup_Dialog is a dialog containing all your widgets
     QPropertyAnimation *animation = new QPropertyAnimation(Popup_menu,"geometry");
     animation->setDuration(500);
     animation->setDirection(QAbstractAnimation::Forward);
     QRect startRect(Rect_Relative_to_Opener_Button);
     QRect endRect(Shifted_Rect_Relative_to_Opener_Button);
     animation->setStartValue(startRect);
     animation->setEndValue(endRect);
     animation->start();

} 
```

`Enterevent`当鼠标光标进入小部件时调用。同样`leaveevent`，当鼠标光标离开小部件时。

# java - 以编程方式设置会话仅安全标志

> ID：10874327
> 
> 赞同：4
> 
> 时间：2012-06-03T22:13:11.073
> 
> 标签：java

在 web.xml 中，您可以通过以下方式确保会话 cookie (JSESSIONID) 设置为仅 SSL cookie：

```
<session-config>
  <cookie-config>
    <secure>true</secure>
  </cookie-config>
</session-config> 
```

创建会话时，有没有办法以编程方式实现相同的目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-04T03:02:25.613

我找到了答案。这是为了他人的利益：

```
public void contextInitialized(ServletContextEvent servletContextEvent) {
    ServletContext servletContext = servletContextEvent.getServletContext();
    SessionCookieConfig scc = servletContext.getSessionCookieConfig();
    scc.setSecure(true);
} 
```

该代码显然应该添加到您的应用程序的上下文侦听器中。

# ruby-on-rails - 接受 1 个参数的函数为 PagesHelper:Module 返回未定义的方法“grabTweets”

> ID：10874329
> 
> 赞同：0
> 
> 时间：2012-06-03T22:13:22.913
> 
> 标签：ruby-on-rails, ruby, helpers

我正在尝试编写一个非常简单的函数，它将某人输入到输入字段中的任何文本输入到搜索 Twitter 并返回一些值的函数中。

在我的`home.html.erb`文件中，我有这段代码，但我不确定调用应该调用我的grabTweets 函数的@tweetArray 实例变量是否是正确的处理方式。

```
 <%= form_for(@tweetArray) do |f| %>
    <%= f.text_field :grabTweets %>
    <% end %> 
```

在我的`pages helper`文件中，我有：

```
 @tweetArray = grabTweets(:grabTweets)

  def grabTweets(mySearch)
    @tweet = Twitter.search( "mySearch +" "[pic] "+" path.com/p/", :rpp => 2, :result_type => "recent").map do |status|
    @tweet = "#{status.text}" #class = string
    urls = URI::extract(@tweet, "http") #returns an array of strings
    end
  end 
```

我的页面只显示此错误`undefined method grabTweets for PagesHelper:Module`。我在我的`home.html.erb`文件中放了什么才能正确调用此代码？

编辑：

更新了我的代码`home.html.erb`

```
 <%= form_for(grabTweets) do |f| %>
    <%= f.text_field :search %>
    <% end %> 
```

这更有意义吗？

然后在我的`pages controller`

```
@tweetArray = grabTweets(":search")

def grabTweets(mySearch)
    @tweet = Twitter.search( mySearch + "[pic] "+" path.com/p/", :rpp => 2, :result_type => "recent").map do |status|
    @tweet = "#{status.text}" #class = string
    urls = URI::extract(@tweet, "http") #returns an array of strings
    end
  end 
```

我仍然遇到`undefined local variable or method grabTweets`错误`home.html.erb`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:18:17.723

# 有一个模型

假设您有一个 @tweet 对象：

```
<%= form_for(@tweet) do |f| %>
  <%= f.text_field :search %>
<% end %> 
```

然后，根据您设置路线的方式，当用户提交表单时，它将触发您的`find_tweets`操作。您可以设置一条路线来实现`/tweets`该`find_tweets`操作（您可以随意称呼它）。

在您的控制器中，您将拥有：

```
def find_tweets
  @tweets = Twitter.search( params[:tweet][:search] + "[pic] "+" path.com/p/", :rpp => 2, :result_type => "recent").map do |status|
    tweet = "#{status.text}" #class = string
    urls = URI::extract(@tweet, "http") #returns an array of strings

    { 
      :tweet => tweet,
      :urls => urls
    }
  end

  @tweets
end 
```

这应该会让你得到一个`@tweets`带有推文和网址的哈希数组。我还没有测试过这些，但我希望它能为你指明正确的方向。

# 没有模型

要在没有模型的情况下执行此操作，您可以使用`form_tag`.

```
<%= form_tag '/tweets/find_tweets' do %>
  <%= text_field_tag "search" %>
<% end %> 
```

您的控制器不会有太大变化，但您可能会使用它`params[:search]`来访问您的搜索参数。

# html - 如何让画布不断重绘自己？

> ID：10874331
> 
> 赞同：1
> 
> 时间：2012-06-03T22:13:29.620
> 
> 标签：html, canvas, paint, invalidation

我有一个 HTML5 画布，正在制作一个网络绘画应用程序。但是，当其他客户端收到绘图代码时，直到将鼠标悬停在画布上才会将其绘制到画布上。

有什么办法可以解决吗？我希望绘图出现并更新给其他客户，而不必将鼠标光标悬停在画布上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:24:16.770

来自[https://developer.mozilla.org/en/Drawing_Graphics_with_Canvas](https://developer.mozilla.org/en/Drawing_Graphics_with_Canvas)

```
<html>

<head>
  <script type="application/javascript">
var drawHandle;
function draw() {
  return drawHandle = setTimeout(function(){
  var canvas = document.getElementById("canvas");
  var ctx = canvas.getContext("2d");

  ctx.fillStyle = "red";

  ctx.beginPath();
  ctx.moveTo(30, 30);
  ctx.lineTo(150, 150);
  // was: ctx.quadraticCurveTo(60, 70, 70, 150); which is wrong.
  ctx.bezierCurveTo(60, 70, 60, 70, 70, 150); // <- this is right formula for the image on the right ->
  ctx.lineTo(30, 30);
  ctx.fill();
}
}, 1000);//Where 1000 is the timeout in milliseconds
   </script>
 </head>
 <body onload="draw()">
   <canvas id="canvas" width="300" height="300"></canvas>
 </body>
</html> 
```

# iphone - iPhone：按钮触摸事件 - 释放不触发？

> ID：10874338
> 
> 赞同：1
> 
> 时间：2012-06-03T22:14:45.363
> 
> 标签：iphone, ios, cocoa-touch, uibutton

**已解决 - 请查看 Darren 的回复，以找到解决此问题的有效方法。**

您好，感谢您花时间阅读我的问题。

我在检测到释放时遇到了一些奇怪的行为`IBAction UIButton`：**当我在界面上移动手掌时，检测到按钮按下，但没有释放！**

我有一组控件，每个控件都有自己的`IBAction UIButton`. 这是我的按钮如何反应和行为的示例：

```
- (IBAction)up1start:(id)sender 
{   
    if(!buttonIsPressed && deviceIsConnected)
    {
        NSLog(@"BUTTON UP 1 PRESSED!");
        NSString *byteString = @"7E 01";
        sendTimer =[NSTimer scheduledTimerWithTimeInterval:0.01 target:self selector:@selector(sendByte:) userInfo:byteString repeats:YES];
        buttonIsPressed = true;
    }else{
        NSLog(@"Cant press two buttons or connection is closed");
    }
}
- (IBAction)up1stop:(id)sender 
{
    NSLog(@"BUTTON UP 1 RELEASED!");
    [ self buttonRelease ];
} 
```

我附加了以下事件`UIButton up1`- 由于我正在进行的故障排除工作，可能超出了必要：

*   *着陆*-`up1start`
*   *触摸拖动退出*-`up1stop`
*   *触摸外部*-`up1stop`
*   *内部修饰*-`up1stop`
*   *在外面修饰*-`up1stop`

对于这些事件都没有导致我的“up1stop”动作被触发，我有点困惑。同样，我可以通过将手掌按在界面上然后松开或稍微移动来重现此问题。作为记录，我为每个按钮**启用了 ExclusiveTouch**。

其他一切都运行良好，我必须*尝试*让这种行为发生，但是考虑到应用程序的性质，如果不解决这个问题，对用户来说将是非常不安全的。

谁能解释为什么当我“手掌”屏幕时未检测到按钮释放？

干杯!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T22:30:54.067

您将要跟踪该`UIControlEventTouchCancel`事件。

`UIControlEventTouchCancel`如果将初始触摸重新解释为另一个手势（例如滚动），则会发生一个事件。

# architecture - 这是领域驱动设计吗？

> ID：10874342
> 
> 赞同：1
> 
> 时间：2012-06-03T22:15:24.637
> 
> 标签：architecture, domain-driven-design

对于那里的领域驱动开发专家...

我试图真正掌握 DDD 的概念。到目前为止，我一直在将我的模型设计为数据驱动而不是域驱动。我已经阅读了几篇关于 DDD 的文章，看起来非常有趣，尤其是对于大型应用程序。所以我正在尝试定制我的模型来做到这一点。

我说过一个客户实体公开了一个 FreezeAccounts 方法，该方法将禁用所有客户帐户。此方法与数据访问无关（基于 Persistence Ignorance 规则）。它更新每个客户帐户上的标志（按需加载）并将更改保存到数据库。基于这个模型是正确的吗？我已经读过，在 DDD 中，每个表实体不一定只有一个类。这个功能应该在一个单独的类中吗？这是一些示例代码：

```
public class Customer : ICustomer, ICustomerAction
{
    #region Initialization
    public Customer()
    {
    }

    internal Customer(ICustomer view)
    {
        this.CustomerId = view.CustomerId;
        this.Name = view.Name;
        this.Email = view.Email;
        this.IsActive = view.IsActive;
    }
    #endregion

    #region Instances

    private AccountCollection _accounts;

    #endregion

    #region Properties

    #region ICustomer

    public int CustomerId { get; private set; }
    public string Name { get; set; }
    public string Email { get; set; }

    #endregion

    #region Derived

    public AccountCollection Accounts
    {
        get
        {
            if (_accounts == null)
                _accounts = Account.GetListByCustomerId(CustomerId);
            return _accounts;
        }
    }

    #endregion

    #endregion

    #region Methods

    #region CRUD

    // Data Access Object accepts interface ICustomer
    internal void Update()
    {
        CustomerDb.Update(this); 
    }

    #endregion

    #region ICustomerAction

    // Exposed business Persistence Ignorance action
    internal void FreezeAccounts()
    {
        foreach (Account account in this.Accounts)
        {
            account.IsEnabled = false;
            account.Update();
        }
    }

    #endregion

    #endregion
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:24:56.020

首先，在**DDD**中和其他架构中一样，*数据访问层*必须与域和业务逻辑分离，因此不能对实体进行 CRUD 操作。

所以要回答，是的，创建一个单独的层（不仅仅是一个类）来读取/写入存储上的数据，特别是在 DDD 中，您可以使用 Martin Fowler 的[**Repository**](http://martinfowler.com/eaaCatalog/repository.html)和[**Unit Of Work**](http://martinfowler.com/eaaCatalog/unitOfWork.html)模式。

如果你想要一个 DDD 的例子，请看[这里](http://sample.codeplex.com/wikipage?title=Domain%20Model%20in%20DDD)。

注意：我必须在 NuGet 上发布我的 DDD 架构“视图”的新版本。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-28T21:02:44.237

使用 DDD，您希望清楚地了解什么是实体（具有唯一 ID，并作为单独的单元持续存在），什么是实体根（您希望向外界公开的实体），以及什么是服务（管理实体之间交互的代码）。

项目在数据库中的持久化方式可能与其实体对象完全不同——但由于您只处理实体，因此外部世界不必担心这一点，它被抽象到 DAL 中。

在您的示例中，您充分利用了对接口（SOLID 中的 I）的编程，这很好，但在不了解系统意图的情况下，很难说该示例是否遵循 DDD。

# objective-c - 如何去除导航栏的阴影

> ID：10874345
> 
> 赞同：1
> 
> 时间：2012-06-03T22:16:04.223
> 
> 标签：objective-c, ios, uinavigationbar

我有 UINavigationBar。

```
UINavigationBar *navBar = [[UINavigationBar alloc] initWithFrame:CGRectMake(0.0f, 46.0f, 320.0f, 50.0f)];
navBar.tintColor = [UIColor blackColor];
[self.view addSubview:navBar]; 
```

我想删除标准的顶部阴影。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:27:59.763

您可以在 iOS 5.0 及更高版本中为导航栏定义自定义图像：

```
UIImage *backgroundImage = [UIImage imageNamed:@"bevel_nav_bar.png"];
[navBar setBackgroundImage:backgroundImage forBarMetrics:UIBarMetricsDefault]; 
```

# apache - mod_rewrite www-removal 片段中的尾随斜杠“错误”

> ID：10874346
> 
> 赞同：0
> 
> 时间：2012-06-03T22:16:16.547
> 
> 标签：apache, mod-rewrite

我有一个片段将所有`www.domain.com`请求重定向到`domain.com`另一个 SO 问题：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 
```

不幸的是，它会导致额外的斜杠：

`www.domain.com`重定向到`domain.com//`和 `www.domain.com/path/`重定向到`domain.com//path/`

我真的应该添加一个[额外的规则](https://stackoverflow.com/questions/1859536/mod-rewrite-trailing-slash-with-rewritecond)来删除斜杠吗？还是上面的代码片段有问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T19:32:36.297

只需从第三行删除斜线即可：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://%1$1 [R=301,L] 
```

# android - Android NDK下的链接共享库

> ID：10874348
> 
> 赞同：8
> 
> 时间：2012-06-03T22:16:31.473
> 
> 标签：android, android-ndk

我成功地将库 LibXtract 编译为共享对象 libxtract.so 并希望在第二个项目中使用。

在提到的项目中，我尝试在简单的函数上编译它：

```
#include <com_androidnative1_NativeClass.h>
#include <android/log.h>
#include "libxtract.h"

JNIEXPORT void JNICALL Java_com_androidnative1_NativeClass_showText
(JNIEnv *env, jclass clazz)
{

    float mean = 0, vector[] = {.1, .2, .3, .4, -.5, -.4, -.3, -.2, -.1}, spectrum[10];
    int n, N = 9;
    float argf[4];

    argf[0] = 8000.f;
    argf[1] = XTRACT_MAGNITUDE_SPECTRUM;
    argf[2] = 0.f;
    argf[3] = 0.f;

    xtract[XTRACT_MEAN]((void *)&vector, N, 0, (void *)&mean);
    __android_log_print(ANDROID_LOG_DEBUG, "LIbXtract", "Button pushe2");
} 
```

我有扁平结构：

*   jni/com_androidnative1_NativeClass.c
*   jni/com_androidnative1_NativeClass.hjni/libxtract.h
*   来自 libxtract 接口的 jni/其他 *.h 文件
*   jni/Android.mk
*   jni/应用程序.mk

库 libxtract.so 我放在 mainproject/lib 文件夹中

我的 Android.mk 文件如下所示：

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_SRC_FILES := com_androidnative1_NativeClass.c 
LOCAL_MODULE := com_androidnative1_NativeClass
LOCAL_EXPORT_C_INCLUDES := $(LOCAL_PATH)/
LOCAL_LDLIBS += -llog
LOCAL_SHARE_LIBRARIES := libxtract
NDK_MODULE_PATH += $(LOCAL_PATH)/../lib/
include $(BUILD_SHARED_LIBRARY) 
```

我仍然得到错误：

```
Compile thumb  : com_androidnative1_NativeClass <= com_androidnative1_NativeClass.c
SharedLibrary  : libcom_androidnative1_NativeClass.so./obj/local/armeabi/objs/com_androidnative1_NativeClass/com_androidnative1_Nativ    eClass.o: In function `Java_com_androidnative1_NativeClass_showText':
/home/jack/Projects/AndroidNative1/jni/com_androidnative1_NativeClass.c:20: undefined reference to `xtract'
collect2: ld returned 1 exit status
make: *** [obj/local/armeabi/libcom_androidnative1_NativeClass.so] Error 1 
```

代码来自 LibXtract 的示例，在 C++ 下编译没有问题，有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T09:47:40.197

您的 Android make 文件应该是...

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LIB_PATH := $(LOCAL_PATH)/../lib
LOCAL_SRC_FILES := com_androidnative1_NativeClass.c 
LOCAL_MODULE := com_androidnative1_NativeClass
LOCAL_LDLIBS += -llog 
```

**LOCAL_LDLIBS += $(LIB_PATH) -lxtract**

```
LOCAL_SHARE_LIBRARIES := libxtract
include $(BUILD_SHARED_LIBRARY) 
```

在您的第二个项目中尝试这个 make 文件，您可以成功构建代码而不会出现任何错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-03T10:25:43.477

在上面的答案中，一切都是正确的，但除了一个。

当我们要链接 lib 时，我们必须`add -L`在`LOCAL_LDLIBS`dir 之前，如下所示。

```
LIB_PATH := $(LOCAL_PATH)/../lib

LOCAL_LDLIBS += **-L**$(LIB_PATH) -lxtract 
```

否则它会给出如下错误

> 无法打开 XXX/../lib：权限被拒绝

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-04T06:17:54.683

您需要告诉 Android NDK 构建脚本您的共享库。检查`${NDK}/doc/PREBUILTS.html`说明如何做到这一点。他们建议`Android.mk`在您拥有的同一目录中添加`libXtract.so`：

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE := libXtract
LOCAL_SRC_FILES := libXtract.so
include $(PREBUILT_SHARED_LIBRARY) 
```

调试提示：我猜您正在使用`ndk-build`构建您的“第二个项目”。尝试运行`ndk-build`（`V=99`尝试`V=99 ndk-build`或`ndk-build V=99`- 我的记忆失败）。这将向您显示确切的失败链接命令。您可能应该有选项`-lXtract`和`-L/path/to/libXtract/library`. （有时在实际修复构建设置之前，只需复制并粘贴链接命令以手动运行它以找到成功链接的正确选项很方便。）

**更新：**我现在看到@codetiger 的评论似乎指向了同样的答案（没有提到很好读的 NDK 文档——所以我没有删除这个答案）。

# twitter - 从 Twitter 关注按钮中隐藏“关注者”一词

> ID：10874352
> 
> 赞同：9
> 
> 时间：2012-06-03T22:17:05.580
> 
> 标签：twitter, twitter-button

有没有办法修改 Twitter 的“关注”按钮以在气泡中显示关注者的数量但隐藏“关注者”一词？我基本上希望我的“关注”按钮看起来与“推特”按钮相同。

当前代码如下所示：

```
<a href="https://twitter.com/User" class="twitter-follow-button" data-show-count="true" 
data-show-screen-name="false" data-dnt="true">Follow @User</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id))
{js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";
fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-26T07:33:32.520

我遇到了同样的问题并通过基本上隐藏“追随者”这个词并在气泡中创建一个假的右边缘来解决它，如果这有意义的话。因此，您必须将按钮包装在其自己的 div 中，然后隐藏该 div 的溢出并将宽度设置为单词消失的确切点，并将高度精确设置为您正在使用的按钮的高度。这是一个代码示例：

```
#titter-div {
    border-radius: 4px; /* to mimic the curved edges of the count box */
    border-right: 1px solid #AAAAAA; /* this is the width and color of the count box border */
    height: 20px; /* this height works for the medium button */
    width: 88px; /* precise width to hide the word */
    overflow: hidden; /* actually hides the word */
} 
```

这对我来说可以准确地创建您正在寻找的东西。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-15T06:52:21.470

要在气泡中显示关注者的数量但隐藏“关注者”一词，这是我使用 iframe 的代码：

```
<iframe
  src="//platform.twitter.com/widgets/follow_button.html?screen_name=Vacance_Luberon&show_screen_name=false"
  style="width: 88px; height: 20px;"
  allowtransparency="true"
  frameborder="0"
  scrolling="no">
</iframe>
```

# html - 如何用按钮在画布上绘制正方形

> ID：10874353
> 
> 赞同：1
> 
> 时间：2012-06-03T22:17:07.900
> 
> 标签：html, button, draw

我知道如何画一个正方形，但是我怎样才能让它只在我点击“画正方形”按钮时才绘制呢？另外，我知道要制作一个按钮 ( `<p><button onclick="rect();">Rectangle</button></p>`)，但是如何将其链接到 javascript？任何帮助都将不胜感激......

HTML5：

* * *

```
<canvas id="canvas" width="500" height="500"></canvas> 
```

* * *

JAVASCRIPT：

* * *

```
<script type="text/javascript">
var canvas = document.getElementById('canvas'),
    ctx = canvas.getContext('2d'),
    rect = {},
    drag = false;

    function init() {
  canvas.addEventListener('mousedown', mouseDown, false);
  canvas.addEventListener('mouseup', mouseUp, false);
  canvas.addEventListener('mousemove', mouseMove, false);
}

function mouseDown(e) {
  rect.startX = e.pageX - this.offsetLeft;
  rect.startY = e.pageY - this.offsetTop;
  drag = true;
}

function mouseUp() {
  drag = false;
}

function mouseMove(e) {
  if (drag) {
    rect.w = (e.pageX - this.offsetLeft) - rect.startX;
    rect.h = (e.pageY - this.offsetTop) - rect.startY ;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    draw();
  }
}

function draw() {
  ctx.fillRect(rect.startX, rect.startY, rect.w, rect.h);
}

init();
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:23:55.073

好吧，您实际上已经通过指定其“onclick”属性将您的按钮链接到一个 javascript 函数。

现在你只需要在`rect()`你的 js 中添加一个函数来绘制一个矩形。

# ruby - 在 Ruby 中反转哈希

> ID：10874356
> 
> 赞同：33
> 
> 时间：2012-06-03T22:17:57.577
> 
> 标签：ruby, hashmap

我将如何反转散列中的元素，保持相同的值和键，但反转它们在散列中的顺序。

像这样：

```
{ "4" => "happiness", "10" => "cool", "lala" => "54", "1" => "spider" } 
```

并将其转换为：

```
{ "1" => "spider", "lala" => "54", "10" => "cool", "4" => "happiness" } 
```

或者，也许我可以`each`向后运行一个循环，从哈希中的最后一个元素开始，而不是第一个？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-06-03T22:21:55.447

您可以将哈希转换为数组，将其反转，然后将其转换回哈希：

```
reversed_h = Hash[h.to_a.reverse] 
```

[`Hash#to_a`](http://ruby-doc.org/core/Hash.html#method-i-to_a)给你一个数组数组，内部数组是简单的`[key,value]`对，然后你使用 反转该数组[`Array#reverse`](http://ruby-doc.org/core/Array.html#method-i-reverse)，[`Hash[]`](http://ruby-doc.org/core/Hash.html#method-c-5B-5D)并将`[key,value]`对转换回哈希。

Ruby 2.1 添加了一个[`Array#to_h`](http://ruby-doc.org/core/Array.html#method-i-to_h)方法，因此您现在可以说：

```
reversed_h = h.to_a.reverse.to_h 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-08-16T10:10:20.070

在 Ruby 2.1+ 中，您可以组合[`reverse_each`](http://ruby-doc.org/core-2.2.2/Enumerable.html#method-i-reverse_each)和[`to_h`](http://ruby-doc.org/core-2.2.2/Enumerable.html#method-i-to_h)：

```
{foo: 1, bar: 2}.reverse_each.to_h
#=> {:bar=>2, :foo=>1} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-03T22:22:10.860

```
hash = { "4" => "happiness", "10" => "cool", "lala" => "54", "1" => "spider" }
reversed_hash = Hash[hash.to_a.reverse] 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-03T23:05:47.283

```
h = { "4" => "happiness", "10" => "cool", "lala" => "54", "1" => "spider" }
p Hash[h.reverse_each.map{|e| e}]
#=> {"1"=>"spider", "lala"=>"54", "10"=>"cool", "4"=>"happiness"} 
```

但这会留下不好的味道（就像其他答案一样，就像这个答案一样）。如果您必须这样做，则可能表明哈希不是最佳选择。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-06-27T13:34:43.140

在纯红宝石中，您可以通过`hash.map(&:reverse).to_h`或`hash.reverse_each.to_h`

在rails中，您可以通过`hash.invert`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-16T02:32:30.933

```
reversed_h = Hash[h.to_a.collect(&:reverse)] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-03T22:42:31.043

或者，您可以使用`reduce`and`merge`将项目添加到新哈希的前面：

```
hash = { "4" => "happiness", "10" => "cool", "lala" => "54", "1" => "spider" }
hash.reduce({}){ |memo, object| Hash[*object].merge(memo) } 
```

但是，这太疯狂了：D

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-01T00:49:39.550

在[Ruby 1.8.7](http://www.ruby-doc.org/core-1.8.7/Hash.html)中，哈希中元素的顺序被记录为不受我们控制，因此上述方法都不起作用。在[Ruby 1.9.3](http://www.ruby-doc.org/core-1.9.3/Hash.html)中，一切正常并以其他答案所依赖的方式记录下来。

```
$ irb1.8
h = { "4" => "幸福", "10" => "酷", "lala" => "54", "1" => "蜘蛛" }
哈希[h.to_a().reverse()]
=> {“拉拉”=>“54”，“1”=>“蜘蛛”，“10”=>“酷”，“4”=>“幸福”}
退出
$ irb1.9.1
h = { "4" => "幸福", "10" => "酷", "lala" => "54", "1" => "蜘蛛" }
哈希[h.to_a().reverse()]
=>{“1”=>“蜘蛛”、“拉拉”=>“54”、“10”=>“酷”、“4”=>“幸福”}

```

Ruby 1.8.7 的方式对我来说根深蒂固，以至于我误解了这个问题很长一段时间。我认为它需要一种方法来[Hash#invert](http://www.ruby-doc.org/core-1.9.3/Hash.html#method-i-invert)：即转换散列以使范围映射到域。该方法丢弃重复项。Luís Ramalho 提供了一种没有[的方法](http://www.luisramalho.com/how-to-invert-a-hash-in-ruby-and-not-overwriting-repeated-keys)，但它有点笨拙。这有点短：

```
$ irb
def invertWithDuplicates（原始）
  逆 = Hash.new() { |散列，键| 哈希[键] = []; }
  original.each_pair() { |键，值| 逆[值].push(key); }
  返回逆
结尾
h = { “4” => “幸福”, “10” => “酷”, “拉拉” => “54”, “1” => “酷” }
invertWithDuplicates(h)
=> {"幸福"=>["4"], "酷"=>["1", "10"], "54"=>["拉拉"]}

```

很抱歉偏离了 OP 的预期主题，尽管我认为这确实符合帖子的标题“Reverse a hash in Ruby”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-02-07T19:24:29.693

如果需要：

```
hash = {:a => :x, :b => :y, :c => :y, :d => :z} 
```

至：

```
{:x => [:a], :y => [:b, c], :z => [:d] } 
```

能够：

```
h={};hash.to_a.each{|e|h[e[1]]||=[];h[e[1]]<<e[0]};h 
```

# sql - 分组和外部应用不起作用

> ID：10874357
> 
> 赞同：0
> 
> 时间：2012-06-03T22:18:03.863
> 
> 标签：sql, sql-server-2008, group-by

在以下查询中，我想进行一些分组但不想包含一些字段：

```
SELECT C.id_credito, SUM(M.monto), M.fecha_mov, ISNULL(tg.nombre, tp.NombComp) AS Acreditados
FROM movimientos AS M
JOIN acreditados AS A ON A.id_acreditado = M.id_acreditado
JOIN creditos AS C ON C.id_credito = A.id_credito
JOIN cargos AS CA ON CA.id_movimiento = M.id_movimiento
OUTER APPLY (SELECT TOP 1 G.nombre FROM grupos G JOIN agrupaciones AG on AG.id_grupo = G.id_grupo WHERE AG.id_acreditado = A.id_acreditado) tg
OUTER APPLY (SELECT TOP 1 P.nombres+' '+P.apellido_paterno+' '+P.apellido_materno AS NombComp  FROM personas P WHERE P.id_persona = A.id_persona) tp
WHERE M.tipo_mov = 0 AND M.fecha_mov < DATEADD(day, 14, GETDATE()) AND CA.tipo_cargo = 0
GROUP BY C.id_credito, M.fecha_mov 
```

我不想包含的字段是 tg.nombre 和 tp.NombComp，因为当我包含它们时，这些字段没有正确分组。但是，如果我不将它们放在 GROUP BY 子句中，我会收到以下错误：

*列 'tp.NombComp' 在选择列表中无效，因为它不包含在聚合函数或 GROUP BY 子句中。*

你能帮我吗？我正在使用 SQL Server 2008 Express

编辑：我将展示一些示例，如果从查询中删除“ISNULL(tg.nombre, tp.NombComp) AS Acreditados”，则分组工作正常，因为您可以通过 id_credito 和 fecha_mov 看到第一组

```
id_credito monto fecha_mov
84 1875.00 2012-06-07
89 1875.00 2012-06-11
94 739.58 2012-06-11
85 2338.00 2012-06-14
......

```

但是如果我将前面的字段添加到 GROUP BY 子句中，则分组不会按预期工作。

```
SELECT C.id_credito, SUM(M.monto), M.fecha_mov, ISNULL(tg.nombre, tp.NombComp) AS Acreditados
FROM movimientos AS M
JOIN acreditados AS A ON A.id_acreditado = M.id_acreditado
JOIN creditos AS C ON C.id_credito = A.id_credito
JOIN cargos AS CA ON CA.id_movimiento = M.id_movimiento
OUTER APPLY (SELECT TOP 1 G.nombre FROM grupos G JOIN agrupaciones AG on AG.id_grupo = G.id_grupo WHERE AG.id_acreditado = A.id_acreditado) tg
OUTER APPLY (SELECT TOP 1 P.nombres+' '+P.apellido_paterno+' '+P.apellido_materno AS NombComp  FROM personas P WHERE P.id_persona = A.id_persona) tp
WHERE M.tipo_mov = 0 AND M.fecha_mov < DATEADD(day, 14, GETDATE()) AND CA.tipo_cargo = 0
GROUP BY C.id_credito, M.fecha_mov, tg.nombre, tp.NombComp 
```

```
id_credito monto fecha_mov
84 625.00 2012-06-07 波利托斯
84 729.17 2012-06-07 波利托斯
84 520.83 2012-06-07 波利托斯
85 584.50 2012-06-14 阿库纳
85 584.50 2012-06-14 阿库纳
85 584.50 2012-06-14 阿库纳
85 584.50 2012-06-14 阿库纳
86 584.50 2012-06-14 Estrellas de Cuatro Vientos
86 584.50 2012-06-14 Estrellas de Cuatro Vientos
86 584.50 2012-06-14 Estrellas de Cuatro Vientos
86 584.50 2012-06-14 Estrellas de Cuatro Vientos
...

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:11:57.307

尝试这个

```
 SELECT C.id_credito, SUM(M.monto), M.fecha_mov,  
  ISNULL(min(tg.nombre),min(tp.NombComp)) AS Acreditados
  .
  . 
  .
  GROUP BY C.id_credito, M.fecha_mov 
```

# r - 确定数据输入的重要子组

> ID：10874358
> 
> 赞同：1
> 
> 时间：2012-06-03T22:18:30.990
> 
> 标签：r, machine-learning

我有一个大 (10000 X 5001) 表，代表 10000 个样本和这些样本的 5001 个不同特征。这些特征之一代表每个样本的输出变量。换句话说，每个样本有 5000 个输入变量和一个输出变量。

我知道这些输入中的大多数都是无关紧要的。因此，我想做的是确定最能预测输出变量的输入变量子集。在 R 中执行此操作的最佳/最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T22:26:10.717

您可能需要主成分分析 (stats::prcomp) 或线性判别分析 (MASS::lda)。

请参阅 Avril Coghlan 的这份文件

[http://little-book-of-r-for-multivariate-analysis.readthedocs.org/en/latest/](http://little-book-of-r-for-multivariate-analysis.readthedocs.org/en/latest/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T22:46:21.853

您可能想查看[Weka](http://www.cs.waikato.ac.nz/ml/weka/)。在`Explorer`加载数据然后转到`Select attributes`选项卡。在那里，您将找到几个选项来获取数据集中信息最多的属性/特征。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T00:33:34.593

与其采用“随机”建议，不如前往 [CRAN 任务视图进行聚类分析和有限混合模型](http://cran.r-project.org/web/views/Cluster.html)？

# javascript - 尝试将 WebGL 纹理清除为纯色

> ID：10874359
> 
> 赞同：2
> 
> 时间：2012-06-03T22:18:37.230
> 
> 标签：javascript, webgl

我有一系列纹理堆叠在一起（使用 mip-map-style 分辨率金字塔）以达到最终图像。

由于它们的堆叠方式，当它们没有被有意义的图像数据填充时，有必要将它们初始化为无符号整数值 128。IE，128 为零，因为渲染着色器将从每个纹理值中减去 0.5，这允许后续的金字塔层将最终图像偏移正值或负值。

我似乎无法弄清楚如何将（单通道 GL_LUMINANCE）纹理初始化为一个值！

我尝试将其设置为渲染缓冲区目标并向其渲染多边形，但 FBO 似乎被标记为不完整。我也尝试将其定位为渲染缓冲区目标并使用 gl.clear(gl.COLOR_BUFFER_BIT) 但它再次被认为是不完整的。

显而易见的事情是使用 gl.texSubImage2D() 复制值，但这似乎真的很慢......也许这是唯一的方法？我希望有一些更优雅的东西，它不需要分配这么多内存（至少一个帧的单个值的价值）并且如此缓慢（因为当所有数据都是单个值时，必须将所有数据写入缓冲区）。

在 WebGL 中将纹理设置为（默认）值的唯一方法似乎是调整它的大小或分配它，这会将其设置为全零。

此外，似乎没有像 gl.SIGNED_BYTE 这样的复制模式允许零为零（IE，有符号值进来）......但这也不能解决将纹理初始化为单个的问题值（在本例中为零）。

有任何想法吗？除了简单地将值复制到其中之外，如何将 WebGL 纹理初始化为一个值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T06:46:28.120

不幸的是，WebGL 所基于的 OpenGL ES 2.0 规范不能保证能够渲染到特定类型的纹理。判断它是否有效的唯一方法是创建纹理，将其附加到帧缓冲区，然后调用 checkFramebufferStatus 并查看它是否返回 FRAMEBUFFER_COMPLETE。不幸的是，在很多情况下它不会。

只有 3 种附件组合才能保证有效

*   COLOR_ATTACHMENT0 = RGBA/UNSIGNED_BYTE 纹理
*   COLOR_ATTACHMENT0 = RGBA/UNSIGNED_BYTE 纹理 + DEPTH_ATTACHMENT = DEPTH_COMPONENT16 渲染缓冲区
*   COLOR_ATTACHMENT0 = RGBA/UNSIGNED_BYTE 纹理 + DEPTH_STENCIL_ATTACHMENT = DEPTH_STENCIL 渲染缓冲区

所以你的选择是

1.  使用 RGBA 纹理并渲染 128,128,128,??? 在 fbo（或 gl.clear it）中对其进行处理

2.  使用 LUMINANCE 纹理并调用 texImage2D

3.  使用 LUMINANCE 纹理并使用 backbuffer 调用 copyTexImage2D 或将正确大小的 fbo 清除为您想要的颜色（尽管不能保证这是快速的 AFAIK）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-28T07:42:50.810

根据我的经验（主要是在 OSX 中使用 Chrome），使用 Canvas 初始化纹理很快。我猜是因为浏览器分配 Canvas 并在 GPU 上全部绘制，并且其 WebGL 实现使用与 Canvas 相同的 GL 上下文，因此没有巨大的 CPU 到 GPU 内存传输。

```
 // Quickly init texture to (128,128,128)
        var canvas = this._canvas = document.createElement("canvas");
        canvas.width = wTex;
        canvas.height = hTex;
        var ctx = this._ctx = canvas.getContext("2d");
        ctx.fillStyle = "#808080";
        ctx.fillRect(0, 0, wTex, hTex);
        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, canvas); 
```

# elasticsearch - ElasticSearch 返回所有文档

> ID：10874360
> 
> 赞同：0
> 
> 时间：2012-06-03T22:18:53.300
> 
> 标签：elasticsearch

这是我发送给 ElasticSearch 的查询：

```
http://localhost:9200/user-index/user/_search/?queryb%5Bname%5D=Richard 
```

返回的 JSON 是这样的：

```
{
  "hits": [
    {
      "_index": "user-index",
      "_type": "user",
      "_id": "WgrvE-DzQJminNreBIsRNA",
      "_score": 1.0,
      "_source": {
        "name": "Richard",
        "db_id": "7"
      }
    },
    {
      "_index": "user-index",
      "_type": "user",
      "_id": "GwMOuYbUR8y48RrG4HgXdg",
      "_score": 1.0,
      "_source": {
        "name": "John",
        "db_id": "8"
      }
    },
    {
      "_index": "user-index",
      "_type": "user",
      "_id": "C-bgK3pNTNiX9Cz0x8EftA",
      "_score": 1.0,
      "_source": {
        "name": "Harold",
        "db_id": "2"
      }
    }
  ]
} 
```

只有其中一个真正匹配。为什么要把他们都送回去？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:47:35.440

Elasticsearch 在索引 user-index 中返回所有类型为 user 的记录，因为它找不到搜索查询。搜索查询应指定为[参数“q”](http://www.elasticsearch.org/guide/reference/api/search/uri-request.html)中的查询字符串或[请求正文](http://www.elasticsearch.org/guide/reference/api/search/request-body.html)。

尝试`http://localhost:9200/user-index/user/_search?q=name%3ARichard`

# php - 如何在 Wordpress 中获取页面的长度？

> ID：10874365
> 
> 赞同：0
> 
> 时间：2012-06-03T22:19:05.307
> 
> 标签：php, wordpress, wordpress-theming

我刚开始做一些 Wordpress 主题编码。

我想在我的主题中集成一个功能，该功能根据我的页面条目（内容）的长度集成另一个元素。

这个想法是说

```
if( div with content >= 310 px ) {
  <div id="">
  </div>
} 
```

有没有办法做到这一点？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:25:17.853

如果您[集成了 jQuery](http://www.youtube.com/watch?v=ZAIjzUkWX8s&feature=fvwrel)，则可以使用

```
$('#div_to_check').height(); 
```

或整个文档

```
$(document).height(); 
```

如同

```
<script> 
    if( $('#div_to_check').height() >= 310) {    
        document.write('<div id=""></div>');
    }
</script> 
```

因为您的页面内容很可能是可变的，所以您需要在页面完成加载后检查高度，所以我肯定会通过 Javascript 执行此操作，而不是尝试使用 PHP。

# php - htaccess 到具有不同名称/变量组合的 php

> ID：10874368
> 
> 赞同：0
> 
> 时间：2012-06-03T22:19:31.780
> 
> 标签：php, .htaccess

我有很棒的 php 但我想将它从显示变量更改为看起来像 dirs

例如：

`example.com/?mode=page&page=15`至`example.com/page/15`

和

`example.com/?mode=pic&picid=136`至`example.com/pic/136`

但是我只知道一种方法，例如：

`RewriteRule ^(.*)$ index.php?mode=$1&page [R]`

但这仅适用于一种情况，否则为404s

我尝试使用`RewriteRule ^(.*)$ index.php?url=$1 [L,QSA]`以使整个路径通过。但是，这种方式似乎没有在我的页面中传递 CSS。

我特别迷茫...

这是我的 htaccess 文件

```
# Do not remove this line, otherwise mod_rewrite rules will stop working
RewriteBase /

IndexIgnore *

RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l
RewriteCond %{REQUEST_URI} !^css/styles\.css$

RewriteRule ^(.*)$ index.php?url=$1 [L,QSA] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T22:58:22.120

问题是您将所有网址重写为

```
index.php?url= 
```

因此，您的 CSS 文件也会“重定向”到“index.php?url=”，例如

```
index.php?url=css/styles.css 
```

因此，您需要在 .htaccess 中添加“条件”，以便某些文件（或目录）不会被“重定向”。您可以通过在“RewriteRule”之前使用“RewriteCond”（条件）来做到这一点。

例如不“重定向”你可以做的css文件“css/styles.css”

```
RewriteCond %{REQUEST_URI} !^css/styles\.css$
RewriteRule ^(.*)$ index.php?url=$1 [L,QSA] 
```

# ios - UILocalNotification 询问用户权限

> ID：10874373
> 
> 赞同：2
> 
> 时间：2012-06-03T22:21:19.797
> 
> 标签：ios, uilocalnotification

我在我的应用程序中使用 UILocalNotification 但它被拒绝了，因为我没有征求用户的同意。

“5.3：未经用户同意就发送推送通知的应用程序将被拒绝”

我见过很多应用程序不询问用户。我认为这只需要远程推送通知吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T01:37:01.350

这不会违反任何 Apple 规定。我只能想象两个原因：

1.  这是Apple的一个错误。

2.  您的本地通知专门做一些用户应该批准的事情。编辑：现在我知道他们做了什么，只要确保你告诉你的用户你会每周收到一次警报。甚至可以先让他们同意（例如，让他们在设置中检查的选项）。虽然没有告诉他们应该仍然在规则之内，但它确保了苹果没有理由拒绝它。

无论哪种方式，您都应该明确地向 Apple 提出上诉，并提醒他们您使用的是本地通知，而不是推送通知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T01:09:57.010

这很奇怪。我会对拒绝提出上诉，并提醒他们您没有使用推送通知。此外，请仔细检查您的代码以确保您没有引用任何推送通知然后忘记它们。

# c - 将未知大小的矩阵引用传递给 ac 函数

> ID：10874374
> 
> 赞同：1
> 
> 时间：2012-06-03T22:21:26.280
> 
> 标签：c

我是 C 新手（但在经历了一些成长的痛苦之后开始喜欢它），但我在发送矩阵时遇到了一些麻烦。我开始在我的主要功能中构建所有东西，并且它起作用了。我创建了这样的列表：`int list[sizeOfBuckets][30];`然后添加数据，当我想阅读它时，我做了这样的事情：

```
 int x;
    int xx;
    for (x=0;x<sizeof(current_list) / sizeof(current_list[0]); x++) {
        printf("we are in the list \n");
        for (xx=0;xx<sizeof(current_list[x]) / sizeof(current_list[x][0]); xx++) {
            printf("item: %i \n", current_list[x][xx]);
        } 
    } 
```

它工作得很好，它会给我矩阵的内容。但现在我想将它发送到一个函数，但我遇到了问题。我做了一些阅读并了解到矩阵与发送数组不同，因为 C 需要事先知道尺寸，但由于我将动态更改，我创建了两个变量来监视两者的大小并将它们发送到数组（在我的测试我验证它们是正确的，列表是列表`[2][30]`）。这是我的功能：

```
void process_list(int **current_list, int num_of_rows, int num_items_in_row) {
    printf("hello from function \n");
    //test the list
    int x;
    int xx;
    for (x=0;x<num_of_rows; x++) {
        printf("we are in the list \n");
        for (xx=0;xx<num_items_in_row; xx++) {
            printf("item: %i \n", current_list[x][xx]);
        } 
    }
} 
```

它对我不起作用。它只是打印出来`we are in the list`，而不是我所期望的实际项目（来自下面的 for 循环）。当我使用 GCC 编译时，我收到以下警告：

```
./learningC.c: In function ‘main’:
./learningC.c:169: warning: passing argument 1 of ‘process_list’ from incompatible pointer type 
```

我想知道我做错了什么？如果有帮助，我不需要修改数组，我只需要将内容发送到函数，然后我的函数将输出不同的结果。

更新：这是我要发送的矩阵：

```
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 4],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 4],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 2, 4], 
```

这是预期的结果：

```
hello from function 
we are in the list 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 2 
item: 2 
item: 2 
item: 4 
we are in the list 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 1 
item: 1 
item: 2 
item: 2 
item: 4 
we are in the list 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 0 
item: 1 
item: 2 
item: 1 
item: 2 
item: 4 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T23:08:46.993

如果你有一个现代 C 编译器，从 C99 开始，你可以像这样传递一个可变长度的矩阵（技术术语是“VLA”）

```
void process_list(size_t num_of_rows, size_t num_items_in_row, int current_list[num_of_rows][num_items_in_row]) {
... access the elements as current_list[i][j] here ...
} 
```

只需注意您在数组之前有大小，以便在数组参数的声明中知道它们。

顺便说一句，您尝试这样做`**`是不正确的。2D 矩阵和指针数组确实是不同的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T22:26:34.653

n 维数组仍然是一维内存空间的数组。所以只使用一个指针，而不是指向指针的指针。

```
void process_list(int *current_list, int num_of_rows, int num_items_in_row) {
    printf("hello from function \n");
    //test the list
    int x;
    int xx;
    for (x=0;x<num_of_rows; x++) {
        printf("we are in the list \n");
        for (xx=0;xx<num_items_in_row; xx++) {
            printf("item: %i \n", current_list[x*num_items_in_row + xx]); % previously it was x*num_of_rows + xx
        } 
    }
} 
```

我还改变了访问元素的方式。现在你必须像这样调用函数：

```
process_list(*current_list,3,3); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-03T22:57:57.923

有很多方法可以传递二维数组。我将首先介绍其中的一些示例，然后指出您代码中的基本错误：

```
/*
 * Array with empty first dimension.
 * Note the y value passed is redundant in this case.
 */
void process_matrix(int matrix[][4], int x, int y)
{
    for(int i = 0; i < x; i++) {
        for(int j = 0; j < y; j++) {
            printf("[%d][%d] = %d\n", i, j, matrix[i][j]);
        }

        puts("");
    }
} 
```

该函数接收一个第一维为空的数组。这允许传入您声明的未知大小。`y`在这种情况下，这是多余的，因为我们可以使用诸如`ARRAY_SIZE`.

```
/*
 * Pointer to array with explicitly specified second dimension.
 * Again the y value passed is redundant in this case.
 */
void process_matrix2(int (* matrix)[4], int x, int y)
{
    for(int i = 0; i < x; i++) {
        for(int j = 0; j < y; j++) {
            printf("[%d][%d] = %d\n", i, j, matrix[i][j]);
        }

        puts("");
    }
} 
```

这是一个指向明确指定第二维的数组的指针。请注意在这种情况下非常重要的括号。没有括号的相同代码仍然是有效的 C 但意味着完全不同的东西。通过与上述类似的参数，`y`参数是多余的。

```
/*
 * Both dimensions known.
 * Note the x and y value passed are both redundant in this case.
 */
void process_matrix3(int matrix[2][4], int x, int y)
{
    for(int i = 0; i < x; i++) {
        for(int j = 0; j < y; j++) {
            printf("[%d][%d] = %d\n", i, j, matrix[i][j]);
        }

        puts("");
    }
} 
```

此案例可能不适用于您，但出于完整性考虑。如果两个维度都已知，则可以将它们指定为函数原型的一部分。通过与上述类似的论点，`x`这里`y`是多余的。

上面的函数可以用这段代码测试（确保用 编译`-std=c99`）：

```
#include <stdlib.h>
#include <stdio.h>

int main(void)
{
    int matrix[2][4] = {{1,2,3,4}, {8,7,6,5}};

    process_matrix(matrix, 2, 4);
    process_matrix2(matrix, 2, 4);
    process_matrix3(matrix, 2, 4);
    process_matrix4(matrix, 2, 4);
    return EXIT_SUCCESS;
} 
```

回到您的原始代码，您遇到的问题是双指针不能用作二维数组。引用[这篇文章](http://www.ibiblio.org/pub/languages/fortran/append-c.html)，你当然应该阅读：

> ...声明：“int **mat”然后将“mat”用作二维数组是错误的。这是两种截然不同的数据类型，使用它们可以访问内存中的不同位置。在一台好的机器（例如 VAX/VMS）上，这个错误会以“内存访问冲突”错误中止程序。
> 
> 这个错误很常见，因为很容易忘记衰减约定不能递归（多次）应用于同一个数组，因此二维数组不等同于双指针。“指向 T 指针的指针”不能用作“T 的二维数组”。二维数组“等价于”“指向 T 行的指针”，这与“指向 T 的指针”非常不同。

这篇文章展示了一些我没有展示的传递 2D 数组的方法，例如通过展平数组来实现，这是[Seçkin Savaşçı](https://stackoverflow.com/a/10874415/712358)试图展示的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-03T22:58:18.973

C 中静态分配的多维数组和动态分配的多维数组之间有一些细微的区别，我不确定我是否准确地记住了它们。也就是说，我认为矩阵的正确类型实际上是指向一维 30 元素整数数组的指针。尝试将您的函数声明更改为：`void process_list(int current_list[][30], int num_of_rows, int num_items_in_row)`，或者也许`void process_list(int *current_list[30], int num_of_rows, int num_items_in_row)`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T21:12:29.573

我完全赞成将静态数组视为对象与指针。但是，在涉及对现有代码的补救措施的情况下，可以[小心地]应用一些 C 转换技巧。

在将静态数组传递给 process_list 函数的原始示例中，可以这样做：

```
int **arrptr;
int static_arr[3][4] = {...};  /* init static array */
...
*arrptr = (int *)&static_arr;    /* put the static_arr address into arrptr */

process_list(arrptr, num_rows,num_cols); 
```

这有效地将静态数组视为经过 malloc 处理，即指针 arrptr 包含对 static_arr 内存地址的*引用*，而不是在编译时分配的实际地址。

注意：我不提倡这种技术，如果在代码中应用，应该提供一些关于演员意图的评论。否则，有人可能会在不知不觉中尝试“释放”此类指针，以及范围问题等。

# javascript - Phonegap 文件系统“未定义”

> ID：10874381
> 
> 赞同：0
> 
> 时间：2012-06-03T22:22:12.957
> 
> 标签：javascript, ios, cordova, filesystems, fileapi

我有在 iOS 上运行的移动网络应用程序。我运行从远程服务器提供的 JS 代码。在其中，我调用了 window.requestFileSystem，它的评估结果为“未定义”。

但是，当从捆绑的 .html 文件（位于 xcode 项目的 www 文件夹中）评估它时，它是定义的。

如何从远程 JS 代码访问 Phonegap 文件系统 API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T13:54:45.563

几件事-

1.  这将不会被应用商店接受，因为苹果不喜欢下载可执行代码的应用。

2.  您无法运行此代码的原因是因为它稍后会被加载——理论上这不应该是一个问题，但我会把钱放在这样一个事实上，即即使它有正确的调用，它也没有被计算在内作为您实际应用程序的一部分。

# php - 如何从多维数组转换为一维数组？

> ID：10874384
> 
> 赞同：1
> 
> 时间：2012-06-03T22:22:38.940
> 
> 标签：php

我的脚本返回了以下数组。

```
Array
(
    [0] => Array
        (
            [id] => 67
        )

    [1] => Array
        (
            [id] => 68
        )

    [2] => Array
        (
            [id] => 69
        )

    [3] => Array
        (
            [id] => 70
        )

) 
```

我怎样才能将其转换为：

```
Array
(
    [0] => 67

    [1] => 68

    [2] => 69

    [3] => 70
) 
```

我只对返回的 ID 感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:25:32.813

[`array_map()`](http://us3.php.net/manual/en/function.array-map.php)是一种可能性，因为它将回调返回的任何值累积到其返回的数组中。然后回调只需要返回`id`：

```
$flat = array_map(function($a) {return $a['id'];}, $orig_array); 
```

以上需要 PHP 5.3+，因为它使用匿名函数，但同样可以通过将命名函数作为字符串传递给`array_map()`.

否则，`foreach`循环是非常传统的，并且可以保留原始密钥，然后是非连续的。

```
$flat = array();
foreach ($orig_array as $key => $a) {
  $flat[$key] = $a['id'];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T22:26:19.367

我没有测试过这个功能，但试试这个建议：[http ://www.php.net/manual/en/function.array-values.php#104184](http://www.php.net/manual/en/function.array-values.php#104184)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T22:28:17.893

```
$temp = call_user_func_array('array_merge_recursive', $arr);
$final = $temp['id'];
print_r($final); 
```

为什么这很棘手。老实说，只需使用 foreach 循环。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-03T22:28:24.683

继续[@Mickael 的回答](https://stackoverflow.com/a/10874403/1249581)，您还可以使用[`array_walk()`](http://php.net/manual/en/function.array-walk.php)函数：

```
function format(&$item, $key) {
    $item = $item["id"];
}

array_walk($arr, "format"); 
```

或者在一行中使用 lambda 函数：

```
array_walk($arr, create_function('&$item, $key', '$item = $item["id"];')); 
```

它直接与您的数组一起使用，因此我们可以轻松地将其称为“数组转换”。

# python - Python列表错误还是我错了？

> ID：10874386
> 
> 赞同：2
> 
> 时间：2012-06-03T22:22:54.617
> 
> 标签：python, list

我已经构建了一个 3 级嵌套列表

```
#run on Python 3.2.3  32 bit on Win 7
L2=list(0 for i in range(2))
L3=list(L2 for i in range(3))
L4=list(L3 for i in range(4))
#give a new value to the very first number in list:
L4[0][0][0]=5
print("L4:")
print(L4)
#outputs erronously:
#[[[5, 0], [5, 0], [5, 0]], [[5, 0], [5, 0], [5, 0]], [[5, 0], [5, 0], [5, 0]], [[5, 0], [5, 0], [5, 0]]] 
```

明确给出的相同列表

```
#the same L4 given explicitly:
anotherL4=[[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]]
print("anotherL4:")
#give a new value to the very first number:
anotherL4[0][0][0]=5
print(anotherL4)
#outputs correctly:
#[[[5, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:24:00.283

你错了。您已多次复制引用，这意味着它们实际上都是相同的列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T22:25:37.323

当您编写 时`list(L3 for i in range(4))`，您是在告诉它在生成器理解的每次迭代中产生相同的列表 L3。当您随后修改该列表时，修改会随处显示，因为它们都是对同一个列表的引用。

你可以通过做得到你想要的效果

```
list(list(L3) for i in range(4)) 
```

因为 using`list(L3)`创建了一个新列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T22:25:51.237

只是为了详细说明，

```
a = 1
b = 2
c = [a,b]
a += 1
print c 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T22:46:20.590

您的问题是您构建了*列表引用列表*而不是列表列表。由于所有引用都指向单个列表，因此当您更改该单个列表时，所有引用都会显示更改。

```
L0 = range(3)
L1 = range(3)

print(id(L0)) # prints a number
print(id(L1)) # prints a different number
print(id(L0) == id(L1))  # prints False

print(L0 is L1)  # prints False; not same objects
print(L0 == L1)  # prints True; values match

# your original code:
L2=list(0 for i in range(2))
L3=list(L2 for i in range(3))
L4=list(L3 for i in range(4))

print(L3[0] is L2)  # prints True; L3[0] is a reference to L2 
```

我们可以修复它并通过使用明确显示我们在做什么`copy.deepcopy()`：

```
import copy

L2 = [0 for i in range(2)]
L3 = [copy.deepcopy(L2) for i in range(3)]
L4 = [copy.deepcopy(L3) for i in range(4)]
#give a new value to the very first number in list:
L4[0][0][0]=5
print("L4:")
print(L4) 
```

请注意，我没有创建生成器表达式并将其传递给以`list()`强制将其扩展为列表，而是在上面的代码中使用列表推导直接生成列表。

更常见的是，如果你想做这个疯狂的事情，你应该只嵌套一些列表推导：

```
L4 = [[[0 for _ in range(2)] for _ in range(3)] for _ in range(4)] 
```

这清楚地表明我们正在构建一个新的列表列表。如果你使用`copy.deepcopy()`你基本上只是复制一堆零，所以你不妨只使用零构建新列表。

# asp.net - rowcommand 在第一次不起作用

> ID：10874387
> 
> 赞同：0
> 
> 时间：2012-06-03T22:23:09.207
> 
> 标签：asp.net, gridview, rowcommand

我在行命令中有一个很大的错误。我有一个命令名为“add”的按钮字段。当我单击它时，代码不会第一次触发，但再次单击它，代码就会触发！

```
if (e.CommandName == "add")
{
 DataClassesDataContext db = new DataClassesDataContext();
 int ii = int.Parse(e.CommandArgument.ToString());
 int num = int.Parse(((TextBox)GridView1.Rows[ii].FindControl("TextBox2")).Text);
       string id = GridView1.Rows[ii].Cells[0].Text;
                    temp t = new temp();
                    t.tedad = num;
                    t.username = Session["username"].ToString();
                    db.temps.InsertOnSubmit(t);
                    db.SubmitChanges();
} 
```

第一次单击时，rowcommand 不会触发！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T05:44:20.717

您应该在回发时将数据源绑定到 Gridview。

```
protected void Page_Load(object sender, EventArgs e)
{
  if (!IsPostBack)
  {
    GridView1.Datasource = DataTable1;
    GridView1.DataBind();
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T23:34:25.630

我发现了问题，我使用`GridView_RowCreated`的是导致问题的，而不是我使用`GridView_RowDataBound`的为我解决了问题。

或检查您是否将数据网格绑定在不回发中。

# macos - 使用 Mac 以编程方式发送电子邮件

> ID：10874397
> 
> 赞同：2
> 
> 时间：2012-06-03T22:24:36.543
> 
> 标签：macos, email, automation

我的 Mac 有 Lion OS X 10.7.4 和 Xcode 4.3.2。

我希望能够以编程方式发送电子邮件（即无需人工干预）。这些（最新）环境的推荐方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:28:44.133

我听说过[关于 EDMessage 框架的](http://www.mulle-kybernetik.com/software/EDFrameworks/)好消息。

您也可以使用 Applescript 或 Python。 [Peter Hosey 在他对这个非常相关的问题的回答中对此进行了发布](https://stackoverflow.com/questions/1619731/send-email-through-a-cocoa-application)。

# c++ - FillConsoleOutputCharacter/WriteConsoleOutput 和特殊字符

> ID：10874401
> 
> 赞同：1
> 
> 时间：2012-06-03T22:24:58.690
> 
> 标签：c++, windows, visual-studio, console

我正在搞乱一些本机 Windows 控制台功能，并且对它们的速度印象深刻，如果不是它们的易用性的话。

反正我早就知道下面的代码会产生一些有趣的字符

```
for(int i = 0; i < 256; i++)
{
    cout << char(i) << endl;
} 
```

但是，我无法让 FillConsoleOutputCharacter 或 WriteConsoleOutput 生成所有这些字符（许多只是显示为问号）。

这是我正在使用的代码示例：

```
COORD spot = {0,0};
HANDLE hOut = GetStdHandle(STD_OUTPUT_HANDLE);
DWORD Written;

for(int i = 0; i < 256; i++)
{
    FillConsoleOutputAttribute(hOut, 7, 1, spot, &Written);
    FillConsoleOutputCharacterW(hOut, char(i), 1, spot, &Written);

    spot.Y++;
} 
```

有谁知道用本机函数编​​写这些字符的相对方便的方法？

顺便说一句，我在 Windows 7 x64 上使用 Visual Studio 2010。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T00:13:10.693

尝试使用 FillConsoleOutputCharacterA 而不是使用 unicode 字符的 FillConsoleOutputCharacterW，这可能需要一些知识才能正确获取。

*编辑*我尝试使用 FillConsoleOutputCharacterA，它为您的第一个案例提供了等效的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T00:19:13.393

[`FillConsoleOutputCharacterA`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682663%28v=vs.85%29.aspx)应该写入与 cout 函数相同的字符集。这些字符由控制台的当前代码页确定。

使用 FillConsoleOutputCharacterW，您仍然可以生成所有相同的字符（以及可能包含在控制台字体中的任何其他字符），但您需要对这些字符使用[Unicode](http://en.wikipedia.org/wiki/Unicode_plane)（16 位）代码，而不是 8 位与 cout 一起使用的代码。

请注意，Windows 内部使用过时版本的 Unicode，字符限制为 16 位 (0-65536)，而不是使用 0-1,112,063 的 Unicode 本身（尽管这些代码中的大多数仍未分配）。我相信控制台的 Unicode 字符集对应于 Unicode 的平面 0，基本的多语言平面。

当您编写控制字符或当前字体中未包含的字符时，会出现问号。

# c++ - 输入结束时预期的“}”

> ID：10874407
> 
> 赞同：-6
> 
> 时间：2012-06-03T22:25:40.460
> 
> 标签：c++, c

无论我尝试什么，我都会不断收到这五个错误。我只是看不出有什么问题。也知道为什么同样的错误会出现三次吗？

62：错误：在 ';' 之前需要 ')' 令牌

62：错误：预期的';' 在 ')' 标记之前

84：错误：输入结束时预期的“}”

84：错误：输入结束时预期的“}”

84：错误：输入结束时预期的“}”

```
int isRegistered(FILE* fp, const char str[], char area[], char publisher[], char title[])
{
int areaa = 0;
int publc = 0;
int i = 0;
int j = 0;

  if(isValid(str))
  {
     if(fp)
     {
        for(; i < 5 && !areaa; i)
        {
           area[i] = str[i];
           area[i + 1] = '\0';
           if (isRegistered(fp, atoi(area)))
              areaa = 1;
           else
              areaa = 0;
        }
           cout << minNoDigits(fp, atoi(area)) << endl;
              int k = i;
                 for(; i < k; minNoDigits(fp, atoi(area)) && !publc; i , j)
                 {
                    if (str[i] == '0')
                    {
                       publisher[j] = str[i];}
                       publisher[j + 1] = '\0';
                    }
                       cout << publisher[j] <<endl;
                       && strlen(publisher) == minNoDigits(fp, atoi(area))
                          if(isRegistered(fp, atoi(area), publisher) && strlen(publisher) >= minNoDigits(fp, atoi(area)))
                               publc = 1;
                            else
                               publc = 0;
                 }
                    for(j = 0; i < 9; i, j)
                    {
                       title[j] = str[i];
                       title[j + 1] = '\0';
                    }
       }
    }
    return publc;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-03T22:28:39.123

`publisher[j] = str[i];}`- 在此处删除右括号

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-03T22:29:11.307

这条线看起来根本不对

```
 for(; i < k; minNoDigits(fp, atoi(area)) && !publc; i , j) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-03T22:32:31.930

你有这一行：

```
&& strlen(publisher) == minNoDigits(fp, atoi(area)) 
```

看起来未完成。

# php - 从另一个表中选择服务器名称

> ID：10874410
> 
> 赞同：0
> 
> 时间：2012-06-03T22:25:58.897
> 
> 标签：php, mysql, sql, codeigniter, join

我有两张桌子，`files`和`servers`。这是架构：

```
f_id, s_id, u_id, name, size, downloads, uploaded

s_id, name, description, disk_space, used_space, enabled 
```

现在，我正在尝试获取有关特定文件以及它托管在哪个服务器上的一些信息。在`files`表中，这是由`s_id`列确定的，列是表的外键`servers`。我想检索文件名、大小、上传时间以及它所在的服务器。我试过这个：

```
public function get_file_details()
{
    $sql= 'SELECT name, size, uploaded, server
           FROM `files` f
           JOIN `servers` s
           ON f.s_id = s.u_id
           WHERE f_id = ?
           LIMIT 1';
} 
```

但它不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:33:44.837

```
public function get_file_details()
{
    $sql= 'SELECT f.name, size, uploaded, s.name
           FROM `files` f
           JOIN `servers` s
           ON f.s_id = s.s_id
           WHERE f_id = ?
           LIMIT 1';
} 
```

3 处更改：name => f.name，server => s.name，ON f.s_id = s.u_id => ON f.s_id = s.s_id

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T05:09:20.797

它显示此错误，因为两个表中都存在名称字段，因此它变得模棱两可。为避免此错误，请始终添加表名别名试试这个

```
SELECT f.name, f.size, f.uploaded, s.name
           FROM `files` f
           JOIN `servers` s ON f.s_id = s.s_id
           WHERE f_id = ?
           LIMIT 1' 
```

# huffman-code - 计算霍夫曼码方差

> ID：10874414
> 
> 赞同：2
> 
> 时间：2012-06-03T22:26:25.173
> 
> 标签：huffman-code, variance

我有一个硬件问题，涉及我改变打破平局的方式，然后要求我计算方差（权重是概率）。我想知道是否有人知道如何计算方差。问题的主要内容并没有围绕这个方面，所以无论谁否定这个问题......非常感谢

这是问题所在：

出于数据传输的目的，通常需要具有码字长度的最小方差的码（在相同平均长度的码中）。计算两个霍夫曼码中码字长度的平均值（考虑概率）和方差，这两个霍夫曼码是由以下数据在霍夫曼码构造期间不同的平局中断引起的：

字符 ABCDE

概率 0.1 0.1 0.2 0.2 0.4

我实际上发现我的平均值不同......这似乎不正确

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T04:34:34.133

通过选择不同组的相同最低概率组进行组合，您可以提出三种不同的位长度分配。它们都是最优的，因为它们都给出了完全相同的每个符号的平均比特。然而，这三个不同的代码每个都有不同的比特长度范围，并且会有不同的变化（带有'a'）。

方差计算为平均比特长度与每个符号的比特长度之差的平方，然后是这些概率的加权和。

（注意：您的问题仍然不清楚，因为“我想知道是否有人知道如何做到这一点。”可能是指改变平局，计算方差，或两者兼而有之。也不清楚哪个方面是“这方面”。您应该多考虑一下您的阐述，尤其是“this”的模棱两可的用法。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T23:07:41.710

看来他们只是想以不同的方式解决关系，以显示 condength 的平均值和方差如何取决于关系的解决方式。我只是编造了两种不同的方式来解决优先问题。

# javascript - chrome.webRequest API，捕获 POST 数据？

> ID：10874417
> 
> 赞同：1
> 
> 时间：2012-06-03T22:26:42.480
> 
> 标签：javascript, google-chrome-extension

我刚刚开始使用 chrome.* API 开发 Google Chrome 扩展程序。我正在尝试分析来自浏览器的传出请求。如果我在我的 background.html 中运行它：

```
chrome.webRequest.onBeforeSendHeaders.addListener(
        function (details) {            
            if (details.method == "POST") {
                alert(JSON.stringify(details)); 
            }
        },
        { urls: ["<all_urls>"]}
    ); 
```

我收到每个请求的通知，但似乎我无权访问 http post 参数。我通过附加的内容脚本获取这些参数，但不能通过 chrome.webRequest 对象访问这些参数吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T15:32:11.520

这现在可以在 Chrome 的开发分支上使用。您可以通过检查 chrome.webRequest 对象的 requestBody 来访问发布数据。谷歌需要参与者通过下面的链接提交他们的工作扩展，然后才能将其推入测试版并最终发布稳定版。

更多详细信息可在上述 URL 中找到： [http ://code.google.com/p/chromium/issues/detail?id=91191](http://code.google.com/p/chromium/issues/detail?id=91191)

和谷歌开发者文档：http: [//developer.chrome.com/trunk/extensions/webRequest.html](http://developer.chrome.com/trunk/extensions/webRequest.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T09:54:20.467

目前这是不可能的，您可以监控[这个 Chromium 问题](http://code.google.com/p/chromium/issues/detail?id=91191)以获取更新（单击右上角的星号以获取电子邮件通知）。

# android - heroku POST 重定向丢失数据

> ID：10874421
> 
> 赞同：0
> 
> 时间：2012-06-03T22:27:18.377
> 
> 标签：android, django, heroku, http-post

从一个 android 应用程序我将数据发布到 Heroku django 解决方案。

但是 django 应用程序没有收到任何数据。

使用 curl（insteat android 应用程序）测试我记录了这个日志：

```
dani@heroku-test:~/tmp$ curl -vd '[{"lat ____some data ___ adf"}]'  \
                        http://myApp.heroku.com/x/receive_JSON/ 

* About to connect() to myApp.heroku.com port 80 (#0)
*   Trying 107.21.106.77... connected
> POST /x/receive_JSON/ HTTP/1.1
> User-Agent: curl/7.22.0 (i686-pc-linux-gnu) 
 libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3
> Host: myApp.heroku.com
> Accept: */*
> Content-Length: 296                 <---- OK!!!
> Content-Type: application/x-www-form-urlencoded
> 
* upload completely sent off: 296out of 296 bytes
< HTTP/1.1 301 Moved Permanently
< Server: nginx
< Date: Sun, 03 Jun 2012 22:15:13 GMT
< Connection: keep-alive
< Location: http://myApp.herokuapp.com/x/receive_JSON/
< Content-Length: 0                     <-----KO!!!!!!!!!!!!!!!!!!!!!!!!!!
< 
* Connection #0 to host myApp.heroku.com left intact
* Closing connection #0 
```

似乎是重定向的问题，似乎 curl (android) 在重定向操作后不发送 POST 数据。

我该如何解决此问题或可能有什么解决方法？

我的 Django 视图来测试接收到的数据：

```
@csrf_exempt    
def receive_JSON(request ):

    return HttpResponse("Rebut: {0}".format( len( request.raw_post_data ) ) ) 
```

要发送数据，我使用[How to send a JSON object over Request with Android？](https://stackoverflow.com/questions/3027066/how-to-send-a-json-object-over-request-with-android) （还有 httpost.setHeader("Content-type", "application/json"); ）

注意：这在本地使用 runserver 可以正常工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T22:49:04.387

解决了将 url 更改为正确位置的问题：

```
http://myApp.herokuapp.com 
```

反而

```
http://myApp.heroku.com 
```

# c# - 如何使用 XNA 在 Visual Studio 中回收代码？

> ID：10874423
> 
> 赞同：1
> 
> 时间：2012-06-03T22:27:52.063
> 
> 标签：c#, visual-studio-2010

我对 C# 和 Visual Studio 都比较陌生，使用 XNA Game Studio。我要做的就是从当前项目中获取一些包含 .cs 文件的文件夹，并在新项目中使用这些文件，但事实证明它比我习惯使用 Flash/ActionScript 时要复杂一些。

目前，我似乎需要一遍又一遍地使用这个过程，直到我想要的所有文件都是当前项目的一部分：

![在此处输入图像描述](../Images/f297ab93bc8a4aaf19bcf1e3dde72234.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T01:01:41.510

有几种方法可以满足您的要求。一种是将要重用的类编译到类库项目中，然后在新项目中添加对该类库的引用。

另一种方法是，如果您只想在新项目中复制文件本身，则在上面的菜单中使用 Add > Existing Item。然后，在出现的对话框中找到要添加到项目中的文件，一切就绪。

我建议，如果这些是不会在每个项目的基础上修改的通用类，那么您使用类库选项，而不仅仅是复制您的代码文件。

**编辑：**

为了清楚起见，在 Visual Studio > 文件菜单 > 添加项目 > 类库项目中将其命名为 Common。然后创建一个类，例如 MartysHelper，并在这个类中放置一个名为 Public String HelloWorld() 的方法并编译。然后右键单击 Gamer1 项目并选择 Add Reference > Projects > 选择 Common 项目。现在在 Game1 和/或任何其他项目中，您可以`re-use`使用 Common.MartysHelper 类。

# python - 可以在定义中更改函数名称吗？

> ID：10874432
> 
> 赞同：10
> 
> 时间：2012-06-03T22:28:31.323
> 
> 标签：python, function, attributes

我尝试了几种方法来更改定义中的函数名称，但都失败了。

```
>>> def f():
        pass
>>> f.__name__
'f'
>>> def f():
        f.__name__ = 'new name'
>>> f.__name__
'f'
>>> def f():
        self.__name__ = 'new name'
>>> f.__name__
'f' 
```

但是我可以在定义后更改名称属性。

```
>>> def f():
        pass
>>> f.__name__ = 'new name'
>>> f.__name__
'new name' 
```

有什么方法可以在定义中更改/设置它（除了使用装饰器）？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-03T22:35:53.800

在您执行函数之前，不会执行函数体。你可以使用装饰器：

```
def rename(newname):
    def decorator(f):
        f.__name__ = newname
        return f
    return decorator 
```

然后像这样使用它：

```
@rename('new name')
def f():
    pass
print f.__name__ 
```

但是，该功能仍然只能作为`f`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T22:31:08.793

不。最接近这一点的是定义一个可调用类，每个实例都`__name__`在初始化程序中设置了它的集合。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-03T22:32:02.360

在调用函数之前，函数体不会执行，因此您无法使用函数体来更改定义时发生的情况。你为什么要这样做呢？如果您正在编写函数并希望它具有不同的名称，只需使用不同的名称定义它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T22:44:00.763

如果你把它放在函数体中，你说的是**执行**的一部分是把`f`它的名字设置为`'new name'`. 显然，在调用函数之前，这不会做任何事情。

使用装饰器**是**声明函数与`def`单独的块稍有不同的规范方式，并且您不会找到更好的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-03T22:53:53.667

这可能很愚蠢，但有点工作？

```
>>> f = None
>>> def new_name():
    global f
    f = new_name

>>> new_name()
>>> f
<function new_name at 0x01945108>
>>> f.__name__
'new_name' 
```

# c - 对于 ANSI C 中的特殊应用，case 语句或函数指针数组是否更快？

> ID：10874436
> 
> 赞同：4
> 
> 时间：2012-06-03T22:28:45.880
> 
> 标签：c, switch-statement, function-pointers

在 ANSI C 程序中，以某种随机顺序对 10 个具有相同调用列表和返回值的函数进行 50 到 500 次连续调用，这些调用将被执行数千甚至数百万次。函数调用的实际数量及其执行顺序由启动时的随机输入数据确定，但不会在执行间隔内发生变化。

关于 switch 语句或函数指针数组是否会更快似乎有些混淆。虽然函数调用的初始数量及其调用顺序最初在设置时是随机的，但它们将在整个程序执行过程中保持不变。这种情况下是否有任何特性可以使一种方法比另一种更好，并且是否有特定的编译器设置或指令可以帮助编译器识别这种特殊情况以提高一种方法或另一种方法的性能？在 XCode 中使用 GCC 编译器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T23:03:54.187

如果你的功能比 switch 耗时长，优化 switch 也没关系。测量，测量，测量。

如果与开关相比，这些函数需要更短的时间，您可以在通过数组的间接函数调用的几乎确定的管道中断之间进行选择（CPU 预测这些非常糟糕[但请阅读您的汇编语言手册关于间接跳转]），或者（如果编码良好）在 10 个左右的函数中进行二分搜索（3-4 个分支，其中任何一个都会导致管道中断）。CPU 中的分支预测器将尝试根据实际统计信息猜测正确的分支方向；对于常见情况，它可能会将误预测率降至零。如果顺序只是“有点”随机，您可以确定哪些调用频率最高，并构建一个区分网络（霍夫曼树），将选择偏向最高概率函数，然后是下一个，等等，

我怀疑如果您将函数体内联到循环内的开关中，您会做得更好。做得对，您将不会有任何显式的参数传递，这将有助于缩短执行时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T22:33:01.557

这取决于您的编译器、体系结构，可能还取决于调用签名。这听起来像是即时编译的一个很好的用例（生成一些源代码，调用`gcc`并`ld`在其上，`dlopen`生成的 .so 文件`dlsym`，和调用）。

# objective-c - 请解释类方法

> ID：10874438
> 
> 赞同：0
> 
> 时间：2012-06-03T22:29:20.877
> 
> 标签：objective-c, ios5, xcode4

我发现很难理解何时需要创建类方法。根据我的阅读，它们对于创建新对象很重要，但我不知道如何。下面的类创建一个简单的形状黑色矩形。谁能告诉我如何合并一个类方法来做一些我不能用实例方法做的事情？

形状.h

```
#import <UIKit/UIKit.h>
@interface Shape : UIView; 
- (id) initWithX: (int)xVal andY: (int)yVal;
@end 
```

形状.m

```
#import "Shape.h"
@implementation Shape 
- (id) initWithX:(int )xVal andY:(int)yVal {
self = [super init];    
UIView *shape = [[UIView alloc] initWithFrame:CGRectMake(xVal, yVal, 10, 10)];
shape.backgroundColor = [UIColor blackColor];
[self addSubview:shape];
return self;
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:13:16.480

类方法：

*   没有实例时可以调用（还）
*   不在实例上操作（除非作为参数传入或由方法创建），因此无权访问任何特定实例的实例变量。
*   可以在子类中被覆盖，不像一个简单的函数（否则匹配前面的点）

正如其他人所指出的，我相信您一直都在使用类方法。如果没有别的，那么`+alloc`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T23:13:22.580

类方法只是不需要对象的方法。因此，任何不使用其对象的实例方法都可以是类方法。唯一必须使用类方法的情况是必须在没有对象的情况下调用方法。`alloc`是一个很好的例子：它创建对象并返回它，所以根据定义，当它被调用时没有对象。

我对类方法的另一种用途（在嵌入式系统中的 C++ 中，所以我没有要显示的代码）是让一个类保留其所有对象的双向链表。（这对于调试转储很有用；在嵌入式开发中，您的调试工具通常只是某种`printf`.）

该类有两个成员，它们是指向列表的第一个和最后一个元素的指针，构造函数和析构函数从列表中插入和删除一个对象。访问第一个和最后一个对象的函数是类方法，因为当您想要遍历对象列表但还没有对象时调用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T23:16:26.757

类方法有多种用途：

*   正如您所听说的，它们对于创建新对象至关重要。创建对象是一个两步过程：首先，使用类方法为对象分配内存**，**`+alloc` **然后**使用通常以. 该方法必须是类方法，因为您没有可以调用它的实例；你只知道类名。该方法应该是一个实例方法，因为返回一个实例，您要初始化该实例唯一的属性，而不是整个类。因此，您在上面的代码中使用了一个类方法，然后是一个实例方法： **`-init``+alloc``-init``+alloc``UIView *shape = [[UIView alloc] initWithFrame:CGRectMake(xVal, yVal, 10, 10)];`**

***   类方法对于检索单例或类的共享实例很有用。例如，`NSUserDefaults`该类存储与您的应用相关的首选项和设置。在大多数情况下，人们喜欢为他们的整个应用程序使用一组首选项，因此它有一个类方法`+standardUserDefaults`，它返回一个实例`NSUserDefaults`，每个人都可以在应用程序生命周期的任何时候使用该实例来获取与应用程序相关的所有首选项. 如果没有那个单例和类方法，您将不得不在`NSUserDefaults`整个应用程序中创建并传递一个实例，这会变得混乱。其他示例包括`+[UIDevice currentDevice]`和`+[NSFileManager defaultManager]`。

    *   类方法非常适合返回类的所有实例共享的数据或属性。例如，`UIView`有一个类方法`+layerClass`返回视图所承载的层类型。由于特定`UIView`子类的所有实例都使用相同类型的层，因此它与单个实例无关，因此作为类方法是有意义的。

    *   你会看到很多被称为“便利方法”的类方法。`+alloc`这些方法（通常）结合了对和`-init`返回类的自动释放实例的调用。例如，您可以通过书写`[NSArray arrayWithObjects:...]`而不是`[[[NSArray alloc] initWithObjects:...] autorelease]`. 如果您使用 ARC，这些便利方法的用处不大，但它们在 Cocoa 中仍然无处不在。

    *   类方法有时也用于实用程序类，或者没有状态的类，只有一堆方法可以接收它们需要的所有参数。例如，您可能有一个类似`+[PhoneUtilities parseAreaCodeFromPhoneNumber:string]`. Cocoa 内置的这些方法并不多。有些人争辩说，最好让它们成为常规的 C 函数、单例或带有实例方法的常规 Objective-C 类。** 

 **我敢肯定还有更多，但这应该会给你一些想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T22:36:07.497

我的回答是，当您需要执行一些实用功能/方法并且*不需要*对某些特定实例或对象执行操作时，类方法非常有用。

例如，在我自己的代码中，我通常在类中执行类方法，无论我可能在哪个对象上调用该方法，结果都是相同的。喜欢：

例如

```
@interface MyAppCacheFiles
    + (NSURL *) getFileURLOfLocalCache;
@end 
```

这些也可以被认为是方便的方法（例如，很像`NSString +stringWithFormat:`or `NSArray +arrayWithArray:`）。**

# javascript - 是否可以使用 Channel API 从另一个域连接到我的 App Engine

> ID：10874441
> 
> 赞同：3
> 
> 时间：2012-06-03T22:29:49.810
> 
> 标签：javascript, google-app-engine, cross-domain, channel-api

我希望使用 Channel 从我的站点到 App Engine 的后端进行跨域通信。这可能吗？如果可以，怎么办？因为 Javascript API 中没有 domain 参数

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T01:22:06.170

是的，你可以......我自己做这个。您不需要做任何花哨的事情，只需包含来自 app-engine 应用程序域的 /_ah/channel/jsapi 脚本，它应该可以工作

示例：来自[http://mysite.com/index.html](http://mysite.com/index.html)

```
<head>
    <script language="javascript" type="text/javascript" src="http://myapp.appspot.com/_ah/channel/jsapi"></script>
</head> 
```

然后正常使用 Channel API [https://developers.google.com/appengine/docs/python/channel/javascript](https://developers.google.com/appengine/docs/python/channel/javascript)

# facebook - Facebook 未加载元或链接标签

> ID：10874442
> 
> 赞同：2
> 
> 时间：2012-06-03T22:29:55.923
> 
> 标签：facebook, facebook-like, thumbnails, title, meta-tags

点击赞按钮时，Facebook 不显示标题、描述或缩略图。谢谢您的帮助！

在头部：

```
<link rel="image_src" href="http://www.rockomole.com/2012/blog/2012/may/03.jpg" />
<meta name="description" content="TEST PILOT: description">
<meta name="title" content="TEST PILOT: title"> 
```

[关联](http://www.rockomole.com/2012/blog/2012/may/03.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:39:58.300

您需要做的是为 Facebook 添加适当的 OG 标头以正常工作，您可以在此处获取所有信息[https://developers.facebook.com/docs/opengraphprotocol](https://developers.facebook.com/docs/opengraphprotocol)

为了让您开始在您的页面上添加以下标题：

```
<meta property="og:title" content="TEST PILOT: test"/>
<meta property="og:url" content="[YOUR URL]"/>
<meta property="og:description" content="TEST PILOT: description"/>
<meta property="og:image" content="http://www.rockomole.com/2012/blog/2012/may/03.jpg"/> 
```

# delphi - Delphi TidTCPServer 和 TidTCPClient 传输记录

> ID：10874447
> 
> 赞同：7
> 
> 时间：2012-06-03T22:30:52.373
> 
> 标签：delphi, indy

我需要帮助来了解如何通过 Indy TCP Server/Client 传输记录。我有 2 个程序，在我放置客户端和在另一台服务器中。在客户端上的按钮上我放置连接：客户端是 TIdTCPClient

```
Client.Connect(); 
```

在服务器端，我在 ServerConnect 事件中添加了一条客户端已连接的备忘录

```
Protocol.Lines.Add(TimeToStr(Time)+' connected '); 
```

要从客户端发送数据，我有一条记录，我想发送：

```
Tmyrecord = record
IPStr: string[15];
end; 
```

我有一个发送按钮：

```
procedure Tform1.ButtonSendClick(Sender: TObject);
  var
  MIRec: Tmyrecord;
 msRecInfo: TMemoryStream;
 begin
   MIRec.IPStr := '172.0.0.1';
   msRecInfo := TMemoryStream.Create;
   msRecInfo.Write(MIRec, SizeOf(MIRec));
    msRecInfo.Position := 0;
   Client.IOHandler.Write(msRecInfo);
 end; 
```

在服务器端 onexecute 我有以下代码，我在服务器端也声明了相同的 tmyrecord ：

```
 procedure TServerFrmMain.ServerExecute(AContext: TIdContext);
 var
  MIRec: Tmyrecord;
  msRecInfo: TMemoryStream;
 begin
 if  AContext.Connection.Connected then
  begin
    AContext.Connection.IOHandler.CheckForDataOnSource(10);
    if not AContext.Connection.IOHandler.InputBufferIsEmpty then
   begin
     msRecInfo:= TMemoryStream.Create;
       AContext.Connection.IOHandler.ReadStream(msRecInfo);
     msRecInfo.Read(MIRec, sizeOf(msRecInfo));
    ShowMessage(MIRec.IPStr);
 end;
 end;
 end 
```

我不知道为什么它不起作用，为什么我不能显示我从客户端写的 IP 地址。我想在服务器端读取我从客户端发送的记录（msRecInfo）。我想访问我的记录元素，在这种情况下，我想读取记录的 IPSTR 元素。当我从客户端按下发送按钮时，应用程序挂起，服务器部分。

非常感谢提前

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-05T00:30:56.490

你犯了一个典型的新手错误——你期望`TIdIOHandler.Write(TStream)`和`TIdIOHandler.ReadStream()`方法的默认行为相互匹配，但实际上它们并不匹配。

的默认参数值`TIdIOHandler.ReadStream()`告诉它期望一个`Integer`或`Int64`（取决于`TIdIOHandler.LargeStream`属性的值）在流数据之前指定数据的长度。

但是，默认参数值`TIdIOHandler.Write(TStream)`不会告诉它发送任何此类`Integer/Int64`值。因此，您使用`TIdIOHandler.ReadStream()`读取记录的前几个字节并将它们解释为`Integer/Int64`（`926036233`给定您要发送的字符串值），然后等待那么多字节到达，这永远不会因此`TIdIOHandler.ReadStream()`不会退出（除非您将`TIdIOHandler.ReadTimeout`属性设置为非无限值）。

您的代码中还有一些其他小错误/错别字使用了`TMemoryStream`Indy 之外的对象。

试试这个：

```
procedure Tform1.ButtonSendClick(Sender: TObject); 
var 
  MIRec: Tmyrecord; 
  msRecInfo: TMemoryStream; 
begin 
  MIRec.IPStr := '172.0.0.1'; 
  msRecInfo := TMemoryStream.Create; 
  try
    msRecInfo.Write(MIRec, SizeOf(MIRec)); 

    // writes the stream size then writes the stream data
    Client.IOHandler.Write(msRecInfo, 0, True);
  finally
    msRecInfo.Free;
  end;
end; 

procedure TServerFrmMain.ServerExecute(AContext: TIdContext); 
var 
  MIRec: Tmyrecord; 
  msRecInfo: TMemoryStream; 
begin 
  msRecInfo := TMemoryStream.Create; 
  try
    // reads the stream size then reads the stream data
    AContext.Connection.IOHandler.ReadStream(msRecInfo, -1, False);

    msRecInfo.Position := 0;
    msRecInfo.Read(MIRec, SizeOf(MIRec)); 
    ...
  finally
    msRecInfo.Free;
  end;
end; 
```

或这个：

```
procedure Tform1.ButtonSendClick(Sender: TObject); 
var 
  MIRec: Tmyrecord; 
  msRecInfo: TMemoryStream; 
begin 
  MIRec.IPStr := '172.0.0.1'; 
  msRecInfo := TMemoryStream.Create; 
  try
    msRecInfo.Write(MIRec, SizeOf(MIRec)); 

    // does not write the stream size, just the stream data
    Client.IOHandler.Write(msRecInfo, 0, False); 
  finally
    msRecInfo.Free;
  end;
end; 

procedure TServerFrmMain.ServerExecute(AContext: TIdContext); 
var 
  MIRec: Tmyrecord; 
  msRecInfo: TMemoryStream; 
begin 
  msRecInfo := TMemoryStream.Create; 
  try
    // does not read the stream size, just the stream data
    AContext.Connection.IOHandler.ReadStream(msRecInfo, SizeOf(MIRec), False); 

    msRecInfo.Position := 0;
    msRecInfo.Read(MIRec, SizeOf(MIRec)); 
    ...
  finally
    msRecInfo.Free;
  end; 
end; 
```

或者，您可以使用`TIdBytes`而不是发送记录`TStream`：

```
procedure Tform1.ButtonSendClick(Sender: TObject); 
var 
  MIRec: Tmyrecord; 
  Buffer: TIdBytes;
begin 
  MIRec.IPStr := '172.0.0.1'; 
  Buffer := RawToBytes(MIRec, SizeOf(MIRec));
  Client.IOHandler.Write(Buffer); 
end; 

procedure TServerFrmMain.ServerExecute(AContext: TIdContext); 
var 
  MIRec: Tmyrecord; 
  Buffer: TIdBytes; 
begin 
  AContext.Connection.IOHandler.ReadBytes(Buffer, SizeOf(MIRec)); 
  BytesToRaw(Buffer, MIRec, SizeOf(MIRec));
  ...
end; 
```

# xaml - 是否可以在 Windows Phone 7 XAML 中创建 HTML 样式表？

> ID：10874455
> 
> 赞同：2
> 
> 时间：2012-06-03T22:32:00.510
> 
> 标签：xaml, windows-phone-7, tabular

是否可以使用 Windows Phone 7 的 XAML 创建类似于在 HTML 中可以完成的表？

我可以通过将文本块放置在某些位置来做到这一点，但这不是一个理想的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:37:19.240

> 是否可以使用 Windows Phone 7 的 XAML 创建类似于在 HTML 中可以完成的表？

当然。[网格](http://msdn.microsoft.com/en-us/library/system.windows.controls.grid%28v=vs.95%29.aspx)提供了这种抽象。它非常强大。使用 ColumnDefinition 和 RowDefinition 划分网格。[这是一个完整的例子](http://msdn.microsoft.com/en-us/library/ms745823.aspx)。

# iphone - 核心数据效率

> ID：10874456
> 
> 赞同：0
> 
> 时间：2012-06-03T22:32:01.540
> 
> 标签：iphone, core-data, processing-efficiency

将 4 种类型的属性存储到 Core Data 中的 32 位 int 中是否有点矫枉过正？或者我应该为它们中的每一个简单地创建一个单独的属性？（将使用逻辑运算符来设置/获取）。

我计划向现有对象添加一个新实体，该对象将包含 200-400 个具有大约 14 个属性的项目（包括用于排序目的的“索引”属性）。任何时候都只能操作或查看一套。

我需要维护撤消支持（参考[How do I raise performance of Core Data object insert on iPhone?](https://stackoverflow.com/questions/3559599/core-data-on-iphone-and-performance)）

如果我将多个属性存储到一个字段中，我可以将其减少到大约 8 个属性。除非存在可搜索性问题，否则我会节省大量空间吗？

此外，将一组 400 个对象存储在以每周 1-3 个左右的速度增长的项目列表中是否不合理？

我听说有些人在核心数据中存储了数千个项目，所以我可能是偏执狂。我想从长远来看，我需要提供一个导出存档选项，也许是 iCloud。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:53:05.047

所以你说你有 400 个具有 14 个属性的对象，你可以将它们存储为单独的整数，或者组合成更少的 32 位（4 字节）值？

400 x 14 x 4 字节 = 22,400 字节

这根本不是很大的空间。如果您将其减半，您将节省 11K，这可能与您为编码和解码这些值而生成的额外代码的大小相比相形见绌。

**但不要相信我的话：**编写一个将值填充到 Core Data 中的小型测试程序，然后在分析器下运行它以查看会发生什么。

您还可以阅读 SQLite 以及它如何存储值，因为这是 Core Data 在后台使用的内容。

我的直觉说你是个偏执狂，你的小玩意代码不会有太大帮助。更糟糕的是，当您忘记正在使用符号扩展进行移位时，这将是引入非常微妙的错误的好方法。（而且我喜欢写一些琐碎的代码！）

# mysql - CakePHP - 查询不从 MySQL 数据库返回奇怪的字符

> ID：10874458
> 
> 赞同：0
> 
> 时间：2012-06-03T22:32:11.447
> 
> 标签：mysql, cakephp, cakephp-2.0

我有一个国家/地区的 MySQL 表，其中包括一些具有奇怪字符的国家/地区名称，例如“奥兰群岛”。

当我在所有国家/地区执行 CakePHP 查找时，带有奇怪字符的行只是空白。我的表和列排序规则是 utf8_general_ci。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T22:45:48.030

确保显示的输出设置为 UTF-8 确保输入数据的页面设置为 UTF-8，这样它就不会以 ANSI 或其他形式发送数据。

您可以设置一个小测试页面，您确定要以 UTF-8 输入数据并以 UTF-8 显示，然后至少您会知道它与显示或以前的数据输入方法有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:13:11.503

答案是，正如 tigrang 所说，在 Config/database.php 你必须有 'encoding' => 'utf8'

# javascript - 使用 XSL 生成的 javascript 隐藏/显示元素

> ID：10874464
> 
> 赞同：1
> 
> 时间：2012-06-03T22:34:08.147
> 
> 标签：javascript, xml, xslt

我有一个包含一些数据的 xml 文件。我想显示数据的“扩展”视图或概览。我设法使用 XSL 显示扩展视图，并且我没有使用 javascript 来隐藏概述的一些内容。

这是我的xml文件：

```
<BS>
<project>
    <name>project1</name>
    <references id="1">
        <ref>ref1</ref>
        <ref>ref2</ref>
        <ref>ref3</ref>
    </references>

    <references id="2">
        <ref>ref4</ref>
        <ref>ref5</ref>
        <ref>ref6</ref>
    </references>

</project>
<project>
    <name>project2</name>
    <references id="1">
        <ref>ref7</ref>
        <ref>ref8</ref>
        <ref>ref9</ref>
    </references>
</project>
</BS> 
```

和我的 XSL：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<html xsl:version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns="http://www.w3.org/1999/xhtml">

<head>
<script language="javascript" type="text/javascript">

function HideClass(matchClass)
    {
    var elems = document.getElementsByTagName('*'),i;
    for (i in elems)
        {
        if((elems[i].className).indexOf(matchClass) > -1)
            {
            elems[i].style.display = 'none';
            }
        }
    }

function ShowClass(matchClass)
    {
    var elems = document.getElementsByTagName('*'),i;
    for (i in elems)
        {
        if((elems[i].className).indexOf(matchClass) > -1)
            {
            elems[i].style.display = 'block';
            }
        }
    }

function ShowOverview()
    {
    var elems = document.getElementsByTagName('*'),i;
    for (i in elems)
        {
        if((elems[i].className).indexOf('id1') > -1)
            {
            elems[i].style.display = 'block';
            }
        else
            {
            elems[i].style.display = 'none';
            }
        }
    }
</script>
 </head>        

 <body>

<xsl:for-each select="BS/project">
    <h3><xsl:attribute name="class"><xsl:value-of select="name"/>-id1</xsl:attribute>
        <xsl:value-of select="name"/>
    </h3>

    <xsl:for-each select="references">
        <div><xsl:attribute name="class"><xsl:value-of select="name"/>-id<xsl:value-of select="@id"/></xsl:attribute>

        Status: OK<br/>
        References id: <xsl:value-of select="@id"/>
        <table> 
            <xsl:for-each select="ref">
                <tr><td>
                <xsl:value-of select="text()"/>
                </td></tr> 
            </xsl:for-each> 
        </table>
        </div>
        <br/>
    </xsl:for-each>

    <!-- link Hide-->
    <xsl:element name="a">
    <xsl:attribute name="href">#</xsl:attribute>
    <xsl:attribute name="onclick">HideClass('<xsl:value-of select="name"/>');return false;</xsl:attribute>
    <i><xsl:text>Hide </xsl:text><xsl:value-of select="name"/></i>
    </xsl:element>
    <!-- end of link -->
    <br/>
    <!-- link Show-->
    <xsl:element name="a">
    <xsl:attribute name="href">#</xsl:attribute>
    <xsl:attribute name="onclick">ShowClass('<xsl:value-of select="name"/>');return false;</xsl:attribute>
    <i><xsl:text>Show </xsl:text><xsl:value-of select="name"/></i>
    </xsl:element>
    <!-- end of link -->
    <br/>

</xsl:for-each>
<hr/>
<a href="#" onclick="ShowOverview();return false;"> Show only overview</a>

</body>
</html> 
```

但它不起作用。我想在“加载页面”上显示所有内容（这是有效的！）并在单击“隐藏项目 1”时隐藏项目 1（及其所有内容）。

此外，我想显示“所有项目的概述”：

*   标题（例如 <h3> 项目 1</h3> ）
*   第一个引用（状态，ref id=1 和包含 ref 的表）

在单击“仅显示概述”时为每个项目。

但是我的 XSL 只能显示所有内容、隐藏所有内容或仅隐藏标题！？？！

您对我如何实现目标有任何想法吗？

谢谢你。

# php - POST 中 JSON/PHP 中的 & 符号

> ID：10874465
> 
> 赞同：4
> 
> 时间：2012-06-03T22:34:24.237
> 
> 标签：php, jquery, json, post, escaping

我有一个文本字段，它通过 JSON 和 jQuery（用`.toJSON`函数包装）通过 AJAX 和 POST 请求发送到我的服务器。在 PHP 方面，我正在做`json_decode`.

一切正常，但如果我将 & 号 (&) 放在里面，它会拆分 POST 参数，因此它在 PHP 端是不完整的（至少`var_dump($_POST)`是写出的内容）。

toJSON 和 json_decode 不应该完成所有工作（转义）吗？我试过了`encodeURIComponent`，`& to &amp;`但`& to \u0026`它不起作用。

我做错了什么？

AJAX 调用

```
function execute() {
    this.setupUrl();
    return $.ajax({
        type: this.requestMethod,
        data: this.getDataParams(),
        url: this.url
    });
}

function getDataParams() {
    if(this.data != undefined) {
        if(this.requestMethod == 'POST' || this.requestMethod == 'PUT') {
            return "data=" + $.toJSON(this.data);
        } else if(this.requestMethod == 'GET') {
            return this.data;
        }
    } else {
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:36:26.573

`&`应编码为`%26`. 找到这样做的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T22:37:54.487

答案很简单：使用对象`data`而不是字符串。

例如，像这样更改您的功能：

```
return {data: $.toJSON(this.data)}; 
```

无论您使用的是 POST 还是 GET，这在任何情况下都有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T22:41:42.340

你不需要“数据”的东西，因为你已经在 execute()

```
if(this.requestMethod == 'POST' || this.requestMethod == 'PUT') {
                return $.toJSON(this.data);
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-05T08:39:19.257

这很奇怪。PHP 和 JS 一起工作了很多年。没想到 php 无法解码 js 编码的内容。所以我需要一个特殊的函数来处理这个。

```
function damn_ampersand(str){
    return str.replace('&', '%26');
}
obj = {"ololo": damn_ampersand("atata & foobar")}
json = JSON.stringify(obj); 
```

# javascript - 动态onclick，带参数的匿名函数

> ID：10874470
> 
> 赞同：0
> 
> 时间：2012-06-03T22:34:47.123
> 
> 标签：javascript, jquery, function, onclick, anonymous

所以我的javascript有点生疏了..我正在尝试这样做：

```
 var images = document.getElementsByTagName("img");
        for (var i = images.length - 1; i >= 0; i--) {
            var image = images[i];
            if (image.className == "photo latest_img") {
                image.onclick = function() {
                    // here i will perform a different action depending on what image was clicked           
                    alert(image.src);
                }
            }
        }; 
```

我只是想分配一个函数处理程序，该函数应该知道单击了哪个图像。

如果我没记错的话，这是分配图像处理程序并传递该图像的引用的两步过程。

什么是最安全的跨浏览器方式来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:36:59.720

在函数内部使用`this`：

```
image.onclick = function() {
    // here i will perform a different action depending on what image was clicked           
    alert(this.src);
} 
```

# asp.net - 访问被拒绝文件上传

> ID：10874478
> 
> 赞同：0
> 
> 时间：2012-06-03T22:36:12.637
> 
> 标签：asp.net, file-upload, access-denied

当我尝试使用 ASP.NET Web API 控制器将文件上传到目录时，访问被拒绝。当我在我的 Web 窗体 Default.aspx.cs 上上传一个文件时，我没有访问问题。

我的 default.aspx 页面可以访问什么，而我的控制器没有？这两个文件具有相同的“所有者”。

我已经实现了模拟，但这并不能解决问题。

任何想法表示赞赏。

# c# - 多点之间的最短路径

> ID：10874481
> 
> 赞同：-1
> 
> 时间：2012-06-03T22:36:28.660
> 
> 标签：c#, math, geometry, 2d

我需要找到多个点之间的最短路线。假设我有这四点：

```
var startPoint = new Point(1, 1);
var pointsToGoPast = new List<Point> { new Point(3,1); new Point(2,4); };
var endPoint = new Point(10, 10); 
```

所以，我想找出首先经过哪些点，以便获得最短的路线，从 startPoint 到 endPoint。

谁能帮我？

更新：它必须经过 pointsToGoPast 列表中的每个点。每条路线的成本是均匀的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-03T22:44:41.183

您可以通过 Dijkstra 算法做到这一点。

[带有代码的示例项目here](http://www.codeproject.com/Articles/22647/Dijkstra-Shortest-Route-Calculation-Object-Oriente)

唯一需要更改的是项目中的权重，因为权重基于两点之间的距离。（因此您需要在构造函数中修改`Location`存储 a`Point`和`Connection`计算权重（距离）。

[维基百科有一篇关于算法的非常好的文章](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T23:28:24.380

[Dijkstra 算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)

```
class Dijkstra
{        
        private int rank = 0;
        private int[,] L;
        private int[] C; 
        public int[] D;
        private int trank = 0;
        public Dijkstra(int paramRank,int [,]paramArray)
        {
            L = new int[paramRank, paramRank];
            C = new int[paramRank];
            D = new int[paramRank];
            rank = paramRank;
            for (int i = 0; i < rank; i++)
            {
                for (int j = 0; j < rank; j++) {
                    L[i, j] = paramArray[i, j];
                }
            }

            for (int i = 0; i < rank; i++)
            {
                C[i] = i;
            }
            C[0] = -1;          
            for (int i = 1; i < rank; i++)
                D[i] = L[0, i];
        }
        public void DijkstraSolving()
        {            
            int minValue = Int32.MaxValue;
            int minNode = 0;
            for (int i = 0; i < rank; i++)
            {
                if (C[i] == -1)
                    continue;
                if (D[i] > 0 && D[i] < minValue)
                {
                    minValue = D[i];
                    minNode = i;
                }
            }
            C[minNode] = -1;
            for (int i = 0; i < rank; i++)
            { 
                if (L[minNode, i] < 0)
                    continue;
                if (D[i] < 0) {
                    D[i] = minValue + L[minNode, i];
                    continue;
                }
                if ((D[minNode] + L[minNode, i]) < D[i])
                    D[i] = minValue+ L[minNode, i];
            }
        }
        public void Run()
        {
            for (trank = 1; trank >rank; trank++)
            {
                DijkstraSolving();
                Console.WriteLine("iteration" + trank);
                for (int i = 0; i < rank; i++)
                    Console.Write(D[i] + " ");
                Console.WriteLine("");
                for (int i = 0; i < rank; i++)
                    Console.Write(C[i] + " ");
                Console.WriteLine("");                
            }
        }
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-29T04:05:49.250

正如已经指出的那样，从一个点到另一个点的成本是多少尚不清楚。仅仅是这些点之间的距离吗？无论如何，无论如何，这样的问题可以使用传统的线性规划来解决。我刚刚完成了一个 C# 库来简化最短路径问题。[可在此处](http://www.capricornexcel.co.uk/linear-programming-and-shortest-path-problems-in-c/)下载。

在这个库上还有更多工作要做，但它应该以一种非常简单的方式为您提供您想要的东西。

问候，

布鲁斯。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-18T09:12:17.773

有SQL server 就可以简单解决

```
select geography :: Point(@PointALatitude, @PointALongitude, 4326).STDistance(geography::Point(@PointBLatitude, @PointBLongitude, 4326)) 
```

结果以米为单位返回，因此只需除以 1000（公里）或 1609.344（英里）

# ios - UITableViewController 如何知道它的dataSource和delegate

> ID：10874482
> 
> 赞同：1
> 
> 时间：2012-06-03T22:36:43.460
> 
> 标签：ios, ios5, uitableview

我正在关注 BigNerdRanch iOS 编程书，并且我正在处理 UITableViewController 的这一章。然而，我一直想知道在哪里`UITableViewController`可以找到它的`delegate`和`dataSource`. 目前我有它作为

`@interface ItemsViewController : UITableViewController <UITableViewDataSource, UITableViewDelegate>`

但是没有任何东西看起来像：

`[self.tableView setDelegate:self]`

我只是想知道 UITableViewController 如何找到它的委托和数据源

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T22:59:38.587

如果您自己设置，则`UITableView`必须将其指向委托和数据源。

`UITableViewController`设置`UITableView`并将委托和数据源属性设置为自身。当您子类化时`UITableViewController`，您将免费获得此行为。

你的问题是有缺陷的，因为`UITableViewController`没有数据源和委托，`UITableView`它控制的是。是`UITableViewController`数据源和委托，因为它是这样设置的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T22:41:51.063

[您可以通过 Interface Builder（在 Xcode 中）或以编程方式通过“ `.delegate =`”（`[self.tableView setDelegate: _____`）](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instp/UITableView/delegate)和[“ `.datasource=`”](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instp/UITableView/dataSource)在表视图对象（在 xib 或情节提要文件中）设置委托和数据源。

请注意，您在由表视图控制器管理的表视图上设置这些内容（即两个不同的对象）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T23:43:55.180

首先声明：

```
@interface ItemsViewController : UITableViewController <UITableViewDataSource, UITableViewDelegate> 
```

**仅表明**您的 View Controller 负责提供 DataSource 和 Delegate 方法。这只是对查看您的代码的人的提示（您只是说您的视图符合该协议），并向 Xcode 提示您需要提供所需的协议实现（否则 Xcode 会给您一个警告说您没有t 实现了数据源和委托方法，并且再次仅用于必需的而非可选的方法）。

您实际上是在 Interface Builder 中设置 TableView 的数据源和委托。单击 IB 中的 TableView，从右侧窗格中选择 Outlets 选项，然后单击数据源并拖动到“文件所有者”以设置数据源。代表也一样。

如果您在代码中创建表，则需要声明数据源并自己委托，这样：

```
tableview.datasource = self;
tableview.delegate = self; 
```

# android - Android sqlite 查询字符串

> ID：10874488
> 
> 赞同：2
> 
> 时间：2012-06-03T22:37:18.807
> 
> 标签：android, sqlite

```
Cursor cursor = db.rawQuery("SELECT id,lastname FROM people WHERE lastname='John Kenedy'; ",null); 
```

比较的正确用法是`String`？如果不是，我如何比较`String`数据库中的值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-03T22:40:03.753

为了获得更好的性能，您应该使用更快、更安全的`rawQuery`方法来避免将数据直接添加到语句中。`selectionArgs`所以试试这样

```
Cursor cursor = db.rawQuery("SELECT id,lastname FROM people WHERE lastname = ?; ", new String[] {"John Kenedy"}); 
```

# python - Python代码，提取扩展

> ID：10874490
> 
> 赞同：-4
> 
> 时间：2012-06-03T22:37:40.173
> 
> 标签：python, character, file-extension

> **可能重复：**
> [在python中，如何检查文件名是否以“.html”或“_files”结尾？](https://stackoverflow.com/questions/10873777/in-python-how-can-i-check-if-a-filename-ends-in-html-or-files)

```
import os

path = '/Users/Marjan/Documents/Nothing/Costco'

print path

names = os.listdir(path)

print len(names)

for name in names:
  print name 
```

这是我一直在使用的代码，它在终端中列出了该类别中的所有名称。此文件 (Costco) 中有一些文件名没有 .html 和 _files。我需要把它们挑出来，唯一的问题是它有超过 2,500 个文件名。需要有关将通过此路径搜索并挑选出所有不以 .html 或 _files 结尾的文件名的代码的帮助。多谢你们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:39:22.410

```
for name in names:
    if filename.endswith('.html') or filename.endswith('_files'):
        continue
    #do stuff 
```

如果您需要文件的扩展名，通常[`os.path.splitext()`](http://docs.python.org/library/os.path.html#os.path.splitext)会更合适，但在这种情况下`endswith()`完全没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T22:47:13.927

比 ThiefMaster 的建议短一点：

```
for name in [x for x in names if not x.endswith(('.html', '_files'))]:
    # do stuff 
```

# iphone - iOS：当我关闭 iPhone 时，使用 Core Data 的本地存储不持久

> ID：10874493
> 
> 赞同：0
> 
> 时间：2012-06-03T22:38:16.920
> 
> 标签：iphone, sqlite, core-data, persistence, storage

我目前正在开发我的第一个 iPhone 应用程序。我使用带有 sqlite 的 Core Data 框架来持久化数据，一切正常，除了当我关闭 iPhone 时，我注意到所有保存的数据都丢失了。

那么这里有什么问题呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-04T02:11:15.617

您忘记保存 NSManagedObjectContext 的任何更改？

```
NSManagedObjectContext *managedObjectContext = ...
NSError *error = nil;
[managedObjectContext save:&error]; 
```

另外，检查 NSPersistentStoreCoordinatator 没有使用 NSInMemoryStoreType 作为存储类型。

```
// Do not use the type below
[__persistentStoreCoordinator addPersistentStoreWithType:NSInMemoryStoreType configuration:nil URL:nil options:nil error:&error] 
```

# python - 内置将函数应用于列表的连续成员并返回新列表的方法

> ID：10874495
> 
> 赞同：2
> 
> 时间：2012-06-03T22:38:36.110
> 
> 标签：python, functional-programming, python-2.7

我正在寻找python中的内置函数，它将函数应用于列表（或其他可迭代）中的每个元素和下一个元素，在新列表中返回结果集。我不知道是否内置了一个，但如果可能的话，我正试图以一种功能性的方式来解决这个问题。

例子：

```
l = [1,2,3,4,5]
# returns [3,5,7,9]
# add(1,2) add(2,3) add(3,4) add(4,5) 
```

我的实际用例是我有一个形式为 的向量列表`numpy.array([1,2,3])`，我想找出每个连续向量之间的差异。

实际示例：

```
l = [numpy.array([1,2,3]), numpy.array([2,7,6]), numpy.array([4,5,6])]
# find the difference between each vector (l[0]-l[1], l[1]-[l2], .. etc) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-03T22:40:15.150

你想要[`pairwise()`](http://docs.python.org/library/itertools.html#recipes)和`map()`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-03T22:43:12.680

最直接的方法是在列表理解中：

```
a = [l[i] + l[i+1] for i in range(len(l)-1)] 
```

或者，您可以使用一点内置魔法：

```
map(sum, zip(l, l[1:])) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-03T22:40:44.780

可以通过以下方式查找 NumPy 数组的连续条目之间的差异`numpy.diff()`：

```
>>> a = numpy.array([5, 2, 3, 1, 4])
>>> numpy.diff(a)
array([-3,  1, -2,  3]) 
```

这将比任何纯 Python 解决方案快得多。

**编辑**：这是一个二维数组的例子：

```
>>> a = numpy.array([[1,2,3], [2,7,6], [4,5,6]])
>>> numpy.diff(a, axis=0)
array([[ 1,  5,  3],
       [ 2, -2,  0]], dtype=int32) 
```

# database - asp.net code first 自动数据库更新

> ID：10874497
> 
> 赞同：0
> 
> 时间：2012-06-03T22:39:15.947
> 
> 标签：database, frameworks, entity

我正在使用 Code First Entity Framework 在 C# Asp.net 中创建一个应用程序，该应用程序将为不同的客户使用不同的数据库（换句话说，每个客户都有自己的数据库，将在第一次使用时生成）。

我试图找出一种方法来在我对对象应用更改时自动更新所有这些数据库。换句话说，我将如何在 Code First EF 中处理一个干净的系统？

*   目前，我正在使用 InitializerIfModelChange 定义一个简单的数据库，该数据库允许我在发生架构更改时测试我的应用程序。但是，这种方法会丢弃数据库，这在客户数据库的情况下显然是不可接受的。
*   我必须假设有数百名客户，因此不能手动更新所有数据库
*   我不介意编写将数据复制到新数据库中的代码。

我认为最好的解决方案是以某种方式备份数据库，然后将所有数据重新插入新创建的数据库中。更好的是一种在不删除数据库的情况下自动更新模式的方法。但是我不知道如何解决这个问题。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T20:10:03.140

Joakim 发布的链接很有帮助。它要求您更新到 EF 4.3.1（如果有其他项目，请不要忘记您在其他项目中的引用），之后您可以运行启用迁移的命令。要从代码自动更新架构，您可以使用

```
Configuration configuration = new Configuration();
DbMigrator migrator = new DbMigrator(configuration);
migrator.Update();
Database.SetInitializer<DbContext>(null); 
```

# python - 了解类变量的引用计数

> ID：10874499
> 
> 赞同：5
> 
> 时间：2012-06-03T22:39:21.177
> 
> 标签：python

这是为了更好地理解引用计数在 Python 中是如何工作的。

让我们创建一个类并实例化它。实例的引用计数将是`1`（`getrefcount`显示`2`，因为它自己的内部结构引用该类实例增加引用计数`1`）：

```
>>> from sys import getrefcount as grc
>>> class A():
    def __init__(self):
        self.x = 100000

>>> a = A()
>>> grc(a)
2 
```

`a`的内部变量`x`有`2`引用：

```
>>> grc(a.x)
3 
```

`a`我希望它被`A`'s`__init__`方法引用。然后我决定检查一下。

所以我`b`在`__main__`命名空间中创建了一个临时变量，只是为了能够访问该变量`x`。它增加了 ref-number 以`1`使其成为`3`（如预期的那样）：

```
>>> b = a.x
>>> grc(a.x)
4 
```

然后我删除了类实例，引用计数减少了`1`：

```
>>> del a
>>> grc(b)
3 
```

所以现在有`2`参考资料：一个是by `b`，一个是by `A`（如我所料）。

`A`通过从命名空间中删除，`__main__`我希望计数再次减少`1`。

```
>>> del A
>>> grc(b)
3 
```

但它不会发生。没有`A`可以引用的类或其实例`100000`，但它仍然被命名空间以外的东西`b`引用`__main__`。

所以，我的问题是，`100000`除了引用什么`b`？

* * *

**BrenBarn**建议我应该使用`object()`而不是可能存储在内部某处的数字。

```
>>> class A():
    def __init__(self):
        self.x = object()

>>> a = A()
>>> b = a.x
>>> grc(a.x)
3
>>> del a
>>> grc(b)
2 
```

删除实例后`a`，只有一个`b`非常合乎逻辑的引用。

唯一需要理解的是为什么它不是这样的 number `100000`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:48:35.057

`a.x``__init__()`是整数 10000。这个常量被 的方法对应的代码对象引用`A`。代码对象总是包含对代码中所有文字常量的引用：

```
>>> def f(): return 10000
>>> f.__code__.co_consts
(None, 10000) 
```

线

```
del A 
```

仅删除名称`A`并减少 的引用计数`A`。在 Python 3.x（但不是 2.x）中，类通常包含一些循环引用，因此只有在显式运行垃圾收集器时才会被垃圾收集。事实上，使用

```
import gc
gc.collect() 
```

after`del A`确实导致`b`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T22:46:28.747

这很可能是您使用整数作为测试值的产物。Python 有时会存储整数对象以供以后重用，因为它们是不可变的。当我使用`self.x = object()`代替运行您的代码时（它将始终为 x 创建一个全新的对象），我确实得到`grc(b)==2`了最后的结果。

# c++ - 链接器想要我已经链接的库

> ID：10874504
> 
> 赞同：0
> 
> 时间：2012-06-03T22:40:18.003
> 
> 标签：c++, linker

```
[1/2] g++ -std=gnu++11 -Wall -g -I/usr/local/include -c test.cpp -o test.o
[2/2] g++ -std=gnu++11 -L/usr/local/lib64 -Wl,-rpath,/usr/local/lib64 -glog -lfolly test.o -o hello
FAILED: g++ -std=gnu++11 -L/usr/local/lib64 -Wl,-rpath,/usr/local/lib64 -glog -lfolly test.o -o hello
/usr/bin/ld: /usr/local/lib64/libfolly.so: undefined reference to symbol '_ZN6google15LogMessageFatalD1Ev'
/usr/bin/ld: note: '_ZN6google15LogMessageFatalD1Ev' is defined in DSO /usr/local/lib64/libglog.so.0 so try adding it to the linker command line
/usr/local/lib64/libglog.so.0: could not read symbols: Invalid operation
collect2: error: ld returned 1 exit status 
```

`libglog`坐在里面`/usr/local/lib64`就像`libfolly`。由于某种原因，它在 glog 库上“无法读取符号”。为什么不？我已经尝试添加所有这些而没有更改：`-ldl -lc -lpthread -lrt` 因为我真的不知道为什么它们应该是必要的，所以我将它们从上面的输出中排除了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T22:43:37.240

你有 -glog 。它不应该是-lglog吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-17T07:01:20.480

您应该使用 -lglog。由于共享对象库名称是 libglog.so.0（检查所有 .so 的存储路径）。

# assembly - 装配中的“打印”命令

> ID：10874518
> 
> 赞同：0
> 
> 时间：2012-06-03T22:42:47.097
> 
> 标签：assembly, cpu

首先我想指出我不是母语人士，所以请不要介意我的错误:) 所以，事实上，我对一个简单的汇编命令确实有很大的问题，问题是，这个命令是与用户交互的“强大”方式。它来了：

我在 Logisim 中构建了一个 CPU（没什么特别的，我正在努力适应该程序，并且我正在努力提高我的“技能”）。有了这个，我正在用 Java 编写一个汇编翻译器（汇编输入、二进制和十六进制输出适合 CPU 的指令集）。但是我遇到了一个大问题...^^

我实际上计划添加一个 --PRINT "text"-- 命令，汇编翻译器将为每个字母生成一个 7 位 ASCII 数字并产生如下输出：

汇编输入：PRINT "hello world"

CPU 的输出

打印

打印

打印 l

打印 l

打印

打印（空格）

[...]

这是因为我的 CPU 一次只能打印一个字符 :( 好吧，在尝试执行 BRANCH 命令时会出现此问题。

例如，我的 Translator Program 中的行显示 Line: 2，在这一行中您将打印 5 个字符长的文本。因此，下一条命令将在第 3 行，但是 CPU 只打印了 5 个字符，这意味着 Programcounter 现在指向第 8 行，而 Translator 中的第 3 行实际上位于 Programcounter 的第 8 行。

我怎么能解决这个问题？添加一个特殊寄存器，在 CPU 实际执行的每个“PRINT”命令后递增，并将其添加到您要分支的行？还是有人有更好的方法将字符打印到屏幕上？

提前感谢所有答案，

销售

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T17:20:23.180

我不确定我是否理解正确。您的汇编程序有一个打印字符串宏，它扩展为几个“打印即时”指令（大概是 2 字节大小）。而且您有一条指令（有条件地）跳过下一条指令。假设这条指令称为 ez（零时执行）。所以这样的代码：

```
 ez print "Hello" 
```

将组装成类似的东西：

```
1234h ez
1235h print 'H'
1237h print 'e'
1239h print 'l'
123bh print 'l'
123dh print 'o'
123fh ... 
```

并且您希望 ez 指令自动跳过五个指令，而不仅仅是一个。正确的？实现它的一种方法可能是在打印指令中有一个位来指示未链接，因此 ez 指令可以继续跳过指令，直到缺少该位。但是恕我直言，这对于 CPU 设计来说似乎有点太复杂了。我认为期望程序员知道打印字符串会生成几条指令并要求他们编写是合理的：

```
 enz bra skip_print
  print "Hello"
skip_print: 
```

# facebook - 删除 Google+、Facebook 和 Twitter 按钮之间的空白

> ID：10874519
> 
> 赞同：3
> 
> 时间：2012-06-03T22:42:58.297
> 
> 标签：facebook, twitter, google-plus

我希望我的社交媒体按钮（带有气泡计数）彼此齐平，但它们之间存在随机数量的空白。有没有办法删除它？

这是当前代码：

```
{literal}

<!-- Place this tag where you want the +1 button to render -->
<g:plusone size="medium"></g:plusone>
<!-- Place this render call where appropriate -->
<script type="text/javascript">
(function() {
var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
po.src = 'https://apis.google.com/js/plusone.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);})();
</script>

<div class="fb-like" data-href="http://www.url.com" data-send="false" data-layout="button_count" 
data-width="40" data-show-faces="false" style="vertical-align:top"></div>

<a href="https://twitter.com/User" class="twitter-follow-button" data-show-count="true" 
data-show-screen-name="false" data-dnt="true">Follow @User</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id))
{js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";
fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
{/literal} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-04T23:32:54.397

将每个插件包装在一个 div 中，并将其样式设置为`style="overflow:hidden;width:50px;float:left;"`. 使用 50px 或任何你想要的宽度。`<div style="clear:both" />`然后你需要一个最后的 div 来在你最后一个插件的 div 标签之后产生一个“回车/换行” 。

# ios - iOS app - 本地html的存储方式

> ID：10874525
> 
> 赞同：0
> 
> 时间：2012-06-03T22:43:48.273
> 
> 标签：ios, sqlite, core-data, uiwebview, plist

我正在使用 UIWebView 来显示 HTML，目前我已经对 HTML 进行了硬编码，如下所示：

```
NSString *data = @"<body style='border:5px solid silver;'><h1>hello</h1><ul><li>gfhgf</li></ul><img src='http://upload.wikimedia.org/wikipedia/en/c/c2/Tron_Legacy_poster.jpg'/></body>"; 
```

但是，我现在想知道如何使用更实用和可维护的方法来存储 HTML，因为我将为每个视图提供 HTML 密集型数据。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:35:42.697

只需将其作为文件存储在包中即可。您可以使用本地 NSURLRequest 读取它。有很多关于如何做到这一点的教程。

# ffmpeg - 在 Mpeg 流中插入用户数据

> ID：10874527
> 
> 赞同：5
> 
> 时间：2012-06-03T22:44:00.467
> 
> 标签：ffmpeg, mpeg, libavcodec, user-data

有没有办法在 MPEG 流中插入用户数据（起始代码 = 0X1B2）？我正在寻找的是一个简单的工具、脚本或使用十六进制编辑器的一些技巧......

或者你可能有一个 ffmpeg（libavcodec 和 libavformat）的补丁可以做到这一点？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-07-19T09:06:52.370

如果您要将用户数据插入传输流，最简单的解决方案是当它位于自己的 PID 中，不与流中的任何现有 PID 重叠时——您无需担心调整连续性计数器插入点之后的原始流数据包。

但是实际上不可能对您可以在 TS 流中期望的 PID 做出假设，并且如果您尝试对其进行概括 - 您需要注意调整 TS 标头中的连续性计数器以用于相同 PID 的数据包.

# ruby-on-rails - 如何在带有回形针的 Rails 中使用嵌套表单？

> ID：10874529
> 
> 赞同：0
> 
> 时间：2012-06-03T22:44:05.293
> 
> 标签：ruby-on-rails, ruby, rubygems, ruby-on-rails-3.2

运行 RUby 1.9.3-p194 和 Rails 3.2.3 以及最新的回形针 gem。

我正在关注这里的教程： [使用 Paperclip & Rails 3 (Screencast) 上传多个文件](http://www.emersonlackey.com/article/paperclip-with-rails-3)

我已经设置了一个帖子以包含多个图像。我在控制器中构建了 5 个图像对象。

但是，我认为这似乎没有出现：

```
 <% f.fields_for(:postimages) do |asset_fields| %>
     <p><%= asset_fields.file_field :image %></p>
  <% end %> 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:21:51.123

很确定你在第一行需要一个 = ，所以

```
<%= f.fields_for(:postimages) ... %> 
```

# java - Java：全局变量是否可以节省内存和/或时间？

> ID：10874530
> 
> 赞同：6
> 
> 时间：2012-06-03T22:44:28.813
> 
> 标签：java, android

我正在开发一个 Android 应用程序，而我正在编写的方法可能会被调用很多次。在这种方法中，我正在对用户界面进行更新。内存使用和性能对我来说很重要。在我看来，我有 2 个选项可用于更改 UI。

首先是每次都制作新的对象。也就是说：

```
public void myMethod(){
new View().makeVisible();
} 
```

第二种是将对象声明为全局变量，并在方法中引用。这可能看起来像：

```
View myView = new View();

public void myMethod(){
myView.makeVisible();
} 
```

显然，如果这个方法只调用了几次，那么任何差异都会很小。但是，如果我可能多次调用这个，并且有很多变量被调用/创建，那么第二种方法会提高性能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T23:33:57.173

正如其他答案所表明的那样，重用同一个对象而不是为每个方法调用重复实例化一个新对象将减少您的内存占用并提高垃圾收集的性能。

但我实际上会首先考虑可维护性。重用同一个对象是否会使您的代码更加复杂（并可能引入错误）？在编程时牢记效率是很好的，但要避免过早的优化，这会使您的项目复杂化并减慢开发速度。

如果性能和内存使用*是*一个问题，那么是的，重用相同的内容将使您受益`View`：

```
final View myView = new View(); //made final because it shouldn't be reassigned 
```

如果您真的想考虑资源，您甚至可以延迟加载对象 - 也就是说，仅在需要时才创建它。但是，我建议使用 Guava[`Suppliers.memoize(Supplier)`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Suppliers.html#memoize%28com.google.common.base.Supplier%29)来解决这个问题，而不是手动编码该行为：

```
final Supplier<View> myViewSupplier = Suppliers.memoize(new Supplier<View>() {
    @Override
    public View get() {
        return new View();
    }
});

...

public void myMethod() {
    View myView = myViewSupplier.get(); //lazy-loads when first called
    myView.makeVisible();
} 
```

不过，对于这种特殊情况，这可能是极端的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T23:54:50.517

我不认为应该纯粹根据效率做出决定 - 而是哪个组合更能代表您尝试建模的领域。要问的问题是“哪个是使用 View 的班级的正确结构？”。

使用实例变量不是全局变量——它包含在声明它的对象的上下文中。尽管公共静态变量非常接近，但全局变量不应该存在于 OO 中。

首先要决定的是您的“视图”实例在逻辑上属于相对于使用它的类/方法的意图。如果使用它的类是某种工厂，并且“myMethod”是工厂方法，那么是返回一个新实例。

如果“视图”是您类的一个逻辑字段，并且以某种方式有助于捕获和增强其状态和行为，那么没有理由每次都创建一个新字段。只需保持其状态，并使用现有对象。

根据您的描述，您似乎正在尝试维护和更新某种视图的状态。将其更改为所需状态并重新显示它是有意义的，而不是每次都创建一个新对象。由于在功能上这两种方法似乎都适用于您的场景，我会采用第二种选择并避免创建不必要的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T22:59:45.607

全局变量更有效。

创建新对象会占用更多内存，因为每次创建视图并替换旧视图时，旧视图都必须进行垃圾收集。使用全局变量重用相同的视图可以节省系统创建新对象和收集旧对象的任务。

编辑：全局变量只是对对象的引用，而不是对象本身。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T23:00:40.643

好吧，当您让每个构造函数都创建一个新实例时，本质上您正在再次执行并非绝对必要的工作。如果我站在你的立场上，我会选择全局变量，然后清除视图，并尽可能在同一个对象上重绘。这可以防止使用其他方法重复内存释放和分配的可能性，因此除非您认为清除特别昂贵 - 足以使其值得不断分配新视图，然后擦除它。

重用同一对象的另一个动机是 java 虚拟机实现在垃圾回收的使用上有所不同，因为一旦变量超出范围，它就不能被访问——当对应于 JVM 的内存被释放时并不总是相同. 您可能会发现，在另一种情况下，您可以在实例中按顺序分配许多视图，但直到进程空闲一段时间后才会全部释放，从而有效地使应用程序完全像您不想要的那样占用内存。

# iphone - 保留数据的 UIView 类似于 TabBarController XCODE

> ID：10874534
> 
> 赞同：1
> 
> 时间：2012-06-03T22:45:05.917
> 
> 标签：iphone, objective-c, xcode

我建立了一个没有菜单的程序。主视图具有自定义按钮，可根据按下的按钮加载 XIB。我遇到的唯一问题是当我回到已经使用的视图时，它的重置。我在 viewDidUnload 和 viewWillUnload 中尝试过“保留”。我已经尝试了所有我能做的事情，但无法让它发挥作用。

```
- (IBAction)gotoMusicView:(id)sender{
    //[self.view addSubview:musicview];
    if(self.musicMenuData == nil)
    {
        musicMenu *musicview = [[musicMenu alloc]initWithNibName:@"musicMenu" bundle:[NSBundle mainBundle]];
        self.musicMenuData = musicview;
        musicview.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
        [self presentModalViewController:musicview animated:YES];
        [musicview release];
    }

    musicMenu *musicview = [[musicMenu alloc] initWithNibName:nil bundle:nil];
    musicview.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
    [self presentModalViewController:musicview animated:YES];

   } 
```

该音乐视图加载正常。在我离开该视图并返回主视图后，它就被释放了。因此，当我重新打开“musicview”时，所有内容（例如我的 UIWebView）都已重置，就好像我第一次再次打开它一样

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:10:09.120

[使用这个](http://lukeredpath.co.uk/blog/a-note-on-objective-c-singletons.html)创建一个单例类

然后在那里初始化您的 .xib，这样您每次加载 .xib 时都可以使用相同的实例。这样它永远不会重置

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T23:44:57.237

不要在每次需要使用它时进行分配和初始化，而是保留您正在使用的所有视图控制器的引用，如果需要初始化，请在第一次检查它的 nil，例如下面的示例。

```
if(self.someViewController == nil)
     self.someViewController = [[ViewController alloc] initWithNibName:@"ViewController"....

   //Now present self.someViewController.. 
```

对用于选项卡的视图控制器执行此操作。

# c++ - 从 SD 卡读取数据的 PWM 音频

> ID：10874536
> 
> 赞同：3
> 
> 时间：2012-06-03T22:45:21.337
> 
> 标签：c++, audio, arduino, pwm

目前我正在处理这个 Arduino/Nanode 项目，我们想要播放存储在 SD 卡上的 WAV 文件集合，时钟 OCR0 上有 PWM。- 我能够完美地播放 PWM，从 Arduino 网站上 Michael Smith 的草图开始：[http](http://www.arduino.cc/playground/Code/PCMAudio) ://www.arduino.cc/playground/Code/PCMAudio - 我能够正确读取 SD 卡并将数据转换为当我将它们打印到串行窗口时看起来正确的 8 位整数。

我遇到的问题是当我将这些整数输入时钟的 PWM 值时。
正如我所说，当我使用原始 PWM 音频文件并将我自己的 WAV 文件转换为 .h 文件（通过 wav2c）时，它可以工作并且听起来不错。当我读取 SD 卡时，它会显示正确的值。当我直接阅读 WAV 文件以及（我在此处发布的最新版本中尝试的内容）时，它显示正确，因为我将它们转换为文本文件并阅读这些文件。当我从文本文件中输入整数时，我听到类似喇叭的声音，就像 PWM 使用错误的值来输出一样。

我猜问题出在将数据转换为 Atmega 使用的字节数据的某个地方。但我不知道在哪里看或如何解决它。我注意到原始文件在我使用 uint_t8 的地方使用无符号字符。我试图投射它们，但它不起作用。

有没有人有这方面的经验？或者任何线索我怎么可能解决这个问题？

非常感谢您的帮助和时间！

杰伦

PS：下面是我阅读文本文件并将它们转换为整数的代码。它们总是由 3 个字符组成；例如，值 21 在文件中打印为 021，并用逗号分隔，脚本使用第 4 个 myFile.read() 跳过该逗号

```
myFile = SD.open(FileName);

char sampleTMP[4];

sampleTMP[0] = (myFile.read());
sampleTMP[1] = (myFile.read());
sampleTMP[2] = (myFile.read());
sampleTMP[3] = 0;
myFile.read();

unsigned char ss;
ss = atoi(sampleTMP);

Serial.println(ss, DEC);

OCR0A = ss;
OCR0B = ss; 
```

# python - 使用 sqlalchemy 更改用户对 mysql 的权限

> ID：10874537
> 
> 赞同：0
> 
> 时间：2012-06-03T22:45:29.427
> 
> 标签：python, mysql, sqlalchemy

嗨，我需要使用 sqlalchemy 在 mysql 中创建一个用户：我能够在创建用户之前检查用户是否存在，如果它不存在则创建它，但是当我尝试授予数据库上的所有权限时，我得到了这个错误
e self.engine.execute("CREATE USER 'metmi' IDENTIFIED BY 'metmi'")``TypeError: not enough arguments for format string thos are the instructions that I use:` 

和

```
`self.engine.execute("GRANT ALL PRIVILEGES ON *.* TO metmi@'\%' IDENTIFIED BY  'metmi'")` 
```

如果我在 phpMyadmin 或 mysql 提示符上使用相同的指令，它可以工作，所以我真的很困惑，不知道出了什么问题；有人可以告诉我我的错误是什么吗？提前感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T09:58:41.377

我解决了我必须在本地主机上创建相同的用户，用于 Mysql 的内部进程

# three.js - 在 THREE.js 中获取鼠标相对于 3D 空间的坐标

> ID：10874539
> 
> 赞同：4
> 
> 时间：2012-06-03T22:46:03.390
> 
> 标签：three.js

在过去的 3 周里，我一直在努力解决这个问题。如果有人可以帮助我，我将不胜感激。

我正在开发一款类似于几何战争的游戏，其中我在屏幕中间有一个三角形，你可以四处移动。

问题是我需要三角形旋转并面向鼠标光标的方向。我不需要担心 z 轴，因为我总是将相机放在固定位置 (z=500)，并且我将场景视为“2D 场景”——所有动作都发生在 z =0 平面。

计算三角形和鼠标之间的角度是基本的：

```
targetAngle = Math.atan2(mouseCoord.y-this.position.y, mouseCoord.x-this.position.x) 
```

这是网格。

问题是 mouseCoords 是固定的 Dom 窗口格式，而三角形的位置是 Three.js 格式。

**问）如何转换鼠标坐标以表示三角形所在的 z=0 平面上的坐标？**

我尝试了很多方法，包括光线相交，但没有任何效果;(

谢谢大家的帮助，非常感谢你们提供了一个惊人的框架！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-14T22:02:26.607

我实际上没有看到问题。使用 Z 坐标为 0 的 THREE.vector3。然后使用诸如 triangle.rotate(THREE.vector3(targetAngle,0,0) 之类的东西

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2013-12-11T18:29:16.013

我怀疑您的交叉点无法正常工作，因为您的画布在 DOM 中存在 CSS 偏移。

如果您需要三角形来查看特定的东西，您应该能够简单地使用三角形的“lookAt”方法。

让它看看相机，例如： triangleMesh.lookAt(camera.position);

# indexing - 如何利用 Sphinx 多个索引来提高性能

> ID：10874547
> 
> 赞同：5
> 
> 时间：2012-06-03T22:46:59.323
> 
> 标签：indexing, sphinx

我正在阅读一本关于 Sphinx 的书，其中提到为了利用多核和 Sphinx 技术本身，我将不可避免地不得不将一个大索引拆分为更小的索引，并在多索引查询中查询它们。然而，这本书并没有涉及任何进一步的细节。

对此的一般策略是什么？您是否只是以类似 UNION 的方式拆分它，例如

```
index1: SELECT ... FROM table LIMIT 0, 1000
index2: SELECT ... FROM table LIMIT 1000, 1000
... 
```

然后你不时重建这些碎片。当进行搜索时，不同的核心会并行处理这些索引吗？或者它是不同的东西，比如将现有项目分离到更大的索引中，而新的项目被添加到较小的索引中？还是将文本字段分成一个索引，将属性分成另一个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-04T05:50:38.623

好问题。

Sphinx 在每次本地索引搜索中使用一个 CPU 内核，在索引时使用一个 CPU 内核来构建一个索引

如果您有两个索引，您可以同时运行两个索引器并使用两个 CPU 内核。请注意索引是 IO 密集型任务，因此不要运行太多索引器。

一旦您有两个（或更多）索引，您可以通过在搜索查询中提及所有索引或使用如下分布式索引来同时搜索它们：

```
index index_main
{
        type            = distributed
        local           = index1
        local           = index2
} 
```

其中**index1**和**index2**是单独的索引。在这种情况下，您可以搜索**index_main**并且 sphinx 将为您提供来自两个索引的聚合结果

关于拆分数据，您可以利用您想要的所有技术，包括按范围、哈希或属性值以及以上所有内容的任意组合拆分记录。

我最喜欢的是使用模来确定索引号，如下所示：

对于第一个索引：

```
sql_query       = SELECT id, title, description FROM <my_table> WHERE (id % 2) = 0 
```

第二：

```
sql_query       = SELECT id, title, description FROM <my_table> WHERE (id % 2) = 1 
```

这种方法有一些缺点，但总的来说，如果您没有大量数据，这是一个好的开始。

# android - ListView 的自定义适配器导致错误

> ID：10874553
> 
> 赞同：1
> 
> 时间：2012-06-03T22:47:18.483
> 
> 标签：android, android-listview, android-arrayadapter

我收到此错误：

```
Caused by: java.lang.RuntimeException: 
    Your content must have a ListView whose id attribute is 'android.R.id.list' 
```

这是 HomeScreen.java：

```
public class HomeScreen extends ListActivity {

    String TAG = AppConstants.TAG;

    @Override
    protected void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        setContentView(R.layout.home);

        CBasicInfo basicinfo_data[] = new CBasicInfo[]
                {
                    new CBasicInfo("Projet A", 1, new Date()),
                    new CBasicInfo("Projet A", 2, new Date()),
                    new CBasicInfo("Projet A", 3, new Date()),
                    new CBasicInfo("Projet A", 4, new Date()),
                    new CBasicInfo("Projet A", 5, new Date())
                };

        BasicInfoAdapter adapter = new BasicInfoAdapter(this, R.layout.home_screen_list_item, basicinfo_data);
        ListView list_view = (ListView)findViewById(R.id.lvSavedProjects);
        list_view.setAdapter(adapter);
    }
} 
```

这里是我的适配器 BasicInfoAdapter.java：

```
public class BasicInfoAdapter extends ArrayAdapter<CBasicInfo>{

    Context context; 
    int layoutResourceId;    
    CBasicInfo data[] = null;

    public BasicInfoAdapter(Context context, int layoutResourceId, CBasicInfo[] data) {
        super(context, layoutResourceId, data);
        this.layoutResourceId = layoutResourceId;
        this.context = context;
        this.data = data;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View row = convertView;
        BasicInfoHolder holder = null;

        if(row == null)
        {
            LayoutInflater inflater = ((Activity)context).getLayoutInflater();
            row = inflater.inflate(layoutResourceId, parent, false);

            holder = new BasicInfoHolder();
            holder.txtName = (TextView)row.findViewById(R.id.tvHomeScreenProjectName);
            holder.txtPid = (TextView)row.findViewById(R.id.tvHomeScreenPid);
            holder.txtDDate = (TextView)row.findViewById(R.id.tvHomeScreenDownloadDate);

            row.setTag(holder);
        }
        else
        {
            holder = (BasicInfoHolder)row.getTag();
        }

        CBasicInfo bi = data[position];
        holder.txtName.setText(bi.getName());
        holder.txtPid.setText(bi.getId());
        holder.txtDDate.setText(bi.getExportDate().toString());

        return row;
    }

    static class BasicInfoHolder
    {
        TextView txtName;
        TextView txtPid;
        TextView txtDDate;
    }
} 
```

我的 home.xml 是：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/lbl_saved_projects"
        android:textAppearance="?android:attr/textAppearanceLarge" />
    <ListView
        android:id="@+id/lvSavedProjects"
        android:name="android.app.ListFragment"
        android:layout_width="match_parent"
        android:layout_height="0dip"
        android:layout_weight="0.86" />
    <Button
        android:id="@+id/bDownloadMoreProjects"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/lbl_download_more_projects" />
</LinearLayout> 
```

我到底做错了什么？

谢谢

编辑：

堆栈跟踪显示：

```
FATAL EXCEPTION: main
android.content.res.Resources$NotFoundException: String resource ID #0x1
    at android.content.res.Resources.getText(Resources.java:247)
    at android.widget.TextView.setText(TextView.java:3473)
    at com.snip.tnc.SnipForAndroid.BasicInfoAdapter.getView(BasicInfoAdapter.java:48)
    at android.widget.AbsListView.obtainView(AbsListView.java:2033)
    at android.widget.ListView.makeAndAddView(ListView.java:1772)
    at android.widget.ListView.fillDown(ListView.java:672)
    at android.widget.ListView.fillFromTop(ListView.java:732)
    at android.widget.ListView.layoutChildren(ListView.java:1625)
    at android.widget.AbsListView.onLayout(AbsListView.java:1863)
    at android.view.View.layout(View.java:11278)
    at android.view.ViewGroup.layout(ViewGroup.java:4224)
    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
    at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
    at android.view.View.layout(View.java:11278)
    at android.view.ViewGroup.layout(ViewGroup.java:4224)
    at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
    at android.view.View.layout(View.java:11278)
    at android.view.ViewGroup.layout(ViewGroup.java:4224)
    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
    at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
    at android.view.View.layout(View.java:11278)
    at android.view.ViewGroup.layout(ViewGroup.java:4224)
    at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
    at android.view.View.layout(View.java:11278)
    at android.view.ViewGroup.layout(ViewGroup.java:4224)
    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1489)
    at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2442)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4424)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:49:57.217

错误很明显：

> 您的内容必须有一个 ID 属性为“android.R.id.list”的 ListView

所以看起来你没有一个 at `R.layout.home`。`Adapter`顺便说一句，您的问题与s无关，而与`ListActivity`.

你的`ListView`布局中应该有这个作为它的`id`属性：

```
android:id="@android:id/list` 
```

我不确定你的`android:name`属性在那里做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T22:58:46.167

正如 K-Ballo 指出的那样， a 的布局`ListActivity`必须有 a `ListView`with id `android.R.id.list`。第一部分 ( `android.R`) 转换为`@android:`，第二部分转换为`id/list`...

将您的 id 设置`ListView`为`@android:id/list`. 它会自动使用。

然后，您应该删除您使用的行`findViewById(...)`（对于 a 不是必需的`ListActivity`）。那你就用...

```
setListAdapter(adapter); 
```

您不需要找到`ListView`设置，`Adapter`因为上述`ListActivity`公开的方法会自动执行。

但是，如果您确实需要将其`ListView`用于其他目的，请使用...

```
getListView(); 
```

# c# - 如何从其子对象访问控制器 ViewData 和 TempData - 通知提供程序实现

> ID：10874554
> 
> 赞同：0
> 
> 时间：2012-06-03T22:47:28.757
> 
> 标签：c#, asp.net-mvc

我正在尝试为我的应用程序构建通知提供程序（警报）。目前我只需要在请求之间生成通知，但是将此功能包装在提供程序中将允许我稍后将其连接到数据库。

我有 3 种类型的通知：

```
public enum NotificationType
{
    Success,
    Error,
    Info
} 
```

和一个通知对象：

```
public class Notification
{
    public NotificationType Type { get; set; }
    public string Message { get; set; }
} 
```

我想将所有通知放入`List<Notification>`并将其加载到`ViewData["Notifications"]`

然后我可以使用助手来读取`ViewData["Notifications"]`和渲染它：

我想实现我自己的 NotificationProvider 来维护`List<Notification>`对象。

我希望提供者读取 TempData["Notifications"] 并将其加载到`List<Notification> Notifications`变量中。然后我可以将通知加载到 ViewData["Notifications"] 以供我的助手使用。

下面的代码不起作用，但我认为它显示了我正在尝试做的事情。

```
public class NotificationProvider
{
    public List<Notification> Notifications { get; set; }

    private Controller _controller;

    public NotificationProvider(Controller controller /* How to pass controller instance? */)
    {
        _controller = controller;

        if (_controller.TempData["Notifications"] != null)
        {
            Notifications = (List<Notification>)controller.TempData["Notifications"];

            _controller.TempData["Notifications"] = null;
        }
    }

    public void ShowNotification(NotificationType notificationType, string message)
    {
        Notification notification = new Notification();

        notification.Type = notificationType;
        notification.Message = message;

        Notifications.Add(notification);

        _controller.TempData["Notifications"] = Notifications;
    }

    public void LoadNotifications()
    {
        _controller.ViewData["Notifications"] = Notifications;
    }
} 
```

在每个控制器中都有一个 NotificationProvider 实例：

```
public class HomeController
{
    private NotificationProvider notificationProvider;

    public HomeController()
    {
        notificationProvider = new NotificationProvider(/* Controller instance */);
        notificationProvider.LoadNotifications();
    }
} 
```

**问题：**

如何将控制器实例传递给 NotificationProvider 类，以便它可以访问 TempData 和 ViewData 对象。或者如果可能的话，我怎样才能直接从 NotificationProvider 实例访问这些对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:06:17.017

我想你只想像那样通过**这个**。此外，从评论返回，TempData 将仅在操作中可用：

```
public class HomeController
{
    public ActionResult Index()
    {
        var notificationProvider = new NotificationProvider(this);
        notificationProvider.LoadNotifications();
        return View();
    }
} 
```

# performance - 为什么 Seq.iter 和 Seq.map 这么慢？

> ID：10874557
> 
> 赞同：11
> 
> 时间：2012-06-03T22:47:47.493
> 
> 标签：performance, f#, seq

考虑 F# 中的这段代码：

```
let n = 10000000
let arr = Array.init n (fun _ -> 0)

let rec buildList n acc i = if i = n then acc else buildList n (0::acc) (i + 1)
let lst = buildList n [] 0

let doNothing _ = ()
let incr x = x + 1

#time

arr |> Array.iter doNothing         // this takes 14ms
arr |> Seq.iter doNothing           // this takes 74ms

lst |> List.iter doNothing          // this takes 19ms
lst |> Seq.iter doNothing           // this takes 88ms

arr |> Array.map incr               // this takes 33ms
arr |> Seq.map incr |> Seq.toArray  // this takes 231ms!

lst |> List.map incr                // this takes 753ms
lst |> Seq.map incr |> Seq.toList   // this takes 2111ms!!!! 
```

为什么模块上的`iter`and`map`函数比和模块等效的函数`Seq`慢得多？`Array``List`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-03T23:25:47.800

一旦你调用`Seq`你就会丢失类型信息——移动到列表中的下一个元素需要调用`IEnumerator.MoveNext`. 比较`Array`你只增加一个索引，`List`你可以取消引用一个指针。本质上，您会为列表中的每个元素获得一个额外的函数调用。

出于类似原因，转换回`List`并`Array`减慢代码速度

# webgl - 如何在球体的极点放置纹理？

> ID：10874561
> 
> 赞同：1
> 
> 时间：2012-06-03T22:48:28.123
> 
> 标签：webgl, three.js

即使使用地球的高分辨率纹理 (4k*2k)，两极的映射也会失真。是否可以使用 THREE.js 将中间的方形纹理直接放置在球体的两极并相应地旋转？

示例地图：[http ://rapidfire.sci.gsfc.nasa.gov/imagery/subsets/?mosaic=Arctic.2012154.terra.4km.jpg](http://rapidfire.sci.gsfc.nasa.gov/imagery/subsets/?mosaic=Arctic.2012154.terra.4km.jpg)

对不起，没有代码，寻找起点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T13:33:09.690

也许你应该“纠正”你的矩形纹理以避免两极的扭曲。

此链接可能对此有所帮助：[http ://local.wasp.uwa.edu.au/~pbourke/texture_colour/texturemap/](http://local.wasp.uwa.edu.au/~pbourke/texture_colour/texturemap/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:14:30.117

在[Cesium](http://cesium.agi.com)（一个 WebGL 地球和地图引擎）中，我们通过在每个极点所在的位置创建屏幕空间四边形并使用着色器正确渲染极点来固定极点。代码在[这个 pull request](https://github.com/AnalyticalGraphicsInc/cesium/pull/42)中。我们尚未提供镶嵌高分辨率图像，但即将推出。

# objective-c - 字典 objectforkey 的 if 语句：@"key" 当值为

> ID：10874564
> 
> 赞同：6
> 
> 时间：2012-06-03T22:48:43.263
> 
> 标签：objective-c

我正在使用objective c 开发一个iphone 应用程序。

我看到了`[dictionary objectForKey:@"key"]`回报`<null>`。做 a`if([dictionary objectForKey:@"key"] == nil || [dictionary objectForKey:@"key"] == null)`似乎没有抓住这种情况。

执行 a`if([[dictionary objectForKey:@"key"] isEqualToString:@"<null>"])`会导致我的程序崩溃。

catch 的正确表达是`<null>`什么？

**更多详细信息** nil 的 if 语句仍然没有解决这个问题......也许我太累了，看不到东西，但这里有更多信息：

字典通过包含 json 数据的 url 填充，如下所示：

```
NSURL *url = [NSURL URLWithString:"http://site.com/"];

dataresult = [NSData dataWithContentsOfURL:url];

NSError *error;
NSMutableDictionary *dictionary = [NSJSONSerialization JSONObjectWithData:dataresult options:kNilOptions error:&    error]; 
```

在字典上执行 NSLog 会给出以下输出：

```
{
    key = "<null>";
    responseMessage = "The email / registration code combination is incorrect";
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-03T23:19:39.167

你有一个`NSNull`. 实际上，*实例*，因为它是一个单例。

Cocoa 集合不能包含`nil`，尽管`nil`如果您尝试访问不存在的内容，它们可能会返回。

然而，有时程序在集合中存储一个“无”的东西是很有价值的。这`NSNull`就是为了。

碰巧的是，JSON 可以表示空对象。因此，当将 JSON 转换为 Cocoa 集合时，那些空对象会被转换为`NSNull`对象。

当 Cocoa 使用 "%@" 说明符格式化字符串时，`nil`值将被格式化为带括号的 "(null)"。一个`NSNull`值将被格式化为带有尖括号的“<null>”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T22:55:04.733

新答案：

感谢您添加详细信息。看起来`dataresult`您设置的 " "***不是***JSON 对象，因此难怪将原始字符串放入 " 时会得到古怪的结果`[NSJSONSerialization JSONObjectWithData:]`。在调用任何与 JSON 相关的内容之前，您可能需要对数据进行一些基本的错误检查。

原答案：

首先，如果这是我的代码，我不会命名一个“`NSDictionary`对象” `array`（我看到你在编辑中看到了我的评论……希望你早点睡！）。

其次，您要查找的是“ `nil`”，而不是名为“ `<null>`”的字符串。正如[Apple 的`objectForKey:`states](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDictionary/objectForKey%3a)文档，如果没有为您要求的键找到对象，则返回 nil。Xcode 控制台试图帮助在`<null>`其输出中将 nil 对象转换为 " " 字符串。

做“ `if [dictionary objectForKey: @"key"] != nil`”，你应该更快乐。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-27T21:11:03.410

只需使用以下代码：

```
if ([[dictionary valueForKey:@"key"] isKindOfClass:[NSNull Class]]{
   //This means that the value inside the dictionary is <null>
}
else{
//the value is not <null>
} 
```

这应该这样做。

# magento - 相关产品未显示不同的价格

> ID：10874565
> 
> 赞同：4
> 
> 时间：2012-06-03T22:48:59.083
> 
> 标签：magento

我刚刚添加了一个产品，一切正常。该产品是具有不同属性的上衣：尺寸和颜色。

但是我想在促销中降低其中一种不同颜色的价格，所以我进入了相关产品部分并更改了价格。但是，每当我去网站点击降价顶部的颜色时，它仍然显示原始价格，而不是我刚刚更改的价格。

我怎样才能让它显示我改变它的价格？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:51:47.460

开箱即用的唯一方法是通过“超级产品属性配置”下每个可配置选项的价格抵消，如附图所示：

![每个选项的可配置价格偏移](../Images/d026a40d9cfd5a6603721ee73a15efa7.png)

否则，您可以使用诸如[简单可配置产品](http://www.magentocommerce.com/magento-connect/simple-configurable-products.html "简单的可配置产品") [http://www.magentocommerce.com/magento-connect/simple-configurable-products.html之类的扩展](http://www.magentocommerce.com/magento-connect/simple-configurable-products.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T23:10:57.253

转到系统 > 索引管理并重新索引产品价格数据

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-12T10:42:22.337

听起来您正在使用带有相关简单产品的可配置产品。据我所知，Magento 只会刷新捆绑产品类型的产品价格。

我看到很多人推荐[这个模块](http://www.magentocommerce.com/magento-connect/simple-configurable-products.html)。

# javascript - DOM 处理和 javascript 放置

> ID：10874569
> 
> 赞同：0
> 
> 时间：2012-06-03T22:49:14.293
> 
> 标签：javascript, optimization

只是一个关于处理顺序和 DOM 处理方式的快速问题。

我的理解是，在标记之前包含所有 JQuery 脚本是最佳实践。在我的情况下，我有一个 div 容器，它包含了我的大部分身体元素。其中包括我的页脚，其中包含公司名称和年份。目前我的页面以模块化方式设置（header.php、page.php、footer.php），我想在 footer.php 中包含我的公司名称和年份，因为这显然可以轻松编辑公司名称. 我的问题在于想要保持在正文之前保留 jquery 脚本的格式。使用这种布局，如果不将 jquery 脚本包含在我的 div 中，我就无法在我的 footer.php 中包含公司名称。我将向您展示我对伪代码的含义：

目前是如何设置的：

页面.php

```
<body>
<div class="container">
  //body elements
<hr>
 <p>&copy; Company 2012</p>
</div>
<script>
  //some javascript #1
</script>
<script>
  //some javascript #2
</script> 
```

页脚.php：

```
<script> //same static javascript that doesn't change page to page </script>
</body> 
```

我想如何设置它（允许在整个站点范围内轻松更改公司名称）：

页面.php

```
<body>
<div class="container">
  //body elements
<script>
  //some javascript #1
</script>
<script>
  //some javascript #2
</script> 
```

页脚.php：

```
<hr>
 <p>&copy; Company 2012</p>
</div>
<script> //same static javascript that doesn't change page to page </script>
</body> 
```

我意识到我*可以*这样做，但我害怕失去优化，因为我的 jquery 脚本在技术上将在容器内执行。

综上所述，是否会在页面容器的关闭 div 之前包含我的 jquery 脚本，但是在 div 的所有内容之后，是否会导致它的效率低于在所述 div 关闭之后？

我意识到所有这一切都完全取决于 DOM 的处理方式，但我似乎找不到任何关于 DOM 是否在处理过程中进行处理的信息，或者在实际处理之前是否需要结束标记，这将在反过来导致第二种方法变慢。

让我知道我是否可以清除任何东西。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:22:45.637

内联脚本会阻止整个页面的呈现。（只有 Opera 会进行一些渲染）因此，将它们放在机箱中的位置*并不重要。*一般来说，最好将它们放在最后，因为仍然可以下载外部文件，并且如果启用了刷新，则*可以*呈现某些内容。

外部脚本只会阻止它们下面的所有内容的呈现。

# ajax - check_ajax_referer() 究竟是如何工作的？

> ID：10874571
> 
> 赞同：5
> 
> 时间：2012-06-03T22:49:22.663
> 
> 标签：ajax, wordpress, nonce

[聪明的 Wordpress 人说](http://www.prelovac.com/vladimir/improving-security-in-wordpress-plugins-using-nonces)插件开发人员应该在从页面发送回 wordpress 博客 (admin-ajax.php) 的每个 AJAX 请求中使用随机数。

这是通过 (1) 在服务器端生成一个随机数来完成的，通过

```
$nonce = wp_create_nonce  ('my-nonce'); 
```

...(2) 使该 nonce 可用于发送 AJAX 请求的 Javascript 代码。例如，您可以这样做：

```
function myplg_emit_scriptblock() {
    $nonce = wp_create_nonce('myplg-nonce');
    echo "<script type='text/javascript'>\n" .
        " var WpPlgSettings = {\n" .
        "   ajaxurl : '" . admin_url( 'admin-ajax.php' ) . "',\n" .
        "   nonce : '" . $nonce . "'\n" .
        " };\n" .
        "</script>\n";
}
add_action('wp_print_scripts','myplg_emit_scriptblock'); 
```

...然后 (3) javascript ajax 逻辑引用该全局变量。

```
 var url = WpPlgSettings.ajaxurl +
        "?action=my-wp-plg-action&" +
        "nonce=" + WpPlgSettings .nonce +
        "docid=" + id;

    $.ajax({type: "GET",
            url: url,
            headers : { "Accept" : 'application/json' },
            dataType: "json",
            cache: false,
            error: function (xhr, textStatus, errorThrown) {
                ...
            },
            success: function (data, textStatus, xhr) {
                ...
            }
           }); 
```

...最后（4）在服务器端逻辑中检查接收到的随机数。

```
add_action( 'wp_ajax_nopriv_skydrv-hotlink', 'myplg_handle_ajax_request' );
add_action( 'wp_ajax_skydrv-hotlink', 'myplg_handle_ajax_request' );
function myplg_handle_ajax_request() {
    check_ajax_referer( 'myplg-nonce', 'nonce' );  // <<=-----
    if (isset($_GET['docid'])) {
        $docid = $_GET['docid'];
        $response = myplg_generate_the_response($docid);
        header( "Content-Type: application/json" );
        echo json_encode( $response ) ;
    }
    else {
        $response = array("error" => "you must specify a docid parameter.");
        echo json_encode( $response ) ;
    }

    exit;
} 
```

但是检查是如何真正起作用的呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-08-21T13:01:49.780

[修改了一些 AJAX 程序](https://stackoverflow.com/a/13614297/1287812)，我遇到了同样的问题。[检查功能代码](http://queryposts.com/function/check_ajax_referer/)很简单：

```
function check_ajax_referer( $action = -1, $query_arg = false, $die = true ) {
    if ( $query_arg )
        $nonce = $_REQUEST[$query_arg];
    else
        $nonce = isset($_REQUEST['_ajax_nonce']) ? $_REQUEST['_ajax_nonce'] : $_REQUEST['_wpnonce'];

    $result = wp_verify_nonce( $nonce, $action );

    if ( $die && false == $result ) {
        if ( defined( 'DOING_AJAX' ) && DOING_AJAX )
            wp_die( -1 );
        else
            die( '-1' );
    }

    do_action('check_ajax_referer', $action, $result);

    return $result;
} 
```

如果`wp_verify_nonce`是`false`并且您还没有发送参数`false`，`$die`那么它将执行`wp_die( -1 );`.

* * *

在您的示例代码中，`check_ajax_referer()`将中断执行并返回`-1`到 AJAX 调用。如果您想自己处理错误，请添加参数`$die`并使用`$do_check`：

```
$do_check = check_ajax_referer( 'myplg-nonce', 'nonce', false ); 
```

* * *

请注意，在 WordPress 中处理 AJAX 的正确方法是：[注册](http://codex.wordpress.org/Function_Reference/wp_register_script)、[排队](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)和[本地化](http://codex.wordpress.org/Function_Reference/wp_localize_script)JavaScript 文件，[`wp_enqueue_scripts`](http://codex.wordpress.org/Plugin_API/Action_Reference/wp_enqueue_scripts)而不是`wp_print_scripts`.
[请参阅[使用 wp_enqueue_scripts() 而不是 wp_print_styles()](http://make.wordpress.org/core/2011/12/12/use-wp_enqueue_scripts-not-wp_print_styles-to-enqueue-scripts-and-styles-for-the-frontend/)。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T18:56:54.327

这只是一个测试“nonce”代码是否与给定的代码匹配，因此黑客无法插入并获取您数据库的快捷方式。如果安全码不匹配，php 将死掉，页面将停止。

“如果您的代码经过正确验证，它将继续过去，否则将触发 die('-1'); 停止您的代码死亡。”

# php - 使用 PHP 下载异地 m4v

> ID：10874574
> 
> 赞同：0
> 
> 时间：2012-06-03T22:49:42.030
> 
> 标签：php, video, curl, download

我想从异地服务器下载文件。如果出现这种情况，我确实同意这样做:) 我拥有的是一个 cURL 脚本，它可以获取标题和文件名，但无论出于何种原因，我都无法将文件 dl 到我的服务器。

```
$downloadvUrl="$videos";
$file = "downloads";
$fileName=$downloadvUrl;
$header = array(
"Accept-Encoding: gzip,deflate",
"Accept-Charset: utf-8;q=0.7,*;q=0.7",
"Connection: close"
);
$file2 = dirname(__file__).'/'.videos.'.m4v';
$curlObj=curl_init();
curl_setopt($curlObj, CURLOPT_HTTPHEADER, $header);
curl_setopt($curlObj, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curlObj, CURLOPT_HEADER, false);
curl_setopt($curlObj, CURLOPT_USERAGENT, $useragent);
curl_setopt($curlObj, CURLOPT_CONNECTTIMEOUT, 999);
curl_setopt($curlObj, CURLOPT_TIMEOUT, 9999);
curl_setopt($curlObj, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1);
curl_setopt($curlObj, CURLOPT_URL, $downloadvUrl);
$response = curl_exec($curlObj);
$return = false;
if(!curl_errno($curlObj)) {
file_put_contents($file2, $response);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:23:42.333

实际上，我通过使它更简单一些来使其工作。

```
<?php
$i = 0;
while(file_exists($target_path).$i) {
$i++;
}
$ch = curl_init("$matches[1]");
$fp = fopen("1.m4v", "w");
if (file_exists($fp)) {
    echo "The file $filename exists";
} else {
echo "The file $filename does not exist";
}

curl_setopt($ch, CURLOPT_FILE, $fp);
curl_setopt($ch, CURLOPT_HEADER, 0);

curl_exec($ch);
curl_close($ch);
fclose($fp);
?> 
```

我怎样才能得到它，以便文件以不同的名称上传？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T01:21:07.487

你可以加：

```
$fh = fopen('/tmp/foo', 'w'); 
curl_setopt($ch, CURLOPT_FILE, $fh); 
```

将 /tmp/foo 更改为您希望将其保存到的文件。

# asp.net-mvc - ASP.NET MVC、EF 和 Ninject：不同的 ObjectContext 问题

> ID：10874576
> 
> 赞同：0
> 
> 时间：2012-06-03T22:49:54.077
> 
> 标签：asp.net-mvc, entity-framework-4, ninject

我将 Ninject 用于 DI，并将 IDbContext 作为构造函数参数注入到我的存储库中。我得到一个***“无法定义两个对象之间的关系，因为它们附加到不同的 ObjectContext 对象。”*** 尝试执行以下操作时出错：

这是我的控制器的**操作方法**：

```
 public ActionResult BindSpace(int spaceId, int managerId)
    {
        Space space = _spaceService.GetSpace(spaceId);
        Manager manager = _managerService.GetManager(managerId);

        if (space != null && manager != null)
        {
            _spaceService.BindManager(space, manager);
        }

        return RedirectToAction("GetSpaceBindingForm", new { id = space.Id });
    } 
```

这是**服务方法**：

```
public void BindManager(Space space, Manager manager)
    {
        if (space != null && manager != null)
        {
            space.Managers.Add(manager);
            _spaceRepo.Update(space);
        }
    } 
```

添加和更新非相关实体时没有问题。

我使用时没有问题：

`ninjectKernel.Bind<IDbContext>().To<SPBSObjectContext>().InSingletonScope().WithConstructorArgument("nameOrConnectionString", "ShoppingPointBrowsingSystem");`

我在网上搜索，每个人都实现并使用了 NinjectModule 抽象基类，但我有以下代码。我在这里做错了什么？

这是**注入**部分：

```
public class NinjectControllerFactory : DefaultControllerFactory
{
    private IKernel ninjectKernel;

    public NinjectControllerFactory()
    {
        ninjectKernel = new StandardKernel();
        AddBindings();
    }

    protected override IController GetControllerInstance(System.Web.Routing.RequestContext requestContext, Type controllerType)
    {
        return controllerType == null ? null : (IController)ninjectKernel.Get(controllerType);
    }

    private void AddBindings()
    {
        // HTTP Context
        ninjectKernel.Bind<HttpContextBase>().ToMethod(context => new HttpContextWrapper(HttpContext.Current));

        // Context
        ninjectKernel.Bind<IDbContext>().To<SPBSObjectContext>().InRequestScope().WithConstructorArgument("nameOrConnectionString", "ShoppingPointBrowsingSystem");

        // Repositories
        ninjectKernel.Bind<IRepository<Admin>>().To<EfRepository<Admin>>().InRequestScope();
        ninjectKernel.Bind<IRepository<Manager>>().To<EfRepository<Manager>>().InRequestScope();
        ninjectKernel.Bind<IRepository<ShoppingCenterSpace>>().To<EfRepository<ShoppingCenterSpace>>().InRequestScope();
        ninjectKernel.Bind<IRepository<IndependentStoreSpace>>().To<EfRepository<IndependentStoreSpace>>().InRequestScope();
        ninjectKernel.Bind<IRepository<Space>>().To<EfRepository<Space>>().InRequestScope();

        // Services
        ninjectKernel.Bind<IAuthenticationService<Admin>>().To<AdminFormsAuthenticationService>();
        ninjectKernel.Bind<IAdminService>().To<AdminService>();
        ninjectKernel.Bind<IManagerService>().To<ManagerService>();
        ninjectKernel.Bind<IShoppingCenterSpaceService>().To<ShoppingCenterSpaceService>();
        ninjectKernel.Bind<IIndependentStoreSpaceService>().To<IndependentStoreSpaceService>();
        ninjectKernel.Bind<ISpaceService>().To<SpaceService>();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:34:57.060

`InRequestScope`需要 Ninject.MVC3 扩展而不是自己的 ControllerFactory 。否则它的行为就像`InTransientScope`

# ruby-on-rails-3 - 为两种模型设计：如何自定义视图？

> ID：10874577
> 
> 赞同：2
> 
> 时间：2012-06-03T22:49:56.273
> 
> 标签：ruby-on-rails-3, devise

我正在为两个模型使用 Devise，运行后`rails g devise:views`，在 views/devise/ 中创建了一些视图——其中一些很好，可以在这两个模型之间共享，但是我必须添加一些字段（取决于模型）到注册一。

例如，因为`devise/registrations/new.html.erb`我有这个：

## 注册

```
<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
  <%= devise_error_messages! %>
    <p><%= f.label :first_name %><br />
  <%= f.text_field :first_name %></p>

  <div><%= f.label :email %><br />
  <%= f.email_field :email %></div>

  <div><%= f.label :password %><br />
  <%= f.password_field :password %></div>

  <div><%= f.label :password_confirmation %><br />
  <%= f.password_field :password_confirmation %></div>

  <div><%= f.submit "Sign up" %></div>
<% end %>

<%= render :partial => "devise/shared/links" %> 
```

这没关系，但我如何使其特定于模型？我怎么能告诉设计去看看/views/my_model/new.html.erb？基本上我想为每个使用 Devise 的模型创建两个单独的注册/新模板，因为每个模型都有不同的字段。

当我这样做时`rails g devise:views mymodel`，它仍然呈现模板`views/devise`而不是`views/mymodel/devise`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T06:11:35.713

我会为您的每个模型创建一个包含您认为必要的任何字段的表单的部分。以您使用的特定模型（用户或管理员）命名它们。然后在 devise/registrations/new.html.erb 中根据 resource.class.name 渲染适当的部分。

# php - 左侧菜单与我的 wordpress 网站上的页脚重叠

> ID：10874579
> 
> 赞同：0
> 
> 时间：2012-06-03T22:49:58.407
> 
> 标签：php, wordpress, menu, overlap

这是我的网站[http://yannicktemp.comuv.com/?page_id=48](http://yannicktemp.comuv.com/?page_id=48)，

但是，当您单击“onderhoudsproblemen”（http://yannicktemp.comuv.com/?page_id=58）时。你可以看到左侧菜单与我的页脚重叠，所以我希望我的页脚向下移动，或者换句话说，我的内容 div 应该伸展。

我知道这是一个 CSS 问题，但我似乎无法正确处理。

非常感谢任何帮助，

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T22:55:42.813

您应该在 css 中为您的主 div 设置 min-height 属性。将其设置为 300 像素。那应该做的工作。

# php - 汇总数据库表中所有出现的单个数字

> ID：10874580
> 
> 赞同：0
> 
> 时间：2012-06-03T22:50:04.433
> 
> 标签：php, sql, arrays

我正在尝试汇总数据库表中每个单独数字的所有出现，并将它们返回到关联数组中。

例如，该表可能包含以下条目： 1 3 4 2 1 2 1 1 4 3 3 4 2

总计时，这将是 1 = 4、2 = 3、3 = 3、4 = 3。

理想情况下，这将作为具有“数字”和“总计”键的数组返回。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:54:33.830

您需要的 SQL 代码是：`SELECT num AS number, COUNT(num) AS occurrences FROM yourtable GROUP BY num`

有了答案，您将在每一行中获得第一个字段的 num 和第二个字段的出现次数。然后你可以创建一个数组并让它只是循环通过 sql 响应

获取数组将类似于（未经测试的代码，只是一个指南）：

```
$myArray = array();
while($row = mysql_fetch_array( $data ))
{
     $myArray[$row["num"]] = $row["occurrences"];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T22:52:06.263

一种选择是获取结果并使用[`array_count_values`](http://php.net/manual/en/function.array-count-values.php)：

```
$arr = array_count_values($arr); 
```

在 SQL 查询中，您可以使用`COUNT`and执行相同的操作`GROUP BY`：

```
SELECT number, COUNT(*) as total FROM mytable GROUP BY number 
```

最后一个会返回两列对应的数据：

```
------------------
| number | total |
------------------
| 1      | 4     |
------------------
| 2      | 3     |
------------------
... 
```

# node.js - 为什么我不能在everyauth 中获得req.user？

> ID：10874581
> 
> 赞同：0
> 
> 时间：2012-06-03T22:50:43.520
> 
> 标签：node.js, express, everyauth

您好，我对everyauth 有疑问：我不知道如何在路由中配置和获取req.user。

谁能帮我配置一下？

如果您想查看更多代码，请告诉我。感谢访问

```
.password
    // .loginWith('email')
    .loginWith('login')
    .getLoginPath('/login')
    .postLoginPath('/login')
    .loginView('login.jade')
    .loginLocals( function (req, res, done) {
      setTimeout( function () {
        done(null, {
          title: 'Async login'
        });
      }, 200);
    })
    .authenticate( function (login, password) {
      var errors = [];
      if (!login) errors.push('Missing login');
      if (!password) errors.push('Missing password');
      if (errors.length) return errors;

      var user = usersByLogin[login];

      if (!user) return ['Login failed'];
      if (user.password !== password) return ['Login failed'];
      return user;
    }) 
```

重定向代码：

```
app.get('/home', function(req,res)
  {
    if(req.session.auth)
      {
        console.log(req.user); //undefined
        res.send('youre logged in');
      }
  }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T02:16:10.520

您需要通过调用为everyauth 提供一种从其ID 查找您的用户对象的方法：

```
everyauth.everymodule.findUserById(function(userId, callback) {
    // Look up the user from userId and call callback(err, user)
    ....
}); 
```

[请参阅everyauth 网站](http://everyauth.com/)的访问用户部分。

# java - 将静态类引用传递给非静态类的构造函数

> ID：10874582
> 
> 赞同：0
> 
> 时间：2012-06-03T22:50:46.990
> 
> 标签：java, swing

我需要对 Client 的引用，因为我需要调用 a`setWinTitle`来更改当前窗口的标题。如何解决？

```
 public class Client { 
        public static void main(String[] args){
            JPanel gui= startGUI();
            ...
        }

        private static JPanel startGUI(){
            f = new JFrame();
            JPanel gui = new JPanel(this); // error
        }

        public void setWinTitle(String tite){
            f.setTitle(tite);
        }
    } 
```

* * *

```
public class JPanel extends javax.swing.JPanel {
    Client client;

    public JPanel(Client cl) {
        client= cl; 
        initComponents();
    }
...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T22:53:32.403

您需要创建一个实例`Client`：

```
JPanel gui = new JPanel(new Client()); 
```

# code-generation - IBM RSA：代码生成有哪些图表类型？

> ID：10874583
> 
> 赞同：1
> 
> 时间：2012-06-03T22:50:53.270
> 
> 标签：code-generation, uml

**只能转换类图吗？
或者其他图表类型也可以很好地利用？**

对于一个大学项目，我们被迫充分利用 Rational Software Architect。

几个小时以来，我自己都无法找到关于该主题的可靠信息，这就是我在这里寻求帮助的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T08:52:02.560

开箱即用的 RSA 为类和关联等生成代码，如果您有支持它的版本/墨盒。

但是 RSA 使用基于 EMF 的 org.eclipse.uml 模型。这意味着您可以使用任何生成器（如 XPand 或 JET）为任何 UML 模型元素生成自定义代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:17:49.577

代码生成仅来自类图。

如果您将模型导出到 xmi 序列化，那么经过漫长而痛苦的工作后，您可以生成代码，但此代码生成并未集成在工具中。

# javascript - JavaScript for 循环中复合条件语句的使用

> ID：10874587
> 
> 赞同：0
> 
> 时间：2012-06-03T22:52:10.190
> 
> 标签：javascript

你能在 JavaScript for 循环中使用复合条件语句吗？

这是一个例子，

```
//using a compound conditional statement
//within a for loop, JavaScript
for (var i=0; i < res.length && i < 5; i++) {};

//or
for (var i=0; i < res.length || i < 5; i++) {}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:00:49.810

是的，它可能会导致逻辑错误——就像任何其他代码一样。希望您测试您的代码，以便您可以找到这些错误并修复它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T23:00:45.230

布伦特 - 这两种说法不一样。您正在尝试使用[德摩根定律](http://en.wikipedia.org/wiki/De_Morgan%27s_laws)。因此第二个陈述应该是

```
for (var i=0; i >= res.length || i >= 5; i++) {}; 
```

这样做会更好

```
var end = res.length < 5 ? res.length : 5;

for (var i=0; i < end; ++i) {} 
```

这将减少开销或执行计算何时终止循环的逻辑。

# android - 我可以访问来自不同语言环境的 android 资源吗？

> ID：10874589
> 
> 赞同：10
> 
> 时间：2012-06-03T22:52:21.723
> 
> 标签：android, locale

我的应用程序中有两个语言环境。我可以在不更改当前语言环境的情况下访问资源，例如来自不同语言环境的字符串数组吗？我的意思是编码我不喜欢在设置中更改它。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2015-11-10T11:41:19.393

更好的解决方案是（如果您使用的是 API 17）：

```
@NonNull
protected String getEnglishString() {
    Configuration configuration = getEnglishConfiguration();

    return getContext().createConfigurationContext(configuration).getResources().getString(message);
}

@NonNull
private Configuration getEnglishConfiguration() {
    Configuration configuration = new Configuration(getContext().getResources().getConfiguration());
    configuration.setLocale(new Locale("en"));
    return configuration;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-04T09:35:33.847

如果 cMK 是来自当前语言环境的字符串数组并且 cEN 是来自不同语言环境的字符串数组，那么这是对我有用的代码

```
 cMK = getResources().getStringArray(R.array.cities);

         Configuration confTmp =new Configuration( getResources().getConfiguration());

         confTmp.locale = new Locale("en");

         DisplayMetrics metrics = new DisplayMetrics();

         getWindowManager().getDefaultDisplay().getMetrics(metrics);

         Resources resources = new Resources(getAssets(), metrics, confTmp);

         /* get localized string */
         cENG = getResources().getStringArray(R.array.cities); 
```

当前的语言环境没有改变，这就是重点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-03T22:54:52.677

是的你可以。您必须创建一个新`Resources`对象来指定预期的`Configuration`.

参考：http: [//developer.android.com/reference/android/content/res/Resources.html#Resources%28android.content.res.AssetManager,%20android.util.DisplayMetrics,%20android.content.res.Configuration% 29](http://developer.android.com/reference/android/content/res/Resources.html#Resources%28android.content.res.AssetManager,%20android.util.DisplayMetrics,%20android.content.res.Configuration%29)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T10:32:45.527

在 Java 7（所以不是 android）中，可以为格式资源设置不同的区域设置，并为显示设置不同的区域设置：

```
Locale.setDefault(DISPLAY, Locale.PL);
Locale.setDefault(FORMAT, Locale.US); 
```

类似的线程：[在应用程序本身内更改区域设置](https://stackoverflow.com/questions/2264874/changing-locale-within-the-app-itself/14601938#14601938)。

# jquery - Jquery 推荐旋转器。如何添加下一个和上一个按钮

> ID：10874590
> 
> 赞同：0
> 
> 时间：2012-06-03T22:52:26.567
> 
> 标签：jquery

我正在使用推荐旋转器插件，它运行良好，但我想添加前进和后退按钮，但我不知道从哪里开始。这是我所质疑的所有代码：[jsfiddle 上的代码](http://jsfiddle.net/ambiguous/j4MbH/10/)

任何帮助表示赞赏

问候阿什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:44:01.677

好的，我在循环中放置了一些听众，经过快速测试后似乎可以工作了！这是 js 小提琴：http: [//jsfiddle.net/BLNZ7/](http://jsfiddle.net/BLNZ7/)

这个想法是为“上一个”和“下一个”按钮或链接提供元素ID。（不，我对这些 ID 不太有创意）

```
<button id="prevId">Prev</button>
<span id="nextId">Next</span>​ 
```

然后在创建旋转器时引用它们：

```
$(".testimonialrotator").testimonialrotator({
        settings_slideshowTime:3,
        nextId: "nextId",
        prevId: "prevId"
        });

}); 
```

旋转器内的侦听器只需调用 gotoNext 并重置“时间缓冲区”，我添加了一个新的类似函数 gotoPrev。

```
 $("#"+o.nextId).on('click', function() {
          gotoNext();
          timebuf = 0;
        });   

        $("#"+o.prevId).on('click', function() {
          gotoPrev();
          timebuf = 0;
        }); 
```

# header - 如何将 Blogger 标题拆分为 2 列？

> ID：10874593
> 
> 赞同：2
> 
> 时间：2012-06-03T22:53:13.987
> 
> 标签：header, blogger

我想问一下如何将我的博客标题分成两列？你能帮我吗？我很难弄清楚...

顺便说一句，我只需要在左侧添加我的徽标，然后在右侧添加 google adsense。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-05T03:54:47.120

Login to Blogger.com Click on the "Template" section. Click on "Jump to Widget" Click on "Header1"

Under the code it jumps to, ie:

```
 <b:section class='header' id='header' maxwidgets='2' showaddelement='no'>
    <b:widget id='Header1' locked='true' title='Your Bog Tittle (Header)' type='Header'>
    </b:widget>
    </b:section> 
```

Insert this code:

```
 <b:section class='header' id='header2' maxwidgets='2' showaddelement='yes'>
    </b:section>
    <div style='clear:both;'/> 
```

Now search for and find: "/b:skin"

ABOVE "/b:skin" insert this code:

```
 #header {
     float:left;
     width:50%;
     }

     #header2 {
     float:right; 
     width:30%; 
     } 
```

You can adjust the percentages based on what you desire.

On the layout page, after you save the template AND REFRESH, you should see an "Add a Gadget" area to the right of your logo, where you can insert your adsense widget.

If things don't look right on the Layout page, place these codes below the other ones:

```
 #layout #header, #layout #header2 {
    padding: 0px !important;
    margin: 0px !important;
    width: 50% !important;
    } 
```

Remember to save your template and also remember to click REFRESH after you save your template.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T22:58:54.340

首先，您需要配置您的博客标题最大小部件。检查它是否超过 2。如果不将其更改为*（假设）* **4**，并在 #header 和 #header2 下添加以下 css 属性：

```
float:left;
width:50%; 
```

您将能够添加水平对齐的新小工具。然后在右侧添加 google adsense，在左侧添加您的徽标。保存您的模板并查看！

# xcode - 从组件构造日期后，NSDate 小时不正确

> ID：10874598
> 
> 赞同：1
> 
> 时间：2012-06-03T22:53:55.930
> 
> 标签：xcode, ios5, nsdate, nscalendar

我正在尝试从两个不同的日期构建一个日期。当我将两个日期分解成各自的组成部分并将它们重新组合成新的日期时……除了时间之外，一切似乎都是正确的。我确定它与时区或 NSGregorianCalendar 有一些简单的关系，但我是 iOS 新手，并且对 NSCalendar 进行了编程。我希望有人能抓住我犯的简单错误。

```
//grab today's date so we can brek it down into components
NSDate *todayDate = [NSDate date];

NSLog(@"Todays Date: %@", todayDate);

NSCalendar *gregorian = [[NSCalendar alloc]
                         initWithCalendarIdentifier:NSGregorianCalendar];

//break down the stored date into components
NSDateComponents *theTime = [gregorian components:(NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit) fromDate:storedIncorrectDate];

NSLog(@"Incorrect Calendar Components %@", theTime);

NSDateComponents *todayCalendarComponents = [gregorian components:(NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit) fromDate:todayDate];

NSInteger currentYear = [todayCalendarComponents year];

NSLog(@"The Year: %i", currentYear);

NSInteger currentMonth = [todayCalendarComponents month];

NSLog(@"The Month: %i", currentMonth);

NSInteger currentDay = [todayCalendarComponents day];

NSLog(@"The Day: %i", currentDay);

NSLog(@"Today's Calendar Components %@", todayCalendarComponents);

NSInteger theHours = [theTime hour];

NSLog(@"Hours: %i", theHours);

NSInteger theMinutes = [theTime minute];

NSLog(@"Minutes: %i", theMinutes);

NSInteger theSeconds = [theTime second];

NSLog(@"Seconds: %i", theSeconds);

//build my new date and store it before we play the affirmation.
NSDateComponents *components = [[NSDateComponents alloc] init];

[components setHour:theHours];
[components setMinute:theMinutes]; 
[components setSecond:theSeconds]; 
[components setYear:currentYear];
[components setMonth:currentMonth];
[components setDay:currentDay];
[components setTimeZone:[NSTimeZone localTimeZone]];

NSLog(@"The Components: %@", components);

NSCalendar *updatedCal = [[NSCalendar alloc]
                          initWithCalendarIdentifier:NSGregorianCalendar];
NSDate *revisedCorrectedDate = [updatedCal dateFromComponents:components]; 

NSLog(@"The Hours: %i", theHours);

NSLog(@"The New and Corrected Date: %@", revisedCorrectedDate); 
```

打印 modifiedCorrectedDate 的日志结果显示我设置的所有内容都正确，但小时数除外。这必须是一个简单的修复..我只是没有看到它。先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T01:19:12.710

你确定这是不正确的？当我运行此代码时，我得到：

> 2012-06-03 18:13:36.130 无标题[39805:707] 新更正日期：2012-06-04 01:13:36 +0000

目前是 6/3/12 18:13:36，显示的日期是 6/4/12 01:13:36，这是正确的时间，以 UTC 表示（注意末尾的 +0000）。

# actionscript-3 - AS3 - 从类中将对象添加到 MovieClip Container

> ID：10874609
> 
> 赞同：0
> 
> 时间：2012-06-03T22:56:38.010
> 
> 标签：actionscript-3, class, addchild

我对在 AS3 中添加使用类有点陌生，到目前为止，我只是在电影的 frame1 上做所有事情。我想我最终应该学习类，所以这里是 :) 当我将对象添加到屏幕上时，我喜欢将它们组合在容器对象中以供以后使用。所以我有一个正在构建的 Hex 板，我试图将它们放入一个名为 hexContainer 的电影剪辑中，我在舞台上放置了它。现在，如果我像往常一样执行此代码，我只会执行 hexContainer.addChild(tempHex)。但是，这给我一个错误 1120。

我的课程代码如下：

```
package  
{
import flash.display.MovieClip
import Hex
import flash.display.Stage

public class Boards extends Hex
{
    public function buildBoardOne()
    {
        for(var i:int = 1; i <= 5; i++)
        {
            var tempHex:Hex = new Hex();
            tempHex.x = 100;
            tempHex.y = 100;
            hexContainer.addChild(tempHex);
        }
    }

} 
```

}

我一开始只是将这些添加到舞台上，但当我这样做时出现错误，这就是 import 语句存在的原因。我在谷歌上查了一下，找出原因，这就是他们所说的。

现在，当我将这些添加到舞台时，它工作正常。我可以得到我的格子并操纵它们，我们参加了聚会，那是一段美好的时光。现在我正试图将它们放入容器电影剪辑中，它们对我很生气，我就是无法安抚它们：p

你们能给我的任何帮助将不胜感激。

编辑代码以测试 OkGraphics 的建议：

```
package  
{
    import flash.display.MovieClip
    import Hex
    import flash.display.Stage

    public class Boards extends Hex
    {
        var hexContainer:MovieClip = new MovieClip();
        stage.addChild(hexContainer);

        public function buildBoardOne()
        {
            for(var i:int = 1; i <= 5; i++)
            {
                var tempHex:Hex = new Hex();
                tempHex.x = 100;
                tempHex.y = 100;
                stage.addChild(tempHex);
            }
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T06:06:55.310

您收到 1120 错误，因为 hexContainer 未在此包中定义。您要么（1）需要`var hexContainer = [your_reference_here]`在尝试向其添加子项之前声明，

或者

(2)您可以将十六进制作为子类添加到 Boards 类中，然后将其添加到您的 hexContainer 中。而不是`hexContainer.addChild(TempHex);`仅仅放`addChild(TempHex);`

还有很多其他方法可以做到这一点，但我认为这两种是最直接的方法。

# php - 尝试替换两个 php 函数时的奇怪行为导致 html

> ID：10874610
> 
> 赞同：0
> 
> 时间：2012-06-03T22:57:13.947
> 
> 标签：php, function, templates, replace

模板文件是 .php 并且有这些占位符：

```
<ul>
<li><a href='a.php'>{{placeholder1}}</a></li>
{{placeholder2}}
</ul> 
```

这是替换它们的代码：

```
$file = file_get_contents($template);
$file = str_ireplace('{{placeholder1}}', count_messages(), $file);
$file = str_ireplace('{{placeholder2}}', show_link(), $file);
print $file; 
```

函数没什么特别的（'functions.php'）：

```
function count_messages()
{
  ob_start();
  if (preg_match('/^[A-Za-z0-9_]{3,40}$/', $_SESSION['username']))
  {
    $table = $_SESSION['username'];
  }
  else
  {
    header('Location: login.php');
    exit();
  }

  try
  {
    $db = new PDO('sqlite:site.db');
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $result = $db->prepare("SELECT Count(*) FROM `$table` WHERE `isRead` = '0'");
    $result->execute();
    $count = $result->fetchColumn();
    if ($count > 0)
    {
      print "<b style='color: #00ff00; text-decoration: blink;'>$count</b> <b style='font-size: 6pt; text-decoration: blink; text-transform: uppercase;'>unread</b> ";
    }
    unset($db);
  }

  catch(PDOException $e)
  {
    echo $e->getMessage();
  }
  ob_end_flush();
} 
```

* * *

```
function show_link()
{
  ob_start();
  if ($_SESSION['username'] == "admin")
  {
    print "<li><a href='admin_panel.php' target='main_iframe'><b style='color: #ffff00;'>Admin Panel</b></a></li>;
  }
  ob_end_flush();
} 
```

首先计算带有某种样式的消息和输出编号，如果用户名是“admin”，则第二个添加到菜单“管理面板”链接。

问题是（php 日志中没有错误）： count_messages() 有效，但在页面上的所有元素上方输出“n unread”。show_link() 不输出链接。

文件 $template 是可读的并命名为 template.php：

```
<?php

session_start();

if(!$_SESSION['islogged'])
{
  header('Location: login.php');
    exit();
}

require_once('functions.php');

?>
<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="UTF-8" />
<meta name="description" content="Documents" />           
<link rel="stylesheet" type="text/css" href="style.css" />
<title>Documents</title>
</head>
<body>

<div id="main">
<iframe src="documents.php" name="main_iframe" id="main_iframe">
</iframe>
</div>

<div id="main_menu">
<ul id="menu_list">
<li><a href="messages.php" target="main_iframe">{{placeholder1}}Messages</a></li>
{{placeholder2}}
<li><a href="logout.php" style="font-weight: bold; color: #ff0000">Log out</a></li>
</ul>
</div>
</body>
</html> 
```

index.php：

```
<?php

session_start();

require_once('functions.php');

$template = 'template.php';

if (file_exists($template))
{
  if (is_readable($template))
  {
    if(!$_SESSION['islogged'])
    {
      session_destroy();
      header('Location: login.php');
      exit();
    }
  }
  else
  {
    print "Template file cannot be opened";
  }
}
else
{
  print "Template file doesn't exist";
}

$file = file_get_contents($template);
$file = str_ireplace('{{placeholder1}}', count_messages(), $file);
$file = str_ireplace('{{placeholder2}}', show_link(), $file);
print $file;
?> 
```

我希望这里有人知道导致这种行为的原因......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:12:01.300

您在`str_ireplace`函数调用中使用函数的结果值，但函数不返回任何内容，它们缺少`return`语句。

您可能打算在代码中使用`return ob_get_clean();`而不是。`ob_end_flush();`

# python - 子进程调用错误，无效的应用程序

> ID：10874619
> 
> 赞同：1
> 
> 时间：2012-06-03T22:58:50.707
> 
> 标签：python, python-2.7, subprocess

所以我在使用 subprocess.call() 时遇到了问题，我想我可能只是说错了。我在用：

```
subprocess.call('testingosfile.py') 
```

我得到了回溯：

```
Traceback (most recent call last):
  File "<pyshell#14>", line 1, in <module>
    subprocess.call('testingosfile.py')
  File "C:\Python27\lib\subprocess.py", line 493, in call
    return Popen(*popenargs, **kwargs).wait()
  File "C:\Python27\lib\subprocess.py", line 679, in __init__
    errread, errwrite)
  File "C:\Python27\lib\subprocess.py", line 893, in _execute_child
    startupinfo)
WindowsError: [Error 193] %1 is not a valid Win32 application 
```

内容`testingosfile.py`是：

```
print "hello world!"
raw_input('....') 
```

我如何设法让它运行？

预先感谢您的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:03:16.510

错误消息非常有意义 - 使用`subprocess`，您只能启动可执行文件。因此，要修复它，您应该启动一个可执行文件。具体来说，您应该启动 Python 解释器并告诉它运行您的脚本。就像是

```
subprocess.call(['python.exe', 'testingosfile.py']) 
```

应该可以工作，尽管您可能必须提供 Python 解释器的完整路径（我目前无法测试）。

但是，您是否考虑过导入`testingosfile.py`？每当您导入 Python 脚本时，该脚本中的所有命令都会运行。使用

```
import testingosfile 
```

在函数内部执行命令会很糟糕，但是您可以将有用的命令打包`testingosfile.py`到某个函数中。然后，你可以使用

```
import testingosfile 
```

在主脚本的顶部，只要您想打印 Hello World 并获取用户的输入，只需调用该函数即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-26T23:41:28.713

尝试 subprocess.call("myfile.ext", shell=True)

# asp.net - ASP.NET AJAX 不为 en-US 语言环境呈现 __cultureInfo JS 对象

> ID：10874621
> 
> 赞同：2
> 
> 时间：2012-06-03T22:59:04.553
> 
> 标签：asp.net, ajax, localization, cultureinfo, scriptmanager

我在我的网站上使用**ASP.NET AJAX 控件**，并在 ScriptManager 上启用了以下设置：

```
scriptManager.EnableScriptGlobalization = true;
scriptManager.EnableScriptLocalization = true; 
```

当我将浏览器语言切换为法语时，我会在页面上呈现一个名为**__cultureInfo**的丰富 JavaScript 对象，其中包含初始化日期选择器和正确格式化日期字符串所需的所有好东西。

但是，当区域设置为美国英语时，不会呈现**__cultureInfo**对象。

有没有办法强制 ASP.NET AJAX 为**所有**语言环境呈现这个 JavaScript 变量/对象？我想初始化我所有的语言环境感知控件，而不必使用特殊的美国英语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T23:50:22.937

Microsoft 将 Invarient 文化克隆到 en-US，因此即使未加载 __cultureInfo，您也应该在**Sys.CultureInfo.CurrentCulture中拥有所需的一切**

```
switch(typeof(cultureInfo)) {
case "string":
    // this is true when the server is 3.5
    cultureInfo = window.eval("(" + cultureInfo + ")");
    // allow fallthrough to object
case "object":
    this.CurrentCulture = this._parse(cultureInfo);
    delete __cultureInfo;
    break;
default:
    cultureInfo = clone(invariant);
    // fix up the differences
    cultureInfo.name = "en-US";
    cultureInfo.numberFormat.CurrencySymbol = "$";
    var dtf = cultureInfo.dateTimeFormat;
    dtf.FullDatePattern = "dddd, MMMM dd, yyyy h:mm:ss tt";
    dtf.LongDatePattern = "dddd, MMMM dd, yyyy";
    dtf.LongTimePattern = "h:mm:ss tt";
    dtf.ShortDatePattern = "M/d/yyyy";
    dtf.ShortTimePattern = "h:mm tt";
    dtf.YearMonthPattern = "MMMM, yyyy";
    this.CurrentCulture = this._parse(cultureInfo);
    break;
} 
```

# css - 使用 .css 文件不显示图像

> ID：10874628
> 
> 赞同：0
> 
> 时间：2012-06-03T22:59:47.397
> 
> 标签：css

我下载了一个免费模板，我想将它用于我的网站（在 Visual Studio 2010 中使用 c#）。我把标签放在里面，但它只显示一种颜色，没有图像。我将图片文件夹、style.css 文件和 index.html 放在项目中的同一层次结构中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T15:55:21.270

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Pocetna.aspx.cs" Inherits="Pocetna" %>

 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">;

 <html xmlns="w3.org/1999/xhtml">; 
    <head runat="server">
      <title>Добродојдовте</title>
      <link rel="stylesheet" type="text/css" href="~/style.css" />
    </head>
   <body> 
   <form id="form1" runat="server">  </form>
   </body>
 </html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T16:04:59.410

你用firefox还是chrome？使用 Web 开发人员工具查看您的页面是否真的在说。然后你可能会知道错误发生在哪里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T04:47:33.170

您复制的 CSS 具有图像的相对路径。您将需要将路径更改为绝对路径，或者需要从远程位置（从您复制 css 的位置）复制图像并将其放入本地目录中的所需位置

# android - Android：使用if语句选择表进行数据插入

> ID：10874636
> 
> 赞同：1
> 
> 时间：2012-06-03T23:01:29.157
> 
> 标签：android, sql

我在一个数据库中有几个数据库表。用户输入要插入数据库的数据，微调器值之一是指定数据应该进入哪个表。

插入适用于一张桌子。但是，只要我放入 if 语句以将数据放入正确的表中，就不会在任何地方插入任何内容。我在 logcat 中得到的错误是“没有这样的表：DATABASE_TABLE”，这对我来说没有意义，因为如果没有 if 语句，插入就没有问题。

这是我的代码：

**更新以包含完整代码

```
int id = 0;

//setting up columns
public static final String KEY_ID = "_id";
public static final String KEY_EXERCISE = "abs";
public static final String KEY_REPS = "reps";
public static final String KEY_TIMETYPE = "timetype";

//setting up the database
private static final String DATABASE_NAME = "ExerciseDB";
private static final String DATABASE_TABLE = "ExerciseTable";
private static final String DATABASE_BICEPSTABLE = "BicepsTable";
private static final int DATABASE_VERSION = 2;

//setting up tables
private static final String DATABASE_TABLE_ABS = "CREATE TABLE " + 
DATABASE_TABLE + " (" + 
KEY_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
KEY_REPS + " TEXT NOT NULL, " +
KEY_TIMETYPE + " TEXT NOT NULL, " +
KEY_EXERCISE + " TEXT NOT NULL);";

private static final String DATABASE_TABLE_BICEPS = "CREATE TABLE " + 
DATABASE_BICEPSTABLE + " (" + 
KEY_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
KEY_REPS + " TEXT NOT NULL, " +
KEY_TIMETYPE + " TEXT NOT NULL, " +
KEY_EXERCISE + " TEXT NOT NULL);";

private static String CHOSEN_TABLE = "";

private DbHelper ourHelper;
private static Context ourContext;
private SQLiteDatabase ourDatabase;

public static class DbHelper extends SQLiteOpenHelper{

    public DbHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        // TODO Auto-generated constructor stub
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // Only uses this method when the database is first created.
        //Sets up the database - telling it the table name and all
        //the column names.
        db.execSQL(DATABASE_TABLE_ABS);

        //syntax used to insert rows into a database on creation
        db.execSQL("INSERT INTO " + DATABASE_TABLE + "(" + KEY_EXERCISE +", " + KEY_REPS +", " + KEY_TIMETYPE + ") VALUES ('Reverse Crunches', '25', 'Reps' );" );

        //setting up Biceps Table
        db.execSQL(DATABASE_TABLE_BICEPS);

        //syntax used to insert rows into a database on creation
        db.execSQL("INSERT INTO " + DATABASE_BICEPSTABLE + "(" + KEY_EXERCISE +", " + KEY_REPS +", " + KEY_TIMETYPE + ") VALUES ('Hammer Curls', '15', 'Reps' );" );

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // called when database has already been created.
        db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE);
        db.execSQL("DROP TABLE IF EXISTS " + DATABASE_BICEPSTABLE);
        onCreate(db);           
    }       
}

public ExerciseDatabase(Context c){
    ourContext = c;
}

//to open the database
public ExerciseDatabase open()throws SQLException{
    ourHelper = new DbHelper(ourContext);
    ourDatabase = ourHelper.getWritableDatabase();
    return this;
}

//to close the database
public void close(){
    ourHelper.close();
}

//to retrieve all the data from the database
public String getData() {
    String[] columns = new String[]{KEY_REPS, KEY_EXERCISE, KEY_TIMETYPE};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, null, null, null, null, null);
    String result = "";

    int iReps = c.getColumnIndex(KEY_REPS);
    int iExercise = c.getColumnIndex(KEY_EXERCISE);
    int iTimeType = c.getColumnIndex(KEY_TIMETYPE);

    for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()){
        result = result + c.getString(iExercise) + " " 
        + c.getString(iReps) + " "
        + c.getString(iTimeType) + "\n";
    }

    return result;
}

public String getBicepsData() {
    String[] columns = new String[]{KEY_REPS, KEY_EXERCISE, KEY_TIMETYPE};
    Cursor c = ourDatabase.query(DATABASE_BICEPSTABLE, columns, null, null, null, null, null);
    String result = "";

    int iReps = c.getColumnIndex(KEY_REPS);
    int iExercise = c.getColumnIndex(KEY_EXERCISE);
    int iTimeType = c.getColumnIndex(KEY_TIMETYPE);

    for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()){
        result = result + c.getString(iExercise) + " " 
        + c.getString(iReps) + " "
        + c.getString(iTimeType) + "\n";
    }

    return result;
}

//to count the number of entries in the database    
public int EntryCount(){

    return (int) DatabaseUtils.queryNumEntries(ourDatabase,DATABASE_TABLE);

    }

//adds an entry to the database that the user inputs into the text fields   
public long addExercise(String exerciseadd, String repTimeAdd, String timetype, String exercisetype) {

    if (exercisetype == "abs"){
        CHOSEN_TABLE = "DATABASE_TABLE";
    }else if (exercisetype == "biceps"){
        CHOSEN_TABLE = "DATABASE_BICEPSTABLE";
    }

    ContentValues cv = new ContentValues();
        cv.put(KEY_EXERCISE, exerciseadd);
        cv.put(KEY_REPS, repTimeAdd);   
        cv.put(KEY_TIMETYPE, timetype);
        return ourDatabase.insert(CHOSEN_TABLE, null, cv);

}

//gets an entry from the Reps column by chosen row number (randomly generated in main activity) 
public String getReps(int chosenRow) {
    // TODO Auto-generated method stub
    if (chosenRow == 0){
        ++chosenRow;
    }

    String[] columns = new String[]{KEY_REPS, KEY_EXERCISE, KEY_TIMETYPE};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_ID + "=" + chosenRow, null, null, null, null);
    if(c != null){
        c.moveToFirst();
        String exercise = c.getString(0);
        return exercise;
    }
    return null;
}

//gets an entry from the Abs column by chosen row number (randomly generated in main activity) 
public String getExercise(int chosenRow) {
    // TODO Auto-generated method stub
    if (chosenRow == 0){
        ++chosenRow;
    }

    String[] columns = new String[]{KEY_REPS, KEY_EXERCISE, KEY_TIMETYPE};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_ID + "=" + chosenRow, null, null, null, null);
    if(c != null){
        c.moveToFirst();
        String reps = c.getString(1);
        return reps;
    }
    return null;
}

//gets an entry from the timetype column by chosen row number (randomly generated in main activity) 
public String getTimeType(int chosenRow) {
    // TODO Auto-generated method stub
    if (chosenRow == 0){
        ++chosenRow;
    }

    String[] columns = new String[]{KEY_REPS, KEY_EXERCISE, KEY_TIMETYPE};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_ID + "=" + chosenRow, null, null, null, null);
    if(c != null){
        c.moveToFirst();
        String reps = c.getString(2);
        return reps;
    }
    return null;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:21:48.267

作为`DATABASE_TABLE`一个字符串变量，你应该使用`CHOSEN_TABLE = DATABASE_TABLE;`（不带引号）......和相同的`CHOSEN_TABLE = DATABASE_BICEPSTABLE;`（不带引号）。

此外，您不能`==`用于比较字符串。采用...

```
if (exercisetype.equals("abs")){
    CHOSEN_TABLE = DATABASE_TABLE;
}else if (exercisetype.equals("biceps")){
    CHOSEN_TABLE = DATABASE_BICEPSTABLE;
} 
```

# javascript - jquery ajaxform 全局函数

> ID：10874639
> 
> 赞同：0
> 
> 时间：2012-06-03T23:02:06.220
> 
> 标签：javascript, ajax, jquery

我们在我们的网站上使用[jQuery 表单插件。](http://jquery.malsup.com/form/#getting-started)我们需要能够在所有表单上发生提交时显示加载 gif。到目前为止，我已经能够像下面这样完成这项工作

```
 $("#uploadAssetImageForm").ajaxForm({
        dataType: 'json',
        beforeSubmit: function () {Cvrs.SetLoading(true, '#uploadAssetImageForm')},
        success: function(asset) {
            Cvrs.SetLoading(false, '#uploadAssetImageForm');
        $("#uploadAssetImageDiv").dialog("close");
            $(":input", "#uploadAssetImageDiv").not(':button, :submit, :reset').val('').removeAttr('checked').removeAttr('selected');
            ReplaceAsset(asset);

        }
    }); 
```

特别是我正在谈论的部分是 beforeSubmit 函数和再次调用以在成功时将其设置为 false。

设置加载仅显示加载 gif 和禁用的表单按钮

```
function(isLoading, form) {

isLoading ? $(form + ' input[type="submit"]').attr("disabled", true) :
    $(form + ' input[type="submit"]').removeAttr("disabled");

isLoading ? $(form + ' .loading-animation').show() :
    $(form + ' .loading-animation').hide(); 
```

有什么方法可以调用 ajaxform 在 beforeSubmit 上运行该代码并成功以及可能存在的任何其他代码（尽管首先运行加载的东西）还是我必须通过每个案例并添加这在？

我知道我必须将加载参考放在每个表单中，但这很有意义，因为不同的表单可能需要在不同的位置加载 gif

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:30:25.660

您可以考虑使用[ajaxSend](http://api.jquery.com/ajaxSend/)事件。它在触发 AJAX 发送事件之前触发：

```
$(document).bind('ajaxSend', function(e, request, options) {
    Cvrs.SetLoading(true, '#uploadAssetImageForm');
}); 
```

我希望它有帮助！

# python - 如何将 python tkinter 窗口嵌入浏览器？

> ID：10874641
> 
> 赞同：7
> 
> 时间：2012-06-03T23:02:28.053
> 
> 标签：python, numpy, matplotlib, tkinter

好的..python 程序的输出显示在 Tkinter 窗口中..单独打开。我想要做的是在浏览器中嵌入这个窗口。这是代码：

```
import numpy as np
import matplotlib
import matplotlib.cbook as cbook
import matplotlib.image as image
import matplotlib.pyplot as plt

datafile = cbook.get_sample_data('logo2.png', asfileobj=False)

print 'loading', datafile

im = image.imread(datafile)

im[:,:,-1] = 0.5  # set the alpha channel

fig = plt.figure()

ax = fig.add_subplot(111)

ax.plot(np.random.rand(20), '-o', ms=20, lw=2, alpha=0.7, mfc='orange')

ax.grid()

fig.figimage(im, 10, 10)

plt.show() 
```

考虑所有变量都是从浏览器表单字段中给出的输入参数。请帮忙！！:-)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T02:50:19.993

根据[Joe Kington](https://stackoverflow.com/questions/3354883/matplotlib-interactive-plot-on-a-web-server)对类似问题的回答，后端[mplh5canvas](http://code.google.com/p/mplh5canvas/)可能是您正在寻找的。调整您的示例代码以使用它，

```
import numpy as np
import matplotlib
import mplh5canvas

matplotlib.use('module://mplh5canvas.backend_h5canvas')

import matplotlib.cbook as cbook
import matplotlib.image as image
import matplotlib.pyplot as plt

fig = plt.figure()

ax = fig.add_subplot(111)

ax.plot(np.random.rand(20), '-o', ms=20, lw=2, alpha=0.7, mfc='orange')

ax.grid()

plt.show(open_plot=True) 
```

它似乎与您正在寻找的那种交互性很好地配合，甚至允许动画。话虽如此，它并不支持所有浏览器，如它的[安装 wiki 页面](http://code.google.com/p/mplh5canvas/wiki/Installation)中所述。如果限制使用 Chrome、Safari 或 Opera 是可以接受的（在这种情况下，有一些配置，请检查该页面），那么它应该很适合您，尽管可能还需要一些实验。

# php - 删除除 PHP 中给定列表之外的所有字符

> ID：10874642
> 
> 赞同：0
> 
> 时间：2012-06-03T23:02:41.387
> 
> 标签：php

我已经绞尽脑汁在网上搜索了一个多小时......

例如，我在 PHP 中寻找一个类似于“修剪”的函数，但它会删除除给定列表中的字符之外的任何字符；

```
$niceChars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_+";
$rawString = "myString";
$happyString = removeNastyNess($rawString, $niceChars); 
```

有没有这样的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:06:16.623

最好的选择是使用[正则表达式](http://www.php.net/manual/en/regexp.reference.escape.php)。你漂亮的字符集看起来像`[\w-+]`规则。因此，解决方案可能如下。

```
$happyString = preg_replace("/[^\w-+]/", "", $rawString); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T23:06:35.493

`preg_replace("|[^abcdef]|", '')`? （其中 abcdef 是允许的字符）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T23:38:41.637

没有正则表达式：

```
function removeNastyNess($rawString, $niceChars) {
    return implode('', array_intersect(str_split($rawString), str_split($niceChars)));
} 
```

# php - bind_param() 有什么作用？

> ID：10874644
> 
> 赞同：7
> 
> 时间：2012-06-03T23:03:03.990
> 
> 标签：php, mysqli, prepared-statement, bindparam

```
$resultSpendStmt = $connection->prepare(...);
$array->bind_param("sdidi", $A, $B, $C, $D, $E);
$array->execute();
$array->store_result();
$array->bind_result($F, $G, $H, $I, $J, $K); 
```

我仍然有点不确定 bind_param 是做什么的。有人可以举个例子说明什么是手段吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-03T23:10:29.260

准备 SQL 语句时，可以`?`在列值所在的位置插入占位符 ( )，然后使用该占位符**安全地**`bind_param()`替换实际列的值。这可以防止任何 SQL 注入的可能性。

 **[您可以在此处阅读有关 bind_param() 的更多信息。](http://www.php.net/manual/en/mysqli-stmt.bind-param.php)**

# html - html5的悬停效果，没有javascript或css

> ID：10874653
> 
> 赞同：1
> 
> 时间：2012-06-03T23:04:32.620
> 
> 标签：html, hover, effects

我正在尝试在此[小提琴](http://jsfiddle.net/424WK/)中对表格的单元格进行悬停->突出显示效果，因此它们看起来像按钮。我不能使用任何 javascript 或 CSS，但我可以使用 HTML5。有谁知道该怎么做。我知道HTML5中有一个`onmouseover`属性，只是还没有太多经验。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:27:31.200

你不能。如果你想根据用户的行为改变给定元素的外观，你必须使用 JavaScript（基于事件）或 CSS 伪类`:hover`。

但是，如果您可以编辑内容的 HTML，那么您应该能够插入自定义`<style>`元素或添加事件侦听器。请注意，第一个在 HTML4* 中无效，在 HTML5 中，您可以使用该`scoped`属性[仅设置给定范围](http://www.w3.org/TR/2012/WD-html5-20120329/the-style-element.html#the-style-element)的样式（但我认为此行为尚未在任何浏览器中实现）。

*即使生成的代码 HTML4 不再有效，此解决方案也应该有效。

# c++ - 提升日期时间解析字符串

> ID：10874654
> 
> 赞同：7
> 
> 时间：2012-06-03T23:04:53.773
> 
> 标签：c++, datetime, boost, timezone

我看过很多例子似乎可以解决这个简单的案例。我要解析的字符串是：

“2012-06-01 16:45:34 美国东部时间”

我试图用`local_time_input_facet`以下方法创建一个： `"%Y-%m-%d %H:%M:%S %Z"`

对象的区域指针`local_date_time`始终未设置。阅读文档令人困惑：

> %Z *！完整时区名称（仅输出）。将 time_facet 与 ptime 一起使用时，将忽略此标志。

"EDT" // 东部夏令时间

有没有人这样做过？

更新：我更新了代码以更好地说明问题：

```
using namespace std;
using namespace boost::local_time;

int main()
{
    stringstream ss;

    // Set up the input datetime format.
    local_time_input_facet *input_facet 
    = new local_time_input_facet("%Y-%m-%d %H:%M:%S %ZP");
    ss.imbue(std::locale(ss.getloc(), input_facet));

    local_date_time ldt(not_a_date_time),ldt1(not_a_date_time);

    // Read a time into ldt
    ss.str("2012-06-01 17:45:34 EDT");
    ss >> ldt;

    ss.str("2012-06-01 17:45:34 CDT");
        ss >> ldt1;
        std::cerr << (ldt - ldt1).total_seconds() << std::endl;

    // Write the time to stdout.
    cout << "Full Time:\t"   << ldt.to_string() << endl;
    cout << "Local time:\t"  << ldt.local_time() << endl;
    cout << "Time zone:\t"   << ldt.zone_as_posix_string() << endl;
    cout << "Zone abbrev:\t" << ldt.zone_abbrev() << endl;
    cout << "Zone offset:\t" << ldt.zone_abbrev(true) << endl;

    cout << "Full Time:\t"   << ldt1.to_string() << endl;
    cout << "Local time:\t"  << ldt1.local_time() << endl;
    cout << "Time zone:\t"   << ldt1.zone_as_posix_string() << endl;
    cout << "Zone abbrev:\t" << ldt1.zone_abbrev() << endl;
    cout << "Zone offset:\t" << ldt1.zone_abbrev(true) << endl;

    return 0;
} 
```

输出：

```
0
Full Time:  2012-Jun-01 17:45:34 EDT
Local time: 2012-Jun-01 17:45:34
Time zone:  EDT+00
Zone abbrev:    EDT
Zone offset:    +0000
Full Time:  2012-Jun-01 17:45:34 CDT
Local time: 2012-Jun-01 17:45:34
Time zone:  CDT+00
Zone abbrev:    CDT
Zone offset:    +0000 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-04T00:13:51.303

## 错误

根据此处的boost文档：http: [//www.boost.org/doc/libs/1_57_0/doc/html/date_time/date_time_io.html#date_time.format_flags](http://www.boost.org/doc/libs/1_57_0/doc/html/date_time/date_time_io.html#date_time.format_flags)

`%Z`是：

> 完整时区名称（**仅输出**）。

它还说`%ZP`：

> Posix 时区字符串（可用于**输入**和输出）。

因此，您需要更改`%Z`为`%ZP`. 现在您的时间戳将解析。但是，您会注意到不会设置区域偏移量。

## Posix 时区字符串

对于 Posix 时区字符串，您至少需要指定时区缩写和与 UTC 的偏移量，例如`EST-5`.

完整的 Posix 时区字符串格式为：

```
"std offset dst [offset],start[/time],end[/time]" 
```

没有空格，根据[http://www.boost.org/doc/libs/1_57_0/doc/html/date_time/local_time.html#date_time.local_time.posix_time_zone](http://www.boost.org/doc/libs/1_57_0/doc/html/date_time/local_time.html#date_time.local_time.posix_time_zone)

以下是 EST 和 PST 的完整 Posix 时区字符串的一些示例：

```
EST-5EDT,M3.2.0,M11.1.0
PST-8PDT,M4.1.0,M10.1.0 
```

这包含有关夏令时何时生效的信息。

但是，根据您的处理方式，您可能能够逃脱惩罚`EDT-4`。

应该注意的是，尽管 Posix 时区很简单，但它们的局限性在于它们没有考虑时区规则的历史变化。我认为最好一开始就避免使用时区。

## 如果我无法控制输入格式怎么办？

正如 OP 在评论中指出的那样，偏移量未在他的输入时间戳中列出。一种解决方案是从输入时间戳（例如 ）的末尾读取区域缩写`"EDT"`，并根据已知区域缩写的映射对其进行检查：

```
std::map<std::string, std::string> zone_map;
zone_map["EST"] = "EST-5EDT,M4.1.0,M10.5.0";  // Eastern Standard Time
zone_map["EDT"] = zone_map["EST"];            // Eastern Daylight Time
zone_map["PST"] = "PST-8PDT,M4.1.0,M10.1.0";  // Pacific Standard Time
zone_map["PDT"] = zone_map["PST"];            // Pacific Daylight Time
// ... 
```

（请注意，上述 DST 时区应与标准时区相同。）

您也可以只存储简单的 UTC 偏移量：

```
zone_map["EST"] = "EST-5";  // Eastern Standard Time
zone_map["EDT"] = "EDT-4";  // Eastern Daylight Time
// ... 
```

## 工作示例

这是一个使用内置时区数据库的示例：

```
#include <map>
#include <string>
#include <sstream>
#include <iostream>
#include <boost/date_time/local_time/local_time.hpp>

using namespace boost::local_time;

int main()
{
    // A little database of time zones.
    std::map<std::string, std::string> zone_map;
    zone_map["EST"] = "EST-5EDT,M4.1.0,M10.5.0";  // Eastern Standard Time
    zone_map["EDT"] = zone_map["EST"];            // Eastern Daylight Time
    zone_map["PST"] = "PST-8PDT,M4.1.0,M10.1.0";  // Pacific Standard Time
    zone_map["PDT"] = zone_map["PST"];            // Pacific Daylight Time
    // ...

    // This is our input timestamp.
    std::string timestamp = "2012-06-01 16:45:34 EDT";

    // Replace time zone abbrev with full Posix time zone.
    const size_t abbrev_pos = timestamp.find_last_of(' ') + 1;
    const std::string abbrev = timestamp.substr(abbrev_pos);
    timestamp.replace(abbrev_pos, std::string::npos, zone_map[abbrev]);

    std::cout << "Time stamp with full timezone: " << timestamp << std::endl;

    // Set up the input datetime format.
    local_time_input_facet *input_facet = new local_time_input_facet("%Y-%m-%d %H:%M:%S %ZP");
    std::stringstream ss;
    ss.imbue(std::locale(ss.getloc(), input_facet));

    // This is our output date time.
    local_date_time ldt(not_a_date_time);

    // Read the timestamp into ldt.
    ss.str(timestamp);
    ss >> ldt;

    // Write the time to stdout.
    std::cout << "Full Time:\t"   << ldt.to_string() << std::endl
              << "Local time:\t"  << ldt.local_time() << std::endl
              << "Time zone:\t"   << ldt.zone_as_posix_string() << std::endl
              << "Zone abbrev:\t" << ldt.zone_abbrev() << std::endl
              << "Zone offset:\t" << ldt.zone_abbrev(true) << std::endl;

    return 0;
} 
```

这输出：

```
Time stamp with full timezone: 2012-06-01 16:45:34 EST-5EDT,M4.1.0,M10.5.0
Full Time:      2012-Jun-01 16:45:34 EDT
Local time:     2012-Jun-01 16:45:34
Time zone:      EST-05EDT+01,M4.1.0/02:00,M10.5.0/02:00
Zone abbrev:    EDT
Zone offset:    -0400 
```

虽然这里的解决方案可能并不理想，但这是我能看到的唯一方法。

# javascript - javascript函数随机css样式

> ID：10874658
> 
> 赞同：0
> 
> 时间：2012-06-03T23:05:37.727
> 
> 标签：javascript, html, css, coding-style

在课堂上做一些 javascript 练习，但遇到两个问题。我似乎无法让第二个函数 randomViewer() 正常工作，以便它从 Message Cell2 的 CSS 页面中提取随机样式选择。

此外，我不断收到有关我调用单选按钮值的方式的错误消息，我也不知道我在那里做错了什么。

我知道可能有一个更优雅的解决方案来解决所有这些问题，但我需要的是如果有人能指出我所犯的错误，以便我可以纠正它们。

```
<head>
    <title>Assignment 9 Solution</title>
    <link href="a9.css" rel="stylesheet" type="text/css"></link>
    <script>
        var cyclingIndex = 0;

        function cyclingViewer() {
            if (cyclingIndex > 20) cyclingIndex = 0;
            else cyclingIndex++;
            var mc = document.getElementById("MessageCell1");
            mc.className = "myStyle" + cyclingIndex;
            setTimeout("cyclingViewer()", 1000);
            return;
        }
        var randomIndex = 0;

        function randomViewer() {
            randomIndex = Math.floor(Math.random() * 20);
            randomIndex++;
            var mc = document.getElementById("MessageCell2");
            mc.className = "myStyle" + randomIndex;
            setTimeout("randomViewer()", 1000);
            return;
        }

        function selectViewer() {
            var mc = document.getElementByID("MessageCell3");
            mc.style.color = getRadioValue(document.styleForm.color);
            mc.style.fontFamily = getRadioValue(document.styleForm.family);
            mc.style.fontSize = getRadioValue(document.styleForm.sizes);
            mc.style.backgroundColor = getRadioValue(document.styleForm.background);
            return;
        }

        function getRadioValue(radioName) {
            for (i = 0; i < radioName.length; i++) {
                if (radioName[i].checked == true) return radioName[i].value;
            }
        }
    </script>
</head>

<body onload="cyclingViewer();" onload="randomViewer();">
    <table align="center" border="1" bordercolor="black">
        <tr>
            <td align="center">
                <font size="3">
                    <b>STYLE CLASS VIEWER</b>
                </font>
            </td>
        </tr>
        <tr>
            <td id="MessageCell1" align="center" height="50" width="400" class="myStyle1">
                <div id="MessageText">Hello World Wide Web!</div>
            </td>
        </tr>
    </table>
    <hr/>
    <table align="center" border="1" bordercolor="black">
        <tr>
            <td align="center">
                <font size="3">
                    <b>STYLE CLASS VIEWER</b>
                </font>
            </td>
        </tr>
        <tr>
            <td id="MessageCell2" align="center" height="50" width="400" class="myStyle1">
                <div id="MessageText">Hello World Wide Web!</div>
            </td>
        </tr>
    </table>
    <hr/>
    <form name="styleForm">
        <table align="center" border="0">
            <tr>
                <td>
                    <table align="center" border="1" bordercolor="black">
                        <tr>
                            <td align="center">
                                <font size="3">
                                    <b>STYLE CLASS VIEWER</b>
                                </font>
                            </td>
                        </tr>
                        <tr>
                            <td id="MessageCell3" align="center" height "50" width="400" class="myStyle1">
                                <div id="MessageText">Hello World Wide Web!</div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td>
                    <p>
                        <h4>SELECT FONT COLOR:</h4>
                        <font face="Courier New">
                            <input name="color" value="red" type="radio">red
                            <input name="color" value="black" type="radio">black
                            <input name="color" value="blue" type="radio">blue
                            <input name="color" value="green" type="radio">green
                            <input name="color" value="white" type="radio">white</font>
                    </p>
                </td>
            </tr>
            <tr>
                <td>
                    <p>
                        <h4>Select Font Family:</h4>
                        <font face="Courier New">
                            <input name="family" value="Arial" type="radio">Arial
                            <input name="family" value="Veranda" type="radio">Veranda
                            <input name="family" value="Courier" type="radio">Courier
                            <input name="family" value="Times" type="radio">Times
                            <input name="family" value="Helvetica" type="radio">Helvetica</font>
                    </p>
                </td>
            </tr>
            <tr>
                <td>
                    <p>
                        <h4>Select Font Size:</h4>
                        <font face="Courier New">
                            <input name="sizes" value="12" type="radio">12
                            <input name="sizes" value="18" type="radio">18
                            <input name="sizes" value="24" type="radio">24
                            <input name="sizes" value="30" type="radio">30</font>
                    </p>
                </td>
            </tr>
            <tr>
                <td>
                    <p>
                        <h4>Select Background Color:</h4>
                        <font face="Courier New">
                            <input name="background" value="red" type="radio">red
                            <input name="background" value="blue" type="radio">blue
                            <input name="background" value="green" type="radio">green
                            <input name="background" value="black" type="radio">black
                            <input name="background" value="white" type="radio">white</font>
                    </p>
                </td>
            </tr>
            <tr>
                <td>
                    <input type="button" value="Change Style" onClick="selectViewer()">
                </td>
            </tr>
        </table>
    </form>
</body> 
```

和 CSS 样式表 a9.css

```
myStyle1  {color:black; font-family:Arial; font-size:12; background-color:green}
myStyle2  {color:black; font-family:Arial; font-size:18; background-color:red}
myStyle3  {color:black; font-family:Arial; font-size:24; background-color:blue}
myStyle4  {color:black; font-family:Arial; font-size:30; background-color:white}
myStyle5  {color:red; font-family:Verdana; font-size:12; background-color:yellow}
myStyle6  {color:red; font-family:Verdana; font-size:18; background-color:green}
myStyle7  {color:red; font-family:Verdana; font-size:24; background-color:white}
myStyle8  {color:red; font-family:Verdana; font-size:30; background-color:blue}
myStyle9  {color:green; font-family:Courier; font-size:12; background-color:white}
myStyle10 {color:green; font-family:Courier; font-size:18; background-color: red}
myStyle11 {color:green; font-family:Courier; font-size:24; background-color:yellow}
myStyle12 {color:green; font-family:Courier; font-size:30; background-color: purple}
myStyle13 {color:blue; font-family:Times; font-size:12; background-color:yellow}
myStyle14 {color:blue; font-family:Times; font-size:18; background-color:white}
myStyle15 {color:blue; font-family:Times; font-size:24; background-color:red}
myStyle16 {color:blue; font-family:Times; font-size:30; background-color:green}
myStyle17 {color:white; font-family:Helvetica; font-size:12; background-color:black}
myStyle18 {color:white; font-family:Helvetica; font-size:18; background-color:green}
myStyle19 {color:white; font-family:Helvetica; font-size:24; background-color:red}
myStyle20 {color:white; font-family:Helvetica; font-size:30; background-color:blue} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T00:05:57.470

你不能在一个元素中有多个 onLoad 属性，所以你应该先把事情分解一下。

```
 var cyclingIndex=0;
    var randomIndex=0;

    function initializeViewers(){
        setInterval(cyclingViewer,1000);
        setInterval(randomViewer,1000);
    }

    function cyclingViewer(){ ... (minus the setTimeout) }
    function randomViewer(){ ... (minus the setTimeout) }
    function selectViewer(){ ... }
    function getRadioValue(){ ... } 
```

不过，有更好的方法来构建它。你看，这种方式依赖于全局变量，[这](http://c2.com/cgi/wiki?GlobalVariablesAreBad) [是](https://stackoverflow.com/questions/484635/are-global-variables-bad) [不好的](http://oreilly.com/javascript/excerpts/javascript-good-parts/awful-parts.html)。

更安全一点（重新编码最少）的方式是：

```
function initialize() {
    var cyclingIndex, randomIndex, 
        cyclingViewer, randomViewer,
        selectViewer, getRadioValue;

    cyclingIndex=0;
    randomIndex=0;

    cyclingViewer = function() {
        ...
    };

    randomViewer = function() {
        ...
    };

    selectViewer = function() {
        ...
    };

    getRadioValue = function() {
        ...
    };

    getRadioValue = function() {
        ...
    };

    setInterval(cyclingViewer, 1000);
    setInterval(randomViewer, 1000);
} 
```

通过将函数封装为初始化函数中的变量，您可以使其他人的代码无法调用您的代码（在此级别上并不重要，但可以避免您以后搞砸，以防您想声明一个新函数）同名。[在 initializeViewers() 中声明的函数可以访问其中的变量](http://jibbering.com/faq/notes/closures/)。

无论如何，应该这样做。

# java - 适用于 Java 的 Google App Engine 和 Google Cloud Storage

> ID：10874659
> 
> 赞同：1
> 
> 时间：2012-06-03T23:05:46.020
> 
> 标签：java, google-app-engine, google-cloud-storage

我有一个基于 Google App Engine (Java) 的应用程序，它将文件数据存储在 Google Cloud 存储中。

此文件下载 servlet 在我的本地 eclipse 环境中运行良好，当部署到 apppot 域时，这适用于简单的文本文件，但适用于任何文档（显示在浏览器中的新选项卡中），但如果我尝试使用任何其他二进制文件（doc , jpeg, gif 等）似乎什么都不做，在服务器端也没有抛出错误。我直接检查了谷歌云存储中的文件夹，文件被正确存储并且能够直接访问它，但不能通过应用引擎这样做。

如果我遗漏了什么，你能告诉我吗？

下面的代码片段，

```
 try {
             FileService newfileService = FileServiceFactory.getFileService();
             AppEngineFile file = new AppEngineFile(cloudpath) ;
             FileReadChannel channel = newfileService.openReadChannel(file, false);
             BufferedInputStream bis = new BufferedInputStream(Channels.newInputStream(channel));
             BufferedOutputStream bos = new BufferedOutputStream(resp.getOutputStream());
             resp.setHeader("Content-Disposition", "inline;filename=\"" + file.getNamePart() + "");
             int b = 0;
             while((b = bis.read()) != -1) {
                 bos.write(b);
             }
             bos.flush();
         } catch (Exception e) {
             e.printStackTrace();
         } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T02:28:03.020

与其尝试自己流式传输文件，不如使用 BlobstoreService.serve 方法。这需要注意或流式传输，并且可以用于任何大小的文件。

就像是

```
BlobstoreService blobService = BlobstoreServiceFactory.getBlobstoreService();
blobService.serve(blobService.createGsBlobKey(cloudpath), resp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T00:14:57.947

您将尝试以下语句顺序。

```
...
resp.setContentType("application/octet-stream");
resp.setHeader("Content-Disposition", "inline;filename=\"" + file.getNamePart() + "");
BufferedOutputStream bos = new BufferedOutputStream(resp.getOutputStream());

int b=0;
... 
```

# jquery - jQuery appendTo 删除所有 DOM 元素？

> ID：10874661
> 
> 赞同：1
> 
> 时间：2012-06-03T23:06:05.983
> 
> 标签：jquery, html, append

我正在尝试使用 jQuery *.appendTo方法***在两个不同的父 div 之间移动子 div 元素，**但是当代码执行时，页面变为空白并且**所有元素都已从 DOM 中删除**。剩下的就是标签内的纯文本。这是页面的布局方式（但当然不像这个例子那么简单。对于实际站点，请参见下面的链接）：

 ***```
 <div id="flip-container">
    <div id="flip-card">

      <div class="front face" id="frontPage">
      <div id="start"> text content...</div>
      <div id="about"> text content...</div>
      </div>

      <div class="back face" id="backPage">
      <div id="references"> text content... </div>
      <div id="contact"> text content... </div>
      </div>

    </div>
 </div> 
```

我使用 jQuery 使用 appendTo 方法在父正面/背面 div 之间移动子 div：

```
 $("#references").appendTo($("#frontPage")); 
```

仅此代码有效，这只是为了让您了解实际站点的布局方式。

当上面的代码执行时，所有的 div 都被抹去，***只剩下 body 标签和 div content***。因此，*我无法判断 div 是否实际上已正确移动。*这发生在*所有浏览器*中，我尝试了几种不同的 jQuery 方法，例如 prependTo、append、inserAfter 和 clone。所有的结果都是一样的。是**的，指定的 div 确实存在**。显然，我已经疯狂地用谷歌搜索了这个，但我能找到的只是这个，它真的没有回答这个问题：[JQuery append element removes all html dom elements](https://stackoverflow.com/questions/8453032/jquery-append-element-removes-all-html-dom-elements)

那么这里有什么问题，我错过了什么？任何帮助是极大的赞赏。

**对于实际的代码及其失败的地方，请访问以下链接。单击页脚图标之一，然后再次按相同以查看问题出现。**

[http://utvecklingpunkten.se/list2LS/iscroll.html](http://utvecklingpunkten.se/list2LS/iscroll.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T00:00:06.663

查看您的源代码：

```
<div id="statisticsDiv" class="innerPages">
  <script> for(i=0;i<50;i++) {document.write("statistics "+i+"<br>"); }</script>
</div> 
```

您正在使用`document.write`创建页面元素的内容。

现在，当您单击“统计”图标（第二次）时，DIV 将重新定位到页面的不同部分。**这会导致 SCRIPT 块再次执行。[Live example](http://jsfiddle.net/T94LA/1/)** 因此，`document.write`将执行。结果，页面将被破坏。

规则是`document.write`在页面加载事件之后执行时，页面被销毁并替换为提供给的新内容`document.write`。

我的建议是避免`document.write`。相反，在 DOM-ready 事件处理程序中生成内容，并使用 jQuery 查找页面元素并设置它们的内容。***

# bash - 如何反转文本块的顺序

> ID：10874669
> 
> 赞同：11
> 
> 时间：2012-06-03T23:07:08.990
> 
> 标签：bash, sorting, text

如何仅使用 sed 和 cat 之类的 bash 命令来恢复某些文本块的顺序？我想要的是类似 tac 的东西，但不是逐行操作，而是逐块操作。例子：

**从**

```
/Section 3/
Rabbits
Dogs
Cats

/Section 2/
Eagles
Mice

/Section 1/
Dogs
Rabbits
Lemmings 
```

**到**

```
/Section 1/
Dogs
Rabbits
Lemmings

/Section 2/
Eagles
Mice

/Section 3/
Rabbits
Dogs
Cats 
```

在某些文件中，块的开头用斜杠标记，如上例所示。在其他情况下，这些块仅通过它们之间存在一个或多个空行来标记。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T23:13:31.000

在`emacs`中，您可以使用以下`sort-paragraphs`命令：

`Ctrl-x``h``Meta-x``sort-paragraphs``Enter`

* * *

在`vim`：[https ://superuser.com/questions/365094/sort-file-per-paragraph-in-vim](https://superuser.com/questions/365094/sort-file-per-paragraph-in-vim)

* * *

使用基本的 unix 工具：

```
awk -F'\n' -vRS='' -vOFS=',' '{$1=$1}1' input.txt |
    sort |
        tr ',' '\n' |
            sed 's@^/@\n/@' 
```

我使用`awk`将数据转换为 a `csv`，然后`sort`是`csv`，最后我将其转换`csv`回列表样式。

* * *

### 结果：

```
/Section 1/
Dogs
Rabbits
Lemmings

/Section 2/
Eagles
Mice

/Section 3/
Rabbits
Dogs
Cats 
```

* * *

**编辑**：对不起，我没有仔细看你的问题。您可以将`sort`命令更改`tac`为反转顺序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-04T00:39:45.930

如果有空行分隔所有块，

```
awk 'BEGIN{ORS=RS RS;RS=""}{a[NR]=$0}END{for(i=NR;i>0;i--)print a[i]}' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T23:14:20.657

用于`csplit`将它们拆分为单独的文件，将生成的文件名放入另一个文件中，然后用于`tac`获取要合并的文件名。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-18T20:14:43.260

在您的示例中，块之间的区别是什么？2个换行符。在 Emacs Lisp 中，如果文本在字符串中，如果安装[`dash`](https://github.com/magnars/dash.el)and [`s`](https://github.com/magnars/s.el)，则可以使用以下 2 个等效表达式之一：

```
(s-join "\n\n" (nreverse (s-split "\n\n" s))) ; where s is your string
(->> s (s-split "\n\n") nreverse (s-join "\n\n")) 
```

[`->>`](https://github.com/magnars/dash.el#threading-macros-1)是破折号的线程宏，它`s`通过连续的函数调用。想想[*nix 管道](http://xahlee.info/comp/unix_pipes_and_functional_lang.html)：`s | s-split "\n\n" | nreverse | s-join "\n\n"`。

如果你想要一个 Emacs Lisp 函数来打开一个文件，反转块然后将它保存回相同的文件，你也可以安装[f](https://github.com/rejeep/f.el)文件操作库：

```
(defun reverse-blocks (f)
  "F is a filename."
  (interactive "fFind file: ") ; letter `f` is filename goes in first arg
  (let ((s (f-read f))) ; read file into a string
    (--> s
         s-chomp ; remove trailing newline
         (s-split "\n\n" it)
         nreverse
         (s-join "\n\n" it)
         (f-write it 'utf-8 f)))) ; write to the same file 
```

在这里，我使用了另一个尾随宏[`-->`](https://github.com/magnars/dash.el#---x-form-rest-more)，它允许将前一个计算的结果放在表示`it`下一个计算的参数中。例如，如果 的结果`nreverse`是`X`，那么等价的就是`(s-join "\n\n" X)`。最后，假设您不仅要反转，而且要根据单词“Section”后面的数字对块进行排序：

```
(--sort (< (string-to-number (cadr (s-match "/.*?\\([0-9]\\)/" it)))
           (string-to-number (cadr (s-match "/.*?\\([0-9]\\)/" other))))
        it) ; put it instead of nreverse 
```

其中，使用[`dash-functional`](https://github.com/magnars/dash.el#function-combinators-1)相当于：

```
(--sort (-on '<
             (-compose 'string-to-number
                       'cadr
                       (-partial 's-match "/.*?\\([0-9]+\\)/")))
        it) ; put it instead of nreverse 
```

阅读`dash`文档以了解 、[`-on`](https://github.com/magnars/dash.el#-on-operator-transformer)、[`-compose`](https://github.com/magnars/dash.el#-on-operator-transformer)做[`-partial`](https://github.com/magnars/dash.el#-partial-fn-rest-args)什么。

# xcode - 由于未捕获的异常“NSRangeException”而终止应用程序

> ID：10874671
> 
> 赞同：1
> 
> 时间：2012-06-03T23:07:24.133
> 
> 标签：xcode

我正在为 iPhone 设置页面。

当我单击设置页面上的帐户菜单时。它崩溃并向我显示此错误。

*** 由于未捕获的异常“NSRangeException”而终止应用程序，原因：“*** -[__NSArrayM replaceObjectAtIndex:withObject:]: index 4 beyond bounds [0 .. 3]”

你能告诉我应该在哪里看吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:10:50.633

在 Xcode 调试器中，在“ `replaceObjectAtIndex: withObject`”处设置一个全局断点，或者在您的代码中查找对“”的任何和所有调用，`replaceObjectAtIndex: withObject`并在那里设置断点，看看是否可以捕获异常发生的位置/时间。

这里有一些来自[Apple 的 Xcode 文档的帮助，我正在看一个名为 "Breakpoint Navigator" 的章节](http://developer.apple.com/library/ios/#recipes/xcode_help-breakpoint_navigator/articles/adding_an_exception_breakpoint.html#//apple_ref/doc/uid/TP40010433-CH1-SW1)。

# ruby-on-rails - Rails：request.subdomains 在应用程序控制器中引发请求的 undef 方法

> ID：10874673
> 
> 赞同：4
> 
> 时间：2012-06-03T23:07:43.293
> 
> 标签：ruby-on-rails, subdomain

我正在尝试以这种方式提取应用程序控制器中的子域，以供应用程序广泛使用，

```
@subdomain = request.subdomains(0) 
```

虽然此代码适用于任何其他控制器，但在应用程序控制器中它会抛出一个

```
undefined local variable or method `request' for ApplicationController:Class 
```

例外。

我在 Lion 上运行 rails 3.2.2。

我从 DHH 的 basecamp 样式子域的代码片段中借用了它 -

```
class ApplicationController < ActionController::Base
  before_filter :set_current_account
  private
    def set_current_account
      @current_account = Account.find_by_subdomain!(request.subdomains.first)
    end
end 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T23:17:39.787

当您收到该错误时，它正在发生，因为您是`request`在`ApplicationController`类内部而不是方法内部调用。您确定您向我们展示的代码是正确的吗？

# django - 为什么 django 需要一个用于自定义身份验证后端的数据库？

> ID：10874675
> 
> 赞同：3
> 
> 时间：2012-06-03T23:07:52.273
> 
> 标签：django, django-authentication

我实现了一个 django 自定义身份验证后端。我的*authenticate()*返回一个像这样的用户对象`return User(username=username, password=password)`，但我从不将用户对象存储到数据库中。

1.  为什么 django 文档建议使用用户对象创建数据库？（https://docs.djangoproject.com/en/1.4/topics/auth/#writing-an-authentication-backend - “......处理这个问题的最佳方法是为每个用户创建一个 Django User 对象存在于您的后端...")

2.  如果我尝试调用*login()*，则会调用数据库。如果登录名存储在会话中，为什么需要数据库？（使用缓存会话）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T23:14:04.200

您特别需要*保存*对象的原因`User`是应用程序通常会在对象和用户之间创建数据库级别的关系（以便在多个请求中保持关系）。

一个简单的例子是活动登录`django.contrib.admin`。它显示用户最近执行的行为。这仅在将用户对象保存到数据库时才有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T23:12:30.960

相当多的应用程序有一个外键`auth.User`；如果您没有填充该表，那么您将无法使用这些应用程序。

# c# - 循环内的IO操作

> ID：10874677
> 
> 赞同：0
> 
> 时间：2012-06-03T23:08:00.943
> 
> 标签：c#, io, console-application

我正在编写一个小型控制台应用程序，它必须用另一个 txt 文件覆盖一个 txt 文件，但是最终执行 3 次，我认为这是因为 IO 写入过程比 IO 输出过程慢。任何人都可以帮助我如何只执行一次循环？

这是代码：

```
while (confirm != 'x') {
    Console.WriteLine(
        "Do you want to copy the archive to test2.txt? (y)es or e(x)it");
    confirm = (char)Console.Read();
    if (confirm == 's') {
        File.Copy("C:\\FMUArquivos\\test.txt", 
                  "C:\\FMUArquivos\\test2.txt", true);
        Console.WriteLine("\nok\n");
    }
    Console.WriteLine("\ncounter: " + counter);
    counter += 1;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T23:19:36.107

如果您点击`y<enter>`，那么这将为您提供 3 个字符的序列++`"y"`并将产生 3 次迭代，因此计数器将增加 3。请改用。`<cr>``<lf>``ReadLine`

```
int counter = 0; 
while (true) {
    Console.WriteLine("Do you want to copy ...");
    string choice = Console.ReadLine();
    if (choice == "x") {
        break;
    }
    if (choice == "y") {
        // Copy the file
    } else {
        Console.WriteLine("Invalid choice!");
    }
    counter++;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T23:15:57.577

试试这个代码：

```
var counter = 0;

Console.WriteLine("Do you want to copy the archive to test2.txt? (y)es or e(x)it");
var confirm = Console.ReadLine();

while (confirm != "x")
{
    File.Copy("C:\\FMUArquivos\\test.txt", "C:\\FMUArquivos\\test2.txt", true);
    Console.WriteLine("\nok\n");

    counter += 1;
    Console.WriteLine("\ncounter: " + counter);

    Console.WriteLine("Do you want to copy the archive to test2.txt? (y)es or e(x)it");
    confirm = Console.ReadLine();
} 
```

它会询问您是否要继续，如果您按`y`（或除 之外`x`的任何其他键），它将复制文件并打印“\nok\n”和“1”。然后它会再次询问您，如果您按`x`，它将停止。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T23:20:10.593

现在我已经复制并运行了您的代码，我看到了您的问题。您应该用“ReadLine”替换对“Read”的调用，并将确认类型更改为字符串并进行比较。

原因是 Console.Read 仅在您按“输入”时返回，因此它读取 3 个字符；'s' '\r', '\n' （最后 2 个是 Windows 上的换行符）。

有关 Console.Read 的 API 参考，请参见此处：http: [//msdn.microsoft.com/en-us/library/system.console.read.aspx](http://msdn.microsoft.com/en-us/library/system.console.read.aspx)

试试这个;

```
string confirm = "";
int counter = 0;
while (confirm != "x")
{
    Console.WriteLine("Do you want to copy the archive to test2.txt? (y)es or e(x)it");
    confirm = Console.ReadLine();
    if (confirm == "s")
    {
        File.Copy("C:\\FMUArquivos\\test.txt",
            "C:\\FMUArquivos\\test2.txt", true);
        Console.WriteLine("\nok\n");
    }
    Console.WriteLine("\ncounter: " + counter);
    counter += 1;
} 
```

# php - 循环通过描述螺旋的公式以生成 XY 坐标

> ID：10874678
> 
> 赞同：11
> 
> 时间：2012-06-03T23:08:13.600
> 
> 标签：php, fibonacci, fractals, procedural-generation

我正在尝试以 xy (2D) 坐标的形式生成一个螺旋星系——但数学不是我的强项。

我从一个关于螺旋的[优秀来源收集了以下内容：](http://www.mathematische-basteleien.de/spiral.htm)

> 对于最简单的螺旋，即阿基米德螺旋，半径 r(t) 和角度 t 成正比。因此等式是：
> 
> (3) 极坐标方程：r(t) = at [a 为常数]。
> 由此得出
> (2) 参数形式：x(t) = at cos(t), y(t) = at sin(t),
> (1) 中心方程：x²+y² = a²[arc tan (y/x) ]²。

[这个问题](https://stackoverflow.com/questions/348321/mathematical-question-procedural-generation-of-a-galaxy)有点涉及星系的生成，但是对于我需要的东西来说，答案是分散的并且仍然过于复杂（又名，我的数学愚蠢的头脑无法理解它们）。

本质上，我需要做的是在 PHP 中循环一个螺旋公式 ~5000 次，以在 513x513 XY 网格上生成点。网格的大小和所需的点数将来可能会发生变化。更好的办法是将这些点与螺旋的起源进行权衡，包括频率以及它们偏离精确数学公式的距离，类似于星系的实际外观。

这篇数学论文讨论了[一个描述螺旋星系结构的公式](http://arxiv.org/ftp/arxiv/papers/0908/0908.0892.pdf)。

让我完全迷失的是如何将数学公式转换为我可以在 PHP 中循环的东西！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-04T00:00:29.437

```
// a is 5 here
function x($t){ return 5 * $t * cos($t); }
function y($t){ return 5 * $t * sin($t); }

for ($t = 0; $t < 50; $t += 0.01) {
    $xyPoint = array(x($t), y($t));
    // draw it
} 
```

当你遇到这样的参数方程时，参数变量通常是`t`，这意味着时间。因此，您可以考虑将不断增加的 t 值插入函数中，并获得随着时间推移而逐渐变化的坐标。

您需要为 a、t 的范围和 t 的增量步长选择自己的值。这仅取决于您的要求。cos() 和 sin() 的最大值均为 1，如果这有助于您根据画布大小确定 a 和 t 的合适值

# php - OS X Lion Apache 和 PHP 无法通信

> ID：10874679
> 
> 赞同：2
> 
> 时间：2012-06-03T23:08:24.860
> 
> 标签：php, mysql, macos, apache

如果这已经得到解答，我深表歉意 - 但是我很难找到解决方案。

我正在尝试使 OSX 10.7.4 Apache、PHP、MySQL 飞跃……我遵循了这个[http://echodittolabs.org/blog/2011/09/os-x-107-lion-development-native-apache -php-homebrew-mysql-or-mariadb](http://echodittolabs.org/blog/2011/09/os-x-107-lion-development-native-apache-php-homebrew-mysql-or-mariadb)，其中大部分都完美无缺（我对 .plist 有一个小问题，但这是固定的）。

阿帕奇工作正常。PHP 工作正常（通过终端）。但是，我无法让任何 PHP 文件通过浏览器工作。我已经取消注释`LoadModule php5_module libexec/apache2/libphp5.so`并包含了这`IfModule php5_module`件作品。我检查了 apache 加载的模块，其中包括 PHP5。Apache error_log 什么也没提供

想法？（请不要说使用 MAMP）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:36:38.210

尝试将此行添加到您的`IfModule php5_module`块中：

```
AddHandler php5-script .php 
```

所以它看起来像这样：

```
<IfModule php5_module>
  AddType application/x-httpd-php .php
  AddType application/x-httpd-php-source .phps
  AddHandler php5-script .php

  <IfModule dir_module>
    DirectoryIndex index.html index.php
  </IfModule>
</IfModule> 
```

# iphone - UIImagePickerController 活动指示器

> ID：10874680
> 
> 赞同：0
> 
> 时间：2012-06-03T23:08:40.510
> 
> 标签：iphone, ios, xcode, ios5, uiimagepickercontroller

当使用 UIImagePickerController 和 AllowsEditing=YES 从相机获取图像时，从用户按下选择到调用 didFinishPickingMediaWithInfo 会有相当大的延迟。我想在此期间使用[DejalBezelActivityView显示活动指示器。](http://www.dejal.com/blog/2012/02/dejalactivityview)我不确定在哪里可以拨打电话：

```
[DejalBezelActivityView activityViewForView:(UIImagePickerController view goes here) withLabel:@"Processing..."]; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T04:10:50.590

我不认为你可以使用 UIImagePickerController 进行这样的控制。您当然可以使用 AVFoundation 创建自己的照片控制器。创建图像需要一些时间...

# wordpress - 我可以让我的 wordpress 随机数更快过期吗？（通过 wp_verify_nonce）

> ID：10874682
> 
> 赞同：3
> 
> 时间：2012-06-03T23:09:04.017
> 
> 标签：wordpress, nonce

Wordpress 有一个随机数机制，插件可以将随机数发送到客户端代码中，然后在客户端与服务器通信时验证随机数。

我查看了`wp_verify_nonce()` （在 wp-includes/pluggable.php 中）的源代码，如果 nonce 是 24 小时或更短时间，它会返回 true。

我是否有可能创建一个可以验证为...假设... .1 分钟前的随机数？

如何？

我认为有一种方法通过`add_filter()` and `nonce_life`。但我不希望无处不在的随机数短命。我只希望我的插件使用的 nonce 寿命很短。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T16:48:40.507

我在 wordpress nonce 上发现的文档很少。

虽然代码本身并不是很复杂，并且有一种方法可以简单地替换`wp_verify_nonce()`函数，但我相信在整个 wordpress 中的很多地方都使用了 nonce，我不确定我的替换不会破坏其他东西。

由于缺乏来自这里或其他地方的任何有用的建议，我放弃了让*我的 nonce*更快过期的想法，只是添加了我自己的 nonce/timestamp 字段。

我正在编写的插件生成一个随机数，然后将其嵌入到脚本块中，然后在网页中呈现。当页面中的 Javascript 与 wordpress admin-ajax.php 通信时，它会发回 nonce。Wordpress 然后验证随机数，`wp_verify_nonce()`如果随机数没有过期，则允许请求 - 12 或 24 小时，如您所愿。此检查还验证调用者的身份。

我所做的只是生成另一个随机数，一个加密的时间戳。它以与 WP nonce 相同的方式嵌入到 javascript 脚本块中。它以相同的方式重新传输，并以类似的方式进行验证：我解密并检查时间戳是否是“最近的”。
不同之处在于我的插件控制验证，因此我可以设置“新近度”的阈值。

# arrays - 从中心向外迭代二维 (2n+1)*(2n+1) 数组

> ID：10874685
> 
> 赞同：0
> 
> 时间：2012-06-03T23:09:42.197
> 
> 标签：arrays, iteration

我必须从具有奇数维度的方形二维数组中对一些值进行排序。我对我将如何以一种从中心向外以一种螺旋方形运动的方式进行迭代感兴趣

很难用文字来解释，所以我将用图形解释数字表示从 0 到 arraylength*arraylength-1 的迭代状态（从 10 开始的数字是字母字符，因为我用完了数字）（所以 a = 10, b = 11, c = 12...)

像这样：

```
fghij
e456k
d307l
c218m
ba9on 
```

如您所见，它以圆周运动从中心向外移动。当它填满一个圆圈时，它从外层向外开始（例如从1到2。或从8到9的步骤）

我认为这样开始是有意义的：

```
for (int i = 0; i < array.length()/2; i++)
    for (int j = 0; i < i*8 || i == 0 && j == 0; j++)
        .... 
```

由于 j 代表第 i 层中的字段数，您将围绕它进行迭代：第二层中的 i*8 有 1*8=8 个字段，第三层 2*8 = 16，第四层 3* 8 = 24 等等.. 除了中间只有一个

随意用任何编程语言回答 ;)... 除了 Fortran。在这种情况下，你应该重新思考你的生活

# google-maps - Google Maps V3：绘制德国州多边形？

> ID：10874686
> 
> 赞同：8
> 
> 时间：2012-06-03T23:09:44.273
> 
> 标签：google-maps, google-maps-api-3

我需要在某些德国州上绘制彩色多边形。做到这一点的最好方法是什么（或最简单、最快、最……）？我是否需要以某种方式将所有轮廓作为纬度/经度点并根据这些轮廓绘制多边形？或者，还有更好的方法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-04T03:06:52.087

你想做这样的事情吗？ [http://www.geocodezip.com/geoxml3_test/v3_FusionTables_query_sidebarF_local.html?country=Germany](http://www.geocodezip.com/geoxml3_test/v3_FusionTables_query_sidebarF_local.html?country=Germany)

它使用[自然地球数据集 FusionTables 中的公开数据](https://www.google.com/fusiontables/DataSource?docid=19lLpgsKdJRHL2O4fNmJ406ri9JtpIIk8a-AchA)。

```
 encrypted ID:
 https://www.google.com/fusiontables/DataSource?docid=19lLpgsKdJRHL2O4fNmJ406ri9JtpIIk8a-AchA
 numeric ID:
 https://www.google.com/fusiontables/DataSource?dsrcid=420419 
```

您可以随意设置它们的样式（为它们着色）。

**代码片段：**

```
// globals
var map = null;
var infoWindow = null;
var geoXml = null;
var geoXmlDoc = null;
var myLatLng = null;
var myOptions = null;
var mapCenter = null;
var geocodeTheCountry = true;
var gpolygons = [];

// Fusion Table data ID
var FT_TableID = "19lLpgsKdJRHL2O4fNmJ406ri9JtpIIk8a-AchA"; // 420419;
var CountryName = "Germany";
google.load('visualization', '1', {
  'packages': ['corechart', 'table', 'geomap']
});

function createSidebar() {
  // set the query using the parameters
  var FT_Query2 = "SELECT 'name_0', 'name_1', 'kml_4326' FROM " + FT_TableID + " WHERE name_0 = '" + CountryName + "' ORDER by 'name_1'";
  var queryText = encodeURIComponent(FT_Query2);
  // alert("createSidebar query="+FT_Query2);
  var query = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq=' + queryText);

  //set the callback function
  query.send(getData);
}

// Set a callback to run when the Google Visualization API is loaded.
google.setOnLoadCallback(createSidebar);

var FTresponse = null;

myLatLng = new google.maps.LatLng(37.422104808, -122.0838851);
// these set the initial center, zoom and maptype for the map 
// if it is not specified in the query string
var lat = 37.422104808;
var lng = -122.0838851;
var zoom = 18;
var maptype = google.maps.MapTypeId.ROADMAP;
if (!isNaN(lat) && !isNaN(lng)) {
  myLatLng = new google.maps.LatLng(lat, lng);
}
infoWindow = new google.maps.InfoWindow();
//define callback function, this is called when the results are returned
function getData(response) {
  if (!response) {
    alert('no response');
    return;
  }
  if (response.isError()) {
    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
  FTresponse = response;
  //for more information on the response object, see the documentation
  //http://code.google.com/apis/visualization/documentation/reference.html#QueryResponse
  numRows = response.getDataTable().getNumberOfRows();
  numCols = response.getDataTable().getNumberOfColumns();

  fusiontabledata = "<table><tr>";
  fusiontabledata += "<th>" + response.getDataTable().getColumnLabel(1) + "</th>";
  //   }
  fusiontabledata += "</tr><tr>";

  for (i = 0; i < numRows; i++) {
    fusiontabledata += "<td><a href='javascript:myFTclick(" + i + ")'>" + response.getDataTable().getValue(i, 1) + "</a></td>";
    //    }
    fusiontabledata += "</tr><tr>";
  }
  fusiontabledata += "</table>";
  //display the results on the page
  document.getElementById('sidebar').innerHTML = fusiontabledata;
}

function infoWindowContent(name, description) {
  content = '<div class="FT_infowindow"><h3>' + name +
    '</h3><div>' + description + '</div></div>';
  return content;
}

function myFTclick(row) {
  var description = FTresponse.getDataTable().getValue(row, 0);
  var name = FTresponse.getDataTable().getValue(row, 1);
  if (!gpolygons[row]) {
    var kml = FTresponse.getDataTable().getValue(row, 2);
    // create a geoXml3 parser for the click handlers
    var geoXml = new geoXML3.parser({
      map: map,
      zoom: false,
      infoWindow: infoWindow,
      singleInfoWindow: true
    });

    geoXml.parseKmlString("<Placemark>" + kml + "</Placemark>");
    geoXml.docs[0].gpolygons[0].setMap(null);
    gpolygons[row] = geoXml.docs[0].gpolygons[0].bounds.getCenter();
  }
  var position = gpolygons[row];
  if (!infoWindow) infoWindow = new google.maps.InfoWindow({});
  infoWindow.setOptions({
    content: infoWindowContent(name, description),
    pixelOffset: new google.maps.Size(0, 2),
    position: position
  });
  infoWindow.open(map);
}

function initialize() {
  myOptions = {
    zoom: zoom,
    center: myLatLng,
    mapTypeId: maptype
  };

  map = new google.maps.Map(document.getElementById("map_canvas"),
    myOptions);

  var geocoder = new google.maps.Geocoder();
  if (geocoder && geocodeTheCountry) {
    geocoder.geocode({
      'address': CountryName + " Country"
    }, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        if (status != google.maps.GeocoderStatus.ZERO_RESULTS) {
          map.setCenter(results[0].geometry.location);
          map.fitBounds(results[0].geometry.viewport);
        } else {
          alert("No results found");
        }
      } else {
        alert("Geocode was not successful for the following reason: " + status);
      }
    });
  }

  var FT_Query = "SELECT 'kml_4326' FROM " + FT_TableID + " WHERE 'name_0' = '" + CountryName + "';";
  var FT_Options = {
    suppressInfoWindows: true,
    query: {
      from: FT_TableID,
      select: 'kml_4326',
      where: "'name_0' = '" + CountryName + "';"
    },
    styles: [{
      polygonOptions: {
        fillColor: "#FF0000",
        fillOpacity: 0.35
      }
    }]
  };
  layer = new google.maps.FusionTablesLayer(FT_Options);
  layer.setMap(map);

  google.maps.event.addListener(layer, "click", function(event) {
    infoWindow.close();
    infoWindow.setContent(infoWindowContent(event.row.name_1.value, event.row.name_0.value));
    infoWindow.setPosition(event.latLng);
    infoWindow.open(map);
  });
}
google.maps.event.addDomListener(window, 'load', initialize);
```

```
html,
body {
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
}
#map_canvas {
  width: 300px;
  height: 100%
}
.infowindow * {
  font-size: 90%;
  margin: 0
}
```

```
<script src="https://geoxml3.googlecode.com/svn/branches/polys/geoxml3.js"></script>
<script src="http://www.google.com/jsapi"></script>
<script src="https://maps.googleapis.com/maps/api/js"></script>
<table style="width:100%; height:100%;">
  <tr style="width:100%; height:90%;">
    <td style="width:60%; height:100%;">
      <div id="map_canvas"></div>
    </td>
    <td>
      <div id="sidebar" style="width:300px;height:400px; overflow:auto"></div>
    </td>
  </tr>
</table>
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T11:09:09.940

此外，您可以查看 Google [GeoChart API](https://developers.google.com/chart/interactive/docs/gallery/geochart)，它的功能并不丰富，但非常易于使用。[在API 游乐场](https://code.google.com/apis/ajax/playground/?type=visualization&hl=de#geo_chart)尝试以下代码：

```
 function drawVisualization() {
  var data = google.visualization.arrayToDataTable([
    ['Province', 'Popularity'],
    ['Bremen', 100],
    ['Niedersachsen', 900],
    ['Saksen', 700],
    ['Saarland', 300],
    ['Bayern', 400]
  ]);

     var options = {
        region: 'DE',
        displayMode: 'regions',
        colorAxis: {colors: ['green', 'blue']},
       resolution:'provinces'
      };

  var geochart = new google.visualization.GeoChart(
      document.getElementById('visualization'));
  geochart.draw(data, options,  {width: 556, height: 347});
} 
```

​</p>

# crystal-reports - 在 Crystal Reports for VS2010 中的图像上绘制一条线

> ID：10874690
> 
> 赞同：0
> 
> 时间：2012-06-03T23:10:34.753
> 
> 标签：crystal-reports

这个问题之前已经发布了无数次，只给出了解决方法。问题是我找到的所有答案都是针对 Crystal Reports 的 8.5 版或更早版本，已经超过两年了。由于 SAP 收到了该问题的通知，我猜他们可能已经修复了该问题或做出了我可能错过的良好解决方法。

***有什么好的方法可以让我在Crystal Reports for VS2010*中的图像对象上出现线条对象吗？**

移到前面/移到后面方法不起作用。也使用`Underlay Following Sections`不起作用。

[这](http://scn.sap.com/thread/1916479)是关于我要实现的目标的更详细的讨论。请注意，我知道网上给出的大多数解决方法，但我正在寻找一种更实用的方法来实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T02:14:39.287

不是更简单的解决方案是在图像和带有线条的图像之间交替（包含在图像本身中）吗？

# imagemagick - 将带有自定义频道的 PSD 转换为 JPG

> ID：10874691
> 
> 赞同：1
> 
> 时间：2012-06-03T23:10:39.133
> 
> 标签：imagemagick, photoshop

## 情况

我有大量 PSD 文件（约 10,000 个）并希望在没有 gui 的情况下创建所有这些文件的 jpeg。

## 限制

转换过程需要（最终）发生在无头 linux/osx 机器上，因此必须从命令行运行。我正在运行 OSX/Linux 环境，因此解决方案需要在其中一个（或两个）上运行

## 以前的尝试

对于某些文件，（较新的）转换命令：

`convert -flatten input.psd output.jpg` 工作正常。

对于其中一些，（具有预览/兼容模式的）

`convert input.psd[0] output.jpg` 也可以正常工作。

但是，当我尝试从 8 位/通道多通道设计转换时，转换命令会给出一个非常古怪的输出。我认为它正在尝试使用 RGB，但显然这是不对的！

有什么方法/工具可以用来从这些多通道 PSD 生成 jpeg？事实上，即使是某种方式来识别这是一个非标准的 PSD 也会有很大的帮助，因为我可以对它们进行不同的处理（运送到另一台机器进行更多处理等）

看一个例子：

![正确的](../Images/010923d112ddac334dcc54300226b9f7.png) ![错误的](../Images/831f50a9c8d9e6996d551d801f213445.png)

![菜单](../Images/d1d1c25d75c1cd0385f2f533ab3441a8.png) ![频道](../Images/6739efcf03652672164e420d0e26ed6f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T02:31:20.367

Try `$ convert -depth 8 rgb:image image.jpg`. [Explicit Image Format](http://www.imagemagick.org/script/command-line-processing.php)

Or maybe `$ convert -channel RGB image.jpg` to convert it to RGB before outputting.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T21:49:52.087

您可以了解如何获得 Photoshop 的程序化许可证。或者，您可以创建操作并尝试通过 CLI 触发操作。一切仍将通过 PS 运行，但可以通过 ssh 在无头 Mac 上触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-07T06:50:53.800

我也面临着将多通道 psd/psb 文件转换为 jpg 的同样问题。我在 W8 系统上使用 Photoshop CS5。使用 photoshop 将所有此类 psd/psb 文件转换为 jpg 的步骤/过程非常繁琐且耗时。创建动作是，自动化也需要用户与系统交互。

为此，我开发了一个 VBScript 和一个 JavaScript，它将向用户询问存储所有此类 psd/psb 文件的文件夹。该脚本将一一选择所有文件并执行所有手动完成的步骤，并在同一文件夹中为用户提供具有相同文件名和所需分辨率的 JPG 文件。

这完全是一个批处理过程，不需要用户参与。但是，是的，因为我们还需要 jpg 中多通道的原始颜色，所以该过程使用 Photoshop 并完成所有步骤。因此，在进程运行时，用户将无法在 Photoshop 上工作。

互联网上有许多免费软件可以进行这种转换，但正如我所见，它们都无法保留 psd 文件中给出的原始颜色。由于此过程使用 Photoshop，您可以从 psd/psb 中获取准确的 jpg。

您可以在以下位置观看此批处理的演示：www.youtube.com/watch?v=fmHGAW6Efew 如果您仍有任何疑问，请告诉我。

谢谢， Gautam Chhatbar

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-28T07:05:51.790

我刚刚创建了一个处理来自 CLI 的 PSD 文件的 Node 模块。您可以通过一个命令将它与任意数量的文件一起使用。

就我的测试而言，Gimp 并不是真正的解决方案，并且对现代 PSD 文件的理解很差，而且 NodeJS 恰好有一个很棒的新包可以处理 Photoshop 格式。

来自[Github repo](https://github.com/kartsims/psd-cli)的说明：

安装它：

`npm install -g psd-cli`

转换`myfile.psd`为新的`myfile.png`：

`psd myfile.psd`

转换几个文件也可以：

`psd *.psd`

希望你觉得这个有用 ！包是相当新的，其他很酷的功能将很快添加，任何功能请求都是最喜欢的，并感谢改进代码的帮助:)

# ruby-on-rails - 仅列出允许用户查看的实例（他拥有访问权限的公共或私有实例）

> ID：10874694
> 
> 赞同：0
> 
> 时间：2012-06-03T23:10:51.877
> 
> 标签：ruby-on-rails, activerecord

我有一个`Repository`模型如下：

```
class Repository < ActiveRecord::Base

  belongs_to :user
  has_many :members, :class_name => :users
  has_many :datum

end 
```

它有一个`private`布尔属性，指示它是否是公共存储库，即对所有人可见。或者，如果它是一个私有存储库并且只对他的成员可见。

检索仅允许用户查看的存储库的最佳方法是什么？

逻辑是：如果它是公开的，只需检索它。如果它是私有的，请检查用户是否在成员列表中。

我相信我只需要创建一个方法来在`Repository`控制器上检查它，并使用它来验证用户是否可以访问它。但我想不出最好的方法来做到这一点！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:16:29.650

简单的方法是使用授权库。我在所有项目中都使用[CanCan 。](https://github.com/ryanb/cancan)

您可以以清晰易读的方式声明访问权限。

```
can :read, Project, :active => true, :user_id => user.id 
```

然后稍后检查授权。仅当 current_user 有权访问项目时，此行才会显示链接。

```
<%= link_to 'A project', @project if can? :read, @project %> 
```

有关更多信息，请阅读 cancan 的 wiki。

# actionscript-3 - 等到 Loader.load() 完成加载后继续代码

> ID：10874695
> 
> 赞同：0
> 
> 时间：2012-06-03T23:10:52.973
> 
> 标签：actionscript-3, load, bitmapdata

所以我一直在尝试在 AS3 中执行以下操作来加载任何图像并在运行时检索其位图数据：

```
var bitmapData:BitmapData;
var loader:Loader;
var completed:Boolean = false;

public function loadBitData(path:String):BitmapData{
    loader = new Loader();
    loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplete);
    loader.load(new URLRequest(path));
    while(!completed){

    }
    completed = false;
    return bitmapData;
}

private function onComplete (event:Event):void{
    bitmapData = Bitmap(LoaderInfo(event.target).content).bitmapData;
    completed = true;
} 
```

由于加载器不会在单独的线程上加载文件，因此这段代码显然会陷入无限循环。如果删除 while 循环，该方法将返回 null，因为当它到达该语句时，数据尚未加载。但是，它仍然会在之后加载数据。（我已经使用进度事件检查了这一点并打印了到目前为止已加载的数据量）

我只想要加载文件的方法，然后在完全加载后返回 BitmapData。在这种情况发生之前，程序应该等待并且不再执行任何代码。对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:20:19.973

不，程序不应等到图像加载完毕。加载数据是异步完成的。

> 在编程中，异步事件是独立于主程序流发生的事件。异步动作是在非阻塞方案中执行的动作，允许主程序流继续处理。

在加载外部数据时，您的应用程序将继续正常运行。您的`onComplete()`方法是您需要管理数据完全加载后应该发生的情况。如果您不希望在那之前发生某些事情，请将该代码移动到`onComplete`处理程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T23:30:22.663

1.  如果您将使用[LoaderMax](http://greensock.com) - 刚开始加载后，您将获得一个具有固定大小的特殊显示对象，当加载正确的图像时会自动更新。如果您需要在实际加载图像之前在舞台上放置一个具有图像大小的位置，这可能会解决您的问题。

2.  如果你真的需要在没有第三方工具的情况下处理这个问题，或者你需要它来做一些不同的事情，只需在数据加载时调度一个自定义事件，然后让你的应用程序做出反应。你不能只用那一个功能来处理这个问题。这是异步的，所以你需要有合适的架构。尝试围绕事件重新设计事物。

# javascript - jQuery - div 上的 setTimout 用于保存超过 x 秒的内容

> ID：10874697
> 
> 赞同：0
> 
> 时间：2012-06-03T23:11:12.990
> 
> 标签：javascript, jquery, settimeout

所以我有3个角色和一个秘密角色。秘密字符应该是 .chosen 字符。到目前为止一切都很好。但是，我正在尝试显示一个警报，但只有当3秒已经过3秒以便在秘密字符div中传递时。目前，快速按下按键（其中秘密字符包含所选字符少于 3 秒）会触发警报。

```
<div id="peter" class="chosen">peter</div>
<div id="louis">louis</div>
<div id="stewie">stewie</div>

<br><br>
<div id="secret-character"></div> 
```

jQuery：

```
$(document).keydown(function(e){
if(e.keyCode==38||e.keyCode==40) {
    var prev = $('.chosen').prev();
    var next = $('.chosen').next();

    if(e.keyCode==38){
        $('.chosen').removeClass('chosen'); prev.addClass('chosen');
    }    
    if(e.keyCode==40){
        $('.chosen').removeClass('chosen'); next.addClass('chosen');
    }  

    var timeoutID = null;    

    clearTimeout(timeoutID);
    timeoutID = setTimeout(function() {alert('3 secs secret character!')}, 3e3);

    $('#secret-character').html('Secret Character:'+$('.chosen').html()+'!');                             
}
}); 
```

任何帮助表示赞赏。这是小提琴：http: [//jsfiddle.net/58MJ3/](http://jsfiddle.net/58MJ3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:20:58.250

每次您的 keydown 处理程序运行时，您都将**局部**变量设置`timeoutID`为`null`：

```
var timeoutID = null; 
```

然后你清除那个空计时器并开始一个新的：

```
timeoutID = setTimeout(function() {alert('3 secs secret character!')}, 3e3); 
```

但是当回调完成执行时，`timeoutID`它就消失了，因为`timeoutID`它是一个局部变量。

我认为您想清除*以前*的计时器，因此`timeoutID`需要在调用处理程序之间保留。也许你想要这个：

```
var timeoutID = null;
$(document).keydown(function(e) {
    // As before except no `var timeoutID = null` in here...
}); 
```

演示：http: [//jsfiddle.net/ambiguous/AjaAb/](http://jsfiddle.net/ambiguous/AjaAb/)

# metadata - GNOME：Nautilus 将徽章数据存储在哪里以及如何存储？

> ID：10874702
> 
> 赞同：5
> 
> 时间：2012-06-03T23:12:01.773
> 
> 标签：metadata, gnome, nautilus

Nautilus 允许用户在目录和文件上设置标志，但令人惊讶的是它不使用像 xattr 这样的实际文件元数据存储来存储这些添加的元数据。

那么 Nautilus 在哪里以及如何存储这些数据呢？（我想从 Nautilus 外部访问它。）

看起来，GVFS 将此类元数据存储在它的“metadata::emblems”命名空间中（尝试 CLI 命令*gvfs-info*），但是

GVFS 在哪里存储它的数据？在单独的数据库中，在 xattr 或两者中，取决于命名空间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T19:47:30.153

元数据由 GVFS 存储在 ~/.local/share/gvfs-metadata/ 中（严格来说在 $XDG_DATA_HOME/gvfs-metadata 中，而 XDG_DATA_HOME 默认为 ~/.local/share）。

例如，如果您有一个带有标签*home*的分区，那么元数据将存储在 ~/.local/share/gvfs-metadata/home 中。

您可以使用[GIO API](http://developer.gnome.org/gio/stable/)在您自己的程序中访问这些属性。

# php - 自动链接正则表达式

> ID：10874703
> 
> 赞同：8
> 
> 时间：2012-06-03T23:12:19.123
> 
> 标签：php, regex, url

我正在使用 PHP 函数自动将文本字符串中的 URL 转换为人们可以点击的实际链接。它似乎在大多数情况下都有效，但是我发现有些情况下它不起作用。

我根本不懂正则表达式，所以我希望有人能帮助我解决这个问题。

这是我目前使用的模式：

```
$pattern = "/(((http[s]?:\/\/)|(www\.))(([a-z][-a-z0-9]+\.)?[a-z][-a-z0-9]+\.[a-z]+(\.[a-z]{2,2})?)\/?[a-z0-9.,_\/~#&=;%+?-]+[a-z0-9\/#=?]{1,1})/is"; 
```

但是，这里有一些我发现此模式不匹配的链接：

*   www.oakvilletransit.ca - 不确定，但假设由于两个字母的国家/地区代码不匹配
*   www.grt.ca - 另一个不工作的 .ca 域
*   其他几个 .ca 地址
*   freepublictransports.com - 没有 www 的地址。或 http:// 在他们面前。我希望这些也能正常工作。
*   www.222tips.com - 假设由于地址开头的数字不匹配。

有谁知道我如何修改该正则表达式模式以匹配这些情况？

**编辑**- 它还应该匹配结尾可能有句点的 URL。如果 URL 是句子的最后部分，则末尾可能有一个句点，不应包含在实际链接中。目前，这种模式也考虑到了这一点。

**编辑 2** - 我正在使用这样的模式：

```
$pattern = "/((http|https):\/\/)?([a-z0-9-]+\.)?[a-z][a-z0-9-]+(\.[a-z]{2,6}){1,3}(\/[a-z0-9.,_\/~#&=;%+?-]*)?/is";
  $string = preg_replace($pattern, " <a target='_blank' href='$1'>$1</a>", $string);
  // fix URLs without protocols
  $string = preg_replace("/href='www/", "href='http://www", $string);
  return $string; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T23:26:46.360

以下正则表达式将匹配 URL：

*   （可选）带有`http://`或`https://`
*   （可选）带有子域（`www.example.com`,`help.example.com`等）
*   具有 1-3 个域扩展名，每个扩展名必须是 2-6 个字符（`www.example.com.gu`、`www.example.com.au.museum`等）
*   （可选）末尾带有正斜杠
*   （可选）正斜杠后有有效字符

最后`/i`的 使其**不区分大小写**。

`/((http|https):\/\/)?([a-z0-9-]+\.)?[a-z0-9-]+(\.[a-z]{2,6}){1,3}(\/[a-z0-9.,_\/~#&=;%+?-]*)?/is`

**编辑：**这将不匹配末尾的任何“挂起”句点（例如句子的结尾），因为它不是 URL 的一部分，也不应该包含在`href`链接的属性中。

**编辑 2：**在您的第一个`preg_replace()`中，更改`$1`为`$0`. 这将插入整个匹配的字符串，而不是它的单个部分。

**编辑 3：（**更新*2* ）这是一种更好的方法，您可以在开头检查 a`http://`或：`https://`

```
preg_replace("/href='[^h][^t][^t][^p][^s]?[^:]/", "/href='http:\/\/", $string); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-03T12:05:30.577

我对上面所有的例子都有问题。

这是一个有效的方法：

```
function autolink($string){
        $string= preg_replace("#http://([\S]+?)#Uis", '<a href="http://\\1">\\1</a>', $string);
        return $string;
} 
```

# php - .htaccess 不重定向？

> ID：10874705
> 
> 赞同：0
> 
> 时间：2012-06-03T23:12:35.213
> 
> 标签：php, mysql, html, apache

我有以下 .htaccess 文件：

```
RewriteRule ^s/([a-zA-Z]+) /servers/page.php?name=$1

RewriteRule ^s/([a-zA-Z]+)/new-thread /servers/new-thread.php?name=$1 
```

从第一行可以看出，这是：

`mydomain.com/s/hello`实际上向我展示了页面的内容`mydomain.com/servers/page.php?name=hello`

第二行：

`mydomain.com/s/hello/new-thread` **应该**向我显示页面的内容：`mydomain.com/servers/new-thread.php?name=hello`,

但是当我输入后一个 URL 时，我会得到前一页的内容。

这意味着如果我键入`mydomain.com/s/hello/new-thread`，我会像键入一样显示内容`mydomain.com/s/hello`。有人可以向我指出为什么会这样吗？先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T23:16:46.497

试试这个：

```
RewriteRule ^s/([a-zA-Z]+)/new-thread /servers/new-thread.php?name=$1 [L]
RewriteRule ^s/([a-zA-Z]+) /servers/page.php?name=$1 [L] 
```

# java - MOXY 中的 JAXB 继承

> ID：10874711
> 
> 赞同：4
> 
> 时间：2012-06-03T23:13:35.417
> 
> 标签：java, xml, jaxb, xml-serialization, moxy

我有两节课：

```
package a;
class A {
 private <type> fieldOfClassA;
 // getters, and setters
}

package b;
class B extends A{
 private <type> fieldOfClassB;
 // getters, and setters
} 
```

我想将 B 类编组到 xml 元素并从 A 类添加属性 fieldOfClassB 和 fieldOfClassA，但它在编组过程中会打印以下警告消息：

```
Ignoring attribute [fieldOfClassA] on class [b.B] as no Property was generated for it. 
```

请注意，这两个类来自两个不同的包，我无法更改此对象模型。

先感谢您！

编辑：

我正在使用外部绑定文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T09:28:20.667

从您发布的日志消息中，我可以看到您正在使用 MOXy 的外部映射文档（请参阅[http://blog.bdoughan.com/2010/12/extending-jaxb-representing-annotations.html](http://blog.bdoughan.com/2010/12/extending-jaxb-representing-annotations.html)）。有几种不同的方法来映射继承的属性。

* * *

**选项 #1 - 映射属于父级的继承属性**

默认情况下，需要在其所属的类中映射字段/属性。由于 MOXy 将外部映射文档限定在包级别，因此您将需要单独的映射文档`A`和`B`.

**论坛10874711/a/binding1.xml**

```
<?xml version="1.0"?>
<xml-bindings
    xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="forum10874711.a">
    <java-types>
        <java-type name="A">
            <java-attributes>
                <xml-element java-attribute="fieldOfClassA" name="field-of-class-a"/>
            </java-attributes>
        </java-type>
    </java-types>
</xml-bindings> 
```

**论坛10874711/b/binding1.xml**

```
<?xml version="1.0"?>
<xml-bindings
    xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="forum10874711.b">
    <java-types>
        <java-type name="B">
            <xml-root-element/>
            <java-attributes>
                <xml-element java-attribute="fieldOfClassB" name="field-of-class-b"/>
            </java-attributes>
        </java-type>
    </java-types>
</xml-bindings> 
```

**论坛10874711/b/jaxb.properties**

要将 MOXy 指定为您的 JAXB 实现，您需要添加一个`jaxb.properties`在与您的域模型相同的包中调用的文件，其中包含以下条目。

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

**演示**

```
package forum10874711;

import java.util.*;
import javax.xml.bind.*;
import org.eclipse.persistence.jaxb.JAXBContextFactory;

import forum10874711.b.B;

public class Demo1 {

    public static void main(String[] args) throws Exception {
        Map<String, Object> properties = new HashMap<String, Object>(1);
        List<String> metadata = new ArrayList<String>(2);
        metadata.add("forum10874711/a/binding1.xml");
        metadata.add("forum10874711/b/binding1.xml");
        properties.put(JAXBContextFactory.ECLIPSELINK_OXM_XML_KEY, metadata);
        JAXBContext jc = JAXBContext.newInstance(new Class[] {B.class}, properties);

        B b = new B();
        b.setFieldOfClassA("foo");
        b.setFieldOfClassB(123);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(b, System.out);
    }

} 
```

**输出**

```
<?xml version="1.0" encoding="UTF-8"?>
<b>
   <field-of-class-a>foo</field-of-class-a>
   <field-of-class-b>123</field-of-class-b>
</b> 
```

* * *

**选项 #2 - 映射属于 Child 的继承属性**

父类`A' can be marked`@XmlTransient `this will allow us to map the inherited fields/properties on the child class`B`（参见[http://blog.bdoughan.com/2011/06/ignoring-inheritance-with-xmltransient.html](http://blog.bdoughan.com/2011/06/ignoring-inheritance-with-xmltransient.html)）。

**论坛10874711/a/binding2.xml**

```
<?xml version="1.0"?>
<xml-bindings
    xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="forum10874711.a">
    <java-types>
        <java-type name="A" xml-transient="true"/>
    </java-types>
</xml-bindings> 
```

**论坛10874711/b/binding2.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<xml-bindings
    xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="forum10874711.b">
    <java-types>
        <java-type name="B">
            <xml-root-element/>
            <java-attributes>
                <xml-element java-attribute="fieldOfClassA" name="field-of-class-a"/>
                <xml-element java-attribute="fieldOfClassB" name="field-of-class-b"/>
            </java-attributes>
        </java-type>
    </java-types>
</xml-bindings> 
```

**演示**

```
package forum10874711;

import java.util.*;
import javax.xml.bind.*;
import org.eclipse.persistence.jaxb.JAXBContextFactory;

import forum10874711.b.B;

public class Demo2 {

    public static void main(String[] args) throws Exception {
        Map<String, Object> properties = new HashMap<String, Object>(1);
        List<String> metadata = new ArrayList<String>(2);
        metadata.add("forum10874711/a/binding2.xml");
        metadata.add("forum10874711/b/binding2.xml");
        properties.put(JAXBContextFactory.ECLIPSELINK_OXM_XML_KEY, metadata);
        JAXBContext jc = JAXBContext.newInstance(new Class[] {B.class}, properties);

        B b = new B();
        b.setFieldOfClassA("foo");
        b.setFieldOfClassB(123);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(b, System.out);
    }

} 
```

**输出**

```
<?xml version="1.0" encoding="UTF-8"?>
<b>
   <field-of-class-a>foo</field-of-class-a>
   <field-of-class-b>123</field-of-class-b>
</b> 
```

# java - 将java代码转换为c++

> ID：10874715
> 
> 赞同：1
> 
> 时间：2012-06-03T23:14:07.413
> 
> 标签：java, c++

如何将下面的 Java 代码转换为 C++。我知道我可以写 `typedef unsigned char byte`，以便得到照顾，但我不明白`|=`and`<<=`是什么意思。以及如何替换`final`

```
public static final long unsignedIntToLong(byte[] b) {
          long l = 0;
          l |= b[0] & 0xFF;
          l <<= 8;
          (l >>> 4) & 0x0F; 
```

如何在 C++ 中测试所有这些 - 在进行转换时是否可以运行一些单元测试。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T23:17:53.773

首先，`|=`是复合按位或赋值。`a |= b`等效于`a = a | b`，如果该位在`a`或`b`被设置（或两者），则每个结果位都将被设置。

这是应用于每个位的真值表：

```
a | b | result
--------------
0 | 0 | 0
0 | 1 | 1
1 | 0 | 1
1 | 1 | 1 
```

其次，`<<=`是相同的，但不是按位或，而是向左移位。所有现有位都向左移动该数量，右侧用 0 填充。

```
101 << 1 == 1010
110 << 2 == 11000 
```

`final`变量定义与 C++ 相同`const`。然而，如果你想防止一个函数被覆盖，你可以标记`final`到函数头的末尾，如果该函数也是一个虚函数（它首先需要被覆盖）。不过，这只适用于 C++11。这是我的意思的一个[例子。](http://www2.research.att.com/~bs/C++0xFAQ.html#final)

最后，在 Java`>>>`中称为运算符。`unsigned right shift`通常，`>>`将移位位，但保持最左边的位不变以保留数字的符号。有时这可能不是你想要的。`>>>`将一直放一个 0 ，而不是假设该符号很重要。

然而，在 C++ 中，`signed`现实是变量类型的一部分。如果变量是有符号的，`>>`它将像 Java 一样右移，但如果变量是无符号的，它将像`>>>`Java 中的无符号右移 ( ) 运算符一样工作。因此，C++ 只需要`>>`，因为它可以推断出要做什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T23:17:11.293

|= 在两种语言中是相同的：按位或应用于 lhs 变量，就像 += 一样。与 <<=; 相同 它是左移运算符。

Unsigned long 可能很棘手；Java中没有这样的东西。

有 CppUnit。尝试使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T23:21:30.120

关于如何用 C++ 编写最终类没有直接的答案。不过，谷歌会向您展示很多示例。例如私有构造函数或朋友类。

| 是 OR 运算符。所以例如 0x10 | 0x10 = 0x11。

<< 是移位运算符。例如 0b1 << 0b1 = 0b10, 10 << 2 = 0b1000 等等。移位 1 会使您的值乘以 2。

例如：

```
class Converter{
public:
    static Converter * createInstance()
    {
        return new Converter;
    }

    long unsignedIntToLong(unsigned char *b){
        long l = 0;
        l |= b[0] & 0xFF;
        l <<= 8;
        //..
        return l;
    }
private:
    Converter(){

    }
}; 
```

# android - 我怎样才能把json放在互联网上

> ID：10874716
> 
> 赞同：0
> 
> 时间：2012-06-03T23:14:09.147
> 
> 标签：android, json

我是一名安卓开发者（初学者）。我从未开发过服务器或 php 站点。但在一些项目中，我开发了使用 Web 服务发送和接收参数的 android 应用程序。我想知道如何将我的 json 文件添加到 Internet，以便我可以获得包含此 JSON 文件的 url，以便我可以从我的 android 应用程序中读取它。我知道如何阅读它，但我只想知道如何把它放到互联网上，这样这个文件就会有一个 url。是否可以在不更改 url 的情况下更改 json 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-11-19T13:02:42.410

首先，转到此链接“ [http://myjson.com/](http://myjson.com/) ”将您的 json 代码粘贴到那里。然后你会得到一个json链接......然后你可以在你的项目中使用这个链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T23:16:33.847

JSON 数据通常由 Web 应用程序生成，但可以将包含 JSON 数据的文件放在服务器上，由普通 Web 服务器提供服务。

# python - 使用 lxml 生成 XHTML 文档的推荐方法

> ID：10874719
> 
> 赞同：9
> 
> 时间：2012-06-03T23:14:41.950
> 
> 标签：python, xml, xhtml, lxml

Python 库`lxml`似乎提供了几个生成 HTML 文档的构建器。这些有什么区别？

但是这些会生成纯 HTML，而不是 XHTML。虽然我可以手动添加 xmlns 声明，但这并不优雅。那么使用 lxml生成**X HTML 文档的推荐方法是什么？**

## `lxml.builder.E`

[来自http://lxml.de/tutorial.html#the-e-factory](http://lxml.de/tutorial.html#the-e-factory)的示例：

```
>>> from lxml.builder import E

>>> def CLASS(*args): # class is a reserved word in Python
...     return {"class":' '.join(args)}

>>> html = page = (
...   E.html(       # create an Element called "html"
...     E.head(
...       E.title("This is a sample document")
...     ),
...     E.body(
...       E.h1("Hello!", CLASS("title")),
...       E.p("This is a paragraph with ", E.b("bold"), " text in it!"),
...       E.p("This is another paragraph, with a", "\n      ",
...         E.a("link", href="http://www.python.org"), "."),
...       E.p("Here are some reserved characters: <spam&egg>."),
...       etree.XML("<p>And finally an embedded XHTML fragment.</p>"),
...     )
...   )
... ) 
```

## `lxml.html.builder`

[来自http://lxml.de/lxmlhtml.html#creating-html-with-the-e-factory](http://lxml.de/lxmlhtml.html#creating-html-with-the-e-factory)的示例：

```
>>> from lxml.html import builder as E
>>> from lxml.html import usedoctest
>>> html = E.HTML(
...   E.HEAD(
...     E.LINK(rel="stylesheet", href="great.css", type="text/css"),
...     E.TITLE("Best Page Ever")
...   ),
...   E.BODY(
...     E.H1(E.CLASS("heading"), "Top News"),
...     E.P("World News only on this page", style="font-size: 200%"),
...     "Ah, and here's some more text, by the way.",
...     lxml.html.fromstring("<p>... and this is a parsed fragment ...</p>")
...   )
... ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-16T05:15:23.337

混合来自 lxml.builder 的 ElementMaker 和 E 对我有用：

```
from lxml import etree
from lxml.builder import ElementMaker,E

M=ElementMaker(namespace=None,
               nsmap={None: "http://www.w3.org/1999/xhtml"})
html = M.html(E.head(E.title("Test page")),
              E.body(E.p("Hello world")))
result = etree.tostring(html,
                        xml_declaration=True,
                        doctype='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">',
                        encoding='utf-8',
                        standalone=False,
                        with_tail=False,
                        method='xml',
                        pretty_print=True)
print result 
```

结果是

```
<?xml version='1.0' encoding='utf-8' standalone='no'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Test page</title>
  </head>
  <body>
    <p>Hello world</p>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-29T05:35:27.770

> Python 库 lxml 似乎提供了几个生成 HTML 文档的构建器。这些有什么区别？

lxml.builder.E 使用工厂模式

```
从 lxml.html 导入生成器为 E
 从 lxml.html 导入 usedoctest
 html = E.HTML(
   E.头（
     E.LINK(rel="stylesheet", href="great.css", type="text/css"),
     E.TITLE("有史以来最好的页面")
   ),
   E.身体（
     E.H1(E.CLASS("标题"), "头条新闻"),
     EP("World News only on this page", style="font-size: 200%"),
     “啊，顺便说一下，这里还有一些文字。”，
     lxml.html.fromstring("...这是一个解析的片段...")
   )

```

lxml.builder 使用原型模式：

```
从 lxml.builder 导入 E

 def CLASS(*args): # class 是 Python 中的保留字
     返回 {"class":' '.join(args)}

 html = 页面 = (
   E.html(# 创建一个名为“html”的元素
     E.头（
       E.title("这是一个示例文档")
     ),
     E.体（
       E.h1("你好！", CLASS("title")),
       Ep("这是一个带有 ", Eb("bold"), " 文本的段落！"),
       Ep("这是另一个段落，有一个", "\n",
         Ea("链接", href="http://www.python.org"), "."),
       Ep("这里有一些保留字符：."),
       etree.XML("最后是嵌入的 XHTML 片段。"),
     )
   )
 )

```

> 虽然我可以手动添加 xmlns 声明，但这并不优雅。

XSLT 将是另一种选择。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns="http://www.w3.org/1999/xhtml">
<xsl:output method="xml" encoding="utf-8" version="" indent="yes" standalone="no" media-type="text/html" omit-xml-declaration="no" doctype-system="about:legacy-compat" />
<xsl:template match="/">
  <html xmlns="http://www.w3.org/1999/xhtml">
    <xsl:copy-of select="."/>
  </html>
</xsl:template>
</xsl:stylesheet> 
```

**参考**

*   [lxml:test_xslt.py](http://bazaar.launchpad.net/~mail6543210/lxml/main/view/head:/src/lxml/tests/test_xslt.py)
*   [XSLT Fiddle - 无框架/原生/Saxon-CE](http://fiddle.frameless.io/)
*   [主要浏览器中的 XSLT <xsl:output> 支持](https://stackoverflow.com/questions/15851114/xslt-xsloutput-support-in-main-browsers/18346833#18346833)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-23T17:26:28.160

> Python 库 lxml 似乎提供了几个生成 HTML 文档的构建器。这些有什么区别？

lxml.builder.E 提供了一个带有类的 XML 文档，`<class 'lxml.etree._Element'>`这意味着该对象不知道如何处理 html 文档（可能不是）。

lxml.html.builder 给出 a`<class 'lxml.html.HtmlElement'>`这意味着您有一个知道它是 html 的对象，并提供专用于 HTML 的方法和属性`e.body`，`e.make_links_absolute()`例如[https://lxml.de/api/lxml.html.HtmlMixin-class.html](https://lxml.de/api/lxml.html.HtmlMixin-class.html)

# java - 如何从另一个类更新 WebView 的 loadUrl

> ID：10874720
> 
> 赞同：1
> 
> 时间：2012-06-03T23:14:50.753
> 
> 标签：java, android, webview

我已经在活动的主类中创建了一个 WebView，然后我有了一个新类，但我无法修改在主类中创建的 webView 的任何属性，正确更新的步骤是什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:26:06.687

在这种情况下，我可能会创建一个界面。然后在扩展 WebView 或其他类的类中，您可以从接口调用 loadUrl。然后，您可以从另一个类调用扩展 WebView 的类内部的接口方法。如果您需要一个示例，请告诉我，我可以提供一个。

更多关于接口：

[关于接口的](http://docs.oracle.com/javase/tutorial/java/concepts/interface.html)
[Oracle 文档 关于如何实现接口的 Oracle 文档](http://docs.oracle.com/javase/tutorial/java/IandI/usinginterface.html)

# gcc - 成功构建了 GCC 交叉编译器工具链。如何正确设置环境变量？

> ID：10874721
> 
> 赞同：1
> 
> 时间：2012-06-03T23:15:04.900
> 
> 标签：gcc, ubuntu, environment-variables, cross-compiling, osdev

我不知道这是否是关于如何为交叉编译工具链设置环境变量的正确位置。工具链的目的是开发操作系统。我正在使用 Ubuntu 12.04 LTS。问题是如何为工具链设置环境变量。交叉编译工具链的路径是

```
/home/Home/local 
```

我希望能够使用 GCC 交叉编译器工具链，但仍然能够使用 Ubuntu 附带的 GCC 工具链。如果我不清楚，请随时问我一些问题，或者如果您需要有关我想要实现的目标的更多信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-04T11:57:38.497

如果您`--target=...`在配置中声明 a （如果您要设置交叉编译器，则必须这样做），所有生成的二进制文件都将以该目标字符串为前缀；即，对于`--target=i586-elf`，您最终会得到`i586-elf-gcc`，`i586-elf-as`等等。这些不会与您的系统编译器发生冲突，因此您可以`/home/Home/local/bin`毫无问题地添加到您的 PATH 中。`gcc`仍然是你的系统编译器，`i586-elf-gcc`你的交叉编译器。

参考。[OSDev.org](http://wiki.osdev.org/GCC%20Cross-Compiler)。

# javascript - JavaScript - 将时间从 12 小时转换为 24 小时格式

> ID：10874729
> 
> 赞同：1
> 
> 时间：2012-06-03T23:16:39.470
> 
> 标签：javascript, time

我尝试了很多方法，但我总是没有解决方案。我需要的是一个 javascript 代码，它可以将时间`div.postedOn`从 12h 转换为 24h 格式。

div.postedTime 示例：

```
<div class="postedOn"><img src="http://assets7.thatsite.com/images/forums/post/reply.gif?v3" alt="">&nbsp;&nbsp;Posted on June 3, 2012 1:46 AM</div> 
```

所以，我需要将 '1:46 PM' 转换为 '01:46' 而不从`<div>`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T23:24:19.380

如果格式始终相同，那么这将正常工作：

```
out = in.replace(/(\d+):(\d+) ([AP])M/,function(m) {
    m[1] = m[1]%12;
    if( m[3] == "P") m[1] += 12;
    if( m[1] < 10) m[1] = "0"+m[1];
    return m[1]+":"+m[2];
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T23:34:16.837

与 Kolink 类似，添加另一个正则表达式解决方案...

```
var str = "Posted on June 3, 2012 2:00 PM";
var regex = /([01]?\d)(:\d{2}) (AM|PM)/g;
var match = regex.exec(str);
str.replace(regex, (+match[1] + (match[3]=='AM'? 0 : 12)) + match[2] + match[3]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T23:23:12.143

我不是 100% 确定，因为我有一段时间没有做过 javascript，但你会做这样的事情..（这是伪 btw）

```
if( timeString.contains("pm") ) {
hour += 12%24;
} 
```

我不是 100% 确定这是否可行，但这仍然是基本思想。我希望我有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-10T22:49:23.447

```
var str = "12:00 AM";
var regex = /([01]?\d)(:\d{2}) (a.m.|p.m.|AM|PM)/g;
var match = regex.exec(str);
var test;
if (match[1] == 12 && (match[3] == 'p.m.' || match[3] == 'PM')) {
    test = '12 h';
} else if (match[1] == 12 && (match[3] == 'a.m.' || match[3] == 'AM')) {
    test = '0 h';
} else {
    test = str.replace(regex, (+match[1] + (match[3]=='a.m.'? 0 : 12)) + ' h');
}
console.log(test); 
```

对于捕捉那些讨厌的“12 AM”和“12 PM”情况，这会起作用吗？

# sql - 如何获取单词旁边的单词

> ID：10874732
> 
> 赞同：1
> 
> 时间：2012-06-03T23:17:23.283
> 
> 标签：sql, sql-server-2008

我正在尝试确定列中具有全文索引的单词旁边的所有可能单词。

我正在使用 sys.dm_fts_index_keywords 来获取所有可能的关键字，而忽略停止列表中的所有单词。

我试图弄清楚的一个例子：如果我有字符串：“我喜欢我办公室的咖啡馆”，我正在看“咖啡馆”这个词，我想知道它旁边的词是什么。

当我进行下一步搜索时，是否包含停止列表单词并不重要。我只是认为利用已经存在的全文索引会更容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T07:44:58.580

您可以使用 FT 索引来查找匹配项，但随后您必须解析短语并找到相邻的单词。不幸的是，FTS 没有给你比赛的位置 afaik，否则这可能会更容易。

这是一个示例设置：

```
declare @find varchar(100) = 'cafe';

declare @phrase varchar(100) = 'I like the cafe at my office';

;with 
x(x)
as (    select cast('<w>'+replace(@phrase, ' ', '</w><w>')+'</w>' as xml)
    ),
words(pos, word)    
as  (   select  dense_rank() over (order by n),
                p.n.value('.', 'varchar(100)')
        from x
        cross
        apply x.nodes('/w')p(n) 
    )
select  d.* 
from    words w
cross
apply   (   select  * 
            from    words 
            where   pos in (w.pos-1, w.pos+1)
        )d(pos, word)
where   w.word=@find 
```

# javascript - 在 CakePHP 中，既然 View->addScript() 已被弃用，我如何将脚本*一次*添加到我的布局中？

> ID：10874733
> 
> 赞同：0
> 
> 时间：2012-06-03T23:17:35.493
> 
> 标签：javascript, cakephp, cakephp-2.1

在 CakePHP 2.1 中： 现在[不推荐](http://api20.cakephp.org/class/view#method-ViewaddScript)
将 JavaScript 片段**一次**添加到我的布局（即块）中 的最佳方法
`View->addScript()`是什么？

**编辑：（**
`$this->Html->script()`链接到 JS 文件）似乎跟踪重复的脚本，
但`$this->Html->scriptBlock()`（内联 JS）没有。:-(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-10T21:52:54.140

您可以做的几件事：

**1.寻找一个声明的变量（肮脏的解决方法）**

如果您真的希望代码位于`$this->Html->scriptBlock()`，您可以定义/检查一个全局变量，以查看代码是否已经定义。例如：

```
if (!DEFINED('someVarName')) {
    // define the variable from now on
    DEFINE('someVarName', true);
    // add your block
    $this->Html->scriptBlock(...);
} 
```

* * *

**2.创建自定义JS路由和文件（蛋糕方式）**

最好的办法是为您的视图创建一个可以包含在 JS 中的实际 JS 文件`$this->Html->script()`，但是如果您想将 PHP 代码集成到您的 JS 中，那就很烦人了。Cake 有一个很棒的方法来创建视图特定的 JS 脚本，他们似乎很少谈论（我不知道为什么）。

只需将其添加到您的`Config/routes.php`文件中：

```
Router::parseExtensions('js'); 
```

如果您只需将“.js”添加到 URL 的末尾，这将使 Cake 自动为您的控制器操作查找 JS 视图。例如：

`$this->Html->script('/users/profile.js')`寻找`View/Users/js/profile.ctp`

然后，它与 JS 布局一起提供服务。这太棒了，因为您仍然可以访问在控制器中设置的所有变量和数据。

现在……只有一个问题。默认的 JS 布局将内容包装在标签中。如果我们试图在外部包含我们的脚本，这并不好，例如：`<script type="text/javascript" src="/users/profile.js"></script>`.

我对这种方式的 JS 布局真的没有太多用处，但我可能会在某个时候使用，所以我只是编辑了布局文件以使其适应：

```
// app/View/Layouts/js/default.ctp
<? 
if (isset($this->request->params['ext']) && $this->request->params['ext']=='js') {
    echo $this->fetch('content'); 
} else {
?>
    <? echo $scripts_for_layout; ?>
    <script type="text/javascript"><?php echo $this->fetch('content'); ?></script>
<? } ?> 
```

* * *

更多信息（虽然不多）：[http ://book.cakephp.org/2.0/en/development/routing.html#file-extensions](http://book.cakephp.org/2.0/en/development/routing.html#file-extensions)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T23:28:00.833

```
$this->Html->script('scriptname'); 
```

并确保您的脚本位于 webroot 的 js 文件夹中

# wordpress - FullCalendar 不显示标题标题

> ID：10874736
> 
> 赞同：0
> 
> 时间：2012-06-03T23:18:12.180
> 
> 标签：wordpress, wordpress-theming, fullcalendar

这是一个有趣的问题，我在这里和整个网站的 JS 和 CSS 中都进行了搜索，但找不到罪魁祸首：

FullCalendar 在 Wordpress 站点中实现（使用 MySiteMyWay Echelon 主题），除了不显示日历的正常标题 TITLE 外，一切都运行良好。

以下是标准元素：

```
$caldrw = '<script type=\'text/javascript\'>
jQuery(document).ready(function($) {
$(\'#fc-calendar\').fullCalendar({
editable: false,
titleFormat: {
month: \'MMMM YYYY\',
week: "MMM d[ yyyy]{ \'&#8212;\'[ MMM] d yyyy}",
day: \'dddd, MMM d, yyyy\'
},
header: {
left:   \'today,prev,next\',
center: \'title\',
right:  \'month,agendaWeek,agendaDay\'
},
theme: false,
defaultView: \'month\',
aspectRatio: 1.75,
firstHour: 7, 
```

ETC ...

存在转义的 ' 是因为脚本被设置为 php 变量以作为内容插入页面。

这是有趣的部分......所有其他标题参数显示和功能完美的左，右或中心。标题不会显示在任何位置。我怀疑可能存在 JS 或 css 冲突，但我找不到它。

我正在使用最新的

```
fullcalendar css (eventify.fullcall.css) and 
fullcakendar js (fullcalendar.min.js), 
jQuery UI (jquery.ui.core.js and eventify.ui.theme.css),
qTip 1+ (qtip.js),
gCal (gcal.js) and
jQuery 1.7.1. 
```

这是网站上日历的 URL（查看源代码提供了完整的代码以及对 css 和 js 文件的引用）： [http ://riverchurchbishop.com/calendar/](http://riverchurchbishop.com/calendar/)

提前感谢您的指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T00:18:11.420

标题显示***在***日历的中心。但它的颜色要么与您的屏幕相同，要么显示被隐藏，或者有一些不透明度为 0 的过滤器。

标题`H2`在日历中的标记中形成`DIV`。因此，适用`H2`于文件的任何设置都将适用于标题元素。

这是标题标题的标记。

```
<td class="fc-header-center">
  <span class="fc-header-title">
    <h2>June YYYY</h2>
  </span>
</td> 
```

因此，检查 H2 的 CSS（我看到很多） - 使用特定的类进行编辑，您应该会看到标题显示正常。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-19T21:10:39.380

对我来说，该错误是由文档标题中额外不匹配的 div 标签引起的。检查 HTML 并删除所有错误使标题出现。

# sql - LEFT OUTER JOIN 生成不正确的语法

> ID：10874740
> 
> 赞同：0
> 
> 时间：2012-06-03T23:18:47.117
> 
> 标签：sql, join, left-join

我对这个查询有疑问：

```
SELECT     RTRIM(LTRIM(L_MAILITMS.MAILITM_FID)) AS Ref30
         , IsNull (Ref33,0) as Ref33
FROM       L_MAILITM_EVENTS 
   INNER JOIN L_MAILITMS ON L_MAILITM_EVENTS.MAILITM_PID = L_MAILITMS.MAILITM_PID 
WHERE  (L_MAILITMS.MAIL_CLASS_CD = 'E') 
   AND (L_MAILITM_EVENTS.EVENT_OFFICE_CD = 1063) 
   AND (L_MAILITM_EVENTS.EVENT_TYPE_CD = 30) 
   AND (L_MAILITM_EVENTS.EVENT_GMT_DT >= CONVERT(DATETIME, '2012-05-27 00:00:00', 102)) 
   AND (L_MAILITM_EVENTS.EVENT_GMT_DT < CONVERT(DATETIME, '2012-05-28 00:00:00', 102))
LEFT OUTER JOIN 
  (
    SELECT   RTRIM(LTRIM(L_MAILITMS_1.MAILITM_FID)) as Ref3033
           , COUNT(*) as Ref33
    FROM     L_MAILITM_EVENTS as L_MAILITM_EVENTS_1 
       INNER JOIN  L_MAILITMS as L_MAILITMS_1 ON L_MAILITM_EVENTS_1.MAILITM_PID = L_MAILITMS_1.MAILITM_PID
    WHERE  (L_MAILITMS_1.MAIL_CLASS_CD = 'E') 
       AND (L_MAILITM_EVENTS_1.EVENT_OFFICE_CD = 1063) 
       AND (L_MAILITM_EVENTS_1.EVENT_TYPE_CD = 33) 
       AND (L_MAILITM_EVENTS_1.EVENT_GMT_DT >= CONVERT(DATETIME, '2012-05-27 00:00:00', 102))
    GROUP BY L_MAILITMS_1.MAILITM_FID
  )  ON L_MAILITMS.MAILITM_FID = L_MAILITMS_1.MAILITM_FID 
```

产生错误

> 消息 156，级别 15，状态 1，第 7 行
> 关键字“LEFT”附近的语法不正确。
> 消息 156，级别 15，状态 1，第 16 行
> 关键字“ON”附近的语法不正确。

表 L_MAILITMS_EVENTS：

```
MAILITM_PID     EVENT_OFFICE_CD    EVENT_TYPE_CD
-----------------------------------------------------------
1               1063               30
2               1063               30
2               1063               33
3               1063               33
3               1063               30
4               1063               30 
```

表 L_MAILITMS：

```
MAILITM_PID          MAILITM_FID        MAIL_CLASS_CD
-------------------------------------------------------
1                     123               E  
2                     452               E                
3                     369               E
4                     633               E 
```

我想得到什么：

```
Ref30          Ref33
-----------------------
123            0
452            1
369            1
633            0 
```

**更新：**感谢塞巴斯的帮助

*此查询是否有另一种方法来确保速度性能，因为我处理了大约 2500 MAILITM_FID？*

任何人都可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T23:31:34.793

将`WHERE`语法移到语法下方`LEFT OUTER JOIN`。

`LEFT OUTER JOIN`必须是`FROM`声明的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T00:52:26.167

然后让我修改连接的位置：

```
 SELECT     RTRIM(LTRIM(m.MAILITM_FID)) AS Ref30
         , IsNull (Ref33,0) as Ref33
FROM       L_MAILITM_EVENTS me
   INNER JOIN L_MAILITMS m ON me.MAILITM_PID = m.MAILITM_PID
   LEFT OUTER JOIN (
            SELECT   RTRIM(LTRIM(m1.MAILITM_FID)) as Ref3033
                   , COUNT(*) as Ref33
            FROM     L_MAILITM_EVENTS me1
                        INNER JOIN L_MAILITMS m1 ON me1.MAILITM_PID = m1.MAILITM_PID
            WHERE  (m1.MAIL_CLASS_CD = 'E') 
               AND (me1.EVENT_OFFICE_CD = 1063) 
               AND (me1.EVENT_TYPE_CD = 33) 
               AND (me1.EVENT_GMT_DT >= CONVERT(DATETIME, '2012-05-27 00:00:00', 102))
            GROUP BY m1.MAILITM_FID
  ) oj ON m.MAILITM_FID = oj.Ref3033 
WHERE  (m.MAIL_CLASS_CD = 'E') 
   AND (me.EVENT_OFFICE_CD = 1063) 
   AND (me.EVENT_TYPE_CD = 30) 
   AND (me.EVENT_GMT_DT >= CONVERT(DATETIME, '2012-05-27 00:00:00', 102)) 
   AND (me.EVENT_GMT_DT < CONVERT(DATETIME, '2012-05-28 00:00:00', 102)) 
```

我没有检查你加入的逻辑，我只是​​移动了它们。试试看是否还有这个语法错误..

# sql - 复制文本将占用多少空间存储在 varchar 类型列中

> ID：10874741
> 
> 赞同：0
> 
> 时间：2012-06-03T23:19:02.887
> 
> 标签：sql, sql-server

我了解每个 varchar 字符会占用的空间，但是你们知道它是如何为每一行加起来的吗？特别是，如果我在每一行中保存相同的 varchar 数据，是否有任何智能？

例如：对于以下行

```
Column1
value1
value1
value1
value1
value1 
```

假设如果“value1”占用 7 个字节的空间 - 是否需要 5 * 7 = 35 个字节来存储所有行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:35:31.937

默认情况下，SQL Server 不会压缩您的数据。根据您运行的版本，它是一个选项。

# iphone - 对于我的多对多关系，Core Data 获取速度非常慢？

> ID：10874744
> 
> 赞同：2
> 
> 时间：2012-06-03T23:19:40.663
> 
> 标签：iphone, core-data, nsfetchedresultscontroller

我有一个包含 3 种实体类型的核心数据数据库，即 Unit/Department/Document..

Unit/Department在Department端是一对多的，即一个Unit可以有多个Department，但是每个Department只能有一个Unit。

每个文档都可以是一个或多个单位和/或部门的一部分，我需要能够找到与所选单位或部门匹配的文档。单位 ID 可以是“1234”，该单位的部门 ID 可能是“123499”。请注意，Department id 始终是 Unit 的 4 个数字，然后是描述 Department 的另外 2 个数字。

对于数据模型来说，问题是当我选择一个单元（并且没有部门）并且需要列出该单元下的所有文档时，搜索应该返回属于该单元的所有文档以及该单元的所有文档属于那个单位下的所有部门，搜索需要超过 4 秒，有 5000 个文档，我一定做错了。

我正在使用 NSFetchedResultsController，这是我的谓词。

```
NSPredicate *predicate;
NSFetchRequest *req = [NSFetchRequest fetchRequestWithEntityName:@"Document"];   
[req setPropertiesToFetch:[NSArray arrayWithObjects:@"name",@"publisher",@"isFavourite", nil]];
 req.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"name" ascending:YES]]; 
[req setFetchBatchSize:15];
predicate = [NSPredicate predicateWithFormat:@"ANY units.id == %@ || ANY departments.id BEGINSWITH[cd] %@",self.selectedUnit.id,self.selectedUnit.id]; 
```

我可以用另一种方式做到这一点吗？我想知道我是否可以选择 Unit ，然后通过 Unit.documents 代替，但是我认为不需要我的 FetchController ，我需要将结果放入一个数组中，然后先对它们进行排序（它会获取所有实体，并且需要更长的时间）..

更糟糕的是，我以后还需要能够在文档的 Name 属性中进行搜索，并且 CONTAINS[cd] 使搜索变得更慢，不幸的是我无法将单词拆分为单独的表，因为我需要能够在单词中匹配单词，也就是说，用户可以输入“结果”，搜索应该返回标题中某处有“结果”的所有文档，例如“NSFetchedResultControllers 很酷”

我怎样才能使 CONTAINS 搜索性能更好，现在我只有 5000 个文档，但它也可能是 20000 或更多。

有什么好的想法，想法吗？我看过很多 WWDC Core Data 视频，在 Apple 开发者网站上阅读 Core Data 性能，我真的认为我的做法是正确的，但也许我的模型全错了，我可以在 SQL 调试中看到，那里在连接表上花费了很多时间，我试图弄清楚如何使 SQL 更干净。

非常感谢/雅各布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T08:17:14.330

您的假设是正确的，`CONTAINS`并且`BEGINSWITH`正在显着减慢查询速度。我有两个想法给你：

1.  使用索引（我相信你从 WWDC 视频中知道）。特别是对于您的文本搜索，`CONTAINS`这应该是一个很大的性能提升。

2.  使用您提到的特定谓词，我会尝试使用 id 的 number 属性。在您的方案中，您已经方便地按单位订购了 ID。

谓词可能是这样的：

```
NSNumber *bottom = [NSNumber numberWithInt:[self.selectedUnit.id intValue]*100];
NSNumber *top = [NSNumber numberWithInt:([self.selectedUnit.id intValue]+1)*100];
[NSPredicate predicateWithFormat:
   @"ANY units.id == %@ || ANY (departments.id > %@ AND departments.id < %@)",
   self.selectedUnit.id, bottom, top]; 
```

# javascript - jQuery trouble registering 2 keyevent listeners

> ID：10874752
> 
> 赞同：1
> 
> 时间：2012-06-03T23:21:01.667
> 
> 标签：javascript, jquery, html, events

I want to be able to listen to multiple button presses, like so:

```
$("#body").keypress(function(event) {

        if (event.which == 49) { //1
         //do something
        }
        if (event.which == 68) { //d 
             //do something else
        }

}); 
```

But I'm not able to intercept the "d" keypress. Any advice?

Cheers

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T23:24:36.700

You could use a switch statement, permitting 100 (lowercase 'd') to fall through to 68 (uppercase 'D'):

```
$("#foo").on("keypress", function(e){
    switch( e.which ) {
        case 49 :
          alert( "You pressed a 1" );
          break;
        case 100:
        case 68 :
          alert( "You pressed a 'd'" );
    }
});​ 
```

Fiddle: [http://jsfiddle.net/jonathansampson/CJKUh/](http://jsfiddle.net/jonathansampson/CJKUh/)

# php - 一个永远不会结束的脚本（使用 usleep）作为 cron 作业的替代方案 - 好主意吗？

> ID：10874756
> 
> 赞同：0
> 
> 时间：2012-06-03T23:21:29.483
> 
> 标签：php, cron, cron-task, usleep

我正在开发一个开源应用程序，该应用程序将分发给不同主机上的用户。无论出于何种原因，其中一些主机都会禁用 cron 作业。

现在就个人而言，我认为拥有一个永远不会`usleep(X)`在循环中使用的脚本，作为 cron 的替代方案是一个愚蠢的想法，仅仅是因为所有关于`usleep()`占用 CPU 的讨论。但是，这是我不完全确定的事情。

可以使用这样的东西作为 cron 作业的替代品吗？如果没有，我还应该去哪里看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:44:10.787

我不太确定使用 PHP 的 usleep 创建一个虚假的 cron 作业是一个多么好的想法（从阅读 usleep 的 PHP 页面来看，评论确实听起来好像它在睡眠时不会占用 CPU） . 但是，还有另一种方法。

这个 cron 工作需要多及时？您可以做的是将以下内容添加到网页的`<head>`.

```
<script type="text/javascript" src="cron.js" defer="defer"></script> 
```

cron.js 看起来像：

```
(new Image()).src = 'cron.php?' + (new Date).getTime(); 
```

一旦页面完成加载，这将加载一个图像（图像是 cron.php，我添加了 getTime 以防止缓存）。cron.php 文件将执行任何需要完成的任务，如果有的话。然后它会输出一个图像（可能是一个空的、透明的像素）。

如果网站获得足够的点击量，即使需要按时运行 cron，这也可能是可行的。

此外，如果您有一个表或其他确定是否需要运行任务的方法，您可以在将 cron.js 文件包含在文档中之前检查是否需要运行 cron `<head>`。

# git - Maven 发布：准备提交标签失败

> ID：10874759
> 
> 赞同：7
> 
> 时间：2012-06-03T23:21:50.313
> 
> 标签：git, maven-release-plugin

尝试在之前已成功发布的 maven 项目上执行发布。

当我执行`mvn release:prepare`时，系统会提示我输入发布标签和新的快照标签以及项目构建。

但是当它试图推送到遥控器时，我得到

`[ERROR] Failed to execute goal org.apache.maven.plugins:maven-release-plugin:2.0:prepare (default-cli) on project NeuralAnalysis: Unable to tag SCM [ERROR] Provider message: [ERROR] The git-push command failed. [ERROR] Command output: [ERROR] To ssh://gitosis@10.41.129.2/NeuralAnalysis.git [ERROR] ! [rejected] NeuralAnalysis-1.5.6 -> NeuralAnalysis-1.5.6 (non-fast-forward) [ERROR] error: failed to push some refs to 'ssh://gitosis@10.41.129.2/NeuralAnalysis.git' [ERROR] To prevent you from losing history, non-fast-forward updates were rejected`

事实上，尝试 `git push ssh://gitosis@10.41.129.2/NeuralAnalysis.git NeuralAnalysis-1.5.6`手动执行也会以同样的抱怨退出。

表演`git pull`说“已经是最新的”。`git branch`表明我在“大师”上。`git push origin`给出“一切都是最新的”。

使用 Tower 查看存储库显示“master”、“origin/master”和“NeuralAnalysis-1.5.6”都是相同的，并且在最后一次提交中。工作目录包含 release.properties 和 pom.xml.releaseBackup 文件。

在我看来，整个存储库的一切都很好。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-04T15:37:40.437

原来它是一个同名的远程标签，正如 VonC 在评论中所建议的那样。这很可能是由一些以前中止的版本创建的。

虽然我通过手动检查远程存储库上的 refs/tags 目录找到了远程标记，但 `git ls-remote --tags`也会显示它们，并且`git push --verbose`也会显示更多关于一般问题的信息。

要解决此问题，首先使用 检索远程标签`git fetch --tags`。

执行下一步的一种方法是通过更新 pom.xml 以具有更高的 -SNAPSHOT 版本（包括其他模块在同一项目中对该快照的任何引用）来简单地绕过该发布标记，签入并执行`mvn release:clean; mvn release:prepare`再次。

# html - SVG 图像知道它们的纵横比；为什么浏览器不尊重它？

> ID：10874763
> 
> 赞同：9
> 
> 时间：2012-06-03T23:22:09.817
> 
> 标签：html, svg

在 HTML5 文档中链接或内联的 SVG 图像是一种相对年轻的做法（按 Web 标准），但我认为它快速成熟很重要。现代浏览器应该如何调整任何一种 svg 图像的大小，只说明它们的纵横比（根据它们的`viewBox`），以及父 HTML 文档在哪里只给出了宽度或高度中的一个（但不是两者）？

为了有效地缩小主题，这个问题只涉及`<!DOCTYPE html>`HTML5 文档。

我制作了一个[测试页面](http://jsfiddle.net/ecmanaut/Up5uK/)，在几个不同的 HTML 上下文中显示了这一点，并且只有 Firefox 的行为方式符合我的预期（并且更喜欢），在所有测试的情况下，从两者中推断出一个。在早期的测试中，Chrome 也曾使用过，但现在不再使用了。歌剧院非常接近。

## 这个问题的背景和背景

我喜欢 SVG 的一件事是，该格式允许您制作呈现为您拥有的任何文档大小的图像，只要您说明应该显示图像的哪些部分（以及可选地应该如何裁剪），而*不是*说明它应该画多大。

实际上，这让您可以在浏览器中随意查看[漂亮的徽标](http://getbetterlinks.com/logo.svg)并调整其大小，只需将浏览器窗口调整为您想要的任何大小，它就会愉快地绘制到新的边界框，而不用大惊小怪。

这是通过`viewBox`在元素上设置一个属性来完成的`<svg>`，但既不设置`width`也不设置`height`属性，因此它保留了该纵横比，使用（默认）[svg 定位和裁剪策略](http://www.w3.org/TR/SVG/coords.html#PreserveAspectRatioAttribute)，`preserveAspectRatio="xMidYMid meet"`这基本上`background-position: 50% 50%; background-size: contain;`意味着对于 CSS3 背景图像规范意味着什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T12:58:56.727

您想查看[http://www.w3.org/TR/CSS2/visudet.html#inline-replaced-width](http://www.w3.org/TR/CSS2/visudet.html#inline-replaced-width)以了解此处浏览器所需的行为。CSS 所谓的“内在”是指图像的信息。

这种行为在不久前从更糟糕的默认值改变，因此浏览器很可能在这方面仍然存在问题。

# zend-framework - 如何在 Zend 框架中记录数据库调用

> ID：10874767
> 
> 赞同：0
> 
> 时间：2012-06-03T23:22:55.883
> 
> 标签：zend-framework

过去我使用 FirePHP 记录数据库调用和响应。我现在不想这样做，因为围绕 FirePHP 和版本兼容性似乎存在很多问题。

有没有其他选择？我并不特别需要在浏览器控制台中查看日志记录。我很高兴查阅日志文件...

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T03:00:33.120

[Zend_Db_Profiler](http://framework.zend.com/manual/en/zend.db.profiler.html)与[Zend_Log](http://framework.zend.com/manual/en/zend.log.overview.html)一起应该可以满足您的需求。 `Zend_Db_Profiler`还支持开箱即用的控制台日志记录到 Firebug。

这是我使用的一个插件，它使用分析器总结了所有页面的查询：

```
<?php

class My_Page_Profiler extends Zend_Controller_Plugin_Abstract
{
    public function dispatchLoopShutdown()
    {
        $db = Zend_Controller_Front::getInstance()->getParam('bootstrap')->getResource('db');
        $profiler = $db->getProfiler();

        $totalQueries = $profiler->getTotalNumQueries();
        $queryTime    = $profiler->getTotalElapsedSecs();

        $longestTime = 0;
        $longestQuery = null;
        $queries = $profiler->getQueryProfiles();

        $content = "Executed $totalQueries database queries in $queryTime seconds<br />\n";

        if ($queries !== false) { // loop over each query issued
            foreach ($queries as $query) {
                $content .= "\n<!-- Query (" . $query->getElapsedSecs() . "s): " . $query->getQuery() . "\n\n -->\n";
                if ($query->getElapsedSecs() > $longestTime) {
                    $longestTime = $query->getElapsedSecs();
                    $longestQuery = htmlspecialchars(addcslashes($query->getQuery(), '"'));
                }
            }

            $content .= "Longest query time: $longestTime."
                       ." <a href=\"#\" onclick=\"return false\" title=\"$longestQuery\">Mouseover for query</a><br />\n";
        }

        // Log $content here, or append it to the response body

        $this->getResponse()->setBody($this->getResponse()->getBody() .
                                      $content);
    }
} 
```

出于我的目的，我在开发模式下在页脚中显示分析器信息，但您可以轻松更改最后一行以`$content`根据需要记录和重组内容。您还可以将其更改为一次记录每个查询，而不是从所有查询中构建一个 HTML 字符串。希望这为您提供了如何使用`Zend_Db_Profiler`.

要使用它，您需要先启用分析器，然后从 bootstrap 或 application.ini 注册该插件。

有几种方法可以启用分析器，您可以在[Zend_Db_Profiler 介绍](http://framework.zend.com/manual/en/zend.db.profiler.html)中看到这些方法。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T03:09:02.323

最简单的方法是创建自己的数据库探查器。例如，在 ini 配置文件中使用 firebug+firephp 分析器的配置将如下所示：

```
resources.db.params.dbname              = "dbname"
resources.db.params.username            = "username"
resources.db.params.password            = "password"
resources.db.params.profiler.enabled    = 1
resources.db.params.profiler.class      = "Zend_Db_Profiler_Firebug" 
```

如果我们看一下`Zend_Db_Profiler_Firebug`它确实是一段非常简单的代码，它扩展`Zend_Db_Profiler`了覆盖一些方法来实现 firebug+firephp 日志记录逻辑。

所以我们可以通过扩展来创建我们自己的自定义日志分析器`Zend_Db_Profiler`。例如，我们的自定义分析器可能包含在自定义库中`CustomLib_Db_Profiler`：

```
CustomLib_Db_Profile extends Zend_Db_Profiler
{
    // log db profiling to file logic ...
} 
```

现在我们需要做的就是打开我们的自定义日志记录例程，在我们的配置文件中更改`Zend_Db_Profiler_Firebug`为，就像这样*（当然，这假设**前缀，在这个例子中，在包含路径上）*：`CustomLib_Db_Profiler`*`CustomLib`*

```
resources.db.params.dbname              = "dbname"
resources.db.params.username            = "username"
resources.db.params.password            = "password"
resources.db.params.profiler.enabled    = 1
resources.db.params.profiler.class      = "CustomLib_Db_Profiler" 
```

# cakephp - 发生异常时，CakePHP 2.0 不加载自定义帮助程序

> ID：10874770
> 
> 赞同：3
> 
> 时间：2012-06-03T23:23:40.257
> 
> 标签：cakephp, cakephp-2.0

我正在创建一个 CakePHP 应用程序，但每当抛出异常（例如安全异常等）时，都不会加载任何自定义帮助程序。这会导致页面出错，并且显示未加载帮助程序错误而不是异常。

我的助手都加载在 AppController 中，大多数时候我对它们没有任何问题。我刚刚添加了安全组件来防止 CSRF，但是每当我模拟 CSRF 时，我都会收到以下错误：

```
    注意（8）：未定义属性：View::$HelperName [CORE/Cake/View/View.php, line 804]

    View::__get() - CORE/Cake/View/View.php，第 804 行
    包括 - APP/View/Layouts/default.ctp，第 105 行
    View::_evaluate() - CORE/Cake/View/View.php，第 908 行
    View::_render() - CORE/Cake/View/View.php，第 872 行
    View::renderLayout() - CORE/Cake/View/View.php，第 527 行
    View::render() - CORE/Cake/View/View.php，第 471 行
    Controller::render() - CORE/Cake/Controller/Controller.php，第 959 行
    ExceptionRenderer::_outputMessage() - CORE/Cake/Error/ExceptionRenderer.php，第 263 行
    ExceptionRenderer::error400() - CORE/Cake/Error/ExceptionRenderer.php，第 209 行
    ExceptionRenderer::render() - CORE/Cake/Error/ExceptionRenderer.php，第 165 行
    ErrorHandler::handleException() - CORE/Cake/Error/ErrorHandler.php，第 127 行
    [主] - [内部]，线路 ??

```

不过，它只是我的自定义助手，而不是核心助手。我想显示异常错误，并将自定义助手作为布局核心部分的帮助。

您可以提供的任何帮助都将非常棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-20T20:08:01.547

正如评论中提到的，这是一个现已修复的错误 - [cakephp.lighthouseapp.com/projects/42648/tickets/2274](http://cakephp.lighthouseapp.com/projects/42648/tickets/2274)（感谢 tigrang）。

# groovy - DSL 中字符串的 Groovy 评估

> ID：10874772
> 
> 赞同：1
> 
> 时间：2012-06-03T23:23:44.377
> 
> 标签：groovy, dsl, evaluate

我正在尝试使用 Groovy 编写类似 BASIC 的 DSL，而且我还处于早期阶段。我有一个简短的脚本（忽略包位，我会在适当的时候重构它）：

```
package Binsic
PRINT "Hello World" 
```

和这个类：

```
package Binsic

abstract class BinsicInterpreter extends Script {

static def textArea

static def setTextArea(def window)
{
    textArea = window
}

def PRINT(def param) {
    textArea.append param
} 
```

}

以这种方式调用：

```
def engine = new BinsicEngine()
BinsicInterpreter.setTextArea(engine.binsicWindow.screenZX)
def conf = new CompilerConfiguration()
conf.setScriptBaseClass("BinsicInterpreter")
def shell = new GroovyShell(conf)
shell.evaluate(new File("./src/Binsic/test.bas")) 
```

（BinsicEngine 目前只是设置了 TextArea）

此代码失败...

org.codehaus.groovy.control.MultipleCompilationErrorsException：启动失败：/Users/adrian/Documents/workspace-sts-2.9.1.RELEASE/BINSIC/src/Binsic/test.bas：3：意外令牌：Hello World @ line 3 ，第 7 列。打印“Hello World”^

1 个错误

但是，如果我将语句更改为 PRINT ("Hello World") 它就可以了...

同样，如果我调整 PRINT 代码来处理非字符串，我可以让 PRINT this 工作（即它打印内存引用）。但不需要括号。

为什么不带括号的版本不起作用？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T00:37:03.573

问题是大写的 PRINT - 或任何大写的首字母（例如 Print）。

在 Groovy 中，省略括号是提供更好的 DSL 支持的语法糖。编译器将有一套关于何时允许和何时不允许的规则。

在我的测试中

```
def Print(String arg) {
    println arg
}
def a = Print "Hello World" 
```

工作，而

```
def Print(String arg) {
    println arg
}
Print "Hello World" 
```

正如你所发现的那样失败。[我建议在http://groovy.codehaus.org/](http://groovy.codehaus.org/)上将其作为一个问题提出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T00:47:59.330

它似乎与大写的 PRINT 方法有关。将它从“打印”更改为“foo”，它就可以工作了。将其更改为“FOO”，它不起作用。

# html - 非本地应用程序中足够快的 HTML5 Google Maps API（Sencha 和 Phonegap 解决方案）

> ID：10874774
> 
> 赞同：3
> 
> 时间：2012-06-03T23:24:13.053
> 
> 标签：html, cordova, google-maps-api-3, sencha-touch-2

我正在尝试使用 Phonegap 和 Sencha 来创建一些应用程序。

我确实知道原生开发会带来更快的应用程序，但我想尝试一下“如此著名”的 HTML5 黑暗（？）方面。

我一直在尝试安装一个简单且最小化的 Phonegap 和 Sencha 套件，然后放一个 jQueryMobile，然后是一个 Google Maps API 典型示例......即使在我的 Galaxy S2 上也很慢......不用说在 iPhone 3 上也很慢.

因此，我决定删除 jQueryMobile，并使用调用 Google Maps API 的简单 HTML5 网页编译尽可能小的 Sencha 和 Phonegap 样板。而且……慢！

（显然）与本机解决方案无关......与否？

有人知道在不开发本地应用程序的情况下放置谷歌地图的足够快的解决方案吗？（或者如果我需要使用地图开发应用程序，我必须使用本地）

**注意：**我尝试了所有东西的最新版本……Google Maps v3 API、Sencha Touch 2、Phonegap 1.7.1。

测试代码：

*   [http://www.sencha.com/forum/showthread.php?156501-Maps-with-sencha-touch](http://www.sencha.com/forum/showthread.php?156501-Maps-with-sencha-touch)
*   [http://www.mobiledevelopersolutions.com/home/start/twominutetutorials/tmt4part1](http://www.mobiledevelopersolutions.com/home/start/twominutetutorials/tmt4part1)
*   应用程序：[https ://play.google.com/store/apps/details?id=com.mds.gmapdemo&feature=more_from_developer#?t=W251bGwsMSwyLDEwMiwiY29tLm1kcy5nbWFwZGVtbyJd](https://play.google.com/store/apps/details?id=com.mds.gmapdemo&feature=more_from_developer#?t=W251bGwsMSwyLDEwMiwiY29tLm1kcy5nbWFwZGVtbyJd)
*   [http://jquery-ui-map.googlecode.com/svn/trunk/demos/jquery-google-maps-mobile.html](http://jquery-ui-map.googlecode.com/svn/trunk/demos/jquery-google-maps-mobile.html)

与 Galaxy S2 中的本机解决方案相比，所有这些示例都非常慢……而且在其他“典型”Android 中非常非常非常慢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T11:06:16.803

你可以试试诺基亚地图html5： [http](http://api.maps.nokia.com/en/mobile/) ://api.maps.nokia.com/en/mobile/（mh5框架）

它有一个非常快速的映射实现！

# asp.net - 在 rowdatabound 上格式化 gridview 单元格文本

> ID：10874776
> 
> 赞同：1
> 
> 时间：2012-06-03T23:24:20.913
> 
> 标签：asp.net, gridview

以下代码是我的 gridview 的 rowdatabound 事件。它适用于除单元格文本格式作为货币之外的所有内容。事实上，我格式化货币的代码行会导致代码出错。如果我注释掉 FormatCurrency 行，则代码可以正常工作。为什么那行a）。不格式化单元格的文本和 b)。导致错误？

```
 Protected Sub gvDataRetrieval_RowDataBound(sender As Object, e As GridViewRowEventArgs) Handles gvDataRetrieval.RowDataBound
    If e.Row.RowType = DataControlRowType.DataRow Then
        Dim dateindex As Integer = GetColumnIndexByHeaderText(gvDataRetrieval, "date")
        e.Row.Cells(dateindex).Text = Split(e.Row.Cells(dateindex).Text, " ")(0)
        For i As Integer = 0 To e.Row.Cells.Count - 1
            e.Row.Cells(i).Font.Size = 10
            e.Row.Cells(i).HorizontalAlign = HorizontalAlign.Center
            If i > dateindex Then
                If Convert.ToDecimal(e.Row.Cells(i).Text) < 0 Then
                    e.Row.Cells(i).ForeColor = Drawing.Color.Red
                Else
                    e.Row.Cells(i).ForeColor = Drawing.Color.Black
                End If
            End If
            e.Row.Cells(i).Text = FormatCurrency(e.Row.Cells(i).Text, 0)
        Next
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-04T00:13:40.710

尝试使用

```
e.Row.Cells(i).Text = Convert.ToDecimal(e.Row.Cells(i).Text).ToString("c0") 
```

代替

```
e.Row.Cells(i).Text = Format(e.Row.Cells(i).Text, "c0").ToString() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-04T00:20:18.703

正如上面其他人所说，如果您尝试将非数字值格式化为货币，您的代码将出错，在我看来，您没有这样做。

相反，如果您希望将特定列格式化为货币，请使用该列的 DataFormatString 属性，如下所示：

```
<asp:BoundColumn DataField="YourCurrencyField" DataFormatString="{0:C}" /> 
```

显然，您仍然需要确保您的字段是可以格式化为货币的有效数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T23:59:36.383

移动

```
 e.Row.Cells(i).Text = Format(e.Row.Cells(i).Text, "c0").ToString() 
```

进入 If 函数。该行没有检查它是否是日期列。可能试图将日期转换为货币

```
 If i > dateindex Then
            If Convert.ToDecimal(e.Row.Cells(i).Text) < 0 Then
                e.Row.Cells(i).ForeColor = Drawing.Color.Red
            Else
                e.Row.Cells(i).ForeColor = Drawing.Color.Black
            End If
            e.Row.Cells(i).Text = Format(e.Row.Cells(i).Text, "c0").ToString()
        End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-13T06:03:53.853

我在 C# 中遇到了同样的问题，并通过先将文本转换为双精度，然后将双精度格式化为字符串来解决。

我知道这是 VB 而不是 C#，但我想我会分享我的解决方案，因为它出现在我的 Google 结果中，并且可能会帮助某人。

```
double d;
Double.TryParse(r.Cells[i].Text, out d);
e.Cells[i].Text = String.Format("{0:C0}", d).ToString(); 
```

# bash - awk - 两个脚本如何相互交互？

> ID：10874780
> 
> 赞同：1
> 
> 时间：2012-06-03T23:25:13.737
> 
> 标签：bash, shell, awk, gawk

我没有找到关于这个主题的任何明确的教程。假设我有一个输入文件：

```
1 abc
1 def
1 ghi
1 lalala
1 heyhey
2 ahb
2 bbh
3 chch
3 chchch
3 oiohho
3 nonon
3 halal
3 whatever 
```

假设我想找到第一个出现的最大列数，即出现 6 次的“3”。然后我需要将此数字（即 6）提供给另一个脚本以通过文件进行一些计算。有什么方法可以做到这一点？

基本上，我想知道是否可以编写一个函数来遍历文件并在调用辅助函数的主函数中找到“max”。另外，我想知道是否可以在辅助函数中执行 $(...) 来调用“awk”或其他系统函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T01:25:53.390

```
awk 'NR == FNR {nums[$1]++; next} ! flag {flag = 1; for (num in nums) {if (nums[i] > max) {max = nums[i]}}} {print max * $3}' filetomax filetoprocess 
```

这里分为多行：

```
awk '
    NR == FNR {
        nums[$1]++;
        next
    } 
    ! flag {
        flag = 1; 
        for (num in nums) {
            if (nums[i] > max) {
                max = nums[i]
            }
        }
    } 
    {
        print max * $3
    }
' filetomax filetoprocess 
```

在这里，我们正在执行相同的操作来查找您之前[见过](https://stackoverflow.com/a/10859690/26428)的最大数字。我们不是使用主块和`END`块，而是使用一种通常用于处理一个文件然后处理另一个文件的技术。该`NR == FNR`条件仅在读取第一个文件时为真，因为`NR`在所有文件中为每一行增加的记录号 ( ) 共同等于`FNR`为每个新文件重置的文件记录号 ( )。在与此条件相关的块中，计算每个数字出现的次数。该`next`语句导致执行循环以从文件中读取下一行。当到达第二个文件时，条件不再为真，将跳过此块。

下一个条件 ( `! flag`) 检查变量的内容是否为真。因为没有设置，所以是假的。感叹号否定条件，因此此时执行移至该块。现在设置了标志，因此下次检查条件时，将跳过此块。循环检查哪个数字出现的`for`次数最多，就像我对您的另一个问题的回答一样。

现在，可以以您喜欢的任何方式处理第二个文件，并且可以`max`在此处理期间使用该变量。我只是用一个`print`陈述来说明这一点。您仍然可以`END`像往常一样使用块选择器条件，包括一个或多个块。我没有显示一个`BEGIN`块，但是您可以在此脚本的顶部添加一个块以进行所需的任何初始化。请注意，第一个文件的处理可以在`BEGIN`块中使用`getline`. 这只是完成同一件事的另一种技术。

文件名按它们要处理的顺序列出。找到最大计数的文件我称为“filetomax”。对我进行主要处理的第二个文件称为“filetoprocess”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T23:36:47.353

我们为此使用**管道。**它获取第一个进程的标准输出并将其连接到第二个进程的标准输入。

```
awk ... | awk ... 
```

# java - 带有命令的 Java 聊天服务器

> ID：10874782
> 
> 赞同：2
> 
> 时间：2012-06-03T23:25:25.793
> 
> 标签：java, tcp, command, chat, java.util.scanner

因此，我正在用 Java 制作一个聊天服务器，以摆脱对 Hamachi 在我的 Minecraft 服务器中托管和通信的依赖。它完美地工作，除了一件事：我无法弄清楚如何*向*服务器添加命令。我的主循环如下：

```
/*Executed in constructor*/
public void listen(int port) throws IOException {
    //Initialize the ServerSocket
    ss = new ServerSocket(port);
    System.out.println("Listening on " + InetAddress.getLocalHost() + ":" + ss.getLocalPort());

    running = true;

    //Keep accepting connections
    while (running) {
        //Get the incoming connection
        Socket s = ss.accept();
        System.out.println("Connection from: " + getFullIP(s));

        //Create a DataOutputStream for writing data to the other side
        DataOutputStream dataOut = new DataOutputStream(s.getOutputStream());

        //Save this stream so I don't have to make it again
        outputStreams.put(s, dataOut);

        //Create a new thread for this connection
        new ServerThread(this, s);

        if (!running) {
            stop();
        }
        Scanner cmdScanner = new Scanner(System.in);
        String command = cmdScanner.next();
        processCommand(command);
    }
} 
```

此代码的结果是，在客户端连接到服务器之前，我无法键入命令（因为`ss.accept()`）。在我执行命令之前，客户端无法连接（`cmdScanner.next()`）。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:28:42.423

我认为您的命令处理器应该在另一个线程中。恕我直言，服务器应该始终有一个线程，唯一的工作就是接收新连接并分派它。处理您的输入应该是其他线程的一部分。

```
public class TestThread
{
    public static void main(String[] args)
    {
        new ConnectionDispatcher(8080).start();
        new CommandProcessor().start();
    }
}
class ConnectionDispatcher extends Thread{
    private int port;
    private OutputStream outputStreams;

    ConnectionDispatcher(int port)
    {
        this.port = port;
    }

    @Override
    public void run()
    {
        try
        {
            listen(port);
        }
        catch (IOException e)
        {
            e.printStackTrace();
        }
    }

    public void listen(int port) throws IOException
    {
        //Initialize the ServerSocket
        ss = new ServerSocket(port);
        System.out.println("Listening on " + InetAddress.getLocalHost() + ":" + ss.getLocalPort());

        boolean running = true;

        //Keep accepting connections
        while (running) {
            //Get the incoming connection
            Socket s = ss.accept();
            System.out.println("Connection from: " + getFullIP(s));

            //Create a DataOutputStream for writing data to the other side
            DataOutputStream dataOut = new DataOutputStream(s.getOutputStream());

            //Save this stream so I don't have to make it again
            outputStreams.put(s, dataOut);

            //Create a new thread for this connection
            new ServerThread(this, s);

        }
    }
}

class CommandProcessor extends Thread{
    @Override
    public void run()
    {
        Scanner cmdScanner = new Scanner(System.in);
        String command = cmdScanner.next();
        processCommand(command);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T23:41:54.027

当我开始网络时，我遇到了同样的问题。您的线程在 ss.accept() 处停止，然后在代码中没有继续。您需要实现另一个专用于您的 ServerSocket 的线程。这是一个例子：

```
public class Server implements Runnable
{
    ServerSocket server; // the serverSock your clients will connect to
    Thread thread; // the thread for your server
    boolean running; // whether or not the server is running

    public Server(int port)
    {
        running = false; // server is not yet running
        connect(port); // setup server
    }

    public void connect(int port)
    {
        try
        { 
            server = new ServerSocket(port); setup server on port 

            running = true; // server is running
            thread = new Thread(this); // initialize server thread
            thread.start(); // start thread
        } catch(Exception e){e.printStackTrace(); running = false;} // port is in use
    }

    public void disconnect()
    {
        try
        {
            server.close();
        }catch(Exception e){e.printStackTrace();}

        running = false;
        thread = null;
        server = null;
    }

    public void run()
    {
        while(running)
        {
            Socket client = server.accept(); // client connects to server
            // handle the client...
            ClientHandler handler = new ClientHandler(client);
        }
    }

    public class ClientHandler implements Runnable
    {
        Thread clientThread;
        DataOutputStream out;

        public ClientHandler(Socket socket)
        {
            out = new DataOutputStream(socket.getOutputStream());//setup the output stream
            clientThread = new Thread(this); // setup the new thread
            clientThread.start();   // start the thread
        }

        public void run()
        {
            /* this is where you get your input from the console and then
             * send the output to the client
             */
        }
    }
} 
```

这应该可以防止您的主线程卡在 server.accept() 希望这有帮助！

# objective-c - Objective-C：需要帮助理解为什么两种方法在以两种不同方式访问 UIView 时反应不同

> ID：10874786
> 
> 赞同：0
> 
> 时间：2012-06-03T23:26:00.830
> 
> 标签：objective-c, uiview, presentmodalviewcontroller

在两天的时间里问了三个问题我感觉很糟糕，但是我被困在了论坛上，我找不到答案，所以我希望有人能帮助我——我想这都是学习乐趣的一部分！

在我的程序中，我有三个视图，它们的顺序是 GridScreen -> GameScreen -> CorrectScreen。在 CorrectScreen 上，我有一个返回到 GridScreen 的按钮。

在 GridScreen 上，我有一堆按钮，用户可以按这些按钮进入 GameScreen。当用户正确回答问题时，他会从 GameScreen 转到 CorrectScreen 进行确认，然后返回到 GridScreen。

在上一个问题中，我询问如何跟踪在 GridScreen 上按下的按钮，以便当我从 CorrectScreen 回到它时，我可以用勾号替换图标。之前已经解决了，但是这样做我又产生了另一个问题。

在 CorrectScreen 中，当用户按下按钮返回时，会调用以下两个函数：

```
[self.gridScreen updateUserIcon:buttonThatWasPressed];
[self.gridScreen updatePoints:accumulatedpoints]; 
```

其中 updateUserIcon 是：

```
-(void)updateUserIcon:(UIButton *)button
{
UIButton *buttonPressed = button; 
self.button1 = buttonPressed;
[self.button1 setImage:[UIImage imageNamed:@"tick.png"] forState:UIControlStateNormal];
} 
```

updatePoints 是：

```
-(void)updatePoints:(int)points
{
    self.currentPoints.text = [[NSString alloc]initWithFormat:@"Current points: %d", points];
} 
```

其中 button1 是 UIButton 而 currentPoints 是 UILabel。

现在，当我在调用这两个函数后使用以下代码返回 GridScreen 时，勾选出现在我想要的按钮上，但标签没有正确更新：第一种情况：

```
[[[self presentingViewController]presentingViewController] dismissModalViewControllerAnimated:YES]; 
```

而如果我使用这种下一种方式，勾号根本不会出现，但标签会完美更新：第二种情况：

```
GridScreen *screen = [[GridScreen alloc] initWithNibName:nil bundle:nil];
screen.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
[self presentModalViewController:screen animated:YES]; 
```

（我通常使用第二种情况加载视图）。

在第一种情况下，即使我执行了以下代码：

```
-(void)updatePoints:(int)points
{
    self.currentPoints.text = @"A";
    NSLog(@"Current Points %@", self.currentPoints.text);
} 
```

我的 NSLog 返回当前点 (null)。

解决方案与我返回 GridScreen 的第一种方法有关勾号。

如果有人可以提供帮助，我很想知道 - 我对使用 Objective-C 进行编程相当陌生，所以如果其中任何一个是“糟糕的代码”，我很高兴被告知哪里出了问题，所以我不会犯类似的错误。

再次感谢大家，这个网站非常适合提供帮助，我提前感谢您的建议。

安迪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:53:25.767

好的，愚蠢的问题，但你为什么不只是使用通知来向屏幕发送消息？

这是最简单和最安全的方法。

在 GridScreen 添加此通知：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(toggleLabel:) name:@"CorrectAnswerNotification" object:nil]; 
```

在推新屏幕之前。

现在在 CorrectScreen 中，在弹出视图之前触发该通知：

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"CorrectAnswerNotification" object:self userInfo:nil]; 
```

在 userInfo 字典中传递你想要的任何信息（这可以是一个字典，所以你可以传递你需要的任何信息）

并在 GridScreen 中管理 toggleLabel 方法中的所有内容：

```
-(void)toggleLabel:(NSNotification *)notification {

    //read the documentation dictionary
    NSDictionary *infoDictionary = [notification userInfo];
    //remove the notification first

    [[NSNotificationCenter defaultCenter] removeObserver:self name:@"CorrectAnswerNotification" object:nil];

    //now change the buttons...
    [self updateUserIcon:buttonThatWasPressed];
    [self updatePoints:accumulatedpoints];

} 
```

因为我被问到通知中心，所以这里有一些直接来自[Apple 文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsnotificationcenter_Class/Reference/Reference.html)的详细信息：

> NSNotificationCenter 对象（或简称为通知中心）提供了一种在程序中广播信息的机制。NSNotificationCenter 对象本质上是一个通知调度表。
> 
> 对象注册到通知中心以使用 addObserver:selector:name:object: 或 addObserverForName:object:queue:usingBlock: 方法接收通知（NSNotification 对象）。此方法的每次调用都指定一组通知。因此，对象可以通过多次调用这些方法注册为不同通知集的观察者。
> 
> 当一个对象（称为通知发送者）发布通知时，它会向通知中心发送一个 NSNotification 对象。然后，通知中心通过向他们发送指定的通知消息，将通知作为唯一参数传递来通知通知满足注册时指定标准的任何观察者。
> 
> 通知中心维护一个通知调度表，该表为特定观察者指定一个通知集。通知集是发布到通知中心的通知的子集。每个表条目包含三个项目：
> 
> ```
> Notification observer: Required. The object to be notified when qualifying notifications are posted to the notification center.
> 
> Notification name: Optional. Specifying a name reduces the set of notifications the entry specifies to those that have this name.
> 
> Notification sender: Optional. Specifying a sender reduces the set of notifications the entry specifies to those sent by this object. 
> ```

# php - Elgg 1.8 和 Drupal 7 之间的无缝成员集成

> ID：10874789
> 
> 赞同：1
> 
> 时间：2012-06-03T23:26:24.263
> 
> 标签：php, drupal, integration, elgg

我将如何将 drupal 的会员功能与 elgg 社交网络功能集成？

我大概会将它们放在子域上，人们会在我的社交部分的 drupal 网站上使用他们已经创建的帐户。有没有为此目的的插件？如果没有，那么哪里是最好的起点。

我只有基本的 PHP 知识，所以我对这件事有点陌生。

阿马尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:50:17.790

据我所知，没有公共插件可以集成 Elgg 和 Drupal。

集成两个软件并不是一项真正的手工任务，因为*您*比我们任何人都知道如何更好地集成两个站点。另外，它本身通常是一个相当大的项目，用简单的“做这个做这个”来回答并不容易。

如果你觉得你有足够的 PHP 知识来阅读一个脚本并且对正在发生的事情有一个公平的理解，你应该研究一下 Elgg 和 Drupal 的脚本。彻底研究这两种软件的运行方式，以及它们如何开发其功能。查找您不知道的*所有内容。*真正考虑如何将您想要的功能交织在一起。这种整合肯定不是一天就能完成的；为数周或数月的投资做好准备。

根据个人经验，我建议您选择*一个*软件作为其他软件将遵循的“基础”。例如，如果您喜欢整个 Elgg 中成员的身份验证方式以及每个页面的结构，请考虑将 Drupal 的功能与 Elgg 的体系结构保持一致。

另一方面，如果您觉得自己是一个相当新手的程序员，也许您应该从一个较小的项目开始，以掌握开发软件的技巧。创建您自己的个人社交网站或内容管理系统。毕竟，集成两个软件与从头开始制作*一个软件非常相似，因为通常有很多需要改变的地方。*

祝你好运！

# java - 是否可以通过将“new Object()”转换为泛型类来实例化泛型类？

> ID：10874791
> 
> 赞同：1
> 
> 时间：2012-06-03T23:26:40.240
> 
> 标签：java, generics, object, casting, instantiation

所以我试图创建一个使用泛型扩展抽象类的类。前任。

```
public abstract class Template<C extends Abstract> 
```

但是，我需要在我的班级中实例化这个“C”。我想我也许可以这样做：

```
C s = (C) ((C)new Object()).getClass().getConstructor(Known.class,AnotherKnown.class).newInstance(objectOfKnownType,objectOfAnotherKnownType); 
```

所以我的问题基本上是这是否可能。我觉得像

```
((C) new Object()).getClass() 
```

可能会给我一些问题。

如果我将其更改为：

```
C a;
C s = (C) (a.getClass().getConstructor( ... ).newInstance( ... )); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T23:29:10.207

```
(C) new Object() 
```

无效，可能会在`ClassCastException`稍后给您，因为 an`Object`不是`C`.

[泛型的实现](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)方式意味着`Template`不知道`C`它是用什么来实例化的，你必须创建一个接受`Class`对象的方法或构造函数。

```
public abstract class Template<C extends Abstract>
{
    private Class<C> classOfC;

    public Template( Class<C> clazz ) {
        classOfC = clazz;
    }
} 
```

# javascript - 如何在不使用 youtube/ggole api 的情况下检测视频当前是否正在页面中播放

> ID：10874794
> 
> 赞同：0
> 
> 时间：2012-06-03T23:27:33.100
> 
> 标签：javascript, jquery

情况：我有一个页面显示我们的成员提交的帖子（新闻）流。我在此页面中有一个 setInterval() 导致它每 x 秒刷新一次 - 如果用户空闲 x 秒。

最近我添加了视频帖子，用户可以在其中单击一个项目，视频将立即在页面中开始播放（到目前为止，我只使用 youtube iframe）。

问题：我的自动刷新有时会在用户观看视频并“空闲”时刷新新闻内容......这会导致视频关闭和内容重置......等等。这意味着，用户将失去他/她在视频中的位置并且必须重新开始。

我的问题：如何检测此页面是否至少有一个当前正在“播放”的视频？我想用它来决定是否应该发生自动刷新。

注意：我目前不赞成使用自定义播放器或 google/youtube js api，因为很快我将添加对来自其他服务（例如 vimeo、56.com...等）的视频的支持。

问题改写：是否有“通用”javascript 或 jquery 方法来检测视频当前是否正在文档或窗口中播放？

谢谢！

# assembly - 如何在 x86-64 汇编中使用浮点数？

> ID：10874796
> 
> 赞同：4
> 
> 时间：2012-06-03T23:28:11.410
> 
> 标签：assembly, x86-64, nasm, intel, fpu

我正在为一些 x86-64 程序集而苦苦挣扎，浮点数让我头疼。例如，当我运行此代码时：

```
section .data
     omega:  dq 2.0
     omega2: dq 3.0

section .text
global func

func: push rbp
      mov rgp, rsp

      FINIT

      FLD qword [omega]
      FLD qword [omega2]
      FADD st0, st0

      mov rsp, rbp
      pop rbp
      ret 
```

这个函数是从这样的 C 代码中调用的：`printf("%Lf \n", func() );` 不幸的是，结果是一些奇怪的数字......我尝试使用 将两个整数相加`FIADD`，它工作正常。我已经翻阅了大量的材料，但也许这里有人可以指点我体面的 FPU 教程，或者分享她/他的经验和智慧:)

总结要点：

*   语言：x86-64 汇编器
*   汇编程序：从存储库安装的 nasm v. 2.09.04
*   编译器（用于 C）：gcc v. 4.5.2（随 Ubuntu 安装）
*   操作系统：Oracle VM 上的 Ubuntu 11.04 64 位
*   主机操作系统：Windows 7 SP1 64bit
*   处理器：Intel i5 - 2430M 64bit（检查两次：D）
*   问题：FPU 不能添加两个数字 :(

以防万一：最后我希望使用`FSINCOS`和其他花哨的 FPU 指令，但看到即使简单的添加也失败了......

提前谢谢大家！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T02:09:06.530

好的，所以最后发现我的问题与 FPU 寄存器被组织为堆栈的事实有关，而我没有给予足够的关注，这导致了垃圾和不需要的剩余物。从“标准”版本到“流行”版本的指令有帮助！

无论如何-感谢所有愿意阅读的人，非常感谢！:)

如果有人感兴趣 - 我正在做一个课堂作业，我必须从装配中另一个（地心模型）的角度计算一个行星的运动。[可以在此处查看转换为处理的最终结果。](http://home.elka.pw.edu.pl/~plopusin/arko/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T23:36:53.233

printf %f的`L`限定符使该参数成为`long double`（80 位浮点数），它不是程序集数据类型。删除`L`它，它将默认为`double`您正在计算的（64 位浮点数）。

另外，应该是

```
 FADD st1, st0 
```

将两个数字相加。否则它将使第二个值加倍。

# javascript - jquery可以检测表列宽度的变化吗

> ID：10874803
> 
> 赞同：4
> 
> 时间：2012-06-03T23:31:01.930
> 
> 标签：javascript, jquery

我有一个包含多个列的表，并且所有列都有标题。当通过 ajax 将数据加载到表中时，有时列宽会发生变化。如何检测任何列的宽度变化？可以用jquery完成吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T23:45:23.223

不幸的是，没有可靠的方法来检测元素尺寸的变化。作为替代方案，也许您可​​以在 ajax 中添加一些代码来记录开始（可能使用`beforeSend`）和结束宽度（从内部`success`）。当它不同时，使用`.trigger()`. 从应用程序中的任何位置订阅该事件以响应宽度的变化。

# windows-phone-7.1 - 检测 wp7 sdk 和特定组件的存在

> ID：10874808
> 
> 赞同：0
> 
> 时间：2012-06-03T23:31:53.017
> 
> 标签：windows-phone-7.1, windows-phone, windows-phone-7.1.1

有没有办法以编程方式检测 Windows Phone 7 SDK（版本 7.0、7.1 和/或 7.11）和特定组件（如模拟器、模拟器版本、模拟器映像版本、程序集等）的存在。

我希望通过一个简单的 .NET 4 控制台应用程序来做到这一点。[如何判断机器使用的 WP7 SDK 版本？](https://stackoverflow.com/questions/7309633/how-can-i-tell-what-wp7-sdk-version-a-machine-is-using)有一点信息，但似乎不够完整。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T14:20:25.853

这是我用于设备信息的类

```
public class DeviceInformation
{
    public static Device GetDeviceInfo()
    {
        Device deviceInfo = new Device();
        deviceInfo.Id = getDeviceId();
        deviceInfo.Name = getDeviceName();
        deviceInfo.Manufacturer = getDeviceManufacturer();
        deviceInfo.OSVersion = System.Environment.OSVersion.ToString();
        deviceInfo.Language = CultureInfo.CurrentUICulture.TwoLetterISOLanguageName;

        return deviceInfo;
    }

    private static String getDeviceId()
    {
        Object uniqueId;
        StringBuilder deviceId = new StringBuilder();
        if (DeviceExtendedProperties.TryGetValue("DeviceUniqueId", out uniqueId))
        {
            for (int i = 0; i < ((byte[])uniqueId).Length; i++)
            {
                deviceId.Append(((byte[])uniqueId)[i]);
            }
        }

        return deviceId.ToString();
    }

    private static String getDeviceName()
    {
        Object deviceName;
        DeviceExtendedProperties.TryGetValue("DeviceName", out deviceName);
        return deviceName.ToString();
    }

    private static String getDeviceManufacturer()
    {
        Object deviceManufacturer;
        DeviceExtendedProperties.TryGetValue("DeviceManufacturer", out deviceManufacturer);
        return deviceManufacturer.ToString();
    }
} 
```

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T14:40:51.500

我相信，您想获取有关在开发人员机器上安装的开发人员工具的信息。出于这个原因，一种方法可能是检查已安装的文件夹，并且可以使用以下代码：

```
 public static List<double> GetSdkVersion()
           {
               var versions = new List<double>();
               var data = System.Environment.GetFolderPath(System.Environment.SpecialFolder.ProgramFilesX86);
               var sdkPath = Path.Combine(data, @"Microsoft SDKs\Windows Phone\v7.0");
               var version = Directory.Exists(sdkPath);
               versions.Add(7.0);
               sdkPath = Path.Combine(data, @"Microsoft SDKs\Windows Phone\v7.1");
               return versions;
           }

            public static List<double> GetEmulatorVersios()
            {
                var versions = new List<double>();
                var data = System.Environment.GetFolderPath(System.Environment.SpecialFolder.ProgramFilesX86);
                var sdkPath = Path.Combine(data, @"Microsoft XDE\1.0");
                var version = Directory.Exists(sdkPath);
                versions.Add(1.0);
                return versions;
            } 
```

确实，编写此代码可能会更好，但这是我可以提供的。希望能帮助到你。

# javascript - Ajax 重新发送 XMLHttpRequest

> ID：10874809
> 
> 赞同：3
> 
> 时间：2012-06-03T23:31:58.983
> 
> 标签：javascript, ajax, xmlhttprequest

我有一个这样的客户端 js/ajax 脚本：

```
<p>server  time  is:  <strong  id="stime">Please  wait...</strong></p>

<script>
function  updateAjax()  {
    xmlhttp  =  new  XMLHttpRequest();
    xmlhttp.onreadystatechange  =  function()  {
        if (xmlhttp.readyState==3  &&  xmlhttp.status==200)  {
            document.getElementById("stime").innerHTML=
            xmlhttp.responseText;
        }
        if  (xmlhttp.readyState==4)  {  
            xmlhttp.open("GET","date-sleep.php",true);
            xmlhttp.send();
        }
    }
    xmlhttp.open("GET","date-sleep.php",true);  
    xmlhttp.send();
}
window.setTimeout("updateAjax();",100);
</script> 
```

在服务器端：

```
<?php
    echo  6;
    for  ($i=0;  $i<10;  $i++)  {
        echo  $i;
        ob_flush();  flush();
        sleep(1);
    }
?> 
```

在第一次“打开”和“发送”之后它工作正常，但是当服务器完成脚本`xmlhttp.readyState == 4`然后 xmlhttp 重新发送请求但没有任何反应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:37:51.627

不要一直重复使用同一个 XHR 对象，而是尝试使用新对象重复该函数。这至少应该解决您列出的不兼容问题。

如果您想无限循环它，请尝试在它的回调中重新调用您的 Ajax 函数。

```
if  (xmlhttp.readyState==4) {  
     updateAjax(); //or setTimeout("updateAjax();",100); if you want a delay
} 
```

我还建议将您的`.innerHTML`方法放在 中[`.readyState==4`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms753702%28v=vs.85%29.aspx)，即请求的文档已完全加载，[`.status==200`](http://www.w3.org/Protocols/HTTP/HTRESP.html)这意味着成功。像这样：

```
if (xmlhttp.readyState==4  &&  xmlhttp.status==200) {
       document.getElementById("stime").innerHTML=
       xmlhttp.responseText;
       updateAjax(); //or setTimeout("updateAjax();",100);
} 
```

此外，如果您希望 Ajax 跨浏览器，您应该测试浏览器是否支持您正在使用的[XHR 对象：](http://en.wikipedia.org/wiki/XMLHttpRequest)

```
var xmlhttp = (window.XMLHttpRequest) ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP"); 
```

我刚刚输入了上面的代码，但它应该可以很好地添加与旧版本 IE 和其他浏览器的兼容性。

# android - Android listselector 在自定义列表视图中不可见

> ID：10874813
> 
> 赞同：2
> 
> 时间：2012-06-03T23:33:49.027
> 
> 标签：android, listview, listitem

我制作了一个包含图像和文本视图的自定义列表。在设置样式时，选择器不可见。使用 setTheme(R.style.rose); 调用样式。在 Listactivity 的 create 方法中作为第一个调用。但是，如果没有颜色用作背景（或样式中的背景线被注释），则橙色选择器可见。但不是当背景是

列表选择器

```
<item   android:state_focused="true"
        android:state_pressed="true" 
        android:drawable="@drawable/list_selector_background_transition" />

<item   android:state_pressed="true" 
        android:drawable="@drawable/list_selector_background_pressed" />

<item   android:state_focused="true" 
        android:drawable="@drawable/list_selector_background_focus" /> 
```

风格

```
<style name="rose">
    <item name="android:textColor">@color/pink</item>
    <item name="android:background">@color/rose</item>
    <item name="android:cacheColorHint">@color/rose</item>

    <item name="android:listSelector">@drawable/listitem_selector</item>  
</style> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-11T09:25:11.527

Android 首先绘制 ListView 背景以及分隔线。然后，系统绘制列表选择器。最后，ListView 在此之上呈现所有 itemview。因此，将不透明背景设置为 itemviews 时，列表选择器将永远不可见

[http://android.cyrilmottier.com/?p=454](http://android.cyrilmottier.com/?p=454)

![在此处输入图像描述](../Images/a307797c3992d99e9ce6ae0f1e702830.png)

# objective-c - NSTimer 的问题

> ID：10874816
> 
> 赞同：0
> 
> 时间：2012-06-03T23:33:58.120
> 
> 标签：objective-c, xcode, cocoa

我在使用 NSTimers 时遇到了很多麻烦。我以前用过它们，但这个计时器就是不想开火。

```
-(void) enqueueRecordingProcess
{
    NSLog(@"made it!");
    NSTimer *time2 = [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(warnForRecording) userInfo:nil repeats:YES];

}

-(void) warnForRecording
{
    NSLog(@"timer ticked!");
    if (trv > 0) {
        NSLog(@"Starting Recording in %i seconds.", trv);
    }
} 
```

我不明白为什么这不会运行。我什至试过这个：

```
- (void)enqueueRecordingProcess
{
    NSLog(@"made it!");
    [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(warnForRecording) userInfo:nil repeats:YES];
}

 - (void)warnForRecording
{
    NSLog(@"timer ticked!");
} 
```

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:38:33.950

不确定这是否可以解决，但来自[文档](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/nstimer_Class/Reference/NSTimer.html)：

```
The message to send to target when the timer fires. The selector must have the following signature:
- (void)timerFireMethod:(NSTimer*)theTimer
The timer passes itself as the argument to this method. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T04:12:19.673

我不确定您的具体情况，但是您需要为 runloop 提供服务才能获取事件，包括计时器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-13T04:00:14.967

```
// Yes.  Here is sample code (tested on OS X 10.8.4, command-line).
// Using ARC:
// $ cc -o timer timer.m -fobjc-arc -framework Foundation
// $ ./timer
//

#include <Foundation/Foundation.h>

@interface MyClass : NSObject
@property NSTimer *timer;
-(id)init;
-(void)onTick:(NSTimer *)aTimer;
@end

@implementation MyClass
-(id)init {
    id newInstance = [super init];
    if (newInstance) {
        NSLog(@"Creating timer...");
        _timer = [NSTimer scheduledTimerWithTimeInterval:1.0
            target:self
            selector:@selector(onTick:)
            userInfo:nil
            repeats:YES];
    }
    return newInstance;
}

-(void)onTick:(NSTimer *)aTimer {
    NSLog(@"Tick");
}
@end

int main() {
    @autoreleasepool {
        MyClass *obj = [[MyClass alloc] init];
        [[NSRunLoop currentRunLoop] run];
    }
    return 0;
} 
```

# java - 按钮单击更改文本视图

> ID：10874817
> 
> 赞同：1
> 
> 时间：2012-06-03T23:34:09.597
> 
> 标签：java, android, textview, android-button

我想制作一个简单的计数器程序，其中有一个 Textview 和两个按钮，一个带有 + 另一个带有 - 无论我按哪个，我都会增加或减少 1。

我的问题是我希望 Textview 更新变量而不是文本。（我的意思是我可以使用该应用程序，`.setText("counter:"+ var_counter)`但不能使用`.setText(var_counter)`.

var_counter 是一个整数。

```
 final TextView tvContador = (TextView)findViewById(R.id.tvContador);
Button add = (Button)findViewById(R.id.bMais);
Button sub = (Button)findViewById(R.id.bMenos);
add.setOnClickListener(new View.OnClickListener() {
       @Override
       public void onClick(View v) {
           contador++;                                 
           tvContador.setText(getText(contador));
       }
}); 
```

ps：我的字符串是资源字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:42:01.547

由于`var_counter`is an `int`，`setText(var_counter)`尝试将小部件的文本设置为字符串资源，其值为*id*。你想要的是：

```
setText(Integer.toString(var_counter)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T23:42:11.227

采用

```
.setText(Integer.toString(var_counter)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T23:47:37.120

简单地：

```
.setText(""+var_counter); 
```

# scala - 如何在 ScalaQuery 中编写查询以创建可重用的特征？

> ID：10874820
> 
> 赞同：13
> 
> 时间：2012-06-03T23:34:17.960
> 
> 标签：scala, scalaquery

我在将不同的查询组件组合成一个查询时遇到了一些麻烦。我的目标是创建一组特征（例如 SoftDeletable、HasName、SortedByName、WithTimestamps），我可以简单地将其混合到 Table 对象中以添加该行为。

理想情况如下：

```
abstract class BaseModel[Tuple <: Product,CaseClass](tableName: String)
     extends Table[Tuple](tableName) {
  def id = column[Int]("id", O.AutoInc, O.PrimaryKey)

  def mapped: MappedProjection[CaseClass, TupleClass]

  def allQuery = this.map(_.mapped)
  final def all = database.withSession { implicit session: Session => 
    allQuery.list() 
  }

  ...
}

trait SoftDeletable[Tuple  <: Product, CaseClass]
    extends BaseModel[Tuple,CaseClass] {
  def isActive = column[String]("is_active")

  def * = super.* ~ isActive
  def allQuery = /* here, I'd like to compose super.allQuery 
                    with a filter that returns rows where isActive is true */
}

trait HasName[Tuple <: Product] extends Table[Tuple] {
  def name = column[String]("name")

  def * = super.* ~ name
}

trait SortedByName[Tuple <: Product] extends HasName[Tuple {
  override def allQuery = super.allQuery /* compose somehow 
                                             with (_ <- Query orderBy name */
} 
```

我可以用 ScalaQuery 做这些事情吗？主要的难点是：

1.  我如何干净地组合过滤器和`SoftDeletable.allQuery`排序？`SortedByName.allQuery``BaseModel.allQuery`

2.  通过在方法的子类实现中添加列`*`，元组类型参数`Table`不匹配 - 有没有办法让这些特征逐步向最终具体类中的列元组添加新类型？（我不希望有，但如果我缺少一些东西会很好）。

3.  我需要在每个特征中重复长元组声明，如果表有五或六列，这将变得非常笨拙。我可以对类型成员做些什么来避免做类似的事情：

    ```
    case class Foo

    class Foos[(Int,Int,Boolean,String), Foo] extends 
      Table[(Int,Int,Boolean,String)] with 
      SoftDeletable[(Int,Int,Boolean,String), Foo] with 
      SortedByName[(Int,Int,Boolean,String), Foo] with 
      HasName[(Int,Int,Boolean,String)] {
    } 
    ```

我可以避免所有这些重复吗？根据 jesnor 在 IRC 上的建议，我能够避免这样的一些情况：

```
abstract class SoftDeletableBaseModel[TupleClass <: Product, CaseClass](tableName: String)
        extends BaseModel[TupleClass, CaseClass](tableName)
        with SoftDeletable[TupleClass,CaseClass] 
```

换句话说，通过将特定的特征组合在一起，我不需要重复整个元组声明；当然，缺点是不再可能轻松混合各种特征 - 我需要创建许多特定的子类来避免这种重复。还有其他方法吗？

**更新**：所以我意识到我不需要使用单独的 CaseClass 和 TupleClass 类型参数。既然case类实现`Product*`了，就可以把case类名传给Table，解决了3中的问题：

```
trait SoftDeletable[CaseClass] extends BaseModel[CaseClass] { ... }

class Models extends BaseModel[Model]("models") with SoftDeletable[Model] { ... } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T07:14:54.117

If your issue is only adding the sort, isn't it just a matter of flatMap?

```
def sortBy[T,U,C](q: Query[T,U], col: NamedColumn[C]) = q.flatMap(_ => Query orderBy col) 
```

# caching - 使用文本文件缓存 JSON 数据

> ID：10874822
> 
> 赞同：0
> 
> 时间：2012-06-03T23:34:49.863
> 
> 标签：caching, filesystems

我正在尝试为我的项目建立一个缓存系统，其想法是将每个用户的最后信息（作为 JSON 数据）保存在一个文本文件中，该文本文件存在于该用户的特殊文件夹中，而不是访问数据库每次该用户登录或更新页面时获取全部所需信息，我调用用户表中的一个小字段`Uptodate`来决定我应该更新文本文件还是简单地调用现有文件。
我正在努力避免使用内存来处理数据，这是完成这项工作的好方法吗？我应该将数据保存为文本文件吗？如何将数据添加到现有文件的顶部？
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:44:32.667

HTML5 [localStorage](http://diveintohtml5.info/storage.html)非常适合您尝试做的事情。

localStorage.setItem("json_data", JSONdata);

警报（localStorage.getItem（“json_data”））；

# mysql - SUBQUERY 总结行

> ID：10874829
> 
> 赞同：2
> 
> 时间：2012-06-03T23:35:50.703
> 
> 标签：mysql, sql

以下结果是从我创建的 SELECT 语句创建的：

```
total           date        currency    provider    conversion_to_usd
170.0168890000  2012-01-01  AUD         Telluride    1.06694
177.5532500000  2012-01-01  CAD         Telluride    1.00030
33.1864000000   2012-01-01  NZD         Telluride    0.82966
687.4900000000  2012-01-01  USD         Telluride    1.00000 
```

我如何在这里总结行销售额，例如 170.016*1.066 + 177.55*1.00...

```
SELECT SUM(...) FROM <SELECT STATEMENT ABOVE> ? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:39:06.120

您可以给该`SELECT`语句一个**别名**。

然后，这将允许您引用列`total`，并`conversion_to_usd`在 上使用它们的值`SUM`，从而执行所需的计算：

```
SELECT SUM(t.total*t.conversion_to_usd) FROM (SELECT STATEMENT ABOVE) t 
```

# c# - 分层数据的高级 LINQ 分组和投影查询（EF 4.0 + LINQ + ASP.NET MVC + HighCharts）

> ID：10874835
> 
> 赞同：4
> 
> 时间：2012-06-03T23:36:49.607
> 
> 标签：c#, asp.net-mvc-3, linq, entity-framework, highcharts

# 问题概述：

我有数据库表，这些表描述了使用 Web 服务从多个设备收集到集中式数据库的数据。

为了性能，存储结果的表被刻意去规范化：通过多个索引进行更快的查询和分组。 **我正在使用 Entity Framework 和 Linq 进行数据访问。**

> 我需要使用**分层分组和投影正确****设计 Linq 查询**。

 *** * *

# 设备数据库建模概述：

目前我有两种类型的设备

## 1\. 射频识别设备

第一个表是描述收集数据的标签的 RfidTag，**1 个 RfidTag = 1 个单个传感器**。因此，例如 1 个单标签可以获取有关温度的数据。

第二个表是 RfidReader，它描述了读取模块，该模块收集并发送来自附加标签的所有数据。对单个 RfidReader 附加 RfidTag 的数量没有限制。**然而，一个单一的 RfidTag 可以在读取期间附加到一个单一的 RfidReader。**

```
CREATE TABLE [dbo].[RfidTag]
(
    Id INT IDENTITY(1,1),
    CreatedDateTime DATETIME NOT NULL DEFAULT GETDATE(),
    ModifiedDateTime DATETIME,
    --
    ReaderId INT NULL,                  -- Reference to reader
    SensorTypeId INT NOT NULL,          -- Reference to sensor type
    SensorParameters NVARCHAR(50) NULL, -- Sensor parameters
    Hex  NVARCHAR(50) NOT NULL,         -- Hex tag identifier stored as string
    Name NVARCHAR(50) NOT NULL,         -- Tag name
    [Description] NVARCHAR(200) NULL,   -- Tag description
    --
)

CREATE TABLE [dbo].[RfidReader]
(
    Id INT IDENTITY(1,1),
    CreatedDateTime  DATETIME NOT NULL DEFAULT GETDATE(),
    ModifiedDateTime DATETIME,
    --
    Name        NVARCHAR(20),        -- Tag name
    [Description]   NVARCHAR(200),   -- Tag description                                             
    SerialNumber    NVARCHAR(12),    -- Unique device serial name               
    --
) 
```

每个 RfidReader**都可以连接到针对特定结构描述的特定**测量**区域**。

```
CREATE TABLE [dbo].[RfidReaderPlacement]
(
    Id INT IDENTITY(1,1),
    CreatedDateTime DATETIME NOT NULL DEFAULT GETDATE(),
    --
    ReaderId INT NOT NULL,              -- Reference to Reader.
    MeasurementZoneId INT NOT NULL,     -- Reference to Measurement Zone.
    StartDate DATETIME NOT NULL,        -- Start date of reading.
    StopDate  DATETIME,                 -- End date of reading.
    --
) 
```

**RfidTag 收集的单个数据**保存在非规范化表中。该表存储了数百万条记录，并且负载非常重。**从此表中，我们将使用 LINQ 查询收集数据。**

```
CREATE TABLE [dbo].[RfidReading]
(
    Id INT IDENTITY(1,1),
    CreatedDateTime DATETIME NOT NULL DEFAULT GETDATE(),
    ModifiedDateTime DATETIME,
    --
    ReaderPlacementId INT NOT NULL, -- Reference to Rfid Reader Placement
    ConstructionId  INT NOT NULL,   -- Reference to Construction
    MeasurementZoneId INT NOT NULL, -- Reference to Measurement Zone
    ReaderId INT NOT NULL,          -- Reference to Rfid Reader
    TagId    INT NOT NULL,          -- Reference to Rfid Tag
    SensorTypeId INT NOT NULL,      -- Reference to Sensor Type
    ReadingDate DATETIME NOT NULL,  -- Reading date
    Value FLOAT NOT NULL            -- Measured value
    --
) 
```

## 2\. ZigBee 设备

第一个表是 ZigBeeNodeProbe，它描述了收集数据的单个探针，**1 个 ZigBeeNodeProbe = 1 个单个传感器**。因此，例如 1 个单探头可以获取有关温度的数据。

第二个表是 ZigBeeNode，它描述了包含附加探针的单个设备，**1 个 ZigBeeNode = 3 个 ZigBeeNodeProbes**。

第三个表是 ZigBeeReader，它描述了从附加节点收集所有数据并将其发送到它的读取模块。对单个 ZigBeeReader 的附加 ZigBeeNodes（已附加 ZigBeeNodeProbes）的数量没有限制。**然而，一个单一的 ZigBeeNode 可以在读取期间连接到一个单一的 ZigBeeReader。**

```
CREATE TABLE [dbo].[ZigBeeNodeProbe]
(
    Id INT IDENTITY(1,1),
    CreatedDateTime DATETIME NOT NULL DEFAULT GETDATE(),
    --
    NodeId INT NULL,                    -- Reference to node
    SensorTypeId INT NOT NULL,          -- Reference to sensor type
    SensorParameters NVARCHAR(50) NULL, -- Sensor parameters
    SocketNumber  INT NOT NULL,         -- Socket number used in parent ZigBeeNode
    Name NVARCHAR(50) NOT NULL,         -- Node name
    [Description] NVARCHAR(200) NULL,   -- Node description
    --
)

CREATE TABLE [dbo].[ZigBeeNode]
(
    Id INT IDENTITY(1,1),
    CreatedDateTime DATETIME NOT NULL DEFAULT GETDATE(),
    ModifiedDateTime DATETIME,
    --
    ReaderId INT NULL,                    -- Reference to reader
    NetworkAddress  NVARCHAR(50) NOT NULL,-- Node address in ZigBee network
    Name NVARCHAR(50) NOT NULL,           -- Given name
    [Description] NVARCHAR(200) NULL,     -- Tag description
    SocketCount INT NOT NULL DEFAULT 0,   -- Count of available sockets to plug in probe
    NodeFrequency INT NULL,               -- Node frequency
)

CREATE TABLE [dbo].[ZigBeeReader]
(
    Id INT IDENTITY(1,1),
    CreatedDateTime  DATETIME NOT NULL DEFAULT GETDATE(),
    ModifiedDateTime DATETIME,
    --
    Name        NVARCHAR(20),        -- Tag name
    [Description]   NVARCHAR(200),   -- Tag description                                             
    SerialNumber    NVARCHAR(12),    -- Unique device serial name               
    --
) 
```

每个 ZigBeeReader**都可以连接到针对特定结构描述的特定**测量**区域**。

```
CREATE TABLE [dbo].[ZigBeeReaderPlacement]
(
    Id INT IDENTITY(1,1),
    CreatedDateTime DATETIME NOT NULL DEFAULT GETDATE(),
    --
    ReaderId INT NOT NULL,              -- Reference to Reader.
    MeasurementZoneId INT NOT NULL,     -- Reference to Measurement Zone.
    StartDate DATETIME NOT NULL,        -- Start date of reading.
    StopDate  DATETIME,                 -- End date of reading.
    --
) 
```

**ZigBeeNodeProbe 收集的单个数据**保存在非规范化表中。该表存储了数百万条记录，并且负载非常重。**从此表中，我们将使用 LINQ 查询收集数据。**

```
CREATE TABLE [dbo].[ZigBeeReading]
(
    Id INT IDENTITY(1,1),
    CreatedDateTime DATETIME NOT NULL DEFAULT GETDATE(),
    ModifiedDateTime DATETIME,
    --
    ReaderPlacementId INT NOT NULL, -- Reference to ZigBee Reader Placement
    ConstructionId    INT NOT NULL, -- Reference to Construction
    MeasurementZoneId INT NOT NULL, -- Reference to Measurement Zone
    ReaderId      INT NOT NULL,     -- Reference to ZigBee Reader
    NodeId        INT NOT NULL,     -- Reference to ZigBee Node
    ProbeId       INT NOT NULL,     -- Reference to ZigBee Node Probe
    SensorTypeId      INT NOT NULL, -- Reference to Sensor Type
    ReadingDate   DATETIME NOT NULL,-- Reading date
    Value         FLOAT NOT NULL    -- Measured value
    --
) 
```

* * *

# 查询、分组和投影问题：

正如您在上面看到的，我们有 2 个分散的表，其中包含由 2 种提到的设备收集的数据。**是的，我们可以假设 RfidTag 在业务建模中与 ZigBeeNodeProbe 几乎相同。**

```
RfidReader
-- RFidTag
-- RFidTag
...

ZigBeeReader
-- ZigBeeNode
---- ZigBeeNodeProbe
---- ZigBeeNodeProbe
---- ZigBeeNodeProbe
-- ZigBeeNode
---- ZigBeeNodeProbe
---- ZigBeeNodeProbe
---- ZigBeeNodeProbe
... 
```

现在我们必须**查询这两个表**，将不同表中的值投影到相同的视图模型中，并添加特定的分组来过滤数据。

## 常见场景：

我们想创建一个图表来显示特定测量区域的平均温度**，**请记住特定测量区域可能包含多个附加的阅读器（Rfid 和 ZigBee），因此我们必须提供一系列数据。

我正在使用必须启用的HightStock [http://www.highcharts.com/products/highstock图表：](http://www.highcharts.com/products/highstock)

*   缩放 1 个月、3 个月、6 个月等。
*   从，到日期期间
*   导出功能
*   具有启用和禁用系列的图例

图表示例：

[http://jsfiddle.net/hNHUY/1/](http://jsfiddle.net/hNHUY/1/)

## 问题：

**如何为分层数据创建 LINQ 分组和投影查询？** **我们需要为 RfidReading 和 ZigBeeReading 表提供通用视图模型。**

我的第一次尝试是这样的：

```
public class ReadingReaderDataModel
{
    public string SeriesName { get; set; }
    public ReadingPeriod ReadingPeriod { get; set; }

    public IEnumerable<ReadingNodeDataModel> ReadingNodeDataModels { get; set; }
    public ReadingReaderDataModel()
    {
        ReadingNodeDataModels = new List<ReadingNodeDataModel>();
    }
}

public class ReadingNodeDataModel
{
    public string NodeName { get; set; }
    public IEnumerable<double> DataValues { get; set; }
    public ReadingNodeDataModel()
    {
        DataValues = new LinkedList<double>();
    }
}

public enum ReadingPeriod
{
    OneMonth, ThreeMonths, SixMonths, YearToDay, OneYear, All
}

public enum ReaderType
{
    Rfid, ZigBee
} 
```

稍后我必须为 ASP.NET MVC 控制器设计 LINQ 投影，在这里我不知道如何创建正确的查询，该查询必须包含按 OneMonth、ThreeMonths、SixMonths、YearToDay、OneYear、All 分组的时间段的平均值。

谁能帮我设计这个高级 LINQ 查询？

**编辑**

请不要为大型数据集指出任何“建议”...

这不是关于性能的问题。

这个问题是关于复杂的 LINQ 查询。我正在寻找正确的 LINQ 代码，而不是像“那辆车更快，你应该尝试使用那辆车”这样的答案......请提供代码答案......如果你甚至不尝试理解场景并提供任何代码，请不要参加...

我特别添加了一个赏金来寻找 LINQ 的解决方案，因为它是高级 LINQ 问题，就像这个问题的主题一样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T15:58:34.063

据我了解，您的数据库中有数百万条记录，您的应用程序需要非常好的性能，并且您的结构非常复杂。

远离 EF，我是认真的。您可以将它用于较小的数据集，但对于需要从大型查询中获得卓越性能的任何内容，甚至不要去那里。

我的建议是手动编写查询，因为如果您想使用 EF 尽可能多地进行优化，您实际上将无法跳过太多代码，并且基本上是以 LINQ 方式编写 SQL（即指定所有 SELECT 语句） .

如果您想要更具体一点，请使用 Dapper。它是运行 StackOverflow 的“ORM”。这里有速度比较：[http ://code.google.com/p/dapper-dot-net/](http://code.google.com/p/dapper-dot-net/)

但是，如果您一心想要使用 EF...

不要尝试编写一个查询。它不会发生。相反，拆分它们。为您需要制作的每个组选择一个不同的组。这是迄今为止最简单的出路。我相信你应该已经有一个 LINQ 查询来只取出一组。现在对您需要的所有其他组重复此操作，特别是如果您有大量的 Wheres 和 OrderBy 。

资料来源：一个每天处理大型数据集查询的人。**

# java - Android - 媒体播放器崩溃

> ID：10874837
> 
> 赞同：0
> 
> 时间：2012-06-03T23:37:22.990
> 
> 标签：java, android, eclipse, media-player

我正在制作一个播放音乐的安卓应用程序。当我运行它时，我得到一个 NullPointer 异常，我不知道为什么！

这是我活动中 onCreate() 中的代码：

```
MediaPlayer mp = MediaPlayer.create(this, R.raw.tekno);
    mp.start(); 
```

这是我的日志猫：

```
06-03 17:09:51.520: D/MediaPlayer(19255): create failed:
06-03 17:09:51.520: D/MediaPlayer(19255): java.io.IOException: setDataSourceFD failed.: status=0x80000000
06-03 17:09:51.520: D/MediaPlayer(19255):   at android.media.MediaPlayer.setDataSource(Native Method)
06-03 17:09:51.520: D/MediaPlayer(19255):   at android.media.MediaPlayer.create(MediaPlayer.java:735)
06-03 17:09:51.520: D/MediaPlayer(19255):   at com.jlennon.gametest.PlayGameActivity.onCreate(PlayGameActivity.java:31)
06-03 17:09:51.520: D/MediaPlayer(19255):   at android.app.Activity.performCreate(Activity.java:4465)
06-03 17:09:51.520: D/MediaPlayer(19255):   at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
06-03 17:09:51.520: D/MediaPlayer(19255):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
06-03 17:09:51.520: D/MediaPlayer(19255):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
06-03 17:09:51.520: D/MediaPlayer(19255):   at android.app.ActivityThread.access$600(ActivityThread.java:123)
06-03 17:09:51.520: D/MediaPlayer(19255):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
06-03 17:09:51.520: D/MediaPlayer(19255):   at android.os.Handler.dispatchMessage(Handler.java:99)
06-03 17:09:51.520: D/MediaPlayer(19255):   at android.os.Looper.loop(Looper.java:137)
06-03 17:09:51.520: D/MediaPlayer(19255):   at android.app.ActivityThread.main(ActivityThread.java:4424)
06-03 17:09:51.520: D/MediaPlayer(19255):   at java.lang.reflect.Method.invokeNative(Native Method)
06-03 17:09:51.520: D/MediaPlayer(19255):   at java.lang.reflect.Method.invoke(Method.java:511)
06-03 17:09:51.520: D/MediaPlayer(19255):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
06-03 17:09:51.520: D/MediaPlayer(19255):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
06-03 17:09:51.520: D/MediaPlayer(19255):   at dalvik.system.NativeStart.main(Native Method)
06-03 17:09:51.530: D/AndroidRuntime(19255): Shutting down VM
06-03 16:36:23.340: W/dalvikvm(15997): threadid=1: thread exiting with uncaught exception (group=0x40a431f8)
    06-03 16:36:23.350: E/AndroidRuntime(15997): FATAL EXCEPTION: main
    06-03 16:36:23.350: E/AndroidRuntime(15997): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.jlennon.gametest/com.jlennon.gametest.PlayGameActivity}: java.lang.NullPointerException
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at android.app.ActivityThread.access$600(ActivityThread.java:123)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at android.os.Handler.dispatchMessage(Handler.java:99)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at android.os.Looper.loop(Looper.java:137)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at android.app.ActivityThread.main(ActivityThread.java:4424)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at java.lang.reflect.Method.invokeNative(Native Method)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at java.lang.reflect.Method.invoke(Method.java:511)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at dalvik.system.NativeStart.main(Native Method)
    06-03 16:36:23.350: E/AndroidRuntime(15997): Caused by: java.lang.NullPointerException
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at com.jlennon.gametest.PlayGameActivity.onCreate(PlayGameActivity.java:32)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at android.app.Activity.performCreate(Activity.java:4465)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
    06-03 16:36:23.350: E/AndroidRuntime(15997):    ... 11 more 
```

我从中得到的是我的 MediaPlayer.create() 返回 null，我想这一定与我的文件有关。我的音乐文件是 tekno.wav。

提前非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T00:50:10.250

```
06-03 17:09:51.520: D/MediaPlayer(19255): java.io.IOException: setDataSourceFD failed.: status=0x80000000 
```

由于某种原因，Android 似乎无法读取您的 WAV 文件。有关可能相关的一些信息，请参阅以下链接：

[setDataSourceFd 失败](http://forums.pragprog.com/forums/152/topics/9144)

[MediaPlayer.setDataSource 导致有效文件的 IOException](https://stackoverflow.com/a/9752082/321697)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T23:42:25.897

尽量不要用`getApplicationContext`，这样可能会退`null`。也许这也是这里发生的事情。

例如：

```
MediaPlayer mp = MediaPlayer.create(this, R.raw.tekno); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T23:45:20.473

试试这个：

```
MediaPlayer mp = MediaPlayer.create(this, R.raw.tekno);
mp.start(); 
```

# ruby - NoMethodError: 未定义的方法 `split' for # 与法拉第

> ID：10874840
> 
> 赞同：3
> 
> 时间：2012-06-03T23:38:13.590
> 
> 标签：ruby, faraday

我想使用 Faraday 发送带有 JSON 正文（用于搜索）的 get 请求，但出现上述错误。我以为`self`Proc 内部把事情搞砸了，但这与它无关。我正在关注 [法拉第 github 页面][1] 上的文档，但一直坚持这一点。

```
def perform_query
  response = self.database.connection.get do |request|
    request.url self.path
    request.headers['Content-Type'] = 'application/json'
    request.body(self.to_json)
  end
end

def terms_to_json
  terms_array = self.terms.keys.inject([]) do |terms_array, field|
    value = self.terms[field]
    terms_array.tap do |ary|
      if value
        ary << "\"#{field}\": \"#{value}\""
      end 
    end
  end

  "{ #{terms_array.join ','} }"
end

def to_json
  "{ \"queryb\" : #{self.terms_to_json} }"
end 
```

这是堆栈跟踪，错误出现在 get Proc in 的某处`#perform_query`：

```
from /Users/chrismaddox/.rvm/gems/ruby-1.9.3-p125/gems/faraday-0.8.1/lib/faraday/request.rb:60:in `url'
    from /Users/chrismaddox/.rvm/gems/ruby-1.9.3-p125/gems/faraday-0.8.1/lib/faraday/connection.rb:219:in `block in run_request'
    from /Users/chrismaddox/.rvm/gems/ruby-1.9.3-p125/gems/faraday-0.8.1/lib/faraday/connection.rb:237:in `block in build_request'
    from /Users/chrismaddox/.rvm/gems/ruby-1.9.3-p125/gems/faraday-0.8.1/lib/faraday/request.rb:35:in `block in create'
    from /Users/chrismaddox/.rvm/gems/ruby-1.9.3-p125/gems/faraday-0.8.1/lib/faraday/request.rb:34:in `tap'
    from /Users/chrismaddox/.rvm/gems/ruby-1.9.3-p125/gems/faraday-0.8.1/lib/faraday/request.rb:34:in `create'
    from /Users/chrismaddox/.rvm/gems/ruby-1.9.3-p125/gems/faraday-0.8.1/lib/faraday/connection.rb:233:in `build_request'
    from /Users/chrismaddox/.rvm/gems/ruby-1.9.3-p125/gems/faraday-0.8.1/lib/faraday/connection.rb:218:in `run_request'
    from /Users/chrismaddox/.rvm/gems/ruby-1.9.3-p125/gems/faraday-0.8.1/lib/faraday/connection.rb:87:in `get'
    from /Users/chrismaddox/Dropbox/LivingSocial/Hungry Academy/Projects/hackchat/search_ruby/elastic.rb:83:in `method_missing'
    from /Users/chrismaddox/Dropbox/LivingSocial/Hungry Academy/Projects/hackchat/search_ruby/elastic.rb:112:in `perform_query'
    from /Users/chrismaddox/Dropbox/LivingSocial/Hungry Academy/Projects/hackchat/search_ruby/elastic.rb:61:in `send_query' 
```

更新：

path 方法返回搜索给定索引的路径字符串。例如`/wombats/animals/_search`

Elastic::Database#path 调用 Elastic::Index#index_path：

```
module Elastic
  ELASTIC_URL = "http://localhost:9200"

  class Index
    attr_reader :index_name, :type_name, :last

    def initialize(type)
      @index_name = "#{type}-index"
      @type_name = type
      @last = 0
      add_to_elastic
    end

    def add_to_elastic
      index_url = URI.parse "#{ELASTIC_URL}#{index_path}/"
      Connection.new(index_url).put()
    end

    def index_path
      "/#{self.index_name}"
    end

    def search_path
      "#{type_path}/_search/"
    end

    def type_path
      "#{self.index_path}/#{type_name}/"
    end

  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T12:43:15.287

调用 search_path =`"#{type_path}/_search/"` 调用 type_path =`"#{self.index_path}/#{type_name}/"` 调用 index_path =`"/#{self.index_name}"`

因此，如果索引名称是 wombat 并且类型名称是动物，则 search_path 的计算结果为`/wombat/animal//_search`

事实证明，这不是显示错误的问题，而是因为法拉第的方法不一致造成的。`Faraday::Request#url`并且`Faraday::Request#headers`本身是 setter 方法，而是`Faraday::Request#body=`body 的 setter 方法。

# php - 如何通过修改错误处理来跳过带有 PHP 库 TCPDF 和 FPDI 的损坏文件？

> ID：10874846
> 
> 赞同：4
> 
> 时间：2012-06-03T23:39:52.647
> 
> 标签：php, pdf, tcpdf, fpdf, fpdi

我正在使用 PHP 库[TCPDF](http://www.tcpdf.org/)和[FPDI](http://www.setasign.de/products/pdf-php-solutions/fpdi/)来组合 PDF 文档，并且收到以下错误：

> TCPDF 错误：无法在预期位置找到对象 (10, 0)

我有[FPDI](http://www.setasign.de/products/pdf-php-solutions/fpdi-pdf-parser/)的商业版本。

该问题似乎只发生在 PDF 版本 1.3 (Acrobat 4.x) 文件中。这是导致错误的文件的文档属性的屏幕截图。[http://imagebin.org/215041](http://imagebin.org/215041)

我想跳过任何有错误的文件，而不是让脚本死掉。我已经用一个新的类修改了错误处理`ErrorIgnoringTCPDF`，但是它不起作用。

有任何想法吗？

```
require_once('../../libraries/tcpdf/tcpdf.php');
require_once('../../libraries/fpdi/fpdi.php');

class ErrorIgnoringTCPDF extends FPDI {

   public function Error($msg) {
       // unset all class variables
       $this->_destroy(true);

       // exit program and print error
       //die('<strong>TCPDF ERROR: </strong>'.$msg);
   }

}

$pdf = new ErrorIgnoringTCPDF();
$pdf->setPrintHeader(false);

$prows = fetch_data($id);

foreach ($prows AS $row) {

    $irows = get_imaged_docs($row['pat_id']);

    foreach($irows AS $irow){

        if ($irow['type'] === 'application/pdf'){

            $doc_id = $irow['id'];

            $content = get_pdf_imaged_docs($doc_id);

            $pagecount = $pdf->setSourceFile($content);

            for ($i = 1; $i <= $pagecount; $i++) {
                 $tplidx = $pdf->ImportPage($i);
                 $s = $pdf->getTemplatesize($tplidx);
                 $pdf->AddPage('P', array($s['w'], $s['h']));
                 $pdf->useTemplate($tplidx);
            }    

        } else {

            $pdf->AddPage();

            $doc  = fetch_document_content($irow['id'], $irow['filename']);
            $img = base64_encode($doc);

            $imgdata = base64_decode($img);

            $pdf->Image('@'.$imgdata);

        }

    }

}

$pdf->Output('documents.pdf', 'D'); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-06-02T09:54:04.370

如果您使用的是 Linux，您可以使用 shell_exec 来组合文件

```
function combine_pdf($outputName,$fileArray)
{

         $cmd = "gs -q -dNOPAUSE -dBATCH -sDEVICE=pdfwrite -sOutputFile=$outputName ";

         foreach($fileArray as $file)
         {
           $cmd .= $file." ";
         }
         $result = shell_exec($cmd);

 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T09:56:41.997

您是否尝试过仅抑制错误？

```
$pagecount = @$pdf->setSourceFile($content);

if (empty($pagecount))
    continue;  // or whatever you want to do, maybe set $is_invalid = true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-23T15:07:07.883

我不会说这是一个合适/最好的解决方法，但它可能会解决您的问题，

在：pdf_parser.php 中，注释掉以下行：

```
$this->error("Unable to find object ({$obj_spec[1]}, {$obj_spec[2]}) at expected location"); 
```

它应该在 544 行附近。

您可能还需要更换：

```
 if (!is_array($kids))
        $this->error('Cannot find /Kids in current /Page-Dictionary'); 
```

和：

```
 if (!is_array($kids)){
     //   $this->error('Cannot find /Kids in current /Page-Dictionary');
     return;
    } 
```

在 fpdi_pdf_parser.php 文件中

希望有帮助。它对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-04T09:53:35.493

这只是表明 PDF 文档是错误的。它指向未找到预期对象的特定字节偏移位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-16T12:03:17.387

我有同样的问题，我正在使用这段代码来解决我的问题。

```
class convertPDF extends FPDI {

   public function error($msg) {
      throw new Exception($msg); 
   }
   ...other stuff...
}

try {
    $convertPdf = new convertPDF();
} catch(Exception $e) {
    die($e->getMessage);
} 
```

此答案适用于搜索此问题的人。祝你好运！

# css - 如何在 Chrome 中删除明显不可移动的输入 type="search" 边框

> ID：10874850
> 
> 赞同：5
> 
> 时间：2012-06-03T23:40:41.763
> 
> 标签：css, google-chrome, input, border

我已经尝试了很多东西......但边界不会消失。如果你用 type="text" 替换 type="search" 效果很好，但我希望这不是我需要做的。

我试图杀死它

```
input{
    background:transparent;
    border:0;
    border-color:transparent;
    outline:none;
    width:150px;
}​ 
```

但他们似乎都没有完成这项工作。

[http://jsfiddle.net/Kf9Mu/](http://jsfiddle.net/Kf9Mu/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-03T23:48:13.190

显然 Webkit 对搜索输入字段有自定义样式。您可以直接摆脱它，然后应用您自己的边框。我在这里删除它并给它一个红色边框。

```
input{
  -webkit-appearance: none;
  border: 1px solid red;
}​ 
```

[http://jsfiddle.net/Kf9Mu/7/](http://jsfiddle.net/Kf9Mu/7/)

我只在 Chrome 中看过这个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-03T23:49:40.020

你应该试试

```
-webkit-appearance: none; 
```

另请参阅[http://37signals.com/svn/posts/2609-customizing-web-forms-with-css3-and-webkit](http://37signals.com/svn/posts/2609-customizing-web-forms-with-css3-and-webkit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T23:49:41.723

试试这个：

```
input:focus {
    outline: none;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-22T18:58:06.450

不要忘记`-webkit-user-select: none;`

# html - 如何让服务器运行并显示终端实例？

> ID：10874855
> 
> 赞同：0
> 
> 时间：2012-06-03T23:41:36.397
> 
> 标签：html, ruby-on-rails, ruby, web

我有一个 Ruby 程序。我希望用户输入一个 URI 并在浏览器中显示一个终端窗口，该窗口正在运行 .rb 文件的实例。用户应该能够像在终端机器上本地运行 .rb 文件并让服务器响应时那样在浏览器中键入内容。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T01:14:57.407

也许这样的事情会奏效。Linode 使用它来允许最终用户登录到他们的切片。在这种情况下可能可以使用相同的东西。

[http://wiki.contribs.org/Ajaxterm](http://wiki.contribs.org/Ajaxterm)

# asp.net-mvc - 如何使用@html.actionlink 删除链接文本

> ID：10874865
> 
> 赞同：1
> 
> 时间：2012-06-03T23:44:03.690
> 
> 标签：asp.net-mvc, razor

我正在尝试将 css 类添加到 @html.actionlink 并且不想使用链接中的文本。我想改用图形。

这是我的代码：

```
@Html.ActionLink("Edit", "PopupReferenceEdit", new { id = item.VolunteerReferenceID }, new { @class = "Grid-editor" }) 
```

当我删除“编辑”时出现错误。是否可以使用此语句并为链接提供图标/图像？感谢您回答这个新手问题。安迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T11:36:33.530

我认为一个更好的方法是为它创建一个扩展方法，在你的帮助文件夹中使用这些重载，然后在你的视图中使用它。只是取决于个人喜好

```
 public static class ImageActionLinkHelper
  {
    public static string ImageActionLink(this HtmlHelper helper, string ImageUrl, string    altText, string actionName, object routeValues)
    {

    var builder = new TagBuilder("img");
    builder.MergeAttribute("src", ImageUrl);
    builder.MergeAttribute("alt", altText);
    builder.MergeAttribute("title", altText);
    var link = helper.ActionLink("[replaceme]", actionName, routeValues, new { @class = "imgicon" });
    return link.ToString().Replace("[replaceme]", builder.ToString(TagRenderMode.SelfClosing));
}

public static string ImageActionLink(this HtmlHelper helper, string ImageUrl, string altText, string actionName, object routeValues, string Id, string display)
{
    var builder = new TagBuilder("img");
    builder.MergeAttribute("src", ImageUrl);
    builder.MergeAttribute("alt", altText);
    builder.MergeAttribute("title", altText);
    var link = helper.ActionLink("[replaceme]", actionName, routeValues, new { @class = "imgicon", id = Id, style = display });

    return link.ToString().Replace("[replaceme]", builder.ToString(TagRenderMode.SelfClosing));
} 
```

使用它

```
 @Html.ImageActionLink("../../Content/images/edit.png", "Edit", "Edit", new { id = item.UserId}) 
```

# java - 为什么将 Mercurial 项目添加到 Eclipse 后无法构建？

> ID：10874869
> 
> 赞同：0
> 
> 时间：2012-06-03T23:44:35.203
> 
> 标签：java, eclipse, mercurial, build, javac

我用 Mercurial 设置了我的 Eclipse 项目，这样我就可以和一些朋友一起编码。我有一点问题，Eclipse 将不再构建我的项目！构建菜单中的构建项目选项显示为灰色。我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T00:00:17.707

好吧，所以我找到了答案，.project 文件需要一些鬼鬼祟祟的东西。将项目更改为 Java 项目后，我需要添加 Java 构建器。将这些行添加到您的 .project 文件以解决问题：

```
<buildSpec>
    <buildCommand>
        <name>org.eclipse.jdt.core.javabuilder</name>
        <arguments>
        </arguments>
    </buildCommand>
</buildSpec> 
```

# wpf - 将列表框绑定到 ObservableCollection

> ID：10874872
> 
> 赞同：0
> 
> 时间：2012-06-03T23:44:45.287
> 
> 标签：wpf, class, binding, observablecollection

我找不到可以解决此问题的答案。我有一个 ObservableCollection

这是我的班级：

```
public class myClass
    {
      public string name;
      public int[] dimensions = new int[2];
    } 
```

这是设置 ObservableCollection 的代码：

```
public class roomBuilder
{
  private ObservableCollection<myClass> rooms;

      public roomBuilder() //constructor
      {
        string roomName;
        int[] dimensions = new int[2];
        myClass newRoom = new myClass();
        rooms = new ObservableCollection<room>();
        roomName = "Hall";
        dimensions[0] = 10;
        dimensions[1] = 12;
        newRoom.name = roomName;
        newRoom.dimensions = dimensions;
        rooms.Add(newRoom);
        roomListBox.DataContext = rooms;
      } 
```

用于此的 XAML 是：

```
 <ListBox Canvas.Left="-1" Canvas.Top="47" Height="419" Name="roomListBox" Width="481"  BorderThickness="1" BorderBrush="GhostWhite" ItemsSource="{Binding}" DataContext="{Binding}"> 

        <ListBox.ItemTemplate  >
            <DataTemplate   >
                <StackPanel Orientation="Vertical" Margin="1" Name="verstack"   > 
                    <StackPanel Orientation="Horizontal" Margin="1" KeyDown="StackPanel_KeyDown" >
                        <TextBox Text="{Binding  Path=name}" IsReadOnly="False" FontFamily="Courier New" FontSize="22" Height="65" VerticalAlignment="Top" TextAlignment="Center"/>
                        <TextBox Name="xDimension" Text="{Binding Mode=TwoWay, Path=dimensions[0] }"  Width="70" Height="65" VerticalAlignment="Top" IsReadOnly="False" FontFamily="Courier New" Margin="2,0,1,0" FontSize="22" MaxLength="3" InputScope="TelephoneNumber" TextAlignment="Center"  />
                    <TextBlock Name="separator" Text=":" FontSize="32"  FontWeight="ExtraBold" Margin="1,4,1,0"  />
                        <TextBox Name="yDimension" Text="{Binding Mode=TwoWay, Path=dimensions[1] }" Width="70" Height="65" VerticalAlignment="Top"   IsReadOnly="False" FontFamily="Courier New" Margin="1,0,2,0" FontSize="22" MaxLength="3" InputScope="TelephoneNumber" TextAlignment="Center"/> 
```

我还没有在这里关闭 Xaml，它下面还有更多负载，当我运行它时没有显示任何内容，我只是不知道问题是什么，我已经敲了 2 天，请有人帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:50:17.750

房间需要是您绑定到的公共属性。

```
public ObservableCollection<myClass> rooms
{ 
   get { return ........ 
```

# zend-framework - Zend AjaxContext、_redirect 和哈希导航

> ID：10874878
> 
> 赞同：0
> 
> 时间：2012-06-03T23:45:33.850
> 
> 标签：zend-framework, redirect, ajaxcontext

SO中的第一篇文章，尽管我多年来一直在浏览它以解决那些令人兴奋的问题，而不是太多的编码问题。

我想要做的是： * 使用哈希导航 (#!/)。* 使用 Zend 控制器动作，而不是 php 文件。* 通过 javascript/jQuery 加载这些动作。

到目前为止，我已经完成了这个工作：indexController，几个动作，每个动作都通过 addActionContext() 附加到 AjaxContext，我可以通过我的 javascript/jQuery 文件通过“hashchange”插件 jQuery(window).hashchange(function(){布拉布拉}）。我可以很好地循环操作。

但是如果他/她没有登录，我想将用户重定向到登录页面，这给我带来了我的问题：我怎样才能做到这一点？重定向到另一个控制器（登录控制器，登录操作）。我正在尝试类似 $this->_redirect('/#!/login/login'); 没有任何运气（是的，我已经在该控制器的初始化中设置了 AjaxContext）。我不断收到重定向错误（“页面未正确重定向”）。如果我只是在地址栏中输入“/#!/login/login”，我会正确显示所有内容。

无论如何，提前谢谢！干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:33:39.367

现在，如果您曾经引入其他非 ajax 上下文，这将开始变得复杂，但您可以将 Ajax 上下文添加到错误控制器。如果活动上下文是 AJAX，则让错误控制器为未经身份验证的异常返回 JSON（如果默认上下文处于活动状态，则保持重定向）。然后，您的 JS 将侦听 JSON 提供的特定错误，并手动将用户退回到适当的登录 URL。

# jquery - html5文件拖放事件混淆

> ID：10874879
> 
> 赞同：1
> 
> 时间：2012-06-03T23:45:43.383
> 
> 标签：jquery, html, file-upload, drag-and-drop

## 概述

我想将一个事件附加到一个元素以处理文件拖放事件，但似乎这个事件也被附加到所有子元素。例如，

```
$('#dragtarget').on('dragenter', function() {
    console.log('dragenter');
}); 
```

...如果我将文件拖到元素的任何子元素上`#dragtarget`，控制台将输出`dragenter`. 因此，如果我将此事件附加到`document`or `window`，则在将鼠标悬停在页面上的任何元素上时都会触发该事件。

`dragleave`除了离开子元素时，也会发生同样的事情。

## 问题

为什么会这样？是否可以将此事件**仅**附加到预期的元素？如果没有，有没有办法将事件与所有子元素分离？

## jsFiddle

这是一个修补的示例小提琴：http: [//jsfiddle.net/UnsungHero97/ePLV6/7/](http://jsfiddle.net/UnsungHero97/ePLV6/7/)

*   请注意，当您将文件拖到框上时，边框如何变为实线，但在将鼠标悬停在文本上时又变为虚线

*   无论我是否将鼠标悬停在框中的文本上，我都希望在将文件拖动到框上时边框变为实线

这是小提琴中的代码，以防万一：

**HTML**

```
<div id="dragtarget">
    <span>File over/out here</span>
    <br/><br/>
    <span>more text here</span>
</div> 
```

**JS**

```
// I expect only the #dragtarget element to fire the 'dragenter' and 'dragleave' events,
// not the child elements
$('#dragtarget').on('dragenter', function() {

    $(this).css({borderStyle: 'solid'});

    event.stopPropagation();
    event.preventDefault();
    return false;

}).on('dragleave', function() {

    $(this).css({borderStyle: 'dashed'});

    event.stopPropagation();
    event.preventDefault();
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:55:26.447

它没有。您可能会看到[事件冒泡](http://www.quirksmode.org/js/events_order.html#link3)。检查[`event.target`](https://developer.mozilla.org/en/DOM/event.target)以查看您正在处理的事件的来源。

# c++ - strtok 使用了错误的分隔符（空格和“，”）

> ID：10874880
> 
> 赞同：0
> 
> 时间：2012-06-03T23:46:04.523
> 
> 标签：c++, ifstream, strtok

有没有办法让 strtok() 不将空格解释为分隔符？我正在读取 .csv 文件，我的代码有：

```
ifstream inf("file.csv");
char *n, *a, *b;
char n1[80], a1[80], b1[80], temp[80];
inf >> temp;
n = strtok(temp, ",");
strcpy(n1, n);
a = strtok(NULL, ",");
strcpy(a1, a);
b = strtok(NULL, ",");
strcpy(b1, b);
cout << a1 << " " << b1 << endl; 
```

文件内容：

```
123,San Francisco, Los Angeles 
```

我认为 strtok 将空格解释为 '\n' 但我不知道如何忽略它。我尝试输入 inf.ignore(' ') 但不起作用并给了我一些随机值。但是，如果我将文件更改为 123,San_Francisco, Los_Angeles，那么程序就可以工作。我怎么能忽略空格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:47:39.530

不要责怪`strtok`，它`ifstream`会在找到*空白*字符时停止提取。`getline()`如果要阅读整行，则应使用其中一种变体。

# javascript - 使用正则表达式替换Javascript字符串

> ID：10874882
> 
> 赞同：1
> 
> 时间：2012-06-03T23:46:24.883
> 
> 标签：javascript, regex

给出以下字符串：

**http://foobar.com/trusted/123/views/AnalyticsInc**

..其中 123 将是 0 到 9999999 之间的任何数字，我需要能够用不同的值动态替换所述值

我认为解决此问题的最佳方法是使用某种正则表达式模式执行 string.replace，因为我们可以依靠“/trusted/”和“/views/”将始终围绕需要的值这一事实换掉了。

```
var foo='http://foobar.com/trusted/123/views/AnalyticsInc';
var newvalue=654321;
magic(); //magic happens here
console.log(foo); //returns http://foobar.com/trusted/654321/views/...etc 
```

但是我的正则表达式功夫太弱了，我无法击败一只小猫。有人可以帮帮我吗？或者如果有更好的方法，我很想学习它。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:49:07.220

它将替换`foo`字符串中从 0 到 9999999 的第一次出现的数字：

```
foo = foo.replace(/\d{1,7}/, newvalue); 
```

**演示：http:** [//jsfiddle.net/D4teZ/](http://jsfiddle.net/D4teZ/)

# scala - Scala：如何处理许多可以为 None 的参数

> ID：10874883
> 
> 赞同：3
> 
> 时间：2012-06-03T23:46:51.730
> 
> 标签：scala, option, optional-parameters

现在我有很多可以为空的参数，我想为整个表达式分配一个默认值。

现在我正在做类似的事情

```
var name: Option[String] = None
var surname: Option[String] = Some("Smith")

val fullName:String = {
  name.map { name => 
    surname.map { surname => 
      surname + ", " + name
    }.getOrElse("unknown")
  }.getOrElse("unknown")
} 
```

但这有点太冗长了。我想知道什么是更惯用和优雅的方式来处理它，理想情况下它会是这样的（当然是伪代码！）：

```
val fullName = (name + ", " + surname).getOrElse("unknown") 
```

或类似的东西...

（只是避免双重 .getOrElse 会很棒......）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-03T23:53:19.810

这个怎么样

```
scala> val fullName = (for(n <-name;s <-surname) yield n + s).getOrElse("unknown")  
fullName: String = unknown 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-04T00:12:30.017

您可能想了解一些有关*应用函子*的知识，因为可以以各种方式使用相同的模式。使用 scalaz，有应用程序构建器：

```
(name |@| surname)(_ + _) 
```

这是怎么回事：

```
(M[A] |@| M[B])(fabc) ~> M[C] //fabc is a function f: (A, B) => C 
```

也就是说，函数`f`被提升到了 applicative functor 的领域`M`。这特别有用，因为它适用于`Option`, `Validation`, `Promise`,`List`等等`Stream`。也就是说，就像您可能使用的表达式一样：

```
(name |@| surname)(_ + _) 
```

where`name`和`surname`are both `Option[String]`，您可以将它们切换为`ValidationNEL[Exception, String]`or`Promise[String]`并且代码仍然会做完全相同的事情（适用于正在使用的更高类型）。这是非常强大的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-03T23:54:54.847

我找到了这种方式：

```
val fullname = (name, surname) match {
  case (Some(x), Some(y)) => x + ", " + y
  case _ => "unknonw"
} 
```

但它仍然有点冗长

# android - 检测用户何时在 Android 设备上启动新应用程序

> ID：10874904
> 
> 赞同：2
> 
> 时间：2012-06-03T23:50:58.467
> 
> 标签：android

我一直在尝试检测用户何时在他/她的设备上启动应用程序。

所以我找到了这个解决方案：

[https://stackoverflow.com/a/7239840/833219](https://stackoverflow.com/a/7239840/833219)

我在线程中添加了这段代码。所以我的应用程序每 3 毫秒获取一次日志，但我找不到日志之间的区别，所以我无法检测到用户应用程序启动的代码是什么。

这是我添加此行时得到的日志示例：

```
String w = log.toString();
Log.i("LockService","w ="+w);

06-04 00:20:14.765: I/LockService(854): I/ActivityManager(  142): Start proc android.process.media for broadcast com.android.providers.media/.UsbReceiver: pid=375 uid=10013 gids={1015, 1023, 1024, 2001, 3003, 3007}
06-04 00:20:14.765: I/LockService(854): I/ActivityManager(  142): Start proc com.google.android.inputmethod.latin.dictionarypack for content provider com.google.android.inputmethod.latin.dictionarypack/.DictionaryProvider: pid=407 uid=10043 gids={3003, 1015}
06-04 00:20:14.765: I/LockService(854): I/ActivityManager(  142): Start proc android.process.acore for content provider com.android.providers.userdictionary/.UserDictionaryProvider: pid=421 uid=10002 gids={3003, 1015}
06-04 00:20:14.765: I/LockService(854): W/ActivityManager(  142): Unable to start service Intent { act=com.android.internal.telephony.IWapPushManager }: not found
06-04 00:20:14.765: I/LockService(854): W/ActivityManager(  142): Unable to start service Intent { act=com.android.ussd.IExtendedNetworkService }: not found
06-04 00:20:14.765: I/LockService(854): I/ActivityManager(  142): Start proc com.android.settings for broadcast com.android.settings/.widget.SettingsAppWidgetProvider: pid=476 uid=1000 gids={1015, 3002, 3001, 3003, 3007}
06-04 00:20:14.765: I/LockService(854): I/ActivityManager(  142): Start proc com.android.contacts for broadcast com.android.contacts/.calllog.CallLogReceiver: pid=505 uid=10002 gids={3003, 1015}
06-04 00:20:14.765: I/LockService(854): I/ActivityManager(  142): Start proc com.android.providers.calendar for broadcast com.android.providers.calendar/.CalendarReceiver: pid=545 uid=10007 gids={3003, 1015}
06-04 00:20:14.765: I/LockService(854): I/ActivityManager(  142): Config changed: {1.0 605mcc1mnc fr_FR layoutdir=0 sw320dp w320dp h508dp nrml long port finger -keyb/v/h -nav/h s.4}
06-04 00:20:14.765: I/LockService(854): I/ActivityManager(  142): Start proc com.google.android.deskclock for broadcast com.google.android.deskclock/com.android.deskclock.AlarmInitReceiver: pid=562 uid=10012 gids={}
06-04 00:20:14.765: I/LockService(854): I/ActivityManager(  142): Start proc com.google.android.email for broadcast com.google.android.email/com.android.email.service.EmailBroadcastReceiver: pid=577 uid=10014 gids={3003, 1015}
06-04 00:20:14.765: I/LockService(854): I/ActivityManager(  142): Start proc com.google.android.exchange for service com.google.android.exchange/com.android.exchange.ExchangeService: pid=596 uid=10025 gids={3003, 1015}
06-04 00:20:14.765: I/LockService(854): I/ActivityManager(  142): Start proc com.google.android.apps.genie.geniewidget for broadcast com.google.android.apps.genie.geniewidge
06-04 00:20:15.082: I/LockService(854): w =--------- beginning of /dev/log/system
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): Memory class: 48
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): Config changed: {1.0 0mcc0mnc fr_FR layoutdir=0 sw320dp w320dp h508dp nrml long port ?uimode ?night finger -keyb/v/h -nav/h s.2}
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): System now ready
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): Start proc com.android.systemui for service com.android.systemui/.SystemUIService: pid=210 uid=1000 gids={1015, 3002, 3001, 3003, 3007}
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): Start proc com.google.android.gsf.login for service com.google.android.gsf.login/com.google.android.gsf.loginservice.GoogleLoginService: pid=238 uid=10018 gids={3003, 1015, 1007, 2001, 3006}
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): Start proc com.google.process.gapps for content provider com.google.android.gsf/.gservices.GservicesProvider: pid=262 uid=10018 gids={3003, 1015, 1007, 2001, 3006}
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): Config changed: {1.0 0mcc0mnc fr_FR layoutdir=0 sw320dp w320dp h508dp nrml long port finger -keyb/v/h -nav/h s.3}
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): Start proc com.android.wallpaper for service com.android.wallpaper/.nexus.NexusWallpaper: pid=289 uid=10027 gids={1006}
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): Start proc com.google.android.inputmethod.latin for service com.google.android.inputmethod.latin/com.android.inputmethod.latin.LatinIME: pid=301 uid=10024 gids={}
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): Start proc com.android.phone for added application com.android.phone: pid=316 uid=1001 gids={3002, 3001, 3003, 1015}
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): Start proc com.android.nfc for added application com.android.nfc: pid=331 uid=1027 gids={3002, 3001}
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): START {act=android.intent.action.MAIN cat=[android.intent.category.HOME] flg=0x10000000 cmp=com.android.launcher/com.android.launcher2.Launcher} from pid 0
06-04 00:20:15.082: I/LockService(854): I/ActivityManager(  142): Start proc com.android.launcher for activity com.android.launcher/com.android.launcher2.Launcher: pid=354 uid=10026 gids={} 
```

使用此代码，我如何检测到用户启动了应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T02:15:24.247

阅读日志是一个可怕的想法，并且在系统的各个版本之间也存在问题。实际上，您可以[在此处](http://developer.android.com/reference/android/content/Intent.html#ACTION_PACKAGE_FIRST_LAUNCH)注册一个广播意图：`ACTION_PACKAGE_FIRST_LAUNCH`但是，请注意，这仅在 API 级别 12+ 中可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T11:49:10.043

`ActivityManager`您可以使用日志中的标签检测应用程序启动。

在日志中您可以找到有用的数据。您可以检测运行包。

例如 ：

```
06-06 16:09:06.007: I/ActivityManager(1663): Starting: Intent { act=android.intent.action.MAIN flg=0x10840000 cmp=com.android.phone/.InCallScreen } from pid -1 
```

它是`com.android.phone`包装并`InCallScreen`从第一页开始。

您可以检查包名称并检测目标应用程序何时启动。

# couchdb - couchdb 不会在服务器重新启动时启动

> ID：10874906
> 
> 赞同：1
> 
> 时间：2012-06-03T23:51:14.530
> 
> 标签：couchdb, ubuntu-10.04, init.d

我使用的是 CouchDB 附带的标准 init.d 脚本。我在 Ubuntu 上使用它。

在服务器重新启动时，这将打印在本地控制台上：

```
 * Starting database server couchdb                                    [ OK ] 
```

因此，假设 CouchDB 已启动，但并未启动。CouchDB 未启动。

我必须登录到服务器并使用 启动服务`service couchdb start`，然后 CouchDB 才能正确启动。

关于如何调试为什么 CouchDB 没有在重新启动时启动的任何想法？已经完成了`update-rc.d`命令。

# javascript - 当任何字段有数据并且单击选项卡时，slickgrid 正在添加新行

> ID：10874907
> 
> 赞同：2
> 
> 时间：2012-06-03T23:51:16.830
> 
> 标签：javascript, html, jquery-ui, slickgrid, jquery-1.7

我有一个奇怪的问题，我找不到在 SO 或其他方面的参考。除了两个关键问题和我想做的两件事外，我的网格似乎在所有方面都运行良好。回复时，我不希望所有问题都能得到回复，即使您有其中一个问题的信息，也请将其作为答案发布。有关我的问题的视觉效果，请参阅下面的图片。

第一个问题：
每当将数据放入空行的任何字段并单击选项卡时，都会生成一个新行。如果所选单元格位于该行的最后一列，我只想要这种行为

第二个问题：
每当添加一个超出我定义的 div 边缘的新行并且出现垂直滚动条时，就会添加一个额外的不可选择的列，它会在我的网格底部创建一个水平滚动条。该栏隐藏了底行的一部分。如何防止出现此水平条。

第三个请求：当网格创建新行时，如何验证以确保当前最后一行中的每个单元格中都有数据，然后才允许选项卡效果添加新行。

最终请求：单击一个单元格并获得焦点后，除非选择另一个单元格，否则它不会失去焦点。如果用户单击网格之外的任何内容，我需要失去焦点。

***即使没有填充所有单元格，也显示添加新行，并且选择器位于第一个单元格中*** ![即使其他列为空并且选择了行中的第一个单元格（应该是最后一个单元格），也会添加新行](../Images/2821410e973e99e38d2c1c98bae2fd8b.png)

***显示底部滚动条提出的问题*** ![底部滚动条出现时出现的问题](../Images/5780d472ede9830d87916936280aa913.png)

***HTML***

```
<link type="text/css" rel="stylesheet" href="css/slickGrid/slick.grid.css" />

<link type="text/css" rel="stylesheet" href="css/cupertino/jquery-ui-1.8.20.custom.css" />
<link type="text/css" rel="stylesheet" href="css/slickGrid/slick.grid.darren1.css" />

    <form id="myGridForm" action="" method="post">
        <div style="position:relative; overflow:visible; margin:25px 0 0 0;">
            <div id="loader" style="position:absolute; z-index:997;top: 62px; left:200px;"><img src="images/loading.gif" border="0" /></div>
            <div id="dateInput" style="position:relative;z-index:990;visibility:hidden;">
                 <!-- jQuery DatePicker shows here -->
                 <p><label for="datepicker">Click to change date:</label><input type="text" id="datepicker" name='datepicker'size="30" readonly="readonly"/></p> 
            </div>
            <div id="myGrid" style="height: 177px; width: 902px; float: left; overflow: hidden; position: relative; visibility: hidden;" >
                <!-- #myGrid.slickGrid goes here -->
            </div>

        </div>

        <div class="options-panel" style="  -moz-border-radius: 6px;  -webkit-border-radius: 6px;  border: 1px solid silver;  background: #f0f0f0;  padding: 4px; margin: 0 0 220px 0;  width: 880px;position: absolute;  top: 315px;  left: 280px;">
            <h2>Instructions:</h2>
            <ul>
                <li>Select the date by clicking the date image above the table</li>
                <li>Enter your event data (you can enter multiple events for that date)</li>
                <li>To add another event, hit your <em>TAB</em> key and a new row will be created</li>
                <li>When you're all done for this date, click the <em>Commit Changes</em> button to have your events saved to the site</li>
            </ul>
            <input type="hidden" name="p" id="p" value="<?=$_POST['p']?>" />
            <input type="hidden" name="k" id="k" value="<?=$_POST['k']?>" />
            <input type="hidden" name="i" id="i" value="<?=$_POST['i']?>" />
            <input type="hidden" name="d" id="d" value="<?=$_POST['d']?>" />
            <input type="hidden" name="gridData" id="gridData" />
           <div id="submitButton" style="visibility:hidden;"> <button type="submit">Commit Changes</button></div>    
        </div>
    </form>    
<script>
    console.log('json2 Loadstatus: '+json2Loaded);
</script>  

<script  type="text/javascript" language="javascript" src="js/slickGrid/lib/firebugx.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.20.custom.min.js.php"></script>
<script type="text/javascript" src="js/json2.js.php"></script>
<script src="js/slickGrid/plugins/slick.cellrangedecorator.js"></script>
<script src="js/slickGrid/plugins/slick.cellrangeselector.js"></script>
<script src="js/slickGrid/plugins/slick.cellselectionmodel.js"></script>
<script src="js/slickGrid/slick.formatters.js"></script>
<script src="js/slickGrid/slick.editors.js"></script>
<script src="js/slickGrid/jquery.event.drag-2.0.min.js"></script>
<script src="js/slickGrid/slick.core.js"></script>
<script src="js/slickGrid/slick.grid.js"></script>

<script>
    function requiredFieldValidator(value) {
        if (value == null || value == undefined || !value.length) {
          return {valid: false, msg: "This is a required field"};
        } else {
          return {valid: true, msg: null};
        }
      }

    var columns = [
    { id: "VisitDate", name: "VisitDate", field: "VisitDate", width: 120, cssClass: "cell-title", editor: Slick.Editors.Text },
    { id: "VisitTime", name: "VisitTime", field: "VisitTime", width: 100, editor: Slick.Editors.Text },
    { id: "PrimaryComplaint", name: "PrimaryComplaint", field: "PrimaryComplaint", width: 100, cssClass: "cell-right", editor: Slick.Editors.Text },
    ];

    var data = [
        {
        "VisitDate": "11/30/2009",
        "VisitTime": "0117",
        "PrimaryComplaint": "General malaise "
        },
        {
        "VisitDate": "02/08/2010",
        "VisitTime": "0930",
        "PrimaryComplaint": "General malaise "
        }
    ];

    var options = {
    editable: true,
    enableAddRow: true,
    enableCellNavigation: true,
    asyncEditorLoading: false,
    forceFitColumns: true
    };

    var grid = new Slick.Grid("#myGrid", data, columns, options); 
    grid.onAddNewRow.subscribe(function (e, args) {
        var item = args.item;
        grid.invalidateRow(data.length);
        data.push(item);
        grid.updateRowCount();
        grid.render();
    });     
    $('#loader').hide();
    $('#dateInput').css({opacity: 0.0, visibility: "visible"}).animate({opacity: 1.0},"slow");
    $('#myGrid').css({opacity: 0.0, visibility: "visible"}).animate({opacity: 1.0},"slow");
    $('#submitButton').css({opacity: 0.0, visibility: "visible"}).animate({opacity: 1.0},"slow");
    $.getScript("js/jquery.calendarPicker.js"); 
    $.getScript("js/jquery.json-2.3.min.js");   
</script>

<script>
    console.log('json2 Loadstatus: '+json2Loaded);
</script>

<? //Instantiate datepicker jQueryUI widget ?>
<script>
$(document).ready(function(){

    $(function() {

            $( "#datepicker" ).datepicker({ numberOfMonths: [1, 3] });

            $( "#datepicker" ).datepicker( "option", "showAnim", "clip");
            $( ".selector" ).datepicker( "option", "showOn", "both" );

    }); // end function()
});  // end doc.ready

$('#myGridForm').submit(function() {
    console.log ( ' myGrid data1: '+ $('grid').data() );
    console.log ( ' myGrid data2: '+ $('#myGrid').data() );
    var datum = $('#myGrid').data();
    console.log ( ' myGrid data3: '+  $('datum').serialize() );
    console.log ( ' myGrid data4: '+  JSON.stringify(data) );
    $("input[name='gridData']").val(JSON.stringify(data));

  // stops submit /ie. return false;
});
</script> 
```

# php - SQL Server varbinary，在 PHP 中显示图像

> ID：10874914
> 
> 赞同：1
> 
> 时间：2012-06-03T23:52:54.200
> 
> 标签：php, sql, sql-server

我有一个 SQL 服务器数据库，它有一个 varbinary(max) 列，其中包含位图图像的数据。我需要将此数据显示为 PHP 页面上的图像。

知道我会怎么做吗？我没有在互联网上找到很多关于如何做到这一点的信息。

当我通过管理工作室查看数据时，它看起来像`0x42DBE3400000...,` ，而如果我通过 ODBC 检索它并将其回显到屏幕上，它看起来像`Qk2+NAAAAAAAAD4AAAAoAAAArgEAAPAAAAAB`.

我以前对二进制数据的工作不多，所以我不知道从这里做什么！任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T23:57:15.493

为了使页面看起来不像乱码，您需要输出一个`Content-Type`标题，以便浏览器识别该页面是图像而不是文本/html 页面。

```
<?php
header('Content-Type: image/x-bmp');

echo '{display the image's binary content here}';
?> 
```

# c - C 编程：使用 strcpy 替换内部字符串？

> ID：10874915
> 
> 赞同：2
> 
> 时间：2012-06-03T23:53:09.057
> 
> 标签：c, string, strcpy

我已使用以下代码将 HTML 文件复制到数组中：

```
fseek(board, 0, SEEK_END);
long int size = ftell(board);
rewind(board);
char *sourcecode = calloc(size+1, sizeof(char));
fread(sourcecode, 1, size, board); 
```

现在我的目标是用已经定义的字符字符串'king'替换数组中的某个注释。例如

<html代码><!comment><更多html代码>

到

<html代码>王<更多html代码>

我使用以下代码：

```
 find_pointer = strstr(sourcecode, text2find);
    strcpy(find_pointer, king);
    printf("%s", sourcecode); 
```

其中 text2find = "<!comment>";

但是，当我打印时，很明显，我在“国王”之后的所有字符都已被删除……好像它自动添加了一个终止字符。我该如何解决这个问题，以便 <更多 html 代码> 保持原位？

编辑::::: 我使用了 strncpy 并设置了许多字符，以便不添加终止字符。这是最好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T23:56:22.100

你基本上不能这样做，除非你要替换的东西是完全相同的大小。在这种情况下，您可以使用`memcpy`或`strncpy`。

如果尺寸不同，您可以尝试以下方式：

```
char *buffer = malloc(size); // size should be big enough to store the whole final html code
find_pointer = strstr(sourcecode, text2find);
len = find_pointer - sourcecode;
memcpy (buffer, sourcecode, len);
memcpy (buffer + len, "king", 4);
memcpy (buffer + len + 4, find_pointer + 4, strlen(sourcecode) - len - strlen(text2find)); 
free(sourcecode);
sourcecode = buffer; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T23:55:10.040

好吧，`strcpy`添加一个 0 终止符。因此，尽管字符串的其余部分仍然存在，但标准字符串处理函数不再看到它，因为它们在 0 终止符处停止。您可以使用空格手动覆盖它，也可以`memcpy`使用`strcpy`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-04T00:07:42.577

替换 C 字符串中的字符很痛苦，因为与 C++ 相比，您在非常低的级别执行操作。你真的需要为它制定一个算法！

首先，注意原地替换并不总是可能的：如果要替换的子字符串比替换的要短，则需要分配更多内存。无论哪种方式，都更容易为结果分配内存，因此您可以按以下方式进行：

*   查找替换*后*字符串的长度。为此，您需要找到要替换的评论的开头和结尾，然后进行数学计算。
*   接下来，为结果分配一块新的内存，并将源内存存储到替换点。
*   现在复制替换字符串，最后将源代码的结尾部分复制到结果中
*   最后，释放源字符串的缓冲区，并返回结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-04T00:00:46.277

首先，您应该使用`strncpy`（或者更好，`strlcpy`如果可用），因为它实际上执行边界检查（即，它只复制指定的、提供的字符数）。否则，您最终可能会尝试将内存复制到目标字符串的末尾，从而导致未定义和潜在的破坏性行为。其次，即使您要使用类似`strncpy`或`memcpy`避免复制终止空字符的函数，您的目标字符串也不会正确格式化，因为您尝试覆盖的字符串与您尝试覆盖的字符串的长度不同复制。

# ruby-on-rails - Rails DB 没有播种。我怀疑我的语法

> ID：10874921
> 
> 赞同：0
> 
> 时间：2012-06-03T23:54:20.753
> 
> 标签：ruby-on-rails, asp.net-mvc

我正在尝试使用一些虚假数据来植入我的数据库，但它没有按计划工作。该应用程序创建播放列表。我想我已经正确建模了，但是当我尝试为数据库播种时，我收到了这个错误：

```
rake aborted!
uninitialized constant Playlist::PlaylistSong 
```

当我运行跟踪时，我发现它不喜欢下面的代码（特别是倒数第二行）：

```
my_playlist = Playlist.create!(:name => "my_playlist")
10.times do |n|
  my_playlist.songs.create!(:name => "song #{n+1}")
end 
```

我的模型设置为通过一个名为“playlist_songs”的表，播放列表包含许多歌曲，并且歌曲通过同一个表包含许多播放列表。

这是我的模型。

```
class Playlist < ActiveRecord::Base
  attr_accessible :name

  has_many :playlist_songs
  has_many :songs, :through => :playlist_songs
 end

class Song < ActiveRecord::Base
  attr_accessible :name

  has_many :playlist_songs
  has_many :playlists, :through => :playlist_songs
end

class PlaylistSongs < ActiveRecord::Base
  belongs_to :song
  belongs_to :playlist
end 
```

我的理论是代码“my_playlist.songs”实际上是一个集合，这就是创建方法失败的原因。但我不确定。我对吗？如果是这样，我应该使用什么语法？

本

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T23:57:34.450

您的型号名称不正确。`PlaylistSongs`应该`PlaylistSong`

# asp.net-mvc-3 - 加速大型 Linq 到实体调用 MVC3

> ID：10874929
> 
> 赞同：1
> 
> 时间：2012-06-03T23:55:24.440
> 
> 标签：asp.net-mvc-3, entity-framework, c#-4.0, linq-to-entities

下面是我正在使用的代码，它从中提取的数据库表中有大约 92000 条记录。它现在拉动的方式是拉动所有 92000 条记录，然后进行过滤。我要做的是过滤从数据库中的初始拉取，以便加载页面不需要大约 40 秒。这是我仍然陌生的东西，所以我不知道如何做到这一点并使其符合我的观点

```
public ViewResult Makes()
{
    var items = (from item in DBCacheHelper.recallslist
                 orderby item.MFGTXT ascending
                 select item.ToDomainRecall()).GroupBy(item => item.MFGTXT).Select(grp => grp.First());

    return View(items);
}

public static IEnumerable<Recall> recallslist
{
    get
    {
        if (c["GetAllRecalls"] == null)
        {
            c.Insert("GetAllRecalls", GetAllRecalls());
            return (IEnumerable<Recall>)c["GetAllRecalls"];
        }
        else
        {
            return (IEnumerable<Recall>)c["GetAllRecalls"];
        }
    }
}

public static IEnumerable<Recall> GetAllRecalls()
{
    using (DealerContext context = new DealerContext())
    {
        var items = from item in context.recalls.ToList<Recall>()
                     select item.ToDomainRecall();
        return items.ToList<Recall>();
    }
}

SELECT 
[Extent1].[RecallsId] AS [RecallsId], 
[Extent1].[RECORD_ID] AS [RECORD_ID], 
[Extent1].[CAMPNO] AS [CAMPNO], 
[Extent1].[MAKETXT] AS [MAKETXT], 
[Extent1].[MODELTXT] AS [MODELTXT], 
[Extent1].[YEARTXT] AS [YEARTXT], 
[Extent1].[MFGCAMPNO] AS [MFGCAMPNO], 
[Extent1].[COMPNAME] AS [COMPNAME], 
[Extent1].[MFGNAME] AS [MFGNAME], 
[Extent1].[BGMAN] AS [BGMAN], 
[Extent1].[ENDMAN] AS [ENDMAN], 
[Extent1].[RCLTYPECD] AS [RCLTYPECD], 
[Extent1].[POTAFF] AS [POTAFF], 
[Extent1].[ODATE] AS [ODATE], 
[Extent1].[INFLUENCED_BY] AS [INFLUENCED_BY], 
[Extent1].[MFGTXT] AS [MFGTXT], 
[Extent1].[RCDATE] AS [RCDATE], 
[Extent1].[DATEA] AS [DATEA], 
[Extent1].[RPNO] AS [RPNO], 
[Extent1].[FMVSS] AS [FMVSS], 
[Extent1].[DESC_DEFECT] AS [DESC_DEFECT], 
[Extent1].[CONEQUENCE_DEFECT] AS [CONEQUENCE_DEFECT], 
[Extent1].[CORRECTIVE_ACTION] AS [CORRECTIVE_ACTION], 
[Extent1].[NOTES] AS [NOTES], 
[Extent1].[RCL_CMPT_ID] AS [RCL_CMPT_ID]
FROM [dbo].[Recalls] AS [Extent1] 
```

更新：

最终我只想从召回表中提取记录，其中 MFGTXT 等于 AutoMake 表中的 MakeName

```
public class AutoMake
{
    [Key]
    public int MakeID { get; set; }
    public string MakeName { get; set; }

public AutoMake ToDomainAutoMakes()
{
    return new AutoMake
    {
        MakeID = this.MakeID,
        MakeName = this.MakeName
    };
} 
```

}

```
public class Recall
{
    [Key]
    public int RecallsId { get; set; }
    public string RECORD_ID { get; set; }
    public string CAMPNO { get; set; }
    public string MAKETXT { get; set; }
    public string MODELTXT { get; set; }
    public string YEARTXT { get; set; }
    public string MFGCAMPNO { get; set; }
    public string COMPNAME { get; set; }
    public string MFGNAME { get; set; }
    public string BGMAN { get; set; }
    public string ENDMAN { get; set; }
    public string RCLTYPECD { get; set; }
    public string POTAFF { get; set; }
    public string ODATE { get; set; }
    public string INFLUENCED_BY { get; set; }
    public string MFGTXT { get; set; }
    public string RCDATE { get; set; }
    public string DATEA { get; set; }
    public string RPNO { get; set; }
    public string FMVSS { get; set; }
    public string DESC_DEFECT { get; set; }
    public string CONEQUENCE_DEFECT { get; set; }
    public string CORRECTIVE_ACTION { get; set; }
    public string NOTES { get; set; }
    public string RCL_CMPT_ID { get; set; }

    public Recall ToDomainRecall()
    {
        return new Recall
        {
            RECORD_ID = this.RECORD_ID,
            CAMPNO = this.CAMPNO,
            MAKETXT = this.MAKETXT,
            MODELTXT = this.MODELTXT,
            YEARTXT = this.YEARTXT,
            MFGCAMPNO = this.MFGCAMPNO,
            COMPNAME = this.COMPNAME,
            MFGNAME = this.MFGNAME,
            BGMAN = this.BGMAN,
            ENDMAN = this.ENDMAN,
            RCLTYPECD = this.RCLTYPECD,
            POTAFF = this.POTAFF,
            ODATE = this.ODATE,
            INFLUENCED_BY = this.INFLUENCED_BY,
            MFGTXT = this.MFGTXT,
            RCDATE = this.RCDATE,
            DATEA = this.DATEA,
            RPNO = this.RPNO,
            FMVSS = this.FMVSS,
            DESC_DEFECT = this.DESC_DEFECT,
            CONEQUENCE_DEFECT = this.CONEQUENCE_DEFECT,
            CORRECTIVE_ACTION = this.CORRECTIVE_ACTION,
            NOTES = this.NOTES,
            RCL_CMPT_ID = this.RCL_CMPT_ID

        };
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T16:03:55.573

看起来您的 DBaccess 是在对`DBCacheHelper.recallslist`.

您需要编辑从/在此函数中运行的 sql。

正如 Eranga 指出的那样，您没有展示如何将大量记录过滤为较少数量的记录。我假设您一次想要 20 个或 100 个？如果是这样，请在此处查看接受的答案：

[实现分页的有效方法](https://stackoverflow.com/questions/548475/efficient-way-to-implement-paging)

具体来说，这部分展示了如何只检索行 x 到 y（其中 x = @p0 + 1 AND y = @p0 + @p1）：

```
SELECT [t1].[CodCity], 
    [t1].[CodCountry], 
    [t1].[CodRegion], 
    [t1].[Name],  
    [t1].[Code]
FROM (
    SELECT ROW_NUMBER() OVER (
        ORDER BY [t0].[CodCity], 
        [t0].[CodCountry], 
        [t0].[CodRegion], 
        [t0].[Name],
        [t0].[Code]) AS [ROW_NUMBER], 
        [t0].[CodCity], 
        [t0].[CodCountry], 
        [t0].[CodRegion], 
        [t0].[Name],
        [t0].[Code]
    FROM [dbo].[MtCity] AS [t0]
    ) AS [t1]
WHERE [t1].[ROW_NUMBER] BETWEEN @p0 + 1 AND @p0 + @p1
ORDER BY [t1].[ROW_NUMBER] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T18:22:48.657

如果要在存储库方法之外添加服务器端过滤，则需要将类型返回为 IQueryable 而不是 IEnumerable，并且不要调用 .ToList、.AsEnumerable 或任何其他会导致调用 .GetEnumerator 的方法。此外，你的演员 `(IEnumerable)c["GetAllRecalls"];' 强制 LINQ to Objects 用于后续请求，而不是保留表达式树并使用实体框架。话虽如此，您可能还需要将您对 ToDomainRecall 方法的调用移至应用附加过滤器之后，因为该过滤器无法转换为您的数据库。以下是您需要进行的一些更改：

```
public ViewResult Makes()
{
    var items = (from item in DBCacheHelper.recallslist
                 orderby item.MFGTXT ascending
                 select item.ToDomainRecall()).GroupBy(item => item.MFGTXT).Select(grp => grp.First());

    return View(items);
}

public static IQueryable<Recall> recallslist
{
    get
    {  
        if (c["GetAllRecalls"] == null)
        {
            c.Insert("GetAllRecalls", GetAllRecalls(context));
        }
        return c["GetAllRecalls"];

    }
}

public static IQueryable<Recall> GetAllRecalls(DealerContext context)
{
        var items = context.recalls;
        return items;
} 
```

# python - Python套接字超时和刷新

> ID：10874932
> 
> 赞同：0
> 
> 时间：2012-06-03T23:55:43.363
> 
> 标签：python, ruby, sockets, tcp

我正在尝试将其从 Ruby 转换为 Python。红宝石代码：

```
def read_byte
    begin
        Timeout.timeout(0.5) do
            b = socket.read 1
        end
    rescue Timeout::Error => e
        socket.write("\n")
        socket.flush
        retry
    end
end

def socket
    @socket ||= TCPSocket.open @host, @port
rescue SocketError
    # TODO: raise a specific error
    raise "Unable to open connection to #{@host} with given parameters"
end 
```

我的平均问题是

> socket.flush

我找不到冲洗的方法。我还有什么其他方法可以做到这一点？我写了这个。Python代码：

```
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((self.host, self.port))
s.settimeout(0.5)
while True:
    try:
        print s.recv(1)
    except socket.timeout:
        s.sendall("\n") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:02:57.273

我怀疑刷新套接字会有所不同，但这是一种通过首先创建类似文件的对象来“刷新”套接字的方法。

```
def flush_socket(s):
    f = s.makefile()
    f.flush()

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((self.host, self.port))
s.settimeout(0.5)
while True:
    try:
        print s.recv(1)
    except socket.timeout:
        s.sendall("\n")
        flush_socket(s) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-27T09:42:15.567

> 流有点挂在我的代码上。

当然是这样，因为它是一个无限循环，除非`socket.timeout`发生其他异常。

> 也许这是 ruby​​ 代码的另一部分

它必须是... 检查`read_byte`调用的 Ruby 循环并将其与您的 Python 进行比较`while True`。

# php - 如何关闭 Laravel 的 PHPUnit 任务中的颜色？

> ID：10874937
> 
> 赞同：8
> 
> 时间：2012-06-03T23:56:45.327
> 
> 标签：php, laravel, phpunit, ansi-colors

我在 Windows 下进行测试，命令提示符对默认显示的 ANSI 颜色代码效果不佳。使用 Laravel 时如何关闭彩色显示？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-03T23:56:45.437

文件**\laravel\cli\tasks\test\stub.xml**用于生成用于测试的 PhpUnit 配置文件。（每次运行 artisan 测试任务时都会生成并删除一个新的配置文件。）要关闭颜色，请将 stub.xml 的第一行从更改`<phpunit colors="true"`为`<phpunit colors="false"`（对于 Laravel 3）

**更新：**对于 Laravel 4，该文件`phpunit.xml`位于根文件夹中。变化还是要设定的`colors="false"`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-09T09:35:01.507

您可以在 Windows 命令提示符中添加颜色。它非常适合发现错误和成功。我跟着这个[http://softkube.com/blog/ansi-command-line-colors-under-windows/](http://softkube.com/blog/ansi-command-line-colors-under-windows/)

# android - Proguard 返回错误代码 1。（文件名、目录名或卷标语法不正确）

> ID：10874941
> 
> 赞同：1
> 
> 时间：2012-06-03T23:57:22.613
> 
> 标签：android, proguard

我刚刚升级到最新的 ADT (19)，我再次收到 ProGuard 的投诉，但这次比平时更糟。我已经阅读了数十个有关此错误的问题，但这次没有一个答案有效。

当我尝试导出已签名的 APK 时，控制台显示：

> Proguard 返回错误代码 1。请参阅控制台
> 
> 错误：@C:\Users\Barry\AppData\Local\Temp\android_8523956309172274256.pro（文件名、目录名或卷标语法不正确）

我确认该文件存在（[我在其他地方读到](https://stackoverflow.com/questions/10556706/android-proguard-syntax-error)@ 是错误消息的一部分，而不是文件名的一部分）。我认为这个错误是在抱怨文件路径，而不是文件内容，但以防万一我包含了下面的内容。

**编辑**：我在 ProGuard 文档中确认 @ 应该在那里。它是命令行语法的一部分。

*   我正在使用最新的 Proguard (4.8)
*   我正在使用最新的 ADT Eclipse 插件 (18.0.0)
*   我正在使用最新的 Android SDK 工具 (19) 和最新的 Android SDK 平台工具 (11)
*   ProGuard 没有报告任何缺失的类（或其他任何东西）
*   我已经清理并重建了我的项目
*   我使用的是 Windows 7 64 位

过去，我在升级 ADT 后修复了 ProGuard 错误，[方法是按照该线程的建议](https://stackoverflow.com/questions/6683955/conversion-to-dalvik-format-failed-with-error-1-solution)更改 proguard.bat 中的“%@”参数。上面的错误对我来说是全新的。[我在这个帖子中](https://stackoverflow.com/questions/6683955/conversion-to-dalvik-format-failed-with-error-1-solution)只发现了一份其他报告，但发帖人通过升级到 ProGuard 4.8 修复了它。我没有这样的运气。:(

预先感谢...

**编辑**：当我使用上述输入 jars 手动运行 ProGuard 时，它报告由于缺少 jars 而丢失了类（尽管我从未在控制台中看到过这个）。问题是我仍然不知道为什么 ProGuard 或 ADT 会生成缺少 jar 的 .pro 文件，因为它们位于我的构建路径上并与以前的 ADT 一起使用。

上述文件内容：

> C:\Users\Barry\dev\workspace\MY-PROJECT\proguard.cfg
> 
> -injars C:\Users\Barry\AppData\Local\Temp\android_824795077905177388.jar;C:\Users\Barry\dev\workspace\KeyboardLib\bin\keyboardlib.jar;C:\Users\Barry\dev\android-sdk \tools\support\annotations.jar
> 
> -outjars C:\Users\Barry\AppData\Local\Temp\android_2943979964980515538.jar
> 
> -libraryjars C:\Users\Barry\dev\android-sdk\platforms\android-10\android.jar
> 
> -dump C:\Users\Barry\dev\workspace\MY-PROJECT\proguard\dump.txt
> 
> -printseeds C:\Users\Barry\dev\workspace\MY-PROJECT\proguard\seeds.txt
> 
> -printusage C:\Users\Barry\dev\workspace\MY-PROJECT\proguard\usage.txt
> 
> -printmapping C:\Users\Barry\dev\workspace\MY-PROJECT\proguard\mapping.txt

上面所有的 jar 文件都存在并包含 .class 文件，除了 outjar 文件，它存在但为 0 字节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T06:14:32.577

我和你有完全相同的问题。最终对我有用的是将与 android SDK 一起打包的 proguard 版本升级到 4.8。出于某种原因，proguard 4.7 是问题的根源。

将 \android-sdk\tools\proguard\lib\ 和 \android-sdk\tools\proguard\bin\ 文件夹的内容替换为从 proguard 站点下载的文件。

我正在使用 ADT 20.0.3

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T14:45:25.310

Windows 7，Eclipse Juno，使用 ADT 22.2.1。

最初的 Proguard 是 4.6。我不得不升级到 4.10 来解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T08:04:35.003

好的，我自己解决了。不幸的是，解决方案回滚到 ADT 18 和 ProGuard 4.7。奇怪的是，即使 ProGuard 4.8 在 ADT 18 中也出现了同样的错误。我很确定这是 ADT 中的一个错误。也许它与仍处于版本 18 的 ADT Eclipse 插件不兼容。奇怪的是，即使 SDK 下载仍与 ADT 18 捆绑在一起，ADT 19 仍可通过 SDK 管理器获得。

我的建议是在从 Google 升级任何内容之前备份所有内容，因为我们都是他们的 beta 测试人员。

# iphone - AudioQueue 录制音频示例

> ID：10874943
> 
> 赞同：1
> 
> 时间：2012-06-03T23:57:58.697
> 
> 标签：iphone, objective-c, ios, audiotoolbox, audioqueue

我目前正在构建一个应用程序，从我的 iPhone 的麦克风中读取音频，然后进行一些处理和视觉效果。当然，我首先从音频开始，但遇到了一个小问题。

我将我的采样率定义为 44100 Hz，并将我的缓冲区定义为容纳 4096 个样本。确实如此。但是，当我打印出这些数据时，将其复制到 MATLAB 中以再次检查准确性，我必须使用的采样率是我的 iPhone 定义的速率的一半，即 22050 Hz，以确保它是正确的。

我认为它与以下代码以及它如何为每个数据包放置 2 个字节有关，当我循环通过缓冲区时，缓冲区吐出整个数据包，我的代码假定它是一个数字。所以我想知道的是如何拆分这些数据包并将它们作为单独的数字读取。

```
- (void)setupAudioFormat {
    memset(&dataFormat, 0, sizeof(dataFormat));
    dataFormat.mSampleRate = kSampleRate;
    dataFormat.mFormatID = kAudioFormatLinearPCM;
    dataFormat.mFramesPerPacket = 1;
    dataFormat.mChannelsPerFrame = 1;
    //  dataFormat.mBytesPerFrame = 2;
    //  dataFormat.mBytesPerPacket = 2;
    dataFormat.mBitsPerChannel = 16;
    dataFormat.mReserved = 0;

    dataFormat.mBytesPerPacket = dataFormat.mBytesPerFrame = (dataFormat.mBitsPerChannel / 8) * dataFormat.mChannelsPerFrame;
    dataFormat.mFormatFlags = 
    kLinearPCMFormatFlagIsSignedInteger |
    kLinearPCMFormatFlagIsPacked;
} 
```

如果我描述的内容不清楚，请告诉我。谢谢！

**编辑**

添加我用来打印数据的代码

```
float *audioFloat =  (float *)malloc(numBytes * sizeof(float));
int *temp = (int*)inBuffer->mAudioData;
int i;
float power = pow(2, 31);
for (i = 0;i<numBytes;i++) {
    audioFloat[i] = temp[i]/power;
    printf("%f ",audioFloat[i]);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T01:52:02.120

我发现我正在做的事情有问题。这是交流指针的问题，因为我以前从未真正用 C 编程过，我当然弄错了。

您不能直接将 inBuffer->mAudioData 转换为 int 数组。所以我只是做了以下

```
SInt16 *buffer = malloc(sizeof(SInt16)*kBufferByteSize);
buffer = inBuffer->mAudioData; 
```

这很好，现在我的数据长度正确并且数据正确表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-22T13:54:53.713

我看到了你的回答，还有一个潜在的问题，它给出了错误的样本数据字节，这是因为字节交换的字节序问题。

-(void)feedSamplesToEngine:(UInt32)audioDataBytesCapacity audioData:(void *)audioData { int sampleCount = audioDataBytesCapacity / sizeof(SAMPLE_TYPE);

```
SAMPLE_TYPE *samples = (SAMPLE_TYPE*)audioData;
//SAMPLE_TYPE *sample_le = (SAMPLE_TYPE *)malloc(sizeof(SAMPLE_TYPE)*sampleCount );//for swapping endians

std::string shorts;
double power = pow(2,10);
for(int i = 0; i < sampleCount; i++)
{
    SAMPLE_TYPE sample_le =  (0xff00 & (samples[i] << 8)) | (0x00ff & (samples[i] >> 8)) ; //Endianess issue
    char dataInterim[30];
    sprintf(dataInterim,"%f ", sample_le/power); // normalize it.
    shorts.append(dataInterim);
} 
```

# python - ImportError：无法导入名称规范化

> ID：10874945
> 
> 赞同：5
> 
> 时间：2012-06-03T23:58:31.000
> 
> 标签：python, django, locale, gettext

我尝试使用 djangos i18n，因此必须安装 gettext。现在，每当我尝试启动我的应用程序时，都会遇到这个尴尬的错误：

```
Traceback (most recent call last):
  File "/var/www/mydjangoproject/manage.py", line 8, in <module>
    from django.core.management import execute_from_command_line
  File "/usr/local/lib/python2.7/dist-packages/Django-1.4-py2.7.egg/django/core/management/__init__.py", line 4, in <module>
    from optparse import OptionParser, NO_DEFAULT
  File "/usr/lib/python2.7/optparse.py", line 418, in <module>
    _builtin_cvt = { "int" : (_parse_int, _("integer")),
  File "/usr/lib/python2.7/gettext.py", line 581, in gettext
    return dgettext(_current_domain, message)
  File "/usr/lib/python2.7/gettext.py", line 545, in dgettext
    codeset=_localecodesets.get(domain))
  File "/usr/lib/python2.7/gettext.py", line 480, in translation
    mofiles = find(domain, localedir, languages, all=1)
  File "/usr/lib/python2.7/gettext.py", line 437, in find
    for nelang in _expand_lang(lang):
  File "/usr/lib/python2.7/gettext.py", line 131, in _expand_lang
    from locale import normalize

  ImportError: cannot import name normalize 
```

库 locale.py 存在，我可以导入它。Django 1.4 在 Python 2.7.2+ 下运行。有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-04T00:38:29.563

我猜你的项目中有一个文件夹区域设置，其中有一个 __init__.py 文件。删除这个文件（你不需要它来翻译工作），你应该很高兴。

# java - PullToRefresh 与自定义单元格 listView Android

> ID：10874946
> 
> 赞同：2
> 
> 时间：2012-06-03T23:58:51.203
> 
> 标签：java, android, listview

我使用了这个库：[https ://github.com/johannilsson/android-pulltorefresh](https://github.com/johannilsson/android-pulltorefresh)

效果很好，但在 ListView 中很简单（简单就是我在单元格 android 模式中所说的）。

我将 Adpter 放入我的自定义 ListView 到带有图像、标题和描述的单元格中。

我的课上有适配器：

```
public class extends Main_podcast ListActivity implements {OnItemClickListener

private Bitmap pathImgSmal;
    / ** Called When the activity is first created. * /
    @ Override
    public void onCreate (Bundle savedInstanceState) {
        super.onCreate (savedInstanceState);

        Mybundle bundle = new Bundle ();
    mybundle.putString ("podcastnumber", "0");

        / / Check for connection and starts downloading the XML
    Connected conected Boolean = (this);
        if (conected == true) {
    DoInBackground new (). execute ();
    Else {}
    new AlertDialog.Builder (Main_podcast.this)
    . SetTitle ("Alert!")
. SetMessage ("Unable to connect to the Internet," +
"Check your network or try again later.")
. SetNeutralButton ("OK"
new DialogInterface.OnClickListener () {
public void onClick (DialogInterface dialog,
int which) {}
}). Show ();
    }

    }

    / / Method calls the XML Parser
    public void do_update ()
    {
    PodcastParser.parse ();
    }

    / / Method that populates the list view with XML parameters
    public void populate_listview ()
    {
        List <Itens> podcastList <Itens> = new ArrayList ();

        for (int i = 0; i <arraysPodcast.PodcastTitle.length; i + +) {
            end item Items = new Items ();
        item.setTitle (arraysPodcast.PodcastTitle [i]);
        item.setData (arraysPodcast.PodcastData [i]);

        item.setImage (arraysPodcast.ArrayIMGPodcast [i]);
        podcastList.add (item);

        }

        setListAdapter (new PodcastAdapter (this, podcastList));
        ListView shot getListView = ();

        shot.setOnItemClickListener ((OnItemClickListener) this);

    }

    public void onItemClick (AdapterView <?> arg0, View v, int position, long id) {
    / / Start the Activity podcast regarding your number from the list
    Myintent intent = new Intent ("com.example.player.PODCAST");
    Mybundle bundle = new Bundle ();
    mybundle.putInt ("podcastnumber" position);
    myintent.putExtras (mybundle);

    startActivity (myintent);

}

    private class extends DoInBackground AsyncTask <Void, Void, Void>
                                 implements DialogInterface.OnCancelListener
    {
        ProgressDialog private dialog;

        protected void OnPreExecute ()
        {
        dialog = ProgressDialog.show (Main_podcast.this, "", "Loading Podcasts ...", true);
        }

        protected void doInBackground (Void. unused ..)
        {
        do_update ();
        return null;
        }

        OnPostExecute protected void (Void unused)
        {
        dialog.dismiss ();
        populate_listview ();
        }

        public void onCancel (DialogInterface dialog)
        {
        cancel (true);
        dialog.dismiss ();
        }
    }

    public static boolean Connected (Context context) {
        try {
            = ConnectivityManager cm (ConnectivityManager)
            context.getSystemService (Context.CONNECTIVITY_SERVICE);
            LogSync String = null;
            LogToUserTitle String = null;
            if (cm.getNetworkInfo (ConnectivityManager.TYPE_MOBILE). isConnected ()) {
                    LogSync + = "\ nConectado 3G Internet";
                    LogToUserTitle + = "Connected to 3G Internet";

                    return true;
            } Else if (cm.getNetworkInfo (ConnectivityManager.TYPE_WIFI). IsConnected ()) {
                    LogSync + = "\ nConectado WIFI Internet";
                    LogToUserTitle + = "Connected to Wireless Internet";
                    return true;
            Else {}
                    LogSync + = "\ nYou have internet connection";
                    LogToUserTitle + = "Do not have an internet connection";

                    return false;
            }
        } Catch (Exception e) {
                return false;
        }
    }

} / / Class 
```

问题是，如何使用自定义单元库 johannilsson 实现我的类？

欢迎任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T14:24:31.597

决定如下：

```
public class PullToRefreshActivity extends ListActivity implements OnItemClickListener {
    private LinkedList<String> mListItems;
    private List<Itens> podcastList;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.pull_to_refresh);
        // Set a listener to be invoked when the list should be refreshed.
        // ======================================================
        Bundle mybundle = new Bundle();
        mybundle.putString("podcastnumber", "0");

        //verifica se há conexao e inicia download do XML
        Boolean conected = Conectado(this);
        if(conected == true){
            new DoInBackground().execute();
        }else{
            new AlertDialog.Builder(PullToRefreshActivity.this)
            .setTitle("Alerta!")
            .setMessage("Não foi possível estabelecer uma conexão com a Internet," +
                    "verifique sua rede ou tente novamente mais tarde.")
            .setNeutralButton("OK",
        new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog,
             int which) {}
      }).show();
        }

     // ======================================================

        ((PullToRefreshListView) getListView()).setOnRefreshListener(new OnRefreshListener() {
            @Override
            public void onRefresh() {
                // Do work to refresh the list here.
                new DoInBackground().execute();
            }
        });

    }

    // ==================================================================
    public void do_update() 
    {
        PodcastParser.parse();
    }

    //metodo que preenche a list view com parametros do XML
    public void populate_listview()
    {  

        podcastList = new ArrayList<Itens>();

        for (int i = 0; i < arraysPodcast.PodcastTitle.length; i++) {
            final Itens item = new Itens();
            item.setTitle(arraysPodcast.PodcastTitle[i]);
            item.setData(arraysPodcast.PodcastData[i]);

            item.setImage(arraysPodcast.ArrayIMGPodcast[i]);
            podcastList.add(item);

        }  

        setListAdapter(new PodcastAdapter(this, podcastList));

        ((PullToRefreshListView) getListView()).setOnItemClickListener((OnItemClickListener) this);
    }

    public void onItemClick(AdapterView<?> arg0, View v, int position, long id) {
        //Inicia Activity da podcast referente a seu numero da lista
        Intent myintent = new Intent("com.example.player.PODCAST");
        Bundle mybundle = new Bundle();
        mybundle.putInt("podcastnumber", (position-1));
        Log.e("posicao na lista",""+position);
        myintent.putExtras(mybundle);

        startActivity(myintent);

    }

    private class DoInBackground extends AsyncTask<Void, Void, Void>
                                 implements DialogInterface.OnCancelListener
    {
        private ProgressDialog dialog;

        protected void onPreExecute() 
        {

            dialog = ProgressDialog.show(PullToRefreshActivity.this, "", "Carregando Podcasts...", true);
        }

        protected Void doInBackground(Void... unused) 
        { 
            PodcastAdapter.topBar=true;
            do_update(); 
            return null; 
        }

        protected void onPostExecute(Void unused) 
        { 
            ((PullToRefreshListView) getListView()).onRefreshComplete();
            dialog.dismiss(); 
            populate_listview();
        }

        public void onCancel(DialogInterface dialog) 
        { 
            cancel(true); 
            dialog.dismiss(); 
        }
    }

    public static boolean Conectado(Context context) {
        try {
            ConnectivityManager cm = (ConnectivityManager)
            context.getSystemService(Context.CONNECTIVITY_SERVICE);
            String LogSync = null;
            String LogToUserTitle = null;
            if (cm.getNetworkInfo(ConnectivityManager.TYPE_MOBILE).isConnected()) {
                    LogSync += "\nConectado a Internet 3G ";
                    LogToUserTitle += "Conectado a Internet 3G ";

                    return true;
            } else if(cm.getNetworkInfo(ConnectivityManager.TYPE_WIFI).isConnected()){
                    LogSync += "\nConectado a Internet WIFI ";
                    LogToUserTitle += "Conectado a Internet WIFI ";
                    return true;
            } else {
                    LogSync += "\nNão possui conexão com a internet ";
                    LogToUserTitle += "Não possui conexão com a internet ";

                    return false;
            }
        } catch (Exception e) {
                return false;
        }
    }

} 
```

# python - RAR 存档和 Gzip 的巨大压缩差异：有什么我遗漏的吗？

> ID：10874948
> 
> 赞同：1
> 
> 时间：2012-06-03T23:58:59.177
> 
> 标签：python, compression, gzip, archive, winrar

我有一个大小约为**500MB**的巨大文本文件。我尝试从 python 程序和命令行使用**Gzip将其存档。**但是，在这两种情况下，归档文件的大小约为**240MB**，而在 Windows 中使用**WinRAR**归档时，归档文件的大小约为**450KB**。我在这里缺少什么吗？为什么有这么大的差异，我能做些什么来达到类似的压缩水平？

我也用 Python 标记了它，因为任何与此相关的 Python 代码都会非常有帮助。

这是[文件](https://docs.google.com/open?id=0B4Rf_mQEJerQVUxEVndvdHhGNlk)的前 3 行：

```
$ head 100.txt -n 3
31731610:22783120;
22783120:
45476057:39683372;5879272;54702019;58780534;30705698;60087296;98422023;55173626;5607459;843581;11846946;97676518;46819398;60044103;48496022;35228829;6594795;43867901;66416757;81235384;42557439;40435884;60586505;65993069;76377254;82877796;94397118;39141041;2725176;56097923;4290013;26546278;18501064;27470542;60289066;43986553;67745714;16358528;63833235;92738288;77291467;54053846;93392935;10376621;15432256;96550938;25648200;10411060;3053129;54530514;97316324; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-04T04:07:44.373

该文件可能是高度冗余的，具有大于 32K 的重复模式。gzip 的 deflate 只查找 32K 的匹配项，而其他的可以利用更早的历史。

*更新：*

我刚刚制作了一个 64K 随机数据块的文件，重复了 4096 次（256 MB）。gzip（带有 32K 窗口）对冗余视而不见，因此无法对其进行压缩。gzip 将其扩展为 256.04 MB。xz（具有 8 MB 窗口的 LZMA）将其压缩为 102 KB。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T00:07:25.153

WinRAR 和 Gzip 是两个非常不同的压缩程序。它们各自使用不同的算法来压缩数据。以下是来自维基百科的每种类型的描述：

> RAR 第 3 版基于 Lempel-Ziv (LZSS) 和通过部分匹配 (PPM) 压缩进行预测，特别是 Dmitry Shkarin 的 PPMII 的 PPMd 实现。
> 
> [http://en.wikipedia.org/wiki/RAR#Compression_algorithm](http://en.wikipedia.org/wiki/RAR#Compression_algorithm)

和 Gzip：

> 它基于 DEFLATE 算法，该算法是 Lempel-Ziv (LZ77) 和 Huffman 编码的组合。
> 
> en.wikipedia.org/wiki/Gzip

我的猜测是部分匹配预测和霍夫曼编码的工作方式之间存在某种差异。该文件具有非常有趣的属性...文件是什么？

# python - eclipse中的导入错误，以root身份运行应用程序

> ID：10874949
> 
> 赞同：1
> 
> 时间：2012-06-03T23:59:08.540
> 
> 标签：python, eclipse, import, root

我正在使用 Eclipse+PyDev 在 Python 中为 GNU/Linux 发行版开发安装程序。对于其中的某些任务，程序需要以 root 权限运行，但我以普通用户身份运行 Eclipse。

我在 Internet 上搜索了很多关于如何以 root 身份运行应用程序而无需以特权运行 Eclipse 的资料，但对于如何以“好的方式”完成此任务没有任何线索。所以我尝试使用“gksu2”python 模块，它具有与 bash 中的 gksu 相同的 gksu2.sudo() 函数。

我创建了一个新模块，导入了 gksu2 并执行了应用程序的 main.py 模块，但我得到了一个“ImportError：没有名为 ui.regular_ui.wizard 的模块”。在eclipse中没有gksu2它运行正常，但如果我使用它就不行。我以为是环境变量问题，但是 sys.path 没问题。

如果我从 Eclipse 之外的终端运行应用程序，也会发生同样的错误。你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T11:42:28.520

看起来您的 PYTHONPATH 在 Eclipse 外部/内部是不同的。尝试删除 Python 解释器并再次添加它以收集新路径 - 如果这还不够，请执行以下操作： import sys;print('\n'.join(sorted(sys.path))) 外部/内部 Eclipse 以了解什么是不同并修复 Eclipse 中的路径。

# php - PHP在文本文件中增加计数变量

> ID：10874950
> 
> 赞同：4
> 
> 时间：2012-06-03T23:59:30.083
> 
> 标签：php

这似乎很简单，但我无法弄清楚。

```
file_get_contents('count.txt');
$variable_from_file++;
file_put_contents('count.txt', $variable_from_file); 
```

里面只有一行数据，`count.txt`就是命中计数器。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-04T00:20:56.590

如果您想确保没有不计数的增量（这就是 CodeCaster 所指的，脚本可能会加载 count.txt，增加它，而另一个文件也在做同样的事情，然后保存它，然后只有一个增量会被完成而不是正确的两个），您应该使用`fopen`.

```
$fp = fopen('count.txt', 'c+');
flock($fp, LOCK_EX);

$count = (int)fread($fp, filesize('count.txt'));
ftruncate($fp, 0);
fseek($fp, 0);
fwrite($fp, $count + 1);

flock($fp, LOCK_UN);
fclose($fp); 
```

这将锁定文件，防止任何其他人在计数增加时对其进行读取或写入（这意味着其他人必须等待才能增加值）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-01-05T22:57:49.023

有一个稍微好笑的方法：

```
file_put_contents("count.txt",@file_get_contents("count.txt")+1); 
```

**file_get_contents**读取计数器文件的内容。
**@**告诉 PHP 忽略丢失文件的错误。然后返回的 false 将被解释为 0 的计数。
+1 将导致字符串转换为数字。
**file_put_contents**然后将新值作为字符串存储在计数器文件中。

在非常繁忙的系统上，您可能希望首先获得文件锁以防止同时写入。操作系统文件缓存通常使这种方法非常快。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-04T00:02:02.417

```
$variable_from_file = (int)file_get_contents('count.txt'); 
```

但请注意，这不是线程安全的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-04T00:03:00.810

就像你做的那样，它应该可以正常工作。只需从中捕获数据`file_get_contents()`，并检查这两个功能是否都成功。

```
$var = file_get_contents('count.txt');
if ($var === false) {
    die('Some error message.');
}
$var++;
if (file_put_contents('count.txt', $var) === false) {
    die('Some error message.');
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-04T00:14:41.457

虽然这对我有用

```
$count = intval(file_get_contents('count.txt'));
file_put_contents('count.txt', ++$count);
echo file_get_contents('count.txt'); 
```

# javascript - Coffeescript 静态分析 / 静态类型检查 - 障碍

> ID：10874952
> 
> 赞同：20
> 
> 时间：2012-06-03T23:59:49.867
> 
> 标签：javascript, programming-languages, coffeescript, static-analysis

我认为 Coffeescript 是一门很棒的语言！我正在寻找一些将静态分析添加到 Coffeescript 的项目/问题/功能。然而，经过一番搜索，我发现 Coffeescript[常见问题](https://github.com/jashkenas/coffee-script/wiki/FAQ)解答和[此页面](https://github.com/jashkenas/coffee-script/issues/1852)表明静态分析可能不可行。

我想知道在Coffeescript中实现静态分析/静态类型检查是否存在基本问题，因为编译器中不存在这种类型的东西？

此外，对于非平凡的检查来说，这是不可能做的事情，但可能只适用于简单的分析？当我说直截了当时，我的意思是检查一些琐碎的事情，例如，用户是否以相同的名称（在一个类中）或在顶层（或者可能在相关的 .coffee 文件集合的顶层）定义了一个函数两次.

如果有人能指出一些例子来说明为什么实施静态分析/类型检查并不简单/可能/值得花时间，我将不胜感激？

非常感谢你！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-04T22:07:16.110

这个答案有点脑残，因为我也对此感兴趣。希望能帮助到你。

我使用 Google Closure Compiler 静态分析 CoffeeScript 生成的代码。它有一个非常好的静态分析器，我不确定是否有充分的理由在这里重新发明轮子。简单的方法是手动编写注释：

```
###*
   * @param {number} x
   * @param {number} y
   * @return {number}
###
adder = (x, y) -> x + y 
```

这有点冗长，但另一方面，您正在借用闭包编译器的静态分析能力，它非常强大并且能够检查很多。我实际上以稍微简洁的方式编写类型注释，然后有一个脚本来重写咖啡文件。我的代码最终看起来像这样：

```
#! {number} x {number} y @return {number}
adder = (x, y) -> x + y 
```

我相信您可以看到重写器非常简单。

在我继续之前快速说明。如果您通过闭包编译器运行**代码，请务必使用`-b`(bare)编译您的代码。**闭包编译器还是不错的，但是做数据流分析还不够聪明。CoffeeScript 默认将您的代码包装在一个匿名函数中，这会使编译器出错。

沿着相同路径的另一个选项（这会破坏与 CoffeeScript 的兼容性，但会更酷）是让 Coffee 编译器编译如下内容：

```
adder = (number x, number y): number -> x + y 
```

像这样进入JS：

```
/***
  * @param {number} x
  * @param {number} y
  * @return {number
  */
var adder = function(x, y) {
  return x + y;
}; 
```

然后可以在编译时将其输入闭包编译器 - 如果没有错误，编译器可以删除所有注释。

的确，[这家伙](https://github.com/bolinfest/coffee-script)似乎就是这么做的。可悲的是，他的作品似乎处于不完整的状态。

在所有这些情况下，我们将艰苦的工作——静态类型检查——推迟到闭包编译器。如果您不想这样做，我会理解，但是很难说服我从头开始构建一个全新的静态分析工具是值得的。:)

一年后编辑：这些天我只使用打字稿。:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-04T00:48:41.123

我不是 CoffeeScript 专家，所以这可能是完全错误的答案，但它基本上可以归结为：CoffeeScript 是一种非常有表现力的语言，大部分语义都是动态确定的（可能还有奇怪的边缘情况）。这与标准 ML 等具有更严格定义的语义的语言形成鲜明对比。一般来说，对高阶语言进行静态分析被认为是*非常*困难的。即，对真正的高阶程序（Haskell，ML，*尤其是*javascript 因为 eval 之类的东西）只是很难，因为控制流更加灵活。事实上，高阶语言的静态分析解决方案实际上只是在过去二十年左右的时间里才被探索过。（值得注意的是，请参阅 Matt Might 关于[CFA 教程风格描述](http://matt.might.net/articles/implementation-of-kcfa-and-0cfa/)的文章。）

基本上，原因是这样的：

*   要进行*分析*，您必须处理来自流控制的表达语义问题，您可以通过猛烈抨击高阶函数。
*   要进行*打字*，通常这些语言具有更丰富的可用类型集。例如，在非常典型的情况下，如果您尝试将静态类型分配给 Ruby 中的变量（如在 C、Java、ML 等中），您会收到错误，但因为您的程序的某些路径永远不会执行，一切正常。除此之外，像 Ruby 之类的其他语言添加了大量的隐式类型转换，这些转换*确实用于*进行很酷的编程。我所熟悉的这一领域的著名工作[（Ruby 的静态类型的动态分析）](http://www.cs.umd.edu/~jfoster/papers/popl11.pdf)来自与我一起工作的一些人，但肯定还有其他例子。
*   基本上，该语言以更加*动态*的方式使用，具有更具*表现力*的语义，并且静态推理要困难得多，并且容易不精确。接近这一点（这些天）的基本前沿开始看起来是混合的：您可以静态分析程序的一部分，并且还需要程序员提供一些测试用例来进行某种精细分析。

我希望这在一定程度上回答了你的问题，再次抱歉，我无法直接解决你的问题的直接问题，因为它适用于 CoffeeScript，但现在在分析 JavaScript 之类的东西方面还有*很多工作要做。*我会注意到 Javascript 的一些真正问题来自它奇怪的语​​义，原型继承很难推理，*尤其是* `eval()`！通常，这些语言的程序分析会施加某些限制（例如，完全抛弃 eval！）以使分析更可行！

# c# - 使用 C# 读取锁定的 Excel (.xlsx) 文件

> ID：10874960
> 
> 赞同：0
> 
> 时间：2012-06-04T00:01:14.217
> 
> 标签：c#, excel, parsing

这是我读取上传的 Excel 文件的代码。在过去的 3 个月里，它工作得非常好。

```
var connectionString = GetOleDbConnectionString(file);

using (var dataAdapter = new OleDbDataAdapter("select * from [Sheet1$]",         connectionString))
{
    dataAdapter.Fill(ds, tableCount.ToString());
}

private static string GetOleDbConnectionString(string file)
{
    var fileExtension = Path.GetExtension(file);

    if (fileExtension.EqualsCCIC(".xlsx"))
    {
        return @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={0};Extended Properties=Excel 12.0;".F(file);
    }
} 
```

**问题：**上传的 excel 文件将“StartDate”作为第一列。但是这一列也有员工姓名和日期（我需要阅读这个员工姓名来处理这张表）。

我遇到了一个新的 Excel 文件（Excel2007 .xlsx）。当我上传新文件（同时包含员工姓名和日期）时，它只是从列中读取日期并忽略员工姓名。我的数据集（在调试时）将数据表中的那些单元格显示为空字符串。根据业务逻辑，我需要知道这些日期属于哪个员工。我删除了整个工作表的锁（单元格格式>>保护>>锁）但仍然没有用。我怎么解决这个问题？我没有线索...

它正在成功读取旧文件（2007 .xlsx） 我不明白是什么让 OLEDB 在日期列中隐藏字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T01:48:43.753

所以你是说新的excel文件是问题？如果是这样的话...

*   检查文件中的数据（尤其是员工姓名列的前8行）
*   将新文件中的数据复制到已知可以工作的文件中

[使用 C# 访问 Excel 电子表格偶尔会为某些单元格返回空白值](https://stackoverflow.com/questions/298726/accessing-excel-spreadsheet-with-c-sharp-occasionally-returns-blank-value-for-so) 查看上面链接中 ABHI 的答案（特别是第 1 点和第 2 点。）

# css - 特定表格行之间的边框和间距

> ID：10874962
> 
> 赞同：13
> 
> 时间：2012-06-04T00:01:53.127
> 
> 标签：css, html-table, row, border, margin

我是 CSS 新手，正在开发一个将在现代标准浏览器中呈现的 intraweb 应用程序（不需要 IE 支持*）*。我花了很多时间在这个网站和其他网站上寻找答案，只是为了找到答案“这是不可能的，因为......”或“改为做这个黑客......”但我不会接受。

**这是我需要的：**

1.  具有一个标题行和多个正文行的表格；
2.  标题行下方的实线边框；
3.  仅在标题行和第一个正文行之间的垂直空白（填充？边距？间距？）；
4.  鼠标悬停时突出显示正文行。

在我为 table 设置样式之前，我无法看到 (2) `border-collapse: collapse;`。美好的。但是 (3) 显然只适用于`border-spacing`，并且只适用于`<td>`元素（不是`<tbody>`或`<tr>`），它无论如何都被`collapse`. 同时，由于某些不可知的原因，,或元素`margin`无法识别 's ，但在 body 的作品的第一行却没有，因为当我将鼠标悬停在第一行上时，整个页边距- which-is-implemented-as-也被突出显示，这让我感到恶心。`<thead>``<tr>``<th>``padding-top``<td>``padding`

我知道在表格的标题和正文之间有几个像素的边距就像一个真正的左字段，为什么-任何人都想要-想要的东西，但我应该告诉你什么？我不是便宜的约会对象。

请尽可能残酷和居高临下地指出我在理解 CSS 方面的愚蠢行为，*前提*是您也 1）说出如何在不更改标记的情况下做到这一点（从而保持呈现与内容的分离 CSS 显然旨在鼓励）或2）同意我的观点，CSS 很奇怪。

```
<head><style>
  table {
    border-collapse: collapse;
    border-spacing: 0;
  }
  thead {
    border-bottom: 4px solid #123456;
  }
  /*** something goes here ***/
  tbody tr:hover {
    background-color: #ABCDEF;
  }
</style></head>

<body>
  <table>
    <thead>
      <tr><th>Fruit</th><th>Color</th><th>Yummy?</th></tr>
    </thead>
    <tbody>
      <tr><td>Apple</td><td>Green</td><td>Yes</td></tr>
      <tr><td>Banana</td><td>Yellow</td><td>Yes</td></tr>
      <tr><td>Pear</td><td>Brown</td><td>Yes</td></tr>
    </tbody>
  </table>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-28T10:37:02.457

这将在没有任何黑客攻击的情况下解决您的问题，当然它完全有可能。更新后的代码（仅 CSS 更改）在下面共享，并附有说明。

**问题 3**：

我们可以`:first-of-type`连续使用 CSS 选择器（仅针对第一行），`<td>`并使用属性`padding-top`。简单的 ：-）

`<tr>`默认情况下不能有边距值。再次可以使用黑客（上面提到的答案），但我不会去那里，因为你不想要它。

而且由于我们使用`padding`了 ，悬停效果将完美地适用于整个行内容。因此，无需任何标记更改即可获得所需的更改。

**问题2**：

我们可以`border-collapse`从标签中删除属性`table`，而是在`<th>`标签上应用边框（让`border-spacing: 0`剩余部分或边框不连续）。再次简单:-)

**问题 1 和 4**已经涵盖。没有您希望的标记更改。[这是小提琴](https://jsfiddle.net/0qfj7gzu/)

所以更新的样式代码看起来像

```
<head><style>
  table {
    border-spacing: 0;
  }
  thead tr th {
    border-bottom: 4px solid #123456;
  }
  tbody tr:hover {
    background-color: #ABCDEF;
  }

  /*** added ***/
  tbody tr:first-of-type td {
    padding-top: 10px;
  }

</style></head> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T00:11:06.187

好的，按顺序：

**1：**一个标题行和多个正文行的表格：

这就是元素`thead`和`tbody`设计的目的：

```
<table>
    <thead>
        <tr><th>heading one</th><th>Heading two</th></tr>
    </thead>
    <tbody>
        <!--
            all body table rows in here
        -->
    </tbody>
</table> 
```

还有`tfoot`（参见参考资料），如果使用，必须在元素*之前声明。*`tbody`

**2：**标题行下方的实线边框：

```
 thead tr th {
        border-bottom: 2px solid #000;
    } 
```

选择`th`元素内的`thead`元素，`tr`这里可能不需要选择器，虽然它没有害处，但可以简化为：`thead th {/*...*/}`.

**3：**仅在标题行和第一个正文行之间的垂直空白（填充？边距？间距？）。`padding`似乎不能应用于`thead`,`tbody`或`tr`元素，因为它们本质上（我想）是“非视觉的”，因此必须在`td`元素上定义它。这确实，在悬停时，意味着第一行占据了令人不安的大“行” `:hover`（见下一部分）。

```
 tbody tr:first-child td {
        padding-top: 1em;
    } 
```

**4：**鼠标悬停时突出显示正文行。

```
 tbody tr:hover td {
        background-color: #ffa;
    } 
```

虽然您可以将 a`:hover`应用于当前悬停的单元格，以及后来的兄弟姐妹（使用通用兄弟`~`组合器），但您不能将样式应用于先前出现的兄弟姐妹，因此我们在此处设置`td`元素的样式以响应`:hover`其父元素`tr`.

我们必须设置样式`td`（而不是直接更改）的`background-color`原因`tr`是因为`td`元素通常不会默认为透明背景，这意味着更改/突出显示的元素`background-color`会“隐藏” 。`background-color``td`

[JS 小提琴演示](http://jsfiddle.net/davidThomas/9bkN2/)。

参考：

*   [表行组`thead`、、、、元素`tbody``tfoot`](http://www.w3.org/TR/html4/struct/tables.html#h-11.2.3)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T00:14:30.690

为了应用于`margin`第一个表格行，您需要先创建它`display: block;`，因为边距只能应用于块元素（包括内联块）

但这是使用定位的另一种解决方案：

```
<head><style>
  table {
    border-collapse: collapse;
    border-spacing: 0;
    position: relative; /* Add positioning */
    margin-top: 40px; /* Add some margin */
  }
  thead {
    border-bottom: 4px solid #123456;
  }
  /*** something goes here ***/
  thead {
    position: absolute; /* Position this element absolute */
    top: -40px;  /* And move it up */
  }
  tbody tr:hover {
    background-color: #ABCDEF;
  }
</style></head>

<body>
  <table>
    <thead>
      <tr><th>Fruit</th><th>Color</th><th>Yummy?</th></tr>
    </thead>
    <tbody>
      <tr><td>Apple</td><td>Green</td><td>Yes</td></tr>
      <tr><td>Banana</td><td>Yellow</td><td>Yes</td></tr>
      <tr><td>Pear</td><td>Brown</td><td>Yes</td></tr>
    </tbody>
  </table>
  <p>Thats how its done!</p>
</body> 
```

基本上我们适用`position: relative;`于桌子和`position: absolute;`广告。`top`现在您可以使用、`bottom`和属性在表格`left`内移动 thead 。`right`我们将使用`top: -40px;` We do not apply `position: absolute;`to tbody 将其向上移动 40 像素，因为如果这样做 - 此元素将不再“拉伸页面”，或者换句话说，所有以下元素将忽略其高度。（尝试这样做，看看下面会发生什么

块）我们剩下的唯一一件事是在表格本身上应用一些margin-top，将其向下移动（当我们将thead向上移动时）

是的，CSS 有时看起来有点奇怪，但这主要是因为我们忘记了一些页面元素应该如何处理（即表格及其子元素）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-04T13:41:36.443

在开头添加一个空行怎么样

```
<tbody>
    <tr><td> </td></tr>
    <tr><td>blablablabla</td></tr> 
```

并使用这个 CSS

```
tbody tr:first-child td{
    padding-top: 15px;
}
tbody tr:first-child:hover{    
    background-color: transparent;
} 
```

所以填充将被添加到第一行并且第一行不会在鼠标悬停时突出显示？:)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-11-12T06:13:47.377

你所有的4点都在那里-

1.  首先在这里下载metro ui css [http://metroui.org.ua/](http://metroui.org.ua/)
2.  将其两个 css 文件 1.metro-bootstrap，2.metro-bootstrap-responsive 包含到您的项目中。
3.  在 BundleConfig 中注册。

    bundles.Add(new StyleBundle("~/Content/css/metroUI").Include("~/Content/css/metro-bootstrap.css", "~/Content/css/metro-bootstrap-responsive.css") );

4.  现在使用类“gr-items”作为表

<table id="divAllActivities" class="gr-items">

```
<thead>
    <tr><th><span>Comment</span></th></tr>
</thead>
<tbody>
    <tr>
        <td><span>OperationDateTime</span></td>
    </tr>
     <tr>
        <td><span>OperationDateTime</span></td>
     </tr>
</tbody> 
```

希望这是你想要的。

# node.js - 如何让所有路由都进入索引？

> ID：10874967
> 
> 赞同：0
> 
> 时间：2012-06-04T00:04:23.093
> 
> 标签：node.js, express

我正在开发一个单页应用程序，我想知道如何让所有路线都进入索引？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T00:24:31.890

```
app.get('*', ... 
```

如果您使用的是快递；）

# android - 编辑文本的条件

> ID：10874972
> 
> 赞同：0
> 
> 时间：2012-06-04T00:04:56.480
> 
> 标签：android, android-edittext, settext

我对一些editText有点挣扎：S我想检查一些条件，如果用户填写了一个字段：我的代码似乎不起作用。

编码 ：

...

```
 input.setText("rrr");
     input2.setText("rrr");

     AlertDialog.Builder builder = new AlertDialog.Builder(ctx);

     builder.setCancelable(true);
     builder.setTitle("Add a friend");
     builder.setMessage("Fill in the fields you know :");

     builder.setView(layout);

    builder.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {

            if(input.getEditableText() != null && input2.getEditableText() != null && input3.getEditableText() != null){

                Dialog d = new Dialog(ctx);
                d.setTitle("BLiBLiBLi !");
                d.show();

            }else if(input.getEditableText() != null && input2.getEditableText() != null && input3.getEditableText() == null){

                Dialog d = new Dialog(ctx);
                d.setTitle("BLABLABLA !");
                d.show();

            } 
```

...

如您所见，前两个字段有一个 setText("rrr"); 但不是第三个......所以第二个条件应该指出（如果我不填写第三个输入），我应该得到 BLABLABLA 消息，但我总是得到 BLiBLiBLi :'( （这只是一个测试当然：p）

我已经尝试使用 input.getEditableText().toString != "" 更改 input.getEditableText() != null 或像这样设置输入 input.setText(""); 或 input.setText(null); ：它只是不起作用我总是在第一个条件下认为我的所有字段都被填充

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T00:20:10.750

只需检查每个`EditText`. 这将做你想要的......

```
if(input.getText().toString().length() > 0 && input2.getText().toString().length() > 0 && input3.getText().toString().length() > 0 ){

    Dialog d = new Dialog(ctx);
    d.setTitle("BLiBLiBLi !");
    d.show();

} else if(input.getText().toString().length() > 0 && input2.getText().toString().length() > 0 && input3.getText().toString().length() == 0 ) {

    Dialog d = new Dialog(ctx);
    d.setTitle("BLABLABLA !");
    d.show();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T00:19:22.487

您想要的代码是检查 EditText 中字符串的长度

```
if( EditText.getText().length() > 0 ){
    do something here if text exists
   }else{
    do something else here if empty
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T00:21:46.113

您应该将您的更改`input.getText() != null`为`input.getText().toString().equals("")`. 如果 EditText 字段为空，则意味着它包含一个空字符串 (text="")，而不是 null。

最简单和“最漂亮”的方法是使用[TextUtils.isEmpty()](http://developer.android.com/reference/android/text/TextUtils.html#isEmpty(java.lang.CharSequence))

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-05T10:53:52.250

你好，你也可以试试这个方法。

```
 EditText usernameEditText = (EditText)  findViewById(R.id.editUsername);
    sUsername = usernameEditText.getText().toString();
    if (sUsername.matches("")) {
    Toast.makeText(this, "You did not enter a username",Toast.LENGTH_SHORT).show();
    return;
} 
```

# python - flask peewee REST api 身份验证以限制 GET

> ID：10874973
> 
> 赞同：2
> 
> 时间：2012-06-04T00:04:58.943
> 
> 标签：python, rest, flask, peewee

我正在使用 flask-peewee 来构建一个新项目。此外，我正在使用烧瓶 peewee 中包含的 REST 接口。我按照这里的例子[http://flask-peewee.readthedocs.org/en/latest/getting-started.html#exposing-content-using-a-rest-api](http://flask-peewee.readthedocs.org/en/latest/getting-started.html#exposing-content-using-a-rest-api)和[http://flask-peewee.readthedocs.org /en/latest/rest-api.html#rest-api](http://flask-peewee.readthedocs.org/en/latest/rest-api.html#rest-api) 所以我能够启动并运行我的 rest api，包括将 Auth 添加到 Rest。

但是我的问题是我无法保护 GET 请求。到目前为止，我已经浏览了 rest.py [https://github.com/coleifer/flask-peewee/blob/master/flask_peewee/rest.py](https://github.com/coleifer/flask-peewee/blob/master/flask_peewee/rest.py)的源代码，但无法找到它的来源，尽管我确实找到了很多好东西我以后可以用。

默认情况下，REST API 似乎只保护 POST/PUT/DELETE 而不是 GET。

我不想使用烧瓶 url 安全，我希望烧瓶 peewee 有一些内置的方法。或者，如果这是一个已知的限制，那么什么是处理这个问题的好方法

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T13:13:43.760

抱歉，您在查找此信息时遇到了问题。您可以指定一个 HTTP 动词列表，以在实例化您的 auth 类时要求对其进行身份验证：

```
# when instantiating your authentication
api_auth = UserAuth(auth, protected_methods=['GET', 'POST', 'PUT', 'DELETE'])
read_only_auth = UserAuth(auth) # default protected methods are POST/PUT/DELETE 
```

这是文档的链接：

[http://flask-peewee.readthedocs.org/en/latest/api.html#authenticating-requests-to-the-api](http://flask-peewee.readthedocs.org/en/latest/api.html#authenticating-requests-to-the-api)

# php - 融合图表，在其中使用会话 ID

> ID：10874977
> 
> 赞同：0
> 
> 时间：2012-06-04T00:05:50.013
> 
> 标签：php, mysql, fusioncharts

我正在尝试显示当前显示在我的基于 php 的画廊中的图片的图表。

在图库页面中：

```
$_SESSION["frameid"] = $id_array[$i];
session_register("frameid"); 
```

在 piedata.php 中，我编码

```
session_start();
$frameid = $_SESSION["frameid"]; 
```

进而

```
$strQuery = "select * from vote_frames WHERE frame_id=$frameid 
             union 
             SELECT * FROM vote_frames WHERE frame_id!=$frameid LIMIT 0,3"; 
```

但它没有显示任何东西，看起来它没有获取会话值。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-06-04T00:13:09.330

[`session_register()`](http://php.net/session_register)自 PHP 5.3.0 起已弃用。你应该删除那条线，它会捡起它。试试

```
session_start();
// ...
$_SESSION["frameid"] = $id_array[$i]; 
```

或者如果你想坚持`session_register()`做

```
session_start();
// ...
$frameid = $id_array[$i];
session_register("frameid"); 
```

# javascript - 将 #contentImg 的 src 更改为单击的链接中的图像

> ID：10874980
> 
> 赞同：0
> 
> 时间：2012-06-04T00:06:44.163
> 
> 标签：javascript, jquery, jquery-mobile

我设置了 jquery 移动列表视图。我想使用 jQuery 将 #contentImg 的 src 更改为单击的图像缩略图的 src。

因此，当单击 'ul data-role="listview"' 中的 'a' 时，我希望 '#contentImg' 的 src 到 $this 中的 img（这是单击的 'a' 标记）。

我怎么能用 jQuery 做到这一点？

代码如下

```
 <ul data-role="listview">
        <li><a href="#content">
            <img src="image1.jpg" />
            <h3>Image1</h3>
            <p>Description</p>
        </a></li>
        <li><a href="#content">
            <img src="image2.jpg" />
            <h3>Image2</h3>
            <p>Description</p>
        </a></li>
     </ul> 
```

在文档中进一步

```
<img id="contentImg" src="contentImg.jpg" /> 
```

只是为了澄清单击第一个链接的时间#contentImg src应该更改为image1.jpg，如果单击第二个链接它将是image2.jpg

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T00:20:56.583

这应该适用于 jQuery >=1.7：

```
$('li a[href="#content"]').on('click', function(){
    $('#contentImg').attr('src', $(this).find('img').attr('src'));
}); 
```

***[JSFiddle](http://jsfiddle.net/ult_combo/6Q6DF/1/)***

如果使用 jQuery <1.7 `.on`，则交换`.live`

# java - 按日期过滤（忽略时间）

> ID：10874981
> 
> 赞同：0
> 
> 时间：2012-06-04T00:06:44.423
> 
> 标签：java, google-app-engine, jpa, google-cloud-datastore

我没有使用 JPA 获取日期过滤器。

例如我的数据库表数据使用这种日期格式：

```
id=22001     2012-05-24 01:18:44.459000  -3.72562176     -38.55413138
id=22002     2012-05-24 01:19:58.369000  -3.72556951     -38.55412081
id=22003     2012-05-24 01:20:11.509000  -3.72554203     -38.5541338
id=22004     2012-05-24 01:20:43.832000  -3.72556247     -38.55411875
id=22005     2012-05-27 21:31:31.179000  -3.73500586     -38.5359234
id=22006     2012-05-28 22:41:21.072000  -3.76651343     -38.49477246
id=22007     2012-05-28 22:44:37.100000  -3.76582333     -38.49650576
id=22008     2012-05-28 22:46:47.878000  -3.76732246     -38.49688336
id=22009     2012-05-28 22:48:11.118000  -3.76437084     -38.50487202
id=22010     2012-05-28 22:48:30.419000  -3.76383159     -38.50810391
id=22011     2012-05-28 22:50:21.972000  -3.76130886     -38.50585614
id=22012     2012-05-28 22:51:56.787000  -3.75217442     -38.50331619
id=22013     2012-05-28 22:52:59.405000  -3.7531888  -38.50264043
id=22014     2012-05-28 22:53:48.185000  -3.75311701     -38.50296631
id=22015     2012-05-28 22:54:53.602000  -3.75311704     -38.5029654 
```

这是我过滤行的代码：

```
public List<GeoLocation> getAll(Date date) {

     javax.persistence.Query q = entityManager
        .createQuery("SELECT g FROM  GeoLocation g where g.criationDate = :data");      
     q.setParameter("data", date,TemporalType.DATE);

     @SuppressWarnings("unchecked")
     List<GeoLocation> result  =  q.getResultList();

     return result;
 } 
```

这是我的实体。日期字段有 TemporalTime 注释

```
package br.com.drover.entity;
import java.util.Date;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;

@Entity
public class GeoLocation {

@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Long id;

@Column(nullable=false)
private Double latitude;

@Column(nullable=false)
private Double longitude;

@Column(nullable=false)
@Temporal(TemporalType.DATE)
private Date creationDate;

//..Some getters and setters 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T02:57:52.133

假设这将是一个常见查询，我将使用的方法是添加第二个“仅限日期派对”列，该列可以是一个 TemporalType.DATE，其中一天中的时间被清零。这使您可以进行精确过滤，这将使您从数据存储中获得良好的查询性能，但会在添加数据时以额外的一对索引写入为代价。

# android - 保存按钮无法将数据上传到 Parse

> ID：10874982
> 
> 赞同：1
> 
> 时间：2012-06-04T00:06:52.523
> 
> 标签：android, parsing

我无法超越让我的应用程序与服务器通信以存储数据的基础知识。

我正在尝试使用 Parse (https://parse.com/) 作为我正在开发的 Android 应用程序的后端。我的基本“快速入门”Parse 应用程序运行良好，并且能够使用 onCreate() 方法将数据从手机上的应用程序上传到我的 Parse 帐户。然后我尝试创建一个应用程序，它会在按下按钮时上传一些数据。我可以安装并运行该应用程序，但是当我按下按钮时似乎什么也没有发生，然后当我检查我的 Parse 帐户时，没有上传任何数据。我包含了 Parse 库并将它们添加到构建路径中。

这是应用程序代码-

```
package greg.mariani.saveLoad;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;

import com.parse.Parse;
import com.parse.ParseObject;

public class SaveLoad1Activity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        Parse.initialize(this, "private_app_token1", "private_app_token2"); 
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    public void saveUpdates(View view) {
        ParseObject updates = new ParseObject("Updates");
        updates.put("court", "Brentwood Rec");
        updates.put("update", "Game On");
        updates.saveInBackground();
    }
} 
```

这是布局xml-

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/save" 
        android:onClick="saveUpdates"/>

</LinearLayout> 
```

谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T00:59:48.510

您是否在清单文件中添加了 Internet 权限？

```
<uses-permission android:name="android.permission.INTERNET"></uses-permission> 
```

# css - 表格行上的框阴影未出现在某些浏览器上

> ID：10874985
> 
> 赞同：39
> 
> 时间：2012-06-04T00:07:27.987
> 
> 标签：css, css-tables

表格行上的 CSS box-shadow - `tr`- 似乎在浏览器中并不一致。在某些浏览器上会显示阴影；在别人身上，没有影子。

我正在使用以下 CSS：

```
tr {
  background-color: rgb(165, 182, 229);
  box-shadow: 0px 2px 2px black;
  -moz-box-shadow: 0px 2px 2px black;
  -webkit-box-shadow: 0px 2px 2px black;
}
td, th {
  padding: 5px;
  text-align: left;
} 
```

这是以下代码段的[jsFiddle](http://jsfiddle.net/FYt6X/1/)：

```
tr {
  background-color: rgb(165, 182, 229);
  box-shadow: 0px 2px 2px black;
  -moz-box-shadow: 0px 2px 2px black, ;
  -webkit-box-shadow: 0px 2px 2px black;
}
td, th {
  padding: 5px;
  text-align: left;
}
```

```
<table>
  <tr>
    <td>&nbsp;</td>
    <th>One</th>
    <th>Two</th>
  </tr>
  <tr>
    <th>Title</th>
    <td>Three</td>
    <td>Four</td>
  </tr>
  <tr>
    <th>Title2</th>
    <td>Five</td>
    <td>Six</td>
  </tr>
  <tr>
    <th>Title3</th>
    <td>Seven</td>
    <td>Eight</td>
  </tr>
  <tr>
    <th>Title4</th>
    <td>Nine</td>
    <td>Ten</td>
  </tr>
</table>
```

**注意：**`<tr>`替换`<div>`和添加时会观察到相同的行为`display: table-row`。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-07-12T07:48:22.367

如前所述，`box-shadow`属性仅适用于具有`display: block`或`display:inline-block`属性的元素。

如果您将`display: block`作为一般样式规则添加到表格单元格中，它将折叠，因为单元格所具有的自动宽度/高度比例`display:table`将不再应用。要模拟该行为，只需将`min-width`属性分配给每个`th`and `td`。

然后应用于`box-shadow`该行（悬停或不悬停）。

总之，您的代码应如下所示：

```
table { box-sizing: border-box; }
td, th { padding-left: 16px; min-width: 170px; text-align: left; }
tr { display: block; }
tr:hover { box-shadow: 0px 2px 18px 0px rgba(0,0,0,0.5); cursor: pointer; } 
```

为简单起见，我省略了供应商前缀。

这是完整的示例：

```
table {
  box-sizing: border-box;
  border-bottom: 1px solid #e8e8e8;
}
td,
th {
  padding-left: 16px;
  min-width: 170px;
  border: 1px solid #e8e8e8;
  border-bottom: none;
  font: 14px/40px;
  text-align: left;
}
td {
  color: #666;
}
tr {
  display: block;
}
th {
  color: #333;
}
tr:hover {
  background-color: #fbfbfb;
  box-shadow: 0px 2px 18px 0px rgba(0, 0, 0, 0.5);
  cursor: pointer;
}
```

```
<table cellpadding="0" cellspacing="0">
  <thead>
    <tr>
      <th>Phone number</th>
      <th>Date</th>
      <th>Name</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0342443</td>
      <td>10 August 2013</td>
      <td>Kate</td>
      <td>Loves cats</td>
      </td>
      <tr>
        <td>0342442</td>
        <td>9 August 2013</td>
        <td>Mary</td>
        <td>Boring</td>
      </tr>
      <tr>
        <td>0342441</td>
        <td>8 August 2013</td>
        <td>Anna</td>
        <td>Loves extreme stuff</td>
      </tr>
  </tbody>
</table>
```

您也可以[在这里查看小提琴](http://jsfiddle.net/szalishchuk/HYZdD/1/)。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2017-12-27T12:37:59.897

使用带有 box-shadow 的 transform **scale(1,1)**属性可以解决问题。

```
tr:hover {
  transform: scale(1);
  -webkit-transform: scale(1);
  -moz-transform: scale(1);
  box-shadow: 0px 0px 5px rgba(0,0,0,0.3);
  -webkit-box-shadow: 0px 0px 5px rgba(0,0,0,0.3);
  -moz-box-shadow: 0px 0px 5px rgba(0,0,0,0.3);
} 
```

小提琴：[https ://jsfiddle.net/ampicx/5p91xr48/](https://jsfiddle.net/ampicx/5p91xr48/)

谢谢！！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-04-01T17:26:05.413

如果您想看到它得到修复，请给这个错误加注星标：

[https://code.google.com/p/chromium/issues/detail?id=94871](https://code.google.com/p/chromium/issues/detail?id=94871)

如果您希望表格单元格宽度继续自动调整，您可以将阴影应用于单个单元格：

```
td:first-child {
  box-shadow:
    inset 0px 11px 8px -10px blue,
    inset 0px -11px 8px -10px blue,
    inset 11px 0px 8px -10px blue; 
}
td {
  box-shadow:
    inset 0px 11px 8px -10px blue,
    inset 0px -11px 8px -10px blue;
}
td:last-child {
  box-shadow:
    inset 0px 11px 8px -10px blue,
    inset 0px -11px 8px -10px blue,
    inset -11px 0px 8px -10px blue; 
} 
```

完整的例子[在这里](http://jsfiddle.net/mmh15v9q/1/)。（jsfiddle）

（灵感来自[https://stackoverflow.com/a/10150898/724752](https://stackoverflow.com/a/10150898/724752)）

在每个盒子阴影值中：

*   调整第三个数字（模糊半径）来改变模糊半径。
*   第 4 个数字（扩展半径）必须始终为负，并且其绝对值必须大于第 3 个数字（模糊半径）。
*   使第一个数字（偏移 x）非零以在左侧或右侧获得阴影。使其绝对值 1 大于第 4 个数字的绝对值（再次参见上面的示例，更容易理解我的意思）。
*   使第二个数字（偏移 y）非零以在顶部或底部获得阴影。使其绝对值1大于第4个数的绝对值。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-06-08T13:01:06.363

我遇到过同样的问题。当鼠标悬停在整行上时，我试图突出显示整行。下面是它的css代码：

```
tr:hover {
    outline: none;
    -webkit-box-shadow: inset 0 0 10px #337AB7;
    box-shadow: inset 0 0 10px #337AB7;
} 
```

它在 Windows 7 上的 Mozilla Firefox (38.0.1) 和 Internet Explorer (11.0.9600.17801) 上运行良好。但是，在 Chrome (43.0.2357.81) 上无法运行。

因此，我不得不变通，我混合了 Sviatoslav Zalishchuk 和 David Winiecki 的答案。结果我得到：

```
@media screen and (-webkit-min-device-pixel-ratio:0) {
    tr:hover td:first-child {
       box-shadow: inset 0px 11px 8px -10px #337AB7, 
                   inset 0px -11px 8px -10px #337AB7, 
                   inset 11px 0px 8px -10px #337AB7;
    }

    tr:hover td {
       box-shadow: inset 0px 11px 8px -10px #337AB7, 
                   inset 0px -11px 8px -10px #337AB7;
    }

    tr:hover td:last-child {
       box-shadow: inset 0px 11px 8px -10px #337AB7, 
                   inset 0px -11px 8px -10px #337AB7, 
                   inset -11px 0px 8px -10px #337AB7;
    }
}

tbody > tr:hover {
    outline: none;
    -webkit-box-shadow: inset 0 0 10px #337AB7;
    box-shadow: inset 0 0 10px #337AB7;
} 
```

这很好用，它不会破坏表格的列宽，并且仍然可以在 Mozilla 和 Explorer 上工作。

下面是一个完整的例子：

```
table {
  box-sizing: border-box;
  border-collapse: collapse;
}
td,
th {
  padding-left: 10px;
  padding-right: 10px;
  border: 1px solid #dddddd;
  font: 14px;
  text-align: left;
}

/*To work only on Chrome and Safari*/
@media screen and (-webkit-min-device-pixel-ratio:0) {
  tr:hover td:first-child {
    box-shadow: inset 0px 11px 8px -10px #337AB7, 
      inset 0px -11px 8px -10px #337AB7, 
      inset 11px 0px 8px -10px #337AB7;
  }

  tr:hover td {
    box-shadow: inset 0px 11px 8px -10px #337AB7, 
      inset 0px -11px 8px -10px #337AB7;
  }

  tr:hover td:last-child {
    box-shadow: inset 0px 11px 8px -10px #337AB7, 
      inset 0px -11px 8px -10px #337AB7, 
      inset -11px 0px 8px -10px #337AB7;
  }
}

/*To work on the others browsers*/
tbody > tr:hover {
  outline: none;
  -webkit-box-shadow: inset 0 0 10px #337AB7;
  box-shadow: inset 0 0 10px #337AB7;
}
```

```
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Born</th>
      <th>City</th>      
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>David Gilmour</td>
      <td>6 March 1946</td>
      <td>Cambridge, England</td> 
	</tr>
    <tr>
      <td>Roger Waters</td>
      <td>6 September 1943</td>
      <td>Surrey, England</td>		
    </tr>
    <tr>
      <td>Nick Mason</td>
      <td>27 January 1944</td>
      <td>Birmingham, England</td>
    </tr>
    <tr>
      <td>Richard Wright</td>
      <td>28 July 1943</td>
      <td>London, England</td>
    </tr>
  </tbody>
</table>
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-04T00:30:39.987

其背后的原因似乎归结为默认 CSS - 这`display: block`是最大的因素。

CSS / HTML / 演示

```
tr {
  background-color: rgb(165, 182, 229);
  display: block;
  margin-bottom: 5px;
  -moz-box-shadow: 0px 2px 2px black;
  -webkit-box-shadow: 0px 2px 2px black;
  box-shadow: 0px 2px 2px black;
}
td,th {
  padding: 5px;
  text-align: left;
}
```

```
<table>
  <tr>
    <td>&nbsp;</td>
    <th>One</th>
    <th>Two</th>
  </tr>
  <tr>
    <th>Title</th>
    <td>Three</td>
    <td>Four</td>
  </tr>
  <tr>
    <th>Title2</th>
    <td>Five</td>
    <td>Six</td>
  </tr>
  <tr>
    <th>Title3</th>
    <td>Seven</td>
    <td>Eight</td>
  </tr>
  <tr>
    <th>Title4</th>
    <td>Nine</td>
    <td>Ten</td>
  </tr>
</table>
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-03-03T17:56:58.097

我的效果与`box-shadow`使用`filter`and非常相似`drop-shadow`。这有点 hacky，你需要找到阴影的最佳配置来匹配你的场景。

我原来的班级：

```
.project-row { 
   box-shadow: 0 0 15px 0 black;
} 
```

我的新课：

```
.project-row { 
   filter: drop-shadow(0 0 9px black);
} 
```

[https://codepen.io/nico_nj/pen/XWbaZPJ](https://codepen.io/nico_nj/pen/XWbaZPJ)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-09-07T05:56:42.623

现在，在 v53 Chrome 中，它已修复，并且 box-shadow 可以正常工作`<tr></tr>`！

CSS / HTML / 演示

```
table {
  border-spacing: 0 10px;
  border-collapse: separate;
} 
tbody {
  display: table-row-group;
  vertical-align: middle;
}
tr {
  margin-bottom: 9px;
}
tr:hover {
      box-shadow: 0 5px 8px 0 rgba(50, 50, 50, 0.35);
    -webkit-box-shadow: 0 5px 8px 0 rgba(50, 50, 50, 0.35);
    -moz-box-shadow: 0 5px 8px 0 rgba(50, 50, 50, 0.35);
}
```

```
<table class="table">
  <caption>Optional table caption.</caption>
  <thead> 
    <tr> 
      <th>#</th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Username</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th scope="row">1</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr>
    <tr>
      <th scope="row">2</th>
      <td>Jacob</td>
      <td>Thornton</td>
      <td>@fat</td>
    </tr>
    <tr> 
      <th scope="row">3</th>
      <td>Larry</td>
      <td>the Bird</td>
      <td>@twitter</td>
    </tr>
  </tbody>
</table>
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-04T13:57:09.377

悬停时，我想要在行的左侧有一个盒子阴影：

[![在此处输入图像描述](../Images/67be57344237e6678086991335e906e4.png)](https://i.stack.imgur.com/AGpzV.png)

我只是通过在行中的第一个单元格上设置 box-shadow 来修复它。像这样：

```
tr:hover                { background: #EEF0F3; cursor: pointer; }
tr:hover td:first-child { box-shadow: inset 2px 0 0 0 #323335; } 
```

我已经在 Firefox、Chrome 和 IE9 中尝试过。似乎工作正常。

* * *

如果你想在整行周围有一个 1px 宽的边框，你可以这样做：

```
tr:hover td             { box-shadow: 0 1px 0 0 black, 0 -1px 0 0 black; }
tr:hover td:first-child { box-shadow: 0 -1px 0 0 black, -1px 0 0 0 black, 0 1px 0 0 black; }
tr:hover td:last-child  { box-shadow: 0 -1px 0 0 black, 1px 0 0 0 black, 0 1px 0 0 black; } 
```

[![在此处输入图像描述](../Images/31875e2b7a7e424f9e1589a31a55303b.png)](https://i.stack.imgur.com/i5eJm.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-01-20T09:10:16.433

您可以使用`:after`表格行的伪元素显示在整体上方，`tr`并`pointer events: none;`应用.`box-shadow``tr`

例子：

```
.custom-table {
    border-radius: 10px;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
}
table {
  margin-bottom: 0;
  color: #4e4e4e;
}

thead {
  background: #000000;
  color: #FFFFFF;
  text-transform: uppercase;
  font-size: 15px;
  line-height: 18px;
  font-weight: 600;
}
th {
  padding: 20px 40px;
}
tr:hover:after {
  box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
  transition: box-shadow 0.3s ease-in-out;
}

tbody tr {
  background: #FFFFFF;
  position: relative;
}
tbody tr:after {
  display: block;
  content: '';
  width: 100%;
  height: 100%;
  position: absolute;
  z-index: 2;
  pointer-events: none;
  top: 0;
  left: 0;
  box-shadow: 0px 4px 10px rgba(0, 0, 0, 0);
  transition: box-shadow 0.3s ease-in-out;
}
td {
  padding: 17px 40px;
  border: 0;
  vertical-align: middle;
}
```

```
<div class="custom-table table-responsive">
    <table class="table">
        <thead class="table-header">
            <tr class="table-row">
                <th scope="col" class="table-col">Date &amp; Time</th>
                <th scope="col" class="table-col">Meeting Name</th>
                <th scope="col" class="table-col">Document</th>
                <th scope="col" class="table-col">Type of Meeting</th>
            </tr>
        </thead>
        <tbody class="table-body">
            <tr class="table-row">
                <td class="table-col"><span class="meeting-date">16 Nov 2021 <b>Saturday</b></span><span class="meeting-time">7:00 PM</span></td>
                <td class="table-col">Lorem ipsum dolor sit amet</td>
                <td class="table-col"><span class="member-document">quis nostrud exercitation ullamco</span></td>
                <td class="table-col"><span class="meeting-type type-1">MEETINGS</span></td>
            </tr>
            <tr class="table-row">
                <td class="table-col"><span class="meeting-date">16 Nov 2021 <b>Saturday</b></span><span class="meeting-time">7:00 PM</span></td>
                <td class="table-col">Lorem ipsum dolor sit amet</td>
                <td class="table-col"><span class="member-document">quis nostrud exercitation ullamco</span></td>
                <td class="table-col"><span class="meeting-type type-1">MEETINGS</span></td>
            </tr>
            <tr class="table-row">
                <td class="table-col"><span class="meeting-date">16 Nov 2021 <b>Saturday</b></span><span class="meeting-time">7:00 PM</span></td>
                <td class="table-col">Lorem ipsum dolor sit amet</td>
                <td class="table-col"><span class="member-document">quis nostrud exercitation ullamco</span></td>
                <td class="table-col"><span class="meeting-type type-1">MEETINGS</span></td>
            </tr>
        </tbody>
    </table>
</div>
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2018-11-22T08:49:22.077

> 在反应中，我将答案组合如下。它在 chrome、>firefox、ie11 中运行良好

```
.select_row{
    color: #43B149;
    font-weight: bolder !important;
    background: #e4e5e6 !important;
    box-shadow: 1px 0px 1px 0px #cad6ce !important;
    -moz-box-shadow:1px 0px 1px 0px #cad6ce !important;
    -webkit-box-shadow:1px 0px 1px 0px #cad6ce !important;
    transform: scale(1);
    -webkit-transform: scale(1);
    -moz-transform: scale(1);
    -ms-transform: scale(1);
    td{box-shadow: 0px 3px 0px 0px #cad6ce !important;
        -moz-box-shadow:0px 3px 0px 0px #cad6ce !important;
        -webkit-box-shadow:0px 3px 0px 0px #cad6ce !important;
        background: #e4e5e6 !important;
    }
}
.table-forecast{
    border-collapse: separate;
    border-spacing: 0px;
} 
```

# python - Flask 中的 UTF8 和 JSON

> ID：10874990
> 
> 赞同：2
> 
> 时间：2012-06-04T00:08:22.583
> 
> 标签：python, json, unicode, utf-8, flask

在`Flask/Python`我们有这样一个由`json.loads`函数创建的字典：

```
{ "msg": [
        "Dobr\u00fd den."
      ] } 
```

我们从 HTTP GET Web 方法返回 JSON 响应，例如`return flask.jsonify(**myjson)`. 但即使是网络浏览器也被配置为使用`UTF-8`我们所看到的是`Dobr\u00fd den.`而不是`Dobrý den.`（我们想要的，即解码的 UTF8 字符）。请问，如何实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T07:26:14.367

尝试将响应编码为 utf-8。

# python - 将 CSV 表格转换为自定义格式

> ID：10874993
> 
> 赞同：0
> 
> 时间：2012-06-04T00:08:45.487
> 
> 标签：python, csv

我有一个 CSV 文件，我想将其转换为不同的格式。CSV 格式如下：

```
A_to_B,B_to_C,C_to_D,...
0,2,1,... 
```

即，每个标题由两个变量组成，例如 A 和 B，文件中的每一行都包含一个值，即 0、1 或 2。我正在尝试编写一个 Python 脚本来读取这个 CSV 文件和把它变成这样的格式：

```
A,B,0
B,C,2
C,D,1
... 
```

换句话说，它将包含标题的第一行拆分为变量（例如，A、B、C、D 等），然后匹配新格式的相应值。有谁知道如何做到这一点？我掌握了一些基础知识，但实际算法我无法正确理解。谢谢你的帮助。

**更新#1**

这是我记录下来的一些代码，但我没有得到正确的输出：

```
import csv,sys

reader = csv.reader(open(sys.argv[1], 'rt'), delimiter=',')
headers = reader.next()

data = []

for row in reader:
    line = ','.join(row)
    data.append(line)

for row in data:
    for cols, val in zip(headers, row):
        newRow = cols[0], cols[-1], val
        print newRow 
```

CSV 文件如下所示：

```
A,B,C
0,2,1
0,1,1 
```

但是，代码的输出看起来像这样，所以我需要一种以正确方式迭代 CSV 文件的方法：

```
('A', 'A', '0')
('B', 'B', ',')
('C', 'C', '2')
('A', 'A', '0')
('B', 'B', ',')
('C', 'C', '1') 
```

**更新#2**

如果有人偶然发现这一点，这是我最终得到的代码（没有错误处理或任何东西，但它有效）：

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

import csv,os,sys

reader = csv.reader(open(sys.argv[1], 'rt'), delimiter=',')
headers = reader.next()
i = 1

for row in reader:
    os.system('rm id' + str(i) + '.csv')
    os.system('cat ./seeds >> id' + str(i) + '.csv')
    for srcdest,dist in zip(headers, row):
        sd = srcdest.split('_to_')
        src,dest = sd[0],sd[-1]
        if dist == '0':
            pass
        else:
            f = open('id' + str(i) + '.csv', 'a')
            f.write('{},{},{}\n'.format(src.lower().replace('_',''),dest.lower().replace('_',''),float(dist)))
    i=i+1

f.close() 
```

*谢谢大家的帮助！*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T02:15:53.773

```
from itertools import izip

with open("myfile.csv") as inf, open("new.csv","w") as outf:
    header = [s.split('_to_') for s in inf.next().split(',')]
    for row in inf:
        nums = (int(s) for s in row.split(','))
        for (_from, _to), num in izip(header, nums):
            outf.write("{},{},{}\n".format(_from, _to, _num)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T00:35:40.233

读入数据，以便

```
row1 = ['A_to_B','B_to_C',...]
row2 = [0,2,1,...] 
```

这可以通过简单地打开文件、读取该行并用逗号分隔来完成。您可能还想使用`csv`标准库中的模块。一旦你有了，你可以做类似的事情：

```
for srcdest,dist in zip(row1,row2):
    sd = srcdest.split('_')
    src,dest = sd[0],sd[-1]
    f.write('{},{},{}\n'.format(src,dest,dist)) 
```

`f`目标文件在哪里。您也可以使用该`csv`模块来编写行，但仅编写文件可能更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T00:24:56.703

这是一种可能性：

```
>>> header
[u'A_to_B', u'B_to_C', u'C_to_D']
>>> data
[[0, 1, 2], [0, 2, 1], [1, 2, 3]]
>>> for row in data:
...     for cols, val in zip(header, row):
...         newRow = cols[0], cols[-1], val
...         print newRow
(u'A', u'B', 0)
(u'B', u'C', 1)
(u'C', u'D', 2)
(u'A', u'B', 0)
(u'B', u'C', 2)
(u'C', u'D', 1)
(u'A', u'B', 1)
(u'B', u'C', 2)
(u'C', u'D', 3) 
```

如图所示，这假设您有一个包含列名列表的“标题”事物，以及一个包含行列表的“数据”事物。（如果你使用标准库中的 csv 模块，这基本上是你得到的。）它输出一个新的行列表。

在此示例中，我假设所有列名都只是一个字母，因此我可以将它们作为“A_to_B”样式列名的第一个和最后一个字符来访问。如果您的列名长度不同，您可以使用`cols.split('_')`分隔符拆分并提取两个列名。但这只是一个与您的主要问题相切的字符串解析问题。

编辑以响应您的编辑：

删除你的第一个`for`循环。来自 csv.reader 的数据已经是你想要的格式；通过做你`','.join'`，你将它重新包装成你不想要的格式。您的第二个 for 循环应该直接在阅读器上进行迭代：

```
>>> for row in reader:
...     for cols, val in zip(headers, row):
...         newRow = cols[0], cols[-1], val
...         print newRow 
```

另一个问题是您在编辑中发布的数据与原始数据格式不同。您最初说列的形式为“A_to_B”、“B_to_C”等，但在第二个示例中，列只是“A”、“B”、“C”等。您需要解释您是如何打算从原始列名派生新列名。

# python - 在 NLTK 中“克隆”语料库？

> ID：10874994
> 
> 赞同：0
> 
> 时间：2012-06-04T00:09:12.147
> 
> 标签：python, nlp, nltk, corpus

我正在尝试在 NLTK 中创建自己的语料库。我一直在阅读一些关于此的文档，它似乎相当复杂......我想做的只是“克隆”电影评论语料库，但使用我自己的文本。现在，我知道我可以将 move 评论语料库中的文件更改为我自己的文件……但这限制了我一次只能使用一个这样的语料库（即，我必须不断地交换文件）。有什么办法可以克隆电影评论语料库？

谢谢亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T12:59:18.117

`CategorizedPlaintextCorpusReader`与全班一起阅读电影评论。直接使用它来加载您的语料库。以下内容适用于电影语料库的精确副本：

```
mr = CategorizedPlaintextCorpusReader(path_to_your_reviews, r'(?!\.).*\.txt',
        cat_pattern=r'(neg|pos)/.*') 
```

里面的任何机器`cat_pattern`都是类别：在这种情况下，`neg`和`pos`。如果您的语料库有不同的类别（例如，电影类型而不是正面/负面评价），请更改目录结构并调整`cat_pattern`参数以匹配。

PS。对于不同结构的分类语料，nltk提供了丰富的分类方式；阅读`CategorizedPlaintextCorpusReader`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T02:45:18.057

你为什么不通过复制 in 的定义来定义一个新的`movie_reviews`语料库`nltk.corpus`？您可以使用新目录执行此操作，然后复制目录结构并替换文件。

# perl - 哈希生成脚本上的 Perl 语法错误

> ID：10874995
> 
> 赞同：0
> 
> 时间：2012-06-04T00:09:28.573
> 
> 标签：perl, encryption, syntax-error

运行代码时出现以下错误：

```
syntax error line 5, near "use Digest::MD5

sub makeKey 
"
syntax error at line 8, near "}"
syntax error at line 15, near ")
}"
Execution aborted due to compilation errors. 
```

我的脚本：

```
use lib '/home/me/Desktop/pm/MD5.pm';
use Digest::MD5

sub makeKey 
{
    my ($strPassword, $strRndk);
    $strKey = uc(md5Hash($strPassword)) + $strRndk + "Y(02.>'H}t\":E1" + md5Hash($strKey);
    return $strKey;
}

sub md5Hash 
{
    my ($strPassword);
    $strMd5 = md5_hex($strPassword);
    return substr($strMd5, 16, 16) + substr($strMd5, 0, 16);
}

makeKey('test', '1A2B3C'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-04T00:30:35.310

关于您的第三个（也是最后一个？）问题：

> “在第 14 行调用了未定义的子程序 &main::md5_hex”

[`Digest::MD5`](http://search.cpan.org/perldoc?Digest%3a%3aMD5)默认情况下不导出`md5_hex`（或其他任何内容），您必须明确告诉它应该导出`md5_hex`：

```
use Digest::MD5 qw(md5_hex); 
```

或使用全`Digest::MD5::md5_hex`名。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-04T00:13:24.470

使用 Digest::MDd5 需要以分号结尾。

# java - Java小程序无法通过浏览器访问mysql

> ID：10874996
> 
> 赞同：1
> 
> 时间：2012-06-04T00:09:46.017
> 
> 标签：java, mysql, applet

我的 Java 小程序连接到 localhost 上的 mysql 数据库以进行测试。当我从 Eclipse 运行它时它工作正常，但它无法通过浏览器访问 db。我想知道是因为浏览器出于某种原因不支持 localhost db 还是我的代码有问题。如果浏览器不支持它，是否可以在不上传到服务器的情况下以某种方式对其进行测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T00:38:45.757

原因是您的小程序没有访问计算机本地端口的安全权限。Java 这样做是为了保护人们的计算机。想一想您是否打开了一个网页并且允许 Applet 访问您的本地端口。你可以在几秒钟内让你的电脑被黑。

如果您想按照您的方式进行操作，您需要将您的小程序打包到一个 jar 文件中，对其进行签名并验证它，以便它可以接收这些权限。如果您有兴趣，这里有一些信息供您参考：

[如何创建jar文件](http://docs.oracle.com/javase/tutorial/deployment/jar/build.html)
[如何对jar文件进行签名和验证](http://docs.oracle.com/javase/tutorial/deployment/jar/signindex.html)
[如何运行jar打包软件](http://docs.oracle.com/javase/tutorial/deployment/jar/run.html)

如果这就是您想要采取的方法，那么所有这些都是很好的资源。我要做的是设置一个 Servlet（请参阅 duffymo 的答案）或设置一个 ProxyServer 以在您的计算机和小程序之间中继信息。如果您想了解更多信息，请告诉我，我可以提供。

* * *

编辑：

这是很多代码，但我想你会明白的，我希望这会有所帮助。您当然必须编写连接到服务器并从数据库请求信息的客户端。

数据库服务器.java：

```
import java.io.IOException;
import java.net.*;
import java.util.ArrayList;
import java.util.Iterator;

public class DatabaseServer implements Runnable
{
    public DatabaseServer()
    {
        System.out.println("Created new server!");
        clients = new ArrayList<Client>(); // this is a list of all the clients connected to the server
        connected = false;
        running = false;
        connect(); // starts server
    }

    public void run()
    {
        System.out.println("Waiting for clients.../n");

        while(running)
        {
            try 
            {
                Socket socket = server.accept(); // waits for a client to connect
                System.out.println("Client connected! "+socket.getInetAddress());
                Client client = new Client(this, socket); // creates a new client object
                clients.add(client);// adds it to the list

                // cleans the client list everytime a new client connects
                Iterator<Client> it = clients.iterator();
                while(it.hasNext())
                {
                    Client next = it.next();
                    if(!next.connected)
                    {
                        next.disconnect();
                        it.remove();
                    }
                }
            }catch(IOException e){e.printStackTrace();}
        }
    }

    public void connect()
    {
        if(!connected)
        {
            System.out.println("starting server...");
            try
            {
                System.out.println("opening port...");
                server = new ServerSocket(8080); // opens a server socket
                System.out.println("server started on port: "+server.getLocalPort());

                running = true;
                connected = true;

                thread = new Thread(this);// starts the server thread
                thread.start();
            }catch(Exception e){e.printStackTrace(); connected = false; running = false;}
        }
    }

    public void disconnect()
    {
        //stops the server
        try
        {
            server.close();
        }catch(Exception e){e.printStackTrace();}
        server = null;

        if(thread != null)
            thread.interrupt();
        thread = null;

        connected = false;
        running = false;
    }

    public void handleMessage(Client client, String message)
    {
        /* this is where you do your database interactions, based on the message you can pull out specific
         * information from your database and then send it back to the client using client.sendMessage()
        */
    }

    private Thread thread;
    private boolean running;
    private boolean connected;
    private ServerSocket server;
    private ArrayList<Client> clients;

    public static void main(String args[])
    {
        new DatabaseServer(); // makes a new server
    }
} 
```

客户端.java：

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;

public class Client implements Runnable
{
    public Client(DatabaseServer server, Socket socket)
    {
        this.socket = socket;
        this.server = server;
        try
        {
            connected = true;

            writer = new PrintWriter(socket.getOutputStream()); // opens an output stream
            reader = new BufferedReader(new InputStreamReader(socket.getInputStream())); // opens an input stream

            running = true;
            thread = new Thread(this);
            thread.start();// starts the client thread
        }catch(Exception e){e.printStackTrace(); connected = false;}
    }

    public void run()
    {
        try 
        {
            String message = "";
            while((message = reader.readLine()) != null & running & connected) // waits for a message to be recieved
            {
                server.handleMessage(this, message); // tells server to handle message
            }
        }catch(IOException e){e.printStackTrace(); connected = false;}
    }

    public void disconnect()
    {
        // disconnects client
        try
        {
            socket.close();
        }catch(Exception e){e.printStackTrace();}

        try
        {
            reader.close();
        }catch(Exception e){e.printStackTrace();}

        try
        {
            writer.close();
        }catch(Exception e){e.printStackTrace();}

        socket = null;
        reader = null;
        writer = null;

        if(thread != null)
            thread.interrupt();
        thread = null;

        connected = false;
        running = false;
    }

    public void sendMessage(String message)
    {
        // sends a message back to the client
        writer.println(message);
        writer.flush();
    }

    public boolean connected;

    private boolean running;
    private Thread thread;
    private DatabaseServer server;
    private Socket socket;
    private PrintWriter writer;
    private BufferedReader reader;
} 
```

您的小程序将连接到此服务器，然后您可以向服务器发送消息以从数据库中请求信息。您所要做的就是将 mysql 内容添加到服务器，然后编写 applet 的客户端部分。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T00:14:23.097

我建议在小程序和数据库之间放置一个 servlet。您不应该像那样将数据库暴露给网络。最好让applet 向servlet 发送请求并让它代表它进行调解。servlet 可以验证和授权、验证和绑定输入，并编组响应以发回。

# java - 扫描仪 - 使用分隔符正则表达式解析代码值

> ID：10874998
> 
> 赞同：0
> 
> 时间：2012-06-04T00:09:48.450
> 
> 标签：java, regex, int, java.util.scanner

我正在尝试使用扫描仪从“p.addPoint(x,y);”形式的字符串中读取代码行

我追求的正则表达式格式是：

`*anything*.addPoint(*spaces or nothing*`或者`,*spaces or nothing*`

到目前为止我尝试过的方法不起作用：`[[.]+\\.addPoint(&&[\\s]*[,[\\s]*]]`

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T00:23:15.130

我在 Python 中对此进行了测试，但正则表达式应该可以转移到 Java：

```
>>> regex = '(\w+\.addPoint\(\s*|\s*,\s*|\s*\)\s*)'
>>> re.split(regex, 'poly.addPoint(3, 7)')
['', 'poly.addPoint(', '3', ', ', '7', ')', ''] 
```

您的正则表达式似乎严重畸形。即使不是这样，`.`在字符串开头匹配无限多次重复的通配符也可能会导致大量文本匹配实际上不相关/不想要。

编辑：误解了原始规范，当前的正则表达式应该是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T02:04:34.720

其他方式：

```
public class MyPattern {

    private static final Pattern ADD_POINT;
    static {
        String varName = "[\\p{Alnum}_]++";
        String argVal = "([\\p{Alnum}_\\p{Space}]++)";
        String regex = "(" + varName + ")\\.addPoint\\(" + 
                argVal + "," + 
                argVal + "\\);";
        ADD_POINT = Pattern.compile(regex);
        System.out.println("The Pattern is: " + ADD_POINT.pattern());
    }

    public void findIt(String filename) throws FileNotFoundException {
        Scanner s = new Scanner(new FileReader(filename));

        while (s.findWithinHorizon(ADD_POINT, 0) != null) {
            final MatchResult m = s.match();
            System.out.println(m.group(0));
            System.out.println("   arg1=" + m.group(2).trim());
            System.out.println("   arg2=" + m.group(3).trim());
        }
    }

    public static void main(String[] args) throws FileNotFoundException {
        MyPattern p = new MyPattern();
        final String fname = "addPoint.txt";
        p.findIt(fname);
    }

} 
```

# c# - 如何使用代码优先 EF 4.3 将具有复杂类型的属性映射到特定表列？

> ID：10874999
> 
> 赞同：1
> 
> 时间：2012-06-04T00:09:50.050
> 
> 标签：c#, entity-framework-4, ef-code-first

我有以下类型：

```
public class Minutes
{        
    public double Value { get; set; }        
} 
```

这种类型在这样的实体中使用：

```
public class Race
{
    public string Name { get; set; }
    public string Location { get; set; }
    public Minutes TotalMinutes { get; set; }
} 
```

我有一个像这样的 DbContext：

```
public class RaceDataContext:  DbContext
{
    public DbSet<Race> Races { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.ComplexType<Minutes>().Property(x => x.Value);
    }
} 
```

在应用程序开发中，我们一直在使用没有问题的 MS-SQL 数据库。现在，我们必须转移到客户端的 Oracle 数据库。Oracle 数据库具有固定的表，其中包含我们无法更改的列。我们需要能够读取、更新和插入比赛。因此，我已将映射代码更新为如下内容：

```
public class RaceDataContext:  DbContext
{
    public DbSet<Race> Races { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.ComplexType<Minutes>().Property(x => x.Value);

        modelBuilder.Entity<Race>().Property(x => x.TotalMinutes).HasColumnName("RACEMINUTES"); // <-- ERROR HERE
    }
} 
```

上面的代码无法编译。它说 TotalMinutes 必须是一个不可为空的值，才能用作 .Property() 方法的参数。这是构建输出的实际错误：

> The type 'Races.Minutes' must be a non-nullable value type in order to use it as parameter 'T' in the generic type or method 'System.Data.Entity.ModelConfiguration.Configuration.StructuralTypeConfiguration.Property(System.Linq.Expressions.Expression>)' C:\Projects\Races\RaceDataContext.cs

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T02:48:40.107

You were close to the solution.

```
modelBuilder.Entity<Race>().Property(x => x.TotalMinutes.Value)
   .HasColumnName("RACEMINUTES"); 
```